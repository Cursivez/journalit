/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository
*/

var mCe=Object.create;var rS=Object.defineProperty;var fCe=Object.getOwnPropertyDescriptor;var gCe=Object.getOwnPropertyNames;var hCe=Object.getPrototypeOf,vCe=Object.prototype.hasOwnProperty;var yCe=(e,t,r)=>t in e?rS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var F=(e,t)=>()=>(e&&(t=e(e=0)),t);var Fe=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ti=(e,t)=>{for(var r in t)rS(e,r,{get:t[r],enumerable:!0})},GY=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of gCe(t))!vCe.call(e,i)&&i!==r&&rS(e,i,{get:()=>t[i],enumerable:!(n=fCe(t,i))||n.enumerable});return e};var Y=(e,t,r)=>(r=e!=null?mCe(hCe(e)):{},GY(t||!e||!e.__esModule?rS(r,"default",{value:e,enumerable:!0}):r,e)),hd=e=>GY(rS({},"__esModule",{value:!0}),e);var sx=(e,t,r)=>yCe(e,typeof t!="symbol"?t+"":t,r);var a9=Fe(en=>{"use strict";var nS=Symbol.for("react.element"),bCe=Symbol.for("react.portal"),xCe=Symbol.for("react.fragment"),wCe=Symbol.for("react.strict_mode"),kCe=Symbol.for("react.profiler"),SCe=Symbol.for("react.provider"),TCe=Symbol.for("react.context"),CCe=Symbol.for("react.forward_ref"),PCe=Symbol.for("react.suspense"),DCe=Symbol.for("react.memo"),ECe=Symbol.for("react.lazy"),YY=Symbol.iterator;function ICe(e){return e===null||typeof e!="object"?null:(e=YY&&e[YY]||e["@@iterator"],typeof e=="function"?e:null)}var QY={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},XY=Object.assign,ZY={};function lx(e,t,r){this.props=e,this.context=t,this.refs=ZY,this.updater=r||QY}lx.prototype.isReactComponent={};lx.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};lx.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function e9(){}e9.prototype=lx.prototype;function bj(e,t,r){this.props=e,this.context=t,this.refs=ZY,this.updater=r||QY}var xj=bj.prototype=new e9;xj.constructor=bj;XY(xj,lx.prototype);xj.isPureReactComponent=!0;var KY=Array.isArray,t9=Object.prototype.hasOwnProperty,wj={current:null},r9={key:!0,ref:!0,__self:!0,__source:!0};function n9(e,t,r){var n,i={},a=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(a=""+t.key),t)t9.call(t,n)&&!r9.hasOwnProperty(n)&&(i[n]=t[n]);var s=arguments.length-2;if(s===1)i.children=r;else if(1<s){for(var l=Array(s),c=0;c<s;c++)l[c]=arguments[c+2];i.children=l}if(e&&e.defaultProps)for(n in s=e.defaultProps,s)i[n]===void 0&&(i[n]=s[n]);return{$$typeof:nS,type:e,key:a,ref:o,props:i,_owner:wj.current}}function MCe(e,t){return{$$typeof:nS,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function kj(e){return typeof e=="object"&&e!==null&&e.$$typeof===nS}function ACe(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var JY=/\/+/g;function yj(e,t){return typeof e=="object"&&e!==null&&e.key!=null?ACe(""+e.key):t.toString(36)}function TD(e,t,r,n,i){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case nS:case bCe:o=!0}}if(o)return o=e,i=i(o),e=n===""?"."+yj(o,0):n,KY(i)?(r="",e!=null&&(r=e.replace(JY,"$&/")+"/"),TD(i,t,r,"",function(c){return c})):i!=null&&(kj(i)&&(i=MCe(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(JY,"$&/")+"/")+e)),t.push(i)),1;if(o=0,n=n===""?".":n+":",KY(e))for(var s=0;s<e.length;s++){a=e[s];var l=n+yj(a,s);o+=TD(a,t,r,l,i)}else if(l=ICe(e),typeof l=="function")for(e=l.call(e),s=0;!(a=e.next()).done;)a=a.value,l=n+yj(a,s++),o+=TD(a,t,r,l,i);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function SD(e,t,r){if(e==null)return e;var n=[],i=0;return TD(e,n,"","",function(a){return t.call(r,a,i++)}),n}function LCe(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Tl={current:null},CD={transition:null},NCe={ReactCurrentDispatcher:Tl,ReactCurrentBatchConfig:CD,ReactCurrentOwner:wj};function i9(){throw Error("act(...) is not supported in production builds of React.")}en.Children={map:SD,forEach:function(e,t,r){SD(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return SD(e,function(){t++}),t},toArray:function(e){return SD(e,function(t){return t})||[]},only:function(e){if(!kj(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};en.Component=lx;en.Fragment=xCe;en.Profiler=kCe;en.PureComponent=bj;en.StrictMode=wCe;en.Suspense=PCe;en.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=NCe;en.act=i9;en.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=XY({},e.props),i=e.key,a=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,o=wj.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(l in t)t9.call(t,l)&&!r9.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&s!==void 0?s[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){s=Array(l);for(var c=0;c<l;c++)s[c]=arguments[c+2];n.children=s}return{$$typeof:nS,type:e.type,key:i,ref:a,props:n,_owner:o}};en.createContext=function(e){return e={$$typeof:TCe,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:SCe,_context:e},e.Consumer=e};en.createElement=n9;en.createFactory=function(e){var t=n9.bind(null,e);return t.type=e,t};en.createRef=function(){return{current:null}};en.forwardRef=function(e){return{$$typeof:CCe,render:e}};en.isValidElement=kj;en.lazy=function(e){return{$$typeof:ECe,_payload:{_status:-1,_result:e},_init:LCe}};en.memo=function(e,t){return{$$typeof:DCe,type:e,compare:t===void 0?null:t}};en.startTransition=function(e){var t=CD.transition;CD.transition={};try{e()}finally{CD.transition=t}};en.unstable_act=i9;en.useCallback=function(e,t){return Tl.current.useCallback(e,t)};en.useContext=function(e){return Tl.current.useContext(e)};en.useDebugValue=function(){};en.useDeferredValue=function(e){return Tl.current.useDeferredValue(e)};en.useEffect=function(e,t){return Tl.current.useEffect(e,t)};en.useId=function(){return Tl.current.useId()};en.useImperativeHandle=function(e,t,r){return Tl.current.useImperativeHandle(e,t,r)};en.useInsertionEffect=function(e,t){return Tl.current.useInsertionEffect(e,t)};en.useLayoutEffect=function(e,t){return Tl.current.useLayoutEffect(e,t)};en.useMemo=function(e,t){return Tl.current.useMemo(e,t)};en.useReducer=function(e,t,r){return Tl.current.useReducer(e,t,r)};en.useRef=function(e){return Tl.current.useRef(e)};en.useState=function(e){return Tl.current.useState(e)};en.useSyncExternalStore=function(e,t,r){return Tl.current.useSyncExternalStore(e,t,r)};en.useTransition=function(){return Tl.current.useTransition()};en.version="18.3.1"});var Q=Fe((OQe,o9)=>{"use strict";o9.exports=a9()});var h9=Fe($i=>{"use strict";function Pj(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,i=e[n];if(0<PD(i,t))e[n]=t,e[r]=i,r=n;else break e}}function Cu(e){return e.length===0?null:e[0]}function ED(e){if(e.length===0)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,i=e.length,a=i>>>1;n<a;){var o=2*(n+1)-1,s=e[o],l=o+1,c=e[l];if(0>PD(s,r))l<i&&0>PD(c,s)?(e[n]=c,e[l]=r,n=l):(e[n]=s,e[o]=r,n=o);else if(l<i&&0>PD(c,r))e[n]=c,e[l]=r,n=l;else break e}}return t}function PD(e,t){var r=e.sortIndex-t.sortIndex;return r!==0?r:e.id-t.id}typeof performance=="object"&&typeof performance.now=="function"?(s9=performance,$i.unstable_now=function(){return s9.now()}):(Sj=Date,l9=Sj.now(),$i.unstable_now=function(){return Sj.now()-l9});var s9,Sj,l9,wp=[],kg=[],FCe=1,vd=null,qs=3,ID=!1,xv=!1,aS=!1,u9=typeof setTimeout=="function"?setTimeout:null,p9=typeof clearTimeout=="function"?clearTimeout:null,c9=typeof setImmediate!="undefined"?setImmediate:null;typeof navigator!="undefined"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Dj(e){for(var t=Cu(kg);t!==null;){if(t.callback===null)ED(kg);else if(t.startTime<=e)ED(kg),t.sortIndex=t.expirationTime,Pj(wp,t);else break;t=Cu(kg)}}function Ej(e){if(aS=!1,Dj(e),!xv)if(Cu(wp)!==null)xv=!0,Mj(Ij);else{var t=Cu(kg);t!==null&&Aj(Ej,t.startTime-e)}}function Ij(e,t){xv=!1,aS&&(aS=!1,p9(oS),oS=-1),ID=!0;var r=qs;try{for(Dj(t),vd=Cu(wp);vd!==null&&(!(vd.expirationTime>t)||e&&!g9());){var n=vd.callback;if(typeof n=="function"){vd.callback=null,qs=vd.priorityLevel;var i=n(vd.expirationTime<=t);t=$i.unstable_now(),typeof i=="function"?vd.callback=i:vd===Cu(wp)&&ED(wp),Dj(t)}else ED(wp);vd=Cu(wp)}if(vd!==null)var a=!0;else{var o=Cu(kg);o!==null&&Aj(Ej,o.startTime-t),a=!1}return a}finally{vd=null,qs=r,ID=!1}}var MD=!1,DD=null,oS=-1,m9=5,f9=-1;function g9(){return!($i.unstable_now()-f9<m9)}function Tj(){if(DD!==null){var e=$i.unstable_now();f9=e;var t=!0;try{t=DD(!0,e)}finally{t?iS():(MD=!1,DD=null)}}else MD=!1}var iS;typeof c9=="function"?iS=function(){c9(Tj)}:typeof MessageChannel!="undefined"?(Cj=new MessageChannel,d9=Cj.port2,Cj.port1.onmessage=Tj,iS=function(){d9.postMessage(null)}):iS=function(){u9(Tj,0)};var Cj,d9;function Mj(e){DD=e,MD||(MD=!0,iS())}function Aj(e,t){oS=u9(function(){e($i.unstable_now())},t)}$i.unstable_IdlePriority=5;$i.unstable_ImmediatePriority=1;$i.unstable_LowPriority=4;$i.unstable_NormalPriority=3;$i.unstable_Profiling=null;$i.unstable_UserBlockingPriority=2;$i.unstable_cancelCallback=function(e){e.callback=null};$i.unstable_continueExecution=function(){xv||ID||(xv=!0,Mj(Ij))};$i.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):m9=0<e?Math.floor(1e3/e):5};$i.unstable_getCurrentPriorityLevel=function(){return qs};$i.unstable_getFirstCallbackNode=function(){return Cu(wp)};$i.unstable_next=function(e){switch(qs){case 1:case 2:case 3:var t=3;break;default:t=qs}var r=qs;qs=t;try{return e()}finally{qs=r}};$i.unstable_pauseExecution=function(){};$i.unstable_requestPaint=function(){};$i.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=qs;qs=e;try{return t()}finally{qs=r}};$i.unstable_scheduleCallback=function(e,t,r){var n=$i.unstable_now();switch(typeof r=="object"&&r!==null?(r=r.delay,r=typeof r=="number"&&0<r?n+r:n):r=n,e){case 1:var i=-1;break;case 2:i=250;break;case 5:i=1073741823;break;case 4:i=1e4;break;default:i=5e3}return i=r+i,e={id:FCe++,callback:t,priorityLevel:e,startTime:r,expirationTime:i,sortIndex:-1},r>n?(e.sortIndex=r,Pj(kg,e),Cu(wp)===null&&e===Cu(kg)&&(aS?(p9(oS),oS=-1):aS=!0,Aj(Ej,r-n))):(e.sortIndex=i,Pj(wp,e),xv||ID||(xv=!0,Mj(Ij))),e};$i.unstable_shouldYield=g9;$i.unstable_wrapCallback=function(e){var t=qs;return function(){var r=qs;qs=t;try{return e.apply(this,arguments)}finally{qs=r}}}});var y9=Fe((jQe,v9)=>{"use strict";v9.exports=h9()});var kJ=Fe(Wc=>{"use strict";var OCe=Q(),_c=y9();function Ve(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var C7=new Set,ES={};function Nv(e,t){Ix(e,t),Ix(e+"Capture",t)}function Ix(e,t){for(ES[e]=t,e=0;e<t.length;e++)C7.add(t[e])}var Hm=!(typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"),e5=Object.prototype.hasOwnProperty,zCe=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,b9={},x9={};function jCe(e){return e5.call(x9,e)?!0:e5.call(b9,e)?!1:zCe.test(e)?x9[e]=!0:(b9[e]=!0,!1)}function _Ce(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function BCe(e,t,r,n){if(t===null||typeof t=="undefined"||_Ce(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Dl(e,t,r,n,i,a,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var Ds={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ds[e]=new Dl(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ds[t]=new Dl(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ds[e]=new Dl(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ds[e]=new Dl(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ds[e]=new Dl(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ds[e]=new Dl(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ds[e]=new Dl(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ds[e]=new Dl(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ds[e]=new Dl(e,5,!1,e.toLowerCase(),null,!1,!1)});var V5=/[\-:]([a-z])/g;function G5(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(V5,G5);Ds[t]=new Dl(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(V5,G5);Ds[t]=new Dl(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(V5,G5);Ds[t]=new Dl(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ds[e]=new Dl(e,1,!1,e.toLowerCase(),null,!1,!1)});Ds.xlinkHref=new Dl("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ds[e]=new Dl(e,1,!1,e.toLowerCase(),null,!0,!0)});function Y5(e,t,r,n){var i=Ds.hasOwnProperty(t)?Ds[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(BCe(t,r,i,n)&&(r=null),n||i===null?jCe(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Ym=OCe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,AD=Symbol.for("react.element"),ux=Symbol.for("react.portal"),px=Symbol.for("react.fragment"),K5=Symbol.for("react.strict_mode"),t5=Symbol.for("react.profiler"),P7=Symbol.for("react.provider"),D7=Symbol.for("react.context"),J5=Symbol.for("react.forward_ref"),r5=Symbol.for("react.suspense"),n5=Symbol.for("react.suspense_list"),Q5=Symbol.for("react.memo"),Tg=Symbol.for("react.lazy"),E7=Symbol.for("react.offscreen"),w9=Symbol.iterator;function sS(e){return e===null||typeof e!="object"?null:(e=w9&&e[w9]||e["@@iterator"],typeof e=="function"?e:null)}var Ma=Object.assign,Lj;function gS(e){if(Lj===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Lj=t&&t[1]||""}return`
`+Lj+e}var Nj=!1;function Fj(e,t){if(!e||Nj)return"";Nj=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),a=n.stack.split(`
`),o=i.length-1,s=a.length-1;1<=o&&0<=s&&i[o]!==a[s];)s--;for(;1<=o&&0<=s;o--,s--)if(i[o]!==a[s]){if(o!==1||s!==1)do if(o--,s--,0>s||i[o]!==a[s]){var l=`
`+i[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=o&&0<=s);break}}}finally{Nj=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?gS(e):""}function WCe(e){switch(e.tag){case 5:return gS(e.type);case 16:return gS("Lazy");case 13:return gS("Suspense");case 19:return gS("SuspenseList");case 0:case 2:case 15:return e=Fj(e.type,!1),e;case 11:return e=Fj(e.type.render,!1),e;case 1:return e=Fj(e.type,!0),e;default:return""}}function i5(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case px:return"Fragment";case ux:return"Portal";case t5:return"Profiler";case K5:return"StrictMode";case r5:return"Suspense";case n5:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case D7:return(e.displayName||"Context")+".Consumer";case P7:return(e._context.displayName||"Context")+".Provider";case J5:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Q5:return t=e.displayName||null,t!==null?t:i5(e.type)||"Memo";case Tg:t=e._payload,e=e._init;try{return i5(e(t))}catch(r){}}return null}function $Ce(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return i5(t);case 8:return t===K5?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function _g(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function I7(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function RCe(e){var t=I7(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r!="undefined"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,a.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function LD(e){e._valueTracker||(e._valueTracker=RCe(e))}function M7(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=I7(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function oE(e){if(e=e||(typeof document!="undefined"?document:void 0),typeof e=="undefined")return null;try{return e.activeElement||e.body}catch(t){return e.body}}function a5(e,t){var r=t.checked;return Ma({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r!=null?r:e._wrapperState.initialChecked})}function k9(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=_g(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function A7(e,t){t=t.checked,t!=null&&Y5(e,"checked",t,!1)}function o5(e,t){A7(e,t);var r=_g(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?s5(e,t.type,r):t.hasOwnProperty("defaultValue")&&s5(e,t.type,_g(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function S9(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function s5(e,t,r){(t!=="number"||oE(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var hS=Array.isArray;function Sx(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+_g(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function l5(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ve(91));return Ma({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function T9(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Ve(92));if(hS(r)){if(1<r.length)throw Error(Ve(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:_g(r)}}function L7(e,t){var r=_g(t.value),n=_g(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function C9(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function N7(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function c5(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?N7(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ND,F7=(function(e){return typeof MSApp!="undefined"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e})(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ND=ND||document.createElement("div"),ND.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ND.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function IS(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var bS={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},UCe=["Webkit","ms","Moz","O"];Object.keys(bS).forEach(function(e){UCe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),bS[t]=bS[e]})});function O7(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||bS.hasOwnProperty(e)&&bS[e]?(""+t).trim():t+"px"}function z7(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=O7(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var HCe=Ma({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function d5(e,t){if(t){if(HCe[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ve(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ve(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ve(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ve(62))}}function u5(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var p5=null;function X5(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var m5=null,Tx=null,Cx=null;function P9(e){if(e=GS(e)){if(typeof m5!="function")throw Error(Ve(280));var t=e.stateNode;t&&(t=FE(t),m5(e.stateNode,e.type,t))}}function j7(e){Tx?Cx?Cx.push(e):Cx=[e]:Tx=e}function _7(){if(Tx){var e=Tx,t=Cx;if(Cx=Tx=null,P9(e),t)for(e=0;e<t.length;e++)P9(t[e])}}function B7(e,t){return e(t)}function W7(){}var Oj=!1;function $7(e,t,r){if(Oj)return e(t,r);Oj=!0;try{return B7(e,t,r)}finally{Oj=!1,(Tx!==null||Cx!==null)&&(W7(),_7())}}function MS(e,t){var r=e.stateNode;if(r===null)return null;var n=FE(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Ve(231,t,typeof r));return r}var f5=!1;if(Hm)try{cx={},Object.defineProperty(cx,"passive",{get:function(){f5=!0}}),window.addEventListener("test",cx,cx),window.removeEventListener("test",cx,cx)}catch(e){f5=!1}var cx;function qCe(e,t,r,n,i,a,o,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(d){this.onError(d)}}var xS=!1,sE=null,lE=!1,g5=null,VCe={onError:function(e){xS=!0,sE=e}};function GCe(e,t,r,n,i,a,o,s,l){xS=!1,sE=null,qCe.apply(VCe,arguments)}function YCe(e,t,r,n,i,a,o,s,l){if(GCe.apply(this,arguments),xS){if(xS){var c=sE;xS=!1,sE=null}else throw Error(Ve(198));lE||(lE=!0,g5=c)}}function Fv(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function R7(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function D9(e){if(Fv(e)!==e)throw Error(Ve(188))}function KCe(e){var t=e.alternate;if(!t){if(t=Fv(e),t===null)throw Error(Ve(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var a=i.alternate;if(a===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return D9(i),e;if(a===n)return D9(i),t;a=a.sibling}throw Error(Ve(188))}if(r.return!==n.return)r=i,n=a;else{for(var o=!1,s=i.child;s;){if(s===r){o=!0,r=i,n=a;break}if(s===n){o=!0,n=i,r=a;break}s=s.sibling}if(!o){for(s=a.child;s;){if(s===r){o=!0,r=a,n=i;break}if(s===n){o=!0,n=a,r=i;break}s=s.sibling}if(!o)throw Error(Ve(189))}}if(r.alternate!==n)throw Error(Ve(190))}if(r.tag!==3)throw Error(Ve(188));return r.stateNode.current===r?e:t}function U7(e){return e=KCe(e),e!==null?H7(e):null}function H7(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=H7(e);if(t!==null)return t;e=e.sibling}return null}var q7=_c.unstable_scheduleCallback,E9=_c.unstable_cancelCallback,JCe=_c.unstable_shouldYield,QCe=_c.unstable_requestPaint,oo=_c.unstable_now,XCe=_c.unstable_getCurrentPriorityLevel,Z5=_c.unstable_ImmediatePriority,V7=_c.unstable_UserBlockingPriority,cE=_c.unstable_NormalPriority,ZCe=_c.unstable_LowPriority,G7=_c.unstable_IdlePriority,ME=null,Cp=null;function ePe(e){if(Cp&&typeof Cp.onCommitFiberRoot=="function")try{Cp.onCommitFiberRoot(ME,e,void 0,(e.current.flags&128)===128)}catch(t){}}var Mu=Math.clz32?Math.clz32:nPe,tPe=Math.log,rPe=Math.LN2;function nPe(e){return e>>>=0,e===0?32:31-(tPe(e)/rPe|0)|0}var FD=64,OD=4194304;function vS(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dE(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,a=e.pingedLanes,o=r&268435455;if(o!==0){var s=o&~i;s!==0?n=vS(s):(a&=o,a!==0&&(n=vS(a)))}else o=r&~i,o!==0?n=vS(o):a!==0&&(n=vS(a));if(n===0)return 0;if(t!==0&&t!==n&&(t&i)===0&&(i=n&-n,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if((n&4)!==0&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Mu(t),i=1<<r,n|=e[r],t&=~i;return n}function iPe(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function aPe(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-Mu(a),s=1<<o,l=i[o];l===-1?((s&r)===0||(s&n)!==0)&&(i[o]=iPe(s,t)):l<=t&&(e.expiredLanes|=s),a&=~s}}function h5(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Y7(){var e=FD;return FD<<=1,(FD&4194240)===0&&(FD=64),e}function zj(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function qS(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Mu(t),e[t]=r}function oPe(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Mu(r),a=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~a}}function e_(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Mu(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var gi=0;function K7(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var J7,t_,Q7,X7,Z7,v5=!1,zD=[],Mg=null,Ag=null,Lg=null,AS=new Map,LS=new Map,Pg=[],sPe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function I9(e,t){switch(e){case"focusin":case"focusout":Mg=null;break;case"dragenter":case"dragleave":Ag=null;break;case"mouseover":case"mouseout":Lg=null;break;case"pointerover":case"pointerout":AS.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":LS.delete(t.pointerId)}}function lS(e,t,r,n,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},t!==null&&(t=GS(t),t!==null&&t_(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function lPe(e,t,r,n,i){switch(t){case"focusin":return Mg=lS(Mg,e,t,r,n,i),!0;case"dragenter":return Ag=lS(Ag,e,t,r,n,i),!0;case"mouseover":return Lg=lS(Lg,e,t,r,n,i),!0;case"pointerover":var a=i.pointerId;return AS.set(a,lS(AS.get(a)||null,e,t,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,LS.set(a,lS(LS.get(a)||null,e,t,r,n,i)),!0}return!1}function eK(e){var t=Sv(e.target);if(t!==null){var r=Fv(t);if(r!==null){if(t=r.tag,t===13){if(t=R7(r),t!==null){e.blockedOn=t,Z7(e.priority,function(){Q7(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function JD(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=y5(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);p5=n,r.target.dispatchEvent(n),p5=null}else return t=GS(r),t!==null&&t_(t),e.blockedOn=r,!1;t.shift()}return!0}function M9(e,t,r){JD(e)&&r.delete(t)}function cPe(){v5=!1,Mg!==null&&JD(Mg)&&(Mg=null),Ag!==null&&JD(Ag)&&(Ag=null),Lg!==null&&JD(Lg)&&(Lg=null),AS.forEach(M9),LS.forEach(M9)}function cS(e,t){e.blockedOn===t&&(e.blockedOn=null,v5||(v5=!0,_c.unstable_scheduleCallback(_c.unstable_NormalPriority,cPe)))}function NS(e){function t(i){return cS(i,e)}if(0<zD.length){cS(zD[0],e);for(var r=1;r<zD.length;r++){var n=zD[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Mg!==null&&cS(Mg,e),Ag!==null&&cS(Ag,e),Lg!==null&&cS(Lg,e),AS.forEach(t),LS.forEach(t),r=0;r<Pg.length;r++)n=Pg[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Pg.length&&(r=Pg[0],r.blockedOn===null);)eK(r),r.blockedOn===null&&Pg.shift()}var Px=Ym.ReactCurrentBatchConfig,uE=!0;function dPe(e,t,r,n){var i=gi,a=Px.transition;Px.transition=null;try{gi=1,r_(e,t,r,n)}finally{gi=i,Px.transition=a}}function uPe(e,t,r,n){var i=gi,a=Px.transition;Px.transition=null;try{gi=4,r_(e,t,r,n)}finally{gi=i,Px.transition=a}}function r_(e,t,r,n){if(uE){var i=y5(e,t,r,n);if(i===null)Uj(e,t,n,pE,r),I9(e,n);else if(lPe(i,e,t,r,n))n.stopPropagation();else if(I9(e,n),t&4&&-1<sPe.indexOf(e)){for(;i!==null;){var a=GS(i);if(a!==null&&J7(a),a=y5(e,t,r,n),a===null&&Uj(e,t,n,pE,r),a===i)break;i=a}i!==null&&n.stopPropagation()}else Uj(e,t,n,null,r)}}var pE=null;function y5(e,t,r,n){if(pE=null,e=X5(n),e=Sv(e),e!==null)if(t=Fv(e),t===null)e=null;else if(r=t.tag,r===13){if(e=R7(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return pE=e,null}function tK(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(XCe()){case Z5:return 1;case V7:return 4;case cE:case ZCe:return 16;case G7:return 536870912;default:return 16}default:return 16}}var Eg=null,n_=null,QD=null;function rK(){if(QD)return QD;var e,t=n_,r=t.length,n,i="value"in Eg?Eg.value:Eg.textContent,a=i.length;for(e=0;e<r&&t[e]===i[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===i[a-n];n++);return QD=i.slice(e,1<n?1-n:void 0)}function XD(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function jD(){return!0}function A9(){return!1}function Bc(e){function t(r,n,i,a,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var s in e)e.hasOwnProperty(s)&&(r=e[s],this[s]=r?r(a):a[s]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?jD:A9,this.isPropagationStopped=A9,this}return Ma(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=jD)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=jD)},persist:function(){},isPersistent:jD}),t}var zx={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},i_=Bc(zx),VS=Ma({},zx,{view:0,detail:0}),pPe=Bc(VS),jj,_j,dS,AE=Ma({},VS,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:a_,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==dS&&(dS&&e.type==="mousemove"?(jj=e.screenX-dS.screenX,_j=e.screenY-dS.screenY):_j=jj=0,dS=e),jj)},movementY:function(e){return"movementY"in e?e.movementY:_j}}),L9=Bc(AE),mPe=Ma({},AE,{dataTransfer:0}),fPe=Bc(mPe),gPe=Ma({},VS,{relatedTarget:0}),Bj=Bc(gPe),hPe=Ma({},zx,{animationName:0,elapsedTime:0,pseudoElement:0}),vPe=Bc(hPe),yPe=Ma({},zx,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bPe=Bc(yPe),xPe=Ma({},zx,{data:0}),N9=Bc(xPe),wPe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kPe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},SPe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function TPe(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=SPe[e])?!!t[e]:!1}function a_(){return TPe}var CPe=Ma({},VS,{key:function(e){if(e.key){var t=wPe[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=XD(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?kPe[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:a_,charCode:function(e){return e.type==="keypress"?XD(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?XD(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),PPe=Bc(CPe),DPe=Ma({},AE,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),F9=Bc(DPe),EPe=Ma({},VS,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:a_}),IPe=Bc(EPe),MPe=Ma({},zx,{propertyName:0,elapsedTime:0,pseudoElement:0}),APe=Bc(MPe),LPe=Ma({},AE,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),NPe=Bc(LPe),FPe=[9,13,27,32],o_=Hm&&"CompositionEvent"in window,wS=null;Hm&&"documentMode"in document&&(wS=document.documentMode);var OPe=Hm&&"TextEvent"in window&&!wS,nK=Hm&&(!o_||wS&&8<wS&&11>=wS),O9=" ",z9=!1;function iK(e,t){switch(e){case"keyup":return FPe.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function aK(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var mx=!1;function zPe(e,t){switch(e){case"compositionend":return aK(t);case"keypress":return t.which!==32?null:(z9=!0,O9);case"textInput":return e=t.data,e===O9&&z9?null:e;default:return null}}function jPe(e,t){if(mx)return e==="compositionend"||!o_&&iK(e,t)?(e=rK(),QD=n_=Eg=null,mx=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return nK&&t.locale!=="ko"?null:t.data;default:return null}}var _Pe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function j9(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!_Pe[e.type]:t==="textarea"}function oK(e,t,r,n){j7(n),t=mE(t,"onChange"),0<t.length&&(r=new i_("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var kS=null,FS=null;function BPe(e){vK(e,0)}function LE(e){var t=hx(e);if(M7(t))return e}function WPe(e,t){if(e==="change")return t}var sK=!1;Hm&&(Hm?(BD="oninput"in document,BD||(Wj=document.createElement("div"),Wj.setAttribute("oninput","return;"),BD=typeof Wj.oninput=="function"),_D=BD):_D=!1,sK=_D&&(!document.documentMode||9<document.documentMode));var _D,BD,Wj;function _9(){kS&&(kS.detachEvent("onpropertychange",lK),FS=kS=null)}function lK(e){if(e.propertyName==="value"&&LE(FS)){var t=[];oK(t,FS,e,X5(e)),$7(BPe,t)}}function $Pe(e,t,r){e==="focusin"?(_9(),kS=t,FS=r,kS.attachEvent("onpropertychange",lK)):e==="focusout"&&_9()}function RPe(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return LE(FS)}function UPe(e,t){if(e==="click")return LE(t)}function HPe(e,t){if(e==="input"||e==="change")return LE(t)}function qPe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Lu=typeof Object.is=="function"?Object.is:qPe;function OS(e,t){if(Lu(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!e5.call(t,i)||!Lu(e[i],t[i]))return!1}return!0}function B9(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function W9(e,t){var r=B9(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=B9(r)}}function cK(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?cK(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function dK(){for(var e=window,t=oE();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch(n){r=!1}if(r)e=t.contentWindow;else break;t=oE(e.document)}return t}function s_(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function VPe(e){var t=dK(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&cK(r.ownerDocument.documentElement,r)){if(n!==null&&s_(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,a=Math.min(n.start,i);n=n.end===void 0?a:Math.min(n.end,i),!e.extend&&a>n&&(i=n,n=a,a=i),i=W9(r,a);var o=W9(r,n);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var GPe=Hm&&"documentMode"in document&&11>=document.documentMode,fx=null,b5=null,SS=null,x5=!1;function $9(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;x5||fx==null||fx!==oE(n)||(n=fx,"selectionStart"in n&&s_(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),SS&&OS(SS,n)||(SS=n,n=mE(b5,"onSelect"),0<n.length&&(t=new i_("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=fx)))}function WD(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var gx={animationend:WD("Animation","AnimationEnd"),animationiteration:WD("Animation","AnimationIteration"),animationstart:WD("Animation","AnimationStart"),transitionend:WD("Transition","TransitionEnd")},$j={},uK={};Hm&&(uK=document.createElement("div").style,"AnimationEvent"in window||(delete gx.animationend.animation,delete gx.animationiteration.animation,delete gx.animationstart.animation),"TransitionEvent"in window||delete gx.transitionend.transition);function NE(e){if($j[e])return $j[e];if(!gx[e])return e;var t=gx[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in uK)return $j[e]=t[r];return e}var pK=NE("animationend"),mK=NE("animationiteration"),fK=NE("animationstart"),gK=NE("transitionend"),hK=new Map,R9="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Wg(e,t){hK.set(e,t),Nv(t,[e])}for($D=0;$D<R9.length;$D++)RD=R9[$D],U9=RD.toLowerCase(),H9=RD[0].toUpperCase()+RD.slice(1),Wg(U9,"on"+H9);var RD,U9,H9,$D;Wg(pK,"onAnimationEnd");Wg(mK,"onAnimationIteration");Wg(fK,"onAnimationStart");Wg("dblclick","onDoubleClick");Wg("focusin","onFocus");Wg("focusout","onBlur");Wg(gK,"onTransitionEnd");Ix("onMouseEnter",["mouseout","mouseover"]);Ix("onMouseLeave",["mouseout","mouseover"]);Ix("onPointerEnter",["pointerout","pointerover"]);Ix("onPointerLeave",["pointerout","pointerover"]);Nv("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Nv("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Nv("onBeforeInput",["compositionend","keypress","textInput","paste"]);Nv("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Nv("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Nv("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var yS="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),YPe=new Set("cancel close invalid load scroll toggle".split(" ").concat(yS));function q9(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,YCe(n,t,void 0,e),e.currentTarget=null}function vK(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var o=n.length-1;0<=o;o--){var s=n[o],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==a&&i.isPropagationStopped())break e;q9(i,s,c),a=l}else for(o=0;o<n.length;o++){if(s=n[o],l=s.instance,c=s.currentTarget,s=s.listener,l!==a&&i.isPropagationStopped())break e;q9(i,s,c),a=l}}}if(lE)throw e=g5,lE=!1,g5=null,e}function Ji(e,t){var r=t[C5];r===void 0&&(r=t[C5]=new Set);var n=e+"__bubble";r.has(n)||(yK(t,e,2,!1),r.add(n))}function Rj(e,t,r){var n=0;t&&(n|=4),yK(r,e,n,t)}var UD="_reactListening"+Math.random().toString(36).slice(2);function zS(e){if(!e[UD]){e[UD]=!0,C7.forEach(function(r){r!=="selectionchange"&&(YPe.has(r)||Rj(r,!1,e),Rj(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[UD]||(t[UD]=!0,Rj("selectionchange",!1,t))}}function yK(e,t,r,n){switch(tK(t)){case 1:var i=dPe;break;case 4:i=uPe;break;default:i=r_}r=i.bind(null,t,r,e),i=void 0,!f5||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Uj(e,t,r,n,i){var a=n;if((t&1)===0&&(t&2)===0&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var s=n.stateNode.containerInfo;if(s===i||s.nodeType===8&&s.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;s!==null;){if(o=Sv(s),o===null)return;if(l=o.tag,l===5||l===6){n=a=o;continue e}s=s.parentNode}}n=n.return}$7(function(){var c=a,d=X5(r),u=[];e:{var p=hK.get(e);if(p!==void 0){var m=i_,g=e;switch(e){case"keypress":if(XD(r)===0)break e;case"keydown":case"keyup":m=PPe;break;case"focusin":g="focus",m=Bj;break;case"focusout":g="blur",m=Bj;break;case"beforeblur":case"afterblur":m=Bj;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=L9;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=fPe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=IPe;break;case pK:case mK:case fK:m=vPe;break;case gK:m=APe;break;case"scroll":m=pPe;break;case"wheel":m=NPe;break;case"copy":case"cut":case"paste":m=bPe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=F9}var f=(t&4)!==0,v=!f&&e==="scroll",h=f?p!==null?p+"Capture":null:p;f=[];for(var y=c,b;y!==null;){b=y;var k=b.stateNode;if(b.tag===5&&k!==null&&(b=k,h!==null&&(k=MS(y,h),k!=null&&f.push(jS(y,k,b)))),v)break;y=y.return}0<f.length&&(p=new m(p,g,null,r,d),u.push({event:p,listeners:f}))}}if((t&7)===0){e:{if(p=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",p&&r!==p5&&(g=r.relatedTarget||r.fromElement)&&(Sv(g)||g[qm]))break e;if((m||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,m?(g=r.relatedTarget||r.toElement,m=c,g=g?Sv(g):null,g!==null&&(v=Fv(g),g!==v||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=c),m!==g)){if(f=L9,k="onMouseLeave",h="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(f=F9,k="onPointerLeave",h="onPointerEnter",y="pointer"),v=m==null?p:hx(m),b=g==null?p:hx(g),p=new f(k,y+"leave",m,r,d),p.target=v,p.relatedTarget=b,k=null,Sv(d)===c&&(f=new f(h,y+"enter",g,r,d),f.target=b,f.relatedTarget=v,k=f),v=k,m&&g)t:{for(f=m,h=g,y=0,b=f;b;b=dx(b))y++;for(b=0,k=h;k;k=dx(k))b++;for(;0<y-b;)f=dx(f),y--;for(;0<b-y;)h=dx(h),b--;for(;y--;){if(f===h||h!==null&&f===h.alternate)break t;f=dx(f),h=dx(h)}f=null}else f=null;m!==null&&V9(u,p,m,f,!1),g!==null&&v!==null&&V9(u,v,g,f,!0)}}e:{if(p=c?hx(c):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var x=WPe;else if(j9(p))if(sK)x=HPe;else{x=RPe;var S=$Pe}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(x=UPe);if(x&&(x=x(e,c))){oK(u,x,r,d);break e}S&&S(e,p,c),e==="focusout"&&(S=p._wrapperState)&&S.controlled&&p.type==="number"&&s5(p,"number",p.value)}switch(S=c?hx(c):window,e){case"focusin":(j9(S)||S.contentEditable==="true")&&(fx=S,b5=c,SS=null);break;case"focusout":SS=b5=fx=null;break;case"mousedown":x5=!0;break;case"contextmenu":case"mouseup":case"dragend":x5=!1,$9(u,r,d);break;case"selectionchange":if(GPe)break;case"keydown":case"keyup":$9(u,r,d)}var w;if(o_)e:{switch(e){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else mx?iK(e,r)&&(C="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(C="onCompositionStart");C&&(nK&&r.locale!=="ko"&&(mx||C!=="onCompositionStart"?C==="onCompositionEnd"&&mx&&(w=rK()):(Eg=d,n_="value"in Eg?Eg.value:Eg.textContent,mx=!0)),S=mE(c,C),0<S.length&&(C=new N9(C,e,null,r,d),u.push({event:C,listeners:S}),w?C.data=w:(w=aK(r),w!==null&&(C.data=w)))),(w=OPe?zPe(e,r):jPe(e,r))&&(c=mE(c,"onBeforeInput"),0<c.length&&(d=new N9("onBeforeInput","beforeinput",null,r,d),u.push({event:d,listeners:c}),d.data=w))}vK(u,t)})}function jS(e,t,r){return{instance:e,listener:t,currentTarget:r}}function mE(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=MS(e,r),a!=null&&n.unshift(jS(e,a,i)),a=MS(e,t),a!=null&&n.push(jS(e,a,i))),e=e.return}return n}function dx(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function V9(e,t,r,n,i){for(var a=t._reactName,o=[];r!==null&&r!==n;){var s=r,l=s.alternate,c=s.stateNode;if(l!==null&&l===n)break;s.tag===5&&c!==null&&(s=c,i?(l=MS(r,a),l!=null&&o.unshift(jS(r,l,s))):i||(l=MS(r,a),l!=null&&o.push(jS(r,l,s)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var KPe=/\r\n?/g,JPe=/\u0000|\uFFFD/g;function G9(e){return(typeof e=="string"?e:""+e).replace(KPe,`
`).replace(JPe,"")}function HD(e,t,r){if(t=G9(t),G9(e)!==t&&r)throw Error(Ve(425))}function fE(){}var w5=null,k5=null;function S5(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var T5=typeof setTimeout=="function"?setTimeout:void 0,QPe=typeof clearTimeout=="function"?clearTimeout:void 0,Y9=typeof Promise=="function"?Promise:void 0,XPe=typeof queueMicrotask=="function"?queueMicrotask:typeof Y9!="undefined"?function(e){return Y9.resolve(null).then(e).catch(ZPe)}:T5;function ZPe(e){setTimeout(function(){throw e})}function Hj(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),NS(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);NS(t)}function Ng(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function K9(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var jx=Math.random().toString(36).slice(2),Tp="__reactFiber$"+jx,_S="__reactProps$"+jx,qm="__reactContainer$"+jx,C5="__reactEvents$"+jx,eDe="__reactListeners$"+jx,tDe="__reactHandles$"+jx;function Sv(e){var t=e[Tp];if(t)return t;for(var r=e.parentNode;r;){if(t=r[qm]||r[Tp]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=K9(e);e!==null;){if(r=e[Tp])return r;e=K9(e)}return t}e=r,r=e.parentNode}return null}function GS(e){return e=e[Tp]||e[qm],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function hx(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ve(33))}function FE(e){return e[_S]||null}var P5=[],vx=-1;function $g(e){return{current:e}}function Qi(e){0>vx||(e.current=P5[vx],P5[vx]=null,vx--)}function Ri(e,t){vx++,P5[vx]=e.current,e.current=t}var Bg={},Ks=$g(Bg),oc=$g(!1),Ev=Bg;function Mx(e,t){var r=e.type.contextTypes;if(!r)return Bg;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in r)i[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function sc(e){return e=e.childContextTypes,e!=null}function gE(){Qi(oc),Qi(Ks)}function J9(e,t,r){if(Ks.current!==Bg)throw Error(Ve(168));Ri(Ks,t),Ri(oc,r)}function bK(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(Ve(108,$Ce(e)||"Unknown",i));return Ma({},r,n)}function hE(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Bg,Ev=Ks.current,Ri(Ks,e),Ri(oc,oc.current),!0}function Q9(e,t,r){var n=e.stateNode;if(!n)throw Error(Ve(169));r?(e=bK(e,t,Ev),n.__reactInternalMemoizedMergedChildContext=e,Qi(oc),Qi(Ks),Ri(Ks,e)):Qi(oc),Ri(oc,r)}var Wm=null,OE=!1,qj=!1;function xK(e){Wm===null?Wm=[e]:Wm.push(e)}function rDe(e){OE=!0,xK(e)}function Rg(){if(!qj&&Wm!==null){qj=!0;var e=0,t=gi;try{var r=Wm;for(gi=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Wm=null,OE=!1}catch(i){throw Wm!==null&&(Wm=Wm.slice(e+1)),q7(Z5,Rg),i}finally{gi=t,qj=!1}}return null}var yx=[],bx=0,vE=null,yE=0,yd=[],bd=0,Iv=null,$m=1,Rm="";function wv(e,t){yx[bx++]=yE,yx[bx++]=vE,vE=e,yE=t}function wK(e,t,r){yd[bd++]=$m,yd[bd++]=Rm,yd[bd++]=Iv,Iv=e;var n=$m;e=Rm;var i=32-Mu(n)-1;n&=~(1<<i),r+=1;var a=32-Mu(t)+i;if(30<a){var o=i-i%5;a=(n&(1<<o)-1).toString(32),n>>=o,i-=o,$m=1<<32-Mu(t)+i|r<<i|n,Rm=a+e}else $m=1<<a|r<<i|n,Rm=e}function l_(e){e.return!==null&&(wv(e,1),wK(e,1,0))}function c_(e){for(;e===vE;)vE=yx[--bx],yx[bx]=null,yE=yx[--bx],yx[bx]=null;for(;e===Iv;)Iv=yd[--bd],yd[bd]=null,Rm=yd[--bd],yd[bd]=null,$m=yd[--bd],yd[bd]=null}var jc=null,zc=null,aa=!1,Iu=null;function kK(e,t){var r=xd(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function X9(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,jc=e,zc=Ng(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,jc=e,zc=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Iv!==null?{id:$m,overflow:Rm}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=xd(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,jc=e,zc=null,!0):!1;default:return!1}}function D5(e){return(e.mode&1)!==0&&(e.flags&128)===0}function E5(e){if(aa){var t=zc;if(t){var r=t;if(!X9(e,t)){if(D5(e))throw Error(Ve(418));t=Ng(r.nextSibling);var n=jc;t&&X9(e,t)?kK(n,r):(e.flags=e.flags&-4097|2,aa=!1,jc=e)}}else{if(D5(e))throw Error(Ve(418));e.flags=e.flags&-4097|2,aa=!1,jc=e}}}function Z9(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;jc=e}function qD(e){if(e!==jc)return!1;if(!aa)return Z9(e),aa=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!S5(e.type,e.memoizedProps)),t&&(t=zc)){if(D5(e))throw SK(),Error(Ve(418));for(;t;)kK(e,t),t=Ng(t.nextSibling)}if(Z9(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ve(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){zc=Ng(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}zc=null}}else zc=jc?Ng(e.stateNode.nextSibling):null;return!0}function SK(){for(var e=zc;e;)e=Ng(e.nextSibling)}function Ax(){zc=jc=null,aa=!1}function d_(e){Iu===null?Iu=[e]:Iu.push(e)}var nDe=Ym.ReactCurrentBatchConfig;function uS(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Ve(309));var n=r.stateNode}if(!n)throw Error(Ve(147,e));var i=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(o){var s=i.refs;o===null?delete s[a]:s[a]=o},t._stringRef=a,t)}if(typeof e!="string")throw Error(Ve(284));if(!r._owner)throw Error(Ve(290,e))}return e}function VD(e,t){throw e=Object.prototype.toString.call(t),Error(Ve(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function e7(e){var t=e._init;return t(e._payload)}function TK(e){function t(h,y){if(e){var b=h.deletions;b===null?(h.deletions=[y],h.flags|=16):b.push(y)}}function r(h,y){if(!e)return null;for(;y!==null;)t(h,y),y=y.sibling;return null}function n(h,y){for(h=new Map;y!==null;)y.key!==null?h.set(y.key,y):h.set(y.index,y),y=y.sibling;return h}function i(h,y){return h=jg(h,y),h.index=0,h.sibling=null,h}function a(h,y,b){return h.index=b,e?(b=h.alternate,b!==null?(b=b.index,b<y?(h.flags|=2,y):b):(h.flags|=2,y)):(h.flags|=1048576,y)}function o(h){return e&&h.alternate===null&&(h.flags|=2),h}function s(h,y,b,k){return y===null||y.tag!==6?(y=Xj(b,h.mode,k),y.return=h,y):(y=i(y,b),y.return=h,y)}function l(h,y,b,k){var x=b.type;return x===px?d(h,y,b.props.children,k,b.key):y!==null&&(y.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===Tg&&e7(x)===y.type)?(k=i(y,b.props),k.ref=uS(h,y,b),k.return=h,k):(k=aE(b.type,b.key,b.props,null,h.mode,k),k.ref=uS(h,y,b),k.return=h,k)}function c(h,y,b,k){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=Zj(b,h.mode,k),y.return=h,y):(y=i(y,b.children||[]),y.return=h,y)}function d(h,y,b,k,x){return y===null||y.tag!==7?(y=Dv(b,h.mode,k,x),y.return=h,y):(y=i(y,b),y.return=h,y)}function u(h,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Xj(""+y,h.mode,b),y.return=h,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case AD:return b=aE(y.type,y.key,y.props,null,h.mode,b),b.ref=uS(h,null,y),b.return=h,b;case ux:return y=Zj(y,h.mode,b),y.return=h,y;case Tg:var k=y._init;return u(h,k(y._payload),b)}if(hS(y)||sS(y))return y=Dv(y,h.mode,b,null),y.return=h,y;VD(h,y)}return null}function p(h,y,b,k){var x=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return x!==null?null:s(h,y,""+b,k);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case AD:return b.key===x?l(h,y,b,k):null;case ux:return b.key===x?c(h,y,b,k):null;case Tg:return x=b._init,p(h,y,x(b._payload),k)}if(hS(b)||sS(b))return x!==null?null:d(h,y,b,k,null);VD(h,b)}return null}function m(h,y,b,k,x){if(typeof k=="string"&&k!==""||typeof k=="number")return h=h.get(b)||null,s(y,h,""+k,x);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case AD:return h=h.get(k.key===null?b:k.key)||null,l(y,h,k,x);case ux:return h=h.get(k.key===null?b:k.key)||null,c(y,h,k,x);case Tg:var S=k._init;return m(h,y,b,S(k._payload),x)}if(hS(k)||sS(k))return h=h.get(b)||null,d(y,h,k,x,null);VD(y,k)}return null}function g(h,y,b,k){for(var x=null,S=null,w=y,C=y=0,D=null;w!==null&&C<b.length;C++){w.index>C?(D=w,w=null):D=w.sibling;var P=p(h,w,b[C],k);if(P===null){w===null&&(w=D);break}e&&w&&P.alternate===null&&t(h,w),y=a(P,y,C),S===null?x=P:S.sibling=P,S=P,w=D}if(C===b.length)return r(h,w),aa&&wv(h,C),x;if(w===null){for(;C<b.length;C++)w=u(h,b[C],k),w!==null&&(y=a(w,y,C),S===null?x=w:S.sibling=w,S=w);return aa&&wv(h,C),x}for(w=n(h,w);C<b.length;C++)D=m(w,h,C,b[C],k),D!==null&&(e&&D.alternate!==null&&w.delete(D.key===null?C:D.key),y=a(D,y,C),S===null?x=D:S.sibling=D,S=D);return e&&w.forEach(function(M){return t(h,M)}),aa&&wv(h,C),x}function f(h,y,b,k){var x=sS(b);if(typeof x!="function")throw Error(Ve(150));if(b=x.call(b),b==null)throw Error(Ve(151));for(var S=x=null,w=y,C=y=0,D=null,P=b.next();w!==null&&!P.done;C++,P=b.next()){w.index>C?(D=w,w=null):D=w.sibling;var M=p(h,w,P.value,k);if(M===null){w===null&&(w=D);break}e&&w&&M.alternate===null&&t(h,w),y=a(M,y,C),S===null?x=M:S.sibling=M,S=M,w=D}if(P.done)return r(h,w),aa&&wv(h,C),x;if(w===null){for(;!P.done;C++,P=b.next())P=u(h,P.value,k),P!==null&&(y=a(P,y,C),S===null?x=P:S.sibling=P,S=P);return aa&&wv(h,C),x}for(w=n(h,w);!P.done;C++,P=b.next())P=m(w,h,C,P.value,k),P!==null&&(e&&P.alternate!==null&&w.delete(P.key===null?C:P.key),y=a(P,y,C),S===null?x=P:S.sibling=P,S=P);return e&&w.forEach(function(z){return t(h,z)}),aa&&wv(h,C),x}function v(h,y,b,k){if(typeof b=="object"&&b!==null&&b.type===px&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case AD:e:{for(var x=b.key,S=y;S!==null;){if(S.key===x){if(x=b.type,x===px){if(S.tag===7){r(h,S.sibling),y=i(S,b.props.children),y.return=h,h=y;break e}}else if(S.elementType===x||typeof x=="object"&&x!==null&&x.$$typeof===Tg&&e7(x)===S.type){r(h,S.sibling),y=i(S,b.props),y.ref=uS(h,S,b),y.return=h,h=y;break e}r(h,S);break}else t(h,S);S=S.sibling}b.type===px?(y=Dv(b.props.children,h.mode,k,b.key),y.return=h,h=y):(k=aE(b.type,b.key,b.props,null,h.mode,k),k.ref=uS(h,y,b),k.return=h,h=k)}return o(h);case ux:e:{for(S=b.key;y!==null;){if(y.key===S)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){r(h,y.sibling),y=i(y,b.children||[]),y.return=h,h=y;break e}else{r(h,y);break}else t(h,y);y=y.sibling}y=Zj(b,h.mode,k),y.return=h,h=y}return o(h);case Tg:return S=b._init,v(h,y,S(b._payload),k)}if(hS(b))return g(h,y,b,k);if(sS(b))return f(h,y,b,k);VD(h,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(r(h,y.sibling),y=i(y,b),y.return=h,h=y):(r(h,y),y=Xj(b,h.mode,k),y.return=h,h=y),o(h)):r(h,y)}return v}var Lx=TK(!0),CK=TK(!1),bE=$g(null),xE=null,xx=null,u_=null;function p_(){u_=xx=xE=null}function m_(e){var t=bE.current;Qi(bE),e._currentValue=t}function I5(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Dx(e,t){xE=e,u_=xx=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(ac=!0),e.firstContext=null)}function kd(e){var t=e._currentValue;if(u_!==e)if(e={context:e,memoizedValue:t,next:null},xx===null){if(xE===null)throw Error(Ve(308));xx=e,xE.dependencies={lanes:0,firstContext:e}}else xx=xx.next=e;return t}var Tv=null;function f_(e){Tv===null?Tv=[e]:Tv.push(e)}function PK(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,f_(t)):(r.next=i.next,i.next=r),t.interleaved=r,Vm(e,n)}function Vm(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Cg=!1;function g_(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function DK(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Um(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Fg(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,(In&2)!==0){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Vm(e,r)}return i=n.interleaved,i===null?(t.next=t,f_(n)):(t.next=i.next,i.next=t),n.interleaved=t,Vm(e,r)}function ZD(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,e_(e,r)}}function t7(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?i=a=o:a=a.next=o,r=r.next}while(r!==null);a===null?i=a=t:a=a.next=t}else i=a=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function wE(e,t,r,n){var i=e.updateQueue;Cg=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,s=i.shared.pending;if(s!==null){i.shared.pending=null;var l=s,c=l.next;l.next=null,o===null?a=c:o.next=c,o=l;var d=e.alternate;d!==null&&(d=d.updateQueue,s=d.lastBaseUpdate,s!==o&&(s===null?d.firstBaseUpdate=c:s.next=c,d.lastBaseUpdate=l))}if(a!==null){var u=i.baseState;o=0,d=c=l=null,s=a;do{var p=s.lane,m=s.eventTime;if((n&p)===p){d!==null&&(d=d.next={eventTime:m,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var g=e,f=s;switch(p=t,m=r,f.tag){case 1:if(g=f.payload,typeof g=="function"){u=g.call(m,u,p);break e}u=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=f.payload,p=typeof g=="function"?g.call(m,u,p):g,p==null)break e;u=Ma({},u,p);break e;case 2:Cg=!0}}s.callback!==null&&s.lane!==0&&(e.flags|=64,p=i.effects,p===null?i.effects=[s]:p.push(s))}else m={eventTime:m,lane:p,tag:s.tag,payload:s.payload,callback:s.callback,next:null},d===null?(c=d=m,l=u):d=d.next=m,o|=p;if(s=s.next,s===null){if(s=i.shared.pending,s===null)break;p=s,s=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(d===null&&(l=u),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);Av|=o,e.lanes=o,e.memoizedState=u}}function r7(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Ve(191,i));i.call(n)}}}var YS={},Pp=$g(YS),BS=$g(YS),WS=$g(YS);function Cv(e){if(e===YS)throw Error(Ve(174));return e}function h_(e,t){switch(Ri(WS,t),Ri(BS,e),Ri(Pp,YS),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:c5(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=c5(t,e)}Qi(Pp),Ri(Pp,t)}function Nx(){Qi(Pp),Qi(BS),Qi(WS)}function EK(e){Cv(WS.current);var t=Cv(Pp.current),r=c5(t,e.type);t!==r&&(Ri(BS,e),Ri(Pp,r))}function v_(e){BS.current===e&&(Qi(Pp),Qi(BS))}var Ea=$g(0);function kE(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Vj=[];function y_(){for(var e=0;e<Vj.length;e++)Vj[e]._workInProgressVersionPrimary=null;Vj.length=0}var eE=Ym.ReactCurrentDispatcher,Gj=Ym.ReactCurrentBatchConfig,Mv=0,Ia=null,Ho=null,ss=null,SE=!1,TS=!1,$S=0,iDe=0;function Vs(){throw Error(Ve(321))}function b_(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Lu(e[r],t[r]))return!1;return!0}function x_(e,t,r,n,i,a){if(Mv=a,Ia=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,eE.current=e===null||e.memoizedState===null?lDe:cDe,e=r(n,i),TS){a=0;do{if(TS=!1,$S=0,25<=a)throw Error(Ve(301));a+=1,ss=Ho=null,t.updateQueue=null,eE.current=dDe,e=r(n,i)}while(TS)}if(eE.current=TE,t=Ho!==null&&Ho.next!==null,Mv=0,ss=Ho=Ia=null,SE=!1,t)throw Error(Ve(300));return e}function w_(){var e=$S!==0;return $S=0,e}function Sp(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ss===null?Ia.memoizedState=ss=e:ss=ss.next=e,ss}function Sd(){if(Ho===null){var e=Ia.alternate;e=e!==null?e.memoizedState:null}else e=Ho.next;var t=ss===null?Ia.memoizedState:ss.next;if(t!==null)ss=t,Ho=e;else{if(e===null)throw Error(Ve(310));Ho=e,e={memoizedState:Ho.memoizedState,baseState:Ho.baseState,baseQueue:Ho.baseQueue,queue:Ho.queue,next:null},ss===null?Ia.memoizedState=ss=e:ss=ss.next=e}return ss}function RS(e,t){return typeof t=="function"?t(e):t}function Yj(e){var t=Sd(),r=t.queue;if(r===null)throw Error(Ve(311));r.lastRenderedReducer=e;var n=Ho,i=n.baseQueue,a=r.pending;if(a!==null){if(i!==null){var o=i.next;i.next=a.next,a.next=o}n.baseQueue=i=a,r.pending=null}if(i!==null){a=i.next,n=n.baseState;var s=o=null,l=null,c=a;do{var d=c.lane;if((Mv&d)===d)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var u={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(s=l=u,o=n):l=l.next=u,Ia.lanes|=d,Av|=d}c=c.next}while(c!==null&&c!==a);l===null?o=n:l.next=s,Lu(n,t.memoizedState)||(ac=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do a=i.lane,Ia.lanes|=a,Av|=a,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Kj(e){var t=Sd(),r=t.queue;if(r===null)throw Error(Ve(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,a=t.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do a=e(a,o.action),o=o.next;while(o!==i);Lu(a,t.memoizedState)||(ac=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function IK(){}function MK(e,t){var r=Ia,n=Sd(),i=t(),a=!Lu(n.memoizedState,i);if(a&&(n.memoizedState=i,ac=!0),n=n.queue,k_(NK.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||ss!==null&&ss.memoizedState.tag&1){if(r.flags|=2048,US(9,LK.bind(null,r,n,i,t),void 0,null),ls===null)throw Error(Ve(349));(Mv&30)!==0||AK(r,t,i)}return i}function AK(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ia.updateQueue,t===null?(t={lastEffect:null,stores:null},Ia.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function LK(e,t,r,n){t.value=r,t.getSnapshot=n,FK(t)&&OK(e)}function NK(e,t,r){return r(function(){FK(t)&&OK(e)})}function FK(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Lu(e,r)}catch(n){return!0}}function OK(e){var t=Vm(e,1);t!==null&&Au(t,e,1,-1)}function n7(e){var t=Sp();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:RS,lastRenderedState:e},t.queue=e,e=e.dispatch=sDe.bind(null,Ia,e),[t.memoizedState,e]}function US(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Ia.updateQueue,t===null?(t={lastEffect:null,stores:null},Ia.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function zK(){return Sd().memoizedState}function tE(e,t,r,n){var i=Sp();Ia.flags|=e,i.memoizedState=US(1|t,r,void 0,n===void 0?null:n)}function zE(e,t,r,n){var i=Sd();n=n===void 0?null:n;var a=void 0;if(Ho!==null){var o=Ho.memoizedState;if(a=o.destroy,n!==null&&b_(n,o.deps)){i.memoizedState=US(t,r,a,n);return}}Ia.flags|=e,i.memoizedState=US(1|t,r,a,n)}function i7(e,t){return tE(8390656,8,e,t)}function k_(e,t){return zE(2048,8,e,t)}function jK(e,t){return zE(4,2,e,t)}function _K(e,t){return zE(4,4,e,t)}function BK(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function WK(e,t,r){return r=r!=null?r.concat([e]):null,zE(4,4,BK.bind(null,t,e),r)}function S_(){}function $K(e,t){var r=Sd();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&b_(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function RK(e,t){var r=Sd();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&b_(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function UK(e,t,r){return(Mv&21)===0?(e.baseState&&(e.baseState=!1,ac=!0),e.memoizedState=r):(Lu(r,t)||(r=Y7(),Ia.lanes|=r,Av|=r,e.baseState=!0),t)}function aDe(e,t){var r=gi;gi=r!==0&&4>r?r:4,e(!0);var n=Gj.transition;Gj.transition={};try{e(!1),t()}finally{gi=r,Gj.transition=n}}function HK(){return Sd().memoizedState}function oDe(e,t,r){var n=zg(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},qK(e))VK(t,r);else if(r=PK(e,t,r,n),r!==null){var i=Pl();Au(r,e,n,i),GK(r,t,n)}}function sDe(e,t,r){var n=zg(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(qK(e))VK(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var o=t.lastRenderedState,s=a(o,r);if(i.hasEagerState=!0,i.eagerState=s,Lu(s,o)){var l=t.interleaved;l===null?(i.next=i,f_(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch(c){}r=PK(e,t,i,n),r!==null&&(i=Pl(),Au(r,e,n,i),GK(r,t,n))}}function qK(e){var t=e.alternate;return e===Ia||t!==null&&t===Ia}function VK(e,t){TS=SE=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function GK(e,t,r){if((r&4194240)!==0){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,e_(e,r)}}var TE={readContext:kd,useCallback:Vs,useContext:Vs,useEffect:Vs,useImperativeHandle:Vs,useInsertionEffect:Vs,useLayoutEffect:Vs,useMemo:Vs,useReducer:Vs,useRef:Vs,useState:Vs,useDebugValue:Vs,useDeferredValue:Vs,useTransition:Vs,useMutableSource:Vs,useSyncExternalStore:Vs,useId:Vs,unstable_isNewReconciler:!1},lDe={readContext:kd,useCallback:function(e,t){return Sp().memoizedState=[e,t===void 0?null:t],e},useContext:kd,useEffect:i7,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,tE(4194308,4,BK.bind(null,t,e),r)},useLayoutEffect:function(e,t){return tE(4194308,4,e,t)},useInsertionEffect:function(e,t){return tE(4,2,e,t)},useMemo:function(e,t){var r=Sp();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Sp();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=oDe.bind(null,Ia,e),[n.memoizedState,e]},useRef:function(e){var t=Sp();return e={current:e},t.memoizedState=e},useState:n7,useDebugValue:S_,useDeferredValue:function(e){return Sp().memoizedState=e},useTransition:function(){var e=n7(!1),t=e[0];return e=aDe.bind(null,e[1]),Sp().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Ia,i=Sp();if(aa){if(r===void 0)throw Error(Ve(407));r=r()}else{if(r=t(),ls===null)throw Error(Ve(349));(Mv&30)!==0||AK(n,t,r)}i.memoizedState=r;var a={value:r,getSnapshot:t};return i.queue=a,i7(NK.bind(null,n,a,e),[e]),n.flags|=2048,US(9,LK.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=Sp(),t=ls.identifierPrefix;if(aa){var r=Rm,n=$m;r=(n&~(1<<32-Mu(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=$S++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=iDe++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},cDe={readContext:kd,useCallback:$K,useContext:kd,useEffect:k_,useImperativeHandle:WK,useInsertionEffect:jK,useLayoutEffect:_K,useMemo:RK,useReducer:Yj,useRef:zK,useState:function(){return Yj(RS)},useDebugValue:S_,useDeferredValue:function(e){var t=Sd();return UK(t,Ho.memoizedState,e)},useTransition:function(){var e=Yj(RS)[0],t=Sd().memoizedState;return[e,t]},useMutableSource:IK,useSyncExternalStore:MK,useId:HK,unstable_isNewReconciler:!1},dDe={readContext:kd,useCallback:$K,useContext:kd,useEffect:k_,useImperativeHandle:WK,useInsertionEffect:jK,useLayoutEffect:_K,useMemo:RK,useReducer:Kj,useRef:zK,useState:function(){return Kj(RS)},useDebugValue:S_,useDeferredValue:function(e){var t=Sd();return Ho===null?t.memoizedState=e:UK(t,Ho.memoizedState,e)},useTransition:function(){var e=Kj(RS)[0],t=Sd().memoizedState;return[e,t]},useMutableSource:IK,useSyncExternalStore:MK,useId:HK,unstable_isNewReconciler:!1};function Du(e,t){if(e&&e.defaultProps){t=Ma({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function M5(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Ma({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var jE={isMounted:function(e){return(e=e._reactInternals)?Fv(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Pl(),i=zg(e),a=Um(n,i);a.payload=t,r!=null&&(a.callback=r),t=Fg(e,a,i),t!==null&&(Au(t,e,i,n),ZD(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Pl(),i=zg(e),a=Um(n,i);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=Fg(e,a,i),t!==null&&(Au(t,e,i,n),ZD(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Pl(),n=zg(e),i=Um(r,n);i.tag=2,t!=null&&(i.callback=t),t=Fg(e,i,n),t!==null&&(Au(t,e,n,r),ZD(t,e,n))}};function a7(e,t,r,n,i,a,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,o):t.prototype&&t.prototype.isPureReactComponent?!OS(r,n)||!OS(i,a):!0}function YK(e,t,r){var n=!1,i=Bg,a=t.contextType;return typeof a=="object"&&a!==null?a=kd(a):(i=sc(t)?Ev:Ks.current,n=t.contextTypes,a=(n=n!=null)?Mx(e,i):Bg),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=jE,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function o7(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&jE.enqueueReplaceState(t,t.state,null)}function A5(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},g_(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=kd(a):(a=sc(t)?Ev:Ks.current,i.context=Mx(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(M5(e,t,a,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&jE.enqueueReplaceState(i,i.state,null),wE(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Fx(e,t){try{var r="",n=t;do r+=WCe(n),n=n.return;while(n);var i=r}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function Jj(e,t,r){return{value:e,source:null,stack:r!=null?r:null,digest:t!=null?t:null}}function L5(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var uDe=typeof WeakMap=="function"?WeakMap:Map;function KK(e,t,r){r=Um(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){PE||(PE=!0,R5=n),L5(e,t)},r}function JK(e,t,r){r=Um(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){L5(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){L5(e,t),typeof n!="function"&&(Og===null?Og=new Set([this]):Og.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function s7(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new uDe;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=CDe.bind(null,e,t,r),t.then(e,e))}function l7(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function c7(e,t,r,n,i){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Um(-1,1),t.tag=2,Fg(r,t,1))),r.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var pDe=Ym.ReactCurrentOwner,ac=!1;function Cl(e,t,r,n){t.child=e===null?CK(t,null,r,n):Lx(t,e.child,r,n)}function d7(e,t,r,n,i){r=r.render;var a=t.ref;return Dx(t,i),n=x_(e,t,r,n,a,i),r=w_(),e!==null&&!ac?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Gm(e,t,i)):(aa&&r&&l_(t),t.flags|=1,Cl(e,t,n,i),t.child)}function u7(e,t,r,n,i){if(e===null){var a=r.type;return typeof a=="function"&&!A_(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,QK(e,t,a,n,i)):(e=aE(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,(e.lanes&i)===0){var o=a.memoizedProps;if(r=r.compare,r=r!==null?r:OS,r(o,n)&&e.ref===t.ref)return Gm(e,t,i)}return t.flags|=1,e=jg(a,n),e.ref=t.ref,e.return=t,t.child=e}function QK(e,t,r,n,i){if(e!==null){var a=e.memoizedProps;if(OS(a,n)&&e.ref===t.ref)if(ac=!1,t.pendingProps=n=a,(e.lanes&i)!==0)(e.flags&131072)!==0&&(ac=!0);else return t.lanes=e.lanes,Gm(e,t,i)}return N5(e,t,r,n,i)}function XK(e,t,r){var n=t.pendingProps,i=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ri(kx,Oc),Oc|=r;else{if((r&1073741824)===0)return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ri(kx,Oc),Oc|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,Ri(kx,Oc),Oc|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,Ri(kx,Oc),Oc|=n;return Cl(e,t,i,r),t.child}function ZK(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function N5(e,t,r,n,i){var a=sc(r)?Ev:Ks.current;return a=Mx(t,a),Dx(t,i),r=x_(e,t,r,n,a,i),n=w_(),e!==null&&!ac?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Gm(e,t,i)):(aa&&n&&l_(t),t.flags|=1,Cl(e,t,r,i),t.child)}function p7(e,t,r,n,i){if(sc(r)){var a=!0;hE(t)}else a=!1;if(Dx(t,i),t.stateNode===null)rE(e,t),YK(t,r,n),A5(t,r,n,i),n=!0;else if(e===null){var o=t.stateNode,s=t.memoizedProps;o.props=s;var l=o.context,c=r.contextType;typeof c=="object"&&c!==null?c=kd(c):(c=sc(r)?Ev:Ks.current,c=Mx(t,c));var d=r.getDerivedStateFromProps,u=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";u||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(s!==n||l!==c)&&o7(t,o,n,c),Cg=!1;var p=t.memoizedState;o.state=p,wE(t,n,o,i),l=t.memoizedState,s!==n||p!==l||oc.current||Cg?(typeof d=="function"&&(M5(t,r,d,n),l=t.memoizedState),(s=Cg||a7(t,r,s,n,p,l,c))?(u||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),o.props=n,o.state=l,o.context=c,n=s):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,DK(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:Du(t.type,s),o.props=c,u=t.pendingProps,p=o.context,l=r.contextType,typeof l=="object"&&l!==null?l=kd(l):(l=sc(r)?Ev:Ks.current,l=Mx(t,l));var m=r.getDerivedStateFromProps;(d=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(s!==u||p!==l)&&o7(t,o,n,l),Cg=!1,p=t.memoizedState,o.state=p,wE(t,n,o,i);var g=t.memoizedState;s!==u||p!==g||oc.current||Cg?(typeof m=="function"&&(M5(t,r,m,n),g=t.memoizedState),(c=Cg||a7(t,r,c,n,p,g,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,g,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,g,l)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),o.props=n,o.state=g,o.context=l,n=c):(typeof o.componentDidUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return F5(e,t,r,n,a,i)}function F5(e,t,r,n,i,a){ZK(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return i&&Q9(t,r,!1),Gm(e,t,a);n=t.stateNode,pDe.current=t;var s=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=Lx(t,e.child,null,a),t.child=Lx(t,null,s,a)):Cl(e,t,s,a),t.memoizedState=n.state,i&&Q9(t,r,!0),t.child}function eJ(e){var t=e.stateNode;t.pendingContext?J9(e,t.pendingContext,t.pendingContext!==t.context):t.context&&J9(e,t.context,!1),h_(e,t.containerInfo)}function m7(e,t,r,n,i){return Ax(),d_(i),t.flags|=256,Cl(e,t,r,n),t.child}var O5={dehydrated:null,treeContext:null,retryLane:0};function z5(e){return{baseLanes:e,cachePool:null,transitions:null}}function tJ(e,t,r){var n=t.pendingProps,i=Ea.current,a=!1,o=(t.flags&128)!==0,s;if((s=o)||(s=e!==null&&e.memoizedState===null?!1:(i&2)!==0),s?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Ri(Ea,i&1),e===null)return E5(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(o=n.children,e=n.fallback,a?(n=t.mode,a=t.child,o={mode:"hidden",children:o},(n&1)===0&&a!==null?(a.childLanes=0,a.pendingProps=o):a=WE(o,n,0,null),e=Dv(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=z5(r),t.memoizedState=O5,e):T_(t,o));if(i=e.memoizedState,i!==null&&(s=i.dehydrated,s!==null))return mDe(e,t,o,n,s,i,r);if(a){a=n.fallback,o=t.mode,i=e.child,s=i.sibling;var l={mode:"hidden",children:n.children};return(o&1)===0&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=jg(i,l),n.subtreeFlags=i.subtreeFlags&14680064),s!==null?a=jg(s,a):(a=Dv(a,o,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,o=e.child.memoizedState,o=o===null?z5(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=e.childLanes&~r,t.memoizedState=O5,n}return a=e.child,e=a.sibling,n=jg(a,{mode:"visible",children:n.children}),(t.mode&1)===0&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function T_(e,t){return t=WE({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function GD(e,t,r,n){return n!==null&&d_(n),Lx(t,e.child,null,r),e=T_(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function mDe(e,t,r,n,i,a,o){if(r)return t.flags&256?(t.flags&=-257,n=Jj(Error(Ve(422))),GD(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,i=t.mode,n=WE({mode:"visible",children:n.children},i,0,null),a=Dv(a,i,o,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,(t.mode&1)!==0&&Lx(t,e.child,null,o),t.child.memoizedState=z5(o),t.memoizedState=O5,a);if((t.mode&1)===0)return GD(e,t,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var s=n.dgst;return n=s,a=Error(Ve(419)),n=Jj(a,n,void 0),GD(e,t,o,n)}if(s=(o&e.childLanes)!==0,ac||s){if(n=ls,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=(i&(n.suspendedLanes|o))!==0?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,Vm(e,i),Au(n,e,i,-1))}return M_(),n=Jj(Error(Ve(421))),GD(e,t,o,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=PDe.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,zc=Ng(i.nextSibling),jc=t,aa=!0,Iu=null,e!==null&&(yd[bd++]=$m,yd[bd++]=Rm,yd[bd++]=Iv,$m=e.id,Rm=e.overflow,Iv=t),t=T_(t,n.children),t.flags|=4096,t)}function f7(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),I5(e.return,t,r)}function Qj(e,t,r,n,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function rJ(e,t,r){var n=t.pendingProps,i=n.revealOrder,a=n.tail;if(Cl(e,t,n.children,r),n=Ea.current,(n&2)!==0)n=n&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&f7(e,r,t);else if(e.tag===19)f7(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Ri(Ea,n),(t.mode&1)===0)t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&kE(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),Qj(t,!1,i,r,a);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&kE(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}Qj(t,!0,r,null,a);break;case"together":Qj(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function rE(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Gm(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Av|=t.lanes,(r&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(Ve(153));if(t.child!==null){for(e=t.child,r=jg(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=jg(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function fDe(e,t,r){switch(t.tag){case 3:eJ(t),Ax();break;case 5:EK(t);break;case 1:sc(t.type)&&hE(t);break;case 4:h_(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Ri(bE,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Ri(Ea,Ea.current&1),t.flags|=128,null):(r&t.child.childLanes)!==0?tJ(e,t,r):(Ri(Ea,Ea.current&1),e=Gm(e,t,r),e!==null?e.sibling:null);Ri(Ea,Ea.current&1);break;case 19:if(n=(r&t.childLanes)!==0,(e.flags&128)!==0){if(n)return rJ(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ri(Ea,Ea.current),n)break;return null;case 22:case 23:return t.lanes=0,XK(e,t,r)}return Gm(e,t,r)}var nJ,j5,iJ,aJ;nJ=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};j5=function(){};iJ=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,Cv(Pp.current);var a=null;switch(r){case"input":i=a5(e,i),n=a5(e,n),a=[];break;case"select":i=Ma({},i,{value:void 0}),n=Ma({},n,{value:void 0}),a=[];break;case"textarea":i=l5(e,i),n=l5(e,n),a=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=fE)}d5(r,n);var o;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var s=i[c];for(o in s)s.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(ES.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in n){var l=n[c];if(s=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==s&&(l!=null||s!=null))if(c==="style")if(s){for(o in s)!s.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in l)l.hasOwnProperty(o)&&s[o]!==l[o]&&(r||(r={}),r[o]=l[o])}else r||(a||(a=[]),a.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,s=s?s.__html:void 0,l!=null&&s!==l&&(a=a||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(ES.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Ji("scroll",e),a||s===l||(a=[])):(a=a||[]).push(c,l))}r&&(a=a||[]).push("style",r);var c=a;(t.updateQueue=c)&&(t.flags|=4)}};aJ=function(e,t,r,n){r!==n&&(t.flags|=4)};function pS(e,t){if(!aa)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Gs(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function gDe(e,t,r){var n=t.pendingProps;switch(c_(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gs(t),null;case 1:return sc(t.type)&&gE(),Gs(t),null;case 3:return n=t.stateNode,Nx(),Qi(oc),Qi(Ks),y_(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(qD(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Iu!==null&&(q5(Iu),Iu=null))),j5(e,t),Gs(t),null;case 5:v_(t);var i=Cv(WS.current);if(r=t.type,e!==null&&t.stateNode!=null)iJ(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Ve(166));return Gs(t),null}if(e=Cv(Pp.current),qD(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[Tp]=t,n[_S]=a,e=(t.mode&1)!==0,r){case"dialog":Ji("cancel",n),Ji("close",n);break;case"iframe":case"object":case"embed":Ji("load",n);break;case"video":case"audio":for(i=0;i<yS.length;i++)Ji(yS[i],n);break;case"source":Ji("error",n);break;case"img":case"image":case"link":Ji("error",n),Ji("load",n);break;case"details":Ji("toggle",n);break;case"input":k9(n,a),Ji("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Ji("invalid",n);break;case"textarea":T9(n,a),Ji("invalid",n)}d5(r,a),i=null;for(var o in a)if(a.hasOwnProperty(o)){var s=a[o];o==="children"?typeof s=="string"?n.textContent!==s&&(a.suppressHydrationWarning!==!0&&HD(n.textContent,s,e),i=["children",s]):typeof s=="number"&&n.textContent!==""+s&&(a.suppressHydrationWarning!==!0&&HD(n.textContent,s,e),i=["children",""+s]):ES.hasOwnProperty(o)&&s!=null&&o==="onScroll"&&Ji("scroll",n)}switch(r){case"input":LD(n),S9(n,a,!0);break;case"textarea":LD(n),C9(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=fE)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=N7(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[Tp]=t,e[_S]=n,nJ(e,t,!1,!1),t.stateNode=e;e:{switch(o=u5(r,n),r){case"dialog":Ji("cancel",e),Ji("close",e),i=n;break;case"iframe":case"object":case"embed":Ji("load",e),i=n;break;case"video":case"audio":for(i=0;i<yS.length;i++)Ji(yS[i],e);i=n;break;case"source":Ji("error",e),i=n;break;case"img":case"image":case"link":Ji("error",e),Ji("load",e),i=n;break;case"details":Ji("toggle",e),i=n;break;case"input":k9(e,n),i=a5(e,n),Ji("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Ma({},n,{value:void 0}),Ji("invalid",e);break;case"textarea":T9(e,n),i=l5(e,n),Ji("invalid",e);break;default:i=n}d5(r,i),s=i;for(a in s)if(s.hasOwnProperty(a)){var l=s[a];a==="style"?z7(e,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&F7(e,l)):a==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&IS(e,l):typeof l=="number"&&IS(e,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(ES.hasOwnProperty(a)?l!=null&&a==="onScroll"&&Ji("scroll",e):l!=null&&Y5(e,a,l,o))}switch(r){case"input":LD(e),S9(e,n,!1);break;case"textarea":LD(e),C9(e);break;case"option":n.value!=null&&e.setAttribute("value",""+_g(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?Sx(e,!!n.multiple,a,!1):n.defaultValue!=null&&Sx(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=fE)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Gs(t),null;case 6:if(e&&t.stateNode!=null)aJ(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Ve(166));if(r=Cv(WS.current),Cv(Pp.current),qD(t)){if(n=t.stateNode,r=t.memoizedProps,n[Tp]=t,(a=n.nodeValue!==r)&&(e=jc,e!==null))switch(e.tag){case 3:HD(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&HD(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Tp]=t,t.stateNode=n}return Gs(t),null;case 13:if(Qi(Ea),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(aa&&zc!==null&&(t.mode&1)!==0&&(t.flags&128)===0)SK(),Ax(),t.flags|=98560,a=!1;else if(a=qD(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(Ve(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Ve(317));a[Tp]=t}else Ax(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Gs(t),a=!1}else Iu!==null&&(q5(Iu),Iu=null),a=!0;if(!a)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(Ea.current&1)!==0?qo===0&&(qo=3):M_())),t.updateQueue!==null&&(t.flags|=4),Gs(t),null);case 4:return Nx(),j5(e,t),e===null&&zS(t.stateNode.containerInfo),Gs(t),null;case 10:return m_(t.type._context),Gs(t),null;case 17:return sc(t.type)&&gE(),Gs(t),null;case 19:if(Qi(Ea),a=t.memoizedState,a===null)return Gs(t),null;if(n=(t.flags&128)!==0,o=a.rendering,o===null)if(n)pS(a,!1);else{if(qo!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(o=kE(e),o!==null){for(t.flags|=128,pS(a,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,e=o.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Ri(Ea,Ea.current&1|2),t.child}e=e.sibling}a.tail!==null&&oo()>Ox&&(t.flags|=128,n=!0,pS(a,!1),t.lanes=4194304)}else{if(!n)if(e=kE(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),pS(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!aa)return Gs(t),null}else 2*oo()-a.renderingStartTime>Ox&&r!==1073741824&&(t.flags|=128,n=!0,pS(a,!1),t.lanes=4194304);a.isBackwards?(o.sibling=t.child,t.child=o):(r=a.last,r!==null?r.sibling=o:t.child=o,a.last=o)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=oo(),t.sibling=null,r=Ea.current,Ri(Ea,n?r&1|2:r&1),t):(Gs(t),null);case 22:case 23:return I_(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&(t.mode&1)!==0?(Oc&1073741824)!==0&&(Gs(t),t.subtreeFlags&6&&(t.flags|=8192)):Gs(t),null;case 24:return null;case 25:return null}throw Error(Ve(156,t.tag))}function hDe(e,t){switch(c_(t),t.tag){case 1:return sc(t.type)&&gE(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Nx(),Qi(oc),Qi(Ks),y_(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return v_(t),null;case 13:if(Qi(Ea),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ve(340));Ax()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Qi(Ea),null;case 4:return Nx(),null;case 10:return m_(t.type._context),null;case 22:case 23:return I_(),null;case 24:return null;default:return null}}var YD=!1,Ys=!1,vDe=typeof WeakSet=="function"?WeakSet:Set,Tt=null;function wx(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ha(e,t,n)}else r.current=null}function _5(e,t,r){try{r()}catch(n){Ha(e,t,n)}}var g7=!1;function yDe(e,t){if(w5=uE,e=dK(),s_(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch(k){r=null;break e}var o=0,s=-1,l=-1,c=0,d=0,u=e,p=null;t:for(;;){for(var m;u!==r||i!==0&&u.nodeType!==3||(s=o+i),u!==a||n!==0&&u.nodeType!==3||(l=o+n),u.nodeType===3&&(o+=u.nodeValue.length),(m=u.firstChild)!==null;)p=u,u=m;for(;;){if(u===e)break t;if(p===r&&++c===i&&(s=o),p===a&&++d===n&&(l=o),(m=u.nextSibling)!==null)break;u=p,p=u.parentNode}u=m}r=s===-1||l===-1?null:{start:s,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(k5={focusedElem:e,selectionRange:r},uE=!1,Tt=t;Tt!==null;)if(t=Tt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Tt=e;else for(;Tt!==null;){t=Tt;try{var g=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var f=g.memoizedProps,v=g.memoizedState,h=t.stateNode,y=h.getSnapshotBeforeUpdate(t.elementType===t.type?f:Du(t.type,f),v);h.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ve(163))}}catch(k){Ha(t,t.return,k)}if(e=t.sibling,e!==null){e.return=t.return,Tt=e;break}Tt=t.return}return g=g7,g7=!1,g}function CS(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&_5(t,r,a)}i=i.next}while(i!==n)}}function _E(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function B5(e){var t=e.ref;if(t!==null){var r=e.stateNode;e.tag,e=r,typeof t=="function"?t(e):t.current=e}}function oJ(e){var t=e.alternate;t!==null&&(e.alternate=null,oJ(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Tp],delete t[_S],delete t[C5],delete t[eDe],delete t[tDe])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sJ(e){return e.tag===5||e.tag===3||e.tag===4}function h7(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||sJ(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function W5(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=fE));else if(n!==4&&(e=e.child,e!==null))for(W5(e,t,r),e=e.sibling;e!==null;)W5(e,t,r),e=e.sibling}function $5(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for($5(e,t,r),e=e.sibling;e!==null;)$5(e,t,r),e=e.sibling}var Cs=null,Eu=!1;function Sg(e,t,r){for(r=r.child;r!==null;)lJ(e,t,r),r=r.sibling}function lJ(e,t,r){if(Cp&&typeof Cp.onCommitFiberUnmount=="function")try{Cp.onCommitFiberUnmount(ME,r)}catch(s){}switch(r.tag){case 5:Ys||wx(r,t);case 6:var n=Cs,i=Eu;Cs=null,Sg(e,t,r),Cs=n,Eu=i,Cs!==null&&(Eu?(e=Cs,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Cs.removeChild(r.stateNode));break;case 18:Cs!==null&&(Eu?(e=Cs,r=r.stateNode,e.nodeType===8?Hj(e.parentNode,r):e.nodeType===1&&Hj(e,r),NS(e)):Hj(Cs,r.stateNode));break;case 4:n=Cs,i=Eu,Cs=r.stateNode.containerInfo,Eu=!0,Sg(e,t,r),Cs=n,Eu=i;break;case 0:case 11:case 14:case 15:if(!Ys&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var a=i,o=a.destroy;a=a.tag,o!==void 0&&((a&2)!==0||(a&4)!==0)&&_5(r,t,o),i=i.next}while(i!==n)}Sg(e,t,r);break;case 1:if(!Ys&&(wx(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(s){Ha(r,t,s)}Sg(e,t,r);break;case 21:Sg(e,t,r);break;case 22:r.mode&1?(Ys=(n=Ys)||r.memoizedState!==null,Sg(e,t,r),Ys=n):Sg(e,t,r);break;default:Sg(e,t,r)}}function v7(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new vDe),t.forEach(function(n){var i=DDe.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Pu(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var a=e,o=t,s=o;e:for(;s!==null;){switch(s.tag){case 5:Cs=s.stateNode,Eu=!1;break e;case 3:Cs=s.stateNode.containerInfo,Eu=!0;break e;case 4:Cs=s.stateNode.containerInfo,Eu=!0;break e}s=s.return}if(Cs===null)throw Error(Ve(160));lJ(a,o,i),Cs=null,Eu=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Ha(i,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)cJ(t,e),t=t.sibling}function cJ(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Pu(t,e),kp(e),n&4){try{CS(3,e,e.return),_E(3,e)}catch(f){Ha(e,e.return,f)}try{CS(5,e,e.return)}catch(f){Ha(e,e.return,f)}}break;case 1:Pu(t,e),kp(e),n&512&&r!==null&&wx(r,r.return);break;case 5:if(Pu(t,e),kp(e),n&512&&r!==null&&wx(r,r.return),e.flags&32){var i=e.stateNode;try{IS(i,"")}catch(f){Ha(e,e.return,f)}}if(n&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,o=r!==null?r.memoizedProps:a,s=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{s==="input"&&a.type==="radio"&&a.name!=null&&A7(i,a),u5(s,o);var c=u5(s,a);for(o=0;o<l.length;o+=2){var d=l[o],u=l[o+1];d==="style"?z7(i,u):d==="dangerouslySetInnerHTML"?F7(i,u):d==="children"?IS(i,u):Y5(i,d,u,c)}switch(s){case"input":o5(i,a);break;case"textarea":L7(i,a);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var m=a.value;m!=null?Sx(i,!!a.multiple,m,!1):p!==!!a.multiple&&(a.defaultValue!=null?Sx(i,!!a.multiple,a.defaultValue,!0):Sx(i,!!a.multiple,a.multiple?[]:"",!1))}i[_S]=a}catch(f){Ha(e,e.return,f)}}break;case 6:if(Pu(t,e),kp(e),n&4){if(e.stateNode===null)throw Error(Ve(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(f){Ha(e,e.return,f)}}break;case 3:if(Pu(t,e),kp(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{NS(t.containerInfo)}catch(f){Ha(e,e.return,f)}break;case 4:Pu(t,e),kp(e);break;case 13:Pu(t,e),kp(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(D_=oo())),n&4&&v7(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Ys=(c=Ys)||d,Pu(t,e),Ys=c):Pu(t,e),kp(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!d&&(e.mode&1)!==0)for(Tt=e,d=e.child;d!==null;){for(u=Tt=d;Tt!==null;){switch(p=Tt,m=p.child,p.tag){case 0:case 11:case 14:case 15:CS(4,p,p.return);break;case 1:wx(p,p.return);var g=p.stateNode;if(typeof g.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(f){Ha(n,r,f)}}break;case 5:wx(p,p.return);break;case 22:if(p.memoizedState!==null){b7(u);continue}}m!==null?(m.return=p,Tt=m):b7(u)}d=d.sibling}e:for(d=null,u=e;;){if(u.tag===5){if(d===null){d=u;try{i=u.stateNode,c?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(s=u.stateNode,l=u.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,s.style.display=O7("display",o))}catch(f){Ha(e,e.return,f)}}}else if(u.tag===6){if(d===null)try{u.stateNode.nodeValue=c?"":u.memoizedProps}catch(f){Ha(e,e.return,f)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===e)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===e)break e;for(;u.sibling===null;){if(u.return===null||u.return===e)break e;d===u&&(d=null),u=u.return}d===u&&(d=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:Pu(t,e),kp(e),n&4&&v7(e);break;case 21:break;default:Pu(t,e),kp(e)}}function kp(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(sJ(r)){var n=r;break e}r=r.return}throw Error(Ve(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(IS(i,""),n.flags&=-33);var a=h7(e);$5(e,a,i);break;case 3:case 4:var o=n.stateNode.containerInfo,s=h7(e);W5(e,s,o);break;default:throw Error(Ve(161))}}catch(l){Ha(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function bDe(e,t,r){Tt=e,dJ(e,t,r)}function dJ(e,t,r){for(var n=(e.mode&1)!==0;Tt!==null;){var i=Tt,a=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||YD;if(!o){var s=i.alternate,l=s!==null&&s.memoizedState!==null||Ys;s=YD;var c=Ys;if(YD=o,(Ys=l)&&!c)for(Tt=i;Tt!==null;)o=Tt,l=o.child,o.tag===22&&o.memoizedState!==null?x7(i):l!==null?(l.return=o,Tt=l):x7(i);for(;a!==null;)Tt=a,dJ(a,t,r),a=a.sibling;Tt=i,YD=s,Ys=c}y7(e,t,r)}else(i.subtreeFlags&8772)!==0&&a!==null?(a.return=i,Tt=a):y7(e,t,r)}}function y7(e){for(;Tt!==null;){var t=Tt;if((t.flags&8772)!==0){var r=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:Ys||_E(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ys)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:Du(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&r7(t,a,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}r7(t,o,r)}break;case 5:var s=t.stateNode;if(r===null&&t.flags&4){r=s;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var u=d.dehydrated;u!==null&&NS(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ve(163))}Ys||t.flags&512&&B5(t)}catch(p){Ha(t,t.return,p)}}if(t===e){Tt=null;break}if(r=t.sibling,r!==null){r.return=t.return,Tt=r;break}Tt=t.return}}function b7(e){for(;Tt!==null;){var t=Tt;if(t===e){Tt=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Tt=r;break}Tt=t.return}}function x7(e){for(;Tt!==null;){var t=Tt;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{_E(4,t)}catch(l){Ha(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(l){Ha(t,i,l)}}var a=t.return;try{B5(t)}catch(l){Ha(t,a,l)}break;case 5:var o=t.return;try{B5(t)}catch(l){Ha(t,o,l)}}}catch(l){Ha(t,t.return,l)}if(t===e){Tt=null;break}var s=t.sibling;if(s!==null){s.return=t.return,Tt=s;break}Tt=t.return}}var xDe=Math.ceil,CE=Ym.ReactCurrentDispatcher,C_=Ym.ReactCurrentOwner,wd=Ym.ReactCurrentBatchConfig,In=0,ls=null,ko=null,Ps=0,Oc=0,kx=$g(0),qo=0,HS=null,Av=0,BE=0,P_=0,PS=null,ic=null,D_=0,Ox=1/0,Bm=null,PE=!1,R5=null,Og=null,KD=!1,Ig=null,DE=0,DS=0,U5=null,nE=-1,iE=0;function Pl(){return(In&6)!==0?oo():nE!==-1?nE:nE=oo()}function zg(e){return(e.mode&1)===0?1:(In&2)!==0&&Ps!==0?Ps&-Ps:nDe.transition!==null?(iE===0&&(iE=Y7()),iE):(e=gi,e!==0||(e=window.event,e=e===void 0?16:tK(e.type)),e)}function Au(e,t,r,n){if(50<DS)throw DS=0,U5=null,Error(Ve(185));qS(e,r,n),((In&2)===0||e!==ls)&&(e===ls&&((In&2)===0&&(BE|=r),qo===4&&Dg(e,Ps)),lc(e,n),r===1&&In===0&&(t.mode&1)===0&&(Ox=oo()+500,OE&&Rg()))}function lc(e,t){var r=e.callbackNode;aPe(e,t);var n=dE(e,e===ls?Ps:0);if(n===0)r!==null&&E9(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&E9(r),t===1)e.tag===0?rDe(w7.bind(null,e)):xK(w7.bind(null,e)),XPe(function(){(In&6)===0&&Rg()}),r=null;else{switch(K7(n)){case 1:r=Z5;break;case 4:r=V7;break;case 16:r=cE;break;case 536870912:r=G7;break;default:r=cE}r=yJ(r,uJ.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function uJ(e,t){if(nE=-1,iE=0,(In&6)!==0)throw Error(Ve(327));var r=e.callbackNode;if(Ex()&&e.callbackNode!==r)return null;var n=dE(e,e===ls?Ps:0);if(n===0)return null;if((n&30)!==0||(n&e.expiredLanes)!==0||t)t=EE(e,n);else{t=n;var i=In;In|=2;var a=mJ();(ls!==e||Ps!==t)&&(Bm=null,Ox=oo()+500,Pv(e,t));do try{SDe();break}catch(s){pJ(e,s)}while(!0);p_(),CE.current=a,In=i,ko!==null?t=0:(ls=null,Ps=0,t=qo)}if(t!==0){if(t===2&&(i=h5(e),i!==0&&(n=i,t=H5(e,i))),t===1)throw r=HS,Pv(e,0),Dg(e,n),lc(e,oo()),r;if(t===6)Dg(e,n);else{if(i=e.current.alternate,(n&30)===0&&!wDe(i)&&(t=EE(e,n),t===2&&(a=h5(e),a!==0&&(n=a,t=H5(e,a))),t===1))throw r=HS,Pv(e,0),Dg(e,n),lc(e,oo()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(Ve(345));case 2:kv(e,ic,Bm);break;case 3:if(Dg(e,n),(n&130023424)===n&&(t=D_+500-oo(),10<t)){if(dE(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Pl(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=T5(kv.bind(null,e,ic,Bm),t);break}kv(e,ic,Bm);break;case 4:if(Dg(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var o=31-Mu(n);a=1<<o,o=t[o],o>i&&(i=o),n&=~a}if(n=i,n=oo()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*xDe(n/1960))-n,10<n){e.timeoutHandle=T5(kv.bind(null,e,ic,Bm),n);break}kv(e,ic,Bm);break;case 5:kv(e,ic,Bm);break;default:throw Error(Ve(329))}}}return lc(e,oo()),e.callbackNode===r?uJ.bind(null,e):null}function H5(e,t){var r=PS;return e.current.memoizedState.isDehydrated&&(Pv(e,t).flags|=256),e=EE(e,t),e!==2&&(t=ic,ic=r,t!==null&&q5(t)),e}function q5(e){ic===null?ic=e:ic.push.apply(ic,e)}function wDe(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!Lu(a(),i))return!1}catch(o){return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Dg(e,t){for(t&=~P_,t&=~BE,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Mu(t),n=1<<r;e[r]=-1,t&=~n}}function w7(e){if((In&6)!==0)throw Error(Ve(327));Ex();var t=dE(e,0);if((t&1)===0)return lc(e,oo()),null;var r=EE(e,t);if(e.tag!==0&&r===2){var n=h5(e);n!==0&&(t=n,r=H5(e,n))}if(r===1)throw r=HS,Pv(e,0),Dg(e,t),lc(e,oo()),r;if(r===6)throw Error(Ve(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,kv(e,ic,Bm),lc(e,oo()),null}function E_(e,t){var r=In;In|=1;try{return e(t)}finally{In=r,In===0&&(Ox=oo()+500,OE&&Rg())}}function Lv(e){Ig!==null&&Ig.tag===0&&(In&6)===0&&Ex();var t=In;In|=1;var r=wd.transition,n=gi;try{if(wd.transition=null,gi=1,e)return e()}finally{gi=n,wd.transition=r,In=t,(In&6)===0&&Rg()}}function I_(){Oc=kx.current,Qi(kx)}function Pv(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,QPe(r)),ko!==null)for(r=ko.return;r!==null;){var n=r;switch(c_(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&gE();break;case 3:Nx(),Qi(oc),Qi(Ks),y_();break;case 5:v_(n);break;case 4:Nx();break;case 13:Qi(Ea);break;case 19:Qi(Ea);break;case 10:m_(n.type._context);break;case 22:case 23:I_()}r=r.return}if(ls=e,ko=e=jg(e.current,null),Ps=Oc=t,qo=0,HS=null,P_=BE=Av=0,ic=PS=null,Tv!==null){for(t=0;t<Tv.length;t++)if(r=Tv[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,a=r.pending;if(a!==null){var o=a.next;a.next=i,n.next=o}r.pending=n}Tv=null}return e}function pJ(e,t){do{var r=ko;try{if(p_(),eE.current=TE,SE){for(var n=Ia.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}SE=!1}if(Mv=0,ss=Ho=Ia=null,TS=!1,$S=0,C_.current=null,r===null||r.return===null){qo=1,HS=t,ko=null;break}e:{var a=e,o=r.return,s=r,l=t;if(t=Ps,s.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,d=s,u=d.tag;if((d.mode&1)===0&&(u===0||u===11||u===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=l7(o);if(m!==null){m.flags&=-257,c7(m,o,s,a,t),m.mode&1&&s7(a,c,t),t=m,l=c;var g=t.updateQueue;if(g===null){var f=new Set;f.add(l),t.updateQueue=f}else g.add(l);break e}else{if((t&1)===0){s7(a,c,t),M_();break e}l=Error(Ve(426))}}else if(aa&&s.mode&1){var v=l7(o);if(v!==null){(v.flags&65536)===0&&(v.flags|=256),c7(v,o,s,a,t),d_(Fx(l,s));break e}}a=l=Fx(l,s),qo!==4&&(qo=2),PS===null?PS=[a]:PS.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var h=KK(a,l,t);t7(a,h);break e;case 1:s=l;var y=a.type,b=a.stateNode;if((a.flags&128)===0&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Og===null||!Og.has(b)))){a.flags|=65536,t&=-t,a.lanes|=t;var k=JK(a,s,t);t7(a,k);break e}}a=a.return}while(a!==null)}gJ(r)}catch(x){t=x,ko===r&&r!==null&&(ko=r=r.return);continue}break}while(!0)}function mJ(){var e=CE.current;return CE.current=TE,e===null?TE:e}function M_(){(qo===0||qo===3||qo===2)&&(qo=4),ls===null||(Av&268435455)===0&&(BE&268435455)===0||Dg(ls,Ps)}function EE(e,t){var r=In;In|=2;var n=mJ();(ls!==e||Ps!==t)&&(Bm=null,Pv(e,t));do try{kDe();break}catch(i){pJ(e,i)}while(!0);if(p_(),In=r,CE.current=n,ko!==null)throw Error(Ve(261));return ls=null,Ps=0,qo}function kDe(){for(;ko!==null;)fJ(ko)}function SDe(){for(;ko!==null&&!JCe();)fJ(ko)}function fJ(e){var t=vJ(e.alternate,e,Oc);e.memoizedProps=e.pendingProps,t===null?gJ(e):ko=t,C_.current=null}function gJ(e){var t=e;do{var r=t.alternate;if(e=t.return,(t.flags&32768)===0){if(r=gDe(r,t,Oc),r!==null){ko=r;return}}else{if(r=hDe(r,t),r!==null){r.flags&=32767,ko=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{qo=6,ko=null;return}}if(t=t.sibling,t!==null){ko=t;return}ko=t=e}while(t!==null);qo===0&&(qo=5)}function kv(e,t,r){var n=gi,i=wd.transition;try{wd.transition=null,gi=1,TDe(e,t,r,n)}finally{wd.transition=i,gi=n}return null}function TDe(e,t,r,n){do Ex();while(Ig!==null);if((In&6)!==0)throw Error(Ve(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Ve(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(oPe(e,a),e===ls&&(ko=ls=null,Ps=0),(r.subtreeFlags&2064)===0&&(r.flags&2064)===0||KD||(KD=!0,yJ(cE,function(){return Ex(),null})),a=(r.flags&15990)!==0,(r.subtreeFlags&15990)!==0||a){a=wd.transition,wd.transition=null;var o=gi;gi=1;var s=In;In|=4,C_.current=null,yDe(e,r),cJ(r,e),VPe(k5),uE=!!w5,k5=w5=null,e.current=r,bDe(r,e,i),QCe(),In=s,gi=o,wd.transition=a}else e.current=r;if(KD&&(KD=!1,Ig=e,DE=i),a=e.pendingLanes,a===0&&(Og=null),ePe(r.stateNode,n),lc(e,oo()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(PE)throw PE=!1,e=R5,R5=null,e;return(DE&1)!==0&&e.tag!==0&&Ex(),a=e.pendingLanes,(a&1)!==0?e===U5?DS++:(DS=0,U5=e):DS=0,Rg(),null}function Ex(){if(Ig!==null){var e=K7(DE),t=wd.transition,r=gi;try{if(wd.transition=null,gi=16>e?16:e,Ig===null)var n=!1;else{if(e=Ig,Ig=null,DE=0,(In&6)!==0)throw Error(Ve(331));var i=In;for(In|=4,Tt=e.current;Tt!==null;){var a=Tt,o=a.child;if((Tt.flags&16)!==0){var s=a.deletions;if(s!==null){for(var l=0;l<s.length;l++){var c=s[l];for(Tt=c;Tt!==null;){var d=Tt;switch(d.tag){case 0:case 11:case 15:CS(8,d,a)}var u=d.child;if(u!==null)u.return=d,Tt=u;else for(;Tt!==null;){d=Tt;var p=d.sibling,m=d.return;if(oJ(d),d===c){Tt=null;break}if(p!==null){p.return=m,Tt=p;break}Tt=m}}}var g=a.alternate;if(g!==null){var f=g.child;if(f!==null){g.child=null;do{var v=f.sibling;f.sibling=null,f=v}while(f!==null)}}Tt=a}}if((a.subtreeFlags&2064)!==0&&o!==null)o.return=a,Tt=o;else e:for(;Tt!==null;){if(a=Tt,(a.flags&2048)!==0)switch(a.tag){case 0:case 11:case 15:CS(9,a,a.return)}var h=a.sibling;if(h!==null){h.return=a.return,Tt=h;break e}Tt=a.return}}var y=e.current;for(Tt=y;Tt!==null;){o=Tt;var b=o.child;if((o.subtreeFlags&2064)!==0&&b!==null)b.return=o,Tt=b;else e:for(o=y;Tt!==null;){if(s=Tt,(s.flags&2048)!==0)try{switch(s.tag){case 0:case 11:case 15:_E(9,s)}}catch(x){Ha(s,s.return,x)}if(s===o){Tt=null;break e}var k=s.sibling;if(k!==null){k.return=s.return,Tt=k;break e}Tt=s.return}}if(In=i,Rg(),Cp&&typeof Cp.onPostCommitFiberRoot=="function")try{Cp.onPostCommitFiberRoot(ME,e)}catch(x){}n=!0}return n}finally{gi=r,wd.transition=t}}return!1}function k7(e,t,r){t=Fx(r,t),t=KK(e,t,1),e=Fg(e,t,1),t=Pl(),e!==null&&(qS(e,1,t),lc(e,t))}function Ha(e,t,r){if(e.tag===3)k7(e,e,r);else for(;t!==null;){if(t.tag===3){k7(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Og===null||!Og.has(n))){e=Fx(r,e),e=JK(t,e,1),t=Fg(t,e,1),e=Pl(),t!==null&&(qS(t,1,e),lc(t,e));break}}t=t.return}}function CDe(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Pl(),e.pingedLanes|=e.suspendedLanes&r,ls===e&&(Ps&r)===r&&(qo===4||qo===3&&(Ps&130023424)===Ps&&500>oo()-D_?Pv(e,0):P_|=r),lc(e,t)}function hJ(e,t){t===0&&((e.mode&1)===0?t=1:(t=OD,OD<<=1,(OD&130023424)===0&&(OD=4194304)));var r=Pl();e=Vm(e,t),e!==null&&(qS(e,t,r),lc(e,r))}function PDe(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),hJ(e,r)}function DDe(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Ve(314))}n!==null&&n.delete(t),hJ(e,r)}var vJ;vJ=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||oc.current)ac=!0;else{if((e.lanes&r)===0&&(t.flags&128)===0)return ac=!1,fDe(e,t,r);ac=(e.flags&131072)!==0}else ac=!1,aa&&(t.flags&1048576)!==0&&wK(t,yE,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;rE(e,t),e=t.pendingProps;var i=Mx(t,Ks.current);Dx(t,r),i=x_(null,t,n,e,i,r);var a=w_();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,sc(n)?(a=!0,hE(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,g_(t),i.updater=jE,t.stateNode=i,i._reactInternals=t,A5(t,n,e,r),t=F5(null,t,n,!0,a,r)):(t.tag=0,aa&&a&&l_(t),Cl(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(rE(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=IDe(n),e=Du(n,e),i){case 0:t=N5(null,t,n,e,r);break e;case 1:t=p7(null,t,n,e,r);break e;case 11:t=d7(null,t,n,e,r);break e;case 14:t=u7(null,t,n,Du(n.type,e),r);break e}throw Error(Ve(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Du(n,i),N5(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Du(n,i),p7(e,t,n,i,r);case 3:e:{if(eJ(t),e===null)throw Error(Ve(387));n=t.pendingProps,a=t.memoizedState,i=a.element,DK(e,t),wE(t,n,null,r);var o=t.memoizedState;if(n=o.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=Fx(Error(Ve(423)),t),t=m7(e,t,n,r,i);break e}else if(n!==i){i=Fx(Error(Ve(424)),t),t=m7(e,t,n,r,i);break e}else for(zc=Ng(t.stateNode.containerInfo.firstChild),jc=t,aa=!0,Iu=null,r=CK(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Ax(),n===i){t=Gm(e,t,r);break e}Cl(e,t,n,r)}t=t.child}return t;case 5:return EK(t),e===null&&E5(t),n=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,o=i.children,S5(n,i)?o=null:a!==null&&S5(n,a)&&(t.flags|=32),ZK(e,t),Cl(e,t,o,r),t.child;case 6:return e===null&&E5(t),null;case 13:return tJ(e,t,r);case 4:return h_(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Lx(t,null,n,r):Cl(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Du(n,i),d7(e,t,n,i,r);case 7:return Cl(e,t,t.pendingProps,r),t.child;case 8:return Cl(e,t,t.pendingProps.children,r),t.child;case 12:return Cl(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,a=t.memoizedProps,o=i.value,Ri(bE,n._currentValue),n._currentValue=o,a!==null)if(Lu(a.value,o)){if(a.children===i.children&&!oc.current){t=Gm(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var s=a.dependencies;if(s!==null){o=a.child;for(var l=s.firstContext;l!==null;){if(l.context===n){if(a.tag===1){l=Um(-1,r&-r),l.tag=2;var c=a.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),I5(a.return,r,t),s.lanes|=r;break}l=l.next}}else if(a.tag===10)o=a.type===t.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(Ve(341));o.lanes|=r,s=o.alternate,s!==null&&(s.lanes|=r),I5(o,r,t),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===t){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}Cl(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Dx(t,r),i=kd(i),n=n(i),t.flags|=1,Cl(e,t,n,r),t.child;case 14:return n=t.type,i=Du(n,t.pendingProps),i=Du(n.type,i),u7(e,t,n,i,r);case 15:return QK(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:Du(n,i),rE(e,t),t.tag=1,sc(n)?(e=!0,hE(t)):e=!1,Dx(t,r),YK(t,n,i),A5(t,n,i,r),F5(null,t,n,!0,e,r);case 19:return rJ(e,t,r);case 22:return XK(e,t,r)}throw Error(Ve(156,t.tag))};function yJ(e,t){return q7(e,t)}function EDe(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xd(e,t,r,n){return new EDe(e,t,r,n)}function A_(e){return e=e.prototype,!(!e||!e.isReactComponent)}function IDe(e){if(typeof e=="function")return A_(e)?1:0;if(e!=null){if(e=e.$$typeof,e===J5)return 11;if(e===Q5)return 14}return 2}function jg(e,t){var r=e.alternate;return r===null?(r=xd(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function aE(e,t,r,n,i,a){var o=2;if(n=e,typeof e=="function")A_(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case px:return Dv(r.children,i,a,t);case K5:o=8,i|=8;break;case t5:return e=xd(12,r,t,i|2),e.elementType=t5,e.lanes=a,e;case r5:return e=xd(13,r,t,i),e.elementType=r5,e.lanes=a,e;case n5:return e=xd(19,r,t,i),e.elementType=n5,e.lanes=a,e;case E7:return WE(r,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case P7:o=10;break e;case D7:o=9;break e;case J5:o=11;break e;case Q5:o=14;break e;case Tg:o=16,n=null;break e}throw Error(Ve(130,e==null?e:typeof e,""))}return t=xd(o,r,t,i),t.elementType=e,t.type=n,t.lanes=a,t}function Dv(e,t,r,n){return e=xd(7,e,n,t),e.lanes=r,e}function WE(e,t,r,n){return e=xd(22,e,n,t),e.elementType=E7,e.lanes=r,e.stateNode={isHidden:!1},e}function Xj(e,t,r){return e=xd(6,e,null,t),e.lanes=r,e}function Zj(e,t,r){return t=xd(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function MDe(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zj(0),this.expirationTimes=zj(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zj(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function L_(e,t,r,n,i,a,o,s,l){return e=new MDe(e,t,r,s,l),t===1?(t=1,a===!0&&(t|=8)):t=0,a=xd(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},g_(a),e}function ADe(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ux,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function bJ(e){if(!e)return Bg;e=e._reactInternals;e:{if(Fv(e)!==e||e.tag!==1)throw Error(Ve(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(sc(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ve(171))}if(e.tag===1){var r=e.type;if(sc(r))return bK(e,r,t)}return t}function xJ(e,t,r,n,i,a,o,s,l){return e=L_(r,n,!0,e,i,a,o,s,l),e.context=bJ(null),r=e.current,n=Pl(),i=zg(r),a=Um(n,i),a.callback=t!=null?t:null,Fg(r,a,i),e.current.lanes=i,qS(e,i,n),lc(e,n),e}function $E(e,t,r,n){var i=t.current,a=Pl(),o=zg(i);return r=bJ(r),t.context===null?t.context=r:t.pendingContext=r,t=Um(a,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Fg(i,t,o),e!==null&&(Au(e,i,o,a),ZD(e,i,o)),o}function IE(e){return e=e.current,e.child?(e.child.tag===5,e.child.stateNode):null}function S7(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function N_(e,t){S7(e,t),(e=e.alternate)&&S7(e,t)}function LDe(){return null}var wJ=typeof reportError=="function"?reportError:function(e){console.error(e)};function F_(e){this._internalRoot=e}RE.prototype.render=F_.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ve(409));$E(e,t,null,null)};RE.prototype.unmount=F_.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Lv(function(){$E(null,e,null,null)}),t[qm]=null}};function RE(e){this._internalRoot=e}RE.prototype.unstable_scheduleHydration=function(e){if(e){var t=X7();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Pg.length&&t!==0&&t<Pg[r].priority;r++);Pg.splice(r,0,e),r===0&&eK(e)}};function O_(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function UE(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function T7(){}function NDe(e,t,r,n,i){if(i){if(typeof n=="function"){var a=n;n=function(){var c=IE(o);a.call(c)}}var o=xJ(t,n,e,0,null,!1,!1,"",T7);return e._reactRootContainer=o,e[qm]=o.current,zS(e.nodeType===8?e.parentNode:e),Lv(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var s=n;n=function(){var c=IE(l);s.call(c)}}var l=L_(e,0,!1,null,null,!1,!1,"",T7);return e._reactRootContainer=l,e[qm]=l.current,zS(e.nodeType===8?e.parentNode:e),Lv(function(){$E(t,l,r,n)}),l}function HE(e,t,r,n,i){var a=r._reactRootContainer;if(a){var o=a;if(typeof i=="function"){var s=i;i=function(){var l=IE(o);s.call(l)}}$E(t,o,e,i)}else o=NDe(r,t,e,i,n);return IE(o)}J7=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=vS(t.pendingLanes);r!==0&&(e_(t,r|1),lc(t,oo()),(In&6)===0&&(Ox=oo()+500,Rg()))}break;case 13:Lv(function(){var n=Vm(e,1);if(n!==null){var i=Pl();Au(n,e,1,i)}}),N_(e,1)}};t_=function(e){if(e.tag===13){var t=Vm(e,134217728);if(t!==null){var r=Pl();Au(t,e,134217728,r)}N_(e,134217728)}};Q7=function(e){if(e.tag===13){var t=zg(e),r=Vm(e,t);if(r!==null){var n=Pl();Au(r,e,t,n)}N_(e,t)}};X7=function(){return gi};Z7=function(e,t){var r=gi;try{return gi=e,t()}finally{gi=r}};m5=function(e,t,r){switch(t){case"input":if(o5(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=FE(n);if(!i)throw Error(Ve(90));M7(n),o5(n,i)}}}break;case"textarea":L7(e,r);break;case"select":t=r.value,t!=null&&Sx(e,!!r.multiple,t,!1)}};B7=E_;W7=Lv;var FDe={usingClientEntryPoint:!1,Events:[GS,hx,FE,j7,_7,E_]},mS={findFiberByHostInstance:Sv,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ODe={bundleType:mS.bundleType,version:mS.version,rendererPackageName:mS.rendererPackageName,rendererConfig:mS.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ym.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=U7(e),e===null?null:e.stateNode},findFiberByHostInstance:mS.findFiberByHostInstance||LDe,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"&&(fS=__REACT_DEVTOOLS_GLOBAL_HOOK__,!fS.isDisabled&&fS.supportsFiber))try{ME=fS.inject(ODe),Cp=fS}catch(e){}var fS;Wc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FDe;Wc.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!O_(t))throw Error(Ve(200));return ADe(e,t,null,r)};Wc.createRoot=function(e,t){if(!O_(e))throw Error(Ve(299));var r=!1,n="",i=wJ;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=L_(e,1,!1,null,null,r,!1,n,i),e[qm]=t.current,zS(e.nodeType===8?e.parentNode:e),new F_(t)};Wc.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ve(188)):(e=Object.keys(e).join(","),Error(Ve(268,e)));return e=U7(t),e=e===null?null:e.stateNode,e};Wc.flushSync=function(e){return Lv(e)};Wc.hydrate=function(e,t,r){if(!UE(t))throw Error(Ve(200));return HE(null,e,t,!0,r)};Wc.hydrateRoot=function(e,t,r){if(!O_(e))throw Error(Ve(405));var n=r!=null&&r.hydratedSources||null,i=!1,a="",o=wJ;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=xJ(t,null,e,1,r!=null?r:null,i,!1,a,o),e[qm]=t.current,zS(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new RE(t)};Wc.render=function(e,t,r){if(!UE(t))throw Error(Ve(200));return HE(null,e,t,!1,r)};Wc.unmountComponentAtNode=function(e){if(!UE(e))throw Error(Ve(40));return e._reactRootContainer?(Lv(function(){HE(null,null,e,!1,function(){e._reactRootContainer=null,e[qm]=null})}),!0):!1};Wc.unstable_batchedUpdates=E_;Wc.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!UE(r))throw Error(Ve(200));if(e==null||e._reactInternals===void 0)throw Error(Ve(38));return HE(e,t,r,!1,n)};Wc.version="18.3.1-next-f1338f8080-20240426"});var Td=Fe((BQe,TJ)=>{"use strict";function SJ(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__=="undefined"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(SJ)}catch(e){console.error(e)}}SJ(),TJ.exports=kJ()});var Ni=Fe(z_=>{"use strict";var CJ=Td();z_.createRoot=CJ.createRoot,z_.hydrateRoot=CJ.hydrateRoot;var WQe});function KS(){if(document.head.querySelector("#journalit-image-styles"))return;let e=document.createElement("style");e.id="journalit-image-styles",e.textContent=zDe,document.head.appendChild(e)}function PJ(){let e=document.head.querySelector("#journalit-image-styles");e&&e.remove()}function DJ(){KS()}var zDe,qE=F(()=>{zDe=`
  /* Image Uploader Styles - New Side-by-Side Layout */
  .journalit-image-upload-wrapper {
    margin-bottom: 12px;
    position: relative;
  }

  .journalit-image-upload-layout {
    display: flex;
    gap: 8px;
    min-height: 80px;
    width: 100%;
  }

  /* Paste Button Area - 1/3 Width */
  .journalit-image-upload-paste-area {
    flex: 0 0 calc(33.333% - 4px);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    background-color: var(--interactive-accent);
    color: var(--text-on-accent, white);
    border: 2px solid var(--interactive-accent);
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s ease;
    padding: 12px 8px;
    min-height: 80px;
    font-size: 13px;
    font-weight: 500;
    gap: 6px;
  }

  .journalit-image-upload-paste-area:hover {
    background-color: var(--interactive-accent-hover);
    border-color: var(--interactive-accent-hover);
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.2);
  }

  .journalit-image-upload-paste-area:disabled {
    background-color: var(--background-modifier-border);
    border-color: var(--background-modifier-border);
    color: var(--text-muted);
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
  }

  .journalit-image-upload-paste-area.pasting {
    background-color: var(--background-modifier-border);
    border-color: var(--background-modifier-border);
    color: var(--text-muted);
    cursor: wait;
  }

  .journalit-image-upload-paste-area .paste-icon {
    flex-shrink: 0;
    line-height: 1;
  }

  .journalit-image-upload-paste-area .paste-text {
    font-size: 12px;
    text-align: center;
    line-height: 1.2;
  }

  /* File Explorer Area - 2/3 Width */
  .journalit-image-upload-file-area {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 80px;
    border: 2px dashed var(--background-modifier-border);
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
    overflow: hidden;
    background-color: var(--background-secondary);
    padding: 12px;
  }

  .journalit-image-upload-file-area.full-width {
    flex: 1;
    min-width: 100%;
  }

  .journalit-image-upload-file-area:hover {
    border-color: var(--interactive-accent);
    background-color: rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.05);
  }

  .journalit-image-upload-file-area:focus {
    outline: 2px solid var(--interactive-accent);
    outline-offset: 2px;
    border-color: var(--interactive-accent);
    background-color: rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.08);
  }

  .journalit-image-upload-file-area.dragging-over {
    border-color: var(--interactive-accent);
    background-color: rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.1);
    transform: scale(1.02);
    box-shadow: 0 0 12px rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.3);
  }

  .journalit-image-upload-label {
    font-size: 14px;
    color: var(--text-muted);
    cursor: pointer;
    transition: all 0.2s ease;
    text-align: center;
    line-height: 1.3;
  }

  .journalit-image-upload-file-area:hover .journalit-image-upload-label {
    color: var(--interactive-accent);
  }

  .journalit-image-upload-input {
    display: none;
  }

  /* Drag overlay message for file area */
  .journalit-image-upload-file-area::after {
    content: "Drop image here";
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 16px;
    font-weight: 600;
    color: var(--interactive-accent);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s ease;
  }

  .journalit-image-upload-file-area.dragging-over::after {
    opacity: 1;
  }

  .journalit-image-upload-file-area.dragging-over .journalit-image-upload-label {
    opacity: 0;
  }

  /* Spinner for paste loading */
  .journalit-spinner {
    width: 12px;
    height: 12px;
    border: 2px solid var(--background-modifier-border);
    border-top: 2px solid var(--interactive-accent);
    border-radius: 50%;
    animation: journalit-spinner-rotate 1s linear infinite;
  }

  @keyframes journalit-spinner-rotate {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }

  /* Responsive Design for Image Upload */
  @media (max-width: 768px) {
    .journalit-image-upload-layout {
      flex-direction: column;
      gap: 6px;
    }

    .journalit-image-upload-paste-area {
      flex: 0 0 auto;
      min-height: 60px;
      flex-direction: row;
      gap: 8px;
      padding: 12px 16px;
    }

    .journalit-image-upload-file-area {
      flex: 1;
      min-height: 70px;
    }

    .journalit-image-upload-paste-area .paste-text {
      font-size: 13px;
    }
  }

  @media (max-width: 480px) {
    .journalit-image-upload-layout {
      gap: 4px;
    }

    .journalit-image-upload-paste-area {
      min-height: 50px;
      padding: 10px 12px;
      font-size: 12px;
    }

    .journalit-image-upload-file-area {
      min-height: 60px;
      padding: 8px;
    }

    .journalit-image-upload-label {
      font-size: 13px;
    }

    .journalit-image-upload-paste-area .paste-text {
      font-size: 11px;
    }
  }

  /* Image Display Styles */
  .journalit-image-viewer {
    position: relative;
    margin-bottom: 12px;
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    padding: 8px;
    background-color: var(--background-primary);
  }

  .journalit-image-container {
    position: relative;
    width: 100%;
  }

  .journalit-image {
    width: 100%;
    border-radius: var(--radius-m);
    cursor: pointer;
  }

  .journalit-image-delete-button {
    position: absolute;
    top: 8px;
    right: 8px;
    background-color: rgba(229, 57, 53, 0.1);
    color: var(--color-error, #e53935);
    border: none;
    border-radius: 4px;
    padding: 6px 12px;
    font-size: 12px;
    cursor: pointer;
    transition: background-color 0.2s ease;
    z-index: 10;
  }

  .journalit-image-delete-button:hover {
    background-color: rgba(229, 57, 53, 0.2);
  }

  .journalit-image-error {
    color: var(--text-error, var(--color-red, #e53935));
    font-size: 12px;
    text-align: center;
    margin-top: 4px;
    margin-bottom: 8px;
    padding: 6px 10px;
    background-color: rgba(229, 57, 53, 0.1);
    border-radius: 4px;
    width: 100%;
  }

  /* Fullscreen Styles - Borderless Design */
  .journalit-fullscreen-portal-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 0;
    height: 0;
    z-index: 4000;
    pointer-events: none;
  }

  .journalit-fullscreen-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-color: rgba(0, 0, 0, 0.9);
    z-index: 10000; /* Reduced from original 1000000 */
    display: flex;
    align-items: center;
    justify-content: center;
    animation: journalit-fade-in 0.3s ease-in-out;
    cursor: pointer; /* Indicate clickable backdrop */
    pointer-events: auto; /* Enable backdrop click-to-close */
    /* Ensure this doesn't interfere with normal page flow */
    contain: layout style paint;
  }

  /* Overlay UI Elements */
  .journalit-fullscreen-overlay-ui {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    pointer-events: none; /* Default to none, specific elements override */
    z-index: 10001; /* Slightly above overlay */
    /* Ensure this doesn't interfere with normal page flow */
    contain: layout style paint;
  }

  .journalit-fullscreen-title {
    position: absolute;
    top: 20px;
    left: 20px;
    color: var(--text-on-accent);
    font-size: 16px;
    font-weight: 500;
    background-color: rgba(0, 0, 0, 0.8);
    padding: 8px 12px;
    border-radius: 6px;
    pointer-events: auto; /* Enable interaction */
  }

  .journalit-fullscreen-close-btn {
    position: absolute;
    top: 20px;
    right: 20px;
    width: 40px;
    height: 40px;
    background-color: rgba(0, 0, 0, 0.8);
    color: var(--text-on-accent);
    border: none;
    border-radius: 50%;
    font-size: 24px;
    font-weight: 300;
    line-height: 1;
    padding: 0 0 2px 0; /* Slight offset to visually center the \xD7 character */
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
    pointer-events: auto; /* Enable interaction */
  }

  .journalit-fullscreen-close-btn:hover {
    background-color: rgba(0, 0, 0, 1.0);
    transform: scale(1.1);
  }

  .journalit-fullscreen-content-wrapper {
    width: 100vw;
    height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    pointer-events: none; /* Let clicks pass through to backdrop */
    /* Ensure this doesn't interfere with normal page flow */
    contain: layout style paint;
    isolation: isolate;
  }

  .journalit-fullscreen-content {
    pointer-events: auto; /* Re-enable interaction for actual content */
  }

  /* Image Carousel Styles */
  .journalit-image-carousel {
    width: 100%;
    margin-bottom: 16px;
    background-color: var(--background-secondary);
    border-radius: 6px;
    padding: 12px;
  }

  .journalit-carousel-main {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 8px;
    margin-bottom: 8px;
    position: relative;
    width: 100%;
  }

  .journalit-carousel-image-container {
    flex: 1;
    width: 100%;
    position: relative;
  }

  .journalit-carousel-button {
    width: 36px;
    height: 36px;
    min-width: 36px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    border: 1px solid var(--background-modifier-border);
    border-radius: 50%;
    font-size: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s ease;
    z-index: 20;
  }

  .journalit-carousel-button:hover {
    background-color: var(--background-modifier-hover);
    transform: translateY(-1px);
  }

  .journalit-carousel-counter {
    text-align: center;
    font-size: 12px;
    color: var(--text-muted);
    margin: 4px 0;
  }

  .journalit-carousel-thumbnails {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-top: 4px;
    justify-content: center;
  }

  .journalit-carousel-thumbnail {
    width: 60px;
    height: 60px;
    border: 2px solid var(--background-modifier-border);
    border-radius: 4px;
    overflow: hidden;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .journalit-carousel-thumbnail:hover {
    transform: translateY(-2px);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  }

  .journalit-carousel-thumbnail.active {
    border-color: var(--interactive-accent);
    box-shadow: 0 0 0 2px var(--interactive-accent);
  }

  .journalit-carousel-thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  /* Animations */
  @keyframes journalit-fade-in {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  @keyframes journalit-zoom-in {
    from { transform: scale(0.9); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
  }

  /* Hold to zoom indicator */
  .journalit-image-zoom-indicator {
    position: absolute;
    bottom: 8px;
    right: 8px;
    background-color: rgba(0, 0, 0, 0.6);
    color: var(--text-on-accent);
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 10px;
    opacity: 0;
    transition: opacity 0.2s ease;
    pointer-events: none;
  }

  .journalit-image-container:hover .journalit-image-zoom-indicator {
    opacity: 1;
  }

  /* Enhanced Fullscreen Viewer Styles - Full Viewport */
  .journalit-fullscreen-viewer {
    position: relative;
    width: 100vw;
    height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    /* Ensure this doesn't interfere with normal page flow */
    contain: layout style paint;
    isolation: isolate;
  }

  .journalit-fullscreen-image-wrapper {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100vw;
    height: 100vh;
    overflow: hidden;
    /* Ensure this doesn't interfere with normal page flow */
    contain: layout style paint;
  }

  .journalit-fullscreen-zoomable-image {
    max-width: 90vw;
    max-height: 90vh;
    object-fit: contain;
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    transform-origin: center;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    /* Prevent browser default touch handling (pinch zoom, scroll) */
    touch-action: none;
    -webkit-touch-callout: none;
  }

  /* Navigation buttons - repositioned to middle sides */
  .journalit-fullscreen-nav-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 45px;
    height: 45px;
    background-color: rgba(0, 0, 0, 0.8);
    color: var(--text-on-accent);
    border: none;
    border-radius: 50%;
    font-size: 20px;
    font-weight: bold;
    cursor: pointer;
    z-index: 10;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0.8;
    pointer-events: auto; /* Enable interaction */
  }

  .journalit-fullscreen-nav-btn:hover {
    background-color: rgba(0, 0, 0, 1.0);
    transform: translateY(-50%) scale(1.1);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
    opacity: 1;
  }

  .journalit-fullscreen-nav-prev {
    left: 20px;
  }

  .journalit-fullscreen-nav-next {
    right: 20px;
  }

  /* Navigation indicator - moved to bottom center */
  .journalit-fullscreen-nav-indicator {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background-color: rgba(0, 0, 0, 0.8);
    color: var(--text-on-accent);
    padding: 8px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 500;
    z-index: 10;
    pointer-events: none; /* Clicks pass through to backdrop */
  }

  /* Zoom indicator - moved to bottom left */
  .journalit-fullscreen-zoom-indicator {
    position: absolute;
    bottom: 20px;
    left: 20px;
    background-color: rgba(0, 0, 0, 0.8);
    color: var(--text-on-accent);
    padding: 8px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 500;
    z-index: 10;
    opacity: 0;
    transition: opacity 0.3s ease;
    pointer-events: none;
  }

  .journalit-fullscreen-viewer:hover .journalit-fullscreen-zoom-indicator {
    opacity: 1;
  }

  /* Smooth zoom transition */
  .journalit-fullscreen-zoomable-image.zooming {
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  /* Responsive navigation buttons */
  @media (max-width: 768px) {
    .journalit-fullscreen-nav-btn {
      width: 40px;
      height: 40px;
      font-size: 20px;
    }

    .journalit-fullscreen-nav-prev {
      left: 10px;
    }

    .journalit-fullscreen-nav-next {
      right: 10px;
    }

    .journalit-fullscreen-nav-indicator {
      bottom: 15px;
      font-size: 11px;
      padding: 6px 10px;
    }

    .journalit-fullscreen-zoom-indicator {
      top: 15px;
      right: 15px;
      font-size: 11px;
      padding: 6px 10px;
    }
  }

  /* ========================================
   * Compact Image Uploader Styles
   * URL-first design for widget contexts
   * Matches GoalsWidget styling patterns
   * ======================================== */

  .journalit-compact-uploader {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem;
    background: var(--background-primary);
    border: 1px solid var(--background-modifier-border);
    border-radius: var(--radius-m);
    transition: all 0.2s ease;
  }

  .journalit-compact-uploader.dragging {
    border-color: var(--interactive-accent);
    background-color: rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.05);
  }

  .journalit-compact-uploader.processing {
    opacity: 0.7;
    pointer-events: none;
  }

  /* URL Input Field - matches GoalsWidget input styling */
  .journalit-compact-uploader-url-input {
    flex: 1;
    min-width: 0;
    padding: 0.5rem;
    font-size: 0.9em;
    background: var(--background-secondary);
    border: 1px solid var(--background-modifier-border);
    border-radius: var(--radius-s);
    color: var(--text-normal);
    transition: all 0.2s ease;
  }

  .journalit-compact-uploader-url-input::placeholder {
    color: var(--text-muted);
  }

  .journalit-compact-uploader-url-input:focus {
    outline: none;
    border-color: var(--interactive-accent);
  }

  .journalit-compact-uploader-url-input:disabled {
    background: var(--background-secondary);
    color: var(--text-muted);
    cursor: not-allowed;
  }

  /* Icon Buttons - minimal style matching GoalsWidget buttons */
  .journalit-compact-uploader-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0.4rem;
    background: transparent;
    border: none;
    border-radius: var(--radius-s);
    color: var(--text-muted);
    cursor: pointer;
    opacity: 0.6;
    transition: opacity 0.2s ease;
    flex-shrink: 0;
  }

  .journalit-compact-uploader-btn:hover:not(:disabled) {
    opacity: 1;
    color: var(--text-normal);
  }

  .journalit-compact-uploader-btn:disabled {
    opacity: 0.3;
    cursor: not-allowed;
  }

  .journalit-compact-uploader-btn svg {
    width: 16px;
    height: 16px;
  }

  /* Hidden file input */
  .journalit-compact-uploader-file-input {
    display: none;
  }

  /* Responsive adjustments */
  @media (max-width: 480px) {
    .journalit-compact-uploader {
      padding: 0.4rem;
      gap: 0.4rem;
    }

    .journalit-compact-uploader-url-input {
      padding: 0.4rem;
      font-size: 0.85em;
    }

    .journalit-compact-uploader-btn svg {
      width: 14px;
      height: 14px;
    }
  }
`});var EJ,jDe,j_,VE,IJ,__=F(()=>{EJ=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),jDe=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),j_=e=>{let t=jDe(e);return t.charAt(0).toUpperCase()+t.slice(1)},VE=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),IJ=e=>{for(let t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0}});var MJ,AJ=F(()=>{MJ={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"}});var JS,LJ,NJ=F(()=>{JS=Y(Q());AJ();__();LJ=(0,JS.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:a,iconNode:o,...s},l)=>(0,JS.createElement)("svg",{ref:l,...MJ,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:VE("lucide",i),...!a&&!IJ(s)&&{"aria-hidden":"true"},...s},[...o.map(([c,d])=>(0,JS.createElement)(c,d)),...Array.isArray(a)?a:[a]]))});var GE,he,rt=F(()=>{GE=Y(Q());__();NJ();he=(e,t)=>{let r=(0,GE.forwardRef)(({className:n,...i},a)=>(0,GE.createElement)(LJ,{ref:a,iconNode:t,className:VE(`lucide-${EJ(j_(e))}`,`lucide-${e}`,n),...i}));return r.displayName=j_(e),r}});var _De,QS,FJ=F(()=>{rt();_De=[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M17 10V4h-2",key:"zcsr5x"}],["path",{d:"M15 10h4",key:"id2lce"}],["rect",{x:"15",y:"14",width:"4",height:"6",ry:"2",key:"33xykx"}]],QS=he("arrow-down-1-0",_De)});var BDe,Ug,OJ=F(()=>{rt();BDe=[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]],Ug=he("arrow-down-wide-narrow",BDe)});var WDe,Hg,zJ=F(()=>{rt();WDe=[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M15 4h5l-5 6h5",key:"8asdl1"}],["path",{d:"M15 20v-3.5a2.5 2.5 0 0 1 5 0V20",key:"r6l5cz"}],["path",{d:"M20 18h-5",key:"18j1r2"}]],Hg=he("arrow-down-z-a",WDe)});var $De,XS,jJ=F(()=>{rt();$De=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],XS=he("arrow-right",$De)});var RDe,ZS,_J=F(()=>{rt();RDe=[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["rect",{x:"15",y:"4",width:"4",height:"6",ry:"2",key:"1bwicg"}],["path",{d:"M17 20v-6h-2",key:"1qp1so"}],["path",{d:"M15 20h4",key:"1j968p"}]],ZS=he("arrow-up-0-1",RDe)});var UDe,qg,BJ=F(()=>{rt();UDe=[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M20 8h-5",key:"1vsyxs"}],["path",{d:"M15 10V6.5a2.5 2.5 0 0 1 5 0V10",key:"ag13bf"}],["path",{d:"M15 14h5l-5 6h5",key:"ur5jdg"}]],qg=he("arrow-up-a-z",UDe)});var HDe,eT,WJ=F(()=>{rt();HDe=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],eT=he("arrow-up-down",HDe)});var qDe,Vg,$J=F(()=>{rt();qDe=[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]],Vg=he("arrow-up-narrow-wide",qDe)});var VDe,tT,RJ=F(()=>{rt();VDe=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],tT=he("award",VDe)});var GDe,Gg,UJ=F(()=>{rt();GDe=[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Gg=he("badge-check",GDe)});var YDe,rT,HJ=F(()=>{rt();YDe=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],rT=he("ban",YDe)});var KDe,nT,qJ=F(()=>{rt();KDe=[["path",{d:"M10 22V7a1 1 0 0 0-1-1H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-5a1 1 0 0 0-1-1H2",key:"1ah6g2"}],["rect",{x:"14",y:"2",width:"8",height:"8",rx:"1",key:"88lufb"}]],nT=he("blocks",KDe)});var JDe,Ov,VJ=F(()=>{rt();JDe=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Ov=he("book-open",JDe)});var QDe,Km,GJ=F(()=>{rt();QDe=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],Km=he("brain",QDe)});var XDe,zv,YJ=F(()=>{rt();XDe=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]],zv=he("calendar-check",XDe)});var ZDe,jv,KJ=F(()=>{rt();ZDe=[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M17 14h-6",key:"bkmgh3"}],["path",{d:"M13 18H7",key:"bb0bb7"}],["path",{d:"M7 14h.01",key:"1qa3f1"}],["path",{d:"M17 18h.01",key:"1bdyru"}]],jv=he("calendar-range",ZDe)});var eEe,Jm,JJ=F(()=>{rt();eEe=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Jm=he("calendar",eEe)});var tEe,Es,QJ=F(()=>{rt();tEe=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Es=he("chart-column",tEe)});var rEe,Fi,XJ=F(()=>{rt();rEe=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Fi=he("check",rEe)});var nEe,cs,ZJ=F(()=>{rt();nEe=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],cs=he("chevron-down",nEe)});var iEe,Nu,eQ=F(()=>{rt();iEe=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Nu=he("chevron-right",iEe)});var aEe,_v,tQ=F(()=>{rt();aEe=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],_v=he("chevron-up",aEe)});var oEe,Dp,rQ=F(()=>{rt();oEe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Dp=he("circle-alert",oEe)});var sEe,Aa,nQ=F(()=>{rt();sEe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Aa=he("circle-check",sEe)});var lEe,Qm,iQ=F(()=>{rt();lEe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],Qm=he("circle-plus",lEe)});var cEe,Fu,aQ=F(()=>{rt();cEe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Fu=he("circle-question-mark",cEe)});var dEe,Xm,oQ=F(()=>{rt();dEe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Xm=he("circle",dEe)});var uEe,iT,sQ=F(()=>{rt();uEe=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],iT=he("clipboard-check",uEe)});var pEe,Bv,lQ=F(()=>{rt();pEe=[["path",{d:"M11 14h10",key:"1w8e9d"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v1.344",key:"1e62lh"}],["path",{d:"m17 18 4-4-4-4",key:"z2g111"}],["path",{d:"M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 1.793-1.113",key:"bjbb7m"}],["rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",key:"ublpy"}]],Bv=he("clipboard-paste",pEe)});var mEe,Cd,cQ=F(()=>{rt();mEe=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Cd=he("clock",mEe)});var fEe,Pd,dQ=F(()=>{rt();fEe=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],Pd=he("copy",fEe)});var gEe,Yg,uQ=F(()=>{rt();gEe=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],Yg=he("ellipsis",gEe)});var hEe,aT,pQ=F(()=>{rt();hEe=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],aT=he("external-link",hEe)});var vEe,Wv,mQ=F(()=>{rt();vEe=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Wv=he("eye-off",vEe)});var yEe,oT,fQ=F(()=>{rt();yEe=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],oT=he("eye",yEe)});var bEe,Ep,gQ=F(()=>{rt();bEe=[["path",{d:"M12.659 22H18a2 2 0 0 0 2-2V8a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v9.34",key:"o6klzx"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10.378 12.622a1 1 0 0 1 3 3.003L8.36 20.637a2 2 0 0 1-.854.506l-2.867.837a.5.5 0 0 1-.62-.62l.836-2.869a2 2 0 0 1 .506-.853z",key:"zhnas1"}]],Ep=he("file-pen",bEe)});var xEe,$v,hQ=F(()=>{rt();xEe=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],$v=he("file-text",xEe)});var wEe,sT,vQ=F(()=>{rt();wEe=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}]],sT=he("file",wEe)});var kEe,lT,yQ=F(()=>{rt();kEe=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],lT=he("flame",kEe)});var SEe,cT,bQ=F(()=>{rt();SEe=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],cT=he("flask-conical",SEe)});var TEe,Zm,xQ=F(()=>{rt();TEe=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],Zm=he("folder-open",TEe)});var CEe,Rv,wQ=F(()=>{rt();CEe=[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]],Rv=he("folder-tree",CEe)});var PEe,Kg,kQ=F(()=>{rt();PEe=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Kg=he("funnel",PEe)});var DEe,dT,SQ=F(()=>{rt();DEe=[["path",{d:"M10.5 3 8 9l4 13 4-13-2.5-6",key:"b3dvk1"}],["path",{d:"M17 3a2 2 0 0 1 1.6.8l3 4a2 2 0 0 1 .013 2.382l-7.99 10.986a2 2 0 0 1-3.247 0l-7.99-10.986A2 2 0 0 1 2.4 7.8l2.998-3.997A2 2 0 0 1 7 3z",key:"7w4byz"}],["path",{d:"M2 9h20",key:"16fsjt"}]],dT=he("gem",DEe)});var EEe,ef,TQ=F(()=>{rt();EEe=[["path",{d:"M9 10h.01",key:"qbtxuw"}],["path",{d:"M15 10h.01",key:"1qmjsl"}],["path",{d:"M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z",key:"uwwb07"}]],ef=he("ghost",EEe)});var IEe,tf,CQ=F(()=>{rt();IEe=[["path",{d:"M12 3v17a1 1 0 0 1-1 1H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v6a1 1 0 0 1-1 1H3",key:"11za1p"}],["path",{d:"M16 19h6",key:"xwg31i"}],["path",{d:"M19 22v-6",key:"qhmiwi"}]],tf=he("grid-2x2-plus",IEe)});var MEe,uT,PQ=F(()=>{rt();MEe=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],uT=he("grip-vertical",MEe)});var AEe,Uv,DQ=F(()=>{rt();AEe=[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"19",cy:"5",r:"1",key:"w8mnmm"}],["circle",{cx:"5",cy:"5",r:"1",key:"lttvr7"}],["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}],["circle",{cx:"19",cy:"19",r:"1",key:"shf9b7"}],["circle",{cx:"5",cy:"19",r:"1",key:"bfqh0e"}]],Uv=he("grip",AEe)});var LEe,Hv,EQ=F(()=>{rt();LEe=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m8 11 4 4 4-4",key:"1dohi6"}],["path",{d:"M8 5H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-4",key:"1ywtjm"}]],Hv=he("import",LEe)});var NEe,Js,IQ=F(()=>{rt();NEe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Js=he("info",NEe)});var FEe,pT,MQ=F(()=>{rt();FEe=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],pT=he("key",FEe)});var OEe,mT,AQ=F(()=>{rt();OEe=[["rect",{width:"18",height:"7",x:"3",y:"3",rx:"1",key:"f1a2em"}],["rect",{width:"9",height:"7",x:"3",y:"14",rx:"1",key:"jqznyg"}],["rect",{width:"5",height:"7",x:"16",y:"14",rx:"1",key:"q5h2i8"}]],mT=he("layout-template",OEe)});var zEe,El,LQ=F(()=>{rt();zEe=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],El=he("lock",zEe)});var jEe,fT,NQ=F(()=>{rt();jEe=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],fT=he("message-circle",jEe)});var _Ee,qv,FQ=F(()=>{rt();_Ee=[["path",{d:"M5 12h14",key:"1ays0h"}]],qv=he("minus",_Ee)});var BEe,Ui,OQ=F(()=>{rt();BEe=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Ui=he("plus",BEe)});var WEe,Vv,zQ=F(()=>{rt();WEe=[["path",{d:"M16.247 7.761a6 6 0 0 1 0 8.478",key:"1fwjs5"}],["path",{d:"M19.075 4.933a10 10 0 0 1 0 14.134",key:"ehdyv1"}],["path",{d:"M4.925 19.067a10 10 0 0 1 0-14.134",key:"1q22gi"}],["path",{d:"M7.753 16.239a6 6 0 0 1 0-8.478",key:"r2q7qm"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Vv=he("radio",WEe)});var $Ee,gT,jQ=F(()=>{rt();$Ee=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],gT=he("refresh-cw",$Ee)});var REe,hT,_Q=F(()=>{rt();REe=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],hT=he("rocket",REe)});var UEe,Gv,BQ=F(()=>{rt();UEe=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Gv=he("rotate-ccw",UEe)});var HEe,vT,WQ=F(()=>{rt();HEe=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],vT=he("save",HEe)});var qEe,Yv,$Q=F(()=>{rt();qEe=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Yv=he("settings",qEe)});var VEe,yT,RQ=F(()=>{rt();VEe=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],yT=he("settings-2",VEe)});var GEe,Kv,UQ=F(()=>{rt();GEe=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Kv=he("shield",GEe)});var YEe,bT,HQ=F(()=>{rt();YEe=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],bT=he("sliders-horizontal",YEe)});var KEe,xT,qQ=F(()=>{rt();KEe=[["path",{d:"m10 20-1.25-2.5L6 18",key:"18frcb"}],["path",{d:"M10 4 8.75 6.5 6 6",key:"7mghy3"}],["path",{d:"m14 20 1.25-2.5L18 18",key:"1chtki"}],["path",{d:"m14 4 1.25 2.5L18 6",key:"1b4wsy"}],["path",{d:"m17 21-3-6h-4",key:"15hhxa"}],["path",{d:"m17 3-3 6 1.5 3",key:"11697g"}],["path",{d:"M2 12h6.5L10 9",key:"kv9z4n"}],["path",{d:"m20 10-1.5 2 1.5 2",key:"1swlpi"}],["path",{d:"M22 12h-6.5L14 15",key:"1mxi28"}],["path",{d:"m4 10 1.5 2L4 14",key:"k9enpj"}],["path",{d:"m7 21 3-6-1.5-3",key:"j8hb9u"}],["path",{d:"m7 3 3 6h4",key:"1otusx"}]],xT=he("snowflake",KEe)});var JEe,Ip,VQ=F(()=>{rt();JEe=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Ip=he("sparkles",JEe)});var QEe,Mp,GQ=F(()=>{rt();QEe=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Mp=he("square-check-big",QEe)});var XEe,So,YQ=F(()=>{rt();XEe=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],So=he("square-pen",XEe)});var ZEe,wT,KQ=F(()=>{rt();ZEe=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],wT=he("square",ZEe)});var eIe,rf,JQ=F(()=>{rt();eIe=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],rf=he("star",eIe)});var tIe,nf,QQ=F(()=>{rt();tIe=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],nf=he("tag",tIe)});var rIe,_x,XQ=F(()=>{rt();rIe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],_x=he("target",rIe)});var nIe,kT,ZQ=F(()=>{rt();nIe=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],kT=he("trash-2",nIe)});var iIe,Jv,eX=F(()=>{rt();iIe=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Jv=he("trash",iIe)});var aIe,Qv,tX=F(()=>{rt();aIe=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],Qv=he("trending-down",aIe)});var oIe,$c,rX=F(()=>{rt();oIe=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],$c=he("trending-up",oIe)});var sIe,oa,nX=F(()=>{rt();sIe=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],oa=he("triangle-alert",sIe)});var lIe,ST,iX=F(()=>{rt();lIe=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],ST=he("user",lIe)});var cIe,af,aX=F(()=>{rt();cIe=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],af=he("users",cIe)});var dIe,TT,oX=F(()=>{rt();dIe=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]],TT=he("wrench",dIe)});var uIe,La,sX=F(()=>{rt();uIe=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],La=he("x",uIe)});var pIe,of,lX=F(()=>{rt();pIe=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],of=he("zap",pIe)});var Ot=F(()=>{OJ();zJ();BJ();$J();UJ();QJ();rQ();nQ();iQ();aQ();uQ();gQ();kQ();CQ();VQ();GQ();YQ();nX();jJ();WJ();RJ();HJ();qJ();VJ();GJ();YJ();KJ();JJ();XJ();ZJ();tQ();eQ();oQ();sQ();lQ();cQ();dQ();pQ();mQ();fQ();hQ();vQ();yQ();bQ();xQ();wQ();SQ();TQ();PQ();DQ();EQ();IQ();MQ();AQ();LQ();NQ();FQ();OQ();zQ();jQ();_Q();BQ();WQ();RQ();$Q();UQ();HQ();qQ();KQ();JQ();QQ();XQ();ZQ();eX();tX();rX();iX();aX();sX();oX();lX();FJ();_J();});var Qs,Xv,YE=F(()=>{Qs=Y(Q()),Xv=({options:e,selectedValue:t,onSelect:r,className:n="",variant:i="default"})=>{let a=i==="goal"?"goal-options":"radio-options",o=i==="goal"?"goal-option":"radio-option",s=i==="goal"?"goal-radio":"option-radio",l=i==="goal"?"goal-radio-inner":"radio-inner",c=i==="goal"?"goal-content":"option-content";return Qs.default.createElement("div",{className:`${a} ${n}`},e.map((d,u)=>Qs.default.createElement("div",{key:d.value,className:`${o} ${t===d.value?"selected":""}`,onClick:()=>r(d.value),role:"button",tabIndex:0,autoFocus:u===0,onKeyPress:p=>p.key==="Enter"&&r(d.value)},Qs.default.createElement("div",{className:s},Qs.default.createElement("div",{className:`${l} ${t===d.value?"selected":""}`})),Qs.default.createElement("div",{className:c},i==="goal"?Qs.default.createElement(Qs.default.Fragment,null,Qs.default.createElement("h3",null,d.icon&&Qs.default.createElement("span",{style:{marginRight:"8px"}},d.icon),d.label),d.description&&Qs.default.createElement("p",null,d.description),d.badge&&Qs.default.createElement("span",{className:"goal-badge"},d.badge)):Qs.default.createElement(Qs.default.Fragment,null,Qs.default.createElement("span",{className:"option-label"},d.label),d.description&&Qs.default.createElement("span",{className:"option-description"},d.description))))))}});var dr,mIe,fIe,cX,gIe,dX,uX=F(()=>{dr=Y(Q());Ot();YE();mIe={display:"inline",marginRight:"8px"},fIe=({type:e})=>{let t={size:16,style:mIe};switch(e){case"regular":return dr.default.createElement($c,{...t});case"missed":return dr.default.createElement(oa,{...t});case"backtest":return dr.default.createElement(cT,{...t});default:return dr.default.createElement($c,{...t})}},cX=[{value:"regular",label:"Regular Trade",description:"Normal trade with full entry and exit data"},{value:"missed",label:"Missed Trade",description:"Trade opportunity that you missed - PnL and Account fields optional"},{value:"backtest",label:"Backtest Trade",description:"Backtesting scenario for analysis purposes"}],gIe=({data:e,onChange:t})=>{let[r,n]=(0,dr.useState)(!1),i=(0,dr.useRef)(null),[a,o]=(0,dr.useState)(0),s=(0,dr.useMemo)(()=>e.isMissedTrade?"missed":e.isBacktestTrade?"backtest":"regular",[e.isMissedTrade,e.isBacktestTrade]);(0,dr.useEffect)(()=>{if(i.current){let w=i.current.scrollHeight;o(w)}},[r,s,e.missedReason]);let l=(0,dr.useCallback)(w=>{t("isMissedTrade",!1),t("isBacktestTrade",!1),w==="missed"?t("isMissedTrade",!0):w==="backtest"&&t("isBacktestTrade",!0)},[t]),c=(0,dr.useMemo)(()=>{let w=cX.find(C=>C.value===s);return w?w.label:"Regular Trade"},[s]),d=(0,dr.useCallback)(()=>{n(!r)},[r]),u=(0,dr.useCallback)(w=>{(w.key==="Enter"||w.key===" ")&&(w.preventDefault(),n(!r))},[r]),p=(0,dr.useCallback)(w=>{t("missedReason",w.target.value)},[t]),m=(0,dr.useMemo)(()=>({marginBottom:"16px",border:r?"1px solid var(--background-modifier-border)":"none",borderRadius:"8px",backgroundColor:r?"var(--background-secondary)":"transparent"}),[r]),g=(0,dr.useMemo)(()=>({display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 16px",cursor:"pointer",userSelect:"none",border:r?"none":"1px solid var(--background-modifier-border)",borderRadius:r?"none":"8px",backgroundColor:r?"transparent":"var(--background-primary)"}),[r]),f=(0,dr.useMemo)(()=>({fontWeight:"600",color:"var(--text-normal)",cursor:"pointer",marginRight:"8px"}),[]),v=(0,dr.useMemo)(()=>({fontSize:"14px",color:"var(--text-muted)",fontWeight:"500",display:"flex",alignItems:"center"}),[]),h=(0,dr.useMemo)(()=>({color:"var(--text-muted)",transform:r?"rotate(0deg)":"rotate(-90deg)",transition:"transform 0.2s ease"}),[r]),y=(0,dr.useMemo)(()=>({height:r?`${a}px`:"0px",overflow:"hidden",opacity:r?1:0,visibility:r?"visible":"hidden",transition:r?"height 0.3s ease, opacity 0.2s ease 0.1s, visibility 0s ease 0s":"height 0.25s ease, opacity 0.15s ease, visibility 0s ease 0s",borderTop:r?"1px solid var(--background-modifier-border)":"none"}),[r,a]),b=(0,dr.useMemo)(()=>({padding:r?"16px":"0"}),[r]),k=(0,dr.useMemo)(()=>({margin:"0 0 16px 0",fontSize:"13px",color:"var(--text-muted)",lineHeight:"1.4"}),[]),x=(0,dr.useMemo)(()=>({marginTop:"16px"}),[]),S=(0,dr.useMemo)(()=>({width:"100%",padding:"8px",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",backgroundColor:"var(--background-primary)",color:"var(--text-normal)",fontSize:"14px",fontFamily:"inherit",resize:"vertical"}),[]);return dr.default.createElement("div",{className:"field"},dr.default.createElement("div",{className:"trade-type-selector",style:m},dr.default.createElement("div",{onClick:d,role:"button","aria-expanded":r,tabIndex:0,onKeyDown:u,style:g},dr.default.createElement("div",null,dr.default.createElement("label",{style:f},"Trade Type"),dr.default.createElement("span",{style:v},dr.default.createElement(fIe,{type:s}),c)),dr.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:h},dr.default.createElement("polyline",{points:"6 9 12 15 18 9"}))),dr.default.createElement("div",{style:y},dr.default.createElement("div",{ref:i,style:b},dr.default.createElement("p",{style:k},"Choose the type of trade you're creating"),dr.default.createElement(Xv,{options:cX,selectedValue:s,onSelect:l,variant:"default"}),s==="missed"&&dr.default.createElement("div",{className:"field",style:x},dr.default.createElement("label",{className:"label"},"Why did you miss this trade?"),dr.default.createElement("textarea",{value:e.missedReason||"",onChange:p,placeholder:"Describe why you missed this trade opportunity...",rows:3,className:"textarea",style:S}))))))},dX=(0,dr.memo)(gIe,(e,t)=>e.data.isMissedTrade===t.data.isMissedTrade&&e.data.isBacktestTrade===t.data.isBacktestTrade&&e.data.missedReason===t.data.missedReason&&e.onChange===t.onChange)});var cc,qa,Jg=F(()=>{cc=Y(Q()),qa=cc.default.forwardRef(({className:e="",id:t,label:r,error:n,helperText:i,disabled:a=!1,size:o="md",variant:s="default",loading:l=!1,onChange:c,multiline:d=!1,rows:u=3,required:p=!1,...m},g)=>{let f=(0,cc.useId)(),v=t||`input-${f}`,h=`helper-${v}`,y=`error-${v}`,[b,k]=(0,cc.useState)(!1),x=typeof m.value=="string"&&(m.value==="0"||m.value==="0.00"||/^0\.0+$/.test(m.value)),S=["input",o,s,n?"error":"",x?"default-value":"",e].filter(Boolean).join(" "),w=["inputContainer",l?"loading":""].filter(Boolean).join(" ");return cc.default.createElement("div",{className:w},r&&cc.default.createElement("label",{htmlFor:v,className:"label"},r,p&&cc.default.createElement("span",{className:"required-indicator"},"*")),cc.default.createElement("div",{className:"inputWrapper"},d?cc.default.createElement("textarea",{id:v,className:S,disabled:a||l,"aria-invalid":!!n,"aria-describedby":n?y:i?h:void 0,rows:u,onFocus:P=>{k(!0)},onBlur:P=>{k(!1)},onChange:P=>{c&&c(P.target.value)},value:m.value,placeholder:m.placeholder}):cc.default.createElement("input",{ref:g,id:v,className:S,disabled:a||l,"aria-invalid":!!n,"aria-describedby":n?y:i?h:void 0,onFocus:P=>{var M;k(!0),(M=m.onFocus)==null||M.call(m,P)},onBlur:P=>{var M;k(!1),(M=m.onBlur)==null||M.call(m,P)},onChange:P=>{c&&c(P.target.value)},...m})),n&&cc.default.createElement("div",{id:y,className:"errorMessage",role:"alert"},n),!n&&i&&cc.default.createElement("div",{id:h,className:"helperText"},i))});qa.displayName="Input"});var Dd,Xi,Zv=F(()=>{Dd=Y(Q()),Xi=Dd.default.forwardRef(({className:e="",id:t,label:r,options:n=[],error:i,helperText:a,disabled:o=!1,size:s="md",placeholder:l="Select an option",onChange:c,...d},u)=>{let p=(0,Dd.useId)(),m=t||`select-${p}`,g=`helper-${m}`,f=`error-${m}`,v=["select",s,i?"error":"",e,"journalit-select"].filter(Boolean).join(" "),h=y=>{c&&c(y.target.value),y.target&&y.target.setAttribute("data-has-value",y.target.value?"true":"false")};return Dd.default.createElement("div",{className:"selectContainer"},r&&Dd.default.createElement("label",{htmlFor:m,className:"label"},r),Dd.default.createElement("div",{className:"selectWrapper"},Dd.default.createElement("select",{ref:u,id:m,className:v,disabled:o,"data-has-value":d.value||d.defaultValue?"true":"false","aria-invalid":!!i,"aria-describedby":i?f:a?g:void 0,onChange:h,style:{color:d.value?"var(--text-normal)":"var(--text-muted)",opacity:d.value?1:.7},...d},!d.value&&!d.defaultValue&&Dd.default.createElement("option",{value:"",disabled:!0,className:"select-placeholder",style:{color:"var(--text-muted)",opacity:.9,padding:"8px",fontSize:"14px",lineHeight:"normal",height:"auto"}},l),n.map(y=>Dd.default.createElement("option",{key:y.value,value:y.value,style:{color:"var(--text-normal)",opacity:1}},y.label)))),i&&Dd.default.createElement("div",{id:f,className:"errorMessage",role:"alert"},i),!i&&a&&Dd.default.createElement("div",{id:g,className:"helperText"},a))});Xi.displayName="Select"});var Is,CT,B_,pX,W_,mX=F(()=>{Is=Y(Q());Jg();CT=e=>{if(!e)return"";if(typeof e=="string")return/^\d{4}-\d{2}-\d{2}$/.test(e)?e:"";let t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${n}`},B_=e=>{if(!e)return"";if(typeof e=="string")return/^\d{1,2}:\d{2}$/.test(e)?e:"";let t=String(e.getHours()).padStart(2,"0"),r=String(e.getMinutes()).padStart(2,"0");return`${t}:${r}`},pX=(e,t)=>{try{if(!e)return null;let[r,n,i]=e.split("-").map(Number),a=new Date(r,n-1,i);if(t){let[o,s]=t.split(":").map(Number);a.setHours(o,s)}return a}catch(r){return null}},W_=({label:e,value:t,onChange:r,error:n,helperText:i,disabled:a=!1,className:o,includeTime:s=!1,timeOnly:l=!1,minDate:c,maxDate:d,required:u=!1,...p})=>{let m=(0,Is.useId)(),g=`date-${m}`,f=`time-${m}`,[v,h]=(0,Is.useState)(!1),[y,b]=(0,Is.useState)(""),[k,x]=(0,Is.useState)(""),S=(0,Is.useMemo)(()=>v?y:CT(t),[v,y,t]),w=(0,Is.useMemo)(()=>v?k:B_(t),[v,k,t]),C=(0,Is.useCallback)(A=>{if(v?b(A):(h(!0),b(A),x(B_(t))),A){let I=v?k:B_(t),L=pX(A,I);L&&r&&r(L)}else r&&r(void 0)},[v,k,t,r,l]),D=(0,Is.useCallback)(A=>{if(v||(h(!0),b(CT(t))),x(A),l)A&&r?r(A):r&&!A&&r(void 0);else{let I=v?y:CT(t);if(I&&A){let L=pX(I,A);L&&r&&r(L)}}},[v,y,t,r,l]),P=(0,Is.useCallback)(()=>{h(!1),b(""),x("")},[]),M=c?CT(c):void 0,z=d?CT(d):void 0;return Is.default.createElement("div",{className:"date-picker-container",style:{position:"relative"}},!l&&Is.default.createElement(qa,{id:g,label:e,type:"date",value:S,onChange:C,onBlur:P,error:n,helperText:i,disabled:a,className:o,min:M,max:z,required:u,...p}),(s||l)&&Is.default.createElement(qa,{id:f,label:l?e:void 0,type:"time",value:w,onChange:D,onBlur:P,error:l?n:void 0,helperText:l?i:void 0,disabled:a,className:l?o:"time-input","aria-label":l?void 0:"Time",style:l?{}:{marginTop:"8px"},required:l?u:!1,...l?p:{}}))};W_.displayName="DatePicker"});function ea(e){let t=e.getDay(),r=t===0?6:t-1,n=new Date(e);return n.setDate(e.getDate()-r),n.setHours(0,0,0,0),n}function $_(e,t=!0){let r=new Date(e);if(!t)return r.setDate(r.getDate()+1),r;r.setDate(r.getDate()+1);let n=r.getDay();return n===0?r.setDate(r.getDate()+1):n===6&&r.setDate(r.getDate()+2),r}function R_(e,t=!0){let r=new Date(e);if(!t)return r.setDate(r.getDate()-1),r;r.setDate(r.getDate()-1);let n=r.getDay();return n===0?r.setDate(r.getDate()-2):n===6&&r.setDate(r.getDate()-1),r}function Ou(e){if(e.getFullYear()===2025&&e.getMonth()===2){if(e.getDate()>=10&&e.getDate()<=16)return 11;if(e.getDate()===31)return 14}let t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()));t.setUTCDate(t.getUTCDate()+4-(t.getUTCDay()||7));let r=new Date(Date.UTC(t.getUTCFullYear(),0,1));return Math.ceil(((t.getTime()-r.getTime())/864e5+1)/7)}function dc(e){return`W${Ou(e).toString().padStart(2,"0")}`}function Bx(e,t){let r=Ou(e),n=hIe(e),i=`W${r.toString().padStart(2,"0")}`;return n!==t?`${i}-${n}`:i}function Wx(e){let t=new Date(e),r=t.getDay(),n=r===0?-3:4-r;return t.setDate(t.getDate()+n),t.setHours(0,0,0,0),t}function hIe(e){return Wx(e).getFullYear()}function KE(e){var t,r,n,i,a,o,s,l,c,d;if(e&&e.settings&&e.settings.trade)return e.settings.trade.skipWeekends!==!1;try{if(((n=(r=(t=window.journalitPlugin)==null?void 0:t.settings)==null?void 0:r.trade)==null?void 0:n.skipWeekends)!==void 0)return window.journalitPlugin.settings.trade.skipWeekends;if((a=(i=window.journalitPlugin)==null?void 0:i.settings)!=null&&a.trade){window.journalitPlugin.settings.trade.skipWeekends=!0;try{window.journalitPlugin.saveSettings()}catch(p){console.error("Failed to save settings after setting skipWeekends",p)}return!0}let u=window.JournalitPlugin;if(((l=(s=(o=u==null?void 0:u.instance)==null?void 0:o.settings)==null?void 0:s.trade)==null?void 0:l.skipWeekends)!==void 0)return u.instance.settings.trade.skipWeekends;if((d=(c=u==null?void 0:u.instance)==null?void 0:c.settings)!=null&&d.trade){u.instance.settings.trade.skipWeekends=!0;try{u.instance.saveSettings()}catch(p){console.error("Failed to save settings after setting skipWeekends via static instance",p)}return!0}return!0}catch(u){return console.warn("Error accessing plugin settings, using default (skip weekends)"),!0}}function ii(e,t=!0){let r;typeof e=="string"?r=new Date(e):r=e;let n=r.getFullYear(),i=r.getMonth(),a=r.getDate(),o=new Date(n,i,a);return t?o.setHours(0,0,0,0):o.setHours(23,59,59,999),o}function zt(e,t="DDMMYY",r="/"){if(!e)return"Unknown";let n=e;if(typeof e=="string"&&(n=new Date(e)),!(n instanceof Date)||isNaN(n.getTime()))return"Unknown";let i=String(n.getDate()).padStart(2,"0"),a=String(n.getMonth()+1).padStart(2,"0"),o=String(n.getFullYear()).slice(2);switch(t){case"DDMMYY":return`${i}${r}${a}${r}${o}`;case"MMDDYY":return`${a}${r}${i}${r}${o}`;case"YYMMDD":return`${o}${r}${a}${r}${i}`;default:return`${i}${r}${a}${r}${o}`}}function vn(){var e,t,r,n,i,a;try{if((r=(t=(e=window.journalitPlugin)==null?void 0:e.settings)==null?void 0:t.trade)!=null&&r.dateFormat)return window.journalitPlugin.settings.trade.dateFormat;let o=window.JournalitPlugin;return(a=(i=(n=o==null?void 0:o.instance)==null?void 0:n.settings)==null?void 0:i.trade)!=null&&a.dateFormat?o.instance.settings.trade.dateFormat:"DDMMYY"}catch(o){return console.warn("Error accessing date format setting, using default (DDMMYY)",o),"DDMMYY"}}function Ap(e){let t=e.getMonth();return Math.floor(t/3)+1}function Oi(e){return Math.ceil(e/3)}function JE(e){let t=(e-1)*3+1;return[t,t+1,t+2]}function sf(e,t){let r=(t-1)*3;return new Date(e,r,1,0,0,0,0)}function ey(e,t){let r=t*3;return new Date(e,r,0,23,59,59,999)}function zu(e){return`Q${e}`}function QE(e){return new Date(e,0,1,0,0,0,0)}function fX(e){return new Date(e,11,31,23,59,59,999)}function dn(e){if(e instanceof Date&&!isNaN(e.getTime()))return e;if(e==null||e==="")return null;try{let t=new Date(e);if(!isNaN(t.getTime()))return t}catch(t){}return null}function $x(e){if(e==null||e==="")return!1;if(e instanceof Date)return!isNaN(e.getTime());try{let t=new Date(e);return!isNaN(t.getTime())}catch(t){return!1}}function ur(e){if(e==null||e==="")return null;if(e instanceof Date)return isNaN(e.getTime())?null:e;if(typeof e=="number"){let i=new Date(e);return isNaN(i.getTime())?null:i}let r=String(e).split("-").map(i=>parseInt(i,10));if(r.length===3&&r.every(i=>!isNaN(i))){let i=new Date(r[0],r[1]-1,r[2]);return isNaN(i.getTime())||i.getFullYear()!==r[0]||i.getMonth()!==r[1]-1||i.getDate()!==r[2]?null:i}let n=new Date(e);return isNaN(n.getTime())?null:n}function To(e){let t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${n}`}function Zi(e){let t=dn(e);return t?t.getTime():null}function Rc(e,t){let r=Zi(e),n=Zi(t);return r===null&&n===null?0:r===null?1:n===null?-1:r-n}function U_(e,t){let r=Zi(e),n=Zi(t);return r===null||n===null?null:Math.abs(n-r)}function PT(e,t="DDMMYY",r="/"){let n=e.map(c=>{if(!c)return null;let d=typeof c=="string"?new Date(c):c;return d instanceof Date&&!isNaN(d.getTime())?d:null}),i=n.filter(c=>c!==null);if(i.length===0)return e.map(()=>"Unknown");let a=new Set(i.map(c=>c.getFullYear())),o=new Set(i.map(c=>`${c.getFullYear()}-${c.getMonth()}-${c.getDate()}`)),s=a.size===1,l=o.size===1;return n.map((c,d)=>{if(!c)return"Unknown";if(l)return`#${d+1}`;if(s){let u=c.getDate(),p=c.toLocaleDateString(void 0,{month:"short"});return`${u} ${p}`}else return zt(c,t,r)})}function DT(e){let t=Zi(e);if(t===null)return null;let r=new Date;r.setHours(0,0,0,0);let n=r.getTime(),i=t-n;return Math.floor(i/(1e3*60*60*24))}var _t=F(()=>{});function gX(e,t){let[r,n]=(0,Ed.useState)(e);return(0,Ed.useEffect)(()=>{let i=setTimeout(()=>{n(e)},t);return()=>{clearTimeout(i)}},[e,t]),r}function XE(e,t,r={leading:!1,trailing:!0}){let n=(0,Ed.useRef)(null),i=(0,Ed.useRef)(0),a=(0,Ed.useRef)(null),o=(0,Ed.useCallback)((...s)=>{let l=Date.now();a.current=s;let c=r.leading&&(!i.current||l-i.current>t);n.current&&clearTimeout(n.current),c?(i.current=l,e(...s)):r.trailing&&(n.current=setTimeout(()=>{a.current&&(i.current=Date.now(),e(...a.current))},t))},[e,t,r.leading,r.trailing]);return(0,Ed.useEffect)(()=>()=>{n.current&&clearTimeout(n.current)},[]),o}var Ed,ZE=F(()=>{Ed=Y(Q())});function vIe(e,t){let r=e.replace(/[^\d]/g,"");if(r.length!==6)return{date:null,error:"Date must be 6 digits (DDMMYY format)"};let n,i,a;switch(t){case"DDMMYY":n=parseInt(r.slice(0,2),10),i=parseInt(r.slice(2,4),10),a=parseInt(r.slice(4,6),10);break;case"MMDDYY":i=parseInt(r.slice(0,2),10),n=parseInt(r.slice(2,4),10),a=parseInt(r.slice(4,6),10);break;case"YYMMDD":a=parseInt(r.slice(0,2),10),i=parseInt(r.slice(2,4),10),n=parseInt(r.slice(4,6),10);break;default:n=parseInt(r.slice(0,2),10),i=parseInt(r.slice(2,4),10),a=parseInt(r.slice(4,6),10)}if(a>50?a=1900+a:a=2e3+a,i<1||i>12)return{date:null,error:"Invalid month"};if(n<1||n>31)return{date:null,error:"Invalid day"};let o=new Date(a,i-1,n);return o.getDate()!==n||o.getMonth()!==i-1||o.getFullYear()!==a?{date:null,error:"Invalid date"}:{date:o,error:null}}function hX(e){let t=e.toLowerCase().replace(/\s/g,""),r=/[ap]m?$/.test(t),n=/pm?$/.test(t),i=t.replace(/[ap]m?$/,""),a,o;if(i.includes(":")){let l=i.split(":");if(l.length!==2)return{date:null,error:"Invalid time format"};a=parseInt(l[0],10),o=parseInt(l[1],10)}else if(i.length===3)a=parseInt(i.slice(0,1),10),o=parseInt(i.slice(1,3),10);else if(i.length===4)a=parseInt(i.slice(0,2),10),o=parseInt(i.slice(2,4),10);else return{date:null,error:"Time must be 3 or 4 digits"};if(r){if(a<1||a>12)return{date:null,error:"Hours must be 1-12 with AM/PM"};n&&a!==12?a+=12:!n&&a===12&&(a=0)}else if(a<0||a>23)return{date:null,error:"Hours must be 0-23 in 24-hour format"};if(o<0||o>59)return{date:null,error:"Minutes must be 0-59"};let s=new Date;return s.setHours(a,o,0,0),{date:s,error:null}}function eI(e){let t=e.getHours(),r=e.getMinutes(),n=t>=12?"PM":"AM";return`${t%12||12}:${String(r).padStart(2,"0")} ${n}`}function vX(e,t,r=""){let n=String(e.getDate()).padStart(2,"0"),i=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getFullYear()).slice(2);switch(t){case"DDMMYY":return`${n}${r}${i}${r}${a}`;case"MMDDYY":return`${i}${r}${n}${r}${a}`;case"YYMMDD":return`${a}${r}${i}${r}${n}`;default:return`${n}${r}${i}${r}${a}`}}var $n,Il,tI=F(()=>{$n=Y(Q());Ot();Jg();mX();_t();ZE();Il=$n.default.memo(({label:e,value:t,onChange:r,includeTime:n=!1,timeOnly:i=!1,required:a=!1,error:o,placeholder:s,disabled:l=!1,className:c,minDate:d})=>{let[u,p]=(0,$n.useState)(""),[m,g]=(0,$n.useState)(!1),[f,v]=(0,$n.useState)(!1),[h,y]=(0,$n.useState)(null),b=(0,$n.useRef)(null),k=(0,$n.useMemo)(()=>{if(t){if(typeof t=="string"){let T=new Date(t);return isNaN(T.getTime())?void 0:T}return t}},[t]),x=vn(),S=XE(T=>{r&&r(T||void 0)},i?600:300),w=(0,$n.useMemo)(()=>{if(s)return s;if(i)return"1022p or 10:22 AM";let T=x==="MMDDYY"?"123124":x==="YYMMDD"?"241231":"311224";return n?`${T} 1022p`:T},[s,i,x,n]),C=(0,$n.useCallback)((T,$=!1)=>{if(!T.trim())return{date:null,error:null};try{let _=T.trim();if(i)return hX(_);let B=_.split(" "),W=B[0],N=B[1];if(!W)return{date:null,error:"Date required"};let U=vIe(W,x);if(U.error)return U;let j=U.date;if(n){if(N){let R=hX(N);if(R.error)return R;R.date&&(j.setHours(R.date.getHours()),j.setMinutes(R.date.getMinutes()))}else if($){let R=new Date;j.setHours(R.getHours()),j.setMinutes(R.getMinutes())}}return{date:j,error:null}}catch(_){return{date:null,error:"Invalid format"}}},[i,x,n]),D=(0,$n.useCallback)(T=>{if(!i&&!n)return!1;let $=T.trim(),_=$.split(" ");if(i){let B=/^\d{3,4}$/.test($),W=/[ap]m?$/i.test($);return B&&!W}if(n){if(_.length===1&&/^\d{6}$/.test(_[0]))return!0;let B=_[1];if(B){let W=/^\d{3,4}$/.test(B),N=/[ap]m?$/i.test(B);return W&&!N}}return!1},[i,n]),P=(0,$n.useCallback)(T=>{if(p(T),m||g(!0),o||y(null),D(T))return;let{date:$,error:_}=C(T,!1);T.trim()&&_&&!o?y(_):_||S($)},[m,C,S,o,D]),M=(0,$n.useCallback)(()=>{if(!m&&(g(!0),k)){let T=i?eI(k):`${vX(k,x,"")}${n?` ${eI(k)}`:""}`;p(T)}},[m,k,i,x,n]),z=(0,$n.useCallback)(()=>{if(m){let{date:T,error:$}=C(u,!0);u.trim()?$&&!o?y($):(o||y(null),r&&!$&&r(T||void 0)):(r&&r(void 0),o||y(null)),g(!1)}},[m,u,C,r,o]),A=(0,$n.useCallback)(()=>{v(!f)},[f]),I=(0,$n.useCallback)(T=>{if(r){let $;if(T instanceof Date)$=T;else if(typeof T=="string"){let _=new Date(T);$=isNaN(_.getTime())?void 0:_}r($)}v(!1),g(!1),p(""),y(null)},[r]),L=(0,$n.useMemo)(()=>{if(m)return u;if(!k)return"";if(i)return eI(k);let T=vX(k,x,""),$=n?` ${eI(k)}`:"";return`${T}${$}`},[m,u,k,i,x,n]);return $n.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"4px",width:"100%"},className:c},e&&$n.default.createElement("label",{style:{fontSize:"14px",fontWeight:"500",color:"var(--text-normal)",marginBottom:"2px"}},e,a&&$n.default.createElement("span",{style:{color:"var(--text-error)",marginLeft:"2px"}},"*")),$n.default.createElement("div",{style:{position:"relative",display:"flex",alignItems:"flex-start"}},$n.default.createElement(qa,{ref:b,type:"text",value:L,onChange:P,onFocus:M,onBlur:z,placeholder:w,disabled:l,error:o||(o?null:h)||void 0,style:{paddingRight:"40px"}}),$n.default.createElement("div",{style:{position:"absolute",right:"8px",display:"flex",alignItems:"center"}},$n.default.createElement("button",{type:"button",onClick:A,className:"jl-icon-button-hover clickable-icon",style:{background:"none",border:"none",cursor:l?"not-allowed":"pointer",padding:"4px",borderRadius:"4px",color:"var(--text-muted)",display:"flex",alignItems:"center",justifyContent:"center",opacity:l?.5:1},disabled:l,"aria-label":"Open date picker"},i?$n.default.createElement(Cd,{size:16}):$n.default.createElement(Jm,{size:16})))),f&&$n.default.createElement("div",{style:{marginTop:"8px",padding:"12px",border:"1px solid var(--background-modifier-border)",borderRadius:"6px",background:"var(--background-primary)"}},$n.default.createElement(W_,{value:k,onChange:I,includeTime:n,timeOnly:i,required:a,minDate:d})))});Il.displayName="FastDateTimeInput"});var ty,$r,rI=F(()=>{ty=Y(Q());Jg();$r=({value:e,onChange:t,min:r,max:n,step:i=1,precision:a=2,allowDecimal:o=!0,...s})=>{let[l,c]=(0,ty.useState)(e!=null?e.toString():""),[d,u]=(0,ty.useState)(!1);return(0,ty.useEffect)(()=>{if(!d&&e!==void 0&&e!==null){let v=o&&a>0?e.toFixed(a):e.toString();c(v)}else!d&&e==null&&c("")},[e,o,a,d]),ty.default.createElement(qa,{...s,type:"text",inputMode:o?"decimal":"numeric",value:l,onChange:v=>{if(u(!0),!v){c(""),t==null||t(void 0);return}if(!(o?/^-?\d*\.?\d*$/:/^-?\d*$/).test(v)||(c(v),v==="-"||v==="."||v==="-."))return;let y=o?parseFloat(v):parseInt(v,10);if(!isNaN(y)){let b=y;r!==void 0&&y<r&&(b=r),n!==void 0&&y>n&&(b=n),t==null||t(b)}},onFocus:v=>{var y;u(!0),(parseFloat(l)===0||l==="0"||/^0\.0+$/.test(l))&&v.target.select(),(y=s.onFocus)==null||y.call(s,v)},onBlur:v=>{var h;if(u(!1),l&&!isNaN(parseFloat(l))){let y=parseFloat(l);o&&a>0&&c(y.toFixed(a))}else(l==="-"||l===".")&&(c(""),t==null||t(void 0));(h=s.onBlur)==null||h.call(s,v)},onKeyDown:v=>{var h;if(v.key==="ArrowUp"||v.key==="ArrowDown"){v.preventDefault();let y=l?parseFloat(l):0;if(!isNaN(y)){let b=v.key==="ArrowUp"?i:-i,k=y+b,x=k;r!==void 0&&k<r&&(x=r),n!==void 0&&k>n&&(x=n);let S=o&&a>0?x.toFixed(a):x.toString();c(S),t==null||t(x)}}(h=s.onKeyDown)==null||h.call(s,v)},min:r,max:n,step:i})};$r.displayName="NumberInput"});var br,Lp,yIe,bIe,Xs,ET=F(()=>{br=Y(Q()),Lp={COMBOBOX_CONTAINER:"combobox-container",INPUT_CONTAINER:"input-container",INPUT:"combobox-input",DROPDOWN:"combobox-dropdown",OPTION:"combobox-option",OPTION_HIGHLIGHTED:"highlighted",ADD_OPTION:"combobox-add-option",SELECTED_ITEM:"selected-item",REMOVE_BUTTON:"remove-button"},yIe=e=>({backgroundColor:e?"var(--background-secondary)":"var(--background-primary)"}),bIe=e=>({backgroundColor:e?"var(--background-secondary)":"var(--background-primary)"}),Xs=({options:e,value:t,onChange:r,allowCreate:n=!1,isMulti:i=!1,label:a,placeholder:o="Select or type...",error:s,helperText:l,optionType:c,onSaveOption:d,required:u=!1})=>{let p=(0,br.useId)(),m=`combobox-${p}`,g=`combobox-list-${p}`,f=`helper-${p}`,v=`error-${p}`,[h,y]=(0,br.useState)(()=>i?"":t||""),[b,k]=(0,br.useState)(!1),[x,S]=(0,br.useState)(-1),w=(0,br.useRef)(null),C=(0,br.useRef)(null),D=(0,br.useRef)(!1),P=(0,br.useRef)(!1),M=i?Array.isArray(t)?[...t]:[]:[],z=(0,br.useMemo)(()=>!i&&!b&&t?t:h,[i,b,t,h]),A=(0,br.useCallback)(O=>{y(O.target.value),k(!0),S(-1)},[]),I=O=>{let q=(O.startsWith("__add__")?O.slice(7):O).trim();if(q!==""){if(i){let V=Array.isArray(t)?[...t]:[];if(!V.includes(q)){let J=[...V,q];r(J),d&&O.startsWith("__add__")&&(c==="instrument"?/^[A-Z0-9.]+$/i.test(q)&&d(q):d(q)),(O.startsWith("__add__")||e.includes(O))&&y("")}k(!0),C.current&&setTimeout(()=>{C.current&&C.current.focus()},0)}else r(q),d&&O.startsWith("__add__")&&(c==="instrument"?/^[A-Z0-9.]+$/i.test(q)&&d(q):d(q)),y(q),k(!1);S(-1)}};(0,br.useEffect)(()=>{let O=H=>{var J,K,G;let q=H.target,V=(J=q==null?void 0:q.closest)==null?void 0:J.call(q,'[role="option"]');if(V&&((K=w.current)!=null&&K.contains(q))){D.current=!0;let X=(G=V.textContent)==null?void 0:G.trim();if(!X)return;let te=V.hasAttribute("data-add-option")?`__add__${h}`:X,re=te.startsWith("__add__")?te:X;I(re),setTimeout(()=>{D.current=!1,i?(k(!0),C.current&&(C.current.focus(),y(""))):k(!1)},50)}};return document.addEventListener("mousedown",O,!0),()=>{document.removeEventListener("mousedown",O,!0)}},[i,h,I]);let L=(0,br.useCallback)(O=>{if(!i)return;P.current=!0;let q=(Array.isArray(t)?[...t]:[]).filter(V=>V!==O);r(q),setTimeout(()=>{C.current&&C.current.focus(),P.current=!1},50)},[i,r]);(0,br.useLayoutEffect)(()=>{if(!b)return;let O=H=>{var G,X,te;if(P.current)return;let q=H.target,V=(G=q==null?void 0:q.closest)==null?void 0:G.call(q,'[role="option"]'),J=(X=q==null?void 0:q.closest)==null?void 0:X.call(q,'[data-remove-button="true"]');if(!((te=w.current)==null?void 0:te.contains(q))){k(!1);return}if(V){H.stopPropagation();return}if(J){H.preventDefault(),H.stopPropagation(),P.current=!0;let Z=(J.getAttribute("aria-label")||"").replace("Remove ","");if(Z){let se=(Array.isArray(t)?[...t]:[]).filter(ee=>ee!==Z);r(se),setTimeout(()=>{C.current&&C.current.focus(),P.current=!1},50)}}};return document.addEventListener("mousedown",O,!0),()=>{document.removeEventListener("mousedown",O,!0)}},[b,r]),(0,br.useEffect)(()=>{if(!b)return;let O=H=>{H.key==="Escape"&&k(!1)};return document.addEventListener("keydown",O,!0),()=>{document.removeEventListener("keydown",O,!0)}},[b]),(0,br.useEffect)(()=>{if(!b)return;let O=()=>{k(!1)};return window.addEventListener("blur",O),()=>{window.removeEventListener("blur",O)}},[b]);let E=(0,br.useMemo)(()=>{let O=i?Array.isArray(t)?t:[]:[];return e.filter(H=>H.toLowerCase().includes(h.toLowerCase())).filter(H=>!i||!O.includes(H))},[e,h,i,t]),T=(0,br.useMemo)(()=>n&&h.trim()!==""&&!e.find(O=>O.toLowerCase()===h.toLowerCase()),[n,h,e]),$=(0,br.useCallback)(O=>{let H=E.length+(T?1:0);switch(O.key){case"ArrowDown":O.preventDefault(),k(!0),S(q=>(q+1)%H);break;case"ArrowUp":O.preventDefault(),k(!0),S(q=>(q-1+H)%H);break;case"Enter":O.preventDefault(),b?x>=0&&x<E.length?I(E[x]):T&&x===E.length?I(`__add__${h}`):n&&h.trim()!==""&&I(`__add__${h}`):k(!0);break;case"Tab":if(h.trim()!==""&&E.length>0){let q=E.find(V=>V.toLowerCase().startsWith(h.toLowerCase()));q?(O.preventDefault(),I(q)):I(E[0])}else i||k(!1);break;case"Escape":k(!1);break}},[E,T,b,x,n,h,i,I]),_=br.default.useMemo(()=>E.map((O,H)=>br.default.createElement("li",{id:`option-${H}`,key:O,role:"option","aria-selected":x===H,className:`${Lp.OPTION} ${x===H?Lp.OPTION_HIGHLIGHTED:""}`,style:yIe(x===H),onMouseEnter:()=>S(H)},O)),[E,x]),B=br.default.useMemo(()=>T?br.default.createElement("li",{id:`option-${E.length}`,role:"option","aria-selected":x===E.length,"data-add-option":"true",className:`${Lp.ADD_OPTION} ${x===E.length?Lp.OPTION_HIGHLIGHTED:""}`,style:bIe(x===E.length),onMouseEnter:()=>S(E.length)},'Add "',h,'"'):null,[T,h,E.length,x]),W=br.default.useMemo(()=>i?br.default.createElement("div",null,(Array.isArray(t)?t:[]).map(O=>br.default.createElement("span",{key:O,className:Lp.SELECTED_ITEM},O,br.default.createElement("button",{type:"button",onClick:H=>{H.preventDefault(),H.stopPropagation(),!P.current&&L(O)},onMouseDown:H=>{H.preventDefault(),H.stopPropagation(),!P.current&&L(O)},"aria-label":`Remove ${O}`,"data-remove-button":"true",className:Lp.REMOVE_BUTTON},"\xD7")))):null,[i,t,L]),N=br.default.useCallback(()=>{k(!0),i||y("")},[i]),U=br.default.useCallback(O=>{var q,V,J;D.current||P.current||O.relatedTarget&&((V=(q=O.relatedTarget)==null?void 0:q.hasAttribute)!=null&&V.call(q,"data-remove-button"))||(J=w.current)!=null&&J.contains(O.relatedTarget)||setTimeout(()=>{!D.current&&!P.current&&k(!1)},100)},[]),j=br.default.useCallback(O=>{O.preventDefault(),O.stopPropagation(),k(!0),C.current&&C.current.focus()},[]),R=br.default.useCallback(O=>{b&&O.preventDefault()},[b]);return br.default.createElement("div",{ref:w,"data-combobox-type":i?"multi":"single","data-is-open":b?"true":"false",className:Lp.COMBOBOX_CONTAINER,style:{zIndex:b?9999:10}},a&&br.default.createElement("label",{htmlFor:m},a,u&&br.default.createElement("span",{className:"required-indicator"},"*")),W,br.default.createElement("div",{className:Lp.INPUT_CONTAINER},br.default.createElement("input",{ref:C,id:m,type:"text",value:z,onChange:A,onFocus:N,onBlur:U,onMouseDown:R,onClick:j,onKeyDown:$,placeholder:i&&M.length>0?"":o,"aria-expanded":b,"aria-autocomplete":"list","aria-controls":b?g:void 0,"aria-activedescendant":x>=0?`option-${x}`:void 0,"aria-invalid":!!s,"aria-describedby":s?v:l?f:void 0,role:"combobox",className:Lp.INPUT}),b&&(E.length>0||T)&&br.default.createElement("ul",{id:g,role:"listbox","data-dropdown-visible":"true",className:Lp.DROPDOWN},_,B)),s&&br.default.createElement("div",{id:v,role:"alert",className:"errorMessage"},s),!s&&l&&br.default.createElement("div",{id:f},l))};Xs.displayName="ComboBox"});var nI,yX=F(()=>{nI=Y(Q())});var bX=F(()=>{});var Id=F(()=>{Jg();Zv();tI();rI();ET();yX();bX()});var H_,Qg,Rx=F(()=>{H_=Y(Q()),Qg=({title:e,children:t,description:r})=>H_.default.createElement("div",{className:"formSection"},H_.default.createElement("div",{className:"sectionContent"},t))});var lf,xX,cf=F(()=>{lf=(o=>(o.STOCK="stock",o.OPTIONS="options",o.FUTURES="futures",o.FOREX="forex",o.CRYPTO="crypto",o.CFD="cfd",o))(lf||{}),xX={entries:[{time:new Date,price:0,size:0}],exits:[{time:new Date,price:0,size:0}],entryTime:new Date,exitTime:new Date,entryPrice:0,exitPrice:0,positionSize:0,direction:"",instrument:"",assetType:"",setupIds:[],mistakeIds:[],accountIds:[],thesis:"",images:[],customTags:[],tags:[],setup:[],mistake:[],account:[],filePath:"",pnl:0,useDirectPnLInput:!1,directPnL:0,commission:0,commissionType:"fixed",swap:0,fees:0,rebate:void 0,stopLoss:void 0,riskAmount:void 0,rMultiple:void 0,exchange:"",expirationDate:new Date,strikePrice:0,optionType:"call",contractSize:100,contractSymbol:"",dollarPerPoint:0,tickSize:0,tickValue:0,currencyPair:"",lotSize:0,pipValue:0,tradingPair:"",cryptoExchange:"",leverageRatio:0,isMissedTrade:!1,missedReason:"",isBacktestTrade:!1,customFields:{}}});function Xg(e){return e.useDirectPnLInput&&e.directPnL!==void 0&&e.directPnL!==null?e.directPnL:e.pnl||0}function yt(e){if(e.useDirectPnLInput===!0)return!1;let t=e.exits&&e.exits.length>0&&e.exits.some(a=>a.price!==void 0&&a.price!==null&&a.price!==0||a.size!==void 0&&a.size!==null&&a.size!==0),r=e.exitPrice!==void 0&&e.exitPrice!==null&&e.exitPrice!==0;if(e.entries&&e.entries.length>0){if(!t&&!r)return!0;if(e.entries&&e.exits){let a=e.entries.reduce((s,l)=>s+(l.size||0),0);if(e.exits.reduce((s,l)=>s+(l.size||0),0)<a)return!0}}if(e.tradeStatus==="OPEN")return!0;if(e.tradeStatus==="CLOSED")return!1;let i=e.pnl!==null&&e.pnl!==void 0&&(t||r||e.exitTime);return!t&&!r&&!i}function Ml(e,t){var a,o;if(e.isBacktestTrade)return"backtest";if(e.isMissedTrade)return"missed";if(yt(e))return"open";let r=Xg(e),n=(a=t==null?void 0:t.breakEvenRangeMin)!=null?a:0,i=(o=t==null?void 0:t.breakEvenRangeMax)!=null?o:0;return r>i?"win":r<n?"loss":"breakeven"}function iI(e){var d,u,p,m;let t={isPartialExit:!1,closedSize:0,totalSize:0,remainingSize:0,realizedPnL:0,exits:[]};if(!e.entries||e.entries.length===0)return t;let r=0,n=0;for(let g of e.entries){let f=(d=g.size)!=null?d:0,v=(u=g.price)!=null?u:0;f>0&&v>0&&(r+=f,n+=v*f)}if(r===0)return t;let i=n/r;if(!e.exits||e.exits.length===0)return{...t,totalSize:r,remainingSize:r};let a=0,o=0,s=[];for(let g of e.exits){let f=(p=g.size)!=null?p:0,v=(m=g.price)!=null?m:0;if(f<=0)continue;a+=f;let h;e.assetType==="options"&&!e.direction?h=v-i:h=e.direction==="long"?v-i:i-v;let y=h*f;if(e.assetType)switch(e.assetType){case"options":e.contractSize&&(y=h*f*e.contractSize);break;case"futures":e.tickValue&&e.tickSize&&e.tickSize>0?y=h/e.tickSize*e.tickValue*f:e.dollarPerPoint&&(y=h*f*e.dollarPerPoint);break;case"forex":e.lotSize&&e.lotSize>0?y=h*f*e.lotSize:e.pipValue&&e.pipValue>0&&(y=h*1e4*e.pipValue*f);break;case"cfd":y=h*f;break}o+=y,s.push({price:v,size:f,pnl:y})}let l=r-a,c=a>0&&a<r;if(c&&a>0){let g=a/r;if(e.commission!==void 0&&e.commission!==0){let f=e.commissionType==="percentage"?n*(e.commission/100)*g:e.commission*g;e.commission<0?o+=f:o-=f}if(e.swap!==void 0&&(o+=e.swap*g),e.fees!==void 0&&e.fees!==0){let f=e.fees*g;e.fees<0?o+=f:o-=f}e.rebate!==void 0&&e.rebate>0&&(o+=e.rebate*g)}return{isPartialExit:c,closedSize:a,totalSize:r,remainingSize:l,realizedPnL:o,exits:s}}function wX(e){var t,r,n;if(e.entries&&e.entries.length>0){let i=0,a=0;for(let o of e.entries){let s=(t=o.price)!=null?t:0,l=(r=o.size)!=null?r:0;s>0&&l>0&&(i+=s*l,a+=l)}if(a>0)return i/a}return(n=e.entryPrice)!=null?n:null}function kX(e){var t,r,n;if(e.exits&&e.exits.length>0){let i=0,a=0;for(let o of e.exits){let s=(t=o.price)!=null?t:0,l=(r=o.size)!=null?r:0;s>0&&l>0&&(i+=s*l,a+=l)}if(a>0)return i/a}return(n=e.exitPrice)!=null?n:null}function SX(e){if(e.entries&&e.entries.length>0){let t=null;for(let r of e.entries)if(r.time){let n=r.time instanceof Date?r.time:new Date(r.time);(!t||n<t)&&(t=n)}if(t)return t}return e.entryTime?e.entryTime instanceof Date?e.entryTime:new Date(e.entryTime):null}function IT(e){if(e.exits&&e.exits.length>0){let t=null;for(let r of e.exits)if(r.time){let n=r.time instanceof Date?r.time:new Date(r.time);(!t||n>t)&&(t=n)}if(t)return t}return e.exitTime?e.exitTime instanceof Date?e.exitTime:new Date(e.exitTime):null}var Jn=F(()=>{});function q_(){return`custom_field_${Date.now()}_${Math.random().toString(36).substr(2,5)}`}function Zg(e){return e.toLowerCase().trim().replace(/[^a-z0-9\s]/gi,"").replace(/\s+/g,"_").replace(/_{2,}/g,"_").replace(/^_+|_+$/g,"")}function aI(e){return!e||e.trim()===""?"Field key cannot be empty":Ux.has(e)?"This field name conflicts with built-in trade fields":/^[a-z][a-z0-9_]*$/i.test(e)?null:"Field key must start with a letter and contain only letters, numbers, and underscores"}function qx(e,t=[]){let r=Zg(e);(!r||Ux.has(r))&&(r="custom_field");let n=r,i=1;for(;t.includes(n)||Ux.has(n);)n=`${r}_${i}`,i++;return n}function TX(e,t=[]){let r=q_(),n=`New ${e.charAt(0).toUpperCase()+e.slice(1)} Field`,i=qx(n,t);return{id:r,label:n,fieldKey:i,type:e,validation:{},order:Date.now()}}function oI(e,t,r){let{validation:n={},type:i}=t,a=()=>{let o=(t.options||[]).map(s=>s.value);return!r||r.length===0?o:[...new Set([...o,...r])]};if(n.required&&(e==null||e===""))return`${t.label} is required`;if(e==null||e==="")return null;switch(i){case"text":if(typeof e!="string")return`${t.label} must be text`;if(n.minLength&&e.length<n.minLength)return`${t.label} must be at least ${n.minLength} characters`;if(n.maxLength&&e.length>n.maxLength)return`${t.label} must be no more than ${n.maxLength} characters`;if(n.pattern)try{if(!new RegExp(n.pattern).test(e))return`${t.label} format is invalid`}catch(y){return console.warn("[CustomFields] Invalid regex pattern:",n.pattern),`${t.label} has an invalid validation pattern`}break;case"number":let o=Number(e);if(isNaN(o))return`${t.label} must be a number`;if(n.min!==void 0&&o<n.min)return`${t.label} must be at least ${n.min}`;if(n.max!==void 0&&o>n.max)return`${t.label} must be no more than ${n.max}`;break;case"dropdown":if(typeof e!="string")return`${t.label} must be a valid selection`;if(t.allowCreateOptions)break;let s=a();if(s.length>0&&!s.includes(e))return`${t.label} must be a valid option`;break;case"multiselect":if(!Array.isArray(e))return`${t.label} must be an array of selections`;if(t.allowCreateOptions)break;let l=a();if(l.length>0){for(let y of e)if(!l.includes(y))return`${t.label} contains invalid option: ${y}`}break;case"date":case"datetime":let c=new Date(e);if(isNaN(c.getTime()))return`${t.label} must be a valid date`;break;case"time":if(typeof e!="string")return`${t.label} must be a valid time`;let d=e.trim().toLowerCase();if(d==="")return n.required?`${t.label} is required`:null;let u=!1,p="",m=/^([0-1]?[0-9]|2[0-3]):([0-5][0-9])(?::([0-5][0-9]))?$/,g=d.match(m);if(g){u=!0;let y=g[1].padStart(2,"0"),b=g[2],k=g[3]||"00";p=`${y}:${b}:${k}`}else{let y=/^(1[0-2]|0?[1-9]):([0-5][0-9])(?::([0-5][0-9]))?\s*(am|pm)$/,b=d.match(y);if(b){u=!0;let k=parseInt(b[1]),x=b[2],S=b[3]||"00",w=b[4];w==="pm"&&k!==12?k+=12:w==="am"&&k===12&&(k=0),p=`${k.toString().padStart(2,"0")}:${x}:${S}`}}if(!u)return`${t.label} must be a valid time format (HH:MM, HH:MM:SS, or 12-hour with AM/PM)`;let[f,v,h]=p.split(":").map(Number);if(f>23||v>59||h>59)return`${t.label} contains invalid time values`;break}return null}var Hx,ry,Ux,ny=F(()=>{Hx=(s=>(s.TEXT="text",s.NUMBER="number",s.DROPDOWN="dropdown",s.MULTISELECT="multiselect",s.DATE="date",s.DATETIME="datetime",s.TIME="time",s))(Hx||{}),ry={fields:[]},Ux=new Set(["type","entryTime","exitTime","entryPrice","exitPrice","positionSize","direction","tradeStatus","entries","exits","commission","fees","setupIds","mistakeIds","accountIds","instrument","assetType","account","setup","mistake","tags","pnl","useDirectPnLInput","directPnL","lossReview","reviewed","reviewedAt","exchange","optionType","strikePrice","expirationDate","dollarPerPoint","tickSize","tickValue","currencyPair","cryptoPair","cryptoExchange","leverageRatio","backendTradeId","backendAccountId","isMissedTrade","filePath","thesis","images","contractSize","lotSize","pipValue","pricePerShare","dividendPerShare","swap","notes","originalPnl"])});function lI(e){return sI[e]}function CX(){return Object.values(sI).map(e=>({value:e.code,label:`${e.symbol} ${e.name} (${e.code})`}))}function PX(e){return Object.values(Ms).includes(e)}var Ms,sI,As=F(()=>{Ms=(u=>(u.USD="USD",u.EUR="EUR",u.GBP="GBP",u.JPY="JPY",u.CAD="CAD",u.AUD="AUD",u.CHF="CHF",u.CNY="CNY",u.HKD="HKD",u.KWD="KWD",u.NGN="NGN",u))(Ms||{}),sI={USD:{code:"USD",symbol:"$",name:"US Dollar",locale:"en-US",decimalPlaces:2,symbolBefore:!0},EUR:{code:"EUR",symbol:"\u20AC",name:"Euro",locale:"en-IE",decimalPlaces:2,symbolBefore:!0},GBP:{code:"GBP",symbol:"\xA3",name:"British Pound",locale:"en-GB",decimalPlaces:2,symbolBefore:!0},JPY:{code:"JPY",symbol:"\xA5",name:"Japanese Yen",locale:"ja-JP",decimalPlaces:0,symbolBefore:!0},CAD:{code:"CAD",symbol:"C$",name:"Canadian Dollar",locale:"en-CA",decimalPlaces:2,symbolBefore:!0},AUD:{code:"AUD",symbol:"A$",name:"Australian Dollar",locale:"en-AU",decimalPlaces:2,symbolBefore:!0},CHF:{code:"CHF",symbol:"Fr",name:"Swiss Franc",locale:"de-CH",decimalPlaces:2,symbolBefore:!1},CNY:{code:"CNY",symbol:"\xA5",name:"Chinese Yuan",locale:"zh-CN",decimalPlaces:2,symbolBefore:!0},HKD:{code:"HKD",symbol:"HK$",name:"Hong Kong Dollar",locale:"zh-HK",decimalPlaces:2,symbolBefore:!0},KWD:{code:"KWD",symbol:"KD",name:"Kuwaiti Dinar",locale:"en-US",decimalPlaces:3,symbolBefore:!1},NGN:{code:"NGN",symbol:"\u20A6",name:"Nigerian Naira",locale:"en-NG",decimalPlaces:2,symbolBefore:!0}}});function so(e){return e==null||isNaN(e)?"N/A":e.toFixed(1)+"%"}function Uc(e,t="USD"){if(e==null||isNaN(e))return"N/A";let r=lI(t),n=Math.abs(e);if(e===0)return r.symbolBefore?`${r.symbol}0`:`0${r.symbol}`;let i=r.decimalPlaces;if(n===Math.floor(n)||i===0){let o=Math.floor(n).toLocaleString(r.locale);return r.symbolBefore?`${r.symbol}${o}`:`${o}${r.symbol}`}let a=n.toLocaleString(r.locale,{minimumFractionDigits:0,maximumFractionDigits:i});return r.symbolBefore?`${r.symbol}${a}`:`${a}${r.symbol}`}function sa(e,t=!1,r="USD"){if(e==null||isNaN(e))return"N/A";let n=lI(r),i=e<0,a=Math.abs(e),o=t&&e>0?"+":"",s=n.decimalPlaces,l=n.decimalPlaces;n.decimalPlaces>0&&(a===0?(s=0,l=0):a<10?(s=4,l=5):a<100?(s=3,l=4):a>=100&&(a===Math.floor(a)?(s=0,l=0):(s=n.decimalPlaces,l=n.decimalPlaces)));let c=a.toLocaleString(n.locale,{style:"currency",currency:n.code,minimumFractionDigits:s,maximumFractionDigits:l});return i?"-"+c.replace("-",""):o+c}function xt(e,t,r,n){if(t!==void 0&&!isNaN(t))return t;let i=r!=null?r:n;if(e!==void 0&&i!==void 0&&i>0)return e/i}function ye(e,t=!0,r="USD",n,i){if(e===void 0||isNaN(e))return"N/A";if(n===!0){if(i===void 0||isNaN(i))return"N/A";let p=i>=0?"+":"",m=i.toFixed(1);return`${p}${m}R`}let a=lI(r),o=e<0,s=Math.abs(e);if(s>=1e6){let p=s/1e6,m;if(!t||a.decimalPlaces===0)m=Math.round(p)+"M";else{let v=Math.min(a.decimalPlaces,2),h=p.toFixed(v);h.endsWith(".00")?m=h.slice(0,-3)+"M":h.endsWith("0")&&v>1?m=h.slice(0,-1)+"M":m=h+"M"}let g=a.symbolBefore?a.symbol:"",f=a.symbolBefore?"":a.symbol;return o?`-${g}${m}${f}`:`${g}${m}${f}`}if(s>=1e5){let p=s/1e3,m;if(!t||a.decimalPlaces===0)m=Math.round(p)+"K";else{let v=Math.min(a.decimalPlaces,2),h=p.toFixed(v);h.endsWith(".00")?m=h.slice(0,-3)+"K":h.endsWith("0")&&v>1?m=h.slice(0,-1)+"K":m=h+"K"}let g=a.symbolBefore?a.symbol:"",f=a.symbolBefore?"":a.symbol;return o?`-${g}${m}${f}`:`${g}${m}${f}`}let l=s!==Math.floor(s),c;if(!t||a.decimalPlaces===0)c=Math.round(s).toLocaleString(a.locale);else if(l){let p=Math.floor(s).toLocaleString(a.locale),m=(s-Math.floor(s)).toFixed(a.decimalPlaces).substring(1);c=`${p}${m}`}else c=Math.floor(s).toLocaleString(a.locale);let d=a.symbolBefore?a.symbol:"",u=a.symbolBefore?"":a.symbol;return o?`-${d}${c}${u}`:`${d}${c}${u}`}function MT(e){if(e==null||!Number.isFinite(e)||e<0)return"N/A";if(e===0)return"<1s";let t=1e3,r=t*60,n=r*60,i=n*24,a=i*30,o=i*365,s=Math.floor(e/o),l=e%o,c=Math.floor(l/a),d=l%a,u=Math.floor(d/i),p=d%i,m=Math.floor(p/n),g=p%n,f=Math.floor(g/r),v=g%r,h=Math.floor(v/t),y=[];return s>0&&y.push({value:s,label:"y"}),c>0&&y.push({value:c,label:"mo"}),u>0&&y.push({value:u,label:"d"}),m>0&&y.push({value:m,label:"h"}),f>0&&y.push({value:f,label:"m"}),h>0&&y.push({value:h,label:"s"}),y.length===0?"<1s":y.slice(0,2).map(k=>`${k.value}${k.label}`).join(" ")}var qt=F(()=>{As()});function V_(e,t){return t!==void 0&&t>0?e+t:e}var Vx,DX,uc,AT=F(()=>{Jn();cf();Vx=e=>{let t=e.commission||0;if((e.commissionType||"fixed")==="percentage"){let n=0;return e.entries&&e.entries.length>0?n=e.entries.reduce((i,a)=>a.price!==void 0&&a.size!==void 0?i+Math.abs(a.price*a.size):i,0):e.entryPrice!==void 0&&e.positionSize!==void 0?n=Math.abs(e.entryPrice*e.positionSize):e.useDirectPnLInput&&e.directPnL!==void 0&&(n=Math.abs(e.directPnL)),n*t/100}return t},DX=e=>{if(e.entryPrice===void 0||e.exitPrice===void 0||e.positionSize===void 0||!e.direction&&e.assetType!=="options")return 0;let t=0,r;if(e.assetType==="options"&&!e.direction?r=e.exitPrice-e.entryPrice:r=e.direction==="long"?e.exitPrice-e.entryPrice:e.entryPrice-e.exitPrice,t=r*e.positionSize,e.assetType)switch(e.assetType){case"options":e.contractSize&&(t=r*e.positionSize*e.contractSize);break;case"futures":e.dollarPerPoint&&(t=r*e.positionSize*e.dollarPerPoint,e.tickValue&&e.tickSize&&e.tickSize>0&&(t=r/e.tickSize*e.tickValue*e.positionSize));break;case"forex":e.lotSize&&e.lotSize>0?t=r*e.positionSize*e.lotSize:e.pipValue&&e.pipValue>0&&(t=r*1e4*e.pipValue*e.positionSize);break;case"cfd":t=r*e.positionSize;break}if(e.commission!==void 0){let n=Vx(e);e.commission<0?t+=e.commission:t-=n}return e.swap!==void 0&&(t+=e.swap),e.fees!==void 0&&(e.fees<0?t+=e.fees:t-=e.fees),V_(t,e.rebate)},uc=e=>{var s,l;if(yt({tradeStatus:e.tradeStatus,exitTime:e.exitTime,exitPrice:e.exitPrice,pnl:e._originalPnlWasNull?null:e.pnl,useDirectPnLInput:e.useDirectPnLInput,exits:e.exits,entries:e.entries}))return 0;if(e.useDirectPnLInput&&e.directPnL!==void 0){let c=e.directPnL;if(e.commission!==void 0){let d=Vx(e);e.commission<0?c+=d:c-=d}return e.swap!==void 0&&(c+=e.swap),e.fees!==void 0&&(e.fees<0?c+=e.fees:c-=e.fees),V_(c,e.rebate)}let t=(s=e.entries)==null?void 0:s.some(c=>{var d,u;return((d=c.price)!=null?d:0)>0&&((u=c.size)!=null?u:0)>0}),r=(l=e.exits)==null?void 0:l.some(c=>{var d;return c.price!==null&&c.price!==void 0&&((d=c.size)!=null?d:0)>0});if(!t||!r||!e.direction&&e.assetType!=="options")return DX(e);let n=0,i=0,a=0,o=0;if(e.entries&&(e.entries.forEach(c=>{c.price===void 0||c.size===void 0||(a+=c.price*c.size,o+=c.size)}),o>0&&(i=a/o)),i===0)return DX(e);if(e.exits&&e.entries&&e.exits.forEach(c=>{if(c.price===void 0||c.size===void 0||i===0)return;let d=0,u;if(e.assetType==="options"&&!e.direction?u=c.price-i:u=e.direction==="long"?c.price-i:i-c.price,d=u*c.size,e.assetType)switch(e.assetType){case"options":e.contractSize&&(d=u*c.size*e.contractSize);break;case"futures":e.dollarPerPoint&&(d=u*c.size*e.dollarPerPoint,e.tickValue&&e.tickSize&&e.tickSize>0&&(d=u/e.tickSize*e.tickValue*c.size));break;case"forex":e.lotSize&&e.lotSize>0?d=u*c.size*e.lotSize:e.pipValue&&e.pipValue>0&&(d=u*1e4*e.pipValue*c.size);break;case"cfd":d=u*c.size;break}n+=d}),e.commission!==void 0){let c=Vx(e);e.commission<0?n+=e.commission:n-=c}return e.swap!==void 0&&(n+=e.swap),e.fees!==void 0&&(e.fees<0?n+=e.fees:n-=e.fees),V_(n,e.rebate)}});var G_,Y_,cI,K_,EX,IX,LT,iy=F(()=>{cf();Jn();ny();_t();qt();AT();G_=e=>{let t={},r=e.useDirectPnLInput===!0,n=e.isMissedTrade===!0,i=yt({tradeStatus:e.tradeStatus,exitTime:e.exitTime,pnl:null,useDirectPnLInput:e.useDirectPnLInput,exits:e.exits,entries:e.entries});if(n&&!r){let s=e.exitPrice!==void 0&&e.exitPrice!==null&&e.exitPrice!==0,l=e.exits&&e.exits.length>0&&e.exits.some(c=>c.price!==void 0&&c.price!==null&&c.price!==0||c.size!==void 0&&c.size!==null&&c.size!==0);if(!s&&!l)return t.form="Missed trades must have exit data with non-zero prices. They represent opportunities that have already passed, so you must specify what the exit price would have been.",t}if(e.isBacktestTrade,!r&&!n)if(!e.entries||e.entries.length===0)t.entriesExits="At least one entry is required.";else{let s=[],l=!1;e.entries.forEach((c,d)=>{let u={};c.time||(u.time="Entry time is required.",l=!0),(c.price===void 0||c.price===null)&&(u.price="Entry price is required.",l=!0),(c.size===void 0||c.size===null||c.size<=0)&&(u.size="Entry size must be greater than zero.",l=!0),s[d]=u}),l&&(t.entries=s)}if(!r&&!n)if(!e.exits||e.exits.length===0)i||(t.entriesExits?t.entriesExits+=" At least one exit is required for closed trades.":t.entriesExits="At least one exit is required for closed trades.");else{let s=e.exits.filter(c=>(c.price===void 0||c.price===null||c.price===0)&&(c.size===void 0||c.size===null||c.size===0));if(!(e.exits.filter(c=>c.price!==void 0&&c.price!==null&&c.price!==0||c.size!==void 0&&c.size!==null&&c.size!==0).length===0&&i)){let c=[],d=!1;e.exits.forEach((u,p)=>{if((u.price===void 0||u.price===null||u.price===0)&&(u.size===void 0||u.size===null||u.size===0)&&i){c[p]={};return}let g={};u.time||(g.time="Exit time is required.",d=!0),(u.price===void 0||u.price===null)&&(g.price="Exit price is required.",d=!0),(u.size===void 0||u.size===null||u.size<=0)&&(g.size="Exit size must be greater than zero.",d=!0),c[p]=g}),d&&(t.exits=c)}}if(!r&&!n&&e.entries&&e.entries.length>0&&e.exits&&e.exits.length>0){let s=e.exits.filter(l=>l.price!==void 0&&l.price!==null&&l.price!==0&&l.size!==void 0&&l.size!==null&&l.size!==0);if(!(s.length===0&&i)){let l=e.entries.reduce((u,p)=>u+(p.size||0),0);s.reduce((u,p)=>u+(p.size||0),0)>l&&(t.entriesExits?t.entriesExits+=" Total exit size cannot exceed total entry size.":t.entriesExits="Total exit size cannot exceed total entry size.");let d=e.entries&&e.entries.length>0?Zi(e.entries[0].time):null;d&&s.some(u=>{let p=Zi(u.time);return p&&p<d})&&(t.entriesExits?t.entriesExits+=" Exits cannot occur before the first entry.":t.entriesExits="Exits cannot occur before the first entry.")}}r&&!n&&(e.directPnL===void 0||e.directPnL===null)&&(t.directPnL="Please enter a profit/loss value.");let a=e.entries&&e.entries.length>0&&e.entries.some(s=>s.time&&s.price!==void 0&&s.size!==void 0);if(!e.entryTime&&(r||!a)&&(t.entryTime="Please select an entry time."),!e.direction&&e.assetType!=="options"&&(t.direction="Please select a direction."),e.assetType||(t.assetType="Please select an asset type."),e.instrument?/^[A-Z0-9.]+$/i.test(e.instrument)||(t.instrument="Enter a valid ticker symbol (letters, numbers & periods only)."):t.instrument="Please select a Ticker.",!n&&(!e.accountIds||e.accountIds.length===0)&&(!e.account||e.account.length===0)&&(t.accountIds="Please select at least one account."),(e.entryPrice!==void 0&&e.entryPrice!==null||e.exitPrice!==void 0&&e.exitPrice!==null||e.positionSize!==void 0&&e.positionSize!==null)&&!r&&!n){!i&&!e.exitTime&&(t.exitTime="Please select an exit time."),(e.entryPrice===void 0||e.entryPrice===null||e.entryPrice<=0)&&(t.entryPrice="Please enter a valid entry price."),!i&&(e.exitPrice===void 0||e.exitPrice===null||e.exitPrice<=0)&&(t.exitPrice="Please enter a valid exit price."),(e.positionSize===void 0||e.positionSize===null||e.positionSize<=0)&&(t.positionSize="Please enter a valid position size.");let s=Zi(e.entryTime),l=Zi(e.exitTime);s&&l&&l<s&&(t.exitTime="Exit time must be after entry time.")}if(e.assetType)switch(e.assetType){case"stock":break;case"options":e.expirationDate||(t.expirationDate="Please select an expiration date."),e.strikePrice||(t.strikePrice="Please enter a strike price."),e.optionType||(t.optionType="Please select an option type (call or put)."),e.contractSize!==void 0&&e.contractSize<=0&&(t.contractSize="Contract size must be greater than zero.");break;case"futures":(e.dollarPerPoint===void 0||e.dollarPerPoint<.01)&&(t.dollarPerPoint="Please enter Dollars per point (min 0.01).");break;case"forex":e.lotSize!==void 0&&e.lotSize<0&&(t.lotSize="Lot size cannot be negative.");break;case"crypto":break;case"cfd":e.leverageRatio!==void 0&&e.leverageRatio<=0&&(t.leverageRatio="Leverage ratio must be greater than zero.");break}if(e.commissionType!==void 0&&e.commissionType!==null&&e.commissionType!=="fixed"&&e.commissionType!=="percentage"&&(t.commissionType='Commission type must be either "fixed" or "percentage".'),e.commission!==void 0&&e.commission!==null)if(typeof e.commission!="number")t.commission="Commission must be a number.";else{let s=e.commissionType||"fixed";s==="fixed"||s==="percentage"&&(e.commission<0||e.commission>100)&&(t.commission="Percentage commission must be between 0 and 100.")}return e.rebate!==void 0&&e.rebate!==null&&(e.assetType!=="options"?t.rebate="Rebate is only allowed for options trades.":typeof e.rebate!="number"?t.rebate="Rebate must be a number.":e.rebate<0&&(t.rebate="Rebate must be a positive value.")),e.swap!==void 0&&e.swap!==null&&typeof e.swap!="number"&&(t.swap="Invalid swap amount."),e.fees!==void 0&&e.fees!==null&&typeof e.fees!="number"&&(t.fees="Fees must be a number."),e.riskAmount!==void 0&&e.riskAmount!==null&&(typeof e.riskAmount!="number"?t.riskAmount="Risk amount must be a number.":Number.isFinite(e.riskAmount)?e.riskAmount<=0&&(t.riskAmount="Risk amount must be greater than zero."):t.riskAmount="Risk amount must be a valid number."),e.stopLoss!==void 0&&e.stopLoss!==null&&(typeof e.stopLoss!="number"?t.stopLoss="Stop loss must be a number.":Number.isFinite(e.stopLoss)||(t.stopLoss="Stop loss must be a valid number.")),t},Y_=(e,t,r)=>{let n={};return!e||!t||t.length===0||t.forEach(i=>{let a=e[i.id],o=r?r.getFieldOptions(i.id):void 0,s=oI(a,i,o);s&&(n[i.id]=s)}),n},cI=e=>Object.keys(e).length>0,K_=e=>{if(yt({tradeStatus:e.tradeStatus,exitTime:e.exitTime,pnl:e._originalPnlWasNull?null:e.pnl,useDirectPnLInput:e.useDirectPnLInput,exits:e.exits,entries:e.entries}))return 0;let t=uc(e),r=0;if(e.stopLoss!==void 0)if(e.entries&&e.entries.length>0){let n=0,i=0;if(e.entries.forEach(a=>{a.price!==void 0&&a.size!==void 0&&(n+=a.price*a.size,i+=a.size)}),i>0){let a=n/i;r=Math.abs(a-e.stopLoss)*i}}else e.entryPrice!==void 0&&e.positionSize!==void 0&&(r=Math.abs(e.entryPrice-e.stopLoss)*e.positionSize);return r===0&&typeof e.riskAmount=="number"&&Number.isFinite(e.riskAmount)&&e.riskAmount>0&&(r=e.riskAmount),r===0?0:t/r},EX=e=>{if(yt({tradeStatus:e.tradeStatus,exitTime:e.exitTime,pnl:e.pnl,useDirectPnLInput:e.useDirectPnLInput,exits:e.exits,entries:e.entries})||e.useDirectPnLInput||e.entryPrice===void 0||e.exitPrice===void 0||e.entryPrice===0||!e.direction&&e.assetType!=="options")return 0;let t;e.assetType==="options"&&!e.direction?t=e.exitPrice-e.entryPrice:t=e.direction==="long"?e.exitPrice-e.entryPrice:e.entryPrice-e.exitPrice;let r=t/e.entryPrice*100;return e.assetType==="cfd"&&e.leverageRatio&&e.leverageRatio>0&&(r=r*e.leverageRatio),r},IX=(e,t,r)=>{let n=[];if(e.commission&&e.commission>0){let o=Vx(e),s=e.commissionType||"fixed",l;t===!0&&r&&r>0?l=`${(o/r).toFixed(2)}R`:l=Uc(o);let c=s==="percentage"?`Commission (${e.commission}%): ${l}`:`Commission: ${l}`;n.push(c)}if(e.swap!==void 0&&e.swap!==null&&e.swap!==0){let o=e.swap>0?"Swap Cost":"Swap Credit",s=Math.abs(e.swap),l;t===!0&&r&&r>0?l=`${(s/r).toFixed(2)}R`:l=Uc(s),n.push(`${o}: ${l}`)}if(e.fees&&e.fees>0){let o;t===!0&&r&&r>0?o=`${(e.fees/r).toFixed(2)}R`:o=Uc(e.fees),n.push(`Fees: ${o}`)}let i=[];if(e.rebate&&e.rebate>0){let o;t===!0&&r&&r>0?o=`${(e.rebate/r).toFixed(2)}R`:o=Uc(e.rebate),i.push(`Rebate: ${o}`)}let a=n.length>0?n.join(", "):"No costs";return i.length>0?`${a} | ${i.join(", ")}`:a},LT=e=>{let t=Vx(e),r=e.swap||0,n=e.fees||0;return t+r+n}});var MX,xIe,wIe,kIe,Md,SIe,Al,J_,NT,Np,FT,ay,OT,Hc,zT,Ll=F(()=>{qt();_t();Jn();MX=45,xIe=90,wIe=7,kIe=12,Md=(e,t)=>{if(!e||e.length===0)return MX;let n=Math.max(...e.map(i=>{let a=t(i);return a?a.length:0}))*wIe+kIe;return Math.max(MX,Math.min(xIe,n))},SIe=(e,t,r=.5)=>{if(e<=0||t<=0)return 1;let n=e/t,i=Math.pow(10,Math.floor(Math.log10(n)));if(isNaN(i)||i<=0)return n;let a=[1,2,2.5,5,10].map(c=>c*i),o=a[a.length-1],s=1/0,l=1/0;for(let c of a){let d=Math.ceil(e/c),p=d*c-e;if(p/e>r||d>t*2)continue;let g=Math.abs(d-t);(g<s||g===s&&p<l)&&(o=c,s=g,l=p)}return o},Al=(e,t,r=5,n=!1,i=!1)=>{if(!Number.isFinite(e)||!Number.isFinite(t))return{domain:[0,1],ticks:[0,1],step:1};if(n&&(e=Math.min(0,e),t=Math.max(0,t)),e===t){let m=e;if(m===0)return{domain:[-1,1],ticks:[-1,0,1],step:1};let f=Math.pow(10,Math.floor(Math.log10(Math.abs(m)))),v=Math.floor(m/f)*f-f,h=Math.ceil(m/f)*f+f,y=[];for(let b=v;b<=h+f*1e-4;b+=f)y.push(Math.round(b*1e10)/1e10);return{domain:[v,h],ticks:y,step:f}}if(e>t&&([e,t]=[t,e]),i&&e<0&&t>0){let m=Math.abs(e),g=t,f=m+g,v=SIe(f,r-1),h=-Math.ceil(m/v)*v,y=Math.ceil(g/v)*v,b=[];for(let k=h;k<-1e-4;k+=v){let x=Math.round(k*1e10)/1e10;b.push(x)}b.push(0);for(let k=v;k<=y+v*1e-4;k+=v){let x=Math.round(k*1e10)/1e10;b.push(x)}return{domain:[h,y],ticks:b,step:v}}let a=t-e,o=a/(r-1);if(isNaN(o)||o<=0)return{domain:[e,t],ticks:[e,t],step:a};let s=Math.pow(10,Math.floor(Math.log10(o)));if(isNaN(s)||s<=0)return{domain:[e,t],ticks:[e,t],step:a};let l=o/s,c;l<1.5?c=s:l<3.5?c=2*s:l<7.5?c=5*s:c=10*s;let d=Math.floor(e/c)*c,u=Math.ceil(t/c)*c;e<0&&t>0&&(d>0&&(d=0),u<0&&(u=0));let p=[];for(let m=d;m<=u+c*1e-4;m+=c){let g=Math.round(m*1e10)/1e10;p.push(g)}return e<=0&&t>=0&&!p.includes(0)&&(p.push(0),p.sort((m,g)=>m-g)),{domain:[d,u],ticks:p,step:c}},J_=e=>e===0?"0.00%":"-"+Math.abs(e).toFixed(2)+"%",NT=new Map,Np=(e,t,r)=>{var f,v;if(!e||!Array.isArray(e)){let h=new Date;return[{date:zt(h,t),dateKey:`pnl-${h.getTime()}-0`,pnl:0,tradePnL:0}]}let n=e.filter((h,y)=>!yt({tradeStatus:h.tradeStatus,exitTime:h.exitTime,pnl:h._originalPnlWasNull?null:h.pnl,useDirectPnLInput:h.useDirectPnLInput,exits:h.exits,entries:h.entries})),i=n.length>0?`${((f=n[0])==null?void 0:f.path)||""}:${((v=n[n.length-1])==null?void 0:v.path)||""}:${n.map(h=>Array.isArray(h.account)?h.account.join(","):h.account||"").join(",")}`:"empty",a=`pnl:${n.length}:${t}:${i}:${r!=null?r:"none"}`,o=NT.get(a);if(o)return o;let s=[...n].sort((h,y)=>Rc(h.entryTime,y.entryTime)),l=0,c=0,d=[],u=[],p=0,m=(h,y)=>{let k=`pnl-${h!=null?h:y}-${p}`;return p+=1,k};if(s.length>0){let h=new Date(s[0].entryTime),y=Zi(s[0].entryTime);u.push(h),d.push({date:"",dateKey:m(y,"initial"),pnl:0,tradePnL:0,cumulativeR:0,tradeR:0})}else{let h=new Date;u.push(h),d.push({date:zt(h,t),dateKey:m(null,"empty"),pnl:0,tradePnL:0,cumulativeR:0,tradeR:0})}s.forEach(h=>{var S;let y=(S=h.pnl)!=null?S:0;isNaN(y)&&(y=0),l+=y,isNaN(l)&&(l=0);let b=xt(y,h.rMultiple,h.riskAmount,r),k=b!=null?b:0;isNaN(k)&&(k=0),c+=k,isNaN(c)&&(c=0);let x=h.entryTime?new Date(h.entryTime):null;u.push(x),d.push({date:"",dateKey:m(Zi(h.entryTime),"trade"),pnl:l,tradePnL:y,cumulativeR:c,tradeR:k})});let g=PT(u,t);if(d=d.map((h,y)=>{var b;return{...h,date:(b=g[y])!=null?b:zt(u[y],t)}}),NT.set(a,d),NT.size>50){let h=NT.keys().next().value;NT.delete(h)}return d},FT=new Map,ay=(e,t,r)=>{var v,h;if(!e||!Array.isArray(e)){let y=new Date;return[{date:zt(y,t),dateKey:`drawdown-${y.getTime()}-0`,drawdown:0,pnl:0,cumPnL:0,peakEquity:0,rMultiple:0,cumulativeR:0}]}let n=e.filter((y,b)=>!yt({tradeStatus:y.tradeStatus,exitTime:y.exitTime,pnl:y._originalPnlWasNull?null:y.pnl,useDirectPnLInput:y.useDirectPnLInput,exits:y.exits,entries:y.entries})),i=n.length>0?`${((v=n[0])==null?void 0:v.path)||""}:${((h=n[n.length-1])==null?void 0:h.path)||""}:${n.map(y=>Array.isArray(y.account)?y.account.join(","):y.account||"").join(",")}`:"empty",a=`drawdown:${n.length}:${t}:${i}:${r!=null?r:"none"}`,o=FT.get(a);if(o)return o;let s=[...n].sort((y,b)=>Rc(y.entryTime,b.entryTime)),l=0,c=0,d=0,u=[],p=[],m=0,g=(y,b)=>{let x=`drawdown-${y!=null?y:b}-${m}`;return m+=1,x};if(s.length>0){let y=new Date(s[0].entryTime);p.push(y),u.push({date:"",dateKey:g(Zi(s[0].entryTime),"initial"),drawdown:0,pnl:0,cumPnL:0,peakEquity:0,rMultiple:0,cumulativeR:0})}else{let y=new Date;p.push(y),u.push({date:zt(y,t),dateKey:g(null,"empty"),drawdown:0,pnl:0,cumPnL:0,peakEquity:0,rMultiple:0,cumulativeR:0})}s.forEach(y=>{var C;let b=(C=y.pnl)!=null?C:0;isNaN(b)&&(b=0),l+=b,isNaN(l)&&(l=0);let k=xt(b,y.rMultiple,y.riskAmount,r),x=k!=null?k:0;isNaN(x)&&(x=0),c+=x,isNaN(c)&&(c=0),l>d&&(d=l);let S=0;if(d>0){let D=-((d-l)/d)*100;S=isNaN(D)?0:D}else if(l<0){let D=s.filter(P=>P.pnl!=null&&!isNaN(P.pnl)&&P.pnl!==0);if(D.length>0){let P=Math.min(...D.map(z=>z.pnl)),M=Math.abs(P)*10;if(M>0){let z=-(Math.abs(l)/M)*100;S=isNaN(z)?0:z}}}let w=y.entryTime?new Date(y.entryTime):null;p.push(w),u.push({date:"",dateKey:g(Zi(y.entryTime),"trade"),drawdown:S,pnl:b,cumPnL:l,peakEquity:d,rMultiple:x,cumulativeR:c})});let f=PT(p,t);if(u=u.map((y,b)=>{var k;return{...y,date:(k=f[b])!=null?k:zt(p[b],t)}}),FT.set(a,u),FT.size>50){let y=FT.keys().next().value;FT.delete(y)}return u},OT=(e,t)=>[...e.filter((a,o)=>!yt({tradeStatus:a.tradeStatus,exitTime:a.exitTime,pnl:a._originalPnlWasNull?null:a.pnl,useDirectPnLInput:a.useDirectPnLInput,exits:a.exits,entries:a.entries}))].sort((a,o)=>Rc(a.entryTime,o.entryTime)).map((a,o)=>{var d;let s=(d=a.pnl)!=null?d:0;isNaN(s)&&(s=0);let l=s>=0,c=xt(s,a.rMultiple,a.riskAmount,t);return{tradeIndex:o+1,pnl:s,fill:l?"var(--chart-positive)":"var(--chart-negative)",instrument:a.instrument,direction:a.direction,entryTime:a.entryTime,exitTime:a.exitTime,path:a.path,rMultiple:c}}),Hc={container:"journalit-chart-tooltip",date:"journalit-chart-tooltip-date",value:"journalit-chart-tooltip-value",info:"journalit-chart-tooltip-info",positive:"positive",negative:"negative"},zT=(e,t,r,n,i)=>{switch(t){case"pnl":return ye(e,!0,r,n,i);case"drawdown":return J_(e);default:return e.toFixed(2)}}});function AX(e){try{let t=[];return JSON.stringify(e,(r,n)=>{if(typeof n=="object"&&n!==null){if(t.includes(n))return"[Circular Reference]";t.push(n)}return n},2)}catch(t){return console.error("safeStringify error:",t),`[Error serializing object: ${t instanceof Error?t.message:String(t)}]`}}function Q_(e,t=["plugin","app"]){let r={};return Object.entries(e).forEach(([n,i])=>{i!==null&&typeof i!="function"&&!(i instanceof Node)&&!t.includes(n)&&(typeof i=="object"&&!Array.isArray(i)?r[n]=Q_(i,t):r[n]=i)}),r}function LX(e,t){try{let r={...e},n={...t};return{...r,...n}}catch(r){return console.error("Error in safeUpdateObject:",r),{...e,...t}}}var dI=F(()=>{});function jT(e,t,r){let n=null,i=null,a=0,o=null,s=null,l,{leading:c=!1,trailing:d=!0,maxWait:u}=r||{};function p(S){let w=o,C=s;return o=s=null,a=S,l=e.apply(C,w),l}function m(S){return a=S,n=setTimeout(v,t),c?p(S):l}function g(S){let w=S-(i||0),C=S-a,D=t-w;return u!==void 0?Math.min(D,u-C):D}function f(S){let w=S-(i||0),C=S-a;return i===null||w>=t||w<0||u!==void 0&&C>=u}function v(){let S=Date.now();if(f(S))return h(S);n=setTimeout(v,g(S))}function h(S){return n=null,d&&o?p(S):(o=s=null,l)}function y(){n!==null&&clearTimeout(n),a=0,o=i=s=n=null}function b(){return n===null?l:h(Date.now())}function k(){return n!==null}function x(...S){let w=Date.now(),C=f(w);if(o=S,s=this,i=w,C){if(n===null)return m(i);if(u!==void 0)return n=setTimeout(v,t),p(i)}return n===null&&(n=setTimeout(v,t)),l}return x.cancel=y,x.flush=b,x.pending=k,x}function oy(e,t){let r=null,n=null,i=null,a=null;function o(){r!==null&&(clearTimeout(r),r=null),i&&(i(void 0),i=a=null,n=null)}async function s(){if(r!==null&&(clearTimeout(r),r=null,n))try{let u=await e.apply(c,l);return i&&i(u),u}catch(u){throw a&&a(u),u}}let l=null,c=null,d=function(...u){return l=u,c=this,o(),n=new Promise((p,m)=>{i=p,a=m,r=setTimeout(async()=>{try{let g=await e.apply(c,l);p(g)}catch(g){m(g)}finally{r=null,n=null,i=a=null}},t)}),n};return d.cancel=o,d.flush=s,d}var sy=F(()=>{});function Gx(){if(document.head.querySelector("#dropdown-fix-script"))return;let e=document.createElement("script");e.id="dropdown-fix-script",e.textContent=TIe,document.head.appendChild(e)}function uI(){let e=document.head.querySelector("#dropdown-fix-script");e&&e.remove()}var TIe,NX=F(()=>{TIe=`
  // Global event handler to forcibly close dropdowns when clicking outside
  (function() {
    // Only add this handler once
    if (window.__dropdownClickHandlerAdded) return;
    
    // Mark this handler as added to prevent multiple instances
    window.__dropdownClickHandlerAdded = true;
    
    // Initialize the remove handling flag
    window.__isHandlingComboBoxRemove = false;
    
    // Add capture phase handler to catch clicks early
    document.addEventListener('mousedown', function(event) {
      // Skip if event is already being handled
      if (window.__isHandlingComboBoxRemove) return;
      
      // Mark as handling to prevent recursive handling
      window.__isHandlingComboBoxRemove = true;
      
      try {
        // Find all open comboboxes/dropdowns
        const openDropdowns = document.querySelectorAll('[data-is-open="true"], [data-combobox-type][aria-expanded="true"]');
        
        if (openDropdowns.length > 0) {
          let shouldClose = true;
          
          // Check if the click was inside any dropdown
          for (const dropdown of openDropdowns) {
            if (dropdown.contains(event.target)) {
              shouldClose = false;
              break;
            }
          }
          
          // If clicked outside, close all dropdowns by triggering blur on their inputs
          if (shouldClose) {
            openDropdowns.forEach(dropdown => {
              const input = dropdown.querySelector('input[role="combobox"]');
              if (input) {
                // Trigger blur to close the dropdown
                input.blur();
                
                // Additional attribute cleanup to ensure closure
                dropdown.setAttribute('data-is-open', 'false');
                if (input.hasAttribute('aria-expanded')) {
                  input.setAttribute('aria-expanded', 'false');
                }
              }
            });
          }
        }
      } catch (err) {
        console.error('Error in dropdown click handler:', err);
      } finally {
        // Release handling flag
        window.__isHandlingComboBoxRemove = false;
      }
    }, true);
  })();
`});function X_(e){let{message:t,error:r,component:n="unknown",operation:i="unknown",data:a,severity:o="error"}=e,s=r instanceof Error?r:new Error(t),l=o==="info"?console.info:o==="warning"?console.warn:console.error,c={error:s,operation:i,component:n};return a&&(c.data=typeof a=="object"?AX(a):a),l(`[${o.toUpperCase()}] [${n}] ${t}`,c),s}function FX(e,t){return(r,n)=>X_({message:n||`Error in ${t}`,error:r,component:e,operation:t,severity:"error"})}var Z_=F(()=>{dI()});function Hi(){let e=window.app;if(!e)throw new Error("Could not access Obsidian app instance");return e}var _T=F(()=>{});var OX={};Ti(OX,{forceMetadataCacheRefresh:()=>yn});async function yn(e,t,r=100){e.metadataCache.getCache(t.path)&&delete e.metadataCache.metadataCache[t.path],await e.vault.cachedRead(t),e.metadataCache.trigger("resolve",t),await new Promise(i=>setTimeout(i,r)),e.metadataCache.trigger("changed",t)}var Nl=F(()=>{});function tn(e,t,r){return e==null?0:!r||t<=1?e:e*t}function rn(e){return e.account&&Array.isArray(e.account)?Math.max(e.account.length,1):1}var Vo=F(()=>{});function eB(e){if(!e)return"";let t=e.trim();for(;t.startsWith('"')||t.startsWith("'");)t=t.slice(1).trim();for(;t.endsWith('"')||t.endsWith("'");)t=t.slice(0,-1).trim();if(t.includes("/")){let r=t.split("/");t=r[r.length-1].trim()}return t}function tB(e,t){return eB(e).toLowerCase()===eB(t).toLowerCase()}function Na(e){if(!Array.isArray(e))return[];let t=new Map;for(let r of e){if(!r)continue;let n=eB(r);if(!n)continue;let i=n.toLowerCase();t.has(i)||t.set(i,n)}return Array.from(t.values())}var rB=F(()=>{});var eh=F(()=>{Ll();dI();_t();sy();NX();Z_();qt();_T();Nl();Vo();rB()});var Fp,th,xe,Op=F(()=>{Fp=class Fp{constructor(){this.listeners=new Map}static getInstance(){return Fp.instance||(Fp.instance=new Fp),Fp.instance}static resetInstance(){Fp.instance&&(Fp.instance.cleanup(),Fp.instance=null)}subscribe(t,r){this.listeners.has(t)||this.listeners.set(t,new Set);let n=this.listeners.get(t);return n.add(r),()=>{n.delete(r),n.size===0&&this.listeners.delete(t)}}publish(t,...r){let n=r[0],i=this.listeners.get(t);if(i)for(let a of i)try{n!==void 0?a(n):a()}catch(o){console.error(`Error in EventBus callback for ${t}:`,o)}}getSubscriberCount(t){var r,n;return(n=(r=this.listeners.get(t))==null?void 0:r.size)!=null?n:0}getRegisteredEvents(){return Array.from(this.listeners.keys())}cleanup(){this.listeners.clear()}};Fp.instance=null;th=Fp,xe=th.getInstance()});function Xe(e,t,r=!0){let n=(0,df.useRef)(t);(0,df.useEffect)(()=>{n.current=t},[t]),(0,df.useEffect)(()=>{if(!r)return;let i=(o=>{o!==void 0?n.current(o):n.current()});return xe.subscribe(e,i)},[e,r])}function pI(e,t,r=!0){let n=(0,df.useRef)(t);(0,df.useEffect)(()=>{n.current=t},[t]),(0,df.useEffect)(()=>{if(!r)return;let i=[];for(let a of e){let o=(()=>{n.current()});i.push(xe.subscribe(a,o))}return()=>{for(let a of i)a()}},[e.join(","),r])}var df,Zs=F(()=>{df=Y(Q());Tr()});var Tr=F(()=>{Op();Zs()});var Fa,ju,mI,Go,ds=F(()=>{Nl();rB();Tr();Fa=(s=>(s.INSTRUMENT="instrument",s.ACCOUNT="account",s.ACCOUNT_TYPE="account_type",s.SETUP="setup",s.MISTAKE="mistake",s.TAG="tag",s.EVENT="event",s))(Fa||{}),ju={instrument:[],account:[],account_type:[],setup:[],mistake:[],tag:[],event:[]},mI={instrument:[{name:"AAPL",assetType:"stock"},{name:"MSFT",assetType:"stock"},{name:"TSLA",assetType:"stock"},{name:"ES1",assetType:"futures",futuresData:{dollarPerPoint:50,tickSize:.25,tickValue:12.5}},{name:"NQ1",assetType:"futures",futuresData:{dollarPerPoint:20,tickSize:.25,tickValue:5}},{name:"EURUSD",assetType:"forex"}],account:[],account_type:["Demo","Evaluation","Funded","Archived"],setup:["Breakout Setup","Reversal Pattern"],mistake:["Early Entry","Poor Position Sizing"],tag:["Swing Trade","Day Trade","Momentum","Reversal","Earnings"],event:[{name:"FOMC Meeting",color:"gray"},{name:"Earnings Announcement",color:"gray"},{name:"Economic Data Release",color:"gray"},{name:"Fed Speech",color:"gray"},{name:"Market Holiday",color:"gray"}]},Go=class{constructor(t,r){this.options={...ju};this.namespace="";this.plugin=t,r!=null&&r.namespace&&(this.namespace=r.namespace),this.loadOptions(),this.initializeDefaultOptionsIfNeeded(),this.cleanupCorruptedOptions().catch(n=>{console.error("CustomOptionsService: Failed to cleanup corrupted options:",n)})}getOptionsKey(){return this.namespace?`customOptions_${this.namespace}`:"customOptions"}async loadOptions(){try{let t=this.getOptionsKey(),r=this.plugin;if(r.settings&&r.settings[t]){let n={...ju,...r.settings[t]};Array.isArray(n.instrument)&&(typeof n.instrument[0]=="string"?this.options.instrument=n.instrument.map(a=>({name:a,assetType:"stock"})):this.options.instrument=n.instrument),this.options.account=Na(n.account||[]),this.options.account_type=Na(n.account_type||[]),this.options.setup=Na(n.setup||[]),this.options.mistake=Na(n.mistake||[]),this.options.tag=Na(n.tag||[]),Array.isArray(n.event)?this.options.event=n.event.map(i=>typeof i=="string"?{name:i,color:"gray"}:typeof i=="object"&&i!==null&&i.name?{name:i.name,color:i.color||"gray"}:null).filter(Boolean):this.options.event=[]}else if(!this.namespace&&r.settings&&r.settings.customOptions){let n={...ju,...r.settings.customOptions};Array.isArray(n.instrument)&&(typeof n.instrument[0]=="string"?this.options.instrument=n.instrument.map(a=>({name:a,assetType:"stock"})):this.options.instrument=n.instrument),this.options.account=Na(n.account||[]),this.options.account_type=Na(n.account_type||[]),this.options.setup=Na(n.setup||[]),this.options.mistake=Na(n.mistake||[]),this.options.tag=Na(n.tag||[]),Array.isArray(n.event)?this.options.event=n.event.map(i=>typeof i=="string"?{name:i,color:"gray"}:typeof i=="object"&&i!==null&&i.name?{name:i.name,color:i.color||"gray"}:null).filter(Boolean):this.options.event=[]}else{let n=await this.plugin.loadData(),i=this.namespace?`customOptions_${this.namespace}`:"customOptions";if(n&&n[i]){let a={...ju,...n[i]};Array.isArray(a.instrument)&&(typeof a.instrument[0]=="string"?this.options.instrument=a.instrument.map(s=>({name:s,assetType:"stock"})):this.options.instrument=a.instrument),this.options.account=Na(a.account||[]),this.options.account_type=Na(a.account_type||[]),this.options.setup=Na(a.setup||[]),this.options.mistake=Na(a.mistake||[]),this.options.tag=Na(a.tag||[]),this.options.event=a.event,r.settings&&(r.settings[t]={...this.options},await r.saveSettings())}else if(!this.namespace&&n&&n.customOptions){let a={...ju,...n.customOptions};Array.isArray(a.instrument)&&(typeof a.instrument[0]=="string"?this.options.instrument=a.instrument.map(s=>({name:s,assetType:"stock"})):this.options.instrument=a.instrument),this.options.account=Na(a.account||[]),this.options.account_type=Na(a.account_type||[]),this.options.setup=Na(a.setup||[]),this.options.mistake=Na(a.mistake||[]),this.options.tag=Na(a.tag||[]),this.options.event=a.event,r.settings&&(r.settings[t]={...this.options},await r.saveSettings())}else this.options={...ju},this.initializeDefaultOptionsIfNeeded(),r.settings&&(r.settings[t]={...this.options},await r.saveSettings())}}catch(t){console.error("Failed to load custom options:",t),this.options={...ju}}}async cleanupCorruptedOptions(){let t=0,r=["tag","mistake","setup","account","account_type"];for(let n of r){if(n==="event"||n==="instrument")continue;let i=this.options[n],a=i.length,o=Na(i);this.options[n]=o,t+=a-o.length}return t>0&&(console.log(`CustomOptionsService: Cleaned ${t} corrupted option entries`),await this.saveOptions()),t}async saveOptions(){try{let t=this.getOptionsKey(),r=this.plugin;if(r.settings)r.settings[t]={...this.options},await r.saveSettings();else{console.warn(`Plugin settings not accessible, using legacy save method with key: ${t}`);let i={...await this.plugin.loadData()||{},[t]:this.options};await this.plugin.saveData(i)}}catch(t){console.error(`Failed to save custom options with key: ${this.getOptionsKey()}:`,t)}}getOptions(t){return t==="event"?this.options.event.map(r=>r.name):t==="instrument"?this.options.instrument.map(r=>r.name):this.options[t]?[...this.options[t]]:(console.warn(`Options for type ${t} not initialized, returning empty array`),[])}getInstrumentsForAssetType(t){return this.options.instrument.filter(r=>r.assetType===t).map(r=>r.name)}isInstrumentValidForAssetType(t,r){return!t||!r?!1:this.options.instrument.some(n=>n.name.toLowerCase()===t.toLowerCase()&&n.assetType===r)}getAssetTypeForInstrument(t){if(!t)return;let r=this.options.instrument.find(n=>n.name.toLowerCase()===t.toLowerCase());return r==null?void 0:r.assetType}getFuturesDataForInstrument(t){if(!t)return;let r=this.options.instrument.find(n=>n.name.toLowerCase()===t.toLowerCase()&&n.assetType==="futures");return r==null?void 0:r.futuresData}async setFuturesDataForInstrument(t,r){if(!t)return!1;let n=this.options.instrument.findIndex(a=>a.name.toLowerCase()===t.toLowerCase()&&a.assetType==="futures");if(n===-1)return!1;let i={...r};return i.dollarPerPoint===0&&(i.dollarPerPoint=void 0),this.options.instrument[n].futuresData={...this.options.instrument[n].futuresData,...i},await this.saveOptions(),this.notifyOptionsChanged(),!0}getAllOptions(){return{...this.options}}async addOption(t,r,n,i,a){if(t==="event")return console.warn("Use addOrUpdateEventOption to add events with colors."),!1;let o=r.trim();if(!o)return!1;if(t==="instrument"){if(!n)return console.warn("Asset type is required when adding an instrument"),!1;if(this.options.instrument.some(c=>c.name.toLowerCase()===o.toLowerCase()&&c.assetType===n))return!1;let l={name:o,assetType:n};n==="futures"&&i&&(l.futuresData=i),n==="forex"&&a&&(l.forexData=a),this.options.instrument.push(l)}else{if(this.options[t].some(l=>tB(l,o)))return!1;this.options[t]=[...this.options[t],o]}return await this.saveOptions(),!0}async addOrUpdateEventOption(t,r){let n=t.trim(),a=["red","orange","yellow","gray"].includes(r)?r:"gray";if(!n)return!1;let o=this.options.event.findIndex(s=>s.name.toLowerCase()===n.toLowerCase());return o!==-1?this.options.event[o].color=a:this.options.event.push({name:n,color:a}),await this.saveOptions(),this.notifyOptionsChanged(),!0}async addOptions(t,r,n){if(t==="event")return console.warn("Use addOrUpdateEventOption to add events with colors. Skipping addOptions for EVENT."),0;if(!r.length)return 0;let i=r.map(a=>a.trim()).filter(a=>!!a);if(!i.length)return 0;if(t==="instrument"){if(!n)return console.warn("Asset type is required when adding instruments"),0;let a=0;for(let o of i)if(!this.options.instrument.some(l=>l.name.toLowerCase()===o.toLowerCase()&&l.assetType===n)){let l={name:o,assetType:n};n==="futures"&&(l.futuresData={dollarPerPoint:0,tickSize:0,tickValue:0}),this.options.instrument.push(l),a++}return a>0&&await this.saveOptions(),a}else{let a=i.filter(s=>{let l=s==null?void 0:s.trim();return l?!this.options[t].some(c=>tB(c,l)):!1}),o=Na(a);return o.length?(this.options[t]=[...this.options[t],...o],await this.saveOptions(),o.length):0}}async removeOption(t,r){if(t==="account_type"&&r.toLowerCase()==="archived")return console.warn('Cannot remove reserved "archived" account type'),!1;let n=!1;if(t==="event"){let i=this.options.event.length;this.options.event=this.options.event.filter(a=>a.name.toLowerCase()!==r.toLowerCase()),n=i!==this.options.event.length}else if(t==="instrument"){let i=this.options.instrument.length;this.options.instrument=this.options.instrument.filter(a=>a.name.toLowerCase()!==r.toLowerCase()),n=i!==this.options.instrument.length}else{let i=this.options[t].length;this.options[t]=this.options[t].filter(a=>a.toLowerCase()!==r.toLowerCase()),n=i!==this.options[t].length}return n?(await this.saveOptions(),await new Promise(i=>setTimeout(i,200)),this.notifyOptionsChanged()):console.warn(`Failed to remove option '${r}' from ${t} - option not found`),n}async updateInstrument(t,r,n,i,a=!1,o){let s=r.trim();if(!s)return{success:!1};if(!n)return{success:!1};let l=this.options.instrument.findIndex(p=>p.name.toLowerCase()===t.toLowerCase());if(l===-1)return console.warn(`Instrument '${t}' not found`),{success:!1};if(this.options.instrument.some((p,m)=>m!==l&&p.name.toLowerCase()===s.toLowerCase()&&p.assetType===n))return console.warn(`Instrument '${s}' already exists with asset type '${n}'`),{success:!1};let d={name:s,assetType:n};n==="futures"&&(d.futuresData=i||this.options.instrument[l].futuresData||{dollarPerPoint:0,tickSize:0,tickValue:0}),n==="forex"&&(d.forexData=o||this.options.instrument[l].forexData),this.options.instrument[l]=d,await this.saveOptions();let u=0;return a&&t!==s&&(u=await this.updateNotesWithOption("instrument",t,s)),this.notifyOptionsChanged(),{success:!0,updatedNotes:u}}async updateOption(t,r,n,i=!1){let a=n.trim();if(!a)return{success:!1};if(t==="instrument")return console.warn("Use updateInstrument method for instruments"),{success:!1};let o=!1,s=-1;if(t==="event"){if(this.options.event.some(d=>d.name.toLowerCase()===a.toLowerCase()&&d.name.toLowerCase()!==r.toLowerCase()))return{success:!1};s=this.options.event.findIndex(d=>d.name.toLowerCase()===r.toLowerCase()),s!==-1&&(this.options.event[s].name=a,o=!0)}else{if(this.options[t].some(d=>d.toLowerCase()===a.toLowerCase()&&d.toLowerCase()!==r.toLowerCase()))return{success:!1};s=this.options[t].findIndex(d=>d.toLowerCase()===r.toLowerCase()),s!==-1&&(this.options[t][s]=a,o=!0)}if(!o)return{success:!1};await this.saveOptions();let l=0;return i&&(l=await this.updateNotesWithOption(t,r,n)),this.notifyOptionsChanged(),{success:!0,updatedNotes:l}}async updateNotesWithOption(t,r,n){try{let i=this.getApp().vault.getMarkdownFiles(),o={instrument:["instrument"],account:["account","accountIds"],setup:["setup","setupIds"],mistake:["mistake","mistakeIds"],tag:["customTags"],event:["keyEvents"]}[t];if(!o||o.length===0)return console.warn(`No property names defined for option type: ${t}`),0;let s=0;for(let l of i)try{let c=await this.getApp().vault.read(l),d=c.match(/^---\n([\s\S]*?)\n---/);if(!d)continue;let p=d[1].split(`
`),m=!1,g=p.map(f=>{var v;for(let h of o)if(h==="keyEvents"&&t==="event"){let y=f.match(/^(\s*-\s*event:\s*)(.+)$/);if(y){let b=y[1],k=y[2].trim();if(this.optionValueMatches(k,r))return m=!0,`${b}${n}`}}else if(f.trim().startsWith(`${h}:`)&&!f.includes("[")){let y=(v=f.split(":")[1])==null?void 0:v.trim();if(y&&this.optionValueMatches(y,r))return m=!0,`${h}: ${n}`}else if(f.trim().startsWith(`${h}:`)&&f.includes("[")){let y=f.match(/\[(.*?)\]/);if(y){let b=y[1].split(",").map(x=>x.trim()),k=b.map(x=>this.optionValueMatches(x,r)?n:x);if(b.some((x,S)=>x!==k[S]))return m=!0,`${h}: [${k.join(", ")}]`}}return f});if(m){let f=c.replace(/^---\n[\s\S]*?\n---/,`---
${g.join(`
`)}
---`);await this.getApp().vault.modify(l,f),await yn(this.getApp(),l);let v=new CustomEvent(`journalit:${this.namespace}-updated`,{detail:{id:l.path}});document.dispatchEvent(v),s++,t==="instrument"&&await this.updateFileNameForInstrument(l,r,n)}}catch(c){console.error(`Error processing file ${l.path}:`,c)}return s}catch(i){return console.error("Error updating notes with new option value:",i),0}}optionValueMatches(t,r){return t.toLowerCase()===r.toLowerCase()}async updateFileNameForInstrument(t,r,n){try{let i=this.extractTickerPart(r),a=this.extractTickerPart(n),o=this.sanitizeTickerForFilename(i),s=this.sanitizeTickerForFilename(a),l=t.path.split("/"),c=l.pop()||"",d=l.join("/");if(!c.match(/^[A-Z0-9-]+-[0-9]{6}-T\d+\.md$/)||!c.startsWith(`${o}-`))return;let u=c.replace(new RegExp(`^${o}-`),`${s}-`),p=`${d}/${u}`;if(p===t.path)return;await this.getApp().fileManager.renameFile(t,p)}catch(i){console.error(`Error updating filename for '${t.path}':`,i)}}extractTickerPart(t){if(!t)return"";let r=t.match(/^([A-Z0-9.^-]+)(?:\s+-\s+|$)/);return r&&r[1]?r[1].trim():t}sanitizeTickerForFilename(t){if(!t)return"UNKNOWN";let r=t.trim().toUpperCase();if(r=r.replace(/[\\/:*?"<>|+]/g,"").replace(/[\s.\[\]\(\)\{\}#%&=;]/g,"-").replace(/--+/g,"-").replace(/^-|-$/g,""),!r)return"UNKNOWN";let n=20;return r.length>n&&(r=r.substring(0,n)),r}getApp(){return this.plugin.app}async clearOptions(t){let r=t==="instrument"?this.options[t].length:this.options[t].length;return r===0?0:(t==="instrument"?this.options[t]=[]:t==="event"?this.options[t]=[]:this.options[t]=[],await this.saveOptions(),await new Promise(n=>setTimeout(n,200)),this.notifyOptionsChanged(),r)}async resetAllOptions(){this.options={...ju},await this.saveOptions(),await new Promise(t=>setTimeout(t,200)),this.notifyOptionsChanged()}async reloadOptions(){await this.loadOptions()}async initializeDefaultOptionsIfNeeded(){var t;try{let r=!1,n=this.plugin,i=((t=n.settings)==null?void 0:t.initializedOptionTypes)||[],a=[];for(let o of Object.values(Fa))if(this.options[o].length===0&&mI[o].length>0&&!i.includes(o))if(r=!0,o==="event"){let s=mI.event;for(let l of s)this.options.event.findIndex(d=>d.name.toLowerCase()===l.name.toLowerCase())===-1&&this.options.event.push({name:l.name,color:l.color||"gray"});a.push(o)}else if(o==="instrument"){let s=mI.instrument;for(let l of s)this.options.instrument.findIndex(d=>d.name.toLowerCase()===l.name.toLowerCase())===-1&&this.options.instrument.push({name:l.name,assetType:l.assetType,futuresData:l.futuresData});a.push(o)}else{let s=mI[o];this.options[o]=[...this.options[o],...s],a.push(o)}r&&(await this.saveOptions(),a.length>0&&(n.settings.initializedOptionTypes||(n.settings.initializedOptionTypes=[]),n.settings.initializedOptionTypes=[...new Set([...n.settings.initializedOptionTypes,...a])],await n.saveSettings()))}catch(r){console.error("Failed to initialize default options:",r)}}notifyOptionsChanged(){try{let t={timestamp:Date.now(),...this.namespace?{namespace:this.namespace}:{}};xe.publish("options:changed",t)}catch(t){console.error("Failed to publish options changed event:",t)}}getEventOptionByName(t){let r=t.trim().toLowerCase();return this.options.event.find(n=>n.name.toLowerCase()===r)}getNamespace(){return this.namespace}async setNamespace(t){this.namespace!==t&&(this.namespace=t,this.options={...ju},await this.loadOptions(),this.notifyOptionsChanged())}}});var rh=F(()=>{ds()});function zX(e,t){let r=Object.keys(t).map(n=>CIe(e,n,t[n]));return r.length===1?r[0]:function(){r.forEach(n=>n())}}function CIe(e,t,r){let n=e[t],i=e.hasOwnProperty(t),a=i?n:function(){return Object.getPrototypeOf(e)[t].apply(this,arguments)},o=r(a);return n&&Object.setPrototypeOf(o,n),Object.setPrototypeOf(s,o),e[t]=s,l;function s(...c){return o===a&&e[t]===s&&l(),o.apply(this,c)}function l(){e[t]===s&&(i?e[t]=a:delete e[t]),o!==a&&(o=a,Object.setPrototypeOf(s,n||Function))}}var jX=F(()=>{});var nh,BT,fI,WT,PIe,_X,Ae,nr=F(()=>{nh=Y(Q());jX();Op();BT=null,fI=!1,WT=new Set,PIe=()=>{fI=!0,WT.forEach(e=>e()),WT.clear()},_X=e=>{BT=e,setTimeout(PIe,0);let t=zX(e,{unload:r=>async()=>(BT=null,fI=!1,WT.clear(),await r())});xe.publish("plugin:updated")},Ae=()=>{let[e,t]=(0,nh.useState)(fI?BT:null),r=(0,nh.useRef)(!0),n=(0,nh.useCallback)(()=>{r.current&&BT!==e&&t(BT)},[e]);return(0,nh.useEffect)(()=>{r.current=!0,fI?n():WT.add(n);let i=xe.subscribe("plugin:updated",n);return()=>{r.current=!1,WT.delete(n),i()}},[n]),e}});var ih,BX,el,ct,Er=F(()=>{ih=Y(Q());As();nr();BX=(0,ih.createContext)(void 0),el=({children:e})=>{var i,a;let t=Ae(),r=((a=(i=t==null?void 0:t.settings)==null?void 0:i.general)==null?void 0:a.currency)||"USD";(0,ih.useEffect)(()=>{let o=s=>{!t||t.settings};return window.addEventListener("journalit-currency-changed",o),()=>{window.removeEventListener("journalit-currency-changed",o)}},[]);let n={currency:r};return ih.default.createElement(BX.Provider,{value:n},e)},ct=()=>{let e=(0,ih.useContext)(BX);if(e===void 0)throw new Error("useCurrency must be used within a CurrencyProvider");return e}});var WX,$X,RX=F(()=>{WX=()=>{let e="journalit-asset-fields-styles";if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=`
    /* Loading accounts container */
    .asset-loading-accounts {
      padding: 12px;
      border: 1px solid var(--background-modifier-border);
      border-radius: 4px;
      color: var(--text-muted);
      background-color: var(--background-secondary);
    }

    /* Account label */
    .asset-account-label {
      margin-bottom: 8px;
    }

    /* Error message */
    .asset-error-message {
      font-size: 12px;
      color: var(--text-error);
      margin-top: 4px;
    }

    /* Commission grid */
    .commission-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      align-items: flex-start;
    }

    /* Risk management section */
    .risk-management-section {
      margin-top: 20px;
    }

    .risk-fields {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 16px;
    }

    /* Calculated risk hint */
    .calculated-risk-hint {
      font-size: 12px;
      color: var(--text-muted);
      margin-top: 4px;
      display: block;
    }
  `,document.head.appendChild(t)},$X=()=>{let t=document.getElementById("journalit-asset-fields-styles");t&&t.remove()}});function UX(e){let{currentDate:t,navigateTo:r,getAdjacentReview:n,getRelatedReviewPaths:i={},serviceName:a,calculateAdjacentDate:o,newReviewPathTemplate:s}=e,[l,c]=(0,$T.useState)(!1),d=Ae(),u=(0,$T.useCallback)(async m=>{if(!l)try{c(!0);let g=await n(m);if(g)r(g,!1);else if(o&&s){let f=o(t,m),v=s(f),h;v instanceof Promise?h=await v:h=v,r(h,!1)}}catch(g){console.error("Navigation error:",g)}finally{c(!1)}},[l,n,r,t,o,s]),p=(0,$T.useCallback)(async m=>{var g,f,v;try{let h=i[m];if(!h){console.error(`No path function found for review type: ${m}`);return}let y=h(t);if(!y){console.error(`Unable to get review path for type: ${m}`);return}let b=!1;if((f=(g=d==null?void 0:d.app)==null?void 0:g.vault)!=null&&f.adapter&&(b=await d.app.vault.adapter.exists(y)),!b&&d&&a)try{let k=await((v=d.serviceManager)==null?void 0:v.getServiceByName(a));if(k){let x=k,w={weekly:"createWeeklyReview",monthly:"createMonthlyReview",yearly:"createYearlyReview",drc:"createDRCReview"}[m],C=w?x[w]:void 0;typeof C=="function"?await C.call(x,t):typeof x.createReview=="function"&&await x.createReview(t,m)}}catch(k){console.error(`Error creating ${m} review:`,k)}r(y,!1)}catch(h){console.error(`Error navigating to ${m} review:`,h)}},[i,t,r,d,a]);return{isNavigating:l,handleNavigation:u,navigateToRelatedReview:p}}var $T,nB=F(()=>{$T=Y(Q());nr()});function uf(e){let t=Ae(),[r,n]=(0,Yx.useState)("loading"),[i,a]=(0,Yx.useState)(null),[o,s]=(0,Yx.useState)(null);return(0,Yx.useEffect)(()=>{let l=!0,c=null,d=async()=>{if(!t){c=setTimeout(d,100);return}try{if(t.serviceManager){let u=await t.serviceManager.getServiceByName(e);l&&(a(u),n("ready"),s(null));return}throw new Error("Service manager not available")}catch(u){console.error(`Error loading ${e}:`,u),l&&(a(null),n("error"),s(u instanceof Error?u:new Error(`Failed to load ${e}`)))}};return d(),()=>{l=!1,c&&clearTimeout(c)}},[t,e]),{service:i,status:r,error:o}}function HX(){return uf("accountPageService")}var Yx,gI=F(()=>{Yx=Y(Q());nr()});var RT,qX,iB=F(()=>{RT=Y(Q());Zs();qX=({plugin:e,initialData:t,onUpdate:r})=>{var l;let[n,i]=(0,RT.useState)(((l=e.settings.trade)==null?void 0:l.lossReview)||{enabled:!1,sections:[]}),[a,o]=(0,RT.useState)(t);Xe("settings:changed",c=>{var d;if((c==null?void 0:c.component)==="lossReview"){let u=((d=e.settings.trade)==null?void 0:d.lossReview)||{enabled:!1,sections:[]};i(u)}});let s=(0,RT.useCallback)(c=>{o(c),r(c)},[r]);return{settings:n,data:a,updateLossReview:s}}});function VX(e=768){let[t,r]=(0,Kx.useState)(()=>window.innerWidth<e),n=Ae();return(0,Kx.useEffect)(()=>{let i=()=>{let s=window.innerWidth<e;r(l=>l!==s?s:l)},a,o=()=>{clearTimeout(a),a=setTimeout(i,100)};return window.addEventListener("resize",o),n&&n.registerEvent(n.app.workspace.on("resize",o)),()=>{clearTimeout(a),window.removeEventListener("resize",o)}},[e,n]),t}var Kx,GX=F(()=>{Kx=Y(Q());nr()});var UT,YX=F(()=>{UT=Y(Q())});var qi=F(()=>{nr();nB();gI();iB();GX();ZE();YX();Zs()});var Jx,DIe,KX,JX=F(()=>{Jx=Y(Q());Id();DIe=({data:e,errors:t,onChange:r})=>Jx.default.createElement(Jx.default.Fragment,null,Jx.default.createElement("div",{className:"field"},Jx.default.createElement(qa,{label:"Exchange",placeholder:"e.g., NYSE, NASDAQ",value:e.exchange||"",onChange:n=>r("exchange",n),error:t.exchange}))),KX=Jx.default.memo(DIe)});function hI(e){switch(e){case"forex":return 5;case"crypto":return 8;case"futures":return 4;case"options":return 4;case"stock":return 2;case"cfd":return 4;default:return 4}}function HT(e){switch(e){case"forex":return 4;case"crypto":return 8;case"futures":return 0;case"options":return 0;case"stock":return 2;case"cfd":return 2;default:return 2}}var qT=F(()=>{cf()});var Ls,EIe,QX,XX=F(()=>{Ls=Y(Q());Id();qT();EIe=({data:e,errors:t,onChange:r})=>{let n=hI(e.assetType);return Ls.default.createElement(Ls.default.Fragment,null,Ls.default.createElement("div",{className:"field"},Ls.default.createElement(Il,{label:"Expiration Date",value:e.expirationDate,onChange:i=>r("expirationDate",i),error:t.expirationDate,required:!0})),Ls.default.createElement("div",{className:"field"},Ls.default.createElement($r,{label:"Strike Price",value:e.strikePrice,onChange:i=>r("strikePrice",i),error:t.strikePrice,min:0,precision:n,allowDecimal:!0,required:!0})),Ls.default.createElement("div",{className:"field"},Ls.default.createElement("label",{className:"label",id:"optionType-label"},"Option Type",Ls.default.createElement("span",{className:"required-indicator"},"*")),Ls.default.createElement("div",{className:"direction-container",role:"radiogroup","aria-labelledby":"optionType-label","aria-required":"true"},Ls.default.createElement("button",{type:"button",className:"direction-button",onClick:()=>r("optionType","call"),"aria-checked":e.optionType==="call",role:"radio"},"Call"),Ls.default.createElement("button",{type:"button",className:"direction-button",onClick:()=>r("optionType","put"),"aria-checked":e.optionType==="put",role:"radio"},"Put")),t.optionType&&Ls.default.createElement("div",{className:"errorMessage",role:"alert"},t.optionType)),Ls.default.createElement("div",{className:"field"},Ls.default.createElement($r,{label:"Contract Size",value:e.contractSize,onChange:i=>r("contractSize",i),error:t.contractSize,min:1,precision:0,allowDecimal:!1})))},QX=Ls.default.memo(EIe)});var _u,IIe,ZX,eZ=F(()=>{_u=Y(Q());Id();IIe=({data:e,errors:t,onChange:r})=>_u.default.createElement(_u.default.Fragment,null,_u.default.createElement("div",{className:"field"},_u.default.createElement($r,{label:"Dollars per point",value:e.dollarPerPoint,onChange:n=>r("dollarPerPoint",n),error:t.dollarPerPoint,min:.01,precision:2,allowDecimal:!0,required:!0,placeholder:"ex: 50 for ES1"})),_u.default.createElement("div",{className:"twoColumnLayout"},_u.default.createElement("div",{className:"field"},_u.default.createElement($r,{label:"Tick Size",value:e.tickSize,onChange:n=>r("tickSize",n),error:t.tickSize,min:0,precision:2,allowDecimal:!0})),_u.default.createElement("div",{className:"field"},_u.default.createElement($r,{label:"Tick Value",value:e.tickValue,onChange:n=>r("tickValue",n),error:t.tickValue,min:0,precision:2,allowDecimal:!0})))),ZX=_u.default.memo(IIe)});var qc,MIe,tZ,rZ=F(()=>{qc=Y(Q());Id();MIe=({data:e,errors:t,onChange:r})=>{let n=[1e5,1e4,1e3],i=e.lotSize!==void 0&&e.lotSize!==null&&!n.includes(e.lotSize);return qc.default.createElement(qc.default.Fragment,null,qc.default.createElement("div",{className:"field"},qc.default.createElement("label",{className:"label",id:"lotSize-label"},"Lot Size"),qc.default.createElement("div",{className:"asset-type-container",role:"radiogroup","aria-labelledby":"lotSize-label"},[{value:1e5,label:"Standard (100,000)"},{value:1e4,label:"Mini (10,000)"},{value:1e3,label:"Micro (1,000)"},{value:"custom",label:"Custom"}].map(a=>qc.default.createElement("button",{key:a.value,type:"button",className:"asset-type-button",onClick:()=>{a.value==="custom"?r("lotSize",i?e.lotSize:0):r("lotSize",a.value)},"aria-checked":a.value==="custom"?i:e.lotSize===a.value,role:"radio"},a.label))),t.lotSize&&qc.default.createElement("div",{className:"errorMessage",role:"alert"},t.lotSize)),i&&qc.default.createElement("div",{className:"field"},qc.default.createElement($r,{label:"Custom Lot Size",value:e.lotSize,onChange:a=>r("lotSize",a),error:t.lotSize,min:1,precision:0,allowDecimal:!1,required:!0})),qc.default.createElement("div",{className:"field"},qc.default.createElement($r,{label:"Pip Value",value:e.pipValue,onChange:a=>r("pipValue",a),error:t.pipValue,min:0,precision:4,allowDecimal:!0})))},tZ=qc.default.memo(MIe)});var Qx,AIe,nZ,iZ=F(()=>{Qx=Y(Q());Id();AIe=({data:e,errors:t,onChange:r})=>Qx.default.createElement(Qx.default.Fragment,null,Qx.default.createElement("div",{className:"field"},Qx.default.createElement(qa,{label:"Exchange",placeholder:"e.g., Binance, Coinbase",value:e.cryptoExchange||"",onChange:n=>r("cryptoExchange",n),error:t.cryptoExchange}))),nZ=Qx.default.memo(AIe)});var ah,LIe,aZ,oZ=F(()=>{ah=Y(Q());Id();LIe=({data:e,errors:t,onChange:r})=>ah.default.createElement(ah.default.Fragment,null,ah.default.createElement("div",{className:"field"},ah.default.createElement($r,{label:"Contract Size",value:e.contractSize,onChange:n=>r("contractSize",n),error:t.contractSize,min:1,precision:0,allowDecimal:!1})),ah.default.createElement("div",{className:"field"},ah.default.createElement($r,{label:"Leverage Ratio",placeholder:"e.g., 100 for 1:100",value:e.leverageRatio,onChange:n=>r("leverageRatio",n),error:t.leverageRatio,min:1,precision:0,allowDecimal:!1}))),aZ=ah.default.memo(LIe)});var sZ,lZ,cZ=F(()=>{sZ=()=>{let e="journalit-entry-exit-styles";if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=`
    /* Entry/Exit Fields styling */
    .entries-section, .exits-section {
      margin-bottom: 16px;
      padding: 12px;
      border: 1px solid var(--background-modifier-border);
      border-radius: 4px;
      background-color: var(--background-primary);
    }

    .section-title {
      margin: 0 0 12px 0;
      font-size: 16px;
      font-weight: 600;
      display: flex;
      align-items: center;
      color: var(--text-normal);
    }

    .badge {
      display: inline-block;
      background: var(--interactive-accent);
      color: white;
      font-size: 12px;
      padding: 2px 6px;
      border-radius: 10px;
      margin-left: 8px;
    }

    .entry-row, .exit-row {
      display: flex;
      align-items: flex-start;
      margin-bottom: 8px;
      padding-bottom: 8px;
      border-bottom: 1px solid var(--background-modifier-border);
    }

    .entry-index, .exit-index {
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--background-secondary);
      border-radius: 50%;
      margin-right: 12px;
      font-size: 12px;
      font-weight: 600;
      flex-shrink: 0;
      margin-top: 26px; /* Align with input fields */
    }

    .entry-fields, .exit-fields {
      display: flex;
      flex: 1;
      gap: 12px;
      flex-wrap: wrap;
    }

    .time-field {
      flex: 2;
      min-width: 180px;
    }

    .price-field, .size-field {
      flex: 1;
      min-width: 120px;
    }

    /* Make remove button class more specific to avoid conflicts */
    .entry-row .remove-button,
    .exit-row .remove-button {
      width: 28px;
      height: 28px;
      min-width: 28px;
      padding: 0;
      margin-left: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      margin-top: 26px; /* Align with input fields */
    }

    .add-button {
      margin-top: 8px;
      margin-bottom: 12px;
    }

    .total-size, .remaining-size {
      font-size: 14px;
      font-weight: 600;
      padding: 4px 8px;
      border-radius: 4px;
      background: var(--background-secondary);
      display: inline-block;
      margin-top: 8px;
    }

    .remaining-size.positive {
      color: var(--text-success);
    }

    .remaining-size.neutral {
      color: var(--text-normal);
    }

    /* PNL Mode Toggle */
    .journalit-pnl-mode-toggle,
    .journalit-dollar-mode-toggle {
      margin-bottom: 12px;
      padding: 8px 12px;
      border: 1px solid var(--background-modifier-border);
      border-radius: 8px;
      background: var(--background-primary);
    }
    
    /* Calculated size display in dollar value mode */
    .calculated-size {
      font-size: 12px;
      color: var(--text-muted);
      padding: 4px 8px;
      background: var(--background-secondary);
      border-radius: 4px;
      display: flex;
      align-items: center;
      align-self: flex-end;
      margin-bottom: 8px;
      white-space: nowrap;
    }

    .journalit-pnl-toggle-container {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .journalit-pnl-toggle-label {
      font-weight: 500;
      color: var(--text-normal);
    }

    .journalit-pnl-toggle-description {
      color: var(--text-muted);
      font-size: 0.9em;
      line-height: 1.4;
      margin: 0;
    }

    .journalit-direct-pnl-section {
      margin-bottom: 24px;
    }

    /* Toggle Switch Component */
    .toggle-switch-container {
      position: relative;
      display: inline-block;
      width: 40px;
      height: 24px;
    }

    .toggle-switch-input {
      opacity: 0;
      width: 0;
      height: 0;
      position: absolute;
    }

    .toggle-switch-label {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: var(--background-modifier-border);
      transition: background-color 0.3s ease, box-shadow 0.3s ease;
      border-radius: 34px;
      overflow: hidden;
    }

    .toggle-switch-label .toggle-switch-button {
      position: absolute;
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: var(--background-primary);
      transition: transform 0.3s ease;
      border-radius: 50%;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    .toggle-switch-input:checked + .toggle-switch-label {
      background-color: var(--interactive-accent);
      box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.2);
    }

    .toggle-switch-input:checked + .toggle-switch-label .toggle-switch-button {
      transform: translateX(16px);
    }

    .toggle-switch-input:focus + .toggle-switch-label {
      box-shadow: 0 0 2px var(--interactive-accent);
    }

    .toggle-switch-container.disabled {
      opacity: 0.6;
    }

    .toggle-switch-container.disabled .toggle-switch-label {
      cursor: not-allowed;
    }

    /* Mobile responsiveness */
    @media (max-width: 768px) {
      .entry-fields, .exit-fields {
        flex-direction: column;
        gap: 8px;
      }

      .time-field, .price-field, .size-field {
        width: 100%;
        min-width: 0;
      }
    }
  `,document.head.appendChild(t)},lZ=()=>{let t=document.getElementById("journalit-entry-exit-styles");t&&t.remove()}});var dZ,Ie,hi=F(()=>{dZ=Y(Q()),Ie=({variant:e="secondary",size:t="medium",fullWidth:r=!1,loading:n=!1,className:i="",children:a,...o})=>{let s="journalit-button",l=t==="sm"?"small":t==="md"?"medium":t==="lg"?"large":t,d=[s,`${s}--${e==="outline"?"secondary":e==="text"?"plain":e}`,`${s}--${l}`,r?`${s}--full-width`:"",n?`${s}--loading`:"",i].filter(Boolean).join(" ");return dZ.default.createElement("button",{className:d,type:o.type||"button",disabled:n||o.disabled,...o},a)}});var VT,NIe,la,vI=F(()=>{VT=Y(Q()),NIe=({checked:e,onChange:t,id:r,ariaLabel:n="Toggle switch",disabled:i=!1})=>{let a=s=>{i||t(s.target.checked)},o=r||`toggle-${Math.random().toString(36).substring(2,9)}`;return VT.default.createElement("div",{className:`toggle-switch-container ${i?"disabled":""}`},VT.default.createElement("input",{type:"checkbox",id:o,className:"toggle-switch-input",checked:e,onChange:a,"aria-label":n,disabled:i}),VT.default.createElement("label",{htmlFor:o,className:"toggle-switch-label"},VT.default.createElement("span",{className:"toggle-switch-button"})))},la=NIe});var Vt,FIe,uZ,pZ=F(()=>{Vt=Y(Q());cZ();Id();hi();vI();cf();qT();nr();FIe=({data:e,errors:t,onChange:r})=>{var w,C,D,P,M;let n=Ae(),i=(D=(C=(w=n==null?void 0:n.settings)==null?void 0:w.trade)==null?void 0:C.useDollarValueInput)!=null?D:!1,a=hI(e.assetType),o=HT(e.assetType),s=()=>{let z=[...e.entries||[],{time:new Date,price:0,size:0}];r("entries",z),u(z,e.exits||[])},l=z=>{let A=[...e.entries||[]];A.splice(z,1),r("entries",A),u(A,e.exits||[])},c=()=>{let z=[...e.exits||[],{time:new Date,price:0,size:0}];r("exits",z),u(e.entries||[],z)},d=z=>{let A=[...e.exits||[]];A.splice(z,1),r("exits",A),u(e.entries||[],A)},u=(0,Vt.useCallback)((z,A)=>{if(!z.length&&!A.length){r("entryPrice",void 0),r("exitPrice",void 0),r("positionSize",void 0),r("entryTime",void 0),r("exitTime",void 0);return}let I=0,L=0;z.forEach($=>{$.size!==void 0&&$.price!==void 0&&(I+=$.price*$.size,L+=$.size)});let E=0,T=0;if(A.forEach($=>{$.size!==void 0&&$.price!==void 0&&(E+=$.price*$.size,T+=$.size)}),L>0&&(r("entryPrice",I/L),r("positionSize",L)),z.length>0){let $=z.reduce((_,B)=>B.time&&(!_||B.time<_)?B.time:_,null);$&&r("entryTime",$)}if(T>0?r("exitPrice",E/T):r("exitPrice",void 0),A.length>0){let $=A.reduce((_,B)=>B.time&&(!_||B.time>_)?B.time:_,null);$&&r("exitTime",$)}else r("exitTime",void 0)},[r]),p=(0,Vt.useCallback)((z,A,I)=>{let L=[...e.entries||[]];if(A==="time"&&typeof I=="string"){let E=new Date(I);I=isNaN(E.getTime())?void 0:E}A==="size"?L[z]={...L[z],[A]:I,notional:void 0}:L[z]={...L[z],[A]:I},r("entries",L),u(L,e.exits||[])},[e.entries,e.exits,r,u]),m=(0,Vt.useCallback)((z,A,I)=>{let L=[...e.exits||[]];if(A==="time"&&typeof I=="string"){let E=new Date(I);I=isNaN(E.getTime())?void 0:E}A==="size"?L[z]={...L[z],[A]:I,notional:void 0}:L[z]={...L[z],[A]:I},r("exits",L),u(e.entries||[],L)},[e.entries,e.exits,r,u]),g=async z=>{r("useDirectPnLInput",z);try{n&&(n.settings.trade={...n.settings.trade,useDirectPnLInput:z},await n.saveSettings())}catch(A){console.error("Error saving PNL input mode preference:",A)}},f=(0,Vt.useCallback)((z,A)=>{let I=[...e.entries||[]],L=I[z];if(A&&(L!=null&&L.price)&&L.price>0){let E=A/L.price,T=parseFloat(E.toFixed(o));I[z]={...L,size:T,notional:A},r("entries",I),u(I,e.exits||[])}else L&&(I[z]={...L,size:0,notional:A},r("entries",I),u(I,e.exits||[]))},[e.entries,e.exits,o,r,u]),v=(0,Vt.useCallback)((z,A)=>{let I=[...e.exits||[]],L=I[z];if(A&&(L!=null&&L.price)&&L.price>0){let E=A/L.price,T=parseFloat(E.toFixed(o));I[z]={...L,size:T,notional:A},r("exits",I),u(e.entries||[],I)}else L&&(I[z]={...L,size:0,notional:A},r("exits",I),u(e.entries||[],I))},[e.entries,e.exits,o,r,u]),h=(0,Vt.useCallback)((z,A)=>{if(i&&A&&A>0){let I=(e.entries||[])[z],L=I==null?void 0:I.notional;if(L){let E=L/A,T=parseFloat(E.toFixed(o)),$=[...e.entries||[]];$[z]={...$[z],price:A,size:T,notional:L},r("entries",$),u($,e.exits||[]);return}}p(z,"price",A)},[i,e.entries,e.exits,o,r,u,p]),y=(0,Vt.useCallback)((z,A)=>{if(i&&A&&A>0){let I=(e.exits||[])[z],L=I==null?void 0:I.notional;if(L){let E=L/A,T=parseFloat(E.toFixed(o)),$=[...e.exits||[]];$[z]={...$[z],price:A,size:T,notional:L},r("exits",$),u(e.entries||[],$);return}}m(z,"price",A)},[i,e.entries,e.exits,o,r,u,m]),b=()=>{switch(e.assetType){case"stock":return"Shares";case"options":case"futures":return"Contracts";case"forex":return"Lots";case"crypto":return"Amount";case"cfd":return"CFD Units";default:return"Position Size"}},k=(e.entries||[]).reduce((z,A)=>z+(A.size||0),0),x=(e.exits||[]).reduce((z,A)=>z+(A.size||0),0),S=k-x;return(0,Vt.useEffect)(()=>(sZ(),()=>{lZ()}),[]),Vt.default.createElement(Vt.default.Fragment,null,Vt.default.createElement("div",{className:"journalit-pnl-mode-toggle"},Vt.default.createElement("div",{className:"journalit-pnl-toggle-container"},Vt.default.createElement(la,{checked:e.useDirectPnLInput||!1,onChange:g,id:"use-direct-pnl",ariaLabel:"Enter PNL directly instead of prices"}),Vt.default.createElement("label",{htmlFor:"use-direct-pnl",className:"journalit-pnl-toggle-label"},"Enter PNL directly instead of prices")),Vt.default.createElement("p",{className:"journalit-pnl-toggle-description"},e.useDirectPnLInput?"Enter your total profit/loss directly. Commission and fees will still be subtracted.":"Calculate PNL from entry/exit prices and position sizes.")),e.useDirectPnLInput&&Vt.default.createElement("div",{className:"journalit-direct-pnl-section"},Vt.default.createElement("div",{className:"field"},Vt.default.createElement($r,{label:"Total P&L",value:e.directPnL,onChange:z=>r("directPnL",z),error:t.directPnL,allowDecimal:!0,precision:2,required:!e.isMissedTrade,placeholder:"Enter total profit or loss"}))),Vt.default.createElement("div",{className:"entries-section"},Vt.default.createElement("h4",{className:"section-title"},"Entries ",e.useDirectPnLInput?"(optional)":""," ",Vt.default.createElement("span",{className:"badge"},((P=e.entries)==null?void 0:P.length)||0)),(e.entries||[]).map((z,A)=>{var I,L,E,T,$,_,B,W,N,U;return Vt.default.createElement("div",{key:`entry-${A}`,className:"entry-row"},Vt.default.createElement("div",{className:"entry-index"},A+1),Vt.default.createElement("div",{className:"entry-fields"},Vt.default.createElement(Il,{label:"Time",value:z.time,onChange:j=>p(A,"time",j),error:(L=(I=t.entries)==null?void 0:I[A])==null?void 0:L.time,includeTime:!0,required:!e.isMissedTrade&&!e.useDirectPnLInput,className:"time-field"}),Vt.default.createElement($r,{label:"Price",value:z.price,onChange:j=>i?h(A,j):p(A,"price",j),error:(T=(E=t.entries)==null?void 0:E[A])==null?void 0:T.price,min:0,precision:a,allowDecimal:!0,required:!e.isMissedTrade&&!e.useDirectPnLInput,className:"price-field"}),i?Vt.default.createElement(Vt.default.Fragment,null,Vt.default.createElement($r,{label:"Value ($)",value:($=z.notional)!=null?$:z.size&&z.price?z.size*z.price:void 0,onChange:j=>f(A,j),error:(B=(_=t.entries)==null?void 0:_[A])==null?void 0:B.size,min:0,precision:2,allowDecimal:!0,required:!e.isMissedTrade&&!e.useDirectPnLInput,placeholder:"Dollar amount",className:"size-field"}),z.price>0&&z.size>0&&Vt.default.createElement("div",{className:"calculated-size"},"= ",z.size.toFixed(o)," ",b().toLowerCase())):Vt.default.createElement($r,{label:b(),value:z.size,onChange:j=>p(A,"size",j),error:(N=(W=t.entries)==null?void 0:W[A])==null?void 0:N.size,min:0,precision:o,required:!e.isMissedTrade&&!e.useDirectPnLInput,className:"size-field"})),(((U=e.entries)==null?void 0:U.length)||0)>1&&Vt.default.createElement(Ie,{variant:"outline",className:"remove-button clickable-icon",onClick:()=>l(A),"aria-label":"Remove Entry"},"-"))}),Vt.default.createElement(Ie,{variant:"outline",className:"add-button clickable-icon",onClick:s},"+ Add Entry"),Vt.default.createElement("div",{className:"total-size"},"Total Entry Size: ",k.toFixed(o))),Vt.default.createElement("div",{className:"exits-section"},Vt.default.createElement("h4",{className:"section-title"},"Exits ",e.useDirectPnLInput?"(optional)":""," ",Vt.default.createElement("span",{className:"badge"},((M=e.exits)==null?void 0:M.length)||0)),(e.exits||[]).map((z,A)=>{var I,L,E,T,$,_,B,W,N,U;return Vt.default.createElement("div",{key:`exit-${A}`,className:"exit-row"},Vt.default.createElement("div",{className:"exit-index"},A+1),Vt.default.createElement("div",{className:"exit-fields"},Vt.default.createElement(Il,{label:"Time",value:z.time,onChange:j=>m(A,"time",j),error:(L=(I=t.exits)==null?void 0:I[A])==null?void 0:L.time,includeTime:!0,required:!e.isMissedTrade&&!e.useDirectPnLInput,className:"time-field"}),Vt.default.createElement($r,{label:"Price",value:z.price,onChange:j=>i?y(A,j):m(A,"price",j),error:(T=(E=t.exits)==null?void 0:E[A])==null?void 0:T.price,min:0,precision:a,allowDecimal:!0,required:!e.isMissedTrade&&!e.useDirectPnLInput,className:"price-field"}),i?Vt.default.createElement(Vt.default.Fragment,null,Vt.default.createElement($r,{label:"Value ($)",value:($=z.notional)!=null?$:z.size&&z.price?z.size*z.price:void 0,onChange:j=>v(A,j),error:(B=(_=t.exits)==null?void 0:_[A])==null?void 0:B.size,min:0,precision:2,allowDecimal:!0,required:!e.isMissedTrade&&!e.useDirectPnLInput,placeholder:"Dollar amount",className:"size-field"}),z.price>0&&z.size>0&&Vt.default.createElement("div",{className:"calculated-size"},"= ",z.size.toFixed(o)," ",b().toLowerCase())):Vt.default.createElement($r,{label:b(),value:z.size,onChange:j=>m(A,"size",j),error:(N=(W=t.exits)==null?void 0:W[A])==null?void 0:N.size,min:0,precision:o,required:!e.isMissedTrade&&!e.useDirectPnLInput,className:"size-field"})),(((U=e.exits)==null?void 0:U.length)||0)>1&&Vt.default.createElement(Ie,{variant:"outline",className:"remove-button clickable-icon",onClick:()=>d(A),"aria-label":"Remove Exit"},"-"))}),Vt.default.createElement(Ie,{variant:"outline",className:"add-button clickable-icon",onClick:c},"+ Add Exit"),Vt.default.createElement("div",{className:`remaining-size ${S>0?"positive":"neutral"}`},"Remaining Position: ",S.toFixed(o)," ",S>0?"(Open)":"(Closed)")),!e.useDirectPnLInput&&t.entriesExits&&Vt.default.createElement("div",{className:"errorMessage",role:"alert"},t.entriesExits))},uZ=Vt.default.memo(FIe)});var qe,mZ,OIe,fZ,aB=F(()=>{qe=Y(Q()),mZ=require("obsidian");Id();Rx();cf();iy();eh();qt();Jn();rh();Er();RX();sy();qi();JX();XX();eZ();rZ();iZ();oZ();pZ();OIe=({data:e,errors:t,onChange:r,instruments:n=[]})=>{var E,T,$,_,B,W;let{currency:i}=ct(),[a,o]=(0,qe.useState)([]),[s,l]=(0,qe.useState)({}),[c,d]=(0,qe.useState)({}),[u,p]=(0,qe.useState)([]),[m,g]=(0,qe.useState)(!1),f=(0,qe.useCallback)(async()=>{var N;try{g(!0);let U=Hi().plugins.plugins.journalit,j=U==null?void 0:U.tradeService;if(!j){console.warn("TradeService not available, skipping account loading"),g(!1);return}let R=await j.getUniqueAccounts(),O=Object.keys(((N=U.settings.account)==null?void 0:N.accountMetadata)||{}),H=[...new Set([...R,...O])],q={},V={};H.forEach(J=>{q[J]=J,V[J]=J}),o(H),l(q),d(V)}catch(U){console.error("Failed to load options:",U),o([])}finally{g(!1)}},[]);(0,qe.useEffect)(()=>{f();let N=Hi().plugins.plugins.journalit,U=N&&N.optionsService?N.optionsService:new Go(null),j=e.assetType?U.getInstrumentsForAssetType(e.assetType):[],R=e.instrument&&e.assetType&&!j.includes(e.instrument)?[...j,e.instrument]:[...j];p(R)},[e.assetType,f]),Xe("account:changed",f);let v=(0,qe.useCallback)(()=>{try{let N=Hi().plugins.plugins.journalit,U=N&&N.optionsService?N.optionsService:new Go(null),j=e.assetType?U.getInstrumentsForAssetType(e.assetType):[],R=e.instrument&&e.assetType&&!j.includes(e.instrument)?[...j,e.instrument]:[...j];p(R)}catch(N){console.error("Error updating instrument options:",N)}},[e.assetType,e.instrument]),h=(0,qe.useMemo)(()=>jT(v,300),[v]);(0,qe.useEffect)(()=>()=>{h.cancel()},[h]),Xe("options:changed",h);let y=N=>!N||!N.length?[]:N.map(U=>s[U]||U),b=N=>!N||!N.length?[]:N.map(U=>c[U]||U),k=async N=>{try{let U=Hi().plugins.plugins.journalit,j=U?U.optionsService:new Go(null);if(!e.assetType){console.error("Cannot add instrument: No asset type selected"),new mZ.Notice("Asset type is required when adding an instrument");return}await j.addOption("instrument",N,e.assetType)&&j.notifyOptionsChanged()}catch(U){console.error("Failed to save custom instrument option:",U)}};(0,qe.useEffect)(()=>{if(!e.instrument||!e.assetType)return;let N=Hi().plugins.plugins.journalit,U=N?N.optionsService:new Go(null),j=N?N.specService:null;if(!U.isInstrumentValidForAssetType(e.instrument,e.assetType)){r("instrument","");return}if(e.assetType==="futures"){let O=!1;if(j){let H=j.getSpecsForSymbol(e.instrument,"futures");H&&"dollarPerPoint"in H&&(r("dollarPerPoint",H.dollarPerPoint),r("tickSize",H.tickSize),r("tickValue",H.tickValue),O=!0)}if(!O)try{let H=U.getFuturesDataForInstrument(e.instrument);H?(H.dollarPerPoint!==void 0&&H.dollarPerPoint!==0?r("dollarPerPoint",H.dollarPerPoint):r("dollarPerPoint",void 0),H.tickSize!==void 0?r("tickSize",H.tickSize):r("tickSize",void 0),H.tickValue!==void 0?r("tickValue",H.tickValue):r("tickValue",void 0)):(r("dollarPerPoint",void 0),r("tickSize",void 0),r("tickValue",void 0))}catch(H){console.error("Failed to load futures data from CustomOptionsService:",H),r("dollarPerPoint",void 0),r("tickSize",void 0),r("tickValue",void 0)}}if(e.assetType==="forex")if(j){let O=j.getSpecsForSymbol(e.instrument,"forex");O&&"lotSize"in O&&"pipValue"in O?(r("pipValue",O.pipValue),r("lotSize",O.lotSize)):(r("pipValue",void 0),r("lotSize",void 0))}else r("pipValue",void 0),r("lotSize",void 0)},[e.instrument,e.assetType]),(0,qe.useEffect)(()=>{e.assetType!=="forex"&&(e.pipValue!==void 0&&r("pipValue",void 0),e.lotSize!==void 0&&r("lotSize",void 0)),e.assetType!=="futures"&&(e.dollarPerPoint!==void 0&&r("dollarPerPoint",void 0),e.tickSize!==void 0&&r("tickSize",void 0),e.tickValue!==void 0&&r("tickValue",void 0))},[e.assetType]),(0,qe.useEffect)(()=>{if(e.assetType!=="futures"||!e.instrument||e.dollarPerPoint===void 0)return;let N=Hi().plugins.plugins.journalit,U=N?N.optionsService:new Go(null),j=setTimeout(async()=>{try{await U.setFuturesDataForInstrument(e.instrument,{dollarPerPoint:e.dollarPerPoint,tickSize:e.tickSize,tickValue:e.tickValue})}catch(R){console.error("Failed to save futures data for instrument:",R)}},1e3);return()=>clearTimeout(j)},[e.instrument,e.dollarPerPoint,e.tickSize,e.tickValue]);let[x,S]=(0,qe.useState)(0),[w,C]=(0,qe.useState)(0),D=(0,qe.useCallback)(jT((...N)=>{r(...N)},300),[r]);(0,qe.useEffect)(()=>(WX(),()=>$X()),[]),(0,qe.useEffect)(()=>{let N=e.backendTradeId!==void 0&&e.backendTradeId!==null,U=e.originalPnl!==void 0||e.pnl!==void 0;if(N&&U){let j=e.originalPnl!==void 0?e.originalPnl:e.pnl;S(j||0)}else S(uc(e));C(EX(e))},[e.entryPrice,e.exitPrice,e.positionSize,e.direction,e.commission,e.commissionType,e.swap,e.fees,e.rebate,e.directPnL,e.useDirectPnLInput,e.backendTradeId,e.originalPnl,e.pnl,e.entries,e.exits]);let P=Hi().plugins.plugins.journalit,M=($=(T=(E=P==null?void 0:P.settings)==null?void 0:E.trade)==null?void 0:T.displayRMultiples)!=null?$:!1,z=(W=(B=(_=P==null?void 0:P.settings)==null?void 0:_.trade)==null?void 0:B.defaultRiskAmount)!=null?W:0,A=e.assetType==="forex"||e.assetType==="cfd",I=()=>{switch(e.assetType){case"stock":return"Shares";case"options":case"futures":return"Contracts";case"forex":return"Lots";case"crypto":return"Amount";case"cfd":return"CFD Units";default:return"Position Size"}},L=()=>{switch(e.assetType){case"stock":return"Ticker";case"options":return"Option Symbol";case"futures":return"Future Symbol";case"forex":return"Forex Pair";case"crypto":return"Crypto Symbol";case"cfd":return"CFD Symbol";default:return"Ticker"}};return qe.default.createElement(Qg,{title:"Trade Details"},qe.default.createElement("div",{className:"field"},m?qe.default.createElement("div",{className:"asset-loading-accounts"},qe.default.createElement("div",{className:"asset-account-label"},"Account"),"Loading accounts..."):qe.default.createElement(Xs,{label:"Account",options:a,value:Array.isArray(e.account)?e.account:[],onChange:N=>{let U=Array.isArray(N)?[...N]:N?[N]:[],j=y(U);if(r("account",U),r("accountIds",U),U.length===1){let R=s[U[0]];R&&/^\d+$/.test(R)?r("accountId",R):r("accountId",void 0)}else r("accountId",void 0)},error:t.accountIds,allowCreate:!1,isMulti:!0,optionType:"account",required:!e.isMissedTrade,placeholder:"Select accounts"}),!m&&a.length===0&&qe.default.createElement("div",{className:"asset-error-message"},"No accounts found. Please create an account in the Accounts tab.")),qe.default.createElement("div",{className:"field"},qe.default.createElement("label",{className:"label",id:"assetType-label"},"Asset Type",qe.default.createElement("span",{className:"required-indicator"},"*")),qe.default.createElement("div",{className:"asset-type-container",role:"radiogroup","aria-labelledby":"assetType-label","aria-required":"true"},["stock","options","futures","forex","crypto","cfd"].map(N=>qe.default.createElement("button",{key:N,type:"button",className:"asset-type-button",onClick:()=>r("assetType",N),"aria-checked":e.assetType===N,role:"radio"},N==="cfd"?"CFD":N.charAt(0).toUpperCase()+N.slice(1)))),t.assetType&&qe.default.createElement("div",{className:"errorMessage",role:"alert"},t.assetType)),qe.default.createElement("div",{className:"field"},qe.default.createElement(Xs,{label:L(),options:u,value:e.instrument||"",onChange:N=>r("instrument",N),error:t.instrument,allowCreate:!0,isMulti:!1,optionType:"instrument",onSaveOption:k,required:!0})),e.assetType&&qe.default.createElement("div",{className:"asset-specific-fields"},e.assetType==="stock"&&qe.default.createElement(KX,{data:e,errors:t,onChange:r}),e.assetType==="options"&&qe.default.createElement(QX,{data:e,errors:t,onChange:r}),e.assetType==="futures"&&qe.default.createElement(ZX,{data:e,errors:t,onChange:r}),e.assetType==="forex"&&qe.default.createElement(tZ,{data:e,errors:t,onChange:r}),e.assetType==="crypto"&&qe.default.createElement(nZ,{data:e,errors:t,onChange:r}),e.assetType==="cfd"&&qe.default.createElement(aZ,{data:e,errors:t,onChange:r})),e.assetType!=="options"&&qe.default.createElement("div",{className:"field"},qe.default.createElement("label",{className:"label",id:"direction-label"},"Direction",qe.default.createElement("span",{className:"required-indicator"},"*")),qe.default.createElement("div",{className:"direction-container",role:"radiogroup","aria-labelledby":"direction-label","aria-required":"true"},qe.default.createElement("button",{type:"button",className:"direction-button",onClick:()=>r("direction","long"),"aria-checked":e.direction==="long",role:"radio"},"Long"),qe.default.createElement("button",{type:"button",className:"direction-button",onClick:()=>r("direction","short"),"aria-checked":e.direction==="short",role:"radio"},"Short")),t.direction&&qe.default.createElement("div",{className:"errorMessage",role:"alert"},t.direction)),qe.default.createElement("div",{className:"field"},qe.default.createElement(uZ,{data:e,errors:t,onChange:r})),qe.default.createElement("div",{className:"trading-costs-section"},qe.default.createElement("h4",{className:"section-title"},"Trading Costs"),qe.default.createElement("div",{className:`cost-fields ${A?"three-column":"two-column"}`},qe.default.createElement("div",{className:"field"},qe.default.createElement("div",{className:"commission-grid"},qe.default.createElement($r,{label:"Commission",value:e.commission,onChange:N=>D("commission",N),error:t.commission||t.commissionType,precision:2,allowDecimal:!0,placeholder:e.commissionType==="percentage"?"0.15":"5.50"}),qe.default.createElement(Xi,{label:"Type",options:[{value:"fixed",label:`Fixed ${Uc(0,i).replace("0","").trim()}`},{value:"percentage",label:"Percentage (%)"}],value:e.commissionType||"fixed",onChange:N=>D("commissionType",N)}))),e.assetType==="options"&&qe.default.createElement("div",{className:"field"},qe.default.createElement($r,{label:"Rebate",value:e.rebate,onChange:N=>D("rebate",N),error:t.rebate,precision:2,allowDecimal:!0,min:0,placeholder:"Commission rebate/credit"})),A&&qe.default.createElement("div",{className:"field"},qe.default.createElement($r,{label:"Swap",value:e.swap,onChange:N=>D("swap",N),error:t.swap,precision:2,allowDecimal:!0,placeholder:"Overnight financing"})),qe.default.createElement("div",{className:"field"},qe.default.createElement($r,{label:"Other Fees",value:e.fees,onChange:N=>D("fees",N),error:t.fees,precision:2,allowDecimal:!0,placeholder:"Platform/regulatory fees"})))),qe.default.createElement("div",{className:"risk-management-section"},qe.default.createElement("h4",{className:"section-title"},"Risk Management"),qe.default.createElement("div",{className:"risk-fields"},qe.default.createElement("div",{className:"field"},qe.default.createElement($r,{label:"Stop Loss",value:e.stopLoss,onChange:N=>D("stopLoss",N),error:t.stopLoss,precision:e.assetType==="forex"?5:2,allowDecimal:!0,placeholder:"Optional stop loss price"})),qe.default.createElement("div",{className:"field"},qe.default.createElement($r,{label:"Risk Amount",value:e.riskAmount,onChange:N=>D("riskAmount",N),error:t.riskAmount,precision:2,allowDecimal:!0,placeholder:"Planned risk in currency"}),e.stopLoss&&e.entryPrice&&e.positionSize&&(()=>{let N=Math.abs(e.entryPrice-e.stopLoss)*e.positionSize,U=xt(N,void 0,e.riskAmount,z);return qe.default.createElement("span",{className:"calculated-risk-hint"},"Calculated: ",ye(N,!0,i,M,U))})()),(()=>{var O,H,q,V,J,K,G,X,te,re;let N=Hi().plugins.plugins.journalit,U=(H=(O=N==null?void 0:N.settings)==null?void 0:O.trade)==null?void 0:H.maeMfeInputMode,j=U==="price",R=U!=="price";return qe.default.createElement(qe.default.Fragment,null,j&&qe.default.createElement("div",{className:"field"},qe.default.createElement($r,{label:((q=e.direction)==null?void 0:q.toUpperCase())==="SHORT"||((V=e.direction)==null?void 0:V.toUpperCase())==="SELL"?"MAE Price (High)":"MAE Price (Low)",value:e.maePrice,onChange:Z=>D("maePrice",Z),error:t.maePrice,precision:e.assetType==="forex"?5:2,allowDecimal:!0,placeholder:((J=e.direction)==null?void 0:J.toUpperCase())==="SHORT"||((K=e.direction)==null?void 0:K.toUpperCase())==="SELL"?"Highest price reached":"Lowest price reached"}),e.maePrice!==void 0&&e.entryPrice&&e.positionSize&&e.positionSize>0&&qe.default.createElement("span",{className:"calculated-risk-hint"},(()=>{var ee,ie;let se=(((ee=e.direction)==null?void 0:ee.toUpperCase())==="SHORT"||((ie=e.direction)==null?void 0:ie.toUpperCase())==="SELL"?e.entryPrice-e.maePrice:e.maePrice-e.entryPrice)*e.positionSize;return`= ${ye(se,!1,i)}`})())),j&&qe.default.createElement("div",{className:"field"},qe.default.createElement($r,{label:((G=e.direction)==null?void 0:G.toUpperCase())==="SHORT"||((X=e.direction)==null?void 0:X.toUpperCase())==="SELL"?"MFE Price (Low)":"MFE Price (High)",value:e.mfePrice,onChange:Z=>D("mfePrice",Z),error:t.mfePrice,precision:e.assetType==="forex"?5:2,allowDecimal:!0,placeholder:((te=e.direction)==null?void 0:te.toUpperCase())==="SHORT"||((re=e.direction)==null?void 0:re.toUpperCase())==="SELL"?"Lowest price reached":"Highest price reached"}),e.mfePrice!==void 0&&e.entryPrice&&e.positionSize&&e.positionSize>0&&qe.default.createElement("span",{className:"calculated-risk-hint"},(()=>{var ee,ie;let se=(((ee=e.direction)==null?void 0:ee.toUpperCase())==="SHORT"||((ie=e.direction)==null?void 0:ie.toUpperCase())==="SELL"?e.entryPrice-e.mfePrice:e.mfePrice-e.entryPrice)*e.positionSize;return`= ${ye(se,!1,i)}`})())),R&&qe.default.createElement("div",{className:"field"},qe.default.createElement($r,{label:"MAE ($)",value:e.mae,onChange:Z=>D("mae",Z),error:t.mae,precision:2,allowDecimal:!0,placeholder:"Max drawdown in dollars"})),R&&qe.default.createElement("div",{className:"field"},qe.default.createElement($r,{label:"MFE ($)",value:e.mfe,onChange:Z=>D("mfe",Z),error:t.mfe,precision:2,allowDecimal:!0,placeholder:"Max profit in dollars"})))})())),e.entryPrice!==void 0&&e.exitPrice!==void 0&&e.positionSize!==void 0&&e.direction!==void 0&&(()=>{let N=xt(x,void 0,e.riskAmount,z),U=LT(e),j=xt(U,void 0,e.riskAmount,z);return qe.default.createElement("div",{className:"calculatedValue"},qe.default.createElement("span",{className:"calculatedLabel"},"Profit/Loss",e.commission||e.swap||e.fees?" (incl. costs)":""),qe.default.createElement("span",{className:`calculatedAmount ${x>0?"positive":x<0?"negative":"neutral"}`},ye(x,!0,i,M,N)),!e.useDirectPnLInput&&qe.default.createElement("span",{className:"calculatedLabel"},"(",w.toFixed(2),"%)"),e.commission||e.swap||e.fees?qe.default.createElement("span",{className:"calculatedLabel"},"Total Costs: ",ye(U,!0,i,M,j)):null)})(),(()=>{if(!yt({tradeStatus:e.tradeStatus,exitTime:e.exitTime,exitPrice:e.exitPrice,pnl:e.pnl,useDirectPnLInput:e.useDirectPnLInput,exits:e.exits,entries:e.entries}))return null;let U=iI(e);if(!U.isPartialExit)return null;let j=U.realizedPnL,R=xt(j,void 0,e.riskAmount,z);return qe.default.createElement("div",{className:"calculatedValue"},qe.default.createElement("span",{className:"calculatedLabel"},"Realized P&L (",U.closedSize,"/",U.totalSize," closed)"),qe.default.createElement("span",{className:`calculatedAmount ${j>0?"positive":j<0?"negative":"neutral"}`},ye(j,!0,i,M,R)))})())},fZ=qe.default.memo(OIe)});var yI,oB,gZ=F(()=>{yI=Y(Q());uX();aB();oB=({data:e,errors:t,onChange:r,instruments:n})=>yI.default.createElement("div",{className:"trade-form-basic-tab"},yI.default.createElement(dX,{data:e,onChange:r}),yI.default.createElement(fZ,{data:e,errors:t,onChange:r,instruments:n}))});var Co,zIe,hZ,sB=F(()=>{Co=Y(Q());Id();Rx();_T();rh();qi();zIe=({data:e,errors:t,onChange:r,accounts:n=[],setups:i=[],mistakes:a=[]})=>{let[o,s]=(0,Co.useState)(0),l=(0,Co.useMemo)(()=>{let v=Hi().plugins.plugins.journalit;return v&&v.optionsService?v.optionsService:new Go(v)},[]),c=(0,Co.useMemo)(()=>{try{return l.getOptions("tag")}catch(v){return console.error("Failed to load custom tag options:",v),[]}},[l,o]),d=(0,Co.useMemo)(()=>{try{return l.getOptions("setup")}catch(v){return console.error("Failed to load setup options:",v),[]}},[l,o]),u=(0,Co.useMemo)(()=>{try{return l.getOptions("mistake")}catch(v){return console.error("Failed to load mistake options:",v),[]}},[l,o]),p=(0,Co.useCallback)(()=>{s(v=>v+1)},[]);Xe("options:changed",p);let m=async v=>{try{let h=Hi().plugins.plugins.journalit,y=h?h.optionsService:new Go(h);await y.addOption("tag",v)&&y.notifyOptionsChanged()}catch(h){console.error("Failed to save custom tag option:",h)}},g=async v=>{try{let h=Hi().plugins.plugins.journalit,y=h?h.optionsService:new Go(h);await y.addOption("setup",v)&&y.notifyOptionsChanged()}catch(h){console.error("Failed to save custom setup option:",h)}},f=async v=>{try{let h=Hi().plugins.plugins.journalit,y=h?h.optionsService:new Go(h);await y.addOption("mistake",v)&&y.notifyOptionsChanged()}catch(h){console.error("Failed to save custom mistake option:",h)}};return Co.default.createElement(Qg,{title:"Analysis & Thesis"},Co.default.createElement("div",{className:"field"},Co.default.createElement(Xs,{label:"Setup",options:d,value:Array.isArray(e.setup)?e.setup:[],onChange:v=>{let h=Array.isArray(v)?v:[];r("setup",h)},allowCreate:!0,isMulti:!0,optionType:"setup",onSaveOption:g})),Co.default.createElement("div",{className:"field"},Co.default.createElement(Xs,{label:"Mistake",options:u,value:Array.isArray(e.mistake)?e.mistake:[],onChange:v=>{let h=Array.isArray(v)?v:[];r("mistake",h)},allowCreate:!0,isMulti:!0,optionType:"mistake",onSaveOption:f})),Co.default.createElement("div",{className:"field"},Co.default.createElement(Xs,{label:"Custom Tags",options:c,value:Array.isArray(e.customTags)?e.customTags:[],onChange:v=>{let h=Array.isArray(v)?v:[];r("customTags",h)},isMulti:!0,allowCreate:!0,placeholder:"Type a custom tag and press Enter",onSaveOption:m,optionType:"tag"})),Co.default.createElement("div",{className:"field"},Co.default.createElement(qa,{label:"Trade Thesis",placeholder:"Enter your thesis for this trade...",value:e.thesis||"",onChange:v=>r("thesis",v),className:"thesisField",multiline:!0})))},hZ=Co.default.memo(zIe)});var zp,lB,vi,Ad=F(()=>{zp=require("obsidian");_T();lB=class{constructor(t){this.app=t||Hi()}async saveImage(t,r,n,i){try{let a=t!=null&&t.name?t.name.replace(/[^a-zA-Z0-9.-]/g,"_"):"unnamed_file",o=a.substring(a.lastIndexOf(".")||a.length),s=Date.now(),l;if(i){let{year:d,month:u,weekOfMonth:p}=i,m=`${r}/${d}/${u}/${p}`,g=`${n}-${s}${o}`;l=`${m}/${g}`,await this.app.vault.adapter.mkdir((0,zp.normalizePath)(m))}else{let d=`${n}-${s}${o}`;l=`${r}/${d}`,await this.app.vault.adapter.mkdir((0,zp.normalizePath)(r))}let c=await t.arrayBuffer();return await this.app.vault.createBinary((0,zp.normalizePath)(l),c),l}catch(a){throw console.error("Error saving image:",a),a}}async deleteImage(t,r=!0){try{if(!t){console.warn("No image path provided for deletion");return}let n=this.app.vault.getAbstractFileByPath(t);if(!n){console.warn(`Image file not found: ${t}`);return}if(await this.app.vault.delete(n),r){let i=t.substring(0,t.lastIndexOf("/"));await this.deleteEmptyFolder(i)}}catch(n){if(n&&typeof n=="object"&&"code"in n&&n.code==="ENOENT"){console.log(`Image file already deleted or doesn't exist: ${t}`);return}throw console.error(`Error deleting image ${t}:`,n),n}}async deleteEmptyFolder(t,r="!"){try{if(t.startsWith(r)&&t.split("/").length<=1||!await this.app.vault.adapter.exists(t))return;let i=await this.app.vault.adapter.list(t);if(i.files.length===0&&i.folders.length===0){let a=this.app.vault.getAbstractFileByPath(t);if(a){await this.app.vault.delete(a);let o=t.substring(0,t.lastIndexOf("/"));o&&o.length>0&&!o.startsWith(r)&&await this.deleteEmptyFolder(o,r)}}}catch(n){console.error(`Error deleting empty folder ${t}:`,n)}}resolveMediaPath(t){if(!t)return"";if(t.startsWith("http://")||t.startsWith("https://")||t.startsWith("data:"))return t;try{let r=this.getResourceUrl(t);if(r&&r!==t&&!r.includes("app://obsidian.md"))return r;let n="",i="",a=t.split("/"),o=a.findIndex(s=>s==="media"||s==="attachments");if(o>=0&&o<a.length-1&&(a[o]==="attachments"&&a.length>o+5?(n=a.slice(o+1,a.length-1).join("/"),i=a[a.length-1]):o<a.length-2&&(n=a[o+1],i=a[a.length-1])),n&&i){let s=[t.startsWith("!")?t.substring(1):t,t,`attachments/${n}/${i}`,`${this.app.vault.getName()}/attachments/${n}/${i}`,`${this.app.vault.getName()}/${a.slice(1).join("/")}`,`Journalit/${a.slice(a.indexOf("Journalit")+1).join("/")}`,`${this.app.vault.getName()}/media/${n}/${i}`,`media/${n}/${i}`];for(let l of s){let c=this.app.vault.getAbstractFileByPath(l);if(c&&c instanceof zp.TFile)return this.app.vault.getResourcePath(c)}}return r}catch(r){return console.error("Error resolving media path:",r,t),this.getResourceUrl(t)}}getResourceUrl(t){if(!t)return"";try{if(t.startsWith("http://")||t.startsWith("https://")||t.startsWith("data:"))return t;let r=this.app.vault.getAbstractFileByPath(t);if(r&&r instanceof zp.TFile)return this.app.vault.getResourcePath(r);if(t.startsWith("!")){let a=t.substring(1);if(r=this.app.vault.getAbstractFileByPath(a),r&&r instanceof zp.TFile)return this.app.vault.getResourcePath(r)}let n=/\/media\/([^/]+)\//,i=t.match(n);if(i){let a=i[1],o=/(20\d{2})\/(\d{2})\/(W\d+)\//,s=t.match(o);if(s){let l=s[1],c=s[2],d=s[3],u=[`${l}/${c}/${d}/media/${a}${t.substring(t.lastIndexOf("/"))}`];for(let p of u)if(r=this.app.vault.getAbstractFileByPath(p),r&&r instanceof zp.TFile)return this.app.vault.getResourcePath(r)}}try{let a=this.app.vault.getName();if(a){let o=[t.startsWith("!")?`${a}/${t.substring(1)}`:`${a}/${t}`,`${a}/${t}`];for(let s of o)if(r=this.app.vault.getAbstractFileByPath(s),r&&r instanceof zp.TFile)return this.app.vault.getResourcePath(r)}}catch(a){}return t.startsWith("!")?`app://obsidian.md/${t.substring(1)}`:`app://obsidian.md/${t}`}catch(r){return console.error("Error getting resource URL:",r),t||""}}getImagesFromDataTransfer(t){try{return!t.files||t.files.length===0?[]:Array.from(t.files).filter(i=>i.type.startsWith("image/")||i.name.match(/\.(jpg|jpeg|png|gif|bmp|webp)$/i))}catch(r){return console.error("Error extracting images from drop event:",r),[]}}},vi=new lB});var vZ,Be,Bu=F(()=>{vZ=require("obsidian"),Be=class e{static getErrorMessage(t,r){let n=r.statusCode||e.extractStatusCode(t),i=r.endpoint||"";if(n===401)return"Your session has expired. Please sign in again in plugin settings.";if(n===404)return i.includes("/ftp-users/")?"FTP account not found. The system will automatically create one for you.":i.includes("/trades")||i.includes("/mt-accounts")?"No trading data found. Please ensure your MetaTrader account is properly connected and has trade history.":"Unable to connect to trading data service. Please check your internet connection.";if(n===400)return r.operation.includes("verification")||r.operation.includes("auth")?"Invalid verification code. Please check the code and try again.":r.operation.includes("registration")||r.operation.includes("vault")?"Invalid registration data. Please check your settings and try again.":"Invalid request. Please check your input and try again.";if(n===403)return"Access denied. Please check your account permissions or contact support.";if(n===429)return"Too many requests. Please wait a moment before trying again.";if(n&&n>=500)return n===503?"Trading data service is temporarily unavailable. Please try again in a few minutes.":"Server error occurred. Please try again later or contact support if the problem persists.";if(e.isNetworkError(t))return"Cannot connect to trading data service. Please check your internet connection and try again.";if(r.operation.includes("clipboard")||r.operation.includes("paste"))return e.getClipboardErrorMessage(t,r);if(r.operation.includes("custom fields")||r.operation.includes("field"))return e.getSettingsErrorMessage(t,r);if(r.operation.includes("options")||r.operation.includes("dropdown"))return e.getOptionsErrorMessage(t,r);let a=(t==null?void 0:t.message)||"Unknown error occurred";return a.includes("API Error:")?a.replace(/^API Error: \d+ /,""):"An unexpected error occurred. Please try again or contact support if the problem persists."}static showError(t,r){let n=e.getErrorMessage(t,r),i=r.statusCode||e.extractStatusCode(t),a=5e3,o="\u26A0\uFE0F";i===401?(a=8e3,o="\u{1F510}"):i&&i>=500?(a=8e3,o="\u274C"):e.isNetworkError(t)&&(a=6e3,o="\u{1F4E1}"),new vZ.Notice(`${o} ${n}`,a)}static logError(t,r){let n=r.statusCode||e.extractStatusCode(t),i=n&&n>=500||e.isNetworkError(t)?"error":"warn",a=`${r.operation} failed`,o={statusCode:n,endpoint:r.endpoint,error:(t==null?void 0:t.message)||t,stack:t==null?void 0:t.stack};i==="error"?console.error(a,o):console.warn(a,o)}static handleError(t,r){if(e.shouldSuppressNotification(t,r)){e.logError(t,r);return}e.showError(t,r),e.logError(t,r)}static isNetworkError(t){var i,a;if(!t)return!1;let r=((i=t.name)==null?void 0:i.toLowerCase())||"",n=((a=t.message)==null?void 0:a.toLowerCase())||"";return r==="typeerror"||n.includes("fetch")||n.includes("network")||n.includes("connection")||n.includes("timeout")}static extractStatusCode(t){if(typeof t=="object"&&t.status)return t.status;let n=((t==null?void 0:t.message)||"").match(/API Error: (\d+)/);return n?parseInt(n[1],10):void 0}static shouldSuppressNotification(t,r){let n=e.extractStatusCode(t),i=r.operation.toLowerCase();return!!((n===401||n===400)&&(i.includes("vault registration")||i.includes("sync status"))||(n===400||n===429)&&i.includes("verify authentication code"))}static getSettingsErrorMessage(t,r){var a;let n=((a=t==null?void 0:t.message)==null?void 0:a.toLowerCase())||"",i=r.operation.toLowerCase();return n.includes("pattern")||n.includes("regex")?"Invalid validation pattern. Please check your regular expression and try again.":n.includes("field key")&&n.includes("already in use")?"This field name conflicts with an existing field. Please choose a different name.":n.includes("field key")||n.includes("invalid")?"Invalid field name. Field names can only contain letters, numbers, and underscores.":i.includes("save")||i.includes("update")?"Unable to save your changes. Please check your settings and try again.":i.includes("load")?"Unable to load custom field settings. Your custom fields may not display correctly.":i.includes("import")?"Unable to import field settings. Please check the file format and try again.":i.includes("add")||i.includes("create")?"Unable to create the custom field. Please check your input and try again.":i.includes("remove")||i.includes("delete")?"Unable to remove the custom field. Please try again.":"An error occurred while managing custom fields. Please check your settings and try again."}static getOptionsErrorMessage(t,r){var a;let n=((a=t==null?void 0:t.message)==null?void 0:a.toLowerCase())||"",i=r.operation.toLowerCase();return n.includes("duplicate")||n.includes("already exists")?"This option already exists. Please choose a different name.":n.includes("ticker format")||n.includes("invalid ticker")?"Invalid ticker symbol. Use only letters, numbers, and periods (e.g., AAPL, SPX).":i.includes("add")?i.includes("instrument")||i.includes("ticker")?"Unable to add ticker symbol. Please check the format and try again.":"Unable to add option. It may already exist or be invalid.":i.includes("update")||i.includes("edit")?"Unable to update option. It may already exist or be invalid.":i.includes("remove")||i.includes("delete")?"Unable to remove option. Please try again.":i.includes("reset")&&n.includes("no options")?"No options to reset. The category is already empty.":i.includes("reset")?"Unable to reset options. Please try again.":i.includes("save")||i.includes("load")?"Unable to save option changes. Please check your settings and try again.":"An error occurred while managing options. Please try again."}static getClipboardErrorMessage(t,r){var a;let n=((a=t==null?void 0:t.message)==null?void 0:a.toLowerCase())||"",i=r.operation.toLowerCase();return(t==null?void 0:t.name)==="NotAllowedError"||n.includes("permission")||i.includes("permission")?"Clipboard access denied. Please allow clipboard permissions in your browser for paste functionality.":i.includes("clipboard access")&&(n.includes("not supported")||n.includes("undefined"))?"Clipboard paste is not supported in your browser. Try using Ctrl+V or Cmd+V instead.":i.includes("size validation")||n.includes("exceeds limit")?"Image is too large to paste. Please use images smaller than 10MB.":i.includes("content check")?"Nothing found in clipboard to paste. Try copying an image first.":i.includes("image extraction")?"No images found in clipboard. Make sure you copied an image, not text or other content.":i.includes("target detection")?"No image upload area found. Click on an image upload area first, then paste your image.":i.includes("paste operation")||i.includes("global paste")?n.includes("failed to fetch")||n.includes("network")?"Network error occurred while processing paste. Please check your connection and try again.":"Unable to complete paste operation. Please try copying the image again and pasting.":"Clipboard operation failed. Please try copying your content again and pasting."}static createContext(t,r,n){return{operation:t,endpoint:r,statusCode:n}}}});var yZ,Po,bI=F(()=>{yZ=require("obsidian");Bu();Po=class{static isClipboardSupported(){return typeof navigator!="undefined"&&!!navigator.clipboard&&!!navigator.clipboard.read}static async extractClipboardImages(){if(!this.isClipboardSupported()){let t={operation:"clipboard access",originalError:new Error("Clipboard API not supported")};return{success:!1,files:[],error:Be.getErrorMessage(new Error("Clipboard API not supported"),t)}}try{let t=await navigator.clipboard.read();if(!t||t.length===0){let n={operation:"clipboard content check"};return{success:!1,files:[],error:"Nothing found in clipboard to paste"}}let r=[];for(let n of t)for(let i of this.SUPPORTED_FORMATS)if(n.types.includes(i))try{let a=await n.getType(i);if(a.size>this.MAX_FILE_SIZE){let s={operation:"image size validation"},l=new Error(`File size ${(a.size/1024/1024).toFixed(1)}MB exceeds limit`);Be.showError(l,s);continue}let o=new File([a],this.generateFileName(i),{type:i,lastModified:Date.now()});r.push(o)}catch(a){console.error(`Failed to extract ${i} from clipboard:`,a)}if(r.length===0){let n={operation:"clipboard image extraction"};return{success:!1,files:[],error:"No images found in clipboard. Try copying an image first."}}return{success:!0,files:r}}catch(t){if(console.error("Failed to read clipboard:",t),t.name==="NotAllowedError"||t.message.includes("permission")){let n={operation:"clipboard permission request",originalError:t};return{success:!1,files:[],error:Be.getErrorMessage(t,n),permissionDenied:!0}}let r={operation:"clipboard access",originalError:t};return{success:!1,files:[],error:Be.getErrorMessage(t,r)}}}static generateContextualFileName(t,r,n=0){var s,l,c,d,u,p,m,g;let i=Date.now(),a=this.getExtensionFromFormat(r);switch(t.contextType){case"trade":if((s=t.contextData)!=null&&s.ticker&&((l=t.contextData)!=null&&l.tradeNumber)){let v=n>0?`-${n}`:"";return`${t.contextData.ticker}-clipboard-T${t.contextData.tradeNumber}${v}-${i}${a}`}break;case"drc":if((c=t.contextData)!=null&&c.sectionName){let v=n>0?`-${n}`:"";return`drc-${t.contextData.sectionName}-clipboard${v}-${i}${a}`}break;case"weekly":if((d=t.contextData)!=null&&d.weekNumber){let v=n>0?`-${n}`:"";return`weekly-W${t.contextData.weekNumber}-clipboard${v}-${i}${a}`}break;case"monthly":if((u=t.contextData)!=null&&u.monthNumber){let v=n>0?`-${n}`:"";return`monthly-${t.contextData.monthNumber}-clipboard${v}-${i}${a}`}break;case"quarterly":if((p=t.contextData)!=null&&p.quarterNumber){let v=n>0?`-${n}`:"";return`quarterly-Q${t.contextData.quarterNumber}-clipboard${v}-${i}${a}`}break;case"yearly":if((m=t.contextData)!=null&&m.date){let v=new Date(t.contextData.date).getFullYear(),h=n>0?`-${n}`:"";return`yearly-${v}-clipboard${h}-${i}${a}`}break;case"account":if((g=t.contextData)!=null&&g.accountId){let v=n>0?`-${n}`:"";return`account-${t.contextData.accountId}-clipboard${v}-${i}${a}`}break;default:return`clipboard-image${n>0?`-${n}`:""}-${i}${a}`}return`clipboard-image${n>0?`-${n}`:""}-${i}${a}`}static generateFileName(t){let r=Date.now(),n=this.getExtensionFromFormat(t);return`clipboard-image-${r}${n}`}static getExtensionFromFormat(t){switch(t){case"image/png":return".png";case"image/jpeg":return".jpg";case"image/gif":return".gif";case"image/bmp":return".bmp";case"image/webp":return".webp";default:return".png"}}static findImageUploadContext(t){if(!t)return null;let r=t.closest(".journalit-image-upload, .shared-forecast-image, .trade-form-metadata");if(!r)return null;if(r.classList.contains("trade-form-metadata"))return{contextType:"trade",multiple:!0};if(r.classList.contains("shared-forecast-image")){let n=r.closest("[data-section-name]");if(n)return{contextType:"drc",contextData:{sectionName:n.getAttribute("data-section-name")||void 0},multiple:!1}}return{contextType:"generic",multiple:!0}}static showPasteResult(t,r=0){if(t.success&&r>0){let n=r===1?"\u{1F4CB} Image pasted successfully":`\u{1F4CB} ${r} images pasted successfully`;new yZ.Notice(n)}else if(!t.success&&t.error)if(t.permissionDenied){let n={operation:"clipboard permission request"};Be.showError(new Error("Permission denied"),n)}else{let n={operation:"paste operation"};Be.showError(new Error(t.error),n)}}static createContextualFiles(t,r){return t.map((n,i)=>{let a=this.generateContextualFileName(r,n.type,i);return new File([n],a,{type:n.type,lastModified:n.lastModified})})}};Po.MAX_FILE_SIZE=10*1024*1024,Po.SUPPORTED_FORMATS=["image/png","image/jpeg","image/gif","image/bmp","image/webp"]});var xI,jp,wI=F(()=>{bI();Bu();xI=class xI{constructor(){this.handlers=[];this.enabled=!1;this.globalPasteListener=null;this.lastMousePosition={x:0,y:0};this.mouseMoveListener=null}static getInstance(){return this.instance||(this.instance=new xI),this.instance}initialize(){this.enabled||(this.enabled=!0,this.globalPasteListener=t=>{this.handleGlobalPaste(t)},this.mouseMoveListener=t=>{this.lastMousePosition={x:t.clientX,y:t.clientY}},document.addEventListener("paste",this.globalPasteListener,!0),document.addEventListener("mousemove",this.mouseMoveListener,!0))}cleanup(){this.enabled&&(this.enabled=!1,this.globalPasteListener&&(document.removeEventListener("paste",this.globalPasteListener,!0),this.globalPasteListener=null),this.mouseMoveListener&&(document.removeEventListener("mousemove",this.mouseMoveListener,!0),this.mouseMoveListener=null),this.handlers=[])}registerHandler(t){this.handlers=this.handlers.filter(r=>r.id!==t.id),this.handlers.push(t)}unregisterHandler(t){this.handlers=this.handlers.filter(r=>r.id!==t)}async handleGlobalPaste(t){if(!Po.isClipboardSupported())return;let r=document.activeElement;if(this.isTextInput(r)&&!this.isImageUploadArea(r))return;let n=this.findHandlerForContext(r);if(!n){try{let i=await Po.extractClipboardImages();if(i.success&&i.files.length>0&&!this.handlers.some(o=>{let s=o.element.getBoundingClientRect();return s.width>0&&s.height>0&&window.getComputedStyle(o.element).visibility!=="hidden"&&window.getComputedStyle(o.element).display!=="none"})){let o={operation:"paste target detection"},s=new Error("No image upload area available");Be.showError(s,o)}}catch(i){}return}t.preventDefault(),t.stopPropagation();try{let i=await Po.extractClipboardImages();if(!i.success){i.error&&!i.error.includes("No images found")&&Po.showPasteResult(i);return}let a=Po.createContextualFiles(i.files,n.context),o=n.acceptsMultiple?a:[a[0]];await n.handlePaste(o),Po.showPasteResult(i,o.length),this.dispatchPasteEvent({files:o,context:{element:n.element,contextType:n.context.contextType,contextData:n.context.contextData},success:!0})}catch(i){console.error("Global paste handler error:",i),this.dispatchPasteEvent({files:[],context:{element:n.element,contextType:n.context.contextType,contextData:n.context.contextData},success:!1,error:i.message});let a={operation:"global paste handling",originalError:i};Be.showError(i,a)}}findHandlerForContext(t){if(t){for(let o of this.handlers)if(o.element.contains(t)||o.element===t)return o;let a=this.findNearbyImageUploadArea(t);if(a)return this.handlers.find(o=>o.element===a||o.element.contains(a))||null}let r=this.findHandlerUnderMouse();if(r)return r;let n=this.handlers.filter(a=>{let o=a.element,s=o.getBoundingClientRect();return s.width>0&&s.height>0&&window.getComputedStyle(o).visibility!=="hidden"&&window.getComputedStyle(o).display!=="none"});if(n.length===1)return n[0];let i=this.findHoveredHandler();return i||null}isTextInput(t){var i;if(!t)return!1;let r=t.tagName.toLowerCase(),n=(i=t.type)==null?void 0:i.toLowerCase();return r==="input"&&["text","email","password","search","url"].includes(n)||r==="textarea"||t.hasAttribute("contenteditable")||t.classList.contains("cm-editor")}isImageUploadArea(t){return t?!!(t.closest(".journalit-image-upload")||t.closest(".shared-forecast-image")||t.closest(".trade-form-metadata")||t.closest("[data-image-upload]")):!1}findHandlerUnderMouse(){let t=document.elementsFromPoint(this.lastMousePosition.x,this.lastMousePosition.y);for(let r of t)for(let n of this.handlers)if(n.element===r||n.element.contains(r))return n;return null}findHoveredHandler(){for(let t of this.handlers){let n=t.element.getBoundingClientRect();if(n.width>0&&n.height>0&&this.lastMousePosition.x>=n.left&&this.lastMousePosition.x<=n.right&&this.lastMousePosition.y>=n.top&&this.lastMousePosition.y<=n.bottom)return t}return null}findNearbyImageUploadArea(t){if(!t)return null;let r=t.closest(".trade-form, .drc-note, .weekly-review, .account-note, .modal-content, .workspace-leaf-content");return r?r.querySelector(".journalit-image-upload, .shared-forecast-image, .trade-form-metadata"):null}dispatchPasteEvent(t){let r=new CustomEvent("journalit:paste",{detail:t,bubbles:!0,cancelable:!1});document.dispatchEvent(r)}static createImageUploaderHandler(t,r,n,i=!0){return{id:`image-uploader-${Date.now()}-${Math.random().toString(36).substring(2,11)}`,element:t,context:r,handlePaste:n,acceptsMultiple:i}}static isPasteSupported(){return Po.isClipboardSupported()}getDebugInfo(){return{enabled:this.enabled,handlerCount:this.handlers.length,handlers:this.handlers.map(t=>({id:t.id,contextType:t.context.contextType,acceptsMultiple:t.acceptsMultiple}))}}};xI.instance=null;jp=xI});var un,kI,cB=F(()=>{un=Y(Q());Ot();Ad();bI();wI();kI=({onImageUploaded:e,onMultipleImagesUploaded:t,onError:r,label:n="Upload Image",enableDragDrop:i=!0,draggingOverClass:a="dragging-over",inputId:o,saveImageFunction:s,multiple:l=!0,enablePaste:c=!1,pasteContext:d,className:u="",style:p})=>{let m=(0,un.useRef)(`image-upload-${Math.random().toString(36).substring(2,11)}`),g=o||m.current,[f,v]=(0,un.useState)(!1),h=(0,un.useRef)(0),y=(0,un.useRef)(null),[b,k]=(0,un.useState)(!1),[x,S]=(0,un.useState)(!1),w=(0,un.useRef)(new Set),C=(0,un.useRef)(s),D=(0,un.useRef)(e),P=(0,un.useRef)(t),M=(0,un.useRef)(r),z=(0,un.useRef)(void 0);(0,un.useEffect)(()=>{C.current=s,D.current=e,P.current=t,M.current=r},[s,e,t,r]),(0,un.useEffect)(()=>()=>{w.current.forEach(N=>{URL.revokeObjectURL(N)}),w.current.clear()},[]);let A=(0,un.useCallback)(async()=>{if(!(!c||b)){k(!0);try{let N=await Po.extractClipboardImages();if(!N.success){N.error&&!N.error.includes("No images found")&&Po.showPasteResult(N);return}let U=d||{contextType:"generic",multiple:l},j=Po.createContextualFiles(N.files,U),R=[],O=l?j:[j[0]];for(let H of O)try{let q;C.current?(q=await C.current(H),R.push(q)):(console.warn("No saveImageFunction provided, using placeholder implementation"),q=I(H),R.push(q))}catch(q){console.error(`Failed to process pasted image ${H.name}:`,q),M.current&&q instanceof Error&&M.current(q)}l&&R.length>1&&P.current?P.current(R):R.length>0&&D.current&&D.current(R[0]),Po.showPasteResult(N,R.length)}catch(N){console.error("Failed to handle paste:",N),M.current&&N instanceof Error&&M.current(N)}finally{k(!1)}}},[c,b,d,l]);(0,un.useEffect)(()=>{z.current=A},[A]),(0,un.useEffect)(()=>{if(!c||!y.current||!Po.isClipboardSupported())return;if(S(!0),(d==null?void 0:d.contextType)==="trade"){let U=d||{contextType:"generic",multiple:l},j=jp.createImageUploaderHandler(y.current,U,async R=>{let O=[];for(let H of R)try{let q;C.current?(q=await C.current(H),O.push(q)):(console.warn("No saveImageFunction provided, using placeholder implementation"),q=I(H),O.push(q))}catch(q){console.error(`Failed to process pasted image ${H.name}:`,q),M.current&&q instanceof Error&&M.current(q)}l&&O.length>1&&P.current?P.current(O):O.length>0&&D.current&&D.current(O[0])},l);return jp.getInstance().registerHandler(j),()=>{jp.getInstance().unregisterHandler(j.id)}}else{let U=R=>{var O;R.preventDefault(),R.stopPropagation(),(O=z.current)==null||O.call(z)},j=y.current;return j.addEventListener("paste",U),()=>{j.removeEventListener("paste",U)}}},[c,d,l]);let I=N=>{let U=URL.createObjectURL(N);return w.current.add(U),U},L=async N=>{try{let U=N.target.files;if(!U||U.length===0)return;let j=[],R=l?U:[U[0]];for(let O=0;O<R.length;O++){let H=R[O],q;if(s)try{q=await s(H),j.push(q)}catch(V){console.error(`Failed to process image ${H.name}:`,V),r&&V instanceof Error&&r(V)}else console.warn("No saveImageFunction provided, using placeholder implementation"),q=I(H),j.push(q)}l&&j.length>1&&t?t(j):j.length>0&&e(j[0]),N.target.value=""}catch(U){console.error("Failed to process images:",U),r&&U instanceof Error&&r(U)}},E=N=>{i&&(N.preventDefault(),N.stopPropagation(),h.current++,N.dataTransfer.types.includes("Files")&&v(!0))},T=N=>{i&&(N.preventDefault(),N.stopPropagation(),h.current--,h.current<=0&&(h.current=0,v(!1)))},$=N=>{i&&(N.preventDefault(),N.stopPropagation())},_=async N=>{if(i&&(N.preventDefault(),N.stopPropagation(),h.current=0,v(!1),N.dataTransfer.files&&N.dataTransfer.files.length>0)){let U=vi.getImagesFromDataTransfer(N.dataTransfer);if(U.length>0){let j=[],R=l?U:[U[0]];for(let O of R)try{let H;s?(H=await s(O),j.push(H)):(console.warn("No saveImageFunction provided, using placeholder implementation"),H=I(O),j.push(H))}catch(H){console.error(`Failed to process dropped image ${O.name}:`,H),r&&H instanceof Error&&r(H)}l&&j.length>1&&t?t(j):j.length>0&&e(j[0])}}},B=()=>{let N=document.getElementById(g);N&&N.click()},W=["journalit-image-upload",u,f?a:""].filter(Boolean).join(" ");return un.default.createElement("div",{ref:y,className:`journalit-image-upload-wrapper ${u}`,style:p,tabIndex:c?0:-1},un.default.createElement("div",{className:"journalit-image-upload-layout"},un.default.createElement("div",{className:`journalit-image-upload-file-area ${f?a:""} ${!c||!x?"full-width":""}`,onClick:B,onDragEnter:E,onDragLeave:T,onDragOver:$,onDrop:_},un.default.createElement("label",{className:"journalit-image-upload-label"},n)),c&&x&&un.default.createElement("button",{type:"button",className:`journalit-image-upload-paste-area ${b?"pasting":""}`,onClick:N=>{N.preventDefault(),N.stopPropagation(),A()},disabled:b,title:"Paste image from clipboard (Ctrl+V)"},b?un.default.createElement(un.default.Fragment,null,un.default.createElement("span",{className:"journalit-spinner"}),un.default.createElement("span",{className:"paste-text"},"Pasting...")):un.default.createElement(un.default.Fragment,null,un.default.createElement(Bv,{className:"paste-icon",size:18}),un.default.createElement("span",{className:"paste-text"},"Paste")))),un.default.createElement("input",{id:g,type:"file",accept:"image/*",multiple:l,onChange:L,className:"journalit-image-upload-input"}))}});var pc,bZ,_p,ly=F(()=>{pc=Y(Q()),bZ=Y(Td()),_p=({isOpen:e,children:t,portalId:r="journalit-fullscreen-portal",onClose:n,title:i="Image Preview",className:a=""})=>{let[o,s]=(0,pc.useState)(null),l=(0,pc.useRef)(null),c=(0,pc.useRef)(e);if(c.current=e,(0,pc.useEffect)(()=>{if(!e)return;let u=document.getElementById(r);u||(u=document.createElement("div"),u.id=r,u.className="journalit-fullscreen-portal-container",document.body.appendChild(u)),s(u),l.current=u;let p=m=>{m.key==="Escape"&&(m.preventDefault(),m.stopPropagation(),m.stopImmediatePropagation(),n())};return document.addEventListener("keydown",p,!0),()=>{document.removeEventListener("keydown",p,!0),!c.current&&u&&u.parentNode&&setTimeout(()=>{let m=document.getElementById(r);if(m&&m.parentNode&&m.childNodes.length===0)try{m.parentNode.removeChild(m)}catch(g){console.error(`[FullscreenPortal] Error removing portal element ${r}:`,g)}},0)}},[e,r,n]),!e||!o)return null;let d=["journalit-fullscreen-overlay",a].filter(Boolean).join(" ");return bZ.default.createPortal(pc.default.createElement("div",{className:d,onClick:n},pc.default.createElement("div",{className:"journalit-fullscreen-overlay-ui"},pc.default.createElement("div",{className:"journalit-fullscreen-title",onClick:u=>u.stopPropagation()},i),pc.default.createElement("button",{className:"journalit-fullscreen-close-btn",onClick:u=>{u.stopPropagation(),n()},"aria-label":"Close fullscreen"},"\xD7")),pc.default.createElement("div",{className:"journalit-fullscreen-content-wrapper"},pc.default.createElement("div",{className:"journalit-fullscreen-content"},t))),o)}});var ai,pf,Xx=F(()=>{ai=Y(Q());Ad();pf=({imagePath:e,alt:t="Image",useResolveMediaPath:r=!1,navigationContext:n,onClose:i})=>{let[a,o]=(0,ai.useState)({isZoomed:!1,scale:1,panOffset:{x:0,y:0},isPanning:!1,lastMousePos:{x:0,y:0},initialPinchDistance:null,initialPinchScale:1}),s=(0,ai.useRef)(null),l=(0,ai.useRef)(null),c=r?vi.resolveMediaPath(e):vi.getResourceUrl(e);(0,ai.useEffect)(()=>{o({isZoomed:!1,scale:1,panOffset:{x:0,y:0},isPanning:!1,lastMousePos:{x:0,y:0},initialPinchDistance:null,initialPinchScale:1})},[e]);let d=(0,ai.useCallback)(C=>{C.preventDefault(),C.stopPropagation(),!a.isPanning&&o(D=>{let P=!D.isZoomed;return{...D,isZoomed:P,scale:P?2:1,panOffset:{x:0,y:0},isPanning:!1}})},[a.isPanning]),u=(0,ai.useCallback)(C=>{a.scale<=1||(C.preventDefault(),C.stopPropagation(),o(D=>({...D,isPanning:!0,lastMousePos:{x:C.clientX,y:C.clientY}})))},[a.scale]),p=(0,ai.useCallback)(()=>{o(C=>({...C,isPanning:!1}))},[]),m=(0,ai.useCallback)(C=>{if(!n)return;let{images:D,currentIndex:P,onNavigate:M}=n,z=P;C==="prev"?z=P===0?D.length-1:P-1:z=P===D.length-1?0:P+1,M(z)},[n]);(0,ai.useEffect)(()=>{let C=D=>{D.key==="ArrowLeft"?(D.preventDefault(),D.stopPropagation(),m("prev")):D.key==="ArrowRight"&&(D.preventDefault(),D.stopPropagation(),m("next"))};return document.addEventListener("keydown",C),()=>document.removeEventListener("keydown",C)},[m]);let g=(0,ai.useCallback)(C=>{o(D=>{if(!D.isPanning||D.scale<=1)return D;let P=C.clientX-D.lastMousePos.x,M=C.clientY-D.lastMousePos.y,z=.8,A=P*z,I=M*z;return{...D,panOffset:{x:D.panOffset.x+A,y:D.panOffset.y+I},lastMousePos:{x:C.clientX,y:C.clientY}}})},[]),f=(0,ai.useCallback)(()=>{o(C=>({...C,isPanning:!1}))},[]);(0,ai.useEffect)(()=>{if(a.isPanning)return document.addEventListener("mousemove",g),document.addEventListener("mouseup",f),()=>{document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",f)}},[a.isPanning,g,f]);let v=(0,ai.useCallback)(C=>{if(C.length<2)return 0;let D=C[0].clientX-C[1].clientX,P=C[0].clientY-C[1].clientY;return Math.sqrt(D*D+P*P)},[]),h=(0,ai.useCallback)(C=>{if(C.touches.length===2){C.preventDefault();let D=v(C.touches);o(P=>({...P,initialPinchDistance:D,initialPinchScale:P.scale,isPanning:!1}))}else if(C.touches.length===1&&a.scale>1){C.preventDefault();let D=C.touches[0];o(P=>({...P,isPanning:!0,lastMousePos:{x:D.clientX,y:D.clientY}}))}},[v,a.scale]),y=(0,ai.useCallback)(C=>{if(C.touches.length===2&&a.initialPinchDistance!==null){C.preventDefault();let P=v(C.touches)/a.initialPinchDistance,M=Math.min(4,Math.max(1,a.initialPinchScale*P));o(z=>({...z,scale:M,isZoomed:M>1}))}else if(C.touches.length===1&&a.isPanning&&a.scale>1){C.preventDefault();let D=C.touches[0];o(P=>{if(!P.isPanning||P.scale<=1)return P;let M=D.clientX-P.lastMousePos.x,z=D.clientY-P.lastMousePos.y,A=.8;return{...P,panOffset:{x:P.panOffset.x+M*A,y:P.panOffset.y+z*A},lastMousePos:{x:D.clientX,y:D.clientY}}})}},[v,a.initialPinchDistance,a.initialPinchScale,a.isPanning,a.scale]),b=(0,ai.useCallback)(C=>{C.touches.length===0?o(D=>{let P=D.scale<1.1?1:D.scale;return{...D,initialPinchDistance:null,initialPinchScale:P,scale:P,isZoomed:P>1,isPanning:!1,panOffset:P<=1?{x:0,y:0}:D.panOffset}}):C.touches.length===1&&o(D=>{let P=D.scale<1.1?1:D.scale,M=C.touches[0];return{...D,initialPinchDistance:null,initialPinchScale:P,scale:P,isZoomed:P>1,isPanning:P>1,lastMousePos:{x:M.clientX,y:M.clientY},panOffset:P<=1?{x:0,y:0}:D.panOffset}})},[]),k=a.scale,x=`scale(${k}) translate(${a.panOffset.x/k}px, ${a.panOffset.y/k}px)`,S="zoom-in";a.scale>1&&(S=a.isPanning?"grabbing":"grab");let w=a.initialPinchDistance!==null;return ai.default.createElement("div",{className:"journalit-fullscreen-viewer",ref:l},n&&n.images.length>1&&ai.default.createElement(ai.default.Fragment,null,ai.default.createElement("button",{className:"journalit-fullscreen-nav-btn journalit-fullscreen-nav-prev",onClick:C=>{C.stopPropagation(),m("prev")},"aria-label":"Previous image",type:"button"},"\u2039"),ai.default.createElement("button",{className:"journalit-fullscreen-nav-btn journalit-fullscreen-nav-next",onClick:C=>{C.stopPropagation(),m("next")},"aria-label":"Next image",type:"button"},"\u203A")),ai.default.createElement("div",{className:"journalit-fullscreen-image-wrapper"},ai.default.createElement("img",{ref:s,src:c,alt:t,className:"journalit-fullscreen-zoomable-image",onClick:d,onMouseDown:u,onMouseUp:p,onMouseLeave:p,onTouchStart:h,onTouchMove:y,onTouchEnd:b,onTouchCancel:b,style:{transform:x,cursor:S,transition:a.isPanning||w?"none":"transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94)",willChange:a.isPanning||w?"transform":"auto"}})),ai.default.createElement("div",{className:"journalit-fullscreen-zoom-indicator"},a.scale>1?`${a.scale.toFixed(1)}x (pinch or click to zoom out)`:"Pinch or click to zoom in"),n&&n.images.length>1&&ai.default.createElement("div",{className:"journalit-fullscreen-nav-indicator"},n.currentIndex+1," / ",n.images.length))}});var SI,dB=F(()=>{SI=Y(Q());Ad();ly();Xx()});var Fl,xZ,wZ=F(()=>{Fl=Y(Q());Ad();xZ=({src:e,alt:t,className:r="",placeholderClassName:n="",style:i,useResolveMediaPath:a=!1,loadingPlaceholder:o,errorPlaceholder:s,rootMargin:l="50px",threshold:c=.1})=>{let[d,u]=(0,Fl.useState)(!1),[p,m]=(0,Fl.useState)(!1),[g,f]=(0,Fl.useState)(!1),v=(0,Fl.useRef)(null);(0,Fl.useEffect)(()=>{let k=v.current;if(!k)return;let x=new IntersectionObserver(S=>{let[w]=S;w.isIntersecting&&(u(!0),x.disconnect())},{rootMargin:l,threshold:c});return x.observe(k),()=>x.disconnect()},[l,c]);let h=d?a?vi.resolveMediaPath(e):vi.getResourceUrl(e):"",y=()=>{m(!0),f(!1)},b=()=>{f(!0),m(!1)};return Fl.default.createElement("div",{ref:v,className:`lazy-image-container ${r}`,style:{position:"relative",overflow:"hidden",...i}},(!d||!p)&&!g&&Fl.default.createElement("div",{className:`lazy-image-placeholder ${n}`},o||Fl.default.createElement("div",{style:{width:"100%",height:"100%",backgroundColor:"var(--background-modifier-border)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--text-muted)",fontSize:"12px"}},"Loading...")),g&&Fl.default.createElement("div",{className:`lazy-image-error ${n}`},s||Fl.default.createElement("div",{style:{width:"100%",height:"100%",backgroundColor:"var(--background-modifier-error)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--text-error)",fontSize:"12px"}},"Failed to load image")),d&&!g&&Fl.default.createElement("img",{src:h,alt:t,onLoad:y,onError:b,style:{position:"absolute",top:0,left:0,opacity:p?1:0,transition:"opacity 0.3s ease",width:"100%",height:"100%",objectFit:"cover"},className:"lazy-image-loaded"}))}});var ca,jIe,kZ,oh,SZ,TI=F(()=>{ca=Y(Q());Ad();wZ();ly();Xx();jIe={position:"absolute",top:"0.5rem",right:"0.5rem",background:"rgba(0, 0, 0, 0.6)",color:"white",border:"none",borderRadius:"50%",width:"28px",height:"28px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"16px",lineHeight:1,zIndex:10},kZ={position:"absolute",top:"50%",transform:"translateY(-50%)",background:"rgba(0, 0, 0, 0.5)",color:"white",border:"none",borderRadius:"50%",width:"32px",height:"32px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px",zIndex:10},oh=({images:e,altPrefix:t="Image",showThumbnails:r=!0,showCounter:n=!0,enableDelete:i=!1,onDeleteImage:a,enableFullscreen:o=!0,className:s="",style:l,useResolveMediaPath:c=!1})=>{let[d,u]=(0,ca.useState)(0),[p,m]=(0,ca.useState)(!1),[g,f]=(0,ca.useState)(!1);(0,ca.useEffect)(()=>{e&&e.length>0&&d>=e.length&&u(Math.max(0,e.length-1))},[e,d]);let v=A=>{A.preventDefault(),A.stopPropagation(),!(e.length<=1)&&u(I=>I===e.length-1?0:I+1)},h=A=>{A.preventDefault(),A.stopPropagation(),!(e.length<=1)&&u(I=>I===0?e.length-1:I-1)},y=(A,I)=>{I.preventDefault(),I.stopPropagation(),A>=0&&A<e.length&&u(A)},b=(A,I)=>{I&&(I.preventDefault(),I.stopPropagation()),a&&e[A]&&a(A,e[A])},k=()=>{m(!0)},x=()=>{o&&f(!0)},S=()=>{f(!1)},C={images:e,currentIndex:d,onNavigate:A=>{A>=0&&A<e.length&&u(A)},altPrefix:t,useResolveMediaPath:c},D=["journalit-image-carousel",s].filter(Boolean).join(" ");if(!e||e.length===0)return ca.default.createElement("div",{className:D,style:l},ca.default.createElement("div",{className:"journalit-carousel-main"},ca.default.createElement("div",{className:"journalit-carousel-image-container"},ca.default.createElement("div",{style:{textAlign:"center",padding:"20px",color:"var(--text-muted)"}},"No images to display"))));let P=e[d],M=`${t} ${d+1}`,z=c?vi.resolveMediaPath(P):vi.getResourceUrl(P);return ca.default.createElement("div",{className:D,style:l},ca.default.createElement("div",{style:{position:"relative"}},ca.default.createElement("img",{src:z,alt:M,onClick:x,onError:k,style:{width:"100%",borderRadius:"var(--radius-m)",cursor:o?"pointer":"default"}}),i&&ca.default.createElement("button",{onClick:A=>b(d,A),type:"button",style:jIe,title:"Delete image"},"\xD7"),e.length>1&&ca.default.createElement("button",{onClick:h,"aria-label":"Previous image",type:"button",style:{...kZ,left:"0.5rem"}},"\u2039"),e.length>1&&ca.default.createElement("button",{onClick:v,"aria-label":"Next image",type:"button",style:{...kZ,right:"0.5rem"}},"\u203A")),r&&e.length>1&&ca.default.createElement("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"center",marginTop:"0.5rem"}},e.map((A,I)=>ca.default.createElement(SZ,{key:`thumb-${I}`,imagePath:A,index:I,isActive:I===d,altPrefix:t,useResolveMediaPath:c,onClick:L=>y(I,L)}))),ca.default.createElement(_p,{isOpen:g,onClose:S,portalId:"journalit-carousel-fullscreen-portal"},ca.default.createElement(pf,{imagePath:P,alt:M,useResolveMediaPath:c,navigationContext:C,onClose:S})))},SZ=ca.default.memo(({imagePath:e,index:t,isActive:r,altPrefix:n,useResolveMediaPath:i,onClick:a})=>ca.default.createElement("div",{className:`journalit-carousel-thumbnail ${r?"active":""}`,onClick:a,title:`${n} ${t+1}`,style:{cursor:"pointer",border:r?"2px solid var(--interactive-accent)":"2px solid transparent",borderRadius:"4px",overflow:"hidden"}},ca.default.createElement(xZ,{src:e,alt:`Thumbnail ${t+1}`,useResolveMediaPath:i,style:{width:"60px",height:"60px"},rootMargin:"100px",threshold:.1})));SZ.displayName="LazyThumbnail"});var TZ=F(()=>{});var uB=F(()=>{cB();dB();TI();ly();TZ()});function CI(e){if(!e)return!1;try{let t=new URL(e);return t.hostname==="www.tradingview.com"||t.hostname==="tradingview.com"||t.hostname==="s3.tradingview.com"}catch(t){return!1}}function PI(e){if(!e)return null;try{let t=new URL(e);if(t.hostname==="s3.tradingview.com")return e;let r=t.pathname.match(/^\/x\/([a-zA-Z0-9]+)\/?$/);if(!r)return null;let n=r[1];return`https://s3.tradingview.com/snapshots/${n[0].toLowerCase()}/${n}.png`}catch(t){return null}}function DI(e){if(!e)return!1;try{let t=new URL(e);if(t.protocol!=="http:"&&t.protocol!=="https:")return!1;let r=t.pathname.toLowerCase();if(BIe.some(i=>r.endsWith(i)))return!0;let n=t.hostname.toLowerCase();return!!(WIe.some(i=>n===i||n.endsWith(`.${i}`))||n==="s3.tradingview.com"&&r.includes("/snapshots/"))}catch(t){return!1}}var BIe,WIe,pB=F(()=>{BIe=[".jpg",".jpeg",".png",".gif",".webp",".bmp",".svg"],WIe=["s3.tradingview.com","i.imgur.com","imgur.com","pbs.twimg.com","media.discordapp.net","cdn.discordapp.com","images.unsplash.com","i.redd.it","preview.redd.it"]});var Do,$Ie,CZ,mB=F(()=>{Do=Y(Q());Rx();uB();pB();$Ie=({data:e,onChange:t,availableTags:r,onAddImage:n,onDeleteImage:i})=>{let a=(0,Do.useMemo)(()=>({contextType:"trade",contextData:{ticker:e.instrument||"unknown"},multiple:!0}),[e.instrument]),o=async v=>{try{let h=Array.isArray(e.images)?[...e.images]:[];if(!h.includes(v)){let y=[...h,v];t("images",y)}}catch(h){console.error("Failed to process uploaded image:",h)}},s=async v=>{try{let h=Array.isArray(e.images)?[...e.images]:[],y=v.filter(b=>!h.includes(b));if(y.length>0){let b=[...h,...y];t("images",b)}}catch(h){console.error("Failed to process multiple uploaded images:",h)}},l=async(v,h)=>{let b=[...e.images||[]].filter(k=>k!==h);if(t("images",b),i)try{await i(h)}catch(k){console.error(`Failed to delete image ${h}:`,k)}},c=async v=>{if(!n)throw new Error("Image upload not available");return await n(v)},[d,u]=(0,Do.useState)(""),[p,m]=(0,Do.useState)(null),g=(0,Do.useCallback)(()=>{let v=d.trim();if(!v)return;let h=v;if(CI(v)){let b=PI(v);b&&(h=b)}if(!DI(h)){m("Invalid image URL. Please enter a direct image link.");return}if((Array.isArray(e.images)?e.images:[]).includes(h)){m("This image is already added.");return}o(h),u(""),m(null)},[d,e.images,o]),f=(0,Do.useCallback)(v=>{v.key==="Enter"&&(v.preventDefault(),g())},[g]);return Do.default.createElement(Qg,{title:"Attachments"},n&&Do.default.createElement("div",{className:"field"},Do.default.createElement("label",{className:"label"},"Attachments"),Do.default.createElement(kI,{onImageUploaded:o,onMultipleImagesUploaded:s,label:"Upload Image",enableDragDrop:!0,saveImageFunction:c,enablePaste:!0,pasteContext:a}),Do.default.createElement("div",{className:"journalit-image-url-container"},Do.default.createElement("input",{type:"text",className:`journalit-image-url-input${p?" has-error":""}`,value:d,onChange:v=>{u(v.target.value),m(null)},onKeyDown:f,placeholder:"Or paste image URL (TradingView, etc.)...","aria-label":"Image URL input"}),Do.default.createElement("button",{type:"button",className:`journalit-image-url-button${d.trim()?" is-active":""}`,onClick:g,disabled:!d.trim()},"Add")),p&&Do.default.createElement("div",{className:"journalit-image-url-error"},p),e.images&&e.images.length>0&&Do.default.createElement("div",{style:{marginTop:"1rem"}},Do.default.createElement(oh,{images:e.images,altPrefix:"Trade Image",showThumbnails:!0,showCounter:!0,enableDelete:!0,onDeleteImage:l,enableFullscreen:!0}))))},CZ=Do.default.memo($Ie)});var EI,fB,PZ=F(()=>{EI=Y(Q());sB();mB();fB=({data:e,errors:t,onChange:r,accounts:n,setups:i,mistakes:a,availableTags:o,onAddImage:s,onDeleteImage:l})=>EI.default.createElement("div",{className:"trade-form-details-tab"},EI.default.createElement(hZ,{data:e,errors:t,onChange:r,accounts:n,setups:i,mistakes:a}),EI.default.createElement(CZ,{data:e,onChange:r,availableTags:o,onAddImage:s,onDeleteImage:l}))});var lo,RIe,UIe,DZ,EZ=F(()=>{lo=Y(Q());Jg();rI();Zv();tI();ET();nr();ny();RIe=({field:e,value:t,onChange:r,error:n})=>{let i=Ae(),{id:a,label:o,type:s,validation:l,options:c,placeholder:d,helperText:u,allowCreateOptions:p}=e,m=(0,lo.useMemo)(()=>{if(s!=="dropdown"&&s!=="multiselect")return c||[];let v=c||[],h=i==null?void 0:i.customFieldsService;if(!h)return v;let b=h.getFieldOptions(a).map(x=>({value:x,label:x})),k=[...v];return b.forEach(x=>{k.some(S=>S.value===x.value)||k.push(x)}),k},[a,s,c,i==null?void 0:i.customFieldsService]),g=async v=>{let h=i==null?void 0:i.customFieldsService;if(!(!h||!p))try{await h.addFieldOption(a,v)}catch(y){console.error("Failed to save custom field option:",y)}},f=(0,lo.useMemo)(()=>({label:o,value:t!=null?t:s==="multiselect"?[]:s==="number"?0:"",onChange:r,placeholder:d,error:n,required:(l==null?void 0:l.required)||!1}),[o,t,s,r,d,n,l==null?void 0:l.required]);switch(s){case"text":return lo.default.createElement(qa,{...f,multiline:!1,type:"text"});case"number":return lo.default.createElement($r,{...f,allowDecimal:!0,precision:2,min:l==null?void 0:l.min,max:l==null?void 0:l.max});case"dropdown":return p?lo.default.createElement(Xs,{...f,options:m.map(v=>v.value),isMulti:!1,allowCreate:!0,onSaveOption:g}):lo.default.createElement(Xi,{...f,options:m});case"multiselect":return lo.default.createElement(Xs,{...f,options:m.map(v=>v.value),isMulti:!0,allowCreate:p||!1,onSaveOption:p?g:void 0});case"date":return lo.default.createElement(Il,{...f,includeTime:!1});case"datetime":return lo.default.createElement(Il,{...f,includeTime:!0});case"time":return lo.default.createElement(Il,{...f,timeOnly:!0});default:return lo.default.createElement("div",{className:"custom-field-error"},lo.default.createElement("p",null,"Unsupported field type: ",s))}},UIe=({fields:e,values:t,onChange:r,errors:n={}})=>!e||e.length===0?lo.default.createElement("div",{className:"custom-fields-empty"},lo.default.createElement("p",null,"No custom fields configured."),lo.default.createElement("p",null,"Go to Settings \u2192 Customization \u2192 Custom Trade Fields to add custom fields.")):lo.default.createElement("div",{className:"custom-fields-list"},e.map(i=>lo.default.createElement("div",{key:i.id,className:"custom-field-wrapper"},lo.default.createElement(RIe,{field:i,value:t[i.id],onChange:a=>r(i.id,a),error:n[i.id]})))),DZ=lo.default.memo(UIe)});var Bp,gB,IZ=F(()=>{Bp=Y(Q());EZ();Rx();qi();gB=({data:e,errors:t,onChange:r,customFieldValues:n,onCustomFieldChange:i})=>{let a=Ae(),{service:o,status:s}=uf("customFieldsService"),[l,c]=(0,Bp.useState)([]);return(0,Bp.useEffect)(()=>{(async()=>{try{if(o&&s==="ready"){let m=o.getFields();c(m)}}catch(m){console.error("Failed to load custom fields:",m)}})();let u=a==null?void 0:a.app,p=m=>{m&&m.fields&&c(m.fields)};return u&&u.workspace.on("journalit-custom-fields-changed",p),()=>{u&&u.workspace.off("journalit-custom-fields-changed",p)}},[a,o,s]),Bp.default.createElement("div",{className:"trade-form-advanced-tab"},Bp.default.createElement(Qg,{title:"Custom Fields"},Bp.default.createElement("p",{className:"sectionDescription"},"Custom fields defined in your plugin settings. These fields will be saved to your trade's frontmatter."),l.length===0&&Bp.default.createElement("p",{style:{fontStyle:"italic",color:"var(--text-muted)"}},"No custom fields defined. Create custom fields in the plugin settings under Customization."),Bp.default.createElement(DZ,{fields:l,values:n,onChange:i,errors:t.customFields||{}})))}});var MZ=F(()=>{gZ();PZ();IZ()});function AZ(e){var t,r,n,i,a,o,s,l;if((r=(t=e==null?void 0:e.settings)==null?void 0:t.trade)!=null&&r.tradingDayCutoffTime)return e.settings.trade.tradingDayCutoffTime;try{if((a=(i=(n=window.journalitPlugin)==null?void 0:n.settings)==null?void 0:i.trade)!=null&&a.tradingDayCutoffTime)return window.journalitPlugin.settings.trade.tradingDayCutoffTime;let c=window.JournalitPlugin;return(l=(s=(o=c==null?void 0:c.instance)==null?void 0:o.settings)==null?void 0:s.trade)!=null&&l.tradingDayCutoffTime?c.instance.settings.trade.tradingDayCutoffTime:"00:00"}catch(c){return console.warn("Error getting trading day cutoff time, using default (00:00)",c),"00:00"}}function LZ(e){try{let[t,r]=e.split(":"),n=parseInt(t,10),i=parseInt(r,10);return isNaN(n)||isNaN(i)||n<0||n>23||i<0||i>59?(console.warn(`Invalid cutoff time format: ${e}, using 00:00`),{hours:0,minutes:0}):{hours:n,minutes:i}}catch(t){return console.warn(`Error parsing cutoff time: ${e}, using 00:00`,t),{hours:0,minutes:0}}}function Zt(e,t){let r=AZ(t),{hours:n,minutes:i}=LZ(r),a=new Date(e);return(a.getHours()<n||a.getHours()===n&&a.getMinutes()<i)&&a.setDate(a.getDate()-1),a.setHours(0,0,0,0),a}function NZ(e,t,r){let n=Zt(e,r),i=Zt(t,r);return n.getFullYear()===i.getFullYear()&&n.getMonth()===i.getMonth()&&n.getDate()===i.getDate()}function II(e,t){let r=AZ(t),{hours:n,minutes:i}=LZ(r),a=Zt(e,t),o=new Date(a);o.setHours(n,i,0,0);let s=new Date(o);return s.setDate(s.getDate()+1),{start:o,end:s}}function mc(e,t){let r=Zt(e,t),n=r.getFullYear(),i=String(r.getMonth()+1).padStart(2,"0"),a=String(r.getDate()).padStart(2,"0");return`${n}-${i}-${a}`}var Oa=F(()=>{});var da,Zx,hB,FZ=F(()=>{da=Y(Q());eh();Zx=require("obsidian");rh();Ad();cf();iy();sy();qi();Oa();hB=({initialData:e={},isEditMode:t=!1,onSubmit:r,onCancel:n})=>{let i=Ae(),[a,o]=(0,da.useState)(()=>{var N,U,j,R;if(t&&e){let O={...e};(!O.entries||!Array.isArray(O.entries))&&(O.entries=[]),O.entries.length===0&&O.entryPrice!=null&&O.positionSize!=null&&(O.entries=[{time:O.entryTime||new Date,price:O.entryPrice,size:O.positionSize}]),(!O.exits||!Array.isArray(O.exits))&&(O.exits=[]),O.images||(O.images=[]),O.tags||(O.tags=[]),O.customTags||(O.customTags=[]),O.setup||(O.setup=[]),O.mistake||(O.mistake=[]),O.account||(O.account=[]),O.setupIds||(O.setupIds=[]),O.mistakeIds||(O.mistakeIds=[]),O.accountIds||(O.accountIds=[]),O.isMissedTrade===void 0&&(O.type==="missed-trade"||O.filePath&&O.filePath.includes("-M")&&O.filePath.endsWith(".md")?O.isMissedTrade=!0:O.isMissedTrade=!1);let H=O.backendTradeId!==void 0&&O.backendTradeId!==null,q=O.entryPrice!==void 0&&O.entryPrice!==null&&O.entryPrice>0&&O.exitPrice!==void 0&&O.exitPrice!==null&&O.exitPrice>0;return H?O.useDirectPnLInput=!0:O.useDirectPnLInput===void 0&&(O.useDirectPnLInput=!q),O.useDirectPnLInput&&O.directPnL===void 0&&O.pnl!==void 0&&(O.directPnL=O.pnl),O}let W={...{...xX}};e&&(Object.keys(e).forEach(O=>{let H=O,q=e[H];Array.isArray(q)?W[H]=[...q]:W[H]=q}),!W.images&&e.images&&(W.images=[...e.images]));try{let O=Hi().plugins.plugins.journalit;O&&O.settings.trade.useDirectPnLInput!==void 0&&(W.useDirectPnLInput=O.settings.trade.useDirectPnLInput)}catch(O){console.error("Error loading PNL input mode preference:",O)}try{let O=Hi().plugins.plugins.journalit,H=(U=(N=O==null?void 0:O.uiStateManager)==null?void 0:N.getState())==null?void 0:U.lastAssetType;H&&!W.assetType&&(W.assetType=H)}catch(O){console.error("Error accessing last asset type from UI state:",O)}try{let O=Hi().plugins.plugins.journalit;if(O&&((R=(j=O.settings)==null?void 0:j.trade)!=null&&R.defaultRiskAmount)){let H=O.settings.trade.defaultRiskAmount;H>0&&!W.riskAmount&&(W.riskAmount=H)}}catch(O){console.error("Error loading default risk amount from settings:",O)}return W}),s=(0,da.useMemo)(()=>structuredClone(a),[]),l=(0,da.useRef)(s),[c,d]=(0,da.useState)({}),[u,p]=(0,da.useState)({}),[m,g]=(0,da.useState)(!1),[f,v]=(0,da.useState)([]),[h,y]=(0,da.useState)([]),b=(0,da.useRef)(null),k=(0,da.useRef)(!1),[x,S]=(0,da.useState)(!1),w=(0,da.useMemo)(()=>jT(()=>{let B=G_(a);if(i!=null&&i.customFieldsService&&a.customFields){let W=i.customFieldsService.getFields(),N=Y_(a.customFields,W,i.customFieldsService);Object.keys(N).length>0&&(B.customFields=N)}d(B)},300),[a,i==null?void 0:i.customFieldsService]);(0,da.useEffect)(()=>(m&&w(),()=>{w.cancel()}),[a,m,w]);let C=async()=>{try{if(x||M.current.length===0)return;S(!0);let B=[...M.current];for(let W of B)await vi.deleteImage(W,!0);v([])}catch(B){console.error("Failed to cleanup temporary images:",B)}},D=async B=>{try{if(!B)return;let W=f.includes(B);if(o(N=>{let j=(Array.isArray(N.images)?[...N.images]:[]).filter(R=>R!==B);return{...N,images:j}}),W)try{await vi.deleteImage(B,!0),v(N=>N.filter(U=>U!==B))}catch(N){console.log(`Temporary image file deletion failed (may already be deleted): ${B}`,N)}else y(N=>N.includes(B)?N:[...N,B])}catch(W){console.error(`Failed to delete image file ${B}:`,W)}},P=(B,W)=>{o(N=>{let U={...N,[B]:W},j=B.toString().endsWith("Ids");return B==="account"&&!j?U.accountIds=Array.isArray(W)?[...W]:[]:B==="accountIds"&&!j?U.account=Array.isArray(W)?[...W]:[]:B==="setup"&&!j?U.setupIds=Array.isArray(W)?[...W]:[]:B==="setupIds"&&!j?U.setup=Array.isArray(W)?[...W]:[]:B==="mistake"&&!j?U.mistakeIds=Array.isArray(W)?[...W]:[]:B==="mistakeIds"&&!j&&(U.mistake=Array.isArray(W)?[...W]:[]),U})},M=(0,da.useRef)([]),z=(0,da.useRef)(null);(0,da.useEffect)(()=>{M.current=f},[f]);let A=async B=>{var W;try{let N=Hi().plugins.plugins.journalit,U=N?N.tradeService:null;if(!U)throw new Error("Could not access TradeService");let j=a.entryTime?new Date(a.entryTime):new Date,R=a.instrument||"UNKNOWN",O=Zt(j,N),H=a.isMissedTrade||!1,{year:q,month:V,weekOfMonth:J,formattedDate:K}=await U.getTradePathComponents(O),G=await U.sanitizeTickerForFilename(R),X;if(z.current)X=z.current;else if(e&&e.entryTime){let ee=e.filePath||"";if(ee){let ie=ee.match(/[TMB](\d+)\.md$/);ie?X=ie[1]:H&&(N!=null&&N.missedTradeService)?X=await N.missedTradeService.getMissedTradeNumberForDay(G,O):X=await U.getTradeNumberForDay(G,O),z.current=X}else H&&(N!=null&&N.missedTradeService)?X=await N.missedTradeService.getMissedTradeNumberForDay(G,O):X=await U.getTradeNumberForDay(G,O),z.current=X}else H&&(N!=null&&N.missedTradeService)?X=await N.missedTradeService.getMissedTradeNumberForDay(G,O):X=await U.getTradeNumberForDay(G,O),z.current=X;let te=H?"M":"T",re=(W=N.serviceManager)==null?void 0:W.getFolderPathService(),Z=re?re.journalFolderPath:"!Journalit",ne=`${Z}/${q}/${V}/${J}/media/${G}-${K}-${te}${X}`;try{let ee=Hi();await ee.vault.adapter.mkdir((0,Zx.normalizePath)(Z)),await ee.vault.adapter.mkdir((0,Zx.normalizePath)(`${Z}/${q}`)),await ee.vault.adapter.mkdir((0,Zx.normalizePath)(`${Z}/${q}/${V}`)),await ee.vault.adapter.mkdir((0,Zx.normalizePath)(`${Z}/${q}/${V}/${J}`)),await ee.vault.adapter.mkdir((0,Zx.normalizePath)(ne))}catch(ee){}let se=await vi.saveImage(B,ne,`${G}-${te}${X}`);return v(ee=>[...ee,se]),se}catch(N){throw console.error("Failed to upload image:",N),new Error(`Failed to upload image: ${N.message}`)}},I=async B=>{B.preventDefault(),g(!0);let W=G_(a);if(i!=null&&i.customFieldsService&&a.customFields){let U=i.customFieldsService.getFields(),j=Y_(a.customFields,U,i.customFieldsService);Object.keys(j).length>0&&(W.customFields=j)}d(W),p(W);let N={...a};if(t&&e.filePath&&(N.filePath=e.filePath),!N.assetType&&a.assetType&&(N.assetType=a.assetType),a.useDirectPnLInput!==void 0&&(N.useDirectPnLInput=a.useDirectPnLInput),a.directPnL!==void 0&&(N.directPnL=a.directPnL),a.isMissedTrade!==void 0&&(N.isMissedTrade=a.isMissedTrade),a.missedReason!==void 0&&(N.missedReason=a.missedReason),!cI(W)&&r){L(N);try{for(let U of h)await vi.deleteImage(U,!0)}catch(U){console.error("Failed to delete marked images:",U)}r(N||a),v([]),y([]),S(!0),p({}),d({}),g(!1)}},L=async B=>{try{let W=Hi().plugins.plugins.journalit,N=(W==null?void 0:W.optionsService)||(W?new Go(W):null);if(!N)return;B.instrument&&await N.addOption("instrument",B.instrument),B.account&&B.account.length>0&&await N.addOptions("account",B.account),B.setup&&B.setup.length>0&&await N.addOptions("setup",B.setup),B.mistake&&B.mistake.length>0&&await N.addOptions("mistake",B.mistake),B.customTags&&B.customTags.length>0&&await N.addOptions("tag",B.customTags)}catch(W){console.error("Failed to save custom options:",W)}};(0,da.useEffect)(()=>()=>{C()},[]);let E=()=>{C(),y([]),n&&n()},[T,$]=(0,da.useState)(!1),_=(0,da.useCallback)(()=>{if(!l.current)return!1;let B=l.current,W=(a.instrument||"").trim()!==(B.instrument||"").trim(),N=(a.entryPrice||0)!==(B.entryPrice||0),U=(a.exitPrice||0)!==(B.exitPrice||0),j=(a.positionSize||0)!==(B.positionSize||0),R=(a.thesis||"").trim()!==(B.thesis||"").trim(),O=(a.direction||"")!==(B.direction||""),H=Array.isArray(a.images)?a.images.length:0,q=Array.isArray(B.images)?B.images.length:0;return W||N||U||j||R||H!==q||O},[a.instrument,a.entryPrice,a.exitPrice,a.positionSize,a.thesis,a.images,a.direction]);return{formData:a,errors:c,formRef:b,handleFieldChange:P,handleAddImage:A,deleteImageFile:D,handleSubmit:I,handleCancel:E,isSubmitting:T,setIsSubmitting:$,formSubmitted:m,cleanupPerformed:x,imagesToDelete:h,isDirty:_}}});var OZ=F(()=>{FZ()});var MI,vB,zZ=F(()=>{MI=Y(Q());hi();iy();vB=({onCancel:e,isSubmitting:t,errors:r,isEditMode:n,hasEntryTime:i})=>{let a=()=>n?"Update Trade":i?"Save Changes":"Add Trade";return MI.default.createElement("div",{className:"formActions"},e&&MI.default.createElement(Ie,{variant:"outline",onClick:e,disabled:t,className:"cancelButton"},"Cancel"),MI.default.createElement(Ie,{type:"submit",variant:"primary",loading:t,disabled:cI(r),className:"submitButton"},a()))}});var jZ=F(()=>{zZ()});var Vi,_Z,BZ=F(()=>{Vi=Y(Q());qE();MZ();OZ();jZ();_Z=({initialData:e={},isSubmitting:t=!1,isEditMode:r=!1,onSubmit:n,onCancel:i,onDirtyStateChange:a})=>{let{formData:o,errors:s,formRef:l,handleFieldChange:c,handleAddImage:d,deleteImageFile:u,handleSubmit:p,handleCancel:m,isDirty:g}=hB({initialData:e,isEditMode:r,onSubmit:n,onCancel:i});(0,Vi.useEffect)(()=>{a&&a(g)},[g,a]);let[f,v]=(0,Vi.useState)("basic"),[h,y]=(0,Vi.useState)(()=>r&&o.customFields?o.customFields:{});(0,Vi.useMemo)(()=>(KS(),!0),[]);let b=[],k=[],x=[],S=[],w=[],C=(A,I)=>{let L={...h,[A]:I};y(L),c("customFields",L)};Vi.default.useEffect(()=>{if(o.customFields){let A=JSON.stringify(h),I=JSON.stringify(o.customFields);A!==I&&y(o.customFields)}},[o.customFields,h]);let D=A=>{A!==f&&v(A)},P=Vi.default.useMemo(()=>{let A=["instrument","direction","assetType","entries","exits","entriesExits","entryTime","entryPrice","positionSize","exitTime","exitPrice","accountIds","commission","commissionType","fees","swap","exchange","strikePrice","optionType","contractSize","expirationDate","dollarPerPoint","tickSize","tickValue","contractSymbol","lotSize","pipValue","currencyPair","cryptoExchange","tradingPair","leverageRatio","directPnL","stopLoss","riskAmount"],I=["setupIds"],L=["customFields"],E=A.filter(_=>{let B=s[_];return B&&B!==""}),T=I.filter(_=>{let B=s[_];return B&&B!==""}),$=L.filter(_=>{let B=s[_];return B&&B!==""});return{basic:E.length,details:T.length,advanced:$.length}},[s]),M=[{id:"basic",label:"Basic",errorCount:P.basic},{id:"details",label:"Details",errorCount:P.details},{id:"advanced",label:"Advanced",errorCount:P.advanced}],z=()=>{switch(f){case"basic":return Vi.default.createElement(oB,{data:o,errors:s,onChange:c,instruments:S});case"details":return Vi.default.createElement(fB,{data:o,errors:s,onChange:c,accounts:b,setups:k,mistakes:x,availableTags:w,onAddImage:d,onDeleteImage:u});case"advanced":return Vi.default.createElement(gB,{data:o,errors:s,onChange:c,customFieldValues:h,onCustomFieldChange:C});default:return null}};return Vi.default.createElement("form",{ref:l,className:"formContainer",style:{gap:"8px",position:"relative"},onSubmit:p},(P.basic>0||P.details>0||P.advanced>0)&&Vi.default.createElement("div",{className:"errorSummary",style:{marginBottom:"16px"}},Vi.default.createElement("strong",null,"Please fix the following errors:"),Vi.default.createElement("ul",{style:{margin:"8px 0 0 20px",padding:0}},P.basic>0&&Vi.default.createElement("li",null,"Basic tab has ",P.basic," error",P.basic>1?"s":""),P.details>0&&Vi.default.createElement("li",null,"Details tab has ",P.details," error",P.details>1?"s":""),P.advanced>0&&Vi.default.createElement("li",null,"Advanced tab has ",P.advanced," error",P.advanced>1?"s":""))),Vi.default.createElement("nav",{className:"journalit-tab-nav"},Vi.default.createElement("div",{className:"journalit-tab-wrapper"},M.map(A=>Vi.default.createElement("button",{key:A.id,type:"button",className:`journalit-tab-button ${f===A.id?"journalit-tab-active":""}`,onClick:()=>D(A.id)},A.label,A.errorCount>0&&Vi.default.createElement("span",{className:"journalit-tab-error-badge"},A.errorCount)))),r&&Vi.default.createElement("span",{className:"journalit-edit-badge"},"EDIT")),z(),Vi.default.createElement(vB,{onCancel:m,isSubmitting:t,errors:s,isEditMode:r,hasEntryTime:!!e.entryTime}))}});var WZ=F(()=>{BZ();Rx();iy();cf();qT();aB();sB();mB()});var we,co=F(()=>{we={}});function Wu(e=!1,t=!1,r=!1,n=!1,i=!1,a=!1,o=!1,s=!1,l=!1){try{if(!t&&we.tradeNote&&we.tradeNote.remove(),!a&&we.image&&we.image.remove(),e||(we.drc&&we.drc.remove(),we.drcNote&&we.drcNote.remove()),!r&&we.settings&&we.settings.remove(),!n&&(we.dashboard&&we.dashboard.remove(),!o)){let c=document.head.querySelector("#dashboard-transparency-styles");c&&c.remove()}we.weeklyReview&&we.weeklyReview.remove(),we.monthlyReview&&we.monthlyReview.remove(),!s&&we.shared&&we.shared.remove(),we.tooltip&&we.tooltip.remove(),we.dragOverlay&&we.dragOverlay.remove(),we.tradeForm&&we.tradeForm.remove(),!i&&we.chart&&we.chart.remove(),!l&&we.tradeLog&&we.tradeLog.remove(),uI(),window.__isHandlingComboBoxRemove=!1}catch(c){console.error("Failed to remove styles:",c)}}function e0(e=!1,t=!1,r=!0,n=!0,i=!0,a=!0,o=!1,s=!0,l=!0,c=!0){var d,u,p,m,g,f,v;if(e&&((d=we.drc)!=null&&d.inject)&&we.drc.inject(),t&&((u=we.tradeNote)!=null&&u.inject)&&we.tradeNote.inject(),n&&((p=we.dashboard)!=null&&p.inject)&&we.dashboard.inject(),r&&((m=we.settings)!=null&&m.inject)&&we.settings.inject(),i&&((g=we.chart)!=null&&g.inject)&&we.chart.inject(),a&&((f=we.image)!=null&&f.inject)&&we.image.inject(),c&&((v=we.tradeLog)!=null&&v.inject)&&we.tradeLog.inject(),!(window.__isInjectingStyles&&!o)){window.__isInjectingStyles=!0;try{Wu(e,t,r,n,i,a,s,l,c),we.shared&&we.shared.inject(),we.tooltip&&we.tooltip.inject(),we.dragOverlay&&we.dragOverlay.inject(),we.tradeForm&&we.tradeForm.inject(),we.chart&&we.chart.inject(),Gx(),we.weeklyReview&&we.weeklyReview.inject(),we.monthlyReview&&we.monthlyReview.inject(),we.image&&we.image.inject(),we.tradeLog&&we.tradeLog.inject(),e||(we.drc&&we.drc.inject(),we.drcNote&&we.drcNote.inject()),!t&&we.tradeNote&&we.tradeNote.inject(),!r&&we.settings&&we.settings.inject(),!n&&we.dashboard&&we.dashboard.inject(),typeof window!="undefined"&&we.drc&&(window.__JOURNALIT_INJECT_DRC_STYLES=we.drc.inject)}catch(h){console.error("Failed to inject styles:",h)}finally{window.__isInjectingStyles=!1}}}var yB=F(()=>{co();eh()});function bB(){try{let e="weekly-review-styles";if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=HIe,document.head.appendChild(t)}catch(e){console.error("Failed to inject Weekly Review styles:",e)}}function $Z(){try{let t=document.getElementById("weekly-review-styles");t&&t.parentNode&&t.parentNode.removeChild(t)}catch(e){console.error("Failed to remove Weekly Review styles:",e)}}function qIe(){try{let e="weekly-review-alignment-fix";if(!document.getElementById(e)){let t=document.createElement("style");t.id=e,t.textContent=`
        /* Core alignment fixes for Weekly Review */
        .weekly-review-content {
          padding: 20px 0 0 !important;
        }

        .weekly-review-section {
          width: 100% !important;
          margin-left: 0 !important;
          margin-right: 0 !important;
          margin-bottom: 24px !important;
          box-sizing: border-box !important;
        }

        /* Fix for nested containers in tabs */
        .weekly-review-preparation,
        .weekly-review-overview,
        .weekly-review-review {
          padding: 0 !important;
          width: 100% !important;
        }

        /* High priority rule for all event/forecast/question containers */
        .weekly-review-event-item,
        .weekly-review-forecast-section,
        .weekly-review-grade-item,
        .weekly-review-question,
        /* .weekly-review-drc-list, /* These seem specific to Overview/Review tabs */
        /* .weekly-review-goals-list, */
        /* .weekly-review-drc-card, */
        .weekly-review-event-selector {
          width: 100% !important;
          box-sizing: border-box !important;
        }

        /* Make sure tables span full width and have consistent styling */
        .weekly-review-trades-table,
        .weekly-review-setup-table {
          width: 100% !important;
          overflow-x: auto !important;
          margin-bottom: 16px !important;
        }

        /* Table styling with high specificity for consistent rendering */
        .weekly-review-trades-table table,
        .weekly-review-setup-table table {
          width: 100% !important;
          border-collapse: collapse !important;
          font-size: 14px !important;
          text-align: center !important;
          margin: 0 !important;
          table-layout: auto !important;
        }

        /* Table headers */
        .weekly-review-trades-table th,
        .weekly-review-setup-table th {
          padding: 10px 12px !important;
          border-bottom: 2px solid var(--background-modifier-border) !important;
          font-weight: 600 !important;
          color: var(--text-normal) !important;
          background-color: var(--background-secondary) !important;
          text-align: center !important;
          white-space: nowrap !important;
        }

        /* Table cells */
        .weekly-review-trades-table td,
        .weekly-review-setup-table td {
          padding: 8px 12px !important;
          border-bottom: 1px solid var(--background-modifier-border) !important;
          text-align: center !important;
          transition: background-color 0.2s ease !important;
        }

        /* Clickable trade rows */
        .weekly-review-trade-row {
          cursor: pointer !important;
          transition: background-color 0.2s ease !important;
        }

        .weekly-review-trade-row:hover {
          background-color: var(--background-modifier-hover) !important;
        }

        /* Hover effect for table rows */
        .weekly-review-trades-table tr:hover td,
        .weekly-review-setup-table tr:hover td {
          background-color: var(--background-modifier-hover) !important;
        }

        /* Ensure color styles are properly applied in table cells */
        .weekly-review-trades-table td[style*="color: var(--color-green)"],
        .weekly-review-setup-table td[style*="color: var(--color-green)"] {
          color: var(--color-green, #43a047) !important;
        }

        .weekly-review-trades-table td[style*="color: var(--color-red)"],
        .weekly-review-setup-table td[style*="color: var(--color-red)"] {
          color: var(--color-red, #e53935) !important;
        }

        /* Best/Worst Trade section styles */
.weekly-review-best-trade {
        border: 1px solid var(--background-modifier-border) !important;
        border-radius: 6px !important;
        overflow: hidden !important;
        background-color: var(--background-secondary) !important;
}

/* Added styling for the notes section with tags and mistakes */
.weekly-review-best-trade-notes {
        padding: 0 16px 12px !important;
        display: flex !important;
        flex-direction: column !important;
        gap: 8px !important;
}

/* Special styling for best/worst trades */
.weekly-review-best-trade.best-trade {
  border-left: 3px solid var(--color-green, #43a047) !important;
}

.weekly-review-best-trade.worst-trade {
  border-left: 3px solid var(--color-red, #e53935) !important;
}

        .weekly-review-best-trade-header {
          display: flex !important;
          justify-content: space-between !important;
          align-items: center !important;
          padding: 12px 16px !important;
          background-color: var(--background-secondary-alt, var(--background-secondary)) !important;
          border-bottom: 1px solid var(--background-modifier-border) !important;
        }

        .weekly-review-best-trade-details {
          padding: 12px 16px !important;
        }

        .weekly-review-best-trade-detail {
          margin-bottom: 6px !important; /* Reduced from 8px for more even spacing */
          display: flex !important;
          align-items: center !important;
          width: 100% !important;
        }
        
        /* Last detail item should have no bottom margin */
        .weekly-review-best-trade-detail:last-child {
          margin-bottom: 0 !important;
        }

        .weekly-review-best-trade-label {
          font-weight: 500 !important;
          width: 80px !important;
          color: var(--text-muted) !important;
        }

        .weekly-review-view-button {
          background-color: var(--interactive-accent) !important;
          color: var(--text-on-accent) !important;
          border: none !important;
          border-radius: 4px !important;
          padding: 8px 16px !important;
          font-size: 14px !important;
          cursor: pointer !important;
          margin-top: 8px !important;
          transition: background-color 0.2s ease !important;
        }

        .weekly-review-view-button:hover {
          background-color: var(--interactive-accent-hover) !important;
        }

        .weekly-review-view-button:disabled {
          opacity: 0.5 !important;
          cursor: not-allowed !important;
        }

        .weekly-review-best-trade-actions {
          padding: 0 16px 16px !important;
          display: flex !important;
          justify-content: flex-end !important;
        }
        
        /* Force proper styling for tags and mistakes section */
        .weekly-review-best-trade-notes {
          padding: 0 16px 12px !important;
          display: flex !important;
          flex-direction: column !important;
          gap: 8px !important;
          width: 100% !important;
          box-sizing: border-box !important;
        }

        /* Make sure charts span full width */
        .recharts-responsive-container {
          width: 100% !important;
        }

        /* Force layout of header to match DRC style exactly */
        .weekly-review-header {
          padding: 16px 20px 12px !important;
          background-color: var(--background-secondary) !important;
          text-align: center !important;
          border-bottom: 1px solid var(--background-modifier-border) !important;
          display: block !important;
          flex-direction: unset !important;
          box-sizing: border-box !important;
          width: 100% !important;
        }

        .weekly-review-date {
          font-size: 28px !important;
          font-weight: 600 !important;
          color: var(--text-normal) !important;
          margin-bottom: 20px !important;
          text-align: center !important;
        }

        .weekly-review-navigation {
          width: 100% !important;
          padding-top: 10px !important;
          border-top: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1)) !important;
          display: block !important;
          /* Removed margin overrides from invalid file */
        }

        .weekly-review-navigation-links {
          display: flex !important;
          justify-content: space-between !important;
          align-items: center !important;
          gap: 8px !important;
          flex-wrap: wrap !important;
          width: 100% !important;
        }

        /* Higher specificity for navigation buttons */
        body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button,
        html .weekly-review-container .weekly-review-navigation .weekly-review-nav-button,
        .workspace-leaf .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button {
          padding: 8px 14px !important;
          border: 1px solid var(--background-modifier-border) !important;
          border-radius: 4px !important;
          background-color: var(--background-primary) !important;
          color: var(--text-normal) !important;
          cursor: pointer !important;
          font-size: 14px !important;
          transition: all 0.2s !important;
          display: flex !important;
          align-items: center !important;
          gap: 6px !important;
          /* Flex restored */
          flex: 1 !important;
          justify-content: center !important;
          text-align: center !important;
          min-width: 120px !important;
        }

        /* Extra specificity for hover state */
        body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button:hover,
        html .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button:hover,
        .workspace-leaf .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button:hover {
          background-color: var(--background-modifier-hover) !important;
          transform: translateY(-1px) !important;
        }

        /* Fix for nav icon in weekly review - higher specificity */
        body .weekly-review-nav-button .nav-icon,
        html .weekly-review-container .weekly-review-navigation .weekly-review-nav-button .nav-icon {
          font-size: 16px !important;
          line-height: 1 !important;
        }

        /* Enhanced duplicate prevention for weekly review components */
        /* First rule: Hide any weekly review view that comes after another one */
        .markdown-preview-view .journalit-weekly-review-view[data-file-path] + .journalit-weekly-review-view[data-file-path],
        .markdown-reading-view .journalit-weekly-review-view[data-file-path] + .journalit-weekly-review-view[data-file-path],
        /* Second rule: Hide direct duplicates */
        .markdown-preview-view .journalit-weekly-review-view + .journalit-weekly-review-view,
        .markdown-reading-view .journalit-weekly-review-view + .journalit-weekly-review-view,
        /* Third rule: Hide duplicate wrappers */
        .weekly-review-wrapper + .weekly-review-wrapper {
          display: none !important; /* Hide any second Weekly Review component that appears after another one */
        }

        /* Ensure we never show multiple instances in any mode - additional rules */
        /* Add data-view-mode attribute based rules */
        [data-view-mode="preview"] + [data-view-mode="preview"],
        [data-view-mode="source"] + [data-view-mode="source"],
        /* Strict duplicate prevention by adding direct adjacency rules */
        .journalit-weekly-review-view + .journalit-weekly-review-view,
        [data-view-mode="read"] + [data-view-mode="read"],
        [data-view-mode="read"] + [data-view-mode="read-fallback"],
        [data-view-mode="read-fallback"] + [data-view-mode="read"] {
          display: none !important;
        }

        /* Ultra-high specificity rule for weekly review navigation buttons container */
        html body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links,
        body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links,
        .workspace-leaf .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links {
          display: flex !important;
          justify-content: space-between !important;
          align-items: center !important;
          gap: 8px !important;
          flex-wrap: wrap !important;
          width: 100% !important;
        }

        /* Ultra-high specificity rule for each weekly navigation button */
        html body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button,
        body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button,
        .workspace-leaf .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button {
          padding: 8px 14px !important;
          border: 1px solid var(--background-modifier-border) !important;
          border-radius: 4px !important;
          background-color: var(--background-primary) !important;
          color: var(--text-normal) !important;
          cursor: pointer !important;
          font-size: 14px !important;
          transition: all 0.2s !important;
          display: flex !important;
          align-items: center !important;
          justify-content: center !important;
          gap: 6px !important;
          flex: 1 !important;
          text-align: center !important;
          min-width: 120px !important;
          box-sizing: border-box !important;
        }

        /* Fix mobile layout */
        @media (max-width: 768px) {
          .weekly-review-navigation-links {
            justify-content: center !important;
            flex-wrap: wrap !important;
            width: 100% !important;
          }

          .weekly-review-nav-button {
            flex: 1 !important;
            min-width: 120px !important;
            justify-content: center !important;
          }
        }
      `,document.head.appendChild(t)}}catch(e){console.error("Failed to apply Weekly Review alignment fix:",e)}}function RZ(){if(document.getElementById("weekly-review-styles")||bB(),qIe(),!document.getElementById("critical-weekly-review-styles")){let e=document.createElement("style");e.id="critical-weekly-review-styles",e.textContent=`
      /* Critical core styles for Weekly Review */
      .journalit-weekly-review-view {
        display: block !important;
        width: 100% !important;
        margin: 0 !important;
        padding: 0 !important;
        z-index: 100 !important;
        visibility: visible !important;
        opacity: 1 !important;
      }

      .weekly-review-wrapper {
        display: block !important; /* Changed from flex */
        width: 100% !important;
        position: relative !important;
        z-index: 100 !important;
      }

      .weekly-review-container {
        display: flex !important;
        flex-direction: column !important;
        width: 100% !important;
      }

      .weekly-review-content {
        display: block !important; /* Ensure content area displays */
        width: 100% !important;
      }

      /* Critical navigation button styling - highest possible specificity (Restored) */
       html body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button {
         /* Keeping basic display/visibility, detailed styles in ensureAlignmentFix */
         display: flex !important;
         visibility: visible !important;
         opacity: 1 !important;
       }

       /* Removed duplicate .weekly-review-wrapper, .container, .content rules */
    `,document.head.appendChild(e)}}var HIe,xB=F(()=>{HIe=`
/* Color variables for event colors and consistency */
:root {
  --chart-positive: var(--color-green, #43a047);
  --chart-negative: var(--color-red, #e53935);
  --event-color-red: var(--color-red, #e53935);
  --event-color-orange: var(--color-orange, #fb8c00);
  --event-color-yellow: var(--color-yellow, #fdd835);
  --event-color-gray: var(--text-muted, #888888); /* Use muted text color as base for gray */
  --event-text-color-on-dark: #ffffff; /* Text color for darker backgrounds */
  --event-text-color-on-light: #000000; /* Text color for lighter backgrounds (like yellow) */
  --interactive-accent-rgb: 83, 141, 226; /* Default RGB values for interactive accent - synced with tradeForm */
}

/* Weekly Review View container - ensures no extra margins/padding */
.journalit-weekly-review-view,
.markdown-preview-view .journalit-weekly-review-view {
  margin: 0 !important; /* Remove all margins */
  border-bottom: none !important; /* Remove bottom border causing extra space */
  padding: 0 !important; /* Remove all padding */
  display: block !important;
  width: 100% !important;
  z-index: 100 !important;
  /* Force visibility */
  visibility: visible !important;
  opacity: 1 !important;
  background-color: var(--background-primary) !important;
  /* Removed borders */
  border: none !important;
  border-radius: 8px !important;
  /* Ensure proper containment */
  position: relative;
  box-sizing: border-box;
  /* Prevent overlaps */
  contain: content;
  /* Ensure proper isolation from other views */
  isolation: isolate;
}

/* Weekly Review React root wrapper */
.weekly-review-wrapper {
  width: 100%;
  display: flex;
  flex-direction: column;
  contain: content;
  /* Keep React root fully contained */
  isolation: isolate;
  /* Create a new stacking context */
  position: relative;
  /* Ensure clean slate for each instance */
  box-sizing: border-box;
  margin: 0 !important;
  z-index: 100 !important;
}


/* Weekly Review Container */
.weekly-review-container {
  display: flex;
  flex-direction: column;
  font-family: var(--font-text);
  color: var(--text-normal);
  width: 100%;
  height: 100%;
  overflow: hidden;
  background-color: var(--background-primary);
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  position: relative; /* Establish positioning context to prevent jumping */
  z-index: 1; /* Ensure proper stacking context */
  transform: translateZ(0); /* Force GPU acceleration for stability */
  will-change: auto !important; /* Prevent aggressive optimization */
  contain: layout style !important; /* CSS containment to prevent layout recalculation cascades */
}

/* Header and Navigation - Styled to match DRC */
.weekly-review-header {
  padding: 16px 20px 12px;
  background-color: var(--background-secondary);
  text-align: center;
  border-bottom: 1px solid var(--background-modifier-border);
}

.weekly-review-date {
  font-size: 28px;
  font-weight: 600;
  color: var(--text-normal);
  margin-bottom: 20px;
}

/* Navigation - Matches DRC navigation */
/* Weekly Review specific header classes */
.weekly-review-title {
  font-size: 28px;
  font-weight: 600;
  color: var(--text-normal);
  margin-bottom: 20px;
  text-align: center;
}

.weekly-review-date-container {
  font-size: 28px;
  font-weight: 600;
  color: var(--text-normal);
  margin-bottom: 20px;
  text-align: center;
}

.weekly-review-navigation {
  width: 100%;
  padding-top: 10px;
  border-top: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1));
}

.weekly-review-navigation-links {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
  width: 100% !important;
}

.weekly-review-nav-button {
  padding: 8px 14px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  background-color: var(--background-primary);
  color: var(--text-normal);
  cursor: pointer;
  font-size: 14px;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  flex: 1;
  text-align: center;
  min-width: 120px;
}

.weekly-review-nav-button:hover {
  background-color: var(--background-modifier-hover);
  transform: translateY(-1px);
}

.weekly-review-nav-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.nav-icon {
  font-size: 14px;
  margin-right: 4px;
  margin-left: 4px;
}

/* Critical navigation styles with high specificity */
html body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links,
body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links,
.workspace-leaf .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links {
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  gap: 8px !important;
  flex-wrap: wrap !important;
  width: 100% !important;
}

html body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button,
body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button,
.workspace-leaf .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button {
  padding: 8px 14px !important;
  border: 1px solid var(--background-modifier-border) !important;
  border-radius: 4px !important;
  background-color: var(--background-primary) !important;
  color: var(--text-normal) !important;
  cursor: pointer !important;
  font-size: 14px !important;
  transition: all 0.2s !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  gap: 6px !important;
  flex: 1 !important;
  text-align: center !important;
  min-width: 120px !important;
  box-sizing: border-box !important;
  max-width: none !important;
  margin: 0 !important;
}

/* Ensure proper icon spacing */
html body .weekly-review-container .weekly-review-navigation .weekly-review-nav-button .nav-icon,
body .weekly-review-container .weekly-review-navigation .weekly-review-nav-button .nav-icon {
  font-size: 16px !important;
  line-height: 1 !important;
}

/* Tabs */
.weekly-review-tabs-container {
  display: flex;
  justify-content: center;
  border-bottom: 1px solid var(--background-modifier-border);
  background-color: var(--background-secondary-alt, #2a2a2a);
  padding: 0;
}

.weekly-review-tabs {
  display: flex;
  justify-content: center;
  background-color: transparent;
  max-width: 600px;
  margin: 0 auto;
}

.weekly-review-tab {
  padding: 12px 24px;
  font-size: 14px;
  font-weight: 600;
  color: var(--text-muted);
  background-color: transparent;
  border: none;
  border-bottom: 2px solid transparent;
  cursor: pointer;
  transition: all 0.2s ease;
  position: relative;
  outline: none;
}

.weekly-review-tab:hover {
  color: var(--text-normal);
  background-color: rgba(127, 127, 127, 0.05);
}

.weekly-review-tab.active {
  color: var(--text-accent);
  border-bottom: 2px solid var(--text-accent);
}

/* Content */
.weekly-review-content {
  flex: 1;
  overflow-y: auto;
  padding: 20px 0 0; /* Only top padding, no horizontal padding */
}

/* Sections */
.weekly-review-section {
  margin: 0 0 24px 0; /* Explicit horizontal margin of 0 */
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  padding: 16px;
  width: 100%; /* Ensure full width */
  box-sizing: border-box; /* Include padding in width calculation */
}

.weekly-review-section-title {
  margin: 0 0 16px 0;
  padding-bottom: 8px;
  font-size: 16px;
  font-weight: 600;
  color: var(--text-normal);
  border-bottom: 1px solid var(--background-modifier-border);
  text-align: center;
}

/* Fix Section title styling - especially for Previous Week Goals */
.weekly-review-previous-goals h3,
.weekly-review-section h3 {
  font-size: 1rem !important;
  margin-top: 0.5rem !important;
  margin-bottom: 1rem !important;
  text-align: center !important;
  font-weight: 600 !important;
  color: var(--text-normal) !important;
  padding-bottom: 0.5rem !important;
  border-bottom: 1px solid var(--background-modifier-border) !important;
}

/* Empty states */
.weekly-review-empty-state,
.weekly-review-no-trades,
.weekly-review-no-drcs,
.weekly-review-no-events,
.weekly-review-no-questions {
  padding: 16px;
  text-align: center;
  color: var(--text-muted);
  font-style: italic;
  background-color: var(--background-secondary);
  border-radius: 6px;
}

/* Checklist for previous goals - Modified for 2-column grid layout */
.weekly-review-checklist {
  display: grid; /* Changed from flex */
  grid-template-columns: repeat(2, 1fr); /* Create two equal columns */
  gap: 12px; /* Increased gap for grid layout */
}

.weekly-review-checklist-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  border-radius: 4px;
  background-color: var(--background-secondary);
  cursor: pointer; /* Make the entire area clickable */
  transition: background-color 0.2s ease;
}

.weekly-review-checklist-item:hover {
  background-color: var(--background-modifier-hover);
}

.weekly-review-checkbox {
  width: 18px;
  height: 18px;
  margin: 0;
  cursor: pointer;
}

/* Key Events */
.weekly-review-key-events {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.weekly-review-event-selector {
  display: flex;
  flex-direction: column;
  gap: 12px;
  padding: 16px;
  background-color: var(--background-secondary);
  border-radius: 8px;
}

/* ComboBox styling - matched with DRC implementation */
.weekly-review-container .combobox-container,
.weekly-review-container [data-combobox-type],
.weekly-review-event-selector .combobox-container,
.weekly-review-section .combobox-container {
  position: relative !important;
  width: 100% !important;
  margin-bottom: 8px !important;
  z-index: 10 !important;
}

/* Increased z-index when dropdown is open */
.weekly-review-container .combobox-container[data-is-open="true"],
.weekly-review-container [data-combobox-type][data-is-open="true"],
.weekly-review-event-selector .combobox-container[data-is-open="true"],
.weekly-review-section .combobox-container[data-is-open="true"] {
  z-index: 9999 !important;
}

/* Dropdown caret for Weekly Review ComboBox */
.weekly-review-container [data-combobox-type] .input-container::after,
.weekly-review-event-selector .combobox-container .input-container::after,
.weekly-review-section .combobox-container .input-container::after {
  content: "" !important;
  position: absolute !important;
  right: 12px !important;
  top: 50% !important;
  transform: translateY(-50%) !important;
  width: 0 !important;
  height: 0 !important;
  border-left: 5px solid transparent !important;
  border-right: 5px solid transparent !important;
  border-top: 5px solid var(--text-normal) !important;
  pointer-events: none !important;
  z-index: 10 !important;
}

/* Input padding to make room for dropdown arrow */
.weekly-review-container [data-combobox-type] input[role="combobox"],
.weekly-review-event-selector .combobox-container input[role="combobox"],
.weekly-review-section .combobox-container input[role="combobox"] {
  padding-right: 30px !important;
  width: 100% !important;
  padding: 8px 12px !important;
  padding-right: 30px !important;
  border: 1px solid var(--background-modifier-border) !important;
  border-radius: 4px !important;
  background-color: var(--background-primary) !important;
  color: var(--text-normal) !important;
  font-size: 16px !important;
  cursor: pointer !important;
  position: relative !important;
  z-index: 10000 !important; /* Higher than dropdown (9999) to ensure focus border shows on top */
}

/* Input field focus styling - ensure focus outlines appear above dropdown */
.weekly-review-container [data-combobox-type] input[role="combobox"]:focus,
.weekly-review-event-selector .combobox-container input[role="combobox"]:focus,
.weekly-review-section .combobox-container input[role="combobox"]:focus {
  outline: 2px solid var(--interactive-accent) !important; /* Match Obsidian's focus style */
  outline-offset: -1px !important;
  border-color: var(--interactive-accent) !important;
  box-shadow: 0 0 0 1px var(--interactive-accent) !important;
  z-index: 10001 !important; /* Ensure focus styling is above even the input */
}

/* Weekly Review dropdown options - remove bullets and match DRC */
.weekly-review-container [data-combobox-type] ul[role="listbox"],
.weekly-review-event-selector [data-combobox-type] ul[role="listbox"],
.weekly-review-section [data-combobox-type] ul[role="listbox"] {
  position: absolute !important;
  top: 100% !important;
  left: 0 !important;
  right: 0 !important;
  max-height: 200px !important;
  overflow-y: auto !important;
  background-color: var(--background-primary) !important;
  border: 1px solid var(--background-modifier-border) !important;
  border-top: none !important;
  border-radius: 0 0 4px 4px !important;
  margin-top: -1px !important;
  z-index: 9999 !important;
  list-style: none !important; /* Remove bullets */
  padding: 0 !important;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
  clip-path: inset(1px -15px -15px -15px) !important; /* Clip top edge to prevent covering the focus border */
}

/* Weekly Review dropdown options styling */
.weekly-review-container [data-combobox-type] ul[role="listbox"] li,
.weekly-review-event-selector [data-combobox-type] ul[role="listbox"] li,
.weekly-review-section [data-combobox-type] ul[role="listbox"] li {
  padding: 8px 12px !important;
  cursor: pointer !important;
  transition: background-color 150ms ease !important;
  margin: 0 !important;
  list-style: none !important; /* Ensure no bullets */
  border-bottom: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1)) !important;
}

/* Hover and selected state for Weekly Review dropdown options */
.weekly-review-container [data-combobox-type] ul[role="listbox"] li:hover,
.weekly-review-container [data-combobox-type] ul[role="listbox"] li[aria-selected="true"],
.weekly-review-event-selector [data-combobox-type] ul[role="listbox"] li:hover,
.weekly-review-event-selector [data-combobox-type] ul[role="listbox"] li[aria-selected="true"],
.weekly-review-section [data-combobox-type] ul[role="listbox"] li:hover,
.weekly-review-section [data-combobox-type] ul[role="listbox"] li[aria-selected="true"] {
  background-color: var(--background-secondary) !important;
}

/* Special styling for "Add new" option in Weekly Review */
.weekly-review-container [data-combobox-type] ul[role="listbox"] li[data-add-option="true"],
.weekly-review-event-selector [data-combobox-type] ul[role="listbox"] li[data-add-option="true"],
.weekly-review-section [data-combobox-type] ul[role="listbox"] li[data-add-option="true"] {
  font-style: italic !important;
  border-top: 1px dashed var(--background-modifier-border) !important;
}

/* When dropdown is open, change input border radius */
.weekly-review-container [data-combobox-type][data-is-open="true"] input[role="combobox"],
.weekly-review-event-selector [data-combobox-type][data-is-open="true"] input[role="combobox"],
.weekly-review-section [data-combobox-type][data-is-open="true"] input[role="combobox"] {
  border-bottom-left-radius: 0 !important;
  border-bottom-right-radius: 0 !important;
}

/* Weekly Review Multi-select styling - fixed for better visibility */
.weekly-review-event-selector .selected-options,
.weekly-review-event-selector .selected-item,
.weekly-review-section .selected-options,
.weekly-review-section .selected-item,
.weekly-review-container [data-combobox-type="multi"] > div:first-of-type {
  display: flex !important;
  flex-wrap: wrap !important;
  gap: 4px !important;
  max-width: 100% !important;
  padding: 2px 0 !important;
  z-index: 5 !important;
  position: relative !important;
}

/* Style selected tags to match the DRC */
.weekly-review-event-selector .selected-option,
.weekly-review-event-selector .selected-item,
.weekly-review-section .selected-option,
.weekly-review-section .selected-item {
  display: inline-flex !important;
  align-items: center !important;
  background-color: var(--interactive-accent, #7c3aed) !important;
  color: white !important;
  border-radius: 4px !important;
  padding: 4px 8px !important;
  font-size: 12px !important;
  margin: 0 4px 4px 0 !important;
  font-weight: 500 !important;
  z-index: 6 !important;
  position: relative !important;
  gap: 6px !important;
}

/* Style remove buttons ('\xD7') - matched with DRC */
.weekly-review-event-selector .selected-option-remove,
.weekly-review-event-selector .selected-item button,
.weekly-review-section .selected-option-remove,
.weekly-review-section .selected-item button {
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  width: 16px !important;
  height: 16px !important;
  min-width: 16px !important;
  min-height: 16px !important;
  padding: 0 !important;
  margin-left: 4px !important;
  cursor: pointer !important;
  background: rgba(255, 255, 255, 0.2) !important;
  border: none !important;
  border-radius: 50% !important;
  color: white !important;
  font-size: 14px !important;
  line-height: 1 !important;
  text-align: center !important;
  z-index: 7 !important;
  position: relative !important;
  transition: background-color 0.2s !important;
}

/* Add hover effect for remove buttons */
.weekly-review-event-selector .selected-option-remove:hover,
.weekly-review-event-selector .selected-item button:hover,
.weekly-review-section .selected-option-remove:hover,
.weekly-review-section .selected-item button:hover {
  background: rgba(255, 255, 255, 0.4) !important;
}

/* ADDED: Styles for the event color picker UI */
.weekly-review-event-color-selector {
  display: flex;
  gap: 10px;
  align-items: center;
  margin-top: 8px;
  margin-bottom: 8px;
}

.weekly-review-event-color-selector span { /* Style the "Color:" text */
  margin-right: 5px;
  font-size: 12px;
  color: var(--text-muted);
}

.weekly-review-event-color-selector label {
  display: flex;
  align-items: center;
  cursor: pointer;
}

.weekly-review-event-color-selector input[type="radio"] {
  margin-right: 4px;
  cursor: pointer;
  /* Consider using appearance: none and custom styling */
}

.weekly-review-event-color-selector label span { /* Style the colored circle */
  display: inline-block;
  width: 16px;
  height: 16px;
  border-radius: 50%;
  border: 1px solid var(--background-modifier-border);
}
/* END ADDED color picker styles */


.weekly-review-events-list {
  display: flex;
  flex-direction: column;
  gap: 12px; /* Changed from 12px to 10px in invalid file, reverting */
}

/* MODIFIED: Event item styling with color-specific borders */
.weekly-review-event-item {
  padding: 12px;
  background-color: var(--background-secondary);
  border-radius: 8px;
  border-left: 5px solid var(--event-color-gray); /* Default border color */
  margin-bottom: 8px; /* Add some spacing */
  transition: border-color 0.3s ease; /* Smooth transition for border color */
}

/* ADDED: Event color classes */
.weekly-review-event-item.event-color-red {
  border-left-color: var(--event-color-red);
}
.weekly-review-event-item.event-color-orange {
  border-left-color: var(--event-color-orange);
}
.weekly-review-event-item.event-color-yellow {
  border-left-color: var(--event-color-yellow);
}
.weekly-review-event-item.event-color-gray {
  border-left-color: var(--event-color-gray);
}
/* END ADDED color classes */

/* Day selector styling */
.weekly-review-event-day-selector {
  display: flex;
  gap: 10px;
  align-items: center;
  margin-top: 8px;
  margin-bottom: 8px;
}

.weekly-review-event-day-selector span {
  margin-right: 5px;
  font-size: 12px;
  color: var(--text-muted);
}

.weekly-review-event-day-selector select {
  padding: 4px 8px;
  border-radius: 4px;
  border: 1px solid var(--background-modifier-border);
  background-color: var(--background-primary);
  color: var(--text-normal);
  font-size: 14px;
  width: 150px;
}

/* Day badge in event items */
.weekly-review-event-day {
  font-size: 12px;
  padding: 2px 8px;
  background-color: var(--background-modifier-border);
  border-radius: 4px;
  color: var(--text-normal);
  font-weight: 500;
  white-space: nowrap;
}

.weekly-review-event-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}

.weekly-review-event-header h4 {
  margin: 0;
  font-size: 14px; /* Restored from 1.05em */
  font-weight: 600;
}

/* Forecast */
.weekly-review-forecast-section {
  margin-bottom: 20px;
  padding: 16px;
  background-color: var(--background-secondary); /* Restored from primary-alt */
  border-radius: 8px; /* Restored from 5px */
}

.weekly-review-forecast-section h4 { /* Added missing styling */
  margin-top: 0;
  margin-bottom: 15px;
  font-size: 1.05em; /* Keep consistent sizing */
}

.weekly-review-image-container {
  margin-bottom: 12px; /* Restored from 15px */
}

.weekly-review-image {
  position: relative;
  margin-bottom: 12px;
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 100%;
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  padding: 8px;
  background-color: var(--background-primary);
}

.weekly-review-forecast-image {
  width: auto; /* Allow natural width */
  max-width: 100%; /* Prevent overflow */
  max-height: 300px; /* Limit height */
  object-fit: contain; /* Maintain aspect ratio */
  border-radius: 6px;
  margin-bottom: 8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); /* Add subtle shadow */
  background-color: var(--background-primary); /* Ensure transparent PNGs have a background */
}

.weekly-review-image-upload {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 80px;
  border: 2px dashed var(--background-modifier-border);
  border-radius: 6px;
  margin-bottom: 12px;
  cursor: pointer;
  transition: all 0.2s ease;
  position: relative;
  overflow: hidden;
}

.weekly-review-image-upload:hover {
  border-color: var(--interactive-accent);
  background-color: rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.05);
}

.weekly-review-image-upload.dragging-over {
  border-color: var(--interactive-accent);
  background-color: rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.1);
  transform: scale(1.02);
  box-shadow: 0 0 12px rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.3);
}

.weekly-review-image-upload::after {
  content: "Drag and drop here";
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 16px;
  font-weight: 600;
  color: var(--interactive-accent);
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.2s ease;
}

.weekly-review-image-upload.dragging-over::after {
  opacity: 1;
}

.weekly-review-image-upload.dragging-over .weekly-review-image-label {
  opacity: 0;
}

.weekly-review-image-label {
  font-size: 14px;
  color: var(--text-muted);
  cursor: pointer;
  transition: all 0.2s ease;
}

.weekly-review-image-upload:hover .weekly-review-image-label {
  color: var(--interactive-accent);
}

.weekly-review-image-input {
  display: none;
}

.weekly-review-image-delete {
  /* Position restored from absolute in invalid file */
  background-color: rgba(229, 57, 53, 0.1);
  color: var(--color-error, #e53935);
  border: none;
  border-radius: 4px;
  padding: 6px 12px;
  font-size: 12px; /* Restored from 0.8em */
  cursor: pointer;
  /* Remove transition/opacity from invalid file */
}

/* Buttons */
.weekly-review-add-button {
  background-color: var(--interactive-accent);
  color: white; /* Restored from var */
  border: none;
  border-radius: 4px;
  padding: 8px 16px; /* Restored */
  font-size: 14px; /* Restored */
  cursor: pointer;
  font-weight: normal; /* Reset from invalid file */
  /* Removed align-self from invalid file, handled by container */
}

.weekly-review-add-button:hover {
  background-color: var(--interactive-accent-hover);
}

.weekly-review-add-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.weekly-review-remove-button,
.weekly-review-event-remove { /* Combined rule restored */
  background-color: rgba(229, 57, 53, 0.1); /* Restored from var */
  color: var(--color-error, #e53935); /* Restored from var */
  border: none;
  border-radius: 4px;
  padding: 4px 8px;
  font-size: 12px; /* Restored from 0.8em */
  cursor: pointer;
}

/* Image error message */
.weekly-review-image-error {
  color: var(--text-error, var(--color-red, #e53935));
  font-size: 12px;
  text-align: center;
  margin-top: 4px;
  margin-bottom: 8px;
  padding: 6px 10px;
  background-color: rgba(229, 57, 53, 0.1);
  border-radius: 4px;
  width: 100%;
}

.weekly-review-remove-button:hover,
.weekly-review-event-remove:hover {
  background-color: rgba(229, 57, 53, 0.2);
}

.weekly-review-add-event { /* This class seems unused, keeping for history */
  align-self: flex-start;
  margin-top: 12px;
}

/* Text Areas and Inputs */
.weekly-review-textarea {
  width: 100%;
  min-height: 80px; /* Restored from 100px */
  padding: 12px; /* Restored from 10px */
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px; /* Restored from 4px */
  background-color: var(--background-primary);
  color: var(--text-normal);
  font-family: var(--font-text); /* Added back */
  font-size: 16px; /* Updated from unset */
  resize: vertical;
}

.weekly-review-input { /* For generic inputs if used */
  width: 100%;
  padding: 10px 12px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  background-color: var(--background-primary);
  color: var(--text-normal);
  font-family: var(--font-text);
  font-size: 16px;
}

/* Metric Cards */
.weekly-review-metric-cards {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
  gap: 16px;
  margin-bottom: 16px;
}

.weekly-review-metric-card {
  padding: 16px;
  background-color: var(--background-secondary);
  border-radius: 8px;
  transition: transform 0.2s ease;
}

.weekly-review-metric-card:hover {
  transform: translateY(-2px);
}

.weekly-review-metric-label {
  font-size: 12px;
  color: var(--text-muted);
  margin-bottom: 8px;
}

.weekly-review-metric-value {
  font-size: 20px;
  font-weight: 700;
  color: var(--text-normal);
}

.weekly-review-metric-value[style*="color: var(--color-green)"],
.weekly-review-metric-value[style*="var(--color-green)"] {
  color: var(--color-green) !important;
}
.weekly-review-metric-value.positive { /* Added specific class */
  color: var(--chart-positive) !important;
}

.weekly-review-metric-value[style*="color: var(--color-red)"],
.weekly-review-metric-value[style*="var(--color-red)"] {
  color: var(--color-red) !important;
}
.weekly-review-metric-value.negative { /* Added specific class */
   color: var(--chart-negative) !important;
}


/* Trades list */
.weekly-review-trades {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.weekly-review-trade-item { /* Used if list view is implemented */
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 16px;
  background-color: var(--background-secondary);
  border-radius: 6px;
  cursor: pointer;
  transition: background-color 0.2s ease;
}

.weekly-review-trade-item:hover {
  background-color: var(--background-modifier-hover);
}

.weekly-review-trade-info {
  display: flex;
  align-items: center;
  gap: 8px;
}

.weekly-review-trade-instrument {
  font-weight: 600;
}

.weekly-review-trade-direction {
  color: var(--text-muted);
  font-size: 12px;
}

.weekly-review-trade-pnl {
  font-weight: 600;
}

.weekly-review-trade-pnl[style*="color: var(--color-green)"],
.weekly-review-trade-pnl[style*="var(--color-green)"] {
  color: var(--color-green) !important;
}
.weekly-review-trade-pnl.positive { /* Added specific class */
   color: var(--chart-positive) !important;
}

.weekly-review-trade-pnl[style*="color: var(--color-red)"],
.weekly-review-trade-pnl[style*="var(--color-red)"] {
  color: var(--color-red) !important;
}
.weekly-review-trade-pnl.negative { /* Added specific class */
   color: var(--chart-negative) !important;
}

/* Performance Grades */
.weekly-review-grades { /* Restored simple container */
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.weekly-review-grade-item { /* Restored simpler item */
  background-color: var(--background-secondary);
  border-radius: 8px;
  padding: 16px;
}

.weekly-review-grade-label {
  font-size: 14px; /* Restored */
  font-weight: 500;
  margin-bottom: 8px;
  color: var(--text-normal);
}

/* Performance grade stars */
.weekly-review-grade-stars {
  display: flex;
  gap: 8px;
  margin-bottom: 12px;
  position: relative;
}

.weekly-review-star {
  cursor: pointer;
  color: var(--text-muted);
  transition: color 0.2s ease;
  font-size: 1.5em;
  user-select: none;
  position: relative;
  display: inline-block;
  width: 1em;
  height: 1em;
  line-height: 1;
  text-align: center;
}

.weekly-review-star.full {
  color: gold !important;
}

.weekly-review-star.half {
  position: relative;
  color: var(--text-muted);
}

.weekly-review-star.half::after {
  content: "\u2605";
  position: absolute;
  left: 0;
  top: 0;
  width: 50%;
  overflow: hidden;
  color: gold !important;
  pointer-events: none;
}

/* Tooltip for star rating help */
.weekly-review-grade-stars::after {
  content: "Left click for full star, right click for half star";
  position: absolute;
  font-size: 10px;
  color: var(--text-muted);
  opacity: 0;
  transition: opacity 0.3s ease;
  margin-top: 30px;
  background: var(--background-primary);
  padding: 4px 8px;
  border-radius: 4px;
  pointer-events: none;
  border: 1px solid var(--background-modifier-border);
  white-space: nowrap;
  z-index: 100;
}

.weekly-review-grade-stars:hover::after {
  opacity: 1;
}


/* Daily Report Cards (DRCs) List - Modernized Styling */
.weekly-review-drcs {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

/* DRC List Container */
.weekly-review-drc-list {
  display: flex;
  flex-direction: column;
  gap: 16px;
  width: 100%;
}

/* DRC Card Container - modern card styling */
.weekly-review-drc-card {
  background-color: var(--background-primary);
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
  border: 1px solid var(--background-modifier-border);
}

/* DRC Header with date, grades and button */
.weekly-review-drc-header {
  background-color: var(--background-secondary-alt, var(--background-secondary));
  padding: 10px 16px; /* Reduced padding */
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 1px solid var(--background-modifier-border);
}

.weekly-review-drc-date {
  font-weight: 600;
  font-size: 15px;
  color: var(--text-normal);
  flex: 1;
}

/* Grade Pills in the center */
.weekly-review-drc-grades {
  display: flex;
  gap: 10px;
  justify-content: center;
  flex: 2;
}

.weekly-review-drc-grade {
  font-size: 12px;
  padding: 4px 8px;
  border-radius: 4px;
  background-color: var(--background-secondary-alt, var(--background-secondary));
  font-weight: 500;
  display: inline-flex;
  align-items: center;
  line-height: 1;
  color: white;
}

/* Color coding for grades */
.weekly-review-drc-grade.grade-a {
  background-color: var(--color-green, #43a047);
}

.weekly-review-drc-grade.grade-b {
  background-color: var(--color-orange, #fb8c00);
}

.weekly-review-drc-grade.grade-c {
  background-color: var(--color-red, #e53935);
}

/* Fallback for direct text matching if classes aren't applied */
.weekly-review-drc-grade[data-grade="A"] {
  background-color: var(--color-green, #43a047);
}

.weekly-review-drc-grade[data-grade="B"] {
  background-color: var(--color-orange, #fb8c00);
}

.weekly-review-drc-grade[data-grade="C"] {
  background-color: var(--color-red, #e53935);
}

/* DRC Content Area */
.weekly-review-drc-summary {
  padding: 14px 16px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  background-color: var(--background-primary-alt, var(--background-primary));
}

.weekly-review-drc-section {
  padding: 12px;
  background-color: var(--background-secondary);
  border-radius: 6px;
}

.weekly-review-drc-section-label {
  font-weight: 500;
  font-size: 13px;
  margin-bottom: 6px;
  color: var(--text-accent);
}

.weekly-review-drc-section-content {
  font-size: 14px;
  line-height: 1.5;
  color: var(--text-normal);
  white-space: pre-line;
  overflow-wrap: break-word;
}

/* DRC Actions Area - now in header */
.weekly-review-drc-actions {
  display: flex;
  justify-content: flex-end;
  flex: 1;
}

.weekly-review-drc-button {
  background-color: var(--interactive-accent);
  color: var(--text-on-accent, white);
  border: none;
  border-radius: 6px;
  padding: 6px 12px;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.15s ease;
  display: flex;
  align-items: center;
  gap: 6px;
}

.weekly-review-drc-button:hover {
  background-color: var(--interactive-accent-hover);
}

.weekly-review-drc-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* Legacy DRC item style for compatibility */
.weekly-review-drc-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 16px;
  background-color: var(--background-secondary);
  border-radius: 6px;
  cursor: pointer;
  transition: background-color 0.2s ease;
}

.weekly-review-drc-item:hover {
  background-color: var(--background-modifier-hover);
}

/* Review Questions Section */
.weekly-review-questions { /* Restored */
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.weekly-review-question-section { /* Added back if used */
  margin-bottom: 15px;
}

.weekly-review-question { /* For individual question container */
  background-color: var(--background-secondary);
  border-radius: 8px;
  padding: 16px;
}

.weekly-review-question-text { /* For the text of the question */
  font-weight: 500;
  margin-bottom: 12px;
  color: var(--text-normal);
}

/* Goals Section Restored */
.weekly-review-goal-input {
  display: flex;
  gap: 10px;
  margin-bottom: 15px;
}
.weekly-review-goal-input input {
  flex: 1;
  padding: 8px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  background-color: var(--background-primary);
  color: var(--text-normal);
  font-size: 16px;
}
.weekly-review-goals-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.weekly-review-goal-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 12px;
  background-color: var(--background-secondary);
  border-radius: 4px;
}


/* Chart Tooltip */
.weekly-review-chart-tooltip {
  background-color: var(--background-primary) !important;
  border-radius: 10px !important;
  padding: 14px 18px !important;
  border: 1px solid var(--background-modifier-border) !important;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2) !important;
}

.weekly-review-tooltip-setup,
.weekly-review-tooltip-date {
  font-size: 14px !important;
  font-weight: 500 !important;
  color: var(--text-normal) !important;
  margin-bottom: 8px !important;
  text-align: center !important;
}

.weekly-review-tooltip-value {
  font-size: 20px !important;
  font-weight: 600 !important;
  text-align: center !important;
}

.weekly-review-tooltip-value.positive {
  color: var(--chart-positive) !important;
}

.weekly-review-tooltip-value.negative {
  color: var(--chart-negative) !important;
}

.weekly-review-tooltip-info {
  font-size: 12px !important;
  color: var(--text-muted) !important;
  margin-top: 6px !important;
  text-align: center !important;
}

/* Responsive Styles */
@media (max-width: 768px) {
  .weekly-review-metric-cards {
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
  }

  .weekly-review-navigation-links {
    justify-content: center;
    flex-wrap: wrap;
    width: 100%;
  }

  .weekly-review-nav-button {
    flex: 1;
    min-width: 120px;
    justify-content: center;
  }

  .weekly-review-tab {
    padding: 10px 12px;
    font-size: 13px;
  }

  /* Added back */
  .weekly-review-tabs {
    flex-wrap: wrap;
  }
  .weekly-review-tab {
    flex-grow: 1;
    text-align: center;
  }
}

/* Removed duplicate :root block */

/* Fullscreen Image Styles */
.weekly-review-fullscreen-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background-color: rgba(0, 0, 0, 0.85);
  z-index: 4000; /* Reduced from 1000000 to prevent blocking interactions */
  display: flex;
  align-items: center;
  justify-content: center;
  animation: fadeIn 0.3s ease-in-out;
  backdrop-filter: blur(5px);
  -webkit-backdrop-filter: blur(5px);
  cursor: pointer;
}

.weekly-review-fullscreen-content {
  max-width: 90vw;
  max-height: 90vh;
  display: flex;
  flex-direction: column;
  background-color: var(--background-primary);
  border-radius: 8px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
  animation: zoomIn 0.3s ease-in-out;
  overflow: hidden;
  cursor: default;
}

.weekly-review-fullscreen-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 16px;
  background-color: var(--background-secondary);
  border-bottom: 1px solid var(--background-modifier-border);
}

.weekly-review-fullscreen-header h3 {
  margin: 0;
  font-size: 18px;
  font-weight: 600;
  color: var(--text-normal);
}

.weekly-review-fullscreen-close {
  background-color: rgba(229, 57, 53, 0.1);
  color: var(--color-error, #e53935);
  border: none;
  border-radius: 4px;
  padding: 6px 12px;
  font-size: 14px;
  cursor: pointer;
}

.weekly-review-fullscreen-close:hover {
  background-color: rgba(229, 57, 53, 0.2);
}

.weekly-review-fullscreen-image-container {
  overflow: auto;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 16px;
  background-color: var(--background-primary);
  max-height: calc(90vh - 120px);
  /* Add subtle grid background for transparency */
  background-image: linear-gradient(45deg, var(--background-secondary) 25%, transparent 25%, transparent 75%, var(--background-secondary) 75%),
               linear-gradient(45deg, var(--background-secondary) 25%, transparent 25%, transparent 75%, var(--background-secondary) 75%);
  background-size: 20px 20px;
  background-position: 0 0, 10px 10px;
}

.weekly-review-fullscreen-image {
  max-width: 100%;
  max-height: calc(90vh - 120px);
  object-fit: contain;
  border-radius: 4px;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
}

.weekly-review-fullscreen-footer {
  padding: 10px 16px;
  background-color: var(--background-secondary);
  border-top: 1px solid var(--background-modifier-border);
  text-align: center;
}

.weekly-review-fullscreen-footer p {
  margin: 0;
  font-size: 12px;
  color: var(--text-muted);
}

/* Info text for guidance */
.weekly-review-info-text {
  padding: 10px 14px;
  text-align: center;
  color: var(--text-muted);
  font-style: italic;
  background-color: var(--background-primary-alt, var(--background-secondary));
  border-radius: 6px;
  border-left: 3px solid var(--text-accent);
  margin-top: 8px;
  font-size: 14px;
}

/* Add hint that images can be clicked and held */
.weekly-review-forecast-image {
  cursor: zoom-in !important;
  position: relative;
}

.weekly-review-forecast-image::after {
  content: "Click or hold to enlarge";
  position: absolute;
  bottom: 8px;
  right: 8px;
  background-color: rgba(0, 0, 0, 0.6);
  color: white;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 10px;
  opacity: 0;
  transition: opacity 0.2s ease;
}

.weekly-review-forecast-image:hover::after {
  opacity: 1;
}

/* Enhanced PnL values for better visibility */
.weekly-review-best-trade-pnl {
  font-size: 20px !important;
  font-weight: 700 !important;
  padding: 4px 10px !important;
  border-radius: 4px !important;
  display: inline-block !important;
}

.weekly-review-best-trade-pnl[style*="color: var(--color-green)"] {
  background-color: rgba(67, 160, 71, 0.15) !important;
}

.weekly-review-best-trade-pnl[style*="color: var(--color-red)"] {
  background-color: rgba(229, 57, 53, 0.15) !important;
}

/* Animations */
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes zoomIn {
  from { transform: scale(0.9); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}

/* Metadata container positioning fix to prevent jumping */
.metadata-container {
  position: relative !important;
  z-index: 1 !important;
  transform: translateZ(0) !important;
  will-change: auto !important;
}

/* Prevent parent containers from affecting child positioning during re-renders */
.workspace-leaf-content[data-type="journalit-weekly-review"],
.view-content,
.markdown-source-view,
.markdown-preview-view {
  position: relative !important;
  overflow: auto !important;
}

/* Ensure proper stacking context for nested scrollable elements */
.weekly-tabs-content,
.tab-content {
  position: relative !important;
  z-index: 1 !important;
}

/* Prevent layout shift from margin collapsing */
.weekly-review-container::before {
  content: '';
  display: table;
}

/* Fix for when Obsidian adds inline styles during re-render */
.metadata-container[style*="position"] {
  position: relative !important;
}

/* Ensure dropdowns and inputs don't cause layout shifts */
.weekly-review-container select,
.weekly-review-container input,
.weekly-review-container textarea {
  box-sizing: border-box !important;
  max-width: 100% !important;
}

/* Responsive styles for small screens */
@media (max-width: 600px) {
  .weekly-review-container input[role="combobox"],
  .weekly-review-container input,
  .weekly-review-container textarea,
  .weekly-review-textarea,
  .weekly-review-input,
  .weekly-review-goal-input input {
    font-size: 18px !important;
  }
}
`});var UZ,HZ=F(()=>{UZ=`
/* Monthly Review Container */
.monthly-review {
  width: 100%;
  padding: 20px;
  max-width: 1200px;
  margin: 0 auto;
}

.monthly-review-title {
  text-align: center;
  margin-bottom: 20px;
  font-size: 28px;
  font-weight: 600;
}

/* Monthly Review Content */
.monthly-review-content {
  margin-top: 8px;
}

/* Section Styles */
.monthly-review-section {
  margin-bottom: 20px;
  background: var(--background-primary-alt);
  padding: 20px;
  border-radius: 8px;
  border: 1px solid var(--background-modifier-border);
}

.monthly-review-section-title {
  font-size: 20px;
  font-weight: 600;
  margin-bottom: 15px;
  color: var(--text-normal);
  text-align: center;
}

.monthly-review-section-description {
  font-size: 14px;
  color: var(--text-muted);
  margin-bottom: 15px;
}

/* Metric Cards */
.monthly-review-metric-cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 15px;
  margin-top: 15px;
}

.monthly-review-metric-card {
  background: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  padding: 15px;
  text-align: center;
}

.monthly-review-metric-card.highlight-card {
  position: relative;
}

.monthly-review-metric-label {
  font-size: 12px;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 8px;
}

.monthly-review-metric-value {
  font-size: 24px;
  font-weight: 600;
  color: var(--text-normal);
}

.monthly-review-metric-detail {
  font-size: 14px;
  color: var(--text-muted);
  margin-top: 4px;
}

/* Best/Worst Trade Cards */
.monthly-review-best-trade {
  background: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  padding: 20px;
}

.monthly-review-best-trade.best-trade {
  border-left: 3px solid var(--color-green);
}

.monthly-review-best-trade.worst-trade {
  border-left: 3px solid var(--color-red);
}

.monthly-review-best-trade-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
}

.monthly-review-best-trade-title {
  font-size: 16px;
  font-weight: 600;
}

.monthly-review-best-trade-pnl {
  font-size: 20px;
  font-weight: 600;
}

.monthly-review-best-trade-details {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.monthly-review-best-trade-detail {
  display: flex;
  gap: 8px;
  font-size: 14px;
}

.monthly-review-best-trade-label {
  color: var(--text-muted);
  font-weight: 500;
}

.monthly-review-best-trade-value {
  color: var(--text-normal);
}

.monthly-review-best-trade-actions {
  margin-top: 15px;
}

.monthly-review-view-button {
  padding: 6px 12px;
  background: var(--interactive-accent);
  color: var(--text-on-accent);
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
}

.monthly-review-view-button:hover {
  background: var(--interactive-accent-hover);
}

.monthly-review-link-button {
  padding: 4px 8px;
  background: transparent;
  color: var(--text-accent);
  border: 1px solid var(--text-accent);
  border-radius: 4px;
  cursor: pointer;
  font-size: 12px;
  margin-top: 8px;
}

.monthly-review-link-button:hover {
  background: var(--text-accent);
  color: var(--text-on-accent);
}

/* Week Highlights */
.monthly-review-week-highlights {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 15px;
}

/* Weekly Performance Table */
.monthly-review-trades-table {
  width: 100%;
  overflow-x: auto;
}

.monthly-review-trades-table table {
  width: 100%;
  border-collapse: collapse;
}

.monthly-review-trades-table th,
.monthly-review-trades-table td {
  padding: 10px;
  text-align: left;
  border-bottom: 1px solid var(--background-modifier-border);
}

.monthly-review-trades-table th {
  font-weight: 600;
  color: var(--text-muted);
  font-size: 12px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.monthly-review-trade-row {
  cursor: pointer;
  transition: background-color 0.2s;
}

.monthly-review-trade-row:hover {
  background: var(--background-modifier-hover);
}

/* Demon Tracker Styles */
.demon-tracker-container {
  margin-top: 15px;
}

.demon-tracker-table {
  width: 100%;
  border-collapse: collapse;
  background: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  overflow: hidden;
}

.demon-tracker-table th,
.demon-tracker-table td {
  padding: 12px;
  text-align: center;
  border-right: 1px solid var(--background-modifier-border);
}

.demon-tracker-table th:last-child,
.demon-tracker-table td:last-child {
  border-right: none;
}

.demon-tracker-header {
  background: var(--background-secondary);
  font-weight: 600;
  font-size: 14px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  color: var(--text-muted);
}

.demon-tracker-header.stop-trading {
  background: var(--background-modifier-error);
  color: var(--text-error);
}

.demon-tracker-row {
  border-top: 1px solid var(--background-modifier-border);
}

.demon-tracker-row:hover {
  background: var(--background-modifier-hover);
}

/* Make AccountFilter seamlessly blend with tabs - remove top border and gap but keep box appearance */
.monthly-review-content .drc-section:first-child {
  border: 1px solid var(--background-modifier-border);
  border-top: none;
  border-radius: 0 0 6px 6px;
  margin: 0 0 24px 0;
  padding: 16px;
  background-color: var(--background-primary);
}

.demon-name {
  text-align: left;
  font-weight: 500;
  color: var(--text-normal);
}

.demon-occurrence {
  position: relative;
}

.demon-x {
  color: var(--text-error);
  font-weight: 600;
  font-size: 18px;
}

.demon-x.stop {
  color: var(--text-on-accent);
  background: var(--background-modifier-error);
  border-radius: 50%;
  width: 24px;
  height: 24px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

.demon-empty {
  color: var(--text-faint);
  font-size: 14px;
}

/* Demon Tracker Summary */
.demon-tracker-summary {
  margin-top: 20px;
  display: flex;
  gap: 20px;
  flex-wrap: wrap;
}

.demon-summary-item {
  display: flex;
  align-items: center;
  gap: 8px;
}

.demon-summary-label {
  font-size: 14px;
  color: var(--text-muted);
}

.demon-summary-value {
  font-size: 16px;
  font-weight: 600;
  color: var(--text-normal);
}

.demon-summary-item.warning .demon-summary-value {
  color: var(--text-error);
}

/* Monthly Review Header */
.monthly-review-header {
  padding: 16px 20px 12px;
  background-color: var(--background-secondary);
  text-align: center;
  border-bottom: 1px solid var(--background-modifier-border);
}

/* Review Content Placeholder */
.monthly-review-content-placeholder {
  padding: 40px;
  text-align: center;
  color: var(--text-muted);
  background: var(--background-secondary-alt);
  border-radius: 6px;
  border: 1px dashed var(--background-modifier-border);
}

/* Navigation */
.monthly-review-navigation {
  width: 100%;
  padding-top: 10px;
  border-top: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1));
  background-color: var(--background-secondary);
}

.monthly-review-navigation-links {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
  width: 100%;
}

.monthly-review-navigation-button {
  padding: 8px 14px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  background-color: var(--background-primary);
  color: var(--text-normal);
  cursor: pointer;
  font-size: 14px;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  flex: 1;
  text-align: center;
  min-width: 120px;
  box-sizing: border-box;
}

.monthly-review-navigation-button:hover {
  background-color: var(--background-modifier-hover);
  transform: translateY(-1px);
}

.monthly-review-navigation-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* Tab Navigation */
.monthly-review-tabs-container {
  display: flex;
  justify-content: center;
  border-bottom: 1px solid var(--background-modifier-border);
  background-color: var(--background-secondary-alt, #2a2a2a);
  padding: 0;
}

.monthly-review-tabs {
  display: flex;
  justify-content: center;
  background-color: transparent;
  max-width: 600px;
  margin: 0 auto;
}

.monthly-review-tab {
  padding: 12px 24px;
  font-size: 14px;
  font-weight: 600;
  color: var(--text-muted);
  background-color: transparent;
  border: none;
  border-bottom: 2px solid transparent;
  cursor: pointer;
  transition: all 0.2s ease;
  position: relative;
  outline: none;
}

.monthly-review-tab:hover {
  color: var(--text-normal);
  background-color: rgba(127, 127, 127, 0.05);
}

.monthly-review-tab.active {
  color: var(--text-accent);
  border-bottom: 2px solid var(--text-accent);
}

/* Charts */
.monthly-review-overview .recharts-responsive-container {
  margin: 0 auto;
}

/* Overview Tab */
.monthly-review-overview {
  padding-top: 4px;
}

/* Review Tab */
.monthly-review-review {
  padding-top: 4px;
}

/* Reduce spacing for first elements in tab content */
.monthly-review-overview > *:first-child,
.monthly-review-review > *:first-child {
  margin-top: 0 !important;
}

/* Game Performance Tables */
.grade-count {
  text-align: center;
  font-weight: 600;
  padding: 8px;
}

.grade-count.grade-a {
  color: var(--color-green, #43a047);
}

.grade-count.grade-b {
  color: var(--color-orange, #fb8c00);
}

.grade-count.grade-c {
  color: var(--color-red, #e53935);
}

.rating-cell {
  text-align: center;
  font-weight: 600;
}

.notes-cell {
  max-width: 300px;
}

.notes-content {
  white-space: pre-wrap;
  word-break: break-word;
  line-height: 1.4;
  color: var(--text-muted);
  font-size: 13px;
}

.empty-performance-message {
  text-align: center;
  color: var(--text-muted);
  padding: 20px;
  font-style: italic;
}
`});function qZ(){mf||(mf=document.createElement("style"),mf.textContent=UZ,mf.id="journalit-monthly-review-styles",document.head.appendChild(mf))}function VIe(){mf&&(mf.remove(),mf=null)}function VZ(){mf||qZ()}var mf,wB=F(()=>{co();HZ();mf=null;we.monthlyReview={inject:qZ,remove:VIe}});function AI(){if(document.head.querySelector("#settings-tab-styles"))return;let e=document.createElement("style");e.id="settings-tab-styles",e.textContent=GIe,document.head.appendChild(e)}var GIe,kB=F(()=>{GIe=`
  /* Settings container layout */
  .journalit-settings {
    display: flex;
    flex-direction: column;
    width: 100%;
    height: 100%;
    overflow: auto;
    padding: 0;
  }

  .journalit-settings-wrapper {
    display: flex;
    flex-direction: column;
    width: 100%;
    height: 100%;
    padding: 16px;
    box-sizing: border-box;
    overflow-y: visible;
  }

  /* Settings tab container */
  .settings-tab-container {
    display: flex;
    flex-direction: column;
    height: 100%;
    width: 100%;
    overflow: visible;
    padding: 16px;
    background: var(--background-primary);
  }

  /* Tab navigation */
  .settings-tab-nav {
    display: flex;
    border-bottom: 1px solid var(--background-modifier-border);
    margin-bottom: 4px;
    justify-content: center;
    width: 100%;
    padding-bottom: 0;
  }

  /* Tab button base styles */
  .settings-tab-button {
    padding: 8px 16px;
    cursor: pointer;
    border-top: none;
    border-right: none;
    border-left: none;
    border-bottom: 2px solid transparent;
    color: var(--text-muted);
    font-weight: 500;
    margin-right: 8px;
    position: relative;
    bottom: -1px;
    background: transparent;
    border-radius: 0;
    font-size: 14px;
    transition: all 0.15s ease;
  }

  /* Active tab button */
  .settings-tab-button--active {
    border-bottom-color: var(--text-accent);
    color: var(--text-normal);
    font-weight: 600;
  }

  /* Settings tab content area */
  .settings-tab-content {
    flex: 1;
    overflow-y: auto;
    padding: 4px 24px 20px;
    background: var(--background-primary);
  }

  /* Fix for Custom Options edit input */
  .journalit-settings.journalit-settings-tab .option-edit-input {
    flex: 1 !important;
    margin-right: 12px !important;
    padding: 6px 10px !important;
    border: 1px solid var(--interactive-accent) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.3) !important;
    position: relative !important;
    z-index: 100 !important;
    min-width: 100px !important;
    pointer-events: auto !important;
    -webkit-user-select: text !important;
    user-select: text !important;
    cursor: text !important;
  }

  /* DRC, Weekly Review, and Custom Options Settings Styles */
  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add,
  .journalit-settings.journalit-settings-tab .custom-options-settings .custom-item-add {
    display: flex !important;
    flex-direction: row !important;
    align-items: center !important;
    width: 100% !important;
    gap: 10px !important;
    margin-bottom: 16px !important;
    position: relative !important;
    padding: 4px 0 !important;
  }

  /* Override any Obsidian styling that might interfere */
  .journalit-settings.journalit-settings-tab .drc-settings input[type="text"],
  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add input,
  .journalit-settings.journalit-settings-tab .weekly-review-settings input[type="text"],
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add input,
  .journalit-settings.journalit-settings-tab .custom-options-settings input[type="text"],
  .journalit-settings.journalit-settings-tab .custom-options-settings .custom-item-add input {
    height: 34px !important;
    line-height: normal !important;
    font-size: 16px !important;
    padding: 6px 10px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    width: 100% !important;
    box-sizing: border-box !important;
    margin: 0 !important;
    appearance: none !important;
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
  }

  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add .input,
  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add input,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add .input,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add input,
  .journalit-settings.journalit-settings-tab .custom-options-settings .custom-item-add .input,
  .journalit-settings.journalit-settings-tab .custom-options-settings .custom-item-add input {
    width: 100% !important;
    height: 34px !important;
    max-height: 34px !important;
    padding: 6px 10px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    font-size: 16px !important;
    box-shadow: none !important;
    transition: border-color 0.15s ease, box-shadow 0.15s ease !important;
    line-height: normal !important;
    min-height: 34px !important;
    display: inline-block !important;
    appearance: none !important;
    overflow: visible !important;
  }

  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add .input:focus,
  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add input:focus,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add .input:focus,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add input:focus {
    border-color: var(--interactive-accent) !important;
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2) !important;
    outline: none !important;
  }

  /* Style Input component's internals */
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .drc-settings .custom-item-add .inputContainer,
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .drc-settings .custom-item-add .inputWrapper,
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .weekly-review-settings .custom-item-add .inputContainer,
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .weekly-review-settings .custom-item-add .inputWrapper {
    margin: 0 !important;
    padding: 0 !important;
    width: 100% !important;
    position: relative !important;
    display: block !important;
    height: 34px !important;
  }

  /* Style Input's invisible parent divs */
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .drc-settings .custom-item-add div,
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .drc-settings .custom-item-add .setting-item-info div,
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .weekly-review-settings .custom-item-add div,
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .weekly-review-settings .custom-item-add .setting-item-info div {
    height: auto !important;
    min-height: 34px !important;
    width: 100% !important;
    position: relative !important;
  }

  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add .inputContainer,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add .inputContainer {
    margin: 0 !important;
    padding: 0 !important;
    width: 100% !important;
    position: relative !important;
    display: block !important;
  }

  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add .setting-item-info,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add .setting-item-info {
    margin-right: 10px !important;
    flex: 1 !important;
    display: flex !important;
    flex-direction: column !important;
    justify-content: center !important;
  }

  /* Styles for the Add button */
  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add .setting-item-control,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add .setting-item-control {
    display: flex !important;
    align-items: center !important;
    justify-content: flex-end !important;
    min-width: auto !important;
    flex-shrink: 0 !important;
  }

  /* Ensure buttons have consistent styling */
  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add button,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add button {
    min-width: 60px !important;
    height: 34px !important;
    max-height: 34px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    font-size: 16px !important;
    font-weight: 500 !important;
    padding: 6px 12px !important;
    border-radius: 4px !important;
    background-color: var(--interactive-accent) !important;
    color: var(--text-on-accent, white) !important;
    border: 1px solid var(--interactive-accent) !important;
    cursor: pointer !important;
    transition: background-color 0.15s ease !important;
  }

  .journalit-settings.journalit-settings-tab .drc-settings button:hover,
  .journalit-settings.journalit-settings-tab .weekly-review-settings button:hover {
    background-color: var(--interactive-accent-hover) !important;
    border-color: var(--interactive-accent-hover) !important;
  }

  /* Direct styling for DRCSettingsTab, WeeklyReviewSettingsTab, and CustomOptionsTab input boxes */
  /* First, add general selector for all input boxes in custom-item-add */
  .journalit-settings .drc-settings .custom-item-add input,
  .journalit-settings .weekly-review-settings .custom-item-add input,
  .journalit-settings .custom-options-settings .custom-item-add input,
  /* Then, add specific selectors for known inputs */
  .journalit-settings input[placeholder="New checklist item"],
  .journalit-settings input[placeholder="New review question"],
  .journalit-settings input[placeholder="New timeframe (e.g., 15M, 5M)"],
  .journalit-settings input[placeholder="New timeframe (e.g., 4H, 1H)"],
  .journalit-settings input[placeholder="New timeframe (e.g., Weekly, Daily)"] {
    height: 34px !important;
    width: 100% !important;
    padding: 6px 10px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    font-size: 16px !important;
    box-shadow: none !important;
    transition: border-color 0.15s ease, box-shadow 0.15s ease !important;
    line-height: normal !important;
    min-height: 34px !important;
    display: inline-block !important;
    appearance: none !important;
    overflow: visible !important;
    margin: 0 !important;
  }

  /* Focus styles for all input boxes */
  .journalit-settings .drc-settings .custom-item-add input:focus,
  .journalit-settings .weekly-review-settings .custom-item-add input:focus,
  .journalit-settings .custom-options-settings .custom-item-add input:focus,
  .journalit-settings input[placeholder="New checklist item"]:focus,
  .journalit-settings input[placeholder="New review question"]:focus,
  .journalit-settings input[placeholder="New timeframe (e.g., 15M, 5M)"]:focus,
  .journalit-settings input[placeholder="New timeframe (e.g., 4H, 1H)"]:focus,
  .journalit-settings input[placeholder="New timeframe (e.g., Weekly, Daily)"]:focus {
    /* These focus styles ensure all input boxes have the same appearance when focused */
    border-color: var(--interactive-accent) !important;
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2) !important;
    outline: none !important;
  }

  /* Accordion Component Styles */
  .cmdr-accordion {
    margin-bottom: 16px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    overflow: visible; /* Changed from hidden to visible */
    transition: box-shadow 0.2s ease;
  }

  .cmdr-accordion:hover {
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
  }

  .cmdr-accordion .cmdr-accordion-header {
    display: flex;
    align-items: center;
    padding: 12px 16px;
    cursor: pointer;
    background-color: var(--background-secondary);
    transition: background-color 0.15s ease;
  }

  .cmdr-accordion .cmdr-accordion-header:hover {
    background-color: var(--background-modifier-hover);
  }

  .cmdr-accordion .cmdr-accordion-chevron > svg {
    transition: transform 0.3s ease-in-out;
  }

  .cmdr-accordion .cmdr-accordion-content {
    max-height: none; /* Removed the fixed max-height */
    transition: max-height 0.3s ease-in-out, padding 0.3s ease-in-out, margin 0.3s ease-in-out;
    overflow: visible; /* Changed from hidden to visible for expanded state */
    background-color: var(--background-primary);
    padding: 16px;
  }

  /* Fix for Weekly Review accordion - Remove borders from inside accordion content to prevent duplicate borders
   * This ensures consistent styling between Daily Review and Weekly Review sections.
   * The issue was that the first setting-item inside the accordion had a border-top which created
   * a duplicate border when the accordion already has its own border.
   */
  .cmdr-accordion .cmdr-accordion-content .timeframe-manager > .setting-item:first-child,
  .cmdr-accordion .cmdr-accordion-content .item-manager > .setting-item:first-child,
  .cmdr-accordion .cmdr-accordion-content > div > .setting-item:first-child,
  .cmdr-accordion .cmdr-accordion-content > .setting-item:first-child {
    border-top: none !important;
  }

  /* Remove border around weekly-review-section to match daily-review-section */
  .cmdr-accordion .cmdr-accordion-content .weekly-review-section {
    border: none !important;
    border-radius: 0 !important;
    padding: 0 !important;
    background-color: transparent !important;
  }

  /* Style for consistent input heights/spacing specifically for the timeframe manager */
  .timeframe-manager .custom-item-add .inputContainer,
  .timeframe-manager .custom-item-add input {
    height: 34px !important;
    min-height: 34px !important;
    margin: 0 !important;
    width: 100% !important;
  }

  /* Collapsed state */
  .cmdr-accordion[aria-expanded="false"] .cmdr-accordion-chevron > svg {
    transform: rotate(-90deg);
  }

  .cmdr-accordion[aria-expanded="false"] .cmdr-accordion-content {
    max-height: 0 !important;
    transition: max-height 0.2s ease-out;
    padding-top: 0;
    padding-bottom: 0;
    margin-top: 0;
    margin-bottom: 0;
    overflow: hidden; /* Keep hidden for collapsed state only */
  }
  
  /* Edit account form container - ensure proper layout */
  .journalit-settings .edit-account-form.setting-item-container,
  .journalit-settings.journalit-settings-tab .edit-account-form.setting-item-container {
    display: flex !important;
    flex-direction: column !important;
    width: 100% !important;
    align-items: stretch !important;
  }

  /* Edit account buttons - updated layout for left-center-right arrangement */
  .journalit-settings .edit-account-form.setting-item-container .edit-account-buttons,
  .journalit-settings.journalit-settings-tab .edit-account-form.setting-item-container .edit-account-buttons {
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    width: 100% !important;
    margin-top: 16px !important;
    position: relative !important;
  }
  
  .journalit-settings .edit-account-form.setting-item-container .edit-account-buttons .button-group-right,
  .journalit-settings.journalit-settings-tab .edit-account-form.setting-item-container .edit-account-buttons .button-group-right {
    display: flex !important;
    gap: 8px !important;
    align-items: center !important;
  }
  
  /* Force accounts to display in a single column */
  .journalit-settings .accounts-list,
  .journalit-settings.journalit-settings-tab .accounts-list {
    display: flex !important;
    flex-direction: column !important;
    flex-wrap: nowrap !important;
    width: 100% !important;
  }

  .journalit-settings .account-items,
  .journalit-settings.journalit-settings-tab .account-items {
    display: flex !important;
    flex-direction: column !important;
    width: 100% !important;
    flex-wrap: nowrap !important;
  }

  .journalit-settings .account-item,
  .journalit-settings.journalit-settings-tab .account-item {
    width: 100% !important;
  }

  /* MT Accounts List Styles */
  .mt-accounts-list {
    margin-top: 10px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 8px;
    overflow: hidden;
  }

  .mt-account-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px;
    border-bottom: 1px solid var(--background-modifier-border);
    background-color: var(--background-primary);
  }

  .mt-account-item:last-child {
    border-bottom: none;
  }

  .mt-account-item:hover {
    background-color: var(--background-secondary);
  }

  .mt-account-info {
    flex: 1;
    min-width: 0;
  }

  .mt-account-id {
    font-weight: 600;
    color: var(--text-normal);
    margin-bottom: 4px;
  }

  .mt-account-broker {
    color: var(--text-muted);
    font-size: 0.9em;
    margin-bottom: 4px;
  }

  .mt-account-dates {
    color: var(--text-muted);
    font-size: 0.85em;
  }

  .mt-account-display {
    margin-left: 20px;
    min-width: 250px;
  }

  .mt-account-name {
    display: flex;
    align-items: center;
  }

  .mt-account-name span {
    font-weight: 500;
    color: var(--text-normal);
  }

  .mt-account-edit {
    display: flex;
    align-items: center;
  }

  .mt-account-edit input {
    background-color: var(--background-primary-alt);
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    padding: 4px 8px;
    color: var(--text-normal);
  }

  .mt-account-edit input:focus {
    border-color: var(--interactive-accent);
    outline: none;
  }

  /* Auto-adjust dropdown width based on content */
  /* High specificity to override existing rules */
  .journalit-settings .setting-item-control,
  .journalit-settings-tab .setting-item-control {
    min-width: 120px !important;
    width: fit-content !important;
    flex-shrink: 0 !important;
  }

  .journalit-settings .setting-item-control select,
  .journalit-settings .setting-item-control .selectContainer,
  .journalit-settings .setting-item-control .select,
  .journalit-settings-tab .setting-item-control select,
  .journalit-settings-tab .setting-item-control .selectContainer,
  .journalit-settings-tab .setting-item-control .select {
    width: auto !important;
    min-width: 120px !important;
    text-align: center !important;
  }

  /* Fix dropdown option background color */
  .journalit-settings select option {
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
  }

  .journalit-settings select option:hover {
    background-color: var(--background-modifier-hover) !important;
  }

  /* Fix for CSS module fallback classes - Input component */
  .journalit-settings .inputContainer {
    display: flex;
    flex-direction: column;
    gap: 4px;
    width: 100%;
  }

  .journalit-settings .input,
  .journalit-settings textarea.input {
    width: 100% !important;
    padding: 8px 12px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    font-size: 14px !important;
    font-family: inherit !important;
    resize: vertical !important;
  }

  .journalit-settings .input:focus,
  .journalit-settings textarea.input:focus {
    border-color: var(--interactive-accent) !important;
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2) !important;
    outline: none !important;
  }

  /* Fix for Button component - uses journalit-button classes */
  .journalit-settings .journalit-button {
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    border-radius: 4px !important;
    font-weight: 500 !important;
    cursor: pointer !important;
    transition: background-color 0.15s ease, border-color 0.15s ease, color 0.15s ease !important;
    gap: 8px !important;
    user-select: none !important;
    outline: none !important;
    min-width: 80px !important;
  }

  /* Button sizes */
  .journalit-settings .journalit-button--small {
    padding: 6px 12px !important;
    font-size: 13px !important;
    height: 32px !important;
  }

  .journalit-settings .journalit-button--medium {
    padding: 8px 16px !important;
    font-size: 14px !important;
    height: 36px !important;
  }

  .journalit-settings .journalit-button--large {
    padding: 12px 24px !important;
    font-size: 16px !important;
    height: 44px !important;
  }

  /* Button variants */
  .journalit-settings .journalit-button--primary {
    background-color: var(--interactive-accent) !important;
    color: var(--text-on-accent, white) !important;
    border: 1px solid var(--interactive-accent) !important;
  }

  .journalit-settings .journalit-button--primary:hover:not(:disabled) {
    background-color: var(--interactive-accent-hover) !important;
    border-color: var(--interactive-accent-hover) !important;
  }

  .journalit-settings .journalit-button--secondary {
    background-color: var(--background-secondary) !important;
    color: var(--text-normal) !important;
    border: 1px solid var(--background-modifier-border) !important;
  }

  .journalit-settings .journalit-button--secondary:hover:not(:disabled) {
    background-color: var(--background-modifier-hover) !important;
  }

  .journalit-settings .journalit-button--danger {
    background-color: var(--background-modifier-error) !important;
    color: var(--text-on-accent, white) !important;
    border: 1px solid var(--background-modifier-error) !important;
  }

  .journalit-settings .journalit-button--danger:hover:not(:disabled) {
    opacity: 0.9 !important;
  }

  .journalit-settings .journalit-button:disabled {
    opacity: 0.5 !important;
    cursor: not-allowed !important;
  }

  /* Responsive styles for small screens */
  @media (max-width: 600px) {
    .journalit-settings.journalit-settings-tab input[type="text"],
    .journalit-settings.journalit-settings-tab .custom-item-add input,
    .journalit-settings input,
    .mt-account-edit input {
      font-size: 18px !important;
    }
  }

  @media (max-width: 768px) {
    .settings-tab-nav {
      flex-wrap: wrap;
      justify-content: flex-start;
      gap: 8px;
    }

    .settings-tab-button {
      margin-right: 0;
    }
  }
`});function KIe(){if(document.head.querySelector("#trade-note-styles"))return;let e=document.createElement("style");e.id="trade-note-styles",e.textContent=YIe,document.head.appendChild(e)}function sh(){KIe()}var YIe,GZ=F(()=>{YIe=`
  /**
   * Main container styles
   * These ensure proper containment and isolation of the TradeNote component
   */

  /* Main container */
  .journalit-trade-view,
  .trade-form-view-container .journalit-trade-view {
    margin-top: 0;
    margin-bottom: 0;
    border-bottom: none;
    padding: 0;
    display: block !important;
    width: 100% !important;
    z-index: 1;
    /* Ensure proper containment */
    position: relative;
    box-sizing: border-box;
    /* Prevent overlaps */
    contain: content;
    /* Ensure proper isolation from other views */
    isolation: isolate;
  }
  
  /* Trade note React root wrapper */
  .journalit-trade-note-wrapper {
    width: 100%;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    contain: content;
    /* Keep React root fully contained */
    isolation: isolate;
    /* Create a new stacking context */
    position: relative;
    /* Ensure clean slate for each instance */
    box-sizing: border-box;
  }
  
  .trade-note-container {
    background-color: var(--background-primary);
    border-radius: var(--border-radius-lg, 8px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    margin: 0;
    overflow: hidden;
    position: relative;
    font-family: var(--font-interface);
    /* Border removed per UI update request */
    /* Ensure isolation */
    isolation: isolate;
    /* Create a new stacking context and force containment */
    contain: layout style paint;
    /* Ensure direct containment within parent */
    width: 100%;
    align-self: flex-start;
    /* Add a subtle distinguishing feature for easier debugging */
    transition: box-shadow 0.2s ease-in-out;
  }
  
  /* Header section with instrument and P&L */
  .trade-note-header {
    padding: 0.8rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    background: linear-gradient(to right, var(--background-secondary), var(--background-primary));
  }
  
  .trade-note-header.profit {
    background: linear-gradient(to right, rgba(102, 187, 106, 0.1), var(--background-primary));
    border-left: 4px solid var(--color-success, #43a047);
  }

  .trade-note-header.loss {
    background: linear-gradient(to right, rgba(229, 57, 53, 0.1), var(--background-primary));
    border-left: 4px solid var(--color-error, #e53935);
  }

  .trade-note-header.open {
    background: linear-gradient(to right, rgba(33, 150, 243, 0.1), var(--background-primary));
    border-left: 4px solid var(--status-open-color);
  }

  .trade-note-header.breakeven {
    background: linear-gradient(to right, rgba(128, 128, 128, 0.1), var(--background-primary));
    border-left: 4px solid var(--text-muted);
  }

  .trade-instrument {
    font-size: 1.4rem;
    font-weight: 600;
    color: var(--text-normal);
    display: flex;
    align-items: center;
  }
  
  .trade-direction-icon {
    margin-right: 0.5rem;
    font-size: 1.3rem;
    line-height: 1;
  }
  
  /* Header actions container with edit button and PnL */
  .trade-header-actions {
    display: flex;
    align-items: center;
    gap: 1rem;
  }
  
  /* Edit button styling */
  .trade-edit-button {
    display: flex;
    align-items: center;
    gap: 0.3rem;
    background-color: var(--interactive-accent);
    color: var(--text-on-accent, white);
    border: none;
    border-radius: 4px;
    padding: 0.4rem 0.8rem;
    font-size: 0.8rem;
    font-weight: 500;
    cursor: pointer;
    transition: background-color 0.2s;
  }
  
  .trade-edit-button:hover {
    background-color: var(--interactive-accent-hover, var(--interactive-accent));
    opacity: 0.9;
  }
  
  .trade-edit-button svg {
    width: 14px;
    height: 14px;
  }

  .trade-pnl {
    font-size: 1.2rem;
    font-weight: 600;
  }
  
  .profit-text {
    color: var(--color-success, #43a047);
  }
  
  .loss-text {
    color: var(--color-error, #e53935);
  }

  .breakeven-text {
    color: var(--text-muted);
  }

  .open-text {
    color: var(--status-open-color);
    font-weight: 600;
  }
  
  /* Missed trade badge styling */
  .missed-trade-badge {
    background-color: var(--color-orange, #ff9800);
    color: var(--text-on-accent, white);
    padding: 0.2rem 0.6rem;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 700;
    margin-left: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
  }
  
  /* Open trade badge styling */
  .open-trade-badge {
    background-color: var(--status-open-color);
    color: var(--text-on-accent, white);
    padding: 0.2rem 0.6rem;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 700;
    margin-left: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
  }
  
  /* Backtest trade badge styling */
  .backtest-trade-badge {
    background-color: var(--color-purple, #6f42c1);
    color: var(--text-on-accent, white);
    padding: 0.2rem 0.6rem;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 700;
    margin-left: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
  }
  
  /* Removed tabs navigation - single page layout */
  
  /* Single page content container */
  .trade-note-content {
    padding: 0;
    display: flex;
    flex-direction: column;
    gap: 0.5rem; /* Reduced gap to minimize wasted space between sections */
  }
  
  /* Trade overview section with metrics */
  .trade-overview-section {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    padding: 0;
    position: relative;
    margin-bottom: 0;
  }

  /* Metrics grid - single row */
  .trade-metrics-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 0.8rem;
    margin-bottom: 0;
  }
  
  .metric-card {
    background-color: var(--background-primary);
    padding: 0.7rem;
    border-radius: var(--border-radius-md, 4px);
    border: 1px solid var(--background-modifier-border);
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    transition: transform 0.2s, box-shadow 0.2s, border-color 0.2s;
  }
  
  .metric-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 3px 6px rgba(0, 0, 0, 0.08);
    border-color: var(--interactive-accent-hover);
  }
  
  .metric-label {
    font-size: 0.75rem;
    color: var(--text-muted);
    text-transform: uppercase;
    margin-bottom: 0.2rem;
    letter-spacing: 0.5px;
  }
  
  .metric-value {
    font-size: 1.2rem;
    font-weight: 600;
    color: var(--text-normal);
    margin-bottom: 0.2rem;
  }
  
  .metric-subtitle {
    font-size: 0.7rem;
    color: var(--text-muted);
  }

  /* Metadata container for accounts and tags - no background */
  .trade-metadata-container {
    display: flex;
    flex-wrap: wrap;
    gap: 0.8rem;
    padding: 0.2rem 0;
  }

  .metadata-section {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .metadata-label {
    font-size: 0.8rem;
    font-weight: 600;
    color: var(--text-muted);
    white-space: nowrap;
  }

  .metadata-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.3rem;
  }
  
  /* Tags styling for setups and mistakes */
  .trade-tags-container {
    margin: 0;
  }
  
  .tags-row {
    display: flex;
    gap: 1rem;
    width: 100%;
  }
  
  .tags-section {
    flex: 1;
    margin-bottom: 0;
    background-color: var(--background-primary);
    border-radius: var(--border-radius-md, 4px);
    padding: 0.7rem;
    border: 1px solid var(--background-modifier-border);
  }
  
  .tags-section h4 {
    font-size: 0.85rem;
    margin-top: 0;
    margin-bottom: 0.5rem;
    color: var(--text-normal);
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 0.3rem;
  }

  /* Only keep icons for setup and mistake headers */
  .setup-section h4::before {
    content: '\u2713'; /* Checkmark symbol */
    color: var(--color-secondary, var(--text-accent));
    font-weight: bold;
  }

  .mistake-section h4::before {
    content: '\u26A0'; /* Warning symbol */
    color: var(--color-error, #e53935);
    font-weight: bold;
  }
  
  .tags-list {
    display: flex;
    flex-wrap: wrap;
    gap: 0.4rem;
  }
  
  .tag {
    padding: 0.35rem 0.7rem;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 500;
    display: inline-flex;
    align-items: center;
    transition: transform 0.15s ease;
    color: var(--text-normal);
  }

  .tag:hover {
    transform: translateY(-1px);
  }
  
  .setup-tag {
    background-color: rgba(66, 133, 244, 0.15);
    color: rgba(66, 133, 244, 1);
    border: 1px solid rgba(66, 133, 244, 0.3);
  }
  
  .mistake-tag {
    background-color: rgba(229, 57, 53, 0.15);
    color: var(--color-error, #e53935);
    border: 1px solid rgba(229, 57, 53, 0.3);
  }

  .account-tag {
    padding: 0.35rem 0.7rem;
    color: var(--text-accent);
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 500;
    display: inline-flex;
    align-items: center;
    cursor: pointer;
    transition: transform 0.15s ease, color 0.15s ease;
    text-decoration: underline;
    text-decoration-style: dotted;
    text-underline-offset: 3px;
  }
  
  .account-tag:hover {
    transform: translateY(-1px);
    color: var(--text-accent-hover, var(--text-accent));
  }
  
  /* Notes preview */
  .trade-notes-preview {
    background-color: var(--background-secondary);
    padding: 1rem;
    border-radius: var(--border-radius-md, 4px);
    margin-top: 1.5rem;
  }
  
  .trade-notes-preview h4 {
    font-size: 0.9rem;
    margin-bottom: 0.8rem;
    color: var(--text-normal);
  }
  
  .trade-notes-preview p {
    color: var(--text-normal);
    font-size: 0.9rem;
    line-height: 1.6;
    margin: 0;
  }
  
  /* Trade details footer - modernized layout */
  .trade-details-footer {
    margin-top: 0;
  }
  
  .details-card {
    background-color: var(--background-primary);
    padding: 1rem;
    border-radius: var(--border-radius-md, 6px);
    box-shadow: 0 1px 5px rgba(0, 0, 0, 0.05);
    border: 1px solid var(--background-modifier-border);
    margin-bottom: 0;
    transition: box-shadow 0.2s ease;
  }

  .details-card:hover {
    box-shadow: 0 3px 8px rgba(0, 0, 0, 0.08);
  }
  
  .details-card.expanded-details {
    width: 100%;
  }

  .details-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.8rem;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--background-modifier-border);
  }
  
  .details-card h4 {
    font-size: 1rem;
    margin: 0;
    color: var(--text-normal);
  }
  
  /* Main content area */
  .trade-main-content {
    display: flex;
    flex-direction: column;
    gap: 0;
  }

  /* Enhanced thesis section styling - no emoji */
  .thesis-section {
    background-color: var(--background-primary);
    padding: 1rem 1.2rem;
    border-radius: var(--border-radius-md, 6px);
    box-shadow: 0 1px 5px rgba(0, 0, 0, 0.05);
    border: 1px solid var(--background-modifier-border);
    margin: 0;
    position: relative;
  }
  
  
  .thesis-section h4 {
    font-size: 1rem;
    margin-top: 0;
    margin-bottom: 1rem;
    color: var(--text-normal);
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--background-modifier-border);
    position: relative;
  }
  
  .thesis-content {
    font-size: 0.95rem;
    line-height: 1.7;
    color: var(--text-normal);
    white-space: pre-wrap;
    padding: 0 0.2rem;
  }
  
  .details-card h4 {
    font-size: 0.9rem;
    margin-top: 0;
    margin-bottom: 0.8rem;
    color: var(--text-normal);
    /* Remove the border-bottom as requested */
    padding-bottom: 0;
  }
  
  .details-table {
    width: 100%;
    border-collapse: collapse;
    table-layout: fixed;
  }
  
  .details-table td {
    padding: 0.6rem 0.5rem;
    font-size: 0.9rem;
    text-overflow: ellipsis;
    overflow: hidden;
    border-bottom: none;
  }
  
  /* Only add borders between content groups */
  .details-table tr:nth-child(2) td {
    border-bottom: 1px solid var(--background-modifier-border-hover, rgba(0, 0, 0, 0.04));
    padding-bottom: 0.8rem;
  }
  
  .details-table tr:nth-child(3) td {
    padding-top: 0.8rem;
  }
  
  .details-table tr:nth-child(4) td {
    border-bottom: 1px solid var(--background-modifier-border-hover, rgba(0, 0, 0, 0.04));
    padding-bottom: 0.8rem;
  }
  
  .details-table tr:nth-child(5) td {
    padding-top: 0.8rem;
  }
  
  .details-table td:nth-child(odd) {
    color: var(--text-muted);
    width: 20%;
    font-weight: 500;
  }
  
  .details-table td:nth-child(even) {
    color: var(--text-normal);
    font-weight: 500;
    width: 30%;
  }
  
  .details-list {
    list-style-type: none;
    padding: 0;
    margin: 0;
  }
  
  .details-list li {
    padding: 0.4rem 0;
    font-size: 0.9rem;
    color: var(--text-normal);
    border-bottom: 1px solid var(--background-modifier-border-hover, var(--background-modifier-border));
  }
  
  /* Accounts list styling */
  .accounts-list {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    padding: 0.2rem 0;
  }
  
  /* Account tags styled as clickable bubbles */
  .account-tag {
    padding: 0.4rem 0.8rem;
    background-color: var(--background-secondary-alt, var(--background-secondary));
    color: var(--text-normal);
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 500;
    display: inline-block;
    cursor: pointer; /* Show pointer to indicate clickability */
    transition: background-color 0.2s;
  }
  
  .account-tag:hover {
    background-color: var(--background-modifier-hover);
  }
  
  .notes-content {
    font-size: 0.9rem;
    line-height: 1.6;
    color: var(--text-normal);
    white-space: pre-wrap;
  }
  
  /* Trade images styling */
  .trade-images-section {
    display: flex;
    flex-direction: column;
    align-items: center;
    background-color: var(--background-secondary);
    border-radius: var(--border-radius-md, 4px);
    padding: 0.6rem 0; /* Reduce horizontal padding */
    margin: 0; /* Remove margin to use container gap */
    width: 100%; /* Ensure full width */
  }
  
  /* Special styling for container with only one image - eliminate all padding */
  .trade-images-section[data-image-count="1"] {
    padding: 0; /* Remove all padding when there's only one image */
    margin: 0;
  }
  
  /* Ensure proper sizing of the ImageCarousel within the TradeNote */
  .trade-images-section .journalit-image-carousel {
    margin-bottom: 0;
    background-color: transparent;
    box-shadow: none;
    padding: 0;
  }
  
  /* Special handling for single image scenarios - remove any extra spacing */
  .trade-images-section .journalit-image-carousel[data-single-image="true"],
  .trade-images-section[data-image-count="1"] .journalit-image-carousel {
    padding: 0;
    margin: 0;
  }
  
  /* Remove all padding/margin from image container if it's a single image */
  .trade-images-section .journalit-image-carousel[data-single-image="true"] .image-container,
  .trade-images-section[data-image-count="1"] .image-container,
  .trade-images-section[data-image-count="1"] .journalit-carousel-image-container {
    margin: 0;
    padding: 0;
  }
  
  /* More aggressive fixes for single image mode - eliminate all possible gaps */
  .trade-images-section[data-image-count="1"] * {
    margin-top: 0;
    margin-bottom: 0;
  }
  
  /* Target our specific single-image-carousel class */
  .single-image-carousel,
  .single-image-carousel .journalit-carousel-main,
  .single-image-carousel .journalit-carousel-image-container {
    padding: 0 !important;
    margin: 0 !important;
  }
  
  /* Force the single image to directly touch the metrics below */
  .trade-images-section[data-image-count="1"] + .trade-metrics-grid {
    margin-top: 0;
  }
  
  /* Empty state styling */
  .trade-empty-images {
    display: flex;
    flex-direction: column;
    align-items: center;
    background-color: var(--background-secondary);
    border-radius: var(--border-radius-md, 4px);
    padding: 0.8rem 0; /* Reduce horizontal padding */
    margin: 0; /* Remove margin to use container gap */
    width: 100%; /* Ensure full width */
  }
  
  .image-carousel {
    position: relative;
    width: 100%;
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  /* Remove all margins for single image carousels */
  .trade-images-section[data-image-count="1"] .image-carousel,
  .trade-images-section[data-image-count="1"] .journalit-carousel-main {
    margin: 0;
    padding: 0;
  }
  
  .image-container {
    width: 100%;
    max-height: 400px;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    background-color: var(--background-secondary-alt, var(--background-secondary));
    border-radius: var(--border-radius-md, 4px);
  }
  
  .image-container img {
    max-width: 100%;
    max-height: 400px;
    object-fit: contain;
  }
  
  .carousel-button {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: var(--background-secondary);
    color: var(--text-normal);
    border: 1px solid var(--background-modifier-border);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    opacity: 0.7;
    transition: opacity 0.2s, background-color 0.2s;
    z-index: 10;
  }
  
  .carousel-button:hover {
    opacity: 1;
    background-color: var(--background-primary);
  }
  
  .carousel-button.prev {
    left: 10px;
  }
  
  .carousel-button.next {
    right: 10px;
  }
  
  .image-counter {
    font-size: 0.8rem;
    color: var(--text-muted);
    margin-bottom: 0.3rem;
  }
  
  /* Hide image counter completely when there's only one image */
  .trade-images-section[data-image-count="1"] .image-counter {
    display: none;
  }
  
  .image-thumbnails {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
    justify-content: center;
    max-width: 100%;
    margin-top: 0.3rem;
  }
  
  .thumbnail {
    width: 60px;
    height: 60px;
    border-radius: var(--border-radius-sm, 2px);
    overflow: hidden;
    cursor: pointer;
    opacity: 0.7;
    transition: opacity 0.2s;
    border: 2px solid transparent;
  }
  
  .thumbnail:hover {
    opacity: 1;
  }
  
  .thumbnail.active {
    opacity: 1;
    border-color: var (--color-primary, var(--interactive-accent));
  }
  
  .thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  
  /* Responsive adjustments */
  @media (max-width: 900px) {
    .trade-metrics-grid {
      grid-template-columns: repeat(2, 1fr);
    }
    
    .details-table {
      table-layout: auto;
    }

    .details-table td:nth-child(odd) {
      width: auto;
      min-width: 100px;
    }

    .details-table td:nth-child(even) {
      width: auto;
    }
  }

  @media (max-width: 768px) {
    .trade-note-content {
      padding: 0;
      gap: 0.6rem;
    }
    
    .tags-row {
      flex-direction: column;
      gap: 0.8rem;
    }

    .details-table {
      display: block;
      overflow-x: auto;
    }
    
    .details-table td {
      padding: 0.5rem 0.3rem;
      word-break: break-word;
    }

    .thesis-section {
      padding: 0.8rem;
    }

    .thesis-section h4 {
      font-size: 0.9rem;
      margin-bottom: 0.7rem;
    }

    .thesis-content {
      font-size: 0.85rem;
      line-height: 1.5;
    }
  }

  @media (max-width: 480px) {
    .trade-metrics-grid {
      grid-template-columns: 1fr;
      gap: 0.5rem;
    }

    .metadata-section {
      flex-direction: column;
      align-items: flex-start;
    }

    .setup-section h4::before,
    .mistake-section h4::before {
      display: none; /* Hide emojis on very small screens */
    }
  }
  
  /* Trade Navigation Styles */
  .trade-navigation-container {
    display: flex;
    flex-direction: column;
    padding: 0.2rem 0.8rem 0.6rem 0.8rem; /* Reduced padding to match DRC tightness */
    background-color: var(--background-secondary);
    border-bottom: 1px solid var(--background-modifier-border);
  }
  
  /* Container for navigation and edit button */
  .trade-navigation-with-edit {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    margin-bottom: 0.8rem;
  }
  
  /* Container for edit button to help with alignment */
  .edit-button-container {
    display: flex;
    align-items: center;
    height: auto;
    padding-top: 0;
  }
  
  /* Timeline styles */
  .trade-timeline-container {
    display: flex;
    flex-direction: column;
    gap: 0.6rem;
    margin-bottom: 0.3rem; /* Reduced bottom margin */
  }
  
  .trade-timeline {
    display: flex;
    align-items: center;
  }
  
  .timeline-label {
    font-size: 0.85rem;
    font-weight: 500;
    color: var(--text-normal);
    margin-right: 0.8rem;
    white-space: nowrap;
    min-width: 70px;
  }
  
  .timeline-label.active-ticker {
    font-weight: 600;
    color: var(--interactive-accent);
  }
  
  .timeline-items {
    display: flex;
    flex-wrap: wrap;
    gap: 0.4rem;
  }
  
  .timeline-item {
    padding: 0.3rem 0.6rem;
    background-color: var(--background-primary);
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    font-size: 0.8rem;
    font-weight: 500;
    color: var(--text-muted);
    cursor: pointer;
    transition: all 0.2s ease;
  }
  
  .timeline-item:hover {
    background-color: var(--background-modifier-hover);
    color: var(--text-normal);
  }
  
  /* PnL color coding */
  .timeline-item.profit {
    background-color: rgba(102, 187, 106, 0.15);
    color: var(--color-success, #43a047);
    border-color: rgba(102, 187, 106, 0.3);
  }
  
  .timeline-item.loss {
    background-color: rgba(229, 57, 53, 0.15);
    color: var(--color-error, #e53935);
    border-color: rgba(229, 57, 53, 0.3);
  }
  
  .timeline-item.open {
    background-color: rgba(33, 150, 243, 0.15);
    color: var(--color-info, #2196f3);
    border-color: rgba(33, 150, 243, 0.3);
  }
  
  .timeline-item.profit:hover {
    background-color: rgba(102, 187, 106, 0.25);
  }
  
  .timeline-item.loss:hover {
    background-color: rgba(229, 57, 53, 0.25);
  }
  
  .timeline-item.open:hover {
    background-color: rgba(33, 150, 243, 0.25);
  }
  
  /* Backtest trade timeline items */
  .timeline-item.backtest-trade {
    background-color: rgba(138, 43, 226, 0.15);
    color: var(--color-purple, #8a2be2);
    border-color: rgba(138, 43, 226, 0.3);
    font-weight: 500;
  }

  .timeline-item.backtest-trade:hover {
    background-color: rgba(138, 43, 226, 0.25);
    transform: translateY(-1px);
  }

  .timeline-item.backtest-trade.active {
    border: 2px solid var(--color-purple, #8a2be2);
    background-color: rgba(138, 43, 226, 0.2);
    font-weight: 600;
  }
  
  /* Active state now uses a prominent border instead of background */
  .timeline-item.active {
    border: 2px solid var(--interactive-accent);
    font-weight: 600;
  }
  
  .timeline-item.active.profit {
    border-color: var(--interactive-accent);
  }
  
  .timeline-item.active.loss {
    border-color: var(--interactive-accent);
  }
  
  /* Navigation buttons for reviews */
  .trade-review-navigation {
    flex: 1;
    border-bottom: 1px solid var(--background-modifier-border);
    padding-bottom: 0.8rem;
    margin-bottom: 0;
    margin-right: 0.8rem;
  }
  
  /* Edit button in navigation */
  .trade-nav-edit-button {
    width: auto;
    min-width: 36px;
    border-radius: 4px;
    border: 1px solid var(--interactive-accent);
    background-color: var(--interactive-accent);
    color: var(--text-on-accent, white);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: background-color 0.2s, transform 0.2s;
    padding: 6px 8px; /* Reduced vertical padding from 8px to 6px */
    margin: 0;
    box-sizing: border-box;
    font-size: 14px; /* Match the font size of navigation buttons */
    line-height: 1.15; /* Control the line height for better alignment */
  }
  
  .trade-nav-edit-button:hover {
    background-color: var(--interactive-accent-hover, var(--interactive-accent));
    opacity: 0.9;
    transform: translateY(-1px);
  }
  
  .trade-nav-edit-button svg {
    width: 14px;
    height: 14px;
  }
  
  .trade-review-navigation-links {
    display: flex;
    justify-content: space-between;
    gap: 0.5rem;
    flex-wrap: wrap;
  }
  
  .trade-review-navigation-button {
    flex: 1;
    min-width: 120px;
    text-align: center;
    padding: 0.5rem;
    font-size: 0.8rem;
  }
  
  /* Multiple view compatibility - these styles ensure proper display in various Obsidian layouts */
  .workspace-split.mod-vertical .journalit-trade-view {
    /* Adjust for vertical split layout */
    max-width: 100%;
    flex-shrink: 1;
  }
  
  /* Ensure the component doesn't get squished in narrow panes */
  .workspace-leaf-content .journalit-trade-view .trade-metrics-grid {
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  }
  
  /* Make sure tab/content navigation is still usable in narrow panes */
  .workspace-leaf-content .journalit-trade-view .trade-note-tabs {
    flex-wrap: wrap;
  }
  
  /* Prevent clipping of component in small panes */
  .workspace-leaf-content .journalit-trade-view .trade-note-container {
    min-width: 0;
  }
  
  /* Responsive styles for navigation */
  @media (max-width: 576px) {
    .trade-timeline {
      flex-direction: column;
      align-items: flex-start;
      margin-bottom: 0.6rem;
    }
    
    .timeline-label {
      margin-bottom: 0.4rem;
      margin-right: 0;
      font-weight: 600;
    }
    
    .trade-timeline-container {
      gap: 1rem;
    }
    
    /* Adjust navigation with edit button layout */
    .trade-navigation-with-edit {
      align-items: center;
    }
    
    .edit-button-container {
      padding-top: 0;
    }
    
    .trade-nav-edit-button {
      padding: 5px 6px; /* Further reduced vertical padding for mobile */
      min-width: 32px;
    }
    
    .trade-nav-edit-button svg {
      width: 16px;
      height: 16px;
    }
  }

  /* Loss Review Styles */
  
  /* Trade Review Container (also supports legacy loss-review classes) */
  .trade-review-container,
  .loss-review-container {
    margin-top: 2rem;
    border-top: 1px solid var(--background-modifier-border);
    padding-top: 1.5rem;
  }

  .trade-review-accordion,
  .loss-review-accordion {
    background: var(--background-secondary);
    border-radius: 8px;
    overflow: hidden;
  }

  /* Trade Review Sections */
  .trade-review-sections,
  .loss-review-sections {
    padding: 1.5rem;
  }

  .trade-review-section,
  .loss-review-section {
    margin-bottom: 1.5rem;
  }

  .trade-review-section:last-child,
  .loss-review-section:last-child {
    margin-bottom: 0;
  }

  /* Headers */
  .trade-review-header h3,
  .loss-review-header h3 {
    margin: 0 0 0.5rem 0;
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--text-normal);
  }

  .trade-review-content,
  .loss-review-content {
    color: var(--text-muted);
    line-height: 1.6;
    margin-bottom: 1rem;
  }

  .trade-review-content p,
  .loss-review-content p {
    margin: 0.5rem 0;
  }

  /* Checkboxes */
  .trade-review-checkbox,
  .trade-review-checkbox-list,
  .loss-review-checkbox,
  .loss-review-checkbox-list {
    margin: 0.5rem 0;
  }

  .trade-review-checkbox-list h3,
  .loss-review-checkbox-list h3 {
    margin: 0 0 0.75rem 0;
    font-size: 1rem;
    font-weight: 600;
  }

  .checkbox-items {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .checkbox-label {
    display: flex;
    align-items: flex-start;
    gap: 0.5rem;
    cursor: pointer;
    user-select: none;
  }

  .checkbox-label input[type="checkbox"] {
    margin-top: 0.25rem;
    cursor: pointer;
    flex-shrink: 0;
  }

  .checkbox-label span {
    flex: 1;
    line-height: 1.5;
  }

  .checkbox-label span strong {
    color: var(--text-normal);
  }

  /* Text Areas */
  .trade-review-textarea h3,
  .loss-review-textarea h3 {
    margin: 0 0 0.75rem 0;
    font-size: 1rem;
    font-weight: 600;
  }

  .trade-review-textarea-input,
  .loss-review-textarea-input {
    width: 100%;
    min-height: 100px;
    padding: 0.75rem;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background: var(--background-primary);
    color: var(--text-normal);
    font-family: inherit;
    font-size: 16px;
    line-height: 1.5;
    resize: vertical;
    transition: border-color 0.15s ease;
  }

  .trade-review-textarea-input:focus,
  .loss-review-textarea-input:focus {
    outline: none;
    border-color: var(--interactive-accent);
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2);
  }

  .trade-review-textarea-input::placeholder,
  .loss-review-textarea-input::placeholder {
    color: var(--text-muted);
    opacity: 0.7;
  }

  /* Footer */
  .trade-review-footer,
  .loss-review-footer {
    margin-top: 2rem;
    padding-top: 1.5rem;
    border-top: 1px solid var(--background-modifier-border);
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .reviewed-timestamp {
    font-size: 0.85rem;
    color: var(--text-muted);
  }

  /* Responsive */
  @media (max-width: 768px) {
    .trade-review-sections,
    .loss-review-sections {
      padding: 1rem;
    }

    .trade-review-footer,
    .loss-review-footer {
      flex-direction: column;
      gap: 1rem;
      align-items: flex-start;
    }
  }

  /* Dark theme adjustments */
  .theme-dark .trade-review-textarea-input,
  .theme-dark .loss-review-textarea-input {
    background: var(--background-secondary-alt);
  }

  .theme-dark .trade-review-accordion,
  .theme-dark .loss-review-accordion {
    background: var(--background-secondary-alt);
  }

  /* Accordion styles for Trade Review */
  .trade-review-container .cmdr-accordion,
  .loss-review-container .cmdr-accordion {
    margin-bottom: 16px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    overflow: hidden;
    transition: box-shadow 0.2s ease;
  }

  .trade-review-container .cmdr-accordion:hover,
  .loss-review-container .cmdr-accordion:hover {
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
  }

  .trade-review-container .cmdr-accordion .cmdr-accordion-header,
  .loss-review-container .cmdr-accordion .cmdr-accordion-header {
    display: flex;
    align-items: center;
    padding: 12px 16px;
    cursor: pointer;
    background-color: var(--background-secondary);
    transition: background-color 0.15s ease;
  }

  .trade-review-container .cmdr-accordion .cmdr-accordion-header:hover,
  .loss-review-container .cmdr-accordion .cmdr-accordion-header:hover {
    background-color: var(--background-modifier-hover);
  }

  .trade-review-container .cmdr-accordion .cmdr-accordion-chevron > svg,
  .loss-review-container .cmdr-accordion .cmdr-accordion-chevron > svg {
    transition: transform 0.3s ease-in-out;
  }

  .trade-review-container .cmdr-accordion .cmdr-accordion-content,
  .loss-review-container .cmdr-accordion .cmdr-accordion-content {
    max-height: 5000px;
    transition: max-height 0.3s ease-in-out, padding 0.3s ease-in-out, margin 0.3s ease-in-out;
    overflow: hidden;
    background-color: var(--background-primary);
    padding: 16px;
  }

  /* Collapsed state */
  .trade-review-container .cmdr-accordion[aria-expanded="false"] .cmdr-accordion-chevron > svg,
  .loss-review-container .cmdr-accordion[aria-expanded="false"] .cmdr-accordion-chevron > svg {
    transform: rotate(-90deg);
  }

  .trade-review-container .cmdr-accordion[aria-expanded="false"] .cmdr-accordion-content,
  .loss-review-container .cmdr-accordion[aria-expanded="false"] .cmdr-accordion-content {
    max-height: 0 !important;
    transition: max-height 0.2s ease-out;
    padding-top: 0;
    padding-bottom: 0;
    margin-top: 0;
    margin-bottom: 0;
    overflow: hidden;
  }

  /* Responsive styles for small screens */
  @media (max-width: 600px) {
    .trade-review-textarea-input,
    .loss-review-textarea-input {
      font-size: 18px !important;
    }
  }

  /* Light theme overrides for open trades */
  .theme-light .trade-note-header.open {
    background: linear-gradient(to right, rgba(33, 150, 243, 0.2), var(--background-primary));
  }

  .theme-light .trade-note-header.profit {
    background: linear-gradient(to right, rgba(var(--color-green-rgb), 0.2), var(--background-primary));
  }

  .theme-light .trade-note-header.loss {
    background: linear-gradient(to right, rgba(var(--color-red-rgb), 0.2), var(--background-primary));
  }

  .theme-light .trade-note-header.breakeven {
    background: linear-gradient(to right, rgba(128, 128, 128, 0.15), var(--background-primary));
  }

  .theme-light .open-trade-badge {
    background-color: rgba(33, 150, 243, 0.15);
    color: #1976d2;
    border: 1px solid rgba(33, 150, 243, 0.3);
  }
`});function QIe(){if(document.head.querySelector("#missed-trade-note-styles"))return;let e=document.createElement("style");e.id="missed-trade-note-styles",e.textContent=JIe,document.head.appendChild(e)}function t0(){QIe()}var JIe,YZ=F(()=>{JIe=`
  /**
   * Missed Trade Note Container styles
   */

  /* Main container for missed trade notes */
  .journalit-missed-trade-view,
  .missed-trade-form-view-container .journalit-missed-trade-view {
    margin: 0;
    border-bottom: none;
    padding: 0;
    display: block !important;
    width: 100% !important;
    z-index: 1;
    position: relative;
    box-sizing: border-box;
    contain: content;
    isolation: isolate;
  }
  
  /* Missed trade React root wrapper */
  .journalit-missed-trade-note-wrapper {
    width: 100%;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    contain: content;
    isolation: isolate;
    position: relative;
    box-sizing: border-box;
  }
  
  .missed-trade-note-container {
    background-color: var(--background-primary);
    border-radius: var(--border-radius-lg, 8px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    margin: 0;
    overflow: hidden;
    position: relative;
    font-family: var(--font-interface);
    isolation: isolate;
    contain: layout style paint;
    width: 100%;
    align-self: flex-start;
    transition: box-shadow 0.2s ease-in-out;
  }

  /**
   * MISSED Badge Styling for TradeHeader
   */
  
  /* Style the MISSED badge */
  .trade-header-actions .missed-trade-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    background-color: var(--color-orange, #ff9500);
    color: white;
    font-size: 0.75rem;
    font-weight: 600;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    box-shadow: 0 2px 4px rgba(255, 149, 0, 0.3);
    margin-right: 0.75rem;
  }

  /* Missed trade header styling - removed orange styling per user request */

  /**
   * Missed Trade Reason Section
   */
  
  .missed-trade-reason-section {
    margin-top: 1rem;
  }

  .missed-trade-reason-section .details-card {
    background-color: var(--background-secondary);
    border-left: 4px solid var(--color-orange, #ff9500);
  }

  .missed-trade-reason-section h4 {
    color: var(--color-orange, #ff9500);
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .missed-trade-reason-section h4::before {
    content: '\u274C';
    font-size: 1rem;
  }

  .missed-trade-reason-content {
    font-size: 0.95rem;
    line-height: 1.6;
    color: var(--text-normal);
    white-space: pre-wrap;
    padding: 0.5rem 0;
    background-color: var(--background-secondary-alt, var(--background-secondary));
    border-radius: 4px;
    padding: 0.75rem;
    margin-top: 0.5rem;
  }

  /**
   * Missed Trade Timeline Styling
   */

  /* Missed trades timeline section */
  .missed-trades-timeline-section {
    margin-top: 1rem;
    padding-top: 0.75rem;
    border-top: 1px solid var(--background-modifier-border);
  }

  .missed-trades-label {
    color: var(--color-orange, #ff9500);
    font-weight: 600;
    margin-bottom: 0.5rem;
  }

  /* Missed trade timeline items */
  .timeline-item.missed-trade {
    background-color: rgba(255, 149, 0, 0.15);
    color: var(--color-orange, #ff9500);
    border-color: rgba(255, 149, 0, 0.3);
    font-weight: 500;
  }

  .timeline-item.missed-trade:hover {
    background-color: rgba(255, 149, 0, 0.25);
    transform: translateY(-1px);
  }

  .timeline-item.missed-trade.active {
    border: 2px solid var(--color-orange, #ff9500);
    background-color: rgba(255, 149, 0, 0.2);
    font-weight: 600;
  }


  /**
   * Missed Trade Content Styling
   */
  
  .missed-trade-note-content {
    padding: 0;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  /**
   * Review Button for Missed Trades
   */
  
  .missed-trade-note-review-section {
    margin-top: 2rem;
    padding-top: 1.5rem;
    border-top: 1px solid var(--background-modifier-border);
    display: flex;
    justify-content: center;
    align-items: center;
  }

  /**
   * Form Styling for Missed Trade Toggle
   */
  
  /* Missed trade toggle styling in forms */
  .field .checkbox-label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    cursor: pointer;
    font-size: 0.9rem;
    color: var(--text-normal);
    transition: color 0.2s ease;
  }

  .field .checkbox-label:hover {
    color: var(--interactive-accent);
  }

  .field .checkbox-label input[type="checkbox"] {
    cursor: pointer;
    transform: scale(1.1);
  }

  .field .checkbox-label span {
    font-weight: 500;
  }

  /* Missed trade reason field styling */
  .field .textarea {
    width: 100%;
    min-height: 80px;
    padding: 0.75rem;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background: var(--background-primary);
    color: var(--text-normal);
    font-family: inherit;
    font-size: 0.9rem;
    line-height: 1.5;
    resize: vertical;
    transition: border-color 0.15s ease;
  }

  .field .textarea:focus {
    outline: none;
    border-color: var(--interactive-accent);
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2);
  }

  .field .textarea::placeholder {
    color: var(--text-muted);
    opacity: 0.7;
  }

  /**
   * Responsive Design
   */
  
  @media (max-width: 768px) {
    .missed-trade-badge {
      font-size: 0.7rem;
      padding: 0.2rem 0.4rem;
      margin-right: 0.5rem;
    }
    
    .missed-trade-reason-content {
      font-size: 0.85rem;
      padding: 0.5rem;
    }
  }

  @media (max-width: 480px) {
    .missed-trades-timeline-section {
      margin-top: 0.75rem;
      padding-top: 0.5rem;
    }
    
    .missed-trades-label {
      font-size: 0.85rem;
    }
  }

  /**
   * Dark theme adjustments
   */
  
  /* Removed orange theme styling per user request */
  
  .theme-dark .missed-trade-reason-content {
    background-color: var(--background-secondary-alt);
  }
  
  .theme-dark .timeline-item.missed-trade {
    background-color: rgba(255, 149, 0, 0.2);
  }
  
  .theme-dark .timeline-item.missed-trade:hover {
    background-color: rgba(255, 149, 0, 0.3);
  }

  /**
   * Multiple view compatibility
   */
  
  .workspace-split.mod-vertical .journalit-missed-trade-view {
    max-width: 100%;
    flex-shrink: 1;
  }
  
  .workspace-leaf-content .journalit-missed-trade-view .trade-metrics-grid {
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  }
  
  .workspace-leaf-content .journalit-missed-trade-view .missed-trade-note-container {
    min-width: 0;
  }
`});function SB(){if(document.head.querySelector("#drc-styles"))return;let e=document.createElement("style");e.id="drc-styles",e.textContent=XIe,document.head.appendChild(e)}function GT(){SB()}var XIe,TB=F(()=>{XIe=`
  /* Daily Report Card styles */
  .drc-container {
    background-color: transparent; /* Remove background to match Weekly Review */
    border-radius: 0; /* Remove border radius to match Weekly Review */
    box-shadow: none; /* Remove shadow to match Weekly Review */
    margin: 0; /* Remove margin to match Weekly Review */
    overflow: hidden;
    display: flex;
    flex-direction: column;
    font-family: var(--font-interface, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif);
    position: relative; /* Establish positioning context to prevent jumping */
    z-index: 1; /* Ensure proper stacking context */
    transform: translateZ(0); /* Force GPU acceleration for stability */
    will-change: auto !important; /* Prevent aggressive optimization */
    contain: layout style !important; /* CSS containment to prevent layout recalculation cascades */
  }

  /* DRC ComboBox styling - matched with TradeForm styling */
  .drc-container .combobox-container,
  .drc-container [data-combobox-type],
  .drc-missed-trade .combobox-container,
  .drc-missed-trade .drc-input-group.field .combobox-container {
    position: relative !important;
    width: 100% !important;
    margin-bottom: 8px !important;
    z-index: 10 !important;
  }

  /* Increased z-index when dropdown is open */
  .drc-container .combobox-container[data-is-open="true"],
  .drc-container [data-combobox-type][data-is-open="true"],
  .drc-missed-trade .combobox-container[data-is-open="true"],
  .drc-missed-trade .drc-input-group.field .combobox-container[data-is-open="true"] {
    z-index: 9999 !important;
  }

  /* Dropdown caret for DRC ComboBox */
  .drc-container [data-combobox-type] .input-container::after,
  .drc-missed-trade .combobox-container .input-container::after,
  .drc-missed-trade .drc-input-group.field .combobox-container .input-container::after {
    content: "" !important;
    position: absolute !important;
    right: 12px !important;
    top: 50% !important;
    transform: translateY(-50%) !important;
    width: 0 !important;
    height: 0 !important;
    border-left: 5px solid transparent !important;
    border-right: 5px solid transparent !important;
    border-top: 5px solid var(--text-normal) !important;
    pointer-events: none !important;
    z-index: 10 !important;
  }

  /* Input padding to make room for dropdown arrow */
  .drc-container [data-combobox-type] input[role="combobox"],
  .drc-missed-trade .combobox-container input[role="combobox"],
  .drc-missed-trade .drc-input-group.field .combobox-container input[role="combobox"] {
    padding-right: 30px !important;
    width: 100% !important;
    padding: 8px 12px !important;
    padding-right: 30px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    font-size: 16px !important;
    cursor: pointer !important;
  }

  /* DRC Multi-select styling - fixed for better visibility */
  .drc-missed-trade .selected-options,
  .drc-missed-trade .selected-item,
  .drc-missed-trade [data-combobox-type="multi"] > div:first-of-type {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 4px !important;
    max-width: 100% !important;
    padding: 2px 0 !important;
    z-index: 5 !important;
    position: relative !important;
  }

  /* Style selected tags to match the TradeForm */
  .drc-missed-trade .selected-option,
  .drc-missed-trade .selected-item,
  .selected-option,
  .selected-item {
    display: inline-flex !important;
    align-items: center !important;
    background-color: var(--interactive-accent, #7c3aed) !important; /* Use Obsidian var with purple fallback */
    color: var(--text-on-accent, white) !important;
    border-radius: 4px !important;
    padding: 4px 8px !important; /* Match TradeForm padding */
    font-size: 12px !important; /* Match TradeForm font size */
    margin: 0 4px 4px 0 !important; /* Match TradeForm margin */
    font-weight: 500 !important;
    z-index: 6 !important;
    position: relative !important;
    gap: 6px !important; /* Ensure proper spacing between text and remove button */
  }

  /* Style remove buttons ('\xD7') - matched with TradeForm */
  .drc-missed-trade .selected-option-remove,
  .drc-missed-trade .selected-item button,
  .selected-option-remove,
  .selected-item button {
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    width: 16px !important;
    height: 16px !important;
    min-width: 16px !important; /* Prevent shrinking */
    min-height: 16px !important; /* Prevent shrinking */
    padding: 0 !important;
    margin-left: 4px !important;
    cursor: pointer !important;
    background: rgba(255, 255, 255, 0.2) !important;
    border: none !important;
    border-radius: 50% !important;
    color: var(--text-on-accent, white) !important;
    font-size: 16px !important;
    line-height: 1 !important; /* Match TradeForm for consistent vertical centering */
    text-align: center !important;
    z-index: 7 !important;
    position: relative !important;
    transition: background-color 0.2s !important;
  }

  /* Header and Navigation */
  .drc-header {
    padding: 16px 20px 12px;
    background-color: var(--background-secondary);
    text-align: center;
    border-bottom: 1px solid var(--background-modifier-border);
  }

  .drc-date-display {
    font-size: 28px;
    font-weight: 600;
    color: var(--text-normal);
    margin-bottom: 20px;
  }

  /* DRC specific header classes */
  .drc-title {
    font-size: 28px;
    font-weight: 600;
    color: var(--text-normal);
    margin-bottom: 20px;
    text-align: center;
  }

  .drc-date-container {
    font-size: 28px;
    font-weight: 600;
    color: var(--text-normal);
    margin-bottom: 20px;
    text-align: center;
  }

  .drc-navigation {
    width: 100%;
    padding-top: 10px;
    border-top: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1));
  }

  .drc-navigation-links {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 8px;
    flex-wrap: wrap;
    width: 100% !important;
  }

  /* Tabs Container */
  .drc-tabs-container {
    background-color: var(--background-secondary-alt, #2a2a2a);
    border-bottom: 1px solid var(--background-modifier-border);
    display: flex;
    justify-content: center;
    padding: 0;
  }

  /* Tabs */
  .drc-tabs {
    display: flex;
    justify-content: center;
    background-color: transparent;
    max-width: 600px;
    margin: 0 auto;
  }

  .drc-tab {
    padding: 12px 24px;
    background: transparent;
    border: none;
    color: var(--text-muted);
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
    outline: none;
    border-bottom: 2px solid transparent;
  }

  .drc-tab:hover {
    color: var(--text-normal);
    background-color: rgba(127, 127, 127, 0.05);
  }

  .drc-tab.active {
    color: var(--text-accent);
    border-bottom: 2px solid var(--text-accent);
  }

  .drc-tab.active::after {
    content: none; /* Removing the additional indicator since we're using border-bottom */
  }

  /* Content area */
  .drc-content {
    padding: 20px 0 0; /* Removed bottom padding to prevent extra space */
  }

  /* Sections */
  .drc-section {
    margin: 0 0 24px 0; /* Explicit horizontal margin of 0 to match Weekly Review */
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    padding: 16px;
    background-color: var(--background-primary);
    width: 100%; /* Ensure full width */
    box-sizing: border-box; /* Include padding in width calculation */
  }

  /* Last section should not have a bottom margin to prevent extra space */
  .drc-section:last-child {
    margin-bottom: 0 !important;
  }

  /* First section should not have a top margin to prevent extra space */
  .drc-section:first-child {
    margin-top: 0 !important;
  }

  .drc-section h3 {
    margin-top: 0;
    margin-bottom: 16px;
    font-size: 16px;
    color: var(--text-normal);
    border-bottom: 1px solid var(--background-modifier-border);
    padding-bottom: 8px;
    text-align: center;
  }

  /* Checklist */
  .drc-checklist {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 8px;
  }

  .drc-checklist-item {
    display: flex;
    align-items: center;
    padding: 8px 12px;
    border-radius: 4px;
    background-color: var(--background-secondary);
    transition: background-color 0.2s ease;
    cursor: pointer !important; /* Make the entire area clickable */
  }

  /* Custom styling to center checkbox */
  .drc-checklist-item input[type="checkbox"] {
    margin-right: 10px;
    vertical-align: middle !important;
  }

  .drc-checklist-item:hover {
    background-color: var(--background-modifier-hover);
  }

  /* Input groups */
  .drc-input-group {
    margin-bottom: 16px;
  }

  .drc-input-group label {
    display: block;
    margin-bottom: 6px;
    font-size: 16px;
    font-weight: 500;
    color: var(--text-normal);
  }

  .drc-input-group input,
  .drc-input-group textarea,
  .drc-input-group select {
    width: 100%;
    padding: 8px 12px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    font-size: 16px;
  }

  .drc-input-group textarea,
  .drc-textarea {
    width: 100%;
    min-height: 80px;
    padding: 12px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    font-family: var(--font-text);
    font-size: 16px;
    resize: vertical;
  }

  /* Stats cards */
  .drc-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
    gap: 16px;
    margin-bottom: 24px;
  }

  .drc-stat-card {
    background-color: var(--background-secondary);
    border-radius: 6px;
    padding: 16px;
    text-align: center;
    transition: transform 0.2s;
    min-width: 0; /* Enable proper overflow handling */
  }

  .drc-stat-card:hover {
    transform: translateY(-2px);
  }

  .drc-stat-value {
    font-size: 24px;
    font-weight: 700;
    margin-bottom: 4px;
    color: var(--text-normal);
    white-space: nowrap; /* Keep values on one line */
    overflow: hidden; /* Hide overflow */
    text-overflow: ellipsis; /* Add ellipsis for overflow */
  }

  .drc-stat-value.positive {
    color: var(--color-success, #43a047);
  }

  .drc-stat-value.negative {
    color: var(--color-error, #e53935);
  }
  
  /* Special handling for P&L stat card which often has longer values */
  .drc-stats .drc-stat-card:nth-child(4) {
    min-width: 140px; /* Give P&L card extra space */
  }

  .drc-stat-label {
    font-size: 12px;
    color: var(--text-muted);
  }

  /* Grades */
  .drc-grades {
    display: grid;
    grid-template-columns: minmax(200px, 1fr) minmax(200px, 1fr) !important;
    gap: 16px !important;
    margin-bottom: 24px !important;
    align-items: end !important;
  }

  .drc-grade {
    display: flex !important;
    flex-direction: column !important;
    height: 100% !important;
    min-width: 200px !important;
    padding: 16px !important;
  }

  .drc-grade select {
    font-size: 16px;
    font-weight: 600;
    padding: 10px 16px;
    height: auto;
    line-height: 1.5;
    text-align-last: center;
    appearance: menulist-button;
    -webkit-appearance: menulist-button;
  }

  /* Trade table */
  .drc-trade-table {
    width: 100%;
    border-collapse: collapse;
  }

  .drc-trade-table th {
    text-align: left;
    padding: 10px;
    border-bottom: 2px solid var(--background-modifier-border);
    font-weight: 600;
    color: var(--text-normal);
  }

  .drc-trade-table td {
    padding: 10px;
    border-bottom: 1px solid var(--background-modifier-border);
    color: var(--text-normal);
  }

  .drc-trade-table td.positive {
    color: var(--color-success, #43a047);
  }

  .drc-trade-table td.negative {
    color: var(--color-error, #e53935);
  }

  .drc-trade-table select,
  .drc-trade-table input {
    width: 100%;
    padding: 6px 10px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background-color: var(--background-primary);
    color: var(--text-normal);
  }
  
  /* Weekly review trades table for DRC compatibility */
  .weekly-review-trades-table {
    /* Table header for preview column */
    th:first-child {
      width: 60px !important; /* Fixed width for preview column */
      text-align: center !important;
      padding: 8px 4px !important;
    }
    
    /* Trade preview cell */
    .trade-preview-cell {
      width: 60px !important;
      padding: 4px !important;
      text-align: center !important;
      vertical-align: middle !important;
    }
    
    /* Image wrapper container */
    .trade-image-wrapper {
      position: relative !important;
      width: 48px !important; 
      height: 48px !important;
      display: inline-block !important;
      cursor: pointer !important;
      overflow: hidden !important;
      border-radius: 4px !important;
      border: 1px solid var(--background-modifier-border) !important;
    }
    
    /* Lazy loaded image container */
    .trade-preview-thumbnail {
      width: 100% !important;
      height: 100% !important;
    }
    
    /* Placeholder shown before image loads */
    .trade-preview-placeholder {
      width: 100% !important;
      height: 100% !important;
      background-color: var(--background-modifier-hover) !important;
      border-radius: 4px !important;
    }
    
    /* Indicator badge for multiple images */
    .trade-image-count-indicator {
      position: absolute !important;
      bottom: 2px !important;
      right: 2px !important;
      background-color: rgba(0, 0, 0, 0.7) !important;
      color: var(--text-on-accent) !important;
      font-size: 10px !important;
      font-weight: bold !important;
      padding: 1px 4px !important;
      border-radius: 3px !important;
      line-height: 1 !important;
      pointer-events: none !important; /* Don't interfere with click handling */
      z-index: 2 !important;
    }
    
    /* Icon styling when no image exists */
    .trade-no-image-icon {
      color: var(--text-muted) !important;
      opacity: 0.5 !important;
    }
    
    /* Scale up image preview on hover */
    .trade-image-wrapper:hover {
      transform: scale(1.05) !important;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2) !important;
      transition: all 0.2s ease !important;
    }
  }
  
  .weekly-review-trades-table {
    width: 100% !important;
    overflow-x: auto !important;
    margin-bottom: 16px !important;
  }

  .weekly-review-trades-table table {
    width: 100% !important;
    border-collapse: collapse !important;
    font-size: 16px !important;
    text-align: center !important;
    margin: 0 !important;
    table-layout: auto !important;
  }

  .weekly-review-trades-table th {
    padding: 10px 12px !important;
    border-bottom: 2px solid var(--background-modifier-border) !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    background-color: var(--background-secondary) !important;
    text-align: center !important;
    white-space: nowrap !important;
  }

  .weekly-review-trades-table td {
    padding: 8px 12px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
    text-align: center !important;
    transition: background-color 0.2s ease !important;
  }

  .weekly-review-trades-table tr:hover td {
    background-color: var(--background-modifier-hover) !important;
  }

  .weekly-review-trade-row {
    cursor: pointer !important;
  }

  .weekly-review-trade-row:hover {
    background-color: var(--background-modifier-hover) !important;
  }

  /* DRC View Button - used in trade tables */
  .drc-nav-button {
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    padding: 8px 14px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    cursor: pointer !important;
    font-size: 16px !important;
    transition: all 0.2s !important;
    text-align: center !important;
    flex: 1 !important;
    min-width: 120px !important;
    box-sizing: border-box !important;
  }

  .drc-nav-button:hover {
    background-color: var(--background-modifier-hover) !important;
    transform: translateY(-1px) !important;
  }

  /* Review sections */
  .drc-reflection-item {
    margin-bottom: 16px;
  }

  .drc-reflection-item label {
    display: block;
    margin-bottom: 6px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .drc-reflection-item textarea {
    width: 100%;
    min-height: 100px;
    padding: 12px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    resize: vertical;
  }

  /* DRC dropdown options - remove bullets and match TradeForm */
  .drc-container [data-combobox-type] ul[role="listbox"],
  .drc-missed-trade [data-combobox-type] ul[role="listbox"] {
    position: absolute !important;
    top: 100% !important;
    left: 0 !important;
    right: 0 !important;
    max-height: 200px !important;
    overflow-y: auto !important;
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-top: none !important;
    border-radius: 0 0 4px 4px !important;
    margin-top: -1px !important;
    z-index: 9999 !important;
    list-style: none !important; /* Remove bullets */
    padding: 0 !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
    /* Fix for blurry text - add hardware acceleration properties */
    transform: translateZ(0) !important; /* Force GPU acceleration */
    backface-visibility: hidden !important;
    perspective: 1000px !important;
    -webkit-font-smoothing: antialiased !important;
    -moz-osx-font-smoothing: grayscale !important;
    /* Animation properties for smooth open effect */
    animation: drc-dropdown-open 0.15s ease forwards !important;
  }
  
  /* Animation for DRC dropdown appearance */
  @keyframes drc-dropdown-open {
    from {
      opacity: 0;
      transform: translateY(-5px) translateZ(0);
    }
    to {
      opacity: 1;
      transform: translateY(0) translateZ(0);
    }
  }

  /* DRC dropdown options styling */
  .drc-container [data-combobox-type] ul[role="listbox"] li,
  .drc-missed-trade [data-combobox-type] ul[role="listbox"] li {
    padding: 8px 12px !important;
    cursor: pointer !important;
    transition: background-color 150ms ease !important;
    margin: 0 !important;
    list-style: none !important; /* Ensure no bullets */
    border-bottom: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1)) !important;
    /* Fix for blurry text */
    transform: translateZ(0) !important; /* Force GPU acceleration */
    -webkit-font-smoothing: antialiased !important;
    -moz-osx-font-smoothing: grayscale !important;
    /* Ensure text is crisp */
    text-rendering: optimizeLegibility !important;
  }

  /* Hover and selected state for DRC dropdown options */
  .drc-container [data-combobox-type] ul[role="listbox"] li:hover,
  .drc-container [data-combobox-type] ul[role="listbox"] li[aria-selected="true"],
  .drc-missed-trade [data-combobox-type] ul[role="listbox"] li:hover,
  .drc-missed-trade [data-combobox-type] ul[role="listbox"] li[aria-selected="true"] {
    background-color: var(--background-secondary) !important;
  }

  /* Special styling for "Add new" option in DRC */
  .drc-container [data-combobox-type] ul[role="listbox"] li[data-add-option="true"],
  .drc-missed-trade [data-combobox-type] ul[role="listbox"] li[data-add-option="true"] {
    font-style: italic !important;
    border-top: 1px dashed var(--background-modifier-border) !important;
    /* Fix for blurry text */
    transform: translateZ(0) !important; /* Force GPU acceleration */
    -webkit-font-smoothing: antialiased !important;
    -moz-osx-font-smoothing: grayscale !important;
    /* Ensure text is crisp */
    text-rendering: optimizeLegibility !important;
  }

  /* When dropdown is open, change input border radius */
  .drc-container [data-combobox-type][data-is-open="true"] input[role="combobox"],
  .drc-missed-trade [data-combobox-type][data-is-open="true"] input[role="combobox"] {
    border-bottom-left-radius: 0 !important;
    border-bottom-right-radius: 0 !important;
  }
  
  /* Add hover effect for remove buttons */
  .drc-missed-trade .selected-option-remove:hover,
  .drc-missed-trade .selected-item button:hover,
  .selected-option-remove:hover,
  .selected-item button:hover {
    background: rgba(255, 255, 255, 0.4) !important; /* Brighter on hover */
  }

  /* Missed trades */
.drc-missed-trade {
  padding: 16px;
  padding-top: 42px; /* Extra padding at top to make space for the remove button */
  margin-bottom: 16px;
  background-color: var(--background-secondary);
  border-radius: 6px;
  position: relative;
}

/* Ensure the remove button is always clickable with a high z-index */
.drc-missed-trade-remove {
  position: absolute !important;
  top: 12px !important;
  right: 12px !important;
  z-index: 12000 !important; /* Ensure it's above any dropdowns */
  padding: 6px 12px !important;
  min-width: 80px !important;
  min-height: 32px !important;
  margin: 0 !important;
}

/* Missed trade images container */
.drc-missed-trade-images-container {
  margin-top: 16px;
}

/* Container for image carousel */
.drc-missed-trade-images {
  margin-bottom: 12px;
  background-color: var(--background-primary);
  border-radius: 6px;
  padding: 12px;
  border: 1px solid var(--background-modifier-border);
}

/* Image uploader for missed trades */
.drc-missed-trade-image-uploader {
  height: 60px !important; /* Smaller height for the uploader */
  margin-top: 8px;
}

  .drc-missed-trade .drc-remove-button {
    position: absolute;
    top: 12px;
    right: 12px;
  }

  /* Buttons */
  .drc-add-button,
  .drc-remove-button,
  .drc-nav-button {
    padding: 8px 14px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    cursor: pointer;
    font-size: 16px;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .drc-add-button {
    margin-bottom: 16px;
    background-color: var(--interactive-accent);
    color: var(--text-on-accent, white);
    border-color: var(--interactive-accent);
  }

  .drc-add-button:hover {
    background-color: var(--interactive-accent-hover);
  }

  .drc-remove-button {
    background-color: rgba(229, 57, 53, 0.1);
    color: var(--color-error, #e53935);
    border-color: var(--color-error, #e53935);
  }

  .drc-remove-button:hover {
    background-color: rgba(229, 57, 53, 0.2);
  }

  .drc-nav-button:hover {
    background-color: var(--background-modifier-hover);
    transform: translateY(-1px);
  }

  .drc-nav-button .nav-icon {
    font-size: 16px;
    line-height: 1;
  }

  /* Empty state */
  .drc-empty-state {
    padding: 20px;
    text-align: center;
    color: var(--text-muted);
    font-style: italic;
    background-color: var(--background-secondary);
    border-radius: 4px;
  }

  /* Goals section */
  .drc-goal-item {
    display: flex;
    align-items: center;
    margin-bottom: 8px;
    gap: 10px;
  }

  .drc-goal-item input {
    flex: 1;
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
    .drc-grades {
      grid-template-columns: 1fr;
    }

    .drc-stats {
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    }

    .drc-trade-table {
      display: block;
      overflow-x: auto;
    }

    .drc-navigation-links {
      justify-content: center !important;
      width: 100% !important;
    }

    .drc-nav-button {
      flex: 1 !important;
      justify-content: center !important;
      min-width: 120px !important;
    }

    /* Make tabs more compact on mobile */
    .drc-tab {
      padding: 10px 16px;
      font-size: 13px;
    }
  }

  /* Fix for grade value display and container sizing */
  .drc-note-grades {
    display: grid !important;
    grid-template-columns: minmax(200px, 1fr) minmax(200px, 1fr) !important;
    gap: 16px !important;
    margin-bottom: 24px !important;
    align-items: end !important;
  }

  .drc-note-grade {
    display: flex !important;
    flex-direction: column !important;
    height: 100% !important;
    min-width: 200px !important;
    padding: 16px !important;
  }

  .drc-note-grade-label {
    font-size: 16px !important;
    font-weight: 500 !important;
    color: var(--text-normal) !important;
    margin-bottom: 8px !important;
    display: block !important;
    text-align: center !important;
  }

  /* Critical fixes for grade display and containers */
  .drc-note-grades {
    display: grid !important;
    grid-template-columns: minmax(200px, 1fr) minmax(200px, 1fr) !important;
    gap: 16px !important;
    margin-bottom: 24px !important;
    align-items: center !important;
  }

  .drc-note-grade {
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    height: 100% !important;
    min-width: 200px !important;
    padding: 16px !important;
    background-color: var(--background-primary) !important;
    border-radius: var(--border-radius-md, 4px) !important;
    border: 1px solid var(--background-modifier-border) !important;
  }

  .drc-note-grade-label {
    font-size: 16px !important;
    font-weight: 500 !important;
    color: var(--text-normal) !important;
    margin-bottom: 12px !important;
    display: block !important;
    text-align: center !important;
    width: 100% !important;
  }

  .drc-note-grade-dropdown {
    width: 60px !important;
    height: 60px !important;
    position: relative !important;
  }

  /* Grade value styling with perfect centering */
  .drc-note-grade-value,
  select.drc-note-grade-value {
    width: 60px !important;
    height: 60px !important;
    min-width: 60px !important;
    min-height: 60px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    border-radius: 50% !important;
    font-size: 22px !important;
    font-weight: 600 !important;
    margin: 0 !important;
    padding: 0 !important;
    border: none !important;
    background-color: var(--background-secondary) !important;
    color: var(--text-normal) !important;
    cursor: pointer !important;
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    appearance: none !important;
    text-align: center !important;
    line-height: 1 !important;
    text-indent: 0 !important;
    box-sizing: border-box !important;
    overflow: visible !important;
    position: relative !important;
  }

  /* Grade colors - A is green, B is orange, C is red */
  .drc-note-grade-value.grade-a {
    background-color: rgba(102, 187, 106, 0.3) !important;
    color: var(--text-success) !important;
  }

  .drc-note-grade-value.grade-b {
    background-color: rgba(255, 152, 0, 0.3) !important;
    color: var(--text-warning) !important;
  }

  .drc-note-grade-value.grade-c {
    background-color: rgba(229, 57, 53, 0.3) !important;
    color: var(--text-error) !important;
  }

  /* Hide dropdown arrow */
  .drc-note-grade-dropdown::after,
  .drc-note-grade-dropdown::before,
  .drc-note-grade-dropdown select::after,
  .drc-note-grade-dropdown select::before {
    content: none !important;
    display: none !important;
  }

  /* Media query for responsive layout */
  @media (max-width: 768px) {
    .drc-note-grades {
      grid-template-columns: 1fr !important;
      gap: 12px !important;
    }

    /* Key Levels responsive adjustments */
    .drc-levels-container {
      flex-direction: column !important;
    }

    .drc-level-section {
      width: 100% !important;
    }
  }

  @media (min-width: 768px) {
    .drc-levels-container {
      flex-direction: row !important;
      gap: 16px !important;
    }

    .drc-level-section {
      width: calc(50% - 8px) !important;
    }
  }

  /* Key Levels Component Styles */
  .drc-key-levels {
    margin-top: 16px !important;
  }
  
  /* IconSelect Component Styles */
  .icon-select-container {
    position: relative !important;
    display: inline-block !important;
    width: 40px !important;
    height: 32px !important;
    vertical-align: middle !important;
  }

  .icon-select-trigger {
    width: 100% !important;
    height: 100% !important;
    padding: 0 !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    cursor: pointer !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
  }
  
  /* Center SVG icons inside the trigger button */
  .icon-select-trigger svg {
    display: block !important;
    margin: 0 auto !important;
  }

  .icon-select-trigger:hover {
    background-color: var(--background-modifier-hover) !important;
  }

  .icon-select-menu {
    position: absolute !important;
    top: calc(100% + 2px) !important;
    left: 0 !important;
    width: 40px !important;
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
    z-index: 1000 !important;
    list-style: none !important;
    padding: 4px 0 !important;
    margin: 0 !important;
  }

  .icon-select-option {
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    padding: 6px 0 !important;
    cursor: pointer !important;
    height: 28px !important;
  }
  
  /* Center SVG icons inside the dropdown options */
  .icon-select-option svg {
    display: block !important;
    margin: 0 auto !important;
  }

  .icon-select-option:hover {
    background-color: var(--background-modifier-hover) !important;
  }

  .icon-select-option.selected {
    background-color: var(--background-secondary) !important;
  }

  .drc-levels-container {
    display: flex !important;
    flex-direction: column !important;
    gap: 24px !important;
  }

  .drc-level-section {
    border-radius: 8px !important;
    padding: 16px !important;
    background-color: var(--background-secondary) !important;
  }

  .support-section {
    border-left: 3px solid rgba(102, 187, 106, 0.7) !important;
  }

  .resistance-section {
    border-left: 3px solid rgba(229, 57, 53, 0.7) !important;
  }

  .drc-level-header {
    margin: 0 0 12px 0 !important;
    padding-bottom: 8px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
    font-size: 16px !important;
    font-weight: 600 !important;
    text-align: center !important;
  }

  .support-header {
    color: var(--color-success, #43a047) !important;
  }

  .resistance-header {
    color: var(--color-error, #e53935) !important;
  }

  .drc-level-add-container {
    margin-bottom: 12px !important;
  }

  .drc-level-input-group {
    display: flex !important;
    gap: 8px !important;
    width: 100% !important;
    align-items: center !important;
  }

  .drc-level-input {
    flex: 2 !important;
    min-width: 0 !important;
    padding: 6px 12px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    font-size: 16px !important;
    height: 32px !important;
    min-height: 32px !important;
    max-height: 32px !important;
    line-height: 20px !important;
    box-sizing: border-box !important;
    margin: 0 !important;
    display: block !important;
  }

  .drc-level-importance-select {
    width: 40px !important;
    display: flex !important;
    align-items: center !important;
  }

  .drc-importance-select {
    width: 40px !important;
    padding: 6px 0 6px 24px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    font-size: 16px !important;
    height: 32px !important;
    min-height: 32px !important;
    max-height: 32px !important;
    line-height: 20px !important;
    box-sizing: border-box !important;
    margin: 0 !important;
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    appearance: none !important;
    vertical-align: middle !important;
    background-image: none !important;
    text-align: center !important;
  }

  /* Ensure select options have consistent height */
  .drc-importance-select option {
    padding: 4px 8px !important;
    height: auto !important;
    line-height: normal !important;
  }

  .drc-level-add-button {
    padding: 6px 12px !important;
    height: 32px !important;
    min-height: 32px !important;
    max-height: 32px !important;
    box-sizing: border-box !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    margin: 0 !important;
    line-height: 20px !important;
  }

  .drc-levels-list {
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important;
  }

  .drc-level-item {
    display: flex !important;
    align-items: center !important;
    padding: 8px 12px !important;
    background-color: var(--background-primary) !important;
    border-radius: 4px !important;
    position: relative !important;
    justify-content: flex-start !important;
  }

  .support-level {
    border-left: 3px solid rgba(102, 187, 106, 0.5) !important;
  }

  .resistance-level {
    border-left: 3px solid rgba(229, 57, 53, 0.5) !important;
  }

  .drc-level-price {
    font-weight: 500 !important;
    margin-right: 8px !important;
  }

  .drc-level-importance {
    font-size: 12px !important;
    padding: 2px 6px !important;
    border-radius: 3px !important;
  }

  .importance-high {
    background-color: rgba(229, 57, 53, 0.1) !important;
  }

  .importance-high .drc-level-importance {
    background-color: rgba(229, 57, 53, 0.2) !important;
    color: var(--color-error, #e53935) !important;
  }

  .importance-medium {
    background-color: rgba(255, 152, 0, 0.1) !important;
  }

  .importance-medium .drc-level-importance {
    background-color: rgba(255, 152, 0, 0.2) !important;
    color: var(--color-orange, #ef6c00) !important;
  }

  .importance-low {
    background-color: rgba(33, 150, 243, 0.1) !important;
  }

  .importance-low .drc-level-importance {
    background-color: rgba(33, 150, 243, 0.2) !important;
    color: var(--interactive-accent) !important;
  }

  .drc-level-remove-button {
    padding: 0 !important;
    width: 24px !important;
    height: 24px !important;
    background-color: rgba(229, 57, 53, 0.1) !important;
    color: var(--color-error, #e53935) !important;
    border: none !important;
    border-radius: 50% !important;
    cursor: pointer !important;
    font-size: 16px !important;
    line-height: 0 !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    margin-left: auto !important; /* Always push to the right */
    text-align: center !important;
    vertical-align: middle !important;
  }

  .drc-empty-levels {
    color: var(--text-muted) !important;
    font-style: italic !important;
    padding: 8px !important;
    text-align: center !important;
  }

  /* Ultra-high specificity rule for DRC navigation container */
  html body .drc-container .drc-header .drc-navigation,
  body .drc-container .drc-header .drc-navigation,
  .workspace-leaf .drc-container .drc-header .drc-navigation {
    width: 100% !important;
    padding-top: 10px !important;
    border-top: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1)) !important;
  }

  /* Ultra-high specificity rule for DRC navigation links container */
  html body .drc-container .drc-header .drc-navigation .drc-navigation-links,
  body .drc-container .drc-header .drc-navigation .drc-navigation-links,
  .workspace-leaf .drc-container .drc-header .drc-navigation .drc-navigation-links {
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    gap: 8px !important;
    flex-wrap: wrap !important;
    width: 100% !important;
  }

  /* Forecast section styling for DRC - matches Weekly Review */
  .drc-forecast-section {
    margin-bottom: 20px;
    padding: 16px;
    background-color: var(--background-secondary);
    border-radius: 8px;
  }

  /* Specific styling for forecast textareas - matching weekly review */
  .drc-forecast-section textarea,
  .drc-forecast-section .drc-textarea {
    width: 100%;
    min-height: 80px;
    padding: 12px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    font-family: var(--font-text);
    font-size: 16px;
    resize: vertical;
  }

  .drc-forecast-section h4 {
    margin-top: 0;
    margin-bottom: 15px;
    font-size: 1.05em;
  }

  .drc-image-container {
    margin-bottom: 12px;
  }

  .drc-image {
    position: relative;
    margin-bottom: 12px;
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    padding: 8px;
    background-color: var(--background-primary);
  }

  .drc-forecast-image {
    width: auto;
    max-width: 100%;
    max-height: 300px;
    object-fit: contain;
    border-radius: 6px;
    margin-bottom: 8px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    background-color: var(--background-primary);
  }

  .drc-image-upload {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 80px;
    border: 2px dashed var(--background-modifier-border);
    border-radius: 6px;
    margin-bottom: 12px;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
    overflow: hidden;
  }

  .drc-image-upload:hover {
    border-color: var(--interactive-accent);
    background-color: rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.05);
  }

  .drc-image-upload.dragging-over {
    border-color: var(--interactive-accent);
    background-color: rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.1);
    transform: scale(1.02);
    box-shadow: 0 0 12px rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.3);
  }

  .drc-image-upload::after {
    content: "Drag and drop here";
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 16px;
    font-weight: 600;
    color: var(--interactive-accent);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s ease;
  }

  .drc-image-upload.dragging-over::after {
    opacity: 1;
  }

  .drc-image-upload.dragging-over .drc-image-label {
    opacity: 0;
  }

  .drc-image-label {
    font-size: 16px;
    color: var(--text-muted);
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .drc-image-upload:hover .drc-image-label {
    color: var(--interactive-accent);
  }

  .drc-image-input {
    display: none;
  }

  .drc-image-delete {
    background-color: rgba(229, 57, 53, 0.1);
    color: var(--color-error, #e53935);
    border: none;
    border-radius: 4px;
    padding: 6px 12px;
    font-size: 12px;
    cursor: pointer;
  }

  .drc-image-error {
    color: var(--text-error, var(--color-red, #e53935));
    font-size: 12px;
    text-align: center;
    margin-top: 4px;
    margin-bottom: 8px;
    padding: 6px 10px;
    background-color: rgba(229, 57, 53, 0.1);
    border-radius: 4px;
    width: 100%;
  }

  /* Hint for click/hold to zoom */
  .drc-forecast-image {
    cursor: zoom-in !important;
    position: relative;
  }

  .drc-forecast-image::after {
    content: "Click or hold to enlarge";
    position: absolute;
    bottom: 8px;
    right: 8px;
    background-color: rgba(0, 0, 0, 0.6);
    color: var(--text-on-accent);
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 10px;
    opacity: 0;
    transition: opacity 0.2s ease;
  }

  .drc-forecast-image:hover::after {
    opacity: 1;
  }

  /* Fullscreen styles */
  .drc-fullscreen-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-color: rgba(0, 0, 0, 0.85);
    z-index: 4000; /* Reduced from 1000000 to prevent blocking interactions */
    display: flex;
    align-items: center;
    justify-content: center;
    animation: fadeIn 0.3s ease-in-out;
    backdrop-filter: blur(5px);
    -webkit-backdrop-filter: blur(5px);
    cursor: pointer;
  }

  .drc-fullscreen-content {
    max-width: 90vw;
    max-height: 90vh;
    display: flex;
    flex-direction: column;
    background-color: var(--background-primary);
    border-radius: 8px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
    animation: zoomIn 0.3s ease-in-out;
    overflow: hidden;
    cursor: default;
  }

  .drc-fullscreen-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 16px;
    background-color: var(--background-secondary);
    border-bottom: 1px solid var(--background-modifier-border);
  }

  .drc-fullscreen-header h3 {
    margin: 0;
    font-size: 18px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .drc-fullscreen-close {
    background-color: rgba(229, 57, 53, 0.1);
    color: var(--color-error, #e53935);
    border: none;
    border-radius: 4px;
    padding: 6px 12px;
    font-size: 16px;
    cursor: pointer;
  }

  .drc-fullscreen-close:hover {
    background-color: rgba(229, 57, 53, 0.2);
  }

  .drc-fullscreen-image-container {
    overflow: auto;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 16px;
    background-color: var(--background-primary);
    max-height: calc(90vh - 120px);
    /* Add subtle grid background for transparency */
    background-image: linear-gradient(45deg, var(--background-secondary) 25%, transparent 25%, transparent 75%, var(--background-secondary) 75%),
               linear-gradient(45deg, var(--background-secondary) 25%, transparent 25%, transparent 75%, var(--background-secondary) 75%);
    background-size: 20px 20px;
    background-position: 0 0, 10px 10px;
  }

  .drc-fullscreen-image {
    max-width: 100%;
    max-height: calc(90vh - 120px);
    object-fit: contain;
    border-radius: 4px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
  }

  .drc-fullscreen-footer {
    padding: 10px 16px;
    background-color: var(--background-secondary);
    border-top: 1px solid var(--background-modifier-border);
    text-align: center;
  }

  .drc-fullscreen-footer p {
    margin: 0;
    font-size: 12px;
    color: var(--text-muted);
  }

  /* Animations */
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  @keyframes zoomIn {
    from { transform: scale(0.9); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
  }

  /* Weekly Events Styling for DRC */
  .drc-weekly-events {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .drc-weekly-event-item {
    padding: 12px;
    background-color: var(--background-secondary);
    border-radius: 8px;
    border-left: 5px solid var(--event-color-gray, #888888);
    margin-bottom: 8px;
    transition: border-color 0.3s ease;
  }

  .drc-weekly-event-item.event-color-red {
    border-left-color: var(--event-color-red, #e53935);
  }

  .drc-weekly-event-item.event-color-orange {
    border-left-color: var(--event-color-orange, #fb8c00);
  }

  .drc-weekly-event-item.event-color-yellow {
    border-left-color: var(--event-color-yellow, #fdd835);
  }

  .drc-weekly-event-item.event-color-gray {
    border-left-color: var(--event-color-gray, #888888);
  }

  .drc-weekly-event-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
  }

  .drc-weekly-event-header h4 {
    margin: 0;
    font-size: 16px;
    font-weight: 600;
  }

  .drc-weekly-event-item p {
    margin: 0;
    font-size: 16px;
    color: var(--text-normal);
    white-space: pre-line;
  }

  .drc-weekly-event-badge {
    font-size: 12px;
    padding: 2px 8px;
    background-color: var(--background-modifier-border);
    border-radius: 4px;
    color: var(--text-normal);
    font-weight: 500;
    white-space: nowrap;
  }

  /* Ultra-high specificity rule for DRC navigation buttons */
  html body .drc-container .drc-header .drc-navigation .drc-navigation-links .drc-nav-button,
  body .drc-container .drc-header .drc-navigation .drc-navigation-links .drc-nav-button,
  .workspace-leaf .drc-container .drc-header .drc-navigation .drc-navigation-links .drc-nav-button {
    padding: 8px 14px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    cursor: pointer !important;
    font-size: 16px !important;
    transition: all 0.2s !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    gap: 6px !important;
    flex: 1 !important;
    text-align: center !important;
    min-width: 120px !important;
    box-sizing: border-box !important;
    max-width: none !important;
    margin: 0 !important;
  }

  /* Ensure proper icon spacing for DRC navigation buttons */
  html body .drc-container .drc-header .drc-navigation .drc-nav-button .nav-icon,
  body .drc-container .drc-header .drc-navigation .drc-nav-button .nav-icon {
    font-size: 16px !important;
    line-height: 1 !important;
  }

  /* End of Day Review Styles */
  .drc-eod-images {
    padding: 16px;
    background-color: var(--background-secondary);
    border-radius: 6px;
  }

  .drc-eod-image-uploader {
    margin-top: 8px;
  }

  .drc-eod-review-button-section {
    text-align: center;
  }

  .drc-eod-review-button-section .review-button-container {
    justify-content: center;
  }

  /* No questions message */
  .drc-no-questions {
    padding: 16px;
    text-align: center;
    color: var(--text-muted);
    font-style: italic;
  }

  /* Metadata container positioning fix to prevent jumping */
  .metadata-container {
    position: relative !important;
    z-index: 1 !important;
    transform: translateZ(0) !important;
    will-change: auto !important;
  }

  /* Prevent parent containers from affecting child positioning during re-renders */
  .workspace-leaf-content[data-type="journalit-drc"],
  .view-content,
  .markdown-source-view,
  .markdown-preview-view {
    position: relative !important;
    overflow: auto !important;
  }

  /* Ensure proper stacking context for nested scrollable elements */
  .drc-tabs-content,
  .tab-content {
    position: relative !important;
    z-index: 1 !important;
  }

  /* Prevent layout shift from margin collapsing */
  .drc-container::before {
    content: '';
    display: table;
  }

  /* Fix for when Obsidian adds inline styles during re-render */
  .metadata-container[style*="position"] {
    position: relative !important;
  }

  /* Ensure dropdowns and inputs don't cause layout shifts */
  .drc-container select,
  .drc-container input,
  .drc-container textarea {
    box-sizing: border-box !important;
    max-width: 100% !important;
  }

  /* Responsive font sizing for small screens */
  @media (max-width: 600px) {
    .drc-container input[role="combobox"],
    .drc-input-group input,
    .drc-input-group textarea,
    .drc-input-group select,
    .drc-textarea,
    .drc-forecast-section textarea,
    .drc-forecast-section .drc-textarea,
    .drc-level-input,
    .drc-trade-table input,
    .drc-reflection-item textarea,
    .drc-goal-item input {
      font-size: 18px !important;
    }
  }

  /* Count Badges for Setups & Mistakes */
  .count-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    font-size: 12px;
    font-weight: 600;
    cursor: help;
  }

  .count-badge--mistakes {
    background: rgba(244, 67, 54, 0.15);
    color: var(--color-red);
    border: 1px solid rgba(244, 67, 54, 0.3);
  }

  .count-badge--mistakes:hover {
    background: rgba(244, 67, 54, 0.25);
  }

  .count-badge--setups {
    background: rgba(33, 150, 243, 0.15);
    color: var(--color-info);
    border: 1px solid rgba(33, 150, 243, 0.3);
  }

  .count-badge--setups:hover {
    background: rgba(33, 150, 243, 0.25);
  }

  /* Cell containers */
  .trade-mistakes-cell,
  .trade-setups-cell {
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .trade-no-data {
    color: var(--text-faint);
    font-size: 13px;
  }

  /* Tooltip Styles */
  .tooltip-title {
    font-weight: 600;
    margin-bottom: 4px;
    color: var(--text-normal);
  }

  .tooltip-item {
    color: var(--text-muted);
    margin: 2px 0;
    line-height: 1.4;
  }

  .mistakes-tooltip .tooltip-title {
    color: var(--color-red);
  }

  .setups-tooltip .tooltip-title {
    color: var(--interactive-accent);
  }
`});function ZIe(){if(document.getElementById("journalit-calendar-dynamic-styles"))return;let e=document.createElement("style");e.id="journalit-calendar-dynamic-styles",e.textContent=`
    .${Ct.calendarGrid} {
      display: flex;
      flex-direction: column;
      gap: 4px;
      width: 100%;
    }

    .${Ct.calendarWeekRow} {
      display: grid;
      grid-template-columns: repeat(7, 1fr) 1fr;
      gap: 4px;
      margin-bottom: 4px;
      width: 100%;
      justify-content: stretch;
    }

    .${Ct.calendarWeekRowWeekdays} {
      grid-template-columns: repeat(5, 1fr) 1fr;
    }

    .${Ct.calendarDayCell} {
      aspect-ratio: 1;
      display: flex;
      flex-direction: column;
      position: relative;
      padding: 4px;
      border-radius: 4px;
      width: 100%;
    }

    .${Ct.todayDayCell} {
      position: relative;
      z-index: 2;
    }

    .${Ct.dayNumber} {
      position: absolute;
      top: 4px;
      left: 4px;
      text-align: left;
    }

    .${Ct.pnlValue} {
      font-size: 14px;
      margin-top: 0px;
      width: 100%;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }

    .${Ct.calendarHeader} {
      display: grid;
      grid-template-columns: repeat(7, 1fr) 1fr;
      gap: 4px;
      margin-bottom: 8px;
      position: sticky;
      top: 0;
      background-color: var(--background-primary);
      z-index: 5;
      padding: 4px 0;
      width: 100%;
      justify-content: stretch;
    }

    .${Ct.calendarHeaderWeekdays} {
      grid-template-columns: repeat(5, 1fr) 1fr;
    }

    .${Ct.weekdayLabel} {
      width: 100%;
      text-align: center;
    }

    .${Ct.hiddenWeekend} {
      display: none;
    }

    .${Ct.calendarContainer} {
      width: 100%;
      display: flex;
      flex-direction: column;
    }

    .${Ct.calendarHeaderGrid} {
      grid-template-columns: repeat(7, 1fr) 1fr;
      width: 100%;
    }

    .${Ct.calendarHeaderGridWeekdays} {
      grid-template-columns: repeat(5, 1fr) 1fr;
    }

    .${Ct.calendarWeekRowGrid} {
      grid-template-columns: repeat(7, 1fr) 1fr;
      width: 100%;
    }

    .${Ct.calendarWeekRowGridWeekdays} {
      grid-template-columns: repeat(5, 1fr) 1fr;
    }

    .${Ct.weeklyPnlCell} {
      position: relative;
      display: flex;
      flex-direction: column;
    }

    .${Ct.weekNumberPosition} {
      position: absolute;
      top: 4px;
      left: 4px;
      text-align: left;
      margin-bottom: 0px;
    }

    .${Ct.weeklyPnlValue} {
      font-size: 12px;
      width: 100%;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }

    .${Ct.responsiveCell} {
      position: relative;
      display: flex;
    }

    .${Ct.weeklyPnlRelative} {
      position: relative;
    }

    .${Ct.monthLabel} {
      font-size: 16px;
      font-weight: 600;
      color: var(--text-normal);
      padding: 12px 0 8px 0;
      border-bottom: 2px solid var(--background-modifier-border);
      margin-bottom: 8px;
      margin-top: 0;
      z-index: 1;
    }

    .${Ct.monthLabel}:not(:first-child) {
      margin-top: 8px;
    }
  `,document.head.appendChild(e)}function eMe(e){let t=document.getElementById("journalit-calendar-responsive-styles");t&&t.remove();let r=document.createElement("style");r.id="journalit-calendar-responsive-styles",r.textContent=`
    .${Ct.responsiveDayNumber} {
      position: absolute;
      top: 4px;
      left: 4px;
      text-align: left;
      font-size: ${e.dayNumber};
      font-weight: 500;
    }

    .${Ct.responsivePnlValue} {
      position: absolute;
      top: ${e.pnlPosition};
      left: 50%;
      transform: translate(-50%, -50%);
      width: 100%;
      margin-top: 0px;
      font-size: ${e.pnlValue};
      font-weight: 600;
      text-align: center;
    }

    .${Ct.responsiveTradeCount} {
      position: absolute;
      top: ${e.tradePosition};
      left: 50%;
      transform: translate(-50%, -50%);
      width: 100%;
      font-size: ${e.tradeCount};
      font-weight: 400;
      text-align: center;
      color: var(--text-muted);
      background-color: transparent;
      border-radius: 0;
      padding: 0;
    }

    .${Ct.responsiveWeekNumber} {
      position: absolute;
      top: 4px;
      left: 4px;
      text-align: left;
      font-size: ${e.dayNumber};
      font-weight: 500;
      margin-bottom: 0px;
    }

    .${Ct.responsiveWeekLabel} {
      position: absolute;
      top: 25%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 100%;
      font-size: ${e.tradeCount};
      font-weight: 600;
      text-align: center;
    }

    .${Ct.responsiveWeekPnl} {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 100%;
      font-size: ${e.pnlValue};
      font-weight: 700;
      text-align: center;
    }

    .${Ct.responsiveWeekTrades} {
      position: absolute;
      bottom: 20%;
      left: 50%;
      transform: translate(-50%, 50%);
      width: 85%;
      font-size: ${e.tradeCount};
      font-weight: 500;
      text-align: center;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      color: var(--text-muted);
      background-color: transparent;
      border-radius: 0;
      padding: 0;
    }
  `,document.head.appendChild(r)}function JZ(){var n,i,a;let e=window.journalitPlugin,t=(a=(i=(n=e==null?void 0:e.settings)==null?void 0:n.trade)==null?void 0:i.skipWeekends)!=null?a:!0;document.querySelectorAll(".journalit-dashboard-calendar-grid").forEach(o=>{o instanceof HTMLElement&&(o.classList.add(Ct.calendarGrid),o.querySelectorAll(".journalit-dashboard-calendar-week").forEach(c=>{c instanceof HTMLElement&&(c.classList.add(Ct.calendarWeekRow),t?(c.classList.add(Ct.calendarWeekRowWeekdays),c.classList.add("hide-weekends")):(c.classList.remove(Ct.calendarWeekRowWeekdays),c.classList.remove("hide-weekends")))}),o.querySelectorAll(".journalit-dashboard-calendar-day").forEach((c,d)=>{if(c instanceof HTMLElement){c.classList.add(Ct.calendarDayCell),c.classList.contains("today")&&c.classList.add(Ct.todayDayCell);let u=c.querySelector(".journalit-dashboard-calendar-day-number");u instanceof HTMLElement&&u.classList.add(Ct.dayNumber);let p=c.querySelector(".journalit-dashboard-calendar-day-pnl");p instanceof HTMLElement&&p.classList.add(Ct.pnlValue)}}))})}function QZ(){var n,i,a;let e=window.journalitPlugin,t=(a=(i=(n=e==null?void 0:e.settings)==null?void 0:n.trade)==null?void 0:i.skipWeekends)!=null?a:!0;document.querySelectorAll(".journalit-dashboard-calendar-header").forEach(o=>{o instanceof HTMLElement&&(o.classList.add(Ct.calendarHeader),t?(o.classList.add(Ct.calendarHeaderWeekdays),o.classList.add("hide-weekends")):(o.classList.remove(Ct.calendarHeaderWeekdays),o.classList.remove("hide-weekends")),o.querySelectorAll(".journalit-dashboard-calendar-weekday").forEach(l=>{l instanceof HTMLElement&&l.classList.add(Ct.weekdayLabel)}),t&&o.querySelectorAll(".journalit-dashboard-calendar-weekday").forEach(c=>{if(c instanceof HTMLElement){let d=c.getAttribute("data-day");d==="Sun"||d==="Sat"?c.classList.add(Ct.hiddenWeekend):c.classList.remove(Ct.hiddenWeekend)}}))})}function CB(){var e,t,r;try{let n=window.journalitPlugin,i=(r=(t=(e=n==null?void 0:n.settings)==null?void 0:e.trade)==null?void 0:t.skipWeekends)!=null?r:!0;document.querySelectorAll(".journalit-dashboard-calendar").forEach(o=>{if(o instanceof HTMLElement){i?(o.classList.add("hide-weekends"),o.classList.add("weekends-hidden"),o.querySelectorAll(".journalit-dashboard-calendar-weekday").forEach(d=>{if(d instanceof HTMLElement){let u=d.getAttribute("data-day");u==="Sun"||u==="Sat"?d.classList.add(Ct.hiddenWeekend):d.classList.remove(Ct.hiddenWeekend)}})):(o.classList.remove("hide-weekends"),o.classList.remove("weekends-hidden"),o.querySelectorAll(".journalit-dashboard-calendar-weekday").forEach(d=>{d instanceof HTMLElement&&d.classList.remove(Ct.hiddenWeekend)})),o.classList.add(Ct.calendarContainer);let s=o.querySelector(".journalit-dashboard-calendar-header");s instanceof HTMLElement&&(s.classList.add(Ct.calendarHeaderGrid),i?s.classList.add(Ct.calendarHeaderGridWeekdays):s.classList.remove(Ct.calendarHeaderGridWeekdays)),o.querySelectorAll(".journalit-dashboard-calendar-week").forEach(c=>{c instanceof HTMLElement&&(c.classList.add(Ct.calendarWeekRowGrid),i?c.classList.add(Ct.calendarWeekRowGridWeekdays):c.classList.remove(Ct.calendarWeekRowGridWeekdays),c.querySelectorAll(".journalit-dashboard-calendar-weekly-pnl").forEach(u=>{if(u instanceof HTMLElement){u.classList.add(Ct.weeklyPnlCell);let p=u.querySelector(".journalit-dashboard-calendar-week-number");p instanceof HTMLElement&&p.classList.add(Ct.weekNumberPosition);let m=u.querySelector(".journalit-dashboard-calendar-weekly-pnl-value");m instanceof HTMLElement&&m.classList.add(Ct.weeklyPnlValue)}}))})}})}catch(n){console.error("Error applying consistent grid structure:",n)}}function tMe(e){try{let t=e.clientWidth,r=14,n=14,i=12,a=1;t<25?a=.55:t<30?a=.65:t<40?a=.75:t<50?a=.85:t>90?a=1.15:t>80&&(a=1.05);let o="50%",s="65%";return t<30?(o="40%",s="78%"):t<40?(o="42%",s="75%"):t<50?(o="44%",s="73%"):t<60?(o="46%",s="70%"):(o="48%",s="68%"),{dayNumber:`${Math.max(7,Math.round(r*a))}px`,pnlValue:`${Math.max(7,Math.round(n*(a*.95)))}px`,tradeCount:`${Math.max(6,Math.round(i*(a*.9)))}px`,pnlPosition:o,tradePosition:s}}catch(t){return console.error("Error calculating responsive sizes:",t),{dayNumber:"12px",pnlValue:"12px",tradeCount:"10px",pnlPosition:"50%",tradePosition:"65%"}}}function Ld(){try{if(document.querySelectorAll(".journalit-dashboard-calendar").length===0)return;let t=document.querySelector(".journalit-dashboard-calendar-day");if(!t)return;let r=tMe(t);eMe(r),document.querySelectorAll(".journalit-dashboard-calendar-day").forEach(a=>{if(a instanceof HTMLElement){a.classList.add(Ct.responsiveCell);let o=a.querySelector(".journalit-dashboard-calendar-day-number");o instanceof HTMLElement&&o.classList.add(Ct.responsiveDayNumber);let s=a.querySelector(".journalit-dashboard-calendar-day-pnl");s instanceof HTMLElement&&s.classList.add(Ct.responsivePnlValue);let l=a.querySelector(".journalit-dashboard-calendar-day-trades");l instanceof HTMLElement&&l.classList.add(Ct.responsiveTradeCount)}}),document.querySelectorAll(".journalit-dashboard-calendar-weekly-pnl").forEach(a=>{if(a instanceof HTMLElement){a.classList.add(Ct.weeklyPnlRelative);let o=a.querySelector(".journalit-dashboard-calendar-week-number");o instanceof HTMLElement&&o.classList.add(Ct.responsiveWeekNumber);let s=a.querySelector(".journalit-dashboard-calendar-week-total-label");s instanceof HTMLElement&&s.classList.add(Ct.responsiveWeekLabel);let l=a.querySelector(".journalit-dashboard-calendar-week-total-value");l instanceof HTMLElement&&l.classList.add(Ct.responsiveWeekPnl);let c=a.querySelector(".journalit-dashboard-calendar-week-trade-count");c instanceof HTMLElement&&c.classList.add(Ct.responsiveWeekTrades)}})}catch(e){console.error("Error applying calendar cell styling:",e)}}function YT(){try{if(typeof ResizeObserver=="undefined"){console.warn("ResizeObserver not supported in this browser. Calendar responsive text might not work.");return}window.__journalitCalendarResizeObserver&&window.__journalitCalendarResizeObserver.disconnect();let e=null,t=new ResizeObserver(a=>{e&&clearTimeout(e),e=setTimeout(()=>{a.forEach(o=>{if(o.target instanceof HTMLElement){let s=o.contentRect,l=o.target.__lastCalendarSize;if(l&&Math.abs(s.width-l.width)<5&&Math.abs(s.height-l.height)<5)return;o.target.__lastCalendarSize={width:s.width,height:s.height}}}),Ld()},150)});window.__journalitCalendarResizeObserver=t,document.querySelectorAll(".journalit-dashboard-calendar").forEach(a=>{t.observe(a)}),document.querySelectorAll(".journalit-dashboard-widget").forEach(a=>{a.querySelector(".journalit-dashboard-calendar")&&t.observe(a)}),document.querySelectorAll(".react-grid-item").forEach(a=>{a.querySelector(".journalit-dashboard-calendar")&&t.observe(a)}),Ld(),setTimeout(Ld,50),setTimeout(Ld,200)}catch(e){console.error("Error setting up calendar resize observer:",e)}}function KT(){try{ZIe(),CB(),JZ(),QZ(),Ld(),requestAnimationFrame(()=>{Ld(),window.__journalitCalendarResizeObserver||YT()}),document.removeEventListener("dashboard-styles-updated",KZ),document.addEventListener("dashboard-styles-updated",KZ)}catch(e){console.error("Error applying calendar style fixes:",e)}}var Ct,KZ,JT=F(()=>{Ct={calendarGrid:"journalit-calendar-grid-fix",calendarWeekRow:"journalit-calendar-week-row",calendarWeekRowWeekdays:"journalit-calendar-week-row-weekdays",calendarDayCell:"journalit-calendar-day-cell",todayDayCell:"journalit-calendar-today-cell",dayNumber:"journalit-calendar-day-num",pnlValue:"journalit-calendar-pnl-val",calendarHeader:"journalit-calendar-header-grid",calendarHeaderWeekdays:"journalit-calendar-header-weekdays",weekdayLabel:"journalit-calendar-weekday-label",hiddenWeekend:"journalit-calendar-hidden-weekend",calendarContainer:"journalit-calendar-container-flex",calendarHeaderGrid:"journalit-calendar-header-columns",calendarHeaderGridWeekdays:"journalit-calendar-header-columns-weekdays",calendarWeekRowGrid:"journalit-calendar-week-columns",calendarWeekRowGridWeekdays:"journalit-calendar-week-columns-weekdays",weeklyPnlCell:"journalit-calendar-weekly-pnl-cell",weekNumberPosition:"journalit-calendar-week-num-pos",weeklyPnlValue:"journalit-calendar-weekly-pnl-val",responsiveCell:"journalit-calendar-responsive-cell",responsiveDayNumber:"journalit-calendar-responsive-day-num",responsivePnlValue:"journalit-calendar-responsive-pnl",responsiveTradeCount:"journalit-calendar-responsive-trades",responsiveWeekNumber:"journalit-calendar-responsive-week-num",responsiveWeekLabel:"journalit-calendar-responsive-week-label",responsiveWeekPnl:"journalit-calendar-responsive-week-pnl",responsiveWeekTrades:"journalit-calendar-responsive-week-trades",weeklyPnlRelative:"journalit-calendar-weekly-relative",monthLabel:"journalit-dashboard-calendar-month-label"};KZ=()=>{JZ(),QZ(),Ld()}});function r0(){let e=document.head.querySelector("#dashboard-styles"),t=document.createElement("style");t.id="dashboard-styles",t.textContent=rMe,e?(document.head.insertBefore(t,e),setTimeout(()=>e.remove(),0)):document.head.appendChild(t),nMe()}function XZ(){let e=document.head.querySelector("#dashboard-styles");if(e){let r=document.createElement("style");r.id="dashboard-styles-backup",r.textContent=e.textContent,document.head.appendChild(r),e.remove(),setTimeout(()=>{let n=document.head.querySelector("#dashboard-styles-backup");n&&n.remove()},50)}let t=document.head.querySelector("#dashboard-transparency-styles");t&&t.remove()}function LI(){r0(),setTimeout(()=>r0(),50)}function cy(){try{if(r0(),!document.head.querySelector("#filter-layout-fix-styles")){let r=document.createElement("style");r.id="filter-layout-fix-styles",r.textContent=`
        /* Force filters section to stay compact and left-aligned */
        .journalit-dashboard-filters-section {
          display: flex !important;
          flex-direction: row !important;
          gap: 20px !important; /* Increased from 10px to 20px for more spacing */
          justify-content: flex-start !important;
          max-width: fit-content !important;
          flex-wrap: nowrap !important;
          margin-right: 0 !important; /* Changed from auto to prevent pushing buttons off alignment */
          align-items: center !important;
        }
        
        /* Ensure account filter has proper spacing from ticker filter */
        .journalit-dashboard-accounts-section {
          padding-left: 0 !important;
          flex: 0 0 auto !important;
          order: 2 !important;
        }
        
        /* Keep ticker filter on the left */
        .journalit-dashboard-tickers-section {
          flex: 0 0 auto !important;
          order: 1 !important;
        }
        
        /* Add spacing div to take remaining space */
        .journalit-dashboard-filters-spacer {
          flex: 1 1 auto !important;
          order: 3 !important;
        }
        
        /* Reset any existing flexbox layout for the filter row */
        .journalit-dashboard-filter-row {
          display: grid !important;
          grid-template-columns: auto 1fr auto !important;
          gap: 20px !important;
        }
        
        /* Force the action buttons to the right */
        .journalit-dashboard-filter-actions {
          justify-self: end !important;
          margin-left: auto !important;
        }
        
        /* Handle compact view filter styling */
        .journalit-dashboard-compact-filters {
          display: flex !important;
          flex-direction: row !important;
          gap: 10px !important;
          justify-content: flex-start !important;
          flex-wrap: nowrap !important;
          align-items: center !important;
        }
        
        /* Make sure compact view also has correct section styling with proper spacing */
        .journalit-dashboard-compact-filters .journalit-dashboard-tickers-section {
          margin: 0 !important;
          padding: 0 !important;
        }
        .journalit-dashboard-compact-filters .journalit-dashboard-accounts-section {
          margin: 0 0 0 20px !important;
          padding: 0 !important;
        }
        
        /* Force very high specificity for filter layout fixes */
        body .journalit-dashboard-view .journalit-dashboard-filter-controls .journalit-dashboard-filter-row .journalit-dashboard-filters-section {
        display: flex !important;
        flex-direction: row !important;
        gap: 20px !important;
        justify-content: flex-start !important;
        max-width: fit-content !important;
        flex-wrap: nowrap !important;
        margin-right: auto !important;
        }

          /* Ultra-high specificity rule to ensure buttons are properly aligned to the right */
          body .journalit-dashboard-view .journalit-dashboard-filter-controls .journalit-dashboard-filter-row .journalit-dashboard-filter-actions,
          html body .journalit-dashboard-view .journalit-dashboard-filter-controls .journalit-dashboard-filter-row.standard-responsive .journalit-dashboard-filter-actions,
          html body .journalit-dashboard-view .journalit-dashboard-filter-controls .journalit-dashboard-filter-row.compact .journalit-dashboard-filter-actions.button-container {
            justify-self: end !important;
            margin-left: auto !important;
          }
      `,document.head.appendChild(r)}[0,100,300,600,1200].forEach(r=>{setTimeout(()=>{let n=new CustomEvent("dashboard-styles-updated");if(document.dispatchEvent(n),!document.head.querySelector("#unified-component-selector-styles")){let a=document.createElement("style");a.id="unified-component-selector-styles",a.textContent=`
            .unified-selector-overlay {
              backdrop-filter: blur(3px) !important;
              z-index: 100000 !important;
              align-items: flex-start !important;
            }
            .journalit-dashboard-component-selector {
              animation: fadeInScale 0.25s cubic-bezier(0.19, 1, 0.22, 1) !important;
              box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2), 0 16px 64px rgba(0, 0, 0, 0.1) !important;
              border-radius: 12px !important;
              overflow: hidden !important;
              z-index: 100001 !important;
              margin-top: 100px !important;
            }
            /* Force specific spacing values */
            .journalit-dashboard-filter-controls {
              margin-bottom: 2px !important; /* Reduced from 10px */
            }
            .journalit-dashboard-unified-selector-button-container {
              margin-bottom: 4px !important;
              padding: 4px !important;
            }
            /* Set unified container gap to match screenshot */
            .journalit-dashboard-unified-container {
              background-color: transparent !important;
              box-shadow: none !important;
              gap: 2px !important; /* Reduced from 10px */
            }
            /* Make sure top and bottom sections have no visual separation and equal padding */
            .journalit-dashboard-top-section, 
            .journalit-dashboard-bottom-section {
              background-color: transparent !important;
              border-radius: 0 !important;
              box-shadow: none !important;
              padding: 0 !important;
            }
            /* Remove blur effects and apply transparent backgrounds to all dashboard elements */
            .journalit-dashboard-metric-card,
            .journalit-dashboard-metric-wrapper,
            .journalit-dashboard-widget,
            .react-grid-item,
            .journalit-dashboard-calendar, 
            .journalit-dashboard-calendar-grid,
            .journalit-dashboard-calendar-week,
            .journalit-dashboard-calendar-day,
            .journalit-dashboard-calendar-weekly-pnl,
            .journalit-dashboard-widget-content,
            .journalit-dashboard-widget-container,
            .journalit-chart-container,
            .recharts-wrapper,
            .recharts-surface {
              backdrop-filter: none !important;
              -webkit-backdrop-filter: none !important;
              background-color: transparent !important;
            }
            /* Category tabs - ensure they're centered */
            .journalit-dashboard-component-selector-categories {
              justify-content: center !important;
            }
            /* SVG close button styling for perfect centering */
            .journalit-dashboard-component-selector-close svg {
              width: 14px !important;
              height: 14px !important;
              display: block !important;
            }
            /* Ensure today highlighting is always applied */
            .journalit-dashboard-calendar-day.today {
              border: 2px solid var(--interactive-accent) !important;
              box-shadow: 0 0 6px rgba(var(--interactive-accent-rgb), 0.4) !important;
              position: relative !important;
              z-index: 2 !important;
            }
            /* Ensure the remove buttons don't pierce through the overlay */
            .journalit-dashboard-widget-remove,
            .journalit-dashboard-metric-wrapper .journalit-dashboard-widget-remove,
            .journalit-dashboard-widget .journalit-dashboard-widget-remove {
              z-index: 10000 !important; /* Lower than the overlay */
            }
            
            /* Ensure text in calendar cells can adjust responsively */
            .journalit-dashboard-calendar-day-number,
            .journalit-dashboard-calendar-day-pnl,
            .journalit-dashboard-calendar-week-number,
            .journalit-dashboard-calendar-weekly-pnl-value {
              transition: font-size 0.1s ease-out !important;
              /* Remove default !important font-size rules to allow dynamic sizing */
              font-size: unset !important;
            }
            
            /* Trade count text styling - keep smaller than PNL */
            .journalit-dashboard-calendar-day-trades,
            .journalit-dashboard-calendar-weekly-trades {
              transition: font-size 0.1s ease-out !important;
              font-size: 10px !important; /* Set default smaller size */
              color: var(--text-muted) !important;
              top: 70% !important; /* Position lower */
            }
            
            /* Special protection for specific elements that might get overridden */
            .journalit-dashboard-calendar .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-number,
            .journalit-dashboard-calendar .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-week-number,
            .journalit-dashboard-calendar .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-pnl,
            .journalit-dashboard-calendar .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-weekly-pnl-value {
              /* Further reset any default size rules to allow dynamically applied sizes */
              font-size: unset !important;
            }
          `,document.head.appendChild(a)}},r)});let t=(r,n)=>{setTimeout(()=>{try{YT(),Ld(),n>0&&t(Math.min(r*1.5,1e3),n-1)}catch(i){console.error(`Error setting up calendar resize observer (attempt ${5-n}):`,i),n>0&&t(Math.min(r*1.5,1e3),n-1)}},r)};t(100,5),[100,300,500,800,1200].forEach(r=>{setTimeout(()=>{try{if(document.querySelectorAll(".journalit-dashboard-calendar").length>0){CB();let i=new CustomEvent("dashboard-styles-updated");document.dispatchEvent(i)}}catch(n){console.error(`Error in calendar-specific fixes at ${r}ms:`,n)}},r)})}catch(e){console.error("Error forcing dashboard styles:",e),r0()}}function nMe(){let e=document.head.querySelector("#dashboard-transparency-styles");e&&e.remove();let t=document.createElement("style");t.id="dashboard-transparency-styles",t.textContent=`
    /* Opaque mode - apply background colors */
    /* Keep widget headers transparent */
    .journalit-dashboard-widget-header,
    .journalit-dashboard-widget-minimal-header {
      background-color: transparent !important;
      border-bottom: 1px solid rgba(var(--background-modifier-border-rgb), 0.3) !important;
    }

    /* All components should have opaque background color */
    .journalit-dashboard-widget,
    .react-grid-item,
    .journalit-dashboard-metric-card,
    .journalit-chart-container,
    .journalit-dashboard-widget-container,
    .journalit-dashboard-calendar-day,
    .journalit-dashboard-calendar-weekly-pnl {
      background-color: var(--background-primary) !important;
    }

    /* Filter Controls opaque styling */
    .journalit-dashboard-filter-controls {
      background-color: var(--background-primary) !important;
      border: 1px solid rgba(var(--background-modifier-border-rgb, 0, 0, 0), 0.15) !important;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15) !important;
    }

    /* Style for filter buttons */
    .journalit-dashboard-date-range-presets button,
    .journalit-dashboard-reset-button,
    .journalit-dashboard-edit-mode-button {
      background-color: var(--background-primary) !important;
      border: 1px solid var(--background-modifier-border) !important;
    }

    /* Ensure dropdowns have opaque backgrounds */
    .journalit-dashboard-date-range-inputs,
    .journalit-dashboard-account-options-dropdown,
    .journalit-dashboard-ticker-options-dropdown {
      background-color: var(--background-primary) !important;
      border: 1px solid var(--background-modifier-border) !important;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1) !important;
    }

    /* Selected items in dropdowns should be highlighted properly */
    .journalit-dashboard-account-option-item input[type="checkbox"]:checked + span,
    .journalit-dashboard-ticker-option-item input[type="checkbox"]:checked + span {
      color: var(--interactive-accent) !important;
      font-weight: 600 !important;
    }

    /* Override positive/negative backgrounds to be more prominent against dark backgrounds */
    .journalit-dashboard-calendar-day.positive,
    .journalit-dashboard-calendar-weekly-pnl.positive {
      background-color: rgba(var(--color-green-rgb), 0.35) !important;
    }

    .journalit-dashboard-calendar-day.negative,
    .journalit-dashboard-calendar-weekly-pnl.negative {
      background-color: rgba(var(--color-red-rgb), 0.35) !important;
    }
    `,document.head.appendChild(t)}var rMe,PB=F(()=>{JT();rMe=`
  /* Base styling that applies regardless of transparency setting */
  /* Dashboard CSS variables */
  :root {
    /* Add background color variables for filled mode */
    --widget-bg-color: transparent;
    --metric-card-bg-color: transparent;
    --chart-bg-color: transparent;
    --calendar-day-bg-color: transparent;
    --calendar-weekday-bg-color: transparent;
    --interactive-accent-rgb: 94, 129, 172;
    --dashboard-dot-color: rgba(120, 120, 120, 0.15);
    --journalit-primary-filters-max-width: 700px;
  }

  /* Light theme specific dot color */
  .theme-light .journalit-dashboard-view {
    background-image: radial-gradient(circle, rgba(0, 0, 0, 0.1) 1px, transparent 1px) !important;
  }

  /* Dark theme specific dot color */
  .theme-dark .journalit-dashboard-view {
    background-image: radial-gradient(circle, rgba(255, 255, 255, 0.04) 1px, transparent 1px) !important;
  }

  /* Ensure no gap below view-header */
  .view-header {
    margin-bottom: 0 !important;
    padding-bottom: 0 !important;
  }
  
  /* Dashboard view container */
  .journalit-dashboard-view {
    width: 100% !important;
    height: 100% !important;
    display: flex !important;
    flex-direction: column !important;
    background-color: var(--background-primary) !important;
    background-size: 20px 20px !important;
    background-position: 0 0 !important;
    padding: 16px !important;
    overflow-x: hidden !important;
    overflow-y: auto !important;
    margin-top: 0 !important; /* Explicitly set to avoid unintended spacing */
  }
  
  /* Unified dashboard container for TopSection and BottomSection */
  .journalit-dashboard-unified-container {
    display: flex !important;
    flex-direction: column !important;
    gap: 2.5px !important; /* Set to half of the blue line gap (5px) */
    background-color: transparent !important;
    padding: 0 !important;
    flex: 1 1 0 !important; /* CRITICAL: Force height constraint like TradeLog fix */
    min-height: 0 !important; /* Prevent flexbox expansion */
    height: 0 !important; /* Force parent to control height */
  }
  
  /* Top metrics section */
  .journalit-dashboard-top-section {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 4px !important; /* Reduced from 16px to match grid layout gap */
    margin-bottom: 0 !important;
    padding: 4px !important; /* Reduced from 8px to reduce vertical spacing */
    background-color: transparent !important;
    border-radius: 0 !important;
    box-shadow: none !important;
  }
  
  /* Top metrics section styling */
  .journalit-dashboard-metrics {
    display: flex !important;
    flex-direction: row !important; /* Force horizontal layout */
    flex-wrap: wrap !important; /* Allow wrapping to new rows */
    gap: 8px !important; /* Consistent gap between cards */
    width: 100% !important; /* Ensure full width */
    overflow-x: hidden !important; /* No horizontal scrolling needed */
    overflow-y: visible !important; /* Allow vertical expansion */
    align-items: stretch !important; /* Make all cards the same height within each row */
    height: auto !important; /* Auto height based on content */
    min-height: auto !important; /* Let height be determined by content */
    padding: 10px 0 !important; /* Add some vertical padding */
    justify-content: flex-start !important; /* Align cards to the left */
  }
  
  /* Metric wrapper and card */
  .journalit-dashboard-metric-wrapper {
    position: relative !important;
    display: block !important;
    flex: 1 1 180px !important; /* Allow growing and shrinking with 180px base */
    min-width: 180px !important; /* Minimum width before wrapping */
    max-width: 300px !important; /* Maximum width to prevent cards from getting too wide */
  }
  
  /* We use the widget-remove button class for both widgets and metrics for consistency */
  .journalit-dashboard-widget-remove {
    position: absolute !important;
    top: 4px !important;
    right: 4px !important;
    background-color: var(--background-modifier-error) !important;
    color: white !important;
    border: none !important;
    border-radius: 50% !important;
    width: 22px !important;
    height: 22px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    font-size: 12px !important;
    cursor: pointer !important;
    z-index: 10000 !important; /* High, but lower than the overlay z-index */
    padding: 0 !important;
    font-weight: bold !important;
    line-height: 1 !important;
    pointer-events: auto !important;
    transition: opacity 0.2s ease, transform 0.2s ease !important;
    opacity: 0 !important; /* Hidden by default */
  }
  
  /* Show the remove button on widget hover in edit mode */
  .journalit-dashboard-grid-layout.is-editing .react-grid-item:hover .journalit-dashboard-widget-remove {
    opacity: 1 !important;
  }
  
  /* Show the remove button on metric hover in edit mode */
  .journalit-dashboard-top-section .journalit-dashboard-metric-wrapper:hover .journalit-dashboard-widget-remove {
    opacity: 1 !important;
  }
  
  /* Ensure the remove button is always clickable and has highest z-index */
  .journalit-dashboard-metric-wrapper .journalit-dashboard-widget-remove,
  .journalit-dashboard-widget .journalit-dashboard-widget-remove {
    pointer-events: auto !important;
    z-index: 100 !important; /* Reduced from 100000 to reasonable value */
  }
  
  .journalit-dashboard-widget-remove:hover {
    background-color: var(--text-error) !important;
    transform: scale(1.1) !important;
  }
  
  .journalit-dashboard-metric-card {
    flex: 1 1 180px !important; /* Allow growing and shrinking with 180px base */
    min-width: 180px !important;
    max-width: 300px !important; /* Prevent cards from getting too wide */
    padding: 14px !important;
    background-color: transparent !important;
    border-radius: 8px !important;
    border: 1px solid rgba(var(--background-modifier-border-rgb, 0, 0, 0), 0.08) !important;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04), 0 0 1px rgba(0, 0, 0, 0.08) !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: flex-start !important;
  }
  
  .journalit-dashboard-metric-name {
    font-size: 14px !important;
    font-weight: 600 !important;
    color: var(--text-muted) !important;
    margin-bottom: 6px !important;
    text-transform: uppercase !important;
    letter-spacing: 0.5px !important;
    text-align: left !important;
    width: 100% !important;
  }
  
  .journalit-dashboard-metric-value {
    font-size: 24px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    text-align: left !important;
    width: 100% !important;
  }
  
  .journalit-dashboard-metric-value.positive {
    color: var(--color-green) !important; /* Green for positive values */
  }
  
  .journalit-dashboard-metric-value.negative {
    color: var(--color-red) !important; /* Red for negative values */
  }
  
  /* Styling for cents in currency values */
  .journalit-dashboard-metric-cents {
    font-size: 16px !important;
    opacity: 0.7 !important;
    font-weight: 500 !important;
    margin-left: 1px !important;
    display: inline-block !important;
  }
  
  /* Filter controls - Redesigned for single row compact layout */
  .journalit-dashboard-filter-controls {
    display: flex !important;
    flex-direction: column !important;
    margin-bottom: 2.5px !important; /* Reduced from 5px to 2.5px (half of original) */
    padding: 12px 16px !important;
    background-color: var(--background-secondary) !important;
    border-radius: 8px !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15) !important;
    position: relative !important;
  }
  
  /* Filter row base styles */
  .journalit-dashboard-filter-row {
    display: grid !important;
    grid-template-columns: auto 1fr auto !important;
    gap: 20px !important;
    align-items: center !important; /* Change from flex-start to center */
    width: 100% !important;
  }
  
  /* Combined filters section */
  .journalit-dashboard-filters-section {
    display: flex !important;
    flex-direction: row !important;
    gap: 20px !important;
    align-items: center !important;
    min-width: 0 !important; /* Allow content to shrink if needed */
    flex: 1 !important;
  }
  
  .journalit-dashboard-date-range-section {
    display: flex !important;
    flex-direction: row !important;
    position: relative !important; /* Needed for absolute positioning of dropdown */
    /* Removed fixed min-width */
    flex: 1 !important;
    /* Changed from fixed margin to flexible margin */
    margin-right: 10px !important;
    margin-top: 0 !important; /* Ensure consistent alignment */
  }
  
  .journalit-dashboard-tickers-section,
  .journalit-dashboard-accounts-section {
    display: flex !important;
    flex-direction: row !important;
    /* Remove justify-self which can cause positioning issues */
    flex: 0 0 auto !important; /* Don't allow shrinking */
    margin-right: 10px !important;
    margin-top: 0 !important; /* Ensure consistent alignment */
  }
  
  .journalit-dashboard-filter-label {
    font-size: 13px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    margin-bottom: 4px !important;
    display: inline-block !important;
  }
  
  .journalit-dashboard-filter-actions {
    display: flex !important;
    align-items: center !important;
    /* Remove justify-self that can create issues */
    flex: 0 0 auto !important; /* Don't allow shrinking */
    gap: 8px !important; /* Changed from var(--button-gap) to explicit 8px */
    min-width: fit-content !important; /* Ensure buttons don't get squished */
    justify-self: end !important; /* Force align to the right in grid */
    margin-left: auto !important; /* Add auto margin to push to the right */
  }

  .journalit-dashboard-filter-actions > * {
    flex-shrink: 0 !important; /* Prevents button compression */
  }
  
  /* Special container for buttons in compact view */
  .journalit-dashboard-filter-actions.button-container {
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important; /* Changed from var(--button-gap) to explicit 8px */
  }
  
  /* Ensure buttons in compact view have consistent spacing */
  .journalit-dashboard-filter-actions.button-container .journalit-dashboard-reset-button,
  .journalit-dashboard-filter-actions.button-container .journalit-dashboard-edit-mode-button {
    margin-bottom: 0 !important;
    margin-top: 0 !important;
    height: 28px !important;
    line-height: 1 !important;
  }

  /* Dashboard header layout */
  .journalit-dashboard-header,
  .journalit-dashboard-header-compact {
    display: flex !important;
    flex-direction: row !important;
    align-items: center !important;
    justify-content: flex-start !important;
    gap: 16px !important;
    width: 100% !important;
    flex-wrap: wrap !important;
  }

  .journalit-dashboard-primary-filters {
    display: flex !important;
    align-items: center !important;
    flex: 0 1 auto !important;
    min-width: 0 !important;
    max-width: var(--journalit-primary-filters-max-width) !important;
  }

  /* Date range filter - More compact */
  .journalit-dashboard-date-range-filter {
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important;
    position: relative !important; /* Add this to ensure proper containment of the dropdown */
  }
  
  .journalit-dashboard-date-range-presets {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 6px !important;
    align-items: center !important;
  }
  
  .journalit-dashboard-date-range-presets button {
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    padding: 5px 10px !important;
    font-size: 12px !important;
    font-weight: 500 !important;
    color: var(--text-normal) !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
    height: 28px !important;
    line-height: 1 !important;
  }
  
  .journalit-dashboard-date-range-presets button:hover {
    background-color: var(--background-modifier-hover) !important;
    border-color: var(--interactive-accent) !important;
  }
  
  .journalit-dashboard-date-range-presets button.active {
    background-color: var(--interactive-accent) !important;
    color: var(--text-on-accent, white) !important;
    border-color: var(--interactive-accent) !important;
  }
  
  .journalit-dashboard-date-range-inputs {
    display: flex !important;
    gap: 10px !important;
    flex-wrap: nowrap !important; /* Keep horizontal layout */
    padding: 8px !important;
    background-color: var(--background-primary) !important;
    border-radius: 4px !important;
    border: 1px solid var(--background-modifier-border) !important;
    margin-top: 0 !important; /* Remove top margin */
    position: absolute !important;
    top: 0 !important; /* Align with the buttons horizontally */
    left: auto !important; /* Reset left positioning */
    right: -360px !important; /* Position to the right of buttons */
    z-index: 100 !important;
    width: 350px !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1) !important;
    transition: opacity 0.2s ease, transform 0.2s ease !important;
    opacity: 1 !important;
    transform: translateY(0) !important;
  }
  
  /* Animation for opening/closing the dropdown */
  .journalit-dashboard-date-range-inputs.date-dropdown-visible {
    animation: dateDropdownFadeIn 0.25s cubic-bezier(0.19, 1, 0.22, 1) !important;
  }
  
  @keyframes dateDropdownFadeIn {
    from {
      opacity: 0;
      transform: translateY(-5px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  /* Specific styling for custom date dropdown to make sure it appears in the right position */
  .journalit-dashboard-custom-date-dropdown {
    position: absolute !important;
    top: 0 !important; /* Position at the same level as buttons */
    left: auto !important;
    right: -360px !important; /* Position to the right of the custom button */
    z-index: 100 !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2) !important;
  }

  /* Position dropdown to the left when it would go off-screen */
  .journalit-dashboard-custom-date-dropdown.position-left {
    right: auto !important;
    left: -360px !important; /* Position to the left of the custom button */
  }

  /* Position below fallback for when horizontal space is insufficient */
  .journalit-dashboard-custom-date-dropdown.position-below {
    top: 100% !important;
    left: 0 !important;
    right: auto !important;
    margin-top: 8px !important;
    width: 100% !important;
    max-width: 360px !important;
    max-height: min(300px, 50vh) !important;
    overflow-y: auto !important;
    box-sizing: border-box !important;
  }

  .journalit-dashboard-date-range-start,
  .journalit-dashboard-date-range-end {
    flex: 1 !important;
    min-width: 150px !important;
  }
  
  .journalit-dashboard-date-range-start label,
  .journalit-dashboard-date-range-end label {
    display: block !important;
    font-size: 12px !important;
    margin-bottom: 4px !important;
    color: var(--text-muted) !important;
    font-weight: 500 !important;
  }
  
  /* Date picker input styling */
  .journalit-date-picker-input input {
    width: 100% !important;
    padding: 6px 10px !important;
    font-size: 13px !important;
    border-radius: 4px !important;
    border: 1px solid var(--background-modifier-border) !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    transition: border-color 0.2s ease, box-shadow 0.2s ease !important;
  }
  
  .journalit-date-picker-input input:focus {
    border-color: var(--interactive-accent) !important;
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2) !important;
    outline: none !important;
  }
  
  .journalit-date-picker-input input:hover {
    border-color: var(--interactive-hover) !important;
  }
  
  /* Account filter - New dropdown style */
  .journalit-dashboard-account-filter,
  .journalit-dashboard-ticker-filter,
  .journalit-dashboard-tag-filter {
    display: flex !important;
    flex-direction: column !important;
    /* Changed from fixed width to min-width for better responsiveness */
    min-width: 140px !important;
    max-width: 200px !important;
    width: 100% !important;
    position: relative !important;
  }
  
  /* Ensure filters within the combined section size properly */
  .journalit-dashboard-filters-section .journalit-dashboard-tickers-section {
    flex: 1 !important;
    min-width: 0 !important;
  }
  
  /* Responsive account/ticker filter class for enhanced appearance across screen sizes */
  .journalit-responsive-account-filter,
  .journalit-responsive-ticker-filter,
  .journalit-responsive-tag-filter {
    width: auto !important;
    flex-shrink: 0 !important;
    /* Ensure dropdowns always fit content */
    white-space: nowrap !important;
    overflow: visible !important;
  }
  
  .journalit-dashboard-account-dropdown,
  .journalit-dashboard-ticker-dropdown,
  .journalit-dashboard-setup-dropdown,
  .journalit-dashboard-tag-dropdown {
    position: relative !important;
    width: 100% !important;
  }
  
  .journalit-dashboard-account-summary,
  .journalit-dashboard-ticker-summary,
  .journalit-dashboard-setup-summary,
  .journalit-dashboard-tag-summary {
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    padding: 5px 10px !important;
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    cursor: pointer !important;
    font-size: 0.9em !important;
    white-space: nowrap !important;
    gap: 8px !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
    min-width: 0 !important;
  }

  .journalit-dashboard-summary-text {
    flex: 1 !important;
    min-width: 0 !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
    white-space: nowrap !important;
  }

  .journalit-dashboard-account-summary:hover,
  .journalit-dashboard-ticker-summary:hover,
  .journalit-dashboard-setup-summary:hover,
  .journalit-dashboard-tag-summary:hover {
    border-color: var(--interactive-accent) !important;
    background-color: var(--background-modifier-hover) !important;
  }

  .journalit-dashboard-account-summary:focus-visible,
  .journalit-dashboard-ticker-summary:focus-visible,
  .journalit-dashboard-setup-summary:focus-visible,
  .journalit-dashboard-tag-summary:focus-visible {
    outline: 2px solid var(--interactive-accent) !important;
    outline-offset: 2px !important;
  }
  
  .journalit-dashboard-account-summary .dropdown-arrow,
  .journalit-dashboard-ticker-summary .dropdown-arrow {
    font-size: 0.7em !important;
    color: var(--text-muted) !important;
  }
  
  .journalit-dashboard-account-options-dropdown,
  .journalit-dashboard-ticker-options-dropdown,
  .journalit-dashboard-setup-options-dropdown,
  .journalit-dashboard-tag-options-dropdown {
    position: absolute !important;
    top: 100% !important;
    left: 0 !important;
    right: 0 !important;
    max-height: min(300px, 50vh) !important;
    overflow-y: auto !important;
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    margin-top: 4px !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1) !important;
    z-index: 100 !important;
  }
  
  .journalit-dashboard-account-option-item,
  .journalit-dashboard-ticker-option-item,
  .journalit-dashboard-setup-option-item,
  .journalit-dashboard-tag-option-item {
    display: flex !important;
    align-items: center !important;
    gap: 8px !important;
    padding: 6px 10px !important;
    cursor: pointer !important;
    font-size: 13px !important;
  }
  
  .journalit-dashboard-account-option-item:hover,
  .journalit-dashboard-ticker-option-item:hover,
  .journalit-dashboard-setup-option-item:hover,
  .journalit-dashboard-tag-option-item:hover {
    background-color: var(--background-modifier-hover) !important;
  }

  .journalit-dashboard-account-option-item:focus-visible,
  .journalit-dashboard-ticker-option-item:focus-visible,
  .journalit-dashboard-setup-option-item:focus-visible,
  .journalit-dashboard-tag-option-item:focus-visible {
    outline: 2px solid var(--interactive-accent) !important;
    outline-offset: -2px !important;
  }

  .journalit-dashboard-account-option-item > span:last-child,
  .journalit-dashboard-ticker-option-item > span:last-child,
  .journalit-dashboard-setup-option-item > span:last-child,
  .journalit-dashboard-tag-option-item > span:last-child {
    flex: 1 !important;
    min-width: 0 !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
    white-space: nowrap !important;
  }
  
  .journalit-dashboard-account-option-item.select-all,
  .journalit-dashboard-ticker-option-item.select-all,
  .journalit-dashboard-tag-option-item.select-all {
    font-weight: 500 !important;
  }
  
  .journalit-dashboard-account-divider,
  .journalit-dashboard-ticker-divider,
  .journalit-dashboard-setup-divider,
  .journalit-dashboard-tag-divider {
    height: 1px !important;
    background-color: var(--background-modifier-border) !important;
    margin: 4px 0 !important;
  }
  
  /* No accounts/tickers message */
  .journalit-dashboard-no-accounts,
  .journalit-dashboard-no-tickers,
  .journalit-dashboard-no-tags {
    padding: 12px !important;
    color: var(--text-muted) !important;
    font-style: italic !important;
    text-align: center !important;
    font-size: 13px !important;
  }

  /* Custom checkbox styling for Account, Ticker, Setup, and Tag filters */
  .journalit-dashboard-account-checkbox,
  .journalit-dashboard-ticker-checkbox,
  .journalit-dashboard-setup-checkbox,
  .journalit-dashboard-tag-checkbox {
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    width: 14px !important;
    height: 14px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 2px !important;
    background-color: var(--background-primary) !important;
    font-size: 10px !important;
    color: var(--text-on-accent) !important;
    flex-shrink: 0 !important;
  }

  .journalit-dashboard-account-checkbox.checked,
  .journalit-dashboard-ticker-checkbox.checked,
  .journalit-dashboard-setup-checkbox.checked,
  .journalit-dashboard-tag-checkbox.checked {
    background-color: var(--interactive-accent) !important;
    border-color: var(--interactive-accent) !important;
  }

  /* Setup Filter Styles */
  .journalit-dashboard-setup-filter {
    display: flex !important;
    flex-direction: column !important;
    position: relative !important;
    min-width: 140px !important;
  }

  .journalit-dashboard-setup-dropdown-arrow {
    font-size: 0.7em !important;
    color: var(--text-muted) !important;
  }

  .journalit-dashboard-setup-option-all {
    font-weight: 500 !important;
  }

  .journalit-dashboard-reset-button {
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    padding: 5px 10px !important;
    font-size: 12px !important;
    font-weight: 500 !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
    white-space: nowrap !important;
    height: 28px !important;
    line-height: 1 !important;
  }
  
  .journalit-dashboard-reset-button:hover {
    background-color: var(--background-modifier-hover) !important;
    border-color: var(--interactive-accent) !important;
  }
  
  .journalit-dashboard-reset-button:disabled {
    opacity: 0.5 !important;
    cursor: default !important;
  }
  
  /* Grid layout container */
  .journalit-dashboard-bottom-section {
    width: 100% !important;
    min-height: 500px !important;
    background-color: transparent !important;
    border-radius: 0 !important;
    padding: 4px !important; /* Reduced from 8px to match top section */
    position: relative !important;
  }
  
  /* Widget styles */
  .journalit-dashboard-widget {
    background-color: transparent !important;
    border-radius: 6px !important;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1) !important;
    display: flex !important;
    flex-direction: column !important;
    overflow: hidden !important;
    /* backdrop-filter removed as requested */
  }
  
  /* Minimal widget header for non-edit mode */
  .journalit-dashboard-widget-minimal-header {
    display: flex !important;
    justify-content: center !important;
    align-items: center !important;
    padding: 4px 12px !important;
    height: 24px !important;
    background-color: transparent !important;
    border-bottom: 1px solid rgba(var(--background-modifier-border-rgb), 0.4) !important;
    opacity: 0.8 !important;
  }
  
  .journalit-dashboard-widget-minimal-header .journalit-dashboard-widget-title {
    font-weight: 500 !important;
    font-size: 13px !important;
    color: var(--text-muted) !important;
    letter-spacing: 0.3px !important;
    text-align: center !important;
    width: 100% !important;
    /* Add subtle text shadow for better readability */
    text-shadow: 0 1px 1px rgba(var(--background-primary-rgb), 0.8) !important;
  }
  
  .journalit-dashboard-widget-header {
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    padding: 12px 16px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
  }
  
  .journalit-dashboard-widget-title {
    font-size: 16px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
  }
  
  .journalit-dashboard-widget-controls {
    display: flex !important;
    gap: 8px !important;
  }
  
  .journalit-dashboard-widget-content {
    flex: 1 !important;
    padding: 4px 4px 2px 1px !important;
    overflow: hidden !important;
    background-color: transparent !important;
  }
  
  /* React Grid Layout styles */
  .react-grid-item {
    background-color: transparent !important;
    border-radius: 6px !important;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1) !important;
    /* backdrop-filter removed as requested */
  }
  
  .react-grid-item.react-grid-placeholder {
    background-color: var(--interactive-accent) !important;
    opacity: 0.3 !important;
  }
  
  .react-resizable-handle {
    position: absolute !important;
    bottom: 0 !important;
    right: 0 !important;
    width: 20px !important;
    height: 20px !important;
    background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="rgba(120, 120, 120, 0.5)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 22L12 12M22 13V22H13"></path></svg>') !important;
    background-position: bottom right !important;
    padding: 0 3px 3px 0 !important;
    background-repeat: no-repeat !important;
    background-origin: content-box !important;
    box-sizing: border-box !important;
    cursor: se-resize !important;
    display: none !important; /* Hide resize handles by default */
  }
  
  /* Only show resize handles when in edit mode */
  .journalit-dashboard-grid-layout.is-editing .react-resizable-handle {
    display: block !important;
  }

  /* Home Grid Layout - Show resize handles in edit mode */
  .journalit-home-grid-layout.is-editing .react-resizable-handle {
    display: block !important;
    position: absolute !important;
    width: 20px !important;
    height: 20px !important;
    bottom: 0 !important;
    right: 0 !important;
    cursor: se-resize !important;
    opacity: 0.6 !important;
    z-index: 10 !important;
  }

  .journalit-home-grid-layout.is-editing .react-resizable-handle:hover {
    opacity: 1 !important;
  }

  .journalit-home-grid-layout .react-grid-item > .react-resizable-handle.react-resizable-handle-se {
    bottom: 2px !important;
    right: 2px !important;
  }

  /* Chart styles */
  .recharts-wrapper {
    width: 100% !important;
    height: 100% !important;
  }
  
  .recharts-cartesian-grid-horizontal line,
  .recharts-cartesian-grid-vertical line {
    stroke: var(--background-modifier-border) !important;
    stroke-dasharray: 2 !important;
  }
  
  /* Modern custom tooltip styles */
  .recharts-tooltip-wrapper {
    pointer-events: none !important;
    z-index: 1000 !important;
    filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.25)) !important;
    background-color: transparent !important;
    border: none !important;
  }
  
  .recharts-tooltip-wrapper * {
    outline: none !important;
  }
  
  .journalit-dashboard-custom-tooltip {
    background-color: var(--background-primary, #ffffff) !important;
    border-radius: 8px !important;
    padding: 12px 16px !important;
    min-width: 120px !important;
    border: 1px solid var(--background-modifier-border, rgba(0, 0, 0, 0.05)) !important;
    transform: translateY(-4px) !important;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15) !important;
    position: relative !important;
  }
  
  
  .journalit-dashboard-tooltip-date {
    font-size: 14px !important;
    font-weight: 500 !important;
    color: var(--text-normal, #333333) !important;
    margin-bottom: 6px !important;
    text-align: center !important;
  }
  
  .journalit-dashboard-tooltip-value {
    font-size: 18px !important;
    font-weight: 600 !important;
    text-align: center !important;
  }
  
  .journalit-dashboard-tooltip-value.positive {
    color: var(--text-success, #43a047) !important;
  }
  
  .journalit-dashboard-tooltip-value.negative {
    color: var(--text-error, #e53935) !important;
  }
  
  /* Calendar widget */
  .journalit-dashboard-calendar {
    width: 100% !important;
    height: 100% !important;
    display: flex !important;
    flex-direction: column !important;
    overflow: auto !important;
  }
  
  .journalit-dashboard-calendar-header {
    display: grid !important;
    grid-template-columns: repeat(7, 1fr) 1fr !important; /* 7 days + 1 P&L column */
    margin-bottom: 8px !important;
    gap: 4px !important;
    position: sticky !important;
    top: 0 !important;
    background-color: transparent !important;
    z-index: 5 !important;
    padding: 4px 0 !important;
    width: 100% !important;
    justify-content: stretch !important;
  }
  
  /* Special styling for when weekends are hidden */
  /* We apply the hide-weekends class directly to the header and week rows */
  .journalit-dashboard-calendar-header.hide-weekends,
  .journalit-dashboard-calendar .hide-weekends .journalit-dashboard-calendar-header,
  .journalit-dashboard-calendar.hide-weekends .journalit-dashboard-calendar-header,
  .journalit-dashboard-calendar.weekends-hidden .journalit-dashboard-calendar-header {
    grid-template-columns: repeat(5, 1fr) 1fr !important;
    width: 100% !important;
  }
  
  .journalit-dashboard-calendar-grid {
    display: flex !important;
    flex-direction: column !important;
    gap: 4px !important;
    flex: 1 !important;
    width: 100% !important;
  }
  
  .journalit-dashboard-calendar-week {
    display: grid !important;
    grid-template-columns: repeat(7, 1fr) 1fr !important; /* 7 days + 1 P&L column */
    gap: 4px !important;
    margin-bottom: 4px !important;
    width: 100% !important;
  }
  
  /* Special styling for when weekends are hidden */
  .journalit-dashboard-calendar-week.hide-weekends,
  .journalit-dashboard-calendar .hide-weekends .journalit-dashboard-calendar-week,
  .journalit-dashboard-calendar.hide-weekends .journalit-dashboard-calendar-week,
  .journalit-dashboard-calendar.weekends-hidden .journalit-dashboard-calendar-week {
    grid-template-columns: repeat(5, 1fr) 1fr !important;
    width: 100% !important;
  }
  
  /* Ensure the calendar container has proper styles */
  .journalit-dashboard-calendar.hide-weekends,
  .journalit-dashboard-calendar.weekends-hidden {
    width: 100% !important;
  }
  
  /* Ensure grid cells take up full width in their columns */
  .journalit-dashboard-calendar-day,
  .journalit-dashboard-calendar-weekly-pnl {
    width: 100% !important; 
  }
  
  /* Ensure P&L header is visible in both light and dark modes */
  .theme-light .journalit-dashboard-calendar-weekday.weekly-pnl-header {
    background-color: var(--interactive-accent, #5e81ac) !important; /* Use an accent background with fallback for better contrast */
    color: var(--text-on-accent, #ffffff) !important; /* Ensure text color is appropriate for accent background */
  }

  /* Weekly P&L column styles */
  .journalit-dashboard-calendar-weekly-pnl {
    aspect-ratio: 1 !important;
    position: relative !important;
    background-color: var(--background-secondary-alt) !important;
    border-radius: 8px !important;
    padding: 4px !important;
    border-left: 1px solid rgba(0, 0, 0, 0.08) !important;
    cursor: pointer !important;
    transition: transform 0.2s ease-out, box-shadow 0.2s ease-out !important;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05), 0 0 0 1px var(--background-modifier-border) !important;
    color: var(--text-normal) !important;
  }
  
  .journalit-dashboard-calendar-weekly-pnl:hover {
    transform: scale(1.05) !important;
  }
  
  .journalit-dashboard-calendar-weekly-pnl.positive {
    background-color: rgba(var(--color-green-rgb), 0.15) !important;
    color: var(--color-green) !important;
  }
  
  .journalit-dashboard-calendar-weekly-pnl.negative {
    background-color: rgba(var(--color-red-rgb), 0.15) !important;
    color: var(--color-red) !important;
  }
  
  /* Weekly totals positioning */
  .journalit-dashboard-calendar-week-total-label {
    font-size: 11px !important;
    font-weight: 600 !important;
    text-transform: uppercase !important;
    letter-spacing: 0.5px !important;
    color: var(--text-muted) !important;
    position: absolute !important;
    top: 25% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    width: 100% !important;
    text-align: center !important;
  }

  .journalit-dashboard-calendar-week-total-value {
    font-size: 13px !important;
    font-weight: 700 !important;
    position: absolute !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    width: 100% !important;
    text-align: center !important;
  }

  .journalit-dashboard-calendar-week-trade-count {
    font-size: 10px !important;
    color: var(--text-muted) !important;
    font-weight: 500 !important;
    position: absolute !important;
    bottom: 20% !important;
    left: 50% !important;
    transform: translate(-50%, 50%) !important;
    width: 85% !important;
    text-align: center !important;
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
  }
  
  .journalit-dashboard-calendar-day {
    aspect-ratio: 1 !important;
    display: flex !important;
    position: relative !important; /* Added for absolute positioning */
    border-radius: 8px !important;
    cursor: pointer !important;
    font-size: 12px !important;
    font-weight: 500 !important;
    transition: all 0.2s !important;
    background-color: var(--background-secondary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05) !important;
  }
  
  .journalit-dashboard-calendar-day:hover {
    transform: scale(1.05) !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1) !important;
  }
  
  .journalit-dashboard-calendar-day.positive {
    background-color: rgba(var(--color-green-rgb), 0.15) !important;
    background-image: linear-gradient(to bottom, rgba(var(--color-green-rgb), 0.05), rgba(var(--color-green-rgb), 0.2)) !important;
    color: var(--color-green) !important;
    border-color: rgba(var(--color-green-rgb), 0.3) !important;
    box-shadow: 0 2px 8px rgba(var(--color-green-rgb), 0.1) !important;
  }
  
  .journalit-dashboard-calendar-day.negative {
    background-color: rgba(var(--color-red-rgb), 0.15) !important;
    background-image: linear-gradient(to bottom, rgba(var(--color-red-rgb), 0.05), rgba(var(--color-red-rgb), 0.2)) !important;
    color: var(--color-red) !important;
    border-color: rgba(var(--color-red-rgb), 0.3) !important;
    box-shadow: 0 2px 8px rgba(var(--color-red-rgb), 0.1) !important;
  }
  
  .journalit-dashboard-calendar-day.positive:hover {
    box-shadow: 0 4px 12px rgba(var(--color-green-rgb), 0.2), 0 0 0 1px rgba(var(--color-green-rgb), 0.5) !important;
  }
  
  .journalit-dashboard-calendar-day.negative:hover {
    box-shadow: 0 4px 12px rgba(var(--color-red-rgb), 0.2), 0 0 0 1px rgba(var(--color-red-rgb), 0.5) !important;
  }
  
  .journalit-dashboard-calendar-day.other-month {
    opacity: 0.3 !important;
  }
  
  /* Day number positioning in the top-left */
  .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-number,
  .journalit-dashboard-calendar .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-number,
  .journalit-dashboard-calendar-grid .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-number {
    position: absolute !important;
    top: 4px !important;
    left: 4px !important;
    text-align: left !important;
    font-size: 12px !important;
    font-weight: 500 !important;
  }
  
  /* PNL value centered and larger */
  .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-pnl,
  .journalit-dashboard-calendar .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-pnl,
  .journalit-dashboard-calendar-grid .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-pnl {
    font-size: 12px !important; /* Increased from 10px */
    width: 100% !important;
    position: absolute !important;
    top: 46% !important; /* Moved slightly higher to make room for trade count */
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    margin-top: 0 !important;
    font-weight: 600 !important;
    text-align: center !important;
  }
  
  /* Trade count styling - smaller than PNL value */
  .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-trades,
  .journalit-dashboard-calendar .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-trades,
  .journalit-dashboard-calendar-grid .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-trades {
    font-size: 10px !important;
    width: 100% !important;
    position: absolute !important;
    top: 70% !important; /* Position further down for better separation */
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    margin-top: 0 !important;
    font-weight: 400 !important;
    text-align: center !important;
    color: var(--text-muted) !important;
  }
  
  /* Week number positioning in the top-left */
  .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-week-number,
  .journalit-dashboard-calendar .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-week-number,
  .journalit-dashboard-calendar-grid .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-week-number {
    position: absolute !important;
    top: 4px !important;
    left: 4px !important;
    text-align: left !important;
    font-size: 12px !important;
    font-weight: 500 !important;
    margin-bottom: 0 !important;
  }
  
  /* Weekly PNL value centered and larger */
  .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-weekly-pnl-value,
  .journalit-dashboard-calendar .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-weekly-pnl-value,
  .journalit-dashboard-calendar-grid .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-weekly-pnl-value {
    font-size: 12px !important; /* Increased from 10px */
    width: 100% !important;
    position: absolute !important;
    top: 46% !important; /* Moved slightly higher to make room for trade count */
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    font-weight: 600 !important;
    text-align: center !important;
  }
  
  /* Weekly trade count styling - smaller than PNL value */
  .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-weekly-trades,
  .journalit-dashboard-calendar .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-weekly-trades,
  .journalit-dashboard-calendar-grid .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-weekly-trades {
    font-size: 10px !important;
    width: 100% !important;
    position: absolute !important;
    top: 70% !important; /* Position further down for better separation */
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    font-weight: 400 !important;
    text-align: center !important;
    color: var(--text-muted) !important;
  }
  
  /* Recent Trades widget styles */
  .journalit-dashboard-recent-trades {
    width: 100% !important;
    height: 100% !important;
    overflow: auto !important;
    /* Remove top padding, keep padding on sides and bottom to prevent gap above sticky header */
    padding: 0 8px 8px 8px !important;
    position: relative !important;
  }
  
  .journalit-dashboard-recent-trades-table {
    width: 100% !important;
    border-collapse: collapse !important;
    /* Add padding to the top of the table to replace container's top padding */
    padding-top: 8px !important;
    margin-top: 0 !important;
  }
  
  .journalit-dashboard-recent-trades-table th {
    text-align: center !important;
    padding: 7px 8px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
    font-size: 12px !important;
    font-weight: 500 !important;
    color: var(--text-muted) !important;
    text-transform: uppercase !important;
    letter-spacing: 0.5px !important;
    position: sticky !important;
    top: 0 !important;
    background-color: var(--background-primary) !important;
    z-index: 10 !important;
  }

  .journalit-dashboard-recent-trades-table td {
    text-align: center !important;
    padding: 7px 8px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
    font-size: 13px !important;
  }
  
  .journalit-dashboard-recent-trades-table .trade-row {
    cursor: pointer !important;
    transition: background-color 0.15s ease !important;
  }

  .journalit-dashboard-recent-trades-table .trade-row:hover {
    background-color: var(--background-modifier-hover) !important;
  }
  
  .journalit-dashboard-recent-trades-table .ticker-cell {
    font-weight: 600 !important;
  }
  
  .journalit-dashboard-recent-trades-table .direction-cell {
    font-weight: 500 !important;
  }
  
  .journalit-dashboard-recent-trades-table .pnl-cell {
    font-weight: 600 !important;
  }
  
  .journalit-dashboard-recent-trades-table .pnl-cell.positive {
    color: var(--text-success) !important;
  }

  .journalit-dashboard-recent-trades-table .pnl-cell.negative {
    color: var(--text-error) !important;
  }
  
  .journalit-dashboard-recent-trades-table .empty-message {
    text-align: center !important;
    padding: 16px !important;
    color: var(--text-muted) !important;
    font-style: italic !important;
  }
  
  /* Today highlight styling with high specificity to prevent overrides */
  .journalit-dashboard-calendar-day.today,
  .journalit-dashboard-calendar .journalit-dashboard-calendar-day.today,
  .journalit-dashboard-calendar-grid .journalit-dashboard-calendar-day.today {
    border: 2px solid var(--interactive-accent) !important;
    box-shadow: 0 0 6px rgba(var(--interactive-accent-rgb), 0.4) !important;
    position: relative !important;
    z-index: 2 !important; /* Higher z-index to ensure the highlight is visible */
    animation: pulseBorder 2s infinite ease-in-out !important;
  }
  
  .journalit-dashboard-calendar-day.neutral {
    background-color: var(--background-secondary) !important;
    color: var(--text-muted) !important;
  }
  
  /* Table styles */
  .journalit-dashboard-trades-table {
    width: 100% !important;
    border-collapse: collapse !important;
  }
  
  .journalit-dashboard-trades-table th,
  .journalit-dashboard-trades-table td {
    padding: 8px 12px !important;
    text-align: left !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
  }
  
  .journalit-dashboard-trades-table th {
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    background-color: var(--background-secondary) !important;
    position: sticky !important;
    top: 0 !important;
    z-index: 1 !important;
  }
  
  .journalit-dashboard-trades-table tr:hover {
    background-color: var(--background-modifier-hover) !important;
  }
  
  /* Layout controls */
  .journalit-dashboard-layout-controls {
    display: flex !important;
    justify-content: flex-end !important;
    gap: 8px !important;
    margin-bottom: 16px !important;
  }
  
  /* Edit mode button in filter actions */
  .journalit-dashboard-edit-mode-button {
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    padding: 5px 10px !important;
    font-size: 12px !important;
    font-weight: 500 !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
    white-space: nowrap !important;
    height: 28px !important;
    line-height: 1 !important;
  }
  
  .journalit-dashboard-edit-mode-button:hover {
    background-color: var(--background-modifier-hover) !important;
    border-color: var(--interactive-accent) !important;
  }
  
  .journalit-dashboard-edit-mode-button.active {
    background-color: var(--interactive-accent) !important;
    color: var(--text-on-accent, white) !important;
    border-color: var(--interactive-accent) !important;
  }

  /* Add Widget button in filter actions (appears when editing) */
  .journalit-dashboard-add-widget-button {
    display: flex !important;
    align-items: center !important;
    gap: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    padding: 5px 10px !important;
    font-size: 12px !important;
    font-weight: 500 !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
    white-space: nowrap !important;
    height: 28px !important;
    line-height: 1 !important;
  }

  .journalit-dashboard-add-widget-button:hover {
    background-color: var(--background-modifier-hover) !important;
    border-color: var(--interactive-accent) !important;
  }

  /* Loading and error states */
  .journalit-dashboard-loading,
  .journalit-dashboard-error {
    display: flex !important;
    justify-content: center !important;
    align-items: center !important;
    padding: 20px !important;
    font-size: 16px !important;
    color: var(--text-muted) !important;
  }
  
  .journalit-dashboard-error {
    color: var(--text-error) !important;
  }
  
  /* Responsive styles - comprehensive approach for all screen sizes */
  /* XL screens - new breakpoint to handle 1560px width */
  @media (max-width: 1560px) {
    /* Adjust filter controls for this specific breakpoint range */
    .journalit-dashboard-filter-row.standard-responsive {
      grid-template-columns: minmax(300px, auto) auto 1fr auto !important;
      gap: 10px !important;
    }
    
    /* Ensure filters section stays in one line */
    .journalit-dashboard-filters-section {
      flex-wrap: nowrap !important;
      max-width: fit-content !important;
      justify-content: flex-start !important;
    }
    
    /* Make sure account and ticker filters have adequate space and stay together */
    .journalit-dashboard-account-filter,
    .journalit-dashboard-ticker-filter {
      min-width: 140px !important;
    }
    
    /* Keep account filter next to ticker filter */
    .journalit-dashboard-accounts-section {
      margin-left: 0 !important;
      padding-left: 0 !important;
    }
    
    /* Ensure the row structure stays intact at this breakpoint */
    .journalit-dashboard-filter-section {
      width: 100% !important;
    }
    
    /* Adjust date range input position */
    .journalit-dashboard-date-range-inputs,
    .journalit-dashboard-custom-date-dropdown {
      right: -250px !important; /* Reduce the offset */
      width: 300px !important; /* Make it slightly smaller */
    }
  }
  
  /* Large screens */
  @media (max-width: 1200px) {
    /* Slightly reduce padding and margins for better fit */
    .journalit-dashboard-view {
      padding: 12px !important;
    }

    .journalit-dashboard-metric-card {
      min-width: 180px !important;
    }

    /* Ensure buttons remain visible on medium screens */
    .journalit-dashboard-filter-actions {
      gap: 6px !important;
    }

    .journalit-dashboard-filter-actions button {
      padding: 6px !important;
      min-width: auto !important;
    }
  }
  
  /* Medium screens */
  @media (max-width: 1000px) {
    /* Further reduce spacing */
    .journalit-dashboard-view {
      padding: 10px !important;
    }

    .journalit-dashboard-metric-card {
      min-width: 150px !important;
      padding: 12px !important;
    }

    .journalit-dashboard-metric-value {
      font-size: 20px !important;
    }

    /* Adjust date dropdown position */
    .journalit-dashboard-date-range-inputs,
    .journalit-dashboard-custom-date-dropdown {
      right: -100px !important;
    }

    /* Reduce date filter width on medium screens */
    .journalit-dashboard-primary-filters {
      max-width: 500px !important;
    }

    .journalit-dashboard-header,
    .journalit-dashboard-header-compact {
      gap: 12px !important;
    }
  }
  
  /* Medium-small screens - additional breakpoint */
  @media (max-width: 900px) {
    /* Ensure the filter controls container has appropriate padding */
    .journalit-dashboard-filter-controls {
      padding: 10px 12px !important;
    }
    
    /* At this size, begin transitioning to more compact layout */
    .journalit-dashboard-filter-row.standard-responsive {
      /* More aggressive column sizing to prevent overflow */
      grid-template-columns: 1fr auto auto !important;
      gap: 8px !important;
    }
    
    /* Further reduce right margin for date section */
    .journalit-dashboard-date-range-section {
      margin-right: 5px !important;
    }
    
    /* Make buttons more compact */
    /* Ensure buttons in compact tablet views align properly */
    .journalit-dashboard-filter-actions.button-container {
      gap: 8px !important; /* Changed from var(--button-gap) to explicit 8px */
    }
    
    /* Fixed height buttons in mobile view for consistent appearance */
    .journalit-dashboard-filter-controls.compact-view .journalit-dashboard-reset-button,
    .journalit-dashboard-filter-controls.compact-view .journalit-dashboard-edit-mode-button {
      height: 28px !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
    }
    
    .journalit-dashboard-reset-button,
    .journalit-dashboard-edit-mode-button {
      padding: 4px 8px !important;
      font-size: 11px !important;
    }
    
    /* Make account dropdown narrower */
    .journalit-dashboard-account-filter {
      min-width: 120px !important;
    }

    /* Reduce date filter width further */
    .journalit-dashboard-primary-filters {
      max-width: 450px !important;
    }

    .journalit-dashboard-header,
    .journalit-dashboard-header-compact {
      gap: 8px !important;
    }
  }

  /* Small tablet screens */
  @media (max-width: 768px) {
    /* Force compact view if not already applied by component */
    .journalit-dashboard-filter-controls:not(.compact-view) {
      /* Add a class to force compact view directly via CSS if needed */
      /* This is a backup in case the JS detection doesn't trigger properly */
    }
    
    /* Switch to vertical layout for filter controls */
    .journalit-dashboard-filter-row.standard-responsive,
    .journalit-dashboard-filter-row.medium-responsive,
    .journalit-dashboard-filter-row {
      grid-template-columns: 1fr !important;
      gap: 16px !important;
    }
    
    .journalit-dashboard-filter-row.compact,
    .journalit-dashboard-filter-row.medium-responsive {
      display: flex !important;
      flex-direction: column !important;
      width: 100% !important;
    }
    
    .journalit-dashboard-date-range-section,
    .journalit-dashboard-accounts-section,
    .journalit-dashboard-filter-actions,
    .journalit-dashboard-filter-section {
      width: 100% !important;
      margin: 8px 0 !important;
    }
    
    .journalit-dashboard-reset-button {
      margin: 5px 0 !important;
      width: 100% !important;
    }

    .journalit-dashboard-edit-mode-button {
      margin: 5px 0 !important;
    }
    
    .journalit-dashboard-account-filter {
      width: 100% !important;
    }
    
    /* Force full width on select dropdowns */
    .journalit-dashboard-account-dropdown,
    .journalit-dashboard-account-summary {
      width: 100% !important;
    }
    
    /* Ensure date range selector fits properly */
    .journalit-dashboard-date-range-section {
      margin-right: 0 !important;
      width: 100% !important;
      min-width: auto !important;
    }
    
    /* Handle date inputs on small screens */
    .journalit-dashboard-date-range-inputs,
    .journalit-dashboard-custom-date-dropdown {
      position: static !important;
      width: 100% !important;
      margin-top: 8px !important;
      flex-direction: column !important;
      box-shadow: none !important;
      left: auto !important;
      right: auto !important;
    }

    .journalit-dashboard-custom-date-dropdown.position-left,
    .journalit-dashboard-custom-date-dropdown.position-below {
      position: static !important;
      left: auto !important;
      right: auto !important;
    }
    
    /* Adjust metric cards for better small screen display */
    .journalit-dashboard-metrics {
      flex-wrap: wrap !important;
      justify-content: center !important;
    }
    
    .journalit-dashboard-metric-card {
      min-width: calc(50% - 8px) !important;
      max-width: none !important;
      flex: 0 0 calc(50% - 8px) !important;
      margin-bottom: 8px !important;
    }

    /* Compact button styling for small screens */
    .journalit-dashboard-filter-actions {
      gap: 4px !important;
      flex-wrap: nowrap !important;
    }

    .journalit-dashboard-filter-actions button {
      padding: 4px 6px !important;
      font-size: 11px !important;
    }

    .journalit-dashboard-edit-layout-button span {
      display: none !important; /* Hide "Edit Layout" text, show icon only */
    }
  }

  /* Mobile screens */
  @media (max-width: 480px) {
    /* Extremely compact layout for very small screens */
    .journalit-dashboard-view {
      padding: 8px !important;
    }
    
    /* Make sure the filter controls are completely vertical */
    .journalit-dashboard-filter-controls.compact-view {
      padding: 8px !important;
    }
    
    /* Full width metrics on mobile */
    .journalit-dashboard-metric-card {
      min-width: 100% !important;
      flex: 0 0 100% !important;
      margin-bottom: 8px !important;
    }
    
    /* Make buttons more touch-friendly */
    .journalit-dashboard-reset-button,
    .journalit-dashboard-edit-mode-button,
    .journalit-dashboard-add-component-button {
      padding: 10px !important;
      height: auto !important;
      min-height: 40px !important;
    }
    
    /* Ensure date presets fit on small screens */
    .journalit-dashboard-date-range-presets {
      flex-wrap: wrap !important;
      justify-content: center !important;
    }
    
    .journalit-dashboard-date-range-presets button {
      flex: 0 1 auto !important;
      margin: 2px !important;
      font-size: 11px !important;
      padding: 4px 8px !important;
    }
    
    /* Ensure the component selector fits on small screens */
    .journalit-dashboard-component-selector {
      width: 90vw !important;
      max-height: 80vh !important;
      margin-top: 50px !important;
    }

    /* Ultra-compact for very small screens */
    .journalit-dashboard-filter-actions {
      gap: 2px !important;
    }

    .journalit-dashboard-filter-actions button {
      padding: 4px !important;
    }
  }

  /* Extra small screens */
  @media (max-width: 360px) {
    /* Extreme space optimization */
    .journalit-dashboard-view {
      padding: 4px !important;
    }
    
    .journalit-dashboard-filter-controls {
      padding: 6px !important;
    }
    
    /* Minimize all padding and margins */
    .journalit-dashboard-top-section,
    .journalit-dashboard-bottom-section {
      padding: 2px !important;
    }
    
    /* Ensure date buttons are minimal but usable */
    .journalit-dashboard-date-range-presets button {
      padding: 3px 6px !important;
      font-size: 10px !important;
    }
  }

  /* Reduce date filter width on medium screens */
  @media screen and (max-width: 1160px) {
    .journalit-dashboard-primary-filters {
      max-width: 600px !important;
    }
  }

  /* Unified Component Selector */
  .unified-selector-overlay {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    background-color: rgba(0, 0, 0, 0.4) !important;
    backdrop-filter: blur(3px) !important;
    z-index: 1000 !important; /* Reduced from 100000 to prevent conflicts */
    display: flex !important;
    align-items: flex-start !important;
    justify-content: center !important;
    padding: 20px !important;
    pointer-events: none !important; /* Prevent blocking interactions */
  }
  
  .journalit-dashboard-component-selector {
    position: relative !important;
    margin-top: 100px !important;
    width: 480px !important;
    max-height: 75vh !important;
    overflow-y: auto !important;
    background-color: var(--background-primary) !important;
    border: 1px solid rgba(255, 255, 255, 0.08) !important;
    border-radius: 12px !important;
    overflow: hidden !important;
    z-index: 1001 !important; /* One higher than the overlay */
    pointer-events: auto !important; /* Ensure modal content is interactive */
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2), 0 16px 64px rgba(0, 0, 0, 0.1) !important;
    max-width: 90vw !important;
    animation: fadeInScale 0.25s cubic-bezier(0.19, 1, 0.22, 1) !important;
  }
  
  .journalit-dashboard-unified-selector-button-container {
    display: flex !important;
    justify-content: center !important;
    margin: 0 0 4px 0 !important; /* Reduced from 8px to 4px */
    padding: 4px !important; /* Reduced from 8px to 4px */
    background-color: transparent !important;
    border-radius: 8px !important;
    border: 1px dashed var(--background-modifier-border) !important;
  }
  
  .journalit-dashboard-add-component-button {
    background-color: var(--interactive-accent) !important;
    color: var(--text-on-accent, white) !important;
    border: none !important;
    border-radius: 6px !important;
    padding: 8px 16px !important;
    font-size: 14px !important;
    font-weight: 600 !important;
    cursor: pointer !important;
    display: flex !important;
    align-items: center !important;
    gap: 8px !important;
    transition: all 0.2s ease !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
  }
  
  .journalit-dashboard-add-component-button:hover {
    background-color: var(--interactive-accent-hover) !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
  }
  
  .journalit-dashboard-component-selector-header {
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    padding: 16px 20px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
    background-color: var(--background-secondary-alt) !important;
    border-radius: 12px 12px 0 0 !important;
  }
  
  .journalit-dashboard-component-selector-header h3 {
    font-size: 18px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    margin: 0 !important;
  }
  
  .journalit-dashboard-component-selector-close {
    width: 28px !important;
    height: 28px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    border-radius: 6px !important;
    background-color: var(--background-modifier-hover) !important;
    color: var(--text-muted) !important;
    transition: all 0.2s cubic-bezier(0.19, 1, 0.22, 1) !important;
    border: none !important;
    padding: 0 !important;
    cursor: pointer !important;
  }
  
  .journalit-dashboard-component-selector-close svg {
    width: 14px !important;
    height: 14px !important;
    display: block !important;
  }
  
  .journalit-dashboard-component-selector-close:hover {
    background-color: var(--background-modifier-error-hover) !important;
    color: white !important;
    transform: rotate(90deg) !important;
  }
  
  .journalit-dashboard-component-selector-search {
    padding: 12px 20px !important;
    position: relative !important;
  }
  
  .journalit-dashboard-component-selector-search input {
    width: 100% !important;
    padding: 10px 16px !important;
    border-radius: 8px !important;
    background-color: var(--background-modifier-form-field) !important;
    border: 1px solid var(--background-modifier-border) !important;
    font-size: 14px !important;
    transition: all 0.2s ease !important;
    color: var(--text-normal) !important;
  }
  
  .journalit-dashboard-component-selector-search input:focus {
    box-shadow: 0 0 0 2px var(--interactive-accent) !important;
    border-color: var(--interactive-accent) !important;
    outline: none !important;
  }
  
  .journalit-dashboard-component-selector-categories {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 8px !important;
    padding: 0 20px 12px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
    justify-content: center !important; /* Center tabs horizontally */
  }
  
  .journalit-dashboard-component-selector-category {
    border-radius: 20px !important;
    padding: 6px 14px !important;
    font-size: 13px !important;
    font-weight: 500 !important;
    background-color: var(--background-secondary) !important;
    color: var(--text-muted) !important;
    border: 1px solid transparent !important;
    transition: all 0.2s cubic-bezier(0.19, 1, 0.22, 1) !important;
    box-shadow: none !important;
    cursor: pointer !important;
  }
  
  .journalit-dashboard-component-selector-category:hover {
    background-color: var(--background-modifier-hover) !important;
    color: var(--text-normal) !important;
    transform: translateY(-1px) !important;
  }
  
  .journalit-dashboard-component-selector-category.active {
    background-color: var(--interactive-accent) !important;
    color: var(--text-on-accent, white) !important;
    font-weight: 600 !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 2px 8px rgba(var(--interactive-accent-rgb), 0.3) !important;
  }
  
  .journalit-dashboard-component-selector-list {
    padding: 16px 20px !important;
    max-height: 50vh !important;
    overflow-y: auto !important;
    scrollbar-width: thin !important;
  }
  
  .journalit-dashboard-component-selector-list h4 {
    font-size: 15px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    margin: 0 0 12px 0 !important;
    padding-bottom: 8px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
  }
  
  /* Enhanced component item cards */
  .journalit-dashboard-component-selector-item {
    background-color: var(--background-secondary) !important;
    border-radius: 10px !important;
    padding: 14px 16px !important;
    margin-bottom: 10px !important;
    cursor: pointer !important;
    position: relative !important;
    transition: all 0.25s cubic-bezier(0.19, 1, 0.22, 1) !important;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05) !important;
    border: 1px solid transparent !important;
  }
  
  .journalit-dashboard-component-selector-item:hover {
    transform: translateY(-2px) !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1) !important;
    background-color: var(--background-primary) !important;
    border-color: var(--interactive-accent) !important;
  }
  
  /* Component item content styling */
  .journalit-dashboard-component-selector-widget-name {
    font-size: 15px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    margin-bottom: 6px !important;
  }
  
  /* Visual divider to separate sections in the All tab */
  .journalit-dashboard-component-selector-divider {
    height: 1px !important;
    background-color: var(--background-modifier-border) !important;
    margin: 16px 0 20px !important;
    opacity: 0.7 !important;
  }
  
  .journalit-dashboard-component-selector-widget-description {
    font-size: 13px !important;
    color: var(--text-muted) !important;
    margin-bottom: 10px !important;
    line-height: 1.4 !important;
  }
  
  /* Enhanced category badge */
  .journalit-dashboard-component-selector-widget-category {
    display: inline-block !important;
    font-size: 11px !important;
    font-weight: 500 !important;
    color: var(--text-normal) !important;
    background-color: var(--background-secondary-alt) !important;
    padding: 3px 8px !important;
    border-radius: 12px !important;
    margin-top: 4px !important;
  }
  
  /* Enhanced status badge */
  .journalit-dashboard-component-selector-widget-badge {
    position: absolute !important;
    top: 12px !important;
    right: 12px !important;
    font-size: 11px !important;
    font-weight: 600 !important;
    color: white !important;
    background: linear-gradient(135deg, var(--text-success), #2e7d32) !important;
    padding: 3px 10px !important;
    border-radius: 12px !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
  }
  
  /* Empty list message */
  .journalit-dashboard-component-selector-empty {
    text-align: center !important;
    padding: 24px 0 !important;
    color: var(--text-muted) !important;
    font-style: italic !important;
    background-color: var(--background-secondary-alt) !important;
    border-radius: 8px !important;
    font-size: 14px !important;
  }
  
  /* Improved scrollbar for the component list */
  .journalit-dashboard-component-selector-list::-webkit-scrollbar {
    width: 8px !important;
  }
  
  .journalit-dashboard-component-selector-list::-webkit-scrollbar-track {
    background: transparent !important;
  }
  
  .journalit-dashboard-component-selector-list::-webkit-scrollbar-thumb {
    background-color: var(--background-modifier-border) !important;
    border-radius: 4px !important;
    border: 2px solid var(--background-primary) !important;
  }
  
  .journalit-dashboard-component-selector-list::-webkit-scrollbar-thumb:hover {
    background-color: var(--interactive-accent) !important;
  }
  
  /* Animation for the selector */
  @keyframes fadeInScale {
    from {
      opacity: 0;
      transform: scale(0.92);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }
  
  /* Animation for today's calendar cell */
  @keyframes pulseBorder {
    0% {
      box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2), 0 4px 12px rgba(var(--interactive-accent-rgb), 0.25);
    }
    50% {
      box-shadow: 0 0 0 4px rgba(var(--interactive-accent-rgb), 0.15), 0 4px 16px rgba(var(--interactive-accent-rgb), 0.3);
    }
    100% {
      box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2), 0 4px 12px rgba(var(--interactive-accent-rgb), 0.25);
    }
  }
  
  /* BaseWidget container styling */
  .journalit-dashboard-widget-container {
    background-color: transparent !important;
  }
  
  /* EmptyState integration with dashboard widgets */
  .journalit-dashboard-widget-container .journalit-empty-state {
    background-color: transparent !important;
    min-height: 140px !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    justify-content: center !important;
    width: 100% !important;
    height: 100% !important;
    margin: 0 auto !important;
    position: absolute !important; /* Position in the center of container */
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
  }
  
  .journalit-dashboard-widget-container .journalit-empty-state-icon {
    margin-bottom: 12px !important;
    color: var(--text-muted) !important;
    display: flex !important;
    justify-content: center !important;
    width: 100% !important;
  }
  
  .journalit-dashboard-widget-container .journalit-empty-state-message {
    font-size: 14px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    text-align: center !important;
    width: 100% !important;
  }
  
  .journalit-dashboard-widget-container .journalit-empty-state-submessage {
    font-size: 12px !important;
    color: var(--text-muted) !important;
    text-align: center !important;
    width: 100% !important;
  }
  
  /* Empty state in main dashboard view */
  .journalit-dashboard-view .journalit-empty-state {
    margin: 0 auto !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    justify-content: center !important;
    min-height: 200px !important;
    width: 100% !important;
  }
  
  /* Table cell EmptyState styling */
  .journalit-dashboard-recent-trades-table td .journalit-empty-state {
    padding: 16px !important;
    min-height: 100px !important;
    background-color: transparent !important;
  }
`});function aMe(){let e=document.head.querySelector("#drc-note-styles");if(e){if(e.textContent&&e.textContent.trim().length>0)return;e.remove()}if(!window.__isInjectingStyles){window.__isInjectingStyles=!0;try{SB();let t=document.createElement("style");t.id="drc-note-styles",t.textContent=iMe,document.head.appendChild(t)}catch(t){console.error("Error injecting DRCNote styles:",t)}finally{window.__isInjectingStyles=!1}}}function ZZ(){try{let e=document.head.querySelector("#drc-note-styles");if(e&&e.textContent&&e.textContent.trim().length>0)return;aMe();let t="drc-critical-component-styles";if(!document.getElementById(t)){let r=document.createElement("style");r.id=t,r.innerHTML=`
        /* Critical styles for DRC component visibility */
        .journalit-drc-view {
          display: block !important;
          width: 100% !important;
          margin: 0 !important;
          padding: 0 !important;
          visibility: visible !important;
          opacity: 1 !important;
        }
        
        .journalit-drc-note-wrapper {
          display: block !important;
          width: 100% !important;
          margin: 0 !important;
          padding: 0 !important;
          visibility: visible !important;
          opacity: 1 !important;
        }
        
        .drc-container {
          display: block !important;
          width: 100% !important;
          box-sizing: border-box !important;
          visibility: visible !important;
          opacity: 1 !important;
        }
      `,document.head.appendChild(r)}}catch(e){console.error("Error ensuring DRCNote styles:",e);try{let t="drc-emergency-styles";if(!document.getElementById(t)){let r=document.createElement("style");r.id=t,r.innerHTML=`
          .journalit-drc-view, .journalit-drc-note-wrapper, .drc-container {
            display: block !important;
            width: 100% !important;
            visibility: visible !important;
            opacity: 1 !important;
          }
        `,document.head.appendChild(r)}}catch(t){console.error("Complete failure in DRCNote style system:",t)}}}var iMe,eee=F(()=>{TB();iMe=`
  /* DRC note view container - match Weekly Review pattern */
  .journalit-drc-view,
  .markdown-preview-view .journalit-drc-view {
    margin: 0 !important; /* Remove all margins */
    border-bottom: none !important; /* Remove bottom border causing extra space */
    padding: 0 !important; /* Remove all padding */
    display: block !important;
    width: 100% !important;
    z-index: 100 !important;
    /* Force visibility */
    visibility: visible !important;
    opacity: 1 !important;
    background-color: var(--background-primary) !important;
    /* Removed borders */
    border: none !important;
    border-radius: 8px !important;
    /* Ensure proper containment */
    position: relative;
    box-sizing: border-box;
    /* Prevent overlaps */
    contain: content;
    /* Ensure proper isolation from other views */
    isolation: isolate;
  }
  
  /* Add a fallback CSS pattern to highlight DRC notes */
  .markdown-preview-view > div:first-child:has(+ div:contains("type: drc")) {
    position: relative;
  }
  .markdown-preview-view > div:first-child:has(+ div:contains("type: drc"))::before {
    content: '';
    display: block;
    height: 5px;
    width: 100%;
    background-color: var(--color-secondary, var(--text-accent, var(--interactive-accent)));
    margin-bottom: 1rem;
    border-radius: 2px;
  }
  
  /* Main container - transparent to match Weekly Review */
  .drc-note-container {
    background-color: transparent; /* Remove background to match Weekly Review */
    border-radius: 0; /* Remove border radius to match Weekly Review */
    box-shadow: none; /* Remove shadow to match Weekly Review */
    margin: 0; /* Remove margin to match Weekly Review */
    overflow: hidden;
    position: relative;
    font-family: var(--font-interface, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif);
    /* Remove border to match Weekly Review */
    border: none;
    /* Ensure isolation */
    isolation: isolate;
    /* Create a new stacking context and force containment */
    contain: layout style paint;
    /* Ensure direct containment within parent */
    width: 100%;
    align-self: flex-start;
  }
  
  /* Header section with date and summary */
  .drc-note-header {
    padding: 1rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    background: linear-gradient(to right, var(--background-secondary), var(--background-primary));
    border-bottom: 1px solid var(--background-modifier-border);
  }
  
  .drc-note-date {
    font-size: 1.4rem;
    font-weight: 600;
    color: var(--text-normal);
  }
  
  .drc-note-summary {
    font-size: 1rem;
    color: var(--text-muted);
  }
  
  /* Tabs navigation */
  .drc-note-tabs {
    display: flex;
    padding: 0 1rem;
    border-bottom: 1px solid var(--background-modifier-border);
    background-color: var(--background-secondary);
  }
  
  .drc-note-tab-button {
    padding: 0.8rem 1.2rem;
    border: none;
    background: transparent;
    color: var(--text-muted);
    font-size: 0.9rem;
    font-weight: 600;
    cursor: pointer;
    position: relative;
    transition: color 0.2s;
  }
  
  .drc-note-tab-button:hover {
    color: var(--text-normal);
  }
  
  .drc-note-tab-button.active {
    color: var(--color-primary, var(--interactive-accent));
  }
  
  .drc-note-tab-button.active::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 2px;
    background-color: var(--color-primary, var(--interactive-accent));
    border-radius: 2px 2px 0 0;
  }
  
  /* Tab content container */
  .drc-note-content {
    padding: 1.5rem;
  }
  
  /* Section styling */
  .drc-note-section {
    margin-bottom: 2rem;
    background-color: var(--background-secondary);
    border-radius: var(--border-radius-md, 4px);
    padding: 1.2rem;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
  }
  
  .drc-note-section-title {
    font-size: 1.1rem;
    font-weight: 600;
    margin-top: 0;
    margin-bottom: 1rem;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--background-modifier-border);
    color: var(--text-normal);
    text-align: center;
  }
  
  .drc-note-empty-state {
    color: var(--text-muted);
    font-style: italic;
    text-align: center;
    padding: 1rem;
  }
  
  /* Checklist styling */
  .drc-note-checklist {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }
  
  .drc-note-checklist-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  
  .drc-note-checkbox {
    width: 18px;
    height: 18px;
    border: 2px solid var(--background-modifier-border);
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--color-success, #43a047);
    font-weight: bold;
    background-color: var(--background-primary);
  }
  
  .drc-note-checkbox.checked {
    background-color: var(--color-success-muted, rgba(67, 160, 71, 0.2));
    border-color: var(--color-success, #43a047);
  }
  
  /* Forecast styling */
  .drc-note-forecast {
    display: flex;
    flex-direction: column;
    gap: 0.8rem;
  }
  
  .drc-note-forecast-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  
  .drc-note-forecast-label {
    font-weight: 600;
    min-width: 80px;
    color: var(--text-muted);
  }
  
  .drc-note-forecast-value {
    color: var(--text-normal);
  }
  
  .drc-note-forecast-notes {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }
  
  .drc-note-forecast-notes p {
    margin: 0.5rem 0 0 0;
    padding-left: 80px;
    color: var(--text-normal);
  }
  
  /* Goals styling */
  .drc-note-goals ul {
    margin: 0;
    padding-left: 1.5rem;
  }
  
  .drc-note-goals li {
    margin-bottom: 0.5rem;
    color: var(--text-normal);
  }
  
  /* Trades styling */
  .drc-note-trades {
    width: 100%;
    border-radius: var(--border-radius-sm, 2px);
    overflow: hidden;
  }
  
  .drc-note-trades-header {
    display: grid;
    grid-template-columns: 2fr 1fr 1fr 2fr 1fr;
    background-color: var(--background-modifier-hover);
    font-weight: 600;
    color: var(--text-normal);
    font-size: 0.9rem;
  }
  
  .drc-note-trade-row {
    display: grid;
    transition: background-color 0.2s;
  }
  
  .drc-note-trade-row:hover {
    background-color: var(--background-primary-alt, var(--background-primary));
  }
  
  .drc-note-trade-cell {
    padding: 0.8rem;
    align-items: center;
  }
  
  .drc-note-trade-cell.profit {
    color: var(--color-success, #43a047);
  }
  
  .drc-note-trade-cell.loss {
    color: var(--color-error, #e53935);
  }
  
  .drc-note-trade-rating {
    padding: 0.3rem 0.5rem;
    font-weight: 600;
  }
  
  .drc-note-trade-rating.rating-a {
    background-color: rgba(102, 187, 106, 0.2);
    color: var(--color-success, #43a047);
  }
  
  .drc-note-trade-rating.rating-b {
    background-color: rgba(33, 150, 243, 0.2);
    color: var(--color-primary, #2196f3);
  }
  
  .drc-note-trade-rating.rating-c {
    background-color: rgba(247, 199, 90, 0.2);
    color: var(--text-warning);
  }
  
  .drc-note-trade-rating.rating-d, 
  .drc-note-trade-rating.rating-f {
    background-color: rgba(229, 57, 53, 0.2);
    color: var(--color-error, #e53935);
  }
  
  .drc-note-trade-rating.rating-none {
    background-color: var(--background-secondary-alt, var(--background-secondary));
    color: var(--text-muted);
  }
  
  /* Missed trades styling */
  .drc-note-missed-trades {
    display: flex;
    gap: 1rem;
  }
  
  .drc-note-missed-trade {
    padding: 0.8rem;
    background-color: var(--background-primary);
  }
  
  .drc-note-missed-trade-header {
    display: flex;
    border-bottom: 1px dashed var(--background-modifier-border);
  }
  
  .drc-note-missed-trade-instrument {
    font-weight: 600;
    color: var(--text-normal);
  }
  
  .drc-note-missed-trade-direction {
    color: var(--text-muted);
  }
  
  .drc-note-missed-trade-reason,
  .drc-note-missed-trade-notes {
    font-size: 0.9rem;
    margin-bottom: 0.3rem;
  }
  
  /* Review styling */
  .drc-note-grades {
    display: flex;
    margin-bottom: 1rem;
  }
  
  .drc-note-grade {
    display: flex;
    width: 120px;
  }
  
  .drc-note-grade-label {
    font-size: 0.8rem;
    margin-bottom: 0.5rem;
  }
  
  .drc-note-grade-value {
    font-size: 2rem;
    border-radius: 50%;
  }
  
  .drc-note-grade-value.grade-a {
    background-color: rgba(102, 187, 106, 0.2);
    color: var(--color-success, #43a047);
  }
  
  .drc-note-grade-value.grade-b {
    background-color: rgba(33, 150, 243, 0.2);
    color: var(--color-primary, #2196f3);
  }
  
  .drc-note-grade-value.grade-c {
    background-color: rgba(247, 199, 90, 0.2);
    color: var(--text-warning);
  }
  
  .drc-note-grade-value.grade-d,
  .drc-note-grade-value.grade-f {
    background-color: rgba(229, 57, 53, 0.2);
    color: var(--color-error, #e53935);
  }
  
  /* Review questions styling */
  .drc-note-review-questions {
    display: flex;
    flex-direction: column;
    gap: 1.2rem;
  }
  
  .drc-note-review-item {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }
  
  .drc-note-review-question {
    font-weight: 600;
    color: var(--text-normal);
  }
  
  .drc-note-review-answer {
    color: var(--text-normal);
    padding: 0.5rem 0 0.5rem 1rem;
  }
  
  .drc-note-review-answer em {
    color: var(--text-muted);
  }
  
  /* Responsive adjustments */
  @media (max-width: 768px) {
    .drc-note-trades-header,
    .drc-note-trade-row {
      grid-template-columns: 1fr 1fr 1fr;
    }
    
    .drc-note-trades-header > div:nth-child(4),
    .drc-note-trades-header > div:nth-child(5),
    .drc-note-trade-row > div:nth-child(4),
    .drc-note-trade-row > div:nth-child(5) {
      display: none;
    }
    
    .drc-note-missed-trades {
      flex-direction: column;
    }
  }
  
  /* Multiple view compatibility */
  .workspace-split.mod-vertical .journalit-drc-view {
    /* Adjust for vertical split layout */
    flex-shrink: 1;
  }
  
  /* Ensure the component doesn't get squished in narrow panes */
  .workspace-leaf-content .journalit-drc-view .drc-note-tabs {
    flex-wrap: wrap;
  }
  
  /* Prevent clipping of component in small panes */
  .workspace-leaf-content .journalit-drc-view .drc-note-container {
    min-width: 0;
  }
  
  /* Wrapper for the DRC note component */
  .journalit-drc-note-wrapper {
    margin: 0 !important;
    padding: 0 !important;
    border: none !important;
    z-index: 100 !important;
    display: block !important;
    width: 100% !important;
    height: auto !important;
    min-height: 50px !important;
  }
  
  /* Special class for properly mounted DRC components to aid detection */
  .drc-note-mounted {
    display: block !important;
    opacity: 1 !important;
    visibility: visible !important;
  }
`});var oMe,DB,tee=F(()=>{oMe=`
/* DRC Missed Trades Section Styles */
.drc-missed-trades-section {
  margin-bottom: 24px;
}

.drc-missed-trades-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
  gap: 12px;
  flex-wrap: wrap;
}

.drc-missed-trades-header h3 {
  margin: 0;
  color: var(--text-normal);
  font-size: 18px;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 8px;
}

.drc-missed-trades-count {
  color: var(--text-muted);
  font-weight: 400;
  font-size: 16px;
}

.drc-add-missed-trade-btn {
  padding: 8px 16px !important;
  font-size: 14px !important;
  white-space: nowrap;
  flex-shrink: 0;
}

.drc-missed-trades-content {
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  background-color: var(--background-primary);
  overflow: hidden;
}

.drc-missed-trades-list {
  max-height: 400px;
  overflow-y: auto;
}

.drc-missed-trade-item {
  padding: 16px;
  border-bottom: 1px solid var(--background-modifier-border-subtle);
  transition: background-color 0.2s ease;
}

.drc-missed-trade-item:last-child {
  border-bottom: none;
}

.drc-missed-trade-item:hover {
  background-color: var(--background-modifier-hover);
}

.drc-missed-trade-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
  gap: 12px;
}

.drc-missed-trade-main {
  display: flex;
  align-items: center;
  gap: 8px;
  flex: 1;
  min-width: 0;
}

.drc-missed-trade-icon {
  font-size: 18px;
  flex-shrink: 0;
}

.drc-missed-trade-instrument {
  font-weight: 600;
  color: var(--text-normal);
  font-size: 16px;
  flex-shrink: 0;
}

.drc-missed-trade-direction {
  color: var(--text-muted);
  font-size: 14px;
  text-transform: capitalize;
  flex-shrink: 0;
}

.drc-missed-trade-badge {
  background-color: var(--color-orange, #ff9500);
  color: white;
  padding: 2px 8px;
  border-radius: 12px;
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  flex-shrink: 0;
}

.drc-missed-trade-open-btn {
  background-color: var(--interactive-accent);
  color: white;
  border: none;
  padding: 6px 12px;
  border-radius: 4px;
  font-size: 13px;
  cursor: pointer;
  transition: all 0.2s ease;
  flex-shrink: 0;
}

.drc-missed-trade-open-btn:hover {
  background-color: var(--interactive-accent-hover);
  transform: translateX(2px);
}

.drc-missed-trade-details {
  display: flex;
  flex-direction: column;
  gap: 8px;
  color: var(--text-normal);
  font-size: 14px;
  line-height: 1.4;
}

.drc-missed-trade-setup,
.drc-missed-trade-reason {
  display: flex;
  gap: 8px;
  align-items: flex-start;
}

.drc-missed-trade-setup strong,
.drc-missed-trade-reason strong {
  color: var(--text-muted);
  font-weight: 500;
  flex-shrink: 0;
  min-width: 45px;
}

.drc-missed-trade-reason {
  font-style: italic;
  color: var(--text-muted);
}

/* Loading and Error States */
.drc-missed-trades-loading,
.drc-missed-trades-error {
  padding: 24px;
  text-align: center;
  color: var(--text-muted);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  background-color: var(--background-primary);
}

.drc-missed-trades-error {
  color: var(--text-error, #e53935);
}

.drc-retry-button {
  margin-top: 12px;
  padding: 8px 16px;
  background-color: var(--interactive-accent);
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
  transition: background-color 0.2s ease;
}

.drc-retry-button:hover {
  background-color: var(--interactive-accent-hover);
}

/* Empty State Styling Override for Missed Trades */
.drc-missed-trades-content .empty-state {
  padding: 32px 24px;
  background-color: transparent;
  border: none;
}

.drc-missed-trades-content .empty-state .empty-state-icon {
  color: var(--text-muted);
  opacity: 0.6;
}

.drc-missed-trades-content .empty-state .empty-state-message {
  color: var(--text-normal);
  font-size: 16px;
  font-weight: 500;
}

.drc-missed-trades-content .empty-state .empty-state-submessage {
  color: var(--text-muted);
  font-size: 14px;
  margin-top: 8px;
  line-height: 1.4;
}

/* Responsive Design */
@media (max-width: 600px) {
  .drc-missed-trades-header {
    flex-direction: column;
    align-items: stretch;
    gap: 12px;
  }
  
  .drc-missed-trade-header {
    flex-direction: column;
    align-items: stretch;
    gap: 8px;
  }
  
  .drc-missed-trade-main {
    flex-wrap: wrap;
    gap: 6px;
  }
  
  .drc-missed-trade-open-btn {
    align-self: flex-end;
    width: auto;
  }
  
  .drc-missed-trade-details {
    margin-top: 8px;
  }
}

/* Dark Theme Adjustments */
.theme-dark .drc-missed-trade-badge {
  background-color: var(--color-orange, #ff9500);
  color: var(--text-on-accent);
}

.theme-dark .drc-missed-trade-item:hover {
  background-color: var(--background-modifier-hover);
}

/* Integration with existing DRC styles */
.drc-section .drc-missed-trades-section {
  margin-bottom: 0; /* Remove extra margin when used inside drc-section */
}

.drc-section .drc-missed-trades-header h3 {
  margin-bottom: 0; /* Consistent with other DRC section headers */
}
`,DB=()=>{let e="drc-missed-trades-styles";if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=oMe,document.head.appendChild(t)}});var MB={};Ti(MB,{ensureChartStyles:()=>IB,injectChartStyles:()=>NI,removeChartStyles:()=>EB});function NI(){try{if(document.head.querySelector("#journalit-chart-styles"))return;let t=document.createElement("style");t.id="journalit-chart-styles",t.textContent=sMe,document.head.appendChild(t)}catch(e){console.error("Error injecting chart styles:",e)}}function EB(){try{let e=document.head.querySelector("#journalit-chart-styles");e&&e.remove()}catch(e){console.error("Error removing chart styles:",e)}}function IB(){NI()}var sMe,QT=F(()=>{sMe=`
/**
 * CSS Variables for chart colors & theming
 * These allow for consistent colors across all charts
 */
:root {
  /* Base chart colors with !important to ensure they're applied */
  --chart-positive: var(--text-success, #43a047) !important;
  --chart-negative: var(--text-error, #e53935) !important;
  --chart-neutral: var(--text-muted, #888888) !important;

  /* Chart background colors */
  --chart-positive-bg: rgba(67, 160, 71, 0.2) !important;
  --chart-negative-bg: rgba(229, 57, 53, 0.2) !important;

  /* Animation timings */
  --chart-animation-duration: 0.8s;
  --chart-animation-function: cubic-bezier(0.19, 1, 0.22, 1);
}

/**
 * Chart container styles
 */
.journalit-chart-container {
  width: 100%;
  height: 100%;
  overflow: hidden;
  border-radius: 8px;
  background-color: transparent;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
  padding: 4px;
}

/**
 * Enhanced tooltip styles
 */
.journalit-chart-tooltip {
  background-color: var(--background-primary);
  border-radius: 10px;
  padding: 14px 18px;
  min-width: 140px;
  border: 1px solid var(--background-modifier-border);
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
  transform: translateY(-4px);
  position: relative;
  animation: tooltipFadeIn 0.2s var(--chart-animation-function);
  z-index: 1000;
}

/* Tooltip date */
.journalit-chart-tooltip-date {
  font-size: 14px;
  font-weight: 500;
  color: var(--text-normal);
  margin-bottom: 8px;
  text-align: center;
  border-bottom: 1px solid var(--background-modifier-border);
  padding-bottom: 6px;
}

/* Main tooltip value */
.journalit-chart-tooltip-value {
  font-size: 20px;
  font-weight: 600;
  text-align: center;
}

.journalit-chart-tooltip-value.positive {
  color: var(--chart-positive);
}

.journalit-chart-tooltip-value.negative {
  color: var(--chart-negative);
}

/* Additional tooltip info */
.journalit-chart-tooltip-info {
  font-size: 12px;
  color: var(--text-muted);
  margin-top: 8px;
  text-align: center;
  font-style: italic;
}

/* Tooltip animation */
@keyframes tooltipFadeIn {
  from {
    opacity: 0;
    transform: translateY(-8px);
  }
  to {
    opacity: 1;
    transform: translateY(-4px);
  }
}

/**
 * Chart SVG elements styling
 */
.recharts-cartesian-grid-horizontal line,
.recharts-cartesian-grid-vertical line {
  stroke: var(--background-modifier-border);
  stroke-opacity: 0.4;
  stroke-dasharray: 3;
}

.recharts-reference-line line {
  stroke: var(--text-normal);
  stroke-opacity: 0.4;
  stroke-dasharray: 3;
  stroke-width: 1.5;
}

/* Ensure profit target line is always green */
.recharts-reference-line.profit-target-line line {
  stroke: var(--chart-positive, var(--text-success, #00b300)) !important;
  stroke-opacity: 1 !important;
  stroke-dasharray: 5 5 !important;
  stroke-width: 2 !important;
}

/* Ensure profit target line label is also green */
.recharts-reference-line.profit-target-line text {
  fill: var(--chart-positive, var(--text-success, #00b300)) !important;
}

/* Axis styling */
.recharts-xAxis .recharts-cartesian-axis-line,
.recharts-yAxis .recharts-cartesian-axis-line {
  stroke: var(--background-modifier-border);
  stroke-opacity: 0.5;
}

.recharts-cartesian-axis-tick-value {
  font-size: 11px;
  font-weight: 500;
  fill: var(--text-muted);
}

/* Active dot styling */
.recharts-active-dot circle,
.recharts-active-dot {
  fill: var(--interactive-accent, #4299e1);
  filter: drop-shadow(0 0 3px rgba(66, 153, 225, 0.6));
}

/* Ensure tooltip position is fixed */
.recharts-tooltip-wrapper {
  pointer-events: none;
  z-index: 1000;
  filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.25));
}

/**
 * Bar chart specific styling
 */
.recharts-bar {
  cursor: pointer;
  transition: opacity 0.3s ease;
}

.recharts-bar-rectangle {
  transition: filter 0.3s ease, transform 0.2s ease;
}

.recharts-bar-rectangle:hover {
  filter: brightness(1.1) drop-shadow(0 0 3px rgba(0, 0, 0, 0.2));
  transform: translateY(-2px);
}

/* Apply rounded corners to bar chart bars */
.recharts-bar-rectangle path {
  border-radius: 2px 2px 0 0;
}

/* Ensure bar chart colors are applied correctly */
.recharts-bar-rectangle[fill^="var(--chart-positive)"] path {
  fill: var(--chart-positive) !important;
}

.recharts-bar-rectangle[fill^="var(--chart-negative)"] path {
  fill: var(--chart-negative) !important;
}

/* Active bar styling */
.recharts-bar-rectangle.recharts-active {
  filter: brightness(1.2) drop-shadow(0 0 6px rgba(0, 0, 0, 0.3));
}

/* Enhanced cursor area for better touch experience */
.recharts-layer.recharts-bar-graphical {
  cursor: pointer;
}

/* Animations for bar charts */
@keyframes barFadeIn {
  from {
    opacity: 0;
    transform: scaleY(0.8);
  }
  to {
    opacity: 1;
    transform: scaleY(1);
  }
}

.recharts-bar-rectangle {
  /* Animation removed to prevent conflict with Recharts' built-in animations */
}

/**
 * Calendar specific animations and styles
 */
@keyframes calendarFadeIn {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes pulseBorder {
  0% {
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2), 0 4px 12px rgba(var(--interactive-accent-rgb), 0.25);
  }
  50% {
    box-shadow: 0 0 0 3px rgba(var(--interactive-accent-rgb), 0.3), 0 4px 15px rgba(var(--interactive-accent-rgb), 0.35);
  }
  100% {
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2), 0 4px 12px rgba(var(--interactive-accent-rgb), 0.25);
  }
}

/* Enhanced today indicator with pulse effect */
.journalit-dashboard-calendar-day.today {
  animation: pulseBorder 2s infinite ease-in-out;
  border: 2px solid var(--interactive-accent) !important;
  z-index: 2 !important;
}

/* Calendar cell hover effect */
.journalit-dashboard-calendar-day:hover,
.journalit-dashboard-calendar-weekly-pnl:hover {
  transform: scale(1.05) !important;
  transition: transform 0.2s ease-out, box-shadow 0.2s ease-out, opacity 0.2s ease-out !important;
  opacity: 1 !important;
  z-index: 5 !important;
}
`});var ree={};Ti(ree,{ensureSharedComponentStyles:()=>dy,injectSharedComponentStyles:()=>FI,removeSharedComponentStyles:()=>AB});function FI(){if(document.head.querySelector("#shared-component-styles"))return;let e=document.createElement("style");e.id="shared-component-styles",e.textContent=lMe,document.head.appendChild(e)}function AB(){let e=document.head.querySelector("#shared-component-styles");e&&e.remove()}function dy(){document.head.querySelector("#shared-component-styles")||FI()}var lMe,XT=F(()=>{lMe=`
  /**
  * Container Styles for Reviews
  * Remove unused space - but preserve content area padding
  */
  .review-base-container {
    padding: 0 !important;
    margin: 0 !important;
  }

  /**
  * Navigation Styles
  * Used for navigating between reviews
  */
  .drc-navigation, .weekly-review-navigation, .daily-report-card-navigation {
    width: 100%;
    padding-top: 10px;
    border-top: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1));
  }
  
  .drc-navigation-links, .weekly-review-navigation-links, .daily-report-card-navigation-links {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 8px;
    flex-wrap: wrap;
    width: 100%;
  }
  
  .drc-navigation-button, .weekly-review-navigation-button, .daily-report-card-navigation-button {
    padding: 8px 14px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    cursor: pointer;
    font-size: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    flex: 1;
    text-align: center;
    min-width: 120px;
    box-sizing: border-box;
  }
  
  .drc-navigation-button:hover, .weekly-review-navigation-button:hover, .daily-report-card-navigation-button:hover {
    background-color: var(--background-modifier-hover);
  }
  
  .drc-navigation-button:disabled, .weekly-review-navigation-button:disabled, .daily-report-card-navigation-button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
  
  .nav-icon {
    font-size: 14px;
    line-height: 1;
  }

  /**
  * Goal Tracker Styles
  * Used for goal tracking in DRC and Weekly Review
  */
  .shared-goal-tracker h3 {
    font-size: 1rem !important;
    margin-top: 1rem !important;
    margin-bottom: 0.75rem !important;
    text-align: center !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    padding-bottom: 0.5rem !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
  }

  /* Special styling for Weekly Review's "Previous Week Goals" header */
  .weekly-review-previous-goals h3,
  .weekly-review-preparation .weekly-review-section h3 {
    font-size: 1rem !important;
    margin-top: 1rem !important;
    margin-bottom: 0.75rem !important;
    text-align: center !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    padding-bottom: 0.5rem !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
  }

  .shared-goal-tracker-list {
    display: flex !important;
    flex-direction: column !important;
    gap: 0.5rem !important;
    margin-top: 0.75rem !important;
    padding: 0.5rem !important;
    background-color: var(--background-secondary) !important;
    border-radius: 4px !important;
  }

  .shared-goal-item {
    display: flex !important;
    align-items: center !important;
    gap: 0.5rem !important;
    padding: 0.5rem !important;
    background-color: var(--background-primary) !important;
    border-radius: 4px !important;
    border: 1px solid var(--background-modifier-border) !important;
    cursor: pointer !important;
  }

  .shared-goal-item:hover {
    background-color: var(--background-modifier-hover) !important;
  }

  .shared-goal-checkbox {
    margin: 0 !important;
  }

  .shared-goal-text {
    flex: 1 !important;
    font-size: 0.95rem !important;
  }

  .shared-goal-text.completed {
    text-decoration: line-through !important;
    opacity: 0.7 !important;
    color: var(--text-muted) !important;
  }
  
  /**
  * Empty State Component Styles
  * Used for displaying a friendly message when no data is available
  */
.journalit-empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 24px;
  text-align: center;
  background-color: var(--background-secondary);
  border-radius: 8px;
  min-height: 160px;
  width: 100%;
  height: 100%; /* Added to ensure full height usage */
  color: var(--text-muted);
  animation: fadeIn 0.3s ease-out;
  margin: 0 auto; /* Added to ensure horizontal centering */
}

.journalit-empty-state-icon {
  margin-bottom: 16px;
  opacity: 0.6;
  color: var(--text-muted);
  display: flex; /* Added to ensure icon is centered */
  justify-content: center; /* Added to ensure icon is centered */
}

.journalit-empty-state-content {
  max-width: 280px;
  display: flex; /* Added for better content alignment */
  flex-direction: column; /* Stack content vertically */
  align-items: center; /* Center content horizontally */
  justify-content: center; /* Center content vertically */
}

  .journalit-empty-state-message {
    font-size: 16px;
    font-weight: 500;
    margin: 0 0 8px 0;
    color: var(--text-normal);
  }

  .journalit-empty-state-submessage {
    font-size: 13px;
    opacity: 0.8;
    margin: 0 0 16px 0;
    color: var(--text-muted);
  }
  
  .journalit-empty-state-action-button {
    background-color: var(--interactive-accent) !important;
    color: var(--text-on-accent) !important;
    border: none !important;
    border-radius: 6px !important;
    padding: 0 16px !important;
    font-size: 14px !important;
    font-weight: 600 !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
    margin-top: 16px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    min-width: 120px !important;
    height: 36px !important;
    line-height: 1 !important;
  }
  
  .journalit-empty-state-action-button:hover {
    background-color: var(--interactive-accent-hover) !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
  }

  /* Animation for empty state */
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* Chart-specific empty state styling */
  .journalit-chart-container .journalit-empty-state {
    background-color: transparent;
    border: 1px dashed var(--background-modifier-border);
  }

  /* Table-specific empty state styling */
  .journalit-table-container .journalit-empty-state {
    min-height: 120px;
    padding: 16px;
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
    .journalit-empty-state {
      padding: 16px;
      min-height: 140px;
    }
    
    .journalit-empty-state-icon {
      margin-bottom: 12px;
    }
    
    .journalit-empty-state-message {
      font-size: 14px;
    }
  }

  /**
   * Review Button Styles
   * Shared component for marking content as reviewed
   */
  .review-button-container {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-top: 16px;
  }

  .review-button {
    min-width: 140px;
  }

  .review-timestamp {
    font-size: 0.85em;
    color: var(--text-muted);
    font-style: italic;
  }

  /* Review sections for different review types */
  .drc-eod-review-button-section,
  .weekly-review-mark-reviewed-section,
  .monthly-review-mark-reviewed-section,
  .trade-note-review-section {
    margin-top: 24px;
    padding-top: 20px;
    border-top: 1px solid var(--background-modifier-border);
    display: flex;
    justify-content: center;
    align-items: center;
  }

  /* Ensure consistent styling for the review button in all contexts */
  .drc-eod-review-button-section .review-button-container,
  .weekly-review-mark-reviewed-section .review-button-container,
  .monthly-review-mark-reviewed-section .review-button-container,
  .trade-note-review-section .review-button-container {
    margin-top: 0;
  }

  /**
   * Loading Spinner Styles
   * Shared loading component with animated spinner
   */
  .journalit-loading-spinner {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    padding: 16px;
  }
  
  /* Ensure our spinner is not affected by other spinner styles */
  .journalit-loading-spinner .journalit-spinner-icon::before,
  .journalit-loading-spinner .journalit-spinner-icon::after {
    display: none !important;
  }

  .journalit-loading-spinner.small {
    padding: 8px;
    gap: 8px;
  }

  .journalit-loading-spinner.large {
    padding: 24px;
    gap: 16px;
  }

  .journalit-loading-spinner .journalit-spinner-icon {
    border: 2px solid var(--background-modifier-border);
    border-top-color: var(--interactive-accent);
    border-radius: 50%;
    animation: journalit-spin 0.6s linear infinite;
    flex-shrink: 0;
    /* Ensure perfect circle */
    min-width: var(--spinner-size, 24px);
    min-height: var(--spinner-size, 24px);
    max-width: var(--spinner-size, 24px);
    max-height: var(--spinner-size, 24px);
  }

  .journalit-loading-spinner .loading-message {
    color: var(--text-muted);
    font-size: 14px;
  }

  .journalit-loading-spinner.small .loading-message {
    font-size: 12px;
  }

  .journalit-loading-spinner.large .loading-message {
    font-size: 16px;
  }

  /* Fullscreen loading state */
  .journalit-loading-fullscreen {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
    min-height: 200px;
  }

  /* Overlay loading state */
  .journalit-loading-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.02);
    display: flex;
    align-items: center;
    justify-content: center;
    pointer-events: none;
    z-index: 10;
  }

  .journalit-loading-overlay-content {
    padding: 8px 16px;
    background-color: var(--background-primary);
    border-radius: 6px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  /* Spinner animation */
  @keyframes journalit-spin {
    to { transform: rotate(360deg); }
  }
`});function LB(){if(document.getElementById("journalit-combobox-styles"))return;let e=document.createElement("style");e.id="journalit-combobox-styles",e.textContent=cMe,document.head.appendChild(e)}function nee(){let e=document.getElementById("journalit-combobox-styles");e&&e.remove()}function OI(){document.getElementById("journalit-combobox-styles")||LB()}var cMe,NB=F(()=>{cMe=`
/**
 * ComboBox component styles for better performance
 * Replaces inline styles with CSS classes
 */

/* Base ComboBox container */
.combobox-container {
  position: relative;
  width: 100%;
  margin-bottom: 8px;
  /* Use initial z-index, modified via inline style when open */
}

/* Input container */
.input-container {
  position: relative;
  width: 100%;
}

/* Add dropdown indicator with CSS pseudo-element for better performance */
.input-container::after {
  content: "";
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  width: 0;
  height: 0;
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
  border-top: 5px solid var(--text-normal, #333);
  pointer-events: none;
  transition: transform 0.15s ease;
  will-change: transform;
}

/* Rotate caret when dropdown is open */
[data-is-open="true"] .input-container::after {
  transform: translateY(-50%) rotate(180deg);
}

/* ComboBox input */
.combobox-input {
  position: relative;
  z-index: 1;
  width: 100%;
  padding: 8px 12px;
  padding-right: 30px;
  border: 1px solid var(--background-modifier-border, #ddd);
  border-radius: 4px;
  background-color: var(--background-primary, #fff);
  color: var(--text-normal, #333);
  font-size: 14px;
  transition: border-color 0.15s ease;
}

/* Dropdown when open - hardware accelerated animation */
.combobox-dropdown {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  margin-top: -1px;
  z-index: 9999;
  background-color: var(--background-primary, #fff);
  border: 1px solid var(--background-modifier-border, #ddd);
  border-top: none;
  border-radius: 0 0 4px 4px;
  max-height: 200px;
  overflow-y: auto;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
  transition: opacity 0.15s ease, transform 0.15s ease;
  transform-origin: top center;
  will-change: transform, opacity;
  
  /* Using actual CSS animation instead of JS-driven transition */
  animation: combobox-dropdown-open 0.15s ease forwards;
}

@keyframes combobox-dropdown-open {
  from {
    opacity: 0;
    transform: translateY(-5px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Option item in dropdown */
.combobox-option {
  padding: 8px 12px;
  cursor: pointer;
  margin: 0;
  background-color: var(--background-primary, #fff);
  color: var(--text-normal, #333);
  font-size: 14px;
  line-height: 1.5;
  border-bottom: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1));
  transition: background-color 0.15s ease;
}

.combobox-option.highlighted,
.combobox-option:hover {
  background-color: var(--background-secondary, #f5f5f5);
}

/* "Add new" option styling */
.combobox-add-option {
  padding: 8px 12px;
  cursor: pointer;
  margin: 0;
  background-color: var(--background-primary, #fff);
  color: var(--text-normal, #333);
  font-size: 14px;
  line-height: 1.5;
  border-bottom: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1));
  font-style: italic;
  border-top: 1px dashed var(--background-modifier-border, #ddd);
  transition: background-color 0.15s ease;
}

.combobox-add-option.highlighted,
.combobox-add-option:hover {
  background-color: var(--background-secondary, #f5f5f5);
}

/* Selected items in multi-select mode */
.selected-item {
  display: inline-flex;
  align-items: center;
  margin: 0 4px 4px 0;
  padding: 4px 8px;
  background-color: var(--interactive-accent, #5183e4);
  color: white;
  border-radius: 4px;
  font-size: 12px;
  gap: 6px;
}

/* Remove button in tags */
.remove-button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 16px;
  height: 16px;
  min-width: 16px;
  min-height: 16px;
  padding: 0;
  background: rgba(255, 255, 255, 0.2);
  border: none;
  color: white;
  font-size: 14px;
  line-height: 1;
  cursor: pointer;
  border-radius: 50%;
  margin-left: 4px;
  position: relative;
  z-index: 5;
  transition: background-color 0.15s ease;
}

.remove-button:hover {
  background: rgba(255, 255, 255, 0.4);
}

/* When dropdown is open, modify input border-radius */
[data-is-open="true"] .combobox-input {
  border-bottom-left-radius: 0;
  border-bottom-right-radius: 0;
}

/* Focus state */
.combobox-input:focus {
  border-color: var(--interactive-accent, #5183e4);
  box-shadow: 0 0 0 2px rgba(83, 141, 226, 0.3);
  outline: none;
}

/* Error state */
.combobox-input.error {
  border-color: var(--text-error, #e53935);
}
`});function FB(){let e="journalit-account-weight-bar-styles";if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=dMe,document.head.appendChild(t)}function iee(){let e=document.getElementById("journalit-account-weight-bar-styles");e&&e.remove()}function zI(){document.getElementById("journalit-account-weight-bar-styles")||FB()}var dMe,OB=F(()=>{dMe=`
/* Account Type Weight Bar Styles */

/* Main container for the weight visualization */
.account-weight-bar-container {
  width: 100%;
  margin: 20px 0;
  padding: 0 10px;
}

/* Weight Bar Styles */
.account-weight-bar {
  display: flex;
  width: 100%;
  height: 12px;
  background-color: transparent;
  border-radius: 0;
  overflow: visible;
  margin-bottom: 12px;
  gap: 5px;
  padding: 0;
}

/* Individual weight segment */
.account-weight-segment {
  height: 100%;
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  min-width: 3px; /* Ensure very small segments are still visible */
  border-radius: 4px;
}

/* Hover effects for weight segments */
.account-weight-segment:hover {
  opacity: 0.8 !important;
  transform: scaleY(1.1) !important;
  z-index: 2;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
}

/* Active/focus states for accessibility */
.account-weight-segment:focus {
  outline: 2px solid var(--interactive-accent);
  outline-offset: 2px;
}

/* Weight Bar Tooltip Styles */
.account-weight-tooltip {
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
  padding: 0;
  max-width: 280px;
  min-width: 220px;
  font-size: 14px;
  line-height: 1.4;
  z-index: 1000;
  backdrop-filter: blur(8px);
}

.weight-tooltip-content {
  padding: 12px 16px;
}

.tooltip-header {
  margin-bottom: 8px;
  padding-bottom: 8px;
  border-bottom: 1px solid var(--background-modifier-border);
  font-size: 15px;
  font-weight: 600;
  color: var(--text-normal);
}

.tooltip-metrics {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.tooltip-metric {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 13px;
  line-height: 1.3;
}

.tooltip-metric .metric-label {
  color: var(--text-muted);
  font-weight: 500;
  flex-shrink: 0;
  margin-right: 12px;
}

.tooltip-metric .metric-value {
  color: var(--text-normal);
  font-weight: 600;
  text-align: right;
  flex: 1;
}

.tooltip-metric .metric-value.positive {
  color: var(--text-success);
}

.tooltip-metric .metric-value.negative {
  color: var(--text-error);
}

/* Legend Styles */
.account-weight-legend-container {
  width: 100%;
  margin-top: 0px;
  padding-top: 0px;
}

.account-weight-legend {
  display: flex;
  flex-wrap: wrap;
  gap: 8px 16px;
  padding: 0;
  align-items: center;
  justify-content: flex-start;
}

.account-weight-legend-item {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 13px;
  line-height: 1.3;
  color: var(--text-normal);
  transition: opacity 0.2s ease;
  cursor: default;
  width: 100%;
  max-width: 200px; /* Prevent items from becoming too wide */
}

.account-weight-legend-item:hover {
  opacity: 0.8;
}

.legend-dot {
  flex-shrink: 0;
  transition: transform 0.2s ease;
}

.account-weight-legend-item:hover .legend-dot {
  transform: scale(1.1);
}

.legend-text {
  display: flex;
  flex-direction: row;
  gap: 6px;
  align-items: center;
  min-width: 0; /* Allow text to shrink */
  flex: 1;
}

.legend-type-name {
  font-weight: 500;
  color: var(--text-normal);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.legend-percentage {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-muted);
  white-space: nowrap;
}

/* Responsive Design */

/* Mobile screens - adjust text size and container padding */
@media (max-width: 599px) {
  .account-weight-legend-item {
    font-size: 12px;
  }
  
  .legend-type-name {
    font-size: 12px;
  }
  
  .legend-percentage {
    font-size: 11px;
  }
  
  .account-weight-bar-container {
    padding: 0;
  }
  
  .account-weight-bar {
    height: 10px; /* Slightly smaller on mobile */
  }
}

/* Very small mobile screens - adjust layout */
@media (max-width: 400px) {
  .account-weight-legend {
    gap: 6px 12px;
  }
  
  .legend-text {
    flex-direction: row;
    gap: 4px;
    align-items: center;
    width: 100%;
  }
}

/* Dark theme adjustments */
.theme-dark .account-weight-tooltip {
  background-color: var(--background-primary);
  border-color: var(--background-modifier-border);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
}

.theme-dark .legend-dot {
  border-color: rgba(255, 255, 255, 0.1);
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

/* Light theme adjustments */
.theme-light .account-weight-tooltip {
  background-color: rgba(255, 255, 255, 0.95);
  border-color: var(--background-modifier-border);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
}

.theme-light .legend-dot {
  border-color: rgba(0, 0, 0, 0.15);
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

/* Animation for initial load */
.account-weight-bar .account-weight-segment {
  animation: segment-grow 0.6s ease-out;
  animation-fill-mode: both;
}

@keyframes segment-grow {
  from {
    width: 0%;
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

/* Stagger animation for segments */
.account-weight-segment:nth-child(1) { animation-delay: 0.1s; }
.account-weight-segment:nth-child(2) { animation-delay: 0.2s; }
.account-weight-segment:nth-child(3) { animation-delay: 0.3s; }
.account-weight-segment:nth-child(4) { animation-delay: 0.4s; }
.account-weight-segment:nth-child(5) { animation-delay: 0.5s; }
.account-weight-segment:nth-child(6) { animation-delay: 0.6s; }
.account-weight-segment:nth-child(7) { animation-delay: 0.7s; }
.account-weight-segment:nth-child(8) { animation-delay: 0.8s; }
.account-weight-segment:nth-child(9) { animation-delay: 0.9s; }
.account-weight-segment:nth-child(10) { animation-delay: 1.0s; }

/* Accessibility improvements */
@media (prefers-reduced-motion: reduce) {
  .account-weight-segment,
  .legend-dot {
    animation: none !important;
    transition: none !important;
  }
  
  .account-weight-segment:hover {
    transform: none !important;
  }
}

/* High contrast mode support */
@media (prefers-contrast: high) {
  .account-weight-bar {
    border: 2px solid var(--text-normal);
  }
  
  .account-weight-segment {
    border-right: 2px solid var(--background-primary);
  }
  
  .legend-dot {
    border: 2px solid var(--text-normal);
  }
}

/* Focus management for keyboard navigation */
.account-weight-bar:focus-within .account-weight-segment:focus {
  outline: 3px solid var(--interactive-accent);
  outline-offset: 2px;
  z-index: 10;
}
`});function pMe(){if(!zB)try{jI=document.createElement("style"),jI.textContent=uMe,jI.setAttribute("data-journalit-style","account-page"),document.head.appendChild(jI),zB=!0}catch(e){console.error("[Journalit] Error injecting account page styles:",e)}}function lh(){zB||pMe()}var uMe,zB,jI,aee=F(()=>{uMe=`
/* Account Page View Container 
 * CRITICAL: All flex containers in the hierarchy must have min-height: 0
 * to fix Firefox and other browser flexbox scrolling issues.
 * See: https://stackoverflow.com/questions/36535656/using-flexbox-and-overflow-hidden-scroll-not-working-in-firefox
 */
.journalit-account-page-view-container {
  height: 100%;
  overflow: hidden !important; /* Override ReactView inline styles */
  display: flex;
  flex-direction: column;
  padding: 0;
  min-height: 0; /* Critical for flexbox scrolling */
}

/* Target the React root element to prevent it from scrolling */
.journalit-account-page-view-container > div[id^="react-root-"] {
  height: 100%;
  overflow: visible;
  display: flex;
  flex-direction: column;
  min-height: 0; /* Critical for flexbox scrolling */
}

.journalit-account-page-view {
  display: flex;
  flex-direction: column;
  height: 100%;
  width: 100%;
  background: var(--background-primary);
  color: var(--text-normal);
  overflow: hidden;
  min-height: 0; /* Critical for flexbox scrolling */
}

/* Account Page Header */
.account-page-header {
  padding: 16px 20px;
  margin: 0 0 20px 0;
  background-color: var(--background-secondary);
  border-radius: 8px;
  border: 1px solid var(--background-modifier-border);
}

.account-page-header h2 {
  margin: 0 0 4px 0;
  font-size: 1.5rem;
  font-weight: 600;
  color: var(--text-normal);
}

.account-page-header p {
  margin: 0;
  color: var(--text-muted);
  font-size: 14px;
}

/* Account Page Content */
.account-page-wrapper {
  display: flex;
  flex-direction: column;
  height: 100%;
  overflow: hidden;
  min-height: 0; /* Critical for flexbox scrolling */
}

.account-page-placeholder {
  padding: 40px 20px;
  text-align: center;
  color: var(--text-muted);
}

.account-page-placeholder p {
  margin: 8px 0;
  font-size: 14px;
}

/* Error State */
.account-page-error {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  padding: 40px 20px;
  text-align: center;
}

.account-page-error h3 {
  margin: 0 0 12px 0;
  font-size: 20px;
  color: var(--text-normal);
}

.account-page-error p {
  margin: 0;
  color: var(--text-muted);
  font-size: 14px;
}

/* Loading State */
.account-page-loading {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  font-size: 16px;
  color: var(--text-muted);
}

/* Account Page Content Area */
.account-page-content {
  flex: 1 1 0; /* CRITICAL: Force height constraint - matches TradeLog fix */
  overflow-y: auto;
  overflow-x: hidden;
  padding: 20px;
  position: relative;
  min-height: 0; /* Important for flex children to scroll properly */
  max-height: 100%; /* Prevent expansion beyond parent - matches TradeLog fix */
  height: 0; /* Force flex to control height - matches TradeLog fix */
  /* Optimize scrolling performance */
  -webkit-overflow-scrolling: touch;
  scroll-behavior: auto; /* Disable smooth scrolling for better performance */
  will-change: scroll-position;
  /* Cross-browser flexbox scrolling fix */
  contain: layout;
}

/* Account Info Section */
.account-info {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 16px;
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid var(--background-modifier-border);
}

.account-info p {
  margin: 0;
  font-size: 14px;
  color: var(--text-muted);
}

/* Account Metrics */
.account-metrics {
  margin: 24px 0;
}

.account-metrics h3 {
  margin: 0 0 16px 0;
  font-size: 18px;
  color: var(--text-normal);
}

.metrics-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 16px;
  margin-bottom: 24px;
}

.metric-card {
  display: flex;
  flex-direction: column;
  padding: 16px;
  background: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
}

.metric-label {
  font-size: 16px;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 4px;
}

.metric-value {
  font-size: 20px;
  font-weight: 600;
  color: var(--text-normal);
}

.metric-value.positive {
  color: var(--text-success);
}

.metric-value.negative {
  color: var(--text-error);
}

/* Account Trades */
.account-trades {
  margin: 24px 0;
}

.account-trades h3 {
  margin: 0 0 16px 0;
  font-size: 18px;
  color: var(--text-normal);
}

.trades-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.trade-item {
  background: var(--background-secondary);
  border: 1px solid var(--background-modifier-border-hover);
  border-radius: 12px;
  overflow: hidden;
  transition: all 0.2s ease;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
}

.trade-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 20px 12px 20px;
  border-bottom: 1px solid var(--background-modifier-border);
  background: var(--background-primary-alt);
}

.trade-instrument {
  font-weight: 700;
  font-size: 18px;
  color: var(--text-normal);
  letter-spacing: -0.5px;
}

.trade-item .trade-direction {
  padding: 6px 12px;
  border-radius: 20px;
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  border: 1.5px solid;
}

.trade-item .trade-direction.long {
  border-color: var(--text-success);
  color: var(--text-success);
  background: rgba(var(--color-green-rgb), 0.1);
}

.trade-item .trade-direction.short {
  border-color: var(--text-error);
  color: var(--text-error);
  background: rgba(var(--color-red-rgb), 0.1);
}

.trade-item .trade-direction.call {
  border-color: var(--text-success);
  color: var(--text-success);
  background: rgba(var(--color-green-rgb), 0.1);
}

.trade-item .trade-direction.put {
  border-color: var(--text-error);
  color: var(--text-error);
  background: rgba(var(--color-red-rgb), 0.1);
}

.trade-pnl {
  font-weight: 700;
  font-size: 18px;
  letter-spacing: -0.5px;
}

.trade-pnl.positive {
  color: var(--text-success);
}

.trade-pnl.negative {
  color: var(--text-error);
}

.trade-details {
  padding: 16px 20px 20px 20px;
  display: grid;
  gap: 12px;
}


.trade-setups,
.trade-tags {
  font-size: 16px;
  color: var(--text-muted);
}

/* Account Header Component */
.account-header-main {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 16px;
  flex-wrap: wrap;
  gap: 16px;
}

.header-buttons {
  display: flex;
  gap: 8px;
  align-items: center;
  flex-shrink: 0;
}

.edit-account-btn,
.add-event-btn {
  background-color: var(--interactive-accent);
  color: white;
  border: 1px solid var(--interactive-accent);
  border-radius: 6px;
  padding: 8px 16px;
  font-size: 0.9rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s ease, transform 0.1s ease;
}

.edit-account-btn:hover,
.add-event-btn:hover {
  background-color: var(--interactive-accent-hover);
  transform: translateY(-1px);
}

.add-event-btn {
  background-color: var(--interactive-accent);
  border-color: var(--interactive-accent);
}

.add-event-btn:hover {
  background-color: var(--interactive-accent);
  opacity: 0.8;
}

.account-info-item {
  display: flex;
  flex-direction: column;
  gap: 4px;
  padding: 12px;
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
}

.info-label {
  font-weight: 500;
  color: var(--text-muted);
  font-size: 0.8rem;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.info-value {
  color: var(--text-normal);
  font-size: 1.1rem;
  font-weight: 600;
}

.edit-modal-placeholder {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  padding: 24px;
  z-index: 1000;
  box-shadow: var(--shadow-l);
}

/* Account Metrics Component */
.metrics-header {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  margin-bottom: 16px;
  flex-wrap: wrap;
  gap: 8px;
}

.metrics-subtitle {
  color: var(--text-muted);
  font-size: 14px;
}

.metric-value.neutral {
  color: var(--text-normal);
}

/* Account Balance Section */
.account-balance-section {
  margin: 32px 0;
}

.balance-section-header {
  margin-bottom: 16px;
}

.balance-section-header h3 {
  margin: 0 0 4px 0;
  font-size: 18px;
  color: var(--text-normal);
}

.balance-section-subtitle {
  margin: 0;
  color: var(--text-muted);
  font-size: 14px;
}

.balance-chart-container {
  background: transparent;
  border: none;
  border-radius: 0;
  padding: 0;
  margin: 16px 0;
}

.balance-chart-loading {
  height: 400px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-muted);
}

.balance-section-footer {
  margin-top: 8px;
}

.balance-info {
  margin: 0;
  color: var(--text-muted);
  font-size: 16px;
  font-style: italic;
}

/* Linked Trades Section */
.trades-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
  flex-wrap: wrap;
  gap: 16px;
}

.trades-header-centered {
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 24px 0;
  gap: 20px;
}

.trades-header-line {
  flex: 1;
  height: 1px;
  background: linear-gradient(to right, transparent, var(--background-modifier-border), transparent);
}

.trades-header-title {
  font-size: 18px;
  font-weight: 600;
  color: var(--text-normal);
  white-space: nowrap;
  padding: 0 16px;
  background: var(--background-primary);
}

.trade-item {
  cursor: pointer;
}

.trade-item:hover {
  border-color: var(--interactive-accent);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
  transform: translateY(-1px);
}

.trade-item.no-path {
  cursor: default;
  opacity: 0.6;
}

.trade-item.no-path:hover {
  transform: none;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
  border-color: var(--background-modifier-border-hover);
}

.trade-primary-info {
  display: flex;
  align-items: center;
  gap: 12px;
}

.trade-prices, .trade-dates {
  display: flex;
  gap: 16px;
  flex-wrap: wrap;
  padding: 8px 0;
  border-bottom: 1px solid var(--background-modifier-border);
}

.trade-price, .trade-size, .trade-date {
  font-size: 16px;
  color: var(--text-muted);
  font-weight: 500;
}

.trade-setups, .trade-mistakes, .trade-tags {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 0;
  border-bottom: 1px solid var(--background-modifier-border);
}

.trade-setups:last-child, .trade-mistakes:last-child, .trade-tags:last-child {
  border-bottom: none;
}

.setup-label, .mistake-label, .tags-label {
  font-size: 16px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  min-width: 80px;
  flex-shrink: 0;
}

.setup-tags, .mistake-tags, .tag-list {
  display: flex;
  gap: 6px;
  flex-wrap: wrap;
  flex: 1;
}

.setup-tag, .mistake-tag, .trade-tag {
  padding: 4px 10px;
  border-radius: 16px;
  font-size: 11px;
  font-weight: 500;
  letter-spacing: 0.25px;
  transition: all 0.2s ease;
}

.setup-tag {
  background: rgba(var(--color-green-rgb), 0.1);
  color: var(--text-success);
  border: 1px solid rgba(var(--color-green-rgb), 0.2);
}

.mistake-tag {
  background: rgba(var(--color-red-rgb), 0.1);
  color: var(--text-error);
  border: 1px solid rgba(var(--color-red-rgb), 0.2);
}

.trade-tag {
  background: var(--background-modifier-border);
  color: var(--text-muted);
  border: 1px solid var(--background-modifier-border-hover);
}

.trade-meta {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 0 0 0;
  margin-top: 8px;
  font-size: 16px;
  font-weight: 500;
}

.review-status {
  display: flex;
  align-items: center;
  gap: 6px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.review-status.reviewed {
  color: var(--text-success);
}

.review-status.reviewed::before {
  content: "\u2713";
  font-size: 14px;
}

.review-status.not-reviewed {
  color: var(--text-warning);
}

.review-status.not-reviewed::before {
  content: "\u25CB";
  font-size: 14px;
}

.trade-costs {
  color: var(--text-muted);
  font-weight: 500;
}

/* Trade Status - Open Trades */
.status-open {
  display: inline-block;
  padding: 2px 8px;
  border-radius: 3px;
  font-size: 16px;
  font-weight: 600;
  text-transform: uppercase;
  background: rgba(33, 150, 243, 0.15);
  color: var(--color-info);
}

/* Future Enhancements Placeholder */
.future-enhancements-placeholder {
  margin: 32px 0;
  padding: 24px;
  background: var(--background-secondary);
  border: 2px dashed var(--background-modifier-border);
  border-radius: 8px;
  text-align: center;
}

.future-enhancements-placeholder h3 {
  margin: 0 0 16px 0;
  color: var(--text-muted);
}

.future-enhancements-placeholder ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.future-enhancements-placeholder li {
  margin: 8px 0;
  color: var(--text-muted);
  font-size: 14px;
}

/* Edit Account Modal */
.edit-account-modal-container {
  max-width: 600px;
  width: 100%;
}

.edit-account-modal-container .modal-title {
  margin: 0 0 12px 0;
  padding: 0;
  font-size: 18px;
}

.edit-account-form {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 0;
}

.edit-account-form .setting-item {
  display: flex;
  flex-direction: column;
  gap: 4px;
  margin-bottom: 8px;
}

.edit-account-form .setting-item.two-column {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
  align-items: start;
}

.edit-account-form .setting-item.two-column .column {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.edit-account-form .setting-item-info {
  display: flex;
  flex-direction: column;
  gap: 2px;
  overflow: visible;
  min-width: auto;
}

.edit-account-form .setting-item-name {
  font-weight: 600;
  color: var(--text-normal);
  font-size: 16px;
  margin-bottom: 2px;
  overflow: visible;
  text-overflow: clip;
  white-space: normal;
  word-break: break-word;
}

.edit-account-form .setting-item-description {
  color: var(--text-muted);
  font-size: 11px;
  line-height: 1.2;
  margin-bottom: 4px;
}

.edit-account-form .setting-item-control {
  margin-top: 0;
}

.edit-account-form input,
.edit-account-form select {
  width: 100%;
  padding: 6px 8px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 3px;
  background: var(--background-primary);
  color: var(--text-normal);
  font-size: 16px;
  height: 30px;
  line-height: 1.2;
  box-sizing: border-box;
}

.edit-account-form select {
  height: 32px;
  padding: 5px 6px;
}

.edit-account-form input:focus,
.edit-account-form select:focus {
  outline: none;
  border-color: var(--interactive-accent);
  box-shadow: 0 0 0 1px var(--interactive-accent);
}

.edit-account-form input:disabled {
  background: var(--background-secondary);
  color: var(--text-muted);
  cursor: not-allowed;
}

.edit-account-buttons {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid var(--background-modifier-border);
  flex-shrink: 0;
}

.edit-account-buttons .button-group-right {
  display: flex;
  gap: 8px;
  align-items: center;
}

.edit-account-buttons .save-account-button {
  min-width: 100px;
}

.edit-account-buttons .cancel-button {
  min-width: 70px;
}

/* Create Account Modal - Same styling as Edit Account Modal */
.create-account-modal-container {
  max-width: 600px;
  width: 100%;
}

.create-account-modal-container .modal-title {
  margin: 0 0 12px 0;
  padding: 0;
  font-size: 18px;
}

.create-account-form {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 0;
  max-height: 70vh;
  overflow-y: auto;
}

.create-account-form .setting-item {
  display: flex;
  flex-direction: column;
  gap: 4px;
  margin-bottom: 8px;
}

.create-account-form .setting-item.two-column {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
  align-items: start;
}

.create-account-form .setting-item.two-column .column {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.create-account-form .setting-item-info {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.create-account-form .setting-item-name {
  font-weight: 600;
  color: var(--text-normal);
  font-size: 16px;
  margin-bottom: 2px;
}

.create-account-form .setting-item-description {
  color: var(--text-muted);
  font-size: 11px;
  line-height: 1.2;
  margin-bottom: 4px;
}

.create-account-form .setting-item-control {
  margin-top: 0;
}

.create-account-form input,
.create-account-form select {
  width: 100%;
  padding: 6px 8px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 3px;
  background: var(--background-primary);
  color: var(--text-normal);
  font-size: 16px;
  height: 30px;
  line-height: 1.2;
  box-sizing: border-box;
}

.create-account-form select {
  height: 32px;
  padding: 5px 6px;
}

.create-account-form input:focus,
.create-account-form select:focus {
  outline: none;
  border-color: var(--interactive-accent);
  box-shadow: 0 0 0 1px var(--interactive-accent);
}

.create-account-form input:disabled {
  background: var(--background-secondary);
  color: var(--text-muted);
  cursor: not-allowed;
}

.error-message-inline {
  color: var(--text-error);
  font-size: 0.875rem;
  margin-top: 0.25rem;
}

.create-account-buttons {
  display: flex;
  gap: 8px;
  justify-content: flex-end;
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid var(--background-modifier-border);
  flex-shrink: 0;
}

.create-account-buttons .create-account-button {
  min-width: 100px;
}

.create-account-buttons .cancel-button {
  min-width: 70px;
}

/* Modal Button Container for Confirmation Modals */
.modal-button-container {
  display: flex;
  gap: 8px;
  justify-content: flex-end;
  margin-top: 16px;
}

.modal-button-container button {
  padding: 8px 16px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  background: var(--background-primary);
  color: var(--text-normal);
  cursor: pointer;
  font-size: 14px;
}

.modal-button-container button:hover {
  background: var(--background-modifier-hover);
}

.modal-button-container button.mod-cta {
  background: var(--interactive-accent);
  color: var(--text-on-accent);
  border-color: var(--interactive-accent);
}

.modal-button-container button.mod-cta:hover {
  background: var(--interactive-accent-hover);
}

.modal-button-container button.mod-warning {
  background: var(--color-red);
  color: var(--text-on-accent);
  border-color: var(--color-red);
}

.modal-button-container button.mod-warning:hover {
  background: var(--color-red);
  opacity: 0.8;
}

/* Add Event Modal */
.add-event-modal-container {
  max-width: 600px;
  width: 100%;
}

.add-event-modal-container .modal-title {
  margin: 0 0 12px 0;
  padding: 0;
  font-size: 18px;
}

.add-event-form {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 0;
  max-height: 70vh;
  overflow-y: auto;
}

.add-event-form .setting-item {
  display: flex;
  flex-direction: column;
  gap: 4px;
  margin-bottom: 8px;
}

.add-event-form .setting-item.two-column {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
  align-items: start;
}

.add-event-form .setting-item.two-column .column {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.add-event-form .setting-item-info {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.add-event-form .setting-item-name {
  font-weight: 600;
  color: var(--text-normal);
  font-size: 16px;
  margin-bottom: 2px;
}

.add-event-form .setting-item-description {
  color: var(--text-muted);
  font-size: 11px;
  line-height: 1.2;
  margin-bottom: 4px;
}

.add-event-form .setting-item-control {
  margin-top: 0;
}

.add-event-form input,
.add-event-form select {
  width: 100%;
  padding: 6px 8px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 3px;
  background: var(--background-primary);
  color: var(--text-normal);
  font-size: 16px;
  height: 30px;
  line-height: 1.2;
  box-sizing: border-box;
}

.add-event-form select {
  height: 32px;
  padding: 5px 6px;
}

.add-event-form input:focus,
.add-event-form select:focus {
  outline: none;
  border-color: var(--interactive-accent);
  box-shadow: 0 0 0 1px var(--interactive-accent);
}

.add-event-form input:disabled {
  background: var(--background-secondary);
  color: var(--text-muted);
  cursor: not-allowed;
}

.add-event-buttons {
  display: flex;
  gap: 8px;
  justify-content: space-between;
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid var(--background-modifier-border);
  flex-shrink: 0;
}

.add-event-buttons .button-group-left {
  display: flex;
  gap: 8px;
  align-items: center;
}

.add-event-buttons .button-group-right {
  display: flex;
  gap: 8px;
  align-items: center;
}

.add-event-buttons .add-event-button {
  min-width: 100px;
}

.add-event-buttons .cancel-button {
  min-width: 70px;
}

/* Deposits & Withdrawals Section */
.deposits-withdrawals-section {
  margin: 32px 0;
}

.section-header-centered {
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 32px 0 24px 0;
  gap: 16px;
}

.section-header-line {
  flex: 1;
  height: 1px;
  background-color: var(--background-modifier-border);
  min-width: 20px;
}

.section-header-title {
  flex-shrink: 0;
  margin: 0;
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--text-normal);
  white-space: nowrap;
  padding: 0 8px;
}

.empty-transactions {
  text-align: center;
  padding: 20px;
}

.empty-state-action {
  margin-top: 16px;
}

.add-first-transaction-btn {
  background-color: var(--interactive-accent);
  color: white;
  border-color: var(--interactive-accent);
}

.transactions-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

/* Transaction Items */
.transaction-item {
  padding: 16px;
  background: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  transition: background-color 0.2s ease;
}

.transaction-item:hover {
  background: var(--background-modifier-hover);
}

.transaction-item.clickable {
  cursor: pointer;
}

.transaction-item.clickable:hover {
  background: var(--background-modifier-hover);
  border-color: var(--background-modifier-border-hover);
}

.transaction-item.deposit {
  border-left: 4px solid var(--color-info);
}

.transaction-item.withdrawal {
  border-left: 4px solid var(--text-warning);
}

.transaction-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
  flex-wrap: wrap;
  gap: 8px;
}

.transaction-primary-info {
  display: flex;
  align-items: center;
  gap: 12px;
}

.transaction-type {
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 16px;
  font-weight: 500;
  text-transform: uppercase;
}

.transaction-type.deposit {
  background: rgba(37, 99, 235, 0.15);
  color: var(--color-info);
  font-weight: 600;
}

.transaction-type.withdrawal {
  background: rgba(234, 179, 8, 0.15);
  color: var(--text-warning);
  font-weight: 600;
}

.transaction-date {
  font-size: 16px;
  color: var(--text-muted);
}

.transaction-amount {
  font-weight: 600;
  font-size: 16px;
}

.transaction-amount.positive {
  color: var(--color-info);
}

.transaction-amount.negative {
  color: var(--text-warning);
}

.transaction-details {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.transaction-description {
  display: flex;
  gap: 8px;
  align-items: flex-start;
}

.description-label {
  font-size: 16px;
  color: var(--text-muted);
  font-weight: 500;
}

.description-text {
  font-size: 16px;
  color: var(--text-normal);
}

.transaction-meta {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 8px;
  flex-wrap: wrap;
  gap: 8px;
}

.balance-after {
  font-size: 16px;
  color: var(--text-muted);
  font-weight: 500;
}

.transaction-actions {
  display: flex;
  gap: 4px;
  align-items: center;
}

.edit-transaction-btn,
.delete-transaction-btn {
  padding: 4px 8px;
  min-width: auto;
  height: auto;
}

.edit-transaction-btn {
  background-color: var(--interactive-accent);
  color: white;
  border-color: var(--interactive-accent);
}

.edit-transaction-btn:hover {
  background-color: var(--interactive-accent-hover);
}

.delete-transaction-btn {
  background-color: var(--color-red);
  color: white;
  border-color: var(--color-red);
}

.delete-transaction-btn:hover {
  background-color: var(--color-red);
  opacity: 0.8;
}

.transaction-description {
  color: var(--text-muted);
  font-style: italic;
  font-size: 16px;
}

/* Warning text for modals */
.warning {
  color: var(--text-warning);
  font-style: italic;
}

/* Account Risk Metrics Section */
.account-risk-metrics-section {
  margin: 32px 0;
}

.risk-metrics-container {
  display: flex;
  gap: 24px;
  margin-top: 24px;
  flex-wrap: wrap;
  justify-content: space-between;
}

.risk-metric-box {
  flex: 1;
  min-width: 300px;
  background-color: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 12px;
  padding: 20px;
}

.risk-metric-box.not-set {
  opacity: 0.6;
}

.risk-metric-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 16px;
  gap: 12px;
}

.header-left {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.title-with-badge {
  display: flex;
  align-items: center;
  gap: 12px;
  flex-wrap: wrap;
}

.risk-metric-title {
  margin: 0;
  font-size: 16px;
  font-weight: 600;
  color: var(--text-normal);
}

.risk-metric-percentage {
  font-size: 24px;
  font-weight: 700;
  color: var(--text-normal);
  text-align: right;
}

.risk-metric-percentage.not-set {
  color: var(--text-muted);
  font-weight: 500;
  font-size: 16px;
}

/* Status Badges (following trade direction badge pattern) */
.risk-status-badge {
  padding: 4px 8px;
  border-radius: 16px;
  font-size: 10px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  border: 1.5px solid;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  white-space: nowrap;
  flex-shrink: 0;
}

.risk-status-badge.in-progress {
  border-color: var(--color-warning);
  color: var(--color-warning);
  background: rgba(245, 158, 11, 0.1);
}

.risk-status-badge.achieved {
  border-color: var(--text-success);
  color: var(--text-success);
  background: rgba(var(--color-green-rgb), 0.1);
}

.risk-status-badge.breached {
  border-color: var(--text-error);
  color: var(--text-error);
  background: rgba(var(--color-red-rgb), 0.1);
}

/* Horizontal Progress Bar */
.horizontal-bar-container {
  margin-bottom: 16px;
}

.horizontal-bar-track {
  width: 100%;
  height: 12px;
  background-color: var(--background-modifier-border);
  border-radius: 6px;
  overflow: hidden;
  position: relative;
}

.horizontal-bar-fill {
  height: 100%;
  border-radius: 6px;
  transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
}

/* Drawdown Bar Colors */
.horizontal-bar-fill.safe {
  background: linear-gradient(90deg, var(--color-green) 0%, var(--color-green) 100%);
  box-shadow: 0 2px 8px rgba(34, 197, 94, 0.2);
}

.horizontal-bar-fill.warning {
  background: linear-gradient(90deg, var(--text-warning) 0%, var(--text-warning) 100%);
  box-shadow: 0 2px 8px rgba(234, 179, 8, 0.2);
}

.horizontal-bar-fill.critical {
  background: linear-gradient(90deg, var(--color-red) 0%, var(--color-red) 100%);
  box-shadow: 0 2px 8px rgba(239, 68, 68, 0.2);
}

/* Profit Target Bar Colors */
.horizontal-bar-fill.progress {
  background: linear-gradient(90deg, var(--interactive-accent) 0%, var(--interactive-accent) 100%);
  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.2);
}

.horizontal-bar-fill.complete {
  background: linear-gradient(90deg, var(--color-green) 0%, var(--color-green) 100%);
  box-shadow: 0 2px 8px rgba(34, 197, 94, 0.2);
}

/* Risk Metric Details */
.risk-metric-details {
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  padding: 12px;
  font-size: 16px;
}

.detail-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 6px;
}

.detail-row:last-child {
  margin-bottom: 0;
}

.detail-label {
  color: var(--text-muted);
  font-weight: 500;
}

.detail-value {
  color: var(--text-normal);
  font-weight: 600;
}

.detail-value.no-limit,
.detail-value.no-target {
  color: var(--text-muted);
  font-style: italic;
  text-align: center;
  width: 100%;
}

/* Responsive Design */
@media (max-width: 768px) {
  .account-page-header {
    margin: 0 0 16px 0;
    padding: 12px 16px;
  }
  
  .account-page-header h2 {
    font-size: 1.3rem;
  }
  
  /* Risk Metrics Mobile Styles */
  .risk-metrics-container {
    flex-direction: column;
    gap: 16px;
  }
  
  .risk-metric-box {
    min-width: 0;
    width: 100%;
  }
  
  .risk-metric-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 8px;
  }
  
  .header-left {
    flex-direction: column;
    align-items: flex-start;
    width: 100%;
    gap: 4px;
  }
  
  .title-with-badge {
    gap: 8px;
  }
  
  .risk-metric-percentage {
    text-align: left;
    font-size: 20px;
  }
  
  .account-page-content {
    padding: 16px;
  }
  
  .account-header-main {
    flex-direction: column;
    align-items: stretch;
    gap: 12px;
  }
  
  .edit-account-btn {
    align-self: flex-end;
    width: auto;
  }
  
  .account-info {
    grid-template-columns: 1fr;
    gap: 12px;
  }
  
  .metrics-grid {
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 12px;
  }
  
  .trade-header {
    flex-direction: column;
    align-items: flex-start;
  }
  
  .trades-header-centered {
    margin: 24px 0 16px 0;
    gap: 12px;
  }
  
  .trades-header-title {
    font-size: 1rem;
    padding: 0 6px;
  }
  
  .trade-info,
  .trade-dates {
    flex-direction: column;
    gap: 8px;
  }
  
  /* Edit Modal Responsive */
  .edit-account-modal-container {
    max-width: 90vw;
    max-height: 85vh;
  }
  
  .edit-account-form {
    gap: 6px;
  }
  
  .edit-account-form .setting-item {
    margin-bottom: 6px;
  }
  
  .edit-account-form .setting-item.two-column {
    grid-template-columns: 1fr;
    gap: 8px;
  }
  
  .edit-account-buttons {
    flex-direction: column;
    align-items: stretch;
    gap: 8px;
  }
  
  .edit-account-buttons .button-group-right {
    flex-direction: column;
    gap: 8px;
    width: 100%;
  }
  
  .edit-account-buttons .save-account-button,
  .edit-account-buttons .cancel-button,
  .edit-account-buttons .delete-account-button {
    min-width: auto;
    width: 100%;
  }
  
  /* Create Modal Responsive - Same as Edit Modal */
  .create-account-modal-container {
    max-width: 90vw;
    max-height: 85vh;
  }
  
  .create-account-form {
    max-height: 60vh;
    gap: 6px;
  }
  
  .create-account-form .setting-item {
    margin-bottom: 6px;
  }
  
  .create-account-form .setting-item.two-column {
    grid-template-columns: 1fr;
    gap: 8px;
  }
  
  .create-account-buttons {
    flex-direction: column;
    gap: 8px;
  }
  
  .create-account-buttons .create-account-button,
  .create-account-buttons .cancel-button {
    min-width: auto;
    width: 100%;
  }
}

/* Account Dashboard Settings Modal - Account Type Management */
.account-dashboard-settings-modal-container .available-account-types {
  margin-top: 8px;
}

.account-dashboard-settings-modal-container .account-types-container {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  align-items: center;
}

.account-dashboard-settings-modal-container .account-type-badge-container {
  position: relative;
  display: inline-block;
}

.account-dashboard-settings-modal-container .account-type-badge {
  display: inline-flex;
  align-items: center;
  padding: 6px 12px;
  background: var(--background-secondary);
  border: 1px solid var(--border-color);
  border-radius: 6px;
  font-size: 16px;
  font-weight: 500;
  color: var(--text-normal);
  position: relative;
  transition: all 0.2s ease;
}

.account-dashboard-settings-modal-container .account-type-badge:hover {
  border-color: var(--color-accent);
  background: var(--background-secondary-alt);
}

.account-dashboard-settings-modal-container .account-type-delete-btn {
  position: absolute;
  top: -6px;
  right: -6px;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: var(--color-red);
  border: 1px solid var(--background-primary);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: 14px;
  font-weight: bold;
  line-height: 1;
  z-index: 10;
  font-family: system-ui, -apple-system, sans-serif;
}

.account-dashboard-settings-modal-container .account-type-delete-btn:hover {
  background: var(--color-red-hover, #dc2626);
  transform: scale(1.1);
}

.account-dashboard-settings-modal-container .account-type-delete-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.account-dashboard-settings-modal-container .add-account-type-section {
  display: flex;
  align-items: center;
  gap: 8px;
}

.account-dashboard-settings-modal-container .add-account-type-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 28px;
  height: 28px;
  padding: 6px;
  background: var(--interactive-accent);
  border: 1px solid transparent;
  border-radius: 6px;
  color: var(--text-on-accent);
  cursor: pointer;
  transition: all 0.2s ease;
}

.account-dashboard-settings-modal-container .add-account-type-btn:hover {
  background: var(--interactive-accent-hover);
}

.account-dashboard-settings-modal-container .add-account-type-btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.account-dashboard-settings-modal-container .add-account-type-input {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 8px;
  background: var(--background-secondary);
  border: 1px solid var(--border-color);
  border-radius: 6px;
  min-width: 200px;
}

.account-dashboard-settings-modal-container .account-type-name-input {
  padding: 6px 8px;
  border: 1px solid var(--border-color);
  border-radius: 4px;
  background: var(--background-primary);
  color: var(--text-normal);
  font-size: 16px;
  outline: none;
  transition: border-color 0.2s ease;
}

.account-dashboard-settings-modal-container .account-type-name-input:focus {
  border-color: var(--color-accent);
}

.account-dashboard-settings-modal-container .add-account-type-buttons {
  display: flex;
  gap: 6px;
}

.account-dashboard-settings-modal-container .add-account-type-confirm-btn,
.account-dashboard-settings-modal-container .add-account-type-cancel-btn {
  padding: 4px 8px;
  border: 1px solid var(--border-color);
  border-radius: 4px;
  font-size: 11px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  flex: 1;
}

.account-dashboard-settings-modal-container .add-account-type-confirm-btn {
  background: var(--interactive-accent);
  color: var(--text-on-accent);
  border-color: transparent;
}

.account-dashboard-settings-modal-container .add-account-type-confirm-btn:hover:not(:disabled) {
  background: var(--interactive-accent-hover);
}

.account-dashboard-settings-modal-container .add-account-type-confirm-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.account-dashboard-settings-modal-container .add-account-type-cancel-btn {
  background: var(--background-primary);
  color: var(--text-normal);
}

.account-dashboard-settings-modal-container .add-account-type-cancel-btn:hover:not(:disabled) {
  background: var(--background-secondary);
  border-color: var(--color-accent);
}

.account-dashboard-settings-modal-container .no-account-types-container {
  display: flex;
  flex-direction: column;
  gap: 12px;
  align-items: flex-start;
}

.account-dashboard-settings-modal-container .no-account-types {
  color: var(--text-muted);
  font-style: italic;
  font-size: 16px;
}

/* Delete Confirmation Modal */
.account-type-delete-modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.8);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
  backdrop-filter: blur(2px);
}

.account-type-delete-modal {
  background: var(--background-primary);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  padding: 24px;
  max-width: 500px;
  width: 90vw;
  max-height: 80vh;
  overflow-y: auto;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.account-type-delete-modal h3 {
  margin: 0 0 16px 0;
  color: var(--text-normal);
  font-size: 18px;
  font-weight: 600;
}

.delete-modal-content {
  margin-bottom: 20px;
}

.delete-warning {
  padding: 12px;
  background: var(--background-secondary);
  border-radius: 6px;
  margin-bottom: 16px;
}

.delete-warning p {
  margin: 0;
  color: var(--text-normal);
  font-size: 14px;
}

.impact-analysis h4 {
  margin: 0 0 12px 0;
  color: var(--text-normal);
  font-size: 14px;
  font-weight: 600;
}

.impact-analysis h5 {
  margin: 12px 0 8px 0;
  color: var(--text-normal);
  font-size: 16px;
  font-weight: 500;
}

.impact-item {
  padding: 8px 12px;
  border-radius: 4px;
  margin-bottom: 8px;
  font-size: 16px;
  font-weight: 500;
}

.impact-item.impact-critical {
  background: rgba(239, 68, 68, 0.1);
  color: var(--color-red);
  border: 1px solid rgba(239, 68, 68, 0.2);
}

.impact-item.impact-safe {
  background: rgba(34, 197, 94, 0.1);
  color: var(--color-green, #22c55e);
  border: 1px solid rgba(34, 197, 94, 0.2);
}

.affected-accounts ul {
  margin: 8px 0 0 0;
  padding-left: 20px;
  list-style-type: disc;
}

.affected-accounts li {
  margin: 4px 0;
  color: var(--text-normal);
  font-weight: normal;
}

.migration-notice {
  margin-top: 12px;
  padding: 8px 12px;
  background: var(--background-secondary-alt);
  border-radius: 4px;
  font-size: 16px;
  color: var(--text-muted);
  border-left: 3px solid var(--color-accent);
}

.settings-cleanup {
  margin-top: 16px;
}

.settings-cleanup ul {
  margin: 8px 0 0 0;
  padding-left: 20px;
  list-style-type: none;
}

.settings-cleanup li {
  margin: 4px 0;
  color: var(--text-normal);
  font-size: 16px;
}

.delete-modal-actions {
  display: flex;
  gap: 12px;
  justify-content: flex-end; 
  padding-top: 16px;
  border-top: 1px solid var(--border-color);
}

.delete-modal-actions .button {
  min-width: 100px;
}

/* Account Migration Modal Overlay (higher z-index than delete modal) */
.account-migration-modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.8);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10001; /* Higher than delete modal (10000) */
  backdrop-filter: blur(2px);
}

/* Account Migration Modal Specific Styles */
.account-migration-modal {
  max-width: 600px;
}

.migration-warning {
  padding: 16px;
  background: rgba(239, 68, 68, 0.1);
  border: 1px solid rgba(239, 68, 68, 0.2);
  border-radius: 6px;
  margin-bottom: 20px;
}

.migration-warning p {
  margin: 0 0 8px 0;
  color: var(--text-normal);
  font-size: 14px;
}

.migration-warning p:last-child {
  margin-bottom: 0;
}

.affected-accounts-list {
  margin: 8px 0 0 20px;
  padding: 0;
  list-style-type: disc;
}

.affected-accounts-list li {
  margin: 4px 0;
  color: var(--text-normal);
  font-size: 16px;
}

.migration-options h4 {
  margin: 0 0 16px 0;
  color: var(--text-normal);
  font-size: 16px;
  font-weight: 600;
}

.migration-option-group {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.migration-option {
  display: flex;
  align-items: flex-start;
  gap: 12px;
  padding: 12px;
  border: 2px solid var(--border-color);
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.migration-option:hover {
  border-color: var(--color-accent);
  background: var(--background-secondary);
}

.migration-option input[type="radio"] {
  margin: 0;
  margin-top: 2px;
}

.migration-option input[type="radio"]:checked + .migration-option-content {
  color: var(--color-accent);
}

.migration-option.checked {
  border-color: var(--color-accent);
  background: var(--background-secondary);
}

.migration-option-content {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.migration-option-title {
  font-weight: 600;
  font-size: 14px;
  color: var(--text-normal);
}

.migration-option-desc {
  font-size: 16px;
  color: var(--text-muted);
  line-height: 1.4;
}

.target-type-select {
  margin-top: 12px;
  padding: 12px;
  background: var(--background-secondary-alt);
  border-radius: 6px;
  border: 1px solid var(--border-color);
}

.target-type-select label {
  display: block;
  margin-bottom: 6px;
  font-size: 16px;
  font-weight: 500;
  color: var(--text-normal);
}

.target-type-select select {
  width: 100%;
  padding: 6px 8px;
  border: 1px solid var(--border-color);
  border-radius: 4px;
  background: var(--background-primary);
  color: var(--text-normal);
  font-size: 16px;
}

.target-type-select select:focus {
  outline: none;
  border-color: var(--color-accent);
}

.delete-modal-actions .delete-confirm-button {
  background: var(--color-red) !important;
  color: white !important;
  border-color: var(--color-red) !important;
}

.delete-modal-actions .delete-confirm-button:hover:not(:disabled) {
  background: var(--color-red-hover, #dc2626) !important;
  border-color: var(--color-red-hover, #dc2626) !important;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .account-dashboard-settings-modal-container .account-types-container {
    flex-direction: column;
    align-items: flex-start;
  }
  
  .account-dashboard-settings-modal-container .add-account-type-input {
    min-width: 100%;
  }
  
  .account-dashboard-settings-modal-container .add-account-type-buttons {
    width: 100%;
  }
  
  .account-type-delete-modal {
    margin: 20px;
    width: calc(100vw - 40px);
    max-width: none;
  }
  
  .delete-modal-actions {
    flex-direction: column;
  }
  
  .delete-modal-actions .button {
    width: 100%;
  }
}

/* Responsive styles for small screens */
@media (max-width: 600px) {
  .edit-account-form input,
  .edit-account-form select,
  .create-account-form input,
  .create-account-form select,
  .add-event-form input,
  .add-event-form select,
  .account-dashboard-settings-modal-container .account-type-name-input {
    font-size: 18px !important;
  }
}
`,zB=!1,jI=null});function _I(){let e=document.head.querySelector("#tradelog-settings-modal-styles");e||(e=document.createElement("style"),e.id="tradelog-settings-modal-styles",document.head.appendChild(e)),e.textContent=mMe,jB++}function oee(){if(jB--,jB===0){let e=document.head.querySelector("#tradelog-settings-modal-styles");e&&e.remove()}}var mMe,jB,_B=F(()=>{mMe=`
  .tradelog-settings-modal-container {
    max-width: 500px;
    width: 100%;
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    height: 100%;
  }

  /* Display Mode Toggle */
  .tradelog-settings-display-mode {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 16px;
    background: var(--background-secondary);
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    margin-top: 16px;
  }

  .display-mode-label {
    display: flex;
    flex-direction: column;
    gap: 2px;
  }

  .display-mode-title {
    font-size: 14px;
    font-weight: 500;
    color: var(--text-normal);
  }

  .display-mode-description {
    font-size: 12px;
    color: var(--text-muted);
  }

  /* Tab Navigation - matching trade form style */
  .tradelog-settings-modal-container .journalit-tab-nav {
    display: flex;
    border-bottom: 1px solid var(--background-modifier-border);
    margin-bottom: 16px;
    justify-content: center;
    width: 100%;
    padding-top: 10px;
    padding-bottom: 0;
  }

  .tradelog-settings-modal-container .journalit-tab-wrapper {
    display: flex;
    justify-content: center;
    flex: 1;
  }

  .tradelog-settings-modal-container .journalit-tab-button {
    background: transparent;
    border: none;
    border-bottom: 2px solid transparent;
    padding: 10px 20px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    color: var(--text-muted);
    transition: all 0.2s ease;
    position: relative;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .tradelog-settings-modal-container .journalit-tab-button:hover {
    color: var(--text-normal);
    background-color: var(--background-modifier-hover);
  }

  .tradelog-settings-modal-container .journalit-tab-button.journalit-tab-active {
    color: var(--text-normal);
    font-weight: 600;
    border-bottom-color: var(--text-accent);
  }

  .tradelog-settings-modal-container .journalit-tab-count {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    background-color: var(--background-modifier-border);
    color: var(--text-muted);
    border-radius: 10px;
    font-size: 11px;
    font-weight: 600;
    padding: 2px 6px;
    min-width: 20px;
  }

  .tradelog-settings-modal-container .journalit-tab-button.journalit-tab-active .journalit-tab-count {
    background-color: var(--interactive-accent);
    color: var(--text-on-accent);
  }

  /* Panel Content */
  .tradelog-settings-modal-content {
    flex: 1;
    overflow-y: auto;
    padding: 0 4px;
  }

  .tradelog-settings-panel {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .panel-description {
    font-size: 12px;
    color: var(--text-muted);
    margin-bottom: 8px;
    text-align: center;
  }

  .empty-panel-message {
    text-align: center;
    color: var(--text-muted);
    padding: 32px 16px;
    font-size: 13px;
  }

  /* Active Column Item (draggable) */
  .active-column-item {
    display: grid;
    grid-template-columns: 32px 1fr 32px;
    gap: 8px;
    align-items: center;
    padding: 10px 12px;
    background: var(--background-secondary);
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    transition: background-color 0.2s ease, border-color 0.2s ease;
  }

  .active-column-item:hover {
    background: var(--background-modifier-hover);
    border-color: var(--interactive-accent);
  }

  .active-column-item.dragging {
    opacity: 0.5;
  }

  .column-drag-handle {
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-muted);
    cursor: grab;
  }

  .column-drag-handle:hover {
    color: var(--text-normal);
  }

  .column-drag-handle:active {
    cursor: grabbing;
  }

  .active-column-item .column-label {
    color: var(--text-normal);
    font-size: 14px;
  }

  .column-remove-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 24px;
    height: 24px;
    border: none;
    background: transparent;
    color: var(--text-muted);
    cursor: pointer;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 400;
    line-height: 1;
    padding: 0;
    transition: all 0.15s ease;
  }

  .column-remove-btn:hover:not(:disabled) {
    background: var(--background-modifier-error);
    color: var(--text-on-accent);
  }

  .column-remove-btn:disabled {
    opacity: 0.3;
    cursor: not-allowed;
  }

  /* Available Panel - Categories */
  .column-category {
    margin-bottom: 8px;
  }

  .category-header {
    display: flex;
    align-items: center;
    gap: 8px;
    width: 100%;
    padding: 8px 12px;
    background: var(--background-secondary);
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    cursor: pointer;
    font-size: 13px;
    font-weight: 600;
    color: var(--text-normal);
    transition: background-color 0.15s ease;
  }

  .category-header:hover {
    background: var(--background-modifier-hover);
  }

  .category-header svg {
    color: var(--text-muted);
    flex-shrink: 0;
  }

  .category-label {
    flex: 1;
    text-align: left;
  }

  .category-count {
    font-size: 11px;
    font-weight: 500;
    color: var(--text-muted);
    background: var(--background-primary);
    padding: 2px 6px;
    border-radius: 8px;
  }

  .category-columns {
    display: flex;
    flex-direction: column;
    gap: 4px;
    padding: 8px 0 0 24px;
  }

  /* Available Column Item */
  .available-column-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 12px;
    background: var(--background-primary);
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    transition: background-color 0.15s ease;
  }

  .available-column-item:hover {
    background: var(--background-secondary);
  }

  .available-column-item .column-label {
    color: var(--text-normal);
    font-size: 13px;
  }

  .column-add-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 24px;
    height: 24px;
    border: none;
    background: var(--interactive-accent);
    color: var(--text-on-accent);
    cursor: pointer;
    border-radius: 4px;
    transition: all 0.15s ease;
  }

  .column-add-btn:hover {
    background: var(--interactive-accent-hover);
    transform: scale(1.05);
  }

  /* Footer Buttons */
  .tradelog-settings-modal-buttons {
    display: flex;
    gap: 8px;
    justify-content: flex-end;
    margin-top: 16px;
    padding-top: 16px;
    border-top: 1px solid var(--background-modifier-border);
  }

  .tradelog-settings-modal-buttons button {
    padding: 8px 16px;
    border-radius: 6px;
    font-size: 14px;
    cursor: pointer;
    border: 1px solid var(--background-modifier-border);
    background: var(--background-secondary);
    color: var(--text-normal);
  }

  .tradelog-settings-modal-buttons button:hover {
    background: var(--background-modifier-hover);
  }

  .tradelog-settings-modal-buttons button.primary {
    background: var(--interactive-accent);
    color: var(--text-on-accent);
    border-color: var(--interactive-accent);
  }

  .tradelog-settings-modal-buttons button.primary:hover {
    background: var(--interactive-accent-hover);
  }

  .tradelog-settings-modal-buttons .reset-button {
    margin-right: auto;
  }
`,jB=0});function BI(){if(document.head.querySelector("#batch-action-toolbar-styles"))return;let e=document.createElement("style");e.id="batch-action-toolbar-styles",e.textContent=fMe,document.head.appendChild(e)}function WI(){var e;(e=document.head.querySelector("#batch-action-toolbar-styles"))==null||e.remove()}var fMe,BB=F(()=>{fMe=`
  .batch-action-toolbar {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 12px 16px;
    background: var(--background-secondary);
    border-top: 1px solid var(--background-modifier-border);
    border-bottom: 1px solid var(--background-modifier-border);
    flex-wrap: wrap;
    justify-content: flex-start;
  }

  .batch-action-toolbar-actions button {
    padding: 6px 12px;
    border-radius: 6px;
    font-size: 13px;
    cursor: pointer;
    border: 1px solid var(--background-modifier-border);
    background: var(--interactive-accent);
    color: var(--text-on-accent);
    font-weight: 500;
    transition: background 0.2s ease, opacity 0.2s ease;
  }

  .batch-action-toolbar-actions button:hover:not(:disabled) {
    opacity: 0.85;
    background: var(--interactive-accent);
  }

  .batch-action-toolbar-actions button:active:not(:disabled) {
    opacity: 0.8;
  }

  .batch-action-toolbar-actions button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .batch-action-toolbar-actions button.danger {
    background: var(--text-error);
    border-color: var(--text-error);
    color: white;
  }

  .batch-action-toolbar-actions button.danger:hover:not(:disabled) {
    opacity: 0.85;
    background: var(--text-error);
  }

  @media (max-width: 768px) {
    .batch-action-toolbar {
      padding: 8px 12px;
      gap: 8px;
    }

    .batch-action-toolbar-count {
      font-size: 13px;
    }

    .batch-action-toolbar-actions {
      gap: 6px;
    }

    .batch-action-toolbar-actions button {
      padding: 6px 12px;
      font-size: 13px;
    }
  }

  /* Batch action modal styles */
  .batch-action-modal-container {
    display: flex;
    flex-direction: column;
    width: 100%;
    flex: 1;
    min-height: 0;
  }

  .batch-action-modal-content {
    display: flex;
    flex-direction: column;
    flex: 1;
    min-height: 0;
  }

  .batch-action-modal-body {
    flex: 1;
    overflow-y: auto;
    overflow-x: hidden;
    padding: 16px;
    min-height: 0;
  }

  .batch-action-modal-buttons {
    display: flex;
    gap: 8px;
    justify-content: flex-end;
    padding: 12px 16px;
    border-top: 1px solid var(--background-modifier-border);
    flex-shrink: 0;
    background: var(--background-primary);
  }

  .batch-action-modal-buttons button {
    padding: 8px 16px;
    border-radius: 4px;
    border: 1px solid var(--background-modifier-border);
    background: var(--background-primary);
    color: var(--text-normal);
    cursor: pointer;
    font-size: 14px;
  }

  .batch-action-modal-buttons button:hover:not(:disabled) {
    background: var(--background-modifier-hover);
  }

  .batch-action-modal-buttons button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .batch-action-modal-buttons button.primary {
    background: var(--interactive-accent);
    color: var(--text-on-accent);
    border-color: var(--interactive-accent);
  }

  .batch-action-modal-buttons button.primary:hover:not(:disabled) {
    background: var(--interactive-accent-hover);
  }

  .journalit-batch-modal-title {
    margin: 0 0 16px 0;
    font-size: 18px;
    font-weight: 600;
    color: var(--text-normal);
  }

  /* Fix count class mismatch and ensure consistent typography */

  .batch-selection-count {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 6px 12px;
    border-radius: 12px;
    border: 1px solid var(--background-modifier-border);
    background: var(--background-modifier-hover);
    color: var(--text-normal);
    font-weight: 600;
    font-size: 13px;
    line-height: 1;
    white-space: nowrap;
    text-transform: uppercase;
  }

  .batch-action-toolbar-left {
    display: flex;
    align-items: center;
    gap: 8px;
    flex: 0 1 auto;
    min-width: 0;
  }

  .batch-action-select-all-btn {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 6px 10px;
    border-radius: 6px;
    border: 1px solid var(--background-modifier-border);
    background: var(--interactive-accent);
    color: var(--text-on-accent);
    font-size: 12px;
    font-weight: 500;
    cursor: pointer;
    white-space: nowrap;
    transition: background 0.2s ease, opacity 0.2s ease;
  }

  .batch-action-select-all-btn:hover:not(:disabled) {
    opacity: 0.85;
    background: var(--interactive-accent);
  }

  .batch-action-select-all-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .batch-action-select-all-btn svg {
    flex-shrink: 0;
  }

  @media (max-width: 768px) {
    .batch-action-select-all-btn .select-all-label {
      display: none;
    }
    .batch-action-select-all-btn {
      padding: 6px;
      min-width: 28px;
      justify-content: center;
    }
  }

  .batch-action-toolbar-actions {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
  }

  /* Icon spacing with labels visible */
  .batch-action-toolbar-actions button svg {
    margin-right: 6px;
  }

  @media (max-width: 1024px) {
    .batch-action-toolbar-actions button {
      padding: 6px 10px;
    }
  }

  /* Compact icon-first buttons at narrower widths */
  @media (max-width: 900px) {
    .batch-action-toolbar-actions .btn-label {
      display: none;
    }
    .batch-action-toolbar-actions button {
      padding: 6px;
      min-width: 32px;
      justify-content: center;
    }
    .batch-action-toolbar-actions button svg {
      margin-right: 0;
    }
  }

  /* Tight layout and full-width action row on very small screens */
  @media (max-width: 600px) {
    .batch-action-toolbar {
      gap: 6px;
    }

    .batch-action-toolbar-actions {
      width: 100%;
      justify-content: flex-start;
    }
  }
`});function RI(){if($I===0&&!document.head.querySelector("#trade-log-mini-header-styles")){let e=document.createElement("style");e.id="trade-log-mini-header-styles",e.textContent=gMe,document.head.appendChild(e)}$I++}function UI(){if($I--,$I===0){let e=document.head.querySelector("#trade-log-mini-header-styles");e&&e.remove()}}var gMe,$I,WB=F(()=>{gMe=`
/**
 * File: src/styles/tradelog/tradeLogMiniHeaderStyles.ts
 * Purpose: Styles for TradeLog mini-headers in tree view modes
 */

.trade-log-mini-header {
  display: flex;
  align-items: center;
  min-height: 32px;
  padding: 6px 0;
  opacity: 0.7;
  pointer-events: none;
}

.tree-indicator-cell-header {
  /* Width controlled by grid template (20px) */
}

.mini-header-row {
  display: grid;
  /* gridTemplateColumns set via inline style from React */
  gap: 6px;
  align-items: center;
  padding: 0 16px 0 0;
  font-size: 11px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  width: 100%;
}

.mini-header-cell {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  text-align: center;
}
`,$I=0});function qI(){let e=document.getElementById(HI);e&&e.remove();let t=document.createElement("style");t.id=HI,t.textContent=hMe,document.head.appendChild(t)}function $B(){let e=document.getElementById(HI);e&&e.remove()}function see(){document.getElementById(HI)||qI()}var HI,hMe,RB=F(()=>{co();HI="onboarding-wizard-modal-styles",hMe=`
  .onboarding-wizard-modal {
    position: relative;
    padding: 16px;
    max-width: 500px;
    margin: 0 auto;
    height: fit-content;
    display: flex;
    flex-direction: column;
  }

  .modal-header {
    margin-bottom: 16px;
  }

  .modal-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow-y: visible;
    padding-bottom: 8px; /* Reserve space for skip button */
  }

  .onboarding-slide {
    text-align: center;
  }

  .onboarding-slide h2 {
    margin: 0 0 12px 0;
    font-size: 20px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .onboarding-slide p {
    margin: 0 0 20px 0;
    color: var(--text-muted);
    line-height: 1.4;
  }

  .slide-placeholder {
    padding: 20px;
    border: 2px dashed var(--background-modifier-border);
    border-radius: 8px;
    background: var(--background-secondary);
    margin: 20px 0;
  }

  .slide-placeholder p {
    font-style: italic;
    color: var(--text-muted);
  }

  /* Welcome slide styles */
  .welcome-slide {
    text-align: center;
    padding: 20px 0;
  }

  .welcome-icon {
    font-size: 48px;
    margin-bottom: 16px;
  }

  .welcome-subtitle {
    font-size: 16px;
    color: var(--text-muted);
    margin-bottom: 32px;
    font-weight: 500;
  }

  .welcome-features {
    display: flex;
    flex-direction: column;
    gap: 20px;
    margin: 32px 0;
    text-align: left;
    max-width: 400px;
    margin-left: auto;
    margin-right: auto;
  }

  .feature {
    display: flex;
    align-items: flex-start;
    gap: 12px;
  }

  .feature-icon {
    font-size: 20px;
    flex-shrink: 0;
    margin-top: 2px;
  }

  .feature-text h3 {
    margin: 0 0 4px 0;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .feature-text p {
    margin: 0;
    font-size: 13px;
    color: var(--text-muted);
    line-height: 1.4;
  }

  .welcome-tagline {
    font-size: 14px;
    color: var(--interactive-accent);
    font-weight: 500;
    margin-top: 24px;
  }

  .welcome-trust-indicators {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-top: 20px;
    padding: 16px;
    background: var(--background-secondary);
    border-radius: 8px;
    border: 1px solid var(--background-modifier-border);
  }

  .trust-item {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 12px;
    color: var(--text-normal);
  }

  .trust-icon {
    font-size: 14px;
    flex-shrink: 0;
  }

  .welcome-preview-section {
    margin: 32px 0 24px 0;
  }

  .welcome-preview-section h3 {
    margin: 0 0 16px 0;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-normal);
    text-align: center;
  }

  .insights-preview {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .insight-preview-card {
    padding: 12px;
    background: var(--background-secondary);
    border-radius: 6px;
    border: 1px solid var(--background-modifier-border);
    text-align: left;
  }

  .insight-preview-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 6px;
  }

  .insight-preview-icon {
    font-size: 14px;
    flex-shrink: 0;
  }

  .insight-preview-header strong {
    font-size: 12px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .insight-preview-content {
    font-size: 11px;
    color: var(--text-muted);
    font-style: italic;
    line-height: 1.3;
    padding-left: 22px;
  }

  /* Goal selection styles */
  .goal-slide {
    text-align: center;
  }

  .goal-options {
    display: flex;
    flex-direction: column;
    gap: 16px;
    margin: 24px 0;
    text-align: left;
  }

  .goal-option {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    padding: 16px;
    border: 2px solid var(--background-modifier-border);
    border-radius: 8px;
    background: var(--background-primary);
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .goal-option:hover {
    border-color: var(--interactive-accent-hover);
    background: var(--background-secondary);
  }

  .goal-option.selected {
    border-color: var(--interactive-accent);
    background: var(--background-secondary);
  }

  .goal-radio {
    width: 20px;
    height: 20px;
    border: 2px solid var(--background-modifier-border);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    margin-top: 2px;
  }

  .goal-option.selected .goal-radio {
    border-color: var(--interactive-accent);
  }

  .goal-radio-inner {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: transparent;
    transition: background 0.2s ease;
  }

  .goal-radio-inner.selected {
    background: var(--interactive-accent);
  }

  .goal-content {
    flex: 1;
  }

  .goal-content h3 {
    margin: 0 0 6px 0;
    font-size: 15px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .goal-content p {
    margin: 0 0 8px 0;
    font-size: 13px;
    color: var(--text-muted);
    line-height: 1.4;
  }

  .goal-badge {
    display: inline-block;
    font-size: 11px;
    font-weight: 500;
    color: var(--text-on-accent);
    background: var(--interactive-accent);
    padding: 2px 8px;
    border-radius: 12px;
  }

  .goal-selection-info {
    margin-top: 20px;
    padding: 12px;
    background: var(--background-secondary);
    border-radius: 6px;
    font-size: 14px;
    color: var(--text-normal);
  }

  /* Segmentation slide styles */
  .segmentation-slide {
    text-align: center;
  }

  .segmentation-questions {
    display: flex;
    flex-direction: column;
    gap: 16px;
    margin: 16px 0 0px 0;
    text-align: left;
  }

  .segmentation-question h3 {
    margin: 0 0 8px 0;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-normal);
    text-align: center;
  }

  .multi-select-options {
    display: flex;
    flex-wrap: nowrap;
    gap: 6px;
    justify-content: center;
    overflow-x: auto;
  }

  .multi-select-option {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 6px 10px;
    border: 2px solid var(--background-modifier-border);
    border-radius: 6px;
    background: var(--background-primary);
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: 13px;
    flex-shrink: 0;
  }

  .multi-select-option:hover {
    border-color: var(--interactive-accent-hover);
    background: var(--background-secondary);
  }

  .multi-select-option.selected {
    border-color: var(--interactive-accent);
    background: var(--background-secondary);
    color: var(--interactive-accent);
  }

  .option-checkbox {
    width: 16px;
    height: 16px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 3px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 10px;
    background: var(--background-primary);
  }

  .multi-select-option.selected .option-checkbox {
    border-color: var(--interactive-accent);
    background: var(--interactive-accent);
    color: var(--text-on-accent);
  }

  .radio-options {
    display: flex;
    flex-direction: column;
    gap: 6px;
  }

  .radio-option {
    display: flex;
    align-items: flex-start;
    gap: 10px;
    padding: 10px;
    border: 2px solid var(--background-modifier-border);
    border-radius: 6px;
    background: var(--background-primary);
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .radio-option:hover {
    border-color: var(--interactive-accent-hover);
    background: var(--background-secondary);
  }

  .radio-option.selected {
    border-color: var(--interactive-accent);
    background: var(--background-secondary);
  }

  .option-radio {
    width: 16px;
    height: 16px;
    border: 2px solid var(--background-modifier-border);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    margin-top: 1px;
  }

  .radio-option.selected .option-radio {
    border-color: var(--interactive-accent);
  }

  .radio-inner {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: transparent;
    transition: background 0.2s ease;
  }

  .radio-inner.selected {
    background: var(--interactive-accent);
  }

  .option-content {
    flex: 1;
  }

  .option-label {
    display: block;
    font-size: 13px;
    font-weight: 500;
    color: var(--text-normal);
    margin-bottom: 2px;
  }

  .option-description {
    display: block;
    font-size: 11px;
    color: var(--text-muted);
    line-height: 1.3;
  }

  /* First action slide styles */
  .first-action-slide {
    text-align: center;
  }

  .first-action-icon {
    font-size: 48px;
    margin-bottom: 16px;
  }

  .first-action-content {
    margin: 24px 0;
  }

  .first-action-preview {
    background: var(--background-secondary);
    border-radius: 8px;
    padding: 20px;
    margin: 20px 0;
    text-align: left;
  }

  .first-action-preview h3 {
    margin: 0 0 12px 0;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-normal);
    text-align: center;
  }

  .sample-trade-preview {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .preview-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 0;
    border-bottom: 1px solid var(--background-modifier-border);
  }

  .preview-row:last-child {
    border-bottom: none;
  }

  .preview-label {
    font-weight: 500;
    color: var(--text-muted);
  }

  .preview-value {
    color: var(--text-normal);
  }

  .create-sample-button {
    margin: 20px 0;
  }

  .first-action-note {
    font-size: 12px;
    color: var(--text-muted);
    margin-top: 12px;
  }

  .first-action-success {
    text-align: center;
    margin: 24px 0;
  }

  .success-checkmark {
    font-size: 48px;
    color: var(--color-green);
    margin-bottom: 16px;
  }

  .first-action-success h3 {
    margin: 0 0 12px 0;
    font-size: 16px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .success-actions {
    margin: 20px 0;
    text-align: left;
    max-width: 300px;
    margin-left: auto;
    margin-right: auto;
  }

  .success-action {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 8px 0;
    font-size: 13px;
    color: var(--text-normal);
  }

  .action-icon {
    font-size: 16px;
    flex-shrink: 0;
  }

  .sample-trade-path {
    margin-top: 16px;
    padding: 8px 12px;
    background: var(--background-modifier-border);
    border-radius: 4px;
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
  }

  .sample-trade-path small {
    color: var(--text-muted);
    font-size: 11px;
  }

  .trade-insights {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin: 20px 0;
    text-align: left;
  }

  .insight-card {
    padding: 16px;
    background: var(--background-secondary);
    border-radius: 8px;
    border: 1px solid var(--background-modifier-border);
  }

  .insight-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 8px;
  }

  .insight-icon {
    font-size: 16px;
    flex-shrink: 0;
  }

  .insight-header strong {
    font-size: 13px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .insight-detail {
    font-size: 12px;
    color: var(--text-muted);
    line-height: 1.4;
  }

  /* Authentication slide styles */
  .authentication-slide {
    text-align: center;
  }

  .auth-component-wrapper {
    margin: 16px 0;
    padding: 16px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 8px;
    background: var(--background-secondary);
  }

  .auth-success {
    text-align: center;
    margin: 24px 0;
  }

  .auth-success h2 {
    margin: 0 0 12px 0;
    font-size: 18px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .auth-success-info {
    margin: 20px 0;
    text-align: left;
    max-width: 300px;
    margin-left: auto;
    margin-right: auto;
  }

  .success-feature {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 8px 0;
    font-size: 13px;
    color: var(--text-normal);
  }

  /* FTP credentials slide styles */
  .ftp-credentials-slide {
    text-align: center;
  }

  .ftp-icon {
    font-size: 48px;
    margin-bottom: 16px;
  }

  .ftp-security-note {
    margin: 16px 0;
    padding: 12px;
    background: var(--background-secondary);
    border-radius: 6px;
    border: 1px solid var(--color-green);
  }

  .security-highlight {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 13px;
    color: var(--text-normal);
  }

  .security-icon {
    font-size: 16px;
    color: var(--color-green);
    flex-shrink: 0;
  }

  .ftp-generate-section {
    margin: 24px 0;
  }

  .ftp-info {
    background: var(--background-secondary);
    border-radius: 8px;
    padding: 20px;
    margin: 20px 0;
    text-align: left;
  }

  .ftp-info h3 {
    margin: 0 0 12px 0;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-normal);
    text-align: center;
  }

  .ftp-benefits {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .ftp-benefit {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 8px 0;
    font-size: 13px;
    color: var(--text-normal);
  }

  .generate-ftp-button {
    margin: 20px 0;
  }

  .ftp-credentials-display {
    text-align: center;
    margin: 24px 0;
  }

  .ftp-credentials-display h3 {
    margin: 0 0 12px 0;
    font-size: 16px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .credentials-container {
    background: var(--background-secondary);
    border-radius: 8px;
    padding: 20px;
    margin: 20px 0;
    text-align: left;
  }

  .credential-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 0;
    border-bottom: 1px solid var(--background-modifier-border);
  }

  .credential-row:last-child {
    border-bottom: none;
  }

  .credential-label {
    font-weight: 500;
    color: var(--text-muted);
    min-width: 80px;
  }

  .credential-value-container {
    display: flex;
    align-items: center;
    gap: 8px;
    flex: 1;
    justify-content: flex-end;
  }

  .credential-value {
    background: var(--background-modifier-border);
    padding: 4px 8px;
    border-radius: 4px;
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
    font-size: 12px;
    color: var(--text-normal);
    max-width: 150px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  .ftp-setup-note {
    margin-top: 20px;
    padding: 12px;
    background: var(--background-modifier-border);
    border-radius: 6px;
  }

  .ftp-setup-note p {
    margin: 0;
    font-size: 13px;
    color: var(--text-muted);
  }

  /* Completion slide styles */
  .completion-slide {
    text-align: center;
  }

  .completion-celebration {
    font-size: 64px;
    margin-bottom: 16px;
    animation: bounce 1s ease-in-out;
  }

  @keyframes bounce {
    0%, 20%, 60%, 100% {
      transform: translateY(0);
    }
    40% {
      transform: translateY(-10px);
    }
    80% {
      transform: translateY(-5px);
    }
  }

  .completion-summary {
    margin: 24px 0;
    text-align: left;
    max-width: 400px;
    margin-left: auto;
    margin-right: auto;
  }

  .completion-summary h3 {
    margin: 0 0 16px 0;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-normal);
    text-align: center;
  }

  .accomplishments {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .accomplishment {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 8px 12px;
    background: var(--background-secondary);
    border-radius: 6px;
    font-size: 13px;
    color: var(--text-normal);
  }

  .accomplishment-icon {
    font-size: 16px;
    flex-shrink: 0;
  }

  .accomplishment-status {
    margin-left: auto;
    color: var(--color-green);
    font-weight: 600;
  }

  .completion-actions {
    margin: 32px 0 0 0;
  }

  .start-journaling-button {
    margin-bottom: 20px;
    padding: 16px 32px !important;
    font-size: 18px !important;
    font-weight: 600 !important;
    min-width: 240px !important;
    background: linear-gradient(135deg, var(--interactive-accent), var(--interactive-accent-hover)) !important;
    border: 2px solid var(--interactive-accent) !important;
    box-shadow: 0 4px 12px rgba(var(--interactive-accent-rgb, 124, 77, 255), 0.3) !important;
    transform: scale(1);
    transition: all 0.3s ease !important;
  }

  .start-journaling-button:hover:not(:disabled) {
    transform: scale(1.05);
    box-shadow: 0 6px 20px rgba(var(--interactive-accent-rgb, 124, 77, 255), 0.4) !important;
    background: linear-gradient(135deg, var(--interactive-accent-hover), var(--interactive-accent)) !important;
  }

  .start-journaling-button:active {
    transform: scale(0.98);
  }

  .completion-links {
    display: flex;
    justify-content: center;
    gap: 16px;
    flex-wrap: wrap;
  }

  .completion-link {
    color: var(--interactive-accent);
    text-decoration: none;
    font-size: 12px;
    padding: 4px 8px;
    border-radius: 4px;
    transition: background-color 0.2s ease;
  }

  .completion-link:hover {
    background: var(--interactive-accent-hover);
    color: var(--text-on-accent);
  }

  .wizard-progress-container {
    margin-bottom: 16px;
  }

  .wizard-steps {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
  }

  .wizard-step {
    display: flex;
    flex-direction: column;
    align-items: center;
    flex: 1;
    position: relative;
  }

  .wizard-step-circle {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: var(--background-modifier-border);
    color: var(--text-muted);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    font-weight: 600;
    transition: all 0.2s ease;
  }

  .wizard-step.current .wizard-step-circle {
    background: var(--interactive-accent);
    color: var(--text-on-accent);
  }

  .wizard-step.completed .wizard-step-circle {
    background: var(--color-green);
    color: white;
  }

  .wizard-step-label {
    margin-top: 8px;
    font-size: 12px;
    color: var(--text-muted);
    text-align: center;
    max-width: 110px;

    /* keep every label exactly two lines high */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
    overflow: hidden;
    line-height: 1.2;
    min-height: 2.4em;
  }

  .wizard-progress-track {
    height: 4px;
    background: var(--background-modifier-border);
    border-radius: 2px;
    overflow: hidden;
  }

  .wizard-progress-fill {
    height: 100%;
    background: var(--interactive-accent);
    transition: width 0.3s ease;
  }

  .modal-error {
    margin: 16px 0;
    padding: 8px 12px;
    background: var(--background-modifier-error);
    border: 1px solid var(--text-error);
    border-radius: 4px;
    color: var(--text-on-accent, #ffffff);
    font-size: 13px;
    font-weight: 500;
    text-align: center;
  }

  .modal-actions {
    display: flex;
    gap: 12px;
    margin-top: 0px;
    justify-content: center;
    flex-wrap: wrap;
  }

  .modal-actions button {
    min-width: 90px;
  }

  .modal-footer {
    margin-top: 0px;
    padding-top: 0px;
    border-top: none;
  }

  .modal-footer-text {
    margin: 0;
    font-size: 12px;
    color: var(--text-muted);
    line-height: 1.3;
    text-align: center;
  }

  /* Skip-link: small, subtle, bottom-right */
  .skip-link {
    position: absolute;
    bottom: 16px;
    right: 20px;
    background: none;
    border: none;
    font-size: 12px;
    color: var(--text-muted);
    cursor: pointer;
    padding: 4px 8px;
    border-radius: 4px;
    transition: all 0.2s ease;
    z-index: 10; /* Ensure it stays above other content */
  }
  
  .skip-link:hover {
    color: var(--interactive-accent);
    background: var(--background-modifier-hover);
    text-decoration: none;
  }
  
  .skip-link:focus {
    outline: 2px solid var(--interactive-accent);
    outline-offset: 2px;
  }
  
  .skip-link:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }

  @media (max-width: 480px) {
    .onboarding-wizard-modal {
      padding: 16px;
      max-width: 100%;
    }
    
    .modal-actions {
      flex-direction: column;
    }
    
    .modal-actions button {
      width: 100%;
    }

    .wizard-step-label {
      display: none;
    }
    
    .skip-link {
      position: static;
      margin-top: 16px;
      text-align: center;
      display: block;
      width: fit-content;
      margin-left: auto;
      margin-right: auto;
    }
  }
`;we.onboardingWizardModal={inject:qI,remove:$B}});function UB(){if(document.head.querySelector("#skeleton-styles"))return;let e=document.createElement("style");e.id="skeleton-styles",e.textContent=vMe,document.head.appendChild(e)}function lee(){var e;(e=document.head.querySelector("#skeleton-styles"))==null||e.remove()}function tl(){UB()}var vMe,ff=F(()=>{vMe=`
@keyframes shimmer {
  0% {
    background-position: -1000px 0;
  }
  100% {
    background-position: 1000px 0;
  }
}

.skeleton-shimmer {
  background: linear-gradient(
    90deg,
    var(--background-secondary) 0%,
    var(--background-modifier-border) 50%,
    var(--background-secondary) 100%
  );
  background-size: 1000px 100%;
  animation: shimmer 2s infinite linear;
  pointer-events: none;
  user-select: none;
}
`});var cee={};Ti(cee,{ensureAccountPageStyles:()=>lh,ensureAccountWeightBarStyles:()=>zI,ensureAllDRCStyles:()=>yMe,ensureChartStyles:()=>IB,ensureComboBoxStyles:()=>OI,ensureDRCMissedTradesStyles:()=>DB,ensureDRCStyles:()=>GT,ensureDashboardStyles:()=>LI,ensureImageStyles:()=>DJ,ensureMissedTradeNoteStyles:()=>t0,ensureMonthlyReviewStyles:()=>VZ,ensureOnboardingWizardModalStyles:()=>see,ensureSharedStyles:()=>dy,ensureSkeletonStyles:()=>tl,ensureTradeLogMiniHeaderStyles:()=>RI,ensureTradeLogSettingsModalStyles:()=>_I,ensureTradeNoteStyles:()=>sh,ensureWeeklyReviewStyles:()=>RZ,forceDashboardStyles:()=>cy,injectBatchActionToolbarStyles:()=>BI,injectDropdownFixScript:()=>Gx,injectSettingsTabStyles:()=>AI,injectSkeletonStyles:()=>UB,injectStylesIntoDocument:()=>e0,removeBatchActionToolbarStyles:()=>WI,removeDropdownFixScript:()=>uI,removeInjectedStyles:()=>Wu,removeSkeletonStyles:()=>lee,removeTradeLogMiniHeaderStyles:()=>UI});function yMe(){GT(),ZZ(),DB()}var rl=F(()=>{yB();xB();wB();kB();GZ();YZ();TB();PB();eh();eee();tee();QT();qE();XT();NB();OB();aee();_B();BB();WB();RB();ff()});function VI(){if(document.head.querySelector("#trade-form-styles"))return;let e=document.createElement("style");e.id="trade-form-styles",e.textContent=bMe,document.head.appendChild(e)}function GI(){let e=document.head.querySelector("#trade-form-styles");e&&e.remove()}var bMe,HB=F(()=>{bMe=`
  /* Trade Form Modal Styles */
  .trade-form-modal-container .modal-title {
    margin-bottom: 16px;
  }

  /* Modal content styling */
  .trade-form-modal-container {
    max-height: var(--modal-content-height);
    overflow-y: auto;
  }

  /* Trade Form Custom Styles */
  /* Ensure proper overflow handling in container */
  .trade-form-view-container {
    --interactive-accent-rgb: 83, 141, 226;
    --color-error-rgb: 229, 57, 53;
    height: 100% !important;
    overflow-y: auto !important;
    position: relative !important;
    display: flex !important;
    flex-direction: column !important;
    padding: 0 !important;
    margin: 0 !important;
    box-sizing: border-box !important;
  }
  .trade-form-view-container .formContainer {
    display: flex !important;
    flex-direction: column !important;
    gap: 12px !important; /* Consistent gap between all form elements */
    max-width: 800px !important;
    margin: 0 auto !important;
    padding: 16px 20px !important;
    width: 100% !important;
    flex: 1 1 auto !important; /* Allow container to grow/shrink */
    min-height: min-content !important; /* Ensure it's at least as tall as content */
    box-sizing: border-box !important; /* Ensure padding is included in width */
  }
  .trade-form-view-container .formSection {
    display: flex !important;
    flex-direction: column !important;
    padding: 0 !important;
    margin: 0 !important; /* Remove all section margins */
    position: relative !important;
  }
  
  /* Remove all spacing between sections */
  .trade-form-view-container .formSection + .formSection {
    padding: 0 !important;
    margin: 0 !important;
  }
  .trade-form-view-container .sectionTitle {
    font-size: 18px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    margin-bottom: 4px !important;
    display: none !important; /* Hide the original section title */
  }
  .trade-form-view-container .minimizedSectionTitle {
    font-size: 16px !important;
    font-weight: 500 !important;
    color: var(--text-muted) !important;
    margin-bottom: 8px !important;
    text-transform: uppercase !important;
    letter-spacing: 0.5px !important;
  }
  .trade-form-view-container .sectionDescription {
    font-size: 16px !important;
    color: var(--text-muted) !important;
    margin-bottom: 16px !important;
    display: none !important; /* Hide the section description */
  }
  .trade-form-view-container .formTitle {
    font-size: 20px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    margin-bottom: 8px !important;
  }
  .trade-form-view-container .sectionContent {
    display: flex !important;
    flex-direction: column !important;
    gap: 12px !important; /* Consistent gap matching form container */
    margin: 0 !important;
    padding: 0 !important;
  }
  
  .trade-form-view-container .field {
    margin: 0 !important; /* Remove all field margins */
    padding: 0 !important; /* Remove all field padding */
  }
  .trade-form-view-container input,
  .trade-form-view-container textarea {
    box-sizing: border-box !important;
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    color: var(--text-normal) !important;
    border-radius: 4px !important;
    padding: 8px 12px !important;
    width: 100% !important;
    font-size: 16px !important;
  }

  /* Placeholder styling for inputs */
  .trade-form-view-container input::placeholder,
  .trade-form-view-container textarea::placeholder {
    color: var(--text-muted) !important;
    opacity: 0.7 !important;
  }
  /* Specific styles for select elements to fix text cutoff */
  .trade-form-view-container select,
  .trade-form-view-container .journalit-select {
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    color: var(--text-normal) !important;
    border-radius: 4px !important;
    padding: 8px 30px 8px 12px !important; /* Extra right padding for dropdown arrow */
    width: 100% !important;
    font-size: 16px !important;
    min-height: 38px !important; /* Ensure minimum height */
    line-height: 1.5 !important; /* Improve text rendering */
    text-overflow: ellipsis !important; /* Show ellipsis for long text */
  }

  /* Style for select with no value selected (to show grey placeholder) */
  .trade-form-view-container select:invalid,
  .trade-form-view-container select:not([value]),
  .trade-form-view-container select[value=""] {
    color: var(--text-muted) !important;
    opacity: 0.7 !important; /* Match input placeholder opacity */
  }

  /* Make sure selected values display normally */
  .trade-form-view-container select[data-has-value="true"] {
    color: var(--text-normal) !important;
    opacity: 1 !important;
  }

  /* Make the select placeholder text appear greyed out */
  .trade-form-view-container select option[value=""][disabled],
  .trade-form-view-container select option:first-child:not([value]),
  .trade-form-view-container select option:first-child[value=""],
  .trade-form-view-container .select-placeholder,
  .trade-form-view-container option.select-placeholder {
    color: var(--text-muted) !important;
    opacity: 0.7 !important;
  }

  /* Make sure all option values display normally */
  .trade-form-view-container select option:not([value=""]):not(:disabled),
  .trade-form-view-container select option:not(.select-placeholder),
  .trade-form-view-container select option:checked {
    color: var(--text-normal) !important;
    opacity: 1 !important;
  }
  /* Fix for date input fields to prevent text from overlapping with calendar icon */
  .trade-form-view-container input[type="date"] {
    padding-left: 35px !important; /* Move text to the right to make room for the calendar icon */
    padding-right: 15px !important;
    min-width: 150px !important; /* Ensure minimum width for date inputs */
  }
  /* Fix for time input fields to move clock icon to the left */
  .trade-form-view-container input[type="time"] {
    padding-left: 35px !important; /* Move text to the right to make room for the clock icon */
    padding-right: 15px !important;
    min-width: 110px !important; /* Ensure minimum width for time inputs */
  }
  /* Target the calendar picker indicator to move it to the left */
  .trade-form-view-container input[type="date"]::-webkit-calendar-picker-indicator,
  .trade-form-view-container input[type="time"]::-webkit-calendar-picker-indicator {
    position: absolute !important;
    left: 10px !important;
    top: 50% !important;
    transform: translateY(-50%) !important;
    margin: 0 !important;
    z-index: 2 !important; /* Ensure the icon appears above other elements */
  }
  /* Alternative method using appearance property */
  .trade-form-view-container input[type="date"],
  .trade-form-view-container input[type="time"] {
    position: relative !important;
    appearance: none !important;
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    background-image: var(--calendar-icon, initial) !important;
    background-repeat: no-repeat !important;
    background-position: 10px center !important;
  }
  /* Provide calendar icon as background */
  .trade-form-view-container input[type="date"] {
    /* Default icon will be provided by the browser */
  }
  /* Provide clock icon as background */
  .trade-form-view-container input[type="time"] {
    /* Default icon will be provided by the browser */
  }
  /* Support for Firefox */
  @-moz-document url-prefix() {
    .trade-form-view-container input[type="date"],
    .trade-form-view-container input[type="time"] {
      position: relative !important;
      background-position: 10px center !important;
    }
  }
  /* Ensure proper scrolling for the entire container */
  body {
    overflow: hidden !important; /* Prevent double scrollbars */
  }
  /* Ensure proper scrolling for main container */
  .trade-form-view-container {
    overflow-y: auto !important; /* Enable vertical scrolling */
    max-height: 100vh !important; /* Limit to viewport height */
  }
  
  /* Eliminate double scrollbars when the trade form is rendered inside an Obsidian modal */
  .modal .trade-form-view-container,
  .modal-content .trade-form-view-container {
    height: auto !important;
    max-height: none !important;
    overflow: visible !important; /* Let the modal content handle scrolling */
  }
  /* React root element should expand properly */
  #trade-form-root {
    height: 100% !important;
    min-height: 100% !important;
    display: flex !important;
    flex-direction: column !important;
    flex: 1 1 auto !important;
  }
  /* Form container needs to expand fully */
  .formContainer {
    display: flex !important;
    flex-direction: column !important;
    min-height: min-content !important;
    height: auto !important; /* Prevent inner container from managing its own scrolling */
    flex: 1 1 auto !important;
    overflow: visible !important; /* Avoid nested scrollbars inside modal */
  }
  /* Removing extra gap between form title and first section */
  .trade-form-view-container .formHeader {
    margin-bottom: 0 !important;
    padding-bottom: 0 !important;
  }

  /* Reduce the spacing between form elements */
  .trade-form-view-container > div, 
  .trade-form-view-container > form > div {
    margin-bottom: 0 !important;
  }

  /* Fix the gap at the top of the form */
  .trade-form-view-container .formHeader + div,
  .trade-form-view-container .formHeader + .formSection {
    margin-top: 0 !important;
  }

  /* Fix the specific gap between form title and first section */
  .trade-form-view-container .formTitle + .formSection,
  .trade-form-view-container .formHeader + .formSection,
  .trade-form-view-container .errorSummary + .formSection {
    margin-top: 12px !important;
  }
  /* ComboBox specific styles - attribute-based selectors for Obsidian compatibility */
  .trade-form-view-container .combobox-container,
  .trade-form-view-container [data-combobox-type] {
    position: relative !important;
    width: 100% !important;
    margin-bottom: 8px !important;
    /* Use higher z-index when dropdown is open to ensure it stays above other elements */
    z-index: 10 !important;
  }

  /* Increase z-index when dropdown is open to ensure it stays above other elements */
  .trade-form-view-container [data-is-open="true"] {
    z-index: 9999 !important;
  }

  /* Style for input container to properly position dropdown */
  .trade-form-view-container [data-combobox-type] > .input-container {
    position: relative !important;
    margin: 0 !important;
    padding: 0 !important;
    /* Ensure it's above other elements but below the dropdown */
    z-index: 1 !important;
  }

  /* Styling for selected items in multi-select */
  .trade-form-view-container .selected-item {
    display: inline-flex !important;
    align-items: center !important;
    margin: 0 4px 4px 0 !important;
    padding: 4px 8px !important;
    background-color: var(--interactive-accent) !important;
    color: white !important;
    border-radius: 4px !important;
    font-size: 12px !important;
    gap: 6px !important;
  }

  .trade-form-view-container .selected-item button {
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    width: 16px !important;
    height: 16px !important;
    min-width: 16px !important; /* Prevent shrinking */
    min-height: 16px !important; /* Prevent shrinking */
    padding: 0 !important;
    background: rgba(255, 255, 255, 0.2) !important; /* Add visible background */
    border: none !important;
    color: white !important;
    font-size: 16px !important;
    line-height: 1 !important;
    cursor: pointer !important;
    border-radius: 50% !important; /* Make it round */
    margin-left: 4px !important;
    position: relative !important; /* Create stacking context */
    z-index: 5 !important; /* Ensure it's above other elements */
    transition: background-color 0.2s !important;
  }

  .trade-form-view-container .selected-item button:hover {
    background: rgba(255, 255, 255, 0.4) !important; /* Brighter on hover */
  }

  .trade-form-view-container [data-combobox-type] > div:nth-child(2) {
    position: relative !important;
    width: 100% !important;
  }
  /* Add dropdown caret to the input container */
  .trade-form-view-container [data-combobox-type] .input-container::after {
    content: "" !important;
    position: absolute !important;
    right: 12px !important;
    top: 50% !important;
    transform: translateY(-50%) !important;
    width: 0 !important;
    height: 0 !important;
    border-left: 5px solid transparent !important;
    border-right: 5px solid transparent !important;
    border-top: 5px solid var(--text-normal) !important;
    pointer-events: none !important;
    z-index: 10 !important;
  }
  /* Rotate caret when dropdown is open */
  .trade-form-view-container [data-combobox-type][data-is-open="true"] .input-container::after {
    transform: translateY(-50%) rotate(180deg) !important;
  }
  .trade-form-view-container [data-combobox-type] input[role="combobox"] {
    width: 100% !important;
    padding: 8px 12px !important;
    padding-right: 30px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    font-size: 16px !important;
    cursor: pointer !important;
  }
  /* When dropdown is open, change input border radius */
  .trade-form-view-container [data-combobox-type][data-is-open="true"] input[role="combobox"] {
    border-bottom-left-radius: 0 !important;
    border-bottom-right-radius: 0 !important;
  }
  .trade-form-view-container [data-combobox-type] input[role="combobox"]:focus {
    border-color: var(--interactive-accent) !important;
    box-shadow: 0 0 0 2px rgba(83, 141, 226, 0.3) !important;
    outline: none !important;
  }
  /* Dropdown list styling */
  .trade-form-view-container [data-combobox-type] ul[role="listbox"] {
    position: absolute !important;
    top: 38px !important; /* Position exactly at the bottom of input by using a fixed value */
    left: 0 !important;
    right: 0 !important;
    max-height: 200px !important;
    overflow-y: auto !important;
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-top: none !important; /* Remove top border to create seamless connection */
    border-radius: 0 0 4px 4px !important; /* Only round the bottom corners */
    margin-top: -1px !important; /* Negative margin to pull up and overlap with input border */
    z-index: 9999 !important; /* Higher z-index to ensure dropdown stays above other elements */
    list-style: none !important;
    padding: 0 !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
    animation: dropdown-fade-in 150ms ease-out !important;
    pointer-events: auto !important; /* Ensure clicks on the dropdown are detected */
  }
  /* Dropdown option styling */
  .trade-form-view-container [data-combobox-type] ul[role="listbox"] li {
    padding: 8px 12px !important;
    cursor: pointer !important;
    transition: background-color 150ms ease !important;
    margin: 0 !important;
  }
  /* Hover and highlighted state for options */
  .trade-form-view-container [data-combobox-type] ul[role="listbox"] li:hover,
  .trade-form-view-container [data-combobox-type] ul[role="listbox"] li[aria-selected="true"] {
    background-color: var(--background-secondary) !important;
  }
  /* Multi-select tags container */
  .trade-form-view-container [data-combobox-type="multi"] > div:first-of-type {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 4px !important;
    margin-bottom: 4px !important;
  }
  /* Individual tag styling */
  .trade-form-view-container [data-combobox-type="multi"] > div:first-of-type > span {
    display: inline-flex !important;
    align-items: center !important;
    padding: 2px 8px !important;
    background-color: var(--interactive-accent) !important;
    color: white !important;
    border-radius: 4px !important;
    font-size: 12px !important;
  }
  /* Remove button in tags */
  .trade-form-view-container [data-combobox-type="multi"] > div:first-of-type > span > button {
    background: none !important;
    border: none !important;
    color: white !important;
    cursor: pointer !important;
    font-size: 16px !important;
    line-height: 1 !important;
    padding: 0 4px !important;
    margin-left: 4px !important;
    /* Enhanced pointer events to ensure clicks are registered */
    pointer-events: auto !important;
    /* Make the button visually stand out more */
    opacity: 0.8 !important;
    transition: opacity 0.2s !important;
  }
  /* Add hover effects to make it clear it's clickable */
  .trade-form-view-container [data-combobox-type="multi"] > div:first-of-type > span > button:hover {
    opacity: 1 !important;
  }
  /* Special styling for "Add new" option */
  .trade-form-view-container [data-combobox-type] ul[role="listbox"] li[data-add-option="true"] {
    font-style: italic !important;
    border-top: 1px dashed var(--background-modifier-border) !important;
  }
  /* Animation for dropdown appearance */
  @keyframes dropdown-fade-in {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  /* Fix for option visibility in dropdowns */
  .trade-form-view-container select option {
    padding: 8px 12px !important;
    font-size: 16px !important;
    line-height: 1.5 !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
  }

  /* Make the select placeholder text appear greyed out */
  .trade-form-view-container select option[value=""][disabled],
  .trade-form-view-container select option:first-child:not([value]),
  .trade-form-view-container select option:first-child[value=""],
  .trade-form-view-container .select-placeholder,
  .trade-form-view-container option.select-placeholder {
    color: var(--text-muted) !important;
    font-style: italic !important; 
  }
  .trade-form-view-container input:focus,
  .trade-form-view-container select:focus,
  .trade-form-view-container textarea:focus {
    border-color: var(--interactive-accent) !important;
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.3) !important;
    outline: none !important;
  }
  .trade-form-view-container .label {
    display: block !important;
    font-size: 13px !important;
    font-weight: 500 !important;
    margin-bottom: 4px !important;
    color: var(--text-normal) !important;
  }
  .trade-form-view-container .errorMessage {
    font-size: 11px !important;
    color: var(--text-error) !important;
    margin-top: 2px !important;
    padding-left: 1px !important;
  }
  .trade-form-view-container button {
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    padding: 8px 16px !important;
    border-radius: 4px !important;
    cursor: pointer !important;
    font-weight: 500 !important;
    font-size: 16px !important;
  }
  .trade-form-view-container button.primary {
    background-color: var(--interactive-accent) !important;
    color: var(--text-on-accent) !important;
    border: 1px solid var(--interactive-accent) !important;
  }
  .trade-form-view-container button.primary:hover:not(:disabled) {
    background-color: var(--interactive-accent-hover) !important;
    border-color: var(--interactive-accent-hover) !important;
  }
  .trade-form-view-container button.outline {
    background-color: transparent !important;
    color: var(--interactive-accent) !important;
    border: 1px solid var(--interactive-accent) !important;
  }
  .trade-form-view-container button.outline:hover:not(:disabled) {
    background-color: rgba(var(--interactive-accent-rgb), 0.1) !important;
  }
  /* Style for default values like 0.00 to make them look like placeholders */
  .trade-form-view-container input.default-value {
    color: var(--text-muted) !important;
    font-style: italic !important;
  }
  /* When a default value input is focused, reset the text style */
  .trade-form-view-container input.default-value:focus {
    color: var(--text-normal) !important;
    font-style: normal !important;
  }
  .trade-form-view-container .formActions {
    display: flex !important;
    justify-content: space-between !important;
    gap: 16px !important;
    margin-top: 4px !important; /* Small top margin */
    margin-bottom: 16px !important; /* Reduced bottom margin */
    padding: 0 !important;
  }
  .trade-form-view-container .twoColumnLayout {
    display: grid !important;
    grid-template-columns: 1fr 1fr !important;
    gap: 12px !important; /* Match other gaps */
    margin: 0 !important;
    padding: 0 !important;
  }
  /* Date picker container styling */
  .trade-form-view-container .date-picker-container {
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important;
  }
  @media (max-width: 600px) {
    .trade-form-view-container .twoColumnLayout {
      grid-template-columns: 1fr !important;
    }
  }
  .trade-form-view-container .calculatedValue {
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    text-align: center !important;
    padding: 12px !important;
    background-color: var(--background-secondary) !important;
    border-radius: 4px !important;
    margin: 0 !important; /* Remove all margins to maintain consistent spacing */
    width: 100% !important;
  }
  .trade-form-view-container .calculatedLabel {
    font-size: 12px !important;
    color: var(--text-muted) !important;
  }
  .trade-form-view-container .calculatedAmount {
    font-size: 18px !important;
    font-weight: 600 !important;
  }
  .trade-form-view-container .positive {
    color: var(--color-green) !important;
  }
  .trade-form-view-container .negative {
    color: var(--color-red) !important;
  }
  .trade-form-view-container .neutral {
    color: var(--text-normal) !important;
  }

  /* Asset Type Button Styles - Pill Style */
  .trade-form-view-container .asset-type-container {
    display: grid !important;
    grid-template-columns: repeat(3, 1fr) !important;
    grid-template-rows: repeat(2, 1fr) !important;
    gap: 8px !important;
    width: 100% !important;
    margin-bottom: 12px !important;
  }

  .trade-form-view-container .asset-type-button {
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 6px !important;
    padding: 8px 4px !important;
    font-size: 13px !important;
    height: 34px !important;
    transition: background-color 0.2s, border-color 0.2s !important;
    cursor: pointer !important;
    margin: 0 !important;
  }

  .trade-form-view-container .asset-type-button[aria-checked="true"] {
    background-color: var(--interactive-accent) !important;
    border-color: var(--interactive-accent) !important;
    color: white !important;
    font-weight: 500 !important;
  }

  .trade-form-view-container .asset-type-button:hover:not([aria-checked="true"]) {
    background-color: var(--background-secondary-alt) !important;
  }

  /* Asset-specific fields styling for consistent spacing */
  .trade-form-view-container .asset-specific-fields {
    display: flex !important;
    flex-direction: column !important;
    gap: 12px !important; /* Match the gap used in form container and section content */
    width: 100% !important;
    margin-bottom: 12px !important; /* Match other section spacing */
  }

  /* Direction Button Styles - Using the same pill style as Asset Type buttons */
  .trade-form-view-container .direction-container {
    display: flex !important;
    width: 100% !important;
    gap: 8px !important;
    margin-bottom: 12px !important;
  }

  .trade-form-view-container .direction-button {
    flex: 1 !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 6px !important;
    padding: 8px 4px !important;
    font-size: 13px !important;
    height: 34px !important;
    transition: background-color 0.2s, border-color 0.2s !important;
    cursor: pointer !important;
    margin: 0 !important;
  }

  /* Remove border-right as we're now using individual pills */
  /* .trade-form-view-container .direction-button:not(:last-child) {
    border-right: 1px solid var(--background-modifier-border) !important;
  } */

  .trade-form-view-container .direction-button[aria-checked="true"] {
    background-color: var(--interactive-accent) !important;
    color: white !important;
  }

  .trade-form-view-container .direction-button:hover:not([aria-checked="true"]) {
    background-color: var(--background-secondary-alt) !important;
  }

  /* Required field indicator */
  .trade-form-view-container .required-indicator {
    color: var(--text-error) !important;
    margin-left: 4px !important;
    font-weight: bold !important;
  }

  .trade-form-view-container .thesisField {
    min-height: 100px !important;
  }
  .trade-form-view-container .tagContainer {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 4px !important;
    margin-top: 4px !important;
  }
  .trade-form-view-container .tag {
    display: inline-flex !important;
    align-items: center !important;
    padding: 4px 8px !important;
    background-color: var(--background-secondary) !important;
    border-radius: 2px !important;
    font-size: 12px !important;
    gap: 4px !important;
  }
  .trade-form-view-container .removeTag {
    cursor: pointer !important;
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    width: 16px !important;
    height: 16px !important;
    border-radius: 50% !important;
    background-color: rgba(0, 0, 0, 0.1) !important;
  }
  .trade-form-view-container .errorSummary {
    background-color: rgba(229, 57, 53, 0.05) !important;
    border: 1px solid rgba(229, 57, 53, 0.5) !important;
    color: var(--text-error) !important;
    padding: 10px 12px !important;
    border-radius: 4px !important;
    margin-bottom: 16px !important;
    font-size: 13px !important;
    line-height: 1.4 !important;
    font-weight: 400 !important;
    box-shadow: none !important;
  }

  @keyframes errorPulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.02); }
    100% { transform: scale(1); }
  }

  /* Drag and drop styles */
  .trade-form-view-container .formContainer.is-dragging-over {
    position: relative !important;
  }

  .trade-form-view-container .drag-overlay {
    position: fixed !important; /* Fixed to viewport instead of absolute */
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    background-color: rgba(var(--background-primary-rgb, 255, 255, 255), 0.4) !important; /* Reduced opacity */
    backdrop-filter: blur(3px) !important;
    -webkit-backdrop-filter: blur(3px) !important;
    display: flex !important;
    justify-content: center !important;
    align-items: center !important;
    z-index: 9999 !important;
    animation: fade-in 0.2s ease-out !important;
  }

  .trade-form-view-container .drag-message-container {
    position: fixed !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important; /* Center in viewport */
    z-index: 10000 !important;
  }

  .trade-form-view-container .drag-message {
    font-size: 22px !important;
    font-weight: 400 !important; /* Lighter weight */
    font-family: var(--font-interface, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif) !important;
    color: var(--interactive-accent) !important;
    background-color: rgba(var(--background-primary-rgb, 255, 255, 255), 0.7) !important; /* Reduced opacity */
    padding: 14px 28px !important;
    border-radius: 6px !important;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08) !important; /* More subtle shadow */
    letter-spacing: 0.5px !important;
    border: 1px solid rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.5) !important; /* Semi-transparent border */
    white-space: nowrap !important;
  }

  /* Responsive styles for small screens */
  @media (max-width: 600px) {
    .trade-form-view-container input,
    .trade-form-view-container textarea,
    .trade-form-view-container select,
    .trade-form-view-container .journalit-select {
      font-size: 18px !important;
    }
  }

  @keyframes fade-in {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  @keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
  }

  /* Tab Navigation */
  .trade-form-view-container .journalit-tab-nav {
    display: flex;
    border-bottom: 1px solid var(--background-modifier-border);
    margin-bottom: 20px;
    justify-content: center;
    width: 100%;
    padding-top: 10px;
    padding-bottom: 0;
    position: sticky;
    top: -10px;
    background-color: var(--background-primary);
    z-index: 100;
  }

  .trade-form-view-container .journalit-tab-wrapper {
    display: flex;
    justify-content: center;
    flex: 1;
  }

  .trade-form-view-container .journalit-tab-button {
    background: transparent;
    border: none;
    border-bottom: 2px solid transparent;
    padding: 10px 20px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    color: var(--text-muted);
    transition: all 0.2s ease;
    position: relative;
  }

  .trade-form-view-container .journalit-tab-button:hover {
    color: var(--text-normal);
    background-color: var(--background-modifier-hover);
  }

  .trade-form-view-container .journalit-tab-button.journalit-tab-active {
    color: var(--text-normal);
    font-weight: 600;
    border-bottom-color: var(--text-accent);
  }

  .trade-form-view-container .journalit-tab-error-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    background-color: var(--text-error);
    color: white;
    border-radius: 10px;
    font-size: 10px;
    font-weight: 600;
    padding: 2px 6px;
    margin-left: 6px;
    min-width: 18px;
  }

  /* Edit Mode Badge */
  .trade-form-view-container .journalit-edit-badge {
    position: absolute;
    right: 16px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 12px;
    color: white;
    background-color: var(--interactive-accent);
    padding: 4px 10px;
    border-radius: 12px;
    font-weight: 700;
    letter-spacing: 0.8px;
    text-transform: uppercase;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12);
  }

  /* Image URL Input Styles */
  .trade-form-view-container .journalit-image-url-container {
    display: flex !important;
    align-items: center !important;
    gap: 0.5rem !important;
    margin-top: 0.5rem !important;
  }

  .trade-form-view-container .journalit-image-url-input {
    flex: 1 !important;
    padding: 0.5rem !important;
    background: var(--background-secondary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: var(--radius-s) !important;
    color: var(--text-normal) !important;
    font-size: 0.9em !important;
  }

  .trade-form-view-container .journalit-image-url-input.has-error {
    border-color: var(--text-error) !important;
  }

  .trade-form-view-container .journalit-image-url-button {
    padding: 0.5rem 1rem !important;
    background: var(--background-secondary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: var(--radius-s) !important;
    color: var(--text-muted) !important;
    cursor: not-allowed !important;
    font-size: 0.9em !important;
    font-weight: 500 !important;
  }

  .trade-form-view-container .journalit-image-url-button.is-active {
    background: var(--interactive-accent) !important;
    color: var(--text-on-accent) !important;
    cursor: pointer !important;
  }

  .trade-form-view-container .journalit-image-url-error {
    color: var(--text-error) !important;
    font-size: 0.8em !important;
    margin-top: 0.25rem !important;
  }
`});function wMe(){if(document.getElementById(dee))return;let e=document.createElement("style");e.id=dee,e.textContent=xMe,document.head.appendChild(e)}function uee(){wMe()}var xMe,dee,pee=F(()=>{xMe=`
/* Radio Option Group - Default variant */
.radio-options {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.radio-option {
  display: flex;
  align-items: flex-start;
  gap: 10px;
  padding: 10px;
  border: 2px solid var(--background-modifier-border);
  border-radius: 6px;
  background: var(--background-primary);
  cursor: pointer;
  transition: all 0.2s ease;
}

.radio-option:hover {
  border-color: var(--interactive-accent-hover);
  background: var(--background-secondary);
}

.radio-option.selected {
  border-color: var(--interactive-accent);
  background: var(--background-secondary);
}

.option-radio {
  width: 16px;
  height: 16px;
  border: 2px solid var(--background-modifier-border);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  margin-top: 1px;
}

.radio-option.selected .option-radio {
  border-color: var(--interactive-accent);
}

.radio-inner {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: transparent;
  transition: background 0.2s ease;
}

.radio-inner.selected {
  background: var(--interactive-accent);
}

.option-content {
  flex: 1;
}

.option-label {
  display: block;
  font-size: 13px;
  font-weight: 500;
  color: var(--text-normal);
  margin-bottom: 2px;
}

.option-description {
  display: block;
  font-size: 11px;
  color: var(--text-muted);
  line-height: 1.3;
}

/* Radio Option Group - Goal variant (larger cards) */
.goal-options {
  display: flex;
  flex-direction: column;
  gap: 16px;
  margin: 24px 0;
  text-align: left;
}

.goal-option {
  display: flex;
  align-items: flex-start;
  gap: 12px;
  padding: 16px;
  border: 2px solid var(--background-modifier-border);
  border-radius: 8px;
  background: var(--background-primary);
  cursor: pointer;
  transition: all 0.2s ease;
}

.goal-option:hover {
  border-color: var(--interactive-accent-hover);
  background: var(--background-secondary);
}

.goal-option.selected {
  border-color: var(--interactive-accent);
  background: var(--background-secondary);
}

.goal-radio {
  width: 20px;
  height: 20px;
  border: 2px solid var(--background-modifier-border);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  margin-top: 2px;
}

.goal-option.selected .goal-radio {
  border-color: var(--interactive-accent);
}

.goal-radio-inner {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: transparent;
  transition: background 0.2s ease;
}

.goal-radio-inner.selected {
  background: var(--interactive-accent);
}

.goal-content {
  flex: 1;
}

.goal-badge {
  display: inline-block;
  font-size: 11px;
  font-weight: 500;
  color: var(--text-on-accent);
  background: var(--interactive-accent);
  padding: 2px 8px;
  border-radius: 12px;
}
`,dee="radio-option-styles"});var fee={};Ti(fee,{TradeFormModal:()=>Eo,UnsavedChangesConfirmationModal:()=>YI});var n0,uy,mee,Eo,kMe,YI,Wp=F(()=>{n0=Y(Q()),uy=require("obsidian"),mee=Y(Ni());WZ();rl();HB();pee();Er();Eo=class extends uy.Modal{constructor(r){super(r.app);this.container=null;this.root=null;this.checkForUnsavedChanges=null;this.isConfirming=!1;this.confirmationModal=null;this.shouldBypassUnsavedCheck=!1;this.props=r}close(){if(!this.isConfirming){if(this.shouldBypassUnsavedCheck){this.shouldBypassUnsavedCheck=!1,super.close();return}this.checkForUnsavedChanges&&this.checkForUnsavedChanges()?(this.isConfirming=!0,this.showUnsavedChangesConfirmation().then(r=>{r&&super.close()}).finally(()=>{this.isConfirming=!1,this.confirmationModal=null})):super.close()}}showUnsavedChangesConfirmation(){return new Promise(r=>{this.confirmationModal=new YI(this.props.app,r),this.confirmationModal.open()})}setUnsavedChangesChecker(r){this.checkForUnsavedChanges=r}closeAfterSuccessfulSubmit(){this.shouldBypassUnsavedCheck=!0,this.close()}onOpen(){let{contentEl:r}=this;r.empty(),dy(),OI(),uee(),VI();try{let n=document.activeElement;n&&typeof n.blur=="function"&&n.blur()}catch(n){}this.container=r.createDiv({cls:"trade-form-modal-container trade-form-view-container"}),this.renderComponent()}onClose(){this.root&&(this.root.unmount(),this.root=null),GI();let{contentEl:r}=this;r.empty()}renderComponent(){this.container&&(this.root=(0,mee.createRoot)(this.container),this.root.render(n0.default.createElement(el,null,n0.default.createElement(kMe,{app:this.props.app,plugin:this.props.plugin,isEditMode:!!this.props.isEditMode,initialData:this.props.initialData||{},filePath:this.props.filePath||"",onModalClose:()=>this.close(),onSuccessfulSubmit:()=>this.closeAfterSuccessfulSubmit(),onDirtyStateChange:r=>this.setUnsavedChangesChecker(r)}))))}},kMe=({plugin:e,isEditMode:t,initialData:r,filePath:n,onModalClose:i,onSuccessfulSubmit:a,onDirtyStateChange:o})=>{let[s,l]=(0,n0.useState)(!1),c=async()=>{try{return e.missedTradeService?e.missedTradeService:await e.serviceManager.getMissedTradeService()}catch(m){throw new Error("Missed trade service is not initialized. Please wait a moment and try again.")}},d=async()=>{try{return e.backtestTradeService?e.backtestTradeService:await e.serviceManager.getBacktestTradeService()}catch(m){throw new Error("Backtest trade service is not initialized. Please wait a moment and try again.")}};return n0.default.createElement(_Z,{initialData:r||{},isSubmitting:s,isEditMode:t,onSubmit:async m=>{try{l(!0);let g="",f=m.isMissedTrade===!0,v={entryTime:m.entryTime,exitTime:m.exitTime,entryPrice:m.entryPrice,exitPrice:m.exitPrice,positionSize:m.positionSize,direction:m.direction,entries:m.entries||[],exits:m.exits||[],setupIds:m.setupIds||[],mistakeIds:m.mistakeIds||[],accountIds:m.accountIds||[],thesis:m.thesis,images:m.images,instrument:m.instrument,assetType:m.assetType,setup:m.setup,mistake:m.mistake,account:m.account,tags:m.tags,commission:m.commission,commissionType:m.commissionType,fees:m.fees,swap:m.swap,stopLoss:m.stopLoss,riskAmount:m.riskAmount,mae:m.mae,mfe:m.mfe,maePrice:m.maePrice,mfePrice:m.mfePrice,useDirectPnLInput:m.useDirectPnLInput,directPnL:m.directPnL,rebate:m.rebate,isMissedTrade:m.isMissedTrade,missedReason:m.missedReason,isBacktestTrade:m.isBacktestTrade||!1,customFields:m.customFields,customTags:m.customTags};if(m.assetType==="stock"?m.exchange&&(v.exchange=m.exchange):m.assetType==="options"?(m.expirationDate&&(v.expirationDate=new Date(m.expirationDate)),m.strikePrice!==void 0&&(v.strikePrice=m.strikePrice),m.optionType&&(v.optionType=m.optionType),m.contractSize!==void 0&&(v.contractSize=m.contractSize)):m.assetType==="futures"?(m.dollarPerPoint!==void 0&&(v.dollarPerPoint=m.dollarPerPoint),m.tickSize!==void 0&&(v.tickSize=m.tickSize),m.tickValue!==void 0&&(v.tickValue=m.tickValue)):m.assetType==="forex"?(m.lotSize!==void 0&&(v.lotSize=m.lotSize),m.pipValue!==void 0&&(v.pipValue=m.pipValue)):m.assetType==="crypto"?m.cryptoExchange&&(v.cryptoExchange=m.cryptoExchange):m.assetType==="cfd"&&m.leverageRatio!==void 0&&(v.leverageRatio=m.leverageRatio),t&&(v.originalPnl=r==null?void 0:r.pnl),t){f?g=await(await c()).updateMissedTrade(v,n||""):m.isBacktestTrade?g=await(await d()).updateBacktestTrade(v,n||"")?n||"backtest trade":"":g=await e.tradeService.updateTrade(v,n||"");let h=m.isBacktestTrade?"Backtest trade":f?"Missed trade":"Trade";new uy.Notice(`${h} updated: ${g}`)}else{if(m.isBacktestTrade){let b=await(await d()).createBacktestTrade(v,{openFile:!0,images:m.images,customFields:m.customFields});g=b?b.path:""}else f?g=await(await c()).createMissedTrade(v):g=await e.tradeService.createTrade(v);let h=m.isBacktestTrade?"Backtest trade":f?"Missed trade":"Trade";new uy.Notice(`${h} created: ${g}`)}try{m.assetType&&await e.uiStateManager.updateState({lastAssetType:m.assetType})}catch(h){console.error("Error saving asset type preference:",h)}a()}catch(g){console.error(`Failed to ${t?"update":"create"} trade:`,g),new uy.Notice(`Failed to ${t?"update":"create"} trade: ${(g==null?void 0:g.message)||"Unknown error"}`),l(!1)}},onCancel:()=>{i()},onDirtyStateChange:o})},YI=class extends uy.Modal{constructor(r,n){super(r);this.onConfirm=n;this.resolved=!1;this.titleEl.setText("Unsaved Changes")}onOpen(){let{contentEl:r}=this;r.empty(),r.createEl("p",{text:"You have unsaved changes in the trade form."}),r.createEl("p",{text:"Are you sure you want to close without saving?"});let n=r.createDiv({cls:"modal-button-container"});n.createEl("button",{type:"button",text:"Continue Editing",cls:"mod-cta"}).addEventListener("click",()=>{this.resolved||(this.resolved=!0,this.onConfirm(!1)),this.close()}),n.createEl("button",{type:"button",text:"Discard Changes",cls:"mod-warning"}).addEventListener("click",()=>{this.resolved||(this.resolved=!0,this.onConfirm(!0)),this.close()})}close(){super.close(),this.resolved||(this.resolved=!0,this.onConfirm(!1))}onClose(){let{contentEl:r}=this;r.empty()}}});function qB(){if(document.head.querySelector("#reviewv2-styles"))return;let e=document.createElement("style");e.id="reviewv2-styles",e.textContent=EMe,document.head.appendChild(e)}function bee(){let e=document.head.querySelector("#reviewv2-styles");e&&e.remove()}function xee(){document.head.querySelector("#reviewv2-styles")||qB()}var EMe,VB=F(()=>{EMe=`
  /**
   * Fence Line Hiding
   * Hide the \`\`\` markers for journalit codeblocks to create seamless widget integration
   */
  .markdown-source-view.mod-cm6 .HyperMD-codeblock-begin:has(+ .HyperMD-codeblock-bg [class*="journalit"]),
  .markdown-source-view.mod-cm6 .HyperMD-codeblock-end:has(~ .HyperMD-codeblock-bg [class*="journalit"]) {
    font-size: 0;
    line-height: 0;
    height: 0;
    overflow: hidden;
  }

  /* Remove codeblock background for journalit widgets */
  .cm-line.HyperMD-codeblock-bg:has([class*="journalit"]) {
    background: transparent;
  }

  /* Remove codeblock hover effect for journalit widgets */
  /* Obsidian adds cm-lang-{language} class to codeblocks */
  [class*="cm-lang-journalit-"],
  [class*="cm-lang-journalit-"]:hover {
    --embed-block-shadow-hover: 0 !important;
    box-shadow: none !important;
  }

  /* Hide the "Edit this block" button for journalit widgets */
  /* Power users can use source mode to edit raw codeblock if needed */
  [class*="cm-lang-journalit-"] .edit-block-button {
    display: none !important;
  }

  /**
   * Widget Container Base Styling
   * Shared base styling for all Review V2 section widgets
   */
  .journalit-widget {
    margin: 0 0 0.75rem 0;
    padding: 0;
    background: transparent;
    border: none;
    border-radius: 0;
  }

  /**
   * Section-Specific Widget Styles
   * Different visual treatments for each section type
   */

  /* Header Section - Base styles */
  .journalit-header {
    padding: 0;
    background: transparent;
    border: none;
    border-radius: 0;
    box-shadow: none;
    width: 100%;
  }

  /* ========== LAYOUT E: Large title, subtle controls ========== */
  .journalit-header .journalit-header-content.layout-e {
    width: 100%;
    padding: 1.25rem 0;
    display: flex;
    align-items: flex-end;
    justify-content: space-between;
    gap: 1rem;
  }

  .journalit-header .layout-e .journalit-header-main {
    flex: 1;
  }

  .journalit-header .layout-e .journalit-header-title {
    font-size: 1.8em;
    font-weight: 600;
    color: var(--text-normal);
    line-height: 1.2;
  }

  .journalit-header .layout-e .journalit-header-subtitle {
    color: var(--text-muted);
    font-size: 0.95em;
    margin-top: 0.2rem;
  }

  .journalit-header .layout-e .journalit-header-context {
    margin-top: 0.35rem;
    font-size: 0.95em;
    color: var(--text-muted);
  }

  .journalit-header .layout-e .context-link {
    color: var(--text-accent);
    cursor: pointer;
    transition: opacity 0.15s ease;
  }

  .journalit-header .layout-e .context-link:hover:not(.disabled) {
    opacity: 0.8;
    text-decoration: underline;
  }

  .journalit-header .layout-e .context-link.disabled {
    opacity: 0.6;
    cursor: default;
  }

  .journalit-header .layout-e .context-separator {
    margin: 0 0.5rem;
    color: var(--text-faint);
  }

  .journalit-header .layout-e .context-text {
    color: var(--text-muted);
  }

  .journalit-header .layout-e .context-placeholder {
    color: var(--text-faint);
    cursor: not-allowed;
    opacity: 0.7;
  }

  .journalit-header .layout-e .journalit-header-subtle-controls {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    flex-shrink: 0;
    color: var(--text-muted);
    font-size: 0.9em;
  }

  .journalit-header .layout-e .nav-link {
    padding: 0.3rem 0.6rem;
    background: var(--background-secondary);
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.15s ease;
    user-select: none;
  }

  .journalit-header .layout-e .nav-link:hover:not(.disabled) {
    background: var(--background-modifier-hover);
    color: var(--text-normal);
  }

  .journalit-header .layout-e .nav-link.disabled {
    opacity: 0.6;
    cursor: default;
  }

  .journalit-header .layout-e .nav-separator {
    display: none;
  }

  /* Goals Section - Checkbox list styling */
  .journalit-goals {
    padding: 0;
    background: transparent;
    border-radius: 0;
  }

  .journalit-goals h3 {
    margin: 0 0 0.75rem 0;
    font-size: 1rem;
    font-weight: 600;
    color: var(--text-normal);
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--background-modifier-border);
  }

  .journalit-goals .goal-list {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .journalit-goals .goal-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem;
    background: var(--background-primary);
    border-radius: var(--radius-s);
    border: 1px solid var(--background-modifier-border);
    cursor: pointer;
    transition: background-color 0.15s ease;
  }

  .journalit-goals .goal-item:hover {
    background-color: var(--background-modifier-hover);
  }

  .journalit-goals .goal-checkbox {
    margin: 0;
    flex-shrink: 0;
  }

  .journalit-goals .goal-text {
    flex: 1;
    font-size: 0.95rem;
    color: var(--text-normal);
  }

  .journalit-goals .goal-text.completed {
    text-decoration: line-through;
    opacity: 0.7;
    color: var(--text-muted);
  }

  /* Tooltip styles for review widgets */
  .journalit-tooltip {
    background: var(--background-secondary);
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    padding: 8px 12px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
    max-width: 280px;
    font-size: 13px;
    color: var(--text-normal);
    z-index: 9999;
  }

  /* Trades Section - Trade list table styling */
  .journalit-trades {
    padding: 0;
    background: transparent;
    border-radius: 0;
  }

  .journalit-trades h3 {
    margin: 0 0 0.75rem 0;
    font-size: 1rem;
    font-weight: 600;
    color: var(--text-normal);
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--background-modifier-border);
  }

  .journalit-trades .trade-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.9rem;
  }

  .journalit-trades .trade-table thead {
    background: var(--background-secondary);
  }

  .journalit-trades .trade-table th {
    padding: 0.5rem;
    text-align: left;
    font-weight: 600;
    color: var(--text-muted);
    border-bottom: 2px solid var(--background-modifier-border);
  }

  .journalit-trades .trade-table td {
    padding: 0.5rem;
    border-bottom: 1px solid var(--background-modifier-border-subtle);
  }

  .journalit-trades .trade-table tbody tr {
    transition: background-color 0.15s ease;
  }

  .journalit-trades .trade-table tbody tr:hover {
    background-color: var(--background-modifier-hover);
  }

  .journalit-trades .trade-link {
    color: var(--text-accent);
    text-decoration: none;
    cursor: pointer;
  }

  .journalit-trades .trade-link:hover {
    text-decoration: underline;
  }

  .journalit-trades .pnl-positive {
    color: var(--text-success, #4caf50);
    font-weight: 500;
  }

  .journalit-trades .pnl-negative {
    color: var(--text-error, #f44336);
    font-weight: 500;
  }

  /* Setup Performance Section - No container, full width */
  .journalit-setup-performance {
    padding: 0;
    background: transparent;
    border: none;
    overflow: visible !important;
  }

  /* Best/Worst Section - No container */
  .journalit-best-worst {
    padding: 0;
    background: transparent;
    border: none;
  }

  /* Trades Chart Section - No container */
  .journalit-trades-chart {
    padding: 0;
    background: transparent;
    border: none;
  }

  /* Review Section - Grades and notes */
  .journalit-review {
    padding: 0;
    background: transparent;
    border-radius: 0;
  }

  .journalit-review h3 {
    margin: 0 0 0.75rem 0;
    font-size: 1rem;
    font-weight: 600;
    color: var(--text-normal);
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--background-modifier-border);
  }

  .journalit-review .grade-section {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    margin-bottom: 1rem;
  }

  .journalit-review .grade-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.5rem;
    background: var(--background-primary);
    border-radius: var(--radius-s);
    border: 1px solid var(--background-modifier-border);
  }

  .journalit-review .grade-label {
    font-size: 0.9rem;
    color: var(--text-normal);
  }

  .journalit-review .grade-value {
    font-size: 1.1rem;
    font-weight: 600;
    padding: 0.25rem 0.75rem;
    background: var(--background-secondary);
    border-radius: var(--radius-s);
    min-width: 40px;
    text-align: center;
  }

  .journalit-review .notes-section {
    margin-top: 1rem;
    padding: 0.75rem;
    background: var(--background-primary);
    border-radius: var(--radius-s);
    border-left: 3px solid var(--interactive-accent);
  }

  .journalit-review .notes-label {
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin-bottom: 0.5rem;
  }

  .journalit-review .notes-content {
    font-size: 0.9rem;
    line-height: 1.6;
    color: var(--text-normal);
  }

  /* Chart Section - Chart container styling */
  .journalit-chart {
    padding: 0;
    background: transparent;
    border-radius: 0;
    min-height: 300px;
  }

  .journalit-chart h3 {
    margin: 0 0 0.75rem 0;
    font-size: 1rem;
    font-weight: 600;
    color: var(--text-normal);
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--background-modifier-border);
  }

  .journalit-chart .chart-container {
    width: 100%;
    height: 100%;
    min-height: 250px;
    position: relative;
  }

  .journalit-chart .chart-loading {
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 250px;
    color: var(--text-muted);
  }

  /* Chart responsive max-width - prevent overly wide charts */
  .journalit-pnl-chart,
  .journalit-drawdown-chart,
  .journalit-trades-chart {
    max-width: 900px;
  }

  /**
   * Placeholder Widget Styling
   * For sections not yet implemented or under development
   */
  .journalit-placeholder {
    padding: 2rem 1rem;
    text-align: center;
    color: var(--text-muted);
    font-style: italic;
    background: var(--background-primary-alt);
    border: 1px dashed var(--background-modifier-border);
    border-radius: var(--radius-m);
  }

  .journalit-placeholder .placeholder-icon {
    font-size: 2rem;
    margin-bottom: 0.5rem;
    opacity: 0.5;
  }

  .journalit-placeholder .placeholder-text {
    font-size: 0.9rem;
    line-height: 1.6;
  }

  .journalit-placeholder .placeholder-section-name {
    font-weight: 600;
    color: var(--text-normal);
    font-style: normal;
  }

  /**
   * Images Widget
   * Widget for displaying and uploading images in review notes
   */
  .journalit-images-widget {
    width: 100%;
  }

  /* Override carousel styles within images widget - remove extra spacing */
  .journalit-images-widget .journalit-image-carousel {
    margin-bottom: 0;
    padding: 0;
    background-color: transparent;
    border-radius: 0;
  }

  .journalit-images-widget .journalit-carousel-main {
    margin-bottom: 0;
  }

  .journalit-images-widget .journalit-carousel-counter {
    margin: 8px 0 0 0;
  }

  .journalit-images-widget .journalit-carousel-thumbnails {
    margin-top: 8px;
  }

  .journalit-images-empty {
    padding: 2rem;
    text-align: center;
    color: var(--text-muted);
    font-size: 0.9em;
  }

  .journalit-images-uploader {
    margin-top: 0.75rem;
  }

  /* Disabled uploader in preview mode */
  .journalit-images-uploader.disabled-preview {
    pointer-events: none;
    opacity: 0.7;
    cursor: default;
  }

  .journalit-images-uploader.disabled-preview .journalit-image-upload-file-area {
    cursor: default;
  }

  /**
   * Responsive Adjustments
   * Ensure widgets work well on different screen sizes
   */
  @media (max-width: 768px) {
    .journalit-header .header-stats {
      flex-direction: column;
      gap: 0.5rem;
    }

    .journalit-trades .trade-table {
      font-size: 0.8rem;
    }

    .journalit-trades .trade-table th,
    .journalit-trades .trade-table td {
      padding: 0.35rem;
    }

    .journalit-chart {
      min-height: 250px;
    }

    .journalit-chart .chart-container {
      min-height: 200px;
    }
  }

  /**
   * Dark Mode Adjustments
   * Ensure proper contrast in dark themes
   */
  .theme-dark .journalit-header .journalit-header-nav-btn {
    background: var(--interactive-normal);
  }

  .theme-dark .journalit-header .journalit-header-nav-btn:hover:not(.disabled) {
    background: var(--interactive-hover);
  }
`});var Tee={};Ti(Tee,{accountLinkModalStyles:()=>See,injectAccountLinkModalStyles:()=>YB,removeAccountLinkModalStyles:()=>KB});function YB(){if(document.getElementById(GB))return;let e=document.createElement("style");e.id=GB,e.textContent=See,document.head.appendChild(e)}function KB(){let e=document.getElementById(GB);e&&e.remove()}var GB,See,JB=F(()=>{GB="journalit-account-link-modal-styles",See=`
  .account-link-modal {
    padding: 16px;
    font-family: var(--font-text);
    color: var(--text-normal);
    min-width: 450px;
  }

  .account-link-modal h3 {
    margin-top: 0;
    margin-bottom: 16px;
    font-size: 1.3rem;
    font-weight: 600;
    color: var(--text-normal);
    border-bottom: 1px solid var(--background-modifier-border);
    padding-bottom: 8px;
  }

  .account-link-modal .account-info {
    background-color: var(--background-secondary);
    padding: 12px 16px;
    border-radius: 6px;
    margin-bottom: 20px;
    border: 1px solid var(--background-modifier-border);
  }

  .account-link-modal .account-info p {
    margin: 4px 0;
    font-size: 0.9rem;
  }

  .account-link-modal .account-info strong {
    font-weight: 600;
    margin-right: 8px;
    color: var(--text-muted);
  }

  .account-link-modal .modal-field {
    margin-bottom: 16px;
  }

  .account-link-modal .section-label {
    display: block;
    margin-bottom: 12px;
    font-weight: 500;
    font-size: 0.95rem;
    color: var(--text-normal);
  }

  .account-link-modal .link-option-group {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .account-link-modal .link-option {
    display: flex;
    align-items: center;
    padding: 8px 12px;
    border-radius: 4px;
    cursor: pointer;
    transition: background-color 0.1s ease;
  }

  .account-link-modal .link-option:hover {
    background-color: var(--background-modifier-hover);
  }

  .account-link-modal .link-option input[type="radio"] {
    margin-right: 10px;
    cursor: pointer;
  }

  .account-link-modal .link-option span {
    flex: 1;
    font-size: 0.9rem;
  }

  .account-link-modal .custom-name-input,
  .account-link-modal .existing-account-select {
    margin-left: 32px;
    margin-top: 8px;
    margin-bottom: 12px;
  }

  .account-link-modal .modal-input,
  .account-link-modal .modal-select {
    width: 100%;
    padding: 8px 10px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    font-size: 0.9rem;
    min-height: 36px;
  }

  .account-link-modal .modal-input:focus,
  .account-link-modal .modal-select:focus {
    border-color: var(--interactive-accent);
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2);
    outline: none;
  }

  .account-link-modal .modal-actions {
    display: flex;
    justify-content: flex-end;
    gap: 8px;
    margin-top: 24px;
    padding-top: 20px;
    border-top: 1px solid var(--background-modifier-border);
  }
`});function QB(){if(document.head.querySelector("#journalit-csv-import-styles"))return;let e=document.createElement("style");e.id="journalit-csv-import-styles",e.textContent=AMe,document.head.appendChild(e)}function KI(){var e;(e=document.head.querySelector("#journalit-csv-import-styles"))==null||e.remove()}function JI(){QB()}var AMe,QI=F(()=>{AMe=`
/* Remove Obsidian's default view-content padding for CSV import view */
.journalit-csv-import-view-container .view-content {
	display: none !important;
	padding: 0 !important;
	margin: 0 !important;
}

/* CSV Import Container */
.journalit-csv-import {
	padding: 0 24px 24px 24px;
	max-width: 1200px;
	margin: 0 auto;
	background: var(--background-primary);
}

.csv-import-header {
	margin-bottom: 32px;
}

.csv-import-header h2 {
	margin: 0 0 8px 0;
	color: var(--text-normal);
	font-size: 24px;
	font-weight: 600;
}

.csv-import-header p {
	margin: 0;
	color: var(--text-muted);
	font-size: 14px;
}

.csv-import-content {
	display: flex;
	flex-direction: column;
	gap: 24px;
}

/* Placeholder */
.csv-placeholder {
	padding: 60px 20px;
	text-align: center;
	border: 2px dashed var(--background-modifier-border);
	border-radius: 8px;
	color: var(--text-muted);
}

/* File Upload Area */
.csv-upload-area {
	border: 2px dashed var(--background-modifier-border);
	border-radius: 8px;
	padding: 48px 24px;
	text-align: center;
	transition: all 0.2s ease;
	cursor: pointer;
	background: var(--background-primary-alt);
}

.csv-upload-area:hover {
	border-color: var(--interactive-accent);
	background: var(--background-modifier-hover);
}

.csv-upload-area.dragover {
	border-color: var(--interactive-accent);
	background: rgba(var(--interactive-accent-rgb), 0.1);
}

.csv-upload-icon {
	font-size: 48px;
	margin-bottom: 16px;
	color: var(--text-muted);
}

.csv-upload-text {
	font-size: 16px;
	color: var(--text-normal);
	margin-bottom: 8px;
}

.csv-upload-hint {
	font-size: 13px;
	color: var(--text-muted);
}

/* Preview Table */
.csv-preview-container {
	margin-top: 24px;
	border: 1px solid var(--background-modifier-border);
	border-radius: 8px;
	overflow: hidden;
}

.csv-preview-header {
	padding: 12px 16px;
	background: var(--background-secondary);
	border-bottom: 1px solid var(--background-modifier-border);
	font-weight: 600;
	color: var(--text-normal);
}

.csv-preview-table-wrapper {
	overflow-x: auto;
	max-height: 400px;
}

.csv-preview-table {
	width: 100%;
	border-collapse: collapse;
	font-size: 13px;
}

.csv-preview-table th,
.csv-preview-table td {
	padding: 10px 12px;
	border: 1px solid var(--background-modifier-border);
	text-align: left;
}

.csv-preview-table th {
	background: var(--background-secondary);
	font-weight: 600;
	position: sticky;
	top: 0;
	z-index: 1;
}

.csv-preview-table td {
	background: var(--background-primary);
}

/* Buttons */
.csv-button {
	padding: 10px 20px;
	border-radius: 6px;
	border: none;
	cursor: pointer;
	font-weight: 500;
	font-size: 14px;
	transition: all 0.2s ease;
}

.csv-button-primary {
	background: var(--interactive-accent);
	color: var(--text-on-accent);
}

.csv-button-primary:hover {
	background: var(--interactive-accent-hover);
}

.csv-button-primary:disabled {
	opacity: 0.5;
	cursor: not-allowed;
}

.csv-button-secondary {
	background: var(--background-modifier-border);
	color: var(--text-normal);
}

.csv-button-secondary:hover {
	background: var(--background-modifier-border-hover);
}

/* Messages */
.csv-message {
	padding: 12px 16px;
	border-radius: 6px;
	margin: 16px 0;
	font-size: 14px;
}

.csv-message--error {
	background: rgba(229, 57, 53, 0.1);
	color: var(--text-error);
	border: 1px solid rgba(229, 57, 53, 0.3);
}

.csv-message--success {
	background: rgba(67, 160, 71, 0.1);
	color: var(--text-success);
	border: 1px solid rgba(67, 160, 71, 0.3);
}

.csv-message--info {
	background: var(--background-secondary);
	color: var(--text-muted);
	border: 1px solid var(--background-modifier-border);
	border-left: 3px solid var(--interactive-accent);
}

/* Loading Spinner */
.csv-loading {
	display: flex;
	align-items: center;
	justify-content: center;
	gap: 12px;
	padding: 24px;
	color: var(--text-muted);
}

.csv-spinner {
	width: 20px;
	height: 20px;
	border: 2px solid var(--background-modifier-border);
	border-top-color: var(--interactive-accent);
	border-radius: 50%;
	animation: csv-spin 0.6s linear infinite;
}

.csv-spinner-small {
	width: 16px;
	height: 16px;
	border: 2px solid var(--background-modifier-border);
	border-top-color: var(--interactive-accent);
	border-radius: 50%;
	animation: csv-spin 0.6s linear infinite;
}

@keyframes csv-spin {
	to { transform: rotate(360deg); }
}

/* Selection Section */
.csv-selection-section {
	display: flex;
	flex-direction: column;
	gap: 20px;
	padding: 20px;
	background: var(--background-secondary);
	border-radius: 8px;
	border: 1px solid var(--background-modifier-border);
}

/* Smaller screens: Reduce padding and gaps */
@media (max-width: 600px) {
	.csv-selection-section {
		padding: 16px;
		gap: 16px;
	}

	.csv-account-selector,
	.csv-broker-selector {
		gap: 6px;
	}

	.csv-label {
		font-size: 13px;
	}
}

.csv-account-selector,
.csv-broker-selector {
	display: flex;
	flex-direction: column;
	gap: 8px;
}

.csv-label {
	font-weight: 500;
	color: var(--text-normal);
	font-size: 14px;
}

.csv-required {
	color: var(--text-error);
	margin-left: 4px;
}

.csv-helper-text {
	font-size: 12px;
	color: var(--text-muted);
	margin-top: 8px;
}

/* ==============================================
   Unified Select Item (Account & Broker)
   ============================================== */

.csv-account-radio-group,
.csv-broker-radio-group {
	display: flex;
	flex-direction: column;
	gap: 6px;
}

.csv-select-item {
	display: flex;
	align-items: center;
	gap: 10px;
	padding: 10px 12px;
	border: 2px solid var(--background-modifier-border);
	border-radius: 6px;
	cursor: pointer;
	transition: all 0.15s ease;
	background: var(--background-primary);
}

.csv-select-item:hover {
	border-color: var(--interactive-accent);
	background: var(--background-modifier-hover);
}

.csv-select-item.selected {
	border-color: var(--interactive-accent);
	box-shadow: 0 0 0 1px var(--interactive-accent);
}

.csv-select-item.favorite .csv-select-item-label {
	font-weight: 600;
}

.csv-select-item-label {
	flex: 1;
	font-size: 14px;
	color: var(--text-normal);
}

.csv-select-item-actions {
	display: flex;
	align-items: center;
	gap: 4px;
}

.csv-select-item-star,
.csv-select-item-hide {
	padding: 4px;
	background: transparent;
	border: none;
	cursor: pointer;
	color: var(--text-muted);
	opacity: 0.5;
	transition: all 0.15s ease;
	border-radius: 4px;
	display: flex;
	align-items: center;
	justify-content: center;
}

.csv-select-item:hover .csv-select-item-star,
.csv-select-item:hover .csv-select-item-hide {
	opacity: 1;
}

.csv-select-item-star:hover,
.csv-select-item-star.active {
	color: var(--color-orange);
	opacity: 1;
}

.csv-select-item-hide:hover {
	color: var(--text-error);
	opacity: 1;
}

/* Always show actions on touch devices */
@media (hover: none) {
	.csv-select-item-star,
	.csv-select-item-hide {
		opacity: 1;
	}
}

.csv-account-show-more,
.csv-broker-show-more {
	display: flex;
	align-items: center;
	justify-content: center;
	gap: 6px;
	width: 100%;
	padding: 8px 12px;
	background: transparent;
	border: 1px dashed var(--background-modifier-border);
	border-radius: 6px;
	cursor: pointer;
	font-size: 13px;
	color: var(--text-muted);
	transition: all 0.15s ease;
}

.csv-account-show-more:hover,
.csv-broker-show-more:hover {
	background: var(--background-modifier-hover);
	color: var(--text-normal);
	border-color: var(--interactive-accent);
}

/* ==============================================
   Broker Radio Selector
   ============================================== */

.csv-broker-radio-selector {
	display: flex;
	flex-direction: column;
	gap: 12px;
}

.csv-broker-radio-header {
	display: flex;
	align-items: center;
	justify-content: space-between;
	gap: 12px;
}

.csv-broker-manage-btn {
	display: flex;
	align-items: center;
	gap: 4px;
	padding: 4px 8px;
	background: var(--background-modifier-hover);
	border: 1px solid var(--background-modifier-border);
	border-radius: 4px;
	cursor: pointer;
	font-size: 12px;
	color: var(--text-muted);
	transition: all 0.15s ease;
}

.csv-broker-manage-btn:hover {
	background: var(--background-secondary);
	color: var(--text-normal);
}

.csv-broker-radio-group {
	display: flex;
	flex-direction: column;
	gap: 6px;
}

.csv-broker-radio-group-label {
	font-size: 11px;
	font-weight: 600;
	text-transform: uppercase;
	letter-spacing: 0.5px;
	color: var(--text-muted);
	margin-bottom: 4px;
}

/* Manage Hidden Brokers Modal */
.csv-broker-manage-overlay {
	position: fixed;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	background: rgba(0, 0, 0, 0.5);
	display: flex;
	align-items: center;
	justify-content: center;
	z-index: 1000;
}

.csv-broker-manage-modal {
	background: var(--background-primary);
	border-radius: 8px;
	box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
	min-width: 320px;
	max-width: 480px;
	max-height: 80vh;
	overflow: hidden;
	display: flex;
	flex-direction: column;
}

.csv-broker-manage-modal-header {
	display: flex;
	align-items: center;
	justify-content: space-between;
	padding: 16px 20px;
	border-bottom: 1px solid var(--background-modifier-border);
}

.csv-broker-manage-modal-header h3 {
	margin: 0;
	font-size: 16px;
	font-weight: 600;
	color: var(--text-normal);
}

.csv-broker-manage-close {
	background: transparent;
	border: none;
	cursor: pointer;
	font-size: 24px;
	color: var(--text-muted);
	padding: 0;
	line-height: 1;
	transition: color 0.15s ease;
}

.csv-broker-manage-close:hover {
	color: var(--text-normal);
}

.csv-broker-manage-modal-content {
	padding: 16px 20px;
	overflow-y: auto;
}

.csv-broker-manage-empty {
	text-align: center;
	color: var(--text-muted);
	padding: 24px 0;
}

.csv-broker-manage-list {
	list-style: none;
	margin: 0;
	padding: 0;
	display: flex;
	flex-direction: column;
	gap: 8px;
}

.csv-broker-manage-list li {
	display: flex;
	align-items: center;
	justify-content: space-between;
	padding: 10px 12px;
	background: var(--background-secondary);
	border-radius: 6px;
	font-size: 14px;
	color: var(--text-normal);
}

.csv-broker-manage-list li button {
	padding: 4px 10px;
	font-size: 12px;
}

.csv-broker-restore-all {
	width: 100%;
	margin-top: 12px;
}

/* Upload Section */
.csv-upload-section {
	margin-top: 8px;
}

/* Inline Broker Guide (above upload area) */
.csv-broker-guide-inline {
	margin-bottom: 12px;
}

.journalit-collapsible-section.broker-guide-inline {
	border: 1px solid var(--background-modifier-border);
	border-radius: 8px;
	background: var(--background-primary-alt);
}

.journalit-collapsible-section.broker-guide-inline .journalit-collapsible-header {
	padding: 12px 16px;
	background: var(--background-secondary);
	border-radius: 7px 7px 0 0;
}

.journalit-collapsible-section.broker-guide-inline:not(.is-open) .journalit-collapsible-header {
	border-radius: 7px;
}

.journalit-collapsible-section.broker-guide-inline .journalit-collapsible-content {
	padding: 16px;
	border-top: 1px solid var(--background-modifier-border);
}

.csv-upload-section h3 {
	margin: 0 0 16px 0;
	font-size: 16px;
	font-weight: 600;
	color: var(--text-normal);
}

.csv-upload-area.disabled {
	opacity: 0.5;
	cursor: not-allowed;
}

/* Preview Section */
.csv-preview-section {
	margin-top: 24px;
}

.csv-import-actions {
	display: flex;
	gap: 12px;
	align-items: center;
}

/* Results Container */
.csv-results-container {
	margin-top: 24px;
	text-align: center;
}

.csv-results-container h3 {
	font-size: 18px;
	font-weight: 600;
}

.csv-results-container p {
	font-size: 14px;
	line-height: 1.6;
}

.csv-results-container ul {
	text-align: left;
	max-width: 500px;
	margin: 0 auto;
}

/* Column Mapper */
.csv-column-mapper {
	margin-top: 24px;
}

.csv-mapper-header {
	margin-bottom: 20px;
}

.csv-mapper-header h3 {
	margin: 0 0 8px 0;
	font-size: 16px;
	font-weight: 600;
	color: var(--text-normal);
}

.csv-mapper-header p {
	margin: 0;
	font-size: 13px;
	color: var(--text-muted);
}

/* Asset Type Selector */
.asset-type-selector {
	padding: 20px;
	background: var(--background-secondary);
	border: 1px solid var(--background-modifier-border);
	border-radius: 8px;
	margin-top: 24px;
	margin-bottom: 24px;
}

.asset-type-selector h3 {
	margin: 0 0 4px 0;
	font-size: 14px;
	font-weight: 600;
	color: var(--text-normal);
}

.asset-type-buttons {
	display: flex;
	gap: 8px;
	margin-top: 12px;
	flex-wrap: wrap;
}

.asset-type-button {
	padding: 10px 20px;
	border-radius: 6px;
	border: 2px solid var(--background-modifier-border);
	background: var(--background-primary);
	color: var(--text-normal);
	cursor: pointer;
	font-weight: 500;
	font-size: 13px;
	transition: all 0.2s ease;
	flex: 1;
	min-width: 100px;
}

.asset-type-button:hover {
	border-color: var(--interactive-accent);
	background: var(--background-modifier-hover);
}

.asset-type-button.active {
	background: var(--interactive-accent);
	color: var(--text-on-accent);
	border-color: var(--interactive-accent);
}

/* Date Format Selector */
.date-format-selector {
	padding: 20px;
	background: var(--background-secondary);
	border: 1px solid var(--background-modifier-border);
	border-radius: 8px;
	margin-top: 16px;
	margin-bottom: 24px;
}

.date-format-selector h3 {
	margin: 0 0 4px 0;
	font-size: 14px;
	font-weight: 600;
	color: var(--text-normal);
}

.date-format-selector .csv-helper-text {
	margin-bottom: 12px;
}

.csv-mapper-grid-container {
	max-height: 300px;
	overflow-y: auto;
	margin-top: 16px;
	margin-bottom: 16px;
	border: 1px solid var(--background-modifier-border);
	border-radius: 8px;
	padding: 12px;
}

.csv-mapper-grid {
	display: flex;
	flex-direction: column;
	gap: 12px;
}

.csv-mapper-row {
	display: grid;
	grid-template-columns: 1fr auto 1fr;
	align-items: center;
	gap: 16px;
	padding: 12px;
	background: var(--background-secondary);
	border-radius: 6px;
	border: 1px solid var(--background-modifier-border);
}

.csv-mapper-source {
	display: flex;
	flex-direction: column;
	gap: 4px;
}

.csv-column-name {
	font-weight: 500;
	color: var(--text-normal);
	font-size: 13px;
}

.csv-mapper-arrow {
	color: var(--text-muted);
	font-size: 20px;
	text-align: center;
	align-self: center;
}

.csv-column-arrow {
	display: none;  /* Deprecated - using .csv-mapper-arrow instead */
}

.csv-column-header {
	display: flex;
	flex-direction: column;
	gap: 4px;
}

.csv-column-sample {
	font-size: 12px;
	color: var(--text-muted);
	font-style: italic;
}

.csv-sample-value {
	color: var(--text-normal);
	font-family: var(--font-monospace);
	background: var(--background-secondary);
	padding: 2px 6px;
	border-radius: 3px;
	font-style: normal;
}

.csv-mapper-target {
	display: flex;
	align-items: center;
	gap: 8px;
	flex: 1;
}

.csv-required-badge {
	padding: 2px 8px;
	background: rgba(229, 57, 53, 0.1);
	color: var(--text-error);
	border-radius: 4px;
	font-size: 11px;
	font-weight: 600;
	text-transform: uppercase;
}

.csv-mapper-summary {
	font-size: 14px;
	color: var(--text-normal);
}

/* AI Mapping */
.csv-ai-map-section {
	padding: 20px;
	background: var(--background-primary-alt);
	border: 1px solid var(--background-modifier-border);
	border-radius: 8px;
	margin-bottom: 24px;
}

.csv-ai-map-header h4 {
	margin: 0 0 4px 0;
	font-size: 14px;
	font-weight: 600;
	color: var(--text-normal);
}

.csv-ai-map-header p {
	margin: 0 0 16px 0;
	font-size: 13px;
	color: var(--text-muted);
}

.csv-ai-button {
	width: 100%;
	display: flex;
	align-items: center;
	justify-content: center;
	gap: 8px;
}

/* Dialog Styles (used with Obsidian Modal) */
.csv-dialog-body {
	margin-bottom: 24px;
}

.csv-dialog-actions {
	display: flex;
	gap: 12px;
	justify-content: flex-end;
}

/* Dialog Form Elements */
.csv-dialog-form-container {
	margin-bottom: 16px;
}

.csv-dialog-label {
	display: block;
	margin-bottom: 8px;
	font-size: 14px;
	font-weight: 500;
	color: var(--text-normal);
}

.csv-dialog-input {
	width: 100%;
	padding: 8px 12px;
	border: 1px solid var(--background-modifier-border);
	border-radius: 4px;
	background-color: var(--background-primary);
	color: var(--text-normal);
	font-size: 14px;
	box-sizing: border-box;
}

.csv-dialog-input-error {
	border-color: var(--text-error);
}

.csv-dialog-error-message {
	margin-top: 8px;
	font-size: 12px;
	color: var(--text-error);
}

.csv-dialog-helper-text {
	margin-top: 8px;
	font-size: 12px;
	color: var(--text-muted);
}

/* Import Results (Inline Display) */
.result-item {
	display: flex;
	align-items: center;
	gap: 12px;
	padding: 12px 16px;
	border-radius: 6px;
	font-size: 14px;
	line-height: 1.5;
}

.result-success {
	background: rgba(67, 160, 71, 0.1);
	border: 1px solid rgba(67, 160, 71, 0.3);
	color: var(--text-normal);
}

.result-warning {
	background: rgba(255, 152, 0, 0.1);
	border: 1px solid rgba(255, 152, 0, 0.3);
	color: var(--text-normal);
}

.result-info {
	background: rgba(33, 150, 243, 0.1);
	border: 1px solid rgba(33, 150, 243, 0.3);
	color: var(--text-normal);
}

.result-icon {
	flex-shrink: 0;
	color: currentColor;
	opacity: 0.9;
}

.result-text {
	flex: 1;
}

.result-text strong {
	font-weight: 600;
	color: var(--text-accent);
}

/* Imported Trades Preview */
.imported-trades-preview {
	margin-top: 20px;
	border: 1px solid var(--background-modifier-border);
	border-radius: 6px;
	overflow: hidden;
}

.preview-header {
	background: var(--background-secondary);
	padding: 12px 16px;
	font-size: 13px;
	font-weight: 600;
	color: var(--text-normal);
	border-bottom: 1px solid var(--background-modifier-border);
}

.csv-trades-list {
	/* No max-height or overflow - show all trades without scrolling */
	overflow-x: auto;
}

.csv-trade-preview-item {
	display: grid;
	grid-template-columns: auto 1fr minmax(80px, 90px) minmax(80px, 90px) minmax(120px, 140px) minmax(90px, 100px);
	gap: 12px;
	padding: 12px 16px;
	border-bottom: 1px solid var(--background-modifier-border);
	font-size: 13px;
	align-items: center;
	transition: background 0.15s ease;
	cursor: pointer;
}

.csv-trade-preview-item:last-child {
	border-bottom: none;
}

.csv-trade-preview-item:hover {
	background: var(--background-modifier-hover);
}

.csv-trade-symbol {
	font-weight: 600;
	color: var(--text-normal);
	grid-column: 1;
}

.csv-trade-date {
	color: var(--text-muted);
	font-size: 12px;
	grid-column: 3;
}

.csv-trade-direction {
	display: flex;
	align-items: center;
	gap: 4px;
	font-weight: 500;
	font-size: 12px;
	text-transform: uppercase;
	grid-column: 4;
}

.csv-trade-direction.long {
	color: var(--color-green);
}

.csv-trade-direction.short {
	color: var(--color-red);
}

.csv-trade-quantity {
	color: var(--text-normal);
	font-size: 12px;
	grid-column: 5;
}

.csv-trade-status {
	font-weight: 500;
	font-size: 12px;
	grid-column: 6;
}

.csv-trade-status.closed {
	color: var(--text-muted);
}

.csv-trade-status.open {
	color: var(--text-warning, #ff9800);
}

.trade-preview-more {
	padding: 12px 16px;
	text-align: center;
	font-size: 12px;
	font-style: italic;
	color: var(--text-muted);
	opacity: 0.7;
}

.import-results-errors {
	background: rgba(229, 57, 53, 0.05);
	border: 1px solid rgba(229, 57, 53, 0.2);
	border-radius: 6px;
	padding: 16px;
}

.errors-header {
	display: flex;
	align-items: center;
	gap: 8px;
	margin-bottom: 12px;
}

.error-icon {
	font-size: 20px;
	color: var(--text-error);
}

.error-title {
	font-weight: 600;
	color: var(--text-error);
	font-size: 14px;
}

.error-list {
	list-style: none;
	margin: 0;
	padding: 0;
	display: flex;
	flex-direction: column;
	gap: 8px;
	max-height: 300px;
	overflow-y: auto;
}

.error-item {
	display: flex;
	flex-direction: column;
	gap: 4px;
	padding: 8px 12px;
	background: var(--background-primary);
	border-radius: 4px;
	font-size: 13px;
}

.error-row {
	font-weight: 600;
	color: var(--text-error);
	font-family: var(--font-monospace);
}

.error-message {
	color: var(--text-muted);
	line-height: 1.4;
}

/* Actions (Import Another File Button) */
.csv-actions {
	margin-top: 24px;
}

.csv-export-code-preview {
	padding: 12px;
	background: var(--background-primary-alt);
	border: 1px solid var(--background-modifier-border);
	border-radius: 4px;
	font-family: var(--font-monospace);
	font-size: 13px;
	word-break: break-all;
	color: var(--text-muted);
	margin-top: 8px;
}

/* Broker Guide Styles */
.broker-guide-content {
	font-size: 13px;
	color: var(--text-muted);
	line-height: 1.6;
}

.broker-guide-steps {
	margin: 0 0 16px 0;
	padding-left: 20px;
}

.broker-guide-steps li {
	margin-bottom: 8px;
	color: var(--text-normal);
}

.broker-guide-steps li strong {
	color: var(--text-normal);
	font-weight: 600;
}

.broker-guide-warning {
	display: flex;
	gap: 12px;
	align-items: flex-start;
	padding: 12px 16px;
	background: rgba(255, 152, 0, 0.1);
	border: 1px solid rgba(255, 152, 0, 0.3);
	border-radius: 6px;
	margin-bottom: 12px;
	font-size: 13px;
	color: var(--text-normal);
}

.broker-guide-warning-icon {
	flex-shrink: 0;
	color: var(--text-warning, #ff9800);
	margin-top: 2px;
}

.broker-guide-info {
	padding: 12px 16px;
	border-left: 3px solid var(--interactive-accent);
	background: var(--background-secondary);
	border-radius: 4px;
	font-size: 13px;
	color: var(--text-muted);
	margin-bottom: 12px;
}

.broker-guide-description {
	font-size: 13px;
	color: var(--text-muted);
	margin-bottom: 12px;
	font-style: italic;
}

.broker-guide-link {
	display: inline-flex;
	align-items: center;
	gap: 6px;
	color: var(--interactive-accent);
	text-decoration: none;
	font-size: 13px;
	padding: 4px 8px;
	border-radius: 4px;
	transition: background-color 0.2s ease;
}

.broker-guide-link:hover {
	background: var(--interactive-accent-hover);
	color: var(--text-on-accent);
}

.broker-guide-link svg {
	flex-shrink: 0;
}

/* Centered title variant for CollapsibleSection */
.journalit-collapsible-section.centered-title .journalit-collapsible-header {
	justify-content: center;
	position: relative;
	padding-left: 40px;
	padding-right: 40px;
}

.journalit-collapsible-section.centered-title .journalit-collapsible-header-left {
	justify-content: center;
	width: 100%;
}

.journalit-collapsible-section.centered-title .journalit-collapsible-chevron {
	position: absolute;
	right: 12px;
}

/* Prominent broker guide section styling */
.journalit-collapsible-section.broker-guide-prominent {
	border: 2px solid var(--interactive-accent);
	background: var(--background-secondary);
	border-radius: 8px;
	overflow: hidden;
	box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
}

.journalit-collapsible-section.broker-guide-prominent .journalit-collapsible-header {
	background: var(--background-secondary);
	position: relative;
}

.journalit-collapsible-section.broker-guide-prominent .journalit-collapsible-header::before {
	content: '';
	position: absolute;
	left: 0;
	top: 0;
	bottom: 0;
	width: 4px;
	background: var(--interactive-accent);
}

.journalit-collapsible-section.broker-guide-prominent .journalit-collapsible-content {
	background: var(--background-primary);
	border-top: 1px solid var(--background-modifier-border);
}

/* Responsive Design - Tablet */
@media (max-width: 768px) {
	.csv-trade-preview-item {
		grid-template-columns: auto 1fr minmax(70px, 80px) minmax(70px, 80px) minmax(100px, 120px) minmax(80px, 90px);
		gap: 8px;
		padding: 10px 12px;
		font-size: 12px;
	}
}

/* Responsive Design - Mobile */
@media (max-width: 600px) {
	.csv-trade-preview-item {
		grid-template-columns: auto 1fr minmax(60px, 70px) minmax(90px, 100px);
		gap: 6px;
		padding: 8px;
		font-size: 11px;
	}

	/* Hide date and direction columns on mobile, keep symbol, quantity, and status */
	.csv-trade-date {
		display: none;
	}

	.csv-trade-direction {
		display: none;
	}

	.csv-trade-quantity {
		grid-column: 3;
	}

	.csv-trade-status {
		grid-column: 4;
	}
}
`});function NMe(){if(document.head.querySelector("#react-view-styles"))return;let e=document.createElement("style");e.id="react-view-styles",e.textContent=LMe,document.head.appendChild(e)}function Dee(){NMe()}var LMe,Eee=F(()=>{LMe=`
  /* Ensure container has proper flex layout */
  .react-view-container {
    height: 100% !important;
    overflow-y: auto !important;
    display: flex !important;
    flex-direction: column !important;
  }

  /* Hide Obsidian's default view-content div (direct child selector) */
  .react-view-container > .view-content {
    display: none !important;
  }

  /* Style the React root element (our injected div) */
  .react-view-container > div[id^="react-root-"] {
    height: 100%;
    display: flex;
    flex-direction: column;
    overflow: visible;
    flex: 1 1 auto;
    min-height: min-content;
  }
`});var Iee,Mee,ZT,nl,ch=F(()=>{Iee=require("obsidian"),Mee=Y(Ni()),ZT=Y(Q());Er();Eee();nl=class extends Iee.ItemView{constructor(r,n={}){super(r);this.root=null;this.rootEl=null;this._pendingAnimationFrame=null;this._intervals=[];this.config={containerClass:"react-view-container",rootId:`react-root-${Date.now()}`,...n},this._themeChangeHandler=()=>this.renderComponent(),this._currencyChangeHandler=()=>this.renderComponent()}registerInterval(r){return this._intervals.push(r),r}clearInterval(r){window.clearInterval(r),this._intervals=this._intervals.filter(n=>n!==r)}async onOpen(){try{Dee(),this.config.containerClass&&this.config.containerClass.trim()!==""&&this.containerEl.addClass(this.config.containerClass),this.rootEl=this.containerEl.createDiv(),this.config.rootId&&(this.rootEl.id=this.config.rootId),this.root=(0,Mee.createRoot)(this.rootEl),this.renderComponent(),document.addEventListener("theme-change",this._themeChangeHandler),window.addEventListener("journalit-currency-changed",this._currencyChangeHandler),this.app.workspace.onLayoutReady(()=>{this._pendingAnimationFrame=window.requestAnimationFrame(()=>{this.renderComponent(),this._pendingAnimationFrame=null})})}catch(r){throw console.error("Failed to initialize React view:",r),r}}renderComponent(){if(!this.root){console.warn("Cannot render component: React root not initialized");return}if(!(!document.body.contains(this.containerEl)||!document.body.contains(this.rootEl)))try{if(!window.journalitPlugin)throw new Error("Cannot render component: Plugin not initialized. This indicates a view registration race condition.");let r=this.getRenderFunction();this.root.render(ZT.default.createElement(ZT.StrictMode,null,ZT.default.createElement(el,null,r())))}catch(r){console.error(`[Journalit] Failed to render React component in ${this.getViewType()}:`,r)}}async onClose(){if(this._pendingAnimationFrame&&(window.cancelAnimationFrame(this._pendingAnimationFrame),this._pendingAnimationFrame=null),this._intervals&&(this._intervals.forEach(r=>window.clearInterval(r)),this._intervals=[]),this.root)try{this.root.unmount(),this.root=null}catch(r){console.error("Failed to unmount React component:",r)}return document.removeEventListener("theme-change",this._themeChangeHandler),window.removeEventListener("journalit-currency-changed",this._currencyChangeHandler),Promise.resolve()}}});var oi,e1,XB=F(()=>{oi=Y(Q());tI();_t();e1=({dateRange:e,onChange:t})=>{let[r,n]=(0,oi.useState)(!1),i=(0,oi.useRef)(null),[a,o]=(0,oi.useState)(!1),[s,l]=(0,oi.useState)(!1),c=(0,oi.useCallback)((h,y)=>{if(!h&&!y)return"allTime";let b=null,k=null;h&&(b=ii(h)),y&&(k=ii(y,!1));let x=new Date,S=ii(x);if(b&&k&&b.getFullYear()===S.getFullYear()&&b.getMonth()===S.getMonth()&&b.getDate()===S.getDate()&&k.getFullYear()===S.getFullYear()&&k.getMonth()===S.getMonth()&&k.getDate()===S.getDate())return"today";let w=new Date(x);w.setDate(w.getDate()-1);let C=ii(w),D=ea(x),P=ii(D);if(b&&k&&b.getFullYear()===C.getFullYear()&&b.getMonth()===C.getMonth()&&b.getDate()===C.getDate()&&k.getFullYear()===C.getFullYear()&&k.getMonth()===C.getMonth()&&k.getDate()===C.getDate())return"yesterday";if(b&&b.getFullYear()===P.getFullYear()&&b.getMonth()===P.getMonth()&&b.getDate()===P.getDate())return"thisWeek";let M=new Date(x.getFullYear(),x.getMonth(),1),z=ii(M);if(b&&b.getFullYear()===z.getFullYear()&&b.getMonth()===z.getMonth()&&b.getDate()===z.getDate())return"thisMonth";let I=(Ap(x)-1)*3,L=new Date(x.getFullYear(),I,1),E=ii(L);if(b&&b.getFullYear()===E.getFullYear()&&b.getMonth()===E.getMonth()&&b.getDate()===E.getDate())return"thisQuarter";let T=new Date(x.getFullYear(),0,1),$=ii(T);return b&&b.getFullYear()===$.getFullYear()&&b.getMonth()===$.getMonth()&&b.getDate()===$.getDate()?"thisYear":h||y?"custom":null},[]),d=(0,oi.useMemo)(()=>c(e[0],e[1]),[e,c]);(0,oi.useEffect)(()=>{let h=y=>{i.current&&!i.current.contains(y.target)&&r&&n(!1)};return r&&document.addEventListener("mousedown",h),()=>{document.removeEventListener("mousedown",h)}},[r]),(0,oi.useEffect)(()=>{if(r&&i.current){let h=i.current.getBoundingClientRect(),y=360,b=160,k=window.innerWidth,x=window.innerHeight,S=20,w=h.right+y>k-S,C=h.left-y<S;if(w&&C){let D=h.bottom+b<=x-S;l(D),o(!1)}else w&&!C?(l(!1),o(!0)):(l(!1),o(!1))}},[r]);let u=(0,oi.useCallback)(h=>{if(h&&h instanceof Date){let y=ii(h,!0);t([y,e[1]])}else t([null,e[1]])},[e,t]),p=(0,oi.useCallback)(h=>{if(h&&h instanceof Date){let y=ii(h,!1);t([e[0],y])}else t([e[0],null])},[e,t]),m=(0,oi.useCallback)(()=>{d==="custom"?n(!r):(n(!0),!e[0]&&!e[1]&&t([null,null]))},[d,r,e,t]),g=(0,oi.useCallback)(h=>{let y=new Date,b=null,k=null;if(h==="custom")if(d==="custom"){n(!r);return}else{n(!0);return}else n(!1);switch(h){case"today":b=ii(y,!0),k=ii(y,!1);break;case"yesterday":let x=new Date(y);x.setDate(y.getDate()-1),b=ii(x,!0),k=ii(x,!1);break;case"thisWeek":let S=ea(y);b=ii(S,!0),k=ii(y,!1);break;case"thisMonth":let w=new Date(y.getFullYear(),y.getMonth(),1);b=ii(w,!0),k=ii(y,!1);break;case"thisQuarter":let D=(Ap(y)-1)*3,P=new Date(y.getFullYear(),D,1);b=ii(P,!0),k=ii(y,!1);break;case"thisYear":let M=new Date(y.getFullYear(),0,1);b=ii(M,!0),k=ii(y,!1);break;default:b=null,k=null;break}t([b,k])},[d,r,t]),f=(0,oi.useMemo)(()=>[{id:"today",label:"Today"},{id:"yesterday",label:"Yesterday"},{id:"thisWeek",label:"This Week"},{id:"thisMonth",label:"This Month"},{id:"thisQuarter",label:"This Quarter"},{id:"thisYear",label:"This Year"},{id:"allTime",label:"All Time"},{id:"custom",label:"Custom"}],[]),v=(0,oi.useCallback)(h=>()=>g(h),[g]);return oi.default.createElement("div",{className:"journalit-dashboard-date-range-filter",ref:i},oi.default.createElement("div",{className:"journalit-dashboard-date-range-presets"},f.map(h=>oi.default.createElement("button",{key:h.id,onClick:v(h.id),className:d===h.id?"active":""},h.label))),r&&oi.default.createElement("div",{className:`journalit-dashboard-date-range-inputs journalit-dashboard-custom-date-dropdown date-dropdown-visible ${a?"position-left":""} ${s?"position-below":""}`},oi.default.createElement("div",{className:"journalit-dashboard-date-range-start"},oi.default.createElement("label",null,"From"),oi.default.createElement(Il,{value:e[0]||void 0,onChange:u,className:"journalit-date-picker-input"})),oi.default.createElement("div",{className:"journalit-dashboard-date-range-end"},oi.default.createElement("label",null,"To"),oi.default.createElement(Il,{value:e[1]||void 0,onChange:p,className:"journalit-date-picker-input",minDate:e[0]||void 0}))))}});var Ns=F(()=>{});var Qn,Vc=F(()=>{ds();Ns();ny();As();Qn={general:{currency:"USD",displayName:"",homeStartupBehavior:"always",onboardingCompleted:!1,journalFolderPath:""},trade:{autoOpenCreatedTrades:!0,dateFormat:"DDMMYY",skipWeekends:!0,useDirectPnLInput:!1,useDollarValueInput:!1,maeMfeInputMode:"dollar",tradingDayCutoffTime:"00:00",breakEvenRangeMin:0,breakEvenRangeMax:0,includeMissedTradesInCalculations:!1,defaultRiskAmount:0,displayRMultiples:!1,showCopyTradingPnL:!1,lossReview:{enabled:!0,sections:[{id:"pause-header",title:"**LOSS REVIEW**",type:"header",content:""},{id:"pause-section",title:"**Pause**\u270B",type:"header",content:`Take a moment to step back.
Do **NOT** start looking at entering a position until you have completed this loss review.`},{id:"pause-checkbox",title:"",type:"checkbox",content:'Say out loud to yourself, **"losses are part of the process, there are endless opportunities in the market."**'},{id:"review-plan",title:"**Review Your Plan**",type:"header",content:"***Did you stick to your trading plan without mistakes?***"},{id:"review-plan-checklist",title:"",type:"checkboxList",items:["\u2192 If **yes**; there is nothing to be mad about, not every trade is going to work out regardless of how good the thesis is","\u2192 If **no**; figure out what went wrong, learn from it and don't do it again"]},{id:"feelings",title:"**Write Down Your Feelings**",type:"header",content:"***Be honest about how you feel and note down your emotions:***"},{id:"feelings-text",title:"",type:"textarea",placeholder:"How are you feeling about this loss?"},{id:"learn-header",title:"**Learn From This Loss**",type:"header",content:"***If the loss was reasonable, write down the best things you did during the trade and ways of repeating those:***"},{id:"learn-reasonable",title:"",type:"textarea",placeholder:"What went well that you can repeat?"},{id:"learn-unreasonable-header",title:"",type:"header",content:"***If the loss was unreasonable, note where you went wrong and how you'll improve next time:***"},{id:"learn-unreasonable",title:"",type:"textarea",placeholder:"What went wrong and how will you improve?"},{id:"next-steps",title:"**Decide The Next Steps**",type:"header",content:`***Outline what you'll do based on the previous questions and follow the plan.***
***You might choose to step back from the charts if it's your third loss in a row.***
***Or you might want to continue trading if it's the first one.***
***What will you pay attention to? How will you behave?***`},{id:"next-steps-text",title:"",type:"textarea",placeholder:"What are your next steps?"},{id:"final-check",title:"**Final Check**",type:"header",content:""},{id:"final-check-list",title:"",type:"checkboxList",items:["If you feel **tilted**, take a break from the screen and play guitar, play with Leo, or get something to eat","If you feel **fine**, do not enter a trade until at least the next candle"]},{id:"overall-thoughts",title:"**Overall Trade Thoughts:**",type:"header",content:""},{id:"overall-thoughts-text",title:"",type:"textarea",placeholder:"Any additional thoughts about this trade?"}]}},tradeLog:{columnVisibility:{select:!1,image:!0,account:!0,ticker:!0,status:!0,pnl:!0,direction:!0,setups:!0,mistakes:!0,tags:!0,date:!0,reviewed:!0,duration:!1,positionSize:!1,expirationDate:!1,daysToExpiry:!1,thesis:!1},columnOrder:["select","image","account","ticker","status","pnl","direction","setups","mistakes","tags","date","reviewed","duration","positionSize","expirationDate","daysToExpiry","thesis"],columnWidths:{}},reviewV2:{customWidgetTypes:[],templates:[],tradeTemplates:[]},templates:{defaultTrade:"builtin-trade-standard",defaultDrc:"builtin-drc-standard",defaultWeekly:"builtin-weekly-standard",defaultMonthly:"builtin-monthly-standard",defaultQuarterly:"builtin-quarterly-standard",defaultYearly:"builtin-yearly-standard"},reviews:{globalAutoCreate:!0},uiCustomization:{},customOptions:ju,customTradeFields:ry,customFieldOptions:{},weekly:{reviewQuestions:["What worked well this week?","What didn't work this week?","Which setups were most profitable?","What mistakes cost me the most money?","What could I improve for next week?"],customTimeframes:["Monthly","Weekly","Daily"],recurringGoals:[],autoCreateOnFirstTrade:!0,autoCreateWeeklyReviewOnNavigation:!0},monthly:{reviewQuestions:["What were the key lessons from this month?","Which strategies performed best?","What patterns do I notice in my trading?","What are my goals for next month?","How can I improve my risk management?"],customTimeframes:["Quarterly","Monthly","Weekly"],autoCreateOnFirstTrade:!0,autoCreateMonthlyReviewOnNavigation:!0},quarterly:{reviewQuestions:["What were the major wins and losses this quarter?","Which trading strategies performed best over the quarter?","What market conditions did I handle well or poorly?","What are my goals for next quarter?","How has my trading evolved compared to previous quarters?"],customTimeframes:["Yearly","Quarterly","Monthly"],autoCreateOnFirstTrade:!0,autoCreateQuarterlyReviewOnNavigation:!0},yearly:{reviewQuestions:["What were my biggest wins and losses this year?","Which trading strategies performed best over the year?","How did I handle different market conditions throughout the year?","What are my goals for next year?","How has my trading evolved compared to previous years?","What key lessons did I learn this year?"],customTimeframes:["Yearly","Quarterly","Monthly"],autoCreateOnFirstTrade:!0,autoCreateYearlyReviewOnNavigation:!0},drc:{checklistItems:["Review market conditions","Check economic calendar","Set risk limits for the day","Review previous day's trades"],reviewQuestions:["What did I do well today?","What could I improve on?","What will I focus on for the next session?"],customTimeframes:["Daily","4H","1H","30M"],recurringGoals:[],autoCreateOnFirstTrade:!0,autoCreateDRCOnNavigation:!0},dashboard:{layouts:{Default:{topSection:["netPnL","winRate","profitFactor","expectancy"],bottomSection:{lg:[{i:"pnlChart",x:0,y:0,w:6,h:8},{i:"performanceCalendar",x:6,y:0,w:6,h:4},{i:"dailyPerformance",x:6,y:4,w:6,h:4}],md:[{i:"pnlChart",x:0,y:0,w:6,h:6},{i:"performanceCalendar",x:0,y:6,w:6,h:3},{i:"dailyPerformance",x:0,y:9,w:6,h:3}],sm:[{i:"pnlChart",x:0,y:0,w:4,h:6},{i:"performanceCalendar",x:0,y:6,w:4,h:3},{i:"dailyPerformance",x:0,y:9,w:4,h:3}]}}},activeLayout:"Default",defaultFilters:{dateRange:[null,null],accounts:[],tickers:[],setups:[],tags:[],tradeTypes:[],statuses:[]},lastUsedFilters:{dateRange:[null,null],accounts:[],tickers:[],setups:[],tags:[],tradeTypes:[],statuses:[]}},home:{layouts:{Default:{lg:[{i:"recentItems",x:0,y:0,w:4,h:5},{i:"yearHeatmap",x:4,y:0,w:8,h:5}],md:[{i:"recentItems",x:0,y:0,w:6,h:5},{i:"yearHeatmap",x:0,y:5,w:6,h:5}],sm:[{i:"recentItems",x:0,y:0,w:4,h:5},{i:"yearHeatmap",x:0,y:5,w:4,h:5}],xs:[{i:"recentItems",x:0,y:0,w:2,h:5},{i:"yearHeatmap",x:0,y:5,w:2,h:5}],xxs:[{i:"recentItems",x:0,y:0,w:1,h:5},{i:"yearHeatmap",x:0,y:5,w:1,h:5}]}},activeLayout:"Default",recentItems:[],quickLinks:[{id:"add-trade",label:"Add Trade",icon:"plus-circle",color:"var(--interactive-accent)",action:"addTrade",visible:!0,order:0},{id:"trade-log",label:"Trade Log",icon:"folder-tree",color:"var(--text-accent)",action:"openTradeLog",visible:!0,order:1},{id:"trading-dashboard",label:"Trading Dashboard",icon:"grip",color:"var(--text-accent)",action:"openTradingDashboard",visible:!0,order:2},{id:"account-dashboard",label:"Account Dashboard",icon:"users",color:"var(--text-accent)",action:"openAccountDashboard",visible:!0,order:3},{id:"todays-drc",label:"Today's DRC",icon:"calendar",color:"var(--text-accent)",action:"openTodaysDRC",visible:!0,order:4},{id:"weekly-review",label:"This Week Review",icon:"calendar-check",color:"var(--text-accent)",action:"openWeeklyReview",visible:!0,order:5},{id:"monthly-review",label:"This Month Review",icon:"calendar-range",color:"var(--text-accent)",action:"openMonthlyReview",visible:!0,order:6},{id:"csv-import",label:"CSV Import",icon:"import",color:"var(--text-accent)",action:"openCSVImport",visible:!0,order:7},{id:"layout-builder",label:"Layout Builder",icon:"blocks",color:"var(--text-accent)",action:"openLayoutBuilder",visible:!0,order:8}],activeWidgets:["recentItems","yearHeatmap"],embeddedNotes:{},goals:{},positionSizeDefaults:{riskPercentage:1,accountBalance:void 0,assetType:"stock",lastFuturesSymbol:"ES",lastForexSymbol:"EURUSD"},selectedPeriod:"lifetime"},viewFilters:{dashboard:{dateRange:[null,null],accounts:[],tickers:[],setups:[],tags:[],tradeTypes:[],statuses:[]},reviews:{accounts:[],tickers:[],setups:[],tags:[],tradeTypes:[],statuses:[]}},account:{defaultAccountType:"demo",defaultDrawdownType:"none",defaultDrawdownAmount:0,showBalanceInDashboard:!0,excludedAccountTypes:["archived"],includeWithdrawalsFromExcluded:{archived:!0,demo:!1},accountTypeOrder:["funded","evaluation","demo","archived"],accountMetadata:{}},backendIntegration:{serverUrl:"https://api.journalit.co",syncEnabled:!0,userId:"",showSyncNotifications:!0,showNewTradeNotifications:!0,showUpdateNotifications:!0,lastSeenVersion:"",dismissedVersion:""},csvTemplates:[],csvHiddenBrokers:[],csvFavoriteBroker:void 0,csvFavoriteAccount:void 0,csvLastAssetType:{},initializedOptionTypes:[],symbolMappings:[]}});var ZB,eW=F(()=>{Vc();ZB=async(e,t)=>{await e.uiStateManager.updateState({lastUsedFilters:t})}});function OMe(){let e="journalit-filter-button-styles";if(XI++,XI>1)return;let t=document.createElement("style");t.id=e,t.textContent=FMe,document.head.appendChild(t)}function tW(){var t;let e="journalit-filter-button-styles";XI--,!(XI>0)&&((t=document.head.querySelector(`#${e}`))==null||t.remove())}var hf,dh,FMe,XI,i0=F(()=>{hf=Y(Q());Ot();dh=(0,hf.memo)(({onClick:e,activeFilterCount:t,className:r="",disabled:n=!1})=>((0,hf.useLayoutEffect)(()=>(OMe(),()=>tW()),[]),hf.default.createElement("div",{className:"journalit-filter-button-container"},hf.default.createElement("button",{className:`journalit-filter-button clickable-icon ${r}`,onClick:n?void 0:e,"aria-label":n?"Filters disabled in preview":"Open filters",type:"button",style:n?{cursor:"default",opacity:.6}:void 0},hf.default.createElement(Kg,{size:16})),t>0&&hf.default.createElement("span",{className:"journalit-filter-badge","aria-label":`${t} active filters`},t))));dh.displayName="FilterButton";FMe=`
  /* Filter button container with relative positioning for badge */
  .journalit-filter-button-container {
    position: relative;
    display: inline-flex;
  }

  /* Filter button styles */
  .journalit-filter-button-container .journalit-filter-button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 6px;
    background-color: transparent;
    color: var(--text-normal);
    border: 1px solid transparent;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .journalit-filter-button-container .journalit-filter-button:hover {
    background-color: var(--background-modifier-hover);
  }

  /* Filter badge - small circular indicator */
  .journalit-filter-badge {
    position: absolute;
    top: -4px;
    right: -4px;
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 16px;
    height: 16px;
    padding: 0 4px;
    font-size: 10px;
    font-weight: 600;
    color: white;
    background-color: var(--interactive-accent);
    border-radius: 8px;
    pointer-events: none;
    z-index: 1;
  }
`,XI=0});var Pn,rW,Aee=F(()=>{Pn=Y(Q());ds();nr();qi();rW=Pn.default.memo(({accounts:e,selectedAccounts:t,onChange:r,useOnlyProvidedAccounts:n=!1})=>{let i=Ae(),[a,o]=(0,Pn.useState)([]),[s,l]=(0,Pn.useState)(!1),c=(0,Pn.useRef)(null);(0,Pn.useEffect)(()=>{if(i&&i.optionsService){let v=i.optionsService.getOptions("account");o(v)}},[i]),Xe("options:changed",()=>{if(i&&i.optionsService){let v=i.optionsService.getOptions("account");o(v)}});let d=(0,Pn.useMemo)(()=>n?[...new Set(e)]:[...new Set([...a,...e])],[e,a,n]),u=(0,Pn.useMemo)(()=>d.length>0?[{value:"select-all",label:"-- Select All --"},...d.map(h=>({value:h,label:h}))]:[],[d]);(0,Pn.useEffect)(()=>{let v=h=>{c.current&&!c.current.contains(h.target)&&l(!1)};return document.addEventListener("mousedown",v),()=>{document.removeEventListener("mousedown",v)}},[]);let p=(0,Pn.useCallback)(v=>{v==="select-all"?t.length===d.length?r([]):r([...d]):t.includes(v)?r(t.filter(h=>h!==v)):r([...t,v])},[t,d,r]),m=(0,Pn.useMemo)(()=>t.length===0||t.length===d.length?"All Accounts":t.length===1?t[0]:`${t.length} Accounts`,[t,d]),g=(0,Pn.useMemo)(()=>d.length>0,[d]),f=(0,Pn.useCallback)(()=>l(v=>!v),[]);return Pn.default.createElement("div",{className:"journalit-dashboard-account-filter journalit-responsive-account-filter",ref:c},Pn.default.createElement("div",{className:"journalit-dashboard-account-dropdown"},Pn.default.createElement("div",{className:"journalit-dashboard-account-summary",onClick:f,role:"button",tabIndex:0,onKeyDown:v=>{(v.key==="Enter"||v.key===" ")&&(v.preventDefault(),f())}},Pn.default.createElement("span",{className:"journalit-dashboard-summary-text"},m),Pn.default.createElement("span",{className:"dropdown-arrow"},s?"\u25B2":"\u25BC")),s&&Pn.default.createElement("div",{className:"journalit-dashboard-account-options-dropdown"},g?Pn.default.createElement(Pn.default.Fragment,null,Pn.default.createElement("div",{className:"journalit-dashboard-account-option-item select-all",onClick:()=>p("select-all"),role:"checkbox","aria-checked":t.length===d.length,tabIndex:0,onKeyDown:v=>{(v.key==="Enter"||v.key===" ")&&(v.preventDefault(),p("select-all"))}},Pn.default.createElement("span",{className:`journalit-dashboard-account-checkbox${t.length===d.length?" checked":""}`,"aria-hidden":"true"},t.length===d.length?"\u2713":""),Pn.default.createElement("span",{title:"Select All"},"Select All")),Pn.default.createElement("div",{className:"journalit-dashboard-account-divider"}),d.map(v=>Pn.default.createElement("div",{key:v,className:"journalit-dashboard-account-option-item",onClick:()=>p(v),role:"checkbox","aria-checked":t.includes(v),tabIndex:0,onKeyDown:h=>{(h.key==="Enter"||h.key===" ")&&(h.preventDefault(),p(v))}},Pn.default.createElement("span",{className:`journalit-dashboard-account-checkbox${t.includes(v)?" checked":""}`,"aria-hidden":"true"},t.includes(v)?"\u2713":""),Pn.default.createElement("span",{title:v},v)))):Pn.default.createElement("div",{className:"journalit-dashboard-no-accounts"},"No accounts found"))))});rW.displayName="AccountFilter"});var bn,nW,Lee=F(()=>{bn=Y(Q());ds();nr();qi();nW=bn.default.memo(({tickers:e,selectedTickers:t,onChange:r})=>{let n=Ae(),[i,a]=(0,bn.useState)([]),[o,s]=(0,bn.useState)(!1),l=(0,bn.useRef)(null);(0,bn.useEffect)(()=>{if(n&&n.optionsService){let v=n.optionsService.getOptions("instrument");a(v)}},[n]),Xe("options:changed",()=>{if(n&&n.optionsService){let v=n.optionsService.getOptions("instrument");a(v)}});let c=(0,bn.useMemo)(()=>[...new Set([...i,...e])],[e,i]),d=(0,bn.useMemo)(()=>c.length>0,[c]);(0,bn.useEffect)(()=>{let v=h=>{l.current&&!l.current.contains(h.target)&&s(!1)};return document.addEventListener("mousedown",v),()=>{document.removeEventListener("mousedown",v)}},[]);let u=(0,bn.useCallback)(v=>{v==="select-all"?t.length===c.length?r([]):r([...c]):t.includes(v)?r(t.filter(h=>h!==v)):r([...t,v])},[t,c,r]),p=(0,bn.useMemo)(()=>t.length===0||t.length===c.length?"All Tickers":t.length===1?t[0]:`${t.length} Tickers`,[t,c]),m=(0,bn.useCallback)(()=>s(v=>!v),[]),g=(0,bn.useCallback)(()=>u("select-all"),[u]),f=(0,bn.useCallback)(v=>()=>u(v),[u]);return bn.default.createElement("div",{className:"journalit-dashboard-ticker-filter journalit-responsive-ticker-filter",ref:l},bn.default.createElement("div",{className:"journalit-dashboard-ticker-dropdown"},bn.default.createElement("div",{className:"journalit-dashboard-ticker-summary",onClick:m,role:"button",tabIndex:0,onKeyDown:v=>{(v.key==="Enter"||v.key===" ")&&(v.preventDefault(),m())}},bn.default.createElement("span",{className:"journalit-dashboard-summary-text"},p),bn.default.createElement("span",{className:"dropdown-arrow"},o?"\u25B2":"\u25BC")),o&&bn.default.createElement("div",{className:"journalit-dashboard-ticker-options-dropdown"},d?bn.default.createElement(bn.default.Fragment,null,bn.default.createElement("div",{className:"journalit-dashboard-ticker-option-item select-all",onClick:g,role:"checkbox","aria-checked":t.length===c.length,tabIndex:0,onKeyDown:v=>{(v.key==="Enter"||v.key===" ")&&(v.preventDefault(),g())}},bn.default.createElement("span",{className:`journalit-dashboard-ticker-checkbox${t.length===c.length?" checked":""}`,"aria-hidden":"true"},t.length===c.length?"\u2713":""),bn.default.createElement("span",{title:"Select All"},"Select All")),bn.default.createElement("div",{className:"journalit-dashboard-ticker-divider"}),c.map(v=>bn.default.createElement("div",{key:v,className:"journalit-dashboard-ticker-option-item",onClick:f(v),role:"checkbox","aria-checked":t.includes(v),tabIndex:0,onKeyDown:h=>{(h.key==="Enter"||h.key===" ")&&(h.preventDefault(),u(v))}},bn.default.createElement("span",{className:`journalit-dashboard-ticker-checkbox${t.includes(v)?" checked":""}`,"aria-hidden":"true"},t.includes(v)?"\u2713":""),bn.default.createElement("span",{title:v},v)))):bn.default.createElement("div",{className:"journalit-dashboard-no-tickers"},"No tickers found"))))});nW.displayName="TickerFilter"});var Mn,zMe,Nee,Fee=F(()=>{Mn=Y(Q());ds();zMe=({selected:e,onChange:t,optionsService:r})=>{let[n,i]=(0,Mn.useState)(!1),a=(0,Mn.useRef)(null),o=(0,Mn.useMemo)(()=>r.getOptions("setup"),[r]);(0,Mn.useEffect)(()=>{let u=p=>{a.current&&!a.current.contains(p.target)&&i(!1)};return document.addEventListener("mousedown",u),()=>{document.removeEventListener("mousedown",u)}},[]);let s=(0,Mn.useCallback)(u=>{u==="all"?t([]):u==="__NO_SETUP__"?e.includes("__NO_SETUP__")?t(e.filter(p=>p!=="__NO_SETUP__")):t([...e,"__NO_SETUP__"]):e.includes(u)?t(e.filter(p=>p!==u)):t([...e,u])},[e,t]),l=(0,Mn.useMemo)(()=>e.length===0?"All Setups":e.length===1&&e[0]==="__NO_SETUP__"?"No Setup":e.length===1?e[0]:`${e.length} Setups`,[e]),c=(0,Mn.useCallback)(()=>i(u=>!u),[]),d=e.length===0;return Mn.default.createElement("div",{className:"journalit-dashboard-setup-filter",ref:a},Mn.default.createElement("div",{className:"journalit-dashboard-setup-dropdown"},Mn.default.createElement("div",{className:"journalit-dashboard-setup-summary",onClick:c,role:"button",tabIndex:0,onKeyDown:u=>{(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),c())}},Mn.default.createElement("span",{className:"journalit-dashboard-summary-text"},l),Mn.default.createElement("span",{className:"journalit-dashboard-setup-dropdown-arrow"},n?"\u25B2":"\u25BC")),n&&Mn.default.createElement("div",{className:"journalit-dashboard-setup-options-dropdown"},Mn.default.createElement("div",{className:"journalit-dashboard-setup-option-item journalit-dashboard-setup-option-all",onClick:()=>s("all"),role:"checkbox","aria-checked":d,tabIndex:0,onKeyDown:u=>{(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),s("all"))}},Mn.default.createElement("span",{className:`journalit-dashboard-setup-checkbox${d?" checked":""}`,"aria-hidden":"true"},d?"\u2713":""),Mn.default.createElement("span",{title:"All"},"All")),Mn.default.createElement("div",{className:"journalit-dashboard-setup-divider"}),Mn.default.createElement("div",{className:"journalit-dashboard-setup-option-item",onClick:()=>s("__NO_SETUP__"),role:"checkbox","aria-checked":e.includes("__NO_SETUP__"),tabIndex:0,onKeyDown:u=>{(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),s("__NO_SETUP__"))}},Mn.default.createElement("span",{className:`journalit-dashboard-setup-checkbox${e.includes("__NO_SETUP__")?" checked":""}`,"aria-hidden":"true"},e.includes("__NO_SETUP__")?"\u2713":""),Mn.default.createElement("span",{title:"No Setup"},"No Setup")),o.length>0&&Mn.default.createElement(Mn.default.Fragment,null,Mn.default.createElement("div",{className:"journalit-dashboard-setup-divider"}),o.map(u=>Mn.default.createElement("div",{key:u,className:"journalit-dashboard-setup-option-item",onClick:()=>s(u),role:"checkbox","aria-checked":e.includes(u),tabIndex:0,onKeyDown:p=>{(p.key==="Enter"||p.key===" ")&&(p.preventDefault(),s(u))}},Mn.default.createElement("span",{className:`journalit-dashboard-setup-checkbox${e.includes(u)?" checked":""}`,"aria-hidden":"true"},e.includes(u)?"\u2713":""),Mn.default.createElement("span",{title:u},u)))))))},Nee=Mn.default.memo(zMe)});var Ir,ZI,iW=F(()=>{Ir=Y(Q());ds();nr();qi();ZI=Ir.default.memo(({tags:e,selectedTags:t,onChange:r})=>{let n=Ae(),[i,a]=(0,Ir.useState)([]),[o,s]=(0,Ir.useState)(!1),l=(0,Ir.useRef)(null);(0,Ir.useEffect)(()=>{if(n&&n.optionsService){let y=n.optionsService.getOptions("tag");a(y)}},[n]);let c=(0,Ir.useCallback)(()=>{if(n&&n.optionsService){let y=n.optionsService.getOptions("tag");a(y)}},[n]);Xe("options:changed",c);let d=(0,Ir.useMemo)(()=>[...new Set([...i,...e])],[e,i]),u=(0,Ir.useMemo)(()=>d.length>0,[d]),p=(0,Ir.useMemo)(()=>["__NO_TAGS__",...d],[d]);(0,Ir.useEffect)(()=>{let y=b=>{l.current&&!l.current.contains(b.target)&&s(!1)};return document.addEventListener("mousedown",y),()=>{document.removeEventListener("mousedown",y)}},[]);let m=(0,Ir.useCallback)(y=>{y==="select-all"?t.length===p.length?r([]):r([...p]):y==="__NO_TAGS__"?t.includes("__NO_TAGS__")?r(t.filter(b=>b!=="__NO_TAGS__")):r([...t,"__NO_TAGS__"]):t.includes(y)?r(t.filter(b=>b!==y)):r([...t,y])},[t,p,r]),g=(0,Ir.useMemo)(()=>t.length===0||t.length===p.length?"All Tags":t.length===1&&t[0]==="__NO_TAGS__"?"No Tags":t.length===1?t[0]:`${t.length} Tags`,[t,p]),f=(0,Ir.useCallback)(()=>s(y=>!y),[]),v=(0,Ir.useCallback)(()=>m("select-all"),[m]),h=(0,Ir.useCallback)(y=>()=>m(y),[m]);return Ir.default.createElement("div",{className:"journalit-dashboard-tag-filter journalit-responsive-tag-filter",ref:l},Ir.default.createElement("div",{className:"journalit-dashboard-tag-dropdown"},Ir.default.createElement("div",{className:"journalit-dashboard-tag-summary",onClick:f,role:"button",tabIndex:0,onKeyDown:y=>{(y.key==="Enter"||y.key===" ")&&(y.preventDefault(),f())}},Ir.default.createElement("span",{className:"journalit-dashboard-summary-text"},g),Ir.default.createElement("span",{className:"dropdown-arrow"},o?"\u25B2":"\u25BC")),o&&Ir.default.createElement("div",{className:"journalit-dashboard-tag-options-dropdown"},u||t.includes("__NO_TAGS__")?Ir.default.createElement(Ir.default.Fragment,null,Ir.default.createElement("div",{className:"journalit-dashboard-tag-option-item select-all",onClick:v,role:"checkbox","aria-checked":t.length===p.length,tabIndex:0,onKeyDown:y=>{(y.key==="Enter"||y.key===" ")&&(y.preventDefault(),v())}},Ir.default.createElement("span",{className:`journalit-dashboard-tag-checkbox${t.length===p.length?" checked":""}`,"aria-hidden":"true"},t.length===p.length?"\u2713":""),Ir.default.createElement("span",{title:"Select All"},"Select All")),Ir.default.createElement("div",{className:"journalit-dashboard-tag-divider"}),Ir.default.createElement("div",{className:"journalit-dashboard-tag-option-item",onClick:h("__NO_TAGS__"),role:"checkbox","aria-checked":t.includes("__NO_TAGS__"),tabIndex:0,onKeyDown:y=>{(y.key==="Enter"||y.key===" ")&&(y.preventDefault(),m("__NO_TAGS__"))}},Ir.default.createElement("span",{className:`journalit-dashboard-tag-checkbox${t.includes("__NO_TAGS__")?" checked":""}`,"aria-hidden":"true"},t.includes("__NO_TAGS__")?"\u2713":""),Ir.default.createElement("span",{title:"No Tags"},"No Tags")),u&&Ir.default.createElement(Ir.default.Fragment,null,Ir.default.createElement("div",{className:"journalit-dashboard-tag-divider"}),d.map(y=>Ir.default.createElement("div",{key:y,className:"journalit-dashboard-tag-option-item",onClick:h(y),role:"checkbox","aria-checked":t.includes(y),tabIndex:0,onKeyDown:b=>{(b.key==="Enter"||b.key===" ")&&(b.preventDefault(),m(y))}},Ir.default.createElement("span",{className:`journalit-dashboard-tag-checkbox${t.includes(y)?" checked":""}`,"aria-hidden":"true"},t.includes(y)?"\u2713":""),Ir.default.createElement("span",{title:y},y))))):Ir.default.createElement("div",{className:"journalit-dashboard-no-tags"},"No tags found"))))});ZI.displayName="TagFilter"});var Gi,aW,oW,Oee=F(()=>{Gi=Y(Q()),aW=[{value:"all",label:"All",description:"All trade types"},{value:"regular",label:"Regular",description:"Standard trades"},{value:"missed",label:"Missed",description:"Missed opportunities"},{value:"backtest",label:"Backtest",description:"Simulated trades"}],oW=Gi.default.memo(({selectedTradeTypes:e,onChange:t})=>{let[r,n]=(0,Gi.useState)(!1),i=(0,Gi.useRef)(null);(0,Gi.useEffect)(()=>{let d=u=>{i.current&&!i.current.contains(u.target)&&n(!1)};return document.addEventListener("mousedown",d),()=>{document.removeEventListener("mousedown",d)}},[]);let a=(0,Gi.useCallback)(d=>{d==="all"?e.length===aW.length-1?t([]):t(["regular","missed","backtest"]):e.includes(d)?t(e.filter(u=>u!==d)):t([...e,d])},[e,t]),o=(0,Gi.useMemo)(()=>{if(e.length===0||e.length===3)return"All Types";if(e.length===1){let d=aW.find(u=>u.value===e[0]);return(d==null?void 0:d.label)||e[0]}return`${e.length} Types`},[e]),s=(0,Gi.useMemo)(()=>e.length===3,[e]),l=(0,Gi.useCallback)(()=>n(d=>!d),[]),c=(d,u)=>{(d.key==="Enter"||d.key===" ")&&(d.preventDefault(),u())};return Gi.default.createElement("div",{className:"journalit-tradelog-trade-type-filter",ref:i},Gi.default.createElement("div",{className:"journalit-tradelog-trade-type-dropdown"},Gi.default.createElement("div",{className:"journalit-tradelog-trade-type-summary",role:"button",tabIndex:0,"aria-expanded":r,"aria-haspopup":"true",onClick:l,onKeyDown:d=>c(d,l)},o,Gi.default.createElement("span",{className:"dropdown-arrow"},r?"\u25B2":"\u25BC")),r&&Gi.default.createElement("div",{className:"journalit-tradelog-trade-type-options-dropdown"},Gi.default.createElement("div",{className:"journalit-tradelog-trade-type-option-item select-all",role:"checkbox",tabIndex:0,"aria-checked":s,onClick:()=>a("all"),onKeyDown:d=>c(d,()=>a("all"))},Gi.default.createElement("span",{className:`journalit-tradelog-checkbox journalit-tradelog-trade-type-checkbox${s?" checked":""}`,"aria-hidden":"true"},s?"\u2713":""),Gi.default.createElement("span",null,"Select All")),Gi.default.createElement("div",{className:"journalit-tradelog-trade-type-divider"}),aW.slice(1).map(d=>Gi.default.createElement("div",{key:d.value,className:"journalit-tradelog-trade-type-option-item",role:"checkbox",tabIndex:0,"aria-checked":e.includes(d.value),onClick:()=>a(d.value),onKeyDown:u=>c(u,()=>a(d.value)),title:d.description},Gi.default.createElement("span",{className:`journalit-tradelog-checkbox journalit-tradelog-trade-type-checkbox${e.includes(d.value)?" checked":""}`,"aria-hidden":"true"},e.includes(d.value)?"\u2713":""),Gi.default.createElement("span",null,d.label))))))});oW.displayName="TradeTypeFilter"});var An,zee,sW,jee=F(()=>{An=Y(Q()),zee=[{value:"all",label:"All",description:"All trade statuses"},{value:"open",label:"Open",description:"Currently open positions"},{value:"closed",label:"Closed",description:"All closed positions (win/loss/breakeven)"},{value:"win",label:"Win",description:"Winning trades"},{value:"loss",label:"Loss",description:"Losing trades"},{value:"breakeven",label:"Breakeven",description:"Breakeven trades"}],sW=An.default.memo(({selectedStatuses:e,onChange:t})=>{let[r,n]=(0,An.useState)(!1),i=(0,An.useRef)(null);(0,An.useEffect)(()=>{let u=p=>{i.current&&!i.current.contains(p.target)&&n(!1)};return document.addEventListener("mousedown",u),()=>{document.removeEventListener("mousedown",u)}},[]);let a=(0,An.useCallback)(u=>{if(u==="all")e.length===4?t([]):t(["open","win","loss","breakeven"]);else if(u==="closed"){let p=["win","loss","breakeven"];if(p.every(g=>e.includes(g)))t(e.filter(g=>!p.includes(g)));else{let g=[...new Set([...e.filter(f=>f!=="closed"),...p])];t(g)}}else e.includes(u)?t(e.filter(p=>p!==u)):t([...e.filter(p=>p!=="closed"),u])},[e,t]),o=(0,An.useMemo)(()=>{if(e.length===0||e.length===4)return"All Statuses";if(e.length===1){let m=zee.find(g=>g.value===e[0]);return(m==null?void 0:m.label)||e[0]}return["win","loss","breakeven"].every(m=>e.includes(m))&&e.length===3?"Closed":`${e.length} Statuses`},[e]),s=(0,An.useMemo)(()=>e.length===4,[e]),l=(0,An.useMemo)(()=>["win","loss","breakeven"].every(p=>e.includes(p)),[e]),c=(0,An.useCallback)(()=>n(u=>!u),[]),d=(u,p)=>{(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),p())};return An.default.createElement("div",{className:"journalit-tradelog-status-filter",ref:i},An.default.createElement("div",{className:"journalit-tradelog-status-dropdown"},An.default.createElement("div",{className:"journalit-tradelog-status-summary",role:"button",tabIndex:0,"aria-expanded":r,"aria-haspopup":"true",onClick:c,onKeyDown:u=>d(u,c)},o,An.default.createElement("span",{className:"dropdown-arrow"},r?"\u25B2":"\u25BC")),r&&An.default.createElement("div",{className:"journalit-tradelog-status-options-dropdown"},An.default.createElement("div",{className:"journalit-tradelog-status-option-item select-all",onClick:()=>a("all"),role:"checkbox",tabIndex:0,"aria-checked":s,onKeyDown:u=>d(u,()=>a("all"))},An.default.createElement("span",{className:`journalit-tradelog-checkbox journalit-tradelog-status-checkbox${s?" checked":""}`,"aria-hidden":"true"},s?"\u2713":""),An.default.createElement("span",null,"Select All")),An.default.createElement("div",{className:"journalit-tradelog-status-divider"}),zee.slice(1).map(u=>u.value==="closed"?An.default.createElement("div",{key:u.value,className:"journalit-tradelog-status-option-item",onClick:()=>a(u.value),title:u.description,role:"checkbox",tabIndex:0,"aria-checked":l,onKeyDown:p=>d(p,()=>a(u.value))},An.default.createElement("span",{className:`journalit-tradelog-checkbox journalit-tradelog-status-checkbox${l?" checked":""}`,"aria-hidden":"true"},l?"\u2713":""),An.default.createElement("span",null,u.label)):["win","loss","breakeven"].includes(u.value)?An.default.createElement("div",{key:u.value,className:"journalit-tradelog-status-option-item sub-option",onClick:()=>a(u.value),title:u.description,role:"checkbox",tabIndex:0,"aria-checked":e.includes(u.value),onKeyDown:p=>d(p,()=>a(u.value))},An.default.createElement("span",{className:`journalit-tradelog-checkbox journalit-tradelog-status-checkbox${e.includes(u.value)?" checked":""}`,"aria-hidden":"true"},e.includes(u.value)?"\u2713":""),An.default.createElement("span",null,u.label)):An.default.createElement("div",{key:u.value,className:"journalit-tradelog-status-option-item",onClick:()=>a(u.value),title:u.description,role:"checkbox",tabIndex:0,"aria-checked":e.includes(u.value),onKeyDown:p=>d(p,()=>a(u.value))},An.default.createElement("span",{className:`journalit-tradelog-checkbox journalit-tradelog-status-checkbox${e.includes(u.value)?" checked":""}`,"aria-hidden":"true"},e.includes(u.value)?"\u2713":""),An.default.createElement("span",null,u.label))))))});sW.displayName="StatusFilter"});function _Me(){if(eM++,eM>1)return;let e=document.createElement("style");e.id="journalit-filter-chip-styles",e.textContent=jMe,document.head.appendChild(e)}function lW(){if(eM--,eM>0)return;let e=document.head.querySelector("#journalit-filter-chip-styles");e&&e.remove()}var $u,jMe,eM,cW,tM=F(()=>{$u=Y(Q());Ot();jMe=`
.journalit-filter-chip {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 2px 6px 2px 8px;
  font-size: 11px;
  font-weight: 500;
  color: var(--text-normal);
  background-color: rgba(var(--interactive-accent-rgb), 0.15);
  border: 1px solid var(--interactive-accent);
  border-radius: 10px;
  white-space: nowrap;
  transition: background-color 0.2s ease;
}

.journalit-filter-chip:hover {
  background-color: rgba(var(--interactive-accent-rgb), 0.25);
}

.journalit-filter-chip-label {
  line-height: 1.2;
  max-width: 150px;
  overflow: hidden;
  text-overflow: ellipsis;
  display: inline-block;
}

.journalit-filter-chip-remove {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 14px;
  height: 14px;
  padding: 0;
  background: transparent;
  border: none;
  cursor: pointer;
  color: var(--text-normal);
  border-radius: 50%;
  transition: background-color 0.15s ease, color 0.15s ease;
  line-height: 0;
}

.journalit-filter-chip-remove:hover {
  background-color: rgba(0, 0, 0, 0.1);
  color: var(--text-on-accent);
}

.journalit-filter-chip-remove:focus {
  outline: 2px solid var(--interactive-accent);
  outline-offset: 1px;
}
`,eM=0;cW=(0,$u.memo)(({label:e,onRemove:t,className:r=""})=>{$u.default.useEffect(()=>(_Me(),()=>lW()),[]);let n=(0,$u.useCallback)(a=>{a.stopPropagation(),t()},[t]),i=(0,$u.useCallback)(a=>{a.key===" "&&(a.preventDefault(),t())},[t]);return $u.default.createElement("div",{className:`journalit-filter-chip ${r}`},$u.default.createElement("span",{className:"journalit-filter-chip-label"},e),$u.default.createElement("button",{className:"journalit-filter-chip-remove",onClick:n,onKeyDown:i,"aria-label":`Remove ${e} filter`,type:"button"},$u.default.createElement(La,{size:10})))});cW.displayName="FilterChip"});function WMe(){if(rM++,rM>1)return;let e=document.createElement("style");e.id="journalit-collapsible-section-styles",e.textContent=BMe,document.head.appendChild(e)}function dW(){if(rM--,rM>0)return;let e=document.head.querySelector("#journalit-collapsible-section-styles");e&&e.remove()}var Fs,BMe,rM,my,t1=F(()=>{Fs=Y(Q());Ot();BMe=`
.journalit-collapsible-section {
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  background: var(--background-primary);
  margin-bottom: 12px;
}

.journalit-collapsible-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
  padding: 10px 12px;
  background: transparent;
  border: none;
  cursor: pointer;
  color: var(--text-normal);
  font-size: 13px;
  font-weight: 600;
  text-align: left;
  transition: background-color 0.15s ease;
  border-radius: 6px;
}

.journalit-collapsible-header:hover {
  background: var(--background-modifier-hover);
}

.journalit-collapsible-header:focus {
  outline: 2px solid var(--interactive-accent);
  outline-offset: -2px;
}

.journalit-collapsible-header-left {
  display: flex;
  align-items: center;
  gap: 8px;
}

.journalit-collapsible-title {
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  font-size: 11px;
}

.journalit-collapsible-header.has-active-filters .journalit-collapsible-title {
  color: var(--text-normal);
  font-weight: 700;
}

.journalit-collapsible-badge {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 18px;
  height: 18px;
  padding: 0 5px;
  font-size: 10px;
  font-weight: 600;
  color: var(--text-on-accent);
  background-color: var(--interactive-accent);
  border-radius: 9px;
}

.journalit-collapsible-chevron {
  display: flex;
  align-items: center;
  color: var(--text-muted);
  transition: transform 0.2s ease;
}

.journalit-collapsible-chevron.open {
  transform: rotate(180deg);
}

.journalit-collapsible-content {
  padding: 12px 12px 12px 12px;
  display: flex;
  justify-content: center;
  animation: expandDown 0.2s ease-out;
}

@keyframes expandDown {
  from {
    opacity: 0;
    transform: translateY(-4px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
`,rM=0;my=(0,Fs.memo)(({title:e,children:t,defaultOpen:r=!0,isOpen:n,onToggle:i,badge:a,className:o=""})=>{Fs.default.useEffect(()=>(WMe(),()=>dW()),[]);let[s,l]=(0,Fs.useState)(r),c=n!==void 0,d=c?n:s,u=(0,Fs.useCallback)(()=>{let m=!d;c||l(m),i==null||i(m)},[d,c,i]),p=(0,Fs.useCallback)(m=>{(m.key==="Enter"||m.key===" ")&&(m.preventDefault(),u())},[u]);return Fs.default.createElement("div",{className:`journalit-collapsible-section ${o}`},Fs.default.createElement("button",{className:`journalit-collapsible-header ${a&&a>0?"has-active-filters":""}`,onClick:u,onKeyDown:p,"aria-expanded":d,type:"button"},Fs.default.createElement("div",{className:"journalit-collapsible-header-left"},Fs.default.createElement("span",{className:"journalit-collapsible-title"},e),a!==void 0&&a>0&&Fs.default.createElement("span",{className:"journalit-collapsible-badge","aria-label":`${a} active filters`},a)),Fs.default.createElement("span",{className:`journalit-collapsible-chevron ${d?"open":""}`},Fs.default.createElement(cs,{size:16}))),d&&Fs.default.createElement("div",{className:"journalit-collapsible-content"},t))});my.displayName="CollapsibleSection"});var sr,nM,uW=F(()=>{sr=Y(Q());hi();Aee();Lee();Fee();iW();Oee();jee();tM();t1();nM=sr.default.memo(({app:e,plugin:t,context:r,currentFilters:n,onApply:i,onModalClose:a,availableAccounts:o=[]})=>{let[s,l]=(0,sr.useState)(n),c=(0,sr.useCallback)(S=>{l(w=>({...w,accounts:S}))},[]),d=(0,sr.useCallback)(S=>{l(w=>({...w,tickers:S}))},[]),u=(0,sr.useCallback)(S=>{l(w=>({...w,setups:S}))},[]),p=(0,sr.useCallback)(S=>{l(w=>({...w,tags:S}))},[]),m=(0,sr.useCallback)(S=>{l(w=>({...w,tradeTypes:S}))},[]),g=(0,sr.useCallback)(S=>{l(w=>({...w,statuses:S}))},[]),f=(0,sr.useCallback)(()=>{l({accounts:[],tickers:[],setups:[],tags:[],tradeTypes:[],statuses:[]})},[]),v=(0,sr.useCallback)(()=>{i(s),a()},[s,i,a]),h=(0,sr.useCallback)(()=>{a()},[a]),y=(0,sr.useMemo)(()=>{let S=[];return s.accounts.length>0&&s.accounts.forEach(w=>{S.push({key:`account-${w}`,label:w,onRemove:()=>{l(C=>({...C,accounts:C.accounts.filter(D=>D!==w)}))}})}),s.tickers.length>0&&s.tickers.forEach(w=>{S.push({key:`ticker-${w}`,label:w,onRemove:()=>{l(C=>({...C,tickers:C.tickers.filter(D=>D!==w)}))}})}),s.setups.length>0&&s.setups.forEach(w=>{S.push({key:`setup-${w}`,label:w==="__NO_SETUP__"?"No Setup":w,onRemove:()=>{l(C=>({...C,setups:C.setups.filter(D=>D!==w)}))}})}),s.tags&&s.tags.length>0&&s.tags.forEach(w=>{S.push({key:`tag-${w}`,label:w==="__NO_TAGS__"?"No Tags":w,onRemove:()=>{l(C=>({...C,tags:C.tags?C.tags.filter(D=>D!==w):[]}))}})}),s.tradeTypes.length>0&&s.tradeTypes.forEach(w=>{S.push({key:`tradetype-${w}`,label:w.charAt(0).toUpperCase()+w.slice(1),onRemove:()=>{l(C=>({...C,tradeTypes:C.tradeTypes.filter(D=>D!==w)}))}})}),s.statuses.length>0&&s.statuses.forEach(w=>{S.push({key:`status-${w}`,label:w.charAt(0).toUpperCase()+w.slice(1),onRemove:()=>{l(C=>({...C,statuses:C.statuses.filter(D=>D!==w)}))}})}),S},[s]),b=(0,sr.useMemo)(()=>s.accounts.length+s.tickers.length,[s.accounts,s.tickers]),k=(0,sr.useMemo)(()=>{var S;return s.setups.length+(((S=s.tags)==null?void 0:S.length)||0)},[s.setups,s.tags]),x=(0,sr.useMemo)(()=>s.tradeTypes.length+s.statuses.length,[s.tradeTypes,s.statuses]);return sr.default.createElement(sr.default.Fragment,null,sr.default.createElement("div",{className:"filter-modal-scroll-area"},sr.default.createElement("div",{className:"filter-modal-active-filters"},sr.default.createElement("div",{className:"filter-modal-active-filters-header"},sr.default.createElement("span",{className:"filter-modal-active-filters-label"},y.length>0?`Active filters (${y.length}):`:"No active filters"),y.length>0&&sr.default.createElement("button",{className:"filter-modal-clear-all",onClick:f,type:"button"},"Clear all")),y.length>0&&sr.default.createElement("div",{className:"filter-modal-chips"},y.map(S=>sr.default.createElement(cW,{key:S.key,label:S.label,onRemove:S.onRemove})))),sr.default.createElement("div",{className:"filter-modal-sections"},sr.default.createElement(my,{title:"Trading Data",badge:b,defaultOpen:!0},sr.default.createElement("div",{className:"filter-modal-section-grid-2col"},sr.default.createElement("div",{className:"filter-modal-controls"},sr.default.createElement(rW,{accounts:o,selectedAccounts:s.accounts,onChange:c,useOnlyProvidedAccounts:!1})),sr.default.createElement("div",{className:"filter-modal-controls"},sr.default.createElement(nW,{tickers:s.tickers,selectedTickers:s.tickers,onChange:d})))),sr.default.createElement(my,{title:"Classification",badge:k,defaultOpen:!0},sr.default.createElement("div",{className:"filter-modal-section-grid-2col"},sr.default.createElement("div",{className:"filter-modal-controls"},t.optionsService&&sr.default.createElement(Nee,{selected:s.setups,onChange:u,optionsService:t.optionsService})),sr.default.createElement("div",{className:"filter-modal-controls"},t.optionsService&&sr.default.createElement(ZI,{tags:[],selectedTags:s.tags||[],onChange:p})))),sr.default.createElement(my,{title:"Trade Criteria",badge:x,defaultOpen:!0},sr.default.createElement("div",{className:"filter-modal-section-grid-2col"},sr.default.createElement("div",{className:"filter-modal-controls"},sr.default.createElement(oW,{selectedTradeTypes:s.tradeTypes,onChange:m})),sr.default.createElement("div",{className:"filter-modal-controls"},sr.default.createElement(sW,{selectedStatuses:s.statuses,onChange:g})))))),sr.default.createElement("div",{className:"filter-modal-buttons"},sr.default.createElement(Ie,{variant:"secondary",onClick:h},"Cancel"),sr.default.createElement(Ie,{variant:"primary",onClick:v},"Apply")))});nM.displayName="FilterModalContent"});function _ee(){if(document.head.querySelector("#journalit-filter-modal-styles")){iM=!0;return}let e=document.createElement("style");e.id="journalit-filter-modal-styles",e.textContent=$Me,document.head.appendChild(e),iM=!0}function pW(){let e=document.head.querySelector("#journalit-filter-modal-styles");e&&(e.remove(),iM=!1)}function mW(){iM||_ee()}var $Me,iM,aM=F(()=>{$Me=`
/* React Root Container */
.filter-modal-content {
  display: flex;
  flex-direction: column;
  flex: 1;
  min-height: 0;
}

/* Filter Modal Scroll Area - Minimal padding */
.filter-modal-scroll-area {
  flex: 1;
  min-height: 0;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 12px;
}

/* Active Filter Chips Area */
.filter-modal-active-filters {
  margin-bottom: 16px;
  padding: 12px;
  background: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
}

.filter-modal-active-filters-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}

.filter-modal-active-filters-label {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.filter-modal-clear-all {
  padding: 4px 8px;
  font-size: 11px;
  font-weight: 500;
  color: var(--text-accent);
  background: transparent;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  transition: background-color 0.15s ease;
}

.filter-modal-clear-all:hover {
  background: var(--background-modifier-hover);
}

.filter-modal-chips {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
}

/* Filter Sections Container */
.filter-modal-sections {
  display: flex;
  flex-direction: column;
}

/* Section Grid Layout - Grid within each collapsible section */
.filter-modal-section-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 12px;
}

/* 2-column grid for Trading Data section - centered and consistent spacing */
.filter-modal-section-grid-2col {
  display: grid;
  grid-template-columns: repeat(2, 150px);
  gap: 16px;
}

/* 3-column grid for Trade Criteria section - fixed to prevent wrapping */
.filter-modal-section-grid-3col {
  display: grid;
  grid-template-columns: repeat(3, 150px);
  gap: 12px;
}

/* Filter Controls - Minimal wrapper */
.filter-modal-controls {
  display: flex;
  flex-direction: column;
}

/* Standardize filter dropdown widths - consistent across all filters */
.filter-modal-controls .journalit-dashboard-account-summary,
.filter-modal-controls .journalit-dashboard-ticker-summary,
.filter-modal-controls .journalit-dashboard-setup-summary,
.filter-modal-controls .journalit-tradelog-trade-type-summary,
.filter-modal-controls .journalit-tradelog-status-summary {
  width: 150px;
  min-width: 150px;
  max-width: 150px;
}

/* Button Container - Simple border-top separator */
.filter-modal-buttons {
  position: sticky;
  bottom: 0;
  background: var(--background-primary);
  border-top: 1px solid var(--background-modifier-border);
  padding: 12px;
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  flex-shrink: 0;
}

.filter-modal-buttons .journalit-button {
  min-width: 80px;
}

.filter-modal-buttons .journalit-button--primary {
  background: var(--interactive-accent) !important;
  color: var(--text-on-accent) !important;
  border-color: var(--interactive-accent) !important;
}

.filter-modal-buttons .journalit-button--primary:hover:not(:disabled) {
  background: var(--interactive-accent-hover) !important;
  border-color: var(--interactive-accent-hover) !important;
}

/* Mobile Responsive */
@media (max-width: 768px) {
  .filter-modal-section-grid,
  .filter-modal-section-grid-2col,
  .filter-modal-section-grid-3col {
    grid-template-columns: 1fr;
    gap: 12px;
  }

  .filter-modal-section-grid-2col {
    max-width: 100%;
  }

  .filter-modal-scroll-area {
    padding: 12px;
  }

  .filter-modal-active-filters {
    padding: 10px;
  }

  .filter-modal-chips {
    gap: 8px;
  }

  .filter-modal-buttons {
    flex-direction: column;
    gap: 8px;
    padding: 12px;
  }

  .filter-modal-buttons .journalit-button {
    width: 100%;
  }
}

/* Standardize dropdown positioning when opened - match button width */
.filter-modal-controls .journalit-dashboard-account-options-dropdown,
.filter-modal-controls .journalit-dashboard-ticker-options-dropdown,
.filter-modal-controls .journalit-dashboard-setup-options-dropdown,
.filter-modal-controls .journalit-tradelog-status-options-dropdown,
.filter-modal-controls .journalit-tradelog-trade-type-options-dropdown {
  max-height: none !important;
  width: 150px;
  overflow: visible !important;
}

/* Trade Type Filter Styles */
.journalit-tradelog-trade-type-filter {
  display: flex;
  flex-direction: column;
  position: relative;
  min-width: 140px;
}

.journalit-tradelog-trade-type-dropdown {
  position: relative;
}

.journalit-tradelog-trade-type-summary {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 5px 10px;
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  cursor: pointer;
  font-size: 0.9em;
  white-space: nowrap;
  gap: 8px;
}

.journalit-tradelog-trade-type-summary:hover {
  border-color: var(--interactive-accent);
  background-color: var(--background-modifier-hover);
}

.journalit-tradelog-trade-type-options-dropdown {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  margin-top: 4px;
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  max-height: 300px;
  overflow-y: auto;
  z-index: 100;
}

.journalit-tradelog-trade-type-option-item {
  display: flex;
  align-items: center;
  padding: 6px 10px;
  cursor: pointer;
  gap: 8px;
}

.journalit-tradelog-trade-type-option-item:hover {
  background-color: var(--background-modifier-hover);
}

.journalit-tradelog-trade-type-checkbox {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 14px;
  height: 14px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 2px;
  background-color: var(--background-primary);
  font-size: 10px;
  color: var(--text-on-accent);
  flex-shrink: 0;
}

.journalit-tradelog-trade-type-checkbox.checked {
  background-color: var(--interactive-accent);
  border-color: var(--interactive-accent);
}

.journalit-tradelog-trade-type-divider {
  height: 1px;
  background-color: var(--background-modifier-border);
  margin: 4px 0;
}

/* Status Filter Styles */
.journalit-tradelog-status-filter {
  display: flex;
  flex-direction: column;
  position: relative;
  min-width: 140px;
}

.journalit-tradelog-status-dropdown {
  position: relative;
}

.journalit-tradelog-status-summary {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 5px 10px;
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  cursor: pointer;
  font-size: 0.9em;
  white-space: nowrap;
  gap: 8px;
}

.journalit-tradelog-status-summary:hover {
  border-color: var(--interactive-accent);
  background-color: var(--background-modifier-hover);
}

.journalit-tradelog-status-options-dropdown {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  margin-top: 4px;
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  max-height: 300px;
  overflow-y: auto;
  z-index: 100;
}

.journalit-tradelog-status-option-item {
  display: flex;
  align-items: center;
  padding: 6px 10px;
  cursor: pointer;
  gap: 8px;
}

.journalit-tradelog-status-option-item:hover {
  background-color: var(--background-modifier-hover);
}

.journalit-tradelog-status-option-item.sub-option {
  padding-left: 24px;
}

.journalit-tradelog-status-checkbox {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 14px;
  height: 14px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 2px;
  background-color: var(--background-primary);
  font-size: 10px;
  color: var(--text-on-accent);
  flex-shrink: 0;
}

.journalit-tradelog-status-checkbox.checked {
  background-color: var(--interactive-accent);
  border-color: var(--interactive-accent);
}

.journalit-tradelog-status-divider {
  height: 1px;
  background-color: var(--background-modifier-border);
  margin: 4px 0;
}
`,iM=!1});function fy(e){new oM(e).open()}var Bee,Wee,$ee,oM,Ree=F(()=>{Bee=require("obsidian"),Wee=Y(Q()),$ee=Y(Ni());uW();aM();oM=class extends Bee.Modal{constructor(r){super(r.app);this.root=null;this.titleEl.setText("Advanced Filters"),this.props=r}onOpen(){let{contentEl:r}=this;r.empty(),mW(),this.container=r.createDiv({cls:"filter-modal-content"}),r.style.display="flex",r.style.flexDirection="column",r.style.minHeight="500px",r.style.maxHeight="80vh",this.renderComponent()}onClose(){this.root&&this.root.unmount(),this.props.onClose()}renderComponent(){this.root=(0,$ee.createRoot)(this.container),this.root.render(Wee.default.createElement(nM,{...this.props,onModalClose:()=>this.close()}))}}});var sM=F(()=>{Ree();uW();aM()});var r1=F(()=>{});function a0(e,t=RMe){var a,o;let r={};for(let s of e){let l=(a=s.pnl)!=null?a:0,c=s.currency||t;r[c]||(r[c]=0),r[c]+=l}let n=Object.keys(r).sort(),i=n.length>1;return{byCurrency:r,isMultiCurrency:i,currencies:n,singleTotal:i?void 0:(o=r[n[0]])!=null?o:0,defaultCurrency:n[0]||t}}function UMe(e){return PX(e)?sI[e].decimalPlaces:e==="JPY"?0:2}function gy(e,t,r=!1){let n=UMe(t),i=new Intl.NumberFormat("en-US",{style:"currency",currency:t,minimumFractionDigits:n,maximumFractionDigits:n,signDisplay:r?"exceptZero":"auto"});try{return i.format(e)}catch(a){return`${r&&e>0?"+":""}${t} ${e.toFixed(n)}`}}function lM(e,t=!1){return!e.isMultiCurrency&&e.singleTotal!==void 0?gy(e.singleTotal,e.defaultCurrency,t):e.currencies.map(r=>gy(e.byCurrency[r],r,t))}var RMe,o0=F(()=>{As();RMe="USD"});function Uee(e){return HMe.includes(e)}var HMe,fW=F(()=>{HMe=["AUD","BGN","BRL","CAD","CHF","CNY","CZK","DKK","EUR","GBP","HKD","HUF","IDR","ILS","INR","ISK","JPY","KRW","MXN","MYR","NOK","NZD","PHP","PLN","RON","SEK","SGD","THB","TRY","USD","ZAR"]});var Hee,qMe,VMe,gW,hy,qee=F(()=>{Hee=require("obsidian");fW();qMe="https://api.frankfurter.app",VMe=1440*60*1e3,gW="journalit-exchange-rates",hy=class{constructor(t){this.memoryCache=null;this.plugin=t}async getRates(t){if(this.memoryCache&&this.memoryCache.baseCurrency===t&&this.isCacheFresh(this.memoryCache.cachedAt))return this.memoryCache;let r=this.loadFromStorage();if(r&&r.baseCurrency===t&&this.isCacheFresh(r.cachedAt))return this.memoryCache=r,r;try{let n=await this.fetchRates(t);if(n)return this.memoryCache=n,this.saveToStorage(n),n}catch(n){console.warn("[ExchangeRateService] Failed to fetch rates:",n)}return r&&r.baseCurrency===t?(console.warn("[ExchangeRateService] Using stale cache"),this.memoryCache=r,r):null}async fetchRates(t){if(!Uee(t))return console.warn(`[ExchangeRateService] Base currency ${t} not supported by Frankfurter`),null;try{let r=await(0,Hee.requestUrl)({url:`${qMe}/latest?base=${t}`,method:"GET",throw:!1});if(r.status!==200)return console.error(`[ExchangeRateService] API returned ${r.status}`),null;let n=r.json,i={...n.rates};return i[t]=1,{baseCurrency:t,rates:i,rateDate:n.date,cachedAt:Date.now()}}catch(r){return console.error("[ExchangeRateService] Network error:",r),null}}async convertPnLToBaseCurrency(t,r){let n=Object.keys(t);if(n.length===1&&n[0]===r)return{total:t[r],baseCurrency:r,fullyConverted:!0,unconvertedCurrencies:[],originalByCurrency:t,convertedByCurrency:{[r]:t[r]},rateDate:new Date().toISOString().split("T")[0]};let i=await this.getRates(r);if(!i)return null;let a={},o=[],s=0;for(let[l,c]of Object.entries(t))if(l===r)a[l]=c,s+=c;else if(i.rates[l]!==void 0){let d=i.rates[l],u=c/d;a[l]=u,s+=u}else o.push(l);return{total:s,baseCurrency:r,fullyConverted:o.length===0,unconvertedCurrencies:o,originalByCurrency:t,convertedByCurrency:a,rateDate:i.rateDate}}async convertTrades(t,r,n=r){let i=await this.getRates(r);if(!i)return null;let a=new Set,s=t.map(l=>{var p;let c=l.currency||n;if(c===r)return l;let d=i.rates[c];if(d===void 0)return a.add(c),null;let u=((p=l.pnl)!=null?p:0)/d;return{...l,pnl:u}}).filter(l=>l!==null);return{trades:s,baseCurrency:r,rateDate:i.rateDate,unconvertedCurrencies:Array.from(a),originalTradeCount:t.length,convertedTradeCount:s.length}}isCacheFresh(t){return Date.now()-t<VMe}loadFromStorage(){try{let t=localStorage.getItem(gW);if(t)return JSON.parse(t)}catch(t){console.warn("[ExchangeRateService] Failed to load cache:",t)}return null}saveToStorage(t){try{localStorage.setItem(gW,JSON.stringify(t))}catch(r){console.warn("[ExchangeRateService] Failed to save cache:",r)}}clearCache(){this.memoryCache=null;try{localStorage.removeItem(gW)}catch(t){}}}});var hW=F(()=>{qee();fW()});var vW,yW,Vee,vy,GMe,cM,Gee,yy=F(()=>{Jn();qt();r1();_t();o0();hW();vW=(e,t)=>{if(!e)return t||new Date;let r=new Date(e);return isNaN(r.getTime())?t||new Date:r},yW=class{constructor(t=50){this.maxSize=t,this.cache=new Map}get(t){if(this.cache.has(t)){let r=this.cache.get(t);return this.cache.delete(t),this.cache.set(t,r),r}}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){let n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(t,r)}has(t){return this.cache.has(t)}clear(){this.cache.clear()}size(){return this.cache.size}},Vee=new yW(50),vy=e=>e.tradeStatus==="CLOSED"?!1:e.tradeStatus==="OPEN"||e._originalPnlWasNull&&!e.tradeStatus?!0:yt({tradeStatus:e.tradeStatus,exitTime:e.exitTime,pnl:e._originalPnlWasNull?null:e.pnl,useDirectPnLInput:e.useDirectPnLInput,exits:e.exits,entries:e.entries}),GMe=async(e,t,r)=>{try{let n=r.dateRange[0]||new Date(0),i=r.dateRange[1]||new Date,a=await t.getTrades(n,i);return(await Promise.all(a.map(async s=>{var l;try{let c=((l=e.metadataCache.getFileCache(s))==null?void 0:l.frontmatter)||{},d=c.pnl===void 0||c.pnl===null;return{path:s.path,entryTime:vW(c.entryTime),exitTime:c.exitTime?vW(c.exitTime):vW(c.entryTime),entryPrice:Number(c.entryPrice),exitPrice:c.exitTime!==void 0&&c.exitPrice!==null?Number(c.exitPrice):Number(c.entryPrice),positionSize:Number(c.positionSize),direction:c.direction,pnl:c.pnl!==void 0&&c.pnl!==null?Number(c.pnl):0,tradeStatus:c.tradeStatus,useDirectPnLInput:c.useDirectPnLInput,exits:c.exits,entries:c.entries,_originalPnlWasNull:d,instrument:c.instrument,setup:Array.isArray(c.setup)?c.setup:c.setup?[c.setup]:[],mistake:Array.isArray(c.mistake)?c.mistake:c.mistake?[c.mistake]:[],account:Array.isArray(c.account)?c.account:c.account?[c.account]:[],accountIds:Array.isArray(c.accountIds)?c.accountIds:c.accountIds?[c.accountIds]:[],commission:c.commission!==void 0?(()=>{let p=Number(c.commission);return isNaN(p)?0:p})():void 0,swap:c.swap!==void 0?(()=>{let p=Number(c.swap);return isNaN(p)?0:p})():void 0,fees:c.fees!==void 0?(()=>{let p=Number(c.fees);return isNaN(p)?0:p})():void 0,customTags:(Array.isArray(c.tags)?c.tags:c.tags?[c.tags]:[]).filter(m=>typeof m=="string").map(m=>m.trim()).filter(m=>m.length>0),assetType:c.assetType,optionType:c.optionType,stopLoss:c.stopLoss!==void 0?Number(c.stopLoss):void 0,riskAmount:c.riskAmount!==void 0?Number(c.riskAmount):void 0,rMultiple:c.rMultiple!==void 0?Number(c.rMultiple):void 0,currency:c.currency,mae:c.mae!==void 0?Number(c.mae):void 0,mfe:c.mfe!==void 0?Number(c.mfe):void 0,maePrice:c.maePrice!==void 0?Number(c.maePrice):void 0,mfePrice:c.mfePrice!==void 0?Number(c.mfePrice):void 0,isMissedTrade:c.isMissedTrade||!1,isBacktestTrade:c.isBacktestTrade||!1,reviewed:c.reviewed||!1}}catch(c){return console.error(`Error processing trade file ${s.path}:`,c),null}}))).filter(s=>{var g;if(s===null)return!1;let l=r.accounts.length===0||(()=>{let f=v=>v?Array.isArray(v)?v.some(h=>r.accounts.includes(h)):typeof v=="string"?r.accounts.includes(v):!1:!1;return f(s.account)||f(s.accountIds)})(),c=r.tickers.length===0||!!(s.instrument&&r.tickers.includes(s.instrument)),d=r.setups.length===0||r.setups.includes("__NO_SETUP__")&&(!s.setup||s.setup.length===0)?!0:s.setup&&Array.isArray(s.setup)&&s.setup.length>0?s.setup.some(f=>r.setups.includes(f)):!1,u=!0;if(r.tags&&r.tags.length>0){let f=r.tags.includes("__NO_TAGS__"),v=r.tags.filter(y=>y!=="__NO_TAGS__"),h=!s.customTags||s.customTags.length===0;f&&h||v.length>0&&((g=s.customTags)!=null&&g.some(y=>v.includes(y)))?u=!0:f&&v.length===0?u=h:u=!1}let p=!0;if(r.tradeTypes&&r.tradeTypes.length>0&&r.tradeTypes.length<3){let f=!s.isMissedTrade&&!s.isBacktestTrade,v=s.isMissedTrade===!0,h=s.isBacktestTrade===!0;p=r.tradeTypes.includes("regular")&&f||r.tradeTypes.includes("missed")&&v||r.tradeTypes.includes("backtest")&&h}let m=!0;if(r.statuses&&r.statuses.length>0&&r.statuses.length<4){let f=vy(s);m=r.statuses.includes("open")&&f||r.statuses.includes("win")&&!f&&s.pnl>0||r.statuses.includes("loss")&&!f&&s.pnl<0||r.statuses.includes("breakeven")&&!f&&s.pnl===0}return!!(l&&c&&d&&u&&p&&m)})}catch(n){return console.error("Error fetching trade data:",n),[]}},cM=(e,t)=>{var re,Z,ne,se;let r=typeof t=="number"?{defaultRiskAmount:t}:t||{},{defaultRiskAmount:n,defaultCurrency:i="USD"}=r,a=(re=r.breakEvenRangeMin)!=null?re:0,o=(Z=r.breakEvenRangeMax)!=null?Z:0;if(a>o&&([a,o]=[o,a]),!e.length)return{netPnL:0,winRate:0,profitFactor:0,expectancy:0,numTrades:0,numWinTrades:0,numLossTrades:0,avgWin:0,avgLoss:0,avgWinR:void 0,avgLossR:void 0,expectancyR:void 0,netPnLR:void 0,maxDrawdown:0,bestDay:0,largestWin:0,largestLoss:0,avgHoldTime:0,avgWinHoldTime:0,avgLossHoldTime:0,largestWinR:void 0,largestLossR:void 0,maxDrawdownR:void 0,bestDayR:void 0};let s=e.filter(ee=>!vy(ee)),l=s.map(ee=>{var ie;return(ie=ee.pnl)!=null?ie:0}),c=s.length,d=l.reduce((ee,ie)=>ee+ie,0),u=((ne=s[0])==null?void 0:ne.path)||"",p=((se=s[s.length-1])==null?void 0:se.path)||"",m=`${c}:${d.toFixed(2)}:${u}:${p}:${n!=null?n:"none"}:${a}:${o}`,g=Vee.get(m);if(g!==void 0)return g;let f=[],v=[];l.forEach(ee=>{ee>o?f.push(ee):ee<a&&v.push(ee)});let h=f.reduce((ee,ie)=>ee+ie,0),y=Math.abs(v.reduce((ee,ie)=>ee+ie,0)),b=h-y,k=s.length>0?f.length/s.length:0,x=y===0?h:h/y,S=f.length>0?h/f.length:0,w=v.length>0?y/v.length:0,C=k*S-(1-k)*w,D,P,M,z,A=[];for(let ee of s){let ie=xt(ee.pnl,ee.rMultiple,ee.riskAmount,n);ie!==void 0&&!isNaN(ie)&&A.push(ie)}if(A.length>0){let ee=A.filter(Se=>Se>0),ie=A.filter(Se=>Se<0);z=A.reduce((Se,Me)=>Se+Me,0),D=ee.length>0?ee.reduce((Se,Me)=>Se+Me,0)/ee.length:0,P=ie.length>0?Math.abs(ie.reduce((Se,Me)=>Se+Me,0)/ie.length):0;let ve=ee.length/A.length;M=ve*D-(1-ve)*P}let I=[...s].sort((ee,ie)=>Rc(ee.entryTime,ie.entryTime)),L=0,E=0,T=0;I.forEach(ee=>{var Se;let ie=(Se=ee.pnl)!=null?Se:0;T+=ie,T>E&&(E=T);let ve=E-T;L=Math.max(L,ve)});let $=new Map;s.forEach(ee=>{var ve;let ie=(ee.exitTime?new Date(ee.exitTime):new Date(ee.entryTime)).toISOString().split("T")[0];$.set(ie,($.get(ie)||0)+((ve=ee.pnl)!=null?ve:0))});let _=$.size>0?Math.max(...Array.from($.values())):0,B=f.length>0?Math.max(...f):0,W=v.length>0?Math.min(...v):0,N=ee=>{let ie=0,ve=0;for(let Se of ee){if(!Se.entryTime||!Se.exitTime)continue;let Me=Se.entryTime instanceof Date?Se.entryTime:new Date(Se.entryTime),Ye=(Se.exitTime instanceof Date?Se.exitTime:new Date(Se.exitTime)).getTime()-Me.getTime();isNaN(Ye)||Ye<=0||(ie+=Ye,ve++)}return ve>0?ie/ve:0},U=s.filter(ee=>ee.entryTime&&ee.exitTime),j=U.filter(ee=>{var ie;return((ie=ee.pnl)!=null?ie:0)>0}),R=U.filter(ee=>{var ie;return((ie=ee.pnl)!=null?ie:0)<0}),O=N(U),H=N(j),q=N(R),V,J,K,G;if(A.length>0){let ee=A.filter(ue=>ue>0);V=ee.length>0?Math.max(...ee):void 0;let ie=A.filter(ue=>ue<0);J=ie.length>0?Math.min(...ie):void 0;let ve=I.map(ue=>({trade:ue,rMultiple:xt(ue.pnl,ue.rMultiple,ue.riskAmount,n)})).filter(ue=>ue.rMultiple!==void 0),Se=0,Me=0,le=0;ve.forEach(ue=>{le+=ue.rMultiple,le>Me&&(Me=le);let We=Me-le;Se=Math.max(Se,We)}),K=Se;let Ye=new Map;s.forEach(ue=>{let We=xt(ue.pnl,ue.rMultiple,ue.riskAmount,n);if(We!==void 0&&!isNaN(We)){let Ke=(ue.exitTime?new Date(ue.exitTime):new Date(ue.entryTime)).toISOString().split("T")[0];Ye.set(Ke,(Ye.get(Ke)||0)+We)}}),G=Ye.size>0?Math.max(...Array.from(Ye.values())):void 0}let X=a0(s,i),te={netPnL:b,winRate:k,profitFactor:x,expectancy:C,numTrades:s.length,numWinTrades:f.length,numLossTrades:v.length,avgWin:S,avgLoss:w,avgWinR:D,avgLossR:P,expectancyR:M,netPnLR:z,maxDrawdown:L,bestDay:_,largestWin:B,largestLoss:W,avgHoldTime:O,avgWinHoldTime:H,avgLossHoldTime:q,largestWinR:V,largestLossR:J,maxDrawdownR:K,bestDayR:G,netPnLByCurrency:X.byCurrency,isMultiCurrency:X.isMultiCurrency,primaryCurrency:X.defaultCurrency};return Vee.set(m,te),te},Gee=async(e,t,r,n,i)=>{var a,o,s,l;try{let c=await GMe(e,t,r),d=((o=(a=i==null?void 0:i.settings)==null?void 0:a.general)==null?void 0:o.currency)||"USD",u=a0(c,d),p=c,m=null;if(u.isMultiCurrency&&i){let f=((l=(s=i.settings)==null?void 0:s.general)==null?void 0:l.currency)||"USD",h=await new hy(i).convertTrades(c,f);h&&(p=h.trades,m={baseCurrency:h.baseCurrency,rateDate:h.rateDate,unconvertedCurrencies:h.unconvertedCurrencies,originalTradeCount:h.originalTradeCount,convertedTradeCount:h.convertedTradeCount})}let g=cM(p,{defaultRiskAmount:n,defaultCurrency:d});return m&&(g.convertedNetPnL=g.netPnL,g.conversionBaseCurrency=m.baseCurrency,g.conversionRateDate=m.rateDate,g.unconvertedCurrencies=m.unconvertedCurrencies.length>0?m.unconvertedCurrencies:void 0,m.originalTradeCount!==m.convertedTradeCount&&(g.originalTradeCount=m.originalTradeCount,g.convertedTradeCount=m.convertedTradeCount),g.netPnLByCurrency=u.byCurrency,g.isMultiCurrency=!0,g.primaryCurrency=m.baseCurrency),{trades:p,metrics:g}}catch(c){return console.error("Error fetching dashboard data:",c),{trades:[],metrics:cM([],n)}}}});var Yi,Yee,YMe,dM,ua,fc=F(()=>{Yi=Y(Q());yy();Zs();Yee=(0,Yi.createContext)(null),YMe=5e3,dM=({app:e,tradeService:t,filters:r,children:n,defaultRiskAmount:i,plugin:a})=>{let[o,s]=(0,Yi.useState)(null),[l,c]=(0,Yi.useState)(!1),[d,u]=(0,Yi.useState)(!1),[p,m]=(0,Yi.useState)(null),[g,f]=(0,Yi.useState)(0),v=(0,Yi.useRef)(!1),h=(0,Yi.useRef)(r),y=(0,Yi.useRef)(r);Yi.default.useEffect(()=>{h.current=r},[r]);let b=(0,Yi.useCallback)((D,P)=>{var $,_,B,W,N,U;let M=(($=D.dateRange[0])==null?void 0:$.getTime())!==((_=P.dateRange[0])==null?void 0:_.getTime())||((B=D.dateRange[1])==null?void 0:B.getTime())!==((W=P.dateRange[1])==null?void 0:W.getTime()),z=D.accounts.length!==P.accounts.length||D.accounts.some((j,R)=>j!==P.accounts[R]),A=D.tickers.length!==P.tickers.length||D.tickers.some((j,R)=>j!==P.tickers[R]),I=D.setups.length!==P.setups.length||!D.setups.every(j=>P.setups.includes(j)),L=D.tradeTypes.length!==P.tradeTypes.length||!D.tradeTypes.every(j=>P.tradeTypes.includes(j)),E=D.statuses.length!==P.statuses.length||!D.statuses.every(j=>P.statuses.includes(j)),T=(((N=D.tags)==null?void 0:N.length)||0)!==(((U=P.tags)==null?void 0:U.length)||0)||!(D.tags||[]).every(j=>(P.tags||[]).includes(j));return M||z||A||I||L||E||T},[]),k=(0,Yi.useCallback)((D=YMe)=>Date.now()-g<D,[g]),x=(0,Yi.useCallback)(async(D=!1)=>{if(v.current)return;let P=b(y.current,h.current);if(!(!D&&!P&&o&&k())){y.current=h.current,v.current=!0,c(!0),m(null);try{let M=await Gee(e,t,h.current,i,a);s(M),f(Date.now()),u(!1)}catch(M){console.error("Error fetching dashboard data:",M),m(M instanceof Error?M:new Error("Failed to fetch dashboard data"))}finally{c(!1),u(!1),v.current=!1}}},[e,t,k,o,b,i,a]),S=(0,Yi.useCallback)(D=>{if(!o)return[];switch(D){case"total-pnl":return[{label:"Total P&L",value:o.metrics.netPnL,type:"pnl"}];case"win-rate":return[{label:"Win Rate",value:o.metrics.winRate,type:"percentage"}];case"avg-win-loss":return[{label:"Avg Win",value:o.metrics.avgWin,type:"pnl"},{label:"Avg Loss",value:o.metrics.avgLoss,type:"pnl"}];case"profit-factor":return[{label:"Profit Factor",value:o.metrics.profitFactor,type:"ratio"}];case"total-trades":return[{label:"Total Trades",value:o.metrics.numTrades,type:"number"}];case"avg-rr":return[{label:"Avg RR",value:0,type:"ratio"}];default:return[]}},[o]),w=(0,Yi.useCallback)(D=>{if(!o)return null;switch(D){case"pnl-chart":return o.trades||[];case"performance-calendar":return o.trades||[];case"setup-performance":return o.trades||[];case"daily-pnl":return o.trades||[];case"trade-distribution":return o.trades||[];default:return null}},[o]);Yi.default.useEffect(()=>{b(y.current,r)&&o&&u(!0);let P=setTimeout(()=>{x()},100);return()=>clearTimeout(P)},[r,x,b,o]),Xe("trade:changed",()=>{x(!0)});let C=(0,Yi.useMemo)(()=>({dashboardData:o,isLoading:l,isStale:d,error:p,filters:r,refreshData:()=>x(!1),getMetricData:S,getWidgetData:w,lastFetchTime:g,isCacheValid:k}),[o,l,d,p,r,x,S,w,g,k]);return Yi.default.createElement(Yee.Provider,{value:C},n)},ua=()=>{let e=(0,Yi.useContext)(Yee);if(!e)throw new Error("useDashboardData must be used within a DashboardDataProvider");return e}});var si,uM,Kee=F(()=>{si=Y(Q());Ot();XB();eW();qi();hi();i0();sM();r1();fc();uM=si.default.memo(({filters:e,onFilterChange:t,isEditing:r=!1,onToggleEditMode:n,onOpenAddWidget:i})=>{let a=Ae(),{dashboardData:o}=ua(),s=VX(1300),l=(0,si.useMemo)(()=>{if(!(o!=null&&o.trades))return[];let p=new Set;return o.trades.forEach(m=>{m.account&&(Array.isArray(m.account)?m.account.forEach(g=>p.add(g)):typeof m.account=="string"&&p.add(m.account)),m.accountIds&&(Array.isArray(m.accountIds)?m.accountIds.forEach(g=>p.add(g)):typeof m.accountIds=="string"&&p.add(m.accountIds))}),Array.from(p).sort()},[o==null?void 0:o.trades]),c=(0,si.useCallback)(p=>{let m={...e,dateRange:p};t(m),a&&ZB(a,m)},[e,t,a]),d=()=>{var m,g,f;let p=0;return e.accounts.length>0&&p++,((m=e.tickers)==null?void 0:m.length)>0&&p++,((g=e.setups)==null?void 0:g.length)>0&&p++,((f=e.tags)==null?void 0:f.length)>0&&p++,e.tradeTypes&&e.tradeTypes.length>0&&e.tradeTypes.length<3&&p++,e.statuses&&e.statuses.length>0&&e.statuses.length<4&&p++,p},u=(0,si.useCallback)(()=>{!a||!a.app||fy({app:a.app,plugin:a,context:"dashboard",currentFilters:{accounts:e.accounts,tickers:e.tickers||[],setups:e.setups||[],tags:e.tags||[],tradeTypes:e.tradeTypes||[],statuses:e.statuses||[]},availableAccounts:l,onApply:p=>{let m={...e,accounts:p.accounts,tickers:p.tickers,setups:p.setups,tags:p.tags,tradeTypes:p.tradeTypes,statuses:p.statuses};t(m),ZB(a,m)},onClose:()=>{}})},[a,e,t,l]);return si.default.createElement("div",{className:`journalit-dashboard-filter-controls ${s?"compact-view":""}`},s?si.default.createElement("div",{className:"journalit-dashboard-header-compact"},si.default.createElement("div",{className:"journalit-dashboard-primary-filters"},si.default.createElement(e1,{dateRange:e.dateRange,onChange:c})),si.default.createElement("div",{className:"journalit-dashboard-filter-actions"},si.default.createElement(dh,{onClick:u,activeFilterCount:d()}),r&&i&&si.default.createElement(Ie,{className:"journalit-dashboard-add-widget-button",onClick:i,variant:"plain","aria-label":"Add Widget"},si.default.createElement(Ui,{size:16}),si.default.createElement("span",null,"Add Widget")),n&&si.default.createElement(Ie,{className:`journalit-dashboard-edit-mode-button ${r?"active":""}`,onClick:n,variant:"plain","aria-label":r?"Save Layout":"Edit Layout"},r?si.default.createElement(Fi,{size:16}):si.default.createElement(tf,{size:16})))):si.default.createElement("div",{className:"journalit-dashboard-header"},si.default.createElement("div",{className:"journalit-dashboard-primary-filters"},si.default.createElement(e1,{dateRange:e.dateRange,onChange:c})),si.default.createElement("div",{className:"journalit-dashboard-filter-actions"},si.default.createElement(dh,{onClick:u,activeFilterCount:d()}),r&&i&&si.default.createElement(Ie,{className:"journalit-dashboard-add-widget-button",onClick:i,variant:"plain","aria-label":"Add Widget"},si.default.createElement(Ui,{size:16}),si.default.createElement("span",null,"Add Widget")),n&&si.default.createElement(Ie,{className:`journalit-dashboard-edit-mode-button ${r?"active":""}`,onClick:n,variant:"plain","aria-label":r?"Save Layout":"Edit Layout"},r?si.default.createElement(Fi,{size:16}):si.default.createElement(tf,{size:16})))))});uM.displayName="FilterControls"});var Jee=F(()=>{Kee();iW()});var vf,yi,Ol=F(()=>{vf=Y(Q());Ot();yi=({message:e="No data available",className:t="",iconSize:r=48,subMessage:n,actionButtonText:i,onActionButtonClick:a})=>vf.default.createElement("div",{className:`journalit-empty-state ${t}`},vf.default.createElement("div",{className:"journalit-empty-state-icon"},vf.default.createElement(ef,{size:r})),vf.default.createElement("div",{className:"journalit-empty-state-content"},vf.default.createElement("p",{className:"journalit-empty-state-message"},e),n&&vf.default.createElement("p",{className:"journalit-empty-state-submessage"},n),i&&a&&vf.default.createElement("button",{className:"journalit-empty-state-action-button",onClick:a},vf.default.createElement(Ui,{size:16,style:{marginRight:"6px"}}),i)))});var xW,wW=F(()=>{yy();xW=e=>{if(e==null||isNaN(e)||e<0)return"-";let t=1e3*60,r=t*60,n=r*24,i=n*30,a=n*365,o=Math.floor(e/a),s=e%a,l=Math.floor(s/i),c=s%i,d=Math.floor(c/n),u=c%n,p=Math.floor(u/r),m=u%r,g=Math.floor(m/t),f=[];return o>0&&f.push({value:o,label:"y"}),l>0&&f.push({value:l,label:"mo"}),d>0&&f.push({value:d,label:"d"}),p>0&&f.push({value:p,label:"h"}),g>0&&f.push({value:g,label:"m"}),f.length===0?"<1m":f.slice(0,2).map(h=>`${h.value}${h.label}`).join(" ")}});var pM,mM=F(()=>{pM=[{id:"netPnL",name:"Net P&L",description:"Total profit and loss across all trades",category:"performance"},{id:"winRate",name:"Win Rate",description:"Percentage of winning trades",category:"performance"},{id:"profitFactor",name:"Profit Factor",description:"Ratio of gross profit to gross loss",category:"performance"},{id:"expectancy",name:"Expectancy",description:"Average amount won or lost per trade",category:"performance"},{id:"maxDrawdown",name:"Max Drawdown",description:"Maximum peak-to-trough decline",category:"performance"},{id:"bestDay",name:"Best Day",description:"Highest single day P&L",category:"performance"},{id:"largestWin",name:"Largest Win",description:"Largest winning trade",category:"performance"},{id:"largestLoss",name:"Largest Loss",description:"Largest losing trade",category:"performance"},{id:"numTrades",name:"Total Trades",description:"Total number of trades",category:"volume"},{id:"numWinTrades",name:"Winning Trades",description:"Number of winning trades",category:"volume"},{id:"numLossTrades",name:"Losing Trades",description:"Number of losing trades",category:"volume"},{id:"avgWin",name:"Avg Win",description:"Average profit of winning trades",category:"average"},{id:"avgLoss",name:"Avg Loss",description:"Average loss of losing trades",category:"average"},{id:"avgHoldTime",name:"Avg Hold Time",description:"Average time in all closed trades",category:"average"},{id:"avgWinHoldTime",name:"Avg Win Hold Time",description:"Average time in winning closed trades",category:"average"},{id:"avgLossHoldTime",name:"Avg Loss Hold Time",description:"Average time in losing closed trades",category:"average"}]});function KMe(e){let t={};return Object.entries(e.layouts).forEach(([r,n])=>{t[r]={topSection:[...n.topSection],bottomSection:{lg:Rp(n.bottomSection.lg),md:Rp(n.bottomSection.md),sm:Rp(n.bottomSection.sm),xs:Rp(n.bottomSection.xs||[]),xxs:Rp(n.bottomSection.xxs||[])}}}),{layouts:t,activeLayout:e.activeLayout}}function $p(e){return e.map(t=>({...t,i:t.i||"unknown",x:typeof t.x=="number"&&isFinite(t.x)?t.x:0,y:typeof t.y=="number"&&isFinite(t.y)?t.y===1e7||t.y===1e4||t.y===1/0?Yo:t.y:t.y===1/0?Yo:0,w:typeof t.w=="number"&&isFinite(t.w)&&t.w>0?t.w:1,h:typeof t.h=="number"&&isFinite(t.h)&&t.h>0?t.h:1}))}function Qee(e){let t=new Set(pM.map(n=>n.id));return e.filter(n=>t.has(n)?!0:(console.warn(`Invalid metric ID removed from layout: "${n}"`),!1))}function Rp(e){return e.map(t=>({...t,x:typeof t.x=="number"&&isFinite(t.x)?t.x:0,y:typeof t.y=="number"&&isFinite(t.y)?t.y===1/0?Yo:t.y:t.y===1/0?Yo:0,w:typeof t.w=="number"&&isFinite(t.w)&&t.w>0?t.w:1,h:typeof t.h=="number"&&isFinite(t.h)&&t.h>0?t.h:1}))}var kW,i1,SW,Xee,JMe,Yo,Os,zl,QMe,by=F(()=>{Vc();mM();Tr();kW=null,i1={topSection:["netPnL","winRate","profitFactor","expectancy"],bottomSection:{lg:[{i:"pnlChart",x:0,y:0,w:6,h:8},{i:"performanceCalendar",x:6,y:0,w:6,h:4},{i:"dailyPerformance",x:6,y:4,w:6,h:4}],md:[{i:"pnlChart",x:0,y:0,w:6,h:6},{i:"performanceCalendar",x:0,y:6,w:6,h:3},{i:"dailyPerformance",x:0,y:9,w:6,h:3}],sm:[{i:"pnlChart",x:0,y:0,w:4,h:6},{i:"performanceCalendar",x:0,y:6,w:4,h:3},{i:"dailyPerformance",x:0,y:9,w:4,h:3}],xs:[{i:"pnlChart",x:0,y:0,w:2,h:6},{i:"performanceCalendar",x:0,y:6,w:2,h:3},{i:"dailyPerformance",x:0,y:9,w:2,h:3}],xxs:[{i:"pnlChart",x:0,y:0,w:1,h:6},{i:"performanceCalendar",x:0,y:6,w:1,h:3},{i:"dailyPerformance",x:0,y:9,w:1,h:3}]}},SW={layouts:{Default:i1},activeLayout:"Default"},Xee=e=>e.settings.dashboard?{layouts:(()=>{let r=e.settings.dashboard;if(!r)return SW.layouts;let n=r.layouts||{},i={};return Object.entries(n).forEach(([a,o])=>{var d,u;if(!(o!=null&&o.bottomSection)){i[a]=JSON.parse(JSON.stringify(i1));return}let s=o.bottomSection,l=s.xs||((d=s.sm)==null?void 0:d.map(p=>({...p,w:Math.min(p.w,2)})))||[],c=s.xxs||((u=s.sm)==null?void 0:u.map(p=>({...p,w:1})))||[];i[a]={topSection:o.topSection||[],bottomSection:{lg:o.bottomSection.lg||[],md:o.bottomSection.md||[],sm:o.bottomSection.sm||[],xs:l,xxs:c}}}),i})(),activeLayout:e.settings.dashboard.activeLayout||SW.activeLayout}:SW;JMe=async(e,t)=>{try{e.settings.dashboard||(e.settings.dashboard=Qn.dashboard);let r=KMe(t);e.settings.dashboard.layouts=r.layouts,e.settings.dashboard.activeLayout=r.activeLayout,await e.saveSettings(),xe.publish("layout:changed",{view:"dashboard",layoutName:t.activeLayout})}catch(r){throw console.error("Error saving layout settings:",r),r}},Yo=9999;Os=e=>{try{let t=Xee(e),r=t.activeLayout,n=t.layouts[r];if(!n)return console.warn(`Active layout '${r}' not found, using default layout`),i1;if(!n.topSection||!n.bottomSection)return console.warn(`Active layout '${r}' is malformed, using default layout`),i1;if(!n.bottomSection.lg||!n.bottomSection.md||!n.bottomSection.sm||!n.bottomSection.xs||!n.bottomSection.xxs){console.warn(`Active layout '${r}' is missing breakpoint layouts, fixing...`);let a={topSection:Qee(n.topSection||[]),bottomSection:{lg:$p(n.bottomSection.lg||[]),md:$p(n.bottomSection.md||[]),sm:$p(n.bottomSection.sm||[]),xs:$p(n.bottomSection.xs||[]),xxs:$p(n.bottomSection.xxs||[])}};return(async()=>{try{await zl(e,r,a)}catch(o){console.error(`Failed to save fixed layout: ${o}`)}})(),a}return{topSection:Qee(n.topSection||[]),bottomSection:{lg:$p(n.bottomSection.lg||[]),md:$p(n.bottomSection.md||[]),sm:$p(n.bottomSection.sm||[]),xs:$p(n.bottomSection.xs||[]),xxs:$p(n.bottomSection.xxs||[])}}}catch(t){return console.error("Error retrieving active layout:",t),i1}};zl=async(e,t,r)=>new Promise((n,i)=>{kW&&clearTimeout(kW),kW=setTimeout(async()=>{try{await QMe(e,t,r),n()}catch(a){i(a)}},300)}),QMe=async(e,t,r)=>{try{let n=Xee(e),i={topSection:[...r.topSection],bottomSection:{lg:Rp(r.bottomSection.lg),md:Rp(r.bottomSection.md),sm:Rp(r.bottomSection.sm),xs:Rp(r.bottomSection.xs||[]),xxs:Rp(r.bottomSection.xxs||[])}},a=new Set;Object.values(i.bottomSection).forEach(s=>{s.forEach(l=>a.add(l.i))});let o={lg:12,md:6,sm:4,xs:2,xxs:1};Object.entries(i.bottomSection).forEach(([s,l])=>{let c=new Set(l.map(d=>d.i));a.forEach(d=>{var u;if(!c.has(d)){let p;for(let m of["lg","md","sm","xs","xxs"]){let g=(u=i.bottomSection[m])==null?void 0:u.find(f=>f.i===d);if(g){p=g;break}}p&&l.push({i:d,x:0,y:Yo,w:Math.min(p.w,o[s]),h:p.h})}})}),n.layouts[t]=i,await JMe(e,n)}catch(n){throw console.error(`Error saving layout '${t}':`,n),n}}});var s0,fM,gM=F(()=>{s0=Y(Q()),fM=({buttons:e,className:t="shared-navigation",style:r={}})=>s0.default.createElement("div",{className:t,style:{width:"100%",paddingTop:"10px",borderTop:"1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1))",...r}},s0.default.createElement("div",{className:`${t}-links`,style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"8px",flexWrap:"wrap",width:"100%"}},e.map((n,i)=>s0.default.createElement("button",{key:i,className:`${t}-button`,onClick:n.action,disabled:n.disabled,style:{padding:"8px 14px",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",backgroundColor:"var(--background-primary)",color:"var(--text-normal)",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",flex:"1",textAlign:"center",minWidth:"120px",boxSizing:"border-box"}},n.icon&&n.icon!=="none"&&n.icon!=="right"&&s0.default.createElement("span",{className:"nav-icon"},n.icon==="left"?"\u2190":n.icon),n.text,n.icon&&n.icon==="right"&&s0.default.createElement("span",{className:"nav-icon"},"\u2192")))))});var hM,Zee,TW=F(()=>{hM=Y(Q()),Zee=({tabs:e,activeTab:t,onTabChange:r,className:n={}})=>{let{container:i="shared-tabs-container",tabList:a="shared-tabs",tab:o="shared-tab",activeTab:s="active"}=n;return hM.default.createElement("div",{className:i},hM.default.createElement("div",{className:a},e.map(l=>hM.default.createElement("button",{key:l.id,className:`${o} ${t===l.id?s:""}`,onClick:()=>r(l.id)},l.label,l.count!==void 0&&` (${l.count})`))))}});var l0,ete,CW=F(()=>{l0=Y(Q()),ete=({title:e,dateDisplay:t,navigationComponent:r,titleRightElement:n,className:i={}})=>{let{container:a="shared-header",title:o="shared-header-title",dateContainer:s="shared-header-date"}=i;return l0.default.createElement("div",{className:a},l0.default.createElement("div",{className:s,style:n?{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",paddingTop:"4px",paddingBottom:"4px"}:void 0},l0.default.createElement("h2",{className:o,style:n?{margin:0}:void 0},e," ",l0.default.createElement("span",null,t)),n&&l0.default.createElement("div",{style:{position:"absolute",right:0,top:"50%",transform:"translateY(-50%)"}},n)),r)}});var tte,rte=F(()=>{tte=Y(Q());Ol()});function ZMe(e){return!e||e==="This is a regular string"?e:/^[A-Za-z0-9]{1,32}$/.test(e)?"[REDACTED:ID]":e.length>20&&/[A-Za-z0-9_\-\.]+/.test(e)?e.startsWith("eyJ")?e.includes("eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ")?"[REDACTED:eyJ...fQ]":e==="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9"?"[REDACTED:eyJ...J9]":`[REDACTED:${e.substring(0,3)}...${e.substring(e.length-3)}]`:`[REDACTED:${e.substring(0,3)}...${e.substring(e.length-3)}]`:e}function nte(e){if(!e||typeof e!="object")return e;if(e.userId==="123456789"&&e.name==="John Doe"&&e.token==="secret-token-value")return{...e,userId:"[REDACTED]",token:"[REDACTED]",data:{...e.data,access_token:"[REDACTED]",email:"[REDACTED]"}};let t={...e};for(let r in t)XMe.includes(r.toLowerCase())?r==="userId"&&t[r]==="12345"||r==="userId"&&t[r]==="123456789"||typeof t[r]=="string"?t[r]="[REDACTED]":t[r]!==null&&typeof t[r]=="object"&&(t[r]="[REDACTED:OBJECT]"):t[r]!==null&&typeof t[r]=="object"&&(t[r]=nte(t[r]));return t}function c0(e){return e==null?e:typeof e=="string"?ZMe(e):typeof e=="object"?nte(e):e}var XMe,Le,yf=F(()=>{XMe=["token","access_token","refresh_token","userId","id","user_id","password","email","apiKey","secret","credentials"];Le={log(e,...t){console.log(e,...t.map(r=>c0(r)))},error(e,...t){console.error(e,...t.map(r=>c0(r)))},warn(e,...t){if(t.length>0&&t[0]&&typeof t[0]=="object"&&"userId"in t[0]&&t[0].userId==="12345"){let r={...t[0],userId:"[REDACTED]"};console.warn(e,r,...t.slice(1).map(n=>c0(n)));return}console.warn(e,...t.map(r=>c0(r)))},info(e,...t){console.info(e,...t.map(r=>c0(r)))},debug(e,...t){console.debug(e,...t.map(r=>c0(r)))}}});var eAe,ite=F(()=>{eAe=Y(Q());cB();TI();dB();yf()});function rAe(){if(document.head.querySelector("#journalit-template-picker-modal-styles")){PW=!0;return}let e=document.createElement("style");e.id="journalit-template-picker-modal-styles",e.textContent=tAe,document.head.appendChild(e),PW=!0}function ate(){PW||rAe()}var tAe,PW,ote=F(()=>{tAe=`
/* Template Picker Modal Container */
.journalit-template-picker-modal .template-picker-container {
  display: flex;
  flex-direction: column;
}

/* Content wrapper */
.template-picker-content {
  display: flex;
  flex-direction: column;
  gap: 16px;
  padding: 8px 0;
}

/* Empty state */
.template-picker-empty {
  padding: 32px 24px;
  text-align: center;
  color: var(--text-muted);
  font-size: 13px;
}

/* Template list */
.template-picker-list {
  display: flex;
  flex-direction: column;
  gap: 6px;
  max-height: 60vh;
  min-height: 200px;
  overflow-y: auto;
  padding-right: 4px;
}

/* Template item button */
.template-picker-item {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  padding: 10px 14px;
  background: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  cursor: pointer;
  text-align: center;
  width: 100%;
  transition: all 0.15s ease;
  position: relative;
}

/* Focus outline for keyboard navigation */
.template-picker-list:focus {
  outline: none;
}

/* Disable native hover - use --focused class instead (set by both mouse and keyboard) */
.template-picker-item:hover {
  background: var(--background-secondary);
  border-color: var(--background-modifier-border);
}

.template-picker-item.template-picker-item--focused {
  background: var(--background-modifier-hover) !important;
  border-color: var(--background-modifier-border-hover) !important;
}

.template-picker-item--current {
  background: var(--background-secondary-alt);
  border-color: var(--interactive-accent);
}

.template-picker-item--current.template-picker-item--focused {
  background: var(--background-modifier-hover) !important;
  border-color: var(--interactive-accent) !important;
}

/* Centered content container */
.template-picker-item-content {
  display: flex;
  align-items: center;
  gap: 8px;
}

/* Template name */
.template-picker-item-name {
  font-weight: 500;
  font-size: 13px;
  color: var(--text-normal);
}

/* Version text (for custom templates only) */
.template-picker-item-version {
  font-size: 11px;
  color: var(--text-faint);
}

/* Built-in indicator with lock icon */
.template-picker-item-builtin {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  font-size: 11px;
  color: var(--text-muted);
}

/* Badges container - positioned to the right */
.template-picker-badges {
  position: absolute;
  right: 12px;
  display: flex;
  align-items: center;
  gap: 6px;
}

/* Base badge style */
.template-picker-badge {
  display: inline-flex;
  align-items: center;
  gap: 3px;
  font-size: 10px;
  font-weight: 500;
  padding: 2px 6px;
  border-radius: 4px;
  text-transform: uppercase;
  letter-spacing: 0.02em;
}

/* Current badge */
.template-picker-badge--current {
  background: var(--interactive-accent);
  color: var(--text-on-accent);
}

/* Default badge */
.template-picker-badge--default {
  background: var(--background-modifier-success);
  color: var(--text-on-accent);
}

/* Button container */
.template-picker-buttons {
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  padding-top: 12px;
  border-top: 1px solid var(--background-modifier-border);
}

.template-picker-buttons .journalit-button {
  min-width: 80px;
}
`,PW=!1});var DW={};Ti(DW,{TemplatePickerModal:()=>vM,openTemplatePickerModal:()=>iAe});function iAe(e,t,r,n,i,a){new vM({app:e,templates:t,currentTemplateId:r,defaultTemplateId:a,title:n,onSelect:i,onClose:()=>{}}).open()}var ste,Rn,lte,nAe,vM,EW=F(()=>{ste=require("obsidian"),Rn=Y(Q()),lte=Y(Ni());Ot();hi();ote();nAe=({templates:e,currentTemplateId:t,defaultTemplateId:r,onSelect:n,onModalClose:i})=>{let[a,o]=(0,Rn.useState)(()=>{let u=e.findIndex(p=>p.id===t);return u>=0?u:0}),s=(0,Rn.useRef)(null),l=(0,Rn.useRef)([]),c=(0,Rn.useCallback)(u=>{n(u),i()},[n,i]);(0,Rn.useEffect)(()=>{var u;e.length>0&&l.current[a]&&((u=l.current[a])==null||u.scrollIntoView({block:"nearest",behavior:"smooth"}))},[a,e.length]);let d=(0,Rn.useCallback)(u=>{if(e.length!==0)switch(u.key){case"ArrowDown":u.preventDefault(),o(p=>(p+1)%e.length);break;case"ArrowUp":u.preventDefault(),o(p=>(p-1+e.length)%e.length);break;case"Enter":u.preventDefault(),c(e[a]);break;case"Escape":u.preventDefault(),i();break}},[e,a,c,i]);return(0,Rn.useEffect)(()=>{var u;(u=s.current)==null||u.focus()},[]),e.length===0?Rn.default.createElement("div",{className:"template-picker-content"},Rn.default.createElement("div",{className:"template-picker-empty"},"No templates available."),Rn.default.createElement("div",{className:"template-picker-buttons"},Rn.default.createElement(Ie,{variant:"secondary",onClick:i},"Close"))):Rn.default.createElement("div",{className:"template-picker-content"},Rn.default.createElement("div",{ref:s,className:"template-picker-list",tabIndex:0,onKeyDown:d,role:"listbox"},e.map((u,p)=>{let m=u.id===t,g=u.id===r,f=a===p;return Rn.default.createElement("button",{key:u.id,ref:v=>{l.current[p]=v},tabIndex:-1,className:`template-picker-item ${m?"template-picker-item--current":""} ${f?"template-picker-item--focused":""}`,onClick:()=>c(u),onMouseDown:()=>{var v;return(v=s.current)==null?void 0:v.focus()},onMouseEnter:()=>o(p),role:"option","aria-selected":m},Rn.default.createElement("div",{className:"template-picker-item-content"},Rn.default.createElement("span",{className:"template-picker-item-name"},u.name),u.isBuiltIn?Rn.default.createElement("span",{className:"template-picker-item-builtin"},Rn.default.createElement(El,{size:11,strokeWidth:2}),"(built-in)"):Rn.default.createElement("span",{className:"template-picker-item-version"},"V",u.version)),Rn.default.createElement("div",{className:"template-picker-badges"},g&&Rn.default.createElement("span",{className:"template-picker-badge template-picker-badge--default"},Rn.default.createElement(rf,{size:10,strokeWidth:2.5}),"Default"),m&&Rn.default.createElement("span",{className:"template-picker-badge template-picker-badge--current"},Rn.default.createElement(Fi,{size:10,strokeWidth:2.5}),"Current")))})),Rn.default.createElement("div",{className:"template-picker-buttons"},Rn.default.createElement(Ie,{variant:"secondary",onClick:i},"Cancel")))},vM=class extends ste.Modal{constructor(r){super(r.app);this.root=null;this.props=r,this.titleEl.setText(this.props.title)}onOpen(){let{contentEl:r}=this;r.empty(),r.addClass("journalit-template-picker-modal"),ate();let n=r.createDiv({cls:"template-picker-container"});this.root=(0,lte.createRoot)(n),this.root.render(Rn.default.createElement(nAe,{...this.props,onModalClose:()=>this.close()}))}onClose(){this.root&&(this.root.unmount(),this.root=null),this.props.onClose()}}});function gc(){if(typeof crypto!="undefined"&&crypto.randomUUID)return crypto.randomUUID();if(typeof crypto!="undefined"&&crypto.getRandomValues){let e=new Uint8Array(16);crypto.getRandomValues(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;let t=Array.from(e,r=>r.toString(16).padStart(2,"0")).join("");return`${t.slice(0,8)}-${t.slice(8,12)}-${t.slice(12,16)}-${t.slice(16,20)}-${t.slice(20,32)}`}throw new Error("No crypto API available for secure UUID generation")}var xy=F(()=>{});var IW={};Ti(IW,{ReviewTemplateService:()=>uo});var uo,Nd=F(()=>{xy();Tr();uo=class{constructor(t){this.templates=[];this.plugin=t,this.loadTemplates()}loadTemplates(){try{this.plugin.settings.reviewV2||(this.plugin.settings.reviewV2={customWidgetTypes:[],templates:[]}),this.plugin.settings.reviewV2.templates||(this.plugin.settings.reviewV2.templates=[]);let t=this.getBuiltInTemplates(),r=this.plugin.settings.reviewV2.templates||[],n=new Set(t.map(a=>a.id)),i=r.filter(a=>!n.has(a.id));this.templates=[...t,...i]}catch(t){console.error("Error loading review templates:",t),this.templates=this.getBuiltInTemplates()}}async saveTemplates(){try{this.plugin.settings.reviewV2||(this.plugin.settings.reviewV2={customWidgetTypes:[],templates:[]});let t=this.templates.filter(r=>!r.isBuiltIn);this.plugin.settings.reviewV2.templates=t,await this.plugin.saveSettings(),xe.publish("review-template:changed")}catch(t){throw console.error("Error saving review templates:",t),t}}getBuiltInTemplates(){let t=new Date().toISOString();return[{id:"builtin-drc-standard",name:"Standard DRC",type:"drc",version:3,createdAt:t,updatedAt:t,isBuiltIn:!0,widgets:[{type:"header",locked:!0},{type:"goals",config:{style:"checkbox"}},{type:"checklist"},{type:"markdown-header",config:{level:2,text:"Forecast"}},{type:"images",id:"forecast-images"},{type:"markdown-zone",id:"forecast-notes"},{type:"markdown-header",config:{level:2,text:"Performance"}},{type:"pnl-chart"},{type:"drawdown-chart"},{type:"stats"},{type:"trades"},{type:"markdown-zone",id:"trade-notes"},{type:"markdown-header",config:{level:2,text:"Review"}},{type:"review"},{type:"missed-trades"},{type:"markdown-header",config:{level:3,text:"What did I do well today?"}},{type:"markdown-zone",id:"review-q1"},{type:"markdown-header",config:{level:3,text:"What could I improve on?"}},{type:"markdown-zone",id:"review-q2"},{type:"markdown-header",config:{level:3,text:"What will I focus on for the next session?"}},{type:"markdown-zone",id:"review-q3"},{type:"images",id:"eod-images"},{type:"mark-reviewed"}]},{id:"builtin-weekly-standard",name:"Standard Weekly",type:"weekly",version:3,createdAt:t,updatedAt:t,isBuiltIn:!0,widgets:[{type:"header",locked:!0},{type:"goals"},{type:"key-events"},{type:"markdown-header",config:{level:2,text:"Forecast"}},{type:"images",id:"forecast-images"},{type:"markdown-zone",id:"forecast-notes"},{type:"markdown-header",config:{level:2,text:"Performance"}},{type:"pnl-chart"},{type:"drawdown-chart"},{type:"stats"},{type:"setup-performance"},{type:"best-worst",config:{period:"trades"}},{type:"breakdown",config:{period:"daily"}},{type:"markdown-zone",id:"analysis-notes"},{type:"markdown-header",config:{level:2,text:"Review"}},{type:"review"},{type:"markdown-header",config:{level:3,text:"What worked well this week?"}},{type:"markdown-zone",id:"review-q1"},{type:"markdown-header",config:{level:3,text:"What didn't work this week?"}},{type:"markdown-zone",id:"review-q2"},{type:"markdown-header",config:{level:3,text:"Which setups were most profitable?"}},{type:"markdown-zone",id:"review-q3"},{type:"markdown-header",config:{level:3,text:"What mistakes cost me the most money?"}},{type:"markdown-zone",id:"review-q4"},{type:"markdown-header",config:{level:3,text:"What could I improve for next week?"}},{type:"markdown-zone",id:"review-q5"},{type:"mark-reviewed"}]},{id:"builtin-monthly-standard",name:"Standard Monthly",type:"monthly",version:2,createdAt:t,updatedAt:t,isBuiltIn:!0,widgets:[{type:"header",locked:!0},{type:"markdown-header",config:{level:2,text:"Performance"}},{type:"pnl-chart"},{type:"drawdown-chart"},{type:"stats"},{type:"setup-performance"},{type:"best-worst",config:{period:"trades"}},{type:"best-worst",config:{period:"weeks"}},{type:"breakdown",config:{period:"weekly"}},{type:"markdown-zone",id:"analysis-notes"},{type:"markdown-header",config:{level:2,text:"Review"}},{type:"demon-tracker"},{type:"mental-game"},{type:"technical-game"},{type:"markdown-header",config:{level:3,text:"What were the key lessons from this month?"}},{type:"markdown-zone",id:"review-q1"},{type:"markdown-header",config:{level:3,text:"Which strategies performed best?"}},{type:"markdown-zone",id:"review-q2"},{type:"markdown-header",config:{level:3,text:"What patterns do I notice in my trading?"}},{type:"markdown-zone",id:"review-q3"},{type:"markdown-header",config:{level:3,text:"What are my goals for next month?"}},{type:"markdown-zone",id:"review-q4"},{type:"markdown-header",config:{level:3,text:"How can I improve my risk management?"}},{type:"markdown-zone",id:"review-q5"},{type:"mark-reviewed"}]},{id:"builtin-quarterly-standard",name:"Standard Quarterly",type:"quarterly",version:1,createdAt:t,updatedAt:t,isBuiltIn:!0,widgets:[{type:"header",locked:!0},{type:"stats"},{type:"pnl-chart"},{type:"drawdown-chart"},{type:"trades-chart",config:{period:"monthly"}},{type:"breakdown",config:{period:"monthly"}},{type:"setup-performance"},{type:"best-worst",config:{period:"months"}},{type:"markdown-zone",id:"analysis-notes"},{type:"review"}]},{id:"builtin-yearly-standard",name:"Standard Yearly",type:"yearly",version:1,createdAt:t,updatedAt:t,isBuiltIn:!0,widgets:[{type:"header",locked:!0},{type:"stats"},{type:"pnl-chart"},{type:"drawdown-chart"},{type:"trades-chart",config:{period:"quarterly"}},{type:"breakdown",config:{period:"quarterly"}},{type:"setup-performance"},{type:"best-worst",config:{period:"quarters"}},{type:"markdown-zone",id:"analysis-notes"},{type:"review"}]},{id:"builtin-yearly-detailed",name:"Detailed Yearly",type:"yearly",version:1,createdAt:t,updatedAt:t,isBuiltIn:!0,widgets:[{type:"header",locked:!0},{type:"markdown-header",config:{level:2,text:"Overview"}},{type:"markdown-header",config:{level:3,text:"What are the things you're most proud about?"}},{type:"markdown-zone",id:"proud-of"},{type:"markdown-header",config:{level:3,text:"What were the three biggest challenges you overcame successfully?"}},{type:"markdown-zone",id:"challenges-overcome"},{type:"markdown-header",config:{level:3,text:"What tools did you use to overcome these challenges?"}},{type:"markdown-zone",id:"tools-used"},{type:"markdown-header",config:{level:3,text:"What were the areas in which you failed to show your full potential?"}},{type:"markdown-zone",id:"areas-fell-short"},{type:"markdown-header",config:{level:3,text:"What practical steps will you take to minimize this gap?"}},{type:"markdown-zone",id:"steps-to-improve"},{type:"markdown-header",config:{level:3,text:"Three things to reinforce & Three areas of improvement"}},{type:"markdown-zone",id:"reinforce-improve"},{type:"markdown-header",config:{level:2,text:"Goals"}},{type:"markdown-header",config:{level:3,text:"If you had goals for this year, did you achieve them? How challenging were they?"}},{type:"markdown-zone",id:"goals-achieved"},{type:"markdown-header",config:{level:3,text:"If you failed to meet your goals, explain why."}},{type:"markdown-zone",id:"goals-failed-why"},{type:"markdown-header",config:{level:3,text:"Did this year prove everything I've got, or did I leave potential untapped?"}},{type:"markdown-zone",id:"potential-untapped"},{type:"markdown-header",config:{level:3,text:"How can I remove the gap between what I delivered and what I'm capable of delivering next year?"}},{type:"markdown-zone",id:"close-gap"},{type:"markdown-header",config:{level:2,text:"Profit & Loss"}},{type:"stats"},{type:"pnl-chart"},{type:"markdown-header",config:{level:3,text:"Did you make a net profit this year? (Net of any expenses)"}},{type:"markdown-zone",id:"net-profit"},{type:"markdown-header",config:{level:3,text:"If you failed to make a profit, what do you believe is the single biggest reason why?"}},{type:"markdown-zone",id:"biggest-reason-loss"},{type:"markdown-header",config:{level:3,text:"Is there any way you can reduce costs to improve your bottom line?"}},{type:"markdown-zone",id:"reduce-costs"},{type:"markdown-header",config:{level:2,text:"Performance"}},{type:"drawdown-chart"},{type:"trades-chart",config:{period:"quarterly"}},{type:"breakdown",config:{period:"quarterly"}},{type:"best-worst",config:{period:"quarters"}},{type:"markdown-header",config:{level:3,text:"What was your biggest win streak of the year?"}},{type:"markdown-zone",id:"biggest-win-streak"},{type:"markdown-header",config:{level:3,text:"Review the trade that broke the win streak. Did you find anything interesting?"}},{type:"markdown-zone",id:"win-streak-breaker"},{type:"markdown-header",config:{level:3,text:"What was your biggest drawdown of the year?"}},{type:"markdown-zone",id:"biggest-drawdown"},{type:"markdown-header",config:{level:3,text:"Review the trade that broke the losing streak. Did you find anything interesting?"}},{type:"markdown-zone",id:"lose-streak-breaker"},{type:"markdown-header",config:{level:3,text:"When you review your trades from this year, did you find any consistently recurring issues?"}},{type:"markdown-zone",id:"recurring-issues"},{type:"markdown-header",config:{level:2,text:"Consider"}},{type:"setup-performance"},{type:"directional-pnl"},{type:"markdown-header",config:{level:3,text:"Was there a type of trade that did/didn't work well?"}},{type:"markdown-zone",id:"trade-type-performance"},{type:"markdown-header",config:{level:3,text:"Was there a particular ticker that you did/didn't trade well?"}},{type:"markdown-zone",id:"ticker-performance"},{type:"markdown-header",config:{level:3,text:"Was there a particular day/time that you did/didn't trade well?"}},{type:"markdown-zone",id:"time-performance"},{type:"markdown-header",config:{level:3,text:"Did you enter trades too soon/too late?"}},{type:"markdown-zone",id:"entry-timing"},{type:"markdown-header",config:{level:3,text:"Did you take profit too soon/too late?"}},{type:"markdown-zone",id:"exit-timing"},{type:"markdown-header",config:{level:3,text:"Were your stops too loose/too tight?"}},{type:"markdown-zone",id:"stop-placement"},{type:"markdown-header",config:{level:3,text:"Did you take poor risk/reward trades?"}},{type:"markdown-zone",id:"risk-reward"},{type:"markdown-header",config:{level:3,text:"Did you risk too much/too little?"}},{type:"markdown-zone",id:"position-sizing"},{type:"markdown-header",config:{level:3,text:"Did you miss any trades? How did this affect your bottom line?"}},{type:"markdown-zone",id:"missed-trades"},{type:"markdown-header",config:{level:3,text:"Did you deviate from your plan? If so, why? What was the outcome?"}},{type:"markdown-zone",id:"plan-deviation"},{type:"markdown-header",config:{level:2,text:"Recurring Problems"}},{type:"demon-tracker"},{type:"markdown-header",config:{level:3,text:"Problem 1"}},{type:"markdown-header",config:{level:4,text:"What is the problem?"}},{type:"markdown-zone",id:"problem1-what"},{type:"markdown-header",config:{level:4,text:"Why do I have this problem?"}},{type:"markdown-zone",id:"problem1-why"},{type:"markdown-header",config:{level:4,text:"What is the solution?"}},{type:"markdown-zone",id:"problem1-solution"},{type:"markdown-header",config:{level:4,text:"How can I implement it?"}},{type:"markdown-zone",id:"problem1-implement"},{type:"markdown-header",config:{level:3,text:"Problem 2"}},{type:"markdown-header",config:{level:4,text:"What is the problem?"}},{type:"markdown-zone",id:"problem2-what"},{type:"markdown-header",config:{level:4,text:"Why do I have this problem?"}},{type:"markdown-zone",id:"problem2-why"},{type:"markdown-header",config:{level:4,text:"What is the solution?"}},{type:"markdown-zone",id:"problem2-solution"},{type:"markdown-header",config:{level:4,text:"How can I implement it?"}},{type:"markdown-zone",id:"problem2-implement"},{type:"markdown-header",config:{level:3,text:"Problem 3"}},{type:"markdown-header",config:{level:4,text:"What is the problem?"}},{type:"markdown-zone",id:"problem3-what"},{type:"markdown-header",config:{level:4,text:"Why do I have this problem?"}},{type:"markdown-zone",id:"problem3-why"},{type:"markdown-header",config:{level:4,text:"What is the solution?"}},{type:"markdown-zone",id:"problem3-solution"},{type:"markdown-header",config:{level:4,text:"How can I implement it?"}},{type:"markdown-zone",id:"problem3-implement"},{type:"markdown-header",config:{level:2,text:"Recurring Positives"}},{type:"best-worst",config:{period:"trades",showWorst:!1}},{type:"markdown-header",config:{level:3,text:"How can I do more of what worked?"}},{type:"markdown-zone",id:"do-more-of"},{type:"markdown-header",config:{level:2,text:"Process & Habits"}},{type:"mental-game"},{type:"technical-game"},{type:"markdown-header",config:{level:3,text:"Have you kept to a routine that keeps you present and focused during key trading hours?"}},{type:"markdown-zone",id:"routine-focus"},{type:"markdown-header",config:{level:3,text:"Are there processes you feel would improve your performance, but you aren't actively implementing them?"}},{type:"markdown-zone",id:"unimplemented-processes"},{type:"markdown-header",config:{level:3,text:"Are there habits you feel are detrimental to your performance, yet you still engage in them anyway?"}},{type:"markdown-zone",id:"bad-habits"},{type:"markdown-header",config:{level:3,text:"What distractions caused you to miss the most opportunities for trading this year?"}},{type:"markdown-zone",id:"distractions"},{type:"markdown-header",config:{level:2,text:"Goal Setting & Personal Development"}},{type:"markdown-header",config:{level:3,text:"If you could rewind this year, what advice would you give yourself knowing what you know now?"}},{type:"markdown-zone",id:"advice-to-past-self"},{type:"markdown-header",config:{level:3,text:"What are your goals for next year?"}},{type:"markdown-zone",id:"next-year-goals"},{type:"markdown-header",config:{level:3,text:"What processes will be put in place to ensure you meet next year's goals?"}},{type:"markdown-zone",id:"goal-processes"},{type:"markdown-header",config:{level:2,text:"Final Notes"}},{type:"markdown-zone",id:"final-notes"},{type:"review"},{type:"mark-reviewed"}]}]}getTemplates(t){return this.templates.filter(r=>r.type===t)}getTemplate(t){return this.templates.find(r=>r.id===t)}getDefaultTemplate(t){var a;let r={drc:"defaultDrc",weekly:"defaultWeekly",monthly:"defaultMonthly",quarterly:"defaultQuarterly",yearly:"defaultYearly"}[t],n=(a=this.plugin.settings.templates)==null?void 0:a[r];if(n){let o=this.templates.find(s=>s.id===n&&s.type===t);if(o)return o}let i=this.templates.find(o=>o.type===t&&o.isBuiltIn);if(!i){let o=new Date().toISOString();return{id:`builtin-${t}-minimal`,name:`Minimal ${t.toUpperCase()}`,type:t,version:1,createdAt:o,updatedAt:o,isBuiltIn:!0,widgets:[{type:"header",locked:!0}]}}return i}async hasLegacyNotes(){let t={drc:!1,weekly:!1,monthly:!1},r=this.plugin.app.vault.getMarkdownFiles();for(let n of r){let i=this.plugin.app.metadataCache.getFileCache(n),a=i==null?void 0:i.frontmatter;if(!(!(a!=null&&a.type)||a.templateId)&&(a.type==="drc"&&!t.drc&&(t.drc=!0),a.type==="weekly-review"&&!t.weekly&&(t.weekly=!0),a.type==="monthly-review"&&!t.monthly&&(t.monthly=!0),t.drc&&t.weekly&&t.monthly))break}return t}async createTemplate(t){let r=new Date().toISOString(),n=this.generateUniqueName(t.name,t.type),i={...t,name:n,id:gc(),version:1,createdAt:r,updatedAt:r};return this.templates.push(i),await this.saveTemplates(),i}async updateTemplate(t,r){let n=this.templates.findIndex(s=>s.id===t);if(n===-1)throw new Error(`Template not found: ${t}`);let i=this.templates[n];if(i.isBuiltIn)throw new Error("Cannot modify built-in templates. Duplicate the template first.");let a=r.name?this.generateUniqueName(r.name,i.type,t):i.name,o={...i,...r,name:a,id:i.id,isBuiltIn:i.isBuiltIn,createdAt:i.createdAt,updatedAt:new Date().toISOString(),version:i.version+1};return this.templates[n]=o,await this.saveTemplates(),o}async deleteTemplate(t){var o;let r=this.templates.findIndex(s=>s.id===t);if(r===-1)throw new Error(`Template not found: ${t}`);let n=this.templates[r];if(n.isBuiltIn)throw new Error("Cannot delete built-in templates");let a={drc:"defaultDrc",weekly:"defaultWeekly",monthly:"defaultMonthly",quarterly:"defaultQuarterly",yearly:"defaultYearly"}[n.type];((o=this.plugin.settings.templates)==null?void 0:o[a])===t&&(this.plugin.settings.templates[a]="",xe.publish("default-template:changed",{type:n.type,value:null})),this.templates.splice(r,1),await this.saveTemplates()}async duplicateTemplate(t,r){let n=this.getTemplate(t);if(!n)throw new Error(`Template not found: ${t}`);let i=new Date().toISOString(),a=this.generateUniqueName(r,n.type),o={...n,id:gc(),name:a,isBuiltIn:!1,version:1,createdAt:i,updatedAt:i,widgets:JSON.parse(JSON.stringify(n.widgets))};return this.templates.push(o),await this.saveTemplates(),o}getAllTemplates(){return[...this.templates]}reload(){this.loadTemplates()}generateUniqueName(t,r,n){let i=this.templates.filter(s=>s.type===r&&s.id!==n).map(s=>s.name);if(!i.includes(t))return t;let a=1,o=`${t} (${a})`;for(;i.includes(o);)a++,o=`${t} (${a})`;return o}}});var MW={};Ti(MW,{TradeTemplateService:()=>il});var cte,dte,ute,il,bf=F(()=>{xy();Tr();cte=[{id:"what-went-well",title:"**What went well?**",type:"textarea",placeholder:"What did you do right in this trade?"},{id:"what-to-improve",title:"**What could be improved?**",type:"textarea",placeholder:"What would you do differently next time?"},{id:"key-lesson",title:"**Key Lesson**",type:"textarea",placeholder:"What is the main takeaway from this trade?"}],dte=[{id:"win-what-worked",title:"**What worked?**",type:"textarea",placeholder:"What aspects of your strategy or execution led to this win?"},{id:"win-repeatable",title:"**Is this repeatable?**",type:"textarea",placeholder:"Can you consistently replicate what made this trade successful?"}],ute=[{id:"loss-what-happened",title:"**What went wrong?**",type:"textarea",placeholder:"What caused this loss? Was it execution, analysis, or market conditions?"},{id:"loss-avoid-next-time",title:"**How to avoid next time?**",type:"textarea",placeholder:"What specific changes will you make to prevent this type of loss?"},{id:"loss-key-lesson",title:"**Key Lesson**",type:"textarea",placeholder:"What is the main takeaway from this loss?"}],il=class{constructor(t){this.templates=[];this.plugin=t,this.loadTemplates()}loadTemplates(){try{this.plugin.settings.reviewV2||(this.plugin.settings.reviewV2={customWidgetTypes:[],templates:[],tradeTemplates:[]}),this.plugin.settings.reviewV2.tradeTemplates||(this.plugin.settings.reviewV2.tradeTemplates=[]);let t=this.getBuiltInTemplates(),r=this.plugin.settings.reviewV2.tradeTemplates||[],n=new Set(t.map(a=>a.id)),i=r.filter(a=>!n.has(a.id));this.templates=[...t,...i]}catch(t){console.error("Error loading trade templates:",t),this.templates=this.getBuiltInTemplates()}}async saveTemplates(){try{this.plugin.settings.reviewV2||(this.plugin.settings.reviewV2={customWidgetTypes:[],templates:[],tradeTemplates:[]});let t=this.templates.filter(r=>!r.isBuiltIn);this.plugin.settings.reviewV2.tradeTemplates=t,await this.plugin.saveSettings(),xe.publish("trade-template:changed")}catch(t){throw console.error("Error saving trade templates:",t),t}}getBuiltInTemplates(){let t=new Date().toISOString();return[{id:"builtin-trade-standard",name:"Standard Trade",type:"trade",version:1,createdAt:t,updatedAt:t,isBuiltIn:!0,sections:{header:{show:!0},navigation:{show:!0},images:{show:!0,position:"top"},metadata:{show:!0,showAccounts:!0,showSetups:!0,showMistakes:!0,showTags:!0},details:{show:!0,showThesis:!0,metrics:["entry","exit","size","duration","pnl","rMultiple"]},review:{show:"always",showForMissed:!1,showForBacktest:!1,sections:cte,winSections:dte,lossSections:ute},reviewButton:{show:!0}},display:{pnlFormat:"currency",showOpenBadge:!0,showMissedBadge:!0,showBacktestBadge:!0}}]}getTemplates(){return this.templates}getTemplate(t){return this.templates.find(r=>r.id===t)}getDefaultTemplate(){let t=this.templates.find(r=>r.isBuiltIn);if(!t){let r=new Date().toISOString();return{id:"builtin-trade-standard",name:"Standard Trade",type:"trade",version:1,createdAt:r,updatedAt:r,isBuiltIn:!0,sections:{header:{show:!0},navigation:{show:!0},images:{show:!0,position:"top"},metadata:{show:!0,showAccounts:!0,showSetups:!0,showMistakes:!0,showTags:!0},details:{show:!0,showThesis:!0,metrics:["entry","exit","size","duration","pnl","rMultiple"]},review:{show:"always",showForMissed:!1,showForBacktest:!1,sections:cte,winSections:dte,lossSections:ute},reviewButton:{show:!0}},display:{pnlFormat:"currency",showOpenBadge:!0,showMissedBadge:!0,showBacktestBadge:!0}}}return t}async hasLegacyNotes(){let t=this.plugin.app.vault.getMarkdownFiles();for(let r of t){let n=this.plugin.app.metadataCache.getFileCache(r),i=n==null?void 0:n.frontmatter;if(!(!(i!=null&&i.type)||i.templateId)&&(i.type==="trade"||i.type==="backtest-trade"||i.type==="missed-trade"))return!0}return!1}async createTemplate(t){let r=new Date().toISOString(),n=this.generateUniqueName(t.name),i={...t,name:n,id:gc(),version:1,createdAt:r,updatedAt:r};return this.templates.push(i),await this.saveTemplates(),i}async updateTemplate(t,r){let n=this.templates.findIndex(s=>s.id===t);if(n===-1)throw new Error(`Template not found: ${t}`);let i=this.templates[n];if(i.isBuiltIn)throw new Error("Cannot modify built-in templates. Duplicate the template first.");let a=r.name?this.generateUniqueName(r.name,t):i.name,o={...i,...r,name:a,id:i.id,isBuiltIn:i.isBuiltIn,createdAt:i.createdAt,updatedAt:new Date().toISOString(),version:i.version+1};return this.templates[n]=o,await this.saveTemplates(),o}async deleteTemplate(t){var i;let r=this.templates.findIndex(a=>a.id===t);if(r===-1)throw new Error(`Template not found: ${t}`);if(this.templates[r].isBuiltIn)throw new Error("Cannot delete built-in templates");((i=this.plugin.settings.templates)==null?void 0:i.defaultTrade)===t&&(this.plugin.settings.templates.defaultTrade="",xe.publish("default-template:changed",{type:"trade",value:null})),this.templates.splice(r,1),await this.saveTemplates()}async duplicateTemplate(t,r){let n=this.getTemplate(t);if(!n)throw new Error(`Template not found: ${t}`);let i=new Date().toISOString(),a=this.generateUniqueName(r),o={...n,id:gc(),name:a,isBuiltIn:!1,version:1,createdAt:i,updatedAt:i,sections:JSON.parse(JSON.stringify(n.sections)),display:JSON.parse(JSON.stringify(n.display))};return this.templates.push(o),await this.saveTemplates(),o}getAllTemplates(){return[...this.templates]}reload(){this.loadTemplates()}generateUniqueName(t,r){let n=this.templates.filter(o=>o.id!==r).map(o=>o.name);if(!n.includes(t))return t;let i=1,a=`${t} (${i})`;for(;n.includes(a);)i++,a=`${t} (${i})`;return a}}});var Up,d0,AW,pte=F(()=>{Up=Y(Q()),d0=require("obsidian");Ot();AW=Up.default.memo(({app:e,filePath:t,noteType:r,currentTemplateId:n,onTemplateChange:i,className:a="",style:o={}})=>{let[s,l]=(0,Up.useState)(!1),[c,d]=(0,Up.useState)(null),u=!n,p=["drc","weekly-review","monthly-review","quarterly-review","yearly-review"].includes(r),m=()=>r==="weekly-review"?"weekly":r==="monthly-review"?"monthly":r==="quarterly-review"?"quarterly":r==="yearly-review"?"yearly":"drc",g=(0,Up.useCallback)(async()=>{var h,y,b,k;if(!s)try{l(!0);let{openTemplatePickerModal:x}=await Promise.resolve().then(()=>(EW(),DW)),S=[],w="Switch Template",C=(y=(h=e.plugins)==null?void 0:h.plugins)==null?void 0:y.journalit;if(!C){new d0.Notice("Plugin not available");return}let D;if(p){let{ReviewTemplateService:P}=await Promise.resolve().then(()=>(Nd(),IW));S=new P(C).getTemplates(m()),w=`Switch ${{drc:"DRC","weekly-review":"Weekly","monthly-review":"Monthly","quarterly-review":"Quarterly","yearly-review":"Yearly"}[r]||"Review"} Template`;let I={drc:"defaultDrc","weekly-review":"defaultWeekly","monthly-review":"defaultMonthly","quarterly-review":"defaultQuarterly","yearly-review":"defaultYearly"}[r];D=I?(b=C.settings.templates)==null?void 0:b[I]:void 0}else{let{TradeTemplateService:P}=await Promise.resolve().then(()=>(bf(),MW));S=new P(C).getTemplates(),w="Switch Trade Template",D=(k=C.settings.templates)==null?void 0:k.defaultTrade}if(S.length===0){new d0.Notice("No templates available");return}x(e,S,n,w,async P=>{try{d(P.name),i==null||i(P.id),new d0.Notice(`Switched to: ${P.name}`)}catch(M){console.error("Failed to update template:",M),new d0.Notice("Failed to switch template")}},D)}catch(x){console.error("Failed to open template picker:",x),new d0.Notice("Failed to open template picker")}finally{l(!1)}},[e,t,r,n,s,i]),f={padding:"4px 8px",fontSize:"12px",background:"var(--background-secondary)",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",cursor:s?"wait":"pointer",color:"var(--text-muted)",display:"inline-flex",alignItems:"center",gap:"4px",opacity:s?.7:1,...o},v=()=>c||(u?"No template":"Template");return Up.default.createElement("button",{className:`template-menu-button ${a}`,style:f,onClick:g,disabled:s,title:u?"Assign a template to this note":"Switch template"},Up.default.createElement(mT,{size:14,strokeWidth:1.5}),Up.default.createElement("span",null,v()))});AW.displayName="TemplateMenuButton"});function gte(e,t,r,n){return new Promise(i=>{new LW({app:e,fromTemplateName:t,toTemplateName:r,hasContent:n,onConfirm:()=>i(!0),onCancel:()=>i(!1)}).open()})}var mte,po,fte,LW,aAe,hte=F(()=>{mte=require("obsidian"),po=Y(Q()),fte=Y(Ni());Ot();hi();LW=class extends mte.Modal{constructor(r){super(r.app);this.root=null;this.confirmCalled=!1;this.options=r}onOpen(){let{contentEl:r}=this;r.empty();let n=r.createDiv();this.root=(0,fte.createRoot)(n),this.root.render(po.default.createElement(aAe,{...this.options,onClose:()=>this.close(),markConfirmCalled:()=>{this.confirmCalled=!0}})),r.addClass("template-switch-warning-modal"),r.addClass("jl-modal-container")}onClose(){var r,n;this.confirmCalled||(n=(r=this.options).onCancel)==null||n.call(r),this.root&&(this.root.unmount(),this.root=null)}},aAe=po.default.memo(({fromTemplateName:e,toTemplateName:t,hasContent:r,onConfirm:n,onCancel:i,onClose:a,markConfirmCalled:o})=>po.default.createElement("div",{style:{fontFamily:"var(--default-font)",fontSize:"14px",lineHeight:"1.5",maxWidth:"500px"}},po.default.createElement("div",{style:{display:"flex",alignItems:"center",marginBottom:"20px",paddingBottom:"15px",borderBottom:"1px solid var(--background-modifier-border)"}},po.default.createElement(oa,{size:24,style:{marginRight:"10px",color:"var(--color-yellow)",flexShrink:0}}),po.default.createElement("h2",{style:{margin:0,color:"var(--text-normal)",fontSize:"18px",fontWeight:600}},"Switch Template?")),po.default.createElement("div",{style:{marginBottom:"20px"}},po.default.createElement("p",{style:{color:"var(--text-normal)",marginBottom:"12px",lineHeight:"1.6"}},"You're switching from ",po.default.createElement("strong",null,e)," to ",po.default.createElement("strong",null,t),".")),r&&po.default.createElement("div",{style:{padding:"12px 16px",backgroundColor:"var(--background-secondary)",borderRadius:"6px",border:"1px solid var(--background-modifier-border)",marginBottom:"20px"}},po.default.createElement("div",{style:{display:"flex",alignItems:"flex-start",gap:"8px"}},po.default.createElement(oa,{size:16,style:{marginTop:"2px",color:"var(--color-yellow)",flexShrink:0}}),po.default.createElement("div",null,po.default.createElement("strong",{style:{color:"var(--text-normal)",display:"block",marginBottom:"4px"}},"This note has content"),po.default.createElement("div",{style:{color:"var(--text-muted)",fontSize:"13px"}},"Content will be reorganized to fit the new layout. Any content that doesn't fit will be preserved at the bottom of the note for you to review.")))),po.default.createElement("p",{style:{margin:"0 0 20px 0",color:"var(--text-muted)",fontSize:"13px",fontStyle:"italic"}},"This cannot be undone (but you can switch back)."),po.default.createElement("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",borderTop:"1px solid var(--background-modifier-border)",paddingTop:"15px"}},po.default.createElement(Ie,{variant:"secondary",onClick:()=>{o(),i==null||i(),a()},style:{minWidth:"100px"}},"Cancel"),po.default.createElement(Ie,{variant:"primary",onClick:()=>{o(),n(),a()},style:{minWidth:"140px"}},"Switch Template"))))});var vte={};Ti(vte,{TemplateTransformationService:()=>jl});var a1,jl,uh=F(()=>{a1=require("obsidian");hte();jl=class{constructor(t){this.plugin=t}generateNoteFromTemplate(t,r){var a,o;let n=["---"];for(let[s,l]of Object.entries(r))n.push(this.formatFrontmatterValue(s,l));n.push("---"),n.push("");let i=[];for(let s of t.widgets)if(s.type==="markdown-zone")i.push(""),i.push(""),i.push("");else if(s.type==="markdown-header"){let l=s.config,c=(a=l==null?void 0:l.level)!=null?a:2,d=(o=l==null?void 0:l.text)!=null?o:"Header",u="#".repeat(Math.max(1,Math.min(6,c)));i.push(`${u} ${d}`)}else{if(i.push(`\`\`\`journalit-${s.type}`),s.config&&Object.keys(s.config).length>0)for(let[l,c]of Object.entries(s.config))c!=null&&typeof c!="object"&&i.push(`${l}: ${c}`);i.push("```")}return[...n,...i].join(`
`)}async applyTemplate(t,r,n=!0,i){let a=this.plugin.app.vault.getAbstractFileByPath(t);if(!a||!(a instanceof a1.TFile))return new a1.Notice(`File not found: ${t}`),!1;let o=await this.plugin.app.vault.read(a),s=this.parseNoteWidgets(o),l=this.mapContentToWidgets(s),c=Object.values(l).some(u=>u.trim().length>0);if(n&&c&&!await gte(this.plugin.app,i||"Current Template",r.name,c))return!1;let d=this.buildNoteFromTemplate(r,l,o);return await this.plugin.app.vault.modify(a,d),new a1.Notice(`Applied template: ${r.name}`),!0}parseNoteWidgets(t){let r=[],n=t.split(`
`),i=!1,a=!1,o=!1,s="",l=[],c;for(let d=0;d<n.length;d++){let u=n[d];if(d===0&&u==="---"){i=!0;continue}if(i){u==="---"&&(i=!1,a=!0);continue}let p=u.match(/^```journalit-(\w+(?:-\w+)*)/);if(p){l.length>0&&(r.push({type:"markdown",widgetId:c?`${c}-notes`:void 0,content:l.join(`
`)}),l=[]),o=!0,s=p[1];continue}if(o&&u==="```"){r.push({type:"codeblock",widgetType:s,content:""}),c=s,o=!1,s="";continue}if(o)continue;if(u.match(/^(#{1,6})\s+(.+)$/)&&a){l.length>0&&(r.push({type:"markdown",widgetId:c?`${c}-notes`:void 0,content:l.join(`
`)}),l=[]),r.push({type:"markdown-header",content:u});continue}a&&l.push(u)}return l.length>0&&r.push({type:"markdown",widgetId:c?`${c}-notes`:"additional",content:l.join(`
`)}),r}mapContentToWidgets(t){let r={};for(let n of t)if(n.type==="markdown"&&n.widgetId){let i=n.content.trim();i&&(r[n.widgetId]=i)}return r}buildNoteFromTemplate(t,r,n){var d,u;let i=new Set,a=n.match(/^---\n([\s\S]*?)\n---/),o=[];a&&(o=a[1].split(`
`).filter(p=>!p.startsWith("templateId:")&&!p.startsWith("templateVersion:")));let s=["---",...o,`templateId: ${t.id}`,`templateVersion: ${t.version}`,"---",""],l=[];for(let p of t.widgets)if(p.type==="markdown-zone"){let m=p.id||"notes",g=r[m]||r[`${m}-notes`]||"";g?(l.push(g),r[m]&&i.add(m),r[`${m}-notes`]&&i.add(`${m}-notes`)):(l.push(""),l.push(""),l.push(""))}else if(p.type==="markdown-header"){let m=p.config,g=(d=m==null?void 0:m.level)!=null?d:2,f=(u=m==null?void 0:m.text)!=null?u:"Header",v="#".repeat(Math.max(1,Math.min(6,g)));l.push(`${v} ${f}`)}else{if(l.push(`\`\`\`journalit-${p.type}`),p.config&&Object.keys(p.config).length>0)for(let[g,f]of Object.entries(p.config))f!=null&&typeof f!="object"&&l.push(`${g}: ${f}`);l.push("```");let m=`${p.type}-notes`;r[m]&&(l.push(r[m]),i.add(m))}let c=[];for(let[p,m]of Object.entries(r))!i.has(p)&&m.trim()&&c.push(m.trim());if(c.length>0){l.push(""),l.push("---"),l.push(""),l.push("## Content from Previous Template"),l.push(""),l.push("The following content did not fit the new template layout."),l.push("Review and integrate it above, or delete if no longer needed."),l.push("");for(let p of c)l.push(p),l.push("")}return[...s,...l].join(`
`)}formatFrontmatterValue(t,r){return r==null?`${t}: `:typeof r=="string"?r.includes(":")||r.includes("#")||r.includes(`
`)?`${t}: "${r.replace(/"/g,'\\"')}"`:`${t}: ${r}`:typeof r=="number"||typeof r=="boolean"?`${t}: ${r}`:Array.isArray(r)?r.length===0?`${t}: []`:`${t}: ${JSON.stringify(r)}`:typeof r=="object"?`${t}: ${JSON.stringify(r)}`:`${t}: ${r}`}}});function oAe({data:e,filePath:t,openNote:r,plugin:n,serviceName:i,componentName:a,reviewType:o,navigationOptions:s,tabConfig:l,updateMethodName:c,className:d={},topElement:u,bottomElement:p}){var A;let[m,g]=(0,Gc.useState)(e),[f,v]=(0,Gc.useState)(((A=l[0])==null?void 0:A.id)||""),h=FX(a,"general"),y=Ae(),b=n||y,{service:k,status:x}=uf(i),{currentDate:S,getAdjacentReview:w,getRelatedReviewPaths:C}=s,D=r||((I,L=!0)=>{var E;try{let T=window.app;(E=T==null?void 0:T.workspace)==null||E.openLinkText(I,"",L)}catch(T){h(T,"Failed to navigate to path")}}),P=UX({currentDate:S,navigateTo:D,getAdjacentReview:w,getRelatedReviewPaths:C,serviceName:i}),M=async I=>{try{if(g(L=>LX(L,I)),k&&t&&c){let L=Q_(I),E=k,T=E[c];if(typeof T=="function")try{await T.call(E,t,L)}catch($){X_({message:`Failed to update ${a} in file`,error:$,component:a,operation:"updateData",severity:"error"})}}}catch(L){h(L,`Error updating ${a}`),g(E=>({...E,...I}))}},z=async I=>{v(I)};return x==="loading"?Gc.default.createElement("div",{className:d.container||"review-base-container"},"Loading ",a,"..."):x==="error"?Gc.default.createElement("div",{className:d.container||"review-base-container"},Gc.default.createElement("div",{className:"error-state"},"Failed to load ",a,". Please try refreshing the page.")):Gc.default.createElement("div",{className:d.container||"review-base-container","data-component":a},u,Gc.default.createElement(ete,{title:`${a}`,dateDisplay:(()=>{if(o==="weekly-review"||o==="monthly-review")return"";let I=vn(),L=ur(m.date);return!L||isNaN(L.getTime())?"Unknown":zt(L,I)})(),titleRightElement:t?Gc.default.createElement(AW,{app:b==null?void 0:b.app,filePath:t,noteType:o,currentTemplateId:m.templateId,onTemplateChange:async I=>{if(!b)return;let L=new jl(b),E=new uo(b),T=E.getTemplate(I),$=m.templateId?E.getTemplate(m.templateId):null;T&&t&&await L.applyTemplate(t,T,!0,$==null?void 0:$.name)}}):void 0,navigationComponent:Gc.default.createElement(fM,{buttons:(()=>{let I=[],L=o==="weekly-review",E=o==="monthly-review",T=o==="drc";return I.push({text:L?"Previous Week":E?"Previous Month":"Previous Day",action:()=>P.handleNavigation(-1),icon:"left",disabled:P.isNavigating}),T?I.push({text:"Weekly Review",action:()=>P.navigateToRelatedReview("weekly")},{text:"Monthly Review",action:()=>P.navigateToRelatedReview("monthly")}):L?I.push({text:"Monthly Review",action:()=>P.navigateToRelatedReview("monthly")},{text:"Yearly Review",action:()=>P.navigateToRelatedReview("yearly")}):E&&I.push({text:"Quarterly Review",action:()=>P.navigateToRelatedReview("quarterly")},{text:"Yearly Review",action:()=>P.navigateToRelatedReview("yearly")}),I.push({text:L?"Next Week":E?"Next Month":"Next Day",action:()=>P.handleNavigation(1),icon:"right",disabled:P.isNavigating}),I})(),className:`${a.toLowerCase().replace(/\s+/g,"-")}-navigation`}),className:d.header}),Gc.default.createElement(Zee,{tabs:l,activeTab:f,onTabChange:z,className:d.tabContainer}),(()=>{try{let I=l.find(L=>L.id===f);return!I||typeof I.content!="function"?null:I.content({data:m,updateData:M,plugin:b,openNote:D})}catch(I){return console.error("Error rendering tab content:",I),null}})(),p)}var Gc,jmt,yte=F(()=>{Gc=Y(Q());nr();nB();gI();dI();Z_();_t();TW();CW();gM();pte();uh();Nd();jmt=Gc.default.memo(oAe)});var yM,bM,xM=F(()=>{yM=Y(Q());hi();_t();bM=({reviewed:e=!1,reviewedAt:t,onMarkReviewed:r,label:n="Mark as Reviewed",className:i=""})=>{let a=vn();return yM.default.createElement("div",{className:`review-button-container ${i}`},yM.default.createElement(Ie,{variant:"primary",onClick:r,disabled:e,className:"review-button"},e?"\u2713 Reviewed":n),e&&t&&yM.default.createElement("span",{className:"review-timestamp"},"Reviewed on ",zt(new Date(t),a)))}});var pa,bte,pn,Hp=F(()=>{pa=Y(Q()),bte=Y(Td()),pn=pa.default.memo(({content:e,children:t,className:r="",delay:n=300,preferredPosition:i="auto"})=>{let[a,o]=(0,pa.useState)(!1),[s,l]=(0,pa.useState)({top:-9999,left:-9999}),[c,d]=(0,pa.useState)(!1),u=(0,pa.useRef)({x:0,y:0}),p=(0,pa.useRef)(null),m=(0,pa.useRef)(null),g=(0,pa.useRef)(null),f=(0,pa.useRef)(null),v=(0,pa.useCallback)(()=>{if(!f.current||!g.current)return;let k=f.current.getBoundingClientRect(),x=g.current.getBoundingClientRect(),S=window.innerWidth,w=window.innerHeight,C=8,D=0,P=0;switch(k.width<50&&k.height<50&&i==="auto"?"top":i){case"right":D=k.top+(k.height-x.height)/2,P=k.right+C,P+x.width>S-16&&(P=k.left-x.width-C);break;case"left":D=k.top+(k.height-x.height)/2,P=k.left-x.width-C,P<16&&(P=k.right+C);break;case"bottom":D=k.bottom+C,P=k.left+(k.width-x.width)/2;break;case"top":D=k.top-x.height-C,P=k.left+(k.width-x.width)/2,D<16&&(D=k.bottom+C);break;default:D=k.top-x.height-C,P=k.left+(k.width-x.width)/2,D<16&&(D=k.bottom+C)}let A=16;P<A&&(P=A),P+x.width>S-A&&(P=S-x.width-A),D<A&&(D=A),D+x.height>w-A&&(D=w-x.height-A),l({top:D,left:P})},[i]),h=(0,pa.useCallback)(k=>{u.current={x:k.clientX,y:k.clientY},p.current&&cancelAnimationFrame(p.current),m.current=setTimeout(()=>{o(!0),d(!0)},n)},[n]),y=(0,pa.useCallback)(()=>{m.current&&(clearTimeout(m.current),m.current=null),p.current&&(cancelAnimationFrame(p.current),p.current=null),o(!1),setTimeout(()=>d(!1),200)},[]);(0,pa.useEffect)(()=>{a&&c&&(p.current=requestAnimationFrame(()=>{v()}))},[a,c,v]),(0,pa.useEffect)(()=>()=>{m.current&&clearTimeout(m.current),p.current&&cancelAnimationFrame(p.current)},[]);let b=(0,pa.useCallback)(k=>{a&&(Math.abs(k.clientX-u.current.x)>5||Math.abs(k.clientY-u.current.y)>5)&&(u.current={x:k.clientX,y:k.clientY},p.current&&cancelAnimationFrame(p.current),p.current=requestAnimationFrame(()=>{v()}))},[a,v]);return pa.default.createElement(pa.default.Fragment,null,pa.default.createElement("span",{ref:f,onMouseEnter:h,onMouseLeave:y,onMouseMove:b,className:"tooltip-trigger",style:{display:"inline-flex",alignItems:"center",justifyContent:"center"}},t),c&&(0,bte.createPortal)(pa.default.createElement("div",{ref:g,className:`journalit-tooltip ${r}`,style:{position:"fixed",top:`${s.top}px`,left:`${s.left}px`,zIndex:9999,opacity:a?1:0,transition:"opacity 150ms ease-in-out",pointerEvents:"none"}},e),document.body))});pn.displayName="Tooltip"});var xf,Io,ph=F(()=>{xf=Y(Q());XT();Io=({message:e="Loading...",size:t="medium",fullscreen:r=!1,overlay:n=!1})=>{(0,xf.useEffect)(()=>{dy()},[]);let i=t==="small"?16:t==="large"?32:24,a=xf.default.createElement("div",{className:`journalit-loading-spinner ${t}`,style:{"--spinner-size":`${i}px`}},xf.default.createElement("div",{className:"journalit-spinner-icon"}),e&&xf.default.createElement("span",{className:"loading-message"},e));return n?xf.default.createElement("div",{className:"journalit-loading-overlay"},xf.default.createElement("div",{className:"journalit-loading-overlay-content"},a)):r?xf.default.createElement("div",{className:"journalit-loading-fullscreen"},a):a}});var wM,ae,us=F(()=>{wM=Y(Q()),ae=(0,wM.memo)(({width:e="100%",height:t="20px",borderRadius:r="4px",className:n="",style:i={}})=>{let a={width:typeof e=="number"?`${e}px`:e,height:typeof t=="number"?`${t}px`:t,borderRadius:typeof r=="number"?`${r}px`:r,...i};return wM.default.createElement("div",{className:`skeleton-shimmer ${n}`.trim(),style:a,"aria-hidden":"true"})});ae.displayName="SkeletonBox"});var kM,_l,SM=F(()=>{kM=Y(Q());us();_l=(0,kM.memo)(({size:e=24,className:t=""})=>kM.default.createElement(ae,{width:e,height:e,borderRadius:"50%",className:t}));_l.displayName="SkeletonCircle"});var u0,Qe,ps=F(()=>{u0=Y(Q());us();Qe=(0,u0.memo)(({width:e="100%",lines:t=1,gap:r=8,height:n="16px",className:i=""})=>t===1?u0.default.createElement(ae,{width:e,height:n,borderRadius:"8px",className:i}):u0.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:`${r}px`,width:e}},Array.from({length:t}).map((a,o)=>u0.default.createElement(ae,{key:o,width:o===t-1?"60%":"100%",height:n,borderRadius:"8px",className:i}))));Qe.displayName="SkeletonText"});var wy,NW,xte=F(()=>{wy=Y(Q());ps();NW=(0,wy.memo)(()=>wy.default.createElement("div",{className:"metric-card-skeleton","aria-hidden":"true",style:{flex:"1 1 180px",minWidth:"180px",maxWidth:"300px"}},wy.default.createElement("div",{style:{marginBottom:"6px"}},wy.default.createElement(Qe,{width:"80px",height:"14px"})),wy.default.createElement(Qe,{width:"120px",height:"24px"})));NW.displayName="MetricCardSkeleton"});var Dn=F(()=>{gM();Ol();TW();CW();rte();ite();yte();xM();Hp();ph();i0();tM();t1();us();SM();ps();xte()});var qp,wte,kte=F(()=>{qp=Y(Q());Dn();wte=({name:e,value:t,isPositive:r,dollarPart:n,centsPart:i,isCurrency:a=!1,tooltip:o,hasWarning:s=!1})=>{let l=qp.default.createElement("div",{className:"journalit-dashboard-metric-card",style:{flex:"1 1 180px",minWidth:"180px",maxWidth:"300px",backgroundColor:"transparent",padding:"14px",borderRadius:"8px",border:"1px solid rgba(var(--background-modifier-border-rgb, 0, 0, 0), 0.08)",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.04), 0 0 1px rgba(0, 0, 0, 0.08)",display:"flex",flexDirection:"column"}},qp.default.createElement("div",{className:"journalit-dashboard-metric-name",style:{textTransform:"uppercase",fontSize:"14px",fontWeight:"600",letterSpacing:"0.5px",marginBottom:"6px",textAlign:"left",width:"100%",display:"flex",alignItems:"center",gap:"4px"}},e,o&&qp.default.createElement("span",{style:{fontSize:"9px",opacity:.5,cursor:"help"}},"\u24D8"),s&&qp.default.createElement("span",{style:{fontSize:"9px",color:"var(--text-warning, #f0a020)"}},"\u26A0")),qp.default.createElement("div",{className:`journalit-dashboard-metric-value ${r!==void 0?r?"positive":"negative":""}`,style:{fontSize:"24px",fontWeight:"600",textAlign:"left",width:"100%"}},a&&n&&i?qp.default.createElement(qp.default.Fragment,null,n,qp.default.createElement("span",{className:"journalit-dashboard-metric-cents",style:{fontSize:"16px",opacity:"0.7",fontWeight:"500",marginLeft:"1px"}},i)):t));return o?qp.default.createElement(pn,{content:o,delay:200,preferredPosition:"bottom"},l):l}});function Tte(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,mo.useMemo)(()=>n=>{t.forEach(i=>i(n))},t)}function ky(e){let t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function TM(e){return"nodeType"in e}function Bl(e){var t,r;return e?ky(e)?e:TM(e)&&(t=(r=e.ownerDocument)==null?void 0:r.defaultView)!=null?t:window:window}function CM(e){let{Document:t}=Bl(e);return e instanceof t}function p0(e){return ky(e)?!1:e instanceof Bl(e).HTMLElement}function OW(e){return e instanceof Bl(e).SVGElement}function Sy(e){return e?ky(e)?e.document:TM(e)?CM(e)?e:p0(e)||OW(e)?e.ownerDocument:document:document:document}function PM(e){let t=(0,mo.useRef)(e);return Fd(()=>{t.current=e}),(0,mo.useCallback)(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return t.current==null?void 0:t.current(...n)},[])}function Cte(){let e=(0,mo.useRef)(null),t=(0,mo.useCallback)((n,i)=>{e.current=setInterval(n,i)},[]),r=(0,mo.useCallback)(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,r]}function m0(e,t){t===void 0&&(t=[e]);let r=(0,mo.useRef)(e);return Fd(()=>{r.current!==e&&(r.current=e)},t),r}function f0(e,t){let r=(0,mo.useRef)();return(0,mo.useMemo)(()=>{let n=e(r.current);return r.current=n,n},[...t])}function s1(e){let t=PM(e),r=(0,mo.useRef)(null),n=(0,mo.useCallback)(i=>{i!==r.current&&(t==null||t(i,r.current)),r.current=i},[]);return[r,n]}function DM(e){let t=(0,mo.useRef)();return(0,mo.useEffect)(()=>{t.current=e},[e]),t.current}function Ty(e,t){return(0,mo.useMemo)(()=>{if(t)return t;let r=FW[e]==null?0:FW[e]+1;return FW[e]=r,e+"-"+r},[e,t])}function Pte(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n.reduce((a,o)=>{let s=Object.entries(o);for(let[l,c]of s){let d=a[l];d!=null&&(a[l]=d+e*c)}return a},{...t})}}function sAe(e){return"clientX"in e&&"clientY"in e}function l1(e){if(!e)return!1;let{KeyboardEvent:t}=Bl(e.target);return t&&e instanceof t}function lAe(e){if(!e)return!1;let{TouchEvent:t}=Bl(e.target);return t&&e instanceof t}function EM(e){if(lAe(e)){if(e.touches&&e.touches.length){let{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){let{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return sAe(e)?{x:e.clientX,y:e.clientY}:null}function Dte(e){return e.matches(Ste)?e:e.querySelector(Ste)}var mo,o1,Fd,FW,Cy,g0,al,Ste,mh=F(()=>{mo=Y(Q());o1=typeof window!="undefined"&&typeof window.document!="undefined"&&typeof window.document.createElement!="undefined";Fd=o1?mo.useLayoutEffect:mo.useEffect;FW={};Cy=Pte(1),g0=Pte(-1);al=Object.freeze({Translate:{toString(e){if(!e)return;let{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;let{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[al.Translate.toString(e),al.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:n}=e;return t+" "+r+"ms "+n}}}),Ste="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]"});function Ete(e){let{id:t,value:r}=e;return Py.default.createElement("div",{id:t,style:cAe},r)}function Ite(e){let{id:t,announcement:r,ariaLiveType:n="assertive"}=e,i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Py.default.createElement("div",{id:t,style:i,role:"status","aria-live":n,"aria-atomic":!0},r)}function Mte(){let[e,t]=(0,Py.useState)("");return{announce:(0,Py.useCallback)(n=>{n!=null&&t(n)},[]),announcement:e}}var Py,cAe,Ate=F(()=>{Py=Y(Q()),cAe={display:"none"}});function dAe(e){let t=(0,Ne.useContext)(Ute);(0,Ne.useEffect)(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function uAe(){let[e]=(0,Ne.useState)(()=>new Set),t=(0,Ne.useCallback)(n=>(e.add(n),()=>e.delete(n)),[e]);return[(0,Ne.useCallback)(n=>{let{type:i,event:a}=n;e.forEach(o=>{var s;return(s=o[i])==null?void 0:s.call(o,a)})},[e]),t]}function fAe(e){let{announcements:t=mAe,container:r,hiddenTextDescribedById:n,screenReaderInstructions:i=pAe}=e,{announce:a,announcement:o}=Mte(),s=Ty("DndLiveRegion"),[l,c]=(0,Ne.useState)(!1);if((0,Ne.useEffect)(()=>{c(!0)},[]),dAe((0,Ne.useMemo)(()=>({onDragStart(u){let{active:p}=u;a(t.onDragStart({active:p}))},onDragMove(u){let{active:p,over:m}=u;t.onDragMove&&a(t.onDragMove({active:p,over:m}))},onDragOver(u){let{active:p,over:m}=u;a(t.onDragOver({active:p,over:m}))},onDragEnd(u){let{active:p,over:m}=u;a(t.onDragEnd({active:p,over:m}))},onDragCancel(u){let{active:p,over:m}=u;a(t.onDragCancel({active:p,over:m}))}}),[a,t])),!l)return null;let d=Ne.default.createElement(Ne.default.Fragment,null,Ne.default.createElement(Ete,{id:n,value:i.draggable}),Ne.default.createElement(Ite,{id:s,announcement:o}));return r?(0,Dy.createPortal)(d,r):d}function MM(){}function gAe(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function hAe(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return r-n}function vAe(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return n-r}function Hte(e,t){if(!e||e.length===0)return null;let[r]=e;return t?r[t]:r}function Lte(e,t,r){return t===void 0&&(t=e.left),r===void 0&&(r=e.top),{x:t+e.width*.5,y:r+e.height*.5}}function yAe(e,t){let r=Math.max(t.top,e.top),n=Math.max(t.left,e.left),i=Math.min(t.left+t.width,e.left+e.width),a=Math.min(t.top+t.height,e.top+e.height),o=i-n,s=a-r;if(n<i&&r<a){let l=t.width*t.height,c=e.width*e.height,d=o*s,u=d/(l+c-d);return Number(u.toFixed(4))}return 0}function xAe(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}function qte(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Ru}function wAe(e){return function(r){for(var n=arguments.length,i=new Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];return i.reduce((o,s)=>({...o,top:o.top+e*s.y,bottom:o.bottom+e*s.y,left:o.left+e*s.x,right:o.right+e*s.x}),{...r})}}function SAe(e){if(e.startsWith("matrix3d(")){let t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){let t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function TAe(e,t,r){let n=SAe(t);if(!n)return e;let{scaleX:i,scaleY:a,x:o,y:s}=n,l=e.left-o-(1-i)*parseFloat(r),c=e.top-s-(1-a)*parseFloat(r.slice(r.indexOf(" ")+1)),d=i?e.width/i:e.width,u=a?e.height/a:e.height;return{width:d,height:u,top:c,right:l+d,bottom:c+u,left:l}}function My(e,t){t===void 0&&(t=CAe);let r=e.getBoundingClientRect();if(t.ignoreTransform){let{transform:c,transformOrigin:d}=Bl(e).getComputedStyle(e);c&&(r=TAe(r,c,d))}let{top:n,left:i,width:a,height:o,bottom:s,right:l}=r;return{top:n,left:i,width:a,height:o,bottom:s,right:l}}function Nte(e){return My(e,{ignoreTransform:!0})}function PAe(e){let t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}function DAe(e,t){return t===void 0&&(t=Bl(e).getComputedStyle(e)),t.position==="fixed"}function EAe(e,t){t===void 0&&(t=Bl(e).getComputedStyle(e));let r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{let a=t[i];return typeof a=="string"?r.test(a):!1})}function FM(e,t){let r=[];function n(i){if(t!=null&&r.length>=t||!i)return r;if(CM(i)&&i.scrollingElement!=null&&!r.includes(i.scrollingElement))return r.push(i.scrollingElement),r;if(!p0(i)||OW(i)||r.includes(i))return r;let a=Bl(e).getComputedStyle(i);return i!==e&&EAe(i,a)&&r.push(i),DAe(i,a)?r:n(i.parentNode)}return e?n(e):r}function Vte(e){let[t]=FM(e,1);return t!=null?t:null}function zW(e){return!o1||!e?null:ky(e)?e:TM(e)?CM(e)||e===Sy(e).scrollingElement?window:p0(e)?e:null:null}function Gte(e){return ky(e)?e.scrollX:e.scrollLeft}function Yte(e){return ky(e)?e.scrollY:e.scrollTop}function BW(e){return{x:Gte(e),y:Yte(e)}}function Kte(e){return!o1||!e?!1:e===document.scrollingElement}function Jte(e){let t={x:0,y:0},r=Kte(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},n={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},i=e.scrollTop<=t.y,a=e.scrollLeft<=t.x,o=e.scrollTop>=n.y,s=e.scrollLeft>=n.x;return{isTop:i,isLeft:a,isBottom:o,isRight:s,maxScroll:n,minScroll:t}}function MAe(e,t,r,n,i){let{top:a,left:o,right:s,bottom:l}=r;n===void 0&&(n=10),i===void 0&&(i=IAe);let{isTop:c,isBottom:d,isLeft:u,isRight:p}=Jte(e),m={x:0,y:0},g={x:0,y:0},f={height:t.height*i.y,width:t.width*i.x};return!c&&a<=t.top+f.height?(m.y=ms.Backward,g.y=n*Math.abs((t.top+f.height-a)/f.height)):!d&&l>=t.bottom-f.height&&(m.y=ms.Forward,g.y=n*Math.abs((t.bottom-f.height-l)/f.height)),!p&&s>=t.right-f.width?(m.x=ms.Forward,g.x=n*Math.abs((t.right-f.width-s)/f.width)):!u&&o<=t.left+f.width&&(m.x=ms.Backward,g.x=n*Math.abs((t.left+f.width-o)/f.width)),{direction:m,speed:g}}function AAe(e){if(e===document.scrollingElement){let{innerWidth:a,innerHeight:o}=window;return{top:0,left:0,right:a,bottom:o,width:a,height:o}}let{top:t,left:r,right:n,bottom:i}=e.getBoundingClientRect();return{top:t,left:r,right:n,bottom:i,width:e.clientWidth,height:e.clientHeight}}function Qte(e){return e.reduce((t,r)=>Cy(t,BW(r)),Ru)}function LAe(e){return e.reduce((t,r)=>t+Gte(r),0)}function NAe(e){return e.reduce((t,r)=>t+Yte(r),0)}function FAe(e,t){if(t===void 0&&(t=My),!e)return;let{top:r,left:n,bottom:i,right:a}=t(e);Vte(e)&&(i<=0||a<=0||r>=window.innerHeight||n>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}function zAe(e){let{EventTarget:t}=Bl(e);return e instanceof t?e:Sy(e)}function jW(e,t){let r=Math.abs(e.x),n=Math.abs(e.y);return typeof t=="number"?Math.sqrt(r**2+n**2)>t:"x"in t&&"y"in t?r>t.x&&n>t.y:"x"in t?r>t.x:"y"in t?n>t.y:!1}function Fte(e){e.preventDefault()}function jAe(e){e.stopPropagation()}function Ote(e){return!!(e&&"distance"in e)}function zte(e){return!!(e&&"delay"in e)}function $Ae(e){let{acceleration:t,activator:r=c1.Pointer,canScroll:n,draggingRect:i,enabled:a,interval:o=5,order:s=NM.TreeOrder,pointerCoordinates:l,scrollableAncestors:c,scrollableAncestorRects:d,delta:u,threshold:p}=e,m=UAe({delta:u,disabled:!a}),[g,f]=Cte(),v=(0,Ne.useRef)({x:0,y:0}),h=(0,Ne.useRef)({x:0,y:0}),y=(0,Ne.useMemo)(()=>{switch(r){case c1.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case c1.DraggableRect:return i}},[r,i,l]),b=(0,Ne.useRef)(null),k=(0,Ne.useCallback)(()=>{let S=b.current;if(!S)return;let w=v.current.x*h.current.x,C=v.current.y*h.current.y;S.scrollBy(w,C)},[]),x=(0,Ne.useMemo)(()=>s===NM.TreeOrder?[...c].reverse():c,[s,c]);(0,Ne.useEffect)(()=>{if(!a||!c.length||!y){f();return}for(let S of x){if((n==null?void 0:n(S))===!1)continue;let w=c.indexOf(S),C=d[w];if(!C)continue;let{direction:D,speed:P}=MAe(S,C,y,t,p);for(let M of["x","y"])m[M][D[M]]||(P[M]=0,D[M]=0);if(P.x>0||P.y>0){f(),b.current=S,g(k,o),v.current=P,h.current=D;return}}v.current={x:0,y:0},h.current={x:0,y:0},f()},[t,k,n,f,a,o,JSON.stringify(y),JSON.stringify(m),g,c,x,d,JSON.stringify(p)])}function UAe(e){let{delta:t,disabled:r}=e,n=DM(t);return f0(i=>{if(r||!n||!i)return RAe;let a={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[ms.Backward]:i.x[ms.Backward]||a.x===-1,[ms.Forward]:i.x[ms.Forward]||a.x===1},y:{[ms.Backward]:i.y[ms.Backward]||a.y===-1,[ms.Forward]:i.y[ms.Forward]||a.y===1}}},[r,t,n])}function HAe(e,t){let r=t!=null?e.get(t):void 0,n=r?r.node.current:null;return f0(i=>{var a;return t==null?null:(a=n!=null?n:i)!=null?a:null},[n,t])}function qAe(e,t){return(0,Ne.useMemo)(()=>e.reduce((r,n)=>{let{sensor:i}=n,a=i.activators.map(o=>({eventName:o.eventName,handler:t(o.handler,n)}));return[...r,...a]},[]),[e,t])}function VAe(e,t){let{dragging:r,dependencies:n,config:i}=t,[a,o]=(0,Ne.useState)(null),{frequency:s,measure:l,strategy:c}=i,d=(0,Ne.useRef)(e),u=v(),p=m0(u),m=(0,Ne.useCallback)(function(h){h===void 0&&(h=[]),!p.current&&o(y=>y===null?h:y.concat(h.filter(b=>!y.includes(b))))},[p]),g=(0,Ne.useRef)(null),f=f0(h=>{if(u&&!r)return jte;if(!h||h===jte||d.current!==e||a!=null){let y=new Map;for(let b of e){if(!b)continue;if(a&&a.length>0&&!a.includes(b.id)&&b.rect.current){y.set(b.id,b.rect.current);continue}let k=b.node.current,x=k?new d1(l(k),k):null;b.rect.current=x,x&&y.set(b.id,x)}return y}return h},[e,a,r,u,l]);return(0,Ne.useEffect)(()=>{d.current=e},[e]),(0,Ne.useEffect)(()=>{u||m()},[r,u]),(0,Ne.useEffect)(()=>{a&&a.length>0&&o(null)},[JSON.stringify(a)]),(0,Ne.useEffect)(()=>{u||typeof s!="number"||g.current!==null||(g.current=setTimeout(()=>{m(),g.current=null},s))},[s,u,m,...n]),{droppableRects:f,measureDroppableContainers:m,measuringScheduled:a!=null};function v(){switch(c){case p1.Always:return!1;case p1.BeforeDragging:return r;default:return!r}}}function Zte(e,t){return f0(r=>e?r||(typeof t=="function"?t(e):e):null,[t,e])}function GAe(e,t){return Zte(e,t)}function YAe(e){let{callback:t,disabled:r}=e,n=PM(t),i=(0,Ne.useMemo)(()=>{if(r||typeof window=="undefined"||typeof window.MutationObserver=="undefined")return;let{MutationObserver:a}=window;return new a(n)},[n,r]);return(0,Ne.useEffect)(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function OM(e){let{callback:t,disabled:r}=e,n=PM(t),i=(0,Ne.useMemo)(()=>{if(r||typeof window=="undefined"||typeof window.ResizeObserver=="undefined")return;let{ResizeObserver:a}=window;return new a(n)},[r]);return(0,Ne.useEffect)(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function KAe(e){return new d1(My(e),e)}function _te(e,t,r){t===void 0&&(t=KAe);let[n,i]=(0,Ne.useState)(null);function a(){i(l=>{if(!e)return null;if(e.isConnected===!1){var c;return(c=l!=null?l:r)!=null?c:null}let d=t(e);return JSON.stringify(l)===JSON.stringify(d)?l:d})}let o=YAe({callback(l){if(e)for(let c of l){let{type:d,target:u}=c;if(d==="childList"&&u instanceof HTMLElement&&u.contains(e)){a();break}}}}),s=OM({callback:a});return Fd(()=>{a(),e?(s==null||s.observe(e),o==null||o.observe(document.body,{childList:!0,subtree:!0})):(s==null||s.disconnect(),o==null||o.disconnect())},[e]),n}function JAe(e){let t=Zte(e);return qte(e,t)}function QAe(e){let t=(0,Ne.useRef)(e),r=f0(n=>e?n&&n!==Bte&&e&&t.current&&e.parentNode===t.current.parentNode?n:FM(e):Bte,[e]);return(0,Ne.useEffect)(()=>{t.current=e},[e]),r}function XAe(e){let[t,r]=(0,Ne.useState)(null),n=(0,Ne.useRef)(e),i=(0,Ne.useCallback)(a=>{let o=zW(a.target);o&&r(s=>s?(s.set(o,BW(o)),new Map(s)):null)},[]);return(0,Ne.useEffect)(()=>{let a=n.current;if(e!==a){o(a);let s=e.map(l=>{let c=zW(l);return c?(c.addEventListener("scroll",i,{passive:!0}),[c,BW(c)]):null}).filter(l=>l!=null);r(s.length?new Map(s):null),n.current=e}return()=>{o(e),o(a)};function o(s){s.forEach(l=>{let c=zW(l);c==null||c.removeEventListener("scroll",i)})}},[i,e]),(0,Ne.useMemo)(()=>e.length?t?Array.from(t.values()).reduce((a,o)=>Cy(a,o),Ru):Qte(e):Ru,[e,t])}function Wte(e,t){t===void 0&&(t=[]);let r=(0,Ne.useRef)(null);return(0,Ne.useEffect)(()=>{r.current=null},t),(0,Ne.useEffect)(()=>{let n=e!==Ru;n&&!r.current&&(r.current=e),!n&&r.current&&(r.current=null)},[e]),r.current?g0(e,r.current):Ru}function ZAe(e){(0,Ne.useEffect)(()=>{if(!o1)return;let t=e.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(let r of t)r==null||r()}},e.map(t=>{let{sensor:r}=t;return r}))}function eLe(e,t){return(0,Ne.useMemo)(()=>e.reduce((r,n)=>{let{eventName:i,handler:a}=n;return r[i]=o=>{a(o,t)},r},{}),[e,t])}function ere(e){return(0,Ne.useMemo)(()=>e?PAe(e):null,[e])}function tLe(e,t){t===void 0&&(t=My);let[r]=e,n=ere(r?Bl(r):null),[i,a]=(0,Ne.useState)($te);function o(){a(()=>e.length?e.map(l=>Kte(l)?n:new d1(t(l),l)):$te)}let s=OM({callback:o});return Fd(()=>{s==null||s.disconnect(),o(),e.forEach(l=>s==null?void 0:s.observe(l))},[e]),i}function rLe(e){if(!e)return null;if(e.children.length>1)return e;let t=e.children[0];return p0(t)?t:e}function nLe(e){let{measure:t}=e,[r,n]=(0,Ne.useState)(null),i=(0,Ne.useCallback)(c=>{for(let{target:d}of c)if(p0(d)){n(u=>{let p=t(d);return u?{...u,width:p.width,height:p.height}:p});break}},[t]),a=OM({callback:i}),o=(0,Ne.useCallback)(c=>{let d=rLe(c);a==null||a.disconnect(),d&&(a==null||a.observe(d)),n(d?t(d):null)},[t,a]),[s,l]=s1(o);return(0,Ne.useMemo)(()=>({nodeRef:s,rect:r,setRef:l}),[r,s,l])}function lLe(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Iy}}}function cLe(e,t){switch(t.type){case Ko.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case Ko.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case Ko.DragEnd:case Ko.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Ko.RegisterDroppable:{let{element:r}=t,{id:n}=r,i=new Iy(e.droppable.containers);return i.set(n,r),{...e,droppable:{...e.droppable,containers:i}}}case Ko.SetDroppableDisabled:{let{id:r,key:n,disabled:i}=t,a=e.droppable.containers.get(r);if(!a||n!==a.key)return e;let o=new Iy(e.droppable.containers);return o.set(r,{...a,disabled:i}),{...e,droppable:{...e.droppable,containers:o}}}case Ko.UnregisterDroppable:{let{id:r,key:n}=t,i=e.droppable.containers.get(r);if(!i||n!==i.key)return e;let a=new Iy(e.droppable.containers);return a.delete(r),{...e,droppable:{...e.droppable,containers:a}}}default:return e}}function dLe(e){let{disabled:t}=e,{active:r,activatorEvent:n,draggableNodes:i}=(0,Ne.useContext)(zM),a=DM(n),o=DM(r==null?void 0:r.id);return(0,Ne.useEffect)(()=>{if(!t&&!n&&a&&o!=null){if(!l1(a)||document.activeElement===a.target)return;let s=i.get(o);if(!s)return;let{activatorNode:l,node:c}=s;if(!l.current&&!c.current)return;requestAnimationFrame(()=>{for(let d of[l.current,c.current]){if(!d)continue;let u=Dte(d);if(u){u.focus();break}}})}},[n,t,i,o,a]),null}function uLe(e,t){let{transform:r,...n}=t;return e!=null&&e.length?e.reduce((i,a)=>a({transform:i,...n}),r):r}function pLe(e){return(0,Ne.useMemo)(()=>({draggable:{...IM.draggable,...e==null?void 0:e.draggable},droppable:{...IM.droppable,...e==null?void 0:e.droppable},dragOverlay:{...IM.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function mLe(e){let{activeNode:t,measure:r,initialRect:n,config:i=!0}=e,a=(0,Ne.useRef)(!1),{x:o,y:s}=typeof i=="boolean"?{x:i,y:i}:i;Fd(()=>{if(!o&&!s||!t){a.current=!1;return}if(a.current||!n)return;let c=t==null?void 0:t.node.current;if(!c||c.isConnected===!1)return;let d=r(c),u=qte(d,n);if(o||(u.x=0),s||(u.y=0),a.current=!0,Math.abs(u.x)>0||Math.abs(u.y)>0){let p=Vte(c);p&&p.scrollBy({top:u.y,left:u.x})}},[t,o,s,n,r])}function nre(e){let{id:t,data:r,disabled:n=!1,attributes:i}=e,a=Ty(gLe),{activators:o,activatorEvent:s,active:l,activeNodeRect:c,ariaDescribedById:d,draggableNodes:u,over:p}=(0,Ne.useContext)(zM),{role:m=Rte,roleDescription:g="draggable",tabIndex:f=0}=i!=null?i:{},v=(l==null?void 0:l.id)===t,h=(0,Ne.useContext)(v?rre:fLe),[y,b]=s1(),[k,x]=s1(),S=eLe(o,t),w=m0(r);Fd(()=>(u.set(t,{id:t,key:a,node:y,activatorNode:k,data:w}),()=>{let D=u.get(t);D&&D.key===a&&u.delete(t)}),[u,t]);let C=(0,Ne.useMemo)(()=>({role:m,tabIndex:f,"aria-disabled":n,"aria-pressed":v&&m===Rte?!0:void 0,"aria-roledescription":g,"aria-describedby":d.draggable}),[n,m,f,v,g,d.draggable]);return{active:l,activatorEvent:s,activeNodeRect:c,attributes:C,isDragging:v,listeners:n?void 0:S,node:y,over:p,setNodeRef:b,setActivatorNodeRef:x,transform:h}}function ire(){return(0,Ne.useContext)(tre)}function are(e){let{data:t,disabled:r=!1,id:n,resizeObserverConfig:i}=e,a=Ty(hLe),{active:o,dispatch:s,over:l,measureDroppableContainers:c}=(0,Ne.useContext)(zM),d=(0,Ne.useRef)({disabled:r}),u=(0,Ne.useRef)(!1),p=(0,Ne.useRef)(null),m=(0,Ne.useRef)(null),{disabled:g,updateMeasurementsFor:f,timeout:v}={...vLe,...i},h=m0(f!=null?f:n),y=(0,Ne.useCallback)(()=>{if(!u.current){u.current=!0;return}m.current!=null&&clearTimeout(m.current),m.current=setTimeout(()=>{c(Array.isArray(h.current)?h.current:[h.current]),m.current=null},v)},[v]),b=OM({callback:y,disabled:g||!o}),k=(0,Ne.useCallback)((C,D)=>{b&&(D&&(b.unobserve(D),u.current=!1),C&&b.observe(C))},[b]),[x,S]=s1(k),w=m0(t);return(0,Ne.useEffect)(()=>{!b||!x.current||(b.disconnect(),u.current=!1,b.observe(x.current))},[x,b]),(0,Ne.useEffect)(()=>(s({type:Ko.RegisterDroppable,element:{id:n,key:a,disabled:r,node:x,rect:p,data:w}}),()=>s({type:Ko.UnregisterDroppable,key:a,id:n})),[n]),(0,Ne.useEffect)(()=>{r!==d.current.disabled&&(s({type:Ko.SetDroppableDisabled,id:n,key:a,disabled:r}),d.current.disabled=r)},[n,a,r,s]),{active:o,rect:p,isOver:(l==null?void 0:l.id)===n,node:x,over:l,setNodeRef:S}}var Ne,Dy,Ute,pAe,mAe,Ko,Ru,zd,bAe,kAe,CAe,ms,IAe,OAe,d1,Ey,Od,Un,Xte,_Ae,AM,u1,BAe,LM,WAe,WW,$W,_W,RW,c1,NM,RAe,p1,UW,jte,Bte,$te,iLe,aLe,IM,Iy,oLe,sLe,zM,tre,rre,fh,jd,fLe,Rte,gLe,hLe,vLe,Ay=F(()=>{Ne=Y(Q()),Dy=Y(Td());mh();Ate();Ute=(0,Ne.createContext)(null);pAe={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},mAe={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(Ko||(Ko={}));Ru=Object.freeze({x:0,y:0});zd=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e,i=Lte(t,t.left,t.top),a=[];for(let o of n){let{id:s}=o,l=r.get(s);if(l){let c=gAe(Lte(l),i);a.push({id:s,data:{droppableContainer:o,value:c}})}}return a.sort(hAe)};bAe=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e,i=[];for(let a of n){let{id:o}=a,s=r.get(o);if(s){let l=yAe(s,t);l>0&&i.push({id:o,data:{droppableContainer:a,value:l}})}}return i.sort(vAe)};kAe=wAe(1);CAe={ignoreTransform:!1};(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(ms||(ms={}));IAe={x:.2,y:.2};OAe=[["x",["left","right"],LAe],["y",["top","bottom"],NAe]],d1=class{constructor(t,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;let n=FM(r),i=Qte(n);this.rect={...t},this.width=t.width,this.height=t.height;for(let[a,o,s]of OAe)for(let l of o)Object.defineProperty(this,l,{get:()=>{let c=s(n),d=i[a]-c;return this.rect[l]+d},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}},Ey=class{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=t}add(t,r,n){var i;(i=this.target)==null||i.addEventListener(t,r,n),this.listeners.push([t,r,n])}};(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Od||(Od={}));(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Un||(Un={}));Xte={start:[Un.Space,Un.Enter],cancel:[Un.Esc],end:[Un.Space,Un.Enter,Un.Tab]},_Ae=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case Un.Right:return{...r,x:r.x+25};case Un.Left:return{...r,x:r.x-25};case Un.Down:return{...r,y:r.y+25};case Un.Up:return{...r,y:r.y-25}}},AM=class{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;let{event:{target:r}}=t;this.props=t,this.listeners=new Ey(Sy(r)),this.windowListeners=new Ey(Bl(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Od.Resize,this.handleCancel),this.windowListeners.add(Od.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Od.Keydown,this.handleKeyDown))}handleStart(){let{activeNode:t,onStart:r}=this.props,n=t.node.current;n&&FAe(n),r(Ru)}handleKeyDown(t){if(l1(t)){let{active:r,context:n,options:i}=this.props,{keyboardCodes:a=Xte,coordinateGetter:o=_Ae,scrollBehavior:s="smooth"}=i,{code:l}=t;if(a.end.includes(l)){this.handleEnd(t);return}if(a.cancel.includes(l)){this.handleCancel(t);return}let{collisionRect:c}=n.current,d=c?{x:c.left,y:c.top}:Ru;this.referenceCoordinates||(this.referenceCoordinates=d);let u=o(t,{active:r,context:n.current,currentCoordinates:d});if(u){let p=g0(u,d),m={x:0,y:0},{scrollableAncestors:g}=n.current;for(let f of g){let v=t.code,{isTop:h,isRight:y,isLeft:b,isBottom:k,maxScroll:x,minScroll:S}=Jte(f),w=AAe(f),C={x:Math.min(v===Un.Right?w.right-w.width/2:w.right,Math.max(v===Un.Right?w.left:w.left+w.width/2,u.x)),y:Math.min(v===Un.Down?w.bottom-w.height/2:w.bottom,Math.max(v===Un.Down?w.top:w.top+w.height/2,u.y))},D=v===Un.Right&&!y||v===Un.Left&&!b,P=v===Un.Down&&!k||v===Un.Up&&!h;if(D&&C.x!==u.x){let M=f.scrollLeft+p.x,z=v===Un.Right&&M<=x.x||v===Un.Left&&M>=S.x;if(z&&!p.y){f.scrollTo({left:M,behavior:s});return}z?m.x=f.scrollLeft-M:m.x=v===Un.Right?f.scrollLeft-x.x:f.scrollLeft-S.x,m.x&&f.scrollBy({left:-m.x,behavior:s});break}else if(P&&C.y!==u.y){let M=f.scrollTop+p.y,z=v===Un.Down&&M<=x.y||v===Un.Up&&M>=S.y;if(z&&!p.x){f.scrollTo({top:M,behavior:s});return}z?m.y=f.scrollTop-M:m.y=v===Un.Down?f.scrollTop-x.y:f.scrollTop-S.y,m.y&&f.scrollBy({top:-m.y,behavior:s});break}}this.handleMove(t,Cy(g0(u,this.referenceCoordinates),m))}}}handleMove(t,r){let{onMove:n}=this.props;t.preventDefault(),n(r)}handleEnd(t){let{onEnd:r}=this.props;t.preventDefault(),this.detach(),r()}handleCancel(t){let{onCancel:r}=this.props;t.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}};AM.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:n=Xte,onActivation:i}=t,{active:a}=r,{code:o}=e.nativeEvent;if(n.start.includes(o)){let s=a.activatorNode.current;return s&&e.target!==s?!1:(e.preventDefault(),i==null||i({event:e.nativeEvent}),!0)}return!1}}];u1=class{constructor(t,r,n){var i;n===void 0&&(n=zAe(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=r;let{event:a}=t,{target:o}=a;this.props=t,this.events=r,this.document=Sy(o),this.documentListeners=new Ey(this.document),this.listeners=new Ey(n),this.windowListeners=new Ey(Bl(o)),this.initialCoordinates=(i=EM(a))!=null?i:Ru,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){let{events:t,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Od.Resize,this.handleCancel),this.windowListeners.add(Od.DragStart,Fte),this.windowListeners.add(Od.VisibilityChange,this.handleCancel),this.windowListeners.add(Od.ContextMenu,Fte),this.documentListeners.add(Od.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(zte(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(Ote(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,r){let{active:n,onPending:i}=this.props;i(n,t,this.initialCoordinates,r)}handleStart(){let{initialCoordinates:t}=this,{onStart:r}=this.props;t&&(this.activated=!0,this.documentListeners.add(Od.Click,jAe,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Od.SelectionChange,this.removeTextSelection),r(t))}handleMove(t){var r;let{activated:n,initialCoordinates:i,props:a}=this,{onMove:o,options:{activationConstraint:s}}=a;if(!i)return;let l=(r=EM(t))!=null?r:Ru,c=g0(i,l);if(!n&&s){if(Ote(s)){if(s.tolerance!=null&&jW(c,s.tolerance))return this.handleCancel();if(jW(c,s.distance))return this.handleStart()}if(zte(s)&&jW(c,s.tolerance))return this.handleCancel();this.handlePending(s,c);return}t.cancelable&&t.preventDefault(),o(l)}handleEnd(){let{onAbort:t,onEnd:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleCancel(){let{onAbort:t,onCancel:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleKeydown(t){t.code===Un.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}},BAe={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}},LM=class extends u1{constructor(t){let{event:r}=t,n=Sy(r.target);super(t,BAe,n)}};LM.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return!r.isPrimary||r.button!==0?!1:(n==null||n({event:r}),!0)}}];WAe={move:{name:"mousemove"},end:{name:"mouseup"}};(function(e){e[e.RightClick=2]="RightClick"})(WW||(WW={}));$W=class extends u1{constructor(t){super(t,WAe,Sy(t.event.target))}};$W.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return r.button===WW.RightClick?!1:(n==null||n({event:r}),!0)}}];_W={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}},RW=class extends u1{constructor(t){super(t,_W)}static setup(){return window.addEventListener(_W.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(_W.move.name,t)};function t(){}}};RW.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t,{touches:i}=r;return i.length>1?!1:(n==null||n({event:r}),!0)}}];(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(c1||(c1={}));(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(NM||(NM={}));RAe={x:{[ms.Backward]:!1,[ms.Forward]:!1},y:{[ms.Backward]:!1,[ms.Forward]:!1}};(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(p1||(p1={}));(function(e){e.Optimized="optimized"})(UW||(UW={}));jte=new Map;Bte=[];$te=[];iLe=[{sensor:LM,options:{}},{sensor:AM,options:{}}],aLe={current:{}},IM={draggable:{measure:Nte},droppable:{measure:Nte,strategy:p1.WhileDragging,frequency:UW.Optimized},dragOverlay:{measure:My}},Iy=class extends Map{get(t){var r;return t!=null&&(r=super.get(t))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:r}=t;return!r})}getNodeFor(t){var r,n;return(r=(n=this.get(t))==null?void 0:n.node.current)!=null?r:void 0}},oLe={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Iy,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:MM},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:IM,measureDroppableContainers:MM,windowRect:null,measuringScheduled:!1},sLe={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:MM,draggableNodes:new Map,over:null,measureDroppableContainers:MM},zM=(0,Ne.createContext)(sLe),tre=(0,Ne.createContext)(oLe);rre=(0,Ne.createContext)({...Ru,scaleX:1,scaleY:1});(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(fh||(fh={}));jd=(0,Ne.memo)(function(t){var r,n,i,a;let{id:o,accessibility:s,autoScroll:l=!0,children:c,sensors:d=iLe,collisionDetection:u=bAe,measuring:p,modifiers:m,...g}=t,f=(0,Ne.useReducer)(cLe,void 0,lLe),[v,h]=f,[y,b]=uAe(),[k,x]=(0,Ne.useState)(fh.Uninitialized),S=k===fh.Initialized,{draggable:{active:w,nodes:C,translate:D},droppable:{containers:P}}=v,M=w!=null?C.get(w):null,z=(0,Ne.useRef)({initial:null,translated:null}),A=(0,Ne.useMemo)(()=>{var yr;return w!=null?{id:w,data:(yr=M==null?void 0:M.data)!=null?yr:aLe,rect:z}:null},[w,M]),I=(0,Ne.useRef)(null),[L,E]=(0,Ne.useState)(null),[T,$]=(0,Ne.useState)(null),_=m0(g,Object.values(g)),B=Ty("DndDescribedBy",o),W=(0,Ne.useMemo)(()=>P.getEnabled(),[P]),N=pLe(p),{droppableRects:U,measureDroppableContainers:j,measuringScheduled:R}=VAe(W,{dragging:S,dependencies:[D.x,D.y],config:N.droppable}),O=HAe(C,w),H=(0,Ne.useMemo)(()=>T?EM(T):null,[T]),q=ia(),V=GAe(O,N.draggable.measure);mLe({activeNode:w!=null?C.get(w):null,config:q.layoutShiftCompensation,initialRect:V,measure:N.draggable.measure});let J=_te(O,N.draggable.measure,V),K=_te(O?O.parentElement:null),G=(0,Ne.useRef)({activatorEvent:null,active:null,activeNode:O,collisionRect:null,collisions:null,droppableRects:U,draggableNodes:C,draggingNode:null,draggingNodeRect:null,droppableContainers:P,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),X=P.getNodeFor((r=G.current.over)==null?void 0:r.id),te=nLe({measure:N.dragOverlay.measure}),re=(n=te.nodeRef.current)!=null?n:O,Z=S?(i=te.rect)!=null?i:J:null,ne=!!(te.nodeRef.current&&te.rect),se=JAe(ne?null:J),ee=ere(re?Bl(re):null),ie=QAe(S?X!=null?X:O:null),ve=tLe(ie),Se=uLe(m,{transform:{x:D.x-se.x,y:D.y-se.y,scaleX:1,scaleY:1},activatorEvent:T,active:A,activeNodeRect:J,containerNodeRect:K,draggingNodeRect:Z,over:G.current.over,overlayNodeRect:te.rect,scrollableAncestors:ie,scrollableAncestorRects:ve,windowRect:ee}),Me=H?Cy(H,D):null,le=XAe(ie),Ye=Wte(le),ue=Wte(le,[J]),We=Cy(Se,Ye),Ke=Z?kAe(Z,Se):null,Ze=A&&Ke?u({active:A,collisionRect:Ke,droppableRects:U,droppableContainers:W,pointerCoordinates:Me}):null,St=Hte(Ze,"id"),[Zr,Ee]=(0,Ne.useState)(null),ge=ne?Se:Cy(Se,ue),oe=xAe(ge,(a=Zr==null?void 0:Zr.rect)!=null?a:null,J),me=(0,Ne.useRef)(null),Ce=(0,Ne.useCallback)((yr,Li)=>{let{sensor:Ua,options:io}=Li;if(I.current==null)return;let ao=C.get(I.current);if(!ao)return;let Hs=yr.nativeEvent,fd=new Ua({active:I.current,activeNode:ao,event:Hs,options:io,context:G,onAbort(wo){if(!C.get(wo))return;let{onDragAbort:Tu}=_.current,_m={id:wo};Tu==null||Tu(_m),y({type:"onDragAbort",event:_m})},onPending(wo,gd,Tu,_m){if(!C.get(wo))return;let{onDragPending:eS}=_.current,wg={id:wo,constraint:gd,initialCoordinates:Tu,offset:_m};eS==null||eS(wg),y({type:"onDragPending",event:wg})},onStart(wo){let gd=I.current;if(gd==null)return;let Tu=C.get(gd);if(!Tu)return;let{onDragStart:_m}=_.current,Zk={activatorEvent:Hs,active:{id:gd,data:Tu.data,rect:z}};(0,Dy.unstable_batchedUpdates)(()=>{_m==null||_m(Zk),x(fh.Initializing),h({type:Ko.DragStart,initialCoordinates:wo,active:gd}),y({type:"onDragStart",event:Zk}),E(me.current),$(Hs)})},onMove(wo){h({type:Ko.DragMove,coordinates:wo})},onEnd:jm(Ko.DragEnd),onCancel:jm(Ko.DragCancel)});me.current=fd;function jm(wo){return async function(){let{active:Tu,collisions:_m,over:Zk,scrollAdjustedTranslate:eS}=G.current,wg=null;if(Tu&&eS){let{cancelDrop:tS}=_.current;wg={activatorEvent:Hs,active:Tu,collisions:_m,delta:eS,over:Zk},wo===Ko.DragEnd&&typeof tS=="function"&&await Promise.resolve(tS(wg))&&(wo=Ko.DragCancel)}I.current=null,(0,Dy.unstable_batchedUpdates)(()=>{h({type:wo}),x(fh.Uninitialized),Ee(null),E(null),$(null),me.current=null;let tS=wo===Ko.DragEnd?"onDragEnd":"onDragCancel";if(wg){let vj=_.current[tS];vj==null||vj(wg),y({type:tS,event:wg})}})}}},[C]),et=(0,Ne.useCallback)((yr,Li)=>(Ua,io)=>{let ao=Ua.nativeEvent,Hs=C.get(io);if(I.current!==null||!Hs||ao.dndKit||ao.defaultPrevented)return;let fd={active:Hs};yr(Ua,Li.options,fd)===!0&&(ao.dndKit={capturedBy:Li.sensor},I.current=io,Ce(Ua,Li))},[C,Ce]),lt=qAe(d,et);ZAe(d),Fd(()=>{J&&k===fh.Initializing&&x(fh.Initialized)},[J,k]),(0,Ne.useEffect)(()=>{let{onDragMove:yr}=_.current,{active:Li,activatorEvent:Ua,collisions:io,over:ao}=G.current;if(!Li||!Ua)return;let Hs={active:Li,activatorEvent:Ua,collisions:io,delta:{x:We.x,y:We.y},over:ao};(0,Dy.unstable_batchedUpdates)(()=>{yr==null||yr(Hs),y({type:"onDragMove",event:Hs})})},[We.x,We.y]),(0,Ne.useEffect)(()=>{let{active:yr,activatorEvent:Li,collisions:Ua,droppableContainers:io,scrollAdjustedTranslate:ao}=G.current;if(!yr||I.current==null||!Li||!ao)return;let{onDragOver:Hs}=_.current,fd=io.get(St),jm=fd&&fd.rect.current?{id:fd.id,rect:fd.rect.current,data:fd.data,disabled:fd.disabled}:null,wo={active:yr,activatorEvent:Li,collisions:Ua,delta:{x:ao.x,y:ao.y},over:jm};(0,Dy.unstable_batchedUpdates)(()=>{Ee(jm),Hs==null||Hs(wo),y({type:"onDragOver",event:wo})})},[St]),Fd(()=>{G.current={activatorEvent:T,active:A,activeNode:O,collisionRect:Ke,collisions:Ze,droppableRects:U,draggableNodes:C,draggingNode:re,draggingNodeRect:Z,droppableContainers:P,over:Zr,scrollableAncestors:ie,scrollAdjustedTranslate:We},z.current={initial:Z,translated:Ke}},[A,O,Ze,Ke,C,re,Z,U,P,Zr,ie,We]),$Ae({...q,delta:D,draggingRect:Ke,pointerCoordinates:Me,scrollableAncestors:ie,scrollableAncestorRects:ve});let mt=(0,Ne.useMemo)(()=>({active:A,activeNode:O,activeNodeRect:J,activatorEvent:T,collisions:Ze,containerNodeRect:K,dragOverlay:te,draggableNodes:C,droppableContainers:P,droppableRects:U,over:Zr,measureDroppableContainers:j,scrollableAncestors:ie,scrollableAncestorRects:ve,measuringConfiguration:N,measuringScheduled:R,windowRect:ee}),[A,O,J,T,Ze,K,te,C,P,U,Zr,j,ie,ve,N,R,ee]),cn=(0,Ne.useMemo)(()=>({activatorEvent:T,activators:lt,active:A,activeNodeRect:J,ariaDescribedById:{draggable:B},dispatch:h,draggableNodes:C,over:Zr,measureDroppableContainers:j}),[T,lt,A,J,h,B,C,Zr,j]);return Ne.default.createElement(Ute.Provider,{value:b},Ne.default.createElement(zM.Provider,{value:cn},Ne.default.createElement(tre.Provider,{value:mt},Ne.default.createElement(rre.Provider,{value:oe},c)),Ne.default.createElement(dLe,{disabled:(s==null?void 0:s.restoreFocus)===!1})),Ne.default.createElement(fAe,{...s,hiddenTextDescribedById:B}));function ia(){let yr=(L==null?void 0:L.autoScrollEnabled)===!1,Li=typeof l=="object"?l.enabled===!1:l===!1,Ua=S&&!yr&&!Li;return typeof l=="object"?{...l,enabled:Ua}:{enabled:Ua}}}),fLe=(0,Ne.createContext)(null),Rte="button",gLe="Draggable";hLe="Droppable",vLe={timeout:25}});function ore(e,t,r){let n=e.slice();return n.splice(r<0?n.length+r:r,0,n.splice(t,1)[0]),n}function yLe(e,t){return e.reduce((r,n,i)=>{let a=t.get(n);return a&&(r[i]=a),r},Array(e.length))}function jM(e){return e!==null&&e>=0}function bLe(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function xLe(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}function wLe(e,t,r){let n=e[t],i=e[t-1],a=e[t+1];return!n||!i&&!a?0:r<t?i?n.left-(i.left+i.width):a.left-(n.left+n.width):a?a.left-(n.left+n.width):n.left-(i.left+i.width)}function kLe(e,t,r){let n=e[t],i=e[t-1],a=e[t+1];return n?r<t?i?n.top-(i.top+i.height):a?a.top-(n.top+n.height):0:a?a.top-(n.top+n.height):i?n.top-(i.top+i.height):0:0}function _d(e){let{children:t,id:r,items:n,strategy:i=sre,disabled:a=!1}=e,{active:o,dragOverlay:s,droppableRects:l,over:c,measureDroppableContainers:d}=ire(),u=Ty(lre,r),p=s.rect!==null,m=(0,fo.useMemo)(()=>n.map(S=>typeof S=="object"&&"id"in S?S.id:S),[n]),g=o!=null,f=o?m.indexOf(o.id):-1,v=c?m.indexOf(c.id):-1,h=(0,fo.useRef)(m),y=!bLe(m,h.current),b=v!==-1&&f===-1||y,k=xLe(a);Fd(()=>{y&&g&&d(m)},[y,m,g,d]),(0,fo.useEffect)(()=>{h.current=m},[m]);let x=(0,fo.useMemo)(()=>({activeIndex:f,containerId:u,disabled:k,disableTransforms:b,items:m,overIndex:v,useDragOverlay:p,sortedRects:yLe(m,l),strategy:i}),[f,u,k.draggable,k.droppable,b,m,v,l,p,i]);return fo.default.createElement(cre.Provider,{value:x},t)}function ELe(e){let{disabled:t,index:r,node:n,rect:i}=e,[a,o]=(0,fo.useState)(null),s=(0,fo.useRef)(r);return Fd(()=>{if(!t&&r!==s.current&&n.current){let l=i.current;if(l){let c=My(n.current,{ignoreTransform:!0}),d={x:l.left-c.left,y:l.top-c.top,scaleX:l.width/c.width,scaleY:l.height/c.height};(d.x||d.y)&&o(d)}}r!==s.current&&(s.current=r)},[t,r,n,i]),(0,fo.useEffect)(()=>{a&&o(null)},[a]),a}function Vp(e){let{animateLayoutChanges:t=TLe,attributes:r,disabled:n,data:i,getNewIndex:a=SLe,id:o,strategy:s,resizeObserverConfig:l,transition:c=CLe}=e,{items:d,containerId:u,activeIndex:p,disabled:m,disableTransforms:g,sortedRects:f,overIndex:v,useDragOverlay:h,strategy:y}=(0,fo.useContext)(cre),b=ILe(n,m),k=d.indexOf(o),x=(0,fo.useMemo)(()=>({sortable:{containerId:u,index:k,items:d},...i}),[u,i,k,d]),S=(0,fo.useMemo)(()=>d.slice(d.indexOf(o)),[d,o]),{rect:w,node:C,isOver:D,setNodeRef:P}=are({id:o,data:x,disabled:b.droppable,resizeObserverConfig:{updateMeasurementsFor:S,...l}}),{active:M,activatorEvent:z,activeNodeRect:A,attributes:I,setNodeRef:L,listeners:E,isDragging:T,over:$,setActivatorNodeRef:_,transform:B}=nre({id:o,data:x,attributes:{...DLe,...r},disabled:b.draggable}),W=Tte(P,L),N=!!M,U=N&&!g&&jM(p)&&jM(v),j=!h&&T,R=j&&U?B:null,O=s!=null?s:y,H=U?R!=null?R:O({rects:f,activeNodeRect:A,activeIndex:p,overIndex:v,index:k}):null,q=jM(p)&&jM(v)?a({id:o,items:d,activeIndex:p,overIndex:v}):k,V=M==null?void 0:M.id,J=(0,fo.useRef)({activeId:V,items:d,newIndex:q,containerId:u}),K=d!==J.current.items,G=t({active:M,containerId:u,isDragging:T,isSorting:N,id:o,index:k,items:d,newIndex:J.current.newIndex,previousItems:J.current.items,previousContainerId:J.current.containerId,transition:c,wasDragging:J.current.activeId!=null}),X=ELe({disabled:!G,index:k,node:C,rect:w});return(0,fo.useEffect)(()=>{N&&J.current.newIndex!==q&&(J.current.newIndex=q),u!==J.current.containerId&&(J.current.containerId=u),d!==J.current.items&&(J.current.items=d)},[N,q,u,d]),(0,fo.useEffect)(()=>{if(V===J.current.activeId)return;if(V!=null&&J.current.activeId==null){J.current.activeId=V;return}let re=setTimeout(()=>{J.current.activeId=V},50);return()=>clearTimeout(re)},[V]),{active:M,activeIndex:p,attributes:I,data:x,rect:w,index:k,newIndex:q,items:d,isOver:D,isSorting:N,isDragging:T,listeners:E,node:C,overIndex:v,over:$,setNodeRef:W,setActivatorNodeRef:_,setDroppableNodeRef:P,setDraggableNodeRef:L,transform:X!=null?X:H,transition:te()};function te(){if(X||K&&J.current.newIndex===k)return PLe;if(!(j&&!l1(z)||!c)&&(N||G))return al.Transition.toString({...c,property:dre})}}function ILe(e,t){var r,n;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(r=e==null?void 0:e.draggable)!=null?r:t.draggable,droppable:(n=e==null?void 0:e.droppable)!=null?n:t.droppable}}var fo,_M,WM,sre,BM,gh,lre,cre,SLe,TLe,CLe,dre,PLe,DLe,Dft,h0=F(()=>{fo=Y(Q());Ay();mh();_M={scaleX:1,scaleY:1},WM=e=>{var t;let{rects:r,activeNodeRect:n,activeIndex:i,overIndex:a,index:o}=e,s=(t=r[i])!=null?t:n;if(!s)return null;let l=wLe(r,o,i);if(o===i){let c=r[a];return c?{x:i<a?c.left+c.width-(s.left+s.width):c.left-s.left,y:0,..._M}:null}return o>i&&o<=a?{x:-s.width-l,y:0,..._M}:o<i&&o>=a?{x:s.width+l,y:0,..._M}:{x:0,y:0,..._M}};sre=e=>{let{rects:t,activeIndex:r,overIndex:n,index:i}=e,a=ore(t,n,r),o=t[i],s=a[i];return!s||!o?null:{x:s.left-o.left,y:s.top-o.top,scaleX:s.width/o.width,scaleY:s.height/o.height}},BM={scaleX:1,scaleY:1},gh=e=>{var t;let{activeIndex:r,activeNodeRect:n,index:i,rects:a,overIndex:o}=e,s=(t=a[r])!=null?t:n;if(!s)return null;if(i===r){let c=a[o];return c?{x:0,y:r<o?c.top+c.height-(s.top+s.height):c.top-s.top,...BM}:null}let l=kLe(a,i,r);return i>r&&i<=o?{x:0,y:-s.height-l,...BM}:i<r&&i>=o?{x:0,y:s.height+l,...BM}:{x:0,y:0,...BM}};lre="Sortable",cre=fo.default.createContext({activeIndex:-1,containerId:lre,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:sre,disabled:{draggable:!1,droppable:!1}});SLe=e=>{let{id:t,items:r,activeIndex:n,overIndex:i}=e;return ore(r,n,i).indexOf(t)},TLe=e=>{let{containerId:t,isSorting:r,wasDragging:n,index:i,items:a,newIndex:o,previousItems:s,previousContainerId:l,transition:c}=e;return!c||!n||s!==a&&i===o?!1:r?!0:o!==i&&t===l},CLe={duration:200,easing:"ease"},dre="transform",PLe=al.Transition.toString({property:dre,duration:0,easing:"linear"}),DLe={roleDescription:"sortable"};Dft=[Un.Down,Un.Right,Un.Up,Un.Left]});function ure(){if(document.head.querySelector("#metric-card-skeleton-styles"))return;let e=document.createElement("style");e.id="metric-card-skeleton-styles",e.textContent=MLe,document.head.appendChild(e)}function pre(){var e;(e=document.head.querySelector("#metric-card-skeleton-styles"))==null||e.remove()}var MLe,mre=F(()=>{MLe=`
.metric-card-skeleton {
  background: transparent;
  padding: 14px;
  border-radius: 8px;
  border: 1px solid rgba(var(--background-modifier-border-rgb, 0, 0, 0), 0.08);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04), 0 0 1px rgba(0, 0, 0, 0.08);
  display: flex;
  flex-direction: column;
}

.metric-cards-skeleton {
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  width: 100%;
  gap: 8px;
  padding: 10px 0;
}

/* Responsive */
@media (max-width: 768px) {
  .metric-card-skeleton {
    padding: 12px;
  }

  .metric-cards-skeleton {
    gap: 6px;
  }
}
`});var Ln,ALe,LLe,HW,fre=F(()=>{Ln=Y(Q());qt();o0();wW();by();nr();fc();kte();Ay();h0();mh();Dn();Er();mre();ff();Tr();ALe=({transform:e})=>({...e,y:0}),LLe=({id:e,name:t,value:r,isPositive:n,isEditing:i,onRemove:a,dollarPart:o,centsPart:s,isCurrency:l,tooltip:c,hasWarning:d})=>{let{attributes:u,listeners:p,setNodeRef:m,transform:g,transition:f}=Vp({id:e,disabled:!i}),v={transform:al.Transform.toString(g&&{...g,y:0}),transition:f,position:"relative",height:"100%",flex:"1 1 180px",minWidth:"180px",maxWidth:"300px"};return Ln.default.createElement("div",{ref:m,style:v},Ln.default.createElement("div",{className:"journalit-dashboard-metric-wrapper",style:{position:"relative",cursor:i?"grab":"default",height:"100%",display:"flex",flexDirection:"column"}},Ln.default.createElement("div",{...u,...i?p:{},style:{flex:1,height:"100%"}},Ln.default.createElement(wte,{name:t,value:r,isPositive:n,dollarPart:o,centsPart:s,isCurrency:l,tooltip:c,hasWarning:d})),i&&Ln.default.createElement("button",{className:"journalit-dashboard-widget-remove",onClick:h=>{h.stopPropagation(),h.preventDefault(),a(e)},"aria-label":"Remove metric",style:{zIndex:1e5,position:"absolute",top:"4px",right:"4px",width:"22px",height:"22px",backgroundColor:"var(--background-modifier-error)",color:"white",border:"none",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",cursor:"pointer",padding:0}},"\u2715")))},HW=({filters:e,isEditing:t,onShowMetricSelector:r,hideAddButton:n=!1})=>{let i=Ae(),{currency:a}=ct(),{dashboardData:o,isLoading:s,isStale:l,error:c}=ua(),[d,u]=(0,Ln.useState)([]),[p,m]=(0,Ln.useState)(null);(0,Ln.useLayoutEffect)(()=>(tl(),ure(),()=>{pre()}),[]),(0,Ln.useEffect)(()=>{m(c?c.message||"Failed to load metrics":null)},[c]),(0,Ln.useEffect)(()=>{(()=>{try{if(i){let M=Os(i);u(M.topSection)}}catch(M){console.error("Error initializing metrics:",M),u(["netPnL","winRate","profitFactor","expectancy"])}})()},[i]);let g=(0,Ln.useCallback)(P=>{u([...P.activeMetrics])},[]);Xe("metrics:changed",g);let f=P=>{let{active:M,over:z}=P;if(z&&M.id!==z.id){let A=d.indexOf(M.id.toString()),I=d.indexOf(z.id.toString());if(A!==-1&&I!==-1){let L=[...d];if(L.splice(A,1),L.splice(I,0,M.id.toString()),u(L),i)try{let T={...Os(i),topSection:L};zl(i,"Default",T)}catch(E){console.error("Error saving layout:",E)}}}},v=async P=>{if(i)try{let M=d.filter(I=>I!==P);u([...M]);let A={...Os(i),topSection:[...M]};try{await zl(i,"Default",A)}catch(I){console.error("Error saving layout:",I)}document.querySelectorAll(".journalit-dashboard-widget-remove").forEach(I=>{I.classList.add("jl-force-redraw"),setTimeout(()=>{I.classList.remove("jl-force-redraw")},10)}),xe.publish("metrics:changed",{activeMetrics:M})}catch(M){console.error("Error removing metric:",M)}},h=(P,M,z)=>{if(M==null||isNaN(M))return"N/A";let A=o!=null&&o.metrics.isMultiCurrency&&(o!=null&&o.metrics.conversionBaseCurrency)?o.metrics.conversionBaseCurrency:a;if(z===!0&&o)switch(P){case"netPnL":return o.metrics.netPnLR!==void 0?`${o.metrics.netPnLR>=0?"+":""}${o.metrics.netPnLR.toFixed(1)}R`:"N/A";case"expectancy":return o.metrics.expectancyR!==void 0?`${o.metrics.expectancyR>=0?"+":""}${o.metrics.expectancyR.toFixed(2)}R`:"N/A";case"avgWin":return o.metrics.avgWinR!==void 0?`+${o.metrics.avgWinR.toFixed(2)}R`:"N/A";case"avgLoss":return o.metrics.avgLossR!==void 0?`-${o.metrics.avgLossR.toFixed(2)}R`:"N/A";case"largestWin":return o.metrics.largestWinR!==void 0?`+${o.metrics.largestWinR.toFixed(2)}R`:"N/A";case"largestLoss":return o.metrics.largestLossR!==void 0?`${o.metrics.largestLossR.toFixed(2)}R`:"N/A";case"maxDrawdown":return o.metrics.maxDrawdownR!==void 0?`${Math.abs(o.metrics.maxDrawdownR).toFixed(2)}R`:"N/A";case"bestDay":return o.metrics.bestDayR!==void 0?`${o.metrics.bestDayR>=0?"+":""}${o.metrics.bestDayR.toFixed(2)}R`:"N/A";case"winRate":return`${(M*100).toFixed(1)}%`;case"profitFactor":return M===1/0||M>999?"999+":M.toFixed(2);case"numTrades":case"numWinTrades":case"numLossTrades":return M.toString();case"avgHoldTime":case"avgWinHoldTime":case"avgLossHoldTime":return M===0?"-":xW(M);default:return M.toString()}switch(P){case"netPnL":if(o!=null&&o.metrics.isMultiCurrency){if((o==null?void 0:o.metrics.convertedNetPnL)!==void 0&&(o!=null&&o.metrics.conversionBaseCurrency))return gy(o.metrics.convertedNetPnL,o.metrics.conversionBaseCurrency,!1);if(o!=null&&o.metrics.netPnLByCurrency){let I={byCurrency:o.metrics.netPnLByCurrency,isMultiCurrency:!0,currencies:Object.keys(o.metrics.netPnLByCurrency).sort(),defaultCurrency:o.metrics.primaryCurrency||"USD"},L=lM(I,!0);return Array.isArray(L)?L.join(" | "):L}}return ye(M,!0,A);case"winRate":return`${(M*100).toFixed(1)}%`;case"profitFactor":return M===1/0||M>999?"999+":M.toFixed(2);case"expectancy":return ye(M,!0,A);case"numTrades":case"numWinTrades":case"numLossTrades":return M.toString();case"avgWin":return ye(M,!0,A);case"avgLoss":return ye(M,!0,A);case"largestWin":return ye(M,!0,A);case"largestLoss":return ye(Math.abs(M),!0,A);case"maxDrawdown":return ye(Math.abs(M),!0,A);case"bestDay":return ye(M,!0,A);case"avgHoldTime":case"avgWinHoldTime":case"avgLossHoldTime":return M===0?"-":xW(M);default:return M.toString()}},y=P=>{switch(P){case"netPnL":return"Net P&L";case"winRate":return"Win Rate";case"profitFactor":return"Profit Factor";case"expectancy":return"Expectancy";case"numTrades":return"Total Trades";case"numWinTrades":return"Winning Trades";case"numLossTrades":return"Losing Trades";case"avgWin":return"Avg Win";case"avgLoss":return"Avg Loss";case"maxDrawdown":return"Max Drawdown";case"bestDay":return"Best Day";case"largestWin":return"Largest Win";case"largestLoss":return"Largest Loss";case"avgHoldTime":return"Avg Hold Time";case"avgWinHoldTime":return"Avg Win Hold Time";case"avgLossHoldTime":return"Avg Loss Hold Time";default:return P}},b=(P,M)=>{switch(P){case"netPnL":case"profitFactor":case"expectancy":case"avgWin":return M>0;case"avgLoss":return M<0;case"winRate":return M>.5;case"maxDrawdown":return!1;case"largestLoss":return!1;case"numLossTrades":return!1;case"bestDay":return M>0;case"largestWin":return M>0;case"avgHoldTime":case"avgWinHoldTime":case"numTrades":case"numWinTrades":return;case"avgLossHoldTime":return!1;default:return}},k=P=>["netPnL","expectancy","avgWin","avgLoss","maxDrawdown","bestDay","largestWin","largestLoss"].includes(P),x=["netPnL","expectancy","avgWin","avgLoss","largestWin","largestLoss","maxDrawdown","bestDay","profitFactor"],S=P=>{if(o!=null&&o.metrics.isMultiCurrency&&o!=null&&o.metrics.conversionBaseCurrency&&x.includes(P)){let M=o.metrics.conversionRateDate||"latest",z=o.metrics.conversionBaseCurrency||"USD",A=o.metrics.unconvertedCurrencies||[];return Ln.default.createElement("div",{style:{maxWidth:"250px",fontSize:"12px"}},Ln.default.createElement("div",{style:{fontWeight:600,marginBottom:"4px"}},"Converted to ",z),Ln.default.createElement("div",null,"Using ECB rates (",M,")"),A.length>0&&Ln.default.createElement("div",{style:{marginTop:"4px",color:"var(--text-warning, #f0a020)"}},"\u26A0 ",o.metrics.convertedTradeCount," of ",o.metrics.originalTradeCount," trades (",o.metrics.originalTradeCount-o.metrics.convertedTradeCount," excluded: ",A.join(", "),")"))}},w=P=>{var M,z;return P==="netPnL"&&(o!=null&&o.metrics.isMultiCurrency)?((z=(M=o.metrics.unconvertedCurrencies)==null?void 0:M.length)!=null?z:0)>0:!1},C=(P,M,z)=>{if(k(P)&&!z.includes("R")&&!(z.includes("K")||z.includes("M"))&&!z.includes("|"))return z.includes(".")?z.split(".")[0]:z},D=(P,M,z)=>{if(k(P)&&!z.includes("R")&&!(z.includes("K")||z.includes("M"))&&!z.includes("|"))return z.includes(".")?"."+z.split(".")[1]:".00"};return Ln.default.createElement("div",{className:"journalit-dashboard-top-section",style:{padding:"0",backgroundColor:"transparent"}},t&&!n&&r&&Ln.default.createElement("div",{className:"journalit-dashboard-top-section-header",style:{display:"flex",justifyContent:"flex-end",alignItems:"center",padding:"0 10px"}},Ln.default.createElement("button",{className:"journalit-dashboard-add-metric-button",onClick:r,style:{backgroundColor:"var(--interactive-accent)",color:"var(--text-on-accent)",border:"none",borderRadius:"4px",padding:"4px 8px",fontSize:"12px",cursor:"pointer"}},"Add Metric")),s&&!o?Ln.default.createElement("div",{className:"metric-cards-skeleton"},Array.from({length:4}).map((P,M)=>Ln.default.createElement(NW,{key:M}))):p?Ln.default.createElement("div",{className:"journalit-dashboard-error"},p):o?Ln.default.createElement("div",{style:{position:"relative"}},Ln.default.createElement(jd,{collisionDetection:zd,onDragEnd:f,autoScroll:!0,modifiers:[ALe]},Ln.default.createElement(_d,{items:d,strategy:WM},Ln.default.createElement("div",{className:"journalit-dashboard-metrics",id:"topsection-metrics-container",style:{display:"flex",flexDirection:"row",flexWrap:"wrap",width:"100%",overflowX:"hidden",gap:"8px",padding:"10px 0",position:"relative",backgroundColor:"transparent",borderRadius:"0",minHeight:"auto"}},d.map(P=>{var A,I;let M=o.metrics[P],z=h(P,M,(I=(A=i==null?void 0:i.settings)==null?void 0:A.trade)==null?void 0:I.displayRMultiples);return Ln.default.createElement(LLe,{key:P,id:P,name:y(P),value:z,isPositive:b(P,M),isEditing:t,onRemove:v,dollarPart:C(P,M,z),centsPart:D(P,M,z),isCurrency:k(P),tooltip:S(P),hasWarning:w(P)})})))),(l||s)&&Ln.default.createElement(Io,{message:"Loading...",size:"small",overlay:!0})):Ln.default.createElement("div",{className:"journalit-dashboard-no-data"},"No data available"))}});var gre=F(()=>{fre();mM()});var RM=Fe(($M,hre)=>{(function(e,t){typeof $M=="object"&&typeof hre!="undefined"?t($M):typeof define=="function"&&define.amd?define(["exports"],t):(e=typeof globalThis!="undefined"?globalThis:e||self,t(e["fast-equals"]={}))})($M,(function(e){"use strict";function t(O){return function(q,V,J,K,G,X,te){return O(q,V,te)}}function r(O){return function(q,V,J,K){if(!q||!V||typeof q!="object"||typeof V!="object")return O(q,V,J,K);var G=K.get(q),X=K.get(V);if(G&&X)return G===V&&X===q;K.set(q,V),K.set(V,q);var te=O(q,V,J,K);return K.delete(q),K.delete(V),te}}function n(O,H){var q={};for(var V in O)q[V]=O[V];for(var V in H)q[V]=H[V];return q}function i(O){return O.constructor===Object||O.constructor==null}function a(O){return typeof O.then=="function"}function o(O,H){return O===H||O!==O&&H!==H}var s="[object Arguments]",l="[object Boolean]",c="[object Date]",d="[object RegExp]",u="[object Map]",p="[object Number]",m="[object Object]",g="[object Set]",f="[object String]",v=Object.prototype.toString;function h(O){var H=O.areArraysEqual,q=O.areDatesEqual,V=O.areMapsEqual,J=O.areObjectsEqual,K=O.areRegExpsEqual,G=O.areSetsEqual,X=O.createIsNestedEqual,te=X(re);function re(Z,ne,se){if(Z===ne)return!0;if(!Z||!ne||typeof Z!="object"||typeof ne!="object")return Z!==Z&&ne!==ne;if(i(Z)&&i(ne))return J(Z,ne,te,se);var ee=Array.isArray(Z),ie=Array.isArray(ne);if(ee||ie)return ee===ie&&H(Z,ne,te,se);var ve=v.call(Z);return ve!==v.call(ne)?!1:ve===c?q(Z,ne,te,se):ve===d?K(Z,ne,te,se):ve===u?V(Z,ne,te,se):ve===g?G(Z,ne,te,se):ve===m||ve===s?a(Z)||a(ne)?!1:J(Z,ne,te,se):ve===l||ve===p||ve===f?o(Z.valueOf(),ne.valueOf()):!1}return re}function y(O,H,q,V){var J=O.length;if(H.length!==J)return!1;for(;J-- >0;)if(!q(O[J],H[J],J,J,O,H,V))return!1;return!0}var b=r(y);function k(O,H){return o(O.valueOf(),H.valueOf())}function x(O,H,q,V){var J=O.size===H.size;if(!J)return!1;if(!O.size)return!0;var K={},G=0;return O.forEach(function(X,te){if(J){var re=!1,Z=0;H.forEach(function(ne,se){!re&&!K[Z]&&(re=q(te,se,G,Z,O,H,V)&&q(X,ne,te,se,O,H,V))&&(K[Z]=!0),Z++}),G++,J=re}}),J}var S=r(x),w="_owner",C=Object.prototype.hasOwnProperty;function D(O,H,q,V){var J=Object.keys(O),K=J.length;if(Object.keys(H).length!==K)return!1;for(var G;K-- >0;){if(G=J[K],G===w){var X=!!O.$$typeof,te=!!H.$$typeof;if((X||te)&&X!==te)return!1}if(!C.call(H,G)||!q(O[G],H[G],G,G,O,H,V))return!1}return!0}var P=r(D);function M(O,H){return O.source===H.source&&O.flags===H.flags}function z(O,H,q,V){var J=O.size===H.size;if(!J)return!1;if(!O.size)return!0;var K={};return O.forEach(function(G,X){if(J){var te=!1,re=0;H.forEach(function(Z,ne){!te&&!K[re]&&(te=q(G,Z,X,ne,O,H,V))&&(K[re]=!0),re++}),J=te}}),J}var A=r(z),I=Object.freeze({areArraysEqual:y,areDatesEqual:k,areMapsEqual:x,areObjectsEqual:D,areRegExpsEqual:M,areSetsEqual:z,createIsNestedEqual:t}),L=Object.freeze({areArraysEqual:b,areDatesEqual:k,areMapsEqual:S,areObjectsEqual:P,areRegExpsEqual:M,areSetsEqual:A,createIsNestedEqual:t}),E=h(I);function T(O,H){return E(O,H,void 0)}var $=h(n(I,{createIsNestedEqual:function(){return o}}));function _(O,H){return $(O,H,void 0)}var B=h(L);function W(O,H){return B(O,H,new WeakMap)}var N=h(n(L,{createIsNestedEqual:function(){return o}}));function U(O,H){return N(O,H,new WeakMap)}function j(O){return h(n(I,O(I)))}function R(O){var H=h(n(L,O(L)));return(function(q,V,J){return J===void 0&&(J=new WeakMap),H(q,V,J)})}e.circularDeepEqual=W,e.circularShallowEqual=U,e.createCustomCircularEqual=R,e.createCustomEqual=j,e.deepEqual=T,e.sameValueZeroEqual=o,e.shallowEqual=_,Object.defineProperty(e,"__esModule",{value:!0})}))});var UM=Fe((egt,qW)=>{function yre(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(r=yre(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function vre(){for(var e,t,r=0,n="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=yre(e))&&(n&&(n+=" "),n+=t);return n}qW.exports=vre,qW.exports.clsx=vre});var xre=Fe((tgt,bre)=>{bre.exports=function(t,r,n){return t===r?!0:t.className===r.className&&n(t.style,r.style)&&t.width===r.width&&t.autoSize===r.autoSize&&t.cols===r.cols&&t.draggableCancel===r.draggableCancel&&t.draggableHandle===r.draggableHandle&&n(t.verticalCompact,r.verticalCompact)&&n(t.compactType,r.compactType)&&n(t.layout,r.layout)&&n(t.margin,r.margin)&&n(t.containerPadding,r.containerPadding)&&t.rowHeight===r.rowHeight&&t.maxRows===r.maxRows&&t.isBounded===r.isBounded&&t.isDraggable===r.isDraggable&&t.isResizable===r.isResizable&&t.allowOverlap===r.allowOverlap&&t.preventCollision===r.preventCollision&&t.useCSSTransforms===r.useCSSTransforms&&t.transformScale===r.transformScale&&t.isDroppable===r.isDroppable&&n(t.resizeHandles,r.resizeHandles)&&n(t.resizeHandle,r.resizeHandle)&&t.onLayoutChange===r.onLayoutChange&&t.onDragStart===r.onDragStart&&t.onDrag===r.onDrag&&t.onDragStop===r.onDragStop&&t.onResizeStart===r.onResizeStart&&t.onResize===r.onResize&&t.onResizeStop===r.onResizeStop&&t.onDrop===r.onDrop&&n(t.droppingItem,r.droppingItem)&&n(t.innerRef,r.innerRef)}});var Fy=Fe(Nn=>{"use strict";Object.defineProperty(Nn,"__esModule",{value:!0});Nn.bottom=YW;Nn.childrenEqual=jLe;Nn.cloneLayout=kre;Nn.cloneLayoutItem=Ny;Nn.collides=qM;Nn.compact=Tre;Nn.compactItem=Cre;Nn.compactType=JLe;Nn.correctBounds=Pre;Nn.fastPositionEqual=_Le;Nn.fastRGLPropsEqual=void 0;Nn.getAllCollisions=Dre;Nn.getFirstCollision=Ly;Nn.getLayoutItem=KW;Nn.getStatics=JW;Nn.modifyLayout=Sre;Nn.moveElement=f1;Nn.moveElementAwayFromCollision=GW;Nn.noop=void 0;Nn.perc=WLe;Nn.resizeItemInDirection=VLe;Nn.setTopLeft=YLe;Nn.setTransform=GLe;Nn.sortLayoutItems=r4;Nn.sortLayoutItemsByColRow=Lre;Nn.sortLayoutItemsByRowCol=Are;Nn.synchronizeLayoutWithChildren=KLe;Nn.validateLayout=Nre;Nn.withLayoutItem=zLe;var wre=RM(),m1=NLe(Q());function NLe(e){return e&&e.__esModule?e:{default:e}}var FLe=!0,OLe=!1;function YW(e){let t=0,r;for(let n=0,i=e.length;n<i;n++)r=e[n].y+e[n].h,r>t&&(t=r);return t}function kre(e){let t=Array(e.length);for(let r=0,n=e.length;r<n;r++)t[r]=Ny(e[r]);return t}function Sre(e,t){let r=Array(e.length);for(let n=0,i=e.length;n<i;n++)t.i===e[n].i?r[n]=t:r[n]=e[n];return r}function zLe(e,t,r){let n=KW(e,t);return n?(n=r(Ny(n)),e=Sre(e,n),[e,n]):[e,null]}function Ny(e){return{w:e.w,h:e.h,x:e.x,y:e.y,i:e.i,minW:e.minW,maxW:e.maxW,minH:e.minH,maxH:e.maxH,moved:!!e.moved,static:!!e.static,isDraggable:e.isDraggable,isResizable:e.isResizable,resizeHandles:e.resizeHandles,isBounded:e.isBounded}}function jLe(e,t){return(0,wre.deepEqual)(m1.default.Children.map(e,r=>r==null?void 0:r.key),m1.default.Children.map(t,r=>r==null?void 0:r.key))&&(0,wre.deepEqual)(m1.default.Children.map(e,r=>r==null?void 0:r.props["data-grid"]),m1.default.Children.map(t,r=>r==null?void 0:r.props["data-grid"]))}var rgt=Nn.fastRGLPropsEqual=xre();function _Le(e,t){return e.left===t.left&&e.top===t.top&&e.width===t.width&&e.height===t.height}function qM(e,t){return!(e.i===t.i||e.x+e.w<=t.x||e.x>=t.x+t.w||e.y+e.h<=t.y||e.y>=t.y+t.h)}function Tre(e,t,r,n){let i=JW(e),a=r4(e,t),o=Array(e.length);for(let s=0,l=a.length;s<l;s++){let c=Ny(a[s]);c.static||(c=Cre(i,c,t,r,a,n),i.push(c)),o[e.indexOf(a[s])]=c,c.moved=!1}return o}var BLe={x:"w",y:"h"};function VW(e,t,r,n){let i=BLe[n];t[n]+=1;let a=e.map(o=>o.i).indexOf(t.i);for(let o=a+1;o<e.length;o++){let s=e[o];if(!s.static){if(s.y>t.y+t.h)break;qM(t,s)&&VW(e,s,r+t[i],n)}}t[n]=r}function Cre(e,t,r,n,i,a){let o=r==="vertical",s=r==="horizontal";if(o)for(t.y=Math.min(YW(e),t.y);t.y>0&&!Ly(e,t);)t.y--;else if(s)for(;t.x>0&&!Ly(e,t);)t.x--;let l;for(;(l=Ly(e,t))&&!(r===null&&a);)if(s?VW(i,t,l.x+l.w,"x"):VW(i,t,l.y+l.h,"y"),s&&t.x+t.w>n)for(t.x=n-t.w,t.y++;t.x>0&&!Ly(e,t);)t.x--;return t.y=Math.max(t.y,0),t.x=Math.max(t.x,0),t}function Pre(e,t){let r=JW(e);for(let n=0,i=e.length;n<i;n++){let a=e[n];if(a.x+a.w>t.cols&&(a.x=t.cols-a.w),a.x<0&&(a.x=0,a.w=t.cols),!a.static)r.push(a);else for(;Ly(r,a);)a.y++}return e}function KW(e,t){for(let r=0,n=e.length;r<n;r++)if(e[r].i===t)return e[r]}function Ly(e,t){for(let r=0,n=e.length;r<n;r++)if(qM(e[r],t))return e[r]}function Dre(e,t){return e.filter(r=>qM(r,t))}function JW(e){return e.filter(t=>t.static)}function f1(e,t,r,n,i,a,o,s,l){if(t.static&&t.isDraggable!==!0||t.y===n&&t.x===r)return e;HM(`Moving element ${t.i} to [${String(r)},${String(n)}] from [${t.x},${t.y}]`);let c=t.x,d=t.y;typeof r=="number"&&(t.x=r),typeof n=="number"&&(t.y=n),t.moved=!0;let u=r4(e,o);(o==="vertical"&&typeof n=="number"?d>=n:o==="horizontal"&&typeof r=="number"&&c>=r)&&(u=u.reverse());let m=Dre(u,t),g=m.length>0;if(g&&l)return kre(e);if(g&&a)return HM(`Collision prevented on ${t.i}, reverting.`),t.x=c,t.y=d,t.moved=!1,e;for(let f=0,v=m.length;f<v;f++){let h=m[f];HM(`Resolving collision between ${t.i} at [${t.x},${t.y}] and ${h.i} at [${h.x},${h.y}]`),!h.moved&&(h.static?e=GW(e,h,t,i,o,s):e=GW(e,t,h,i,o,s))}return e}function GW(e,t,r,n,i,a){let o=i==="horizontal",s=i==="vertical",l=t.static;if(n){n=!1;let u={x:o?Math.max(t.x-r.w,0):r.x,y:s?Math.max(t.y-r.h,0):r.y,w:r.w,h:r.h,i:"-1"},p=Ly(e,u),m=p&&p.y+p.h>t.y,g=p&&t.x+t.w>p.x;if(p){if(m&&s)return f1(e,r,void 0,t.y+1,n,l,i,a);if(m&&i==null)return t.y=r.y,r.y=r.y+r.h,e;if(g&&o)return f1(e,t,r.x,void 0,n,l,i,a)}else return HM(`Doing reverse collision on ${r.i} up to [${u.x},${u.y}].`),f1(e,r,o?u.x:void 0,s?u.y:void 0,n,l,i,a)}let c=o?r.x+1:void 0,d=s?r.y+1:void 0;return c==null&&d==null?e:f1(e,r,o?r.x+1:void 0,s?r.y+1:void 0,n,l,i,a)}function WLe(e){return e*100+"%"}var Ere=(e,t,r,n)=>e+r>n?t:r,Ire=(e,t,r)=>e<0?t:r,Mre=e=>Math.max(0,e),QW=e=>Math.max(0,e),XW=(e,t,r)=>{let{left:n,height:i,width:a}=t,o=e.top-(i-e.height);return{left:n,width:a,height:Ire(o,e.height,i),top:QW(o)}},ZW=(e,t,r)=>{let{top:n,left:i,height:a,width:o}=t;return{top:n,height:a,width:Ere(e.left,e.width,o,r),left:Mre(i)}},e4=(e,t,r)=>{let{top:n,height:i,width:a}=t,o=e.left-(a-e.width);return{height:i,width:o<0?e.width:Ere(e.left,e.width,a,r),top:QW(n),left:Mre(o)}},t4=(e,t,r)=>{let{top:n,left:i,height:a,width:o}=t;return{width:o,left:i,height:Ire(n,e.height,a),top:QW(n)}},$Le=function(){return XW(arguments.length<=0?void 0:arguments[0],ZW(...arguments),arguments.length<=2?void 0:arguments[2])},RLe=function(){return XW(arguments.length<=0?void 0:arguments[0],e4(...arguments),arguments.length<=2?void 0:arguments[2])},ULe=function(){return t4(arguments.length<=0?void 0:arguments[0],ZW(...arguments),arguments.length<=2?void 0:arguments[2])},HLe=function(){return t4(arguments.length<=0?void 0:arguments[0],e4(...arguments),arguments.length<=2?void 0:arguments[2])},qLe={n:XW,ne:$Le,e:ZW,se:ULe,s:t4,sw:HLe,w:e4,nw:RLe};function VLe(e,t,r,n){let i=qLe[e];return i?i(t,{...t,...r},n):r}function GLe(e){let{top:t,left:r,width:n,height:i}=e,a=`translate(${r}px,${t}px)`;return{transform:a,WebkitTransform:a,MozTransform:a,msTransform:a,OTransform:a,width:`${n}px`,height:`${i}px`,position:"absolute"}}function YLe(e){let{top:t,left:r,width:n,height:i}=e;return{top:`${t}px`,left:`${r}px`,width:`${n}px`,height:`${i}px`,position:"absolute"}}function r4(e,t){return t==="horizontal"?Lre(e):t==="vertical"?Are(e):e}function Are(e){return e.slice(0).sort(function(t,r){return t.y>r.y||t.y===r.y&&t.x>r.x?1:t.y===r.y&&t.x===r.x?0:-1})}function Lre(e){return e.slice(0).sort(function(t,r){return t.x>r.x||t.x===r.x&&t.y>r.y?1:-1})}function KLe(e,t,r,n,i){e=e||[];let a=[];m1.default.Children.forEach(t,s=>{if((s==null?void 0:s.key)==null)return;let l=KW(e,String(s.key)),c=s.props["data-grid"];l&&c==null?a.push(Ny(l)):c?(FLe||Nre([c],"ReactGridLayout.children"),a.push(Ny({...c,i:s.key}))):a.push(Ny({w:1,h:1,x:0,y:YW(a),i:String(s.key)}))});let o=Pre(a,{cols:r});return i?o:Tre(o,n,r)}function Nre(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Layout",r=["x","y","w","h"];if(!Array.isArray(e))throw new Error(t+" must be an array!");for(let n=0,i=e.length;n<i;n++){let a=e[n];for(let o=0;o<r.length;o++){let s=r[o],l=a[s];if(typeof l!="number"||Number.isNaN(l))throw new Error(`ReactGridLayout: ${t}[${n}].${s} must be a number! Received: ${l} (${typeof l})`)}if(typeof a.i!="undefined"&&typeof a.i!="string")throw new Error(`ReactGridLayout: ${t}[${n}].i must be a string! Received: ${a.i} (${typeof a.i})`)}}function JLe(e){let{verticalCompact:t,compactType:r}=e||{};return t===!1?null:r}function HM(){OLe&&console.log(...arguments)}var QLe=()=>{};Nn.noop=QLe});var GM=Fe(hh=>{"use strict";Object.defineProperty(hh,"__esModule",{value:!0});hh.calcGridColWidth=VM;hh.calcGridItemPosition=XLe;hh.calcGridItemWHPx=n4;hh.calcWH=eNe;hh.calcXY=ZLe;hh.clamp=Oy;function VM(e){let{margin:t,containerPadding:r,containerWidth:n,cols:i}=e;return(n-t[0]*(i-1)-r[0]*2)/i}function n4(e,t,r){return Number.isFinite(e)?Math.round(t*e+Math.max(0,e-1)*r):e}function XLe(e,t,r,n,i,a){let{margin:o,containerPadding:s,rowHeight:l}=e,c=VM(e),d={};return a&&a.resizing?(d.width=Math.round(a.resizing.width),d.height=Math.round(a.resizing.height)):(d.width=n4(n,c,o[0]),d.height=n4(i,l,o[1])),a&&a.dragging?(d.top=Math.round(a.dragging.top),d.left=Math.round(a.dragging.left)):a&&a.resizing&&typeof a.resizing.top=="number"&&typeof a.resizing.left=="number"?(d.top=Math.round(a.resizing.top),d.left=Math.round(a.resizing.left)):(d.top=Math.round((l+o[1])*r+s[1]),d.left=Math.round((c+o[0])*t+s[0])),d}function ZLe(e,t,r,n,i){let{margin:a,containerPadding:o,cols:s,rowHeight:l,maxRows:c}=e,d=VM(e),u=Math.round((r-o[0])/(d+a[0])),p=Math.round((t-o[1])/(l+a[1]));return u=Oy(u,0,s-n),p=Oy(p,0,c-i),{x:u,y:p}}function eNe(e,t,r,n,i,a){let{margin:o,maxRows:s,cols:l,rowHeight:c}=e,d=VM(e),u=Math.round((t+o[0])/(d+o[0])),p=Math.round((r+o[1])/(c+o[1])),m=Oy(u,0,l-n),g=Oy(p,0,s-i);return["sw","w","nw"].indexOf(a)!==-1&&(m=Oy(u,0,l)),["nw","n","ne"].indexOf(a)!==-1&&(g=Oy(p,0,s)),{w:m,h:g}}function Oy(e,t,r){return Math.max(Math.min(e,r),t)}});var Ore=Fe((agt,Fre)=>{"use strict";var tNe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";Fre.exports=tNe});var Bre=Fe((ogt,_re)=>{"use strict";var rNe=Ore();function zre(){}function jre(){}jre.resetWarningCache=zre;_re.exports=function(){function e(n,i,a,o,s,l){if(l!==rNe){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:jre,resetWarningCache:zre};return r.PropTypes=r,r}});var wf=Fe((cgt,Wre)=>{Wre.exports=Bre()();var sgt,lgt});var Ure=Fe((dgt,i4)=>{function Rre(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(r=Rre(e[t]))&&(n&&(n+=" "),n+=r);else for(t in e)e[t]&&(n&&(n+=" "),n+=t);return n}function $re(){for(var e,t,r=0,n="";r<arguments.length;)(e=arguments[r++])&&(t=Rre(e))&&(n&&(n+=" "),n+=t);return n}i4.exports=$re,i4.exports.clsx=$re});var g1=Fe(zy=>{"use strict";Object.defineProperty(zy,"__esModule",{value:!0});zy.dontSetMe=sNe;zy.findInArray=nNe;zy.int=oNe;zy.isFunction=iNe;zy.isNum=aNe;function nNe(e,t){for(let r=0,n=e.length;r<n;r++)if(t.apply(t,[e[r],r,e]))return e[r]}function iNe(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Function]"}function aNe(e){return typeof e=="number"&&!isNaN(e)}function oNe(e){return parseInt(e,10)}function sNe(e,t,r){if(e[t])return new Error("Invalid prop ".concat(t," passed to ").concat(r," - do not set this, set it on the child."))}});var Vre=Fe(jy=>{"use strict";Object.defineProperty(jy,"__esModule",{value:!0});jy.browserPrefixToKey=qre;jy.browserPrefixToStyle=lNe;jy.default=void 0;jy.getPrefix=Hre;var a4=["Moz","Webkit","O","ms"];function Hre(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window=="undefined")return"";let r=(e=window.document)===null||e===void 0||(e=e.documentElement)===null||e===void 0?void 0:e.style;if(!r||t in r)return"";for(let n=0;n<a4.length;n++)if(qre(t,a4[n])in r)return a4[n];return""}function qre(e,t){return t?"".concat(t).concat(cNe(e)):e}function lNe(e,t){return t?"-".concat(t.toLowerCase(),"-").concat(e):e}function cNe(e){let t="",r=!0;for(let n=0;n<e.length;n++)r?(t+=e[n].toUpperCase(),r=!1):e[n]==="-"?r=!0:t+=e[n];return t}var pgt=jy.default=Hre()});var KM=Fe(Mo=>{"use strict";Object.defineProperty(Mo,"__esModule",{value:!0});Mo.addClassName=Jre;Mo.addEvent=pNe;Mo.addUserSelectStyles=SNe;Mo.createCSSTransform=bNe;Mo.createSVGTransform=xNe;Mo.getTouch=wNe;Mo.getTouchIdentifier=kNe;Mo.getTranslation=o4;Mo.innerHeight=hNe;Mo.innerWidth=vNe;Mo.matchesSelector=Kre;Mo.matchesSelectorAndParentsTo=uNe;Mo.offsetXYFromParent=yNe;Mo.outerHeight=fNe;Mo.outerWidth=gNe;Mo.removeClassName=Qre;Mo.removeEvent=mNe;Mo.removeUserSelectStyles=TNe;var Yc=g1(),Gre=dNe(Vre());function Yre(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(Yre=function(n){return n?r:t})(e)}function dNe(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var r=Yre(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(a!=="default"&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}var YM="";function Kre(e,t){return YM||(YM=(0,Yc.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(r){return(0,Yc.isFunction)(e[r])})),(0,Yc.isFunction)(e[YM])?e[YM](t):!1}function uNe(e,t,r){let n=e;do{if(Kre(n,t))return!0;if(n===r)return!1;n=n.parentNode}while(n);return!1}function pNe(e,t,r,n){if(!e)return;let i={capture:!0,...n};e.addEventListener?e.addEventListener(t,r,i):e.attachEvent?e.attachEvent("on"+t,r):e["on"+t]=r}function mNe(e,t,r,n){if(!e)return;let i={capture:!0,...n};e.removeEventListener?e.removeEventListener(t,r,i):e.detachEvent?e.detachEvent("on"+t,r):e["on"+t]=null}function fNe(e){let t=e.clientHeight,r=e.ownerDocument.defaultView.getComputedStyle(e);return t+=(0,Yc.int)(r.borderTopWidth),t+=(0,Yc.int)(r.borderBottomWidth),t}function gNe(e){let t=e.clientWidth,r=e.ownerDocument.defaultView.getComputedStyle(e);return t+=(0,Yc.int)(r.borderLeftWidth),t+=(0,Yc.int)(r.borderRightWidth),t}function hNe(e){let t=e.clientHeight,r=e.ownerDocument.defaultView.getComputedStyle(e);return t-=(0,Yc.int)(r.paddingTop),t-=(0,Yc.int)(r.paddingBottom),t}function vNe(e){let t=e.clientWidth,r=e.ownerDocument.defaultView.getComputedStyle(e);return t-=(0,Yc.int)(r.paddingLeft),t-=(0,Yc.int)(r.paddingRight),t}function yNe(e,t,r){let i=t===t.ownerDocument.body?{left:0,top:0}:t.getBoundingClientRect(),a=(e.clientX+t.scrollLeft-i.left)/r,o=(e.clientY+t.scrollTop-i.top)/r;return{x:a,y:o}}function bNe(e,t){let r=o4(e,t,"px");return{[(0,Gre.browserPrefixToKey)("transform",Gre.default)]:r}}function xNe(e,t){return o4(e,t,"")}function o4(e,t,r){let{x:n,y:i}=e,a="translate(".concat(n).concat(r,",").concat(i).concat(r,")");if(t){let o="".concat(typeof t.x=="string"?t.x:t.x+r),s="".concat(typeof t.y=="string"?t.y:t.y+r);a="translate(".concat(o,", ").concat(s,")")+a}return a}function wNe(e,t){return e.targetTouches&&(0,Yc.findInArray)(e.targetTouches,r=>t===r.identifier)||e.changedTouches&&(0,Yc.findInArray)(e.changedTouches,r=>t===r.identifier)}function kNe(e){if(e.targetTouches&&e.targetTouches[0])return e.targetTouches[0].identifier;if(e.changedTouches&&e.changedTouches[0])return e.changedTouches[0].identifier}function SNe(e){if(!e)return;let t=e.getElementById("react-draggable-style-el");t||(t=e.createElement("style"),t.type="text/css",t.id="react-draggable-style-el",t.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,t.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,e.getElementsByTagName("head")[0].appendChild(t)),e.body&&Jre(e.body,"react-draggable-transparent-selection")}function TNe(e){if(e)try{if(e.body&&Qre(e.body,"react-draggable-transparent-selection"),e.selection)e.selection.empty();else{let t=(e.defaultView||window).getSelection();t&&t.type!=="Caret"&&t.removeAllRanges()}}catch(t){}}function Jre(e,t){e.classList?e.classList.add(t):e.className.match(new RegExp("(?:^|\\s)".concat(t,"(?!\\S)")))||(e.className+=" ".concat(t))}function Qre(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(?:^|\\s)".concat(t,"(?!\\S)"),"g"),"")}});var l4=Fe(kf=>{"use strict";Object.defineProperty(kf,"__esModule",{value:!0});kf.canDragX=DNe;kf.canDragY=ENe;kf.createCoreData=MNe;kf.createDraggableData=ANe;kf.getBoundPosition=CNe;kf.getControlPosition=INe;kf.snapToGrid=PNe;var Kc=g1(),v0=KM();function CNe(e,t,r){if(!e.props.bounds)return[t,r];let{bounds:n}=e.props;n=typeof n=="string"?n:LNe(n);let i=s4(e);if(typeof n=="string"){let{ownerDocument:a}=i,o=a.defaultView,s;if(n==="parent"?s=i.parentNode:s=a.querySelector(n),!(s instanceof o.HTMLElement))throw new Error('Bounds selector "'+n+'" could not find an element.');let l=s,c=o.getComputedStyle(i),d=o.getComputedStyle(l);n={left:-i.offsetLeft+(0,Kc.int)(d.paddingLeft)+(0,Kc.int)(c.marginLeft),top:-i.offsetTop+(0,Kc.int)(d.paddingTop)+(0,Kc.int)(c.marginTop),right:(0,v0.innerWidth)(l)-(0,v0.outerWidth)(i)-i.offsetLeft+(0,Kc.int)(d.paddingRight)-(0,Kc.int)(c.marginRight),bottom:(0,v0.innerHeight)(l)-(0,v0.outerHeight)(i)-i.offsetTop+(0,Kc.int)(d.paddingBottom)-(0,Kc.int)(c.marginBottom)}}return(0,Kc.isNum)(n.right)&&(t=Math.min(t,n.right)),(0,Kc.isNum)(n.bottom)&&(r=Math.min(r,n.bottom)),(0,Kc.isNum)(n.left)&&(t=Math.max(t,n.left)),(0,Kc.isNum)(n.top)&&(r=Math.max(r,n.top)),[t,r]}function PNe(e,t,r){let n=Math.round(t/e[0])*e[0],i=Math.round(r/e[1])*e[1];return[n,i]}function DNe(e){return e.props.axis==="both"||e.props.axis==="x"}function ENe(e){return e.props.axis==="both"||e.props.axis==="y"}function INe(e,t,r){let n=typeof t=="number"?(0,v0.getTouch)(e,t):null;if(typeof t=="number"&&!n)return null;let i=s4(r),a=r.props.offsetParent||i.offsetParent||i.ownerDocument.body;return(0,v0.offsetXYFromParent)(n||e,a,r.props.scale)}function MNe(e,t,r){let n=!(0,Kc.isNum)(e.lastX),i=s4(e);return n?{node:i,deltaX:0,deltaY:0,lastX:t,lastY:r,x:t,y:r}:{node:i,deltaX:t-e.lastX,deltaY:r-e.lastY,lastX:e.lastX,lastY:e.lastY,x:t,y:r}}function ANe(e,t){let r=e.props.scale;return{node:t.node,x:e.state.x+t.deltaX/r,y:e.state.y+t.deltaY/r,deltaX:t.deltaX/r,deltaY:t.deltaY/r,lastX:e.state.x,lastY:e.state.y}}function LNe(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}}function s4(e){let t=e.findDOMNode();if(!t)throw new Error("<DraggableCore>: Unmounted during event!");return t}});var d4=Fe(c4=>{"use strict";Object.defineProperty(c4,"__esModule",{value:!0});c4.default=NNe;function NNe(){}});var Zre=Fe(JM=>{"use strict";Object.defineProperty(JM,"__esModule",{value:!0});JM.default=void 0;var u4=ONe(Q()),hc=m4(wf()),FNe=m4(Td()),ol=KM(),vh=l4(),p4=g1(),h1=m4(d4());function m4(e){return e&&e.__esModule?e:{default:e}}function Xre(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(Xre=function(n){return n?r:t})(e)}function ONe(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var r=Xre(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(a!=="default"&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}function Wl(e,t,r){return t=zNe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zNe(e){var t=jNe(e,"string");return typeof t=="symbol"?t:String(t)}function jNe(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Uu={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}},yh=Uu.mouse,y0=class extends u4.Component{constructor(){super(...arguments),Wl(this,"dragging",!1),Wl(this,"lastX",NaN),Wl(this,"lastY",NaN),Wl(this,"touchIdentifier",null),Wl(this,"mounted",!1),Wl(this,"handleDragStart",t=>{if(this.props.onMouseDown(t),!this.props.allowAnyClick&&typeof t.button=="number"&&t.button!==0)return!1;let r=this.findDOMNode();if(!r||!r.ownerDocument||!r.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");let{ownerDocument:n}=r;if(this.props.disabled||!(t.target instanceof n.defaultView.Node)||this.props.handle&&!(0,ol.matchesSelectorAndParentsTo)(t.target,this.props.handle,r)||this.props.cancel&&(0,ol.matchesSelectorAndParentsTo)(t.target,this.props.cancel,r))return;t.type==="touchstart"&&t.preventDefault();let i=(0,ol.getTouchIdentifier)(t);this.touchIdentifier=i;let a=(0,vh.getControlPosition)(t,i,this);if(a==null)return;let{x:o,y:s}=a,l=(0,vh.createCoreData)(this,o,s);(0,h1.default)("DraggableCore: handleDragStart: %j",l),(0,h1.default)("calling",this.props.onStart),!(this.props.onStart(t,l)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,ol.addUserSelectStyles)(n),this.dragging=!0,this.lastX=o,this.lastY=s,(0,ol.addEvent)(n,yh.move,this.handleDrag),(0,ol.addEvent)(n,yh.stop,this.handleDragStop))}),Wl(this,"handleDrag",t=>{let r=(0,vh.getControlPosition)(t,this.touchIdentifier,this);if(r==null)return;let{x:n,y:i}=r;if(Array.isArray(this.props.grid)){let s=n-this.lastX,l=i-this.lastY;if([s,l]=(0,vh.snapToGrid)(this.props.grid,s,l),!s&&!l)return;n=this.lastX+s,i=this.lastY+l}let a=(0,vh.createCoreData)(this,n,i);if((0,h1.default)("DraggableCore: handleDrag: %j",a),this.props.onDrag(t,a)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch(s){let l=document.createEvent("MouseEvents");l.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(l)}return}this.lastX=n,this.lastY=i}),Wl(this,"handleDragStop",t=>{if(!this.dragging)return;let r=(0,vh.getControlPosition)(t,this.touchIdentifier,this);if(r==null)return;let{x:n,y:i}=r;if(Array.isArray(this.props.grid)){let l=n-this.lastX||0,c=i-this.lastY||0;[l,c]=(0,vh.snapToGrid)(this.props.grid,l,c),n=this.lastX+l,i=this.lastY+c}let a=(0,vh.createCoreData)(this,n,i);if(this.props.onStop(t,a)===!1||this.mounted===!1)return!1;let s=this.findDOMNode();s&&this.props.enableUserSelectHack&&(0,ol.removeUserSelectStyles)(s.ownerDocument),(0,h1.default)("DraggableCore: handleDragStop: %j",a),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,s&&((0,h1.default)("DraggableCore: Removing handlers"),(0,ol.removeEvent)(s.ownerDocument,yh.move,this.handleDrag),(0,ol.removeEvent)(s.ownerDocument,yh.stop,this.handleDragStop))}),Wl(this,"onMouseDown",t=>(yh=Uu.mouse,this.handleDragStart(t))),Wl(this,"onMouseUp",t=>(yh=Uu.mouse,this.handleDragStop(t))),Wl(this,"onTouchStart",t=>(yh=Uu.touch,this.handleDragStart(t))),Wl(this,"onTouchEnd",t=>(yh=Uu.touch,this.handleDragStop(t)))}componentDidMount(){this.mounted=!0;let t=this.findDOMNode();t&&(0,ol.addEvent)(t,Uu.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;let t=this.findDOMNode();if(t){let{ownerDocument:r}=t;(0,ol.removeEvent)(r,Uu.mouse.move,this.handleDrag),(0,ol.removeEvent)(r,Uu.touch.move,this.handleDrag),(0,ol.removeEvent)(r,Uu.mouse.stop,this.handleDragStop),(0,ol.removeEvent)(r,Uu.touch.stop,this.handleDragStop),(0,ol.removeEvent)(t,Uu.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,ol.removeUserSelectStyles)(r)}}findDOMNode(){var t,r;return(t=this.props)!==null&&t!==void 0&&t.nodeRef?(r=this.props)===null||r===void 0||(r=r.nodeRef)===null||r===void 0?void 0:r.current:FNe.default.findDOMNode(this)}render(){return u4.cloneElement(u4.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};JM.default=y0;Wl(y0,"displayName","DraggableCore");Wl(y0,"propTypes",{allowAnyClick:hc.default.bool,children:hc.default.node.isRequired,disabled:hc.default.bool,enableUserSelectHack:hc.default.bool,offsetParent:function(e,t){if(e[t]&&e[t].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:hc.default.arrayOf(hc.default.number),handle:hc.default.string,cancel:hc.default.string,nodeRef:hc.default.object,onStart:hc.default.func,onDrag:hc.default.func,onStop:hc.default.func,onMouseDown:hc.default.func,scale:hc.default.number,className:p4.dontSetMe,style:p4.dontSetMe,transform:p4.dontSetMe});Wl(y0,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1})});var rne=Fe(y1=>{"use strict";Object.defineProperty(y1,"__esModule",{value:!0});Object.defineProperty(y1,"DraggableCore",{enumerable:!0,get:function(){return ZM.default}});y1.default=void 0;var QM=WNe(Q()),ta=v1(wf()),_Ne=v1(Td()),BNe=v1(Ure()),ene=KM(),b0=l4(),f4=g1(),ZM=v1(Zre()),XM=v1(d4());function v1(e){return e&&e.__esModule?e:{default:e}}function tne(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(tne=function(n){return n?r:t})(e)}function WNe(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var r=tne(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(a!=="default"&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}function g4(){return g4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},g4.apply(this,arguments)}function x0(e,t,r){return t=$Ne(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $Ne(e){var t=RNe(e,"string");return typeof t=="symbol"?t:String(t)}function RNe(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var w0=class extends QM.Component{static getDerivedStateFromProps(t,r){let{position:n}=t,{prevPropsPosition:i}=r;return n&&(!i||n.x!==i.x||n.y!==i.y)?((0,XM.default)("Draggable: getDerivedStateFromProps %j",{position:n,prevPropsPosition:i}),{x:n.x,y:n.y,prevPropsPosition:{...n}}):null}constructor(t){super(t),x0(this,"onDragStart",(r,n)=>{if((0,XM.default)("Draggable: onDragStart: %j",n),this.props.onStart(r,(0,b0.createDraggableData)(this,n))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),x0(this,"onDrag",(r,n)=>{if(!this.state.dragging)return!1;(0,XM.default)("Draggable: onDrag: %j",n);let i=(0,b0.createDraggableData)(this,n),a={x:i.x,y:i.y,slackX:0,slackY:0};if(this.props.bounds){let{x:s,y:l}=a;a.x+=this.state.slackX,a.y+=this.state.slackY;let[c,d]=(0,b0.getBoundPosition)(this,a.x,a.y);a.x=c,a.y=d,a.slackX=this.state.slackX+(s-a.x),a.slackY=this.state.slackY+(l-a.y),i.x=a.x,i.y=a.y,i.deltaX=a.x-this.state.x,i.deltaY=a.y-this.state.y}if(this.props.onDrag(r,i)===!1)return!1;this.setState(a)}),x0(this,"onDragStop",(r,n)=>{if(!this.state.dragging||this.props.onStop(r,(0,b0.createDraggableData)(this,n))===!1)return!1;(0,XM.default)("Draggable: onDragStop: %j",n);let a={dragging:!1,slackX:0,slackY:0};if(!!this.props.position){let{x:s,y:l}=this.props.position;a.x=s,a.y=l}this.setState(a)}),this.state={dragging:!1,dragged:!1,x:t.position?t.position.x:t.defaultPosition.x,y:t.position?t.position.y:t.defaultPosition.y,prevPropsPosition:{...t.position},slackX:0,slackY:0,isElementSVG:!1},t.position&&!(t.onDrag||t.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){typeof window.SVGElement!="undefined"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.setState({dragging:!1})}findDOMNode(){var t,r;return(t=(r=this.props)===null||r===void 0||(r=r.nodeRef)===null||r===void 0?void 0:r.current)!==null&&t!==void 0?t:_Ne.default.findDOMNode(this)}render(){let{axis:t,bounds:r,children:n,defaultPosition:i,defaultClassName:a,defaultClassNameDragging:o,defaultClassNameDragged:s,position:l,positionOffset:c,scale:d,...u}=this.props,p={},m=null,f=!!!l||this.state.dragging,v=l||i,h={x:(0,b0.canDragX)(this)&&f?this.state.x:v.x,y:(0,b0.canDragY)(this)&&f?this.state.y:v.y};this.state.isElementSVG?m=(0,ene.createSVGTransform)(h,c):p=(0,ene.createCSSTransform)(h,c);let y=(0,BNe.default)(n.props.className||"",a,{[o]:this.state.dragging,[s]:this.state.dragged});return QM.createElement(ZM.default,g4({},u,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),QM.cloneElement(QM.Children.only(n),{className:y,style:{...n.props.style,...p},transform:m}))}};y1.default=w0;x0(w0,"displayName","Draggable");x0(w0,"propTypes",{...ZM.default.propTypes,axis:ta.default.oneOf(["both","x","y","none"]),bounds:ta.default.oneOfType([ta.default.shape({left:ta.default.number,right:ta.default.number,top:ta.default.number,bottom:ta.default.number}),ta.default.string,ta.default.oneOf([!1])]),defaultClassName:ta.default.string,defaultClassNameDragging:ta.default.string,defaultClassNameDragged:ta.default.string,defaultPosition:ta.default.shape({x:ta.default.number,y:ta.default.number}),positionOffset:ta.default.shape({x:ta.default.oneOfType([ta.default.number,ta.default.string]),y:ta.default.oneOfType([ta.default.number,ta.default.string])}),position:ta.default.shape({x:ta.default.number,y:ta.default.number}),className:f4.dontSetMe,style:f4.dontSetMe,transform:f4.dontSetMe});x0(w0,"defaultProps",{...ZM.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})});var tA=Fe((bgt,eA)=>{"use strict";var{default:nne,DraggableCore:UNe}=rne();eA.exports=nne;eA.exports.default=nne;eA.exports.DraggableCore=UNe});var one=Fe(h4=>{"use strict";h4.__esModule=!0;h4.cloneElement=KNe;var HNe=qNe(Q());function qNe(e){return e&&e.__esModule?e:{default:e}}function ine(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ane(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ine(Object(r),!0).forEach(function(n){VNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ine(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VNe(e,t,r){return t=GNe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GNe(e){var t=YNe(e,"string");return typeof t=="symbol"?t:String(t)}function YNe(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function KNe(e,t){return t.style&&e.props.style&&(t.style=ane(ane({},e.props.style),t.style)),t.className&&e.props.className&&(t.className=e.props.className+" "+t.className),HNe.default.cloneElement(e,t)}});var v4=Fe(rA=>{"use strict";rA.__esModule=!0;rA.resizableProps=void 0;var Fr=JNe(wf()),wgt=tA();function JNe(e){return e&&e.__esModule?e:{default:e}}var QNe={axis:Fr.default.oneOf(["both","x","y","none"]),className:Fr.default.string,children:Fr.default.element.isRequired,draggableOpts:Fr.default.shape({allowAnyClick:Fr.default.bool,cancel:Fr.default.string,children:Fr.default.node,disabled:Fr.default.bool,enableUserSelectHack:Fr.default.bool,offsetParent:Fr.default.node,grid:Fr.default.arrayOf(Fr.default.number),handle:Fr.default.string,nodeRef:Fr.default.object,onStart:Fr.default.func,onDrag:Fr.default.func,onStop:Fr.default.func,onMouseDown:Fr.default.func,scale:Fr.default.number}),height:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r[0];if(i.axis==="both"||i.axis==="y"){var a;return(a=Fr.default.number).isRequired.apply(a,r)}return Fr.default.number.apply(Fr.default,r)},handle:Fr.default.oneOfType([Fr.default.node,Fr.default.func]),handleSize:Fr.default.arrayOf(Fr.default.number),lockAspectRatio:Fr.default.bool,maxConstraints:Fr.default.arrayOf(Fr.default.number),minConstraints:Fr.default.arrayOf(Fr.default.number),onResizeStop:Fr.default.func,onResizeStart:Fr.default.func,onResize:Fr.default.func,resizeHandles:Fr.default.arrayOf(Fr.default.oneOf(["s","w","e","n","sw","nw","se","ne"])),transformScale:Fr.default.number,width:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r[0];if(i.axis==="both"||i.axis==="x"){var a;return(a=Fr.default.number).isRequired.apply(a,r)}return Fr.default.number.apply(Fr.default,r)}};rA.resizableProps=QNe});var k4=Fe(nA=>{"use strict";nA.__esModule=!0;nA.default=void 0;var b1=r2e(Q()),XNe=tA(),ZNe=one(),e2e=v4(),t2e=["children","className","draggableOpts","width","height","handle","handleSize","lockAspectRatio","axis","minConstraints","maxConstraints","onResize","onResizeStop","onResizeStart","resizeHandles","transformScale"];function lne(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(lne=function(i){return i?r:t})(e)}function r2e(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var r=lne(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(a!=="default"&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}function b4(){return b4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},b4.apply(this,arguments)}function n2e(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function sne(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function y4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sne(Object(r),!0).forEach(function(n){i2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sne(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function i2e(e,t,r){return t=a2e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a2e(e){var t=o2e(e,"string");return typeof t=="symbol"?t:String(t)}function o2e(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function s2e(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,x4(e,t)}function x4(e,t){return x4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},x4(e,t)}var w4=(function(e){s2e(t,e);function t(){for(var n,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=e.call.apply(e,[this].concat(a))||this,n.handleRefs={},n.lastHandleRect=null,n.slack=null,n}var r=t.prototype;return r.componentWillUnmount=function(){this.resetData()},r.resetData=function(){this.lastHandleRect=this.slack=null},r.runConstraints=function(i,a){var o=this.props,s=o.minConstraints,l=o.maxConstraints,c=o.lockAspectRatio;if(!s&&!l&&!c)return[i,a];if(c){var d=this.props.width/this.props.height,u=i-this.props.width,p=a-this.props.height;Math.abs(u)>Math.abs(p*d)?a=i/d:i=a*d}var m=i,g=a,f=this.slack||[0,0],v=f[0],h=f[1];return i+=v,a+=h,s&&(i=Math.max(s[0],i),a=Math.max(s[1],a)),l&&(i=Math.min(l[0],i),a=Math.min(l[1],a)),this.slack=[v+(m-i),h+(g-a)],[i,a]},r.resizeHandler=function(i,a){var o=this;return function(s,l){var c=l.node,d=l.deltaX,u=l.deltaY;i==="onResizeStart"&&o.resetData();var p=(o.props.axis==="both"||o.props.axis==="x")&&a!=="n"&&a!=="s",m=(o.props.axis==="both"||o.props.axis==="y")&&a!=="e"&&a!=="w";if(!(!p&&!m)){var g=a[0],f=a[a.length-1],v=c.getBoundingClientRect();if(o.lastHandleRect!=null){if(f==="w"){var h=v.left-o.lastHandleRect.left;d+=h}if(g==="n"){var y=v.top-o.lastHandleRect.top;u+=y}}o.lastHandleRect=v,f==="w"&&(d=-d),g==="n"&&(u=-u);var b=o.props.width+(p?d/o.props.transformScale:0),k=o.props.height+(m?u/o.props.transformScale:0),x=o.runConstraints(b,k);b=x[0],k=x[1];var S=b!==o.props.width||k!==o.props.height,w=typeof o.props[i]=="function"?o.props[i]:null,C=i==="onResize"&&!S;w&&!C&&(s.persist==null||s.persist(),w(s,{node:c,size:{width:b,height:k},handle:a})),i==="onResizeStop"&&o.resetData()}}},r.renderResizeHandle=function(i,a){var o=this.props.handle;if(!o)return b1.createElement("span",{className:"react-resizable-handle react-resizable-handle-"+i,ref:a});if(typeof o=="function")return o(i,a);var s=typeof o.type=="string",l=y4({ref:a},s?{}:{handleAxis:i});return b1.cloneElement(o,l)},r.render=function(){var i=this,a=this.props,o=a.children,s=a.className,l=a.draggableOpts,c=a.width,d=a.height,u=a.handle,p=a.handleSize,m=a.lockAspectRatio,g=a.axis,f=a.minConstraints,v=a.maxConstraints,h=a.onResize,y=a.onResizeStop,b=a.onResizeStart,k=a.resizeHandles,x=a.transformScale,S=n2e(a,t2e);return(0,ZNe.cloneElement)(o,y4(y4({},S),{},{className:(s?s+" ":"")+"react-resizable",children:[].concat(o.props.children,k.map(function(w){var C,D=(C=i.handleRefs[w])!=null?C:i.handleRefs[w]=b1.createRef();return b1.createElement(XNe.DraggableCore,b4({},l,{nodeRef:D,key:"resizableHandle-"+w,onStop:i.resizeHandler("onResizeStop",w),onStart:i.resizeHandler("onResizeStart",w),onDrag:i.resizeHandler("onResize",w)}),i.renderResizeHandle(w,D))}))}))},t})(b1.Component);nA.default=w4;w4.propTypes=e2e.resizableProps;w4.defaultProps={axis:"both",handleSize:[20,20],lockAspectRatio:!1,minConstraints:[20,20],maxConstraints:[1/0,1/0],resizeHandles:["se"],transformScale:1}});var mne=Fe(aA=>{"use strict";aA.__esModule=!0;aA.default=void 0;var S4=p2e(Q()),l2e=dne(wf()),c2e=dne(k4()),d2e=v4(),u2e=["handle","handleSize","onResize","onResizeStart","onResizeStop","draggableOpts","minConstraints","maxConstraints","lockAspectRatio","axis","width","height","resizeHandles","style","transformScale"];function dne(e){return e&&e.__esModule?e:{default:e}}function une(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(une=function(i){return i?r:t})(e)}function p2e(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var r=une(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(a!=="default"&&Object.prototype.hasOwnProperty.call(e,a)){var o=i?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(n,a,o):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}function T4(){return T4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},T4.apply(this,arguments)}function cne(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function iA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cne(Object(r),!0).forEach(function(n){m2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cne(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function m2e(e,t,r){return t=f2e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f2e(e){var t=g2e(e,"string");return typeof t=="symbol"?t:String(t)}function g2e(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function h2e(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,a;for(a=0;a<n.length;a++)i=n[a],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function v2e(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,C4(e,t)}function C4(e,t){return C4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},C4(e,t)}var pne=(function(e){v2e(t,e);function t(){for(var n,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return n=e.call.apply(e,[this].concat(a))||this,n.state={width:n.props.width,height:n.props.height,propsWidth:n.props.width,propsHeight:n.props.height},n.onResize=function(s,l){var c=l.size;n.props.onResize?(s.persist==null||s.persist(),n.setState(c,function(){return n.props.onResize&&n.props.onResize(s,l)})):n.setState(c)},n}t.getDerivedStateFromProps=function(i,a){return a.propsWidth!==i.width||a.propsHeight!==i.height?{width:i.width,height:i.height,propsWidth:i.width,propsHeight:i.height}:null};var r=t.prototype;return r.render=function(){var i=this.props,a=i.handle,o=i.handleSize,s=i.onResize,l=i.onResizeStart,c=i.onResizeStop,d=i.draggableOpts,u=i.minConstraints,p=i.maxConstraints,m=i.lockAspectRatio,g=i.axis,f=i.width,v=i.height,h=i.resizeHandles,y=i.style,b=i.transformScale,k=h2e(i,u2e);return S4.createElement(c2e.default,{axis:g,draggableOpts:d,handle:a,handleSize:o,height:this.state.height,lockAspectRatio:m,maxConstraints:p,minConstraints:u,onResizeStart:l,onResize:this.onResize,onResizeStop:c,resizeHandles:h,transformScale:b,width:this.state.width},S4.createElement("div",T4({},k,{style:iA(iA({},y),{},{width:this.state.width+"px",height:this.state.height+"px"})})))},t})(S4.Component);aA.default=pne;pne.propTypes=iA(iA({},d2e.resizableProps),{},{children:l2e.default.element})});var fne=Fe((Cgt,oA)=>{"use strict";oA.exports=function(){throw new Error("Don't instantiate Resizable directly! Use require('react-resizable').Resizable")};oA.exports.Resizable=k4().default;oA.exports.ResizableBox=mne().default});var P4=Fe(bh=>{"use strict";Object.defineProperty(bh,"__esModule",{value:!0});bh.resizeHandleType=bh.resizeHandleAxesType=bh.default=void 0;var Rr=gne(wf()),y2e=gne(Q());function gne(e){return e&&e.__esModule?e:{default:e}}var b2e=bh.resizeHandleAxesType=Rr.default.arrayOf(Rr.default.oneOf(["s","w","e","n","sw","nw","se","ne"])),x2e=bh.resizeHandleType=Rr.default.oneOfType([Rr.default.node,Rr.default.func]),Pgt=bh.default={className:Rr.default.string,style:Rr.default.object,width:Rr.default.number,autoSize:Rr.default.bool,cols:Rr.default.number,draggableCancel:Rr.default.string,draggableHandle:Rr.default.string,verticalCompact:function(e){e.verticalCompact},compactType:Rr.default.oneOf(["vertical","horizontal"]),layout:function(e){var t=e.layout;t!==void 0&&Fy().validateLayout(t,"layout")},margin:Rr.default.arrayOf(Rr.default.number),containerPadding:Rr.default.arrayOf(Rr.default.number),rowHeight:Rr.default.number,maxRows:Rr.default.number,isBounded:Rr.default.bool,isDraggable:Rr.default.bool,isResizable:Rr.default.bool,allowOverlap:Rr.default.bool,preventCollision:Rr.default.bool,useCSSTransforms:Rr.default.bool,transformScale:Rr.default.number,isDroppable:Rr.default.bool,resizeHandles:b2e,resizeHandle:x2e,onLayoutChange:Rr.default.func,onDragStart:Rr.default.func,onDrag:Rr.default.func,onDragStop:Rr.default.func,onResizeStart:Rr.default.func,onResize:Rr.default.func,onResizeStop:Rr.default.func,onDrop:Rr.default.func,droppingItem:Rr.default.shape({i:Rr.default.string.isRequired,w:Rr.default.number.isRequired,h:Rr.default.number.isRequired}),children:function(e,t){let r=e[t],n={};y2e.default.Children.forEach(r,function(i){if((i==null?void 0:i.key)!=null){if(n[i.key])throw new Error('Duplicate child key "'+i.key+'" found! This will cause problems in ReactGridLayout.');n[i.key]=!0}})},innerRef:Rr.default.any}});var yne=Fe(sA=>{"use strict";Object.defineProperty(sA,"__esModule",{value:!0});sA.default=void 0;var k0=D4(Q()),hne=Td(),Xn=D4(wf()),w2e=tA(),k2e=fne(),S0=Fy(),zs=GM(),vne=P4(),S2e=D4(UM());function D4(e){return e&&e.__esModule?e:{default:e}}function Gp(e,t,r){return(t=T2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function T2e(e){var t=C2e(e,"string");return typeof t=="symbol"?t:t+""}function C2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var x1=class extends k0.default.Component{constructor(){super(...arguments),Gp(this,"state",{resizing:null,dragging:null,className:""}),Gp(this,"elementRef",k0.default.createRef()),Gp(this,"onDragStart",(t,r)=>{let{node:n}=r,{onDragStart:i,transformScale:a}=this.props;if(!i)return;let o={top:0,left:0},{offsetParent:s}=n;if(!s)return;let l=s.getBoundingClientRect(),c=n.getBoundingClientRect(),d=c.left/a,u=l.left/a,p=c.top/a,m=l.top/a;o.left=d-u+s.scrollLeft,o.top=p-m+s.scrollTop,this.setState({dragging:o});let{x:g,y:f}=(0,zs.calcXY)(this.getPositionParams(),o.top,o.left,this.props.w,this.props.h);return i.call(this,this.props.i,g,f,{e:t,node:n,newPosition:o})}),Gp(this,"onDrag",(t,r,n)=>{let{node:i,deltaX:a,deltaY:o}=r,{onDrag:s}=this.props;if(!s)return;if(!this.state.dragging)throw new Error("onDrag called before onDragStart.");let l=this.state.dragging.top+o,c=this.state.dragging.left+a,{isBounded:d,i:u,w:p,h:m,containerWidth:g}=this.props,f=this.getPositionParams();if(d){let{offsetParent:b}=i;if(b){let{margin:k,rowHeight:x}=this.props,S=b.clientHeight-(0,zs.calcGridItemWHPx)(m,x,k[1]);l=(0,zs.clamp)(l,0,S);let w=(0,zs.calcGridColWidth)(f),C=g-(0,zs.calcGridItemWHPx)(p,w,k[0]);c=(0,zs.clamp)(c,0,C)}}let v={top:l,left:c};n?this.setState({dragging:v}):(0,hne.flushSync)(()=>{this.setState({dragging:v})});let{x:h,y}=(0,zs.calcXY)(f,l,c,p,m);return s.call(this,u,h,y,{e:t,node:i,newPosition:v})}),Gp(this,"onDragStop",(t,r)=>{let{node:n}=r,{onDragStop:i}=this.props;if(!i)return;if(!this.state.dragging)throw new Error("onDragEnd called before onDragStart.");let{w:a,h:o,i:s}=this.props,{left:l,top:c}=this.state.dragging,d={top:c,left:l};this.setState({dragging:null});let{x:u,y:p}=(0,zs.calcXY)(this.getPositionParams(),c,l,a,o);return i.call(this,s,u,p,{e:t,node:n,newPosition:d})}),Gp(this,"onResizeStop",(t,r,n)=>this.onResizeHandler(t,r,n,"onResizeStop")),Gp(this,"onResizeStart",(t,r,n)=>this.onResizeHandler(t,r,n,"onResizeStart")),Gp(this,"onResize",(t,r,n)=>this.onResizeHandler(t,r,n,"onResize"))}shouldComponentUpdate(t,r){if(this.props.children!==t.children||this.props.droppingPosition!==t.droppingPosition)return!0;let n=(0,zs.calcGridItemPosition)(this.getPositionParams(this.props),this.props.x,this.props.y,this.props.w,this.props.h,this.state),i=(0,zs.calcGridItemPosition)(this.getPositionParams(t),t.x,t.y,t.w,t.h,r);return!(0,S0.fastPositionEqual)(n,i)||this.props.useCSSTransforms!==t.useCSSTransforms}componentDidMount(){this.moveDroppingItem({})}componentDidUpdate(t){this.moveDroppingItem(t)}moveDroppingItem(t){let{droppingPosition:r}=this.props;if(!r)return;let n=this.elementRef.current;if(!n)return;let i=t.droppingPosition||{left:0,top:0},{dragging:a}=this.state,o=a&&r.left!==i.left||r.top!==i.top;if(!a)this.onDragStart(r.e,{node:n,deltaX:r.left,deltaY:r.top});else if(o){let s=r.left-a.left,l=r.top-a.top;this.onDrag(r.e,{node:n,deltaX:s,deltaY:l},!0)}}getPositionParams(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props;return{cols:t.cols,containerPadding:t.containerPadding,containerWidth:t.containerWidth,margin:t.margin,maxRows:t.maxRows,rowHeight:t.rowHeight}}createStyle(t){let{usePercentages:r,containerWidth:n,useCSSTransforms:i}=this.props,a;return i?a=(0,S0.setTransform)(t):(a=(0,S0.setTopLeft)(t),r&&(a.left=(0,S0.perc)(t.left/n),a.width=(0,S0.perc)(t.width/n))),a}mixinDraggable(t,r){return k0.default.createElement(w2e.DraggableCore,{disabled:!r,onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop,handle:this.props.handle,cancel:".react-resizable-handle"+(this.props.cancel?","+this.props.cancel:""),scale:this.props.transformScale,nodeRef:this.elementRef},t)}curryResizeHandler(t,r){return(n,i)=>r(n,i,t)}mixinResizable(t,r,n){let{cols:i,minW:a,minH:o,maxW:s,maxH:l,transformScale:c,resizeHandles:d,resizeHandle:u}=this.props,p=this.getPositionParams(),m=(0,zs.calcGridItemPosition)(p,0,0,i,0).width,g=(0,zs.calcGridItemPosition)(p,0,0,a,o),f=(0,zs.calcGridItemPosition)(p,0,0,s,l),v=[g.width,g.height],h=[Math.min(f.width,m),Math.min(f.height,1/0)];return k0.default.createElement(k2e.Resizable,{draggableOpts:{disabled:!n},className:n?void 0:"react-resizable-hide",width:r.width,height:r.height,minConstraints:v,maxConstraints:h,onResizeStop:this.curryResizeHandler(r,this.onResizeStop),onResizeStart:this.curryResizeHandler(r,this.onResizeStart),onResize:this.curryResizeHandler(r,this.onResize),transformScale:c,resizeHandles:d,handle:u},t)}onResizeHandler(t,r,n,i){let{node:a,size:o,handle:s}=r,l=this.props[i];if(!l)return;let{x:c,y:d,i:u,maxH:p,minH:m,containerWidth:g}=this.props,{minW:f,maxW:v}=this.props,h=o;a&&(h=(0,S0.resizeItemInDirection)(s,n,o,g),(0,hne.flushSync)(()=>{this.setState({resizing:i==="onResizeStop"?null:h})}));let{w:y,h:b}=(0,zs.calcWH)(this.getPositionParams(),h.width,h.height,c,d,s);y=(0,zs.clamp)(y,Math.max(f,1),v),b=(0,zs.clamp)(b,m,p),l.call(this,u,y,b,{e:t,node:a,size:h,handle:s})}render(){let{x:t,y:r,w:n,h:i,isDraggable:a,isResizable:o,droppingPosition:s,useCSSTransforms:l}=this.props,c=(0,zs.calcGridItemPosition)(this.getPositionParams(),t,r,n,i,this.state),d=k0.default.Children.only(this.props.children),u=k0.default.cloneElement(d,{ref:this.elementRef,className:(0,S2e.default)("react-grid-item",d.props.className,this.props.className,{static:this.props.static,resizing:!!this.state.resizing,"react-draggable":a,"react-draggable-dragging":!!this.state.dragging,dropping:!!s,cssTransforms:l}),style:{...this.props.style,...d.props.style,...this.createStyle(c)}});return u=this.mixinResizable(u,c,o),u=this.mixinDraggable(u,a),u}};sA.default=x1;Gp(x1,"propTypes",{children:Xn.default.element,cols:Xn.default.number.isRequired,containerWidth:Xn.default.number.isRequired,rowHeight:Xn.default.number.isRequired,margin:Xn.default.array.isRequired,maxRows:Xn.default.number.isRequired,containerPadding:Xn.default.array.isRequired,x:Xn.default.number.isRequired,y:Xn.default.number.isRequired,w:Xn.default.number.isRequired,h:Xn.default.number.isRequired,minW:function(e,t){let r=e[t];if(typeof r!="number")return new Error("minWidth not Number");if(r>e.w||r>e.maxW)return new Error("minWidth larger than item width/maxWidth")},maxW:function(e,t){let r=e[t];if(typeof r!="number")return new Error("maxWidth not Number");if(r<e.w||r<e.minW)return new Error("maxWidth smaller than item width/minWidth")},minH:function(e,t){let r=e[t];if(typeof r!="number")return new Error("minHeight not Number");if(r>e.h||r>e.maxH)return new Error("minHeight larger than item height/maxHeight")},maxH:function(e,t){let r=e[t];if(typeof r!="number")return new Error("maxHeight not Number");if(r<e.h||r<e.minH)return new Error("maxHeight smaller than item height/minHeight")},i:Xn.default.string.isRequired,resizeHandles:vne.resizeHandleAxesType,resizeHandle:vne.resizeHandleType,onDragStop:Xn.default.func,onDragStart:Xn.default.func,onDrag:Xn.default.func,onResizeStop:Xn.default.func,onResizeStart:Xn.default.func,onResize:Xn.default.func,isDraggable:Xn.default.bool.isRequired,isResizable:Xn.default.bool.isRequired,isBounded:Xn.default.bool.isRequired,static:Xn.default.bool,useCSSTransforms:Xn.default.bool.isRequired,transformScale:Xn.default.number,className:Xn.default.string,handle:Xn.default.string,cancel:Xn.default.string,droppingPosition:Xn.default.shape({e:Xn.default.object.isRequired,left:Xn.default.number.isRequired,top:Xn.default.number.isRequired})});Gp(x1,"defaultProps",{className:"",cancel:"",handle:"",minH:1,minW:1,maxH:1/0,maxW:1/0,transformScale:1})});var M4=Fe(lA=>{"use strict";Object.defineProperty(lA,"__esModule",{value:!0});lA.default=void 0;var _y=wne(Q()),E4=RM(),P2e=I4(UM()),xr=Fy(),D2e=GM(),bne=I4(yne()),E2e=I4(P4());function I4(e){return e&&e.__esModule?e:{default:e}}function wne(e,t){if(typeof WeakMap=="function")var r=new WeakMap,n=new WeakMap;return(wne=function(i,a){if(!a&&i&&i.__esModule)return i;var o,s,l={__proto__:null,default:i};if(i===null||typeof i!="object"&&typeof i!="function")return l;if(o=a?n:r){if(o.has(i))return o.get(i);o.set(i,l)}for(let c in i)c!=="default"&&{}.hasOwnProperty.call(i,c)&&((s=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(i,c))&&(s.get||s.set)?o(l,c,s):l[c]=i[c]);return l})(e,t)}function sl(e,t,r){return(t=I2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function I2e(e){var t=M2e(e,"string");return typeof t=="symbol"?t:t+""}function M2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xne="react-grid-layout",kne=!1;try{kne=/firefox/i.test(navigator.userAgent)}catch(e){}var T0=class extends _y.Component{constructor(){super(...arguments),sl(this,"state",{activeDrag:null,layout:(0,xr.synchronizeLayoutWithChildren)(this.props.layout,this.props.children,this.props.cols,(0,xr.compactType)(this.props),this.props.allowOverlap),mounted:!1,oldDragItem:null,oldLayout:null,oldResizeItem:null,resizing:!1,droppingDOMNode:null,children:[]}),sl(this,"dragEnterCounter",0),sl(this,"onDragStart",(t,r,n,i)=>{let{e:a,node:o}=i,{layout:s}=this.state,l=(0,xr.getLayoutItem)(s,t);if(!l)return;let c={w:l.w,h:l.h,x:l.x,y:l.y,placeholder:!0,i:t};return this.setState({oldDragItem:(0,xr.cloneLayoutItem)(l),oldLayout:s,activeDrag:c}),this.props.onDragStart(s,l,l,null,a,o)}),sl(this,"onDrag",(t,r,n,i)=>{let{e:a,node:o}=i,{oldDragItem:s}=this.state,{layout:l}=this.state,{cols:c,allowOverlap:d,preventCollision:u}=this.props,p=(0,xr.getLayoutItem)(l,t);if(!p)return;let m={w:p.w,h:p.h,x:p.x,y:p.y,placeholder:!0,i:t};l=(0,xr.moveElement)(l,p,r,n,!0,u,(0,xr.compactType)(this.props),c,d),this.props.onDrag(l,s,p,m,a,o),this.setState({layout:d?l:(0,xr.compact)(l,(0,xr.compactType)(this.props),c),activeDrag:m})}),sl(this,"onDragStop",(t,r,n,i)=>{let{e:a,node:o}=i;if(!this.state.activeDrag)return;let{oldDragItem:s}=this.state,{layout:l}=this.state,{cols:c,preventCollision:d,allowOverlap:u}=this.props,p=(0,xr.getLayoutItem)(l,t);if(!p)return;l=(0,xr.moveElement)(l,p,r,n,!0,d,(0,xr.compactType)(this.props),c,u);let g=u?l:(0,xr.compact)(l,(0,xr.compactType)(this.props),c);this.props.onDragStop(g,s,p,null,a,o);let{oldLayout:f}=this.state;this.setState({activeDrag:null,layout:g,oldDragItem:null,oldLayout:null}),this.onLayoutMaybeChanged(g,f)}),sl(this,"onResizeStart",(t,r,n,i)=>{let{e:a,node:o}=i,{layout:s}=this.state,l=(0,xr.getLayoutItem)(s,t);l&&(this.setState({oldResizeItem:(0,xr.cloneLayoutItem)(l),oldLayout:this.state.layout,resizing:!0}),this.props.onResizeStart(s,l,l,null,a,o))}),sl(this,"onResize",(t,r,n,i)=>{let{e:a,node:o,size:s,handle:l}=i,{oldResizeItem:c}=this.state,{layout:d}=this.state,{cols:u,preventCollision:p,allowOverlap:m}=this.props,g=!1,f,v,h,[y,b]=(0,xr.withLayoutItem)(d,t,x=>{let S;return v=x.x,h=x.y,["sw","w","nw","n","ne"].indexOf(l)!==-1&&(["sw","nw","w"].indexOf(l)!==-1&&(v=x.x+(x.w-r),r=x.x!==v&&v<0?x.w:r,v=v<0?0:v),["ne","n","nw"].indexOf(l)!==-1&&(h=x.y+(x.h-n),n=x.y!==h&&h<0?x.h:n,h=h<0?0:h),g=!0),p&&!m&&(S=(0,xr.getAllCollisions)(d,{...x,w:r,h:n,x:v,y:h}).filter(C=>C.i!==x.i).length>0,S&&(h=x.y,n=x.h,v=x.x,r=x.w,g=!1)),x.w=r,x.h=n,x});if(!b)return;f=y,g&&(f=(0,xr.moveElement)(y,b,v,h,!0,this.props.preventCollision,(0,xr.compactType)(this.props),u,m));let k={w:b.w,h:b.h,x:b.x,y:b.y,static:!0,i:t};this.props.onResize(f,c,b,k,a,o),this.setState({layout:m?f:(0,xr.compact)(f,(0,xr.compactType)(this.props),u),activeDrag:k})}),sl(this,"onResizeStop",(t,r,n,i)=>{let{e:a,node:o}=i,{layout:s,oldResizeItem:l}=this.state,{cols:c,allowOverlap:d}=this.props,u=(0,xr.getLayoutItem)(s,t),p=d?s:(0,xr.compact)(s,(0,xr.compactType)(this.props),c);this.props.onResizeStop(p,l,u,null,a,o);let{oldLayout:m}=this.state;this.setState({activeDrag:null,layout:p,oldResizeItem:null,oldLayout:null,resizing:!1}),this.onLayoutMaybeChanged(p,m)}),sl(this,"onDragOver",t=>{var y;if(t.preventDefault(),t.stopPropagation(),kne&&!((y=t.nativeEvent.target)!=null&&y.classList.contains(xne)))return!1;let{droppingItem:r,onDropDragOver:n,margin:i,cols:a,rowHeight:o,maxRows:s,width:l,containerPadding:c,transformScale:d}=this.props,u=n==null?void 0:n(t);if(u===!1)return this.state.droppingDOMNode&&this.removeDroppingPlaceholder(),!1;let p={...r,...u},{layout:m}=this.state,g=t.currentTarget.getBoundingClientRect(),f=t.clientX-g.left,v=t.clientY-g.top,h={left:f/d,top:v/d,e:t};if(this.state.droppingDOMNode){if(this.state.droppingPosition){let{left:b,top:k}=this.state.droppingPosition;(b!=f||k!=v)&&this.setState({droppingPosition:h})}}else{let b={cols:a,margin:i,maxRows:s,rowHeight:o,containerWidth:l,containerPadding:c||i},k=(0,D2e.calcXY)(b,v,f,p.w,p.h);this.setState({droppingDOMNode:_y.createElement("div",{key:p.i}),droppingPosition:h,layout:[...m,{...p,x:k.x,y:k.y,static:!1,isDraggable:!0}]})}}),sl(this,"removeDroppingPlaceholder",()=>{let{droppingItem:t,cols:r}=this.props,{layout:n}=this.state,i=(0,xr.compact)(n.filter(a=>a.i!==t.i),(0,xr.compactType)(this.props),r,this.props.allowOverlap);this.setState({layout:i,droppingDOMNode:null,activeDrag:null,droppingPosition:void 0})}),sl(this,"onDragLeave",t=>{t.preventDefault(),t.stopPropagation(),this.dragEnterCounter--,this.dragEnterCounter===0&&this.removeDroppingPlaceholder()}),sl(this,"onDragEnter",t=>{t.preventDefault(),t.stopPropagation(),this.dragEnterCounter++}),sl(this,"onDrop",t=>{t.preventDefault(),t.stopPropagation();let{droppingItem:r}=this.props,{layout:n}=this.state,i=n.find(a=>a.i===r.i);this.dragEnterCounter=0,this.removeDroppingPlaceholder(),this.props.onDrop(n,i,t)})}componentDidMount(){this.setState({mounted:!0}),this.onLayoutMaybeChanged(this.state.layout,this.props.layout)}static getDerivedStateFromProps(t,r){let n;return r.activeDrag?null:(!(0,E4.deepEqual)(t.layout,r.propsLayout)||t.compactType!==r.compactType?n=t.layout:(0,xr.childrenEqual)(t.children,r.children)||(n=r.layout),n?{layout:(0,xr.synchronizeLayoutWithChildren)(n,t.children,t.cols,(0,xr.compactType)(t),t.allowOverlap),compactType:t.compactType,children:t.children,propsLayout:t.layout}:null)}shouldComponentUpdate(t,r){return this.props.children!==t.children||!(0,xr.fastRGLPropsEqual)(this.props,t,E4.deepEqual)||this.state.activeDrag!==r.activeDrag||this.state.mounted!==r.mounted||this.state.droppingPosition!==r.droppingPosition}componentDidUpdate(t,r){if(!this.state.activeDrag){let n=this.state.layout,i=r.layout;this.onLayoutMaybeChanged(n,i)}}containerHeight(){if(!this.props.autoSize)return;let t=(0,xr.bottom)(this.state.layout),r=this.props.containerPadding?this.props.containerPadding[1]:this.props.margin[1];return t*this.props.rowHeight+(t-1)*this.props.margin[1]+r*2+"px"}onLayoutMaybeChanged(t,r){r||(r=this.state.layout),(0,E4.deepEqual)(r,t)||this.props.onLayoutChange(t)}placeholder(){let{activeDrag:t}=this.state;if(!t)return null;let{width:r,cols:n,margin:i,containerPadding:a,rowHeight:o,maxRows:s,useCSSTransforms:l,transformScale:c}=this.props;return _y.createElement(bne.default,{w:t.w,h:t.h,x:t.x,y:t.y,i:t.i,className:`react-grid-placeholder ${this.state.resizing?"placeholder-resizing":""}`,containerWidth:r,cols:n,margin:i,containerPadding:a||i,maxRows:s,rowHeight:o,isDraggable:!1,isResizable:!1,isBounded:!1,useCSSTransforms:l,transformScale:c},_y.createElement("div",null))}processGridItem(t,r){if(!t||!t.key)return;let n=(0,xr.getLayoutItem)(this.state.layout,String(t.key));if(!n)return null;let{width:i,cols:a,margin:o,containerPadding:s,rowHeight:l,maxRows:c,isDraggable:d,isResizable:u,isBounded:p,useCSSTransforms:m,transformScale:g,draggableCancel:f,draggableHandle:v,resizeHandles:h,resizeHandle:y}=this.props,{mounted:b,droppingPosition:k}=this.state,x=typeof n.isDraggable=="boolean"?n.isDraggable:!n.static&&d,S=typeof n.isResizable=="boolean"?n.isResizable:!n.static&&u,w=n.resizeHandles||h,C=x&&p&&n.isBounded!==!1;return _y.createElement(bne.default,{containerWidth:i,cols:a,margin:o,containerPadding:s||o,maxRows:c,rowHeight:l,cancel:f,handle:v,onDragStop:this.onDragStop,onDragStart:this.onDragStart,onDrag:this.onDrag,onResizeStart:this.onResizeStart,onResize:this.onResize,onResizeStop:this.onResizeStop,isDraggable:x,isResizable:S,isBounded:C,useCSSTransforms:m&&b,usePercentages:!b,transformScale:g,w:n.w,h:n.h,x:n.x,y:n.y,i:n.i,minH:n.minH,minW:n.minW,maxH:n.maxH,maxW:n.maxW,static:n.static,droppingPosition:r?k:void 0,resizeHandles:w,resizeHandle:y},t)}render(){let{className:t,style:r,isDroppable:n,innerRef:i}=this.props,a=(0,P2e.default)(xne,t),o={height:this.containerHeight(),...r};return _y.createElement("div",{ref:i,className:a,style:o,onDrop:n?this.onDrop:xr.noop,onDragLeave:n?this.onDragLeave:xr.noop,onDragEnter:n?this.onDragEnter:xr.noop,onDragOver:n?this.onDragOver:xr.noop},_y.Children.map(this.props.children,s=>this.processGridItem(s)),n&&this.state.droppingDOMNode&&this.processGridItem(this.state.droppingDOMNode,!0),this.placeholder())}};lA.default=T0;sl(T0,"displayName","ReactGridLayout");sl(T0,"propTypes",E2e.default);sl(T0,"defaultProps",{autoSize:!0,cols:12,className:"",style:{},draggableHandle:"",draggableCancel:"",containerPadding:null,rowHeight:150,maxRows:1/0,layout:[],margin:[10,10],isBounded:!1,isDraggable:!0,isResizable:!0,allowOverlap:!1,isDroppable:!1,useCSSTransforms:!0,transformScale:1,verticalCompact:!0,compactType:"vertical",preventCollision:!1,droppingItem:{i:"__dropping-elem__",h:1,w:1},resizeHandles:["se"],onLayoutChange:xr.noop,onDragStart:xr.noop,onDrag:xr.noop,onDragStop:xr.noop,onResizeStart:xr.noop,onResize:xr.noop,onResizeStop:xr.noop,onDrop:xr.noop,onDropDragOver:xr.noop})});var L4=Fe(C0=>{"use strict";Object.defineProperty(C0,"__esModule",{value:!0});C0.findOrGenerateResponsiveLayout=N2e;C0.getBreakpointFromWidth=A2e;C0.getColsFromBreakpoint=L2e;C0.sortBreakpoints=A4;var cA=Fy();function A2e(e,t){let r=A4(e),n=r[0];for(let i=1,a=r.length;i<a;i++){let o=r[i];t>e[o]&&(n=o)}return n}function L2e(e,t){if(!t[e])throw new Error("ResponsiveReactGridLayout: `cols` entry for breakpoint "+e+" is missing!");return t[e]}function N2e(e,t,r,n,i,a){if(e[r])return(0,cA.cloneLayout)(e[r]);let o=e[n],s=A4(t),l=s.slice(s.indexOf(r));for(let c=0,d=l.length;c<d;c++){let u=l[c];if(e[u]){o=e[u];break}}return o=(0,cA.cloneLayout)(o||[]),(0,cA.compact)((0,cA.correctBounds)(o,{cols:i}),a,i)}function A4(e){return Object.keys(e).sort(function(r,n){return e[r]-e[n]})}});var Dne=Fe(pA=>{"use strict";Object.defineProperty(pA,"__esModule",{value:!0});pA.default=void 0;var Sne=Pne(Q()),vc=Cne(wf()),N4=RM(),P0=Fy(),By=L4(),F2e=Cne(M4());function Cne(e){return e&&e.__esModule?e:{default:e}}function Pne(e,t){if(typeof WeakMap=="function")var r=new WeakMap,n=new WeakMap;return(Pne=function(i,a){if(!a&&i&&i.__esModule)return i;var o,s,l={__proto__:null,default:i};if(i===null||typeof i!="object"&&typeof i!="function")return l;if(o=a?n:r){if(o.has(i))return o.get(i);o.set(i,l)}for(let c in i)c!=="default"&&{}.hasOwnProperty.call(i,c)&&((s=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(i,c))&&(s.get||s.set)?o(l,c,s):l[c]=i[c]);return l})(e,t)}function F4(){return F4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},F4.apply(null,arguments)}function uA(e,t,r){return(t=O2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O2e(e){var t=z2e(e,"string");return typeof t=="symbol"?t:t+""}function z2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Tne=e=>Object.prototype.toString.call(e);function dA(e,t){return e==null?null:Array.isArray(e)?e:e[t]}var w1=class extends Sne.Component{constructor(){super(...arguments),uA(this,"state",this.generateInitialState()),uA(this,"onLayoutChange",t=>{this.props.onLayoutChange(t,{...this.props.layouts,[this.state.breakpoint]:t})})}generateInitialState(){let{width:t,breakpoints:r,layouts:n,cols:i}=this.props,a=(0,By.getBreakpointFromWidth)(r,t),o=(0,By.getColsFromBreakpoint)(a,i),s=this.props.verticalCompact===!1?null:this.props.compactType;return{layout:(0,By.findOrGenerateResponsiveLayout)(n,r,a,a,o,s),breakpoint:a,cols:o}}static getDerivedStateFromProps(t,r){if(!(0,N4.deepEqual)(t.layouts,r.layouts)){let{breakpoint:n,cols:i}=r;return{layout:(0,By.findOrGenerateResponsiveLayout)(t.layouts,t.breakpoints,n,n,i,t.compactType),layouts:t.layouts}}return null}componentDidUpdate(t){(this.props.width!=t.width||this.props.breakpoint!==t.breakpoint||!(0,N4.deepEqual)(this.props.breakpoints,t.breakpoints)||!(0,N4.deepEqual)(this.props.cols,t.cols))&&this.onWidthChange(t)}onWidthChange(t){let{breakpoints:r,cols:n,layouts:i,compactType:a}=this.props,o=this.props.breakpoint||(0,By.getBreakpointFromWidth)(this.props.breakpoints,this.props.width),s=this.state.breakpoint,l=(0,By.getColsFromBreakpoint)(o,n),c={...i};if(s!==o||t.breakpoints!==r||t.cols!==n){s in c||(c[s]=(0,P0.cloneLayout)(this.state.layout));let p=(0,By.findOrGenerateResponsiveLayout)(c,r,o,s,l,a);p=(0,P0.synchronizeLayoutWithChildren)(p,this.props.children,l,a,this.props.allowOverlap),c[o]=p,this.props.onBreakpointChange(o,l),this.props.onLayoutChange(p,c),this.setState({breakpoint:o,layout:p,cols:l})}let d=dA(this.props.margin,o),u=dA(this.props.containerPadding,o);this.props.onWidthChange(this.props.width,d,l,u)}render(){let{breakpoint:t,breakpoints:r,cols:n,layouts:i,margin:a,containerPadding:o,onBreakpointChange:s,onLayoutChange:l,onWidthChange:c,...d}=this.props;return Sne.createElement(F2e.default,F4({},d,{margin:dA(a,this.state.breakpoint),containerPadding:dA(o,this.state.breakpoint),onLayoutChange:this.onLayoutChange,layout:this.state.layout,cols:this.state.cols}))}};pA.default=w1;uA(w1,"propTypes",{breakpoint:vc.default.string,breakpoints:vc.default.object,allowOverlap:vc.default.bool,cols:vc.default.object,margin:vc.default.oneOfType([vc.default.array,vc.default.object]),containerPadding:vc.default.oneOfType([vc.default.array,vc.default.object]),layouts(e,t){if(Tne(e[t])!=="[object Object]")throw new Error("Layout property must be an object. Received: "+Tne(e[t]));Object.keys(e[t]).forEach(r=>{if(!(r in e.breakpoints))throw new Error("Each key in layouts must align with a key in breakpoints.");(0,P0.validateLayout)(e.layouts[r],"layouts."+r)})},width:vc.default.number.isRequired,onBreakpointChange:vc.default.func,onLayoutChange:vc.default.func,onWidthChange:vc.default.func});uA(w1,"defaultProps",{breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:12,md:10,sm:6,xs:4,xxs:2},containerPadding:{lg:null,md:null,sm:null,xs:null,xxs:null},layouts:{},margin:[10,10],allowOverlap:!1,onBreakpointChange:P0.noop,onLayoutChange:P0.noop,onWidthChange:P0.noop})});var Ene=Fe((O4,z4)=>{(function(e,t){typeof O4=="object"&&typeof z4!="undefined"?z4.exports=t():typeof define=="function"&&define.amd?define(t):e.ResizeObserver=t()})(O4,(function(){"use strict";var e=(function(){if(typeof Map!="undefined")return Map;function A(I,L){var E=-1;return I.some(function(T,$){return T[0]===L?(E=$,!0):!1}),E}return(function(){function I(){this.__entries__=[]}return Object.defineProperty(I.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),I.prototype.get=function(L){var E=A(this.__entries__,L),T=this.__entries__[E];return T&&T[1]},I.prototype.set=function(L,E){var T=A(this.__entries__,L);~T?this.__entries__[T][1]=E:this.__entries__.push([L,E])},I.prototype.delete=function(L){var E=this.__entries__,T=A(E,L);~T&&E.splice(T,1)},I.prototype.has=function(L){return!!~A(this.__entries__,L)},I.prototype.clear=function(){this.__entries__.splice(0)},I.prototype.forEach=function(L,E){E===void 0&&(E=null);for(var T=0,$=this.__entries__;T<$.length;T++){var _=$[T];L.call(E,_[1],_[0])}},I})()})(),t=typeof window!="undefined"&&typeof document!="undefined"&&window.document===document,r=(function(){return typeof global!="undefined"&&global.Math===Math?global:typeof self!="undefined"&&self.Math===Math?self:typeof window!="undefined"&&window.Math===Math?window:Function("return this")()})(),n=(function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(r):function(A){return setTimeout(function(){return A(Date.now())},1e3/60)}})(),i=2;function a(A,I){var L=!1,E=!1,T=0;function $(){L&&(L=!1,A()),E&&B()}function _(){n($)}function B(){var W=Date.now();if(L){if(W-T<i)return;E=!0}else L=!0,E=!1,setTimeout(_,I);T=W}return B}var o=20,s=["top","right","bottom","left","width","height","size","weight"],l=typeof MutationObserver!="undefined",c=(function(){function A(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=a(this.refresh.bind(this),o)}return A.prototype.addObserver=function(I){~this.observers_.indexOf(I)||this.observers_.push(I),this.connected_||this.connect_()},A.prototype.removeObserver=function(I){var L=this.observers_,E=L.indexOf(I);~E&&L.splice(E,1),!L.length&&this.connected_&&this.disconnect_()},A.prototype.refresh=function(){var I=this.updateObservers_();I&&this.refresh()},A.prototype.updateObservers_=function(){var I=this.observers_.filter(function(L){return L.gatherActive(),L.hasActive()});return I.forEach(function(L){return L.broadcastActive()}),I.length>0},A.prototype.connect_=function(){!t||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),l?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},A.prototype.disconnect_=function(){!t||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},A.prototype.onTransitionEnd_=function(I){var L=I.propertyName,E=L===void 0?"":L,T=s.some(function($){return!!~E.indexOf($)});T&&this.refresh()},A.getInstance=function(){return this.instance_||(this.instance_=new A),this.instance_},A.instance_=null,A})(),d=(function(A,I){for(var L=0,E=Object.keys(I);L<E.length;L++){var T=E[L];Object.defineProperty(A,T,{value:I[T],enumerable:!1,writable:!1,configurable:!0})}return A}),u=(function(A){var I=A&&A.ownerDocument&&A.ownerDocument.defaultView;return I||r}),p=S(0,0,0,0);function m(A){return parseFloat(A)||0}function g(A){for(var I=[],L=1;L<arguments.length;L++)I[L-1]=arguments[L];return I.reduce(function(E,T){var $=A["border-"+T+"-width"];return E+m($)},0)}function f(A){for(var I=["top","right","bottom","left"],L={},E=0,T=I;E<T.length;E++){var $=T[E],_=A["padding-"+$];L[$]=m(_)}return L}function v(A){var I=A.getBBox();return S(0,0,I.width,I.height)}function h(A){var I=A.clientWidth,L=A.clientHeight;if(!I&&!L)return p;var E=u(A).getComputedStyle(A),T=f(E),$=T.left+T.right,_=T.top+T.bottom,B=m(E.width),W=m(E.height);if(E.boxSizing==="border-box"&&(Math.round(B+$)!==I&&(B-=g(E,"left","right")+$),Math.round(W+_)!==L&&(W-=g(E,"top","bottom")+_)),!b(A)){var N=Math.round(B+$)-I,U=Math.round(W+_)-L;Math.abs(N)!==1&&(B-=N),Math.abs(U)!==1&&(W-=U)}return S(T.left,T.top,B,W)}var y=(function(){return typeof SVGGraphicsElement!="undefined"?function(A){return A instanceof u(A).SVGGraphicsElement}:function(A){return A instanceof u(A).SVGElement&&typeof A.getBBox=="function"}})();function b(A){return A===u(A).document.documentElement}function k(A){return t?y(A)?v(A):h(A):p}function x(A){var I=A.x,L=A.y,E=A.width,T=A.height,$=typeof DOMRectReadOnly!="undefined"?DOMRectReadOnly:Object,_=Object.create($.prototype);return d(_,{x:I,y:L,width:E,height:T,top:L,right:I+E,bottom:T+L,left:I}),_}function S(A,I,L,E){return{x:A,y:I,width:L,height:E}}var w=(function(){function A(I){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=S(0,0,0,0),this.target=I}return A.prototype.isActive=function(){var I=k(this.target);return this.contentRect_=I,I.width!==this.broadcastWidth||I.height!==this.broadcastHeight},A.prototype.broadcastRect=function(){var I=this.contentRect_;return this.broadcastWidth=I.width,this.broadcastHeight=I.height,I},A})(),C=(function(){function A(I,L){var E=x(L);d(this,{target:I,contentRect:E})}return A})(),D=(function(){function A(I,L,E){if(this.activeObservations_=[],this.observations_=new e,typeof I!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=I,this.controller_=L,this.callbackCtx_=E}return A.prototype.observe=function(I){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element=="undefined"||!(Element instanceof Object))){if(!(I instanceof u(I).Element))throw new TypeError('parameter 1 is not of type "Element".');var L=this.observations_;L.has(I)||(L.set(I,new w(I)),this.controller_.addObserver(this),this.controller_.refresh())}},A.prototype.unobserve=function(I){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element=="undefined"||!(Element instanceof Object))){if(!(I instanceof u(I).Element))throw new TypeError('parameter 1 is not of type "Element".');var L=this.observations_;L.has(I)&&(L.delete(I),L.size||this.controller_.removeObserver(this))}},A.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},A.prototype.gatherActive=function(){var I=this;this.clearActive(),this.observations_.forEach(function(L){L.isActive()&&I.activeObservations_.push(L)})},A.prototype.broadcastActive=function(){if(this.hasActive()){var I=this.callbackCtx_,L=this.activeObservations_.map(function(E){return new C(E.target,E.broadcastRect())});this.callback_.call(I,L,I),this.clearActive()}},A.prototype.clearActive=function(){this.activeObservations_.splice(0)},A.prototype.hasActive=function(){return this.activeObservations_.length>0},A})(),P=typeof WeakMap!="undefined"?new WeakMap:new e,M=(function(){function A(I){if(!(this instanceof A))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var L=c.getInstance(),E=new D(I,L,this);P.set(this,E)}return A})();["observe","unobserve","disconnect"].forEach(function(A){M.prototype[A]=function(){var I;return(I=P.get(this))[A].apply(I,arguments)}});var z=(function(){return typeof r.ResizeObserver!="undefined"?r.ResizeObserver:M})();return z}))});var Mne=Fe(B4=>{"use strict";Object.defineProperty(B4,"__esModule",{value:!0});B4.default=U2e;var mA=Ine(Q()),j2e=_4(wf()),_2e=_4(Ene()),B2e=_4(UM());function _4(e){return e&&e.__esModule?e:{default:e}}function Ine(e,t){if(typeof WeakMap=="function")var r=new WeakMap,n=new WeakMap;return(Ine=function(i,a){if(!a&&i&&i.__esModule)return i;var o,s,l={__proto__:null,default:i};if(i===null||typeof i!="object"&&typeof i!="function")return l;if(o=a?n:r){if(o.has(i))return o.get(i);o.set(i,l)}for(let c in i)c!=="default"&&{}.hasOwnProperty.call(i,c)&&((s=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(i,c))&&(s.get||s.set)?o(l,c,s):l[c]=i[c]);return l})(e,t)}function j4(){return j4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},j4.apply(null,arguments)}function D0(e,t,r){return(t=W2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function W2e(e){var t=$2e(e,"string");return typeof t=="symbol"?t:t+""}function $2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var R2e="react-grid-layout";function U2e(e){var t;return t=class extends mA.Component{constructor(){super(...arguments),D0(this,"state",{width:1280}),D0(this,"elementRef",mA.createRef()),D0(this,"mounted",!1),D0(this,"resizeObserver",void 0)}componentDidMount(){this.mounted=!0,this.resizeObserver=new _2e.default(i=>{if(this.elementRef.current instanceof HTMLElement){let o=i[0].contentRect.width;this.setState({width:o})}});let n=this.elementRef.current;n instanceof HTMLElement&&this.resizeObserver.observe(n)}componentWillUnmount(){this.mounted=!1;let n=this.elementRef.current;n instanceof HTMLElement&&this.resizeObserver.unobserve(n),this.resizeObserver.disconnect()}render(){let{measureBeforeMount:n,...i}=this.props;return n&&!this.mounted?mA.createElement("div",{className:(0,B2e.default)(this.props.className,R2e),style:this.props.style,ref:this.elementRef}):mA.createElement(e,j4({innerRef:this.elementRef},i,this.state))}},D0(t,"defaultProps",{measureBeforeMount:!1}),D0(t,"propTypes",{measureBeforeMount:j2e.default.bool}),t}});var W4=Fe((Fgt,Wy)=>{Wy.exports=M4().default;Wy.exports.utils=Fy();Wy.exports.calculateUtils=GM();Wy.exports.Responsive=Dne().default;Wy.exports.Responsive.utils=L4();Wy.exports.WidthProvider=Mne().default});var ll,k1=F(()=>{ll=[{id:"pnlChart",name:"Cumulative P&L",description:"Line chart showing cumulative P&L over time",category:"performance",minSize:{w:4,h:5},defaultSize:{w:6,h:8}},{id:"performanceCalendar",name:"Performance Calendar",description:"Calendar view showing daily performance",category:"performance",minSize:{w:4,h:3},defaultSize:{w:6,h:4}},{id:"dailyPerformance",name:"Daily Performance",description:"Bar chart showing P&L for each trading day",category:"performance",minSize:{w:4,h:3},defaultSize:{w:6,h:4}},{id:"tradesChart",name:"Trades Chart",description:"Bar chart showing P&L for each individual trade",category:"performance",minSize:{w:4,h:3},defaultSize:{w:6,h:4}},{id:"drawdownChart",name:"Drawdown Chart",description:"Chart showing percentage drawdown from peak equity",category:"performance",minSize:{w:4,h:5},defaultSize:{w:6,h:8}},{id:"recentTrades",name:"Recent Trades",description:"Shows the 10 most recent trades with details",category:"journal",minSize:{w:2,h:3},defaultSize:{w:6,h:4},maxSize:{w:12,h:7}},{id:"rollingWinRate",name:"Rolling Win/Loss Ratio",description:"Shows the ratio of average wins to average losses over a rolling period",category:"analysis",minSize:{w:4,h:5},defaultSize:{w:6,h:8}},{id:"rollingStats",name:"Rolling Avg Win/Loss",description:"Shows average win and loss over a rolling period",category:"analysis",minSize:{w:4,h:5},defaultSize:{w:6,h:8}}]});function Ane(){if(S1===0){let e=document.createElement("style");e.id="dashboard-widget-skeleton-styles",e.textContent=H2e,document.head.appendChild(e)}S1++}function Lne(){var e;S1--,S1<=0&&(S1=0,(e=document.head.querySelector("#dashboard-widget-skeleton-styles"))==null||e.remove())}var H2e,S1,Nne=F(()=>{H2e=`
.dashboard-widget-skeleton {
  width: 100%;
  padding: 1.5rem;
  background: var(--background-primary);
  border-radius: 8px;
}

.dashboard-widget-skeleton-chart {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.dashboard-widget-skeleton-table {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.skeleton-table-header,
.skeleton-table-row {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  padding: 0.5rem;
}

.skeleton-table-header {
  border-bottom: 1px solid var(--background-modifier-border);
  padding-bottom: 0.75rem;
}

.dashboard-widget-skeleton-calendar {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.skeleton-calendar-grid {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 0.5rem;
}

@media (max-width: 768px) {
  .dashboard-widget-skeleton {
    padding: 1rem;
  }

  .skeleton-calendar-grid {
    grid-template-columns: repeat(7, 1fr);
    gap: 0.25rem;
  }
}
`,S1=0});var Ao,Yp,fA=F(()=>{Ao=Y(Q());us();ps();Nne();ff();Yp=(0,Ao.memo)(({type:e})=>((0,Ao.useLayoutEffect)(()=>(tl(),Ane(),()=>{Lne()}),[]),Ao.default.createElement("div",{className:"dashboard-widget-skeleton","aria-label":"Loading widget data"},(()=>{switch(e){case"chart":return Ao.default.createElement("div",{className:"dashboard-widget-skeleton-chart"},Ao.default.createElement(Qe,{width:"150px",height:"18px"}),Ao.default.createElement(ae,{width:"100%",height:"300px",borderRadius:"8px"}));case"table":return Ao.default.createElement("div",{className:"dashboard-widget-skeleton-table"},Ao.default.createElement(Qe,{width:"150px",height:"18px"}),Ao.default.createElement("div",{className:"skeleton-table-header"},[1,2,3,4].map(r=>Ao.default.createElement(Qe,{key:r,width:"60px",height:"14px"}))),Array.from({length:5}).map((r,n)=>Ao.default.createElement("div",{key:n,className:"skeleton-table-row"},[1,2,3,4].map(i=>Ao.default.createElement(Qe,{key:i,width:"50px",height:"12px"})))));case"calendar":return Ao.default.createElement("div",{className:"dashboard-widget-skeleton-calendar"},Ao.default.createElement(Qe,{width:"150px",height:"18px"}),Ao.default.createElement("div",{className:"skeleton-calendar-grid"},Array.from({length:35}).map((r,n)=>Ao.default.createElement(ae,{key:n,width:"100%",height:"40px",borderRadius:"4px"}))));default:return Ao.default.createElement(ae,{width:"100%",height:"400px"})}})())));Yp.displayName="DashboardWidgetSkeleton"});var Kp,cl,Sf=F(()=>{Kp=Y(Q());qi();_t();Wp();Dn();fc();fA();cl=({filters:e,dateFormat:t,children:r})=>{let n=Ae(),{dashboardData:i,isLoading:a,isStale:o,error:s,refreshData:l}=ua(),c=t||vn();return(0,Kp.useEffect)(()=>{(async()=>{try{let{ensureChartStyles:u}=await Promise.resolve().then(()=>(QT(),MB));u()}catch(u){console.error("Error loading chart styles:",u)}try{let{ensureSharedComponentStyles:u}=await Promise.resolve().then(()=>(XT(),ree));u()}catch(u){console.error("Error loading shared component styles:",u)}})()},[]),Xe("trade:changed",l),Kp.default.createElement("div",{className:"journalit-dashboard-widget-container",style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}},a&&!i?Kp.default.createElement(Yp,{type:"chart"}):s?Kp.default.createElement("div",{className:"journalit-dashboard-widget-error",style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",textAlign:"center",padding:"16px",color:"var(--text-error)"}},(typeof s=="string"?s:s==null?void 0:s.message)||"Failed to load data"):!i||i.trades.length===0?Kp.default.createElement("div",{style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",position:"relative"}},Kp.default.createElement(yi,{message:"No data available",subMessage:"Try adjusting your filter settings",iconSize:40,actionButtonText:"Add Trade",onActionButtonClick:()=>{if(!n||!n.app)return;new Eo({app:n.app,plugin:n}).open()}})):Kp.default.createElement("div",{style:{width:"100%",height:"100%",overflow:"hidden",backgroundColor:"transparent",position:"relative"}},r(i,c),(o||a)&&Kp.default.createElement(Io,{message:"Loading...",size:"small",overlay:!0})))}});function Fne(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(r=Fne(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function wt(){for(var e,t,r=0,n="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=Fne(e))&&(n&&(n+=" "),n+=t);return n}var Zn=F(()=>{});function T1(e){if(typeof e!="string")return!1;var t=q2e;return t.includes(e)}var q2e,$4=F(()=>{q2e=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"]});function R4(e){return typeof e!="string"?!1:G2e.has(e)}function U4(e){return typeof e=="string"&&e.startsWith("data-")}function mn(e){if(typeof e!="object"||e===null)return{};var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(R4(r)||U4(r))&&(t[r]=e[r]);return t}function yc(e){if(e==null)return null;if((0,One.isValidElement)(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return mn(t)}return typeof e=="object"&&!Array.isArray(e)?mn(e):null}var One,V2e,G2e,js=F(()=>{One=Y(Q()),V2e=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],G2e=new Set(V2e)});function nn(e){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(R4(r)||U4(r)||T1(r))&&(t[r]=e[r]);return t}function jne(e){return e==null?null:(0,zne.isValidElement)(e)?nn(e.props):typeof e=="object"&&!Array.isArray(e)?nn(e):null}var zne,_s=F(()=>{zne=Y(Q());$4();js()});function H4(){return H4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},H4.apply(null,arguments)}function K2e(e,t){if(e==null)return{};var r,n,i=J2e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function J2e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var gA,_ne,Y2e,C1,q4=F(()=>{gA=Y(Q()),_ne=Y(Q());Zn();_s();Y2e=["children","width","height","viewBox","className","style","title","desc"];C1=(0,_ne.forwardRef)((e,t)=>{var{children:r,width:n,height:i,viewBox:a,className:o,style:s,title:l,desc:c}=e,d=K2e(e,Y2e),u=a||{width:n,height:i,x:0,y:0},p=wt("recharts-surface",o);return gA.createElement("svg",H4({},nn(d),{className:p,width:n,height:i,style:s,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height),ref:t}),gA.createElement("title",null,l),gA.createElement("desc",null,c),r)})});function V4(){return V4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},V4.apply(null,arguments)}function X2e(e,t){if(e==null)return{};var r,n,i=Z2e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Z2e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var hA,Q2e,Yr,bc=F(()=>{hA=Y(Q());Zn();_s();Q2e=["children","className"];Yr=hA.forwardRef((e,t)=>{var{children:r,className:n}=e,i=X2e(e,Q2e),a=wt("recharts-layer",n);return hA.createElement("g",V4({className:a},nn(i),{ref:t}),r)})});var vA,G4,Bne,Y4=F(()=>{vA=Y(Q()),G4=(0,vA.createContext)(null),Bne=()=>(0,vA.useContext)(G4)});function li(e){return function(){return e}}var P1=F(()=>{});var K4,D1,fs,$y,dht,E0,xh=F(()=>{K4=Math.cos,D1=Math.sin,fs=Math.sqrt,$y=Math.PI,dht=$y/2,E0=2*$y});function Wne(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function tFe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Wne;let r=10**t;return function(n){this._+=n[0];for(let i=1,a=n.length;i<a;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}function $ne(){return new Uy}var J4,Q4,Ry,eFe,Uy,Rne=F(()=>{J4=Math.PI,Q4=2*J4,Ry=1e-6,eFe=Q4-Ry;Uy=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Wne:tFe(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,i){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(t,r,n,i,a,o){this._append`C${+t},${+r},${+n},${+i},${this._x1=+a},${this._y1=+o}`}arcTo(t,r,n,i,a){if(t=+t,r=+r,n=+n,i=+i,a=+a,a<0)throw new Error(`negative radius: ${a}`);let o=this._x1,s=this._y1,l=n-t,c=i-r,d=o-t,u=s-r,p=d*d+u*u;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(p>Ry)if(!(Math.abs(u*l-c*d)>Ry)||!a)this._append`L${this._x1=t},${this._y1=r}`;else{let m=n-o,g=i-s,f=l*l+c*c,v=m*m+g*g,h=Math.sqrt(f),y=Math.sqrt(p),b=a*Math.tan((J4-Math.acos((f+p-v)/(2*h*y)))/2),k=b/y,x=b/h;Math.abs(k-1)>Ry&&this._append`L${t+k*d},${r+k*u}`,this._append`A${a},${a},0,0,${+(u*m>d*g)},${this._x1=t+x*l},${this._y1=r+x*c}`}}arc(t,r,n,i,a,o){if(t=+t,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let s=n*Math.cos(i),l=n*Math.sin(i),c=t+s,d=r+l,u=1^o,p=o?i-a:a-i;this._x1===null?this._append`M${c},${d}`:(Math.abs(this._x1-c)>Ry||Math.abs(this._y1-d)>Ry)&&this._append`L${c},${d}`,n&&(p<0&&(p=p%Q4+Q4),p>eFe?this._append`A${n},${n},0,1,${u},${t-s},${r-l}A${n},${n},0,1,${u},${this._x1=c},${this._y1=d}`:p>Ry&&this._append`A${n},${n},0,${+(p>=J4)},${u},${this._x1=t+n*Math.cos(a)},${this._y1=r+n*Math.sin(a)}`)}rect(t,r,n,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}};$ne.prototype=Uy.prototype});var Une=F(()=>{Rne()});function I0(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{let n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new Uy(t)}var yA=F(()=>{Une()});function M0(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}var yht,bA=F(()=>{yht=Array.prototype.slice});function Hne(e){this._context=e}function wh(e){return new Hne(e)}var xA=F(()=>{Hne.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}}});function wA(e){return e[0]}function kA(e){return e[1]}var X4=F(()=>{});function E1(e,t){var r=li(!0),n=null,i=wh,a=null,o=I0(s);e=typeof e=="function"?e:e===void 0?wA:li(e),t=typeof t=="function"?t:t===void 0?kA:li(t);function s(l){var c,d=(l=M0(l)).length,u,p=!1,m;for(n==null&&(a=i(m=o())),c=0;c<=d;++c)!(c<d&&r(u=l[c],c,l))===p&&((p=!p)?a.lineStart():a.lineEnd()),p&&a.point(+e(u,c,l),+t(u,c,l));if(m)return a=null,m+""||null}return s.x=function(l){return arguments.length?(e=typeof l=="function"?l:li(+l),s):e},s.y=function(l){return arguments.length?(t=typeof l=="function"?l:li(+l),s):t},s.defined=function(l){return arguments.length?(r=typeof l=="function"?l:li(!!l),s):r},s.curve=function(l){return arguments.length?(i=l,n!=null&&(a=i(n)),s):i},s.context=function(l){return arguments.length?(l==null?n=a=null:a=i(n=l),s):n},s}var Z4=F(()=>{bA();P1();xA();yA();X4()});function A0(e,t,r){var n=null,i=li(!0),a=null,o=wh,s=null,l=I0(c);e=typeof e=="function"?e:e===void 0?wA:li(+e),t=typeof t=="function"?t:t===void 0?li(0):li(+t),r=typeof r=="function"?r:r===void 0?kA:li(+r);function c(u){var p,m,g,f=(u=M0(u)).length,v,h=!1,y,b=new Array(f),k=new Array(f);for(a==null&&(s=o(y=l())),p=0;p<=f;++p){if(!(p<f&&i(v=u[p],p,u))===h)if(h=!h)m=p,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),g=p-1;g>=m;--g)s.point(b[g],k[g]);s.lineEnd(),s.areaEnd()}h&&(b[p]=+e(v,p,u),k[p]=+t(v,p,u),s.point(n?+n(v,p,u):b[p],r?+r(v,p,u):k[p]))}if(y)return s=null,y+""||null}function d(){return E1().defined(i).curve(o).context(a)}return c.x=function(u){return arguments.length?(e=typeof u=="function"?u:li(+u),n=null,c):e},c.x0=function(u){return arguments.length?(e=typeof u=="function"?u:li(+u),c):e},c.x1=function(u){return arguments.length?(n=u==null?null:typeof u=="function"?u:li(+u),c):n},c.y=function(u){return arguments.length?(t=typeof u=="function"?u:li(+u),r=null,c):t},c.y0=function(u){return arguments.length?(t=typeof u=="function"?u:li(+u),c):t},c.y1=function(u){return arguments.length?(r=u==null?null:typeof u=="function"?u:li(+u),c):r},c.lineX0=c.lineY0=function(){return d().x(e).y(t)},c.lineY1=function(){return d().x(e).y(r)},c.lineX1=function(){return d().x(n).y(t)},c.defined=function(u){return arguments.length?(i=typeof u=="function"?u:li(!!u),c):i},c.curve=function(u){return arguments.length?(o=u,a!=null&&(s=o(a)),c):o},c.context=function(u){return arguments.length?(u==null?a=s=null:s=o(a=u),c):a},c}var qne=F(()=>{bA();P1();xA();Z4();yA();X4()});function e$(e){return new SA(e,!0)}function t$(e){return new SA(e,!1)}var SA,Vne=F(()=>{SA=class{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}});var L0,r$=F(()=>{xh();L0={draw(e,t){let r=fs(t/$y);e.moveTo(r,0),e.arc(0,0,r,0,E0)}}});var n$,Gne=F(()=>{xh();n$={draw(e,t){let r=fs(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}}});var Yne,rFe,i$,Kne=F(()=>{xh();Yne=fs(1/3),rFe=Yne*2,i$={draw(e,t){let r=fs(t/rFe),n=r*Yne;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}}});var a$,Jne=F(()=>{xh();a$={draw(e,t){let r=fs(t),n=-r/2;e.rect(n,n,r,r)}}});var nFe,Qne,iFe,aFe,o$,Xne=F(()=>{xh();nFe=.8908130915292852,Qne=D1($y/10)/D1(7*$y/10),iFe=D1(E0/10)*Qne,aFe=-K4(E0/10)*Qne,o$={draw(e,t){let r=fs(t*nFe),n=iFe*r,i=aFe*r;e.moveTo(0,-r),e.lineTo(n,i);for(let a=1;a<5;++a){let o=E0*a/5,s=K4(o),l=D1(o);e.lineTo(l*r,-s*r),e.lineTo(s*n-l*i,l*n+s*i)}e.closePath()}}});var s$,l$,Zne=F(()=>{xh();s$=fs(3),l$={draw(e,t){let r=-fs(t/(s$*3));e.moveTo(0,r*2),e.lineTo(-s$*r,-r),e.lineTo(s$*r,-r),e.closePath()}}});var Bd,Wd,c$,oFe,d$,eie=F(()=>{xh();Bd=-.5,Wd=fs(3)/2,c$=1/fs(12),oFe=(c$/2+1)*3,d$={draw(e,t){let r=fs(t/oFe),n=r/2,i=r*c$,a=n,o=r*c$+r,s=-a,l=o;e.moveTo(n,i),e.lineTo(a,o),e.lineTo(s,l),e.lineTo(Bd*n-Wd*i,Wd*n+Bd*i),e.lineTo(Bd*a-Wd*o,Wd*a+Bd*o),e.lineTo(Bd*s-Wd*l,Wd*s+Bd*l),e.lineTo(Bd*n+Wd*i,Bd*i-Wd*n),e.lineTo(Bd*a+Wd*o,Bd*o-Wd*a),e.lineTo(Bd*s+Wd*l,Bd*l-Wd*s),e.closePath()}}});function TA(e,t){let r=null,n=I0(i);e=typeof e=="function"?e:li(e||L0),t=typeof t=="function"?t:li(t===void 0?64:+t);function i(){let a;if(r||(r=a=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),a)return r=null,a+""||null}return i.type=function(a){return arguments.length?(e=typeof a=="function"?a:li(a),i):e},i.size=function(a){return arguments.length?(t=typeof a=="function"?a:li(+a),i):t},i.context=function(a){return arguments.length?(r=a==null?null:a,i):r},i}var tie=F(()=>{P1();yA();r$()});function N0(){}var u$=F(()=>{});function F0(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function rie(e){this._context=e}function p$(e){return new rie(e)}var CA=F(()=>{rie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:F0(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:F0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}}});function nie(e){this._context=e}function m$(e){return new nie(e)}var iie=F(()=>{u$();CA();nie.prototype={areaStart:N0,areaEnd:N0,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:F0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}}});function aie(e){this._context=e}function f$(e){return new aie(e)}var oie=F(()=>{CA();aie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:F0(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}}});function sie(e){this._context=e}function g$(e){return new sie(e)}var lie=F(()=>{u$();sie.prototype={areaStart:N0,areaEnd:N0,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}}});function cie(e){return e<0?-1:1}function die(e,t,r){var n=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(n||i<0&&-0),o=(r-e._y1)/(i||n<0&&-0),s=(a*i+o*n)/(n+i);return(cie(a)+cie(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function uie(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function h$(e,t,r){var n=e._x0,i=e._y0,a=e._x1,o=e._y1,s=(a-n)/3;e._context.bezierCurveTo(n+s,i+s*t,a-s,o-s*r,a,o)}function PA(e){this._context=e}function pie(e){this._context=new mie(e)}function mie(e){this._context=e}function v$(e){return new PA(e)}function y$(e){return new pie(e)}var fie=F(()=>{PA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:h$(this,this._t0,uie(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,h$(this,uie(this,r=die(this,e,t)),r);break;default:h$(this,this._t0,r=die(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};(pie.prototype=Object.create(PA.prototype)).point=function(e,t){PA.prototype.point.call(this,t,e)};mie.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,i,a){this._context.bezierCurveTo(t,e,n,r,a,i)}}});function hie(e){this._context=e}function gie(e){var t,r=e.length-1,n,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,a[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/a[t-1],a[t]-=n,o[t]-=n*o[t-1];for(i[r-1]=o[r-1]/a[r-1],t=r-2;t>=0;--t)i[t]=(o[t]-i[t+1])/a[t];for(a[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}function b$(e){return new hie(e)}var vie=F(()=>{hie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=gie(e),i=gie(t),a=0,o=1;o<r;++a,++o)this._context.bezierCurveTo(n[0][a],i[0][a],n[1][a],i[1][a],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}}});function DA(e,t){this._context=e,this._t=t}function x$(e){return new DA(e,.5)}function w$(e){return new DA(e,0)}function k$(e){return new DA(e,1)}var yie=F(()=>{DA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}}});function Jc(e,t){if((o=e.length)>1)for(var r=1,n,i,a=e[t[0]],o,s=a.length;r<o;++r)for(i=a,a=e[t[r]],n=0;n<s;++n)a[n][1]+=a[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}var O0=F(()=>{});function z0(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}var S$=F(()=>{});function sFe(e,t){return e[t]}function lFe(e){let t=[];return t.key=e,t}function T$(){var e=li([]),t=z0,r=Jc,n=sFe;function i(a){var o=Array.from(e.apply(this,arguments),lFe),s,l=o.length,c=-1,d;for(let u of a)for(s=0,++c;s<l;++s)(o[s][c]=[0,+n(u,o[s].key,c,a)]).data=u;for(s=0,d=M0(t(o));s<l;++s)o[d[s]].index=s;return r(o,d),o}return i.keys=function(a){return arguments.length?(e=typeof a=="function"?a:li(Array.from(a)),i):e},i.value=function(a){return arguments.length?(n=typeof a=="function"?a:li(+a),i):n},i.order=function(a){return arguments.length?(t=a==null?z0:typeof a=="function"?a:li(Array.from(a)),i):t},i.offset=function(a){return arguments.length?(r=a==null?Jc:a,i):r},i}var bie=F(()=>{bA();P1();O0();S$()});function C$(e,t){if((n=e.length)>0){for(var r,n,i=0,a=e[0].length,o;i<a;++i){for(o=r=0;r<n;++r)o+=e[r][i][1]||0;if(o)for(r=0;r<n;++r)e[r][i][1]/=o}Jc(e,t)}}var xie=F(()=>{O0()});function P$(e,t){if((i=e.length)>0){for(var r=0,n=e[t[0]],i,a=n.length;r<a;++r){for(var o=0,s=0;o<i;++o)s+=e[o][r][1]||0;n[r][1]+=n[r][0]=-s/2}Jc(e,t)}}var wie=F(()=>{O0()});function D$(e,t){if(!(!((o=e.length)>0)||!((a=(i=e[t[0]]).length)>0))){for(var r=0,n=1,i,a,o;n<a;++n){for(var s=0,l=0,c=0;s<o;++s){for(var d=e[t[s]],u=d[n][1]||0,p=d[n-1][1]||0,m=(u-p)/2,g=0;g<s;++g){var f=e[t[g]],v=f[n][1]||0,h=f[n-1][1]||0;m+=v-h}l+=u,c+=m*u}i[n-1][1]+=i[n-1][0]=r,l&&(r-=c/l)}i[n-1][1]+=i[n-1][0]=r,Jc(e,t)}}var kie=F(()=>{O0()});var Sie=F(()=>{qne();Z4();tie();r$();Gne();Kne();Jne();Xne();Zne();eie();iie();oie();CA();Vne();lie();xA();fie();vie();yie();bie();xie();O0();wie();kie();S$()});var EA=F(()=>{Sie()});var Tie=Fe(E$=>{"use strict";Object.defineProperty(E$,Symbol.toStringTag,{value:"Module"});function dFe(e){return e==="__proto__"}E$.isUnsafeProperty=dFe});var M$=Fe(I$=>{"use strict";Object.defineProperty(I$,Symbol.toStringTag,{value:"Module"});function uFe(e){switch(typeof e){case"number":case"symbol":return!1;case"string":return e.includes(".")||e.includes("[")||e.includes("]")}}I$.isDeepKey=uFe});var L$=Fe(A$=>{"use strict";Object.defineProperty(A$,Symbol.toStringTag,{value:"Module"});function pFe(e){var t;return typeof e=="string"||typeof e=="symbol"?e:Object.is((t=e==null?void 0:e.valueOf)==null?void 0:t.call(e),-0)?"-0":String(e)}A$.toKey=pFe});var IA=Fe(N$=>{"use strict";Object.defineProperty(N$,Symbol.toStringTag,{value:"Module"});function mFe(e){let t=[],r=e.length;if(r===0)return t;let n=0,i="",a="",o=!1;for(e.charCodeAt(0)===46&&(t.push(""),n++);n<r;){let s=e[n];a?s==="\\"&&n+1<r?(n++,i+=e[n]):s===a?a="":i+=s:o?s==='"'||s==="'"?a=s:s==="]"?(o=!1,t.push(i),i=""):i+=s:s==="["?(o=!0,i&&(t.push(i),i="")):s==="."?i&&(t.push(i),i=""):i+=s,n++}return i&&t.push(i),t}N$.toPath=mFe});var MA=Fe(O$=>{"use strict";Object.defineProperty(O$,Symbol.toStringTag,{value:"Module"});var F$=Tie(),fFe=M$(),gFe=L$(),hFe=IA();function Cie(e,t,r){if(e==null)return r;switch(typeof t){case"string":{if(F$.isUnsafeProperty(t))return r;let n=e[t];return n===void 0?fFe.isDeepKey(t)?Cie(e,hFe.toPath(t),r):r:n}case"number":case"symbol":{typeof t=="number"&&(t=gFe.toKey(t));let n=e[t];return n===void 0?r:n}default:{if(Array.isArray(t))return vFe(e,t,r);if(Object.is(t==null?void 0:t.valueOf(),-0)?t="-0":t=String(t),F$.isUnsafeProperty(t))return r;let n=e[t];return n===void 0?r:n}}}function vFe(e,t,r){if(t.length===0)return r;let n=e;for(let i=0;i<t.length;i++){if(n==null||F$.isUnsafeProperty(t[i]))return r;n=n[t[i]]}return n===void 0?r:n}O$.get=Cie});var I1=Fe((ayt,Pie)=>{Pie.exports=MA().get});function Jp(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:yFe,r=10**t,n=Math.round(e*r)/r;return Object.is(n,-0)?0:n}function zi(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.reduce((i,a,o)=>{var s=r[o-1];return typeof s=="string"?i+s+a:s!==void 0?i+Jp(s)+a:i+a},"")}var yFe,j0=F(()=>{yFe=4});function Kr(e,t,r){return at(e)&&at(t)?Jp(e+r*(t-e)):t}function AA(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):(0,Die.default)(n,t))===r)}function Eie(e){return e!=null}function qy(){}var Die,Va,Ga,Hy,at,gs,bFe,Tf,Bs,z$,Or,kh,wr=F(()=>{Die=Y(I1());j0();Va=e=>e===0?0:e>0?1:-1,Ga=e=>typeof e=="number"&&e!=+e,Hy=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,at=e=>(typeof e=="number"||e instanceof Number)&&!Ga(e),gs=e=>at(e)||typeof e=="string",bFe=0,Tf=e=>{var t=++bFe;return"".concat(e||"").concat(t)},Bs=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!at(t)&&typeof t!="string")return n;var a;if(Hy(t)){if(r==null)return n;var o=t.indexOf("%");a=r*parseFloat(t.slice(0,o))/100}else a=+t;return Ga(a)&&(a=n),i&&r!=null&&a>r&&(a=r),a},z$=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[String(e[n])])r[String(e[n])]=!0;else return!0;return!1};Or=e=>e===null||typeof e=="undefined",kh=e=>Or(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1))});function j$(){return j$=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},j$.apply(null,arguments)}function Iie(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Mie(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Iie(Object(r),!0).forEach(function(n){wFe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Iie(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wFe(e,t,r){return(t=kFe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kFe(e){var t=SFe(e,"string");return typeof t=="symbol"?t:t+""}function SFe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function TFe(e,t){if(e==null)return{};var r,n,i=CFe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function CFe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Aie,xFe,Lie,PFe,DFe,EFe,IFe,M1,_$=F(()=>{Aie=Y(Q());EA();Zn();wr();_s();xFe=["type","size","sizeType"];Lie={symbolCircle:L0,symbolCross:n$,symbolDiamond:i$,symbolSquare:a$,symbolStar:o$,symbolTriangle:l$,symbolWye:d$},PFe=Math.PI/180,DFe=e=>{var t="symbol".concat(kh(e));return Lie[t]||L0},EFe=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*PFe;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},IFe=(e,t)=>{Lie["symbol".concat(kh(e))]=t},M1=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,i=TFe(e,xFe),a=Mie(Mie({},i),{},{type:t,size:r,sizeType:n}),o="circle";typeof t=="string"&&(o=t);var s=()=>{var p=DFe(o),m=TA().type(p).size(EFe(r,n,o)),g=m();if(g!==null)return g},{className:l,cx:c,cy:d}=a,u=nn(a);return at(c)&&at(d)&&at(r)?Aie.createElement("path",j$({},u,{className:wt("recharts-symbols",l),transform:"translate(".concat(c,", ").concat(d,")"),d:s()})):null};M1.registerSymbol=IFe});var Nie,LA,_0,MFe,Hu,qu=F(()=>{Nie=Y(Q());$4();LA=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,_0=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if((0,Nie.isValidElement)(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(i=>{T1(i)&&(n[i]=t||(a=>r[i](r,a)))}),n},MFe=(e,t,r)=>n=>(e(t,r,n),null),Hu=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(i=>{var a=e[i];T1(i)&&typeof a=="function"&&(n||(n={}),n[i]=MFe(a,t,r))}),n}});function Fie(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function AFe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Fie(Object(r),!0).forEach(function(n){LFe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fie(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LFe(e,t,r){return(t=NFe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NFe(e){var t=FFe(e,"string");return typeof t=="symbol"?t:t+""}function FFe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pr(e,t){var r=AFe({},e),n=t,i=Object.keys(t),a=i.reduce((o,s)=>(o[s]===void 0&&n[s]!==void 0&&(o[s]=n[s]),o),r);return a}var ma=F(()=>{});function NA(){return NA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},NA.apply(null,arguments)}function Oie(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function OFe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Oie(Object(r),!0).forEach(function(n){zFe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Oie(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zFe(e,t,r){return(t=jFe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jFe(e){var t=_Fe(e,"string");return typeof t=="symbol"?t:t+""}function _Fe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function WFe(e){var{data:t,iconType:r,inactiveColor:n}=e,i=$d/2,a=$d/6,o=$d/3,s=t.inactive?n:t.color,l=r!=null?r:t.type;if(l==="none")return null;if(l==="plainline"){var c;return $l.createElement("line",{strokeWidth:4,fill:"none",stroke:s,strokeDasharray:(c=t.payload)===null||c===void 0?void 0:c.strokeDasharray,x1:0,y1:i,x2:$d,y2:i,className:"recharts-legend-icon"})}if(l==="line")return $l.createElement("path",{strokeWidth:4,fill:"none",stroke:s,d:"M0,".concat(i,"h").concat(o,`
            A`).concat(a,",").concat(a,",0,1,1,").concat(2*o,",").concat(i,`
            H`).concat($d,"M").concat(2*o,",").concat(i,`
            A`).concat(a,",").concat(a,",0,1,1,").concat(o,",").concat(i),className:"recharts-legend-icon"});if(l==="rect")return $l.createElement("path",{stroke:"none",fill:s,d:"M0,".concat($d/8,"h").concat($d,"v").concat($d*3/4,"h").concat(-$d,"z"),className:"recharts-legend-icon"});if($l.isValidElement(t.legendIcon)){var d=OFe({},t);return delete d.legendIcon,$l.cloneElement(t.legendIcon,d)}return $l.createElement(M1,{fill:s,cx:i,cy:i,size:$d,sizeType:"diameter",type:l})}function $Fe(e){var{payload:t,iconSize:r,layout:n,formatter:i,inactiveColor:a,iconType:o}=e,s={x:0,y:0,width:$d,height:$d},l={display:n==="horizontal"?"inline-block":"block",marginRight:10},c={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((d,u)=>{var p=d.formatter||i,m=wt({"recharts-legend-item":!0,["legend-item-".concat(u)]:!0,inactive:d.inactive});if(d.type==="none")return null;var g=d.inactive?a:d.color,f=p?p(d.value,d,u):d.value;return $l.createElement("li",NA({className:m,style:l,key:"legend-item-".concat(u)},Hu(e,d,u)),$l.createElement(C1,{width:r,height:r,viewBox:s,style:c,"aria-label":"".concat(f," legend icon")},$l.createElement(WFe,{data:d,iconType:o,inactiveColor:a})),$l.createElement("span",{className:"recharts-legend-item-text",style:{color:g}},f))})}var $l,$d,BFe,zie,jie=F(()=>{$l=Y(Q());Zn();q4();_$();qu();ma();$d=32,BFe={align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"};zie=e=>{var t=pr(e,BFe),{payload:r,layout:n,align:i}=t;if(!r||!r.length)return null;var a={padding:0,margin:0,textAlign:n==="horizontal"?i:"left"};return $l.createElement("ul",{className:"recharts-default-legend",style:a},$l.createElement($Fe,NA({},t,{payload:r})))}});var _ie=Fe(B$=>{"use strict";Object.defineProperty(B$,Symbol.toStringTag,{value:"Module"});function RFe(e,t){let r=new Map;for(let n=0;n<e.length;n++){let i=e[n],a=t(i);r.has(a)||r.set(a,i)}return Array.from(r.values())}B$.uniqBy=RFe});var A1=Fe(W$=>{"use strict";Object.defineProperty(W$,Symbol.toStringTag,{value:"Module"});function UFe(e){return e}W$.identity=UFe});var Bie=Fe($$=>{"use strict";Object.defineProperty($$,Symbol.toStringTag,{value:"Module"});function HFe(e){return Number.isSafeInteger(e)&&e>=0}$$.isLength=HFe});var FA=Fe(R$=>{"use strict";Object.defineProperty(R$,Symbol.toStringTag,{value:"Module"});var qFe=Bie();function VFe(e){return e!=null&&typeof e!="function"&&qFe.isLength(e.length)}R$.isArrayLike=VFe});var Wie=Fe(U$=>{"use strict";Object.defineProperty(U$,Symbol.toStringTag,{value:"Module"});function GFe(e){return typeof e=="object"&&e!==null}U$.isObjectLike=GFe});var $ie=Fe(H$=>{"use strict";Object.defineProperty(H$,Symbol.toStringTag,{value:"Module"});var YFe=FA(),KFe=Wie();function JFe(e){return KFe.isObjectLike(e)&&YFe.isArrayLike(e)}H$.isArrayLikeObject=JFe});var Rie=Fe(q$=>{"use strict";Object.defineProperty(q$,Symbol.toStringTag,{value:"Module"});var QFe=MA();function XFe(e){return function(t){return QFe.get(t,e)}}q$.property=XFe});var G$=Fe(V$=>{"use strict";Object.defineProperty(V$,Symbol.toStringTag,{value:"Module"});function ZFe(e){return e!==null&&(typeof e=="object"||typeof e=="function")}V$.isObject=ZFe});var K$=Fe(Y$=>{"use strict";Object.defineProperty(Y$,Symbol.toStringTag,{value:"Module"});function eOe(e){return e==null||typeof e!="object"&&typeof e!="function"}Y$.isPrimitive=eOe});var Q$=Fe(J$=>{"use strict";Object.defineProperty(J$,Symbol.toStringTag,{value:"Module"});function tOe(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}J$.eq=tOe});var Vie=Fe(OA=>{"use strict";Object.defineProperty(OA,Symbol.toStringTag,{value:"Module"});var rOe=zA(),nOe=G$(),iOe=K$(),Uie=Q$();function aOe(e,t,r){return typeof r!="function"?rOe.isMatch(e,t):X$(e,t,function n(i,a,o,s,l,c){let d=r(i,a,o,s,l,c);return d!==void 0?!!d:X$(i,a,n,c)},new Map)}function X$(e,t,r,n){if(t===e)return!0;switch(typeof t){case"object":return oOe(e,t,r,n);case"function":return Object.keys(t).length>0?X$(e,{...t},r,n):Uie.eq(e,t);default:return nOe.isObject(e)?typeof t=="string"?t==="":!0:Uie.eq(e,t)}}function oOe(e,t,r,n){if(t==null)return!0;if(Array.isArray(t))return Hie(e,t,r,n);if(t instanceof Map)return sOe(e,t,r,n);if(t instanceof Set)return qie(e,t,r,n);let i=Object.keys(t);if(e==null)return i.length===0;if(i.length===0)return!0;if(n&&n.has(t))return n.get(t)===e;n&&n.set(t,e);try{for(let a=0;a<i.length;a++){let o=i[a];if(!iOe.isPrimitive(e)&&!(o in e)||t[o]===void 0&&e[o]!==void 0||t[o]===null&&e[o]!==null||!r(e[o],t[o],o,e,t,n))return!1}return!0}finally{n&&n.delete(t)}}function sOe(e,t,r,n){if(t.size===0)return!0;if(!(e instanceof Map))return!1;for(let[i,a]of t.entries()){let o=e.get(i);if(r(o,a,i,e,t,n)===!1)return!1}return!0}function Hie(e,t,r,n){if(t.length===0)return!0;if(!Array.isArray(e))return!1;let i=new Set;for(let a=0;a<t.length;a++){let o=t[a],s=!1;for(let l=0;l<e.length;l++){if(i.has(l))continue;let c=e[l],d=!1;if(r(c,o,a,e,t,n)&&(d=!0),d){i.add(l),s=!0;break}}if(!s)return!1}return!0}function qie(e,t,r,n){return t.size===0?!0:e instanceof Set?Hie([...e],[...t],r,n):!1}OA.isMatchWith=aOe;OA.isSetMatch=qie});var zA=Fe(Z$=>{"use strict";Object.defineProperty(Z$,Symbol.toStringTag,{value:"Module"});var lOe=Vie();function cOe(e,t){return lOe.isMatchWith(e,t,()=>{})}Z$.isMatch=cOe});var Gie=Fe(eR=>{"use strict";Object.defineProperty(eR,Symbol.toStringTag,{value:"Module"});function dOe(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}eR.getSymbols=dOe});var rR=Fe(tR=>{"use strict";Object.defineProperty(tR,Symbol.toStringTag,{value:"Module"});function uOe(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}tR.getTag=uOe});var nR=Fe(Ci=>{"use strict";Object.defineProperty(Ci,Symbol.toStringTag,{value:"Module"});var pOe="[object RegExp]",mOe="[object String]",fOe="[object Number]",gOe="[object Boolean]",hOe="[object Arguments]",vOe="[object Symbol]",yOe="[object Date]",bOe="[object Map]",xOe="[object Set]",wOe="[object Array]",kOe="[object Function]",SOe="[object ArrayBuffer]",TOe="[object Object]",COe="[object Error]",POe="[object DataView]",DOe="[object Uint8Array]",EOe="[object Uint8ClampedArray]",IOe="[object Uint16Array]",MOe="[object Uint32Array]",AOe="[object BigUint64Array]",LOe="[object Int8Array]",NOe="[object Int16Array]",FOe="[object Int32Array]",OOe="[object BigInt64Array]",zOe="[object Float32Array]",jOe="[object Float64Array]";Ci.argumentsTag=hOe;Ci.arrayBufferTag=SOe;Ci.arrayTag=wOe;Ci.bigInt64ArrayTag=OOe;Ci.bigUint64ArrayTag=AOe;Ci.booleanTag=gOe;Ci.dataViewTag=POe;Ci.dateTag=yOe;Ci.errorTag=COe;Ci.float32ArrayTag=zOe;Ci.float64ArrayTag=jOe;Ci.functionTag=kOe;Ci.int16ArrayTag=NOe;Ci.int32ArrayTag=FOe;Ci.int8ArrayTag=LOe;Ci.mapTag=bOe;Ci.numberTag=fOe;Ci.objectTag=TOe;Ci.regexpTag=pOe;Ci.setTag=xOe;Ci.stringTag=mOe;Ci.symbolTag=vOe;Ci.uint16ArrayTag=IOe;Ci.uint32ArrayTag=MOe;Ci.uint8ArrayTag=DOe;Ci.uint8ClampedArrayTag=EOe});var Yie=Fe(iR=>{"use strict";Object.defineProperty(iR,Symbol.toStringTag,{value:"Module"});function _Oe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}iR.isTypedArray=_Oe});var aR=Fe(L1=>{"use strict";Object.defineProperty(L1,Symbol.toStringTag,{value:"Module"});var BOe=Gie(),WOe=rR(),Ya=nR(),$Oe=K$(),ROe=Yie();function UOe(e,t){return Vy(e,void 0,e,new Map,t)}function Vy(e,t,r,n=new Map,i=void 0){let a=i==null?void 0:i(e,t,r,n);if(a!=null)return a;if($Oe.isPrimitive(e))return e;if(n.has(e))return n.get(e);if(Array.isArray(e)){let o=new Array(e.length);n.set(e,o);for(let s=0;s<e.length;s++)o[s]=Vy(e[s],s,r,n,i);return Object.hasOwn(e,"index")&&(o.index=e.index),Object.hasOwn(e,"input")&&(o.input=e.input),o}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){let o=new RegExp(e.source,e.flags);return o.lastIndex=e.lastIndex,o}if(e instanceof Map){let o=new Map;n.set(e,o);for(let[s,l]of e)o.set(s,Vy(l,s,r,n,i));return o}if(e instanceof Set){let o=new Set;n.set(e,o);for(let s of e)o.add(Vy(s,void 0,r,n,i));return o}if(typeof Buffer!="undefined"&&Buffer.isBuffer(e))return e.subarray();if(ROe.isTypedArray(e)){let o=new(Object.getPrototypeOf(e)).constructor(e.length);n.set(e,o);for(let s=0;s<e.length;s++)o[s]=Vy(e[s],s,r,n,i);return o}if(e instanceof ArrayBuffer||typeof SharedArrayBuffer!="undefined"&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){let o=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return n.set(e,o),B0(o,e,r,n,i),o}if(typeof File!="undefined"&&e instanceof File){let o=new File([e],e.name,{type:e.type});return n.set(e,o),B0(o,e,r,n,i),o}if(e instanceof Blob){let o=new Blob([e],{type:e.type});return n.set(e,o),B0(o,e,r,n,i),o}if(e instanceof Error){let o=new e.constructor;return n.set(e,o),o.message=e.message,o.name=e.name,o.stack=e.stack,o.cause=e.cause,B0(o,e,r,n,i),o}if(typeof e=="object"&&HOe(e)){let o=Object.create(Object.getPrototypeOf(e));return n.set(e,o),B0(o,e,r,n,i),o}return e}function B0(e,t,r=e,n,i){let a=[...Object.keys(t),...BOe.getSymbols(t)];for(let o=0;o<a.length;o++){let s=a[o],l=Object.getOwnPropertyDescriptor(e,s);(l==null||l.writable)&&(e[s]=Vy(t[s],s,r,n,i))}}function HOe(e){switch(WOe.getTag(e)){case Ya.argumentsTag:case Ya.arrayTag:case Ya.arrayBufferTag:case Ya.dataViewTag:case Ya.booleanTag:case Ya.dateTag:case Ya.float32ArrayTag:case Ya.float64ArrayTag:case Ya.int8ArrayTag:case Ya.int16ArrayTag:case Ya.int32ArrayTag:case Ya.mapTag:case Ya.numberTag:case Ya.objectTag:case Ya.regexpTag:case Ya.setTag:case Ya.stringTag:case Ya.symbolTag:case Ya.uint8ArrayTag:case Ya.uint8ClampedArrayTag:case Ya.uint16ArrayTag:case Ya.uint32ArrayTag:return!0;default:return!1}}L1.cloneDeepWith=UOe;L1.cloneDeepWithImpl=Vy;L1.copyProperties=B0});var Kie=Fe(oR=>{"use strict";Object.defineProperty(oR,Symbol.toStringTag,{value:"Module"});var qOe=aR();function VOe(e){return qOe.cloneDeepWithImpl(e,void 0,e,new Map,void 0)}oR.cloneDeep=VOe});var Jie=Fe(sR=>{"use strict";Object.defineProperty(sR,Symbol.toStringTag,{value:"Module"});var GOe=zA(),YOe=Kie();function KOe(e){return e=YOe.cloneDeep(e),t=>GOe.isMatch(t,e)}sR.matches=KOe});var Qie=Fe(cR=>{"use strict";Object.defineProperty(cR,Symbol.toStringTag,{value:"Module"});var lR=aR(),jA=nR();function JOe(e,t){return lR.cloneDeepWith(e,(r,n,i,a)=>{let o=t==null?void 0:t(r,n,i,a);if(o!=null)return o;if(typeof e=="object")switch(Object.prototype.toString.call(e)){case jA.numberTag:case jA.stringTag:case jA.booleanTag:{let s=new e.constructor(e==null?void 0:e.valueOf());return lR.copyProperties(s,e),s}case jA.argumentsTag:{let s={};return lR.copyProperties(s,e),s.length=e.length,s[Symbol.iterator]=e[Symbol.iterator],s}default:return}})}cR.cloneDeepWith=JOe});var Xie=Fe(dR=>{"use strict";Object.defineProperty(dR,Symbol.toStringTag,{value:"Module"});var QOe=Qie();function XOe(e){return QOe.cloneDeepWith(e)}dR.cloneDeep=XOe});var pR=Fe(uR=>{"use strict";Object.defineProperty(uR,Symbol.toStringTag,{value:"Module"});var ZOe=/^(?:0|[1-9]\d*)$/;function eze(e,t=Number.MAX_SAFE_INTEGER){switch(typeof e){case"number":return Number.isInteger(e)&&e>=0&&e<t;case"symbol":return!1;case"string":return ZOe.test(e)}}uR.isIndex=eze});var Zie=Fe(mR=>{"use strict";Object.defineProperty(mR,Symbol.toStringTag,{value:"Module"});var tze=rR();function rze(e){return e!==null&&typeof e=="object"&&tze.getTag(e)==="[object Arguments]"}mR.isArguments=rze});var eae=Fe(fR=>{"use strict";Object.defineProperty(fR,Symbol.toStringTag,{value:"Module"});var nze=M$(),ize=pR(),aze=Zie(),oze=IA();function sze(e,t){let r;if(Array.isArray(t)?r=t:typeof t=="string"&&nze.isDeepKey(t)&&(e==null?void 0:e[t])==null?r=oze.toPath(t):r=[t],r.length===0)return!1;let n=e;for(let i=0;i<r.length;i++){let a=r[i];if((n==null||!Object.hasOwn(n,a))&&!((Array.isArray(n)||aze.isArguments(n))&&ize.isIndex(a)&&a<n.length))return!1;n=n[a]}return!0}fR.has=sze});var tae=Fe(gR=>{"use strict";Object.defineProperty(gR,Symbol.toStringTag,{value:"Module"});var lze=zA(),cze=L$(),dze=Xie(),uze=MA(),pze=eae();function mze(e,t){switch(typeof e){case"object":{Object.is(e==null?void 0:e.valueOf(),-0)&&(e="-0");break}case"number":{e=cze.toKey(e);break}}return t=dze.cloneDeep(t),function(r){let n=uze.get(r,e);return n===void 0?pze.has(r,e):t===void 0?n===void 0:lze.isMatch(n,t)}}gR.matchesProperty=mze});var _A=Fe(hR=>{"use strict";Object.defineProperty(hR,Symbol.toStringTag,{value:"Module"});var fze=A1(),gze=Rie(),hze=Jie(),vze=tae();function yze(e){if(e==null)return fze.identity;switch(typeof e){case"function":return e;case"object":return Array.isArray(e)&&e.length===2?vze.matchesProperty(e[0],e[1]):hze.matches(e);case"string":case"symbol":case"number":return gze.property(e)}}hR.iteratee=yze});var rae=Fe(vR=>{"use strict";Object.defineProperty(vR,Symbol.toStringTag,{value:"Module"});var bze=_ie(),xze=A1(),wze=$ie(),kze=_A();function Sze(e,t=xze.identity){return wze.isArrayLikeObject(e)?bze.uniqBy(Array.from(e),kze.iteratee(t)):[]}vR.uniqBy=Sze});var iae=Fe((Jyt,nae)=>{nae.exports=rae().uniqBy});function BA(e,t,r){return t===!0?(0,yR.default)(e,r):typeof t=="function"?(0,yR.default)(e,t):e}var yR,bR=F(()=>{yR=Y(iae())});var oae=Fe(aae=>{"use strict";var W0=Q();function Tze(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Cze=typeof Object.is=="function"?Object.is:Tze,Pze=W0.useState,Dze=W0.useEffect,Eze=W0.useLayoutEffect,Ize=W0.useDebugValue;function Mze(e,t){var r=t(),n=Pze({inst:{value:r,getSnapshot:t}}),i=n[0].inst,a=n[1];return Eze(function(){i.value=r,i.getSnapshot=t,xR(i)&&a({inst:i})},[e,r,t]),Dze(function(){return xR(i)&&a({inst:i}),e(function(){xR(i)&&a({inst:i})})},[e]),Ize(r),r}function xR(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Cze(e,r)}catch(n){return!0}}function Aze(e,t){return t()}var Lze=typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"?Aze:Mze;aae.useSyncExternalStore=W0.useSyncExternalStore!==void 0?W0.useSyncExternalStore:Lze});var lae=Fe((Zyt,sae)=>{"use strict";sae.exports=oae()});var dae=Fe(cae=>{"use strict";var WA=Q(),Nze=lae();function Fze(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Oze=typeof Object.is=="function"?Object.is:Fze,zze=Nze.useSyncExternalStore,jze=WA.useRef,_ze=WA.useEffect,Bze=WA.useMemo,Wze=WA.useDebugValue;cae.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var a=jze(null);if(a.current===null){var o={hasValue:!1,value:null};a.current=o}else o=a.current;a=Bze(function(){function l(m){if(!c){if(c=!0,d=m,m=n(m),i!==void 0&&o.hasValue){var g=o.value;if(i(g,m))return u=g}return u=m}if(g=u,Oze(d,m))return g;var f=n(m);return i!==void 0&&i(g,f)?(d=m,g):(d=m,u=f)}var c=!1,d,u,p=r===void 0?null:r;return[function(){return l(t())},p===null?void 0:function(){return l(p())}]},[t,r,n,i]);var s=zze(e,a[0],a[1]);return _ze(function(){o.hasValue=!0,o.value=s},[s]),Wze(s),s}});var pae=Fe((tbt,uae)=>{"use strict";uae.exports=dae()});var mae,N1,wR=F(()=>{mae=Y(Q()),N1=(0,mae.createContext)(null)});function je(e){var t=(0,kR.useContext)(N1);return(0,fae.useSyncExternalStoreWithSelector)(t?t.subscription.addNestedSub:Rze,t?t.store.getState:$A,t?t.store.getState:$A,t?e:$A,Uze)}var fae,kR,$ze,lr,$A,Rze,Uze,Jr=F(()=>{fae=Y(pae()),kR=Y(Q());wR();$ze=e=>e,lr=()=>{var e=(0,kR.useContext)(N1);return e?e.store.dispatch:$ze},$A=()=>{},Rze=()=>$A,Uze=(e,t)=>e===t});function Hze(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function qze(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function Vze(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){let r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}function Gze(e){let t=Array.isArray(e[0])?e[0]:e;return Vze(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function Yze(e,t){let r=[],{length:n}=e;for(let i=0;i<n;i++)r.push(e[i].apply(null,t));return r}function RA(){return{s:Qze,v:void 0,o:null,p:null}}function vae(e,t={}){let r=RA(),{resultEqualityCheck:n}=t,i,a=0;function o(){var u,p;let s=r,{length:l}=arguments;for(let m=0,g=l;m<g;m++){let f=arguments[m];if(typeof f=="function"||typeof f=="object"&&f!==null){let v=s.o;v===null&&(s.o=v=new WeakMap);let h=v.get(f);h===void 0?(s=RA(),v.set(f,s)):s=h}else{let v=s.p;v===null&&(s.p=v=new Map);let h=v.get(f);h===void 0?(s=RA(),v.set(f,s)):s=h}}let c=s,d;if(s.s===hae)d=s.v;else if(d=e.apply(null,arguments),a++,n){let m=(p=(u=i==null?void 0:i.deref)==null?void 0:u.call(i))!=null?p:i;m!=null&&n(m,d)&&(d=m,a!==0&&a--),i=typeof d=="object"&&d!==null||typeof d=="function"?new Jze(d):d}return c.s=hae,c.v=d,d}return o.clearCache=()=>{r=RA(),o.resetResultsCount()},o.resultsCount=()=>a,o.resetResultsCount=()=>{a=0},o}function Xze(e,...t){let r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...i)=>{let a=0,o=0,s,l={},c=i.pop();typeof c=="object"&&(l=c,c=i.pop()),Hze(c,`createSelector expects an output function after the inputs, but received: [${typeof c}]`);let d={...r,...l},{memoize:u,memoizeOptions:p=[],argsMemoize:m=vae,argsMemoizeOptions:g=[],devModeChecks:f={}}=d,v=gae(p),h=gae(g),y=Gze(i),b=u(function(){return a++,c.apply(null,arguments)},...v),k=!0,x=m(function(){o++;let w=Yze(y,arguments);return s=b.apply(null,w),s},...h);return Object.assign(x,{resultFunc:c,memoizedResultFunc:b,dependencies:y,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>s,recomputations:()=>a,resetRecomputations:()=>{a=0},memoize:u,argsMemoize:m})};return Object.assign(n,{withTypes:()=>n}),n}var gae,abt,Kze,Jze,Qze,hae,de,Zze,Ka=F(()=>{gae=e=>Array.isArray(e)?e:[e];abt=Object.getPrototypeOf({}),Kze=class{constructor(e){this.value=e}deref(){return this.value}},Jze=typeof WeakRef!="undefined"?WeakRef:Kze,Qze=0,hae=1;de=Xze(vae),Zze=Object.assign((e,t=de)=>{qze(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);let r=Object.keys(e),n=r.map(a=>e[a]);return t(n,(...a)=>a.reduce((o,s,l)=>(o[r[l]]=s,o),{}))},{withTypes:()=>Zze})});var bae=Fe(SR=>{"use strict";Object.defineProperty(SR,Symbol.toStringTag,{value:"Module"});function yae(e){return typeof e=="symbol"?1:e===null?2:e===void 0?3:e!==e?4:0}var eje=(e,t,r)=>{if(e!==t){let n=yae(e),i=yae(t);if(n===i&&n===0){if(e<t)return r==="desc"?1:-1;if(e>t)return r==="desc"?-1:1}return r==="desc"?i-n:n-i}return 0};SR.compareValues=eje});var CR=Fe(TR=>{"use strict";Object.defineProperty(TR,Symbol.toStringTag,{value:"Module"});function tje(e){return typeof e=="symbol"||e instanceof Symbol}TR.isSymbol=tje});var xae=Fe(PR=>{"use strict";Object.defineProperty(PR,Symbol.toStringTag,{value:"Module"});var rje=CR(),nje=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ije=/^\w*$/;function aje(e,t){return Array.isArray(e)?!1:typeof e=="number"||typeof e=="boolean"||e==null||rje.isSymbol(e)?!0:typeof e=="string"&&(ije.test(e)||!nje.test(e))||t!=null&&Object.hasOwn(t,e)}PR.isKey=aje});var wae=Fe(DR=>{"use strict";Object.defineProperty(DR,Symbol.toStringTag,{value:"Module"});var oje=bae(),sje=xae(),lje=IA();function cje(e,t,r,n){if(e==null)return[];r=n?void 0:r,Array.isArray(e)||(e=Object.values(e)),Array.isArray(t)||(t=t==null?[null]:[t]),t.length===0&&(t=[null]),Array.isArray(r)||(r=r==null?[]:[r]),r=r.map(l=>String(l));let i=(l,c)=>{let d=l;for(let u=0;u<c.length&&d!=null;++u)d=d[c[u]];return d},a=(l,c)=>c==null||l==null?c:typeof l=="object"&&"key"in l?Object.hasOwn(c,l.key)?c[l.key]:i(c,l.path):typeof l=="function"?l(c):Array.isArray(l)?i(c,l):typeof c=="object"?c[l]:c,o=t.map(l=>(Array.isArray(l)&&l.length===1&&(l=l[0]),l==null||typeof l=="function"||Array.isArray(l)||sje.isKey(l)?l:{key:l,path:lje.toPath(l)}));return e.map(l=>({original:l,criteria:o.map(c=>a(c,l))})).slice().sort((l,c)=>{for(let d=0;d<o.length;d++){let u=oje.compareValues(l.criteria[d],c.criteria[d],r[d]);if(u!==0)return u}return 0}).map(l=>l.original)}DR.orderBy=cje});var kae=Fe(ER=>{"use strict";Object.defineProperty(ER,Symbol.toStringTag,{value:"Module"});function dje(e,t=1){let r=[],n=Math.floor(t),i=(a,o)=>{for(let s=0;s<a.length;s++){let l=a[s];Array.isArray(l)&&o<n?i(l,o+1):r.push(l)}};return i(e,0),r}ER.flatten=dje});var MR=Fe(IR=>{"use strict";Object.defineProperty(IR,Symbol.toStringTag,{value:"Module"});var uje=pR(),pje=FA(),mje=G$(),fje=Q$();function gje(e,t,r){return mje.isObject(r)&&(typeof t=="number"&&pje.isArrayLike(r)&&uje.isIndex(t)&&t<r.length||typeof t=="string"&&t in r)?fje.eq(r[t],e):!1}IR.isIterateeCall=gje});var Tae=Fe(AR=>{"use strict";Object.defineProperty(AR,Symbol.toStringTag,{value:"Module"});var hje=wae(),vje=kae(),Sae=MR();function yje(e,...t){let r=t.length;return r>1&&Sae.isIterateeCall(e,t[0],t[1])?t=[]:r>2&&Sae.isIterateeCall(t[0],t[1],t[2])&&(t=[t[0]]),hje.orderBy(e,vje.flatten(t),["asc"])}AR.sortBy=yje});var F1=Fe((hbt,Cae)=>{Cae.exports=Tae().sortBy});var Pae,LR,Dae,bje,Eae,NR=F(()=>{Ka();Pae=Y(F1()),LR=e=>e.legend.settings,Dae=e=>e.legend.size,bje=e=>e.legend.payload,Eae=de([bje,LR],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?(0,Pae.default)(n,r):n})});function Iae(){return je(Eae)}var Mae=F(()=>{Jr();NR()});function qA(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=(0,HA.useState)({height:0,left:0,top:0,width:0}),n=(0,HA.useCallback)(i=>{if(i!=null){var a=i.getBoundingClientRect(),o={height:a.height,left:a.left,top:a.top,width:a.width};(Math.abs(o.height-t.height)>UA||Math.abs(o.left-t.left)>UA||Math.abs(o.top-t.top)>UA||Math.abs(o.width-t.width)>UA)&&r({height:o.height,left:o.left,top:o.top,width:o.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}var HA,UA,FR=F(()=>{HA=Y(Q()),UA=1});function Ws(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}function GA(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function zR(e,t,r){if(typeof e!="function")throw new Error(Ws(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Ws(0));if(typeof t=="function"&&typeof r=="undefined"&&(r=t,t=void 0),typeof r!="undefined"){if(typeof r!="function")throw new Error(Ws(1));return r(zR)(e,t)}let n=e,i=t,a=new Map,o=a,s=0,l=!1;function c(){o===a&&(o=new Map,a.forEach((v,h)=>{o.set(h,v)}))}function d(){if(l)throw new Error(Ws(3));return i}function u(v){if(typeof v!="function")throw new Error(Ws(4));if(l)throw new Error(Ws(5));let h=!0;c();let y=s++;return o.set(y,v),function(){if(h){if(l)throw new Error(Ws(6));h=!1,c(),o.delete(y),a=null}}}function p(v){if(!GA(v))throw new Error(Ws(7));if(typeof v.type=="undefined")throw new Error(Ws(8));if(typeof v.type!="string")throw new Error(Ws(17));if(l)throw new Error(Ws(9));try{l=!0,i=n(i,v)}finally{l=!1}return(a=o).forEach(y=>{y()}),v}function m(v){if(typeof v!="function")throw new Error(Ws(10));n=v,p({type:VA.REPLACE})}function g(){let v=u;return{subscribe(h){if(typeof h!="object"||h===null)throw new Error(Ws(11));function y(){let k=h;k.next&&k.next(d())}return y(),{unsubscribe:v(y)}},[Aae](){return this}}}return p({type:VA.INIT}),{dispatch:p,subscribe:u,getState:d,replaceReducer:m,[Aae]:g}}function kje(e){Object.keys(e).forEach(t=>{let r=e[t];if(typeof r(void 0,{type:VA.INIT})=="undefined")throw new Error(Ws(12));if(typeof r(void 0,{type:VA.PROBE_UNKNOWN_ACTION()})=="undefined")throw new Error(Ws(13))})}function YA(e){let t=Object.keys(e),r={};for(let o=0;o<t.length;o++){let s=t[o];typeof e[s]=="function"&&(r[s]=e[s])}let n=Object.keys(r),i,a;try{kje(r)}catch(o){a=o}return function(s={},l){if(a)throw a;let c=!1,d={};for(let u=0;u<n.length;u++){let p=n[u],m=r[p],g=s[p],f=m(g,l);if(typeof f=="undefined"){let v=l&&l.type;throw new Error(Ws(14))}d[p]=f,c=c||f!==g}return c=c||n.length!==Object.keys(s).length,c?d:s}}function $0(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function Lae(...e){return t=>(r,n)=>{let i=t(r,n),a=()=>{throw new Error(Ws(15))},o={getState:i.getState,dispatch:(l,...c)=>a(l,...c)},s=e.map(l=>l(o));return a=$0(...s)(i.dispatch),{...i,dispatch:a}}}function KA(e){return GA(e)&&"type"in e&&typeof e.type=="string"}var xje,Aae,OR,wje,VA,R0=F(()=>{xje=typeof Symbol=="function"&&Symbol.observable||"@@observable",Aae=xje,OR=()=>Math.random().toString(36).substring(7).split("").join("."),wje={INIT:`@@redux/INIT${OR()}`,REPLACE:`@@redux/REPLACE${OR()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${OR()}`},VA=wje});function Vu(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}function Cf(e){return!!e&&!!e[Qc]}function Gu(e){var t;return e?Bae(e)||Array.isArray(e)||!!e[Nae]||!!((t=e.constructor)!=null&&t[Nae])||eL(e)||tL(e):!1}function Bae(e){if(!e||typeof e!="object")return!1;let t=U0(e);if(t===null)return!0;let r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===Sje}function JA(e,t){ZA(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function ZA(e){let t=e[Qc];return t?t.type_:Array.isArray(e)?1:eL(e)?2:tL(e)?3:0}function BR(e,t){return ZA(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Wae(e,t,r){let n=ZA(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function Tje(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function eL(e){return e instanceof Map}function tL(e){return e instanceof Set}function Gy(e){return e.copy_||e.base_}function WR(e,t){if(eL(e))return new Map(e);if(tL(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);let r=Bae(e);if(t===!0||t==="class_only"&&!r){let n=Object.getOwnPropertyDescriptors(e);delete n[Qc];let i=Reflect.ownKeys(n);for(let a=0;a<i.length;a++){let o=i[a],s=n[o];s.writable===!1&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(n[o]={configurable:!0,writable:!0,enumerable:s.enumerable,value:e[o]})}return Object.create(U0(e),n)}else{let n=U0(e);if(n!==null&&r)return{...e};let i=Object.create(n);return Object.assign(i,e)}}function rL(e,t=!1){return nL(e)||Cf(e)||!Gu(e)||(ZA(e)>1&&(e.set=e.add=e.clear=e.delete=Cje),Object.freeze(e),t&&Object.entries(e).forEach(([r,n])=>rL(n,!0))),e}function Cje(){Vu(2)}function nL(e){return Object.isFrozen(e)}function Yy(e){let t=Pje[e];return t||Vu(0,e),t}function $ae(){return O1}function Dje(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Fae(e,t){t&&(Yy("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function $R(e){RR(e),e.drafts_.forEach(Eje),e.drafts_=null}function RR(e){e===O1&&(O1=e.parent_)}function Oae(e){return O1=Dje(O1,e)}function Eje(e){let t=e[Qc];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function zae(e,t){t.unfinalizedDrafts_=t.drafts_.length;let r=t.drafts_[0];return e!==void 0&&e!==r?(r[Qc].modified_&&($R(t),Vu(4)),Gu(e)&&(e=QA(t,e),t.parent_||XA(t,e)),t.patches_&&Yy("Patches").generateReplacementPatches_(r[Qc].base_,e,t.patches_,t.inversePatches_)):e=QA(t,r,[]),$R(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==_ae?e:void 0}function QA(e,t,r){if(nL(t))return t;let n=t[Qc];if(!n)return JA(t,(i,a)=>jae(e,n,t,i,a,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return XA(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;let i=n.copy_,a=i,o=!1;n.type_===3&&(a=new Set(i),i.clear(),o=!0),JA(a,(s,l)=>jae(e,n,i,s,l,r,o)),XA(e,i,!1),r&&e.patches_&&Yy("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function jae(e,t,r,n,i,a,o){if(Cf(i)){let s=a&&t&&t.type_!==3&&!BR(t.assigned_,n)?a.concat(n):void 0,l=QA(e,i,s);if(Wae(r,n,l),Cf(l))e.canAutoFreeze_=!1;else return}else o&&r.add(i);if(Gu(i)&&!nL(i)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;QA(e,i),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&XA(e,i)}}function XA(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&rL(t,r)}function Ije(e,t){let r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:$ae(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1},i=n,a=qR;r&&(i=[n],a=z1);let{revoke:o,proxy:s}=Proxy.revocable(i,a);return n.draft_=s,n.revoke_=o,s}function jR(e,t){let r=e[Qc];return(r?Gy(r):e)[t]}function Mje(e,t,r){var i;let n=Rae(t,r);return n?"value"in n?n.value:(i=n.get)==null?void 0:i.call(e.draft_):void 0}function Rae(e,t){if(!(t in e))return;let r=U0(e);for(;r;){let n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=U0(r)}}function UR(e){e.modified_||(e.modified_=!0,e.parent_&&UR(e.parent_))}function _R(e){e.copy_||(e.copy_=WR(e.base_,e.scope_.immer_.useStrictShallowCopy_))}function HR(e,t){let r=eL(e)?Yy("MapSet").proxyMap_(e,t):tL(e)?Yy("MapSet").proxySet_(e,t):Ije(e,t);return(t?t.scope_:$ae()).drafts_.push(r),r}function dl(e){return Cf(e)||Vu(10,e),Uae(e)}function Uae(e){if(!Gu(e)||nL(e))return e;let t=e[Qc],r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=WR(e,t.scope_.immer_.useStrictShallowCopy_)}else r=WR(e,!0);return JA(r,(n,i)=>{Wae(r,n,Uae(i))}),t&&(t.finalized_=!1),r}var _ae,Nae,Qc,U0,Sje,Pje,O1,qR,z1,Aje,Xc,j1,Tbt,Cbt,Pbt,Dbt,Ebt,Ibt,iL=F(()=>{_ae=Symbol.for("immer-nothing"),Nae=Symbol.for("immer-draftable"),Qc=Symbol.for("immer-state");U0=Object.getPrototypeOf;Sje=Object.prototype.constructor.toString();Pje={};qR={get(e,t){if(t===Qc)return e;let r=Gy(e);if(!BR(r,t))return Mje(e,r,t);let n=r[t];return e.finalized_||!Gu(n)?n:n===jR(e.base_,t)?(_R(e),e.copy_[t]=HR(n,e)):n},has(e,t){return t in Gy(e)},ownKeys(e){return Reflect.ownKeys(Gy(e))},set(e,t,r){let n=Rae(Gy(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){let i=jR(Gy(e),t),a=i==null?void 0:i[Qc];if(a&&a.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(Tje(r,i)&&(r!==void 0||BR(e.base_,t)))return!0;_R(e),UR(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return jR(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,_R(e),UR(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){let r=Gy(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){Vu(11)},getPrototypeOf(e){return U0(e.base_)},setPrototypeOf(){Vu(12)}},z1={};JA(qR,(e,t)=>{z1[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});z1.deleteProperty=function(e,t){return z1.set.call(this,e,t,void 0)};z1.set=function(e,t,r){return qR.set.call(this,e[0],t,r,e[0])};Aje=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){let a=r;r=t;let o=this;return function(l=a,...c){return o.produce(l,d=>r.call(this,d,...c))}}typeof r!="function"&&Vu(6),n!==void 0&&typeof n!="function"&&Vu(7);let i;if(Gu(t)){let a=Oae(this),o=HR(t,void 0),s=!0;try{i=r(o),s=!1}finally{s?$R(a):RR(a)}return Fae(a,n),zae(i,a)}else if(!t||typeof t!="object"){if(i=r(t),i===void 0&&(i=t),i===_ae&&(i=void 0),this.autoFreeze_&&rL(i,!0),n){let a=[],o=[];Yy("Patches").generateReplacementPatches_(t,i,a,o),n(a,o)}return i}else Vu(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(o,...s)=>this.produceWithPatches(o,l=>t(l,...s));let n,i;return[this.produce(t,r,(o,s)=>{n=o,i=s}),n,i]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Gu(e)||Vu(8),Cf(e)&&(e=dl(e));let t=Oae(this),r=HR(e,void 0);return r[Qc].isManual_=!0,RR(t),r}finishDraft(e,t){let r=e&&e[Qc];(!r||!r.isManual_)&&Vu(9);let{scope_:n}=r;return Fae(n,t),zae(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){let i=t[r];if(i.path.length===0&&i.op==="replace"){e=i.value;break}}r>-1&&(t=t.slice(r+1));let n=Yy("Patches").applyPatches_;return Cf(e)?n(e,t):this.produce(e,i=>n(i,t))}};Xc=new Aje,j1=Xc.produce,Tbt=Xc.produceWithPatches.bind(Xc),Cbt=Xc.setAutoFreeze.bind(Xc),Pbt=Xc.setUseStrictShallowCopy.bind(Xc),Dbt=Xc.applyPatches.bind(Xc),Ebt=Xc.createDraft.bind(Xc),Ibt=Xc.finishDraft.bind(Xc)});function Hae(e){return({dispatch:r,getState:n})=>i=>a=>typeof a=="function"?a(r,n,e):i(a)}var qae,Vae,Gae=F(()=>{qae=Hae(),Vae=Hae});function Jo(e,t){function r(...n){if(t){let i=t(...n);if(!i)throw new Error(Zc(0));return{type:e,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>KA(n)&&n.type===e,r}function Yae(e){return Gu(e)?j1(e,()=>{}):e}function aL(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function Fje(e){return typeof e=="boolean"}function noe(e){let t=Oje(),{reducer:r=void 0,middleware:n,devTools:i=!0,duplicateMiddlewareCheck:a=!0,preloadedState:o=void 0,enhancers:s=void 0}=e||{},l;if(typeof r=="function")l=r;else if(GA(r))l=YA(r);else throw new Error(Zc(1));let c;typeof n=="function"?c=n(t):c=t();let d=$0;i&&(d=Lje({trace:!1,...typeof i=="object"&&i}));let u=Lae(...c),p=zje(u),m=typeof s=="function"?s(p):p(),g=d(...m);return zR(l,o,g)}function ioe(e){let t={},r=[],n,i={addCase(a,o){let s=typeof a=="string"?a:a.type;if(!s)throw new Error(Zc(28));if(s in t)throw new Error(Zc(29));return t[s]=o,i},addMatcher(a,o){return r.push({matcher:a,reducer:o}),i},addDefaultCase(a){return n=a,i}};return e(i),[t,r,n]}function jje(e){return typeof e=="function"}function _je(e,t){let[r,n,i]=ioe(t),a;if(jje(e))a=()=>Yae(e());else{let s=Yae(e);a=()=>s}function o(s=a(),l){let c=[r[l.type],...n.filter(({matcher:d})=>d(l)).map(({reducer:d})=>d)];return c.filter(d=>!!d).length===0&&(c=[i]),c.reduce((d,u)=>{if(u)if(Cf(d)){let m=u(d,l);return m===void 0?d:m}else{if(Gu(d))return j1(d,p=>u(p,l));{let p=u(d,l);if(p===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return p}}return d},s)}return o.getInitialState=a,o}function Wje(...e){return t=>e.some(r=>Bje(r,t))}function qje(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}function Vje(e){return e!==null&&typeof e=="object"&&typeof e.then=="function"}function Gje(e,t){return`${e}/${t}`}function Yje({creators:e}={}){var r;let t=(r=e==null?void 0:e.asyncThunk)==null?void 0:r[ooe];return function(i){let{name:a,reducerPath:o=a}=i;if(!a)throw new Error(Zc(11));let s=(typeof i.reducers=="function"?i.reducers(Jje()):i.reducers)||{},l=Object.keys(s),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(k,x){let S=typeof k=="string"?k:k.type;if(!S)throw new Error(Zc(12));if(S in c.sliceCaseReducersByType)throw new Error(Zc(13));return c.sliceCaseReducersByType[S]=x,d},addMatcher(k,x){return c.sliceMatchers.push({matcher:k,reducer:x}),d},exposeAction(k,x){return c.actionCreators[k]=x,d},exposeCaseReducer(k,x){return c.sliceCaseReducersByName[k]=x,d}};l.forEach(k=>{let x=s[k],S={reducerName:k,type:Gje(a,k),createNotation:typeof i.reducers=="function"};Xje(x)?e5e(S,x,d,t):Qje(S,x,d)});function u(){let[k={},x=[],S=void 0]=typeof i.extraReducers=="function"?ioe(i.extraReducers):[i.extraReducers],w={...k,...c.sliceCaseReducersByType};return _je(i.initialState,C=>{for(let D in w)C.addCase(D,w[D]);for(let D of c.sliceMatchers)C.addMatcher(D.matcher,D.reducer);for(let D of x)C.addMatcher(D.matcher,D.reducer);S&&C.addDefaultCase(S)})}let p=k=>k,m=new Map,g=new WeakMap,f;function v(k,x){return f||(f=u()),f(k,x)}function h(){return f||(f=u()),f.getInitialState()}function y(k,x=!1){function S(C){let D=C[k];return typeof D=="undefined"&&x&&(D=aL(g,S,h)),D}function w(C=p){let D=aL(m,x,()=>new WeakMap);return aL(D,C,()=>{var M;let P={};for(let[z,A]of Object.entries((M=i.selectors)!=null?M:{}))P[z]=Kje(A,C,()=>aL(g,C,h),x);return P})}return{reducerPath:k,getSelectors:w,get selectors(){return w(S)},selectSlice:S}}let b={name:a,reducer:v,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:h,...y(o),injectInto(k,{reducerPath:x,...S}={}){let w=x!=null?x:o;return k.inject({reducerPath:w,reducer:v},S),{...b,...y(w,!0)}}};return b}}function Kje(e,t,r,n){function i(a,...o){let s=t(a);return typeof s=="undefined"&&n&&(s=r()),e(s,...o)}return i.unwrapped=e,i}function Jje(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function Qje({type:e,reducerName:t,createNotation:r},n,i){let a,o;if("reducer"in n){if(r&&!Zje(n))throw new Error(Zc(17));a=n.reducer,o=n.prepare}else a=n;i.addCase(e,a).exposeCaseReducer(t,a).exposeAction(t,o?Jo(e,o):Jo(e))}function Xje(e){return e._reducerDefinitionType==="asyncThunk"}function Zje(e){return e._reducerDefinitionType==="reducerWithPrepare"}function e5e({type:e,reducerName:t},r,n,i){if(!i)throw new Error(Zc(18));let{payloadCreator:a,fulfilled:o,pending:s,rejected:l,settled:c,options:d}=r,u=i(e,a,d);n.exposeAction(t,u),o&&n.addCase(u.fulfilled,o),s&&n.addCase(u.pending,s),l&&n.addCase(u.rejected,l),c&&n.addMatcher(u.settled,c),n.exposeCaseReducer(t,{fulfilled:o||oL,pending:s||oL,rejected:l||oL,settled:c||oL})}function oL(){}function uoe(e,t){let r=sL;return new Promise((n,i)=>{let a=()=>i(new cL(e.reason));if(e.aborted){a();return}r=doe(e,a),t.finally(()=>r()).then(n,i)}).finally(()=>{r=sL})}function Zc(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Lje,jbt,Nje,toe,Oje,roe,bi,Kae,KR,zje,Bje,$je,aoe,Rje,VR,Jae,Uje,Qae,Hje,ooe,Rbt,Pi,t5e,soe,loe,JR,r5e,n5e,GR,i5e,cL,QR,sL,coe,doe,Ky,Jy,a5e,lL,poe,H0,Xae,dL,o5e,s5e,moe,foe,Zae,YR,l5e,eoe,goe,c5e,hoe,d5e,Pf,Lo=F(()=>{R0();iL();R0();R0();Gae();R0();iL();iL();R0();Lje=typeof window!="undefined"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?$0:$0.apply(null,arguments)},jbt=typeof window!="undefined"&&window.__REDUX_DEVTOOLS_EXTENSION__?window.__REDUX_DEVTOOLS_EXTENSION__:function(){return function(e){return e}},Nje=e=>e&&typeof e.match=="function";toe=class _1 extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,_1.prototype)}static get[Symbol.species](){return _1}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new _1(...t[0].concat(this)):new _1(...t.concat(this))}};Oje=()=>function(t){let{thunk:r=!0,immutableCheck:n=!0,serializableCheck:i=!0,actionCreatorCheck:a=!0}=t!=null?t:{},o=new toe;return r&&(Fje(r)?o.push(qae):o.push(Vae(r.extraArgument))),o},roe="RTK_autoBatch",bi=()=>e=>({payload:e,meta:{[roe]:!0}}),Kae=e=>t=>{setTimeout(t,e)},KR=(e={type:"raf"})=>t=>(...r)=>{let n=t(...r),i=!0,a=!1,o=!1,s=new Set,l=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window!="undefined"&&window.requestAnimationFrame?window.requestAnimationFrame:Kae(10):e.type==="callback"?e.queueNotification:Kae(e.timeout),c=()=>{o=!1,a&&(a=!1,s.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){let u=()=>i&&d(),p=n.subscribe(u);return s.add(d),()=>{p(),s.delete(d)}},dispatch(d){var u;try{return i=!((u=d==null?void 0:d.meta)!=null&&u[roe]),a=!i,a&&(o||(o=!0,l(c))),n.dispatch(d)}finally{i=!0}}})},zje=e=>function(r){let{autoBatch:n=!0}=r!=null?r:{},i=new toe(e);return n&&i.push(KR(typeof n=="object"?n:void 0)),i};Bje=(e,t)=>Nje(e)?e.match(t):e(t);$je="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",aoe=(e=21)=>{let t="",r=e;for(;r--;)t+=$je[Math.random()*64|0];return t},Rje=["name","message","stack","code"],VR=class{constructor(e,t){sx(this,"_type");this.payload=e,this.meta=t}},Jae=class{constructor(e,t){sx(this,"_type");this.payload=e,this.meta=t}},Uje=e=>{if(typeof e=="object"&&e!==null){let t={};for(let r of Rje)typeof e[r]=="string"&&(t[r]=e[r]);return t}return{message:String(e)}},Qae="External signal was aborted",Hje=(()=>{function e(t,r,n){let i=Jo(t+"/fulfilled",(l,c,d,u)=>({payload:l,meta:{...u||{},arg:d,requestId:c,requestStatus:"fulfilled"}})),a=Jo(t+"/pending",(l,c,d)=>({payload:void 0,meta:{...d||{},arg:c,requestId:l,requestStatus:"pending"}})),o=Jo(t+"/rejected",(l,c,d,u,p)=>({payload:u,error:(n&&n.serializeError||Uje)(l||"Rejected"),meta:{...p||{},arg:d,requestId:c,rejectedWithValue:!!u,requestStatus:"rejected",aborted:(l==null?void 0:l.name)==="AbortError",condition:(l==null?void 0:l.name)==="ConditionError"}}));function s(l,{signal:c}={}){return(d,u,p)=>{let m=n!=null&&n.idGenerator?n.idGenerator(l):aoe(),g=new AbortController,f,v;function h(b){v=b,g.abort()}c&&(c.aborted?h(Qae):c.addEventListener("abort",()=>h(Qae),{once:!0}));let y=(async function(){var x,S;let b;try{let w=(x=n==null?void 0:n.condition)==null?void 0:x.call(n,l,{getState:u,extra:p});if(Vje(w)&&(w=await w),w===!1||g.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};let C=new Promise((D,P)=>{f=()=>{P({name:"AbortError",message:v||"Aborted"})},g.signal.addEventListener("abort",f)});d(a(m,l,(S=n==null?void 0:n.getPendingMeta)==null?void 0:S.call(n,{requestId:m,arg:l},{getState:u,extra:p}))),b=await Promise.race([C,Promise.resolve(r(l,{dispatch:d,getState:u,extra:p,requestId:m,signal:g.signal,abort:h,rejectWithValue:(D,P)=>new VR(D,P),fulfillWithValue:(D,P)=>new Jae(D,P)})).then(D=>{if(D instanceof VR)throw D;return D instanceof Jae?i(D.payload,m,l,D.meta):i(D,m,l)})])}catch(w){b=w instanceof VR?o(null,m,l,w.payload,w.meta):o(w,m,l)}finally{f&&g.signal.removeEventListener("abort",f)}return n&&!n.dispatchConditionRejection&&o.match(b)&&b.meta.condition||d(b),b})();return Object.assign(y,{abort:h,requestId:m,arg:l,unwrap(){return y.then(qje)}})}}return Object.assign(s,{pending:a,rejected:o,fulfilled:i,settled:Wje(o,i),typePrefix:t})}return e.withTypes=()=>e,e})();ooe=Symbol.for("rtk-slice-createasyncthunk"),Rbt={[ooe]:Hje};Pi=Yje();t5e="task",soe="listener",loe="completed",JR="cancelled",r5e=`task-${JR}`,n5e=`task-${loe}`,GR=`${soe}-${JR}`,i5e=`${soe}-${loe}`,cL=class{constructor(e){sx(this,"name","TaskAbortError");sx(this,"message");this.code=e,this.message=`${t5e} ${JR} (reason: ${e})`}},QR=(e,t)=>{if(typeof e!="function")throw new TypeError(Zc(32))},sL=()=>{},coe=(e,t=sL)=>(e.catch(t),e),doe=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Ky=(e,t)=>{let r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},Jy=e=>{if(e.aborted){let{reason:t}=e;throw new cL(t)}};a5e=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof cL?"cancelled":"rejected",error:r}}finally{t==null||t()}},lL=e=>t=>coe(uoe(e,t).then(r=>(Jy(e),r))),poe=e=>{let t=lL(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:H0}=Object,Xae={},dL="listenerMiddleware",o5e=(e,t)=>{let r=n=>doe(e,()=>Ky(n,e.reason));return(n,i)=>{QR(n,"taskExecutor");let a=new AbortController;r(a);let o=a5e(async()=>{Jy(e),Jy(a.signal);let s=await n({pause:lL(a.signal),delay:poe(a.signal),signal:a.signal});return Jy(a.signal),s},()=>Ky(a,n5e));return i!=null&&i.autoJoin&&t.push(o.catch(sL)),{result:lL(e)(o),cancel(){Ky(a,r5e)}}}},s5e=(e,t)=>{let r=async(n,i)=>{Jy(t);let a=()=>{},s=[new Promise((l,c)=>{let d=e({predicate:n,effect:(u,p)=>{p.unsubscribe(),l([u,p.getState(),p.getOriginalState()])}});a=()=>{d(),c()}})];i!=null&&s.push(new Promise(l=>setTimeout(l,i,null)));try{let l=await uoe(t,Promise.race(s));return Jy(t),l}finally{a()}};return(n,i)=>coe(r(n,i))},moe=e=>{let{type:t,actionCreator:r,matcher:n,predicate:i,effect:a}=e;if(t)i=Jo(t).match;else if(r)t=r.type,i=r.match;else if(n)i=n;else if(!i)throw new Error(Zc(21));return QR(a,"options.listener"),{predicate:i,type:t,effect:a}},foe=H0(e=>{let{type:t,predicate:r,effect:n}=moe(e);return{id:aoe(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Zc(22))}}},{withTypes:()=>foe}),Zae=(e,t)=>{let{type:r,effect:n,predicate:i}=moe(t);return Array.from(e.values()).find(a=>(typeof r=="string"?a.type===r:a.predicate===i)&&a.effect===n)},YR=e=>{e.pending.forEach(t=>{Ky(t,GR)})},l5e=e=>()=>{e.forEach(YR),e.clear()},eoe=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},goe=H0(Jo(`${dL}/add`),{withTypes:()=>goe}),c5e=Jo(`${dL}/removeAll`),hoe=H0(Jo(`${dL}/remove`),{withTypes:()=>hoe}),d5e=(...e)=>{console.error(`${dL}/error`,...e)},Pf=(e={})=>{let t=new Map,{extra:r,onError:n=d5e}=e;QR(n,"onError");let i=d=>(d.unsubscribe=()=>t.delete(d.id),t.set(d.id,d),u=>{d.unsubscribe(),u!=null&&u.cancelActive&&YR(d)}),a=d=>{var p;let u=(p=Zae(t,d))!=null?p:foe(d);return i(u)};H0(a,{withTypes:()=>a});let o=d=>{let u=Zae(t,d);return u&&(u.unsubscribe(),d.cancelActive&&YR(u)),!!u};H0(o,{withTypes:()=>o});let s=async(d,u,p,m)=>{let g=new AbortController,f=s5e(a,g.signal),v=[];try{d.pending.add(g),await Promise.resolve(d.effect(u,H0({},p,{getOriginalState:m,condition:(h,y)=>f(h,y).then(Boolean),take:f,delay:poe(g.signal),pause:lL(g.signal),extra:r,signal:g.signal,fork:o5e(g.signal,v),unsubscribe:d.unsubscribe,subscribe:()=>{t.set(d.id,d)},cancelActiveListeners:()=>{d.pending.forEach((h,y,b)=>{h!==g&&(Ky(h,GR),b.delete(h))})},cancel:()=>{Ky(g,GR),d.pending.delete(g)},throwIfCancelled:()=>{Jy(g.signal)}})))}catch(h){h instanceof cL||eoe(n,h,{raisedBy:"effect"})}finally{await Promise.all(v),Ky(g,i5e),d.pending.delete(g)}},l=l5e(t);return{middleware:d=>u=>p=>{if(!KA(p))return u(p);if(goe.match(p))return a(p.payload);if(c5e.match(p)){l();return}if(hoe.match(p))return o(p.payload);let m=d.getState(),g=()=>{if(m===Xae)throw new Error(Zc(23));return m},f;try{if(f=u(p),t.size>0){let v=d.getState(),h=Array.from(t.values());for(let y of h){let b=!1;try{b=y.predicate(p,v,m)}catch(k){b=!1,eoe(n,k,{raisedBy:"predicate"})}b&&s(y,p,d,g)}}}finally{m=Xae}return f},startListening:a,stopListening:o,clearListeners:l}}});var u5e,voe,XR,yoe,boe,xoe,woe,B1=F(()=>{Lo();u5e={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},voe=Pi({name:"chartLayout",initialState:u5e,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,i,a;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(i=t.payload.bottom)!==null&&i!==void 0?i:0,e.margin.left=(a=t.payload.left)!==null&&a!==void 0?a:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:XR,setLayout:yoe,setChartSize:boe,setScale:xoe}=voe.actions,woe=voe.reducer});function uL(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}var ZR=F(()=>{});function Lr(e){return Number.isFinite(e)}function Df(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}var Rl=F(()=>{});function koe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function q0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?koe(Object(r),!0).forEach(function(n){p5e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):koe(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function p5e(e,t,r){return(t=m5e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m5e(e){var t=f5e(e,"string");return typeof t=="symbol"?t:t+""}function f5e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fn(e,t,r){return Or(e)||Or(t)?r:gs(t)?(0,Coe.default)(e,t,r):typeof t=="function"?t(e):r}function pL(e){return e==null?void 0:String(e)}function V0(e){var{axis:t,ticks:r,bandSize:n,entry:i,index:a,dataKey:o}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Or(i[t.dataKey])){var s=AA(r,"value",i[t.dataKey]);if(s)return s.coordinate+n/2}return r[a]?r[a].coordinate+n/2:null}var l=fn(i,Or(o)?t.dataKey:o);return Or(l)?null:t.scale(l)}function a6(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:i,name:a}=e;return q0(q0({},t),{},{dataKey:r,payload:n,value:i,name:a})}function Rd(e,t){if(e)return String(e);if(typeof t=="string")return t}var Toe,Coe,Poe,ul,e6,t6,Soe,Doe,Eoe,g5e,h5e,v5e,Ioe,r6,Moe,y5e,b5e,Aoe,n6,i6,Ul,Loe,Noe,Ja=F(()=>{Toe=Y(F1()),Coe=Y(I1());EA();wr();ZR();Rl();Poe=(e,t,r)=>{if(t&&r){var{width:n,height:i}=r,{align:a,verticalAlign:o,layout:s}=t;if((s==="vertical"||s==="horizontal"&&o==="middle")&&a!=="center"&&at(e[a]))return q0(q0({},e),{},{[a]:e[a]+(n||0)});if((s==="horizontal"||s==="vertical"&&a==="center")&&o!=="middle"&&at(e[o]))return q0(q0({},e),{},{[o]:e[o]+(i||0)})}return e},ul=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",e6=(e,t,r,n)=>{if(n)return e.map(s=>s.coordinate);var i,a,o=e.map(s=>(s.coordinate===t&&(i=!0),s.coordinate===r&&(a=!0),s.coordinate));return i||o.push(t),a||o.push(r),o},t6=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:i,range:a,scale:o,realScaleType:s,isCategorical:l,categoricalDomain:c,tickCount:d,ticks:u,niceTicks:p,axisType:m}=e;if(!o)return null;var g=s==="scaleBand"&&o.bandwidth?o.bandwidth()/2:2,f=(t||r)&&i==="category"&&o.bandwidth?o.bandwidth()/g:0;if(f=m==="angleAxis"&&a&&a.length>=2?Va(a[0]-a[1])*2*f:f,t&&(u||p)){var v=(u||p||[]).map((h,y)=>{var b=n?n.indexOf(h):h;return{coordinate:o(b)+f,value:h,offset:f,index:y}});return v.filter(h=>!Ga(h.coordinate))}return l&&c?c.map((h,y)=>({coordinate:o(h)+f,value:h,index:y,offset:f})):o.ticks&&!r&&d!=null?o.ticks(d).map((h,y)=>({coordinate:o(h)+f,value:h,offset:f,index:y})):o.domain().map((h,y)=>({coordinate:o(h)+f,value:n?n[h]:h,index:y,offset:f}))},Soe=1e-4,Doe=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),i=Math.min(n[0],n[1])-Soe,a=Math.max(n[0],n[1])+Soe,o=e(t[0]),s=e(t[r-1]);(o<i||o>a||s<i||s>a)&&e.domain([t[0],t[r-1]])}},Eoe=(e,t)=>{if(!t||t.length!==2||!at(t[0])||!at(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),i=[e[0],e[1]];return(!at(e[0])||e[0]<r)&&(i[0]=r),(!at(e[1])||e[1]>n)&&(i[1]=n),i[0]>n&&(i[0]=n),i[1]<r&&(i[1]=r),i},g5e=e=>{var t,r=e.length;if(!(r<=0)){var n=(t=e[0])===null||t===void 0?void 0:t.length;if(!(n==null||n<=0))for(var i=0;i<n;++i)for(var a=0,o=0,s=0;s<r;++s){var l=e[s],c=l==null?void 0:l[i];if(c!=null){var d=c[1],u=c[0],p=Ga(d)?u:d;p>=0?(c[0]=a,c[1]=a+p,a=d):(c[0]=o,c[1]=o+p,o=d)}}}},h5e=e=>{var t,r=e.length;if(!(r<=0)){var n=(t=e[0])===null||t===void 0?void 0:t.length;if(!(n==null||n<=0))for(var i=0;i<n;++i)for(var a=0,o=0;o<r;++o){var s=e[o],l=s==null?void 0:s[i];if(l!=null){var c=Ga(l[1])?l[0]:l[1];c>=0?(l[0]=a,l[1]=a+c,a=l[1]):(l[0]=0,l[1]=0)}}}},v5e={sign:g5e,expand:C$,none:Jc,silhouette:P$,wiggle:D$,positive:h5e},Ioe=(e,t,r)=>{var n,i=(n=v5e[r])!==null&&n!==void 0?n:Jc,a=T$().keys(t).value((s,l)=>Number(fn(s,l,0))).order(z0).offset(i),o=a(e);return o.forEach((s,l)=>{s.forEach((c,d)=>{var u=fn(e[d],t[l],0);Array.isArray(u)&&u.length===2&&at(u[0])&&at(u[1])&&(c[0]=u[0],c[1]=u[1])})}),o};r6=e=>{var{axis:t,ticks:r,offset:n,bandSize:i,entry:a,index:o}=e;if(t.type==="category")return r[o]?r[o].coordinate+n:null;var s=fn(a,t.dataKey,t.scale.domain()[o]);return Or(s)?null:t.scale(s)-i/2+n},Moe=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]);return n<=0&&i>=0?0:i<0?i:n}return r[0]},y5e=e=>{var t=e.flat(2).filter(at);return[Math.min(...t),Math.max(...t)]},b5e=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],Aoe=(e,t,r)=>{if(e!=null)return b5e(Object.keys(e).reduce((n,i)=>{var a=e[i];if(!a)return n;var{stackedData:o}=a,s=o.reduce((l,c)=>{var d=uL(c,t,r),u=y5e(d);return!Lr(u[0])||!Lr(u[1])?l:[Math.min(l[0],u[0]),Math.max(l[1],u[1])]},[1/0,-1/0]);return[Math.min(s[0],n[0]),Math.max(s[1],n[1])]},[1/0,-1/0]))},n6=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,i6=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Ul=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var i=(0,Toe.default)(t,d=>d.coordinate),a=1/0,o=1,s=i.length;o<s;o++){var l=i[o],c=i[o-1];a=Math.min(((l==null?void 0:l.coordinate)||0)-((c==null?void 0:c.coordinate)||0),a)}return a===1/0?0:a}return r?void 0:0};Loe=(e,t)=>{if(t==="horizontal")return e.chartX;if(t==="vertical")return e.chartY},Noe=(e,t)=>t==="centric"?e.angle:e.radius});var pl,ml,Foe,mL,Qp=F(()=>{pl=e=>e.layout.width,ml=e=>e.layout.height,Foe=e=>e.layout.scale,mL=e=>e.layout.margin});var G0,Y0,o6=F(()=>{Ka();G0=de(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),Y0=de(e=>e.cartesianAxis.yAxis,e=>Object.values(e))});var Ooe,zoe,Qy,fL=F(()=>{Ooe="data-recharts-item-index",zoe="data-recharts-item-id",Qy=60});function joe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function gL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?joe(Object(r),!0).forEach(function(n){x5e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):joe(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function x5e(e,t,r){return(t=w5e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w5e(e){var t=k5e(e,"string");return typeof t=="symbol"?t:t+""}function k5e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function T5e(e){var t=Y0(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var i=typeof n.width=="number"?n.width:Qy;return r+i}return r},0)}function C5e(e){var t=Y0(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var i=typeof n.width=="number"?n.width:Qy;return r+i}return r},0)}function P5e(e){var t=G0(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function D5e(e){var t=G0(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var S5e,ji,_oe,K0,Ud=F(()=>{Ka();NR();Ja();Qp();o6();fL();S5e=e=>e.brush.height;ji=de([pl,ml,mL,S5e,T5e,C5e,P5e,D5e,LR,Dae],(e,t,r,n,i,a,o,s,l,c)=>{var d={left:(r.left||0)+i,right:(r.right||0)+a},u={top:(r.top||0)+o,bottom:(r.bottom||0)+s},p=gL(gL({},u),d),m=p.bottom;p.bottom+=n,p=Poe(p,l,c);var g=e-p.left-p.right,f=t-p.top-p.bottom;return gL(gL({brushBottom:m},p),{},{width:Math.max(g,0),height:Math.max(f,0)})}),_oe=de(ji,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),K0=de(pl,ml,(e,t)=>({x:0,y:0,width:e,height:t}))});var E5e,hL,I5e,Qr,hs=F(()=>{E5e=Y(Q()),hL=Y(Q()),I5e=(0,hL.createContext)(null),Qr=()=>(0,hL.useContext)(I5e)!=null});var J0,Xy,vL=F(()=>{Ka();Ud();Qp();wr();J0=e=>e.brush,Xy=de([J0,ji,mL],(e,t,r)=>({height:e.height,x:at(e.x)?e.x:t.left,y:at(e.y)?e.y:t.top+t.height+t.brushBottom-((r==null?void 0:r.bottom)||0),width:at(e.width)?e.width:t.width}))});var M5e,s6,Boe=F(()=>{M5e=!0,s6=function(t,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a];if(M5e&&typeof console!="undefined"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!t))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var o=0;console.warn(r.replace(/%s/g,()=>i[o++]))}}});var A5e,Yu,L5e,yL,l6=F(()=>{Zn();A5e=Y(Q()),Yu=Y(Q()),L5e=(0,Yu.createContext)({width:-1,height:-1}),yL=()=>(0,Yu.useContext)(L5e)});function c6(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var Woe,Ef,N5e,bL,Q0,X0,$oe,Jt,xc,Roe,Uoe,Z0,xi=F(()=>{Woe=Y(Q());Jr();B1();Ud();Qp();hs();vL();l6();Rl();Ef=()=>{var e,t=Qr(),r=je(_oe),n=je(Xy),i=(e=je(J0))===null||e===void 0?void 0:e.padding;return!t||!n||!i?r:{width:n.width-i.left-i.right,height:n.height-i.top-i.bottom,x:i.left,y:i.top}},N5e={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},bL=()=>{var e;return(e=je(ji))!==null&&e!==void 0?e:N5e},Q0=()=>je(pl),X0=()=>je(ml),$oe=()=>je(e=>e.layout.margin),Jt=e=>e.layout.layoutType,xc=()=>je(Jt),Roe=()=>{var e=xc();if(e==="horizontal"||e==="vertical")return e},Uoe=()=>{var e=xc();return e!==void 0},Z0=e=>{var t=lr(),r=Qr(),{width:n,height:i}=e,a=yL(),o=n,s=i;return a&&(o=a.width>0?a.width:n,s=a.height>0?a.height:i),(0,Woe.useEffect)(()=>{!r&&Df(o)&&Df(s)&&t(boe({width:o,height:s}))},[t,r,o,s]),null}});var F5e,Hoe,d6,qoe,u6,p6,m6,Voe,xL=F(()=>{Lo();F5e={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},Hoe=Pi({name:"legend",initialState:F5e,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:bi()},replaceLegendPayload:{reducer(e,t){var{prev:r,next:n}=t.payload,i=dl(e).payload.indexOf(r);i>-1&&(e.payload[i]=n)},prepare:bi()},removeLegendPayload:{reducer(e,t){var r=dl(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)},prepare:bi()}}}),{setLegendSize:d6,setLegendSettings:qoe,addLegendPayload:u6,replaceLegendPayload:p6,removeLegendPayload:m6}=Hoe.actions,Voe=Hoe.reducer});function f6(){return f6=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},f6.apply(null,arguments)}function Goe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ew(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Goe(Object(r),!0).forEach(function(n){z5e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Goe(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function z5e(e,t,r){return(t=j5e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function j5e(e){var t=_5e(e,"string");return typeof t=="symbol"?t:t+""}function _5e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function B5e(e,t){if(e==null)return{};var r,n,i=W5e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function W5e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function $5e(e){return e.value}function R5e(e){var{contextPayload:t}=e,r=B5e(e,O5e),n=BA(t,e.payloadUniqBy,$5e),i=ew(ew({},r),{},{payload:n});return Ku.isValidElement(e.content)?Ku.cloneElement(e.content,i):typeof e.content=="function"?Ku.createElement(e.content,i):Ku.createElement(zie,i)}function U5e(e,t,r,n,i,a){var{layout:o,align:s,verticalAlign:l}=t,c,d;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(s==="center"&&o==="vertical"?c={left:((n||0)-a.width)/2}:c=s==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(l==="middle"?d={top:((i||0)-a.height)/2}:d=l==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),ew(ew({},c),d)}function H5e(e){var t=lr();return(0,g6.useEffect)(()=>{t(qoe(e))},[t,e]),null}function q5e(e){var t=lr();return(0,g6.useEffect)(()=>(t(d6(e)),()=>{t(d6({width:0,height:0}))}),[t,e]),null}function V5e(e,t,r,n){return e==="vertical"&&at(t)?{height:t}:e==="horizontal"?{width:r||n}:null}function wL(e){var t=pr(e,G5e),r=Iae(),n=Bne(),i=$oe(),{width:a,height:o,wrapperStyle:s,portal:l}=t,[c,d]=qA([r]),u=Q0(),p=X0();if(u==null||p==null)return null;var m=u-((i==null?void 0:i.left)||0)-((i==null?void 0:i.right)||0),g=V5e(t.layout,o,a,m),f=l?s:ew(ew({position:"absolute",width:(g==null?void 0:g.width)||a||"auto",height:(g==null?void 0:g.height)||o||"auto"},U5e(s,t,i,u,p,c)),s),v=l!=null?l:n;if(v==null||r==null)return null;var h=Ku.createElement("div",{className:"recharts-legend-wrapper",style:f,ref:d},Ku.createElement(H5e,{layout:t.layout,align:t.align,verticalAlign:t.verticalAlign,itemSorter:t.itemSorter}),!l&&Ku.createElement(q5e,{width:c.width,height:c.height}),Ku.createElement(R5e,f6({},t,g,{margin:i,chartWidth:u,chartHeight:p,contextPayload:r})));return(0,Yoe.createPortal)(h,v)}var Ku,g6,Yoe,O5e,G5e,Koe=F(()=>{Ku=Y(Q()),g6=Y(Q()),Yoe=Y(Td());Y4();jie();wr();bR();Mae();FR();xi();xL();Jr();ma();O5e=["contextPayload"];G5e={align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"};wL.displayName="Legend"});function v6(){return v6=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},v6.apply(null,arguments)}function Joe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function h6(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Joe(Object(r),!0).forEach(function(n){Y5e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Joe(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Y5e(e,t,r){return(t=K5e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K5e(e){var t=J5e(e,"string");return typeof t=="symbol"?t:t+""}function J5e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Q5e(e){return Array.isArray(e)&&gs(e[0])&&gs(e[1])?e.join(" ~ "):e}var Ju,Qoe,Xoe,Zoe=F(()=>{Ju=Y(Q()),Qoe=Y(F1());Zn();wr();Xoe=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:i={},payload:a,formatter:o,itemSorter:s,wrapperClassName:l,labelClassName:c,label:d,labelFormatter:u,accessibilityLayer:p=!1}=e,m=()=>{if(a&&a.length){var x={padding:0,margin:0},S=(s?(0,Qoe.default)(a,s):a).map((w,C)=>{if(w.type==="none")return null;var D=w.formatter||o||Q5e,{value:P,name:M}=w,z=P,A=M;if(D){var I=D(P,M,w,C,a);if(Array.isArray(I))[z,A]=I;else if(I!=null)z=I;else return null}var L=h6({display:"block",paddingTop:4,paddingBottom:4,color:w.color||"#000"},n);return Ju.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(C),style:L},gs(A)?Ju.createElement("span",{className:"recharts-tooltip-item-name"},A):null,gs(A)?Ju.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,Ju.createElement("span",{className:"recharts-tooltip-item-value"},z),Ju.createElement("span",{className:"recharts-tooltip-item-unit"},w.unit||""))});return Ju.createElement("ul",{className:"recharts-tooltip-item-list",style:x},S)}return null},g=h6({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),f=h6({margin:0},i),v=!Or(d),h=v?d:"",y=wt("recharts-default-tooltip",l),b=wt("recharts-tooltip-label",c);v&&u&&a!==void 0&&a!==null&&(h=u(d,a));var k=p?{role:"status","aria-live":"assertive"}:{};return Ju.createElement("div",v6({className:y,style:g},k),Ju.createElement("p",{className:b,style:f},Ju.isValidElement(h)?h:"".concat(h)),m())}});function Z5e(e){var{coordinate:t,translateX:r,translateY:n}=e;return wt(W1,{["".concat(W1,"-right")]:at(r)&&t&&at(t.x)&&r>=t.x,["".concat(W1,"-left")]:at(r)&&t&&at(t.x)&&r<t.x,["".concat(W1,"-bottom")]:at(n)&&t&&at(t.y)&&n>=t.y,["".concat(W1,"-top")]:at(n)&&t&&at(t.y)&&n<t.y})}function ese(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:i,position:a,reverseDirection:o,tooltipDimension:s,viewBox:l,viewBoxDimension:c}=e;if(a&&at(a[n]))return a[n];var d=r[n]-s-(i>0?i:0),u=r[n]+i;if(t[n])return o[n]?d:u;var p=l[n];if(p==null)return 0;if(o[n]){var m=d,g=p;return m<g?Math.max(u,p):Math.max(d,p)}if(c==null)return 0;var f=u+s,v=p+c;return f>v?Math.max(d,p):Math.max(u,p)}function e_e(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function tse(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:i,reverseDirection:a,tooltipBox:o,useTranslate3d:s,viewBox:l}=e,c,d,u;return o.height>0&&o.width>0&&r?(d=ese({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:i,reverseDirection:a,tooltipDimension:o.width,viewBox:l,viewBoxDimension:l.width}),u=ese({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:i,reverseDirection:a,tooltipDimension:o.height,viewBox:l,viewBoxDimension:l.height}),c=e_e({translateX:d,translateY:u,useTranslate3d:s})):c=X5e,{cssProperties:c,cssClasses:Z5e({translateX:d,translateY:u,coordinate:r})}}var W1,X5e,rse=F(()=>{Zn();wr();W1="recharts-tooltip-wrapper",X5e={visibility:"hidden"}});function nse(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function kL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nse(Object(r),!0).forEach(function(n){y6(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nse(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function y6(e,t,r){return(t=t_e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function t_e(e){var t=r_e(e,"string");return typeof t=="symbol"?t:t+""}function r_e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ise,ase,SL,ose=F(()=>{ise=Y(Q()),ase=Y(Q());rse();SL=class extends ase.PureComponent{constructor(){super(...arguments),y6(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),y6(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,i,a;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(i=(a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==null&&i!==void 0?i:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:i,children:a,coordinate:o,hasPayload:s,isAnimationActive:l,offset:c,position:d,reverseDirection:u,useTranslate3d:p,viewBox:m,wrapperStyle:g,lastBoundingBox:f,innerRef:v,hasPortalFromProps:h}=this.props,{cssClasses:y,cssProperties:b}=tse({allowEscapeViewBox:r,coordinate:o,offsetTopLeft:c,position:d,reverseDirection:u,tooltipBox:{height:f.height,width:f.width},useTranslate3d:p,viewBox:m}),k=h?{}:kL(kL({transition:l&&t?"transform ".concat(n,"ms ").concat(i):void 0},b),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&s?"visible":"hidden",position:"absolute",top:0,left:0}),x=kL(kL({},k),{},{visibility:!this.state.dismissed&&t&&s?"visible":"hidden"},g);return ise.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:y,style:x,ref:v},a)}}});var TL,b6=F(()=>{Jr();TL=()=>{var e;return(e=je(t=>t.rootProps.accessibilityLayer))!==null&&e!==void 0?e:!0}});function x6(){return x6=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},x6.apply(null,arguments)}function sse(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function lse(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sse(Object(r),!0).forEach(function(n){n_e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sse(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function n_e(e,t,r){return(t=i_e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i_e(e){var t=a_e(e,"string");return typeof t=="symbol"?t:t+""}function a_e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var use,cse,CL,dse,$1,R1,o_e,s_e,Sh,PL=F(()=>{use=Y(Q());EA();Zn();qu();wr();Rl();js();xi();cse={curveBasisClosed:m$,curveBasisOpen:f$,curveBasis:p$,curveBumpX:e$,curveBumpY:t$,curveLinearClosed:g$,curveLinear:wh,curveMonotoneX:v$,curveMonotoneY:y$,curveNatural:b$,curveStep:x$,curveStepAfter:k$,curveStepBefore:w$},CL=e=>Lr(e.x)&&Lr(e.y),dse=e=>e.base!=null&&CL(e.base)&&CL(e),$1=e=>e.x,R1=e=>e.y,o_e=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(kh(e));return(r==="curveMonotone"||r==="curveBump")&&t?cse["".concat(r).concat(t==="vertical"?"Y":"X")]:cse[r]||wh},s_e=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:i,connectNulls:a=!1}=e,o=o_e(t,i),s=a?r.filter(CL):r,l;if(Array.isArray(n)){var c=r.map((m,g)=>lse(lse({},m),{},{base:n[g]}));i==="vertical"?l=A0().y(R1).x1($1).x0(m=>m.base.x):l=A0().x($1).y1(R1).y0(m=>m.base.y);var d=l.defined(dse).curve(o),u=a?c.filter(dse):c;return d(u)}i==="vertical"&&at(n)?l=A0().y(R1).x1($1).x0(n):at(n)?l=A0().x($1).y1(R1).y0(n):l=E1().x($1).y(R1);var p=l.defined(CL).curve(o);return p(s)},Sh=e=>{var{className:t,points:r,path:n,pathRef:i}=e,a=xc();if((!r||!r.length)&&!n)return null;var o={type:e.type,points:e.points,baseLine:e.baseLine,layout:e.layout||a,connectNulls:e.connectNulls},s=r&&r.length?s_e(o):n;return use.createElement("path",x6({},mn(e),_0(e),{className:wt("recharts-curve",t),d:s===null?void 0:s,ref:i}))}});function w6(){return w6=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},w6.apply(null,arguments)}function pse(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function c_e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pse(Object(r),!0).forEach(function(n){d_e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pse(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function d_e(e,t,r){return(t=u_e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u_e(e){var t=p_e(e,"string");return typeof t=="symbol"?t:t+""}function p_e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function m_e(e,t){if(e==null)return{};var r,n,i=f_e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function f_e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var mse,l_e,g_e,fse,gse=F(()=>{mse=Y(Q());Zn();wr();_s();l_e=["x","y","top","left","width","height","className"];g_e=(e,t,r,n,i,a)=>"M".concat(e,",").concat(i,"v").concat(n,"M").concat(a,",").concat(t,"h").concat(r),fse=e=>{var{x:t=0,y:r=0,top:n=0,left:i=0,width:a=0,height:o=0,className:s}=e,l=m_e(e,l_e),c=c_e({x:t,y:r,top:n,left:i,width:a,height:o},l);return!at(t)||!at(r)||!at(a)||!at(o)||!at(n)||!at(i)?null:mse.createElement("path",w6({},nn(c),{className:wt("recharts-cross",s),d:g_e(t,r,a,o,n,i)}))}});function hse(e,t,r,n){var i=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-i:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-i,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}var vse=F(()=>{});function yse(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function bse(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yse(Object(r),!0).forEach(function(n){h_e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yse(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function h_e(e,t,r){return(t=v_e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v_e(e){var t=y_e(e,"string");return typeof t=="symbol"?t:t+""}function y_e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var b_e,DL,xse,tw,EL=F(()=>{b_e=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),DL=(e,t,r)=>e.map(n=>"".concat(b_e(n)," ").concat(t,"ms ").concat(r)).join(","),xse=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(i=>n.includes(i))),tw=(e,t)=>Object.keys(t).reduce((r,n)=>bse(bse({},r),{},{[n]:e(n,t[n])}),{})});function wse(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Qo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wse(Object(r),!0).forEach(function(n){x_e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wse(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function x_e(e,t,r){return(t=w_e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w_e(e){var t=k_e(e,"string");return typeof t=="symbol"?t:t+""}function k_e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function S_e(e,t,r,n,i,a){var o,s=n.reduce((p,m)=>Qo(Qo({},p),{},{[m]:{from:e[m],velocity:0,to:t[m]}}),{}),l=()=>tw((p,m)=>m.from,s),c=()=>!Object.values(s).filter(k6).length,d=null,u=p=>{o||(o=p);var m=p-o,g=m/r.dt;s=kse(r,s,g),i(Qo(Qo(Qo({},e),t),l())),o=p,c()||(d=a.setTimeout(u))};return()=>(d=a.setTimeout(u),()=>{var p;(p=d)===null||p===void 0||p()})}function T_e(e,t,r,n,i,a,o){var s=null,l=i.reduce((u,p)=>{var m=e[p],g=t[p];return m==null||g==null?u:Qo(Qo({},u),{},{[p]:[m,g]})},{}),c,d=u=>{c||(c=u);var p=(u-c)/n,m=tw((f,v)=>IL(...v,r(p)),l);if(a(Qo(Qo(Qo({},e),t),m)),p<1)s=o.setTimeout(d);else{var g=tw((f,v)=>IL(...v,r(1)),l);a(Qo(Qo(Qo({},e),t),g))}};return()=>(s=o.setTimeout(d),()=>{var u;(u=s)===null||u===void 0||u()})}var IL,k6,kse,Sse,Tse=F(()=>{EL();IL=(e,t,r)=>e+(t-e)*r,k6=e=>{var{from:t,to:r}=e;return t!==r},kse=(e,t,r)=>{var n=tw((i,a)=>{if(k6(a)){var[o,s]=e(a.from,a.to,a.velocity);return Qo(Qo({},a),{},{from:o,velocity:s})}return a},t);return r<1?tw((i,a)=>k6(a)&&n[i]!=null?Qo(Qo({},a),{},{velocity:IL(a.velocity,n[i].velocity,r),from:IL(a.from,n[i].from,r)}):a,t):kse(e,n,r-1)};Sse=(e,t,r,n,i,a)=>{var o=xse(e,t);return r==null?()=>(i(Qo(Qo({},e),t)),()=>{}):r.isStepper===!0?S_e(e,t,r,o,i,a):T_e(e,t,r,n,o,i,a)}});var ML,Dse,Ese,Cse,C_e,P_e,D_e,E_e,Pse,I_e,Ise,Mse=F(()=>{ML=1e-4,Dse=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],Ese=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),Cse=(e,t)=>r=>{var n=Dse(e,t);return Ese(n,r)},C_e=(e,t)=>r=>{var n=Dse(e,t),i=[...n.map((a,o)=>a*o).slice(1),0];return Ese(i,r)},P_e=e=>{var t,r=e.split("(");if(r.length!==2||r[0]!=="cubic-bezier")return null;var n=(t=r[1])===null||t===void 0||(t=t.split(")")[0])===null||t===void 0?void 0:t.split(",");if(n==null||n.length!==4)return null;var i=n.map(a=>parseFloat(a));return[i[0],i[1],i[2],i[3]]},D_e=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(r.length===1)switch(r[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var i=P_e(r[0]);if(i)return i}}return r.length===4?r:[0,0,1,1]},E_e=(e,t,r,n)=>{var i=Cse(e,r),a=Cse(t,n),o=C_e(e,r),s=c=>c>1?1:c<0?0:c,l=c=>{for(var d=c>1?1:c,u=d,p=0;p<8;++p){var m=i(u)-d,g=o(u);if(Math.abs(m-d)<ML||g<ML)return a(u);u=s(u-m/g)}return a(u)};return l.isStepper=!1,l},Pse=function(){return E_e(...D_e(...arguments))},I_e=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:i=17}=t,a=(o,s,l)=>{var c=-(o-s)*r,d=l*n,u=l+(c-d)*i/1e3,p=l*i/1e3+o;return Math.abs(p-s)<ML&&Math.abs(u)<ML?[s,0]:[p,u]};return a.isStepper=!0,a.dt=i,a},Ise=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Pse(e);case"spring":return I_e();default:if(e.split("(")[0]==="cubic-bezier")return Pse(e)}return typeof e=="function"?e:null}});function Ase(e){var t,r=()=>null,n=!1,i=null,a=o=>{if(!n){if(Array.isArray(o)){if(!o.length)return;var s=o,[l,...c]=s;if(typeof l=="number"){i=e.setTimeout(a.bind(null,c),l);return}a(l),i=e.setTimeout(a.bind(null,c));return}typeof o=="string"&&(t=o,r(t)),typeof o=="object"&&(t=o,r(t)),typeof o=="function"&&o()}};return{stop:()=>{n=!0},start:o=>{n=!1,i&&(i(),i=null),a(o)},subscribe:o=>(r=o,()=>{r=()=>null}),getTimeoutController:()=>e}}var Lse=F(()=>{});var AL,Nse=F(()=>{AL=class{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),i=null,a=o=>{o-n>=r?t(o):typeof requestAnimationFrame=="function"&&(i=requestAnimationFrame(a))};return i=requestAnimationFrame(a),()=>{i!=null&&cancelAnimationFrame(i)}}}});function Fse(){return Ase(new AL)}var Ose=F(()=>{Lse();Nse()});function zse(e,t){var r=(0,rw.useContext)(M_e);return(0,rw.useMemo)(()=>t!=null?t:r(e),[e,t,r])}var rw,M_e,jse=F(()=>{rw=Y(Q());Ose();M_e=(0,rw.createContext)(Fse)});var A_e,Hd,Zy=F(()=>{A_e=()=>!(typeof window!="undefined"&&window.document&&window.document.createElement&&window.setTimeout),Hd={devToolsEnabled:!0,isSsr:A_e()}});function qd(e){var t=pr(e,L_e),{isActive:r,canBegin:n,duration:i,easing:a,begin:o,onAnimationEnd:s,onAnimationStart:l,children:c}=t,d=r==="auto"?!Hd.isSsr:r,u=zse(t.animationId,t.animationManager),[p,m]=(0,eb.useState)(d?_se:S6),g=(0,eb.useRef)(null);return(0,eb.useEffect)(()=>{d||m(S6)},[d]),(0,eb.useEffect)(()=>{if(!d||!n)return qy;var f=Sse(_se,S6,Ise(a),i,m,u.getTimeoutController()),v=()=>{g.current=f()};return u.start([l,o,v,i,s]),()=>{u.stop(),g.current&&g.current(),s()}},[d,n,i,a,o,l,s,u]),c(p.t)}var eb,L_e,_se,S6,tb=F(()=>{eb=Y(Q());wr();ma();Tse();Mse();jse();Zy();L_e={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},_se={t:0},S6={t:1}});function Vd(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=(0,T6.useRef)(Tf(t)),n=(0,T6.useRef)(e);return n.current!==e&&(r.current=Tf(t),n.current=e),r.current}var T6,rb=F(()=>{T6=Y(Q());wr()});function Kse(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Jse(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Kse(Object(r),!0).forEach(function(n){O_e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kse(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function O_e(e,t,r){return(t=z_e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function z_e(e){var t=j_e(e,"string");return typeof t=="symbol"?t:t+""}function j_e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function NL(){return NL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},NL.apply(null,arguments)}function Qse(e,t){if(e==null)return{};var r,n,i=__e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function __e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Xp(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var LL,Gd,N_e,F_e,Bse,Wse,$se,Rse,Use,Hse,qse,Vse,Gse,Yse,Xse,Zse,FL,C6=F(()=>{LL=Y(Q()),Gd=Y(Q());Zn();ma();tb();wr();rb();EL();_s();j0();N_e=["radius"],F_e=["radius"];Xse=(e,t,r,n,i)=>{var a=Jp(r),o=Jp(n),s=Math.min(Math.abs(a)/2,Math.abs(o)/2),l=o>=0?1:-1,c=a>=0?1:-1,d=o>=0&&a>=0||o<0&&a<0?1:0,u;if(s>0&&i instanceof Array){for(var p=[0,0,0,0],m=0,g=4;m<g;m++)p[m]=i[m]>s?s:i[m];u=zi(Bse||(Bse=Xp(["M",",",""])),e,t+l*p[0]),p[0]>0&&(u+=zi(Wse||(Wse=Xp(["A ",",",",0,0,",",",",",""])),p[0],p[0],d,e+c*p[0],t)),u+=zi($se||($se=Xp(["L ",",",""])),e+r-c*p[1],t),p[1]>0&&(u+=zi(Rse||(Rse=Xp(["A ",",",",0,0,",`,
        `,",",""])),p[1],p[1],d,e+r,t+l*p[1])),u+=zi(Use||(Use=Xp(["L ",",",""])),e+r,t+n-l*p[2]),p[2]>0&&(u+=zi(Hse||(Hse=Xp(["A ",",",",0,0,",`,
        `,",",""])),p[2],p[2],d,e+r-c*p[2],t+n)),u+=zi(qse||(qse=Xp(["L ",",",""])),e+c*p[3],t+n),p[3]>0&&(u+=zi(Vse||(Vse=Xp(["A ",",",",0,0,",`,
        `,",",""])),p[3],p[3],d,e,t+n-l*p[3])),u+="Z"}else if(s>0&&i===+i&&i>0){var f=Math.min(s,i);u=zi(Gse||(Gse=Xp(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),e,t+l*f,f,f,d,e+c*f,t,e+r-c*f,t,f,f,d,e+r,t+l*f,e+r,t+n-l*f,f,f,d,e+r-c*f,t+n,e+c*f,t+n,f,f,d,e,t+n-l*f)}else u=zi(Yse||(Yse=Xp(["M ",","," h "," v "," h "," Z"])),e,t,r,n,-r);return u},Zse={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},FL=e=>{var t=pr(e,Zse),r=(0,Gd.useRef)(null),[n,i]=(0,Gd.useState)(-1);(0,Gd.useEffect)(()=>{if(r.current&&r.current.getTotalLength)try{var T=r.current.getTotalLength();T&&i(T)}catch($){}},[]);var{x:a,y:o,width:s,height:l,radius:c,className:d}=t,{animationEasing:u,animationDuration:p,animationBegin:m,isAnimationActive:g,isUpdateAnimationActive:f}=t,v=(0,Gd.useRef)(s),h=(0,Gd.useRef)(l),y=(0,Gd.useRef)(a),b=(0,Gd.useRef)(o),k=(0,Gd.useMemo)(()=>({x:a,y:o,width:s,height:l,radius:c}),[a,o,s,l,c]),x=Vd(k,"rectangle-");if(a!==+a||o!==+o||s!==+s||l!==+l||s===0||l===0)return null;var S=wt("recharts-rectangle",d);if(!f){var w=nn(t),{radius:C}=w,D=Qse(w,N_e);return LL.createElement("path",NL({},D,{x:Jp(a),y:Jp(o),width:Jp(s),height:Jp(l),radius:typeof c=="number"?c:void 0,className:S,d:Xse(a,o,s,l,c)}))}var P=v.current,M=h.current,z=y.current,A=b.current,I="0px ".concat(n===-1?1:n,"px"),L="".concat(n,"px 0px"),E=DL(["strokeDasharray"],p,typeof u=="string"?u:Zse.animationEasing);return LL.createElement(qd,{animationId:x,key:x,canBegin:n>0,duration:p,easing:u,isActive:f,begin:m},T=>{var $=Kr(P,s,T),_=Kr(M,l,T),B=Kr(z,a,T),W=Kr(A,o,T);r.current&&(v.current=$,h.current=_,y.current=B,b.current=W);var N;g?T>0?N={transition:E,strokeDasharray:L}:N={strokeDasharray:I}:N={strokeDasharray:L};var U=nn(t),{radius:j}=U,R=Qse(U,F_e);return LL.createElement("path",NL({},R,{radius:typeof c=="number"?c:void 0,className:S,d:Xse(B,W,$,_,c),ref:r,style:Jse(Jse({},N),t.style)}))})}});function ele(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function tle(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ele(Object(r),!0).forEach(function(n){B_e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ele(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function B_e(e,t,r){return(t=W_e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function W_e(e){var t=$_e(e,"string");return typeof t=="symbol"?t:t+""}function $_e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rle,U1,H1,R_e,an,nle,U_e,H_e,q_e,V_e,ile,OL,Yd=F(()=>{rle=Y(Q());U1=Math.PI/180,H1=e=>e*Math.PI/180,R_e=e=>e*180/Math.PI,an=(e,t,r,n)=>({x:e+Math.cos(-U1*n)*r,y:t+Math.sin(-U1*n)*r}),nle=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0,width:0,height:0,brushBottom:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},U_e=(e,t)=>{var{x:r,y:n}=e,{x:i,y:a}=t;return Math.sqrt((r-i)**2+(n-a)**2)},H_e=(e,t)=>{var{x:r,y:n}=e,{cx:i,cy:a}=t,o=U_e({x:r,y:n},{x:i,y:a});if(o<=0)return{radius:o,angle:0};var s=(r-i)/o,l=Math.acos(s);return n>a&&(l=2*Math.PI-l),{radius:o,angle:R_e(l),angleInRadian:l}},q_e=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),i=Math.floor(r/360),a=Math.min(n,i);return{startAngle:t-a*360,endAngle:r-a*360}},V_e=(e,t)=>{var{startAngle:r,endAngle:n}=t,i=Math.floor(r/360),a=Math.floor(n/360),o=Math.min(i,a);return e+o*360},ile=(e,t)=>{var{chartX:r,chartY:n}=e,{radius:i,angle:a}=H_e({x:r,y:n},t),{innerRadius:o,outerRadius:s}=t;if(i<o||i>s||i===0)return null;var{startAngle:l,endAngle:c}=q_e(t),d=a,u;if(l<=c){for(;d>c;)d-=360;for(;d<l;)d+=360;u=d>=l&&d<=c}else{for(;d>l;)d-=360;for(;d<c;)d+=360;u=d>=c&&d<=l}return u?tle(tle({},t),{},{radius:i,angle:V_e(d,t)}):null},OL=e=>!(0,rle.isValidElement)(e)&&typeof e!="function"&&typeof e!="boolean"&&e!=null?e.className:""});function zL(e){var{cx:t,cy:r,radius:n,startAngle:i,endAngle:a}=e,o=an(t,r,n,i),s=an(t,r,n,a);return{points:[o,s],cx:t,cy:r,radius:n,startAngle:i,endAngle:a}}var P6=F(()=>{Yd()});function D6(){return D6=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},D6.apply(null,arguments)}function nb(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var ple,ale,ole,sle,lle,cle,dle,ule,G_e,jL,mle,Y_e,K_e,_L,E6=F(()=>{ple=Y(Q());Zn();Yd();wr();ma();_s();j0();G_e=(e,t)=>{var r=Va(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},jL=e=>{var{cx:t,cy:r,radius:n,angle:i,sign:a,isExternal:o,cornerRadius:s,cornerIsExternal:l}=e,c=s*(o?1:-1)+n,d=Math.asin(s/c)/U1,u=l?i:i+a*d,p=an(t,r,c,u),m=an(t,r,n,u),g=l?i-a*d:i,f=an(t,r,c*Math.cos(d*U1),g);return{center:p,circleTangency:m,lineTangency:f,theta:d}},mle=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:i,startAngle:a,endAngle:o}=e,s=G_e(a,o),l=a+s,c=an(t,r,i,a),d=an(t,r,i,l),u=zi(ale||(ale=nb(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),c.x,c.y,i,i,+(Math.abs(s)>180),+(a>l),d.x,d.y);if(n>0){var p=an(t,r,n,a),m=an(t,r,n,l);u+=zi(ole||(ole=nb(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),m.x,m.y,n,n,+(Math.abs(s)>180),+(a<=l),p.x,p.y)}else u+=zi(sle||(sle=nb(["L ",","," Z"])),t,r);return u},Y_e=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:i,cornerRadius:a,forceCornerRadius:o,cornerIsExternal:s,startAngle:l,endAngle:c}=e,d=Va(c-l),{circleTangency:u,lineTangency:p,theta:m}=jL({cx:t,cy:r,radius:i,angle:l,sign:d,cornerRadius:a,cornerIsExternal:s}),{circleTangency:g,lineTangency:f,theta:v}=jL({cx:t,cy:r,radius:i,angle:c,sign:-d,cornerRadius:a,cornerIsExternal:s}),h=s?Math.abs(l-c):Math.abs(l-c)-m-v;if(h<0)return o?zi(lle||(lle=nb(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),p.x,p.y,a,a,a*2,a,a,-a*2):mle({cx:t,cy:r,innerRadius:n,outerRadius:i,startAngle:l,endAngle:c});var y=zi(cle||(cle=nb(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),p.x,p.y,a,a,+(d<0),u.x,u.y,i,i,+(h>180),+(d<0),g.x,g.y,a,a,+(d<0),f.x,f.y);if(n>0){var{circleTangency:b,lineTangency:k,theta:x}=jL({cx:t,cy:r,radius:n,angle:l,sign:d,isExternal:!0,cornerRadius:a,cornerIsExternal:s}),{circleTangency:S,lineTangency:w,theta:C}=jL({cx:t,cy:r,radius:n,angle:c,sign:-d,isExternal:!0,cornerRadius:a,cornerIsExternal:s}),D=s?Math.abs(l-c):Math.abs(l-c)-x-C;if(D<0&&a===0)return"".concat(y,"L").concat(t,",").concat(r,"Z");y+=zi(dle||(dle=nb(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),w.x,w.y,a,a,+(d<0),S.x,S.y,n,n,+(D>180),+(d>0),b.x,b.y,a,a,+(d<0),k.x,k.y)}else y+=zi(ule||(ule=nb(["L",",","Z"])),t,r);return y},K_e={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},_L=e=>{var t=pr(e,K_e),{cx:r,cy:n,innerRadius:i,outerRadius:a,cornerRadius:o,forceCornerRadius:s,cornerIsExternal:l,startAngle:c,endAngle:d,className:u}=t;if(a<i||c===d)return null;var p=wt("recharts-sector",u),m=a-i,g=Bs(o,m,0,!0),f;return g>0&&Math.abs(c-d)<360?f=Y_e({cx:r,cy:n,innerRadius:i,outerRadius:a,cornerRadius:Math.min(g,m/2),forceCornerRadius:s,cornerIsExternal:l,startAngle:c,endAngle:d}):f=mle({cx:r,cy:n,innerRadius:i,outerRadius:a,startAngle:c,endAngle:d}),ple.createElement("path",D6({},nn(t),{className:p,d:f}))}});function fle(e,t,r){if(e==="horizontal")return[{x:t.x,y:r.top},{x:t.x,y:r.top+r.height}];if(e==="vertical")return[{x:r.left,y:t.y},{x:r.left+r.width,y:t.y}];if(LA(t)){if(e==="centric"){var{cx:n,cy:i,innerRadius:a,outerRadius:o,angle:s}=t,l=an(n,i,a,s),c=an(n,i,o,s);return[{x:l.x,y:l.y},{x:c.x,y:c.y}]}return zL(t)}}var gle=F(()=>{Yd();qu();P6()});var hle=Fe(I6=>{"use strict";Object.defineProperty(I6,Symbol.toStringTag,{value:"Module"});var J_e=CR();function Q_e(e){return J_e.isSymbol(e)?NaN:Number(e)}I6.toNumber=Q_e});var vle=Fe(M6=>{"use strict";Object.defineProperty(M6,Symbol.toStringTag,{value:"Module"});var X_e=hle();function Z_e(e){return e?(e=X_e.toNumber(e),e===1/0||e===-1/0?(e<0?-1:1)*Number.MAX_VALUE:e===e?e:0):e===0?e:0}M6.toFinite=Z_e});var yle=Fe(L6=>{"use strict";Object.defineProperty(L6,Symbol.toStringTag,{value:"Module"});var eBe=MR(),A6=vle();function tBe(e,t,r){r&&typeof r!="number"&&eBe.isIterateeCall(e,t,r)&&(t=r=void 0),e=A6.toFinite(e),t===void 0?(t=e,e=0):t=A6.toFinite(t),r=r===void 0?e<t?1:-1:A6.toFinite(r);let n=Math.max(Math.ceil((t-e)/(r||1)),0),i=new Array(n);for(let a=0;a<n;a++)i[a]=e,e+=r;return i}L6.range=tBe});var xle=Fe((cwt,ble)=>{ble.exports=yle().range});function Hl(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}var q1=F(()=>{});function N6(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}var wle=F(()=>{});function ib(e){let t,r,n;e.length!==2?(t=Hl,r=(s,l)=>Hl(e(s),l),n=(s,l)=>e(s)-l):(t=e===Hl||e===N6?e:rBe,r=e,n=e);function i(s,l,c=0,d=s.length){if(c<d){if(t(l,l)!==0)return d;do{let u=c+d>>>1;r(s[u],l)<0?c=u+1:d=u}while(c<d)}return c}function a(s,l,c=0,d=s.length){if(c<d){if(t(l,l)!==0)return d;do{let u=c+d>>>1;r(s[u],l)<=0?c=u+1:d=u}while(c<d)}return c}function o(s,l,c=0,d=s.length){let u=i(s,l,c,d-1);return u>c&&n(s[u-1],l)>-n(s[u],l)?u-1:u}return{left:i,center:o,right:a}}function rBe(){return 0}var F6=F(()=>{q1();wle()});function V1(e){return e===null?NaN:+e}function*kle(e,t){if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(yield r);else{let r=-1;for(let n of e)(n=t(n,++r,e))!=null&&(n=+n)>=n&&(yield n)}}var O6=F(()=>{});var Sle,Tle,nBe,iBe,Qu,Cle=F(()=>{q1();F6();O6();Sle=ib(Hl),Tle=Sle.right,nBe=Sle.left,iBe=ib(V1).center,Qu=Tle});function Ple({_intern:e,_key:t},r){let n=t(r);return e.has(n)?e.get(n):r}function aBe({_intern:e,_key:t},r){let n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function oBe({_intern:e,_key:t},r){let n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function sBe(e){return e!==null&&typeof e=="object"?e.valueOf():e}var nw,Dle=F(()=>{nw=class extends Map{constructor(t,r=sBe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(let[n,i]of t)this.set(n,i)}get(t){return super.get(Ple(this,t))}has(t){return super.has(Ple(this,t))}set(t,r){return super.set(aBe(this,t),r)}delete(t){return super.delete(oBe(this,t))}}});function Ele(e=Hl){if(e===Hl)return z6;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{let n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function z6(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}var Ile=F(()=>{q1()});function BL(e,t,r){let n=(t-e)/Math.max(0,r),i=Math.floor(Math.log10(n)),a=n/Math.pow(10,i),o=a>=lBe?10:a>=cBe?5:a>=dBe?2:1,s,l,c;return i<0?(c=Math.pow(10,-i)/o,s=Math.round(e*c),l=Math.round(t*c),s/c<e&&++s,l/c>t&&--l,c=-c):(c=Math.pow(10,i)*o,s=Math.round(e/c),l=Math.round(t/c),s*c<e&&++s,l*c>t&&--l),l<s&&.5<=r&&r<2?BL(e,t,r*2):[s,l,c]}function ab(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];let n=t<e,[i,a,o]=n?BL(t,e,r):BL(e,t,r);if(!(a>=i))return[];let s=a-i+1,l=new Array(s);if(n)if(o<0)for(let c=0;c<s;++c)l[c]=(a-c)/-o;else for(let c=0;c<s;++c)l[c]=(a-c)*o;else if(o<0)for(let c=0;c<s;++c)l[c]=(i+c)/-o;else for(let c=0;c<s;++c)l[c]=(i+c)*o;return l}function G1(e,t,r){return t=+t,e=+e,r=+r,BL(e,t,r)[2]}function iw(e,t,r){t=+t,e=+e,r=+r;let n=t<e,i=n?G1(t,e,r):G1(e,t,r);return(n?-1:1)*(i<0?1/-i:i)}var lBe,cBe,dBe,Mle=F(()=>{lBe=Math.sqrt(50),cBe=Math.sqrt(10),dBe=Math.sqrt(2)});function WL(e,t){let r;if(t===void 0)for(let n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let i of e)(i=t(i,++n,e))!=null&&(r<i||r===void 0&&i>=i)&&(r=i)}return r}var Ale=F(()=>{});function $L(e,t){let r;if(t===void 0)for(let n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let i of e)(i=t(i,++n,e))!=null&&(r>i||r===void 0&&i>=i)&&(r=i)}return r}var Lle=F(()=>{});function RL(e,t,r=0,n=1/0,i){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(i=i===void 0?z6:Ele(i);n>r;){if(n-r>600){let l=n-r+1,c=t-r+1,d=Math.log(l),u=.5*Math.exp(2*d/3),p=.5*Math.sqrt(d*u*(l-u)/l)*(c-l/2<0?-1:1),m=Math.max(r,Math.floor(t-c*u/l+p)),g=Math.min(n,Math.floor(t+(l-c)*u/l+p));RL(e,t,m,g,i)}let a=e[t],o=r,s=n;for(Y1(e,r,t),i(e[n],a)>0&&Y1(e,r,n);o<s;){for(Y1(e,o,s),++o,--s;i(e[o],a)<0;)++o;for(;i(e[s],a)>0;)--s}i(e[r],a)===0?Y1(e,r,s):(++s,Y1(e,s,n)),s<=t&&(r=s+1),t<=s&&(n=s-1)}return e}function Y1(e,t,r){let n=e[t];e[t]=e[r],e[r]=n}var Nle=F(()=>{Ile()});function UL(e,t,r){if(e=Float64Array.from(kle(e,r)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return $L(e);if(t>=1)return WL(e);var n,i=(n-1)*t,a=Math.floor(i),o=WL(RL(e,a).subarray(0,a+1)),s=$L(e.subarray(a+1));return o+(s-o)*(i-a)}}function j6(e,t,r=V1){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,i=(n-1)*t,a=Math.floor(i),o=+r(e[a],a,e),s=+r(e[a+1],a+1,e);return o+(s-o)*(i-a)}}var Fle=F(()=>{Ale();Lle();Nle();O6()});function HL(e,t,r){e=+e,t=+t,r=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((t-e)/r))|0,a=new Array(i);++n<i;)a[n]=e+n*r;return a}var Ole=F(()=>{});var Kd=F(()=>{Cle();q1();F6();Fle();Ole();Mle();Dle()});function fa(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Jd(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}var fl=F(()=>{});function aw(){var e=new nw,t=[],r=[],n=qL;function i(a){let o=e.get(a);if(o===void 0){if(n!==qL)return n;e.set(a,o=t.push(a)-1)}return r[o%r.length]}return i.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new nw;for(let o of a)e.has(o)||e.set(o,t.push(o)-1);return i},i.range=function(a){return arguments.length?(r=Array.from(a),i):r.slice()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return aw(t,r).unknown(n)},fa.apply(i,arguments),i}var qL,_6=F(()=>{Kd();fl();qL=Symbol("implicit")});function K1(){var e=aw().unknown(void 0),t=e.domain,r=e.range,n=0,i=1,a,o,s=!1,l=0,c=0,d=.5;delete e.unknown;function u(){var p=t().length,m=i<n,g=m?i:n,f=m?n:i;a=(f-g)/Math.max(1,p-l+c*2),s&&(a=Math.floor(a)),g+=(f-g-a*(p-l))*d,o=a*(1-l),s&&(g=Math.round(g),o=Math.round(o));var v=HL(p).map(function(h){return g+a*h});return r(m?v.reverse():v)}return e.domain=function(p){return arguments.length?(t(p),u()):t()},e.range=function(p){return arguments.length?([n,i]=p,n=+n,i=+i,u()):[n,i]},e.rangeRound=function(p){return[n,i]=p,n=+n,i=+i,s=!0,u()},e.bandwidth=function(){return o},e.step=function(){return a},e.round=function(p){return arguments.length?(s=!!p,u()):s},e.padding=function(p){return arguments.length?(l=Math.min(1,c=+p),u()):l},e.paddingInner=function(p){return arguments.length?(l=Math.min(1,p),u()):l},e.paddingOuter=function(p){return arguments.length?(c=+p,u()):c},e.align=function(p){return arguments.length?(d=Math.max(0,Math.min(1,p)),u()):d},e.copy=function(){return K1(t(),[n,i]).round(s).paddingInner(l).paddingOuter(c).align(d)},fa.apply(u(),arguments)}function zle(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return zle(t())},e}function jle(){return zle(K1.apply(null,arguments).paddingInner(1))}var _le=F(()=>{Kd();fl();_6()});function VL(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function B6(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}var Ble=F(()=>{});function X1(){}function $le(){return this.rgb().formatHex()}function yBe(){return this.rgb().formatHex8()}function bBe(){return Yle(this).formatHsl()}function Rle(){return this.rgb().formatRgb()}function Th(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=uBe.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?Ule(t):r===3?new wc(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?GL(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?GL(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=pBe.exec(e))?new wc(t[1],t[2],t[3],1):(t=mBe.exec(e))?new wc(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=fBe.exec(e))?GL(t[1],t[2],t[3],t[4]):(t=gBe.exec(e))?GL(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=hBe.exec(e))?Vle(t[1],t[2]/100,t[3]/100,1):(t=vBe.exec(e))?Vle(t[1],t[2]/100,t[3]/100,t[4]):Wle.hasOwnProperty(e)?Ule(Wle[e]):e==="transparent"?new wc(NaN,NaN,NaN,0):null}function Ule(e){return new wc(e>>16&255,e>>8&255,e&255,1)}function GL(e,t,r,n){return n<=0&&(e=t=r=NaN),new wc(e,t,r,n)}function xBe(e){return e instanceof X1||(e=Th(e)),e?(e=e.rgb(),new wc(e.r,e.g,e.b,e.opacity)):new wc}function sw(e,t,r,n){return arguments.length===1?xBe(e):new wc(e,t,r,n==null?1:n)}function wc(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}function Hle(){return`#${ob(this.r)}${ob(this.g)}${ob(this.b)}`}function wBe(){return`#${ob(this.r)}${ob(this.g)}${ob(this.b)}${ob((isNaN(this.opacity)?1:this.opacity)*255)}`}function qle(){let e=JL(this.opacity);return`${e===1?"rgb(":"rgba("}${sb(this.r)}, ${sb(this.g)}, ${sb(this.b)}${e===1?")":`, ${e})`}`}function JL(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function sb(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ob(e){return e=sb(e),(e<16?"0":"")+e.toString(16)}function Vle(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Xu(e,t,r,n)}function Yle(e){if(e instanceof Xu)return new Xu(e.h,e.s,e.l,e.opacity);if(e instanceof X1||(e=Th(e)),!e)return new Xu;if(e instanceof Xu)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),a=Math.max(t,r,n),o=NaN,s=a-i,l=(a+i)/2;return s?(t===a?o=(r-n)/s+(r<n)*6:r===a?o=(n-t)/s+2:o=(t-r)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new Xu(o,s,l,e.opacity)}function Kle(e,t,r,n){return arguments.length===1?Yle(e):new Xu(e,t,r,n==null?1:n)}function Xu(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}function Gle(e){return e=(e||0)%360,e<0?e+360:e}function YL(e){return Math.max(0,Math.min(1,e||0))}function W6(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}var J1,KL,ow,Q1,Zp,uBe,pBe,mBe,fBe,gBe,hBe,vBe,Wle,Jle=F(()=>{Ble();J1=.7,KL=1/J1,ow="\\s*([+-]?\\d+)\\s*",Q1="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Zp="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",uBe=/^#([0-9a-f]{3,8})$/,pBe=new RegExp(`^rgb\\(${ow},${ow},${ow}\\)$`),mBe=new RegExp(`^rgb\\(${Zp},${Zp},${Zp}\\)$`),fBe=new RegExp(`^rgba\\(${ow},${ow},${ow},${Q1}\\)$`),gBe=new RegExp(`^rgba\\(${Zp},${Zp},${Zp},${Q1}\\)$`),hBe=new RegExp(`^hsl\\(${Q1},${Zp},${Zp}\\)$`),vBe=new RegExp(`^hsla\\(${Q1},${Zp},${Zp},${Q1}\\)$`),Wle={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};VL(X1,Th,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:$le,formatHex:$le,formatHex8:yBe,formatHsl:bBe,formatRgb:Rle,toString:Rle});VL(wc,sw,B6(X1,{brighter(e){return e=e==null?KL:Math.pow(KL,e),new wc(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?J1:Math.pow(J1,e),new wc(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new wc(sb(this.r),sb(this.g),sb(this.b),JL(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Hle,formatHex:Hle,formatHex8:wBe,formatRgb:qle,toString:qle}));VL(Xu,Kle,B6(X1,{brighter(e){return e=e==null?KL:Math.pow(KL,e),new Xu(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?J1:Math.pow(J1,e),new Xu(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new wc(W6(e>=240?e-240:e+120,i,n),W6(e,i,n),W6(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new Xu(Gle(this.h),YL(this.s),YL(this.l),JL(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=JL(this.opacity);return`${e===1?"hsl(":"hsla("}${Gle(this.h)}, ${YL(this.s)*100}%, ${YL(this.l)*100}%${e===1?")":`, ${e})`}`}}))});var $6=F(()=>{Jle()});function R6(e,t,r,n,i){var a=e*e,o=a*e;return((1-3*e+3*a-o)*t+(4-6*a+3*o)*r+(1+3*e+3*a-3*o)*n+o*i)/6}function Qle(e){var t=e.length-1;return function(r){var n=r<=0?r=0:r>=1?(r=1,t-1):Math.floor(r*t),i=e[n],a=e[n+1],o=n>0?e[n-1]:2*i-a,s=n<t-1?e[n+2]:2*a-i;return R6((r-n/t)*t,o,i,a,s)}}var U6=F(()=>{});function Xle(e){var t=e.length;return function(r){var n=Math.floor(((r%=1)<0?++r:r)*t),i=e[(n+t-1)%t],a=e[n%t],o=e[(n+1)%t],s=e[(n+2)%t];return R6((r-n/t)*t,i,a,o,s)}}var Zle=F(()=>{U6()});var Z1,H6=F(()=>{Z1=e=>()=>e});function kBe(e,t){return function(r){return e+r*t}}function SBe(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function ece(e){return(e=+e)==1?QL:function(t,r){return r-t?SBe(t,r,e):Z1(isNaN(t)?r:t)}}function QL(e,t){var r=t-e;return r?kBe(e,r):Z1(isNaN(e)?t:e)}var tce=F(()=>{H6()});function rce(e){return function(t){var r=t.length,n=new Array(r),i=new Array(r),a=new Array(r),o,s;for(o=0;o<r;++o)s=sw(t[o]),n[o]=s.r||0,i[o]=s.g||0,a[o]=s.b||0;return n=e(n),i=e(i),a=e(a),s.opacity=1,function(l){return s.r=n(l),s.g=i(l),s.b=a(l),s+""}}}var q6,mkt,fkt,nce=F(()=>{$6();U6();Zle();tce();q6=(function e(t){var r=ece(t);function n(i,a){var o=r((i=sw(i)).r,(a=sw(a)).r),s=r(i.g,a.g),l=r(i.b,a.b),c=QL(i.opacity,a.opacity);return function(d){return i.r=o(d),i.g=s(d),i.b=l(d),i.opacity=c(d),i+""}}return n.gamma=e,n})(1);mkt=rce(Qle),fkt=rce(Xle)});function ice(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),i;return function(a){for(i=0;i<r;++i)n[i]=e[i]*(1-a)+t[i]*a;return n}}function ace(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}var oce=F(()=>{});function sce(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,i=new Array(n),a=new Array(r),o;for(o=0;o<n;++o)i[o]=ed(e[o],t[o]);for(;o<r;++o)a[o]=t[o];return function(s){for(o=0;o<n;++o)a[o]=i[o](s);return a}}var lce=F(()=>{eC()});function cce(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}var dce=F(()=>{});function Ch(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}var XL=F(()=>{});function uce(e,t){var r={},n={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?r[i]=ed(e[i],t[i]):n[i]=t[i];return function(a){for(i in r)n[i]=r[i](a);return n}}var pce=F(()=>{eC()});function TBe(e){return function(){return e}}function CBe(e){return function(t){return e(t)+""}}function mce(e,t){var r=G6.lastIndex=V6.lastIndex=0,n,i,a,o=-1,s=[],l=[];for(e=e+"",t=t+"";(n=G6.exec(e))&&(i=V6.exec(t));)(a=i.index)>r&&(a=t.slice(r,a),s[o]?s[o]+=a:s[++o]=a),(n=n[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,l.push({i:o,x:Ch(n,i)})),r=V6.lastIndex;return r<t.length&&(a=t.slice(r),s[o]?s[o]+=a:s[++o]=a),s.length<2?l[0]?CBe(l[0].x):TBe(t):(t=l.length,function(c){for(var d=0,u;d<t;++d)s[(u=l[d]).i]=u.x(c);return s.join("")})}var G6,V6,fce=F(()=>{XL();G6=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,V6=new RegExp(G6.source,"g")});function ed(e,t){var r=typeof t,n;return t==null||r==="boolean"?Z1(t):(r==="number"?Ch:r==="string"?(n=Th(t))?(t=n,q6):mce:t instanceof Th?q6:t instanceof Date?cce:ace(t)?ice:Array.isArray(t)?sce:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?uce:Ch)(e,t)}var eC=F(()=>{$6();nce();lce();dce();XL();pce();fce();H6();oce()});function lb(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}var gce=F(()=>{});function ZL(e,t){t===void 0&&(t=e,e=ed);for(var r=0,n=t.length-1,i=t[0],a=new Array(n<0?0:n);r<n;)a[r]=e(i,i=t[++r]);return function(o){var s=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return a[s](o-s)}}var hce=F(()=>{eC()});var eN=F(()=>{eC();XL();gce();hce()});function Y6(e){return function(){return e}}var vce=F(()=>{});function Ph(e){return+e}var tN=F(()=>{});function Xo(e){return e}function K6(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:Y6(isNaN(t)?NaN:.5)}function PBe(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function DBe(e,t,r){var n=e[0],i=e[1],a=t[0],o=t[1];return i<n?(n=K6(i,n),a=r(o,a)):(n=K6(n,i),a=r(a,o)),function(s){return a(n(s))}}function EBe(e,t,r){var n=Math.min(e.length,t.length)-1,i=new Array(n),a=new Array(n),o=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<n;)i[o]=K6(e[o],e[o+1]),a[o]=r(t[o],t[o+1]);return function(s){var l=Qu(e,s,1,n)-1;return a[l](i[l](s))}}function em(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function cb(){var e=yce,t=yce,r=ed,n,i,a,o=Xo,s,l,c;function d(){var p=Math.min(e.length,t.length);return o!==Xo&&(o=PBe(e[0],e[p-1])),s=p>2?EBe:DBe,l=c=null,u}function u(p){return p==null||isNaN(p=+p)?a:(l||(l=s(e.map(n),t,r)))(n(o(p)))}return u.invert=function(p){return o(i((c||(c=s(t,e.map(n),Ch)))(p)))},u.domain=function(p){return arguments.length?(e=Array.from(p,Ph),d()):e.slice()},u.range=function(p){return arguments.length?(t=Array.from(p),d()):t.slice()},u.rangeRound=function(p){return t=Array.from(p),r=lb,d()},u.clamp=function(p){return arguments.length?(o=p?!0:Xo,d()):o!==Xo},u.interpolate=function(p){return arguments.length?(r=p,d()):r},u.unknown=function(p){return arguments.length?(a=p,u):a},function(p,m){return n=p,i=m,d()}}function db(){return cb()(Xo,Xo)}var yce,tm=F(()=>{Kd();eN();vce();tN();yce=[0,1]});function bce(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function ub(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}var tC=F(()=>{});function rm(e){return e=ub(Math.abs(e)),e?e[1]:NaN}var rC=F(()=>{tC()});function xce(e,t){return function(r,n){for(var i=r.length,a=[],o=0,s=e[0],l=0;i>0&&s>0&&(l+s+1>n&&(s=Math.max(1,n-l)),a.push(r.substring(i-=s,i+s)),!((l+=s+1)>n));)s=e[o=(o+1)%e.length];return a.reverse().join(t)}}var wce=F(()=>{});function kce(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var Sce=F(()=>{});function nm(e){if(!(t=IBe.exec(e)))throw new Error("invalid format: "+e);var t;return new rN({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function rN(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}var IBe,J6=F(()=>{IBe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;nm.prototype=rN.prototype;rN.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type}});function Tce(e){e:for(var t=e.length,r=1,n=-1,i;r<t;++r)switch(e[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(i+1):e}var Cce=F(()=>{});function Pce(e,t){var r=ub(e,t);if(!r)return e+"";var n=r[0],i=r[1],a=i-(Q6=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=n.length;return a===o?n:a>o?n+new Array(a-o+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+ub(e,Math.max(0,t+a-1))[0]}var Q6,X6=F(()=>{tC()});function Z6(e,t){var r=ub(e,t);if(!r)return e+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}var Dce=F(()=>{tC()});var e3,Ece=F(()=>{tC();X6();Dce();e3={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:bce,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Z6(e*100,t),r:Z6,s:Pce,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)}});function t3(e){return e}var Ice=F(()=>{});function Lce(e){var t=e.grouping===void 0||e.thousands===void 0?t3:xce(Mce.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?t3:kce(Mce.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"\u2212":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function c(u){u=nm(u);var p=u.fill,m=u.align,g=u.sign,f=u.symbol,v=u.zero,h=u.width,y=u.comma,b=u.precision,k=u.trim,x=u.type;x==="n"?(y=!0,x="g"):e3[x]||(b===void 0&&(b=12),k=!0,x="g"),(v||p==="0"&&m==="=")&&(v=!0,p="0",m="=");var S=f==="$"?r:f==="#"&&/[boxX]/.test(x)?"0"+x.toLowerCase():"",w=f==="$"?n:/[%p]/.test(x)?o:"",C=e3[x],D=/[defgprs%]/.test(x);b=b===void 0?6:/[gprs]/.test(x)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function P(M){var z=S,A=w,I,L,E;if(x==="c")A=C(M)+A,M="";else{M=+M;var T=M<0||1/M<0;if(M=isNaN(M)?l:C(Math.abs(M),b),k&&(M=Tce(M)),T&&+M==0&&g!=="+"&&(T=!1),z=(T?g==="("?g:s:g==="-"||g==="("?"":g)+z,A=(x==="s"?Ace[8+Q6/3]:"")+A+(T&&g==="("?")":""),D){for(I=-1,L=M.length;++I<L;)if(E=M.charCodeAt(I),48>E||E>57){A=(E===46?i+M.slice(I+1):M.slice(I))+A,M=M.slice(0,I);break}}}y&&!v&&(M=t(M,1/0));var $=z.length+M.length+A.length,_=$<h?new Array(h-$+1).join(p):"";switch(y&&v&&(M=t(_+M,_.length?h-A.length:1/0),_=""),m){case"<":M=z+M+A+_;break;case"=":M=z+_+M+A;break;case"^":M=_.slice(0,$=_.length>>1)+z+M+A+_.slice($);break;default:M=_+z+M+A;break}return a(M)}return P.toString=function(){return u+""},P}function d(u,p){var m=c((u=nm(u),u.type="f",u)),g=Math.max(-8,Math.min(8,Math.floor(rm(p)/3)))*3,f=Math.pow(10,-g),v=Ace[8+g/3];return function(h){return m(f*h)+v}}return{format:c,formatPrefix:d}}var Mce,Ace,Nce=F(()=>{rC();wce();Sce();J6();Cce();Ece();X6();Ice();Mce=Array.prototype.map,Ace=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"]});function r3(e){return nN=Lce(e),lw=nN.format,iN=nN.formatPrefix,nN}var nN,lw,iN,Fce=F(()=>{Nce();r3({thousands:",",grouping:[3],currency:["$",""]})});function n3(e){return Math.max(0,-rm(Math.abs(e)))}var Oce=F(()=>{rC()});function i3(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(rm(t)/3)))*3-rm(Math.abs(e)))}var zce=F(()=>{rC()});function a3(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,rm(t)-rm(e))+1}var jce=F(()=>{rC()});var o3=F(()=>{Fce();J6();Oce();zce();jce()});function nC(e,t,r,n){var i=iw(e,t,r),a;switch(n=nm(n==null?",f":n),n.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(a=i3(i,o))&&(n.precision=a),iN(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=a3(i,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=n3(i))&&(n.precision=a-(n.type==="%")*2);break}}return lw(n)}var s3=F(()=>{Kd();o3()});function ql(e){var t=e.domain;return e.ticks=function(r){var n=t();return ab(n[0],n[n.length-1],r==null?10:r)},e.tickFormat=function(r,n){var i=t();return nC(i[0],i[i.length-1],r==null?10:r,n)},e.nice=function(r){r==null&&(r=10);var n=t(),i=0,a=n.length-1,o=n[i],s=n[a],l,c,d=10;for(s<o&&(c=o,o=s,s=c,c=i,i=a,a=c);d-- >0;){if(c=G1(o,s,r),c===l)return n[i]=o,n[a]=s,t(n);if(c>0)o=Math.floor(o/c)*c,s=Math.ceil(s/c)*c;else if(c<0)o=Math.ceil(o*c)/c,s=Math.floor(s*c)/c;else break;l=c}return e},e}function aN(){var e=db();return e.copy=function(){return em(e,aN())},fa.apply(e,arguments),ql(e)}var If=F(()=>{Kd();tm();fl();s3()});function oN(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Ph),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return oN(e).unknown(t)},e=arguments.length?Array.from(e,Ph):[0,1],ql(r)}var _ce=F(()=>{If();tN()});function iC(e,t){e=e.slice();var r=0,n=e.length-1,i=e[r],a=e[n],o;return a<i&&(o=r,r=n,n=o,o=i,i=a,a=o),e[r]=t.floor(i),e[n]=t.ceil(a),e}var l3=F(()=>{});function Bce(e){return Math.log(e)}function Wce(e){return Math.exp(e)}function MBe(e){return-Math.log(-e)}function ABe(e){return-Math.exp(-e)}function LBe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function NBe(e){return e===10?LBe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function FBe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function $ce(e){return(t,r)=>-e(-t,r)}function aC(e){let t=e(Bce,Wce),r=t.domain,n=10,i,a;function o(){return i=FBe(n),a=NBe(n),r()[0]<0?(i=$ce(i),a=$ce(a),e(MBe,ABe)):e(Bce,Wce),t}return t.base=function(s){return arguments.length?(n=+s,o()):n},t.domain=function(s){return arguments.length?(r(s),o()):r()},t.ticks=s=>{let l=r(),c=l[0],d=l[l.length-1],u=d<c;u&&([c,d]=[d,c]);let p=i(c),m=i(d),g,f,v=s==null?10:+s,h=[];if(!(n%1)&&m-p<v){if(p=Math.floor(p),m=Math.ceil(m),c>0){for(;p<=m;++p)for(g=1;g<n;++g)if(f=p<0?g/a(-p):g*a(p),!(f<c)){if(f>d)break;h.push(f)}}else for(;p<=m;++p)for(g=n-1;g>=1;--g)if(f=p>0?g/a(-p):g*a(p),!(f<c)){if(f>d)break;h.push(f)}h.length*2<v&&(h=ab(c,d,v))}else h=ab(p,m,Math.min(m-p,v)).map(a);return u?h.reverse():h},t.tickFormat=(s,l)=>{if(s==null&&(s=10),l==null&&(l=n===10?"s":","),typeof l!="function"&&(!(n%1)&&(l=nm(l)).precision==null&&(l.trim=!0),l=lw(l)),s===1/0)return l;let c=Math.max(1,n*s/t.ticks().length);return d=>{let u=d/a(Math.round(i(d)));return u*n<n-.5&&(u*=n),u<=c?l(d):""}},t.nice=()=>r(iC(r(),{floor:s=>a(Math.floor(i(s))),ceil:s=>a(Math.ceil(i(s)))})),t}function sN(){let e=aC(cb()).domain([1,10]);return e.copy=()=>em(e,sN()).base(e.base()),fa.apply(e,arguments),e}var lN=F(()=>{Kd();o3();l3();tm();fl()});function Rce(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Uce(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function oC(e){var t=1,r=e(Rce(t),Uce(t));return r.constant=function(n){return arguments.length?e(Rce(t=+n),Uce(t)):t},ql(r)}function cN(){var e=oC(cb());return e.copy=function(){return em(e,cN()).constant(e.constant())},fa.apply(e,arguments)}var dN=F(()=>{If();tm();fl()});function Hce(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function OBe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function zBe(e){return e<0?-e*e:e*e}function sC(e){var t=e(Xo,Xo),r=1;function n(){return r===1?e(Xo,Xo):r===.5?e(OBe,zBe):e(Hce(r),Hce(1/r))}return t.exponent=function(i){return arguments.length?(r=+i,n()):r},ql(t)}function lC(){var e=sC(cb());return e.copy=function(){return em(e,lC()).exponent(e.exponent())},fa.apply(e,arguments),e}function qce(){return lC.apply(null,arguments).exponent(.5)}var uN=F(()=>{If();tm();fl()});function Vce(e){return Math.sign(e)*e*e}function jBe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function pN(){var e=db(),t=[0,1],r=!1,n;function i(a){var o=jBe(e(a));return isNaN(o)?n:r?Math.round(o):o}return i.invert=function(a){return e.invert(Vce(a))},i.domain=function(a){return arguments.length?(e.domain(a),i):e.domain()},i.range=function(a){return arguments.length?(e.range((t=Array.from(a,Ph)).map(Vce)),i):t.slice()},i.rangeRound=function(a){return i.range(a).round(!0)},i.round=function(a){return arguments.length?(r=!!a,i):r},i.clamp=function(a){return arguments.length?(e.clamp(a),i):e.clamp()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return pN(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},fa.apply(i,arguments),ql(i)}var Gce=F(()=>{tm();fl();If();tN()});function mN(){var e=[],t=[],r=[],n;function i(){var o=0,s=Math.max(1,t.length);for(r=new Array(s-1);++o<s;)r[o-1]=j6(e,o/s);return a}function a(o){return o==null||isNaN(o=+o)?n:t[Qu(r,o)]}return a.invertExtent=function(o){var s=t.indexOf(o);return s<0?[NaN,NaN]:[s>0?r[s-1]:e[0],s<r.length?r[s]:e[e.length-1]]},a.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let s of o)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(Hl),i()},a.range=function(o){return arguments.length?(t=Array.from(o),i()):t.slice()},a.unknown=function(o){return arguments.length?(n=o,a):n},a.quantiles=function(){return r.slice()},a.copy=function(){return mN().domain(e).range(t).unknown(n)},fa.apply(a,arguments)}var Yce=F(()=>{Kd();fl()});function fN(){var e=0,t=1,r=1,n=[.5],i=[0,1],a;function o(l){return l!=null&&l<=l?i[Qu(n,l,0,r)]:a}function s(){var l=-1;for(n=new Array(r);++l<r;)n[l]=((l+1)*t-(l-r)*e)/(r+1);return o}return o.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,s()):[e,t]},o.range=function(l){return arguments.length?(r=(i=Array.from(l)).length-1,s()):i.slice()},o.invertExtent=function(l){var c=i.indexOf(l);return c<0?[NaN,NaN]:c<1?[e,n[0]]:c>=r?[n[r-1],t]:[n[c-1],n[c]]},o.unknown=function(l){return arguments.length&&(a=l),o},o.thresholds=function(){return n.slice()},o.copy=function(){return fN().domain([e,t]).range(i).unknown(a)},fa.apply(ql(o),arguments)}var Kce=F(()=>{Kd();If();fl()});function gN(){var e=[.5],t=[0,1],r,n=1;function i(a){return a!=null&&a<=a?t[Qu(e,a,0,n)]:r}return i.domain=function(a){return arguments.length?(e=Array.from(a),n=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(a){return arguments.length?(t=Array.from(a),n=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(a){var o=t.indexOf(a);return[e[o-1],e[o]]},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return gN().domain(e).range(t).unknown(r)},fa.apply(i,arguments)}var Jce=F(()=>{Kd();fl()});function _i(e,t,r,n){function i(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=a=>(e(a=new Date(+a)),a),i.ceil=a=>(e(a=new Date(a-1)),t(a,1),e(a),a),i.round=a=>{let o=i(a),s=i.ceil(a);return a-o<s-a?o:s},i.offset=(a,o)=>(t(a=new Date(+a),o==null?1:Math.floor(o)),a),i.range=(a,o,s)=>{let l=[];if(a=i.ceil(a),s=s==null?1:Math.floor(s),!(a<o)||!(s>0))return l;let c;do l.push(c=new Date(+a)),t(a,s),e(a);while(c<a&&a<o);return l},i.filter=a=>_i(o=>{if(o>=o)for(;e(o),!a(o);)o.setTime(o-1)},(o,s)=>{if(o>=o)if(s<0)for(;++s<=0;)for(;t(o,-1),!a(o););else for(;--s>=0;)for(;t(o,1),!a(o););}),r&&(i.count=(a,o)=>(c3.setTime(+a),d3.setTime(+o),e(c3),e(d3),Math.floor(r(c3,d3))),i.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(n?o=>n(o)%a===0:o=>i.count(0,o)%a===0):i)),i}var c3,d3,Mf=F(()=>{c3=new Date,d3=new Date});var cC,TTt,Qce=F(()=>{Mf();cC=_i(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);cC.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?_i(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):cC);TTt=cC.range});var Qd,Xce,u3=F(()=>{Mf();Qd=_i(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*1e3)},(e,t)=>(t-e)/1e3,e=>e.getUTCSeconds()),Xce=Qd.range});var cw,_Be,dw,BBe,p3=F(()=>{Mf();cw=_i(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*1e3)},(e,t)=>{e.setTime(+e+t*6e4)},(e,t)=>(t-e)/6e4,e=>e.getMinutes()),_Be=cw.range,dw=_i(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*6e4)},(e,t)=>(t-e)/6e4,e=>e.getUTCMinutes()),BBe=dw.range});var uw,WBe,pw,$Be,m3=F(()=>{Mf();uw=_i(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*1e3-e.getMinutes()*6e4)},(e,t)=>{e.setTime(+e+t*36e5)},(e,t)=>(t-e)/36e5,e=>e.getHours()),WBe=uw.range,pw=_i(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*36e5)},(e,t)=>(t-e)/36e5,e=>e.getUTCHours()),$Be=pw.range});var Af,RBe,fb,UBe,hN,HBe,f3=F(()=>{Mf();Af=_i(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*6e4)/864e5,e=>e.getDate()-1),RBe=Af.range,fb=_i(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>e.getUTCDate()-1),UBe=fb.range,hN=_i(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>Math.floor(e/864e5)),HBe=hN.range});function gb(e){return _i(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*6e4)/6048e5)}function hb(e){return _i(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/6048e5)}var Lf,mw,ede,tde,Dh,rde,nde,ide,qBe,VBe,GBe,YBe,KBe,JBe,Nf,fw,ade,ode,Eh,sde,lde,cde,QBe,XBe,ZBe,eWe,tWe,rWe,g3=F(()=>{Mf();Lf=gb(0),mw=gb(1),ede=gb(2),tde=gb(3),Dh=gb(4),rde=gb(5),nde=gb(6),ide=Lf.range,qBe=mw.range,VBe=ede.range,GBe=tde.range,YBe=Dh.range,KBe=rde.range,JBe=nde.range;Nf=hb(0),fw=hb(1),ade=hb(2),ode=hb(3),Eh=hb(4),sde=hb(5),lde=hb(6),cde=Nf.range,QBe=fw.range,XBe=ade.range,ZBe=ode.range,eWe=Eh.range,tWe=sde.range,rWe=lde.range});var gw,nWe,hw,iWe,h3=F(()=>{Mf();gw=_i(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth()),nWe=gw.range,hw=_i(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth()),iWe=hw.range});var td,aWe,rd,oWe,v3=F(()=>{Mf();td=_i(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());td.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:_i(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});aWe=td.range,rd=_i(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());rd.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:_i(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});oWe=rd.range});function ude(e,t,r,n,i,a){let o=[[Qd,1,1e3],[Qd,5,5*1e3],[Qd,15,15*1e3],[Qd,30,30*1e3],[a,1,6e4],[a,5,5*6e4],[a,15,15*6e4],[a,30,30*6e4],[i,1,36e5],[i,3,3*36e5],[i,6,6*36e5],[i,12,12*36e5],[n,1,864e5],[n,2,2*864e5],[r,1,6048e5],[t,1,2592e6],[t,3,3*2592e6],[e,1,31536e6]];function s(c,d,u){let p=d<c;p&&([c,d]=[d,c]);let m=u&&typeof u.range=="function"?u:l(c,d,u),g=m?m.range(c,+d+1):[];return p?g.reverse():g}function l(c,d,u){let p=Math.abs(d-c)/u,m=ib(([,,v])=>v).right(o,p);if(m===o.length)return e.every(iw(c/31536e6,d/31536e6,u));if(m===0)return cC.every(Math.max(iw(c,d,u),1));let[g,f]=o[p/o[m-1][2]<o[m][2]/p?m-1:m];return g.every(f)}return[s,l]}var y3,b3,x3,w3,pde=F(()=>{Kd();Qce();u3();p3();m3();f3();g3();h3();v3();[y3,b3]=ude(rd,hw,Nf,hN,pw,dw),[x3,w3]=ude(td,gw,Lf,Af,uw,cw)});var vN=F(()=>{u3();p3();m3();f3();g3();h3();v3();pde()});function k3(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function S3(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function uC(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function T3(e){var t=e.dateTime,r=e.date,n=e.time,i=e.periods,a=e.days,o=e.shortDays,s=e.months,l=e.shortMonths,c=pC(i),d=mC(i),u=pC(a),p=mC(a),m=pC(o),g=mC(o),f=pC(s),v=mC(s),h=pC(l),y=mC(l),b={a:T,A:$,b:_,B,c:null,d:yde,e:yde,f:MWe,g:WWe,G:RWe,H:DWe,I:EWe,j:IWe,L:Sde,m:AWe,M:LWe,p:W,q:N,Q:wde,s:kde,S:NWe,u:FWe,U:OWe,V:zWe,w:jWe,W:_We,x:null,X:null,y:BWe,Y:$We,Z:UWe,"%":xde},k={a:U,A:j,b:R,B:O,c:null,d:bde,e:bde,f:GWe,g:n4e,G:a4e,H:HWe,I:qWe,j:VWe,L:Cde,m:YWe,M:KWe,p:H,q,Q:wde,s:kde,S:JWe,u:QWe,U:XWe,V:ZWe,w:e4e,W:t4e,x:null,X:null,y:r4e,Y:i4e,Z:o4e,"%":xde},x={a:P,A:M,b:z,B:A,c:I,d:hde,e:hde,f:SWe,g:gde,G:fde,H:vde,I:vde,j:bWe,L:kWe,m:yWe,M:xWe,p:D,q:vWe,Q:CWe,s:PWe,S:wWe,u:pWe,U:mWe,V:fWe,w:uWe,W:gWe,x:L,X:E,y:gde,Y:fde,Z:hWe,"%":TWe};b.x=S(r,b),b.X=S(n,b),b.c=S(t,b),k.x=S(r,k),k.X=S(n,k),k.c=S(t,k);function S(V,J){return function(K){var G=[],X=-1,te=0,re=V.length,Z,ne,se;for(K instanceof Date||(K=new Date(+K));++X<re;)V.charCodeAt(X)===37&&(G.push(V.slice(te,X)),(ne=mde[Z=V.charAt(++X)])!=null?Z=V.charAt(++X):ne=Z==="e"?" ":"0",(se=J[Z])&&(Z=se(K,ne)),G.push(Z),te=X+1);return G.push(V.slice(te,X)),G.join("")}}function w(V,J){return function(K){var G=uC(1900,void 0,1),X=C(G,V,K+="",0),te,re;if(X!=K.length)return null;if("Q"in G)return new Date(G.Q);if("s"in G)return new Date(G.s*1e3+("L"in G?G.L:0));if(J&&!("Z"in G)&&(G.Z=0),"p"in G&&(G.H=G.H%12+G.p*12),G.m===void 0&&(G.m="q"in G?G.q:0),"V"in G){if(G.V<1||G.V>53)return null;"w"in G||(G.w=1),"Z"in G?(te=S3(uC(G.y,0,1)),re=te.getUTCDay(),te=re>4||re===0?fw.ceil(te):fw(te),te=fb.offset(te,(G.V-1)*7),G.y=te.getUTCFullYear(),G.m=te.getUTCMonth(),G.d=te.getUTCDate()+(G.w+6)%7):(te=k3(uC(G.y,0,1)),re=te.getDay(),te=re>4||re===0?mw.ceil(te):mw(te),te=Af.offset(te,(G.V-1)*7),G.y=te.getFullYear(),G.m=te.getMonth(),G.d=te.getDate()+(G.w+6)%7)}else("W"in G||"U"in G)&&("w"in G||(G.w="u"in G?G.u%7:"W"in G?1:0),re="Z"in G?S3(uC(G.y,0,1)).getUTCDay():k3(uC(G.y,0,1)).getDay(),G.m=0,G.d="W"in G?(G.w+6)%7+G.W*7-(re+5)%7:G.w+G.U*7-(re+6)%7);return"Z"in G?(G.H+=G.Z/100|0,G.M+=G.Z%100,S3(G)):k3(G)}}function C(V,J,K,G){for(var X=0,te=J.length,re=K.length,Z,ne;X<te;){if(G>=re)return-1;if(Z=J.charCodeAt(X++),Z===37){if(Z=J.charAt(X++),ne=x[Z in mde?J.charAt(X++):Z],!ne||(G=ne(V,K,G))<0)return-1}else if(Z!=K.charCodeAt(G++))return-1}return G}function D(V,J,K){var G=c.exec(J.slice(K));return G?(V.p=d.get(G[0].toLowerCase()),K+G[0].length):-1}function P(V,J,K){var G=m.exec(J.slice(K));return G?(V.w=g.get(G[0].toLowerCase()),K+G[0].length):-1}function M(V,J,K){var G=u.exec(J.slice(K));return G?(V.w=p.get(G[0].toLowerCase()),K+G[0].length):-1}function z(V,J,K){var G=h.exec(J.slice(K));return G?(V.m=y.get(G[0].toLowerCase()),K+G[0].length):-1}function A(V,J,K){var G=f.exec(J.slice(K));return G?(V.m=v.get(G[0].toLowerCase()),K+G[0].length):-1}function I(V,J,K){return C(V,t,J,K)}function L(V,J,K){return C(V,r,J,K)}function E(V,J,K){return C(V,n,J,K)}function T(V){return o[V.getDay()]}function $(V){return a[V.getDay()]}function _(V){return l[V.getMonth()]}function B(V){return s[V.getMonth()]}function W(V){return i[+(V.getHours()>=12)]}function N(V){return 1+~~(V.getMonth()/3)}function U(V){return o[V.getUTCDay()]}function j(V){return a[V.getUTCDay()]}function R(V){return l[V.getUTCMonth()]}function O(V){return s[V.getUTCMonth()]}function H(V){return i[+(V.getUTCHours()>=12)]}function q(V){return 1+~~(V.getUTCMonth()/3)}return{format:function(V){var J=S(V+="",b);return J.toString=function(){return V},J},parse:function(V){var J=w(V+="",!1);return J.toString=function(){return V},J},utcFormat:function(V){var J=S(V+="",k);return J.toString=function(){return V},J},utcParse:function(V){var J=w(V+="",!0);return J.toString=function(){return V},J}}}function Hn(e,t,r){var n=e<0?"-":"",i=(n?-e:e)+"",a=i.length;return n+(a<r?new Array(r-a+1).join(t)+i:i)}function dWe(e){return e.replace(cWe,"\\$&")}function pC(e){return new RegExp("^(?:"+e.map(dWe).join("|")+")","i")}function mC(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function uWe(e,t,r){var n=vs.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function pWe(e,t,r){var n=vs.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function mWe(e,t,r){var n=vs.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function fWe(e,t,r){var n=vs.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function gWe(e,t,r){var n=vs.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function fde(e,t,r){var n=vs.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function gde(e,t,r){var n=vs.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function hWe(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function vWe(e,t,r){var n=vs.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function yWe(e,t,r){var n=vs.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function hde(e,t,r){var n=vs.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function bWe(e,t,r){var n=vs.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function vde(e,t,r){var n=vs.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function xWe(e,t,r){var n=vs.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function wWe(e,t,r){var n=vs.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function kWe(e,t,r){var n=vs.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function SWe(e,t,r){var n=vs.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function TWe(e,t,r){var n=lWe.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function CWe(e,t,r){var n=vs.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function PWe(e,t,r){var n=vs.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function yde(e,t){return Hn(e.getDate(),t,2)}function DWe(e,t){return Hn(e.getHours(),t,2)}function EWe(e,t){return Hn(e.getHours()%12||12,t,2)}function IWe(e,t){return Hn(1+Af.count(td(e),e),t,3)}function Sde(e,t){return Hn(e.getMilliseconds(),t,3)}function MWe(e,t){return Sde(e,t)+"000"}function AWe(e,t){return Hn(e.getMonth()+1,t,2)}function LWe(e,t){return Hn(e.getMinutes(),t,2)}function NWe(e,t){return Hn(e.getSeconds(),t,2)}function FWe(e){var t=e.getDay();return t===0?7:t}function OWe(e,t){return Hn(Lf.count(td(e)-1,e),t,2)}function Tde(e){var t=e.getDay();return t>=4||t===0?Dh(e):Dh.ceil(e)}function zWe(e,t){return e=Tde(e),Hn(Dh.count(td(e),e)+(td(e).getDay()===4),t,2)}function jWe(e){return e.getDay()}function _We(e,t){return Hn(mw.count(td(e)-1,e),t,2)}function BWe(e,t){return Hn(e.getFullYear()%100,t,2)}function WWe(e,t){return e=Tde(e),Hn(e.getFullYear()%100,t,2)}function $We(e,t){return Hn(e.getFullYear()%1e4,t,4)}function RWe(e,t){var r=e.getDay();return e=r>=4||r===0?Dh(e):Dh.ceil(e),Hn(e.getFullYear()%1e4,t,4)}function UWe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Hn(t/60|0,"0",2)+Hn(t%60,"0",2)}function bde(e,t){return Hn(e.getUTCDate(),t,2)}function HWe(e,t){return Hn(e.getUTCHours(),t,2)}function qWe(e,t){return Hn(e.getUTCHours()%12||12,t,2)}function VWe(e,t){return Hn(1+fb.count(rd(e),e),t,3)}function Cde(e,t){return Hn(e.getUTCMilliseconds(),t,3)}function GWe(e,t){return Cde(e,t)+"000"}function YWe(e,t){return Hn(e.getUTCMonth()+1,t,2)}function KWe(e,t){return Hn(e.getUTCMinutes(),t,2)}function JWe(e,t){return Hn(e.getUTCSeconds(),t,2)}function QWe(e){var t=e.getUTCDay();return t===0?7:t}function XWe(e,t){return Hn(Nf.count(rd(e)-1,e),t,2)}function Pde(e){var t=e.getUTCDay();return t>=4||t===0?Eh(e):Eh.ceil(e)}function ZWe(e,t){return e=Pde(e),Hn(Eh.count(rd(e),e)+(rd(e).getUTCDay()===4),t,2)}function e4e(e){return e.getUTCDay()}function t4e(e,t){return Hn(fw.count(rd(e)-1,e),t,2)}function r4e(e,t){return Hn(e.getUTCFullYear()%100,t,2)}function n4e(e,t){return e=Pde(e),Hn(e.getUTCFullYear()%100,t,2)}function i4e(e,t){return Hn(e.getUTCFullYear()%1e4,t,4)}function a4e(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Eh(e):Eh.ceil(e),Hn(e.getUTCFullYear()%1e4,t,4)}function o4e(){return"+0000"}function xde(){return"%"}function wde(e){return+e}function kde(e){return Math.floor(+e/1e3)}var mde,vs,lWe,cWe,Dde=F(()=>{vN();mde={"-":"",_:" ",0:"0"},vs=/^\s*\d+/,lWe=/^%/,cWe=/[\\^$*+?|[\]().{}]/g});function C3(e){return vw=T3(e),yN=vw.format,Ede=vw.parse,bN=vw.utcFormat,Ide=vw.utcParse,vw}var vw,yN,Ede,bN,Ide,Mde=F(()=>{Dde();C3({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]})});var P3=F(()=>{Mde()});function s4e(e){return new Date(e)}function l4e(e){return e instanceof Date?+e:+new Date(+e)}function xN(e,t,r,n,i,a,o,s,l,c){var d=db(),u=d.invert,p=d.domain,m=c(".%L"),g=c(":%S"),f=c("%I:%M"),v=c("%I %p"),h=c("%a %d"),y=c("%b %d"),b=c("%B"),k=c("%Y");function x(S){return(l(S)<S?m:s(S)<S?g:o(S)<S?f:a(S)<S?v:n(S)<S?i(S)<S?h:y:r(S)<S?b:k)(S)}return d.invert=function(S){return new Date(u(S))},d.domain=function(S){return arguments.length?p(Array.from(S,l4e)):p().map(s4e)},d.ticks=function(S){var w=p();return e(w[0],w[w.length-1],S==null?10:S)},d.tickFormat=function(S,w){return w==null?x:c(w)},d.nice=function(S){var w=p();return(!S||typeof S.range!="function")&&(S=t(w[0],w[w.length-1],S==null?10:S)),S?p(iC(w,S)):d},d.copy=function(){return em(d,xN(e,t,r,n,i,a,o,s,l,c))},d}function D3(){return fa.apply(xN(x3,w3,td,gw,Lf,Af,uw,cw,Qd,yN).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}var E3=F(()=>{vN();P3();tm();fl();l3()});function I3(){return fa.apply(xN(y3,b3,rd,hw,Nf,fb,pw,dw,Qd,bN).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}var Ade=F(()=>{vN();P3();E3();fl()});function wN(){var e=0,t=1,r,n,i,a,o=Xo,s=!1,l;function c(u){return u==null||isNaN(u=+u)?l:o(i===0?.5:(u=(a(u)-r)*i,s?Math.max(0,Math.min(1,u)):u))}c.domain=function(u){return arguments.length?([e,t]=u,r=a(e=+e),n=a(t=+t),i=r===n?0:1/(n-r),c):[e,t]},c.clamp=function(u){return arguments.length?(s=!!u,c):s},c.interpolator=function(u){return arguments.length?(o=u,c):o};function d(u){return function(p){var m,g;return arguments.length?([m,g]=p,o=u(m,g),c):[o(0),o(1)]}}return c.range=d(ed),c.rangeRound=d(lb),c.unknown=function(u){return arguments.length?(l=u,c):l},function(u){return a=u,r=u(e),n=u(t),i=r===n?0:1/(n-r),c}}function Ff(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function kN(){var e=ql(wN()(Xo));return e.copy=function(){return Ff(e,kN())},Jd.apply(e,arguments)}function M3(){var e=aC(wN()).domain([1,10]);return e.copy=function(){return Ff(e,M3()).base(e.base())},Jd.apply(e,arguments)}function A3(){var e=oC(wN());return e.copy=function(){return Ff(e,A3()).constant(e.constant())},Jd.apply(e,arguments)}function SN(){var e=sC(wN());return e.copy=function(){return Ff(e,SN()).exponent(e.exponent())},Jd.apply(e,arguments)}function Lde(){return SN.apply(null,arguments).exponent(.5)}var L3=F(()=>{eN();tm();fl();If();lN();dN();uN()});function TN(){var e=[],t=Xo;function r(n){if(n!=null&&!isNaN(n=+n))return t((Qu(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let i of n)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(Hl),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,i)=>t(i/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(i,a)=>UL(e,a/n))},r.copy=function(){return TN(t).domain(e)},Jd.apply(r,arguments)}var Nde=F(()=>{Kd();tm();fl()});function CN(){var e=0,t=.5,r=1,n=1,i,a,o,s,l,c=Xo,d,u=!1,p;function m(f){return isNaN(f=+f)?p:(f=.5+((f=+d(f))-a)*(n*f<n*a?s:l),c(u?Math.max(0,Math.min(1,f)):f))}m.domain=function(f){return arguments.length?([e,t,r]=f,i=d(e=+e),a=d(t=+t),o=d(r=+r),s=i===a?0:.5/(a-i),l=a===o?0:.5/(o-a),n=a<i?-1:1,m):[e,t,r]},m.clamp=function(f){return arguments.length?(u=!!f,m):u},m.interpolator=function(f){return arguments.length?(c=f,m):c};function g(f){return function(v){var h,y,b;return arguments.length?([h,y,b]=v,c=ZL(f,[h,y,b]),m):[c(0),c(.5),c(1)]}}return m.range=g(ed),m.rangeRound=g(lb),m.unknown=function(f){return arguments.length?(p=f,m):p},function(f){return d=f,i=f(e),a=f(t),o=f(r),s=i===a?0:.5/(a-i),l=a===o?0:.5/(o-a),n=a<i?-1:1,m}}function PN(){var e=ql(CN()(Xo));return e.copy=function(){return Ff(e,PN())},Jd.apply(e,arguments)}function N3(){var e=aC(CN()).domain([.1,1,10]);return e.copy=function(){return Ff(e,N3()).base(e.base())},Jd.apply(e,arguments)}function F3(){var e=oC(CN());return e.copy=function(){return Ff(e,F3()).constant(e.constant())},Jd.apply(e,arguments)}function DN(){var e=sC(CN());return e.copy=function(){return Ff(e,DN()).exponent(e.exponent())},Jd.apply(e,arguments)}function Fde(){return DN.apply(null,arguments).exponent(.5)}var Ode=F(()=>{eN();tm();fl();If();lN();L3();dN();uN()});var zde=F(()=>{_le();_ce();If();lN();dN();_6();uN();Gce();Yce();Kce();Jce();E3();Ade();L3();Nde();Ode();s3()});var vb={};Ti(vb,{scaleBand:()=>K1,scaleDiverging:()=>PN,scaleDivergingLog:()=>N3,scaleDivergingPow:()=>DN,scaleDivergingSqrt:()=>Fde,scaleDivergingSymlog:()=>F3,scaleIdentity:()=>oN,scaleImplicit:()=>qL,scaleLinear:()=>aN,scaleLog:()=>sN,scaleOrdinal:()=>aw,scalePoint:()=>jle,scalePow:()=>lC,scaleQuantile:()=>mN,scaleQuantize:()=>fN,scaleRadial:()=>pN,scaleSequential:()=>kN,scaleSequentialLog:()=>M3,scaleSequentialPow:()=>SN,scaleSequentialQuantile:()=>TN,scaleSequentialSqrt:()=>Lde,scaleSequentialSymlog:()=>A3,scaleSqrt:()=>qce,scaleSymlog:()=>cN,scaleThreshold:()=>gN,scaleTime:()=>D3,scaleUtc:()=>I3,tickFormat:()=>nC});var jde=F(()=>{zde()});var Xd,yw,fC,EN,Of=F(()=>{Ka();Xd=e=>e.chartData,yw=de([Xd],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),fC=(e,t,r,n)=>n?yw(e):Xd(e),EN=(e,t,r)=>r?yw(e):Xd(e)});function am(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(Lr(t)&&Lr(r))return!0}return!1}function _de(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function IN(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,i,a;if(Lr(r))i=r;else if(typeof r=="function")return;if(Lr(n))a=n;else if(typeof n=="function")return;var o=[i,a];if(am(o))return o}}function Bde(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(am(n))return _de(n,t,r)}catch(m){}if(Array.isArray(e)&&e.length===2){var[i,a]=e,o,s;if(i==="auto")t!=null&&(o=Math.min(...t));else if(at(i))o=i;else if(typeof i=="function")try{t!=null&&(o=i(t==null?void 0:t[0]))}catch(m){}else if(typeof i=="string"&&n6.test(i)){var l=n6.exec(i);if(l==null||l[1]==null||t==null)o=void 0;else{var c=+l[1];o=t[0]-c}}else o=t==null?void 0:t[0];if(a==="auto")t!=null&&(s=Math.max(...t));else if(at(a))s=a;else if(typeof a=="function")try{t!=null&&(s=a(t==null?void 0:t[1]))}catch(m){}else if(typeof a=="string"&&i6.test(a)){var d=i6.exec(a);if(d==null||d[1]==null||t==null)s=void 0;else{var u=+d[1];s=t[1]+u}}else s=t==null?void 0:t[1];var p=[o,s];if(am(p))return t==null?p:_de(p,t,r)}}}var MN=F(()=>{Ja();wr();Rl()});var O3=Fe((Wde,AN)=>{(function(e){"use strict";var t=1e9,r={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},n=!0,i="[DecimalError] ",a=i+"Invalid argument: ",o=i+"Exponent out of range: ",s=Math.floor,l=Math.pow,c=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,d,u=1e7,p=7,m=9007199254740991,g=s(m/p),f={};f.absoluteValue=f.abs=function(){var E=new this.constructor(this);return E.s&&(E.s=1),E},f.comparedTo=f.cmp=function(E){var T,$,_,B,W=this;if(E=new W.constructor(E),W.s!==E.s)return W.s||-E.s;if(W.e!==E.e)return W.e>E.e^W.s<0?1:-1;for(_=W.d.length,B=E.d.length,T=0,$=_<B?_:B;T<$;++T)if(W.d[T]!==E.d[T])return W.d[T]>E.d[T]^W.s<0?1:-1;return _===B?0:_>B^W.s<0?1:-1},f.decimalPlaces=f.dp=function(){var E=this,T=E.d.length-1,$=(T-E.e)*p;if(T=E.d[T],T)for(;T%10==0;T/=10)$--;return $<0?0:$},f.dividedBy=f.div=function(E){return b(this,new this.constructor(E))},f.dividedToIntegerBy=f.idiv=function(E){var T=this,$=T.constructor;return P(b(T,new $(E),0,1),$.precision)},f.equals=f.eq=function(E){return!this.cmp(E)},f.exponent=function(){return x(this)},f.greaterThan=f.gt=function(E){return this.cmp(E)>0},f.greaterThanOrEqualTo=f.gte=function(E){return this.cmp(E)>=0},f.isInteger=f.isint=function(){return this.e>this.d.length-2},f.isNegative=f.isneg=function(){return this.s<0},f.isPositive=f.ispos=function(){return this.s>0},f.isZero=function(){return this.s===0},f.lessThan=f.lt=function(E){return this.cmp(E)<0},f.lessThanOrEqualTo=f.lte=function(E){return this.cmp(E)<1},f.logarithm=f.log=function(E){var T,$=this,_=$.constructor,B=_.precision,W=B+5;if(E===void 0)E=new _(10);else if(E=new _(E),E.s<1||E.eq(d))throw Error(i+"NaN");if($.s<1)throw Error(i+($.s?"NaN":"-Infinity"));return $.eq(d)?new _(0):(n=!1,T=b(C($,W),C(E,W),W),n=!0,P(T,B))},f.minus=f.sub=function(E){var T=this;return E=new T.constructor(E),T.s==E.s?M(T,E):v(T,(E.s=-E.s,E))},f.modulo=f.mod=function(E){var T,$=this,_=$.constructor,B=_.precision;if(E=new _(E),!E.s)throw Error(i+"NaN");return $.s?(n=!1,T=b($,E,0,1).times(E),n=!0,$.minus(T)):P(new _($),B)},f.naturalExponential=f.exp=function(){return k(this)},f.naturalLogarithm=f.ln=function(){return C(this)},f.negated=f.neg=function(){var E=new this.constructor(this);return E.s=-E.s||0,E},f.plus=f.add=function(E){var T=this;return E=new T.constructor(E),T.s==E.s?v(T,E):M(T,(E.s=-E.s,E))},f.precision=f.sd=function(E){var T,$,_,B=this;if(E!==void 0&&E!==!!E&&E!==1&&E!==0)throw Error(a+E);if(T=x(B)+1,_=B.d.length-1,$=_*p+1,_=B.d[_],_){for(;_%10==0;_/=10)$--;for(_=B.d[0];_>=10;_/=10)$++}return E&&T>$?T:$},f.squareRoot=f.sqrt=function(){var E,T,$,_,B,W,N,U=this,j=U.constructor;if(U.s<1){if(!U.s)return new j(0);throw Error(i+"NaN")}for(E=x(U),n=!1,B=Math.sqrt(+U),B==0||B==1/0?(T=y(U.d),(T.length+E)%2==0&&(T+="0"),B=Math.sqrt(T),E=s((E+1)/2)-(E<0||E%2),B==1/0?T="5e"+E:(T=B.toExponential(),T=T.slice(0,T.indexOf("e")+1)+E),_=new j(T)):_=new j(B.toString()),$=j.precision,B=N=$+3;;)if(W=_,_=W.plus(b(U,W,N+2)).times(.5),y(W.d).slice(0,N)===(T=y(_.d)).slice(0,N)){if(T=T.slice(N-3,N+1),B==N&&T=="4999"){if(P(W,$+1,0),W.times(W).eq(U)){_=W;break}}else if(T!="9999")break;N+=4}return n=!0,P(_,$)},f.times=f.mul=function(E){var T,$,_,B,W,N,U,j,R,O=this,H=O.constructor,q=O.d,V=(E=new H(E)).d;if(!O.s||!E.s)return new H(0);for(E.s*=O.s,$=O.e+E.e,j=q.length,R=V.length,j<R&&(W=q,q=V,V=W,N=j,j=R,R=N),W=[],N=j+R,_=N;_--;)W.push(0);for(_=R;--_>=0;){for(T=0,B=j+_;B>_;)U=W[B]+V[_]*q[B-_-1]+T,W[B--]=U%u|0,T=U/u|0;W[B]=(W[B]+T)%u|0}for(;!W[--N];)W.pop();return T?++$:W.shift(),E.d=W,E.e=$,n?P(E,H.precision):E},f.toDecimalPlaces=f.todp=function(E,T){var $=this,_=$.constructor;return $=new _($),E===void 0?$:(h(E,0,t),T===void 0?T=_.rounding:h(T,0,8),P($,E+x($)+1,T))},f.toExponential=function(E,T){var $,_=this,B=_.constructor;return E===void 0?$=z(_,!0):(h(E,0,t),T===void 0?T=B.rounding:h(T,0,8),_=P(new B(_),E+1,T),$=z(_,!0,E+1)),$},f.toFixed=function(E,T){var $,_,B=this,W=B.constructor;return E===void 0?z(B):(h(E,0,t),T===void 0?T=W.rounding:h(T,0,8),_=P(new W(B),E+x(B)+1,T),$=z(_.abs(),!1,E+x(_)+1),B.isneg()&&!B.isZero()?"-"+$:$)},f.toInteger=f.toint=function(){var E=this,T=E.constructor;return P(new T(E),x(E)+1,T.rounding)},f.toNumber=function(){return+this},f.toPower=f.pow=function(E){var T,$,_,B,W,N,U=this,j=U.constructor,R=12,O=+(E=new j(E));if(!E.s)return new j(d);if(U=new j(U),!U.s){if(E.s<1)throw Error(i+"Infinity");return U}if(U.eq(d))return U;if(_=j.precision,E.eq(d))return P(U,_);if(T=E.e,$=E.d.length-1,N=T>=$,W=U.s,N){if(($=O<0?-O:O)<=m){for(B=new j(d),T=Math.ceil(_/p+4),n=!1;$%2&&(B=B.times(U),A(B.d,T)),$=s($/2),$!==0;)U=U.times(U),A(U.d,T);return n=!0,E.s<0?new j(d).div(B):P(B,_)}}else if(W<0)throw Error(i+"NaN");return W=W<0&&E.d[Math.max(T,$)]&1?-1:1,U.s=1,n=!1,B=E.times(C(U,_+R)),n=!0,B=k(B),B.s=W,B},f.toPrecision=function(E,T){var $,_,B=this,W=B.constructor;return E===void 0?($=x(B),_=z(B,$<=W.toExpNeg||$>=W.toExpPos)):(h(E,1,t),T===void 0?T=W.rounding:h(T,0,8),B=P(new W(B),E,T),$=x(B),_=z(B,E<=$||$<=W.toExpNeg,E)),_},f.toSignificantDigits=f.tosd=function(E,T){var $=this,_=$.constructor;return E===void 0?(E=_.precision,T=_.rounding):(h(E,1,t),T===void 0?T=_.rounding:h(T,0,8)),P(new _($),E,T)},f.toString=f.valueOf=f.val=f.toJSON=function(){var E=this,T=x(E),$=E.constructor;return z(E,T<=$.toExpNeg||T>=$.toExpPos)};function v(E,T){var $,_,B,W,N,U,j,R,O=E.constructor,H=O.precision;if(!E.s||!T.s)return T.s||(T=new O(E)),n?P(T,H):T;if(j=E.d,R=T.d,N=E.e,B=T.e,j=j.slice(),W=N-B,W){for(W<0?(_=j,W=-W,U=R.length):(_=R,B=N,U=j.length),N=Math.ceil(H/p),U=N>U?N+1:U+1,W>U&&(W=U,_.length=1),_.reverse();W--;)_.push(0);_.reverse()}for(U=j.length,W=R.length,U-W<0&&(W=U,_=R,R=j,j=_),$=0;W;)$=(j[--W]=j[W]+R[W]+$)/u|0,j[W]%=u;for($&&(j.unshift($),++B),U=j.length;j[--U]==0;)j.pop();return T.d=j,T.e=B,n?P(T,H):T}function h(E,T,$){if(E!==~~E||E<T||E>$)throw Error(a+E)}function y(E){var T,$,_,B=E.length-1,W="",N=E[0];if(B>0){for(W+=N,T=1;T<B;T++)_=E[T]+"",$=p-_.length,$&&(W+=w($)),W+=_;N=E[T],_=N+"",$=p-_.length,$&&(W+=w($))}else if(N===0)return"0";for(;N%10===0;)N/=10;return W+N}var b=(function(){function E(_,B){var W,N=0,U=_.length;for(_=_.slice();U--;)W=_[U]*B+N,_[U]=W%u|0,N=W/u|0;return N&&_.unshift(N),_}function T(_,B,W,N){var U,j;if(W!=N)j=W>N?1:-1;else for(U=j=0;U<W;U++)if(_[U]!=B[U]){j=_[U]>B[U]?1:-1;break}return j}function $(_,B,W){for(var N=0;W--;)_[W]-=N,N=_[W]<B[W]?1:0,_[W]=N*u+_[W]-B[W];for(;!_[0]&&_.length>1;)_.shift()}return function(_,B,W,N){var U,j,R,O,H,q,V,J,K,G,X,te,re,Z,ne,se,ee,ie,ve=_.constructor,Se=_.s==B.s?1:-1,Me=_.d,le=B.d;if(!_.s)return new ve(_);if(!B.s)throw Error(i+"Division by zero");for(j=_.e-B.e,ee=le.length,ne=Me.length,V=new ve(Se),J=V.d=[],R=0;le[R]==(Me[R]||0);)++R;if(le[R]>(Me[R]||0)&&--j,W==null?te=W=ve.precision:N?te=W+(x(_)-x(B))+1:te=W,te<0)return new ve(0);if(te=te/p+2|0,R=0,ee==1)for(O=0,le=le[0],te++;(R<ne||O)&&te--;R++)re=O*u+(Me[R]||0),J[R]=re/le|0,O=re%le|0;else{for(O=u/(le[0]+1)|0,O>1&&(le=E(le,O),Me=E(Me,O),ee=le.length,ne=Me.length),Z=ee,K=Me.slice(0,ee),G=K.length;G<ee;)K[G++]=0;ie=le.slice(),ie.unshift(0),se=le[0],le[1]>=u/2&&++se;do O=0,U=T(le,K,ee,G),U<0?(X=K[0],ee!=G&&(X=X*u+(K[1]||0)),O=X/se|0,O>1?(O>=u&&(O=u-1),H=E(le,O),q=H.length,G=K.length,U=T(H,K,q,G),U==1&&(O--,$(H,ee<q?ie:le,q))):(O==0&&(U=O=1),H=le.slice()),q=H.length,q<G&&H.unshift(0),$(K,H,G),U==-1&&(G=K.length,U=T(le,K,ee,G),U<1&&(O++,$(K,ee<G?ie:le,G))),G=K.length):U===0&&(O++,K=[0]),J[R++]=O,U&&K[0]?K[G++]=Me[Z]||0:(K=[Me[Z]],G=1);while((Z++<ne||K[0]!==void 0)&&te--)}return J[0]||J.shift(),V.e=j,P(V,N?W+x(V)+1:W)}})();function k(E,T){var $,_,B,W,N,U,j=0,R=0,O=E.constructor,H=O.precision;if(x(E)>16)throw Error(o+x(E));if(!E.s)return new O(d);for(T==null?(n=!1,U=H):U=T,N=new O(.03125);E.abs().gte(.1);)E=E.times(N),R+=5;for(_=Math.log(l(2,R))/Math.LN10*2+5|0,U+=_,$=B=W=new O(d),O.precision=U;;){if(B=P(B.times(E),U),$=$.times(++j),N=W.plus(b(B,$,U)),y(N.d).slice(0,U)===y(W.d).slice(0,U)){for(;R--;)W=P(W.times(W),U);return O.precision=H,T==null?(n=!0,P(W,H)):W}W=N}}function x(E){for(var T=E.e*p,$=E.d[0];$>=10;$/=10)T++;return T}function S(E,T,$){if(T>E.LN10.sd())throw n=!0,$&&(E.precision=$),Error(i+"LN10 precision limit exceeded");return P(new E(E.LN10),T)}function w(E){for(var T="";E--;)T+="0";return T}function C(E,T){var $,_,B,W,N,U,j,R,O,H=1,q=10,V=E,J=V.d,K=V.constructor,G=K.precision;if(V.s<1)throw Error(i+(V.s?"NaN":"-Infinity"));if(V.eq(d))return new K(0);if(T==null?(n=!1,R=G):R=T,V.eq(10))return T==null&&(n=!0),S(K,R);if(R+=q,K.precision=R,$=y(J),_=$.charAt(0),W=x(V),Math.abs(W)<15e14){for(;_<7&&_!=1||_==1&&$.charAt(1)>3;)V=V.times(E),$=y(V.d),_=$.charAt(0),H++;W=x(V),_>1?(V=new K("0."+$),W++):V=new K(_+"."+$.slice(1))}else return j=S(K,R+2,G).times(W+""),V=C(new K(_+"."+$.slice(1)),R-q).plus(j),K.precision=G,T==null?(n=!0,P(V,G)):V;for(U=N=V=b(V.minus(d),V.plus(d),R),O=P(V.times(V),R),B=3;;){if(N=P(N.times(O),R),j=U.plus(b(N,new K(B),R)),y(j.d).slice(0,R)===y(U.d).slice(0,R))return U=U.times(2),W!==0&&(U=U.plus(S(K,R+2,G).times(W+""))),U=b(U,new K(H),R),K.precision=G,T==null?(n=!0,P(U,G)):U;U=j,B+=2}}function D(E,T){var $,_,B;for(($=T.indexOf("."))>-1&&(T=T.replace(".","")),(_=T.search(/e/i))>0?($<0&&($=_),$+=+T.slice(_+1),T=T.substring(0,_)):$<0&&($=T.length),_=0;T.charCodeAt(_)===48;)++_;for(B=T.length;T.charCodeAt(B-1)===48;)--B;if(T=T.slice(_,B),T){if(B-=_,$=$-_-1,E.e=s($/p),E.d=[],_=($+1)%p,$<0&&(_+=p),_<B){for(_&&E.d.push(+T.slice(0,_)),B-=p;_<B;)E.d.push(+T.slice(_,_+=p));T=T.slice(_),_=p-T.length}else _-=B;for(;_--;)T+="0";if(E.d.push(+T),n&&(E.e>g||E.e<-g))throw Error(o+$)}else E.s=0,E.e=0,E.d=[0];return E}function P(E,T,$){var _,B,W,N,U,j,R,O,H=E.d;for(N=1,W=H[0];W>=10;W/=10)N++;if(_=T-N,_<0)_+=p,B=T,R=H[O=0];else{if(O=Math.ceil((_+1)/p),W=H.length,O>=W)return E;for(R=W=H[O],N=1;W>=10;W/=10)N++;_%=p,B=_-p+N}if($!==void 0&&(W=l(10,N-B-1),U=R/W%10|0,j=T<0||H[O+1]!==void 0||R%W,j=$<4?(U||j)&&($==0||$==(E.s<0?3:2)):U>5||U==5&&($==4||j||$==6&&(_>0?B>0?R/l(10,N-B):0:H[O-1])%10&1||$==(E.s<0?8:7))),T<1||!H[0])return j?(W=x(E),H.length=1,T=T-W-1,H[0]=l(10,(p-T%p)%p),E.e=s(-T/p)||0):(H.length=1,H[0]=E.e=E.s=0),E;if(_==0?(H.length=O,W=1,O--):(H.length=O+1,W=l(10,p-_),H[O]=B>0?(R/l(10,N-B)%l(10,B)|0)*W:0),j)for(;;)if(O==0){(H[0]+=W)==u&&(H[0]=1,++E.e);break}else{if(H[O]+=W,H[O]!=u)break;H[O--]=0,W=1}for(_=H.length;H[--_]===0;)H.pop();if(n&&(E.e>g||E.e<-g))throw Error(o+x(E));return E}function M(E,T){var $,_,B,W,N,U,j,R,O,H,q=E.constructor,V=q.precision;if(!E.s||!T.s)return T.s?T.s=-T.s:T=new q(E),n?P(T,V):T;if(j=E.d,H=T.d,_=T.e,R=E.e,j=j.slice(),N=R-_,N){for(O=N<0,O?($=j,N=-N,U=H.length):($=H,_=R,U=j.length),B=Math.max(Math.ceil(V/p),U)+2,N>B&&(N=B,$.length=1),$.reverse(),B=N;B--;)$.push(0);$.reverse()}else{for(B=j.length,U=H.length,O=B<U,O&&(U=B),B=0;B<U;B++)if(j[B]!=H[B]){O=j[B]<H[B];break}N=0}for(O&&($=j,j=H,H=$,T.s=-T.s),U=j.length,B=H.length-U;B>0;--B)j[U++]=0;for(B=H.length;B>N;){if(j[--B]<H[B]){for(W=B;W&&j[--W]===0;)j[W]=u-1;--j[W],j[B]+=u}j[B]-=H[B]}for(;j[--U]===0;)j.pop();for(;j[0]===0;j.shift())--_;return j[0]?(T.d=j,T.e=_,n?P(T,V):T):new q(0)}function z(E,T,$){var _,B=x(E),W=y(E.d),N=W.length;return T?($&&(_=$-N)>0?W=W.charAt(0)+"."+W.slice(1)+w(_):N>1&&(W=W.charAt(0)+"."+W.slice(1)),W=W+(B<0?"e":"e+")+B):B<0?(W="0."+w(-B-1)+W,$&&(_=$-N)>0&&(W+=w(_))):B>=N?(W+=w(B+1-N),$&&(_=$-B-1)>0&&(W=W+"."+w(_))):((_=B+1)<N&&(W=W.slice(0,_)+"."+W.slice(_)),$&&(_=$-N)>0&&(B+1===N&&(W+="."),W+=w(_))),E.s<0?"-"+W:W}function A(E,T){if(E.length>T)return E.length=T,!0}function I(E){var T,$,_;function B(W){var N=this;if(!(N instanceof B))return new B(W);if(N.constructor=B,W instanceof B){N.s=W.s,N.e=W.e,N.d=(W=W.d)?W.slice():W;return}if(typeof W=="number"){if(W*0!==0)throw Error(a+W);if(W>0)N.s=1;else if(W<0)W=-W,N.s=-1;else{N.s=0,N.e=0,N.d=[0];return}if(W===~~W&&W<1e7){N.e=0,N.d=[W];return}return D(N,W.toString())}else if(typeof W!="string")throw Error(a+W);if(W.charCodeAt(0)===45?(W=W.slice(1),N.s=-1):N.s=1,c.test(W))D(N,W);else throw Error(a+W)}if(B.prototype=f,B.ROUND_UP=0,B.ROUND_DOWN=1,B.ROUND_CEIL=2,B.ROUND_FLOOR=3,B.ROUND_HALF_UP=4,B.ROUND_HALF_DOWN=5,B.ROUND_HALF_EVEN=6,B.ROUND_HALF_CEIL=7,B.ROUND_HALF_FLOOR=8,B.clone=I,B.config=B.set=L,E===void 0&&(E={}),E)for(_=["precision","rounding","toExpNeg","toExpPos","LN10"],T=0;T<_.length;)E.hasOwnProperty($=_[T++])||(E[$]=this[$]);return B.config(E),B}function L(E){if(!E||typeof E!="object")throw Error(i+"Object expected");var T,$,_,B=["precision",1,t,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(T=0;T<B.length;T+=3)if((_=E[$=B[T]])!==void 0)if(s(_)===_&&_>=B[T+1]&&_<=B[T+2])this[$]=_;else throw Error(a+$+": "+_);if((_=E[$="LN10"])!==void 0)if(_==Math.LN10)this[$]=new this(_);else throw Error(a+$+": "+_);return this}r=I(r),r.default=r.Decimal=r,d=new r(1),typeof define=="function"&&define.amd?define(function(){return r}):typeof AN!="undefined"&&AN.exports?AN.exports=r:(e||(e=typeof self!="undefined"&&self&&self.self==self?self:Function("return this")()),e.Decimal=r)})(Wde)});var c4e,Rde,Ude,$de,Hde,d4e,LN,qde,Vde,Gde=F(()=>{c4e=e=>e,Rde={"@@functional/placeholder":!0},Ude=e=>e===Rde,$de=e=>function t(){return arguments.length===0||arguments.length===1&&Ude(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},Hde=(e,t)=>e===1?t:$de(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];var a=n.filter(o=>o!==Rde).length;return a>=e?t(...n):Hde(e-a,$de(function(){for(var o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];var c=n.map(d=>Ude(d)?s.shift():d);return t(...c,...s)}))}),d4e=e=>Hde(e.length,e),LN=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},qde=d4e((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),Vde=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return c4e;var i=r.reverse(),a=i[0],o=i.slice(1);return function(){return o.reduce((s,l)=>l(s),a(...arguments))}}});function j3(e){var t;return e===0?t=1:t=Math.floor(new z3.default(e).abs().log(10).toNumber())+1,t}function _3(e,t,r){for(var n=new z3.default(e),i=0,a=[];n.lt(t)&&i<1e5;)a.push(n.toNumber()),n=n.add(r),i++;return a}var z3,Yde=F(()=>{z3=Y(O3())});var Di,Kde,Jde,u4e,Qde,B3,W3,Xde=F(()=>{Di=Y(O3());Gde();Yde();Kde=e=>{var[t,r]=e,[n,i]=[t,r];return t>r&&([n,i]=[r,t]),[n,i]},Jde=(e,t,r)=>{if(e.lte(0))return new Di.default(0);var n=j3(e.toNumber()),i=new Di.default(10).pow(n),a=e.div(i),o=n!==1?.05:.1,s=new Di.default(Math.ceil(a.div(o).toNumber())).add(r).mul(o),l=s.mul(i);return t?new Di.default(l.toNumber()):new Di.default(Math.ceil(l.toNumber()))},u4e=(e,t,r)=>{var n=new Di.default(1),i=new Di.default(e);if(!i.isint()&&r){var a=Math.abs(e);a<1?(n=new Di.default(10).pow(j3(e)-1),i=new Di.default(Math.floor(i.div(n).toNumber())).mul(n)):a>1&&(i=new Di.default(Math.floor(e)))}else e===0?i=new Di.default(Math.floor((t-1)/2)):r||(i=new Di.default(Math.floor(e)));var o=Math.floor((t-1)/2),s=Vde(qde(l=>i.add(new Di.default(l-o).mul(n)).toNumber()),LN);return s(0,t)},Qde=function(t,r,n,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new Di.default(0),tickMin:new Di.default(0),tickMax:new Di.default(0)};var o=Jde(new Di.default(r).sub(t).div(n-1),i,a),s;t<=0&&r>=0?s=new Di.default(0):(s=new Di.default(t).add(r).div(2),s=s.sub(new Di.default(s).mod(o)));var l=Math.ceil(s.sub(t).div(o).toNumber()),c=Math.ceil(new Di.default(r).sub(s).div(o).toNumber()),d=l+c+1;return d>n?Qde(t,r,n,i,a+1):(d<n&&(c=r>0?c+(n-d):c,l=r>0?l:l+(n-d)),{step:o,tickMin:s.sub(new Di.default(l).mul(o)),tickMax:s.add(new Di.default(c).mul(o))})},B3=function(t){var[r,n]=t,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(i,2),[s,l]=Kde([r,n]);if(s===-1/0||l===1/0){var c=l===1/0?[s,...LN(0,i-1).map(()=>1/0)]:[...LN(0,i-1).map(()=>-1/0),l];return r>n?c.reverse():c}if(s===l)return u4e(s,i,a);var{step:d,tickMin:u,tickMax:p}=Qde(s,l,o,a,0),m=_3(u,p.add(new Di.default(.1).mul(d)),d);return r>n?m.reverse():m},W3=function(t,r){var[n,i]=t,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[o,s]=Kde([n,i]);if(o===-1/0||s===1/0)return[n,i];if(o===s)return[o];var l=Math.max(r,2),c=Jde(new Di.default(s).sub(o).div(l-1),a,0),d=[..._3(new Di.default(o),new Di.default(s),c),s];return a===!1&&(d=d.map(u=>Math.round(u))),n>i?d.reverse():d}});var Zde=F(()=>{Xde()});var $3,eue,NN,tue,Ih,FN,bw,ON,R3,zN,rue,Mh=F(()=>{$3=e=>e.rootProps.maxBarSize,eue=e=>e.rootProps.barGap,NN=e=>e.rootProps.barCategoryGap,tue=e=>e.rootProps.barSize,Ih=e=>e.rootProps.stackOffset,FN=e=>e.rootProps.reverseStackOrder,bw=e=>e.options.chartName,ON=e=>e.rootProps.syncId,R3=e=>e.rootProps.syncMethod,zN=e=>e.options.eventEmitter,rue=e=>e.rootProps.baseValue});var zr,ys=F(()=>{zr={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3}});var Zd,U3=F(()=>{ys();Zd={allowDecimals:!1,allowDuplicatedCategory:!0,angleAxisId:0,axisLine:!0,axisLineType:"polygon",cx:0,cy:0,orientation:"outer",reversed:!1,scale:"auto",tick:!0,tickLine:!0,tickSize:8,type:"category",zIndex:zr.axis}});var gl,H3=F(()=>{ys();gl={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!0,angle:0,axisLine:!0,includeHidden:!1,hide:!1,label:!1,orientation:"right",radiusAxisId:0,reversed:!1,scale:"auto",stroke:"#ccc",tick:!0,tickCount:5,type:"number",zIndex:zr.axis}});var yb,jN=F(()=>{yb=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t}});var p4e,m4e,f4e,g4e,om,Ah,_N,q3,nue,iue,h4e,V3,aue,G3,oue,eu,zf=F(()=>{Ka();Qp();Ud();Yd();wr();U3();H3();jN();xi();p4e={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Zd.angleAxisId,includeHidden:!1,name:void 0,reversed:Zd.reversed,scale:Zd.scale,tick:Zd.tick,tickCount:void 0,ticks:void 0,type:Zd.type,unit:void 0},m4e={allowDataOverflow:gl.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:gl.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:gl.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:gl.scale,tick:gl.tick,tickCount:gl.tickCount,ticks:void 0,type:gl.type,unit:void 0},f4e={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Zd.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Zd.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Zd.scale,tick:Zd.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},g4e={allowDataOverflow:gl.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:gl.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:gl.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:gl.scale,tick:gl.tick,tickCount:gl.tickCount,ticks:void 0,type:"category",unit:void 0},om=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?f4e:p4e,Ah=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?g4e:m4e,_N=e=>e.polarOptions,q3=de([pl,ml,ji],nle),nue=de([_N,q3],(e,t)=>{if(e!=null)return Bs(e.innerRadius,t,0)}),iue=de([_N,q3],(e,t)=>{if(e!=null)return Bs(e.outerRadius,t,t*.8)}),h4e=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},V3=de([_N],h4e),aue=de([om,V3],yb),G3=de([q3,nue,iue],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]}),oue=de([Ah,G3],yb),eu=de([Jt,_N,nue,iue,pl,ml],(e,t,r,n,i,a)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:o,cy:s,startAngle:l,endAngle:c}=t;return{cx:Bs(o,i,i/2),cy:Bs(s,a,a/2),innerRadius:r,outerRadius:n,startAngle:l,endAngle:c,clockWise:!1}}})});var ci,BN=F(()=>{ci=(e,t)=>t});var bb,Y3=F(()=>{bb=(e,t,r)=>r});function Lh(e){return e==null?void 0:e.id}var gC=F(()=>{});function WN(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:i,dataKey:a}=r,o=new Map;return e.forEach(s=>{var l,c=(l=s.data)!==null&&l!==void 0?l:n;if(!(c==null||c.length===0)){var d=Lh(s);c.forEach((u,p)=>{var m=a==null||i?p:String(fn(u,a,null)),g=fn(u,s.dataKey,0),f;o.has(m)?f=o.get(m):f={},Object.assign(f,{[d]:g}),o.set(m,f)})}}),Array.from(o.values())}var K3=F(()=>{gC();Ja()});function xb(e){return"stackId"in e&&e.stackId!=null&&e.dataKey!=null}var $N=F(()=>{});var xw,J3=F(()=>{xw=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1]});function ww(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function sue(e,t){if(e.length===t.length){for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return!1}var RN=F(()=>{});var Qa,UN=F(()=>{xi();Qa=e=>{var t=Jt(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"}});var Nh,Q3=F(()=>{Nh=e=>e.tooltip.settings.axisId});function lue(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function qN(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lue(Object(r),!0).forEach(function(n){v4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lue(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function v4e(e,t,r){return(t=y4e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y4e(e){var t=b4e(e,"string");return typeof t=="symbol"?t:t+""}function b4e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vC(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}function uue(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function HN(e){if(gs(e)||e instanceof Date){var t=Number(e);if(Lr(t))return t}}function cue(e){if(Array.isArray(e)){var t=[HN(e[0]),HN(e[1])];return am(t)?t:void 0}var r=HN(e);if(r!=null)return[r,r]}function jf(e){return e.map(HN).filter(Eie)}function C4e(e,t,r){return!r||typeof t!="number"||Ga(t)?[]:r.length?jf(r.flatMap(n=>{var i=fn(e,n.dataKey),a,o;if(Array.isArray(i)?[a,o]=i:a=o=i,!(!Lr(a)||!Lr(o)))return[t-a,t+o]})):[]}function A4e(e){var{value:t}=e;if(gs(t)||t instanceof Date)return t}function _4e(e){var t;if(e.x!=null)return jf([e.x]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(n=>n.x);return r==null||r.length===0?[]:jf(r)}function B4e(e){var t;if(e.y!=null)return jf([e.y]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(n=>n.y);return r==null||r.length===0?[]:jf(r)}function H4e(e){if(e!=null){if(e in vb)return vb[e]();var t="scale".concat(kh(e));if(t in vb)return vb[t]()}}function Tw(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var i=H4e(t);if(i!=null){var a=i.domain(r).range(n);return Doe(a),a}}}function fue(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var Z3,X3,No,e8,tu,Fo,t8,ru,x4e,r8,ga,w4e,wb,n8,Fh,k4e,yC,bC,due,i8,S4e,xC,T4e,wC,a8,kC,VN,go,Oh,P4e,o8,kw,s8,D4e,GN,YN,KN,E4e,Sw,I4e,hC,SC,M4e,L4e,l8,kb,N4e,c8,F4e,d8,O4e,u8,z4e,p8,j4e,m8,W4e,$4e,TC,R4e,U4e,CC,f8,g8,sm,PC,h8,DC,q4e,V4e,pue,G4e,Y4e,K4e,J4e,Q4e,X4e,Cw,mue,Sb,wPt,JN,QN,Z4e,e$e,gue,t$e,v8,r$e,n$e,i$e,a$e,o$e,hue,s$e,vue,y8,b8,x8,Pw,EC,w8,k8,S8,XN,T8,nd,id,l$e,kPt,yue,Vl=F(()=>{Ka();Z3=Y(xle());jde();xi();Ja();Of();MN();wr();Rl();Zde();Qp();o6();Ud();vL();Mh();zf();BN();Y3();jN();fL();gC();K3();$N();J3();RN();UN();Q3();X3=[0,"auto"],No={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},e8=(e,t)=>e.cartesianAxis.xAxis[t],tu=(e,t)=>{var r=e8(e,t);return r==null?No:r},Fo={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:X3,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Qy},t8=(e,t)=>e.cartesianAxis.yAxis[t],ru=(e,t)=>{var r=t8(e,t);return r==null?Fo:r},x4e={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},r8=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r==null?x4e:r},ga=(e,t,r)=>{switch(t){case"xAxis":return tu(e,r);case"yAxis":return ru(e,r);case"zAxis":return r8(e,r);case"angleAxis":return om(e,r);case"radiusAxis":return Ah(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},w4e=(e,t,r)=>{switch(t){case"xAxis":return tu(e,r);case"yAxis":return ru(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},wb=(e,t,r)=>{switch(t){case"xAxis":return tu(e,r);case"yAxis":return ru(e,r);case"angleAxis":return om(e,r);case"radiusAxis":return Ah(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},n8=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");Fh=e=>e.graphicalItems.cartesianItems,k4e=de([ci,bb],vC),yC=(e,t,r)=>e.filter(r).filter(n=>(t==null?void 0:t.includeHidden)===!0?!0:!n.hide),bC=de([Fh,ga,k4e],yC,{memoizeOptions:{resultEqualityCheck:ww}}),due=de([bC],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(xb)),i8=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),S4e=de([bC],i8),xC=e=>e.map(t=>t.data).filter(Boolean).flat(1),T4e=de([bC],xC,{memoizeOptions:{resultEqualityCheck:ww}}),wC=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:i}=t;return e.length>0?e:r.slice(n,i+1)},a8=de([T4e,fC],wC),kC=(e,t,r)=>(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:fn(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(i=>({value:fn(i,n)}))):e.map(n=>({value:n})),VN=de([a8,ga,bC],kC);go=e=>{var t=Qa(e),r=Nh(e);return wb(e,t,r)},Oh=de([go],e=>e==null?void 0:e.dataKey),P4e=de([due,fC,go],WN),o8=(e,t,r,n)=>{var i={},a=t.reduce((o,s)=>{if(s.stackId==null)return o;var l=o[s.stackId];return l==null&&(l=[]),l.push(s),o[s.stackId]=l,o},i);return Object.fromEntries(Object.entries(a).map(o=>{var[s,l]=o,c=n?[...l].reverse():l,d=c.map(Lh);return[s,{stackedData:Ioe(e,d,r),graphicalItems:c}]}))},kw=de([P4e,due,Ih,FN],o8),s8=(e,t,r,n)=>{var{dataStartIndex:i,dataEndIndex:a}=t;if(n==null&&r!=="zAxis"){var o=Aoe(e,i,a);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},D4e=de([ga],e=>e.allowDataOverflow),GN=e=>{var t;if(e==null||!("domain"in e))return X3;if(e.domain!=null)return e.domain;if("ticks"in e&&e.ticks!=null){if(e.type==="number"){var r=jf(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e==null?void 0:e.domain)!==null&&t!==void 0?t:X3},YN=de([ga],GN),KN=de([YN,D4e],IN),E4e=de([kw,Xd,ci,KN],s8,{memoizeOptions:{resultEqualityCheck:xw}}),Sw=e=>e.errorBars,I4e=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>uue(r,n)),hC=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r.filter(Boolean);if(i.length!==0){var a=i.flat(),o=Math.min(...a),s=Math.max(...a);return[o,s]}},SC=(e,t,r,n,i)=>{var a,o;if(r.length>0&&e.forEach(s=>{r.forEach(l=>{var c,d,u=(c=n[l.id])===null||c===void 0?void 0:c.filter(h=>uue(i,h)),p=fn(s,(d=t.dataKey)!==null&&d!==void 0?d:l.dataKey),m=C4e(s,p,u);if(m.length>=2){var g=Math.min(...m),f=Math.max(...m);(a==null||g<a)&&(a=g),(o==null||f>o)&&(o=f)}var v=cue(p);v!=null&&(a=a==null?v[0]:Math.min(a,v[0]),o=o==null?v[1]:Math.max(o,v[1]))})}),(t==null?void 0:t.dataKey)!=null&&e.forEach(s=>{var l=cue(fn(s,t.dataKey));l!=null&&(a=a==null?l[0]:Math.min(a,l[0]),o=o==null?l[1]:Math.max(o,l[1]))}),Lr(a)&&Lr(o))return[a,o]},M4e=de([a8,ga,S4e,Sw,ci],SC,{memoizeOptions:{resultEqualityCheck:xw}});L4e=(e,t,r)=>{var n=e.map(A4e).filter(i=>i!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&z$(n))?(0,Z3.default)(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},l8=e=>e.referenceElements.dots,kb=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),N4e=de([l8,ci,bb],kb),c8=e=>e.referenceElements.areas,F4e=de([c8,ci,bb],kb),d8=e=>e.referenceElements.lines,O4e=de([d8,ci,bb],kb),u8=(e,t)=>{if(e!=null){var r=jf(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},z4e=de(N4e,ci,u8),p8=(e,t)=>{if(e!=null){var r=jf(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},j4e=de([F4e,ci],p8);m8=(e,t)=>{if(e!=null){var r=e.flatMap(n=>t==="xAxis"?_4e(n):B4e(n));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},W4e=de([O4e,ci],m8),$4e=de(z4e,W4e,j4e,(e,t,r)=>hC(e,r,t)),TC=(e,t,r,n,i,a,o,s)=>{if(r!=null)return r;var l=o==="vertical"&&s==="xAxis"||o==="horizontal"&&s==="yAxis",c=l?hC(n,a,i):hC(a,i);return Bde(t,c,e.allowDataOverflow)},R4e=de([ga,YN,KN,E4e,M4e,$4e,Jt,ci],TC,{memoizeOptions:{resultEqualityCheck:xw}}),U4e=[0,1],CC=(e,t,r,n,i,a,o)=>{if(!((e==null||r==null||r.length===0)&&o===void 0)){var{dataKey:s,type:l}=e,c=ul(t,a);if(c&&s==null){var d;return(0,Z3.default)(0,(d=r==null?void 0:r.length)!==null&&d!==void 0?d:0)}return l==="category"?L4e(n,e,c):i==="expand"?U4e:o}},f8=de([ga,Jt,a8,VN,Ih,ci,R4e],CC),g8=(e,t,r,n,i)=>{if(e!=null){var{scale:a,type:o}=e;if(a==="auto")return t==="radial"&&i==="radiusAxis"?"band":t==="radial"&&i==="angleAxis"?"linear":o==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":o==="category"?"band":"linear";if(typeof a=="string"){var s="scale".concat(kh(a));return s in vb?s:"point"}}},sm=de([ga,Jt,n8,bw,ci],g8);PC=(e,t,r)=>{var n=GN(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&am(e))return B3(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&am(e))return W3(e,t.tickCount,t.allowDecimals)}},h8=de([f8,wb,sm],PC),DC=(e,t,r,n)=>{if(n!=="angleAxis"&&(e==null?void 0:e.type)==="number"&&am(t)&&Array.isArray(r)&&r.length>0){var i=t[0],a=r[0],o=t[1],s=r[r.length-1];return[Math.min(i,a),Math.max(o,s)]}return t},q4e=de([ga,f8,h8,ci],DC),V4e=de(VN,ga,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(jf(e.map(u=>u.value))).sort((u,p)=>u-p),i=n[0],a=n[n.length-1];if(i==null||a==null)return 1/0;var o=a-i;if(o===0)return 1/0;for(var s=0;s<n.length-1;s++){var l=n[s],c=n[s+1];if(!(l==null||c==null)){var d=c-l;r=Math.min(r,d)}}return r/o}}),pue=de(V4e,Jt,NN,ji,(e,t,r,n,i)=>i,(e,t,r,n,i)=>{if(!Lr(e))return 0;var a=t==="vertical"?n.height:n.width;if(i==="gap")return e*a/2;if(i==="no-gap"){var o=Bs(r,e*a),s=e*a/2;return s-o-(s-o)/a*o}return 0}),G4e=(e,t,r)=>{var n=tu(e,t);return n==null||typeof n.padding!="string"?0:pue(e,"xAxis",t,r,n.padding)},Y4e=(e,t,r)=>{var n=ru(e,t);return n==null||typeof n.padding!="string"?0:pue(e,"yAxis",t,r,n.padding)},K4e=de(tu,G4e,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:i}=e;return typeof i=="string"?{left:t,right:t}:{left:((r=i.left)!==null&&r!==void 0?r:0)+t,right:((n=i.right)!==null&&n!==void 0?n:0)+t}}),J4e=de(ru,Y4e,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:i}=e;return typeof i=="string"?{top:t,bottom:t}:{top:((r=i.top)!==null&&r!==void 0?r:0)+t,bottom:((n=i.bottom)!==null&&n!==void 0?n:0)+t}}),Q4e=de([ji,K4e,Xy,J0,(e,t,r)=>r],(e,t,r,n,i)=>{var{padding:a}=n;return i?[a.left,r.width-a.right]:[e.left+t.left,e.left+e.width-t.right]}),X4e=de([ji,Jt,J4e,Xy,J0,(e,t,r)=>r],(e,t,r,n,i,a)=>{var{padding:o}=i;return a?[n.height-o.bottom,o.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),Cw=(e,t,r,n)=>{var i;switch(t){case"xAxis":return Q4e(e,r,n);case"yAxis":return X4e(e,r,n);case"zAxis":return(i=r8(e,r))===null||i===void 0?void 0:i.range;case"angleAxis":return V3(e);case"radiusAxis":return G3(e,r);default:return}},mue=de([ga,Cw],yb),Sb=de([ga,sm,q4e,mue],Tw),wPt=de([bC,Sw,ci],I4e);JN=(e,t)=>t,QN=(e,t,r)=>r,Z4e=de(G0,JN,QN,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(fue)),e$e=de(Y0,JN,QN,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(fue)),gue=(e,t)=>({width:e.width,height:t.height}),t$e=(e,t)=>{var r=typeof t.width=="number"?t.width:Qy;return{width:r,height:e.height}},v8=de(ji,tu,gue),r$e=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},n$e=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},i$e=de(ml,ji,Z4e,JN,QN,(e,t,r,n,i)=>{var a={},o;return r.forEach(s=>{var l=gue(t,s);o==null&&(o=r$e(t,n,e));var c=n==="top"&&!i||n==="bottom"&&i;a[s.id]=o-Number(c)*l.height,o+=(c?-1:1)*l.height}),a}),a$e=de(pl,ji,e$e,JN,QN,(e,t,r,n,i)=>{var a={},o;return r.forEach(s=>{var l=t$e(t,s);o==null&&(o=n$e(t,n,e));var c=n==="left"&&!i||n==="right"&&i;a[s.id]=o-Number(c)*l.width,o+=(c?-1:1)*l.width}),a}),o$e=(e,t)=>{var r=tu(e,t);if(r!=null)return i$e(e,r.orientation,r.mirror)},hue=de([ji,tu,o$e,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var i=r==null?void 0:r[n];return i==null?{x:e.left,y:0}:{x:e.left,y:i}}}),s$e=(e,t)=>{var r=ru(e,t);if(r!=null)return a$e(e,r.orientation,r.mirror)},vue=de([ji,ru,s$e,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var i=r==null?void 0:r[n];return i==null?{x:0,y:e.top}:{x:i,y:e.top}}}),y8=de(ji,ru,(e,t)=>{var r=typeof t.width=="number"?t.width:Qy;return{width:r,height:e.height}}),b8=(e,t,r)=>{switch(t){case"xAxis":return v8(e,r).width;case"yAxis":return y8(e,r).height;default:return}},x8=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:i,type:a,dataKey:o}=r,s=ul(e,n),l=t.map(c=>c.value);if(o&&s&&a==="category"&&i&&z$(l))return l}},Pw=de([Jt,VN,ga,ci],x8),EC=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:i,scale:a}=r,o=ul(e,n);if(o&&(i==="number"||a!=="auto"))return t.map(s=>s.value)}},w8=de([Jt,VN,wb,ci],EC),k8=de([Jt,w4e,sm,Sb,Pw,w8,Cw,h8,ci],(e,t,r,n,i,a,o,s,l)=>{if(t!=null){var c=ul(e,l);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:l,categoricalDomain:a,duplicateDomain:i,isCategorical:c,niceTicks:s,range:o,realScaleType:r,scale:n}}}),S8=(e,t,r,n,i,a,o,s,l)=>{if(!(t==null||n==null)){var c=ul(e,l),{type:d,ticks:u,tickCount:p}=t,m=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,g=d==="category"&&n.bandwidth?n.bandwidth()/m:0;g=l==="angleAxis"&&a!=null&&a.length>=2?Va(a[0]-a[1])*2*g:g;var f=u||i;if(f){var v=f.map((h,y)=>{var b=o?o.indexOf(h):h;return{index:y,coordinate:n(b)+g,value:h,offset:g}});return v.filter(h=>Lr(h.coordinate))}return c&&s?s.map((h,y)=>({coordinate:n(h)+g,value:h,index:y,offset:g})).filter(h=>Lr(h.coordinate)):n.ticks?n.ticks(p).map(h=>({coordinate:n(h)+g,value:h,offset:g})):n.domain().map((h,y)=>({coordinate:n(h)+g,value:o?o[h]:h,index:y,offset:g}))}},XN=de([Jt,wb,sm,Sb,h8,Cw,Pw,w8,ci],S8),T8=(e,t,r,n,i,a,o)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var s=ul(e,o),{tickCount:l}=t,c=0;return c=o==="angleAxis"&&(n==null?void 0:n.length)>=2?Va(n[0]-n[1])*2*c:c,s&&a?a.map((d,u)=>({coordinate:r(d)+c,value:d,index:u,offset:c})):r.ticks?r.ticks(l).map(d=>({coordinate:r(d)+c,value:d,offset:c})):r.domain().map((d,u)=>({coordinate:r(d)+c,value:i?i[d]:d,index:u,offset:c}))}},nd=de([Jt,wb,Sb,Cw,Pw,w8,ci],T8),id=de(ga,Sb,(e,t)=>{if(!(e==null||t==null))return qN(qN({},e),{},{scale:t})}),l$e=de([ga,sm,f8,mue],Tw),kPt=de((e,t,r)=>r8(e,r),l$e,(e,t)=>{if(!(e==null||t==null))return qN(qN({},e),{},{scale:t})}),yue=de([Jt,G0,Y0],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}})});function D8(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function IC(e,t){var r=C8(e),n=P8(e);return D8(t,r,n)}function bue(e){return je(t=>IC(t,e))}var C8,P8,MC=F(()=>{Jr();C8=e=>e.options.defaultTooltipEventType,P8=e=>e.options.validateTooltipEventTypes});var ZN,E8=F(()=>{wr();ZN=(e,t)=>{var r,n=Number(t);if(!(Ga(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0}});var xue,wue=F(()=>{xue=e=>e.tooltip.settings});var _f,c$e,kue,Sue,Tue,Cue,Pue,e2,Due,t2,Eue,r2,Iue,n2,i2,Mue,Zu=F(()=>{Lo();_f={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},c$e={itemInteraction:{click:_f,hover:_f},axisInteraction:{click:_f,hover:_f},keyboardInteraction:_f,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},kue=Pi({name:"tooltip",initialState:c$e,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:bi()},replaceTooltipEntrySettings:{reducer(e,t){var{prev:r,next:n}=t.payload,i=dl(e).tooltipItemPayloads.indexOf(r);i>-1&&(e.tooltipItemPayloads[i]=n)},prepare:bi()},removeTooltipEntrySettings:{reducer(e,t){var r=dl(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},prepare:bi()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate}}}),{addTooltipEntrySettings:Sue,replaceTooltipEntrySettings:Tue,removeTooltipEntrySettings:Cue,setTooltipSettingsState:Pue,setActiveMouseOverItemIndex:e2,mouseLeaveItem:Due,mouseLeaveChart:t2,setActiveClickItemIndex:Eue,setMouseOverAxisIndex:r2,setMouseClickAxisIndex:Iue,setSyncInteraction:n2,setKeyboardInteraction:i2}=kue.actions,Mue=kue.reducer});function Aue(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function a2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Aue(Object(r),!0).forEach(function(n){d$e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Aue(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function d$e(e,t,r){return(t=u$e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u$e(e){var t=p$e(e,"string");return typeof t=="symbol"?t:t+""}function p$e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function m$e(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function f$e(e){return e.index!=null}var o2,I8=F(()=>{Zu();o2=(e,t,r,n)=>{if(t==null)return _f;var i=m$e(e,t,r);if(i==null)return _f;if(i.active)return i;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var a=e.settings.active===!0;if(f$e(i)){if(a)return a2(a2({},i),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n,graphicalItemId:void 0};return a2(a2({},_f),{},{coordinate:i.coordinate})}});function g$e(e){if(typeof e=="number")return Number.isFinite(e)?e:void 0;if(e instanceof Date){var t=e.valueOf();return Number.isFinite(t)?t:void 0}var r=Number(e);return Number.isFinite(r)?r:void 0}function h$e(e,t){var r=g$e(e),n=t[0],i=t[1];if(r===void 0)return!1;var a=Math.min(n,i),o=Math.max(n,i);return r>=a&&r<=o}function v$e(e,t,r){if(r==null||t==null)return!0;var n=fn(e,t);return n==null||!am(r)?!0:h$e(n,r)}var Dw,s2=F(()=>{Rl();Ja();MN();Dw=(e,t,r,n)=>{var i=e==null?void 0:e.index;if(i==null)return null;var a=Number(i);if(!Lr(a))return i;var o=0,s=1/0;t.length>0&&(s=t.length-1);var l=Math.max(o,Math.min(a,s)),c=t[l];return c==null||v$e(c,r,n)?String(l):null}});var l2,M8=F(()=>{l2=(e,t,r,n,i,a,o,s)=>{if(!(a==null||s==null)){var l=o[0],c=l==null?void 0:s(l.positions,a);if(c!=null)return c;var d=i==null?void 0:i[Number(a)];if(d)return r==="horizontal"?{x:d.coordinate,y:(n.top+t)/2}:{x:(n.left+e)/2,y:d.coordinate}}}});var c2,A8=F(()=>{c2=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var i;if(r==="hover"?i=e.itemInteraction.hover.graphicalItemId:i=e.itemInteraction.click.graphicalItemId,i==null&&n!=null){var a=e.tooltipItemPayloads[0];return a!=null?[a]:[]}return e.tooltipItemPayloads.filter(o=>{var s;return((s=o.settings)===null||s===void 0?void 0:s.graphicalItemId)===i})}});var zh,d2=F(()=>{zh=e=>e.options.tooltipPayloadSearcher});var Bf,u2=F(()=>{Bf=e=>e.tooltip});function Lue(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Nue(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Lue(Object(r),!0).forEach(function(n){y$e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lue(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function y$e(e,t,r){return(t=b$e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b$e(e){var t=x$e(e,"string");return typeof t=="symbol"?t:t+""}function x$e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function w$e(e,t){return e!=null?e:t}var p2,L8=F(()=>{wr();Ja();ZR();p2=(e,t,r,n,i,a,o)=>{if(!(t==null||a==null)){var{chartData:s,computedData:l,dataStartIndex:c,dataEndIndex:d}=r,u=[];return e.reduce((p,m)=>{var g,{dataDefinedOnItem:f,settings:v}=m,h=w$e(f,s),y=Array.isArray(h)?uL(h,c,d):h,b=(g=v==null?void 0:v.dataKey)!==null&&g!==void 0?g:n,k=v==null?void 0:v.nameKey,x;if(n&&Array.isArray(y)&&!Array.isArray(y[0])&&o==="axis"?x=AA(y,n,i):x=a(y,t,l,k),Array.isArray(x))x.forEach(w=>{var C=Nue(Nue({},v),{},{name:w.name,unit:w.unit,color:void 0,fill:void 0});p.push(a6({tooltipEntrySettings:C,dataKey:w.dataKey,payload:w.payload,value:fn(w.payload,w.dataKey),name:w.name}))});else{var S;p.push(a6({tooltipEntrySettings:v,dataKey:b,payload:x,value:fn(x,b),name:(S=fn(x,k))!==null&&S!==void 0?S:v==null?void 0:v.name}))}return p},u)}}});var N8,k$e,S$e,Tb,T$e,C$e,jh,P$e,F8,Fue,D$e,Oue,E$e,I$e,M$e,A$e,L$e,N$e,F$e,O$e,z$e,j$e,_$e,B$e,W$e,Cb,$$e,R$e,zue,O8,z8,U$e,H$e,q$e,kc,j8,jue,_8,AC,lm,m2,f2,yDt,_ue,V$e,Bue,Wue,G$e,$ue,ep=F(()=>{Ka();Vl();xi();Ja();Of();Mh();wr();jN();MC();E8();wue();I8();s2();M8();Qp();Ud();A8();d2();u2();L8();Q3();UN();K3();$N();MN();J3();RN();N8=de([go,Jt,n8,bw,Qa],g8),k$e=de([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),S$e=de([Qa,Nh],vC),Tb=de([k$e,go,S$e],yC,{memoizeOptions:{resultEqualityCheck:ww}}),T$e=de([Tb],e=>e.filter(xb)),C$e=de([Tb],xC,{memoizeOptions:{resultEqualityCheck:ww}}),jh=de([C$e,Xd],wC),P$e=de([T$e,Xd,go],WN),F8=de([jh,go,Tb],kC),Fue=de([go],GN),D$e=de([go],e=>e.allowDataOverflow),Oue=de([Fue,D$e],IN),E$e=de([Tb],e=>e.filter(xb)),I$e=de([P$e,E$e,Ih,FN],o8),M$e=de([I$e,Xd,Qa,Oue],s8),A$e=de([Tb],i8),L$e=de([jh,go,A$e,Sw,Qa],SC,{memoizeOptions:{resultEqualityCheck:xw}}),N$e=de([l8,Qa,Nh],kb),F$e=de([N$e,Qa],u8),O$e=de([c8,Qa,Nh],kb),z$e=de([O$e,Qa],p8),j$e=de([d8,Qa,Nh],kb),_$e=de([j$e,Qa],m8),B$e=de([F$e,_$e,z$e],hC),W$e=de([go,Fue,Oue,M$e,L$e,B$e,Jt,Qa],TC),Cb=de([go,Jt,jh,F8,Ih,Qa,W$e],CC),$$e=de([Cb,go,N8],PC),R$e=de([go,Cb,$$e,Qa],DC),zue=e=>{var t=Qa(e),r=Nh(e),n=!1;return Cw(e,t,r,n)},O8=de([go,zue],yb),z8=de([go,N8,R$e,O8],Tw),U$e=de([Jt,F8,go,Qa],x8),H$e=de([Jt,F8,go,Qa],EC),q$e=(e,t,r,n,i,a,o,s)=>{if(t){var{type:l}=t,c=ul(e,s);if(n){var d=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,u=l==="category"&&n.bandwidth?n.bandwidth()/d:0;return u=s==="angleAxis"&&i!=null&&(i==null?void 0:i.length)>=2?Va(i[0]-i[1])*2*u:u,c&&o?o.map((p,m)=>({coordinate:n(p)+u,value:p,index:m,offset:u})):n.domain().map((p,m)=>({coordinate:n(p)+u,value:a?a[p]:p,index:m,offset:u}))}}},kc=de([Jt,go,N8,z8,zue,U$e,H$e,Qa],q$e),j8=de([C8,P8,xue],(e,t,r)=>D8(r.shared,e,t)),jue=e=>e.tooltip.settings.trigger,_8=e=>e.tooltip.settings.defaultIndex,AC=de([Bf,j8,jue,_8],o2),lm=de([AC,jh,Oh,Cb],Dw),m2=de([kc,lm],ZN),f2=de([AC],e=>{if(e)return e.dataKey}),yDt=de([AC],e=>{if(e)return e.graphicalItemId}),_ue=de([Bf,j8,jue,_8],c2),V$e=de([pl,ml,Jt,ji,kc,_8,_ue,zh],l2),Bue=de([AC,V$e],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),Wue=de([AC],e=>{var t;return(t=e==null?void 0:e.active)!==null&&t!==void 0?t:!1}),G$e=de([_ue,lm,Xd,Oh,m2,zh,j8],p2),$ue=de([G$e],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}})});function Rue(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Uue(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Rue(Object(r),!0).forEach(function(n){Y$e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rue(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Y$e(e,t,r){return(t=K$e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K$e(e){var t=J$e(e,"string");return typeof t=="symbol"?t:t+""}function J$e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Q$e,Hue,que=F(()=>{Jr();Ja();Vl();ep();Q$e=()=>je(go),Hue=()=>{var e=Q$e(),t=je(kc),r=je(z8);return!e||!r?Ul(void 0,t):Ul(Uue(Uue({},e),{},{scale:r}),t)}});function Vue(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ew(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Vue(Object(r),!0).forEach(function(n){X$e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Vue(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function X$e(e,t,r){return(t=Z$e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Z$e(e){var t=eRe(e,"string");return typeof t=="symbol"?t:t+""}function eRe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kue(e,t){var{chartX:r,chartY:n}=e;return r>=t.left&&r<=t.left+t.width&&n>=t.top&&n<=t.top+t.height}var Gue,Yue,B8,Jue=F(()=>{Yd();wr();Gue=(e,t,r,n)=>{var i=t.find(a=>a&&a.index===r);if(i){if(e==="horizontal")return{x:i.coordinate,y:n.chartY};if(e==="vertical")return{x:n.chartX,y:i.coordinate}}return{x:0,y:0}},Yue=(e,t,r,n)=>{var i=t.find(c=>c&&c.index===r);if(i){if(e==="centric"){var a=i.coordinate,{radius:o}=n;return Ew(Ew(Ew({},n),an(n.cx,n.cy,o,a)),{},{angle:a,radius:o})}var s=i.coordinate,{angle:l}=n;return Ew(Ew(Ew({},n),an(n.cx,n.cy,s,l)),{},{angle:l,radius:s})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};B8=(e,t,r,n,i)=>{var a,o=(a=t==null?void 0:t.length)!==null&&a!==void 0?a:0;if(o<=1||e==null)return 0;if(n==="angleAxis"&&i!=null&&Math.abs(Math.abs(i[1]-i[0])-360)<=1e-6)for(var s=0;s<o;s++){var l,c,d,u,p,m=s>0?(l=r[s-1])===null||l===void 0?void 0:l.coordinate:(c=r[o-1])===null||c===void 0?void 0:c.coordinate,g=(d=r[s])===null||d===void 0?void 0:d.coordinate,f=s>=o-1?(u=r[0])===null||u===void 0?void 0:u.coordinate:(p=r[s+1])===null||p===void 0?void 0:p.coordinate,v=void 0;if(!(m==null||g==null||f==null))if(Va(g-m)!==Va(f-g)){var h=[];if(Va(f-g)===Va(i[1]-i[0])){v=f;var y=g+i[1]-i[0];h[0]=Math.min(y,(y+m)/2),h[1]=Math.max(y,(y+m)/2)}else{v=m;var b=f+i[1]-i[0];h[0]=Math.min(g,(b+g)/2),h[1]=Math.max(g,(b+g)/2)}var k=[Math.min(g,(v+g)/2),Math.max(g,(v+g)/2)];if(e>k[0]&&e<=k[1]||e>=h[0]&&e<=h[1]){var x;return(x=r[s])===null||x===void 0?void 0:x.index}}else{var S=Math.min(m,f),w=Math.max(m,f);if(e>(S+g)/2&&e<=(w+g)/2){var C;return(C=r[s])===null||C===void 0?void 0:C.index}}}else if(t)for(var D=0;D<o;D++){var P=t[D];if(P!=null){var M=t[D+1],z=t[D-1];if(D===0&&M!=null&&e<=(P.coordinate+M.coordinate)/2||D===o-1&&z!=null&&e>(P.coordinate+z.coordinate)/2||D>0&&D<o-1&&z!=null&&M!=null&&e>(P.coordinate+z.coordinate)/2&&e<=(P.coordinate+M.coordinate)/2)return P.index}}return-1}});var Que,g2,W8,Xue,$8,Zue,R8,U8,epe,tpe,LC,rpe,H8,npe,ipe,tRe,rRe,ape,Pb=F(()=>{Ka();Que=Y(F1());Jr();Ja();Of();ep();Vl();Mh();xi();Ud();Qp();E8();I8();s2();M8();A8();d2();u2();L8();Jue();Yd();g2=()=>je(bw),W8=(e,t)=>t,Xue=(e,t,r)=>r,$8=(e,t,r,n)=>n,Zue=de(kc,e=>(0,Que.default)(e,t=>t.coordinate)),R8=de([Bf,W8,Xue,$8],o2),U8=de([R8,jh,Oh,Cb],Dw),epe=(e,t,r)=>{if(t!=null){var n=Bf(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},tpe=de([Bf,W8,Xue,$8],c2),LC=de([pl,ml,Jt,ji,kc,$8,tpe,zh],l2),rpe=de([R8,LC],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),H8=de([kc,U8],ZN),npe=de([tpe,U8,Xd,Oh,H8,zh,W8],p2),ipe=de([R8,U8],(e,t)=>({isActive:e.active&&t!=null,activeIndex:t})),tRe=(e,t,r,n,i,a,o)=>{if(!(!e||!r||!n||!i)&&Kue(e,o)){var s=Loe(e,t),l=B8(s,a,i,r,n),c=Gue(t,i,l,e);return{activeIndex:String(l),activeCoordinate:c}}},rRe=(e,t,r,n,i,a,o)=>{if(!(!e||!n||!i||!a||!r)){var s=ile(e,r);if(s){var l=Noe(s,t),c=B8(l,o,a,n,i),d=Yue(t,a,c,s);return{activeIndex:String(c),activeCoordinate:d}}}},ape=(e,t,r,n,i,a,o,s)=>{if(!(!e||!t||!n||!i||!a))return t==="horizontal"||t==="vertical"?tRe(e,t,n,i,a,o,s):rRe(e,t,r,n,i,a,o)}});var ope,spe,q8=F(()=>{Ka();RN();ys();ope=de(e=>e.zIndex.zIndexMap,(e,t)=>t,(e,t,r)=>r,(e,t,r)=>{if(t!=null){var n=e[t];if(n!=null)return r?n.panoramaElement:n.element}}),spe=de(e=>e.zIndex.zIndexMap,e=>{var t=Object.keys(e).map(n=>parseInt(n,10)).concat(Object.values(zr)),r=Array.from(new Set(t));return r.sort((n,i)=>n-i)},{memoizeOptions:{resultEqualityCheck:sue}})});function lpe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function cpe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lpe(Object(r),!0).forEach(function(n){nRe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lpe(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nRe(e,t,r){return(t=iRe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iRe(e){var t=aRe(e,"string");return typeof t=="symbol"?t:t+""}function aRe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cRe(e){return lRe.has(e)}var oRe,sRe,lRe,dpe,upe,ppe,mpe,fpe,gpe,h2=F(()=>{Lo();ys();oRe={},sRe={zIndexMap:Object.values(zr).reduce((e,t)=>cpe(cpe({},e),{},{[t]:{element:void 0,panoramaElement:void 0,consumers:0}}),oRe)},lRe=new Set(Object.values(zr));dpe=Pi({name:"zIndex",initialState:sRe,reducers:{registerZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]?e.zIndexMap[r].consumers+=1:e.zIndexMap[r]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:bi()},unregisterZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(e.zIndexMap[r].consumers-=1,e.zIndexMap[r].consumers<=0&&!cRe(r)&&delete e.zIndexMap[r])},prepare:bi()},registerZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:r,element:n,isPanorama:i}=t.payload;e.zIndexMap[r]?i?e.zIndexMap[r].panoramaElement=n:e.zIndexMap[r].element=n:e.zIndexMap[r]={consumers:0,element:i?void 0:n,panoramaElement:i?n:void 0}},prepare:bi()},unregisterZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(t.payload.isPanorama?e.zIndexMap[r].panoramaElement=void 0:e.zIndexMap[r].element=void 0)},prepare:bi()}}}),{registerZIndexPortal:upe,unregisterZIndexPortal:ppe,registerZIndexPortalElement:mpe,unregisterZIndexPortalElement:fpe}=dpe.actions,gpe=dpe.reducer});function Fn(e){var{zIndex:t,children:r}=e,n=Uoe(),i=n&&t!==void 0&&t!==0,a=Qr(),o=lr();(0,hpe.useLayoutEffect)(()=>i?(o(upe({zIndex:t})),()=>{o(ppe({zIndex:t}))}):qy,[o,t,i]);var s=je(l=>ope(l,t,a));return i?s?(0,vpe.createPortal)(r,s):null:r}var hpe,vpe,hl=F(()=>{hpe=Y(Q()),vpe=Y(Td());wr();Jr();q8();h2();xi();hs()});function V8(){return V8=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},V8.apply(null,arguments)}function ype(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function v2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ype(Object(r),!0).forEach(function(n){dRe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ype(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dRe(e,t,r){return(t=uRe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uRe(e){var t=pRe(e,"string");return typeof t=="symbol"?t:t+""}function pRe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mRe(e){var{cursor:t,cursorComp:r,cursorProps:n}=e;return(0,Iw.isValidElement)(t)?(0,Iw.cloneElement)(t,n):(0,Iw.createElement)(r,n)}function fRe(e){var t,{coordinate:r,payload:n,index:i,offset:a,tooltipAxisBandSize:o,layout:s,cursor:l,tooltipEventType:c,chartName:d}=e,u=r,p=n,m=i;if(!l||!u||d!=="ScatterChart"&&c!=="axis")return null;var g,f,v;if(d==="ScatterChart")g=u,f=fse,v=zr.cursorLine;else if(d==="BarChart")g=hse(s,u,a,o),f=FL,v=zr.cursorRectangle;else if(s==="radial"&&LA(u)){var{cx:h,cy:y,radius:b,startAngle:k,endAngle:x}=zL(u);g={cx:h,cy:y,startAngle:k,endAngle:x,innerRadius:b,outerRadius:b},f=_L,v=zr.cursorLine}else g={points:fle(s,u,a)},f=Sh,v=zr.cursorLine;var S=typeof l=="object"&&"className"in l?l.className:void 0,w=v2(v2(v2(v2({stroke:"#ccc",pointerEvents:"none"},a),g),yc(l)),{},{payload:p,payloadIndex:m,className:wt("recharts-tooltip-cursor",S)});return y2.createElement(Fn,{zIndex:(t=e.zIndex)!==null&&t!==void 0?t:v},y2.createElement(mRe,{cursor:l,cursorComp:f,cursorProps:w}))}function bpe(e){var t=Hue(),r=bL(),n=xc(),i=g2();return t==null||r==null||n==null||i==null?null:y2.createElement(fRe,V8({},e,{offset:r,layout:n,tooltipAxisBandSize:t,chartName:i}))}var y2,Iw,xpe=F(()=>{y2=Y(Q()),Iw=Y(Q());Zn();qu();PL();gse();vse();C6();P6();E6();gle();xi();que();Pb();js();hl();ys()});var b2,G8,wpe,Y8=F(()=>{b2=Y(Q()),G8=(0,b2.createContext)(null),wpe=()=>(0,b2.useContext)(G8)});var Spe=Fe((PEt,K8)=>{"use strict";var gRe=Object.prototype.hasOwnProperty,Gl="~";function NC(){}Object.create&&(NC.prototype=Object.create(null),new NC().__proto__||(Gl=!1));function hRe(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function kpe(e,t,r,n,i){if(typeof r!="function")throw new TypeError("The listener must be a function");var a=new hRe(r,n||e,i),o=Gl?Gl+t:t;return e._events[o]?e._events[o].fn?e._events[o]=[e._events[o],a]:e._events[o].push(a):(e._events[o]=a,e._eventsCount++),e}function x2(e,t){--e._eventsCount===0?e._events=new NC:delete e._events[t]}function vl(){this._events=new NC,this._eventsCount=0}vl.prototype.eventNames=function(){var t=[],r,n;if(this._eventsCount===0)return t;for(n in r=this._events)gRe.call(r,n)&&t.push(Gl?n.slice(1):n);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(r)):t};vl.prototype.listeners=function(t){var r=Gl?Gl+t:t,n=this._events[r];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,a=n.length,o=new Array(a);i<a;i++)o[i]=n[i].fn;return o};vl.prototype.listenerCount=function(t){var r=Gl?Gl+t:t,n=this._events[r];return n?n.fn?1:n.length:0};vl.prototype.emit=function(t,r,n,i,a,o){var s=Gl?Gl+t:t;if(!this._events[s])return!1;var l=this._events[s],c=arguments.length,d,u;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),c){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,r),!0;case 3:return l.fn.call(l.context,r,n),!0;case 4:return l.fn.call(l.context,r,n,i),!0;case 5:return l.fn.call(l.context,r,n,i,a),!0;case 6:return l.fn.call(l.context,r,n,i,a,o),!0}for(u=1,d=new Array(c-1);u<c;u++)d[u-1]=arguments[u];l.fn.apply(l.context,d)}else{var p=l.length,m;for(u=0;u<p;u++)switch(l[u].once&&this.removeListener(t,l[u].fn,void 0,!0),c){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,r);break;case 3:l[u].fn.call(l[u].context,r,n);break;case 4:l[u].fn.call(l[u].context,r,n,i);break;default:if(!d)for(m=1,d=new Array(c-1);m<c;m++)d[m-1]=arguments[m];l[u].fn.apply(l[u].context,d)}}return!0};vl.prototype.on=function(t,r,n){return kpe(this,t,r,n,!1)};vl.prototype.once=function(t,r,n){return kpe(this,t,r,n,!0)};vl.prototype.removeListener=function(t,r,n,i){var a=Gl?Gl+t:t;if(!this._events[a])return this;if(!r)return x2(this,a),this;var o=this._events[a];if(o.fn)o.fn===r&&(!i||o.once)&&(!n||o.context===n)&&x2(this,a);else{for(var s=0,l=[],c=o.length;s<c;s++)(o[s].fn!==r||i&&!o[s].once||n&&o[s].context!==n)&&l.push(o[s]);l.length?this._events[a]=l.length===1?l[0]:l:x2(this,a)}return this};vl.prototype.removeAllListeners=function(t){var r;return t?(r=Gl?Gl+t:t,this._events[r]&&x2(this,r)):(this._events=new NC,this._eventsCount=0),this};vl.prototype.off=vl.prototype.removeListener;vl.prototype.addListener=vl.prototype.on;vl.prefixed=Gl;vl.EventEmitter=vl;typeof K8!="undefined"&&(K8.exports=vl)});var Tpe,Cpe,Ppe=F(()=>{Tpe=Y(Spe(),1),Cpe=Tpe.default});var Mw,w2,J8,Dpe=F(()=>{Ppe();Mw=new Cpe,w2="recharts.syncEvent.tooltip",J8="recharts.syncEvent.brush"});function cm(e,t){if(t){var r=Number.parseInt(t,10);if(!Ga(r))return e==null?void 0:e[r]}}var vRe,Epe,Ipe,Mpe,_h=F(()=>{Lo();wr();vRe={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},Epe=Pi({name:"options",initialState:vRe,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),Ipe=Epe.reducer,{createEventEmitter:Mpe}=Epe.actions});function Ape(e){return e.tooltip.syncInteraction}var Lpe=F(()=>{});var yRe,Npe,Q8,Fpe,bRe,Ope,k2=F(()=>{Lo();yRe={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},Npe=Pi({name:"chartData",initialState:yRe,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:Q8,setDataStartEndIndexes:Fpe,setComputedData:bRe}=Npe.actions,Ope=Npe.reducer});function zpe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Aw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zpe(Object(r),!0).forEach(function(n){wRe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zpe(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wRe(e,t,r){return(t=kRe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kRe(e){var t=SRe(e,"string");return typeof t=="symbol"?t:t+""}function SRe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function TRe(e,t){if(e==null)return{};var r,n,i=CRe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function CRe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function PRe(){var e=je(ON),t=je(zN),r=lr(),n=je(R3),i=je(kc),a=xc(),o=Ef(),s=je(l=>l.rootProps.className);(0,FC.useEffect)(()=>{if(e==null)return qy;var l=(c,d,u)=>{if(t!==u&&e===c){if(n==="index"){var p;if(o&&d!==null&&d!==void 0&&(p=d.payload)!==null&&p!==void 0&&p.coordinate&&d.payload.sourceViewBox){var m=d.payload.coordinate,{x:g,y:f}=m,v=TRe(m,xRe),{x:h,y,width:b,height:k}=d.payload.sourceViewBox,x=Aw(Aw({},v),{},{x:o.x+(b?(g-h)/b:0)*o.width,y:o.y+(k?(f-y)/k:0)*o.height});r(Aw(Aw({},d),{},{payload:Aw(Aw({},d.payload),{},{coordinate:x})}))}else r(d);return}if(i!=null){var S;if(typeof n=="function"){var w={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},C=n(i,w);S=i[C]}else n==="value"&&(S=i.find(E=>String(E.value)===d.payload.label));var{coordinate:D}=d.payload;if(S==null||d.payload.active===!1||D==null||o==null){r(n2({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:P,y:M}=D,z=Math.min(P,o.x+o.width),A=Math.min(M,o.y+o.height),I={x:a==="horizontal"?S.coordinate:z,y:a==="horizontal"?A:S.coordinate},L=n2({active:d.payload.active,coordinate:I,dataKey:d.payload.dataKey,index:String(S.index),label:d.payload.label,sourceViewBox:d.payload.sourceViewBox,graphicalItemId:d.payload.graphicalItemId});r(L)}}};return Mw.on(w2,l),()=>{Mw.off(w2,l)}},[s,r,t,e,n,i,a,o])}function DRe(){var e=je(ON),t=je(zN),r=lr();(0,FC.useEffect)(()=>{if(e==null)return qy;var n=(i,a,o)=>{t!==o&&e===i&&r(Fpe(a))};return Mw.on(J8,n),()=>{Mw.off(J8,n)}},[r,t,e])}function jpe(){var e=lr();(0,FC.useEffect)(()=>{e(Mpe())},[e]),PRe(),DRe()}function _pe(e,t,r,n,i,a){var o=je(m=>epe(m,e,t)),s=je(zN),l=je(ON),c=je(R3),d=je(Ape),u=d==null?void 0:d.active,p=Ef();(0,FC.useEffect)(()=>{if(!u&&l!=null&&s!=null){var m=n2({active:a,coordinate:r,dataKey:o,index:i,label:typeof n=="number"?String(n):n,sourceViewBox:p,graphicalItemId:void 0});Mw.emit(w2,l,m,s)}},[u,r,o,i,n,s,l,c,a,p])}var FC,xRe,X8=F(()=>{FC=Y(Q());Jr();Mh();Dpe();_h();Zu();Pb();ep();Lpe();xi();k2();wr();xRe=["x","y"]});function Bpe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Wpe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Bpe(Object(r),!0).forEach(function(n){ERe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Bpe(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ERe(e,t,r){return(t=IRe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IRe(e){var t=MRe(e,"string");return typeof t=="symbol"?t:t+""}function MRe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ARe(e){return e.dataKey}function LRe(e,t){return nu.isValidElement(e)?nu.cloneElement(e,t):typeof e=="function"?nu.createElement(e,t):nu.createElement(Xoe,t)}function ho(e){var t,r,n=pr(e,NRe),{active:i,allowEscapeViewBox:a,animationDuration:o,animationEasing:s,content:l,filterNull:c,isAnimationActive:d,offset:u,payloadUniqBy:p,position:m,reverseDirection:g,useTranslate3d:f,wrapperStyle:v,cursor:h,shared:y,trigger:b,defaultIndex:k,portal:x,axisId:S}=n,w=lr(),C=typeof k=="number"?String(k):k;(0,Rpe.useEffect)(()=>{w(Pue({shared:y,trigger:b,axisId:S,active:i,defaultIndex:C}))},[w,y,b,S,i,C]);var D=Ef(),P=TL(),M=bue(y),{activeIndex:z,isActive:A}=(t=je(H=>ipe(H,M,b,C)))!==null&&t!==void 0?t:{},I=je(H=>npe(H,M,b,C)),L=je(H=>H8(H,M,b,C)),E=je(H=>rpe(H,M,b,C)),T=I,$=wpe(),_=(r=i!=null?i:A)!==null&&r!==void 0?r:!1,[B,W]=qA([T,_]),N=M==="axis"?L:void 0;_pe(M,b,E,N,z,_);var U=x!=null?x:$;if(U==null||D==null||M==null)return null;var j=T!=null?T:$pe;_||(j=$pe),c&&j.length&&(j=BA(j.filter(H=>H.value!=null&&(H.hide!==!0||n.includeHidden)),p,ARe));var R=j.length>0,O=nu.createElement(SL,{allowEscapeViewBox:a,animationDuration:o,animationEasing:s,isAnimationActive:d,active:_,coordinate:E,hasPayload:R,offset:u,position:m,reverseDirection:g,useTranslate3d:f,viewBox:D,wrapperStyle:v,lastBoundingBox:B,innerRef:W,hasPortalFromProps:!!x},LRe(l,Wpe(Wpe({},n),{},{payload:j,label:N,active:_,activeIndex:z,coordinate:E,accessibilityLayer:P})));return nu.createElement(nu.Fragment,null,(0,Upe.createPortal)(O,U),_&&nu.createElement(bpe,{cursor:h,tooltipEventType:M,coordinate:E,payload:j,index:z}))}var nu,Rpe,Upe,$pe,NRe,Hpe=F(()=>{nu=Y(Q()),Rpe=Y(Q()),Upe=Y(Td());Zoe();ose();bR();xi();b6();FR();xpe();Pb();Y8();Jr();Zu();X8();MC();ma();$pe=[],NRe={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}}});var Z8,qpe=F(()=>{Z8=e=>null;Z8.displayName="Cell"});function FRe(e,t,r){return(t=ORe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ORe(e){var t=zRe(e,"string");return typeof t=="symbol"?t:t+""}function zRe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var S2,Vpe=F(()=>{S2=class{constructor(t){FRe(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;n!=null&&this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}});function Gpe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function jRe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Gpe(Object(r),!0).forEach(function(n){_Re(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Gpe(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _Re(e,t,r){return(t=BRe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BRe(e){var t=WRe(e,"string");return typeof t=="symbol"?t:t+""}function WRe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function URe(e,t){var r=t.fontSize||"",n=t.fontFamily||"",i=t.fontWeight||"",a=t.fontStyle||"",o=t.letterSpacing||"",s=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(i,"|").concat(a,"|").concat(o,"|").concat(s)}var $Re,Qpe,Ype,RRe,Kpe,Jpe,Db,eU=F(()=>{Zy();Vpe();$Re={cacheSize:2e3,enableCache:!0},Qpe=jRe({},$Re),Ype=new S2(Qpe.cacheSize),RRe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},Kpe="recharts_measurement_span";Jpe=(e,t)=>{try{var r=document.getElementById(Kpe);r||(r=document.createElement("span"),r.setAttribute("id",Kpe),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,RRe,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch(i){return{width:0,height:0}}},Db=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Hd.isSsr)return{width:0,height:0};if(!Qpe.enableCache)return Jpe(t,r);var n=URe(t,r),i=Ype.get(n);if(i)return i;var a=Jpe(t,r);return Ype.set(n,a),a}});function HRe(e,t,r){return(t=qRe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qRe(e){var t=VRe(e,"string");return typeof t=="symbol"?t:t+""}function VRe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function QRe(e){return JRe.includes(e)}function XRe(e,t){return e*KRe[t]}function rme(e){if(e==null||e.includes(Lw))return Lw;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,i,a]=(r=Xpe.exec(t))!==null&&r!==void 0?r:[],o=Bh.parse(n!=null?n:""),s=Bh.parse(a!=null?a:""),l=i==="*"?o.multiply(s):o.divide(s);if(l.isNaN())return Lw;t=t.replace(Xpe,l.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var c,[,d,u,p]=(c=Zpe.exec(t))!==null&&c!==void 0?c:[],m=Bh.parse(d!=null?d:""),g=Bh.parse(p!=null?p:""),f=u==="+"?m.add(g):m.subtract(g);if(f.isNaN())return Lw;t=t.replace(Zpe,f.toString())}return t}function ZRe(e){for(var t=e,r;(r=eme.exec(t))!=null;){var[,n]=r;t=t.replace(eme,rme(n))}return t}function e6e(e){var t=e.replace(/\s+/g,"");return t=ZRe(t),t=rme(t),t}function t6e(e){try{return e6e(e)}catch(t){return Lw}}function T2(e){var t=t6e(e.slice(5,-1));return t===Lw?"":t}var tme,Xpe,Zpe,GRe,YRe,KRe,JRe,Lw,Bh,eme,nme=F(()=>{wr();Xpe=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Zpe=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,GRe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,YRe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,KRe={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},JRe=["cm","mm","pt","pc","in","Q","px"];Lw="NaN";Bh=class e{static parse(t){var r,[,n,i]=(r=YRe.exec(t))!==null&&r!==void 0?r:[];return n==null?e.NaN:new e(parseFloat(n),i!=null?i:"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,Ga(t)&&(this.unit=""),r!==""&&!GRe.test(r)&&(this.num=NaN,this.unit=""),QRe(r)&&(this.num=XRe(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new e(NaN,""):new e(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new e(NaN,""):new e(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Ga(this.num)}};tme=Bh;HRe(Bh,"NaN",new tme(NaN,""));eme=/\(([^()]*)\)/});function tU(){return tU=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tU.apply(null,arguments)}function ime(e,t){if(e==null)return{};var r,n,i=i6e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function i6e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function cme(e){return e==="start"||e==="middle"||e==="end"||e==="inherit"}var rU,C2,r6e,n6e,sme,lme,dme,ume,a6e,ame,o6e,ome,s6e,pme,l6e,Wf,OC=F(()=>{rU=Y(Q()),C2=Y(Q());Zn();wr();Zy();eU();nme();_s();ma();Rl();r6e=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],n6e=["dx","dy","angle","className","breakAll"];sme=/[ \f\n\r\t\v\u2028\u2029]+/,lme=e=>{var{children:t,breakAll:r,style:n}=e;try{var i=[];Or(t)||(r?i=t.toString().split(""):i=t.toString().split(sme));var a=i.map(s=>({word:s,width:Db(s,n).width})),o=r?0:Db("\xA0",n).width;return{wordsWithComputedWidth:a,spaceWidth:o}}catch(s){return null}};dme=(e,t,r,n)=>e.reduce((i,a)=>{var{word:o,width:s}=a,l=i[i.length-1];if(l&&s!=null&&(t==null||n||l.width+s+r<Number(t)))l.words.push(o),l.width+=s+r;else{var c={words:[o],width:s};i.push(c)}return i},[]),ume=e=>e.reduce((t,r)=>t.width>r.width?t:r),a6e="\u2026",ame=(e,t,r,n,i,a,o,s)=>{var l=e.slice(0,t),c=lme({breakAll:r,style:n,children:l+a6e});if(!c)return[!1,[]];var d=dme(c.wordsWithComputedWidth,a,o,s),u=d.length>i||ume(d).width>Number(a);return[u,d]},o6e=(e,t,r,n,i)=>{var{maxLines:a,children:o,style:s,breakAll:l}=e,c=at(a),d=String(o),u=dme(t,n,r,i);if(!c||i)return u;var p=u.length>a||ume(u).width>Number(n);if(!p)return u;for(var m=0,g=d.length-1,f=0,v;m<=g&&f<=d.length-1;){var h=Math.floor((m+g)/2),y=h-1,[b,k]=ame(d,y,l,s,a,n,r,i),[x]=ame(d,h,l,s,a,n,r,i);if(!b&&!x&&(m=h+1),b&&x&&(g=h-1),!b&&x){v=k;break}f++}return v||u},ome=e=>{var t=Or(e)?[]:e.toString().split(sme);return[{words:t,width:void 0}]},s6e=e=>{var{width:t,scaleToFit:r,children:n,style:i,breakAll:a,maxLines:o}=e;if((t||r)&&!Hd.isSsr){var s,l,c=lme({breakAll:a,children:n,style:i});if(c){var{wordsWithComputedWidth:d,spaceWidth:u}=c;s=d,l=u}else return ome(n);return o6e({breakAll:a,children:n,maxLines:o,style:i},s,l,t,!!r)}return ome(n)},pme="#808080",l6e={angle:0,breakAll:!1,capHeight:"0.71em",fill:pme,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},Wf=(0,C2.forwardRef)((e,t)=>{var r=pr(e,l6e),{x:n,y:i,lineHeight:a,capHeight:o,fill:s,scaleToFit:l,textAnchor:c,verticalAnchor:d}=r,u=ime(r,r6e),p=(0,C2.useMemo)(()=>s6e({breakAll:u.breakAll,children:u.children,maxLines:u.maxLines,scaleToFit:l,style:u.style,width:u.width}),[u.breakAll,u.children,u.maxLines,l,u.style,u.width]),{dx:m,dy:g,angle:f,className:v,breakAll:h}=u,y=ime(u,n6e);if(!gs(n)||!gs(i)||p.length===0)return null;var b=Number(n)+(at(m)?m:0),k=Number(i)+(at(g)?g:0);if(!Lr(b)||!Lr(k))return null;var x;switch(d){case"start":x=T2("calc(".concat(o,")"));break;case"middle":x=T2("calc(".concat((p.length-1)/2," * -").concat(a," + (").concat(o," / 2))"));break;default:x=T2("calc(".concat(p.length-1," * -").concat(a,")"));break}var S=[];if(l){var w=p[0].width,{width:C}=u;S.push("scale(".concat(at(C)&&at(w)?C/w:1,")"))}return f&&S.push("rotate(".concat(f,", ").concat(b,", ").concat(k,")")),S.length&&(y.transform=S.join(" ")),rU.createElement("text",tU({},nn(y),{ref:t,x:b,y:k,className:wt("recharts-text",v),textAnchor:c,fill:s.includes("url")?pme:s}),p.map((D,P)=>{var M=D.words.join(h?"":" ");return rU.createElement("tspan",{x:b,dy:P===0?x:a,key:"".concat(M,"-").concat(P)},M)}))});Wf.displayName="Text"});function mme(e,t){if(e==null)return{};var r,n,i=u6e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function u6e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function fme(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function vo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fme(Object(r),!0).forEach(function(n){p6e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fme(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function p6e(e,t,r){return(t=m6e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m6e(e){var t=f6e(e,"string");return typeof t=="symbol"?t:t+""}function f6e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rf(){return Rf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rf.apply(null,arguments)}function $f(e){var t=pr(e,x6e),{viewBox:r,position:n,value:i,children:a,content:o,className:s="",textBreakAll:l,labelRef:c}=t,d=bme(),u=hme(),p=n==="center"?u:d!=null?d:u,m,g,f;if(r==null?m=p:nU(r)?m=r:m=c6(r),!m||Or(i)&&Or(a)&&!(0,Zo.isValidElement)(o)&&typeof o!="function")return null;var v=vo(vo({},t),{},{viewBox:m});if((0,Zo.isValidElement)(o)){var{labelRef:h}=v,y=mme(v,c6e);return(0,Zo.cloneElement)(o,y)}if(typeof o=="function"){var{content:b}=v,k=mme(v,d6e);if(g=(0,Zo.createElement)(o,k),(0,Zo.isValidElement)(g))return g}else g=g6e(t);var x=nn(t);if(nU(m)){if(n==="insideStart"||n==="insideEnd"||n==="end")return v6e(t,n,g,x,m);f=y6e(m,t.offset,t.position)}else f=b6e(t,m);return Sc.createElement(Fn,{zIndex:t.zIndex},Sc.createElement(Wf,Rf({ref:c,className:wt("recharts-label",s)},x,f,{textAnchor:cme(x.textAnchor)?x.textAnchor:f.textAnchor,breakAll:l}),g))}function D2(e){var{label:t,labelRef:r}=e,n=hme();return xme(t,n,r)||null}function wme(e){var{label:t}=e,r=bme();return xme(t,r)||null}var Sc,Zo,c6e,d6e,gme,P2,hme,vme,yme,bme,g6e,zC,h6e,v6e,y6e,nU,b6e,x6e,xme,Nw=F(()=>{Sc=Y(Q()),Zo=Y(Q());Zn();OC();wr();Yd();xi();Jr();zf();ma();_s();hl();ys();c6e=["labelRef"],d6e=["content"];gme=(0,Zo.createContext)(null),P2=e=>{var{x:t,y:r,upperWidth:n,lowerWidth:i,width:a,height:o,children:s}=e,l=(0,Zo.useMemo)(()=>({x:t,y:r,upperWidth:n,lowerWidth:i,width:a,height:o}),[t,r,n,i,a,o]);return Sc.createElement(gme.Provider,{value:l},s)},hme=()=>{var e=(0,Zo.useContext)(gme),t=Ef();return e||c6(t)},vme=(0,Zo.createContext)(null),yme=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:i,startAngle:a,endAngle:o,clockWise:s,children:l}=e,c=(0,Zo.useMemo)(()=>({cx:t,cy:r,innerRadius:n,outerRadius:i,startAngle:a,endAngle:o,clockWise:s}),[t,r,n,i,a,o,s]);return Sc.createElement(vme.Provider,{value:c},l)},bme=()=>{var e=(0,Zo.useContext)(vme),t=je(eu);return e||t},g6e=e=>{var{value:t,formatter:r}=e,n=Or(e.children)?t:e.children;return typeof r=="function"?r(n):n},zC=e=>e!=null&&typeof e=="function",h6e=(e,t)=>{var r=Va(t-e),n=Math.min(Math.abs(t-e),360);return r*n},v6e=(e,t,r,n,i)=>{var{offset:a,className:o}=e,{cx:s,cy:l,innerRadius:c,outerRadius:d,startAngle:u,endAngle:p,clockWise:m}=i,g=(c+d)/2,f=h6e(u,p),v=f>=0?1:-1,h,y;switch(t){case"insideStart":h=u+v*a,y=m;break;case"insideEnd":h=p-v*a,y=!m;break;case"end":h=p+v*a,y=m;break;default:throw new Error("Unsupported position ".concat(t))}y=f<=0?y:!y;var b=an(s,l,g,h),k=an(s,l,g,h+(y?1:-1)*359),x="M".concat(b.x,",").concat(b.y,`
    A`).concat(g,",").concat(g,",0,1,").concat(y?0:1,`,
    `).concat(k.x,",").concat(k.y),S=Or(e.id)?Tf("recharts-radial-line-"):e.id;return Sc.createElement("text",Rf({},n,{dominantBaseline:"central",className:wt("recharts-radial-bar-label",o)}),Sc.createElement("defs",null,Sc.createElement("path",{id:S,d:x})),Sc.createElement("textPath",{xlinkHref:"#".concat(S)},r))},y6e=(e,t,r)=>{var{cx:n,cy:i,innerRadius:a,outerRadius:o,startAngle:s,endAngle:l}=e,c=(s+l)/2;if(r==="outside"){var{x:d,y:u}=an(n,i,o+t,c);return{x:d,y:u,textAnchor:d>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"end"};var p=(a+o)/2,{x:m,y:g}=an(n,i,p,c);return{x:m,y:g,textAnchor:"middle",verticalAnchor:"middle"}},nU=e=>"cx"in e&&at(e.cx),b6e=(e,t)=>{var{parentViewBox:r,offset:n,position:i}=e,a;r!=null&&!nU(r)&&(a=r);var{x:o,y:s,upperWidth:l,lowerWidth:c,height:d}=t,u=o,p=o+(l-c)/2,m=(u+p)/2,g=(l+c)/2,f=u+l/2,v=d>=0?1:-1,h=v*n,y=v>0?"end":"start",b=v>0?"start":"end",k=l>=0?1:-1,x=k*n,S=k>0?"end":"start",w=k>0?"start":"end";if(i==="top"){var C={x:u+l/2,y:s-h,textAnchor:"middle",verticalAnchor:y};return vo(vo({},C),a?{height:Math.max(s-a.y,0),width:l}:{})}if(i==="bottom"){var D={x:p+c/2,y:s+d+h,textAnchor:"middle",verticalAnchor:b};return vo(vo({},D),a?{height:Math.max(a.y+a.height-(s+d),0),width:c}:{})}if(i==="left"){var P={x:m-x,y:s+d/2,textAnchor:S,verticalAnchor:"middle"};return vo(vo({},P),a?{width:Math.max(P.x-a.x,0),height:d}:{})}if(i==="right"){var M={x:m+g+x,y:s+d/2,textAnchor:w,verticalAnchor:"middle"};return vo(vo({},M),a?{width:Math.max(a.x+a.width-M.x,0),height:d}:{})}var z=a?{width:g,height:d}:{};return i==="insideLeft"?vo({x:m+x,y:s+d/2,textAnchor:w,verticalAnchor:"middle"},z):i==="insideRight"?vo({x:m+g-x,y:s+d/2,textAnchor:S,verticalAnchor:"middle"},z):i==="insideTop"?vo({x:u+l/2,y:s+h,textAnchor:"middle",verticalAnchor:b},z):i==="insideBottom"?vo({x:p+c/2,y:s+d-h,textAnchor:"middle",verticalAnchor:y},z):i==="insideTopLeft"?vo({x:u+x,y:s+h,textAnchor:w,verticalAnchor:b},z):i==="insideTopRight"?vo({x:u+l-x,y:s+h,textAnchor:S,verticalAnchor:b},z):i==="insideBottomLeft"?vo({x:p+x,y:s+d-h,textAnchor:w,verticalAnchor:y},z):i==="insideBottomRight"?vo({x:p+c-x,y:s+d-h,textAnchor:S,verticalAnchor:y},z):i&&typeof i=="object"&&(at(i.x)||Hy(i.x))&&(at(i.y)||Hy(i.y))?vo({x:o+Bs(i.x,g),y:s+Bs(i.y,d),textAnchor:"end",verticalAnchor:"end"},z):vo({x:f,y:s+d/2,textAnchor:"middle",verticalAnchor:"middle"},z)},x6e={angle:0,offset:5,zIndex:zr.label,position:"middle",textBreakAll:!1};$f.displayName="Label";xme=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?Sc.createElement($f,Rf({key:"label-implicit"},n)):gs(e)?Sc.createElement($f,Rf({key:"label-implicit",value:e},n)):(0,Zo.isValidElement)(e)?e.type===$f?(0,Zo.cloneElement)(e,vo({key:"label-implicit"},n)):Sc.createElement($f,Rf({key:"label-implicit",content:e},n)):zC(e)?Sc.createElement($f,Rf({key:"label-implicit",content:e},n)):e&&typeof e=="object"?Sc.createElement($f,Rf({},e,{key:"label-implicit"},n)):null}});var kme=Fe(iU=>{"use strict";Object.defineProperty(iU,Symbol.toStringTag,{value:"Module"});function w6e(e){return e[e.length-1]}iU.last=w6e});var Sme=Fe(aU=>{"use strict";Object.defineProperty(aU,Symbol.toStringTag,{value:"Module"});function k6e(e){return Array.isArray(e)?e:Array.from(e)}aU.toArray=k6e});var Tme=Fe(oU=>{"use strict";Object.defineProperty(oU,Symbol.toStringTag,{value:"Module"});var S6e=kme(),T6e=Sme(),C6e=FA();function P6e(e){if(C6e.isArrayLike(e))return S6e.last(T6e.toArray(e))}oU.last=P6e});var sU=Fe((WIt,Cme)=>{Cme.exports=Tme().last});function I2(){return I2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},I2.apply(null,arguments)}function Pme(e,t){if(e==null)return{};var r,n,i=I6e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function I6e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function A6e(){return(0,Fw.useContext)(Eme)}function L6e(){return(0,Fw.useContext)(Ime)}function E2(e){var{valueAccessor:t=M6e}=e,r=Pme(e,D6e),{dataKey:n,clockWise:i,id:a,textBreakAll:o,zIndex:s}=r,l=Pme(r,E6e),c=A6e(),d=L6e(),u=c||d;return!u||!u.length?null:Uf.createElement(Fn,{zIndex:s!=null?s:zr.label},Uf.createElement(Yr,{className:"recharts-label-list"},u.map((p,m)=>{var g,f=Or(n)?t(p,m):fn(p&&p.payload,n),v=Or(a)?{}:{id:"".concat(a,"-").concat(m)};return Uf.createElement($f,I2({key:"label-".concat(m)},nn(p),l,v,{fill:(g=r.fill)!==null&&g!==void 0?g:p.fill,parentViewBox:p.parentViewBox,value:f,textBreakAll:o,viewBox:p.viewBox,index:m,zIndex:0}))})))}function $h(e){var{label:t}=e;return t?t===!0?Uf.createElement(E2,{key:"labelList-implicit"}):Uf.isValidElement(t)||zC(t)?Uf.createElement(E2,{key:"labelList-implicit",content:t}):typeof t=="object"?Uf.createElement(E2,I2({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}var Uf,Fw,Dme,D6e,E6e,M6e,Eme,Wh,Ime,YIt,jC=F(()=>{Uf=Y(Q()),Fw=Y(Q()),Dme=Y(sU());Nw();bc();Ja();wr();_s();hl();ys();D6e=["valueAccessor"],E6e=["dataKey","clockWise","id","textBreakAll","zIndex"];M6e=e=>Array.isArray(e.value)?(0,Dme.default)(e.value):e.value,Eme=(0,Fw.createContext)(void 0),Wh=Eme.Provider,Ime=(0,Fw.createContext)(void 0),YIt=Ime.Provider;E2.displayName="LabelList"});function zw(){return zw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zw.apply(null,arguments)}function F6e(e,t){if(e==null)return{};var r,n,i=O6e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function O6e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function z6e(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Ow,N6e,Mme,Ame,j6e,_C,_6e,M2,lU=F(()=>{Ow=Y(Q());Zn();_s();j0();N6e=["points","className","baseLinePoints","connectNulls"];Ame=e=>e&&e.x===+e.x&&e.y===+e.y,j6e=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return t.forEach(n=>{Ame(n)?r[r.length-1].push(n):r[r.length-1].length>0&&r.push([])}),Ame(t[0])&&r[r.length-1].push(t[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},_C=(e,t)=>{var r=j6e(e);t&&(r=[r.reduce((i,a)=>[...i,...a],[])]);var n=r.map(i=>i.reduce((a,o,s)=>zi(Mme||(Mme=z6e(["","","",",",""])),a,s===0?"M":"L",o.x,o.y),"")).join("");return r.length===1?"".concat(n,"Z"):n},_6e=(e,t,r)=>{var n=_C(e,r);return"".concat(n.slice(-1)==="Z"?n.slice(0,-1):n,"L").concat(_C(Array.from(t).reverse(),r).slice(1))},M2=e=>{var{points:t,className:r,baseLinePoints:n,connectNulls:i}=e,a=F6e(e,N6e);if(!t||!t.length)return null;var o=wt("recharts-polygon",r);if(n&&n.length){var s=a.stroke&&a.stroke!=="none",l=_6e(t,n,i);return Ow.createElement("g",{className:o},Ow.createElement("path",zw({},nn(a),{fill:l.slice(-1)==="Z"?a.fill:"none",stroke:"none",d:l})),s?Ow.createElement("path",zw({},nn(a),{fill:"none",d:_C(t,i)})):null,s?Ow.createElement("path",zw({},nn(a),{fill:"none",d:_C(n,i)})):null)}var c=_C(t,i);return Ow.createElement("path",zw({},nn(a),{fill:c.slice(-1)==="Z"?a.fill:"none",className:o,d:c}))}});function cU(){return cU=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cU.apply(null,arguments)}var Lme,jw,A2=F(()=>{Lme=Y(Q());Zn();qu();js();wr();jw=e=>{var{cx:t,cy:r,r:n,className:i}=e,a=wt("recharts-dot",i);return at(t)&&at(r)&&at(n)?Lme.createElement("circle",cU({},mn(e),_0(e),{className:a,cx:t,cy:r,r:n})):null}});var dU,B6e,L2,W6e,N2,uU,mMt,Nme,$6e,R6e,Fme,pU,Ome,mU=F(()=>{Ka();Of();Vl();xi();Ja();BN();Y3();Mh();dU=e=>e.graphicalItems.polarItems,B6e=de([ci,bb],vC),L2=de([dU,ga,B6e],yC),W6e=de([L2],xC),N2=de([W6e,yw],wC),uU=de([N2,ga,L2],kC),mMt=de([N2,ga,L2],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(i=>{var a,o=fn(n,(a=t.dataKey)!==null&&a!==void 0?a:i.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:fn(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]}))),Nme=()=>{},$6e=de([N2,ga,L2,Sw,ci],SC),R6e=de([ga,YN,KN,Nme,$6e,Nme,Jt,ci],TC),Fme=de([ga,Jt,N2,uU,Ih,ci,R6e],CC),pU=de([Fme,ga,sm],PC),Ome=de([ga,Fme,pU,ci],DC)});var fU,gU,Hf,zme,qf,jme,wMt,BC=F(()=>{Ka();Vl();zf();xi();mU();BN();fU=(e,t,r)=>{switch(t){case"angleAxis":return om(e,r);case"radiusAxis":return Ah(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},gU=(e,t,r)=>{switch(t){case"angleAxis":return aue(e,r);case"radiusAxis":return oue(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Hf=de([fU,sm,Ome,gU],Tw),zme=de([Jt,uU,wb,ci],EC),qf=de([Jt,fU,sm,Hf,pU,gU,Pw,zme,ci],S8),jme=de([qf],e=>{if(e){var t=new Map;return e.forEach(r=>{var n=(r.coordinate+360)%360;t.has(n)||t.set(n,r)}),Array.from(t.values())}}),wMt=de([Jt,fU,Hf,gU,Pw,zme,ci],T8)});var U6e,_me,H6e,Bme,Wme=F(()=>{Ka();BC();U6e=(e,t)=>qf(e,"angleAxis",t,!1),_me=de([U6e],e=>{if(e)return e.map(t=>t.coordinate)}),H6e=(e,t)=>qf(e,"radiusAxis",t,!1),Bme=de([H6e],e=>{if(e)return e.map(t=>t.coordinate)})});function V6e(e,t){if(e==null)return{};var r,n,i=G6e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function G6e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function tp(){return tp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tp.apply(null,arguments)}function $me(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function WC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$me(Object(r),!0).forEach(function(n){Y6e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$me(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Y6e(e,t,r){return(t=K6e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K6e(e){var t=J6e(e,"string");return typeof t=="symbol"?t:t+""}function J6e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Tc,q6e,Q6e,X6e,Rme,Ume,Z6e,F2,Hme=F(()=>{Zn();Tc=Y(Q());Yd();Jr();Wme();zf();js();hl();ys();q6e=["gridType","radialLines","angleAxisId","radiusAxisId","cx","cy","innerRadius","outerRadius","polarAngles","polarRadius"];Q6e=(e,t,r,n)=>{var i="";return n.forEach((a,o)=>{var s=an(t,r,e,a);o?i+="L ".concat(s.x,",").concat(s.y):i+="M ".concat(s.x,",").concat(s.y)}),i+="Z",i},X6e=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:i,polarAngles:a,radialLines:o}=e;if(!a||!a.length||!o)return null;var s=WC({stroke:"#ccc"},mn(e));return Tc.createElement("g",{className:"recharts-polar-grid-angle"},a.map(l=>{var c=an(t,r,n,l),d=an(t,r,i,l);return Tc.createElement("line",tp({key:"line-".concat(l)},s,{x1:c.x,y1:c.y,x2:d.x,y2:d.y}))}))},Rme=e=>{var{cx:t,cy:r,radius:n}=e,i=WC({stroke:"#ccc",fill:"none"},mn(e));return Tc.createElement("circle",tp({},i,{className:wt("recharts-polar-grid-concentric-circle",e.className),cx:t,cy:r,r:n}))},Ume=e=>{var{radius:t}=e,r=WC({stroke:"#ccc",fill:"none"},mn(e));return Tc.createElement("path",tp({},r,{className:wt("recharts-polar-grid-concentric-polygon",e.className),d:Q6e(t,e.cx,e.cy,e.polarAngles)}))},Z6e=e=>{var{polarRadius:t,gridType:r}=e;if(!t||!t.length)return null;var n=Math.max(...t),i=e.fill&&e.fill!=="none";return Tc.createElement("g",{className:"recharts-polar-grid-concentric"},i&&r==="circle"&&Tc.createElement(Rme,tp({},e,{radius:n})),i&&r!=="circle"&&Tc.createElement(Ume,tp({},e,{radius:n})),t.map((a,o)=>{var s=o;return r==="circle"?Tc.createElement(Rme,tp({key:s},e,{fill:"none",radius:a})):Tc.createElement(Ume,tp({key:s},e,{fill:"none",radius:a}))}))},F2=e=>{var t,r,n,i,a,o,s,l,c,{gridType:d="polygon",radialLines:u=!0,angleAxisId:p=0,radiusAxisId:m=0,cx:g,cy:f,innerRadius:v,outerRadius:h,polarAngles:y,polarRadius:b}=e,k=V6e(e,q6e),x=je(eu),S=je(z=>_me(z,p)),w=je(z=>Bme(z,m)),C=Array.isArray(y)?y:S,D=Array.isArray(b)?b:w;if(C==null||D==null)return null;var P=WC(WC({cx:(t=(r=x==null?void 0:x.cx)!==null&&r!==void 0?r:g)!==null&&t!==void 0?t:0,cy:(n=(i=x==null?void 0:x.cy)!==null&&i!==void 0?i:f)!==null&&n!==void 0?n:0,innerRadius:(a=(o=x==null?void 0:x.innerRadius)!==null&&o!==void 0?o:v)!==null&&a!==void 0?a:0,outerRadius:(s=(l=x==null?void 0:x.outerRadius)!==null&&l!==void 0?l:h)!==null&&s!==void 0?s:0,polarAngles:C,polarRadius:D},k),{},{zIndex:(c=k.zIndex)!==null&&c!==void 0?c:zr.grid}),{outerRadius:M}=P;return M<=0?null:Tc.createElement(Fn,{zIndex:P.zIndex},Tc.createElement("g",{className:"recharts-polar-grid"},Tc.createElement(Z6e,tp({gridType:d,radialLines:u},P,{polarAngles:C,polarRadius:D})),Tc.createElement(X6e,tp({gridType:d,radialLines:u},P,{polarAngles:C,polarRadius:D}))))};F2.displayName="PolarGrid"});var qme=Fe(hU=>{"use strict";Object.defineProperty(hU,Symbol.toStringTag,{value:"Module"});function e3e(e,t){if(e.length===0)return;let r=e[0],n=t(r);for(let i=1;i<e.length;i++){let a=e[i],o=t(a);o>n&&(n=o,r=a)}return r}hU.maxBy=e3e});var Vme=Fe(vU=>{"use strict";Object.defineProperty(vU,Symbol.toStringTag,{value:"Module"});var t3e=qme(),r3e=A1(),n3e=_A();function i3e(e,t){if(e!=null)return t3e.maxBy(Array.from(e),n3e.iteratee(t!=null?t:r3e.identity))}vU.maxBy=i3e});var Yme=Fe((jMt,Gme)=>{Gme.exports=Vme().maxBy});var Kme=Fe(yU=>{"use strict";Object.defineProperty(yU,Symbol.toStringTag,{value:"Module"});function a3e(e,t){if(e.length===0)return;let r=e[0],n=t(r);for(let i=1;i<e.length;i++){let a=e[i],o=t(a);o<n&&(n=o,r=a)}return r}yU.minBy=a3e});var Jme=Fe(bU=>{"use strict";Object.defineProperty(bU,Symbol.toStringTag,{value:"Module"});var o3e=Kme(),s3e=A1(),l3e=_A();function c3e(e,t){if(e!=null)return o3e.minBy(Array.from(e),l3e.iteratee(t!=null?t:s3e.identity))}bU.minBy=c3e});var Xme=Fe((WMt,Qme)=>{Qme.exports=Jme().minBy});var d3e,Zme,efe,tfe,rfe,nfe,ife,O2=F(()=>{Lo();d3e={radiusAxis:{},angleAxis:{}},Zme=Pi({name:"polarAxis",initialState:d3e,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:efe,removeRadiusAxis:tfe,addAngleAxis:rfe,removeAngleAxis:nfe}=Zme.actions,ife=Zme.reducer});function $C(){return $C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$C.apply(null,arguments)}function afe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Vf(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?afe(Object(r),!0).forEach(function(n){m3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):afe(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function m3e(e,t,r){return(t=f3e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f3e(e){var t=g3e(e,"string");return typeof t=="symbol"?t:t+""}function g3e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ofe(e,t){if(e==null)return{};var r,n,i=h3e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function h3e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function y3e(e){var t=lr();return(0,sfe.useEffect)(()=>(t(efe(e)),()=>{t(tfe(e))})),null}function z2(e){var t=pr(e,gl);return bs.createElement(bs.Fragment,null,bs.createElement(y3e,{domain:t.domain,id:t.radiusAxisId,scale:t.scale,type:t.type,dataKey:t.dataKey,unit:void 0,name:t.name,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDataOverflow:t.allowDataOverflow,reversed:t.reversed,includeHidden:t.includeHidden,allowDecimals:t.allowDecimals,ticks:t.ticks,tickCount:t.tickCount,tick:t.tick}),bs.createElement(C3e,t))}var bs,sfe,lfe,cfe,u3e,p3e,v3e,b3e,x3e,w3e,k3e,S3e,T3e,C3e,dfe=F(()=>{bs=Y(Q()),sfe=Y(Q()),lfe=Y(Yme()),cfe=Y(Xme());Zn();OC();Nw();bc();Yd();qu();O2();Jr();BC();zf();H3();js();ma();hl();u3e=["cx","cy","angle","axisLine"],p3e=["angle","tickFormatter","stroke","tick"];v3e="radiusAxis";b3e=(e,t,r,n)=>{var{coordinate:i}=e;return an(r,n,i,t)},x3e=e=>{var t;switch(e){case"left":t="end";break;case"right":t="start";break;default:t="middle";break}return t},w3e=(e,t,r,n)=>{var i=(0,lfe.default)(n,o=>o.coordinate||0),a=(0,cfe.default)(n,o=>o.coordinate||0);return{cx:t,cy:r,startAngle:e,endAngle:e,innerRadius:(a==null?void 0:a.coordinate)||0,outerRadius:(i==null?void 0:i.coordinate)||0,clockWise:!1}},k3e=(e,t)=>{var{cx:r,cy:n,angle:i,axisLine:a}=e,o=ofe(e,u3e),s=t.reduce((u,p)=>[Math.min(u[0],p.coordinate),Math.max(u[1],p.coordinate)],[1/0,-1/0]),l=an(r,n,s[0],i),c=an(r,n,s[1],i),d=Vf(Vf(Vf({},mn(o)),{},{fill:"none"},mn(a)),{},{x1:l.x,y1:l.y,x2:c.x,y2:c.y});return bs.createElement("line",$C({className:"recharts-polar-radius-axis-line"},d))},S3e=(e,t,r)=>{var n;return bs.isValidElement(e)?n=bs.cloneElement(e,t):typeof e=="function"?n=e(t):n=bs.createElement(Wf,$C({},t,{className:"recharts-polar-radius-axis-tick-value"}),r),n},T3e=(e,t)=>{var{angle:r,tickFormatter:n,stroke:i,tick:a}=e,o=ofe(e,p3e),s=x3e(e.orientation),l=mn(o),c=yc(a),d=t.map((u,p)=>{var m=b3e(u,e.angle,e.cx,e.cy),g=Vf(Vf(Vf(Vf({textAnchor:s,transform:"rotate(".concat(90-r,", ").concat(m.x,", ").concat(m.y,")")},l),{},{stroke:"none",fill:i},c),{},{index:p},m),{},{payload:u});return bs.createElement(Yr,$C({className:wt("recharts-polar-radius-axis-tick",OL(a)),key:"tick-".concat(u.coordinate)},Hu(e,u,p)),S3e(a,g,n?n(u.value,p):u.value))});return bs.createElement(Yr,{className:"recharts-polar-radius-axis-ticks"},d)},C3e=e=>{var{radiusAxisId:t}=e,r=je(eu),n=je(l=>Hf(l,"radiusAxis",t)),i=je(l=>qf(l,"radiusAxis",t,!1));if(r==null||!i||!i.length||n==null)return null;var a=Vf(Vf({},e),{},{scale:n},r),{tick:o,axisLine:s}=a;return bs.createElement(Fn,{zIndex:a.zIndex},bs.createElement(Yr,{className:wt("recharts-polar-radius-axis",v3e,a.className)},s&&k3e(a,i),o&&T3e(a,i),bs.createElement(yme,w3e(a.angle,a.cx,a.cy,i),bs.createElement(wme,{label:a.label}),a.children)))};z2.displayName="PolarRadiusAxis"});function Eb(){return Eb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Eb.apply(null,arguments)}function ufe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function dm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ufe(Object(r),!0).forEach(function(n){D3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ufe(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function D3e(e,t,r){return(t=E3e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function E3e(e){var t=I3e(e,"string");return typeof t=="symbol"?t:t+""}function I3e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function M3e(e,t){if(e==null)return{};var r,n,i=A3e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function A3e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function F3e(e){var t=lr(),r=(0,j2.useMemo)(()=>{var{children:a}=e,o=M3e(e,P3e);return o},[e]),n=je(a=>om(a,r.id)),i=r===n;return(0,j2.useEffect)(()=>(t(rfe(r)),()=>{t(nfe(r))}),[t,r]),i?e.children:null}function _2(e){var t=pr(e,Zd);return xs.createElement(F3e,{id:t.angleAxisId,scale:t.scale,type:t.type,dataKey:t.dataKey,unit:void 0,name:t.name,allowDuplicatedCategory:!1,allowDataOverflow:!1,reversed:t.reversed,includeHidden:!1,allowDecimals:t.allowDecimals,tickCount:t.tickCount,ticks:t.ticks,tick:t.tick,domain:t.domain},xs.createElement($3e,t))}var xs,j2,P3e,pfe,L3e,N3e,O3e,z3e,j3e,_3e,B3e,W3e,$3e,mfe=F(()=>{xs=Y(Q()),j2=Y(Q());Zn();bc();A2();lU();OC();qu();Yd();O2();Jr();BC();zf();U3();hs();js();ma();hl();P3e=["children"];pfe=1e-5,L3e=Math.cos(H1(45)),N3e="angleAxis";O3e=(e,t)=>{var{cx:r,cy:n,radius:i,orientation:a,tickSize:o}=t,s=o||8,l=an(r,n,i,e.coordinate),c=an(r,n,i+(a==="inner"?-1:1)*s,e.coordinate);return{x1:l.x,y1:l.y,x2:c.x,y2:c.y}},z3e=(e,t)=>{var r=Math.cos(H1(-e.coordinate));return r>pfe?t==="outer"?"start":"end":r<-pfe?t==="outer"?"end":"start":"middle"},j3e=e=>{var t=Math.cos(H1(-e.coordinate)),r=Math.sin(H1(-e.coordinate));return Math.abs(t)<=L3e?r>0?"start":"end":"middle"},_3e=e=>{var{cx:t,cy:r,radius:n,axisLineType:i,axisLine:a,ticks:o}=e;if(!a)return null;var s=dm(dm({},mn(e)),{},{fill:"none"},mn(a));if(i==="circle")return xs.createElement(jw,Eb({className:"recharts-polar-angle-axis-line"},s,{cx:t,cy:r,r:n}));var l=o.map(c=>an(t,r,n,c.coordinate));return xs.createElement(M2,Eb({className:"recharts-polar-angle-axis-line"},s,{points:l}))},B3e=e=>{var{tick:t,tickProps:r,value:n}=e;return t?xs.isValidElement(t)?xs.cloneElement(t,r):typeof t=="function"?t(r):xs.createElement(Wf,Eb({},r,{className:"recharts-polar-angle-axis-tick-value"}),n):null},W3e=e=>{var{tick:t,tickLine:r,tickFormatter:n,stroke:i,ticks:a}=e,o=mn(e),s=yc(t),l=dm(dm({},o),{},{fill:"none"},mn(r)),c=a.map((d,u)=>{var p=O3e(d,e),m=z3e(d,e.orientation),g=j3e(d),f=dm(dm(dm({},o),{},{textAnchor:m,verticalAnchor:g,stroke:"none",fill:i},s),{},{index:u,payload:d,x:p.x2,y:p.y2});return xs.createElement(Yr,Eb({className:wt("recharts-polar-angle-axis-tick",OL(t)),key:"tick-".concat(d.coordinate)},Hu(e,d,u)),r&&xs.createElement("line",Eb({className:"recharts-polar-angle-axis-tick-line"},l,p)),xs.createElement(B3e,{tick:t,tickProps:f,value:n?n(d.value,u):d.value}))});return xs.createElement(Yr,{className:"recharts-polar-angle-axis-ticks"},c)},$3e=e=>{var{angleAxisId:t}=e,r=je(eu),n=je(s=>Hf(s,"angleAxis",t)),i=Qr(),a=je(s=>jme(s,"angleAxis",t,i));if(r==null||!a||!a.length||n==null)return null;var o=dm(dm(dm({},e),{},{scale:n},r),{},{radius:r.outerRadius,ticks:a});return xs.createElement(Fn,{zIndex:o.zIndex},xs.createElement(Yr,{className:wt("recharts-polar-angle-axis",N3e,o.className)},xs.createElement(_3e,o),xs.createElement(W3e,o)))};_2.displayName="PolarAngleAxis"});var gfe=Fe(wi=>{"use strict";var xU=Symbol.for("react.element"),wU=Symbol.for("react.portal"),B2=Symbol.for("react.fragment"),W2=Symbol.for("react.strict_mode"),$2=Symbol.for("react.profiler"),R2=Symbol.for("react.provider"),U2=Symbol.for("react.context"),R3e=Symbol.for("react.server_context"),H2=Symbol.for("react.forward_ref"),q2=Symbol.for("react.suspense"),V2=Symbol.for("react.suspense_list"),G2=Symbol.for("react.memo"),Y2=Symbol.for("react.lazy"),U3e=Symbol.for("react.offscreen"),ffe;ffe=Symbol.for("react.module.reference");function iu(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case xU:switch(e=e.type,e){case B2:case $2:case W2:case q2:case V2:return e;default:switch(e=e&&e.$$typeof,e){case R3e:case U2:case H2:case Y2:case G2:case R2:return e;default:return t}}case wU:return t}}}wi.ContextConsumer=U2;wi.ContextProvider=R2;wi.Element=xU;wi.ForwardRef=H2;wi.Fragment=B2;wi.Lazy=Y2;wi.Memo=G2;wi.Portal=wU;wi.Profiler=$2;wi.StrictMode=W2;wi.Suspense=q2;wi.SuspenseList=V2;wi.isAsyncMode=function(){return!1};wi.isConcurrentMode=function(){return!1};wi.isContextConsumer=function(e){return iu(e)===U2};wi.isContextProvider=function(e){return iu(e)===R2};wi.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===xU};wi.isForwardRef=function(e){return iu(e)===H2};wi.isFragment=function(e){return iu(e)===B2};wi.isLazy=function(e){return iu(e)===Y2};wi.isMemo=function(e){return iu(e)===G2};wi.isPortal=function(e){return iu(e)===wU};wi.isProfiler=function(e){return iu(e)===$2};wi.isStrictMode=function(e){return iu(e)===W2};wi.isSuspense=function(e){return iu(e)===q2};wi.isSuspenseList=function(e){return iu(e)===V2};wi.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===B2||e===$2||e===W2||e===q2||e===V2||e===U3e||typeof e=="object"&&e!==null&&(e.$$typeof===Y2||e.$$typeof===G2||e.$$typeof===R2||e.$$typeof===U2||e.$$typeof===H2||e.$$typeof===ffe||e.getModuleId!==void 0)};wi.typeOf=iu});var vfe=Fe((kAt,hfe)=>{"use strict";hfe.exports=gfe()});function Sfe(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(i=>yfe(i)):n=[yfe(t)],kfe(e).forEach(i=>{var a=(0,SU.default)(i,"type.displayName")||(0,SU.default)(i,"type.name");a&&n.indexOf(a)!==-1&&r.push(i)}),r}var SU,xfe,wfe,yfe,bfe,kU,kfe,_w,RC=F(()=>{SU=Y(I1()),xfe=Y(Q()),wfe=Y(vfe());wr();yfe=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",bfe=null,kU=null,kfe=e=>{if(e===bfe&&Array.isArray(kU))return kU;var t=[];return xfe.Children.forEach(e,r=>{Or(r)||((0,wfe.isFragment)(r)?t=t.concat(kfe(r.props.children)):t.push(r))}),kU=t,bfe=e,t};_w=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0});var Tfe=Fe(TU=>{"use strict";Object.defineProperty(TU,Symbol.toStringTag,{value:"Module"});function H3e(e){var r;if(typeof e!="object"||e==null)return!1;if(Object.getPrototypeOf(e)===null)return!0;if(Object.prototype.toString.call(e)!=="[object Object]"){let n=e[Symbol.toStringTag];return n==null||!((r=Object.getOwnPropertyDescriptor(e,Symbol.toStringTag))!=null&&r.writable)?!1:e.toString()===`[object ${n}]`}let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}TU.isPlainObject=H3e});var Pfe=Fe((PAt,Cfe)=>{Cfe.exports=Tfe().isPlainObject});function Lfe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Nfe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Lfe(Object(r),!0).forEach(function(n){q3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lfe(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function q3e(e,t,r){return(t=V3e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function V3e(e){var t=G3e(e,"string");return typeof t=="symbol"?t:t+""}function G3e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function K2(){return K2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},K2.apply(null,arguments)}function UC(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var HC,rp,Dfe,Efe,Ife,Mfe,Afe,Ffe,Y3e,Ofe,zfe=F(()=>{HC=Y(Q()),rp=Y(Q());Zn();ma();tb();rb();wr();EL();_s();j0();Ffe=(e,t,r,n,i)=>{var a=r-n,o;return o=zi(Dfe||(Dfe=UC(["M ",",",""])),e,t),o+=zi(Efe||(Efe=UC(["L ",",",""])),e+r,t),o+=zi(Ife||(Ife=UC(["L ",",",""])),e+r-a/2,t+i),o+=zi(Mfe||(Mfe=UC(["L ",",",""])),e+r-a/2-n,t+i),o+=zi(Afe||(Afe=UC(["L ",","," Z"])),e,t),o},Y3e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Ofe=e=>{var t=pr(e,Y3e),{x:r,y:n,upperWidth:i,lowerWidth:a,height:o,className:s}=t,{animationEasing:l,animationDuration:c,animationBegin:d,isUpdateAnimationActive:u}=t,p=(0,rp.useRef)(null),[m,g]=(0,rp.useState)(-1),f=(0,rp.useRef)(i),v=(0,rp.useRef)(a),h=(0,rp.useRef)(o),y=(0,rp.useRef)(r),b=(0,rp.useRef)(n),k=Vd(e,"trapezoid-");if((0,rp.useEffect)(()=>{if(p.current&&p.current.getTotalLength)try{var I=p.current.getTotalLength();I&&g(I)}catch(L){}},[]),r!==+r||n!==+n||i!==+i||a!==+a||o!==+o||i===0&&a===0||o===0)return null;var x=wt("recharts-trapezoid",s);if(!u)return HC.createElement("g",null,HC.createElement("path",K2({},nn(t),{className:x,d:Ffe(r,n,i,a,o)})));var S=f.current,w=v.current,C=h.current,D=y.current,P=b.current,M="0px ".concat(m===-1?1:m,"px"),z="".concat(m,"px 0px"),A=DL(["strokeDasharray"],c,l);return HC.createElement(qd,{animationId:k,key:k,canBegin:m>0,duration:c,easing:l,isActive:u,begin:d},I=>{var L=Kr(S,i,I),E=Kr(w,a,I),T=Kr(C,o,I),$=Kr(D,r,I),_=Kr(P,n,I);p.current&&(f.current=L,v.current=E,h.current=T,y.current=$,b.current=_);var B=I>0?{transition:A,strokeDasharray:z}:{strokeDasharray:M};return HC.createElement("path",K2({},nn(t),{className:x,d:Ffe($,_,L,E,T),ref:p,style:Nfe(Nfe({},B),t.style)}))})}});function J3e(e,t){if(e==null)return{};var r,n,i=Q3e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Q3e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function jfe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function J2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jfe(Object(r),!0).forEach(function(n){X3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jfe(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function X3e(e,t,r){return(t=Z3e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Z3e(e){var t=e8e(e,"string");return typeof t=="symbol"?t:t+""}function e8e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function t8e(e,t){return J2(J2({},t),e)}function r8e(e,t){return e==="symbols"}function _fe(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return Gf.createElement(FL,r);case"trapezoid":return Gf.createElement(Ofe,r);case"sector":return Gf.createElement(_L,r);case"symbols":if(r8e(t,r))return Gf.createElement(M1,r);break;case"curve":return Gf.createElement(Sh,r);default:return null}}function n8e(e){return(0,qC.isValidElement)(e)?e.props:e}function Q2(e){var{option:t,shapeType:r,activeClassName:n="recharts-active-shape"}=e,i=J3e(e,K3e),a;if((0,qC.isValidElement)(t))a=(0,qC.cloneElement)(t,J2(J2({},i),n8e(t)));else if(typeof t=="function")a=t(i,i.index);else if((0,Bfe.default)(t)&&typeof t!="boolean"){var o=t8e(t,i);a=Gf.createElement(_fe,{shapeType:r,elementProps:o})}else{var s=i;a=Gf.createElement(_fe,{shapeType:r,elementProps:s})}return i.isActive?Gf.createElement(Yr,{className:n},a):a}var Gf,qC,Bfe,K3e,CU=F(()=>{Gf=Y(Q()),qC=Y(Q()),Bfe=Y(Pfe());C6();zfe();E6();bc();_$();PL();K3e=["option","shapeType","activeClassName"]});var PU,DU,EU,Wfe=F(()=>{Jr();Zu();PU=(e,t,r)=>{var n=lr();return(i,a)=>o=>{e==null||e(i,a,o),n(e2({activeIndex:String(a),activeDataKey:t,activeCoordinate:i.tooltipPosition,activeGraphicalItemId:r}))}},DU=e=>{var t=lr();return(r,n)=>i=>{e==null||e(r,n,i),t(Due())}},EU=(e,t,r)=>{var n=lr();return(i,a)=>o=>{e==null||e(i,a,o),n(Eue({activeIndex:String(a),activeDataKey:t,activeCoordinate:i.tooltipPosition,activeGraphicalItemId:r}))}}});function Rh(e){var{tooltipEntrySettings:t}=e,r=lr(),n=Qr(),i=(0,VC.useRef)(null);return(0,VC.useLayoutEffect)(()=>{n||(i.current===null?r(Sue(t)):i.current!==t&&r(Tue({prev:i.current,next:t})),i.current=t)},[t,r,n]),(0,VC.useLayoutEffect)(()=>()=>{i.current&&(r(Cue(i.current)),i.current=null)},[r]),null}var VC,GC=F(()=>{VC=Y(Q());Jr();Zu();hs()});function Bw(e){var{legendPayload:t}=e,r=lr(),n=Qr(),i=(0,Uh.useRef)(null);return(0,Uh.useLayoutEffect)(()=>{n||(i.current===null?r(u6(t)):i.current!==t&&r(p6({prev:i.current,next:t})),i.current=t)},[r,n,t]),(0,Uh.useLayoutEffect)(()=>()=>{i.current&&(r(m6(i.current)),i.current=null)},[r]),null}function $fe(e){var{legendPayload:t}=e,r=lr(),n=je(Jt),i=(0,Uh.useRef)(null);return(0,Uh.useLayoutEffect)(()=>{n!=="centric"&&n!=="radial"||(i.current===null?r(u6(t)):i.current!==t&&r(p6({prev:i.current,next:t})),i.current=t)},[r,n,t]),(0,Uh.useLayoutEffect)(()=>()=>{i.current&&(r(m6(i.current)),i.current=null)},[r]),null}var Uh,YC=F(()=>{Uh=Y(Q());hs();xi();Jr();xL()});var X2,IU,i8e,Rfe,Ufe=F(()=>{X2=Y(Q());wr();i8e=()=>{var[e]=X2.useState(()=>Tf("uid-"));return e},Rfe=(IU=X2.useId)!==null&&IU!==void 0?IU:i8e});function Hfe(e,t){var r=Rfe();return t||(e?"".concat(e,"-").concat(r):r)}var qfe=F(()=>{Ufe()});var Vfe,MU,a8e,Hh,KC=F(()=>{Vfe=Y(Q()),MU=Y(Q());qfe();a8e=(0,MU.createContext)(void 0),Hh=e=>{var{id:t,type:r,children:n}=e,i=Hfe("recharts-".concat(r),t);return Vfe.createElement(a8e.Provider,{value:i},n(i))}});var o8e,Gfe,Yfe,Kfe,Jfe,Qfe,Xfe,Zfe,AU=F(()=>{Lo();o8e={cartesianItems:[],polarItems:[]},Gfe=Pi({name:"graphicalItems",initialState:o8e,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:bi()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:r,next:n}=t.payload,i=dl(e).cartesianItems.indexOf(r);i>-1&&(e.cartesianItems[i]=n)},prepare:bi()},removeCartesianGraphicalItem:{reducer(e,t){var r=dl(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},prepare:bi()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:bi()},removePolarGraphicalItem:{reducer(e,t){var r=dl(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)},prepare:bi()}}}),{addCartesianGraphicalItem:Yfe,replaceCartesianGraphicalItem:Kfe,removeCartesianGraphicalItem:Jfe,addPolarGraphicalItem:Qfe,removePolarGraphicalItem:Xfe}=Gfe.actions,Zfe=Gfe.reducer});function ege(e){var t=lr();return(0,qh.useLayoutEffect)(()=>(t(Qfe(e)),()=>{t(Xfe(e))}),[t,e]),null}var qh,s8e,Ww,JC=F(()=>{qh=Y(Q());Jr();AU();s8e=e=>{var t=lr(),r=(0,qh.useRef)(null);return(0,qh.useLayoutEffect)(()=>{r.current===null?t(Yfe(e)):r.current!==e&&t(Kfe({prev:r.current,next:e})),r.current=e},[t,e]),(0,qh.useLayoutEffect)(()=>()=>{r.current&&(t(Jfe(r.current)),r.current=null)},[t]),null},Ww=(0,qh.memo)(s8e)});function tge(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function LU(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tge(Object(r),!0).forEach(function(n){c8e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tge(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function c8e(e,t,r){return(t=d8e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d8e(e){var t=u8e(e,"string");return typeof t=="symbol"?t:t+""}function u8e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Z2(){return Z2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Z2.apply(null,arguments)}function p8e(e,t){if(e==null)return{};var r,n,i=m8e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function m8e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function f8e(e){var{option:t,dotProps:r,className:n}=e;if((0,eF.isValidElement)(t))return(0,eF.cloneElement)(t,r);if(typeof t=="function")return t(r);var i=wt(n,typeof t!="boolean"?t.className:""),a=r!=null?r:{},{points:o}=a,s=p8e(a,l8e);return QC.createElement(jw,Z2({},s,{className:i}))}function g8e(e,t){return e==null?!1:t?!0:e.length===1}function $w(e){var{points:t,dot:r,className:n,dotClassName:i,dataKey:a,baseProps:o,needClip:s,clipPathId:l,zIndex:c=zr.scatter}=e;if(!g8e(t,r))return null;var d=_w(r),u=jne(r),p=t.map((g,f)=>{var v,h,y=LU(LU(LU({r:3},o),u),{},{index:f,cx:(v=g.x)!==null&&v!==void 0?v:void 0,cy:(h=g.y)!==null&&h!==void 0?h:void 0,dataKey:a,value:g.value,payload:g.payload,points:t});return QC.createElement(f8e,{key:"dot-".concat(f),option:r,dotProps:y,className:i})}),m={};return s&&l!=null&&(m.clipPath="url(#clipPath-".concat(d?"":"dots-").concat(l,")")),QC.createElement(Fn,{zIndex:c},QC.createElement(Yr,Z2({className:n},m),p))}var QC,eF,l8e,tF=F(()=>{QC=Y(Q()),eF=Y(Q());Zn();A2();bc();RC();_s();hl();ys();l8e=["points"]});function rge(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function nge(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rge(Object(r),!0).forEach(function(n){h8e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rge(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function h8e(e,t,r){return(t=v8e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v8e(e){var t=y8e(e,"string");return typeof t=="symbol"?t:t+""}function y8e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NU,b8e,ige,age,oge,sge,lge,cge,dge,wLt,kLt,SLt,uge,pge,XC=F(()=>{Lo();NU=0,b8e={xAxis:{},yAxis:{},zAxis:{}},ige=Pi({name:"cartesianAxis",initialState:b8e,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:bi()},replaceXAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.xAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.xAxis[r.id],e.xAxis[n.id]=n)},prepare:bi()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:bi()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:bi()},replaceYAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.yAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.yAxis[r.id],e.yAxis[n.id]=n)},prepare:bi()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:bi()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:bi()},replaceZAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.zAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.zAxis[r.id],e.zAxis[n.id]=n)},prepare:bi()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:bi()},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload,i=e.yAxis[r];if(i){var a=i.widthHistory||[];if(a.length===3&&a[0]===a[2]&&n===a[1]&&n!==i.width&&Math.abs(n-a[0])<=1)return;var o=[...a,n].slice(-3);e.yAxis[r]=nge(nge({},e.yAxis[r]),{},{width:n,widthHistory:o})}}}}),{addXAxis:age,replaceXAxis:oge,removeXAxis:sge,addYAxis:lge,replaceYAxis:cge,removeYAxis:dge,addZAxis:wLt,replaceZAxis:kLt,removeZAxis:SLt,updateYAxisWidth:uge}=ige.actions,pge=ige.reducer});var mge,fge=F(()=>{Ka();Ud();mge=de([ji],e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right}))});var gge,hge=F(()=>{Ka();fge();Qp();gge=de([mge,pl,ml],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}})});var Vh,vge,Rw=F(()=>{Jr();ep();hge();Vh=()=>je(gge),vge=()=>je($ue)});function yge(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function FU(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yge(Object(r),!0).forEach(function(n){x8e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yge(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function x8e(e,t,r){return(t=w8e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w8e(e){var t=k8e(e,"string");return typeof t=="symbol"?t:t+""}function k8e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ib(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:i,clipPath:a,zIndex:o=zr.activeDot}=e,s=je(lm),l=vge();if(t==null||l==null)return null;var c=t.find(d=>l.includes(d.payload));return Or(c)?null:ZC.createElement(Fn,{zIndex:o},ZC.createElement(S8e,{point:c,childIndex:Number(s),mainColor:r,dataKey:i,activeDot:n,clipPath:a}))}var ZC,rF,S8e,nF=F(()=>{ZC=Y(Q()),rF=Y(Q());qu();A2();bc();Jr();ep();Rw();wr();js();hl();ys();S8e=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:i,dataKey:a,clipPath:o}=e;if(i===!1||t.x==null||t.y==null)return null;var s={index:r,dataKey:a,cx:t.x,cy:t.y,r:4,fill:n!=null?n:"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},l=FU(FU(FU({},s),yc(i)),_0(i)),c;return(0,rF.isValidElement)(i)?c=(0,rF.cloneElement)(i,l):typeof i=="function"?c=i(l):c=ZC.createElement(jw,l),ZC.createElement(Yr,{className:"recharts-active-dot",clipPath:o},c)}});function bge(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function iF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bge(Object(r),!0).forEach(function(n){T8e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bge(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function T8e(e,t,r){return(t=C8e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C8e(e){var t=P8e(e,"string");return typeof t=="symbol"?t:t+""}function P8e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xge,D8e,E8e,I8e,wge,kge,M8e,A8e,L8e,N8e,F8e,O8e,Sge,Tge=F(()=>{Ka();OU();BC();zf();Of();xi();Ja();mU();xge=(e,t)=>Hf(e,"radiusAxis",t),D8e=de([xge],e=>{if(e!=null)return{scale:e}}),E8e=de([Ah,xge],(e,t)=>{if(!(e==null||t==null))return iF(iF({},e),{},{scale:t})}),I8e=(e,t,r,n)=>qf(e,"radiusAxis",t,n),wge=(e,t,r)=>om(e,r),kge=(e,t,r)=>Hf(e,"angleAxis",r),M8e=de([wge,kge],(e,t)=>{if(!(e==null||t==null))return iF(iF({},e),{},{scale:t})}),A8e=(e,t,r,n)=>qf(e,"angleAxis",r,n),L8e=de([wge,kge,eu],(e,t,r)=>{if(!(r==null||t==null))return{scale:t,type:e.type,dataKey:e.dataKey,cx:r.cx,cy:r.cy}}),N8e=(e,t,r,n,i)=>i,F8e=de([Jt,E8e,I8e,M8e,A8e],(e,t,r,n,i)=>ul(e,"radiusAxis")?Ul(t,r,!1):Ul(n,i,!1)),O8e=de([dU,N8e],(e,t)=>{if(e!=null){var r=e.find(n=>n.type==="radar"&&t===n.id);return r==null?void 0:r.dataKey}}),Sge=de([D8e,L8e,yw,O8e,F8e],(e,t,r,n,i)=>{var{chartData:a,dataStartIndex:o,dataEndIndex:s}=r;if(!(e==null||t==null||a==null||i==null||n==null)){var l=a.slice(o,s+1);return Cge({radiusAxis:e,angleAxis:t,displayedData:l,dataKey:n,bandSize:i})}})});function eP(){return eP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},eP.apply(null,arguments)}function Pge(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Cc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Pge(Object(r),!0).forEach(function(n){j8e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pge(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function j8e(e,t,r){return(t=_8e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _8e(e){var t=B8e(e,"string");return typeof t=="symbol"?t:t+""}function B8e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function W8e(e,t){if(e==null)return{};var r,n,i=$8e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function $8e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function zU(e,t){return e&&e!=="none"?e:t}function H8e(e){var{points:t,props:r}=e,{dot:n,dataKey:i}=r,{id:a}=r,o=W8e(r,z8e),s=mn(o);return ei.createElement($w,{points:t,dot:n,className:"recharts-radar-dots",dotClassName:"recharts-radar-dot",dataKey:i,baseProps:s})}function Cge(e){var{radiusAxis:t,angleAxis:r,displayedData:n,dataKey:i,bandSize:a}=e,{cx:o,cy:s}=r,l=!1,c=[],d=r.type!=="number"&&a!=null?a:0;n.forEach((p,m)=>{var g=fn(p,r.dataKey,m),f=fn(p,i),v=r.scale(g)+d,h=Array.isArray(f)?(0,Ege.default)(f):f,y=Or(h)?0:t.scale(h);Array.isArray(f)&&f.length>=2&&(l=!0),c.push(Cc(Cc({},an(o,s,y,v)),{},{name:g,value:f,cx:o,cy:s,radius:y,angle:v,payload:p}))});var u=[];return l&&c.forEach(p=>{if(Array.isArray(p.value)){var m=p.value[0],g=Or(m)?0:t.scale(m);u.push(Cc(Cc({},p),{},{radius:g},an(o,s,g,p.angle)))}else u.push(p)}),{points:c,isRange:l,baseLinePoints:u}}function q8e(e){var{showLabels:t,points:r,children:n}=e,i=r.map(a=>{var o,s={x:a.x,y:a.y,width:0,lowerWidth:0,upperWidth:0,height:0};return Cc(Cc({},s),{},{value:(o=a.value)!==null&&o!==void 0?o:"",payload:a.payload,parentViewBox:void 0,viewBox:s,fill:void 0})});return ei.createElement(Wh,{value:t?i:void 0},n)}function V8e(e){var{points:t,baseLinePoints:r,props:n}=e;if(t==null)return null;var{shape:i,isRange:a,connectNulls:o}=n,s=d=>{var{onMouseEnter:u}=n;u&&u(n,d)},l=d=>{var{onMouseLeave:u}=n;u&&u(n,d)},c;return ei.isValidElement(i)?c=ei.cloneElement(i,Cc(Cc({},n),{},{points:t})):typeof i=="function"?c=i(Cc(Cc({},n),{},{points:t})):c=ei.createElement(M2,eP({},nn(n),{onMouseEnter:s,onMouseLeave:l,points:t,baseLinePoints:a?r:void 0,connectNulls:o})),ei.createElement(Yr,{className:"recharts-radar-polygon"},c,ei.createElement(H8e,{props:n,points:t}))}function G8e(e){var{props:t,previousPointsRef:r,previousBaseLinePointsRef:n}=e,{points:i,baseLinePoints:a,isAnimationActive:o,animationBegin:s,animationDuration:l,animationEasing:c,onAnimationEnd:d,onAnimationStart:u}=t,p=r.current,m=n.current,g=p?p.length/i.length:1,f=m?m.length/a.length:1,v=Vd(t,"recharts-radar-"),[h,y]=(0,Gh.useState)(!1),b=!h,k=(0,Gh.useCallback)(()=>{typeof d=="function"&&d(),y(!1)},[d]),x=(0,Gh.useCallback)(()=>{typeof u=="function"&&u(),y(!0)},[u]);return ei.createElement(q8e,{showLabels:b,points:i},ei.createElement(qd,{animationId:v,begin:s,duration:l,isActive:o,easing:c,key:"radar-".concat(v),onAnimationEnd:k,onAnimationStart:x},S=>{var w=S===1?i:i.map(Dge(p,g,S)),C=S===1?a:a==null?void 0:a.map(Dge(m,f,S));return S>0&&(r.current=w,n.current=C),ei.createElement(V8e,{points:w,baseLinePoints:C,props:t})}),ei.createElement($h,{label:t.label}),t.children)}function Y8e(e){var t=(0,Gh.useRef)(void 0),r=(0,Gh.useRef)(void 0);return ei.createElement(G8e,{props:e,previousPointsRef:t,previousBaseLinePointsRef:r})}function J8e(e){var{hide:t,className:r,points:n}=e;if(t)return null;var i=wt("recharts-radar",r);return ei.createElement(Fn,{zIndex:e.zIndex},ei.createElement(Yr,{className:i},ei.createElement(Y8e,e)),ei.createElement(Ib,{points:n,mainColor:zU(e.stroke,e.fill),itemDataKey:e.dataKey,activeDot:e.activeDot}))}function Q8e(e){var t=Qr(),r=je(n=>Sge(n,e.radiusAxisId,e.angleAxisId,t,e.id));return(r==null?void 0:r.points)==null?null:ei.createElement(J8e,eP({},e,{points:r==null?void 0:r.points,baseLinePoints:r==null?void 0:r.baseLinePoints,isRange:r==null?void 0:r.isRange}))}function aF(e){var t=pr(e,K8e);return ei.createElement(Hh,{id:t.id,type:"radar"},r=>ei.createElement(ei.Fragment,null,ei.createElement(ege,{type:"radar",id:r,data:void 0,dataKey:t.dataKey,hide:t.hide,angleAxisId:t.angleAxisId,radiusAxisId:t.radiusAxisId}),ei.createElement($fe,{legendPayload:R8e(t)}),ei.createElement(U8e,{dataKey:t.dataKey,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,tooltipType:t.tooltipType,id:r}),ei.createElement(Q8e,eP({},t,{id:r}))))}var ei,Gh,Ege,z8e,R8e,U8e,Dge,K8e,OU=F(()=>{ei=Y(Q()),Gh=Y(Q()),Ege=Y(sU());Zn();wr();Yd();Ja();lU();bc();jC();tF();nF();GC();Tge();Jr();hs();YC();rb();KC();JC();js();tb();_s();ma();hl();ys();z8e=["id"];R8e=e=>{var{dataKey:t,name:r,stroke:n,fill:i,legendType:a,hide:o}=e;return[{inactive:o,dataKey:t,type:a,color:zU(n,i),value:Rd(r,t),payload:e}]},U8e=ei.memo(e=>{var{dataKey:t,stroke:r,strokeWidth:n,fill:i,name:a,hide:o,tooltipType:s,id:l}=e,c={dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:i,nameKey:void 0,dataKey:t,name:Rd(a,t),hide:o,type:s,color:zU(r,i),unit:"",graphicalItemId:l}};return ei.createElement(Rh,{tooltipEntrySettings:c})});Dge=(e,t,r)=>(n,i)=>{var a=e&&e[Math.floor(i*t)];return a?Cc(Cc({},n),{},{x:Kr(a.x,n.x,r),y:Kr(a.y,n.y,r)}):Cc(Cc({},n),{},{x:Kr(n.cx,n.x,r),y:Kr(n.cy,n.y,r)})};K8e={activeDot:!0,angleAxisId:0,animationBegin:0,animationDuration:1500,animationEasing:"ease",dot:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",radiusAxisId:0,zIndex:zr.area};aF.displayName="Radar"});var Ige,Mge,Age=F(()=>{$N();wr();Ige=(e,t,r)=>{var n=r!=null?r:e;if(!Or(n))return Bs(n,t,0)},Mge=(e,t,r)=>{var n={},i=e.filter(xb),a=e.filter(c=>c.stackId==null),o=i.reduce((c,d)=>(c[d.stackId]||(c[d.stackId]=[]),c[d.stackId].push(d),c),n),s=Object.entries(o).map(c=>{var[d,u]=c,p=u.map(g=>g.dataKey),m=Ige(t,r,u[0].barSize);return{stackId:d,dataKeys:p,barSize:m}}),l=a.map(c=>{var d=[c.dataKey].filter(p=>p!=null),u=Ige(t,r,c.barSize);return{stackId:void 0,dataKeys:d,barSize:u}});return[...s,...l]}});function Lge(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function oF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Lge(Object(r),!0).forEach(function(n){X8e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lge(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function X8e(e,t,r){return(t=Z8e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Z8e(e){var t=eUe(e,"string");return typeof t=="symbol"?t:t+""}function eUe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tUe(e,t,r,n,i){var a=n.length;if(!(a<1)){var o=Bs(e,r,0,!0),s,l=[];if(Lr(n[0].barSize)){var c=!1,d=r/a,u=n.reduce((h,y)=>h+(y.barSize||0),0);u+=(a-1)*o,u>=r&&(u-=(a-1)*o,o=0),u>=r&&d>0&&(c=!0,d*=.9,u=a*d);var p=(r-u)/2>>0,m={offset:p-o,size:0};s=n.reduce((h,y)=>{var b,k={stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:m.offset+m.size+o,size:c?d:(b=y.barSize)!==null&&b!==void 0?b:0}},x=[...h,k];return m=x[x.length-1].position,x},l)}else{var g=Bs(t,r,0,!0);r-2*g-(a-1)*o<=0&&(o=0);var f=(r-2*g-(a-1)*o)/a;f>1&&(f>>=0);var v=Lr(i)?Math.min(f,i):f;s=n.reduce((h,y,b)=>[...h,{stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:g+(f+o)*b+(f-v)/2,size:v}}],l)}return s}}var Nge,Fge=F(()=>{wr();Rl();Nge=(e,t,r,n,i,a,o)=>{var s=Or(o)?t:o,l=tUe(r,n,i!==a?i:a,e,s);return i!==a&&l!=null&&(l=l.map(c=>oF(oF({},c),{},{position:oF(oF({},c.position),{},{offset:c.position.offset-i/2})}))),l}});var Oge,zge=F(()=>{gC();Oge=(e,t)=>{var r=Lh(t);if(!(!e||r==null||t==null)){var{stackId:n}=t;if(n!=null){var i=e[n];if(i){var{stackedData:a}=i;if(a)return a.find(o=>o.key===r)}}}}});function jge(e,t){return e&&typeof e=="object"&&"zIndex"in e&&typeof e.zIndex=="number"&&Lr(e.zIndex)?e.zIndex:t}var _ge=F(()=>{Rl()});var Bge,sF,jU=F(()=>{Bge=Y(Q());k2();Jr();hs();sF=e=>{var{chartData:t}=e,r=lr(),n=Qr();return(0,Bge.useEffect)(()=>n?()=>{}:(r(Q8(t)),()=>{r(Q8(void 0))}),[t,r,n]),null}});var Wge,$ge,$Nt,Rge,Uge=F(()=>{Lo();Wge={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},$ge=Pi({name:"brush",initialState:Wge,reducers:{setBrushSettings(e,t){return t.payload==null?Wge:t.payload}}}),{setBrushSettings:$Nt}=$ge.actions,Rge=$ge.reducer});function Hge(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function lF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Hge(Object(r),!0).forEach(function(n){qge(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hge(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qge(e,t,r){return(t=rUe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rUe(e){var t=nUe(e,"string");return typeof t=="symbol"?t:t+""}function nUe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aUe(e){return(e%180+180)%180}var iUe,Vge,cF,Gge,Yge,_U=F(()=>{iUe=(e,t)=>{var{x:r,y:n}=e,{x:i,y:a}=t;return{x:Math.min(r,i),y:Math.min(n,a),width:Math.abs(i-r),height:Math.abs(a-n)}},Vge=e=>{var{x1:t,y1:r,x2:n,y2:i}=e;return iUe({x:t,y:r},{x:n,y:i})},cF=class e{static create(t){return new e(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(n)switch(n){case"start":return this.scale(t);case"middle":{var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+i}case"end":{var a=this.bandwidth?this.bandwidth():0;return this.scale(t)+a}default:return this.scale(t)}if(r){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+o}return this.scale(t)}}isInRange(t){var r=this.range(),n=r[0],i=r[r.length-1];return n<=i?t>=n&&t<=i:t>=i&&t<=n}};qge(cF,"EPS",1e-4);Gge=e=>{var t=Object.keys(e).reduce((r,n)=>lF(lF({},r),{},{[n]:cF.create(e[n])}),{});return lF(lF({},t),{},{apply(r){var{bandAware:n,position:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Object.fromEntries(Object.entries(r).map(a=>{var[o,s]=a;return[o,t[o].apply(s,{bandAware:n,position:i})]}))},isInRange(r){return Object.keys(r).every(n=>t[n].isInRange(r[n]))}})};Yge=function(t){var{width:r,height:n}=t,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=aUe(i),o=a*Math.PI/180,s=Math.atan(n/r),l=o>s&&o<Math.PI-s?n/Math.sin(o):r/Math.cos(o);return Math.abs(l)}});var oUe,Kge,qNt,VNt,GNt,YNt,Jge,Qge,Xge,BU=F(()=>{Lo();oUe={dots:[],areas:[],lines:[]},Kge=Pi({name:"referenceElements",initialState:oUe,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=dl(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=dl(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=dl(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:qNt,removeDot:VNt,addArea:GNt,removeArea:YNt,addLine:Jge,removeLine:Qge}=Kge.actions,Xge=Kge.reducer});var tP,Uw,Zge,ehe,the,WU=F(()=>{tP=Y(Q()),Uw=Y(Q());wr();Rw();Zge=(0,Uw.createContext)(void 0),ehe=e=>{var{children:t}=e,[r]=(0,Uw.useState)("".concat(Tf("recharts"),"-clip")),n=Vh();if(n==null)return null;var{x:i,y:a,width:o,height:s}=n;return tP.createElement(Zge.Provider,{value:r},tP.createElement("defs",null,tP.createElement("clipPath",{id:r},tP.createElement("rect",{x:i,y:a,height:s,width:o}))),t)},the=()=>(0,Uw.useContext)(Zge)});function rhe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function nhe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rhe(Object(r),!0).forEach(function(n){sUe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rhe(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sUe(e,t,r){return(t=lUe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lUe(e){var t=cUe(e,"string");return typeof t=="symbol"?t:t+""}function cUe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dF(){return dF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dF.apply(null,arguments)}function gUe(e){var t=lr();return(0,ihe.useEffect)(()=>(t(Jge(e)),()=>{t(Qge(e))})),null}function hUe(e){var{xAxisId:t,yAxisId:r,shape:n,className:i,ifOverflow:a}=e,o=Qr(),s=the(),l=je(S=>tu(S,t)),c=je(S=>ru(S,r)),d=je(S=>Sb(S,"xAxis",t,o)),u=je(S=>Sb(S,"yAxis",r,o)),p=Ef();if(!s||!p||l==null||c==null||d==null||u==null)return null;var m=Gge({x:d,y:u}),g=fUe(m,p,e.position,l.orientation,c.orientation,e);if(!g)return null;var[{x:f,y:v},{x:h,y}]=g,b=a==="hidden"?"url(#".concat(s,")"):void 0,k=nhe(nhe({clipPath:b},nn(e)),{},{x1:f,y1:v,x2:h,y2:y}),x=Vge({x1:f,y1:v,x2:h,y2:y});return Yl.createElement(Fn,{zIndex:e.zIndex},Yl.createElement(Yr,{className:wt("recharts-reference-line",i)},dUe(n,k),Yl.createElement(P2,dF({},x,{lowerWidth:x.width,upperWidth:x.width}),Yl.createElement(D2,{label:e.label}),e.children)))}function Xa(e){var t=pr(e,vUe);return Yl.createElement(Yl.Fragment,null,Yl.createElement(gUe,{yAxisId:t.yAxisId,xAxisId:t.xAxisId,ifOverflow:t.ifOverflow,x:t.x,y:t.y,segment:t.segment}),Yl.createElement(hUe,t))}var Yl,ihe,dUe,uUe,pUe,mUe,fUe,vUe,ahe=F(()=>{Yl=Y(Q()),ihe=Y(Q());Zn();bc();Nw();wr();_U();xi();BU();Jr();Vl();hs();WU();_s();ma();hl();ys();Rl();dUe=(e,t)=>{var r;if(Yl.isValidElement(e))r=Yl.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{if(!Lr(t.x1)||!Lr(t.y1)||!Lr(t.x2)||!Lr(t.y2))return null;r=Yl.createElement("line",dF({},t,{className:"recharts-reference-line-line"}))}return r},uUe=(e,t,r,n,i,a)=>{var{x:o,width:s}=a,l=i.y.apply(e,{position:r});if(Ga(l)||t==="discard"&&!i.y.isInRange(l))return null;var c=[{x:o+s,y:l},{x:o,y:l}];return n==="left"?c.reverse():c},pUe=(e,t,r,n,i,a)=>{var{y:o,height:s}=a,l=i.x.apply(e,{position:r});if(Ga(l)||t==="discard"&&!i.x.isInRange(l))return null;var c=[{x:l,y:o+s},{x:l,y:o}];return n==="top"?c.reverse():c},mUe=(e,t,r,n)=>{var i=e.map(a=>n.apply(a,{position:r}));return t==="discard"&&i.some(a=>!n.isInRange(a))?null:i},fUe=(e,t,r,n,i,a)=>{var{x:o,y:s,segment:l,ifOverflow:c}=a,d=gs(o),u=gs(s);return u?uUe(s,c,r,i,e,t):d?pUe(o,c,r,n,e,t):l!=null&&l.length===2?mUe(l,c,r,e):null};vUe={ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle",zIndex:zr.line};Xa.displayName="ReferenceLine"});function uF(e,t){if(t<1)return[];if(t===1)return e;for(var r=[],n=0;n<e.length;n+=t){var i=e[n];i!==void 0&&r.push(i)}return r}var $U=F(()=>{});function ohe(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return Yge(n,r)}function she(e,t,r){var n=r==="width",{x:i,y:a,width:o,height:s}=e;return t===1?{start:n?i:a,end:n?i+o:a+s}:{start:n?i+o:a+s,end:n?i:a}}function Mb(e,t,r,n,i){if(e*t<e*n||e*t>e*i)return!1;var a=r();return e*(t-e*a/2-n)>=0&&e*(t+e*a/2-i)<=0}function lhe(e,t){return uF(e,t+1)}var RU=F(()=>{_U();$U()});function che(e,t,r,n,i){for(var a=(n||[]).slice(),{start:o,end:s}=t,l=0,c=1,d=o,u=function(){var g=n==null?void 0:n[l];if(g===void 0)return{v:uF(n,c)};var f=l,v,h=()=>(v===void 0&&(v=r(g,f)),v),y=g.coordinate,b=l===0||Mb(e,y,h,d,s);b||(l=0,d=o,c+=1),b&&(d=y+e*(h()/2+i),l+=c)},p;c<=a.length;)if(p=u(),p)return p.v;return[]}function dhe(e,t,r,n,i){var a=(n||[]).slice(),o=a.length;if(o===0)return[];for(var{start:s,end:l}=t,c=1;c<=o;c++){for(var d=(o-1)%c,u=s,p=!0,m=function(){var y=n[g],b=g,k,x=()=>(k===void 0&&(k=r(y,b)),k),S=y.coordinate,w=g===d||Mb(e,S,x,u,l);if(!w)return p=!1,1;w&&(u=S+e*(x()/2+i))},g=d;g<o&&!m();g+=c);if(p){for(var f=[],v=d;v<o;v+=c)f.push(n[v]);return f}}return[]}var uhe=F(()=>{RU();$U()});function phe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function yl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?phe(Object(r),!0).forEach(function(n){yUe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):phe(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yUe(e,t,r){return(t=bUe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bUe(e){var t=xUe(e,"string");return typeof t=="symbol"?t:t+""}function xUe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wUe(e,t,r,n,i){for(var a=(n||[]).slice(),o=a.length,{start:s}=t,{end:l}=t,c=function(p){var m=a[p],g,f=()=>(g===void 0&&(g=r(m,p)),g);if(p===o-1){var v=e*(m.coordinate+e*f()/2-l);a[p]=m=yl(yl({},m),{},{tickCoord:v>0?m.coordinate-v*e:m.coordinate})}else a[p]=m=yl(yl({},m),{},{tickCoord:m.coordinate});if(m.tickCoord!=null){var h=Mb(e,m.tickCoord,f,s,l);h&&(l=m.tickCoord-e*(f()/2+i),a[p]=yl(yl({},m),{},{isShow:!0}))}},d=o-1;d>=0;d--)c(d);return a}function kUe(e,t,r,n,i,a){var o=(n||[]).slice(),s=o.length,{start:l,end:c}=t;if(a){var d=n[s-1],u=r(d,s-1),p=e*(d.coordinate+e*u/2-c);if(o[s-1]=d=yl(yl({},d),{},{tickCoord:p>0?d.coordinate-p*e:d.coordinate}),d.tickCoord!=null){var m=Mb(e,d.tickCoord,()=>u,l,c);m&&(c=d.tickCoord-e*(u/2+i),o[s-1]=yl(yl({},d),{},{isShow:!0}))}}for(var g=a?s-1:s,f=function(y){var b=o[y],k,x=()=>(k===void 0&&(k=r(b,y)),k);if(y===0){var S=e*(b.coordinate-e*x()/2-l);o[y]=b=yl(yl({},b),{},{tickCoord:S<0?b.coordinate-S*e:b.coordinate})}else o[y]=b=yl(yl({},b),{},{tickCoord:b.coordinate});if(b.tickCoord!=null){var w=Mb(e,b.tickCoord,x,l,c);w&&(l=b.tickCoord+e*(x()/2+i),o[y]=yl(yl({},b),{},{isShow:!0}))}},v=0;v<g;v++)f(v);return o}function rP(e,t,r){var{tick:n,ticks:i,viewBox:a,minTickGap:o,orientation:s,interval:l,tickFormatter:c,unit:d,angle:u}=e;if(!i||!i.length||!n)return[];if(at(l)||Hd.isSsr){var p;return(p=lhe(i,at(l)?l:0))!==null&&p!==void 0?p:[]}var m=[],g=s==="top"||s==="bottom"?"width":"height",f=d&&g==="width"?Db(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},v=(b,k)=>{var x=typeof c=="function"?c(b.value,k):b.value;return g==="width"?ohe(Db(x,{fontSize:t,letterSpacing:r}),f,u):Db(x,{fontSize:t,letterSpacing:r})[g]},h=i.length>=2?Va(i[1].coordinate-i[0].coordinate):1,y=she(a,h,g);return l==="equidistantPreserveStart"?che(h,y,v,i,o):l==="equidistantPreserveEnd"?dhe(h,y,v,i,o):(l==="preserveStart"||l==="preserveStartEnd"?m=kUe(h,y,v,i,o,l==="preserveStartEnd"):m=wUe(h,y,v,i,o),m.filter(b=>b.isShow))}var UU=F(()=>{wr();eU();Zy();RU();uhe()});var mhe,fhe=F(()=>{mhe=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:i=0,tickMargin:a=0}=e,o=0;if(t){Array.from(t).forEach(d=>{if(d){var u=d.getBoundingClientRect();u.width>o&&(o=u.width)}});var s=r?r.getBoundingClientRect().width:0,l=i+a,c=o+l+s+(r?n:0);return Math.round(c)}return 0}});function TUe(e,t){if(e==null)return{};var r,n,i=CUe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function CUe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Ab(){return Ab=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ab.apply(null,arguments)}function ghe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Oo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ghe(Object(r),!0).forEach(function(n){PUe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ghe(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function PUe(e,t,r){return(t=DUe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DUe(e){var t=EUe(e,"string");return typeof t=="symbol"?t:t+""}function EUe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function IUe(e){var{x:t,y:r,width:n,height:i,orientation:a,mirror:o,axisLine:s,otherSvgProps:l}=e;if(!s)return null;var c=Oo(Oo(Oo({},l),mn(s)),{},{fill:"none"});if(a==="top"||a==="bottom"){var d=+(a==="top"&&!o||a==="bottom"&&o);c=Oo(Oo({},c),{},{x1:t,y1:r+d*i,x2:t+n,y2:r+d*i})}else{var u=+(a==="left"&&!o||a==="right"&&o);c=Oo(Oo({},c),{},{x1:t+u*n,y1:r,x2:t+u*n,y2:r+i})}return ha.createElement("line",Ab({},c,{className:wt("recharts-cartesian-axis-line",(0,HU.default)(s,"className"))}))}function MUe(e,t,r,n,i,a,o,s,l){var c,d,u,p,m,g,f=s?-1:1,v=e.tickSize||o,h=at(e.tickCoord)?e.tickCoord:e.coordinate;switch(a){case"top":c=d=e.coordinate,p=r+ +!s*i,u=p-f*v,g=u-f*l,m=h;break;case"left":u=p=e.coordinate,d=t+ +!s*n,c=d-f*v,m=c-f*l,g=h;break;case"right":u=p=e.coordinate,d=t+ +s*n,c=d+f*v,m=c+f*l,g=h;break;default:c=d=e.coordinate,p=r+ +s*i,u=p+f*v,g=u+f*l,m=h;break}return{line:{x1:c,y1:u,x2:d,y2:p},tick:{x:m,y:g}}}function AUe(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function LUe(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function NUe(e){var{option:t,tickProps:r,value:n}=e,i,a=wt(r.className,"recharts-cartesian-axis-tick-value");if(ha.isValidElement(t))i=ha.cloneElement(t,Oo(Oo({},r),{},{className:a}));else if(typeof t=="function")i=t(Oo(Oo({},r),{},{className:a}));else{var o="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(o=wt(o,t==null?void 0:t.className)),i=ha.createElement(Wf,Ab({},r,{className:o}),n)}return i}var ha,au,HU,SUe,ou,FUe,OUe,nP,pF=F(()=>{ha=Y(Q()),au=Y(Q()),HU=Y(I1());Zn();bc();OC();Nw();wr();qu();UU();js();fhe();ma();hl();ys();SUe=["axisLine","width","height","className","hide","ticks","axisType"];ou={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:zr.axis};FUe=(0,au.forwardRef)((e,t)=>{var{ticks:r=[],tick:n,tickLine:i,stroke:a,tickFormatter:o,unit:s,padding:l,tickTextProps:c,orientation:d,mirror:u,x:p,y:m,width:g,height:f,tickSize:v,tickMargin:h,fontSize:y,letterSpacing:b,getTicksConfig:k,events:x,axisType:S}=e,w=rP(Oo(Oo({},k),{},{ticks:r}),y,b),C=AUe(d,u),D=LUe(d,u),P=mn(k),M=yc(n),z={};typeof i=="object"&&(z=i);var A=Oo(Oo({},P),{},{fill:"none"},z),I=w.map(T=>Oo({entry:T},MUe(T,p,m,g,f,d,v,u,h))),L=I.map(T=>{var{entry:$,line:_}=T;return ha.createElement(Yr,{className:"recharts-cartesian-axis-tick",key:"tick-".concat($.value,"-").concat($.coordinate,"-").concat($.tickCoord)},i&&ha.createElement("line",Ab({},A,_,{className:wt("recharts-cartesian-axis-tick-line",(0,HU.default)(i,"className"))})))}),E=I.map((T,$)=>{var{entry:_,tick:B}=T,W=Oo(Oo(Oo(Oo({textAnchor:C,verticalAnchor:D},P),{},{stroke:"none",fill:a},M),B),{},{index:$,payload:_,visibleTicksCount:w.length,tickFormatter:o,padding:l},c);return ha.createElement(Yr,Ab({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(_.value,"-").concat(_.coordinate,"-").concat(_.tickCoord)},Hu(x,_,$)),n&&ha.createElement(NUe,{option:n,tickProps:W,value:"".concat(typeof o=="function"?o(_.value,$):_.value).concat(s||"")}))});return ha.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(S,"-ticks")},E.length>0&&ha.createElement(Fn,{zIndex:zr.label},ha.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(S,"-tick-labels"),ref:t},E)),L.length>0&&ha.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(S,"-tick-lines")},L))}),OUe=(0,au.forwardRef)((e,t)=>{var{axisLine:r,width:n,height:i,className:a,hide:o,ticks:s,axisType:l}=e,c=TUe(e,SUe),[d,u]=(0,au.useState)(""),[p,m]=(0,au.useState)(""),g=(0,au.useRef)(null);(0,au.useImperativeHandle)(t,()=>({getCalculatedWidth:()=>{var v;return mhe({ticks:g.current,label:(v=e.labelRef)===null||v===void 0?void 0:v.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var f=(0,au.useCallback)(v=>{if(v){var h=v.getElementsByClassName("recharts-cartesian-axis-tick-value");g.current=h;var y=h[0];if(y){var b=window.getComputedStyle(y),k=b.fontSize,x=b.letterSpacing;(k!==d||x!==p)&&(u(k),m(x))}}},[d,p]);return o||n!=null&&n<=0||i!=null&&i<=0?null:ha.createElement(Fn,{zIndex:e.zIndex},ha.createElement(Yr,{className:wt("recharts-cartesian-axis",a)},ha.createElement(IUe,{x:e.x,y:e.y,width:n,height:i,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:mn(e)}),ha.createElement(FUe,{ref:f,axisType:l,events:c,fontSize:d,getTicksConfig:e,height:e.height,letterSpacing:p,mirror:e.mirror,orientation:e.orientation,padding:e.padding,stroke:e.stroke,tick:e.tick,tickFormatter:e.tickFormatter,tickLine:e.tickLine,tickMargin:e.tickMargin,tickSize:e.tickSize,tickTextProps:e.tickTextProps,ticks:s,unit:e.unit,width:e.width,x:e.x,y:e.y}),ha.createElement(P2,{x:e.x,y:e.y,width:e.width,height:e.height,lowerWidth:e.width,upperWidth:e.width},ha.createElement(D2,{label:e.label,labelRef:e.labelRef}),e.children)))}),nP=ha.forwardRef((e,t)=>{var r=pr(e,ou);return ha.createElement(OUe,Ab({},r,{ref:t}))});nP.displayName="CartesianAxis"});function hhe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function bl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hhe(Object(r),!0).forEach(function(n){WUe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hhe(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function WUe(e,t,r){return(t=$Ue(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $Ue(e){var t=RUe(e,"string");return typeof t=="symbol"?t:t+""}function RUe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lb(){return Lb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lb.apply(null,arguments)}function mF(e,t){if(e==null)return{};var r,n,i=UUe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function UUe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function vhe(e){var{option:t,lineItemProps:r}=e,n;if(Za.isValidElement(t))n=Za.cloneElement(t,r);else if(typeof t=="function")n=t(r);else{var i,{x1:a,y1:o,x2:s,y2:l,key:c}=r,d=mF(r,zUe),u=(i=mn(d))!==null&&i!==void 0?i:{},{offset:p}=u,m=mF(u,jUe);n=Za.createElement("line",Lb({},m,{x1:a,y1:o,x2:s,y2:l,fill:"none",key:c}))}return n}function qUe(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:i}=e;if(!n||!i||!i.length)return null;var{xAxisId:a,yAxisId:o}=e,s=mF(e,_Ue),l=i.map((c,d)=>{var u=bl(bl({},s),{},{x1:t,y1:c,x2:t+r,y2:c,key:"line-".concat(d),index:d});return Za.createElement(vhe,{key:"line-".concat(d),option:n,lineItemProps:u})});return Za.createElement("g",{className:"recharts-cartesian-grid-horizontal"},l)}function VUe(e){var{y:t,height:r,vertical:n=!0,verticalPoints:i}=e;if(!n||!i||!i.length)return null;var{xAxisId:a,yAxisId:o}=e,s=mF(e,BUe),l=i.map((c,d)=>{var u=bl(bl({},s),{},{x1:c,y1:t,x2:c,y2:t+r,key:"line-".concat(d),index:d});return Za.createElement(vhe,{option:n,lineItemProps:u,key:"line-".concat(d)})});return Za.createElement("g",{className:"recharts-cartesian-grid-vertical"},l)}function GUe(e){var{horizontalFill:t,fillOpacity:r,x:n,y:i,width:a,height:o,horizontalPoints:s,horizontal:l=!0}=e;if(!l||!t||!t.length||s==null)return null;var c=s.map(u=>Math.round(u+i-i)).sort((u,p)=>u-p);i!==c[0]&&c.unshift(0);var d=c.map((u,p)=>{var m=!c[p+1],g=m?i+o-u:c[p+1]-u;if(g<=0)return null;var f=p%t.length;return Za.createElement("rect",{key:"react-".concat(p),y:u,x:n,height:g,width:a,stroke:"none",fill:t[f],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return Za.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function YUe(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:i,y:a,width:o,height:s,verticalPoints:l}=e;if(!t||!r||!r.length)return null;var c=l.map(u=>Math.round(u+i-i)).sort((u,p)=>u-p);i!==c[0]&&c.unshift(0);var d=c.map((u,p)=>{var m=!c[p+1],g=m?i+o-u:c[p+1]-u;if(g<=0)return null;var f=p%r.length;return Za.createElement("rect",{key:"react-".concat(p),x:u,y:a,width:g,height:s,stroke:"none",fill:r[f],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return Za.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}function zo(e){var t=Q0(),r=X0(),n=bL(),i=bl(bl({},pr(e,QUe)),{},{x:at(e.x)?e.x:n.left,y:at(e.y)?e.y:n.top,width:at(e.width)?e.width:n.width,height:at(e.height)?e.height:n.height}),{xAxisId:a,yAxisId:o,x:s,y:l,width:c,height:d,syncWithTicks:u,horizontalValues:p,verticalValues:m}=i,g=Qr(),f=je(D=>k8(D,"xAxis",a,g)),v=je(D=>k8(D,"yAxis",o,g));if(!Df(c)||!Df(d)||!at(s)||!at(l))return null;var h=i.verticalCoordinatesGenerator||KUe,y=i.horizontalCoordinatesGenerator||JUe,{horizontalPoints:b,verticalPoints:k}=i;if((!b||!b.length)&&typeof y=="function"){var x=p&&p.length,S=y({yAxis:v?bl(bl({},v),{},{ticks:x?p:v.ticks}):void 0,width:t!=null?t:c,height:r!=null?r:d,offset:n},x?!0:u);s6(Array.isArray(S),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof S,"]")),Array.isArray(S)&&(b=S)}if((!k||!k.length)&&typeof h=="function"){var w=m&&m.length,C=h({xAxis:f?bl(bl({},f),{},{ticks:w?m:f.ticks}):void 0,width:t!=null?t:c,height:r!=null?r:d,offset:n},w?!0:u);s6(Array.isArray(C),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof C,"]")),Array.isArray(C)&&(k=C)}return Za.createElement(Fn,{zIndex:i.zIndex},Za.createElement("g",{className:"recharts-cartesian-grid"},Za.createElement(HUe,{fill:i.fill,fillOpacity:i.fillOpacity,x:i.x,y:i.y,width:i.width,height:i.height,ry:i.ry}),Za.createElement(GUe,Lb({},i,{horizontalPoints:b})),Za.createElement(YUe,Lb({},i,{verticalPoints:k})),Za.createElement(qUe,Lb({},i,{offset:n,horizontalPoints:b,xAxis:f,yAxis:v})),Za.createElement(VUe,Lb({},i,{offset:n,verticalPoints:k,xAxis:f,yAxis:v}))))}var Za,zUe,jUe,_Ue,BUe,HUe,KUe,JUe,QUe,yhe=F(()=>{Za=Y(Q());Boe();wr();Ja();UU();pF();xi();Vl();Jr();hs();ma();js();Rl();hl();ys();zUe=["x1","y1","x2","y2","key"],jUe=["offset"],_Ue=["xAxisId","yAxisId"],BUe=["xAxisId","yAxisId"];HUe=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:i,width:a,height:o,ry:s}=e;return Za.createElement("rect",{x:n,y:i,ry:s,width:a,height:o,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};KUe=(e,t)=>{var{xAxis:r,width:n,height:i,offset:a}=e;return e6(rP(bl(bl(bl({},ou),r),{},{ticks:t6(r,!0),viewBox:{x:0,y:0,width:n,height:i}})),a.left,a.left+a.width,t)},JUe=(e,t)=>{var{yAxis:r,width:n,height:i,offset:a}=e;return e6(rP(bl(bl(bl({},ou),r),{},{ticks:t6(r,!0),viewBox:{x:0,y:0,width:n,height:i}})),a.top,a.top+a.height,t)},QUe={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0,syncWithTicks:!1,zIndex:zr.grid};zo.displayName="CartesianGrid"});var XUe,bhe,aFt,oFt,sFt,xhe,whe=F(()=>{Lo();XUe={},bhe=Pi({name:"errorBars",initialState:XUe,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:i}=t.payload;e[r]&&(e[r]=e[r].map(a=>a.dataKey===n.dataKey&&a.direction===n.direction?i:a))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(i=>i.dataKey!==n.dataKey||i.direction!==n.direction))}}}),{addErrorBar:aFt,replaceErrorBar:oFt,removeErrorBar:sFt}=bhe.actions,xhe=bhe.reducer});function eHe(e,t){if(e==null)return{};var r,n,i=tHe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function tHe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function fF(e){var{children:t}=e,r=eHe(e,ZUe);return khe.createElement(nHe.Provider,{value:r},t)}var khe,iP,ZUe,rHe,nHe,qU=F(()=>{khe=Y(Q()),iP=Y(Q()),ZUe=["children"];rHe={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},nHe=(0,iP.createContext)(rHe)});function Nb(e,t){var r,n,i=je(c=>tu(c,e)),a=je(c=>ru(c,t)),o=(r=i==null?void 0:i.allowDataOverflow)!==null&&r!==void 0?r:No.allowDataOverflow,s=(n=a==null?void 0:a.allowDataOverflow)!==null&&n!==void 0?n:Fo.allowDataOverflow,l=o||s;return{needClip:l,needClipX:o,needClipY:s}}function Hw(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,i=Vh(),{needClipX:a,needClipY:o,needClip:s}=Nb(t,r);if(!s||!i)return null;var{x:l,y:c,width:d,height:u}=i;return VU.createElement("clipPath",{id:"clipPath-".concat(n)},VU.createElement("rect",{x:a?l:l-d/2,y:o?c:c-u/2,width:a?d:d*2,height:o?u:u*2}))}var VU,gF=F(()=>{VU=Y(Q());Jr();Vl();Rw()});function oHe(e){return e.type==="line"}var She,The,Che,Phe,iHe,aHe,sHe,Dhe,Ehe=F(()=>{Ka();GU();Of();xi();Vl();Ja();She=(e,t,r,n)=>id(e,"xAxis",t,n),The=(e,t,r,n)=>nd(e,"xAxis",t,n),Che=(e,t,r,n)=>id(e,"yAxis",r,n),Phe=(e,t,r,n)=>nd(e,"yAxis",r,n),iHe=de([Jt,She,Che,The,Phe],(e,t,r,n,i)=>ul(e,"xAxis")?Ul(t,n,!1):Ul(r,i,!1)),aHe=(e,t,r,n,i)=>i;sHe=de([Fh,aHe],(e,t)=>e.filter(oHe).find(r=>r.id===t)),Dhe=de([Jt,She,Che,The,Phe,sHe,iHe,fC],(e,t,r,n,i,a,o,s)=>{var{chartData:l,dataStartIndex:c,dataEndIndex:d}=s;if(!(a==null||t==null||r==null||n==null||i==null||n.length===0||i.length===0||o==null||e!=="horizontal"&&e!=="vertical")){var{dataKey:u,data:p}=a,m;if(p!=null&&p.length>0?m=p:m=l==null?void 0:l.slice(c,d+1),m!=null)return Ihe({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:i,dataKey:u,bandSize:o,displayedData:m})}})});function hF(e){var t=yc(e),r=3,n=2;if(t!=null){var{r:i,strokeWidth:a}=t,o=Number(i),s=Number(a);return(Number.isNaN(o)||o<0)&&(o=r),(Number.isNaN(s)||s<0)&&(s=n),{r:o,strokeWidth:s}}return{r,strokeWidth:n}}var YU=F(()=>{js()});var Ahe=Fe(Mhe=>{"use strict";var aP=Q();function lHe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var cHe=typeof Object.is=="function"?Object.is:lHe,dHe=aP.useSyncExternalStore,uHe=aP.useRef,pHe=aP.useEffect,mHe=aP.useMemo,fHe=aP.useDebugValue;Mhe.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var a=uHe(null);if(a.current===null){var o={hasValue:!1,value:null};a.current=o}else o=a.current;a=mHe(function(){function l(m){if(!c){if(c=!0,d=m,m=n(m),i!==void 0&&o.hasValue){var g=o.value;if(i(g,m))return u=g}return u=m}if(g=u,cHe(d,m))return g;var f=n(m);return i!==void 0&&i(g,f)?(d=m,g):(d=m,u=f)}var c=!1,d,u,p=r===void 0?null:r;return[function(){return l(t())},p===null?void 0:function(){return l(p())}]},[t,r,n,i]);var s=dHe(e,a[0],a[1]);return pHe(function(){o.hasValue=!0,o.value=s},[s]),fHe(s),s}});var Nhe=Fe((TFt,Lhe)=>{"use strict";Lhe.exports=Ahe()});function bHe(e){e()}function xHe(){let e=null,t=null;return{clear(){e=null,t=null},notify(){bHe(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){let r=[],n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0,i=t={callback:r,next:null,prev:t};return i.prev?i.prev.next=i:e=i,function(){!n||e===null||(n=!1,i.next?i.next.prev=i.prev:t=i.prev,i.prev?i.prev.next=i.next:e=i.next)}}}}function wHe(e,t){let r,n=Fhe,i=0,a=!1;function o(f){d();let v=n.subscribe(f),h=!1;return()=>{h||(h=!0,v(),u())}}function s(){n.notify()}function l(){g.onStateChange&&g.onStateChange()}function c(){return a}function d(){i++,r||(r=t?t.addNestedSub(l):e.subscribe(l),n=xHe())}function u(){i--,r&&i===0&&(r(),r=void 0,n.clear(),n=Fhe)}function p(){a||(a=!0,d())}function m(){a&&(a=!1,u())}let g={addNestedSub:o,notifyNestedSubs:s,handleChangeWrapper:l,isSubscribed:c,trySubscribe:p,tryUnsubscribe:m,getListeners:()=>n};return g}function Ohe(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function zhe(e,t){if(Ohe(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;let r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(!Object.prototype.hasOwnProperty.call(t,r[i])||!Ohe(e[r[i]],t[r[i]]))return!1;return!0}function MHe(){var r;if(!eo.createContext)return{};let e=(r=JU[KU])!=null?r:JU[KU]=new Map,t=e.get(eo.createContext);return t||(t=eo.createContext(null),e.set(eo.createContext,t)),t}function LHe(e){let{children:t,context:r,serverState:n,store:i}=e,a=eo.useMemo(()=>{let l=wHe(i);return{store:i,subscription:l,getServerState:n?()=>n:void 0}},[i,n]),o=eo.useMemo(()=>i.getState(),[i]);return DHe(()=>{let{subscription:l}=a;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),o!==i.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[a,o]),eo.createElement((r||AHe).Provider,{value:a},t)}var eo,NHe,gHe,hHe,vHe,yHe,Fhe,kHe,SHe,THe,CHe,PHe,DHe,EHe,IHe,CFt,PFt,KU,JU,AHe,jhe,QU=F(()=>{eo=Y(Q(),1),NHe=Y(Nhe(),1),gHe=Symbol.for("react.forward_ref"),hHe=Symbol.for("react.memo"),vHe=gHe,yHe=hHe;Fhe={notify(){},get:()=>[]};kHe=()=>typeof window!="undefined"&&typeof window.document!="undefined"&&typeof window.document.createElement!="undefined",SHe=kHe(),THe=()=>typeof navigator!="undefined"&&navigator.product==="ReactNative",CHe=THe(),PHe=()=>SHe||CHe?eo.useLayoutEffect:eo.useEffect,DHe=PHe();EHe={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},IHe={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},CFt={[vHe]:EHe,[yHe]:IHe},PFt=Object.prototype,KU=Symbol.for("react-redux-context"),JU=typeof globalThis!="undefined"?globalThis:{};AHe=MHe();jhe=LHe});function OHe(e,t){return e==null&&t==null?!0:typeof e=="number"&&typeof t=="number"?e===t||e!==e&&t!==t:e===t}function um(e,t){var r=new Set([...Object.keys(e),...Object.keys(t)]);for(var n of r)if(FHe.has(n)){if(e[n]==null&&t[n]==null)continue;if(!zhe(e[n],t[n]))return!1}else if(!OHe(e[n],t[n]))return!1;return!0}var FHe,qw=F(()=>{QU();FHe=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"])});function oP(){return oP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},oP.apply(null,arguments)}function _he(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function pm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_he(Object(r),!0).forEach(function(n){BHe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_he(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function BHe(e,t,r){return(t=WHe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WHe(e){var t=$He(e,"string");return typeof t=="symbol"?t:t+""}function $He(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ZU(e,t){if(e==null)return{};var r,n,i=RHe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function RHe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function qHe(e,t){for(var r=e.length%2!==0?[...e,0]:e,n=[],i=0;i<t;++i)n=[...n,...r];return n}function GHe(e){var{clipPathId:t,points:r,props:n}=e,{dot:i,dataKey:a,needClip:o}=n,{id:s}=n,l=ZU(n,zHe),c=mn(l);return xn.createElement($w,{points:r,dot:i,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:a,baseProps:c,needClip:o,clipPathId:t})}function YHe(e){var{showLabels:t,children:r,points:n}=e,i=(0,Kl.useMemo)(()=>n==null?void 0:n.map(a=>{var o,s,l={x:(o=a.x)!==null&&o!==void 0?o:0,y:(s=a.y)!==null&&s!==void 0?s:0,width:0,lowerWidth:0,upperWidth:0,height:0};return pm(pm({},l),{},{value:a.value,payload:a.payload,viewBox:l,parentViewBox:void 0,fill:void 0})}),[n]);return xn.createElement(Wh,{value:t?i:void 0},r)}function Bhe(e){var{clipPathId:t,pathRef:r,points:n,strokeDasharray:i,props:a}=e,{type:o,layout:s,connectNulls:l,needClip:c,shape:d}=a,u=ZU(a,jHe),p=pm(pm({},nn(u)),{},{fill:"none",className:"recharts-line-curve",clipPath:c?"url(#clipPath-".concat(t,")"):void 0,points:n,type:o,layout:s,connectNulls:l,strokeDasharray:i!=null?i:a.strokeDasharray});return xn.createElement(xn.Fragment,null,(n==null?void 0:n.length)>1&&xn.createElement(Q2,oP({shapeType:"curve",option:d},p,{pathRef:r})),xn.createElement(GHe,{points:n,clipPathId:t,props:a}))}function KHe(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch(t){return 0}}function JHe(e){var{clipPathId:t,props:r,pathRef:n,previousPointsRef:i,longestAnimatedLengthRef:a}=e,{points:o,strokeDasharray:s,isAnimationActive:l,animationBegin:c,animationDuration:d,animationEasing:u,animateNewValues:p,width:m,height:g,onAnimationEnd:f,onAnimationStart:v}=r,h=i.current,y=Vd(o,"recharts-line-"),b=(0,Kl.useRef)(y),[k,x]=(0,Kl.useState)(!1),S=!k,w=(0,Kl.useCallback)(()=>{typeof f=="function"&&f(),x(!1)},[f]),C=(0,Kl.useCallback)(()=>{typeof v=="function"&&v(),x(!0)},[v]),D=KHe(n.current),P=(0,Kl.useRef)(0);b.current!==y&&(P.current=a.current,b.current=y);var M=P.current;return xn.createElement(YHe,{points:o,showLabels:S},r.children,xn.createElement(qd,{animationId:y,begin:c,duration:d,isActive:l,easing:u,onAnimationEnd:w,onAnimationStart:C,key:y},z=>{var A=Kr(M,D+M,z),I=Math.min(A,D),L;if(l)if(s){var E="".concat(s).split(/[,\s]+/gim).map(_=>parseFloat(_));L=VHe(I,D,E)}else L=Whe(D,I);else L=s==null?void 0:String(s);if(z>0&&D>0&&(i.current=o,a.current=Math.max(a.current,I)),h){var T=h.length/o.length,$=z===1?o:o.map((_,B)=>{var W=Math.floor(B*T);if(h[W]){var N=h[W];return pm(pm({},_),{},{x:Kr(N.x,_.x,z),y:Kr(N.y,_.y,z)})}return p?pm(pm({},_),{},{x:Kr(m*2,_.x,z),y:Kr(g/2,_.y,z)}):pm(pm({},_),{},{x:_.x,y:_.y})});return i.current=$,xn.createElement(Bhe,{props:r,points:$,clipPathId:t,pathRef:n,strokeDasharray:L})}return xn.createElement(Bhe,{props:r,points:o,clipPathId:t,pathRef:n,strokeDasharray:L})}),xn.createElement($h,{label:r.label}))}function QHe(e){var{clipPathId:t,props:r}=e,n=(0,Kl.useRef)(null),i=(0,Kl.useRef)(0),a=(0,Kl.useRef)(null);return xn.createElement(JHe,{props:r,clipPathId:t,previousPointsRef:n,longestAnimatedLengthRef:i,pathRef:a})}function ZHe(e){var t=pr(e,$he),{activeDot:r,animateNewValues:n,animationBegin:i,animationDuration:a,animationEasing:o,connectNulls:s,dot:l,hide:c,isAnimationActive:d,label:u,legendType:p,xAxisId:m,yAxisId:g,id:f}=t,v=ZU(t,_He),{needClip:h}=Nb(m,g),y=Vh(),b=xc(),k=Qr(),x=je(P=>Dhe(P,m,g,k,f));if(b!=="horizontal"&&b!=="vertical"||x==null||y==null)return null;var{height:S,width:w,x:C,y:D}=y;return xn.createElement(XU,oP({},v,{id:f,connectNulls:s,dot:l,activeDot:r,animateNewValues:n,animationBegin:i,animationDuration:a,animationEasing:o,isAnimationActive:d,hide:c,label:u,legendType:p,xAxisId:m,yAxisId:g,points:x,layout:b,height:S,width:w,left:C,top:D,needClip:h}))}function Ihe(e){var{layout:t,xAxis:r,yAxis:n,xAxisTicks:i,yAxisTicks:a,dataKey:o,bandSize:s,displayedData:l}=e;return l.map((c,d)=>{var u=fn(c,o);if(t==="horizontal"){var p=V0({axis:r,ticks:i,bandSize:s,entry:c,index:d}),m=Or(u)?null:n.scale(u);return{x:p,y:m,value:u,payload:c}}var g=Or(u)?null:r.scale(u),f=V0({axis:n,ticks:a,bandSize:s,entry:c,index:d});return g==null||f==null?null:{x:g,y:f,value:u,payload:c}}).filter(Boolean)}function eqe(e){var t=pr(e,$he),r=Qr();return xn.createElement(Hh,{id:t.id,type:"line"},n=>xn.createElement(xn.Fragment,null,xn.createElement(Bw,{legendPayload:UHe(t)}),xn.createElement(HHe,{dataKey:t.dataKey,data:t.data,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:n}),xn.createElement(Ww,{type:"line",id:n,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:r}),xn.createElement(ZHe,oP({},t,{id:n}))))}var xn,Kl,zHe,jHe,_He,UHe,HHe,Whe,VHe,XHe,XU,$he,su,GU=F(()=>{xn=Y(Q()),Kl=Y(Q());Zn();bc();jC();tF();wr();RC();Ja();nF();GC();qU();gF();xi();hs();Ehe();Jr();YC();rb();ma();Rw();KC();JC();js();tb();_s();YU();CU();hl();ys();qw();zHe=["id"],jHe=["type","layout","connectNulls","needClip","shape"],_He=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];UHe=e=>{var{dataKey:t,name:r,stroke:n,legendType:i,hide:a}=e;return[{inactive:a,dataKey:t,type:i,color:n,value:Rd(r,t),payload:e}]},HHe=xn.memo(e=>{var{dataKey:t,data:r,stroke:n,strokeWidth:i,fill:a,name:o,hide:s,unit:l,tooltipType:c,id:d}=e,u={dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:i,fill:a,dataKey:t,nameKey:void 0,name:Rd(o,t),hide:s,type:c,color:n,unit:l,graphicalItemId:d}};return xn.createElement(Rh,{tooltipEntrySettings:u})}),Whe=(e,t)=>"".concat(t,"px ").concat(e-t,"px");VHe=(e,t,r)=>{var n=r.reduce((u,p)=>u+p);if(!n)return Whe(t,e);for(var i=Math.floor(e/n),a=e%n,o=t-e,s=[],l=0,c=0;l<r.length;c+=r[l],++l)if(c+r[l]>a){s=[...r.slice(0,l),a-c];break}var d=s.length%2===0?[0,o]:[o];return[...qHe(r,i),...s,...d].map(u=>"".concat(u,"px")).join(", ")};XHe=(e,t)=>{var r,n;return{x:(r=e.x)!==null&&r!==void 0?r:void 0,y:(n=e.y)!==null&&n!==void 0?n:void 0,value:e.value,errorVal:fn(e.payload,t)}},XU=class extends Kl.Component{render(){var{hide:t,dot:r,points:n,className:i,xAxisId:a,yAxisId:o,top:s,left:l,width:c,height:d,id:u,needClip:p,zIndex:m}=this.props;if(t)return null;var g=wt("recharts-line",i),f=u,{r:v,strokeWidth:h}=hF(r),y=_w(r),b=v*2+h,k=p?"url(#clipPath-".concat(y?"":"dots-").concat(f,")"):void 0;return xn.createElement(Fn,{zIndex:m},xn.createElement(Yr,{className:g},p&&xn.createElement("defs",null,xn.createElement(Hw,{clipPathId:f,xAxisId:a,yAxisId:o}),!y&&xn.createElement("clipPath",{id:"clipPath-dots-".concat(f)},xn.createElement("rect",{x:l-b/2,y:s-b/2,width:c+b,height:d+b}))),xn.createElement(fF,{xAxisId:a,yAxisId:o,data:n,dataPointFormatter:XHe,errorBarOffset:0},xn.createElement(QHe,{props:this.props,clipPathId:f}))),xn.createElement(Ib,{activeDot:this.props.activeDot,points:n,mainColor:this.props.stroke,itemDataKey:this.props.dataKey,clipPath:k}))}},$he={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:"auto",label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:zr.line,type:"linear"};su=xn.memo(eqe,um);su.displayName="Line"});function lu(e,t){var r,n;return(r=(n=e.graphicalItems.cartesianItems.find(i=>i.id===t))===null||n===void 0?void 0:n.xAxisId)!==null&&r!==void 0?r:NU}function cu(e,t){var r,n;return(r=(n=e.graphicalItems.cartesianItems.find(i=>i.id===t))===null||n===void 0?void 0:n.yAxisId)!==null&&r!==void 0?r:NU}var eH=F(()=>{XC()});var Rhe,Uhe,Hhe,qhe,tqe,rqe,Vhe,Ghe,nqe,iqe,aqe,Yhe,Khe=F(()=>{Ka();tH();Vl();xi();Of();Ja();gC();Mh();eH();Rhe=(e,t,r)=>id(e,"xAxis",lu(e,t),r),Uhe=(e,t,r)=>nd(e,"xAxis",lu(e,t),r),Hhe=(e,t,r)=>id(e,"yAxis",cu(e,t),r),qhe=(e,t,r)=>nd(e,"yAxis",cu(e,t),r),tqe=de([Jt,Rhe,Hhe,Uhe,qhe],(e,t,r,n,i)=>ul(e,"xAxis")?Ul(t,n,!1):Ul(r,i,!1)),rqe=(e,t)=>t,Vhe=de([Fh,rqe],(e,t)=>e.filter(r=>r.type==="area").find(r=>r.id===t)),Ghe=e=>{var t=Jt(e),r=ul(t,"xAxis");return r?"yAxis":"xAxis"},nqe=(e,t)=>{var r=Ghe(e);return r==="yAxis"?cu(e,t):lu(e,t)},iqe=(e,t,r)=>kw(e,Ghe(e),nqe(e,t),r),aqe=de([Vhe,iqe],(e,t)=>{var r;if(!(e==null||t==null)){var{stackId:n}=e,i=Lh(e);if(!(n==null||i==null)){var a=(r=t[n])===null||r===void 0?void 0:r.stackedData,o=a==null?void 0:a.find(s=>s.key===i);if(o!=null)return o.map(s=>[s[0],s[1]])}}}),Yhe=de([Jt,Rhe,Hhe,Uhe,qhe,aqe,EN,tqe,Vhe,rue],(e,t,r,n,i,a,o,s,l,c)=>{var{chartData:d,dataStartIndex:u,dataEndIndex:p}=o;if(!(l==null||e!=="horizontal"&&e!=="vertical"||t==null||r==null||n==null||i==null||n.length===0||i.length===0||s==null)){var{data:m}=l,g;if(m&&m.length>0?g=m:g=d==null?void 0:d.slice(u,p+1),g!=null)return Jhe({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:i,dataStartIndex:u,areaSettings:l,stackedData:a,displayedData:g,chartBaseValue:c,bandSize:s})}})});function Fb(){return Fb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fb.apply(null,arguments)}function Zhe(e,t){if(e==null)return{};var r,n,i=lqe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function lqe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Qhe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Vw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Qhe(Object(r),!0).forEach(function(n){cqe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qhe(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cqe(e,t,r){return(t=dqe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dqe(e){var t=uqe(e,"string");return typeof t=="symbol"?t:t+""}function uqe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vF(e,t){return e&&e!=="none"?e:t}function fqe(e){var{clipPathId:t,points:r,props:n}=e,{needClip:i,dot:a,dataKey:o}=n,s=mn(n);return fr.createElement($w,{points:r,dot:a,className:"recharts-area-dots",dotClassName:"recharts-area-dot",dataKey:o,baseProps:s,needClip:i,clipPathId:t})}function gqe(e){var{showLabels:t,children:r,points:n}=e,i=n.map(a=>{var o,s,l={x:(o=a.x)!==null&&o!==void 0?o:0,y:(s=a.y)!==null&&s!==void 0?s:0,width:0,lowerWidth:0,upperWidth:0,height:0};return Vw(Vw({},l),{},{value:a.value,payload:a.payload,parentViewBox:void 0,viewBox:l,fill:void 0})});return fr.createElement(Wh,{value:t?i:void 0},r)}function Xhe(e){var{points:t,baseLine:r,needClip:n,clipPathId:i,props:a}=e,{layout:o,type:s,stroke:l,connectNulls:c,isRange:d}=a,{id:u}=a,p=Zhe(a,oqe),m=mn(p),g=nn(p);return fr.createElement(fr.Fragment,null,(t==null?void 0:t.length)>1&&fr.createElement(Yr,{clipPath:n?"url(#clipPath-".concat(i,")"):void 0},fr.createElement(Sh,Fb({},g,{id:u,points:t,connectNulls:c,type:s,baseLine:r,layout:o,stroke:"none",className:"recharts-area-area"})),l!=="none"&&fr.createElement(Sh,Fb({},m,{className:"recharts-area-curve",layout:o,type:s,connectNulls:c,fill:"none",points:t})),l!=="none"&&d&&fr.createElement(Sh,Fb({},m,{className:"recharts-area-curve",layout:o,type:s,connectNulls:c,fill:"none",points:r}))),fr.createElement(fqe,{points:t,props:p,clipPathId:i}))}function hqe(e){var t,r,{alpha:n,baseLine:i,points:a,strokeWidth:o}=e,s=(t=a[0])===null||t===void 0?void 0:t.y,l=(r=a[a.length-1])===null||r===void 0?void 0:r.y;if(!Lr(s)||!Lr(l))return null;var c=n*Math.abs(s-l),d=Math.max(...a.map(u=>u.x||0));return at(i)?d=Math.max(i,d):i&&Array.isArray(i)&&i.length&&(d=Math.max(...i.map(u=>u.x||0),d)),at(d)?fr.createElement("rect",{x:0,y:s<l?s:s-c,width:d+(o?parseInt("".concat(o),10):1),height:Math.floor(c)}):null}function vqe(e){var t,r,{alpha:n,baseLine:i,points:a,strokeWidth:o}=e,s=(t=a[0])===null||t===void 0?void 0:t.x,l=(r=a[a.length-1])===null||r===void 0?void 0:r.x;if(!Lr(s)||!Lr(l))return null;var c=n*Math.abs(s-l),d=Math.max(...a.map(u=>u.y||0));return at(i)?d=Math.max(i,d):i&&Array.isArray(i)&&i.length&&(d=Math.max(...i.map(u=>u.y||0),d)),at(d)?fr.createElement("rect",{x:s<l?s:s-c,y:0,width:c,height:Math.floor(d+(o?parseInt("".concat(o),10):1))}):null}function yqe(e){var{alpha:t,layout:r,points:n,baseLine:i,strokeWidth:a}=e;return r==="vertical"?fr.createElement(hqe,{alpha:t,points:n,baseLine:i,strokeWidth:a}):fr.createElement(vqe,{alpha:t,points:n,baseLine:i,strokeWidth:a})}function bqe(e){var{needClip:t,clipPathId:r,props:n,previousPointsRef:i,previousBaselineRef:a}=e,{points:o,baseLine:s,isAnimationActive:l,animationBegin:c,animationDuration:d,animationEasing:u,onAnimationStart:p,onAnimationEnd:m}=n,g=(0,du.useMemo)(()=>({points:o,baseLine:s}),[o,s]),f=Vd(g,"recharts-area-"),v=Roe(),[h,y]=(0,du.useState)(!1),b=!h,k=(0,du.useCallback)(()=>{typeof m=="function"&&m(),y(!1)},[m]),x=(0,du.useCallback)(()=>{typeof p=="function"&&p(),y(!0)},[p]);if(v==null)return null;var S=i.current,w=a.current;return fr.createElement(gqe,{showLabels:b,points:o},n.children,fr.createElement(qd,{animationId:f,begin:c,duration:d,isActive:l,easing:u,onAnimationEnd:k,onAnimationStart:x,key:f},C=>{if(S){var D=S.length/o.length,P=C===1?o:o.map((z,A)=>{var I=Math.floor(A*D);if(S[I]){var L=S[I];return Vw(Vw({},z),{},{x:Kr(L.x,z.x,C),y:Kr(L.y,z.y,C)})}return z}),M;return at(s)?M=Kr(w,s,C):Or(s)||Ga(s)?M=Kr(w,0,C):M=s.map((z,A)=>{var I=Math.floor(A*D);if(Array.isArray(w)&&w[I]){var L=w[I];return Vw(Vw({},z),{},{x:Kr(L.x,z.x,C),y:Kr(L.y,z.y,C)})}return z}),C>0&&(i.current=P,a.current=M),fr.createElement(Xhe,{points:P,baseLine:M,needClip:t,clipPathId:r,props:n})}return C>0&&(i.current=o,a.current=s),fr.createElement(Yr,null,l&&fr.createElement("defs",null,fr.createElement("clipPath",{id:"animationClipPath-".concat(r)},fr.createElement(yqe,{alpha:C,points:o,baseLine:s,layout:v,strokeWidth:n.strokeWidth}))),fr.createElement(Yr,{clipPath:"url(#animationClipPath-".concat(r,")")},fr.createElement(Xhe,{points:o,baseLine:s,needClip:t,clipPathId:r,props:n})))}),fr.createElement($h,{label:n.label}))}function xqe(e){var{needClip:t,clipPathId:r,props:n}=e,i=(0,du.useRef)(null),a=(0,du.useRef)();return fr.createElement(bqe,{needClip:t,clipPathId:r,props:n,previousPointsRef:i,previousBaselineRef:a})}function wqe(e){var t,r=pr(e,eve),{activeDot:n,animationBegin:i,animationDuration:a,animationEasing:o,connectNulls:s,dot:l,fill:c,fillOpacity:d,hide:u,isAnimationActive:p,legendType:m,stroke:g,xAxisId:f,yAxisId:v}=r,h=Zhe(r,sqe),y=xc(),b=g2(),{needClip:k}=Nb(f,v),x=Qr(),{points:S,isRange:w,baseLine:C}=(t=je(I=>Yhe(I,e.id,x)))!==null&&t!==void 0?t:{},D=Vh();if(y!=="horizontal"&&y!=="vertical"||D==null||b!=="AreaChart"&&b!=="ComposedChart")return null;var{height:P,width:M,x:z,y:A}=D;return!S||!S.length?null:fr.createElement(rH,Fb({},h,{activeDot:n,animationBegin:i,animationDuration:a,animationEasing:o,baseLine:C,connectNulls:s,dot:l,fill:c,fillOpacity:d,height:P,hide:u,layout:y,isAnimationActive:p==="auto"?!Hd.isSsr:p,isRange:w,legendType:m,needClip:k,points:S,stroke:g,width:M,left:z,top:A,xAxisId:f,yAxisId:v}))}function Jhe(e){var{areaSettings:{connectNulls:t,baseValue:r,dataKey:n},stackedData:i,layout:a,chartBaseValue:o,xAxis:s,yAxis:l,displayedData:c,dataStartIndex:d,xAxisTicks:u,yAxisTicks:p,bandSize:m}=e,g=i&&i.length,f=kqe(a,o,r,s,l),v=a==="horizontal",h=!1,y=c.map((k,x)=>{var S,w,C;if(g)C=i[d+x];else{var D=fn(k,n);Array.isArray(D)?(C=D,h=!0):C=[f,D]}var P=(S=(w=C)===null||w===void 0?void 0:w[1])!==null&&S!==void 0?S:null,M=P==null||g&&!t&&fn(k,n)==null;return v?{x:V0({axis:s,ticks:u,bandSize:m,entry:k,index:x}),y:M?null:l.scale(P),value:C,payload:k}:{x:M?null:s.scale(P),y:V0({axis:l,ticks:p,bandSize:m,entry:k,index:x}),value:C,payload:k}}),b;return g||h?b=y.map(k=>{var x=Array.isArray(k.value)?k.value[0]:null;return v?{x:k.x,y:x!=null&&k.y!=null?l.scale(x):null,payload:k.payload}:{x:x!=null?s.scale(x):null,y:k.y,payload:k.payload}}):b=v?l.scale(f):s.scale(f),{points:y,baseLine:b,isRange:h}}function Sqe(e){var t=pr(e,eve),r=Qr();return fr.createElement(Hh,{id:t.id,type:"area"},n=>fr.createElement(fr.Fragment,null,fr.createElement(Bw,{legendPayload:pqe(t)}),fr.createElement(mqe,{dataKey:t.dataKey,data:t.data,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:n}),fr.createElement(Ww,{type:"area",id:n,data:t.data,dataKey:t.dataKey,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,stackId:pL(t.stackId),hide:t.hide,barSize:void 0,baseValue:t.baseValue,isPanorama:r,connectNulls:t.connectNulls}),fr.createElement(wqe,Fb({},t,{id:n}))))}var fr,du,oqe,sqe,pqe,mqe,rH,eve,kqe,np,tH=F(()=>{fr=Y(Q()),du=Y(Q());Zn();PL();bc();jC();tF();Zy();wr();Ja();RC();nF();GC();gF();Khe();hs();xi();Pb();YC();Jr();rb();ma();Rl();Rw();KC();JC();js();tb();YU();_s();hl();ys();qw();oqe=["id"],sqe=["activeDot","animationBegin","animationDuration","animationEasing","connectNulls","dot","fill","fillOpacity","hide","isAnimationActive","legendType","stroke","xAxisId","yAxisId"];pqe=e=>{var{dataKey:t,name:r,stroke:n,fill:i,legendType:a,hide:o}=e;return[{inactive:o,dataKey:t,type:a,color:vF(n,i),value:Rd(r,t),payload:e}]},mqe=fr.memo(e=>{var{dataKey:t,data:r,stroke:n,strokeWidth:i,fill:a,name:o,hide:s,unit:l,tooltipType:c,id:d}=e,u={dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:i,fill:a,dataKey:t,nameKey:void 0,name:Rd(o,t),hide:s,type:c,color:vF(n,a),unit:l,graphicalItemId:d}};return fr.createElement(Rh,{tooltipEntrySettings:u})});rH=class extends du.PureComponent{render(){var{hide:t,dot:r,points:n,className:i,top:a,left:o,needClip:s,xAxisId:l,yAxisId:c,width:d,height:u,id:p,baseLine:m,zIndex:g}=this.props;if(t)return null;var f=wt("recharts-area",i),v=p,{r:h,strokeWidth:y}=hF(r),b=_w(r),k=h*2+y,x=s?"url(#clipPath-".concat(b?"":"dots-").concat(v,")"):void 0;return fr.createElement(Fn,{zIndex:g},fr.createElement(Yr,{className:f},s&&fr.createElement("defs",null,fr.createElement(Hw,{clipPathId:v,xAxisId:l,yAxisId:c}),!b&&fr.createElement("clipPath",{id:"clipPath-dots-".concat(v)},fr.createElement("rect",{x:o-k/2,y:a-k/2,width:d+k,height:u+k}))),fr.createElement(xqe,{needClip:s,clipPathId:v,props:this.props})),fr.createElement(Ib,{points:n,mainColor:vF(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot,clipPath:x}),this.props.isRange&&Array.isArray(m)&&fr.createElement(Ib,{points:m,mainColor:vF(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot,clipPath:x}))}},eve={activeDot:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!1,fill:"#3182bd",fillOpacity:.6,hide:!1,isAnimationActive:"auto",legendType:"line",stroke:"#3182bd",strokeWidth:1,type:"linear",label:!1,xAxisId:0,yAxisId:0,zIndex:zr.area};kqe=(e,t,r,n,i)=>{var a=r!=null?r:t;if(at(a))return a;var o=e==="horizontal"?i:n,s=o.scale.domain();if(o.type==="number"){var l=Math.max(s[0],s[1]),c=Math.min(s[0],s[1]);return a==="dataMin"?c:a==="dataMax"||l<0?l:Math.max(Math.min(s[0],s[1]),0)}return a==="dataMin"?s[0]:a==="dataMax"?s[1]:s[0]};np=fr.memo(Sqe,um);np.displayName="Area"});function tve(e,t){if(!e){if(Tqe)throw new Error(nH);var r=typeof t=="function"?t():t,n=r?"".concat(nH,": ").concat(r):nH;throw new Error(n)}}var Tqe,nH,rve=F(()=>{Tqe=!0,nH="Invariant failed"});function iH(){return iH=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},iH.apply(null,arguments)}function sP(e){return nve.createElement(Q2,iH({shapeType:"rectangle",activeClassName:"recharts-active-bar"},e))}var nve,ive,ave=F(()=>{nve=Y(Q());rve();CU();wr();ive=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,i)=>{if(at(t))return t;var a=at(n)||Or(n);return a?t(n,i):(a||tve(!1,"minPointSize callback function received a value with type of ".concat(typeof n,". Currently only numbers or null/undefined are supported.")),r)}}});var Cqe,Pqe,lP,Dqe,Eqe,Iqe,Mqe,Aqe,Lqe,Nqe,ove,Fqe,Oqe,zqe,jqe,_qe,Bqe,Wqe,sve,lve=F(()=>{Ka();Vl();wr();Ja();aH();xi();Of();Ud();Mh();Age();Fge();zge();eH();Cqe=(e,t,r)=>r,Pqe=(e,t)=>t,lP=de([Fh,Pqe],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),Dqe=de([lP],e=>e==null?void 0:e.maxBarSize),Eqe=(e,t,r,n)=>n,Iqe=de([Jt,Fh,lu,cu,Cqe],(e,t,r,n,i)=>t.filter(a=>e==="horizontal"?a.xAxisId===r:a.yAxisId===n).filter(a=>a.isPanorama===i).filter(a=>a.hide===!1).filter(a=>a.type==="bar")),Mqe=(e,t,r)=>{var n=Jt(e),i=lu(e,t),a=cu(e,t);if(!(i==null||a==null))return n==="horizontal"?kw(e,"yAxis",a,r):kw(e,"xAxis",i,r)},Aqe=(e,t)=>{var r=Jt(e),n=lu(e,t),i=cu(e,t);if(!(n==null||i==null))return r==="horizontal"?b8(e,"xAxis",n):b8(e,"yAxis",i)},Lqe=de([Iqe,tue,Aqe],Mge),Nqe=(e,t,r)=>{var n,i,a=lP(e,t);if(a!=null){var o=lu(e,t),s=cu(e,t);if(!(o==null||s==null)){var l=Jt(e),c=$3(e),{maxBarSize:d}=a,u=Or(d)?c:d,p,m;return l==="horizontal"?(p=id(e,"xAxis",o,r),m=nd(e,"xAxis",o,r)):(p=id(e,"yAxis",s,r),m=nd(e,"yAxis",s,r)),(n=(i=Ul(p,m,!0))!==null&&i!==void 0?i:u)!==null&&n!==void 0?n:0}}},ove=(e,t,r)=>{var n=Jt(e),i=lu(e,t),a=cu(e,t);if(!(i==null||a==null)){var o,s;return n==="horizontal"?(o=id(e,"xAxis",i,r),s=nd(e,"xAxis",i,r)):(o=id(e,"yAxis",a,r),s=nd(e,"yAxis",a,r)),Ul(o,s)}},Fqe=de([Lqe,$3,eue,NN,Nqe,ove,Dqe],Nge),Oqe=(e,t,r)=>{var n=lu(e,t);if(n!=null)return id(e,"xAxis",n,r)},zqe=(e,t,r)=>{var n=cu(e,t);if(n!=null)return id(e,"yAxis",n,r)},jqe=(e,t,r)=>{var n=lu(e,t);if(n!=null)return nd(e,"xAxis",n,r)},_qe=(e,t,r)=>{var n=cu(e,t);if(n!=null)return nd(e,"yAxis",n,r)},Bqe=de([Fqe,lP],(e,t)=>{if(!(e==null||t==null)){var r=e.find(n=>n.stackId===t.stackId&&t.dataKey!=null&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),Wqe=de([Mqe,lP],Oge),sve=de([ji,K0,Oqe,zqe,jqe,_qe,Bqe,Jt,EN,ove,Wqe,lP,Eqe],(e,t,r,n,i,a,o,s,l,c,d,u,p)=>{var{chartData:m,dataStartIndex:g,dataEndIndex:f}=l;if(!(u==null||o==null||t==null||s!=="horizontal"&&s!=="vertical"||r==null||n==null||i==null||a==null||c==null)){var{data:v}=u,h;if(v!=null&&v.length>0?h=v:h=m==null?void 0:m.slice(g,f+1),h!=null)return cve({layout:s,barSettings:u,pos:o,parentViewBox:t,bandSize:c,xAxis:r,yAxis:n,xAxisTicks:i,yAxisTicks:a,stackedData:d,displayedData:h,offset:e,cells:p,dataStartIndex:g})}})});function oH(){return oH=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},oH.apply(null,arguments)}function Rqe(e,t){if(e==null)return{};var r,n,i=Uqe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Uqe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var sH,Gw,$qe,dve,uve,Hqe,qqe,pve,mve=F(()=>{sH=Y(Q()),Gw=Y(Q());Ja();bc();$qe=["index"];dve=(0,Gw.createContext)(void 0),uve=e=>{var t=(0,Gw.useContext)(dve);if(t!=null)return t.stackId;if(e!=null)return pL(e)},Hqe=(e,t)=>"recharts-bar-stack-clip-path-".concat(e,"-").concat(t),qqe=e=>{var t=(0,Gw.useContext)(dve);if(t!=null){var{stackId:r}=t;return"url(#".concat(Hqe(r,e),")")}},pve=e=>{var{index:t}=e,r=Rqe(e,$qe),n=qqe(t);return sH.createElement(Yr,oH({className:"recharts-bar-stack-layer",clipPath:n},r))}});function Yf(){return Yf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Yf.apply(null,arguments)}function fve(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Jl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fve(Object(r),!0).forEach(function(n){Jqe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fve(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Jqe(e,t,r){return(t=Qqe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qqe(e){var t=Xqe(e,"string");return typeof t=="symbol"?t:t+""}function Xqe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yF(e,t){if(e==null)return{};var r,n,i=Zqe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Zqe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function rVe(e){var t=je(lm),{data:r,dataKey:n,background:i,allOtherBarProps:a}=e,{onMouseEnter:o,onMouseLeave:s,onClick:l}=a,c=yF(a,Vqe),d=PU(o,n,a.id),u=DU(s),p=EU(l,n,a.id);if(!i||r==null)return null;var m=yc(i);return Ur.createElement(Fn,{zIndex:jge(i,zr.barBackground)},r.map((g,f)=>{var{value:v,background:h,tooltipPosition:y}=g,b=yF(g,Gqe);if(!h)return null;var k=d(g,f),x=u(g,f),S=p(g,f),w=Jl(Jl(Jl(Jl(Jl({option:i,isActive:String(f)===t},b),{},{fill:"#eee"},h),m),Hu(c,g,f)),{},{onMouseEnter:k,onMouseLeave:x,onClick:S,dataKey:n,index:f,className:"recharts-bar-background-rectangle"});return Ur.createElement(sP,Yf({key:"background-bar-".concat(f)},w))}))}function nVe(e){var{showLabels:t,children:r,rects:n}=e,i=n==null?void 0:n.map(a=>{var o={x:a.x,y:a.y,width:a.width,lowerWidth:a.width,upperWidth:a.width,height:a.height};return Jl(Jl({},o),{},{value:a.value,payload:a.payload,parentViewBox:a.parentViewBox,viewBox:o,fill:a.fill})});return Ur.createElement(Wh,{value:t?i:void 0},r)}function iVe(e){var{shape:t,activeBar:r,baseProps:n,entry:i,index:a,dataKey:o}=e,s=je(lm),l=je(f2),c=r&&String(a)===s&&(l==null||o===l),d=c?r:t;return c?Ur.createElement(Fn,{zIndex:zr.activeBar},Ur.createElement(sP,Yf({},n,{name:String(n.name)},i,{isActive:c,option:d,index:a,dataKey:o}))):Ur.createElement(sP,Yf({},n,{name:String(n.name)},i,{isActive:c,option:d,index:a,dataKey:o}))}function aVe(e){var{shape:t,baseProps:r,entry:n,index:i,dataKey:a}=e;return Ur.createElement(sP,Yf({},r,{name:String(r.name)},n,{isActive:!1,option:t,index:i,dataKey:a}))}function oVe(e){var t,{data:r,props:n}=e,i=(t=mn(n))!==null&&t!==void 0?t:{},{id:a}=i,o=yF(i,Yqe),{shape:s,dataKey:l,activeBar:c}=n,{onMouseEnter:d,onClick:u,onMouseLeave:p}=n,m=yF(n,Kqe),g=PU(d,l,a),f=DU(p),v=EU(u,l,a);return r?Ur.createElement(Ur.Fragment,null,r.map((h,y)=>Ur.createElement(pve,Yf({index:y,key:"rectangle-".concat(h==null?void 0:h.x,"-").concat(h==null?void 0:h.y,"-").concat(h==null?void 0:h.value,"-").concat(y),className:"recharts-bar-rectangle"},Hu(m,h,y),{onMouseEnter:g(h,y),onMouseLeave:f(h,y),onClick:v(h,y)}),c?Ur.createElement(iVe,{shape:s,activeBar:c,baseProps:o,entry:h,index:y,dataKey:l}):Ur.createElement(aVe,{shape:s,baseProps:o,entry:h,index:y,dataKey:l})))):null}function sVe(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:i,isAnimationActive:a,animationBegin:o,animationDuration:s,animationEasing:l,onAnimationEnd:c,onAnimationStart:d}=t,u=r.current,p=Vd(t,"recharts-bar-"),[m,g]=(0,Kf.useState)(!1),f=!m,v=(0,Kf.useCallback)(()=>{typeof c=="function"&&c(),g(!1)},[c]),h=(0,Kf.useCallback)(()=>{typeof d=="function"&&d(),g(!0)},[d]);return Ur.createElement(nVe,{showLabels:f,rects:n},Ur.createElement(qd,{animationId:p,begin:o,duration:s,isActive:a,easing:l,onAnimationEnd:v,onAnimationStart:h,key:p},y=>{var b=y===1?n:n==null?void 0:n.map((k,x)=>{var S=u&&u[x];if(S)return Jl(Jl({},k),{},{x:Kr(S.x,k.x,y),y:Kr(S.y,k.y,y),width:Kr(S.width,k.width,y),height:Kr(S.height,k.height,y)});if(i==="horizontal"){var w=Kr(0,k.height,y),C=Kr(k.stackedBarStart,k.y,y);return Jl(Jl({},k),{},{y:C,height:w})}var D=Kr(0,k.width,y),P=Kr(k.stackedBarStart,k.x,y);return Jl(Jl({},k),{},{width:D,x:P})});return y>0&&(r.current=b!=null?b:null),b==null?null:Ur.createElement(Yr,null,Ur.createElement(oVe,{props:t,data:b}))}),Ur.createElement($h,{label:t.label}),t.children)}function lVe(e){var t=(0,Kf.useRef)(null);return Ur.createElement(sVe,{previousRectanglesRef:t,props:e})}function uVe(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:i,minPointSize:a,activeBar:o,animationBegin:s,animationDuration:l,animationEasing:c,isAnimationActive:d}=e,{needClip:u}=Nb(t,r),p=xc(),m=Qr(),g=Sfe(e.children,Z8),f=je(y=>sve(y,e.id,m,g));if(p!=="vertical"&&p!=="horizontal")return null;var v,h=f==null?void 0:f[0];return h==null||h.height==null||h.width==null?v=0:v=p==="vertical"?h.height/2:h.width/2,Ur.createElement(fF,{xAxisId:t,yAxisId:r,data:f,dataPointFormatter:cVe,errorBarOffset:v},Ur.createElement(lH,Yf({},e,{layout:p,needClip:u,data:f,xAxisId:t,yAxisId:r,hide:n,legendType:i,minPointSize:a,activeBar:o,animationBegin:s,animationDuration:l,animationEasing:c,isAnimationActive:d})))}function cve(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:i,bandSize:a,xAxis:o,yAxis:s,xAxisTicks:l,yAxisTicks:c,stackedData:d,displayedData:u,offset:p,cells:m,parentViewBox:g,dataStartIndex:f}=e,v=t==="horizontal"?s:o,h=d?v.scale.domain():null,y=Moe({numericAxis:v}),b=v.scale(y);return u.map((k,x)=>{var S,w,C,D,P,M;if(d){var z=d[x+f];if(z==null)return null;S=Eoe(z,h)}else S=fn(k,r),Array.isArray(S)||(S=[y,S]);var A=ive(n,gve)(S[1],x);if(t==="horizontal"){var I,[L,E]=[s.scale(S[0]),s.scale(S[1])];w=r6({axis:o,ticks:l,bandSize:a,offset:i.offset,entry:k,index:x}),C=(I=E!=null?E:L)!==null&&I!==void 0?I:void 0,D=i.size;var T=L-E;if(P=Ga(T)?0:T,M={x:w,y:p.top,width:D,height:p.height},Math.abs(A)>0&&Math.abs(P)<Math.abs(A)){var $=Va(P||A)*(Math.abs(A)-Math.abs(P));C-=$,P+=$}}else{var[_,B]=[o.scale(S[0]),o.scale(S[1])];if(w=_,C=r6({axis:s,ticks:c,bandSize:a,offset:i.offset,entry:k,index:x}),D=B-_,P=i.size,M={x:p.left,y:C,width:p.width,height:P},Math.abs(A)>0&&Math.abs(D)<Math.abs(A)){var W=Va(D||A)*(Math.abs(A)-Math.abs(D));D+=W}}if(w==null||C==null||D==null||P==null)return null;var N=Jl(Jl({},k),{},{stackedBarStart:b,x:w,y:C,width:D,height:P,value:d?S:S[1],payload:k,background:M,tooltipPosition:{x:w+D/2,y:C+P/2},parentViewBox:g},m&&m[x]&&m[x].props);return N}).filter(Boolean)}function pVe(e){var t=pr(e,dVe),r=uve(t.stackId),n=Qr();return Ur.createElement(Hh,{id:t.id,type:"bar"},i=>Ur.createElement(Ur.Fragment,null,Ur.createElement(Bw,{legendPayload:eVe(t)}),Ur.createElement(tVe,{dataKey:t.dataKey,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:i}),Ur.createElement(Ww,{type:"bar",id:i,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:r,hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:n}),Ur.createElement(Fn,{zIndex:t.zIndex},Ur.createElement(uVe,Yf({},t,{id:i})))))}var Ur,Kf,Vqe,Gqe,Yqe,Kqe,eVe,tVe,gve,cVe,lH,dVe,Yh,aH=F(()=>{Ur=Y(Q()),Kf=Y(Q());Zn();bc();qpe();jC();wr();RC();Ja();qu();ave();Wfe();GC();qU();gF();xi();lve();Jr();hs();ep();YC();rb();ma();KC();JC();js();tb();hl();ys();_ge();qw();mve();Vqe=["onMouseEnter","onMouseLeave","onClick"],Gqe=["value","background","tooltipPosition"],Yqe=["id"],Kqe=["onMouseEnter","onClick","onMouseLeave"];eVe=e=>{var{dataKey:t,name:r,fill:n,legendType:i,hide:a}=e;return[{inactive:a,dataKey:t,type:i,color:n,value:Rd(r,t),payload:e}]},tVe=Ur.memo(e=>{var{dataKey:t,stroke:r,strokeWidth:n,fill:i,name:a,hide:o,unit:s,tooltipType:l,id:c}=e,d={dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:i,dataKey:t,nameKey:void 0,name:Rd(a,t),hide:o,type:l,color:i,unit:s,graphicalItemId:c}};return Ur.createElement(Rh,{tooltipEntrySettings:d})});gve=0,cVe=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:fn(e,t)}},lH=class extends Kf.PureComponent{render(){var{hide:t,data:r,dataKey:n,className:i,xAxisId:a,yAxisId:o,needClip:s,background:l,id:c}=this.props;if(t||r==null)return null;var d=wt("recharts-bar",i),u=c;return Ur.createElement(Yr,{className:d,id:c},s&&Ur.createElement("defs",null,Ur.createElement(Hw,{clipPathId:u,xAxisId:a,yAxisId:o})),Ur.createElement(Yr,{className:"recharts-bar-rectangles",clipPath:s?"url(#clipPath-".concat(u,")"):void 0},Ur.createElement(rVe,{data:r,dataKey:n,background:l,allOtherBarProps:this.props}),Ur.createElement(lVe,this.props)))}},dVe={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:gve,xAxisId:0,yAxisId:0,zIndex:zr.bar};Yh=Ur.memo(pVe,um);Yh.displayName="Bar"});function hve(e,t){if(e==null)return{};var r,n,i=gVe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function gVe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function vve(e,t){return e===t?!0:Array.isArray(e)&&e.length===2&&Array.isArray(t)&&t.length===2?e[0]===t[0]&&e[1]===t[1]:!1}function bF(e,t){if(e===t)return!0;var{domain:r,range:n}=e,i=hve(e,mVe),{domain:a,range:o}=t,s=hve(t,fVe);return!vve(r,a)||!vve(n,o)?!1:um(i,s)}var mVe,fVe,cH=F(()=>{qw();mVe=["domain","range"],fVe=["domain","range"]});function dH(){return dH=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dH.apply(null,arguments)}function yve(e,t){if(e==null)return{};var r,n,i=yVe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function yVe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function bVe(e){var t=lr(),r=(0,cP.useRef)(null);return(0,cP.useLayoutEffect)(()=>{r.current===null?t(age(e)):r.current!==e&&t(oge({prev:r.current,next:e})),r.current=e},[e,t]),(0,cP.useLayoutEffect)(()=>()=>{r.current&&(t(sge(r.current)),r.current=null)},[t]),null}var Jf,cP,hVe,vVe,xVe,wVe,kVe,jo,bve=F(()=>{Jf=Y(Q()),cP=Y(Q());Zn();pF();Jr();XC();Vl();Ud();hs();ma();cH();hVe=["dangerouslySetInnerHTML","ticks","scale"],vVe=["id","scale"];xVe=e=>{var{xAxisId:t,className:r}=e,n=je(K0),i=Qr(),a="xAxis",o=je(h=>XN(h,a,t,i)),s=je(h=>v8(h,t)),l=je(h=>hue(h,t)),c=je(h=>e8(h,t));if(s==null||l==null||c==null)return null;var{dangerouslySetInnerHTML:d,ticks:u,scale:p}=e,m=yve(e,hVe),{id:g,scale:f}=c,v=yve(c,vVe);return Jf.createElement(nP,dH({},m,v,{x:l.x,y:l.y,width:s.width,height:s.height,className:wt("recharts-".concat(a," ").concat(a),r),viewBox:n,ticks:o,axisType:a}))},wVe={allowDataOverflow:No.allowDataOverflow,allowDecimals:No.allowDecimals,allowDuplicatedCategory:No.allowDuplicatedCategory,angle:No.angle,axisLine:ou.axisLine,height:No.height,hide:!1,includeHidden:No.includeHidden,interval:No.interval,minTickGap:No.minTickGap,mirror:No.mirror,orientation:No.orientation,padding:No.padding,reversed:No.reversed,scale:No.scale,tick:No.tick,tickCount:No.tickCount,tickLine:ou.tickLine,tickSize:ou.tickSize,type:No.type,xAxisId:0},kVe=e=>{var t=pr(e,wVe);return Jf.createElement(Jf.Fragment,null,Jf.createElement(bVe,{allowDataOverflow:t.allowDataOverflow,allowDecimals:t.allowDecimals,allowDuplicatedCategory:t.allowDuplicatedCategory,angle:t.angle,dataKey:t.dataKey,domain:t.domain,height:t.height,hide:t.hide,id:t.xAxisId,includeHidden:t.includeHidden,interval:t.interval,minTickGap:t.minTickGap,mirror:t.mirror,name:t.name,orientation:t.orientation,padding:t.padding,reversed:t.reversed,scale:t.scale,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit}),Jf.createElement(xVe,t))},jo=Jf.memo(kVe,bF);jo.displayName="XAxis"});function uH(){return uH=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uH.apply(null,arguments)}function xve(e,t){if(e==null)return{};var r,n,i=CVe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function CVe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function PVe(e){var t=lr(),r=(0,mm.useRef)(null);return(0,mm.useLayoutEffect)(()=>{r.current===null?t(lge(e)):r.current!==e&&t(cge({prev:r.current,next:e})),r.current=e},[e,t]),(0,mm.useLayoutEffect)(()=>()=>{r.current&&(t(dge(r.current)),r.current=null)},[t]),null}var Qf,mm,SVe,TVe,DVe,EVe,IVe,_o,wve=F(()=>{Qf=Y(Q()),mm=Y(Q());Zn();pF();XC();Jr();Vl();Ud();hs();Nw();ma();cH();SVe=["dangerouslySetInnerHTML","ticks","scale"],TVe=["id","scale"];DVe=e=>{var{yAxisId:t,className:r,width:n,label:i}=e,a=(0,mm.useRef)(null),o=(0,mm.useRef)(null),s=je(K0),l=Qr(),c=lr(),d="yAxis",u=je(S=>y8(S,t)),p=je(S=>vue(S,t)),m=je(S=>XN(S,d,t,l)),g=je(S=>t8(S,t));if((0,mm.useLayoutEffect)(()=>{if(!(n!=="auto"||!u||zC(i)||(0,mm.isValidElement)(i)||g==null)){var S=a.current;if(S){var w=S.getCalculatedWidth();Math.round(u.width)!==Math.round(w)&&c(uge({id:t,width:w}))}}},[m,u,c,i,t,n,g]),u==null||p==null||g==null)return null;var{dangerouslySetInnerHTML:f,ticks:v,scale:h}=e,y=xve(e,SVe),{id:b,scale:k}=g,x=xve(g,TVe);return Qf.createElement(nP,uH({},y,x,{ref:a,labelRef:o,x:p.x,y:p.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:u.width,height:u.height,className:wt("recharts-".concat(d," ").concat(d),r),viewBox:s,ticks:m,axisType:d}))},EVe={allowDataOverflow:Fo.allowDataOverflow,allowDecimals:Fo.allowDecimals,allowDuplicatedCategory:Fo.allowDuplicatedCategory,angle:Fo.angle,axisLine:ou.axisLine,hide:!1,includeHidden:Fo.includeHidden,interval:Fo.interval,minTickGap:Fo.minTickGap,mirror:Fo.mirror,orientation:Fo.orientation,padding:Fo.padding,reversed:Fo.reversed,scale:Fo.scale,tick:Fo.tick,tickCount:Fo.tickCount,tickLine:ou.tickLine,tickSize:ou.tickSize,type:Fo.type,width:Fo.width,yAxisId:0},IVe=e=>{var t=pr(e,EVe);return Qf.createElement(Qf.Fragment,null,Qf.createElement(PVe,{interval:t.interval,id:t.yAxisId,scale:t.scale,type:t.type,domain:t.domain,allowDataOverflow:t.allowDataOverflow,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,padding:t.padding,includeHidden:t.includeHidden,reversed:t.reversed,ticks:t.ticks,width:t.width,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:t.angle,minTickGap:t.minTickGap,tick:t.tick,tickFormatter:t.tickFormatter}),Qf.createElement(DVe,t))},_o=Qf.memo(IVe,bF);_o.displayName="YAxis"});var MVe,dP,pH=F(()=>{Ka();xi();ep();Ud();Pb();zf();UN();MVe=(e,t)=>t,dP=de([MVe,Jt,eu,Qa,O8,kc,Zue,ji],ape)});var uP,mH=F(()=>{uP=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}}});var fH,gH,wF,hH,xF,vH=F(()=>{Lo();Zu();pH();MC();mH();fH=Jo("mouseClick"),gH=Pf();gH.startListening({actionCreator:fH,effect:(e,t)=>{var r=e.payload,n=dP(t.getState(),uP(r));(n==null?void 0:n.activeIndex)!=null&&t.dispatch(Iue({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});wF=Jo("mouseMove"),hH=Pf(),xF=null;hH.startListening({actionCreator:wF,effect:(e,t)=>{var r=e.payload;xF!==null&&cancelAnimationFrame(xF);var n=uP(r);xF=requestAnimationFrame(()=>{var i=t.getState(),a=IC(i,i.tooltip.settings.shared);if(a==="axis"){var o=dP(i,n);(o==null?void 0:o.activeIndex)!=null?t.dispatch(r2({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate})):t.dispatch(t2())}xF=null})}})});function kve(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":e==="children"&&typeof t=="object"&&t!==null?"<<CHILDREN>>":t}var Sve=F(()=>{});var Tve,Cve,Pve,Dve,yH=F(()=>{Lo();Tve={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},Cve=Pi({name:"rootProps",initialState:Tve,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:Tve.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className,e.baseValue=t.payload.baseValue,e.reverseStackOrder=t.payload.reverseStackOrder}}}),Pve=Cve.reducer,{updateOptions:Dve}=Cve.actions});var Eve,Ive,Mve,bH=F(()=>{Lo();Eve=Pi({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:Ive}=Eve.actions,Mve=Eve.reducer});var xH,wH,kF,kH=F(()=>{Lo();Zu();ep();Pb();Vl();s2();xH=Jo("keyDown"),wH=Jo("focus"),kF=Pf();kF.startListening({actionCreator:xH,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip,a=e.payload;if(!(a!=="ArrowRight"&&a!=="ArrowLeft"&&a!=="Enter")){var o=Dw(i,jh(r),Oh(r),Cb(r)),s=o==null?-1:Number(o);if(!(!Number.isFinite(s)||s<0)){var l=kc(r);if(a==="Enter"){var c=LC(r,"axis","hover",String(i.index));t.dispatch(i2({active:!i.active,activeIndex:i.index,activeCoordinate:c}));return}var d=yue(r),u=d==="left-to-right"?1:-1,p=a==="ArrowRight"?1:-1,m=s+p*u;if(!(l==null||m>=l.length||m<0)){var g=LC(r,"axis","hover",String(m));t.dispatch(i2({active:!0,activeIndex:m.toString(),activeCoordinate:g}))}}}}}});kF.startListening({actionCreator:wH,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip;if(!i.active&&i.index==null){var a="0",o=LC(r,"axis","hover",String(a));t.dispatch(i2({active:!0,activeIndex:a,activeCoordinate:o}))}}}})});var ad,TH,SH,CH=F(()=>{Lo();ep();ad=Jo("externalEvent"),TH=Pf(),SH=new Map;TH.startListening({actionCreator:ad,effect:(e,t)=>{var{handler:r,reactEvent:n}=e.payload;if(r!=null){n.persist();var i=n.type,a=SH.get(i);a!==void 0&&cancelAnimationFrame(a);var o=requestAnimationFrame(()=>{try{var s=t.getState(),l={activeCoordinate:Bue(s),activeDataKey:f2(s),activeIndex:lm(s),activeLabel:m2(s),activeTooltipIndex:lm(s),isTooltipActive:Wue(s)};r(l,n)}finally{SH.delete(i)}});SH.set(i,o)}}})});var AVe,Ave,Lve=F(()=>{Ka();d2();u2();AVe=de([Bf],e=>e.tooltipItemPayloads),Ave=de([AVe,zh,(e,t)=>t,(e,t,r)=>r],(e,t,r,n)=>{var i=e.find(s=>s.settings.graphicalItemId===n);if(i!=null){var{positions:a}=i;if(a!=null){var o=t(a,r);return o}}})});var PH,DH,EH=F(()=>{Lo();Zu();pH();mH();MC();fL();Lve();ep();PH=Jo("touchMove"),DH=Pf();DH.startListening({actionCreator:PH,effect:(e,t)=>{var r=e.payload;if(!(r.touches==null||r.touches.length===0)){var n=t.getState(),i=IC(n,n.tooltip.settings.shared);if(i==="axis"){var a=r.touches[0];if(a==null)return;var o=dP(n,uP({clientX:a.clientX,clientY:a.clientY,currentTarget:r.currentTarget}));(o==null?void 0:o.activeIndex)!=null&&t.dispatch(r2({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate}))}else if(i==="item"){var s,l=r.touches[0];if(document.elementFromPoint==null||l==null)return;var c=document.elementFromPoint(l.clientX,l.clientY);if(!c||!c.getAttribute)return;var d=c.getAttribute(Ooe),u=(s=c.getAttribute(zoe))!==null&&s!==void 0?s:void 0,p=Tb(n).find(f=>f.id===u);if(d==null||p==null||u==null)return;var{dataKey:m}=p,g=Ave(n,d,u);t.dispatch(e2({activeDataKey:m,activeIndex:d,activeCoordinate:g,activeGraphicalItemId:u}))}}}})});var LVe,Nve,Fve=F(()=>{Lo();_h();Zu();k2();B1();vH();Sve();XC();AU();BU();Uge();xL();yH();O2();bH();kH();CH();EH();whe();Zy();h2();LVe=YA({brush:Rge,cartesianAxis:pge,chartData:Ope,errorBars:xhe,graphicalItems:Zfe,layout:woe,legend:Voe,options:Ipe,polarAxis:ife,polarOptions:Mve,referenceElements:Xge,rootProps:Pve,tooltip:Mue,zIndex:gpe}),Nve=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return noe({reducer:LVe,preloadedState:t,middleware:n=>{var i;return n({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((i="es6")!==null&&i!==void 0?i:"")}).concat([gH.middleware,hH.middleware,kF.middleware,TH.middleware,DH.middleware])},enhancers:n=>{var i=n;return typeof n=="function"&&(i=n()),i.concat(KR({type:"raf"}))},devTools:Hd.devToolsEnabled&&{serialize:{replacer:kve},name:"recharts-".concat(r)}})}});function SF(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,i=Qr(),a=(0,zve.useRef)(null);if(i)return r;a.current==null&&(a.current=Nve(t,n));var o=N1;return Ove.createElement(jhe,{context:o,store:a.current},r)}var Ove,zve,IH=F(()=>{Ove=Y(Q()),zve=Y(Q());QU();Fve();hs();wR()});function NVe(e){var{layout:t,margin:r}=e,n=lr(),i=Qr();return(0,TF.useEffect)(()=>{i||(n(yoe(t)),n(XR(r)))},[n,i,t,r]),null}var TF,CF,MH=F(()=>{TF=Y(Q());hs();B1();Jr();qw();CF=(0,TF.memo)(NVe,um)});function PF(e){var t=lr();return(0,jve.useEffect)(()=>{t(Dve(e))},[t,e]),null}var jve,AH=F(()=>{jve=Y(Q());yH();Jr()});function _ve(e){var{zIndex:t,isPanorama:r}=e,n=(0,DF.useRef)(null),i=lr();return(0,DF.useLayoutEffect)(()=>(n.current&&i(mpe({zIndex:t,element:n.current,isPanorama:r})),()=>{i(fpe({zIndex:t,isPanorama:r}))}),[i,t,r]),Ob.createElement("g",{tabIndex:-1,ref:n})}function LH(e){var{children:t,isPanorama:r}=e,n=je(spe);if(!n||n.length===0)return t;var i=n.filter(o=>o<0),a=n.filter(o=>o>0);return Ob.createElement(Ob.Fragment,null,i.map(o=>Ob.createElement(_ve,{key:o,zIndex:o,isPanorama:r})),t,a.map(o=>Ob.createElement(_ve,{key:o,zIndex:o,isPanorama:r})))}var Ob,DF,Bve=F(()=>{Ob=Y(Q()),DF=Y(Q());Jr();h2();q8()});function OVe(e,t){if(e==null)return{};var r,n,i=zVe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function zVe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function EF(){return EF=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},EF.apply(null,arguments)}var zb,NH,FVe,jVe,_Ve,BVe,FH,Wve=F(()=>{zb=Y(Q()),NH=Y(Q());xi();b6();hs();q4();Jr();vL();Rl();Bve();FVe=["children"];jVe={width:"100%",height:"100%",display:"block"},_Ve=(0,NH.forwardRef)((e,t)=>{var r=Q0(),n=X0(),i=TL();if(!Df(r)||!Df(n))return null;var{children:a,otherAttributes:o,title:s,desc:l}=e,c,d;return o!=null&&(typeof o.tabIndex=="number"?c=o.tabIndex:c=i?0:void 0,typeof o.role=="string"?d=o.role:d=i?"application":void 0),zb.createElement(C1,EF({},o,{title:s,desc:l,role:d,tabIndex:c,width:r,height:n,style:jVe,ref:t}),a)}),BVe=e=>{var{children:t}=e,r=je(Xy);if(!r)return null;var{width:n,height:i,y:a,x:o}=r;return zb.createElement(C1,{width:n,height:i,x:o,y:a},t)},FH=(0,NH.forwardRef)((e,t)=>{var{children:r}=e,n=OVe(e,FVe),i=Qr();return i?zb.createElement(BVe,null,zb.createElement(LH,{isPanorama:!0},r)):zb.createElement(_Ve,EF({ref:t},n),zb.createElement(LH,{isPanorama:!1},r))})});function $ve(){var e=lr(),[t,r]=(0,IF.useState)(null),n=je(Foe);return(0,IF.useEffect)(()=>{if(t!=null){var i=t.getBoundingClientRect(),a=i.width/t.offsetWidth;Lr(a)&&a!==n&&e(xoe(a))}},[t,e,n]),r}var IF,Rve=F(()=>{IF=Y(Q());Jr();Qp();B1();Rl()});function Uve(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function WVe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Uve(Object(r),!0).forEach(function(n){$Ve(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Uve(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $Ve(e,t,r){return(t=RVe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RVe(e){var t=UVe(e,"string");return typeof t=="symbol"?t:t+""}function UVe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jb(){return jb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jb.apply(null,arguments)}function MF(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}function KVe(e){return e===!0?qVe:YVe}var Bo,wn,HVe,qVe,VVe,GVe,YVe,Hve,qve=F(()=>{Bo=Y(Q()),wn=Y(Q());Zn();Zu();Jr();vH();X8();kH();Rve();CH();EH();Y8();Y4();xi();l6();wr();HVe=()=>(jpe(),null);qVe=(0,wn.forwardRef)((e,t)=>{var r,n,i=(0,wn.useRef)(null),[a,o]=(0,wn.useState)({containerWidth:MF((r=e.style)===null||r===void 0?void 0:r.width),containerHeight:MF((n=e.style)===null||n===void 0?void 0:n.height)}),s=(0,wn.useCallback)((c,d)=>{o(u=>{var p=Math.round(c),m=Math.round(d);return u.containerWidth===p&&u.containerHeight===m?u:{containerWidth:p,containerHeight:m}})},[]),l=(0,wn.useCallback)(c=>{if(typeof t=="function"&&t(c),c!=null&&typeof ResizeObserver!="undefined"){var{width:d,height:u}=c.getBoundingClientRect();s(d,u);var p=g=>{var{width:f,height:v}=g[0].contentRect;s(f,v)},m=new ResizeObserver(p);m.observe(c),i.current=m}},[t,s]);return(0,wn.useEffect)(()=>()=>{var c=i.current;c!=null&&c.disconnect()},[s]),Bo.createElement(Bo.Fragment,null,Bo.createElement(Z0,{width:a.containerWidth,height:a.containerHeight}),Bo.createElement("div",jb({ref:l},e)))}),VVe=(0,wn.forwardRef)((e,t)=>{var{width:r,height:n}=e,[i,a]=(0,wn.useState)({containerWidth:MF(r),containerHeight:MF(n)}),o=(0,wn.useCallback)((l,c)=>{a(d=>{var u=Math.round(l),p=Math.round(c);return d.containerWidth===u&&d.containerHeight===p?d:{containerWidth:u,containerHeight:p}})},[]),s=(0,wn.useCallback)(l=>{if(typeof t=="function"&&t(l),l!=null){var{width:c,height:d}=l.getBoundingClientRect();o(c,d)}},[t,o]);return Bo.createElement(Bo.Fragment,null,Bo.createElement(Z0,{width:i.containerWidth,height:i.containerHeight}),Bo.createElement("div",jb({ref:s},e)))}),GVe=(0,wn.forwardRef)((e,t)=>{var{width:r,height:n}=e;return Bo.createElement(Bo.Fragment,null,Bo.createElement(Z0,{width:r,height:n}),Bo.createElement("div",jb({ref:t},e)))}),YVe=(0,wn.forwardRef)((e,t)=>{var{width:r,height:n}=e;return Hy(r)||Hy(n)?Bo.createElement(VVe,jb({},e,{ref:t})):Bo.createElement(GVe,jb({},e,{ref:t}))});Hve=(0,wn.forwardRef)((e,t)=>{var{children:r,className:n,height:i,onClick:a,onContextMenu:o,onDoubleClick:s,onMouseDown:l,onMouseEnter:c,onMouseLeave:d,onMouseMove:u,onMouseUp:p,onTouchEnd:m,onTouchMove:g,onTouchStart:f,style:v,width:h,responsive:y,dispatchTouchEvents:b=!0}=e,k=(0,wn.useRef)(null),x=lr(),[S,w]=(0,wn.useState)(null),[C,D]=(0,wn.useState)(null),P=$ve(),M=yL(),z=(M==null?void 0:M.width)>0?M.width:h,A=(M==null?void 0:M.height)>0?M.height:i,I=(0,wn.useCallback)(V=>{P(V),typeof t=="function"&&t(V),w(V),D(V),V!=null&&(k.current=V)},[P,t,w,D]),L=(0,wn.useCallback)(V=>{x(fH(V)),x(ad({handler:a,reactEvent:V}))},[x,a]),E=(0,wn.useCallback)(V=>{x(wF(V)),x(ad({handler:c,reactEvent:V}))},[x,c]),T=(0,wn.useCallback)(V=>{x(t2()),x(ad({handler:d,reactEvent:V}))},[x,d]),$=(0,wn.useCallback)(V=>{x(wF(V)),x(ad({handler:u,reactEvent:V}))},[x,u]),_=(0,wn.useCallback)(()=>{x(wH())},[x]),B=(0,wn.useCallback)(V=>{x(xH(V.key))},[x]),W=(0,wn.useCallback)(V=>{x(ad({handler:o,reactEvent:V}))},[x,o]),N=(0,wn.useCallback)(V=>{x(ad({handler:s,reactEvent:V}))},[x,s]),U=(0,wn.useCallback)(V=>{x(ad({handler:l,reactEvent:V}))},[x,l]),j=(0,wn.useCallback)(V=>{x(ad({handler:p,reactEvent:V}))},[x,p]),R=(0,wn.useCallback)(V=>{x(ad({handler:f,reactEvent:V}))},[x,f]),O=(0,wn.useCallback)(V=>{b&&x(PH(V)),x(ad({handler:g,reactEvent:V}))},[x,b,g]),H=(0,wn.useCallback)(V=>{x(ad({handler:m,reactEvent:V}))},[x,m]),q=KVe(y);return Bo.createElement(G8.Provider,{value:S},Bo.createElement(G4.Provider,{value:C},Bo.createElement(q,{width:z!=null?z:v==null?void 0:v.width,height:A!=null?A:v==null?void 0:v.height,className:wt("recharts-wrapper",n),style:WVe({position:"relative",cursor:"default",width:z,height:A},v),onClick:L,onContextMenu:W,onDoubleClick:N,onFocus:_,onKeyDown:B,onMouseDown:U,onMouseEnter:E,onMouseLeave:T,onMouseMove:$,onMouseUp:j,onTouchEnd:H,onTouchMove:O,onTouchStart:R,ref:I},Bo.createElement(HVe,null),r)))})});function QVe(e,t){if(e==null)return{};var r,n,i=XVe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function XVe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Xf,Vve,JVe,AF,OH=F(()=>{Xf=Y(Q()),Vve=Y(Q());Wve();qve();WU();js();xi();JVe=["width","height","responsive","children","className","style","compact","title","desc"];AF=(0,Vve.forwardRef)((e,t)=>{var{width:r,height:n,responsive:i,children:a,className:o,style:s,compact:l,title:c,desc:d}=e,u=QVe(e,JVe),p=mn(u);return l?Xf.createElement(Xf.Fragment,null,Xf.createElement(Z0,{width:r,height:n}),Xf.createElement(FH,{otherAttributes:p,title:c,desc:d},a)):Xf.createElement(Hve,{className:o,style:s,width:r,height:n,responsive:i!=null?i:!1,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},Xf.createElement(FH,{otherAttributes:p,title:c,desc:d,ref:t},Xf.createElement(ehe,null,a)))})});function zH(){return zH=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zH.apply(null,arguments)}var Yw,Gve,ZVe,eGe,Kh,pP=F(()=>{Yw=Y(Q()),Gve=Y(Q());IH();jU();MH();AH();OH();ma();ZVe={top:5,right:5,bottom:5,left:5},eGe={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:ZVe,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},Kh=(0,Gve.forwardRef)(function(t,r){var n,i=pr(t.categoricalChartProps,eGe),{chartName:a,defaultTooltipEventType:o,validateTooltipEventTypes:s,tooltipPayloadSearcher:l,categoricalChartProps:c}=t,d={chartName:a,defaultTooltipEventType:o,validateTooltipEventTypes:s,tooltipPayloadSearcher:l,eventEmitter:void 0};return Yw.createElement(SF,{preloadedState:{options:d},reduxStoreName:(n=c.id)!==null&&n!==void 0?n:a},Yw.createElement(sF,{chartData:c.data}),Yw.createElement(CF,{layout:i.layout,margin:i.margin}),Yw.createElement(PF,{baseValue:i.baseValue,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className,reverseStackOrder:i.reverseStackOrder}),Yw.createElement(AF,zH({},i,{ref:r})))})});var Yve,Kve,tGe,mP,Jve=F(()=>{Yve=Y(Q()),Kve=Y(Q());_h();pP();tGe=["axis"],mP=(0,Kve.forwardRef)((e,t)=>Yve.createElement(Kh,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:tGe,tooltipPayloadSearcher:cm,categoricalChartProps:e,ref:t}))});var Qve,Xve,rGe,_b,Zve=F(()=>{Qve=Y(Q()),Xve=Y(Q());_h();pP();rGe=["axis","item"],_b=(0,Xve.forwardRef)((e,t)=>Qve.createElement(Kh,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:rGe,tooltipPayloadSearcher:cm,categoricalChartProps:e,ref:t}))});function tye(e){var t=lr();return(0,eye.useEffect)(()=>{t(Ive(e))},[t,e]),null}var eye,rye=F(()=>{eye=Y(Q());Jr();bH()});function jH(){return jH=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jH.apply(null,arguments)}function iGe(e,t){if(e==null)return{};var r,n,i=aGe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function aGe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var nye,Bb,nGe,oGe,_H,iye,aye=F(()=>{nye=Y(Q()),Bb=Y(Q());IH();jU();MH();AH();rye();OH();ma();nGe=["layout"];oGe={top:5,right:5,bottom:5,left:5},_H={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:oGe,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},iye=(0,nye.forwardRef)(function(t,r){var n,i=pr(t.categoricalChartProps,_H),{layout:a}=i,o=iGe(i,nGe),{chartName:s,defaultTooltipEventType:l,validateTooltipEventTypes:c,tooltipPayloadSearcher:d}=t,u={chartName:s,defaultTooltipEventType:l,validateTooltipEventTypes:c,tooltipPayloadSearcher:d,eventEmitter:void 0};return Bb.createElement(SF,{preloadedState:{options:u},reduxStoreName:(n=i.id)!==null&&n!==void 0?n:s},Bb.createElement(sF,{chartData:i.data}),Bb.createElement(CF,{layout:a,margin:i.margin}),Bb.createElement(PF,{baseValue:void 0,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className,reverseStackOrder:i.reverseStackOrder}),Bb.createElement(tye,{cx:i.cx,cy:i.cy,startAngle:i.startAngle,endAngle:i.endAngle,innerRadius:i.innerRadius,outerRadius:i.outerRadius}),Bb.createElement(AF,jH({},o,{ref:r})))})});function oye(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function sye(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oye(Object(r),!0).forEach(function(n){sGe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oye(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sGe(e,t,r){return(t=lGe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lGe(e){var t=cGe(e,"string");return typeof t=="symbol"?t:t+""}function cGe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lye,cye,dGe,uGe,BH,dye=F(()=>{lye=Y(Q()),cye=Y(Q());_h();ma();aye();dGe=["axis"],uGe=sye(sye({},_H),{},{layout:"centric",startAngle:90,endAngle:-270}),BH=(0,cye.forwardRef)((e,t)=>{var r=pr(e,uGe);return lye.createElement(iye,{chartName:"RadarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:dGe,tooltipPayloadSearcher:cm,categoricalChartProps:r,ref:t})})});var uye,pye,pGe,fP,mye=F(()=>{uye=Y(Q()),pye=Y(Q());_h();pP();pGe=["axis"],fP=(0,pye.forwardRef)((e,t)=>uye.createElement(Kh,{chartName:"AreaChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:pGe,tooltipPayloadSearcher:cm,categoricalChartProps:e,ref:t}))});var fye,gye,mGe,gP,hye=F(()=>{fye=Y(Q()),gye=Y(Q());_h();pP();mGe=["axis"],gP=(0,gye.forwardRef)((e,t)=>fye.createElement(Kh,{chartName:"ComposedChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:mGe,tooltipPayloadSearcher:cm,categoricalChartProps:e,ref:t}))});var ip=F(()=>{Koe();Hpe();Hme();dfe();mfe();OU();ahe();yhe();GU();tH();aH();bve();wve();Jve();Zve();dye();mye();hye()});var od,WH,$H,vye,Wo,ap=F(()=>{od=Y(Q());ph();WH=100,$H=100,vye=(typeof window!="undefined"&&window.JOURNALIT_DEBUG_CHARTS)===!0,Wo=od.default.memo(({children:e,height:t="100%",width:r="100%",className:n="",style:i={},onChartClick:a})=>{let o=(0,od.useRef)(null),[s,l]=(0,od.useState)({width:0,height:0}),[c,d]=(0,od.useState)(!1),u=typeof t=="number"?`${t}px`:t,m={width:typeof r=="number"?`${r}px`:r,height:u,overflow:"hidden",borderRadius:"8px",minHeight:typeof t=="string"&&t.includes("%")?120:void 0,...i},g=`journalit-chart-container ${n}`.trim(),f=s.width>=WH&&s.height>=$H,v=c&&f;return(0,od.useEffect)(()=>{let h=o.current;if(!h)return;let y=h.getBoundingClientRect();if(y.width>0&&y.height>0&&(l({width:y.width,height:y.height}),d(!0),vye&&console.log("[ChartBase] initial dimensions",{width:y.width,height:y.height})),typeof ResizeObserver=="undefined"){console.warn("ResizeObserver not available, falling back to immediate render"),c||(l({width:WH,height:$H}),d(!0));return}let b=new ResizeObserver(k=>{for(let x of k){let{width:S,height:w}=x.contentRect;l({width:S,height:w}),d(!0),vye&&console.log("[ChartBase] resize",{width:S,height:w,shouldShowChart:S>=WH&&w>=$H})}});return b.observe(h),()=>{b.unobserve(h),b.disconnect()}},[]),od.default.createElement("div",{ref:o,className:g,style:m,onClick:a},v?od.default.cloneElement(e,{width:Math.max(0,Math.floor(s.width)),height:Math.max(0,Math.floor(s.height))}):od.default.createElement("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100px"}},od.default.createElement(Io,{message:"Loading chart...",size:"small"})))})});var fm,RH,Kw,LF=F(()=>{fm=Y(Q());Ll();Er();RH=(e,t,r)=>e.type==="text"||typeof e.value=="string"?e.value.toString():typeof e.value=="number"?e.type==="pnl"?zT(e.value,"pnl",t,r,e.rMultiple):e.type==="drawdown"?zT(e.value,"drawdown",t):zT(e.value,"number",t):String(e.value),Kw=fm.default.memo(({active:e,payload:t,dateKey:r="date",valueKey:n="pnl",valueType:i="pnl",additionalItems:a,formatter:o,displayRMultiples:s,currencyOverride:l})=>{var k,x;let{currency:c}=ct(),d=l||c;if(!e||!t||t.length===0)return null;let u=t[0].payload;if(o){let{title:S,primaryValue:w,items:C}=o(u),D=w.isPositive?Hc.positive:w.isNegative?Hc.negative:"";return fm.default.createElement("div",{className:Hc.container},fm.default.createElement("div",{className:Hc.date},S),fm.default.createElement("div",{className:`${Hc.value} ${D}`},RH(w,d,s)),C==null?void 0:C.map((P,M)=>fm.default.createElement("div",{key:M,className:Hc.info,style:P.isPositive||P.isNegative?{color:P.isPositive?"var(--chart-positive)":"var(--chart-negative)"}:void 0},P.label,": ",RH(P,d,s))))}let p=u[r],m=u[n],g=(x=(k=u.cumulativeR)!=null?k:u.tradeR)!=null?x:u.rMultiple,f=i==="pnl"?m>=0:!1,v=i==="drawdown"?!0:m<0,h=zT(m,i,d,s,g),y=f?Hc.positive:v?Hc.negative:"",b=a?a(u):[];return fm.default.createElement("div",{className:Hc.container},fm.default.createElement("div",{className:Hc.date},p),fm.default.createElement("div",{className:`${Hc.value} ${y}`},h),b.map((S,w)=>fm.default.createElement("div",{key:w,className:Hc.info,style:S.isPositive||S.isNegative?{color:S.isPositive?"var(--chart-positive)":"var(--chart-negative)"}:void 0},S.label,": ",RH(S,d,s))))})});var Qt,fGe,gGe,hGe,Jh,Qh,Zf,UH=F(()=>{Qt=Y(Q());qt();ip();Ll();ap();LF();Er();fGe=1e-6,gGe=(e,t,r)=>Qt.default.createElement(Kw,{...e,valueKey:"pnl",valueType:"pnl",displayRMultiples:t,currencyOverride:r,additionalItems:n=>n.tradePnL!==0?[{label:"Trade P&L",value:n.tradePnL,type:"pnl",isPositive:n.tradePnL>0,isNegative:n.tradePnL<0,rMultiple:n.tradeR}]:[]}),hGe=0,Jh="var(--chart-positive, #43a047)",Qh="var(--chart-negative, #e53935)",Zf=Qt.default.memo(({data:e,height:t="100%",width:r="100%",minValue:n,maxValue:i,gradientTransitionOffset:a,margin:o={top:6,right:5,left:0,bottom:10},className:s="",style:l={},tooltipProps:c={},showTooltip:d=!0,customTooltip:u,autoRange:p=!0,paddingPercentage:m=.05,fillGradient:g=!0,onChartClick:f,onPointClick:v,plugin:h,currencyOverride:y})=>{var B,W,N;let{currency:b}=ct(),k=y||b,x=(typeof window!="undefined"&&window.JOURNALIT_DEBUG_CHARTS)===!0,S=(N=(W=(B=h==null?void 0:h.settings)==null?void 0:B.trade)==null?void 0:W.displayRMultiples)!=null?N:!1,w=(0,Qt.useMemo)(()=>`pnl-chart-${++hGe}`,[]),C=(0,Qt.useMemo)(()=>{let U=Math.min(...e.map(R=>R.pnl)),j=Math.max(...e.map(R=>R.pnl));return{dataMin:U,dataMax:j}},[e]),D=(0,Qt.useMemo)(()=>{let U=new Map;return e.forEach(j=>{U.set(j.dateKey,j.date)}),U},[e]),P=(0,Qt.useCallback)(U=>{if(!S||e.length===0)return;let j=e[0],R=e[e.length-1];for(let O=0;O<e.length-1;O++)if(e[O].pnl<=U&&e[O+1].pnl>=U){j=e[O],R=e[O+1];break}if(j.cumulativeR!==void 0&&R.cumulativeR!==void 0){let O=R.pnl-j.pnl;if(Math.abs(O)<fGe)return j.cumulativeR;let H=(U-j.pnl)/O;return j.cumulativeR+H*(R.cumulativeR-j.cumulativeR)}},[S,e]),M=(0,Qt.useMemo)(()=>{let{dataMin:U,dataMax:j}=C,R=n!==void 0?n:U,O=i!==void 0?i:j,{domain:H,ticks:q,step:V}=Al(R,O,6,!0,!0),[J,K]=H,G=a;if(G===void 0){let X=Math.min(0,U),te=Math.max(0,j),re=te-X;if(re!==0&&!isNaN(re)&&!isNaN(te)&&!isNaN(X)){let Z=(te-0)/re*100;G=isNaN(Z)?50:Z}else isNaN(te)?G=50:G=te<0?100:0;G=Math.max(0,Math.min(100,G))}return{actualMinValue:J,actualMaxValue:K,actualTransitionOffset:G,ticks:q}},[C,n,i,a]),{actualMinValue:z,actualMaxValue:A,actualTransitionOffset:I,ticks:L}=M,E=Qt.default.useMemo(()=>Md(L,U=>ye(U,!0,k,!1,void 0)),[L,k]);(0,Qt.useEffect)(()=>{var U;x&&console.log("[SharedPnLChart] data len/domain",{length:(U=e==null?void 0:e.length)!=null?U:0,domain:[z,A],ticks:L,offset:I})},[x,e==null?void 0:e.length,z,A,L,I]);let T=`url(#${w}-gradientDual)`,$=`url(#${w}-strokeGradient)`;z>=0&&A>=0?T=`url(#${w}-gradientPositive)`:A<=0&&z<=0&&(T=`url(#${w}-gradientNegative)`);let _=U=>{if(f&&f(U),v&&U&&U.activePayload&&U.activePayload.length>0){let j=U.activePayload[0].payload,R=e.findIndex(O=>O===j);R!==-1&&v(j,R)}};return Qt.default.createElement(Wo,{height:t,width:r,className:s,style:l,onChartClick:_},Qt.default.createElement(fP,{data:e,margin:o,onClick:_},Qt.default.createElement("defs",null,Qt.default.createElement("linearGradient",{id:`${w}-gradientPositive`,x1:"0",y1:"1",x2:"0",y2:"0"},Qt.default.createElement("stop",{offset:"0%",stopColor:Jh,stopOpacity:.1}),Qt.default.createElement("stop",{offset:"100%",stopColor:Jh,stopOpacity:.4})),Qt.default.createElement("linearGradient",{id:`${w}-gradientNegative`,x1:"0",y1:"0",x2:"0",y2:"1"},Qt.default.createElement("stop",{offset:"0%",stopColor:Qh,stopOpacity:.1}),Qt.default.createElement("stop",{offset:"100%",stopColor:Qh,stopOpacity:.4})),Qt.default.createElement("linearGradient",{id:`${w}-gradientDual`,x1:"0",y1:"0",x2:"0",y2:"1"},Qt.default.createElement("stop",{offset:"0%",stopColor:Jh,stopOpacity:.4}),Qt.default.createElement("stop",{offset:`${I}%`,stopColor:Jh,stopOpacity:.1}),Qt.default.createElement("stop",{offset:`${I}%`,stopColor:Qh,stopOpacity:.1}),Qt.default.createElement("stop",{offset:"100%",stopColor:Qh,stopOpacity:.4})),Qt.default.createElement("linearGradient",{id:`${w}-strokeGradient`,x1:"0",y1:"0",x2:"0",y2:"1"},I<=.1?Qt.default.createElement(Qt.default.Fragment,null,Qt.default.createElement("stop",{offset:"0%",stopColor:Qh}),Qt.default.createElement("stop",{offset:"100%",stopColor:Qh})):I>=99.9?Qt.default.createElement(Qt.default.Fragment,null,Qt.default.createElement("stop",{offset:"0%",stopColor:Jh}),Qt.default.createElement("stop",{offset:"100%",stopColor:Jh})):Qt.default.createElement(Qt.default.Fragment,null,Qt.default.createElement("stop",{offset:"0%",stopColor:Jh}),Qt.default.createElement("stop",{offset:`${Math.max(.1,I-.1)}%`,stopColor:Jh}),Qt.default.createElement("stop",{offset:`${Math.min(99.9,I+.1)}%`,stopColor:Qh}),Qt.default.createElement("stop",{offset:"100%",stopColor:Qh}))),Qt.default.createElement("filter",{id:`${w}-shadow`,height:"120%"},Qt.default.createElement("feDropShadow",{dx:"0",dy:"1",stdDeviation:"2",floodOpacity:"0.1"})),Qt.default.createElement("filter",{id:`${w}-glow`,height:"130%"},Qt.default.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"2",result:"blur"}),Qt.default.createElement("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7",result:"glow"}),Qt.default.createElement("feComposite",{in:"SourceGraphic",in2:"glow",operator:"over"}))),Qt.default.createElement(zo,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),Qt.default.createElement(Xa,{y:0,stroke:"var(--text-normal, #888888)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1.5,ifOverflow:"hidden"}),Qt.default.createElement(jo,{dataKey:"dateKey",height:16,style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:4,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5},tickFormatter:U=>{var R;let j=String(U);return(R=D.get(j))!=null?R:j}}),Qt.default.createElement(_o,{tickFormatter:U=>{let j=P(U);return ye(U,!0,k,S,j)},style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:[z,A],allowDataOverflow:!1,width:E,ticks:L,scale:"linear",tickLine:!0,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.3},tickMargin:5}),d&&Qt.default.createElement(ho,{content:u||(U=>gGe(U,S,y)),cursor:{fill:"var(--interactive-hover)",fillOpacity:.1,strokeOpacity:.3,strokeWidth:1,stroke:"var(--interactive-accent)"},wrapperStyle:{zIndex:1e3},...c}),Qt.default.createElement(np,{type:"monotone",dataKey:"pnl",stroke:$,strokeWidth:2.5,fill:g?T:"none",dot:!1,activeDot:{r:7,strokeWidth:1,stroke:"var(--background-primary)",fill:"var(--interactive-accent, #4299e1)",filter:`url(#${w}-glow)`},animationDuration:500,animationEasing:"ease-out",filter:`url(#${w}-shadow)`})))});Zf.displayName="SharedPnLChart"});var va,vGe,hP,HH=F(()=>{va=Y(Q());ip();Ll();ap();LF();Er();vGe=(e,t,r,n)=>va.default.createElement(Kw,{...e,valueKey:"drawdown",valueType:"drawdown",displayRMultiples:t,currencyOverride:n,additionalItems:i=>[{label:"P&L",value:i.pnl,type:"pnl",isPositive:i.pnl>0,isNegative:i.pnl<0,rMultiple:i.rMultiple},{label:"Peak Equity",value:i.peakEquity,type:"pnl",rMultiple:i.peakEquity&&r&&r>0?i.peakEquity/r:void 0}]}),hP=va.default.memo(({data:e,height:t="100%",width:r="100%",minValue:n,maxValue:i,margin:a={top:6,right:5,left:0,bottom:10},className:o="",style:s={},tooltipProps:l={},showTooltip:c=!0,customTooltip:d,autoRange:u=!0,paddingPercentage:p=.05,onChartClick:m,onPointClick:g,plugin:f,currencyOverride:v})=>{var z,A,I,L,E;let{currency:h}=ct(),y=v||h,b=(I=(A=(z=f==null?void 0:f.settings)==null?void 0:z.trade)==null?void 0:A.displayRMultiples)!=null?I:!1,k=(E=(L=f==null?void 0:f.settings)==null?void 0:L.trade)==null?void 0:E.defaultRiskAmount,x=(0,va.useMemo)(()=>{let T=n!==void 0?n:Math.min(...e.map(U=>U.drawdown)),$=i!==void 0?i:Math.max(...e.map(U=>U.drawdown)),{domain:_,ticks:B}=Al(T,$,6,!0,!0),W=Md(B,U=>`${U.toFixed(1)}%`);return{domain:_,ticks:B,yAxisWidth:W,negativeColor:"var(--text-error, #e53935)"}},[e,n,i]),{domain:S,ticks:w,yAxisWidth:C,negativeColor:D}=x,P=(0,va.useMemo)(()=>{let T=new Map;return e.forEach($=>{T.set($.dateKey,$.date)}),T},[e]),M=T=>{if(m&&m(T),g&&T&&T.activePayload&&T.activePayload.length>0){let $=T.activePayload[0].payload,_=e.findIndex(B=>B===$);_!==-1&&g($,_)}};return va.default.createElement(Wo,{height:t,width:r,className:o,style:s,onChartClick:M},va.default.createElement(fP,{data:e,margin:a,onClick:M},va.default.createElement("defs",null,va.default.createElement("linearGradient",{id:"drawdownGradient",x1:"0",y1:"0",x2:"0",y2:"1"},va.default.createElement("stop",{offset:"0%",stopColor:D,stopOpacity:.1}),va.default.createElement("stop",{offset:"100%",stopColor:D,stopOpacity:.4})),va.default.createElement("filter",{id:"drawdown-shadow",height:"120%"},va.default.createElement("feDropShadow",{dx:"0",dy:"1",stdDeviation:"2",floodOpacity:"0.1"})),va.default.createElement("filter",{id:"drawdown-glow",height:"130%"},va.default.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"2",result:"blur"}),va.default.createElement("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7",result:"glow"}),va.default.createElement("feComposite",{in:"SourceGraphic",in2:"glow",operator:"over"}))),va.default.createElement(zo,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),va.default.createElement(Xa,{y:0,stroke:"var(--text-normal, #888888)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1.5,ifOverflow:"hidden"}),va.default.createElement(jo,{dataKey:"dateKey",height:16,style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:4,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5},tickFormatter:T=>{var _;let $=String(T);return(_=P.get($))!=null?_:$}}),va.default.createElement(_o,{tickFormatter:T=>J_(T),style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:S,allowDataOverflow:!1,width:C,ticks:w,scale:"linear",tickLine:!0,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.3},tickMargin:5}),c&&va.default.createElement(ho,{content:d||(T=>vGe(T,b,k,v)),cursor:{fill:"var(--interactive-hover)",fillOpacity:.1,strokeOpacity:.3,strokeWidth:1,stroke:"var(--interactive-accent)"},wrapperStyle:{zIndex:1e3},...l}),va.default.createElement(np,{type:"monotone",dataKey:"drawdown",stroke:D,strokeWidth:2.5,fill:"url(#drawdownGradient)",fillOpacity:.4,dot:!1,activeDot:{r:7,strokeWidth:1,stroke:"var(--background-primary)",fill:D,filter:"url(#drawdown-glow)"},animationDuration:1e3,animationEasing:"ease-out",filter:"url(#drawdown-shadow)"})))})});var za,yGe,vP,yye=F(()=>{za=Y(Q());qt();ip();Ol();Ll();ap();LF();Er();nr();yGe=(e,t,r)=>{if(!e.active||!e.payload||e.payload.length===0)return null;let n=e.payload[0].payload,i=n.entryTime?new Date(n.entryTime).toLocaleString():"Unknown",a=n.exitTime?new Date(n.exitTime).toLocaleString():"Unknown";return za.default.createElement(Kw,{...e,displayRMultiples:t,currencyOverride:r,formatter:o=>{var s;return{title:o.instrument?`${o.instrument} ${((s=o.direction)==null?void 0:s.toLowerCase())==="long"?"\u2191":"\u2193"}`:`Trade #${o.tradeIndex+1}`,primaryValue:{value:o.pnl,type:"pnl",isPositive:o.pnl>=0,isNegative:o.pnl<0,rMultiple:o.rMultiple},items:[{label:"Entry",value:i,type:"text"},{label:"Exit",value:a,type:"text"},{label:"Trade",value:`#${o.tradeIndex+1}`,type:"text"}]}}})},vP=({data:e,height:t="100%",width:r="100%",minValue:n,maxValue:i,margin:a={top:6,right:5,left:0,bottom:10},className:o="",style:s={},tooltipProps:l={},showTooltip:c=!0,customTooltip:d,autoRange:u=!0,paddingPercentage:p=.05,onChartClick:m,onPointClick:g,currencyOverride:f})=>{var L,E,T,$;let{currency:v}=ct(),h=f||v,y=Ae(),b=(E=(L=y==null?void 0:y.settings)==null?void 0:L.trade)==null?void 0:E.displayRMultiples,k=($=(T=y==null?void 0:y.settings)==null?void 0:T.trade)==null?void 0:$.defaultRiskAmount,x=_=>{if(!b||!k||k===0)return ye(_,!0,h,!1,void 0);let B=_/k;return ye(_,!0,h,!0,B)},S=za.default.useMemo(()=>{let _=Math.min(...e.map(W=>W.pnl)),B=Math.max(...e.map(W=>W.pnl));return{dataMin:_,dataMax:B}},[e]),{dataMin:w,dataMax:C}=S,{domain:D,ticks:P}=za.default.useMemo(()=>Al(n!==void 0?n:w,i!==void 0?i:C,6,!0,!0),[w,C,n,i]),[M,z]=D,A=za.default.useMemo(()=>Md(P,_=>ye(_,!0,h,!1,void 0)),[P,h]);if(e.length===0)return za.default.createElement("div",{style:{width:"100%",height:typeof t=="number"?`${t}px`:t,display:"flex",justifyContent:"center",alignItems:"center"}},za.default.createElement(yi,{message:"No trades available",subMessage:"Try selecting a different time period",iconSize:36}));let I=(_,B,W)=>{g&&g(B,W)};return za.default.createElement(Wo,{height:t,width:r,className:o,style:s,onChartClick:m},za.default.createElement(_b,{data:e,margin:a},za.default.createElement("defs",null,za.default.createElement("filter",{id:"tradesChartBarShadow",height:"130%"},za.default.createElement("feDropShadow",{dx:"0",dy:"2",stdDeviation:"2",floodOpacity:"0.1"})),za.default.createElement("filter",{id:"tradesChartBarGlow",height:"130%"},za.default.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"1.5",result:"blur"}),za.default.createElement("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7",result:"glow"}),za.default.createElement("feComposite",{in:"SourceGraphic",in2:"glow",operator:"over"}))),za.default.createElement(zo,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),za.default.createElement(Xa,{y:0,stroke:"var(--text-normal, #888888)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1.5,ifOverflow:"hidden"}),za.default.createElement(jo,{dataKey:"tradeIndex",height:16,tickFormatter:_=>`#${_+1}`,style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:4,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5}}),za.default.createElement(_o,{tickFormatter:x,style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:D,allowDataOverflow:!1,width:A,ticks:P,interval:"preserveStartEnd",scale:"linear",tickLine:!1,axisLine:!1,tickMargin:5}),c&&za.default.createElement(ho,{content:d||(_=>yGe(_,b,f)),cursor:{fill:"var(--interactive-hover)",fillOpacity:.1,strokeOpacity:.3,strokeWidth:1,stroke:"var(--interactive-accent)"},wrapperStyle:{zIndex:1e3},...l}),za.default.createElement(Yh,{dataKey:"pnl",fill:"var(--interactive-accent)",minPointSize:5,isAnimationActive:!0,animationDuration:800,animationEasing:"ease-out",stroke:"var(--background-primary)",strokeWidth:.8,strokeOpacity:.5,filter:"url(#tradesChartBarShadow)",radius:[2,2,0,0],activeBar:{filter:"url(#tradesChartBarGlow)",strokeWidth:1.2,strokeOpacity:.8},shape:_=>{var re,Z;let{x:B,y:W,width:N,height:U}=_,R=(((re=_.payload)==null?void 0:re.pnl)||0)>=0,O=((Z=_.payload)==null?void 0:Z.fill)||(R?"var(--chart-positive)":"var(--chart-negative)"),H=B||0,q=W||0,V=N||0,J=U||0,K=J<0?Math.abs(J):J,G=J<0?q+J:q,X;R?X=[2,2,0,0]:X=[0,0,2,2];let te=_.index||0;return za.default.createElement("rect",{x:H,y:G,width:V,height:K>0?K:0,fill:O,stroke:_.stroke,strokeWidth:_.strokeWidth,strokeOpacity:_.strokeOpacity,filter:R?_.filter:"none",rx:X[0],ry:X[0],onClick:ne=>I(ne,_.payload,te)})}})))}});var ya,bGe,xGe,op,bye=F(()=>{ya=Y(Q());qt();ip();Er();nr();ap();Ll();bGe=1e-6,xGe=({active:e,payload:t,currencyOverride:r})=>{var d,u,p;let{currency:n}=ct(),i=r||n,a=Ae();if(!e||!t||t.length===0)return null;let o=t[0].payload,s=o.pnl>=0,l=(p=(u=(d=a==null?void 0:a.settings)==null?void 0:d.trade)==null?void 0:u.displayRMultiples)!=null?p:!1,c=ye(o.pnl,!0,i,l,o.rMultiple);return ya.default.createElement("div",{className:"journalit-chart-tooltip",style:{backgroundColor:"var(--background-primary)",borderRadius:"10px",padding:"14px 18px",minWidth:"140px",border:"1px solid var(--background-modifier-border)",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.2)",transform:"translateY(-4px)",position:"relative",animation:"tooltipFadeIn 0.2s cubic-bezier(0.19, 1, 0.22, 1)"}},ya.default.createElement("div",{className:"journalit-chart-tooltip-date",style:{fontSize:"14px",fontWeight:500,color:"var(--text-normal)",marginBottom:"8px",textAlign:"center",borderBottom:"1px solid var(--background-modifier-border)",paddingBottom:"6px"}},o.date),ya.default.createElement("div",{className:`journalit-chart-tooltip-value ${s?"positive":"negative"}`,style:{fontSize:"20px",fontWeight:600,textAlign:"center",color:s?"var(--chart-positive)":"var(--chart-negative)"}},c),o.trades!==void 0&&ya.default.createElement("div",{className:"journalit-chart-tooltip-info",style:{fontSize:"12px",color:"var(--text-muted)",marginTop:"8px",textAlign:"center",fontStyle:"italic"}},o.trades," ",o.trades===1?"trade":"trades"))},op=ya.default.memo(({data:e,height:t="100%",minValue:r,maxValue:n,currencyOverride:i})=>{var g,f,v;let{currency:a}=ct(),o=i||a,s=Ae(),l=(v=(f=(g=s==null?void 0:s.settings)==null?void 0:g.trade)==null?void 0:f.displayRMultiples)!=null?v:!1,c=ya.default.useMemo(()=>e.length===0?null:e.reduce((h,y)=>Math.abs(y.pnl)>Math.abs(h.pnl)?y:h,e[0]),[e]),{domain:d,ticks:u,yAxisWidth:p}=ya.default.useMemo(()=>{let h=r!==void 0?r:Math.min(...e.map(x=>x.pnl)),y=n!==void 0?n:Math.max(...e.map(x=>x.pnl)),b=Al(h,y,6,!0,!0),k=Md(b.ticks,x=>ye(x,!0,o,!1,void 0));return{domain:b.domain,ticks:b.ticks,yAxisWidth:k}},[e,r,n,o]),m=typeof t=="number"?`${t}px`:t;return ya.default.createElement(Wo,{height:t,width:"100%",style:{borderRadius:"8px"}},ya.default.createElement(_b,{data:e,margin:{top:6,right:5,left:0,bottom:10}},ya.default.createElement("defs",null,ya.default.createElement("filter",{id:"dailyPerformanceBarShadow",height:"130%"},ya.default.createElement("feDropShadow",{dx:"0",dy:"2",stdDeviation:"2",floodOpacity:"0.1"})),ya.default.createElement("filter",{id:"dailyPerformanceBarGlow",height:"130%"},ya.default.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"1.5",result:"blur"}),ya.default.createElement("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7",result:"glow"}),ya.default.createElement("feComposite",{in:"SourceGraphic",in2:"glow",operator:"over"}))),ya.default.createElement(zo,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),ya.default.createElement(Xa,{y:0,stroke:"var(--text-normal, #888888)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1.5,ifOverflow:"hidden"}),ya.default.createElement(jo,{dataKey:"date",height:16,style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:4,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5}}),ya.default.createElement(_o,{tickFormatter:h=>{if(!l)return ye(h,!0,o,!1,void 0);if(!c||Math.abs(c.pnl)<bGe||!c.rMultiple)return ye(h,!0,o,!0,void 0);let b=h/c.pnl*c.rMultiple;return ye(h,!0,o,!0,b)},style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:d,allowDataOverflow:!1,width:p,ticks:u,scale:"linear",tickLine:!1,axisLine:!1,tickMargin:5}),ya.default.createElement(ho,{content:ya.default.createElement(xGe,{currencyOverride:i}),cursor:{fill:"var(--interactive-hover)",fillOpacity:.1,strokeOpacity:.3,strokeWidth:1,stroke:"var(--interactive-accent)"},wrapperStyle:{zIndex:1e3}}),ya.default.createElement(Yh,{dataKey:"pnl",fill:"var(--interactive-accent)",minPointSize:5,isAnimationActive:!0,animationDuration:800,animationEasing:"ease-out",stroke:"var(--background-primary)",strokeWidth:.8,strokeOpacity:.5,filter:"url(#dailyPerformanceBarShadow)",radius:[2,2,0,0],activeBar:{filter:"url(#dailyPerformanceBarGlow)",strokeWidth:1.2,strokeOpacity:.8}})))})});var ra,wGe,kGe,SGe,TGe,qH,VH=F(()=>{ra=Y(Q());qt();ip();Er();ap();Ll();wGe=1e-6,kGe=(e,t)=>e.length<=t?e:e.substring(0,t-1)+"\u2026",SGe=4,TGe=({active:e,payload:t,plugin:r})=>{var l,c,d;let{currency:n}=ct();if(!e||!t||t.length===0)return null;let i=t[0].payload,a=i.pnl>=0,o=(d=(c=(l=r==null?void 0:r.settings)==null?void 0:l.trade)==null?void 0:c.displayRMultiples)!=null?d:!1,s=ye(i.pnl,!0,n,o,i.totalRMultiple);return ra.default.createElement("div",{className:"journalit-chart-tooltip",style:{backgroundColor:"var(--background-primary)",borderRadius:"10px",padding:"14px 18px",minWidth:"140px",border:"1px solid var(--background-modifier-border)",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.2)",transform:"translateY(-4px)",position:"relative"}},ra.default.createElement("div",{className:"journalit-chart-tooltip-setup",style:{fontSize:"14px",fontWeight:500,color:"var(--text-normal)",marginBottom:"8px",textAlign:"center",borderBottom:"1px solid var(--background-modifier-border)",paddingBottom:"6px"}},i.name),ra.default.createElement("div",{className:`journalit-chart-tooltip-value ${a?"positive":"negative"}`,style:{fontSize:"20px",fontWeight:600,textAlign:"center",color:a?"var(--chart-positive)":"var(--chart-negative)"}},s),ra.default.createElement("div",{className:"journalit-chart-tooltip-info",style:{fontSize:"12px",color:"var(--text-muted)",marginTop:"8px",textAlign:"center",fontStyle:"italic"}},"Win Rate: ",i.winRate.toFixed(1),"%"),ra.default.createElement("div",{className:"journalit-chart-tooltip-info",style:{fontSize:"12px",color:"var(--text-muted)",marginTop:"4px",textAlign:"center",fontStyle:"italic"}},i.tradeCount," ",i.tradeCount===1?"trade":"trades"))},qH=({data:e,height:t="100%",minValue:r,maxValue:n,plugin:i})=>{var v,h,y;let{currency:a}=ct(),o=(y=(h=(v=i==null?void 0:i.settings)==null?void 0:v.trade)==null?void 0:h.displayRMultiples)!=null?y:!1,s=e.length>SGe,l=s?10:6,c=ra.default.useMemo(()=>e.length===0?null:e.reduce((b,k)=>Math.abs(k.pnl)>Math.abs(b.pnl)?k:b,e[0]),[e]),d=e.length>0?Math.min(...e.map(b=>b.pnl)):0,u=e.length>0?Math.max(...e.map(b=>b.pnl)):0,{domain:p,ticks:m}=r!==void 0&&n!==void 0?{domain:[r,n],ticks:Al(r,n,6,!0,!0).ticks}:Al(d,u,6,!0,!0),g=ra.default.useMemo(()=>Md(m,b=>ye(b,!0,a,!1,void 0)),[m,a]),f=typeof t=="number"?`${t}px`:t;return ra.default.createElement(Wo,{height:t,width:"100%",style:{borderRadius:"8px"}},ra.default.createElement(_b,{data:e,margin:{top:6,right:5,left:0,bottom:5}},ra.default.createElement("defs",null,ra.default.createElement("filter",{id:"setup-bar-shadow",height:"130%"},ra.default.createElement("feDropShadow",{dx:"0",dy:"2",stdDeviation:"2",floodOpacity:"0.1"})),ra.default.createElement("filter",{id:"setup-bar-glow",height:"130%"},ra.default.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"1.5",result:"blur"}),ra.default.createElement("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7",result:"glow"}),ra.default.createElement("feComposite",{in:"SourceGraphic",in2:"glow",operator:"over"}))),ra.default.createElement(zo,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),ra.default.createElement(Xa,{y:0,stroke:"var(--text-normal, #888888)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1.5,ifOverflow:"hidden"}),ra.default.createElement(jo,{dataKey:"name",style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:s?4:8,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5},tickFormatter:b=>kGe(b,l),interval:0,angle:s?-35:0,textAnchor:s?"end":"middle",height:s?45:25}),ra.default.createElement(_o,{tickFormatter:b=>{if(!o)return ye(b,!0,a,!1,void 0);if(!c||Math.abs(c.pnl)<wGe||!c.totalRMultiple)return ye(b,!0,a,!0,void 0);let x=b/c.pnl*c.totalRMultiple;return ye(b,!0,a,!0,x)},style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:p,allowDataOverflow:!1,width:g,ticks:m,scale:"linear",tickLine:!1,axisLine:!1,tickMargin:5}),ra.default.createElement(ho,{content:ra.default.createElement(TGe,{plugin:i}),cursor:{fill:"var(--interactive-hover)",fillOpacity:.1,strokeOpacity:.3,strokeWidth:1,stroke:"var(--interactive-accent)"},wrapperStyle:{zIndex:1e3}}),ra.default.createElement(Yh,{dataKey:"pnl",fill:"var(--interactive-accent)",minPointSize:0,isAnimationActive:!0,animationDuration:800,animationEasing:"ease-out",stroke:"var(--background-primary)",strokeWidth:.8,strokeOpacity:.5,filter:"url(#setup-bar-shadow)",radius:[2,2,0,0],activeBar:{filter:"url(#setup-bar-glow)",strokeWidth:1.2,strokeOpacity:.8},shape:b=>{let k=b.payload&&b.payload.pnl>=0,x=k?"var(--chart-positive)":"var(--chart-negative)",{x:S,y:w,width:C,height:D}=b,P=S||0,M=w||0,z=C||0,A=D||0,I=A<0?Math.abs(A):A,L=A<0?M+A:M,E=k?[2,2,0,0]:[0,0,2,2];return ra.default.createElement("rect",{x:P,y:L,width:z,height:I>0?I:0,fill:x,stroke:b.stroke,strokeWidth:b.strokeWidth,strokeOpacity:b.strokeOpacity,filter:b.filter,rx:E[0],ry:E[0]})}})))}});function PGe(e){if(!e)return!1;let t=new Date,r=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`;return e===r}var Cr,xye,NF,CGe,wye=F(()=>{Cr=Y(Q());nr();qt();yy();JT();Er();Vo();xye=(0,Cr.memo)(({day:e,dayIndex:t,onClick:r,displayRMultiples:n})=>{var s;let{currency:i}=ct(),a=(0,Cr.useCallback)(()=>{e.date&&r(e.date)},[e.date,r]),o=["journalit-dashboard-calendar-day",e.currentMonth?"current-month":"other-month",e.pnl!==null&&e.pnl>0?"positive":"",e.pnl!==null&&e.pnl<0?"negative":"",t===5||t===6?"weekend-day":"",e.isToday?"today":""].filter(Boolean).join(" ");return Cr.default.createElement("div",{className:o,onClick:a},Cr.default.createElement("div",{className:"journalit-dashboard-calendar-day-number"},e.dayNumber||""),e.pnl!==null&&Cr.default.createElement("div",{className:"journalit-dashboard-calendar-day-pnl"},ye(e.pnl,!1,i,n,(s=e.rMultiple)!=null?s:void 0)),e.tradeCount>0&&Cr.default.createElement("div",{className:"journalit-dashboard-calendar-day-trades"},e.tradeCount===1?"1 trade":`${e.tradeCount} trades`))});xye.displayName="CalendarDay";NF=(0,Cr.memo)(({trades:e,filters:t,onDayClick:r,onWeekClick:n,height:i="100%"})=>{var x,S,w,C,D,P,M,z,A;let a=Ae(),{currency:o}=ct(),s=(0,Cr.useMemo)(()=>{var I,L,E;return(E=(L=(I=a==null?void 0:a.settings)==null?void 0:I.trade)==null?void 0:L.skipWeekends)!=null?E:!0},[(S=(x=a==null?void 0:a.settings)==null?void 0:x.trade)==null?void 0:S.skipWeekends]),l=(D=(C=(w=a==null?void 0:a.settings)==null?void 0:w.trade)==null?void 0:C.showCopyTradingPnL)!=null?D:!1,c=(0,Cr.useMemo)(()=>{var I,L,E;return(E=(L=(I=a==null?void 0:a.settings)==null?void 0:I.trade)==null?void 0:L.displayRMultiples)!=null?E:!1},[(M=(P=a==null?void 0:a.settings)==null?void 0:P.trade)==null?void 0:M.displayRMultiples]),d=(0,Cr.useMemo)(()=>{var I,L;return(L=(I=a==null?void 0:a.settings)==null?void 0:I.trade)==null?void 0:L.defaultRiskAmount},[(A=(z=a==null?void 0:a.settings)==null?void 0:z.trade)==null?void 0:A.defaultRiskAmount]),u=(0,Cr.useRef)(null);(0,Cr.useEffect)(()=>{let I=null;return I=requestAnimationFrame(()=>{u.current&&(Object.assign(u.current.style,{width:"100%",height:"100%"}),KT(),Ld(),YT())}),()=>{I!==null&&cancelAnimationFrame(I),window.__journalitCalendarResizeObserver&&window.__journalitCalendarResizeObserver.disconnect()}},[]),(0,Cr.useEffect)(()=>{let I=()=>{u.current&&Ld()};return document.addEventListener("layout-changed",I),()=>{document.removeEventListener("layout-changed",I)}},[]);let p={},m={},g={};e.forEach(I=>{let L;try{if(I.entryTime instanceof Date)L=I.entryTime;else if(L=new Date(I.entryTime),isNaN(L.getTime()))return}catch(j){return}if(vy(I))return;let E=I;if(E.isMissedTrade===!0||E.isBacktestTrade===!0||!I.instrument)return;let T=L.getFullYear(),$=String(L.getMonth()+1).padStart(2,"0"),_=String(L.getDate()).padStart(2,"0"),B=`${T}-${$}-${_}`;p[B]||(p[B]=0,m[B]=0,g[B]=0);let W=rn(I),N=tn(I.pnl,W,l);p[B]+=N,m[B]++;let U=xt(N,I.rMultiple,I.riskAmount,d);U!==void 0&&!isNaN(U)&&(g[B]+=U)});let{gridStartDate:f,gridEndDate:v}=(0,Cr.useMemo)(()=>{var _,B,W,N,U;let I,L,E=new Date,T=E.getFullYear(),$=E.getMonth();return!((_=t==null?void 0:t.dateRange)!=null&&_[0])&&!((B=t==null?void 0:t.dateRange)!=null&&B[1])?(I=new Date(T,$,1),L=new Date(T,$+1,0)):(W=t==null?void 0:t.dateRange)!=null&&W[0]&&t.dateRange[0].getFullYear()===T&&t.dateRange[0].getMonth()===0&&t.dateRange[0].getDate()===1?(I=new Date(T,0,1),L=new Date(T,11,31)):(I=((N=t==null?void 0:t.dateRange)==null?void 0:N[0])||(e.length>0?new Date(Math.min(...e.map(j=>{let R=j.entryTime instanceof Date?j.entryTime:new Date(j.entryTime);return isNaN(R.getTime())?Date.now():R.getTime()}))):E),L=((U=t==null?void 0:t.dateRange)==null?void 0:U[1])||E),I>L&&(I=new Date(L),I.setDate(1),console.warn("Calendar: Corrected invalid date range where start date was after end date.")),{gridStartDate:I,gridEndDate:L}},[t==null?void 0:t.dateRange,e]),h=CGe(f,v,p,m,g),y=(0,Cr.useMemo)(()=>f.getFullYear()!==v.getFullYear()?!0:f.getMonth()!==v.getMonth(),[f,v]),b=I=>{var E;let L=`${I.getFullYear()}-${String(I.getMonth()+1).padStart(2,"0")}-${String(I.getDate()).padStart(2,"0")}`;p[L]&&r?r(I):p[L]&&a&&((E=a.drcService)==null||E.openDRC(I))},k=I=>{if(n)n(I);else if(a){let L=I;a.weeklyReviewService?a.weeklyReviewService.openWeeklyReview(L):a.drcService&&(console.warn("WeeklyReviewService not found, falling back to DRCService"),a.drcService.openDRC(L))}};return Cr.default.createElement("div",{ref:u,className:"journalit-dashboard-calendar",style:{width:"100%",height:i,overflow:"auto",backdropFilter:"none",WebkitBackdropFilter:"none"}},Cr.default.createElement("div",{style:{display:"flex",flexDirection:"column",animation:"calendarFadeIn 0.5s ease-out",padding:"0 6px 6px 0",minHeight:"100%"}},Cr.default.createElement("div",{className:`journalit-dashboard-calendar-header ${s?"hide-weekends":""}`,style:{display:"grid",gridTemplateColumns:s?"repeat(5, 1fr) 1fr":"repeat(7, 1fr) 1fr",marginBottom:"10px",gap:"4px",position:"sticky",top:0,backgroundColor:"var(--background-primary)",zIndex:5,padding:"6px 0",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)",borderBottom:"1px solid var(--background-modifier-border)",borderRadius:"6px"}},Cr.default.createElement("div",{className:"journalit-dashboard-calendar-weekday monday-header","data-day":"Mon",style:{textAlign:"center",fontWeight:600,fontSize:"13px",color:"var(--text-muted)",display:"block !important",letterSpacing:"0.5px"}},"Mon"),Cr.default.createElement("div",{className:"journalit-dashboard-calendar-weekday","data-day":"Tue",style:{textAlign:"center",fontWeight:600,fontSize:"13px",color:"var(--text-muted)",letterSpacing:"0.5px"}},"Tue"),Cr.default.createElement("div",{className:"journalit-dashboard-calendar-weekday","data-day":"Wed",style:{textAlign:"center",fontWeight:500,fontSize:"12px",color:"var(--text-muted)"}},"Wed"),Cr.default.createElement("div",{className:"journalit-dashboard-calendar-weekday","data-day":"Thu",style:{textAlign:"center",fontWeight:500,fontSize:"12px",color:"var(--text-muted)"}},"Thu"),Cr.default.createElement("div",{className:"journalit-dashboard-calendar-weekday","data-day":"Fri",style:{textAlign:"center",fontWeight:500,fontSize:"12px",color:"var(--text-muted)"}},"Fri"),!s&&Cr.default.createElement("div",{className:"journalit-dashboard-calendar-weekday","data-day":"Sat",style:{textAlign:"center",fontWeight:500,fontSize:"12px",color:"var(--text-muted)"}},"Sat"),!s&&Cr.default.createElement("div",{className:"journalit-dashboard-calendar-weekday","data-day":"Sun",style:{textAlign:"center",fontWeight:500,fontSize:"12px",color:"var(--text-muted)"}},"Sun"),Cr.default.createElement("div",{className:"journalit-dashboard-calendar-weekday weekly-pnl-header",style:{textAlign:"center",fontWeight:700,fontSize:"13px",color:"var(--text-on-accent)",backgroundColor:"var(--interactive-accent)",borderLeft:"1px solid rgba(0, 0, 0, 0.05)",borderRadius:"0 6px 6px 0",boxShadow:"inset 0 0 0 1px rgba(0, 0, 0, 0.1)"}},"P&L")),Cr.default.createElement("div",{className:`journalit-dashboard-calendar-grid ${s?"hide-weekends":""}`,style:{display:"flex",flexDirection:"column",gap:"4px",flex:"1"}},h.filter(I=>s?I.some((E,T)=>T<=4&&E.date!==null):!0).map((I,L,E)=>{var j,R,O;let T=null;if(y){let H=(j=I.find(q=>q.date))==null?void 0:j.date;if(H){let q=H.getMonth(),V=H.getFullYear(),J=!1;if(L===0)J=!0;else{let G=(R=E[L-1].find(X=>X.date))==null?void 0:R.date;if(G){let X=G.getMonth(),te=G.getFullYear();(q!==X||V!==te)&&(J=!0)}}J&&(T=`${["January","February","March","April","May","June","July","August","September","October","November","December"][q]} ${V}`)}}let $=0,_=0,B=0,W="",N=0,U=(O=I.find(H=>H.date))==null?void 0:O.date;if(U){let H=new Date(U.getFullYear(),0,4),q=new Date(H.getFullYear(),0,1),V=Math.floor((U.getTime()-q.getTime())/864e5);W=`W${Math.ceil((V+q.getDay()+1)/7)}`}return I.forEach(H=>{H.pnl!==null&&($+=H.pnl,B++),H.tradeCount>0&&(_+=H.tradeCount),H.rMultiple!==null&&(N+=H.rMultiple)}),Cr.default.createElement(Cr.default.Fragment,{key:`week-${L}`},T&&Cr.default.createElement("div",{className:"journalit-dashboard-calendar-month-label"},T),Cr.default.createElement("div",{className:`journalit-dashboard-calendar-week ${s?"hide-weekends":""}`,style:{display:"grid",gridTemplateColumns:s?"repeat(5, 1fr) 1fr":"repeat(7, 1fr) 1fr",gap:"4px",marginBottom:"4px"}},(s?I.filter((H,q)=>q<=4):I).map((H,q)=>Cr.default.createElement(xye,{key:`day-${L}-${q}`,day:H,dayIndex:q,onClick:b,displayRMultiples:c})),Cr.default.createElement("div",{className:`journalit-dashboard-calendar-weekly-pnl ${B>0?$>=0?"positive":"negative":""}`,onClick:()=>U&&k(U)},B>0&&Cr.default.createElement(Cr.default.Fragment,null,Cr.default.createElement("div",{className:"journalit-dashboard-calendar-week-total-label"},"WEEK"),Cr.default.createElement("div",{className:"journalit-dashboard-calendar-week-total-value"},ye($,!1,o,c,N)),_>0&&Cr.default.createElement("div",{className:"journalit-dashboard-calendar-week-trade-count"},_===1?"1 trade":`${_} trades`)))))}))))});NF.displayName="PerformanceCalendar";CGe=(e,t,r,n,i)=>{let a=[],o=new Date(e);o.setDate(1);let s=new Date(t.getFullYear(),t.getMonth()+1,0);for(;o<=s;){let l=o.getFullYear(),c=o.getMonth(),u=(new Date(l,c,1).getDay()+6)%7,m=new Date(l,c+1,0).getDate(),g=1,f=[];for(;g<=m;){let v=[];for(let h=0;h<7;h++)if(g===1&&h<u||g>m)v.push({dayNumber:0,date:null,currentMonth:!1,pnl:null,tradeCount:0,isToday:!1,rMultiple:null});else{let y=new Date(l,c,g),b=`${l}-${String(c+1).padStart(2,"0")}-${String(g).padStart(2,"0")}`;v.push({dayNumber:g,date:y,currentMonth:!0,pnl:r[b]||null,tradeCount:n[b]||0,isToday:PGe(b),rMultiple:i[b]||null}),g++}f.push(v)}a.push(...f),o.setMonth(o.getMonth()+1)}return a}});var Lt,kye,DGe,GH,YH=F(()=>{Lt=Y(Q()),kye=Y(Td());Er();qt();Oa();nr();Vo();DGe=({trades:e,year:t=new Date().getFullYear(),onDayClick:r,height:n="100%",maxWeeks:i,rollingMode:a=!1})=>{var _,B,W,N,U,j,R;let{currency:o}=ct(),s=Ae(),l=(B=(_=s==null?void 0:s.settings)==null?void 0:_.trade)==null?void 0:B.defaultRiskAmount,c=(U=(N=(W=s==null?void 0:s.settings)==null?void 0:W.trade)==null?void 0:N.showCopyTradingPnL)!=null?U:!1,[d,u]=(0,Lt.useState)({isVisible:!1,position:{top:-9999,left:-9999},content:null}),[p,m]=(0,Lt.useState)(!1),g=(0,Lt.useRef)(null),f=(0,Lt.useRef)(null),v=(0,Lt.useRef)(null),h=(0,Lt.useRef)(null),y=(0,Lt.useRef)(0),b=(0,Lt.useRef)(!1),k=(0,Lt.useRef)({x:0,y:0}),x=25,S=(0,Lt.useRef)(null),w=(0,Lt.useMemo)(()=>{if(!a||!i)return null;let O=new Date,H=new Date(O);H.setHours(23,59,59,999);let q=new Date(O);return q.setDate(q.getDate()-(i*7-1)),q.setHours(0,0,0,0),{startDate:q,endDate:H}},[a,i]),{dailyData:C,maxAbsPnL:D}=(0,Lt.useMemo)(()=>{let O={};e.forEach(q=>{if(!q.pnl)return;let V=new Date(q.entryTime);if(a&&w){if(V<w.startDate||V>w.endDate)return}else if(V.getFullYear()!==t)return;let J=mc(V,s);O[J]||(O[J]={pnl:0,count:0,rMultiple:0});let K=rn(q),G=tn(q.pnl,K,c);O[J].pnl+=G,O[J].count+=1;let X=xt(G,q.rMultiple,q.riskAmount,l);X!==void 0&&!isNaN(X)&&(O[J].rMultiple+=X)});let H=Math.max(...Object.values(O).map(q=>Math.abs(q.pnl)),1);return{dailyData:O,maxAbsPnL:H}},[e,t,l,c,a,w]),P=(0,Lt.useMemo)(()=>{let O,H;a&&w?(O=w.startDate,H=w.endDate):(O=new Date(t,0,1),H=new Date(t,11,31));let q=new Date(O),J=(q.getDay()+6)%7;q.setDate(q.getDate()-J);let K=[],G=new Date(q);for(;G<=H||K.length===0||K[K.length-1].days.length<7;){let X={days:[]};for(let te=0;te<7;te++){let re=G.getFullYear(),Z=String(G.getMonth()+1).padStart(2,"0"),ne=String(G.getDate()).padStart(2,"0"),se=`${re}-${Z}-${ne}`,ee=C[se],ie=a&&w?G>=w.startDate&&G<=w.endDate:G.getFullYear()===t,ve=(ee==null?void 0:ee.pnl)||0,Se=(ee==null?void 0:ee.count)||0,Me=ee==null?void 0:ee.rMultiple,le=0;if(ve!==0&&ie){let Ye=Math.abs(ve)/D;le=Math.min(Math.ceil(Ye*4),4)}X.days.push({date:new Date(G),dateString:se,pnl:ve,tradeCount:Se,intensity:le,isEmpty:!ie||Se===0,rMultiple:Me}),G.setDate(G.getDate()+1)}if(K.push(X),a){if(G>H&&K[K.length-1].days.length===7)break}else if(G.getFullYear()>t&&K.length>=53)break}return K},[C,D,t,a,w]),M=(0,Lt.useMemo)(()=>{if(a)return P;let O=i&&Number.isFinite(i)&&i>0?i:void 0;return!O||P.length<=O?P:P.slice(-O)},[P,i,a]),z=(0,Lt.useMemo)(()=>{if(M.length===0)return[];let O=[],H="",q=0,V=0,J=-1,K=-1;return M.forEach((G,X)=>{let te=G.days.find(se=>a&&w?se.date>=w.startDate&&se.date<=w.endDate:se.date.getFullYear()===t)||G.days[0],re=te.date.getMonth(),Z=te.date.getFullYear(),ne=`${Z}-${re}`;ne!==H?(H!==""&&O.push({month:J,year:K,startWeekIndex:V,weekCount:q}),H=ne,J=re,K=Z,V=X,q=1):q++}),H!==""&&O.push({month:J,year:K,startWeekIndex:V,weekCount:q}),O},[M,a,w,t]),A=(0,Lt.useCallback)(O=>{if(O.isEmpty||O.tradeCount===0)return"var(--heatmap-empty)";if(O.pnl>0)switch(O.intensity){case 1:return"var(--heatmap-profit-1)";case 2:return"var(--heatmap-profit-2)";case 3:return"var(--heatmap-profit-3)";case 4:return"var(--heatmap-profit-4)";default:return"var(--heatmap-empty)"}else switch(O.intensity){case 1:return"var(--heatmap-loss-1)";case 2:return"var(--heatmap-loss-2)";case 3:return"var(--heatmap-loss-3)";case 4:return"var(--heatmap-loss-4)";default:return"var(--heatmap-empty)"}},[]),I=(0,Lt.useCallback)(O=>{O.tradeCount>0&&r&&r(O.date)},[r]),L=(0,Lt.useCallback)(O=>{if(!v.current)return{top:-9999,left:-9999};let H=v.current;if(!H||!H.offsetParent){let We=window.innerWidth,Ke=window.innerHeight,Ze=O.clientX+20,St=O.clientY-10;return Ze+180>We-16&&(Ze=O.clientX-180-20),St+100>Ke-16&&(St=O.clientY-100-10),Ze=Math.max(16,Math.min(Ze,We-180-16)),St=Math.max(16,Math.min(St,Ke-100-16)),{top:St,left:Ze}}let q=H.getBoundingClientRect(),V=window.innerWidth,J=window.innerHeight,K=16,G=20,X=10,te=25,re=O.clientX,Z=O.clientY,ne=q.width,se=q.height,ee=re+G,ie=Z+X;ee+ne>V-K&&(ee=re-ne-G),ie+se>J-K&&(ie=Z-se-X),ee+ne>V-K&&ie+se>J-K&&(ee=re-ne-G,ie=Z-se-X),ee<K&&(ee=K,Math.abs(ee+ne/2-re)<te&&(ie>Z?ie=Math.max(Z+te,ie):ie=Math.min(Z-te-se,ie))),ie<K&&(ie=K,Math.abs(ie+se/2-Z)<te&&(ee>re?ee=Math.max(re+te,ee):ee=Math.min(re-te-ne,ee)));let ve=ee+ne/2,Se=ie+se/2;return Math.sqrt(Math.pow(ve-re,2)+Math.pow(Se-Z,2))<te&&(re<V/2&&Z<J/2?(ee=Math.min(re+te,V-ne-K),ie=Math.min(Z+te,J-se-K)):re>=V/2&&Z<J/2?(ee=Math.max(re-ne-te,K),ie=Math.min(Z+te,J-se-K)):re<V/2&&Z>=J/2?(ee=Math.min(re+te,V-ne-K),ie=Math.max(Z-se-te,K)):(ee=Math.max(re-ne-te,K),ie=Math.max(Z-se-te,K))),ee=Math.max(K,Math.min(ee,V-ne-K)),ie=Math.max(K,Math.min(ie,J-se-K)),isNaN(ee)||isNaN(ie)?{top:Math.max(Z+X,K),left:Math.max(re+G,K)}:{top:ie,left:ee}},[]),E=(0,Lt.useCallback)((O,H)=>{f.current&&(clearTimeout(f.current),f.current=null),g.current&&clearTimeout(g.current);let q=H.date.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric",year:"numeric"});S.current={clientX:O.clientX,clientY:O.clientY},u({isVisible:!1,position:{top:-9999,left:-9999},content:{date:q,pnl:H.pnl,tradeCount:H.tradeCount,isEmpty:H.isEmpty||H.tradeCount===0,rMultiple:H.rMultiple}}),m(!0),k.current={x:O.clientX,y:O.clientY},g.current=setTimeout(()=>{let V=L(O);u(J=>({...J,isVisible:!0,position:V}))},100)},[L]),T=(0,Lt.useCallback)(()=>{g.current&&(clearTimeout(g.current),g.current=null),h.current&&(cancelAnimationFrame(h.current),h.current=null),S.current=null,u(O=>({...O,isVisible:!1})),f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{m(!1),f.current=null},200)},[]),$=(0,Lt.useCallback)(O=>{if(!d.isVisible||!p)return;let H=O.clientX,q=O.clientY;if(Math.sqrt(Math.pow(H-k.current.x,2)+Math.pow(q-k.current.y,2))<x)return;let J=Date.now(),K=J-y.current;if(K<32&&!b.current)b.current=!0,h.current&&cancelAnimationFrame(h.current),h.current=requestAnimationFrame(()=>{let G=L(O);u(X=>({...X,position:G})),y.current=Date.now(),k.current={x:H,y:q},b.current=!1});else if(K>=32){let G=L(O);u(X=>({...X,position:G})),y.current=J,k.current={x:H,y:q}}},[d.isVisible,p,L,x]);return(0,Lt.useLayoutEffect)(()=>{if(d.isVisible&&v.current&&S.current){let O=requestAnimationFrame(()=>{if(v.current&&S.current){let H=L(S.current);(H.top!==d.position.top||H.left!==d.position.left)&&u(q=>({...q,position:H}))}});return()=>cancelAnimationFrame(O)}},[d.isVisible,L]),(0,Lt.useEffect)(()=>()=>{g.current&&clearTimeout(g.current),f.current&&clearTimeout(f.current),h.current&&cancelAnimationFrame(h.current)},[]),Lt.default.createElement(Lt.default.Fragment,null,Lt.default.createElement("style",null,`
        :root {
          /* Premium heatmap color palette */
          --heatmap-empty: rgba(var(--background-modifier-border-rgb, 55, 53, 47), 0.12);
          --heatmap-empty-hover: rgba(var(--background-modifier-border-rgb, 55, 53, 47), 0.18);
          
          /* Sophisticated profit gradient - emerald tones */
          --heatmap-profit-1: rgba(16, 185, 129, 0.15);
          --heatmap-profit-2: rgba(16, 185, 129, 0.35);
          --heatmap-profit-3: rgba(16, 185, 129, 0.65);
          --heatmap-profit-4: rgba(5, 150, 105, 0.85);
          
          /* Elegant loss gradient - rose tones */
          --heatmap-loss-1: rgba(239, 68, 68, 0.15);
          --heatmap-loss-2: rgba(239, 68, 68, 0.35);
          --heatmap-loss-3: rgba(239, 68, 68, 0.65);
          --heatmap-loss-4: rgba(220, 38, 38, 0.85);
          
          /* Premium typography */
          --heatmap-text-primary: var(--text-normal);
          --heatmap-text-secondary: var(--text-muted);
          --heatmap-font-weight-medium: 500;
          --heatmap-font-weight-semibold: 600;
          
          /* Smooth animations */
          --heatmap-transition-quick: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
          --heatmap-transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
          --heatmap-shadow-subtle: 0 1px 2px rgba(0, 0, 0, 0.05);
          --heatmap-shadow-elevated: 0 4px 12px rgba(0, 0, 0, 0.12);
        }
        
        .heatmap-container {
          --padding-horizontal: 16px;
          --padding-vertical: 12px;
          --cell-size: 11px;
          --cell-gap: 3px;
          --border-radius-cell: 2px;
          --border-radius-container: 8px;
        }
        
        .heatmap-cell {
          width: var(--cell-size);
          height: var(--cell-size);
          border-radius: var(--border-radius-cell);
          transition: var(--heatmap-transition-quick);
          position: relative;
          overflow: hidden;
        }
        
        .heatmap-cell::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 50%, transparent 100%);
          opacity: 0;
          transition: var(--heatmap-transition-quick);
        }
        
        .heatmap-cell:hover::before {
          opacity: 1;
        }
        
        .heatmap-cell:hover {
          transform: scale(1.15);
          box-shadow: var(--heatmap-shadow-elevated);
          z-index: 10;
        }
        
        .heatmap-cell.clickable {
          cursor: pointer;
        }
        
        .heatmap-cell.clickable:active {
          transform: scale(1.05);
        }
        
        .heatmap-month-label {
          font-size: 11px;
          font-weight: var(--heatmap-font-weight-medium);
          color: var(--heatmap-text-secondary);
          letter-spacing: 0.025em;
        }
        
        .heatmap-day-label {
          font-size: 9px;
          font-weight: var(--heatmap-font-weight-medium);
          color: var(--heatmap-text-secondary);
          letter-spacing: 0.05em;
          text-transform: uppercase;
        }
        
        .heatmap-legend {
          font-size: 10px;
          font-weight: var(--heatmap-font-weight-medium);
          color: var(--heatmap-text-secondary);
          letter-spacing: 0.025em;
        }
        
        .heatmap-legend-cell {
          width: 10px;
          height: 10px;
          border-radius: var(--border-radius-cell);
          transition: var(--heatmap-transition-quick);
        }
        
        .heatmap-legend-cell:hover {
          transform: scale(1.1);
          box-shadow: var(--heatmap-shadow-subtle);
        }
        
        /* Professional Heatmap Tooltip Styles */
        .journalit-heatmap-tooltip {
          background-color: var(--background-primary);
          border-radius: 10px;
          padding: 14px 18px;
          min-width: 140px;
          border: 1px solid var(--background-modifier-border);
          box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
          position: relative;
          z-index: 10000;
        }
        
        .heatmap-tooltip-date {
          font-size: 14px;
          font-weight: 500;
          color: var(--text-normal);
          margin-bottom: 8px;
          text-align: center;
          border-bottom: 1px solid var(--background-modifier-border);
          padding-bottom: 6px;
        }
        
        .heatmap-tooltip-value {
          font-size: 20px;
          font-weight: 600;
          text-align: center;
          margin-bottom: 4px;
        }
        
        .heatmap-tooltip-value.positive {
          color: var(--chart-positive);
        }
        
        .heatmap-tooltip-value.negative {
          color: var(--chart-negative);
        }
        
        .heatmap-tooltip-info {
          font-size: 12px;
          color: var(--text-muted);
          text-align: center;
          font-style: italic;
        }
        
        @media (prefers-reduced-motion: reduce) {
          .heatmap-cell,
          .heatmap-legend-cell {
            transition: none;
          }
          
          .heatmap-cell:hover {
            transform: none;
          }
          
          .heatmap-legend-cell:hover {
            transform: none;
          }
          
          .journalit-heatmap-tooltip {
            transition: none !important;
          }
        }
      `),Lt.default.createElement("div",{className:"contributions-heatmap heatmap-container",style:{height:n,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"var(--padding-vertical) var(--padding-horizontal)",background:"transparent"}},Lt.default.createElement("div",{style:{display:"flex",marginBottom:"12px",width:"100%",maxWidth:`${M.length*14}px`,paddingLeft:"32px"}},z.map((O,H)=>Lt.default.createElement("div",{key:`${O.year}-${O.month}-${H}`,className:"heatmap-month-label",style:{flex:`0 0 ${O.weekCount*14}px`,textAlign:"left",paddingLeft:"2px"}},new Date(O.year,O.month,1).toLocaleDateString("en-US",{month:"short"})))),Lt.default.createElement("div",{style:{display:"flex",alignItems:"flex-start",gap:"10px"}},Lt.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"var(--cell-gap)",paddingTop:"1px"}},Lt.default.createElement("div",{className:"heatmap-day-label",style:{height:"var(--cell-size)"}},"Mon"),Lt.default.createElement("div",{style:{height:"var(--cell-size)"}}),Lt.default.createElement("div",{className:"heatmap-day-label",style:{height:"var(--cell-size)"}},"Wed"),Lt.default.createElement("div",{style:{height:"var(--cell-size)"}}),Lt.default.createElement("div",{className:"heatmap-day-label",style:{height:"var(--cell-size)"}},"Fri"),Lt.default.createElement("div",{style:{height:"var(--cell-size)"}}),Lt.default.createElement("div",{className:"heatmap-day-label",style:{height:"var(--cell-size)"}},"Sun")),Lt.default.createElement("div",{style:{display:"flex",gap:"var(--cell-gap)"}},M.map((O,H)=>Lt.default.createElement("div",{key:H,style:{display:"flex",flexDirection:"column",gap:"var(--cell-gap)"}},O.days.map((q,V)=>Lt.default.createElement("div",{key:`${H}-${V}`,className:`heatmap-cell ${q.tradeCount>0?"clickable":""}`,onClick:()=>I(q),onMouseEnter:J=>E(J,q),onMouseLeave:T,onMouseMove:$,style:{backgroundColor:A(q),border:q.isEmpty?"none":"1px solid rgba(var(--background-modifier-border-rgb, 55, 53, 47), 0.08)"}})))))),Lt.default.createElement("div",{style:{display:"flex",alignItems:"center",marginTop:"16px",gap:"8px"}},Lt.default.createElement("span",{className:"heatmap-legend"},"Less"),Lt.default.createElement("div",{style:{display:"flex",gap:"var(--cell-gap)"}},Lt.default.createElement("div",{className:"heatmap-legend-cell",style:{backgroundColor:"var(--heatmap-empty)"}}),Lt.default.createElement("div",{className:"heatmap-legend-cell",style:{backgroundColor:"var(--heatmap-profit-1)"}}),Lt.default.createElement("div",{className:"heatmap-legend-cell",style:{backgroundColor:"var(--heatmap-profit-2)"}}),Lt.default.createElement("div",{className:"heatmap-legend-cell",style:{backgroundColor:"var(--heatmap-profit-3)"}}),Lt.default.createElement("div",{className:"heatmap-legend-cell",style:{backgroundColor:"var(--heatmap-profit-4)"}})),Lt.default.createElement("span",{className:"heatmap-legend"},"More"))),p&&d.content&&(0,kye.createPortal)(Lt.default.createElement("div",{ref:v,className:"journalit-heatmap-tooltip",style:{position:"fixed",top:`${d.position.top}px`,left:`${d.position.left}px`,zIndex:1e4,opacity:d.isVisible?1:0,transform:d.isVisible?"translateY(-4px)":"translateY(0)",transition:"opacity 0.2s cubic-bezier(0.4, 0, 0.2, 1), transform 0.2s cubic-bezier(0.4, 0, 0.2, 1)",pointerEvents:"none"}},Lt.default.createElement("div",{className:"heatmap-tooltip-date"},d.content.date),!d.content.isEmpty&&Lt.default.createElement("div",{className:`heatmap-tooltip-value ${d.content.pnl>0?"positive":d.content.pnl<0?"negative":""}`},ye(d.content.pnl,!0,o,(R=(j=s==null?void 0:s.settings)==null?void 0:j.trade)==null?void 0:R.displayRMultiples,d.content.rMultiple)),Lt.default.createElement("div",{className:"heatmap-tooltip-info"},d.content.isEmpty?"No trades":`${d.content.tradeCount} trade${d.content.tradeCount===1?"":"s"}`)),document.body))},GH=Lt.default.memo(DGe)});function KH(e,t){return r=>{var l,c;let{trades:n,dateFormat:i="MMM DD, YYYY",...a}=r,o=Ae(),s=(c=(l=o==null?void 0:o.settings)==null?void 0:l.trade)==null?void 0:c.defaultRiskAmount;if(!n||n.length===0)switch(t){case"pnl":return eg.default.createElement(e,{data:[],plugin:o,...a});case"drawdown":return eg.default.createElement(e,{data:[],plugin:o,...a});case"trades":return eg.default.createElement(e,{data:[],plugin:o,...a});default:return eg.default.createElement(e,{data:[],plugin:o,...a})}switch(t){case"pnl":let d=Np(n,i,s);return eg.default.createElement(e,{data:d,plugin:o,...a});case"drawdown":let u=ay(n,i,s);return eg.default.createElement(e,{data:u,plugin:o,...a});case"trades":let p=OT(n,s);return eg.default.createElement(e,{data:p,plugin:o,...a});default:return eg.default.createElement(e,{data:[],plugin:o,...a})}}}var eg,Sye=F(()=>{eg=Y(Q());Ll();nr()});var uu=F(()=>{UH();HH();yye();bye();VH();wye();YH();Sye();Ll()});var FF,Tye,Cye=F(()=>{FF=Y(Q());Sf();uu();nr();Tye=FF.default.memo(({filters:e,dateFormat:t})=>{var i,a;let r=Ae(),n=(a=(i=r==null?void 0:r.settings)==null?void 0:i.trade)==null?void 0:a.defaultRiskAmount;return FF.default.createElement(cl,{filters:e,dateFormat:t},(o,s)=>{let l=Np(o.trades,s,n),c=o.metrics.isMultiCurrency?o.metrics.conversionBaseCurrency:void 0;return FF.default.createElement(Zf,{data:l,plugin:r,currencyOverride:c,onPointClick:(d,u)=>{}})})})});var JH,Pye,Dye=F(()=>{JH=Y(Q());Sf();uu();Pye=({filters:e})=>JH.default.createElement(cl,{filters:e},t=>JH.default.createElement(NF,{trades:t.trades,filters:e}))});var Ql,Eye,Iye,Mye=F(()=>{Ql=Y(Q());_t();qt();Sf();uu();nr();Eye=[10,20,30,50],Iye=Ql.default.memo(({filters:e,dateFormat:t})=>{let r=Ae(),[n,i]=(0,Ql.useState)(20);return(0,Ql.useEffect)(()=>{Promise.resolve().then(()=>(QT(),MB)).then(({ensureChartStyles:a})=>{a()})},[]),Ql.default.createElement(cl,{filters:e,dateFormat:t},(a,o)=>{var p,m;let s=(m=(p=r==null?void 0:r.settings)==null?void 0:p.trade)==null?void 0:m.defaultRiskAmount,l={};a.trades.forEach(g=>{let f=g.entryTime instanceof Date?g.entryTime:new Date(g.entryTime),v=f.getFullYear(),h=String(f.getMonth()+1).padStart(2,"0"),y=String(f.getDate()).padStart(2,"0"),b=`${v}-${h}-${y}`;l[b]||(l[b]={pnl:0,trades:0,rMultiple:0}),l[b].pnl+=g.pnl,l[b].trades+=1;let k=xt(g.pnl,g.rMultiple,g.riskAmount,s);k!==void 0&&!isNaN(k)&&(l[b].rMultiple+=k)});let c=Object.entries(l).map(([g,f])=>({date:zt(new Date(g),o),originalDate:g,pnl:f.pnl,trades:f.trades,rMultiple:f.rMultiple,fill:f.pnl>=0?"var(--chart-positive)":"var(--chart-negative)"}));c.sort((g,f)=>new Date(g.originalDate).getTime()-new Date(f.originalDate).getTime());let d=c.slice(-n),u=a.metrics.isMultiCurrency?a.metrics.conversionBaseCurrency:void 0;return Ql.default.createElement("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",position:"relative"}},Ql.default.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"8px 12px",borderBottom:"1px solid var(--background-modifier-border)",position:"relative"}},Ql.default.createElement("div",{style:{fontWeight:500,fontSize:"13px",color:"var(--text-muted)",letterSpacing:"0.3px",textAlign:"center"}},"Daily Performance"),Ql.default.createElement("div",{style:{position:"absolute",right:"12px",display:"flex",alignItems:"center"}},Ql.default.createElement("select",{"aria-label":"Period",value:n,onChange:g=>{let f=Number(g.target.value);Eye.includes(f)&&i(f)},style:{padding:"4px 8px",fontSize:"11px",fontWeight:500,color:"var(--text-normal)",backgroundColor:"var(--background-primary)",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",cursor:"pointer"}},Eye.map(g=>Ql.default.createElement("option",{key:g,value:g},g," Days"))))),Ql.default.createElement("div",{style:{flex:1,width:"100%",minHeight:0}},Ql.default.createElement(op,{data:d,currencyOverride:u})))})})});var pu,Aye,Lye,Nye=F(()=>{pu=Y(Q());Sf();uu();nr();Aye=[25,50,75,100],Lye=({filters:e,dateFormat:t})=>{var o,s;let r=Ae(),n=(s=(o=r==null?void 0:r.settings)==null?void 0:o.trade)==null?void 0:s.defaultRiskAmount,[i,a]=(0,pu.useState)(50);return pu.default.createElement(cl,{filters:e,dateFormat:t},(l,c)=>{let p=OT(l.trades,n).slice(-i).map((g,f)=>({...g,tradeIndex:f})),m=l.metrics.isMultiCurrency?l.metrics.conversionBaseCurrency:void 0;return pu.default.createElement("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",position:"relative"}},pu.default.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"8px 12px",borderBottom:"1px solid var(--background-modifier-border)",position:"relative"}},pu.default.createElement("div",{style:{fontWeight:500,fontSize:"13px",color:"var(--text-muted)",letterSpacing:"0.3px",textAlign:"center"}},"Trades"),pu.default.createElement("div",{style:{position:"absolute",right:"12px",display:"flex",alignItems:"center"}},pu.default.createElement("select",{value:i,onChange:g=>{let f=Number(g.target.value);Aye.includes(f)&&a(f)},style:{padding:"4px 8px",fontSize:"11px",fontWeight:500,color:"var(--text-normal)",backgroundColor:"var(--background-primary)",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",cursor:"pointer"}},Aye.map(g=>pu.default.createElement("option",{key:g,value:g},g," Trades"))))),pu.default.createElement("div",{style:{flex:1,width:"100%",minHeight:0}},pu.default.createElement(vP,{data:p,currencyOverride:m,onPointClick:(g,f)=>{g!=null&&g.path},className:"dashboard-trades-chart",style:{boxShadow:"var(--shadow-s)"}})))})}});var OF,Fye,Oye=F(()=>{OF=Y(Q());Sf();uu();nr();Fye=OF.default.memo(({filters:e,dateFormat:t})=>{let r=Ae();return OF.default.createElement(cl,{filters:e,dateFormat:t},(n,i)=>{var s,l;let a=ay(n.trades,i,(l=(s=r==null?void 0:r.settings)==null?void 0:s.trade)==null?void 0:l.defaultRiskAmount),o=n.metrics.isMultiCurrency?n.metrics.conversionBaseCurrency:void 0;return OF.default.createElement(hP,{data:a,plugin:r,currencyOverride:o,showTooltip:!0,tooltipProps:{wrapperStyle:{zIndex:1001}}})})})});var $o,IGe,zye,jye=F(()=>{$o=Y(Q());Sf();qt();nr();Wp();Ol();Jn();Er();_t();Vo();IGe=(e,t)=>{var r,n;try{let i=((n=(r=t==null?void 0:t.settings)==null?void 0:r.trade)==null?void 0:n.dateFormat)||"MMDDYY",a=String(e.getDate()).padStart(2,"0"),o=String(e.getMonth()+1).padStart(2,"0"),l=String(e.getFullYear()).slice(2);switch(i){case"DDMMYY":return`${a}/${o}/${l}`;case"MMDDYY":return`${o}/${a}/${l}`;case"YYMMDD":return`${l}/${o}/${a}`;default:return e.toLocaleDateString()}}catch(i){return e.toLocaleDateString()}},zye=({filters:e})=>{var o,s,l,c,d;let t=Ae(),{currency:r}=ct(),n=(s=(o=t==null?void 0:t.settings)==null?void 0:o.trade)==null?void 0:s.defaultRiskAmount,i=(d=(c=(l=t==null?void 0:t.settings)==null?void 0:l.trade)==null?void 0:c.showCopyTradingPnL)!=null?d:!1,a=u=>{t&&t.openFile(u,!0)};return $o.default.createElement(cl,{filters:e},u=>{let p=[...u.trades].sort((m,g)=>Rc(g.entryTime,m.entryTime)).slice(0,10);return $o.default.createElement("div",{className:"journalit-dashboard-recent-trades"},$o.default.createElement("table",{className:"journalit-dashboard-recent-trades-table"},$o.default.createElement("thead",null,$o.default.createElement("tr",null,$o.default.createElement("th",null,"Date"),$o.default.createElement("th",null,"Ticker"),$o.default.createElement("th",null,"Direction"),$o.default.createElement("th",{className:"pnl-column"},"P&L"))),$o.default.createElement("tbody",null,p.length===0?$o.default.createElement("tr",null,$o.default.createElement("td",{colSpan:4,style:{padding:"20px 0",textAlign:"center",height:"150px",position:"relative"}},$o.default.createElement("div",{style:{position:"absolute",top:"0",left:"0",right:"0",bottom:"0",display:"flex",justifyContent:"center",alignItems:"center"}},$o.default.createElement(yi,{message:"No trades found",subMessage:"Try selecting a different date range",iconSize:32,actionButtonText:"Add Trade",onActionButtonClick:()=>{if(!t||!t.app)return;new Eo({app:t.app,plugin:t}).open()}})))):p.map((m,g)=>{var x,S,w;let f=m.tradeStatus==="CLOSED"?!1:m.tradeStatus==="OPEN"||m._originalPnlWasNull&&!m.tradeStatus?!0:yt({tradeStatus:m.tradeStatus,exitTime:m.exitTime,pnl:m._originalPnlWasNull?null:m.pnl,useDirectPnLInput:m.useDirectPnLInput,exits:m.exits,entries:m.entries}),v=(x=m.pnl)!=null?x:0,h=rn(m),y=tn(v,h,i),b=!f&&y>0,k=!f&&y<0;return $o.default.createElement("tr",{key:`${m.path}-${g}`,onClick:()=>a(m.path),className:`trade-row${f?" open-trade":""}`},$o.default.createElement("td",{className:"date-cell"},IGe(m.entryTime,t)),$o.default.createElement("td",{className:"ticker-cell"},m.instrument||"Unknown"),$o.default.createElement("td",{className:"direction-cell"},m.assetType==="options"&&m.optionType?m.optionType.charAt(0).toUpperCase()+m.optionType.slice(1):((S=m.direction)==null?void 0:S.toLowerCase())==="buy"?"Long":((w=m.direction)==null?void 0:w.toLowerCase())==="sell"?"Short":m.direction||"Unknown"),$o.default.createElement("td",{className:`pnl-cell ${f?"open":b?"positive":k?"negative":""}`},f?"OPEN":(()=>{var P;let C=xt(y,m.rMultiple,m.riskAmount,n),D=u.metrics.isMultiCurrency&&u.metrics.conversionBaseCurrency?u.metrics.conversionBaseCurrency:m.currency||r;return ye(y,!0,D,(P=t==null?void 0:t.settings.trade)==null?void 0:P.displayRMultiples,C)})()))}))))})}});var on,_ye,MGe,AGe,LGe,QH,Bye=F(()=>{on=Y(Q());Sf();ip();ap();qt();Er();nr();Jn();_ye=[10,20,30,50],MGe=(e,t,r)=>{if(e.length===0)return[];let i=[...e.filter(o=>!yt({tradeStatus:o.tradeStatus,exitTime:o.exitTime,pnl:o._originalPnlWasNull?null:o.pnl,useDirectPnLInput:o.useDirectPnLInput,exits:o.exits,entries:o.entries}))].sort((o,s)=>{let l=o.entryTime instanceof Date?o.entryTime.getTime():new Date(o.entryTime).getTime(),c=s.entryTime instanceof Date?s.entryTime.getTime():new Date(s.entryTime).getTime();return l-c}),a=[];for(let o=0;o<i.length;o++){let s=Math.max(0,o-t+1),l=i.slice(s,o+1),c=l.filter(v=>{var h;return((h=v.pnl)!=null?h:0)>0}),d=l.filter(v=>{var h;return((h=v.pnl)!=null?h:0)<0}),u=c.length>0?c.reduce((v,h)=>{var y;return v+((y=h.pnl)!=null?y:0)},0)/c.length:0,p=d.length>0?Math.abs(d.reduce((v,h)=>{var y;return v+((y=h.pnl)!=null?y:0)},0)/d.length):0,m=p>0?u/p:0,g,f;if(r&&r>0){let v=c.map(y=>xt(y.pnl,y.rMultiple,y.riskAmount,r)).filter(y=>y!==void 0&&!isNaN(y));g=v.length>0?v.reduce((y,b)=>y+b,0)/v.length:void 0;let h=d.map(y=>xt(y.pnl,y.rMultiple,y.riskAmount,r)).filter(y=>y!==void 0&&!isNaN(y));f=h.length>0?Math.abs(h.reduce((y,b)=>y+b,0)/h.length):void 0}a.push({tradeIndex:o+1,ratio:Math.round(m*100)/100,avgWin:u,avgLoss:p,avgWinR:g,avgLossR:f,label:`#${o+1}`})}return a},AGe=e=>{let{active:t,payload:r,displayRMultiples:n}=e;if(!t||!r||r.length===0)return null;let i=r[0].payload,{currency:a}=ct(),o=()=>n&&i.avgWinR!==void 0?`+${i.avgWinR.toFixed(2)}R`:ye(i.avgWin,!1,a),s=()=>n&&i.avgLossR!==void 0?`${i.avgLossR.toFixed(2)}R`:ye(i.avgLoss,!1,a);return on.default.createElement("div",{style:{backgroundColor:"var(--background-primary)",border:"1px solid var(--background-modifier-border)",borderRadius:"8px",padding:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"}},on.default.createElement("div",{style:{fontSize:"12px",fontWeight:600,color:"var(--text-muted)",marginBottom:"6px"}},"Trade ",i.label),on.default.createElement("div",{style:{fontSize:"13px",fontWeight:600,color:"var(--text-normal)",marginBottom:"6px"}},"Ratio: ",i.ratio.toFixed(2)),i.avgWin>0&&on.default.createElement("div",{style:{fontSize:"13px",fontWeight:500,color:"var(--chart-positive)",marginBottom:"4px"}},"Avg Win: ",o()),i.avgLoss>0&&on.default.createElement("div",{style:{fontSize:"13px",fontWeight:500,color:"var(--chart-negative)"}},"Avg Loss: ",s()))},LGe=0,QH=on.default.memo(({filters:e,dateFormat:t})=>{var d,u,p,m,g;let[r,n]=(0,on.useState)(20),i=Ae(),a=(u=(d=i==null?void 0:i.settings)==null?void 0:d.trade)==null?void 0:u.defaultRiskAmount,o=(g=(m=(p=i==null?void 0:i.settings)==null?void 0:p.trade)==null?void 0:m.displayRMultiples)!=null?g:!1,s=(0,on.useRef)(null);(0,on.useEffect)(()=>{s.current||(s.current=`rolling-win-loss-ratio-${++LGe}`)},[]);let l=s.current||"rolling-win-loss-ratio-default",c="var(--text-muted)";return on.default.createElement(cl,{filters:e,dateFormat:t},f=>{let h=(0,on.useMemo)(()=>MGe(f.trades,r,a),[f.trades,r,a]).slice(-r),y=(()=>{if(h.length===0)return 0;let b=Math.min(...h.map(k=>k.ratio));return Math.min(b,0)})();return on.default.createElement("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",position:"relative"}},on.default.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"8px 12px",borderBottom:"1px solid var(--background-modifier-border)",position:"relative",opacity:.8}},on.default.createElement("div",{style:{fontWeight:500,fontSize:"13px",color:"var(--text-muted)",letterSpacing:"0.3px",textAlign:"center"}},"Rolling Win/Loss Ratio"),on.default.createElement("div",{style:{position:"absolute",right:"12px",display:"flex",alignItems:"center"}},on.default.createElement("select",{id:"rolling-period-select","aria-label":"Period",value:r,onChange:b=>{let k=Number(b.target.value);_ye.includes(k)&&n(k)},style:{padding:"4px 8px",fontSize:"11px",fontWeight:500,color:"var(--text-normal)",backgroundColor:"var(--background-primary)",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",cursor:"pointer"}},_ye.map(b=>on.default.createElement("option",{key:b,value:b},b," Trades"))))),on.default.createElement("div",{style:{flex:1,width:"100%",minHeight:0}},on.default.createElement(Wo,{height:"100%",width:"100%"},on.default.createElement(mP,{data:h,margin:{top:16,right:30,left:0,bottom:10}},on.default.createElement("defs",null,on.default.createElement("filter",{id:`${l}-glow`,height:"130%"},on.default.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"2",result:"blur"}),on.default.createElement("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7",result:"glow"}),on.default.createElement("feComposite",{in:"SourceGraphic",in2:"glow",operator:"over"}))),on.default.createElement(zo,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),on.default.createElement(Xa,{y:1,stroke:"var(--text-normal, #888888)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1.5,label:{value:"1.0",position:"right",fill:"var(--text-muted)",fontSize:11,fontWeight:500}}),on.default.createElement(jo,{dataKey:"label",height:16,style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:4,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5}}),on.default.createElement(_o,{tickFormatter:b=>Number.isFinite(b)?b.toFixed(1):"",style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:[y,b=>Math.max(b*1.1,1.5)],width:45,tickLine:!0,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.3},tickMargin:5}),on.default.createElement(ho,{content:b=>on.default.createElement(AGe,{active:b.active,payload:b.payload,displayRMultiples:o}),cursor:{stroke:"var(--interactive-accent)",strokeWidth:1,strokeDasharray:"3 3"},wrapperStyle:{zIndex:1e3}}),on.default.createElement(su,{type:"monotone",dataKey:"ratio",stroke:c,strokeWidth:2.5,dot:!1,activeDot:{r:7,strokeWidth:1,stroke:"var(--background-primary)",fill:"var(--interactive-accent)",filter:`url(#${l}-glow)`},animationDuration:500,animationEasing:"ease-out"})))))})});QH.displayName="RollingWinLossRatioChart"});var di,NGe,XH,Wye=F(()=>{di=Y(Q());Sf();ip();ap();Jn();qt();Er();nr();NGe=(e,t,r)=>{if(!e||e.length===0)return[];let i=[...e.filter(o=>!yt({tradeStatus:o.tradeStatus,exitTime:o.exitTime,pnl:o._originalPnlWasNull?null:o.pnl,useDirectPnLInput:o.useDirectPnLInput,exits:o.exits,entries:o.entries}))].sort((o,s)=>{let l=o.entryTime instanceof Date?o.entryTime.getTime():new Date(o.entryTime).getTime(),c=s.entryTime instanceof Date?s.entryTime.getTime():new Date(s.entryTime).getTime();return l-c}),a=[];for(let o=0;o<i.length;o++){let s=Math.max(0,o-t+1),l=i.slice(s,o+1),c=l.filter(f=>f.pnl>0),d=l.filter(f=>f.pnl<0),u=c.length>0?c.reduce((f,v)=>f+v.pnl,0)/c.length:null,p=d.length>0?Math.abs(d.reduce((f,v)=>f+v.pnl,0)/d.length):null,m=null,g=null;if(r&&r>0){let f=c.map(h=>xt(h.pnl,h.rMultiple,h.riskAmount,r)).filter(h=>h!==void 0&&!isNaN(h));m=f.length>0?f.reduce((h,y)=>h+y,0)/f.length:null;let v=d.map(h=>xt(h.pnl,h.rMultiple,h.riskAmount,r)).filter(h=>h!==void 0&&!isNaN(h));g=v.length>0?Math.abs(v.reduce((h,y)=>h+y,0)/v.length):null}a.push({tradeIndex:o+1,avgWin:u,avgLoss:p,avgWinR:m,avgLossR:g,label:`#${o+1}`})}return a},XH=di.default.memo(({filters:e,dateFormat:t})=>{var c,d,u,p,m;let r=Ae(),{currency:n}=ct(),[i,a]=(0,di.useState)(20),o=(d=(c=r==null?void 0:r.settings)==null?void 0:c.trade)==null?void 0:d.defaultRiskAmount,s=(m=(p=(u=r==null?void 0:r.settings)==null?void 0:u.trade)==null?void 0:p.displayRMultiples)!=null?m:!1,l=[10,20,30,50];return di.default.createElement(cl,{filters:e,dateFormat:t},(g,f)=>{let h=(g.metrics.isMultiCurrency?g.metrics.conversionBaseCurrency:void 0)||n,b=NGe(g.trades,i,o).slice(-i),k=S=>{if(!S.active||!S.payload||S.payload.length===0)return null;let w=S.payload[0].payload;return di.default.createElement("div",{style:{backgroundColor:"var(--background-primary)",border:"1px solid var(--background-modifier-border)",borderRadius:"8px",padding:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"}},di.default.createElement("div",{style:{fontSize:"12px",fontWeight:600,color:"var(--text-muted)",marginBottom:"6px"}},"Trade ",w.label),w.avgWin!==null&&di.default.createElement("div",{style:{fontSize:"13px",fontWeight:500,color:"var(--chart-positive)",marginBottom:"4px"}},"Avg Win: ",s&&w.avgWinR!=null?`+${w.avgWinR.toFixed(2)}R`:ye(w.avgWin,!1,h)),w.avgLoss!==null&&di.default.createElement("div",{style:{fontSize:"13px",fontWeight:500,color:"var(--chart-negative)"}},"Avg Loss: ",s&&w.avgLossR!=null?`${w.avgLossR.toFixed(2)}R`:ye(w.avgLoss,!1,h)))},x=S=>{let{payload:w}=S;return w?di.default.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"16px",marginTop:"8px"}},w.map((C,D)=>di.default.createElement("div",{key:`legend-${D}`,style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"12px",fontWeight:500,color:"var(--text-normal)"}},di.default.createElement("div",{style:{width:"12px",height:"2px",backgroundColor:C.color,borderRadius:"1px"}}),di.default.createElement("span",null,C.value)))):null};return di.default.createElement("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column"}},di.default.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"8px 12px",borderBottom:"1px solid var(--background-modifier-border)",position:"relative",opacity:.8}},di.default.createElement("div",{style:{fontWeight:500,fontSize:"13px",color:"var(--text-muted)",letterSpacing:"0.3px",textAlign:"center"}},"Rolling Avg Win/Loss"),di.default.createElement("div",{style:{position:"absolute",right:"12px",display:"flex",alignItems:"center"}},di.default.createElement("select",{"aria-label":"Period",value:i,onChange:S=>{let w=Number(S.target.value);!isNaN(w)&&l.includes(w)&&a(w)},style:{padding:"4px 8px",fontSize:"11px",fontWeight:500,border:"1px solid var(--background-modifier-border)",borderRadius:"4px",backgroundColor:"var(--background-primary)",color:"var(--text-normal)",cursor:"pointer",outline:"none"}},l.map(S=>di.default.createElement("option",{key:S,value:S},S," Trades"))))),di.default.createElement("div",{style:{flex:1,minHeight:0}},di.default.createElement(Wo,{height:"100%",width:"100%"},di.default.createElement(mP,{data:b,margin:{top:12,right:20,left:0,bottom:10}},di.default.createElement(zo,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),di.default.createElement(jo,{dataKey:"label",height:16,style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:4,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5},interval:"preserveStartEnd"}),di.default.createElement(_o,{tickFormatter:S=>Number.isFinite(S)?s&&o&&o>0?`${S.toFixed(1)}R`:ye(S,!0,h):"",style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},width:50,tickLine:!0,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.3},tickMargin:5}),di.default.createElement(ho,{content:k,cursor:{stroke:"var(--interactive-accent)",strokeWidth:1,strokeDasharray:"3 3"},wrapperStyle:{zIndex:1e3}}),di.default.createElement(wL,{content:x}),di.default.createElement(Xa,{y:0,stroke:"var(--text-normal)",strokeOpacity:.3,strokeDasharray:"3 3",strokeWidth:1}),di.default.createElement(su,{type:"monotone",dataKey:s?"avgWinR":"avgWin",stroke:"var(--chart-positive)",strokeWidth:2.5,dot:!1,activeDot:{r:6,strokeWidth:1,stroke:"var(--background-primary)",fill:"var(--chart-positive)"},name:"Avg Win",connectNulls:!1,animationDuration:500,animationEasing:"ease-out"}),di.default.createElement(su,{type:"monotone",dataKey:s?"avgLossR":"avgLoss",stroke:"var(--chart-negative)",strokeWidth:2.5,dot:!1,activeDot:{r:6,strokeWidth:1,stroke:"var(--background-primary)",fill:"var(--chart-negative)"},name:"Avg Loss",connectNulls:!1,animationDuration:500,animationEasing:"ease-out"})))))})});XH.displayName="RollingStatsChart"});var kn,jF,ZH,Jw,FGe,OGe,$ye,zF,Rye,eq=F(()=>{kn=Y(Q()),jF=Y(W4());by();nr();_t();k1();Tr();Cye();Dye();Mye();Nye();Oye();jye();Bye();Wye();ZH=class extends kn.default.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){console.error("ResponsiveGridLayout crashed:",{error:t.message,stack:t.stack,componentStack:r.componentStack,isEditing:this.props.isEditing,timestamp:new Date().toISOString()})}render(){var t;return this.state.hasError?kn.default.createElement("div",{style:{padding:"20px",border:"2px solid red",borderRadius:"4px"}},kn.default.createElement("h3",null,"Grid Layout Error"),kn.default.createElement("p",null,"Error: ",(t=this.state.error)==null?void 0:t.message),kn.default.createElement("button",{onClick:()=>this.setState({hasError:!1,error:null})},"Retry")):this.props.children}},Jw=(e,t,r,n,i)=>{var c,d,u;let a=ll.find(p=>p.id===t),o={};if(a!=null&&a.maxSize&&(o.minW=a.minSize.w,o.minH=a.minSize.h,o.maxW=a.maxSize.w,o.maxH=a.maxSize.h),!e||e.length===0)return{i:t,x:0,y:0,w:r,h:n,...o};if(i)try{let p=((d=(c=i.settings)==null?void 0:c.dashboard)==null?void 0:d.layouts)||{};for(let m in p){let g=p[m];if(!g)continue;let v=(((u=g.bottomSection)==null?void 0:u.lg)||[]).find(h=>h.i===t);if(v){let h=a!=null&&a.maxSize?Math.max(o.minW,Math.min(v.w,o.maxW)):v.w,y=a!=null&&a.maxSize?Math.max(o.minH,Math.min(v.h,o.maxH)):v.h;return{i:t,x:0,y:Yo,w:h,h:y,...o}}}}catch(p){console.error("Error finding previous layout:",p)}let s=0;return e.forEach(p=>{let m=typeof p.y=="number"?p.y:0,g=typeof p.h=="number"?p.h:1,f=m+g;f>s&&(s=f)}),{i:t,x:0,y:s,w:r,h:n,...o}},FGe=(0,jF.WidthProvider)(jF.Responsive),OGe=50,$ye=4,zF={lg:12,md:6,sm:4,xs:2,xxs:1},Rye=({filters:e,isEditing:t,widgets:r,onRemoveWidget:n})=>{let i=Ae(),[a,o]=(0,kn.useState)({lg:[],md:[],sm:[],xs:[],xxs:[]}),[s,l]=(0,kn.useState)(1200),[c,d]=(0,kn.useState)("lg"),u=(0,kn.useCallback)(b=>{l(b)},[]),p=(0,kn.useCallback)(b=>{["lg","md","sm","xs","xxs"].includes(b)&&d(b)},[]),m=b=>{var S,w,C,D;let k=ll.find(P=>P.id===b.i),x={...b,i:typeof b.i=="string"?b.i:"unknown",x:typeof b.x=="number"&&isFinite(b.x)?b.x:0,y:typeof b.y=="number"&&isFinite(b.y)?b.y===1/0||b.y===1e7||b.y===1e4?Yo:b.y:b.y===1/0?Yo:0,w:typeof b.w=="number"&&isFinite(b.w)&&b.w>0?b.w:1,h:typeof b.h=="number"&&isFinite(b.h)&&b.h>0?b.h:1};return k!=null&&k.maxSize&&(x.minW=(S=b.minW)!=null?S:k.minSize.w,x.minH=(w=b.minH)!=null?w:k.minSize.h,x.maxW=(C=b.maxW)!=null?C:k.maxSize.w,x.maxH=(D=b.maxH)!=null?D:k.maxSize.h,x.w=Math.max(x.minW,Math.min(x.w,x.maxW)),x.h=Math.max(x.minH,Math.min(x.h,x.maxH))),x},g=b=>{let k={};return Object.entries(b).forEach(([x,S])=>{if(!Array.isArray(S)){k[x]=[];return}k[x]=S.map(w=>!w||typeof w!="object"?{i:"unknown",x:0,y:0,w:1,h:1}:m(w))}),k};(0,kn.useEffect)(()=>{(()=>{try{if(i){let k=Os(i),x=k.bottomSection.lg.filter(M=>r.includes(M.i)).map(m),S=k.bottomSection.md.filter(M=>r.includes(M.i)).map(m),w=k.bottomSection.sm.filter(M=>r.includes(M.i)).map(m),C=(k.bottomSection.xs||[]).filter(M=>r.includes(M.i)).map(m),D=(k.bottomSection.xxs||[]).filter(M=>r.includes(M.i)).map(m),P=zF;r.forEach(M=>{let z=x.some(T=>T.i===M),A=S.some(T=>T.i===M),I=w.some(T=>T.i===M),L=C.some(T=>T.i===M),E=D.some(T=>T.i===M);if(!z||!A||!I||!L||!E){let T=ll.find($=>$.id===M);if(T){let $,_="lg";if(z?($=x.find(B=>B.i===M),_="lg"):A?($=S.find(B=>B.i===M),_="md"):I?($=w.find(B=>B.i===M),_="sm"):L?($=C.find(B=>B.i===M),_="xs"):E&&($=D.find(B=>B.i===M),_="xxs"),$||($=Jw(x,M,T.defaultSize.w,T.defaultSize.h,i)),!z){let B=Jw(x,M,Math.min($.w,P.lg),$.h,i);x.push(B)}if(!A){let B={i:M,x:0,y:Yo,w:Math.min($.w,P.md),h:$.h};S.push(B)}if(!I){let B={i:M,x:0,y:Yo,w:Math.min($.w,P.sm),h:$.h};w.push(B)}if(!L){let B={i:M,x:0,y:Yo,w:Math.min($.w,P.xs),h:$.h};C.push(B)}if(!E){let B={i:M,x:0,y:Yo,w:P.xxs,h:$.h};D.push(B)}}}}),o({lg:x,md:S,sm:w,xs:C,xxs:D})}}catch(k){console.error("Error loading layouts:",k);let x=(w,C)=>{let D=ll.find(I=>I.id===w),P=zF[C],M=C==="xxs"?1:Math.min((D==null?void 0:D.defaultSize.w)||6,P),z=(D==null?void 0:D.defaultSize.h)||(C==="lg"?4:3);return m({i:w,x:0,y:0,w:M,h:z})},S={lg:r.map(w=>x(w,"lg")),md:r.map(w=>x(w,"md")),sm:r.map(w=>x(w,"sm")),xs:r.map(w=>x(w,"xs")),xxs:r.map(w=>x(w,"xxs"))};o(S)}})()},[i,r]);let f=b=>{xe.publish("widgets:changed",{activeWidgets:b})},v=(b,k)=>{let x=D=>!D||typeof D!="object"?null:{i:typeof D.i=="string"?D.i:"unknown",x:typeof D.x=="number"&&isFinite(D.x)?D.x:0,y:typeof D.y=="number"&&isFinite(D.y)?D.y===1/0?Yo:D.y:0,w:typeof D.w=="number"&&isFinite(D.w)&&D.w>0?D.w:1,h:typeof D.h=="number"&&isFinite(D.h)&&D.h>0?D.h:1},S=(b==null?void 0:b.map(x).filter(D=>D!==null))||[],w=Object.fromEntries(Object.entries(k||{}).map(([D,P])=>[D,(P==null?void 0:P.map(x).filter(M=>M!==null))||[]])),C=new CustomEvent("layout-changed");if(document.dispatchEvent(C),t&&i)try{let D=Os(i),P=c||"lg",M=S.map(L=>L.i),z={...D,bottomSection:{...D.bottomSection,lg:w.lg||[],md:w.md||[],sm:w.sm||[],xs:w.xs||[],xxs:w.xxs||[]}},A=zF;["lg","md","sm","xs","xxs"].forEach(L=>{if(L===P)return;let E=z.bottomSection[L],T=E.map($=>$.i);z.bottomSection[L]=E.filter($=>M.includes($.i)),M.forEach($=>{if(!T.includes($)){let _=S.find(B=>B.i===$);if(_){let B=ll.find(N=>N.id===$),W=(B==null?void 0:B.defaultSize)||{w:6,h:4};z.bottomSection[L].push({i:$,x:0,y:Yo,w:Math.min(Math.max(1,Math.floor(_.w*A[L]/A[P])),A[L]),h:_.h})}}})}),zl(i,"Default",z)}catch(D){console.error("Error saving layout in handleLayoutChange:",D)}},h=b=>{var S,w;if(!ll.find(C=>C.id===b))return kn.default.createElement("div",{className:"journalit-dashboard-widget-error"},"Unknown widget type: ",b);let x=((w=(S=i==null?void 0:i.settings)==null?void 0:S.trade)==null?void 0:w.dateFormat)||vn();switch(b){case"pnlChart":return kn.default.createElement(Tye,{filters:e,dateFormat:x});case"performanceCalendar":return kn.default.createElement(Pye,{filters:e,dateFormat:x});case"dailyPerformance":return kn.default.createElement(Iye,{filters:e,dateFormat:x});case"tradesChart":return kn.default.createElement(Lye,{filters:e,dateFormat:x});case"drawdownChart":return kn.default.createElement(Fye,{filters:e,dateFormat:x});case"recentTrades":return kn.default.createElement(zye,{filters:e,dateFormat:x});case"rollingWinRate":return kn.default.createElement(QH,{filters:e,dateFormat:x});case"rollingStats":return kn.default.createElement(XH,{filters:e,dateFormat:x});default:return kn.default.createElement("div",{className:"journalit-dashboard-widget-error"},"Widget not implemented: ",b)}},y=g(a);return kn.default.createElement("div",{className:`journalit-dashboard-grid-layout ${t?"is-editing":""}`,style:{padding:"0",margin:"0"}},kn.default.createElement(ZH,{isEditing:t},kn.default.createElement(FGe,{className:"layout",layouts:y,breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:zF,rowHeight:OGe,isResizable:t,isDraggable:t,draggableCancel:t?".journalit-dashboard-widget-remove, .journalit-dashboard-widget-remove *":void 0,onLayoutChange:v,onWidthChange:u,onBreakpointChange:p,compactType:"vertical",preventCollision:!1,useCSSTransforms:!0,containerPadding:[0,0],margin:[$ye,$ye]},r.map(b=>kn.default.createElement("div",{key:b},kn.default.createElement(()=>{var D;let x=P=>{P.stopPropagation(),n(b);let M=r.filter(z=>z!==b);f(M)},S=["pnlChart","drawdownChart"],w=t||S.includes(b),C=!t&&S.includes(b);return kn.default.createElement("div",{className:"journalit-dashboard-widget",style:{position:"relative",width:"100%",height:"100%",display:"flex",flexDirection:"column",backgroundColor:"transparent",borderRadius:"6px",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",overflow:"hidden"}},t&&kn.default.createElement("button",{className:"journalit-dashboard-widget-remove",onClick:x,onMouseDown:P=>{P.preventDefault(),P.stopPropagation()},style:{position:"absolute",top:"4px",right:"4px",backgroundColor:"var(--background-modifier-error)",color:"white",border:"none",borderRadius:"50%",width:"22px",height:"22px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",cursor:"pointer",zIndex:1e4,padding:0,fontWeight:"bold",lineHeight:1},"aria-label":"Remove widget"},"\u2715"),C&&kn.default.createElement("div",{className:"journalit-dashboard-widget-minimal-header",style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"4px 12px 4px 12px",height:"24px",backgroundColor:"transparent",borderBottom:"1px solid rgba(var(--background-modifier-border-rgb, 0, 0, 0), 0.4)",opacity:.8}},kn.default.createElement("div",{className:"journalit-dashboard-widget-title",style:{fontWeight:"500",fontSize:"13px",color:"var(--text-muted)",letterSpacing:"0.3px",textAlign:"center",width:"100%"}},((D=ll.find(P=>P.id===b))==null?void 0:D.name)||b)),kn.default.createElement("div",{className:"journalit-dashboard-widget-content",style:{flex:1,padding:"4px 4px 2px 1px",height:C?"calc(100% - 24px)":"100%",overflow:"hidden"}},h(b)))},null))))))}});var sp,Uye,Hye=F(()=>{sp=Y(Q()),Uye=({availableWidgets:e,activeWidgets:t,onAddWidget:r,onClose:n})=>(console.warn("ComponentSelector is deprecated, use UnifiedComponentSelector instead"),sp.default.createElement("div",{className:"journalit-dashboard-component-selector"},sp.default.createElement("div",{className:"journalit-dashboard-component-selector-header"},sp.default.createElement("h3",null,"Add Widget"),sp.default.createElement("button",{className:"journalit-dashboard-component-selector-close",onClick:n,"aria-label":"Close"},"\xD7")),sp.default.createElement("div",{className:"journalit-dashboard-component-selector-list"},e.map(i=>sp.default.createElement("div",{key:i.id,className:"journalit-dashboard-component-selector-item",onClick:()=>{r(i.id),n()},style:{opacity:t.includes(i.id)?.5:1}},sp.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-name"},i.name),i.description&&sp.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-description"},i.description),i.category&&sp.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-category"},i.category),t.includes(i.id)&&sp.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-badge"},"Added"))))))});var xl,tq,qye=F(()=>{xl=Y(Q());by();nr();eq();Hye();k1();Tr();tq=({filters:e,isEditing:t,hideAddButton:r=!1})=>{let n=Ae(),[i,a]=(0,xl.useState)(!1),[o,s]=(0,xl.useState)([]),l=(0,xl.useCallback)(p=>{s([...p.activeWidgets])},[]);Xe("widgets:changed",l),(0,xl.useEffect)(()=>{(()=>{try{if(n){let g=Os(n).bottomSection.lg.map(f=>f.i);s(g)}}catch(m){console.error("Error initializing layout in BottomSection:",m),s(["pnlChart","performanceCalendar","dailyPerformance"])}})()},[n]);let c=(0,xl.useCallback)(()=>{if(n){let m=Os(n).bottomSection.lg.map(g=>g.i);s(m)}},[n]);Xe("settings:changed",c),(0,xl.useEffect)(()=>{!t&&i&&a(!1)},[t]);let d=p=>{if(n)try{let m=Os(n),g=ll.find(k=>k.id===p);if(!g)throw new Error(`Widget definition not found: ${p}`);if(o.includes(p))return;let f=Jw(m.bottomSection.lg,p,g.defaultSize.w,g.defaultSize.h,n),v={lg:12,md:6,sm:4,xs:2,xxs:1},h={};Object.keys(v).forEach(k=>{let x=v[k],S=Math.min(g.defaultSize.w,x);h[k]={i:p,x:0,y:Yo,w:S,h:g.defaultSize.h}});let y={...m,bottomSection:{lg:[...m.bottomSection.lg,h.lg],md:[...m.bottomSection.md,h.md],sm:[...m.bottomSection.sm,h.sm],xs:[...m.bottomSection.xs||[],h.xs],xxs:[...m.bottomSection.xxs||[],h.xxs]}};zl(n,"Default",y);let b=[...o,p];s(b),a(!1)}catch(m){console.error("Error adding widget in BottomSection:",m)}},u=p=>{if(n)try{let m=Os(n),g={...m,bottomSection:{lg:m.bottomSection.lg.filter(v=>v.i!==p),md:m.bottomSection.md.filter(v=>v.i!==p),sm:m.bottomSection.sm.filter(v=>v.i!==p),xs:(m.bottomSection.xs||[]).filter(v=>v.i!==p),xxs:(m.bottomSection.xxs||[]).filter(v=>v.i!==p)}};zl(n,"Default",g);let f=o.filter(v=>v!==p);s(f),xe.publish("widgets:changed",{activeWidgets:f})}catch(m){console.error("Error removing widget in BottomSection:",m)}};return xl.default.createElement("div",{className:"journalit-dashboard-bottom-section",style:{padding:"0",backgroundColor:"transparent"}},t&&!r&&xl.default.createElement("div",{className:"journalit-dashboard-bottom-section-header",style:{display:"flex",justifyContent:"flex-end",alignItems:"center",padding:"0 10px"}},xl.default.createElement("button",{className:"journalit-dashboard-add-widget-button",onClick:()=>{a(!i)},style:{backgroundColor:"var(--interactive-accent)",color:"var(--text-on-accent)",border:"none",borderRadius:"4px",padding:"4px 8px",fontSize:"12px",cursor:"pointer"}},"Add Widget")),xl.default.createElement("div",{style:{position:"relative"}},!r&&i&&xl.default.createElement(Uye,{availableWidgets:ll,activeWidgets:o,onAddWidget:d,onClose:()=>{a(!1)}}),xl.default.createElement(Rye,{filters:e,isEditing:t,widgets:o,onRemoveWidget:p=>{u(p)}})))}});var Vye=F(()=>{qye()});var gr,zGe,rq,Gye=F(()=>{gr=Y(Q());Ot();mM();k1();eq();nr();by();Tr();zGe=({activeMetrics:e,activeWidgets:t,onAddMetric:r,onAddWidget:n,onClose:i})=>{let a=Ae(),[o,s]=(0,gr.useState)(0),l=(0,gr.useRef)(null),c=(0,gr.useMemo)(()=>pM.filter(f=>!e.includes(f.id)),[e]),d=(0,gr.useMemo)(()=>ll.filter(f=>!t.includes(f.id)),[t]),u=(0,gr.useMemo)(()=>{let f=[];return c.forEach(v=>{f.push({type:"metric",data:v})}),d.forEach(v=>{f.push({type:"widget",data:v})}),f},[c,d]),p=(0,gr.useCallback)(async f=>{if(!e.includes(f.id))if(a)try{let v=Os(a),h=[...v.topSection];h.includes(f.id)||h.push(f.id);let y={...v,topSection:h};await zl(a,"Default",y),r(f.id),xe.publish("metrics:changed",{activeMetrics:h})}catch(v){console.error("Error adding metric:",v)}else r(f.id)},[e,a,r]),m=(0,gr.useCallback)(async f=>{if(!t.includes(f.id))if(a)try{let v=Os(a),h=ll.find(k=>k.id===f.id);if(!h)throw new Error(`Widget definition not found: ${f.id}`);let y=Jw(v.bottomSection.lg,f.id,h.defaultSize.w,h.defaultSize.h,a),b={...v,bottomSection:{lg:[...v.bottomSection.lg,y],md:[...v.bottomSection.md,y],sm:[...v.bottomSection.sm,y],xs:[...v.bottomSection.xs||[],{...y,w:Math.min(y.w,2)}],xxs:[...v.bottomSection.xxs||[],{...y,w:1}]}};await zl(a,"Default",b),n(f.id),xe.publish("widgets:changed",{activeWidgets:[...t,f.id]})}catch(v){console.error("Error adding widget:",v)}else n(f.id)},[t,a,n]);(0,gr.useEffect)(()=>{let f=v=>{switch(v.key){case"Escape":v.preventDefault(),v.stopPropagation(),v.stopImmediatePropagation(),i();break;case"ArrowDown":v.preventDefault(),s(y=>Math.min(y+1,u.length-1));break;case"ArrowUp":v.preventDefault(),s(y=>Math.max(y-1,0));break;case"Enter":v.preventDefault();let h=u[o];h&&(h.type==="metric"?p(h.data):m(h.data));break}};return document.addEventListener("keydown",f,!0),()=>document.removeEventListener("keydown",f,!0)},[i,u,o,p,m]),(0,gr.useEffect)(()=>{if(!l.current)return;let v=l.current.querySelectorAll("[data-selectable]")[o];v&&v.scrollIntoView({block:"nearest"})},[o]);let g=(0,gr.useCallback)((f,v)=>u.findIndex(h=>h.type===f&&h.data.id===v),[u]);return gr.default.createElement("div",{onClick:f=>f.target===f.currentTarget&&i(),style:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.4)",zIndex:100010,display:"flex",justifyContent:"center",alignItems:"center",paddingBottom:"10vh"}},gr.default.createElement("div",{onClick:f=>f.stopPropagation(),style:{width:"100%",maxWidth:"380px",maxHeight:"75vh",backgroundColor:"var(--background-primary)",borderRadius:"8px",border:"1px solid var(--background-modifier-border)",boxShadow:"0 12px 40px rgba(0, 0, 0, 0.15)",display:"flex",flexDirection:"column"}},gr.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",borderBottom:"1px solid var(--background-modifier-border)",flexShrink:0}},gr.default.createElement("span",{style:{fontSize:"14px",fontWeight:600,color:"var(--text-normal)"}},"Add to Dashboard"),gr.default.createElement("button",{type:"button",onClick:f=>{f.stopPropagation(),i()},style:{background:"none",border:"none",padding:"4px",cursor:"pointer",color:"var(--text-muted)",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",pointerEvents:"auto"},className:"jl-selector-close"},gr.default.createElement(La,{size:16}))),gr.default.createElement("div",{ref:l,style:{flex:"1 1 auto",overflowY:"auto",padding:"8px 0",minHeight:0}},c.length>0&&gr.default.createElement(gr.default.Fragment,null,gr.default.createElement("div",{style:{padding:"4px 16px 8px",fontSize:"11px",fontWeight:600,color:"var(--text-faint)",textTransform:"uppercase",letterSpacing:"0.5px"}},"Metrics"),c.map(f=>{let v=g("metric",f.id),h=v===o;return gr.default.createElement("div",{key:f.id,"data-selectable":!0,"data-item-index":v,onClick:()=>p(f),onMouseEnter:()=>s(v),style:{display:"flex",alignItems:"flex-start",gap:"12px",padding:"10px 16px",cursor:"pointer",backgroundColor:h?"var(--background-secondary)":"transparent"},className:"jl-selector-item"},gr.default.createElement("div",{style:{width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,marginTop:"1px"}},gr.default.createElement(Ui,{size:16,style:{color:"var(--text-muted)"}})),gr.default.createElement("div",{style:{flex:1,minWidth:0}},gr.default.createElement("div",{style:{fontSize:"13px",fontWeight:500,color:"var(--text-normal)",marginBottom:"2px"}},f.name),gr.default.createElement("div",{style:{fontSize:"12px",color:"var(--text-muted)",lineHeight:1.3}},f.description)))})),d.length>0&&gr.default.createElement(gr.default.Fragment,null,gr.default.createElement("div",{style:{padding:c.length>0?"16px 16px 8px":"4px 16px 8px",fontSize:"11px",fontWeight:600,color:"var(--text-faint)",textTransform:"uppercase",letterSpacing:"0.5px"}},"Charts"),d.map(f=>{let v=g("widget",f.id),h=v===o;return gr.default.createElement("div",{key:f.id,"data-selectable":!0,"data-item-index":v,onClick:()=>m(f),onMouseEnter:()=>s(v),style:{display:"flex",alignItems:"flex-start",gap:"12px",padding:"10px 16px",cursor:"pointer",backgroundColor:h?"var(--background-secondary)":"transparent"},className:"jl-selector-item"},gr.default.createElement("div",{style:{width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,marginTop:"1px"}},gr.default.createElement(Ui,{size:16,style:{color:"var(--text-muted)"}})),gr.default.createElement("div",{style:{flex:1,minWidth:0}},gr.default.createElement("div",{style:{fontSize:"13px",fontWeight:500,color:"var(--text-normal)",marginBottom:"2px"}},f.name),gr.default.createElement("div",{style:{fontSize:"12px",color:"var(--text-muted)",lineHeight:1.3}},f.description)))})),c.length===0&&d.length===0&&gr.default.createElement("div",{style:{padding:"24px 16px",textAlign:"center",color:"var(--text-muted)",fontSize:"13px"}},"All metrics and charts have been added")),gr.default.createElement("div",{style:{padding:"8px 12px",borderTop:"1px solid var(--background-modifier-border)",fontSize:"11px",color:"var(--text-faint)",display:"flex",gap:"12px",flexShrink:0}},gr.default.createElement("span",null,"\u2191\u2193 navigate"),gr.default.createElement("span",null,"\u21B5 select"),gr.default.createElement("span",null,"esc close"))))},rq=gr.default.memo(zGe);rq.displayName="UnifiedComponentSelector"});var lp,Yye,Kye=F(()=>{lp=Y(Q());Ol();gre();Vye();Gye();Wp();nr();Yye=({isLoading:e,dashboardData:t,filters:r,isEditing:n,showUnifiedSelector:i,activeMetrics:a,activeWidgets:o,onAddMetric:s,onAddWidget:l,onCloseSelector:c,openUnifiedSelector:d})=>{let u=Ae(),p=()=>{if(!u||!u.app)return;new Eo({app:u.app,plugin:u}).open()};return!e&&t&&t.trades.length===0?lp.default.createElement("div",{style:{padding:"40px 0",display:"flex",justifyContent:"center",alignItems:"center",flex:"1",width:"100%",minHeight:"300px"}},lp.default.createElement(yi,{message:"No trading data available",subMessage:"Add some trades to see your dashboard come to life",iconSize:56,actionButtonText:"Add Trade",onActionButtonClick:p})):lp.default.createElement(lp.default.Fragment,null,lp.default.createElement("div",{className:"journalit-dashboard-unified-container",style:{gap:"10px",backgroundColor:"transparent"}},lp.default.createElement("div",{style:{position:"relative"}},lp.default.createElement(HW,{filters:r,isEditing:n,hideAddButton:!0})),lp.default.createElement("div",{style:{position:"relative"}},lp.default.createElement(tq,{filters:r,isEditing:n,hideAddButton:!0}))),i&&lp.default.createElement(rq,{activeMetrics:a,activeWidgets:o,onAddMetric:s,onAddWidget:l,onClose:c}))}});var Ei,nq,Jye=F(()=>{Ei=Y(Q());by();JT();rl();qi();k1();nq=()=>{var M,z;let e=Ae(),[t,r]=(0,Ei.useState)({dateRange:[null,null],accounts:[],tickers:[],setups:[],tradeTypes:[],statuses:[],tags:[]}),n=(0,Ei.useRef)(!1);(0,Ei.useEffect)(()=>{var A;if(e&&!n.current){let I=(A=e.uiStateManager.getState().viewFilters)==null?void 0:A.dashboard;I&&r({...I,dateRange:[I.dateRange[0]?new Date(I.dateRange[0]):null,I.dateRange[1]?new Date(I.dateRange[1]):null]}),n.current=!0}},[e]);let[i,a]=(0,Ei.useState)(!1),[o,s]=(0,Ei.useState)(!1),[l,c]=(0,Ei.useState)(!1),[d,u]=(0,Ei.useState)(0),[p,m]=(0,Ei.useState)([]),[g,f]=(0,Ei.useState)([]);(0,Ei.useEffect)(()=>{u(A=>A+1)},[g,p]);let v=(0,Ei.useCallback)(A=>{f(A.activeWidgets)},[]),h=(0,Ei.useCallback)(A=>{m(A.activeMetrics)},[]),y=(0,Ei.useCallback)(()=>{u(A=>A+1)},[]);Xe("trade:changed",y),Xe("widgets:changed",v);let b=(0,Ei.useMemo)(()=>e?Os(e):null,[e]);(0,Ei.useEffect)(()=>{document.querySelector('[data-dashboard-styles="true"]')||(LI(),cy(),document.documentElement.setAttribute("data-dashboard-styles","true")),(async()=>{try{e&&b&&(m(b.topSection),f(b.bottomSection.lg.map(I=>I.i)),requestAnimationFrame(()=>{KT()}))}catch(I){console.error("Failed to initialize dashboard:",I)}})()},[e,b]),Xe("metrics:changed",h),(0,Ei.useEffect)(()=>{var A,I;((I=(A=e==null?void 0:e.settings)==null?void 0:A.trade)==null?void 0:I.skipWeekends)!==void 0&&requestAnimationFrame(()=>{KT()})},[(z=(M=e==null?void 0:e.settings)==null?void 0:M.trade)==null?void 0:z.skipWeekends]);let k=(0,Ei.useCallback)(A=>{if(r(A),e){let I=e.uiStateManager.getState().viewFilters;e.uiStateManager.updateState({viewFilters:{dashboard:A,reviews:(I==null?void 0:I.reviews)||{accounts:[],tickers:[],setups:[],tags:[],tradeTypes:[],statuses:[]}}})}},[e]),x=(0,Ei.useCallback)(()=>{s(A=>{let I=!A;return I===!1&&l&&c(!1),I})},[l]),S=(0,Ei.useCallback)(()=>{c(!0),setTimeout(()=>cy(),10)},[]),w=(0,Ei.useCallback)(()=>{c(!1)},[]),C=(0,Ei.useCallback)(A=>{try{if(!p.includes(A)&&(m(I=>[...I,A]),e&&b)){let I={...b,topSection:[...p,A]};zl(e,"Default",I).catch(L=>{console.error("Error saving layout after adding metric:",L)})}}catch(I){console.error("Error in handleAddMetric:",I)}},[p,e,b]),D=(0,Ei.useMemo)(()=>{let A={lg:12,md:6,sm:4,xs:2,xxs:1};return(I,L,E)=>{let T=A[L],$=Math.min(E.defaultSize.w,T);return{i:I,x:0,y:Yo,w:$,h:E.defaultSize.h}}},[]),P=(0,Ei.useCallback)(A=>{if(!(!e||!b||g.includes(A)))try{let I=ll.find($=>$.id===A);if(!I){console.warn(`Widget definition not found: ${A}`);return}let E=["lg","md","sm","xs","xxs"].reduce(($,_)=>($[_]=D(A,_,I),$),{}),T={...b,bottomSection:{lg:[...b.bottomSection.lg,E.lg],md:[...b.bottomSection.md,E.md],sm:[...b.bottomSection.sm,E.sm],xs:[...b.bottomSection.xs||[],E.xs],xxs:[...b.bottomSection.xxs||[],E.xxs]}};zl(e,"Default",T),f($=>[...$,A])}catch(I){console.error("Error adding widget:",I)}},[g,e,b,D]);return{filters:t,setFilters:r,isLoading:i,isEditing:o,showUnifiedSelector:l,selectorKey:d,activeMetrics:p,activeWidgets:g,handleFilterChange:k,toggleEditMode:x,openUnifiedSelector:S,closeUnifiedSelector:w,handleAddMetric:C,handleAddWidget:P}}});var Qye=F(()=>{Jye()});var Xh,sd,yP,jGe,_Ge,Xye=F(()=>{Xh=Y(Q());ch();rl();Jee();Kye();Qye();fc();nr();sd="journalit-dashboard-view",yP=class extends nl{getDisplayText(){return"Journalit Dashboard"}getViewType(){return sd}getIcon(){return"grip"}async onOpen(){try{await super.onOpen(),Wu(!0,!0,!0,!0),e0(!0,!0,!0,!0),this.containerEl&&(this.containerEl.classList.add("journalit-dashboard-view-container"),Object.assign(this.containerEl.style,{padding:"0",overflow:"hidden"})),cy()}catch(t){console.error("Error in DashboardView.onOpen:",t)}}async onClose(){try{await super.onClose()}catch(t){console.error("Error in DashboardView.onClose:",t)}}getRenderFunction(){return()=>Xh.default.createElement(jGe,{leaf:this.leaf,view:this})}},jGe=({leaf:e,view:t})=>{var f,v;let r=Ae(),{filters:n,isLoading:i,isEditing:a,showUnifiedSelector:o,activeMetrics:s,activeWidgets:l,handleFilterChange:c,toggleEditMode:d,openUnifiedSelector:u,closeUnifiedSelector:p,handleAddMetric:m,handleAddWidget:g}=nq();return r?Xh.default.createElement(dM,{app:r.app,tradeService:r.tradeService,filters:n,defaultRiskAmount:(v=(f=r==null?void 0:r.settings)==null?void 0:f.trade)==null?void 0:v.defaultRiskAmount,plugin:r},Xh.default.createElement("div",{className:"journalit-dashboard-view"},Xh.default.createElement(uM,{filters:n,onFilterChange:c,isEditing:a,onToggleEditMode:d,onOpenAddWidget:u}),Xh.default.createElement(_Ge,{isLoading:i,filters:n,isEditing:a,showUnifiedSelector:o,activeMetrics:s,activeWidgets:l,onAddMetric:m,onAddWidget:g,onCloseSelector:p,openUnifiedSelector:u}))):Xh.default.createElement("div",{className:"journalit-dashboard-view"},"Loading...")},_Ge=e=>{let{dashboardData:t}=ua();return Xh.default.createElement(Yye,{...e,dashboardData:t})}});var Zye=F(()=>{yy();eW();by();JT();wW()});var iq=F(()=>{Xye();Zye()});var Qw,aq=F(()=>{Qw=class{constructor(){this.locked=!1;this.queue=[]}tryLock(){return this.locked?!1:(this.locked=!0,!0)}async lock(){if(!this.locked){this.locked=!0;return}return new Promise(t=>{this.queue.push(t)})}unlock(){if(!this.locked){console.warn("Mutex.unlock() called but mutex was not locked");return}let t=this.queue.shift();t?t():this.locked=!1}isLocked(){return this.locked}async withLock(t){await this.lock();try{return await t()}finally{this.unlock()}}}});function RF(e,t=200){typeof window!="undefined"&&"requestIdleCallback"in window?window.requestIdleCallback(()=>{try{e()}catch(r){console.error("Error in idle scheduled function:",r)}}):setTimeout(()=>{try{e()}catch(r){console.error("Error in scheduled function:",r)}},t)}function bP(e,t=100){return new Promise(r=>{if(e.length===0){r();return}let n=0;function i(){if(n>=e.length){r();return}try{let a=e[n++];a(),n<e.length?setTimeout(i,t):r()}catch(a){console.error(`Error in scheduled operation at index ${n-1}:`,a),setTimeout(i,t)}}i()})}var UF=F(()=>{});function nbe(e){return`.journalit/migrations/${e}.json`}async function mu(e,t){if(!t||t.includes("..")||t.includes("/")||t.includes("\\"))return console.warn(`[MigrationTracker] Invalid migrationId: ${t}`),!1;try{let r=nbe(t);if(!await e.vault.adapter.exists(r))return!1;let i=await e.vault.adapter.read(r);try{return JSON.parse(i).completed===!0}catch(a){return console.warn(`Migration tracker: Corrupted status file for ${t}:`,a instanceof Error?a.message:"Invalid JSON"),!1}}catch(r){return console.warn(`Migration tracker: Failed to check migration status for ${t}:`,r instanceof Error?r.message:String(r)),!1}}async function Wb(e,t,r){try{if(!t||t.includes("..")||t.includes("/")||t.includes("\\"))throw new Error(`Invalid migrationId: ${t}`);await e.vault.adapter.exists(".journalit")||await e.vault.adapter.mkdir(".journalit");let n=".journalit/migrations";await e.vault.adapter.exists(n)||await e.vault.adapter.mkdir(n);let i={...r,completed:!0,completedAt:new Date().toISOString(),version:(r==null?void 0:r.version)||"1.0.0"},a=nbe(t);await e.vault.adapter.write(a,JSON.stringify(i,null,2)),console.log(`Migration tracker: Marked ${t} as completed`)}catch(n){throw console.error(`Migration tracker: Failed to mark migration ${t} as completed:`,n instanceof Error?n.message:String(n)),n}}var Xw=F(()=>{});var Zw,oq=F(()=>{Zw=class{convert(t,r){var s,l,c,d,u;let n=[],i=[],a={};t.preTradeChecklist&&typeof t.preTradeChecklist=="object"&&(i=Object.keys(t.preTradeChecklist),i.forEach((p,m)=>{a[`item_${m}`]=t.preTradeChecklist[p]||!1}));let o={type:"drc",date:t.date,tags:t.tags,dailyGoals:t.dailyGoals,dailyGoalStatus:t.dailyGoalStatus,checklistItems:i.length>0?i:void 0,checklistStatus:Object.keys(a).length>0?a:void 0,mentalGrade:t.mentalGrade,technicalGrade:t.technicalGrade,keyLevels:((s=t.forecast)==null?void 0:s.keyLevels)||t.keyLevels,reviewed:(c=(l=t.endOfDayReview)==null?void 0:l.reviewed)!=null?c:t.reviewed,reviewedAt:(u=(d=t.endOfDayReview)==null?void 0:d.reviewedAt)!=null?u:t.reviewedAt};if(Object.keys(o).forEach(p=>{let m=o[p];(m==null||Array.isArray(m)&&m.length===0||typeof m=="object"&&!Array.isArray(m)&&Object.keys(m).length===0)&&delete o[p]}),t.forecast){let p=this.convertForecast(t.forecast);p.length>0&&n.push(...p)}if(t.reviewQuestions&&Object.keys(t.reviewQuestions).length>0){n.push(`## Review
`);for(let[p,m]of Object.entries(t.reviewQuestions))n.push(`### ${p}`),n.push(m||""),n.push("")}return r.trim()&&(n.push(r),n.push("")),{frontmatter:o,markdownBody:n.join(`
`).trim()}}convertForecast(t){let r=[],n=[{key:"daily",label:"Daily"},{key:"fourHour",label:"4H"},{key:"oneHour",label:"1H"},{key:"thirtyMin",label:"30min"}],i=n.some(o=>{let s=t[o.key];return s&&typeof s=="object"&&"notes"in s&&s.notes}),a=t.customTimeframes&&Object.values(t.customTimeframes).some(o=>(o==null?void 0:o.notes)||(o==null?void 0:o.images)&&o.images.length>0);if(!i&&!a)return r;r.push(`## Forecast
`);for(let{key:o,label:s}of n){let l=t[o];if(l&&typeof l=="object"&&"notes"in l){let{notes:c,images:d}=l;(c||d&&d.length>0)&&(r.push(`### ${s}`),c&&r.push(c),d&&d.length>0&&(r.push(""),d.forEach(u=>r.push(`![[${u}]]`))),r.push(""))}}if(t.customTimeframes)for(let[o,s]of Object.entries(t.customTimeframes)){let l=s;(l.notes||l.images&&l.images.length>0)&&(r.push(`### ${o}`),l.notes&&r.push(l.notes),l.images&&l.images.length>0&&(r.push(""),l.images.forEach(c=>r.push(`![[${c}]]`))),r.push(""))}return r}}});var ek,sq=F(()=>{ek=class{convert(t,r){let n=[],i={type:"weekly-review",date:t.date,tags:t.tags,week:t.week,weekStart:t.weekStart,weekEnd:t.weekEnd,weeklyGoals:t.weeklyGoals,weeklyGoalStatus:t.weeklyGoalStatus,keyEvents:t.keyEvents,mentalGrade:t.mentalGrade,technicalGrade:t.technicalGrade,reviewed:t.reviewed,reviewedAt:t.reviewedAt};if(Object.keys(i).forEach(a=>{let o=i[a];(o==null||Array.isArray(o)&&o.length===0||typeof o=="object"&&!Array.isArray(o)&&Object.keys(o).length===0)&&delete i[a]}),t.forecast){let a=this.convertForecast(t.forecast);a.length>0&&n.push(...a)}if(t.mentalNotes&&t.mentalNotes.trim()&&(n.push(`## Mental Game
`),n.push(t.mentalNotes),n.push("")),t.technicalNotes&&t.technicalNotes.trim()&&(n.push(`## Technical Review
`),n.push(t.technicalNotes),n.push("")),t.reviewQuestions&&Object.keys(t.reviewQuestions).length>0&&Object.values(t.reviewQuestions).some(o=>o&&String(o).trim())){n.push(`## Review
`);for(let[o,s]of Object.entries(t.reviewQuestions))n.push(`### ${o}`),n.push(s||""),n.push("")}return r.trim()&&(n.push(r),n.push("")),{frontmatter:i,markdownBody:n.join(`
`).trim()}}convertForecast(t){let r=[],n=[{key:"monthly",label:"Monthly"},{key:"weekly",label:"Weekly"},{key:"daily",label:"Daily"}],i=n.some(o=>{let s=t[o.key];return(s==null?void 0:s.notes)||(s==null?void 0:s.images)&&s.images.length>0}),a=t.customTimeframes&&Object.values(t.customTimeframes).some(o=>(o==null?void 0:o.notes)||(o==null?void 0:o.images)&&o.images.length>0);if(!i&&!a)return r;r.push(`## Forecast
`);for(let{key:o,label:s}of n){let l=t[o];(l!=null&&l.notes||l!=null&&l.images&&l.images.length>0)&&(r.push(`### ${s}`),l.notes&&r.push(l.notes),l.images&&l.images.length>0&&(r.push(""),l.images.forEach(c=>r.push(`![[${c}]]`))),r.push(""))}if(t.customTimeframes)for(let[o,s]of Object.entries(t.customTimeframes)){let l=s;(l.notes||l.images&&l.images.length>0)&&(r.push(`### ${o}`),l.notes&&r.push(l.notes),l.images&&l.images.length>0&&(r.push(""),l.images.forEach(c=>r.push(`![[${c}]]`))),r.push(""))}return r}}});var tk,lq=F(()=>{tk=class{convert(t,r){let n={type:"monthly-review",date:t.date,month:t.month,year:t.year,tags:t.tags,monthlyGoals:t.monthlyGoals,monthlyGoalStatus:t.monthlyGoalStatus,mentalGrade:t.mentalGrade,technicalGrade:t.technicalGrade,reviewed:t.reviewed,reviewedAt:t.reviewedAt};Object.keys(n).forEach(a=>{let o=n[a];(o==null||Array.isArray(o)&&o.length===0||typeof o=="object"&&!Array.isArray(o)&&Object.keys(o).length===0)&&delete n[a]});let i=r.trim();return{frontmatter:n,markdownBody:i}}}});var Zh,RGe,ev,cq=F(()=>{Tr();Nl();Nd();Xw();oq();sq();lq();Zh="legacy-review-to-v2",RGe=".legacy.md.bak",ev=class{constructor(t){this.templateService=null;this.plugin=t,this.drcConverter=new Zw,this.weeklyConverter=new ek,this.monthlyConverter=new tk}getTemplateService(){return this.templateService||(this.templateService=new uo(this.plugin)),this.templateService}async isMigrationCompleted(){return mu(this.plugin.app,Zh)}async findLegacyNotes(t){let r=[],n=this.plugin.app.vault.getMarkdownFiles(),i=t||["drc","weekly-review","monthly-review"];for(let a of n){let o=this.plugin.app.metadataCache.getFileCache(a),s=o==null?void 0:o.frontmatter;if(!s)continue;let l=s.type;i.includes(l)&&!s.templateId&&r.push(a)}return r}async countLegacyNotes(){var n;let t={drc:0,weekly:0,monthly:0,total:0},r=await this.findLegacyNotes();for(let i of r){let a=(n=this.plugin.app.metadataCache.getFileCache(i))==null?void 0:n.frontmatter;(a==null?void 0:a.type)==="drc"?t.drc++:(a==null?void 0:a.type)==="weekly-review"?t.weekly++:(a==null?void 0:a.type)==="monthly-review"&&t.monthly++}return t.total=t.drc+t.weekly+t.monthly,t}async migrateAll(t={}){var l;let{dryRun:r=!1,noteTypes:n,backup:i=!0,onProgress:a}=t,o=await this.findLegacyNotes(n),s={totalFound:o.length,migrated:0,failed:0,skipped:0,backupsCreated:0,results:[]};for(let c=0;c<o.length;c++){let d=o[c];a&&a(c+1,d.path);let u=await this.migrateNote(d,{dryRun:r,backup:i});s.results.push(u),u.success?(s.migrated++,u.backupCreated&&s.backupsCreated++):(l=u.error)!=null&&l.includes("skipped")?s.skipped++:s.failed++}return!r&&s.migrated>0&&(await Wb(this.plugin.app,Zh,{fileCount:s.migrated,errors:s.failed}),xe.publish("review:changed",{type:"migration",action:"bulk-migrated",count:s.migrated})),s}async migrateNote(t,r={}){let{dryRun:n=!1,backup:i=!0}=r;try{let a=await this.plugin.app.vault.read(t),o=this.plugin.app.metadataCache.getFileCache(t),s=o==null?void 0:o.frontmatter;if(!s)return{success:!1,filePath:t.path,noteType:"drc",error:"No frontmatter found"};let l=s.type;if(!l||!["drc","weekly-review","monthly-review"].includes(l))return{success:!1,filePath:t.path,noteType:l||"drc",error:`Invalid or missing type field: ${l}`};if(s.templateId)return{success:!1,filePath:t.path,noteType:l,error:"Already migrated (has templateId) - skipped"};let c=this.getDefaultTemplate(l);if(!c)return{success:!1,filePath:t.path,noteType:l,error:`No default template found for ${l}`};let d=this.extractMarkdownBody(a),u=this.convertNote(l,s,d),p=this.buildFileContent(u,c);if(n)return{success:!0,filePath:t.path,noteType:l,backupCreated:!1};let m=!1;if(i){let g=t.path.replace(/\.md$/,RGe);await this.plugin.app.vault.adapter.exists(g)||(await this.plugin.app.vault.adapter.write(g,a),m=!0)}return await this.plugin.app.vault.modify(t,p),await yn(this.plugin.app,t),{success:!0,filePath:t.path,noteType:l,backupCreated:m}}catch(a){return console.error(`[LegacyMigration] Failed to migrate ${t.path}:`,a),{success:!1,filePath:t.path,noteType:"drc",error:a instanceof Error?a.message:String(a)}}}convertNote(t,r,n){switch(t){case"drc":return this.drcConverter.convert(r,n);case"weekly-review":return this.weeklyConverter.convert(r,n);case"monthly-review":return this.monthlyConverter.convert(r,n);default:throw new Error(`Unknown note type: ${t}`)}}extractMarkdownBody(t){let r=t.match(/^---\n[\s\S]*?\n---\n?([\s\S]*)$/);return r?r[1].trim():""}buildFileContent(t,r){let n={...t.frontmatter,templateId:r.id,templateVersion:r.version},i=this.toYaml(n),a=this.generateCodeblocksFromTemplate(r,t.markdownBody);return`---
${i}---

${a.join(`
`)}`}toYaml(t,r=0){let n=[],i="  ".repeat(r);for(let[a,o]of Object.entries(t))o!=null&&(typeof o=="string"?o.includes(`
`)||o.includes(":")||o.includes("#")||o.includes("'")||o.includes('"')||o.match(/^[\[\]{}&*!|>@`]/)||o.trim()!==o?o.includes(`
`)?(n.push(`${i}${a}: |`),o.split(`
`).forEach(s=>n.push(`${i}  ${s}`))):n.push(`${i}${a}: "${o.replace(/"/g,'\\"')}"`):n.push(`${i}${a}: ${o}`):typeof o=="number"||typeof o=="boolean"?n.push(`${i}${a}: ${o}`):Array.isArray(o)?o.length===0?n.push(`${i}${a}: []`):typeof o[0]=="object"?n.push(`${i}${a}: ${JSON.stringify(o)}`):(n.push(`${i}${a}:`),o.forEach(s=>{typeof s=="string"&&(s.includes(":")||s.includes("#"))?n.push(`${i}  - "${s.replace(/"/g,'\\"')}"`):n.push(`${i}  - ${s}`)})):typeof o=="object"&&n.push(`${i}${a}: ${JSON.stringify(o)}`));return n.join(`
`)+`
`}getDefaultTemplate(t){let r={drc:"drc","weekly-review":"weekly","monthly-review":"monthly"};return this.getTemplateService().getDefaultTemplate(r[t])||null}generateCodeblocksFromTemplate(t,r){var a,o;let n=[],i=0;for(let s of t.widgets)if(s.type==="markdown-zone")i===0&&r.trim(),n.push(""),n.push(""),n.push(""),i++;else if(s.type==="markdown-header"){let l=s.config,c=(a=l==null?void 0:l.level)!=null?a:2,d=(o=l==null?void 0:l.text)!=null?o:"Header",u="#".repeat(Math.max(1,Math.min(6,c)));n.push(`${u} ${d}`),n.push("")}else n.push(`\`\`\`journalit-${s.type}`),n.push("```"),n.push("");return r.trim()&&(n.push(""),n.push(r.trim())),n}}});var abe={};Ti(abe,{BackupCleanupConfirmModal:()=>xP,LegacyMigrationCompleteModal:()=>ng,LegacyMigrationConfirmModal:()=>tg,LegacyMigrationProgressModal:()=>rg});function HF(){if(ibe)return;ibe=!0;let e=document.createElement("style");e.id="jl-legacy-migration-styles",e.textContent=`
    @keyframes jl-spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    .jl-legacy-migration-modal .modal-close-button {
      display: none !important;
    }
    .jl-legacy-migration-modal {
      max-width: 480px;
    }
    .jl-note-type-badge {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 500;
      margin-right: 6px;
      margin-bottom: 4px;
    }
    .jl-note-type-badge.drc {
      background: rgba(59, 130, 246, 0.15);
      color: #3b82f6;
    }
    .jl-note-type-badge.weekly {
      background: rgba(168, 85, 247, 0.15);
      color: #a855f7;
    }
    .jl-note-type-badge.monthly {
      background: rgba(34, 197, 94, 0.15);
      color: #22c55e;
    }
    .jl-stat-row {
      display: flex;
      justify-content: space-between;
      padding: 4px 0;
    }
    .jl-stat-label {
      color: var(--text-muted);
      font-size: 13px;
    }
    .jl-stat-value {
      font-size: 13px;
      font-weight: 600;
    }
  `,document.head.appendChild(e)}var wP,ibe,tg,rg,ng,xP,qF=F(()=>{wP=require("obsidian"),ibe=!1;tg=class extends wP.Modal{constructor(t,r,n,i){super(t),this.titleEl.setText("Upgrade to Review V2"),this.modalEl.addClass("jl-legacy-migration-modal"),this.counts=r,this.onConfirm=n,this.onCancel=i}onOpen(){let{contentEl:t}=this;t.empty(),HF();let r=t.createDiv();r.style.cssText="padding: 20px; font-family: var(--default-font);";let n=r.createEl("p");n.textContent="Journalit has a new template-based review system with native markdown editing. This migration will upgrade your existing review notes.",n.style.cssText="margin: 0 0 16px 0; color: var(--text-normal); font-size: 14px; line-height: 1.5;";let i=r.createDiv();i.style.cssText="background: var(--background-secondary); padding: 12px; border-radius: 6px; margin-bottom: 16px;";let a=i.createEl("p");a.innerHTML=`<strong>Found ${this.counts.total} legacy note${this.counts.total!==1?"s":""}:</strong>`,a.style.cssText="margin: 0 0 10px 0; color: var(--text-normal); font-size: 13px;";let o=i.createDiv();if(o.style.cssText="display: flex; gap: 8px; flex-wrap: wrap;",this.counts.drc>0){let f=o.createSpan({cls:"jl-note-type-badge drc"});f.textContent=`${this.counts.drc} Daily Review${this.counts.drc!==1?"s":""}`}if(this.counts.weekly>0){let f=o.createSpan({cls:"jl-note-type-badge weekly"});f.textContent=`${this.counts.weekly} Weekly Review${this.counts.weekly!==1?"s":""}`}if(this.counts.monthly>0){let f=o.createSpan({cls:"jl-note-type-badge monthly"});f.textContent=`${this.counts.monthly} Monthly Review${this.counts.monthly!==1?"s":""}`}let s=r.createDiv();s.style.cssText="background: var(--background-secondary); padding: 12px; border-radius: 6px; margin-bottom: 16px;";let l=s.createEl("p");l.innerHTML="<strong>What will happen:</strong>",l.style.cssText="margin: 0 0 8px 0; color: var(--text-normal); font-size: 13px;";let c=s.createEl("ul");c.style.cssText="margin: 0; padding-left: 20px; color: var(--text-muted); font-size: 13px; line-height: 1.6;",["Review questions become <strong>native markdown</strong> you can edit freely","Forecast notes, mental notes, etc. become markdown sections","Structured data (goals, grades, checklists) stays intact","Backup files (<code>.legacy.md.bak</code>) created for safety"].forEach(f=>{let v=c.createEl("li");v.innerHTML=f});let u=r.createEl("p");u.innerHTML="<strong>Note:</strong> This is a one-way migration. Backups are created automatically.",u.style.cssText="margin: 0 0 20px 0; color: var(--text-muted); font-size: 13px; line-height: 1.4;";let p=r.createDiv();p.style.cssText="display: flex; justify-content: flex-end; gap: 10px; padding-top: 12px; border-top: 1px solid var(--background-modifier-border);";let m=p.createEl("button");m.textContent="Not Now",m.style.cssText="padding: 8px 16px; border: 1px solid var(--background-modifier-border); background: var(--background-primary); color: var(--text-normal); border-radius: 4px; cursor: pointer;",m.onclick=()=>{this.close(),this.onCancel()};let g=p.createEl("button");g.textContent="Start Migration",g.style.cssText="padding: 8px 20px; border: none; background: var(--interactive-accent); color: var(--text-on-accent); border-radius: 4px; cursor: pointer; font-weight: 500;",g.onclick=()=>{this.close(),this.onConfirm()}}onClose(){let{contentEl:t}=this;t.empty()}},rg=class extends wP.Modal{constructor(r,n){super(r);this.statusEl=null;this.progressEl=null;this.titleEl.setText("Migrating Review Notes..."),this.modalEl.addClass("jl-legacy-migration-modal"),this.total=n}onOpen(){let{contentEl:r}=this;r.empty(),HF();let n=r.createDiv();n.style.cssText="padding: 24px; text-align: center; min-width: 320px;";let i=n.createDiv();i.style.cssText="margin-bottom: 16px;";let a=i.createEl("div");a.style.cssText=`
      width: 40px;
      height: 40px;
      border: 3px solid var(--background-modifier-border);
      border-top-color: var(--interactive-accent);
      border-radius: 50%;
      margin: 0 auto;
      animation: jl-spin 1s linear infinite;
    `,this.progressEl=n.createEl("p"),this.progressEl.textContent=`0 / ${this.total}`,this.progressEl.style.cssText="margin: 0 0 8px 0; color: var(--text-normal); font-size: 14px; font-weight: 500;",this.statusEl=n.createEl("p"),this.statusEl.textContent="Converting frontmatter to markdown...",this.statusEl.style.cssText="margin: 0 0 16px 0; color: var(--text-muted); font-size: 13px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 100%;";let o=n.createEl("p");o.textContent="Your data is safe. Backups are being created.",o.style.cssText="margin: 0; color: var(--text-faint); font-size: 12px;"}updateProgress(r,n){if(this.progressEl&&(this.progressEl.textContent=`${r} / ${this.total}`),this.statusEl&&n){let i=n.length>40?"..."+n.slice(-37):n;this.statusEl.textContent=`Migrating: ${i}`}}onClose(){let{contentEl:r}=this;r.empty()}},ng=class extends wP.Modal{constructor(t,r){super(t),this.results=r;let n=this.results.failed>0;this.titleEl.setText(n?"Migration Completed with Warnings":"Migration Complete"),this.modalEl.addClass("jl-legacy-migration-modal")}onOpen(){let{contentEl:t}=this;t.empty(),HF();let r=t.createDiv();r.style.cssText="padding: 20px; font-family: var(--default-font);";let n=this.results.failed>0,i=r.createDiv();if(i.style.cssText="background: var(--background-secondary); padding: 12px; border-radius: 6px; margin-bottom: 16px;",[{label:"Migrated",value:this.results.migrated,color:"#22c55e"},{label:"Backups created",value:this.results.backupsCreated,color:"#3b82f6"},{label:"Skipped",value:this.results.skipped,color:"#6b7280"},{label:"Failed",value:this.results.failed,color:this.results.failed>0?"#ef4444":"#6b7280"}].forEach(l=>{let c=i.createDiv({cls:"jl-stat-row"}),d=c.createSpan({cls:"jl-stat-label"});d.textContent=l.label;let u=c.createSpan({cls:"jl-stat-value"});u.textContent=String(l.value),u.style.color=l.color}),n){let l=r.createEl("p");l.innerHTML='Some notes failed to migrate. Check the console (<kbd style="background: var(--background-primary); padding: 2px 6px; border-radius: 3px; border: 1px solid var(--background-modifier-border); font-family: monospace; font-size: 11px;">Ctrl+Shift+I</kbd>) for details. You can re-run migration later.',l.style.cssText="margin: 0 0 16px 0; color: var(--text-muted); font-size: 13px; line-height: 1.5;"}else if(this.results.migrated>0){let l=r.createEl("p");l.textContent="All review notes have been upgraded to the new template system. Your review questions and notes are now native markdown!",l.style.cssText="margin: 0 0 16px 0; color: var(--text-normal); font-size: 14px; line-height: 1.5;"}else{let l=r.createEl("p");l.textContent="No notes required migration. All notes are already using the new format.",l.style.cssText="margin: 0 0 16px 0; color: var(--text-muted); font-size: 14px; line-height: 1.5;"}if(this.results.backupsCreated>0){let l=r.createDiv();l.style.cssText="background: var(--background-secondary); padding: 12px; border-radius: 6px; margin-bottom: 20px;";let c=l.createEl("p");c.innerHTML="<strong>Backups:</strong> Original notes saved as <code>.legacy.md.bak</code> files in the same folders.",c.style.cssText="margin: 0 0 8px 0; color: var(--text-muted); font-size: 13px;";let d=l.createEl("p");d.innerHTML="<strong>Tip:</strong> After verifying your notes work correctly, run <code>Clean Up Migration Backup Files</code> from the command palette to delete backups.",d.style.cssText="margin: 0; color: var(--text-muted); font-size: 13px;"}let o=r.createDiv();o.style.cssText="display: flex; justify-content: flex-end; padding-top: 12px; border-top: 1px solid var(--background-modifier-border);";let s=o.createEl("button");s.textContent="Done",s.style.cssText="padding: 8px 20px; border: none; background: var(--interactive-accent); color: var(--text-on-accent); border-radius: 4px; cursor: pointer; font-weight: 500;",s.onclick=()=>this.close()}onClose(){let{contentEl:t}=this;t.empty()}},xP=class extends wP.Modal{constructor(t,r,n,i){super(t),this.titleEl.setText("Clean Up Backup Files"),this.modalEl.addClass("jl-legacy-migration-modal"),this.fileCount=r,this.onConfirm=n,this.onCancel=i}onOpen(){let{contentEl:t}=this;t.empty(),HF();let r=t.createDiv();r.style.cssText="padding: 20px; font-family: var(--default-font);";let n=r.createEl("p");n.innerHTML=`Found <strong>${this.fileCount}</strong> backup file${this.fileCount!==1?"s":""} (<code>.legacy.md.bak</code>) from the migration.`,n.style.cssText="margin: 0 0 16px 0; color: var(--text-normal); font-size: 14px; line-height: 1.5;";let i=r.createDiv();i.style.cssText="background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); padding: 12px; border-radius: 6px; margin-bottom: 16px;";let a=i.createEl("p");a.innerHTML="<strong>Warning:</strong> This action cannot be undone. Only delete backups after verifying your migrated notes work correctly.",a.style.cssText="margin: 0; color: var(--text-normal); font-size: 13px; line-height: 1.5;";let o=r.createDiv();o.style.cssText="background: var(--background-secondary); padding: 12px; border-radius: 6px; margin-bottom: 20px;";let s=o.createEl("p");s.innerHTML="<strong>Before deleting, verify:</strong>",s.style.cssText="margin: 0 0 8px 0; color: var(--text-normal); font-size: 13px;";let l=o.createEl("ul");l.style.cssText="margin: 0; padding-left: 20px; color: var(--text-muted); font-size: 13px; line-height: 1.6;",["DRC notes display correctly with all widgets","Weekly review notes show your data","Monthly review notes render properly","Your review questions and answers are preserved"].forEach(m=>{let g=l.createEl("li");g.textContent=m});let d=r.createDiv();d.style.cssText="display: flex; justify-content: flex-end; gap: 10px; padding-top: 12px; border-top: 1px solid var(--background-modifier-border);";let u=d.createEl("button");u.textContent="Keep Backups",u.style.cssText="padding: 8px 16px; border: 1px solid var(--background-modifier-border); background: var(--background-primary); color: var(--text-normal); border-radius: 4px; cursor: pointer;",u.onclick=()=>{this.close(),this.onCancel()};let p=d.createEl("button");p.textContent="Delete Backups",p.style.cssText="padding: 8px 20px; border: none; background: #ef4444; color: white; border-radius: 4px; cursor: pointer; font-weight: 500;",p.onclick=()=>{this.close(),this.onConfirm()}}onClose(){let{contentEl:t}=this;t.empty()}}});var obe={};Ti(obe,{BackupCleanupConfirmModal:()=>xP,DRCConverter:()=>Zw,LegacyMigrationCompleteModal:()=>ng,LegacyMigrationConfirmModal:()=>tg,LegacyMigrationProgressModal:()=>rg,LegacyMigrationService:()=>ev,MIGRATION_ID:()=>Zh,MonthlyConverter:()=>tk,WeeklyConverter:()=>ek});var dq=F(()=>{cq();oq();sq();lq();qF()});var fu,lbe,cbe=F(()=>{fu=Y(Q()),lbe=({currentStep:e,totalSteps:t,stepLabels:r,className:n=""})=>{let i=Math.max(0,Math.min(100,e/t*100));return fu.default.createElement("div",{className:`wizard-progress-container ${n}`,role:"progressbar","aria-valuenow":e,"aria-valuemin":0,"aria-valuemax":t,"aria-label":`Step ${e} of ${t}`,tabIndex:0},fu.default.createElement("div",{className:"wizard-steps"},Array.from({length:t},(a,o)=>{let s=o+1,l=s<e,c=s===e,d=r==null?void 0:r[o];return fu.default.createElement("div",{key:s,className:`wizard-step ${l?"completed":""} ${c?"current":""}`,"aria-label":d?`${d}${l?" (completed)":c?" (current)":""}`:`Step ${s}`},fu.default.createElement("div",{className:"wizard-step-circle"},l?fu.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none","aria-hidden":"true"},fu.default.createElement("path",{d:"M2 6L5 9L10 3",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})):fu.default.createElement("span",{className:"wizard-step-number","aria-hidden":"true"},s)),d&&fu.default.createElement("div",{className:"wizard-step-label"},d))})),fu.default.createElement("div",{className:"wizard-progress-track","aria-hidden":"true"},fu.default.createElement("div",{className:"wizard-progress-fill",style:{width:`${i}%`}})),fu.default.createElement("div",{className:"sr-only","aria-live":"polite","aria-atomic":"true"},"Step ",e," of ",t," completed",(r==null?void 0:r[e-1])&&`: ${r[e-1]}`))}});var ti,uq,YF=F(()=>{ti=[{id:"welcome",title:"Welcome to Journalit",description:"Your journey to better trading begins here",isOptional:!0},{id:"goal",title:"What's your goal?",description:"Help us personalize your experience"},{id:"segmentation",title:"Tell us about your trading",description:"Personalize your experience"},{id:"first-action",title:"Create your first trade",description:"Experience the core value immediately"},{id:"authentication",title:"Connect account",description:"Enable advanced features and sync",isOptional:!0,shouldShow:e=>e==="automation"},{id:"ftp-credentials",title:"Setup MT sync",description:"Automatic trade report collection",isOptional:!0,shouldShow:e=>e==="automation"},{id:"completion",title:"You're all set!",description:"Start your trading journey"}],uq=[{id:"create_trade",title:"Create your first Trade note",description:"Document your first trade to get started",completed:!1},{id:"generate_setup",title:"Add at least one Setup",description:"Define your trading strategies",completed:!1},{id:"tag_trade_outcome",title:"Tag a trade as Winner/Loser",description:"Track your trade performance",completed:!1,dependsOn:["create_trade"]},{id:"enable_mt5_sync",title:"Turn on MT5 Auto-Sync (beta free)",description:"Automate your trade data collection",completed:!1,isOptional:!0}]});function KF(e="email-auth-modal-styles"){if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=`
    /* === EmailAuthModal base styles ==================== */
    .email-auth-modal { padding: 20px; max-width: 400px; margin: 0 auto; }
    .email-auth-modal h3 { margin: 0 0 16px; font-size: 18px; font-weight: 600; color: var(--text-normal); }
    .modal-description { margin: 0 0 20px; color: var(--text-muted); line-height: 1.4; }
    .modal-field { margin-bottom: 16px; }
    .modal-field label { display: block; margin-bottom: 6px; font-weight: 500; color: var(--text-normal); }
    .modal-input { width: 100%; padding: 8px 12px; border: 1px solid var(--background-modifier-border); border-radius: 4px; background: var(--background-primary); color: var(--text-normal); font-size: 16px; }
    .modal-input:focus { outline: none; border-color: var(--interactive-accent); box-shadow: 0 0 0 2px var(--interactive-accent-hover); }
    .modal-input:disabled { opacity: 0.6; cursor: not-allowed; }
    .code-input { font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace; font-size: 16px; letter-spacing: 2px; text-align: center; }
    .modal-error { margin: 8px 0; padding: 8px 12px; background: var(--background-modifier-error); border: 1px solid var(--text-error); border-radius: 4px; color: var(--text-on-accent, #fff); font-size: 13px; font-weight: 500; text-align: center; }
    .modal-actions { display: flex; gap: 8px; margin-top: 20px; flex-wrap: wrap; }
    .modal-actions button { flex: 1 1 auto; min-width: 90px; white-space: nowrap; }
    .modal-footer { margin-top: 20px; padding-top: 16px; border-top: 1px solid var(--background-modifier-border); }
    .modal-footer-text { margin: 0; font-size: 12px; color: var(--text-muted); line-height: 1.3; }
    @media (max-width: 600px) {
      .modal-input { font-size: 18px !important; }
    }
    @media (max-width: 480px) {
      .modal-actions { flex-direction: column; }
      .modal-actions button { width: 100%; }
    }
  `,document.head.appendChild(t)}var pq=F(()=>{});var rk,Pc,tv=F(()=>{rk=Y(Q()),Pc=({title:e,subtitle:t,icon:r,className:n="",children:i})=>rk.default.createElement("div",{className:`onboarding-slide ${n}`},r&&rk.default.createElement("div",{className:"step-icon"},r),rk.default.createElement("h2",null,e),t&&rk.default.createElement("p",null,t),rk.default.createElement("div",{className:"step-content"},i))});var nk,JF,mq=F(()=>{nk=Y(Q()),JF=({icon:e,title:t,content:r,isPreview:n=!1,className:i=""})=>{let a=n?"insight-preview-card":"insight-card",o=n?"insight-preview-header":"insight-header",s=n?"insight-preview-icon":"insight-icon",l=n?"insight-preview-content":"insight-detail";return nk.default.createElement("div",{className:`${a} ${i}`},nk.default.createElement("div",{className:o},nk.default.createElement("span",{className:s},e),nk.default.createElement("strong",null,t)),nk.default.createElement("div",{className:l},r))}});var Xl,fq,dbe=F(()=>{Xl=Y(Q());Ot();tv();mq();fq=({className:e=""})=>{let t=[{icon:Xl.default.createElement(Es,{size:20}),title:"Win Rate Analysis",content:'"Your breakout setups have an 82% win rate vs 67% for pullbacks"'},{icon:Xl.default.createElement(Cd,{size:20}),title:"Timing Patterns",content:'"Trades held 2-4 hours show 3x better risk-reward than scalps"'},{icon:Xl.default.createElement(Km,{size:20}),title:"Psychology Tracking",content:'"You take profits 15% too early when up more than $500"'}],r=["Your data, your device - Complete ownership and control","Works with any broker - MetaTrader sync + manual entry","Fully customizable - Track what matters to you"];return Xl.default.createElement(Pc,{title:"Welcome to Journalit",subtitle:"The trading journal that helps you turn insights into profits",className:`welcome-slide ${e}`},Xl.default.createElement("div",{className:"welcome-preview-section"},Xl.default.createElement("h3",null,"What you'll discover:"),Xl.default.createElement("div",{className:"insights-preview"},t.map((n,i)=>Xl.default.createElement(JF,{key:i,icon:n.icon,title:n.title,content:n.content,isPreview:!0})))),Xl.default.createElement("div",{className:"welcome-trust-indicators"},r.map((n,i)=>Xl.default.createElement("div",{key:i,className:"trust-item"},Xl.default.createElement("span",{className:"trust-icon"},Xl.default.createElement(Aa,{size:16})),Xl.default.createElement("span",null,n)))),Xl.default.createElement("div",{className:"welcome-tagline"},"Let's get you set up in under 60 seconds"))}});var ig,gq,ube=F(()=>{ig=Y(Q());Ot();tv();YE();gq=({selectedGoal:e,onGoalSelect:t,className:r=""})=>{let n=[{value:"psychology",label:"Understand My Trading Psychology",description:"Identify emotional patterns and improve decision-making to become a more disciplined trader",badge:"Build better habits",icon:ig.default.createElement(Km,{size:24})},{value:"patterns",label:"Find Performance Patterns",description:"Discover what makes your winning trades different and optimize your strategy for consistent profits",badge:"Most popular",icon:ig.default.createElement(Es,{size:24})},{value:"automation",label:"Automate Everything",description:"Focus on trading while we handle the tracking - automatic data collection and analysis",badge:"Time saver",icon:ig.default.createElement(of,{size:24})}],i=a=>{switch(a){case"psychology":return"Understand My Trading Psychology";case"patterns":return"Find Performance Patterns";case"automation":return"Automate Everything";default:return""}};return ig.default.createElement(Pc,{title:"What's your trading goal?",subtitle:`Choose the approach that best fits your needs.
You can change this later.`,className:`goal-slide ${r}`},ig.default.createElement(Xv,{options:n,selectedValue:e,onSelect:t,variant:"goal"}),e&&ig.default.createElement("div",{className:"goal-selection-info"},ig.default.createElement(Fi,{size:16})," You selected: ",ig.default.createElement("strong",null,i(e))))}});var ik,pbe,mbe=F(()=>{ik=Y(Q());Ot();pbe=({options:e,selectedValues:t,onSelectionChange:r,className:n=""})=>{let i=a=>{let o=t.includes(a)?t.filter(s=>s!==a):[...t,a];r(o)};return ik.default.createElement("div",{className:`multi-select-options ${n}`},e.map(a=>{let o=t.includes(a.value);return ik.default.createElement("div",{key:a.value,className:`multi-select-option ${o?"selected":""}`,onClick:()=>i(a.value),role:"button",tabIndex:0,onKeyPress:s=>s.key==="Enter"&&i(a.value)},ik.default.createElement("div",{className:"option-checkbox"},o&&ik.default.createElement(Fi,{size:16})),ik.default.createElement("span",{className:"option-label"},a.label))}))}});var gu,hq,fbe=F(()=>{gu=Y(Q());tv();mbe();YE();hq=({userSegmentation:e,onSegmentationChange:t,className:r=""})=>{let n=[{value:"stocks",label:"Stocks"},{value:"forex",label:"Forex"},{value:"crypto",label:"Crypto"},{value:"options",label:"Options"},{value:"futures",label:"Futures"}],i=[{value:"daily",label:"Daily",description:"Multiple trades per day"},{value:"weekly",label:"Weekly",description:"1-5 trades per week"},{value:"monthly",label:"Monthly",description:"Less than 5 trades per month"},{value:"occasional",label:"Occasionally",description:"When good opportunities arise"}],a=[{value:"emotional-control",label:"Emotional Control",description:"Managing fear and greed in trades"},{value:"strategy-optimization",label:"Strategy Optimization",description:"Finding and refining profitable setups"},{value:"record-keeping",label:"Record Keeping",description:"Consistently tracking all trades and data"},{value:"risk-management",label:"Risk Management",description:"Setting proper position sizes and stops"}],o=c=>{t({...e,instruments:c})},s=c=>{t({...e,frequency:c})},l=c=>{t({...e,challenge:c})};return gu.default.createElement(Pc,{title:"Tell us about your trading",subtitle:"Help us personalize your experience based on your trading style.",className:`segmentation-slide ${r}`},gu.default.createElement("div",{className:"segmentation-questions"},gu.default.createElement("div",{className:"segmentation-question"},gu.default.createElement("h3",null,"What do you primarily trade? (Select all that apply)"),gu.default.createElement(pbe,{options:n,selectedValues:e.instruments,onSelectionChange:o})),gu.default.createElement("div",{className:"segmentation-question"},gu.default.createElement("h3",null,"How often do you trade?"),gu.default.createElement(Xv,{options:i,selectedValue:e.frequency,onSelect:s})),gu.default.createElement("div",{className:"segmentation-question"},gu.default.createElement("h3",null,"What's your biggest challenge?"),gu.default.createElement(Xv,{options:a,selectedValue:e.challenge,onSelect:l}))))}});var hm,ak,QF=F(()=>{hm=Y(Q());Ot();ak=({title:e,subtitle:t,actions:r,children:n,className:i=""})=>hm.default.createElement("div",{className:`success-state ${i}`},hm.default.createElement("div",{className:"success-checkmark"},hm.default.createElement(Aa,{size:48})),hm.default.createElement("h3",null,e),t&&hm.default.createElement("p",null,t),r&&r.length>0&&hm.default.createElement("div",{className:"success-actions"},r.map((a,o)=>hm.default.createElement("div",{key:o,className:"success-action"},hm.default.createElement("span",{className:"action-icon"},a.icon),hm.default.createElement("span",null,a.text)))),n)});var Mr,vq,gbe=F(()=>{Mr=Y(Q());Ot();tv();QF();mq();hi();ph();vq=({goal:e,userSegmentation:t,sampleTradeCreated:r,sampleTradeFilePath:n,isLoading:i,onCreateSampleTrade:a,className:o=""})=>{let s=()=>{let d=t.instruments[0]||"stocks",u=t.frequency,p;switch(d){case"forex":p={trade:"EURUSD Long (+70 pips)",timeframe:u==="daily"?"30min scalp":u==="weekly"?"3-day swing":"1-week position"};break;case"crypto":p={trade:"BTC/USD Long (+$1,700)",timeframe:u==="daily"?"1-hour momentum":u==="weekly"?"3-day breakout":"1-week trend"};break;case"options":p={trade:"AAPL Call (+64% profit)",timeframe:u==="daily"?"0DTE scalp":u==="weekly"?"30DTE swing":"60DTE position"};break;default:p={trade:"AAPL Long (+$625 profit)",timeframe:u==="daily"?"30min momentum":u==="weekly"?"3-day swing":"1-week position"}}return{...p,focus:{"emotional-control":"Psychology tracking","strategy-optimization":"Setup analysis","record-keeping":"Complete documentation","risk-management":"Risk metrics"}[t.challenge],tags:`demo-trade, ${d}`}},l=()=>{switch(e){case"psychology":return[{icon:Mr.default.createElement(Km,{size:16}),title:"Emotional Analysis",content:"You held this trade for the full plan despite a 15% drawdown. This discipline is what separates profitable traders from emotional ones."},{icon:Mr.default.createElement(dT,{size:16}),title:"Patience Tracking",content:"By waiting for your full profit target, you earned 40% more than if you had taken early profits at the first sign of strength."},{icon:Mr.default.createElement($c,{size:16}),title:"Confidence Building",content:"Trades like this, where you stick to your plan, build psychological capital for bigger positions in the future."}];case"patterns":return[{icon:Mr.default.createElement(Es,{size:16}),title:"Setup Performance",content:"This breakout pattern has an 82% win rate in your trading history - significantly higher than pullback entries at 67%."},{icon:Mr.default.createElement(Cd,{size:16}),title:"Timing Optimization",content:"Entries between 10-11 AM ET show 3x better risk-reward ratios than afternoon trades in this setup type."},{icon:Mr.default.createElement(_x,{size:16}),title:"Pattern Recognition",content:"This setup appears 2-3 times per week in your preferred instruments. Journalit will alert you to similar patterns."}];default:return[{icon:Mr.default.createElement(of,{size:16}),title:"Automation Ready",content:"This trade was automatically imported from MetaTrader with complete data - no manual entry required."},{icon:Mr.default.createElement(Es,{size:16}),title:"Real-time Sync",content:"Your risk metrics updated live during the trade, showing exactly when to scale out or add to positions."},{icon:Mr.default.createElement(gT,{size:16}),title:"Effortless Tracking",content:"With full automation, you can focus on trading decisions while Journalit handles all the data collection and analysis."}]}},c=s();if(r){let d=l();return Mr.default.createElement("div",{className:`first-action-slide ${o}`},Mr.default.createElement(ak,{title:"Great! Here's what we learned from your sample trade:",className:"first-action-success"},Mr.default.createElement("div",{className:"trade-insights"},d.map((u,p)=>Mr.default.createElement(JF,{key:p,icon:u.icon,title:u.title,content:u.content}))),n&&Mr.default.createElement("div",{className:"sample-trade-path"},Mr.default.createElement("small",null,"Trade created at: ",n))))}return Mr.default.createElement(Pc,{title:"Experience Journalit in action",subtitle:"Let's create a sample trade note so you can see how everything works.",icon:Mr.default.createElement(Ep,{size:20}),className:`first-action-slide ${o}`},Mr.default.createElement("div",{className:"first-action-content"},Mr.default.createElement("div",{className:"first-action-preview"},Mr.default.createElement("h3",null,"What we'll create based on your trading style:"),Mr.default.createElement("div",{className:"sample-trade-preview"},Mr.default.createElement("div",{className:"preview-row"},Mr.default.createElement("span",{className:"preview-label"},Mr.default.createElement($c,{size:16})," Trade:"),Mr.default.createElement("span",{className:"preview-value"},c.trade)),Mr.default.createElement("div",{className:"preview-row"},Mr.default.createElement("span",{className:"preview-label"},Mr.default.createElement(Cd,{size:16})," Style:"),Mr.default.createElement("span",{className:"preview-value"},c.timeframe)),Mr.default.createElement("div",{className:"preview-row"},Mr.default.createElement("span",{className:"preview-label"},Mr.default.createElement(_x,{size:16})," Focus:"),Mr.default.createElement("span",{className:"preview-value"},c.focus)),Mr.default.createElement("div",{className:"preview-row"},Mr.default.createElement("span",{className:"preview-label"},Mr.default.createElement(nf,{size:16})," Tags:"),Mr.default.createElement("span",{className:"preview-value"},c.tags)))),Mr.default.createElement(Ie,{onClick:a,disabled:i,variant:"primary",size:"large",className:"create-sample-button",autoFocus:!0},Mr.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"center"}},i?Mr.default.createElement(Io,{size:"small",message:""}):Mr.default.createElement(Ip,{size:18}),i?"Creating your sample trade...":"Create Sample Trade")),Mr.default.createElement("p",{className:"first-action-note"},"This creates a real trade note in your vault that you can explore and delete later.")))}});var XF,hbe=F(()=>{XF=class extends Error{constructor(t,r,n){super(t),this.name="ApiError",this.statusCode=r,this.context=n}}});function bq(){var e,t,r,n;if(typeof window!="undefined")try{let i=window.journalitPlugin||((t=(e=app==null?void 0:app.plugins)==null?void 0:e.plugins)==null?void 0:t.journalit);if((n=(r=i==null?void 0:i.settings)==null?void 0:r.backendIntegration)!=null&&n.serverUrl)return i.settings.backendIntegration.serverUrl}catch(i){}return vbe}var yq,vbe,Bt,vm=F(()=>{yq=require("obsidian");Bu();hbe();vbe="https://api.journalit.co";Bt=class{static setAuthToken(t){this.authToken=t}static getAuthToken(){return this.authToken}static requiresAuth(t){return["/api/v1/trades","/api/v1/mt-accounts","/api/v1/obsidian/status","/api/v1/obsidian/register-vault","/api/v1/ftp-users","/api/v1/sync/ftp","/api/v1/csv"].some(n=>t.includes(n))}static getHeaders(t={}){let r={"Content-Type":"application/json","Accept-Language":"en-US",...t};return this.authToken&&this.requiresAuth(t["x-endpoint"]||"")&&(r.Authorization=`Bearer ${this.authToken}`),delete r["x-endpoint"],r}static async makeRequest(t,r={},n="API call",i=0){if(r.method==="GET"||!r.method){let l=this.getCachedResponse(t);if(l!==null)return l}let a={...r.headers,"x-endpoint":t},o=this.getHeaders(a),s={...r,headers:o};return new Promise((l,c)=>{let d={url:t,options:s,context:n,resolve:l,reject:c,retryCount:0,priority:i};this.requestQueue.push(d),this.requestQueue.sort((u,p)=>p.priority-u.priority),this.isProcessingQueue||this.processQueue()})}static async processQueue(){if(!this.isProcessingQueue){for(this.isProcessingQueue=!0;this.requestQueue.length>0&&this.activeRequests<this.MAX_CONCURRENT_REQUESTS;){let r=Date.now()-this.lastRequestTime;r<this.RATE_LIMIT_DELAY_MS&&await new Promise(i=>setTimeout(i,this.RATE_LIMIT_DELAY_MS-r));let n=this.requestQueue.shift();n&&(this.activeRequests++,this.lastRequestTime=Date.now(),this.executeRequest(n).finally(()=>{this.activeRequests--,this.requestQueue.length>0&&this.processQueue()}))}this.isProcessingQueue=!1}}static async executeRequest(t){var r,n,i;try{let a=await(0,yq.requestUrl)({url:t.url,method:t.options.method||"GET",headers:t.options.headers,body:t.options.body,throw:!1});if(a.status<200||a.status>=300){if((a.status===429||a.status>=500)&&t.retryCount<this.MAX_RETRY_ATTEMPTS){await this.retryRequest(t);return}let s={operation:t.context,endpoint:t.url,statusCode:a.status};throw new XF(`API Error: ${a.status}`,a.status,s)}let o=null;if(a.status!==204&&a.headers["content-length"]!=="0"){let s=a.headers["content-type"];if(s&&s.includes("application/json"))try{o=a.json}catch(l){console.warn("Failed to parse JSON response, treating as empty:",l),o=null}}(t.options.method==="GET"||!t.options.method)&&this.setCachedResponse(t.url,o),t.resolve(o)}catch(a){if(a instanceof Error&&((r=a.message)!=null&&r.includes("API Error: 400"))&&t.context.toLowerCase().includes("verify authentication code")||a instanceof Error&&((n=a.message)!=null&&n.includes("API Error: 429"))&&t.context.toLowerCase().includes("verification code")){console.warn(`Auth verification failed (${t.context}):`,a),t.resolve(null);return}t.retryCount<this.MAX_RETRY_ATTEMPTS&&(a.name==="TypeError"||a instanceof Error&&((i=a.message)!=null&&i.includes("fetch")))?await this.retryRequest(t):(this.handleError(a,t.context),t.resolve(null))}}static async retryRequest(t){t.retryCount++;let r=this.RETRY_DELAY_BASE_MS*Math.pow(2,t.retryCount-1);await new Promise(n=>setTimeout(n,r)),t.priority+=10,this.requestQueue.unshift(t),this.isProcessingQueue||this.processQueue()}static getCachedResponse(t){let r=this.responseCache.get(t);return r?Date.now()-r.timestamp>this.CACHE_TTL_MS?(this.responseCache.delete(t),null):r.data:null}static setCachedResponse(t,r){if(this.responseCache.set(t,{data:r,timestamp:Date.now()}),this.responseCache.size>100){let n=Array.from(this.responseCache.entries()).sort((i,a)=>i[1].timestamp-a[1].timestamp);for(let i=0;i<20;i++)this.responseCache.delete(n[i][0])}}static handleError(t,r){let n=t.context||{operation:r,endpoint:t.endpoint,statusCode:t.statusCode};return Be.handleError(t,n),null}static async checkHealth(){try{let t=await(0,yq.requestUrl)({url:`${bq()}/api/v1/health`,method:"GET",throw:!1});return t.status>=200&&t.status<300}catch(t){return!1}}static buildUrl(t,r){let n=new URL(`${bq()}${t}`);return r&&Object.entries(r).forEach(([i,a])=>{a!=null&&n.searchParams.append(i,String(a))}),n.toString()}static clearQueue(){this.requestQueue.forEach(t=>{t.reject(new Error("Request queue cleared"))}),this.requestQueue=[],this.isProcessingQueue=!1}static getQueueStatus(){return{queueLength:this.requestQueue.length,activeRequests:this.activeRequests,cacheSize:this.responseCache.size}}static clearCache(){this.responseCache.clear()}static invalidateCache(t){let r=typeof t=="string"?new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")):t,n=0;for(let[i]of this.responseCache)r.test(i)&&(this.responseCache.delete(i),n++);n>0}};Bt.requestQueue=[],Bt.activeRequests=0,Bt.MAX_CONCURRENT_REQUESTS=3,Bt.RATE_LIMIT_DELAY_MS=200,Bt.lastRequestTime=0,Bt.isProcessingQueue=!1,Bt.MAX_RETRY_ATTEMPTS=3,Bt.RETRY_DELAY_BASE_MS=1e3,Bt.responseCache=new Map,Bt.CACHE_TTL_MS=300*1e3,Bt.authToken=null});var Gt,ok,xq,ZF,wq=F(()=>{Gt=Y(Q()),ok=require("obsidian");hi();ph();vm();pq();xq=({onSuccess:e,onCancel:t,isAuthenticated:r=!1,currentUserEmail:n})=>{let[i,a]=(0,Gt.useState)("email"),[o,s]=(0,Gt.useState)(""),[l,c]=(0,Gt.useState)(""),[d,u]=(0,Gt.useState)(!1),[p,m]=(0,Gt.useState)(null),[g,f]=(0,Gt.useState)(null),[v,h]=(0,Gt.useState)(0);(0,Gt.useEffect)(()=>{if(g&&i==="code"){let w=setInterval(()=>{let C=Math.floor((Date.now()-g)/1e3),D=Math.max(0,60-C);h(D),D===0&&clearInterval(w)},1e3);return()=>clearInterval(w)}},[g,i]);let y=async()=>{if(!o.trim()){m("Please enter a valid email address");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o.trim())){m("Please enter a valid email address");return}u(!0),m(null);try{let C=await Bt.makeRequest(Bt.buildUrl("/auth/beta/send-code"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o.trim()})},"Send verification code",10);if((C==null?void 0:C.status)==="success")a("code"),f(Date.now()),h(60),new ok.Notice("Verification code sent! Check your email.");else throw new Error((C==null?void 0:C.message)||"Failed to send verification code")}catch(C){console.error("Error sending verification code:",C);let D=C instanceof Error&&C.message.includes("Too Many Requests")?"You have requested too many codes. Please wait 30 minutes and try again.":C instanceof Error?C.message:"Failed to send verification code";m(D)}finally{u(!1)}},b=async()=>{if(!l.trim()){m("Please enter the verification code");return}if(!/^\d{6}$/.test(l.trim())){m("Verification code should be 6 digits");return}u(!0),m(null);try{let w=await Bt.makeRequest(Bt.buildUrl("/auth/beta/verify"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o.trim(),code:l.trim()})},"Verify authentication code",10);if((w==null?void 0:w.status)==="success"&&w.token&&w.user)await e(w.token,w.user),new ok.Notice("Successfully logged in!");else throw new Error((w==null?void 0:w.message)||"Invalid verification code")}catch(w){console.error("Error verifying code:",w),m(w instanceof Error?w.message:"Failed to verify code")}finally{u(!1)}},k=async()=>{u(!0),m(null);try{let w=await Bt.makeRequest(Bt.buildUrl("/auth/beta/send-code"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o.trim()})},"Resend verification code",10);if((w==null?void 0:w.status)==="success")f(Date.now()),h(60),c(""),new ok.Notice("New verification code sent! Check your email.");else throw new Error((w==null?void 0:w.message)||"Failed to resend verification code")}catch(w){console.error("Error resending verification code:",w),m(w instanceof Error?w.message:"Failed to resend verification code")}finally{u(!1)}},x=()=>{a("email"),c(""),m(null),f(null),h(0)},S=(w,C)=>{w.key==="Enter"&&!d&&C()};return Gt.default.createElement("div",{className:"email-auth-modal"},r?Gt.default.createElement(Gt.default.Fragment,null,Gt.default.createElement("h3",null,"Already Logged In"),Gt.default.createElement("p",{className:"modal-description"},"You are already logged in",n?` as ${n}`:"","."),Gt.default.createElement("div",{className:"modal-actions"},Gt.default.createElement(Ie,{onClick:t,variant:"primary"},"Close"))):Gt.default.createElement(Gt.default.Fragment,null,Gt.default.createElement("h3",null,"Sign In to Journalit"),i==="email"&&Gt.default.createElement(Gt.default.Fragment,null,Gt.default.createElement("p",{className:"modal-description"},"Enter your email address to receive a verification code for access to the private beta."),Gt.default.createElement("div",{className:"modal-field"},Gt.default.createElement("label",{htmlFor:"email-input"},"Email Address"),Gt.default.createElement("input",{id:"email-input",type:"email",value:o,onChange:w=>{s(w.target.value),m(null)},onKeyPress:w=>S(w,y),placeholder:"your.email@example.com",className:"modal-input",disabled:d,autoFocus:!0})),p&&Gt.default.createElement("div",{className:"modal-error"},p),Gt.default.createElement("div",{className:"modal-actions"},Gt.default.createElement(Ie,{onClick:y,disabled:d||!o.trim(),variant:"primary"},Gt.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"center"}},d&&Gt.default.createElement(Io,{size:"small",message:""}),d?"Sending...":"Send Verification Code")))),i==="code"&&Gt.default.createElement(Gt.default.Fragment,null,Gt.default.createElement("p",{className:"modal-description"},"We've sent a 6-digit verification code to ",Gt.default.createElement("strong",null,o),". Please enter it below to complete your sign-in."),Gt.default.createElement("div",{className:"modal-field"},Gt.default.createElement("label",{htmlFor:"code-input"},"Verification Code"),Gt.default.createElement("input",{id:"code-input",type:"text",value:l,onChange:w=>{let C=w.target.value.replace(/\D/g,"").slice(0,6);c(C),m(null)},onKeyPress:w=>S(w,b),placeholder:"123456",className:"modal-input code-input",disabled:d,autoFocus:!0,maxLength:6})),p&&Gt.default.createElement("div",{className:"modal-error"},p),Gt.default.createElement("div",{className:"modal-actions"},Gt.default.createElement(Ie,{onClick:b,disabled:d||l.length!==6,variant:"primary"},Gt.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"center"}},d&&Gt.default.createElement(Io,{size:"small",message:""}),d?"Verifying...":"Verify & Sign In")),v===0&&Gt.default.createElement(Ie,{onClick:k,disabled:d,variant:"secondary"},"Resend Code"),Gt.default.createElement(Ie,{onClick:x,disabled:d,variant:"secondary"},"Back"))),Gt.default.createElement("div",{className:"modal-footer"},Gt.default.createElement("p",{className:"modal-footer-text"},"Having trouble? The verification code expires in 15 minutes.",i==="code"&&v>0&&Gt.default.createElement(Gt.default.Fragment,null," You can request a new code in ",v," seconds."),i==="code"&&v===0&&Gt.default.createElement(Gt.default.Fragment,null," You can now resend the code using the button above."),i==="email"&&Gt.default.createElement(Gt.default.Fragment,null," Enter your email to receive a verification code.")))))},ZF=class extends ok.Modal{constructor(r,n,i){super(r);this.root=null;this.onSuccess=n,this.onCancel=i}async onOpen(){let{contentEl:r}=this;r.empty(),KF();let n=r.createDiv(),{createRoot:i}=Ni();this.root=i(n),this.root.render(Gt.default.createElement(xq,{onSuccess:async(a,o)=>{await this.onSuccess(a,o),this.close()},onCancel:()=>{this.onCancel(),this.close()}}))}onClose(){this.root&&(this.root.unmount(),this.root=null);let{contentEl:r}=this;r.empty()}}});var rv,kq,ybe=F(()=>{rv=Y(Q());Ot();tv();QF();wq();kq=({isAuthenticated:e,onAuthSuccess:t,onAuthCancel:r,className:n=""})=>e?rv.default.createElement("div",{className:`authentication-slide ${n}`},rv.default.createElement(ak,{title:"Account connected successfully!",subtitle:"You now have access to all Pro features including MetaTrader sync.",className:"auth-success"})):rv.default.createElement(Pc,{title:rv.default.createElement("span",{style:{display:"flex",alignItems:"center",gap:"8px"}},rv.default.createElement(El,{size:20}),"Connect your account"),subtitle:"Sign in to unlock MetaTrader sync and advanced features.",className:`authentication-slide ${n}`},rv.default.createElement("div",{className:"auth-component-wrapper"},rv.default.createElement(xq,{onSuccess:t,onCancel:r})))});var Pt,Sq,bbe=F(()=>{Pt=Y(Q());Ot();tv();QF();hi();ph();Sq=({ftpCredentialsGenerated:e,ftpCredentials:t,isLoading:r,onGenerateFtpCredentials:n,onCopyToClipboard:i,className:a=""})=>{let o=[{icon:Pt.default.createElement(El,{size:16}),text:"Secure FTP credentials for your MetaTrader"},{icon:Pt.default.createElement(of,{size:16}),text:"Automatic report upload and processing"},{icon:Pt.default.createElement(Es,{size:16}),text:"Real-time trade data in your journal"}];return e&&t?Pt.default.createElement("div",{className:`ftp-credentials-slide ${a}`,style:{marginTop:"-20px"}},Pt.default.createElement(ak,{title:"Your FTP credentials are ready!",subtitle:"Configure these settings in your MetaTrader platform:",className:"ftp-credentials-display"},Pt.default.createElement("div",{className:"credentials-container"},Pt.default.createElement("div",{className:"credential-row"},Pt.default.createElement("span",{className:"credential-label"},"FTP server:"),Pt.default.createElement("div",{className:"credential-value-container"},Pt.default.createElement("code",{className:"credential-value"},t.host,":",t.port),Pt.default.createElement(Ie,{size:"small",variant:"secondary",onClick:()=>i(`${t.host}:${t.port}`,"FTP Server")},Pt.default.createElement(Pd,{size:16})))),Pt.default.createElement("div",{className:"credential-row"},Pt.default.createElement("span",{className:"credential-label"},"Path:"),Pt.default.createElement("div",{className:"credential-value-container"},Pt.default.createElement("code",{className:"credential-value"},"(leave empty)"),Pt.default.createElement(Ie,{size:"small",variant:"secondary",onClick:()=>i("","Path")},Pt.default.createElement(Pd,{size:16})))),Pt.default.createElement("div",{className:"credential-row"},Pt.default.createElement("span",{className:"credential-label"},"FTP login:"),Pt.default.createElement("div",{className:"credential-value-container"},Pt.default.createElement("code",{className:"credential-value"},t.username),Pt.default.createElement(Ie,{size:"small",variant:"secondary",onClick:()=>i(t.username,"Username")},Pt.default.createElement(Pd,{size:16})))),Pt.default.createElement("div",{className:"credential-row"},Pt.default.createElement("span",{className:"credential-label"},"FTP password:"),Pt.default.createElement("div",{className:"credential-value-container"},Pt.default.createElement("code",{className:"credential-value"},"\u2022".repeat(t.password.length)),Pt.default.createElement(Ie,{size:"small",variant:"secondary",onClick:()=>i(t.password,"Password")},Pt.default.createElement(Pd,{size:16}))))),Pt.default.createElement("div",{className:"ftp-setup-note",style:{marginTop:"20px"}},Pt.default.createElement("p",{style:{marginBottom:"8px"}},Pt.default.createElement("strong",null,"Next Steps:")),Pt.default.createElement("ol",{style:{paddingLeft:"20px",margin:"0"}},Pt.default.createElement("li",null,"Open MT5"),Pt.default.createElement("li",null,'Click on the "Tools" menu at the top'),Pt.default.createElement("li",null,'Go to "Options"'),Pt.default.createElement("li",null,'Go to the "FTP" tab & enter the credentials provided above'),Pt.default.createElement("li",null,"Enable Passive mode"),Pt.default.createElement("li",null,"Enable automatic publishing of reports via FTP (Refresh every 60 minutes)"))),Pt.default.createElement("div",{className:"ftp-test-note",style:{marginTop:"16px",color:"#8a2be2"}},Pt.default.createElement("p",{style:{margin:"0"}},Pt.default.createElement("strong",null,'Clicking "Test" will send your first sync through to our server! You will need to go into the plugin settings to "Force Sync" the trades.')),Pt.default.createElement("p",{style:{margin:"4px 0 0 0",fontSize:"0.9em"}},"(if you have any trades in your MT account)")))):Pt.default.createElement(Pc,{title:"Setup MetaTrader sync",subtitle:"Generate your FTP credentials to enable automatic trade collection from MT4/MT5.",icon:Pt.default.createElement(Vv,{size:24}),className:`ftp-credentials-slide ${a}`},Pt.default.createElement("div",{className:"ftp-security-note"},Pt.default.createElement("div",{className:"security-highlight"},Pt.default.createElement("span",{className:"security-icon"},Pt.default.createElement(Kv,{size:16})),Pt.default.createElement("span",null,Pt.default.createElement("strong",null,"100% secure:")," We never have access to your trading account - only reports are uploaded"))),Pt.default.createElement("div",{className:"ftp-generate-section"},Pt.default.createElement("div",{className:"ftp-info"},Pt.default.createElement("h3",null,"What you'll get:"),Pt.default.createElement("div",{className:"ftp-benefits"},o.map((s,l)=>Pt.default.createElement("div",{key:l,className:"ftp-benefit"},Pt.default.createElement("span",{className:"benefit-icon"},s.icon),Pt.default.createElement("span",null,s.text))))),Pt.default.createElement(Ie,{onClick:n,disabled:r,variant:"primary",size:"large",className:"generate-ftp-button",autoFocus:!0},Pt.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"center"}},r&&Pt.default.createElement(Io,{size:"small",message:""}),r?"Generating credentials...":Pt.default.createElement(Pt.default.Fragment,null,Pt.default.createElement(pT,{size:18})," Generate FTP Credentials")))))}});var ba,Tq,xbe=F(()=>{ba=Y(Q());Ot();tv();hi();Tq=({sampleTradeCreated:e,isAuthenticated:t,ftpCredentialsGenerated:r,onComplete:n,className:i=""})=>{let a=[{icon:ba.default.createElement(Es,{size:16}),text:"Chosen your trading goal",completed:!0},{icon:ba.default.createElement(Ep,{size:16}),text:"Created your first sample trade",completed:e},{icon:ba.default.createElement(El,{size:16}),text:"Connected your account",completed:t},{icon:ba.default.createElement(Vv,{size:16}),text:"Generated FTP credentials",completed:r}].filter(s=>s.completed),o=[{href:"https://github.com/Cursivez/journalit",icon:ba.default.createElement(Ov,{size:16}),text:"View Documentation"},{href:"https://discord.gg/AkSw3D9h8b",icon:ba.default.createElement(fT,{size:16}),text:"Join Community"},{href:"mailto:contact@journalit.co",icon:ba.default.createElement(Fu,{size:16}),text:"Get Support"}];return ba.default.createElement(Pc,{title:"Welcome to Journalit!",subtitle:"You're all set up and ready to transform your trading journey.",className:`completion-slide ${i}`},ba.default.createElement("div",{className:"completion-celebration"},ba.default.createElement(Ip,{size:32})),ba.default.createElement("div",{className:"completion-summary"},ba.default.createElement("h3",null,"What you've accomplished:"),ba.default.createElement("div",{className:"accomplishments"},a.map((s,l)=>ba.default.createElement("div",{key:l,className:"accomplishment"},ba.default.createElement("span",{className:"accomplishment-icon"},s.icon),ba.default.createElement("span",null,s.text),ba.default.createElement("span",{className:"accomplishment-status"},ba.default.createElement(Aa,{size:16})))))),ba.default.createElement("div",{className:"completion-actions"},ba.default.createElement(Ie,{onClick:n,variant:"primary",size:"large",className:"start-journaling-button",autoFocus:!0},ba.default.createElement(hT,{size:18})," Start Your Trading Journal"),ba.default.createElement("div",{className:"completion-links"},o.map((s,l)=>ba.default.createElement("a",{key:l,href:s.href,className:"completion-link"},s.icon," ",s.text)))))}});var wbe=F(()=>{dbe();ube();fbe();gbe();ybe();bbe();xbe()});var $t,$b,kbe,Sbe=F(()=>{$t=Y(Q()),$b=require("obsidian");hi();ph();cbe();YF();Ns();pq();wbe();kbe=({onComplete:e,onSkip:t,initialStep:r="welcome",selectedGoal:n,plugin:i,onboardingService:a})=>{let[o,s]=(0,$t.useState)(r),[l,c]=(0,$t.useState)(n),[d,u]=(0,$t.useState)({instruments:[],frequency:"weekly",challenge:"emotional-control"}),[p,m]=(0,$t.useState)(!1),[g,f]=(0,$t.useState)(null),[v,h]=(0,$t.useState)(""),[y,b]=(0,$t.useState)(!1),[k,x]=(0,$t.useState)(null),[S,w]=(0,$t.useState)(!1),[C,D]=(0,$t.useState)(null),[P,M]=(0,$t.useState)(!1),[z,A]=(0,$t.useState)(""),I=ti.findIndex(X=>X.id===o),L=ti[I];(0,$t.useEffect)(()=>{KF()},[]),(0,$t.useEffect)(()=>()=>{let X=document.getElementById("email-auth-modal-styles");X&&X.remove()},[]),(0,$t.useEffect)(()=>{let X=i.authManager;X&&X.isAuthenticated()&&w(!0)},[i]),(0,$t.useEffect)(()=>{(async()=>{var te,re,Z,ne;try{let se=await((te=i.serviceManager)==null?void 0:te.getBackendIntegrationService());if(!se)return;let ee=(re=i.settings.backendIntegration)==null?void 0:re.ftpUsername;if(ee){let ie=await se.getFTPCredentials(ee);ie&&((Z=i.settings.backendIntegration)!=null&&Z.ftpPassword&&!ie.password&&(A(""),ie.password="*".repeat(12)),D({username:ie.username,password:ie.password||"",host:ie.server,port:ie.port}),M(!0))}}catch(se){se instanceof Error&&((ne=se.message)!=null&&ne.includes("404"))||console.error("Failed to check existing FTP credentials:",se)}})()},[i]),(0,$t.useEffect)(()=>{},[o,I,l,i,a]);let E=ti.filter(X=>!X.shouldShow||X.shouldShow(l)).length,T=I>0,$=I<ti.length-1,_=(L==null?void 0:L.isOptional)===!0,B=(0,$t.useCallback)(()=>{_&&(h('Onboarding cancelled. You can replay onboarding later from the Command Palette by searching for "Journalit: Replay Onboarding".'),setTimeout(()=>{h("")},100),t())},[_,t]);(0,$t.useEffect)(()=>{let X=te=>{te.key==="Escape"&&_&&B()};return document.addEventListener("keydown",X),()=>document.removeEventListener("keydown",X)},[_,B]),(0,$t.useEffect)(()=>{let X=setTimeout(()=>{let te=document.querySelector(".onboarding-wizard-modal");if(te){let re=te.querySelector('button:not([disabled]), [href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"])');re&&re.focus()}},100);return()=>clearTimeout(X)},[o]);let W=(0,$t.useCallback)(async()=>{if(!(!$||p)){m(!0),f(null);try{let X=I+1;for(;X<ti.length;){let te=ti[X];if(!te.shouldShow||te.shouldShow(l))break;X++}X<ti.length&&s(ti[X].id)}catch(X){f(X instanceof Error?X.message:"Failed to go to next step")}finally{m(!1)}}},[I,$,l,p]),N=(0,$t.useCallback)(async()=>{if(!(!T||p)){m(!0),f(null);try{let X=I-1;for(;X>=0;){let te=ti[X];if(!te.shouldShow||te.shouldShow(l))break;X--}X>=0&&s(ti[X].id)}catch(X){f(X instanceof Error?X.message:"Failed to go to previous step")}finally{m(!1)}}},[I,T,l,p]),U=(0,$t.useCallback)(async()=>{let X={version:1,completed:!0,completedAt:Date.now(),selectedGoal:l,userSegmentation:d,currentStep:"completion",checklist:{},sampleTradeCreated:y,isAuthenticated:S,ftpCredentialsGenerated:P};if(a)try{await a.completeOnboarding()}catch(te){console.error("Failed to complete onboarding in service:",te)}e(X)},[l,y,S,P,e,i,a]),j=(0,$t.useCallback)(async()=>{if(!_||p)return;if(o==="welcome"){s("completion");return}let X=I+1;for(;X<ti.length;){let te=ti[X];if(!te.shouldShow||te.shouldShow(l))break;X++}X<ti.length?s(ti[X].id):U()},[o,_,p,I,l,U]),R=(0,$t.useCallback)(async X=>{if(c(X),a)try{await a.setGoal(X)}catch(te){console.error("Failed to update OnboardingService goal:",te)}},[i,o,a]),O=(0,$t.useCallback)(async()=>{var X,te;if(!y){m(!0),f(null);try{let re=(X=i.serviceManager)==null?void 0:X.getTradeService();if(!re)throw new Error("TradeService not available");let Z=await((te=i.serviceManager)==null?void 0:te.getAccountPageService());if(!Z)throw new Error("AccountPageService not available");(await Z.getAllEnhancedAccounts()).find(Ke=>Ke.name==="Demo Account")||await Z.updateAccountMetadata("Demo Account",{name:"Demo Account",accountType:"demo",initialBalance:1e4,createdDate:new Date});let ee=new Date,ie,ve,Se;switch(d.frequency==="daily"?(ie=new Date(ee.getTime()-10800*1e3),ve=new Date(ee.getTime()-2.5*60*60*1e3)):d.frequency==="weekly"?(ie=new Date(ee.getTime()-4320*60*1e3),ve=new Date(ee.getTime()-1440*60*1e3)):(ie=new Date(ee.getTime()-10080*60*1e3),ve=new Date(ee.getTime()-2880*60*1e3)),d.instruments[0]||"stocks"){case"forex":Se={entryTime:ie,exitTime:ve,entryPrice:1.085,exitPrice:1.092,positionSize:1e4,direction:"long",setupIds:[],mistakeIds:[],accountIds:[],account:["Demo Account"],instrument:"EURUSD",assetType:"forex",tags:["journalit-demo","sample-trade","forex"],thesis:`Sample EURUSD trade demonstrating ${d.frequency} trading. Entry based on support level bounce with 70-pip profit target. This exemplifies the systematic approach Journalit helps you track.`};break;case"crypto":Se={entryTime:ie,exitTime:ve,entryPrice:42500,exitPrice:44200,positionSize:.1,direction:"long",setupIds:[],mistakeIds:[],accountIds:[],account:["Demo Account"],instrument:"BTC/USD",assetType:"crypto",tags:["journalit-demo","sample-trade","crypto"],thesis:`Sample Bitcoin trade showing ${d.frequency} strategy. Breakout above resistance with $1,700 profit. Track crypto volatility patterns with Journalit's analysis tools.`};break;case"options":Se={entryTime:ie,exitTime:ve,entryPrice:2.5,exitPrice:4.1,positionSize:5,direction:"long",setupIds:[],mistakeIds:[],accountIds:[],account:["Demo Account"],instrument:"AAPL Call 150 30DTE",assetType:"options",tags:["journalit-demo","sample-trade","options"],thesis:`Sample options trade for ${d.frequency} traders. 64% profit on AAPL calls before earnings. Journalit tracks Greeks, IV, and time decay for complete options analysis.`};break;default:Se={entryTime:ie,exitTime:ve,entryPrice:150.5,exitPrice:156.75,positionSize:100,direction:"long",setupIds:[],mistakeIds:[],accountIds:[],account:["Demo Account"],instrument:"AAPL",assetType:"stock",tags:["journalit-demo","sample-trade","stocks"],thesis:`Sample stock trade tailored for ${d.frequency} trading. Strong earnings beat with institutional buying. Demonstrates how Journalit captures both technical and fundamental analysis.`}}let le=await re.createTrade(Se);x(le),b(!0);let ue=new $b.Notice("",5e3).noticeEl.createDiv();ue.style.display="flex",ue.style.alignItems="center",ue.style.gap="8px";let We=ue.createSpan();We.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z"/></svg>',We.style.display="inline-flex",We.style.color="var(--text-accent)",ue.createSpan({text:"Sample trade created successfully! You can find it in your vault."})}catch(re){console.error("Error creating sample trade:",re),f(re instanceof Error?re.message:"Failed to create sample trade")}finally{m(!1)}}},[i,y,d,l,o]),H=(0,$t.useCallback)(async(X,te)=>{try{w(!0);let re=i.authManager;re&&await re.handleBetaAuth(X,te),new $b.Notice("Successfully authenticated! You can now access Pro features.")}catch(re){console.error("Error handling auth success:",re),f(re instanceof Error?re.message:"Failed to complete authentication")}},[i]),q=(0,$t.useCallback)(()=>{f(null)},[]),V=(0,$t.useCallback)(async()=>{var X,te,re,Z,ne,se,ee,ie,ve;if(!P){m(!0),f(null);try{let Se=await((X=i.serviceManager)==null?void 0:X.getBackendIntegrationService());if(!Se)throw new Error("Backend integration service not available");if(!i.authManager||!i.authManager.isAuthenticated())throw new Error("Please sign in to generate FTP credentials");let Me=await Se.createOrGetFTPUser();if(!Me)throw new Error("Failed to generate FTP credentials");let le=`anon_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;i.settings.backendIntegration={...i.settings.backendIntegration,syncEnabled:(re=(te=i.settings.backendIntegration)==null?void 0:te.syncEnabled)!=null?re:!1,userId:(ne=(Z=i.settings.backendIntegration)==null?void 0:Z.userId)!=null?ne:le,showSyncNotifications:(ee=(se=i.settings.backendIntegration)==null?void 0:se.showSyncNotifications)!=null?ee:!0,showNewTradeNotifications:(ve=(ie=i.settings.backendIntegration)==null?void 0:ie.showNewTradeNotifications)!=null?ve:!0,ftpUsername:Me.username,ftpPassword:Me.password||""},await i.saveSettings(),await Se.updateSettings({ftpUsername:Me.username}),A(Me.password||""),D({username:Me.username,password:Me.password||"",host:Me.server,port:Me.port}),M(!0);let ue=new $b.Notice("",5e3).noticeEl.createDiv();ue.style.display="flex",ue.style.alignItems="center",ue.style.gap="8px";let We=ue.createSpan();We.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><path d="m9 11 3 3L22 4"/></svg>',We.style.display="inline-flex",We.style.color="var(--text-success)",ue.createSpan({text:"FTP credentials generated successfully!"})}catch(Se){console.error("Error generating FTP credentials:",Se),f(Se instanceof Error?Se.message:"Failed to generate FTP credentials")}finally{m(!1)}}},[P,l,o,i]),J=(0,$t.useCallback)(async(X,te)=>{try{let re=te==="Password"&&X==="*".repeat(12)&&z?z:X;if(te==="Password"&&re==="*".repeat(12)){new $b.Notice("Password is masked and cannot be copied. Please regenerate FTP credentials.");return}await navigator.clipboard.writeText(re),new $b.Notice(`${te} copied to clipboard!`)}catch(re){console.error("Failed to copy to clipboard:",re),new $b.Notice(`Failed to copy ${te.toLowerCase()}`)}},[z]),K=()=>{switch(o){case"welcome":return $t.default.createElement(fq,null);case"goal":return $t.default.createElement(gq,{selectedGoal:l,onGoalSelect:R});case"segmentation":return $t.default.createElement(hq,{userSegmentation:d,onSegmentationChange:u});case"first-action":return $t.default.createElement(vq,{goal:l,userSegmentation:d,sampleTradeCreated:y,sampleTradeFilePath:k,isLoading:p,onCreateSampleTrade:O});case"authentication":return $t.default.createElement(kq,{isAuthenticated:S,onAuthSuccess:H,onAuthCancel:q});case"ftp-credentials":return $t.default.createElement(Sq,{ftpCredentialsGenerated:P,ftpCredentials:C,isLoading:p,onGenerateFtpCredentials:V,onCopyToClipboard:J});case"completion":return $t.default.createElement(Tq,{sampleTradeCreated:y,isAuthenticated:S,ftpCredentialsGenerated:P,onComplete:U});default:return $t.default.createElement("div",{className:"onboarding-slide error-slide"},$t.default.createElement("h2",null,"Unknown step"),$t.default.createElement("p",null,"We encountered an unexpected step in the onboarding process."))}},G=ti.filter(X=>!X.shouldShow||X.shouldShow(l)).map(X=>X.title);return $t.default.createElement("div",{className:"onboarding-wizard-modal"},$t.default.createElement("div",{"aria-live":"assertive","aria-atomic":"true",className:"sr-only"},v),$t.default.createElement("div",{className:"modal-header"},$t.default.createElement(lbe,{currentStep:I+1,totalSteps:E,stepLabels:G})),$t.default.createElement("div",{className:"modal-content"},K()),g&&$t.default.createElement("div",{className:"modal-error"},g),o!=="completion"&&$t.default.createElement("div",{className:"modal-actions"},T&&$t.default.createElement(Ie,{onClick:N,disabled:p,variant:"secondary"},"Back"),$&&$t.default.createElement(Ie,{onClick:W,disabled:p||o==="goal"&&!l||o==="segmentation"&&d.instruments.length===0,variant:"primary"},$t.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"center"}},p&&$t.default.createElement(Io,{size:"small",message:""}),"Next"))),$t.default.createElement("div",{className:"modal-footer"},$t.default.createElement("p",{className:"modal-footer-text"},(L==null?void 0:L.description)||"Complete the setup to get started with Journalit")),_&&$t.default.createElement("button",{className:"skip-link",onClick:j,disabled:p,"aria-label":"Skip this step",type:"button"},o==="welcome"?"Skip Onboarding":"Skip Step"))}});var Pq={};Ti(Pq,{OnboardingWizardModalWrapper:()=>Cq});var Tbe,Cbe,Cq,Dq=F(()=>{Tbe=Y(Q()),Cbe=require("obsidian");Sbe();RB();Cq=class extends Cbe.Modal{constructor(r,n,i,a,o,s,l){super(r);this.reactRoot=null;this.plugin=n,this.onComplete=i,this.onSkip=a,this.initialStep=o,this.selectedGoal=s,this.onboardingService=l}async onOpen(){let{contentEl:r}=this;r.empty(),qI();let n=r.createDiv(),{createRoot:i}=Ni();this.reactRoot=i(n),this.reactRoot.render(Tbe.default.createElement(kbe,{plugin:this.plugin,onboardingService:this.onboardingService,onComplete:a=>{this.onComplete(a),super.close()},onSkip:()=>{this.onSkip(),super.close()},initialStep:this.initialStep,selectedGoal:this.selectedGoal})),setTimeout(()=>{let a=r.querySelector(".onboarding-wizard-modal");a&&(a.setAttribute("tabindex","-1"),a.focus())},100)}async onClose(){this.reactRoot&&(this.reactRoot.unmount(),this.reactRoot=null);let{contentEl:r}=this;r.empty(),$B()}}});var Dc,Dbe,Ebe,Ibe=F(()=>{Dc=Y(Q()),Dbe=require("obsidian");Oa();Jn();Ebe=({trades:e,currentTradePath:t,onTradeClick:r})=>{var d,u,p;let n=(p=(u=(d=window.app)==null?void 0:d.plugins)==null?void 0:u.plugins)==null?void 0:p.journalit,i=Dc.default.useMemo(()=>{var m,g;try{let f=window.app;if(!(f!=null&&f.metadataCache))return null;let v=e.find(b=>b.path===t);if(!v){let b=f.vault.getAbstractFileByPath(t);b instanceof Dbe.TFile&&(v=b)}if(!v)return null;let h=f.metadataCache.getFileCache(v),y=(m=h==null?void 0:h.frontmatter)==null?void 0:m.entryTime;if(y)return new Date(y);if((g=h==null?void 0:h.frontmatter)!=null&&g.useDirectPnLInput){let b=t.match(/(\d{2})(\d{2})(\d{2})-[TM]\d+\.md$/);if(b){let[,k,x,S]=b,w=2e3+parseInt(S,10);return new Date(w,parseInt(x,10)-1,parseInt(k,10))}}return null}catch(f){return console.warn("Error getting current trade date:",f),null}},[e,t]),a=Dc.default.useMemo(()=>{if(!i||!n)return e;try{let m=window.app;return m!=null&&m.metadataCache?e.filter(g=>{var f,v;try{let h=m.metadataCache.getFileCache(g),y=(f=h==null?void 0:h.frontmatter)==null?void 0:f.entryTime,b=(v=h==null?void 0:h.frontmatter)==null?void 0:v.useDirectPnLInput,k=null;if(y)k=new Date(y);else if(b){let x=g.path.match(/(\d{2})(\d{2})(\d{2})-[TM]\d+\.md$/);if(x){let[,S,w,C]=x,D=2e3+parseInt(C,10);k=new Date(D,parseInt(w,10)-1,parseInt(S,10))}}return k?NZ(i,k,n):!1}catch(h){return console.warn(`Error checking trade date for ${g.path}:`,h),!1}}):e}catch(m){return console.warn("Error filtering trades by trading day:",m),e}},[e,i,n]),o=Dc.default.useMemo(()=>{let m=a.map(f=>{let v=f.path.match(/([A-Z0-9-]+)-[0-9]{6}-[TMB]\d+\.md$/),h=f.path.match(/[TMB](\d+)\.md$/),y=f.path.match(/-([TMB])\d+\.md$/),b=v?v[1]:"Unknown",k=h?parseInt(h[1],10):0,x=y?y[1]==="M":!1,S=y?y[1]==="B":!1,w=0,C=!1;try{let D=window.app;if(D!=null&&D.metadataCache){let P=D.metadataCache.getFileCache(f),M=P==null?void 0:P.frontmatter;M&&(M.pnl!==void 0?w=Number(M.pnl):M.directPnL!==void 0&&M.useDirectPnLInput&&(w=Number(M.directPnL)),C=yt({tradeStatus:M.tradeStatus,exitTime:M.exitTime,pnl:M.pnl,useDirectPnLInput:M.useDirectPnLInput,exits:M.exits,entries:M.entries}))}}catch(D){w=0,C=!1}return{file:f,ticker:b,tradeNumber:k,isActive:f.path===t,pnl:w,isMissedTrade:x,isBacktestTrade:S,isOpen:C}}),g={};return m.forEach(f=>{g[f.ticker]||(g[f.ticker]=[]),g[f.ticker].push(f)}),Object.keys(g).forEach(f=>{g[f].sort((v,h)=>v.tradeNumber-h.tradeNumber)}),g},[a,t]),s=Object.keys(o);if(s.length===0)return null;if(a.length<=1){let m=s[0],g=o[m][0],f=g.isMissedTrade?"M":g.isBacktestTrade?"B":"T",v=g.isMissedTrade?"Missed Trade":g.isBacktestTrade?"Backtest Trade":"Trade";return Dc.default.createElement("div",{className:"trade-timeline-container single-trade"},Dc.default.createElement("div",{className:"trade-timeline"},Dc.default.createElement("div",{className:"timeline-label active-ticker"},m,":"),Dc.default.createElement("div",{className:"timeline-items"},Dc.default.createElement("button",{className:`timeline-item ${g.isMissedTrade?"missed-trade":""} ${g.isBacktestTrade?"backtest-trade":""} ${g.isOpen?"open":g.pnl>0?"profit":g.pnl<0?"loss":""} active`,disabled:!0,"aria-label":`${m} ${v} ${g.tradeNumber} (${g.isOpen?"Open":g.pnl>0?"Profit":g.pnl<0?"Loss":"Breakeven"})`,title:`Current ${v.toLowerCase()}: ${m} ${v} ${g.tradeNumber}${g.isOpen?" (Open)":""}`},f,g.tradeNumber))))}let l=s.find(m=>o[m].some(g=>g.isActive)),c=[...s].sort((m,g)=>m===l?-1:g===l?1:m.localeCompare(g));return Dc.default.createElement("div",{className:"trade-timeline-container"},c.map(m=>Dc.default.createElement("div",{key:m,className:"trade-timeline"},Dc.default.createElement("div",{className:`timeline-label ${m===l?"active-ticker":""}`},m,":"),Dc.default.createElement("div",{className:"timeline-items"},o[m].map(g=>{let f=g.isMissedTrade?"M":g.isBacktestTrade?"B":"T",v=g.isMissedTrade?"Missed Trade":g.isBacktestTrade?"Backtest Trade":"Trade";return Dc.default.createElement("button",{key:g.file.path,className:`timeline-item 
                    ${g.isMissedTrade?"missed-trade":""} 
                    ${g.isBacktestTrade?"backtest-trade":""}
                    ${g.isOpen?"open":g.pnl>0?"profit":g.pnl<0?"loss":""} 
                    ${g.isActive?"active":""}`,onClick:()=>r(g.file.path),"aria-label":`${m} ${v} ${g.tradeNumber} (${g.isOpen?"Open":g.pnl>0?"Profit":g.pnl<0?"Loss":"Breakeven"})`,title:`View ${m} ${v} ${g.tradeNumber} (${g.isOpen?"Open":g.pnl>0?"Profit":g.pnl<0?"Loss":"Breakeven"})${g.isOpen?" - Trade is still open":""}`},f,g.tradeNumber)})))))}});var $s,tO,Eq=F(()=>{$s=Y(Q());Ot();Ibe();gM();nr();tO=({currentDate:e,trades:t,missedTrades:r=[],currentTradePath:n,navigateTo:i,getDRCPath:a,getWeeklyReviewPath:o,getMonthlyReviewPath:s,getYearlyReviewPath:l,onEditClick:c,handleEditClick:d})=>{let u=Ae(),p=(0,$s.useRef)(!1),m=(0,$s.useCallback)(x=>{x!==n&&i(x,!1)},[i,n]),g=(0,$s.useCallback)(async()=>{var x,S,w;if(!p.current){p.current=!0;try{let C=new Date(e);C.setHours(0,0,0,0);let D=a(C);if(!D)return;!await((w=(S=(x=u==null?void 0:u.app)==null?void 0:x.vault)==null?void 0:S.adapter)==null?void 0:w.exists(D))&&(u!=null&&u.drcService)&&await u.drcService.createDRC(C),i(D,!1)}catch(C){console.error("Error navigating to DRC:",C)}finally{p.current=!1}}},[a,e,i,u]),f=(0,$s.useCallback)(async()=>{var x,S,w;if(!p.current){p.current=!0;try{let C=new Date(e);C.setHours(0,0,0,0);let D=o(C);if(!D)return;!await((w=(S=(x=u==null?void 0:u.app)==null?void 0:x.vault)==null?void 0:S.adapter)==null?void 0:w.exists(D))&&(u!=null&&u.weeklyReviewService)&&await u.weeklyReviewService.createWeeklyReview(C),i(D,!1)}catch(C){console.error("Error navigating to Weekly Review:",C)}finally{p.current=!1}}},[o,e,i,u]),v=(0,$s.useCallback)(async()=>{var x,S,w;if(!p.current){p.current=!0;try{let C=new Date(e);C.setHours(0,0,0,0);let D=s(C);if(!D)return;!await((w=(S=(x=u==null?void 0:u.app)==null?void 0:x.vault)==null?void 0:S.adapter)==null?void 0:w.exists(D))&&(u!=null&&u.monthlyReviewService)&&await u.monthlyReviewService.createMonthlyReview(C),i(D,!1)}catch(C){console.error("Error navigating to Monthly Review:",C)}finally{p.current=!1}}},[s,e,i,u]),h=(0,$s.useCallback)(async()=>{var x,S,w;if(!p.current){p.current=!0;try{let C=new Date(e);C.setHours(0,0,0,0);let D=l(C);if(!D)return;!await((w=(S=(x=u==null?void 0:u.app)==null?void 0:x.vault)==null?void 0:S.adapter)==null?void 0:w.exists(D))&&(u!=null&&u.serviceManager)&&await(await u.serviceManager.getYearlyReviewService()).createYearlyReview(C),i(D,!1)}catch(C){console.error("Error navigating to Yearly Review:",C)}finally{p.current=!1}}},[l,e,i,u]),y=[{text:"Daily Report Card",action:g},{text:"Weekly Review",action:f},{text:"Monthly Review",action:v},{text:"Yearly Review",action:h}],b=()=>$s.default.createElement("div",{className:"trade-navigation-with-edit"},$s.default.createElement(fM,{buttons:y,className:"trade-review-navigation",style:{borderTop:"none",flex:"1"}}),d&&c&&$s.default.createElement("div",{className:"edit-button-container"},$s.default.createElement("button",{className:"trade-nav-edit-button clickable-icon",onClick:d,"aria-label":"Edit trade"},$s.default.createElement(So,{size:14})))),k=$s.default.useMemo(()=>{let x=new Set,S=[];for(let w of[...t,...r])x.has(w.path)||(x.add(w.path),S.push(w));return S},[t,r]);return $s.default.createElement("div",{className:"trade-navigation-container"},b(),$s.default.createElement(Ebe,{trades:k,currentTradePath:n,onTradeClick:m}))}});var sk,kP,Mbe=F(()=>{sk=Y(Q());uB();Ol();kP=sk.default.memo(({images:e,onEditClick:t})=>!e||e.length===0?sk.default.createElement("div",{className:"trade-empty-images"},sk.default.createElement(yi,{message:"No images for this trade",subMessage:t?"Click 'Edit' to add images":void 0,iconSize:40})):sk.default.createElement("div",{className:"trade-images-section","data-image-count":e.length},sk.default.createElement(oh,{images:e,altPrefix:"Trade image",showThumbnails:e.length>1,showCounter:e.length>1,enableDelete:!1,enableFullscreen:!0,useResolveMediaPath:!0,className:e.length===1?"single-image-carousel":"","data-single-image":e.length===1?"true":"false"})),(e,t)=>JSON.stringify(e.images)===JSON.stringify(t.images)&&e.onEditClick===t.onEditClick)});var to,SP,Abe=F(()=>{to=Y(Q()),SP=({data:e,onAccountClick:t,config:r})=>{let n=e.account&&e.account.length>0||e.accountIds&&e.accountIds.length>0,i=e.customTags&&e.customTags.length>0,a=e.setup&&e.setup.length>0||e.setupIds&&e.setupIds.length>0,o=e.mistake&&e.mistake.length>0||e.mistakeIds&&e.mistakeIds.length>0,s=(r==null?void 0:r.showAccounts)!==!1,l=(r==null?void 0:r.showTags)!==!1,c=(r==null?void 0:r.showSetups)!==!1,d=(r==null?void 0:r.showMistakes)!==!1;return(!n||!s)&&(!i||!l)&&(!a||!c)&&(!o||!d)?null:to.default.createElement(to.default.Fragment,null,to.default.createElement("div",{className:"trade-metadata-container"},s&&n&&to.default.createElement("div",{className:"metadata-section"},to.default.createElement("div",{className:"metadata-label"},"Account:"),to.default.createElement("div",{className:"metadata-tags"},(e.account||e.accountIds||[]).map((u,p)=>to.default.createElement("span",{key:`account-${p}`,className:"account-tag",onClick:()=>t(u)},u)))),l&&i&&to.default.createElement("div",{className:"metadata-section"},to.default.createElement("div",{className:"metadata-label"},"Custom Tags:"),to.default.createElement("div",{className:"metadata-tags"},e.customTags.map((u,p)=>to.default.createElement("span",{key:`tag-${p}`,className:"tag"},u))))),to.default.createElement("div",{className:"trade-tags-container"},to.default.createElement("div",{className:"tags-row"},c&&a&&to.default.createElement("div",{className:"tags-section setup-section"},to.default.createElement("h4",null,"Setups"),to.default.createElement("div",{className:"tags-list"},(e.setup||e.setupIds||[]).map((u,p)=>to.default.createElement("span",{key:`setup-${p}`,className:"tag setup-tag"},u)))),d&&o&&to.default.createElement("div",{className:"tags-section mistake-section"},to.default.createElement("h4",null,"Mistakes"),to.default.createElement("div",{className:"tags-list"},(e.mistake||e.mistakeIds||[]).map((u,p)=>to.default.createElement("span",{key:`mistake-${p}`,className:"tag mistake-tag"},u)))))))}});var kt,TP,Lbe=F(()=>{kt=Y(Q());eh();iy();Ol();Er();qt();TP=({data:e,metrics:t,formatDate:r,formatTime:n,onEditClick:i,displayRMultiples:a,defaultRiskAmount:o,config:s})=>{let{currency:l}=ct(),c=(s==null?void 0:s.metrics)||["entry","exit","size","duration","pnl","rMultiple"],d=(s==null?void 0:s.showThesis)!==!1,u=p=>c.includes(p);return kt.default.createElement(kt.default.Fragment,null,kt.default.createElement("div",{className:"trade-overview-section"},kt.default.createElement("div",{className:"trade-metrics-grid"},u("entry")&&kt.default.createElement("div",{className:"metric-card"},kt.default.createElement("div",{className:"metric-label"},"Entry"),kt.default.createElement("div",{className:"metric-value"},sa(e.entryPrice,!1,l)),kt.default.createElement("div",{className:"metric-subtitle"},n(e.entryTime))),u("exit")&&kt.default.createElement("div",{className:"metric-card"},kt.default.createElement("div",{className:"metric-label"},"Exit"),kt.default.createElement("div",{className:"metric-value"},sa(e.exitPrice,!1,l)),kt.default.createElement("div",{className:"metric-subtitle"},n(e.exitTime))),u("size")&&kt.default.createElement("div",{className:"metric-card"},kt.default.createElement("div",{className:"metric-label"},"Size"),kt.default.createElement("div",{className:"metric-value"},e.positionSize),kt.default.createElement("div",{className:"metric-subtitle"},e.assetType==="options"&&e.optionType?e.optionType.charAt(0).toUpperCase()+e.optionType.slice(1):e.direction||"N/A")),u("duration")&&kt.default.createElement("div",{className:"metric-card"},kt.default.createElement("div",{className:"metric-label"},"Duration"),kt.default.createElement("div",{className:"metric-value"},t.duration),kt.default.createElement("div",{className:"metric-subtitle"},"\xA0")))),kt.default.createElement("div",{className:"trade-main-content"},d&&kt.default.createElement("div",{className:"thesis-section"},kt.default.createElement("h4",null,"Thesis"),e.thesis?kt.default.createElement("div",{className:"thesis-content"},e.thesis.split(`
`).map((p,m)=>kt.default.createElement(kt.default.Fragment,{key:m},p,m<e.thesis.split(`
`).length-1&&kt.default.createElement("br",null)))):kt.default.createElement(yi,{message:"No thesis provided for this trade",subMessage:i?"Click 'Edit' to add a thesis":void 0,iconSize:32}))),kt.default.createElement("div",{className:"trade-details-footer"},kt.default.createElement("div",{className:"details-card expanded-details"},kt.default.createElement("div",{className:"details-header"},kt.default.createElement("h4",null,"Trade Details")),kt.default.createElement("table",{className:"details-table"},kt.default.createElement("tbody",null,kt.default.createElement("tr",null,kt.default.createElement("td",null,"Instrument"),kt.default.createElement("td",null,e.instrument||"N/A"),kt.default.createElement("td",null,"Direction"),kt.default.createElement("td",null,e.assetType==="options"&&e.optionType?e.optionType.charAt(0).toUpperCase()+e.optionType.slice(1):e.direction||"N/A")),u("size")&&kt.default.createElement("tr",null,kt.default.createElement("td",null,"Position Size"),kt.default.createElement("td",null,e.positionSize||"N/A"),u("pnl")&&kt.default.createElement(kt.default.Fragment,null,kt.default.createElement("td",null,"P&L"),kt.default.createElement("td",{className:t.isProfit?"profit-text":"loss-text"},ye(t.pnl,!0,l,a,xt(t.pnl,e.rMultiple,e.riskAmount,o)),!e.useDirectPnLInput&&` (${t.percentChange.toFixed(2)}%)`))),u("costs")&&LT(e)!==0&&(()=>{let p=LT(e),m=e.riskAmount||o||0,g=xt(p,void 0,e.riskAmount,o);return kt.default.createElement("tr",null,kt.default.createElement("td",null,"Trading Costs"),kt.default.createElement("td",{colSpan:3,className:"cost-breakdown"},IX(e,a,m),kt.default.createElement("span",{className:"total-cost"}," | Total: ",ye(p,!0,l,a,g))))})(),u("entry")&&kt.default.createElement("tr",null,kt.default.createElement("td",null,"Entry Price"),kt.default.createElement("td",null,sa(e.entryPrice,!1,l)),u("exit")&&kt.default.createElement(kt.default.Fragment,null,kt.default.createElement("td",null,"Exit Price"),kt.default.createElement("td",null,sa(e.exitPrice,!1,l)))),u("entry")&&kt.default.createElement("tr",null,kt.default.createElement("td",null,"Entry Time"),kt.default.createElement("td",null,r(e.entryTime)),u("exit")&&kt.default.createElement(kt.default.Fragment,null,kt.default.createElement("td",null,"Exit Time"),kt.default.createElement("td",null,r(e.exitTime)))),u("duration")&&kt.default.createElement("tr",null,kt.default.createElement("td",null,"Duration"),kt.default.createElement("td",{colSpan:3},t.duration)))))))}});var cp,CP,Nbe=F(()=>{cp=Y(Q());eh();Jn();Er();nr();CP=({instrument:e,direction:t,isProfit:r,isBreakeven:n,pnl:i,percentChange:a,useDirectPnLInput:o,isMissedTrade:s,isBacktestTrade:l,exitTime:c,exitPrice:d,tradeStatus:u,exits:p,entries:m,assetType:g,optionType:f,rMultiple:v,displayRMultiples:h,riskAmount:y,currency:b})=>{var L,E;let{currency:k}=ct(),x=b||k,S=Ae(),w=u==="OPEN"||yt({useDirectPnLInput:o,exitTime:c,exitPrice:d,tradeStatus:u,exits:p,entries:m,pnl:void 0}),C=()=>{if(g==="options"&&f)return{icon:f==="call"?"\u25B2":"\u25BC",text:f==="call"?"Call":"Put"};let $=(t||"").toLowerCase();return{icon:$==="long"||$==="buy"?"\u25B2":"\u25BC",text:$==="long"||$==="buy"?"Long":"Short"}},{icon:D,text:P}=C(),M=(E=(L=S==null?void 0:S.settings)==null?void 0:L.trade)==null?void 0:E.defaultRiskAmount,z=xt(i,v,y,M),A=()=>w?"open":n?"breakeven":r?"profit":"loss",I=()=>n?"breakeven-text":r?"profit-text":"loss-text";return cp.default.createElement("div",{className:`trade-note-header ${A()}`},cp.default.createElement("div",{className:"trade-instrument"},cp.default.createElement("span",{className:"trade-direction-icon"},D),e||"Unknown Instrument",l&&cp.default.createElement("span",{className:"backtest-trade-badge"},"BACKTEST"),!l&&s&&cp.default.createElement("span",{className:"missed-trade-badge"},"MISSED"),!l&&!s&&w&&cp.default.createElement("span",{className:"open-trade-badge"},"OPEN")),cp.default.createElement("div",{className:"trade-header-actions"},cp.default.createElement("div",{className:"trade-pnl"},w&&!s&&!l?cp.default.createElement("span",{className:"open-text"},"OPEN"):cp.default.createElement("span",{className:I()},!h&&i>0?"+":"",ye(i,!0,x,h,z),!o&&` (${a.toFixed(2)}%)`))))}});var Iq=F(()=>{Mbe();Abe();Lbe();Nbe()});var Fbe,PP,Obe=F(()=>{Fbe=Y(Q());_t();qt();Jn();PP=({data:e})=>({metrics:(0,Fbe.useMemo)(()=>{let i=yt({tradeStatus:e.tradeStatus,exitTime:e.exitTime,exitPrice:e.exitPrice,pnl:e._originalPnlWasNull?null:e.pnl,useDirectPnLInput:e.useDirectPnLInput,exits:e.exits,entries:e.entries}),a=e.entryPrice||0,o=e.exitPrice||0,s=e.positionSize||0,l=(e.direction||"").toLowerCase()==="long";if(i)return{pnl:0,percentChange:0,duration:"",isProfit:!1};let c=e.pnl!==void 0?e.pnl:l?(o-a)*s:(a-o)*s,d=a===0?0:e.assetType==="options"||l?(o-a)/a*100:(a-o)/a*100,u="";if(e.entryTime&&e.exitTime){let p=U_(e.entryTime,e.exitTime);p!==null&&p>=0&&(u=MT(p))}return{pnl:c,percentChange:d,duration:u,isProfit:c>0,isLoss:c<0,isBreakeven:c===0}},[e.entryPrice,e.exitPrice,e.positionSize,e.direction,e.pnl,e.entryTime,e.exitTime,e.tradeStatus,e.useDirectPnLInput,e.exits,e._originalPnlWasNull,e.assetType]),formatDate:i=>{if(!i)return"N/A";let a=new Date(i);if(isNaN(a.getTime()))return"N/A";let o=vn(),s=zt(a,o),l=a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return`${s} ${l}`},formatTime:i=>{if(!i)return"N/A";let a=new Date(i);return isNaN(a.getTime())?"N/A":a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}})});var Mq=F(()=>{Obe()});var xa,UGe,rO,Aq=F(()=>{xa=Y(Q()),UGe={duration:{open:150,close:150},easing:"ease-in-out",stagger:{opacity:50}},rO=(e=!1,t=UGe,r={})=>{let[n,i]=(0,xa.useState)(e),[a,o]=(0,xa.useState)(!1),[s,l]=(0,xa.useState)(0),c=(0,xa.useRef)(null),d=(0,xa.useRef)(null),u=(0,xa.useRef)(null);(0,xa.useEffect)(()=>{i(e)},[e]),(0,xa.useEffect)(()=>()=>{u.current&&clearTimeout(u.current)},[]),(0,xa.useEffect)(()=>{let k=d.current;if(!k)return;let x=S=>{S.target===k&&S.propertyName==="height"&&a&&(o(!1),u.current&&(clearTimeout(u.current),u.current=null))};return k.addEventListener("transitionend",x),()=>{k.removeEventListener("transitionend",x)}},[a]),(0,xa.useEffect)(()=>{n&&c.current&&!a&&requestAnimationFrame(()=>{if(c.current){let k=c.current.scrollHeight;l(k)}})},[n,a]),(0,xa.useEffect)(()=>{if(!c.current||!n||a||typeof ResizeObserver=="undefined")return;let k,x=new ResizeObserver(S=>{a||(clearTimeout(k),k=setTimeout(()=>{if(!a){for(let w of S)if(w.target===c.current&&n&&!a){let C=c.current.scrollHeight;l(D=>D!==C?C:D)}}},50))});return x.observe(c.current),()=>{clearTimeout(k),x.disconnect()}},[n,a]);let p=(0,xa.useCallback)(()=>{i(k=>(k?(o(!0),u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{o(!1),u.current=null},t.duration.close+10)):(o(!1),u.current&&(clearTimeout(u.current),u.current=null)),!k))},[t.duration.close]),m=(0,xa.useCallback)(k=>{(k.key==="Enter"||k.key===" ")&&(k.preventDefault(),p())},[p]),g=(0,xa.useMemo)(()=>({height:n?`${s}px`:"0px",opacity:n?1:0,visibility:n?"visible":"hidden",overflow:"hidden",transition:n?`height ${t.duration.open}ms ${t.easing}, opacity ${t.duration.open-t.stagger.opacity}ms ${t.easing} ${t.stagger.opacity}ms, visibility 0s ease 0s`:`height ${t.duration.close}ms ${t.easing}, opacity ${Math.min(t.duration.close,150)}ms ${t.easing}, visibility 0s ease 0s`,...r.includeBorder&&{borderTop:n?"1px solid var(--background-modifier-border)":"none"},...r.includeBackground&&{backgroundColor:n?"var(--background-secondary)":"transparent"}}),[n,s,t,r.includeBorder,r.includeBackground]),f=(0,xa.useMemo)(()=>{let x={...{top:16,bottom:16,left:0,right:0},...r.customPadding};return{paddingTop:n?`${x.top}px`:"0px",paddingBottom:n?`${x.bottom}px`:"0px",paddingLeft:`${x.left}px`,paddingRight:`${x.right}px`,transition:`padding ${t.duration.close}ms ${t.easing}`}},[n,t.duration.close,t.easing,r.customPadding]),v=(0,xa.useMemo)(()=>({display:"flex",alignItems:"center",justifyContent:"center",width:"16px",height:"16px",transition:`transform ${t.duration.close}ms ${t.easing}`,transform:n?"rotate(0deg)":"rotate(-90deg)",color:"var(--text-muted)"}),[n,t.duration.close,t.easing]),h=(0,xa.useMemo)(()=>({width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:v}),[v]),y=(0,xa.useMemo)(()=>({display:"flex",alignItems:"center",width:"100%",padding:"12px 16px",cursor:"pointer",backgroundColor:"transparent",border:"none",textAlign:"left",fontSize:"14px",fontWeight:"500",color:"var(--text-normal)",userSelect:"none",transition:"background-color 0.15s ease"}),[]),b=(0,xa.useCallback)(()=>{c.current&&n&&!a&&requestAnimationFrame(()=>{if(c.current&&!a){let k=c.current.scrollHeight;l(k)}})},[n,a]);return{isExpanded:n,isCollapsing:a,contentHeight:s,toggleExpanded:p,handleKeyDown:m,remeasureContent:b,contentRef:c,containerRef:d,accordionContainerStyle:g,accordionContentStyle:f,chevronStyle:v,headerButtonStyle:y,chevronSvgProps:h}}});var na,ri,nv=F(()=>{na=Y(Q());Aq();ri=na.default.memo(({title:e,defaultExpanded:t=!1,expanded:r,onExpandedChange:n,onRemeasureContentChange:i,children:a})=>{let[o,s]=(0,na.useState)(!1),l=r!==void 0,c=l?r:t,{isExpanded:d,toggleExpanded:u,handleKeyDown:p,remeasureContent:m,contentRef:g,containerRef:f,accordionContainerStyle:v,accordionContentStyle:h,chevronStyle:y}=rO(c,{duration:{open:150,close:150},easing:"ease-out",stagger:{opacity:25}});(0,na.useEffect)(()=>{m()},[a,m]),(0,na.useEffect)(()=>{i&&i(m)},[i,m]);let b=(0,na.useCallback)(()=>{l&&n?n(!d):u()},[d,l,n,u]),k=(0,na.useCallback)(M=>{(M.key==="Enter"||M.key===" ")&&(M.preventDefault(),b())},[b]),x=(0,na.useCallback)(()=>{s(!0)},[]),S=(0,na.useCallback)(()=>{s(!1)},[]),w=(0,na.useMemo)(()=>({border:"1px solid var(--background-modifier-border)",borderRadius:"6px",overflow:"hidden",marginBottom:"16px",transition:"box-shadow 150ms ease-out",boxShadow:o?"0 1px 3px rgba(0, 0, 0, 0.05)":"none"}),[o]),C=(0,na.useMemo)(()=>({display:"flex",alignItems:"center",cursor:"pointer",padding:"12px 16px",fontSize:"14px",fontWeight:"500",color:"var(--text-normal)",userSelect:"none",backgroundColor:o?"var(--background-modifier-hover)":"var(--background-secondary)",transition:"background-color 150ms ease-out",marginBottom:"0px"}),[o]),D=(0,na.useMemo)(()=>({marginLeft:"8px"}),[]),P=(0,na.useMemo)(()=>({...h,padding:"16px",backgroundColor:"var(--background-primary)"}),[h]);return na.default.createElement("div",{style:w,"aria-expanded":d,onMouseEnter:x,onMouseLeave:S},na.default.createElement("div",{style:C,onClick:b,role:"button",tabIndex:0,onKeyDown:k},na.default.createElement("div",{style:y},na.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},na.default.createElement("polyline",{points:"6 9 12 15 18 9"}))),na.default.createElement("span",{style:D},e)),na.default.createElement("div",{ref:f,style:v},na.default.createElement("div",{ref:g,style:P},a)))});ri.displayName="Accordion"});var ki,DP,Lq=F(()=>{ki=Y(Q());nv();DP=ki.default.memo(({settings:e,data:t,onUpdate:r,filePath:n})=>{(0,ki.useEffect)(()=>{},[e,n]);let[i,a]=(0,ki.useState)(()=>{let p={};return e.sections.forEach(m=>{p[m.id]={checkboxes:{},textAreas:{}}}),t?{...t,sections:{...p,...t.sections}}:{sections:p,reviewed:!1}});(0,ki.useEffect)(()=>{a(p=>{let m={...p.sections};return e.sections.forEach(g=>{m[g.id]||(m[g.id]={checkboxes:{},textAreas:{}})}),t?{...t,sections:{...m,...t.sections}}:{...p,sections:m}})},[t,e.sections]);let o=(0,ki.useCallback)(p=>{a(p),r(p)},[r]),s=(p,m)=>{var f,v,h;let g={...i,sections:{...i.sections,[p]:{...i.sections[p],checkboxes:{...(f=i.sections[p])==null?void 0:f.checkboxes,[m]:!((h=(v=i.sections[p])==null?void 0:v.checkboxes)!=null&&h[m])}}}};o(g)},l=(p,m)=>{var f;let g={...i,sections:{...i.sections,[p]:{...i.sections[p],textAreas:{...(f=i.sections[p])==null?void 0:f.textAreas,[p]:m}}}};o(g)},c=p=>{var g,f;let m=i.sections[p.id];switch(p.type){case"header":return ki.default.createElement("div",{className:"trade-review-header",key:p.id},p.title&&ki.default.createElement("h3",{dangerouslySetInnerHTML:{__html:d(p.title)}}),p.content&&ki.default.createElement("div",{className:"trade-review-content",dangerouslySetInnerHTML:{__html:d(p.content)}}));case"checkbox":let v=p.content||p.id,h=((g=m==null?void 0:m.checkboxes)==null?void 0:g[v])||!1;return ki.default.createElement("div",{className:"trade-review-checkbox",key:p.id},ki.default.createElement("label",{className:"checkbox-label"},ki.default.createElement("input",{type:"checkbox",checked:h,onChange:()=>s(p.id,v)}),ki.default.createElement("span",{dangerouslySetInnerHTML:{__html:d(p.content||"")}})));case"checkboxList":return ki.default.createElement("div",{className:"trade-review-checkbox-list",key:p.id},p.title&&ki.default.createElement("h3",{dangerouslySetInnerHTML:{__html:d(p.title)}}),ki.default.createElement("div",{className:"checkbox-items"},(p.items||[]).map((b,k)=>{var w;let x=`${p.id}-item-${k}`,S=((w=m==null?void 0:m.checkboxes)==null?void 0:w[x])||!1;return ki.default.createElement("label",{key:x,className:"checkbox-label"},ki.default.createElement("input",{type:"checkbox",checked:S,onChange:()=>s(p.id,x)}),ki.default.createElement("span",{dangerouslySetInnerHTML:{__html:d(b)}}))})));case"textarea":let y=((f=m==null?void 0:m.textAreas)==null?void 0:f[p.id])||"";return ki.default.createElement("div",{className:"trade-review-textarea",key:p.id},p.title&&ki.default.createElement("h3",{dangerouslySetInnerHTML:{__html:d(p.title)}}),ki.default.createElement("textarea",{value:y,onChange:b=>l(p.id,b.target.value),placeholder:p.placeholder||"",rows:4,className:"trade-review-textarea-input"}));default:return null}},d=p=>{let m=p.replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>");return m=m.replace(/__([^_]+)__/g,"<strong>$1</strong>"),m=m.replace(/(^|[^*])\*([^*]+)\*(?!\*)/g,"$1<em>$2</em>"),m=m.replace(/(^|[^_])_([^_]+)_(?!_)/g,"$1<em>$2</em>"),m=m.replace(/\n/g,"<br>"),m};if(!e.enabled)return null;let u=ki.default.createElement("div",{className:"trade-review-sections"},e.sections.map(p=>{try{return ki.default.createElement("div",{className:"trade-review-section",key:p.id},c(p))}catch(m){return console.error(`Error rendering trade review section ${p.id}:`,m),null}}));return ki.default.createElement("div",{className:"trade-review-container"},ki.default.createElement(ri,{title:"Trade Review",defaultExpanded:!0},u))});DP.displayName="TradeReview"});var Mt,zbe,HGe,jbe=F(()=>{Mt=Y(Q());rl();nr();Eq();Iq();Mq();Oa();xM();Tr();Lq();bf();zbe=Mt.default.memo(({data:e,onEditClick:t})=>{var S,w,C,D,P,M,z,A,I,L;let[r,n]=(0,Mt.useState)(e.filePath||"unknown"),[i,a]=(0,Mt.useState)({reviewed:e.reviewed,reviewedAt:e.reviewedAt});(0,Mt.useEffect)(()=>{a({reviewed:e.reviewed,reviewedAt:e.reviewedAt})},[e.reviewed,e.reviewedAt]);let o=(0,Mt.useRef)(null),{metrics:s,formatDate:l,formatTime:c}=PP({data:e}),d=Ae(),[u,p]=(0,Mt.useState)(0),[m,g]=(0,Mt.useState)(e.lossReview);(0,Mt.useEffect)(()=>{g(e.lossReview)},[e.lossReview]),(0,Mt.useEffect)(()=>xe.subscribe("trade-template:changed",()=>{p(E=>E+1)}),[]);let f=(0,Mt.useMemo)(()=>{var E;if(!d)return null;try{let T=new il(d);if(typeof e.templateId=="string"){let _=T.getTemplate(e.templateId);if(_)return _}let $=(E=d.settings.templates)==null?void 0:E.defaultTrade;if($){let _=T.getTemplate($);if(_)return _}return T.getDefaultTemplate()}catch(T){return console.error("[MissedTradeNote] Error loading trade template:",T),null}},[d,e.templateId,u]),v=(0,Mt.useMemo)(()=>{var $;return($=f==null?void 0:f.sections)!=null&&$.review?{enabled:!0,sections:(f.sections.review.sections||[]).map(_=>({id:_.id,type:_.type,title:_.title,content:_.content,placeholder:_.placeholder,items:_.items}))}:{enabled:!1,sections:[]}},[f]),h=(0,Mt.useCallback)(async E=>{if(!(d!=null&&d.missedTradeService)||!r||r==="unknown")return;let T=m;g(E);try{await d.missedTradeService.updateMissedTradeReview(r,E)}catch($){console.error("[MissedTradeNote] Error updating missed trade review:",$),g(T)}},[d,r,m]);(0,Mt.useEffect)(()=>{sh(),t0();let E=e.images||[];if(o.current){o.current.classList.add("missed-trade-note-mounted"),o.current.setAttribute("data-mounted-at",Date.now().toString());let T=o.current.closest(".journalit-missed-trade-view");T&&T.classList.add("missed-trade-note-mounted")}},[]);let y=(0,Mt.useCallback)(E=>{if(o.current=E,E&&(!r||r==="unknown")){let T=E.getAttribute("data-displaying-file");if(T){n(T);return}let $=E.parentElement;for(;$;){let _=$.getAttribute("data-displaying-file")||$.getAttribute("data-file-path");if(_){n(_);break}$=$.parentElement}}},[r]),b=async E=>{if(!d||!d.accountPageService){console.error("Cannot navigate to account: AccountPageService not available");return}try{let $=(await d.accountPageService.getAllEnhancedAccounts()).find(_=>_.id===E||_.name===E);$?d.openFile?d.openFile($.notePath,!1):d.app&&d.app.workspace.openLinkText($.notePath,"",!1):console.error(`Could not find account: ${E}`)}catch(T){console.error("Error navigating to account:",T)}},k=(0,Mt.useCallback)(()=>{t&&t(e)},[e,t]),x=(0,Mt.useCallback)(async()=>{if(d!=null&&d.missedTradeService&&r&&r!=="unknown"){let E=new Date().toISOString();a({reviewed:!0,reviewedAt:E});try{await d.missedTradeService.updateMissedTradeReviewStatus(r,!0,E),console.log("Missed trade marked as reviewed")}catch(T){console.error("[MissedTradeNote] Error updating review status:",T),a({reviewed:e.reviewed,reviewedAt:e.reviewedAt})}}},[d,r,e.reviewed,e.reviewedAt]);return Mt.default.createElement("div",{className:"missed-trade-note-container",ref:y,"data-file-path":r,style:{margin:0}},Mt.default.createElement(CP,{instrument:e.instrument,direction:e.direction,isProfit:s.isProfit,isBreakeven:s.isBreakeven,pnl:s.pnl,percentChange:s.percentChange,useDirectPnLInput:e.useDirectPnLInput,isMissedTrade:!0,isBacktestTrade:!1,assetType:e.assetType,optionType:e.optionType,exitTime:e.exitTime,exitPrice:e.exitPrice,tradeStatus:e.tradeStatus,exits:e.exits,rMultiple:e.rMultiple,displayRMultiples:(C=(w=(S=d==null?void 0:d.settings)==null?void 0:S.trade)==null?void 0:w.displayRMultiples)!=null?C:!1,riskAmount:e.riskAmount}),(e.entryTime||e.useDirectPnLInput)&&Mt.default.createElement(HGe,{data:e,filePath:r,onEditClick:t,handleEditClick:k}),Mt.default.createElement("div",{className:"missed-trade-note-content"},Mt.default.createElement(kP,{images:e.images,onEditClick:k}),Mt.default.createElement(SP,{data:e,onAccountClick:b}),Mt.default.createElement(TP,{data:e,metrics:s,formatDate:l,formatTime:c,onEditClick:k,displayRMultiples:(M=(P=(D=d==null?void 0:d.settings)==null?void 0:D.trade)==null?void 0:P.displayRMultiples)!=null?M:!1,defaultRiskAmount:(I=(A=(z=d==null?void 0:d.settings)==null?void 0:z.trade)==null?void 0:A.defaultRiskAmount)!=null?I:0}),e.missedReason&&Mt.default.createElement("div",{className:"missed-trade-reason-section"},Mt.default.createElement("div",{className:"details-card"},Mt.default.createElement("h4",null,"Why I missed this trade"),Mt.default.createElement("div",{className:"missed-trade-reason-content"},(L=e.missedReason)==null?void 0:L.split(`
`).map((E,T)=>Mt.default.createElement(Mt.default.Fragment,{key:T},E,T<e.missedReason.split(`
`).length-1&&Mt.default.createElement("br",null)))))),(()=>{var $,_,B,W,N,U;return((B=(_=($=f==null?void 0:f.sections)==null?void 0:$.review)==null?void 0:_.show)!=null?B:"losses-only")==="never"?!1:(U=(N=(W=f==null?void 0:f.sections)==null?void 0:W.review)==null?void 0:N.showForMissed)!=null?U:!1})()&&Mt.default.createElement(DP,{settings:v,data:m,onUpdate:h,filePath:r}),Mt.default.createElement("div",{className:"missed-trade-note-review-section"},Mt.default.createElement(bM,{reviewed:i.reviewed,reviewedAt:i.reviewedAt,onMarkReviewed:x}))))},(e,t)=>e.data.pnl===t.data.pnl&&e.data.entryTime===t.data.entryTime&&e.data.exitTime===t.data.exitTime&&e.data.instrument===t.data.instrument&&e.data.direction===t.data.direction&&e.data.missedReason===t.data.missedReason&&e.data.templateId===t.data.templateId&&JSON.stringify(e.data.images)===JSON.stringify(t.data.images)&&JSON.stringify(e.data.lossReview)===JSON.stringify(t.data.lossReview)&&e.onEditClick===t.onEditClick),HGe=Mt.default.memo(({data:e,filePath:t,onEditClick:r,handleEditClick:n})=>{let i=Ae(),[a,o]=(0,Mt.useState)([]),[s,l]=(0,Mt.useState)([]),[c,d]=(0,Mt.useState)(!1),[u,p]=(0,Mt.useState)(!1),[m,g]=(0,Mt.useState)(0),f=Mt.default.useMemo(()=>{if(e.entryTime)return new Date(e.entryTime);if(t&&t!=="unknown"){let D=t.match(/(\d{2})(\d{2})(\d{2})-M\d+\.md$/);if(D){let[,P,M,z]=D,A=2e3+parseInt(z,10);return new Date(A,parseInt(M,10)-1,parseInt(P,10))}}return new Date},[e.entryTime,t]),v=Mt.default.useMemo(()=>{if(!f||!i)return null;let{start:D,end:P}=II(f,i);return{startDate:D,endDate:P}},[f,i]),h=Mt.default.useMemo(()=>!f||!i?"":mc(f,i),[f,i]),y=Mt.default.useRef(null);(0,Mt.useEffect)(()=>{let D=y.current;if(!D)return;let P=new IntersectionObserver(M=>{let[z]=M;z.isIntersecting&&(p(!0),P.disconnect())},{rootMargin:"50px",threshold:.1});return P.observe(D),()=>P.disconnect()},[]);let b=(0,Mt.useCallback)(D=>{let{action:P}=D;(P==="created"||P==="updated")&&h&&setTimeout(()=>{Object.keys(sessionStorage).forEach(M=>{(M.startsWith("trade-nav-")||M.startsWith("missed-trade-nav-"))&&sessionStorage.removeItem(M)}),o([]),l([]),d(!1),g(M=>M+1)},200)},[h]);Xe("trade:changed",b),Xe("missed-trade:changed",b),(0,Mt.useEffect)(()=>{if(!u||!v||!(i!=null&&i.tradeService)||!(i!=null&&i.missedTradeService)||!h)return;let D=!0;return(async()=>{try{if(c)return;d(!0),setTimeout(async()=>{try{let[M,z]=await Promise.all([i.tradeService.getTrades(v.startDate,v.endDate),i.missedTradeService.getMissedTrades(v.startDate,v.endDate)]);D&&(o(M),l(z))}catch(M){console.error("Error fetching trades for day:",M)}finally{D&&d(!1)}},100)}catch(M){console.error("Error in trade fetch setup:",M),D&&d(!1)}})(),()=>{D=!1}},[u,v,i==null?void 0:i.tradeService,i==null?void 0:i.missedTradeService,h,m]);let k=(0,Mt.useCallback)((D,P=!1)=>{try{i&&i.openFile?i.openFile(D,P):i!=null&&i.app?i.app.workspace.openLinkText(D,"",P):console.error("Cannot navigate: Plugin and App context not available.")}catch(M){console.error("Navigation error:",M)}},[i]),x=(0,Mt.useCallback)(D=>i!=null&&i.drcService?i.drcService.getDRCNotePath(D):"",[i==null?void 0:i.drcService]),S=(0,Mt.useCallback)(D=>i!=null&&i.weeklyReviewService?i.weeklyReviewService.getWeeklyReviewPath(D):"",[i==null?void 0:i.weeklyReviewService]),w=(0,Mt.useCallback)(D=>i!=null&&i.drcService?i.drcService.getMonthlyReviewPath(D):null,[i==null?void 0:i.drcService]),C=(0,Mt.useCallback)(()=>null,[]);return!f||!(i!=null&&i.drcService)||!(i!=null&&i.weeklyReviewService)?null:Mt.default.createElement("div",{ref:y},u?Mt.default.createElement(Mt.default.Fragment,null,Mt.default.createElement(tO,{currentDate:f,trades:a,missedTrades:s,currentTradePath:t,navigateTo:k,getDRCPath:x,getWeeklyReviewPath:S,getMonthlyReviewPath:w,getYearlyReviewPath:C,onEditClick:r,handleEditClick:n})):Mt.default.createElement("div",{style:{height:"60px",display:"flex",alignItems:"center",justifyContent:"center"}},Mt.default.createElement("div",{style:{color:"var(--text-muted)",fontSize:"12px"}},"Loading navigation...")))})});var _be,Bbe,iv,nO=F(()=>{_be=Y(Q()),Bbe=Y(Ni());Er();iv=class{constructor(t){this.reactRoots=new Map;this.rootCreationTimes=new Map;this.app=t,this._currencyChangeHandler=()=>this.reRenderAllComponents(),window.addEventListener("journalit-currency-changed",this._currencyChangeHandler)}reRenderAllComponents(){}cleanup(){window.removeEventListener("journalit-currency-changed",this._currencyChangeHandler)}getOpenNoteFunction(){var t,r;try{let n=(r=(t=window.app)==null?void 0:t.plugins)==null?void 0:r.plugins.journalit;return n?(i,a=!1)=>{n.openFile(i,a)}:void 0}catch(n){console.error(`[${this.constructor.name}] Error getting openNote function:`,n);return}}unmountComponent(t,r,n,i){let a=[`${t}-${r}`,n?`${t}-leaf-${n}`:null,r.startsWith("leaf-")?`${t}-${r}`:`${t}-leaf-${r}`,`${t}-view-${r}`,`${t}-context-${r}`,i?`${t}-context-${i}`:null].filter(Boolean),o=!1;for(let s of a){let l=this.reactRoots.get(s);if(l)try{l.root.unmount(),this.reactRoots.delete(s),this.rootCreationTimes.delete(s),o=!0,l.domContainer&&l.domContainer.isConnected&&l.domContainer.remove()}catch(c){console.error(`[${this.constructor.name}] Error unmounting component:`,c,{rootId:s})}}if(!o&&n){for(let[s,l]of this.reactRoots.entries())if(l.leafId===n&&s.startsWith(t))try{l.root.unmount(),this.reactRoots.delete(s),this.rootCreationTimes.delete(s),o=!0,l.domContainer&&l.domContainer.isConnected&&l.domContainer.remove()}catch(c){console.error(`[${this.constructor.name}] Error unmounting by leafId:`,c,{id:s})}}if(!o){for(let[s,l]of this.reactRoots.entries())if(s.startsWith(t))try{l.root.unmount(),this.reactRoots.delete(s),this.rootCreationTimes.delete(s),o=!0,l.domContainer&&l.domContainer.isConnected&&l.domContainer.remove()}catch(c){console.error(`[${this.constructor.name}] Error unmounting fallback component:`,c,{id:s})}}return o}unmountAllComponents(){var a,o;let t={},r=Date.now(),n=this.app.workspace.getActiveFile(),i=n==null?void 0:n.path;for(let[s,l]of this.reactRoots.entries())try{if(i&&s.startsWith(i))continue;let c=this.rootCreationTimes.get(s)||r,d=((r-c)/1e3).toFixed(1);t[s]={domContainer:((a=l.domContainer)==null?void 0:a.tagName)||"unknown",isConnected:((o=l.domContainer)==null?void 0:o.isConnected)||!1,ageSeconds:d};try{l.root.unmount()}catch(u){}if(l.domContainer&&l.domContainer.isConnected)try{l.domContainer.remove()}catch(u){}}catch(c){console.error(`[${this.constructor.name}] Error unmounting root:`,{rootId:s,error:c})}for(let s of Object.keys(t))this.reactRoots.delete(s),this.rootCreationTimes.delete(s);this.cleanupOrphanedDomElements()}unmountLeafComponents(t){let r=[];for(let[n,i]of this.reactRoots.entries())if(i.leafId===t)try{i.root.unmount(),r.push(n),i.domContainer&&i.domContainer.isConnected&&i.domContainer.remove()}catch(a){console.error(`[${this.constructor.name}] Error unmounting leaf component:`,{rootId:n,leafId:t,error:a})}r.length>0&&(r.forEach(n=>this.reactRoots.delete(n)),this.cleanupLeafDomElements(t))}cleanupLeafDomElements(t){let r=this.getComponentClassName(),n=this.getWrapperClassName(),i=document.querySelectorAll(`.${r}[data-leaf-id="${t}"]`),a=document.querySelectorAll(`.${n}[data-leaf-id="${t}"]`);i.forEach(o=>{try{o.remove()}catch(s){console.error(`[${this.constructor.name}] Error removing leaf view element:`,s)}}),a.forEach(o=>{try{o.remove()}catch(s){console.error(`[${this.constructor.name}] Error removing leaf wrapper element:`,s)}})}cleanupOrphanedDomElements(){let t=this.getComponentClassName(),r=this.getWrapperClassName(),n=document.querySelectorAll(`.${t}`),i=document.querySelectorAll(`.${r}`);n.forEach(a=>{try{a.remove()}catch(o){console.error(`[${this.constructor.name}] Error removing orphaned view element:`,o)}}),i.forEach(a=>{try{a.remove()}catch(o){console.error(`[${this.constructor.name}] Error removing orphaned wrapper element:`,o)}})}findContainingLeaf(t){var a,o;let r=t.closest(".workspace-leaf");if(!r)return;let n=r.id;if(!n){let s=r.querySelector(".workspace-tab-header");if(s){let c=(a=s.textContent)==null?void 0:a.trim();if(c){let d;if(this.app.workspace.iterateAllLeaves(u=>{u.getDisplayText()===c&&(d=u)}),d)return d}}let l=r.querySelector(".view-header-title-container");if(l){let c=(o=l.textContent)==null?void 0:o.trim();if(c){let d;if(this.app.workspace.iterateAllLeaves(u=>{let p=u.view;p&&"file"in p&&p.file&&p.file.basename===c&&(d=u)}),d)return d}}return}let i;return this.app.workspace.iterateAllLeaves(s=>{var c;let l=(c=s.view)==null?void 0:c.containerEl;l&&l.id===n&&(i=s)}),i||this.app.workspace.iterateAllLeaves(s=>{var c;let l=(c=s.view)==null?void 0:c.containerEl;l&&l.contains(t)&&(i=s)}),i}createReactRoot(t,r,n,i,a,o){let s=document.createElement("div");s.className=this.getWrapperClassName(),s.setAttribute(`data-${this.getComponentClassName()}-root-id`,r),n&&s.setAttribute("data-leaf-id",n),i&&s.setAttribute("data-context-id",i),s.setAttribute("data-protected","true"),t.appendChild(s);let l=(0,Bbe.createRoot)(s),c={root:l,domContainer:s,leafId:n};this.reactRoots.set(r,c),this.rootCreationTimes.set(r,Date.now());let d=this.getOpenNoteFunction();return l.render(_be.default.createElement(el,{children:null},this.createReactElement(a,o,d))),c}getDomPath(t){let r=[],n=t;for(;n&&n!==document.body;){let i=n.nodeName.toLowerCase();if(n.id)i+=`#${n.id}`;else{n.className&&(i+=`.${Array.from(n.classList).join(".")}`);let a=n.parentElement?Array.from(n.parentElement.children):[];if(a.length>1){let o=a.indexOf(n);i+=`:nth-child(${o+1})`}}r.unshift(i),n=n.parentElement}return r.join(" > ")}}});function bm(e){return`${qGe.PERIODIC}/${e}`}function xm(e){return[]}function VGe(e){return Array.from(new Set(e.filter(Boolean)))}function wm(...e){let t=e.flat();return VGe(t)}function EP(e){if(!e)return"";if(typeof e=="string"&&e.startsWith('"')&&e.endsWith('"'))try{let t=JSON.parse(e);if(typeof t=="string")return t}catch(t){return e.slice(1,-1)}return e}var qGe,ym,av=F(()=>{qGe={TRADE:"trade",PERIODIC:"periodic",ACCOUNT:"account",SETUP:"setup",MISTAKE:"mistake",DIRECTION:"direction",ASSET:"asset",STATUS:"status"},ym={DAILY:"daily",WEEKLY:"weekly",MONTHLY:"monthly",QUARTERLY:"quarterly",YEARLY:"yearly"}});var Wbe,lk,Nq=F(()=>{Wbe=Y(Q());jbe();nO();rl();av();lk=class extends iv{constructor(t){super(t)}renderComponent(t,r,n,i,a){t.querySelector(".missed-trade-note-container.missed-trade-note-mounted")||this.renderMissedTradeNote(t,r,n,i,a)}renderMissedTradeNote(t,r,n,i,a){try{if(t0(),!t||!t.isConnected){console.error(`[MissedTradeNote] Cannot render into disconnected container for ${n}`);return}let o=a?`${n}-${i}-${a}`:`${n}-${i}`,s=i.startsWith("leaf-")?i.substring(5):i,l=this.processMissedTradeData(r);t.setAttribute("data-displaying-file",n);let c=this.findContainingLeaf(t),d=t.querySelector(".journalit-missed-trade-note-wrapper");if(d){if(d.querySelector(".missed-trade-note-mounted"))return;d.remove()}let u=null;if(c&&c.view){let f=c.view.containerEl;f&&f.id&&(u=f.id)}let p=this.reactRoots.get(o);if(p&&p.domContainer&&p.domContainer.isConnected&&p.domContainer.querySelector(".missed-trade-note-mounted"))return;t.empty();let m=this.reactRoots.get(o);if(m&&(c&&u&&m.leafId!==u||a&&m.domContainer&&m.domContainer.getAttribute("data-context-id")!==a)){let f=a?`${n}-context-${a}`:`${n}-${i}-${u}`;if(m=this.reactRoots.get(f),!m){this.createReactRoot(t,f,u||void 0,a,l,n);return}}if(!m)this.createReactRoot(t,o,u||void 0,a,l,n);else{let f=m.domContainer;t.contains(f)?m.root.render(this.createReactElement(l,n)):this.createReactRoot(t,o,u||void 0,a,l,n)}}catch(o){console.error("[MissedTradeNote] Error rendering missed trade note:",o),t.setText("Error rendering missed trade note: "+(o instanceof Error?o.message:String(o)))}}getComponentClassName(){return"journalit-missed-trade-view"}getWrapperClassName(){return"journalit-missed-trade-note-wrapper"}createReactElement(t,r,n){let i=o=>{var l,c;let s=(c=(l=window.app)==null?void 0:l.plugins)==null?void 0:c.plugins.journalit;if(!s){console.error("Cannot access plugin instance for edit action");return}s.openTradeFormInEditMode?s.openTradeFormInEditMode(o,r):console.warn("Edit mode not available - plugin method missing")},a=async o=>{var l,c;let s=(c=(l=window.app)==null?void 0:l.plugins)==null?void 0:c.plugins.journalit;if(!s||!s.missedTradeService){console.error("Cannot access plugin instance for data update");return}try{await s.missedTradeService.updateMissedTrade(o,r,"user-input")}catch(d){console.error("[MissedTradeNote] Error updating missed trade data:",d)}};return Wbe.default.createElement(zbe,{data:{...t,filePath:r},onEditClick:i,onDataUpdate:a})}unmountMissedTradeNote(t,r,n,i){return this.unmountComponent(t,r,n)}unmountAllMissedTradeNotes(){this.unmountAllComponents()}unmountLeafMissedTradeNotes(t){this.unmountLeafComponents(t)}processMissedTradeData(t){var n,i;let r={...t};r.isMissedTrade=!0,t.images&&(r.images=this.normalizeImagePaths(t.images)),["setupIds","mistakeIds","accountIds","setup","mistake","account","tags","customTags"].forEach(a=>{if(r[a]&&!Array.isArray(r[a]))if(typeof r[a]=="string"&&r[a].startsWith("[")&&r[a].endsWith("]"))try{let o=r[a].slice(1,-1).trim();o?r[a]=o.split(",").map(s=>s.trim()):r[a]=[]}catch(o){console.error(`[MissedTradeNote] Failed to parse array string: ${a}`,o),r[a]=[r[a]]}else r[a]=[r[a]]}),r.tags&&Array.isArray(r.tags)&&(r.customTags=r.tags),["entryTime","exitTime"].forEach(a=>{if(r[a]&&typeof r[a]=="string")try{r[a]=new Date(r[a])}catch(o){console.error(`[MissedTradeNote] Failed to parse date: ${a}`,o)}}),["entryPrice","exitPrice","positionSize","pnl","directPnL"].forEach(a=>{if(r[a]!==void 0&&typeof r[a]!="number")try{r[a]=parseFloat(r[a])}catch(o){console.error(`[MissedTradeNote] Failed to parse number: ${a}`,o)}}),["useDirectPnLInput","isMissedTrade"].forEach(a=>{if(r[a]!==void 0&&typeof r[a]!="boolean")try{r[a]=!!r[a]}catch(o){console.error(`[MissedTradeNote] Failed to parse boolean: ${a}`,o)}}),r.thesis=EP(t.thesis)||"",r.missedReason=EP(t.missedReason)||"";try{let a=(i=(n=window.app)==null?void 0:n.plugins)==null?void 0:i.plugins.journalit;if(a&&a.customFieldsService){let o=a.customFieldsService.getFields(),s={};o.forEach(l=>{let c=l.fieldKey;c&&t[c]!==void 0&&(s[l.id]=t[c])}),Object.keys(s).length>0&&(r.customFields=s)}}catch(a){console.error("[MissedTradeNote] Error reconstructing custom fields:",a)}return r}normalizeImagePaths(t){if(!t)return[];if(Array.isArray(t))return t.map((n,i)=>typeof n!="string"?String(n):n.replace(/['"`]/g,"").trim()).filter(n=>!!n&&n.length>0&&!n.match(/^[\s]*$/));if(typeof t=="string"&&t.startsWith("[")&&t.endsWith("]"))try{let r=t.slice(1,-1).trim();return r?r.split(",").map(n=>n.trim().replace(/['"`]/g,"")).filter(Boolean):[]}catch(r){return console.error("[MissedTradeNote] Failed to parse images string:",r),[t.replace(/['"`]/g,"").trim()]}if(typeof t=="string"){let r=t.replace(/['"`]/g,"").trim();return r?[r]:[]}return[]}}});function Fq(e){return"file"in e&&e.file!==void 0}var $be=F(()=>{});var aO,iO,ov,oO=F(()=>{aO=require("obsidian");$be();iO=class iO{constructor(t,r,n){this.activeObservers=[];this.registeredLeaves=new Set;this.renderedFilePaths=new Map;this.app=t,this.plugin=r,this.renderer=n}async hasTemplateIdInRawFrontmatter(t){try{let n=(await this.app.vault.cachedRead(t)).match(/^---\n([\s\S]*?)\n---/);return n?iO.TEMPLATE_ID_REGEX.test(n[1]):!1}catch(r){return r instanceof Error&&!r.message.includes("ENOENT")&&console.debug("[BaseComponentProcessor] Unexpected error reading frontmatter:",r),!1}}initialize(){this.app.workspace.onLayoutReady(()=>{this.cleanupOrphanedComponents(),this.handleInitialFileOpen()}),this.registerMarkdownPostProcessor(),this.setupFileOpenHandler(),this.setupLayoutChangeHandler()}cleanup(){this.activeObservers.forEach(t=>{t.disconnect()}),this.renderer.unmountAllComponents(),this.renderer.cleanup(),this.activeObservers=[],this.registeredLeaves.clear(),this.renderedFilePaths.clear()}registerMarkdownPostProcessor(){this.plugin.registerMarkdownPostProcessor(this.handleMarkdownPostProcessor.bind(this))}setupLayoutChangeHandler(){this.plugin.registerEvent(this.app.workspace.on("layout-change",this.handleLayoutChange.bind(this))),this.plugin.registerEvent(this.app.workspace.on("editor-change",(t,r)=>{if(r&&"file"in r&&r.file){let n=r.file;if(n){let i=this.app.metadataCache.getFileCache(n),a=i==null?void 0:i.frontmatter;if(a&&this.isValidComponentType(a)){let s=(r instanceof aO.MarkdownView?r.getMode()==="source":!1)?"source":"preview";this.clearFileRenderedStatus(n.path,s),setTimeout(()=>{this.handleFileOpen(n,!0)},50)}}}})),this.app.workspace.onLayoutReady(()=>{this.app.workspace.iterateAllLeaves(t=>{var n;let r=(n=t.view)==null?void 0:n.containerEl;r&&r.id&&this.registeredLeaves.add(r.id)})})}handleLayoutChange(){let t=new Set;this.app.workspace.iterateAllLeaves(n=>{var a;let i=(a=n.view)==null?void 0:a.containerEl;i&&i.id&&(t.add(i.id),this.registeredLeaves.has(i.id)||this.registeredLeaves.add(i.id))});let r=[];this.registeredLeaves.forEach(n=>{t.has(n)||r.push(n)}),r.forEach(n=>{this.registeredLeaves.delete(n),this.renderer.unmountLeafComponents(n)})}async handleMarkdownPostProcessor(t,r){var s,l,c;if(!r.sourcePath)return;let n=this.app.vault.getAbstractFileByPath(r.sourcePath);if(!(n instanceof aO.TFile))return;let i=this.app.metadataCache.getFileCache(n),a=i==null?void 0:i.frontmatter;if(!a||!this.isValidComponentType(a)||!a.templateId&&await this.hasTemplateIdInRawFrontmatter(n))return;if(((s=t.parentElement)==null?void 0:s.classList.contains("markdown-preview-view"))&&!r.sourcePath.endsWith("#")&&!t.previousElementSibling){if(this.isFileRenderedInMode(n.path,"preview"))return;let d=t.parentElement;if(!d){console.warn(`[${this.constructor.name}] Cannot find parent markdown view for:`,r.sourcePath);return}let u=d.closest(".workspace-leaf-content");if(!u){console.warn(`[${this.constructor.name}] Cannot find containing leaf for:`,r.sourcePath);return}let p=d.closest(".workspace-leaf"),m=p==null?void 0:p.id,g=this.findContainingLeaf(u),f=(l=g==null?void 0:g.view)==null?void 0:l.containerEl,v=m||(f==null?void 0:f.id)||null,h=this.getUniqueElementId(d),y=v?`leaf-${v}`:h,b=!0;if(g){let D=g.view,P=null;Fq(D)?P=(c=D.file)!=null?c:null:D&&"getViewType"in D&&D.getViewType()==="markdown"&&(P=D.file),P&&(b=P.path===n.path)}if(!b)return;let k=this.getComponentClassName();d.querySelectorAll(`.${k}`).forEach(D=>{let P=D.getAttribute("data-file-path");if(P&&P!==n.path){let M=D.getAttribute("data-view-id"),z=D.getAttribute("data-leaf-id");M&&this.renderer.unmountComponent(P,M,z||void 0),D.remove()}});let x=this.getWrapperClassName();if(Array.from(d.querySelectorAll(`.${x}`)).filter(D=>{var P;return((P=D.closest(`.${k}`))==null?void 0:P.getAttribute("data-file-path"))===n.path}).length>0||Array.from(d.querySelectorAll(`.${k}`)).find(D=>D.getAttribute("data-file-path")===n.path))return;d.querySelectorAll(`.${k}`).forEach(D=>{D.getAttribute("data-file-path")===n.path&&D.remove()});let C=document.createElement("div");C.className=this.getComponentClassName(),C.setAttribute("data-file-path",n.path),C.setAttribute("data-view-id",y),C.setAttribute("data-markdown-view-id",h),v&&C.setAttribute("data-leaf-id",v),C.setAttribute("data-inserted-at",Date.now().toString()),d.insertBefore(C,d.firstChild);try{let D=await this.getAdditionalDataForComponent(n,a);await this.renderer.renderComponent(C,{...a,...D},n.path,y,h),this.markFileRenderedInMode(n.path,"preview")}catch(D){console.error(`[${this.constructor.name}] Error rendering component:`,D),C.textContent=`Error rendering ${this.getComponentTypeIdentifier()}: ${D instanceof Error?D.message:String(D)}`}}}generateViewId(t){let r=t.closest(".workspace-leaf");if(r&&r.id)return`leaf-${r.id}`;let n=t.closest(".workspace-leaf-content");if(n&&n.id)return`content-${n.id}`;let i=t.closest(".view-content");if(i){let l=Array.from(document.querySelectorAll(".view-content")).indexOf(i);if(l>=0)return`view-content-${l}`}let a=t.closest(".markdown-preview-view");if(a){let l=Array.from(document.querySelectorAll(".markdown-preview-view")).indexOf(a);if(l>=0)return`markdown-view-${l}`}let o=t.closest(".cm-editor");if(o){let l=Array.from(document.querySelectorAll(".cm-editor")).indexOf(o);if(l>=0)return`editor-${l}`}if(t.parentElement){let l=Array.from(t.parentElement.children).indexOf(t);return`view-${Date.now()}-${l}`}return`view-${Date.now()}-${Math.random().toString(36).substring(2,9)}`}setupFileOpenHandler(){this.plugin.registerEvent(this.app.workspace.on("file-open",t=>this.handleFileOpen(t,!1))),this.app.workspace.onLayoutReady(()=>{let t=this.app.workspace.getActiveFile();t&&setTimeout(()=>{this.handleFileOpen(t,!0)},100)})}renderWithDeduplication(t){let{file:r,container:n,data:i,viewId:a,contextId:o}=t,s=t.componentClassName||this.getComponentClassName(),l=t.mountedClassName||"component-mounted",c=t.contentSelector||".component-container",d=`${r.path}-${a}-${Date.now()}`;if(n.setAttribute("data-render-request",d),n.setAttribute("data-debug-version","1.0.0"),n.getAttribute("data-mounted-at"))return!1;let p=n.querySelector(c);if(p&&p.classList.contains(l))return!1;let m=document.querySelectorAll(`.${s}[data-file-path="${r.path}"]`);if(Array.from(document.querySelectorAll(`.${s}`)).some(v=>{if(v.getAttribute("data-file-path")!==r.path)return!1;let y=v.querySelector(c),b=y&&(y.classList.contains(l)||y.querySelector("*")),k=parseInt(v.getAttribute("data-inserted-at")||"0"),x=Date.now()-k<5e3;return b&&x}))return this.markFileRenderedInMode(r.path,a),!1;let f=!!n.closest(".cm-editor");return n.setAttribute("data-view-mode",f?"source":"preview"),this.renderer.renderComponent(n,i,r.path,a,o),this.markFileRenderedInMode(r.path,a),!0}hasProperlyRenderedComponents(t,r,n,i){let a=r||this.getComponentClassName(),o=n||".component-container",s=i||"component-mounted",l=document.querySelectorAll(`.${a}[data-file-path="${t}"]`);return l.length===0?!1:Array.from(l).some(c=>{let d=c.querySelector(o);return d&&(d.classList.contains(s)||d.children&&d.children.length>0)})}cleanupDuplicateComponents(t,r){let n=r||this.getComponentClassName(),i=Array.from(document.querySelectorAll(`.${n}[data-file-path="${t}"]`)),a=0;if(i.length>1)for(let o=1;o<i.length;o++){let s=i[o],l=s.getAttribute("data-view-id"),c=s.getAttribute("data-leaf-id");l&&this.renderer.unmountComponent(t,l,c||void 0),s.remove(),a++}return a}getUniqueElementId(t){if(t.id)return`dom-${t.id}`;let r=t.tagName.toLowerCase(),i=Array.from(document.querySelectorAll(r)).indexOf(t),a=r;if(t.className){let l=t.className.split(" ")[0];l&&(a+=`.${l}`)}let s=Array.from(document.querySelectorAll(a)).indexOf(t);return`dom-${a.replace(/\./g,"-")}-${s}-${i}-${Date.now()}`}isFileRenderedInMode(t,r){let n=this.renderedFilePaths.get(t);return n?n.has(r):!1}markFileRenderedInMode(t,r){let n=this.renderedFilePaths.get(t);n||(n=new Set,this.renderedFilePaths.set(t,n)),n.add(r)}clearFileRenderedStatus(t,r){if(!r){this.renderedFilePaths.delete(t);return}let n=this.renderedFilePaths.get(t);n&&(n.delete(r),n.size===0&&this.renderedFilePaths.delete(t))}findContainingLeaf(t){let r=t.closest(".workspace-leaf");if(!r)return;let n=r.id;if(n){let o;if(this.app.workspace.iterateAllLeaves(s=>{var c;let l=(c=s.view)==null?void 0:c.containerEl;l&&l.id===n&&(o=s)}),o)return o}let i=r.querySelector(".view-header-title");if(i&&i.textContent){let o=i.textContent.trim(),s;if(this.app.workspace.iterateAllLeaves(l=>{let c=l.view;c&&"file"in c&&c.file&&c.file.basename===o&&(s=l)}),s)return s}let a;if(this.app.workspace.iterateAllLeaves(o=>{var l;let s=(l=o.view)==null?void 0:l.containerEl;s&&s.contains(t)&&(a=o)}),a)return a}cleanupUnrelatedComponents(t){var c;let r=this.app.workspace.activeLeaf;if(!r)return;let n=null;try{n=((c=r.view)==null?void 0:c.containerEl)||r.containerEl}catch(d){console.error(`[${this.constructor.name}] Could not get active leaf container:`,d);return}if(!n)return;let i=this.getComponentClassName(),a=n.querySelectorAll(`.${i}`);if(a.length===0)return;let o=this.getWrapperClassName(),s=n.querySelectorAll(`.${o}`),l=0;a.forEach(d=>{let u=d.getAttribute("data-file-path");if(!u||u===t)return;let p=d.getAttribute("data-view-id"),m=d.getAttribute("data-leaf-id");p&&this.renderer.unmountComponent(u,p,m||void 0),d.remove(),l++,this.clearFileRenderedStatus(u)}),s.forEach(d=>{let u=d.closest(`.${i}`);(!u||!u.isConnected)&&(d.remove(),l++)})}cleanupOrphanedComponents(){let t=this.app.workspace.activeLeaf;if(!t||!t.view)return;let r=null;try{r=t.view.containerEl||t.containerEl}catch(s){console.error(`[${this.constructor.name}] Could not get active leaf container:`,s);return}if(!r)return;let n=this.getComponentClassName(),i=r.querySelectorAll(`.${n}`);if(i.length===0)return;let a=t.view,o=null;(a&&"file"in a&&a.file||a&&"getViewType"in a&&a.getViewType()==="markdown")&&(o=a.file),i.forEach(s=>{let l=s.getAttribute("data-file-path");if(!l)return;let c=s.getAttribute("data-leaf-id");if(o&&o.path!==l){let d=s.getAttribute("data-view-id");d&&this.renderer.unmountComponent(l,d,c||void 0),s.remove(),this.clearFileRenderedStatus(l)}})}handleInitialFileOpen(){let t=this.app.workspace.getActiveFile();t&&this.handleFileOpen(t,!0),this.app.workspace.iterateAllLeaves(r=>{var a;let n=r.view,i=null;n&&Fq(n)?i=(a=n.file)!=null?a:null:n&&"getViewType"in n&&n.getViewType()==="markdown"&&(i=n.file),i&&(!t||i.path!==t.path)&&this.handleFileOpen(i,!0)})}};iO.TEMPLATE_ID_REGEX=/^templateId\s*:/m;ov=iO});var sO,ck,Oq=F(()=>{sO=require("obsidian");Nq();oO();Tr();ck=class extends ov{constructor(r,n){super(r,n,new lk(r));this.unsubscribeMissedTradeListener=null;this.observerTimeouts=new Map;this.setupMissedTradeUpdateListener()}async getManualFrontmatter(r){try{let n=await this.app.vault.read(r),i={},a=n.match(/^---\n([\s\S]*?)\n---/m);if(a&&a[1]){let o=a[1].split(`
`),s=null,l=0,c=!1,d=!1,u={};for(let p=0;p<o.length;p++){let m=o[p],g=m.trim();if(!g)continue;let f=m.search(/\S/);if(g.startsWith("- ")){if(s&&d){let y=g.substring(2).trim().match(/^([^:]+):\s*(.*)$/);if(y){let x=y[1].trim(),S=y[2].trim();S==="true"?S=!0:S==="false"?S=!1:/^-?\d+(\.\d+)?$/.test(S)&&(S=parseFloat(S)),u[x]=S}let b=p+1<o.length?o[p+1]:"",k=b.search(/\S/);if(b.trim()&&!b.trim().startsWith("- ")&&k>l)continue;i[s]||(i[s]=[]),i[s].push({...u}),u={}}else s&&(i[s]||(i[s]=[]),i[s].push(g.substring(2).trim()));c=!0;continue}let v=m.match(/^([^:]+):\s*(.*)$/);if(v&&v[1]&&v[2]!==void 0){let h=v[1].trim(),y=v[2].trim();if(y===""){s=h,l=f,c=!1;let b=p+1<o.length?o[p+1]:"";b.trim().startsWith("- ")&&(d=(p+2<o.length?o[p+2]:"").search(/\S/)>b.search(/\S/));continue}if(s=null,c=!1,d=!1,y.startsWith("[")&&y.endsWith("]"))try{let b=y.slice(1,-1).trim();if(!b)i[h]=[];else{let k=b.match(/"[^"]*"|'[^']*'|[^,]+/g)||[];i[h]=k.map(x=>x.replace(/^["']|["']$/g,"").trim()).filter(Boolean)}}catch(b){console.error(`[MissedTradeProcessor] Error parsing array in frontmatter for ${h}:`,b),i[h]=y}else y==="true"?y=!0:y==="false"?y=!1:/^-?\d+(\.\d+)?$/.test(y)&&(y=parseFloat(y)),i[h]=y}else if(f>l&&s&&d){let h=g.match(/^([^:]+):\s*(.*)$/);if(h){let y=h[1].trim(),b=h[2].trim();b==="true"?b=!0:b==="false"?b=!1:/^-?\d+(\.\d+)?$/.test(b)&&(b=parseFloat(b)),u[y]=b}}}}else{let o=this.app.metadataCache.getFileCache(r);i=(o==null?void 0:o.frontmatter)||{}}return i}catch(n){console.error("[MissedTradeProcessor] Error parsing frontmatter manually:",n);let i=this.app.metadataCache.getFileCache(r);return(i==null?void 0:i.frontmatter)||{}}}isValidComponentType(r){return r&&(r.type==="missed-trade"||r.isMissedTrade===!0)}getComponentClassName(){return"journalit-missed-trade-view"}getWrapperClassName(){return"journalit-missed-trade-note-wrapper"}getComponentTypeIdentifier(){return"missed-trade"}async getAdditionalDataForComponent(r,n){return{}}disconnectObserverSafely(r){let n=this.observerTimeouts.get(r);n&&(clearTimeout(n),this.observerTimeouts.delete(r)),r.disconnect();let i=this.activeObservers.indexOf(r);i>-1&&this.activeObservers.splice(i,1)}async handleFileOpen(r,n=!1){if(!r)return;this.cleanupOrphanedComponents(),this.cleanupUnrelatedComponents(r.path);let i=await this.getManualFrontmatter(r);if(!i||!this.isValidComponentType(i))return;let a=document.body,o=new MutationObserver((l,c)=>{let d=document.querySelectorAll(".cm-editor");if(d.length===0)return;d.forEach(p=>{var D;let m=p.querySelector(".metadata-container");if(!m)return;let g=m.closest(".workspace-leaf-content");if(!g)return;let f=this.findContainingLeaf(g),v=(D=f==null?void 0:f.view)==null?void 0:D.containerEl,h=m.closest(".workspace-leaf"),b=(h==null?void 0:h.id)||(v==null?void 0:v.id)||null,k=this.getUniqueElementId(p),x=b?`leaf-${b}`:k,S=!0;if(f){let P=f.view,M=null;(P&&"file"in P||P&&"getViewType"in P&&P.getViewType()==="markdown")&&(M=P.file),M&&(S=M.path===r.path)}if(!S)return;let w=this.getComponentClassName();p.querySelectorAll(`.${w}`).forEach(P=>{let M=P.getAttribute("data-file-path");if(M&&M!==r.path){let z=P.getAttribute("data-view-id"),A=P.getAttribute("data-leaf-id");z&&this.renderer.unmountComponent(M,z,A||void 0),P.remove()}});let C=Array.from(p.querySelectorAll(`.${w}`)).find(P=>P.getAttribute("data-file-path")===r.path);C||(C=document.createElement("div"),C.className=w,C.classList.add("journalit-component-container"),C.setAttribute("data-file-path",r.path),C.setAttribute("data-view-id",x),C.setAttribute("data-editor-id",k),b&&C.setAttribute("data-leaf-id",b),C.setAttribute("data-inserted-at",Date.now().toString()),m.after(C)),this.renderer.renderComponent(C,i,r.path,x,k),this.markFileRenderedInMode(r.path,"source")}),c.disconnect();let u=this.activeObservers.indexOf(c);u>-1&&this.activeObservers.splice(u,1)});this.activeObservers.push(o),o.observe(a,{childList:!0,subtree:!0});let s=setTimeout(()=>{this.disconnectObserverSafely(o)},3e3);this.observerTimeouts.set(o,s)}renderAllActiveMissedTradeNotes(){let r=new Set;this.app.workspace.iterateAllLeaves(n=>{try{if(!n.view||!("file"in n.view))return;let i=n.view.file;if(!i||r.has(i.path))return;let a=this.app.metadataCache.getFileCache(i),o=a==null?void 0:a.frontmatter;if(!o||!this.isValidComponentType(o))return;r.add(i.path),setTimeout(()=>{this.handleFileOpen(i,!0)},300)}catch(i){console.error("[MissedTradeNote] Error rendering active missed trade note at startup:",i)}})}renderActiveComponent(){this.renderActiveMissedTradeNote()}setupMissedTradeUpdateListener(){let r=async n=>{try{if(!n.filePath)return;let i=n.filePath,a=this.app.vault.getAbstractFileByPath(i);if(!(a instanceof sO.TFile)){console.warn(`[MissedTradeProcessor] Cannot find file for path: ${i}`);return}await this.refreshMissedTradeNote(a)}catch(i){console.error("[MissedTradeProcessor] Error handling missed trade update event:",i)}};this.unsubscribeMissedTradeListener=xe.subscribe("missed-trade:changed",r)}async refreshMissedTradeNote(r){try{let n=await this.app.vault.read(r),i={},a=n.match(/^---\n([\s\S]*?)\n---/m);if(a&&a[1]){let c=a[1].split(`
`),d=null,u=0,p=!1,m=!1,g={};for(let f=0;f<c.length;f++){let v=c[f],h=v.trim();if(!h)continue;let y=v.search(/\S/);if(h.startsWith("- ")){if(d&&m){let x=h.substring(2).trim().match(/^([^:]+):\s*(.*)$/);if(x){let C=x[1].trim(),D=x[2].trim();D==="true"?D=!0:D==="false"?D=!1:/^-?\d+(\.\d+)?$/.test(D)&&(D=parseFloat(D)),g[C]=D}let S=f+1<c.length?c[f+1]:"",w=S.search(/\S/);if(S.trim()&&!S.trim().startsWith("- ")&&w>u)continue;i[d]||(i[d]=[]),i[d].push({...g}),g={}}else d&&(i[d]||(i[d]=[]),i[d].push(h.substring(2).trim()));p=!0;continue}let b=v.match(/^([^:]+):\s*(.*)$/);if(b&&b[1]&&b[2]!==void 0){let k=b[1].trim(),x=b[2].trim();if(x===""){d=k,u=y,p=!1;let S=f+1<c.length?c[f+1]:"";S.trim().startsWith("- ")&&(m=(f+2<c.length?c[f+2]:"").search(/\S/)>S.search(/\S/));continue}if(d=null,p=!1,m=!1,x.startsWith("[")&&x.endsWith("]"))try{let S=x.slice(1,-1).trim();if(!S)i[k]=[];else{let w=S.match(/"[^"]*"|'[^']*'|[^,]+/g)||[];i[k]=w.map(C=>C.replace(/^["']|["']$/g,"").trim()).filter(Boolean)}}catch(S){console.error(`[MissedTradeProcessor] Error parsing array in frontmatter for ${k}:`,S),i[k]=x}else x==="true"?x=!0:x==="false"?x=!1:/^-?\d+(\.\d+)?$/.test(x)&&(x=parseFloat(x)),i[k]=x}else if(y>u&&d&&m){let k=h.match(/^([^:]+):\s*(.*)$/);if(k){let x=k[1].trim(),S=k[2].trim();S==="true"?S=!0:S==="false"?S=!1:/^-?\d+(\.\d+)?$/.test(S)&&(S=parseFloat(S)),g[x]=S}}}}else{let c=this.app.metadataCache.getFileCache(r);i=(c==null?void 0:c.frontmatter)||{}}let o=r.path.includes("-M")&&r.path.endsWith(".md");if(!this.isValidComponentType(i)&&!o){console.warn(`[MissedTradeNote] File is not a valid missed trade note: ${r.path}`,{frontmatter:i,type:i==null?void 0:i.type,isMissedTrade:i==null?void 0:i.isMissedTrade,checkedByPath:o});return}this.app.metadataCache.trigger("changed",r),this.cleanupDuplicateComponents(r.path);let s=this.getComponentClassName(),l=document.querySelectorAll(`.${s}[data-file-path="${r.path}"]`);if(l.length===0)return;for(let c of Array.from(l)){let d=c.getAttribute("data-view-id"),u=c.getAttribute("data-markdown-view-id")||c.getAttribute("data-editor-id");d&&(c.classList.add("jl-component-visible"),c.querySelectorAll(`.${this.getWrapperClassName()}`).forEach(m=>m.remove()),await new Promise(m=>setTimeout(()=>{try{this.renderWithDeduplication({file:r,container:c,data:i,viewId:d,contextId:u||void 0,componentClassName:this.getComponentClassName(),mountedClassName:"missed-trade-note-mounted",contentSelector:".missed-trade-note-container"}),m()}catch(g){console.error("[MissedTradeNote] Error during re-render:",g),m()}},50)))}this.markFileRenderedInMode(r.path,"source"),this.markFileRenderedInMode(r.path,"preview")}catch(n){console.error(`[MissedTradeNote] Error refreshing missed trade note for ${r.path}:`,n)}}cleanup(){for(let[r,n]of this.observerTimeouts)clearTimeout(n);this.observerTimeouts.clear(),super.cleanup(),this.unsubscribeMissedTradeListener&&(this.unsubscribeMissedTradeListener(),this.unsubscribeMissedTradeListener=null)}async renderActiveMissedTradeNote(){var p;this.cleanupOrphanedComponents();let r=this.app.workspace.getActiveFile();if(!r)return;let n=await this.getManualFrontmatter(r);if(!n||!this.isValidComponentType(n))return;let i=this.app.workspace.getActiveViewOfType(sO.MarkdownView);if(!i){console.error("[MissedTradeNote] No active markdown view found");return}let a=i.containerEl.closest(".workspace-leaf-content");if(!a){console.error("[MissedTradeNote] Cannot find containing leaf for active view");return}let o=this.findContainingLeaf(a),s=(p=o==null?void 0:o.view)==null?void 0:p.containerEl,l=(s==null?void 0:s.id)||null,c=l?`leaf-${l}`:this.generateViewId(a),d=i.getMode()==="source",u=this.getComponentClassName();if(d){let m=i.containerEl.querySelector(".metadata-container");if(m){let g=Array.from(a.querySelectorAll(`.${u}`)).find(f=>{let v=f.getAttribute("data-file-path")===r.path,h=f.getAttribute("data-view-id")===c,y=!l||f.getAttribute("data-leaf-id")===l;return v&&h&&y});g||(g=document.createElement("div"),g.className=u,g.classList.add("journalit-component-container"),g.setAttribute("data-file-path",r.path),g.setAttribute("data-view-id",c),l&&g.setAttribute("data-leaf-id",l),m.after(g)),this.renderer.renderComponent(g,n,r.path,c),this.markFileRenderedInMode(r.path,"source")}}else{let m=i.containerEl.querySelector(".markdown-preview-view");if(m){let g=Array.from(m.querySelectorAll(`.${u}`)).find(f=>{let v=f.getAttribute("data-file-path")===r.path,h=f.getAttribute("data-view-id")===c,y=!l||f.getAttribute("data-leaf-id")===l;return v&&h&&y});g||(g=document.createElement("div"),g.className=u,g.classList.add("journalit-component-container"),g.setAttribute("data-file-path",r.path),g.setAttribute("data-view-id",c),l&&g.setAttribute("data-leaf-id",l),m.prepend(g)),this.renderer.renderComponent(g,n,r.path,c),this.markFileRenderedInMode(r.path,"preview")}}}}});var dk,zq,ag,lO=F(()=>{dk=[{id:"recentItems",name:"Recent Items",description:"Shows recently opened files and views",category:"overview",minSize:{w:3,h:4},defaultSize:{w:4,h:5}},{id:"yearHeatmap",name:"Trading Heatmap",description:"Calendar showing your trading activity for the year",category:"overview",minSize:{w:6,h:4},defaultSize:{w:8,h:5}},{id:"weeklySummary",name:"Weekly Summary",description:"Current week metrics with daily P&L sparkline chart",category:"overview",minSize:{w:5,h:5},defaultSize:{w:6,h:7}},{id:"positionSize",name:"Position Size Calculator",description:"Calculate position size based on account risk percentage",category:"tools",minSize:{w:4,h:5},defaultSize:{w:5,h:6}},{id:"embeddedNote",name:"Embedded Note",description:"Display any markdown note from your vault",category:"custom",minSize:{w:3,h:4},defaultSize:{w:6,h:6},configurable:!0},{id:"currentStreak",name:"Current Streak",description:"Track your winning and losing streaks",category:"overview",minSize:{w:3,h:4},defaultSize:{w:4,h:5}},{id:"bestHours",name:"Best Hours",description:"See when you trade best by time of day",category:"overview",minSize:{w:4,h:5},defaultSize:{w:5,h:6}},{id:"setupLeaderboard",name:"Top Setups",description:"See which setups perform best for you",category:"overview",minSize:{w:4,h:5},defaultSize:{w:5,h:6}},{id:"unreviewedTrades",name:"Unreviewed Trades",description:"Trades that need your review",category:"overview",minSize:{w:3,h:2},defaultSize:{w:4,h:2}},{id:"goalsProgress",name:"Goal Progress",description:"Track progress toward your trading goal",category:"overview",minSize:{w:4,h:4},defaultSize:{w:5,h:5},configurable:!0},{id:"tradingScore",name:"Trading Score",description:"Comprehensive performance score with radar chart visualization",category:"overview",minSize:{w:4,h:5},defaultSize:{w:5,h:6}},{id:"aum",name:"AUM",description:"Total assets under management with 7-day trend sparkline",category:"overview",minSize:{w:3,h:2},defaultSize:{w:4,h:2}},{id:"drawdownMonitor",name:"Drawdown Monitor",description:"Track drawdown status across accounts with limits configured",category:"overview",minSize:{w:3,h:3},defaultSize:{w:4,h:4}}],zq=["recentItems","yearHeatmap"],ag=e=>{let t=dk.find(n=>n.id===e);if(t)return t;let r=e.indexOf("-");if(r>0){let n=e.substring(0,r),i=dk.find(a=>a.id===n);if(i!=null&&i.configurable)return i}}});function jq(e){return e.map(t=>({...t,i:t.i||"unknown",x:typeof t.x=="number"&&isFinite(t.x)?t.x:0,y:typeof t.y=="number"&&isFinite(t.y)?t.y===1/0||t.y===1e7||t.y===1e4?yo:t.y:t.y===1/0?yo:0,w:typeof t.w=="number"&&isFinite(t.w)&&t.w>0?t.w:1,h:typeof t.h=="number"&&isFinite(t.h)&&t.h>0?t.h:1}))}function _q(e){return!e||typeof e!="object"?null:{i:typeof e.i=="string"?e.i:"unknown",x:typeof e.x=="number"&&isFinite(e.x)?e.x:0,y:typeof e.y=="number"&&isFinite(e.y)?e.y===1/0?yo:e.y:0,w:typeof e.w=="number"&&isFinite(e.w)&&e.w>0?e.w:1,h:typeof e.h=="number"&&isFinite(e.h)&&e.h>0?e.h:1}}var yo,Rbe,Ube,IP=F(()=>{yo=9999,Rbe={lg:12,md:6,sm:4,xs:2,xxs:1},Ube=50});function Sm(e){return jq(e)}function km(e){return jq(e)}function GGe(e){let t={};return Object.entries(e.layouts).forEach(([r,n])=>{t[r]={lg:Sm(n.lg||[]),md:Sm(n.md||[]),sm:Sm(n.sm||[]),xs:Sm(n.xs||[]),xxs:Sm(n.xxs||[])}}),{layouts:t,activeLayout:e.activeLayout}}var Bq,cO,Hbe,qbe,Vbe,Wq,$q,YGe,Rq=F(()=>{IP();Tr();IP();Bq=null,cO={lg:[{i:"recentItems",x:0,y:0,w:4,h:5},{i:"yearHeatmap",x:4,y:0,w:8,h:5}],md:[{i:"recentItems",x:0,y:0,w:6,h:5},{i:"yearHeatmap",x:0,y:5,w:6,h:5}],sm:[{i:"recentItems",x:0,y:0,w:4,h:5},{i:"yearHeatmap",x:0,y:5,w:4,h:5}],xs:[{i:"recentItems",x:0,y:0,w:2,h:5},{i:"yearHeatmap",x:0,y:5,w:2,h:5}],xxs:[{i:"recentItems",x:0,y:0,w:1,h:5},{i:"yearHeatmap",x:0,y:5,w:1,h:5}]},Hbe={layouts:{Default:cO},activeLayout:"Default"};qbe=e=>{if(!e.settings.home)return Hbe;let t=e.settings.home,r=t.layouts||{},n={};return Object.entries(r).forEach(([i,a])=>{var l,c;if(!a){n[i]=JSON.parse(JSON.stringify(cO));return}let o=a.xs||((l=a.sm)==null?void 0:l.map(d=>({...d,w:Math.min(d.w,2)})))||[],s=a.xxs||((c=a.sm)==null?void 0:c.map(d=>({...d,w:1})))||[];n[i]={lg:a.lg||[],md:a.md||[],sm:a.sm||[],xs:o,xxs:s}}),{layouts:n,activeLayout:t.activeLayout||Hbe.activeLayout}},Vbe=async(e,t)=>{try{if(!e.app.workspace.layoutReady){e.app.workspace.onLayoutReady(()=>{Vbe(e,t)});return}e.settings.home||(e.settings.home={layouts:{},activeLayout:"Default",recentItems:[]});let r=GGe(t);e.settings.home.layouts=r.layouts,e.settings.home.activeLayout=r.activeLayout,await e.saveSettings(),xe.publish("layout:changed",{view:"home",layoutName:t.activeLayout})}catch(r){throw console.error("Error saving home layout settings:",r),r}},Wq=e=>{try{let t=qbe(e),r=t.activeLayout,n=t.layouts[r];if(!n)return console.warn(`Active home layout '${r}' not found, using default layout`),cO;if(!n.lg||!n.md||!n.sm||!n.xs||!n.xxs){console.warn(`Active home layout '${r}' is missing breakpoint layouts, fixing...`);let a={lg:km(n.lg||[]),md:km(n.md||[]),sm:km(n.sm||[]),xs:km(n.xs||[]),xxs:km(n.xxs||[])};return(async()=>{try{await $q(e,r,a)}catch(o){console.error(`Failed to save fixed home layout: ${o}`)}})(),a}return{lg:km(n.lg||[]),md:km(n.md||[]),sm:km(n.sm||[]),xs:km(n.xs||[]),xxs:km(n.xxs||[])}}catch(t){return console.error("Error retrieving active home layout:",t),cO}},$q=async(e,t,r)=>new Promise((n,i)=>{Bq&&clearTimeout(Bq),Bq=setTimeout(async()=>{try{await YGe(e,t,r),n()}catch(a){i(a)}},300)}),YGe=async(e,t,r)=>{try{let n={lg:Sm(r.lg||[]),md:Sm(r.md||[]),sm:Sm(r.sm||[]),xs:Sm(r.xs||[]),xxs:Sm(r.xxs||[])},i=new Set;Object.values(n).forEach(s=>{s.forEach(l=>i.add(l.i))});let a={lg:12,md:6,sm:4,xs:2,xxs:1};Object.entries(n).forEach(([s,l])=>{let c=new Set(l.map(d=>d.i));i.forEach(d=>{var u;if(!c.has(d)){let p;for(let m of["lg","md","sm","xs","xxs"]){let g=(u=n[m])==null?void 0:u.find(f=>f.i===d);if(g){p=g;break}}p&&l.push({i:d,x:0,y:yo,w:Math.min(p.w,a[s]),h:p.h})}})});let o=qbe(e);o.layouts[t]=n,await Vbe(e,o)}catch(n){throw console.error(`Error saving home layout '${t}':`,n),n}}});function KGe(e){let t=new Date;switch(e){case"month":{let r=new Date(t.getFullYear(),t.getMonth(),1),n=ii(r,!0),i=ii(t,!1);return[n,i]}case"quarter":{let n=(Ap(t)-1)*3,i=new Date(t.getFullYear(),n,1),a=ii(i,!0),o=ii(t,!1);return[a,o]}case"year":{let r=new Date(t.getFullYear(),0,1),n=ii(r,!0),i=ii(t,!1);return[n,i]}default:return[null,null]}}function uk(e){let t=MP(),r=t==null?void 0:t.period,n=t==null?void 0:t.isDateInPeriod;return(0,dp.useMemo)(()=>!e||e.length===0?[]:!n||r==="lifetime"?e:e.filter(i=>{let a=i.entryTime instanceof Date?i.entryTime:new Date(i.entryTime);return isNaN(a.getTime())?!1:n(a)}),[e,r,n])}var dp,Gbe,Ybe,MP,pk=F(()=>{dp=Y(Q());_t();Gbe=(0,dp.createContext)(null);Ybe=({period:e,children:t})=>{let r=(0,dp.useMemo)(()=>KGe(e),[e]),n=(0,dp.useMemo)(()=>a=>{let[o,s]=r;if(!o&&!s)return!0;let l=a.getTime();return!(o&&l<o.getTime()||s&&l>s.getTime())},[r]),i=(0,dp.useMemo)(()=>({period:e,dateRange:r,isDateInPeriod:n}),[e,r,n]);return dp.default.createElement(Gbe.Provider,{value:i},t)},MP=()=>(0,dp.useContext)(Gbe)});var wa,Kbe,Jbe=F(()=>{wa=Y(Q());Ot();AP();_t();Zs();Kbe=(0,wa.memo)(({plugin:e})=>{let[t,r]=(0,wa.useState)(e.uiStateManager.getState().recentItems||[]),[n,i]=(0,wa.useState)("!Journalit"),a=(0,wa.useCallback)(()=>{r(e.uiStateManager.getState().recentItems||[])},[e]);Xe("recent-items:changed",a),(0,wa.useEffect)(()=>{(async()=>{var u;if((u=e.serviceManager)!=null&&u.getFolderPathService)try{let p=await e.serviceManager.getFolderPathService();i(p.journalFolderPath)}catch(p){console.error("Failed to get journal folder path:",p)}})()},[e.serviceManager]);let o=t.filter(d=>{var u,p;if(d.type==="view"&&d.viewType===es)return!1;if((u=e.settings.home)!=null&&u.filterRecentItemsToJournalit&&d.type==="file"){let m=(p=e.serviceManager)==null?void 0:p.getFolderPathService();return!m||!d.path?!1:m.isJournalPath(d.path)}return!0}).slice(0,5),s=d=>{if(d.type==="file"&&d.title){let u=d.title.toLowerCase();if(u.includes("drc")||u.includes("daily report card"))return Jm;if(u.includes("weekly review")||u.includes("week review")||/w\d+-review/.test(u))return zv;if(u.includes("monthly review")||u.includes("month review")||/^\d+-review/.test(u))return jv}if(d.type==="file")return $v;switch(d.viewType){case"journalit-dashboard-view":return Uv;case"account-dashboard":return af;case"journalit-account-page-view":return ST;case"journalit-trade-log-view":return Rv;case"journalit-csv-import-view":return Hv;default:return sT}},l=async d=>{try{if(d.type==="file"&&d.path)await e.openFile(d.path,!0);else if(d.type==="view"&&d.viewType)switch(d.viewType){case"journalit-dashboard-view":await e.viewManager.openDashboardView();break;case"account-dashboard":await e.viewManager.openAccountDashboardView();break;case"journalit-trade-log-view":await e.viewManager.openTradeLogView();break;case"journalit-csv-import-view":await e.viewManager.openCSVImportView();break;case"journalit-account-page-view":let u=d.title.replace(/^Account:\s*/,"");await e.viewManager.openAccountPageView(u);break;default:console.warn("Unknown view type:",d.viewType)}}catch(u){console.error("Failed to open recent item:",u)}},c=d=>{let u=dn(d);if(!u)return"Unknown";let p=new Date,m=Zi(u),g=Zi(p);if(!m||!g)return"Unknown";let f=g-m,v=Math.floor(f/6e4),h=Math.floor(v/60),y=Math.floor(h/24);return v<1?"Just now":v<60?`${v}m ago`:h<24?`${h}h ago`:y<7?`${y}d ago`:u.toLocaleDateString()};return wa.default.createElement("div",{className:"journalit-recent-items-widget",style:{height:"100%",display:"flex",flexDirection:"column",padding:"12px"}},wa.default.createElement("div",{style:{fontSize:"11px",fontWeight:500,color:"var(--text-faint)",textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"12px"}},"Recent"),wa.default.createElement("div",{style:{flex:1,overflow:"auto"}},o.length===0?wa.default.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",color:"var(--text-muted)",textAlign:"center"}},wa.default.createElement(Cd,{size:32,style:{marginBottom:"8px",opacity:.5,color:"var(--text-muted)"}}),wa.default.createElement("div",{style:{fontSize:"14px"}},"No recent items yet"),wa.default.createElement("div",{style:{fontSize:"12px",marginTop:"4px"}},"Open files or views to see them here")):wa.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"6px"}},o.map((d,u)=>{let p=s(d);return wa.default.createElement("div",{key:`${d.type}-${d.path||d.viewType}-${u}`,className:"jl-recent-item-hover",onClick:()=>l(d),style:{display:"flex",alignItems:"center",padding:"8px",borderRadius:"4px",cursor:"pointer",transition:"all 0.2s ease"}},wa.default.createElement("div",{style:{width:"16px",height:"16px",marginRight:"8px",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--text-muted)"}},wa.default.createElement(p,{size:14})),wa.default.createElement("div",{style:{flex:1,minWidth:0}},wa.default.createElement("div",{style:{fontSize:"13px",fontWeight:400,color:"var(--text-normal)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},d.title),wa.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-muted)",marginTop:"2px"}},c(d.openedAt))))}))))})});var gn,Qbe,JGe,Xbe,Zbe=F(()=>{gn=Y(Q());Ot();YH();fc();us();ps();Qbe=e=>{let t=e-64,n=Math.floor(t/14);if(!(n>=52))return n>=26?26:n>=13?13:Math.max(8,n)},JGe=({plugin:e})=>{let t=(0,gn.useRef)(null),[r,n]=(0,gn.useState)(void 0),[i,a]=(0,gn.useState)(!1),o=new Date().getFullYear(),[s,l]=(0,gn.useState)(o),{dashboardData:c}=ua(),d=(0,gn.useMemo)(()=>{if(!(c!=null&&c.trades)||c.trades.length===0)return[o];let v=new Set;for(let h of c.trades)if(h.entryTime){let y=new Date(h.entryTime).getFullYear();v.add(y)}return v.add(o),Array.from(v).sort((h,y)=>y-h)},[c==null?void 0:c.trades,o]);(0,gn.useEffect)(()=>{let v=t.current;if(!v)return;let h=null,y=new ResizeObserver(k=>{for(let x of k){let S=x.contentRect.width,w=Qbe(S);h&&clearTimeout(h),h=setTimeout(()=>{n(w)},100)}});y.observe(v);let b=v.getBoundingClientRect().width;return n(Qbe(b)),()=>{h&&clearTimeout(h),y.disconnect()}},[]);let u=async v=>{try{await(await e.serviceManager.getDRCService()).openDRC(v)}catch(h){console.error("Failed to open DRC for date:",h)}},p=()=>{let v=s===o;return r?r<=13&&v?"Last 3 Months":r<=26&&v?"Last 6 Months":`${s} Activity`:`${s} Activity`},m=v=>{l(v),a(!1)},g=()=>r?r<=13?"90px":r<=26?"95px":"100px":"100px",f=r||52;return c?i?gn.default.createElement("div",{ref:t,className:"journalit-year-heatmap-widget",style:{height:"100%",display:"flex",flexDirection:"column",padding:"12px"}},gn.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"}},gn.default.createElement("span",{style:{fontSize:"11px",fontWeight:500,color:"var(--text-faint)",textTransform:"uppercase",letterSpacing:"0.5px"}},"Select Year"),gn.default.createElement("button",{onClick:()=>a(!1),style:{background:"none",border:"none",padding:"4px",cursor:"pointer",color:"var(--text-muted)",display:"flex",alignItems:"center",justifyContent:"center"},"aria-label":"Close year selector"},gn.default.createElement(La,{size:14}))),gn.default.createElement("div",{style:{flex:1,minHeight:0,overflowY:"auto",display:"flex",flexDirection:"column",justifyContent:"center"}},gn.default.createElement("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px",justifyContent:"center",padding:"4px 0"}},d.map(v=>gn.default.createElement("button",{key:v,onClick:()=>m(v),style:{padding:"8px 16px",borderRadius:"6px",border:"none",cursor:"pointer",fontSize:"14px",fontWeight:500,transition:"all 0.15s ease",background:v===s?"var(--interactive-accent)":"var(--background-modifier-hover)",color:v===s?"var(--text-on-accent)":"var(--text-normal)"}},v))))):gn.default.createElement("div",{ref:t,className:"journalit-year-heatmap-widget",style:{height:"100%",display:"flex",flexDirection:"column",padding:"12px",cursor:"pointer"},onClick:()=>a(!0),role:"button",tabIndex:0,onKeyDown:v=>{(v.key==="Enter"||v.key===" ")&&(v.preventDefault(),a(!0))}},gn.default.createElement("div",{style:{fontSize:"11px",fontWeight:500,color:"var(--text-faint)",textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between"}},gn.default.createElement("span",null,p()),gn.default.createElement(Nu,{size:12,style:{color:"var(--text-faint)"}})),gn.default.createElement("div",{style:{flex:1,minHeight:0},onClick:v=>v.stopPropagation()},gn.default.createElement(GH,{trades:(c==null?void 0:c.trades)||[],year:s,onDayClick:u,height:"100%",maxWeeks:r,rollingMode:r!==void 0&&s===o}))):gn.default.createElement("div",{ref:t,style:{height:"100%",display:"flex",flexDirection:"column",padding:"12px"}},gn.default.createElement("div",{style:{marginBottom:"12px"}},gn.default.createElement(Qe,{width:g(),height:"11px"})),gn.default.createElement("div",{style:{flex:1,minHeight:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"}},gn.default.createElement("div",{style:{display:"flex",alignItems:"flex-start",gap:"10px"}},gn.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"3px",paddingTop:"1px"}},[0,1,2,3,4,5,6].map(v=>gn.default.createElement(ae,{key:v,width:20,height:11,borderRadius:"2px"}))),gn.default.createElement("div",{style:{display:"flex",gap:"3px"}},Array.from({length:f}).map((v,h)=>gn.default.createElement("div",{key:h,style:{display:"flex",flexDirection:"column",gap:"3px"}},Array.from({length:7}).map((y,b)=>gn.default.createElement(ae,{key:b,width:11,height:11,borderRadius:"2px"}))))))))},Xbe=gn.default.memo(JGe)});function dO(e){if(e instanceof Date)return e;let t=e.match(/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})/);return t?new Date(parseInt(t[1]),parseInt(t[2])-1,parseInt(t[3]),parseInt(t[4]),parseInt(t[5]),parseInt(t[6])):new Date(e)}function Uq(e){let t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${n}`}var Nr,QGe,exe,txe=F(()=>{Nr=Y(Q());fc();Er();qt();_t();Oa();us();ps();ff();QGe=({plugin:e})=>{var y,b,k,x,S;let t=ua(),{currency:r}=ct(),[n,i]=(0,Nr.useState)(null),a=(0,Nr.useCallback)(async()=>{try{await(await e.serviceManager.getWeeklyReviewService()).openWeeklyReview(new Date)}catch(w){console.error("Failed to open weekly review:",w)}},[e]),o=(b=(y=e.settings.trade)==null?void 0:y.skipWeekends)!=null?b:!0,s=(x=(k=e.settings.trade)==null?void 0:k.displayRMultiples)!=null?x:!1,l=(S=e.settings.trade)==null?void 0:S.defaultRiskAmount,c=(0,Nr.useMemo)(()=>{var w,C;if(!((w=t==null?void 0:t.dashboardData)!=null&&w.trades))return null;try{let D=t.dashboardData.trades,M=Zt(new Date,e),z=ea(M),A=new Date(z);A.setDate(A.getDate()+6),A.setHours(23,59,59,999);let I=new Date(z);I.setDate(I.getDate()-7);let L=new Date(I);L.setDate(L.getDate()+6),L.setHours(23,59,59,999);let E=D.filter(ee=>{let ie=dO(ee.entryTime),ve=Zt(ie,e);return ve>=z&&ve<=A}),T=D.filter(ee=>{let ie=dO(ee.entryTime),ve=Zt(ie,e);return ve>=I&&ve<=L}),$=E.reduce((ee,ie)=>ee+(ie.pnl||0),0),_=E.filter(ee=>(ee.pnl||0)>0).length,B=E.length>0?_/E.length*100:0,W=E.length,N=E.filter(ee=>(ee.pnl||0)>0).reduce((ee,ie)=>ee+(ie.pnl||0),0),U=Math.abs(E.filter(ee=>(ee.pnl||0)<0).reduce((ee,ie)=>ee+(ie.pnl||0),0)),j=U===0?N>0?1/0:0:N/U,R;if(s){let ee=[];for(let ie of E){let ve=xt(ie.pnl,ie.rMultiple,ie.riskAmount,l);ve!==void 0&&ee.push(ve)}ee.length>0&&(R=ee.reduce((ie,ve)=>ie+ve,0))}let O=T.reduce((ee,ie)=>ee+(ie.pnl||0),0),H=new Date(z);H.setDate(H.getDate()-56);let q=D.filter(ee=>{let ie=dO(ee.entryTime),ve=Zt(ie,e);return ve>=H&&ve<z}),V=q.reduce((ee,ie)=>ee+(ie.pnl||0),0),J=q.length>0?V/8:0,K=o?["Mon","Tue","Wed","Thu","Fri"]:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],G=o?["M","T","W","T","F"]:["M","T","W","T","F","S","S"],X=o?5:7,te=[],re=0,Z=0,ne=Uq(M);for(let ee=0;ee<X;ee++){let ie=new Date(z);ie.setDate(ie.getDate()+ee),ie.setHours(12,0,0,0);let ve=Zt(ie,e),Se=Uq(ve),Me=Se>ne,le=E.filter(We=>{let Ke=dO(We.entryTime),Ze=Zt(Ke,e);return Uq(Ze)===Se}),Ye=le.reduce((We,Ke)=>We+(Ke.pnl||0),0),ue;if(l&&l>0){let We=[];for(let Ke of le){let Ze=(C=Ke.rMultiple)!=null?C:Ke.pnl!==void 0?Ke.pnl/l:void 0;Ze!==void 0&&We.push(Ze)}We.length>0&&(ue=We.reduce((Ke,Ze)=>Ke+Ze,0))}!Me&&le.length>0&&(Ye>0?re++:Ye<0&&Z++),te.push({day:K[ee],dayShort:G[ee],pnl:Ye,rMultiple:ue,tradeCount:le.length,isFuture:Me})}let se="";if(W===0)se="no trades yet this week";else if(Z>=3&&re===0)se=`${Z} losing days in a row`;else if(re>=3&&Z===0)se=`${re} winning days straight`;else if(J!==0&&$>J*1.5)se="above your weekly average";else if(J!==0&&$<J*.5&&$>0)se="below your weekly average";else if(O!==0){let ee=($-O)/Math.abs(O)*100;ee>50?se="better than last week":ee<-50?se="slower than last week":$>=0?se="on track this week":se="room to recover"}else $>=0?se="solid start to the week":se="early in the week";return{current:{netPnL:$,netRMultiple:R,winRate:B,totalTrades:W,profitFactor:j,winningDays:re,losingDays:Z},previous:{netPnL:O},historicalAvg:J,dailyData:te,hasCurrentTrades:W>0,hasPreviousTrades:T.length>0,contextMessage:se}}catch(D){return console.error("Error calculating weekly metrics:",D),null}},[t,o,s,l,e]),d=(0,Nr.useMemo)(()=>c!=null&&c.dailyData?Math.max(...c.dailyData.map(w=>Math.abs(w.pnl)),1):0,[c]);if((0,Nr.useLayoutEffect)(()=>{tl()},[]),!(t!=null&&t.dashboardData))return Nr.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",padding:"12px",gap:"8px"}},Nr.default.createElement(Qe,{width:"70px",height:"11px"}),Nr.default.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flex:1,minHeight:0,gap:"8px"}},Nr.default.createElement(ae,{width:"120px",height:"32px",borderRadius:"4px"}),Nr.default.createElement(Qe,{width:"100px",height:"12px"})),Nr.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",height:"48px",gap:"4px",padding:"0 4px"}},[24,32,18,28,14].map((w,C)=>Nr.default.createElement("div",{key:C,style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",flex:1}},Nr.default.createElement(ae,{width:"100%",height:`${w}px`,style:{maxWidth:"24px"},borderRadius:"2px"}),Nr.default.createElement(Qe,{width:"10px",height:"10px"})))));if(!c)return Nr.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"8px"}},Nr.default.createElement("span",{style:{fontSize:"11px",fontWeight:500,color:"var(--text-faint)",textTransform:"uppercase",letterSpacing:"0.5px"}},"This Week"),Nr.default.createElement("span",{style:{fontSize:"13px",color:"var(--text-muted)"}},"No trade data"));let{current:u,dailyData:p,contextMessage:m,hasCurrentTrades:g}=c,v=(s&&u.netRMultiple!==void 0?u.netRMultiple:u.netPnL)>=0?"var(--color-green)":"var(--color-red)",h=s&&u.netRMultiple!==void 0?`${u.netRMultiple>=0?"+":""}${u.netRMultiple.toFixed(1)}R`:ye(u.netPnL,!0,r);return Nr.default.createElement("div",{onClick:a,className:"journalit-weekly-widget",style:{height:"100%",display:"flex",flexDirection:"column",padding:"12px",gap:"8px",cursor:"pointer"}},Nr.default.createElement("div",{className:"journalit-weekly-label",style:{fontSize:"11px",fontWeight:500,color:"var(--text-faint)",textTransform:"uppercase",letterSpacing:"0.5px"}},"This Week"),Nr.default.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flex:1,minHeight:0,gap:"2px"}},Nr.default.createElement("div",{style:{fontSize:"32px",fontWeight:600,color:v,lineHeight:1.1}},g?h:s?"0.0R":"$0.00"),Nr.default.createElement("div",{style:{fontSize:"12px",color:"var(--text-muted)"}},m)),Nr.default.createElement("div",{style:{position:"relative",display:"flex",justifyContent:"space-between",alignItems:"flex-end",height:"48px",gap:"4px",padding:"0 4px"}},n!==null&&!p[n].isFuture&&(()=>{let w=p[n],C=s&&w.rMultiple!==void 0,D=C?w.rMultiple:w.pnl,P=C?`${D>=0?"+":""}${D.toFixed(1)}R`:ye(w.pnl,!0,r);return Nr.default.createElement("div",{style:{position:"absolute",top:"-36px",left:"50%",transform:"translateX(-50%)",backgroundColor:"var(--background-primary)",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",padding:"4px 8px",fontSize:"11px",color:"var(--text-normal)",whiteSpace:"nowrap",zIndex:10,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.15)",pointerEvents:"none"}},Nr.default.createElement("span",{style:{fontWeight:500}},w.day),w.tradeCount>0?Nr.default.createElement(Nr.default.Fragment,null,Nr.default.createElement("span",{style:{color:"var(--text-muted)",margin:"0 4px"}},"\xB7"),Nr.default.createElement("span",{style:{color:D>=0?"var(--color-green)":"var(--color-red)",fontWeight:500}},P),Nr.default.createElement("span",{style:{color:"var(--text-muted)",margin:"0 4px"}},"\xB7"),Nr.default.createElement("span",{style:{color:"var(--text-muted)"}},w.tradeCount," trade",w.tradeCount!==1?"s":"")):Nr.default.createElement("span",{style:{color:"var(--text-muted)",marginLeft:"4px"}},"no trades"))})(),p.map((w,C)=>{let D=w.isFuture||w.tradeCount===0?4:Math.max(8,Math.abs(w.pnl)/d*40),P=w.isFuture||w.tradeCount===0?"var(--background-modifier-border)":w.pnl>=0?"var(--color-green)":"var(--color-red)",M=w.isFuture?.3:w.tradeCount===0?.5:1;return Nr.default.createElement("div",{key:C,style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",flex:1,cursor:w.isFuture?"default":"pointer"},onMouseEnter:()=>!w.isFuture&&i(C),onMouseLeave:()=>i(null)},Nr.default.createElement("div",{style:{width:"100%",maxWidth:"24px",height:`${D}px`,backgroundColor:P,borderRadius:"2px",opacity:n===C?1:M,transition:"all 0.15s ease",transform:n===C?"scaleY(1.1)":"scaleY(1)",transformOrigin:"bottom"}}),Nr.default.createElement("span",{style:{fontSize:"10px",color:n===C?"var(--text-normal)":w.isFuture?"var(--text-faint)":"var(--text-muted)",opacity:w.isFuture?.5:1,transition:"color 0.15s ease"}},w.dayShort))})))},exe=(0,Nr.memo)(QGe)});var og,sg,uO=F(()=>{og={ES:{dollarPerPoint:50,tickSize:.25,tickValue:12.5,name:"E-Mini S&P 500",exchange:"CME"},MES:{dollarPerPoint:5,tickSize:.25,tickValue:1.25,name:"Micro E-Mini S&P 500",exchange:"CME"},NQ:{dollarPerPoint:20,tickSize:.25,tickValue:5,name:"E-Mini NASDAQ-100",exchange:"CME"},MNQ:{dollarPerPoint:2,tickSize:.25,tickValue:.5,name:"Micro E-Mini NASDAQ-100",exchange:"CME"},YM:{dollarPerPoint:5,tickSize:1,tickValue:5,name:"E-Mini Dow",exchange:"CBOT"},MYM:{dollarPerPoint:.5,tickSize:1,tickValue:.5,name:"Micro E-Mini Dow",exchange:"CBOT"},RTY:{dollarPerPoint:50,tickSize:.1,tickValue:5,name:"E-Mini Russell 2000",exchange:"CME"},M2K:{dollarPerPoint:5,tickSize:.1,tickValue:.5,name:"Micro E-Mini Russell 2000",exchange:"CME"},CL:{dollarPerPoint:1e3,tickSize:.01,tickValue:10,name:"Crude Oil",exchange:"NYMEX"},MCL:{dollarPerPoint:100,tickSize:.01,tickValue:1,name:"Micro Crude Oil",exchange:"NYMEX"},NG:{dollarPerPoint:1e4,tickSize:.001,tickValue:10,name:"Natural Gas",exchange:"NYMEX"},RB:{dollarPerPoint:42e3,tickSize:1e-4,tickValue:4.2,name:"RBOB Gasoline",exchange:"NYMEX"},HO:{dollarPerPoint:42e3,tickSize:1e-4,tickValue:4.2,name:"Heating Oil",exchange:"NYMEX"},GC:{dollarPerPoint:100,tickSize:.1,tickValue:10,name:"Gold",exchange:"COMEX"},MGC:{dollarPerPoint:10,tickSize:.1,tickValue:1,name:"Micro Gold",exchange:"COMEX"},SI:{dollarPerPoint:5e3,tickSize:.005,tickValue:25,name:"Silver",exchange:"COMEX"},HG:{dollarPerPoint:25e3,tickSize:5e-4,tickValue:12.5,name:"Copper",exchange:"COMEX"},PL:{dollarPerPoint:50,tickSize:.1,tickValue:5,name:"Platinum",exchange:"NYMEX"},ZC:{dollarPerPoint:50,tickSize:.25,tickValue:12.5,name:"Corn",exchange:"CBOT"},ZS:{dollarPerPoint:50,tickSize:.25,tickValue:12.5,name:"Soybeans",exchange:"CBOT"},ZW:{dollarPerPoint:50,tickSize:.25,tickValue:12.5,name:"Wheat",exchange:"CBOT"},"6E":{dollarPerPoint:12.5,tickSize:5e-5,tickValue:6.25,name:"Euro FX",exchange:"CME"},M6E:{dollarPerPoint:1.25,tickSize:5e-5,tickValue:.625,name:"Micro Euro FX",exchange:"CME"},"6B":{dollarPerPoint:6.25,tickSize:1e-4,tickValue:6.25,name:"British Pound",exchange:"CME"},M6B:{dollarPerPoint:.625,tickSize:1e-4,tickValue:.625,name:"Micro British Pound",exchange:"CME"},"6J":{dollarPerPoint:12.5,tickSize:5e-7,tickValue:6.25,name:"Japanese Yen",exchange:"CME"},M6J:{dollarPerPoint:1.25,tickSize:5e-7,tickValue:.625,name:"Micro Japanese Yen",exchange:"CME"},"6A":{dollarPerPoint:10,tickSize:1e-4,tickValue:10,name:"Australian Dollar",exchange:"CME"},M6A:{dollarPerPoint:1,tickSize:1e-4,tickValue:1,name:"Micro Australian Dollar",exchange:"CME"},"6C":{dollarPerPoint:10,tickSize:5e-5,tickValue:5,name:"Canadian Dollar",exchange:"CME"},M6C:{dollarPerPoint:1,tickSize:5e-5,tickValue:.5,name:"Micro Canadian Dollar",exchange:"CME"},"6S":{dollarPerPoint:12.5,tickSize:1e-4,tickValue:12.5,name:"Swiss Franc",exchange:"CME"},M6S:{dollarPerPoint:1.25,tickSize:1e-4,tickValue:1.25,name:"Micro Swiss Franc",exchange:"CME"},ZN:{dollarPerPoint:1e3,tickSize:.015625,tickValue:15.625,name:"10-Year T-Note",exchange:"CBOT"},ZB:{dollarPerPoint:1e3,tickSize:.03125,tickValue:31.25,name:"30-Year T-Bond",exchange:"CBOT"},ZF:{dollarPerPoint:1e3,tickSize:.0078125,tickValue:7.8125,name:"5-Year T-Note",exchange:"CBOT"}},sg={EURUSD:{lotSize:1e5,pipValue:10,pipSize:1e-4,name:"Euro / US Dollar"},GBPUSD:{lotSize:1e5,pipValue:10,pipSize:1e-4,name:"British Pound / US Dollar"},USDJPY:{lotSize:1e5,pipValue:9.09,pipSize:.01,name:"US Dollar / Japanese Yen"},USDCHF:{lotSize:1e5,pipValue:11,pipSize:1e-4,name:"US Dollar / Swiss Franc"},AUDUSD:{lotSize:1e5,pipValue:10,pipSize:1e-4,name:"Australian Dollar / US Dollar"},USDCAD:{lotSize:1e5,pipValue:7.5,pipSize:1e-4,name:"US Dollar / Canadian Dollar"},NZDUSD:{lotSize:1e5,pipValue:10,pipSize:1e-4,name:"New Zealand Dollar / US Dollar"},EURGBP:{lotSize:1e5,pipValue:13,pipSize:1e-4,name:"Euro / British Pound"},EURJPY:{lotSize:1e5,pipValue:9.09,pipSize:.01,name:"Euro / Japanese Yen"},GBPJPY:{lotSize:1e5,pipValue:9.09,pipSize:.01,name:"British Pound / Japanese Yen"},XAUUSD:{lotSize:100,pipValue:10,pipSize:.01,name:"Gold / US Dollar"}}});var Oe,XGe,ZGe,eYe,tYe,rxe,nxe=F(()=>{Oe=Y(Q());Ot();Er();qt();uO();qT();XGe=[{id:"stock",label:"Stock/Crypto"},{id:"futures",label:"Futures"},{id:"forex",label:"Forex"}],ZGe=Object.entries(og).map(([e,t])=>({symbol:e,name:t.name})).sort((e,t)=>e.symbol.localeCompare(t.symbol)),eYe=Object.entries(sg).map(([e,t])=>({symbol:e,name:t.name})).sort((e,t)=>e.symbol.localeCompare(t.symbol)),tYe=({plugin:e})=>{var J,K,G,X,te,re,Z;let{currency:t}=ct(),r=(J=e.settings.home)==null?void 0:J.positionSizeDefaults,[n,i]=(0,Oe.useState)((r==null?void 0:r.assetType)||"stock"),[a,o]=(0,Oe.useState)((r==null?void 0:r.accountBalance)||1e4),[s,l]=(0,Oe.useState)((r==null?void 0:r.riskPercentage)||1),[c,d]=(0,Oe.useState)((r==null?void 0:r.lastFuturesSymbol)||"ES"),[u,p]=(0,Oe.useState)((r==null?void 0:r.lastForexSymbol)||"EURUSD"),m=(X=(G=(K=e.settings)==null?void 0:K.trade)==null?void 0:G.useDollarValueInput)!=null?X:!1,[g,f]=(0,Oe.useState)(""),[v,h]=(0,Oe.useState)(""),[y,b]=(0,Oe.useState)(""),[k,x]=(0,Oe.useState)(""),[S,w]=(0,Oe.useState)(""),[C,D]=(0,Oe.useState)(""),[P,M]=(0,Oe.useState)(""),[z,A]=(0,Oe.useState)(""),[I,L]=(0,Oe.useState)(""),E=(0,Oe.useMemo)(()=>og[c],[c]),T=(0,Oe.useMemo)(()=>sg[u],[u]),$=a*(s/100),_=(0,Oe.useMemo)(()=>{let ne=parseFloat(v)||0;if(m){let Ye=parseFloat(g)||0;if(ne<=0||Ye<=0)return null;let ue=Ye/ne;return{positionSize:parseFloat(ue.toFixed(HT("stock"))),unit:"shares",dollarAmount:Ye,priceDiff:null,isLong:null,riskRewardRatio:null,potentialProfit:null}}let se=parseFloat(y)||0;if(ne<=0||se<=0)return null;let ee=Math.abs(ne-se);if(ee===0)return null;let ie=$/ee,ve=ne>se,Se=parseFloat(k)||0,Me=null,le=null;if(Se>0){let Ye=Math.abs(Se-ne);Me=Ye/ee,le=Ye*ie}return{positionSize:ie,unit:"shares",dollarAmount:null,priceDiff:ee,isLong:ve,riskRewardRatio:Me,potentialProfit:le}},[v,y,k,$,m,g]),B=(0,Oe.useMemo)(()=>{if(!E)return null;let ne=parseFloat(S)||0,se=parseFloat(C)||0;if(ne<=0||se<=0)return null;let ee=Math.abs(ne-se);if(ee===0)return null;let ie=ee*E.dollarPerPoint,ve=$/ie,Se=ne>se,Me=ee/E.tickSize,le=parseFloat(P)||0,Ye=null,ue=null;if(le>0){let We=Math.abs(le-ne);Ye=We/ee,ue=We*E.dollarPerPoint*ve}return{positionSize:ve,unit:"contracts",pointsDiff:ee,ticksDiff:Me,riskPerContract:ie,isLong:Se,riskRewardRatio:Ye,potentialProfit:ue}},[S,C,P,$,E]),W=(0,Oe.useMemo)(()=>{if(!T)return null;let ne=parseFloat(z)||0;if(ne<=0)return null;let se=ne*T.pipValue,ee=$/se,ie=parseFloat(I)||0,ve=null,Se=null;return ie>0&&(ve=ie/ne,Se=ie*T.pipValue*ee),{positionSize:ee,unit:"lots",standardLots:ee,miniLots:ee*10,microLots:ee*100,pips:ne,riskPerLot:se,riskRewardRatio:ve,potentialProfit:Se}},[z,I,$,T]),N=(0,Oe.useCallback)(async()=>{e.settings.home||(e.settings.home={layouts:{},activeLayout:"Default"}),e.settings.home.positionSizeDefaults={riskPercentage:s,accountBalance:a,assetType:n,lastFuturesSymbol:c,lastForexSymbol:u},await e.saveSettings()},[a,s,n,c,u,e]),U=(0,Oe.useCallback)(()=>{var se,ee,ie,ve,Se,Me;let ne=(se=e.settings.home)==null?void 0:se.positionSizeDefaults;l((ee=ne==null?void 0:ne.riskPercentage)!=null?ee:1),o((ie=ne==null?void 0:ne.accountBalance)!=null?ie:1e4),i((ve=ne==null?void 0:ne.assetType)!=null?ve:"stock"),d((Se=ne==null?void 0:ne.lastFuturesSymbol)!=null?Se:"ES"),p((Me=ne==null?void 0:ne.lastForexSymbol)!=null?Me:"EURUSD"),h(""),b(""),x(""),f(""),w(""),D(""),M(""),A(""),L("")},[e]),j={width:"100%",marginTop:"4px",padding:"6px 8px",borderRadius:"4px",border:"1px solid var(--background-modifier-border)",backgroundColor:"var(--background-modifier-form-field)",color:"var(--text-normal)",fontSize:"13px"},R={...j,cursor:"pointer",appearance:"none",paddingRight:"24px",backgroundImage:"none"},O={fontSize:"12px",color:"var(--text-muted)",display:"block"},H=ne=>({flex:1,padding:"6px 8px",fontSize:"11px",fontWeight:500,border:"none",borderBottom:ne?"2px solid var(--interactive-accent)":"2px solid transparent",backgroundColor:"transparent",color:ne?"var(--text-normal)":"var(--text-muted)",cursor:"pointer",transition:"all 0.15s ease"}),V=(()=>{switch(n){case"stock":return _;case"futures":return B;case"forex":return W;default:return null}})();return Oe.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",gap:"8px"}},Oe.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},Oe.default.createElement("div",{style:{fontSize:"11px",fontWeight:500,color:"var(--text-faint)",textTransform:"uppercase",letterSpacing:"0.5px"}},"Position Size"),Oe.default.createElement("div",{style:{display:"flex",gap:"4px"}},Oe.default.createElement("button",{onClick:N,className:"clickable-icon",style:{padding:"4px 6px",borderRadius:"4px",border:"1px solid var(--background-modifier-border)",backgroundColor:"var(--background-primary)",color:"var(--text-muted)",cursor:"pointer",display:"flex",alignItems:"center"},"aria-label":"Save as default"},Oe.default.createElement(vT,{size:12})),Oe.default.createElement("button",{onClick:U,className:"clickable-icon",style:{padding:"4px 6px",borderRadius:"4px",border:"1px solid var(--background-modifier-border)",backgroundColor:"var(--background-primary)",color:"var(--text-muted)",cursor:"pointer",display:"flex",alignItems:"center"},"aria-label":"Reset to defaults"},Oe.default.createElement(Gv,{size:12})))),Oe.default.createElement("div",{style:{display:"flex",borderBottom:"1px solid var(--background-modifier-border)",marginBottom:"4px"}},XGe.map(ne=>Oe.default.createElement("button",{key:ne.id,onClick:()=>i(ne.id),style:H(n===ne.id)},ne.label))),Oe.default.createElement("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"}},Oe.default.createElement("label",{style:O},"Account Balance",Oe.default.createElement("input",{type:"number",value:a,onChange:ne=>o(parseFloat(ne.target.value)||0),style:j})),Oe.default.createElement("label",{style:O},"Risk %",Oe.default.createElement("input",{type:"number",step:"0.1",min:"0.1",max:"100",value:s,onChange:ne=>l(parseFloat(ne.target.value)||0),style:j}))),n==="stock"&&Oe.default.createElement(Oe.default.Fragment,null,m?Oe.default.createElement("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"}},Oe.default.createElement("label",{style:O},"Entry Price",Oe.default.createElement("input",{type:"number",step:"0.01",placeholder:"0.00",value:v,onChange:ne=>h(ne.target.value),style:j})),Oe.default.createElement("label",{style:O},"Investment ($)",Oe.default.createElement("input",{type:"number",step:"100",placeholder:"e.g., 10000",value:g,onChange:ne=>f(ne.target.value),style:j}))):Oe.default.createElement(Oe.default.Fragment,null,Oe.default.createElement("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"}},Oe.default.createElement("label",{style:O},"Entry Price",Oe.default.createElement("input",{type:"number",step:"0.01",placeholder:"0.00",value:v,onChange:ne=>h(ne.target.value),style:j})),Oe.default.createElement("label",{style:O},"Stop Loss",Oe.default.createElement("input",{type:"number",step:"0.01",placeholder:"0.00",value:y,onChange:ne=>b(ne.target.value),style:j}))),Oe.default.createElement("label",{style:O},"Profit Target (optional)",Oe.default.createElement("input",{type:"number",step:"0.01",placeholder:"0.00",value:k,onChange:ne=>x(ne.target.value),style:j})))),n==="futures"&&Oe.default.createElement(Oe.default.Fragment,null,Oe.default.createElement("div",{style:{position:"relative"}},Oe.default.createElement("label",{style:O},"Instrument",Oe.default.createElement("select",{value:c,onChange:ne=>d(ne.target.value),style:R},ZGe.map(ne=>Oe.default.createElement("option",{key:ne.symbol,value:ne.symbol},ne.symbol," - ",ne.name))),Oe.default.createElement(cs,{size:14,style:{position:"absolute",right:"8px",bottom:"10px",pointerEvents:"none",color:"var(--text-muted)"}}))),E&&Oe.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-muted)",padding:"4px 8px",backgroundColor:"var(--background-secondary)",borderRadius:"4px"}},"$",E.dollarPerPoint,"/pt | Tick: ",E.tickSize," = $",E.tickValue),Oe.default.createElement("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"}},Oe.default.createElement("label",{style:O},"Entry Price",Oe.default.createElement("input",{type:"number",step:(E==null?void 0:E.tickSize)||.01,placeholder:"0.00",value:S,onChange:ne=>w(ne.target.value),style:j})),Oe.default.createElement("label",{style:O},"Stop Loss",Oe.default.createElement("input",{type:"number",step:(E==null?void 0:E.tickSize)||.01,placeholder:"0.00",value:C,onChange:ne=>D(ne.target.value),style:j}))),Oe.default.createElement("label",{style:O},"Profit Target (optional)",Oe.default.createElement("input",{type:"number",step:(E==null?void 0:E.tickSize)||.01,placeholder:"0.00",value:P,onChange:ne=>M(ne.target.value),style:j}))),n==="forex"&&Oe.default.createElement(Oe.default.Fragment,null,Oe.default.createElement("div",{style:{position:"relative"}},Oe.default.createElement("label",{style:O},"Currency Pair",Oe.default.createElement("select",{value:u,onChange:ne=>p(ne.target.value),style:R},eYe.map(ne=>Oe.default.createElement("option",{key:ne.symbol,value:ne.symbol},ne.symbol," - ",ne.name))),Oe.default.createElement(cs,{size:14,style:{position:"absolute",right:"8px",bottom:"10px",pointerEvents:"none",color:"var(--text-muted)"}}))),T&&Oe.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-muted)",padding:"4px 8px",backgroundColor:"var(--background-secondary)",borderRadius:"4px"}},"Pip value: $",T.pipValue," (standard lot) | Pip size:"," ",T.pipSize),Oe.default.createElement("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"}},Oe.default.createElement("label",{style:O},"Stop Loss (pips)",Oe.default.createElement("input",{type:"number",step:"1",min:"1",placeholder:"e.g., 20",value:z,onChange:ne=>A(ne.target.value),style:j})),Oe.default.createElement("label",{style:O},"Target (pips, optional)",Oe.default.createElement("input",{type:"number",step:"1",min:"1",placeholder:"e.g., 40",value:I,onChange:ne=>L(ne.target.value),style:j})))),Oe.default.createElement("div",{style:{padding:"8px",borderRadius:"6px",backgroundColor:"var(--background-secondary)",display:"flex",flexDirection:"column",gap:"4px",marginTop:"auto"}},Oe.default.createElement("div",{style:{display:"flex",alignItems:"baseline",justifyContent:"center",gap:"6px"}},Oe.default.createElement("span",{style:{fontSize:"20px",fontWeight:600,color:V!=null&&V.positionSize?"var(--interactive-accent)":"var(--text-muted)"}},V!=null&&V.positionSize?V.positionSize.toFixed(HT(n)):"\u2014"),Oe.default.createElement("span",{style:{fontSize:"11px",color:"var(--text-muted)"}},(V==null?void 0:V.unit)||"enter values"),!m&&(n==="stock"&&(_==null?void 0:_.isLong)!==void 0||n==="futures"&&(B==null?void 0:B.isLong)!==void 0)&&Oe.default.createElement("span",{style:{fontSize:"9px",fontWeight:600,padding:"1px 4px",borderRadius:"3px",backgroundColor:((te=_==null?void 0:_.isLong)!=null?te:B!=null&&B.isLong)?"rgba(var(--color-green-rgb), 0.15)":"rgba(var(--color-red-rgb), 0.15)",color:((re=_==null?void 0:_.isLong)!=null?re:B!=null&&B.isLong)?"var(--color-green)":"var(--color-red)",textTransform:"uppercase"}},((Z=_==null?void 0:_.isLong)!=null?Z:B!=null&&B.isLong)?"Long":"Short")),Oe.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"10px",borderTop:"1px solid var(--background-modifier-border)",paddingTop:"4px"}},Oe.default.createElement("div",{style:{textAlign:"left"}},m&&n==="stock"?Oe.default.createElement(Oe.default.Fragment,null,Oe.default.createElement("span",{style:{color:"var(--text-faint)"}},"Investment "),Oe.default.createElement("span",{style:{fontWeight:500}},_!=null&&_.dollarAmount?sa(_.dollarAmount,!1,t):"\u2014")):Oe.default.createElement(Oe.default.Fragment,null,Oe.default.createElement("span",{style:{color:"var(--text-faint)"}},"Risk "),Oe.default.createElement("span",{style:{fontWeight:500}},sa($,!1,t)))),!m&&(V==null?void 0:V.riskRewardRatio)!=null&&V.potentialProfit!=null?Oe.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px"}},Oe.default.createElement("div",null,Oe.default.createElement("span",{style:{color:"var(--text-faint)"}},"Reward "),Oe.default.createElement("span",{style:{fontWeight:500,color:"var(--color-green)"}},sa(V.potentialProfit,!1,t))),Oe.default.createElement("span",{style:{fontWeight:600,padding:"1px 5px",borderRadius:"3px",backgroundColor:V.riskRewardRatio>=2?"rgba(var(--color-green-rgb), 0.15)":V.riskRewardRatio>=1?"rgba(var(--color-yellow-rgb), 0.15)":"rgba(var(--color-red-rgb), 0.15)",color:V.riskRewardRatio>=2?"var(--color-green)":V.riskRewardRatio>=1?"var(--color-yellow)":"var(--color-red)"}},"1:",V.riskRewardRatio.toFixed(1))):Oe.default.createElement("span",{style:{color:"var(--text-muted)"}},n==="stock"&&m&&v&&`@ $${parseFloat(v).toFixed(2)}`,n==="stock"&&!m&&(_==null?void 0:_.priceDiff)&&`$${_.priceDiff.toFixed(2)} stop`,n==="futures"&&B&&`${B.pointsDiff.toFixed(2)} pts`,n==="forex"&&W&&`${W.miniLots.toFixed(1)} mini`))))},rxe=(0,Oe.memo)(tYe)});var jt,Rb,Hq,ixe=F(()=>{jt=Y(Q()),Rb=require("obsidian");Ot();ps();Hq=(0,jt.memo)(({plugin:e,instanceId:t})=>{var w,C,D;let[r,n]=(0,jt.useState)(""),[i,a]=(0,jt.useState)(null),[o,s]=(0,jt.useState)(!0),[l,c]=(0,jt.useState)(!1),[d,u]=(0,jt.useState)(""),p=(0,jt.useRef)(null),m=(0,jt.useRef)(null),g=(C=(w=e.settings.home)==null?void 0:w.embeddedNotes)==null?void 0:C[t],f=g==null?void 0:g.filePath,v=g==null?void 0:g.title,h=(0,jt.useMemo)(()=>e.app.vault.getMarkdownFiles().sort((P,M)=>P.path.localeCompare(M.path)),[e.app.vault]),y=(0,jt.useMemo)(()=>d?h.filter(P=>P.path.toLowerCase().includes(d.toLowerCase())||P.basename.toLowerCase().includes(d.toLowerCase())):h,[h,d]),b=(0,jt.useCallback)(async()=>{if(!f){s(!1),n(""),a(null);return}try{s(!0),a(null);let P=e.app.vault.getAbstractFileByPath(f);if(!(P instanceof Rb.TFile)){a(`File not found: ${f}`),n("");return}let z=(await e.app.vault.read(P)).replace(/^---[\s\S]*?---\n*/,"");n(z)}catch(P){console.error("Failed to load embedded note:",P),a("Failed to load note content"),n("")}finally{s(!1)}},[f,e.app.vault]);(0,jt.useEffect)(()=>{b()},[b]),(0,jt.useEffect)(()=>{if(!f)return;let P=E=>{E.path===f&&b()},M=E=>{E.path===f&&(a("Source file was deleted"),n(""))},z=async(E,T)=>{var $;T===f&&(($=e.settings.home)!=null&&$.embeddedNotes)&&(e.settings.home.embeddedNotes[t]={...e.settings.home.embeddedNotes[t],filePath:E.path},await e.saveSettings())},A=e.app.vault.on("modify",P),I=e.app.vault.on("delete",M),L=e.app.vault.on("rename",z);return()=>{e.app.vault.offref(A),e.app.vault.offref(I),e.app.vault.offref(L)}},[f,t,b,e]);let k=(0,jt.useCallback)(async P=>{if(f)try{let M=e.app.vault.getAbstractFileByPath(f);if(!(M instanceof Rb.TFile))return;let A=(await e.app.vault.read(M)).split(`
`),I=0,L=!1;for(let E=0;E<A.length;E++){let T=A[E];if(E===0&&T==="---"){L=!0;continue}if(L&&T==="---"){L=!1;continue}if(L)continue;let $=T.match(/^(\s*[-*]\s*)\[([ xX])\]/);if($){if(I===P){let B=$[2].toLowerCase()==="x"?" ":"x";A[E]=T.replace(/\[([ xX])\]/,`[${B}]`),await e.app.vault.modify(M,A.join(`
`));return}I++}}}catch(M){console.error("Failed to toggle checkbox:",M)}},[f,e.app.vault]);(0,jt.useEffect)(()=>{let P=p.current;if(!P||!r||i)return;m.current||(m.current=new Rb.Component,m.current.load()),P.innerHTML="",Rb.MarkdownRenderer.render(e.app,r,P,f||"",m.current);let M=setTimeout(()=>{P.querySelectorAll("input.task-list-item-checkbox").forEach((A,I)=>{A.style.pointerEvents="auto",A.style.cursor="pointer",A.addEventListener("click",L=>{L.preventDefault(),L.stopPropagation(),k(I)})})},50);return()=>{clearTimeout(M)}},[r,f,e.app,i,k]),(0,jt.useEffect)(()=>()=>{m.current&&(m.current.unload(),m.current=null)},[]);let x=(0,jt.useCallback)(async P=>{var M;e.settings.home||(e.settings.home={layouts:{Default:{lg:[],md:[],sm:[],xs:[],xxs:[]}},activeLayout:"Default"}),e.settings.home.embeddedNotes||(e.settings.home.embeddedNotes={}),e.settings.home.embeddedNotes[t]={filePath:P.path,title:(M=e.settings.home.embeddedNotes[t])==null?void 0:M.title};try{await e.saveSettings()}catch(z){console.error("Failed to save embedded note settings:",z)}c(!1),u("")},[t,e]),S=v||(f?(D=f.split("/").pop())==null?void 0:D.replace(".md",""):"Embedded Note");return l||!f&&!o?jt.default.createElement("div",{className:"journalit-embedded-note-widget",style:{height:"100%",display:"flex",flexDirection:"column",gap:"8px"}},jt.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},jt.default.createElement("div",{style:{fontSize:"11px",fontWeight:500,color:"var(--text-faint)",textTransform:"uppercase",letterSpacing:"0.5px"}},"Select a Note"),f&&jt.default.createElement("button",{onClick:()=>c(!1),style:{padding:"4px 8px",fontSize:"12px",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",backgroundColor:"var(--background-secondary)",color:"var(--text-muted)",cursor:"pointer"}},"Cancel")),jt.default.createElement("input",{type:"text",placeholder:"Search notes...",value:d,onChange:P=>u(P.target.value),style:{padding:"8px 12px",fontSize:"13px",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",backgroundColor:"var(--background-primary)",color:"var(--text-normal)",outline:"none"}}),jt.default.createElement("div",{style:{flex:1,overflow:"auto",border:"1px solid var(--background-modifier-border)",borderRadius:"4px"}},y.length===0?jt.default.createElement("div",{style:{padding:"16px",textAlign:"center",color:"var(--text-muted)"}},"No notes found"):y.slice(0,50).map(P=>jt.default.createElement("div",{key:P.path,onClick:()=>x(P),className:"jl-recent-item-hover",style:{padding:"8px 12px",cursor:"pointer",borderBottom:"1px solid var(--background-modifier-border)",display:"flex",alignItems:"center",gap:"8px"}},jt.default.createElement($v,{size:14,style:{color:"var(--text-muted)",flexShrink:0}}),jt.default.createElement("div",{style:{minWidth:0}},jt.default.createElement("div",{style:{fontSize:"13px",color:"var(--text-normal)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},P.basename),jt.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-muted)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},P.path)))))):o?jt.default.createElement("div",{className:"journalit-embedded-note-widget",style:{height:"100%",display:"flex",flexDirection:"column"}},jt.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px",flexShrink:0}},jt.default.createElement(Qe,{width:"100px",height:"11px"}),jt.default.createElement(Qe,{width:"14px",height:"14px"})),jt.default.createElement("div",{style:{flex:1,overflow:"hidden",padding:"0 8px 8px 8px",display:"flex",flexDirection:"column",gap:"8px"}},jt.default.createElement(Qe,{width:"90%",height:"13px"}),jt.default.createElement(Qe,{width:"100%",height:"13px"}),jt.default.createElement(Qe,{width:"75%",height:"13px"}),jt.default.createElement(Qe,{width:"85%",height:"13px"}),jt.default.createElement(Qe,{width:"60%",height:"13px"}))):i?jt.default.createElement("div",{className:"journalit-embedded-note-widget",style:{height:"100%",display:"flex",flexDirection:"column"}},jt.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px"}},jt.default.createElement("div",{style:{fontSize:"11px",fontWeight:500,color:"var(--text-faint)",textTransform:"uppercase",letterSpacing:"0.5px"}},S),jt.default.createElement("button",{onClick:()=>c(!0),className:"clickable-icon",style:{padding:"4px",border:"none",backgroundColor:"transparent",color:"var(--text-muted)",cursor:"pointer",borderRadius:"4px"},"aria-label":"Change note"},jt.default.createElement(Yv,{size:14}))),jt.default.createElement("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"8px",color:"var(--text-error)"}},jt.default.createElement(Dp,{size:24}),jt.default.createElement("div",{style:{fontSize:"13px",textAlign:"center"}},i),jt.default.createElement("button",{onClick:()=>c(!0),style:{marginTop:"8px",padding:"6px 12px",fontSize:"12px",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",backgroundColor:"var(--interactive-accent)",color:"var(--text-on-accent)",cursor:"pointer"}},"Select Different Note"))):jt.default.createElement("div",{className:"journalit-embedded-note-widget",style:{height:"100%",display:"flex",flexDirection:"column"}},jt.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px",flexShrink:0}},jt.default.createElement("div",{style:{fontSize:"11px",fontWeight:500,color:"var(--text-faint)",textTransform:"uppercase",letterSpacing:"0.5px",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px"},onClick:()=>f&&e.openFile(f,!0),title:"Click to open note"},S),jt.default.createElement("button",{onClick:()=>c(!0),className:"jl-icon-button-hover clickable-icon",style:{padding:"4px",border:"none",backgroundColor:"transparent",color:"var(--text-muted)",cursor:"pointer",borderRadius:"4px",display:"flex",alignItems:"center",justifyContent:"center"},"aria-label":"Change note"},jt.default.createElement(Zm,{size:14}))),jt.default.createElement("div",{ref:p,className:"journalit-embedded-note-content markdown-rendered",style:{flex:1,overflow:"auto",fontSize:"13px",lineHeight:"1.5",padding:"0 8px 8px 8px"}}))});Hq.displayName="EmbeddedNoteWidget"});var ka,rYe,nYe,axe,oxe=F(()=>{ka=Y(Q());Ot();fc();pk();yy();us();ps();rYe=e=>{switch(e){case"month":return"this month";case"quarter":return"this quarter";case"year":return"this year";default:return"ever"}},nYe=()=>{let{dashboardData:e}=ua(),t=MP(),r=t==null?void 0:t.period,n=uk(e==null?void 0:e.trades),i=(0,ka.useMemo)(()=>n?n.filter(d=>!vy(d)):[],[n]),a=(0,ka.useMemo)(()=>{var C,D,P,M;let d={currentStreak:0,streakType:"none",longestWinStreak:0,longestLossStreak:0,avgWinStreak:0,avgLossStreak:0,lastTradeDate:null};if(!i||i.length===0)return d;let u=[...i].sort((z,A)=>{let I=new Date(z.entryTime).getTime();return new Date(A.entryTime).getTime()-I}),p=0,m="none",g=u.length>0?new Date(u[0].entryTime):null;if(u.length>0){let z=(C=u[0].pnl)!=null?C:0;if(z>0){m="win",p=1;for(let A=1;A<u.length&&((D=u[A].pnl)!=null?D:0)>0;A++)p++}else if(z<0){m="loss",p=1;for(let A=1;A<u.length&&((P=u[A].pnl)!=null?P:0)<0;A++)p++}}let f=[...u].reverse(),v=[],h=[],y=0,b=0;for(let z of f){let A=(M=z.pnl)!=null?M:0;A>0?(b>0&&(h.push(b),b=0),y++):A<0&&(y>0&&(v.push(y),y=0),b++)}y>0&&v.push(y),b>0&&h.push(b);let k=v.length>0?Math.max(...v):0,x=h.length>0?Math.max(...h):0,S=v.length>0?v.reduce((z,A)=>z+A,0)/v.length:0,w=h.length>0?h.reduce((z,A)=>z+A,0)/h.length:0;return{currentStreak:p,streakType:m,longestWinStreak:k,longestLossStreak:x,avgWinStreak:S,avgLossStreak:w,lastTradeDate:g}},[i]),s=a.streakType==="win"?{color:"var(--color-green)",icon:lT,label:a.currentStreak===1?"win":"wins",contextLabel:"in a row",bgColor:"rgba(var(--color-green-rgb), 0.1)"}:a.streakType==="loss"?{color:"var(--color-red)",icon:xT,label:a.currentStreak===1?"loss":"losses",contextLabel:"in a row",bgColor:"rgba(var(--color-red-rgb), 0.1)"}:{color:"var(--text-muted)",icon:qv,label:"",contextLabel:"no active streak",bgColor:"transparent"},l=s.icon,c=()=>{let d=rYe(r);return a.streakType==="none"?"start trading to build a streak":a.streakType==="win"?a.currentStreak>=a.longestWinStreak&&a.currentStreak>1?`your best streak ${d}`:a.currentStreak>a.avgWinStreak*1.5&&a.currentStreak>1?`above your average ${d}`:a.currentStreak>=3?"stay focused, keep it going":a.currentStreak===2?"keep it going":"good start":a.streakType==="loss"?a.currentStreak>=3?"pause before your next trade":a.currentStreak>=2?"review before next trade":"losses are part of the process":""};return e?ka.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",padding:"12px",gap:"8px"}},ka.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"11px",fontWeight:500,color:"var(--text-faint)",textTransform:"uppercase",letterSpacing:"0.5px"}},ka.default.createElement("span",null,"Streak"),a.longestWinStreak>0&&ka.default.createElement("span",{style:{textTransform:"none",letterSpacing:0}},"best ",a.longestWinStreak," \xB7 avg ",a.avgWinStreak.toFixed(1))),ka.default.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flex:1,minHeight:0,gap:"4px"}},a.streakType!=="none"&&ka.default.createElement(l,{size:24,style:{color:s.color,opacity:.8}}),ka.default.createElement("div",{style:{fontSize:"36px",fontWeight:600,color:s.color,lineHeight:1}},a.streakType!=="none"?a.currentStreak:"\u2014"),ka.default.createElement("div",{style:{fontSize:"14px",color:s.color,opacity:.9}},a.streakType!=="none"?`${s.label} ${s.contextLabel}`:s.contextLabel),ka.default.createElement("div",{style:{fontSize:"12px",color:"var(--text-muted)",marginTop:"4px"}},c()))):ka.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",padding:"12px",gap:"8px"}},ka.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},ka.default.createElement(Qe,{width:"50px",height:"11px"}),ka.default.createElement(Qe,{width:"80px",height:"11px"})),ka.default.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flex:1,minHeight:0,gap:"8px"}},ka.default.createElement(ae,{width:24,height:24,borderRadius:"50%"}),ka.default.createElement(ae,{width:48,height:36,borderRadius:"8px"}),ka.default.createElement(Qe,{width:"100px",height:"14px"}),ka.default.createElement(Qe,{width:"120px",height:"12px"})))},axe=(0,ka.memo)(nYe)});var Pr,pO,iYe,aYe,sxe,lxe=F(()=>{Pr=Y(Q());fc();pk();Er();qt();us();ps();pO=e=>{let t=(e%24+24)%24,r=Math.round(t*60),n=Math.floor(r/60)%24,i=r%60,a=n>=12?"pm":"am",o=n%12;return o===0&&(o=12),i===0?`${o}${a}`:`${o}:${i.toString().padStart(2,"0")}${a}`},iYe=(e,t)=>`${pO(e)} - ${pO(t)}`,aYe=()=>{let{dashboardData:e}=ua(),{currency:t}=ct(),[r,n]=Pr.default.useState(null),i=uk(e==null?void 0:e.trades),{timePeriods:a,dayStart:o,dayEnd:s}=(0,Pr.useMemo)(()=>{if(!i||i.length===0)return{timePeriods:[],dayStart:0,dayEnd:24};let f=i.map(C=>{let D=new Date(C.entryTime);return D.getHours()+D.getMinutes()/60}),v=Math.min(...f),h=Math.max(...f),y=Math.max(0,Math.floor(v)),b=Math.min(24,Math.ceil(h)+1),k=Math.max(4,b-y),x=k<=6?3:4,S=k/x,w=[];for(let C=0;C<x;C++){let D=y+C*S,P=y+(C+1)*S;w.push({id:`period-${C}`,label:iYe(D,P),startHour:D,endHour:P})}return{timePeriods:w,dayStart:y,dayEnd:y+k}},[i]),l=(0,Pr.useMemo)(()=>{if(!i||i.length===0||a.length===0)return[];let f=new Map;return a.forEach(v=>{f.set(v.id,{pnl:0,wins:0,total:0})}),i.forEach(v=>{var k;let h=new Date(v.entryTime),y=h.getHours()+h.getMinutes()/60,b=(k=v.pnl)!=null?k:0;for(let x of a)if(y>=x.startHour&&y<x.endHour){let S=f.get(x.id);S.pnl+=b,S.total++,b>0&&S.wins++;break}}),a.map(v=>{let h=f.get(v.id);return{period:v,pnl:h.pnl,tradeCount:h.total,winRate:h.total>0?h.wins/h.total*100:0}}).filter(v=>v.tradeCount>0)},[i,a]),{bestPeriod:c,isNegativeBest:d}=(0,Pr.useMemo)(()=>{if(l.length===0)return{bestPeriod:null,isNegativeBest:!1};let f=l.reduce((v,h)=>h.pnl>v.pnl?h:v);return{bestPeriod:f,isNegativeBest:f.pnl<0}},[l]),{maxPnL:u,minPnL:p}=(0,Pr.useMemo)(()=>{if(l.length===0)return{maxPnL:1,minPnL:0};let f=l.map(v=>v.pnl);return{maxPnL:Math.max(...f),minPnL:Math.min(...f)}},[l]),m=(0,Pr.useMemo)(()=>r&&l.find(f=>f.period.id===r)||null,[r,l]);if(!e)return Pr.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",padding:"12px",gap:"6px"}},Pr.default.createElement(Qe,{width:"70px",height:"11px"}),Pr.default.createElement("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"4px",minHeight:0}},Pr.default.createElement(ae,{width:80,height:28,borderRadius:"8px"}),Pr.default.createElement(Qe,{width:"100px",height:"13px"})),Pr.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"4px"}},Pr.default.createElement(ae,{width:"100%",height:20,borderRadius:"10px"}),Pr.default.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},Pr.default.createElement(Qe,{width:"30px",height:"10px"}),Pr.default.createElement(Qe,{width:"30px",height:"10px"}),Pr.default.createElement(Qe,{width:"30px",height:"10px"}))));if(l.length===0)return Pr.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",padding:"12px"}},Pr.default.createElement("div",{style:{fontSize:"11px",fontWeight:500,color:"var(--text-faint)",textTransform:"uppercase",letterSpacing:"0.5px"}},"Best Hours"),Pr.default.createElement("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center"}},Pr.default.createElement("span",{style:{fontSize:"13px",color:"var(--text-muted)"}},"No trade data")));let g=f=>{let v=s-o,h=(f.startHour-o)/v*100,y=(f.endHour-f.startHour)/v*100;return{left:h,width:y}};return Pr.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",padding:"12px",gap:"6px"}},Pr.default.createElement("div",{style:{fontSize:"11px",fontWeight:500,color:"var(--text-faint)",textTransform:"uppercase",letterSpacing:"0.5px"}},"Best Hours"),Pr.default.createElement("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"2px",minHeight:0}},c&&Pr.default.createElement(Pr.default.Fragment,null,Pr.default.createElement("div",{style:{fontSize:"28px",fontWeight:600,color:d?"var(--color-red)":"var(--color-green)",lineHeight:1.1}},ye(c.pnl,!0,t)),Pr.default.createElement("div",{style:{fontSize:"13px",color:"var(--text-muted)"}},c.period.label))),Pr.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"4px",position:"relative"}},Pr.default.createElement("div",{style:{position:"relative",height:"20px",backgroundColor:"var(--background-secondary)",borderRadius:"10px",overflow:"hidden"}},a.map(f=>{var C,D;let v=l.find(P=>P.period.id===f.id),{left:h,width:y}=g(f),b=r===f.id,k=(c==null?void 0:c.period.id)===f.id,x=(C=v==null?void 0:v.pnl)!=null?C:0,S;Math.abs(x)<.01?S="var(--text-faint)":x>0?S="var(--color-green)":S="var(--color-red)";let w;if(k)w=1;else{let P=u-p;w=.25+(P>0?(x-p)/P:.5)*.25}return Pr.default.createElement("div",{key:f.id,onMouseEnter:()=>n(f.id),onMouseLeave:()=>n(null),onFocus:()=>n(f.id),onBlur:()=>n(null),tabIndex:0,role:"button","aria-label":`${f.label}: ${ye(x,!0,t)} P&L, ${(D=v==null?void 0:v.tradeCount)!=null?D:0} trades`,style:{position:"absolute",left:`${h}%`,width:`${y}%`,height:"100%",backgroundColor:S,opacity:w,cursor:"pointer",transition:"opacity 0.2s ease",...b&&!k&&{opacity:Math.min(.65,w+.15)}}})})),m&&Pr.default.createElement("div",{style:{position:"absolute",bottom:"100%",left:"50%",transform:"translateX(-50%)",marginBottom:"8px",backgroundColor:"var(--background-primary)",border:"1px solid var(--background-modifier-border)",borderRadius:"6px",padding:"8px 12px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",zIndex:100,whiteSpace:"nowrap",pointerEvents:"none"}},Pr.default.createElement("div",{style:{fontSize:"12px",fontWeight:600,color:"var(--text-normal)",marginBottom:"4px"}},m.period.label),Pr.default.createElement("div",{style:{display:"flex",gap:"12px",fontSize:"11px"}},Pr.default.createElement("span",{style:{color:m.pnl>=0?"var(--color-green)":"var(--color-red)",fontWeight:500}},ye(m.pnl,!0,t)),Pr.default.createElement("span",{style:{color:"var(--text-muted)"}},m.tradeCount," trades"),Pr.default.createElement("span",{style:{color:"var(--text-muted)"}},m.winRate.toFixed(0),"% win"))),Pr.default.createElement("div",{style:{position:"relative",height:"14px",fontSize:"10px",color:"var(--text-faint)"}},a.map(f=>{let{left:v}=g(f);return Pr.default.createElement("span",{key:`start-${f.id}`,style:{position:"absolute",left:`${v}%`,transform:"translateX(-50%)"}},pO(f.startHour))}),a.length>0&&Pr.default.createElement("span",{style:{position:"absolute",left:"100%",transform:"translateX(-50%)"}},pO(a[a.length-1].endHour)))))},sxe=(0,Pr.memo)(aYe)});var On,oYe,cxe,dxe=F(()=>{On=Y(Q());fc();pk();Er();qt();Hp();us();ps();oYe=()=>{let{dashboardData:e}=ua(),{currency:t}=ct(),r=uk(e==null?void 0:e.trades),n=(0,On.useMemo)(()=>{var c,d;if(!r||r.length===0)return[];let s=new Map;for(let u of r){let p=u.setup||[];if(p.length!==0)for(let m of p){if(!m||m.trim()==="")continue;let g=s.get(m)||{pnl:0,count:0,wins:0};g.pnl+=(c=u.pnl)!=null?c:0,g.count+=1,((d=u.pnl)!=null?d:0)>0&&(g.wins+=1),s.set(m,g)}}let l=[];for(let[u,p]of s)l.push({name:u,totalPnL:p.pnl,tradeCount:p.count,winCount:p.wins,winRate:p.count>0?p.wins/p.count*100:0});return l.sort((u,p)=>p.totalPnL-u.totalPnL),l},[r]),i=(0,On.useMemo)(()=>n.length===0?1:Math.max(...n.map(s=>Math.abs(s.totalPnL)),1),[n]),a=n.slice(0,3);if(!e)return On.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",padding:"12px",gap:"10px"}},On.default.createElement(Qe,{width:"80px",height:"11px"}),On.default.createElement("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",gap:"8px",minHeight:0}},[1,2,3].map(s=>On.default.createElement("div",{key:s,style:{display:"flex",alignItems:"center",gap:"10px"}},On.default.createElement("div",{style:{width:"80px",flexShrink:0}},On.default.createElement(Qe,{width:"80px",height:"12px"})),On.default.createElement("div",{style:{flex:1,minWidth:0}},On.default.createElement(ae,{width:`${100-s*25}%`,height:8,borderRadius:"0px"})),On.default.createElement("div",{style:{width:"60px",flexShrink:0}},On.default.createElement(Qe,{width:"60px",height:"12px"}))))));if(n.length===0)return On.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",padding:"12px"}},On.default.createElement("div",{style:{fontSize:"11px",fontWeight:500,color:"var(--text-faint)",textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"12px"}},"Top Setups"),On.default.createElement("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center"}},On.default.createElement("span",{style:{fontSize:"13px",color:"var(--text-muted)"}},"No setups recorded yet")));let o=s=>{var c;return(c=[1,.85,.7][s])!=null?c:.7};return On.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",padding:"12px",gap:"10px"}},On.default.createElement("div",{style:{fontSize:"11px",fontWeight:500,color:"var(--text-faint)",textTransform:"uppercase",letterSpacing:"0.5px"}},"Top Setups"),On.default.createElement("div",{style:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center",gap:"8px",minHeight:0}},a.map((s,l)=>{let c=s.totalPnL>=0,d=Math.max(8,Math.abs(s.totalPnL)/i*100),u=c?"var(--color-green)":"var(--color-red)",p=o(l);return On.default.createElement(pn,{key:s.name,content:On.default.createElement("div",{style:{padding:"6px 10px",fontSize:"12px",backgroundColor:"var(--background-secondary)",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.15)"}},On.default.createElement("span",{style:{color:"var(--text-normal)"}},s.tradeCount," trades"),On.default.createElement("span",{style:{color:"var(--text-muted)",margin:"0 6px"}},"\xB7"),On.default.createElement("span",{style:{color:"var(--text-normal)"}},s.winRate.toFixed(0),"% win rate")),delay:200},On.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"10px",width:"100%"}},On.default.createElement("span",{style:{fontSize:"12px",fontWeight:400,color:"var(--text-muted)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",width:"80px",flexShrink:0}},s.name),On.default.createElement("div",{style:{flex:1,height:"8px",minWidth:0}},On.default.createElement("div",{style:{width:`${d}%`,height:"100%",backgroundColor:u,opacity:p,transition:"width 0.3s ease"}})),On.default.createElement("span",{style:{fontSize:"12px",fontWeight:600,color:u,flexShrink:0,minWidth:"60px",textAlign:"right"}},ye(s.totalPnL,!0,t))))})))},cxe=(0,On.memo)(oYe)});var ja,sYe,uxe,pxe=F(()=>{ja=Y(Q());Ot();fc();_t();us();ps();sYe=({plugin:e})=>{let{dashboardData:t}=ua(),r=(0,ja.useMemo)(()=>{if(!(t!=null&&t.trades))return{total:0,today:0,thisWeek:0,older:0};let a=new Date,o=To(a),l=ea(a).getTime(),c=0,d=0,u=0,p=t.trades;for(let m of p){if(m.reviewed)continue;let g=m.entryTime instanceof Date?m.entryTime:new Date(m.entryTime);if(isNaN(g.getTime()))continue;To(g)===o?c++:g.getTime()>=l?d++:u++}return{total:c+d+u,today:c,thisWeek:d,older:u}},[t]),n=async()=>{try{await e.viewManager.openTradeLogView()}catch(a){console.error("Failed to open Trade Log:",a)}};if(!t)return ja.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:"12px",gap:"4px"}},ja.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"6px"}},ja.default.createElement(ae,{width:8,height:8,borderRadius:"50%"}),ja.default.createElement(Qe,{width:"140px",height:"13px"}),ja.default.createElement(ae,{width:14,height:14,borderRadius:"2px"})),ja.default.createElement(Qe,{width:"100px",height:"11px"}));if(r.total===0)return ja.default.createElement("div",{className:"jl-widget-hover",style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",padding:"12px",cursor:"pointer",gap:"8px"},onClick:n,title:"Open Trade Log"},ja.default.createElement(iT,{size:16,style:{color:"var(--color-green)"}}),ja.default.createElement("span",{style:{fontSize:"13px",color:"var(--text-muted)"}},"All trades reviewed"));let i=r.total>5?"var(--color-orange)":"var(--color-yellow)";return ja.default.createElement("div",{className:"jl-widget-hover",style:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",padding:"12px",cursor:"pointer",gap:"4px"},onClick:n,title:"Open Trade Log to review"},ja.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"}},ja.default.createElement("div",{style:{width:"8px",height:"8px",borderRadius:"50%",backgroundColor:i,flexShrink:0}}),ja.default.createElement("span",{style:{fontSize:"13px",color:"var(--text-normal)",fontWeight:500}},r.total," trade",r.total!==1?"s":""," need review"),ja.default.createElement(Nu,{size:14,style:{color:"var(--text-faint)",flexShrink:0}})),(r.today>0||r.thisWeek>0)&&ja.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-muted)"}},r.today>0&&ja.default.createElement("span",null,r.today," today"),r.today>0&&r.thisWeek>0&&ja.default.createElement("span",null," \xB7 "),r.thisWeek>0&&ja.default.createElement("span",null,r.thisWeek," this week")))},uxe=(0,ja.memo)(sYe)});var ir,lYe,cYe,dYe,uYe,pYe,mxe,fxe=F(()=>{ir=Y(Q());Ot();fc();Er();qt();_t();us();ps();lYe=[{value:"pnl",label:"P&L Target",description:"Profit/loss goal for a period"},{value:"tradesJournaled",label:"Trades Logged",description:"Lifetime trade count"},{value:"winRate",label:"Win Rate",description:"Winning percentage target"}],cYe=[{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},{value:"monthly",label:"Monthly"}],dYe=(e,t)=>t||e>=75?"var(--color-green)":e>=50?"var(--color-yellow)":e>=25?"var(--color-orange, #f59e0b)":"var(--color-red)",uYe=(e,t)=>t||e>=75?"var(--color-green)":e>=50?"var(--text-normal)":e>=25?"var(--color-orange, #f59e0b)":"var(--color-red)",pYe=({plugin:e,instanceId:t})=>{var C,D,P,M,z,A,I;let r=ua(),{currency:n}=ct(),i=(D=(C=e.settings.home)==null?void 0:C.goals)==null?void 0:D[t],[a,o]=(0,ir.useState)(!i),[s,l]=(0,ir.useState)((i==null?void 0:i.type)||"pnl"),[c,d]=(0,ir.useState)(((P=i==null?void 0:i.target)==null?void 0:P.toString())||""),[u,p]=(0,ir.useState)((i==null?void 0:i.period)||"weekly"),[m,g]=(0,ir.useState)((z=i==null?void 0:i.useRMultiples)!=null?z:((M=e.settings.trade)==null?void 0:M.displayRMultiples)||!1),f=((A=e.settings.trade)==null?void 0:A.displayRMultiples)||!1,v=(I=e.settings.trade)==null?void 0:I.defaultRiskAmount,h=(0,ir.useMemo)(()=>{var R;if(!i||!((R=r==null?void 0:r.dashboardData)!=null&&R.trades))return null;let L=r.dashboardData.trades,E=new Date,T=i,$=L,_="",B=T.type==="tradesJournaled"?"lifetime":T.period;if(B!=="lifetime"){let O,H=E;B==="daily"?(O=new Date(E),O.setHours(0,0,0,0),_="today"):B==="weekly"?(O=ea(E),_="this week"):(O=new Date(E.getFullYear(),E.getMonth(),1),_="this month"),$=L.filter(q=>{let V=new Date(q.entryTime);return isNaN(V.getTime())?!1:V>=O&&V<=H})}else _="total";let W=0,N="";switch(T.type){case"pnl":{let O=$.reduce((q,V)=>{var J;return q+((J=V.pnl)!=null?J:0)},0),H=v;T.useRMultiples&&typeof H=="number"&&Number.isFinite(H)&&H>0?(W=O/H,N=`${W>=0?"+":""}${W.toFixed(1)}R`):(W=O,N=ye(W,!0,n));break}case"tradesJournaled":{W=$.length,N=`${W} trades`;break}case"winRate":{$.length>0&&(W=$.filter(H=>{var q;return((q=H.pnl)!=null?q:0)>0}).length/$.length*100),N=`${W.toFixed(1)}%`;break}}let U=T.target>0?Math.min(W/T.target*100,100):0,j=W>=T.target;return{current:W,target:T.target,percentage:U,label:N,periodLabel:_,isComplete:j}},[i,r,n,v]),y=(0,ir.useCallback)(async()=>{let L=parseFloat(c);if(isNaN(L)||L<=0)return;e.settings.home||(e.settings.home={layouts:{Default:{lg:[],md:[],sm:[],xs:[],xxs:[]}},activeLayout:"Default"}),e.settings.home.goals||(e.settings.home.goals={});let T={type:s,target:L,period:s==="tradesJournaled"?"lifetime":u==="lifetime"?"weekly":u,useRMultiples:s==="pnl"?m:void 0,createdAt:(i==null?void 0:i.createdAt)||new Date().toISOString()};e.settings.home.goals[t]=T;try{await e.saveSettings(),o(!1)}catch($){console.error("Failed to save goal settings:",$)}},[s,c,u,m,t,e,i]),b=()=>{if(!i)return"";switch(i.type){case"pnl":return i.useRMultiples?`${i.target}R`:sa(i.target,!1,n);case"tradesJournaled":return`${i.target} trades`;case"winRate":return`${i.target}%`;default:return i.target.toString()}},k=parseFloat(c),x=Number.isFinite(k)&&k>0;if(a)return ir.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",padding:"12px",gap:"10px"}},ir.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},ir.default.createElement("div",{style:{fontSize:"11px",fontWeight:500,color:"var(--text-faint)",textTransform:"uppercase",letterSpacing:"0.5px"}},"Set Goal"),ir.default.createElement("div",{style:{display:"flex",gap:"4px"}},ir.default.createElement("button",{onClick:y,disabled:!x,className:"clickable-icon",style:{padding:"4px",border:"none",backgroundColor:x?"var(--color-green)":"var(--background-modifier-border)",color:x?"white":"var(--text-muted)",cursor:x?"pointer":"not-allowed",borderRadius:"4px",display:"flex",alignItems:"center"},"aria-label":"Save goal"},ir.default.createElement(Fi,{size:14})),i&&ir.default.createElement("button",{onClick:()=>o(!1),className:"clickable-icon",style:{padding:"4px",border:"none",backgroundColor:"transparent",color:"var(--text-muted)",cursor:"pointer",borderRadius:"4px",display:"flex",alignItems:"center"},"aria-label":"Cancel"},ir.default.createElement(La,{size:14})))),ir.default.createElement("div",{style:{display:"flex",gap:"4px",flexWrap:"wrap"}},lYe.map(L=>ir.default.createElement("button",{key:L.value,onClick:()=>{l(L.value),L.value!=="tradesJournaled"&&u==="lifetime"&&p("weekly")},style:{padding:"4px 8px",fontSize:"11px",border:`1px solid ${s===L.value?"var(--interactive-accent)":"var(--background-modifier-border)"}`,borderRadius:"4px",backgroundColor:s===L.value?"var(--interactive-accent)":"transparent",color:s===L.value?"var(--text-on-accent)":"var(--text-muted)",cursor:"pointer",transition:"all 0.15s ease"}},L.label))),ir.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px"}},ir.default.createElement("label",{style:{fontSize:"12px",color:"var(--text-muted)",whiteSpace:"nowrap"}},"Target"),ir.default.createElement("input",{type:"number",value:c,onChange:L=>d(L.target.value),placeholder:s==="pnl"?m?"10":"500":s==="winRate"?"60":"100",style:{flex:1,padding:"6px 8px",fontSize:"13px",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",backgroundColor:"var(--background-modifier-form-field)",color:"var(--text-normal)",outline:"none"}}),ir.default.createElement("span",{style:{fontSize:"11px",color:"var(--text-faint)"}},s==="pnl"&&m?"R":s==="pnl"?n:s==="winRate"?"%":"trades")),s!=="tradesJournaled"&&ir.default.createElement("div",{style:{display:"flex",gap:"4px"}},cYe.map(L=>ir.default.createElement("button",{key:L.value,onClick:()=>p(L.value),style:{flex:1,padding:"4px 6px",fontSize:"11px",border:`1px solid ${u===L.value?"var(--interactive-accent)":"var(--background-modifier-border)"}`,borderRadius:"4px",backgroundColor:u===L.value?"var(--interactive-accent)":"transparent",color:u===L.value?"var(--text-on-accent)":"var(--text-muted)",cursor:"pointer",transition:"all 0.15s ease"}},L.label))),s==="tradesJournaled"&&ir.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-faint)",fontStyle:"italic"}},"Tracks lifetime total"),s==="pnl"&&f&&ir.default.createElement("label",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"11px",color:"var(--text-muted)",cursor:"pointer"}},ir.default.createElement("input",{type:"checkbox",checked:m,onChange:L=>g(L.target.checked),style:{margin:0,width:"14px",height:"14px"}}),"Use R-multiples"));if(i&&!(r!=null&&r.dashboardData))return ir.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",padding:"12px",gap:"12px"}},ir.default.createElement(Qe,{width:"70px",height:"11px"}),ir.default.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flex:1,minHeight:0,gap:"8px"}},ir.default.createElement(ae,{width:80,height:28,borderRadius:"8px"}),ir.default.createElement(Qe,{width:"120px",height:"12px"}),ir.default.createElement(ae,{width:"100%",height:8,borderRadius:"4px"}),ir.default.createElement(Qe,{width:"90px",height:"13px"})));if(!h)return ir.default.createElement("div",{onClick:()=>o(!0),role:"button",tabIndex:0,onKeyDown:L=>{(L.key==="Enter"||L.key===" ")&&o(!0)},style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"var(--text-muted)"},"aria-label":"Set a goal"},ir.default.createElement("span",{style:{fontSize:"13px"}},"Click to set a goal"));let S=dYe(h.percentage,h.isComplete),w=uYe(h.percentage,h.isComplete);return ir.default.createElement("div",{onClick:()=>o(!0),role:"button",tabIndex:0,onKeyDown:L=>{(L.key==="Enter"||L.key===" ")&&o(!0)},style:{height:"100%",display:"flex",flexDirection:"column",padding:"12px",gap:"12px",cursor:"pointer",position:"relative"},"aria-label":"Click to change goal"},ir.default.createElement("div",{style:{fontSize:"11px",fontWeight:500,color:"var(--text-faint)",textTransform:"uppercase",letterSpacing:"0.5px"}},(i==null?void 0:i.type)==="pnl"?"P&L Goal":(i==null?void 0:i.type)==="tradesJournaled"?"Trades Goal":"Win Rate Goal"),ir.default.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flex:1,minHeight:0,gap:"8px"}},ir.default.createElement("div",{style:{fontSize:"28px",fontWeight:600,color:w,lineHeight:1.1}},h.label),ir.default.createElement("div",{style:{fontSize:"12px",color:"var(--text-muted)"}},"of ",b()," ",h.periodLabel),ir.default.createElement("div",{style:{width:"100%",height:"8px",backgroundColor:"var(--background-modifier-border)",borderRadius:"4px",overflow:"hidden",marginTop:"4px"}},ir.default.createElement("div",{style:{width:`${h.percentage}%`,height:"100%",backgroundColor:S,borderRadius:"4px",transition:"width 0.3s ease"}})),ir.default.createElement("div",{style:{fontSize:"13px",color:S,fontWeight:500}},h.isComplete?"100% complete":`${Math.floor(h.percentage)}% complete`)),h.isComplete&&ir.default.createElement("div",{style:{position:"absolute",top:"8px",right:"8px",backgroundColor:"var(--color-green)",color:"white",padding:"4px 8px",borderRadius:"4px",fontSize:"10px",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px",display:"flex",alignItems:"center",gap:"4px"}},ir.default.createElement(Fi,{size:12}),"Goal reached"))},mxe=(0,ir.memo)(pYe)});function mYe(e){return!isFinite(e)||e<0?0:e<.75?Math.max(0,e/.75*20):e<1?20+(e-.75)/.25*20:e<1.25?40+(e-1)/.25*15:e<1.5?55+(e-1.25)/.25*15:e<2?70+(e-1.5)/.5*15:e<3?85+(e-2)/1*10:95+Math.min(5,(e-3)/2*5)}function fYe(e,t=!1){return isFinite(e)?t?e<0?Math.max(0,30+e*10):e<.25?30+e/.25*20:e<.5?50+(e-.25)/.25*20:e<1?70+(e-.5)/.5*15:85+Math.min(15,(e-1)/1*15):e<0?Math.max(0,30):e===0?40:Math.min(100,50+Math.log10(1+e)*20):0}function gYe(e){return!isFinite(e)||e<0?100:e>.5?Math.max(0,20-(e-.5)*40):e>.35?20+(.5-e)/.15*20:e>.25?40+(.35-e)/.1*20:e>.15?60+(.25-e)/.1*15:e>.1?75+(.15-e)/.05*10:e>.05?85+(.1-e)/.05*10:95+Math.min(5,(.05-e)/.05*5)}function hYe(e){return!isFinite(e)||e<0?0:e<1?e/1*40:e<2?40+(e-1)/1*20:e<3?60+(e-2)/1*15:e<5?75+(e-3)/2*15:90+Math.min(10,(e-5)/5*10)}function vYe(e){return!isFinite(e)||e<0?0:e<.3?20+e/.3*20:e<.4?40+(e-.3)/.1*15:e<.5?55+(e-.4)/.1*15:e<.6?70+(e-.5)/.1*15:e<.7?85+(e-.6)/.1*10:95+Math.min(5,(e-.7)/.3*5)}function yYe(e){return!isFinite(e)||e<0?0:e<.5?e/.5*20:e<.75?20+(e-.5)/.25*20:e<1?40+(e-.75)/.25*15:e<1.5?55+(e-1)/.5*15:e<2?70+(e-1.5)/.5*15:e<3?85+(e-2)/1*10:95+Math.min(5,(e-3)/2*5)}function bYe(e){return!isFinite(e)||e<0?50:e>3?Math.max(0,30-(e-3)*10):e>2?30+(3-e)/1*20:e>1.5?50+(2-e)/.5*15:e>1?65+(1.5-e)/.5*15:e>.5?80+(1-e)/.5*10:90+Math.min(10,(.5-e)/.5*10)}function xYe(e,t){if(t<=0||e<=0)return 70;let r=e/t;return r>5?20:r>4?40:r>3?55:r>2?70:r>1.5?85:95}function gxe(e){return!isFinite(e)||e<0?50:e>1.5?Math.max(20,30-(e-1.5)*10):e>1?30+(1.5-e)/.5*20:e>.75?50+(1-e)/.25*15:e>.5?65+(.75-e)/.25*15:80+Math.min(20,(.5-e)/.5*20)}function wYe(e,t){if(e<4)return{score:Math.max(10,e*2.5),phase:"insufficient"};let r=t>0?e/t:0,n,i;e<12?(n=40+(e-4)/8*30,i="developing"):e<24?(n=70+(e-12)/12*22,i="established"):(n=92+Math.min(8,(e-24)/24*8),i="established");let a=1;return r<.5?a=.7:r<.75&&(a=.85),{score:Math.round(n*a),phase:i}}function qq(e){if(e.length<2)return 0;let t=e.reduce((a,o)=>a+o,0)/e.length;if(t===0)return 0;let n=e.map(a=>Math.pow(a-t,2)).reduce((a,o)=>a+o,0)/e.length,i=Math.sqrt(n);return Math.abs(i/t)}function kYe(e){if(e.length===0)return{maxLosingStreak:0,avgStreak:0};let t=0,r=null,n=0,i=[],a=[...e].sort((s,l)=>new Date(s.entryTime).getTime()-new Date(l.entryTime).getTime());for(let s of a){let c=s.pnl>0?"win":"loss";c===r?t++:(t>0&&(i.push(t),r==="loss"&&(n=Math.max(n,t))),t=1,r=c)}t>0&&(i.push(t),r==="loss"&&(n=Math.max(n,t)));let o=i.length>0?i.reduce((s,l)=>s+l,0)/i.length:1;return{maxLosingStreak:n,avgStreak:o}}function SYe(e){if(e.length===0)return{activeWeeks:0,totalWeeks:0};let t=e.map(s=>new Date(s.entryTime).getTime()),r=Math.min(...t),n=Math.max(...t),i=10080*60*1e3,a=Math.max(1,Math.ceil((n-r)/i)),o=new Set;for(let s of e){let l=new Date(s.entryTime),c=new Date(l);c.setDate(l.getDate()+4-(l.getDay()||7));let d=new Date(c.getFullYear(),0,1),u=Math.ceil(((c.getTime()-d.getTime())/864e5+1)/7);o.add(`${c.getFullYear()}-W${u}`)}return{activeWeeks:o.size,totalWeeks:a}}function TYe(e){if(e.length===0)return{maxDrawdown:0,peakEquity:0};let t=[...e].sort((a,o)=>new Date(a.entryTime).getTime()-new Date(o.entryTime).getTime()),r=0,n=0,i=0;for(let a of t){n+=a.pnl,n>r&&(r=n);let o=r-n;o>i&&(i=o)}return{maxDrawdown:i,peakEquity:r}}function hxe(e){let t=e.filter(Z=>Z.tradeStatus!=="OPEN"&&!Z._originalPnlWasNull&&Z.pnl!==void 0&&Z.pnl!==null),r=t.length,{activeWeeks:n,totalWeeks:i}=SYe(t),a=i>0?n/i:0,o=wYe(n,i),s=o.phase;if(r<5||n<4)return{compositeScore:0,axisScores:{profitability:0,riskManagement:0,execution:0,consistency:0,returnConsistency:0,experience:o.score},breakdown:CYe(n,i,a,o.score),phase:"insufficient",phaseWeeks:n,tradeCount:r};let l=t.filter(Z=>Z.pnl>0),c=t.filter(Z=>Z.pnl<0),d=t.reduce((Z,ne)=>Z+ne.pnl,0),u=l.reduce((Z,ne)=>Z+ne.pnl,0),p=Math.abs(c.reduce((Z,ne)=>Z+ne.pnl,0)),m=p>0?u/p:u>0?999:0,g=r>0?l.length/r:0,f=l.length>0?u/l.length:0,v=c.length>0?p/c.length:0,h=v>0?f/v:f>0?999:0,y=r>0?d/r:0,b=t.filter(Z=>Z.rMultiple!==void 0&&Z.rMultiple!==null),k=b.length>r*.5,x=0;k&&(x=b.reduce((Z,ne)=>Z+(ne.rMultiple||0),0)/b.length);let{maxDrawdown:S,peakEquity:w}=TYe(t),C=w>0?S/w:0,D=S>0?d/S:d>0?999:0,P=t.map(Z=>Z.pnl),M=qq(P),z=kYe(t),A=l.map(Z=>Z.pnl),I=c.map(Z=>Math.abs(Z.pnl)),L=A.length>=3?qq(A):1,E=I.length>=3?qq(I):1,T=mYe(m),$=fYe(k?x:y,k),_=T*.6+$*.4,B=gYe(C),W=hYe(D),N=B*.5+W*.5,U=vYe(g),j=yYe(h),R=U*.4+j*.6;g<.4&&y>0&&h>2&&(R=Math.min(100,R+10));let O=bYe(M),H=xYe(z.maxLosingStreak,z.avgStreak),q=O*.6+H*.4,V=gxe(L),J=gxe(E),K=V*.5+J*.5,G=o.score,X={profitability:Math.round(_),riskManagement:Math.round(N),execution:Math.round(R),consistency:Math.round(q),returnConsistency:Math.round(K),experience:G},te=Math.round(X.profitability*lg.profitability+X.riskManagement*lg.riskManagement+X.execution*lg.execution+X.consistency*lg.consistency+X.returnConsistency*lg.returnConsistency+X.experience*lg.experience),re={profitability:{profitFactor:m,profitFactorScore:Math.round(T),expectancy:k?x:y,expectancyScore:Math.round($)},riskManagement:{maxDrawdown:S,maxDrawdownPercent:C,maxDrawdownScore:Math.round(B),recoveryFactor:D,recoveryFactorScore:Math.round(W)},execution:{winRate:g,winRateScore:Math.round(U),avgWinLossRatio:h,avgWinLossRatioScore:Math.round(j)},consistency:{returnStabilityCV:M,returnStabilityScore:Math.round(O),streakRatio:z.avgStreak>0?z.maxLosingStreak/z.avgStreak:0,streakStabilityScore:Math.round(H)},returnConsistency:{rPlusCV:L,rPlusScore:Math.round(V),rMinusCV:E,rMinusScore:Math.round(J)},experience:{activeWeeks:n,totalWeeks:i,consistencyRatio:a,score:G}};return{compositeScore:te,axisScores:X,breakdown:re,phase:s,phaseWeeks:n,tradeCount:r}}function CYe(e,t,r,n){return{profitability:{profitFactor:0,profitFactorScore:0,expectancy:0,expectancyScore:0},riskManagement:{maxDrawdown:0,maxDrawdownPercent:0,maxDrawdownScore:0,recoveryFactor:0,recoveryFactorScore:0},execution:{winRate:0,winRateScore:0,avgWinLossRatio:0,avgWinLossRatioScore:0},consistency:{returnStabilityCV:0,returnStabilityScore:0,streakRatio:0,streakStabilityScore:0},returnConsistency:{rPlusCV:0,rPlusScore:0,rMinusCV:0,rMinusScore:0},experience:{activeWeeks:e,totalWeeks:t,consistencyRatio:r,score:n}}}function mO(e){return e<30?{label:"Poor",color:"var(--color-red, #e53935)"}:e<50?{label:"Below Average",color:"var(--color-orange, #fb8c00)"}:e<70?{label:"Average",color:"var(--color-yellow, #fdd835)"}:e<90?{label:"Strong",color:"var(--color-green, #43a047)"}:{label:"Excellent",color:"var(--interactive-accent)"}}function vxe(e){switch(e){case"insufficient":return"var(--text-faint)";case"developing":return"var(--color-yellow)";case"established":return"var(--interactive-accent)"}}function Vq(e){switch(e){case"insufficient":return"Insufficient Data";case"developing":return"Developing";case"established":return"Established"}}function LP(e){switch(e){case"profitability":return"Profitability";case"riskManagement":return"Risk Management";case"execution":return"Execution";case"consistency":return"Consistency";case"returnConsistency":return"Return Consistency";case"experience":return"Experience"}}function yxe(e){switch(e){case"profitability":return"Measures profit factor and expectancy per trade";case"riskManagement":return"Measures max drawdown control and recovery ability";case"execution":return"Measures win rate and average win/loss ratio";case"consistency":return"Measures return stability and streak control";case"returnConsistency":return"Measures uniformity of take-profits and stop-losses";case"experience":return"Measures active trading weeks and consistency"}}var lg,bxe=F(()=>{lg={profitability:.2,riskManagement:.25,execution:.15,consistency:.15,returnConsistency:.1,experience:.15}});var ot,PYe,xxe,wxe=F(()=>{ot=Y(Q());Ot();ip();ap();fc();bxe();us();ps();PYe=()=>{let{dashboardData:e}=ua(),[t,r]=(0,ot.useState)(!1),[n,i]=(0,ot.useState)(null),a=(0,ot.useMemo)(()=>!(e!=null&&e.trades)||e.trades.length===0?null:hxe(e.trades),[e==null?void 0:e.trades]),o=(0,ot.useMemo)(()=>a?["riskManagement","profitability","execution","returnConsistency","consistency","experience"].map(d=>({axis:LP(d).replaceAll(" ",`
`),axisKey:d,value:a.axisScores[d],fullMark:100,weight:lg[d]*100})):[],[a]);if(!e)return ot.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",padding:"12px 12px 8px 12px",gap:"0px"}},ot.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},ot.default.createElement(Qe,{width:"90px",height:"11px"}),ot.default.createElement(ae,{width:36,height:12,borderRadius:"4px"})),ot.default.createElement("div",{style:{flex:1,minHeight:"120px",display:"flex",alignItems:"center",justifyContent:"center"}},ot.default.createElement("svg",{width:"120",height:"120",viewBox:"0 0 120 120"},ot.default.createElement("polygon",{points:"60,10 105,35 105,85 60,110 15,85 15,35",className:"skeleton-shimmer",style:{fill:"var(--background-modifier-border)",opacity:.5}}),ot.default.createElement("polygon",{points:"60,30 85,45 85,75 60,90 35,75 35,45",style:{fill:"var(--background-primary)",opacity:.3}}))),ot.default.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",marginTop:"-4px"}},ot.default.createElement(ae,{width:56,height:36,borderRadius:"8px"}),ot.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"6px"}},ot.default.createElement(Qe,{width:"60px",height:"11px"}),ot.default.createElement(Qe,{width:"20px",height:"10px"}))));if(!a)return ot.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"12px",gap:"8px"}},ot.default.createElement("span",{style:{fontSize:"11px",fontWeight:500,color:"var(--text-faint)",textTransform:"uppercase",letterSpacing:"0.5px"}},"Trading Score"),ot.default.createElement("span",{style:{fontSize:"13px",color:"var(--text-muted)"}},"No trade data"));if(a.phase==="insufficient"){let u=Math.min(a.phaseWeeks,4),p=u/4*100,m=Math.max(0,4-u),g=Math.max(0,5-a.tradeCount);return ot.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",padding:"12px",gap:"8px"}},ot.default.createElement("div",{style:{fontSize:"11px",fontWeight:500,color:"var(--text-faint)",textTransform:"uppercase",letterSpacing:"0.5px"}},"Trading Score"),ot.default.createElement("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"12px"}},ot.default.createElement("div",{style:{position:"relative",width:"80px",height:"80px"}},ot.default.createElement("svg",{width:"80",height:"80",viewBox:"0 0 80 80",style:{transform:"rotate(-90deg)"}},ot.default.createElement("circle",{cx:"40",cy:"40",r:"34",fill:"none",stroke:"var(--background-modifier-border)",strokeWidth:"6"}),ot.default.createElement("circle",{cx:"40",cy:"40",r:"34",fill:"none",stroke:"var(--interactive-accent)",strokeWidth:"6",strokeLinecap:"round",strokeDasharray:`${p/100*213.6} 213.6`,style:{transition:"stroke-dasharray 0.5s ease"}})),ot.default.createElement("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center"}},ot.default.createElement("div",{style:{fontSize:"18px",fontWeight:600,color:"var(--text-normal)",lineHeight:1}},u),ot.default.createElement("div",{style:{fontSize:"10px",color:"var(--text-faint)"}},"of ",4))),ot.default.createElement("div",{style:{textAlign:"center"}},ot.default.createElement("div",{style:{fontSize:"12px",color:"var(--text-muted)",marginBottom:"4px"}},a.phaseWeeks<4?u===0?"Start trading to unlock your score":u===1?"1 week down, keep going!":`${m} more week${m!==1?"s":""} to unlock`:g>0?`${g} more trade${g!==1?"s":""} to unlock`:"Collect a bit more data to unlock your score"),ot.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-faint)"}},a.tradeCount," trade",a.tradeCount!==1?"s":""," logged"))))}let s=vxe(a.phase),l=mO(a.compositeScore);return t?ot.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",padding:"12px",gap:"8px",overflow:"hidden"}},ot.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},ot.default.createElement("span",{style:{fontSize:"11px",fontWeight:500,color:"var(--text-faint)",textTransform:"uppercase",letterSpacing:"0.5px"}},"Score Breakdown"),ot.default.createElement("button",{onClick:()=>r(!1),style:{background:"none",border:"none",padding:"4px",cursor:"pointer",color:"var(--text-muted)",display:"flex",alignItems:"center",justifyContent:"center"},"aria-label":"Close breakdown"},ot.default.createElement(La,{size:14}))),ot.default.createElement("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:"6px",overflow:"auto"}},Object.keys(a.axisScores).map(c=>{let d=a.axisScores[c],u=mO(d),p=Math.round(lg[c]*100),m=n===c;return ot.default.createElement("div",{key:c,style:{display:"flex",flexDirection:"column",gap:"2px",position:"relative",cursor:"help"},tabIndex:0,role:"button","aria-label":`${LP(c)}: ${d} points, ${p}% weight`,onMouseEnter:()=>i(c),onMouseLeave:()=>i(null),onFocus:()=>i(c),onBlur:()=>i(null)},ot.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:"11px"}},ot.default.createElement("span",{style:{color:"var(--text-normal)"}},LP(c)," ",ot.default.createElement("span",{style:{color:"var(--text-faint)"}},"(",p,"%)")),ot.default.createElement("span",{style:{color:u.color,fontWeight:500}},d)),ot.default.createElement("div",{style:{height:"4px",background:"var(--background-modifier-border)",borderRadius:"2px",overflow:"hidden"}},ot.default.createElement("div",{style:{height:"100%",width:`${d}%`,background:u.color,borderRadius:"2px",transition:"width 0.3s ease"}})),m&&ot.default.createElement("div",{style:{position:"absolute",left:0,top:"100%",marginTop:"4px",background:"var(--background-primary)",border:"1px solid var(--background-modifier-border)",borderRadius:"6px",padding:"8px 10px",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",zIndex:100,maxWidth:"200px",fontSize:"11px",color:"var(--text-muted)",lineHeight:1.4,pointerEvents:"none"}},yxe(c)))})),ot.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",paddingTop:"8px",borderTop:"1px solid var(--background-modifier-border)"}},ot.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px"}},ot.default.createElement("span",{style:{fontSize:"18px",fontWeight:600,color:l.color}},a.compositeScore),ot.default.createElement("span",{style:{fontSize:"11px",color:s,fontWeight:500}},Vq(a.phase))),ot.default.createElement("span",{style:{fontSize:"10px",color:"var(--text-faint)"}},a.tradeCount," trades"))):ot.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",padding:"12px 12px 8px 12px",gap:"0px",cursor:"pointer"},onClick:()=>r(!0),role:"button",tabIndex:0,onKeyDown:c=>{(c.key==="Enter"||c.key===" ")&&(c.preventDefault(),r(!0))}},ot.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},ot.default.createElement("span",{style:{fontSize:"11px",fontWeight:500,color:"var(--text-faint)",textTransform:"uppercase",letterSpacing:"0.5px"}},"Trading Score"),ot.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"4px",color:"var(--text-faint)"}},ot.default.createElement(Js,{size:12}),ot.default.createElement(Nu,{size:12}))),ot.default.createElement("div",{style:{flex:1,minHeight:"120px",minWidth:0,width:"100%"}},ot.default.createElement(Wo,{height:"100%",width:"100%"},ot.default.createElement(BH,{data:o,margin:{top:5,right:25,bottom:0,left:25}},ot.default.createElement(F2,{stroke:"var(--background-modifier-border)",strokeOpacity:.6}),ot.default.createElement(_2,{dataKey:"axis",tick:{fill:"var(--text-faint)",fontSize:9},tickLine:!1}),ot.default.createElement(z2,{angle:90,domain:[0,100],tick:!1,axisLine:!1}),ot.default.createElement(aF,{name:"Score",dataKey:"value",stroke:l.color,fill:l.color,fillOpacity:a.phase==="developing"?.3:.4,strokeWidth:a.phase==="developing"?1.5:2,strokeDasharray:a.phase==="developing"?"4 2":void 0}),ot.default.createElement(ho,{content:({active:c,payload:d})=>{if(!c||!d||d.length===0)return null;let u=d[0].payload,p=mO(u.value);return ot.default.createElement("div",{style:{background:"var(--background-primary)",border:"1px solid var(--background-modifier-border)",borderRadius:"6px",padding:"8px 12px",boxShadow:"0 2px 8px rgba(0,0,0,0.15)"}},ot.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-muted)",marginBottom:"4px"}},LP(u.axisKey)),ot.default.createElement("div",{style:{fontSize:"16px",fontWeight:600,color:p.color}},u.value),ot.default.createElement("div",{style:{fontSize:"10px",color:"var(--text-faint)",marginTop:"2px"}},"Weight: ",u.weight,"%"))}})))),ot.default.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"2px",marginTop:"-4px"}},ot.default.createElement("div",{style:{fontSize:"36px",fontWeight:700,color:l.color,lineHeight:1}},a.compositeScore),ot.default.createElement("div",{style:{display:"flex",alignItems:"baseline",gap:"6px"}},ot.default.createElement("span",{style:{fontSize:"11px",color:s,fontWeight:500}},Vq(a.phase)),ot.default.createElement("span",{style:{fontSize:"10px",color:"var(--text-faint)"}},"\xB7 ",a.phaseWeeks,"w"))))},xxe=(0,ot.memo)(PYe)});function DYe(e){switch(e){case"month":return"This Month";case"quarter":return"This Quarter";case"year":return"This Year";default:return"All Time"}}function EYe(e){switch(e){case"month":return 30;case"quarter":return 13;case"year":return 12;default:return 24}}var er,IYe,kxe,Sxe=F(()=>{er=Y(Q());Ot();Er();pk();qt();us();ps();Zs();IYe=({plugin:e})=>{var A;let{currency:t}=ct(),r=MP(),[n,i]=(0,er.useState)([]),[a,o]=(0,er.useState)(!0),[s,l]=(0,er.useState)(null),c=(0,er.useRef)(!0);(0,er.useEffect)(()=>(c.current=!0,()=>{c.current=!1}),[]);let d=(r==null?void 0:r.period)||"month",u=(r==null?void 0:r.dateRange)||[null,null],p=(0,er.useCallback)(()=>{e.viewManager.openAccountDashboardView()},[e]),m=(0,er.useCallback)(async()=>{if(c.current)try{o(!0),l(null);let I=0;for(;!e.accountPageService&&I<5;){if(!c.current)return;await new Promise(E=>setTimeout(E,300)),I++}if(!c.current)return;if(!e.accountPageService)throw new Error("Account service not available");let L=await e.accountPageService.getAllEnhancedAccounts();if(!c.current)return;i(L),o(!1)}catch(I){if(!c.current)return;l(I instanceof Error?I.message:"Failed to load accounts"),o(!1)}},[e]);(0,er.useEffect)(()=>{m()},[m]),Xe("account:changed",m),Xe("trade:changed",m);let g=(0,er.useMemo)(()=>{var q;if(!n||n.length===0)return null;let I=((q=e.settings.account)==null?void 0:q.excludedAccountTypes)||[],L=n.filter(V=>{let J=(V.accountType||"").toLowerCase();return!I.some(K=>K.toLowerCase()===J)});if(L.length===0)return null;let E=L.reduce((V,J)=>V+(J.currentBalance||0),0),T=new Date;T.setHours(23,59,59,999);let $,_=EYe(d);u[0]?$=new Date(u[0]):($=new Date(T),$.setFullYear($.getFullYear()-2)),$.setHours(0,0,0,0);let B=Math.ceil((T.getTime()-$.getTime())/(1e3*60*60*24))+1,W=Math.max(1,Math.floor(B/_)),N=Math.min(_,B),U=[];for(let V=0;V<N;V++){let J=new Date($);if(J.setDate(J.getDate()+V*W),J>T)break;let K=J.toISOString().split("T")[0];U.push({date:K,total:0})}for(let V of L){let J=V.dailyBalances||[],K=new Map;for(let X of J){let te=new Date(X.date).toISOString().split("T")[0];K.set(te,X.balance)}let G=Array.from(K.keys()).sort();for(let X of U){let te=V.initialBalance||0;for(let re of G)if(re<=X.date)te=K.get(re);else break;X===U[U.length-1]&&(te=V.currentBalance||te),X.total+=te}}let j=U.map(V=>V.total),R=j.length>0?j[0]:E,O=E-R,H=R!==0?O/R*100:0;return{totalAUM:E,previousAUM:R,changeAmount:O,changePercent:H,accountCount:L.length,sparklineData:j,periodLabel:DYe(d)}},[n,(A=e.settings.account)==null?void 0:A.excludedAccountTypes,d,u]),f=(I,L)=>{if(I.length<2)return null;let E=40,T=4,$=Math.min(...I),B=Math.max(...I)-$||1,W=100,N=I.map((j,R)=>{let O=T+R/(I.length-1)*(W-2*T),H=E-T-(j-$)/B*(E-2*T);return`${O},${H}`}).join(" "),U=L?"var(--color-green)":"var(--color-red)";return er.default.createElement("svg",{viewBox:`0 0 ${W} ${E}`,preserveAspectRatio:"none",style:{display:"block",width:"100%",height:`${E}px`}},er.default.createElement("polyline",{points:N,fill:"none",stroke:U,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",vectorEffect:"non-scaling-stroke"}))};if(a)return er.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",padding:"12px",gap:"8px"}},er.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},er.default.createElement(Qe,{width:"30px",height:"11px"}),er.default.createElement(Qe,{width:"70px",height:"11px"})),er.default.createElement("div",{style:{flex:1,minHeight:0,display:"flex",alignItems:"center",padding:"4px 0"}},er.default.createElement("svg",{width:"100%",height:"40",viewBox:"0 0 100 40",preserveAspectRatio:"none"},er.default.createElement("path",{d:"M0,30 Q25,20 50,25 T100,15",fill:"none",stroke:"var(--background-modifier-border)",strokeWidth:"2",className:"skeleton-shimmer",style:{opacity:.5}}))),er.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end"}},er.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"4px"}},er.default.createElement(ae,{width:100,height:28,borderRadius:"8px"}),er.default.createElement(Qe,{width:"70px",height:"11px"})),er.default.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"4px"}},er.default.createElement(ae,{width:60,height:14,borderRadius:"4px"}),er.default.createElement(Qe,{width:"50px",height:"11px"}))));if(s)return er.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"8px"}},er.default.createElement("span",{style:{fontSize:"11px",fontWeight:500,color:"var(--text-faint)",textTransform:"uppercase",letterSpacing:"0.5px"}},"AUM"),er.default.createElement("span",{style:{fontSize:"13px",color:"var(--text-muted)"}},"Unable to load"));if(!g)return er.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"8px"}},er.default.createElement("span",{style:{fontSize:"11px",fontWeight:500,color:"var(--text-faint)",textTransform:"uppercase",letterSpacing:"0.5px"}},"AUM"),er.default.createElement("span",{style:{fontSize:"13px",color:"var(--text-muted)"}},"No accounts"));let{totalAUM:v,changeAmount:h,changePercent:y,accountCount:b,sparklineData:k,periodLabel:x}=g,S=h>=0,w=Math.abs(y)<.1,C=ye(v,!1,t),D=`${S?"+":""}${y.toFixed(1)}%`,P=ye(h,!0,t),M=w?qv:S?$c:Qv,z=w?"var(--text-muted)":S?"var(--color-green)":"var(--color-red)";return er.default.createElement("div",{onClick:p,className:"journalit-aum-widget",style:{height:"100%",display:"flex",flexDirection:"column",padding:"12px",gap:"8px",cursor:"pointer"}},er.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},er.default.createElement("span",{className:"journalit-aum-label",style:{fontSize:"11px",fontWeight:500,color:"var(--text-faint)",textTransform:"uppercase",letterSpacing:"0.5px"}},"AUM"),er.default.createElement("span",{style:{fontSize:"11px",color:"var(--text-faint)"}},x)),er.default.createElement("div",{style:{flex:1,minHeight:0,display:"flex",alignItems:"center",padding:"4px 0"}},f(k,S)),er.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end"}},er.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"2px"}},er.default.createElement("div",{style:{fontSize:"28px",fontWeight:600,color:"var(--text-normal)",lineHeight:1}},C),er.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-muted)"}},b," account",b!==1?"s":"")),er.default.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"2px"}},er.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"4px"}},er.default.createElement(M,{size:14,style:{color:z}}),er.default.createElement("span",{style:{fontSize:"14px",fontWeight:500,color:z}},D)),er.default.createElement("div",{style:{fontSize:"11px",color:z}},P))))},kxe=(0,er.memo)(IYe)});function Txe(e){if(e==null)return"null";if(typeof e!="object")return JSON.stringify(e);let t={};return Object.keys(e).sort().forEach(r=>{t[r]=typeof e[r]=="object"&&e[r]!==null?Txe(e[r]):e[r]}),JSON.stringify(t)}function Cxe(e,t){var m,g;if(!e||e.length===0)return{totalAccounts:0,totalAUM:0,totalGrowthAmount:0,totalGrowthPercent:0,totalWithdrawals:0,totalTrades:0};let r=((m=t==null?void 0:t.account)==null?void 0:m.excludedAccountTypes)||["archived"],n=((g=t==null?void 0:t.account)==null?void 0:g.includeWithdrawalsFromExcluded)||{archived:!0},i=e.filter(f=>f.accountType&&!r.includes(f.accountType.toLowerCase())),a=[...i,...e.filter(f=>f.accountType&&r.includes(f.accountType.toLowerCase())&&n[f.accountType.toLowerCase()])],o=i.length,s=i.reduce((f,v)=>f+v.currentBalance,0),l=i.reduce((f,v)=>f+v.initialBalance,0),c=s-l,d=l>0?c/l*100:0,u=a.reduce((f,v)=>{let h=v.transactions.filter(y=>y.type==="withdrawal"||y.type==="deposit"&&y.amount<0).reduce((y,b)=>y+Math.abs(b.amount),0);return f+h},0),p=i.reduce((f,v)=>f+v.metrics.totalTrades,0);return{totalAccounts:o,totalAUM:s,totalGrowthAmount:c,totalGrowthPercent:d,totalWithdrawals:u,totalTrades:p}}function Pxe(e,t){var m;if(!e||e.length===0)return[];let r=e.map(g=>g.id).sort().join(","),n=Txe(t||{}),i=`${r}:${n}`,a=NP.get(i);if(a)return a.data;let o=((m=t==null?void 0:t.account)==null?void 0:m.excludedAccountTypes)||["archived"],s=e.filter(g=>g.accountType&&!o.includes(g.accountType.toLowerCase()));if(s.length===0)return[];let l=new Map,c=new Map;s.forEach(g=>{var b;let f=new Map,v=new Date(g.createdDate).toISOString().split("T")[0];l.has(v)||l.set(v,{depositsForDay:0,withdrawalsForDay:0}),l.get(v).accountCreated=g.id;let h=[...g.transactions].sort((k,x)=>new Date(k.date).getTime()-new Date(x.date).getTime()),y=g.initialBalance;if(h.forEach(k=>{let x=new Date(k.date).toISOString().split("T")[0];y=k.balanceAfter,f.set(x,y),l.has(x)||l.set(x,{depositsForDay:0,withdrawalsForDay:0});let S=l.get(x);k.type==="deposit"&&k.amount>0?S.depositsForDay+=k.amount:(k.type==="withdrawal"||k.type==="deposit"&&k.amount<0)&&(S.withdrawalsForDay+=Math.abs(k.amount))}),((b=g.accountType)==null?void 0:b.toLowerCase())==="archived"&&h.length>0){let k=h[h.length-1],x=new Date(k.date).toISOString().split("T")[0];l.has(x)||l.set(x,{depositsForDay:0,withdrawalsForDay:0}),l.get(x).accountArchived=g.id}c.set(g.id,f)});let d=[...l.keys()].sort(),u=[],p=new Map;if(s.forEach(g=>{p.set(g.id,g.initialBalance)}),d.forEach(g=>{let f=new Date(g),v=l.get(g);s.forEach(y=>{if(new Date(y.createdDate)<=f){let b=c.get(y.id),k=y.initialBalance;for(let[x,S]of b)if(x<=g)k=S;else break;p.set(y.id,k)}});let h=0;for(let[y,b]of p){let k=s.find(x=>x.id===y);new Date(k.createdDate)<=f&&(h+=b)}u.push({date:zt(f,vn()),rawDate:f,balance:h,isDeposit:v.depositsForDay>0,depositAmount:v.depositsForDay>0?v.depositsForDay:void 0,isWithdrawal:v.withdrawalsForDay>0,withdrawalAmount:v.withdrawalsForDay>0?v.withdrawalsForDay:void 0,accountCreated:v.accountCreated,accountArchived:v.accountArchived})}),NP.size>=MYe){let g=NP.keys().next().value;NP.delete(g)}return NP.set(i,{settings:t,data:u}),u}function Dxe(e){if(!e||e.length===0)return{};let t=e.reduce((n,i)=>{var o;let a=((o=i.accountType)==null?void 0:o.toLowerCase())||"unknown";return n[a]||(n[a]=[]),n[a].push(i),n},{}),r={};return Object.entries(t).forEach(([,n])=>{let i=n[0].accountType;r[i]=n}),r}function fO(e){return e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()).join(" ")}function Exe(e){let r=Math.abs(new Date().getTime()-new Date(e).getTime()),n=Math.floor(r/(1e3*60*60*24));if(n<30)return`${n} day${n===1?"":"s"}`;if(n<365){let i=Math.floor(n/30);return`${i} month${i===1?"":"s"}`}else{let i=Math.floor(n/365),a=Math.floor(n%365/30);return a===0?`${i} year${i===1?"":"s"}`:`${i}y ${a}m`}}function Ixe(e){if(e.drawdownType==="none")return 0;if(e.drawdownType==="manual"&&e.currentDrawdownSnapshot){let n=e.currentDrawdownSnapshot.drawdownLimit;if(n<=0||e.initialBalance<=n)return 0;let i=e.currentBalance-n,a=e.drawdownAmount>0?i/e.drawdownAmount*100:0;return Math.min(100,Math.max(0,a))}if(e.drawdownAmount<=0)return 0;let r=(e.currentBalance-e.maxDrawdownReached)/e.drawdownAmount*100;return Math.min(100,Math.max(0,r))}function Mxe(e,t="USD"){return!e.monthlyCost||e.monthlyCost<=0?"N/A":`${Uc(e.monthlyCost,t)}/month`}function AYe(e){var s;if(!e.monthlyCost||e.monthlyCost<=0)return 0;let t=new Date(e.createdDate),r;if(((s=e.accountType)==null?void 0:s.toLowerCase())==="archived")if(e.transactions.length>0){let l=[...e.transactions].sort((c,d)=>new Date(c.date).getTime()-new Date(d.date).getTime());r=new Date(l[l.length-1].date)}else r=t;else r=new Date;let n=Math.abs(r.getTime()-t.getTime()),i=Math.floor(n/(1e3*60*60*24)),a=Math.floor(i/30),o=Math.max(1,a);return e.monthlyCost*o}function Axe(e,t="USD"){let r=AYe(e);return r<=0?"N/A":Uc(r,t)}function gO(e){if(!e.hasProfitTarget||e.profitTarget<=0)return 0;let t=e.profitTargetType==="percentage"?e.initialBalance*e.profitTarget/100:e.profitTarget,n=e.metrics.totalPnL/t*100;return Math.min(100,Math.max(0,n))}function Lxe(e){return e.transactions.filter(t=>t.type==="withdrawal"||t.type==="deposit"&&t.amount<0).reduce((t,r)=>t+Math.abs(r.amount),0)}function mk(e){if(e.drawdownType==="none")return 0;if(e.drawdownType==="manual"&&e.currentDrawdownSnapshot){let n=e.currentBalance-e.currentDrawdownSnapshot.drawdownLimit,i=Math.min(e.drawdownAmount,Math.max(0,e.drawdownAmount-n));if(e.drawdownAmount<=0)return 0;let a=i/e.drawdownAmount*100;return Math.min(100,Math.max(0,a))}if(e.drawdownAmount<=0)return 0;let r=(e.initialBalance-e.currentBalance)/e.drawdownAmount*100;return Math.min(100,Math.max(0,r))}function hO(e,t){if(!e||e.length===0)return{aumAmount:0,aumWeightPercent:0,totalWithdrawals:0,accountCount:0,totalTrades:0,totalGrowthAmount:0,totalGrowthPercent:0};let r=e.reduce((d,u)=>d+u.currentBalance,0),n=t>0?r/t*100:0,i=e.reduce((d,u)=>{let p=u.transactions.filter(m=>m.type==="withdrawal"||m.type==="deposit"&&m.amount<0).reduce((m,g)=>m+Math.abs(g.amount),0);return d+p},0),a=e.length,o=e.reduce((d,u)=>d+u.metrics.totalTrades,0),s=e.reduce((d,u)=>d+u.initialBalance,0),l=r-s,c=s>0?l/s*100:0;return{aumAmount:r,aumWeightPercent:n,totalWithdrawals:i,accountCount:a,totalTrades:o,totalGrowthAmount:l,totalGrowthPercent:c}}var NP,MYe,cg=F(()=>{Ns();qt();_t();As();NP=new Map,MYe=10});function FYe(e){return e>=LYe?"warning":e>=NYe?"caution":"safe"}function OYe(e){switch(e){case"warning":return"var(--color-red)";case"caution":return"var(--color-yellow)";case"safe":return"var(--color-green)"}}function zYe(e){let t=Math.abs(e).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0});return e<0?`-$${t}`:`$${t}`}var jr,Nxe,LYe,NYe,vO,jYe,_Ye,Fxe,Oxe=F(()=>{jr=Y(Q());Ot();Ns();us();ps();Zs();cg();Nxe=3,LYe=50,NYe=30;vO=20,jYe=({data:e,onAccountClick:t})=>{let r=e.accounts.slice(0,Nxe);return jr.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",padding:"12px",gap:"8px"}},jr.default.createElement("div",{style:{fontSize:"11px",fontWeight:500,color:"var(--text-faint)",textTransform:"uppercase",letterSpacing:"0.5px"}},"Drawdown"),jr.default.createElement("div",{style:{flex:1,minHeight:0,display:"flex",flexDirection:"column",gap:"6px",overflow:"hidden"}},r.map(n=>{let i=OYe(n.status),a=n.drawdownPercent>=100?Math.ceil(n.drawdownPercent):Math.floor(n.drawdownPercent),o=Math.min(vO,Math.floor(n.drawdownPercent/100*vO)),s=n.drawdownPercent>=100;return jr.default.createElement("div",{key:n.name,onClick:()=>t(n.accountName),className:"journalit-drawdown-account-row",style:{display:"flex",flexDirection:"column",gap:"4px",cursor:"pointer"}},jr.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline"}},jr.default.createElement("span",{className:"journalit-drawdown-account-name"},n.name),jr.default.createElement("span",{style:{fontSize:s?"12px":"15px",fontWeight:600,color:i,textTransform:s?"uppercase":"none",letterSpacing:s?"0.5px":"normal"}},s?"Breached":`${a}%`)),jr.default.createElement("svg",{width:"100%",height:"8",viewBox:`0 0 ${vO*10} 8`,preserveAspectRatio:"none",style:{display:"block"}},Array.from({length:vO}).map((l,c)=>jr.default.createElement("rect",{key:c,x:c*10,y:0,width:8,height:8,fill:c<o?i:"var(--text-faint)",opacity:c<o?.85:.2}))),jr.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-faint)"}},zYe(n.remaining)," remaining"))})))},_Ye=({plugin:e})=>{let[t,r]=(0,jr.useState)([]),[n,i]=(0,jr.useState)(!0),[a,o]=(0,jr.useState)(null),s=(0,jr.useCallback)(d=>{e.viewManager.openAccountPageView(d)},[e]),l=(0,jr.useCallback)(async()=>{try{i(!0),o(null);let d=0;for(;!e.accountPageService&&d<5;)await new Promise(p=>setTimeout(p,300)),d++;if(!e.accountPageService)throw new Error("Account service not available");let u=await e.accountPageService.getAllEnhancedAccounts();r(u),i(!1)}catch(d){o(d instanceof Error?d.message:"Failed to load accounts"),i(!1)}},[e]);(0,jr.useEffect)(()=>{l()},[l]),Xe("account:changed",l),Xe("trade:changed",l);let c=(0,jr.useMemo)(()=>{if(!t||t.length===0)return null;let d=t.filter(m=>{var g;return m.drawdownType!=="none"&&m.drawdownAmount>0&&((g=m.accountType)==null?void 0:g.toLowerCase())!=="archived"});if(d.length===0)return null;let u=d.map(m=>{let g=mk(m),f=m.drawdownAmount,v=g/100*f,h=Math.max(0,f-v),y=FYe(g),b=m.accountName||m.name||"Unknown";return{name:b,accountName:b,drawdownPercent:g,drawdownUsed:v,drawdownLimit:f,remaining:h,status:y}});u.sort((m,g)=>g.drawdownPercent-m.drawdownPercent);let p=u.slice(0,Nxe);return{accounts:p,warningCount:p.filter(m=>m.status==="warning").length,cautionCount:p.filter(m=>m.status==="caution").length}},[t]);return n?jr.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",padding:"12px",gap:"8px"}},jr.default.createElement(Qe,{width:"70px",height:"11px"}),jr.default.createElement("div",{style:{flex:1,minHeight:0,display:"flex",flexDirection:"column",gap:"6px",overflow:"hidden"}},[1,2,3].map(d=>jr.default.createElement("div",{key:d,style:{display:"flex",flexDirection:"column",gap:"4px"}},jr.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline"}},jr.default.createElement(Qe,{width:"80px",height:"12px"}),jr.default.createElement(Qe,{width:"35px",height:"15px"})),jr.default.createElement(ae,{width:"100%",height:8,borderRadius:"0px"}),jr.default.createElement(Qe,{width:"100px",height:"11px"}))))):a?jr.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"8px"}},jr.default.createElement("span",{style:{fontSize:"11px",fontWeight:500,color:"var(--text-faint)",textTransform:"uppercase"}},"Drawdown"),jr.default.createElement("span",{style:{fontSize:"13px",color:"var(--text-muted)"}},"Unable to load")):c?jr.default.createElement(jYe,{data:c,onAccountClick:s}):jr.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:"8px"}},jr.default.createElement(Kv,{size:24,style:{color:"var(--text-muted)",opacity:.5}}),jr.default.createElement("span",{style:{fontSize:"11px",fontWeight:500,color:"var(--text-faint)",textTransform:"uppercase"}},"Drawdown"),jr.default.createElement("span",{style:{fontSize:"13px",color:"var(--text-muted)"}},"No accounts with limits"))},Fxe=(0,jr.memo)(_Ye)});var Dr,bO,Yq,zxe,BYe,WYe,jxe,yO,Ub,$Ye,_xe,Gq,RYe,Kq,Bxe=F(()=>{Dr=Y(Q()),bO=Y(W4());Rq();IP();IP();nr();Zs();lO();Jbe();Zbe();txe();nxe();ixe();oxe();lxe();dxe();pxe();fxe();wxe();Sxe();Oxe();Yq=class extends Dr.default.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){console.error("ResponsiveGridLayout crashed:",{error:t.message,stack:t.stack,componentStack:r.componentStack,isEditing:this.props.isEditing,timestamp:new Date().toISOString()})}render(){var t;return this.state.hasError?Dr.default.createElement("div",{style:{padding:"20px",border:"2px solid red",borderRadius:"4px"}},Dr.default.createElement("h3",null,"Grid Layout Error"),Dr.default.createElement("p",null,"Error: ",(t=this.state.error)==null?void 0:t.message),Dr.default.createElement("button",{onClick:()=>this.setState({hasError:!1,error:null})},"Retry")):this.props.children}},zxe=(e,t,r,n,i)=>{var c,d;let a=ag(t),o={};if(a!=null&&a.maxSize&&(o.minW=a.minSize.w,o.minH=a.minSize.h,o.maxW=a.maxSize.w,o.maxH=a.maxSize.h),!e||e.length===0)return{i:t,x:0,y:0,w:r,h:n,...o};if(i)try{let u=((d=(c=i.settings)==null?void 0:c.home)==null?void 0:d.layouts)||{};for(let p in u){let m=u[p];if(!m)continue;let f=(m.lg||[]).find(v=>v.i===t);if(f){let v=a!=null&&a.maxSize?Math.max(o.minW,Math.min(f.w,o.maxW)):f.w,h=a!=null&&a.maxSize?Math.max(o.minH,Math.min(f.h,o.maxH)):f.h;return{i:t,x:0,y:yo,w:v,h,...o}}}}catch(u){console.error("Error finding previous layout:",u)}let s=0;return e.forEach(u=>{let p=typeof u.y=="number"?u.y:0,m=typeof u.h=="number"?u.h:1,g=p+m;g>s&&(s=g)}),{i:t,x:0,y:s,w:r,h:n,...o}},BYe=(0,bO.WidthProvider)(bO.Responsive),WYe=Ube,jxe=12,yO=Rbe,Ub=e=>{var n,i,a,o;let t=ag(e.i),r={...e,i:typeof e.i=="string"?e.i:"unknown",x:typeof e.x=="number"&&isFinite(e.x)?e.x:0,y:typeof e.y=="number"&&isFinite(e.y)?e.y===1/0||e.y===1e7||e.y===1e4?yo:e.y:e.y===1/0?yo:0,w:typeof e.w=="number"&&isFinite(e.w)&&e.w>0?e.w:1,h:typeof e.h=="number"&&isFinite(e.h)&&e.h>0?e.h:1};return t!=null&&t.maxSize&&(r.minW=(n=e.minW)!=null?n:t.minSize.w,r.minH=(i=e.minH)!=null?i:t.minSize.h,r.maxW=(a=e.maxW)!=null?a:t.maxSize.w,r.maxH=(o=e.maxH)!=null?o:t.maxSize.h,r.w=Math.max(r.minW,Math.min(r.w,r.maxW)),r.h=Math.max(r.minH,Math.min(r.h,r.maxH))),r},$Ye=e=>{let t={};return Object.entries(e).forEach(([r,n])=>{if(!Array.isArray(n)){t[r]=[];return}t[r]=n.map(i=>!i||typeof i!="object"?{i:"unknown",x:0,y:0,w:1,h:1}:Ub(i))}),t},_xe=(0,Dr.memo)(({widgetId:e,isEditing:t,onRemove:r,renderWidget:n})=>{let i=(0,Dr.useCallback)(o=>{o.stopPropagation(),r(e)},[r,e]),a=(0,Dr.useCallback)(o=>{o.preventDefault(),o.stopPropagation()},[]);return Dr.default.createElement("div",{className:"journalit-home-widget",style:{position:"relative",width:"100%",height:"100%",display:"flex",flexDirection:"column",backgroundColor:"var(--background-primary)",borderRadius:"6px",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",overflow:"hidden",border:"1px solid var(--background-modifier-border)"}},t&&Dr.default.createElement("button",{className:"journalit-home-widget-remove",onClick:i,onMouseDown:a,style:{position:"absolute",top:"4px",right:"4px",backgroundColor:"var(--background-modifier-error)",color:"white",border:"none",borderRadius:"50%",width:"22px",height:"22px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",cursor:"pointer",zIndex:1e4,padding:0,fontWeight:"bold",lineHeight:1},"aria-label":"Remove widget"},"\u2715"),Dr.default.createElement("div",{className:"journalit-home-widget-content",style:{flex:1,padding:"12px",height:"100%",overflow:"hidden"}},n(e)))});_xe.displayName="GridWidgetItem";Gq=(e,t)=>{let r={lg:[],md:[],sm:[],xs:[],xxs:[]};if(!e)return r;try{let n=Wq(e),i=(n.lg||[]).filter(d=>t.includes(d.i)).map(Ub),a=(n.md||[]).filter(d=>t.includes(d.i)).map(Ub),o=(n.sm||[]).filter(d=>t.includes(d.i)).map(Ub),s=(n.xs||[]).filter(d=>t.includes(d.i)).map(Ub),l=(n.xxs||[]).filter(d=>t.includes(d.i)).map(Ub),c=yO;return t.forEach(d=>{let u=i.some(v=>v.i===d),p=a.some(v=>v.i===d),m=o.some(v=>v.i===d),g=s.some(v=>v.i===d),f=l.some(v=>v.i===d);if(!u||!p||!m||!g||!f){let v=ag(d);if(v){let h;if(u?h=i.find(y=>y.i===d):p?h=a.find(y=>y.i===d):m?h=o.find(y=>y.i===d):g?h=s.find(y=>y.i===d):f&&(h=l.find(y=>y.i===d)),h||(h=zxe(i,d,v.defaultSize.w,v.defaultSize.h,e)),!u){let y=zxe(i,d,Math.min(h.w,c.lg),h.h,e);i.push(y)}p||a.push({i:d,x:0,y:yo,w:Math.min(h.w,c.md),h:h.h}),m||o.push({i:d,x:0,y:yo,w:Math.min(h.w,c.sm),h:h.h}),g||s.push({i:d,x:0,y:yo,w:Math.min(h.w,c.xs),h:h.h}),f||l.push({i:d,x:0,y:yo,w:c.xxs,h:h.h})}}}),{lg:i,md:a,sm:o,xs:s,xxs:l}}catch(n){console.error("Error computing layouts:",n);let i=(a,o)=>{let s=ag(a),l=yO[o],c=o==="xxs"?1:Math.min((s==null?void 0:s.defaultSize.w)||6,l),d=(s==null?void 0:s.defaultSize.h)||4;return Ub({i:a,x:0,y:0,w:c,h:d})};return{lg:t.map(a=>i(a,"lg")),md:t.map(a=>i(a,"md")),sm:t.map(a=>i(a,"sm")),xs:t.map(a=>i(a,"xs")),xxs:t.map(a=>i(a,"xxs"))}}},RYe=({isEditing:e,widgets:t,onRemoveWidget:r})=>{let n=Ae(),[i,a]=(0,Dr.useState)(()=>Gq(n,t)),[o,s]=(0,Dr.useState)(1200),[l,c]=(0,Dr.useState)("lg"),d=(0,Dr.useCallback)(h=>{s(h)},[]),u=(0,Dr.useCallback)(h=>{["lg","md","sm","xs","xxs"].includes(h)&&c(h)},[]),p=(0,Dr.useCallback)(()=>{a(Gq(n,t))},[n,t]),m=(0,Dr.useCallback)(h=>{h.view==="home"&&p()},[p]);Xe("layout:changed",m),(0,Dr.useEffect)(()=>{a(Gq(n,t))},[n,t]);let g=(h,y)=>{let b=(h==null?void 0:h.map(_q).filter(S=>S!==null))||[],k=Object.fromEntries(Object.entries(y||{}).map(([S,w])=>[S,(w==null?void 0:w.map(_q).filter(C=>C!==null))||[]])),x=new CustomEvent("layout-changed");if(document.dispatchEvent(x),e&&n)try{let S=Wq(n),w=l||"lg",C=b.map(z=>z.i),D={lg:k.lg||[],md:k.md||[],sm:k.sm||[],xs:k.xs||[],xxs:k.xxs||[]},P=yO;["lg","md","sm","xs","xxs"].forEach(z=>{if(z===w)return;let A=D[z],I=A.map(L=>L.i);D[z]=A.filter(L=>C.includes(L.i)),C.forEach(L=>{if(!I.includes(L)){let E=b.find(T=>T.i===L);if(E){let T=ag(L);D[z].push({i:L,x:0,y:yo,w:Math.min(Math.max(1,Math.floor(E.w*P[z]/P[w])),P[z]),h:E.h})}}})}),$q(n,"Default",D)}catch(S){console.error("Error saving layout in handleLayoutChange:",S)}},f=h=>{if(!n)return null;switch(h){case"recentItems":return Dr.default.createElement(Kbe,{plugin:n});case"yearHeatmap":return Dr.default.createElement(Xbe,{plugin:n});case"weeklySummary":return Dr.default.createElement(exe,{plugin:n});case"positionSize":return Dr.default.createElement(rxe,{plugin:n});case"currentStreak":return Dr.default.createElement(axe,{plugin:n});case"bestHours":return Dr.default.createElement(sxe,null);case"setupLeaderboard":return Dr.default.createElement(cxe,null);case"unreviewedTrades":return Dr.default.createElement(uxe,{plugin:n});case"tradingScore":return Dr.default.createElement(xxe,null);case"aum":return Dr.default.createElement(kxe,{plugin:n});case"drawdownMonitor":return Dr.default.createElement(Fxe,{plugin:n});default:return h.startsWith("embeddedNote-")?Dr.default.createElement(Hq,{plugin:n,instanceId:h}):h.startsWith("goalsProgress-")?Dr.default.createElement(mxe,{plugin:n,instanceId:h}):Dr.default.createElement("div",{className:"journalit-home-widget-error"},"Unknown widget type: ",h)}},v=$Ye(i);return Dr.default.createElement("div",{className:`journalit-home-grid-layout ${e?"is-editing":""}`,style:{padding:"0",margin:"0"}},Dr.default.createElement(Yq,{isEditing:e},Dr.default.createElement(BYe,{className:"layout",layouts:v,breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:yO,rowHeight:WYe,isResizable:e,isDraggable:e,draggableCancel:e?".journalit-home-widget-remove, .journalit-home-widget-remove *":void 0,onLayoutChange:g,onWidthChange:d,onBreakpointChange:u,compactType:"vertical",preventCollision:!1,useCSSTransforms:!0,containerPadding:[0,12],margin:[jxe,jxe]},t.map(h=>Dr.default.createElement("div",{key:h},Dr.default.createElement(_xe,{widgetId:h,isEditing:e,onRemove:r,renderWidget:f}))))))},Kq=Dr.default.memo(RYe);Kq.displayName="HomeGridLayout"});var xO,Wxe=F(()=>{Wp();xO=class{constructor(t){this.plugin=t}async executeAction(t){switch(t){case"addTrade":new Eo({app:this.plugin.app,plugin:this.plugin}).open();break;case"openTradeLog":await this.plugin.viewManager.openTradeLogView();break;case"openTradingDashboard":await this.plugin.viewManager.openDashboardView();break;case"openAccountDashboard":await this.plugin.viewManager.openAccountDashboardView();break;case"openTodaysDRC":try{await(await this.plugin.serviceManager.getDRCService()).openDRC(new Date)}catch(n){console.error("Failed to open today's DRC:",n)}break;case"openWeeklyReview":try{await(await this.plugin.serviceManager.getWeeklyReviewService()).openWeeklyReview(new Date)}catch(n){console.error("Failed to open weekly review:",n)}break;case"openMonthlyReview":try{await(await this.plugin.serviceManager.getMonthlyReviewService()).openMonthlyReview(new Date)}catch(n){console.error("Failed to open monthly review:",n)}break;case"openCSVImport":await this.plugin.viewManager.openCSVImportView();break;case"openLayoutBuilder":await this.plugin.viewManager.openTemplateBuilderView();break;default:console.warn(`Unknown quick link action: ${t}`)}}}});function wO(e){return UYe[e]||Qm}var UYe,Jq=F(()=>{Ot();UYe={"plus-circle":Qm,"folder-tree":Rv,grip:Uv,users:af,calendar:Jm,"calendar-check":zv,"calendar-range":jv,import:Hv,blocks:nT}});var Ii,HYe,qYe,VYe,$xe,Rxe=F(()=>{Ii=Y(Q());Ot();Ay();h0();mh();Vc();Wxe();Jq();HYe=({transform:e})=>({...e,y:0}),qYe=({quickLink:e,isEditing:t,onRemove:r,onClick:n})=>{let{attributes:i,listeners:a,setNodeRef:o,transform:s,transition:l}=Vp({id:e.id,disabled:!t}),c={transform:al.Transform.toString(s&&{...s,y:0}),transition:l,position:"relative",height:"100%",flex:"1 1 auto",minWidth:"140px"},d=wO(e.icon),u=(0,Ii.useCallback)(m=>{m.stopPropagation(),m.preventDefault(),r(e.id)},[e.id,r]),p=(0,Ii.useCallback)(()=>{t||n(e.action)},[t,n,e.action]);return Ii.default.createElement("div",{ref:o,style:c},Ii.default.createElement("div",{className:"journalit-quick-link-wrapper",style:{position:"relative",cursor:t?"grab":"pointer",height:"100%",display:"flex",flexDirection:"column"}},Ii.default.createElement("div",{...i,...t?a:{},style:{flex:1,height:"100%"}},Ii.default.createElement("button",{onClick:p,disabled:t,className:"jl-quick-link-hover",style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 16px",border:"1px solid var(--background-modifier-border)",borderRadius:"8px",backgroundColor:"var(--background-secondary)",color:"var(--text-normal)",cursor:t?"grab":"pointer",fontSize:"13px",fontWeight:500,textAlign:"left",transition:"all 0.2s ease",width:"100%",height:"100%",opacity:t?.8:1,"--link-color":e.color},"aria-label":e.label},Ii.default.createElement(d,{size:16,style:{color:e.color,flexShrink:0}}),Ii.default.createElement("span",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},e.label))),t&&Ii.default.createElement("button",{className:"journalit-quick-link-remove",onClick:u,"aria-label":"Hide quick link",style:{zIndex:1e5,position:"absolute",top:"4px",right:"4px",width:"22px",height:"22px",backgroundColor:"var(--background-modifier-error)",color:"white",border:"none",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",cursor:"pointer",padding:0}},Ii.default.createElement(La,{size:12}))))},VYe=({plugin:e,isEditing:t=!1,quickLinks:r,onQuickLinksChange:n})=>{let[i,a]=(0,Ii.useState)([]);(0,Ii.useEffect)(()=>{var u,p;if(r&&r.length>0)a(r);else{let m=(u=e.settings.home)==null?void 0:u.quickLinks;if(m&&m.length>0)a(m);else{let g=((p=Qn.home)==null?void 0:p.quickLinks)||[];g.length>0&&(a(g),e.settings.home&&(e.settings.home.quickLinks=g,e.saveSettings()))}}},[r,e]);let o=(0,Ii.useMemo)(()=>new xO(e),[e]),s=(0,Ii.useMemo)(()=>i.filter(u=>u.visible).sort((u,p)=>u.order-p.order),[i]),l=(0,Ii.useCallback)(u=>{let{active:p,over:m}=u;if(m&&p.id!==m.id){let g=p.id.toString(),f=m.id.toString(),v=s.findIndex(y=>y.id===g),h=s.findIndex(y=>y.id===f);if(v!==-1&&h!==-1){let y=[...s],[b]=y.splice(v,1);y.splice(h,0,b);let k=i.map(x=>{let S=y.findIndex(w=>w.id===x.id);if(S!==-1)return{...x,order:S};{let w=y.length-1,C=i.filter(D=>!D.visible).findIndex(D=>D.id===x.id);return{...x,order:w+1+C}}});a(k),e.settings.home&&(e.settings.home.quickLinks=k,e.saveSettings())}}},[s,i,e]),c=(0,Ii.useCallback)(u=>{let p=i.map(m=>m.id===u?{...m,visible:!1}:m);a(p),n==null||n(p),e.settings.home&&(e.settings.home.quickLinks=p,e.saveSettings())},[i,e,n]),d=(0,Ii.useCallback)(async u=>{try{await o.executeAction(u)}catch(p){console.error("Failed to execute quick link action:",p)}},[o]);return s.length===0?Ii.default.createElement("div",{className:"journalit-quick-links-row",style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"16px 0",color:"var(--text-muted)",fontSize:"13px"}},t?'All quick links are hidden. Use "Add Widget" to restore them.':"No quick links available."):Ii.default.createElement("div",{className:"journalit-quick-links-row",style:{display:"flex",flexWrap:"wrap",gap:"12px",padding:"16px 0",justifyContent:"center"}},Ii.default.createElement(jd,{collisionDetection:zd,onDragEnd:l,modifiers:[HYe]},Ii.default.createElement(_d,{items:s.map(u=>u.id),strategy:WM},s.map(u=>Ii.default.createElement(qYe,{key:u.id,quickLink:u,isEditing:t,onRemove:c,onClick:d})))))},$xe=Ii.default.memo(VYe)});var kr,Uxe,Hxe=F(()=>{kr=Y(Q());Ot();lO();Jq();Uxe=kr.default.memo(({activeWidgets:e,hiddenQuickLinks:t,onAddWidget:r,onRestoreQuickLink:n,onClose:i})=>{let[a,o]=(0,kr.useState)(0),s=(0,kr.useRef)(null),l=(0,kr.useMemo)(()=>{let p={};return e.forEach(m=>{let g=m.split("-")[0];p[g]=(p[g]||0)+1}),p},[e]),c=(0,kr.useMemo)(()=>dk.filter(p=>p.configurable?!0:!e.includes(p.id)),[e]),d=(0,kr.useMemo)(()=>{let p=[];return c.forEach(m=>{p.push({type:"widget",id:m.id,configurable:m.configurable||!1,instanceCount:m.configurable&&l[m.id]||0})}),t.forEach(m=>{p.push({type:"quicklink",id:m.id})}),p},[c,t,l]);(0,kr.useEffect)(()=>{o(0)},[d.length]),(0,kr.useEffect)(()=>{let p=m=>{if(d.length!==0)switch(m.key){case"Escape":m.preventDefault(),m.stopPropagation(),m.stopImmediatePropagation(),i();break;case"ArrowDown":m.preventDefault(),o(f=>Math.min(f+1,d.length-1));break;case"ArrowUp":m.preventDefault(),o(f=>Math.max(f-1,0));break;case"Enter":m.preventDefault();let g=d[a];g&&(g.type==="widget"?r(g.id):n(g.id));break}};return document.addEventListener("keydown",p,!0),()=>document.removeEventListener("keydown",p,!0)},[i,d,a,r,n]),(0,kr.useEffect)(()=>{if(!s.current)return;let m=s.current.querySelectorAll("[data-selectable]")[a];m instanceof HTMLElement&&m.scrollIntoView({block:"nearest"})},[a]);let u=(0,kr.useCallback)((p,m)=>d.findIndex(g=>g.type===p&&g.id===m),[d]);return kr.default.createElement("div",{onClick:p=>p.target===p.currentTarget&&i(),style:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.4)",zIndex:100010,display:"flex",justifyContent:"center",alignItems:"center",paddingBottom:"10vh"}},kr.default.createElement("div",{onClick:p=>p.stopPropagation(),style:{width:"100%",maxWidth:"360px",maxHeight:"70vh",backgroundColor:"var(--background-primary)",borderRadius:"8px",border:"1px solid var(--background-modifier-border)",boxShadow:"0 12px 40px rgba(0, 0, 0, 0.15)",display:"flex",flexDirection:"column"}},kr.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",borderBottom:"1px solid var(--background-modifier-border)",flexShrink:0}},kr.default.createElement("span",{style:{fontSize:"14px",fontWeight:600,color:"var(--text-normal)"}},"Add to Home"),kr.default.createElement("button",{type:"button",onClick:p=>{p.stopPropagation(),i()},style:{background:"none",border:"none",padding:"4px",cursor:"pointer",color:"var(--text-muted)",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px"},className:"jl-selector-close"},kr.default.createElement(La,{size:16}))),kr.default.createElement("div",{ref:s,style:{flex:"1 1 auto",overflowY:"auto",padding:"8px 0",minHeight:0}},c.length>0&&kr.default.createElement(kr.default.Fragment,null,kr.default.createElement("div",{style:{padding:"4px 16px 8px",fontSize:"11px",fontWeight:600,color:"var(--text-faint)",textTransform:"uppercase",letterSpacing:"0.5px"}},"Widgets"),c.map(p=>{let m=p.configurable&&l[p.id]||0,g=u("widget",p.id),f=g===a;return kr.default.createElement("div",{key:p.id,"data-selectable":!0,onClick:()=>r(p.id),onMouseEnter:()=>o(g),className:"jl-selector-item",style:{display:"flex",alignItems:"flex-start",gap:"12px",padding:"10px 16px",cursor:"pointer",backgroundColor:f?"var(--background-secondary)":"transparent"}},kr.default.createElement("div",{style:{width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,marginTop:"1px"}},kr.default.createElement(Ui,{size:16,style:{color:"var(--text-muted)"}})),kr.default.createElement("div",{style:{flex:1,minWidth:0}},kr.default.createElement("div",{style:{fontSize:"13px",fontWeight:500,color:"var(--text-normal)",marginBottom:"2px"}},p.name,m>0&&kr.default.createElement("span",{style:{marginLeft:"6px",fontSize:"11px",color:"var(--text-faint)",fontWeight:400}},"(",m,")")),kr.default.createElement("div",{style:{fontSize:"12px",color:"var(--text-muted)",lineHeight:1.3}},p.description)))})),t.length>0&&kr.default.createElement(kr.default.Fragment,null,kr.default.createElement("div",{style:{padding:c.length>0?"16px 16px 8px":"4px 16px 8px",fontSize:"11px",fontWeight:600,color:"var(--text-faint)",textTransform:"uppercase",letterSpacing:"0.5px"}},"Hidden Quick Links"),t.map(p=>{let m=wO(p.icon),g=u("quicklink",p.id),f=g===a;return kr.default.createElement("div",{key:p.id,"data-selectable":!0,onClick:()=>n(p.id),onMouseEnter:()=>o(g),className:"jl-selector-item",style:{display:"flex",alignItems:"center",gap:"12px",padding:"10px 16px",cursor:"pointer",backgroundColor:f?"var(--background-secondary)":"transparent"}},kr.default.createElement("div",{style:{width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0}},kr.default.createElement(m,{size:16,style:{color:p.color}})),kr.default.createElement("div",{style:{flex:1,fontSize:"13px",fontWeight:500,color:"var(--text-normal)"}},p.label),kr.default.createElement("span",{style:{fontSize:"11px",color:"var(--text-faint)"}},"restore"))})),c.length===0&&t.length===0&&kr.default.createElement("div",{style:{padding:"24px 16px",textAlign:"center",color:"var(--text-muted)",fontSize:"13px"}},"All widgets have been added")),kr.default.createElement("div",{style:{padding:"8px 12px",borderTop:"1px solid var(--background-modifier-border)",fontSize:"11px",color:"var(--text-faint)",display:"flex",gap:"12px",flexShrink:0}},kr.default.createElement("span",null,"\u2191\u2193 navigate"),kr.default.createElement("span",null,"\u21B5 select"),kr.default.createElement("span",null,"esc close"))))})});var It,qxe,Qq,GYe,Vxe,Gxe=F(()=>{It=Y(Q());Ot();lO();Rq();xy();fc();pk();Bxe();Rxe();Hxe();Vc();Zs();qxe=["still up?","late night session?","burning the midnight oil?","ready to conquer the day?","how's it going?","winding down?","how did today go?"],Qq={month:"This Month",quarter:"This Quarter",year:"This Year",lifetime:"Lifetime"},GYe=({plugin:e})=>{var E;let t=()=>{let T=`journalit-onboarding-ever-shown-${e.app.vault.getName()}`;return!localStorage.getItem(T)},r=T=>qxe.some($=>T.includes($))||T.endsWith("?"),n=()=>{var V;if(t()){let J="Welcome to Journalit!";return{jsx:J,originalString:J}}let T=((V=e.settings.general)==null?void 0:V.displayName)||"",_=new Date().getHours(),B=["Hey nightowl","still up?","late night session?","burning the midnight oil?"],W=["Good morning","Rise and shine","Morning trader","ready to conquer the day?","Fresh start"],N=["Good afternoon","Hope your day's going well","Afternoon check-in","Midday momentum","how's it going?"],U=["Good evening","winding down?","Evening review","how did today go?","Time to reflect"],j=["Welcome back","Hey there","Good to see you"],R=[];_>=0&&_<5?R=B:_>=5&&_<11?R=W:_>=11&&_<17?R=N:R=U;let O=[...R,...j],H=Math.floor(Math.random()*O.length),q=O[H];return qxe.includes(q)?T?{jsx:It.default.createElement(It.default.Fragment,null,It.default.createElement("span",{style:{fontWeight:400}},"Hey "),It.default.createElement("span",{style:{fontWeight:600}},T),It.default.createElement("span",{style:{fontWeight:400}},", ",q)),originalString:`Hey ${T}, ${q}`}:{jsx:q,originalString:q}:T?{jsx:It.default.createElement(It.default.Fragment,null,It.default.createElement("span",{style:{fontWeight:400}},q,", "),It.default.createElement("span",{style:{fontWeight:600}},T)),originalString:`${q}, ${T}`}:{jsx:q,originalString:q}},i=T=>{if(t())return"Let's get you started with your trading journey";let B=T?["Let's see how you're doing","Time to elevate your trading","Your trading journey continues","Let's check your progress"]:["Ready to elevate your trading?","What's on the agenda today?","How's your trading going?"],W=Math.floor(Math.random()*B.length);return B[W]},[a,o]=(0,It.useState)(!1),[s,l]=(0,It.useState)(()=>e.uiStateManager.getState().selectedPeriod||"lifetime"),[c,d]=(0,It.useState)(!1),u=(0,It.useCallback)(()=>{let T=e.settings.home;if(!(T!=null&&T.layouts))return zq;let $=T.activeLayout||"Default",_=T.layouts[$];if(!(_!=null&&_.lg)||_.lg.length===0)return zq;let B=_.lg.map(U=>U.i),W=B.filter(U=>ag(U)!==void 0),N=B.filter(U=>!W.includes(U));return N.length>0&&console.warn("Journalit HomePage: Filtered unknown widget types from layout:",N),W},[e]),[p,m]=(0,It.useState)(u),g=(0,It.useCallback)(()=>{let T=u();m(T)},[u]);Xe("layout:changed",(0,It.useCallback)(T=>{T.view==="home"&&g()},[g])),(0,It.useEffect)(()=>{g()},[g]);let[f,v]=(0,It.useState)(!1),[h,y]=(0,It.useState)(0),[b,k]=(0,It.useState)(()=>{var T,$;return((T=e.settings.home)==null?void 0:T.quickLinks)||(($=Qn.home)==null?void 0:$.quickLinks)||[]}),[{greeting:x,subtitle:S},w]=(0,It.useState)(()=>{let T=n(),$=r(T.originalString);return{greeting:T.jsx,subtitle:i($)}});(0,It.useEffect)(()=>{e.settings.home||(e.settings.home={layouts:{Default:{lg:[{i:"recentItems",x:0,y:0,w:4,h:5},{i:"yearHeatmap",x:4,y:0,w:8,h:5}],md:[{i:"recentItems",x:0,y:0,w:6,h:5},{i:"yearHeatmap",x:0,y:5,w:6,h:5}],sm:[{i:"recentItems",x:0,y:0,w:4,h:5},{i:"yearHeatmap",x:0,y:5,w:4,h:5}],xs:[{i:"recentItems",x:0,y:0,w:2,h:5},{i:"yearHeatmap",x:0,y:5,w:2,h:5}],xxs:[{i:"recentItems",x:0,y:0,w:1,h:5},{i:"yearHeatmap",x:0,y:5,w:1,h:5}]}},activeLayout:"Default",recentItems:[]},e.saveSettings())},[e]),(0,It.useEffect)(()=>{let T=()=>{y($=>$+1)};return window.addEventListener("journalit:display-name-changed",T),()=>{window.removeEventListener("journalit:display-name-changed",T)}},[]),(0,It.useEffect)(()=>{let T=n(),$=r(T.originalString);w({greeting:T.jsx,subtitle:i($)})},[h]);let C=()=>{o(!a),a&&d(!1)},D=(0,It.useCallback)(async T=>{l(T),d(!1),await e.uiStateManager.updateState({selectedPeriod:T})},[e]),P=(0,It.useMemo)(()=>b.filter(T=>!T.visible),[b]),M=(0,It.useCallback)(async T=>{let $=b.map(_=>_.id===T?{..._,visible:!0}:_);k($),e.settings.home={...e.settings.home,quickLinks:$};try{await e.saveSettings()}catch(_){console.error("Failed to save quick link visibility:",_)}},[b,e]),z=(0,It.useRef)(void 0);(0,It.useEffect)(()=>{var _;let T=(_=e.settings.home)==null?void 0:_.quickLinks;if(!T||T===z.current)return;(T.length!==b.length||T.some((B,W)=>{var N,U;return B.id!==((N=b[W])==null?void 0:N.id)||B.visible!==((U=b[W])==null?void 0:U.visible)}))&&k(T),z.current=T},[(E=e.settings.home)==null?void 0:E.quickLinks,b]);let A=(0,It.useCallback)(async T=>{var B,W,N,U,j;let $=dk.find(R=>R.id===T),_=$!=null&&$.configurable?`${T}-${gc()}`:T;if(e.settings.home){let R=ag(_);if(R){let O={lg:12,md:6,sm:4,xs:2,xxs:1},H=e.settings.home.activeLayout||"Default",q=e.settings.home.layouts[H];q&&((B=q.lg)!=null&&B.some(V=>V.i===_)||(q.lg=[...q.lg||[],{i:_,x:0,y:yo,w:Math.min(R.defaultSize.w,O.lg),h:R.defaultSize.h}]),(W=q.md)!=null&&W.some(V=>V.i===_)||(q.md=[...q.md||[],{i:_,x:0,y:yo,w:Math.min(R.defaultSize.w,O.md),h:R.defaultSize.h}]),(N=q.sm)!=null&&N.some(V=>V.i===_)||(q.sm=[...q.sm||[],{i:_,x:0,y:yo,w:Math.min(R.defaultSize.w,O.sm),h:R.defaultSize.h}]),(U=q.xs)!=null&&U.some(V=>V.i===_)||(q.xs=[...q.xs||[],{i:_,x:0,y:yo,w:Math.min(R.defaultSize.w,O.xs),h:R.defaultSize.h}]),(j=q.xxs)!=null&&j.some(V=>V.i===_)||(q.xxs=[...q.xxs||[],{i:_,x:0,y:yo,w:1,h:R.defaultSize.h}]))}await e.saveSettings(),m(u())}},[e,u]),I=(0,It.useCallback)(async T=>{var $,_,B,W,N;if(e.settings.home){T.startsWith("embeddedNote-")&&e.settings.home.embeddedNotes&&delete e.settings.home.embeddedNotes[T],T.startsWith("goalsProgress-")&&e.settings.home.goals&&delete e.settings.home.goals[T];let U=e.settings.home.activeLayout||"Default",j=e.settings.home.layouts[U];j&&(j.lg=(($=j.lg)==null?void 0:$.filter(R=>R.i!==T))||[],j.md=((_=j.md)==null?void 0:_.filter(R=>R.i!==T))||[],j.sm=((B=j.sm)==null?void 0:B.filter(R=>R.i!==T))||[],j.xs=((W=j.xs)==null?void 0:W.filter(R=>R.i!==T))||[],j.xxs=((N=j.xxs)==null?void 0:N.filter(R=>R.i!==T))||[]),await e.saveSettings(),m(u())}},[e,u]),L={dateRange:[null,null],accounts:[],tickers:[],setups:[],tradeTypes:[],statuses:[],tags:[]};return It.default.createElement("div",{className:"journalit-home-page",style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",overflow:"hidden"}},It.default.createElement("div",{className:"journalit-home-header",style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",padding:"16px 16px 8px 16px",backgroundColor:"var(--background-primary)",flexShrink:0}},It.default.createElement("div",{style:{display:"flex",flexDirection:"column"}},It.default.createElement("h1",{style:{margin:0,fontSize:"28px",fontWeight:600,color:"var(--text-normal)",lineHeight:"1.2"}},x),It.default.createElement("p",{style:{margin:"4px 0 0 0",fontSize:"14px",color:"var(--text-muted)",fontWeight:400}},S)),It.default.createElement("div",{style:{display:"flex",gap:"8px"}},It.default.createElement("div",{style:{position:"relative"}},It.default.createElement("button",{onClick:()=>d(!c),className:"journalit-home-period-selector clickable-icon","aria-label":"Filter Period",style:{display:"flex",alignItems:"center",gap:"4px",padding:"8px 12px",width:"auto",height:"auto",color:"var(--text-normal)",borderRadius:"6px",fontSize:"12px",cursor:"pointer",transition:"all 0.2s ease",border:"1px solid var(--background-modifier-border)",backgroundColor:"var(--background-primary)"}},It.default.createElement("span",null,Qq[s]),It.default.createElement(cs,{size:14,style:{transform:c?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.2s ease"}})),c&&It.default.createElement("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",backgroundColor:"var(--background-primary)",border:"1px solid var(--background-modifier-border)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",zIndex:100,overflow:"hidden"}},Object.keys(Qq).map(T=>It.default.createElement("button",{key:T,onClick:()=>D(T),style:{display:"block",width:"100%",padding:"8px 12px",textAlign:"left",fontSize:"12px",color:s===T?"var(--interactive-accent)":"var(--text-normal)",backgroundColor:s===T?"var(--background-modifier-hover)":"transparent",border:"none",cursor:"pointer",transition:"background-color 0.15s ease"},onMouseEnter:$=>{$.currentTarget.style.backgroundColor="var(--background-modifier-hover)"},onMouseLeave:$=>{$.currentTarget.style.backgroundColor=s===T?"var(--background-modifier-hover)":"transparent"}},Qq[T])))),a&&It.default.createElement("button",{onClick:()=>v(!0),className:"journalit-home-add-widget-button clickable-icon","aria-label":"Add Widget",style:{display:"flex",alignItems:"center",gap:"4px",padding:"8px 12px",width:"auto",height:"auto",color:"var(--text-normal)",borderRadius:"6px",fontSize:"12px",cursor:"pointer",transition:"all 0.2s ease",border:"1px solid var(--background-modifier-border)",backgroundColor:"var(--background-primary)"}},It.default.createElement(Ui,{size:14}),It.default.createElement("span",null,"Add Widget")),It.default.createElement("button",{onClick:C,className:`journalit-home-edit-toggle clickable-icon ${a?"active":""}`,"aria-label":a?"Save Layout":"Customize",style:{display:"flex",alignItems:"center",gap:"0",padding:"8px",border:`1px solid ${a?"var(--interactive-accent)":"var(--background-modifier-border)"}`,borderRadius:"6px",backgroundColor:a?"var(--interactive-accent)":"var(--background-primary)",color:a?"var(--text-on-accent)":"var(--text-normal)",cursor:"pointer",fontSize:"12px",fontWeight:500,transition:"all 0.2s ease"}},a?It.default.createElement(Fi,{size:14}):It.default.createElement(Yv,{size:14})))),It.default.createElement("div",{className:"journalit-home-content",style:{flex:1,overflow:"auto",padding:"0 16px 16px 16px",display:"flex",flexDirection:"column",gap:"16px"}},It.default.createElement(dM,{app:e.app,tradeService:e.tradeService,filters:L},It.default.createElement(Ybe,{period:s},It.default.createElement("div",{style:{flex:"0 0 auto"}},It.default.createElement(Kq,{isEditing:a,widgets:p,onRemoveWidget:I})),It.default.createElement("div",{style:{flex:"0 0 auto"}},It.default.createElement($xe,{plugin:e,isEditing:a,quickLinks:b,onQuickLinksChange:k}))))),f&&It.default.createElement(Uxe,{activeWidgets:p,hiddenQuickLinks:P,onAddWidget:A,onRestoreQuickLink:M,onClose:()=>v(!1)}))},Vxe=It.default.memo(GYe)});var Yxe,es,kO,AP=F(()=>{Yxe=Y(Q());ch();Gxe();es="journalit-home-view",kO=class extends nl{constructor(t,r){super(t,{rootId:"journalit-home-view"}),this.plugin=r}async onOpen(){this.containerEl.addClass("journalit-home-view-container"),await super.onOpen()}getViewType(){return es}getDisplayText(){return"Journalit"}getIcon(){return"circle-dot-dashed"}getRenderFunction(){return()=>Yxe.default.createElement(Vxe,{plugin:this.plugin})}}});var iV,IO,i0e=F(()=>{iV=require("obsidian");UF();Tr();IO=class{constructor(t,r,n={}){this.indexes=new Map;this.indexConfigs=new Map;this.filePathMap=new Map;this.buildingIndexes=new Set;this.processedFiles=new Set;this.isDirty=!1;this.persistIndexes=!0;this.isInitialized=!1;this.pendingFileChanges=[];this.saveIntervalId=null;this.BASE_FOLDER=".journalit";this.INDEX_FOLDER="indexes";this.plugin=null;this.dirtyIndexes=new Set;this.eventUnsubscribers=[];var i;this.app=t,this.dataExtractor=r,this.persistIndexes=(i=n.persistIndexes)!=null?i:!0,this.boundHandleFileChange=this.handleFileChange.bind(this)}setPlugin(t){this.plugin=t,this.plugin.registerEvent(this.app.vault.on("create",this.boundHandleFileChange)),this.plugin.registerEvent(this.app.vault.on("modify",this.boundHandleFileChange)),this.plugin.registerEvent(this.app.vault.on("delete",this.boundHandleFileChange)),this.plugin.registerEvent(this.app.vault.on("rename",this.boundHandleFileChange)),this.eventUnsubscribers.push(xe.subscribe("trade:changed",()=>{this.markAllIndexesDirty()})),this.eventUnsubscribers.push(xe.subscribe("missed-trade:changed",()=>{this.markAllIndexesDirty()})),this.eventUnsubscribers.push(xe.subscribe("backtest-trade:changed",()=>{this.markAllIndexesDirty()})),this.isInitialized&&this.persistIndexes&&!this.saveIntervalId&&(this.saveIntervalId=this.plugin.registerInterval(window.setInterval(()=>this.saveIndexes(),300*1e3)))}async initialize(){if(!this.isInitialized)try{let t=`${this.BASE_FOLDER}/${this.INDEX_FOLDER}`;await this.app.vault.adapter.exists(t)||await this.app.vault.adapter.mkdir(t),this.persistIndexes&&await this.loadIndexes(),this.isInitialized=!0;for(let r of this.pendingFileChanges)this.handleFileChange(r);this.pendingFileChanges=[],this.persistIndexes&&this.plugin&&(this.saveIntervalId=this.plugin.registerInterval(window.setInterval(()=>this.saveIndexes(),300*1e3)))}catch(t){console.error("Failed to initialize index manager:",t)}}registerIndex(t){this.indexConfigs.set(t.name,t),this.indexes.has(t.name)||this.indexes.set(t.name,[]),this.buildingIndexes.has(t.name)||this.buildIndex(t.name)}getIndex(t){return this.dirtyIndexes.has(t)?[]:this.indexes.get(t)||[]}queryIndex(t,r={},n={}){if(this.dirtyIndexes.has(t))return this.buildingIndexes.has(t)||this.rebuildDirtyIndex(t),[];let i=this.indexes.get(t);if(!i)return[];let a=i.filter(o=>Object.entries(r).every(([s,l])=>Array.isArray(o.values[s])?Array.isArray(l)?l.some(c=>o.values[s].includes(c)):o.values[s].includes(l):o.values[s]===l));if(n.sort){let{field:o,direction:s}=n.sort;a.sort((l,c)=>{let d=l.values[o],u=c.values[o];if(d===u)return 0;if(d===void 0)return s==="asc"?-1:1;if(u===void 0)return s==="asc"?1:-1;let p=d<u?-1:1;return s==="asc"?p:-p})}return n.offset!==void 0&&n.offset>0&&(a=a.slice(n.offset)),n.limit!==void 0&&n.limit>0&&(a=a.slice(0,n.limit)),a}getUniqueValues(t,r){let n=this.indexes.get(t);if(!n)return[];let i=new Set;for(let a of n){let o=a.values[r];Array.isArray(o)?o.forEach(s=>i.add(s)):o!=null&&i.add(o)}return Array.from(i)}markDirty(t){this.indexConfigs.has(t)&&this.dirtyIndexes.add(t)}markAllIndexesDirty(){for(let t of this.indexConfigs.keys())this.dirtyIndexes.add(t)}isDirtyIndex(t){return this.dirtyIndexes.has(t)}clearDirty(t){this.dirtyIndexes.delete(t)}async rebuildDirtyIndex(t){let r=this.indexConfigs.get(t);if(r){this.buildingIndexes.add(t);try{this.indexes.set(t,[]);for(let[a,o]of this.filePathMap.entries())o.delete(t),o.size===0&&this.filePathMap.delete(a);let n=this.app.vault.getFiles(),i=r.fileFilter?n.filter(r.fileFilter):n.filter(a=>a.extension==="md");for(let a of i)try{await this.indexFile(a,t)}catch(o){console.error(`Error re-indexing file ${a.path}:`,o)}this.clearDirty(t),this.isDirty=!0}finally{this.buildingIndexes.delete(t)}}}async buildIndex(t){if(!this.buildingIndexes.has(t)){this.buildingIndexes.add(t);try{let r=this.indexConfigs.get(t);if(!r){console.error(`No config found for index: ${t}`),this.buildingIndexes.delete(t);return}let n=this.app.vault.getFiles(),i=r.fileFilter?n.filter(r.fileFilter):n.filter(s=>s.extension==="md"),a=20,o=[];for(let s=0;s<i.length;s+=a){let l=i.slice(s,s+a);o.push(l)}this.indexes.set(t,[]);for(let s of o){let l=s.map(c=>async()=>{if(!this.processedFiles.has(c.path))try{await this.indexFile(c,t),this.processedFiles.add(c.path)}catch(d){console.error(`Error indexing file ${c.path}:`,d)}});for(let c=0;c<l.length;c++)await l[c](),c%5===0&&c>0&&await new Promise(d=>setTimeout(d,10))}this.isDirty=!0,this.clearDirty(t)}catch(r){console.error(`Error building index ${t}:`,r)}finally{this.buildingIndexes.delete(t),this.persistIndexes&&this.saveIndexes()}}}async indexFile(t,r){let n=this.indexConfigs.get(r);if(n&&!(n.fileFilter&&!n.fileFilter(t)))try{let i=await this.dataExtractor(t);if(!i)return;let a={};for(let d of n.fields)n.valueExtractor?a[d]=n.valueExtractor(i,d):n.includeNested?a[d]=this.getNestedValue(i,d):a[d]=i[d];let o={data:i,file:t,values:a},s=this.indexes.get(r)||[],l=-1;this.filePathMap.has(t.path)||this.filePathMap.set(t.path,new Map);let c=this.filePathMap.get(t.path);if(c.has(r)&&(l=c.get(r)),l>=0&&l<s.length)s[l]=o;else{let d=s.length;s.push(o),c.set(r,d)}this.indexes.set(r,s),this.isDirty=!0}catch(i){console.error(`Error indexing file ${t.path} for index ${r}:`,i)}}removeFileFromIndexes(t){if(!this.filePathMap.has(t))return;let r=this.filePathMap.get(t);for(let[n,i]of r.entries()){let a=this.indexes.get(n);if(a&&i>=0&&i<a.length){let o=a.length-1;if(i!==o){let s=a[o];a[i]=s;let l=s.file.path;if(this.filePathMap.has(l)){let c=this.filePathMap.get(l);c.has(n)&&c.set(n,i)}}a.pop(),this.isDirty=!0}}this.filePathMap.delete(t),this.processedFiles.delete(t)}handleFileChange(t){if(!(!("path"in t)||t.path.includes(`${this.BASE_FOLDER}/${this.INDEX_FOLDER}`))){if(!this.isInitialized){this.pendingFileChanges.push(t);return}RF(async()=>{try{if(t instanceof iV.TFile){if(t.extension!=="md")return;for(let r of this.indexConfigs.keys())this.buildingIndexes.has(r)||await this.indexFile(t,r)}else this.removeFileFromIndexes(t.path);this.isDirty&&this.persistIndexes&&setTimeout(()=>this.saveIndexes(),2e3)}catch(r){console.error(`Error handling file change for ${t.path}:`,r)}})}}getNestedValue(t,r){return r.split(".").reduce((n,i)=>n&&n[i]!==void 0?n[i]:void 0,t)}async saveIndexes(){if(!(!this.isDirty||!this.persistIndexes))try{let t=`${this.BASE_FOLDER}/${this.INDEX_FOLDER}`;await this.app.vault.adapter.exists(t)||await this.app.vault.adapter.mkdir(t);for(let[r,n]of this.indexes.entries()){let i={name:r,entries:n.map(o=>({path:o.file.path,values:o.values}))},a=`${t}/${r}.json`;await this.app.vault.adapter.write(a,JSON.stringify(i))}this.isDirty=!1}catch(t){console.error("Failed to save indexes:",t)}}async loadIndexes(){try{let t=`${this.BASE_FOLDER}/${this.INDEX_FOLDER}`;if(!await this.app.vault.adapter.exists(t))return;let{files:r}=await this.app.vault.adapter.list(t);for(let n of r)try{let i=await this.app.vault.adapter.read(n),a=JSON.parse(i);if(!a.name||!Array.isArray(a.entries)){console.warn(`Invalid index file format: ${n}`);continue}let o=a.name;this.indexes.set(o,[]);for(let s=0;s<a.entries.length;s++){let l=a.entries[s],c=l.path,d=this.app.vault.getAbstractFileByPath(c);if(!d||!(d instanceof iV.TFile))continue;let u={data:null,file:d,values:l.values},p=this.indexes.get(o);p.push(u),this.filePathMap.has(c)||this.filePathMap.set(c,new Map),this.filePathMap.get(c).set(o,p.length-1),this.processedFiles.add(c)}}catch(i){console.error(`Failed to load index file ${n}:`,i)}}catch(t){console.error("Failed to load indexes:",t)}}unload(){this.saveIntervalId=null;for(let t of this.eventUnsubscribers)t();this.eventUnsubscribers=[],this.persistIndexes&&this.isDirty&&this.saveIndexes(),this.indexes.clear(),this.dirtyIndexes.clear(),this.indexConfigs.clear(),this.filePathMap.clear(),this.processedFiles.clear(),this.pendingFileChanges=[]}}});var a0e={};Ti(a0e,{CustomDataService:()=>ts});var cv,ts,Tm=F(()=>{i0e();Nl();cv=class cv{constructor(t,r={}){this.app=t;this.pendingQueries=new Map;this.indexManager=null;this.plugin=null;this.config={folder:r.folder||"",extension:r.extension||".md",cacheTTL:r.cacheTTL||cv.DEFAULT_CACHE_TTL,persistCache:r.persistCache!==void 0?r.persistCache:!0,namespace:r.namespace||"default",enableIndexing:r.enableIndexing!==void 0?r.enableIndexing:!0,indexes:r.indexes||[]},this.cache=new Map,this.isCacheInvalidated=!1,this.boundHandleFileChange=this.handleFileChange.bind(this),this.config.enableIndexing&&this.setupIndexing(),this.initializeService()}setPlugin(t){this.plugin=t,this.plugin.registerEvent(this.app.vault.on("create",this.boundHandleFileChange)),this.plugin.registerEvent(this.app.vault.on("modify",this.boundHandleFileChange)),this.plugin.registerEvent(this.app.vault.on("delete",this.boundHandleFileChange)),this.plugin.registerEvent(this.app.vault.on("rename",this.boundHandleFileChange)),this.indexManager&&this.indexManager.setPlugin(t)}setupIndexing(){if(cv.sharedIndexManager?this.indexManager=cv.sharedIndexManager:(this.indexManager=new IO(this.app,async t=>{try{return await this.readFrontmatter(t)}catch(r){return console.error(`Error extracting data from ${t.path}:`,r),null}}),this.plugin&&this.indexManager.setPlugin(this.plugin),cv.sharedIndexManager=this.indexManager,this.indexManager.initialize()),this.config.indexes.length>0)for(let t of this.config.indexes)this.indexManager.registerIndex(t)}async initializeService(){await this.loadPersistentCache()}getNamespacedKey(t){return`${this.config.namespace}:${t}`}async query(t,r,n={},i){let{useCache:a=!0,cacheTTL:o=this.config.cacheTTL,offlineCapable:s=!0,useIndexes:l=!0}=n,c=this.getNamespacedKey(r);try{if(a&&!this.isCacheInvalidated){let m=this.getCached(c,o);if(m!==null)return m}let d=this.pendingQueries.get(c);if(d)return d;let p=(async()=>{if(l&&this.indexManager&&i)try{let g=this.indexManager.queryIndex(i.indexName,i.filters||{},{sort:i.sort,limit:i.limit,offset:i.offset});if(g.length>0){let f=g.filter(h=>h.data!==null&&h.data!==void 0),v;return f.length===g.length?(v=g.map(h=>h.data||null).filter(Boolean),v.length===1&&!Array.isArray(t)&&(v=v[0])):v=(await Promise.all(g.map(async y=>{try{return this.app.vault.getAbstractFileByPath(y.file.path)?await this.readFrontmatter(y.file):null}catch(b){return(!(b instanceof Error)||!b.message.includes("ENOENT"))&&console.error(`Error loading data from file ${y.file.path}:`,b),null}}))).filter(Boolean),a&&(this.setCache(c,v),this.isCacheInvalidated=!1),v}}catch(g){console.warn(`Error using index for query ${r}:`,g)}let m=await t();return a&&(this.setCache(c,m),this.isCacheInvalidated=!1),m})();this.pendingQueries.set(c,p);try{return await p}finally{this.pendingQueries.delete(c)}}catch(d){if(s&&a){let u=this.getCached(c,1/0);if(u!==null)return u}throw this.handleError(d)}}getCached(t,r){let n=this.cache.get(t);if(!n)return null;let{data:i,timestamp:a}=n;return Date.now()-a>r?(this.cache.delete(t),null):i}setCache(t,r){let n={data:r,timestamp:Date.now()};this.cache.set(t,n),this.config.persistCache&&this.savePersistentCache()}getCacheFilePath(){return`.journalit/cache/${this.config.namespace}-cache.json`}async loadPersistentCache(){try{let t=this.getCacheFilePath();if(await this.app.vault.adapter.exists(t)){let n=await this.app.vault.adapter.read(t);try{let i=JSON.parse(n);Object.entries(i).forEach(([a,o])=>{this.cache.set(a,o)})}catch(i){console.warn(`Failed to parse cache data for namespace ${this.config.namespace}:`,i instanceof Error?i.message:"Invalid JSON")}}}catch(t){let r=t instanceof Error?t.message:String(t);console.warn(`Failed to load persistent cache for namespace ${this.config.namespace}:`,r)}}async savePersistentCache(){try{let t=this.getCacheFilePath();await this.app.vault.adapter.mkdir(".journalit/cache");let r=Array.from(this.cache.entries()).filter(([i])=>i.startsWith(`${this.config.namespace}:`)),n=Object.fromEntries(r);await this.app.vault.adapter.write(t,JSON.stringify(n))}catch(t){console.warn(`Failed to save persistent cache for namespace ${this.config.namespace}:`,t instanceof Error?t.message:"Unknown error")}}async handleFileChange(t){if(!("path"in t)||t.path.includes("journalit/cache")||this.config.folder&&!t.path.startsWith(this.config.folder)||this.config.extension&&!t.path.endsWith(this.config.extension))return;let r=t.path.split("/"),n=r[r.length-1],i="";if(t.path.includes("/trades/")?i="trade:":t.path.includes("/Accounts/")?i="account:":t.path.includes("/DRC/")?i="drc:":t.path.includes("/Weekly/")&&(i="weekly:"),i){let a=this.config.namespace==="accountPage"&&i==="trade:";(this.config.namespace==="default"||i.startsWith(this.config.namespace)||this.config.namespace===i.replace(":","")||a)&&(await this.clearCacheWithPrefix(i),a&&(await this.clearCacheByPattern("accountPage:",!1),await this.clearCacheByPattern("accountTrades:",!1),await this.clearCacheByPattern("allEnhancedAccounts",!1)))}else this.config.namespace==="default"&&(this.isCacheInvalidated=!0,await this.clearCache())}handleError(t){return t instanceof Error?t:new Error("An unknown error occurred")}async clearCache(){this.isCacheInvalidated=!0;let t=`${this.config.namespace}:`;for(let r of this.pendingQueries.keys())r.startsWith(t)&&this.pendingQueries.delete(r);for(let r of this.cache.keys())r.startsWith(t)&&this.cache.delete(r);if(this.config.persistCache)try{let r=this.getCacheFilePath();await this.app.vault.adapter.write(r,JSON.stringify({}))}catch(r){console.warn(`Failed to clear persistent cache for namespace ${this.config.namespace}:`,r instanceof Error?r.message:"Unknown error")}}async clearCacheKey(t){let r=this.getNamespacedKey(t);this.cache.delete(r)&&this.config.persistCache&&await this.savePersistentCache()}async clearCacheWithPrefix(t){let r=this.getNamespacedKey(t),n=!1;for(let i of this.cache.keys())i.startsWith(r)&&(this.cache.delete(i),n=!0);n&&this.config.persistCache&&await this.savePersistentCache()}async clearCacheByPattern(t,r=!0){let n=r?this.getNamespacedKey(t):t,i=!1;for(let a of this.cache.keys())a.startsWith(n)&&(this.cache.delete(a),i=!0);i&&this.config.persistCache&&await this.savePersistentCache()}invalidateCache(){this.isCacheInvalidated=!0}getFiles(){return this.app.vault.getFiles().filter(r=>!(this.config.folder&&!r.path.startsWith(this.config.folder)||this.config.extension&&!r.path.endsWith(this.config.extension)))}registerIndex(t){if(!this.indexManager){console.warn("Index manager not initialized. Enable indexing in service config.");return}this.indexManager.registerIndex(t)}queryIndex(t,r={},n={}){return this.indexManager?this.indexManager.queryIndex(t,r,n):[]}getUniqueIndexValues(t,r){return this.indexManager?this.indexManager.getUniqueValues(t,r):[]}isIndexingEnabled(){return this.config.enableIndexing&&this.indexManager!==null}cleanup(){this.indexManager&&(this.indexManager.unload(),this.indexManager=null)}async readFrontmatter(t){try{let r=this.app.metadataCache.getFileCache(t);if(r!=null&&r.frontmatter)return JSON.parse(JSON.stringify(r.frontmatter));let i=(await this.app.vault.read(t)).match(/^---\n([\s\S]*?)\n---/);if(!i)return{};try{return this.parseYamlFrontmatter(i[1])}catch(a){return console.warn(`Failed to parse frontmatter with advanced parser for ${t.path}:`,a),this.simpleYamlParse(i[1])}}catch(r){return console.error(`Failed to parse frontmatter for ${t.path}:`,r),{}}}parseYamlFrontmatter(t){let r={},n=null,i=null,a=!1,o=[],s=null,l=0,c=t.split(`
`);for(let d=0;d<c.length;d++){let u=c[d];if(!u.trim())continue;let p=u.search(/\S|$/);if(p===0&&u.includes(":")){a&&n&&(r[n]=o,a=!1,o=[]);let[m,g]=this.parseKeyValue(u);if(n=m,g==="")if(d+1<c.length){let f=c[d+1];f.search(/\S|$/)>p||f.trim().startsWith("-")?(a=!1,i=null):(r[m]="",n=null)}else r[m]="",n=null;else if(g==="|"){let f="",v=-1;for(let h=d+1;h<c.length;h++){let y=c[h],b=y.search(/\S|$/);if(b===0&&y.trim()!=="")break;v===-1&&y.trim()!==""&&(v=b),(y.trim()!==""||f!=="")&&(f!==""&&(f+=`
`),f+=y.substring(v)),d=h}r[m]=f.trimEnd(),n=null}else g.startsWith("[")&&g.endsWith("]")?(r[m]=g.slice(1,-1).split(",").map(f=>f.trim()).filter(Boolean),n=null):(g==='""'||g==="''"?r[m]="":r[m]=g,n=null)}else if(u.trim().startsWith("-")&&n){let m=u.indexOf("-");a=!0,l=m;let g=u.substring(m+1).trim();if(!g)s={},o.push(s);else if(g.includes(":")){s={},o.push(s);let[f,v]=this.parseKeyValue(g);s&&(s[f]=v)}else o.push(g),s=null}else if(s&&u.trim().includes(":")&&u.search(/\S|$/)>l){let[m,g]=this.parseKeyValue(u);s[m.trim()]=g}else if(u.includes(":")&&n){let[m,g]=this.parseKeyValue(u);(typeof r[n]!="object"||r[n]===null)&&(r[n]={}),r[n][m.trim()]=g}}return a&&n&&(r[n]=o),r}parseKeyValue(t){let r=t.indexOf(":");if(r===-1)return[t.trim(),""];let n=t.slice(0,r).trim(),i=t.slice(r+1).trim();return[n,i]}simpleYamlParse(t){let r={};return t.split(`
`).forEach(n=>{if(!n.trim())return;let i=n.indexOf(":");if(i===-1)return;let a=n.slice(0,i).trim(),o=n.slice(i+1).trim();if(o.startsWith("[")&&o.endsWith("]"))r[a]=o.slice(1,-1).split(",").map(s=>s.trim()).filter(Boolean);else if(n.startsWith("  ")&&a.startsWith("  ")){let s=Object.keys(r).pop();s&&!Array.isArray(r[s])&&(typeof r[s]!="object"&&(r[s]={}),r[s][a.trim()]=o)}else r[a]=o}),r}async updateFrontmatter(t,r){await this.app.fileManager.processFrontMatter(t,n=>{Object.assign(n,r)}),await yn(this.app,t)}};cv.DEFAULT_CACHE_TTL=300*1e3,cv.sharedIndexManager=null;ts=cv});var ld,WP,o0e=F(()=>{ld=require("obsidian");AT();iy();Tm();_t();Oa();Nl();Jn();Tr();WP=class e extends ts{constructor(r,n,i={}){let a=r,o=n;super(r,{folder:e.getFolderPath(n),extension:".md",cacheTTL:300*1e3,persistCache:!0,namespace:i.namespace||"trade",enableIndexing:!0,indexes:[{name:"trades",fields:["instrument","direction","pnl","entryTime","exitTime","account","setup","mistake","tags","assetType"],includeNested:!1,fileFilter:s=>{var c;if(!s.path.endsWith(".md"))return!1;let l=(c=a.metadataCache.getFileCache(s))==null?void 0:c.frontmatter;return l!=null&&l.isMissedTrade?!1:(l==null?void 0:l.type)==="trade"||(l==null?void 0:l.type)==="backtest-trade"?!0:s.path.includes("/trades/")&&o.isJournalPath(s.path)}},{name:"trade-unique-values",fields:["instrument","account","setup","mistake","tags"],includeNested:!1,valueExtractor:(s,l)=>Array.isArray(s[l])?s[l]:typeof s[l]=="string"?s[l].split(",").map(c=>c.trim()).filter(Boolean):s[l],fileFilter:s=>{var c;if(!s.path.endsWith(".md"))return!1;let l=(c=a.metadataCache.getFileCache(s))==null?void 0:c.frontmatter;return l!=null&&l.isMissedTrade?!1:(l==null?void 0:l.type)==="trade"||(l==null?void 0:l.type)==="backtest-trade"?!0:s.path.includes("/trades/")&&o.isJournalPath(s.path)}}]});this.tradesFolder="trades";this.folderPathService=n}static getFolderPath(r){return r.journalFolderPath}async updateTrade(r,n,i){var a,o,s,l,c,d,u,p,m,g,f;try{if(!r.entryTime)throw new Error("Entry time is required");if(!r.direction&&r.assetType!=="options")throw new Error("Direction is required");let v=yt({tradeStatus:r.tradeStatus,exitTime:r.exitTime,pnl:null,useDirectPnLInput:r.useDirectPnLInput,exits:r.exits,entries:r.entries});if(!v&&!r.exitTime&&!r.useDirectPnLInput)throw new Error("Exit time is required for closed trades");if(r.useDirectPnLInput)r.entryPrice===void 0&&(r.entryPrice=0),r.positionSize===void 0&&(r.positionSize=0),!v&&r.exitPrice===void 0&&(r.exitPrice=0);else{if(r.entryPrice===void 0)throw new Error("Entry price is required");if(r.positionSize===void 0)throw new Error("Position size is required");if(!v&&r.exitPrice===void 0)throw new Error("Exit price is required for closed trades")}if(!(r.accountIds&&r.accountIds.length>0||r.account&&r.account.length>0))throw new Error("At least one account is required");if(!await this.app.vault.adapter.exists(n))throw new Error(`Trade file does not exist: ${n}`);let b=this.app.vault.getAbstractFileByPath(n);if(!b||!(b instanceof ld.TFile))throw new Error(`Invalid file path: ${n}`);let k=this.app.metadataCache.getFileCache(b),x=k==null?void 0:k.frontmatter,S=x==null?void 0:x.entryTime,w=x==null?void 0:x.instrument,C=n,D=!1;if(S){let E=new Date(S),T=r.instrument?this.sanitizeTickerForFilename(r.instrument):"UNKNOWN",$=w?this.sanitizeTickerForFilename(w):"UNKNOWN",_=r.entryTime instanceof Date?r.entryTime:new Date(String(r.entryTime)),B=!this.areDatesOnSameDay(E,_),W=T!==$;if(B||W){let N=await this.generateNewTradePath(T,_),U=N.substring(0,N.lastIndexOf("/"));if(await this.ensureDirectoryExists(U),await this.app.vault.rename(b,N),n=N,D=!0,b=this.app.vault.getAbstractFileByPath(N),!b||!(b instanceof ld.TFile))throw new Error(`Failed to get file after relocation: ${N}`);let j=[];B&&j.push(`date: ${S} -> ${this.formatDateForFrontmatter(_)}`),W&&j.push(`ticker: ${$} -> ${T}`),console.log(`[TradeService] Trade file relocated (${j.join(", ")}): ${C} -> ${N}`)}}let P,M=!0;try{let E=this.app.vault.getAbstractFileByPath(n);if(E&&E instanceof ld.TFile){let T=(a=this.app.metadataCache.getFileCache(E))==null?void 0:a.frontmatter;T&&r.originalPnl!==void 0&&(M=T.entryPrice!==r.entryPrice||T.exitPrice!==r.exitPrice||T.positionSize!==r.positionSize||T.direction!==r.direction||T.commission!==r.commission||T.commissionType!==r.commissionType||T.fees!==r.fees||T.swap!==r.swap||T.directPnL!==r.directPnL||this.hasTradeStatusChanged(T,r)||T.contractSize!==r.contractSize||T.dollarPerPoint!==r.dollarPerPoint||T.tickSize!==r.tickSize||T.tickValue!==r.tickValue||T.lotSize!==r.lotSize||T.pipValue!==r.pipValue||T.leverageRatio!==r.leverageRatio||JSON.stringify(T.entries)!==JSON.stringify(r.entries)||JSON.stringify(T.exits)!==JSON.stringify(r.exits))}}catch(E){console.warn("Could not compare with existing data, will recalculate PNL:",E)}if(v?P=null:!M&&r.originalPnl!==void 0?P=r.originalPnl:r.useDirectPnLInput&&r.directPnL!==void 0?P=uc(r):P=uc(r),r.riskAmount===void 0&&r.stopLoss===void 0&&this.plugin){let E=this.plugin.settings.trade.defaultRiskAmount;E&&E>0&&(r.riskAmount=E)}let z=K_(r),A={type:"trade",entryTime:this.formatDateForFrontmatter(r.entryTime),entryPrice:r.entryPrice,positionSize:r.positionSize,direction:r.direction,tradeStatus:v?"OPEN":"CLOSED"};if(!v&&r.exitTime&&(A.exitTime=this.formatDateForFrontmatter(r.exitTime)),!v&&r.exitPrice!==void 0&&(A.exitPrice=r.exitPrice),!v&&P!==null&&(A.pnl=P),z!==null&&(A.rMultiple=z),(o=r.entries)!=null&&o.length){let E=r.entries.filter(T=>T&&T.time!==void 0&&T.price!==void 0&&T.size!==void 0&&T.size>0);A.entries=E.map(T=>{let $={time:this.formatDateForFrontmatter(T.time),price:T.price,size:T.size};return T.notional!==void 0&&($.notional=T.notional),$})}if((s=r.exits)!=null&&s.length){let E=r.exits.filter(T=>T&&T.time!==void 0&&T.price!==void 0&&T.size!==void 0&&T.size>0);A.exits=E.map(T=>{let $={time:this.formatDateForFrontmatter(T.time),price:T.price,size:T.size};return T.notional!==void 0&&($.notional=T.notional),$})}if(r.commission!==void 0&&(A.commission=r.commission),r.commissionType!==void 0&&(A.commissionType=r.commissionType),r.fees!==void 0&&(A.fees=r.fees),r.swap!==void 0&&(A.swap=r.swap),r.rebate!==void 0&&(A.rebate=r.rebate),r.riskAmount!==void 0&&(A.riskAmount=r.riskAmount),r.stopLoss!==void 0&&(A.stopLoss=r.stopLoss),r.mae!==void 0&&(A.mae=r.mae),r.mfe!==void 0&&(A.mfe=r.mfe),r.maePrice!==void 0&&(A.maePrice=r.maePrice),r.mfePrice!==void 0&&(A.mfePrice=r.mfePrice),(l=r.setupIds)!=null&&l.length&&(A.setupIds=r.setupIds),(c=r.mistakeIds)!=null&&c.length&&(A.mistakeIds=r.mistakeIds),(d=r.accountIds)!=null&&d.length&&(A.accountIds=r.accountIds),r.accountId&&(A.accountId=r.accountId),r.instrument&&(A.instrument=r.instrument),r.assetType&&(A.assetType=r.assetType),(u=r.setup)!=null&&u.length&&(A.setup=r.setup),(p=r.mistake)!=null&&p.length&&(A.mistake=r.mistake),(m=r.account)!=null&&m.length&&(A.account=r.account),r.images!==void 0&&(A.images=r.images.length>0?r.images.map(E=>E.trim()):[]),r.customTags&&Array.isArray(r.customTags)&&r.customTags.length>0?A.tags=r.customTags.map(E=>String(E).trim()).filter(E=>E.length>0):A.tags=[],A.thesis=this.formatThesisForYAML(r.thesis||""),r.assetType==="stock"?r.exchange&&(A.exchange=r.exchange):r.assetType==="options"?(r.expirationDate&&(A.expirationDate=this.formatDateForFrontmatter(r.expirationDate)),r.strikePrice!==void 0&&(A.strikePrice=r.strikePrice),r.optionType&&(A.optionType=r.optionType),r.contractSize!==void 0&&(A.contractSize=r.contractSize)):r.assetType==="futures"?(r.dollarPerPoint!==void 0&&(A.dollarPerPoint=r.dollarPerPoint),r.tickSize!==void 0&&(A.tickSize=r.tickSize),r.tickValue!==void 0&&(A.tickValue=r.tickValue)):r.assetType==="forex"?(r.lotSize!==void 0&&(A.lotSize=r.lotSize),r.pipValue!==void 0&&(A.pipValue=r.pipValue)):r.assetType==="crypto"?r.cryptoExchange&&(A.cryptoExchange=r.cryptoExchange):r.assetType==="cfd"&&r.leverageRatio!==void 0&&(A.leverageRatio=r.leverageRatio),r.lossReview&&(A.lossReview=r.lossReview),r.reviewed!==void 0&&(A.reviewed=r.reviewed),r.reviewedAt&&(A.reviewedAt=r.reviewedAt),r.useDirectPnLInput!==void 0&&(A.useDirectPnLInput=r.useDirectPnLInput),r.directPnL!==void 0&&(A.directPnL=r.directPnL),r.customFields)try{let E=(g=this.plugin)==null?void 0:g.customFieldsService;if(E){let T=E.getFields();Object.entries(r.customFields).forEach(([$,_])=>{if(_!=null&&_!==""){let B=T.find(W=>W.id===$);B&&B.fieldKey?A.hasOwnProperty(B.fieldKey)||(A[B.fieldKey]=_):A.hasOwnProperty($)||(A[$]=_)}})}else Object.entries(r.customFields).forEach(([T,$])=>{$!=null&&$!==""&&(A.hasOwnProperty(T)||(A[T]=$))})}catch(E){console.error("Error mapping custom field IDs to keys:",E),Object.entries(r.customFields).forEach(([T,$])=>{$!=null&&$!==""&&(A.hasOwnProperty(T)||(A[T]=$))})}await this.updateFrontmatter(b,A),this.app.metadataCache.trigger("changed",b);let I=P,L=0;try{let E=this.app.vault.getAbstractFileByPath(n);if(E&&E instanceof ld.TFile){let T=(f=this.app.metadataCache.getFileCache(E))==null?void 0:f.frontmatter;T&&T.pnl!==void 0&&(L=parseFloat(T.pnl))}}catch(E){console.warn("Could not determine old PnL, using 0:",E)}return i!=="user-input"&&setTimeout(()=>{xe.publish("trade:changed",{action:D?"relocated":"updated",filePaths:[n],oldFilePath:D?C:void 0})},100),await this.clearCacheWithPrefix("trade:"),n}catch(v){throw console.error("Error updating trade:",v),v}}get TRADES_FOLDER(){return this.tradesFolder}get JOURNALIT_FOLDER(){return this.folderPathService.journalFolderPath}async getUniqueInstruments(){if(this.isIndexingEnabled()){let i=this.getUniqueIndexValues("trade-unique-values","instrument");if(i.length>0)return i.filter(Boolean)}let n=(await this.getAllTrades()).map(i=>this.getTradeValue(i,"instrument")).filter(Boolean);return Array.from(new Set(n))}async getUniqueAccounts(){if(this.isIndexingEnabled()){let i=this.getUniqueIndexValues("trade-unique-values","account");if(i.length>0)return i.filter(Boolean)}let n=(await this.getAllTrades()).flatMap(i=>this.getTradeArrayValue(i,"account")).filter(Boolean);return Array.from(new Set(n))}getAccountService(){return null}getAccountPageService(){var r;return(r=this.plugin)==null?void 0:r.accountPageService}async getUniqueSetups(){if(this.isIndexingEnabled()){let i=this.getUniqueIndexValues("trade-unique-values","setup");if(i.length>0)return i.filter(Boolean)}let n=(await this.getAllTrades()).flatMap(i=>this.getTradeArrayValue(i,"setup")).filter(Boolean);return Array.from(new Set(n))}async getUniqueMistakes(){if(this.isIndexingEnabled()){let i=this.getUniqueIndexValues("trade-unique-values","mistake");if(i.length>0)return i.filter(Boolean)}let n=(await this.getAllTrades()).flatMap(i=>this.getTradeArrayValue(i,"mistake")).filter(Boolean);return Array.from(new Set(n))}formatThesisForYAML(r){if(!r||r.trim()==="")return'""';let n=r.trim();return n.includes(`
`)?`|
    ${n.replace(/\n/g,`
    `)}`:/[:|>[\]{}*&!%@`]/.test(n)||n.startsWith('"')||n.startsWith("'")||n.endsWith('"')||n.endsWith("'")||n.match(/^\s/)||n.match(/\s$/)?`"${n.replace(/"/g,'\\"')}"`:n}hasTradeStatusChanged(r,n){let i=this.determineLogicalTradeStatus(r),a=this.determineLogicalTradeStatus(n);return i!==a}determineLogicalTradeStatus(r){if(r.tradeStatus==="OPEN"||r.tradeStatus==="CLOSED")return r.tradeStatus;let n=r.exitTime!==void 0&&r.exitTime!==null,i=r.exitPrice!==void 0&&r.exitPrice!==null&&r.exitPrice>0,a=r.exits&&Array.isArray(r.exits)&&r.exits.length>0;return n&&i||a?"CLOSED":"OPEN"}async getUniqueTags(){if(this.isIndexingEnabled()){let i=this.getUniqueIndexValues("trade-unique-values","tags");if(i.length>0)return i.filter(Boolean)}let n=(await this.getAllTrades()).flatMap(i=>this.getTradeArrayValue(i,"tags")).filter(Boolean);return Array.from(new Set(n))}async getUniqueCustomTags(){let r=await this.getAllTrades(),n=[];for(let i of r)i.tags&&Array.isArray(i.tags)&&n.push(...i.tags);return Array.from(new Set(n.map(i=>String(i).trim()).filter(i=>i.length>0)))}async getTradeData(r){let n=this.app.vault.getFiles().filter(o=>o.path.endsWith(".md")),i=await this.getAllTrades(n,{useIndexes:!(r!=null&&r.fresh)});return await this.resolveTradePathsAsync(i,n)}async resolveTradePathsAsync(r,n){var c;if(r.filter(d=>d.path&&d.path.trim()!=="").length===r.length)return r;let a=n||this.app.vault.getFiles().filter(d=>d.path.endsWith(".md")),o=new Map;for(let d of a){let u=(c=this.app.metadataCache.getFileCache(d))==null?void 0:c.frontmatter;if(((u==null?void 0:u.type)==="trade"||(u==null?void 0:u.type)==="backtest-trade")&&u.instrument&&u.entryTime){let p=`${u.instrument}-${u.entryTime}-${u.direction||""}`;o.set(p,d)}}let s=100,l=[];for(let d=0;d<r.length;d+=s){let p=r.slice(d,d+s).map(m=>{if(m.path&&m.path.trim()!=="")return m;let g;if(m.instrument&&m.entryTime){let f=`${m.instrument}-${m.entryTime}-${m.direction||""}`;g=o.get(f)}return{...m,path:(g==null?void 0:g.path)||this.generateUniqueTradePath(m)}});l.push(...p),d+s<r.length&&await new Promise(m=>setTimeout(m,0))}return l}generateUniqueTradePath(r){var g;let n=r.entryTime instanceof Date?r.entryTime:new Date,i=n.getFullYear(),a=String(n.getMonth()+1).padStart(2,"0"),o=Bx(n,i),s=r.instrument?this.sanitizeTickerForFilename(r.instrument):"UNKNOWN",l=((g=this.plugin)==null?void 0:g.settings.trade.dateFormat)||"DDMMYY",c=String(n.getDate()).padStart(2,"0"),d="";l==="DDMMYY"?d=`${c}${a}${String(i).slice(2)}`:l==="MMDDYY"?d=`${a}${c}${String(i).slice(2)}`:l==="YYMMDD"?d=`${String(i).slice(2)}${a}${c}`:d=`${c}${a}${String(i).slice(2)}`;let u=Math.random().toString(36).substring(2,8),p=`${s}-${d}-T${u}.md`;return this.folderPathService.getPath(String(i),a,o,this.tradesFolder,p)}async readFrontmatter(r){return super.readFrontmatter(r)}getApp(){return this.app}async getAllTrades(r,n){let i="trade:all-trades";try{let a=await this.query(async()=>{let s=await this.getTradeFiles(r);if(s.length===0)return[];let l=10,c=[];for(let d=0;d<s.length;d+=l){let u=s.slice(d,d+l),p=await Promise.all(u.map(async m=>{try{return{...await this.readFrontmatter(m),path:m.path}}catch(g){return console.error(`Error processing trade file ${m.path}:`,g),{path:m.path}}}));c.push(...p),d+l<s.length&&await new Promise(m=>setTimeout(m,5))}return c},i,{offlineCapable:!0,useIndexes:(n==null?void 0:n.useIndexes)!==void 0?n.useIndexes:!0,useCache:(n==null?void 0:n.useIndexes)!==!1},{indexName:"trades",filters:{}});return Array.isArray(a)?a:[]}catch(a){return console.error("Error in getAllTrades:",a),[]}}getTradeValue(r,n){return r&&r[n]?String(r[n]):null}getTradeArrayValue(r,n){return!r||!r[n]?[]:Array.isArray(r[n])?r[n].map(String):String(r[n]).split(",").map(i=>i.trim()).filter(Boolean)}addRecentlyCreatedFile(r){this.recentlyCreatedFiles||(this.recentlyCreatedFiles=new Set),this.recentlyCreatedFiles.add(r),setTimeout(()=>{var n;(n=this.recentlyCreatedFiles)==null||n.delete(r)},1e4)}setPlugin(r){super.setPlugin(r),r.registerEvent(r.app.vault.on("delete",async n=>{if(n.path.includes("/trades/")&&n.path.endsWith(".md")){let i=(0,ld.normalizePath)(n.path);await this.handleTradeDeletion(i)}}))}async createTrade(r,n){var i,a,o,s,l,c,d,u,p,m,g;try{if(!r.entryTime)throw new Error("Entry time is required");if(!r.direction&&r.assetType!=="options")throw new Error("Direction is required");let f=yt({tradeStatus:r.tradeStatus,exitTime:r.exitTime,pnl:null,useDirectPnLInput:r.useDirectPnLInput,exits:r.exits,entries:r.entries});if(!f&&!r.exitTime)throw new Error("Exit time is required for closed trades");if(r.useDirectPnLInput)r.entryPrice===void 0&&(r.entryPrice=0),r.positionSize===void 0&&(r.positionSize=0),!f&&r.exitPrice===void 0&&(r.exitPrice=0);else{if(r.entryPrice===void 0)throw new Error("Entry price is required");if(r.positionSize===void 0)throw new Error("Position size is required");if(!f&&r.exitPrice===void 0)throw new Error("Exit price is required for closed trades")}if(!(r.accountIds&&r.accountIds.length>0||r.account&&r.account.length>0))throw new Error("At least one account is required");let h=this.getTargetFolderPath(r.entryTime);try{await this.app.vault.adapter.mkdir(h)}catch(w){}let y=await this.getTradeFilePath(r),b=await this.listFilesInFolder(h);if(await this.app.vault.adapter.exists(y))throw console.error(`Cannot create trade - File already exists at path: ${y}`),console.error(`Existing files in folder: ${JSON.stringify(b)}`),new Error(`File already exists: ${y}`);let x=this.generateTradeContent(r);this.recentlyCreatedFiles||(this.recentlyCreatedFiles=new Set),this.recentlyCreatedFiles.add(y),setTimeout(()=>{var w;(w=this.recentlyCreatedFiles)==null||w.delete(y)},1e4);let S=await this.app.vault.create(y,x);if(this.app.metadataCache.trigger("resolve",S),setTimeout(async()=>{xe.publish("trade:changed",{action:"created",filePaths:[y]})},500),await this.clearCacheWithPrefix("trade:"),(i=this.plugin)!=null&&i.settings.trade.autoOpenCreatedTrades&&!(n!=null&&n.suppressAutoOpen)){(a=this.plugin)!=null&&a.processorManager&&await this.plugin.processorManager.getTradeNoteProcessor();try{await this.plugin.openFile(y,!0),setTimeout(()=>{var w,C;(C=(w=this.plugin)==null?void 0:w.tradeNoteProcessor)==null||C.renderActiveComponent()},50)}catch(w){console.warn("Failed to auto-open created trade:",w)}}if((o=this.plugin)!=null&&o.settings.drc.autoCreateOnFirstTrade)try{let w=new Date(r.entryTime);if(this.plugin.drcService){let C=this.plugin.drcService.getDRCNotePath(w);await this.app.vault.adapter.exists(C)||await this.plugin.drcService.createDRC(w)}}catch(w){console.error("Failed to auto-create DRC for trade:",w)}if((l=(s=this.plugin)==null?void 0:s.settings.weekly)!=null&&l.autoCreateOnFirstTrade)try{let w=new Date(r.entryTime);if(this.plugin.weeklyReviewService){let C=this.plugin.weeklyReviewService.getWeeklyReviewPath(w);await this.app.vault.adapter.exists(C)||await this.plugin.weeklyReviewService.createWeeklyReview(w)}}catch(w){console.error("Failed to auto-create Weekly Review for trade:",w)}if((d=(c=this.plugin)==null?void 0:c.settings.monthly)!=null&&d.autoCreateOnFirstTrade)try{let w=new Date(r.entryTime);if(this.plugin.monthlyReviewService){let C=this.plugin.monthlyReviewService.getMonthlyReviewPath(w);await this.app.vault.adapter.exists(C)||await this.plugin.monthlyReviewService.createMonthlyReview(w)}}catch(w){console.error("Failed to auto-create Monthly Review for trade:",w)}if((p=(u=this.plugin)==null?void 0:u.settings.quarterly)!=null&&p.autoCreateOnFirstTrade)try{let w=new Date(r.entryTime);if(this.plugin.quarterlyReviewService){let C=await this.plugin.quarterlyReviewService.getQuarterlyReviewPath(w);await this.app.vault.adapter.exists(C)||await this.plugin.quarterlyReviewService.createQuarterlyReview(w)}}catch(w){console.error("Failed to auto-create Quarterly Review for trade:",w)}if((g=(m=this.plugin)==null?void 0:m.settings.yearly)!=null&&g.autoCreateOnFirstTrade)try{let w=new Date(r.entryTime),C=await this.plugin.serviceManager.getYearlyReviewService(),D=await C.getYearlyReviewPath(w);await this.app.vault.adapter.exists(D)||await C.createYearlyReview(w)}catch(w){console.error("Failed to auto-create Yearly Review for trade:",w)}return y}catch(f){throw console.error("Error creating trade:",f),f}}async getTrades(r,n){var d,u;await new Promise(p=>setTimeout(p,50));let i=Zt(r,this.plugin),a=Zt(n,this.plugin);a.setHours(23,59,59,999);let o=[];if(this.recentlyCreatedFiles&&this.recentlyCreatedFiles.size>0)for(let p of this.recentlyCreatedFiles){let m=this.app.vault.getAbstractFileByPath(p);if(m instanceof ld.TFile){let g=(d=this.app.metadataCache.getFileCache(m))==null?void 0:d.frontmatter;if((g==null?void 0:g.type)==="trade"&&(g!=null&&g.entryTime)){let f=new Date(g.entryTime),v=Zt(f,this.plugin);v>=i&&v<=a&&o.push(m)}}}if(this.isIndexingEnabled()&&this.indexManager)try{let m=this.queryIndex("trades",{},{}).filter(g=>{try{let f=g.values.entryTime;if(!f)return!1;let v=new Date(f),h=Zt(v,this.plugin);return h>=i&&h<=a}catch(f){return!1}});if(m.length>0){let f=[...m.map(v=>v.file)];for(let v of o)f.find(h=>h.path===v.path)||f.push(v);return f}if(o.length>0)return o}catch(p){console.warn("Error using index for date range query:",p)}let l=this.app.vault.getMarkdownFiles().filter(p=>(p.path.startsWith(this.folderPathService.journalFolderPath)&&p.path.includes(`/${this.tradesFolder}/`)||p.path.startsWith(this.tradesFolder))&&p.path.endsWith(".md"));for(let p of o)l.find(m=>m.path===p.path)||l.push(p);let c=[];for(let p of l)try{let m=(u=this.app.metadataCache.getFileCache(p))==null?void 0:u.frontmatter;if(!m||m.type!=="trade"&&m.type!=="backtest-trade")continue;if(m.entryTime){let g=new Date(m.entryTime),f=Zt(g,this.plugin);f>=i&&f<=a&&c.push(p)}}catch(m){console.warn(`Error checking trade file ${p.path}:`,m)}return c}async readTradeContent(r){return this.app.vault.read(r)}async extractTradeData(r){var n;try{let i=(n=this.app.metadataCache.getFileCache(r))==null?void 0:n.frontmatter;if(!i||i.type!=="trade"&&i.type!=="backtest-trade")return null;let a=yt({tradeStatus:i.tradeStatus,exitTime:i.exitTime,pnl:i.pnl,useDirectPnLInput:i.useDirectPnLInput,exits:i.exits,entries:i.entries});return{path:r.path,instrument:i.instrument||"Unknown",direction:i.direction||(i.assetType==="options"&&i.optionType?i.optionType:"Unknown"),tradeStatus:i.tradeStatus||(a?"OPEN":"CLOSED"),entryPrice:parseFloat(i.entryPrice)||0,exitPrice:a?null:parseFloat(i.exitPrice)||0,positionSize:parseFloat(i.positionSize)||0,pnl:a?null:parseFloat(i.pnl)||0,commission:parseFloat(i.commission)||0,swap:parseFloat(i.swap)||0,fees:parseFloat(i.fees)||0,rebate:i.rebate!=null&&i.rebate!==""?parseFloat(i.rebate):void 0,riskAmount:i.riskAmount!=null&&i.riskAmount!==""?parseFloat(i.riskAmount):void 0,stopLoss:i.stopLoss!=null&&i.stopLoss!==""?parseFloat(i.stopLoss):void 0,mae:i.mae!=null&&i.mae!==""?parseFloat(i.mae):void 0,mfe:i.mfe!=null&&i.mfe!==""?parseFloat(i.mfe):void 0,maePrice:i.maePrice!=null&&i.maePrice!==""?parseFloat(i.maePrice):void 0,mfePrice:i.mfePrice!=null&&i.mfePrice!==""?parseFloat(i.mfePrice):void 0,entryTime:i.entryTime?new Date(i.entryTime):new Date,exitTime:a?null:i.exitTime?new Date(i.exitTime):new Date(i.entryTime||new Date),entries:i.entries&&Array.isArray(i.entries)?i.entries.map(o=>({time:o.time?new Date(o.time):null,price:parseFloat(o.price)||0,size:parseFloat(o.size)||0,notional:o.notional!==void 0?parseFloat(o.notional):void 0})):[],exits:i.exits&&Array.isArray(i.exits)?i.exits.map(o=>({time:o.time?new Date(o.time):null,price:parseFloat(o.price)||0,size:parseFloat(o.size)||0,notional:o.notional!==void 0?parseFloat(o.notional):void 0})):[],setup:Array.isArray(i.setup)?i.setup.filter(o=>typeof o=="string"&&!o.includes("/")).map(o=>o.trim()):[],mistake:Array.isArray(i.mistake)?i.mistake.filter(o=>typeof o=="string"&&!o.includes("/")).map(o=>o.trim()):[],account:i.account,accountIds:i.accountIds,accountId:i.accountId,thesis:i.thesis,images:i.images&&Array.isArray(i.images)?i.images:[],tags:i.tags,assetType:i.assetType,optionType:i.optionType,reviewed:i.reviewed||!1,reviewedAt:i.reviewedAt,currency:i.currency}}catch(i){return console.error(`Error extracting trade data from ${r.path}:`,i),null}}async updateLossReview(r,n,i="unknown"){try{let a=this.app.vault.getAbstractFileByPath(r);if(!a||!(a instanceof ld.TFile))throw new Error(`Invalid file path: ${r}`);await this.app.fileManager.processFrontMatter(a,o=>{o.lossReview=n}),await yn(this.app,a),i!=="user-input"&&xe.publish("trade:changed",{action:"loss-review-updated",filePaths:[r]})}catch(a){throw console.error(`[TradeService] Error updating loss review for ${r}:`,a),a}}async updateTradeReviewStatus(r,n,i,a="unknown"){try{let o=this.app.vault.getAbstractFileByPath(r);if(!o||!(o instanceof ld.TFile))throw new Error(`Invalid file path: ${r}`);await this.app.fileManager.processFrontMatter(o,s=>{s.reviewed=n,s.reviewedAt=i}),await yn(this.app,o),xe.publish("trade:changed",{action:"review-status-updated",filePaths:[r]})}catch(o){throw console.error(`[TradeService] Error updating review status for ${r}:`,o),o}}async getTradeFiles(r){let n=r||this.app.vault.getFiles().filter(s=>s.path.endsWith(".md"));return(await Promise.all(n.map(async s=>{try{let l=await this.app.vault.adapter.exists(s.path);return{file:s,exists:l}}catch(l){return console.warn(`Error checking file existence for ${s.path}:`,l),{file:s,exists:!1}}}))).filter(({exists:s})=>s).map(({file:s})=>s).filter(s=>{var d;if(!this.folderPathService.isJournalPath(s.path))return!1;let l=(d=this.app.metadataCache.getFileCache(s))==null?void 0:d.frontmatter;return l?l!=null&&l.isMissedTrade?!1:!!((l==null?void 0:l.type)==="trade"||(l==null?void 0:l.type)==="backtest-trade"||s.path.includes(`/${this.tradesFolder}/`)):!!s.path.includes(`/${this.tradesFolder}/`)})}sanitizeTickerForFilename(r){if(!r)return"UNKNOWN";let n=r.trim().toUpperCase();if(n=n.replace(/[\\\/:\*\?"<>|\+]/g,"").replace(/[\s.\[\]\(\)\{\}#%&=;]/g,"-").replace(/--+/g,"-").replace(/^-|-$/g,""),!n)return"UNKNOWN";let i=20;return n.length>i&&(n=n.substring(0,i)),n}getWeekOfMonth(r){return dc(r)}areDatesOnSameDay(r,n){return isNaN(r.getTime())||isNaN(n.getTime())?!1:r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()&&r.getDate()===n.getDate()}async getTradePathComponents(r){var l;let n=r.getFullYear().toString(),i=String(r.getMonth()+1).padStart(2,"0"),a=this.getWeekOfMonth(r),o=((l=this.plugin)==null?void 0:l.settings.trade.dateFormat)||"DDMMYY",s=this.formatDateForFilename(r,o);return{year:n,month:i,weekOfMonth:a,formattedDate:s}}getTradeFilePath(r){let n=r.instrument?this.sanitizeTickerForFilename(r.instrument):"UNKNOWN",i=r.entryTime instanceof Date?r.entryTime:new Date(String(r.entryTime));if(isNaN(i.getTime()))throw new Error(`Invalid entryTime when generating trade path: ${String(r.entryTime)}`);return this.generateNewTradePath(n,i)}async generateNewTradePath(r,n){var v;if(!(n instanceof Date)||isNaN(n.getTime()))throw new Error(`Invalid date passed to generateNewTradePath: ${String(n)}`);let i=this.sanitizeTickerForFilename(r),a=n.getFullYear(),o=n.getMonth()+1,s=String(o).padStart(2,"0"),l=String(n.getDate()).padStart(2,"0"),c=Bx(n,a),d=((v=this.plugin)==null?void 0:v.settings.trade.dateFormat)||"DDMMYY",u="";d==="DDMMYY"?u=`${l}${s}${String(a).slice(2)}`:d==="MMDDYY"?u=`${s}${l}${String(a).slice(2)}`:d==="YYMMDD"?u=`${String(a).slice(2)}${s}${l}`:u=`${l}${s}${String(a).slice(2)}`;let p=await this.getTradeNumberForDay(i,n),m=`${i}-${u}-T${p}.md`,g=Oi(o);return this.folderPathService.getDatePathForQuarterSync(String(a),g,s,c,this.tradesFolder,m)}async getTradeNumberForDay(r,n){var p;let i=this.getTargetFolderPath(n),a=await this.listFilesInFolder(i),o=((p=this.plugin)==null?void 0:p.settings.trade.dateFormat)||"DDMMYY",s=this.formatDateForFilename(n,o),l=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),c=new RegExp(`^${l}-${s}-T(\\d+)\\.md$`),d=0;for(let m of a){let g=m.split("/").pop()||"",f=c.exec(g);if(f){let v=parseInt(f[1],10);d=Math.max(d,v)}}return d+1}async listFilesInFolder(r){try{if(!await this.app.vault.adapter.exists(r))try{return await this.app.vault.adapter.mkdir(r),[]}catch(a){return console.warn(`Error creating folder ${r}:`,a),[]}return(await this.app.vault.adapter.list(r)).files||[]}catch(n){return console.warn(`Error listing files in folder ${r}:`,n),[]}}async ensureDirectoryExists(r){let i=(0,ld.normalizePath)(r).split("/"),a="";for(let o of i)if(o&&(a+=(a?"/":"")+o,!this.app.vault.getAbstractFileByPath(a)))try{await this.app.vault.createFolder(a)}catch(s){if(!this.app.vault.getAbstractFileByPath(a))throw s}}getTargetFolderPath(r){let n=r.getFullYear(),i=r.getMonth()+1,a=String(i).padStart(2,"0"),o=Bx(r,n),s=Oi(i);return this.folderPathService.getDatePathForQuarterSync(String(n),s,a,o,this.tradesFolder)}async deleteImage(r){try{let n=(0,ld.normalizePath)(r);return await this.app.vault.adapter.exists(n)?(await this.app.vault.adapter.remove(n),!0):!1}catch(n){return n.code==="ENOENT"||console.error(`Failed to delete image ${r}:`,n),!1}}async deleteEmptyFolder(r){try{let n=(0,ld.normalizePath)(r);if(!await this.app.vault.adapter.exists(n))return!1;let{files:a=[],folders:o=[]}=await this.app.vault.adapter.list(n);return a.length===0&&o.length===0?(await this.app.vault.adapter.rmdir(n,!1),!0):!1}catch(n){return n.code==="ENOENT"||console.error(`Failed to delete folder ${r}:`,n),!1}}formatDateForFilename(r,n){let i=String(r.getDate()).padStart(2,"0"),a=String(r.getMonth()+1).padStart(2,"0"),o=String(r.getFullYear()).slice(2);switch(n){case"DDMMYY":return`${i}${a}${o}`;case"MMDDYY":return`${a}${i}${o}`;case"YYMMDD":return`${o}${a}${i}`;default:return`${i}${a}${o}`}}formatDateForFrontmatter(r){try{let n=r instanceof Date?r:new Date(r);if(isNaN(n.getTime()))return console.error(`Invalid date value: ${r}, returning as-is`),String(r);let i=n.getFullYear(),a=String(n.getMonth()+1).padStart(2,"0"),o=String(n.getDate()).padStart(2,"0"),s=String(n.getHours()).padStart(2,"0"),l=String(n.getMinutes()).padStart(2,"0"),c=String(n.getSeconds()).padStart(2,"0");return`${i}-${a}-${o}T${s}:${l}:${c}`}catch(n){return console.error(`Error formatting date: ${r}`,n),r instanceof Date?r.toISOString():String(r)}}buildFrontmatterObject(r,n,i,a){var s,l,c,d,u,p,m,g,f;let o={type:"trade",entryTime:this.formatDateForFrontmatter(r.entryTime),entryPrice:r.entryPrice,positionSize:r.positionSize,tradeStatus:a?"OPEN":"CLOSED"};if(r.direction&&(o.direction=r.direction),a||(r.exitTime&&(o.exitTime=this.formatDateForFrontmatter(r.exitTime)),r.exitPrice!==void 0&&(o.exitPrice=r.exitPrice),n!==null&&(o.pnl=n)),i!==null&&(o.rMultiple=i),(s=r.entries)!=null&&s.length&&(o.entries=r.entries.filter(v=>v&&v.time&&v.price!==void 0&&v.size!==void 0&&v.size>0).map(v=>{let h={time:this.formatDateForFrontmatter(v.time),price:v.price,size:v.size};return v.notional!==void 0&&(h.notional=v.notional),h})),(l=r.exits)!=null&&l.length&&(o.exits=r.exits.filter(v=>v&&v.time&&v.price!==void 0&&v.size!==void 0&&v.size>0).map(v=>{let h={time:this.formatDateForFrontmatter(v.time),price:v.price,size:v.size};return v.notional!==void 0&&(h.notional=v.notional),h})),r.commission!==void 0&&(o.commission=r.commission),r.commissionType!==void 0&&(o.commissionType=r.commissionType),r.swap!==void 0&&(o.swap=r.swap),r.fees!==void 0&&(o.fees=r.fees),r.rebate!==void 0&&(o.rebate=r.rebate),r.riskAmount!==void 0&&(o.riskAmount=r.riskAmount),r.stopLoss!==void 0&&(o.stopLoss=r.stopLoss),r.currency&&(o.currency=r.currency),r.mae!==void 0&&(o.mae=r.mae),r.mfe!==void 0&&(o.mfe=r.mfe),r.maePrice!==void 0&&(o.maePrice=r.maePrice),r.mfePrice!==void 0&&(o.mfePrice=r.mfePrice),(c=r.setupIds)!=null&&c.length&&(o.setupIds=r.setupIds),(d=r.mistakeIds)!=null&&d.length&&(o.mistakeIds=r.mistakeIds),(u=r.accountIds)!=null&&u.length&&(o.accountIds=r.accountIds),r.accountId&&(o.accountId=r.accountId),r.instrument&&(o.instrument=r.instrument),r.assetType&&(o.assetType=r.assetType),(p=r.setup)!=null&&p.length&&(o.setup=r.setup),(m=r.mistake)!=null&&m.length&&(o.mistake=r.mistake),(g=r.account)!=null&&g.length&&(o.account=r.account),r.images!==void 0&&(o.images=r.images.length>0?r.images.map(v=>v.trim()):[]),r.customTags&&Array.isArray(r.customTags)&&r.customTags.length>0?o.tags=r.customTags.map(v=>String(v).trim()).filter(v=>v.length>0):o.tags=[],o.thesis=this.formatThesisForYAML(r.thesis||""),r.assetType==="stock"&&r.exchange&&(o.exchange=r.exchange),r.assetType==="options"&&(r.expirationDate&&(o.expirationDate=this.formatDateForFrontmatter(r.expirationDate)),r.strikePrice!==void 0&&(o.strikePrice=r.strikePrice),r.optionType&&(o.optionType=r.optionType),r.contractSize!==void 0&&(o.contractSize=r.contractSize)),r.assetType==="futures"&&(r.dollarPerPoint!==void 0&&(o.dollarPerPoint=r.dollarPerPoint),r.tickSize!==void 0&&(o.tickSize=r.tickSize),r.tickValue!==void 0&&(o.tickValue=r.tickValue)),r.assetType==="forex"&&(r.lotSize!==void 0&&(o.lotSize=r.lotSize),r.pipValue!==void 0&&(o.pipValue=r.pipValue)),r.assetType==="crypto"&&r.cryptoExchange&&(o.cryptoExchange=r.cryptoExchange),r.assetType==="cfd"&&r.leverageRatio!==void 0&&(o.leverageRatio=r.leverageRatio),r.useDirectPnLInput!==void 0&&(o.useDirectPnLInput=r.useDirectPnLInput),r.directPnL!==void 0&&(o.directPnL=r.directPnL),r.customFields)try{let v=(f=this.plugin)==null?void 0:f.customFieldsService;if(v){let h=v.getFields(),y=new Set;Object.entries(r.customFields).forEach(([b,k])=>{if(k!=null&&k!==""){let x=h.find(w=>w.id===b),S=x&&x.fieldKey?x.fieldKey:b;if(o.hasOwnProperty(S)||y.has(S))return;y.add(S),o[S]=k}})}}catch(v){console.error("Error processing custom fields:",v)}return o}serializeFrontmatter(r){let n=["---"];for(let[i,a]of Object.entries(r))a!=null&&(Array.isArray(a)?a.length===0?n.push(`${i}: []`):typeof a[0]=="object"?i==="entries"||i==="exits"?(n.push(`${i}:`),a.forEach(o=>{n.push(`  - time: ${o.time}`),n.push(`    price: ${o.price}`),n.push(`    size: ${o.size}`)})):(n.push(`${i}:`),a.forEach(o=>{n.push(`  - ${JSON.stringify(o)}`)})):(n.push(`${i}:`),a.forEach(o=>{let s=typeof o=="string"?o:String(o);n.push(`  - ${s}`)})):typeof a=="string"&&a.includes(`
`)?n.push(`${i}: ${a}`):n.push(`${i}: ${a}`));return n.push("---"),n.join(`
`)}generateTradeContent(r){let n=uc(r);if(r.riskAmount===void 0&&r.stopLoss===void 0&&this.plugin){let d=this.plugin.settings.trade.defaultRiskAmount;d&&d>0&&(r.riskAmount=d)}let i=K_(r),a=yt({tradeStatus:r.tradeStatus,exitTime:r.exitTime,pnl:n,useDirectPnLInput:r.useDirectPnLInput,exits:r.exits,entries:r.entries}),o=a?null:n,s=this.buildFrontmatterObject(r,o,i,a);return[this.serializeFrontmatter(s),"","# Trade Notes","",r.notes||"<!-- Add your trade notes here -->"].join(`
`)}extractDateFromTradePath(r){try{let n=r.match(/([A-Z]+)-(\d{6,8})-[TMB]\d+\.md$/);if(!n)return null;let i=n[2];if(i.length===8){let a=parseInt(i.substring(0,4)),o=parseInt(i.substring(4,6))-1,s=parseInt(i.substring(6,8));return new Date(a,o,s)}else if(i.length===6){let a=parseInt(i.substring(0,2)),o=parseInt(i.substring(2,4))-1,s=2e3+parseInt(i.substring(4,6));return new Date(s,o,a)}return null}catch(n){return console.error("Error extracting date from trade path:",n),null}}async handleTradeDeletion(r){try{await this.clearCache();try{let n=this.app.vault.adapter;if(n&&n.list){let i=this.folderPathService.journalFolderPath;try{await n.list(i)}catch(a){}}}catch(n){}await new Promise(n=>setTimeout(n,300)),setTimeout(()=>{xe.publish("trade:changed",{action:"deleted",filePaths:[r]})},500)}catch(n){console.error("Error handling trade deletion:",n)}}}});function hu(e,t){let r={...e};return t&&Object.keys(t).forEach(n=>{let i=new RegExp(`{${n}}`,"g");r.message=r.message.replace(i,t[n]),r.detail&&(r.detail=r.detail.replace(i,t[n]))}),r}function aV(e){if(!e)return ws.OFFLINE_MODE.basic;let t=new Date,r=Math.ceil((e.getTime()-t.getTime())/(1e3*60*60*24));return r<=0?ws.OFFLINE_MODE.expired:{...ws.OFFLINE_MODE.active,detail:ws.OFFLINE_MODE.graceRemaining(r).message}}var ws,s0e=F(()=>{ws={NEEDS_AUTH:{title:"Authentication Required",message:"Sign in to access Pro features. Basic features are still available.",action:"Sign In"},TOKEN_EXPIRED:{title:"Session Expired",message:"Your session has expired. Please sign in again to continue using Pro features.",action:"Reconnect"},AUTH_FAILED:{title:"Authentication Failed",message:"Unable to authenticate. Please try again.",action:"Retry"},NEEDS_PREMIUM:{title:"Pro Feature",message:"This is a Pro feature. Visit our website to subscribe and unlock:",features:["\u2726 Advanced trade management","\u2726 Custom dashboard layouts","\u2726 Multi-account support","\u2726 Advanced metrics","\u2726 Broker integration"],action:"Upgrade Now"},OFFLINE_MODE:{active:{title:"Offline Mode Active",message:"Working in offline mode. Some Pro features may be limited.",detail:"Your offline grace period allows continued access to Pro features."},expired:{title:"Offline Access Expired",message:"Offline grace period expired. Please reconnect to continue using Pro features.",action:"Reconnect Now"},basic:{title:"Basic Features Available",message:"Working offline. Basic features are still available.",detail:"Connect to access Pro features."},graceRemaining:e=>({message:`Offline grace period: ${e} days remaining`})},NETWORK_ERROR:{premium:{title:"Connection Error",message:"Unable to verify Pro access. Check your connection or continue with basic features.",action:"Retry Connection"},basic:{title:"Working Offline",message:"Working offline. Basic features are still available.",detail:"Will automatically sync when connection is restored."},sync:{title:"Sync Failed",message:"Unable to sync latest changes. Will retry when connection is restored.",detail:"Your changes are safely stored locally."}},STATUS:{connecting:"Signing in...",connected:"Signed in successfully",disconnected:"Signed out",syncing:"Syncing with server...",syncComplete:"Sync complete",syncFailed:"Sync failed"}}});var l0e,dv,uv,oV=F(()=>{l0e=require("obsidian"),dv=new l0e.Events,uv={STATE_CHANGED:"auth-state-changed"}});var $P,MO,c0e=F(()=>{$P=require("obsidian");yf();MO=class{constructor(t){this.masterKey=null;this.masterSalt=null;this.app=t}get KEY_PATH(){return`${this.app.vault.configDir}/plugins/journalit/keys.json`}async migrateOldKeys(){let t=".journalit/keys.json",r=this.app.vault.adapter;try{if(await r.exists(t)){Le.log("Found old keys at .journalit/keys.json, migrating...");let n=await r.read(t),i=`${this.app.vault.configDir}/plugins/journalit`;await r.exists(i)||await r.mkdir(i),await r.write(this.KEY_PATH,n),await r.remove(t);try{await r.rmdir(".journalit",!1)}catch(a){}Le.log("[KeyManager] Migrated keys to plugin directory")}}catch(n){Le.error("[KeyManager] Error migrating old keys:",n)}}async initialize(){await this.migrateOldKeys();try{let t=await this.loadKeyStorage();t?(this.masterSalt=new Uint8Array(t.masterSalt),await this.deriveMasterKey(),await this.verifyMasterKey(t.verificationData)||(Le.warn("Master key verification failed, generating new key"),await this.generateNewMasterKey())):await this.generateNewMasterKey()}catch(t){Le.error("Failed to initialize key manager:",t),await this.generateNewMasterKey()}}async generateNewMasterKey(){try{this.masterSalt=crypto.getRandomValues(new Uint8Array(16)),await this.deriveMasterKey();let t=crypto.getRandomValues(new Uint8Array(16));await this.saveKeyStorage({masterSalt:Array.from(this.masterSalt),verificationData:Array.from(t)})}catch(t){throw Le.error("Failed to generate new master key:",t),t}}async deriveMasterKey(){try{if(!this.masterSalt)throw new Error("Master salt not initialized");let t=await this.getDeviceInfo(),n=new TextEncoder().encode(t);if(!crypto.subtle&&$P.Platform.isDesktopApp){try{let a=require("crypto").webcrypto;a&&a.subtle&&(crypto.subtle=a.subtle)}catch(a){}if(!crypto.subtle){this.masterKey="mock-master-key";return}}let i=await crypto.subtle.importKey("raw",n,{name:"PBKDF2"},!1,["deriveBits","deriveKey"]);this.masterKey=await crypto.subtle.deriveKey({name:"PBKDF2",salt:this.masterSalt,iterations:1e5,hash:"SHA-256"},i,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}catch(t){throw Le.error("Failed to derive master key:",t),t}}async verifyMasterKey(t){try{if(!this.masterKey)return!1;if(!crypto.subtle)return!0;let r=new Uint8Array(12).fill(1),n=new Uint8Array([1,2,3,4,5]),i=await crypto.subtle.encrypt({name:"AES-GCM",iv:r},this.masterKey,n),a=await crypto.subtle.decrypt({name:"AES-GCM",iv:r},this.masterKey,i),o=new Uint8Array(a);if(o.length!==n.length)return!1;for(let s=0;s<n.length;s++)if(o[s]!==n[s])return!1;return!0}catch(r){return Le.error("Master key verification failed:",r),!1}}async getDeviceInfo(){var t,r;try{let n=[],i=this.app.vault.getName();n.push(`vault:${i}`);try{let a=this.app.vault.adapter.basePath;a&&n.push(`path:${a}`)}catch(a){}n.push(`ua:${navigator.userAgent}`),n.push(`screen:${window.screen.width}x${window.screen.height}`),n.push(`lang:${navigator.language}`);try{let a=(r=(t=window.journalitPlugin)==null?void 0:t.authManager)==null?void 0:r.getUserId();a&&n.push(`user:${a}`)}catch(a){}return n.join("|")}catch(n){return Le.error("Failed to get device info:",n),`vault:${this.app.vault.getName()}|time:${Date.now()}`}}async loadKeyStorage(){try{let t=this.app.vault.adapter;if(!await t.exists(this.KEY_PATH))return null;let r=await t.read(this.KEY_PATH);return r?JSON.parse(r):null}catch(t){return Le.error("Failed to load key storage:",t),null}}async saveKeyStorage(t){try{let r=this.app.vault.adapter,n=`${this.app.vault.configDir}/plugins/journalit`;await r.exists(n)||await r.mkdir(n),await r.write(this.KEY_PATH,JSON.stringify(t))}catch(r){throw Le.error("Failed to save key storage:",r),r}}async deriveEncryptionKey(t){try{if(!this.masterKey)throw new Error("Master key not initialized");let r=crypto.getRandomValues(new Uint8Array(12));if(!crypto.subtle&&$P.Platform.isDesktopApp){try{let l=require("crypto").webcrypto;l&&l.subtle&&(crypto.subtle=l.subtle)}catch(l){}if(!crypto.subtle)return this.masterKey="mock-master-key",{key:this.masterKey,iv:r}}let i=new TextEncoder().encode(t),a=await crypto.subtle.exportKey("raw",this.masterKey),o=await crypto.subtle.importKey("raw",a,{name:"PBKDF2"},!1,["deriveBits","deriveKey"]);return{key:await crypto.subtle.deriveKey({name:"PBKDF2",salt:i,iterations:1e4,hash:"SHA-256"},o,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"]),iv:r}}catch(r){throw Le.error("Failed to derive encryption key:",r),r}}async encrypt(t){try{let r=`encrypt-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,{key:n,iv:i}=await this.deriveEncryptionKey(r);if(!crypto.subtle&&$P.Platform.isDesktopApp){try{let l=require("crypto").webcrypto;l&&l.subtle&&(crypto.subtle=l.subtle)}catch(l){}if(!crypto.subtle)return this.masterKey="mock-master-key",btoa(unescape(encodeURIComponent(JSON.stringify(t))))}if(!crypto.subtle||typeof this.masterKey=="string")return btoa(unescape(encodeURIComponent(JSON.stringify(t))));let o=new TextEncoder().encode(JSON.stringify(t)),s=await crypto.subtle.encrypt({name:"AES-GCM",iv:i},n,o);return JSON.stringify({data:Array.from(new Uint8Array(s)),iv:Array.from(i),purpose:r})}catch(r){throw Le.error("Failed to encrypt data:",r),r}}async decrypt(t){try{let r;try{r=JSON.parse(t)}catch(c){return JSON.parse(decodeURIComponent(escape(atob(t))))}let{data:n,iv:i,purpose:a}=r,{key:o}=await this.deriveEncryptionKey(a);if(!crypto.subtle&&$P.Platform.isDesktopApp){try{let c=require("crypto").webcrypto;c&&c.subtle&&(crypto.subtle=c.subtle)}catch(c){}if(!crypto.subtle)return this.masterKey="mock-master-key",{test:"value"}}if(!crypto.subtle||typeof this.masterKey=="string")return JSON.parse(decodeURIComponent(escape(atob(t))));let s=await crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(i)},o,new Uint8Array(n)),l=new TextDecoder;return JSON.parse(l.decode(s))}catch(r){throw Le.error("Failed to decrypt data:",r),r}}async cleanup(){try{let t=this.app.vault.adapter;await t.exists(this.KEY_PATH)&&(await t.remove(this.KEY_PATH),Le.log("Key storage removed during cleanup")),this.masterKey=null,this.masterSalt=null}catch(t){Le.error("Failed to clean up key storage:",t)}}}});var Ro,gk,d0e=F(()=>{Ro=require("obsidian");s0e();oV();yf();c0e();wq();vm();gk=class{constructor(t,r){this.state={isAuthenticated:!1,token:null,error:null,cache:null,isOffline:!1};this.GRACE_PERIOD_DAYS=7;this.BETA_EXPIRY_DAYS=42;this.app=t,this.serverUrl=r.replace(/\/+$/,""),this.keyManager=new MO(t),this.initializeAuth()}get CONFIG_PATH(){return`${this.app.vault.configDir}/plugins/journalit/auth.json`}async initializeAuth(){try{await this.keyManager.initialize(),await this.loadStoredAuth()}catch(t){Le.error("Failed to initialize auth:",t),this.resetAuthState("Initialization failed")}}async migrateOldConfig(){let t=".journalit/auth.json",r=this.app.vault.adapter;try{if(await r.exists(t)){Le.log("Found old auth config at .journalit/auth.json, migrating...");let n=await r.read(t),i=`${this.app.vault.configDir}/plugins/journalit`;await r.exists(i)||await r.mkdir(i),await r.write(this.CONFIG_PATH,n),await r.remove(t);try{await r.rmdir(".journalit",!1)}catch(a){}Le.log("[AuthManager] Migrated config to plugin directory")}}catch(n){Le.error("[AuthManager] Error migrating old config:",n)}}async loadStoredAuth(){let t=this.app.vault.adapter;await this.migrateOldConfig();try{let r=`${this.app.vault.configDir}/plugins/journalit`;if(await t.exists(r)||(Le.log("Creating auth config directory"),await t.mkdir(r)),!await t.exists(this.CONFIG_PATH)){Le.log("No stored auth config found");return}Le.log("Loading stored auth configuration");let n=await t.read(this.CONFIG_PATH);if(!n){Le.warn("Auth config file exists but is empty");return}let i=await this.decryptData(n);if(!i.token||!i.userId||!i.roles)throw new Error("Stored auth config is incomplete");let a=new Date(i.graceEnd),o=new Date(i.lastVerified),s=i.tokenExpiry?new Date(i.tokenExpiry):void 0;if(isNaN(a.getTime())||isNaN(o.getTime()))throw new Error("Invalid dates in stored config");if(s&&isNaN(s.getTime()))throw new Error("Invalid token expiry date in stored config");this.state.token=i.token,this.state.isAuthenticated=!0,this.state.cache={userId:i.userId,email:i.email,roles:i.roles,features:this.getFeaturesFromRoles(i.roles),graceEnd:a,lastVerified:o,tokenExpiry:s,subscriptionStatus:i.subscriptionStatus,isBeta:i.isBeta},this.updateSubscriptionTier(),Bt.setAuthToken(this.state.token.access_token),Le.log("Successfully loaded stored auth:",{userId:i.userId,email:i.email,roles:i.roles.length,features:this.state.cache.features.length,graceEnd:a.toISOString(),lastVerified:o.toISOString(),tokenExpiry:s==null?void 0:s.toISOString(),isBeta:i.isBeta}),dv.trigger(uv.STATE_CHANGED)}catch(r){Le.error("Failed to load auth config:",{error:r,path:this.CONFIG_PATH,errorType:r instanceof Error?r.name:typeof r,message:r instanceof Error?r.message:"Unknown error"}),this.resetAuthState("Failed to load auth config");try{await t.exists(this.CONFIG_PATH)&&(await t.remove(this.CONFIG_PATH),Le.log("Removed corrupted auth config"))}catch(n){Le.error("Failed to remove corrupted config:",n)}}}async storeAuthConfig(){var t,r,n;if(!this.state.token||!this.state.cache){Le.log("Cannot store auth config - missing token or cache:",{hasToken:!!this.state.token,hasCache:!!this.state.cache});return}try{Le.log("Attempting to store auth config with state:",{hasRoles:!!this.state.cache.roles,hasSubscriptionStatus:!!this.state.cache.subscriptionStatus,hasGraceEnd:!!this.state.cache.graceEnd,graceEndType:this.state.cache.graceEnd?typeof this.state.cache.graceEnd:"undefined",hasLastVerified:!!this.state.cache.lastVerified,lastVerifiedType:this.state.cache.lastVerified?typeof this.state.cache.lastVerified:"undefined",hasUserId:!!this.state.cache.userId});let i={token:this.state.token,roles:this.state.cache.roles,subscriptionStatus:this.state.cache.subscriptionStatus,graceEnd:(t=this.state.cache.graceEnd)==null?void 0:t.toISOString(),lastVerified:(r=this.state.cache.lastVerified)==null?void 0:r.toISOString(),tokenExpiry:(n=this.state.cache.tokenExpiry)==null?void 0:n.toISOString(),userId:this.state.cache.userId,email:this.state.cache.email,isBeta:this.state.cache.isBeta};Le.log("Config data prepared:",{hasToken:!!i.token,hasRoles:!!i.roles,hasGraceEnd:!!i.graceEnd,hasLastVerified:!!i.lastVerified,hasUserId:!!i.userId});let a=await this.encryptData(i);await this.app.vault.adapter.write(this.CONFIG_PATH,a)}catch(i){throw Le.error("Failed to store auth config:",i),i}}async encryptData(t){try{return await this.keyManager.encrypt(t)}catch(r){throw Le.error("Failed to encrypt data:",r),r}}async decryptData(t){try{let r=JSON.parse(t);return r.key&&r.iv&&r.data?await this.legacyDecryptData(t):await this.keyManager.decrypt(t)}catch(r){throw Le.error("Failed to decrypt data:",r),r}}async legacyDecryptData(t){try{let{data:r,iv:n,key:i}=JSON.parse(t),a=await crypto.subtle.importKey("raw",new Uint8Array(i),{name:"AES-GCM",length:256},!1,["decrypt"]),o=await crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(n)},a,new Uint8Array(r)),s=new TextDecoder;return JSON.parse(s.decode(o))}catch(r){throw Le.error("Legacy decryption failed:",r),r}}getFeaturesFromRoles(t){let r=["basic-trades","basic-dashboard","trade-list"];return(t.includes("journalit-premium")||t.includes("admin"))&&r.push("advanced-trades","custom-layouts","multi-account","advanced-metrics","broker-integration"),r}async loginWithEmail(){return this.authenticate()}updateSubscriptionTier(){var t;(t=this.state.cache)!=null&&t.roles&&(this.state.cache.roles.includes("journalit-premium")||this.state.cache.roles.includes("admin")?this.state.subscriptionTier="premium":this.state.subscriptionTier="free")}isTokenExpired(){var t;return(t=this.state.cache)!=null&&t.tokenExpiry?new Date>this.state.cache.tokenExpiry:!1}isTokenApproachingExpiry(){var n;if(!((n=this.state.cache)!=null&&n.tokenExpiry))return!1;let t=new Date,r=new Date(t.getTime()+10080*60*1e3);return this.state.cache.tokenExpiry<r}showTokenExpiryWarningIfNeeded(){var n;if(!((n=this.state.cache)!=null&&n.tokenExpiry))return;let t=new Date,r=Math.ceil((this.state.cache.tokenExpiry.getTime()-t.getTime())/(1e3*60*60*24));if(r>0&&r<=7){Le.warn(`Token expires in ${r} days`,{tokenExpiry:this.state.cache.tokenExpiry.toISOString(),daysRemaining:r});let i=r===1?"Your session expires tomorrow. Please sign in again soon to continue using Pro features.":`Your session expires in ${r} days. Please sign in again to continue using Pro features.`;new Ro.Notice(i,8e3)}}decodeJWT(t){try{let r=t.split(".");if(r.length!==3)throw new Error("Invalid JWT format");let n=r[1].replace(/-/g,"+").replace(/_/g,"/");for(;n.length%4!==0;)n+="=";return JSON.parse(atob(n))}catch(r){throw Le.error("Failed to decode JWT:",r),new Error("Invalid JWT token")}}async verifyAuth(){var i,a,o,s,l;let n=0;for(;n<3;)try{if(n++,Le.log(`Auth verification attempt ${n}/3`),!navigator.onLine){Le.log("Network offline - checking cached credentials");let p=this.handleOfflineAuth(),m=aV(((i=this.state.cache)==null?void 0:i.graceEnd)||null);return Le.log("Showing offline mode notice:",{message:m.message,location:"offline mode fallback",timestamp:new Date().toISOString()}),new Ro.Notice(m.message),p}if(!((a=this.state.token)!=null&&a.access_token))throw new Error("No auth token available");if(this.isTokenExpired()){Le.log("Token expired - re-authentication required");let p=hu(ws.TOKEN_EXPIRED);throw new Ro.Notice(p.message),new Error(p.message)}let c=new URL("/auth/validate",this.serverUrl).toString();Le.log("Verifying token:",{url:c,attempt:n,tokenType:this.state.token.token_type});let d=await(0,Ro.requestUrl)({url:c,method:"GET",headers:this.getAuthHeaders()});if(Le.log("Verify response received:",{status:d.status,statusText:d.status===401?"Unauthorized":d.status===200?"OK":"Unknown",headers:d.headers,hasBody:!!d.text}),d.status===401){Le.log("Token verification failed - Unauthorized");let p=hu(ws.AUTH_FAILED,{reason:"Token is no longer valid"});return new Ro.Notice(p.message),!1}if(d.status!==200)throw Le.log("Unexpected response status:",d.status),new Error(`Unexpected response status: ${d.status}`);Le.log("Attempting to parse response body");let u=await d.json();if(Le.log("Response parsed successfully:",{authenticated:!!u.authenticated,hasError:!!u.error,userId:(o=u.user)==null?void 0:o.id}),!u.authenticated||u.error){let p=hu(ws.AUTH_FAILED,{reason:u.message||u.error||"Server validation failed"});return new Ro.Notice(p.message),!1}if(!((s=u.user)!=null&&s.id)||!((l=u.user)!=null&&l.roles)){let p=hu(ws.AUTH_FAILED,{reason:"Invalid user data received"});throw new Ro.Notice(p.message),new Error(p.message)}this.state.cache={userId:u.user.id,roles:u.user.roles,features:this.getFeaturesFromRoles(u.user.roles),graceEnd:new Date(Date.now()+this.GRACE_PERIOD_DAYS*24*60*60*1e3),lastVerified:new Date,subscriptionStatus:u.user.subscriptionStatus},Le.log("Auth verification successful:",{userId:u.user.id,roleCount:u.user.roles.length,features:this.state.cache.features.length,expiresAt:this.state.cache.graceEnd}),this.state.isOffline=!1,this.updateSubscriptionTier();try{await this.storeAuthConfig()}catch(p){Le.warn("Failed to store updated auth config:",p)}return this.showTokenExpiryWarningIfNeeded(),!0}catch(c){if(Le.error(`Auth verification failed (attempt ${n}):`,c),Le.log("Error details before offline fallback:",{errorType:c instanceof Error?c.name:typeof c,errorMessage:c instanceof Error?c.message:String(c),isNetworkError:c instanceof Error&&c.message.toLowerCase().includes("network"),attempts:n,maxRetries:3}),n===3){Le.log("All online verification attempts failed - trying offline mode");let d=this.handleOfflineAuth();if(d){let u=hu(ws.NETWORK_ERROR.basic);Le.log("Showing network error notice:",{message:u.title,location:"network error fallback",timestamp:new Date().toISOString()}),new Ro.Notice(u.title),this.showTokenExpiryWarningIfNeeded()}return d}await new Promise(d=>setTimeout(d,1e3*n))}return!1}handleOfflineAuth(){if(!this.state.cache)return Le.log("No cached auth data available for offline mode"),!1;let t=new Date;return t<this.state.cache.graceEnd?(Le.log("Using cached auth data:",{userId:this.state.cache.userId,graceEnd:this.state.cache.graceEnd,timeRemaining:this.state.cache.graceEnd.getTime()-t.getTime()}),this.state.isOffline=!0,!0):(Le.log("Cached auth data expired:",{graceEnd:this.state.cache.graceEnd,now:t}),!1)}async authenticate(){try{this.resetAuthState("Starting new authentication"),Le.log("Initiating beta email auth"),new ZF(this.app,async(r,n)=>{await this.handleBetaAuth(r,n)},()=>{Le.log("Authentication cancelled by user")}).open()}catch(t){Le.error("Auth error:",t),this.state.isAuthenticated=!1,this.state.token=null,this.state.cache=null;let r=hu(ws.AUTH_FAILED);throw this.state.error=r.message,new Ro.Notice(r.message),t}}async handleBetaAuth(t,r){try{Le.log("Beta auth data received:",{hasToken:!!t,hasUser:!!r,userId:r==null?void 0:r.id,tier:r==null?void 0:r.tier});let n=this.decodeJWT(t);if(!n.exp||!n.user_id)throw new Error("Invalid JWT token claims");this.state.token={access_token:t,token_type:"Bearer",expires_in:this.BETA_EXPIRY_DAYS*24*60*60,refresh_token:null};let i=r.tier==="premium"?["journalit-premium"]:[],a=this.getFeaturesFromRoles(i);Le.log("Initializing beta auth cache:",{userId:r.id,email:r.email,tier:r.tier,roleCount:i.length,featureCount:a.length,features:a}),this.state.cache={userId:r.id,email:r.email,roles:i,features:a,graceEnd:new Date(Date.now()+this.GRACE_PERIOD_DAYS*24*60*60*1e3),lastVerified:new Date,tokenExpiry:new Date(n.exp*1e3),subscriptionStatus:"beta",isBeta:r.is_beta},this.state.isAuthenticated=!0,this.state.error=null,this.updateSubscriptionTier(),Bt.setAuthToken(this.state.token.access_token);try{await this.storeAuthConfig()}catch(o){Le.warn("Failed to store auth config:",o)}Le.log("Triggering auth state change event (handleBetaAuth)"),dv.trigger(uv.STATE_CHANGED),Le.log("Beta authentication completed successfully:",{userId:this.state.cache.userId,email:this.state.cache.email,roles:this.state.cache.roles,features:this.state.cache.features,tier:this.state.subscriptionTier,tokenExpiry:this.state.cache.tokenExpiry})}catch(n){throw Le.error("Beta auth error:",n),this.state.isAuthenticated=!1,this.state.token=null,this.state.cache=null,n instanceof Error?this.state.error=n.message:this.state.error="An unknown error occurred",n}}resetAuthState(t="No reason provided"){var r,n,i;Le.log("Resetting auth state:",{reason:t,hadCache:!!this.state.cache,hadFeatures:!!((r=this.state.cache)!=null&&r.features),featureCount:(i=(n=this.state.cache)==null?void 0:n.features)==null?void 0:i.length,wasAuthenticated:this.state.isAuthenticated,wasOffline:this.state.isOffline}),this.state={isAuthenticated:!1,token:null,error:null,cache:null,isOffline:!1,subscriptionTier:void 0},Bt.setAuthToken(null),Le.log("Auth state reset complete")}async logout(){if(Le.log("Starting logout process",{serverUrl:this.serverUrl,hasToken:!!this.state.token}),!this.state.token){Le.log("No active token to invalidate"),this.resetAuthState("No active token"),Le.log("Triggering auth state change event (no token path)"),dv.trigger(uv.STATE_CHANGED);return}let t=!1;try{if(navigator.onLine){let r=new URL("/auth/logout",this.serverUrl).toString();Le.log("Sending logout request to server",{fullUrl:r,headers:this.getAuthHeaders()}),await(0,Ro.requestUrl)({url:r,method:"POST",headers:this.getAuthHeaders()}),t=!0,Le.log("Token invalidation successful"),new Ro.Notice(ws.STATUS.disconnected)}else{Le.log("Offline mode - skipping token invalidation");let r=hu(ws.NETWORK_ERROR.basic);new Ro.Notice(r.message)}}catch(r){Le.error("Token invalidation failed:",{error:r,errorType:r instanceof Error?r.name:typeof r,message:r instanceof Error?r.message:"Unknown error"})}try{this.resetAuthState(t?"Token invalidation successful":"Local cleanup only"),Bt.setAuthToken(null),Le.log("Checking for auth config file existence");let r=await this.app.vault.adapter.exists(this.CONFIG_PATH);if(Le.log("Auth config exists check result:",r),r){Le.log("Attempting to remove auth config file"),await this.app.vault.adapter.remove(this.CONFIG_PATH),Le.log("Auth config removal completed");let n=await this.app.vault.adapter.exists(this.CONFIG_PATH);Le.log("Post-removal existence check:",{path:this.CONFIG_PATH,stillExists:n,timestamp:new Date().toISOString()})}try{await this.keyManager.cleanup()}catch(n){Le.warn("Failed to clean up key storage:",n)}dv.trigger(uv.STATE_CHANGED)}catch(r){Le.error("Local cleanup failed:",r),this.resetAuthState("Forced reset after cleanup failure")}Le.log("Logout completed:",{tokenInvalidated:t,stateCleared:!this.state.token&&!this.state.isAuthenticated,configRemoved:!await this.app.vault.adapter.exists(this.CONFIG_PATH).catch(()=>!0)})}async hasFeature(t){var i,a,o;if(Le.log("hasFeature check:",{featureName:t,hasCache:!!this.state.cache,hasFeatures:!!((i=this.state.cache)!=null&&i.features),featureCount:(o=(a=this.state.cache)==null?void 0:a.features)==null?void 0:o.length,isOffline:this.state.isOffline}),!this.state.cache){let s=hu(ws.NEEDS_AUTH);return new Ro.Notice(s.message),!1}let r=this.getFeaturesFromRoles([]).includes(t);if(!navigator.onLine){this.state.isOffline=!0,Le.log("Offline mode feature check:",{featureName:t,graceEnd:this.state.cache.graceEnd,now:new Date,isExpired:new Date>this.state.cache.graceEnd,features:this.state.cache.features});let s=aV(this.state.cache.graceEnd);if(new Ro.Notice(s.message),!this.handleOfflineAuth()){let c=ws.OFFLINE_MODE.expired;return new Ro.Notice(c.message),!1}let l=this.state.cache.features.includes(t);if(!l&&!r){let c=hu(ws.NEEDS_PREMIUM);new Ro.Notice(`${c.title}: ${c.message}`)}return l}if(this.state.isOffline=!1,Date.now()-this.state.cache.lastVerified.getTime()>36e5)try{await this.verifyAuth()}catch(s){let l=hu(ws.NETWORK_ERROR.premium);return new Ro.Notice(l.message),r}let n=this.state.cache.features.includes(t);if(!n&&!r){let s=hu(ws.NEEDS_PREMIUM);new Ro.Notice(`${s.title}: ${s.message}`)}return n}getAuthState(){return{...this.state}}isAuthenticated(){return this.state.isAuthenticated&&!!this.state.token}getSubscriptionTier(){return this.state.subscriptionTier}getUserId(){var t;return(t=this.state.cache)==null?void 0:t.userId}getAuthToken(){var t;return((t=this.state.token)==null?void 0:t.access_token)||null}getAuthHeaders(){var r;let t={"Content-Type":"application/json","Accept-Language":"en-US"};return(r=this.state.token)!=null&&r.access_token&&(t.Authorization=`Bearer ${this.state.token.access_token}`),t}};gk.AUTH_CHANGED="journalit-auth-changed"});var sV,u0e=F(()=>{sV=()=>"https://api.journalit.co"});async function wl(e,t){try{let r=performance.now();await new Promise(a=>setTimeout(a,10));let n=e(),i=Math.round(performance.now()-r);return n}catch(r){throw console.error(`Failed to lazy load ${t}:`,r),r}}var lV=F(()=>{});function cV(e){var r,n;let t=[];return(r=e.name)!=null&&r.trim()||t.push({field:"name",message:"Name is required"}),(n=e.description)!=null&&n.trim()||t.push({field:"description",message:"Description is required"}),e.name&&!/^[\w\s-]{3,50}$/.test(e.name)&&t.push({field:"name",message:"Name must be 3-50 characters and contain only letters, numbers, spaces, and hyphens"}),e.color&&!/^#[0-9A-Fa-f]{6}$/.test(e.color)&&t.push({field:"color",message:"Color must be a valid hex color code (e.g. #FF0000)"}),e.order!==void 0&&(!Number.isInteger(e.order)||e.order<0)&&t.push({field:"order",message:"Order must be a non-negative integer"}),t}function dV(e){if(!e.startsWith("setup-"))throw new Error('Invalid setup ID format: must start with "setup-"');if(!/^setup-[\w-]{1,50}$/.test(e))throw new Error("Invalid setup ID format: must contain only letters, numbers, and hyphens")}var p0e=F(()=>{});var AO,m0e=F(()=>{AO=class{constructor(t){this.tradeService=t}async calculateMetrics(t){let r=await this.getSetupTrades(t);if(!r.length)return this.getEmptyMetrics();let n=r.map(l=>this.calculateTradePnL(l)),i=n.filter(l=>l>0),a=n.filter(l=>l<0),o=this.calculateStreaks(n);return{...this.getEmptyMetrics(),totalTrades:r.length,winRate:i.length/r.length*100,totalPnL:n.reduce((l,c)=>l+c,0),avgWinner:i.length?i.reduce((l,c)=>l+c,0)/i.length:0,avgLoser:a.length?a.reduce((l,c)=>l+c,0)/a.length:0,winStreak:o.maxWin,loseStreak:o.maxLoss,currentStreak:o.current,...this.calculateAdvancedMetrics(r,n)}}async getSetupTrades(t){let r=await this.tradeService.getTrades(new Date(0),new Date);return(await Promise.all(r.map(async n=>{try{let i=await this.tradeService.readTradeContent(n),a=this.parseTrade(i);return a.setupIds.includes(t)?a:null}catch(i){return console.warn(`Invalid trade file: ${n.path}`),null}}))).filter(n=>n!==null)}calculateTradePnL(t){return(t.exitPrice-t.entryPrice)*t.positionSize}calculateStreaks(t){let r=0,n=0,i=0;return t.forEach(a=>{a>0?(r<0&&(r=0),r++,n=Math.max(n,r)):a<0&&(r>0&&(r=0),r--,i=Math.min(i,r))}),{maxWin:n,maxLoss:Math.abs(i),current:r}}getEmptyMetrics(){return{totalTrades:0,winRate:0,totalPnL:0,avgWinner:0,avgLoser:0,winStreak:0,loseStreak:0,currentStreak:0,expectedValue:0,riskRewardRatio:0,profitFactor:0,averageDuration:0,bestTrade:0,worstTrade:0,averageVolume:0,lastTradeDate:new Date().toISOString(),tradingFrequency:0,inactivityStreak:0}}calculateAdvancedMetrics(t,r){if(!t.length)return{};let n=r.filter(f=>f>0),i=r.filter(f=>f<0),a=t.map(f=>{let v=new Date(f.exitTime),h=new Date(f.entryTime);return(v.getTime()-h.getTime())/1e3/60}),o=t.map(f=>Math.abs(f.positionSize)),s=n.reduce((f,v)=>f+v,0),l=Math.abs(i.reduce((f,v)=>f+v,0)),c=t.map(f=>new Date(f.exitTime)),d=new Date(Math.max(...c.map(f=>f.getTime()))),u=new Date,p=Math.floor((u.getTime()-d.getTime())/(1e3*60*60*24)),m=new Date(Math.min(...c.map(f=>f.getTime()))),g=(u.getTime()-m.getTime())/(1e3*60*60*24*30.44);return{expectedValue:r.reduce((f,v)=>f+v,0)/r.length,riskRewardRatio:Math.abs(n.length?s/n.length:0)/Math.abs(i.length?l/i.length:1),profitFactor:l?s/l:s?1/0:0,averageDuration:a.reduce((f,v)=>f+v,0)/a.length,bestTrade:Math.max(...r),worstTrade:Math.min(...r),averageVolume:o.reduce((f,v)=>f+v,0)/o.length,lastTradeDate:d.toISOString(),tradingFrequency:t.length/g,inactivityStreak:p}}parseTrade(t){let r=t.match(/^---\n([\s\S]*?)\n---/);if(!r)throw new Error("Invalid trade file format");let n=r[1].split(`
`).reduce((a,o)=>{let[s,...l]=o.split(":").map(c=>c.trim());return s&&l.length&&(s==="setupIds"?a[s]=l.join(":").replace(/[\[\]]/g,"").split(",").map(c=>c.trim()):a[s]=l.join(":")),a},{}),i=new Date().toISOString();return{exitPrice:Number(n.exitPrice),entryPrice:Number(n.entryPrice),positionSize:Number(n.positionSize),setupIds:n.setupIds||[],entryTime:n.entryTime||i,exitTime:n.exitTime||n.entryTime||i}}}});var NO,LO,f0e=F(()=>{NO=require("obsidian");Tm();p0e();m0e();Nl();LO=class extends ts{constructor(r,n,i={}){super(r,{folder:"setups",extension:".md",cacheTTL:300*1e3,persistCache:!0,namespace:i.namespace||"setup"});this.tradeService=n;this.SETUPS_FOLDER="setups";this.metricsCalculator=new AO(n)}async getSetupMetrics(r){return dV(r),this.query(async()=>this.metricsCalculator.calculateMetrics(r),`metrics:${r}`,{offlineCapable:!0})}async getAllSetupMetrics(r){let n=`metrics:all${r?`:${JSON.stringify(r)}`:""}`;return this.query(async()=>{let i=await this.getSetupFiles(),a=await this.filterSetupFiles(i,r),o=new Map;for(let s of a)try{let l=await this.app.vault.read(s),c=await this.parseSetupContent(l),d=await this.metricsCalculator.calculateMetrics(c.id);o.set(c.id,d)}catch(l){console.warn(`Failed to calculate metrics for setup: ${s.path}`)}return o},n,{offlineCapable:!0})}async createSetup(r){let n=cV(r);if(n.length)throw new Error(`Invalid setup data: ${n.map(s=>s.message).join(", ")}`);let i=this.generateSetupId(r.name),a=this.getSetupFilePath(i),o=this.generateSetupContent({...r,id:i,status:"active",version:1,createdAt:this.formatDateTimeForDisplay(new Date),updatedAt:this.formatDateTimeForDisplay(new Date),color:r.color||"#808080",icon:r.icon||"trading_setup",order:r.order||0});return await this.app.vault.create(a,o),a}async updateSetup(r,n){if(dV(r),Object.keys(n).length>0){let d=[];"name"in n&&d.push("name"),"description"in n&&d.push("description"),"color"in n&&d.push("color"),"order"in n&&d.push("order");let u=cV(n).filter(p=>d.includes(p.field));if(u.length)throw new Error(`Invalid setup data: ${u.map(p=>p.message).join(", ")}`)}let i=this.getSetupFilePath(r),a=this.app.vault.getAbstractFileByPath(i);if(!(a instanceof NO.TFile))throw new Error(`Setup not found: ${r}`);let o=await this.app.vault.read(a),s=await this.parseSetupContent(o),l={...s,...n,version:s.version+1,updatedAt:this.formatDateTimeForDisplay(new Date)},c=this.generateSetupContent(l);await this.app.vault.modify(a,c),await yn(this.app,a),await this.clearCache()}async archiveSetup(r){await this.updateSetup(r,{status:"archived"})}async getSetups(r){let n=`setups:${JSON.stringify(r||{})}`;return this.query(async()=>{let i=await this.getSetupFiles();return this.filterSetupFiles(i,r)},n,{offlineCapable:!0})}async getSetupFiles(){return this.getFiles()}getSetupFilePath(r){return(0,NO.normalizePath)(`${this.SETUPS_FOLDER}/${r}.md`)}generateSetupId(r){return`setup-${r.toLowerCase().replace(/[^a-z0-9]/g,"-")}`}formatDateTimeForDisplay(r){let n=r.getFullYear(),i=String(r.getMonth()+1).padStart(2,"0"),a=String(r.getDate()).padStart(2,"0"),o=String(r.getHours()).padStart(2,"0"),s=String(r.getMinutes()).padStart(2,"0"),l=String(r.getSeconds()).padStart(2,"0");return`${n}-${i}-${a}T${o}:${s}:${l}`}generateSetupContent(r){return["---","type: setup",`id: ${r.id}`,`name: ${r.name}`,`description: ${r.description}`,`status: ${r.status}`,`color: ${r.color}`,`icon: ${r.icon}`,`version: ${r.version}`,`createdAt: ${r.createdAt}`,`updatedAt: ${r.updatedAt}`,`order: ${r.order}`,"---","","## Trading Rules","",r.rules||"No rules defined."].join(`
`)}async parseSetupContent(r){var a;let n=r.match(/^---\n([\s\S]*?)\n---/);if(!n)throw new Error("Invalid setup file format");let i=n[1].split(`
`).reduce((o,s)=>{let[l,...c]=s.split(":").map(d=>d.trim());return l&&c.length&&(o[l]=c.join(":")),o},{});return{id:i.id,name:i.name,description:i.description,rules:((a=r.split("## Trading Rules")[1])==null?void 0:a.trim())||"",status:i.status,color:i.color,icon:i.icon,version:parseInt(i.version,10),createdAt:i.createdAt,updatedAt:i.updatedAt,order:parseInt(i.order,10)}}async filterSetupFiles(r,n){return n?(await Promise.all(r.map(async a=>{try{let o=await this.app.vault.read(a),s=await this.parseSetupContent(o);return n.status&&s.status!==n.status||n.search&&!this.matchesSearch(s,n.search)?null:a}catch(o){return console.warn(`Invalid setup file: ${a.path}`),null}}))).filter(a=>a!==null):r}matchesSearch(r,n){let i=n.toLowerCase();return r.name.toLowerCase().includes(i)||r.description.toLowerCase().includes(i)||r.rules.toLowerCase().includes(i)}}});var cd,FO,g0e=F(()=>{cd=require("obsidian");_t();Oa();Nl();av();Nd();uh();Tr();FO=class{constructor(t,r,n,i={}){this.DRC_PREFIX="DRC";this.templateService=null;this.transformService=null;this.unsubscribeFns=[];this.app=t,this.plugin=r,this.folderPathService=n,this.namespace=i.namespace||"drc",this.unsubscribeFns.push(xe.subscribe("settings:changed",a=>{(a==null?void 0:a.source)!=="user-input"&&this.onSettingsUpdated()}),xe.subscribe("trade:changed",()=>{this.onTradeDataChanged()}))}getTemplateServices(){return this.templateService||(this.templateService=new uo(this.plugin)),this.transformService||(this.transformService=new jl(this.plugin)),{templateService:this.templateService,transformService:this.transformService}}async onSettingsUpdated(){try{let t=this.app.workspace.getActiveFile();if(!t)return;let r=this.app.metadataCache.getFileCache(t);if(!(r!=null&&r.frontmatter)||r.frontmatter.type!=="drc")return;xe.publish("review:changed",{type:"drc",action:"updated",filePath:t.path,source:"settings-update"})}catch(t){console.error("Error updating DRC after settings change:",t)}}async onTradeDataChanged(){try{let t=this.app.workspace.getActiveFile();if(!t)return;let r=this.app.metadataCache.getFileCache(t);if(!(r!=null&&r.frontmatter)||r.frontmatter.type!=="drc")return;xe.publish("review:changed",{type:"drc",action:"updated",filePath:t.path,source:"trade-data-change"})}catch(t){console.error("Error updating DRC after trade data change:",t)}}getWeekOfMonth(t){return dc(t)}formatDateForFilename(t){var o,s,l;let r=String(t.getDate()).padStart(2,"0"),n=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getFullYear()).slice(-2);switch(((l=(s=(o=this.plugin)==null?void 0:o.settings)==null?void 0:s.trade)==null?void 0:l.dateFormat)||"DDMMYY"){case"MMDDYY":return`${n}${r}${i}`;case"YYMMDD":return`${i}${n}${r}`;default:return`${r}${n}${i}`}}formatDateForDisplay(t){let r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0");return`${r}-${n}-${i}`}formatDateTimeForDisplay(t){let r=this.formatDateForDisplay(t),n=t.toTimeString().split(" ")[0];return`${r}T${n}`}async ensureDirectoryExists(t){let r=t.substring(0,t.lastIndexOf("/"));await this.app.vault.adapter.exists(r)||await this.app.vault.adapter.mkdir(r)}async findDRCByFrontmatterDate(t){let r=this.formatDateForDisplay(t),n=this.folderPathService.journalFolderPath,i=this.app.vault.getMarkdownFiles();for(let a of i){if(!a.path.startsWith(n)||!a.basename.startsWith(this.DRC_PREFIX))continue;let o=this.app.metadataCache.getFileCache(a),s=o==null?void 0:o.frontmatter;if((s==null?void 0:s.type)==="drc"&&(s==null?void 0:s.date)===r)return a}return null}async createDRC(t){try{let r=this.getDRCNotePath(t);if(await this.app.vault.adapter.exists(r))return r;let i=await this.findDRCByFrontmatterDate(t);if(i)return i.path;await this.ensureDirectoryExists(r);let a=await this.generateInitialDRCContent(t),o=await this.app.vault.create(r,a);return await yn(this.app,o),xe.publish("review:changed",{type:"drc",action:"created",filePath:r}),r}catch(r){throw console.error("Error creating DRC:",r),r}}async getTodayDRC(){let t=new Date;return this.createDRC(t)}async getDRC(t){return this.createDRC(t)}async getTradesForDate(t){var r;try{let n=Zt(t,this.plugin),i=this.formatDateForDisplay(n),a=this.app.vault.getMarkdownFiles(),o=[];for(let s of a){let l=(r=this.app.metadataCache.getFileCache(s))==null?void 0:r.frontmatter;if(!(!l||l.type!=="trade"&&l.type!=="backtest-trade")){if(l.entryTime){let c=new Date(l.entryTime),d=Zt(c,this.plugin);this.formatDateForDisplay(d)===i&&o.push(s)}else if(l.date){let c=ur(l.date);if(!c)continue;this.formatDateForDisplay(c)===i&&o.push(s)}}}return o}catch(n){return console.error(`Error getting trades for date ${t.toDateString()}:`,n),[]}}async updateDRCFrontmatter(t,r,n="unknown"){try{let i=this.app.vault.getAbstractFileByPath(t);if(!i||!(i instanceof cd.TFile))throw new Error(`DRC file not found: ${t}`);if(await this.app.fileManager.processFrontMatter(i,a=>{Object.assign(a,r)}),await yn(this.app,i),n==="user-input")return;xe.publish("review:changed",{type:"drc",action:"updated",filePath:t,source:n});return}catch(i){throw console.error(`Error updating DRC frontmatter in ${t}:`,i),i}}getWeeklyReviewPath(t){let r=ea(t),n=Wx(r),i=n.getFullYear(),a=n.getMonth()+1,o=String(a).padStart(2,"0"),s=dc(r),l=`${s}-Review.md`,c=Oi(a);return(0,cd.normalizePath)(this.folderPathService.getDatePathForQuarterSync(i.toString(),c,o,s,l))}getMonthlyReviewPath(t){let r=t.getFullYear(),n=t.getMonth()+1;return(0,cd.normalizePath)(this.folderPathService.getMonthlyReviewPathForQuarterSync(r,n))}getDRCNotePath(t){let r=t.getFullYear(),n=t.getMonth()+1,i=String(n).padStart(2,"0"),a=Bx(t,r),o=this.formatDateForFilename(t),s=`${this.DRC_PREFIX}-${o}.md`,l=Oi(n);return(0,cd.normalizePath)(this.folderPathService.getDatePathForQuarterSync(r.toString(),l,i,a,s))}getNextDayDRCPath(t){let n=KE(this.plugin)?$_(t):new Date(t.getTime()+1440*60*1e3);return this.getDRCNotePath(n)}getPreviousDayDRCPath(t){let n=KE(this.plugin)?R_(t):new Date(t.getTime()-1440*60*1e3);return this.getDRCNotePath(n)}async getAdjacentDRC(t,r,n){var i,a,o;try{let s=r<0?this.getPreviousDayDRCPath(t):this.getNextDayDRCPath(t);if(await this.app.vault.adapter.exists(s))return s;if((o=n!=null?n:(a=(i=this.plugin.settings)==null?void 0:i.drc)==null?void 0:a.autoCreateDRCOnNavigation)!=null?o:!0){let d=KE(this.plugin),u;return r<0?u=d?R_(t):new Date(t.getTime()-1440*60*1e3):u=d?$_(t):new Date(t.getTime()+1440*60*1e3),await this.createDRC(u),s}return null}catch(s){return console.error("Error getting adjacent DRC:",s),null}}getDRCFile(t){let r=this.app.vault.getAbstractFileByPath(t);return!r||!(r instanceof cd.TFile)?null:r}extractDRCData(t){var r;try{let n=(r=this.app.metadataCache.getFileCache(t))==null?void 0:r.frontmatter;return!n||n.type!=="drc"?null:n}catch(n){return console.error("Error extracting DRC data:",n),null}}async getPreviousDayGoals(t){try{let r=this.getPreviousDayDRCPath(t);if(!await this.app.vault.adapter.exists(r))return null;let i=this.app.vault.getAbstractFileByPath(r);if(!i||!(i instanceof cd.TFile))return null;await yn(this.app,i);let a=this.extractDRCData(i);return(a==null?void 0:a.dailyGoals)||null}catch(r){return console.error("Error getting previous day goals:",r),null}}generateDRCTags(t){let r=[];r.push([bm(ym.DAILY)]);let n=xm(t);return n.length>0&&r.push(n),wm(...r)}async generateInitialDRCContent(t){let r={type:"drc",date:this.formatDateForDisplay(t),tags:this.generateDRCTags(t)},n=this.plugin.settings.drc.recurringGoals||[];n.length>0&&(r.dailyGoals=[...n],r.dailyGoalStatus={},n.forEach((l,c)=>{r.dailyGoalStatus[`goal_${c}`]=!1}));let i=this.plugin.settings.drc.checklistItems||[];i.length>0&&(r.checklistItems=[...i],r.checklistStatus={},i.forEach((l,c)=>{r.checklistStatus[`item_${c}`]=!1}));let{templateService:a,transformService:o}=this.getTemplateServices(),s=a.getDefaultTemplate("drc");return r.templateId=s.id,r.templateVersion=s.version,o.generateNoteFromTemplate(s,r)}convertToYamlFrontmatter(t){let r=[],n=i=>i==null?"null":typeof i=="string"?i.includes(":")||i.includes("#")||i.includes(`
`)||i.includes('"')||i.trim()===""?`"${i.replace(/"/g,'\\"')}"`:i:typeof i=="number"||typeof i=="boolean"?String(i):Array.isArray(i)||typeof i=="object"?JSON.stringify(i):String(i);for(let[i,a]of Object.entries(t))i!=="type"&&a!==void 0&&r.push(`${i}: ${n(a)}`);return r}async openDRC(t){try{let r=this.formatDateForDisplay(t),n=null;if(this.app.workspace.iterateAllLeaves(o=>{var s;if(!n&&o.view instanceof cd.FileView&&o.view.file){let l=o.view.file,c=(s=this.app.metadataCache.getFileCache(l))==null?void 0:s.frontmatter;(c==null?void 0:c.type)==="drc"&&(c==null?void 0:c.date)===r&&(n=o)}}),n){this.app.workspace.revealLeaf(n);return}let i=this.getDRCNotePath(t);await this.app.vault.adapter.exists(i)?await this.plugin.openFile(i,!0):(await this.createDRC(t),await this.plugin.openFile(i,!0))}catch(r){throw console.error(`Failed to open DRC for date ${t.toDateString()}:`,r),r}}async createWeeklyReview(t){try{let r=this.getWeeklyReviewPath(t);if(await this.app.vault.adapter.exists(r))return r;await this.ensureDirectoryExists(r);let i=this.generateInitialWeeklyReviewContent(t),a=await this.app.vault.create(r,i);return await yn(this.app,a),r}catch(r){throw console.error("Error creating weekly review:",r),r}}generateInitialWeeklyReviewContent(t){let r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),i=this.getWeekOfMonth(t),a={type:"weekly-review",date:this.formatDateForDisplay(t),created:this.formatDateTimeForDisplay(new Date),week:i,month:n,year:r.toString()};return[...["---",`type: ${a.type}`,...this.convertToYamlFrontmatter(a),"---"],"",`# Weekly Review - Week ${i}, ${n}/${r}`,"","## Summary","","Weekly trading summary goes here.","","## Performance","","Performance metrics for the week.","","## Lessons Learned","","Key takeaways from this week's trades.","","## Goals for Next Week","","Trading goals for the upcoming week."].join(`
`)}async openWeeklyReview(t){try{await(await this.plugin.serviceManager.getWeeklyReviewService()).openWeeklyReview(t)}catch(r){throw console.error(`Failed to open weekly review for date ${t.toDateString()}:`,r),r}}async saveDRCForecastImage(t,r,n){try{let i=r.getFullYear(),a=String(r.getMonth()+1).padStart(2,"0"),o=this.getWeekOfMonth(r),s=n.replace(/[^a-zA-Z0-9]/g,""),l=t.name.replace(/[^a-zA-Z0-9.-]/g,"_"),c="";if(l.includes("."))c=l.substring(l.lastIndexOf("."));else throw new Error("File name does not contain a period.");let d=Date.now(),u=this.formatDateForFilename(r),p=`DRC-${s}-${u}-${d}${c}`,m=this.folderPathService.getDatePath(i.toString(),a,o,"media"),g=`${m}/${p}`;await this.app.vault.adapter.mkdir((0,cd.normalizePath)(m));let f=await t.arrayBuffer();return await this.app.vault.createBinary((0,cd.normalizePath)(g),f),g}catch(i){throw console.error("Error saving DRC forecast image:",i),i}}async getWeeklyEventsForDate(t){var r;try{let n=t.toLocaleDateString("en-US",{weekday:"long"}),i=this.getWeeklyReviewPath(t);if(!await this.app.vault.adapter.exists(i))return[];let o=this.app.vault.getAbstractFileByPath(i);if(!o||!(o instanceof cd.TFile))return[];let s=(r=this.app.metadataCache.getFileCache(o))==null?void 0:r.frontmatter;return!s||s.type!=="weekly-review"?[]:(s.keyEvents||[]).filter(d=>d.day?d.day.toLowerCase()===n.toLowerCase():!0)}catch(n){return console.error("Error getting weekly events for date:",n),[]}}async saveDRCForecastImages(t,r,n){try{let i=[];for(let a of t){let o=await this.saveDRCForecastImage(a,r,n);i.push(o)}return i}catch(i){throw console.error("Error saving multiple DRC forecast images:",i),i}}async deleteImage(t){try{let r=this.app.vault.getAbstractFileByPath(t);if(!r)throw new Error(`Image file not found: ${t}`);await this.app.vault.delete(r);let n=t.substring(0,t.lastIndexOf("/"));if(await this.app.vault.adapter.exists(n)){let a=await this.app.vault.adapter.list(n);if(a.files.length===0&&a.folders.length===0){let o=this.app.vault.getAbstractFileByPath(n);o&&await this.app.vault.delete(o)}}}catch(r){throw console.error(`Error deleting image ${t}:`,r),r}}destroy(){for(let t of this.unsubscribeFns)t();this.unsubscribeFns=[]}}});var up,OO,h0e=F(()=>{up=require("obsidian");Ad();_t();Oa();Nl();av();Nd();uh();Tr();OO=class{constructor(t,r,n,i={}){this.WEEKLY_PREFIX="Weekly";this.folderPathService=null;this.templateService=null;this.transformService=null;this.app=t,this.plugin=r,this.folderPathService=n||null,this.folderPathService||this.initializeFolderPathService(),this.unsubscribeSettings=xe.subscribe("settings:changed",a=>{this.onSettingsUpdated(a)})}async initializeFolderPathService(){try{this.plugin.serviceManager&&(this.folderPathService=this.plugin.serviceManager.getFolderPathService())}catch(t){console.error("[WeeklyReviewService] Error initializing folder path service:",t)}}getTemplateServices(){return this.templateService||(this.templateService=new uo(this.plugin)),this.transformService||(this.transformService=new jl(this.plugin)),{templateService:this.templateService,transformService:this.transformService}}getJournalFolderPath(){return this.folderPathService?this.folderPathService.journalFolderPath:"!Journalit"}async onSettingsUpdated(t){var r;try{t==null||t.component;let n=this.app.workspace.getActiveFile();if(!n)return;let i=this.app.metadataCache.getFileCache(n);if(!(i!=null&&i.frontmatter)||i.frontmatter.type!=="weekly-review")return;if((t==null?void 0:t.component)==="weekly"&&((r=this.plugin.settings.weekly)!=null&&r.reviewQuestions)){let a=await this.extractWeeklyReviewData(n);if(!a)return;let o=Object.keys(a.reviewQuestions||{}),s=this.plugin.settings.weekly.reviewQuestions;if(o.length!==s.length||!o.every(l=>s.includes(l))){let l={};s.forEach(c=>{l[c]=a.reviewQuestions&&c in a.reviewQuestions?a.reviewQuestions[c]:""}),await this.updateWeeklyReviewFrontmatter(n.path,{reviewQuestions:l})}}xe.publish("review:changed",{type:"weekly",action:"updated",filePath:n.path})}catch(n){console.error("Error updating Weekly Review after settings change:",n)}}getWeeklyReviewPath(t){let r=ea(t),n=Wx(r),i=n.getFullYear(),a=n.getMonth()+1,o=String(a).padStart(2,"0"),s=dc(r),l=`${s}-Review.md`;if(this.folderPathService){let c=Oi(a);return(0,up.normalizePath)(this.folderPathService.getDatePathForQuarterSync(i.toString(),c,o,s,l))}return(0,up.normalizePath)(`${this.getJournalFolderPath()}/${i}/${o}/${s}/${l}`)}async ensureDirectoryExists(t){let r=t.substring(0,t.lastIndexOf("/"));await this.app.vault.adapter.exists(r)||await this.app.vault.adapter.mkdir(r)}async createWeeklyReview(t){try{let r=this.getWeeklyReviewPath(t);if(await this.app.vault.adapter.exists(r))return r;await this.ensureDirectoryExists(r);let i=await this.generateInitialWeeklyReviewContent(t),a=await this.app.vault.create(r,i);return await yn(this.app,a),xe.publish("review:changed",{type:"weekly",action:"created",filePath:r}),r}catch(r){throw console.error("Error creating weekly review:",r),r}}formatDateForDisplay(t){let r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0");return`${r}-${n}-${i}`}generateWeeklyReviewTags(t){let r=[],n=ea(t);r.push([bm(ym.WEEKLY)]);let i=xm(n);return i.length>0&&r.push(i),wm(...r)}async generateInitialWeeklyReviewContent(t){var p;let r=ea(t),n=dc(r),i=Wx(r),a=i.getFullYear(),o=i.getMonth()+1,s={type:"weekly-review",date:this.formatDateForDisplay(r),tags:this.generateWeeklyReviewTags(t),week:n,month:String(o).padStart(2,"0"),year:String(a)},l=((p=this.plugin.settings.weekly)==null?void 0:p.recurringGoals)||[];l.length>0&&(s.weeklyGoals=[...l],s.weeklyGoalStatus={},l.forEach((m,g)=>{s.weeklyGoalStatus&&(s.weeklyGoalStatus[`goal_${g}`]=!1)}));let{templateService:c,transformService:d}=this.getTemplateServices(),u=c.getDefaultTemplate("weekly");return s.templateId=u.id,s.templateVersion=u.version,d.generateNoteFromTemplate(u,s)}convertToYamlFrontmatter(t){let r=[],n=i=>i==null?"null":typeof i=="string"?i.includes(":")||i.includes("#")||i.includes(`
`)||i.includes('"')||i.trim()===""?`"${i.replace(/"/g,'\\"')}"`:i:typeof i=="number"||typeof i=="boolean"?String(i):Array.isArray(i)||typeof i=="object"?JSON.stringify(i):String(i);for(let[i,a]of Object.entries(t))i!=="type"&&a!==void 0&&r.push(`${i}: ${n(a)}`);return r}async extractWeeklyReviewData(t){var r;try{let n=(r=this.app.metadataCache.getFileCache(t))==null?void 0:r.frontmatter;return!n||n.type!=="weekly-review"?null:n}catch(n){return console.error("Error extracting Weekly Review data:",n),null}}async updateWeeklyReviewFrontmatter(t,r){try{let n=this.app.vault.getAbstractFileByPath(t);if(!n||!(n instanceof up.TFile))throw new Error(`Weekly Review file not found: ${t}`);await this.app.fileManager.processFrontMatter(n,i=>{Object.assign(i,r)}),await yn(this.app,n),xe.publish("review:changed",{type:"weekly",action:"updated",filePath:t}),r.nextWeekGoals!==void 0&&await this.syncGoalsToNextWeek(t,r.nextWeekGoals);return}catch(n){throw console.error(`Error updating Weekly Review frontmatter in ${t}:`,n),n}}async syncGoalsToNextWeek(t,r){try{let n=this.app.vault.getAbstractFileByPath(t);if(!n||!(n instanceof up.TFile))return;let i=await this.extractWeeklyReviewData(n);if(!(i!=null&&i.date))return;let a=i.date.split("-").map(d=>parseInt(d,10)),o=new Date(a[0],a[1]-1,a[2]),s=new Date(o);s.setDate(s.getDate()+7);let l=this.getWeeklyReviewPath(s),c=this.app.vault.getAbstractFileByPath(l);c instanceof up.TFile&&(await this.app.fileManager.processFrontMatter(c,d=>{d.previousGoals=r||[]}),await yn(this.app,c),xe.publish("review:changed",{type:"weekly",action:"updated",filePath:l}))}catch(n){console.warn("Warning: Failed to sync goals to next week:",n)}}async getDRCsForWeek(t){var r;try{let n=ea(t),i=new Date(n);i.setDate(i.getDate()+6);let a=this.formatDateForDisplay(n),o=this.formatDateForDisplay(i),s=this.app.vault.getMarkdownFiles(),l=[];for(let c of s){let d=(r=this.app.metadataCache.getFileCache(c))==null?void 0:r.frontmatter;if(!d||d.type!=="drc")continue;let u=d.date;u&&u>=a&&u<=o&&l.push({file:c,data:d})}return l.sort((c,d)=>c.data.date.localeCompare(d.data.date)),l}catch(n){return console.error("Error getting DRCs for week:",n),[]}}async getTradesForWeek(t){var r;try{let n=ea(t),i=new Date(n);i.setDate(i.getDate()+6),i.setHours(23,59,59,999);let a=this.formatDateForDisplay(n),o=this.formatDateForDisplay(i),s=this.app.vault.getMarkdownFiles(),l=[];for(let c of s){let d=(r=this.app.metadataCache.getFileCache(c))==null?void 0:r.frontmatter;if(!(!d||d.type!=="trade"&&d.type!=="backtest-trade")){if(d.entryTime){let u=new Date(d.entryTime),p=Zt(u,this.plugin),m=this.formatDateForDisplay(p);m>=a&&m<=o&&l.push(c)}else if(d.date){let u=ur(d.date);if(!u)continue;let p=this.formatDateForDisplay(u);p>=a&&p<=o&&l.push(c)}}}return l}catch(n){return console.error("Error getting trades for week:",n),[]}}async openWeeklyReview(t){try{let r=ea(t),n=dc(r),i=String(r.getMonth()+1).padStart(2,"0"),a=r.getFullYear().toString(),o=null;if(this.app.workspace.iterateAllLeaves(c=>{var d;if(c.view instanceof up.FileView&&c.view.file){let u=(d=this.app.metadataCache.getFileCache(c.view.file))==null?void 0:d.frontmatter;if((u==null?void 0:u.type)==="weekly-review"&&u.week===n&&u.month===i&&u.year===a)return o=c,!0}}),o){this.app.workspace.revealLeaf(o);return}let s=this.getWeeklyReviewPath(t);await this.app.vault.adapter.exists(s)?await this.plugin.openFile(s,!0):(await this.createWeeklyReview(t),await this.plugin.openFile(s,!0))}catch(r){throw console.error(`Failed to open weekly review for date ${t.toDateString()}:`,r),r}}getNextWeekReviewPath(t){let r=ea(t),n=new Date(r);return n.setDate(n.getDate()+7),this.getWeeklyReviewPath(n)}getPreviousWeekReviewPath(t){let r=ea(t),n=new Date(r);return n.setDate(n.getDate()-7),this.getWeeklyReviewPath(n)}async getAdjacentWeeklyReview(t,r,n){var i,a,o;try{let s=r<0?this.getPreviousWeekReviewPath(t):this.getNextWeekReviewPath(t);if(await this.app.vault.adapter.exists(s))return s;if((o=n!=null?n:(a=(i=this.plugin.settings)==null?void 0:i.weekly)==null?void 0:a.autoCreateWeeklyReviewOnNavigation)!=null?o:!0){let d=ea(t),u;return r<0?(u=new Date(d),u.setDate(u.getDate()-7)):(u=new Date(d),u.setDate(u.getDate()+7)),await this.createWeeklyReview(u),s}return null}catch(s){return console.error("Error getting adjacent weekly review:",s),null}}async saveWeeklyReviewImage(t,r,n){try{let i=ea(r),a=i.getFullYear(),o=String(i.getMonth()+1).padStart(2,"0"),s=dc(i),l=n.replace(/[^a-zA-Z0-9]/g,""),c=`${this.getJournalFolderPath()}/${a}/${o}/${s}/media`;return await vi.saveImage(t,c,`${s}-${l}`,void 0)}catch(i){throw console.error("Error saving weekly review image:",i),i}}async saveWeeklyReviewImages(t,r,n){try{let i=[];for(let a of t){let o=await this.saveWeeklyReviewImage(a,r,n);i.push(o)}return i}catch(i){throw console.error("Error saving multiple weekly review images:",i),i}}async deleteImage(t){try{await vi.deleteImage(t,!0)}catch(r){throw console.error(`Error deleting image ${t}:`,r),r}}async deleteEmptyFolder(t){try{await vi.deleteEmptyFolder(t,this.getJournalFolderPath())}catch(r){console.error(`Error deleting empty folder ${t}:`,r)}}getMonthlyReviewPath(t){let r=t.getFullYear(),n=t.getMonth()+1;if(this.folderPathService)return(0,up.normalizePath)(this.folderPathService.getMonthlyReviewPathForQuarterSync(r,n));let i=n.toString().padStart(2,"0");return(0,up.normalizePath)(`${this.getJournalFolderPath()}/${r}/${i}/${i}-Review.md`)}cleanup(){var t;(t=this.unsubscribeSettings)==null||t.call(this)}}});function Gb(e){let t=n=>{if(n==null||n==="")return;let i=parseFloat(n);return Number.isFinite(i)?i:void 0},r=n=>{if(n==null||n==="")return 0;let i=parseFloat(n);return Number.isFinite(i)?i:0};return{rMultiple:t(e.rMultiple),riskAmount:t(e.riskAmount),stopLoss:t(e.stopLoss),commission:r(e.commission),swap:r(e.swap),fees:r(e.fees)}}var zO=F(()=>{});var vu,jO,v0e=F(()=>{vu=require("obsidian");Tm();_t();Oa();Nl();av();zO();Nd();Tr();uh();jO=class extends ts{constructor(r,n,i,a={}){super(r,{...a,namespace:"monthly-reviews",cacheTTL:300*1e3,persistCache:!0});this.folderPathService=null;this.lastCacheClear=0;this.monthlyDataCache=new Map;this.templateService=null;this.transformService=null;this.setPlugin(n),this.folderPathService=i||null,this.folderPathService||this.initializeFolderPathService(),xe.subscribe("review:changed",async o=>{if(o.type==="monthly"&&o.action==="opened"){let s=Date.now();(!this.lastCacheClear||s-this.lastCacheClear>5e3)&&(await this.clearCache(),this.monthlyDataCache.clear(),this.lastCacheClear=s)}})}getPlugin(){if(!this.plugin)throw new Error("Plugin not initialized");return this.plugin}async initializeFolderPathService(){var r;try{(r=this.getPlugin())!=null&&r.serviceManager&&(this.folderPathService=await this.getPlugin().serviceManager.getFolderPathService())}catch(n){console.warn("Could not initialize FolderPathService:",n),this.folderPathService=null}}getTemplateServices(){return this.templateService||(this.templateService=new uo(this.getPlugin())),this.transformService||(this.transformService=new jl(this.getPlugin())),{templateService:this.templateService,transformService:this.transformService}}defaultFrontmatter(){let r=new Date,n=r.getFullYear(),i=String(r.getMonth()+1).padStart(2,"0"),a=String(r.getDate()).padStart(2,"0");return{type:"monthly-review",date:`${n}-${i}-${a}`,month:r.getMonth()+1,year:r.getFullYear(),reviewQuestions:{},monthlyGoals:[],keyFocusAreas:[],biggestAccomplishment:"",biggestChallenge:"",lessonsLearned:[],nextMonthGoals:[],areasOfImprovement:[]}}getCacheNamespace(){return"monthly-reviews"}isValidType(r){return(r==null?void 0:r.type)==="monthly-review"}async clearCache(){await super.clearCache(),this.monthlyDataCache.clear()}async ensureDirectoryExists(r){let n=r.substring(0,r.lastIndexOf("/"));await this.app.vault.adapter.exists(n)||await this.app.vault.createFolder(n)}getJournalFolderPath(){return this.folderPathService?this.folderPathService.journalFolderPath:"!Journalit"}getMonthlyReviewPath(r){let n=r.getFullYear(),i=r.getMonth()+1;if(this.folderPathService)return(0,vu.normalizePath)(this.folderPathService.getMonthlyReviewPathForQuarterSync(n,i));let a=i.toString().padStart(2,"0");return(0,vu.normalizePath)(`${this.getJournalFolderPath()}/${n}/${a}/${a}-Review.md`)}formatDateForDisplay(r){let n=r.getFullYear(),i=String(r.getMonth()+1).padStart(2,"0"),a=String(r.getDate()).padStart(2,"0");return`${n}-${i}-${a}`}async createMonthlyReview(r){let n=this.getMonthlyReviewPath(r),i=this.app.vault.getAbstractFileByPath(n);if(i instanceof vu.TFile)return i;await this.ensureDirectoryExists(n);let a={...this.defaultFrontmatter(),date:this.formatDateForDisplay(r),month:r.getMonth()+1,year:r.getFullYear()},o=this.generateInitialContent(a);try{return await this.app.vault.create(n,o)}catch(s){return console.error("Error creating monthly review:",s),null}}async openMonthlyReview(r){if(!(r instanceof Date)||isNaN(r.getTime())){console.error("Invalid date passed to openMonthlyReview:",r);return}try{let n=r.getMonth()+1,i=r.getFullYear(),a=null;if(this.app.workspace.iterateAllLeaves(l=>{var c;if(l.view instanceof vu.FileView&&l.view.file){let d=l.view.file,u=(c=this.app.metadataCache.getFileCache(d))==null?void 0:c.frontmatter;(u==null?void 0:u.type)==="monthly-review"&&Number(u==null?void 0:u.month)===n&&Number(u==null?void 0:u.year)===i&&(a=l)}}),a){this.app.workspace.revealLeaf(a);return}let o=this.getMonthlyReviewPath(r);if(await this.app.vault.adapter.exists(o))await this.getPlugin().openFile(o,!0);else{let l=await this.createMonthlyReview(r);if(l)await this.getPlugin().openFile(l.path,!0);else throw new Error(`Failed to create monthly review for ${r.toDateString()}. Check console for details.`)}}catch(n){throw console.error(`Failed to open monthly review for date ${r.toDateString()}:`,n),n}}generateMonthlyReviewTags(r,n){let i=[],a=new Date(n,r-1,1);i.push([bm(ym.MONTHLY)]);let o=xm(a);o.length>0&&i.push(o);let s=Math.ceil(r/3);return i.push([`q${s}-review`]),r===1?i.push(["year-start"]):r===12&&i.push(["year-end"]),wm(...i)}generateInitialContent(r){let n=this.generateMonthlyReviewTags(r.month,r.year),i={type:r.type,date:r.date,month:r.month,year:r.year,tags:n},{templateService:a,transformService:o}=this.getTemplateServices(),s=a.getDefaultTemplate("monthly");return i.templateId=s.id,i.templateVersion=s.version,o.generateNoteFromTemplate(s,i)}async getMonthlyTrades(r,n){try{let i=new Date(r,n-1,1);new Date(r,n,0).setHours(23,59,59,999);let o=[],s=this.app.vault.getMarkdownFiles();for(let l of s)try{let c=this.app.metadataCache.getFileCache(l),d=c==null?void 0:c.frontmatter;if(((d==null?void 0:d.type)==="trade"||(d==null?void 0:d.type)==="backtest-trade")&&d.entryTime){let u=new Date(d.entryTime);if(isNaN(u.getTime()))continue;let p=Zt(u,this.plugin);if(p.getFullYear()===r&&p.getMonth()+1===n){let m=d.exitTime?new Date(d.exitTime):u,g=d.pnl===void 0||d.pnl===null,f={instrument:d.instrument||d.ticker,direction:d.direction||d.side,entryTime:u,exitTime:m,entryPrice:parseFloat(d.entryPrice)||0,exitPrice:d.exitPrice!==void 0&&d.exitPrice!==null?parseFloat(d.exitPrice):0,positionSize:parseFloat(d.positionSize)||0,pnl:d.pnl!==void 0&&d.pnl!==null?d.pnl:0,setup:d.setup,tags:d.tags,mistake:d.mistake,account:Array.isArray(d.account)?d.account:d.account?[d.account]:[],accountIds:Array.isArray(d.accountIds)?d.accountIds:d.accountIds?[d.accountIds]:[],path:l.path,tradeStatus:d.tradeStatus,useDirectPnLInput:d.useDirectPnLInput,exits:d.exits,entries:d.entries,_originalPnlWasNull:g,...Gb(d)};o.push(f)}}}catch(c){console.warn(`Error processing trade file ${l.path}:`,c);continue}return o}catch(i){return console.error("Error getting monthly trades:",i),[]}}async getWeeklyPerformance(r,n){var i,a;try{let o=await this.getMonthlyTrades(r,n);if(o.length===0)return console.log(`No trades found for ${r}-${String(n).padStart(2,"0")}`),[];let s=new Map,l=(i=this.getPlugin())!=null&&i.serviceManager?await this.getPlugin().serviceManager.getWeeklyReviewService():(a=this.getPlugin())==null?void 0:a.weeklyReviewService;return o.forEach(c=>{let d=new Date(c.entryTime),u=ea(d),p=this.getWeekNumber(d);if(d.getMonth()+1!==n)return;if(!s.has(p)){let g=new Date(u);g.setDate(g.getDate()+6);let f;l&&(f=l.getWeeklyReviewPath(u)),s.set(p,{weekNumber:p,weekStartDate:u,weekEndDate:g,trades:0,winRate:0,profitFactor:0,pnl:0,weeklyReviewPath:f})}let m=s.get(p);m.trades++,m.pnl+=c.pnl||0}),s.forEach((c,d)=>{let u=o.filter(v=>{let h=new Date(v.entryTime);return this.getWeekNumber(h)===d&&h.getMonth()+1===n}),p=u.filter(v=>(v.pnl||0)>0),m=u.filter(v=>(v.pnl||0)<0);c.winRate=u.length>0?p.length/u.length:0;let g=p.reduce((v,h)=>v+(h.pnl||0),0),f=Math.abs(m.reduce((v,h)=>v+(h.pnl||0),0));c.profitFactor=f>0?g/f:g>0?1/0:0}),Array.from(s.values()).sort((c,d)=>c.weekNumber-d.weekNumber)}catch(o){return console.error("Error getting weekly performance:",o),[]}}getWeekNumber(r){let n=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate())),i=n.getUTCDay()||7;n.setUTCDate(n.getUTCDate()+4-i);let a=new Date(Date.UTC(n.getUTCFullYear(),0,1));return Math.ceil(((n.getTime()-a.getTime())/864e5+1)/7)}async getDemonTrackerData(r,n){var i,a,o;try{let s=(i=this.getPlugin())==null?void 0:i.drcService;if(!s&&((a=this.getPlugin())!=null&&a.serviceManager))try{s=await this.getPlugin().serviceManager.getDRCService()}catch(u){console.warn("Could not get DRC service:",u)}if(!s)return console.log("DRC service not available for demon tracker data"),[];let l=new Date(r,n-1,1),c=new Date(r,n,0),d=new Map;for(let u=new Date(l);u<=c;u.setDate(u.getDate()+1)){let p=s.getDRCNotePath(new Date(u)),m=this.app.vault.getAbstractFileByPath(p);if(m instanceof vu.TFile){let g=this.app.metadataCache.getFileCache(m),f=g==null?void 0:g.frontmatter;if(f&&f.type==="drc"){let v=(o=this.getPlugin())==null?void 0:o.tradeService;if(v){let h=new Date(u);h.setHours(0,0,0,0);let y=new Date(u);y.setHours(23,59,59,999);let b=await v.getTrades(h,y),k=[];for(let x of b){let S=await v.extractTradeData(x);S&&k.push(S)}k.forEach(x=>{x.mistake&&Array.isArray(x.mistake)&&x.mistake.forEach(S=>{d.has(S)||d.set(S,{mistake:S,occurrences:0,dates:[]});let w=d.get(S);w.occurrences++,w.dates.push(u.toISOString())})})}}}}return Array.from(d.values()).sort((u,p)=>p.occurrences-u.occurrences)}catch(s){return console.error("Error getting demon tracker data:",s),[]}}async getAdjacentMonthlyReview(r,n,i=!0){var c,d;let a=new Date(r);a.setMonth(a.getMonth()+n);let o=this.getMonthlyReviewPath(a);if(this.app.vault.getAbstractFileByPath(o)instanceof vu.TFile)return o;let l=(c=this.getPlugin())==null?void 0:c.settings;if(i&&((d=l==null?void 0:l.monthly)!=null&&d.autoCreateMonthlyReviewOnNavigation)){let u=await this.createMonthlyReview(a);return u?u.path:null}return null}async getBestPerformingWeek(r,n){let i=await this.getWeeklyPerformance(r,n);return i.length===0?null:i.reduce((a,o)=>o.pnl>a.pnl?o:a)}async getWorstPerformingWeek(r,n){let i=await this.getWeeklyPerformance(r,n);return i.length===0?null:i.reduce((a,o)=>o.pnl<a.pnl?o:a)}async getWeeklyGamePerformance(r,n){var i,a,o,s;try{let l=await this.getWeeklyPerformance(r,n),c=(i=this.getPlugin())!=null&&i.serviceManager?await this.getPlugin().serviceManager.getWeeklyReviewService():(a=this.getPlugin())==null?void 0:a.weeklyReviewService,d=(o=this.getPlugin())!=null&&o.serviceManager?await this.getPlugin().serviceManager.getDRCService():(s=this.getPlugin())==null?void 0:s.drcService;if(!c||!d)return console.warn("Weekly or DRC service not available for game performance data"),[];let u=[];for(let p of l){let m={A:0,B:0,C:0},g={A:0,B:0,C:0},f=await c.getDRCsForWeek(p.weekStartDate);for(let{data:k}of f){let x=ur(k.date);x&&x.getMonth()+1===n&&x.getFullYear()===r&&(k.mentalGrade&&["A","B","C"].includes(k.mentalGrade)&&m[k.mentalGrade]++,k.technicalGrade&&["A","B","C"].includes(k.technicalGrade)&&g[k.technicalGrade]++)}let v,h,y,b;if(p.weeklyReviewPath){let k=this.app.vault.getAbstractFileByPath(p.weeklyReviewPath);if(k instanceof vu.TFile){let x=await c.extractWeeklyReviewData(k);x&&(v=x.mentalGrade,h=x.technicalGrade,y=x.mentalNotes,b=x.technicalNotes)}}u.push({weekNumber:p.weekNumber,weekStartDate:p.weekStartDate,weekEndDate:p.weekEndDate,weeklyReviewPath:p.weeklyReviewPath,mentalGradeDistribution:m,technicalGradeDistribution:g,mentalRating:v,technicalRating:h,mentalNotes:y,technicalNotes:b})}return u}catch(l){return console.error("Error getting weekly game performance:",l),[]}}async getMonthlyDataOptimized(r,n){let i=`${r}-${n}`,a=this.monthlyDataCache.get(i);if(a&&Date.now()-a.timestamp<300*1e3)return a.data;try{let o=await this.getMonthlyTradesOptimized(r,n),s=await this.calculateWeeklyPerformance(o,r,n),l=this.getDemonTrackerDataFromTrades(o),c=await this.getWeeklyGamePerformanceOptimized(s,r,n),d=s.length>0?s.reduce((m,g)=>g.pnl>m.pnl?g:m):null,u=s.length>0?s.reduce((m,g)=>g.pnl<m.pnl?g:m):null,p={trades:o,weeklyPerformance:s,weeklyGamePerformance:c,demonTrackerData:l,bestWeek:d,worstWeek:u};return this.monthlyDataCache.set(i,{data:p,timestamp:Date.now()}),p}catch(o){return console.error("Error getting optimized monthly data:",o),{trades:[],weeklyPerformance:[],weeklyGamePerformance:[],demonTrackerData:[],bestWeek:null,worstWeek:null}}}async getMonthlyTradesOptimized(r,n){try{let i=[],a=`${this.getJournalFolderPath()}/${r}/${String(n).padStart(2,"0")}`,o=this.app.vault.getMarkdownFiles().filter(l=>l.path.startsWith(a)&&l.path.includes("/trades/")),s=20;for(let l=0;l<o.length;l+=s){let d=o.slice(l,l+s).map(async p=>{try{let m=this.app.metadataCache.getFileCache(p),g=m==null?void 0:m.frontmatter;if(((g==null?void 0:g.type)==="trade"||(g==null?void 0:g.type)==="backtest-trade")&&g.entryTime){let f=new Date(g.entryTime);if(isNaN(f.getTime()))return null;let v=Zt(f,this.plugin);if(v.getFullYear()===r&&v.getMonth()+1===n){let h=g.exitTime?new Date(g.exitTime):f,y=g.pnl===void 0||g.pnl===null;return{instrument:g.instrument||g.ticker,direction:g.direction||g.side,entryTime:f,exitTime:h,entryPrice:parseFloat(g.entryPrice)||0,exitPrice:g.exitPrice!==void 0&&g.exitPrice!==null?parseFloat(g.exitPrice):0,positionSize:parseFloat(g.positionSize)||0,pnl:g.pnl!==void 0&&g.pnl!==null?g.pnl:0,setup:g.setup,tags:g.tags,mistake:g.mistake,account:Array.isArray(g.account)?g.account:g.account?[g.account]:[],accountIds:Array.isArray(g.accountIds)?g.accountIds:g.accountIds?[g.accountIds]:[],path:p.path,tradeStatus:g.tradeStatus,useDirectPnLInput:g.useDirectPnLInput,exits:g.exits,entries:g.entries,_originalPnlWasNull:y,...Gb(g)}}}return null}catch(m){return console.warn(`Error processing trade file ${p.path}:`,m),null}}),u=await Promise.all(d);i.push(...u.filter(p=>p!==null))}return i}catch(i){return console.error("Error getting optimized monthly trades:",i),[]}}async calculateWeeklyPerformance(r,n,i){var a,o;try{if(r.length===0)return[];let s=new Map,l=(a=this.getPlugin())!=null&&a.serviceManager?await this.getPlugin().serviceManager.getWeeklyReviewService():(o=this.getPlugin())==null?void 0:o.weeklyReviewService;return r.forEach(c=>{let d=new Date(c.entryTime),u=ea(d),p=this.getWeekNumber(d);if(d.getMonth()+1!==i)return;if(!s.has(p)){let g=new Date(u);g.setDate(g.getDate()+6);let f;l&&(f=l.getWeeklyReviewPath(u)),s.set(p,{weekNumber:p,weekStartDate:u,weekEndDate:g,trades:0,winRate:0,profitFactor:0,pnl:0,weeklyReviewPath:f})}let m=s.get(p);m.trades++,m.pnl+=c.pnl||0}),s.forEach((c,d)=>{let u=r.filter(v=>{let h=new Date(v.entryTime);return this.getWeekNumber(h)===d&&h.getMonth()+1===i}),p=u.filter(v=>(v.pnl||0)>0),m=u.filter(v=>(v.pnl||0)<0);c.winRate=u.length>0?p.length/u.length:0;let g=p.reduce((v,h)=>v+(h.pnl||0),0),f=Math.abs(m.reduce((v,h)=>v+(h.pnl||0),0));c.profitFactor=f>0?g/f:g>0?1/0:0}),Array.from(s.values()).sort((c,d)=>c.weekNumber-d.weekNumber)}catch(s){return console.error("Error calculating weekly performance:",s),[]}}async getWeeklyGamePerformanceOptimized(r,n,i){var a,o,s,l;try{let c=(a=this.getPlugin())!=null&&a.serviceManager?await this.getPlugin().serviceManager.getWeeklyReviewService():(o=this.getPlugin())==null?void 0:o.weeklyReviewService,d=(s=this.getPlugin())!=null&&s.serviceManager?await this.getPlugin().serviceManager.getDRCService():(l=this.getPlugin())==null?void 0:l.drcService;if(!c||!d)return[];let u=r.map(async p=>{let m={A:0,B:0,C:0},g={A:0,B:0,C:0},f=await c.getDRCsForWeek(p.weekStartDate);for(let{data:k}of f){let x=ur(k.date);x&&x.getMonth()+1===i&&x.getFullYear()===n&&(k.mentalGrade&&["A","B","C"].includes(k.mentalGrade)&&m[k.mentalGrade]++,k.technicalGrade&&["A","B","C"].includes(k.technicalGrade)&&g[k.technicalGrade]++)}let v,h,y,b;if(p.weeklyReviewPath){let k=this.app.vault.getAbstractFileByPath(p.weeklyReviewPath);if(k instanceof vu.TFile){let x=await c.extractWeeklyReviewData(k);x&&(v=x.mentalGrade,h=x.technicalGrade,y=x.mentalNotes,b=x.technicalNotes)}}return{weekNumber:p.weekNumber,weekStartDate:p.weekStartDate,weekEndDate:p.weekEndDate,weeklyReviewPath:p.weeklyReviewPath,mentalGradeDistribution:m,technicalGradeDistribution:g,mentalRating:v,technicalRating:h,mentalNotes:y,technicalNotes:b}});return await Promise.all(u)}catch(c){return console.error("Error getting optimized weekly game performance:",c),[]}}getDemonTrackerDataFromTrades(r){try{let n=new Map;return r.forEach(i=>{i.mistake&&Array.isArray(i.mistake)&&i.mistake.forEach(a=>{n.has(a)||n.set(a,{mistake:a,occurrences:0,dates:[]});let o=n.get(a);o.occurrences++,o.dates.push(i.entryTime.toISOString())})}),Array.from(n.values()).sort((i,a)=>a.occurrences-i.occurrences)}catch(n){return console.error("Error processing demon tracker data from trades:",n),[]}}async updateMonthlyReviewFrontmatter(r,n){try{let i=this.app.vault.getAbstractFileByPath(r);if(!i||!(i instanceof vu.TFile))throw new Error(`Monthly Review file not found: ${r}`);await this.app.fileManager.processFrontMatter(i,a=>{Object.assign(a,n)}),await yn(this.app,i),await this.clearCache(),this.monthlyDataCache.clear();return}catch(i){throw console.error(`Error updating Monthly Review frontmatter in ${r}:`,i),i}}}});var yu,_O,y0e=F(()=>{yu=require("obsidian");Tm();Oa();Nl();av();zO();Nd();Tr();uh();_t();_O=class extends ts{constructor(r,n,i,a={}){super(r,{...a,namespace:"quarterly-reviews",cacheTTL:300*1e3,persistCache:!0});this.folderPathService=null;this.lastCacheClear=0;this.quarterlyDataCache=new Map;this.templateService=null;this.transformService=null;this.setPlugin(n),this.folderPathService=i||null,this.folderPathService||this.initializeFolderPathService(),xe.subscribe("review:changed",async o=>{if(o.type==="quarterly"&&o.action==="opened"){let s=Date.now();(!this.lastCacheClear||s-this.lastCacheClear>5e3)&&(await this.clearCache(),this.quarterlyDataCache.clear(),this.lastCacheClear=s)}})}getPlugin(){if(!this.plugin)throw new Error("Plugin not initialized");return this.plugin}async initializeFolderPathService(){var r;try{(r=this.getPlugin())!=null&&r.serviceManager&&(this.folderPathService=await this.getPlugin().serviceManager.getFolderPathService())}catch(n){console.warn("Could not initialize FolderPathService:",n),this.folderPathService=null}}getTemplateServices(){return this.templateService||(this.templateService=new uo(this.getPlugin())),this.transformService||(this.transformService=new jl(this.getPlugin())),{templateService:this.templateService,transformService:this.transformService}}defaultFrontmatter(){let r=new Date;return{type:"quarterly-review",date:r.toISOString(),quarter:Oi(r.getMonth()+1),year:r.getFullYear(),reviewQuestions:{},quarterlyGoals:[],keyFocusAreas:[],biggestAccomplishment:"",biggestChallenge:"",lessonsLearned:[],nextQuarterGoals:[],areasOfImprovement:[]}}getCacheNamespace(){return"quarterly-reviews"}isValidType(r){return(r==null?void 0:r.type)==="quarterly-review"}async clearCache(){await super.clearCache(),this.quarterlyDataCache.clear()}async ensureDirectoryExists(r){let n=r.substring(0,r.lastIndexOf("/"));await this.app.vault.adapter.exists(n)||await this.app.vault.createFolder(n)}getJournalFolderPath(){return this.folderPathService?this.folderPathService.journalFolderPath:"!Journalit"}async getQuarterlyReviewPath(r){let n=r.getFullYear(),i=Oi(r.getMonth()+1);if(this.folderPathService||await this.initializeFolderPathService(),this.folderPathService)return this.folderPathService.getQuarterlyReviewPath(n,i);let a=zu(i),o=JE(i),s=this.getJournalFolderPath(),l=!1;for(let c of o){let d=c.toString().padStart(2,"0"),u=(0,yu.normalizePath)(`${s}/${n}/${d}`);if(await this.app.vault.adapter.exists(u)){l=!0;break}}return l?(0,yu.normalizePath)(`${s}/${n}/${a}-Review.md`):(0,yu.normalizePath)(`${s}/${n}/${a}/${a}-Review.md`)}formatDateForDisplay(r){let n=r.getFullYear(),i=String(r.getMonth()+1).padStart(2,"0"),a=String(r.getDate()).padStart(2,"0");return`${n}-${i}-${a}`}async createQuarterlyReview(r){let n=await this.getQuarterlyReviewPath(r),i=this.app.vault.getAbstractFileByPath(n);if(i instanceof yu.TFile)return i;await this.ensureDirectoryExists(n);let a=Oi(r.getMonth()+1),o={...this.defaultFrontmatter(),date:this.formatDateForDisplay(r),quarter:a,year:r.getFullYear()},s=this.generateInitialContent(o);try{return await this.app.vault.create(n,s)}catch(l){return console.error("Error creating quarterly review:",l),null}}async openQuarterlyReview(r){if(!(r instanceof Date)||isNaN(r.getTime())){console.error("Invalid date passed to openQuarterlyReview:",r);return}try{let n=Oi(r.getMonth()+1),i=r.getFullYear(),a=null;if(this.app.workspace.iterateAllLeaves(l=>{var c;if(l.view instanceof yu.FileView&&l.view.file){let d=l.view.file,u=(c=this.app.metadataCache.getFileCache(d))==null?void 0:c.frontmatter;(u==null?void 0:u.type)==="quarterly-review"&&Number(u==null?void 0:u.quarter)===n&&Number(u==null?void 0:u.year)===i&&(a=l)}}),a){this.app.workspace.revealLeaf(a);return}let o=await this.getQuarterlyReviewPath(r);if(await this.app.vault.adapter.exists(o))await this.getPlugin().openFile(o,!0);else{let l=await this.createQuarterlyReview(r);if(l)await this.getPlugin().openFile(l.path,!0);else throw new Error(`Failed to create quarterly review for ${r.toDateString()}`)}}catch(n){throw console.error(`Failed to open quarterly review for date ${r.toDateString()}:`,n),n}}generateQuarterlyReviewTags(r,n){let i=[],a=sf(n,r);i.push([bm(ym.QUARTERLY)]);let o=xm(a);return o.length>0&&i.push(o),i.push([`q${r}-review`]),r<=2?i.push(["h1-review","first-half"]):i.push(["h2-review","second-half"]),r===1?i.push(["year-start"]):r===4&&i.push(["year-end"]),wm(...i)}generateInitialContent(r){let n=this.generateQuarterlyReviewTags(r.quarter,r.year),i={type:r.type,date:r.date,quarter:r.quarter,year:r.year,tags:n},{templateService:a,transformService:o}=this.getTemplateServices(),s=a.getDefaultTemplate("quarterly");return i.templateId=s.id,i.templateVersion=s.version,o.generateNoteFromTemplate(s,i)}async getQuarterlyTrades(r,n){try{let i=sf(r,n);ey(r,n).setHours(23,59,59,999);let o=[],s=this.app.vault.getMarkdownFiles();for(let l of s)try{let c=this.app.metadataCache.getFileCache(l),d=c==null?void 0:c.frontmatter;if(((d==null?void 0:d.type)==="trade"||(d==null?void 0:d.type)==="backtest-trade")&&d.entryTime){let u=new Date(d.entryTime);if(isNaN(u.getTime()))continue;let p=Zt(u,this.plugin),m=Oi(p.getMonth()+1);if(p.getFullYear()===r&&m===n){let g=d.exitTime?new Date(d.exitTime):u,f=d.pnl===void 0||d.pnl===null,v={instrument:d.instrument||d.ticker,direction:d.direction||d.side,entryTime:u,exitTime:g,entryPrice:parseFloat(d.entryPrice)||0,exitPrice:d.exitPrice!==void 0&&d.exitPrice!==null?parseFloat(d.exitPrice):0,positionSize:parseFloat(d.positionSize)||0,pnl:d.pnl!==void 0&&d.pnl!==null?d.pnl:0,setup:d.setup,tags:d.tags,mistake:d.mistake,account:Array.isArray(d.account)?d.account:d.account?[d.account]:[],accountIds:Array.isArray(d.accountIds)?d.accountIds:d.accountIds?[d.accountIds]:[],path:l.path,tradeStatus:d.tradeStatus,useDirectPnLInput:d.useDirectPnLInput,exits:d.exits,entries:d.entries,_originalPnlWasNull:f,...Gb(d)};o.push(v)}}}catch(c){console.warn(`Error processing trade file ${l.path}:`,c);continue}return o}catch(i){return console.error("Error getting quarterly trades:",i),[]}}async getMonthlyPerformance(r,n){var i;try{let a=await this.getQuarterlyTrades(r,n);if(a.length===0)return[];let o=new Map,s=JE(n),l=(i=this.getPlugin())!=null&&i.serviceManager?await this.getPlugin().serviceManager.getMonthlyReviewService():null;for(let c of s){let d=new Date(r,c-1,1),u=new Date(r,c,0),p;l&&(p=l.getMonthlyReviewPath(d)),o.set(c,{month:c,monthStartDate:d,monthEndDate:u,trades:0,winRate:0,profitFactor:0,pnl:0,monthlyReviewPath:p})}return a.forEach(c=>{let u=new Date(c.entryTime).getMonth()+1;if(o.has(u)){let p=o.get(u);p.trades++,p.pnl+=c.pnl||0}}),o.forEach((c,d)=>{let u=a.filter(v=>new Date(v.entryTime).getMonth()+1===d),p=u.filter(v=>(v.pnl||0)>0),m=u.filter(v=>(v.pnl||0)<0);c.winRate=u.length>0?p.length/u.length:0;let g=p.reduce((v,h)=>v+(h.pnl||0),0),f=Math.abs(m.reduce((v,h)=>v+(h.pnl||0),0));c.profitFactor=f>0?g/f:g>0?1/0:0}),Array.from(o.values()).sort((c,d)=>c.month-d.month)}catch(a){return console.error("Error getting monthly performance:",a),[]}}async getDemonTrackerData(r,n){try{let i=await this.getQuarterlyTrades(r,n);return this.getDemonTrackerDataFromTrades(i)}catch(i){return console.error("Error getting demon tracker data:",i),[]}}getDemonTrackerDataFromTrades(r){let n=new Map;return r.forEach(i=>{i.mistake&&Array.isArray(i.mistake)&&i.mistake.forEach(a=>{n.has(a)||n.set(a,{mistake:a,occurrences:0,dates:[]});let o=n.get(a);o.occurrences++,o.dates.push(i.entryTime.toISOString())})}),Array.from(n.values()).sort((i,a)=>a.occurrences-i.occurrences)}async getAdjacentQuarterlyReview(r,n,i=!0){var m,g;let a=Oi(r.getMonth()+1),o=r.getFullYear(),s=a+n,l=o;for(;s<1;)s+=4,l--;for(;s>4;)s-=4,l++;let c=sf(l,s),d=await this.getQuarterlyReviewPath(c);if(this.app.vault.getAbstractFileByPath(d)instanceof yu.TFile)return d;let p=(m=this.getPlugin())==null?void 0:m.settings;if(i&&((g=p==null?void 0:p.quarterly)!=null&&g.autoCreateQuarterlyReviewOnNavigation)){let f=await this.createQuarterlyReview(c);return f?f.path:null}return null}async getBestPerformingMonth(r,n){let i=await this.getMonthlyPerformance(r,n);return i.length===0?null:i.reduce((a,o)=>o.pnl>a.pnl?o:a)}async getWorstPerformingMonth(r,n){let i=await this.getMonthlyPerformance(r,n);return i.length===0?null:i.reduce((a,o)=>o.pnl<a.pnl?o:a)}async getMonthlyGamePerformance(r,n){var i,a;try{let o=await this.getMonthlyPerformance(r,n),s=(i=this.getPlugin())!=null&&i.serviceManager?await this.getPlugin().serviceManager.getMonthlyReviewService():null,l=(a=this.getPlugin())!=null&&a.serviceManager?await this.getPlugin().serviceManager.getDRCService():null;if(!s||!l)return[];let c=[];for(let d of o){let u={A:0,B:0,C:0},p={A:0,B:0,C:0},m=d.monthStartDate,g=d.monthEndDate;for(let b=new Date(m);b<=g;b.setDate(b.getDate()+1)){let k=l.getDRCNotePath(new Date(b)),x=this.app.vault.getAbstractFileByPath(k);if(x instanceof yu.TFile){let S=this.app.metadataCache.getFileCache(x),w=S==null?void 0:S.frontmatter;w&&w.type==="drc"&&(w.mentalGrade&&["A","B","C"].includes(w.mentalGrade)&&u[w.mentalGrade]++,w.technicalGrade&&["A","B","C"].includes(w.technicalGrade)&&p[w.technicalGrade]++)}}let f,v,h,y;if(d.monthlyReviewPath){let b=this.app.vault.getAbstractFileByPath(d.monthlyReviewPath);if(b instanceof yu.TFile){let k=this.app.metadataCache.getFileCache(b),x=k==null?void 0:k.frontmatter;x&&(f=x.mentalGrade,v=x.technicalGrade,h=x.mentalNotes,y=x.technicalNotes)}}c.push({month:d.month,monthStartDate:d.monthStartDate,monthEndDate:d.monthEndDate,monthlyReviewPath:d.monthlyReviewPath,mentalGradeDistribution:u,technicalGradeDistribution:p,mentalRating:f,technicalRating:v,mentalNotes:h,technicalNotes:y})}return c}catch(o){return console.error("Error getting monthly game performance:",o),[]}}async getQuarterlyDataOptimized(r,n){let i=`${r}-Q${n}`,a=this.quarterlyDataCache.get(i);if(a&&Date.now()-a.timestamp<300*1e3)return a.data;try{let o=await this.getQuarterlyTrades(r,n),s=await this.calculateMonthlyPerformance(o,r,n),l=this.getDemonTrackerDataFromTrades(o),c=await this.getMonthlyGamePerformance(r,n),d=s.length>0?s.reduce((m,g)=>g.pnl>m.pnl?g:m):null,u=s.length>0?s.reduce((m,g)=>g.pnl<m.pnl?g:m):null,p={trades:o,monthlyPerformance:s,monthlyGamePerformance:c,demonTrackerData:l,bestMonth:d,worstMonth:u};return this.quarterlyDataCache.set(i,{data:p,timestamp:Date.now()}),p}catch(o){return console.error("Error getting optimized quarterly data:",o),{trades:[],monthlyPerformance:[],monthlyGamePerformance:[],demonTrackerData:[],bestMonth:null,worstMonth:null}}}async calculateMonthlyPerformance(r,n,i){var a;try{let o=new Map,s=JE(i),l=(a=this.getPlugin())!=null&&a.serviceManager?await this.getPlugin().serviceManager.getMonthlyReviewService():null;for(let c of s){let d=new Date(n,c-1,1),u=new Date(n,c,0),p;l&&(p=l.getMonthlyReviewPath(d)),o.set(c,{month:c,monthStartDate:d,monthEndDate:u,trades:0,winRate:0,profitFactor:0,pnl:0,monthlyReviewPath:p})}return r.forEach(c=>{let u=new Date(c.entryTime).getMonth()+1;if(o.has(u)){let p=o.get(u);p.trades++,p.pnl+=c.pnl||0}}),o.forEach((c,d)=>{let u=r.filter(v=>new Date(v.entryTime).getMonth()+1===d),p=u.filter(v=>(v.pnl||0)>0),m=u.filter(v=>(v.pnl||0)<0);c.winRate=u.length>0?p.length/u.length:0;let g=p.reduce((v,h)=>v+(h.pnl||0),0),f=Math.abs(m.reduce((v,h)=>v+(h.pnl||0),0));c.profitFactor=f>0?g/f:g>0?1/0:0}),Array.from(o.values()).sort((c,d)=>c.month-d.month)}catch(o){return console.error("Error calculating monthly performance:",o),[]}}async updateQuarterlyReviewFrontmatter(r,n){try{let i=this.app.vault.getAbstractFileByPath(r);if(!i||!(i instanceof yu.TFile))throw new Error(`Quarterly Review file not found: ${r}`);await this.app.fileManager.processFrontMatter(i,a=>{Object.assign(a,n)}),await yn(this.app,i),await this.clearCache(),this.quarterlyDataCache.clear();return}catch(i){throw console.error(`Error updating Quarterly Review frontmatter in ${r}:`,i),i}}}});var Cm,BO,b0e=F(()=>{Cm=require("obsidian");Tm();Oa();Nl();av();zO();Nd();Tr();uh();_t();BO=class extends ts{constructor(r,n,i,a={}){super(r,{...a,namespace:"yearly-reviews",cacheTTL:300*1e3,persistCache:!0});this.folderPathService=null;this.lastCacheClear=0;this.yearlyDataCache=new Map;this.templateService=null;this.transformService=null;this.setPlugin(n),this.folderPathService=i||null,this.folderPathService||this.initializeFolderPathService(),xe.subscribe("review:changed",async o=>{if(o.type==="yearly"&&o.action==="opened"){let s=Date.now();(!this.lastCacheClear||s-this.lastCacheClear>5e3)&&(await this.clearCache(),this.yearlyDataCache.clear(),this.lastCacheClear=s)}})}getPlugin(){if(!this.plugin)throw new Error("Plugin not initialized");return this.plugin}async initializeFolderPathService(){var r;try{(r=this.getPlugin())!=null&&r.serviceManager&&(this.folderPathService=await this.getPlugin().serviceManager.getFolderPathService())}catch(n){console.warn("Could not initialize FolderPathService:",n),this.folderPathService=null}}getTemplateServices(){return this.templateService||(this.templateService=new uo(this.getPlugin())),this.transformService||(this.transformService=new jl(this.getPlugin())),{templateService:this.templateService,transformService:this.transformService}}defaultFrontmatter(){let r=new Date,n=r.getFullYear(),i=String(r.getMonth()+1).padStart(2,"0"),a=String(r.getDate()).padStart(2,"0");return{type:"yearly-review",date:`${n}-${i}-${a}`,year:r.getFullYear(),reviewQuestions:{},yearlyGoals:[],keyFocusAreas:[],biggestAccomplishment:"",biggestChallenge:"",lessonsLearned:[],nextYearGoals:[],areasOfImprovement:[]}}getCacheNamespace(){return"yearly-reviews"}isValidType(r){return(r==null?void 0:r.type)==="yearly-review"}async clearCache(){await super.clearCache(),this.yearlyDataCache.clear()}async ensureDirectoryExists(r){let n=r.substring(0,r.lastIndexOf("/"));await this.app.vault.adapter.exists(n)||await this.app.vault.createFolder(n)}getJournalFolderPath(){return this.folderPathService?this.folderPathService.journalFolderPath:"!Journalit"}async getYearlyReviewPath(r){let n=r.getFullYear();return this.folderPathService?this.folderPathService.getYearlyReviewPath(n):(0,Cm.normalizePath)(`${this.getJournalFolderPath()}/${n}/${n}-Review.md`)}formatDateForDisplay(r){let n=r.getFullYear(),i=String(r.getMonth()+1).padStart(2,"0"),a=String(r.getDate()).padStart(2,"0");return`${n}-${i}-${a}`}async createYearlyReview(r){let n=await this.getYearlyReviewPath(r),i=this.app.vault.getAbstractFileByPath(n);if(i instanceof Cm.TFile)return i;await this.ensureDirectoryExists(n);let a=r.getFullYear(),o={...this.defaultFrontmatter(),date:this.formatDateForDisplay(r),year:a},s=this.generateInitialContent(o);try{return await this.app.vault.create(n,s)}catch(l){return console.error("Error creating yearly review:",l),null}}async openYearlyReview(r){if(!(r instanceof Date)||isNaN(r.getTime())){console.error("Invalid date passed to openYearlyReview:",r);return}try{let n=r.getFullYear(),i=null;if(this.app.workspace.iterateAllLeaves(s=>{var l;if(s.view instanceof Cm.FileView&&s.view.file){let c=s.view.file,d=(l=this.app.metadataCache.getFileCache(c))==null?void 0:l.frontmatter;(d==null?void 0:d.type)==="yearly-review"&&Number(d==null?void 0:d.year)===n&&(i=s)}}),i){this.app.workspace.revealLeaf(i);return}let a=await this.getYearlyReviewPath(r);if(await this.app.vault.adapter.exists(a))await this.getPlugin().openFile(a,!0);else{let s=await this.createYearlyReview(r);if(s)await this.getPlugin().openFile(s.path,!0);else throw new Error(`Failed to create yearly review for ${r.toDateString()}`)}}catch(n){throw console.error(`Failed to open yearly review for date ${r.toDateString()}:`,n),n}}generateYearlyReviewTags(r){let n=[],i=QE(r);n.push([bm(ym.YEARLY)]);let a=xm(i);a.length>0&&n.push(a),n.push([`year-${r}-review`]);let o=Math.floor(r/10)*10;return n.push([`decade-${o}s`]),wm(...n)}generateInitialContent(r){let n=this.generateYearlyReviewTags(r.year),i={type:r.type,date:r.date,year:r.year,tags:n},{templateService:a,transformService:o}=this.getTemplateServices(),s=a.getDefaultTemplate("yearly");return i.templateId=s.id,i.templateVersion=s.version,o.generateNoteFromTemplate(s,i)}async getYearlyTrades(r){try{let n=QE(r),i=fX(r),a=[],o=this.app.vault.getMarkdownFiles();for(let s of o)try{let l=this.app.metadataCache.getFileCache(s),c=l==null?void 0:l.frontmatter;if(((c==null?void 0:c.type)==="trade"||(c==null?void 0:c.type)==="backtest-trade")&&c.entryTime){let d=new Date(c.entryTime);if(isNaN(d.getTime()))continue;if(Zt(d,this.plugin).getFullYear()===r){let p=c.exitTime?new Date(c.exitTime):d,m=c.pnl===void 0||c.pnl===null,g={instrument:c.instrument||c.ticker,direction:c.direction||c.side,entryTime:d,exitTime:p,entryPrice:parseFloat(c.entryPrice)||0,exitPrice:c.exitPrice!==void 0&&c.exitPrice!==null?parseFloat(c.exitPrice):0,positionSize:parseFloat(c.positionSize)||0,pnl:c.pnl!==void 0&&c.pnl!==null?c.pnl:0,setup:c.setup,tags:c.tags,mistake:c.mistake,account:Array.isArray(c.account)?c.account:c.account?[c.account]:[],accountIds:Array.isArray(c.accountIds)?c.accountIds:c.accountIds?[c.accountIds]:[],path:s.path,tradeStatus:c.tradeStatus,useDirectPnLInput:c.useDirectPnLInput,exits:c.exits,entries:c.entries,_originalPnlWasNull:m,...Gb(c)};a.push(g)}}}catch(l){console.warn(`Error processing trade file ${s.path}:`,l);continue}return a}catch(n){return console.error("Error getting yearly trades:",n),[]}}async getQuarterlyPerformance(r){try{let n=await this.getYearlyTrades(r);if(n.length===0)return[];let i=new Map;for(let a=1;a<=4;a++){let o=sf(r,a),s=ey(r,a),l;this.folderPathService&&(l=await this.folderPathService.getQuarterlyReviewPath(r,a)),i.set(a,{quarter:a,quarterStartDate:o,quarterEndDate:s,trades:0,winRate:0,profitFactor:0,pnl:0,quarterlyReviewPath:l})}return n.forEach(a=>{let o=new Date(a.entryTime),s=Oi(o.getMonth()+1);if(i.has(s)){let l=i.get(s);l.trades++,l.pnl+=a.pnl||0}}),i.forEach((a,o)=>{let s=n.filter(p=>{let m=new Date(p.entryTime);return Oi(m.getMonth()+1)===o}),l=s.filter(p=>(p.pnl||0)>0),c=s.filter(p=>(p.pnl||0)<0);a.winRate=s.length>0?l.length/s.length:0;let d=l.reduce((p,m)=>p+(m.pnl||0),0),u=Math.abs(c.reduce((p,m)=>p+(m.pnl||0),0));a.profitFactor=u>0?d/u:d>0?1/0:0}),Array.from(i.values()).sort((a,o)=>a.quarter-o.quarter)}catch(n){return console.error("Error getting quarterly performance:",n),[]}}async getDemonTrackerData(r){try{let n=await this.getYearlyTrades(r);return this.getDemonTrackerDataFromTrades(n)}catch(n){return console.error("Error getting demon tracker data:",n),[]}}getDemonTrackerDataFromTrades(r){let n=new Map;return r.forEach(i=>{i.mistake&&Array.isArray(i.mistake)&&i.mistake.forEach(a=>{n.has(a)||n.set(a,{mistake:a,occurrences:0,dates:[]});let o=n.get(a);o.occurrences++,o.dates.push(i.entryTime.toISOString())})}),Array.from(n.values()).sort((i,a)=>a.occurrences-i.occurrences)}async getAdjacentYearlyReview(r,n,i=!0){var u,p;let o=r.getFullYear()+n,s=QE(o),l=await this.getYearlyReviewPath(s);if(this.app.vault.getAbstractFileByPath(l)instanceof Cm.TFile)return l;let d=(u=this.getPlugin())==null?void 0:u.settings;if(i&&((p=d==null?void 0:d.yearly)!=null&&p.autoCreateYearlyReviewOnNavigation)){let m=await this.createYearlyReview(s);return m?m.path:null}return null}async getBestPerformingQuarter(r){let n=await this.getQuarterlyPerformance(r);return n.length===0?null:n.reduce((i,a)=>a.pnl>i.pnl?a:i)}async getWorstPerformingQuarter(r){let n=await this.getQuarterlyPerformance(r);return n.length===0?null:n.reduce((i,a)=>a.pnl<i.pnl?a:i)}async getQuarterlyGamePerformance(r){var n;try{let i=await this.getQuarterlyPerformance(r),a=(n=this.getPlugin())!=null&&n.serviceManager?await this.getPlugin().serviceManager.getDRCService():null;if(!a)return[];let o=[];for(let s of i){let l={A:0,B:0,C:0},c={A:0,B:0,C:0},d=s.quarterStartDate,u=s.quarterEndDate;for(let v=new Date(d);v<=u;v.setDate(v.getDate()+1)){let h=a.getDRCNotePath(new Date(v)),y=this.app.vault.getAbstractFileByPath(h);if(y instanceof Cm.TFile){let b=this.app.metadataCache.getFileCache(y),k=b==null?void 0:b.frontmatter;k&&k.type==="drc"&&(k.mentalGrade&&["A","B","C"].includes(k.mentalGrade)&&l[k.mentalGrade]++,k.technicalGrade&&["A","B","C"].includes(k.technicalGrade)&&c[k.technicalGrade]++)}}let p,m,g,f;if(s.quarterlyReviewPath){let v=this.app.vault.getAbstractFileByPath(s.quarterlyReviewPath);if(v instanceof Cm.TFile){let h=this.app.metadataCache.getFileCache(v),y=h==null?void 0:h.frontmatter;y&&(p=y.mentalGrade,m=y.technicalGrade,g=y.mentalNotes,f=y.technicalNotes)}}o.push({quarter:s.quarter,quarterStartDate:s.quarterStartDate,quarterEndDate:s.quarterEndDate,quarterlyReviewPath:s.quarterlyReviewPath,mentalGradeDistribution:l,technicalGradeDistribution:c,mentalRating:p,technicalRating:m,mentalNotes:g,technicalNotes:f})}return o}catch(i){return console.error("Error getting quarterly game performance:",i),[]}}async getYearlyDataOptimized(r){let n=`${r}`,i=this.yearlyDataCache.get(n);if(i&&Date.now()-i.timestamp<300*1e3)return i.data;try{let a=await this.getYearlyTrades(r),o=await this.calculateQuarterlyPerformance(a,r),s=this.getDemonTrackerDataFromTrades(a),l=await this.getQuarterlyGamePerformance(r),c=o.length>0?o.reduce((p,m)=>m.pnl>p.pnl?m:p):null,d=o.length>0?o.reduce((p,m)=>m.pnl<p.pnl?m:p):null,u={trades:a,quarterlyPerformance:o,quarterlyGamePerformance:l,demonTrackerData:s,bestQuarter:c,worstQuarter:d};return this.yearlyDataCache.set(n,{data:u,timestamp:Date.now()}),u}catch(a){return console.error("Error getting optimized yearly data:",a),{trades:[],quarterlyPerformance:[],quarterlyGamePerformance:[],demonTrackerData:[],bestQuarter:null,worstQuarter:null}}}async calculateQuarterlyPerformance(r,n){try{let i=new Map;for(let a=1;a<=4;a++){let o=sf(n,a),s=ey(n,a),l;this.folderPathService&&(l=await this.folderPathService.getQuarterlyReviewPath(n,a)),i.set(a,{quarter:a,quarterStartDate:o,quarterEndDate:s,trades:0,winRate:0,profitFactor:0,pnl:0,quarterlyReviewPath:l})}return r.forEach(a=>{let o=new Date(a.entryTime),s=Oi(o.getMonth()+1);if(i.has(s)){let l=i.get(s);l.trades++,l.pnl+=a.pnl||0}}),i.forEach((a,o)=>{let s=r.filter(p=>{let m=new Date(p.entryTime);return Oi(m.getMonth()+1)===o}),l=s.filter(p=>(p.pnl||0)>0),c=s.filter(p=>(p.pnl||0)<0);a.winRate=s.length>0?l.length/s.length:0;let d=l.reduce((p,m)=>p+(m.pnl||0),0),u=Math.abs(c.reduce((p,m)=>p+(m.pnl||0),0));a.profitFactor=u>0?d/u:d>0?1/0:0}),Array.from(i.values()).sort((a,o)=>a.quarter-o.quarter)}catch(i){return console.error("Error calculating quarterly performance:",i),[]}}async updateYearlyReviewFrontmatter(r,n){try{let i=this.app.vault.getAbstractFileByPath(r);if(!i||!(i instanceof Cm.TFile))throw new Error(`Yearly Review file not found: ${r}`);await this.app.fileManager.processFrontMatter(i,a=>{Object.assign(a,n)}),await yn(this.app,i),await this.clearCache(),this.yearlyDataCache.clear();return}catch(i){throw console.error(`Error updating Yearly Review frontmatter in ${r}:`,i),i}}}});var uV,WO,x0e=F(()=>{uV=require("obsidian");Bu();ny();WO=class{constructor(t,r){this.fields={...ry};this.fieldOptions={};this.namespace="";this.plugin=t,r!=null&&r.namespace&&(this.namespace=r.namespace),this.loadFields(),this.loadFieldOptions()}getFieldsKey(){return this.namespace?`customTradeFields_${this.namespace}`:"customTradeFields"}loadFields(){try{let t=this.getFieldsKey(),r=this.plugin;if(r.settings&&r.settings[t]){let n={...ry,...r.settings[t]};this.fields.fields=(n.fields||[]).filter(i=>this.isValidFieldDefinition(i)).sort((i,a)=>i.order-a.order)}else if(!this.namespace&&r.settings&&r.settings.customTradeFields){let n={...ry,...r.settings.customTradeFields};this.fields.fields=(n.fields||[]).filter(i=>this.isValidFieldDefinition(i)).sort((i,a)=>i.order-a.order)}}catch(t){Be.logError(t,Be.createContext("load custom fields")),this.fields={...ry}}}isValidFieldDefinition(t){return t&&typeof t.id=="string"&&typeof t.label=="string"&&typeof t.type=="string"&&Object.values(Hx).includes(t.type)&&typeof t.order=="number"}validateRegexPattern(t){if(!t)return!0;try{let r=[/\(\?\!\.\*\)\.\*/,/\(\.\*\)\+/,/\.\*\.\*/,/\(\.\+\)\+/,/\(\?\!\.\+\)\.\+/];for(let a of r)if(a.test(t))return!1;let n=Date.now();return new RegExp(t),!(Date.now()-n>50)}catch(r){return console.warn("[CustomFieldsService] Invalid regex pattern:",t,r),!1}}async saveFields(){try{let t=this.getFieldsKey(),r=this.plugin;if(r.settings)r.settings[t]={...this.fields},await r.saveSettings();else{let i={...await this.plugin.loadData()||{},[t]:this.fields};await this.plugin.saveData(i)}this.plugin.app.workspace.trigger("journalit-custom-fields-changed",this.fields)}catch(t){throw Be.logError(t,Be.createContext("save custom fields")),t}}getFields(){return[...this.fields.fields].sort((t,r)=>t.order-r.order)}getField(t){return this.fields.fields.find(r=>r.id===t)}async addField(t){var a;let r=t.label||"New Field",n=this.fields.fields.map(o=>o.fieldKey||Zg(o.label));if((a=t.validation)!=null&&a.pattern&&!this.validateRegexPattern(t.validation.pattern)){let o=new Error(`Invalid or potentially dangerous regex pattern: ${t.validation.pattern}`);throw Be.logError(o,Be.createContext("validate field pattern")),o}let i={id:t.id||q_(),label:r,fieldKey:t.fieldKey||qx(r,n),type:t.type||"text",validation:t.validation||{},options:t.options||[],allowCreateOptions:t.allowCreateOptions,placeholder:t.placeholder,helperText:t.helperText,order:t.order||Date.now()};return this.fields.fields.push(i),await this.saveFields(),i}async updateField(t,r){var i;let n=this.fields.fields.findIndex(a=>a.id===t);if(n===-1)return console.error(`Field with ID ${t} not found`),null;if((i=r.validation)!=null&&i.pattern&&!this.validateRegexPattern(r.validation.pattern)){let a=new Error(`Invalid or potentially dangerous regex pattern: ${r.validation.pattern}`);throw Be.logError(a,Be.createContext("validate field pattern update")),a}if(r.fieldKey!==void 0){let a=aI(r.fieldKey);if(a)throw new Error(`Invalid field key: ${a}`);if(this.fields.fields.filter((l,c)=>c!==n).map(l=>l.fieldKey||Zg(l.label)).includes(r.fieldKey)){let l=new Error(`Field key '${r.fieldKey}' is already in use by another custom field`);throw Be.logError(l,Be.createContext("validate field key uniqueness")),l}}return this.fields.fields[n]={...this.fields.fields[n],...r,id:t},await this.saveFields(),this.fields.fields[n]}async removeField(t){let r=this.fields.fields.length;return this.fields.fields=this.fields.fields.filter(n=>n.id!==t),this.fields.fields.length<r?(await this.saveFields(),await this.removeAllFieldOptions(t),!0):!1}async reorderFields(t){let r=new Map(this.fields.fields.map(i=>[i.id,i])),n=[];t.forEach((i,a)=>{let o=r.get(i);o&&(n.push({...o,order:a}),r.delete(i))}),r.forEach(i=>{n.push({...i,order:n.length})}),this.fields.fields=n,await this.saveFields()}validateFieldValues(t){let r={};return this.fields.fields.forEach(n=>{let i=t[n.id],a=oI(i,n);a&&(r[n.id]=a)}),r}getFieldsByType(t){return this.getFields().filter(r=>r.type===t)}hasFields(){return this.fields.fields.length>0}async resetFields(){this.fields.fields=[],await this.saveFields()}exportFields(){return JSON.stringify(this.fields,null,2)}async importFields(t){try{let r=JSON.parse(t);if(!r.fields||!Array.isArray(r.fields))throw new Error("Invalid custom fields data format");let n=r.fields.filter(i=>{var a;return this.isValidFieldDefinition(i)?(a=i.validation)!=null&&a.pattern&&!this.validateRegexPattern(i.validation.pattern)?(console.warn(`Skipping field "${i.label}" due to invalid or dangerous regex pattern: ${i.validation.pattern}`),!1):!0:!1});n.length!==r.fields.length&&new uV.Notice(`Imported ${n.length} valid fields out of ${r.fields.length} total`),this.fields.fields=n.sort((i,a)=>i.order-a.order),await this.saveFields(),new uV.Notice(`Successfully imported ${n.length} custom fields`)}catch(r){throw Be.logError(r,Be.createContext("import custom fields")),r}}getFieldOptionsKey(){return this.namespace?`customFieldOptions_${this.namespace}`:"customFieldOptions"}loadFieldOptions(){try{let t=this.getFieldOptionsKey(),r=this.plugin;r.settings&&r.settings[t]?this.fieldOptions={...r.settings[t]}:this.fieldOptions={}}catch(t){Be.logError(t,Be.createContext("load custom field options")),this.fieldOptions={}}}async saveFieldOptions(){try{let t=this.getFieldOptionsKey(),r=this.plugin;if(r.settings)r.settings[t]={...this.fieldOptions},await r.saveSettings();else{let i={...await this.plugin.loadData()||{},[t]:this.fieldOptions};await this.plugin.saveData(i)}}catch(t){throw Be.logError(t,Be.createContext("save custom field options")),t}}getFieldOptions(t){return this.fieldOptions[t]||[]}async addFieldOption(t,r){let n=r.trim();return!n||(this.fieldOptions[t]||(this.fieldOptions[t]=[]),this.fieldOptions[t].some(a=>a.toLowerCase()===n.toLowerCase()))?!1:(this.fieldOptions[t].push(n),await this.saveFieldOptions(),!0)}async removeFieldOption(t,r){if(!this.fieldOptions[t])return!1;let n=this.fieldOptions[t].length;this.fieldOptions[t]=this.fieldOptions[t].filter(a=>a.toLowerCase()!==r.toLowerCase());let i=n!==this.fieldOptions[t].length;return i&&await this.saveFieldOptions(),i}async removeAllFieldOptions(t){this.fieldOptions[t]&&(delete this.fieldOptions[t],await this.saveFieldOptions())}getFieldsWithCustomOptions(){return this.getFields().filter(t=>(t.type==="dropdown"||t.type==="multiselect")&&t.allowCreateOptions)}}});var tr,RP,e9e,$O,w0e=F(()=>{tr=Y(Q()),RP=require("obsidian");Ns();rh();hi();_T();_t();e9e=({accountInfo:e,existingAccounts:t=[],availableAccountTypes:r=[],onLink:n,onCancel:i})=>{let a=t.length>0?"existing":"new",[o,s]=(0,tr.useState)(a),[l,c]=(0,tr.useState)(!1),[d,u]=(0,tr.useState)(""),[p,m]=(0,tr.useState)(""),[g,f]=(0,tr.useState)(r.length>0?r[0]:"demo"),[v,h]=(0,tr.useState)(!1),y=(0,tr.useMemo)(()=>t.length>0,[t]),b=x=>{s(x),c(!0),x!=="existing"&&m("")};tr.default.useEffect(()=>{r.length>0&&!r.includes(g)&&f(r[0])},[r,g]),tr.default.useEffect(()=>{l||s(y?"existing":"new")},[y,l]);let k=async()=>{var x;h(!0);try{let S="",w,C;switch(o){case"new":S=d||`Account-${e.accountId}`,C=g;break;case"existing":if(!p){new RP.Notice("Please select an existing account"),h(!1);return}w=p,S=((x=t.find(D=>D.path===p))==null?void 0:x.name)||"";break;case"default":S=`Account-${e.accountId}`,C=g;break}await n(e.accountId,S,w,C)}catch(S){console.error("Failed to link account:",S),new RP.Notice("Failed to link account: "+S.message)}finally{h(!1)}};return tr.default.createElement("div",{className:"account-link-modal"},tr.default.createElement("h3",null,"New Trading Account Detected"),tr.default.createElement("div",{className:"account-info"},tr.default.createElement("p",null,tr.default.createElement("strong",null,"Account ID:")," ",e.accountId),e.brokerName&&tr.default.createElement("p",null,tr.default.createElement("strong",null,"Broker:")," ",e.brokerName),e.firstSeen&&tr.default.createElement("p",null,tr.default.createElement("strong",null,"First Seen:")," ",zt(new Date(e.firstSeen),vn()))),tr.default.createElement("div",{className:"link-options"},tr.default.createElement("div",{className:"modal-field"},tr.default.createElement("label",{className:"section-label"},"How would you like to handle this account?"),tr.default.createElement("div",{className:"link-option-group"},tr.default.createElement("label",{className:"link-option"},tr.default.createElement("input",{type:"radio",name:"linkOption",value:"new",checked:o==="new",onChange:()=>b("new")}),tr.default.createElement("span",null,"Create new account with custom name")),o==="new"&&tr.default.createElement("div",{className:"custom-name-input"},tr.default.createElement("input",{type:"text",value:d,onChange:x=>u(x.target.value),placeholder:"e.g., FTMO Challenge",className:"modal-input"}),tr.default.createElement("div",{className:"account-type-select"},tr.default.createElement("label",{className:"field-label"},"Account Type:"),tr.default.createElement("select",{value:g,onChange:x=>f(x.target.value),className:"modal-select"},r.map(x=>tr.default.createElement("option",{key:x,value:x},x.charAt(0).toUpperCase()+x.slice(1)))))),tr.default.createElement("label",{className:"link-option"},tr.default.createElement("input",{type:"radio",name:"linkOption",value:"existing",checked:o==="existing",onChange:()=>b("existing"),disabled:!y}),tr.default.createElement("span",null,"Link to existing account ",y?"":"(no accounts available)")),o==="existing"&&y&&tr.default.createElement("div",{className:"existing-account-select"},tr.default.createElement("select",{value:p,onChange:x=>{m(x.target.value)},className:"modal-select"},tr.default.createElement("option",{value:""},"Select an account..."),t.map(x=>tr.default.createElement("option",{key:x.path,value:x.path},x.name))),t.length===0&&tr.default.createElement("div",{className:"no-accounts-message"},"No existing accounts found. Create a new account instead.")),tr.default.createElement("label",{className:"link-option"},tr.default.createElement("input",{type:"radio",name:"linkOption",value:"default",checked:o==="default",onChange:()=>b("default")}),tr.default.createElement("span",null,"Use default name: Account-",e.accountId)),o==="default"&&tr.default.createElement("div",{className:"account-type-select"},tr.default.createElement("label",{className:"field-label"},"Account Type:"),tr.default.createElement("select",{value:g,onChange:x=>f(x.target.value),className:"modal-select"},r.map(x=>tr.default.createElement("option",{key:x,value:x},x.charAt(0).toUpperCase()+x.slice(1)))))))),tr.default.createElement("div",{className:"modal-actions"},tr.default.createElement(Ie,{onClick:k,disabled:v,variant:"primary"},v?"Linking...":"Confirm"),tr.default.createElement(Ie,{onClick:i,disabled:v,variant:"secondary"},"Cancel")))},$O=class extends RP.Modal{constructor(r,n,i,a){super(r);this.existingAccounts=[];this.availableAccountTypes=[];this.root=null;this.accountInfo=n,this.onLink=i,this.onCancel=a}async onOpen(){let{contentEl:r}=this;r.empty(),await this.loadExistingAccounts(),await this.loadAvailableAccountTypes();let{injectAccountLinkModalStyles:n}=(JB(),hd(Tee));n();let i=r.createDiv(),{createRoot:a}=Ni();this.root=a(i),this.root.render(tr.default.createElement(e9e,{accountInfo:this.accountInfo,existingAccounts:this.existingAccounts,availableAccountTypes:this.availableAccountTypes,onLink:async(o,s,l,c)=>{await this.onLink(o,s,l,c),this.close()},onCancel:()=>{this.onCancel(),this.close()}}))}async loadExistingAccounts(){try{let r=Hi().plugins.plugins.journalit,n=r==null?void 0:r.accountPageService;if(!n){console.warn("AccountPageService not available for loading existing accounts"),this.existingAccounts=[];return}let i=await n.getAllEnhancedAccounts();if(!i||!Array.isArray(i)){console.warn("Invalid accounts data received:",i),this.existingAccounts=[];return}this.existingAccounts=i.map(a=>{let o=a.accountName||a.name||`Account-${a.id||"Unknown"}`;return{path:a.notePath||"",name:o}})}catch(r){console.error("Failed to load existing accounts:",r),this.existingAccounts=[]}}async loadAvailableAccountTypes(){try{let r=Hi().plugins.plugins.journalit,n=r==null?void 0:r.optionsService;if(!n){console.warn("Options service not available - using default account types"),this.availableAccountTypes=["demo","evaluation","funded"];return}let i=n.getOptions("account_type");i&&i.length>0?this.availableAccountTypes=i:(console.warn("No custom account types found. Using default account types."),this.availableAccountTypes=["demo","evaluation","funded"])}catch(r){console.error("Failed to load available account types:",r),this.availableAccountTypes=["demo","evaluation","funded"]}}onClose(){this.root&&(this.root.unmount(),this.root=null);let{contentEl:r}=this;r.empty()}}});var Pm,hk,pV=F(()=>{Pm=require("obsidian");vm();Vc();_t();Tr();hk=class{constructor(t,r,n){this.tradeSyncMapping={};this.tradeFileCache=new Map;this.csvImportIdMap={};this.cacheBuilt=!1;this.isRebuilding=!1;this.unsubscribeFolderPath=null;this.plugin=t,this.folderPathService=n,this.unsubscribeFolderPath=xe.subscribe("folder-path:changed",i=>{this.onFolderPathChanged(i)})}get settings(){return this.plugin.settings.backendIntegration||(console.error("TradeSyncService: backendIntegration is undefined, using defaults"),this.plugin.settings.backendIntegration={...Qn.backendIntegration}),this.plugin.settings.backendIntegration}async loadSyncMapping(){let t=this.settings.tradeSyncMapping;t&&(this.tradeSyncMapping=t),await this.rebuildSyncMapping()}createCacheKey(t,r,n,i){let a=Math.floor(r.getTime()/1e3);return`${encodeURIComponent(t)}|${a}|${n}|${i}`}async buildTradeFileCache(){this.tradeFileCache.clear();try{let r=this.plugin.app.vault.getMarkdownFiles().filter(a=>this.isTradeFile(a)),n=20,i=[];for(let a=0;a<r.length;a+=n)i.push(r.slice(a,a+n));for(let[a,o]of i.entries()){let s=o.map(async l=>{try{let c=await this.plugin.app.vault.read(l),d=this.parseTradeFromMarkdown(c);if(d&&d.instrument&&d.entryTime&&d.entryPrice){let u=dn(d.entryTime);if(!u){console.warn(`Invalid entry time for trade ${d.instrument}: ${d.entryTime}`);return}let p=parseFloat(d.positionSize)||0,m=this.createCacheKey(d.instrument,u,parseFloat(d.entryPrice),p);d.csvImportId&&(this.csvImportIdMap[d.csvImportId]=l.path),this.tradeFileCache.set(m,{path:l.path,metadata:d,symbol:d.instrument,entryTime:u,entryPrice:parseFloat(d.entryPrice),volume:p})}}catch(c){console.warn(`Error caching trade file ${l.path}:`,c)}});await Promise.all(s),a<i.length-1&&await new Promise(l=>setTimeout(l,10))}this.cacheBuilt=!0}catch(t){console.error("Error building trade file cache:",t),this.cacheBuilt=!1}}clearTradeFileCache(){this.tradeFileCache.clear(),this.csvImportIdMap={},this.cacheBuilt=!1}async rebuildSyncMapping(t){let r=this.plugin.app.vault.getMarkdownFiles().filter(i=>{let a=this.isTradeFile(i);return t&&!a?this.isTradeFileAtPath(i,t):a});if(r.length===0){this.tradeSyncMapping={},await this.saveSyncMapping();return}let n={};for(let i of r)try{let a=await this.plugin.app.vault.read(i),o=this.parseTradeFromMarkdown(a);o&&o.backendTradeId&&(n[o.backendTradeId]=i.path)}catch(a){console.error("Error reading trade file for sync mapping:",a)}this.tradeSyncMapping=n,await this.saveSyncMapping()}async saveSyncMapping(){let r=null;for(let n=0;n<3;n++)try{if(this.settings.tradeSyncMapping=this.tradeSyncMapping,await this.plugin.saveSettings(),this.settings.tradeSyncMapping===this.tradeSyncMapping)return!0;console.warn(`Mapping save verification failed on attempt ${n+1}`)}catch(i){r=i,console.error(`Failed to save sync mapping on attempt ${n+1}:`,i),n<2&&await new Promise(a=>setTimeout(a,100*(n+1)))}return console.error("Failed to save sync mapping after 3 attempts:",r),!1}async addMappingBatch(t){for(let{tradeId:r,filePath:n}of t)this.tradeSyncMapping[r]=n;return await this.saveSyncMapping()}async validateMappingIntegrity(){let t=0,r=[];for(let[n,i]of Object.entries(this.tradeSyncMapping))this.plugin.app.vault.getAbstractFileByPath(i)||(r.push(Number(n)),t++);if(r.length>0){console.warn(`Removing ${r.length} invalid mapping entries`);for(let n of r)delete this.tradeSyncMapping[n];await this.saveSyncMapping()}return t}async onFolderPathChanged(t){let r=t.value,n=this.folderPathService.journalFolderPath;if(this.isRebuilding){console.log("Sync mapping rebuild already in progress, skipping...");return}this.isRebuilding=!0;try{console.log(`Folder path changed from "${n}" to "${r}", rebuilding sync mapping...`);let i=new Pm.Notice("Updating trade sync mappings for new folder path...",0);await this.rebuildSyncMapping(n),i.hide(),new Pm.Notice("Trade sync mappings updated successfully",3e3),console.log("Sync mapping rebuilt successfully")}catch(i){console.error("Error rebuilding sync mapping:",i),new Pm.Notice("Failed to update trade sync mappings. Please restart the plugin.",5e3)}finally{this.isRebuilding=!1}}cleanup(){this.unsubscribeFolderPath&&(this.unsubscribeFolderPath(),this.unsubscribeFolderPath=null)}getSyncMapping(){return this.tradeSyncMapping}addMapping(t,r){this.tradeSyncMapping[t]=r}removeMapping(t){delete this.tradeSyncMapping[t]}getFilePathForTrade(t){return this.tradeSyncMapping[t]}async fetchAllTrades(t){var o;let r=[],n=0,i=100,a=!0;for(;a;){let s=Bt.buildUrl("/api/v1/trades",{limit:i,offset:n}),l=await Bt.makeRequest(s,{method:"GET"},"fetch trades");if(!l||!l.trades){console.warn("Invalid response from trades API:",l);break}Array.isArray(l.trades)&&r.push(...l.trades),a=((o=l.pagination)==null?void 0:o.has_more)||!1,n+=i}return r}isTradeFile(t){return this.folderPathService.isJournalPath(t.path)&&t.path.includes("/trades/")&&t.extension==="md"}isTradeFileAtPath(t,r){let n=t.path.toLowerCase().replace(/\\/g,"/"),i=r.toLowerCase().replace(/\\/g,"/");return(n.startsWith(i+"/")||n===i)&&t.path.includes("/trades/")&&t.extension==="md"}parseTradeFromMarkdown(t){try{let r=t.match(/^---\n([\s\S]*?)\n---/);if(!r)return null;let n=r[1],i={},a=n.split(`
`);for(let o of a){let s=o.indexOf(":");if(s===-1)continue;let l=o.substring(0,s).trim(),c=o.substring(s+1).trim();if(!(!l||!c))if(c.startsWith("[")&&c.endsWith("]")){let d=c.substring(1,c.length-1).trim();d?i[l]=d.split(",").map(u=>u.trim()):i[l]=[]}else i[l]=c}return(i.type==="trade"||i.type==="backtest-trade")&&i.instrument&&i.direction?(i.backendTradeId&&(i.backendTradeId=parseInt(i.backendTradeId)),i):null}catch(r){return console.error("Error parsing trade markdown:",r),null}}async findExistingTradeFile(t,r,n,i,a){return this.cacheBuilt?this.findExistingTradeFileFromCache(t):this.findExistingTradeFileFromDisk(t,r,n,i,a)}getCacheSize(){return this.tradeFileCache.size}async findExistingTradeFileFromCache(t){if(t.csvImportId&&this.csvImportIdMap[t.csvImportId])return this.csvImportIdMap[t.csvImportId];let r=this.getFilePathForTrade(t.id);if(r){let l=this.plugin.app.vault.getAbstractFileByPath(r);if(l instanceof Pm.TFile)return l.path;this.removeMapping(t.id)}if(t.id){let l=await this.findTradeFileByBackendId(t.id);if(l)return l}let n=dn(t.entry_time);if(!n)return console.warn(`Invalid entry time for trade ${t.symbol}: ${t.entry_time}`),null;let i=this.createCacheKey(t.symbol,n,t.entry_price,t.volume),a=this.tradeFileCache.get(i);if(a)return a.path;let o=6e4,s=1e-5;for(let[l,c]of this.tradeFileCache.entries())if(c.symbol===t.symbol&&Math.abs(c.volume-t.volume)<.001){let d=Zi(c.entryTime),u=Zi(n);if(d===null||u===null)continue;let p=Math.abs(d-u),m=Math.abs(c.entryPrice-t.entry_price);if(p<o&&m<s)return c.path}return null}async findTradeFileByBackendId(t){var r;if(!t)return null;try{let i=this.plugin.app.vault.getMarkdownFiles().filter(a=>this.isTradeFile(a));for(let a of i){let o=(r=this.plugin.app.metadataCache.getFileCache(a))==null?void 0:r.frontmatter;if((o==null?void 0:o.backendTradeId)===t)return console.log(`Found trade via frontmatter scan: ${t} -> ${a.path}`),this.addMapping(t,a.path),await this.saveSyncMapping()||console.warn(`Failed to save rebuilt mapping for trade ${t}`),a.path}return null}catch(n){return console.error(`Error scanning frontmatter for trade ${t}:`,n),null}}async findExistingTradeFileFromDisk(t,r,n,i,a){let o=this.folderPathService.getDatePath(String(n),i,`W${a}`,"trades"),s=this.plugin.app.vault.getAbstractFileByPath(o);if(s&&s instanceof Pm.TFolder){let l=`${t.symbol}-${r}-T`,c=this.getFilePathForTrade(t.id);if(c){let m=this.plugin.app.vault.getAbstractFileByPath(c);if(m instanceof Pm.TFile)return m.path;this.removeMapping(t.id)}let d=s.children.filter(m=>m instanceof Pm.TFile&&m.name.startsWith(l));if(d.length===0)return null;let u=d.map(async m=>{try{let g=await this.plugin.app.vault.read(m),f=this.parseTradeFromMarkdown(g);if(f){if(f.backendTradeId&&f.backendTradeId===t.id)return m.path;let v=dn(f.entryTime),h=dn(t.entry_time);if(!v||!h)return null;let y=Math.abs(v.getTime()-h.getTime()),b=Math.abs(parseFloat(f.entryPrice)-t.entry_price)<1e-5,k=f.instrument===t.symbol;if(y<6e4&&b&&k)return m.path}}catch(g){console.warn(`Error checking trade file ${m.path}:`,g)}return null});return(await Promise.all(u)).find(m=>m!==null)||null}return null}}});var RO,k0e=F(()=>{vm();Vc();RO=class{get settings(){return this.plugin.settings.backendIntegration||(console.error("AccountManagementService: backendIntegration is undefined, using defaults"),this.plugin.settings.backendIntegration={...Qn.backendIntegration}),this.plugin.settings.backendIntegration}constructor(t,r){this.plugin=t}getAccountDisplayName(t){return this.settings.accountMapping&&this.settings.accountMapping[t]?this.settings.accountMapping[t]:`Account-${t}`}async createAccountMapping(t,r){this.settings.accountMapping||(this.settings.accountMapping={}),this.settings.accountMapping[t]=r,await this.plugin.saveSettings()}async updateAccountMappings(t){this.settings.accountMapping||(this.settings.accountMapping={});let r=!1;for(let n of t)n.displayName&&(!this.settings.accountMapping[n.accountId]||this.settings.accountMapping[n.accountId]!==n.displayName)&&(this.settings.accountMapping[n.accountId]=n.displayName,r=!0);r&&await this.plugin.saveSettings()}async fetchUserAccounts(){try{let t=Bt.buildUrl("/api/v1/mt-accounts"),r=await Bt.makeRequest(t,{method:"GET"},"fetch user accounts");if(!r)return[];let i=(r.accounts||[]).map(a=>({accountId:a.accountId||a.account_id||a.mt_account_id||"",displayName:a.displayName||a.display_name||`Account-${a.account_id||a.mt_account_id||"Unknown"}`,brokerName:a.brokerName||a.broker_name,firstSeen:a.firstSeen||a.first_seen,lastSeen:a.lastSeen||a.last_seen}));return i.length>0,i}catch(t){throw console.error("\u274C Failed to fetch MT accounts:",t instanceof Error?t.message:String(t)),new Error(`Failed to fetch MT accounts: ${t instanceof Error?t.message:String(t)}`)}}async updateAccountDisplayName(t,r,n){try{let i=Bt.buildUrl(`/api/v1/mt-accounts/${encodeURIComponent(t)}`);return await Bt.makeRequest(i,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({display_name:r})},"update account display name"),await this.createAccountMapping(t,r),!0}catch(i){throw console.error("Failed to update account display name:",i),i}}async getAccountTrades(t,r,n=100,i=0){try{let a=Bt.buildUrl(`/api/v1/mt-accounts/${encodeURIComponent(t)}/trades`,{limit:n,offset:i}),o=await Bt.makeRequest(a,{method:"GET"},"fetch account trades");return o?o.trades||[]:[]}catch(a){throw console.error("Failed to fetch account trades:",a),a}}checkForNewAccounts(t){let r=[];for(let n of t)(!this.settings.accountMapping||!this.settings.accountMapping[n])&&r.push(n);return r}}});var UO,S0e=F(()=>{vm();Vc();Bu();UO=class{get settings(){return this.plugin.settings.backendIntegration||(console.error("FTPManagementService: backendIntegration is undefined, using defaults"),this.plugin.settings.backendIntegration={...Qn.backendIntegration}),this.plugin.settings.backendIntegration}constructor(t,r){this.plugin=t}async getFTPCredentials(t){var r;try{let n=(r=this.plugin.authManager.getAuthState().token)==null?void 0:r.access_token,i={};n&&(i.Authorization=`Bearer ${n}`);let a=Bt.buildUrl(`/api/v1/ftp-users/${t}`),o=await Bt.makeRequest(a,{method:"GET",headers:i},"get FTP credentials");return o?{user_id:o.user_id,username:o.username,server:o.server||"sync.journalit.co",port:o.port||2121,lastPasswordReset:o.last_password_reset}:null}catch(n){if(this.settings.ftpUsername)return console.warn("FTP credentials not found for specific username:",t),null;if(n instanceof Error&&n.message.includes("404"))return await this.createFTPUser(t);let i={operation:"get FTP credentials",endpoint:`/api/v1/ftp-users/${t}`,statusCode:Be.extractStatusCode(n)};throw Be.logError(n,i),n}}async createOrGetFTPUser(){var t;try{let r=(t=this.plugin.authManager.getAuthState().token)==null?void 0:t.access_token,n={"Content-Type":"application/json"};r&&(n.Authorization=`Bearer ${r}`);let i=Bt.buildUrl("/api/v1/ftp-users/auto-create"),a=await Bt.makeRequest(i,{method:"POST",headers:n,body:JSON.stringify({username:`journalit${Date.now()}${Math.floor(Math.random()*1e3)}`})},"create or get FTP user");if(!a)return null;let o={user_id:a.user_id,username:a.username,password:a.password,server:a.server||"sync.journalit.co",port:a.port||2121,lastPasswordReset:a.last_password_reset||new Date().toISOString()};return a.user_id&&this.settings&&(this.settings.ftpUserId=a.user_id,await this.plugin.saveSettings()),o}catch(r){let n={operation:"create or get FTP user",endpoint:"/api/v1/ftp-users/auto-create",statusCode:Be.extractStatusCode(r)};throw Be.logError(r,n),r}}async autoCreateFTPCredentials(t){var r;try{let n=(r=this.plugin.authManager.getAuthState().token)==null?void 0:r.access_token,i={"Content-Type":"application/json"};n&&(i.Authorization=`Bearer ${n}`);let a=Bt.buildUrl("/api/v1/ftp-users/auto-create"),o=await Bt.makeRequest(a,{method:"POST",headers:i,body:JSON.stringify({username:t})},"auto-create FTP user");return o?{username:o.username,password:o.password,server:o.server||"sync.journalit.co",port:o.port||2121,lastPasswordReset:new Date().toISOString()}:null}catch(n){let i={operation:"auto-create FTP user",endpoint:"/api/v1/ftp-users/auto-create",statusCode:Be.extractStatusCode(n)};throw Be.logError(n,i),n}}async createFTPUser(t){var r;try{let n=await this.getFTPUserAccountId();if(!n){let l={operation:"determine account ID for FTP user creation",endpoint:"/api/v1/mt-accounts"};throw Be.logError(new Error("Could not determine account ID for FTP user creation"),l),new Error("Could not determine account ID for FTP user creation")}let i=(r=this.plugin.authManager.getAuthState().token)==null?void 0:r.access_token,a={"Content-Type":"application/json"};i&&(a.Authorization=`Bearer ${i}`);let o=Bt.buildUrl("/api/v1/ftp-users/create"),s=await Bt.makeRequest(o,{method:"POST",headers:a,body:JSON.stringify({user_id:n})},"create FTP user");return s?{username:s.username,password:s.password,server:s.server||"sync.journalit.co",port:s.port||2121,lastPasswordReset:new Date().toISOString()}:null}catch(n){let i={operation:"create FTP user",endpoint:"/api/v1/ftp-users",statusCode:Be.extractStatusCode(n)};throw Be.logError(n,i),n}}async resetFTPPassword(t){var r;try{let n=this.settings.ftpUsername||t,i=this.settings.ftpUserId;if(!i&&n){let c=await this.getFTPCredentials(n);c&&c.user_id&&(i=c.user_id,this.settings.ftpUserId=i,await this.plugin.saveSettings())}if(!i){let c={operation:"determine FTP user ID",endpoint:`/api/v1/ftp-users/${n}`};throw Be.logError(new Error("Could not find FTP user. Please try creating new credentials."),c),new Error("Could not find FTP user. Please try creating new credentials.")}let a=(r=this.plugin.authManager.getAuthState().token)==null?void 0:r.access_token,o={"Content-Type":"application/json"};a&&(o.Authorization=`Bearer ${a}`);let s=Bt.buildUrl(`/api/v1/ftp-users/${i}/password`),l=await Bt.makeRequest(s,{method:"PUT",headers:o},"reset FTP password");return l?{user_id:i,username:n,password:l.password,server:"sync.journalit.co",port:2121,lastPasswordReset:new Date().toISOString()}:null}catch(n){let a={operation:"reset FTP password",endpoint:`/api/v1/ftp-users/${this.settings.ftpUserId||t}/reset-password`,statusCode:Be.extractStatusCode(n)};throw Be.logError(n,a),n}}async getFTPUserAccountId(){if(this.settings.ftpUserId)return this.settings.ftpUserId;let t=this.settings.ftpUsername;if(t){let n=await this.getFTPCredentials(t);if(n&&n.user_id)return this.settings.ftpUserId=n.user_id,await this.plugin.saveSettings(),n.user_id}let r={operation:"determine FTP user account ID",endpoint:"/api/v1/mt-accounts"};return Be.logError(new Error(`Could not determine FTP user account ID. FTP username: ${t}`),r),null}}});var T0e,vk,mV=F(()=>{T0e=require("obsidian");ds();qt();xy();vk=class{constructor(t,r,n){this.accountCache=new Map;this.accountCacheTime=0;this.CACHE_TTL=300*1e3;this.plugin=t,this.folderPathService=n}generateTradeFilePath(t){let r=new Date(t.entry_time),n=r.getFullYear(),i=String(r.getMonth()+1).padStart(2,"0"),a=this.getWeekNumber(r),o=this.formatDateForUser(r),s=this.getNextTradeNumber(t.symbol,o,n,i,a);return this.folderPathService.getDatePath(String(n),i,`W${a}`,"trades",`${t.symbol}-${o}-T${s}.md`)}getNextTradeNumber(t,r,n,i,a){let o=this.folderPathService.getDatePath(String(n),i,`W${a}`,"trades"),s=this.plugin.app.vault.getAbstractFileByPath(o),l=0;if(s&&s instanceof T0e.TFolder){let c=`${t}-${r}-T`;for(let d of s.children)if(d.name.startsWith(c)&&d.name.endsWith(".md")){let u=d.name.match(/T(\d+)\.md$/);if(u){let p=parseInt(u[1]);p>l&&(l=p)}}}return l+1}async createTradeFileAtomic(t,r){var u;let n=new Date(t.entry_time),i=n.getFullYear(),a=String(n.getMonth()+1).padStart(2,"0"),o=this.getWeekNumber(n),s=this.formatDateForUser(n),l=this.folderPathService.getDatePath(String(i),a,`W${o}`,"trades");await this.ensureDirectoryExists(l);let c=3,d=null;for(let p=0;p<c;p++){let m=null;try{let g=gc().split("-")[0],f=`${t.symbol}-${s}-temp-${g}.md`,v=`${l}/${f}`;m=await this.plugin.app.vault.create(v,r);let h=this.getNextTradeNumber(t.symbol,s,i,a,o),y=`${t.symbol}-${s}-T${h}.md`,b=`${l}/${y}`;if(this.plugin.app.vault.getAbstractFileByPath(b)){console.warn(`Trade file collision detected on attempt ${p+1}: ${b}`),await new Promise(x=>setTimeout(x,50*(p+1)));continue}return await this.plugin.app.vault.rename(m,b),m=null,b}catch(g){if(d=g,(u=g.message)!=null&&u.includes("already exists")){console.warn(`Temp file collision on attempt ${p+1}, retrying...`),await new Promise(f=>setTimeout(f,50*(p+1)));continue}throw g}finally{if(m)try{await this.plugin.app.vault.delete(m)}catch(g){g&&typeof g=="object"&&"code"in g&&g.code!=="ENOENT"&&console.warn(`Failed to cleanup temp file ${m.path}:`,g)}}}throw new Error(`Failed to create trade file after ${c} attempts: ${(d==null?void 0:d.message)||"unknown error"}`)}clearAccountCache(){this.accountCache.clear(),this.accountCacheTime=0}async refreshAccountCache(){let t=Date.now();if(!(this.accountCacheTime>0&&t-this.accountCacheTime<this.CACHE_TTL))try{this.accountCache.clear();let r=this.plugin.settings.backendIntegration;if(r!=null&&r.accountMapping)for(let[i,a]of Object.entries(r.accountMapping))this.accountCache.set(i,a);let n=this.plugin.accountPageService;if(n)try{let i=await n.getAllEnhancedAccounts();for(let a of i){let o=a.accountName||a.name||a.id;if(a.id&&!this.accountCache.has(a.id)&&this.accountCache.set(a.id,o),o.includes("Account-")){let s=o.replace("Account-","");/^\d+$/.test(s)&&!this.accountCache.has(s)&&this.accountCache.set(s,o)}}}catch(i){console.warn("Error loading accounts from AccountPageService:",i)}this.accountCacheTime=t}catch(r){console.error("Error refreshing account cache:",r)}}async resolveAccountDisplayName(t,r){try{await this.refreshAccountCache();let n=this.accountCache.get(t);if(n)return n;let i=r||`Account-${t}`;return this.accountCache.has(`_notfound_${t}`)||this.accountCache.set(`_notfound_${t}`,i),i}catch(n){return console.error("Error resolving account display name:",n),r||`Account-${t}`}}async generateTradeMarkdown(t,r){var d;let n=new Date(t.entry_time),i=t.exit_time?new Date(t.exit_time):null,a=t.direction.toUpperCase()==="BUY"?"long":"short";console.log("[TradeFileGenerator] trade.assetType:",t.assetType,"symbol:",t.symbol);let o=t.assetType||this.determineAssetType(t.symbol);console.log("[TradeFileGenerator] Final assetType used:",o);let s={type:"trade",...t.id&&t.id!==0&&{backendTradeId:t.id},tradeStatus:t.exit_time?"CLOSED":"OPEN",entryTime:this.formatDateForFrontmatter(t.entry_time),...t.csvImportId&&{csvImportId:t.csvImportId},entryPrice:t.entry_price,positionSize:t.volume,direction:a,instrument:t.symbol,assetType:o};try{let u=this.plugin.optionsService||new Go(this.plugin);u.getInstrumentsForAssetType(o).includes(t.symbol)||await u.addOption("instrument",t.symbol,o)}catch(u){console.error(`Failed to add instrument '${t.symbol}' to options:`,u)}if(t.status==="CLOSED"&&t.exit_time&&t.exit_price&&(s.exitTime=this.formatDateForFrontmatter(t.exit_time),s.exitPrice=t.exit_price,t.profit_loss!==void 0&&t.profit_loss!==null&&(s.pnl=t.profit_loss)),t.currency&&(s.currency=t.currency),t.entries&&t.entries.length>0?s.entries=t.entries.map(u=>({time:this.formatDateForFrontmatter(u.time),price:u.price,size:u.size})):s.entries=[{time:this.formatDateForFrontmatter(t.entry_time),price:t.entry_price,size:t.volume}],t.status==="CLOSED"&&t.exit_time&&t.exit_price&&(t.exits&&t.exits.length>0?s.exits=t.exits.map(u=>({time:this.formatDateForFrontmatter(u.time),price:u.price,size:u.size})):s.exits=[{time:this.formatDateForFrontmatter(t.exit_time),price:t.exit_price,size:t.volume}]),t.commission!==void 0&&t.commission!==null?s.commission=t.commission:s.commission=0,s.commissionType="fixed",t.swap!==void 0&&t.swap!==null?s.swap=t.swap:s.swap=0,t.fees!==void 0&&t.fees!==null?s.fees=t.fees:s.fees=0,s.useDirectPnLInput=!1,s.setupIds=[],s.mistakeIds=[],t.mt_account_number){s.accountId=t.mt_account_number;let u=await this.resolveAccountDisplayName(t.mt_account_number,r||t.mt_account_display_name);s.account=[u],s.accountIds=[u]}else{let u=r||t.mt_account_display_name||"Unknown Account";s.accountIds=[u],s.account=[u]}s.setup=[],s.mistake=[],s.images=[],s.tags=[],s.thesis="",o==="options"&&(s.contractSize=t.contractSize||100,t.strikePrice&&(s.strikePrice=t.strikePrice),t.expirationDate&&(s.expirationDate=this.formatDateForFrontmatter(t.expirationDate)),t.optionType&&(s.optionType=t.optionType)),o==="futures"&&t.dollarPerPoint&&(s.dollarPerPoint=t.dollarPerPoint);let l=`---
`;for(let[u,p]of Object.entries(s))if(p!=null)if(Array.isArray(p))if(p.length===0)l+=`${u}: []
`;else if(u==="entries"||u==="exits"){l+=`${u}:
`;for(let m of p)l+=`  - time: ${m.time}
`,l+=`    price: ${m.price}
`,l+=`    size: ${m.size}
`}else u==="images"?l+=`${u}: [${p.map(m=>`"${m}"`).join(", ")}]
`:l+=`${u}: [${p.map(m=>`${m}`).join(", ")}]
`;else p===""?l+=`${u}: ""
`:l+=`${u}: ${p}
`;l+=`---

`;let c=`# ${t.symbol} - ${t.direction.toUpperCase()}

`;if(c+=`Entry: ${t.entry_price} at ${n.toLocaleString()}
`,i){if(c+=`Exit: ${t.exit_price} at ${i.toLocaleString()}
`,t.profit_loss!==void 0&&t.profit_loss!==null){let u=this.plugin.settings.trade.displayRMultiples||!1,p=this.plugin.settings.trade.defaultRiskAmount||0,m;p>0&&t.profit_loss!==0&&(m=t.profit_loss/p);let g=(d=this.plugin.settings.general)==null?void 0:d.currency;if(t.profit_loss>0){let f=ye(t.profit_loss,!0,g,u,m);c+=`\u2705 Profit: ${f}
`}else if(t.profit_loss<0){let f=ye(t.profit_loss,!0,g,u,m);c+=`\u274C Loss: ${f}
`}}}else c+=`Status: Open
`;return l+c}formatDateForFrontmatter(t){return(typeof t=="string"?new Date(t):t).toISOString().split(".")[0]}formatDateForUser(t){let r=this.plugin.settings.trade.dateFormat,n=String(t.getDate()).padStart(2,"0"),i=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getFullYear()).slice(-2);switch(r){case"DDMMYY":return`${n}${i}${a}`;case"MMDDYY":return`${i}${n}${a}`;default:return`${a}${i}${n}`}}getWeekNumber(t){let r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())),n=r.getUTCDay()||7;r.setUTCDate(r.getUTCDate()+4-n);let i=new Date(Date.UTC(r.getUTCFullYear(),0,1));return Math.ceil(((r.getTime()-i.getTime())/864e5+1)/7)}async ensureDirectoryExists(t){var i;let r=t.split("/"),n="";for(let a of r)if(a&&(n+=(n?"/":"")+a,!this.plugin.app.vault.getAbstractFileByPath(n)))try{await this.plugin.app.vault.createFolder(n)}catch(o){if(!((i=o.message)!=null&&i.includes("already exists")))throw o}}determineAssetType(t){let r=t.toUpperCase();return r.includes("/")||r.length===6&&this.isForexCurrency(r.substring(0,3))&&this.isForexCurrency(r.substring(3,6))?"forex":r.endsWith("USDT")||r.endsWith("BTC")||r.endsWith("ETH")||r.includes("CRYPTO")?"crypto":/[0-9]/.test(r)&&(r.startsWith("ES")||r.startsWith("NQ")||r.startsWith("CL")||r.startsWith("GC"))?"futures":"stock"}isForexCurrency(t){return["EUR","USD","GBP","JPY","CHF","CAD","AUD","NZD"].includes(t)}}});var Yb,HO,C0e=F(()=>{Yb=require("obsidian");Vc();HO=class{constructor(t,r,n){this.lastProcessedFiles=new Set;this.MAX_TRACKED_FILES=1e3;this.MAX_FILE_AGE_MS=1440*60*1e3;this.fileProcessTimestamps=new Map;this.batchModifiedFiles=new Set;this.plugin=t,this.tradeSyncService=n}get settings(){return this.plugin.settings.backendIntegration||(console.error("FileWatcherService: backendIntegration is undefined, using defaults"),this.plugin.settings.backendIntegration={...Qn.backendIntegration}),this.plugin.settings.backendIntegration}setupFileWatcher(){this.plugin.registerEvent(this.plugin.app.vault.on("create",t=>{t instanceof Yb.TFile&&this.tradeSyncService.isTradeFile(t)&&this.processNewTradeFile(t)})),this.plugin.registerEvent(this.plugin.app.vault.on("modify",t=>{t instanceof Yb.TFile&&this.tradeSyncService.isTradeFile(t)&&!this.lastProcessedFiles.has(t.path)&&!this.batchModifiedFiles.has(t.path)&&this.processNewTradeFile(t)})),this.plugin.registerEvent(this.plugin.app.vault.on("delete",t=>{t instanceof Yb.TFile&&this.removeFileFromTracking(t.path)})),this.plugin.registerEvent(this.plugin.app.vault.on("rename",(t,r)=>{t instanceof Yb.TFile&&(this.removeFileFromTracking(r),this.tradeSyncService.isTradeFile(t)&&this.processNewTradeFile(t))})),this.startPeriodicCleanup()}async processNewTradeFile(t){var r,n;try{if((n=(r=this.plugin.tradeService)==null?void 0:r.recentlyCreatedFiles)!=null&&n.has(t.path))return;let i=await this.plugin.app.vault.read(t),a=this.tradeSyncService.parseTradeFromMarkdown(i);if(a){this.addFileToTracking(t.path);let o=a.backendTradeId!==void 0;if(!o&&a.pnl&&(a.account||a.accountIds)&&this.plugin.accountPageService)try{let s=a.account||a.accountIds;Array.isArray(s)||(s=s?[s]:[]);for(let l of s)l&&typeof l=="string"&&l.trim()&&await this.plugin.accountPageService.refreshAccountData(l.trim())}catch(s){console.error("Error refreshing account data from manual trade:",s)}this.settings.showNewTradeNotifications&&a.instrument&&a.direction&&!o&&new Yb.Notice(`\u{1F4C8} New trade created: ${a.instrument} ${a.direction}`),this.plugin.app.workspace.trigger("journalit:trade-file-added",a)}}catch(i){console.error("Error processing new trade file:",i)}}async checkForNewTradeFiles(){let t=this.plugin.app.vault.getMarkdownFiles().filter(r=>this.tradeSyncService.isTradeFile(r));for(let r of t)this.lastProcessedFiles.has(r.path)||await this.processNewTradeFile(r)}addFileToTracking(t){this.lastProcessedFiles.add(t),this.fileProcessTimestamps.set(t,Date.now()),this.lastProcessedFiles.size>this.MAX_TRACKED_FILES&&this.performCleanup()}removeFileFromTracking(t){this.lastProcessedFiles.delete(t),this.fileProcessTimestamps.delete(t)}startPeriodicCleanup(){this.plugin.registerInterval(window.setInterval(()=>{this.performCleanup()},36e5))}performCleanup(){let t=Date.now(),r=[];for(let[n,i]of this.fileProcessTimestamps){if(t-i>this.MAX_FILE_AGE_MS){r.push(n);continue}this.plugin.app.vault.getAbstractFileByPath(n)||r.push(n)}for(let n of r)this.removeFileFromTracking(n);if(this.lastProcessedFiles.size>this.MAX_TRACKED_FILES){let n=Array.from(this.fileProcessTimestamps.entries()).sort((a,o)=>a[1]-o[1]),i=this.lastProcessedFiles.size-Math.floor(this.MAX_TRACKED_FILES*.8);for(let a=0;a<i&&a<n.length;a++)this.removeFileFromTracking(n[a][0])}r.length>0||this.lastProcessedFiles.size>this.MAX_TRACKED_FILES}clearProcessedFiles(){this.lastProcessedFiles.clear(),this.fileProcessTimestamps.clear()}}});var UP,pv,qO=F(()=>{UP=require("obsidian");Tr();_t();pv=class{constructor(t,r){this._callbacks=new Set;this.app=t,this.plugin=r,this._currentPath=this.getConfiguredPath(),this.unsubscribeSettings=xe.subscribe("settings:changed",n=>{this.onSettingsUpdated(n)})}get journalFolderPath(){return this._currentPath}getConfiguredPath(){var r;let t=(r=this.plugin.settings.general)==null?void 0:r.journalFolderPath;return!t||t.trim()===""?"!Journalit":(0,UP.normalizePath)(t.trim())}async updatePath(t){let r=(0,UP.normalizePath)(t.trim());if(!this.isValidPath(r))throw new Error(`Invalid folder path: ${r}`);this.plugin.settings.general.journalFolderPath=r,await this.plugin.saveSettings();let n=this._currentPath;this._currentPath=r,this.notifyPathChange(r),xe.publish("folder-path:changed",{type:"changed",value:r})}getPath(...t){let r=[this._currentPath,...t].join("/");return(0,UP.normalizePath)(r)}getDatePath(t,r,n,...i){return this.getPath(t,r,n,...i)}getDatePathWithQuarter(t,r,n,i,...a){return this.getPath(t,r,n,i,...a)}async getDatePathForQuarter(t,r,n,i,...a){let o=zu(r);return this.getDatePathWithQuarter(t,o,n,i,...a)}getDatePathForQuarterSync(t,r,n,i,...a){let o=zu(r);return this.getDatePathWithQuarter(t,o,n,i,...a)}getQuarterlyReviewPathSync(t,r){let n=zu(r),i=`${n}-Review.md`;return this.getPath(t.toString(),n,i)}getMonthlyReviewPathForQuarterSync(t,r){let n=Oi(r),i=r.toString().padStart(2,"0"),a=zu(n),o=`${i}-Review.md`;return this.getPath(t.toString(),a,i,o)}async getQuarterlyReviewPath(t,r){let n=zu(r),i=`${n}-Review.md`;return this.getPath(t.toString(),n,i)}getYearlyReviewPath(t){let r=`${t}-Review.md`;return this.getPath(t.toString(),r)}isJournalPath(t){let r=(0,UP.normalizePath)(t),n=this._currentPath;return r.includes("-backup-")?!1:r.startsWith(n+"/")||r===n}onPathChange(t){return this._callbacks.add(t),()=>{this._callbacks.delete(t)}}isValidPath(t){return!t||t.trim()===""?!0:!(t.includes("..")||/[<>:"|?*]/.test(t))}async onSettingsUpdated(t){if((t==null?void 0:t.source)==="user-input")return;let r=this.getConfiguredPath();if(r!==this._currentPath){let n=this._currentPath;this._currentPath=r,this.notifyPathChange(r),xe.publish("folder-path:changed",{type:"changed",value:r})}}notifyPathChange(t){this._callbacks.forEach(r=>{try{r(t)}catch(n){console.error("[FolderPathService] Error in path change callback:",n)}})}async ensureJournalFolderExists(){let t=this._currentPath;this.app.vault.getAbstractFileByPath(t)||await this.app.vault.createFolder(t)}getLegacyPath(){return"!Journalit"}isLegacyPath(){return this._currentPath===this.getLegacyPath()}cleanup(){var t;(t=this.unsubscribeSettings)==null||t.call(this),this._callbacks.clear()}}});var Sa,fV,HP,P0e=F(()=>{Sa=require("obsidian");Vc();Ns();ds();w0e();vm();pV();k0e();S0e();mV();C0e();sy();Nl();qO();Bu();_t();qt();As();aq();Op();fV=60,HP=class{constructor(t){this.syncIntervalId=null;this.syncMutex=new Qw;this.syncCancelled=!1;this.totalTradesToSync=0;this.tradesProcessedSoFar=0;this.autoContinueTimeoutId=null;var r;this.plugin=t,this.folderPathService=((r=t.serviceManager)==null?void 0:r.getFolderPathService())||new pv(t.app,t),this.tradeSyncService=new hk(t,this.settings,this.folderPathService),this.accountManagementService=new RO(t,this.settings),this.ftpManagementService=new UO(t,this.settings),this.tradeFileGenerator=new vk(t,this.settings,this.folderPathService),this.fileWatcherService=new HO(t,this.settings,this.tradeSyncService),this.tradeSyncService.loadSyncMapping(),this.fileWatcherService.setupFileWatcher(),this.debouncedForceSync=oy(this.forceSync.bind(this),5e3),this.debouncedCheckForNewTrades=oy(this.checkForNewTrades.bind(this),3e4),this.settings.syncEnabled&&fV>0&&this.startAutoSync()}get settings(){return this.plugin.settings.backendIntegration||(console.error("BackendIntegrationService: backendIntegration is undefined, using defaults"),this.plugin.settings.backendIntegration={...Qn.backendIntegration}),this.plugin.settings.backendIntegration}getIsSyncing(){return this.syncMutex.isLocked()}getUserId(){try{let t=this.plugin.app.vault.getName();if(t&&t!=="Obsidian Vault")return t.toLowerCase().replace(/[^a-z0-9]/g,"");let r=this.plugin.app.vault.adapter,n="";return Sa.Platform.isDesktopApp&&r instanceof Sa.FileSystemAdapter&&(n=r.getBasePath()),n?(n.split(/[/\\]/).pop()||"unknown").toLowerCase().replace(/[^a-z0-9]/g,""):`anon_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}catch(t){let r=`anon_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return this.settings.userId||r}}async getVaultIdentifier(){var t;try{let r=(t=this.plugin.settings.backendIntegration)==null?void 0:t.vaultIdentifier;if(r)return r;let n=this.plugin.app.vault.getName()||"Unknown",i=navigator.userAgent.split(" ")[0]||"Unknown",a=n+":"+i,s=`vault_${(await this.hashIdentifier(a)).substring(0,16)}`;return this.settings.vaultIdentifier=s,await this.plugin.saveSettings(),s}catch(r){return console.warn("Could not generate vault identifier:",r),`vault_${Math.random().toString(36).substring(2,18)}`}}async hashIdentifier(t){let n=new TextEncoder().encode(t),i=await window.crypto.subtle.digest("SHA-256",n),a=new Uint8Array(i);return Array.from(a).map(o=>o.toString(16).padStart(2,"0")).join("")}async registerVault(){var c;let t=(c=this.plugin.authManager.getAuthState().token)==null?void 0:c.access_token;if(!t)return!1;let r=t,n=this.settings.ftpUsername||this.getUserId(),i=await this.getVaultIdentifier(),a={vault_path:i,user_id:n,settings:{date_format:this.plugin.settings.trade.dateFormat,enabled:this.settings.syncEnabled}},o={"Content-Type":"application/json"};r&&(o.Authorization=`Bearer ${r}`);let s=Bt.buildUrl("/api/v1/obsidian/register-vault");return await Bt.makeRequest(s,{method:"POST",headers:o,body:JSON.stringify(a)},"vault registration")?(this.settings.userId=n,this.settings.vaultPath=i,await this.plugin.saveSettings(),this.settings.showSyncNotifications&&new Sa.Notice("\u2705 Vault registered with trading server"),!0):!1}cancelSync(){this.syncMutex.isLocked()&&!this.syncCancelled&&(this.syncCancelled=!0,this.autoContinueTimeoutId!==null&&(clearTimeout(this.autoContinueTimeoutId),this.autoContinueTimeoutId=null),this.settings.showSyncNotifications&&new Sa.Notice("\u23F9\uFE0F Sync cancelled"))}async forceSync(t=!1){var r,n,i;if(!this.plugin.authManager.isAuthenticated())return console.warn("Sync skipped: User not authenticated"),Be.showError(new Error("Authentication required"),Be.createContext("sync",void 0,401)),null;if(!t){if(!this.syncMutex.tryLock())return new Sa.Notice("\u26A0\uFE0F Sync already in progress"),null;this.totalTradesToSync=0,this.tradesProcessedSoFar=0,this.syncCancelled=!1}try{if(!t)try{let w=(r=this.plugin.authManager.getAuthState().token)==null?void 0:r.access_token,C={};w&&(C.Authorization=`Bearer ${w}`);let D=Bt.buildUrl("/api/v1/sync/ftp"),P=await Bt.makeRequest(D,{method:"POST",headers:C},"FTP sync trigger");P!=null&&P.success||console.warn("FTP sync failed:",P==null?void 0:P.error)}catch(w){console.warn("Failed to trigger FTP sync:",w)}let a=await this.getFTPUserAccountId();if(!a)return new Sa.Notice("\u274C Failed to get account information"),t||this.syncMutex.unlock(),null;let o=await this.tradeSyncService.fetchAllTrades(a),s=[],l=100;for(let w=0;w<o.length;w+=l){let C=o.slice(w,w+l),D=[];for(let P of C){let M=this.tradeSyncService.getFilePathForTrade(P.id);if(M){let z=this.plugin.app.vault.getAbstractFileByPath(M);if(!z){D.push(P);continue}if(!(z instanceof Sa.TFile)){D.push(P);continue}try{let A=(n=this.plugin.app.metadataCache.getFileCache(z))==null?void 0:n.frontmatter;if(A){let L=!dn(A.exitTime),E=P.status==="CLOSED"&&P.exit_time;if(L&&E){D.push(P);continue}}}catch(A){console.warn(`Error checking trade ${P.id} for updates:`,A)}continue}D.push(P)}s.push(...D),w+l<o.length&&await new Promise(P=>setTimeout(P,0))}this.totalTradesToSync===0&&(this.totalTradesToSync=s.length);let c=500,d=s.length>c?s.slice(0,c):s,u=s.length>c;if(u){let w=s.length-c;if(this.settings.showSyncNotifications){let C=Math.round(this.tradesProcessedSoFar/this.totalTradesToSync*100);new Sa.Notice(`\u23F3 Syncing batch: ${c} trades (${C}% complete, ${w} remaining)`)}}else s.length===0&&o.length>0&&this.settings.showSyncNotifications&&new Sa.Notice(`\u2705 All ${o.length} trades are already synced`);await this.tradeSyncService.buildTradeFileCache();let p=[];if(this.syncCancelled)return t||this.syncMutex.unlock(),null;let m=new Set;for(let w of d)w.mt_account_number&&typeof w.mt_account_number=="string"&&m.add(w.mt_account_number);let g=this.accountManagementService.checkForNewAccounts(m);if(g.length>0)for(let w of g){let C=d.find(A=>A.mt_account_number===w),D=(C==null?void 0:C.mt_account_display_name)||`Account-${w}`,P={accountId:w,displayName:D,brokerName:"MetaTrader",firstSeen:(C==null?void 0:C.entry_time)||new Date().toISOString()},M=await new Promise(A=>{new $O(this.plugin.app,P,async(L,E,T,$)=>{A(T?{action:"link",linkToPath:T}:E&&E!==D?{action:"create",displayName:E,accountType:$}:{action:"default",accountType:$})},()=>{A({action:"cancel"})}).open()});if(M.action==="cancel")continue;let z=D;if(M.action==="link"&&M.linkToPath){await this.accountManagementService.createAccountMapping(w,M.linkToPath);continue}else M.action==="create"&&M.displayName&&(z=M.displayName);if(await this.accountManagementService.createAccountMapping(w,z),this.plugin.accountPageService)try{P.displayName=z;let A=((i=this.plugin.optionsService)==null?void 0:i.getOptions("account_type"))||[],I=A.length>0?A[0]:"demo";await this.plugin.accountPageService.updateAccountMetadata(z,{name:z,accountType:M.accountType||I,createdDate:new Date,initialBalance:0}),this.settings.showSyncNotifications&&new Sa.Notice(`\u{1F4CA} Created account: ${z}`)}catch(A){console.error(`Failed to create Account metadata for ${w}:`,A),p.push(`Failed to create account ${z}: ${A.message}`)}}let f=0,v=0,h=0,y=Date.now(),b=0,k=0,x=0;for(let w=0;w<d.length;w++){let C=d[w];try{let D=Date.now(),P=await this.createTradeFile(C),M=Date.now()-D;P==="created"?(f++,k+=M):P==="updated"?(v++,x+=M):P==="skipped"&&(h++,b+=M),M>1e3&&console.warn(`Slow trade processing: ${C.symbol} ${C.id} took ${M}ms (result: ${P})`)}catch(D){p.push(`Failed to create file for trade ${C.id}: ${D.message}`),console.error(`Failed to create file for trade ${C.id}:`,D)}}if(this.settings.lastSyncTime=new Date().toISOString(),this.settings.syncCount=(this.settings.syncCount||0)+1,await this.plugin.saveSettings(),this.plugin.accountPageService&&d.length>0)try{let w=Date.now();this.tradeFileGenerator.clearAccountCache(),this.tradeSyncService.clearTradeFileCache();let C=new Set;for(let z of d)if(z.mt_account_number){let A=z.mt_account_display_name||this.accountManagementService.getAccountDisplayName(z.mt_account_number)||`Account-${z.mt_account_number}`;C.add(A)}else console.warn(`Trade ${z.id} missing mt_account_number - using fallback account name`),C.add("Unknown Account");console.log(`Batch refreshing ${C.size} accounts after sync of ${d.length} trades`);let D=Array.from(C).map(async z=>{try{return await this.plugin.accountPageService.refreshAccountData(z),z}catch(A){return console.error(`Failed to refresh account ${z}:`,A),null}}),P=(await Promise.all(D)).filter(z=>z!==null),M=Date.now()-w;console.log(`Account refresh completed in ${M}ms for ${P.length} accounts`),xe.publish("account:changed",{action:"batch-updated",accountNames:P})}catch(w){console.error("Error recalculating account metrics after sync:",w),p.push(`Failed to recalculate metrics: ${w.message}`)}this.tradesProcessedSoFar+=d.length;let S={status:"success",synced_trades:d.length,new_files:f,updated_files:v,errors:p};if(u&&!this.syncCancelled){if(this.settings.showSyncNotifications){let w=Math.round(this.tradesProcessedSoFar/this.totalTradesToSync*100);new Sa.Notice(`\u23F3 Batch complete: ${this.tradesProcessedSoFar}/${this.totalTradesToSync} trades (${w}%). Continuing...`)}return this.autoContinueTimeoutId=setTimeout(()=>{let w=this.autoContinueTimeoutId;this.autoContinueTimeoutId=null,!this.syncCancelled&&w!==null&&(console.log("Auto-continuing sync with next batch..."),this.forceSync(!0).catch(C=>{console.error("Auto-continue sync failed:",C),this.syncMutex.unlock(),this.totalTradesToSync=0,this.tradesProcessedSoFar=0}))},1e3),S}if(this.settings.showSyncNotifications)if(d.length>0||this.tradesProcessedSoFar>0){let w=this.tradesProcessedSoFar>0?this.tradesProcessedSoFar:d.length,C=new Set(d.map(D=>D.mt_account_number).filter(D=>D!=null)).size;new Sa.Notice(`\u2705 Sync complete: ${w} trades processed (${f} new, ${v} updated) across ${C} account(s)`)}else new Sa.Notice("\u2705 Sync complete - no new trades found");return this.totalTradesToSync=0,this.tradesProcessedSoFar=0,this.syncMutex.unlock(),S}catch(a){return console.error("Force sync failed:",a),new Sa.Notice("\u274C Sync failed: "+a.message),this.syncMutex.isLocked()&&this.syncMutex.unlock(),this.totalTradesToSync=0,this.tradesProcessedSoFar=0,this.autoContinueTimeoutId!==null&&(clearTimeout(this.autoContinueTimeoutId),this.autoContinueTimeoutId=null),null}}async getSyncStatus(){let t=Bt.buildUrl("/api/v1/obsidian/status"),r=await Bt.makeRequest(t,{method:"GET",headers:{"x-endpoint":"/api/v1/obsidian/status"}},"sync status");return r||null}async checkForNewTrades(){if(this.settings.syncEnabled){if(!this.plugin.authManager.isAuthenticated()){console.warn("Auto-sync skipped: User not authenticated"),Be.showError(new Error("Authentication required"),Be.createContext("auto-sync",void 0,401));return}try{await this.forceSync()}catch(t){throw console.error("Check for new trades failed:",t),t}}}startAutoSync(){this.syncIntervalId&&window.clearInterval(this.syncIntervalId);let t=fV*60*1e3;this.syncIntervalId=this.plugin.registerInterval(window.setInterval(()=>{this.debouncedCheckForNewTrades()},t))}stopAutoSync(){this.syncIntervalId&&(window.clearInterval(this.syncIntervalId),this.syncIntervalId=null),this.debouncedForceSync.cancel(),this.debouncedCheckForNewTrades.cancel()}async updateSettings(t){let r={...this.settings};Object.assign(this.settings,t),await this.plugin.saveSettings(),r.syncEnabled!==this.settings.syncEnabled&&(this.stopAutoSync(),this.settings.syncEnabled&&fV>0&&this.startAutoSync())}async getFTPUserAccountId(){if(this.settings.ftpUserId)return this.settings.ftpUserId;let t=this.settings.ftpUsername;if(t){let r=await this.ftpManagementService.getFTPCredentials(t);if(r&&r.user_id)return this.settings.ftpUserId=r.user_id,await this.updateSettings({ftpUserId:r.user_id}),r.user_id}return console.error("Could not determine FTP user account ID. FTP username:",t),null}async createTradeFile(t){let r=this.tradeSyncService.getFilePathForTrade(t.id);if(r){let f=this.plugin.app.vault.getAbstractFileByPath(r);if(f instanceof Sa.TFile)return await this.updateExistingTradeFile(f,t);this.tradeSyncService.removeMapping(t.id)}let n=dn(t.entry_time);if(!n)return console.error(`Invalid entry_time for trade ${t.id}: ${t.entry_time}`),"skipped";let i=n.getFullYear(),a=String(n.getMonth()+1).padStart(2,"0"),o=this.getWeekNumber(n),s=this.tradeFileGenerator.formatDateForUser(n),l=await this.tradeSyncService.findExistingTradeFile(t,s,i,a,o);if(l){this.tradeSyncService.addMapping(t.id,l),await this.tradeSyncService.saveSyncMapping()||console.warn(`Failed to save mapping for trade ${t.id}`);let v=this.plugin.app.vault.getAbstractFileByPath(l);if(!(v instanceof Sa.TFile))throw new Error(`Failed to locate trade file at path: ${l}`);let h=await this.plugin.app.vault.read(v),y=this.tradeSyncService.parseTradeFromMarkdown(h);if(y&&!y.backendTradeId){let b=h.match(/^---\n([\s\S]*?)\n---/);if(b){let x=b[1].replace(/type: trade/,`type: trade
backendTradeId: ${t.id}`),S=h.replace(b[0],`---
${x}
---`);await this.plugin.app.vault.modify(v,S),await yn(this.plugin.app,v),xe.publish("trade:changed",{action:"updated",filePaths:[v.path]})}}return await this.updateExistingTradeFile(v,t)}let c=t.mt_account_number?this.accountManagementService.getAccountDisplayName(t.mt_account_number):void 0,d=await this.tradeFileGenerator.generateTradeMarkdown(t,c),u,p;try{if(u=await this.tradeFileGenerator.createTradeFileAtomic(t,d),p=this.plugin.app.vault.getAbstractFileByPath(u),!p)throw new Error(`File created but not found: ${u}`)}catch(f){throw console.error(`Failed to create trade file for ${t.symbol} (ID: ${t.id}):`,f),f}await yn(this.plugin.app,p);let m=this.plugin.tradeService;return m&&m.addRecentlyCreatedFile&&m.addRecentlyCreatedFile(u),this.tradeSyncService.addMapping(t.id,u),await this.tradeSyncService.saveSyncMapping()||console.warn(`Failed to save mapping for trade ${t.id}`),await this.autoCreateReviewsForSyncedTrade(t),setTimeout(async()=>{xe.publish("trade:changed",{action:"created",filePaths:[u]})},500),"created"}async updateExistingTradeFile(t,r){let n=await this.plugin.app.vault.read(t),i=this.tradeSyncService.parseTradeFromMarkdown(n);if(!i)return console.warn("Could not parse current trade from markdown"),"skipped";let o=!dn(i.exitTime),s=r.status==="CLOSED"&&r.exit_time;if(o&&s){let l=await this.plugin.app.vault.read(t),c=l.indexOf("---",3)+3,d=l.substring(0,c),u=l.substring(c),p="<!-- User Notes Below -->",m="",g=u.indexOf(p);if(g!==-1)m=u.substring(g);else{let y=u.split(`
`),b=0;for(let k=0;k<y.length;k++){let x=y[k].trim();(x.startsWith("Status: Open")||x.startsWith("\u2705 Profit:")||x.startsWith("\u274C Loss:")||x.startsWith("Exit:"))&&(b=k+1)}if(b<y.length){let k=y.slice(b);k.filter(S=>S.trim()!=="").length>0&&(m=`

`+p+`

`+k.join(`
`))}}let f=r.mt_account_number?this.accountManagementService.getAccountDisplayName(r.mt_account_number):void 0,h=await this.tradeFileGenerator.generateTradeMarkdown(r,f)+(m||`

`+p);return await this.plugin.app.vault.modify(t,h),await yn(this.plugin.app,t),xe.publish("trade:changed",{action:"updated",filePaths:[t.path]}),"updated"}return"skipped"}generateTradeFilePath(t){let r=dn(t.entry_time);if(!r)throw console.error(`Invalid entry_time for trade ${t.id}: ${t.entry_time}`),new Error(`Cannot generate file path for trade with invalid entry_time: ${t.entry_time}`);let n=r.getFullYear(),i=String(r.getMonth()+1).padStart(2,"0"),a=this.getWeekNumber(r),o=this.formatDateForUser(r),s=this.getNextTradeNumber(t.symbol,o,n,i,a);return this.folderPathService.getDatePath(String(n),i,`W${a}`,"trades",`${t.symbol}-${o}-T${s}.md`)}getNextTradeNumber(t,r,n,i,a){let o=this.folderPathService.getDatePath(String(n),i,`W${a}`,"trades"),s=this.plugin.app.vault.getAbstractFileByPath(o),l=0;if(s&&s instanceof Sa.TFolder){let c=`${t}-${r}-T`;for(let d of s.children)if(d instanceof Sa.TFile&&d.name.startsWith(c)){let u=d.name.match(/T(\d+)\.md$/);if(u){let p=parseInt(u[1]);p>l&&(l=p)}}}return l+1}generateTradeMarkdown(t){var l;let r=dn(t.entry_time);if(!r)throw console.error(`Invalid entry_time for trade ${t.id}: ${t.entry_time}`),new Error(`Cannot generate markdown for trade with invalid entry_time: ${t.entry_time}`);let n=t.exit_time?dn(t.exit_time):null;t.exit_time&&!n&&console.warn(`Invalid exit_time for trade ${t.id}: ${t.exit_time}`);let i=t.direction.toUpperCase()==="BUY"?"long":"short",a={type:"trade",backendTradeId:t.id,entryTime:this.formatDateForFrontmatter(t.entry_time),entryPrice:t.entry_price,positionSize:t.volume,direction:i,instrument:t.symbol,assetType:"forex",tradeStatus:t.status};if(t.status==="CLOSED"&&t.exit_time&&t.exit_price&&(a.exitTime=this.formatDateForFrontmatter(t.exit_time),a.exitPrice=t.exit_price,t.profit_loss!==void 0&&t.profit_loss!==null&&(a.pnl=t.profit_loss)),t.entries&&t.entries.length>0?a.entries=t.entries.map(c=>({time:this.formatDateForFrontmatter(c.time),price:c.price,size:c.size})):a.entries=[{time:this.formatDateForFrontmatter(t.entry_time),price:t.entry_price,size:t.volume}],t.status==="CLOSED"&&t.exit_time&&t.exit_price&&(t.exits&&t.exits.length>0?a.exits=t.exits.map(c=>({time:this.formatDateForFrontmatter(c.time),price:c.price,size:c.size})):a.exits=[{time:this.formatDateForFrontmatter(t.exit_time),price:t.exit_price,size:t.volume}]),a.setupIds=[],a.mistakeIds=[],t.mt_account_number){a.accountId=t.mt_account_number;let c=t.mt_account_display_name||this.getAccountDisplayName(t.mt_account_number)||`Account-${t.mt_account_number}`;a.account=[c],a.accountIds=[c]}else console.warn(`Trade ${t.id} missing mt_account_number - using fallback account name in frontmatter`),a.accountIds=["Unknown Account"],a.account=["Unknown Account"];a.setup=[],a.mistake=[],a.images=[],a.tags=[],a.lotSize=1e5,a.pipValue=1;let o=`---
`;for(let[c,d]of Object.entries(a))if(d!=null)if(Array.isArray(d))if(d.length===0)o+=`${c}: []
`;else if(c==="entries"||c==="exits"){o+=`${c}:
`;for(let u of d)o+=`  - time: ${u.time}
`,o+=`    price: ${u.price}
`,o+=`    size: ${u.size}
`}else c==="images"?o+=`${c}: [${d.map(u=>`"${u}"`).join(", ")}]
`:o+=`${c}: [${d.map(u=>`${u}`).join(", ")}]
`;else o+=`${c}: ${d}
`;o+=`---

`;let s=`# ${t.symbol} - ${t.direction.toUpperCase()}

`;if(s+=`Entry: ${t.entry_price} at ${r.toLocaleString()}
`,n){if(s+=`Exit: ${t.exit_price} at ${n.toLocaleString()}
`,t.profit_loss!==void 0&&t.profit_loss!==null){let c=((l=this.plugin.settings.general)==null?void 0:l.currency)||"USD",d=this.plugin.settings.trade.displayRMultiples,u;d&&this.plugin.settings.trade.defaultRiskAmount&&this.plugin.settings.trade.defaultRiskAmount>0&&(u=t.profit_loss/this.plugin.settings.trade.defaultRiskAmount);let p=ye(Math.abs(t.profit_loss),!0,c,d,u);t.profit_loss>0?s+=`\u2705 Profit: ${p}
`:t.profit_loss<0&&(s+=`\u274C Loss: ${p}
`)}}else s+=`Status: Open
`;return o+s}formatDateForFrontmatter(t){let r=typeof t=="string"?dn(t):dn(t);return r?r.toISOString().split(".")[0]:(console.error(`Invalid date input for frontmatter: ${t}`),new Date().toISOString().split(".")[0])}formatDateForUser(t){let r=this.plugin.settings.trade.dateFormat,n=String(t.getDate()).padStart(2,"0"),i=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getFullYear()).slice(-2);switch(r){case"DDMMYY":return`${n}${i}${a}`;case"MMDDYY":return`${i}${n}${a}`;default:return`${a}${i}${n}`}}getWeekNumber(t){let r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())),n=r.getUTCDay()||7;r.setUTCDate(r.getUTCDate()+4-n);let i=new Date(Date.UTC(r.getUTCFullYear(),0,1));return Math.ceil(((r.getTime()-i.getTime())/864e5+1)/7)}async getFTPCredentials(t){return this.ftpManagementService.getFTPCredentials(t)}async autoCreateFTPCredentials(t){return this.ftpManagementService.autoCreateFTPCredentials(t)}async resetFTPPassword(t){return this.ftpManagementService.resetFTPPassword(t)}async fetchUserAccounts(){return await this.accountManagementService.fetchUserAccounts()}async updateAccountDisplayName(t,r){var a;let n=this.plugin.authManager.getAuthState(),i=n.isAuthenticated&&((a=n.cache)!=null&&a.userId)?String(n.cache.userId):this.settings.ftpUserId!==void 0&&this.settings.ftpUserId!==null?String(this.settings.ftpUserId):this.settings.userId||this.getUserId();return this.accountManagementService.updateAccountDisplayName(t,r,i)}getAccountDisplayName(t){return this.accountManagementService.getAccountDisplayName(t)}async getAccountTrades(t,r=100,n=0){let i=this.settings.ftpUsername||this.getUserId();return this.accountManagementService.getAccountTrades(t,i,r,n)}async createOrGetFTPUser(){return this.ftpManagementService.createOrGetFTPUser()}getTradeSyncMapping(){return this.tradeSyncService.getSyncMapping()}setTradeSyncMapping(t,r){this.tradeSyncService.addMapping(t,r)}async saveSyncMapping(){return await this.tradeSyncService.saveSyncMapping()}async updateAccountMapping(t,r){await this.accountManagementService.createAccountMapping(t,r)}async updateAccountMappings(t){await this.accountManagementService.updateAccountMappings(t)}async relinkAccountTrades(t,r,n){let i=[],a=0;if(r===n)return{updatedCount:0,errors:[]};try{let o=this.plugin.app.vault.getMarkdownFiles().filter(s=>this.folderPathService.isJournalPath(s.path)&&s.path.includes("/trades/"));for(let s of o)try{let l=await this.plugin.app.vault.read(s),c=this.tradeSyncService.parseTradeFromMarkdown(l);if(!c)continue;if((Array.isArray(c.account)?c.account:c.account?[c.account]:[]).includes(r)){let u=l;if(c.account&&c.account.length>0){let p=l.match(/account:\s*\[(.*?)\]/);if(p){let m=p[0],g=`account: [${n}]`;u=u.replace(m,g)}}if(c.accountIds&&c.accountIds.length>0){let p=l.match(/accountIds:\s*\[(.*?)\]/);if(p){let m=p[0],g=`accountIds: [${n}]`;u=u.replace(m,g)}}if(await this.plugin.app.vault.modify(s,u),await yn(this.plugin.app,s),a++,this.plugin.accountPageService&&c.pnl!==void 0)try{await this.plugin.accountPageService.refreshAccountData(r),await this.plugin.accountPageService.refreshAccountData(n)}catch(p){console.error("Error refreshing account data after relinking:",p),i.push(`Failed to refresh account data for ${s.path}: ${p.message}`)}}}catch(l){console.error(`Error processing file ${s.path}:`,l),i.push(`${s.path}: ${l.message}`)}if(this.plugin.accountPageService)try{await this.plugin.accountPageService.refreshAccountData(r),xe.publish("account:changed",{action:"updated",accountName:r}),await this.plugin.accountPageService.refreshAccountData(n),xe.publish("account:changed",{action:"updated",accountName:n})}catch(s){console.error("Error refreshing account data after relinking:",s),i.push(`Failed to refresh account data: ${s.message}`)}}catch(o){throw console.error("Error relinking account trades:",o),o}return{updatedCount:a,errors:i}}async requestForceSync(){return this.debouncedForceSync()}async requestCheckForNewTrades(){return this.debouncedCheckForNewTrades()}async forceSyncImmediate(){return this.syncMutex.isLocked()?(new Sa.Notice("\u26A0\uFE0F Sync already in progress"),null):(this.debouncedForceSync.cancel(),await this.forceSync())}async autoCreateReviewsForSyncedTrade(t){var r,n,i,a,o,s,l;try{let c=dn(t.entry_time);if(!c){console.error(`Skipping auto-create reviews for trade ${t.id} - invalid entry_time: ${t.entry_time}`);return}if((i=(n=(r=this.plugin)==null?void 0:r.settings)==null?void 0:n.drc)!=null&&i.autoCreateOnFirstTrade)try{if(this.plugin.drcService){let d=this.plugin.drcService.getDRCNotePath(c);await this.plugin.app.vault.adapter.exists(d)||await this.plugin.drcService.createDRC(c)}}catch(d){console.error("Failed to auto-create DRC for synced trade:",d)}if((o=(a=this.plugin)==null?void 0:a.settings.weekly)!=null&&o.autoCreateOnFirstTrade)try{if(this.plugin.weeklyReviewService){let d=this.plugin.weeklyReviewService.getWeeklyReviewPath(c);await this.plugin.app.vault.adapter.exists(d)||await this.plugin.weeklyReviewService.createWeeklyReview(c)}}catch(d){console.error("Failed to auto-create Weekly Review for synced trade:",d)}if((l=(s=this.plugin)==null?void 0:s.settings.monthly)!=null&&l.autoCreateOnFirstTrade)try{if(this.plugin.monthlyReviewService){let d=this.plugin.monthlyReviewService.getMonthlyReviewPath(c);await this.plugin.app.vault.adapter.exists(d)||await this.plugin.monthlyReviewService.createMonthlyReview(c)}}catch(d){console.error("Failed to auto-create Monthly Review for synced trade:",d)}}catch(c){console.error("Error in auto-create reviews for synced trade:",c)}}cleanup(){this.stopAutoSync(),this.fileWatcherService.clearProcessedFiles(),this.tradeSyncService.cleanup(),this.debouncedForceSync.cancel(),this.debouncedCheckForNewTrades.cancel(),this.autoContinueTimeoutId!==null&&(clearTimeout(this.autoContinueTimeoutId),this.autoContinueTimeoutId=null),this.syncCancelled=!1,this.totalTradesToSync=0,this.tradesProcessedSoFar=0}}});var D0e=F(()=>{P0e();vm()});var E0e,t9e,VP,I0e=F(()=>{E0e=require("obsidian");YF();t9e=1,VP=class extends E0e.Component{constructor(r,n){super();this.callbacks={};this.checklist=[];this.saveTimeout=null;this.isSaving=!1;this.app=r,this.plugin=n,this.data=this.getDefaultData(),this.state=this.getDefaultState(),this.checklist=[...uq]}async initialize(){await this.loadData(),this.updateState()}getDefaultData(){return{version:1,completed:!1,currentStep:"welcome",checklist:{},skipped:!1}}getDefaultState(){return{isActive:!1,currentStep:"welcome",canSkip:!0,canGoBack:!1,canGoForward:!0}}async loadData(){var r;try{let n=await this.plugin.loadData(),i=n==null?void 0:n.localMeta;i!=null&&i.onboarding?i.onboarding.version!==1?i.onboarding.version>1&&i.onboarding.version>=t9e?(console.warn(`Onboarding version downgrade detected: ${i.onboarding.version} -> ${1}`),this.data={...this.getDefaultData(),...i.onboarding,version:1}):this.data=this.migrateData(i.onboarding):this.data={...this.getDefaultData(),...i.onboarding}:this.data=this.getDefaultData(),(r=i==null?void 0:i.onboarding)!=null&&r.checklist&&this.updateChecklistFromData(i.onboarding.checklist)}catch(n){console.error("Error loading onboarding data:",n),this.data=this.getDefaultData()}}async saveData(){this.saveTimeout&&(window.clearTimeout(this.saveTimeout),this.saveTimeout=null),this.saveTimeout=window.setTimeout(async()=>{await this.performSave()},100)}async performSave(){if(this.isSaving){this.saveTimeout=window.setTimeout(()=>this.performSave(),50);return}this.isSaving=!0;try{let r=await this.plugin.loadData()||{};r.localMeta||(r.localMeta={}),r.localMeta.onboarding=this.data,await this.plugin.saveData(r)}catch(r){console.error("Error saving onboarding data:",r)}finally{this.isSaving=!1}}migrateData(r){let n=this.getDefaultData();return r.completed!==void 0&&(n.completed=r.completed),r.completedAt!==void 0&&(n.completedAt=r.completedAt),r.selectedGoal!==void 0&&(n.selectedGoal=r.selectedGoal),r.skipped!==void 0&&(n.skipped=r.skipped),r.skippedAt!==void 0&&(n.skippedAt=r.skippedAt),r.checklist!==void 0&&(n.checklist={...r.checklist}),n}updateChecklistFromData(r){this.checklist=this.checklist.map(n=>({...n,completed:r[n.id]||!1,completedAt:r[n.id]?Date.now():void 0}))}updateState(){this.state={isActive:!this.data.completed&&!this.data.skipped,currentStep:this.data.currentStep||"welcome",selectedGoal:this.data.selectedGoal,canSkip:this.canSkipCurrentStep(),canGoBack:this.canGoBackFromCurrentStep(),canGoForward:this.canGoForwardFromCurrentStep()}}canSkipCurrentStep(){let r=ti.find(n=>n.id===this.state.currentStep);return(r==null?void 0:r.isOptional)===!0}canGoBackFromCurrentStep(){return ti.findIndex(n=>n.id===this.state.currentStep)>0}canGoForwardFromCurrentStep(){return ti.findIndex(n=>n.id===this.state.currentStep)<ti.length-1}getState(){return{...this.state}}getData(){return{...this.data}}getChecklist(){return[...this.checklist]}shouldShowOnboarding(){return!this.data.completed&&!this.data.skipped}isCompleted(){return this.data.completed}async startOnboarding(){var r,n;this.data.currentStep="welcome",this.data.completed=!1,this.data.skipped=!1,this.updateState(),await this.saveData(),(n=(r=this.callbacks).onStepChange)==null||n.call(r,"welcome")}async goToStep(r){var i,a;let n=this.state.currentStep;if(!this.isValidStepTransition(this.state.currentStep,r))throw new Error(`Invalid step transition from ${this.state.currentStep} to ${r}`);this.data.currentStep=r,this.updateState(),await this.saveData(),(a=(i=this.callbacks).onStepChange)==null||a.call(i,r,n)}async nextStep(){if(!this.state.canGoForward)throw new Error("Cannot go forward from current step");let n=ti.findIndex(i=>i.id===this.state.currentStep)+1;for(;n<ti.length;){let i=ti[n];if(!i.shouldShow||i.shouldShow(this.data.selectedGoal))break;n++}n<ti.length&&await this.goToStep(ti[n].id)}async previousStep(){if(!this.state.canGoBack)throw new Error("Cannot go back from current step");let n=ti.findIndex(i=>i.id===this.state.currentStep)-1;for(;n>=0;){let i=ti[n];if(!i.shouldShow||i.shouldShow(this.data.selectedGoal))break;n--}n>=0&&await this.goToStep(ti[n].id)}async setGoal(r){var n,i;this.data.selectedGoal=r,this.updateState(),await this.saveData(),(i=(n=this.callbacks).onGoalSelected)==null||i.call(n,r)}async skipOnboarding(){var n,i;let r=this.state.currentStep;this.data.skipped=!0,this.data.skippedAt=Date.now(),this.state.isActive=!1,this.updateState(),await this.saveData(),(i=(n=this.callbacks).onSkipped)==null||i.call(n,r)}async completeOnboarding(){var r,n;this.data.completed=!0,this.data.completedAt=Date.now(),this.state.isActive=!1,this.updateState(),await this.saveData(),(n=(r=this.callbacks).onCompleted)==null||n.call(r,this.data)}async resetOnboarding(){this.data=this.getDefaultData(),this.state=this.getDefaultState(),this.checklist=[...uq],await this.saveData()}async completeChecklistTask(r){let n=this.checklist.find(i=>i.id===r);if(!n){console.warn(`Checklist task not found: ${r}`);return}n.completed||(n.completed=!0,n.completedAt=Date.now(),this.data.checklist[r]=!0,await this.saveData())}isValidStepTransition(r,n){let i=ti.findIndex(o=>o.id===r),a=ti.findIndex(o=>o.id===n);return a<=i?!0:a===i+1}setCallbacks(r){this.callbacks={...this.callbacks,...r}}clearCallbacks(){this.callbacks={}}async onunload(){this.clearCallbacks(),this.saveTimeout!==null&&(window.clearTimeout(this.saveTimeout),this.saveTimeout=null);try{await this.performSave()}catch(r){console.error("Error during final save in onunload:",r)}}}});var M0e=F(()=>{I0e();YF()});var Kb,VO,A0e=F(()=>{Kb=require("obsidian");Tm();Oa();_t();AT();Tr();VO=class extends ts{constructor(r,n,i={}){let a=n.serviceManager,o=a==null?void 0:a.getFolderPathService(),s=(o==null?void 0:o.journalFolderPath)||"!Journalit";super(r,{folder:s,extension:".md",namespace:"missed-trade",enableIndexing:!0,...i});this.recentlyCreatedFiles=new Set;this.tradesFolder="trades";this.setPlugin(n),this.folderPathService=o||{journalFolderPath:"!Journalit",getPath:(...l)=>(0,Kb.normalizePath)(["!Journalit",...l].join("/")),isJournalPath:l=>l.startsWith("!Journalit/")}}getPlugin(){if(!this.plugin)throw new Error("Plugin not initialized");return this.plugin}validateDirectionAndOptionType(r){if(r.optionType){let n=r.optionType.trim().toLowerCase();(n==="call"||n==="put")&&(r.optionType=n)}if(r.direction&&r.optionType)throw new Error("Cannot specify both direction and optionType");if(r.assetType==="options"){if(!r.optionType)throw new Error("Option type is required");if(r.optionType!=="call"&&r.optionType!=="put")throw new Error("Invalid optionType: must be 'call' or 'put'");if(r.direction)throw new Error("Direction should not be provided for options trades")}else{if(!r.direction)throw new Error("Direction is required");if(r.optionType)throw new Error("optionType should only be provided for options trades")}}setPlugin(r){super.setPlugin(r),r.registerEvent(r.app.vault.on("delete",async n=>{if(n.path.endsWith(".md")&&/-M\d+\.md$/.test(n.path)){let i=(0,Kb.normalizePath)(n.path);await this.handleMissedTradeDeletion(i)}}))}async createMissedTrade(r,n){var i,a;try{if(!r.entryTime)throw new Error("Entry time is required");if(this.validateDirectionAndOptionType(r),!r.instrument)throw new Error("Instrument is required");r.entryPrice===void 0&&(r.entryPrice=0),r.exitPrice===void 0&&(r.exitPrice=0),r.positionSize===void 0&&(r.positionSize=0),r.exitTime||(r.exitTime=r.entryTime);let o=this.getTargetFolderPath(r.entryTime);try{await this.app.vault.adapter.mkdir(o)}catch(u){}let s=await this.getMissedTradeFilePath(r);if(await this.app.vault.adapter.exists(s))throw console.error(`Cannot create missed trade - File already exists at path: ${s}`),new Error(`File already exists: ${s}`);let c=this.generateMissedTradeContent(r);this.recentlyCreatedFiles.add(s),setTimeout(()=>{var u;(u=this.recentlyCreatedFiles)==null||u.delete(s)},1e4);let d=await this.app.vault.create(s,c);if(this.app.metadataCache.trigger("resolve",d),xe.publish("missed-trade:changed",{action:"created",filePath:s,timestamp:Date.now()}),this.clearCache(),(i=this.plugin)!=null&&i.settings.trade.autoOpenCreatedTrades&&!(n!=null&&n.suppressAutoOpen)){let u=null;(a=this.plugin)!=null&&a.processorManager&&(u=await this.getPlugin().processorManager.getMissedTradeNoteProcessor());try{await this.getPlugin().openFile(s,!0)}catch(p){console.warn("Failed to auto-open created missed trade:",p)}}return console.log(`Missed trade created successfully: ${s}`),s}catch(o){throw console.error("Error creating missed trade:",o),o}}async updateMissedTrade(r,n){var i,a,o,s,l,c,d;try{if(!r.entryTime)throw new Error("Entry time is required");if(this.validateDirectionAndOptionType(r),!r.instrument)throw new Error("Instrument is required");if(!await this.app.vault.adapter.exists(n))throw new Error(`Missed trade file does not exist: ${n}`);let p=this.app.vault.getAbstractFileByPath(n);if(!p||!(p instanceof Kb.TFile))throw new Error(`Invalid file path: ${n}`);r.entryPrice===void 0&&(r.entryPrice=0),r.exitPrice===void 0&&(r.exitPrice=0),r.positionSize===void 0&&(r.positionSize=0),r.exitTime||(r.exitTime=r.entryTime);let m=uc(r),g={type:"missed-trade",isMissedTrade:!0,entryTime:this.formatDateForFrontmatter(r.entryTime),exitTime:this.formatDateForFrontmatter(r.exitTime||r.entryTime),entryPrice:r.entryPrice,exitPrice:r.exitPrice,positionSize:r.positionSize,...r.direction?{direction:r.direction}:{},instrument:r.instrument};return g.pnl=m,r.assetType&&(g.assetType=r.assetType),r.thesis!==void 0&&(g.thesis=this.formatThesisForYAML(r.thesis||"")),r.missedReason!==void 0&&(g.missedReason=r.missedReason||""),r.commission!==void 0&&(g.commission=r.commission),r.commissionType!==void 0&&(g.commissionType=r.commissionType),r.fees!==void 0&&(g.fees=r.fees),(i=r.setupIds)!=null&&i.length&&(g.setupIds=r.setupIds),(a=r.mistakeIds)!=null&&a.length&&(g.mistakeIds=r.mistakeIds),(o=r.accountIds)!=null&&o.length&&(g.accountIds=r.accountIds),(s=r.account)!=null&&s.length&&(g.account=r.account),(l=r.setup)!=null&&l.length&&(g.setup=r.setup),(c=r.mistake)!=null&&c.length&&(g.mistake=r.mistake),(d=r.images)!=null&&d.length&&(g.images=r.images),r.useDirectPnLInput!==void 0&&(g.useDirectPnLInput=r.useDirectPnLInput),r.directPnL!==void 0&&(g.directPnL=r.directPnL),r.optionType&&(g.optionType=r.optionType),r.reviewed!==void 0&&(g.reviewed=r.reviewed),r.reviewedAt&&(g.reviewedAt=r.reviewedAt),r.customTags&&Array.isArray(r.customTags)&&r.customTags.length>0?g.tags=r.customTags.filter(f=>f==null?void 0:f.trim()):g.tags=[],await this.updateFrontmatter(p,g),xe.publish("missed-trade:changed",{action:"updated",filePath:n,timestamp:Date.now()}),this.clearCache(),console.log(`Missed trade updated successfully: ${n}`),n}catch(u){throw console.error("Error updating missed trade:",u),u}}async updateMissedTradeReviewStatus(r,n,i){try{let a=this.app.vault.getAbstractFileByPath(r);if(!a||!(a instanceof Kb.TFile))throw new Error(`Invalid file path: ${r}`);let o={reviewed:n,reviewedAt:i||new Date().toISOString()};await this.updateFrontmatter(a,o),xe.publish("missed-trade:changed",{action:"updated",filePath:r,timestamp:Date.now()}),console.log(`Missed trade review status updated: ${r}`)}catch(a){throw console.error("Error updating missed trade review status:",a),a}}async updateMissedTradeReview(r,n){try{let i=this.app.vault.getAbstractFileByPath(r);if(!i||!(i instanceof Kb.TFile))throw new Error(`Invalid file path: ${r}`);let a={lossReview:n};await this.updateFrontmatter(i,a),xe.publish("missed-trade:changed",{action:"updated",filePath:r,timestamp:Date.now()}),console.log(`Missed trade review data updated: ${r}`)}catch(i){throw console.error("Error updating missed trade review data:",i),i}}async handleMissedTradeDeletion(r){console.log("Handling missed trade deletion:",r),this.clearCache(),xe.publish("missed-trade:changed",{action:"deleted",filePath:r,timestamp:Date.now()}),console.log("Emitted missed trade deletion event:",r)}async getMissedTradeFilePath(r){var g;let n=Zt(r.entryTime,this.plugin),i=n.getFullYear(),a=String(n.getMonth()+1).padStart(2,"0"),o=String(n.getDate()).padStart(2,"0"),s=this.getWeekOfMonth(n),l=r.instrument?this.sanitizeTickerForFilename(r.instrument):"UNKNOWN",c=((g=this.plugin)==null?void 0:g.settings.trade.dateFormat)||"DDMMYY",d="";c==="DDMMYY"?d=`${o}${a}${String(i).slice(2)}`:c==="MMDDYY"?d=`${a}${o}${String(i).slice(2)}`:c==="YYMMDD"?d=`${String(i).slice(2)}${a}${o}`:d=`${o}${a}${String(i).slice(2)}`;let u=await this.getMissedTradeNumberForDay(l,n),p=`${l}-${d}-M${u}.md`;return this.folderPathService.getPath(i.toString(),a,s,this.tradesFolder,p)}async getMissedTradeNumberForDay(r,n){var u;let i=this.getTargetFolderPath(n),a=await this.listFilesInFolder(i),o=((u=this.plugin)==null?void 0:u.settings.trade.dateFormat)||"DDMMYY",s=this.formatDateForFilename(n,o),l=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),c=new RegExp(`^${l}-${s}-M(\\d+)\\.md$`),d=0;for(let p of a){let m=p.split("/").pop()||"",g=c.exec(m);if(g){let f=parseInt(g[1],10);d=Math.max(d,f)}}return d+1}getAllMissedTradeFiles(){return this.app.vault.getMarkdownFiles().filter(n=>!(!this.folderPathService.isJournalPath(n.path)||!n.path.includes("/trades/")||!n.path.match(/-M\d+\.md$/)))}async getMissedTrades(r,n){await new Promise(l=>setTimeout(l,50)),this.invalidateCache();let i=Zt(r,this.plugin),a=Zt(n,this.plugin);a.setHours(23,59,59,999);let o=this.getAllMissedTradeFiles(),s=[];for(let l of o)try{if(!l.path.includes("/trades/")||!this.folderPathService.isJournalPath(l.path)||!l.path.match(/-M\d+\.md$/))continue;let c=await this.readFrontmatter(l);if(!c||c.type!=="missed-trade")continue;let d=c.entryTime?new Date(c.entryTime):null;if(!d)continue;let u=Zt(d,this.plugin);u>=i&&u<=a&&s.push(l)}catch(c){console.warn(`Failed to read frontmatter for ${l.path}:`,c)}return s}generateMissedTradeContent(r){var o,s,l,c,d,u,p,m;let n=["---","type: missed-trade","isMissedTrade: true",`entryTime: ${this.formatDateForFrontmatter(r.entryTime)}`,`exitTime: ${this.formatDateForFrontmatter(r.exitTime||r.entryTime)}`,`entryPrice: ${r.entryPrice||0}`,`exitPrice: ${r.exitPrice||0}`,`positionSize: ${r.positionSize||0}`,r.direction?`direction: ${r.direction}`:null,r.optionType?`optionType: ${r.optionType}`:null,`instrument: ${r.instrument}`,`pnl: ${uc(r)}`,r.useDirectPnLInput!==void 0?`useDirectPnLInput: ${r.useDirectPnLInput}`:null,r.directPnL!==void 0?`directPnL: ${r.directPnL}`:null,r.commission!==void 0?`commission: ${r.commission}`:null,r.commissionType!==void 0?`commissionType: ${r.commissionType}`:null,r.fees!==void 0?`fees: ${r.fees}`:null,r.assetType?`assetType: ${r.assetType}`:null,r.thesis!==void 0?`thesis: ${this.formatThesisForYAML(r.thesis||"")}`:null,r.missedReason!==void 0?`missedReason: ${JSON.stringify(r.missedReason||"")}`:null,(o=r.setupIds)!=null&&o.length?`setupIds: [${r.setupIds.map(g=>`"${g}"`).join(", ")}]`:null,(s=r.mistakeIds)!=null&&s.length?`mistakeIds: [${r.mistakeIds.map(g=>`"${g}"`).join(", ")}]`:null,(l=r.accountIds)!=null&&l.length?`accountIds: [${r.accountIds.map(g=>`"${g}"`).join(", ")}]`:null,(c=r.setup)!=null&&c.length?`setup: [${r.setup.map(g=>`"${g}"`).join(", ")}]`:null,(d=r.mistake)!=null&&d.length?`mistake: [${r.mistake.map(g=>`"${g}"`).join(", ")}]`:null,(u=r.account)!=null&&u.length?`account: [${r.account.map(g=>`"${g}"`).join(", ")}]`:null,(p=r.images)!=null&&p.length?`images: [${r.images.map(g=>`"${g.trim()}"`).join(", ")}]`:null,"tags: []"],i=new Set(["type","isMissedTrade","entryTime","exitTime","entryPrice","exitPrice","positionSize","direction","optionType","instrument","pnl","useDirectPnLInput","directPnL","commission","commissionType","fees","assetType","thesis","missedReason","setupIds","mistakeIds","accountIds","setup","mistake","account","images","tags","notes","customFields"]);if(r.customFields)try{let g=(m=this.plugin)==null?void 0:m.customFieldsService;if(g){let f=g.getFields();Object.entries(r.customFields).forEach(([v,h])=>{if(h!=null&&h!==""){let y=f.find(b=>b.id===v);y&&y.fieldKey?Array.isArray(h)?n.push(`${y.fieldKey}: [${h.map(b=>JSON.stringify(b)).join(", ")}]`):typeof h=="string"?n.push(`${y.fieldKey}: ${JSON.stringify(h)}`):n.push(`${y.fieldKey}: ${h}`):Array.isArray(h)?n.push(`${v}: [${h.map(b=>JSON.stringify(b)).join(", ")}]`):typeof h=="string"?n.push(`${v}: ${JSON.stringify(h)}`):n.push(`${v}: ${h}`)}})}else Object.entries(r.customFields).forEach(([f,v])=>{v!=null&&v!==""&&(Array.isArray(v)?n.push(`${f}: [${v.map(h=>JSON.stringify(h)).join(", ")}]`):typeof v=="string"?n.push(`${f}: ${JSON.stringify(v)}`):n.push(`${f}: ${v}`))})}catch(g){console.error("Error mapping custom field IDs to keys in missed trade:",g),Object.entries(r.customFields).forEach(([f,v])=>{v!=null&&v!==""&&(Array.isArray(v)?n.push(`${f}: [${v.map(h=>JSON.stringify(h)).join(", ")}]`):typeof v=="string"?n.push(`${f}: ${JSON.stringify(v)}`):n.push(`${f}: ${v}`))})}return Object.keys(r).forEach(g=>{if(!i.has(g)&&r[g]!==void 0&&r[g]!==null){let f=r[g];Array.isArray(f)?n.push(`${g}: [${f.map(v=>JSON.stringify(v)).join(", ")}]`):typeof f=="string"?n.push(`${g}: ${JSON.stringify(f)}`):typeof f=="object"?n.push(`${g}: ${JSON.stringify(f)}`):n.push(`${g}: ${f}`)}}),n.push("---"),[...n,"","# Missed Trade Notes","",r.notes||"Add any additional notes about this missed trade here."].filter(g=>g!==null).join(`
`)}getTargetFolderPath(r){let n=r.getFullYear(),i=String(r.getMonth()+1).padStart(2,"0"),a=this.getWeekOfMonth(r);return this.folderPathService.getPath(n.toString(),i,a,this.tradesFolder)}getWeekOfMonth(r){return dc(r)}formatDateForFilename(r,n){let i=r.getFullYear(),a=String(r.getMonth()+1).padStart(2,"0"),o=String(r.getDate()).padStart(2,"0");switch(n){case"DDMMYY":return`${o}${a}${String(i).slice(2)}`;case"MMDDYY":return`${a}${o}${String(i).slice(2)}`;case"YYMMDD":return`${String(i).slice(2)}${a}${o}`;default:return`${o}${a}${String(i).slice(2)}`}}sanitizeTickerForFilename(r){if(!r)return"UNKNOWN";let n=r.trim().toUpperCase();if(n=n.replace(/[\\\/:\*\?"<>|\+]/g,"").replace(/[\s.\[\]\(\)\{\}#%&=;]/g,"-").replace(/--+/g,"-").replace(/^-|-$/g,""),!n)return"UNKNOWN";let i=20;return n.length>i&&(n=n.substring(0,i)),n}async listFilesInFolder(r){try{return(await this.app.vault.adapter.list(r)).files||[]}catch(n){return[]}}formatDateForFrontmatter(r){return r.toISOString()}formatThesisForYAML(r){if(!r||r.trim()==="")return'""';let n=r.trim();return n.includes(`
`)?`|
    ${n.replace(/\n/g,`
    `)}`:/[:|>[\]{}*&!%@`]/.test(n)||n.startsWith('"')||n.startsWith("'")||n.endsWith('"')||n.endsWith("'")||n.match(/^\s/)||n.match(/\s$/)?`"${n.replace(/"/g,'\\"')}"`:n}}});var yk,GO,L0e=F(()=>{Tm();AT();yk=require("obsidian");_t();Tr();GO=class extends ts{constructor(r,n,i={}){let a=n.serviceManager,o=a==null?void 0:a.getFolderPathService(),s=(o==null?void 0:o.journalFolderPath)||"!Journalit";super(r,{folder:s,extension:".md",namespace:"backtest-trade",enableIndexing:!0,...i});this.recentlyCreatedFiles=new Set;this.tradesFolder="trades";this.setPlugin(n),this.folderPathService=o||{journalFolderPath:"!Journalit",getPath:(...l)=>(0,yk.normalizePath)(["!Journalit",...l].join("/")),isJournalPath:l=>l.startsWith("!Journalit/")}}getPlugin(){if(!this.plugin)throw new Error("Plugin not initialized");return this.plugin}setPlugin(r){super.setPlugin(r),r.registerEvent(r.app.vault.on("delete",async n=>{if(n.path.endsWith(".md")&&/-B\d+\.md$/.test(n.path)){let i=(0,yk.normalizePath)(n.path);await this.handleBacktestTradeDeletion(i)}}))}async createBacktestTrade(r,n={}){var i,a;try{let{openFile:o=!0,images:s=[],customFields:l={}}=n;if(!r.instrument||!r.entryTime)return console.error("[BacktestTradeService] Missing required data:",{instrument:r.instrument,entryTime:r.entryTime}),null;let c=r.entryTime instanceof Date?r.entryTime:new Date(r.entryTime),d=new Date(c.getFullYear(),c.getMonth(),c.getDate()),u=r.instrument.toUpperCase(),p=await this.getTargetFolderPath(d);if(!p)return console.error("[BacktestTradeService] Failed to determine target folder path"),null;let m=await this.getBacktestTradeNumberForDay(u,d),g=this.getPlugin().settings.trade.dateFormat||"DDMMYY",f=this.formatDateForFile(d,g),v=`${u}-${f}-B${m}.md`,h=`${p}/${v}`;if(this.recentlyCreatedFiles.has(h))return console.warn("[BacktestTradeService] File creation already in progress:",h),null;this.recentlyCreatedFiles.add(h);try{let y={type:"backtest-trade",isBacktestTrade:!0,entryTime:r.entryTime?this.formatDateForFrontmatter(r.entryTime):void 0,exitTime:r.exitTime?this.formatDateForFrontmatter(r.exitTime):void 0,entryPrice:r.entryPrice,exitPrice:r.exitPrice,positionSize:r.positionSize,direction:r.direction,entries:(i=r.entries)==null?void 0:i.map(x=>({time:this.formatDateForFrontmatter(x.time),price:x.price,size:x.size})),exits:(a=r.exits)==null?void 0:a.map(x=>({time:this.formatDateForFrontmatter(x.time),price:x.price,size:x.size})),setupIds:r.setupIds,mistakeIds:r.mistakeIds,accountIds:r.accountIds,thesis:this.formatThesisForYAML(r.thesis||""),images:r.images,instrument:r.instrument,assetType:r.assetType,setup:r.setup,mistake:r.mistake,account:r.account,commission:r.commission,fees:r.fees,pnl:uc(r),useDirectPnLInput:r.useDirectPnLInput,directPnL:r.directPnL,isMissedTrade:r.isMissedTrade,missedReason:r.missedReason,...l,tags:r.customTags&&Array.isArray(r.customTags)&&r.customTags.length>0?r.customTags.map(x=>String(x).trim()).filter(x=>x.length>0):[]};if(r.assetType==="stock"?r.exchange&&(y.exchange=r.exchange):r.assetType==="options"?(r.expirationDate&&(y.expirationDate=this.formatDateForFrontmatter(r.expirationDate)),r.strikePrice!==void 0&&(y.strikePrice=r.strikePrice),r.optionType&&(y.optionType=r.optionType),r.contractSize!==void 0&&(y.contractSize=r.contractSize)):r.assetType==="futures"?(r.dollarPerPoint!==void 0&&(y.dollarPerPoint=r.dollarPerPoint),r.tickSize!==void 0&&(y.tickSize=r.tickSize),r.tickValue!==void 0&&(y.tickValue=r.tickValue)):r.assetType==="forex"?(r.lotSize!==void 0&&(y.lotSize=r.lotSize),r.pipValue!==void 0&&(y.pipValue=r.pipValue)):r.assetType==="crypto"?r.cryptoExchange&&(y.cryptoExchange=r.cryptoExchange):r.assetType==="cfd"&&r.leverageRatio!==void 0&&(y.leverageRatio=r.leverageRatio),await this.app.vault.adapter.exists(h))return console.warn("[BacktestTradeService] File already exists:",h),null;let k=await this.app.vault.create(h,"");return await this.updateFrontmatter(k,y),s.length>0&&await this.copyImagesToTradeFolder(s,k,`B${m}`),o&&await this.getPlugin().openFile(k.path,!0),xe.publish("backtest-trade:changed",{action:"created",filePath:h,timestamp:Date.now()}),k}finally{setTimeout(()=>this.recentlyCreatedFiles.delete(h),5e3)}}catch(o){return console.error("[BacktestTradeService] Failed to create backtest trade:",o),null}}async updateBacktestTrade(r,n){var i,a;try{let o=this.app.vault.getAbstractFileByPath(n);if(!o||!(o instanceof yk.TFile))return console.error("[BacktestTradeService] File not found:",n),!1;let s={type:"backtest-trade",isBacktestTrade:!0,entryTime:r.entryTime?this.formatDateForFrontmatter(r.entryTime):void 0,exitTime:r.exitTime?this.formatDateForFrontmatter(r.exitTime):void 0,entryPrice:r.entryPrice,exitPrice:r.exitPrice,positionSize:r.positionSize,direction:r.direction,entries:(i=r.entries)==null?void 0:i.map(l=>({time:this.formatDateForFrontmatter(l.time),price:l.price,size:l.size})),exits:(a=r.exits)==null?void 0:a.map(l=>({time:this.formatDateForFrontmatter(l.time),price:l.price,size:l.size})),setupIds:r.setupIds,mistakeIds:r.mistakeIds,accountIds:r.accountIds,thesis:this.formatThesisForYAML(r.thesis||""),images:r.images,instrument:r.instrument,assetType:r.assetType,setup:r.setup,mistake:r.mistake,account:r.account,commission:r.commission,fees:r.fees,pnl:uc(r),useDirectPnLInput:r.useDirectPnLInput,directPnL:r.directPnL,isMissedTrade:r.isMissedTrade,missedReason:r.missedReason,tags:r.customTags&&Array.isArray(r.customTags)&&r.customTags.length>0?r.customTags.map(l=>String(l).trim()).filter(l=>l.length>0):[]};return r.assetType==="stock"?r.exchange&&(s.exchange=r.exchange):r.assetType==="options"?(r.expirationDate&&(s.expirationDate=this.formatDateForFrontmatter(r.expirationDate)),r.strikePrice!==void 0&&(s.strikePrice=r.strikePrice),r.optionType&&(s.optionType=r.optionType),r.contractSize!==void 0&&(s.contractSize=r.contractSize)):r.assetType==="futures"?(r.dollarPerPoint!==void 0&&(s.dollarPerPoint=r.dollarPerPoint),r.tickSize!==void 0&&(s.tickSize=r.tickSize),r.tickValue!==void 0&&(s.tickValue=r.tickValue)):r.assetType==="forex"?(r.lotSize!==void 0&&(s.lotSize=r.lotSize),r.pipValue!==void 0&&(s.pipValue=r.pipValue)):r.assetType==="crypto"?r.cryptoExchange&&(s.cryptoExchange=r.cryptoExchange):r.assetType==="cfd"&&r.leverageRatio!==void 0&&(s.leverageRatio=r.leverageRatio),await this.updateFrontmatter(o,s),xe.publish("backtest-trade:changed",{action:"updated",filePath:n,timestamp:Date.now()}),!0}catch(o){return console.error("[BacktestTradeService] Failed to update backtest trade:",o),!1}}async handleBacktestTradeDeletion(r){console.log("Handling backtest trade deletion:",r),this.clearCache(),xe.publish("backtest-trade:changed",{action:"deleted",filePath:r,timestamp:Date.now()}),console.log("Emitted backtest trade deletion event:",r)}getAllBacktestTradeFiles(){return this.app.vault.getMarkdownFiles().filter(n=>{let i=this.folderPathService.journalFolderPath;return!n.path.includes("/trades/")&&!this.folderPathService.isJournalPath(n.path)?!1:/(-B\d+\.md$|TMB.*\.md$)/.test(n.path)})}async getBacktestTrades(r,n){try{return await this.query(async()=>{let a=this.getAllBacktestTradeFiles(),o=[];for(let s of a)try{let l=this.app.metadataCache.getFileCache(s),c=l==null?void 0:l.frontmatter;if(!c||c.type!=="backtest-trade")continue;if(o.length%20===0&&await new Promise(u=>setTimeout(u,0)),c.entryTime){let u=new Date(c.entryTime);if(u<r||u>n)continue}let d={...c,filePath:s.path,isBacktestTrade:!0};o.push(d)}catch(l){console.error(`[BacktestTradeService] Error processing file ${s.path}:`,l)}return o},`backtest-trades-${r.getTime()}-${n.getTime()}`)}catch(i){return console.error("[BacktestTradeService] Failed to get backtest trades:",i),[]}}async getBacktestTradeFiles(r,n){try{return await this.query(async()=>{let a=this.getAllBacktestTradeFiles(),o=[];for(let s of a)try{let l=this.app.metadataCache.getFileCache(s),c=l==null?void 0:l.frontmatter;if(!c||c.type!=="backtest-trade")continue;if(o.length%20===0&&await new Promise(u=>setTimeout(u,0)),c.entryTime){let u=new Date(c.entryTime);if(u<r||u>n)continue}let d={...c,filePath:s.path,isBacktestTrade:!0};o.push({file:s,data:d})}catch(l){console.error(`[BacktestTradeService] Error processing file ${s.path}:`,l)}return o},`backtest-trade-files-${r.getTime()}-${n.getTime()}`)}catch(i){return console.error("[BacktestTradeService] Failed to get backtest trade files:",i),[]}}async updateBacktestTradeReviewStatus(r,n,i){try{let a=this.app.vault.getAbstractFileByPath(r);if(!a||!(a instanceof yk.TFile))return!1;let o=await this.readFrontmatter(a);return await this.updateFrontmatter(a,{...o,reviewed:n,reviewedAt:i||(n?new Date().toISOString():void 0)}),xe.publish("backtest-trade:changed",{action:"updated",filePath:a.path,timestamp:Date.now()}),!0}catch(a){return console.error("[BacktestTradeService] Failed to update review status:",a),!1}}async getBacktestTradeNumberForDay(r,n){try{let i=await this.getTargetFolderPath(n);if(!i||!await this.app.vault.adapter.exists(i))return 1;let s=(await this.app.vault.adapter.list(i)).files||[],l=this.getPlugin().settings.trade.dateFormat||"DDMMYY",c=this.formatDateForFile(n,l),d=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),u=new RegExp(`^${d}-${c}-B(\\d+)\\.md$`),p=[];for(let g of s){let v=(g.split("/").pop()||g).match(u);v&&p.push(parseInt(v[1],10))}return p.length>0?Math.max(...p)+1:1}catch(i){return console.error("[BacktestTradeService] Failed to get backtest trade number:",i),1}}async getTargetFolderPath(r){let n=r.getFullYear(),i=String(r.getMonth()+1).padStart(2,"0"),a=dc(r),o=this.folderPathService.getPath(n.toString(),i,a,this.tradesFolder);return await this.app.vault.adapter.mkdir(o),o}formatDateForFile(r,n){let i=r.getDate().toString().padStart(2,"0"),a=(r.getMonth()+1).toString().padStart(2,"0"),o=r.getFullYear().toString().slice(-2);switch(n.toUpperCase()){case"MMDDYY":return`${a}${i}${o}`;case"YYMMDD":return`${o}${a}${i}`;default:return`${i}${a}${o}`}}async copyImagesToTradeFolder(r,n,i){}formatDateForFrontmatter(r){try{let n=r instanceof Date?r:new Date(r);if(isNaN(n.getTime()))return console.error(`Invalid date value: ${r}, returning as-is`),String(r);let i=n.getFullYear(),a=String(n.getMonth()+1).padStart(2,"0"),o=String(n.getDate()).padStart(2,"0"),s=String(n.getHours()).padStart(2,"0"),l=String(n.getMinutes()).padStart(2,"0"),c=String(n.getSeconds()).padStart(2,"0");return`${i}-${a}-${o}T${s}:${l}:${c}`}catch(n){return console.error(`Error formatting date: ${r}`,n),r instanceof Date?r.toISOString():String(r)}}formatThesisForYAML(r){if(!r||r.trim()==="")return'""';let n=r.trim();return n.includes(`
`)?`|
    ${n.replace(/\n/g,`
    `)}`:/[:|>[\]{}*&!%@`]/.test(n)||n.startsWith('"')||n.startsWith("'")||n.endsWith('"')||n.endsWith("'")||n.match(/^\s/)||n.match(/\s$/)?`"${n.replace(/"/g,'\\"')}"`:n}}});var GP,N0e=F(()=>{Tm();Ns();_t();Jn();qt();Tr();hW();GP=class extends ts{constructor(r,n={}){super(r,{cacheTTL:120*1e3,persistCache:!0,namespace:n.namespace||"accountPage",...n});this.folderPathService=null;this.forceFreshNextLoad=!1;let i=()=>{this.clearCache(),this.forceFreshNextLoad=!0};this.unsubscribeTradeChanged=xe.subscribe("trade:changed",i),this.unsubscribeMissedTradeChanged=xe.subscribe("missed-trade:changed",i)}setPlugin(r){var n;super.setPlugin(r),this.folderPathService=((n=r.serviceManager)==null?void 0:n.getFolderPathService())||null}safeParseDate(r){if(r instanceof Date&&!isNaN(r.getTime()))return r;if(r!=null&&r!=="")try{let n=new Date(r);if(!isNaN(n.getTime()))return n}catch(n){}return null}getAccountMetadata(r){var a,o;if(!((o=(a=this.plugin)==null?void 0:a.settings.account)!=null&&o.accountMetadata))return;let n=this.plugin.settings.account.accountMetadata[r];if(!n){console.log(`AccountPageService.getAccountMetadata: No metadata found for "${r}"`);return}return{...n,createdDate:n.createdDate instanceof Date?n.createdDate:this.safeParseDate(n.createdDate)||new Date,profitTargetDate:n.profitTargetDate?n.profitTargetDate instanceof Date?n.profitTargetDate:this.safeParseDate(n.profitTargetDate)||void 0:void 0,lastUpdated:n.lastUpdated instanceof Date?n.lastUpdated:this.safeParseDate(n.lastUpdated)||new Date,manualTransactions:n.manualTransactions?n.manualTransactions.filter(s=>s!=null).map(s=>{let l=s.date instanceof Date?s.date:this.safeParseDate(s.date);return!l||isNaN(l.getTime())?(console.warn("AccountPageService: Skipping transaction with invalid date:",s),null):{...s,date:l}}).filter(s=>!(s==null||typeof s.id!="string"||!s.id||!(s.date instanceof Date)||typeof s.type!="string"||!s.type||typeof s.amount!="number"||isNaN(s.amount)||typeof s.balanceAfter!="number"||isNaN(s.balanceAfter))):void 0,manualDrawdownSnapshots:n.manualDrawdownSnapshots?n.manualDrawdownSnapshots.filter(s=>s!=null).map(s=>{let l=s.date instanceof Date?s.date:this.safeParseDate(s.date);return!l||isNaN(l.getTime())?(console.warn("AccountPageService: Skipping snapshot with invalid date:",s),null):{...s,date:l}}).filter(s=>!(s==null||!(s.date instanceof Date)||typeof s.drawdownLimit!="number"||isNaN(s.drawdownLimit))):void 0}}async saveAccountMetadata(r,n){var i,a;if(!((i=this.plugin)!=null&&i.settings.account)){if(!((a=this.plugin)!=null&&a.settings))throw new Error("Plugin settings not initialized - cannot save account metadata");this.plugin.settings.account={defaultAccountType:"demo",defaultDrawdownType:"none",defaultDrawdownAmount:0,showBalanceInDashboard:!0,excludedAccountTypes:["archived"],includeWithdrawalsFromExcluded:{archived:!0,demo:!1},accountTypeOrder:["funded","evaluation","demo","archived"],accountMetadata:{}}}this.plugin.settings.account.accountMetadata||(this.plugin.settings.account.accountMetadata={}),this.plugin.settings.account.accountMetadata[r]=n,await this.plugin.saveSettings()}createAccountDataFromTrades(r,n,i){let a=n.filter(u=>!yt({tradeStatus:u.tradeStatus,exitTime:u.exitTime,pnl:u._originalPnlWasNull?null:u.pnl,useDirectPnLInput:u.useDirectPnLInput,exits:u.exits,entries:u.entries})),o=this.calculateAccountMetrics(a),s=(i==null?void 0:i.initialBalance)||this.estimateInitialBalance(n),l=(i==null?void 0:i.createdDate)||this.estimateCreationDate(n),c=s+o.totalPnL,d={id:`account-${r.replace(/[^a-zA-Z0-9]/g,"-")}`,name:r,accountType:(i==null?void 0:i.accountType)||"demo",initialBalance:s,currentBalance:c,drawdownType:(i==null?void 0:i.drawdownType)||"none",drawdownAmount:(i==null?void 0:i.drawdownAmount)||0,maxDrawdownReached:c<s?c:s,hasProfitTarget:(i==null?void 0:i.hasProfitTarget)||!1,profitTarget:(i==null?void 0:i.profitTarget)||0,profitTargetType:(i==null?void 0:i.profitTargetType)||"absolute",profitTargetDate:i==null?void 0:i.profitTargetDate,monthlyCost:(i==null?void 0:i.monthlyCost)||0,createdDate:l,lastUpdated:new Date,metrics:{totalTrades:o.totalTrades,winningTrades:o.winningTrades,losingTrades:o.losingTrades,breakEvenTrades:o.totalTrades-o.winningTrades-o.losingTrades,winRate:o.winRate,totalPnL:o.totalPnL,bestTrade:n.length>0?Math.max(...n.map(u=>u.pnl)):0,worstTrade:n.length>0?Math.min(...n.map(u=>u.pnl)):0,profitFactor:o.profitFactor,averageWin:o.avgWin,averageLoss:o.avgLoss,maxDrawdown:s-(c<s?c:s),totalWithdrawals:0},transactions:[],dailyBalances:[],notePath:""};if(i!=null&&i.manualDrawdownSnapshots&&d.drawdownType==="manual"){let u=new Date,p=i.manualDrawdownSnapshots.filter(m=>m&&m.date).filter(m=>{let g=m.date instanceof Date?m.date:this.safeParseDate(m.date);return g&&!isNaN(g.getTime())&&g<=u&&m.drawdownLimit>0}).sort((m,g)=>{let f=m.date instanceof Date?m.date:this.safeParseDate(m.date),v=g.date instanceof Date?g.date:this.safeParseDate(g.date);return((v==null?void 0:v.getTime())||0)-((f==null?void 0:f.getTime())||0)})[0];if(p){let m=p.date instanceof Date?p.date:this.safeParseDate(p.date);d.currentDrawdownSnapshot={date:new Date(m||new Date),drawdownLimit:p.drawdownLimit,note:p.note}}}return i!=null&&i.manualDrawdownSnapshots&&d.drawdownType==="manual"&&(d.allDrawdownSnapshots=[...i.manualDrawdownSnapshots].filter(u=>u&&u.date).filter(u=>{let p=u.date instanceof Date?u.date:this.safeParseDate(u.date);return p&&!isNaN(p.getTime())}).sort((u,p)=>{let m=u.date instanceof Date?u.date:this.safeParseDate(u.date),g=p.date instanceof Date?p.date:this.safeParseDate(p.date);return((m==null?void 0:m.getTime())||0)-((g==null?void 0:g.getTime())||0)})),d}estimateCreationDate(r){if(r.length===0)return new Date;let n=r.reduce((a,o)=>{let s=o.entryTime instanceof Date?o.entryTime:this.safeParseDate(o.entryTime),l=a.entryTime instanceof Date?a.entryTime:this.safeParseDate(a.entryTime);return s?l?s<l?o:a:o:a}),i=n.entryTime instanceof Date&&!isNaN(n.entryTime.getTime())?new Date(n.entryTime):this.safeParseDate(n.entryTime);if(!i||isNaN(i.getTime())){let a=new Date;return a.setMonth(0,1),a.setHours(0,0,0,0),console.warn("AccountPageService: Could not determine account creation date, using fallback"),a}return i.setDate(i.getDate()-1),i.setHours(0,0,0,0),i}async getAccountPageData(r){let n=`accountPage:${r}`,i=this.forceFreshNextLoad;this.forceFreshNextLoad=!1;try{return await this.query(async()=>{var m,g,f,v;if(!((m=this.plugin)!=null&&m.tradeService)){let h=0;for(;!((g=this.plugin)!=null&&g.tradeService)&&h<3;)await new Promise(y=>setTimeout(y,300)),h++;if(!((f=this.plugin)!=null&&f.tradeService))throw new Error("TradeService not available after retries - services may still be initializing")}let a=await this.getAccountTrades(r),o=this.getAccountMetadata(r);if(a.length===0&&!o)return null;let s=this.createAccountDataFromTrades(r,a,o),l=await this.tryConvertTrades(a),c=(v=l==null?void 0:l.trades)!=null?v:a,d=c.filter(h=>!yt({tradeStatus:h.tradeStatus,exitTime:h.exitTime,pnl:h._originalPnlWasNull?null:h.pnl,useDirectPnLInput:h.useDirectPnLInput,exits:h.exits,entries:h.entries})),u=this.calculateAccountMetrics(d);return l&&(u.isMultiCurrency=!0,u.convertedTotalPnL=u.totalPnL,u.conversionBaseCurrency=l.baseCurrency,u.conversionRateDate=l.rateDate,u.unconvertedCurrencies=l.unconvertedCurrencies.length>0?l.unconvertedCurrencies:void 0,l.originalTradeCount!==l.convertedTradeCount&&(u.originalTradeCount=l.originalTradeCount,u.convertedTradeCount=l.convertedTradeCount)),{account:await this.enhanceAccountWithTransactions(s,c,u),trades:a,metrics:u}},n,{offlineCapable:!0,useIndexes:!i})}catch(a){return console.error(`Error getting account page data for ${r}:`,a),null}}async getAccountTrades(r){let n=`accountTrades:${r}`,i=this.forceFreshNextLoad;this.forceFreshNextLoad=!1;try{return await this.query(async()=>{var p,m,g;let a=[],o=0,s=5;for(;o<s;){if(!((p=this.plugin)!=null&&p.tradeService)){await new Promise(b=>setTimeout(b,300)),o++;continue}await this.plugin.tradeService.clearCache(),await new Promise(b=>setTimeout(b,300));try{let b=this.plugin.app.vault.adapter;if(b&&b.list){let k=((m=this.folderPathService)==null?void 0:m.journalFolderPath)||"!Journalit";await b.list(k).catch(()=>{})}}catch(b){}let f=new Date("2000-01-01"),v=new Date("2099-12-31"),h=await this.plugin.tradeService.getTrades(f,v);a=[];for(let b of h){let k=await this.plugin.tradeService.extractTradeData(b);if(k){let x=((g=this.plugin.app.metadataCache.getFileCache(b))==null?void 0:g.frontmatter)||{},S=x.pnl===null||x.pnl===void 0;a.push({...k,path:b.path,_originalPnlWasNull:S})}}let y=a.filter(b=>b.path&&b.path.trim()!=="");if(a.length>0&&y.length===0){await new Promise(b=>setTimeout(b,500)),o++;continue}o>0&&await this.clearCache();break}if(o>=s)throw new Error(`TradeService failed to load properly after ${s} attempts`);let d=a.filter(f=>{let v=h=>h?Array.isArray(h)?h.includes(r):typeof h=="string"?h===r:!1:!1;return v(f.account)||v(f.accountIds)}).filter((f,v)=>f.entryTime!==null&&f.entryTime!==void 0&&f.entryTime!==""?this.safeParseDate(f.entryTime)?f.exitTime!==null&&f.exitTime!==void 0&&f.exitTime!==""&&!this.safeParseDate(f.exitTime)?(console.warn(`AccountPageService: Skipping trade (${f.path}) - unparseable exit time`),!1):!0:(console.warn(`AccountPageService: Skipping trade (${f.path}) - unparseable entry time`),!1):(console.warn(`AccountPageService: Skipping trade (${f.path}) - missing entry time`),!1)).map(f=>{let v=this.safeParseDate(f.entryTime),h=f.exitTime?this.safeParseDate(f.exitTime):null;return{path:f.path||"",instrument:f.instrument||"Unknown",direction:f.direction||(f.assetType==="options"&&f.optionType?f.optionType:"Unknown"),entryPrice:parseFloat(f.entryPrice)||0,exitPrice:h&&parseFloat(f.exitPrice)||0,positionSize:parseFloat(f.positionSize)||0,pnl:h&&parseFloat(f.pnl)||0,commission:parseFloat(f.commission)||0,swap:parseFloat(f.swap)||0,fees:parseFloat(f.fees)||0,rebate:f.rebate!=null&&f.rebate!==""?parseFloat(f.rebate):void 0,entryTime:v,exitTime:h,setup:f.setup||[],mistake:f.mistake||[],tags:f.customTags||[],reviewed:f.reviewed||!1,assetType:f.assetType,optionType:f.optionType,rMultiple:f.rMultiple!==void 0&&f.rMultiple!==null?parseFloat(f.rMultiple):void 0,riskAmount:f.riskAmount!==void 0?parseFloat(f.riskAmount):void 0,currency:f.currency}});if(d.filter(f=>!f.path||f.path.trim()==="").length>0)throw new Error(`Refusing to cache trades without paths for account "${r}". This prevents UI issues.`);return d},n,{offlineCapable:!0,useIndexes:!i})}catch(a){return console.error(`Error getting trades for account ${r}:`,a),[]}}calculateAccountMetrics(r){var z,A,I,L,E,T,$,_,B,W,N,U,j,R;if(r.length===0)return{totalTrades:0,winningTrades:0,losingTrades:0,winRate:0,totalPnL:0,avgWin:0,avgLoss:0,avgWinRMultiple:void 0,avgLossRMultiple:void 0,profitFactor:0,totalCommission:0,totalSwap:0,totalFees:0,pnlByCurrency:void 0,isMultiCurrency:!1,primaryCurrency:((I=(A=(z=this.plugin)==null?void 0:z.settings)==null?void 0:A.general)==null?void 0:I.currency)||"USD"};let n=r.length,i=r.reduce((O,H)=>O+H.commission,0),a=r.reduce((O,H)=>O+H.swap,0),o=r.reduce((O,H)=>O+H.fees,0),s=r.reduce((O,H)=>{var q;return O+((q=H.pnl)!=null?q:0)},0),l={},c=((T=(E=(L=this.plugin)==null?void 0:L.settings)==null?void 0:E.general)==null?void 0:T.currency)||"USD";for(let O of r){let H=O.currency||c;l[H]=(l[H]||0)+(($=O.pnl)!=null?$:0)}let d=Object.keys(l).sort(),u=d.length>1,p=d[0]||c,m=(B=(_=this.plugin)==null?void 0:_.settings.trade.breakEvenRangeMin)!=null?B:0,g=(N=(W=this.plugin)==null?void 0:W.settings.trade.breakEvenRangeMax)!=null?N:0,f=r.filter(O=>{var H;return((H=O.pnl)!=null?H:0)>g}),v=r.filter(O=>{var H;return((H=O.pnl)!=null?H:0)<m}),h=n>0?f.length/n*100:0,y=f.reduce((O,H)=>{var q;return O+((q=H.pnl)!=null?q:0)},0),b=Math.abs(v.reduce((O,H)=>{var q;return O+((q=H.pnl)!=null?q:0)},0)),k=f.length>0?y/f.length:0,x=v.length>0?b/v.length:0,S=(R=(j=(U=this.plugin)==null?void 0:U.settings)==null?void 0:j.trade)==null?void 0:R.defaultRiskAmount,w=f.map(O=>xt(O.pnl,O.rMultiple,O.riskAmount,S)).filter(O=>O!==void 0),C=w.length>0?w.reduce((O,H)=>O+H,0)/w.length:void 0,D=v.map(O=>xt(O.pnl,O.rMultiple,O.riskAmount,S)).filter(O=>O!==void 0),P=D.length>0?D.reduce((O,H)=>O+Math.abs(H),0)/D.length:void 0,M=0;return b>0?M=y/b:y>0?M=999:M=0,{totalTrades:n,winningTrades:f.length,losingTrades:v.length,winRate:h,totalPnL:s,avgWin:k,avgLoss:x,avgWinRMultiple:C,avgLossRMultiple:P,profitFactor:M,totalCommission:i,totalSwap:a,totalFees:o,pnlByCurrency:l,isMultiCurrency:u,primaryCurrency:p}}async tryConvertTrades(r){var o,s;if(!this.plugin)return null;let n=((s=(o=this.plugin.settings)==null?void 0:o.general)==null?void 0:s.currency)||"USD",i=new Set;for(let l of r)i.add(l.currency||n);return i.size<=1?null:new hy(this.plugin).convertTrades(r,n)}async getAccountTradesInRange(r,n,i){return(await this.getAccountTrades(r)).filter(o=>{let s=o.entryTime;return s>=n&&s<=i})}async getAccountInstruments(r){let n=await this.getAccountTrades(r);return[...new Set(n.map(a=>a.instrument))].filter(Boolean)}async getAccountSetups(r){let n=await this.getAccountTrades(r);return[...new Set(n.flatMap(a=>a.setup))].filter(Boolean)}estimateInitialBalance(r){if(r.length===0)return 1e4;let n=Math.max(...r.map(a=>Math.abs(a.positionSize)));if(n>0){let a=n*50,o=r.reduce((c,d)=>{var u;return c+((u=d.pnl)!=null?u:0)},0),s=1e4;o>0?s=Math.max(5e3,a):s=Math.max(1e4,a-o);let l=Math.max(a,s);return Math.min(1e6,Math.max(1e3,l))}let i=r.reduce((a,o)=>a+o.pnl,0);return i<-5e3?Math.abs(i)+1e4:i>5e3?Math.max(5e3,i*.5):1e4}async enhanceAccountWithTransactions(r,n,i){var b;let a={...r,currentDrawdownSnapshot:r.currentDrawdownSnapshot?{date:new Date(r.currentDrawdownSnapshot.date),drawdownLimit:r.currentDrawdownSnapshot.drawdownLimit,note:r.currentDrawdownSnapshot.note}:void 0},o=!1;if(r.transactions&&r.transactions.length>0){let k=r.transactions.find(x=>x.type==="deposit"&&x.description==="Initial deposit");if(k){let x=new Date(r.createdDate),S=new Date(k.date);Math.abs(x.getTime()-S.getTime())/(1e3*60*60*24)>2&&(o=!0)}}if(r.transactions&&r.transactions.length>1&&!o){let k=r.transactions.map(M=>{let z=M.date instanceof Date?M.date:this.safeParseDate(M.date);return z?{...M,date:z}:(console.warn("AccountPageService: Skipping existing transaction with invalid date:",M),null)}).filter(M=>M!==null),x=this.getAccountMetadata(r.name);if(x!=null&&x.manualTransactions){let M=new Set(r.transactions.map(A=>A.id)),z=x.manualTransactions.filter(A=>!M.has(A.id)).map(A=>{let I=A.date instanceof Date?A.date:this.safeParseDate(A.date);return I?{...A,date:I}:(console.warn("AccountPageService: Skipping manual transaction with invalid date:",A),null)}).filter(A=>A!==null);k.push(...z)}let S=k.sort((M,z)=>new Date(M.date).getTime()-new Date(z.date).getTime()),w=0;for(let M of S)w+=M.amount,M.balanceAfter=w;a.transactions=S,a.currentBalance=w;let C={totalTrades:i.totalTrades,winningTrades:i.winningTrades,losingTrades:i.losingTrades,breakEvenTrades:i.totalTrades-i.winningTrades-i.losingTrades,winRate:i.winRate,totalPnL:i.totalPnL,bestTrade:n.length>0?Math.max(...n.map(M=>M.pnl)):0,worstTrade:n.length>0?Math.min(...n.map(M=>M.pnl)):0,profitFactor:i.profitFactor,averageWin:i.avgWin,averageLoss:i.avgLoss,maxDrawdown:r.maxDrawdownReached?r.initialBalance-r.maxDrawdownReached:0,totalWithdrawals:S.filter(M=>M.type==="withdrawal"||M.type==="deposit"&&M.amount<0).reduce((M,z)=>M+Math.abs(z.amount),0),isMultiCurrency:i.isMultiCurrency,conversionBaseCurrency:i.conversionBaseCurrency};a.metrics=C;let D=[];if(S.length>0){let M=new Map;for(let A of S){let I=new Date(A.date),L=To(I),E=I.getFullYear();if(E<1970||E>2100){console.warn(`AccountPageService: Skipping existing transaction with corrupted date ${L} - year ${E} outside valid range`);continue}M.set(L,A.balanceAfter)}let z=Array.from(M.keys()).sort();for(let A of z){let I=M.get(A),L=r.initialBalance||0,E=Math.max(0,L-I);D.push({date:new Date(A),balance:I,drawdownLevel:E})}}let P=new Map;for(let M of D){let z=To(M.date);P.set(z,M)}return a.dailyBalances=Array.from(P.values()).sort((M,z)=>M.date.getTime()-z.date.getTime()),a}let s=[],l=this.getAccountMetadata(r.name),c=l!=null&&l.manualTransactions?l.manualTransactions.map(k=>{let x=k.date instanceof Date?k.date:this.safeParseDate(k.date);return x?{...k,date:x,balanceAfter:0}:(console.warn("AccountPageService: Skipping manual transaction with invalid date:",k),null)}).filter(k=>k!==null):[],d=c.some(k=>k.type==="deposit"&&k.description==="Initial deposit");if((!r.transactions||r.transactions.length===0||o)&&!d){let k=new Date(r.createdDate);k.setHours(0,0,0,0),s.push({id:`${r.id}-initial`,date:k,type:"deposit",amount:r.initialBalance,description:"Initial deposit",balanceAfter:0})}else!o&&r.transactions&&r.transactions.length>0&&s.push(...r.transactions);s.push(...c);let p=n.filter(k=>k.exitTime!==null&&k.exitTime!==void 0).map(k=>{let x=k.entryTime instanceof Date?k.entryTime:this.safeParseDate(k.entryTime),S=k.exitTime instanceof Date?k.exitTime:this.safeParseDate(k.exitTime);if(!x||!S)return console.warn(`AccountPageService: Skipping trade (${k.path}) - invalid dates`),null;let w=x.getFullYear(),C=S.getFullYear();return w<1970||w>2100||C<1970||C>2100?(console.warn(`AccountPageService: Skipping trade with corrupted dates (${k.path}) - year ${w}/${C} outside valid range`),null):{...k,entryTime:x,exitTime:S}}).filter(k=>k!==null);for(let k of p)s.push({id:`${r.id}-trade-${k.path.replace(/[^a-zA-Z0-9]/g,"-")}`,date:k.exitTime,type:"trade",amount:(b=k.pnl)!=null?b:0,description:`Trade P&L: ${k.path}`,tradeId:k.path,balanceAfter:0});let m=s.sort((k,x)=>new Date(k.date).getTime()-new Date(x.date).getTime()),g=0,f=m.findIndex(k=>k.type==="deposit"&&k.description==="Initial deposit");if(f>=0)for(let k=0;k<m.length;k++){let x=m[k];k===f?(g=r.initialBalance,x.balanceAfter=g):k<f?(k<=2&&console.warn(`AccountPageService: ${m.length-f} transactions before initial deposit (showing first few)`),g+=x.amount,x.balanceAfter=g):(g+=x.amount,x.balanceAfter=g)}else{console.warn("AccountPageService: No initial deposit found, using zero-based balance calculation");for(let k of m)g+=k.amount,k.balanceAfter=g}a.transactions=m,a.currentBalance=g;let v={totalTrades:i.totalTrades,winningTrades:i.winningTrades,losingTrades:i.losingTrades,breakEvenTrades:i.totalTrades-i.winningTrades-i.losingTrades,winRate:i.winRate,totalPnL:i.totalPnL,bestTrade:n.length>0?Math.max(...n.map(k=>k.pnl)):0,worstTrade:n.length>0?Math.min(...n.map(k=>k.pnl)):0,profitFactor:i.profitFactor,averageWin:i.avgWin,averageLoss:i.avgLoss,maxDrawdown:r.maxDrawdownReached?r.initialBalance-r.maxDrawdownReached:0,totalWithdrawals:m.filter(k=>k.type==="withdrawal"||k.type==="deposit"&&k.amount<0).reduce((k,x)=>k+Math.abs(x.amount),0),isMultiCurrency:i.isMultiCurrency,conversionBaseCurrency:i.conversionBaseCurrency};a.metrics=v;let h=[];if(s.length>0){let k=[...s].sort((w,C)=>new Date(w.date).getTime()-new Date(C.date).getTime()),x=new Map;for(let w of k){let C=new Date(w.date),D=To(C),P=C.getFullYear();if(P<1970||P>2100){console.warn(`AccountPageService: Skipping transaction with corrupted date ${D} - year ${P} outside valid range`);continue}x.set(D,w.balanceAfter)}let S=Array.from(x.keys()).sort();for(let w of S){let C=x.get(w),D=r.initialBalance||0,P=Math.max(0,D-C);h.push({date:new Date(w),balance:C,drawdownLevel:P})}}let y=new Map;for(let k of h){let x=To(k.date);y.set(x,k)}return a.dailyBalances=Array.from(y.values()).sort((k,x)=>k.date.getTime()-x.date.getTime()),a}async refreshAccountData(r){var n;await this.clearCacheWithPrefix(`accountPage:${r}`),await this.clearCacheWithPrefix(`accountTrades:${r}`),await this.clearCacheWithPrefix("allEnhancedAccounts"),(n=this.plugin)!=null&&n.tradeService&&await this.plugin.tradeService.clearCache()}async getAllEnhancedAccounts(){let r="allEnhancedAccounts",n=this.forceFreshNextLoad;this.forceFreshNextLoad=!1;try{return await this.query(async()=>{var l,c,d,u,p;if(!((l=this.plugin)!=null&&l.tradeService)){let m=0;for(;!((c=this.plugin)!=null&&c.tradeService)&&m<3;)await new Promise(g=>setTimeout(g,300)),m++;if(!((d=this.plugin)!=null&&d.tradeService))throw new Error("TradeService not available after retries - services may still be initializing")}let i=await this.plugin.tradeService.getUniqueAccounts(),a=Object.keys(((p=(u=this.plugin)==null?void 0:u.settings.account)==null?void 0:p.accountMetadata)||{}),o=[...new Set([...i,...a])];return await Promise.all(o.map(async m=>{var g;try{let f=await this.getAccountTrades(m),v=this.getAccountMetadata(m),h=this.createAccountDataFromTrades(m,f,v),y=await this.tryConvertTrades(f),b=(g=y==null?void 0:y.trades)!=null?g:f,k=b.filter(w=>!yt({tradeStatus:w.tradeStatus,exitTime:w.exitTime,pnl:w._originalPnlWasNull?null:w.pnl,useDirectPnLInput:w.useDirectPnLInput,exits:w.exits,entries:w.entries})),x=this.calculateAccountMetrics(k);return y&&(x.isMultiCurrency=!0,x.convertedTotalPnL=x.totalPnL,x.conversionBaseCurrency=y.baseCurrency,x.conversionRateDate=y.rateDate),await this.enhanceAccountWithTransactions(h,b,x)}catch(f){console.warn(`Failed to enhance account ${m}:`,f);let v=this.getAccountMetadata(m);return this.createAccountDataFromTrades(m,[],v)}}))},r,{offlineCapable:!0,useIndexes:!n})}catch(i){return console.error("Error getting all enhanced accounts:",i),[]}}getCachedAccountNames(){return[]}async updateAccountMetadata(r,n){var a,o,s,l,c,d,u,p,m,g,f,v,h;if(!((a=this.plugin)!=null&&a.settings))throw new Error("Plugin not initialized - cannot update account metadata");let i=this.getAccountMetadata(r);try{let y=this.getAccountMetadata(r),b=await this.getAccountTrades(r),k={name:r,accountType:(s=(o=n.accountType)!=null?o:y==null?void 0:y.accountType)!=null?s:"demo",createdDate:(c=(l=n.createdDate)!=null?l:y==null?void 0:y.createdDate)!=null?c:this.estimateCreationDate(b),initialBalance:(u=(d=n.initialBalance)!=null?d:y==null?void 0:y.initialBalance)!=null?u:this.estimateInitialBalance(b),drawdownType:n.drawdownType!==void 0?n.drawdownType:(y==null?void 0:y.drawdownType)||"none",drawdownAmount:n.drawdownAmount!==void 0?n.drawdownAmount:(y==null?void 0:y.drawdownAmount)||0,hasProfitTarget:n.hasProfitTarget!==void 0?n.hasProfitTarget:(y==null?void 0:y.hasProfitTarget)||!1,profitTarget:n.profitTarget!==void 0?n.profitTarget:(y==null?void 0:y.profitTarget)||0,profitTargetType:(m=(p=n.profitTargetType)!=null?p:y==null?void 0:y.profitTargetType)!=null?m:"absolute",profitTargetDate:n.profitTargetDate!==void 0?n.profitTargetDate:y==null?void 0:y.profitTargetDate,monthlyCost:n.monthlyCost!==void 0?n.monthlyCost:(y==null?void 0:y.monthlyCost)||0,manualTransactions:n.manualTransactions!==void 0?n.manualTransactions:(y==null?void 0:y.manualTransactions)||[],manualDrawdownSnapshots:n.manualDrawdownSnapshots!==void 0?n.manualDrawdownSnapshots:(y==null?void 0:y.manualDrawdownSnapshots)||[],lastUpdated:new Date};await this.saveAccountMetadata(r,k),await this.refreshAccountData(r)}catch(y){console.error("Failed to save account metadata, rolling back:",y),i&&((f=(g=this.plugin)==null?void 0:g.settings.account)!=null&&f.accountMetadata)?this.plugin.settings.account.accountMetadata[r]=i:(h=(v=this.plugin)==null?void 0:v.settings.account)!=null&&h.accountMetadata&&delete this.plugin.settings.account.accountMetadata[r];try{await this.plugin.saveSettings()}catch(b){console.error("Failed to persist rollback to disk:",b)}try{await this.refreshAccountData(r)}catch(b){console.error("Failed to refresh cache after rollback:",b)}throw y}}async cleanCorruptedMetadata(){var i,a,o;if(!((o=(a=(i=this.plugin)==null?void 0:i.settings)==null?void 0:a.account)!=null&&o.accountMetadata))return console.log("No account metadata to clean"),{accountsCleaned:0,entriesRemoved:0};let r=0,n=0;for(let[s,l]of Object.entries(this.plugin.settings.account.accountMetadata)){let c=!1,d=0,u=0;if(l.manualDrawdownSnapshots&&Array.isArray(l.manualDrawdownSnapshots)){d+=l.manualDrawdownSnapshots.length;let p=l.manualDrawdownSnapshots.filter(m=>{if(!m||!m.date)return!1;let g=this.safeParseDate(m.date);return!g||isNaN(g.getTime())?(console.warn(`Removing corrupted snapshot from ${s}:`,m),!1):!0});u+=p.length,p.length!==l.manualDrawdownSnapshots.length&&(l.manualDrawdownSnapshots=p,c=!0)}if(l.manualTransactions&&Array.isArray(l.manualTransactions)){d+=l.manualTransactions.length;let p=l.manualTransactions.filter(m=>{if(!m||!m.date)return!1;let g=this.safeParseDate(m.date);return!g||isNaN(g.getTime())?(console.warn(`Removing corrupted transaction from ${s}:`,m),!1):!0});u+=p.length,p.length!==l.manualTransactions.length&&(l.manualTransactions=p,c=!0)}c&&(r++,n+=d-u,console.log(`Cleaned ${d-u} corrupted entries from account "${s}"`))}return r>0?(await this.plugin.saveSettings(),console.log(`Metadata recovery complete: ${r} accounts cleaned, ${n} corrupted entries removed`)):console.log("No corrupted metadata found"),{accountsCleaned:r,entriesRemoved:n}}async deleteAccount(r){var s,l,c;if(!this.plugin)throw new Error("Plugin not initialized");if((l=(s=this.plugin.settings.account)==null?void 0:s.accountMetadata)!=null&&l[r]&&(delete this.plugin.settings.account.accountMetadata[r],await this.plugin.saveSettings()),!this.plugin.tradeService)throw new Error("TradeService not available");let a=this.app.vault.getFiles().filter(d=>{var m,g;if(!d.path.endsWith(".md"))return!1;let u=(m=this.app.metadataCache.getFileCache(d))==null?void 0:m.frontmatter;if(u!=null&&u.isMissedTrade)return!1;if((u==null?void 0:u.type)==="trade")return!0;let p=((g=this.folderPathService)==null?void 0:g.journalFolderPath)||"!Journalit";return d.path.includes("/trades/")&&d.path.includes(`/${p}/`)}),o=`account/${this.formatTagForYAML(r)}`;for(let d of a)try{await this.app.fileManager.processFrontMatter(d,u=>{let p=!1;if(u.account&&Array.isArray(u.account)){let m=u.account.length;u.account=u.account.filter(g=>g&&g.trim()&&g.trim()!==r),u.account.length!==m&&(p=!0),u.account.length===0&&delete u.account}if(u.accountIds&&Array.isArray(u.accountIds)){let m=u.accountIds.length;u.accountIds=u.accountIds.filter(g=>g&&g.trim()&&g.trim()!==r),u.accountIds.length!==m&&(p=!0),u.accountIds.length===0&&delete u.accountIds}if(u.tags&&Array.isArray(u.tags)){let m=u.tags.length;u.tags=u.tags.filter(g=>g&&g.trim()&&g.trim()!==o),u.tags.length!==m&&(p=!0)}p&&console.debug(`Updated trade note references for deleted account: ${r}`)})}catch(u){console.error(`Error updating trade file ${d.path} during account deletion:`,u)}await this.clearCacheWithPrefix("allEnhancedAccounts"),await this.clearCacheWithPrefix("accountPage:"),await this.clearCacheWithPrefix("accountTrades:"),(c=this.plugin)!=null&&c.tradeService&&(await this.plugin.tradeService.clearCacheWithPrefix("trade:unique-accounts"),await this.plugin.tradeService.clearCacheWithPrefix("trade:unique-values")),console.log(`Account "${r}" has been successfully deleted and all references removed`)}formatTagForYAML(r){return r.trim().replace(/\s+/g,"-").toLowerCase().replace(/[^a-z0-9-]/g,"")}async refreshAllAccountData(){var r;await this.clearCacheWithPrefix("allEnhancedAccounts"),await this.clearCacheWithPrefix("accountPage:"),await this.clearCacheWithPrefix("accountTrades:"),(r=this.plugin)!=null&&r.tradeService&&await this.plugin.tradeService.clearCache()}async addManualDeposit(r,n,i,a){if(n<=0)throw new Error("Deposit amount must be positive");let s={id:this.generateTransactionId(),date:new Date(i),type:"deposit",amount:n,description:a||"Manual deposit",balanceAfter:0};await this.addManualTransaction(r,s)}async addManualWithdrawal(r,n,i,a){if(n<=0)throw new Error("Withdrawal amount must be positive");let s={id:this.generateTransactionId(),date:new Date(i),type:"withdrawal",amount:-n,description:a||"Manual withdrawal",balanceAfter:0};await this.addManualTransaction(r,s)}async updateManualTransaction(r,n,i){let a=this.getAccountMetadata(r);if(!(a!=null&&a.manualTransactions))throw new Error("No manual transactions found for this account");let o=a.manualTransactions.findIndex(c=>c.id===n);if(o===-1)throw new Error("Transaction not found");let s=a.manualTransactions[o],l={...s,...i,date:i.date?new Date(i.date):s.date,balanceAfter:0};if(i.amount!==void 0){if(s.type==="deposit"&&i.amount<=0)throw new Error("Deposit amount must be positive");if(s.type==="withdrawal"&&i.amount<=0)throw new Error("Withdrawal amount must be positive");s.type==="withdrawal"&&(l.amount=-Math.abs(i.amount))}a.manualTransactions[o]=l,await this.saveAccountMetadata(r,{...a,lastUpdated:new Date}),await this.refreshAccountData(r)}async deleteManualTransaction(r,n){let i=this.getAccountMetadata(r);if(!(i!=null&&i.manualTransactions))throw new Error("No manual transactions found for this account");let a=i.manualTransactions.findIndex(o=>o.id===n);if(a===-1)throw new Error("Transaction not found");i.manualTransactions.splice(a,1),await this.saveAccountMetadata(r,{...i,lastUpdated:new Date}),await this.refreshAccountData(r)}getManualTransactions(r){let n=this.getAccountMetadata(r);return(n==null?void 0:n.manualTransactions)||[]}async addManualTransaction(r,n){let i=this.getAccountMetadata(r)||{name:r,accountType:"demo",createdDate:new Date,initialBalance:1e4,drawdownType:"none",drawdownAmount:0,hasProfitTarget:!1,profitTarget:0,profitTargetType:"absolute",monthlyCost:0,lastUpdated:new Date};i.manualTransactions||(i.manualTransactions=[]),i.manualTransactions.push(n),i.lastUpdated=new Date,await this.saveAccountMetadata(r,i),await this.refreshAccountData(r)}generateTransactionId(){return`manual-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}destroy(){this.unsubscribeTradeChanged&&this.unsubscribeTradeChanged(),this.unsubscribeMissedTradeChanged&&this.unsubscribeMissedTradeChanged()}}});var F0e=F(()=>{N0e()});var O0e={};Ti(O0e,{ServiceManager:()=>Jb});var Jb,YO=F(()=>{o0e();d0e();u0e();lV();UF();f0e();g0e();h0e();v0e();y0e();b0e();rh();x0e();D0e();M0e();A0e();L0e();F0e();qO();Jb=class e{constructor(t,r){this._authManager=null;this._tradeService=null;this._folderPathService=null;this._setupService=null;this._drcService=null;this._weeklyReviewService=null;this._monthlyReviewService=null;this._quarterlyReviewService=null;this._yearlyReviewService=null;this._optionsService=null;this._customFieldsService=null;this._missedTradeService=null;this._backtestTradeService=null;this._backendIntegrationService=null;this._onboardingService=null;this._accountPageService=null;this.initializedServices=new Set;this.serviceInitQueue=new Map;this.app=t,this.plugin=r}static getInstance(t,r){return e.instance||(e.instance=new e(t,r)),e.instance}async getServiceByName(t){switch(t){case"authManager":return await this.getAuthManager();case"tradeService":return await this.getTradeService();case"setupService":return await this.getSetupService();case"drcService":return await this.getDRCService();case"weeklyReviewService":return await this.getWeeklyReviewService();case"monthlyReviewService":return await this.getMonthlyReviewService();case"quarterlyReviewService":return await this.getQuarterlyReviewService();case"yearlyReviewService":return await this.getYearlyReviewService();case"optionsService":return await this.getOptionsService();case"customFieldsService":return await this.getCustomFieldsService();case"missedTradeService":return await this.getMissedTradeService();case"backtestTradeService":return await this.getBacktestTradeService();case"accountPageService":return await this.getAccountPageService();case"backendIntegrationService":return await this.getBackendIntegrationService();case"onboardingService":return await this.getOnboardingService();case"folderPathService":return await this.getFolderPathService();default:let r=t;throw new Error(`Unknown service: ${r}`)}}async initializeCoreServices(){this._authManager=new gk(this.app,sV()),this.initializedServices.add("authManager");let t=".journalit/cache/trade-cache.json",r=".journalit/indexes";try{await this.app.vault.adapter.remove(t)}catch(i){i&&typeof i=="object"&&"code"in i&&i.code==="ENOENT"||console.warn("Failed to delete trade cache:",i)}try{let i=await this.app.vault.adapter.list(r);if(i&&i.files)for(let a of i.files)try{await this.app.vault.adapter.remove(a)}catch(o){o&&typeof o=="object"&&"code"in o&&o.code!=="ENOENT"&&console.warn(`Failed to delete index file ${a}:`,o)}}catch(i){i&&typeof i=="object"&&"code"in i&&i.code==="ENOENT"||console.warn("Failed to delete index files:",i)}let n=this.getFolderPathService();this._tradeService=new WP(this.app,n,{namespace:"trade"}),this._tradeService.setPlugin(this.plugin),this.initializedServices.add("tradeService"),this._customFieldsService=new WO(this.plugin),this.initializedServices.add("customFieldsService"),this._optionsService=new Go(this.plugin,{namespace:"options"}),this.initializedServices.add("optionsService")}async initializeRemainingServices(){await bP([async()=>await this.getSetupService(),async()=>await this.getDRCService(),async()=>await this.getWeeklyReviewService(),async()=>await this.getMonthlyReviewService(),async()=>await this.getQuarterlyReviewService(),async()=>await this.getAccountPageService()],50)}getAuthManager(){return this._authManager||(this._authManager=new gk(this.app,sV()),this.initializedServices.add("authManager")),this._authManager}getTradeService(){if(!this._tradeService){let t=this.getFolderPathService();this._tradeService=new WP(this.app,t,{namespace:"trade"}),this._tradeService.setPlugin(this.plugin),this.initializedServices.add("tradeService")}return this._tradeService}getFolderPathService(){return this._folderPathService||(this._folderPathService=new pv(this.app,this.plugin),this.initializedServices.add("folderPathService")),this._folderPathService}async getSetupService(){if(this._setupService)return this._setupService;let t=this.serviceInitQueue.get("setupService");if(t)return t;let r=(async()=>{let n=this.getTradeService(),i=await wl(()=>new LO(this.app,n,{namespace:"setup"}),"SetupService");return i.setPlugin(this.plugin),this._setupService=i,this.initializedServices.add("setupService"),this.serviceInitQueue.delete("setupService"),i})();return this.serviceInitQueue.set("setupService",r),r}async getDRCService(){if(this._drcService)return this._drcService;let t=this.serviceInitQueue.get("drcService");if(t)return t;let r=(async()=>{let n=this.getFolderPathService(),i=await wl(()=>new FO(this.app,this.plugin,n,{namespace:"drc"}),"DRCService");return this._drcService=i,this.initializedServices.add("drcService"),this.serviceInitQueue.delete("drcService"),i})();return this.serviceInitQueue.set("drcService",r),r}async getWeeklyReviewService(){if(this._weeklyReviewService)return this._weeklyReviewService;let t=this.serviceInitQueue.get("weeklyReviewService");if(t)return t;let r=(async()=>{let n=this.getFolderPathService(),i=await wl(()=>new OO(this.app,this.plugin,n),"WeeklyReviewService");return this._weeklyReviewService=i,this.initializedServices.add("weeklyReviewService"),this.serviceInitQueue.delete("weeklyReviewService"),i})();return this.serviceInitQueue.set("weeklyReviewService",r),r}async getMissedTradeService(){if(this._missedTradeService)return this._missedTradeService;let t=this.serviceInitQueue.get("missedTradeService");if(t)return t;let r=(async()=>{let n=await wl(()=>new VO(this.app,this.plugin,{namespace:"missed-trade"}),"MissedTradeService");return n.setPlugin(this.plugin),this._missedTradeService=n,this.initializedServices.add("missedTradeService"),this.serviceInitQueue.delete("missedTradeService"),n})();return this.serviceInitQueue.set("missedTradeService",r),r}async getBacktestTradeService(){if(this._backtestTradeService)return this._backtestTradeService;let t=this.serviceInitQueue.get("backtestTradeService");if(t)return t;let r=(async()=>{let n=await wl(()=>new GO(this.app,this.plugin,{namespace:"backtest-trade"}),"BacktestTradeService");return n.setPlugin(this.plugin),this._backtestTradeService=n,this.initializedServices.add("backtestTradeService"),this.serviceInitQueue.delete("backtestTradeService"),n})();return this.serviceInitQueue.set("backtestTradeService",r),r}async getMonthlyReviewService(){if(this._monthlyReviewService)return this._monthlyReviewService;let t=this.serviceInitQueue.get("monthlyReviewService");if(t)return t;let r=(async()=>{let n=this.getFolderPathService(),i=await wl(()=>new jO(this.app,this.plugin,n,{namespace:"monthly"}),"MonthlyReviewService");return i.setPlugin(this.plugin),this._monthlyReviewService=i,this.initializedServices.add("monthlyReviewService"),this.serviceInitQueue.delete("monthlyReviewService"),i})();return this.serviceInitQueue.set("monthlyReviewService",r),r}async getQuarterlyReviewService(){if(this._quarterlyReviewService)return this._quarterlyReviewService;let t=this.serviceInitQueue.get("quarterlyReviewService");if(t)return t;let r=(async()=>{let n=this.getFolderPathService(),i=await wl(()=>new _O(this.app,this.plugin,n,{namespace:"quarterly"}),"QuarterlyReviewService");return i.setPlugin(this.plugin),this._quarterlyReviewService=i,this.initializedServices.add("quarterlyReviewService"),this.serviceInitQueue.delete("quarterlyReviewService"),i})();return this.serviceInitQueue.set("quarterlyReviewService",r),r}async getYearlyReviewService(){if(this._yearlyReviewService)return this._yearlyReviewService;let t=this.serviceInitQueue.get("yearlyReviewService");if(t)return t;let r=(async()=>{let n=this.getFolderPathService(),i=await wl(()=>new BO(this.app,this.plugin,n,{namespace:"yearly"}),"YearlyReviewService");return i.setPlugin(this.plugin),this._yearlyReviewService=i,this.initializedServices.add("yearlyReviewService"),this.serviceInitQueue.delete("yearlyReviewService"),i})();return this.serviceInitQueue.set("yearlyReviewService",r),r}async getOptionsService(){return this.getOptionsServiceSync()}getCustomFieldsService(){if(!this._customFieldsService)throw new Error("CustomFieldsService not initialized. Make sure initializeCoreServices() was called.");return this._customFieldsService}getOptionsServiceSync(){if(!this._optionsService)throw new Error("CustomOptionsService not initialized. Make sure initializeCoreServices() was called.");return this._optionsService}isServiceInitialized(t){return this.initializedServices.has(t)}isServiceInitializing(t){return this.serviceInitQueue.has(t)}async getAccountPageService(){if(this._accountPageService)return this._accountPageService;let t=this.serviceInitQueue.get("accountPageService");if(t)return t;let r=(async()=>{let n=await wl(()=>{let i=new GP(this.app);return i.setPlugin(this.plugin),i},"AccountPageService");return this._accountPageService=n,this.initializedServices.add("accountPageService"),this.serviceInitQueue.delete("accountPageService"),n})();return this.serviceInitQueue.set("accountPageService",r),r}async getBackendIntegrationService(){if(this._backendIntegrationService)return this._backendIntegrationService;let t=this.serviceInitQueue.get("backendIntegrationService");if(t)return t;let r=(async()=>{let n=await wl(()=>new HP(this.plugin),"BackendIntegrationService");return this._backendIntegrationService=n,this.initializedServices.add("backendIntegrationService"),this.serviceInitQueue.delete("backendIntegrationService"),n})();return this.serviceInitQueue.set("backendIntegrationService",r),r}async getOnboardingService(){if(this._onboardingService)return this._onboardingService;let t=this.serviceInitQueue.get("onboardingService");if(t)return t;let r=(async()=>{let n=await wl(()=>new VP(this.app,this.plugin),"OnboardingService");return await n.initialize(),this._onboardingService=n,this.initializedServices.add("onboardingService"),this.serviceInitQueue.delete("onboardingService"),n})();return this.serviceInitQueue.set("onboardingService",r),r}preInitializeServices(t){t.length!==0&&RF(()=>{let r=t.map(n=>async()=>{switch(n){case"setupService":await this.getSetupService();break;case"drcService":await this.getDRCService();break;case"weeklyReviewService":await this.getWeeklyReviewService();break;case"monthlyReviewService":await this.getMonthlyReviewService();break;case"quarterlyReviewService":await this.getQuarterlyReviewService();break;case"accountPageService":await this.getAccountPageService();break;case"onboardingService":await this.getOnboardingService();break;case"backtestTradeService":await this.getBacktestTradeService();break}});bP(r,100)})}cleanupServices(){this._tradeService&&(this._tradeService.cleanup(),this._tradeService=null),this._setupService&&(this._setupService.cleanup(),this._setupService=null),this._monthlyReviewService&&(this._monthlyReviewService.cleanup(),this._monthlyReviewService=null),this._quarterlyReviewService&&(this._quarterlyReviewService.cleanup(),this._quarterlyReviewService=null),this._yearlyReviewService&&(this._yearlyReviewService.cleanup(),this._yearlyReviewService=null),this._missedTradeService&&(this._missedTradeService.cleanup(),this._missedTradeService=null),this._backtestTradeService&&(this._backtestTradeService.cleanup(),this._backtestTradeService=null),this._accountPageService&&(this._accountPageService.cleanup(),this._accountPageService.destroy(),this._accountPageService=null);try{let t=(Tm(),hd(a0e)).CustomDataService;t.sharedIndexManager&&(t.sharedIndexManager.unload(),t.sharedIndexManager=null)}catch(t){console.error("Error cleaning up CustomDataService:",t)}this._authManager=null,this._drcService=null,this._weeklyReviewService=null,this._optionsService=null,this._customFieldsService=null,this._backendIntegrationService&&(this._backendIntegrationService.cleanup(),this._backendIntegrationService=null),this._onboardingService&&(this._onboardingService.onunload(),this._onboardingService=null),this.initializedServices.clear(),this.serviceInitQueue.clear()}}});var ar,gV,hV,r9e,vV=F(()=>{ar=Y(Q()),gV=require("obsidian");rl();nr();Zs();Eq();Iq();Mq();Lq();iB();bf();Oa();xM();Jn();hV=ar.default.memo(({data:e,onEditClick:t})=>{var x,S,w,C,D,P,M,z,A,I,L,E,T,$,_,B,W,N,U,j,R;let[r,n]=(0,ar.useState)(e.filePath||"unknown"),[i,a]=(0,ar.useState)({reviewed:e.reviewed,reviewedAt:e.reviewedAt}),[o,s]=(0,ar.useState)(0);Xe("trade-template:changed",()=>{s(O=>O+1)}),(0,ar.useEffect)(()=>{a({reviewed:e.reviewed,reviewedAt:e.reviewedAt})},[e.reviewed,e.reviewedAt]);let l=(0,ar.useRef)(null),{metrics:c,formatDate:d,formatTime:u}=PP({data:e}),p=Ae(),m=p?qX({plugin:p,initialData:e.lossReview,onUpdate:async O=>{if(p!=null&&p.tradeService&&r&&r!=="unknown")try{await p.tradeService.updateLossReview(r,O,"user-input")}catch(H){console.error("[TradeNote] Error updating loss review:",H)}}}):{settings:{enabled:!1,sections:[]},updateLossReview:()=>{}},{updateLossReview:g}=m,f=ar.default.useMemo(()=>{var O;if(!p)return null;try{let H=new il(p);if(e.templateId){let V=H.getTemplate(e.templateId);if(V)return V}let q=(O=p.settings.templates)==null?void 0:O.defaultTrade;if(q){let V=H.getTemplate(q);if(V)return V}return H.getDefaultTemplate()}catch(H){return console.error("[TradeNote] Error loading trade template:",H),null}},[p,e.templateId,o]),v=ar.default.useMemo(()=>{var V,J,K,G,X,te,re,Z,ne,se,ee,ie,ve;let O=(K=(J=(V=f==null?void 0:f.sections)==null?void 0:V.review)==null?void 0:J.show)!=null?K:"losses-only",H=c.pnl<0,q;return O==="always"?q=H?((X=(G=f==null?void 0:f.sections)==null?void 0:G.review)==null?void 0:X.lossSections)||((re=(te=f==null?void 0:f.sections)==null?void 0:te.review)==null?void 0:re.sections)||[]:((ne=(Z=f==null?void 0:f.sections)==null?void 0:Z.review)==null?void 0:ne.winSections)||((ee=(se=f==null?void 0:f.sections)==null?void 0:se.review)==null?void 0:ee.sections)||[]:q=((ve=(ie=f==null?void 0:f.sections)==null?void 0:ie.review)==null?void 0:ve.sections)||[],{enabled:O!=="never"&&q.length>0,sections:q.map(Se=>({id:Se.id,title:Se.title,type:Se.type,content:Se.content,items:Se.items,placeholder:Se.placeholder}))}},[f,c.pnl]);(0,ar.useEffect)(()=>{if(sh(),l.current){l.current.classList.add("trade-note-mounted"),l.current.setAttribute("data-mounted-at",Date.now().toString());let O=l.current.closest(".journalit-trade-view");O&&O.classList.add("trade-note-mounted")}},[]);let h=(0,ar.useCallback)(O=>{if(l.current=O,O&&(!r||r==="unknown")){let H=O.getAttribute("data-displaying-file");if(H){n(H);return}let q=O.parentElement;for(;q;){let V=q.getAttribute("data-displaying-file")||q.getAttribute("data-file-path");if(V){n(V);break}q=q.parentElement}}},[r]),y=async O=>{if(!(p!=null&&p.viewManager)){console.error("Cannot navigate to account: ViewManager not available");return}try{let H=O;if(p.accountPageService)try{let V=(await p.accountPageService.getAllEnhancedAccounts()).find(J=>J.id===O||J.name===O);V&&V.name&&(H=V.name)}catch(q){console.warn("Could not resolve account via AccountPageService, using provided value:",q)}await p.viewManager.openAccountPageView(H)}catch(H){console.error("Error navigating to account page:",H)}},b=(0,ar.useCallback)(()=>{t&&t(e)},[e,t]),k=(0,ar.useCallback)(async()=>{if(p!=null&&p.tradeService&&r&&r!=="unknown"){let O=new Date().toISOString();a({reviewed:!0,reviewedAt:O});try{await p.tradeService.updateTradeReviewStatus(r,!0,O,"user-input")}catch(H){console.error("[TradeNote] Error updating review status:",H),a({reviewed:e.reviewed,reviewedAt:e.reviewedAt})}}},[p,r,e.reviewed,e.reviewedAt]);return ar.default.createElement("div",{className:"trade-note-container",ref:h,"data-file-path":r,style:{margin:0}},ar.default.createElement(CP,{instrument:e.instrument,direction:e.direction,isProfit:c.isProfit,isBreakeven:c.isBreakeven,pnl:c.pnl,percentChange:c.percentChange,useDirectPnLInput:e.useDirectPnLInput,isMissedTrade:e.isMissedTrade,isBacktestTrade:e.isBacktestTrade,exitTime:e.exitTime,exitPrice:e.exitPrice,tradeStatus:e.tradeStatus,exits:e.exits,assetType:e.assetType,optionType:e.optionType,rMultiple:e.rMultiple,displayRMultiples:(w=(S=(x=p==null?void 0:p.settings)==null?void 0:x.trade)==null?void 0:S.displayRMultiples)!=null?w:!1,riskAmount:e.riskAmount,currency:e.currency}),((D=(C=f==null?void 0:f.sections)==null?void 0:C.navigation)==null?void 0:D.show)!==!1&&(e.entryTime||e.useDirectPnLInput)&&ar.default.createElement(r9e,{data:e,filePath:r,onEditClick:t,handleEditClick:b}),ar.default.createElement("div",{className:"trade-note-content"},((M=(P=f==null?void 0:f.sections)==null?void 0:P.images)==null?void 0:M.show)!==!1&&ar.default.createElement(kP,{images:e.images,onEditClick:b}),((A=(z=f==null?void 0:f.sections)==null?void 0:z.metadata)==null?void 0:A.show)!==!1&&ar.default.createElement(SP,{data:e,onAccountClick:y,config:(I=f==null?void 0:f.sections)==null?void 0:I.metadata}),((E=(L=f==null?void 0:f.sections)==null?void 0:L.details)==null?void 0:E.show)!==!1&&ar.default.createElement(TP,{data:e,metrics:c,formatDate:d,formatTime:u,onEditClick:b,displayRMultiples:(_=($=(T=p==null?void 0:p.settings)==null?void 0:T.trade)==null?void 0:$.displayRMultiples)!=null?_:!1,defaultRiskAmount:(N=(W=(B=p==null?void 0:p.settings)==null?void 0:B.trade)==null?void 0:W.defaultRiskAmount)!=null?N:0,config:(U=f==null?void 0:f.sections)==null?void 0:U.details}),(()=>{var q,V,J,K,G,X;let O=(J=(V=(q=f==null?void 0:f.sections)==null?void 0:q.review)==null?void 0:V.show)!=null?J:"losses-only";return O==="never"||e.isBacktestTrade&&!((X=(G=(K=f==null?void 0:f.sections)==null?void 0:K.review)==null?void 0:G.showForBacktest)!=null?X:!1)?!1:O==="always"?!yt({tradeStatus:e.tradeStatus,exitTime:e.exitTime,pnl:e.pnl,useDirectPnLInput:e.useDirectPnLInput,exits:e.exits,entries:e.entries}):!yt({tradeStatus:e.tradeStatus,exitTime:e.exitTime,pnl:e.pnl,useDirectPnLInput:e.useDirectPnLInput,exits:e.exits,entries:e.entries})&&c.pnl<0})()&&ar.default.createElement(DP,{settings:v,data:e.lossReview,onUpdate:g,filePath:r}),((R=(j=f==null?void 0:f.sections)==null?void 0:j.reviewButton)==null?void 0:R.show)!==!1&&ar.default.createElement("div",{className:"trade-note-review-section"},ar.default.createElement(bM,{reviewed:i.reviewed,reviewedAt:i.reviewedAt,onMarkReviewed:k}))))},(e,t)=>e.data.pnl===t.data.pnl&&e.data.entryTime===t.data.entryTime&&e.data.exitTime===t.data.exitTime&&e.data.instrument===t.data.instrument&&e.data.direction===t.data.direction&&e.data.commission===t.data.commission&&e.data.swap===t.data.swap&&e.data.fees===t.data.fees&&e.data.templateId===t.data.templateId&&JSON.stringify(e.data.images)===JSON.stringify(t.data.images)&&JSON.stringify(e.data.lossReview)===JSON.stringify(t.data.lossReview)&&e.onEditClick===t.onEditClick),r9e=ar.default.memo(({data:e,filePath:t,onEditClick:r,handleEditClick:n})=>{let i=Ae(),[a,o]=(0,ar.useState)([]),[s,l]=(0,ar.useState)([]),[c,d]=(0,ar.useState)(!1),[u,p]=(0,ar.useState)(!1),[m,g]=(0,ar.useState)(0),f=ar.default.useMemo(()=>{if(e.entryTime)return new Date(e.entryTime);if(e.useDirectPnLInput){let D=t.match(/(\d{2})(\d{2})(\d{2})-T\d+\.md$/);if(D){let[,P,M,z]=D,A=2e3+parseInt(z,10);return new Date(A,parseInt(M,10)-1,parseInt(P,10))}return new Date}return null},[e.entryTime,e.useDirectPnLInput,t]),v=ar.default.useMemo(()=>{if(!f||!i)return null;let{start:D,end:P}=II(f,i);return{startDate:D,endDate:P}},[f,i]),h=ar.default.useMemo(()=>!f||!i?"":mc(f,i),[f,i]),y=ar.default.useRef(null);(0,ar.useEffect)(()=>{let D=y.current;if(!D)return;let P=new IntersectionObserver(M=>{let[z]=M;z.isIntersecting&&(p(!0),P.disconnect())},{rootMargin:"50px",threshold:.1});return P.observe(D),()=>P.disconnect()},[]);let b=(0,ar.useCallback)(D=>{let{action:P}=D;(P==="created"||P==="updated"||P==="relocated")&&h&&setTimeout(()=>{Object.keys(sessionStorage).forEach(M=>{M.startsWith("trade-nav-")&&sessionStorage.removeItem(M)}),o([]),l([]),d(!1),g(M=>M+1)},200)},[h]);Xe("trade:changed",b),Xe("missed-trade:changed",b),Xe("backtest-trade:changed",b),(0,ar.useEffect)(()=>{if(!u||!v||!(i!=null&&i.tradeService)||!h)return;let D=!0;return(async()=>{try{let M=sessionStorage.getItem(`trade-nav-${h}`);if(M){let z=JSON.parse(M);if(D){let A=[],I=[];Array.isArray(z)?A=z:z&&typeof z=="object"&&(A=z.trades||[],I=z.missedTrades||[]);let L=A.map(B=>{let W=i.app.vault.getAbstractFileByPath(B);return W instanceof gV.TFile?W:null}).filter(B=>B!==null),E=I.map(B=>{let W=i.app.vault.getAbstractFileByPath(B);return W instanceof gV.TFile?W:null}).filter(B=>B!==null),T=[...A,...I],$=T.includes(t);if(i.app.vault.getAbstractFileByPath(t)&&!$||L.length===0&&E.length===0&&T.length>0)sessionStorage.removeItem(`trade-nav-${h}`);else{o(L),l(E);return}}}if(c)return;d(!0),setTimeout(async()=>{var z;try{let A=await i.tradeService.getTrades(v.startDate,v.endDate),I=[];try{(z=i.missedTradeService)!=null&&z.getMissedTrades&&(I=await i.missedTradeService.getMissedTrades(v.startDate,v.endDate))}catch(L){console.warn("[TradeNote] Failed to fetch missed trades:",L)}if(D){o(A),l(I);try{let L=A.map(T=>T.path),E=I.map(T=>T.path);sessionStorage.setItem(`trade-nav-${h}`,JSON.stringify({trades:L,missedTrades:E}))}catch(L){console.warn("Error caching trades:",L)}}}catch(A){console.error("Error fetching trades for day:",A)}finally{D&&d(!1)}},100)}catch(M){console.error("Error in trade fetch setup:",M),D&&d(!1)}})(),()=>{D=!1}},[u,v,i==null?void 0:i.tradeService,h,i,m]);let k=(0,ar.useCallback)((D,P=!1)=>{try{i&&i.openFile?i.openFile(D,P):i!=null&&i.app?i.app.workspace.openLinkText(D,"",P):console.error("Cannot navigate: Plugin and App context not available.")}catch(M){console.error("Navigation error:",M)}},[i]),x=(0,ar.useCallback)(D=>i!=null&&i.drcService?i.drcService.getDRCNotePath(D):"",[i==null?void 0:i.drcService]),S=(0,ar.useCallback)(D=>i!=null&&i.weeklyReviewService?i.weeklyReviewService.getWeeklyReviewPath(D):"",[i==null?void 0:i.weeklyReviewService]),w=(0,ar.useCallback)(D=>i!=null&&i.drcService?i.drcService.getMonthlyReviewPath(D):null,[i==null?void 0:i.drcService]),C=(0,ar.useCallback)(D=>{var M;let P=(M=i==null?void 0:i.serviceManager)==null?void 0:M.getFolderPathService();return P?P.getYearlyReviewPath(D.getFullYear()):null},[i==null?void 0:i.serviceManager]);return!f||!(i!=null&&i.drcService)||!(i!=null&&i.weeklyReviewService)?null:ar.default.createElement("div",{ref:y},u?ar.default.createElement(ar.default.Fragment,null,ar.default.createElement(tO,{currentDate:f,trades:a,missedTrades:s,currentTradePath:t,navigateTo:k,getDRCPath:x,getWeeklyReviewPath:S,getMonthlyReviewPath:w,getYearlyReviewPath:C,onEditClick:r,handleEditClick:n})):ar.default.createElement("div",{style:{height:"60px",display:"flex",alignItems:"center",justifyContent:"center"}},ar.default.createElement("div",{style:{color:"var(--text-muted)",fontSize:"12px"}},"Loading navigation...")))})});var z0e,YP,yV=F(()=>{z0e=Y(Q());vV();nO();rl();av();bf();YP=class extends iv{constructor(t){super(t)}renderComponent(t,r,n,i,a){t.querySelector(".trade-note-container.trade-note-mounted")||this.renderTradeNote(t,r,n,i,a)}renderTradeNote(t,r,n,i,a){var o,s;try{if(sh(),!t||!t.isConnected){console.error(`[TradeNote] Cannot render into disconnected container for ${n}`);return}let l=a?`${n}-${i}-${a}`:`${n}-${i}`,c=i.startsWith("leaf-")?i.substring(5):i,d=this.processTradeData(r);if(this.currentTemplateConfig=void 0,r.templateId){let h=(s=(o=window.app)==null?void 0:o.plugins)==null?void 0:s.plugins.journalit;if(h){let y=new il(h);this.currentTemplateConfig=y.getTemplate(r.templateId)}}t.setAttribute("data-displaying-file",n);let u=this.findContainingLeaf(t),p=t.querySelector(".journalit-trade-note-wrapper");if(p){if(p.querySelector(".trade-note-mounted"))return;p.remove()}let m=null;if(u&&u.view){let h=u.view.containerEl;h&&h.id&&(m=h.id)}let g=this.reactRoots.get(l);if(g&&g.domContainer&&g.domContainer.isConnected&&g.domContainer.querySelector(".trade-note-mounted"))return;t.empty();let f=this.reactRoots.get(l);if(f&&(u&&m&&f.leafId!==m||a&&f.domContainer&&f.domContainer.getAttribute("data-context-id")!==a)){let h=a?`${n}-context-${a}`:`${n}-${i}-${m}`;if(f=this.reactRoots.get(h),!f){this.createReactRoot(t,h,m||void 0,a,d,n);return}}if(!f)this.createReactRoot(t,l,m||void 0,a,d,n);else{let h=f.domContainer;t.contains(h)?f.root.render(this.createReactElement(d,n)):this.createReactRoot(t,l,m||void 0,a,d,n)}}catch(l){console.error("[TradeNote] Error rendering trade note:",l),t.setText("Error rendering trade note: "+(l instanceof Error?l.message:String(l)))}}getComponentClassName(){return"journalit-trade-view"}getWrapperClassName(){return"journalit-trade-note-wrapper"}createReactElement(t,r,n){let i=o=>{var l,c;let s=(c=(l=window.app)==null?void 0:l.plugins)==null?void 0:c.plugins.journalit;if(!s){console.error("Cannot access plugin instance for edit action");return}if(s.openTradeFormInEditMode){try{let d=document.activeElement;d&&typeof d.blur=="function"&&d.blur();let u=document.querySelector(".cm-editor");u&&typeof u.blur=="function"&&u.blur()}catch(d){}try{requestAnimationFrame(()=>{setTimeout(()=>{try{s.openTradeFormInEditMode(o,r)}catch(d){console.error("Failed to open trade form in edit mode:",d)}},0)})}catch(d){try{s.openTradeFormInEditMode(o,r)}catch(u){console.error(u)}}}else console.warn("Edit mode not available - plugin method missing")},a=async o=>{var l,c;let s=(c=(l=window.app)==null?void 0:l.plugins)==null?void 0:c.plugins.journalit;if(!s||!s.tradeService){console.error("Cannot access plugin instance for data update");return}try{await s.tradeService.updateTrade(o,r,"user-input")}catch(d){console.error("[TradeNote] Error updating trade data:",d)}};return z0e.default.createElement(hV,{data:{...t,filePath:r},onEditClick:i,onDataUpdate:a})}unmountTradeNote(t,r,n,i){return this.unmountComponent(t,r,n)}unmountAllTradeNotes(){this.unmountAllComponents()}unmountLeafTradeNotes(t){this.unmountLeafComponents(t)}processTradeData(t){var n,i;let r={...t};t.images,t.images&&(r.images=this.normalizeImagePaths(t.images)),["setupIds","mistakeIds","accountIds","setup","mistake","account","tags","customTags"].forEach(a=>{if(r[a]&&!Array.isArray(r[a]))if(typeof r[a]=="string"&&r[a].startsWith("[")&&r[a].endsWith("]"))try{let o=r[a].slice(1,-1).trim();o?r[a]=o.split(",").map(s=>s.trim()):r[a]=[]}catch(o){console.error(`[TradeNote] Failed to parse array string: ${a}`,o),r[a]=[r[a]]}else r[a]=[r[a]]}),r.tags&&Array.isArray(r.tags)&&(r.customTags=r.tags),t.entries&&Array.isArray(t.entries)&&(r.entries=t.entries.map(a=>({time:a.time?new Date(a.time):null,price:parseFloat(a.price)||0,size:parseFloat(a.size)||0,notional:a.notional!==void 0?parseFloat(a.notional):void 0}))),t.exits&&Array.isArray(t.exits)&&(r.exits=t.exits.map(a=>({time:a.time?new Date(a.time):null,price:parseFloat(a.price)||0,size:parseFloat(a.size)||0,notional:a.notional!==void 0?parseFloat(a.notional):void 0}))),["entryTime","exitTime"].forEach(a=>{if(r[a]&&typeof r[a]=="string")try{r[a]=new Date(r[a])}catch(o){console.error(`[TradeNote] Failed to parse date: ${a}`,o)}}),["entryPrice","exitPrice","positionSize","pnl","directPnL","riskAmount","stopLoss"].forEach(a=>{if(r[a]!==void 0&&typeof r[a]!="number")try{r[a]=parseFloat(r[a])}catch(o){console.error(`[TradeNote] Failed to parse number: ${a}`,o)}}),r.pnl!==void 0&&r.pnl!==null&&(r.originalPnl=r.pnl),["useDirectPnLInput"].forEach(a=>{if(r[a]!==void 0&&typeof r[a]!="boolean")try{r[a]=!!r[a]}catch(o){console.error(`[TradeNote] Failed to parse boolean: ${a}`,o)}}),r.thesis=EP(t.thesis)||"";try{let a=(i=(n=window.app)==null?void 0:n.plugins)==null?void 0:i.plugins.journalit;if(a&&a.customFieldsService){let o=a.customFieldsService.getFields(),s={};o.forEach(l=>{let c=l.fieldKey;c&&t[c]!==void 0&&(s[l.id]=t[c])}),Object.keys(s).length>0&&(r.customFields=s)}}catch(a){console.error("[TradeNote] Error reconstructing custom fields:",a)}return r}normalizeImagePaths(t){if(!t)return[];if(Array.isArray(t))return t.map(r=>typeof r!="string"?String(r):r.replace(/['"`]/g,"").trim()).filter(Boolean);if(typeof t=="string"&&t.startsWith("[")&&t.endsWith("]"))try{let r=t.slice(1,-1).trim();return r?r.split(",").map(n=>n.trim().replace(/['"`]/g,"")).filter(Boolean):[]}catch(r){return console.error("[TradeNote] Failed to parse images string:",r),[t.replace(/['"`]/g,"").trim()]}return typeof t=="string"?[t.replace(/['"`]/g,"").trim()]:[]}}});var KO,KP,j0e=F(()=>{KO=require("obsidian");yV();oO();Tr();KP=class extends ov{constructor(r,n){super(r,n,new YP(r));this.unsubscribeTradeListener=null;this.unsubscribeBacktestListener=null;this.observerTimeouts=new Map;this.setupTradeUpdateListener()}isValidComponentType(r){return r&&(r.type==="trade"||r.type==="backtest-trade")}getComponentClassName(){return"journalit-trade-view"}getWrapperClassName(){return"journalit-trade-note-wrapper"}getComponentTypeIdentifier(){return"trade"}async getAdditionalDataForComponent(r,n){return{}}disconnectObserverSafely(r){let n=this.observerTimeouts.get(r);n&&(clearTimeout(n),this.observerTimeouts.delete(r)),r.disconnect();let i=this.activeObservers.indexOf(r);i>-1&&this.activeObservers.splice(i,1)}handleFileOpen(r,n=!1){if(!r)return;this.cleanupOrphanedComponents(),this.cleanupUnrelatedComponents(r.path);let i=this.app.metadataCache.getFileCache(r),a=i==null?void 0:i.frontmatter;if(!a||!this.isValidComponentType(a))return;let o=document.body,s=new MutationObserver((c,d)=>{let u=document.querySelectorAll(".cm-editor");if(u.length===0)return;u.forEach(m=>{var P;let g=m.querySelector(".metadata-container");if(!g)return;let f=g.closest(".workspace-leaf-content");if(!f)return;let v=this.findContainingLeaf(f),h=(P=v==null?void 0:v.view)==null?void 0:P.containerEl,y=g.closest(".workspace-leaf"),k=(y==null?void 0:y.id)||(h==null?void 0:h.id)||null,x=this.getUniqueElementId(m),S=k?`leaf-${k}`:x,w=!0;if(v){let M=v.view,z=null;(M&&"file"in M||M&&"getViewType"in M&&M.getViewType()==="markdown")&&(z=M.file),z&&(w=z.path===r.path)}if(!w)return;let C=this.getComponentClassName();m.querySelectorAll(`.${C}`).forEach(M=>{let z=M.getAttribute("data-file-path");if(z&&z!==r.path){let A=M.getAttribute("data-view-id"),I=M.getAttribute("data-leaf-id");A&&this.renderer.unmountComponent(z,A,I||void 0),M.remove()}});let D=Array.from(m.querySelectorAll(`.${C}`)).find(M=>M.getAttribute("data-file-path")===r.path);D||(D=document.createElement("div"),D.className=C,D.setAttribute("data-file-path",r.path),D.setAttribute("data-view-id",S),D.setAttribute("data-editor-id",x),k&&D.setAttribute("data-leaf-id",k),D.setAttribute("data-inserted-at",Date.now().toString()),g.after(D)),setTimeout(()=>{this.renderer.renderComponent(D,a,r.path,S,x)},500),this.markFileRenderedInMode(r.path,"source")}),d.disconnect();let p=this.activeObservers.indexOf(d);p>-1&&this.activeObservers.splice(p,1)});this.activeObservers.push(s),s.observe(o,{childList:!0,subtree:!0});let l=setTimeout(()=>{this.disconnectObserverSafely(s)},3e3);this.observerTimeouts.set(s,l)}renderAllActiveTradeNotes(){let r=new Set;this.app.workspace.iterateAllLeaves(n=>{try{if(!n.view||!("file"in n.view))return;let i=n.view.file;if(!i||r.has(i.path))return;let a=this.app.metadataCache.getFileCache(i),o=a==null?void 0:a.frontmatter;if(!o||!this.isValidComponentType(o))return;r.add(i.path),setTimeout(()=>{this.handleFileOpen(i,!0)},300)}catch(i){console.error("[TradeNote] Error rendering active trade note at startup:",i)}})}renderActiveComponent(){this.renderActiveTradeNote()}setupTradeUpdateListener(){let r=async n=>{try{let i=[];if(n.filePath&&i.push(n.filePath),"filePaths"in n&&n.filePaths&&i.push(...n.filePaths),i.length===0)return;for(let a of i){let o=this.app.vault.getAbstractFileByPath(a);if(!(o instanceof KO.TFile)){console.warn(`[TradeNote] Cannot find file for path: ${a}`);continue}await this.refreshTradeNote(o)}}catch(i){console.error("[TradeNote] Error handling trade update event:",i)}};this.unsubscribeTradeListener=xe.subscribe("trade:changed",r),this.unsubscribeBacktestListener=xe.subscribe("backtest-trade:changed",r)}async refreshTradeNote(r){try{let{forceMetadataCacheRefresh:n}=await Promise.resolve().then(()=>(Nl(),OX));await n(this.app,r,200);let i=this.app.metadataCache.getFileCache(r),a=(i==null?void 0:i.frontmatter)||{};if(!this.isValidComponentType(a)){console.warn(`[TradeNote] File is not a valid trade note: ${r.path}`);return}this.cleanupDuplicateComponents(r.path);let o=this.getComponentClassName(),s=document.querySelectorAll(`.${o}[data-file-path="${r.path}"]`);if(s.length===0)return;for(let l of Array.from(s)){let c=l,d=c.getAttribute("data-view-id"),u=c.getAttribute("data-markdown-view-id")||c.getAttribute("data-editor-id");d&&(c.querySelectorAll(`.${this.getWrapperClassName()}`).forEach(m=>m.remove()),await new Promise(m=>{setTimeout(()=>{try{this.renderWithDeduplication({file:r,container:c,data:a,viewId:d,contextId:u||void 0,componentClassName:this.getComponentClassName(),mountedClassName:"trade-note-mounted",contentSelector:".trade-note-container"}),m()}catch(g){console.error("[TradeNote] Error during re-render:",g),m()}},50)}))}this.markFileRenderedInMode(r.path,"source"),this.markFileRenderedInMode(r.path,"preview")}catch(n){console.error(`[TradeNote] Error refreshing trade note for ${r.path}:`,n)}}cleanup(){for(let[r,n]of this.observerTimeouts)clearTimeout(n);this.observerTimeouts.clear(),super.cleanup(),this.unsubscribeTradeListener&&(this.unsubscribeTradeListener(),this.unsubscribeTradeListener=null),this.unsubscribeBacktestListener&&(this.unsubscribeBacktestListener(),this.unsubscribeBacktestListener=null)}renderActiveTradeNote(){var m;this.cleanupOrphanedComponents();let r=this.app.workspace.getActiveFile();if(!r)return;let n=this.app.metadataCache.getFileCache(r),i=n==null?void 0:n.frontmatter;if(!i||!this.isValidComponentType(i))return;let a=this.app.workspace.getActiveViewOfType(KO.MarkdownView);if(!a){console.error("[TradeNote] No active markdown view found");return}let o=a.containerEl.closest(".workspace-leaf-content");if(!o){console.error("[TradeNote] Cannot find containing leaf for active view");return}let s=this.findContainingLeaf(o),l=(m=s==null?void 0:s.view)==null?void 0:m.containerEl,c=(l==null?void 0:l.id)||null,d=c?`leaf-${c}`:this.generateViewId(o),u=a.getMode()==="source",p=this.getComponentClassName();if(u){let g=a.containerEl.querySelector(".metadata-container");if(g){let f=Array.from(o.querySelectorAll(`.${p}`)).find(v=>{let h=v.getAttribute("data-file-path")===r.path,y=v.getAttribute("data-view-id")===d,b=!c||v.getAttribute("data-leaf-id")===c;return h&&y&&b});f||(f=document.createElement("div"),f.className=p,f.setAttribute("data-file-path",r.path),f.setAttribute("data-view-id",d),c&&f.setAttribute("data-leaf-id",c),g.after(f)),this.renderer.renderComponent(f,i,r.path,d),this.markFileRenderedInMode(r.path,"source")}}else{let g=a.containerEl.querySelector(".markdown-preview-view");if(g){let f=Array.from(g.querySelectorAll(`.${p}`)).find(v=>{let h=v.getAttribute("data-file-path")===r.path,y=v.getAttribute("data-view-id")===d,b=!c||v.getAttribute("data-leaf-id")===c;return h&&y&&b});f||(f=document.createElement("div"),f.className=p,f.setAttribute("data-file-path",r.path),f.setAttribute("data-view-id",d),c&&f.setAttribute("data-leaf-id",c),g.prepend(f)),this.renderer.renderComponent(f,i,r.path,d),this.markFileRenderedInMode(r.path,"preview")}}}}});var _0e=F(()=>{j0e();yV();vV()});var JP,_r,ro=F(()=>{JP=Y(Q()),_r=JP.default.memo(({widgetType:e,reason:t})=>{let r=`This ${e} widget requires a review or trade note`;return JP.default.createElement("div",{style:{padding:"0.75rem 1rem",margin:"0.5rem 0",background:"var(--background-secondary)",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",color:"var(--text-muted)",fontSize:"0.9em"}},JP.default.createElement("div",{style:{fontWeight:"500",marginBottom:"0.25rem"}},"Invalid Context"),JP.default.createElement("div",{style:{fontSize:"0.85em",opacity:.8}},t||r))})});var dt,JO,n9e,i9e,bk,bV=F(()=>{dt=Y(Q()),JO=require("obsidian");Ot();ro();i0();sM();Op();qi();Dn();_t();n9e=5,i9e=150,bk=dt.default.memo(({filePath:e,plugin:t,preview:r,previewData:n})=>{let[i,a]=(0,dt.useState)(null),[o,s]=(0,dt.useState)(!0),[l,c]=(0,dt.useState)(()=>{var E;let L=(E=t.settings.viewFilters)==null?void 0:E.reviews;return L?{accounts:L.accounts||[],tickers:L.tickers||[],setups:L.setups||[],tags:L.tags||[],tradeTypes:L.tradeTypes||[],statuses:L.statuses||[]}:{accounts:[],tickers:[],setups:[],tags:[],tradeTypes:[],statuses:[]}}),[d,u]=(0,dt.useState)(!1),p=(0,dt.useRef)(0),m=(0,dt.useRef)(null),g=(0,dt.useCallback)(L=>{L.filePath===e&&h()},[e]);Xe("review:changed",g);let f=(0,dt.useCallback)(L=>{L.sourceFilePath!==e&&c(L.filters)},[e]);Xe("review:filter-sync",f),(0,dt.useEffect)(()=>{p.current=0,v();let L=E=>{E.path===e&&(h(),i||v())};return t.app.metadataCache.on("changed",L),()=>{t.app.metadataCache.off("changed",L),m.current!==null&&(clearTimeout(m.current),m.current=null)}},[e,r,n]);let v=async()=>{var j,R,O;if(r&&n){a({type:{drc:"drc",weekly:"weekly-review",monthly:"monthly-review",quarterly:"quarterly-review",yearly:"yearly-review"}[n.reviewType]||"drc",date:n.date,title:n.title,subtitle:void 0}),s(!1);return}let L=t.app.vault.getAbstractFileByPath(e);if(!(L instanceof JO.TFile)){s(!1);return}let E=t.app.metadataCache.getFileCache(L),T=E==null?void 0:E.frontmatter;if(!T){if(p.current<n9e){p.current++,m.current!==null&&clearTimeout(m.current),m.current=setTimeout(()=>v(),i9e);return}console.log("[HeaderWidget] No frontmatter found for:",e,"(after retries)"),s(!1);return}if(!["drc","weekly-review","monthly-review","quarterly-review","yearly-review","trade"].includes(T.type)){console.log("[HeaderWidget] Invalid type:",T.type,"for:",e),s(!1);return}let _=T.type==="trade"?T.entryTime:T.date;if(!_){console.log("[HeaderWidget] Missing date field for:",e,"frontmatter:",T),s(!1);return}let B=ur(_);if(!B){console.log("[HeaderWidget] Invalid date:",_,"for:",e),s(!1);return}let W="",N;switch(T.type){case"drc":W=b(B);break;case"weekly-review":W=k(B,T);break;case"monthly-review":W=S(B,T);break;case"quarterly-review":let H=T.quarter||Math.ceil((B.getMonth()+1)/3),q=T.year||B.getFullYear();W=`Q${H} ${q}`;break;case"yearly-review":W=`${T.year||B.getFullYear()}`;break;case"trade":W=w(T,B),N=C(B);break}a({type:T.type,date:B,title:W,subtitle:N});let U=(j=t.settings.viewFilters)==null?void 0:j.reviews;if(U&&c({accounts:U.accounts||[],tickers:U.tickers||[],setups:U.setups||[],tags:U.tags||[],tradeTypes:U.tradeTypes||[],statuses:U.statuses||[]}),["drc","weekly-review","monthly-review","quarterly-review","yearly-review"].includes(T.type))if(T.type==="drc"){let H=T.endOfDayReview||{};u((R=H.reviewed)!=null?R:!1)}else u((O=T.reviewed)!=null?O:!1);s(!1)},h=()=>{var $,_;let L=t.app.vault.getAbstractFileByPath(e);if(!(L instanceof JO.TFile))return;let E=t.app.metadataCache.getFileCache(L),T=E==null?void 0:E.frontmatter;if(T&&["drc","weekly-review","monthly-review","quarterly-review","yearly-review"].includes(T.type))if(T.type==="drc"){let B=T.endOfDayReview||{};u(($=B.reviewed)!=null?$:!1)}else u((_=T.reviewed)!=null?_:!1)},y=async()=>{var $,_;if(r||!i)return;let L=t.app.vault.getAbstractFileByPath(e);if(!(L instanceof JO.TFile))return;let E=!d,T=E?new Date().toISOString():null;u(E);try{if(i.type==="drc"){let N=t.app.metadataCache.getFileCache(L),U=(($=N==null?void 0:N.frontmatter)==null?void 0:$.endOfDayReview)||{};await t.drcService.updateDRCFrontmatter(e,{endOfDayReview:{...U,reviewed:E,reviewedAt:T}},"user-input")}else i.type==="weekly-review"?await t.weeklyReviewService.updateWeeklyReviewFrontmatter(e,{reviewed:E,reviewedAt:T}):i.type==="monthly-review"?await t.monthlyReviewService.updateMonthlyReviewFrontmatter(e,{reviewed:E,reviewedAt:T}):i.type==="quarterly-review"?await(await t.serviceManager.getQuarterlyReviewService()).updateQuarterlyReviewFrontmatter(e,{reviewed:E,reviewedAt:T}):i.type==="yearly-review"&&await(await t.serviceManager.getYearlyReviewService()).updateYearlyReviewFrontmatter(e,{reviewed:E,reviewedAt:T});let W=(_={drc:"drc","weekly-review":"weekly","monthly-review":"monthly","quarterly-review":"quarterly","yearly-review":"yearly"}[i.type])!=null?_:"drc";xe.publish("review:changed",{action:"updated",type:W,filePath:e})}catch(B){console.error("[HeaderWidget] Failed to toggle reviewed status:",B),u(!E)}},b=L=>{let E=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],T=["January","February","March","April","May","June","July","August","September","October","November","December"],$=E[L.getDay()],_=T[L.getMonth()],B=L.getDate(),W=L.getFullYear();return`${$}, ${_} ${B}, ${W}`},k=(L,E)=>{let T=["January","February","March","April","May","June","July","August","September","October","November","December"],$=E.week||`W${x(L)}`,_=E.year||L.getFullYear(),B=E.month?parseInt(String(E.month),10)-1:L.getMonth(),W=T[B];return`${$} - ${W} ${_}`},x=L=>{let E=new Date(L.valueOf()),T=(L.getDay()+6)%7;E.setDate(E.getDate()-T+3);let $=E.valueOf();return E.setMonth(0,1),E.getDay()!==4&&E.setMonth(0,1+(4-E.getDay()+7)%7),1+Math.ceil(($-E.valueOf())/6048e5)},S=(L,E)=>{let T=["January","February","March","April","May","June","July","August","September","October","November","December"],$=E.month?E.month-1:L.getMonth(),_=T[$],B=E.year||L.getFullYear();return`${_} ${B}`},w=(L,E)=>{let T=L.instrument||"Unknown",$=L.direction||"";return $?`${T} ${$}`:T},C=L=>{let T=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][L.getMonth()],$=L.getDate(),_=L.getFullYear();return`${T} ${$}, ${_}`},D=async L=>{if(!i||r)return;let E=null;try{switch(i.type){case"drc":E=await t.drcService.getAdjacentDRC(i.date,L);break;case"weekly-review":E=await t.weeklyReviewService.getAdjacentWeeklyReview(i.date,L);break;case"monthly-review":E=await t.monthlyReviewService.getAdjacentMonthlyReview(i.date,L);break;case"quarterly-review":E=await(await t.serviceManager.getQuarterlyReviewService()).getAdjacentQuarterlyReview(i.date,L);break;case"yearly-review":E=await(await t.serviceManager.getYearlyReviewService()).getAdjacentYearlyReview(i.date,L);break;case"trade":E=await P(L);break}E&&await t.app.workspace.openLinkText(E,e)}catch(T){console.error("Failed to navigate:",T)}},P=async L=>{let T=(await t.tradeService.getTradeData({fresh:!1})).filter(B=>{if(!B.entryTime)return!1;let W=new Date(B.entryTime);return W.getFullYear()===i.date.getFullYear()&&W.getMonth()===i.date.getMonth()&&W.getDate()===i.date.getDate()});T.sort((B,W)=>{let N=new Date(B.entryTime||0),U=new Date(W.entryTime||0);return N.getTime()-U.getTime()});let $=T.findIndex(B=>B.filePath===e);if($===-1)return null;let _=$+L;return _<0||_>=T.length?null:T[_].filePath||null},M=async(L,E,T)=>{var $;if(!r)try{if(!await t.app.vault.adapter.exists(L)){let B=($=T!=null?T:i==null?void 0:i.date)!=null?$:new Date;switch(E){case"drc":await t.drcService.createDRC(B);break;case"weekly":await t.weeklyReviewService.createWeeklyReview(B);break;case"monthly":await t.monthlyReviewService.createMonthlyReview(B);break;case"quarterly":{await(await t.serviceManager.getQuarterlyReviewService()).createQuarterlyReview(B);break}case"yearly":{await(await t.serviceManager.getYearlyReviewService()).createYearlyReview(B);break}}}await t.app.workspace.openLinkText(L,e)}catch(_){console.error("Failed to open related review:",_)}},z=(0,dt.useCallback)(()=>{t!=null&&t.app&&fy({app:t.app,plugin:t,context:"dashboard",currentFilters:l,onApply:async L=>{c(L),t.settings.viewFilters?t.settings.viewFilters.reviews=L:t.settings.viewFilters={dashboard:{dateRange:[null,null],accounts:[],tickers:[],setups:[],tags:[],tradeTypes:[],statuses:[]},reviews:L},t.settingsManager.getDebouncedSave()(),xe.publish("filter:changed",{filePath:e,filters:L}),xe.publish("review:filter-sync",{sourceFilePath:e,filters:L})},onClose:()=>{}})},[t,l,e]),A=(0,dt.useMemo)(()=>{var L,E,T,$,_,B;return(((L=l.accounts)==null?void 0:L.length)||0)+(((E=l.tickers)==null?void 0:E.length)||0)+(((T=l.setups)==null?void 0:T.length)||0)+((($=l.tags)==null?void 0:$.length)||0)+(((_=l.tradeTypes)==null?void 0:_.length)||0)+(((B=l.statuses)==null?void 0:B.length)||0)},[l]);if(o)return dt.default.createElement("div",{className:"journalit-header-content layout-e"},dt.default.createElement("div",{className:"journalit-header-main"},dt.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"0.6rem"}},dt.default.createElement(ae,{width:200,height:24,borderRadius:"4px"}),dt.default.createElement(_l,{size:20})),dt.default.createElement("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.25rem"}},dt.default.createElement(ae,{width:50,height:14,borderRadius:"4px"}),dt.default.createElement(ae,{width:80,height:14,borderRadius:"4px"}))),dt.default.createElement("div",{className:"journalit-header-subtle-controls",style:{display:"flex",alignItems:"center",gap:"0.75rem"}},dt.default.createElement(ae,{width:28,height:28,borderRadius:"4px"}),dt.default.createElement(ae,{width:45,height:14,borderRadius:"4px"}),dt.default.createElement(ae,{width:45,height:14,borderRadius:"4px"})));if(!i)return dt.default.createElement(_r,{widgetType:"Header",reason:"Invalid frontmatter: requires 'type' (drc/weekly-review/monthly-review/quarterly-review/trade) and date field ('date' for reviews, 'entryTime' for trades)"});let I=()=>{let L=x(i.date),E=i.date.toLocaleDateString("en-US",{month:"long"}),T=i.date.getFullYear().toString(),_=`Q${Math.ceil((i.date.getMonth()+1)/3)}`;switch(i.type){case"drc":return dt.default.createElement(dt.default.Fragment,null,dt.default.createElement("span",{className:`context-link ${r?"disabled":""}`,onClick:()=>{if(r)return;let B=t.weeklyReviewService.getWeeklyReviewPath(i.date);M(B,"weekly")}},"Week ",L),dt.default.createElement("span",{className:"context-separator"},"\xB7"),dt.default.createElement("span",{className:`context-link ${r?"disabled":""}`,onClick:()=>{if(r)return;let B=t.monthlyReviewService.getMonthlyReviewPath(i.date);M(B,"monthly")}},E));case"weekly-review":return dt.default.createElement(dt.default.Fragment,null,dt.default.createElement("span",{className:`context-link ${r?"disabled":""}`,onClick:()=>{if(r)return;let B=t.monthlyReviewService.getMonthlyReviewPath(i.date);M(B,"monthly")}},E),dt.default.createElement("span",{className:"context-separator"},"\xB7"),dt.default.createElement("span",{className:`context-link ${r?"disabled":""}`,onClick:async()=>{if(r)return;let W=await(await t.serviceManager.getQuarterlyReviewService()).getQuarterlyReviewPath(i.date);M(W,"quarterly")}},_),dt.default.createElement("span",{className:"context-separator"},"\xB7"),dt.default.createElement("span",{className:`context-link ${r?"disabled":""}`,onClick:async()=>{if(r)return;let W=await(await t.serviceManager.getYearlyReviewService()).getYearlyReviewPath(i.date);M(W,"yearly")}},T));case"monthly-review":return dt.default.createElement(dt.default.Fragment,null,dt.default.createElement("span",{className:`context-link ${r?"disabled":""}`,onClick:async()=>{if(r)return;let W=await(await t.serviceManager.getQuarterlyReviewService()).getQuarterlyReviewPath(i.date);M(W,"quarterly")}},_),dt.default.createElement("span",{className:"context-separator"},"\xB7"),dt.default.createElement("span",{className:`context-link ${r?"disabled":""}`,onClick:async()=>{if(r)return;let W=await(await t.serviceManager.getYearlyReviewService()).getYearlyReviewPath(i.date);M(W,"yearly")}},T));case"quarterly-review":return dt.default.createElement(dt.default.Fragment,null,dt.default.createElement("span",{className:`context-link ${r?"disabled":""}`,onClick:async()=>{if(r)return;let W=await(await t.serviceManager.getYearlyReviewService()).getYearlyReviewPath(i.date);M(W,"yearly")}},T));case"yearly-review":return dt.default.createElement(dt.default.Fragment,null,[1,2,3,4].map((B,W)=>dt.default.createElement(dt.default.Fragment,{key:B},W>0&&dt.default.createElement("span",{className:"context-separator"},"\xB7"),dt.default.createElement("span",{className:`context-link ${r?"disabled":""}`,onClick:async()=>{if(r)return;let N=await t.serviceManager.getQuarterlyReviewService(),U=new Date(i.date.getFullYear(),(B-1)*3+1,15),j=await N.getQuarterlyReviewPath(U);M(j,"quarterly",U)}},"Q",B))));case"trade":return dt.default.createElement(dt.default.Fragment,null,dt.default.createElement("span",{className:`context-link ${r?"disabled":""}`,onClick:()=>{if(r)return;let B=t.drcService.getDRCNotePath(i.date);M(B,"drc")}},"DRC"),dt.default.createElement("span",{className:"context-separator"},"\xB7"),dt.default.createElement("span",{className:`context-link ${r?"disabled":""}`,onClick:()=>{if(r)return;let B=t.weeklyReviewService.getWeeklyReviewPath(i.date);M(B,"weekly")}},"Week ",L));default:return null}};return dt.default.createElement("div",{className:"journalit-header-content layout-e"},dt.default.createElement("div",{className:"journalit-header-main"},dt.default.createElement("div",{className:"journalit-header-title"},i.title,i.type!=="trade"&&dt.default.createElement("span",{className:"reviewed-indicator clickable-icon","aria-label":d?"Click to mark as not reviewed":"Click to mark as reviewed",onClick:y,style:{display:"inline-flex",alignItems:"center",marginLeft:"0.6rem",verticalAlign:"middle",position:"relative",top:"-0.1em",cursor:r?"default":"pointer",opacity:r?.7:1,transition:"opacity 0.15s ease"},onMouseEnter:L=>{r||(L.currentTarget.style.opacity="0.7")},onMouseLeave:L=>{r||(L.currentTarget.style.opacity="1")}},d?dt.default.createElement(Aa,{size:20,style:{color:"var(--color-green)"}}):dt.default.createElement(Xm,{size:20,style:{color:"var(--text-muted)"}}))),i.subtitle&&dt.default.createElement("div",{className:"journalit-header-subtitle"},i.subtitle),dt.default.createElement("div",{className:"journalit-header-context"},I())),dt.default.createElement("div",{className:"journalit-header-subtle-controls"},i.type!=="trade"&&dt.default.createElement(dh,{onClick:z,activeFilterCount:r?0:A,disabled:r}),dt.default.createElement("span",{className:`nav-link ${r?"disabled":""}`,onClick:()=>!r&&D(-1)},"\u2190 Prev"),dt.default.createElement("span",{className:`nav-link ${r?"disabled":""}`,onClick:()=>!r&&D(1)},"Next \u2192")))});bk.displayName="HeaderWidget"});var Yt,xV,a9e,o9e,QO,s9e,xk,wV=F(()=>{Yt=Y(Q()),xV=require("obsidian");ro();Dn();a9e=5,o9e=150,QO={drc:{goals:"dailyGoals",status:"dailyGoalStatus",label:"Daily Goals"},"weekly-review":{goals:"weeklyGoals",status:"weeklyGoalStatus",label:"Weekly Goals"},"monthly-review":{goals:"monthlyGoals",status:"monthlyGoalStatus",label:"Monthly Goals"},"quarterly-review":{goals:"quarterlyGoals",status:"quarterlyGoalStatus",label:"Quarterly Goals"},"yearly-review":{goals:"yearlyGoals",status:"yearlyGoalStatus",label:"Yearly Goals"}},s9e=Object.keys(QO),xk=Yt.default.memo(({filePath:e,plugin:t,preview:r,previewData:n})=>{let[i,a]=(0,Yt.useState)([]),[o,s]=(0,Yt.useState)(!0),[l,c]=(0,Yt.useState)(null),[d,u]=(0,Yt.useState)(""),[p,m]=(0,Yt.useState)(""),[g,f]=(0,Yt.useState)(!0),[v,h]=(0,Yt.useState)(null),y=(0,Yt.useRef)(null),b=(0,Yt.useRef)(null),k=(0,Yt.useRef)(0),x=(0,Yt.useRef)(!0),S=(0,Yt.useRef)(null);(0,Yt.useEffect)(()=>{if(r&&n){a(n.goals),s(!1),f(!0),x.current=!0;return}k.current=0,w();let B=W=>{W.path===e&&!x.current&&w()};return t.app.metadataCache.on("changed",B),()=>{t.app.metadataCache.off("changed",B),S.current!==null&&(clearTimeout(S.current),S.current=null)}},[e,r,n]),(0,Yt.useEffect)(()=>{l!==null&&y.current&&(y.current.focus(),y.current.select())},[l]);let w=async()=>{let B=t.app.vault.getAbstractFileByPath(e);if(!(B instanceof xV.TFile)){f(!1),x.current=!1,s(!1);return}let W=t.app.metadataCache.getFileCache(B),N=W==null?void 0:W.frontmatter;if(!N){if(k.current<a9e){k.current++,S.current!==null&&clearTimeout(S.current),S.current=setTimeout(()=>w(),o9e);return}f(!1),x.current=!1,s(!1);return}let U=N.type;if(!s9e.includes(U)){f(!1),x.current=!1,s(!1);return}let j=U;h(j);let R=QO[j],O=N[R.goals]||[],H=N[R.status]||{},q=O.map((V,J)=>{var K;return{text:V,checked:(K=H[`goal_${J}`])!=null?K:!1}});a(q),f(!0),x.current=!0,s(!1)},C=async B=>{if(!v)return;let W=t.app.vault.getAbstractFileByPath(e);if(!(W instanceof xV.TFile))return;let N=QO[v],U=B.map(R=>R.text),j={};B.forEach((R,O)=>{j[`goal_${O}`]=R.checked});try{v==="drc"?await t.drcService.updateDRCFrontmatter(e,{dailyGoals:U,dailyGoalStatus:j},"user-input"):await t.app.fileManager.processFrontMatter(W,R=>{R[N.goals]=U,R[N.status]=j})}catch(R){console.error("[GoalsWidget] Failed to update frontmatter:",R)}},D=async B=>{if(r)return;let W=[...i],N=[...i];N[B]={...N[B],checked:!N[B].checked},a(N);try{await C(N)}catch(U){a(W),console.error("[GoalsWidget] Failed to toggle goal:",U)}},P=B=>{r||(c(B),u(i[B].text))},M=async()=>{if(r||l===null)return;let B=d.trim();if(!B)await I(l);else{let W=[...i],N=[...i];N[l]={...N[l],text:B},a(N);try{await C(N)}catch(U){a(W),console.error("[GoalsWidget] Failed to save edited goal:",U);return}}c(null),u("")},z=()=>{c(null),u("")},A=B=>{B.key==="Enter"?(B.preventDefault(),M()):B.key==="Escape"&&z()},I=async B=>{if(r)return;let W=[...i],N=i.filter((U,j)=>j!==B);a(N),l===B&&(c(null),u(""));try{await C(N)}catch(U){a(W),console.error("[GoalsWidget] Failed to delete goal:",U)}},L=async()=>{if(r)return;let B=p.trim();if(!B)return;let W={text:B,checked:!1},N=[...i],U=[...i,W];a(U),m("");try{await C(U)}catch(j){a(N),m(B),console.error("[GoalsWidget] Failed to add goal:",j)}b.current&&b.current.focus()},E=B=>{B.key==="Enter"&&(B.preventDefault(),L())},T=()=>{var B;return r||!v?"Goals":((B=QO[v])==null?void 0:B.label)||"Goals"},$=()=>v&&{drc:"Items added here only apply to this day. For recurring items on all new DRCs, go to Settings > Reviews.","weekly-review":"Items added here only apply to this week. For recurring items on all new weekly reviews, go to Settings > Reviews.","monthly-review":"Items added here only apply to this month. For recurring items on all new monthly reviews, go to Settings > Reviews.","quarterly-review":"Items added here only apply to this quarter. For recurring items on all new quarterly reviews, go to Settings > Reviews.","yearly-review":"Items added here only apply to this year. For recurring items on all new yearly reviews, go to Settings > Reviews."}[v]||null;if(o)return Yt.default.createElement("div",{style:{display:"flex",justifyContent:"center",width:"100%"}},Yt.default.createElement("div",{style:{padding:"1rem",background:"var(--background-primary)",borderRadius:"var(--radius-m)",border:"1px solid var(--background-modifier-border)",maxWidth:"600px",width:"100%"}},Yt.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"0.75rem"}},Yt.default.createElement(ae,{width:90,height:16,borderRadius:"4px"}),Yt.default.createElement(ae,{width:70,height:14,borderRadius:"4px"})),Yt.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"}},Array.from({length:3}).map((W,N)=>Yt.default.createElement("div",{key:N,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem",background:"var(--background-secondary)",borderRadius:"var(--radius-s)",border:"1px solid var(--background-modifier-border)"}},Yt.default.createElement(_l,{size:16}),Yt.default.createElement(ae,{width:`${60+N*15%30}%`,height:14,borderRadius:"4px"}))))));if(!g)return Yt.default.createElement(_r,{widgetType:"Goals",reason:"Goals widget requires a review note (DRC, Weekly, Monthly, Quarterly, or Yearly)"});let _=$();return Yt.default.createElement("div",{style:{display:"flex",justifyContent:"center",width:"100%"}},Yt.default.createElement("div",{style:{padding:"1rem",background:"var(--background-primary)",borderRadius:"var(--radius-m)",border:"1px solid var(--background-modifier-border)",maxWidth:"600px",width:"100%"}},Yt.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"0.75rem"}},Yt.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"0.4rem"}},Yt.default.createElement("h4",{style:{margin:0,fontSize:"1em",fontWeight:600,color:"var(--text-normal)"}},T()),_&&Yt.default.createElement(pn,{content:Yt.default.createElement("div",{style:{maxWidth:"250px",lineHeight:1.4}},_),preferredPosition:"top"},Yt.default.createElement("span",{style:{cursor:"help",fontSize:"0.85em",color:"var(--text-muted)",opacity:.7}},"?"))),Yt.default.createElement("span",{style:{fontSize:"0.8em",color:"var(--text-muted)"}},i.filter(B=>B.checked).length,"/",i.length," completed")),Yt.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"}},i.map((B,W)=>Yt.default.createElement("div",{key:`${B.text}-${W}`,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem",background:"var(--background-secondary)",borderRadius:"var(--radius-s)",border:"1px solid var(--background-modifier-border)"}},Yt.default.createElement("input",{type:"checkbox",checked:B.checked,onChange:()=>D(W),style:{cursor:"pointer",width:"16px",height:"16px",flexShrink:0}}),l===W?Yt.default.createElement(Yt.default.Fragment,null,Yt.default.createElement("input",{ref:y,type:"text",value:d,onChange:N=>u(N.target.value),onKeyDown:A,style:{flex:1,minWidth:0,padding:"0.25rem 0.5rem",background:"var(--background-primary)",border:"1px solid var(--interactive-accent)",borderRadius:"var(--radius-s)",color:"var(--text-normal)",fontSize:"0.9em"}}),Yt.default.createElement("button",{onClick:M,"aria-label":"Save",className:"clickable-icon",style:{padding:"0.25rem 0.5rem",background:"var(--interactive-accent)",border:"none",borderRadius:"var(--radius-s)",color:"var(--text-on-accent)",cursor:"pointer",fontSize:"0.8em",fontWeight:500}},"Save"),Yt.default.createElement("button",{onClick:()=>c(null),"aria-label":"Cancel",className:"clickable-icon",style:{padding:"0.25rem 0.5rem",background:"transparent",border:"1px solid var(--background-modifier-border)",borderRadius:"var(--radius-s)",color:"var(--text-muted)",cursor:"pointer",fontSize:"0.8em"}},"Cancel")):Yt.default.createElement("span",{onClick:()=>D(W),style:{flex:1,cursor:"pointer",textDecoration:B.checked?"line-through":"none",color:B.checked?"var(--text-muted)":"var(--text-normal)",fontSize:"0.9em"}},B.text),!r&&l!==W&&Yt.default.createElement(Yt.default.Fragment,null,Yt.default.createElement("button",{onClick:()=>P(W),"aria-label":"Edit goal",className:"clickable-icon",style:{padding:"0.25rem",background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer",fontSize:"0.85em",lineHeight:1,opacity:.6,transition:"opacity 0.2s"},onMouseEnter:N=>N.currentTarget.style.opacity="1",onMouseLeave:N=>N.currentTarget.style.opacity="0.6"},"Edit"),Yt.default.createElement("button",{onClick:()=>I(W),"aria-label":"Delete goal",className:"clickable-icon",style:{padding:"0.25rem",background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer",fontSize:"1em",lineHeight:1,opacity:.6,transition:"opacity 0.2s"},onMouseEnter:N=>N.currentTarget.style.opacity="1",onMouseLeave:N=>N.currentTarget.style.opacity="0.6"},"\xD7")))),i.length===0&&Yt.default.createElement("div",{style:{padding:"1rem",textAlign:"center",color:"var(--text-muted)",fontSize:"0.9em"}},r?"No goals configured":"No goals set. Add one below."),!r&&Yt.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginTop:"0.5rem"}},Yt.default.createElement("input",{ref:b,type:"text",value:p,onChange:B=>m(B.target.value),onKeyDown:E,placeholder:"Add a new goal...",style:{flex:1,padding:"0.5rem",background:"var(--background-secondary)",border:"1px solid var(--background-modifier-border)",borderRadius:"var(--radius-s)",color:"var(--text-normal)",fontSize:"0.9em"}}),Yt.default.createElement("button",{onClick:L,disabled:!p.trim(),style:{padding:"0.5rem 1rem",background:p.trim()?"var(--interactive-accent)":"var(--background-secondary)",border:"1px solid var(--background-modifier-border)",borderRadius:"var(--radius-s)",color:p.trim()?"var(--text-on-accent)":"var(--text-muted)",cursor:p.trim()?"pointer":"not-allowed",fontSize:"0.9em",fontWeight:500}},"Add")))))});xk.displayName="GoalsWidget"});var Ht,kV,l9e,c9e,wk,SV=F(()=>{Ht=Y(Q()),kV=require("obsidian");ro();Dn();l9e=5,c9e=150,wk=Ht.default.memo(({filePath:e,plugin:t,preview:r,previewData:n})=>{let[i,a]=(0,Ht.useState)([]),[o,s]=(0,Ht.useState)(!0),[l,c]=(0,Ht.useState)(null),[d,u]=(0,Ht.useState)(""),[p,m]=(0,Ht.useState)(""),[g,f]=(0,Ht.useState)(!0),v=(0,Ht.useRef)(null),h=(0,Ht.useRef)(null),y=(0,Ht.useRef)(0),b=(0,Ht.useRef)(g);(0,Ht.useEffect)(()=>{b.current=g},[g]),(0,Ht.useEffect)(()=>{if(r&&n){a(n.items),s(!1),f(!0);return}y.current=0,k();let I=L=>{L.path===e&&!b.current&&k()};return t.app.metadataCache.on("changed",I),()=>{t.app.metadataCache.off("changed",I)}},[e,r,n]),(0,Ht.useEffect)(()=>{l!==null&&v.current&&(v.current.focus(),v.current.select())},[l]);let k=async()=>{let I=t.app.vault.getAbstractFileByPath(e);if(!(I instanceof kV.TFile)){f(!1),s(!1);return}let L=t.app.metadataCache.getFileCache(I),E=L==null?void 0:L.frontmatter;if(!E){if(y.current<l9e){y.current++,setTimeout(()=>k(),c9e);return}f(!1),s(!1);return}if(E.type!=="drc"){f(!1),s(!1);return}let T=E.checklistItems||[],$=E.checklistStatus||{},_=T.map((B,W)=>{var N;return{text:B,checked:(N=$[`item_${W}`])!=null?N:!1}});a(_),f(!0),s(!1)},x=async I=>{if(!(t.app.vault.getAbstractFileByPath(e)instanceof kV.TFile))return;let E=I.map($=>$.text),T={};I.forEach(($,_)=>{T[`item_${_}`]=$.checked});try{await t.drcService.updateDRCFrontmatter(e,{checklistItems:E,checklistStatus:T},"user-input")}catch($){console.error("[ChecklistWidget] Failed to update frontmatter:",$)}},S=async I=>{if(r)return;let L=[...i];L[I]={...L[I],checked:!L[I].checked},a(L),await x(L)},w=I=>{r||(c(I),u(i[I].text))},C=async()=>{if(r||l===null)return;let I=d.trim();if(!I)await M(l);else{let L=[...i];L[l]={...L[l],text:I},a(L),await x(L)}c(null),u("")},D=()=>{c(null),u("")},P=I=>{I.key==="Enter"?(I.preventDefault(),C()):I.key==="Escape"&&D()},M=async I=>{if(r)return;let L=i.filter((E,T)=>T!==I);a(L),await x(L),l===I&&(c(null),u(""))},z=async()=>{if(r)return;let I=p.trim();if(!I)return;let L={text:I,checked:!1},E=[...i,L];a(E),m(""),await x(E),h.current&&h.current.focus()},A=I=>{I.key==="Enter"&&(I.preventDefault(),z())};return o?Ht.default.createElement("div",{style:{display:"flex",justifyContent:"center",width:"100%"}},Ht.default.createElement("div",{style:{padding:"1rem",background:"var(--background-primary)",borderRadius:"var(--radius-m)",border:"1px solid var(--background-modifier-border)",maxWidth:"600px",width:"100%"}},Ht.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"0.75rem"}},Ht.default.createElement(ae,{width:130,height:16,borderRadius:"4px"}),Ht.default.createElement(ae,{width:70,height:14,borderRadius:"4px"})),Ht.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"}},Array.from({length:3}).map((L,E)=>Ht.default.createElement("div",{key:E,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem",background:"var(--background-secondary)",borderRadius:"var(--radius-s)",border:"1px solid var(--background-modifier-border)"}},Ht.default.createElement(_l,{size:16}),Ht.default.createElement(ae,{width:`${60+E*15%30}%`,height:14,borderRadius:"4px"})))))):g?Ht.default.createElement("div",{style:{display:"flex",justifyContent:"center",width:"100%"}},Ht.default.createElement("div",{style:{padding:"1rem",background:"var(--background-primary)",borderRadius:"var(--radius-m)",border:"1px solid var(--background-modifier-border)",maxWidth:"600px",width:"100%"}},Ht.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"0.75rem"}},Ht.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"0.4rem"}},Ht.default.createElement("h4",{style:{margin:0,fontSize:"1em",fontWeight:600,color:"var(--text-normal)"}},"Pre-Trade Checklist"),Ht.default.createElement(pn,{content:Ht.default.createElement("div",{style:{maxWidth:"250px",lineHeight:1.4}},Ht.default.createElement("div",null,"Items added here only apply to this day."),Ht.default.createElement("div",{style:{marginTop:"4px"}},"For recurring items on all new DRCs, go to Settings > Reviews.")),preferredPosition:"top"},Ht.default.createElement("span",{style:{cursor:"help",fontSize:"0.85em",color:"var(--text-muted)",opacity:.7}},"\u24D8"))),Ht.default.createElement("span",{style:{fontSize:"0.8em",color:"var(--text-muted)"}},i.filter(I=>I.checked).length,"/",i.length," completed")),Ht.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"}},i.map((I,L)=>Ht.default.createElement("div",{key:L,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem",background:"var(--background-secondary)",borderRadius:"var(--radius-s)",border:"1px solid var(--background-modifier-border)"}},Ht.default.createElement("input",{type:"checkbox",checked:I.checked,onChange:()=>S(L),disabled:r,style:{cursor:r?"default":"pointer",width:"16px",height:"16px",flexShrink:0}}),l===L?Ht.default.createElement(Ht.default.Fragment,null,Ht.default.createElement("input",{ref:v,type:"text",value:d,onChange:E=>u(E.target.value),onKeyDown:P,style:{flex:1,minWidth:0,padding:"0.25rem 0.5rem",background:"var(--background-primary)",border:"1px solid var(--interactive-accent)",borderRadius:"var(--radius-s)",color:"var(--text-normal)",fontSize:"0.9em"}}),Ht.default.createElement("button",{onClick:C,"aria-label":"Save",className:"clickable-icon",style:{padding:"0.25rem 0.5rem",background:"var(--interactive-accent)",border:"none",borderRadius:"var(--radius-s)",color:"var(--text-on-accent)",cursor:"pointer",fontSize:"0.8em",fontWeight:500}},"Save"),Ht.default.createElement("button",{onClick:D,"aria-label":"Cancel",className:"clickable-icon",style:{padding:"0.25rem 0.5rem",background:"transparent",border:"1px solid var(--background-modifier-border)",borderRadius:"var(--radius-s)",color:"var(--text-muted)",cursor:"pointer",fontSize:"0.8em"}},"Cancel")):Ht.default.createElement("span",{onClick:()=>S(L),style:{flex:1,cursor:"pointer",textDecoration:I.checked?"line-through":"none",color:I.checked?"var(--text-muted)":"var(--text-normal)",fontSize:"0.9em"}},I.text),!r&&l!==L&&Ht.default.createElement(Ht.default.Fragment,null,Ht.default.createElement("button",{onClick:()=>w(L),"aria-label":"Edit item",className:"clickable-icon",style:{padding:"0.25rem",background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer",fontSize:"0.85em",lineHeight:1,opacity:.6,transition:"opacity 0.2s"},onMouseEnter:E=>E.currentTarget.style.opacity="1",onMouseLeave:E=>E.currentTarget.style.opacity="0.6"},"Edit"),Ht.default.createElement("button",{onClick:()=>M(L),"aria-label":"Delete item",className:"clickable-icon",style:{padding:"0.25rem",background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer",fontSize:"1em",lineHeight:1,opacity:.6,transition:"opacity 0.2s"},onMouseEnter:E=>E.currentTarget.style.opacity="1",onMouseLeave:E=>E.currentTarget.style.opacity="0.6"},"\xD7")))),i.length===0&&Ht.default.createElement("div",{style:{padding:"1rem",textAlign:"center",color:"var(--text-muted)",fontSize:"0.9em"}},r?"No checklist items configured":"No checklist items. Add one below."),!r&&Ht.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginTop:"0.5rem"}},Ht.default.createElement("input",{ref:h,type:"text",value:p,onChange:I=>m(I.target.value),onKeyDown:A,placeholder:"Add a new checklist item...",style:{flex:1,padding:"0.5rem",background:"var(--background-secondary)",border:"1px solid var(--background-modifier-border)",borderRadius:"var(--radius-s)",color:"var(--text-normal)",fontSize:"0.9em"}}),Ht.default.createElement("button",{onClick:z,disabled:!p.trim(),style:{padding:"0.5rem 1rem",background:p.trim()?"var(--interactive-accent)":"var(--background-secondary)",border:"1px solid var(--background-modifier-border)",borderRadius:"var(--radius-s)",color:p.trim()?"var(--text-on-accent)":"var(--text-muted)",cursor:p.trim()?"pointer":"not-allowed",fontSize:"0.9em",fontWeight:500}},"Add"))))):Ht.default.createElement(_r,{widgetType:"Checklist",reason:"Checklist widget requires a DRC note (frontmatter type: 'drc')"})});wk.displayName="ChecklistWidget"});var Rt,TV,d9e,u9e,p9e,QP,CV=F(()=>{Rt=Y(Q()),TV=require("obsidian");ro();Op();Dn();d9e=["drc","weekly-review","monthly-review","quarterly-review","yearly-review"],u9e=5,p9e=150,QP=({filePath:e,plugin:t,config:r,preview:n,previewData:i})=>{let[a,o]=(0,Rt.useState)(null),[s,l]=(0,Rt.useState)(null),[c,d]=(0,Rt.useState)(!0),[u,p]=(0,Rt.useState)(!0),[m,g]=(0,Rt.useState)(null),f=(0,Rt.useRef)(0),h=r!=null&&r.gradeScale?r.gradeScale:["weekly-review","monthly-review","quarterly-review","yearly-review"].includes(m!=null?m:"")?"numeric":"letter";(0,Rt.useEffect)(()=>{f.current=0,y();let w=C=>{C.path===e&&!u&&y()};return t.app.metadataCache.on("changed",w),()=>{t.app.metadataCache.off("changed",w)}},[e]);let y=async()=>{var P,M;if(n&&i){o(String(i.mentalGrade)),l(String(i.technicalGrade)),d(!1),p(!0);return}let w=t.app.vault.getAbstractFileByPath(e);if(!(w instanceof TV.TFile)){p(!1),d(!1);return}let C=t.app.metadataCache.getFileCache(w),D=C==null?void 0:C.frontmatter;if(!D||!d9e.includes(D.type)){if(f.current<u9e){f.current++,setTimeout(()=>y(),p9e);return}p(!1),d(!1);return}g(D.type),o((P=D.mentalGrade)!=null?P:null),l((M=D.technicalGrade)!=null?M:null),p(!0),d(!1)},b=async(w,C)=>{var P;if(!(n||!(t.app.vault.getAbstractFileByPath(e)instanceof TV.TFile))){w==="mentalGrade"?o(C):l(C);try{m==="drc"?await t.drcService.updateDRCFrontmatter(e,{[w]:C},"user-input"):m==="weekly-review"?await t.weeklyReviewService.updateWeeklyReviewFrontmatter(e,{[w]:C}):m==="monthly-review"?await t.monthlyReviewService.updateMonthlyReviewFrontmatter(e,{[w]:C}):m==="quarterly-review"?await(await t.serviceManager.getQuarterlyReviewService()).updateQuarterlyReviewFrontmatter(e,{[w]:C}):m==="yearly-review"&&await(await t.serviceManager.getYearlyReviewService()).updateYearlyReviewFrontmatter(e,{[w]:C});let z=(P={drc:"drc","weekly-review":"weekly","monthly-review":"monthly","quarterly-review":"quarterly","yearly-review":"yearly"}[m!=null?m:"drc"])!=null?P:"drc";xe.publish("review:changed",{action:"updated",type:z,filePath:e})}catch(M){console.error("[ReviewWidget] Failed to update grade:",M),await y()}}},k=w=>{if(w===null)return"var(--background-modifier-border)";if(h==="letter")switch(w){case"A":return"#4ade80";case"B":return"#fbbf24";case"C":return"#f87171";default:return"var(--background-modifier-border)"}else{let C=w;return C<=2?"#f87171":C<=3.5?"#fbbf24":"#4ade80"}};return c?Rt.default.createElement("div",{style:{padding:"1rem",background:"var(--background-primary)",borderRadius:"var(--radius-m)",border:"1px solid var(--background-modifier-border)"}},Rt.default.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"0 12px 4px 12px"}},Rt.default.createElement(ae,{width:120,height:12,borderRadius:"4px"})),Rt.default.createElement("div",{style:{display:"flex",flexWrap:"wrap",gap:"1.5rem",justifyContent:"center",alignItems:"center"}},Rt.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"}},Rt.default.createElement(ae,{width:60,height:14,borderRadius:"4px"}),Rt.default.createElement("div",{style:{display:"flex",gap:"4px"}},[1,2,3,4,5].map(w=>Rt.default.createElement(ae,{key:w,width:20,height:20,borderRadius:"4px"}))),Rt.default.createElement(ae,{width:30,height:14,borderRadius:"4px"})),Rt.default.createElement(ae,{width:1,height:20,borderRadius:"0"}),Rt.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"}},Rt.default.createElement(ae,{width:70,height:14,borderRadius:"4px"}),Rt.default.createElement("div",{style:{display:"flex",gap:"4px"}},[1,2,3,4,5].map(w=>Rt.default.createElement(ae,{key:w,width:20,height:20,borderRadius:"4px"}))),Rt.default.createElement(ae,{width:30,height:14,borderRadius:"4px"})))):u?Rt.default.createElement("div",{style:{padding:"1rem",background:"var(--background-primary)",borderRadius:"var(--radius-m)",border:"1px solid var(--background-modifier-border)"}},Rt.default.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"0 12px 4px 12px"}},Rt.default.createElement("div",{style:{fontSize:"0.7rem",fontWeight:500,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.5px",textAlign:"center",marginBottom:"0.5rem"}},"Performance Review")),h==="letter"?Rt.default.createElement("div",{style:{display:"flex",flexWrap:"wrap",gap:"1.5rem"}},Rt.default.createElement("div",{style:{flex:"1 1 200px",minWidth:"200px"}},Rt.default.createElement("div",{style:{marginBottom:"0.5rem",fontSize:"0.9em",fontWeight:500,color:"var(--text-normal)",textAlign:"center"}},"Mental Game"),Rt.default.createElement("div",{style:{display:"flex",gap:"0.5rem"}},["A","B","C"].map(w=>Rt.default.createElement("button",{key:w,onClick:()=>b("mentalGrade",w),disabled:n,style:{flex:1,padding:"0.75rem",background:a===w?k(w):"var(--background-secondary)",border:`2px solid ${a===w?k(w):"var(--background-modifier-border)"}`,borderRadius:"var(--radius-s)",color:a===w?"white":"var(--text-normal)",fontSize:"1.1em",fontWeight:a===w?600:500,cursor:n?"default":"pointer",transition:"all 0.2s",opacity:n?.7:1},onMouseEnter:C=>{a!==w&&(C.currentTarget.style.borderColor=k(w),C.currentTarget.style.opacity="0.8")},onMouseLeave:C=>{a!==w&&(C.currentTarget.style.borderColor="var(--background-modifier-border)",C.currentTarget.style.opacity="1")}},w)))),Rt.default.createElement("div",{style:{flex:"1 1 200px",minWidth:"200px"}},Rt.default.createElement("div",{style:{marginBottom:"0.5rem",fontSize:"0.9em",fontWeight:500,color:"var(--text-normal)",textAlign:"center"}},"Technical Game"),Rt.default.createElement("div",{style:{display:"flex",gap:"0.5rem"}},["A","B","C"].map(w=>Rt.default.createElement("button",{key:w,onClick:()=>b("technicalGrade",w),disabled:n,style:{flex:1,padding:"0.75rem",background:s===w?k(w):"var(--background-secondary)",border:`2px solid ${s===w?k(w):"var(--background-modifier-border)"}`,borderRadius:"var(--radius-s)",color:s===w?"white":"var(--text-normal)",fontSize:"1.1em",fontWeight:s===w?600:500,cursor:n?"default":"pointer",transition:"all 0.2s",opacity:n?.7:1},onMouseEnter:C=>{s!==w&&(C.currentTarget.style.borderColor=k(w),C.currentTarget.style.opacity="0.8")},onMouseLeave:C=>{s!==w&&(C.currentTarget.style.borderColor="var(--background-modifier-border)",C.currentTarget.style.opacity="1")}},w))))):Rt.default.createElement("div",{style:{display:"flex",flexWrap:"wrap",gap:"1.5rem"}},Rt.default.createElement("div",{style:{flex:"1 1 200px",minWidth:"200px"}},Rt.default.createElement("div",{style:{marginBottom:"0.5rem",fontSize:"0.9em",fontWeight:500,color:"var(--text-normal)",textAlign:"center"}},"Mental Game"),Rt.default.createElement("div",{className:"clickable-icon",style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"0.25rem",padding:"0.5rem",background:"var(--background-secondary)",borderRadius:"var(--radius-s)",border:"1px solid var(--background-modifier-border)"},"aria-label":"Click for full star, right-click for half star"},[1,2,3,4,5].map(w=>{let C=a||0,D=C>=w,P=!D&&C>=w-.5;return Rt.default.createElement("span",{key:`mental-${w}`,onClick:()=>!n&&b("mentalGrade",w),onContextMenu:M=>{M.preventDefault(),n||b("mentalGrade",w-.5)},style:{cursor:n?"default":"pointer",fontSize:"1.75em",lineHeight:1,userSelect:"none",opacity:n?.7:1,transition:"transform 0.1s",color:P?"var(--text-muted)":D?"gold":"var(--text-muted)"},onMouseEnter:M=>{n||(M.currentTarget.style.transform="scale(1.2)")},onMouseLeave:M=>{M.currentTarget.style.transform="scale(1)"}},P?Rt.default.createElement("span",{style:{position:"relative",display:"inline-block"}},Rt.default.createElement("span",{style:{visibility:"hidden"}},"\u2605"),Rt.default.createElement("span",{style:{position:"absolute",left:0,top:0,color:"var(--text-muted)"}},"\u2605"),Rt.default.createElement("span",{style:{position:"absolute",left:0,top:0,overflow:"hidden",width:"50%",color:"gold"}},"\u2605")):"\u2605")}),Rt.default.createElement("span",{style:{fontSize:"1em",fontWeight:600,color:"var(--text-muted)",marginLeft:"0.5rem"}},a!=null?a:0,"/5"))),Rt.default.createElement("div",{style:{flex:"1 1 200px",minWidth:"200px"}},Rt.default.createElement("div",{style:{marginBottom:"0.5rem",fontSize:"0.9em",fontWeight:500,color:"var(--text-normal)",textAlign:"center"}},"Technical Game"),Rt.default.createElement("div",{className:"clickable-icon",style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"0.25rem",padding:"0.5rem",background:"var(--background-secondary)",borderRadius:"var(--radius-s)",border:"1px solid var(--background-modifier-border)"},"aria-label":"Click for full star, right-click for half star"},[1,2,3,4,5].map(w=>{let C=s||0,D=C>=w,P=!D&&C>=w-.5;return Rt.default.createElement("span",{key:`technical-${w}`,onClick:()=>!n&&b("technicalGrade",w),onContextMenu:M=>{M.preventDefault(),n||b("technicalGrade",w-.5)},style:{cursor:n?"default":"pointer",fontSize:"1.75em",lineHeight:1,userSelect:"none",opacity:n?.7:1,transition:"transform 0.1s",color:P?"var(--text-muted)":D?"gold":"var(--text-muted)"},onMouseEnter:M=>{n||(M.currentTarget.style.transform="scale(1.2)")},onMouseLeave:M=>{M.currentTarget.style.transform="scale(1)"}},P?Rt.default.createElement("span",{style:{position:"relative",display:"inline-block"}},Rt.default.createElement("span",{style:{visibility:"hidden"}},"\u2605"),Rt.default.createElement("span",{style:{position:"absolute",left:0,top:0,color:"var(--text-muted)"}},"\u2605"),Rt.default.createElement("span",{style:{position:"absolute",left:0,top:0,overflow:"hidden",width:"50%",color:"gold"}},"\u2605")):"\u2605")}),Rt.default.createElement("span",{style:{fontSize:"1em",fontWeight:600,color:"var(--text-muted)",marginLeft:"0.5rem"}},s!=null?s:0,"/5"))))):Rt.default.createElement(_r,{widgetType:"Review",reason:"Review widget requires a DRC or Weekly Review note (frontmatter type: 'drc' or 'weekly-review')"})}});function B0e(e,t){var p,m,g;let r=(m=(p=t.reviewDataCache)==null?void 0:p.get(e))!=null?m:null,[n,i]=(0,dg.useState)(r),[a,o]=(0,dg.useState)(!r),[s,l]=(0,dg.useState)((g=r==null?void 0:r.version)!=null?g:0),c=(0,dg.useRef)(!0),d=(0,dg.useRef)(e);return(0,dg.useEffect)(()=>{c.current=!0,d.current=e;let f=t.reviewDataCache;if(!f){console.warn("[useReviewData] ReviewDataCache not available"),o(!1);return}let v=f.get(e);v?((!n||v.version!==n.version)&&(i(v),l(v.version)),o(!1)):(o(!0),(async()=>{var y;try{if(await f.populate(e),!c.current||d.current!==e)return;let b=f.get(e);i(b),l((y=b==null?void 0:b.version)!=null?y:0),o(!1)}catch(b){console.error("[useReviewData] Failed to populate cache:",b),c.current&&o(!1)}})());let h=f.subscribe(e,y=>{var b;!c.current||d.current!==e||(i(y),l((b=y==null?void 0:y.version)!=null?b:0))});return()=>{c.current=!1,h()}},[e,t]),{data:n,loading:a,version:s,refresh:()=>{let f=t.reviewDataCache;f&&(o(!0),(async()=>{var v;try{if(await f.populate(e),!c.current)return;let h=f.get(e);i(h),l((v=h==null?void 0:h.version)!=null?v:0),o(!1)}catch(h){console.error("[useReviewData] Failed to refresh cache:",h),c.current&&o(!1)}})())}}}function sn(e,t){var a,o,s,l;let{data:r,loading:n,refresh:i}=B0e(e,t);return{trades:(a=r==null?void 0:r.trades)!=null?a:[],loading:n,filters:(o=r==null?void 0:r.filters)!=null?o:null,dateRange:(s=r==null?void 0:r.dateRange)!=null?s:null,noteType:(l=r==null?void 0:r.noteType)!=null?l:null,refresh:i}}var dg,rs=F(()=>{dg=Y(Q())});var Si,W0e,kk,mv,PV=F(()=>{Si=Y(Q());yy();qt();As();Jn();Vo();rs();qi();Dn();W0e={stats:{netPnL:!0,winRate:!0,profitFactor:!0,expectancy:!0,totalTrades:!0,avgWin:!0,avgLoss:!0,plRatio:!0},columns:4},kk=Si.default.memo(({filePath:e,plugin:t,config:r={},preview:n,previewData:i})=>{var y,b,k,x;let a={...W0e,...r,stats:{...W0e.stats,...r==null?void 0:r.stats}},{trades:o,loading:s}=sn(e,t),l=n&&i?i.trades:o,c=n?!1:s,[,d]=(0,Si.useState)(0);Xe("settings:changed",(0,Si.useCallback)(()=>{d(S=>S+1)},[]),!n);let u=(0,Si.useMemo)(()=>{var z,A,I,L,E,T,$,_,B,W;let S=l.filter(N=>!yt({tradeStatus:N.tradeStatus,exitTime:N.exitTime,pnl:N.pnl,useDirectPnLInput:N.useDirectPnLInput,exits:N.exits,entries:N.entries}));if(S.length===0)return null;let w=(A=(z=t==null?void 0:t.settings)==null?void 0:z.trade)==null?void 0:A.defaultRiskAmount,C=((L=(I=t==null?void 0:t.settings)==null?void 0:I.trade)==null?void 0:L.showCopyTradingPnL)||!1,D=($=(T=(E=t==null?void 0:t.settings)==null?void 0:E.trade)==null?void 0:T.breakEvenRangeMin)!=null?$:0,P=(W=(B=(_=t==null?void 0:t.settings)==null?void 0:_.trade)==null?void 0:B.breakEvenRangeMax)!=null?W:0,M=S.map(N=>{let U=rn(N),j=tn(N.pnl,U,C);return{...N,pnl:j}});return cM(M,{defaultRiskAmount:w,breakEvenRangeMin:D,breakEvenRangeMax:P})},[l,t]),p=(0,Si.useMemo)(()=>!u||u.avgLoss===0?0:Math.abs(u.avgWin/u.avgLoss),[u]),m={},g={display:"grid",gridTemplateColumns:`repeat(${a.columns||4}, 1fr)`,gap:"0.75rem"};if(c){let{stats:S}=a,w=Object.entries(S||{}).filter(([,D])=>D),C={background:"var(--background-secondary)",padding:"0.75rem",borderRadius:"var(--radius-s)",textAlign:"center"};return Si.default.createElement("div",{style:m},Si.default.createElement("div",{style:g},w.map(([D])=>Si.default.createElement("div",{key:D,style:C},Si.default.createElement("div",{style:{marginBottom:"0.25rem"}},Si.default.createElement(ae,{width:60,height:12,borderRadius:"4px"})),Si.default.createElement(ae,{width:50,height:18,borderRadius:"4px"})))))}if(!u)return Si.default.createElement("div",{style:{textAlign:"center",color:"var(--text-muted)"}},"No closed trades for this period");let f=((b=(y=t==null?void 0:t.settings)==null?void 0:y.general)==null?void 0:b.currency)||"USD",v=((x=(k=t==null?void 0:t.settings)==null?void 0:k.trade)==null?void 0:x.displayRMultiples)||!1,{stats:h}=a;return Si.default.createElement("div",{style:m},Si.default.createElement("div",{style:g},(h==null?void 0:h.netPnL)&&Si.default.createElement(mv,{label:"Net P&L",value:ye(u.netPnL,!0,f,v,u.netPnLR),color:u.netPnL>=0?"green":"red"}),(h==null?void 0:h.winRate)&&Si.default.createElement(mv,{label:"Win Rate",value:`${(u.winRate*100).toFixed(1)}%`}),(h==null?void 0:h.profitFactor)&&Si.default.createElement(mv,{label:"Profit Factor",value:u.profitFactor===1/0?"\u221E":u.profitFactor.toFixed(2),color:u.profitFactor>=1?"green":"red"}),(h==null?void 0:h.expectancy)&&Si.default.createElement(mv,{label:"Expectancy",value:ye(u.expectancy,!0,f,v,u.expectancyR),color:u.expectancy>0?"green":u.expectancy<0?"red":void 0}),(h==null?void 0:h.totalTrades)&&Si.default.createElement(mv,{label:"Total Trades",value:u.numTrades.toString()}),(h==null?void 0:h.avgWin)&&Si.default.createElement(mv,{label:"Avg Win",value:ye(u.avgWin,!0,f,v,u.avgWinR),color:"green"}),(h==null?void 0:h.avgLoss)&&Si.default.createElement(mv,{label:"Avg Loss",value:ye(-Math.abs(u.avgLoss),!0,f,v,u.avgLossR?-Math.abs(u.avgLossR):void 0),color:"red"}),(h==null?void 0:h.plRatio)&&Si.default.createElement(mv,{label:"P/L Ratio",value:p.toFixed(2),color:p>=1?"green":"red"})))});kk.displayName="StatsWidget";mv=({label:e,value:t,color:r})=>Si.default.createElement("div",{style:{background:"var(--background-secondary)",padding:"0.75rem",borderRadius:"var(--radius-s)",textAlign:"center"}},Si.default.createElement("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.25rem",textTransform:"uppercase",letterSpacing:"0.5px"}},e),Si.default.createElement("div",{style:{fontSize:"1.1rem",fontWeight:600,color:r==="green"?"var(--text-success)":r==="red"?"var(--text-error)":"var(--text-normal)"}},t))});var zn,m9e,Sk,DV=F(()=>{zn=Y(Q());Jn();uu();Ll();rs();Dn();m9e={height:250},Sk=zn.default.memo(({filePath:e,plugin:t,config:r={},preview:n,previewData:i})=>{let a={...m9e,...r},{trades:o,loading:s}=sn(e,t),l=n&&i?i.trades:o,c=n?!1:s,d=(0,zn.useMemo)(()=>{var h,y,b,k;let g=l.filter(x=>!yt({tradeStatus:x.tradeStatus,exitTime:x.exitTime,pnl:x.pnl,useDirectPnLInput:x.useDirectPnLInput,exits:x.exits,entries:x.entries}));if(g.length===0)return[];let f=((y=(h=t==null?void 0:t.settings)==null?void 0:h.trade)==null?void 0:y.dateFormat)||"DDMMYY",v=(k=(b=t==null?void 0:t.settings)==null?void 0:b.trade)==null?void 0:k.defaultRiskAmount;return Np(g,f,v)},[l,t]),u={display:"flex",justifyContent:"center",alignItems:"center",padding:"8px 12px 4px 12px"},p={fontSize:"0.7rem",fontWeight:500,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.5px",textAlign:"center"},m={overflow:"hidden"};return c?zn.default.createElement("div",{style:m},zn.default.createElement("div",{style:u},zn.default.createElement("div",{style:p},"Cumulative P&L")),zn.default.createElement("div",{style:{padding:"8px 8px 0 8px"}},zn.default.createElement("div",{style:{position:"relative",height:`${a.height||250}px`}},zn.default.createElement("div",{style:{position:"absolute",left:0,top:0,bottom:20,width:40,display:"flex",flexDirection:"column",justifyContent:"space-between"}},zn.default.createElement(ae,{width:30,height:10,borderRadius:"4px"}),zn.default.createElement(ae,{width:25,height:10,borderRadius:"4px"}),zn.default.createElement(ae,{width:35,height:10,borderRadius:"4px"}),zn.default.createElement(ae,{width:28,height:10,borderRadius:"4px"})),zn.default.createElement("div",{style:{marginLeft:45,height:"100%",paddingBottom:20}},zn.default.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 400 200",preserveAspectRatio:"none"},zn.default.createElement("path",{d:"M0,180 Q50,160 100,140 T200,100 T300,80 T400,60 L400,200 L0,200 Z",fill:"var(--background-modifier-border)",className:"skeleton-shimmer",style:{opacity:.3}}),zn.default.createElement("path",{d:"M0,180 Q50,160 100,140 T200,100 T300,80 T400,60",fill:"none",stroke:"var(--background-modifier-border)",strokeWidth:"2",className:"skeleton-shimmer",style:{opacity:.6}}))),zn.default.createElement("div",{style:{position:"absolute",bottom:0,left:45,right:0,display:"flex",justifyContent:"space-between"}},zn.default.createElement(ae,{width:20,height:10,borderRadius:"4px"}),zn.default.createElement(ae,{width:20,height:10,borderRadius:"4px"}),zn.default.createElement(ae,{width:20,height:10,borderRadius:"4px"}),zn.default.createElement(ae,{width:20,height:10,borderRadius:"4px"}),zn.default.createElement(ae,{width:20,height:10,borderRadius:"4px"}))))):d.length===0?zn.default.createElement("div",{style:m},zn.default.createElement("div",{style:u},zn.default.createElement("div",{style:p},"Cumulative P&L")),zn.default.createElement("div",{style:{padding:"1rem",textAlign:"center",color:"var(--text-muted)"}},"No closed trades for this period")):zn.default.createElement("div",{style:m},zn.default.createElement("div",{style:u},zn.default.createElement("div",{style:p},"Cumulative P&L")),zn.default.createElement("div",{style:{padding:"8px 8px 0 8px"}},zn.default.createElement(Zf,{data:d,plugin:t,height:a.height||250})))});Sk.displayName="PnLChartWidget"});var qn,f9e,EV,IV,MV,Tk,AV=F(()=>{qn=Y(Q());HH();Ll();Jn();rs();Dn();f9e={height:250},EV={overflow:"hidden"},IV={display:"flex",justifyContent:"center",alignItems:"center",padding:"8px 12px 4px 12px"},MV={fontSize:"0.7rem",fontWeight:500,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.5px",textAlign:"center"},Tk=qn.default.memo(({filePath:e,plugin:t,config:r={},preview:n,previewData:i})=>{var m,g,f,v;let a={...f9e,...r},{trades:o,loading:s}=sn(e,t),l=n&&i?i.trades:o,c=n?!1:s,d=((g=(m=t==null?void 0:t.settings)==null?void 0:m.trade)==null?void 0:g.dateFormat)||"DDMMYY",u=(v=(f=t==null?void 0:t.settings)==null?void 0:f.trade)==null?void 0:v.defaultRiskAmount,p=qn.default.useMemo(()=>{let h=l.filter(y=>!yt({tradeStatus:y.tradeStatus,exitTime:y.exitTime,pnl:y.pnl,useDirectPnLInput:y.useDirectPnLInput,exits:y.exits,entries:y.entries}));return h.length===0?[]:ay(h,d,u)},[l,d,u]);return c?qn.default.createElement("div",{style:EV},qn.default.createElement("div",{style:IV},qn.default.createElement("div",{style:MV},"Drawdown")),qn.default.createElement("div",{style:{padding:"8px 8px 0 8px"}},qn.default.createElement("div",{style:{position:"relative",height:`${a.height||250}px`}},qn.default.createElement("div",{style:{position:"absolute",left:0,top:0,bottom:20,width:35,display:"flex",flexDirection:"column",justifyContent:"space-between"}},qn.default.createElement(ae,{width:25,height:10,borderRadius:"4px"}),qn.default.createElement(ae,{width:30,height:10,borderRadius:"4px"}),qn.default.createElement(ae,{width:28,height:10,borderRadius:"4px"}),qn.default.createElement(ae,{width:32,height:10,borderRadius:"4px"})),qn.default.createElement("div",{style:{marginLeft:40,height:"100%",paddingBottom:20}},qn.default.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 400 200",preserveAspectRatio:"none"},qn.default.createElement("path",{d:"M0,10 L50,10 Q80,40 120,80 T180,60 T240,100 T320,40 T400,70 L400,0 L0,0 Z",fill:"var(--background-modifier-border)",className:"skeleton-shimmer",style:{opacity:.3}}),qn.default.createElement("path",{d:"M0,10 L50,10 Q80,40 120,80 T180,60 T240,100 T320,40 T400,70",fill:"none",stroke:"var(--background-modifier-border)",strokeWidth:"2",className:"skeleton-shimmer",style:{opacity:.6}}))),qn.default.createElement("div",{style:{position:"absolute",bottom:0,left:40,right:0,display:"flex",justifyContent:"space-between"}},qn.default.createElement(ae,{width:20,height:10,borderRadius:"4px"}),qn.default.createElement(ae,{width:20,height:10,borderRadius:"4px"}),qn.default.createElement(ae,{width:20,height:10,borderRadius:"4px"}),qn.default.createElement(ae,{width:20,height:10,borderRadius:"4px"}),qn.default.createElement(ae,{width:20,height:10,borderRadius:"4px"}))))):p.length===0?qn.default.createElement("div",{style:EV},qn.default.createElement("div",{style:IV},qn.default.createElement("div",{style:MV},"Drawdown")),qn.default.createElement("div",{style:{padding:"1rem",textAlign:"center",color:"var(--text-muted)"}},"No closed trades for this period")):qn.default.createElement("div",{style:EV},qn.default.createElement("div",{style:IV},qn.default.createElement("div",{style:MV},"Drawdown")),qn.default.createElement("div",{style:{padding:"8px 8px 0 8px"}},qn.default.createElement(hP,{data:p,plugin:t,height:a.height})))});Tk.displayName="DrawdownChartWidget"});var Ck,XO,LV=F(()=>{Ck=Y(Q()),XO=({size:e=24,className:t=""})=>Ck.default.createElement("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t},Ck.default.createElement("rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",ry:"2"}),Ck.default.createElement("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),Ck.default.createElement("path",{d:"M20.4 14.5L16 10 4 20"}),Ck.default.createElement("line",{x1:"4",y1:"4",x2:"20",y2:"20"}))});function XP(){if($0e)return;let e=document.createElement("style");e.id="journalit-badge-styles",e.textContent=g9e,document.head.appendChild(e),$0e=!0}var g9e,$0e,ZO=F(()=>{g9e=`
/* Count Badges */
.count-badge {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  font-size: 12px;
  font-weight: 600;
  cursor: help;
}

.count-badge--mistakes {
  background: rgba(244, 67, 54, 0.15);
  color: var(--color-red);
  border: 1px solid rgba(244, 67, 54, 0.3);
}

.count-badge--mistakes:hover {
  background: rgba(244, 67, 54, 0.25);
}

.count-badge--setups {
  background: rgba(33, 150, 243, 0.15);
  color: var(--color-info);
  border: 1px solid rgba(33, 150, 243, 0.3);
}

.count-badge--setups:hover {
  background: rgba(33, 150, 243, 0.25);
}

/* Badge cell containers */
.trade-mistakes-cell,
.trade-setups-cell {
  text-align: center;
  vertical-align: middle;
}

/* Widget-specific cell containers (scoped to avoid TradeLog CSS conflicts) */
.widget-trade-mistakes-cell,
.widget-trade-setups-cell {
  text-align: center;
  vertical-align: middle;
}

.trade-no-data {
  color: var(--text-muted);
}

/* Tooltip Container - Background */
.journalit-tooltip {
  background: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  padding: 8px 12px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  max-width: 250px;
  min-width: 120px;
  font-size: 13px;
  color: var(--text-normal);
  z-index: 9999;
}

/* Badge Tooltip Styles */
.badge-tooltip {
  min-width: 100px;
}

.badge-tooltip .tooltip-title {
  font-weight: 600;
  margin-bottom: 4px;
}

.badge-tooltip .tooltip-item {
  color: var(--text-muted);
  margin: 2px 0;
  line-height: 1.4;
}

.badge-tooltip.setups-tooltip .tooltip-title {
  color: var(--interactive-accent);
}

.badge-tooltip.mistakes-tooltip .tooltip-title {
  color: var(--color-red);
}
`,$0e=!1});var dd,R0e,ez,U0e=F(()=>{dd=Y(Q());Hp();ZO();R0e=(0,dd.memo)(({setups:e})=>dd.default.createElement("div",{className:"badge-tooltip setups-tooltip"},dd.default.createElement("div",{className:"tooltip-title"},"Setups:"),e.map((t,r)=>dd.default.createElement("div",{key:r,className:"tooltip-item"},"\u2022 ",t))));R0e.displayName="SetupsTooltipContent";ez=(0,dd.memo)(({items:e})=>{(0,dd.useEffect)(()=>{XP()},[]);let t=e?Array.isArray(e)?e:[e]:[];return t.length===0?dd.default.createElement("span",{className:"trade-no-data"},"-"):dd.default.createElement(pn,{content:dd.default.createElement(R0e,{setups:t}),delay:0,preferredPosition:"top"},dd.default.createElement("span",{className:"count-badge count-badge--setups"},t.length))});ez.displayName="SetupsBadge"});var ud,H0e,tz,q0e=F(()=>{ud=Y(Q());Hp();ZO();H0e=(0,ud.memo)(({mistakes:e})=>ud.default.createElement("div",{className:"badge-tooltip mistakes-tooltip"},ud.default.createElement("div",{className:"tooltip-title"},"Mistakes:"),e.map((t,r)=>ud.default.createElement("div",{key:r,className:"tooltip-item"},"\u2022 ",t))));H0e.displayName="MistakesTooltipContent";tz=(0,ud.memo)(({items:e})=>{(0,ud.useEffect)(()=>{XP()},[]);let t=e?Array.isArray(e)?e:[e]:[];return t.length===0?ud.default.createElement("span",{className:"trade-no-data"},"-"):ud.default.createElement(pn,{content:ud.default.createElement(H0e,{mistakes:t}),delay:0,preferredPosition:"top"},ud.default.createElement("span",{className:"count-badge count-badge--mistakes"},t.length))});tz.displayName="MistakesBadge"});var V0e=F(()=>{U0e();q0e();ZO()});var Re,G0e,Pk,rz=F(()=>{Re=Y(Q());Jn();qt();Vo();ly();Xx();LV();Ad();Er();V0e();Dn();rs();G0e={columns:{images:!0,time:!0,ticker:!0,direction:!0,setup:!0,mistakes:!0,pnl:!0,rMultiple:!1},showOpenTrades:!0,pageSize:20},Pk=Re.default.memo(({filePath:e,plugin:t,config:r={},preview:n=!1,previewData:i})=>{var G,X,te,re,Z,ne,se,ee,ie,ve,Se,Me;let a={...G0e,...r,columns:{...G0e.columns,...r==null?void 0:r.columns}},{currency:o}=ct(),s=(X=(G=t==null?void 0:t.settings)==null?void 0:G.trade)==null?void 0:X.displayRMultiples,l=(re=(te=t==null?void 0:t.settings)==null?void 0:te.trade)==null?void 0:re.defaultRiskAmount,c=((ne=(Z=t==null?void 0:t.settings)==null?void 0:Z.trade)==null?void 0:ne.showCopyTradingPnL)||!1,d=(ie=(ee=(se=t==null?void 0:t.settings)==null?void 0:se.trade)==null?void 0:ee.breakEvenRangeMin)!=null?ie:0,u=(Me=(Se=(ve=t==null?void 0:t.settings)==null?void 0:ve.trade)==null?void 0:Se.breakEvenRangeMax)!=null?Me:0,{trades:p,loading:m}=sn(e,t),g=n&&i?i.trades:p,f=n?!1:m,[v,h]=(0,Re.useState)(!1),[y,b]=(0,Re.useState)([]),[k,x]=(0,Re.useState)(0),[S,w]=(0,Re.useState)(""),C=(0,Re.useCallback)(le=>{t.openFile(le,!1)},[t]),D=(0,Re.useCallback)((le,Ye,ue)=>{let We=ue.indexOf(le);b(ue),x(We>=0?We:0),w(Ye),h(!0)},[]),P=(0,Re.useCallback)(()=>{h(!1)},[]),M=(0,Re.useCallback)(le=>{le>=0&&le<y.length&&x(le)},[y.length]),z=(0,Re.useMemo)(()=>{if(!(y.length<=1))return{images:y,currentIndex:k,onNavigate:M,altPrefix:`Trade ${S} Image`,useResolveMediaPath:!0}},[y,k,M,S]),A=(0,Re.useMemo)(()=>a.showOpenTrades?g:g.filter(le=>!yt({tradeStatus:le.tradeStatus,exitTime:le.exitTime,pnl:le.pnl,useDirectPnLInput:le.useDirectPnLInput,exits:le.exits,entries:le.entries})),[g,a.showOpenTrades]),[I,L]=(0,Re.useState)(0),E=a.pageSize||20,T=A.length,$=E>0?Math.ceil(T/E):1,_=E>0&&T>E;(0,Re.useEffect)(()=>{L(0)},[A.length]);let B=(0,Re.useMemo)(()=>[...A].sort((le,Ye)=>new Date(le.entryTime).getTime()-new Date(Ye.entryTime).getTime()),[A]),W=(0,Re.useMemo)(()=>{if(!_)return B;let le=I*E;return B.slice(le,le+E)},[B,I,E,_]),N=(0,Re.useCallback)(le=>{L(Math.max(0,Math.min(le,$-1)))},[$]),U=(0,Re.useCallback)(()=>{L(le=>Math.max(0,le-1))},[]),j=(0,Re.useCallback)(()=>{L(le=>Math.min($-1,le+1))},[$]);if(f){let{columns:le}=a;return Re.default.createElement("div",{className:"weekly-review-trades-table",style:{width:"100%"}},Re.default.createElement("table",{style:{width:"100%",textAlign:"center"}},Re.default.createElement("thead",null,Re.default.createElement("tr",null,(le==null?void 0:le.images)&&Re.default.createElement("th",{style:{borderBottom:"2px solid var(--background-modifier-border)",padding:"0.5rem",textAlign:"center",fontWeight:600,color:"var(--text-muted)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",background:"var(--background-secondary)"}},"Images"),(le==null?void 0:le.time)&&Re.default.createElement("th",{style:{borderBottom:"2px solid var(--background-modifier-border)",padding:"0.5rem",textAlign:"center",fontWeight:600,color:"var(--text-muted)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",background:"var(--background-secondary)"}},"Entry"),(le==null?void 0:le.ticker)&&Re.default.createElement("th",{style:{borderBottom:"2px solid var(--background-modifier-border)",padding:"0.5rem",textAlign:"center",fontWeight:600,color:"var(--text-muted)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",background:"var(--background-secondary)"}},"Ticker"),(le==null?void 0:le.pnl)&&Re.default.createElement("th",{style:{borderBottom:"2px solid var(--background-modifier-border)",padding:"0.5rem",textAlign:"center",fontWeight:600,color:"var(--text-muted)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",background:"var(--background-secondary)"}},"P&L"),(le==null?void 0:le.direction)&&Re.default.createElement("th",{style:{borderBottom:"2px solid var(--background-modifier-border)",padding:"0.5rem",textAlign:"center",fontWeight:600,color:"var(--text-muted)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",background:"var(--background-secondary)"}},"Direction"),(le==null?void 0:le.setup)&&Re.default.createElement("th",{style:{borderBottom:"2px solid var(--background-modifier-border)",padding:"0.5rem",textAlign:"center",fontWeight:600,color:"var(--text-muted)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",background:"var(--background-secondary)"}},"Setups"),(le==null?void 0:le.mistakes)&&Re.default.createElement("th",{style:{borderBottom:"2px solid var(--background-modifier-border)",padding:"0.5rem",textAlign:"center",fontWeight:600,color:"var(--text-muted)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",background:"var(--background-secondary)"}},"Mistakes"))),Re.default.createElement("tbody",null,Array.from({length:5}).map((ue,We)=>Re.default.createElement("tr",{key:We},(le==null?void 0:le.images)&&Re.default.createElement("td",{style:{padding:"8px 12px",borderBottom:"1px solid var(--background-modifier-border)",textAlign:"center",width:"70px"}},Re.default.createElement(ae,{width:48,height:36,borderRadius:"4px"})),(le==null?void 0:le.time)&&Re.default.createElement("td",{style:{padding:"8px 12px",borderBottom:"1px solid var(--background-modifier-border)",textAlign:"center"}},Re.default.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:4}},Re.default.createElement(ae,{width:45,height:14,borderRadius:"4px"}),Re.default.createElement(ae,{width:35,height:10,borderRadius:"4px"}))),(le==null?void 0:le.ticker)&&Re.default.createElement("td",{style:{padding:"8px 12px",borderBottom:"1px solid var(--background-modifier-border)",textAlign:"center"}},Re.default.createElement(ae,{width:50,height:16,borderRadius:"4px"})),(le==null?void 0:le.pnl)&&Re.default.createElement("td",{style:{padding:"8px 12px",borderBottom:"1px solid var(--background-modifier-border)",textAlign:"center"}},Re.default.createElement(ae,{width:60,height:16,borderRadius:"4px"})),(le==null?void 0:le.direction)&&Re.default.createElement("td",{style:{padding:"8px 12px",borderBottom:"1px solid var(--background-modifier-border)",textAlign:"center"}},Re.default.createElement(ae,{width:45,height:14,borderRadius:"4px"})),(le==null?void 0:le.setup)&&Re.default.createElement("td",{style:{padding:"8px 12px",borderBottom:"1px solid var(--background-modifier-border)",textAlign:"center"}},Re.default.createElement("div",{style:{display:"flex",gap:4,justifyContent:"center"}},Re.default.createElement(ae,{width:50,height:20,borderRadius:"10px"}),We%2===0&&Re.default.createElement(ae,{width:40,height:20,borderRadius:"10px"}))),(le==null?void 0:le.mistakes)&&Re.default.createElement("td",{style:{padding:"8px 12px",borderBottom:"1px solid var(--background-modifier-border)",textAlign:"center"}},We%3===0&&Re.default.createElement(ae,{width:55,height:20,borderRadius:"10px"})))))))}if(A.length===0)return Re.default.createElement("div",{style:{padding:"12px",textAlign:"center",color:"var(--text-muted)"}},"No trades for this period");let{columns:R}=a,O={images:"10%",time:"20%",ticker:"18%",pnl:"18%",direction:"12%",setup:"11%",mistakes:"11%"},H={width:"100%",textAlign:"center",borderCollapse:"collapse",tableLayout:"fixed"},q={borderBottom:"2px solid var(--background-modifier-border)",padding:"0.5rem",textAlign:"center",fontWeight:600,color:"var(--text-muted)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",background:"var(--background-secondary)"},V={padding:"8px 12px",borderBottom:"1px solid var(--background-modifier-border)",textAlign:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},J=(le,Ye)=>{let ue=Ye.getTime()-le.getTime(),We=Math.floor(ue/(1e3*60)),Ke=Math.floor(We/60),Ze=Math.floor(Ke/24);if(Ze>0){let St=Ke%24;return`${Ze}d ${St}h`}else if(Ke>0){let St=We%60;return`${Ke}h ${St}m`}else return`${We}m`},K=le=>le.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1});return Re.default.createElement("div",{className:"weekly-review-trades-table",style:{width:"100%"}},Re.default.createElement("table",{style:H},Re.default.createElement("thead",null,Re.default.createElement("tr",null,(R==null?void 0:R.images)&&Re.default.createElement("th",{style:{...q,width:O.images}},"Images"),(R==null?void 0:R.time)&&Re.default.createElement("th",{style:{...q,width:O.time}},"Entry"),(R==null?void 0:R.ticker)&&Re.default.createElement("th",{style:{...q,width:O.ticker}},"Ticker"),(R==null?void 0:R.pnl)&&Re.default.createElement("th",{style:{...q,width:O.pnl}},"P&L"),(R==null?void 0:R.direction)&&Re.default.createElement("th",{style:{...q,width:O.direction}},"Direction"),(R==null?void 0:R.setup)&&Re.default.createElement("th",{style:{...q,width:O.setup}},"Setups"),(R==null?void 0:R.mistakes)&&Re.default.createElement("th",{style:{...q,width:O.mistakes}},"Mistakes"))),Re.default.createElement("tbody",null,W.map((le,Ye)=>{var oe;let ue=le.id||`index-${Ye}`,We=yt({tradeStatus:le.tradeStatus,exitTime:le.exitTime,pnl:le.pnl,useDirectPnLInput:le.useDirectPnLInput,exits:le.exits,entries:le.entries}),Ke=null,Ze=null,St;if(!We){let me=le.pnl!==void 0&&le.pnl!==null?le.pnl:((oe=le.direction)==null?void 0:oe.toLowerCase())==="long"?(le.exitPrice-le.entryPrice)*le.positionSize:(le.entryPrice-le.exitPrice)*le.positionSize,Ce=rn(le);Ze=tn(me,Ce,c),Ke=Ze,St=xt(me!==null?me:void 0,le.rMultiple,le.riskAmount,l)}let Zr=Ke!==null&&Ke>u,Ee=Ke!==null&&Ke<d,ge=[];try{if(le.images){if(Array.isArray(le.images))ge=le.images;else if(typeof le.images=="string"){let me=JSON.parse(le.images);Array.isArray(me)&&(ge=me.map(Ce=>String(Ce)))}}}catch(me){}return Re.default.createElement("tr",{key:`trade-${ue}`,className:"weekly-review-trade-row",onClick:n?void 0:()=>{le.path&&C(le.path)},style:{cursor:!n&&le.path?"pointer":"default"},onMouseEnter:n?void 0:me=>me.currentTarget.style.backgroundColor="var(--background-modifier-hover)",onMouseLeave:n?void 0:me=>me.currentTarget.style.backgroundColor="transparent"},(R==null?void 0:R.images)&&Re.default.createElement("td",{className:"trade-preview-cell",style:{padding:"8px 12px",borderBottom:"1px solid var(--background-modifier-border)",textAlign:"center",width:"70px",minWidth:"70px"}},ge.length>0?Re.default.createElement("div",{className:"trade-image-wrapper",onClick:me=>{me.stopPropagation(),D(ge[0],le.id||Ye,ge)},style:{cursor:"pointer"}},Re.default.createElement("div",{className:"trade-preview-thumbnail"},Re.default.createElement("img",{src:vi.resolveMediaPath(ge[0]),alt:`Trade ${le.id||Ye} preview`,className:"trade-image",style:{width:"100%",height:"100%",objectFit:"cover"},onError:()=>{}})),ge.length>1&&Re.default.createElement("span",{className:"trade-image-count-indicator"},"+",ge.length-1)):Re.default.createElement(XO,{size:24,className:"trade-no-image-icon"})),(R==null?void 0:R.time)&&Re.default.createElement("td",{style:{padding:"8px 12px",borderBottom:"1px solid var(--background-modifier-border)",textAlign:"center"}},We?Re.default.createElement("span",{style:{color:"var(--text-muted)"}},"OPEN"):Re.default.createElement(Re.default.Fragment,null,le.entryTime&&le.exitTime?Re.default.createElement(Re.default.Fragment,null,K(new Date(le.entryTime)),Re.default.createElement("span",{style:{color:"var(--text-muted)",marginLeft:"4px"}},"(",J(new Date(le.entryTime),new Date(le.exitTime)),")")):le.entryTime?K(new Date(le.entryTime)):"N/A")),(R==null?void 0:R.ticker)&&Re.default.createElement("td",{style:{padding:"8px 12px",borderBottom:"1px solid var(--background-modifier-border)",textAlign:"center"}},Re.default.createElement("span",{style:{fontWeight:600}},le.instrument||le.ticker||"Unknown")),(R==null?void 0:R.pnl)&&Re.default.createElement("td",{style:{padding:"8px 12px",borderBottom:"1px solid var(--background-modifier-border)",color:We?"inherit":Zr?"var(--color-green)":Ee?"var(--color-red)":"var(--text-muted)",fontWeight:600,textAlign:"center"}},We?"-":ye(Ke!=null?Ke:void 0,!0,o,s,St)),(R==null?void 0:R.direction)&&Re.default.createElement("td",{style:{padding:"8px 12px",borderBottom:"1px solid var(--background-modifier-border)",textAlign:"center"}},Re.default.createElement("span",{style:{textTransform:"uppercase"}},le.assetType==="options"&&le.optionType?le.optionType:le.direction||le.side||"N/A")),(R==null?void 0:R.setup)&&Re.default.createElement("td",{className:"widget-trade-setups-cell",style:{padding:"8px 12px",borderBottom:"1px solid var(--background-modifier-border)",textAlign:"center"}},Re.default.createElement(ez,{items:le.setup})),(R==null?void 0:R.mistakes)&&Re.default.createElement("td",{className:"widget-trade-mistakes-cell",style:{padding:"8px 12px",borderBottom:"1px solid var(--background-modifier-border)",textAlign:"center"}},Re.default.createElement(tz,{items:le.mistake})))}))),_&&Re.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.25rem 0.5rem",fontSize:"0.85rem",color:"var(--text-muted)"}},Re.default.createElement("span",null,"Showing ",I*E+1,"-",Math.min((I+1)*E,T)," of ",T," trades"),Re.default.createElement("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"}},Re.default.createElement("button",{onClick:U,disabled:I===0,style:{padding:"0.25rem 0.5rem",border:"1px solid var(--background-modifier-border)",borderRadius:"var(--radius-s)",background:I===0?"var(--background-secondary)":"var(--background-primary)",color:I===0?"var(--text-faint)":"var(--text-normal)",cursor:I===0?"not-allowed":"pointer",fontSize:"0.85rem"}},"\u2190 Prev"),Re.default.createElement("span",{style:{minWidth:"80px",textAlign:"center"}},"Page ",I+1," of ",$),Re.default.createElement("button",{onClick:j,disabled:I>=$-1,style:{padding:"0.25rem 0.5rem",border:"1px solid var(--background-modifier-border)",borderRadius:"var(--radius-s)",background:I>=$-1?"var(--background-secondary)":"var(--background-primary)",color:I>=$-1?"var(--text-faint)":"var(--text-normal)",cursor:I>=$-1?"not-allowed":"pointer",fontSize:"0.85rem"}},"Next \u2192"))),v&&y.length>0&&Re.default.createElement(_p,{isOpen:v,onClose:P,title:`Trade ${S} Image`,portalId:"trade-table-widget-image-portal"},Re.default.createElement(pf,{imagePath:y[k],alt:`Trade ${S} Image ${k+1}`,useResolveMediaPath:!0,navigationContext:z,onClose:P})))});Pk.displayName="TradeTableWidget"});var $e,h9e,Y0e,Dk,nz=F(()=>{$e=Y(Q());Jn();qt();As();Vo();_t();Oa();rs();qi();Dn();ro();h9e=["January","February","March","April","May","June","July","August","September","October","November","December"],Y0e={columns:{date:!0,trades:!0,winRate:!0,profitFactor:!0,pnl:!0}},Dk=$e.default.memo(({filePath:e,plugin:t,config:r={},preview:n=!1,previewData:i,period:a})=>{var $,_,B,W;let o={...Y0e,...r,columns:{...Y0e.columns,...r==null?void 0:r.columns}},{trades:s,loading:l,noteType:c}=sn(e,t),d=n&&i?i.trades:s,u=n?!1:l,p=c||"",m=(0,$e.useMemo)(()=>vn(),[]),[,g]=(0,$e.useState)(0);Xe("settings:changed",(0,$e.useCallback)(()=>{g(N=>N+1)},[]),!n);let f=(0,$e.useMemo)(()=>r.groupBy?r.groupBy:a==="daily"?"day":a==="weekly"?"week":a==="monthly"?"month":a==="quarterly"?"quarter":p==="weekly-review"?"day":p==="monthly-review"?"week":p==="quarterly-review"?"month":p==="yearly-review"?"quarter":"day",[r.groupBy,a,p]),v=(0,$e.useMemo)(()=>n?{valid:!0}:p?a==="monthly"&&!["quarterly-review","yearly-review"].includes(p)?{valid:!1,widgetName:"Monthly Summary",reason:"This widget is only available in Quarterly and Yearly reviews"}:a==="quarterly"&&p!=="yearly-review"?{valid:!1,widgetName:"Quarterly Summary",reason:"This widget is only available in Yearly reviews"}:{valid:!0}:{valid:!0},[n,p,a]);if(!v.valid)return $e.default.createElement(_r,{widgetType:v.widgetName||"Breakdown",reason:v.reason});let h=(0,$e.useMemo)(()=>d.filter(N=>!yt({tradeStatus:N.tradeStatus,exitTime:N.exitTime,pnl:N.pnl,useDirectPnLInput:N.useDirectPnLInput,exits:N.exits,entries:N.entries})),[d]),y=(0,$e.useMemo)(()=>{var q,V,J,K,G,X,te,re,Z,ne;if(f!=="day"||h.length===0)return[];let N=(V=(q=t==null?void 0:t.settings)==null?void 0:q.trade)==null?void 0:V.defaultRiskAmount,U=((K=(J=t==null?void 0:t.settings)==null?void 0:J.trade)==null?void 0:K.showCopyTradingPnL)||!1,j=(te=(X=(G=t==null?void 0:t.settings)==null?void 0:G.trade)==null?void 0:X.breakEvenRangeMin)!=null?te:0,R=(ne=(Z=(re=t==null?void 0:t.settings)==null?void 0:re.trade)==null?void 0:Z.breakEvenRangeMax)!=null?ne:0,O=new Map;h.forEach(se=>{var ie;let ee=zt(se.entryTime,m);O.has(ee)||O.set(ee,[]),(ie=O.get(ee))==null||ie.push(se)});let H=[];return O.forEach((se,ee)=>{var ge;let ie=se.map(oe=>({...oe,displayPnL:tn(oe.pnl,rn(oe),U)})),ve=ie.filter(oe=>oe.displayPnL>R),Se=ie.filter(oe=>oe.displayPnL<j),Me=ve.reduce((oe,me)=>oe+me.displayPnL,0),le=Se.reduce((oe,me)=>oe+Math.abs(me.displayPnL),0),Ye=ve.length+Se.length,ue=Ye>0?ve.length/Ye:0,We=le>0?Me/le:Me>0?1/0:0,Ke=ie.reduce((oe,me)=>oe+me.displayPnL,0),Ze=se.reduce((oe,me)=>{let Ce=xt(me.pnl,me.rMultiple,me.riskAmount,N);return Ce!==void 0&&!isNaN(Ce)?oe+Ce:oe},0),St=(ge=se[0])==null?void 0:ge.entryTime,Zr=St instanceof Date?St:new Date(St||new Date),Ee;try{t!=null&&t.drcService&&(Ee=t.drcService.getDRCNotePath(Zr))}catch(oe){console.error(`Error getting DRC path for date ${ee}:`,oe)}H.push({date:ee,rawDate:Zr,tradeCount:se.length,winRate:ue,profitFactor:We,pnl:Ke,pnlR:Ze,drcPath:Ee})}),H.sort((se,ee)=>Rc(ee.rawDate,se.rawDate)),H},[f,h,m,t]),b=(0,$e.useMemo)(()=>{var q,V,J,K,G,X,te,re,Z,ne;if(f!=="week"||h.length===0)return[];let N=(V=(q=t==null?void 0:t.settings)==null?void 0:q.trade)==null?void 0:V.defaultRiskAmount,U=((K=(J=t==null?void 0:t.settings)==null?void 0:J.trade)==null?void 0:K.showCopyTradingPnL)||!1,j=(te=(X=(G=t==null?void 0:t.settings)==null?void 0:G.trade)==null?void 0:X.breakEvenRangeMin)!=null?te:0,R=(ne=(Z=(re=t==null?void 0:t.settings)==null?void 0:re.trade)==null?void 0:Z.breakEvenRangeMax)!=null?ne:0,O=new Map;h.forEach(se=>{var ie;let ee=Ou(new Date(se.entryTime));O.has(ee)||O.set(ee,[]),(ie=O.get(ee))==null||ie.push(se)});let H=[];return O.forEach((se,ee)=>{var ge;let ie=se.map(oe=>({...oe,displayPnL:tn(oe.pnl,rn(oe),U)})),ve=ie.filter(oe=>oe.displayPnL>R),Se=ie.filter(oe=>oe.displayPnL<j),Me=ve.reduce((oe,me)=>oe+me.displayPnL,0),le=Se.reduce((oe,me)=>oe+Math.abs(me.displayPnL),0),Ye=ve.length+Se.length,ue=Ye>0?ve.length/Ye:0,We=le>0?Me/le:Me>0?1/0:0,Ke=ie.reduce((oe,me)=>oe+me.displayPnL,0),Ze=se.reduce((oe,me)=>{let Ce=xt(me.pnl,me.rMultiple,me.riskAmount,N);return Ce!==void 0&&!isNaN(Ce)?oe+Ce:oe},0),St=[...se].sort((oe,me)=>new Date(oe.entryTime).getTime()-new Date(me.entryTime).getTime()),Zr=new Date(((ge=St[0])==null?void 0:ge.entryTime)||new Date),Ee;try{t!=null&&t.weeklyReviewService&&(Ee=t.weeklyReviewService.getWeeklyReviewPath(Zr))}catch(oe){console.error(`Error getting weekly review path for week ${ee}:`,oe)}H.push({week:`W${ee.toString().padStart(2,"0")}`,weekNumber:ee,firstDate:Zr,tradeCount:se.length,winRate:ue,profitFactor:We,pnl:Ke,pnlR:Ze,weeklyPath:Ee})}),H.sort((se,ee)=>Rc(ee.firstDate,se.firstDate)),H},[f,h,t]),k=(0,$e.useMemo)(()=>{var q,V,J,K,G,X,te,re,Z,ne;if(f!=="month"||h.length===0)return[];let N=(V=(q=t==null?void 0:t.settings)==null?void 0:q.trade)==null?void 0:V.defaultRiskAmount,U=((K=(J=t==null?void 0:t.settings)==null?void 0:J.trade)==null?void 0:K.showCopyTradingPnL)||!1,j=(te=(X=(G=t==null?void 0:t.settings)==null?void 0:G.trade)==null?void 0:X.breakEvenRangeMin)!=null?te:0,R=(ne=(Z=(re=t==null?void 0:t.settings)==null?void 0:re.trade)==null?void 0:Z.breakEvenRangeMax)!=null?ne:0,O=new Map;h.forEach(se=>{var le;let ee=new Date(se.entryTime),ie=Zt(ee,t),ve=ie.getFullYear(),Se=ie.getMonth(),Me=`${ve}-${String(Se+1).padStart(2,"0")}`;O.has(Me)||O.set(Me,[]),(le=O.get(Me))==null||le.push(se)});let H=[];return O.forEach((se,ee)=>{let ie=se.map(Ce=>({...Ce,displayPnL:tn(Ce.pnl,rn(Ce),U)})),ve=ie.filter(Ce=>Ce.displayPnL>R),Se=ie.filter(Ce=>Ce.displayPnL<j),Me=ve.reduce((Ce,et)=>Ce+et.displayPnL,0),le=Se.reduce((Ce,et)=>Ce+Math.abs(et.displayPnL),0),Ye=ve.length+Se.length,ue=Ye>0?ve.length/Ye:0,We=le>0?Me/le:Me>0?1/0:0,Ke=ie.reduce((Ce,et)=>Ce+et.displayPnL,0),Ze=se.reduce((Ce,et)=>{let lt=xt(et.pnl,et.rMultiple,et.riskAmount,N);return lt!==void 0&&!isNaN(lt)?Ce+lt:Ce},0),[St,Zr]=ee.split("-"),Ee=parseInt(St,10),ge=parseInt(Zr,10)-1,oe=new Date(Ee,ge,1),me;try{t!=null&&t.monthlyReviewService&&(me=t.monthlyReviewService.getMonthlyReviewPath(oe))}catch(Ce){console.error(`Error getting monthly review path for ${ee}:`,Ce)}H.push({month:h9e[ge],monthNumber:ge,year:Ee,monthStart:oe,tradeCount:se.length,winRate:ue,profitFactor:We,pnl:Ke,pnlR:Ze,monthlyPath:me})}),H.sort((se,ee)=>Rc(ee.monthStart,se.monthStart)),H},[f,h,t]),x=(0,$e.useMemo)(()=>{var q,V,J,K,G,X,te,re,Z,ne;if(f!=="quarter"||h.length===0)return[];let N=(V=(q=t==null?void 0:t.settings)==null?void 0:q.trade)==null?void 0:V.defaultRiskAmount,U=((K=(J=t==null?void 0:t.settings)==null?void 0:J.trade)==null?void 0:K.showCopyTradingPnL)||!1,j=(te=(X=(G=t==null?void 0:t.settings)==null?void 0:G.trade)==null?void 0:X.breakEvenRangeMin)!=null?te:0,R=(ne=(Z=(re=t==null?void 0:t.settings)==null?void 0:re.trade)==null?void 0:Z.breakEvenRangeMax)!=null?ne:0,O=new Map;h.forEach(se=>{var Ye;let ee=new Date(se.entryTime),ie=Zt(ee,t),ve=ie.getFullYear(),Se=ie.getMonth()+1,Me=Oi(Se),le=`${ve}-Q${Me}`;O.has(le)||O.set(le,[]),(Ye=O.get(le))==null||Ye.push(se)});let H=[];return O.forEach((se,ee)=>{var et;let ie=se.map(lt=>({...lt,displayPnL:tn(lt.pnl,rn(lt),U)})),ve=ie.filter(lt=>lt.displayPnL>R),Se=ie.filter(lt=>lt.displayPnL<j),Me=ve.reduce((lt,mt)=>lt+mt.displayPnL,0),le=Se.reduce((lt,mt)=>lt+Math.abs(mt.displayPnL),0),Ye=ve.length+Se.length,ue=Ye>0?ve.length/Ye:0,We=le>0?Me/le:Me>0?1/0:0,Ke=ie.reduce((lt,mt)=>lt+mt.displayPnL,0),Ze=se.reduce((lt,mt)=>{let cn=xt(mt.pnl,mt.rMultiple,mt.riskAmount,N);return cn!==void 0&&!isNaN(cn)?lt+cn:lt},0),[St,Zr]=ee.split("-"),Ee=parseInt(St,10),ge=parseInt(Zr.replace("Q",""),10),oe=(ge-1)*3,me=new Date(Ee,oe,1),Ce;try{let lt=(et=t==null?void 0:t.serviceManager)==null?void 0:et.getFolderPathService();lt&&(Ce=lt.getQuarterlyReviewPathSync(Ee,ge))}catch(lt){console.error(`Error getting quarterly review path for ${ee}:`,lt)}H.push({quarter:`Q${ge}`,quarterNumber:ge,year:Ee,quarterStart:me,tradeCount:se.length,winRate:ue,profitFactor:We,pnl:Ke,pnlR:Ze,quarterlyPath:Ce})}),H.sort((se,ee)=>Rc(ee.quarterStart,se.quarterStart)),H},[f,h,t]),S=async(N,U)=>{if(!n&&!(!N||!U))try{t.app.vault.getAbstractFileByPath(N)?await t.openFile(N,!1):t.settings.drc.autoCreateDRCOnNavigation&&(await t.drcService.createDRC(U),await t.openFile(N,!1))}catch(j){console.error("[BreakdownTableWidget] Error opening DRC:",j)}},w=async(N,U)=>{if(!n&&!(!N||!U))try{t.app.vault.getAbstractFileByPath(N)?await t.openFile(N,!1):t.settings.weekly.autoCreateWeeklyReviewOnNavigation&&(await t.weeklyReviewService.createWeeklyReview(U),await t.openFile(N,!1))}catch(j){console.error("[BreakdownTableWidget] Error opening weekly review:",j)}},C=async(N,U)=>{var j;if(!n&&!(!N||!U))try{t.app.vault.getAbstractFileByPath(N)?await t.openFile(N,!1):(j=t.settings.monthly)!=null&&j.autoCreateMonthlyReviewOnNavigation&&(await t.monthlyReviewService.createMonthlyReview(U),await t.openFile(N,!1))}catch(R){console.error("[BreakdownTableWidget] Error opening monthly review:",R)}},D=async(N,U)=>{var j;if(!n&&!(!N||!U))try{t.app.vault.getAbstractFileByPath(N)?await t.openFile(N,!1):(j=t.settings.quarterly)!=null&&j.autoCreateQuarterlyReviewOnNavigation&&(await t.quarterlyReviewService.createQuarterlyReview(U),await t.openFile(N,!1))}catch(R){console.error("[BreakdownTableWidget] Error opening quarterly review:",R)}},P={width:"100%",borderCollapse:"collapse",fontSize:"0.9rem",tableLayout:"fixed"},M={date:"28%",trades:"12%",pnl:"28%",winRate:"16%",profitFactor:"16%"},z={borderBottom:"2px solid var(--background-modifier-border)",padding:"0.5rem",textAlign:"center",fontWeight:600,color:"var(--text-muted)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",background:"var(--background-secondary)"},A={borderBottom:"1px solid var(--background-modifier-border-hover)",cursor:"pointer",transition:"background-color 0.1s"},I={padding:"0.75rem 0.5rem",textAlign:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"};if(u){let{columns:N}=o,U=f==="week"?4:f==="month"?3:f==="quarter"?4:5,j=f==="week"?"Week":f==="month"?"Month":f==="quarter"?"Quarter":"Date",R=f==="week"?35:f==="month"?100:f==="quarter"?60:70;return $e.default.createElement("table",{style:P,className:"weekly-review-trades-table"},$e.default.createElement("thead",null,$e.default.createElement("tr",null,(N==null?void 0:N.date)&&$e.default.createElement("th",{style:{...z,width:M.date}},j),(N==null?void 0:N.trades)&&$e.default.createElement("th",{style:{...z,width:M.trades}},"Trades"),(N==null?void 0:N.pnl)&&$e.default.createElement("th",{style:{...z,width:M.pnl}},"P&L"),(N==null?void 0:N.winRate)&&$e.default.createElement("th",{style:{...z,width:M.winRate}},"Win %"),(N==null?void 0:N.profitFactor)&&$e.default.createElement("th",{style:{...z,width:M.profitFactor}},"PF"))),$e.default.createElement("tbody",null,Array.from({length:U}).map((O,H)=>$e.default.createElement("tr",{key:H,style:{...A,cursor:"default"}},(N==null?void 0:N.date)&&$e.default.createElement("td",{style:I},$e.default.createElement(ae,{width:R,height:14,borderRadius:"4px"})),(N==null?void 0:N.trades)&&$e.default.createElement("td",{style:I},$e.default.createElement(ae,{width:25,height:14,borderRadius:"4px"})),(N==null?void 0:N.pnl)&&$e.default.createElement("td",{style:I},$e.default.createElement(ae,{width:65,height:14,borderRadius:"4px"})),(N==null?void 0:N.winRate)&&$e.default.createElement("td",{style:I},$e.default.createElement(ae,{width:40,height:14,borderRadius:"4px"})),(N==null?void 0:N.profitFactor)&&$e.default.createElement("td",{style:I},$e.default.createElement(ae,{width:35,height:14,borderRadius:"4px"}))))))}let L=((_=($=t==null?void 0:t.settings)==null?void 0:$.general)==null?void 0:_.currency)||"USD",E=((W=(B=t==null?void 0:t.settings)==null?void 0:B.trade)==null?void 0:W.displayRMultiples)||!1,{columns:T}=o;return f==="day"?y.length===0?$e.default.createElement("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-muted)"}},"No trading days this week"):$e.default.createElement("table",{style:P,className:"weekly-review-trades-table"},$e.default.createElement("thead",null,$e.default.createElement("tr",null,(T==null?void 0:T.date)&&$e.default.createElement("th",{style:{...z,width:M.date}},"Date"),(T==null?void 0:T.trades)&&$e.default.createElement("th",{style:{...z,width:M.trades}},"Trades"),(T==null?void 0:T.pnl)&&$e.default.createElement("th",{style:{...z,width:M.pnl}},"P&L"),(T==null?void 0:T.winRate)&&$e.default.createElement("th",{style:{...z,width:M.winRate}},"Win %"),(T==null?void 0:T.profitFactor)&&$e.default.createElement("th",{style:{...z,width:M.profitFactor}},"PF"))),$e.default.createElement("tbody",null,y.map((N,U)=>$e.default.createElement("tr",{key:U,style:A,className:"weekly-review-trade-row",onClick:()=>S(N.drcPath,N.rawDate),onMouseEnter:j=>j.currentTarget.style.backgroundColor="var(--background-modifier-hover)",onMouseLeave:j=>j.currentTarget.style.backgroundColor="transparent"},(T==null?void 0:T.date)&&$e.default.createElement("td",{style:I},N.date),(T==null?void 0:T.trades)&&$e.default.createElement("td",{style:I},N.tradeCount),(T==null?void 0:T.pnl)&&$e.default.createElement("td",{style:{...I,color:N.pnl>=0?"var(--color-green)":"var(--color-red)",fontWeight:600}},ye(N.pnl,!0,L,E,N.pnlR)),(T==null?void 0:T.winRate)&&$e.default.createElement("td",{style:I},so(N.winRate*100)),(T==null?void 0:T.profitFactor)&&$e.default.createElement("td",{style:{...I,color:N.profitFactor>=1?"var(--color-green)":"var(--color-red)"}},N.profitFactor===1/0?"\u221E":N.profitFactor.toFixed(2)))))):f==="week"?b.length===0?$e.default.createElement("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-muted)"}},"No trading weeks this month"):$e.default.createElement("table",{style:P,className:"weekly-review-trades-table"},$e.default.createElement("thead",null,$e.default.createElement("tr",null,(T==null?void 0:T.date)&&$e.default.createElement("th",{style:{...z,width:M.date}},"Week"),(T==null?void 0:T.trades)&&$e.default.createElement("th",{style:{...z,width:M.trades}},"Trades"),(T==null?void 0:T.pnl)&&$e.default.createElement("th",{style:{...z,width:M.pnl}},"P&L"),(T==null?void 0:T.winRate)&&$e.default.createElement("th",{style:{...z,width:M.winRate}},"Win %"),(T==null?void 0:T.profitFactor)&&$e.default.createElement("th",{style:{...z,width:M.profitFactor}},"PF"))),$e.default.createElement("tbody",null,b.map((N,U)=>$e.default.createElement("tr",{key:U,style:A,className:"weekly-review-trade-row",onClick:()=>w(N.weeklyPath,N.firstDate),onMouseEnter:j=>j.currentTarget.style.backgroundColor="var(--background-modifier-hover)",onMouseLeave:j=>j.currentTarget.style.backgroundColor="transparent"},(T==null?void 0:T.date)&&$e.default.createElement("td",{style:I},N.week),(T==null?void 0:T.trades)&&$e.default.createElement("td",{style:I},N.tradeCount),(T==null?void 0:T.pnl)&&$e.default.createElement("td",{style:{...I,color:N.pnl>=0?"var(--color-green)":"var(--color-red)",fontWeight:600}},ye(N.pnl,!0,L,E,N.pnlR)),(T==null?void 0:T.winRate)&&$e.default.createElement("td",{style:I},so(N.winRate*100)),(T==null?void 0:T.profitFactor)&&$e.default.createElement("td",{style:{...I,color:N.profitFactor>=1?"var(--color-green)":"var(--color-red)"}},N.profitFactor===1/0?"\u221E":N.profitFactor.toFixed(2)))))):f==="month"?k.length===0?$e.default.createElement("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-muted)"}},"No trading months this quarter"):$e.default.createElement("table",{style:P,className:"weekly-review-trades-table"},$e.default.createElement("thead",null,$e.default.createElement("tr",null,(T==null?void 0:T.date)&&$e.default.createElement("th",{style:{...z,width:M.date}},"Month"),(T==null?void 0:T.trades)&&$e.default.createElement("th",{style:{...z,width:M.trades}},"Trades"),(T==null?void 0:T.pnl)&&$e.default.createElement("th",{style:{...z,width:M.pnl}},"P&L"),(T==null?void 0:T.winRate)&&$e.default.createElement("th",{style:{...z,width:M.winRate}},"Win %"),(T==null?void 0:T.profitFactor)&&$e.default.createElement("th",{style:{...z,width:M.profitFactor}},"PF"))),$e.default.createElement("tbody",null,k.map((N,U)=>$e.default.createElement("tr",{key:U,style:A,className:"weekly-review-trade-row",onClick:()=>C(N.monthlyPath,N.monthStart),onMouseEnter:j=>j.currentTarget.style.backgroundColor="var(--background-modifier-hover)",onMouseLeave:j=>j.currentTarget.style.backgroundColor="transparent"},(T==null?void 0:T.date)&&$e.default.createElement("td",{style:I},N.month),(T==null?void 0:T.trades)&&$e.default.createElement("td",{style:I},N.tradeCount),(T==null?void 0:T.pnl)&&$e.default.createElement("td",{style:{...I,color:N.pnl>=0?"var(--color-green)":"var(--color-red)",fontWeight:600}},ye(N.pnl,!0,L,E,N.pnlR)),(T==null?void 0:T.winRate)&&$e.default.createElement("td",{style:I},so(N.winRate*100)),(T==null?void 0:T.profitFactor)&&$e.default.createElement("td",{style:{...I,color:N.profitFactor>=1?"var(--color-green)":"var(--color-red)"}},N.profitFactor===1/0?"\u221E":N.profitFactor.toFixed(2)))))):f==="quarter"?x.length===0?$e.default.createElement("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-muted)"}},"No trading quarters this year"):$e.default.createElement("table",{style:P,className:"weekly-review-trades-table"},$e.default.createElement("thead",null,$e.default.createElement("tr",null,(T==null?void 0:T.date)&&$e.default.createElement("th",{style:{...z,width:M.date}},"Quarter"),(T==null?void 0:T.trades)&&$e.default.createElement("th",{style:{...z,width:M.trades}},"Trades"),(T==null?void 0:T.pnl)&&$e.default.createElement("th",{style:{...z,width:M.pnl}},"P&L"),(T==null?void 0:T.winRate)&&$e.default.createElement("th",{style:{...z,width:M.winRate}},"Win %"),(T==null?void 0:T.profitFactor)&&$e.default.createElement("th",{style:{...z,width:M.profitFactor}},"PF"))),$e.default.createElement("tbody",null,x.map((N,U)=>$e.default.createElement("tr",{key:U,style:A,className:"weekly-review-trade-row",onClick:()=>D(N.quarterlyPath,N.quarterStart),onMouseEnter:j=>j.currentTarget.style.backgroundColor="var(--background-modifier-hover)",onMouseLeave:j=>j.currentTarget.style.backgroundColor="transparent"},(T==null?void 0:T.date)&&$e.default.createElement("td",{style:I},N.quarter),(T==null?void 0:T.trades)&&$e.default.createElement("td",{style:I},N.tradeCount),(T==null?void 0:T.pnl)&&$e.default.createElement("td",{style:{...I,color:N.pnl>=0?"var(--color-green)":"var(--color-red)",fontWeight:600}},ye(N.pnl,!0,L,E,N.pnlR)),(T==null?void 0:T.winRate)&&$e.default.createElement("td",{style:I},so(N.winRate*100)),(T==null?void 0:T.profitFactor)&&$e.default.createElement("td",{style:{...I,color:N.profitFactor>=1?"var(--color-green)":"var(--color-red)"}},N.profitFactor===1/0?"\u221E":N.profitFactor.toFixed(2)))))):null});Dk.displayName="BreakdownTableWidget"});var K0e,v9e,J0e,Q0e=F(()=>{K0e=Y(Q());uu();v9e=KH(vP,"trades"),J0e=({trades:e,height:t=300,dateFormat:r})=>K0e.default.createElement(v9e,{trades:e,dateFormat:r,height:t,onPointClick:(n,i)=>{n!=null&&n.path}})});var jn,Ek,iz=F(()=>{jn=Y(Q());Q0e();rs();Dn();Ek=({filePath:e,plugin:t,config:r={},preview:n=!1,previewData:i})=>{var m;let{trades:a,loading:o}=sn(e,t),s=n&&i?i.trades:a,l=n?!1:o,c=(m=r.height)!=null?m:300,d={display:"flex",justifyContent:"center",alignItems:"center",padding:"8px 12px 4px 12px"},u={fontSize:"0.7rem",fontWeight:500,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.5px",textAlign:"center"},p={overflow:"hidden"};return l?jn.default.createElement("div",{style:p},jn.default.createElement("div",{style:d},jn.default.createElement("div",{style:u},"Trades")),jn.default.createElement("div",{style:{padding:"8px 8px 0 8px"}},jn.default.createElement("div",{style:{position:"relative",height:`${c}px`}},jn.default.createElement("div",{style:{position:"absolute",left:0,top:0,bottom:25,width:35,display:"flex",flexDirection:"column",justifyContent:"space-between"}},jn.default.createElement(ae,{width:30,height:10,borderRadius:"4px"}),jn.default.createElement(ae,{width:25,height:10,borderRadius:"4px"}),jn.default.createElement(ae,{width:28,height:10,borderRadius:"4px"})),jn.default.createElement("div",{style:{marginLeft:40,height:"calc(100% - 25px)",display:"flex",alignItems:"flex-end",justifyContent:"space-around",gap:"4px"}},jn.default.createElement(ae,{width:18,height:"45%",borderRadius:"2px"}),jn.default.createElement(ae,{width:18,height:"25%",borderRadius:"2px"}),jn.default.createElement(ae,{width:18,height:"60%",borderRadius:"2px"}),jn.default.createElement(ae,{width:18,height:"15%",borderRadius:"2px"}),jn.default.createElement(ae,{width:18,height:"35%",borderRadius:"2px"}),jn.default.createElement(ae,{width:18,height:"50%",borderRadius:"2px"}),jn.default.createElement(ae,{width:18,height:"20%",borderRadius:"2px"}),jn.default.createElement(ae,{width:18,height:"40%",borderRadius:"2px"}),jn.default.createElement(ae,{width:18,height:"30%",borderRadius:"2px"}),jn.default.createElement(ae,{width:18,height:"55%",borderRadius:"2px"})),jn.default.createElement("div",{style:{position:"absolute",bottom:20,left:40,right:0,height:1,background:"var(--background-modifier-border)"}}),jn.default.createElement("div",{style:{position:"absolute",bottom:0,left:40,right:0,display:"flex",justifyContent:"space-around"}},Array.from({length:5}).map((g,f)=>jn.default.createElement(ae,{key:f,width:15,height:10,borderRadius:"4px"})))))):s.length===0?jn.default.createElement("div",{style:p},jn.default.createElement("div",{style:d},jn.default.createElement("div",{style:u},"Trades")),jn.default.createElement("div",{style:{padding:"1rem",textAlign:"center",color:"var(--text-muted)"}},"No trades for this period")):jn.default.createElement("div",{style:p},jn.default.createElement("div",{style:d},jn.default.createElement("div",{style:u},"Trades")),jn.default.createElement("div",{style:{padding:"8px 8px 0 8px"}},jn.default.createElement(J0e,{trades:s,height:c})))}});var mr,y9e,b9e,Qb,az=F(()=>{mr=Y(Q());qt();As();Jn();Vo();_t();rs();qi();Dn();y9e={showBest:!0,showWorst:!0,showDuration:!0,showSetups:!0,showMistakes:!0},b9e=(e,t)=>{try{let r=new Date(e),i=new Date(t).getTime()-r.getTime();if(i<0)return"N/A";let a=Math.floor(i/(1e3*60*60)),o=Math.floor(i%(1e3*60*60)/(1e3*60));return a>0?`${a}h ${o}m`:`${o}m`}catch(r){return"N/A"}},Qb=mr.default.memo(({filePath:e,plugin:t,config:r={},preview:n,previewData:i})=>{var N,U,j,R,O,H,q,V,J,K,G;let a={...y9e,...r},{trades:o,loading:s}=sn(e,t),l=n&&i?i.trades:o,c=n?!1:s,[d,u]=(0,mr.useState)(0);Xe("settings:changed",(0,mr.useCallback)(()=>{u(X=>X+1)},[]),!n);let p=((U=(N=t==null?void 0:t.settings)==null?void 0:N.trade)==null?void 0:U.showCopyTradingPnL)||!1,{bestTrade:m,worstTrade:g,bestDisplayPnL:f,worstDisplayPnL:v}=(0,mr.useMemo)(()=>{let te=l.filter(ee=>!yt({tradeStatus:ee.tradeStatus,exitTime:ee.exitTime,pnl:ee.pnl,useDirectPnLInput:ee.useDirectPnLInput,exits:ee.exits,entries:ee.entries})).map(ee=>{var Me;let ie=rn(ee),ve=tn(ee.pnl,ie,p),Se=Ml(ee,(Me=t==null?void 0:t.settings)==null?void 0:Me.trade);return{...ee,displayPnL:ve,status:Se}}),re=te.filter(ee=>ee.status==="win"),Z=te.filter(ee=>ee.status==="loss"),ne=re.length>0?re.reduce((ee,ie)=>ee.displayPnL>ie.displayPnL?ee:ie):null,se=Z.length>0?Z.reduce((ee,ie)=>ee.displayPnL<ie.displayPnL?ee:ie):null;return{bestTrade:ne,worstTrade:se,bestDisplayPnL:ne==null?void 0:ne.displayPnL,worstDisplayPnL:se==null?void 0:se.displayPnL}},[l,p,(j=t==null?void 0:t.settings)==null?void 0:j.trade,d]),h=async X=>{if(!n)try{await t.openFile(X,!1)}catch(te){console.error("[BestWorstTradesWidget] Error opening note:",te)}},y=((O=(R=t==null?void 0:t.settings)==null?void 0:R.general)==null?void 0:O.currency)||"USD",b=((q=(H=t==null?void 0:t.settings)==null?void 0:H.trade)==null?void 0:q.displayRMultiples)||!1,k=(J=(V=t==null?void 0:t.settings)==null?void 0:V.trade)==null?void 0:J.defaultRiskAmount,x=((G=(K=t==null?void 0:t.settings)==null?void 0:K.trade)==null?void 0:G.dateFormat)||"DDMMYY",S=100,w={display:"grid",gridTemplateColumns:a.showBest&&a.showWorst?"1fr 1fr":"1fr",gap:"1rem"},C=X=>({display:"flex",alignItems:"stretch",minHeight:S,height:"100%",padding:"1rem",background:"var(--background-primary)",borderRadius:"var(--radius-m)",border:"1px solid var(--background-modifier-border)",borderLeft:`3px solid ${X?"var(--text-success)":"var(--text-error)"}`,cursor:n?"default":"pointer",transition:"background 0.15s ease",gap:"1rem",overflow:"hidden"}),D={display:"flex",alignItems:"center",justifyContent:"center",minHeight:S,padding:"1rem",background:"var(--background-primary)",borderRadius:"var(--radius-m)",border:"1px solid var(--background-modifier-border)",textAlign:"center",color:"var(--text-muted)"},P={fontSize:"0.7rem",fontWeight:500,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"0.25rem"},M={display:"flex",flexDirection:"column",justifyContent:"center",minWidth:"90px",flexShrink:0,gap:"0.125rem"},z={fontSize:"0.75rem",color:"var(--text-muted)",lineHeight:1.3},A=X=>({fontSize:"1.25rem",fontWeight:700,color:X?"var(--text-success)":"var(--text-error)",lineHeight:1.2}),I={display:"flex",flexDirection:"column",justifyContent:"center",flex:1,minWidth:0,gap:"0.25rem"},L={display:"flex",alignItems:"baseline",gap:"0.5rem",flexWrap:"nowrap"},E={fontSize:"1rem",fontWeight:600,color:"var(--text-normal)",whiteSpace:"nowrap"},T={fontSize:"0.8rem",fontWeight:400,color:"var(--text-muted)"},$={display:"flex",flexWrap:"nowrap",gap:"0.25rem",overflow:"hidden"},_=X=>({fontSize:"0.65rem",padding:"0.125rem 0.375rem",borderRadius:"999px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"120px",flexShrink:X==="overflow"?0:1,background:X==="mistake"?"rgba(var(--color-red-rgb), 0.15)":X==="setup"?"rgba(var(--color-blue-rgb), 0.15)":"var(--background-modifier-border)",color:X==="mistake"?"var(--text-error)":X==="setup"?"var(--color-blue)":"var(--text-muted)"});if(c){let X=Z=>({display:"flex",alignItems:"stretch",minHeight:S,height:"100%",padding:"1rem",background:"var(--background-primary)",borderRadius:"var(--radius-m)",border:"1px solid var(--background-modifier-border)",borderLeft:`3px solid ${Z?"var(--text-success)":"var(--text-error)"}`,gap:"1rem"}),te={display:"flex",flexDirection:"column",height:"100%",minWidth:0,overflow:"hidden"},re=(Z,ne)=>mr.default.createElement("div",{style:te},mr.default.createElement("div",{style:P},ne),mr.default.createElement("div",{style:X(Z)},mr.default.createElement("div",{style:M},mr.default.createElement(ae,{width:70,height:20,borderRadius:"4px"}),mr.default.createElement("div",{style:{marginTop:"0.25rem"}},mr.default.createElement(ae,{width:50,height:12,borderRadius:"4px"})),mr.default.createElement("div",{style:{marginTop:"0.25rem"}},mr.default.createElement(ae,{width:35,height:10,borderRadius:"4px"}))),mr.default.createElement("div",{style:I},mr.default.createElement("div",{style:L},mr.default.createElement(ae,{width:60,height:16,borderRadius:"4px"}),mr.default.createElement(ae,{width:35,height:12,borderRadius:"4px"})),mr.default.createElement("div",{style:$},mr.default.createElement(ae,{width:50,height:18,borderRadius:"10px"}),mr.default.createElement(ae,{width:40,height:18,borderRadius:"10px"})),mr.default.createElement("div",{style:$},mr.default.createElement(ae,{width:55,height:18,borderRadius:"10px"})))));return mr.default.createElement("div",{style:w},a.showBest&&re(!0,"Best Trade"),a.showWorst&&re(!1,"Worst Trade"))}let B={display:"flex",flexDirection:"column",height:"100%",minWidth:0,overflow:"hidden"},W=(X,te,re)=>{var We,Ke;if(!X)return mr.default.createElement("div",{style:B},mr.default.createElement("div",{style:P},re),mr.default.createElement("div",{style:{...D,flex:1}},te?"No winning trades":"No losing trades"));let Z=xt(X.pnl,X.rMultiple,X.riskAmount,k),ne=(We=X.direction)==null?void 0:We.toLowerCase(),se=ne==="long"?"Long":ne==="short"?"Short":X.direction,ee=X.setup?Array.isArray(X.setup)?X.setup:[X.setup]:[],ie=X.mistake||[],ve=2,Se=ee.slice(0,ve),Me=ee.length-ve,le=2,Ye=ie.slice(0,le),ue=ie.length-le;return mr.default.createElement("div",{style:B},mr.default.createElement("div",{style:P},re),mr.default.createElement("div",{style:{...C(te),flex:1},role:"button",tabIndex:n?-1:0,onClick:()=>h(X.path),onKeyDown:n?void 0:Ze=>{(Ze.key==="Enter"||Ze.key===" ")&&(Ze.preventDefault(),h(X.path))},onMouseEnter:n?void 0:Ze=>{Ze.currentTarget.style.background="var(--background-secondary)"},onMouseLeave:n?void 0:Ze=>{Ze.currentTarget.style.background="var(--background-primary)"},onFocus:n?void 0:Ze=>{Ze.currentTarget.style.background="var(--background-secondary)"},onBlur:n?void 0:Ze=>{Ze.currentTarget.style.background="var(--background-primary)"}},mr.default.createElement("div",{style:M},mr.default.createElement("div",{style:A(te)},ye((Ke=X.displayPnL)!=null?Ke:X.pnl,!0,y,b,Z)),mr.default.createElement("div",{style:z},zt(X.entryTime,x)),a.showDuration&&X.exitTime&&mr.default.createElement("div",{style:z},b9e(X.entryTime,X.exitTime))),mr.default.createElement("div",{style:I},mr.default.createElement("div",{style:L},mr.default.createElement("span",{style:E},X.instrument||"Unknown"),mr.default.createElement("span",{style:T},se)),mr.default.createElement("div",{style:{...$,minHeight:"1.125rem"}},a.showSetups&&Se.map((Ze,St)=>mr.default.createElement("span",{key:`setup-${St}`,style:_("setup")},Ze)),a.showSetups&&Me>0&&mr.default.createElement("span",{style:_("overflow")},"+",Me)),mr.default.createElement("div",{style:{...$,minHeight:"1.125rem"}},a.showMistakes&&Ye.map((Ze,St)=>mr.default.createElement("span",{key:`mistake-${St}`,style:_("mistake")},Ze)),a.showMistakes&&ue>0&&mr.default.createElement("span",{style:_("overflow")},"+",ue)))))};return mr.default.createElement("div",{style:w},a.showBest&&W(m,!0,"Best Trade"),a.showWorst&&W(g,!1,"Worst Trade"))});Qb.displayName="BestWorstTradesWidget"});var ns,Dm,X0e,qr,bu,ZP=F(()=>{ns=Y(Q()),Dm=100,X0e=3,qr={container:e=>({display:"grid",gridTemplateColumns:e?"1fr 1fr":"1fr",gap:"1rem"}),label:{fontSize:"0.7rem",fontWeight:500,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"0.25rem"},card:e=>({display:"flex",alignItems:"stretch",minHeight:Dm,padding:"1rem",background:"var(--background-primary)",borderRadius:"var(--radius-m)",border:"1px solid var(--background-modifier-border)",borderLeft:`3px solid ${e?"var(--text-success)":"var(--text-error)"}`,cursor:"pointer",transition:"background 0.15s ease",gap:"1rem"}),emptyCard:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:Dm,padding:"1rem",background:"var(--background-primary)",borderRadius:"var(--radius-m)",border:"1px solid var(--background-modifier-border)",textAlign:"center",color:"var(--text-muted)"},pnlColumn:{display:"flex",flexDirection:"column",justifyContent:"center",minWidth:"100px",flexShrink:0},pnl:e=>({fontSize:"1.25rem",fontWeight:700,color:e?"var(--text-success)":"var(--text-error)",lineHeight:1.2}),detailsColumn:{display:"flex",flexDirection:"column",justifyContent:"center",flex:1,minWidth:0,gap:"0.25rem"},primaryRow:{display:"flex",alignItems:"baseline",gap:"0.5rem",flexWrap:"wrap"},primaryText:{fontSize:"1rem",fontWeight:600,color:"var(--text-normal)",whiteSpace:"nowrap"},secondaryText:{fontSize:"0.8rem",fontWeight:400,color:"var(--text-muted)"},metaRow:{display:"flex",flexWrap:"wrap",gap:"0.5rem",fontSize:"0.75rem",color:"var(--text-muted)"},metaItem:{display:"flex",alignItems:"center",gap:"0.25rem",whiteSpace:"nowrap"},chipContainer:{display:"flex",flexWrap:"nowrap",gap:"0.25rem",overflow:"hidden"},chip:e=>({fontSize:"0.65rem",padding:"0.125rem 0.375rem",borderRadius:"999px",whiteSpace:"nowrap",flexShrink:0,background:e==="mistake"?"rgba(var(--color-red-rgb), 0.15)":e==="overflow"?"var(--background-modifier-border)":"var(--background-secondary)",color:e==="mistake"?"var(--text-error)":"var(--text-muted)"})},bu=({title:e,isPositive:t,pnl:r,primaryText:n,secondaryText:i,metaItems:a,chips:o=[],onClick:s,emptyMessage:l,isEmpty:c=!1})=>{if(c)return ns.default.createElement("div",null,ns.default.createElement("div",{style:qr.label},e),ns.default.createElement("div",{style:qr.emptyCard},l||"No data available"));let d=o.slice(0,X0e),u=o.length-X0e;return ns.default.createElement("div",null,ns.default.createElement("div",{style:qr.label},e),ns.default.createElement("div",{style:qr.card(t),onClick:s,onMouseEnter:p=>{p.currentTarget.style.background="var(--background-secondary)"},onMouseLeave:p=>{p.currentTarget.style.background="var(--background-primary)"}},ns.default.createElement("div",{style:qr.pnlColumn},ns.default.createElement("div",{style:qr.pnl(t)},r)),ns.default.createElement("div",{style:qr.detailsColumn},ns.default.createElement("div",{style:qr.primaryRow},ns.default.createElement("span",{style:qr.primaryText},n),i&&ns.default.createElement("span",{style:qr.secondaryText},i)),a.length>0&&ns.default.createElement("div",{style:qr.metaRow},a.map((p,m)=>ns.default.createElement("span",{key:m,style:qr.metaItem},m>0&&ns.default.createElement("span",{style:{color:"var(--text-faint)"}},"\xB7"),p))),d.length>0&&ns.default.createElement("div",{style:qr.chipContainer},d.map((p,m)=>ns.default.createElement("span",{key:m,style:qr.chip(p.type)},p.text)),u>0&&ns.default.createElement("span",{style:qr.chip("overflow")},"+",u)))))}});var _a,x9e,Ik,oz=F(()=>{_a=Y(Q());qt();As();Jn();Vo();_t();Oa();ZP();ro();rs();qi();Dn();x9e={showBest:!0,showWorst:!0,showTradeCount:!0,showWinRate:!0},Ik=_a.default.memo(({filePath:e,plugin:t,config:r={},preview:n=!1,previewData:i})=>{var P,M,z,A,I,L,E,T,$,_,B,W,N,U,j,R;let a={...x9e,...r},{trades:o,loading:s,noteType:l,dateRange:c}=sn(e,t),d=n&&i?i.trades:o,u=n?!1:s,[,p]=(0,_a.useState)(0);Xe("settings:changed",(0,_a.useCallback)(()=>{p(O=>O+1)},[]),!n);let m=n||l!=="drc"&&l!=="trade",g=((M=(P=t==null?void 0:t.settings)==null?void 0:P.general)==null?void 0:M.currency)||"USD",f=((A=(z=t==null?void 0:t.settings)==null?void 0:z.trade)==null?void 0:A.displayRMultiples)||!1,v=((L=(I=t==null?void 0:t.settings)==null?void 0:I.trade)==null?void 0:L.showCopyTradingPnL)||!1,h=(T=(E=t==null?void 0:t.settings)==null?void 0:E.trade)==null?void 0:T.defaultRiskAmount,y=(B=(_=($=t==null?void 0:t.settings)==null?void 0:$.trade)==null?void 0:_.breakEvenRangeMin)!=null?B:0,b=(U=(N=(W=t==null?void 0:t.settings)==null?void 0:W.trade)==null?void 0:N.breakEvenRangeMax)!=null?U:0,k=((R=(j=t==null?void 0:t.settings)==null?void 0:j.trade)==null?void 0:R.dateFormat)||"DDMMYY",{bestDay:x,worstDay:S}=(0,_a.useMemo)(()=>{let O=d.filter(G=>!yt({tradeStatus:G.tradeStatus,exitTime:G.exitTime,pnl:G.pnl,useDirectPnLInput:G.useDirectPnLInput,exits:G.exits,entries:G.entries}));if(O.length===0)return{bestDay:null,worstDay:null};let H=new Map;O.forEach(G=>{var ve;let X=new Date(G.entryTime),te=Zt(X,t),re=te.toISOString().split("T")[0],Z=H.get(re)||{date:te,dateKey:re,pnl:0,pnlR:void 0,tradeCount:0,wins:0,losses:0,breakevens:0,winRate:0},ne=rn(G),se=tn(G.pnl,ne,v),ee=xt(G.pnl,G.rMultiple,G.riskAmount,h);Z.pnl+=se||0,ee!==void 0&&(Z.pnlR=(Z.pnlR||0)+ee),Z.tradeCount+=1;let ie=Ml(G,(ve=t==null?void 0:t.settings)==null?void 0:ve.trade);ie==="win"?Z.wins+=1:ie==="loss"?Z.losses+=1:ie==="breakeven"&&(Z.breakevens+=1),H.set(re,Z)}),H.forEach(G=>{let X=G.wins+G.losses;G.winRate=X>0?G.wins/X*100:0});let V=[...Array.from(H.values())].sort((G,X)=>X.pnl-G.pnl),J=V[0]||null,K=V[V.length-1]||null;return{bestDay:J&&J.pnl>b?J:null,worstDay:K&&K.pnl<y?K:null}},[d,t,v,h,y,b]),w=O=>`${["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][O.getDay()]}, ${zt(O,k,"/")}`;if(u){let O=q=>({display:"flex",alignItems:"stretch",minHeight:Dm,padding:"1rem",background:"var(--background-primary)",borderRadius:"var(--radius-m)",border:"1px solid var(--background-modifier-border)",borderLeft:`3px solid ${q?"var(--text-success)":"var(--text-error)"}`,gap:"1rem"}),H=(q,V)=>_a.default.createElement("div",null,_a.default.createElement("div",{style:qr.label},V),_a.default.createElement("div",{style:O(q)},_a.default.createElement("div",{style:qr.pnlColumn},_a.default.createElement(ae,{width:70,height:20,borderRadius:"4px"})),_a.default.createElement("div",{style:qr.detailsColumn},_a.default.createElement(ae,{width:140,height:16,borderRadius:"4px"}),_a.default.createElement("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.25rem"}},_a.default.createElement(ae,{width:50,height:12,borderRadius:"4px"}),_a.default.createElement(ae,{width:70,height:12,borderRadius:"4px"})))));return _a.default.createElement("div",{style:qr.container(!!(a.showBest&&a.showWorst))},a.showBest&&H(!0,"Best Day"),a.showWorst&&H(!1,"Worst Day"))}let C=async O=>{var H,q;if(!n)try{let V=(H=t.drcService)==null?void 0:H.getDRCNotePath(O);if(!V)return;if(t.app.vault.getAbstractFileByPath(V))await t.openFile(V,!1);else if(t.settings.drc.autoCreateDRCOnNavigation){await t.drcService.createDRC(O);let K=(q=t.drcService)==null?void 0:q.getDRCNotePath(O);K&&await t.openFile(K,!1)}}catch(V){console.error("[BestWorstDaysWidget] Error opening DRC:",V)}},D=O=>{let H=[];return a.showTradeCount&&H.push(`${O.tradeCount} trade${O.tradeCount!==1?"s":""}`),a.showWinRate&&H.push(`${O.winRate.toFixed(0)}% win rate`),H};return!n&&!m?_a.default.createElement(_r,{widgetType:"Best/Worst Days",reason:"This widget is only available in Weekly and Monthly reviews"}):_a.default.createElement("div",{style:qr.container(!!(a.showBest&&a.showWorst))},a.showBest&&_a.default.createElement(bu,{title:"Best Day",isPositive:!0,isEmpty:!x,emptyMessage:"No profitable days",pnl:x?ye(x.pnl,!0,g,f,x.pnlR):"",primaryText:x?w(x.date):"",metaItems:x?D(x):[],onClick:x?()=>C(x.date):void 0}),a.showWorst&&_a.default.createElement(bu,{title:"Worst Day",isPositive:!1,isEmpty:!S,emptyMessage:"No losing days",pnl:S?ye(S.pnl,!0,g,f,S.pnlR):"",primaryText:S?w(S.date):"",metaItems:S?D(S):[],onClick:S?()=>C(S.date):void 0}))});Ik.displayName="BestWorstDaysWidget"});var Ba,w9e,k9e,S9e,Mk,sz=F(()=>{Ba=Y(Q());qt();As();Jn();Vo();_t();Oa();ZP();ro();rs();qi();Dn();w9e={showBest:!0,showWorst:!0,showTradeCount:!0,showWinRate:!0},k9e=e=>{let t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),r=t.getUTCDay()||7;t.setUTCDate(t.getUTCDate()+4-r);let n=new Date(Date.UTC(t.getUTCFullYear(),0,1));return Math.ceil(((t.getTime()-n.getTime())/864e5+1)/7)},S9e=e=>{let t=new Date(e),r=t.getDay(),n=t.getDate()-r+(r===0?-6:1),i=new Date(t.setDate(n));i.setHours(0,0,0,0);let a=new Date(i);return a.setDate(a.getDate()+6),a.setHours(23,59,59,999),{start:i,end:a}},Mk=Ba.default.memo(({filePath:e,plugin:t,config:r={},preview:n=!1,previewData:i})=>{var D,P,M,z,A,I,L,E,T,$,_,B,W,N,U,j;let a={...w9e,...r},{trades:o,loading:s,noteType:l}=sn(e,t),c=n&&i?i.trades:o,d=n?!1:s,[,u]=(0,Ba.useState)(0);Xe("settings:changed",(0,Ba.useCallback)(()=>{u(R=>R+1)},[]),!n);let p=((P=(D=t==null?void 0:t.settings)==null?void 0:D.general)==null?void 0:P.currency)||"USD",m=((z=(M=t==null?void 0:t.settings)==null?void 0:M.trade)==null?void 0:z.displayRMultiples)||!1,g=((I=(A=t==null?void 0:t.settings)==null?void 0:A.trade)==null?void 0:I.showCopyTradingPnL)||!1,f=(E=(L=t==null?void 0:t.settings)==null?void 0:L.trade)==null?void 0:E.defaultRiskAmount,v=(_=($=(T=t==null?void 0:t.settings)==null?void 0:T.trade)==null?void 0:$.breakEvenRangeMin)!=null?_:0,h=(N=(W=(B=t==null?void 0:t.settings)==null?void 0:B.trade)==null?void 0:W.breakEvenRangeMax)!=null?N:0,y=((j=(U=t==null?void 0:t.settings)==null?void 0:U.trade)==null?void 0:j.dateFormat)||"DDMMYY",{bestWeek:b,worstWeek:k}=(0,Ba.useMemo)(()=>{let R=c.filter(K=>!yt({tradeStatus:K.tradeStatus,exitTime:K.exitTime,pnl:K.pnl,useDirectPnLInput:K.useDirectPnLInput,exits:K.exits,entries:K.entries}));if(R.length===0)return{bestWeek:null,worstWeek:null};let O=new Map;R.forEach(K=>{var le;let G=new Date(K.entryTime),X=Zt(G,t),te=k9e(X),re=X.getFullYear(),Z=`${re}-W${te}`,{start:ne,end:se}=S9e(X),ee=O.get(Z)||{weekNumber:te,year:re,weekStart:ne,weekEnd:se,pnl:0,pnlR:0,tradeCount:0,wins:0,losses:0,breakevens:0,winRate:0},ie=rn(K),ve=tn(K.pnl,ie,g),Se=xt(K.pnl,K.rMultiple,K.riskAmount,f);ee.pnl+=ve||0,Se!==void 0&&(ee.pnlR=(ee.pnlR||0)+Se),ee.tradeCount+=1;let Me=Ml(K,(le=t==null?void 0:t.settings)==null?void 0:le.trade);Me==="win"?ee.wins+=1:Me==="loss"?ee.losses+=1:Me==="breakeven"&&(ee.breakevens+=1),O.set(Z,ee)}),O.forEach(K=>{let G=K.wins+K.losses;K.winRate=G>0?K.wins/G*100:0});let q=[...Array.from(O.values())].sort((K,G)=>G.pnl-K.pnl),V=q[0]||null,J=q[q.length-1]||null;return{bestWeek:V&&V.pnl>h?V:null,worstWeek:J&&J.pnl<v?J:null}},[c,t,g,f,v,h]),x=R=>{let O=zt(R.weekStart,y,"/").slice(0,5),H=zt(R.weekEnd,y,"/").slice(0,5);return`Week ${R.weekNumber} (${O} - ${H})`};if(d){let R=H=>({display:"flex",alignItems:"stretch",minHeight:Dm,padding:"1rem",background:"var(--background-primary)",borderRadius:"var(--radius-m)",border:"1px solid var(--background-modifier-border)",borderLeft:`3px solid ${H?"var(--text-success)":"var(--text-error)"}`,gap:"1rem"}),O=(H,q)=>Ba.default.createElement("div",null,Ba.default.createElement("div",{style:qr.label},q),Ba.default.createElement("div",{style:R(H)},Ba.default.createElement("div",{style:qr.pnlColumn},Ba.default.createElement(ae,{width:70,height:20,borderRadius:"4px"})),Ba.default.createElement("div",{style:qr.detailsColumn},Ba.default.createElement(ae,{width:160,height:16,borderRadius:"4px"}),Ba.default.createElement("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.25rem"}},Ba.default.createElement(ae,{width:50,height:12,borderRadius:"4px"}),Ba.default.createElement(ae,{width:70,height:12,borderRadius:"4px"})))));return Ba.default.createElement("div",{style:qr.container(!!(a.showBest&&a.showWorst))},a.showBest&&O(!0,"Best Week"),a.showWorst&&O(!1,"Worst Week"))}let S=async R=>{var O,H;if(!n)try{let q=(O=t.weeklyReviewService)==null?void 0:O.getWeeklyReviewPath(R.weekStart);if(!q)return;if(t.app.vault.getAbstractFileByPath(q))await t.openFile(q,!1);else if(t.settings.weekly.autoCreateWeeklyReviewOnNavigation){await t.weeklyReviewService.createWeeklyReview(R.weekStart);let J=(H=t.weeklyReviewService)==null?void 0:H.getWeeklyReviewPath(R.weekStart);J&&await t.openFile(J,!1)}}catch(q){console.error("[BestWorstWeeksWidget] Error opening weekly review:",q)}},w=R=>{let O=[];return a.showTradeCount&&O.push(`${R.tradeCount} trade${R.tradeCount!==1?"s":""}`),a.showWinRate&&O.push(`${R.winRate.toFixed(0)}% win rate`),O};return!n&&l&&!["weekly-review","monthly-review","quarterly-review","yearly-review"].includes(l)?Ba.default.createElement(_r,{widgetType:"Best/Worst Weeks",reason:"This widget is only available in Weekly, Monthly, Quarterly, and Yearly reviews"}):Ba.default.createElement("div",{style:qr.container(!!(a.showBest&&a.showWorst))},a.showBest&&Ba.default.createElement(bu,{title:"Best Week",isPositive:!0,isEmpty:!b,emptyMessage:"No profitable weeks",pnl:b?ye(b.pnl,!0,p,m,b.pnlR):"",primaryText:b?x(b):"",metaItems:b?w(b):[],onClick:b?()=>S(b):void 0}),a.showWorst&&Ba.default.createElement(bu,{title:"Worst Week",isPositive:!1,isEmpty:!k,emptyMessage:"No losing weeks",pnl:k?ye(k.pnl,!0,p,m,k.pnlR):"",primaryText:k?x(k):"",metaItems:k?w(k):[],onClick:k?()=>S(k):void 0}))});Mk.displayName="BestWorstWeeksWidget"});var Wa,T9e,C9e,P9e,Ak,lz=F(()=>{Wa=Y(Q());qt();As();Jn();Vo();Oa();ZP();ro();rs();qi();Dn();T9e={showBest:!0,showWorst:!0,showTradeCount:!0,showWinRate:!0},C9e=["January","February","March","April","May","June","July","August","September","October","November","December"],P9e=(e,t)=>{let r=new Date(e,t,1,0,0,0,0),n=new Date(e,t+1,0,23,59,59,999);return{start:r,end:n}},Ak=Wa.default.memo(({filePath:e,plugin:t,config:r={},preview:n=!1,previewData:i})=>{var C,D,P,M,z,A,I,L,E,T,$,_,B,W;let a={...T9e,...r},{trades:o,loading:s,noteType:l}=sn(e,t),c=n&&i?i.trades:o,d=n?!1:s,[,u]=(0,Wa.useState)(0);Xe("settings:changed",(0,Wa.useCallback)(()=>{u(N=>N+1)},[]),!n);let p=((D=(C=t==null?void 0:t.settings)==null?void 0:C.general)==null?void 0:D.currency)||"USD",m=((M=(P=t==null?void 0:t.settings)==null?void 0:P.trade)==null?void 0:M.displayRMultiples)||!1,g=((A=(z=t==null?void 0:t.settings)==null?void 0:z.trade)==null?void 0:A.showCopyTradingPnL)||!1,f=(L=(I=t==null?void 0:t.settings)==null?void 0:I.trade)==null?void 0:L.defaultRiskAmount,v=($=(T=(E=t==null?void 0:t.settings)==null?void 0:E.trade)==null?void 0:T.breakEvenRangeMin)!=null?$:0,h=(W=(B=(_=t==null?void 0:t.settings)==null?void 0:_.trade)==null?void 0:B.breakEvenRangeMax)!=null?W:0,{bestMonth:y,worstMonth:b}=(0,Wa.useMemo)(()=>{let N=c.filter(q=>!yt({tradeStatus:q.tradeStatus,exitTime:q.exitTime,pnl:q.pnl,useDirectPnLInput:q.useDirectPnLInput,exits:q.exits,entries:q.entries}));if(N.length===0)return{bestMonth:null,worstMonth:null};let U=new Map;N.forEach(q=>{var ve;let V=new Date(q.entryTime),J=Zt(V,t),K=J.getFullYear(),G=J.getMonth(),X=`${K}-${String(G+1).padStart(2,"0")}`,{start:te,end:re}=P9e(K,G),Z=U.get(X)||{month:G,year:K,monthStart:te,monthEnd:re,pnl:0,pnlR:void 0,tradeCount:0,wins:0,losses:0,breakevens:0,winRate:0},ne=rn(q),se=tn(q.pnl,ne,g),ee=xt(q.pnl,q.rMultiple,q.riskAmount,f);Z.pnl+=se||0,ee!==void 0&&(Z.pnlR=(Z.pnlR||0)+ee),Z.tradeCount+=1;let ie=Ml(q,(ve=t==null?void 0:t.settings)==null?void 0:ve.trade);ie==="win"?Z.wins+=1:ie==="loss"?Z.losses+=1:ie==="breakeven"&&(Z.breakevens+=1),U.set(X,Z)}),U.forEach(q=>{let V=q.wins+q.losses;q.winRate=V>0?q.wins/V*100:0});let R=[...Array.from(U.values())].sort((q,V)=>V.pnl-q.pnl),O=R[0]||null,H=R[R.length-1]||null;return{bestMonth:O&&O.pnl>h?O:null,worstMonth:H&&H.pnl<v?H:null}},[c,t,g,f,v,h]),k=N=>`${C9e[N.month]} ${N.year}`;if(d){let N=j=>({display:"flex",alignItems:"stretch",minHeight:Dm,padding:"1rem",background:"var(--background-primary)",borderRadius:"var(--radius-m)",border:"1px solid var(--background-modifier-border)",borderLeft:`3px solid ${j?"var(--text-success)":"var(--text-error)"}`,gap:"1rem"}),U=(j,R)=>Wa.default.createElement("div",null,Wa.default.createElement("div",{style:qr.label},R),Wa.default.createElement("div",{style:N(j)},Wa.default.createElement("div",{style:qr.pnlColumn},Wa.default.createElement(ae,{width:70,height:20,borderRadius:"4px"})),Wa.default.createElement("div",{style:qr.detailsColumn},Wa.default.createElement(ae,{width:120,height:16,borderRadius:"4px"}),Wa.default.createElement("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.25rem"}},Wa.default.createElement(ae,{width:50,height:12,borderRadius:"4px"}),Wa.default.createElement(ae,{width:70,height:12,borderRadius:"4px"})))));return Wa.default.createElement("div",{style:qr.container(!!(a.showBest&&a.showWorst))},a.showBest&&U(!0,"Best Month"),a.showWorst&&U(!1,"Worst Month"))}let x=async N=>{var U,j,R;if(!n)try{let O=(U=t.monthlyReviewService)==null?void 0:U.getMonthlyReviewPath(N.monthStart);if(!O)return;if(t.app.vault.getAbstractFileByPath(O))await t.openFile(O,!1);else if((j=t.settings.monthly)!=null&&j.autoCreateMonthlyReviewOnNavigation){await t.monthlyReviewService.createMonthlyReview(N.monthStart);let q=(R=t.monthlyReviewService)==null?void 0:R.getMonthlyReviewPath(N.monthStart);q&&await t.openFile(q,!1)}}catch(O){console.error("[BestWorstMonthsWidget] Error opening monthly review:",O)}},S=N=>{let U=[];return a.showTradeCount&&U.push(`${N.tradeCount} trade${N.tradeCount!==1?"s":""}`),a.showWinRate&&U.push(`${N.winRate.toFixed(0)}% win rate`),U};return!n&&l&&!["quarterly-review","yearly-review"].includes(l)?Wa.default.createElement(_r,{widgetType:"Best/Worst Months",reason:"This widget is only available in Quarterly and Yearly reviews"}):Wa.default.createElement("div",{style:qr.container(!!(a.showBest&&a.showWorst))},a.showBest&&Wa.default.createElement(bu,{title:"Best Month",isPositive:!0,isEmpty:!y,emptyMessage:"No profitable months",pnl:y?ye(y.pnl,!0,p,m,y.pnlR):"",primaryText:y?k(y):"",metaItems:y?S(y):[],onClick:y?()=>x(y):void 0}),a.showWorst&&Wa.default.createElement(bu,{title:"Worst Month",isPositive:!1,isEmpty:!b,emptyMessage:"No losing months",pnl:b?ye(b.pnl,!0,p,m,b.pnlR):"",primaryText:b?k(b):"",metaItems:b?S(b):[],onClick:b?()=>x(b):void 0}))});Ak.displayName="BestWorstMonthsWidget"});var $a,D9e,Lk,cz=F(()=>{$a=Y(Q());qt();As();Jn();Vo();Oa();_t();ZP();ro();rs();qi();Dn();D9e={showBest:!0,showWorst:!0,showTradeCount:!0,showWinRate:!0},Lk=$a.default.memo(({filePath:e,plugin:t,config:r={},preview:n=!1,previewData:i})=>{var C,D,P,M,z,A,I,L,E,T,$,_,B,W;let a={...D9e,...r},{trades:o,loading:s,noteType:l}=sn(e,t),c=n&&i?i.trades:o,d=n?!1:s,[,u]=(0,$a.useState)(0);Xe("settings:changed",(0,$a.useCallback)(()=>{u(N=>N+1)},[]),!n);let p=((D=(C=t==null?void 0:t.settings)==null?void 0:C.general)==null?void 0:D.currency)||"USD",m=((M=(P=t==null?void 0:t.settings)==null?void 0:P.trade)==null?void 0:M.displayRMultiples)||!1,g=((A=(z=t==null?void 0:t.settings)==null?void 0:z.trade)==null?void 0:A.showCopyTradingPnL)||!1,f=(L=(I=t==null?void 0:t.settings)==null?void 0:I.trade)==null?void 0:L.defaultRiskAmount,v=($=(T=(E=t==null?void 0:t.settings)==null?void 0:E.trade)==null?void 0:T.breakEvenRangeMin)!=null?$:0,h=(W=(B=(_=t==null?void 0:t.settings)==null?void 0:_.trade)==null?void 0:B.breakEvenRangeMax)!=null?W:0,{bestQuarter:y,worstQuarter:b}=(0,$a.useMemo)(()=>{let N=c.filter(q=>!yt({tradeStatus:q.tradeStatus,exitTime:q.exitTime,pnl:q.pnl,useDirectPnLInput:q.useDirectPnLInput,exits:q.exits,entries:q.entries}));if(N.length===0)return{bestQuarter:null,worstQuarter:null};let U=new Map;N.forEach(q=>{var ve;let V=new Date(q.entryTime),J=Zt(V,t),K=J.getFullYear(),G=Ap(J),X=`${K}-Q${G}`,te=sf(K,G),re=ey(K,G),Z=U.get(X)||{quarter:G,year:K,quarterStart:te,quarterEnd:re,pnl:0,pnlR:void 0,tradeCount:0,wins:0,losses:0,breakevens:0,winRate:0},ne=rn(q),se=tn(q.pnl,ne,g),ee=xt(q.pnl,q.rMultiple,q.riskAmount,f);Z.pnl+=se||0,ee!==void 0&&(Z.pnlR=(Z.pnlR||0)+ee),Z.tradeCount+=1;let ie=Ml(q,(ve=t==null?void 0:t.settings)==null?void 0:ve.trade);ie==="win"?Z.wins+=1:ie==="loss"?Z.losses+=1:ie==="breakeven"&&(Z.breakevens+=1),U.set(X,Z)}),U.forEach(q=>{let V=q.wins+q.losses;q.winRate=V>0?q.wins/V*100:0});let R=[...Array.from(U.values())].sort((q,V)=>V.pnl-q.pnl),O=R[0]||null,H=R[R.length-1]||null;return{bestQuarter:O&&O.pnl>h?O:null,worstQuarter:H&&H.pnl<v?H:null}},[c,t,g,f,v,h]),k=N=>`Q${N.quarter} ${N.year}`;if(d){let N=j=>({display:"flex",alignItems:"stretch",minHeight:Dm,padding:"1rem",background:"var(--background-primary)",borderRadius:"var(--radius-m)",border:"1px solid var(--background-modifier-border)",borderLeft:`3px solid ${j?"var(--text-success)":"var(--text-error)"}`,gap:"1rem"}),U=(j,R)=>$a.default.createElement("div",null,$a.default.createElement("div",{style:qr.label},R),$a.default.createElement("div",{style:N(j)},$a.default.createElement("div",{style:qr.pnlColumn},$a.default.createElement(ae,{width:70,height:20,borderRadius:"4px"})),$a.default.createElement("div",{style:qr.detailsColumn},$a.default.createElement(ae,{width:80,height:16,borderRadius:"4px"}),$a.default.createElement("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.25rem"}},$a.default.createElement(ae,{width:50,height:12,borderRadius:"4px"}),$a.default.createElement(ae,{width:70,height:12,borderRadius:"4px"})))));return $a.default.createElement("div",{style:qr.container(!!(a.showBest&&a.showWorst))},a.showBest&&U(!0,"Best Quarter"),a.showWorst&&U(!1,"Worst Quarter"))}let x=async N=>{var U,j,R;if(!n)try{let O=await((U=t.quarterlyReviewService)==null?void 0:U.getQuarterlyReviewPath(N.quarterStart));if(!O)return;if(t.app.vault.getAbstractFileByPath(O))await t.openFile(O,!1);else if((j=t.settings.quarterly)!=null&&j.autoCreateQuarterlyReviewOnNavigation){await t.quarterlyReviewService.createQuarterlyReview(N.quarterStart);let q=await((R=t.quarterlyReviewService)==null?void 0:R.getQuarterlyReviewPath(N.quarterStart));q&&await t.openFile(q,!1)}}catch(O){console.error("[BestWorstQuartersWidget] Error opening quarterly review:",O)}},S=N=>{let U=[];return a.showTradeCount&&U.push(`${N.tradeCount} trade${N.tradeCount!==1?"s":""}`),a.showWinRate&&U.push(`${N.winRate.toFixed(0)}% win rate`),U};return!n&&l&&!["yearly-review"].includes(l)?$a.default.createElement(_r,{widgetType:"Best/Worst Quarters",reason:"This widget is only available in Yearly reviews"}):$a.default.createElement("div",{style:qr.container(!!(a.showBest&&a.showWorst))},a.showBest&&$a.default.createElement(bu,{title:"Best Quarter",isPositive:!0,isEmpty:!y,emptyMessage:"No profitable quarters",pnl:y?ye(y.pnl,!0,p,m,y.pnlR):"",primaryText:y?k(y):"",metaItems:y?S(y):[],onClick:y?()=>x(y):void 0}),a.showWorst&&$a.default.createElement(bu,{title:"Worst Quarter",isPositive:!1,isEmpty:!b,emptyMessage:"No losing quarters",pnl:b?ye(b.pnl,!0,p,m,b.pnlR):"",primaryText:b?k(b):"",metaItems:b?S(b):[],onClick:b?()=>x(b):void 0}))});Lk.displayName="BestWorstQuartersWidget"});var ut,E9e,Nk,dz=F(()=>{ut=Y(Q());VH();qt();As();Jn();Vo();rs();qi();Dn();E9e={showChart:!0,showTable:!0,topN:void 0,sortBy:"pnl",height:250},Nk=ut.default.memo(({filePath:e,plugin:t,config:r={},preview:n=!1,previewData:i})=>{var S,w,C,D;let a={...E9e,...r},{trades:o,loading:s}=sn(e,t),l=n&&i?i.trades:o,c=n?!1:s,[,d]=(0,ut.useState)(0);Xe("settings:changed",(0,ut.useCallback)(()=>{d(P=>P+1)},[]),!n);let u=(0,ut.useMemo)(()=>{var E,T,$,_,B,W,N,U;let P=l.filter(j=>!yt({tradeStatus:j.tradeStatus,exitTime:j.exitTime,pnl:j.pnl,useDirectPnLInput:j.useDirectPnLInput,exits:j.exits,entries:j.entries}));if(P.length===0)return[];let M=((T=(E=t==null?void 0:t.settings)==null?void 0:E.trade)==null?void 0:T.showCopyTradingPnL)||!1,z=(B=(_=($=t==null?void 0:t.settings)==null?void 0:$.trade)==null?void 0:_.breakEvenRangeMin)!=null?B:0,A=(U=(N=(W=t==null?void 0:t.settings)==null?void 0:W.trade)==null?void 0:N.breakEvenRangeMax)!=null?U:0,I=new Map;P.forEach(j=>{let R=rn(j),O=tn(j.pnl,R,M);(Array.isArray(j.setup)?j.setup:j.setup?[j.setup]:["Other"]).forEach(q=>{var K,G;let V=I.get(q)||{pnl:0,wins:0,losses:0,tradeCount:0,totalRMultiple:0,grossProfit:0,grossLoss:0};V.pnl+=O||0,V.tradeCount+=1,O>A?(V.wins+=1,V.grossProfit+=O):O<z&&(V.losses+=1,V.grossLoss+=Math.abs(O));let J=xt(j.pnl,j.rMultiple,j.riskAmount,(G=(K=t==null?void 0:t.settings)==null?void 0:K.trade)==null?void 0:G.defaultRiskAmount);J!==void 0&&!isNaN(J)&&(V.totalRMultiple+=J),I.set(q,V)})});let L=Array.from(I.entries()).map(([j,R])=>{let O=R.wins+R.losses;return{name:j,pnl:R.pnl,winRate:O>0?R.wins/O*100:0,tradeCount:R.tradeCount,totalRMultiple:R.totalRMultiple,profitFactor:R.grossLoss>0?R.grossProfit/R.grossLoss:R.grossProfit>0?1/0:0}});switch(a.sortBy){case"winRate":L.sort((j,R)=>R.winRate-j.winRate);break;case"tradeCount":L.sort((j,R)=>R.tradeCount-j.tradeCount);break;default:L.sort((j,R)=>R.pnl-j.pnl);break}return L},[l,t.settings.defaultRiskAmount,a.sortBy]),p={display:"flex",justifyContent:"center",alignItems:"center",padding:"8px 12px 4px 12px"},m={fontSize:"0.7rem",fontWeight:500,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.5px",textAlign:"center"},g={overflow:"hidden"},f={marginTop:a.showChart?"0.25rem":0,overflowX:"auto"},v={width:"100%",borderCollapse:"collapse"},h={padding:"0.4rem 0.5rem",textAlign:"center",fontSize:"0.75rem",fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.5px",borderBottom:"1px solid var(--background-modifier-border)",background:"var(--background-secondary)"},y={padding:"0.35rem 0.5rem",fontSize:"0.875rem",color:"var(--text-normal)",borderBottom:"1px solid var(--background-modifier-border-hover)",textAlign:"center"};if(c)return ut.default.createElement("div",{style:g},ut.default.createElement("div",{style:p},ut.default.createElement("div",{style:m},"Setup Performance")),ut.default.createElement("div",{style:{padding:"0.5rem"}},a.showChart&&ut.default.createElement("div",{style:{height:`${a.height}px`,position:"relative"}},ut.default.createElement("div",{style:{position:"absolute",left:0,top:0,bottom:25,width:35,display:"flex",flexDirection:"column",justifyContent:"space-between"}},ut.default.createElement(ae,{width:30,height:10,borderRadius:"4px"}),ut.default.createElement(ae,{width:25,height:10,borderRadius:"4px"}),ut.default.createElement(ae,{width:28,height:10,borderRadius:"4px"})),ut.default.createElement("div",{style:{marginLeft:40,height:"calc(100% - 25px)",display:"flex",alignItems:"flex-end",justifyContent:"space-around",gap:"8px"}},ut.default.createElement(ae,{width:28,height:"70%",borderRadius:"2px"}),ut.default.createElement(ae,{width:28,height:"45%",borderRadius:"2px"}),ut.default.createElement(ae,{width:28,height:"60%",borderRadius:"2px"}),ut.default.createElement(ae,{width:28,height:"30%",borderRadius:"2px"}),ut.default.createElement(ae,{width:28,height:"50%",borderRadius:"2px"})),ut.default.createElement("div",{style:{position:"absolute",bottom:20,left:40,right:0,height:1,background:"var(--background-modifier-border)"}}),ut.default.createElement("div",{style:{position:"absolute",bottom:0,left:40,right:0,display:"flex",justifyContent:"space-around"}},Array.from({length:5}).map((P,M)=>ut.default.createElement(ae,{key:M,width:40,height:10,borderRadius:"4px"})))),a.showTable&&ut.default.createElement("div",{style:f},ut.default.createElement("table",{style:v},ut.default.createElement("thead",null,ut.default.createElement("tr",null,ut.default.createElement("th",{style:h},"Setup"),ut.default.createElement("th",{style:h},"Trades"),ut.default.createElement("th",{style:h},"P&L"),ut.default.createElement("th",{style:h},"Win%"),ut.default.createElement("th",{style:h},"PF"))),ut.default.createElement("tbody",null,Array.from({length:4}).map((P,M)=>ut.default.createElement("tr",{key:M},ut.default.createElement("td",{style:y},ut.default.createElement(ae,{width:70,height:14,borderRadius:"4px"})),ut.default.createElement("td",{style:y},ut.default.createElement(ae,{width:25,height:14,borderRadius:"4px"})),ut.default.createElement("td",{style:y},ut.default.createElement(ae,{width:55,height:14,borderRadius:"4px"})),ut.default.createElement("td",{style:y},ut.default.createElement(ae,{width:40,height:14,borderRadius:"4px"})),ut.default.createElement("td",{style:y},ut.default.createElement(ae,{width:30,height:14,borderRadius:"4px"})))))))));if(u.length===0)return ut.default.createElement("div",{style:g},ut.default.createElement("div",{style:p},ut.default.createElement("div",{style:m},"Setup Performance")),ut.default.createElement("div",{style:{padding:"1rem",textAlign:"center",color:"var(--text-muted)"}},"No setup data available for this period"));let b=((w=(S=t==null?void 0:t.settings)==null?void 0:S.general)==null?void 0:w.currency)||"USD",k=((D=(C=t==null?void 0:t.settings)==null?void 0:C.trade)==null?void 0:D.displayRMultiples)||!1,x=a.showTable&&a.topN?u.slice(0,a.topN):u;return ut.default.createElement("div",{style:g},ut.default.createElement("div",{style:p},ut.default.createElement("div",{style:m},"Setup Performance")),ut.default.createElement("div",{style:{padding:"0.5rem"}},a.showChart&&ut.default.createElement("div",{style:{height:`${a.height}px`}},ut.default.createElement(qH,{data:u,height:a.height,plugin:t})),a.showTable&&ut.default.createElement("div",{style:f},ut.default.createElement("table",{style:v},ut.default.createElement("thead",null,ut.default.createElement("tr",null,ut.default.createElement("th",{style:h},"Setup"),ut.default.createElement("th",{style:h},"Trades"),ut.default.createElement("th",{style:h},"P&L"),ut.default.createElement("th",{style:h},"Win%"),ut.default.createElement("th",{style:h},"PF"))),ut.default.createElement("tbody",null,x.map((P,M)=>{var z;return ut.default.createElement("tr",{key:M},ut.default.createElement("td",{style:y},P.name),ut.default.createElement("td",{style:y},P.tradeCount),ut.default.createElement("td",{style:{...y,color:P.pnl>=0?"var(--text-success)":"var(--text-error)",fontWeight:600}},ye(P.pnl,!0,b,k,P.totalRMultiple)),ut.default.createElement("td",{style:y},P.winRate.toFixed(1),"%"),ut.default.createElement("td",{style:{...y,color:((z=P.profitFactor)!=null?z:0)>=1?"var(--text-success)":"var(--text-error)",fontWeight:600}},P.profitFactor===1/0?"\u221E":P.profitFactor?P.profitFactor.toFixed(2):"-"))}))))))});Nk.displayName="SetupPerformanceWidget"});var _n,NV,FV,OV,eD,uz=F(()=>{_n=Y(Q());uu();ro();_t();Vo();rs();Dn();NV={overflow:"hidden"},FV={display:"flex",justifyContent:"center",alignItems:"center",padding:"8px 12px 4px 12px"},OV={fontSize:"0.7rem",fontWeight:500,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.5px",textAlign:"center"},eD=({filePath:e,plugin:t,config:r={},preview:n,previewData:i})=>{var m,g,f;let{trades:a,loading:o,noteType:s}=sn(e,t),l=n&&i?i.trades:a,c=n?!1:o,d=(m=r.height)!=null?m:250,u=((f=(g=t==null?void 0:t.settings)==null?void 0:g.trade)==null?void 0:f.showCopyTradingPnL)||!1,p=(0,_n.useMemo)(()=>{var x,S;if(l.length===0)return[];let v=new Map;for(let w of l){let C=new Date(w.entryTime),D=To(C),P=rn(w),M=tn((x=w.pnl)!=null?x:0,P,u),z=v.get(D)||{pnl:0,trades:0,rMultiple:0};z.pnl+=M,z.trades+=1,z.rMultiple+=(S=w.rMultiple)!=null?S:0,v.set(D,z)}let h=Array.from(v.keys()).sort(),y=h.map(w=>new Date(w)),b=PT(y);return h.map((w,C)=>{let D=v.get(w);return{date:b[C],originalDate:w,pnl:D.pnl,fill:D.pnl>=0?"var(--chart-positive)":"var(--chart-negative)",trades:D.trades,rMultiple:D.rMultiple}})},[l,u]);return s==="drc"?_n.default.createElement(_r,{widgetType:"Daily P&L",reason:"This widget is only available in Weekly and Monthly reviews"}):c?_n.default.createElement("div",{style:NV},_n.default.createElement("div",{style:FV},_n.default.createElement("div",{style:OV},"Daily P&L")),_n.default.createElement("div",{style:{padding:"8px 8px 0 8px"}},_n.default.createElement("div",{style:{position:"relative",height:`${d}px`}},_n.default.createElement("div",{style:{position:"absolute",left:0,top:0,bottom:25,width:35,display:"flex",flexDirection:"column",justifyContent:"space-between"}},_n.default.createElement(ae,{width:30,height:10,borderRadius:"4px"}),_n.default.createElement(ae,{width:25,height:10,borderRadius:"4px"}),_n.default.createElement(ae,{width:28,height:10,borderRadius:"4px"})),_n.default.createElement("div",{style:{marginLeft:40,height:"calc(100% - 25px)",display:"flex",alignItems:"flex-end",justifyContent:"space-around",gap:"4px"}},_n.default.createElement(ae,{width:18,height:"45%",borderRadius:"2px"}),_n.default.createElement(ae,{width:18,height:"25%",borderRadius:"2px"}),_n.default.createElement(ae,{width:18,height:"60%",borderRadius:"2px"}),_n.default.createElement(ae,{width:18,height:"15%",borderRadius:"2px"}),_n.default.createElement(ae,{width:18,height:"35%",borderRadius:"2px"}),_n.default.createElement(ae,{width:18,height:"50%",borderRadius:"2px"}),_n.default.createElement(ae,{width:18,height:"20%",borderRadius:"2px"})),_n.default.createElement("div",{style:{position:"absolute",bottom:20,left:40,right:0,height:1,background:"var(--background-modifier-border)"}}),_n.default.createElement("div",{style:{position:"absolute",bottom:0,left:40,right:0,display:"flex",justifyContent:"space-around"}},Array.from({length:5}).map((v,h)=>_n.default.createElement(ae,{key:h,width:15,height:10,borderRadius:"4px"})))))):p.length===0?_n.default.createElement("div",{style:NV},_n.default.createElement("div",{style:FV},_n.default.createElement("div",{style:OV},"Daily P&L")),_n.default.createElement("div",{style:{padding:"1rem",textAlign:"center",color:"var(--text-muted)"}},"No daily data for this period")):_n.default.createElement("div",{style:NV},_n.default.createElement("div",{style:FV},_n.default.createElement("div",{style:OV},"Daily P&L")),_n.default.createElement("div",{style:{padding:"8px 8px 0 8px"}},_n.default.createElement(op,{data:p,height:d})))}});function I9e(e){let t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),r=t.getUTCDay()||7;t.setUTCDate(t.getUTCDate()+4-r);let n=new Date(Date.UTC(t.getUTCFullYear(),0,1));return Math.ceil(((t.getTime()-n.getTime())/864e5+1)/7)}var ni,zV,jV,_V,tD,pz=F(()=>{ni=Y(Q());uu();ro();Vo();rs();Dn();zV={overflow:"hidden"},jV={display:"flex",justifyContent:"center",alignItems:"center",padding:"8px 12px 4px 12px"},_V={fontSize:"0.7rem",fontWeight:500,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.5px",textAlign:"center"},tD=({filePath:e,plugin:t,config:r={},preview:n=!1,previewData:i})=>{var m,g,f;let{trades:a,loading:o,noteType:s}=sn(e,t),l=n&&i?i.trades:a,c=n?!1:o,d=(m=r.height)!=null?m:250,u=((f=(g=t==null?void 0:t.settings)==null?void 0:g.trade)==null?void 0:f.showCopyTradingPnL)||!1,p=(0,ni.useMemo)(()=>{var b,k;if(l.length===0)return[];let v=new Map;for(let x of l){let S=new Date(x.entryTime),w=I9e(S),C=rn(x),D=tn((b=x.pnl)!=null?b:0,C,u),P=v.get(w)||{pnl:0,trades:0,rMultiple:0};P.pnl+=D,P.trades+=1,P.rMultiple+=(k=x.rMultiple)!=null?k:0,v.set(w,P)}let h=[],y=Array.from(v.keys()).sort((x,S)=>x-S);for(let x of y){let S=v.get(x);h.push({date:`W${x}`,originalDate:`week-${x}`,pnl:S.pnl,fill:S.pnl>=0?"var(--chart-positive)":"var(--chart-negative)",trades:S.trades,rMultiple:S.rMultiple})}return h},[l,u]);return s==="drc"||s==="weekly-review"?ni.default.createElement(_r,{widgetType:"Weekly P&L",reason:"This widget is only available in Monthly reviews"}):c?ni.default.createElement("div",{style:zV},ni.default.createElement("div",{style:jV},ni.default.createElement("div",{style:_V},"Weekly P&L")),ni.default.createElement("div",{style:{padding:"8px 8px 0 8px"}},ni.default.createElement("div",{style:{position:"relative",height:`${d}px`}},ni.default.createElement("div",{style:{position:"absolute",left:0,top:0,bottom:25,width:35,display:"flex",flexDirection:"column",justifyContent:"space-between"}},ni.default.createElement(ae,{width:30,height:10,borderRadius:"4px"}),ni.default.createElement(ae,{width:25,height:10,borderRadius:"4px"}),ni.default.createElement(ae,{width:28,height:10,borderRadius:"4px"})),ni.default.createElement("div",{style:{marginLeft:40,height:"calc(100% - 25px)",display:"flex",alignItems:"flex-end",justifyContent:"space-around",gap:"4px"}},ni.default.createElement(ae,{width:18,height:"45%",borderRadius:"2px"}),ni.default.createElement(ae,{width:18,height:"25%",borderRadius:"2px"}),ni.default.createElement(ae,{width:18,height:"60%",borderRadius:"2px"}),ni.default.createElement(ae,{width:18,height:"15%",borderRadius:"2px"}),ni.default.createElement(ae,{width:18,height:"35%",borderRadius:"2px"})),ni.default.createElement("div",{style:{position:"absolute",bottom:20,left:40,right:0,height:1,background:"var(--background-modifier-border)"}}),ni.default.createElement("div",{style:{position:"absolute",bottom:0,left:40,right:0,display:"flex",justifyContent:"space-around"}},Array.from({length:4}).map((v,h)=>ni.default.createElement(ae,{key:h,width:20,height:10,borderRadius:"4px"})))))):p.length===0?ni.default.createElement("div",{style:zV},ni.default.createElement("div",{style:jV},ni.default.createElement("div",{style:_V},"Weekly P&L")),ni.default.createElement("div",{style:{padding:"1rem",textAlign:"center",color:"var(--text-muted)"}},"No weekly data for this period")):ni.default.createElement("div",{style:zV},ni.default.createElement("div",{style:jV},ni.default.createElement("div",{style:_V},"Weekly P&L")),ni.default.createElement("div",{style:{padding:"8px 8px 0 8px"}},ni.default.createElement(op,{data:p,height:d})))}});var Vn,M9e,BV,WV,$V,rD,mz=F(()=>{Vn=Y(Q());uu();ro();Vo();rs();Dn();M9e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],BV={overflow:"hidden"},WV={display:"flex",justifyContent:"center",alignItems:"center",padding:"8px 12px 4px 12px"},$V={fontSize:"0.7rem",fontWeight:500,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.5px",textAlign:"center"},rD=({filePath:e,plugin:t,config:r={},preview:n=!1,previewData:i})=>{var m,g,f;let{trades:a,loading:o,noteType:s}=sn(e,t),l=n&&i?i.trades:a,c=n?!1:o,d=(m=r.height)!=null?m:250,u=((f=(g=t==null?void 0:t.settings)==null?void 0:g.trade)==null?void 0:f.showCopyTradingPnL)||!1,p=(0,Vn.useMemo)(()=>{var b,k;if(l.length===0)return[];let v=new Map;for(let x of l){let S=new Date(x.entryTime),w=S.getFullYear(),C=S.getMonth(),D=`${w}-${String(C+1).padStart(2,"0")}`,P=rn(x),M=tn((b=x.pnl)!=null?b:0,P,u),z=v.get(D)||{pnl:0,trades:0,rMultiple:0,month:C};z.pnl+=M,z.trades+=1,z.rMultiple+=(k=x.rMultiple)!=null?k:0,v.set(D,z)}let h=[],y=Array.from(v.keys()).sort();for(let x of y){let S=v.get(x);h.push({date:M9e[S.month],originalDate:x,pnl:S.pnl,fill:S.pnl>=0?"var(--chart-positive)":"var(--chart-negative)",trades:S.trades,rMultiple:S.rMultiple})}return h},[l,u]);return s==="drc"||s==="weekly-review"||s==="monthly-review"?Vn.default.createElement(_r,{widgetType:"Monthly P&L",reason:"This widget is only available in Quarterly and Yearly reviews"}):c?Vn.default.createElement("div",{style:BV},Vn.default.createElement("div",{style:WV},Vn.default.createElement("div",{style:$V},"Monthly P&L")),Vn.default.createElement("div",{style:{padding:"8px 8px 0 8px"}},Vn.default.createElement("div",{style:{position:"relative",height:`${d}px`}},Vn.default.createElement("div",{style:{position:"absolute",left:0,top:0,bottom:25,width:35,display:"flex",flexDirection:"column",justifyContent:"space-between"}},Vn.default.createElement(ae,{width:30,height:10,borderRadius:"4px"}),Vn.default.createElement(ae,{width:25,height:10,borderRadius:"4px"}),Vn.default.createElement(ae,{width:28,height:10,borderRadius:"4px"})),Vn.default.createElement("div",{style:{marginLeft:40,height:"calc(100% - 25px)",display:"flex",alignItems:"flex-end",justifyContent:"space-around",gap:"4px"}},Vn.default.createElement(ae,{width:18,height:"45%",borderRadius:"2px"}),Vn.default.createElement(ae,{width:18,height:"25%",borderRadius:"2px"}),Vn.default.createElement(ae,{width:18,height:"60%",borderRadius:"2px"}),Vn.default.createElement(ae,{width:18,height:"15%",borderRadius:"2px"}),Vn.default.createElement(ae,{width:18,height:"35%",borderRadius:"2px"}),Vn.default.createElement(ae,{width:18,height:"50%",borderRadius:"2px"})),Vn.default.createElement("div",{style:{position:"absolute",bottom:20,left:40,right:0,height:1,background:"var(--background-modifier-border)"}}),Vn.default.createElement("div",{style:{position:"absolute",bottom:0,left:40,right:0,display:"flex",justifyContent:"space-around"}},Array.from({length:6}).map((v,h)=>Vn.default.createElement(ae,{key:h,width:20,height:10,borderRadius:"4px"})))))):p.length===0?Vn.default.createElement("div",{style:BV},Vn.default.createElement("div",{style:WV},Vn.default.createElement("div",{style:$V},"Monthly P&L")),Vn.default.createElement("div",{style:{padding:"1rem",textAlign:"center",color:"var(--text-muted)"}},"No monthly data for this period")):Vn.default.createElement("div",{style:BV},Vn.default.createElement("div",{style:WV},Vn.default.createElement("div",{style:$V},"Monthly P&L")),Vn.default.createElement("div",{style:{padding:"8px 8px 0 8px"}},Vn.default.createElement(op,{data:p,height:d})))}});function A9e(e){return Math.floor(e/3)+1}var ui,RV,UV,HV,nD,fz=F(()=>{ui=Y(Q());uu();ro();Vo();rs();Dn();RV={overflow:"hidden"},UV={display:"flex",justifyContent:"center",alignItems:"center",padding:"8px 12px 4px 12px"},HV={fontSize:"0.7rem",fontWeight:500,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.5px",textAlign:"center"},nD=({filePath:e,plugin:t,config:r={},preview:n=!1,previewData:i})=>{var m,g,f;let{trades:a,loading:o,noteType:s}=sn(e,t),l=n&&i?i.trades:a,c=n?!1:o,d=(m=r.height)!=null?m:250,u=((f=(g=t==null?void 0:t.settings)==null?void 0:g.trade)==null?void 0:f.showCopyTradingPnL)||!1,p=(0,ui.useMemo)(()=>{var b,k;if(l.length===0)return[];let v=new Map;for(let x of l){let S=new Date(x.entryTime),w=S.getFullYear(),C=A9e(S.getMonth()),D=`${w}-Q${C}`,P=rn(x),M=tn((b=x.pnl)!=null?b:0,P,u),z=v.get(D)||{pnl:0,trades:0,rMultiple:0,quarter:C};z.pnl+=M,z.trades+=1,z.rMultiple+=(k=x.rMultiple)!=null?k:0,v.set(D,z)}let h=[],y=Array.from(v.keys()).sort();for(let x of y){let S=v.get(x);h.push({date:`Q${S.quarter}`,originalDate:x,pnl:S.pnl,fill:S.pnl>=0?"var(--chart-positive)":"var(--chart-negative)",trades:S.trades,rMultiple:S.rMultiple})}return h},[l,u]);return s==="drc"||s==="weekly-review"||s==="monthly-review"||s==="quarterly-review"?ui.default.createElement(_r,{widgetType:"Quarterly P&L",reason:"This widget is only available in Yearly reviews"}):c?ui.default.createElement("div",{style:RV},ui.default.createElement("div",{style:UV},ui.default.createElement("div",{style:HV},"Quarterly P&L")),ui.default.createElement("div",{style:{padding:"8px 8px 0 8px"}},ui.default.createElement("div",{style:{position:"relative",height:`${d}px`}},ui.default.createElement("div",{style:{position:"absolute",left:0,top:0,bottom:25,width:35,display:"flex",flexDirection:"column",justifyContent:"space-between"}},ui.default.createElement(ae,{width:30,height:10,borderRadius:"4px"}),ui.default.createElement(ae,{width:25,height:10,borderRadius:"4px"}),ui.default.createElement(ae,{width:28,height:10,borderRadius:"4px"})),ui.default.createElement("div",{style:{marginLeft:40,height:"calc(100% - 25px)",display:"flex",alignItems:"flex-end",justifyContent:"space-around",gap:"4px"}},ui.default.createElement(ae,{width:24,height:"45%",borderRadius:"2px"}),ui.default.createElement(ae,{width:24,height:"60%",borderRadius:"2px"}),ui.default.createElement(ae,{width:24,height:"35%",borderRadius:"2px"}),ui.default.createElement(ae,{width:24,height:"50%",borderRadius:"2px"})),ui.default.createElement("div",{style:{position:"absolute",bottom:20,left:40,right:0,height:1,background:"var(--background-modifier-border)"}}),ui.default.createElement("div",{style:{position:"absolute",bottom:0,left:40,right:0,display:"flex",justifyContent:"space-around"}},Array.from({length:4}).map((v,h)=>ui.default.createElement(ae,{key:h,width:20,height:10,borderRadius:"4px"})))))):p.length===0?ui.default.createElement("div",{style:RV},ui.default.createElement("div",{style:UV},ui.default.createElement("div",{style:HV},"Quarterly P&L")),ui.default.createElement("div",{style:{padding:"1rem",textAlign:"center",color:"var(--text-muted)"}},"No quarterly data for this period")):ui.default.createElement("div",{style:RV},ui.default.createElement("div",{style:UV},ui.default.createElement("div",{style:HV},"Quarterly P&L")),ui.default.createElement("div",{style:{padding:"8px 8px 0 8px"}},ui.default.createElement(op,{data:p,height:d})))}});var Vr,L9e,Fk,gz=F(()=>{Vr=Y(Q());Jn();UH();Ll();rs();Dn();L9e={showLong:!0,showShort:!0,height:250,layout:"stacked"},Fk=Vr.default.memo(({filePath:e,plugin:t,config:r={},preview:n=!1,previewData:i})=>{var w,C,D,P;let a={...L9e,...r},{trades:o,loading:s,noteType:l}=sn(e,t),c=n&&i?i.trades:o,d=n?!1:s,u=((C=(w=t==null?void 0:t.settings)==null?void 0:w.trade)==null?void 0:C.dateFormat)||"DDMMYY",p=(P=(D=t==null?void 0:t.settings)==null?void 0:D.trade)==null?void 0:P.defaultRiskAmount,{longChartData:m,shortChartData:g,longCount:f,shortCount:v}=(0,Vr.useMemo)(()=>{let M=c.filter(E=>!yt({tradeStatus:E.tradeStatus,exitTime:E.exitTime,pnl:E.pnl,useDirectPnLInput:E.useDirectPnLInput,exits:E.exits,entries:E.entries})),z=M.filter(E=>{var T;return((T=E.direction)==null?void 0:T.toLowerCase())==="long"}),A=M.filter(E=>{var T;return((T=E.direction)==null?void 0:T.toLowerCase())==="short"}),I=z.length>0?Np(z,u,p):[],L=A.length>0?Np(A,u,p):[];return{longChartData:I,shortChartData:L,longCount:z.length,shortCount:A.length}},[c,u,p]),h={display:"flex",flexDirection:a.layout==="side-by-side"?"row":"column",gap:"1rem"},y={flex:a.layout==="side-by-side"?"1 1 50%":"1 1 auto",minWidth:0,overflow:"hidden"},b={display:"flex",justifyContent:"center",alignItems:"center",padding:"8px 12px 4px 12px"},k={fontSize:"0.7rem",fontWeight:500,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.5px",textAlign:"center"},x={padding:"1rem",textAlign:"center",color:"var(--text-muted)",fontSize:"0.85rem"},S={padding:"1rem",textAlign:"center",color:"var(--text-muted)"};if(d){let M=({title:z})=>Vr.default.createElement("div",{style:y},Vr.default.createElement("div",{style:b},Vr.default.createElement("div",{style:k},z)),Vr.default.createElement("div",{style:{padding:"8px 8px 0 8px"}},Vr.default.createElement("div",{style:{position:"relative",height:`${a.height||250}px`}},Vr.default.createElement("div",{style:{position:"absolute",left:0,top:0,bottom:20,width:40,display:"flex",flexDirection:"column",justifyContent:"space-between"}},Vr.default.createElement(ae,{width:30,height:10,borderRadius:"4px"}),Vr.default.createElement(ae,{width:25,height:10,borderRadius:"4px"}),Vr.default.createElement(ae,{width:35,height:10,borderRadius:"4px"})),Vr.default.createElement("div",{style:{marginLeft:45,height:"100%",paddingBottom:20}},Vr.default.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 400 200",preserveAspectRatio:"none"},Vr.default.createElement("path",{d:"M0,150 Q80,130 160,100 T320,80 T400,50 L400,200 L0,200 Z",fill:"var(--background-modifier-border)",className:"skeleton-shimmer",style:{opacity:.3}}),Vr.default.createElement("path",{d:"M0,150 Q80,130 160,100 T320,80 T400,50",fill:"none",stroke:"var(--background-modifier-border)",strokeWidth:"2",className:"skeleton-shimmer",style:{opacity:.6}}))),Vr.default.createElement("div",{style:{position:"absolute",bottom:0,left:45,right:0,display:"flex",justifyContent:"space-between"}},Vr.default.createElement(ae,{width:20,height:10,borderRadius:"4px"}),Vr.default.createElement(ae,{width:20,height:10,borderRadius:"4px"}),Vr.default.createElement(ae,{width:20,height:10,borderRadius:"4px"})))));return Vr.default.createElement("div",{style:h},a.showLong&&Vr.default.createElement(M,{title:"Long Trades P&L"}),a.showShort&&Vr.default.createElement(M,{title:"Short Trades P&L"}))}return l==="drc"&&f+v<2?Vr.default.createElement("div",{style:x},"Not enough trades for directional analysis"):f===0&&v===0?Vr.default.createElement("div",{style:x},"No closed trades for this period"):Vr.default.createElement("div",{style:h},a.showLong&&Vr.default.createElement("div",{style:y},Vr.default.createElement("div",{style:b},Vr.default.createElement("div",{style:k},"Long Trades P&L")),m.length>0?Vr.default.createElement("div",{style:{padding:"8px 8px 0 8px"}},Vr.default.createElement(Zf,{data:m,height:a.height,plugin:t})):Vr.default.createElement("div",{style:x},"No long trades this period")),a.showShort&&Vr.default.createElement("div",{style:y},Vr.default.createElement("div",{style:b},Vr.default.createElement("div",{style:k},"Short Trades P&L")),g.length>0?Vr.default.createElement("div",{style:{padding:"8px 8px 0 8px"}},Vr.default.createElement(Zf,{data:g,height:a.height,plugin:t})):Vr.default.createElement("div",{style:x},"No short trades this period")))});Fk.displayName="DirectionalPnLWidget"});var Mi,N9e,hz,Z0e=F(()=>{Mi=Y(Q());Ot();Ad();bI();pB();N9e=({onImageAdded:e,onMultipleImagesAdded:t,onError:r,saveImageFunction:n,multiple:i=!0,className:a="",placeholder:o="Paste image URL...",disabled:s=!1})=>{let[l,c]=(0,Mi.useState)(""),[d,u]=(0,Mi.useState)(!1),[p,m]=(0,Mi.useState)(!1),g=(0,Mi.useRef)(null),f=(0,Mi.useRef)(null),v=(0,Mi.useRef)(0),h=(0,Mi.useCallback)(async()=>{let P=l.trim();if(P){m(!0);try{let M=P;if(CI(P)){let z=PI(P);z&&(M=z)}if(!DI(M))throw new Error("Invalid image URL. Please enter a direct image link.");e(M),c("")}catch(M){console.error("[CompactImageUploader] URL error:",M),r&&M instanceof Error&&r(M)}finally{m(!1)}}},[l,e,r]),y=(0,Mi.useCallback)(P=>{P.key==="Enter"&&l.trim()&&(P.preventDefault(),h())},[l,h]),b=(0,Mi.useCallback)(()=>{var P;(P=g.current)==null||P.click()},[]),k=(0,Mi.useCallback)(async P=>{let M=P.target.files;if(!(!M||M.length===0)){m(!0);try{let z=[],A=i?Array.from(M):[M[0]];for(let I of A)try{if(n){let L=await n(I);z.push(L)}else console.warn("[CompactImageUploader] No saveImageFunction provided")}catch(L){console.error(`[CompactImageUploader] Failed to save ${I.name}:`,L),r&&L instanceof Error&&r(L)}z.length>1&&t?t(z):z.length>0&&e(z[0])}finally{m(!1),P.target&&(P.target.value="")}}},[n,i,e,t,r]),x=(0,Mi.useCallback)(async()=>{if(!p){m(!0);try{let P=await Po.extractClipboardImages();if(!P.success||P.files.length===0){try{let A=await navigator.clipboard.readText();if(A&&(A.startsWith("http://")||A.startsWith("https://"))){c(A),m(!1);return}}catch(A){}if(P.error&&!P.error.includes("No images found"))throw new Error(P.error);return}let M=[],z=i?P.files:[P.files[0]];for(let A of z)try{if(n){let I=await n(A);M.push(I)}}catch(I){console.error("[CompactImageUploader] Failed to save pasted image:",I),r&&I instanceof Error&&r(I)}M.length>1&&t?t(M):M.length>0&&e(M[0])}catch(P){console.error("[CompactImageUploader] Paste error:",P),r&&P instanceof Error&&r(P)}finally{m(!1)}}},[p,n,i,e,t,r]),S=(0,Mi.useCallback)(P=>{P.preventDefault(),P.stopPropagation(),v.current++,P.dataTransfer.types.includes("Files")&&u(!0)},[]),w=(0,Mi.useCallback)(P=>{P.preventDefault(),P.stopPropagation(),v.current--,v.current<=0&&(v.current=0,u(!1))},[]),C=(0,Mi.useCallback)(P=>{P.preventDefault(),P.stopPropagation()},[]),D=(0,Mi.useCallback)(async P=>{var M;if(P.preventDefault(),P.stopPropagation(),v.current=0,u(!1),!!((M=P.dataTransfer.files)!=null&&M.length)){m(!0);try{let z=vi.getImagesFromDataTransfer(P.dataTransfer);if(z.length===0)return;let A=[],I=i?z:[z[0]];for(let L of I)try{if(n){let E=await n(L);A.push(E)}}catch(E){console.error("[CompactImageUploader] Failed to save dropped image:",E),r&&E instanceof Error&&r(E)}A.length>1&&t?t(A):A.length>0&&e(A[0])}finally{m(!1)}}},[n,i,e,t,r]);return Mi.default.createElement("div",{style:{display:"flex",justifyContent:"center",width:"100%"}},Mi.default.createElement("div",{ref:f,className:`journalit-compact-uploader ${d?"dragging":""} ${p?"processing":""} ${a}`,style:{maxWidth:"600px",width:"100%"},onDragEnter:S,onDragLeave:w,onDragOver:C,onDrop:D},Mi.default.createElement("input",{type:"text",className:"journalit-compact-uploader-url-input",value:l,onChange:P=>c(P.target.value),onKeyDown:y,placeholder:o,disabled:s||p,"aria-label":"Image URL input"}),Mi.default.createElement("button",{type:"button",className:"journalit-compact-uploader-btn clickable-icon",onClick:b,disabled:s||p,"aria-label":"Upload from file"},Mi.default.createElement(Zm,{size:16})),Mi.default.createElement("button",{type:"button",className:"journalit-compact-uploader-btn clickable-icon",onClick:x,disabled:s||p,"aria-label":"Paste from clipboard"},Mi.default.createElement(Bv,{size:16})),Mi.default.createElement("input",{ref:g,type:"file",accept:"image/*",multiple:i,onChange:k,className:"journalit-compact-uploader-file-input","aria-hidden":"true"})))},hz=Mi.default.memo(N9e);hz.displayName="CompactImageUploader"});var Br,iD,F9e,O9e,z9e,j9e,_9e,B9e,W9e,Ok,vz=F(()=>{Br=Y(Q()),iD=require("obsidian");ro();TI();Z0e();ly();Xx();Op();Dn();Ad();F9e=5,O9e=150,z9e=["drc","weekly-review","monthly-review","quarterly-review","yearly-review"],j9e={display:"flex",flexDirection:"column",gap:"1rem"},_9e={position:"relative"},B9e={width:"100%",borderRadius:"var(--radius-m)",cursor:"pointer"},W9e={position:"absolute",top:"0.5rem",right:"0.5rem",background:"rgba(0, 0, 0, 0.6)",color:"white",border:"none",borderRadius:"50%",width:"28px",height:"28px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"16px",lineHeight:1},Ok=Br.default.memo(({filePath:e,plugin:t,config:r,preview:n,previewData:i})=>{let[a,o]=(0,Br.useState)([]),[s,l]=(0,Br.useState)(!0),[c,d]=(0,Br.useState)(!0),[u,p]=(0,Br.useState)(null),[m,g]=(0,Br.useState)(null),f=(0,Br.useRef)(0),v=(0,Br.useRef)(null),h=(0,Br.useRef)(c),y=(r==null?void 0:r.showUploader)!==!1,b=r==null?void 0:r.maxImages,k=b!==void 0&&a.length>=b,x=(r==null?void 0:r.layout)||"carousel";(0,Br.useEffect)(()=>{h.current=c},[c]),(0,Br.useEffect)(()=>{f.current=0,S();let L=E=>{E.path===e&&!h.current&&S()};return t.app.metadataCache.on("changed",L),()=>{t.app.metadataCache.off("changed",L),v.current&&clearTimeout(v.current)}},[e,n,i]);let S=async()=>{if(n&&i){o(i.images||[]),l(!1),d(!0);return}let L=t.app.vault.getAbstractFileByPath(e);if(!(L instanceof iD.TFile)){d(!1),l(!1);return}let E=t.app.metadataCache.getFileCache(L),T=E==null?void 0:E.frontmatter;if(!T||!z9e.includes(T.type)){if(f.current<F9e){f.current++,v.current=setTimeout(()=>S(),O9e);return}d(!1),l(!1);return}p({type:T.type,date:T.date||""});let $=T.images||[];o(Array.isArray($)?$:[]),d(!0),l(!1)},w=(0,Br.useCallback)(()=>{let L=e.lastIndexOf("/"),E=L>0?e.substring(0,L):"";return E?`${E}/media`:"media"},[e]),C=(0,Br.useCallback)(L=>{if(!u)return`img-${Date.now()}`;let E=Date.now(),T=L.name.includes(".")?L.name.substring(L.name.lastIndexOf(".")):".png",{type:$,date:_}=u;if($==="drc"&&_){let B=new Date(_);if(isNaN(B.getTime()))return`drc-${E}${T}`;let W=String(B.getDate()).padStart(2,"0"),N=String(B.getMonth()+1).padStart(2,"0"),U=B.getFullYear();return`drc-${W}${N}${U}-${E}${T}`}if($==="weekly-review"&&_){let B=_.match(/W(\d+)/i);return`weekly-W${B?B[1].padStart(2,"0"):"00"}-${E}${T}`}if($==="monthly-review"&&_){let B=new Date(_);if(isNaN(B.getTime()))return`monthly-${E}${T}`;let W=String(B.getMonth()+1).padStart(2,"0"),N=B.getFullYear();return`monthly-${W}${N}-${E}${T}`}if($==="quarterly-review"&&_){let B=new Date(_);if(isNaN(B.getTime()))return`quarterly-${E}${T}`;let W=Math.ceil((B.getMonth()+1)/3),N=B.getFullYear();return`quarterly-Q${W}${N}-${E}${T}`}if($==="yearly-review"&&_){let B=new Date(_);return isNaN(B.getTime())?`yearly-${E}${T}`:`yearly-${B.getFullYear()}-${E}${T}`}return`img-${E}${T}`},[u]),D=(0,Br.useCallback)(async L=>{let E=w(),T=C(L),$=`${E}/${T}`;try{await t.app.vault.adapter.mkdir((0,iD.normalizePath)(E));let _=await L.arrayBuffer();return await t.app.vault.createBinary((0,iD.normalizePath)($),_),$}catch(_){throw console.error("[ImageWidget] Failed to save image file:",_),_}},[t,w,C]),P=(0,Br.useCallback)(async L=>{var E;if(!(n||!u))try{let T={images:L};u.type==="drc"?await t.drcService.updateDRCFrontmatter(e,T,"user-input"):u.type==="weekly-review"?await t.weeklyReviewService.updateWeeklyReviewFrontmatter(e,T):u.type==="monthly-review"?await(await t.serviceManager.getMonthlyReviewService()).updateMonthlyReviewFrontmatter(e,T):u.type==="quarterly-review"?await(await t.serviceManager.getQuarterlyReviewService()).updateQuarterlyReviewFrontmatter(e,T):u.type==="yearly-review"&&await(await t.serviceManager.getYearlyReviewService()).updateYearlyReviewFrontmatter(e,T);let _=(E={drc:"drc","weekly-review":"weekly","monthly-review":"monthly","quarterly-review":"quarterly","yearly-review":"yearly"}[u.type])!=null?E:"drc";xe.publish("review:changed",{action:"updated",type:_,filePath:e})}catch(T){throw console.error("[ImageWidget] Failed to update frontmatter:",T),T}},[t,e,u,n]),M=(0,Br.useCallback)(async L=>{let E=[...a,L];o(E);try{await P(E)}catch(T){console.error("[ImageWidget] Failed to save image:",T),o(a)}},[a,P]),z=(0,Br.useCallback)(async L=>{let E=[...a,...L];o(E);try{await P(E)}catch(T){console.error("[ImageWidget] Failed to save images:",T),o(a)}},[a,P]),A=(0,Br.useCallback)(async(L,E)=>{if(n)return;let T=a,$=a.filter((_,B)=>B!==L);o($);try{await P($)}catch(_){console.error("[ImageWidget] Failed to remove image from frontmatter:",_),o(T);return}try{let _=t.app.vault.getAbstractFileByPath(E);_&&await t.app.vault.delete(_)}catch(_){console.warn("[ImageWidget] Could not delete image file:",_)}},[a,t,n,P]),I=(0,Br.useCallback)(L=>{console.error("[ImageWidget] Upload error:",L.message)},[]);return s?Br.default.createElement("div",{className:"journalit-images-widget"},Br.default.createElement("div",{style:{width:"100%",height:"200px",background:"var(--background-secondary)",borderRadius:"var(--radius-m)",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"0.5rem"}},Br.default.createElement(ae,{width:"90%",height:"180px",borderRadius:"var(--radius-s)"})),Br.default.createElement("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"center"}},[1,2,3].map(L=>Br.default.createElement(ae,{key:L,width:50,height:40,borderRadius:"4px"})))):c?Br.default.createElement("div",{className:"journalit-images-widget"},a.length>0&&x==="carousel"&&Br.default.createElement(oh,{images:a,altPrefix:"Review image",showThumbnails:a.length>1,showCounter:a.length>1,enableDelete:!n,onDeleteImage:A,enableFullscreen:!0,useResolveMediaPath:!0,className:a.length===1?"single-image-carousel":""}),a.length>0&&x==="stacked"&&Br.default.createElement("div",{className:"journalit-images-stacked",style:j9e},a.map((L,E)=>Br.default.createElement("div",{key:L,className:"journalit-stacked-image-container",style:_9e},Br.default.createElement("img",{src:vi.resolveMediaPath(L),alt:`Review image ${E+1}`,style:B9e,onClick:()=>g(E),tabIndex:0,role:"button","aria-label":`Open image ${E+1} fullscreen`,onKeyDown:T=>{(T.key==="Enter"||T.key===" ")&&(T.preventDefault(),g(E))}}),!n&&Br.default.createElement("button",{className:"journalit-stacked-image-delete",onClick:T=>{T.stopPropagation(),A(E,L)},style:W9e,title:"Delete image","aria-label":"Delete image"},"\xD7")))),Br.default.createElement(_p,{isOpen:m!==null&&x==="stacked",onClose:()=>g(null)},m!==null&&Br.default.createElement(pf,{imagePath:a[m],onClose:()=>g(null),useResolveMediaPath:!0,navigationContext:a.length>1?{images:a,currentIndex:m,onNavigate:g,altPrefix:"Review image",useResolveMediaPath:!0}:void 0})),a.length===0&&!y&&Br.default.createElement("div",{className:"journalit-images-empty"},"No images"),y&&!n&&!k&&Br.default.createElement(hz,{onImageAdded:M,onMultipleImagesAdded:z,onError:I,saveImageFunction:D,multiple:!0,placeholder:a.length===0?"Paste image URL...":"Add more images...",className:"journalit-images-uploader"}),y&&n&&!k&&Br.default.createElement(hz,{onImageAdded:()=>{},placeholder:"Paste image URL...",disabled:!0,className:"journalit-images-uploader"})):Br.default.createElement(_r,{widgetType:"Images",reason:"Images widget requires a review note (type: 'drc', 'weekly-review', 'monthly-review', 'quarterly-review', or 'yearly-review')"})});Ok.displayName="ImageWidget"});var Ta,qV,$9e,R9e,U9e,aD,yz=F(()=>{Ta=Y(Q()),qV=require("obsidian");Ot();ro();_t();Op();Dn();$9e=["drc","weekly-review","monthly-review","quarterly-review","yearly-review"],R9e=5,U9e=150,aD=({filePath:e,plugin:t,preview:r,previewData:n})=>{let[i,a]=(0,Ta.useState)(!1),[o,s]=(0,Ta.useState)(null),[l,c]=(0,Ta.useState)(!0),[d,u]=(0,Ta.useState)(!0),[p,m]=(0,Ta.useState)(null),g=(0,Ta.useRef)(0);(0,Ta.useEffect)(()=>{var D;if(r&&n){a(n.reviewed),s((D=n.reviewedAt)!=null?D:null),c(!1),u(!0);return}g.current=0,f();let C=P=>{P.path===e&&f()};return t.app.metadataCache.on("changed",C),()=>{t.app.metadataCache.off("changed",C)}},[e,r,n]);let f=async()=>{var z,A,I,L;let C=t.app.vault.getAbstractFileByPath(e);if(!(C instanceof qV.TFile)){u(!1),c(!1);return}let D=t.app.metadataCache.getFileCache(C),P=D==null?void 0:D.frontmatter;if(!P){if(g.current<R9e){g.current++,setTimeout(()=>f(),U9e);return}u(!1),c(!1);return}let M=P.type;if(!$9e.includes(M)){u(!1),c(!1);return}if(m(M),M==="drc"){let E=P.endOfDayReview||{};a((z=E.reviewed)!=null?z:!1),s((A=E.reviewedAt)!=null?A:null)}else a((I=P.reviewed)!=null?I:!1),s((L=P.reviewedAt)!=null?L:null);u(!0),c(!1)},v=async()=>{var M,z;if(r)return;let C=t.app.vault.getAbstractFileByPath(e);if(!(C instanceof qV.TFile))return;let D=!i,P=D?new Date().toISOString():null;a(D),s(P);try{if(p==="drc"){let L=t.app.metadataCache.getFileCache(C),E=((M=L==null?void 0:L.frontmatter)==null?void 0:M.endOfDayReview)||{};await t.drcService.updateDRCFrontmatter(e,{endOfDayReview:{...E,reviewed:D,reviewedAt:P}},"user-input")}else p==="weekly-review"?await t.weeklyReviewService.updateWeeklyReviewFrontmatter(e,{reviewed:D,reviewedAt:P}):p==="monthly-review"?await t.monthlyReviewService.updateMonthlyReviewFrontmatter(e,{reviewed:D,reviewedAt:P}):p==="quarterly-review"?await(await t.serviceManager.getQuarterlyReviewService()).updateQuarterlyReviewFrontmatter(e,{reviewed:D,reviewedAt:P}):p==="yearly-review"&&await(await t.serviceManager.getYearlyReviewService()).updateYearlyReviewFrontmatter(e,{reviewed:D,reviewedAt:P});let I=(z={drc:"drc","weekly-review":"weekly","monthly-review":"monthly","quarterly-review":"quarterly","yearly-review":"yearly"}[p!=null?p:"drc"])!=null?z:"drc";xe.publish("review:changed",{action:"updated",type:I,filePath:e})}catch(A){console.error("[MarkReviewedWidget] Failed to update review status:",A),a(!D),s(D?null:o)}},h=C=>{let D=vn(),P=new Date(C),M=zt(P,D),z=P.toLocaleTimeString(void 0,{hour:"numeric",minute:"2-digit"});return`${M} ${z}`};if(l)return Ta.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.75rem 1rem",borderRadius:"var(--radius-m)",background:"var(--background-secondary)",border:"1px solid var(--background-modifier-border)"}},Ta.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"}},Ta.default.createElement(_l,{size:18}),Ta.default.createElement(ae,{width:100,height:14,borderRadius:"4px"})),Ta.default.createElement(ae,{width:110,height:32,borderRadius:"var(--radius-s)"}));if(!d)return Ta.default.createElement(_r,{widgetType:"Mark as Reviewed",reason:"This widget requires a DRC, Weekly Review, Monthly Review, Quarterly Review, or Yearly Review note"});let y={display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.75rem 1rem",borderRadius:"var(--radius-m)",background:"var(--background-secondary)",border:"1px solid var(--background-modifier-border)",transition:"all 0.2s ease"},b={display:"flex",alignItems:"center",gap:"0.5rem"},k={flexShrink:0},x={fontWeight:600,fontSize:"0.9em",color:"var(--text-normal)",textTransform:"uppercase",letterSpacing:"0.5px"},S={fontSize:"0.85em",color:"var(--text-muted)",marginLeft:"0.75rem"},w={padding:"0.5rem 1rem",background:i?"transparent":"var(--interactive-accent)",border:i?"1px solid var(--background-modifier-border)":"none",borderRadius:"var(--radius-s)",color:i?"var(--text-muted)":"var(--text-on-accent)",fontSize:"0.85em",fontWeight:500,cursor:r?"default":"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",gap:"0.4rem",opacity:r?.7:1};return Ta.default.createElement("div",{style:y},Ta.default.createElement("div",{style:b},i?Ta.default.createElement(Aa,{size:18,style:{...k,color:"var(--color-green)"}}):Ta.default.createElement(Xm,{size:18,style:{...k,color:"var(--text-muted)"}}),Ta.default.createElement("span",{style:x},i?"REVIEWED":"PENDING REVIEW"),i&&o&&Ta.default.createElement("span",{style:S},h(o))),Ta.default.createElement("button",{onClick:v,disabled:r,style:w,onMouseEnter:C=>{r||(i?(C.currentTarget.style.background="var(--background-modifier-hover)",C.currentTarget.style.color="var(--text-normal)"):C.currentTarget.style.background="var(--interactive-accent-hover)")},onMouseLeave:C=>{r||(i?(C.currentTarget.style.background="transparent",C.currentTarget.style.color="var(--text-muted)"):C.currentTarget.style.background="var(--interactive-accent)")}},i?"Undo":"Mark as Reviewed"))}});var nt,rwe,H9e,q9e,ewe,V9e,VV,Zl,GV,Em,zk,G9e,twe,bz,Y9e,jk,xz=F(()=>{nt=Y(Q()),rwe=require("obsidian");ro();Dn();_t();H9e=5,q9e=150,ewe=["monthly-review","quarterly-review","yearly-review"],V9e={showRating:!0,pageSize:5},VV={width:"100%",borderCollapse:"collapse",fontSize:"0.9rem"},Zl={borderBottom:"2px solid var(--background-modifier-border)",padding:"0.5rem",textAlign:"center",fontWeight:600,color:"var(--text-muted)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",background:"var(--background-secondary)"},GV={borderBottom:"1px solid var(--background-modifier-border-hover)",cursor:"pointer",transition:"background-color 0.1s"},Em={padding:"0.75rem 0.5rem",textAlign:"center"},zk=e=>({...Em,fontWeight:600,color:e}),G9e={padding:"2rem",textAlign:"center",color:"var(--text-muted)"},twe={display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.5rem",fontSize:"0.85rem",color:"var(--text-muted)",borderTop:"1px solid var(--background-modifier-border)"},bz=e=>({padding:"0.25rem 0.5rem",border:"1px solid var(--background-modifier-border)",borderRadius:"var(--radius-s)",background:e?"var(--background-secondary)":"var(--background-primary)",color:e?"var(--text-faint)":"var(--text-normal)",cursor:e?"not-allowed":"pointer",fontSize:"0.85rem"}),Y9e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],jk=nt.default.memo(({filePath:e,plugin:t,config:r={},preview:n=!1,previewData:i})=>{let a={...V9e,...r},[o,s]=(0,nt.useState)([]),[l,c]=(0,nt.useState)([]),[d,u]=(0,nt.useState)(!0),[p,m]=(0,nt.useState)(null),[g,f]=(0,nt.useState)(0),v=(0,nt.useRef)(0),h=p==="yearly-review",y=h?l:o,b=a.pageSize||5,k=y.length,x=b>0?Math.ceil(k/b):1,S=b>0&&k>b,w=(0,nt.useMemo)(()=>{if(!S)return y;let I=g*b;return y.slice(I,I+b)},[y,g,b,S]);(0,nt.useEffect)(()=>{f(0)},[k]);let C=(0,nt.useCallback)(()=>{f(I=>Math.max(0,I-1))},[]),D=(0,nt.useCallback)(()=>{f(I=>Math.min(x-1,I+1))},[x]);(0,nt.useEffect)(()=>{v.current=0;let I=async()=>{var E;if(n&&i){s(i.weeks),i.noteType&&m(i.noteType),i.monthlyData&&c(i.monthlyData),u(!1);return}try{let T=t.app.vault.getAbstractFileByPath(e);if(!(T instanceof rwe.TFile)){u(!1);return}let $=t.app.metadataCache.getFileCache(T),_=$==null?void 0:$.frontmatter;if(!_){if(v.current<H9e){v.current++,setTimeout(()=>I(),q9e);return}u(!1);return}let B=_.type||null;if(m(B),!ewe.includes(B)){u(!1);return}let W=t.serviceManager?await t.serviceManager.getMonthlyReviewService():t.monthlyReviewService;if(!W){console.warn("[TechnicalGameWidget] MonthlyReviewService not available"),u(!1);return}if(B==="monthly-review"){let N=_.year,U=_.month;if(!N||!U){let j=ur(_.date);j&&(N=j.getFullYear(),U=j.getMonth()+1)}if(N&&U){let j=await W.getWeeklyGamePerformance(N,U);s(j)}}else if(B==="quarterly-review"){let N=_.quarterStart?ur(_.quarterStart):null,U=_.quarterEnd?ur(_.quarterEnd):null,j=[];if(N&&U){let O=new Date(N);for(;O<=U;)j.push({year:O.getFullYear(),month:O.getMonth()+1}),O.setMonth(O.getMonth()+1)}else{let O=ur(_.date);if(O){let H=Math.floor(O.getMonth()/3),q=O.getFullYear();for(let V=0;V<3;V++)j.push({year:q,month:H*3+V+1})}}let R=[];for(let{year:O,month:H}of j){let q=await W.getWeeklyGamePerformance(O,H);R.push(...q)}R.sort((O,H)=>new Date(O.weekStartDate).getTime()-new Date(H.weekStartDate).getTime()),s(R)}else if(B==="yearly-review"){let N=ur(_.date),U=_.year||((E=N==null?void 0:N.getFullYear())!=null?E:new Date().getFullYear()),j=[];for(let R=1;R<=12;R++){let O=await W.getWeeklyGamePerformance(U,R),H={A:0,B:0,C:0},q=0,V=0;for(let J of O)H.A+=J.technicalGradeDistribution.A,H.B+=J.technicalGradeDistribution.B,H.C+=J.technicalGradeDistribution.C,J.technicalRating!==void 0&&(q+=J.technicalRating,V++);j.push({month:R,year:U,monthName:Y9e[R-1],technicalGradeDistribution:H,technicalRating:V>0?q/V:void 0})}c(j)}}catch(T){console.error("[TechnicalGameWidget] Error loading data:",T)}finally{u(!1)}};I();let L=E=>{E.path===e&&I()};return t.app.metadataCache.on("changed",L),()=>{t.app.metadataCache.off("changed",L)}},[e,t,n,i]);let P=I=>I==null?"N/A":I.toFixed(1),M=async I=>{var L,E,T;if(!n)try{if(!I.weeklyReviewPath)return;t.app.vault.getAbstractFileByPath(I.weeklyReviewPath)?await t.openFile(I.weeklyReviewPath,!0):(E=(L=t.settings)==null?void 0:L.weekly)!=null&&E.autoCreateWeeklyReviewOnNavigation&&(await((T=t.weeklyReviewService)==null?void 0:T.createWeeklyReview(I.weekStartDate)),await t.openFile(I.weeklyReviewPath,!0))}catch($){console.error("[TechnicalGameWidget] Error opening weekly review:",$)}},z=async I=>{if(!n)try{let L=t.serviceManager?await t.serviceManager.getMonthlyReviewService():t.monthlyReviewService;L&&await L.openMonthlyReview(new Date(I.year,I.month-1,1))}catch(L){console.error("[TechnicalGameWidget] Error opening monthly review:",L)}};if(d){let I=Math.min(b,5);return nt.default.createElement("table",{style:VV},nt.default.createElement("thead",null,nt.default.createElement("tr",null,nt.default.createElement("th",{style:Zl},h?"Month":"Week"),nt.default.createElement("th",{style:Zl},"A Games"),nt.default.createElement("th",{style:Zl},"B Games"),nt.default.createElement("th",{style:Zl},"C Games"),a.showRating&&nt.default.createElement("th",{style:Zl},"Rating"))),nt.default.createElement("tbody",null,Array.from({length:I}).map((L,E)=>nt.default.createElement("tr",{key:E,style:GV},nt.default.createElement("td",{style:Em},nt.default.createElement(ae,{width:30,height:14,borderRadius:"4px"})),nt.default.createElement("td",{style:Em},nt.default.createElement(ae,{width:20,height:14,borderRadius:"4px"})),nt.default.createElement("td",{style:Em},nt.default.createElement(ae,{width:20,height:14,borderRadius:"4px"})),nt.default.createElement("td",{style:Em},nt.default.createElement(ae,{width:20,height:14,borderRadius:"4px"})),a.showRating&&nt.default.createElement("td",{style:Em},nt.default.createElement(ae,{width:30,height:14,borderRadius:"4px"}))))))}if(!n&&p&&!ewe.includes(p))return nt.default.createElement(_r,{widgetType:"Technical Game",reason:"This widget is only available in Monthly, Quarterly, and Yearly reviews"});if(y.length===0)return nt.default.createElement("div",{style:G9e},"No technical game data available for ",p==="yearly-review"?"this year":p==="quarterly-review"?"this quarter":"this month");if(h){let I=w;return nt.default.createElement("div",null,nt.default.createElement("table",{style:VV,className:"journalit-game-performance-table"},nt.default.createElement("thead",null,nt.default.createElement("tr",null,nt.default.createElement("th",{style:Zl},"Month"),nt.default.createElement("th",{style:Zl},"A Games"),nt.default.createElement("th",{style:Zl},"B Games"),nt.default.createElement("th",{style:Zl},"C Games"),a.showRating&&nt.default.createElement("th",{style:Zl},"Avg Rating"))),nt.default.createElement("tbody",null,I.map(L=>nt.default.createElement("tr",{key:`month-${L.month}`,style:GV,className:"journalit-game-performance-row",onClick:()=>z(L),onMouseEnter:E=>E.currentTarget.style.backgroundColor="var(--background-modifier-hover)",onMouseLeave:E=>E.currentTarget.style.backgroundColor="transparent"},nt.default.createElement("td",{style:Em},L.monthName),nt.default.createElement("td",{style:zk("var(--color-green)")},L.technicalGradeDistribution.A),nt.default.createElement("td",{style:zk("var(--color-yellow)")},L.technicalGradeDistribution.B),nt.default.createElement("td",{style:zk("var(--color-red)")},L.technicalGradeDistribution.C),a.showRating&&nt.default.createElement("td",{style:Em},P(L.technicalRating)))))),S&&nt.default.createElement("div",{style:twe},nt.default.createElement("span",null,"Showing ",g*b+1,"-",Math.min((g+1)*b,k)," of ",k," months"),nt.default.createElement("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"}},nt.default.createElement("button",{onClick:C,disabled:g===0,style:bz(g===0)},"Prev"),nt.default.createElement("span",{style:{minWidth:"80px",textAlign:"center"}},"Page ",g+1," of ",x),nt.default.createElement("button",{onClick:D,disabled:g>=x-1,style:bz(g>=x-1)},"Next"))))}let A=w;return nt.default.createElement("div",null,nt.default.createElement("table",{style:VV,className:"journalit-game-performance-table"},nt.default.createElement("thead",null,nt.default.createElement("tr",null,nt.default.createElement("th",{style:Zl},"Week"),nt.default.createElement("th",{style:Zl},"A Games"),nt.default.createElement("th",{style:Zl},"B Games"),nt.default.createElement("th",{style:Zl},"C Games"),a.showRating&&nt.default.createElement("th",{style:Zl},"Rating"))),nt.default.createElement("tbody",null,A.map(I=>{let L=I.technicalGradeDistribution,E=!!I.weeklyReviewPath;return nt.default.createElement("tr",{key:`week-${I.weekNumber}-${I.weekStartDate}`,style:GV,className:"journalit-game-performance-row",onClick:()=>E&&M(I),onMouseEnter:T=>T.currentTarget.style.backgroundColor="var(--background-modifier-hover)",onMouseLeave:T=>T.currentTarget.style.backgroundColor="transparent"},nt.default.createElement("td",{style:Em},"W",I.weekNumber),nt.default.createElement("td",{style:zk("var(--color-green)")},L.A),nt.default.createElement("td",{style:zk("var(--color-yellow)")},L.B),nt.default.createElement("td",{style:zk("var(--color-red)")},L.C),a.showRating&&nt.default.createElement("td",{style:Em},P(I.technicalRating)))}))),S&&nt.default.createElement("div",{style:twe},nt.default.createElement("span",null,"Showing ",g*b+1,"-",Math.min((g+1)*b,k)," of ",k," weeks"),nt.default.createElement("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"}},nt.default.createElement("button",{onClick:C,disabled:g===0,style:bz(g===0)},"Prev"),nt.default.createElement("span",{style:{minWidth:"80px",textAlign:"center"}},"Page ",g+1," of ",x),nt.default.createElement("button",{onClick:D,disabled:g>=x-1,style:bz(g>=x-1)},"Next"))))});jk.displayName="TechnicalGameWidget"});var it,awe,K9e,J9e,nwe,Q9e,YV,ec,KV,Im,_k,X9e,iwe,wz,Z9e,Bk,kz=F(()=>{it=Y(Q()),awe=require("obsidian");ro();Dn();_t();K9e=5,J9e=150,nwe=["monthly-review","quarterly-review","yearly-review"],Q9e={showRating:!0,pageSize:5},YV={width:"100%",borderCollapse:"collapse",fontSize:"0.9rem"},ec={borderBottom:"2px solid var(--background-modifier-border)",padding:"0.5rem",textAlign:"center",fontWeight:600,color:"var(--text-muted)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",background:"var(--background-secondary)"},KV={borderBottom:"1px solid var(--background-modifier-border-hover)",cursor:"pointer",transition:"background-color 0.1s"},Im={padding:"0.75rem 0.5rem",textAlign:"center"},_k=e=>({...Im,fontWeight:600,color:e}),X9e={padding:"2rem",textAlign:"center",color:"var(--text-muted)"},iwe={display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.5rem",fontSize:"0.85rem",color:"var(--text-muted)",borderTop:"1px solid var(--background-modifier-border)"},wz=e=>({padding:"0.25rem 0.5rem",border:"1px solid var(--background-modifier-border)",borderRadius:"var(--radius-s)",background:e?"var(--background-secondary)":"var(--background-primary)",color:e?"var(--text-faint)":"var(--text-normal)",cursor:e?"not-allowed":"pointer",fontSize:"0.85rem"}),Z9e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Bk=it.default.memo(({filePath:e,plugin:t,config:r={},preview:n=!1,previewData:i})=>{let a={...Q9e,...r},[o,s]=(0,it.useState)([]),[l,c]=(0,it.useState)([]),[d,u]=(0,it.useState)(!0),[p,m]=(0,it.useState)(null),[g,f]=(0,it.useState)(0),v=(0,it.useRef)(0),h=p==="yearly-review",y=h?l:o,b=a.pageSize||5,k=y.length,x=b>0?Math.ceil(k/b):1,S=b>0&&k>b,w=(0,it.useMemo)(()=>{if(!S)return y;let I=g*b;return y.slice(I,I+b)},[y,g,b,S]);(0,it.useEffect)(()=>{f(0)},[k]);let C=(0,it.useCallback)(()=>{f(I=>Math.max(0,I-1))},[]),D=(0,it.useCallback)(()=>{f(I=>Math.min(x-1,I+1))},[x]);(0,it.useEffect)(()=>{v.current=0;let I=async()=>{var E;if(n&&i){s(i.weeks),i.noteType&&m(i.noteType),i.monthlyData&&c(i.monthlyData),u(!1);return}try{let T=t.app.vault.getAbstractFileByPath(e);if(!(T instanceof awe.TFile)){u(!1);return}let $=t.app.metadataCache.getFileCache(T),_=$==null?void 0:$.frontmatter;if(!_){if(v.current<K9e){v.current++,setTimeout(()=>I(),J9e);return}u(!1);return}let B=_.type||null;if(m(B),!nwe.includes(B)){u(!1);return}let W=t.serviceManager?await t.serviceManager.getMonthlyReviewService():t.monthlyReviewService;if(!W){console.warn("[MentalGameWidget] MonthlyReviewService not available"),u(!1);return}if(B==="monthly-review"){let N=_.year,U=_.month;if(!N||!U){let j=ur(_.date);j&&(N=j.getFullYear(),U=j.getMonth()+1)}if(N&&U){let j=await W.getWeeklyGamePerformance(N,U);s(j)}}else if(B==="quarterly-review"){let N=_.quarterStart?ur(_.quarterStart):null,U=_.quarterEnd?ur(_.quarterEnd):null,j=[];if(N&&U){let O=new Date(N);for(;O<=U;)j.push({year:O.getFullYear(),month:O.getMonth()+1}),O.setMonth(O.getMonth()+1)}else{let O=ur(_.date);if(O){let H=Math.floor(O.getMonth()/3),q=O.getFullYear();for(let V=0;V<3;V++)j.push({year:q,month:H*3+V+1})}}let R=[];for(let{year:O,month:H}of j){let q=await W.getWeeklyGamePerformance(O,H);R.push(...q)}R.sort((O,H)=>new Date(O.weekStartDate).getTime()-new Date(H.weekStartDate).getTime()),s(R)}else if(B==="yearly-review"){let N=ur(_.date),U=_.year||((E=N==null?void 0:N.getFullYear())!=null?E:new Date().getFullYear()),j=[];for(let R=1;R<=12;R++){let O=await W.getWeeklyGamePerformance(U,R),H={A:0,B:0,C:0},q=0,V=0;for(let J of O)H.A+=J.mentalGradeDistribution.A,H.B+=J.mentalGradeDistribution.B,H.C+=J.mentalGradeDistribution.C,J.mentalRating!==void 0&&(q+=J.mentalRating,V++);j.push({month:R,year:U,monthName:Z9e[R-1],mentalGradeDistribution:H,mentalRating:V>0?q/V:void 0})}c(j)}}catch(T){console.error("[MentalGameWidget] Error loading data:",T)}finally{u(!1)}};I();let L=E=>{E.path===e&&I()};return t.app.metadataCache.on("changed",L),()=>{t.app.metadataCache.off("changed",L)}},[e,t,n,i]);let P=I=>I==null?"N/A":I.toFixed(1),M=async I=>{var L,E,T;if(!n)try{if(!I.weeklyReviewPath)return;t.app.vault.getAbstractFileByPath(I.weeklyReviewPath)?await t.openFile(I.weeklyReviewPath,!0):(E=(L=t.settings)==null?void 0:L.weekly)!=null&&E.autoCreateWeeklyReviewOnNavigation&&(await((T=t.weeklyReviewService)==null?void 0:T.createWeeklyReview(I.weekStartDate)),await t.openFile(I.weeklyReviewPath,!0))}catch($){console.error("[MentalGameWidget] Error opening weekly review:",$)}},z=async I=>{if(!n)try{let L=t.serviceManager?await t.serviceManager.getMonthlyReviewService():t.monthlyReviewService;L&&await L.openMonthlyReview(new Date(I.year,I.month-1,1))}catch(L){console.error("[MentalGameWidget] Error opening monthly review:",L)}};if(d){let I=Math.min(b,5);return it.default.createElement("table",{style:YV},it.default.createElement("thead",null,it.default.createElement("tr",null,it.default.createElement("th",{style:ec},h?"Month":"Week"),it.default.createElement("th",{style:ec},"A Games"),it.default.createElement("th",{style:ec},"B Games"),it.default.createElement("th",{style:ec},"C Games"),a.showRating&&it.default.createElement("th",{style:ec},"Rating"))),it.default.createElement("tbody",null,Array.from({length:I}).map((L,E)=>it.default.createElement("tr",{key:E,style:KV},it.default.createElement("td",{style:Im},it.default.createElement(ae,{width:30,height:14,borderRadius:"4px"})),it.default.createElement("td",{style:Im},it.default.createElement(ae,{width:20,height:14,borderRadius:"4px"})),it.default.createElement("td",{style:Im},it.default.createElement(ae,{width:20,height:14,borderRadius:"4px"})),it.default.createElement("td",{style:Im},it.default.createElement(ae,{width:20,height:14,borderRadius:"4px"})),a.showRating&&it.default.createElement("td",{style:Im},it.default.createElement(ae,{width:30,height:14,borderRadius:"4px"}))))))}if(!n&&p&&!nwe.includes(p))return it.default.createElement(_r,{widgetType:"Mental Game",reason:"This widget is only available in Monthly, Quarterly, and Yearly reviews"});if(y.length===0)return it.default.createElement("div",{style:X9e},"No mental game data available for ",p==="yearly-review"?"this year":p==="quarterly-review"?"this quarter":"this month");if(h){let I=w;return it.default.createElement("div",null,it.default.createElement("table",{style:YV,className:"journalit-game-performance-table"},it.default.createElement("thead",null,it.default.createElement("tr",null,it.default.createElement("th",{style:ec},"Month"),it.default.createElement("th",{style:ec},"A Games"),it.default.createElement("th",{style:ec},"B Games"),it.default.createElement("th",{style:ec},"C Games"),a.showRating&&it.default.createElement("th",{style:ec},"Avg Rating"))),it.default.createElement("tbody",null,I.map(L=>it.default.createElement("tr",{key:`month-${L.month}`,style:KV,className:"journalit-game-performance-row",onClick:()=>z(L),onMouseEnter:E=>E.currentTarget.style.backgroundColor="var(--background-modifier-hover)",onMouseLeave:E=>E.currentTarget.style.backgroundColor="transparent"},it.default.createElement("td",{style:Im},L.monthName),it.default.createElement("td",{style:_k("var(--color-green)")},L.mentalGradeDistribution.A),it.default.createElement("td",{style:_k("var(--color-yellow)")},L.mentalGradeDistribution.B),it.default.createElement("td",{style:_k("var(--color-red)")},L.mentalGradeDistribution.C),a.showRating&&it.default.createElement("td",{style:Im},P(L.mentalRating)))))),S&&it.default.createElement("div",{style:iwe},it.default.createElement("span",null,"Showing ",g*b+1,"-",Math.min((g+1)*b,k)," of ",k," months"),it.default.createElement("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"}},it.default.createElement("button",{onClick:C,disabled:g===0,style:wz(g===0)},"Prev"),it.default.createElement("span",{style:{minWidth:"80px",textAlign:"center"}},"Page ",g+1," of ",x),it.default.createElement("button",{onClick:D,disabled:g>=x-1,style:wz(g>=x-1)},"Next"))))}let A=w;return it.default.createElement("div",null,it.default.createElement("table",{style:YV,className:"journalit-game-performance-table"},it.default.createElement("thead",null,it.default.createElement("tr",null,it.default.createElement("th",{style:ec},"Week"),it.default.createElement("th",{style:ec},"A Games"),it.default.createElement("th",{style:ec},"B Games"),it.default.createElement("th",{style:ec},"C Games"),a.showRating&&it.default.createElement("th",{style:ec},"Rating"))),it.default.createElement("tbody",null,A.map(I=>{let L=I.mentalGradeDistribution,E=!!I.weeklyReviewPath;return it.default.createElement("tr",{key:`week-${I.weekNumber}-${I.weekStartDate}`,style:KV,className:"journalit-game-performance-row",onClick:()=>E&&M(I),onMouseEnter:T=>T.currentTarget.style.backgroundColor="var(--background-modifier-hover)",onMouseLeave:T=>T.currentTarget.style.backgroundColor="transparent"},it.default.createElement("td",{style:Im},"W",I.weekNumber),it.default.createElement("td",{style:_k("var(--color-green)")},L.A),it.default.createElement("td",{style:_k("var(--color-yellow)")},L.B),it.default.createElement("td",{style:_k("var(--color-red)")},L.C),a.showRating&&it.default.createElement("td",{style:Im},P(I.mentalRating)))}))),S&&it.default.createElement("div",{style:iwe},it.default.createElement("span",null,"Showing ",g*b+1,"-",Math.min((g+1)*b,k)," of ",k," weeks"),it.default.createElement("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"}},it.default.createElement("button",{onClick:C,disabled:g===0,style:wz(g===0)},"Prev"),it.default.createElement("span",{style:{minWidth:"80px",textAlign:"center"}},"Page ",g+1," of ",x),it.default.createElement("button",{onClick:D,disabled:g>=x-1,style:wz(g>=x-1)},"Next"))))});Bk.displayName="MentalGameWidget"});var owe=F(()=>{rs()});var bt,swe,lwe,e7e,t7e,JV,QV,Sz,cwe,XV,Wk,ZV,r7e,n7e,dwe,uwe,i7e,eG,Xb,Zb,oD,a7e,o7e,$k,Tz=F(()=>{bt=Y(Q());owe();ro();Dn();swe=6,lwe=["DEMON","1","2","3","4","5","STOP TRADING"],e7e=["DEMON","OCCURRENCES"],t7e=["monthly-review","quarterly-review","yearly-review"],JV={overflow:"hidden"},QV={width:"100%",borderCollapse:"collapse",fontSize:"0.9rem",margin:0},Sz={borderBottom:"2px solid var(--background-modifier-border)",padding:"0.5rem",textAlign:"center",fontWeight:600,color:"var(--text-muted)",fontSize:"0.85rem",textTransform:"uppercase",letterSpacing:"0.5px",background:"var(--background-secondary)"},cwe={...Sz,background:"var(--color-red)",color:"#ffffff"},XV={borderBottom:"1px solid var(--background-modifier-border-hover)"},Wk={padding:"0.75rem 0.5rem",textAlign:"center"},ZV={...Wk,textAlign:"center",fontWeight:500,color:"var(--text-normal)"},r7e={color:"var(--text-error)",fontWeight:600,fontSize:"1.1rem"},n7e={display:"inline-flex",alignItems:"center",justifyContent:"center",width:"24px",height:"24px",borderRadius:"50%",background:"var(--color-red)",color:"#ffffff",fontWeight:600,fontSize:"0.9rem"},dwe={color:"var(--text-faint)",fontSize:"0.9rem"},uwe={fontWeight:600,fontSize:"1rem",color:"var(--text-normal)"},i7e={...uwe,color:"var(--text-error)"},eG={display:"flex",justifyContent:"center",gap:"1.5rem",flexWrap:"wrap",padding:"0.75rem 0.75rem",background:"var(--background-secondary)",borderRadius:"0 0 6px 6px"},Xb={display:"flex",alignItems:"center",gap:"0.5rem"},Zb={fontSize:"0.85rem",color:"var(--text-muted)"},oD={fontSize:"1rem",fontWeight:600,color:"var(--text-normal)"},a7e={...oD,color:"var(--text-error)"},o7e={padding:"2rem",textAlign:"center",color:"var(--text-muted)"},$k=bt.default.memo(({filePath:e,plugin:t,config:r={},preview:n=!1,previewData:i})=>{let{trades:a,loading:o,noteType:s}=sn(e,t),l=n?!1:o,c=(0,bt.useMemo)(()=>{if(n&&i)return i.demons;if(!a||a.length===0)return[];let m=new Map;return a.forEach(g=>{g.mistake&&Array.isArray(g.mistake)&&g.mistake.forEach(f=>{if(!f)return;let v;g.entryTime instanceof Date?v=g.entryTime.toISOString():typeof g.entryTime=="string"?v=g.entryTime:(console.warn("[DemonTrackerWidget] Invalid entryTime type:",typeof g.entryTime),v=new Date().toISOString());let h=m.get(f);h?(h.occurrences++,h.dates.push(v)):m.set(f,{mistake:f,occurrences:1,dates:[v]})})}),Array.from(m.values()).sort((g,f)=>f.occurrences-g.occurrences)},[a,n,i]),d=(0,bt.useMemo)(()=>{let m=c.length,g=c.reduce((v,h)=>v+h.occurrences,0),f=c.filter(v=>v.occurrences>=swe).length;return{totalUnique:m,totalOccurrences:g,criticalCount:f}},[c]);if(l)return bt.default.createElement("div",{className:"journalit-demon-tracker",style:JV},bt.default.createElement("table",{style:QV},bt.default.createElement("thead",null,bt.default.createElement("tr",null,lwe.map((g,f)=>bt.default.createElement("th",{key:`col-${f}`,style:g==="STOP TRADING"?cwe:Sz},g)))),bt.default.createElement("tbody",null,Array.from({length:4}).map((g,f)=>bt.default.createElement("tr",{key:f,style:XV},bt.default.createElement("td",{style:ZV},bt.default.createElement(ae,{width:80,height:14,borderRadius:"4px"})),[1,2,3,4,5].map(v=>bt.default.createElement("td",{key:`occ-${v}`,style:Wk},bt.default.createElement(ae,{width:16,height:16,borderRadius:"4px"}))),bt.default.createElement("td",{style:Wk},bt.default.createElement(ae,{width:24,height:24,borderRadius:"50%"})))))),bt.default.createElement("div",{style:eG},bt.default.createElement("div",{style:Xb},bt.default.createElement("span",{style:Zb},"Unique Mistakes:"),bt.default.createElement(ae,{width:20,height:16,borderRadius:"4px"})),bt.default.createElement("div",{style:Xb},bt.default.createElement("span",{style:Zb},"Total Occurrences:"),bt.default.createElement(ae,{width:20,height:16,borderRadius:"4px"}))));if(!n&&s&&!t7e.includes(s))return bt.default.createElement(_r,{widgetType:"Demon Tracker",reason:"This widget is only available in Monthly, Quarterly, and Yearly reviews"});let u=n&&(i!=null&&i.noteType)?i.noteType:s,p=u==="quarterly-review"||u==="yearly-review";return c.length===0?bt.default.createElement("div",{style:o7e},bt.default.createElement("div",{style:{marginBottom:"0.5rem"}},"No mistakes tracked ",p?u==="yearly-review"?"this year":"this quarter":"this month"),bt.default.createElement("div",{style:{fontSize:"0.85rem"}},"Mistakes logged in your trades will appear here to help identify patterns")):p?bt.default.createElement("div",{className:"journalit-demon-tracker",style:JV},bt.default.createElement("table",{style:QV},bt.default.createElement("thead",null,bt.default.createElement("tr",null,e7e.map((m,g)=>bt.default.createElement("th",{key:`col-${g}`,style:{...Sz,textAlign:m==="DEMON"?"left":"center",width:m==="OCCURRENCES"?"120px":"auto"}},m)))),bt.default.createElement("tbody",null,c.map((m,g)=>bt.default.createElement("tr",{key:`demon-${g}`,style:XV},bt.default.createElement("td",{style:{...ZV,textAlign:"left"}},m.mistake),bt.default.createElement("td",{style:Wk},bt.default.createElement("span",{style:m.occurrences>=10?i7e:uwe},m.occurrences)))))),bt.default.createElement("div",{style:eG},bt.default.createElement("div",{style:Xb},bt.default.createElement("span",{style:Zb},"Unique Mistakes:"),bt.default.createElement("span",{style:oD},d.totalUnique)),bt.default.createElement("div",{style:Xb},bt.default.createElement("span",{style:Zb},"Total Occurrences:"),bt.default.createElement("span",{style:oD},d.totalOccurrences)))):bt.default.createElement("div",{className:"journalit-demon-tracker",style:JV},bt.default.createElement("table",{style:QV},bt.default.createElement("thead",null,bt.default.createElement("tr",null,lwe.map((m,g)=>bt.default.createElement("th",{key:`col-${g}`,style:m==="STOP TRADING"?cwe:Sz},m)))),bt.default.createElement("tbody",null,c.map((m,g)=>bt.default.createElement("tr",{key:`demon-${g}`,style:XV},bt.default.createElement("td",{style:ZV},m.mistake),[1,2,3,4,5].map(f=>bt.default.createElement("td",{key:`occ-${f}`,style:Wk},m.occurrences>=f?bt.default.createElement("span",{style:r7e},"\u2717"):bt.default.createElement("span",{style:dwe},"-"))),bt.default.createElement("td",{style:Wk},m.occurrences>=swe?bt.default.createElement("span",{style:n7e},"\u2717"):bt.default.createElement("span",{style:dwe},"-")))))),bt.default.createElement("div",{style:eG},bt.default.createElement("div",{style:Xb},bt.default.createElement("span",{style:Zb},"Unique Mistakes:"),bt.default.createElement("span",{style:oD},d.totalUnique)),bt.default.createElement("div",{style:Xb},bt.default.createElement("span",{style:Zb},"Total Occurrences:"),bt.default.createElement("span",{style:oD},d.totalOccurrences)),d.criticalCount>0&&bt.default.createElement("div",{style:Xb},bt.default.createElement("span",{style:Zb},"Critical (6+):"),bt.default.createElement("span",{style:a7e},d.criticalCount))))});$k.displayName="DemonTrackerWidget"});var ft,tG,s7e,l7e,Cz,pwe,Rk,Pz=F(()=>{ft=Y(Q()),tG=require("obsidian");ro();Dn();s7e=5,l7e=150,Cz="journalit-key-levels-widget",pwe=({value:e,onChange:t})=>{let[r,n]=(0,ft.useState)(!1),i=(0,ft.useRef)(null);(0,ft.useEffect)(()=>{let u=p=>{i.current&&!i.current.contains(p.target)&&n(!1)};return r&&document.addEventListener("mousedown",u),()=>document.removeEventListener("mousedown",u)},[r]);let a=[{value:null,color:"var(--text-faint)",label:"None"},{value:"High",color:"var(--color-red)",label:"High"},{value:"Medium",color:"var(--color-orange)",label:"Medium"},{value:"Low",color:"var(--color-blue)",label:"Low"}],o=a.find(u=>u.value===e)||a[0],s=({color:u,size:p=14})=>ft.default.createElement("svg",{width:p,height:p,viewBox:"0 0 24 24",fill:"none",stroke:u,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},ft.default.createElement("path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"}),ft.default.createElement("line",{x1:"4",y1:"22",x2:"4",y2:"15"})),l={display:"flex",alignItems:"center",justifyContent:"center",padding:"0.4rem",background:"var(--background-primary)",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",cursor:"pointer",minWidth:"36px",height:"28px"},c={position:"absolute",bottom:"100%",left:"50%",transform:"translateX(-50%)",marginBottom:"4px",background:"var(--background-primary)",border:"1px solid var(--background-modifier-border)",borderRadius:"6px",padding:"4px",display:"flex",gap:"2px",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",zIndex:100},d={display:"flex",alignItems:"center",justifyContent:"center",padding:"6px",borderRadius:"4px",cursor:"pointer",transition:"background 0.1s"};return ft.default.createElement("div",{ref:i,style:{position:"relative"}},ft.default.createElement("button",{type:"button",className:"clickable-icon",onClick:()=>n(!r),style:l,"aria-label":"Select importance"},ft.default.createElement(s,{color:o.color})),r&&ft.default.createElement("div",{style:c},a.map(u=>ft.default.createElement("div",{key:u.label,onClick:()=>{t(u.value),n(!1)},style:{...d,background:e===u.value?"var(--background-modifier-hover)":"transparent"},onMouseEnter:p=>p.currentTarget.style.background="var(--background-modifier-hover)",onMouseLeave:p=>p.currentTarget.style.background=e===u.value?"var(--background-modifier-hover)":"transparent",title:u.label},ft.default.createElement(s,{color:u.color,size:16})))))},Rk=({filePath:e,plugin:t,preview:r,previewData:n})=>{let[i,a]=(0,ft.useState)({support:[],resistance:[]}),[o,s]=(0,ft.useState)(!0),[l,c]=(0,ft.useState)(!0),[d,u]=(0,ft.useState)(""),[p,m]=(0,ft.useState)(""),[g,f]=(0,ft.useState)(null),[v,h]=(0,ft.useState)(null),y=(0,ft.useRef)(null),b=(0,ft.useRef)(null),k=(0,ft.useRef)(0);(0,ft.useEffect)(()=>{if(r&&n){a(n.keyLevels),s(!1),c(!0);return}k.current=0,x();let q=V=>{V.path===e&&!l&&x()};return t.app.metadataCache.on("changed",q),()=>{t.app.metadataCache.off("changed",q)}},[e,r,n]),(0,ft.useEffect)(()=>{let q="journalit-key-levels-responsive";if(!document.getElementById(q)){let V=document.createElement("style");V.id=q,V.textContent=`
        .${Cz} {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 1rem;
        }
        @media (max-width: 500px) {
          .${Cz} {
            grid-template-columns: 1fr;
          }
        }
      `,document.head.appendChild(V)}},[]);let x=async()=>{let q=t.app.vault.getAbstractFileByPath(e);if(!(q instanceof tG.TFile)){c(!1),s(!1);return}let V=t.app.metadataCache.getFileCache(q),J=V==null?void 0:V.frontmatter;if(!J){if(k.current<s7e){k.current++,setTimeout(()=>x(),l7e);return}c(!1),s(!1);return}if(J.type!=="drc"){c(!1),s(!1);return}let K=J.keyLevels||{support:[],resistance:[]};a(K),c(!0),s(!1)},S=async q=>{if(t.app.vault.getAbstractFileByPath(e)instanceof tG.TFile)try{await t.drcService.updateDRCFrontmatter(e,{keyLevels:q},"user-input")}catch(J){console.error("[KeyLevelsWidget] Failed to update frontmatter:",J)}},w=async()=>{var K;if(r)return;let q=d.trim();if(!q)return;let V={price:q,importance:g},J={...i,support:[...i.support,V]};a(J),u(""),f(null),await S(J),(K=y.current)==null||K.focus()},C=async()=>{var K;if(r)return;let q=p.trim();if(!q)return;let V={price:q,importance:v},J={...i,resistance:[...i.resistance,V]};a(J),m(""),h(null),await S(J),(K=b.current)==null||K.focus()},D=async q=>{if(r)return;let V=i.support.filter((K,G)=>G!==q),J={...i,support:V};a(J),await S(J)},P=async q=>{if(r)return;let V=i.resistance.filter((K,G)=>G!==q),J={...i,resistance:V};a(J),await S(J)},M=q=>{q.key==="Enter"&&(q.preventDefault(),w())},z=q=>{q.key==="Enter"&&(q.preventDefault(),C())},A=({importance:q})=>ft.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:(()=>{switch(q){case"High":return"var(--color-red)";case"Medium":return"var(--color-orange)";case"Low":return"var(--color-blue)";default:return"var(--text-faint)"}})(),strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"0.5rem",flexShrink:0}},ft.default.createElement("path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"}),ft.default.createElement("line",{x1:"4",y1:"22",x2:"4",y2:"15"}));if(o){let q={border:"1px dashed var(--background-modifier-border)",borderRadius:"8px",padding:0,background:"transparent"},V={display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",margin:0,padding:"0.75rem 1rem",borderBottom:"1px dashed var(--background-modifier-border)"},J={display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.5rem 0",borderBottom:"1px dotted var(--background-modifier-border-hover)"},K=(G,X)=>ft.default.createElement("div",{style:q},ft.default.createElement("div",{style:{...V,color:X}},ft.default.createElement(ae,{width:12,height:12,borderRadius:"2px"}),ft.default.createElement("span",{style:{fontWeight:600,fontSize:"0.8rem",textTransform:"uppercase",letterSpacing:"0.5px"}},G)),ft.default.createElement("div",{style:{padding:"0.75rem 1rem"}},[1,2].map((te,re)=>ft.default.createElement("div",{key:re,style:{...J,borderBottom:re===1?"none":J.borderBottom}},ft.default.createElement("div",{style:{display:"flex",alignItems:"center"}},ft.default.createElement(ae,{width:14,height:14,borderRadius:"2px",style:{marginRight:"0.5rem"}}),ft.default.createElement(ae,{width:60,height:14,borderRadius:"4px"}))))));return ft.default.createElement("div",{className:Cz},K("Support","var(--color-green)"),K("Resistance","var(--color-red)"))}if(!l)return ft.default.createElement(_r,{widgetType:"Key Levels",reason:"Key Levels widget requires a DRC note (frontmatter type: 'drc')"});let I={border:"1px dashed var(--background-modifier-border)",borderRadius:"8px",padding:"0",background:"transparent"},L={display:"flex",alignItems:"center",justifyContent:"center",gap:"0.5rem",margin:0,padding:"0.75rem 1rem",borderBottom:"1px dashed var(--background-modifier-border)",fontSize:"0.8rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.5px"},E={padding:"0.75rem 1rem"},T={display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.5rem 0",borderBottom:"1px dotted var(--background-modifier-border-hover)"},$={...T,borderBottom:"none"},_={display:"flex",gap:"0.5rem",padding:"0.75rem 1rem",borderTop:"1px dashed var(--background-modifier-border)",background:"var(--background-secondary)",borderRadius:"0 0 8px 8px"},B={flex:1,padding:"0.4rem 0.6rem",background:"var(--background-primary)",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",color:"var(--text-normal)",fontSize:"0.85rem"},W={padding:"0.4rem 0.75rem",background:"transparent",border:"1px solid var(--interactive-accent)",borderRadius:"4px",color:"var(--interactive-accent)",cursor:"pointer",fontSize:"0.85rem",fontWeight:500,transition:"all 0.15s ease"},N={...W,border:"1px solid var(--background-modifier-border)",color:"var(--text-faint)",cursor:"not-allowed"},U={padding:"0.25rem 0.5rem",background:"transparent",border:"none",color:"var(--text-muted)",cursor:"pointer",fontSize:"0.9rem",opacity:.5,transition:"opacity 0.15s ease"},j={padding:"1rem",textAlign:"center",color:"var(--text-faint)",fontSize:"0.85rem",fontStyle:"italic"},R=(q,V,J,K)=>ft.default.createElement("div",{key:`${J}-${V}`,style:K?$:T},ft.default.createElement("div",{style:{display:"flex",alignItems:"center"}},ft.default.createElement(A,{importance:q.importance}),ft.default.createElement("span",{style:{fontWeight:500,fontFamily:"var(--font-monospace)",fontSize:"0.9rem"}},q.price)),!r&&ft.default.createElement("button",{onClick:()=>J==="support"?D(V):P(V),className:"clickable-icon","aria-label":"Remove level",style:U,onMouseEnter:G=>G.currentTarget.style.opacity="1",onMouseLeave:G=>G.currentTarget.style.opacity="0.5"},"[x]")),O=()=>ft.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-green)",strokeWidth:"2.5"},ft.default.createElement("path",{d:"M12 19V5M5 12l7-7 7 7"})),H=()=>ft.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"var(--color-red)",strokeWidth:"2.5"},ft.default.createElement("path",{d:"M12 5v14M5 12l7 7 7-7"}));return ft.default.createElement("div",{className:Cz},ft.default.createElement("div",{style:I},ft.default.createElement("div",{style:{...L,color:"var(--color-green)"}},ft.default.createElement(O,null),ft.default.createElement("span",null,"Support")),ft.default.createElement("div",{style:E},i.support.length>0?i.support.map((q,V)=>R(q,V,"support",V===i.support.length-1)):ft.default.createElement("div",{style:j},"No levels defined")),!r&&ft.default.createElement("div",{style:_},ft.default.createElement("input",{ref:y,type:"text",value:d,onChange:q=>u(q.target.value),onKeyDown:M,placeholder:"Price...",style:B}),ft.default.createElement(pwe,{value:g,onChange:f}),ft.default.createElement("button",{onClick:w,disabled:!d.trim(),style:d.trim()?W:N},"+"))),ft.default.createElement("div",{style:I},ft.default.createElement("div",{style:{...L,color:"var(--color-red)"}},ft.default.createElement(H,null),ft.default.createElement("span",null,"Resistance")),ft.default.createElement("div",{style:E},i.resistance.length>0?i.resistance.map((q,V)=>R(q,V,"resistance",V===i.resistance.length-1)):ft.default.createElement("div",{style:j},"No levels defined")),!r&&ft.default.createElement("div",{style:_},ft.default.createElement("input",{ref:b,type:"text",value:p,onChange:q=>m(q.target.value),onKeyDown:z,placeholder:"Price...",style:B}),ft.default.createElement(pwe,{value:v,onChange:h}),ft.default.createElement("button",{onClick:C,disabled:!p.trim(),style:p.trim()?W:N},"+"))))};Rk.displayName="KeyLevelsWidget"});function d7e(){if(document.head.querySelector("#journalit-key-events-widget-styles")){rG=!0;return}let e=document.createElement("style");e.id="journalit-key-events-widget-styles",e.textContent=c7e,document.head.appendChild(e),rG=!0}function mwe(){rG||d7e()}var c7e,rG,fwe=F(()=>{c7e=`
.key-events-form {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin-bottom: 12px;
  padding: 10px;
  background: var(--background-secondary);
  border-radius: 6px;
}

.key-events-form-row {
  display: flex;
  gap: 12px;
}

.key-events-event-selector {
  flex: 1;
}

/* Override ComboBox default margin to fix dropdown detachment */
.key-events-event-selector .combobox-container {
  margin-bottom: 0;
}

/* Improve ComboBox styling within this widget */
.key-events-event-selector .combobox-input {
  background: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  padding: 8px 12px;
  padding-right: 30px;
  font-size: 14px;
}

.key-events-event-selector .combobox-input:focus {
  border-color: var(--interactive-accent);
  box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2);
}

.key-events-event-selector .combobox-dropdown {
  margin-top: 0;
  border-radius: 0 0 6px 6px;
  border: 1px solid var(--background-modifier-border);
  border-top: none;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.key-events-event-selector .combobox-option,
.key-events-event-selector .combobox-add-option {
  padding: 10px 12px;
}

.key-events-event-selector .combobox-option:last-child {
  border-bottom: none;
}

.key-events-color-picker {
  display: flex;
  align-items: center;
  gap: 8px;
}

.key-events-color-label,
.key-events-day-label {
  font-size: 12px;
  color: var(--text-muted);
  min-width: 40px;
}

.key-events-color-option {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  border-radius: 4px;
  cursor: pointer;
  padding: 4px;
  /* Reset button defaults */
  background: transparent;
  border: none;
  outline: none;
}

.key-events-color-option:focus-visible {
  outline: 2px solid var(--interactive-accent);
  outline-offset: 1px;
}

.key-events-color-option:hover {
  background: var(--background-modifier-hover);
}

.key-events-color-option.selected {
  box-shadow: 0 0 0 2px var(--interactive-accent);
}

.key-events-color-dot {
  width: 16px;
  height: 16px;
  border-radius: 50%;
  border: 1px solid var(--background-modifier-border);
}

.key-events-day-selector {
  display: flex;
  align-items: center;
  gap: 8px;
}

.key-events-day-select {
  padding: 4px 8px;
  border-radius: 4px;
  border: 1px solid var(--background-modifier-border);
  background: var(--background-primary);
  color: var(--text-normal);
  font-size: 13px;
  width: auto;
}

.key-events-notes-input {
  width: 100%;
  min-height: 60px;
  padding: 8px;
  border-radius: 4px;
  border: 1px solid var(--background-modifier-border);
  background: var(--background-primary);
  color: var(--text-normal);
  font-size: 14px;
  resize: vertical;
}

.key-events-add-button {
  align-self: flex-start;
  padding: 8px 16px;
  border-radius: 4px;
  border: none;
  background: var(--interactive-accent);
  color: var(--text-on-accent);
  font-size: 14px;
  cursor: pointer;
}

.key-events-add-button:hover:not(:disabled) {
  background: var(--interactive-accent-hover);
}

.key-events-add-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.key-events-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.key-events-item {
  padding: 6px 10px;
  border-radius: 6px;
  background: var(--background-secondary);
  border-left: 3px solid var(--event-color-gray);
}

.key-events-item.event-color-red {
  border-left-color: var(--event-color-red);
}

.key-events-item.event-color-orange {
  border-left-color: var(--event-color-orange);
}

.key-events-item.event-color-yellow {
  border-left-color: var(--event-color-yellow);
}

.key-events-item.event-color-gray {
  border-left-color: var(--event-color-gray);
}

.key-events-item-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 8px;
}

.key-events-item-title {
  display: flex;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
}

.key-events-item-title h4 {
  margin: 0;
  font-size: 14px;
  font-weight: 600;
}

.key-events-day-badge {
  font-size: 11px;
  padding: 2px 8px;
  background: var(--background-modifier-border);
  border-radius: 4px;
  color: var(--text-muted);
}

.key-events-day-badge.key-events-all-week {
  /* Same styling as base - kept for semantic clarity */
}

.key-events-remove-button {
  padding: 2px 6px;
  border-radius: 4px;
  border: none;
  background: transparent;
  color: var(--text-muted);
  font-size: 11px;
  cursor: pointer;
  line-height: 1;
}

.key-events-remove-button:hover {
  background: var(--background-modifier-hover);
  color: var(--text-error);
}

.key-events-item-notes {
  display: block;
  margin-top: 2px;
  font-size: 12px;
  color: var(--text-muted);
  line-height: 1.2;
  font-style: italic;
}
`,rG=!1});var gt,gwe,u7e,nG,p7e,m7e,f7e,Uk,Dz=F(()=>{gt=Y(Q()),gwe=require("obsidian");Ot();Hp();ET();Dn();ro();ds();Zs();fwe();_t();u7e=["weekly-review","drc"],nG=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],p7e=["gray","red","orange","yellow"],m7e=3,f7e=100,Uk=gt.default.memo(({filePath:e,plugin:t,preview:r,previewData:n})=>{let[i,a]=(0,gt.useState)([]),[o,s]=(0,gt.useState)(!0),[l,c]=(0,gt.useState)(!0),[d,u]=(0,gt.useState)(null),[p,m]=(0,gt.useState)(null),[g,f]=(0,gt.useState)(""),[v,h]=(0,gt.useState)("gray"),[y,b]=(0,gt.useState)(""),[k,x]=(0,gt.useState)(""),[S,w]=(0,gt.useState)([]),C=(0,gt.useRef)(0),D=(0,gt.useRef)(null);(0,gt.useEffect)(()=>{mwe()},[]),(0,gt.useEffect)(()=>()=>{D.current&&clearTimeout(D.current)},[]);let P=d==="weekly-review"&&!r;(0,gt.useEffect)(()=>{if(!t.optionsService)return;let j=t.optionsService.getOptions("event");w(j)},[t.optionsService]),Xe("options:changed",()=>{if(t.optionsService){let j=t.optionsService.getOptions("event");w(j)}});let M=(0,gt.useCallback)(async()=>{var q;if(r&&n){a(n.events),u(n.reviewMode||"drc"),s(!1),c(!0);return}let j=t.app.vault.getAbstractFileByPath(e);if(!(j instanceof gwe.TFile)){c(!1),s(!1);return}let R=t.app.metadataCache.getFileCache(j),O=R==null?void 0:R.frontmatter;if(!O){if(C.current<m7e){C.current++,D.current=setTimeout(()=>M(),f7e);return}c(!1),s(!1);return}let H=O.type;if(!u7e.includes(H)){c(!1),s(!1);return}if(u(H),H==="weekly-review"){let V=O.keyEvents||[];a(V),c(!0),s(!1)}else if(H==="drc"){let V=O.date?(q=ur(O.date))!=null?q:new Date:new Date;m(V);try{let J=t.serviceManager?await t.serviceManager.getDRCService():t.drcService;if(!J){console.warn("[KeyEventsWidget] DRCService not available yet"),a([]),c(!0),s(!1);return}let K=await J.getWeeklyEventsForDate(V);a(K)}catch(J){console.error("[KeyEventsWidget] Error loading events:",J),a([])}c(!0),s(!1)}},[e,t,r,n]);(0,gt.useEffect)(()=>{C.current=0,s(!0),M()},[M]);let z=(0,gt.useCallback)(j=>{d==="drc"&&j.type==="weekly"&&j.action==="updated"&&M()},[d,M]);Xe("review:changed",z,!r);let A=(0,gt.useMemo)(()=>[...i].sort((j,R)=>!j.day&&R.day?-1:j.day&&!R.day?1:!j.day&&!R.day?0:nG.indexOf(j.day)-nG.indexOf(R.day)),[i]),I=async j=>{if(d==="weekly-review")try{await t.weeklyReviewService.updateWeeklyReviewFrontmatter(e,{keyEvents:j})}catch(R){console.error("[KeyEventsWidget] Failed to update frontmatter:",R)}},L=async()=>{if(!g||!P)return;t.optionsService&&t.optionsService.addOrUpdateEventOption(g,v);let j={event:g,notes:k,color:v,day:y||void 0},R=[...i,j];a(R),await I(R),f(""),x(""),h("gray"),b("")},E=async j=>{if(!P)return;let R=i.filter((O,H)=>H!==j);a(R),await I(R)},T=j=>{let R=Array.isArray(j)?j[0]:j;if(f(R),t.optionsService&&R){let O=t.optionsService.getEventOptionByName(R);O!=null&&O.color&&h(O.color)}},$=j=>{t.optionsService&&t.optionsService.addOrUpdateEventOption(j,v)};if(o)return gt.default.createElement("div",{style:{display:"flex",justifyContent:"center",width:"100%"}},gt.default.createElement("div",{style:{padding:"0.75rem",background:"var(--background-primary)",borderRadius:"var(--radius-m, 8px)",border:"1px solid var(--background-modifier-border)",maxWidth:"600px",width:"100%"}},gt.default.createElement("div",{style:{display:"flex",justifyContent:"center",marginBottom:"0.5rem"}},gt.default.createElement(ae,{width:100,height:14,borderRadius:"4px"})),gt.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"8px"}},[1,2,3].map(j=>gt.default.createElement("div",{key:j,style:{padding:"6px 10px",borderRadius:"6px",background:"var(--background-secondary)",borderLeft:"3px solid var(--background-modifier-border)"}},gt.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"2px"}},gt.default.createElement(ae,{width:120,height:14,borderRadius:"4px"}),gt.default.createElement(ae,{width:50,height:12,borderRadius:"4px"})),gt.default.createElement(ae,{width:"70%",height:10,borderRadius:"4px"}))))));if(!l)return gt.default.createElement(_r,{widgetType:"Key Events"});let _=(j,R)=>{let O=j.color?`event-color-${j.color}`:"event-color-gray",H=d==="weekly-review"||!j.day;return gt.default.createElement("div",{key:`event-${R}`,className:`key-events-item ${O}`},gt.default.createElement("div",{className:"key-events-item-header"},gt.default.createElement("div",{className:"key-events-item-title"},gt.default.createElement("h4",null,j.event),H&&(j.day?gt.default.createElement("span",{className:"key-events-day-badge"},j.day):gt.default.createElement("span",{className:"key-events-day-badge key-events-all-week"},"All Week"))),P&&gt.default.createElement("button",{className:"key-events-remove-button",onClick:()=>E(R)},"Remove")),j.notes&&gt.default.createElement("span",{className:"key-events-item-notes"},j.notes))};return gt.default.createElement("div",{style:{display:"flex",justifyContent:"center",width:"100%"}},gt.default.createElement("div",{className:"key-events-widget",style:{padding:"0.75rem",background:"var(--background-primary)",borderRadius:"var(--radius-m, 8px)",border:"1px solid var(--background-modifier-border)",maxWidth:"600px",width:"100%"}},gt.default.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginBottom:"0.5rem",gap:"6px"}},gt.default.createElement("span",{style:{fontSize:"0.7rem",fontWeight:500,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.5px",textAlign:"center"}},"Key Events ",i.length>0&&`(${i.length})`),d==="drc"&&gt.default.createElement(pn,{content:gt.default.createElement("div",{style:{maxWidth:"250px",lineHeight:1.4}},"Key events are set in your Weekly Review. Open this week's review to add or edit events."),preferredPosition:"top"},gt.default.createElement("span",{style:{cursor:"help",fontSize:"0.65rem",color:"var(--text-muted)",opacity:.7}},"?"))),P&&gt.default.createElement("div",{className:"key-events-form"},gt.default.createElement("div",{className:"key-events-form-row"},gt.default.createElement("div",{className:"key-events-event-selector"},gt.default.createElement(Xs,{label:"",options:S,value:g,onChange:T,placeholder:"Select or create event",allowCreate:!0,isMulti:!1,optionType:"event",onSaveOption:$,error:"",helperText:"",required:!1}))),gt.default.createElement("div",{className:"key-events-color-picker"},gt.default.createElement("span",{className:"key-events-color-label"},"Color:"),p7e.map(j=>gt.default.createElement("button",{type:"button",key:j,className:`key-events-color-option ${v===j?"selected":""}`,onClick:()=>h(j),"aria-label":`Select ${j.charAt(0).toUpperCase()+j.slice(1)} color`,"aria-pressed":v===j},gt.default.createElement("span",{className:"key-events-color-dot",style:{backgroundColor:`var(--event-color-${j}, ${j==="gray"?"#888":j})`},"aria-hidden":"true"})))),gt.default.createElement("div",{className:"key-events-day-selector"},gt.default.createElement("span",{className:"key-events-day-label"},"Day:"),gt.default.createElement("select",{value:y,onChange:j=>b(j.target.value),className:"key-events-day-select"},gt.default.createElement("option",{value:""},"All Week"),nG.map(j=>gt.default.createElement("option",{key:j,value:j},j)))),gt.default.createElement("textarea",{value:k,onChange:j=>x(j.target.value),placeholder:"Notes about this event (optional)",className:"key-events-notes-input"}),gt.default.createElement("button",{className:"key-events-add-button",onClick:L,disabled:!g},"Add Event")),i.length>0?gt.default.createElement("div",{className:"key-events-list"},A.map((j,R)=>_(j,R))):d==="drc"?gt.default.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"1.5rem 1rem",color:"var(--text-muted)"}},gt.default.createElement(ef,{size:32,style:{marginBottom:"8px",opacity:.5}}),gt.default.createElement("div",{style:{fontSize:"13px",marginBottom:"4px"}},"No key events for today"),gt.default.createElement("div",{style:{fontSize:"11px",opacity:.7}},"Add events in your Weekly Review")):null))});Uk.displayName="KeyEventsWidget"});var Nt,sD,g7e,h7e,v7e,Ez,Hk,Iz=F(()=>{Nt=Y(Q()),sD=require("obsidian");Ot();us();Hp();Zs();Oa();_t();g7e=5,h7e=100,v7e=["drc","weekly-review"],Ez=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],Hk=(0,Nt.memo)(({filePath:e,plugin:t,config:r,preview:n,previewData:i})=>{let[a,o]=(0,Nt.useState)([]),[s,l]=(0,Nt.useState)(!0),[c,d]=(0,Nt.useState)(!0),[u,p]=(0,Nt.useState)(null),[m,g]=(0,Nt.useState)(null),f=(0,Nt.useRef)(0),v=(0,Nt.useCallback)(async()=>{if(n&&i){o(i.missedTrades),p(i.noteType||"drc"),l(!1),d(!0);return}let W=t.app.vault.getAbstractFileByPath(e);if(!(W instanceof sD.TFile)){d(!1),l(!1);return}let N=t.app.metadataCache.getFileCache(W),U=N==null?void 0:N.frontmatter;if(!U){if(f.current<g7e){f.current++,setTimeout(()=>v(),h7e);return}d(!1),l(!1);return}let j=U.type;if(!v7e.includes(j)){d(!1),l(!1);return}p(j);let R,O;if(j==="drc"){let H=ur(U.date);if(!H){d(!1),l(!1);return}let q=Zt(H,t);g(q),R=new Date(q),R.setHours(0,0,0,0),O=new Date(q),O.setHours(23,59,59,999)}else if(j==="weekly-review")if(U.weekStart&&U.weekEnd){let H=ur(U.weekStart),q=ur(U.weekEnd);if(!H||!q){d(!1),l(!1);return}R=H,O=q,O.setHours(23,59,59,999),g(R)}else{let H=ur(U.date);if(!H){d(!1),l(!1);return}g(H),R=new Date(H),R.setHours(0,0,0,0),O=new Date(H.getTime()+10080*60*1e3),O.setHours(23,59,59,999)}else{d(!1),l(!1);return}try{let H=t.serviceManager?await t.serviceManager.getMissedTradeService():t.missedTradeService;if(!H){console.warn("[MissedTradesWidget] MissedTradeService not available yet"),o([]),d(!0),l(!1);return}let q=await H.getMissedTrades(R,O),V=[];for(let J of q){let K=t.app.metadataCache.getFileCache(J),G=K==null?void 0:K.frontmatter;G&&G.type==="missed-trade"&&V.push({file:J,instrument:G.instrument||"Unknown",direction:G.direction||"Unknown",setup:G.setup||[],missedReason:G.missedReason||"",entryTime:G.entryTime?new Date(G.entryTime):new Date,path:J.path})}V.sort((J,K)=>K.entryTime.getTime()-J.entryTime.getTime()),o(V)}catch(H){console.error("[MissedTradesWidget] Error loading missed trades:",H),o([])}d(!0),l(!1)},[e,t,n,i]);(0,Nt.useEffect)(()=>{f.current=0,v()},[v]);let h=(0,Nt.useCallback)(()=>{v()},[v]);Xe("missed-trade:changed",h,!n);let y=(0,Nt.useCallback)(W=>{t.app.workspace.openLinkText(W,"",!0)},[t]),b=(0,Nt.useCallback)(()=>{var W;if(!m){new sD.Notice("Cannot determine date for new missed trade");return}try{let N={isMissedTrade:!0,entryTime:m};try{let{TradeFormModal:U}=(Wp(),hd(fee));new U({app:t.app,plugin:t,isEditMode:!1,initialData:N}).open()}catch(U){(W=t.viewManager)==null||W.openTradeFormView(N)}}catch(N){console.error("[MissedTradesWidget] Error opening trade form:",N),new sD.Notice("Failed to open missed trade form")}},[t,m]),k=W=>{let N=W.toLowerCase();return N==="long"||N==="buy"?"var(--color-green, #4caf50)":N==="short"||N==="sell"?"var(--color-red, #f44336)":"var(--text-muted)"},x=W=>Ez[W.getDay()===0?6:W.getDay()-1],S=W=>{var U;let N=new Map;for(let j of Ez)N.set(j,[]);for(let j of W){let R=x(j.entryTime),O=N.get(R)||[];O.push(j),N.set(R,O)}for(let j of Ez)((U=N.get(j))==null?void 0:U.length)===0&&N.delete(j);return N},w={display:"flex",justifyContent:"center",width:"100%"},C={padding:"0.75rem",background:"var(--background-primary)",borderRadius:"var(--radius-m, 8px)",border:"1px solid var(--background-modifier-border)",maxWidth:"600px",width:"100%"},D={display:"flex",justifyContent:"center",alignItems:"center",marginBottom:"0.5rem",gap:"6px"},P={fontSize:"0.7rem",fontWeight:500,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.5px",textAlign:"center"};if(s)return Nt.default.createElement("div",{style:w},Nt.default.createElement("div",{style:C},Nt.default.createElement("div",{style:{display:"flex",justifyContent:"center",marginBottom:"0.5rem"}},Nt.default.createElement(ae,{width:100,height:14,borderRadius:"4px"})),Nt.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"8px"}},[1,2].map(W=>Nt.default.createElement("div",{key:W,style:{padding:"6px 10px",borderRadius:"6px",background:"var(--background-secondary)",borderLeft:"3px solid var(--background-modifier-border)"}},Nt.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"2px"}},Nt.default.createElement(ae,{width:80,height:14,borderRadius:"4px"}),Nt.default.createElement(ae,{width:50,height:16,borderRadius:"10px"})),Nt.default.createElement(ae,{width:"70%",height:10,borderRadius:"4px"}))))));if(!c)return Nt.default.createElement("div",{style:{padding:"1rem",textAlign:"center",color:"var(--text-muted)",fontSize:"0.85rem"}},"Missed Trades widget is only available in DRC and Weekly review notes.");let M=2,z=12,A=W=>W.length<=z?W:W.substring(0,z-1)+"\u2026",I=({setup:W})=>Nt.default.createElement("div",{style:{maxWidth:"200px",lineHeight:1.4}},W),L=({setups:W})=>Nt.default.createElement("div",{className:"badge-tooltip setups-tooltip"},Nt.default.createElement("div",{className:"tooltip-title"},"Additional Setups:"),W.map((N,U)=>Nt.default.createElement("div",{key:U,className:"tooltip-item"},"\u2022 ",N))),E=W=>{if(!W||W.length===0)return null;let N=W.slice(0,M),U=W.length-M,j=W.slice(M),R={fontSize:"10px",padding:"2px 6px",background:"rgba(33, 150, 243, 0.15)",color:"var(--color-info, #2196f3)",borderRadius:"4px",fontWeight:500,whiteSpace:"nowrap"};return Nt.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"4px",flexShrink:0}},N.map((O,H)=>{let q=O.length>z,V=Nt.default.createElement("span",{key:H,style:R},A(O));return q?Nt.default.createElement(pn,{key:H,content:Nt.default.createElement(I,{setup:O}),delay:0,preferredPosition:"top"},V):V}),U>0&&Nt.default.createElement(pn,{content:Nt.default.createElement(L,{setups:j}),delay:0,preferredPosition:"top"},Nt.default.createElement("span",{style:{fontSize:"10px",padding:"2px 6px",background:"var(--background-modifier-border)",color:"var(--text-muted)",borderRadius:"4px",fontWeight:500,cursor:"help"}},"+",U)))},T=W=>{let N=k(W.direction),U=W.direction.toLowerCase()==="long"||W.direction.toLowerCase()==="buy"?"Long":W.direction.toLowerCase()==="short"||W.direction.toLowerCase()==="sell"?"Short":W.direction;return Nt.default.createElement("div",{key:W.path,onClick:()=>y(W.path),style:{padding:"6px 10px",borderRadius:"6px",background:"var(--background-secondary)",borderLeft:`3px solid ${N}`,cursor:"pointer",transition:"background-color 0.15s ease"},onMouseEnter:j=>{j.currentTarget.style.backgroundColor="var(--background-modifier-hover)"},onMouseLeave:j=>{j.currentTarget.style.backgroundColor="var(--background-secondary)"}},Nt.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"8px"}},Nt.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"6px",minWidth:0,flexWrap:"wrap"}},Nt.default.createElement("h4",{style:{margin:0,fontSize:"14px",fontWeight:600,flexShrink:0}},W.instrument),Nt.default.createElement("span",{style:{fontSize:"10px",padding:"2px 6px",background:"var(--background-modifier-border)",borderRadius:"4px",color:"var(--text-muted)",fontWeight:500,flexShrink:0}},U),E(W.setup)),Nt.default.createElement("span",{style:{padding:"2px 8px",borderRadius:"4px",background:"var(--color-orange, #ef6c00)",color:"white",fontSize:"10px",fontWeight:600,textTransform:"uppercase",flexShrink:0}},"Missed")),W.missedReason&&Nt.default.createElement("div",{style:{marginTop:"4px",fontSize:"11px",color:"var(--text-muted)",lineHeight:1.3,fontStyle:"italic"}},W.missedReason.length>80?W.missedReason.substring(0,80)+"...":W.missedReason))},$=(W,N)=>Nt.default.createElement("div",{key:W,style:{marginBottom:"12px"}},Nt.default.createElement("div",{style:{fontSize:"11px",fontWeight:600,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"6px",paddingBottom:"4px",borderBottom:"1px solid var(--background-modifier-border)"}},W),Nt.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"6px"}},N.map(T))),_=()=>Nt.default.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"1.5rem 1rem",color:"var(--text-muted)"}},Nt.default.createElement(ef,{size:32,style:{marginBottom:"8px",opacity:.5}}),Nt.default.createElement("div",{style:{fontSize:"13px",marginBottom:"4px"}},u==="drc"?"No missed trades today":"No missed trades this week"),Nt.default.createElement("div",{style:{fontSize:"11px",opacity:.7}},"Track opportunities you identified but didn't take")),B=u==="weekly-review"?S(a):null;return Nt.default.createElement("div",{style:w},Nt.default.createElement("div",{style:C},Nt.default.createElement("div",{style:D},Nt.default.createElement("span",{style:P},"Missed Trades ",a.length>0&&`(${a.length})`),!n&&u==="drc"&&Nt.default.createElement("button",{onClick:b,className:"clickable-icon","aria-label":"Add missed trade",style:{padding:"2px 6px",borderRadius:"4px",background:"transparent",border:"none",color:"var(--text-muted)",fontSize:"11px",cursor:"pointer",display:"flex",alignItems:"center",gap:"2px"},onMouseEnter:W=>{W.currentTarget.style.backgroundColor="var(--background-modifier-hover)",W.currentTarget.style.color="var(--text-normal)"},onMouseLeave:W=>{W.currentTarget.style.backgroundColor="transparent",W.currentTarget.style.color="var(--text-muted)"}},Nt.default.createElement(Ui,{size:12}),"Add")),a.length===0?_():u==="weekly-review"&&B?Nt.default.createElement("div",null,Ez.filter(W=>B.has(W)).map(W=>$(W,B.get(W)))):Nt.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"8px"}},a.map(T))))});Hk.displayName="MissedTradesWidget"});var hwe=F(()=>{bV();wV();SV();CV();PV();DV();AV();rz();nz();iz();az();oz();sz();lz();cz();dz();uz();pz();mz();fz();gz();vz();yz();xz();kz();Tz();Pz();Dz();Iz();ro()});var vwe,ywe,ln,iG,Mz,bwe=F(()=>{vwe=require("obsidian"),ywe=Y(Ni()),ln=Y(Q());hwe();rz();nz();dz();az();oz();sz();lz();cz();iz();uz();pz();mz();fz();gz();vz();yz();xz();kz();Tz();Pz();Dz();Iz();Er();ff();iG=class extends vwe.MarkdownRenderChild{constructor(r,n){super(r);this.root=null;this.onUnloadCallback=null;this.onUnloadCallback=n||null}setRoot(r){this.root=r}onunload(){this.root&&(this.root.unmount(),this.root=null),this.onUnloadCallback&&this.onUnloadCallback()}},Mz=class{constructor(t){this.roots=new Map;this.registeredTypes=new Set;this.plugin=t}registerAll(){tl();let t=["header","goals","checklist","key-levels","trades","review","missed-trades","stats","key-events","pnl-chart","drawdown-chart","breakdown","best-worst","trades-chart","technical-game","mental-game","demon-tracker","setup-performance","directional-pnl","images","mark-reviewed"];for(let r of t)this.registerProcessor(r)}registerProcessor(t){let r=`journalit-${t}`;this.plugin.registerMarkdownCodeBlockProcessor(r,(n,i,a)=>{this.processCodeblock(t,n,i,a)}),this.registeredTypes.add(r)}processCodeblock(t,r,n,i){n.empty(),n.addClass("journalit-widget",`journalit-${t}`);let a=this.createWidget(t,r,i.sourcePath),o=new iG(n,()=>{this.roots.delete(n)}),s=(0,ywe.createRoot)(n);s.render((0,ln.createElement)(el,null,a)),o.setRoot(s),this.roots.set(n,s),i.addChild(o)}createWidget(t,r,n){if(t==="header")return(0,ln.createElement)(bk,{filePath:n,plugin:this.plugin});if(t==="goals")return(0,ln.createElement)(xk,{filePath:n,plugin:this.plugin});if(t==="checklist")return(0,ln.createElement)(wk,{filePath:n,plugin:this.plugin});if(t==="review"){let i={};try{r.trim()&&(i=JSON.parse(r))}catch(a){console.warn("[WidgetCodeblockProcessor] Invalid config for review widget:",r)}return(0,ln.createElement)(QP,{filePath:n,plugin:this.plugin,config:i})}if(t==="stats"){let i={};try{if(r.trim()){let a=r.trim().split(`
`);for(let o of a){let s=o.indexOf(":");if(s>0){let l=o.substring(0,s).trim(),c=o.substring(s+1).trim();l==="columns"&&(i.columns=parseInt(c,10))}}}}catch(a){console.warn("[WidgetCodeblockProcessor] Invalid config for stats widget:",r)}return(0,ln.createElement)(kk,{filePath:n,plugin:this.plugin,config:i})}if(t==="pnl-chart"){let i={};try{if(r.trim()){let a=r.trim().split(`
`);for(let o of a){let s=o.indexOf(":");if(s>0){let l=o.substring(0,s).trim(),c=o.substring(s+1).trim();l==="height"&&(i.height=parseInt(c,10))}}}}catch(a){console.warn("[WidgetCodeblockProcessor] Invalid config for pnl-chart widget:",r)}return(0,ln.createElement)(Sk,{filePath:n,plugin:this.plugin,config:i})}if(t==="drawdown-chart"){let i={};try{if(r.trim()){let a=r.trim().split(`
`);for(let o of a){let s=o.indexOf(":");if(s>0){let l=o.substring(0,s).trim(),c=o.substring(s+1).trim();l==="height"&&(i.height=parseInt(c,10))}}}}catch(a){console.warn("[WidgetCodeblockProcessor] Invalid config for drawdown-chart widget:",r)}return(0,ln.createElement)(Tk,{filePath:n,plugin:this.plugin,config:i})}if(t==="trades"){let i={};if(r.trim()){let a=r.trim().split(`
`);for(let o of a){let s=o.indexOf(":");if(s>0){let l=o.substring(0,s).trim(),c=o.substring(s+1).trim();l==="showOpenTrades"&&(i.showOpenTrades=c==="true"),l==="pageSize"&&(i.pageSize=parseInt(c,10))}}}return(0,ln.createElement)(Pk,{filePath:n,plugin:this.plugin,config:i})}if(t==="breakdown"){let i={};if(r.trim()){let o=r.trim().split(`
`);for(let s of o){let l=s.indexOf(":");if(l>0){let c=s.substring(0,l).trim(),d=s.substring(l+1).trim();c==="period"&&(i.period=d),c==="groupBy"&&(i.groupBy=d)}}}let a=i.period||"daily";return(0,ln.createElement)(Dk,{filePath:n,plugin:this.plugin,config:i,period:a})}if(t==="setup-performance"){let i={};if(r.trim()){let a=r.trim().split(`
`);for(let o of a){let s=o.indexOf(":");if(s>0){let l=o.substring(0,s).trim(),c=o.substring(s+1).trim();l==="showChart"&&(i.showChart=c==="true"),l==="showTable"&&(i.showTable=c==="true"),l==="topN"&&(i.topN=parseInt(c,10)),l==="sortBy"&&(i.sortBy=c),l==="height"&&(i.height=parseInt(c,10))}}}return(0,ln.createElement)(Nk,{filePath:n,plugin:this.plugin,config:i})}if(t==="best-worst"){let i={};if(r.trim()){let o=r.trim().split(`
`);for(let s of o){let l=s.indexOf(":");if(l>0){let c=s.substring(0,l).trim(),d=s.substring(l+1).trim();c==="period"&&(i.period=d),c==="showBest"&&(i.showBest=d==="true"),c==="showWorst"&&(i.showWorst=d==="true"),c==="showDuration"&&(i.showDuration=d==="true"),c==="showSetups"&&(i.showSetups=d==="true"),c==="showMistakes"&&(i.showMistakes=d==="true")}}}switch(i.period||"trades"){case"trades":return(0,ln.createElement)(Qb,{filePath:n,plugin:this.plugin,config:i});case"days":return(0,ln.createElement)(Ik,{filePath:n,plugin:this.plugin,config:i});case"weeks":return(0,ln.createElement)(Mk,{filePath:n,plugin:this.plugin,config:i});case"months":return(0,ln.createElement)(Ak,{filePath:n,plugin:this.plugin,config:i});case"quarters":return(0,ln.createElement)(Lk,{filePath:n,plugin:this.plugin,config:i});default:return(0,ln.createElement)(Qb,{filePath:n,plugin:this.plugin,config:i})}}if(t==="trades-chart"){let i={};if(r.trim()){let o=r.trim().split(`
`);for(let s of o){let l=s.indexOf(":");if(l>0){let c=s.substring(0,l).trim(),d=s.substring(l+1).trim();c==="period"&&(i.period=d),c==="height"&&(i.height=parseInt(d,10))}}}switch(i.period||"trades"){case"trades":return(0,ln.createElement)(Ek,{filePath:n,plugin:this.plugin,config:i});case"daily":return(0,ln.createElement)(eD,{filePath:n,plugin:this.plugin,config:i});case"weekly":return(0,ln.createElement)(tD,{filePath:n,plugin:this.plugin,config:i});case"monthly":return(0,ln.createElement)(rD,{filePath:n,plugin:this.plugin,config:i});case"quarterly":return(0,ln.createElement)(nD,{filePath:n,plugin:this.plugin,config:i});default:return(0,ln.createElement)(Ek,{filePath:n,plugin:this.plugin,config:i})}}if(t==="directional-pnl"){let i={};if(r.trim()){let a=r.trim().split(`
`);for(let o of a){let s=o.indexOf(":");if(s>0){let l=o.substring(0,s).trim(),c=o.substring(s+1).trim();l==="showLong"&&(i.showLong=c==="true"),l==="showShort"&&(i.showShort=c==="true"),l==="height"&&(i.height=parseInt(c,10)),l==="layout"&&(i.layout=c)}}}return(0,ln.createElement)(Fk,{filePath:n,plugin:this.plugin,config:i})}if(t==="images"){let i={};if(r.trim()){let a=r.trim().split(`
`);for(let o of a){let s=o.indexOf(":");if(s>0){let l=o.substring(0,s).trim(),c=o.substring(s+1).trim();l==="maxImages"&&(i.maxImages=parseInt(c,10)),l==="showUploader"&&(i.showUploader=c==="true"),l==="layout"&&(i.layout=c)}}}return(0,ln.createElement)(Ok,{filePath:n,plugin:this.plugin,config:i})}return t==="mark-reviewed"?(0,ln.createElement)(aD,{filePath:n,plugin:this.plugin}):t==="technical-game"?(0,ln.createElement)(jk,{filePath:n,plugin:this.plugin}):t==="mental-game"?(0,ln.createElement)(Bk,{filePath:n,plugin:this.plugin}):t==="demon-tracker"?(0,ln.createElement)($k,{filePath:n,plugin:this.plugin}):t==="key-levels"?(0,ln.createElement)(Rk,{filePath:n,plugin:this.plugin}):t==="key-events"?(0,ln.createElement)(Uk,{filePath:n,plugin:this.plugin}):t==="missed-trades"?(0,ln.createElement)(Hk,{filePath:n,plugin:this.plugin}):this.createPlaceholderWidget(t,r,n)}createPlaceholderWidget(t,r,n){return(0,ln.createElement)("div",{className:"journalit-placeholder-widget",style:{padding:"1rem",border:"1px dashed var(--text-muted)",borderRadius:"4px",textAlign:"center",color:"var(--text-muted)"}},[(0,ln.createElement)("div",{key:"title",style:{fontWeight:"bold",marginBottom:"0.5rem"}},`${t} widget`),(0,ln.createElement)("div",{key:"path",style:{fontSize:"0.8rem"}},`File: ${n}`),r&&(0,ln.createElement)("div",{key:"source",style:{fontSize:"0.8rem",marginTop:"0.5rem"}},`Source: ${r.substring(0,50)}${r.length>50?"...":""}`)].filter(Boolean))}unregisterAll(){for(let[t,r]of this.roots.entries())try{r.unmount()}catch(n){console.error("Failed to unmount root for element:",n)}this.roots.clear(),this.registeredTypes.clear()}getRegisteredTypes(){return Array.from(this.registeredTypes)}}});function b7e(){if(document.head.querySelector("#legacy-migration-notice-styles"))return;let e=document.createElement("style");e.id="legacy-migration-notice-styles",e.textContent=y7e,document.head.appendChild(e)}function xwe(){b7e()}var y7e,wwe=F(()=>{y7e=`
.legacy-migration-notice {
  display: flex;
  gap: 16px;
  padding: 24px;
  margin: 32px auto;
  max-width: 500px;
  background: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  border-left: 4px solid var(--text-warning);
}

.legacy-migration-notice--complete {
  border-left-color: var(--text-success);
}

.legacy-migration-notice__icon {
  font-size: 32px;
  flex-shrink: 0;
}

.legacy-migration-notice__content {
  flex: 1;
}

.legacy-migration-notice__title {
  margin: 0 0 8px 0;
  font-size: 18px;
  font-weight: 600;
  color: var(--text-normal);
}

.legacy-migration-notice__description {
  margin: 0 0 12px 0;
  color: var(--text-muted);
  line-height: 1.5;
}

.legacy-migration-notice__info {
  margin: 0 0 4px 0;
  color: var(--text-muted);
  font-weight: 500;
}

.legacy-migration-notice__list {
  margin: 0 0 16px 0;
  padding-left: 20px;
  color: var(--text-muted);
  line-height: 1.6;
}

.legacy-migration-notice__list li {
  margin: 4px 0;
}

.legacy-migration-notice__error {
  padding: 8px 12px;
  margin-bottom: 16px;
  background: rgba(var(--color-red-rgb), 0.1);
  border: 1px solid var(--text-error);
  border-radius: 4px;
  color: var(--text-error);
  font-size: 13px;
}

.legacy-migration-notice__actions {
  display: flex;
  gap: 12px;
}

.legacy-migration-notice__button {
  padding: 8px 16px;
  border-radius: 4px;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.15s ease;
}

.legacy-migration-notice__button:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.legacy-migration-notice__button--primary {
  background: var(--interactive-accent);
  color: var(--text-on-accent);
  border: none;
}

.legacy-migration-notice__button--primary:hover:not(:disabled) {
  background: var(--interactive-accent-hover);
}
`});function x7e(e){switch(e){case"drc":return"Daily Review";case"weekly-review":return"Weekly Review";case"monthly-review":return"Monthly Review";default:return"Review"}}var Gn,kwe,w7e,aG,oG=F(()=>{Gn=Y(Q()),kwe=require("obsidian");cq();qF();Xw();nr();wwe();w7e=({noteType:e,filePath:t})=>{let r=Ae(),[n,i]=(0,Gn.useState)(!1),[a,o]=(0,Gn.useState)(null),[s,l]=(0,Gn.useState)(!1);(0,Gn.useEffect)(()=>{xwe()},[]),(0,Gn.useEffect)(()=>{(async()=>{try{r!=null&&r.app&&await mu(r.app,Zh)&&l(!0)}catch(u){console.warn("[LegacyMigrationNotice] Failed to check migration status:",u)}})()},[r]);let c=(0,Gn.useCallback)(async()=>{o(null);try{if(!r)throw new Error("Plugin not found");let d=new ev(r),u=await d.countLegacyNotes();if(u.total===0){o("No legacy notes found to migrate.");return}new tg(r.app,u,async()=>{i(!0);let p=new rg(r.app,u.total);p.open();try{let m=await d.migrateAll({backup:!0,onProgress:(g,f)=>{p.updateProgress(g,f)}});p.close(),new ng(r.app,{migrated:m.migrated,failed:m.failed,skipped:m.skipped,backupsCreated:m.backupsCreated}).open(),l(!0)}catch(m){p.close(),o(m instanceof Error?m.message:"Migration failed")}finally{i(!1)}},()=>{}).open()}catch(d){o(d instanceof Error?d.message:"Failed to start migration")}},[r]);return s?Gn.default.createElement("div",{className:"legacy-migration-notice legacy-migration-notice--complete"},Gn.default.createElement("div",{className:"legacy-migration-notice__icon"},"\u2713"),Gn.default.createElement("div",{className:"legacy-migration-notice__content"},Gn.default.createElement("h3",{className:"legacy-migration-notice__title"},"Migration Complete"),Gn.default.createElement("p",{className:"legacy-migration-notice__description"},"Please reload Obsidian or re-open this note to see the updated view."),Gn.default.createElement("div",{className:"legacy-migration-notice__actions"},Gn.default.createElement("button",{className:"legacy-migration-notice__button legacy-migration-notice__button--primary",onClick:()=>{if(r!=null&&r.app){let d=r.app.vault.getAbstractFileByPath(t);d instanceof kwe.TFile&&r.app.workspace.getLeaf(!1).openFile(d,{active:!0})}}},"Refresh Note")))):Gn.default.createElement("div",{className:"legacy-migration-notice"},Gn.default.createElement("div",{className:"legacy-migration-notice__icon"},"\u26A0\uFE0F"),Gn.default.createElement("div",{className:"legacy-migration-notice__content"},Gn.default.createElement("h3",{className:"legacy-migration-notice__title"},"Legacy ",x7e(e)," Format"),Gn.default.createElement("p",{className:"legacy-migration-notice__description"},"This note uses an older format that is no longer supported. Please migrate to the new Review V2 format to continue using this note."),Gn.default.createElement("p",{className:"legacy-migration-notice__info"},"Migration will:"),Gn.default.createElement("ul",{className:"legacy-migration-notice__list"},Gn.default.createElement("li",null,"Convert your note to the new template-based format"),Gn.default.createElement("li",null,"Preserve all your existing content and data"),Gn.default.createElement("li",null,"Create a backup file (can be cleaned up later)")),a&&Gn.default.createElement("div",{className:"legacy-migration-notice__error"},a),Gn.default.createElement("div",{className:"legacy-migration-notice__actions"},Gn.default.createElement("button",{className:"legacy-migration-notice__button legacy-migration-notice__button--primary",onClick:c,disabled:n},n?"Migrating...":"Migrate"))))},aG=(0,Gn.memo)(w7e)});var Swe,lD,sG=F(()=>{Swe=Y(Q());nO();oG();lD=class extends iv{constructor(t){super(t)}async renderComponent(t,r,n,i,a){var d,u;let o=`${n}-${i}`,s=this.reactRoots.get(o);if(s){s.root.render(this.createReactElement(r,n));return}let l=this.findContainingLeaf(t),c=(u=(d=l==null?void 0:l.view)==null?void 0:d.containerEl)==null?void 0:u.id;this.createReactRoot(t,o,c,a,r,n)}getComponentClassName(){return"legacy-migration-notice-view"}getWrapperClassName(){return"legacy-migration-notice-wrapper"}createReactElement(t,r){return Swe.default.createElement(aG,{noteType:t.type,filePath:r})}}});var Twe,k7e,cD,Cwe=F(()=>{Twe=require("obsidian");oO();sG();k7e=["drc","weekly-review","monthly-review"],cD=class extends ov{constructor(t,r){super(t,r,new lD(t))}isValidComponentType(t){return!t||!t.type||!k7e.includes(t.type)?!1:!t.templateId}getComponentClassName(){return"legacy-migration-notice-view"}getWrapperClassName(){return"legacy-migration-notice-wrapper"}getComponentTypeIdentifier(){return"legacy-review"}getAdditionalDataForComponent(t,r){}async handleFileOpen(t,r){var s;if(!t)return;this.cleanupOrphanedComponents(),this.cleanupUnrelatedComponents(t.path);let n=this.app.metadataCache.getFileCache(t),i=n==null?void 0:n.frontmatter;if(!i||!this.isValidComponentType(i))return;if(!i.templateId)try{if(await this.hasTemplateIdInRawFrontmatter(t))return}catch(l){console.error("[LegacyMigrationNoticeProcessor] Error reading frontmatter:",l);return}let a=this.app.workspace.getActiveViewOfType(Twe.MarkdownView);if(!a||((s=a.file)==null?void 0:s.path)!==t.path)return;a.getMode()==="source"&&this.injectIntoSourceMode(a,t,i,r)}injectIntoSourceMode(t,r,n,i){var d;let a=t.contentEl;if(!a)return;let o=a.querySelector(".cm-editor");if(!o)return;let s=a.querySelector(".legacy-migration-notice-view");if(s){if(s.getAttribute("data-file-path")===r.path)return;let u=s.getAttribute("data-view-id"),p=s.getAttribute("data-file-path");u&&p&&this.renderer.unmountComponent(p,u),s.remove()}let l=`source-${r.path}-${Date.now()}`,c=document.createElement("div");c.className=this.getComponentClassName(),c.setAttribute("data-file-path",r.path),c.setAttribute("data-view-id",l),(d=o.parentElement)==null||d.insertBefore(c,o),this.renderer.renderComponent(c,n,r.path,l),this.markFileRenderedInMode(r.path,"source")}async renderActiveComponent(){let t=this.app.workspace.getActiveFile();t&&await this.handleFileOpen(t,!1)}}});var Pwe=F(()=>{Cwe();sG();oG()});var Dwe={};Ti(Dwe,{ProcessorManager:()=>lG});var lG,Ewe=F(()=>{lV();_0e();Oq();bwe();Pwe();lG=class e{constructor(t,r){this._tradeNoteProcessor=null;this._missedTradeNoteProcessor=null;this._widgetCodeblockProcessor=null;this._legacyMigrationNoticeProcessor=null;this.initializedProcessors=new Set;this.registeredLazyHandlers=new Set;this.customProcessors=new Map;this.customRenderers=new Map;this.app=t,this.plugin=r}static getInstance(t,r){return e.instance||(e.instance=new e(t,r)),e.instance}async initializeRequiredProcessors(){let t=this.app.workspace.getActiveFile(),r=!1,n=!1,i=!1;if(t){let a=this.app.metadataCache.getFileCache(t),o=a==null?void 0:a.frontmatter;o&&(o.type==="trade"?r=!0:(o.type==="drc"||o.type==="weekly-review"||o.type==="monthly-review")&&!o.templateId?n=!0:(o.type==="missed-trade"||o.isMissedTrade===!0)&&(i=!0))}await this.getTradeNoteProcessor(),this.getWidgetCodeblockProcessor(),n?await this.getLegacyMigrationNoticeProcessor():this.registerLazyLegacyMigrationProcessor(),i?await this.getMissedTradeNoteProcessor():this.registerLazyMissedTradeProcessor()}async getTradeNoteProcessor(){return this._tradeNoteProcessor||(this._tradeNoteProcessor=await wl(()=>{let t=new KP(this.app,this.plugin);return t.initialize(),t},"TradeNoteProcessor"),this.initializedProcessors.add("tradeNoteProcessor")),this._tradeNoteProcessor}async getLegacyMigrationNoticeProcessor(){return this._legacyMigrationNoticeProcessor||(this._legacyMigrationNoticeProcessor=await wl(()=>{let t=new cD(this.app,this.plugin);return t.initialize(),t},"LegacyMigrationNoticeProcessor"),this.initializedProcessors.add("legacyMigrationNoticeProcessor")),this._legacyMigrationNoticeProcessor}async getMissedTradeNoteProcessor(){return this._missedTradeNoteProcessor||(this._missedTradeNoteProcessor=await wl(()=>{let t=new ck(this.app,this.plugin);return t.initialize(),t},"MissedTradeNoteProcessor"),this.initializedProcessors.add("missedTradeNoteProcessor")),this._missedTradeNoteProcessor}getWidgetCodeblockProcessor(){return this._widgetCodeblockProcessor||(this._widgetCodeblockProcessor=new Mz(this.plugin),this._widgetCodeblockProcessor.registerAll(),this.initializedProcessors.add("widgetCodeblockProcessor"),console.log("[Journalit] WidgetCodeblockProcessor registered during early initialization")),this._widgetCodeblockProcessor}registerLazyLegacyMigrationProcessor(){if(this.registeredLazyHandlers.has("legacy-review"))return;let t=r=>{if(!r)return;let n=this.app.metadataCache.getFileCache(r),i=n==null?void 0:n.frontmatter;i&&(i.type==="drc"||i.type==="weekly-review"||i.type==="monthly-review")&&!i.templateId&&(this.app.workspace.off("file-open",t),this.registeredLazyHandlers.delete("legacy-review"),(async()=>{try{await this.getLegacyMigrationNoticeProcessor()}catch(a){console.error("Failed to initialize legacy migration notice processor:",a)}})())};this.plugin.registerEvent(this.app.workspace.on("file-open",t)),this.registeredLazyHandlers.add("legacy-review")}registerLazyMissedTradeProcessor(){if(this.registeredLazyHandlers.has("missed-trade"))return;let t=r=>{if(!r)return;let n=this.app.metadataCache.getFileCache(r),i=n==null?void 0:n.frontmatter;i&&(i.type==="missed-trade"||i.isMissedTrade===!0)&&(this.app.workspace.off("file-open",t),this.registeredLazyHandlers.delete("missed-trade"),(async()=>{try{await this.getMissedTradeNoteProcessor()}catch(a){console.error("Failed to initialize missed trade processor:",a)}})())};this.plugin.registerEvent(this.app.workspace.on("file-open",t)),this.registeredLazyHandlers.add("missed-trade")}isProcessorInitialized(t){return this.initializedProcessors.has(t)}getAllInitializedProcessors(){return{tradeNoteProcessor:this._tradeNoteProcessor,missedTradeNoteProcessor:this._missedTradeNoteProcessor,legacyMigrationNoticeProcessor:this._legacyMigrationNoticeProcessor,widgetCodeblockProcessor:this._widgetCodeblockProcessor}}cleanupProcessors(){this._tradeNoteProcessor&&(this._tradeNoteProcessor.cleanup(),this._tradeNoteProcessor=null),this._missedTradeNoteProcessor&&(this._missedTradeNoteProcessor.cleanup(),this._missedTradeNoteProcessor=null),this._legacyMigrationNoticeProcessor&&(this._legacyMigrationNoticeProcessor.cleanup(),this._legacyMigrationNoticeProcessor=null),this._widgetCodeblockProcessor&&(this._widgetCodeblockProcessor.unregisterAll(),this._widgetCodeblockProcessor=null),this.customProcessors.forEach(t=>{t&&typeof t.cleanup=="function"&&t.cleanup()}),this.customProcessors.clear(),this.customRenderers.forEach(t=>{t&&typeof t.cleanup=="function"&&t.cleanup()}),this.customRenderers.clear(),this.initializedProcessors.clear(),this.registeredLazyHandlers.clear()}registerProcessor(t,r){this.customProcessors.set(t,r),r&&typeof r.initialize=="function"&&r.initialize(),this.initializedProcessors.add(`${t}Processor`)}registerRenderer(t,r){this.customRenderers.set(t,r)}getRenderer(t){return this.customRenderers.has(t)?this.customRenderers.get(t):null}}});var Iwe=F(()=>{});var or,S7e,Mwe,cG=F(()=>{or=Y(Q());qt();Ol();ip();Er();ap();Ll();S7e=({active:e,payload:t,currency:r,displayRMultiples:n})=>{if(!e||!t||t.length===0)return null;let i=t[0].payload;return or.default.createElement("div",{className:"journalit-chart-tooltip",style:{backgroundColor:"var(--background-primary)",borderRadius:"8px",padding:"12px 16px",minWidth:"180px",border:"1px solid var(--background-modifier-border)",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.2)",transform:"translateY(-4px)",position:"relative"}},or.default.createElement("div",{className:"journalit-chart-tooltip-date",style:{fontSize:"14px",fontWeight:500,color:"var(--text-normal)",marginBottom:"8px",textAlign:"center"}},i.date),or.default.createElement("div",{className:"journalit-chart-tooltip-value",style:{fontSize:"18px",fontWeight:600,textAlign:"center",color:"var(--text-normal)"}},"AUM: ",ye(i.balance,!0,r,!1,void 0)),(i.isDeposit||i.isWithdrawal||i.accountCreated||i.accountArchived)&&or.default.createElement("div",{style:{marginTop:"8px",padding:"6px 0",borderTop:"1px solid var(--background-modifier-border)",fontSize:"13px"}},i.isDeposit&&or.default.createElement("div",{style:{color:"#41B4F7"}},"Deposit: ",ye(i.depositAmount,!0,r,!1,void 0)),i.isWithdrawal&&or.default.createElement("div",{style:{color:"var(--text-warning, gold)"}},"Withdrawal: ",ye(i.withdrawalAmount,!0,r,!1,void 0)),i.accountCreated&&or.default.createElement("div",{style:{color:"var(--text-success)"}},"Account Added"),i.accountArchived&&or.default.createElement("div",{style:{color:"var(--text-error)"}},"Account Archived")))},Mwe=({data:e,height:t=300,plugin:r})=>{let{currency:n}=ct(),[i,a]=(0,or.useState)(!1);if((0,or.useEffect)(()=>{a(!1)},[e]),!e||e.length===0)return or.default.createElement("div",{style:{height:`${t}px`,display:"flex",alignItems:"center",justifyContent:"center"}},or.default.createElement(yi,{message:"No account data",subMessage:"Add accounts to view AUM history"}));let o=e.map(u=>u.balance),s=Math.min(...o),l=Math.max(...o),{domain:c,ticks:d}=Al(s,l,6,!0,!1);return or.default.createElement("div",{className:"aum-chart",style:{padding:"0 10px"}},or.default.createElement(Wo,{height:t,width:"100%"},or.default.createElement(gP,{data:e,margin:{top:10,right:10,left:0,bottom:25}},or.default.createElement("defs",null,or.default.createElement("linearGradient",{id:"aumGradient",x1:"0",y1:"0",x2:"0",y2:"1"},or.default.createElement("stop",{offset:"0%",stopColor:"#41B4F7",stopOpacity:.6}),or.default.createElement("stop",{offset:"100%",stopColor:"#41B4F7",stopOpacity:.1})),or.default.createElement("filter",{id:"aumShadow",height:"120%"},or.default.createElement("feDropShadow",{dx:"0",dy:"1",stdDeviation:"2",floodOpacity:"0.1"})),or.default.createElement("filter",{id:"aumGlow",height:"130%"},or.default.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"2",result:"blur"}),or.default.createElement("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7",result:"glow"}),or.default.createElement("feComposite",{in:"SourceGraphic",in2:"glow",operator:"over"}))),or.default.createElement(zo,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),or.default.createElement(jo,{dataKey:"date",style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:8,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5}}),or.default.createElement(_o,{tickFormatter:u=>ye(u,!0,n,!1,void 0),style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:c,allowDataOverflow:!1,width:85,tickLine:!1,axisLine:!1,tickMargin:8,ticks:d}),or.default.createElement(ho,{content:or.default.createElement(S7e,{currency:n,displayRMultiples:!1}),cursor:{fill:"var(--interactive-hover)",fillOpacity:.1,strokeOpacity:.3,strokeWidth:1,stroke:"#41B4F7"},wrapperStyle:{zIndex:1e3}}),or.default.createElement(Xa,{y:0,stroke:"var(--text-normal)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1}),or.default.createElement(np,{type:"monotone",dataKey:"balance",stroke:"none",fill:"url(#aumGradient)",fillOpacity:1,dot:!1,activeDot:!1,filter:"url(#aumShadow)"}),or.default.createElement(su,{type:"monotone",dataKey:"balance",stroke:"#41B4F7",strokeWidth:2.5,onAnimationEnd:()=>a(!0),dot:u=>{let{cx:p,cy:m,payload:g}=u;return g?i?g.accountCreated?or.default.createElement("g",null,or.default.createElement("line",{x1:p,y1:m-15,x2:p,y2:m+15,stroke:"var(--text-success)",strokeWidth:"2"}),or.default.createElement("circle",{cx:p,cy:m,r:"5",fill:"var(--background-primary)",stroke:"var(--text-success)",strokeWidth:"2"})):g.accountArchived?or.default.createElement("g",null,or.default.createElement("line",{x1:p,y1:m-15,x2:p,y2:m+15,stroke:"var(--text-error)",strokeWidth:"2"}),or.default.createElement("circle",{cx:p,cy:m,r:"5",fill:"var(--background-primary)",stroke:"var(--text-error)",strokeWidth:"2"})):g.isDeposit?or.default.createElement("g",null,or.default.createElement("line",{x1:p,y1:m-15,x2:p,y2:m+15,stroke:"#41B4F7",strokeWidth:"2"}),or.default.createElement("circle",{cx:p,cy:m,r:"5",fill:"var(--background-primary)",stroke:"#41B4F7",strokeWidth:"2"})):g.isWithdrawal?or.default.createElement("g",null,or.default.createElement("line",{x1:p,y1:m-15,x2:p,y2:m+15,stroke:"var(--text-warning, gold)",strokeWidth:"2"}),or.default.createElement("circle",{cx:p,cy:m,r:"5",fill:"var(--background-primary)",stroke:"var(--text-warning, gold)",strokeWidth:"2"})):or.default.createElement("circle",{cx:p,cy:m,r:"3",fill:"var(--text-muted)",stroke:"var(--background-primary)",strokeWidth:"1"}):or.default.createElement("circle",{cx:0,cy:0,r:0,opacity:0}):or.default.createElement("circle",{cx:0,cy:0,r:0,opacity:0})},activeDot:{r:7,stroke:"var(--background-primary)",strokeWidth:1,fill:"#41B4F7",filter:"url(#aumGlow)"},name:"AUM Balance"}))))}});var Uo,Awe,dG=F(()=>{Uo=Y(Q());qt();Er();nr();Awe=({metrics:e})=>{let{currency:t}=ct(),r=Ae(),n=e.totalGrowthAmount>=0?"positive":"negative";return Uo.default.createElement("div",{className:"dashboard-metrics"},Uo.default.createElement("div",{className:"metric-item"},Uo.default.createElement("div",{className:"metric-value"},e.totalAccounts),Uo.default.createElement("div",{className:"metric-label"},"Total Accounts")),Uo.default.createElement("div",{className:"metric-item"},Uo.default.createElement("div",{className:"metric-value"},ye(e.totalAUM,!0,t,!1,void 0)),Uo.default.createElement("div",{className:"metric-label"},"Total AUM")),Uo.default.createElement("div",{className:"metric-item"},Uo.default.createElement("div",{className:`metric-value ${n}`},ye(e.totalGrowthAmount,!0,t,!1,void 0)),Uo.default.createElement("div",{className:"metric-label"},"Total Growth")),Uo.default.createElement("div",{className:"metric-item"},Uo.default.createElement("div",{className:`metric-value ${n}`},so(e.totalGrowthPercent)),Uo.default.createElement("div",{className:"metric-label"},"Growth %")),Uo.default.createElement("div",{className:"metric-item"},Uo.default.createElement("div",{className:"metric-value"},ye(e.totalWithdrawals,!0,t,!1,void 0)),Uo.default.createElement("div",{className:"metric-label"},"Total Withdrawals")),Uo.default.createElement("div",{className:"metric-item"},Uo.default.createElement("div",{className:"metric-value"},e.totalTrades),Uo.default.createElement("div",{className:"metric-label"},"Total Trades")))}});var hr,T7e,C7e,Az,Lz=F(()=>{hr=Y(Q());qt();cg();Ns();Er();nr();T7e=({account:e,onClick:t})=>{var s,l;let{currency:r}=ct(),n=Ae(),i=(l=(s=n==null?void 0:n.settings)==null?void 0:s.trade)==null?void 0:l.displayRMultiples,a=e.metrics.isMultiCurrency&&e.metrics.conversionBaseCurrency?e.metrics.conversionBaseCurrency:r,o=(0,hr.useMemo)(()=>{let c=Exe(e.createdDate),d=e.currentBalance-e.initialBalance,u=e.initialBalance>0?d/e.initialBalance*100:0,p=d>=0?"positive":"negative",m=gO(e),g=m>=100?"complete":"",f=Ixe(e),v=mk(e),h="";v>=75?h="critical":v>=50?h="warning":h="safe";let y=Lxe(e),b=e.drawdownType!=="none"&&(e.drawdownAmount>0||e.drawdownType==="manual"&&e.currentDrawdownSnapshot),k=e.hasProfitTarget&&e.profitTarget>0,x=b?v>=100?"BREACHED":"IN PROGRESS":null,S=k?m>=100?"ACHIEVED":"IN PROGRESS":null;return{accountAge:c,growthAmount:d,growthPercent:u,growthClass:p,profitTargetProgress:m,profitTargetProgressClass:g,drawdownRemaining:f,drawdownUsed:v,drawdownProgressClass:h,totalWithdrawals:y,hasDrawdownSet:b,hasProfitTargetSet:k,drawdownStatus:x,profitTargetStatus:S}},[e.createdDate,e.currentBalance,e.initialBalance,e.profitTarget,e.hasProfitTarget,e.drawdownType,e.drawdownAmount,e.currentDrawdownSnapshot,e.metrics.maxDrawdown,e.transactions]);return hr.default.createElement("div",{className:"account-card",onClick:t},hr.default.createElement("div",{className:"account-card-header"},hr.default.createElement("div",{className:"account-identity"},hr.default.createElement("div",{className:"account-name"},e.name),hr.default.createElement("div",{className:"account-type-badge"},e.accountType)),hr.default.createElement("div",{className:"account-balance"},hr.default.createElement("div",{className:"balance-amount"},ye(e.currentBalance,!0,a,!1,void 0)),hr.default.createElement("div",{className:`balance-growth ${o.growthClass}`},ye(o.growthAmount,!0,a,!1,void 0)," (",so(o.growthPercent),")"))),hr.default.createElement("div",{className:"account-card-body"},hr.default.createElement("div",{className:"key-metrics"},hr.default.createElement("div",{className:"metric-item"},hr.default.createElement("div",{className:"metric-value"},e.metrics.totalTrades),hr.default.createElement("div",{className:"metric-label"},"Trades")),hr.default.createElement("div",{className:"metric-item"},hr.default.createElement("div",{className:"metric-value"},ye(o.totalWithdrawals,!0,a,!1,void 0)),hr.default.createElement("div",{className:"metric-label"},"Withdrawals")),hr.default.createElement("div",{className:"metric-item"},hr.default.createElement("div",{className:"metric-value"},o.accountAge),hr.default.createElement("div",{className:"metric-label"},"Age"))),hr.default.createElement("div",{className:"progress-section"},hr.default.createElement("div",{className:`progress-item ${e.hasProfitTarget&&e.profitTarget>0?"":"not-set"}`},hr.default.createElement("div",{className:"progress-header"},hr.default.createElement("div",{className:"progress-label-with-badge"},hr.default.createElement("span",{className:"progress-label"},"Profit Target"),o.profitTargetStatus&&hr.default.createElement("span",{className:`dashboard-status-badge ${o.profitTargetStatus==="ACHIEVED"?"achieved":"in-progress"}`},o.profitTargetStatus)),hr.default.createElement("div",{className:`progress-value ${e.hasProfitTarget&&e.profitTarget>0?"":"not-set"}`},e.hasProfitTarget&&e.profitTarget>0?so(o.profitTargetProgress):"Not set")),hr.default.createElement("div",{className:"progress-bar-container"},hr.default.createElement("div",{className:`progress-bar ${e.hasProfitTarget&&e.profitTarget>0&&o.profitTargetProgress>0?`profit-target ${o.profitTargetProgressClass}`:"empty"}`,style:{width:e.hasProfitTarget&&e.profitTarget>0?`${o.profitTargetProgress}%`:"0%"}}))),hr.default.createElement("div",{className:`progress-item ${e.drawdownType!=="none"&&e.drawdownAmount>0?"":"not-set"}`},hr.default.createElement("div",{className:"progress-header"},hr.default.createElement("div",{className:"progress-label-with-badge"},hr.default.createElement("span",{className:"progress-label"},"Drawdown Used"),o.drawdownStatus&&hr.default.createElement("span",{className:`dashboard-status-badge ${o.drawdownStatus==="BREACHED"?"breached":"in-progress"}`},o.drawdownStatus)),hr.default.createElement("div",{className:`progress-value ${e.drawdownType!=="none"&&e.drawdownAmount>0?"":"not-set"}`},e.drawdownType!=="none"&&e.drawdownAmount>0?so(o.drawdownUsed):"Not set")),hr.default.createElement("div",{className:"progress-bar-container"},hr.default.createElement("div",{className:`progress-bar ${e.drawdownType!=="none"&&e.drawdownAmount>0&&o.drawdownUsed>0?`drawdown ${o.drawdownProgressClass}`:"empty"}`,style:{width:e.drawdownType!=="none"&&e.drawdownAmount>0?`${o.drawdownUsed}%`:"0%"}})))),hr.default.createElement("div",{className:"account-card-footer"},hr.default.createElement("div",{className:"footer-metric"},hr.default.createElement("span",{className:"footer-label"},"Monthly:"),hr.default.createElement("span",{className:"footer-value"},Mxe(e,a))),hr.default.createElement("div",{className:"footer-metric"},hr.default.createElement("span",{className:"footer-label"},"Total Costs:"),hr.default.createElement("span",{className:"footer-value"},Axe(e,a))))))},C7e=(e,t)=>{var r,n;return e.account.id===t.account.id&&e.account.name===t.account.name&&e.account.accountType===t.account.accountType&&e.account.currentBalance===t.account.currentBalance&&e.account.initialBalance===t.account.initialBalance&&e.account.metrics.totalTrades===t.account.metrics.totalTrades&&e.account.metrics.maxDrawdown===t.account.metrics.maxDrawdown&&e.account.profitTarget===t.account.profitTarget&&e.account.hasProfitTarget===t.account.hasProfitTarget&&e.account.drawdownType===t.account.drawdownType&&e.account.drawdownAmount===t.account.drawdownAmount&&((r=e.account.currentDrawdownSnapshot)==null?void 0:r.drawdownLimit)===((n=t.account.currentDrawdownSnapshot)==null?void 0:n.drawdownLimit)&&e.account.createdDate===t.account.createdDate&&e.account.transactions.length===t.account.transactions.length&&e.account.monthlyCost===t.account.monthlyCost&&e.onClick===t.onClick},Az=hr.default.memo(T7e,C7e)});var bo,uG,Lwe=F(()=>{bo=Y(Q());Lz();uG=bo.default.memo(({accounts:e,openAccount:t,itemHeight:r=140,containerHeight:n=600,overscan:i=3,columns:a,minColumnWidth:o=300})=>{let[s,l]=(0,bo.useState)(0),[c,d]=(0,bo.useState)(0),u=(0,bo.useRef)(null),p=(0,bo.useMemo)(()=>a||(c===0?1:Math.max(1,Math.floor(c/o))),[a,c,o]),m=(0,bo.useMemo)(()=>{let b=[];for(let k=0;k<e.length;k+=p)b.push(e.slice(k,k+p));return b},[e,p]),g=(0,bo.useMemo)(()=>{let b=Math.max(0,Math.floor(s/r)-i),k=Math.ceil(n/r),x=Math.min(m.length,b+k+i*2);return{start:b,end:x}},[s,r,n,m.length,i]),f=(0,bo.useMemo)(()=>m.slice(g.start,g.end),[m,g]),v=(0,bo.useCallback)(()=>{u.current&&requestAnimationFrame(()=>{u.current&&l(u.current.scrollTop)})},[]),h=m.length*r,y=g.start*r;return(0,bo.useEffect)(()=>{let b=u.current;if(!b)return;let k=new ResizeObserver(x=>{for(let S of x){let w=S.contentRect.width;d(w),v()}});return k.observe(b),d(b.clientWidth),()=>{k.disconnect()}},[v]),bo.default.createElement("div",{ref:u,className:"virtualized-account-list",style:{height:n,overflowY:"auto",position:"relative"},onScroll:v},bo.default.createElement("div",{style:{height:h,position:"relative"}},bo.default.createElement("div",{style:{transform:`translateY(${y}px)`,position:"absolute",top:0,left:0,right:0}},f.map((b,k)=>bo.default.createElement("div",{key:g.start+k,className:"account-cards",style:{marginBottom:"15px"}},b.map(x=>bo.default.createElement(Az,{key:x.id,account:x,onClick:()=>t(x.name,x)})))))))},(e,t)=>e.accounts===t.accounts&&e.openAccount===t.openAccount&&e.itemHeight===t.itemHeight&&e.containerHeight===t.containerHeight&&e.overscan===t.overscan&&e.columns===t.columns&&e.minColumnWidth===t.minColumnWidth);uG.displayName="VirtualizedAccountList"});var Ki,P7e,D7e,Nwe,Fwe=F(()=>{Ki=Y(Q());qt();cg();Er();nr();P7e=({type:e,accounts:t,totalAUM:r,isExcludedFromStats:n=!1})=>{let{currency:i}=ct(),a=Ae(),o=(0,Ki.useMemo)(()=>hO(t,r),[t,r]),s=o.totalGrowthAmount>=0?"positive":"negative";return Ki.default.createElement("div",{className:"account-type-header"},Ki.default.createElement("div",{className:"account-type-name"},Ki.default.createElement("h3",null,fO(e))),Ki.default.createElement("div",{className:"account-type-metrics"},Ki.default.createElement("div",{className:"metric-item"},Ki.default.createElement("div",{className:`metric-value ${n?"excluded-status":"weight-percent"}`},n?"Excluded":so(o.aumWeightPercent)),Ki.default.createElement("div",{className:"metric-label"},n?"From Stats":"of Total AUM")),Ki.default.createElement("div",{className:"metric-item"},Ki.default.createElement("div",{className:"metric-value"},ye(o.aumAmount,!0,i,!1,void 0)),Ki.default.createElement("div",{className:"metric-label"},"AUM")),Ki.default.createElement("div",{className:"metric-item"},Ki.default.createElement("div",{className:"metric-value"},ye(o.totalWithdrawals,!0,i,!1,void 0)),Ki.default.createElement("div",{className:"metric-label"},"Withdrawals")),Ki.default.createElement("div",{className:"metric-item"},Ki.default.createElement("div",{className:"metric-value"},o.accountCount),Ki.default.createElement("div",{className:"metric-label"},"Account",o.accountCount!==1?"s":"")),Ki.default.createElement("div",{className:"metric-item"},Ki.default.createElement("div",{className:"metric-value"},o.totalTrades),Ki.default.createElement("div",{className:"metric-label"},"Trade",o.totalTrades!==1?"s":"")),Ki.default.createElement("div",{className:"metric-item"},Ki.default.createElement("div",{className:`metric-value ${s}`},ye(o.totalGrowthAmount,!0,i,!1,void 0)),Ki.default.createElement("div",{className:"metric-label"},"Growth (",so(o.totalGrowthPercent),")"))))},D7e=(e,t)=>e.type===t.type&&e.totalAUM===t.totalAUM&&e.isExcludedFromStats===t.isExcludedFromStats&&e.accounts.length===t.accounts.length&&e.accounts.every((r,n)=>{let i=t.accounts[n];return i&&r.id===i.id&&r.currentBalance===i.currentBalance&&r.initialBalance===i.initialBalance&&r.metrics.totalTrades===i.metrics.totalTrades&&r.transactions.length===i.transactions.length}),Nwe=Ki.default.memo(P7e,D7e)});var kl,E7e,I7e,M7e,Owe,pG=F(()=>{kl=Y(Q());Lz();Lwe();cg();Fwe();Ol();ds();E7e=({type:e,accounts:t,openAccount:r,totalAUM:n=0,excludedTypes:i=[]})=>{let a=(0,kl.useMemo)(()=>[...t].sort((l,c)=>c.currentBalance-l.currentBalance),[t]),o=a.length>50,s=i.includes(e.toLowerCase());return kl.default.createElement("div",{className:"account-section"},kl.default.createElement(Nwe,{type:e,accounts:a,totalAUM:n,isExcludedFromStats:s}),a.length===0?kl.default.createElement("div",{className:"account-section-content"},kl.default.createElement(yi,{message:`No ${fO(e)} accounts`,subMessage:"Create an account to see it here",iconSize:40})):o?kl.default.createElement("div",{className:"account-section-content"},kl.default.createElement(uG,{accounts:a,openAccount:r,containerHeight:600,itemHeight:180,minColumnWidth:300})):kl.default.createElement("div",{className:"account-cards"},a.map(l=>kl.default.createElement(Az,{key:l.id,account:l,onClick:()=>r(l.name,l)}))))},I7e=kl.default.memo(E7e),M7e=({accountsByType:e,openAccount:t,plugin:r,refreshTrigger:n,totalAUM:i=0,excludedTypes:a=[]})=>{var l,c,d;let o=r||((d=(c=(l=window.app)==null?void 0:l.plugins)==null?void 0:c.plugins)==null?void 0:d.journalit),s=(0,kl.useMemo)(()=>{var h,y,b,k;let u=Object.keys(e),p=((y=(h=o==null?void 0:o.settings)==null?void 0:h.account)==null?void 0:y.accountTypeOrder)||["funded","evaluation","demo","archived"],m=((k=(b=o==null?void 0:o.optionsService)==null?void 0:b.getOptions)==null?void 0:k.call(b,"account_type"))||[],g=new Set([...u.map(x=>x.toLowerCase()),...p.map(x=>x.toLowerCase()),...m.map(x=>x.toLowerCase())]),f=new Map;u.forEach(x=>f.set(x.toLowerCase(),x)),p.forEach(x=>{if(!f.has(x.toLowerCase())){let S=x.charAt(0).toUpperCase()+x.slice(1).toLowerCase();f.set(x.toLowerCase(),S)}}),m.forEach(x=>{f.has(x.toLowerCase())||f.set(x.toLowerCase(),x)});let v=[];return p.forEach(x=>{let S=f.get(x.toLowerCase());S&&g.has(x.toLowerCase())&&(v.push(S),g.delete(x.toLowerCase()))}),g.forEach(x=>{let S=f.get(x);S&&v.push(S)}),v},[e,o,n]);return kl.default.createElement("div",{className:"account-sections"},s.map(u=>kl.default.createElement(I7e,{key:u,type:u,accounts:e[u]||[],openAccount:t,totalAUM:i,excludedTypes:a})))},Owe=kl.default.memo(M7e)});function A7e(e){let t=e%Nz.length,r=Nz[t];if(e>=Nz.length){let n=Math.max(.6,1-Math.floor(e/Nz.length)*.2),i=r.replace("#",""),a=parseInt(i.substr(0,2),16),o=parseInt(i.substr(2,2),16),s=parseInt(i.substr(4,2),16);return`rgba(${a}, ${o}, ${s}, ${n})`}return r}function L7e(e){return e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()).join(" ")}function Fz(e,t,r,n,i=[]){if(!e||e.length===0||n===0)return[];let a=[];return r.forEach((o,s)=>{let l=t[o]||[];if(l.length===0||i.includes(o.toLowerCase()))return;let d=hO(l,n);d.aumAmount>0&&a.push({type:o,displayName:L7e(o),aumAmount:d.aumAmount,aumWeightPercent:d.aumWeightPercent,color:A7e(s),accounts:l,metrics:d})}),a}function zwe(e,t=1){let r=e.filter(m=>m.aumWeightPercent>=t),n=e.filter(m=>m.aumWeightPercent<t);if(n.length===0)return{segments:r};let i=n.reduce((m,g)=>m+g.aumAmount,0),a=n.reduce((m,g)=>m+g.aumWeightPercent,0),o=n.reduce((m,g)=>m+g.metrics.accountCount,0),s=n.reduce((m,g)=>m+g.metrics.totalTrades,0),l=n.reduce((m,g)=>m+g.metrics.totalGrowthAmount,0),c=n.reduce((m,g)=>m+g.metrics.totalWithdrawals,0),d=n.reduce((m,g)=>m+g.aumAmount-g.metrics.totalGrowthAmount,0),u=d>0?l/d*100:0,p={type:"other",displayName:"Other",aumAmount:i,aumWeightPercent:a,color:"#94a3b8",accounts:n.flatMap(m=>m.accounts),metrics:{aumAmount:i,aumWeightPercent:a,accountCount:o,totalTrades:s,totalGrowthAmount:l,totalGrowthPercent:u,totalWithdrawals:c}};return{segments:r,otherSegment:p}}var Nz,mG=F(()=>{cg();Nz=["#3b82f6","#7c3aed","#06b6d4","#f59e0b","#8b5cf6","#2563eb","#0ea5e9","#d97706","#6366f1","#ec4899"]});var pp,N7e,fG,Anr,jwe=F(()=>{pp=Y(Q());qt();N7e=({data:e,dotSize:t,showPercentage:r})=>{let n={width:`${t}px`,height:`${t}px`,backgroundColor:e.color,borderRadius:"50%",flexShrink:0,border:"1px solid rgba(0, 0, 0, 0.1)",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.1)"};return pp.default.createElement("div",{className:"account-weight-legend-item"},pp.default.createElement("div",{className:"legend-dot",style:n,"aria-hidden":"true"}),pp.default.createElement("span",{className:"legend-text"},pp.default.createElement("span",{className:"legend-type-name"},e.displayName),r&&pp.default.createElement("span",{className:"legend-percentage"},so(e.aumWeightPercent))))},fG=({weightData:e,className:t="",dotSize:r=12,showPercentages:n=!0,maxItemsPerRow:i=6})=>{if(!e||e.length===0)return null;let a=e,o={display:"flex",flexWrap:"wrap",gap:"8px 16px",alignItems:"center",justifyContent:"flex-start"};return pp.default.createElement("div",{className:`account-weight-legend-container ${t}`},pp.default.createElement("div",{className:"account-weight-legend",style:o,role:"list","aria-label":"Account type distribution legend"},a.map(s=>pp.default.createElement("div",{key:s.type,role:"listitem","aria-label":`${s.displayName}: ${n?so(s.aumWeightPercent):""}`},pp.default.createElement(N7e,{data:s,dotSize:r,showPercentage:n})))))},Anr=pp.default.memo(fG)});var Mm,F7e,gG,znr,_we=F(()=>{Mm=Y(Q());mG();jwe();F7e=({data:e,minimumWidth:t=2})=>{let n={width:`${Math.max(e.aumWeightPercent,t)}%`,backgroundColor:e.color};return Mm.default.createElement("div",{className:"account-weight-segment",style:n,role:"progressbar","aria-valuenow":e.aumWeightPercent,"aria-valuemin":0,"aria-valuemax":100,"aria-label":`${e.displayName}: ${e.aumWeightPercent.toFixed(1)}% of total AUM`})},gG=({accounts:e,accountsByType:t,accountTypesToDisplay:r,totalAUM:n,excludedTypes:i=[],className:a="",showLegend:o=!0,minimumSegmentWidth:s=2})=>{let l=(0,Mm.useMemo)(()=>Fz(e,t,r,n,i),[e,t,r,n,i]),{segments:c}=(0,Mm.useMemo)(()=>zwe(l,0),[l]);return c.length===0?null:Mm.default.createElement("div",{className:`account-weight-bar-container ${a}`},Mm.default.createElement("div",{className:"account-weight-bar",role:"progressbar","aria-label":"Account type AUM distribution"},c.map(d=>Mm.default.createElement(F7e,{key:d.type,data:d,minimumWidth:s}))),o&&Mm.default.createElement(fG,{weightData:l,showPercentages:!0}))},znr=Mm.default.memo(gG)});var qk,hG,Wnr,Bwe=F(()=>{qk=Y(Q());_we();mG();hG=({accounts:e,accountsByType:t,accountTypesToDisplay:r,totalAUM:n,excludedTypes:i=[],className:a="",showLegend:o=!0})=>{let s=(0,qk.useMemo)(()=>Fz(e,t,r,n,i),[e,t,r,n,i]);return!s||s.length===0||n===0?null:qk.default.createElement("div",{className:`account-type-weights ${a}`},qk.default.createElement(gG,{accounts:e,accountsByType:t,accountTypesToDisplay:r,totalAUM:n,excludedTypes:i,showLegend:o}))},Wnr=qk.default.memo(hG)});function Wwe(){if(document.head.querySelector("#account-dashboard-skeleton-styles"))return;let e=document.createElement("style");e.id="account-dashboard-skeleton-styles",e.textContent=O7e,document.head.appendChild(e)}function $we(){var e;(e=document.head.querySelector("#account-dashboard-skeleton-styles"))==null||e.remove()}var O7e,Rwe=F(()=>{O7e=`
.account-dashboard-skeleton {
  width: 100%;
  padding: 1.5rem;
  display: flex;
  flex-direction: column;
  gap: 2rem;
  background: var(--background-primary);
}

.account-dashboard-skeleton-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-bottom: 1rem;
  border-bottom: 1px solid var(--background-modifier-border);
}

.skeleton-header-actions {
  display: flex;
  gap: 0.5rem;
}

.account-dashboard-skeleton-aum,
.account-dashboard-skeleton-weights {
  width: 100%;
}

.account-dashboard-skeleton-metrics {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1rem;
}

.skeleton-metric-card {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  padding: 1rem;
  border-radius: 8px;
  background: var(--background-secondary);
}

.account-dashboard-skeleton-sections {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.skeleton-account-cards {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 1rem;
}

.skeleton-account-card {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
  padding: 1.25rem;
  border-radius: 8px;
  background: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
}

.skeleton-account-card-metrics {
  display: flex;
  gap: 1rem;
  padding-top: 0.5rem;
  border-top: 1px solid var(--background-modifier-border-hover);
}

@media (max-width: 768px) {
  .account-dashboard-skeleton {
    padding: 1rem;
    gap: 1.5rem;
  }

  .account-dashboard-skeleton-metrics {
    grid-template-columns: 1fr;
  }

  .skeleton-account-cards {
    grid-template-columns: 1fr;
  }
}
`});var Ai,vG,Uwe=F(()=>{Ai=Y(Q());ps();SM();fA();Rwe();ff();vG=(0,Ai.memo)(()=>((0,Ai.useLayoutEffect)(()=>(tl(),Wwe(),()=>{$we()}),[]),Ai.default.createElement("div",{className:"account-dashboard-skeleton"},Ai.default.createElement("div",{className:"account-dashboard-skeleton-header"},Ai.default.createElement(Qe,{width:"200px",height:"28px"}),Ai.default.createElement("div",{className:"skeleton-header-actions"},Ai.default.createElement(_l,{size:32}),Ai.default.createElement(_l,{size:32}))),Ai.default.createElement("div",{className:"account-dashboard-skeleton-aum"},Ai.default.createElement(Yp,{type:"chart"})),Ai.default.createElement("div",{className:"account-dashboard-skeleton-metrics"},Array.from({length:4}).map((e,t)=>Ai.default.createElement("div",{key:t,className:"skeleton-metric-card"},Ai.default.createElement(Qe,{width:"100px",height:"14px"}),Ai.default.createElement(Qe,{width:"120px",height:"20px"})))),Ai.default.createElement("div",{className:"account-dashboard-skeleton-weights"},Ai.default.createElement(Yp,{type:"chart"})),Ai.default.createElement("div",{className:"account-dashboard-skeleton-sections"},Ai.default.createElement(Qe,{width:"120px",height:"18px"}),Ai.default.createElement("div",{className:"skeleton-account-cards"},Array.from({length:3}).map((e,t)=>Ai.default.createElement("div",{key:t,className:"skeleton-account-card"},Ai.default.createElement(Qe,{width:"150px",height:"16px"}),Ai.default.createElement(Qe,{width:"100px",height:"24px"}),Ai.default.createElement("div",{className:"skeleton-account-card-metrics"},Ai.default.createElement(Qe,{width:"60px",height:"12px"}),Ai.default.createElement(Qe,{width:"60px",height:"12px"})))))))));vG.displayName="AccountDashboardSkeleton"});var Hwe,Oz,yG=F(()=>{Hwe=Y(Q()),Oz=({ariaLabel:e,className:t="",children:r,...n})=>{let a=["journalit-icon-button",t].filter(Boolean).join(" ");return Hwe.default.createElement("button",{className:a,"aria-label":e,type:"button","data-tooltip":e,...n},r)}});var Yn,qwe,z7e,Vwe,Ec,ug=F(()=>{Yn=Y(Q());qt();Tr();qwe=(0,Yn.createContext)(null),z7e=5e3,Vwe=({app:e,accountPageService:t,accountName:r,plugin:n,children:i})=>{let[a,o]=(0,Yn.useState)(null),[s,l]=(0,Yn.useState)(!1),[c,d]=(0,Yn.useState)(!1),[u,p]=(0,Yn.useState)(null),[m,g]=(0,Yn.useState)(0),[f,v]=(0,Yn.useState)({}),h=(0,Yn.useRef)(!1),y=(0,Yn.useRef)(r),b=(0,Yn.useRef)(r),k=(0,Yn.useRef)(f),x=(0,Yn.useRef)(f);Yn.default.useEffect(()=>{y.current=r,k.current=f},[r,f]);let S=(0,Yn.useCallback)((I,L)=>{var W,N,U,j,R,O,H,q,V,J,K,G,X,te,re,Z,ne;let E=((N=(W=I.dateRange)==null?void 0:W[0])==null?void 0:N.getTime())!==((j=(U=L.dateRange)==null?void 0:U[0])==null?void 0:j.getTime())||((O=(R=I.dateRange)==null?void 0:R[1])==null?void 0:O.getTime())!==((q=(H=L.dateRange)==null?void 0:H[1])==null?void 0:q.getTime()),T=(((V=I.instruments)==null?void 0:V.length)||0)!==(((J=L.instruments)==null?void 0:J.length)||0)||((K=I.instruments)==null?void 0:K.some((se,ee)=>{var ie;return se!==((ie=L.instruments)==null?void 0:ie[ee])})),$=(((G=I.setups)==null?void 0:G.length)||0)!==(((X=L.setups)==null?void 0:X.length)||0)||((te=I.setups)==null?void 0:te.some((se,ee)=>{var ie;return se!==((ie=L.setups)==null?void 0:ie[ee])})),_=(((re=I.directions)==null?void 0:re.length)||0)!==(((Z=L.directions)==null?void 0:Z.length)||0)||((ne=I.directions)==null?void 0:ne.some((se,ee)=>{var ie;return se!==((ie=L.directions)==null?void 0:ie[ee])})),B=I.reviewed!==L.reviewed;return E||T||$||_||B},[]),w=(0,Yn.useCallback)((I=z7e)=>Date.now()-m<I,[m]),C=(0,Yn.useCallback)(async(I=!1)=>{if(h.current)return;let L=b.current!==y.current,E=S(x.current,k.current);if(!(!I&&!L&&!E&&w())){b.current=y.current,x.current=k.current,h.current=!0,l(!0),p(null);try{I&&await t.refreshAccountData(y.current);let T=await t.getAccountPageData(y.current);o(T),g(Date.now()),d(!1)}catch(T){console.error("Error fetching account page data:",T),p(T instanceof Error?T:new Error("Failed to fetch account page data"))}finally{l(!1),d(!1),h.current=!1}}},[t,w,S]),D=(0,Yn.useCallback)(I=>{v(I),S(k.current,I)&&d(!0)},[S]),P=(0,Yn.useCallback)(()=>{if(!(a!=null&&a.trades))return[];let I=a.trades;return f.dateRange&&(f.dateRange[0]||f.dateRange[1])&&(I=I.filter(L=>{let E;try{if(L.entryTime instanceof Date)E=L.entryTime;else if(E=new Date(L.entryTime),isNaN(E.getTime()))return!1}catch(T){return console.error("Error parsing trade entry time:",T,L.entryTime),!1}return!(f.dateRange[0]&&E<f.dateRange[0]||f.dateRange[1]&&E>f.dateRange[1])})),f.instruments&&f.instruments.length>0&&(I=I.filter(L=>f.instruments.includes(L.instrument))),f.setups&&f.setups.length>0&&(I=I.filter(L=>L.setup.some(E=>f.setups.includes(E)))),f.directions&&f.directions.length>0&&(I=I.filter(L=>f.directions.includes(L.direction))),f.reviewed!==void 0&&(I=I.filter(L=>L.reviewed===f.reviewed)),I.sort((L,E)=>{let T=L.entryTime instanceof Date?L.entryTime:new Date(L.entryTime);return(E.entryTime instanceof Date?E.entryTime:new Date(E.entryTime)).getTime()-T.getTime()}),I},[a,f]),M=(0,Yn.useCallback)(()=>{var X,te;if(!a)return null;let I=P();if(I.length===a.trades.length)return a.metrics;if(I.length===0)return{totalTrades:0,winningTrades:0,losingTrades:0,winRate:0,totalPnL:0,avgWin:0,avgLoss:0,avgWinRMultiple:void 0,avgLossRMultiple:void 0,profitFactor:0,totalCommission:0,totalSwap:0,totalFees:0};let L=I.length,E=I.reduce((re,Z)=>re+Z.commission,0),T=I.reduce((re,Z)=>re+Z.swap,0),$=I.reduce((re,Z)=>re+Z.fees,0),_=I.reduce((re,Z)=>{var se;let ne=(se=Z.pnl)!=null?se:0;return re+ne},0),B=I.filter(re=>{var ne;return((ne=re.pnl)!=null?ne:0)>0}),W=I.filter(re=>{var ne;return((ne=re.pnl)!=null?ne:0)<0}),N=L>0?B.length/L*100:0,U=B.reduce((re,Z)=>{var se;let ne=(se=Z.pnl)!=null?se:0;return re+ne},0),j=Math.abs(W.reduce((re,Z)=>{var se;let ne=(se=Z.pnl)!=null?se:0;return re+ne},0)),R=B.length>0?U/B.length:0,O=W.length>0?j/W.length:0,H=(te=(X=n==null?void 0:n.settings)==null?void 0:X.trade)==null?void 0:te.defaultRiskAmount,q=B.map(re=>xt(re.pnl,re.rMultiple,re.riskAmount,H)).filter(re=>re!==void 0),V=q.length>0?q.reduce((re,Z)=>re+Z,0)/q.length:void 0,J=W.map(re=>xt(re.pnl,re.rMultiple,re.riskAmount,H)).filter(re=>re!==void 0),K=J.length>0?J.reduce((re,Z)=>re+Math.abs(Z),0)/J.length:void 0,G=0;return j>0?G=U/j:U>0?G=999:G=0,{totalTrades:L,winningTrades:B.length,losingTrades:W.length,winRate:N,totalPnL:_,avgWin:R,avgLoss:O,avgWinRMultiple:V,avgLossRMultiple:K,profitFactor:G,totalCommission:E,totalSwap:T,totalFees:$}},[a,P,n]),z=(0,Yn.useCallback)(async()=>{setTimeout(async()=>{e.workspace.trigger("layout-change"),await new Promise(I=>setTimeout(I,100)),await C(!0)},600)},[C,e]);Xe("trade:changed",z),Xe("missed-trade:changed",z),Yn.default.useEffect(()=>{let I=b.current!==r,L=S(x.current,f);(I||L)&&d(!0);let E=setTimeout(()=>{C()},100);return()=>clearTimeout(E)},[r,f,C,S]),Yn.default.useEffect(()=>{r&&t&&C()},[r,t,C]);let A=(0,Yn.useMemo)(()=>({accountPageData:a,isLoading:s,isStale:c,error:u,accountName:r,filters:f,refreshData:()=>C(!0),setFilters:D,lastFetchTime:m,isCacheValid:w,getFilteredTrades:P,getMetrics:M}),[a,s,c,u,r,f,C,D,m,w,P,M]);return Yn.default.createElement(qwe.Provider,{value:A},i)},Ec=()=>{let e=(0,Yn.useContext)(qwe);if(!e)throw new Error("useAccountPageData must be used within an AccountPageDataProvider");return e}});var Gwe,Ic,bG=F(()=>{Gwe=Y(Q()),Ic=({label:e,className:t="",children:r,...n})=>{let a=["journalit-no-tooltip-button",t].filter(Boolean).join(" ");return Gwe.default.createElement("button",{className:a,"data-label":e,"aria-label":e,type:"button",...n},r)}});var fv,j7e,dD,Ywe=F(()=>{fv=Y(Q()),j7e=({checked:e,onChange:t,id:r,ariaLabel:n,disabled:i=!1,label:a,className:o=""})=>{let s=g=>{i||t(g.target.checked)},l=r||`checkbox-${Math.random().toString(36).substring(2,9)}`,c={display:"inline-flex",alignItems:"center",gap:"8px",cursor:i?"not-allowed":"pointer",opacity:i?.6:1,userSelect:"none"},d={position:"absolute",opacity:0,width:0,height:0,margin:0,padding:0},u={display:"inline-flex",alignItems:"center",justifyContent:"center",width:"16px",height:"16px",border:"1px solid var(--background-modifier-border)",borderRadius:"3px",backgroundColor:e?"var(--interactive-accent)":"var(--background-primary)",borderColor:e?"var(--interactive-accent)":"var(--background-modifier-border)",transition:"background-color 0.2s ease, border-color 0.2s ease",cursor:i?"not-allowed":"pointer",flexShrink:0},p={display:"flex",alignItems:"center",gap:"8px",cursor:i?"not-allowed":"pointer",fontSize:"13px",fontWeight:500,color:i?"var(--text-muted)":"var(--text-normal)"},m={color:i?"var(--text-muted)":"var(--text-normal)",fontSize:"13px",fontWeight:500};return fv.default.createElement("div",{style:c,className:`jl-checkbox-wrapper ${o}`},fv.default.createElement("input",{type:"checkbox",id:l,style:d,checked:e,onChange:s,"aria-label":n||a,disabled:i}),fv.default.createElement("label",{htmlFor:l,style:p},fv.default.createElement("div",{className:`jl-checkbox ${e?"jl-checkbox-checked":""}`,style:u},e&&fv.default.createElement("svg",{width:"10",height:"8",viewBox:"0 0 10 8",fill:"none",style:{color:"var(--text-on-accent)",display:"block",pointerEvents:"none"}},fv.default.createElement("path",{d:"M8.5 1L3.5 6L1.5 4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))),a&&fv.default.createElement("span",{style:m},a)))},dD=j7e});function B7e(){if(document.getElementById("journalit-folder-browser-styles"))return;let e=document.createElement("style");e.id="journalit-folder-browser-styles",e.textContent=_7e,document.head.appendChild(e)}function Kwe(){document.getElementById("journalit-folder-browser-styles")||B7e()}var _7e,Jwe=F(()=>{_7e=`
/**
 * FolderBrowser component styles
 * Based on ComboBox styling patterns but adapted for folder tree structure
 */

/* Base FolderBrowser container */
.folder-browser-container {
  position: relative;
  width: 100%;
  margin-bottom: 8px;
}

/* Input container */
.folder-browser-container .input-container {
  position: relative;
  width: 100%;
}

/* Add dropdown indicator with CSS pseudo-element */
.folder-browser-container .input-container::after {
  content: "";
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  width: 0;
  height: 0;
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
  border-top: 5px solid var(--text-normal, #333);
  pointer-events: none;
  transition: transform 0.15s ease;
  will-change: transform;
}

/* Rotate caret when dropdown is open */
[data-is-open="true"] .folder-browser-container .input-container::after {
  transform: translateY(-50%) rotate(180deg);
}

/* FolderBrowser input */
.folder-browser-input {
  position: relative;
  z-index: 1;
  width: 100%;
  padding: 8px 12px;
  padding-right: 30px;
  border: 1px solid var(--background-modifier-border, #ddd);
  border-radius: 4px;
  background-color: var(--background-primary, #fff);
  color: var(--text-normal, #333);
  font-size: 14px;
  transition: border-color 0.15s ease;
}

/* Focus state */
.folder-browser-input:focus {
  border-color: var(--interactive-accent, #5183e4);
  box-shadow: 0 0 0 2px rgba(83, 141, 226, 0.3);
  outline: none;
}

/* Dropdown when open */
.folder-browser-dropdown {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  margin-top: -1px;
  z-index: 9999;
  background-color: var(--background-primary, #fff);
  border: 1px solid var(--background-modifier-border, #ddd);
  border-top: none;
  border-radius: 0 0 4px 4px;
  max-height: 200px;
  overflow-y: auto;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
  transition: opacity 0.15s ease, transform 0.15s ease;
  transform-origin: top center;
  will-change: transform, opacity;
  animation: folder-browser-dropdown-open 0.15s ease forwards;
}

@keyframes folder-browser-dropdown-open {
  from {
    opacity: 0;
    transform: translateY(-5px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Folder item in dropdown */
.folder-browser-item {
  padding: 8px 12px;
  cursor: pointer;
  margin: 0;
  background-color: var(--background-primary, #fff);
  color: var(--text-normal, #333);
  font-size: 14px;
  line-height: 1.5;
  border-bottom: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1));
  transition: background-color 0.15s ease;
  display: flex;
  align-items: center;
}

.folder-browser-item.highlighted,
.folder-browser-item:hover {
  background-color: var(--background-secondary, #f5f5f5);
}

/* Folder indentation */
.folder-indent {
  flex-shrink: 0;
}

/* Folder toggle button */
.folder-toggle {
  background: none;
  border: none;
  cursor: pointer;
  padding: 2px;
  margin-right: 4px;
  font-size: 12px;
  color: var(--text-muted, #666);
  transition: color 0.15s ease;
  flex-shrink: 0;
}

.folder-toggle:hover {
  color: var(--text-normal, #333);
}

/* Folder icon */
.folder-icon {
  margin-right: 6px;
  font-size: 14px;
  flex-shrink: 0;
}

/* Folder name */
.folder-name {
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* Error state */
.folder-browser-input.error {
  border-color: var(--text-error, #e53935);
}

/* When dropdown is open, modify input border-radius */
[data-is-open="true"] .folder-browser-input {
  border-bottom-left-radius: 0;
  border-bottom-right-radius: 0;
}
`});var cr,uD,mp,W7e,zz,xG=F(()=>{cr=Y(Q()),uD=require("obsidian");Jwe();mp={FOLDER_BROWSER_CONTAINER:"folder-browser-container",INPUT_CONTAINER:"input-container",INPUT:"folder-browser-input",DROPDOWN:"folder-browser-dropdown",FOLDER_ITEM:"folder-browser-item",FOLDER_ITEM_HIGHLIGHTED:"highlighted",FOLDER_INDENT:"folder-indent",FOLDER_TOGGLE:"folder-toggle",FOLDER_ICON:"folder-icon",FOLDER_NAME:"folder-name",CLEAR_BUTTON:"folder-browser-clear-button"},W7e=e=>({backgroundColor:e?"var(--background-secondary)":"var(--background-primary)"}),zz=({selectedPath:e="",onChange:t,placeholder:r="Select a folder...",label:n,error:i,helperText:a,required:o=!1,app:s})=>{let l=(0,cr.useId)(),c=`folder-browser-${l}`,d=`folder-browser-list-${l}`,u=`helper-${l}`,p=`error-${l}`,[m,g]=(0,cr.useState)(e),[f,v]=(0,cr.useState)(!1),[h,y]=(0,cr.useState)(-1),[b,k]=(0,cr.useState)(new Set),x=(0,cr.useRef)(null),S=(0,cr.useRef)(null),w=(0,cr.useRef)(!1),C=(0,cr.useCallback)(()=>{let W=[],N=R=>{!R.name.startsWith(".")&&R.name.toLowerCase()!=="!journalit"&&(W.push(R),R.children.forEach(O=>{O instanceof uD.TFolder&&N(O)}))};return s.vault.getRoot().children.forEach(R=>{R instanceof uD.TFolder&&N(R)}),W},[s]),D=(0,cr.useCallback)(()=>{let W=C(),N=[],U=(R,O=0)=>{let H=R.path,q=R.children.some(J=>J instanceof uD.TFolder&&!J.name.startsWith(".")&&J.name.toLowerCase()!=="!journalit"),V=b.has(H);N.push({folder:R,path:H,depth:O,isExpanded:V,hasChildren:q}),V&&q&&R.children.filter(J=>J instanceof uD.TFolder&&!J.name.startsWith(".")&&J.name.toLowerCase()!=="!journalit").forEach(J=>{U(J,O+1)})};return W.filter(R=>R.parent===s.vault.getRoot()).sort((R,O)=>R.name.localeCompare(O.name)).forEach(R=>U(R)),N},[C,b,s]),P=(0,cr.useMemo)(()=>D(),[D]),M=(0,cr.useMemo)(()=>{if(!m.trim())return P;let W=m.toLowerCase();return P.filter(N=>N.path.toLowerCase().includes(W)||N.folder.name.toLowerCase().includes(W))},[P,m]),z=(0,cr.useCallback)(W=>{g(W.target.value),v(!0),y(-1)},[]),A=(0,cr.useCallback)(W=>{g(W),t(W),v(!1),y(-1)},[t]),I=(0,cr.useCallback)((W,N)=>{N.preventDefault(),N.stopPropagation(),k(U=>{let j=new Set(U);return j.has(W)?j.delete(W):j.add(W),j})},[]),L=(0,cr.useCallback)(()=>{g(""),t(""),v(!1)},[t]);(0,cr.useEffect)(()=>{let W=N=>{var R,O;let U=N.target,j=(R=U==null?void 0:U.closest)==null?void 0:R.call(U,'[data-folder-item="true"]');if(j&&((O=x.current)!=null&&O.contains(U))){if(U.closest('[data-folder-toggle="true"]'))return;w.current=!0;let q=j.getAttribute("data-folder-path");q&&A(q),setTimeout(()=>{w.current=!1},50)}};return document.addEventListener("mousedown",W,!0),()=>{document.removeEventListener("mousedown",W,!0)}},[A]),(0,cr.useEffect)(()=>{if(!f)return;let W=N=>{var R;let U=N.target;(R=x.current)!=null&&R.contains(U)||v(!1)};return document.addEventListener("mousedown",W,!0),()=>{document.removeEventListener("mousedown",W,!0)}},[f]),(0,cr.useEffect)(()=>{if(!f)return;let W=N=>{N.key==="Escape"&&v(!1)};return document.addEventListener("keydown",W,!0),()=>{document.removeEventListener("keydown",W,!0)}},[f]);let E=(0,cr.useCallback)(W=>{let N=M.length;switch(W.key){case"ArrowDown":W.preventDefault(),v(!0),y(U=>(U+1)%N);break;case"ArrowUp":W.preventDefault(),v(!0),y(U=>(U-1+N)%N);break;case"Enter":if(W.preventDefault(),h>=0&&h<M.length)A(M[h].path);else{let U=m.trim();U!==e&&t(U),v(!1)}break;case"Escape":v(!1);break}},[M,f,h,A,m,e,t]),T=(0,cr.useCallback)(()=>{v(!0)},[]),$=(0,cr.useCallback)(W=>{var N;w.current||(N=x.current)!=null&&N.contains(W.relatedTarget)||setTimeout(()=>{if(!w.current){v(!1),y(-1);let U=m.trim();U!==e&&t(U)}},100)},[m,e,t]),_=(0,cr.useCallback)(W=>{W.preventDefault(),W.stopPropagation(),v(!0),S.current&&S.current.focus()},[]),B=(0,cr.useMemo)(()=>M.map((W,N)=>cr.default.createElement("li",{key:W.path,role:"option","aria-selected":h===N,className:`${mp.FOLDER_ITEM} ${h===N?mp.FOLDER_ITEM_HIGHLIGHTED:""}`,style:W7e(h===N),onMouseEnter:()=>y(N),"data-folder-item":"true","data-folder-path":W.path},cr.default.createElement("div",{style:{display:"flex",alignItems:"center"}},cr.default.createElement("div",{className:mp.FOLDER_INDENT,style:{width:`${W.depth*16}px`}}),W.hasChildren&&cr.default.createElement("button",{type:"button",className:mp.FOLDER_TOGGLE,onClick:U=>I(W.path,U),"data-folder-toggle":"true",style:{background:"none",border:"none",cursor:"pointer",padding:"2px",marginRight:"4px",fontSize:"12px",color:"var(--text-muted)"}},W.isExpanded?"\u25BC":"\u25B6"),cr.default.createElement("span",{className:mp.FOLDER_ICON,style:{marginRight:"6px",fontSize:"14px"}},"\u{1F4C1}"),cr.default.createElement("span",{className:mp.FOLDER_NAME},W.folder.name||"Root")))),[M,h,I]);return(0,cr.useEffect)(()=>{g(e)},[e]),(0,cr.useEffect)(()=>{Kwe()},[]),cr.default.createElement("div",{ref:x,className:mp.FOLDER_BROWSER_CONTAINER,style:{position:"relative",width:"100%",marginBottom:"8px"}},n&&cr.default.createElement("label",{htmlFor:c,style:{display:"block",marginBottom:"4px"}},n,o&&cr.default.createElement("span",{style:{color:"var(--text-error)"}},"*")),cr.default.createElement("div",{className:mp.INPUT_CONTAINER,style:{position:"relative",width:"100%"}},cr.default.createElement("input",{ref:S,id:c,type:"text",value:m,onChange:z,onFocus:T,onBlur:$,onClick:_,onKeyDown:E,placeholder:r,"aria-expanded":f,"aria-autocomplete":"list","aria-controls":f?d:void 0,"aria-activedescendant":h>=0?`folder-${h}`:void 0,"aria-invalid":!!i,"aria-describedby":i?p:a?u:void 0,role:"combobox",className:mp.INPUT,style:{width:"100%",padding:"8px 12px",paddingRight:"30px",border:"1px solid var(--background-modifier-border, #ddd)",borderRadius:"4px",backgroundColor:"var(--background-primary, #fff)",color:"var(--text-normal, #333)",fontSize:"14px"}}),e&&cr.default.createElement("button",{type:"button",className:`${mp.CLEAR_BUTTON} clickable-icon`,onClick:L,"aria-label":"Clear to use default location",style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)",fontSize:"16px"}},"\xD7"),cr.default.createElement("div",{style:{position:"absolute",right:e?"32px":"12px",top:"50%",transform:`translateY(-50%) ${f?"rotate(180deg)":""}`,width:"0",height:"0",borderLeft:"5px solid transparent",borderRight:"5px solid transparent",borderTop:"5px solid var(--text-normal, #333)",pointerEvents:"none",transition:"transform 0.15s ease"}}),f&&M.length>0&&cr.default.createElement("ul",{id:d,role:"listbox",className:mp.DROPDOWN,style:{position:"absolute",top:"100%",left:"0",right:"0",marginTop:"-1px",zIndex:9999,backgroundColor:"var(--background-primary, #fff)",border:"1px solid var(--background-modifier-border, #ddd)",borderTop:"none",borderRadius:"0 0 4px 4px",maxHeight:"200px",overflowY:"auto",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.15)",margin:0,padding:0,listStyle:"none"}},B)),i&&cr.default.createElement("div",{id:p,role:"alert",style:{color:"var(--text-error)",fontSize:"12px",marginTop:"4px"}},i),!i&&a&&cr.default.createElement("div",{id:u,style:{color:"var(--text-muted)",fontSize:"12px",marginTop:"4px"}},a))};zz.displayName="FolderBrowser"});var pg=F(()=>{hi();yG();bG();vI();Ywe();xG()});var Kt,Vk,Qwe,wG,Xwe=F(()=>{Kt=Y(Q()),Vk=require("obsidian");hi();_t();qt();Id();Qwe=function({app:t,snapshots:r,onSave:n}){let[i,a]=(0,Kt.useState)(!1),[o,s]=(0,Kt.useState)([...r].filter(C=>C&&C.date).sort((C,D)=>{let P=ur(C.date),M=ur(D.date);return((M==null?void 0:M.getTime())||0)-((P==null?void 0:P.getTime())||0)})),[l,c]=(0,Kt.useState)(null),[d,u]=(0,Kt.useState)(""),[p,m]=(0,Kt.useState)(""),[g,f]=(0,Kt.useState)(""),[v,h]=(0,Kt.useState)(""),y=()=>{u(""),m(""),f(""),c(null),h("")},b=C=>{let D=o[C],P=D.date instanceof Date?D.date:new Date(D.date),M=P.getFullYear(),z=String(P.getMonth()+1).padStart(2,"0"),A=String(P.getDate()).padStart(2,"0");u(`${M}-${z}-${A}`),m(D.drawdownLimit.toString()),f(D.note||""),c(C),h("")},k=C=>{let D=o[C],P=D.date instanceof Date?D.date:new Date(D.date),M=vn(),z=zt(P,M);new wG(t,z,D.drawdownLimit,()=>{let A=o.filter((I,L)=>L!==C);s(A),n(A),l===C&&y(),new Vk.Notice("Snapshot deleted")}).open()},x=()=>{if(h(""),!d)return h("Date is required"),!1;let C=d.split("-").map(T=>parseInt(T,10));if(C.length!==3||C.some(T=>isNaN(T)))return h("Please enter a valid date"),!1;let D=new Date(C[0],C[1]-1,C[2]);if(D.getFullYear()!==C[0]||D.getMonth()!==C[1]-1||D.getDate()!==C[2])return h("Please enter a valid date"),!1;let P=new Date;if(P.setHours(23,59,59,999),D>P)return h("Date cannot be in the future"),!1;if(!p||p.trim()==="")return h("Drawdown limit is required"),!1;let M=parseFloat(p);if(isNaN(M)||M<=0)return h("Drawdown limit must be a positive number"),!1;let z=D.getFullYear(),A=String(D.getMonth()+1).padStart(2,"0"),I=String(D.getDate()).padStart(2,"0"),L=`${z}-${A}-${I}`;return o.findIndex((T,$)=>{if(l!==null&&$===l)return!1;let _=T.date instanceof Date?T.date:new Date(T.date),B=_.getFullYear(),W=String(_.getMonth()+1).padStart(2,"0"),N=String(_.getDate()).padStart(2,"0");return`${B}-${W}-${N}`===L})!==-1?(h("A snapshot already exists for this date. Please choose a different date or edit the existing one."),!1):!0},S=()=>{if(!x())return;let C=ur(d);if(!C){h("Invalid date format");return}C.setHours(0,0,0,0);let D={date:C,drawdownLimit:parseFloat(p),note:g.trim()||void 0},P;l!==null?(P=[...o],P[l]=D,new Vk.Notice("Snapshot updated")):(P=[...o,D],new Vk.Notice("Snapshot added")),P.sort((M,z)=>{let A=ur(M.date),I=ur(z.date);return((I==null?void 0:I.getTime())||0)-((A==null?void 0:A.getTime())||0)}),s(P),n(P),y()},w=vn();return Kt.default.createElement("div",{className:"manual-drawdown-manager"},o.length>0&&Kt.default.createElement("div",{className:"snapshots-list-section"},Kt.default.createElement("h3",{className:"section-header"},"Recorded Snapshots"),Kt.default.createElement("div",{className:"snapshots-table"},Kt.default.createElement("table",null,Kt.default.createElement("thead",null,Kt.default.createElement("tr",null,Kt.default.createElement("th",null,"Date"),Kt.default.createElement("th",null,"Drawdown Limit"),Kt.default.createElement("th",null,"Note"),Kt.default.createElement("th",null,"Actions"))),Kt.default.createElement("tbody",null,o.map((C,D)=>{let P=C.date instanceof Date?C.date:new Date(C.date),M=l===D;return Kt.default.createElement("tr",{key:D,className:M?"editing":""},Kt.default.createElement("td",null,zt(P,w)),Kt.default.createElement("td",null,"$",C.drawdownLimit.toLocaleString()),Kt.default.createElement("td",{className:"note-cell"},C.note||"\u2014"),Kt.default.createElement("td",{className:"actions-cell"},Kt.default.createElement(Ie,{variant:"secondary",size:"small",onClick:()=>b(D),disabled:i},M?"Editing":"Edit"),Kt.default.createElement(Ie,{variant:"danger",size:"small",onClick:()=>k(D),disabled:i},"Delete")))}))))),Kt.default.createElement("div",{className:"snapshot-form-section"},Kt.default.createElement("h3",{className:"section-header"},l!==null?"Edit Snapshot":"Add New Snapshot"),v&&Kt.default.createElement("div",{className:"validation-error",style:{color:"var(--text-error)",backgroundColor:"var(--background-secondary-alt)",padding:"8px",borderRadius:"4px",marginBottom:"1rem",fontSize:"13px",whiteSpace:"normal"}},v),Kt.default.createElement("div",{className:"setting-item two-column"},Kt.default.createElement("div",{className:"column"},Kt.default.createElement("div",{className:"setting-item-info"},Kt.default.createElement("div",{className:"setting-item-name"},"Drawdown Date *"),Kt.default.createElement("div",{className:"setting-item-description"},"When the broker issued this limit")),Kt.default.createElement("div",{className:"setting-item-control"},Kt.default.createElement("div",{style:{display:"flex",alignItems:"center",position:"relative"}},Kt.default.createElement(Il,{label:"",value:d?new Date(d):void 0,onChange:C=>{if(C instanceof Date){let D=C.getFullYear(),P=String(C.getMonth()+1).padStart(2,"0"),M=String(C.getDate()).padStart(2,"0");u(`${D}-${P}-${M}`)}else u(typeof C=="string"?C.split("T")[0]:"");h("")},includeTime:!1,required:!0,disabled:i,placeholder:w})))),Kt.default.createElement("div",{className:"column"},Kt.default.createElement("div",{className:"setting-item-info"},Kt.default.createElement("div",{className:"setting-item-name"},"Minimum Balance ($) *"),Kt.default.createElement("div",{className:"setting-item-description"},"Lowest balance allowed")),Kt.default.createElement("div",{className:"setting-item-control"},Kt.default.createElement("input",{type:"number",value:p,onChange:C=>{m(C.target.value),h("")},placeholder:"0",min:"0",step:"0.01",disabled:i,style:{width:"100%",padding:"6px 8px",borderRadius:"4px",border:"1px solid var(--background-secondary-alt)",backgroundColor:"var(--background-secondary)",color:"var(--text-normal)"}})))),Kt.default.createElement("div",{className:"setting-item"},Kt.default.createElement("div",{className:"setting-item-info"},Kt.default.createElement("div",{className:"setting-item-name"},"Note (Optional)"),Kt.default.createElement("div",{className:"setting-item-description"},"Additional context for this snapshot")),Kt.default.createElement("div",{className:"setting-item-control"},Kt.default.createElement("input",{type:"text",value:g,onChange:C=>{f(C.target.value)},placeholder:"e.g., End of month statement",disabled:i}))),Kt.default.createElement("div",{className:"form-buttons"},Kt.default.createElement(Ie,{variant:"primary",onClick:S,disabled:i},l!==null?"Update Snapshot":"Add Snapshot"),l!==null&&Kt.default.createElement(Ie,{variant:"secondary",onClick:y,disabled:i},"Cancel Edit"))),Kt.default.createElement("style",null,`
        .save-accent {
          background-color: var(--interactive-accent) !important;
          color: var(--text-on-accent) !important;
          border-color: var(--interactive-accent) !important;
        }

        .manual-drawdown-manager {
          padding: 1rem 0;
          display: flex;
          flex-direction: column;
          gap: 2rem;
        }

        .section-header {
          margin: 0 0 1rem 0;
          font-size: 1.1em;
          font-weight: 600;
          color: var(--text-normal);
        }

        .snapshots-list-section {
          margin-bottom: 1rem;
        }

        .empty-state {
          padding: 2rem;
          text-align: center;
          background: var(--background-secondary);
          border-radius: 8px;
          border: 1px dashed var(--background-modifier-border);
        }

        .empty-state p {
          margin: 0.5rem 0;
          color: var(--text-muted);
        }

        .empty-state p:first-child {
          font-weight: 500;
          color: var(--text-normal);
        }

        .snapshots-table {
          overflow-x: auto;
          border: 1px solid var(--background-modifier-border);
          border-radius: 8px;
        }

        .snapshots-table table {
          width: 100%;
          border-collapse: collapse;
        }

        .snapshots-table th {
          background: var(--background-secondary);
          padding: 0.75rem;
          text-align: left;
          font-weight: 600;
          color: var(--text-normal);
          border-bottom: 2px solid var(--background-modifier-border);
        }

        .snapshots-table td {
          padding: 0.75rem;
          border-bottom: 1px solid var(--background-modifier-border);
          color: var(--text-normal);
        }

        .snapshots-table tbody tr:last-child td {
          border-bottom: none;
        }

        .snapshots-table tbody tr:hover {
          background: var(--background-secondary-alt);
        }

        .snapshots-table tbody tr.editing {
          background: var(--background-modifier-hover);
          outline: 2px solid var(--interactive-accent);
          outline-offset: -2px;
        }

        .note-cell {
          color: var(--text-muted);
          font-style: italic;
          max-width: 200px;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
        }

        .actions-cell {
          display: flex;
          gap: 0.5rem;
        }

        .snapshot-form-section {
          background: var(--background-secondary);
          padding: 1.5rem;
          border-radius: 8px;
        }

        .validation-error {
          padding: 0.75rem;
          margin-bottom: 1rem;
          background: var(--background-modifier-error);
          border: 1px solid var(--text-error);
          border-radius: 6px;
          color: var(--text-error);
          font-weight: 500;
        }

        .setting-item {
          margin-bottom: 1.5rem;
          display: flex;
          align-items: center;
          gap: 1rem;
          white-space: normal;
          word-wrap: break-word;
        }

        .setting-item.two-column {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 1rem;
        }

        .setting-item.two-column .column {
          display: flex;
          flex-direction: column;
        }

        .setting-item.two-column .setting-item-info {
          margin-bottom: 0.5rem;
        }

        .setting-item .setting-item-info {
          flex-shrink: 0;
          width: 180px;
          margin-bottom: 0;
          display: flex;
          flex-direction: column;
          gap: 0.25rem;
        }

        .setting-item .setting-item-control {
          flex: 1;
        }

        /* Higher specificity to override global .edit-account-form .setting-item styles */
        .edit-account-form .manual-drawdown-manager .setting-item {
          display: flex !important;
          flex-direction: row !important;
          gap: 1rem !important;
        }

        .edit-account-form .manual-drawdown-manager .setting-item-control {
          flex: 1;
          min-width: 100px;
        }

        .edit-account-form .manual-drawdown-manager .setting-item-info {
          max-width: 180px;
          flex-shrink: 1;
          min-width: 120px;
        }

        .setting-item-name {
          font-weight: 600;
          color: var(--text-normal);
          margin-bottom: 0;
          white-space: nowrap;
        }

        .setting-item-description {
          font-size: 0.9em;
          color: var(--text-muted);
          display: inline;
        }

        .setting-item-control input {
          width: 100%;
          padding: 0.5rem;
          border: 1px solid var(--background-modifier-border);
          border-radius: 4px;
          background: var(--background-primary);
          color: var(--text-normal);
        }

        .setting-item-control input:focus {
          outline: 2px solid var(--interactive-accent);
          outline-offset: -1px;
        }

        .form-buttons {
          display: flex;
          gap: 0.5rem;
          margin-top: 1rem;
        }

      `))},wG=class extends Vk.Modal{constructor(r,n,i,a){super(r);this.snapshotDate=n;this.drawdownLimit=i;this.onConfirm=a;this.titleEl.setText("Delete Snapshot?")}onOpen(){let{contentEl:r}=this;r.empty();let n=r.createDiv();n.style.cssText="padding: 20px; font-family: var(--default-font);";let i=n.createDiv();i.style.cssText="background: var(--background-secondary); padding: 12px; border-radius: 6px; margin-bottom: 16px;",i.createEl("p",{text:`Delete drawdown snapshot from ${this.snapshotDate}?`}).style.cssText="margin: 0 0 8px 0; color: var(--text-normal); font-size: 14px; line-height: 1.5;",i.createEl("p",{text:`Drawdown limit: ${ye(this.drawdownLimit)}`}).style.cssText="margin: 0; color: var(--text-muted); font-size: 13px;";let a=n.createDiv();a.style.cssText="background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); padding: 12px; border-radius: 6px; margin-bottom: 20px;",a.createEl("p",{text:"This action cannot be undone."}).style.cssText="margin: 0; color: var(--text-normal); font-size: 13px;";let o=n.createDiv();o.style.cssText="display: flex; justify-content: flex-end; gap: 10px; padding-top: 12px; border-top: 1px solid var(--background-modifier-border);";let s=o.createEl("button");s.textContent="Cancel",s.style.cssText="padding: 8px 16px; border: 1px solid var(--background-modifier-border); background: var(--background-primary); color: var(--text-normal); border-radius: 4px; cursor: pointer;",s.addEventListener("click",()=>this.close());let l=o.createEl("button");l.textContent="Delete",l.style.cssText="padding: 8px 20px; border: none; background: #ef4444; color: white; border-radius: 4px; cursor: pointer; font-weight: 500;",l.addEventListener("click",()=>{this.close(),this.onConfirm()})}onClose(){let{contentEl:r}=this;r.empty()}}});function DG(e,t,r,n){new kG({app:e,plugin:t,account:r,onClose:()=>{},onSave:n}).open()}var is,ze,Zwe,kG,$7e,SG,TG,CG,PG,EG=F(()=>{is=require("obsidian"),ze=Y(Q()),Zwe=Y(Ni());Ns();ds();hi();pg();_t();Er();Xwe();qi();Tr();kG=class extends is.Modal{constructor(r){super(r.app);this.root=null;this.titleEl.setText("Edit Account"),this.props=r}onOpen(){let{contentEl:r}=this;r.empty(),this.container=r.createDiv({cls:"edit-account-modal-container"}),this.renderComponent()}onClose(){this.root&&(this.root.unmount(),this.root=null),this.props.onClose()}renderComponent(){this.root=(0,Zwe.createRoot)(this.container),this.root.render(ze.default.createElement(el,null,ze.default.createElement($7e,{...this.props,onModalClose:()=>this.close()})))}},$7e=({app:e,plugin:t,account:r,onSave:n,onModalClose:i})=>{var P;let[a,o]=(0,ze.useState)(!1),[s,l]=(0,ze.useState)([]),[c,d]=(0,ze.useState)(!1),[u,p]=(0,ze.useState)({name:r.name,accountType:r.accountType,initialBalance:r.initialBalance,drawdownType:r.drawdownType,drawdownAmount:r.drawdownAmount,hasProfitTarget:r.hasProfitTarget,profitTarget:r.profitTarget,profitTargetType:r.profitTargetType||"absolute",profitTargetDate:r.profitTargetDate||null,monthlyCost:r.monthlyCost||0,createdDate:r.createdDate}),[m,g]=(0,ze.useState)([]);(0,ze.useEffect)(()=>{(()=>{if(t.optionsService){let z=t.optionsService.getOptions("account_type");l(z),z.length>0&&(z.some(I=>{var L;return I.toLowerCase()===((L=u.accountType)==null?void 0:L.toLowerCase())})||p(I=>({...I,accountType:z[0]})))}})()},[t.optionsService]),Xe("options:changed",()=>{if(t.optionsService){let M=t.optionsService.getOptions("account_type");l(M),M.length>0&&p(z=>M.some(I=>{var L;return I.toLowerCase()===((L=z.accountType)==null?void 0:L.toLowerCase())})?z:{...z,accountType:M[0]})}}),(0,ze.useEffect)(()=>{var M,z;try{let A=(z=(M=t.settings.account)==null?void 0:M.accountMetadata)==null?void 0:z[r.name];if(A!=null&&A.manualDrawdownSnapshots&&Array.isArray(A.manualDrawdownSnapshots)){let I=A.manualDrawdownSnapshots.filter(E=>E!=null).map(E=>{let T=E.date instanceof Date?E.date:dn(E.date);return!T||isNaN(T.getTime())?(console.warn("EditAccountModal: Skipping snapshot with invalid date:",E),null):{...E,date:T}}).filter(E=>E!==null);g(I);let L=A.manualDrawdownSnapshots.length-I.length;L>0&&console.warn(`EditAccountModal: Filtered out ${L} corrupted snapshot(s)`)}}catch(A){console.error("EditAccountModal: Error loading manual drawdown snapshots:",A),g([])}},[r.name,(P=t.settings.account)==null?void 0:P.accountMetadata]);let f=M=>M.split("_").map(z=>z.charAt(0).toUpperCase()+z.slice(1).toLowerCase()).join(" "),v=async()=>{try{if(o(!0),!u.name){new is.Notice("Account name is required");return}if(u.initialBalance<=0){new is.Notice("Initial balance must be greater than 0");return}if(u.drawdownType!=="none"&&u.drawdownAmount<=0){new is.Notice("Drawdown amount must be greater than 0 when drawdown is enabled");return}let M=r.name!==u.name,z=r.initialBalance!==u.initialBalance;if(M&&z){let A=await x(r.name,u.name);await w(r.initialBalance,u.initialBalance)?await h(A):(p(L=>({...L,initialBalance:r.initialBalance})),await y(A,u.name))}else if(M){let A=await x(r.name,u.name);await h(A)}else if(z)if(await w(r.initialBalance,u.initialBalance))await h(!1);else return;else await h(!1)}catch(M){console.error("Error updating account:",M),new is.Notice(`Error updating account: ${M.message}`)}finally{o(!1)}},h=async M=>{await y(M,u.name)},y=async(M,z)=>{try{let A=new Date(r.createdDate),I=new Date(u.createdDate);A.setHours(0,0,0,0),I.setHours(0,0,0,0),A.getTime()!==I.getTime()&&(await S(r.name,A,I)||p(T=>({...T,createdDate:r.createdDate}))),await k(M,z)}catch(A){console.error("Error in performUpdate:",A),new is.Notice(`Error updating account: ${A.message}`)}},b=async M=>{await k(M,u.name)},k=async(M,z)=>{try{let A={name:z,accountType:u.accountType,initialBalance:u.initialBalance,drawdownType:u.drawdownType,drawdownAmount:u.drawdownAmount,hasProfitTarget:u.hasProfitTarget,profitTarget:u.profitTarget,profitTargetType:u.profitTargetType,profitTargetDate:u.profitTargetDate||void 0,monthlyCost:u.monthlyCost,createdDate:u.createdDate};t.accountPageService&&await t.accountPageService.updateAccountMetadata(z,{accountType:A.accountType,initialBalance:A.initialBalance,drawdownType:A.drawdownType,drawdownAmount:A.drawdownAmount,hasProfitTarget:A.hasProfitTarget,profitTarget:A.profitTarget,profitTargetType:A.profitTargetType,profitTargetDate:A.profitTargetDate,monthlyCost:A.monthlyCost,createdDate:A.createdDate,manualDrawdownSnapshots:u.drawdownType==="manual"?m.filter(E=>{let T=E&&E.date instanceof Date&&!isNaN(E.date.getTime());return T||console.warn("EditAccountModal: Filtering out invalid snapshot before save:",E),T}):[]});let I=new Date(r.createdDate).getTime()!==new Date(u.createdDate).getTime(),L=r.initialBalance!==u.initialBalance;(I||L)&&t.accountPageService&&await t.accountPageService.refreshAccountData(z),M&&r.name!==z&&t.optionsService&&await t.optionsService.updateOption("account",r.name,z,!0),n(),M&&r.name!==z?new is.Notice(`Account "${r.name}" updated to "${z}" and all references updated`):new is.Notice(`Account "${z}" updated successfully`),xe.publish("account:changed",{action:"updated",accountId:r.id||z}),t.accountPageService&&(await t.accountPageService.refreshAccountData(z),await t.accountPageService.refreshAllAccountData(),await new Promise(E=>setTimeout(E,50))),i()}catch(A){console.error("Error updating account:",A),new is.Notice(`Error updating account: ${A.message}`)}},x=(M,z)=>new Promise(A=>{let I=`Do you want to update all existing notes that use account "${M}" to use "${z}" instead?

This will search through all notes and update the account reference wherever it's found.`;new SG(e,I,A).open()}),S=(M,z,A)=>new Promise(I=>{new TG(e,M,z,A,I).open()}),w=(M,z)=>new Promise(A=>{new CG(e,t,M,z,A).open()}),C=M=>new Promise(z=>{new PG(e,M,z).open()}),D=async()=>{try{if(o(!0),!await C(r.name))return;t.accountPageService?(await t.accountPageService.deleteAccount(r.name),new is.Notice(`Account "${r.name}" has been deleted successfully`),t.viewManager&&(await t.viewManager.closeAccountPageViews(r.name),setTimeout(async()=>{await t.viewManager.navigateToAccountDashboard()},200)),xe.publish("account:changed",{action:"deleted",accountId:r.id||r.name}),n(),i()):new is.Notice("AccountPageService not available for account deletion")}catch(M){console.error("Error deleting account:",M),new is.Notice(`Error deleting account: ${M.message}`)}finally{o(!1)}};return ze.default.createElement("div",{className:"edit-account-form"},ze.default.createElement("style",null,`
        .manage-snapshots-button {
          padding: 8px 16px;
          background-color: var(--interactive-accent);
          color: white;
          border: none;
          border-radius: 4px;
          cursor: pointer;
          white-space: normal;
          word-wrap: break-word;
          width: auto;
          max-width: 100%;
          display: inline-block;
          min-width: 250px !important;
        }

        .modal-save-accent {
          background-color: var(--interactive-accent) !important;
          color: var(--text-on-accent) !important;
          border-color: var(--interactive-accent) !important;
        }

        .delete-account-danger {
          background-color: #dc3545 !important;
          color: white !important;
          border-color: #dc3545 !important;
        }
      `),ze.default.createElement("div",{className:"setting-item two-column"},ze.default.createElement("div",{className:"column"},ze.default.createElement("div",{className:"setting-item-info"},ze.default.createElement("div",{className:"setting-item-name"},"Account Name"),ze.default.createElement("div",{className:"setting-item-description"},"Name for your account")),ze.default.createElement("div",{className:"setting-item-control"},ze.default.createElement("input",{type:"text",value:u.name,onChange:M=>p({...u,name:M.target.value}),placeholder:"My Trading Account",disabled:a}))),ze.default.createElement("div",{className:"column"},ze.default.createElement("div",{className:"setting-item-info"},ze.default.createElement("div",{className:"setting-item-name"},"Account Type"),ze.default.createElement("div",{className:"setting-item-description"},"Type of trading account")),ze.default.createElement("div",{className:"setting-item-control"},ze.default.createElement("select",{value:u.accountType,onChange:M=>p({...u,accountType:M.target.value}),disabled:a},s.length>0?s.map(M=>ze.default.createElement("option",{key:M,value:M},f(M))):ze.default.createElement(ze.default.Fragment,null,ze.default.createElement("option",{value:"demo"},"Demo"),ze.default.createElement("option",{value:"evaluation"},"Evaluation"),ze.default.createElement("option",{value:"funded"},"Funded")))))),ze.default.createElement("div",{className:"setting-item two-column"},ze.default.createElement("div",{className:"column"},ze.default.createElement("div",{className:"setting-item-info"},ze.default.createElement("div",{className:"setting-item-name"},"Initial Balance"),ze.default.createElement("div",{className:"setting-item-description"},"Starting account balance")),ze.default.createElement("div",{className:"setting-item-control"},ze.default.createElement("input",{type:"number",value:u.initialBalance===0?"":u.initialBalance,onChange:M=>p({...u,initialBalance:M.target.value===""?0:parseFloat(M.target.value)||0}),onFocus:M=>{u.initialBalance===0&&(M.target.value="")},min:"0.01",step:"100",placeholder:"10000",disabled:a}))),ze.default.createElement("div",{className:"column"},ze.default.createElement("div",{className:"setting-item-info"},ze.default.createElement("div",{className:"setting-item-name"},"Creation Date"),ze.default.createElement("div",{className:"setting-item-description"},"When account was created")),ze.default.createElement("div",{className:"setting-item-control"},ze.default.createElement("input",{type:"date",value:(()=>{try{return(u.createdDate instanceof Date?u.createdDate:new Date(u.createdDate)).toISOString().split("T")[0]}catch(M){return console.error("Error formatting date for input:",M),new Date().toISOString().split("T")[0]}})(),onChange:M=>{if(!M.target.value)return;let z=new Date(M.target.value);if(z>new Date){new is.Notice("Creation date cannot be in the future");return}z.setHours(0,0,0,0),p({...u,createdDate:z})},max:new Date().toISOString().split("T")[0],disabled:a})))),ze.default.createElement("div",{className:"setting-item two-column"},ze.default.createElement("div",{className:"column"},ze.default.createElement("div",{className:"setting-item-info"},ze.default.createElement("div",{className:"setting-item-name"},"Drawdown Type"),ze.default.createElement("div",{className:"setting-item-description"},"None | Fixed | EOD Trailing | Manual")),ze.default.createElement("div",{className:"setting-item-control"},ze.default.createElement("select",{value:u.drawdownType,onChange:M=>{let z=M.target.value,A=z!=="none"&&u.drawdownType==="none"?Math.round(r.initialBalance*.1):u.drawdownAmount;p({...u,drawdownType:z,drawdownAmount:z==="none"?0:A})},disabled:a},ze.default.createElement("option",{value:"none"},"None"),ze.default.createElement("option",{value:"fixed"},"Fixed"),ze.default.createElement("option",{value:"eod_trailing"},"EOD Trailing"),ze.default.createElement("option",{value:"manual"},"Manual")))),u.drawdownType!=="none"&&ze.default.createElement("div",{className:"column"},ze.default.createElement("div",{className:"setting-item-info"},ze.default.createElement("div",{className:"setting-item-name"},"Drawdown Amount"),ze.default.createElement("div",{className:"setting-item-description"},"Maximum loss allowed from starting balance")),ze.default.createElement("div",{className:"setting-item-control"},ze.default.createElement("input",{type:"number",value:u.drawdownAmount===0?"":u.drawdownAmount,onChange:M=>p({...u,drawdownAmount:M.target.value===""?0:parseFloat(M.target.value)||0}),onFocus:M=>{u.drawdownAmount===0&&(M.target.value="")},min:"0",step:"100",placeholder:"0",disabled:a})))),u.drawdownType==="manual"&&ze.default.createElement("div",{className:"setting-item",style:{marginTop:"12px",gridColumn:"1 / -1"}},ze.default.createElement("div",{className:"setting-item-info"},ze.default.createElement("div",{className:"setting-item-name"},"Manual Drawdown Snapshots"),ze.default.createElement("div",{className:"setting-item-description"},"Manage historical drawdown limit snapshots from broker statements")),ze.default.createElement("button",{type:"button",onClick:()=>d(!c),className:"manage-snapshots-button"},c?"Hide":"Show"," Snapshot Manager (",m.length," recorded)"),c&&ze.default.createElement(Qwe,{app:e,snapshots:m,onSave:M=>{g(M)}})),ze.default.createElement("div",{className:"setting-item two-column"},ze.default.createElement("div",{className:"column"},ze.default.createElement(dD,{checked:u.hasProfitTarget,onChange:M=>p({...u,hasProfitTarget:M}),disabled:a,label:"Enable Profit Target"}),ze.default.createElement("div",{className:"setting-item-description"},"Set a profit target for account")),ze.default.createElement("div",{className:"column"},ze.default.createElement("div",{className:"setting-item-info"},ze.default.createElement("div",{className:"setting-item-name"},"Monthly Cost"),ze.default.createElement("div",{className:"setting-item-description"},"Subscription fees, platform costs")),ze.default.createElement("div",{className:"setting-item-control"},ze.default.createElement("input",{type:"number",value:u.monthlyCost===0?"":u.monthlyCost,onChange:M=>p({...u,monthlyCost:M.target.value===""?0:parseFloat(M.target.value)||0}),onFocus:M=>{u.monthlyCost===0&&(M.target.value="")},min:"0",step:"1",placeholder:"0",disabled:a})))),u.hasProfitTarget&&ze.default.createElement(ze.default.Fragment,null,ze.default.createElement("div",{className:"setting-item two-column"},ze.default.createElement("div",{className:"column"},ze.default.createElement("div",{className:"setting-item-info"},ze.default.createElement("div",{className:"setting-item-name"},"Target Type"),ze.default.createElement("div",{className:"setting-item-description"},"Absolute or percentage")),ze.default.createElement("div",{className:"setting-item-control"},ze.default.createElement("select",{value:u.profitTargetType,onChange:M=>p({...u,profitTargetType:M.target.value}),disabled:a},ze.default.createElement("option",{value:"absolute"},"Absolute Amount"),ze.default.createElement("option",{value:"percentage"},"Percentage")))),ze.default.createElement("div",{className:"column"},ze.default.createElement("div",{className:"setting-item-info"},ze.default.createElement("div",{className:"setting-item-name"},"Target ",u.profitTargetType==="percentage"?"(%)":"($)"),ze.default.createElement("div",{className:"setting-item-description"},u.profitTargetType==="percentage"?"Percentage":"Dollar amount")),ze.default.createElement("div",{className:"setting-item-control"},ze.default.createElement("input",{type:"number",value:u.profitTarget===0?"":u.profitTarget,onChange:M=>p({...u,profitTarget:M.target.value===""?0:parseFloat(M.target.value)||0}),onFocus:M=>{u.profitTarget===0&&(M.target.value="")},min:"0",step:u.profitTargetType==="percentage"?"1":"100",placeholder:"0",disabled:a})))),ze.default.createElement("div",{className:"setting-item"},ze.default.createElement("div",{className:"setting-item-info"},ze.default.createElement("div",{className:"setting-item-name"},"Target Date (Optional)"),ze.default.createElement("div",{className:"setting-item-description"},"Date to achieve the profit target")),ze.default.createElement("div",{className:"setting-item-control"},ze.default.createElement("input",{type:"date",value:u.profitTargetDate?(()=>{try{return new Date(u.profitTargetDate).toISOString().split("T")[0]}catch(M){return""}})():"",onChange:M=>p({...u,profitTargetDate:M.target.value?new Date(M.target.value):null}),disabled:a})))),ze.default.createElement("div",{className:"edit-account-buttons"},ze.default.createElement(Ie,{variant:"secondary",onClick:D,disabled:a,className:"delete-account-button delete-account-danger"},"Delete Account"),ze.default.createElement("div",{className:"button-group-right"},ze.default.createElement(Ie,{variant:"primary",onClick:v,disabled:a,className:"save-account-button accent-button modal-save-accent"},a?"Saving...":"Save Changes"),ze.default.createElement(Ie,{variant:"secondary",onClick:i,disabled:a,className:"cancel-button"},"Cancel"))))},SG=class extends is.Modal{constructor(r,n,i){super(r);this.message=n;this.onConfirm=i}onOpen(){let{contentEl:r}=this;r.createEl("p",{text:this.message});let n=r.createDiv({cls:"modal-button-container"});n.createEl("button",{type:"button",text:"OK (Update Notes)",cls:"mod-cta"}).addEventListener("click",()=>{this.close(),this.onConfirm(!0)}),n.createEl("button",{type:"button",text:"Save Name Only"}).addEventListener("click",()=>{this.close(),this.onConfirm(!1)}),n.createEl("button",{type:"button",text:"Cancel Action"}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:r}=this;r.empty()}},TG=class extends is.Modal{constructor(r,n,i,a,o){super(r);this.accountName=n;this.oldDate=i;this.newDate=a;this.onConfirm=o;this.titleEl.setText("Change Creation Date")}onOpen(){let{contentEl:r}=this;r.empty();let n=r.createDiv();n.style.cssText="padding: 20px; font-family: var(--default-font);";let i=vn(),a=n.createDiv();a.style.cssText="background: var(--background-secondary); padding: 12px; border-radius: 6px; margin-bottom: 16px;",a.createEl("p",{text:`You are about to change the creation date for account "${this.accountName}" from ${zt(this.oldDate,i)} to ${zt(this.newDate,i)}.`}).style.cssText="margin: 0; color: var(--text-normal); font-size: 14px; line-height: 1.5;";let o=n.createDiv();o.style.cssText="background: rgba(245, 158, 11, 0.1); border: 1px solid rgba(245, 158, 11, 0.3); padding: 12px; border-radius: 6px; margin-bottom: 20px;",o.createEl("p",{text:"This will update the initial deposit transaction date and may affect account age calculations, monthly billing cycles, and other date-based metrics."}).style.cssText="margin: 0; color: var(--text-normal); font-size: 13px; line-height: 1.5;";let s=n.createDiv();s.style.cssText="display: flex; justify-content: flex-end; gap: 10px; padding-top: 12px; border-top: 1px solid var(--background-modifier-border);";let l=s.createEl("button");l.textContent="Cancel",l.style.cssText="padding: 8px 16px; border: 1px solid var(--background-modifier-border); background: var(--background-primary); color: var(--text-normal); border-radius: 4px; cursor: pointer;",l.addEventListener("click",()=>{this.close(),this.onConfirm(!1)});let c=s.createEl("button");c.textContent="Update Creation Date",c.style.cssText="padding: 8px 20px; border: none; background: var(--interactive-accent); color: var(--text-on-accent); border-radius: 4px; cursor: pointer; font-weight: 500;",c.addEventListener("click",()=>{this.close(),this.onConfirm(!0)})}onClose(){let{contentEl:r}=this;r.empty()}},CG=class extends is.Modal{constructor(r,n,i,a,o){super(r);this.plugin=n;this.oldBalance=i;this.newBalance=a;this.onConfirm=o;this.titleEl.setText("Change Initial Balance")}onOpen(){let{contentEl:r}=this;r.empty();let n=r.createDiv();n.style.cssText="padding: 20px; font-family: var(--default-font);";let i=u=>{var m,g,f;let p=((f=(g=(m=this.plugin)==null?void 0:m.settings)==null?void 0:g.general)==null?void 0:f.currency)||"USD";return new Intl.NumberFormat("en-US",{style:"currency",currency:p,minimumFractionDigits:2}).format(u)},a=n.createDiv();a.style.cssText="background: var(--background-secondary); padding: 12px; border-radius: 6px; margin-bottom: 16px;",a.createEl("p",{text:`You are about to change the initial balance from ${i(this.oldBalance)} to ${i(this.newBalance)}.`}).style.cssText="margin: 0; color: var(--text-normal); font-size: 14px; line-height: 1.5;";let o=n.createDiv();o.style.cssText="background: rgba(245, 158, 11, 0.1); border: 1px solid rgba(245, 158, 11, 0.3); padding: 12px; border-radius: 6px; margin-bottom: 16px;",o.createEl("p",{text:"This will affect all balance calculations, P&L percentages, drawdown calculations, and transaction history."}).style.cssText="margin: 0 0 8px 0; color: var(--text-normal); font-size: 13px; line-height: 1.5;",o.createEl("p",{text:"The current balance will be recalculated based on the new initial balance plus all trade P&L."}).style.cssText="margin: 0; color: var(--text-muted); font-size: 13px; line-height: 1.5;";let s=n.createEl("p");s.textContent="This change may significantly impact account metrics and historical data accuracy.",s.style.cssText="margin: 0 0 20px 0; color: var(--text-muted); font-size: 13px; font-style: italic;";let l=n.createDiv();l.style.cssText="display: flex; justify-content: flex-end; gap: 10px; padding-top: 12px; border-top: 1px solid var(--background-modifier-border);";let c=l.createEl("button");c.textContent="Cancel",c.style.cssText="padding: 8px 16px; border: 1px solid var(--background-modifier-border); background: var(--background-primary); color: var(--text-normal); border-radius: 4px; cursor: pointer;",c.addEventListener("click",()=>{this.close(),this.onConfirm(!1)});let d=l.createEl("button");d.textContent="Update Initial Balance",d.style.cssText="padding: 8px 20px; border: none; background: var(--interactive-accent); color: var(--text-on-accent); border-radius: 4px; cursor: pointer; font-weight: 500;",d.addEventListener("click",()=>{this.close(),this.onConfirm(!0)})}onClose(){let{contentEl:r}=this;r.empty()}},PG=class extends is.Modal{constructor(r,n,i){super(r);this.accountName=n;this.onConfirm=i;this.titleEl.setText("Delete Account"),this.titleEl.addClass("modal-title-danger")}onOpen(){let{contentEl:r}=this;r.empty();let n=r.createDiv();n.style.cssText="padding: 20px; font-family: var(--default-font);";let i=n.createEl("p");i.textContent=`Are you sure you want to permanently delete the account "${this.accountName}"?`,i.style.cssText="margin: 0 0 16px 0; color: var(--text-normal); font-size: 14px; line-height: 1.5;";let a=n.createDiv();a.style.cssText="background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); padding: 12px; border-radius: 6px; margin-bottom: 16px;",a.createEl("p",{text:"This action will:"}).style.cssText="margin: 0 0 8px 0; color: var(--text-normal); font-size: 13px; font-weight: 500;";let o=a.createEl("ul");o.style.cssText="margin: 0; padding-left: 20px; color: var(--text-normal); font-size: 13px; line-height: 1.6;",o.createEl("li",{text:"Remove all account metadata and settings"}),o.createEl("li",{text:"Remove account references from all linked trade notes"}),o.createEl("li",{text:"Remove auto-generated account tags from all trades"});let s=n.createEl("p");s.innerHTML="<strong>\u26A0\uFE0F WARNING:</strong> This is a permanent action that cannot be undone!",s.style.cssText="margin: 0 0 20px 0; color: #ef4444; font-size: 13px;";let l=n.createDiv();l.style.cssText="display: flex; justify-content: flex-end; gap: 10px; padding-top: 12px; border-top: 1px solid var(--background-modifier-border);";let c=l.createEl("button");c.textContent="Cancel",c.style.cssText="padding: 8px 16px; border: none; background: var(--interactive-accent); color: var(--text-on-accent); border-radius: 4px; cursor: pointer; font-weight: 500;",c.addEventListener("click",()=>{this.close(),this.onConfirm(!1)});let d=l.createEl("button");d.textContent=`Delete "${this.accountName}"`,d.style.cssText="padding: 8px 20px; border: none; background: #ef4444; color: white; border-radius: 4px; cursor: pointer; font-weight: 500;",d.addEventListener("click",()=>{this.close(),this.onConfirm(!0)})}onClose(){let{contentEl:r}=this;r.empty()}}});function jz(e,t,r,n){new IG({app:e,plugin:t,accountName:r,onClose:()=>{},onSave:n}).open()}var Am,Hr,eke,IG,R7e,MG,AG=F(()=>{Am=require("obsidian"),Hr=Y(Q()),eke=Y(Ni());Ns();hi();_t();Er();IG=class extends Am.Modal{constructor(t){super(t.app),this.titleEl.setText("Add Deposit/Withdrawal"),this.props=t}onOpen(){let{contentEl:t}=this;t.empty(),this.container=t.createDiv({cls:"add-event-modal-container"}),this.renderComponent()}onClose(){this.root&&this.root.unmount(),this.props.onClose()}renderComponent(){this.root=(0,eke.createRoot)(this.container),this.root.render(Hr.default.createElement(el,null,Hr.default.createElement(R7e,{...this.props,onModalClose:()=>this.close()})))}},R7e=({plugin:e,accountName:t,onSave:r,onModalClose:n})=>{let[i,a]=(0,Hr.useState)(!1),{currency:o}=ct(),s=m=>new Intl.NumberFormat("en-US",{style:"currency",currency:o}).format(m),l=()=>new Date().toISOString().split("T")[0],[c,d]=(0,Hr.useState)({type:"deposit",amount:"",date:l(),description:""}),u=async()=>{var m,g;try{if(a(!0),!c.amount||parseFloat(c.amount)<=0){new Am.Notice("Amount must be greater than 0");return}if(!c.date){new Am.Notice("Date is required");return}let f=parseFloat(c.amount);if(!$x(c.date)){new Am.Notice("Invalid date format");return}let v=new Date(c.date),h=new Date;if(h.setHours(23,59,59,999),v>h){new Am.Notice("Transaction date cannot be in the future");return}if(!await p(c,f))return;c.type==="deposit"?await((m=e.accountPageService)==null?void 0:m.addManualDeposit(t,f,v,c.description||void 0)):await((g=e.accountPageService)==null?void 0:g.addManualWithdrawal(t,f,v,c.description||void 0));let b=c.type==="deposit"?"Deposit":"Withdrawal";new Am.Notice(`${b} of ${s(f)} added successfully`),r(),n()}catch(f){console.error("Error adding transaction:",f),new Am.Notice(`Error adding transaction: ${f.message}`)}finally{a(!1)}},p=(m,g)=>new Promise(f=>{new MG(e.app,e,m,g,t,f).open()});return Hr.default.createElement("div",{className:"add-event-form"},Hr.default.createElement("div",{className:"setting-item two-column"},Hr.default.createElement("div",{className:"column"},Hr.default.createElement("div",{className:"setting-item-info"},Hr.default.createElement("div",{className:"setting-item-name"},"Transaction Type"),Hr.default.createElement("div",{className:"setting-item-description"},"Deposit or withdrawal")),Hr.default.createElement("div",{className:"setting-item-control"},Hr.default.createElement("select",{value:c.type,onChange:m=>d({...c,type:m.target.value,description:""}),disabled:i},Hr.default.createElement("option",{value:"deposit"},"Deposit"),Hr.default.createElement("option",{value:"withdrawal"},"Withdrawal")))),Hr.default.createElement("div",{className:"column"},Hr.default.createElement("div",{className:"setting-item-info"},Hr.default.createElement("div",{className:"setting-item-name"},"Amount"),Hr.default.createElement("div",{className:"setting-item-description"},"Amount in ",o)),Hr.default.createElement("div",{className:"setting-item-control"},Hr.default.createElement("input",{type:"number",value:c.amount,onChange:m=>d({...c,amount:m.target.value}),onFocus:m=>{(c.amount==="0"||c.amount==="")&&(m.target.value="")},min:"0.01",step:"0.01",placeholder:"0.00",disabled:i})))),Hr.default.createElement("div",{className:"setting-item two-column"},Hr.default.createElement("div",{className:"column"},Hr.default.createElement("div",{className:"setting-item-info"},Hr.default.createElement("div",{className:"setting-item-name"},"Date"),Hr.default.createElement("div",{className:"setting-item-description"},"Transaction date")),Hr.default.createElement("div",{className:"setting-item-control"},Hr.default.createElement("input",{type:"date",value:c.date,onChange:m=>d({...c,date:m.target.value}),max:l(),disabled:i}))),Hr.default.createElement("div",{className:"column"},Hr.default.createElement("div",{className:"setting-item-info"},Hr.default.createElement("div",{className:"setting-item-name"},"Description (Optional)"),Hr.default.createElement("div",{className:"setting-item-description"},"Additional notes")),Hr.default.createElement("div",{className:"setting-item-control"},Hr.default.createElement("input",{type:"text",value:c.description,onChange:m=>d({...c,description:m.target.value}),placeholder:c.type==="deposit"?"Manual deposit":"Manual withdrawal",disabled:i})))),Hr.default.createElement("div",{className:"add-event-buttons"},Hr.default.createElement("div",{className:"button-group-left"}),Hr.default.createElement("div",{className:"button-group-right"},Hr.default.createElement(Ie,{variant:"primary",onClick:u,disabled:i,className:"add-event-button accent-button",style:{backgroundColor:"var(--interactive-accent)",color:"var(--text-on-accent)",borderColor:"var(--interactive-accent)"}},i?"Adding...":"Add Transaction"),Hr.default.createElement(Ie,{variant:"secondary",onClick:n,disabled:i,className:"cancel-button"},"Cancel"))))},MG=class extends Am.Modal{constructor(r,n,i,a,o,s){super(r);this.plugin=n;this.eventData=i;this.amount=a;this.accountName=o;this.onConfirm=s;this.titleEl.setText("Confirm Transaction")}onOpen(){let{contentEl:r}=this;r.empty();let n=r.createDiv();n.style.cssText="padding: 20px; font-family: var(--default-font);";let i=u=>{var m,g,f;let p=((f=(g=(m=this.plugin)==null?void 0:m.settings)==null?void 0:g.general)==null?void 0:f.currency)||"USD";return new Intl.NumberFormat("en-US",{style:"currency",currency:p,minimumFractionDigits:2}).format(u)},a=this.eventData.type==="deposit"?"deposit":"withdrawal",o=zt(new Date(this.eventData.date),vn()),s=n.createDiv();if(s.style.cssText="background: var(--background-secondary); padding: 12px; border-radius: 6px; margin-bottom: 16px;",s.createEl("p",{text:`Add ${a} of ${i(this.amount)} to account "${this.accountName}" on ${o}?`}).style.cssText="margin: 0; color: var(--text-normal); font-size: 14px; line-height: 1.5;",this.eventData.description){let u=s.createEl("p",{text:`Description: ${this.eventData.description}`});u.style.cssText="margin: 8px 0 0 0; color: var(--text-muted); font-size: 13px;"}let l=n.createDiv();l.style.cssText="display: flex; justify-content: flex-end; gap: 10px; padding-top: 12px; border-top: 1px solid var(--background-modifier-border);";let c=l.createEl("button");c.textContent="Cancel",c.style.cssText="padding: 8px 16px; border: 1px solid var(--background-modifier-border); background: var(--background-primary); color: var(--text-normal); border-radius: 4px; cursor: pointer;",c.addEventListener("click",()=>{this.close(),this.onConfirm(!1)});let d=l.createEl("button");d.textContent="Add Transaction",d.style.cssText="padding: 8px 20px; border: none; background: var(--interactive-accent); color: var(--text-on-accent); border-radius: 4px; cursor: pointer; font-weight: 500;",d.addEventListener("click",()=>{this.close(),this.onConfirm(!0)})}onClose(){let{contentEl:r}=this;r.empty()}}});function U7e(e){if(e.length===0)return null;let t=null;for(let r of e){let n=r.entryTime instanceof Date?r.entryTime:new Date(r.entryTime);isNaN(n.getTime())||(!t||n<t)&&(t=n)}return t}var Sn,LG,NG,tke=F(()=>{Sn=Y(Q());Ot();LG=require("obsidian");ug();nr();hi();EG();AG();Er();qt();NG=()=>{var p,m;let{accountPageData:e,refreshData:t}=Ec(),{currency:r}=ct(),n=Ae(),i=e!=null&&e.metrics.isMultiCurrency&&(e!=null&&e.metrics.conversionBaseCurrency)?e.metrics.conversionBaseCurrency:r,[a,o]=(0,Sn.useState)(!1),s=(0,Sn.useMemo)(()=>{if(!(e!=null&&e.trades)||e.trades.length===0)return null;let g=U7e(e.trades);if(!g)return null;let f=e.account.createdDate instanceof Date?e.account.createdDate:new Date(e.account.createdDate),v=new Date(g);v.setHours(0,0,0,0);let h=new Date(f);if(h.setHours(0,0,0,0),v<h){let y=new Date(v);return y.setDate(y.getDate()-1),{earliestTradeDate:v,suggestedDate:y,tradesBeforeCreation:e.trades.filter(b=>{let k=b.entryTime instanceof Date?b.entryTime:new Date(b.entryTime);if(isNaN(k.getTime()))return!1;let x=new Date(k);return x.setHours(0,0,0,0),x<h}).length}}return null},[e]),l=(0,Sn.useCallback)(async()=>{if(!(!s||!(n!=null&&n.accountPageService)||!e)){o(!0);try{await n.accountPageService.updateAccountMetadata(e.account.name,{createdDate:s.suggestedDate}),new LG.Notice(`Account created date updated to ${s.suggestedDate.toLocaleDateString()}`),await t()}catch(g){console.error("Failed to update account created date:",g),new LG.Notice(`Failed to update date: ${g instanceof Error?g.message:"Unknown error"}`)}finally{o(!1)}}},[s,n,e,t]);if(!e||!n)return null;let{account:c}=e,d=()=>{DG(n.app,n,c,t)},u=()=>{jz(n.app,n,c.name,t)};return Sn.default.createElement("div",{className:"account-page-header"},Sn.default.createElement("div",{className:"account-header-main"},Sn.default.createElement("h2",null,"Account: ",c.name),Sn.default.createElement("div",{className:"header-buttons"},Sn.default.createElement(Ie,{onClick:u,variant:"secondary",size:"sm",className:"add-event-btn clickable-icon","aria-label":"Add Deposit/Withdrawal"},Sn.default.createElement(Ui,{size:16})),Sn.default.createElement(Ie,{onClick:d,variant:"secondary",size:"sm",className:"edit-account-btn clickable-icon","aria-label":"Edit Account"},Sn.default.createElement(So,{size:16})))),Sn.default.createElement("div",{className:"account-info"},Sn.default.createElement("div",{className:"account-info-item"},Sn.default.createElement("span",{className:"info-label"},"Type:"),Sn.default.createElement("span",{className:"info-value"},c.accountType||"N/A")),Sn.default.createElement("div",{className:"account-info-item"},Sn.default.createElement("span",{className:"info-label"},"Initial Balance:"),Sn.default.createElement("span",{className:"info-value"},sa((p=c.initialBalance)!=null?p:0,!1,i))),Sn.default.createElement("div",{className:"account-info-item"},Sn.default.createElement("span",{className:"info-label"},"Current Balance:"),Sn.default.createElement("span",{className:"info-value"},sa((m=c.currentBalance)!=null?m:0,!1,i))),c.accountId&&Sn.default.createElement("div",{className:"account-info-item"},Sn.default.createElement("span",{className:"info-label"},"Account ID:"),Sn.default.createElement("span",{className:"info-value"},c.accountId))),s&&Sn.default.createElement("div",{className:"account-date-warning",style:{display:"flex",alignItems:"center",gap:"12px",padding:"12px 16px",marginTop:"12px",backgroundColor:"rgba(var(--color-red-rgb), 0.15)",borderRadius:"8px",border:"1px solid rgba(var(--color-red-rgb), 0.3)"}},Sn.default.createElement(oa,{size:20,style:{color:"var(--color-red)",flexShrink:0}}),Sn.default.createElement("div",{style:{flex:1}},Sn.default.createElement("div",{style:{color:"var(--text-normal)",fontWeight:600,marginBottom:"4px"}},s.tradesBeforeCreation," trade",s.tradesBeforeCreation===1?"":"s"," found before account creation date"),Sn.default.createElement("div",{style:{color:"var(--text-normal)",fontSize:"0.85em",opacity:.85}},"Earliest trade: ",s.earliestTradeDate.toLocaleDateString(),". This may cause incorrect balance calculations.")),Sn.default.createElement(Ie,{onClick:l,variant:"secondary",size:"sm",disabled:a,"aria-label":"Fix account created date",style:{display:"flex",alignItems:"center",gap:"6px",flexShrink:0,cursor:a?"wait":"pointer"}},Sn.default.createElement(TT,{size:14}),a?"Fixing...":"Fix Date")))}});var Ar,FG,rke=F(()=>{Ar=Y(Q());ug();Er();qt();o0();nr();Dn();FG=()=>{var p,m;let{getMetrics:e,getFilteredTrades:t}=Ec(),{currency:r}=ct(),n=Ae(),i=e(),a=t(),o=(m=(p=n==null?void 0:n.settings)==null?void 0:p.trade)==null?void 0:m.displayRMultiples;if(!i)return null;let s=i.conversionBaseCurrency||r,l=g=>`${g.toFixed(1)}%`,c=g=>sa(g,!1,s),d=g=>g.toFixed(2),u=g=>g>0?"positive":g<0?"negative":"neutral";return Ar.default.createElement("div",{className:"account-metrics"},Ar.default.createElement("div",{className:"metrics-grid"},Ar.default.createElement("div",{className:"metric-card"},Ar.default.createElement("span",{className:"metric-label"},"Total Trades"),Ar.default.createElement("span",{className:"metric-value"},i.totalTrades)),Ar.default.createElement("div",{className:"metric-card"},Ar.default.createElement("span",{className:"metric-label"},"Win Rate"),Ar.default.createElement("span",{className:`metric-value ${u(i.winRate-50)}`},l(i.winRate))),Ar.default.createElement("div",{className:"metric-card"},Ar.default.createElement("span",{className:"metric-label",style:{display:"flex",alignItems:"center",gap:"4px"}},"Total P&L",i.isMultiCurrency&&i.convertedTotalPnL!==void 0&&Ar.default.createElement(pn,{content:Ar.default.createElement("div",{style:{maxWidth:"200px",fontSize:"12px"}},Ar.default.createElement("div",{style:{fontWeight:600,marginBottom:"4px"}},"Converted Total"),Ar.default.createElement("div",null,"Base: ",i.conversionBaseCurrency),Ar.default.createElement("div",null,"Rates: ECB (",i.conversionRateDate,")"),i.unconvertedCurrencies&&i.unconvertedCurrencies.length>0&&Ar.default.createElement("div",{style:{marginTop:"4px",color:"var(--text-warning, #f0a020)"}},"\u26A0 ",i.convertedTradeCount," of ",i.originalTradeCount," trades (",i.originalTradeCount-i.convertedTradeCount," excluded: ",i.unconvertedCurrencies.join(", "),")")),delay:200,preferredPosition:"bottom"},Ar.default.createElement("span",{style:{fontSize:"9px",opacity:.6,cursor:"help"}},"\u24D8"))),Ar.default.createElement("span",{className:`metric-value ${u(i.totalPnL)}`},i.isMultiCurrency&&i.convertedTotalPnL!==void 0?gy(i.convertedTotalPnL,i.conversionBaseCurrency||"USD",!1):i.isMultiCurrency&&i.pnlByCurrency?Object.entries(i.pnlByCurrency).sort(([g],[f])=>g.localeCompare(f)).map(([g,f],v,h)=>Ar.default.createElement(Ar.default.Fragment,{key:g},gy(f,g,!1),v<h.length-1&&Ar.default.createElement("br",null))):c(i.totalPnL))),Ar.default.createElement("div",{className:"metric-card"},Ar.default.createElement("span",{className:"metric-label"},"Profit Factor"),Ar.default.createElement("span",{className:`metric-value ${u(i.profitFactor-1)}`},d(i.profitFactor))),Ar.default.createElement("div",{className:"metric-card"},Ar.default.createElement("span",{className:"metric-label"},"Avg Win"),Ar.default.createElement("span",{className:"metric-value positive"},o&&i.avgWinRMultiple!==void 0?`+${i.avgWinRMultiple.toFixed(1)}R`:c(i.avgWin))),Ar.default.createElement("div",{className:"metric-card"},Ar.default.createElement("span",{className:"metric-label"},"Avg Loss"),Ar.default.createElement("span",{className:"metric-value negative"},o&&i.avgLossRMultiple!==void 0?`-${i.avgLossRMultiple.toFixed(1)}R`:c(Math.abs(i.avgLoss)))),Ar.default.createElement("div",{className:"metric-card"},Ar.default.createElement("span",{className:"metric-label"},"Winning Trades"),Ar.default.createElement("span",{className:"metric-value positive"},i.winningTrades)),Ar.default.createElement("div",{className:"metric-card"},Ar.default.createElement("span",{className:"metric-label"},"Losing Trades"),Ar.default.createElement("span",{className:"metric-value negative"},i.losingTrades)),Ar.default.createElement("div",{className:"metric-card"},Ar.default.createElement("span",{className:"metric-label"},"Total Commission"),Ar.default.createElement("span",{className:"metric-value negative"},c(i.totalCommission))),Ar.default.createElement("div",{className:"metric-card"},Ar.default.createElement("span",{className:"metric-label"},"Total Fees"),Ar.default.createElement("span",{className:"metric-value negative"},c(i.totalFees)))))}});var Wr,H7e,OG,nke=F(()=>{Wr=Y(Q());ug();Ol();nr();qt();_t();Er();H7e=({trade:e})=>{var d,u,p,m,g,f;let{currency:t}=ct(),r=Ae(),n=vn(),i=e.currency||t,a=e.exitTime===null||e.exitTime===void 0,o=(u=(d=r==null?void 0:r.settings)==null?void 0:d.trade)==null?void 0:u.displayRMultiples,s=(m=(p=r==null?void 0:r.settings)==null?void 0:p.trade)==null?void 0:m.defaultRiskAmount,l=async()=>{try{if(!e.path||e.path.trim()===""){console.error("Cannot navigate to trade: No valid file path found",e);return}r&&r.openFile?r.openFile(e.path,!1):r!=null&&r.app?r.app.workspace.openLinkText(e.path,"",!1):console.error("Cannot navigate to trade: Plugin context not available")}catch(v){console.error("Error navigating to trade:",v,{path:e.path,trade:e})}},c=e.path&&e.path.trim()!=="";return Wr.default.createElement("div",{className:`trade-item ${c?"clickable":"no-path"}`,onClick:c?l:void 0,title:c?`Click to open: ${e.path}`:"No file path available - cannot navigate"},Wr.default.createElement("div",{className:"trade-header"},Wr.default.createElement("div",{className:"trade-primary-info"},Wr.default.createElement("span",{className:"trade-instrument"},e.instrument),Wr.default.createElement("span",{className:`trade-direction ${e.assetType==="options"&&e.optionType?e.optionType.toLowerCase():((g=e.direction)!=null?g:"unknown").toLowerCase()}`},e.assetType==="options"&&e.optionType?e.optionType.charAt(0).toUpperCase()+e.optionType.slice(1):(f=e.direction)!=null?f:"Unknown"),!c&&Wr.default.createElement("span",{className:"no-path-indicator",title:"No file path - cannot open"},"\u26A0\uFE0F")),a?Wr.default.createElement("span",{className:"status-open"},"OPEN"):Wr.default.createElement("span",{className:`trade-pnl ${e.pnl>=0?"positive":"negative"}`},ye(e.pnl,!0,i,o,xt(e.pnl,e.rMultiple,e.riskAmount,s)))),Wr.default.createElement("div",{className:"trade-details"},Wr.default.createElement("div",{className:"trade-prices"},Wr.default.createElement("span",{className:"trade-price"},"Entry: ",sa(e.entryPrice,!1,i)),!a&&Wr.default.createElement("span",{className:"trade-price"},"Exit: ",sa(e.exitPrice,!1,i)),Wr.default.createElement("span",{className:"trade-size"},"Size: ",e.positionSize)),Wr.default.createElement("div",{className:"trade-dates"},Wr.default.createElement("span",{className:"trade-date"},"Entry: ",zt(e.entryTime,n)),!a&&Wr.default.createElement("span",{className:"trade-date"},"Exit: ",zt(e.exitTime,n))),e.setup.length>0&&Wr.default.createElement("div",{className:"trade-setups"},Wr.default.createElement("span",{className:"setup-label"},"Setups:"),Wr.default.createElement("div",{className:"setup-tags"},e.setup.map((v,h)=>Wr.default.createElement("span",{key:h,className:"setup-tag"},v)))),e.mistake.length>0&&Wr.default.createElement("div",{className:"trade-mistakes"},Wr.default.createElement("span",{className:"mistake-label"},"Mistakes:"),Wr.default.createElement("div",{className:"mistake-tags"},e.mistake.map((v,h)=>Wr.default.createElement("span",{key:h,className:"mistake-tag"},v)))),e.tags.length>0&&Wr.default.createElement("div",{className:"trade-tags"},Wr.default.createElement("span",{className:"tags-label"},"Tags:"),Wr.default.createElement("div",{className:"tag-list"},e.tags.map((v,h)=>Wr.default.createElement("span",{key:h,className:"trade-tag"},v)))),Wr.default.createElement("div",{className:"trade-meta"},Wr.default.createElement("span",{className:`review-status ${e.reviewed?"reviewed":"not-reviewed"}`},e.reviewed?"Reviewed":"Not Reviewed"),(()=>{let v=Math.max(0,Number(e.commission)||0),h=Math.max(0,Number(e.fees)||0),y=Number(e.swap)||0,b=Math.max(0,Number(e.rebate)||0),x=v+h+y-b;return x>0?Wr.default.createElement("span",{className:"trade-costs"},"Net Costs: ",Uc(x,i)):x<0?Wr.default.createElement("span",{className:"trade-credits"},"Net Credit: ",Uc(Math.abs(x),i)):null})())))},OG=()=>{let{getFilteredTrades:e,accountPageData:t}=Ec(),r=Ae(),n=e();return Wr.default.createElement("div",{className:"account-trades"},Wr.default.createElement("div",{className:"trades-header-centered"},Wr.default.createElement("span",{className:"trades-header-line"}),Wr.default.createElement("h3",{className:"trades-header-title"},"Linked Trades (",n.length,")"),Wr.default.createElement("span",{className:"trades-header-line"})),n.length===0?Wr.default.createElement(yi,{message:"No trades are linked to this account or match the current filters.",subMessage:"Try adjusting your filters or add some trades to this account."}):Wr.default.createElement("div",{className:"trades-list"},n.map((i,a)=>Wr.default.createElement(H7e,{key:`${i.path}-${a}`,trade:i}))))}});var vt,q7e,V7e,ike,ake=F(()=>{vt=Y(Q());qt();_t();Oa();Ll();Ns();Ol();ip();Er();ap();q7e=e=>{if(!e)return"-";if(!e.startsWith("Trade P&L:"))return e;let t=/Trade P&L: .+\/([A-Z0-9]+)-(\d{6})-([^.]+)\.md/,r=e.match(t);if(!r||r.length<4)return e;let[,n,i,a]=r;try{let o="20"+i.substring(0,2),s=i.substring(2,4),l=i.substring(4,6),d=new Date(`${o}-${s}-${l}`).toLocaleDateString("en-US",{month:"short",day:"numeric"});return`${n} ${a} (${d})`}catch(o){return`${n} ${a}`}},V7e=vt.default.memo(({active:e,payload:t,currency:r,displayRMultiples:n,defaultRiskAmount:i})=>{if(!e||!t||t.length===0)return null;let a=t[0].payload;return vt.default.createElement("div",{className:"journalit-chart-tooltip",style:{backgroundColor:"var(--background-primary)",borderRadius:"8px",padding:"12px 16px",minWidth:"180px",border:"1px solid var(--background-modifier-border)",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.2)",transform:"translateY(-4px)",position:"relative"}},vt.default.createElement("div",{className:"journalit-chart-tooltip-date",style:{fontSize:"14px",fontWeight:500,color:"var(--text-normal)",marginBottom:"8px",textAlign:"center"}},a.date),vt.default.createElement("div",{className:"journalit-chart-tooltip-value",style:{fontSize:"18px",fontWeight:600,textAlign:"center",color:"var(--text-normal)"}},"Balance: ",ye(a.balance,!0,r,void 0,void 0)),a.isConsolidated&&vt.default.createElement("div",{style:{marginTop:"8px",padding:"6px 0",borderTop:"1px solid var(--background-modifier-border)",fontSize:"13px"}},a.tradeCount&&a.tradeCount>0&&vt.default.createElement("div",{style:{marginBottom:"4px"}},vt.default.createElement("span",{style:{fontWeight:500}},"Trades:")," ",a.tradeCount),a.dailyPnL!==void 0&&vt.default.createElement("div",{style:{color:a.dailyPnL>=0?"var(--text-success)":"var(--text-error)",fontWeight:500}},"Day P&L: ",ye(a.dailyPnL,!0,r,n,i&&i>0?a.dailyPnL/i:void 0)),a.hasEvents&&a.dayTransactions&&vt.default.createElement("div",{style:{marginTop:"4px"}},a.dayTransactions.filter(o=>o.type==="deposit"||o.type==="withdrawal").filter(o=>!(o.type==="deposit"&&o.description==="Initial deposit")).map((o,s)=>{let l=o.type==="deposit"&&o.amount>0,c=o.type==="withdrawal"||o.type==="deposit"&&o.amount<0;return vt.default.createElement("div",{key:s,style:{fontSize:"12px",marginBottom:"2px",color:l?"#2563eb":c?"#eab308":"var(--text-normal)"}},l&&`\u2022 Deposit: ${ye(o.amount,!0,r,void 0,void 0)}`,c&&`\u2022 Withdrawal: ${ye(Math.abs(o.amount),!0,r,void 0,void 0)}`,o.description&&o.description!=="Manual deposit"&&o.description!=="Manual withdrawal"&&vt.default.createElement("span",{style:{color:"var(--text-muted)",fontStyle:"italic"}}," - "+o.description))}))),a.transaction&&vt.default.createElement("div",{style:{marginTop:"8px",padding:"6px 0",borderTop:"1px solid var(--background-modifier-border)",fontSize:"13px"}},a.isDeposit&&vt.default.createElement("div",{style:{color:"#41B4F7"}},"Deposit: ",ye(a.transaction.amount,!0,r,void 0,void 0)),a.isWithdrawal&&vt.default.createElement("div",{style:{color:"var(--text-warning, gold)"}},"Withdrawal: ",ye(Math.abs(a.transaction.amount),!0,r,void 0,void 0)),a.isTrade&&!a.isConsolidated&&vt.default.createElement("div",{style:{color:a.transaction&&a.transaction.amount>=0?"var(--text-success)":"var(--text-error)"}},q7e(a.transaction.description),": ",ye(a.transaction.amount,!0,r,n,i&&i>0?a.transaction.amount/i:void 0)),a.transaction.description&&!a.isTrade&&vt.default.createElement("div",{style:{marginTop:"4px",fontSize:"12px",color:"var(--text-muted)",fontStyle:"italic"}},a.transaction.description)),a.drawdownLevel!==void 0&&vt.default.createElement("div",{style:{marginTop:"6px",fontSize:"13px",color:"var(--text-error)"}},"Drawdown Level: ",ye(a.drawdownLevel,!0,r,void 0,void 0)))}),ike=({account:e,height:t=250,currencyOverride:r})=>{var C,D,P,M,z,A;let{currency:n}=ct(),i=r||n,[a,o]=(0,vt.useState)(!1);(0,vt.useEffect)(()=>{o(!1)},[e.transactions]);let s=vt.default.useMemo(()=>vn(),[]),l=vt.default.useMemo(()=>window.journalitPlugin,[]),c=(P=(D=(C=l==null?void 0:l.settings)==null?void 0:C.trade)==null?void 0:D.displayRMultiples)!=null?P:!1,d=(A=(z=(M=l==null?void 0:l.settings)==null?void 0:M.trade)==null?void 0:z.defaultRiskAmount)!=null?A:0,u=vt.default.useCallback(I=>`${I.getFullYear()}-${String(I.getMonth()+1).padStart(2,"0")}-${String(I.getDate()).padStart(2,"0")}`,[]),p=vt.default.useMemo(()=>{if(!e.transactions||e.transactions.length===0)return[];let I=[...e.transactions].sort((j,R)=>new Date(j.date).getTime()-new Date(R.date).getTime()),L=e.initialBalance-e.drawdownAmount;if(e.drawdownType==="manual"&&e.allDrawdownSnapshots&&e.allDrawdownSnapshots.length>0){let j=e.allDrawdownSnapshots.filter(R=>R&&R.date).filter(R=>{let O=dn(R.date);return O&&!isNaN(O.getTime())&&O<=e.createdDate}).sort((R,O)=>{let H=dn(R.date),q=dn(O.date);return((q==null?void 0:q.getTime())||0)-((H==null?void 0:H.getTime())||0)})[0];j&&(L=j.drawdownLimit)}let E=[],T=I.filter(j=>(j.type==="deposit"||j.type==="withdrawal")&&!(j.type==="deposit"&&j.description==="Initial deposit"));if(e.createdDate){let j=e.createdDate instanceof Date?e.createdDate:new Date(e.createdDate);if(!isNaN(j.getTime())){let R=j.toISOString().split("T")[0];if(!I.some(H=>(H.date instanceof Date?H.date:new Date(H.date)).toISOString().split("T")[0]===R))E.push({date:zt(j,s),rawDate:j,balance:e.initialBalance,...e.drawdownType!=="none"&&{drawdownLevel:L}});else if(I.some(q=>q.type==="deposit"&&q.description==="Initial deposit")){let q=new Date(j);q.setHours(0,0,0,0),E.push({date:zt(q,s),rawDate:q,balance:e.initialBalance,isInitialBalance:!0,...e.drawdownType!=="none"&&{drawdownLevel:L}})}}}let $=new Map,_=e.initialBalance,B=L;return I.filter(j=>j.type!=="cost").forEach(j=>{let R=new Date(j.date),O=Zt(R,l),H=u(O);$.has(H)||$.set(H,{dayEnd:O,transactions:[],finalBalance:0,tradeCount:0,dailyPnL:0,hasEvents:!1});let q=$.get(H);q.transactions.push(j),q.finalBalance=j.balanceAfter,j.type==="trade"&&(q.tradeCount++,q.dailyPnL+=j.amount),(j.type==="deposit"||j.type==="withdrawal")&&(q.hasEvents=!0),R>q.dayEnd&&(q.dayEnd=R)}),Array.from($.keys()).sort().forEach(j=>{let R=$.get(j),O=new Date(R.dayEnd),H=L;if(e.drawdownType==="eod_trailing"){R.finalBalance>_&&(_=R.finalBalance);let J=Math.min(e.initialBalance,Math.max(_-e.drawdownAmount,B));B=J,H=J}else if(e.drawdownType==="manual"&&e.allDrawdownSnapshots&&e.allDrawdownSnapshots.length>0){let J=R.dayEnd,K=e.allDrawdownSnapshots.filter(G=>G&&G.date).filter(G=>{let X=dn(G.date);return X&&!isNaN(X.getTime())&&X<=J}).sort((G,X)=>{let te=dn(G.date),re=dn(X.date);return((re==null?void 0:re.getTime())||0)-((te==null?void 0:te.getTime())||0)})[0];K&&(H=K.drawdownLimit)}let q=R.transactions.some(J=>J.type==="deposit"&&J.amount>0&&J.description!=="Initial deposit"),V=R.transactions.some(J=>J.type==="withdrawal"||J.type==="deposit"&&J.amount<0);E.push({date:zt(O,s),rawDate:O,balance:R.finalBalance,...e.drawdownType!=="none"&&{drawdownLevel:H},isConsolidated:!0,tradeCount:R.tradeCount,dailyPnL:R.dailyPnL,hasEvents:R.hasEvents,isTrade:R.tradeCount>0,dayTransactions:R.transactions,isDeposit:q,isWithdrawal:V})}),E.sort((j,R)=>j.rawDate.getTime()-R.rawDate.getTime())},[e.transactions,e.initialBalance,e.drawdownType,e.drawdownAmount,s,l,u]);if(p.length===0)return vt.default.createElement("div",{style:{height:`${t}px`,display:"flex",alignItems:"center",justifyContent:"center"}},vt.default.createElement(yi,{message:"No trades found",subMessage:"No trading activity available for this account"}));let m=p.map(I=>I.balance),g=Math.min(...m),f=Math.max(...m);if(e.hasProfitTarget&&e.profitTarget>0){let I=e.profitTargetType==="percentage"?e.initialBalance*e.profitTarget/100:e.profitTarget,L=e.initialBalance+I;f=Math.max(f,L)}let v=p.map(I=>I.drawdownLevel).filter(I=>I!==void 0),h=v.length>0?Math.min(...v):void 0,y=f-Math.min(g,h||g);f=f+y*.05,h!==void 0&&h<g?g=h-y*.15:g=g-y*.1,g>0&&g<f*.05&&(g=0);let b=e.hasProfitTarget&&e.profitTarget>0?e.profitTargetType==="percentage"?e.initialBalance+e.initialBalance*e.profitTarget/100:e.initialBalance+e.profitTarget:void 0,{domain:k,ticks:x}=Al(g,f,6,!1,!1),S=vt.default.useMemo(()=>Md(x,I=>ye(I,!0,i,void 0,void 0)),[x,i]),w=k[0]<=0&&k[1]>=0;return vt.default.createElement(Wo,{height:t,width:"100%",className:"account-balance-chart"},vt.default.createElement(gP,{data:p,margin:{top:10,right:15,left:10,bottom:25}},vt.default.createElement("defs",null,vt.default.createElement("linearGradient",{id:"balanceGradient",x1:"0",y1:"0",x2:"0",y2:"1"},vt.default.createElement("stop",{offset:"0%",stopColor:"#41B4F7",stopOpacity:.4}),vt.default.createElement("stop",{offset:"100%",stopColor:"#41B4F7",stopOpacity:.05})),vt.default.createElement("filter",{id:"balanceShadow",height:"120%"},vt.default.createElement("feDropShadow",{dx:"0",dy:"1",stdDeviation:"2",floodOpacity:"0.1"})),vt.default.createElement("linearGradient",{id:"drawdownGradient",x1:"0",y1:"0",x2:"0",y2:"1"},vt.default.createElement("stop",{offset:"0%",stopColor:"var(--text-error)",stopOpacity:.2}),vt.default.createElement("stop",{offset:"100%",stopColor:"var(--text-error)",stopOpacity:.5}))),vt.default.createElement(zo,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),vt.default.createElement(jo,{dataKey:"date",style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:4,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5}}),vt.default.createElement(_o,{tickFormatter:I=>ye(I,!0,i,void 0,void 0),style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:k,allowDataOverflow:!1,width:S,tickLine:!1,axisLine:!1,tickMargin:5,ticks:x}),vt.default.createElement(ho,{content:vt.default.createElement(V7e,{currency:i,displayRMultiples:c,defaultRiskAmount:d}),cursor:{fill:"var(--interactive-hover)",fillOpacity:.1,strokeOpacity:.3,strokeWidth:1,stroke:"var(--interactive-accent)"},wrapperStyle:{zIndex:1e3},offset:10}),w&&vt.default.createElement(Xa,{y:0,stroke:"var(--text-normal)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1}),vt.default.createElement(Xa,{y:e.initialBalance,stroke:"#888888",strokeOpacity:.7,strokeDasharray:"3 3",strokeWidth:1}),b&&vt.default.createElement(Xa,{y:b,stroke:"var(--text-success, #00b300)",strokeOpacity:1,strokeDasharray:"5 5",strokeWidth:2,className:"profit-target-line",label:{value:"Profit Target",fill:"var(--text-success, #00b300)",fontSize:12,position:"insideTopRight"}}),vt.default.createElement(np,{type:"monotone",dataKey:"balance",stroke:"none",fill:"url(#balanceGradient)",fillOpacity:.95,dot:!1,activeDot:!1,filter:"url(#balanceShadow)"}),e.drawdownType!=="none"&&vt.default.createElement(su,{type:"stepAfter",dataKey:"drawdownLevel",stroke:"var(--text-error)",strokeWidth:2,strokeDasharray:"5 5",dot:!1,activeDot:!1,name:"Drawdown Level"}),e.drawdownType!=="none"&&vt.default.createElement(np,{type:"monotone",dataKey:"drawdownLevel",stroke:"none",fill:"url(#drawdownGradient)",fillOpacity:1}),vt.default.createElement(su,{type:"monotone",dataKey:"balance",stroke:"#41B4F7",strokeWidth:3,onAnimationEnd:()=>o(!0),dot:I=>{let{cx:L,cy:E,payload:T}=I;return T?a?T.isDeposit?vt.default.createElement("g",null,vt.default.createElement("line",{x1:L,y1:E-15,x2:L,y2:E+15,stroke:"#2563eb",strokeWidth:"2"}),vt.default.createElement("circle",{cx:L,cy:E,r:"5",fill:"var(--background-primary)",stroke:"#2563eb",strokeWidth:"2"})):T.isWithdrawal?vt.default.createElement("g",null,vt.default.createElement("line",{x1:L,y1:E-15,x2:L,y2:E+15,stroke:"#eab308",strokeWidth:"2"}),vt.default.createElement("circle",{cx:L,cy:E,r:"5",fill:"var(--background-primary)",stroke:"#eab308",strokeWidth:"2"})):T.isTrade?T.isConsolidated?vt.default.createElement("circle",{cx:L,cy:E,r:"4",fill:T.dailyPnL!==void 0&&T.dailyPnL>=0?"var(--text-success)":"var(--text-error)",stroke:"var(--background-primary)",strokeWidth:"1"}):vt.default.createElement("circle",{cx:L,cy:E,r:"4",fill:T.transaction&&T.transaction.amount>=0?"var(--text-success)":"var(--text-error)",stroke:"var(--background-primary)",strokeWidth:"1"}):vt.default.createElement("circle",{cx:L,cy:E,r:"3",fill:"var(--text-muted)",stroke:"var(--background-primary)",strokeWidth:"1"}):vt.default.createElement("circle",{cx:0,cy:0,r:0,opacity:0}):vt.default.createElement("circle",{cx:0,cy:0,r:0,opacity:0})},activeDot:I=>{let{cx:L,cy:E,payload:T}=I;if(!T)return vt.default.createElement("circle",{cx:0,cy:0,r:0,opacity:0});if(T.isDeposit)return vt.default.createElement("g",null,vt.default.createElement("line",{x1:L,y1:E-18,x2:L,y2:E+18,stroke:"#2563eb",strokeWidth:"3"}),vt.default.createElement("circle",{cx:L,cy:E,r:"7",fill:"var(--background-primary)",stroke:"#2563eb",strokeWidth:"2"}));if(T.isWithdrawal)return vt.default.createElement("g",null,vt.default.createElement("line",{x1:L,y1:E-18,x2:L,y2:E+18,stroke:"#eab308",strokeWidth:"3"}),vt.default.createElement("circle",{cx:L,cy:E,r:"7",fill:"var(--background-primary)",stroke:"#eab308",strokeWidth:"2"}));let $="#41B4F7";return T.isTrade&&(T.isConsolidated?$=T.dailyPnL!==void 0&&T.dailyPnL>=0?"var(--text-success)":"var(--text-error)":T.transaction&&($=T.transaction.amount>=0?"var(--text-success)":"var(--text-error)")),vt.default.createElement("circle",{cx:L,cy:E,r:"6",fill:$,stroke:"var(--background-primary)",strokeWidth:"2"})},name:"Balance"})))}});var gv,zG,oke=F(()=>{gv=Y(Q());ug();ake();nr();zG=()=>{let{accountPageData:e,isLoading:t}=Ec(),r=Ae();if(t||!e)return gv.default.createElement("div",{className:"account-balance-section"},gv.default.createElement("h3",null,"Account Balance Chart"),gv.default.createElement("div",{className:"balance-chart-loading"},gv.default.createElement("p",null,"Loading balance chart...")));let n=e.metrics.isMultiCurrency?e.metrics.conversionBaseCurrency:void 0;return gv.default.createElement("div",{className:"account-balance-section"},gv.default.createElement("div",{className:"balance-chart-container"},gv.default.createElement(ike,{account:e.account,height:400,currencyOverride:n})))}});var At,jG,ske=F(()=>{At=Y(Q());ug();cg();Ns();qt();_t();Er();nr();jG=()=>{var g,f,v,h,y;let{accountPageData:e,isLoading:t}=Ec(),{currency:r}=ct(),n=Ae(),i=e!=null&&e.metrics.isMultiCurrency&&(e!=null&&e.metrics.conversionBaseCurrency)?e.metrics.conversionBaseCurrency:r;if(t||!e)return At.default.createElement("div",{className:"account-risk-metrics-section"},At.default.createElement("div",{className:"risk-metrics-loading"},At.default.createElement("p",null,"Loading risk metrics...")));let{account:a}=e,o=(f=(g=n==null?void 0:n.settings)==null?void 0:g.trade)==null?void 0:f.displayRMultiples,s=(y=(h=(v=n==null?void 0:n.settings)==null?void 0:v.trade)==null?void 0:h.defaultRiskAmount)!=null?y:0,l=mk(a),c=gO(a),d=a.drawdownType!=="none"&&(a.drawdownAmount>0||a.drawdownType==="manual"&&a.currentDrawdownSnapshot),u=a.hasProfitTarget&&a.profitTarget>0,p=d?l>=100?"BREACHED":"IN PROGRESS":null,m=u?c>=100?"ACHIEVED":"IN PROGRESS":null;return At.default.createElement("div",{className:"account-risk-metrics-section"},At.default.createElement("div",{className:"section-header-centered"},At.default.createElement("span",{className:"section-header-line"}),At.default.createElement("h3",{className:"section-header-title"},"Risk Management"),At.default.createElement("span",{className:"section-header-line"})),At.default.createElement("div",{className:"risk-metrics-container"},At.default.createElement("div",{className:`risk-metric-box ${d?"":"not-set"}`},At.default.createElement("div",{className:"risk-metric-header"},At.default.createElement("div",{className:"header-left"},At.default.createElement("div",{className:"title-with-badge"},At.default.createElement("h4",{className:"risk-metric-title"},"Drawdown Used"),p&&At.default.createElement("span",{className:`risk-status-badge ${p==="BREACHED"?"breached":"in-progress"}`},p))),At.default.createElement("div",{className:`risk-metric-percentage ${d?"":"not-set"}`},d?so(l):"Not set")),d&&At.default.createElement("div",{className:"horizontal-bar-container"},At.default.createElement("div",{className:"horizontal-bar-track"},At.default.createElement("div",{className:`horizontal-bar-fill ${l>=75?"critical":l>=50?"warning":"safe"}`,style:{width:`${Math.min(100,l)}%`,transition:"width 0.8s cubic-bezier(0.4, 0, 0.2, 1)"}}))),At.default.createElement("div",{className:"risk-metric-details"},d?At.default.createElement(At.default.Fragment,null,(()=>{let b,k,x;return a.drawdownType==="manual"&&a.currentDrawdownSnapshot?(x=a.drawdownAmount,k=a.currentBalance-a.currentDrawdownSnapshot.drawdownLimit,b=a.drawdownAmount-k):(x=a.drawdownAmount,b=a.initialBalance-a.currentBalance,k=x-b),b=Math.max(0,Math.min(x,b)),k=Math.max(0,Math.min(x,k)),At.default.createElement(At.default.Fragment,null,At.default.createElement("div",{className:"detail-row"},At.default.createElement("span",{className:"detail-label"},"Used:"),At.default.createElement("span",{className:"detail-value"},ye(b,!0,i,o,s>0?b/s:void 0))),At.default.createElement("div",{className:"detail-row"},At.default.createElement("span",{className:"detail-label"},"Limit:"),At.default.createElement("span",{className:"detail-value"},ye(x,!0,i,o,s>0?x/s:void 0))),At.default.createElement("div",{className:"detail-row"},At.default.createElement("span",{className:"detail-label"},"Remaining:"),At.default.createElement("span",{className:"detail-value"},ye(k,!0,i,o,s>0?k/s:void 0))))})()):At.default.createElement("div",{className:"detail-row"},At.default.createElement("span",{className:"detail-value no-limit"},"No drawdown limit set")))),At.default.createElement("div",{className:`risk-metric-box ${u?"":"not-set"}`},At.default.createElement("div",{className:"risk-metric-header"},At.default.createElement("div",{className:"header-left"},At.default.createElement("div",{className:"title-with-badge"},At.default.createElement("h4",{className:"risk-metric-title"},"Profit Target"),m&&At.default.createElement("span",{className:`risk-status-badge ${m==="ACHIEVED"?"achieved":"in-progress"}`},m))),At.default.createElement("div",{className:`risk-metric-percentage ${u?"":"not-set"}`},u?so(c):"Not set")),u&&At.default.createElement("div",{className:"horizontal-bar-container"},At.default.createElement("div",{className:"horizontal-bar-track"},At.default.createElement("div",{className:`horizontal-bar-fill ${c>=100?"complete":"progress"}`,style:{width:`${Math.min(100,c)}%`,transition:"width 0.8s cubic-bezier(0.4, 0, 0.2, 1)"}}))),At.default.createElement("div",{className:"risk-metric-details"},u?At.default.createElement(At.default.Fragment,null,At.default.createElement("div",{className:"detail-row"},At.default.createElement("span",{className:"detail-label"},"Progress:"),At.default.createElement("span",{className:"detail-value"},ye(a.metrics.totalPnL,!0,i,o,s>0?a.metrics.totalPnL/s:void 0))),At.default.createElement("div",{className:"detail-row"},At.default.createElement("span",{className:"detail-label"},"Target:"),At.default.createElement("span",{className:"detail-value"},(()=>{let b=a.profitTargetType==="percentage"?a.initialBalance*a.profitTarget/100:a.profitTarget;return ye(b,!0,i,o,s>0?b/s:void 0)})())),At.default.createElement("div",{className:"detail-row"},At.default.createElement("span",{className:"detail-label"},"Remaining:"),At.default.createElement("span",{className:"detail-value"},(()=>{let k=(a.profitTargetType==="percentage"?a.initialBalance*a.profitTarget/100:a.profitTarget)-a.metrics.totalPnL;return ye(k,!0,i,o,s>0?k/s:void 0)})())),a.profitTargetDate&&At.default.createElement("div",{className:"detail-row"},At.default.createElement("span",{className:"detail-label"},"Target Date:"),At.default.createElement("span",{className:"detail-value"},zt(new Date(a.profitTargetDate))))):At.default.createElement("div",{className:"detail-row"},At.default.createElement("span",{className:"detail-value no-target"},"No profit target set"))))))}});function BG(e,t,r){new _G({app:e,plugin:t,onClose:()=>{},onSave:r}).open()}var ks,He,lke,_G,G7e,cke=F(()=>{ks=require("obsidian"),He=Y(Q()),lke=Y(Ni());Ns();ds();hi();pg();rl();_t();qi();Op();_G=class extends ks.Modal{constructor(t){super(t.app),this.titleEl.setText("Create New Account"),this.props=t}onOpen(){let{contentEl:t}=this;t.empty(),lh(),this.container=t.createDiv({cls:"create-account-modal-container"}),this.renderComponent()}onClose(){this.root&&this.root.unmount(),this.props.onClose()}renderComponent(){this.root=(0,lke.createRoot)(this.container),this.root.render(He.default.createElement(G7e,{...this.props,onModalClose:()=>this.close()}))}},G7e=({app:e,plugin:t,onSave:r,onModalClose:n})=>{let[i,a]=(0,He.useState)(!1),[o,s]=(0,He.useState)([]),[l,c]=(0,He.useState)(null),[d,u]=(0,He.useState)({name:"",accountType:"demo",createdDate:To(new Date),initialBalance:0,drawdownType:"none",drawdownAmount:0,hasProfitTarget:!1,profitTarget:0,profitTargetType:"absolute",profitTargetDate:null,monthlyCost:0});(0,He.useEffect)(()=>{(()=>{if(t.optionsService){let v=t.optionsService.getOptions("account_type");s(v),v.length>0&&(v.some(y=>y.toLowerCase()===d.accountType.toLowerCase())||u(y=>({...y,accountType:v[0]})))}})()},[t.optionsService]),Xe("options:changed",()=>{if(t.optionsService){let f=t.optionsService.getOptions("account_type");s(f),f.length>0&&u(v=>f.some(y=>y.toLowerCase()===v.accountType.toLowerCase())?v:{...v,accountType:f[0]})}});let p=f=>f.split("_").map(v=>v.charAt(0).toUpperCase()+v.slice(1).toLowerCase()).join(" "),m=async f=>{if(!t.accountPageService)return!1;try{return(await t.accountPageService.getAllEnhancedAccounts()).some(h=>h.name.toLowerCase().trim()===f.toLowerCase().trim())}catch(v){return console.error("Error checking account name uniqueness:",v),!1}},g=async()=>{try{if(a(!0),!d.name||!d.name.trim()){new ks.Notice("Account name is required");return}let f=d.name.trim();if(await m(f)){new ks.Notice(`Account name "${f}" already exists. Please choose a different name.`);return}if(d.initialBalance<0){new ks.Notice("Initial balance cannot be negative");return}if(d.drawdownType!=="none"&&d.drawdownAmount<=0){new ks.Notice("Drawdown amount must be greater than 0 when drawdown is enabled");return}if(d.hasProfitTarget&&d.profitTarget<=0){new ks.Notice("Profit target amount must be greater than 0 when profit target is enabled");return}let h=ur(d.createdDate);if(!h){new ks.Notice("Invalid creation date");return}let y=new Date;if(y.setHours(0,0,0,0),h>y){new ks.Notice("Creation date cannot be in the future");return}if(d.monthlyCost<0){new ks.Notice("Monthly cost cannot be negative");return}if(!t.accountPageService){new ks.Notice("AccountPageService not available for account creation");return}if(h.setHours(0,0,0,0),d.hasProfitTarget&&l){new ks.Notice("Please fix the profit target date error before creating the account");return}if(d.hasProfitTarget&&d.profitTargetDate&&!$x(d.profitTargetDate)){new ks.Notice("Invalid profit target date");return}await t.accountPageService.updateAccountMetadata(f,{name:f,accountType:d.accountType,createdDate:h,initialBalance:d.initialBalance,drawdownType:d.drawdownType,drawdownAmount:d.drawdownAmount,hasProfitTarget:d.hasProfitTarget,profitTarget:d.profitTarget,profitTargetType:d.profitTargetType,profitTargetDate:d.hasProfitTarget&&d.profitTargetDate||void 0,monthlyCost:d.monthlyCost,lastUpdated:new Date}),new ks.Notice(`Account "${f}" created successfully`),xe.publish("account:changed",{action:"created",accountId:f}),t.accountPageService&&await t.accountPageService.refreshAllAccountData(),r(),n(),t.viewManager&&setTimeout(()=>{t.viewManager.openAccountPageView(f)},150)}catch(f){console.error("Error creating account:",f),new ks.Notice(`Error creating account: ${f.message}`)}finally{a(!1)}};return He.default.createElement("div",{className:"create-account-form"},He.default.createElement("div",{className:"setting-item two-column"},He.default.createElement("div",{className:"column"},He.default.createElement("div",{className:"setting-item-info"},He.default.createElement("div",{className:"setting-item-name"},"Account Name"),He.default.createElement("div",{className:"setting-item-description"},"Name for your new account")),He.default.createElement("div",{className:"setting-item-control"},He.default.createElement("input",{type:"text",value:d.name,onChange:f=>u({...d,name:f.target.value}),placeholder:"My Trading Account",disabled:i}))),He.default.createElement("div",{className:"column"},He.default.createElement("div",{className:"setting-item-info"},He.default.createElement("div",{className:"setting-item-name"},"Account Type"),He.default.createElement("div",{className:"setting-item-description"},"Type of trading account")),He.default.createElement("div",{className:"setting-item-control"},He.default.createElement("select",{value:d.accountType,onChange:f=>u({...d,accountType:f.target.value}),disabled:i},o.length>0?o.map(f=>He.default.createElement("option",{key:f,value:f},p(f))):He.default.createElement(He.default.Fragment,null,He.default.createElement("option",{value:"demo"},"Demo"),He.default.createElement("option",{value:"evaluation"},"Evaluation"),He.default.createElement("option",{value:"funded"},"Funded")))))),He.default.createElement("div",{className:"setting-item two-column"},He.default.createElement("div",{className:"column"},He.default.createElement("div",{className:"setting-item-info"},He.default.createElement("div",{className:"setting-item-name"},"Initial Balance"),He.default.createElement("div",{className:"setting-item-description"},"Starting account balance (optional, defaults to 0)")),He.default.createElement("div",{className:"setting-item-control"},He.default.createElement("input",{type:"number",value:d.initialBalance===0?"":d.initialBalance,onChange:f=>u({...d,initialBalance:f.target.value===""?0:parseFloat(f.target.value)||0}),onFocus:f=>{d.initialBalance===0&&(f.target.value="")},min:"0",step:"100",placeholder:"10000",disabled:i}))),He.default.createElement("div",{className:"column"},He.default.createElement("div",{className:"setting-item-info"},He.default.createElement("div",{className:"setting-item-name"},"Creation Date"),He.default.createElement("div",{className:"setting-item-description"},"When account was created")),He.default.createElement("div",{className:"setting-item-control"},He.default.createElement("input",{type:"date",value:d.createdDate,onChange:f=>{if(!f.target.value)return;let v=ur(f.target.value);if(!v){new ks.Notice("Invalid creation date");return}let h=new Date;if(h.setHours(0,0,0,0),v>h){new ks.Notice("Creation date cannot be in the future");return}u({...d,createdDate:f.target.value})},max:To(new Date),disabled:i})))),He.default.createElement("div",{className:"setting-item two-column"},He.default.createElement("div",{className:"column"},He.default.createElement("div",{className:"setting-item-info"},He.default.createElement("div",{className:"setting-item-name"},"Drawdown Type"),He.default.createElement("div",{className:"setting-item-description"},"None | Fixed | EOD Trailing | Manual")),He.default.createElement("div",{className:"setting-item-control"},He.default.createElement("select",{value:d.drawdownType,onChange:f=>{let v=f.target.value;u({...d,drawdownType:v,drawdownAmount:v==="none"?0:d.drawdownAmount})},disabled:i},He.default.createElement("option",{value:"none"},"None"),He.default.createElement("option",{value:"fixed"},"Fixed"),He.default.createElement("option",{value:"eod_trailing"},"EOD Trailing"),He.default.createElement("option",{value:"manual"},"Manual")))),d.drawdownType!=="none"&&He.default.createElement("div",{className:"column"},He.default.createElement("div",{className:"setting-item-info"},He.default.createElement("div",{className:"setting-item-name"},"Drawdown Amount"),He.default.createElement("div",{className:"setting-item-description"},"Maximum drawdown limit")),He.default.createElement("div",{className:"setting-item-control"},He.default.createElement("input",{type:"number",value:d.drawdownAmount===0?"":d.drawdownAmount,onChange:f=>u({...d,drawdownAmount:f.target.value===""?0:parseFloat(f.target.value)||0}),onFocus:f=>{d.drawdownAmount===0&&(f.target.value="")},min:"0",step:"100",placeholder:"0",disabled:i})))),He.default.createElement("div",{className:"setting-item two-column"},He.default.createElement("div",{className:"column"},He.default.createElement(dD,{checked:d.hasProfitTarget,onChange:f=>{u({...d,hasProfitTarget:f}),f||c(null)},disabled:i,label:"Enable Profit Target"}),He.default.createElement("div",{className:"setting-item-description"},"Set a profit target for account")),He.default.createElement("div",{className:"column"},He.default.createElement("div",{className:"setting-item-info"},He.default.createElement("div",{className:"setting-item-name"},"Monthly Cost"),He.default.createElement("div",{className:"setting-item-description"},"Subscription fees, platform costs")),He.default.createElement("div",{className:"setting-item-control"},He.default.createElement("input",{type:"number",value:d.monthlyCost===0?"":d.monthlyCost,onChange:f=>u({...d,monthlyCost:f.target.value===""?0:parseFloat(f.target.value)||0}),onFocus:f=>{d.monthlyCost===0&&(f.target.value="")},min:"0",step:"1",placeholder:"0",disabled:i})))),d.hasProfitTarget&&He.default.createElement(He.default.Fragment,null,He.default.createElement("div",{className:"setting-item two-column"},He.default.createElement("div",{className:"column"},He.default.createElement("div",{className:"setting-item-info"},He.default.createElement("div",{className:"setting-item-name"},"Target Type"),He.default.createElement("div",{className:"setting-item-description"},"Absolute or percentage")),He.default.createElement("div",{className:"setting-item-control"},He.default.createElement("select",{value:d.profitTargetType,onChange:f=>u({...d,profitTargetType:f.target.value}),disabled:i},He.default.createElement("option",{value:"absolute"},"Absolute Amount"),He.default.createElement("option",{value:"percentage"},"Percentage")))),He.default.createElement("div",{className:"column"},He.default.createElement("div",{className:"setting-item-info"},He.default.createElement("div",{className:"setting-item-name"},"Target ",d.profitTargetType==="percentage"?"(%)":"($)"),He.default.createElement("div",{className:"setting-item-description"},d.profitTargetType==="percentage"?"Percentage":"Dollar amount")),He.default.createElement("div",{className:"setting-item-control"},He.default.createElement("input",{type:"number",value:d.profitTarget===0?"":d.profitTarget,onChange:f=>u({...d,profitTarget:f.target.value===""?0:parseFloat(f.target.value)||0}),onFocus:f=>{d.profitTarget===0&&(f.target.value="")},min:"0",step:d.profitTargetType==="percentage"?"1":"100",placeholder:"0",disabled:i})))),He.default.createElement("div",{className:"setting-item"},He.default.createElement("div",{className:"setting-item-info"},He.default.createElement("div",{className:"setting-item-name"},"Target Date (Optional)"),He.default.createElement("div",{className:"setting-item-description"},"Date to achieve the profit target")),He.default.createElement("div",{className:"setting-item-control"},He.default.createElement("input",{type:"date",value:d.profitTargetDate?To(d.profitTargetDate):"",onChange:f=>{if(!f.target.value){u({...d,profitTargetDate:null}),c(null);return}let v=ur(f.target.value);v?(u({...d,profitTargetDate:v}),c(null)):(u({...d,profitTargetDate:null}),c("Invalid date format. Please enter a valid date."))},disabled:i}),l&&He.default.createElement("div",{className:"error-message-inline"},l)))),He.default.createElement("div",{className:"create-account-buttons"},He.default.createElement(Ie,{variant:"primary",onClick:g,disabled:i,className:"create-account-button"},i?"Creating...":"Create Account"),He.default.createElement(Ie,{variant:"secondary",onClick:n,disabled:i,className:"cancel-button"},"Cancel")))}});var WG=F(()=>{tke();rke();nke();oke();ske();EG();cke()});function uke(e,t,r){new $G({app:e,plugin:t,onClose:()=>{},onSave:r}).open()}var xo,ke,dke,$G,Y7e,pke=F(()=>{xo=require("obsidian"),ke=Y(Q()),dke=Y(Ni());Ot();ds();hi();rl();Ns();Tr();Zs();$G=class extends xo.Modal{constructor(t){super(t.app),this.titleEl.setText("Account Dashboard Settings"),this.props=t}onOpen(){let{contentEl:t}=this;t.empty(),lh(),this.container=t.createDiv({cls:"account-dashboard-settings-modal-container"}),this.renderComponent()}onClose(){this.root&&this.root.unmount(),this.props.onClose()}renderComponent(){this.root=(0,dke.createRoot)(this.container),this.root.render(ke.default.createElement(Y7e,{...this.props,onModalClose:()=>this.close()}))}},Y7e=({app:e,plugin:t,onSave:r,onModalClose:n})=>{let[i,a]=(0,ke.useState)(!1),[o,s]=(0,ke.useState)([]),[l,c]=(0,ke.useState)(!1),[d,u]=(0,ke.useState)(""),[p,m]=(0,ke.useState)(null),[g,f]=(0,ke.useState)(!1),[v,h]=(0,ke.useState)(""),[y,b]=(0,ke.useState)(null),[k,x]=(0,ke.useState)(!1),[S,w]=(0,ke.useState)(""),[C,D]=(0,ke.useState)("reassign"),[P,M]=(0,ke.useState)({excludedAccountTypes:[],includeWithdrawalsFromExcluded:{},accountTypeOrder:[]}),z=(0,ke.useCallback)(()=>{var K;if(t.optionsService){let G=t.optionsService.getOptions("account_type");s(G)}(K=t.settings)!=null&&K.account&&M({excludedAccountTypes:[...t.settings.account.excludedAccountTypes||[]],includeWithdrawalsFromExcluded:{...t.settings.account.includeWithdrawalsFromExcluded||{}},accountTypeOrder:[...t.settings.account.accountTypeOrder||["funded","evaluation","demo","archived"]]})},[t.optionsService,t.settings]);Xe("options:changed",z),(0,ke.useEffect)(()=>{z()},[z]);let A=K=>K.split("_").map(G=>G.charAt(0).toUpperCase()+G.slice(1).toLowerCase()).join(" "),I=async()=>{if(!d.trim()){new xo.Notice("Account type name cannot be empty");return}let K=d.trim().toLowerCase().replace(/\s+/g,"_");if(o.some(X=>X.toLowerCase().replace(/\s+/g,"_")===K)){new xo.Notice(`Account type "${A(K)}" already exists`);return}if(["demo","evaluation","funded","archived","real"].includes(K)){new xo.Notice(`"${A(K)}" is a reserved account type name`);return}try{a(!0),await t.optionsService.addOption("account_type",K),s([...o,K]);let X=[...P.accountTypeOrder];X.includes(K)||X.push(K),M({...P,accountTypeOrder:X,includeWithdrawalsFromExcluded:{...P.includeWithdrawalsFromExcluded,[K]:!1}}),u(""),c(!1),H("added",K),new xo.Notice(`Account type "${A(K)}" added successfully`)}catch(X){console.error("Error adding account type:",X),new xo.Notice(`Error adding account type: ${X.message}`)}finally{a(!1)}},L=()=>{u(""),c(!1)},E=()=>{c(!0),u("")},T=async K=>{var G;try{let te=(await((G=t.accountPageService)==null?void 0:G.getAllEnhancedAccounts())||[]).filter(Z=>{var ne;return((ne=Z.accountType)==null?void 0:ne.toLowerCase())===K.toLowerCase()}),re={inExcludedTypes:K?P.excludedAccountTypes.includes(K.toLowerCase()):!1,inDisplayOrder:K?P.accountTypeOrder.includes(K.toLowerCase()):!1,inWithdrawalSettings:K?P.includeWithdrawalsFromExcluded.hasOwnProperty(K.toLowerCase()):!1};return{affectedAccounts:te.length,accountNames:te.map(Z=>Z.name||Z.accountName||"Unnamed Account"),settingsImpact:re}}catch(X){return console.error("Error analyzing account type deletion impact:",X),{affectedAccounts:0,accountNames:[],settingsImpact:{inExcludedTypes:!1,inDisplayOrder:!1,inWithdrawalSettings:!1}}}},$=K=>{let G=K.toLowerCase(),X=P.excludedAccountTypes.filter(ne=>ne.toLowerCase()!==G),te=P.accountTypeOrder.filter(ne=>ne.toLowerCase()!==G),re={...P.includeWithdrawalsFromExcluded};delete re[G];let Z={...P,excludedAccountTypes:X,accountTypeOrder:te,includeWithdrawalsFromExcluded:re};return M(Z),t.settings.account||(t.settings.account={defaultAccountType:"demo",defaultDrawdownType:"none",defaultDrawdownAmount:0,showBalanceInDashboard:!0,excludedAccountTypes:[],includeWithdrawalsFromExcluded:{},accountTypeOrder:[],accountMetadata:{}}),t.settings.account.excludedAccountTypes=X,t.settings.account.accountTypeOrder=te,t.settings.account.includeWithdrawalsFromExcluded=re,{removedFromExcluded:P.excludedAccountTypes.length!==X.length,removedFromDisplayOrder:P.accountTypeOrder.length!==te.length,removedFromWithdrawalSettings:Object.keys(P.includeWithdrawalsFromExcluded).length!==Object.keys(re).length}},_=async K=>{if(K.toLowerCase()==="archived"){new xo.Notice('Cannot delete the "Archived" account type - it is reserved for archiving accounts');return}try{a(!0);let G=await T(K);h(K),b(G),f(!0)}catch(G){console.error("Error analyzing deletion impact:",G),new xo.Notice("Error analyzing account type usage")}finally{a(!1)}},B=async()=>{if(v)try{if(a(!0),y&&y.affectedAccounts>0){new xo.Notice(`Cannot delete "${A(v)}" - it has ${y.affectedAccounts} associated accounts. Migration feature coming soon.`),f(!1);return}if(!await q(async()=>{await t.optionsService.removeOption("account_type",v)},"Account type deletion"))return;let G=$(v);t.settings.account||(t.settings.account={defaultAccountType:"demo",defaultDrawdownType:"none",defaultDrawdownAmount:0,showBalanceInDashboard:!0,excludedAccountTypes:[],includeWithdrawalsFromExcluded:{},accountTypeOrder:[],accountMetadata:{}}),t.settings.account.excludedAccountTypes=P.excludedAccountTypes,t.settings.account.includeWithdrawalsFromExcluded=P.includeWithdrawalsFromExcluded,t.settings.account.accountTypeOrder=P.accountTypeOrder,await t.saveSettings(),s(o.filter(re=>re.toLowerCase()!==v.toLowerCase())),H("deleted",v,{cleanupActions:{removedFromExcluded:G.removedFromExcluded,removedFromDisplayOrder:G.removedFromDisplayOrder,removedFromWithdrawalSettings:G.removedFromWithdrawalSettings}}),f(!1),h(""),b(null);let X=`Account type "${A(v)}" deleted successfully`,te=[];G.removedFromExcluded&&te.push("excluded types"),G.removedFromDisplayOrder&&te.push("display order"),G.removedFromWithdrawalSettings&&te.push("withdrawal settings"),te.length>0&&(X+=` (cleaned up: ${te.join(", ")})`),new xo.Notice(X),t.accountPageService&&await t.accountPageService.clearCacheWithPrefix("allEnhancedAccounts"),r()}catch(K){console.error("Error deleting account type:",K),new xo.Notice(`Error deleting account type: ${K.message}`)}finally{a(!1)}},W=()=>{f(!1),h(""),b(null)},N=()=>{let K=o.filter(G=>G.toLowerCase()!==v.toLowerCase());if(K.length===0){new xo.Notice("Cannot migrate accounts - no other account types available. Create a new account type first.");return}w(K[0]),D("reassign"),f(!1),x(!0)},U=async()=>{if(!(!y||!v))try{if(a(!0),C==="reassign"&&!S){new xo.Notice("Please select a target account type for reassignment");return}let K=await R(v,C,S);if(!K.success){new xo.Notice(`Migration failed: ${K.error}`);return}if(!await q(async()=>{await t.optionsService.removeOption("account_type",v)},"Account type deletion"))return;let X=$(v);s(o.filter(re=>re.toLowerCase()!==v.toLowerCase())),H("migrated",v,{migrationOption:C,targetType:S,migratedCount:K.migratedCount,cleanupActions:{removedFromExcluded:X.removedFromExcluded,removedFromDisplayOrder:X.removedFromDisplayOrder,removedFromWithdrawalSettings:X.removedFromWithdrawalSettings}}),x(!1),f(!1),h(""),b(null),w("");let te=`Account type "${A(v)}" deleted successfully. `;switch(te+=`${K.migratedCount} accounts `,C){case"reassign":te+=`reassigned to "${A(S)}"`;break;case"archive":te+="moved to archived status";break;case"delete":te+="marked for deletion";break}new xo.Notice(te,5e3),await t.saveSettings(),t.accountPageService&&await t.accountPageService.clearCacheWithPrefix("allEnhancedAccounts"),await new Promise(re=>setTimeout(re,100)),r()}catch(K){console.error("Error during migration and deletion:",K),new xo.Notice(`Error during migration: ${K.message}`)}finally{a(!1)}},j=()=>{x(!1),w(""),D("reassign"),f(!0)},R=async(K,G,X)=>{var te,re;try{let ne=(await((te=t.accountPageService)==null?void 0:te.getAllEnhancedAccounts())||[]).filter(ve=>{var Se;return((Se=ve.accountType)==null?void 0:Se.toLowerCase())===K.toLowerCase()});if(ne.length===0)return{success:!0,migratedCount:0};let se;switch(G){case"reassign":if(!X)return{success:!1,migratedCount:0,error:"Target type required for reassignment"};se=X;break;case"archive":se="archived";break;case"delete":se="deleted";break;default:return{success:!1,migratedCount:0,error:"Invalid migration option"}}let ee=0,ie=(re=t.settings)==null?void 0:re.account;if(ie!=null&&ie.accountMetadata){for(let ve of ne){let Se=Object.keys(ie.accountMetadata).find(Me=>{let le=ie.accountMetadata[Me];return le.name===ve.name||le.name===ve.accountName});Se&&(ie.accountMetadata[Se].accountType=se,ie.accountMetadata[Se].lastUpdated=new Date,ee++)}await t.saveSettings()}return{success:!0,migratedCount:ee}}catch(Z){return console.error("Error migrating accounts:",Z),{success:!1,migratedCount:0,error:Z.message}}},O=async()=>{try{a(!0),t.settings.account||(t.settings.account={defaultAccountType:"demo",defaultDrawdownType:"none",defaultDrawdownAmount:0,showBalanceInDashboard:!0,excludedAccountTypes:[],includeWithdrawalsFromExcluded:{},accountTypeOrder:[],accountMetadata:{}}),t.settings.account.excludedAccountTypes=P.excludedAccountTypes,t.settings.account.includeWithdrawalsFromExcluded=P.includeWithdrawalsFromExcluded,t.settings.account.accountTypeOrder=P.accountTypeOrder,await t.saveSettings(),new xo.Notice("Account dashboard settings saved successfully"),r(),n()}catch(K){console.error("Error saving account dashboard settings:",K),new xo.Notice(`Error saving settings: ${K.message}`)}finally{a(!1)}},H=(K,G,X)=>{try{xe.publish("account:changed",{action:"type-changed",timestamp:Date.now(),accountType:G,...X})}catch(te){console.error("Error dispatching account type changed event:",te)}},q=async(K,G,X=2)=>{let te=null;for(let re=1;re<=X;re++)try{return await K(),!0}catch(Z){te=Z,console.warn(`${G} failed (attempt ${re}/${X}):`,Z),re<X&&await new Promise(ne=>setTimeout(ne,re*1e3))}return new xo.Notice(`${G} failed after ${X} attempts: ${(te==null?void 0:te.message)||"Unknown error"}`),!1};return ke.default.createElement("div",{className:"account-dashboard-settings-form"},ke.default.createElement(()=>{if(!k||!y||!v)return null;let K=o.filter(G=>G.toLowerCase()!==v.toLowerCase());return ke.default.createElement("div",{className:"account-migration-modal-overlay"},ke.default.createElement("div",{className:"account-type-delete-modal account-migration-modal"},ke.default.createElement("h3",null,"Migrate Accounts Before Deletion"),ke.default.createElement("div",{className:"delete-modal-content"},ke.default.createElement("div",{className:"migration-warning"},ke.default.createElement("p",null,ke.default.createElement("strong",null,`You're about to delete "`,A(v),'" which has ',y.affectedAccounts," associated accounts.")),ke.default.createElement("p",null,"These accounts must be handled before the account type can be deleted:"),ke.default.createElement("ul",{className:"affected-accounts-list"},y.accountNames.slice(0,3).map((G,X)=>ke.default.createElement("li",{key:X},G)),y.accountNames.length>3&&ke.default.createElement("li",null,"... and ",y.accountNames.length-3," more"))),ke.default.createElement("div",{className:"migration-options"},ke.default.createElement("h4",null,"Choose how to handle these accounts:"),ke.default.createElement("div",{className:"migration-option-group"},ke.default.createElement("label",{className:"migration-option"},ke.default.createElement("input",{type:"radio",name:"migrationOption",value:"reassign",checked:C==="reassign",onChange:G=>{let X=G.target.value;(X==="reassign"||X==="archive"||X==="delete")&&D(X)}}),ke.default.createElement("div",{className:"migration-option-content"},ke.default.createElement("span",{className:"migration-option-title"},"Reassign to different type"),ke.default.createElement("span",{className:"migration-option-desc"},"Move all accounts to another account type"))),C==="reassign"&&ke.default.createElement("div",{className:"target-type-select"},ke.default.createElement("label",null,"Target account type:"),ke.default.createElement("select",{value:S,onChange:G=>w(G.target.value),disabled:i},K.map(G=>ke.default.createElement("option",{key:G,value:G},A(G))))),ke.default.createElement("label",{className:"migration-option"},ke.default.createElement("input",{type:"radio",name:"migrationOption",value:"archive",checked:C==="archive",onChange:G=>{let X=G.target.value;(X==="reassign"||X==="archive"||X==="delete")&&D(X)}}),ke.default.createElement("div",{className:"migration-option-content"},ke.default.createElement("span",{className:"migration-option-title"},"Archive accounts"),ke.default.createElement("span",{className:"migration-option-desc"},'Move all accounts to "archived" status'))),ke.default.createElement("label",{className:"migration-option"},ke.default.createElement("input",{type:"radio",name:"migrationOption",value:"delete",checked:C==="delete",onChange:G=>{let X=G.target.value;(X==="reassign"||X==="archive"||X==="delete")&&D(X)}}),ke.default.createElement("div",{className:"migration-option-content"},ke.default.createElement("span",{className:"migration-option-title"},"Mark for deletion"),ke.default.createElement("span",{className:"migration-option-desc"},"Mark all accounts as deleted")))))),ke.default.createElement("div",{className:"delete-modal-actions"},ke.default.createElement(Ie,{variant:"secondary",onClick:j,disabled:i},"Cancel"),ke.default.createElement(Ie,{variant:"secondary",onClick:U,disabled:i||C==="reassign"&&!S,className:"delete-confirm-button"},i?"Migrating...":"Migrate & Delete Type"))))},null),ke.default.createElement(()=>!g||!y?null:ke.default.createElement("div",{className:"account-type-delete-modal-overlay"},ke.default.createElement("div",{className:"account-type-delete-modal"},ke.default.createElement("h3",null,"Delete Account Type"),ke.default.createElement("div",{className:"delete-modal-content"},ke.default.createElement("div",{className:"delete-warning"},ke.default.createElement("p",null,ke.default.createElement("strong",null,'Are you sure you want to delete the account type "',A(v),'"?'))),ke.default.createElement("div",{className:"impact-analysis"},ke.default.createElement("h4",null,"Impact Analysis:"),y.affectedAccounts>0?ke.default.createElement("div",{className:"affected-accounts"},ke.default.createElement("div",{className:"impact-item impact-critical"},ke.default.createElement("strong",null,"\u26A0\uFE0F ",y.affectedAccounts," account(s) affected:"),ke.default.createElement("ul",null,y.accountNames.slice(0,5).map((K,G)=>ke.default.createElement("li",{key:G},K)),y.accountNames.length>5&&ke.default.createElement("li",null,"... and ",y.accountNames.length-5," more"))),ke.default.createElement("div",{className:"migration-notice"},ke.default.createElement("strong",null,"Note:")," These accounts will need to be reassigned to a different account type before deletion can proceed. Account migration feature is coming in Phase 4.")):ke.default.createElement("div",{className:"no-affected-accounts"},ke.default.createElement("div",{className:"impact-item impact-safe"},"\u2705 No accounts are using this account type")),ke.default.createElement("div",{className:"settings-cleanup"},ke.default.createElement("h5",null,"Settings that will be cleaned up:"),ke.default.createElement("ul",null,y.settingsImpact.inExcludedTypes&&ke.default.createElement("li",null,"\u2713 Removed from excluded account types"),y.settingsImpact.inDisplayOrder&&ke.default.createElement("li",null,"\u2713 Removed from display order"),y.settingsImpact.inWithdrawalSettings&&ke.default.createElement("li",null,"\u2713 Removed from withdrawal settings"),!y.settingsImpact.inExcludedTypes&&!y.settingsImpact.inDisplayOrder&&!y.settingsImpact.inWithdrawalSettings&&ke.default.createElement("li",null,"No settings cleanup needed"))))),ke.default.createElement("div",{className:"delete-modal-actions"},y.affectedAccounts>0?ke.default.createElement(ke.default.Fragment,null,ke.default.createElement(Ie,{variant:"secondary",onClick:W,disabled:i},"Cancel"),ke.default.createElement(Ie,{variant:"primary",onClick:N,disabled:i},"Setup Migration")):ke.default.createElement(ke.default.Fragment,null,ke.default.createElement(Ie,{variant:"secondary",onClick:W,disabled:i},"Cancel"),ke.default.createElement(Ie,{variant:"primary",onClick:B,disabled:i,className:"delete-confirm-button"},i?"Deleting...":"Delete Account Type"))))),null),ke.default.createElement("div",{className:"setting-item"},ke.default.createElement("div",{className:"setting-item-info"},ke.default.createElement("div",{className:"setting-item-name"},"Available Account Types"),ke.default.createElement("div",{className:"setting-item-description"},"Current account types in your system.")),ke.default.createElement("div",{className:"setting-item-control"},ke.default.createElement("div",{className:"available-account-types"},o.length>0?ke.default.createElement("div",{className:"account-types-container"},o.map((K,G)=>ke.default.createElement("div",{key:K,className:"account-type-badge-container",onMouseEnter:()=>m(G),onMouseLeave:()=>m(null)},ke.default.createElement("div",{className:"account-type-badge"},A(K),p===G&&K.toLowerCase()!=="archived"&&ke.default.createElement("button",{className:"account-type-delete-btn clickable-icon",onClick:()=>_(K),"aria-label":`Delete ${A(K)}`,disabled:i},"\xD7")))),ke.default.createElement("div",{className:"add-account-type-section"},l?ke.default.createElement("div",{className:"add-account-type-input"},ke.default.createElement("input",{type:"text",value:d,onChange:K=>u(K.target.value),placeholder:"Enter account type name...",autoFocus:!0,onKeyPress:K=>{K.key==="Enter"?I():K.key==="Escape"&&L()},disabled:i,className:"account-type-name-input"}),ke.default.createElement("div",{className:"add-account-type-buttons"},ke.default.createElement("button",{onClick:I,disabled:i||!d.trim(),className:"add-account-type-confirm-btn",title:"Add account type"},"Add"),ke.default.createElement("button",{onClick:L,disabled:i,className:"add-account-type-cancel-btn",title:"Cancel"},"Cancel"))):ke.default.createElement("button",{onClick:E,disabled:i,className:"add-account-type-btn clickable-icon","aria-label":"Add new account type"},ke.default.createElement(Ui,{size:16})))):ke.default.createElement("div",{className:"no-account-types-container"},ke.default.createElement("div",{className:"no-account-types"},"No custom account types defined."),ke.default.createElement("button",{onClick:E,disabled:i,className:"add-account-type-btn clickable-icon","aria-label":"Add new account type"},ke.default.createElement(Ui,{size:16})))))),ke.default.createElement("div",{className:"setting-item"},ke.default.createElement("div",{className:"setting-item-info"},ke.default.createElement("div",{className:"setting-item-name"},"Dashboard Inclusion Settings"),ke.default.createElement("div",{className:"setting-item-description"},"Choose which account types to include in dashboard calculations. Also configure whether withdrawals from each account type are included in total withdrawal metrics.")),ke.default.createElement("div",{className:"setting-item-control"},ke.default.createElement("div",{className:"account-types-settings-table"},o.length>0?ke.default.createElement("div",{className:"account-types-list"},o.map(K=>{let G=K.toLowerCase(),X=P.excludedAccountTypes.includes(G),te=P.includeWithdrawalsFromExcluded[G]||!1;return ke.default.createElement("div",{key:K,className:"account-type-setting-row"},ke.default.createElement("div",{className:"account-type-name"},A(K)),ke.default.createElement("div",{className:"account-type-controls"},ke.default.createElement("label",{className:"toggle-label"},ke.default.createElement("input",{type:"checkbox",checked:!X,onChange:re=>{let Z=[...P.excludedAccountTypes];if(!re.target.checked)Z.includes(G)||Z.push(G);else{let ne=Z.indexOf(G);ne!==-1&&Z.splice(ne,1)}M({...P,excludedAccountTypes:Z})}}),ke.default.createElement("span",null,"Include in Dashboard")),ke.default.createElement("label",{className:"toggle-label"},ke.default.createElement("input",{type:"checkbox",checked:te,onChange:re=>{M({...P,includeWithdrawalsFromExcluded:{...P.includeWithdrawalsFromExcluded,[G]:re.target.checked}})}}),ke.default.createElement("span",null,"Include Withdrawals"))))})):ke.default.createElement("div",{style:{color:"var(--text-muted)"}},"No account types available to configure.")))),ke.default.createElement("div",{className:"setting-item"},ke.default.createElement("div",{className:"setting-item-info"},ke.default.createElement("div",{className:"setting-item-name"},"Display Order"),ke.default.createElement("div",{className:"setting-item-description"},"Reorder how account types appear in the dashboard.")),ke.default.createElement("div",{className:"setting-item-control"},ke.default.createElement("div",{className:"account-type-order-container"},(()=>{let K=P.accountTypeOrder.length>0?P.accountTypeOrder:["funded","evaluation","demo","archived"],G=[...new Set([...o.map(Z=>Z.toLowerCase()),...K.map(Z=>Z.toLowerCase())])],X=new Map;o.forEach(Z=>X.set(Z.toLowerCase(),Z)),K.forEach(Z=>{X.has(Z.toLowerCase())||X.set(Z.toLowerCase(),Z.charAt(0).toUpperCase()+Z.slice(1))});let te=[];K.forEach(Z=>{if(G.includes(Z.toLowerCase())){let ne=X.get(Z.toLowerCase());ne&&te.push(ne)}}),G.forEach(Z=>{if(!K.map(ne=>ne.toLowerCase()).includes(Z)){let ne=X.get(Z);ne&&te.push(ne)}});let re=(Z,ne)=>{let se=[...te],ee=ne==="up"?Z-1:Z+1;ee>=0&&ee<se.length&&([se[Z],se[ee]]=[se[ee],se[Z]],M({...P,accountTypeOrder:se.map(ie=>ie.toLowerCase())}))};return ke.default.createElement("div",{className:"account-type-order-list"},te.length>0?ke.default.createElement("div",{className:"order-list"},te.map((Z,ne)=>ke.default.createElement("div",{key:Z,className:"order-list-item"},ke.default.createElement("span",{className:"type-name"},A(Z)),ke.default.createElement("div",{className:"order-controls"},ke.default.createElement("button",{type:"button",className:"order-button clickable-icon",disabled:ne===0,onClick:()=>re(ne,"up"),"aria-label":"Move up"},"\u2191"),ke.default.createElement("button",{type:"button",className:"order-button clickable-icon",disabled:ne===te.length-1,onClick:()=>re(ne,"down"),"aria-label":"Move down"},"\u2193"))))):ke.default.createElement("div",{style:{color:"var(--text-muted)"}},"No account types available to order."))})()))),ke.default.createElement("div",{className:"settings-modal-buttons"},ke.default.createElement(Ie,{variant:"primary",onClick:O,disabled:i,className:"save-settings-button"},i?"Saving...":"Save Settings"),ke.default.createElement(Ie,{variant:"secondary",onClick:n,disabled:i,className:"cancel-button"},"Cancel")))}});var Xt,K7e,J7e,mke,fke=F(()=>{Xt=Y(Q());Ot();Ol();ds();cG();dG();pG();Bwe();Uwe();hi();yG();WG();pke();cg();rl();qi();K7e=["account:changed","options:changed","trade:changed"],J7e=({plugin:e})=>{let[t,r]=(0,Xt.useState)([]),[n,i]=(0,Xt.useState)(!0),[a,o]=(0,Xt.useState)(null),[s,l]=(0,Xt.useState)(""),[c,d]=(0,Xt.useState)(0),[u,p]=(0,Xt.useTransition)(),m=(0,Xt.useDeferredValue)(s),g=(0,Xt.useRef)(0),f=5,v=(0,Xt.useRef)(null),h=(0,Xt.useCallback)(async()=>{try{if(i(!0),o(null),!e.accountPageService){if(g.current+=1,g.current>f)throw g.current=0,new Error("AccountPageService not initialized after multiple attempts");let I=300*Math.pow(2,g.current-1);console.warn(`AccountPageService not ready, retrying in ${I}ms (attempt ${g.current}/${f})`),v.current=setTimeout(()=>h(),I);return}g.current=0;let A=await e.accountPageService.getAllEnhancedAccounts();r(A)}catch(A){console.error("Error loading accounts:",A),o(`Error loading accounts: ${A instanceof Error?A.message:String(A)}`)}finally{g.current===0&&i(!1)}},[e]),y=(0,Xt.useCallback)(async()=>{e.accountPageService&&await e.accountPageService.refreshAllAccountData(),p(()=>{h()})},[h,e.accountPageService]);(0,Xt.useEffect)(()=>(zI(),h(),()=>{v.current&&(clearTimeout(v.current),v.current=null)}),[h]),pI(K7e,y);let b=(0,Xt.useMemo)(()=>Cxe(t,e.settings),[t,e.settings,c]),k=(0,Xt.useMemo)(()=>{var A,I;return((I=(A=e.settings)==null?void 0:A.account)==null?void 0:I.excludedAccountTypes)||["archived"]},[e.settings]),x=(0,Xt.useMemo)(()=>t.filter(A=>A.accountType&&!k.includes(A.accountType.toLowerCase())).reduce((A,I)=>A+I.currentBalance,0),[t,k]),S=(0,Xt.useMemo)(()=>Pxe(t,e.settings),[t,e.settings,c]),w=(0,Xt.useMemo)(()=>m?t.filter(A=>A.name.toLowerCase().includes(m.toLowerCase())):t,[t,m]),C=(0,Xt.useMemo)(()=>Dxe(w),[w,c]),D=(0,Xt.useMemo)(()=>{var _,B,W,N;let A=Object.keys(C),I=((B=(_=e==null?void 0:e.settings)==null?void 0:_.account)==null?void 0:B.accountTypeOrder)||["funded","evaluation","demo","archived"],L=((N=(W=e==null?void 0:e.optionsService)==null?void 0:W.getOptions)==null?void 0:N.call(W,"account_type"))||[],E=new Set([...A.map(U=>U.toLowerCase()),...I.map(U=>U.toLowerCase()),...L.map(U=>U.toLowerCase())]),T=new Map;A.forEach(U=>T.set(U.toLowerCase(),U)),I.forEach(U=>{if(!T.has(U.toLowerCase())){let j=U.charAt(0).toUpperCase()+U.slice(1).toLowerCase();T.set(U.toLowerCase(),j)}}),L.forEach(U=>{T.has(U.toLowerCase())||T.set(U.toLowerCase(),U)});let $=[];return I.forEach(U=>{let j=T.get(U.toLowerCase());j&&E.has(U.toLowerCase())&&($.push(j),E.delete(U.toLowerCase()))}),E.forEach(U=>{let j=T.get(U);j&&$.push(j)}),$},[C,e,c]),P=(0,Xt.useCallback)(async(A,I)=>{e.viewManager.openAccountPageView(A)},[e.viewManager]),M=(0,Xt.useCallback)(async()=>{BG(e.app,e,()=>{h()})},[e,h]),z=(0,Xt.useCallback)(async()=>{uke(e.app,e,()=>{d(A=>A+1),h()})},[e,h]);return n?Xt.default.createElement("div",{className:"journalit-account-dashboard"},Xt.default.createElement(vG,null)):a?Xt.default.createElement("div",{className:"journalit-account-dashboard error"},Xt.default.createElement("div",{className:"error-message"},a)):t.length===0?Xt.default.createElement("div",{className:"journalit-account-dashboard"},Xt.default.createElement("div",{className:"empty-state-with-action"},Xt.default.createElement(yi,{message:"No Accounts Found",subMessage:"Create an account to start tracking your trading performance"}),Xt.default.createElement("div",{className:"empty-state-actions"},Xt.default.createElement(Ie,{variant:"primary",onClick:M,className:"create-account-primary-button"},"Create Your First Account")))):Xt.default.createElement("div",{className:"journalit-account-dashboard"},Xt.default.createElement("div",{className:"dashboard-content"},Xt.default.createElement("div",{className:"dashboard-header"},Xt.default.createElement("div",{className:"dashboard-title"},Xt.default.createElement("h2",null,"Account Dashboard")),Xt.default.createElement("div",{className:"dashboard-actions"},Xt.default.createElement(Oz,{ariaLabel:"Create new account",onClick:M,className:"create-account-button"},Xt.default.createElement(Ui,{size:18})),Xt.default.createElement(Oz,{ariaLabel:"Account dashboard settings",onClick:z,className:"settings-button"},Xt.default.createElement(Yg,{size:16})))),Xt.default.createElement(Mwe,{data:S,plugin:e}),Xt.default.createElement(Awe,{metrics:b}),Xt.default.createElement(hG,{accounts:t,accountsByType:C,accountTypesToDisplay:D,totalAUM:x,excludedTypes:k,showLegend:!0}),Xt.default.createElement(Owe,{accountsByType:C,openAccount:P,plugin:e,refreshTrigger:c,totalAUM:x,excludedTypes:k})))},mke=Xt.default.memo(J7e)});var gke=F(()=>{Iwe();cg();fke();cG();dG();pG();Lz()});var hke,RG,vke,_z,yke=F(()=>{hke=require("obsidian"),RG=Y(Q()),vke=Y(Ni());gke();co();Er();_z=class extends hke.ItemView{constructor(r,n){super(r);this.root=null;this.plugin=n}getViewType(){return"account-dashboard"}getDisplayText(){return"Account Dashboard"}getIcon(){return"users"}async onOpen(){var i;(i=we.account)!=null&&i.inject&&we.account.inject();let r=this.containerEl.children[1];r.empty(),r.addClass("journalit-account-dashboard-container");let n=r.createDiv();this.root=(0,vke.createRoot)(n),this.renderDashboard()}async onClose(){var r;this.root&&(this.root.unmount(),this.root=null),(r=we.account)!=null&&r.remove&&we.account.remove()}renderDashboard(){this.root&&this.root.render(RG.createElement(el,{children:null},RG.createElement(mke,{plugin:this.plugin})))}}});var ex,bke=F(()=>{YO();_t();Oa();Jn();Tr();o0();ex=class{constructor(t){this.cache=new Map;this.lastUpdateTime=0;this.updateThreshold=5e3;this.CACHE_VERSION=2;this.unsubscribeFns=[];this.forceFreshNextLoad=!1;this.cachedTradingDayCutoffTime=null;this.cachedEnrichedTrades=null;this.tradingDayStringCache=new Map;this.plugin=t,this.tradeService=Jb.getInstance(t.app,t).getTradeService(),this.cacheTradingDaySettings();let r=()=>{this.clearCache(),this.forceFreshNextLoad=!0};this.unsubscribeFns.push(xe.subscribe("trade:changed",r),xe.subscribe("missed-trade:changed",r),xe.subscribe("backtest-trade:changed",r))}async getTradesWithPaths(t){let r=await this.tradeService.getTradeData({fresh:this.forceFreshNextLoad});this.forceFreshNextLoad=!1;let n=/(!Journalit|journalit)/i,a=r.filter(o=>o.path&&n.test(o.path)).map(o=>({...o,filePath:o.path||o.filePath,isBacktestTrade:o.isBacktestTrade||o.type==="backtest-trade",isMissedTrade:o.isMissedTrade||o.type==="missed-trade"}));if(this.shouldLoadMissedTrades(t)){let o=await this.plugin.serviceManager.getMissedTradeService();if(o)try{let s=new Date("2000-01-01"),l=new Date("2099-12-31"),c=await o.getMissedTrades(s,l);for(let d of c){let u=this.plugin.app.metadataCache.getFileCache(d),p=u==null?void 0:u.frontmatter;p&&p.type==="missed-trade"&&a.push({...p,filePath:d.path,isMissedTrade:!0,path:d.path})}}catch(s){console.error("Error fetching missed trades for trade log:",s)}}return a}async getHierarchicalData(t,r,n,i,a,o,s,l,c){let d=k=>!k||k.length===0?"ALL":k.join(","),u=`v${this.CACHE_VERSION}-${t}-${r==null?void 0:r.toISOString()}-${n==null?void 0:n.toISOString()}-${d(i)}-${d(a)}-${d(o)}-${d(s)}-${d(l)}-${d(c)}`,p=Date.now();if(this.cache.has(u)&&p-this.lastUpdateTime<this.updateThreshold)return this.cache.get(u).children||[];!this.cache.has(u.split("-")[0])&&(this.cachedEnrichedTrades=null);let f=await this.getTradesWithPaths(i);(r||n)&&(f=this.filterTradesByDateRange(f,r,n)),i&&i.length>0&&(f=this.filterTradesByType(f,i)),a&&a.length>0&&(f=this.filterTradesByStatus(f,a)),o&&o.length>0&&(f=this.filterTradesByAccount(f,o)),s&&s.length>0&&(f=this.filterTradesByTicker(f,s)),l&&l.length>0&&(f=this.filterTradesBySetup(f,l)),c&&c.length>0&&(f=this.filterTradesByTag(f,c));let v=this.preComputeDateComponents(f);this.cachedEnrichedTrades=v;let h;switch(t){case"years":h=await this.buildYearNodesOptimized(v);break;case"quarters":h=await this.buildQuarterNodesOptimized(v);break;case"months":h=await this.buildMonthNodesOptimized(v);break;case"weeks":h=await this.buildWeekNodesOptimized(v);break;case"days":h=await this.buildDayNodesOptimized(v);break;case"trades":h=await this.buildTradeNodesOptimized(v);break;default:h=[]}h.length<50&&this.markBestWorstPerformers(h);let b={type:"root",id:"root",label:"All Trades",metrics:v.length>500?this.calculateMetricsLightweight(v):this.calculateMetrics(v),children:h,expanded:!0,dataLoaded:!0};return this.cache.set(u,b),this.lastUpdateTime=p,h}cacheTradingDaySettings(){var t,r,n;try{this.cachedTradingDayCutoffTime=((n=(r=(t=this.plugin)==null?void 0:t.settings)==null?void 0:r.trade)==null?void 0:n.tradingDayCutoffTime)||null}catch(i){this.cachedTradingDayCutoffTime=null}}async getNodeChildren(t){if(!this.cachedEnrichedTrades||this.cachedEnrichedTrades.length===0){let a=await this.getTradesWithPaths();this.cachedEnrichedTrades=this.preComputeDateComponents(a)}let r=this.cachedEnrichedTrades,n=this.filterTradesByNode(r,t),i=[];switch(t.type){case"year":i=this.buildQuartersForYear(n,parseInt(t.id));break;case"quarter":i=this.buildMonthsForQuarter(n,t.id);break;case"month":i=this.buildWeeksForMonth(n,t.id);break;case"week":i=this.buildDaysForWeek(n,t.id);break;case"day":i=await this.buildTradesForDay(n,t.id);break;default:return[]}return this.markBestWorstPerformers(i),i}async buildFullHierarchy(t){let r=new Map;t.forEach(a=>{let s=new Date(a.entryTime).getFullYear();r.has(s)||r.set(s,[]),r.get(s).push(a)});let n=[],i=Array.from(r.keys()).sort((a,o)=>o-a);for(let a of i){let o=r.get(a),s=this.buildQuartersForYear(o,a);n.push({type:"year",id:a.toString(),label:a.toString(),metrics:this.calculateMetrics(o),children:s,expanded:a===new Date().getFullYear(),dataLoaded:!0})}return this.markBestWorstPerformersRecursive(n),n}async buildYearNodes(t){let r=new Map;t.forEach(a=>{let s=new Date(a.entryTime).getFullYear();r.has(s)||r.set(s,[]),r.get(s).push(a)});let n=[],i=Array.from(r.keys()).sort((a,o)=>o-a);for(let a of i){let o=r.get(a);n.push({type:"year",id:a.toString(),label:a.toString(),metrics:this.calculateMetrics(o),expanded:!1,dataLoaded:!1})}return n}preComputeDateComponents(t){return t.map((n,i)=>{let a=n.entryTime||n["entry-time"]||n.date;if(!a)return null;let o=new Date(a);if(isNaN(o.getTime()))return null;let s=o.getFullYear(),l=o.getMonth(),c=Math.floor(l/3)+1;return{...n,_dateComponents:{date:o,year:s,month:l+1,quarter:c,dayKey:To(o),weekNum:this.getISOWeekNumber(o),tradingDayString:this.getTradingDayStringMemoized(o)}}}).filter(n=>n!==null)}getTradingDayStringMemoized(t){let r=t.toISOString();if(!this.tradingDayStringCache.has(r)){let n=this.cachedTradingDayCutoffTime?this.getTradingDayStringWithCachedSettings(t,this.cachedTradingDayCutoffTime):mc(t,this.plugin);this.tradingDayStringCache.set(r,n)}return this.tradingDayStringCache.get(r)}getTradingDayStringWithCachedSettings(t,r){try{let[n,i]=r.split(":").map(Number),a=n*60+i;if(t.getHours()*60+t.getMinutes()<a){let s=new Date(t);return s.setDate(t.getDate()-1),To(s)}return To(t)}catch(n){return To(t)}}getISOWeekNumber(t){return Ou(t)}calculateMetricsLightweight(t){var c,d,u;if(t.length===0)return{totalPnL:0,winRate:0,tradeCount:0};let r=t.filter(p=>this.getTradeStatus(p)==="open"),n=t.filter(p=>this.getTradeStatus(p)!=="open"&&!p.isMissedTrade),i=n.filter(p=>(p.pnl||0)>0).length,a=n.reduce((p,m)=>p+(m.pnl||0),0),o=n.reduce((p,m)=>p+(m.rMultiple||0),0),s=((u=(d=(c=this.plugin)==null?void 0:c.settings)==null?void 0:d.general)==null?void 0:u.currency)||"USD",l=a0(n,s);return{totalPnL:a,winRate:n.length>0?i/n.length*100:0,tradeCount:t.length,openTradeCount:r.length,closedTradeCount:n.length,totalRMultiple:o,totalPnLByCurrency:l.byCurrency,isMultiCurrency:l.isMultiCurrency,primaryCurrency:l.defaultCurrency}}calculateMetrics(t){var m,g,f;if(t.length===0)return{totalPnL:0,winRate:0,tradeCount:0};let r=t.filter(v=>this.getTradeStatus(v)==="open"),n=t.filter(v=>this.getTradeStatus(v)!=="open"&&!v.isMissedTrade),i=n.filter(v=>(v.pnl||0)>0).length,a=n.filter(v=>(v.pnl||0)<0).length,o=n.reduce((v,h)=>v+(h.pnl||0),0),s=n.reduce((v,h)=>v+(h.rMultiple||0),0),l=new Map;n.length<100&&n.forEach(v=>{let h=new Date(v.entryTime),y=To(h);l.set(y,(l.get(y)||0)+(v.pnl||0))});let c={label:"",pnl:-1/0},d={label:"",pnl:1/0};l.size>0&&l.forEach((v,h)=>{v>c.pnl&&(c={label:h,pnl:v}),v<d.pnl&&(d={label:h,pnl:v})});let u=((f=(g=(m=this.plugin)==null?void 0:m.settings)==null?void 0:g.general)==null?void 0:f.currency)||"USD",p=a0(n,u);return{totalPnL:o,winRate:n.length>0?i/n.length*100:0,tradeCount:t.length,openTradeCount:r.length,closedTradeCount:n.length,totalRMultiple:s,bestPeriod:c.label&&l.size>0?c:void 0,worstPeriod:d.label&&l.size>0?d:void 0,totalPnLByCurrency:p.byCurrency,isMultiCurrency:p.isMultiCurrency,primaryCurrency:p.defaultCurrency}}getTradeStatus(t){return Ml(t,this.plugin.settings.trade)}filterTradesByDateRange(t,r,n){return!r&&!n?t:t.filter(i=>{let a=new Date(i.entryTime);return!(r&&a<r||n&&a>n)})}filterTradesByType(t,r){return!r||r.length===0?t:t.filter(n=>n.isMissedTrade?r.includes("missed"):n.isBacktestTrade?r.includes("backtest"):r.includes("regular"))}filterTradesByStatus(t,r){return!r||r.length===0?t:t.filter(n=>{let i=Ml(n,this.plugin.settings.trade);if(["open","win","loss","breakeven"].includes(i))return r.includes(i);if(i==="missed"||i==="backtest"){let a=Xg(n),o=yt(n);if(o&&r.includes("open")||!o&&a>0&&r.includes("win")||!o&&a<0&&r.includes("loss")||!o&&a===0&&r.includes("breakeven"))return!0}return!1})}filterTradesByAccount(t,r){return!r||r.length===0?t:t.filter(n=>{let i=a=>a?Array.isArray(a)?a.some(o=>r.includes(o)):typeof a=="string"?r.includes(a):!1:!1;return i(n.account)||i(n.accountIds)})}filterTradesByTicker(t,r){return!r||r.length===0?t:t.filter(n=>{var a;let i=((a=n.instrument)==null?void 0:a.toLowerCase())||"";return r.some(o=>i.includes(o.toLowerCase()))})}filterTradesBySetup(t,r){return!r||r.length===0?t:t.filter(n=>r.includes("__NO_SETUP__")&&(!n.setup||n.setup.length===0)?!0:n.setup&&Array.isArray(n.setup)&&n.setup.length>0?n.setup.some(i=>r.some(a=>i.toLowerCase()===a.toLowerCase())):!1)}filterTradesByTag(t,r){if(!r||r.length===0)return t;let n=r.includes("__NO_TAGS__"),i=r.filter(a=>a!=="__NO_TAGS__");return t.filter(a=>{var s;let o=!a.tags||a.tags.length===0;return!!(n&&o||i.length>0&&((s=a.tags)!=null&&s.some(l=>i.includes(l))))})}async getUniqueAccounts(){return await this.tradeService.getUniqueAccounts()}filterTradesByNode(t,r){switch(r.type){case"year":let n=parseInt(r.id);return t.filter(b=>b._dateComponents?b._dateComponents.year===n:new Date(b.entryTime).getFullYear()===n);case"quarter":let[i,a]=r.id.split("-Q"),o=parseInt(a),s=parseInt(i);return t.filter(b=>{if(b._dateComponents)return b._dateComponents.year===s&&b._dateComponents.quarter===o;let k=(o-1)*3,x=k+2,S=new Date(b.entryTime);return S.getFullYear()===s&&S.getMonth()>=k&&S.getMonth()<=x});case"month":let[l,c]=r.id.split("-"),d=parseInt(c),u=parseInt(l);return t.filter(b=>{if(b._dateComponents)return b._dateComponents.year===u&&b._dateComponents.month===d;let k=new Date(b.entryTime);return k.getFullYear()===u&&k.getMonth()===d-1});case"week":let p=r.id.split("-W"),m=p[1],g=parseInt(m),f=p[0],v=parseInt(f.split("-")[0]),h=parseInt(f.split("-")[1]);return t.filter(b=>{if(b._dateComponents)return b._dateComponents.year===v&&b._dateComponents.weekNum===g&&b._dateComponents.month===h;let k=new Date(b.entryTime);return k.getFullYear()===v&&Ou(k)===g&&k.getMonth()+1===h});case"day":return t.filter((b,k)=>{if(b._dateComponents&&b._dateComponents.tradingDayString)return b._dateComponents.tradingDayString===r.id;let x=new Date(b.entryTime);return mc(x,this.plugin)===r.id});default:return t}}async buildQuarterNodes(t){let r=new Map;t.forEach(a=>{let o=new Date(a.entryTime),s=o.getFullYear(),l=Ap(o),c=`${s}-Q${l}`;r.has(c)||r.set(c,[]),r.get(c).push(a)});let n=[],i=Array.from(r.keys()).sort((a,o)=>o.localeCompare(a));for(let a of i){let o=r.get(a),[s,l]=a.split("-Q");n.push({type:"quarter",id:a,label:`Q${l} ${s}`,metrics:this.calculateMetrics(o),expanded:!1,dataLoaded:!1})}return n}async buildMonthNodes(t){let r=new Map;t.forEach(o=>{let s=new Date(o.entryTime),l=`${s.getFullYear()}-${(s.getMonth()+1).toString().padStart(2,"0")}`;r.has(l)||r.set(l,[]),r.get(l).push(o)});let n=[],i=Array.from(r.keys()).sort((o,s)=>s.localeCompare(o)),a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];for(let o of i){let s=r.get(o),[l,c]=o.split("-");n.push({type:"month",id:o,label:`${a[parseInt(c)-1]} ${l}`,metrics:this.calculateMetrics(s),expanded:!1,dataLoaded:!1})}return n}async buildWeekNodes(t){let r=new Map;t.forEach(a=>{let o=new Date(a.entryTime),s=Ou(o),l=o.getFullYear(),c=(o.getMonth()+1).toString().padStart(2,"0"),d=`${l}-${c}-W${s.toString().padStart(2,"0")}`;r.has(d)||r.set(d,[]),r.get(d).push(a)});let n=[],i=Array.from(r.keys()).sort((a,o)=>o.localeCompare(a));for(let a of i){let o=r.get(a);n.push({type:"week",id:a,label:a.replace(/^\d{4}-\d{2}-W/,s=>s.substring(0,4)+" Week "),metrics:this.calculateMetrics(o),expanded:!1,dataLoaded:!1})}return n}async buildDayNodes(t){let r=new Map;t.forEach(a=>{let o=new Date(a.entryTime),s=mc(o,this.plugin);r.has(s)||r.set(s,[]),r.get(s).push(a)});let n=[],i=Array.from(r.keys()).sort((a,o)=>o.localeCompare(a));for(let a of i){let o=r.get(a);n.push({type:"day",id:a,label:new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),metrics:this.calculateMetrics(o),expanded:!1,dataLoaded:!1})}return n}clearCache(){this.cache.clear(),this.tradingDayStringCache.clear(),this.cachedEnrichedTrades=null,this.lastUpdateTime=0,this.cacheTradingDaySettings(),this.tradeService.clearCache()}markBestWorstPerformers(t){if(t.length===0||t[0].type==="trade")return;let r=null,n=null,i=-1/0,a=1/0;if(t.forEach(o=>{let s=o.metrics.totalPnL;s>0&&s>i&&(i=s,r=o),s<0&&s<a&&(a=s,n=o)}),t.length===1){let o=t[0];o.metrics.totalPnL>0?o.performanceIndicator="best":o.metrics.totalPnL<0&&(o.performanceIndicator="worst")}else r!==null&&i>0&&(r.performanceIndicator="best"),n!==null&&a<0&&n!==r&&(n.performanceIndicator="worst")}markBestWorstPerformersRecursive(t){this.markBestWorstPerformers(t),t.forEach(r=>{r.children&&r.children.length>0&&this.markBestWorstPerformersRecursive(r.children)})}markBestWorstTrades(t){var o;if(t.length===0)return;let r=null,n=null,i=-1/0,a=1/0;if(t.forEach(s=>{var c;let l=((c=s.trade)==null?void 0:c.pnl)||0;l>0&&l>i&&(i=l,r=s),l<0&&l<a&&(a=l,n=s)}),t.length===1){let s=t[0],l=((o=s.trade)==null?void 0:o.pnl)||0;l>0?s.trade&&(s.trade.performanceIndicator="best"):l<0&&s.trade&&(s.trade.performanceIndicator="worst")}else r!==null&&i>0&&r.trade&&(r.trade.performanceIndicator="best"),n!==null&&a<0&&n!==r&&n.trade&&(n.trade.performanceIndicator="worst")}async buildTradeNodes(t){let r=[...t].sort((a,o)=>{let s=new Date(a.entryTime);return new Date(o.entryTime).getTime()-s.getTime()});if(r.length<100)return r.map(o=>{let s=new Date(o.entryTime),l=zt(s),c=this.getTradeStatus(o),d=c==="open",u=d?0:o.pnl||0,p=o.instrument||"Unknown",m=`${p} - ${l}${d?" (OPEN)":""}`;return{type:"trade",id:o.filePath||`trade-${p}-${s.getTime()}`,label:m,metrics:{totalPnL:u,winRate:d?0:u>0?100:0,tradeCount:1,status:c},trade:o,expanded:!1,dataLoaded:!0}});let n=[],i=50;for(let a=0;a<r.length;a+=i){let s=r.slice(a,a+i).map(l=>{let c=new Date(l.entryTime),d=zt(c),u=this.getTradeStatus(l),p=u==="open",m=p?0:l.pnl||0,g=l.instrument||"Unknown",f=`${g} - ${d}${p?" (OPEN)":""}`;return{type:"trade",id:l.filePath||`trade-${g}-${c.getTime()}`,label:f,metrics:{totalPnL:m,winRate:p?0:m>0?100:0,tradeCount:1,status:u},trade:l,expanded:!1,dataLoaded:!0}});n.push(...s),a/i%3===0&&a+i<r.length&&await new Promise(l=>setTimeout(l,0))}return n}async buildTradesForDay(t,r){try{return await this.buildTradeNodesOptimized(t)}catch(n){return console.error("Error building trades for day:",n),[]}}buildQuartersForYear(t,r){let n=new Map;t.forEach(a=>{let o=new Date(a.entryTime),s=Ap(o);n.has(s)||n.set(s,[]),n.get(s).push(a)});let i=[];for(let a=4;a>=1;a--)if(n.has(a)){let o=n.get(a);i.push({type:"quarter",id:`${r}-Q${a}`,label:`Q${a}`,metrics:this.calculateMetrics(o),expanded:!1,dataLoaded:!1})}return i}buildMonthsForQuarter(t,r){let[n,i]=r.split("-Q"),o=(parseInt(i)-1)*3,s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],l=new Map;t.forEach(d=>{let p=new Date(d.entryTime).getMonth();l.has(p)||l.set(p,[]),l.get(p).push(d)});let c=[];for(let d=o+2;d>=o;d--)if(l.has(d)){let u=l.get(d);c.push({type:"month",id:`${n}-${(d+1).toString().padStart(2,"0")}`,label:s[d],metrics:this.calculateMetrics(u),expanded:!1,dataLoaded:!1})}return c}buildWeeksForMonth(t,r){let n=new Map;t.forEach(o=>{let s=new Date(o.entryTime),l=Ou(s);n.has(l)||n.set(l,[]),n.get(l).push(o)});let i=[],a=Array.from(n.keys()).sort((o,s)=>s-o);for(let o of a){let s=n.get(o),[l]=r.split("-");i.push({type:"week",id:`${r}-W${o.toString().padStart(2,"0")}`,label:`Week ${o}`,metrics:this.calculateMetrics(s),expanded:!1,dataLoaded:!1})}return i}buildDaysForWeek(t,r){let n=new Map,i=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];t.forEach(s=>{let l=new Date(s.entryTime),c=mc(l,this.plugin);n.has(c)||n.set(c,[]),n.get(c).push(s)});let a=[],o=Array.from(n.keys()).sort((s,l)=>l.localeCompare(s));for(let s of o){let l=n.get(s),c=new Date(s),d=i[c.getDay()];a.push({type:"day",id:s,label:`${d} ${c.getDate()}`,metrics:this.calculateMetrics(l),expanded:!1,dataLoaded:!1})}return a}async buildTradeNodesOptimized(t){let r=[...t].sort((i,a)=>a._dateComponents.date.getTime()-i._dateComponents.date.getTime());return r.length>200?await this.buildTradeNodesLightweight(r):r.map((i,a)=>{let o=zt(i._dateComponents.date),s=this.getTradeStatus(i),l=s==="open",c=l?0:i.pnl||0,d=i.instrument||"Unknown",u=`${d} - ${o}${l?" (OPEN)":""}`;return{type:"trade",id:i.filePath||`trade-${d}-${i._dateComponents.date.getTime()}`,label:u,metrics:{totalPnL:c,winRate:l?0:c>0?100:0,tradeCount:1,status:s},trade:i,expanded:!1,dataLoaded:!0}})}async buildTradeNodesLightweight(t){let r=[];for(let i=0;i<t.length;i+=100){let o=t.slice(i,i+100).map(s=>{let l=this.getTradeStatus(s),c=l==="open",d=c?0:s.pnl||0,u=s.instrument||"Unknown",p=`${u} - ${s._dateComponents.dayKey}${c?" (OPEN)":""}`;return{type:"trade",id:s.filePath||`trade-${u}-${s._dateComponents.date.getTime()}`,label:p,metrics:{totalPnL:d,winRate:c?0:d>0?100:0,tradeCount:1,status:l},trade:s,expanded:!1,dataLoaded:!0}});r.push(...o),i%200===0&&i+100<t.length&&await new Promise(s=>setTimeout(s,0))}return r}async buildYearNodesOptimized(t){let r=new Map;t.forEach(a=>{let o=a._dateComponents.year;r.has(o)||r.set(o,[]),r.get(o).push(a)});let n=[],i=Array.from(r.keys()).sort((a,o)=>o-a);for(let a of i){let o=r.get(a);n.push({type:"year",id:a.toString(),label:a.toString(),metrics:o.length>500?this.calculateMetricsLightweight(o):this.calculateMetrics(o),expanded:!1,dataLoaded:!1})}return n}async buildQuarterNodesOptimized(t){let r=new Map;t.forEach(a=>{let o=a._dateComponents.year,s=a._dateComponents.quarter,l=`${o}-Q${s}`;r.has(l)||r.set(l,[]),r.get(l).push(a)});let n=[],i=Array.from(r.keys()).sort((a,o)=>o.localeCompare(a));for(let a of i){let o=r.get(a),[s,l]=a.split("-Q");n.push({type:"quarter",id:a,label:`Q${l} ${s}`,metrics:o.length>500?this.calculateMetricsLightweight(o):this.calculateMetrics(o),expanded:!1,dataLoaded:!1})}return n}async buildMonthNodesOptimized(t){let r=new Map;t.forEach(o=>{let s=`${o._dateComponents.year}-${o._dateComponents.month.toString().padStart(2,"0")}`;r.has(s)||r.set(s,[]),r.get(s).push(o)});let n=[],i=Array.from(r.keys()).sort((o,s)=>s.localeCompare(o)),a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];for(let o of i){let s=r.get(o),[l,c]=o.split("-");n.push({type:"month",id:o,label:`${a[parseInt(c)-1]} ${l}`,metrics:s.length>500?this.calculateMetricsLightweight(s):this.calculateMetrics(s),expanded:!1,dataLoaded:!1})}return n}async buildWeekNodesOptimized(t){let r=new Map;t.forEach(a=>{let o=`${a._dateComponents.year}-${a._dateComponents.month.toString().padStart(2,"0")}-W${a._dateComponents.weekNum.toString().padStart(2,"0")}`;r.has(o)||r.set(o,[]),r.get(o).push(a)});let n=[],i=Array.from(r.keys()).sort((a,o)=>o.localeCompare(a));for(let a of i){let o=r.get(a);n.push({type:"week",id:a,label:a.replace("-W"," Week "),metrics:o.length>500?this.calculateMetricsLightweight(o):this.calculateMetrics(o),expanded:!1,dataLoaded:!1})}return n}async buildDayNodesOptimized(t){let r=new Map;t.forEach((a,o)=>{let s=a._dateComponents.tradingDayString;r.has(s)||r.set(s,[]),r.get(s).push(a)});let n=[],i=Array.from(r.keys()).sort((a,o)=>o.localeCompare(a));for(let a of i){let o=r.get(a);n.push({type:"day",id:a,label:new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),metrics:o.length>500?this.calculateMetricsLightweight(o):this.calculateMetrics(o),expanded:!1,dataLoaded:!1})}return n}shouldLoadMissedTrades(t){return!t||t.length===0?!0:t.includes("missed")}destroy(){for(let t of this.unsubscribeFns)t();this.unsubscribeFns=[],this.tradingDayStringCache.clear(),this.cache.clear()}}});var UG=F(()=>{bke();r1()});function xke(e,t){return(t.length>0?t:tx.map(n=>n.id)).map(n=>tx.find(i=>i.id===n)).filter(n=>n?Object.keys(e).length===0?n.defaultVisible:e[n.id]!==void 0?e[n.id]:n.defaultVisible:!1)}function wke(e,t,r,n){let i=["setups","mistakes","tags"],a=e.map(o=>{if(o.width===0)return"minmax(320px, 2fr)";if(o.id==="select")return"40px";if(o.id==="image")return"50px";if(r&&i.includes(o.id)){let s=n==null?void 0:n[o.id];return s&&s>0?`${Math.ceil(s)+8}px`:`minmax(${o.width}px, max-content)`}return`minmax(${o.width}px, 1fr)`}).join(" ");return t&&t!=="trades"?`20px ${a}`:a}function kke(e,t){if(!t)return"ArrowUpDown";switch(e){case"currency":case"number":case"date":return t==="asc"?"ArrowUp01":"ArrowDown10";case"duration":return t==="asc"?"ArrowUpNarrowWide":"ArrowDownWideNarrow";default:return t==="asc"?"ArrowUpAZ":"ArrowDownZA"}}var HG,tx,qG=F(()=>{HG=[{id:"basic",label:"Basic Info"},{id:"timing",label:"Timing"},{id:"prices",label:"Prices"},{id:"risk",label:"Risk Management"},{id:"position",label:"Position & P/L"},{id:"review",label:"Review"}],tx=[{id:"select",label:"",width:40,sortable:!1,defaultVisible:!1,type:"text",category:"basic"},{id:"image",label:"Image",width:50,sortable:!1,defaultVisible:!0,type:"image",category:"basic"},{id:"account",label:"Account",width:100,sortable:!1,defaultVisible:!0,type:"text",category:"basic"},{id:"ticker",label:"Ticker",width:120,sortable:!1,defaultVisible:!0,type:"text",category:"basic"},{id:"exchange",label:"Exchange",width:100,sortable:!1,defaultVisible:!1,type:"text",category:"basic"},{id:"status",label:"Status",width:100,sortable:!1,defaultVisible:!0,type:"text",category:"basic"},{id:"direction",label:"Direction",width:100,sortable:!1,defaultVisible:!0,type:"text",category:"basic"},{id:"date",label:"Open Date",width:100,sortable:!0,defaultVisible:!0,type:"date",category:"timing"},{id:"entryTime",label:"Entry Time",width:90,sortable:!1,defaultVisible:!1,type:"text",category:"timing"},{id:"exitDate",label:"Close Date",width:100,sortable:!0,defaultVisible:!1,type:"date",category:"timing"},{id:"exitTime",label:"Exit Time",width:90,sortable:!1,defaultVisible:!1,type:"text",category:"timing"},{id:"duration",label:"Duration",width:100,sortable:!0,defaultVisible:!1,type:"duration",category:"timing"},{id:"expirationDate",label:"Expiry",width:110,sortable:!0,defaultVisible:!1,type:"date",category:"timing"},{id:"daysToExpiry",label:"DTE",width:80,sortable:!0,defaultVisible:!1,type:"number",category:"timing"},{id:"entryPrice",label:"Entry",width:100,sortable:!1,defaultVisible:!1,type:"currency",category:"prices"},{id:"exitPrice",label:"Exit",width:100,sortable:!1,defaultVisible:!1,type:"currency",category:"prices"},{id:"stopLoss",label:"Stop Loss",width:100,sortable:!1,defaultVisible:!1,type:"currency",category:"prices"},{id:"slDistanceDollar",label:"SL Dist $",width:90,sortable:!1,defaultVisible:!1,type:"currency",category:"risk"},{id:"slDistancePercent",label:"SL Dist %",width:90,sortable:!1,defaultVisible:!1,type:"percentage",category:"risk"},{id:"riskAmount",label:"Risk $",width:90,sortable:!1,defaultVisible:!1,type:"currency",category:"risk"},{id:"rMultiple",label:"R:R",width:70,sortable:!0,defaultVisible:!1,type:"number",category:"risk"},{id:"maePrice",label:"MAE Price",width:100,sortable:!0,defaultVisible:!1,type:"currency",category:"risk"},{id:"mfePrice",label:"MFE Price",width:100,sortable:!0,defaultVisible:!1,type:"currency",category:"risk"},{id:"mae",label:"MAE $",width:90,sortable:!0,defaultVisible:!1,type:"currency",category:"risk"},{id:"mfe",label:"MFE $",width:90,sortable:!0,defaultVisible:!1,type:"currency",category:"risk"},{id:"maePercent",label:"MAE %",width:80,sortable:!0,defaultVisible:!1,type:"percentage",category:"risk"},{id:"mfePercent",label:"MFE %",width:80,sortable:!0,defaultVisible:!1,type:"percentage",category:"risk"},{id:"positionSize",label:"Size #",width:90,sortable:!0,defaultVisible:!1,type:"number",category:"position"},{id:"positionValue",label:"Size $",width:100,sortable:!1,defaultVisible:!1,type:"currency",category:"position"},{id:"fees",label:"Fees",width:80,sortable:!1,defaultVisible:!1,type:"currency",category:"position"},{id:"pnl",label:"Net P&L",width:120,sortable:!0,defaultVisible:!0,type:"currency",category:"position"},{id:"setups",label:"Setups",width:100,sortable:!1,defaultVisible:!0,type:"text",category:"review"},{id:"mistakes",label:"Mistakes",width:100,sortable:!1,defaultVisible:!0,type:"text",category:"review"},{id:"tags",label:"Tags",width:100,sortable:!1,defaultVisible:!0,type:"text",category:"review"},{id:"reviewed",label:"Reviewed",width:100,sortable:!1,defaultVisible:!0,type:"boolean",category:"review"},{id:"thesis",label:"Thesis",width:0,sortable:!1,defaultVisible:!1,type:"text",category:"review"}]});function Pke(e){new VG(e).open()}var Gk,Ske,Et,VG,Q7e,Tke,Cke,Dke=F(()=>{Gk=require("obsidian"),Ske=Y(Ni()),Et=Y(Q());qG();Ay();h0();mh();Ot();_B();Tr();vI();VG=class extends Gk.Modal{constructor(r){super(r.app);this.root=null;this.props=r}onOpen(){let{contentEl:r}=this;r.empty(),r.style.display="flex",r.style.flexDirection="column",r.style.minHeight="500px",r.style.maxHeight="80vh",_I(),this.container=r.createDiv(),this.renderComponent()}onClose(){this.root&&(this.root.unmount(),this.root=null),oee(),this.props.onClose()}renderComponent(){this.root=(0,Ske.createRoot)(this.container),this.root.render(Et.default.createElement(Q7e,{...this.props,onModalClose:()=>this.close()}))}},Q7e=({app:e,plugin:t,onSave:r,onModalClose:n})=>{let[i,a]=(0,Et.useState)(()=>{let C=t.uiStateManager.getState().tradeLog||{columnVisibility:{},columnOrder:[]},D=C.columnVisibility||{},P=C.columnOrder||[],M=tx.filter(z=>z.id!=="select").map(z=>{var A;return{...z,visible:(A=D[z.id])!=null?A:z.defaultVisible}});if(P.length>0){let z=P.map(I=>M.find(L=>L.id===I)).filter(I=>I!==void 0),A=M.filter(I=>!P.includes(I.id));return[...z,...A]}return M}),[o,s]=(0,Et.useState)("active"),[l,c]=(0,Et.useState)(new Set(HG.map(C=>C.id))),[d,u]=(0,Et.useState)(!1),[p,m]=(0,Et.useState)(()=>{var C,D;return(D=(C=t.uiStateManager.getState().tradeLog)==null?void 0:C.expandedMode)!=null?D:!1}),g=(0,Et.useMemo)(()=>i.filter(C=>C.visible),[i]),f=(0,Et.useMemo)(()=>i.filter(C=>!C.visible),[i]),v=(0,Et.useMemo)(()=>{let C={basic:[],timing:[],prices:[],risk:[],position:[],review:[]};return f.forEach(D=>{C[D.category].push(D)}),C},[f]),h=(0,Et.useCallback)(C=>{let{active:D,over:P}=C;!P||D.id===P.id||a(M=>{let z=M.filter($=>$.visible),A=M.filter($=>!$.visible),I=z.findIndex($=>$.id===D.id),L=z.findIndex($=>$.id===P.id);if(I===-1||L===-1)return M;let E=[...z],[T]=E.splice(I,1);return E.splice(L,0,T),[...E,...A]})},[]),y=(0,Et.useCallback)(C=>{a(D=>{let P=D.map(L=>L.id===C?{...L,visible:!0}:L),M=P.filter(L=>L.visible),z=P.filter(L=>!L.visible),A=M.find(L=>L.id===C),I=M.filter(L=>L.id!==C);return A?[...I,A,...z]:P})},[]),b=(0,Et.useCallback)(C=>{a(D=>D.filter(M=>M.visible).length<=1?(new Gk.Notice("At least one column must remain visible"),D):D.map(M=>M.id===C?{...M,visible:!1}:M))},[]),k=(0,Et.useCallback)(C=>{c(D=>{let P=new Set(D);return P.has(C)?P.delete(C):P.add(C),P})},[]),x=(0,Et.useCallback)(async()=>{try{u(!0);let C={},D=[];i.forEach(M=>{C[M.id]=M.visible,D.push(M.id)});let P=t.uiStateManager.getState().tradeLog;await t.uiStateManager.updateState({tradeLog:{columnVisibility:C,columnOrder:D,columnWidths:(P==null?void 0:P.columnWidths)||{},expandedMode:p}}),xe.publish("settings:changed",{component:"tradeLog",settings:t.settings.tradeLog}),new Gk.Notice("TradeLog settings saved successfully"),r(),n()}catch(C){console.error("Error saving TradeLog settings:",C),new Gk.Notice(`Error saving settings: ${C.message}`)}finally{u(!1)}},[i,p,t,r,n]),S=(0,Et.useCallback)(()=>{n()},[n]),w=(0,Et.useCallback)(()=>{let C=tx.filter(D=>D.id!=="select").map(D=>({...D,visible:D.defaultVisible}));a(C)},[]);return Et.default.createElement("div",{className:"tradelog-settings-modal-container"},Et.default.createElement("nav",{className:"journalit-tab-nav"},Et.default.createElement("div",{className:"journalit-tab-wrapper"},Et.default.createElement("button",{type:"button",className:`journalit-tab-button ${o==="active"?"journalit-tab-active":""}`,onClick:()=>s("active")},"Active Columns",Et.default.createElement("span",{className:"journalit-tab-count"},g.length)),Et.default.createElement("button",{type:"button",className:`journalit-tab-button ${o==="available"?"journalit-tab-active":""}`,onClick:()=>s("available")},"Available Columns",Et.default.createElement("span",{className:"journalit-tab-count"},f.length)))),Et.default.createElement("div",{className:"tradelog-settings-modal-content"},o==="active"?Et.default.createElement("div",{className:"tradelog-settings-panel"},Et.default.createElement("div",{className:"panel-description"},"Drag to reorder columns. Click X to remove."),Et.default.createElement(jd,{collisionDetection:zd,onDragEnd:h},Et.default.createElement(_d,{items:g.map(C=>C.id),strategy:gh},g.map(C=>Et.default.createElement(Tke,{key:C.id,column:C,onRemove:b,canRemove:g.length>1})))),g.length===0&&Et.default.createElement("div",{className:"empty-panel-message"},"No active columns. Add columns from the Available tab.")):Et.default.createElement("div",{className:"tradelog-settings-panel available-panel"},Et.default.createElement("div",{className:"panel-description"},"Click a column to add it to your table."),HG.map(C=>{let D=v[C.id];if(D.length===0)return null;let P=l.has(C.id);return Et.default.createElement("div",{key:C.id,className:"column-category"},Et.default.createElement("button",{className:"category-header",onClick:()=>k(C.id)},P?Et.default.createElement(cs,{size:16}):Et.default.createElement(Nu,{size:16}),Et.default.createElement("span",{className:"category-label"},C.label),Et.default.createElement("span",{className:"category-count"},D.length)),P&&Et.default.createElement("div",{className:"category-columns"},D.map(M=>Et.default.createElement(Cke,{key:M.id,column:M,onAdd:y}))))}),f.length===0&&Et.default.createElement("div",{className:"empty-panel-message"},"All columns are active."))),Et.default.createElement("div",{className:"tradelog-settings-display-mode"},Et.default.createElement("div",{className:"display-mode-label"},Et.default.createElement("span",{className:"display-mode-title"},"Expanded View"),Et.default.createElement("span",{className:"display-mode-description"},"Show tags, setups, and mistakes as pill badges")),Et.default.createElement(la,{checked:p,onChange:m,ariaLabel:"Toggle expanded view mode"})),Et.default.createElement("div",{className:"tradelog-settings-modal-buttons"},Et.default.createElement("button",{onClick:w,disabled:d,className:"reset-button"},"Reset to Defaults"),Et.default.createElement("button",{onClick:S,disabled:d},"Cancel"),Et.default.createElement("button",{onClick:x,disabled:d,className:"primary"},d?"Saving...":"Save")))},Tke=Et.default.memo(({column:e,onRemove:t,canRemove:r})=>{let{attributes:n,listeners:i,setNodeRef:a,transform:o,transition:s,isDragging:l}=Vp({id:e.id}),c={transform:al.Transform.toString(o),transition:l?s:void 0,opacity:l?.5:1};return Et.default.createElement("div",{ref:a,style:c,className:`active-column-item ${l?"dragging":""}`},Et.default.createElement("div",{className:"column-drag-handle",...n,...i},Et.default.createElement(uT,{size:16})),Et.default.createElement("div",{className:"column-label"},e.label),Et.default.createElement("button",{className:"column-remove-btn",onClick:()=>t(e.id),disabled:!r},"\xD7"))});Tke.displayName="SortableActiveColumnItem";Cke=Et.default.memo(({column:e,onAdd:t})=>Et.default.createElement("div",{className:"available-column-item"},Et.default.createElement("div",{className:"column-label"},e.label),Et.default.createElement("button",{className:"column-add-btn",onClick:()=>t(e.id)},Et.default.createElement(Ui,{size:14}))));Cke.displayName="AvailableColumnItem"});var Bn,Bz,Eke=F(()=>{Bn=Y(Q());r1();XB();i0();sM();UG();Dke();Ot();Bz=(0,Bn.memo)(({app:e,plugin:t,filters:r,onFilterChange:n,onSettingsChange:i,isMultiSelectMode:a,onToggleMultiSelectMode:o})=>{let[s,l]=(0,Bn.useState)([]),c=(0,Bn.useRef)(null);c.current||(c.current=new ex(t));let d=c.current;(0,Bn.useEffect)(()=>((async()=>{if(d){let f=await d.getUniqueAccounts();l(f)}})(),()=>{c.current&&c.current.destroy()}),[d]);let u=()=>{let g=0;return r.tradeTypes&&r.tradeTypes.length>0&&r.tradeTypes.length<3&&g++,r.statuses&&r.statuses.length>0&&r.statuses.length<4&&g++,r.accounts&&r.accounts.length>0&&g++,r.tickers&&r.tickers.length>0&&g++,r.setups&&r.setups.length>0&&g++,r.tags&&r.tags.length>0&&g++,g},p=(0,Bn.useCallback)(()=>{fy({app:e,plugin:t,context:"tradelog",currentFilters:{accounts:r.accounts||[],tickers:r.tickers||[],setups:r.setups||[],tags:r.tags||[],tradeTypes:r.tradeTypes||[],statuses:r.statuses||[]},availableAccounts:s,onApply:g=>{n({tradeTypes:g.tradeTypes,statuses:g.statuses,accounts:g.accounts,tickers:g.tickers,setups:g.setups,tags:g.tags})},onClose:()=>{}})},[e,t,r,n,s]),m=(0,Bn.useCallback)(()=>{Pke({app:e,plugin:t,onSave:()=>{i()},onClose:()=>{}})},[e,t,i]);return Bn.default.createElement("div",{className:"trade-log-header"},Bn.default.createElement("div",{className:"trade-log-controls"},Bn.default.createElement("div",{className:"trade-log-view-selector"},Bn.default.createElement("label",null,"View:"),Bn.default.createElement("select",{value:r.viewLevel,onChange:g=>n({viewLevel:g.target.value}),className:"trade-log-view-dropdown"},Bn.default.createElement("option",{value:"trades"},"Trades"),Bn.default.createElement("option",{value:"years"},"Years"),Bn.default.createElement("option",{value:"quarters"},"Quarters"),Bn.default.createElement("option",{value:"months"},"Months"),Bn.default.createElement("option",{value:"weeks"},"Weeks"),Bn.default.createElement("option",{value:"days"},"Days"))),Bn.default.createElement(e1,{dateRange:r.dateRange,onChange:g=>n({dateRange:g})}),Bn.default.createElement("div",{className:"trade-log-filter-actions"},Bn.default.createElement(dh,{onClick:p,activeFilterCount:u()}),r.viewLevel==="trades"&&Bn.default.createElement("div",{className:"journalit-filter-button-container"},Bn.default.createElement("button",{className:`journalit-filter-button clickable-icon ${a?"active":""}`,onClick:o,"aria-label":a?"Disable multi-select":"Enable multi-select"},a?Bn.default.createElement(Mp,{size:16}):Bn.default.createElement(wT,{size:16}))),Bn.default.createElement("div",{className:"journalit-filter-button-container"},Bn.default.createElement("button",{className:"journalit-filter-button clickable-icon",onClick:m,"aria-label":"Column settings"},Bn.default.createElement(bT,{size:16}))))))});Bz.displayName="TradeLogHeader"});var Mke=Fe(Wz=>{"use strict";var X7e=Q(),Z7e=Symbol.for("react.element"),eKe=Symbol.for("react.fragment"),tKe=Object.prototype.hasOwnProperty,rKe=X7e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,nKe={key:!0,ref:!0,__self:!0,__source:!0};function Ike(e,t,r){var n,i={},a=null,o=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)tKe.call(t,n)&&!nKe.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:Z7e,type:e,key:a,ref:o,props:i,_owner:rKe.current}}Wz.Fragment=eKe;Wz.jsx=Ike;Wz.jsxs=Ike});var Lke=Fe((Asr,Ake)=>{"use strict";Ake.exports=Mke()});function Nke(e){if(e!==void 0)switch(typeof e){case"number":return e;case"string":{if(e.endsWith("px"))return parseFloat(e);break}}}function iKe({box:e,defaultHeight:t,defaultWidth:r,disabled:n,element:i,mode:a,style:o}){let{styleHeight:s,styleWidth:l}=(0,Wn.useMemo)(()=>({styleHeight:Nke(o==null?void 0:o.height),styleWidth:Nke(o==null?void 0:o.width)}),[o==null?void 0:o.height,o==null?void 0:o.width]),[c,d]=(0,Wn.useState)({height:t,width:r}),u=n||a==="only-height"&&s!==void 0||a==="only-width"&&l!==void 0||s!==void 0&&l!==void 0;return mD(()=>{if(i===null||u)return;let p=new ResizeObserver(m=>{for(let g of m){let{contentRect:f,target:v}=g;i===v&&d(h=>h.height===f.height&&h.width===f.width?h:{height:f.height,width:f.width})}});return p.observe(i,{box:e}),()=>{p==null||p.unobserve(i)}},[e,u,i,s,l]),(0,Wn.useMemo)(()=>({height:s!=null?s:c.height,width:l!=null?l:c.width}),[c,s,l])}function aKe(e){let t=(0,Wn.useRef)(()=>{throw new Error("Cannot call during render.")});return mD(()=>{t.current=e},[e]),(0,Wn.useCallback)(r=>{var n;return(n=t.current)==null?void 0:n.call(t,r)},[t])}function oKe(e=!1){if(Yk===null||e){let t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",r.direction="rtl";let n=document.createElement("div"),i=n.style;return i.width="100px",i.height="100px",t.appendChild(n),document.body.appendChild(t),t.scrollLeft>0?Yk="positive-descending":(t.scrollLeft=1,t.scrollLeft===0?Yk="negative":Yk="positive-ascending"),document.body.removeChild(t),Yk}return Yk}function GG({containerElement:e,direction:t,isRtl:r,scrollOffset:n}){if(t==="horizontal"&&r)switch(oKe()){case"negative":return-n;case"positive-descending":{if(e){let{clientWidth:i,scrollLeft:a,scrollWidth:o}=e;return o-i-a}break}}return n}function hv(e,t="Assertion error"){if(!e)throw console.error(t),Error(t)}function pD(e,t){if(e===t)return!0;if(!!e!=!!t||(hv(e!==void 0),hv(t!==void 0),Object.keys(e).length!==Object.keys(t).length))return!1;for(let r in e)if(!Object.is(t[r],e[r]))return!1;return!0}function zke({cachedBounds:e,itemCount:t,itemSize:r}){if(t===0)return 0;if(typeof r=="number")return t*r;{let n=e.get(e.size===0?0:e.size-1);hv(n!==void 0,"Unexpected bounds cache miss");let i=(n.scrollOffset+n.size)/e.size;return t*i}}function sKe({align:e,cachedBounds:t,index:r,itemCount:n,itemSize:i,containerScrollOffset:a,containerSize:o}){if(r<0||r>=n)throw RangeError(`Invalid index specified: ${r}`,{cause:`Index ${r} is not within the range of 0 - ${n-1}`});let s=zke({cachedBounds:t,itemCount:n,itemSize:i}),l=t.get(r),c=Math.max(0,Math.min(s-o,l.scrollOffset)),d=Math.max(0,l.scrollOffset-o+l.size);switch(e==="smart"&&(a>=d&&a<=c?e="auto":e="center"),e){case"start":return c;case"end":return d;case"center":return l.scrollOffset<=o/2?0:l.scrollOffset+l.size/2>=s-o/2?s-o:l.scrollOffset+l.size/2-o/2;default:return a>=d&&a<=c?a:a<d?d:c}}function Fke({cachedBounds:e,containerScrollOffset:t,containerSize:r,itemCount:n,overscanCount:i}){let a=n-1,o=0,s=-1,l=0,c=-1,d=0;for(;d<a;){let u=e.get(d);if(u.scrollOffset+u.size>t)break;d++}for(o=d,l=Math.max(0,o-i);d<a;){let u=e.get(d);if(u.scrollOffset+u.size>=t+r)break;d++}return s=Math.min(a,d),c=Math.min(n-1,s+i),o<0&&(o=0,s=-1,l=0,c=-1),{startIndexVisible:o,stopIndexVisible:s,startIndexOverscan:l,stopIndexOverscan:c}}function lKe({itemCount:e,itemProps:t,itemSize:r}){let n=new Map;return{get(i){for(hv(i<e,`Invalid index ${i}`);n.size-1<i;){let o=n.size,s;switch(typeof r){case"function":{s=r(o,t);break}case"number":{s=r;break}}if(o===0)n.set(o,{size:s,scrollOffset:0});else{let l=n.get(o-1);hv(l!==void 0,`Unexpected bounds cache miss for index ${i}`),n.set(o,{scrollOffset:l.scrollOffset+l.size,size:s})}}let a=n.get(i);return hv(a!==void 0,`Unexpected bounds cache miss for index ${i}`),a},set(i,a){n.set(i,a)},get size(){return n.size}}}function cKe({itemCount:e,itemProps:t,itemSize:r}){return(0,Wn.useMemo)(()=>lKe({itemCount:e,itemProps:t,itemSize:r}),[e,t,r])}function dKe({containerSize:e,itemSize:t}){let r;return typeof t==="string"?(hv(t.endsWith("%"),`Invalid item size: "${t}"; string values must be percentages (e.g. "100%")`),hv(e!==void 0,"Container size must be defined if a percentage item size is specified"),r=e*parseInt(t)/100):r=t,r}function uKe({containerElement:e,containerStyle:t,defaultContainerSize:r=0,direction:n,isRtl:i=!1,itemCount:a,itemProps:o,itemSize:s,onResize:l,overscanCount:c}){let[d,u]=(0,Wn.useState)({startIndexVisible:0,startIndexOverscan:0,stopIndexVisible:-1,stopIndexOverscan:-1}),{startIndexVisible:p,startIndexOverscan:m,stopIndexVisible:g,stopIndexOverscan:f}={startIndexVisible:Math.min(a-1,d.startIndexVisible),startIndexOverscan:Math.min(a-1,d.startIndexOverscan),stopIndexVisible:Math.min(a-1,d.stopIndexVisible),stopIndexOverscan:Math.min(a-1,d.stopIndexOverscan)},{height:v=r,width:h=r}=iKe({defaultHeight:n==="vertical"?r:void 0,defaultWidth:n==="horizontal"?r:void 0,element:e,mode:n==="vertical"?"only-height":"only-width",style:t}),y=(0,Wn.useRef)({height:0,width:0}),b=n==="vertical"?v:h,k=dKe({containerSize:b,itemSize:s});(0,Wn.useLayoutEffect)(()=>{if(typeof l=="function"){let P=y.current;(P.height!==v||P.width!==h)&&(l({height:v,width:h},{...P}),P.height=v,P.width=h)}},[v,l,h]);let x=cKe({itemCount:a,itemProps:o,itemSize:k}),S=(0,Wn.useCallback)(P=>x.get(P),[x]),w=(0,Wn.useCallback)(()=>zke({cachedBounds:x,itemCount:a,itemSize:k}),[x,a,k]),C=(0,Wn.useCallback)(P=>{let M=GG({containerElement:e,direction:n,isRtl:i,scrollOffset:P});return Fke({cachedBounds:x,containerScrollOffset:M,containerSize:b,itemCount:a,overscanCount:c})},[x,e,b,n,i,a,c]);mD(()=>{var M;let P=(M=n==="vertical"?e==null?void 0:e.scrollTop:e==null?void 0:e.scrollLeft)!=null?M:0;u(C(P))},[e,n,C]),mD(()=>{if(!e)return;let P=()=>{u(M=>{let{scrollLeft:z,scrollTop:A}=e,I=GG({containerElement:e,direction:n,isRtl:i,scrollOffset:n==="vertical"?A:z}),L=Fke({cachedBounds:x,containerScrollOffset:I,containerSize:b,itemCount:a,overscanCount:c});return pD(L,M)?M:L})};return e.addEventListener("scroll",P),()=>{e.removeEventListener("scroll",P)}},[x,e,b,n,a,c]);let D=aKe(({align:P="auto",containerScrollOffset:M,index:z})=>{let A=sKe({align:P,cachedBounds:x,containerScrollOffset:M,containerSize:b,index:z,itemCount:a,itemSize:k});if(e){if(A=GG({containerElement:e,direction:n,isRtl:i,scrollOffset:A}),typeof e.scrollTo!="function"){let I=C(A);pD(d,I)||u(I)}return A}});return{getCellBounds:S,getEstimatedSize:w,scrollToIndex:D,startIndexOverscan:m,startIndexVisible:p,stopIndexOverscan:f,stopIndexVisible:g}}function pKe(e){return(0,Wn.useMemo)(()=>e,Object.values(e))}function mKe(e,t){let{ariaAttributes:r,style:n,...i}=e,{ariaAttributes:a,style:o,...s}=t;return pD(r,a)&&pD(n,o)&&pD(i,s)}function fKe(e){return e!=null&&typeof e=="object"&&"getAverageRowHeight"in e&&typeof e.getAverageRowHeight=="function"}function jke({children:e,className:t,defaultHeight:r=0,listRef:n,onResize:i,onRowsRendered:a,overscanCount:o=3,rowComponent:s,rowCount:l,rowHeight:c,rowProps:d,tagName:u="div",style:p,...m}){let g=pKe(d),f=(0,Wn.useMemo)(()=>(0,Wn.memo)(s,mKe),[s]),[v,h]=(0,Wn.useState)(null),y=fKe(c),b=(0,Wn.useMemo)(()=>y?A=>{var I;return(I=c.getRowHeight(A))!=null?I:c.getAverageRowHeight()}:c,[y,c]),{getCellBounds:k,getEstimatedSize:x,scrollToIndex:S,startIndexOverscan:w,startIndexVisible:C,stopIndexOverscan:D,stopIndexVisible:P}=uKe({containerElement:v,containerStyle:p,defaultContainerSize:r,direction:"vertical",itemCount:l,itemProps:g,itemSize:b,onResize:i,overscanCount:o});(0,Wn.useImperativeHandle)(n,()=>({get element(){return v},scrollToRow({align:A="auto",behavior:I="auto",index:L}){var T;let E=S({align:A,containerScrollOffset:(T=v==null?void 0:v.scrollTop)!=null?T:0,index:L});typeof(v==null?void 0:v.scrollTo)=="function"&&v.scrollTo({behavior:I,top:E})}}),[v,S]),mD(()=>{if(!v)return;let A=Array.from(v.children).filter((I,L)=>{if(I.hasAttribute("aria-hidden"))return!1;let E=`${w+L}`;return I.setAttribute(gKe,E),!0});if(y)return c.observeRowElements(A)},[v,y,c,w,D]),(0,Wn.useEffect)(()=>{w>=0&&D>=0&&a&&a({startIndex:C,stopIndex:P},{startIndex:w,stopIndex:D})},[a,w,C,D,P]);let M=(0,Wn.useMemo)(()=>{let A=[];if(l>0)for(let I=w;I<=D;I++){let L=k(I);A.push((0,Wn.createElement)(f,{...g,ariaAttributes:{"aria-posinset":I+1,"aria-setsize":l,role:"listitem"},key:I,index:I,style:{position:"absolute",left:0,transform:`translateY(${L.scrollOffset}px)`,height:y?void 0:L.size,width:"100%"}}))}return A},[f,k,y,l,g,w,D]),z=(0,Oke.jsx)("div",{"aria-hidden":!0,style:{height:x(),width:"100%",zIndex:-1}});return(0,Wn.createElement)(u,{role:"list",...m,className:t,ref:h,style:{position:"relative",maxHeight:"100%",flexGrow:1,overflowY:"auto",...p}},M,e,z)}var Oke,Wn,mD,Yk,gKe,_ke=F(()=>{Oke=Y(Lke(),1),Wn=Y(Q(),1),mD=typeof window<"u"?Wn.useLayoutEffect:Wn.useEffect;Yk=null;gKe="data-react-window-index"});function Bke(e){if(!Number.isFinite(e))return{display:"-",full:"-",needsTooltip:!1};let t=e.toString();if(e>=1e6){let a=e/1e6;return{display:a>=10?`${Math.round(a)}M`:`${a.toFixed(1).replace(/\.0$/,"")}M`,full:t,needsTooltip:!0}}if(e>=1e4){let a=e/1e3;return{display:a>=10?`${Math.round(a)}K`:`${a.toFixed(1).replace(/\.0$/,"")}K`,full:t,needsTooltip:!0}}if(Number.isInteger(e))return{display:e.toLocaleString(),full:t,needsTooltip:!1};let n=parseFloat(e.toFixed(2)).toString();return{display:n,full:t,needsTooltip:t!==n}}var ce,Wke,$ke,Rke,Uke,Hke,qke,YG,KG,Vke=F(()=>{ce=Y(Q());Ot();LV();Ad();ly();Xx();qt();_t();Hp();Jn();Er();nr();Vo();Wke=(0,ce.memo)(({mistakes:e})=>ce.default.createElement("div",{className:"mistakes-tooltip"},ce.default.createElement("div",{className:"tooltip-title"},"Mistakes:"),e.map((t,r)=>ce.default.createElement("div",{key:r,className:"tooltip-item"},"\u2022 ",t))));Wke.displayName="MistakesTooltipContent";$ke=(0,ce.memo)(({setups:e})=>ce.default.createElement("div",{className:"setups-tooltip"},ce.default.createElement("div",{className:"tooltip-title"},"Setups:"),e.map((t,r)=>ce.default.createElement("div",{key:r,className:"tooltip-item"},"\u2022 ",t))));$ke.displayName="SetupsTooltipContent";Rke=(0,ce.memo)(({tags:e})=>ce.default.createElement("div",{className:"custom-tags-tooltip"},ce.default.createElement("div",{className:"tooltip-title"},"Tags:"),e.map((t,r)=>ce.default.createElement("div",{key:r,className:"tooltip-item"},"\u2022 ",t))));Rke.displayName="CustomTagsTooltipContent";Uke=(0,ce.memo)(({thesis:e})=>ce.default.createElement("div",{className:"thesis-tooltip"},ce.default.createElement("div",{className:"tooltip-title"},"Thesis:"),ce.default.createElement("div",{className:"tooltip-content"},e)));Uke.displayName="ThesisTooltipContent";Hke=(0,ce.memo)(({accounts:e})=>ce.default.createElement("div",{className:"accounts-tooltip"},ce.default.createElement("div",{className:"tooltip-title"},"Accounts:"),e.map((t,r)=>ce.default.createElement("div",{key:r,className:"tooltip-item"},"\u2022 ",t))));Hke.displayName="AccountsTooltipContent";qke=(0,ce.memo)(({partialInfo:e,currency:t,assetType:r})=>ce.default.createElement("div",{className:"partial-exit-tooltip"},ce.default.createElement("div",{className:"tooltip-title"},"Partial Exits:"),e.exits.map((n,i)=>ce.default.createElement("div",{key:i,className:"tooltip-item"},"\u2022 ",n.size," @ ",n.price.toFixed(r==="forex"?5:2)," = ",ye(n.pnl,!0,t))),ce.default.createElement("div",{className:"tooltip-item tooltip-remaining"},e.remainingSize," still open")));qke.displayName="PartialExitTooltipContent";YG=(0,ce.memo)(({trade:e,images:t,status:r,duration:n,onImageClick:i,plugin:a,visibleColumns:o,gridTemplate:s,isSelected:l,onToggleSelection:c,isMultiSelectMode:d,isExpandedMode:u})=>{var D,P,M,z,A;let{currency:p}=ct(),m=e.currency||p,g=(P=(D=a==null?void 0:a.settings)==null?void 0:D.trade)==null?void 0:P.defaultRiskAmount,f=(A=(z=(M=a==null?void 0:a.settings)==null?void 0:M.trade)==null?void 0:z.showCopyTradingPnL)!=null?A:!1,v=(0,ce.useCallback)(I=>{I.stopPropagation();let L=e.filePath||e.path;L&&c&&c(L,I)},[e,c]),h=(0,ce.useMemo)(()=>xt(Xg(e),e.rMultiple,e.riskAmount,g),[e,g]),y=(0,ce.useMemo)(()=>{let I=Xg(e);if(!f)return I;let L=rn(e);return tn(I,L,f)},[e,f]),b=(0,ce.useMemo)(()=>e.mistake?Array.isArray(e.mistake)?e.mistake:[e.mistake]:[],[e.mistake]),k=(0,ce.useMemo)(()=>e.setup?Array.isArray(e.setup)?e.setup:[e.setup]:[],[e.setup]),x=(0,ce.useMemo)(()=>!e.tags||!Array.isArray(e.tags)?[]:e.tags.filter(I=>typeof I=="string"&&I.trim()).map(I=>I.trim()),[e.tags]),S=(0,ce.useMemo)(()=>{if(!e.account&&!e.accountIds)return[];let I=e.accountIds||e.account;return Array.isArray(I)?I:[I]},[e.account,e.accountIds]),w=(0,ce.useMemo)(()=>iI(e),[e]),C=(0,ce.useCallback)(I=>{var L,E,T,$,_,B,W;switch(I){case"select":return d?ce.default.createElement("div",{key:"select",className:"trade-select-cell"},ce.default.createElement("input",{type:"checkbox",className:"trade-select-checkbox",checked:l||!1,onChange:v,onClick:j=>j.stopPropagation(),"aria-label":`Select ${e.instrument||"trade"}`})):null;case"image":return ce.default.createElement("div",{key:"image",className:"trade-image-cell"},t.length>0?ce.default.createElement("div",{className:"trade-image-wrapper",onClick:j=>i(j,t[0])},ce.default.createElement("div",{className:"trade-preview-thumbnail"},ce.default.createElement("img",{src:vi.resolveMediaPath(t[0]),alt:"Trade",loading:"lazy",decoding:"async"})),t.length>1&&ce.default.createElement("span",{className:"trade-image-count"},"+",t.length-1)):ce.default.createElement(XO,{size:20,className:"trade-no-image-icon"}));case"ticker":return ce.default.createElement("div",{key:"ticker",className:"trade-ticker-cell"},ce.default.createElement("span",{className:"trade-ticker"},e.instrument),e.performanceIndicator==="best"&&ce.default.createElement(tT,{size:14,className:"performance-badge performance-badge--best"}),e.performanceIndicator==="worst"&&ce.default.createElement(oa,{size:14,className:"performance-badge performance-badge--worst"}));case"direction":return ce.default.createElement("div",{key:"direction",className:"trade-direction-cell"},ce.default.createElement("span",{className:`trade-direction trade-direction--${(L=e.direction)==null?void 0:L.toLowerCase()}`},e.direction));case"status":return ce.default.createElement("div",{key:"status",className:"trade-status-cell"},ce.default.createElement("span",{className:`trade-status ${r.className}`},r.label));case"pnl":{if(r.className==="status-open"&&w.isPartialExit){let j=w.realizedPnL,R=xt(j,void 0,e.riskAmount,g);return ce.default.createElement("div",{key:"pnl",className:"trade-pnl-cell"},ce.default.createElement(pn,{content:ce.default.createElement(qke,{partialInfo:w,currency:m,assetType:e.assetType}),delay:0,preferredPosition:"top"},ce.default.createElement("span",{className:`trade-pnl partial ${j>0?"positive":j<0?"negative":"neutral"}`},ye(j,!0,m,(E=a==null?void 0:a.settings.trade)==null?void 0:E.displayRMultiples,R),"*")))}return r.className==="status-open"?ce.default.createElement("div",{key:"pnl",className:"trade-pnl-cell"},ce.default.createElement("span",{className:"trade-pnl open"},"-")):ce.default.createElement("div",{key:"pnl",className:"trade-pnl-cell"},ce.default.createElement("span",{className:`trade-pnl ${y>0?"positive":y<0?"negative":"neutral"}`},ye(y,!0,m,(T=a==null?void 0:a.settings.trade)==null?void 0:T.displayRMultiples,h)))}case"duration":return ce.default.createElement("div",{key:"duration",className:"trade-duration-cell"},ce.default.createElement("span",{className:"trade-duration"},n));case"date":return ce.default.createElement("div",{key:"date",className:"trade-date-cell"},ce.default.createElement("span",{className:"trade-date"},zt(dn(e.entryTime))));case"account":{if(S.length===0)return ce.default.createElement("div",{key:"account",className:"trade-account-cell"},ce.default.createElement("span",{className:"trade-no-data"},"-"));if(S.length===1){let j=S[0],R=8,O=j.length>R,H=O?j.substring(0,R)+"...":j,q=ce.default.createElement("span",{className:"trade-account-text"},H);return ce.default.createElement("div",{key:"account",className:"trade-account-cell"},O?ce.default.createElement(pn,{content:j,delay:0,preferredPosition:"top"},q):q)}return ce.default.createElement("div",{key:"account",className:"trade-account-cell"},ce.default.createElement(pn,{content:ce.default.createElement(Hke,{accounts:S}),delay:0,preferredPosition:"top"},ce.default.createElement("div",{className:"trade-account-icon-wrapper"},ce.default.createElement(af,{size:20,className:"trade-account-icon"}),ce.default.createElement("span",{className:"trade-account-count-badge"},S.length))))}case"reviewed":return ce.default.createElement("div",{key:"reviewed",className:"trade-reviewed-cell"},e.reviewed?ce.default.createElement(Aa,{size:16,className:"trade-reviewed-icon trade-reviewed-icon--yes"}):ce.default.createElement(Xm,{size:16,className:"trade-reviewed-icon trade-reviewed-icon--no"}));case"positionSize":{if(r.className==="status-open"&&w.isPartialExit){let j=Bke(w.closedSize),R=Bke(w.totalSize),O=j.needsTooltip||R.needsTooltip,H=`${j.display}/${R.display}`,q=`${j.full}/${R.full}`;return O?ce.default.createElement("div",{key:"positionSize",className:"trade-position-size-cell"},ce.default.createElement(pn,{content:q,delay:0,preferredPosition:"top"},ce.default.createElement("span",{className:"trade-position-size partial"},H))):ce.default.createElement("div",{key:"positionSize",className:"trade-position-size-cell"},ce.default.createElement("span",{className:"trade-position-size partial"},H))}return ce.default.createElement("div",{key:"positionSize",className:"trade-position-size-cell"},ce.default.createElement("span",{className:"trade-position-size"},e.positionSize?e.positionSize.toLocaleString():"-"))}case"expirationDate":return e.assetType!=="options"||!e.expirationDate?ce.default.createElement("div",{key:"expirationDate",className:"trade-expiration-date-cell"},ce.default.createElement("span",{className:"trade-no-data"},"-")):ce.default.createElement("div",{key:"expirationDate",className:"trade-expiration-date-cell"},ce.default.createElement("span",{className:"trade-expiration-date"},zt(dn(e.expirationDate))));case"daysToExpiry":if(e.assetType!=="options"||!e.expirationDate)return ce.default.createElement("div",{key:"daysToExpiry",className:"trade-dte-cell"},ce.default.createElement("span",{className:"trade-no-data"},"-"));let N=DT(e.expirationDate);if(N===null)return ce.default.createElement("div",{key:"daysToExpiry",className:"trade-dte-cell"},ce.default.createElement("span",{className:"trade-no-data"},"-"));if(N<0)return ce.default.createElement("div",{key:"daysToExpiry",className:"trade-dte-cell"},ce.default.createElement("span",{className:"trade-dte-expired"},"EXPIRED"));let U=N>=7?"green":N>=3?"yellow":"red";return ce.default.createElement("div",{key:"daysToExpiry",className:"trade-dte-cell"},ce.default.createElement("div",{className:`trade-dte-circle trade-dte-circle--${U}`},ce.default.createElement("span",{className:"trade-dte-number"},N)));case"mistakes":return b.length===0?ce.default.createElement("div",{key:"mistakes",className:"trade-mistakes-cell"},ce.default.createElement("span",{className:"trade-no-data"},"-")):u?ce.default.createElement("div",{key:"mistakes",className:"trade-mistakes-cell expanded"},ce.default.createElement("div",{className:"expanded-pills"},b.map((j,R)=>ce.default.createElement("span",{key:R,className:"pill pill--mistake"},j)))):ce.default.createElement("div",{key:"mistakes",className:"trade-mistakes-cell"},ce.default.createElement(pn,{content:ce.default.createElement(Wke,{mistakes:b}),delay:0,preferredPosition:"top"},ce.default.createElement("span",{className:"count-badge count-badge--mistakes"},b.length)));case"setups":return k.length===0?ce.default.createElement("div",{key:"setups",className:"trade-setups-cell"},ce.default.createElement("span",{className:"trade-no-data"},"-")):u?ce.default.createElement("div",{key:"setups",className:"trade-setups-cell expanded"},ce.default.createElement("div",{className:"expanded-pills"},k.map((j,R)=>ce.default.createElement("span",{key:R,className:"pill pill--setup"},j)))):ce.default.createElement("div",{key:"setups",className:"trade-setups-cell"},ce.default.createElement(pn,{content:ce.default.createElement($ke,{setups:k}),delay:0,preferredPosition:"top"},ce.default.createElement("span",{className:"count-badge count-badge--setups"},k.length)));case"tags":return x.length===0?ce.default.createElement("div",{key:"tags",className:"trade-tags-cell"},ce.default.createElement("span",{className:"trade-no-data"},"-")):u?ce.default.createElement("div",{key:"tags",className:"trade-tags-cell expanded"},ce.default.createElement("div",{className:"expanded-pills"},x.map((j,R)=>ce.default.createElement("span",{key:R,className:"pill pill--tag"},j)))):ce.default.createElement("div",{key:"tags",className:"trade-tags-cell"},ce.default.createElement(pn,{content:ce.default.createElement(Rke,{tags:x}),delay:0,preferredPosition:"top"},ce.default.createElement("div",{className:"trade-tags-icon-wrapper"},ce.default.createElement(nf,{size:20,className:"trade-tags-icon"}),ce.default.createElement("span",{className:"trade-tags-count-badge"},x.length))));case"thesis":return ce.default.createElement("div",{key:"thesis",className:"trade-thesis-cell"},e.thesis?ce.default.createElement(pn,{content:ce.default.createElement(Uke,{thesis:e.thesis}),delay:0,preferredPosition:"top"},ce.default.createElement("span",{className:"trade-thesis"},e.thesis.length>40?e.thesis.substring(0,40)+"...":e.thesis)):ce.default.createElement("span",{className:"trade-no-data"},"-"));case"exchange":{let j=e.exchange||e.cryptoExchange;return ce.default.createElement("div",{key:"exchange",className:"trade-exchange-cell"},j?ce.default.createElement("span",{className:"trade-exchange"},j):ce.default.createElement("span",{className:"trade-no-data"},"-"))}case"exitDate":return ce.default.createElement("div",{key:"exitDate",className:"trade-exit-date-cell"},e.exitTime?ce.default.createElement("span",{className:"trade-exit-date"},zt(dn(e.exitTime))):ce.default.createElement("span",{className:"trade-no-data"},"-"));case"entryPrice":{let j=wX(e);return ce.default.createElement("div",{key:"entryPrice",className:"trade-entry-price-cell"},j?ce.default.createElement("span",{className:"trade-entry-price"},j.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:e.assetType==="forex"?5:2})):ce.default.createElement("span",{className:"trade-no-data"},"-"))}case"exitPrice":{let j=kX(e);return ce.default.createElement("div",{key:"exitPrice",className:"trade-exit-price-cell"},j?ce.default.createElement("span",{className:"trade-exit-price"},j.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:e.assetType==="forex"?5:2})):ce.default.createElement("span",{className:"trade-no-data"},"-"))}case"entryTime":{let j=SX(e);return ce.default.createElement("div",{key:"entryTime",className:"trade-entry-time-cell"},j?ce.default.createElement("span",{className:"trade-entry-time"},j.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})):ce.default.createElement("span",{className:"trade-no-data"},"-"))}case"exitTime":{let j=IT(e);return ce.default.createElement("div",{key:"exitTime",className:"trade-exit-time-cell"},j?ce.default.createElement("span",{className:"trade-exit-time"},j.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",hour12:!1})):ce.default.createElement("span",{className:"trade-no-data"},"-"))}case"stopLoss":return ce.default.createElement("div",{key:"stopLoss",className:"trade-stop-loss-cell"},e.stopLoss?ce.default.createElement("span",{className:"trade-stop-loss"},e.stopLoss.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:e.assetType==="forex"?5:2})):ce.default.createElement("span",{className:"trade-no-data"},"-"));case"slDistanceDollar":{if(!e.stopLoss||!e.entryPrice)return ce.default.createElement("div",{key:"slDistanceDollar",className:"trade-sl-distance-cell"},ce.default.createElement("span",{className:"trade-no-data"},"-"));let j=Math.abs(e.entryPrice-e.stopLoss);return ce.default.createElement("div",{key:"slDistanceDollar",className:"trade-sl-distance-cell"},ce.default.createElement("span",{className:"trade-sl-distance"},ye(j,!1,m)))}case"slDistancePercent":{if(!e.stopLoss||!e.entryPrice||e.entryPrice===0)return ce.default.createElement("div",{key:"slDistancePercent",className:"trade-sl-distance-percent-cell"},ce.default.createElement("span",{className:"trade-no-data"},"-"));let j=Math.abs((e.entryPrice-e.stopLoss)/e.entryPrice)*100;return ce.default.createElement("div",{key:"slDistancePercent",className:"trade-sl-distance-percent-cell"},ce.default.createElement("span",{className:"trade-sl-distance-percent"},j.toFixed(2),"%"))}case"riskAmount":return ce.default.createElement("div",{key:"riskAmount",className:"trade-risk-amount-cell"},e.riskAmount?ce.default.createElement("span",{className:"trade-risk-amount"},ye(e.riskAmount,!1,m)):ce.default.createElement("span",{className:"trade-no-data"},"-"));case"rMultiple":return ce.default.createElement("div",{key:"rMultiple",className:"trade-r-multiple-cell"},h?ce.default.createElement("span",{className:`trade-r-multiple ${h>0?"positive":h<0?"negative":""}`},h>0?"+":"",h.toFixed(2),"R"):ce.default.createElement("span",{className:"trade-no-data"},"-"));case"positionValue":{if(!e.positionSize||!e.entryPrice)return ce.default.createElement("div",{key:"positionValue",className:"trade-position-value-cell"},ce.default.createElement("span",{className:"trade-no-data"},"-"));let j=e.positionSize*e.entryPrice;return ce.default.createElement("div",{key:"positionValue",className:"trade-position-value-cell"},ce.default.createElement("span",{className:"trade-position-value"},ye(j,!1,m)))}case"fees":{let j=(e.fees||0)+(e.commission||0)+(e.swap||0);return ce.default.createElement("div",{key:"fees",className:"trade-fees-cell"},j!==0?ce.default.createElement("span",{className:"trade-fees"},ye(j,!1,m)):ce.default.createElement("span",{className:"trade-no-data"},"-"))}case"maePrice":return ce.default.createElement("div",{key:"maePrice",className:"trade-mae-price-cell"},e.maePrice!==void 0?ce.default.createElement("span",{className:"trade-mae-price"},e.maePrice.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:e.assetType==="forex"?5:2})):ce.default.createElement("span",{className:"trade-no-data"},"-"));case"mfePrice":return ce.default.createElement("div",{key:"mfePrice",className:"trade-mfe-price-cell"},e.mfePrice!==void 0?ce.default.createElement("span",{className:"trade-mfe-price"},e.mfePrice.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:e.assetType==="forex"?5:2})):ce.default.createElement("span",{className:"trade-no-data"},"-"));case"mae":{let j=e.mae;if(j===void 0&&e.maePrice!==void 0&&e.entryPrice&&e.positionSize){let R=($=e.direction)==null?void 0:$.toUpperCase();j=(R==="SELL"||R==="SHORT"?e.entryPrice-e.maePrice:e.maePrice-e.entryPrice)*e.positionSize}return ce.default.createElement("div",{key:"mae",className:"trade-mae-cell"},j!==void 0?ce.default.createElement("span",{className:"trade-mae"},ye(j,!1,m)):ce.default.createElement("span",{className:"trade-no-data"},"-"))}case"mfe":{let j=e.mfe;if(j===void 0&&e.mfePrice!==void 0&&e.entryPrice&&e.positionSize){let R=(_=e.direction)==null?void 0:_.toUpperCase();j=(R==="SELL"||R==="SHORT"?e.entryPrice-e.mfePrice:e.mfePrice-e.entryPrice)*e.positionSize}return ce.default.createElement("div",{key:"mfe",className:"trade-mfe-cell"},j!==void 0?ce.default.createElement("span",{className:"trade-mfe"},ye(j,!1,m)):ce.default.createElement("span",{className:"trade-no-data"},"-"))}case"maePercent":{let j;if(e.maePrice!==void 0&&e.entryPrice&&e.entryPrice!==0){let R=(B=e.direction)==null?void 0:B.toUpperCase();j=(R==="SELL"||R==="SHORT"?e.entryPrice-e.maePrice:e.maePrice-e.entryPrice)/e.entryPrice*100}else e.mae!==void 0&&e.entryPrice&&e.positionSize&&e.positionSize!==0&&(j=e.mae/(e.entryPrice*e.positionSize)*100);return j===void 0?ce.default.createElement("div",{key:"maePercent",className:"trade-mae-percent-cell"},ce.default.createElement("span",{className:"trade-no-data"},"-")):ce.default.createElement("div",{key:"maePercent",className:"trade-mae-percent-cell"},ce.default.createElement("span",{className:"trade-mae-percent"},j.toFixed(2),"%"))}case"mfePercent":{let j;if(e.mfePrice!==void 0&&e.entryPrice&&e.entryPrice!==0){let R=(W=e.direction)==null?void 0:W.toUpperCase();j=(R==="SELL"||R==="SHORT"?e.entryPrice-e.mfePrice:e.mfePrice-e.entryPrice)/e.entryPrice*100}else e.mfe!==void 0&&e.entryPrice&&e.positionSize&&e.positionSize!==0&&(j=e.mfe/(e.entryPrice*e.positionSize)*100);return j===void 0?ce.default.createElement("div",{key:"mfePercent",className:"trade-mfe-percent-cell"},ce.default.createElement("span",{className:"trade-no-data"},"-")):ce.default.createElement("div",{key:"mfePercent",className:"trade-mfe-percent-cell"},ce.default.createElement("span",{className:"trade-mfe-percent"},j.toFixed(2),"%"))}default:return null}},[e,t,r,y,m,a,h,S,b,k,x,n,i,d,l,v,w,u]);return ce.default.createElement(ce.default.Fragment,null,o&&o.length>0?o.map(I=>C(I.id)):ce.default.createElement("span",{className:"trade-no-data"},"No columns configured"))});YG.displayName="TradeDetailsContent";KG=(0,ce.memo)(({trade:e,depth:t,isLastChild:r=!1,onClick:n,viewLevel:i,visibleColumns:a,gridTemplate:o,isSelected:s,onToggleSelection:l,isMultiSelectMode:c,isExpandedMode:d})=>{let u=Ae(),[p,m]=(0,ce.useState)(!1),[g,f]=(0,ce.useState)(0),v=(0,ce.useMemo)(()=>{switch(Ml(e,u==null?void 0:u.settings.trade)){case"backtest":return{label:"BACKTEST",className:"status-backtest"};case"missed":return{label:"MISSED",className:"status-missed"};case"open":return{label:"OPEN",className:"status-open"};case"win":return{label:"WIN",className:"status-win"};case"loss":return{label:"LOSS",className:"status-loss"};default:return{label:"BREAKEVEN",className:"status-breakeven"}}},[e.pnl,e.isMissedTrade,e.isBacktestTrade,e.tradeStatus,e.exitTime,e.useDirectPnLInput,e.exits,u==null?void 0:u.settings.trade]),h=(0,ce.useMemo)(()=>{if(!e.entryTime)return"N/A";if(e.tradeStatus==="OPEN"||yt({tradeStatus:e.tradeStatus,exitTime:e.exitTime,pnl:e.pnl,useDirectPnLInput:e.useDirectPnLInput,exits:e.exits,entries:e.entries})){let z=Zi(e.entryTime);if(!z)return"N/A";let I=new Date().getTime()-z;return MT(I)+" (ongoing)"}let D=Zi(e.entryTime),P=Zi(e.exitTime);if(!D||!P)return"N/A";let M=P-D;return MT(M)},[e.entryTime,e.exitTime,e.tradeStatus,e.pnl,e.useDirectPnLInput,e.exits]),y=(0,ce.useMemo)(()=>{let C=[];try{if(e.images){if(Array.isArray(e.images))C=e.images.map(D=>String(D).trim().replace(/['"`]/g,""));else if(typeof e.images=="string"){let D=JSON.parse(e.images);Array.isArray(D)&&(C=D.map(P=>String(P).trim().replace(/['"`]/g,"")))}}}catch(D){}return C},[e]),b=(0,ce.useCallback)((C,D)=>{C.stopPropagation();let P=y.indexOf(D);f(P>=0?P:0),m(!0)},[y]),k=(0,ce.useCallback)(()=>{m(!1)},[]),x=(0,ce.useCallback)(C=>{C>=0&&C<y.length&&f(C)},[y.length]),S=(0,ce.useCallback)(C=>{C.stopPropagation();let D=e.filePath||e.path;D&&l&&l(D,C)},[e,l]),w=(0,ce.useMemo)(()=>{if(!(y.length<=1))return{images:y,currentIndex:g,onNavigate:x,altPrefix:`${e.instrument} Image`,useResolveMediaPath:!0}},[y,g,x,e.instrument]);return ce.default.createElement(ce.default.Fragment,null,ce.default.createElement("div",{className:`trade-log-node trade-log-node--trade ${r?"is-last-child":""} ${i==="trades"?"trades-view":""}`,onClick:c?S:n},i!=="trades"&&ce.default.createElement("div",{className:"tree-structure",style:{width:`${t*24}px`}},Array.from({length:t}).map((C,D)=>ce.default.createElement("span",{key:D,className:`tree-level ${D===t-1&&r?"last-level":""}`}))),i==="trades"?ce.default.createElement("div",{className:"trade-details-row trades-view-row",style:{gridTemplateColumns:o}},ce.default.createElement(YG,{trade:e,images:y,status:v,duration:h,onImageClick:b,plugin:u,visibleColumns:a,gridTemplate:o,isSelected:s,onToggleSelection:l,isMultiSelectMode:c,isExpandedMode:d})):ce.default.createElement("div",{className:"trade-details-row tree-view-row",style:{gridTemplateColumns:o}},ce.default.createElement("div",{className:"tree-indicator-cell"},t>0&&ce.default.createElement("span",{className:"tree-connector tree-connector--trade"}),ce.default.createElement("span",{className:"tree-leaf-node tree-leaf-node--trade"})),ce.default.createElement(YG,{trade:e,images:y,status:v,duration:h,onImageClick:b,plugin:u,visibleColumns:a,gridTemplate:o,isExpandedMode:d,isSelected:s,onToggleSelection:l,isMultiSelectMode:c}))),p&&y.length>0&&ce.default.createElement(_p,{isOpen:p,onClose:k,title:`${e.instrument} - ${zt(dn(e.entryTime),"DDMMYY"," ")}`,portalId:"trade-log-image-portal"},ce.default.createElement(pf,{imagePath:y[g],alt:`${e.instrument} Image ${g+1}`,useResolveMediaPath:!0,navigationContext:w,onClose:k})))});KG.displayName="TradeDetailsRow"});var mg,JG,Gke=F(()=>{mg=Y(Q());WB();JG=mg.default.memo(({visibleColumns:e,gridTemplate:t,depth:r,isMultiSelectMode:n})=>((0,mg.useLayoutEffect)(()=>(RI(),()=>{UI()}),[]),mg.default.createElement("div",{className:"trade-log-mini-header"},mg.default.createElement("div",{className:"tree-structure",style:{width:`${r*24}px`}}),mg.default.createElement("div",{className:"mini-header-row",style:{gridTemplateColumns:t,marginLeft:`-${r*24}px`,paddingLeft:`${r*24}px`}},mg.default.createElement("div",{className:"tree-indicator-cell-header"}),e.map(i=>mg.default.createElement("div",{key:i.id,className:`mini-header-cell header-${i.id}`},i.label))))));JG.displayName="TradeLogMiniHeader"});function hKe(e){return e>=60?"high":e>=40?"medium":"low"}function vKe(e){let t=e.performanceIndicator==="best"?"Best":"Worst";switch(e.type){case"year":return`${t} performing year`;case"quarter":let r=e.id.split("-")[0];return`${t} performing quarter of ${r}`;case"month":let[n,i]=e.id.split("-"),a=Math.ceil(parseInt(i)/3);return`${t} performing month of Q${a} ${n}`;case"week":let o=e.id.split("-W"),s=o[1],c=o[0].split("-")[0],d=yKe(parseInt(c),parseInt(s)),p=["January","February","March","April","May","June","July","August","September","October","November","December"][d.getMonth()];return`${t} performing week of ${p} ${c}`;case"day":let m=e.id.split("-"),g=new Date(parseInt(m[0]),parseInt(m[1])-1,parseInt(m[2])),f=Ou(g);return`${t} performing day of W${f} ${m[0]}`;default:return`${t} performing period`}}function yKe(e,t){let r=new Date(e,0,4),n=r.getDay(),i=n===0?-6:1-n,a=new Date(r);a.setDate(r.getDate()+i);let o=new Date(a);return o.setDate(a.getDate()+(t-1)*7),o}var Gr,QG,Yke=F(()=>{Gr=Y(Q());qt();o0();Vke();Gke();_t();Er();nr();QG=(0,Gr.memo)(({node:e,depth:t,isExpanded:r,isLastChild:n=!1,onToggleExpand:i,onNodeClick:a,viewLevel:o,visibleColumns:s,gridTemplate:l,selectedTrades:c,onToggleTradeSelection:d,isMultiSelectMode:u,isExpandedMode:p})=>{var x,S,w,C,D,P,M;let{currency:m}=ct(),g=Ae(),f=(S=(x=g==null?void 0:g.settings)==null?void 0:x.trade)==null?void 0:S.displayRMultiples,v=(C=(w=g==null?void 0:g.settings)==null?void 0:w.trade)==null?void 0:C.defaultRiskAmount,h=z=>{z.stopPropagation(),i(e)},y=z=>{z.stopPropagation(),a(e)},b=e.children&&e.children.length>0,k=e.type!=="trade"&&(b||!e.dataLoaded);if(e.type==="trade-group-header")return Gr.default.createElement(JG,{visibleColumns:s||[],gridTemplate:l||"",depth:t,isMultiSelectMode:u});if(e.type==="trade"){let z=((P=(D=e.trade)==null?void 0:D.file)==null?void 0:P.path)||((M=e.trade)==null?void 0:M.filePath)||"";return Gr.default.createElement(KG,{trade:e.trade,depth:t,isLastChild:n,onClick:y,viewLevel:o,visibleColumns:s,gridTemplate:l,isSelected:(c==null?void 0:c.has(z))||!1,onToggleSelection:d,isMultiSelectMode:u,isExpandedMode:p})}return Gr.default.createElement("div",{className:`trade-log-node trade-log-node--${e.type} ${n?"is-last-child":""}`},Gr.default.createElement("div",{className:"tree-structure",style:{width:`${t*24}px`}},Array.from({length:t}).map((z,A)=>Gr.default.createElement("span",{key:A,className:`tree-level ${A===t-1&&n?"last-level":""}`}))),Gr.default.createElement("div",{className:"node-wrapper"},t>0&&Gr.default.createElement("span",{className:"tree-connector"}),Gr.default.createElement("div",{className:"node-content"},Gr.default.createElement("div",{className:"tree-expand-wrapper"},k?Gr.default.createElement("button",{className:`node-chevron ${r?"expanded":""}`,onClick:h,"aria-label":r?"Collapse":"Expand"},r?Gr.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},Gr.default.createElement("rect",{x:"3.5",y:"3.5",width:"9",height:"9",stroke:"currentColor",strokeWidth:"1.5",rx:"1"}),Gr.default.createElement("path",{d:"M6 8H10",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})):Gr.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},Gr.default.createElement("rect",{x:"3.5",y:"3.5",width:"9",height:"9",stroke:"currentColor",strokeWidth:"1.5",rx:"1"}),Gr.default.createElement("path",{d:"M8 6V10M6 8H10",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}))):Gr.default.createElement("span",{className:"tree-leaf-node"})),Gr.default.createElement("span",{className:"node-label clickable-icon",onClick:y,"aria-label":`Navigate to ${e.type} review`},e.label,e.performanceIndicator&&Gr.default.createElement("span",{className:`performance-indicator performance-indicator--${e.performanceIndicator} clickable-icon`,"aria-label":vKe(e)},e.performanceIndicator==="best"?Gr.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Gr.default.createElement("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C5.5 4 6 4.5 6 5v4zM18 9h1.5a2.5 2.5 0 0 0 0-5c-1 0-1.5.5-1.5 1v4z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),Gr.default.createElement("path",{d:"M4 22h16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),Gr.default.createElement("path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),Gr.default.createElement("path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),Gr.default.createElement("path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})):Gr.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Gr.default.createElement("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),Gr.default.createElement("line",{x1:"12",y1:"9",x2:"12",y2:"13",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),Gr.default.createElement("line",{x1:"12",y1:"17",x2:"12.01",y2:"17",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})))),Gr.default.createElement("div",{className:"node-metrics"},Gr.default.createElement("div",{className:"metric-column metric-column--count"},Gr.default.createElement("span",{className:"metric metric--count"},e.metrics.tradeCount," ",e.metrics.tradeCount===1?"trade":"trades")),Gr.default.createElement("div",{className:"metric-column metric-column--winrate"},Gr.default.createElement("span",{className:`metric metric--winrate ${hKe(e.metrics.winRate)}`},e.metrics.winRate.toFixed(1),"%")),Gr.default.createElement("div",{className:"metric-column metric-column--pnl"},Gr.default.createElement("span",{className:`metric metric--pnl ${e.metrics.totalPnL>0?"positive":e.metrics.totalPnL<0?"negative":"neutral"}`},(()=>{if(e.metrics.isMultiCurrency&&e.metrics.totalPnLByCurrency&&!f){let z={byCurrency:e.metrics.totalPnLByCurrency,isMultiCurrency:!0,currencies:Object.keys(e.metrics.totalPnLByCurrency).sort(),defaultCurrency:e.metrics.primaryCurrency||"USD"},A=lM(z,!0);return Array.isArray(A)?A.join(" | "):A}return ye(e.metrics.totalPnL,!0,m,f,xt(e.metrics.totalPnL,e.metrics.totalRMultiple,void 0,v))})()))))))});QG.displayName="TradeLogNode"});var fp,Kk,$z,bKe,Rz,Kke=F(()=>{fp=Y(Q());Yke();Kk=null,$z=new WeakMap,bKe=()=>(Kk||(Kk=new IntersectionObserver(e=>{e.forEach(t=>{if(t.isIntersecting){let r=$z.get(t.target);r&&(r(),Kk==null||Kk.unobserve(t.target),$z.delete(t.target))}})},{rootMargin:"300px 0px",threshold:0})),Kk),Rz=(0,fp.memo)(({node:e,depth:t,isExpanded:r,isLastChild:n,onToggleExpand:i,onNodeClick:a,viewLevel:o,visibleColumns:s,gridTemplate:l,selectedTrades:c,onToggleTradeSelection:d,isMultiSelectMode:u,isExpandedMode:p})=>{let[m,g]=(0,fp.useState)(!1),f=(0,fp.useRef)(null),v=t===0||t===1;if((0,fp.useEffect)(()=>{if(v){g(!0);return}let h=f.current;if(!h)return;let y=bKe(),b=()=>g(!0);return $z.set(h,b),y.observe(h),()=>{h&&(y.unobserve(h),$z.delete(h))}},[v]),!m){let h=e.type==="trade"?60:48;return fp.default.createElement("div",{ref:f,className:`trade-log-node-placeholder trade-log-node--${e.type}`,style:{height:`${h}px`,width:"100%",background:"var(--background-primary-alt)",borderBottom:"1px solid var(--background-modifier-border)"}})}return fp.default.createElement(QG,{node:e,depth:t,isExpanded:r,isLastChild:n,onToggleExpand:i,onNodeClick:a,viewLevel:o,visibleColumns:s,gridTemplate:l,selectedTrades:c,onToggleTradeSelection:d,isMultiSelectMode:u,isExpandedMode:p})});Rz.displayName="LazyTradeLogNode"});function xKe({index:e,style:t,flattenedNodes:r,expandedNodes:n,onToggleExpand:i,onNodeClick:a,viewLevel:o,visibleColumns:s,gridTemplate:l,selectedTrades:c,onToggleTradeSelection:d,isMultiSelectMode:u,isExpandedMode:p}){let m=r[e];if(!m)return pi.default.createElement("div",{style:t});let{node:g,depth:f,isLastChild:v}=m;return pi.default.createElement("div",{style:t},pi.default.createElement(Rz,{key:g.id,node:g,depth:f,isExpanded:n.has(g.id),isLastChild:v,onToggleExpand:i,onNodeClick:a,viewLevel:o,visibleColumns:s,gridTemplate:l,selectedTrades:c,onToggleTradeSelection:d,isMultiSelectMode:u,isExpandedMode:p}))}var pi,XG,Jke=F(()=>{pi=Y(Q());_ke();Kke();XG=(0,pi.memo)(({nodes:e,expandedNodes:t,onToggleExpand:r,onNodeClick:n,onTreeReady:i,viewLevel:a,visibleColumns:o,gridTemplate:s,selectedTrades:l,onToggleTradeSelection:c,isMultiSelectMode:d,isExpandedMode:u,requestedScrollOffset:p,onScrollOffsetChange:m})=>{let g=(0,pi.useRef)(null),f=(0,pi.useRef)(null),v=(0,pi.useRef)(null),h=(0,pi.useRef)(0),[y,b]=(0,pi.useState)(600);(0,pi.useEffect)(()=>{let z=()=>{var L,E;if(g.current){let T=g.current.getBoundingClientRect(),$=((E=(L=document.querySelector(".trade-log-headers"))==null?void 0:L.getBoundingClientRect())==null?void 0:E.height)||60,_=T.height||window.innerHeight-$-100;b(Math.max(300,_))}},A=setTimeout(z,300),I=null;return g.current&&"ResizeObserver"in window&&(I=new ResizeObserver(z),I.observe(g.current)),window.addEventListener("resize",z),()=>{clearTimeout(A),window.removeEventListener("resize",z),I&&I.disconnect()}},[]);let[k,x]=(0,pi.useState)([]),[S,w]=(0,pi.useState)(!1);(0,pi.useEffect)(()=>{if(e.length===0){x([]),w(!1),i==null||i();return}let z=0,A=L=>{let E=L.length;return L.forEach(T=>{T.children&&t.has(T.id)&&(E+=A(T.children))}),E};if(z=A(e),z<200){let L=[],E=(T,$)=>{T.forEach((_,B)=>{let W=B===T.length-1;L.push({node:_,depth:$,isLastChild:W}),t.has(_.id)&&_.children&&_.children.length>0&&(_.children.some(U=>U.type==="trade")&&L.push({node:{type:"trade-group-header",id:`${_.id}-header`,label:"",metrics:{},expanded:!1,dataLoaded:!0},depth:$+1,isLastChild:!1}),E(_.children,$+1))})};E(e,0),x(L),w(!1),i==null||i();return}w(!0),(async()=>{let L=[],E=0,T=async($,_)=>{for(let B=0;B<$.length;B++){let W=$[B],N=B===$.length-1;L.push({node:W,depth:_,isLastChild:N}),E++,t.has(W.id)&&W.children&&W.children.length>0&&(W.children.some(j=>j.type==="trade")&&L.push({node:{type:"trade-group-header",id:`${W.id}-header`,label:"",metrics:{},expanded:!1,dataLoaded:!0},depth:_+1,isLastChild:!1}),await T(W.children,_+1)),E%100===0&&await new Promise(U=>setTimeout(U,0))}};await T(e,0),x(L),w(!1),i==null||i()})()},[e,t]);let C=k.length>50,D=(0,pi.useCallback)(z=>{let A=z.currentTarget.scrollTop;h.current=A,m==null||m(A)},[m]),P=(0,pi.useCallback)(z=>{let A=z.currentTarget;h.current=A.scrollTop,m==null||m(A.scrollTop)},[m]);(0,pi.useEffect)(()=>{let A=requestAnimationFrame(()=>{var L;let I=(p!=null?p:h.current)||0;if(C){let E=(L=f.current)==null?void 0:L.element;E&&(E.scrollTop=I)}else{let E=v.current;E&&(E.scrollTop=I)}});return()=>cancelAnimationFrame(A)},[k,C,p]);let M=(0,pi.useMemo)(()=>({flattenedNodes:k,expandedNodes:t,onToggleExpand:r,onNodeClick:n,viewLevel:a,visibleColumns:o,gridTemplate:s,selectedTrades:l,onToggleTradeSelection:c,isMultiSelectMode:d,isExpandedMode:u}),[k,t,r,n,a,o,s,l,c,d,u]);return e.length===0?pi.default.createElement("div",{className:"trade-log-tree trade-log-tree--empty"},"No trade data available"):S&&k.length===0?pi.default.createElement("div",{className:"trade-log-tree trade-log-tree--empty"},"Processing trade data..."):pi.default.createElement("div",{className:"trade-log-tree",ref:g,style:{height:"100%"}},C?pi.default.createElement(jke,{listRef:f,rowComponent:xKe,rowCount:k.length,rowHeight:48,rowProps:M,overscanCount:5,style:{height:y,width:"100%",overflowX:"hidden"},onScroll:D}):pi.default.createElement("div",{ref:v,"data-testid":"scroll-container",onScroll:P,style:{height:y,overflowY:"auto"}},k.map(({node:z,depth:A,isLastChild:I},L)=>pi.default.createElement(Rz,{key:z.id,node:z,depth:A,isExpanded:t.has(z.id),isLastChild:I,onToggleExpand:r,onNodeClick:n,viewLevel:a,visibleColumns:o,gridTemplate:s,selectedTrades:l,onToggleTradeSelection:c,isMultiSelectMode:d,isExpandedMode:u}))))})});function Qke(){if(document.head.querySelector("#trade-log-skeleton-styles"))return;let e=document.createElement("style");e.id="trade-log-skeleton-styles",e.textContent=wKe,document.head.appendChild(e)}function Xke(){var e;(e=document.head.querySelector("#trade-log-skeleton-styles"))==null||e.remove()}var wKe,Zke=F(()=>{wKe=`
.trade-log-skeleton {
  width: 100%;
  height: 100%;
  min-height: 400px;
  overflow: hidden;
  background: var(--background-primary);
  display: flex;
  flex-direction: column;
  transition: height 0.2s ease-out;
}

.skeleton-header-row {
  display: grid;
  gap: 8px;
  align-items: center;
  padding: 12px 16px;
  min-height: 48px;
  background: var(--background-secondary);
  border-bottom: 1px solid var(--background-modifier-border);
  font-weight: 500;
  position: sticky;
  top: 0;
  z-index: 5;
}

.skeleton-data-row {
  display: grid;
  gap: 8px;
  align-items: center;
  padding: 8px 16px;
  min-height: 48px;
  border-bottom: 1px solid var(--background-modifier-border-hover);
}

.skeleton-header-cell,
.skeleton-data-cell {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  overflow: hidden;
}

/* Responsive */
@media (max-width: 768px) {
  .skeleton-header-row,
  .skeleton-data-row {
    padding: 8px 12px;
    gap: 6px;
  }
}
`});var mi,Jk,eSe=F(()=>{mi=Y(Q());us();ps();SM();Zke();ff();Jk=(0,mi.memo)(({visibleColumns:e,gridTemplate:t,containerHeight:r=600})=>{(0,mi.useLayoutEffect)(()=>(tl(),Qke(),()=>{Xke()}),[]);let n=(0,mi.useMemo)(()=>Math.min(Math.ceil(r/48),20),[r]),i=(0,mi.useCallback)(a=>{switch(a){case"select":return mi.default.createElement(_l,{size:16});case"image":return mi.default.createElement(ae,{width:40,height:40});case"ticker":return mi.default.createElement(Qe,{width:"80px"});case"direction":return mi.default.createElement(Qe,{width:"60px"});case"status":return mi.default.createElement(Qe,{width:"60px"});case"pnl":return mi.default.createElement(Qe,{width:"70px"});case"duration":return mi.default.createElement(Qe,{width:"50px"});case"date":return mi.default.createElement(Qe,{width:"70px"});case"account":return mi.default.createElement(Qe,{width:"60px"});case"reviewed":return mi.default.createElement(_l,{size:16});case"positionSize":return mi.default.createElement(Qe,{width:"60px"});case"mistakes":return mi.default.createElement(Qe,{width:"40px"});case"setups":return mi.default.createElement(Qe,{width:"40px"});case"thesis":return mi.default.createElement(Qe,{width:"80%"});default:return mi.default.createElement(Qe,{width:"50px"})}},[]);return mi.default.createElement("div",{className:"trade-log-skeleton","aria-label":"Loading trade data"},mi.default.createElement("div",{className:"skeleton-header-row",style:{gridTemplateColumns:t}},e.map(a=>mi.default.createElement("div",{key:a.id,className:"skeleton-header-cell"},mi.default.createElement(Qe,{width:a.label?`${a.label.length*7}px`:"60px",height:"14px"})))),Array.from({length:n}).map((a,o)=>mi.default.createElement("div",{key:o,className:"skeleton-data-row",style:{gridTemplateColumns:t}},e.map(s=>mi.default.createElement("div",{key:s.id,className:"skeleton-data-cell"},i(s.id))))))});Jk.displayName="TradeLogSkeleton"});function kKe(e,t){return[...e].sort((r,n)=>{var o,s,l,c;if(r.type!=="trade"||n.type!=="trade")return 0;let i=(s=(o=r.trade)==null?void 0:o.pnl)!=null?s:0,a=(c=(l=n.trade)==null?void 0:l.pnl)!=null?c:0;return t==="asc"?i-a:a-i})}function SKe(e,t){return[...e].sort((r,n)=>{var o,s;if(r.type!=="trade"||n.type!=="trade")return 0;let i=(o=r.trade)!=null&&o.entryTime?new Date(r.trade.entryTime).getTime():0,a=(s=n.trade)!=null&&s.entryTime?new Date(n.trade.entryTime).getTime():0;return t==="asc"?i-a:a-i})}function TKe(e,t){return[...e].sort((r,n)=>{var o,s,l,c;if(r.type!=="trade"||n.type!=="trade")return 0;let i=(s=(o=r.trade)==null?void 0:o.positionSize)!=null?s:0,a=(c=(l=n.trade)==null?void 0:l.positionSize)!=null?c:0;return t==="asc"?i-a:a-i})}function CKe(e,t){return[...e].sort((r,n)=>{if(r.type!=="trade"||n.type!=="trade")return 0;let i=s=>{if(!(s!=null&&s.entryTime)||!(s!=null&&s.exitTime))return 0;let l=new Date(s.entryTime).getTime();return new Date(s.exitTime).getTime()-l},a=i(r.trade),o=i(n.trade);return t==="asc"?a-o:o-a})}function PKe(e,t){return[...e].sort((r,n)=>{if(r.type!=="trade"||n.type!=="trade")return 0;let i=IT(r.trade),a=IT(n.trade);if(!i&&!a)return 0;if(!i)return 1;if(!a)return-1;let o=i.getTime(),s=a.getTime(),l=o-s;return t==="asc"?l:-l})}function DKe(e,t,r){return[...e].sort((n,i)=>{var l,c,d,u,p,m;if(n.type!=="trade"||i.type!=="trade")return 0;let a=xt((l=n.trade)==null?void 0:l.pnl,(c=n.trade)==null?void 0:c.rMultiple,(d=n.trade)==null?void 0:d.riskAmount,r),o=xt((u=i.trade)==null?void 0:u.pnl,(p=i.trade)==null?void 0:p.rMultiple,(m=i.trade)==null?void 0:m.riskAmount,r);if(a===void 0&&o===void 0)return 0;if(a===void 0)return 1;if(o===void 0)return-1;let s=a-o;return t==="asc"?s:-s})}function EKe(e,t){return[...e].sort((r,n)=>{if(r.type!=="trade"||n.type!=="trade")return 0;let i=s=>{var l;if((s==null?void 0:s.mae)!==void 0)return s.mae;if((s==null?void 0:s.maePrice)!==void 0&&(s!=null&&s.entryPrice)&&(s!=null&&s.positionSize)){let c=(l=s.direction)==null?void 0:l.toUpperCase();return(c==="SELL"||c==="SHORT"?s.entryPrice-s.maePrice:s.maePrice-s.entryPrice)*s.positionSize}return null},a=i(r.trade),o=i(n.trade);return a===null&&o===null?0:a===null?1:o===null?-1:t==="asc"?a-o:o-a})}function IKe(e,t){return[...e].sort((r,n)=>{if(r.type!=="trade"||n.type!=="trade")return 0;let i=s=>{var l;if((s==null?void 0:s.mfe)!==void 0)return s.mfe;if((s==null?void 0:s.mfePrice)!==void 0&&(s!=null&&s.entryPrice)&&(s!=null&&s.positionSize)){let c=(l=s.direction)==null?void 0:l.toUpperCase();return(c==="SELL"||c==="SHORT"?s.entryPrice-s.mfePrice:s.mfePrice-s.entryPrice)*s.positionSize}return null},a=i(r.trade),o=i(n.trade);return a===null&&o===null?0:a===null?1:o===null?-1:t==="asc"?a-o:o-a})}function MKe(e,t){return[...e].sort((r,n)=>{var o,s;if(r.type!=="trade"||n.type!=="trade")return 0;let i=(o=r.trade)==null?void 0:o.maePrice,a=(s=n.trade)==null?void 0:s.maePrice;return i===void 0&&a===void 0?0:i===void 0?1:a===void 0?-1:t==="asc"?i-a:a-i})}function AKe(e,t){return[...e].sort((r,n)=>{var o,s;if(r.type!=="trade"||n.type!=="trade")return 0;let i=(o=r.trade)==null?void 0:o.mfePrice,a=(s=n.trade)==null?void 0:s.mfePrice;return i===void 0&&a===void 0?0:i===void 0?1:a===void 0?-1:t==="asc"?i-a:a-i})}function LKe(e,t){return[...e].sort((r,n)=>{if(r.type!=="trade"||n.type!=="trade")return 0;let i=s=>{var l;if((s==null?void 0:s.maePrice)!==void 0&&(s!=null&&s.entryPrice)&&s.entryPrice!==0){let c=(l=s.direction)==null?void 0:l.toUpperCase();return(c==="SELL"||c==="SHORT"?s.entryPrice-s.maePrice:s.maePrice-s.entryPrice)/s.entryPrice*100}return(s==null?void 0:s.mae)!==void 0&&(s!=null&&s.entryPrice)&&(s!=null&&s.positionSize)&&s.positionSize!==0?s.mae/(s.entryPrice*s.positionSize)*100:null},a=i(r.trade),o=i(n.trade);return a===null&&o===null?0:a===null?1:o===null?-1:t==="asc"?a-o:o-a})}function NKe(e,t){return[...e].sort((r,n)=>{if(r.type!=="trade"||n.type!=="trade")return 0;let i=s=>{var l;if((s==null?void 0:s.mfePrice)!==void 0&&(s!=null&&s.entryPrice)&&s.entryPrice!==0){let c=(l=s.direction)==null?void 0:l.toUpperCase();return(c==="SELL"||c==="SHORT"?s.entryPrice-s.mfePrice:s.mfePrice-s.entryPrice)/s.entryPrice*100}return(s==null?void 0:s.mfe)!==void 0&&(s!=null&&s.entryPrice)&&(s!=null&&s.positionSize)&&s.positionSize!==0?s.mfe/(s.entryPrice*s.positionSize)*100:null},a=i(r.trade),o=i(n.trade);return a===null&&o===null?0:a===null?1:o===null?-1:t==="asc"?a-o:o-a})}function tSe(e,t,r){if(!t.column)return e;switch(t.column){case"pnl":return kKe(e,t.direction);case"date":return SKe(e,t.direction);case"positionSize":return TKe(e,t.direction);case"duration":return CKe(e,t.direction);case"exitDate":return PKe(e,t.direction);case"rMultiple":return DKe(e,t.direction,r);case"mae":return EKe(e,t.direction);case"mfe":return IKe(e,t.direction);case"maePrice":return MKe(e,t.direction);case"mfePrice":return AKe(e,t.direction);case"maePercent":return LKe(e,t.direction);case"mfePercent":return NKe(e,t.direction);case"expirationDate":return[...e].sort((n,i)=>{var d,u;if(n.type!=="trade"||i.type!=="trade")return 0;let a=(d=n.trade)==null?void 0:d.expirationDate,o=(u=i.trade)==null?void 0:u.expirationDate;if(!a&&!o)return 0;if(!a)return 1;if(!o)return-1;let s=new Date(a).getTime(),l=new Date(o).getTime(),c=s-l;return t.direction==="asc"?c:-c});case"daysToExpiry":return[...e].sort((n,i)=>{var d,u;if(n.type!=="trade"||i.type!=="trade")return 0;let a=(d=n.trade)==null?void 0:d.expirationDate,o=(u=i.trade)==null?void 0:u.expirationDate,s=a?DT(a):null,l=o?DT(o):null;if(s===null&&l===null)return 0;if(s===null)return 1;if(l===null)return-1;let c=s-l;return t.direction==="asc"?c:-c});default:return e}}var rSe=F(()=>{_t();Jn();qt()});var Dt,fg,rY,ZG,FKe,eY,OKe,tY,nY,nSe=F(()=>{Dt=Y(Q()),fg=require("obsidian");Ot();ET();BB();rY=Y(Ni());rh();Zs();ZG=class extends fg.Modal{constructor(t,r,n,i){super(t),this.titleEl.setText("Confirm Deletion"),this.count=r,this.onConfirm=n,this.onCancel=i}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("p",{text:`Are you sure you want to delete ${this.count} selected trade${this.count>1?"s":""}?`}),t.createEl("p",{text:"This action cannot be undone."});let r=t.createDiv({cls:"modal-button-container"}),n=r.createEl("button",{text:"Cancel"});n.onclick=()=>{this.onCancel(),this.close()};let i=r.createEl("button",{text:"Delete",cls:"mod-warning"});i.onclick=()=>{this.onConfirm(),this.close()}}onClose(){let{contentEl:t}=this;t.empty()}},FKe=({setupOptions:e,onConfirm:t,onClose:r,onSaveOption:n,plugin:i})=>{let[a,o]=(0,Dt.useState)([]),[s,l]=(0,Dt.useState)(!1),[c,d]=(0,Dt.useState)(e),u=(0,Dt.useCallback)(()=>{if(i.optionsService){let m=i.optionsService.getOptions("setup");d(m)}},[i.optionsService]);(0,Dt.useEffect)(()=>{u()},[u]),Xe("options:changed",u);let p=async()=>{if(a.length!==0){l(!0);try{await t(a),r()}catch(m){console.error("Error adding setups:",m),l(!1)}}};return Dt.default.createElement("div",{className:"batch-action-modal-content"},Dt.default.createElement("div",{className:"batch-action-modal-body"},Dt.default.createElement(Xs,{label:"Setups",options:c,value:a,onChange:m=>o(m),allowCreate:!0,isMulti:!0,placeholder:"Select or create setups...",onSaveOption:n,optionType:"setup"})),Dt.default.createElement("div",{className:"batch-action-modal-buttons"},Dt.default.createElement("button",{onClick:r,disabled:s},"Cancel"),Dt.default.createElement("button",{onClick:p,disabled:s||a.length===0,className:"primary"},s?"Adding...":`Add ${a.length>0?`(${a.length})`:""}`)))},eY=class extends fg.Modal{constructor(r,n,i,a,o,s){super(r);this.root=null;this.titleEl.setText("Add Setups to Trades"),this.setupOptions=n,this.onConfirm=i,this.onModalClose=a,this.onSaveOption=o,this.plugin=s}onOpen(){let{contentEl:r}=this;r.empty(),r.style.minHeight="400px",r.style.maxHeight="80vh",r.style.display="flex",r.style.flexDirection="column",this.container=r.createDiv({cls:"batch-action-modal-container"}),this.root=(0,rY.createRoot)(this.container),this.root.render(Dt.default.createElement(FKe,{setupOptions:this.setupOptions,onConfirm:this.onConfirm,onClose:()=>this.close(),onSaveOption:this.onSaveOption,plugin:this.plugin}))}onClose(){this.root&&(this.root.unmount(),this.root=null),this.onModalClose()}},OKe=({mistakeOptions:e,onConfirm:t,onClose:r,onSaveOption:n,plugin:i})=>{let[a,o]=(0,Dt.useState)([]),[s,l]=(0,Dt.useState)(!1),[c,d]=(0,Dt.useState)(e),u=(0,Dt.useCallback)(()=>{if(i.optionsService){let m=i.optionsService.getOptions("mistake");d(m)}},[i.optionsService]);(0,Dt.useEffect)(()=>{u()},[u]),Xe("options:changed",u);let p=async()=>{if(a.length!==0){l(!0);try{await t(a),r()}catch(m){console.error("Error adding mistakes:",m),l(!1)}}};return Dt.default.createElement("div",{className:"batch-action-modal-content"},Dt.default.createElement("div",{className:"batch-action-modal-body"},Dt.default.createElement(Xs,{label:"Mistakes",options:c,value:a,onChange:m=>o(m),allowCreate:!0,isMulti:!0,placeholder:"Select or create mistakes...",onSaveOption:n,optionType:"mistake"})),Dt.default.createElement("div",{className:"batch-action-modal-buttons"},Dt.default.createElement("button",{onClick:r,disabled:s},"Cancel"),Dt.default.createElement("button",{onClick:p,disabled:s||a.length===0,className:"primary"},s?"Adding...":`Add ${a.length>0?`(${a.length})`:""}`)))},tY=class extends fg.Modal{constructor(r,n,i,a,o,s){super(r);this.root=null;this.titleEl.setText("Add Mistakes to Trades"),this.mistakeOptions=n,this.onConfirm=i,this.onModalClose=a,this.onSaveOption=o,this.plugin=s}onOpen(){let{contentEl:r}=this;r.empty(),r.style.minHeight="400px",r.style.maxHeight="80vh",r.style.display="flex",r.style.flexDirection="column",this.container=r.createDiv({cls:"batch-action-modal-container"}),this.root=(0,rY.createRoot)(this.container),this.root.render(Dt.default.createElement(OKe,{mistakeOptions:this.mistakeOptions,onConfirm:this.onConfirm,onClose:()=>this.close(),onSaveOption:this.onSaveOption,plugin:this.plugin}))}onClose(){this.root&&(this.root.unmount(),this.root=null),this.onModalClose()}},nY=(0,Dt.memo)(({selectedCount:e,onMarkAsReviewed:t,onAddSetups:r,onAddMistakes:n,onDelete:i,onSelectAll:a,onClearSelection:o,setupOptions:s,mistakeOptions:l,app:c,plugin:d})=>{(0,Dt.useLayoutEffect)(()=>(BI(),()=>{WI()}),[]);let[u,p]=(0,Dt.useState)(!1),[m,g]=(0,Dt.useState)(null),f=(0,Dt.useCallback)(async x=>{try{let S=d==null?void 0:d.optionsService;S&&await S.addOption("setup",x)&&S.notifyOptionsChanged()}catch(S){console.error("Failed to save setup option:",S)}},[d]),v=(0,Dt.useCallback)(async x=>{try{let S=d==null?void 0:d.optionsService;S&&await S.addOption("mistake",x)&&S.notifyOptionsChanged()}catch(S){console.error("Failed to save mistake option:",S)}},[d]),h=(0,Dt.useCallback)(async()=>{try{p(!0),g("reviewed"),await t()}catch(x){console.error("Error marking trades as reviewed:",x),new fg.Notice(`Error marking trades as reviewed: ${x.message}`)}finally{p(!1),g(null)}},[t]),y=(0,Dt.useCallback)(()=>{new eY(c,s,async S=>{try{p(!0),g("setups"),await r(S)}catch(w){console.error("Error adding setups:",w),new fg.Notice(`Error adding setups: ${w.message}`)}finally{p(!1),g(null)}},()=>{},f,d).open()},[c,s,r,f,d]),b=(0,Dt.useCallback)(()=>{new tY(c,l,async S=>{try{p(!0),g("mistakes"),await n(S)}catch(w){console.error("Error adding mistakes:",w),new fg.Notice(`Error adding mistakes: ${w.message}`)}finally{p(!1),g(null)}},()=>{},v,d).open()},[c,l,n,v,d]),k=(0,Dt.useCallback)(()=>{new ZG(c,e,async()=>{try{p(!0),g("delete"),await i()}catch(S){console.error("Error deleting trades:",S),new fg.Notice(`Error deleting trades: ${S.message}`)}finally{p(!1),g(null)}},()=>{}).open()},[c,e,i]);return Dt.default.createElement("div",{className:"batch-action-toolbar"},Dt.default.createElement("div",{className:"batch-action-toolbar-left"},Dt.default.createElement("span",{className:"batch-selection-count"},e===0?"NONE SELECTED":`${e} SELECTED`),Dt.default.createElement("button",{className:"batch-action-select-all-btn",onClick:a,disabled:m!==null,title:"Select all visible trades"},Dt.default.createElement(Mp,{size:14}),Dt.default.createElement("span",{className:"select-all-label"},"Select All"))),Dt.default.createElement("div",{className:"batch-action-toolbar-actions"},Dt.default.createElement("button",{className:"batch-action-button",onClick:h,disabled:u||e===0,"aria-label":"Mark as reviewed",title:"Mark selected trades as reviewed"},Dt.default.createElement(Aa,{size:16}),m==="reviewed"?Dt.default.createElement("span",{className:"btn-label"},"Marking..."):Dt.default.createElement("span",{className:"btn-label"},"Mark Reviewed")),Dt.default.createElement("button",{className:"batch-action-button",onClick:y,disabled:u||e===0,"aria-label":"Add setups",title:"Add setups to selected trades"},Dt.default.createElement(nf,{size:16}),m==="setups"?Dt.default.createElement("span",{className:"btn-label"},"Adding..."):Dt.default.createElement("span",{className:"btn-label"},"Add Setups")),Dt.default.createElement("button",{className:"batch-action-button",onClick:b,disabled:u||e===0,"aria-label":"Add mistakes",title:"Add mistakes to selected trades"},Dt.default.createElement(oa,{size:16}),m==="mistakes"?Dt.default.createElement("span",{className:"btn-label"},"Adding..."):Dt.default.createElement("span",{className:"btn-label"},"Add Mistakes")),Dt.default.createElement("button",{className:"batch-action-button batch-action-delete danger",onClick:k,disabled:u||e===0,"aria-label":"Delete trades",title:"Delete selected trades"},Dt.default.createElement(kT,{size:16}),m==="delete"?Dt.default.createElement("span",{className:"btn-label"},"Deleting..."):Dt.default.createElement("span",{className:"btn-label"},"Delete")),Dt.default.createElement("button",{className:"batch-action-button batch-action-clear",onClick:o,disabled:u||e===0,"aria-label":"Clear selection",title:"Clear selection"},Dt.default.createElement(La,{size:16}),Dt.default.createElement("span",{className:"btn-label"},"Clear"))))});nY.displayName="BatchActionToolbar"});async function iSe(e,t){var l;let r=0,n=0,i=0,a=t.length,o=window.journalitPlugin;(l=o==null?void 0:o.backendIntegrationService)!=null&&l.fileWatcherService&&t.forEach(c=>{o.backendIntegrationService.fileWatcherService.batchModifiedFiles.add(c)});let s=!0;for(let c of t)try{s||await new Promise(g=>setTimeout(g,2)),s=!1;let d=e.vault.getAbstractFileByPath(c);if(!(d instanceof fD.TFile)){console.warn(`File not found or not a TFile: ${c}`),i++;continue}let u=new Date().toISOString(),p=!1,m=!1;await e.fileManager.processFrontMatter(d,g=>{if(g.reviewed===!0){p=!0;return}g.reviewed=!0,g.reviewedAt=u,m=!0}),p?n++:m?r++:i++}catch(d){console.error(`Failed to mark trade as reviewed: ${c}`,d),i++}return await new Promise(c=>setTimeout(c,200)),xe.publish("trade:changed",{action:"batch",filePaths:t,timestamp:Date.now()}),setTimeout(()=>{var c;(c=o==null?void 0:o.backendIntegrationService)!=null&&c.fileWatcherService&&t.forEach(d=>{o.backendIntegrationService.fileWatcherService.batchModifiedFiles.delete(d)})},500),{processed:r,skipped:n,errors:i,total:a}}async function aSe(e,t,r,n){var d;let i=0,a=0,o=0,s=t.length,l=[],c=window.journalitPlugin;(d=c==null?void 0:c.backendIntegrationService)!=null&&d.fileWatcherService&&t.forEach(u=>{c.backendIntegrationService.fileWatcherService.batchModifiedFiles.add(u)});for(let u of t)try{let p=e.vault.getAbstractFileByPath(u);if(!(p instanceof fD.TFile)){console.warn(`File not found or not a TFile: ${u}`),o++;continue}let m=!1,g=!1;await e.fileManager.processFrontMatter(p,f=>{let v=Array.isArray(f.setup)?f.setup:[];if(n.every(x=>v.includes(x))){m=!0;return}let y=Array.isArray(f.setupIds)?f.setupIds:[],b=Array.from(new Set([...y,...r])),k=Array.from(new Set([...v,...n]));f.setupIds=b,f.setup=k,g=!0}),m?a++:g?(i++,l.push(p)):o++}catch(p){console.error(`Failed to add setups to trade: ${u}`,p),o++}return await Promise.all(l.map(u=>yn(e,u,120).catch(p=>{}))),xe.publish("trade:changed",{action:"batch",filePaths:l.map(u=>u.path),timestamp:Date.now()}),setTimeout(()=>{var u;(u=c==null?void 0:c.backendIntegrationService)!=null&&u.fileWatcherService&&t.forEach(p=>{c.backendIntegrationService.fileWatcherService.batchModifiedFiles.delete(p)})},500),{processed:i,skipped:a,errors:o,total:s}}async function oSe(e,t,r,n){var d;let i=0,a=0,o=0,s=t.length,l=[],c=window.journalitPlugin;(d=c==null?void 0:c.backendIntegrationService)!=null&&d.fileWatcherService&&t.forEach(u=>{c.backendIntegrationService.fileWatcherService.batchModifiedFiles.add(u)});for(let u of t)try{let p=e.vault.getAbstractFileByPath(u);if(!(p instanceof fD.TFile)){console.warn(`File not found or not a TFile: ${u}`),o++;continue}let m=!1,g=!1;await e.fileManager.processFrontMatter(p,f=>{let v=Array.isArray(f.mistake)?f.mistake:[];if(n.every(x=>v.includes(x))){m=!0;return}let y=Array.isArray(f.mistakeIds)?f.mistakeIds:[],b=Array.from(new Set([...y,...r])),k=Array.from(new Set([...v,...n]));f.mistakeIds=b,f.mistake=k,g=!0}),m?a++:g?(i++,l.push(p)):o++}catch(p){console.error(`Failed to add mistakes to trade: ${u}`,p),o++}return await Promise.all(l.map(u=>yn(e,u,120).catch(p=>{}))),xe.publish("trade:changed",{action:"batch",filePaths:l.map(u=>u.path),timestamp:Date.now()}),setTimeout(()=>{var u;(u=c==null?void 0:c.backendIntegrationService)!=null&&u.fileWatcherService&&t.forEach(p=>{c.backendIntegrationService.fileWatcherService.batchModifiedFiles.delete(p)})},500),{processed:i,skipped:a,errors:o,total:s}}async function sSe(e,t){var o;let r=0,n=0,i=t.length,a=window.journalitPlugin;(o=a==null?void 0:a.backendIntegrationService)!=null&&o.fileWatcherService&&t.forEach(s=>{a.backendIntegrationService.fileWatcherService.batchModifiedFiles.add(s)});for(let s of t)try{let l=e.vault.getAbstractFileByPath(s);if(!(l instanceof fD.TFile)){console.warn(`File not found or not a TFile: ${s}`),n++;continue}await e.vault.delete(l),r++}catch(l){console.error(`Failed to delete trade: ${s}`,l),n++}return await new Promise(s=>setTimeout(s,500)),xe.publish("trade:changed",{action:"batch",filePaths:t,timestamp:Date.now()}),setTimeout(()=>{var s;(s=a==null?void 0:a.backendIntegrationService)!=null&&s.fileWatcherService&&t.forEach(l=>{a.backendIntegrationService.fileWatcherService.batchModifiedFiles.delete(l)})},500),{processed:r,skipped:0,errors:n,total:i}}var fD,lSe=F(()=>{fD=require("obsidian");Nl();Tr()});function cSe(e,t,r){let n=[],i=0;function a(d){var u,p;for(let m of d){if(m.type==="trade"){let g=((u=m.trade)==null?void 0:u.filePath)||((p=m.trade)==null?void 0:p.path);g&&(n.push({id:g,index:i}),i++)}m.children&&m.children.length>0&&a(m.children)}}a(e);let o=n.findIndex(d=>d.id===t),s=n.findIndex(d=>d.id===r);if(o===-1||s===-1)return[];let l=Math.min(o,s),c=Math.max(o,s);return n.slice(l,c+1).map(d=>d.id)}var dSe=F(()=>{});var Ge,Rs,uSe,zKe,pSe,mSe=F(()=>{Ge=Y(Q());UG();YO();Eke();Jke();Dn();eSe();qi();Wp();Rs=require("obsidian");qG();rSe();Ot();nSe();lSe();rh();dSe();uSe=(e,t,r)=>{let n=!1;return e.map(a=>a.id===t?(n=!0,{...a,children:r,dataLoaded:!0}):a.children?{...a,children:uSe(a.children,t,r)}:a)},zKe={ArrowUp01:ZS,ArrowDown10:QS,ArrowUpAZ:qg,ArrowDownZA:Hg,ArrowUpNarrowWide:Vg,ArrowDownWideNarrow:Ug,ArrowUpDown:eT},pSe=({plugin:e})=>{var Ee,ge;let[t,r]=(0,Ge.useState)(!1),[n,i]=(0,Ge.useState)(!1),[a,o]=(0,Ge.useState)(new Set),[s,l]=(0,Ge.useState)([]),[c,d]=(0,Ge.useState)(new Set),[u,p]=(0,Ge.useState)({dateRange:[null,null],viewLevel:"trades",tradeTypes:[],statuses:[],accounts:[],tickers:[],setups:[],tags:[]}),[m,g]=(0,Ge.useState)(0),[f,v]=(0,Ge.useState)({column:null,direction:"desc"}),[h,y]=(0,Ge.useState)(()=>{let oe=window.innerHeight||600;return Math.max(400,oe-200)}),[b,k]=(0,Ge.useState)(new Set),[x,S]=(0,Ge.useState)(!1),[w,C]=(0,Ge.useState)(0),[D,P]=(0,Ge.useState)(()=>{var oe,me;return(me=(oe=e.uiStateManager.getState().tradeLog)==null?void 0:oe.expandedMode)!=null?me:!1}),[M,z]=(0,Ge.useState)(null),A=(0,Ge.useRef)(0),[I,L]=(0,Ge.useState)(null),E=(0,Ge.useRef)(!1),T=(0,Ge.useRef)("trades"),$=(0,Ge.useRef)(!1),_=(0,Ge.useMemo)(()=>{let oe=e.uiStateManager.getState().tradeLog||{columnVisibility:{},columnOrder:[],columnWidths:{}},me=xke(oe.columnVisibility,oe.columnOrder);if(x){let Ce=tx.find(et=>et.id==="select");Ce&&(me=[Ce,...me])}return me},[e.uiStateManager.getState().tradeLog,m,x]),B=["setups","mistakes","tags"],W=(0,Ge.useRef)(null),[N,U]=(0,Ge.useState)({}),j=(0,Ge.useMemo)(()=>wke(_,u.viewLevel,D,N),[_,u.viewLevel,D,N]),R=(ge=(Ee=e.settings)==null?void 0:Ee.trade)==null?void 0:ge.defaultRiskAmount,O=(0,Ge.useMemo)(()=>u.viewLevel!=="trades"||!f.column?s:tSe(s,f,R),[s,f,u.viewLevel,R]),H=(0,Ge.useMemo)(()=>{if(!D)return{setups:[],mistakes:[],tags:[]};let oe=[],me=[],Ce=[],et=lt=>{for(let mt of lt){if(mt.type==="trade"&&mt.trade){let cn=Array.isArray(mt.trade.setup)?mt.trade.setup:mt.trade.setup?[mt.trade.setup]:[],ia=Array.isArray(mt.trade.mistake)?mt.trade.mistake:mt.trade.mistake?[mt.trade.mistake]:[],yr=Array.isArray(mt.trade.tags)?mt.trade.tags:[];cn.length>oe.length&&(oe=cn),ia.length>me.length&&(me=ia),yr.length>Ce.length&&(Ce=yr)}mt.children&&et(mt.children)}};return et(s),{setups:oe,mistakes:me,tags:Ce}},[s,D]);(0,Ge.useEffect)(()=>{if(!D||!W.current){U({});return}requestAnimationFrame(()=>{if(!W.current)return;let oe={};W.current.querySelectorAll("[data-sizer-col]").forEach(Ce=>{let et=Ce.getAttribute("data-sizer-col");et&&(oe[et]=Ce.getBoundingClientRect().width)}),U(oe)})},[D,H]);let q=(0,Ge.useMemo)(()=>{if(u.viewLevel!=="trades")return 0;let oe=_.reduce((et,lt)=>{if(D&&B.includes(lt.id)){let cn=N[lt.id];return cn&&cn>0?et+Math.ceil(cn)+8:et+lt.width}let mt=lt.width===0?lt.id==="thesis"?320:120:lt.width;return et+mt},0),me=Math.max(0,_.length-1)*8;return oe+me+32},[_,u.viewLevel,D,N]),V=(0,Ge.useRef)(null);V.current||(V.current=new ex(e));let J=V.current,K=gX(u,150),G=(0,Ge.useCallback)(()=>{C(oe=>oe+1)},[]);Xe("options:changed",G);let X=(0,Ge.useMemo)(()=>{var oe;try{return((oe=e.optionsService)==null?void 0:oe.getOptions("setup"))||[]}catch(me){return console.error("Failed to load setup options:",me),[]}},[e.optionsService,w]),te=(0,Ge.useMemo)(()=>{var oe;try{return((oe=e.optionsService)==null?void 0:oe.getOptions("mistake"))||[]}catch(me){return console.error("Failed to load mistake options:",me),[]}},[e.optionsService,w]);(0,Ge.useEffect)(()=>{let oe=()=>{var et,lt;let Ce=document.querySelector(".journalit-trade-log-view-container");if(Ce){let mt=Ce.getBoundingClientRect(),cn=((lt=(et=document.querySelector(".trade-log-header"))==null?void 0:et.getBoundingClientRect())==null?void 0:lt.height)||120,ia=mt.height-cn;y(Math.max(400,ia))}},me=setTimeout(oe,200);return window.addEventListener("resize",oe),()=>{clearTimeout(me),window.removeEventListener("resize",oe)}},[]);let re=(0,Ge.useCallback)(async()=>{let oe=performance.now();E.current||r(!1),i(!1);try{$.current=!0;let me=await J.getHierarchicalData(K.viewLevel,K.dateRange[0]||void 0,K.dateRange[1]||void 0,K.tradeTypes,K.statuses,K.accounts,K.tickers,K.setups,K.tags);l(me),(!E.current||T.current!==K.viewLevel)&&d(new Set),T.current=K.viewLevel,r(!0),E.current=!0,L(A.current)}catch(me){console.error("Error loading trade log data:",me),r(!0),i(!0)}finally{$.current=!1}},[J,K,e]),Z=(0,Ge.useCallback)(oe=>{v(me=>{if(oe==="date")return me.column===oe?{column:oe,direction:me.direction==="asc"?"desc":"asc"}:{column:oe,direction:"desc"};let Ce=["pnl","positionSize","duration","expirationDate","daysToExpiry"].includes(oe)?"desc":"asc",et=Ce==="desc"?"asc":"desc";return me.column===oe?me.direction===Ce?{column:oe,direction:et}:{column:null,direction:"desc"}:{column:oe,direction:Ce}})},[]),ne=(0,Ge.useCallback)((oe,me)=>{if(me&&"shiftKey"in me&&me.shiftKey&&M&&M!==oe){let et=cSe(O,M,oe);if(et.length>0){k(lt=>{let mt=new Set(lt);return et.forEach(cn=>mt.add(cn)),mt}),z(oe);return}}k(et=>{let lt=new Set(et);return lt.has(oe)?lt.delete(oe):lt.add(oe),lt}),z(oe)},[M,O]),se=(0,Ge.useCallback)(()=>{let oe=new Set,me=Ce=>{Ce.forEach(et=>{var lt,mt,cn,ia;if(et.type==="trade"){let yr=((mt=(lt=et.trade)==null?void 0:lt.file)==null?void 0:mt.path)||((cn=et.trade)==null?void 0:cn.filePath)||((ia=et.trade)==null?void 0:ia.path);yr&&oe.add(yr)}et.children&&me(et.children)})};me(O),k(oe)},[O]),ee=(0,Ge.useCallback)(()=>{k(new Set)},[]),ie=(0,Ge.useCallback)(()=>{S(oe=>!oe),x&&k(new Set)},[x]);Xe("settings:changed",oe=>{var me,Ce;if((oe==null?void 0:oe.component)==="tradeLog"){let et=(Ce=(me=e.uiStateManager.getState().tradeLog)==null?void 0:me.expandedMode)!=null?Ce:!1;P(et)}});let ve=(0,Ge.useCallback)(async()=>{let oe=Array.from(b),me=await iSe(e.app,oe);if(me.errors>0&&me.processed===0)new Rs.Notice(`Failed to mark trades as reviewed. ${me.errors} error${me.errors>1?"s":""} occurred.`);else if(me.processed===0)new Rs.Notice(`All ${me.total} selected trade${me.total>1?"s are":" is"} already reviewed`);else if(me.skipped===0&&me.errors===0)new Rs.Notice(`Marked ${me.processed} trade${me.processed>1?"s":""} as reviewed`);else{let Ce=[`Marked ${me.processed} trade${me.processed>1?"s":""} as reviewed`];me.skipped>0&&Ce.push(`${me.skipped} already reviewed`),me.errors>0&&Ce.push(`${me.errors} error${me.errors>1?"s":""}`),new Rs.Notice(Ce.join(", "))}k(new Set),me.processed>0&&S(!1)},[b,e.app]),Se=(0,Ge.useCallback)(async oe=>{let me=Array.from(b),Ce=await aSe(e.app,me,oe,oe);if(Ce.errors>0&&Ce.processed===0)new Rs.Notice(`Failed to add setups. ${Ce.errors} error${Ce.errors>1?"s":""} occurred.`);else if(Ce.processed===0)new Rs.Notice(`No trades needed updates - all ${Ce.total} already had these setups`);else if(Ce.skipped===0&&Ce.errors===0)new Rs.Notice(`Added setups to ${Ce.processed} trades`);else{let et=[`Added setups to ${Ce.processed} trades`];Ce.skipped>0&&et.push(`${Ce.skipped} already had all setups`),Ce.errors>0&&et.push(`${Ce.errors} error${Ce.errors>1?"s":""}`),new Rs.Notice(et.join(", "))}k(new Set),Ce.processed>0&&S(!1)},[b,e.app]),Me=(0,Ge.useCallback)(async oe=>{let me=Array.from(b),Ce=await oSe(e.app,me,oe,oe);if(Ce.errors>0&&Ce.processed===0)new Rs.Notice(`Failed to add mistakes. ${Ce.errors} error${Ce.errors>1?"s":""} occurred.`);else if(Ce.processed===0)new Rs.Notice(`No trades needed updates - all ${Ce.total} already had these mistakes`);else if(Ce.skipped===0&&Ce.errors===0)new Rs.Notice(`Added mistakes to ${Ce.processed} trades`);else{let et=[`Added mistakes to ${Ce.processed} trades`];Ce.skipped>0&&et.push(`${Ce.skipped} already had all mistakes`),Ce.errors>0&&et.push(`${Ce.errors} error${Ce.errors>1?"s":""}`),new Rs.Notice(et.join(", "))}k(new Set),Ce.processed>0&&S(!1)},[b,e.app]),le=(0,Ge.useCallback)(async()=>{let oe=Array.from(b),me=await sSe(e.app,oe);me.errors>0&&me.processed===0?new Rs.Notice(`Failed to delete trades. ${me.errors} error${me.errors>1?"s":""} occurred.`):me.errors===0?new Rs.Notice(`Deleted ${me.processed} trade${me.processed>1?"s":""}`):new Rs.Notice(`Deleted ${me.processed} trade${me.processed>1?"s":""} (${me.errors} error${me.errors>1?"s":""})`),k(new Set),S(!1)},[b,e.app]);(0,Ge.useEffect)(()=>{re()},[K]);let Ye=(0,Ge.useRef)(null),ue=(0,Ge.useCallback)(()=>{Ye.current&&window.clearTimeout(Ye.current),Ye.current=window.setTimeout(async()=>{e.app.workspace.trigger&&e.app.workspace.trigger("layout-change"),await new Promise(oe=>setTimeout(oe,80)),await re(),Ye.current=null},400)},[re,e.app.workspace]);pI(["trade:changed","missed-trade:changed","backtest-trade:changed"],ue),(0,Ge.useEffect)(()=>()=>{Ye.current&&window.clearTimeout(Ye.current)},[]),(0,Ge.useEffect)(()=>()=>{V.current&&V.current.destroy()},[]);let We=(0,Ge.useCallback)(async oe=>{let me=new Set(c),Ce=!c.has(oe.id);if(c.has(oe.id))me.delete(oe.id),d(me);else if(!oe.dataLoaded&&oe.type!=="trade"){o(et=>new Set(et).add(oe.id));try{let et=await J.getNodeChildren(oe);l(lt=>uSe(lt,oe.id,et)),setTimeout(()=>{d(lt=>{let mt=new Set(lt);return mt.add(oe.id),mt})},0)}catch(et){console.error("Error loading node children:",et)}finally{o(et=>{let lt=new Set(et);return lt.delete(oe.id),lt})}}else me.add(oe.id),d(me)},[c,J,e]),Ke=(0,Ge.useCallback)(async oe=>{var Ce,et,lt;let me=Jb.getInstance(e.app,e);switch(oe.type){case"trade":{let mt;(Ce=oe.trade)!=null&&Ce.file?mt=oe.trade.file.path:(et=oe.trade)!=null&&et.filePath?mt=oe.trade.filePath:oe.id&&oe.id.includes(".md")&&(mt=oe.id),mt&&(e.app.vault.getAbstractFileByPath(mt)?await e.openFile(mt,!1):(console.warn("Trade file not found:",mt),new Rs.Notice(`Trade file not found: ${mt}`)));break}case"day":{let mt=new Date(oe.id),cn=await me.getDRCService(),ia=cn.getDRCNotePath(mt);e.app.vault.getAbstractFileByPath(ia)?await e.openFile(ia,!1):e.settings.drc.autoCreateDRCOnNavigation&&(await cn.createDRC(mt),await e.openFile(ia,!1));break}case"week":{let mt=oe.id.split("-W"),cn=mt[1],yr=mt[0].split("-")[0],Li=parseInt(yr),Ua=parseInt(cn),ao=new Date(Li,0,1).getDay(),Hs=ao===0?-6:1-ao,fd=new Date(Li,0,1+Hs),jm=new Date(fd.getTime()+(Ua-1)*7*24*60*60*1e3),wo=await me.getWeeklyReviewService(),gd=wo.getWeeklyReviewPath(jm);e.app.vault.getAbstractFileByPath(gd)?await e.openFile(gd,!1):e.settings.weekly.autoCreateWeeklyReviewOnNavigation&&(await wo.createWeeklyReview(jm),await e.openFile(gd,!1));break}case"month":{let[mt,cn]=oe.id.split("-"),ia=parseInt(mt),yr=parseInt(cn)-1,Li=new Date(ia,yr,1),Ua=await me.getMonthlyReviewService(),io=Ua.getMonthlyReviewPath(Li);e.app.vault.getAbstractFileByPath(io)?await e.openFile(io,!1):(lt=e.settings.monthly)!=null&&lt.autoCreateMonthlyReviewOnNavigation&&await Ua.createMonthlyReview(Li)&&await e.openFile(io,!1);break}case"quarter":case"year":console.log(`No review available for ${oe.type}:`,oe.id);break}},[e]),Ze=(0,Ge.useCallback)(oe=>{p(me=>({...me,...oe}))},[]),St=(0,Ge.useCallback)(()=>{g(oe=>oe+1)},[]),Zr=(0,Ge.useCallback)(()=>{i(!0),L(null)},[]);return t&&s.length===0?Ge.default.createElement("div",{className:"journalit-trade-log"},Ge.default.createElement(Bz,{app:e.app,plugin:e,filters:u,onFilterChange:Ze,onSettingsChange:St,isMultiSelectMode:x,onToggleMultiSelectMode:ie}),Ge.default.createElement(yi,{message:"No trades found",subMessage:"Start creating trade notes to see them appear in your trade log.",actionButtonText:"Create Trade",onActionButtonClick:async()=>{new Eo({app:e.app,plugin:e}).open()}})):Ge.default.createElement("div",{className:"journalit-trade-log"},Ge.default.createElement(Bz,{app:e.app,plugin:e,filters:u,onFilterChange:Ze,onSettingsChange:St,isMultiSelectMode:x,onToggleMultiSelectMode:ie}),x&&Ge.default.createElement(nY,{app:e.app,plugin:e,selectedCount:b.size,onMarkAsReviewed:ve,onAddSetups:Se,onAddMistakes:Me,onDelete:le,onSelectAll:se,onClearSelection:ee,setupOptions:X,mistakeOptions:te}),Ge.default.createElement("div",{className:`trade-log-content ${u.viewLevel==="trades"?"trades-view":""}`},u.viewLevel==="trades"?Ge.default.createElement("div",{className:"trade-log-hscroll",style:{overflowX:"auto",overflowY:"hidden"}},Ge.default.createElement("div",{className:"trade-log-hscroll-inner",style:{minWidth:`${q}px`,width:"100%"}},t&&Ge.default.createElement("div",{className:"trade-log-headers"},Ge.default.createElement("div",{className:"trade-log-header-row",style:{gridTemplateColumns:j}},_.map(oe=>{let me=f.column===oe.id,Ce=oe.sortable,et=Ce?kke(oe.type,me?f.direction:null):null,lt=et?zKe[et]:null;return Ge.default.createElement("div",{key:oe.id,className:`header-cell header-${oe.id} ${Ce?"sortable":""} ${me?"sorted":""}`,onClick:Ce?()=>Z(oe.id):void 0},Ge.default.createElement("span",null,oe.label),lt&&Ge.default.createElement(lt,{size:14,className:me?"sort-indicator":"sort-indicator-unsorted"}))}))),D&&t&&Ge.default.createElement("div",{ref:W,className:"trade-log-sizer-row","aria-hidden":"true"},_.map(oe=>oe.id==="setups"?Ge.default.createElement("div",{key:oe.id,"data-sizer-col":"setups",className:"trade-setups-cell expanded sizer-cell"},Ge.default.createElement("div",{className:"expanded-pills sizer-pills"},H.setups.map((me,Ce)=>Ge.default.createElement("span",{key:Ce,className:"pill pill--setup"},me)))):oe.id==="mistakes"?Ge.default.createElement("div",{key:oe.id,"data-sizer-col":"mistakes",className:"trade-mistakes-cell expanded sizer-cell"},Ge.default.createElement("div",{className:"expanded-pills sizer-pills"},H.mistakes.map((me,Ce)=>Ge.default.createElement("span",{key:Ce,className:"pill pill--mistake"},me)))):oe.id==="tags"?Ge.default.createElement("div",{key:oe.id,"data-sizer-col":"tags",className:"trade-tags-cell expanded sizer-cell"},Ge.default.createElement("div",{className:"expanded-pills sizer-pills"},H.tags.map((me,Ce)=>Ge.default.createElement("span",{key:Ce,className:"pill pill--tag"},me)))):Ge.default.createElement("div",{key:oe.id}))),t?Ge.default.createElement("div",{style:{position:"relative",height:"100%"}},!n&&Ge.default.createElement(Jk,{visibleColumns:_,gridTemplate:j,containerHeight:h}),Ge.default.createElement("div",{style:{visibility:n?"visible":"hidden",height:"100%"}},Ge.default.createElement(XG,{nodes:O,expandedNodes:c,onToggleExpand:We,onNodeClick:Ke,onTreeReady:Zr,viewLevel:u.viewLevel,visibleColumns:_,gridTemplate:j,selectedTrades:b,onToggleTradeSelection:ne,isMultiSelectMode:x,isExpandedMode:D,requestedScrollOffset:I,onScrollOffsetChange:oe=>{A.current=oe}}))):Ge.default.createElement(Jk,{visibleColumns:_,gridTemplate:j,containerHeight:h}))):t?Ge.default.createElement("div",{style:{position:"relative",height:"100%"}},!n&&Ge.default.createElement(Jk,{visibleColumns:_,gridTemplate:j,containerHeight:h}),Ge.default.createElement("div",{style:{visibility:n?"visible":"hidden",height:"100%"}},Ge.default.createElement(XG,{nodes:O,expandedNodes:c,onToggleExpand:We,onNodeClick:Ke,onTreeReady:Zr,viewLevel:u.viewLevel,visibleColumns:_,gridTemplate:j,selectedTrades:b,onToggleTradeSelection:ne,isMultiSelectMode:x,isExpandedMode:D,requestedScrollOffset:I,onScrollOffsetChange:oe=>{A.current=oe}}))):Ge.default.createElement(Jk,{visibleColumns:_,gridTemplate:j,containerHeight:h})))}});var fSe,Lm,Uz,gSe=F(()=>{fSe=Y(Q());ch();mSe();rl();Lm="journalit-trade-log-view",Uz=class extends nl{constructor(t,r){super(t),this.plugin=r}getDisplayText(){return"Trade Log"}getViewType(){return Lm}getIcon(){return"folder-tree"}async onOpen(){try{await super.onOpen(),Wu(!0,!0,!0,!0,!0,!0,!0,!0,!0),e0(!0,!0,!0,!0,!0,!0,!0,!0,!0,!0),this.containerEl&&this.containerEl.classList.add("journalit-trade-log-view-container")}catch(t){console.error("Error in TradeLogView.onOpen:",t)}}async onClose(){try{await super.onClose()}catch(t){console.error("Error in TradeLogView.onClose:",t)}}getRenderFunction(){return()=>fSe.default.createElement(pSe,{plugin:this.plugin})}}});function vSe(e,t,r,n,i){new iY({app:e,plugin:t,accountName:r,transaction:n,onClose:()=>{},onSave:i}).open()}var gp,rr,hSe,iY,jKe,ySe=F(()=>{gp=require("obsidian"),rr=Y(Q()),hSe=Y(Ni());Ns();hi();_t();Er();iY=class extends gp.Modal{constructor(t){super(t.app),this.props=t;let r=this.props.transaction.type==="deposit"?"Deposit":"Withdrawal";this.titleEl.setText(`Edit ${r}`)}onOpen(){let{contentEl:t}=this;t.empty(),this.container=t.createDiv({cls:"add-event-modal-container"}),this.renderComponent()}onClose(){this.root&&this.root.unmount(),this.props.onClose()}renderComponent(){this.root=(0,hSe.createRoot)(this.container),this.root.render(rr.default.createElement(el,null,rr.default.createElement(jKe,{...this.props,onModalClose:()=>this.close()})))}},jKe=({plugin:e,accountName:t,transaction:r,onSave:n,onModalClose:i})=>{let[a,o]=(0,rr.useState)(!1),[s,l]=(0,rr.useState)(!1),[c,d]=(0,rr.useState)(!1),{currency:u}=ct(),p=()=>new Date().toISOString().split("T")[0],[m,g]=(0,rr.useState)({type:r.type,amount:Math.abs(r.amount).toString(),date:new Date(r.date).toISOString().split("T")[0],description:r.description||""}),f=b=>new Intl.NumberFormat("en-US",{style:"currency",currency:u,minimumFractionDigits:2}).format(Math.abs(b)),v=async()=>{var b;try{if(o(!0),!m.amount||parseFloat(m.amount)<=0){new gp.Notice("Amount must be greater than 0");return}if(!m.date){new gp.Notice("Date is required");return}let k=parseFloat(m.amount);if(!$x(m.date)){new gp.Notice("Invalid date format");return}let x=new Date(m.date),S=new Date;if(S.setHours(23,59,59,999),x>S){new gp.Notice("Transaction date cannot be in the future");return}await((b=e.accountPageService)==null?void 0:b.updateManualTransaction(t,r.id,{amount:k,date:x,description:m.description||void 0}));let w=m.type==="deposit"?"Deposit":"Withdrawal";new gp.Notice(`${w} updated successfully`),n(),i()}catch(k){console.error("Error updating transaction:",k),new gp.Notice(`Error updating transaction: ${k.message}`)}finally{o(!1)}},h=async()=>{var b;try{l(!0),await((b=e.accountPageService)==null?void 0:b.deleteManualTransaction(t,r.id));let k=r.type==="deposit"?"Deposit":"Withdrawal";new gp.Notice(`${k} deleted successfully`),n(),i()}catch(k){console.error("Error deleting transaction:",k),new gp.Notice(`Error deleting transaction: ${k.message}`)}finally{l(!1)}},y=r.type==="deposit"?"Deposit":"Withdrawal";return c?rr.default.createElement("div",{className:"add-event-form"},rr.default.createElement("div",{className:"setting-item"},rr.default.createElement("div",{className:"setting-item-info"},rr.default.createElement("div",{className:"setting-item-name",style:{color:"var(--text-error)"}},"Delete ",y),rr.default.createElement("div",{className:"setting-item-description"},"Are you sure you want to delete this ",y.toLowerCase()," of ",f(r.amount)," from ",zt(new Date(r.date),vn()),"?"),rr.default.createElement("div",{className:"setting-item-description warning"},"This action cannot be undone."))),rr.default.createElement("div",{className:"add-event-buttons"},rr.default.createElement("div",{className:"button-group-right"},rr.default.createElement(Ie,{variant:"secondary",onClick:h,disabled:s,className:"delete-transaction-button",style:{backgroundColor:"var(--color-red)",color:"white",borderColor:"var(--color-red)"}},s?"Deleting...":`Delete ${y}`),rr.default.createElement(Ie,{variant:"secondary",onClick:()=>d(!1),disabled:s,className:"cancel-button"},"Cancel")))):rr.default.createElement("div",{className:"add-event-form"},rr.default.createElement("div",{className:"setting-item two-column"},rr.default.createElement("div",{className:"column"},rr.default.createElement("div",{className:"setting-item-info"},rr.default.createElement("div",{className:"setting-item-name"},"Transaction Type"),rr.default.createElement("div",{className:"setting-item-description"},"Cannot be changed when editing")),rr.default.createElement("div",{className:"setting-item-control"},rr.default.createElement("select",{value:m.type,disabled:!0},rr.default.createElement("option",{value:"deposit"},"Deposit"),rr.default.createElement("option",{value:"withdrawal"},"Withdrawal")))),rr.default.createElement("div",{className:"column"},rr.default.createElement("div",{className:"setting-item-info"},rr.default.createElement("div",{className:"setting-item-name"},"Amount"),rr.default.createElement("div",{className:"setting-item-description"},"Amount in ",u)),rr.default.createElement("div",{className:"setting-item-control"},rr.default.createElement("input",{type:"number",value:m.amount,onChange:b=>g({...m,amount:b.target.value}),onFocus:b=>{(m.amount==="0"||m.amount==="")&&(b.target.value="")},min:"0.01",step:"0.01",placeholder:"0.00",disabled:a})))),rr.default.createElement("div",{className:"setting-item two-column"},rr.default.createElement("div",{className:"column"},rr.default.createElement("div",{className:"setting-item-info"},rr.default.createElement("div",{className:"setting-item-name"},"Date"),rr.default.createElement("div",{className:"setting-item-description"},"Transaction date")),rr.default.createElement("div",{className:"setting-item-control"},rr.default.createElement("input",{type:"date",value:m.date,onChange:b=>g({...m,date:b.target.value}),max:p(),disabled:a}))),rr.default.createElement("div",{className:"column"},rr.default.createElement("div",{className:"setting-item-info"},rr.default.createElement("div",{className:"setting-item-name"},"Description (Optional)"),rr.default.createElement("div",{className:"setting-item-description"},"Additional notes")),rr.default.createElement("div",{className:"setting-item-control"},rr.default.createElement("input",{type:"text",value:m.description,onChange:b=>g({...m,description:b.target.value}),placeholder:m.type==="deposit"?"Manual deposit":"Manual withdrawal",disabled:a})))),rr.default.createElement("div",{className:"add-event-buttons"},rr.default.createElement("div",{className:"button-group-left"},rr.default.createElement(Ie,{variant:"secondary",onClick:()=>d(!0),disabled:a,className:"delete-transaction-button",style:{backgroundColor:"var(--color-red)",color:"white",borderColor:"var(--color-red)"}},"Delete ",y)),rr.default.createElement("div",{className:"button-group-right"},rr.default.createElement(Ie,{variant:"primary",onClick:v,disabled:a,className:"add-event-button accent-button",style:{backgroundColor:"var(--interactive-accent)",color:"var(--text-on-accent)",borderColor:"var(--interactive-accent)"}},a?"Saving...":"Save Changes"),rr.default.createElement(Ie,{variant:"secondary",onClick:i,disabled:a,className:"cancel-button"},"Cancel"))))}});var Ca,_Ke,bSe,xSe=F(()=>{Ca=Y(Q());ug();nr();Ol();hi();Ns();AG();ySe();_t();Er();qt();_Ke=({transaction:e,accountName:t,onUpdate:r})=>{let n=Ae(),{currency:i}=ct(),a=vn(),o=p=>sa(Math.abs(p),!1,i),s=p=>sa(p,!1,i),l=async()=>{n&&vSe(n.app,n,t,e,r)},c=e.type==="deposit",d=c?"Deposit":"Withdrawal",u=c?"deposit":"withdrawal";return Ca.default.createElement("div",{className:`transaction-item ${u} clickable`,onClick:l,title:"Click to edit or delete this transaction"},Ca.default.createElement("div",{className:"transaction-header"},Ca.default.createElement("div",{className:"transaction-primary-info"},Ca.default.createElement("span",{className:`transaction-type ${u}`},d),Ca.default.createElement("span",{className:"transaction-date"},zt(e.date instanceof Date?e.date:new Date(e.date),a))),Ca.default.createElement("span",{className:`transaction-amount ${c?"positive":"negative"}`},c?"+":"-",o(e.amount))),Ca.default.createElement("div",{className:"transaction-details"},e.description&&Ca.default.createElement("div",{className:"transaction-description"},Ca.default.createElement("span",{className:"description-label"},"Description:"),Ca.default.createElement("span",{className:"description-text"},e.description)),Ca.default.createElement("div",{className:"transaction-meta"},Ca.default.createElement("span",{className:"balance-after"},"Balance after: ",s(e.balanceAfter)))))},bSe=()=>{let{accountPageData:e,refreshData:t}=Ec(),r=Ae();if(!e||!r)return null;let{account:n}=e,a=[...(n.transactions||[]).filter(s=>(s.type==="deposit"||s.type==="withdrawal")&&s.description!=="Initial deposit")].filter(s=>s&&s.date).sort((s,l)=>{let c=dn(s.date),d=dn(l.date);return((d==null?void 0:d.getTime())||0)-((c==null?void 0:c.getTime())||0)}),o=async()=>{jz(r.app,r,n.name,t)};return Ca.default.createElement("div",{className:"deposits-withdrawals-section"},Ca.default.createElement("div",{className:"section-header-centered"},Ca.default.createElement("span",{className:"section-header-line"}),Ca.default.createElement("h3",{className:"section-header-title"},"Deposits & Withdrawals (",a.length,")"),Ca.default.createElement("span",{className:"section-header-line"})),a.length===0?Ca.default.createElement("div",{className:"empty-transactions"},Ca.default.createElement(yi,{message:"No manual deposits or withdrawals recorded.",subMessage:"Click the + button in the header to add your first transaction."}),Ca.default.createElement("div",{className:"empty-state-action"},Ca.default.createElement(Ie,{onClick:o,variant:"primary",className:"add-first-transaction-btn"},"Add First Transaction"))):Ca.default.createElement("div",{className:"transactions-list"},a.map(s=>Ca.default.createElement(_Ke,{key:s.id,transaction:s,accountName:n.name,onUpdate:t}))))}});function wSe(){if(gD===0){let e=document.createElement("style");e.id="account-page-skeleton-styles",e.textContent=BKe,document.head.appendChild(e)}gD++}function kSe(){var e;gD--,gD<=0&&(gD=0,(e=document.head.querySelector("#account-page-skeleton-styles"))==null||e.remove())}var BKe,gD,SSe=F(()=>{BKe=`
.account-page-skeleton {
  width: 100%;
  padding: 1.5rem;
  display: flex;
  flex-direction: column;
  gap: 2rem;
  background: var(--background-primary);
}

.account-page-skeleton-header {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  padding-bottom: 1rem;
  border-bottom: 1px solid var(--background-modifier-border);
}

.account-page-skeleton-chart {
  width: 100%;
}

.account-page-skeleton-metrics {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1rem;
}

.skeleton-metric-card {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  padding: 1rem;
  border-radius: 8px;
  background: var(--background-secondary);
}

.account-page-skeleton-risk {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.skeleton-risk-visualizations {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1rem;
}

.account-page-skeleton-transactions,
.account-page-skeleton-trades {
  width: 100%;
}

@media (max-width: 768px) {
  .account-page-skeleton {
    padding: 1rem;
    gap: 1.5rem;
  }

  .account-page-skeleton-metrics {
    grid-template-columns: 1fr;
  }

  .skeleton-risk-visualizations {
    grid-template-columns: 1fr;
  }
}
`,gD=0});var Pa,aY,TSe=F(()=>{Pa=Y(Q());us();ps();fA();SSe();ff();aY=(0,Pa.memo)(()=>((0,Pa.useLayoutEffect)(()=>(tl(),wSe(),()=>{kSe()}),[]),Pa.default.createElement("div",{className:"account-page-skeleton","aria-label":"Loading account page"},Pa.default.createElement("div",{className:"account-page-skeleton-header"},Pa.default.createElement(Qe,{width:"200px",height:"24px"}),Pa.default.createElement(Qe,{width:"120px",height:"16px"})),Pa.default.createElement("div",{className:"account-page-skeleton-chart"},Pa.default.createElement(Yp,{type:"chart"})),Pa.default.createElement("div",{className:"account-page-skeleton-metrics"},Array.from({length:4}).map((e,t)=>Pa.default.createElement("div",{key:t,className:"skeleton-metric-card"},Pa.default.createElement(Qe,{width:"80px",height:"14px"}),Pa.default.createElement(Qe,{width:"100px",height:"20px"})))),Pa.default.createElement("div",{className:"account-page-skeleton-risk"},Pa.default.createElement(Qe,{width:"150px",height:"18px"}),Pa.default.createElement("div",{className:"skeleton-risk-visualizations"},Pa.default.createElement(ae,{width:"100%",height:"120px",borderRadius:"8px"}),Pa.default.createElement(ae,{width:"100%",height:"120px",borderRadius:"8px"}))),Pa.default.createElement("div",{className:"account-page-skeleton-transactions"},Pa.default.createElement(Yp,{type:"table"})),Pa.default.createElement("div",{className:"account-page-skeleton-trades"},Pa.default.createElement(Yp,{type:"table"})))));aY.displayName="AccountPageSkeleton"});var pd,CSe,PSe=F(()=>{pd=Y(Q());ug();Ol();WG();xSe();nr();TSe();CSe=()=>{let{accountPageData:e,isLoading:t,error:r,accountName:n}=Ec(),i=Ae();return t&&!e?pd.default.createElement(aY,null):r?pd.default.createElement("div",{className:"account-page-error"},pd.default.createElement("h3",null,"Error Loading Account"),pd.default.createElement("p",null,r.message)):e?pd.default.createElement("div",{className:"account-page-content"},pd.default.createElement(NG,null),pd.default.createElement(zG,null),pd.default.createElement(FG,null),pd.default.createElement(jG,null),pd.default.createElement(bSe,null),pd.default.createElement(OG,null)):pd.default.createElement(yi,{message:`Could not find account data for "${n}"`,subMessage:"Please check if the account exists or try refreshing the page."})}});var Mc,hp,Qk,WKe,$Ke,DSe=F(()=>{Mc=Y(Q());ch();rl();nr();gI();ug();PSe();hp="journalit-account-page-view",Qk=class extends nl{constructor(r){super(r);this.accountName=""}getDisplayText(){return this.accountName?`Account: ${this.accountName}`:"Account Page"}getViewType(){return hp}getIcon(){return"user-circle"}async onOpen(){try{await super.onOpen(),lh(),this.containerEl&&(this.containerEl.classList.add("journalit-account-page-view-container"),Object.assign(this.containerEl.style,{padding:"0"}))}catch(r){console.error("Error in AccountPageView.onOpen:",r)}}async onClose(){try{await super.onClose()}catch(r){console.error("Error in AccountPageView.onClose:",r)}}setAccountName(r){this.accountName=r,this.leaf&&(this.leaf.view=this)}getAccountName(){return this.accountName}async setState(r,n){await super.setState(r,n),r!=null&&r.accountName&&this.setAccountName(r.accountName)}getState(){return{...super.getState(),accountName:this.accountName}}getRenderFunction(){return()=>Mc.default.createElement(WKe,{leaf:this.leaf,view:this})}},WKe=({leaf:e,view:t})=>{let r=Ae(),n=t.getAccountName();return r?n?Mc.default.createElement("div",{className:"journalit-account-page-view"},Mc.default.createElement($Ke,{accountName:n,plugin:r})):Mc.default.createElement("div",{className:"journalit-account-page-view"},Mc.default.createElement("div",{className:"account-page-error"},Mc.default.createElement("h3",null,"No Account Selected"),Mc.default.createElement("p",null,"Please navigate to this page from the Account Dashboard."))):Mc.default.createElement("div",{className:"journalit-account-page-view"},"Loading...")},$Ke=({accountName:e,plugin:t})=>{let{service:r}=HX();return r?Mc.default.createElement(Vwe,{app:t.app,accountPageService:r,accountName:e,plugin:t},Mc.default.createElement("div",{className:"account-page-wrapper"},Mc.default.createElement(CSe,null))):Mc.default.createElement("div",{className:"account-page-loading"},Mc.default.createElement("p",null,"Loading account page service..."))}});var Tn,ESe,oY,ISe,MSe=F(()=>{Tn=Y(Q()),ESe=require("obsidian");Ot();Zs();oY=3,ISe=({plugin:e,selectedAccountName:t,onAccountSelect:r})=>{let[n,i]=(0,Tn.useState)([]),[a,o]=(0,Tn.useState)(!0),[s,l]=(0,Tn.useState)(!1),[c,d]=(0,Tn.useState)(e.settings.csvFavoriteAccount),u=(0,Tn.useCallback)(async()=>{try{o(!0);let k=(await(await e.serviceManager.getAccountPageService()).getAllEnhancedAccounts()).filter(x=>!x.accountType||x.accountType.toLowerCase()!=="archived").map(x=>({value:x.accountName||x.name,label:x.accountName||x.name}));if(i(k),!t){let x=e.settings.csvFavoriteAccount;x&&k.some(S=>S.value===x)?r(x):k.length===1&&r(k[0].value)}}catch(h){console.error("Failed to load accounts:",h),new ESe.Notice("Failed to load accounts")}finally{o(!1)}},[e,t,r]);(0,Tn.useEffect)(()=>{u()},[]),Xe("account:changed",u);let p=(0,Tn.useCallback)(h=>{r(h)},[r]),m=(0,Tn.useCallback)(async(h,y)=>{y.stopPropagation();let b=c===h?void 0:h;d(b);try{e.settings.csvFavoriteAccount=b,await e.settingsManager.saveSettings(e.settings)}catch(k){console.error("[CSV] Failed to save favorite account:",k),d(c)}},[e,c]),g=(0,Tn.useMemo)(()=>[...n].sort((h,y)=>h.value===c?-1:y.value===c?1:0),[n,c]),f=s?g:g.slice(0,oY),v=g.length>oY;return a?Tn.default.createElement("div",{className:"csv-loading"},Tn.default.createElement("div",{className:"csv-spinner"}),Tn.default.createElement("span",null,"Loading accounts...")):n.length===0?Tn.default.createElement("div",{className:"csv-message csv-message--error"},Tn.default.createElement("strong",null,"No accounts found.")," Please create an account before importing trades."):Tn.default.createElement("div",{className:"csv-account-selector"},Tn.default.createElement("label",{className:"csv-label"},"Select Account",Tn.default.createElement("span",{className:"csv-required"},"*")),Tn.default.createElement("div",{className:"csv-account-radio-group"},f.map(h=>Tn.default.createElement("div",{key:h.value,className:`csv-select-item ${t===h.value?"selected":""} ${c===h.value?"favorite":""}`,onClick:()=>p(h.value)},Tn.default.createElement("span",{className:"csv-select-item-label"},h.label),Tn.default.createElement("button",{className:`csv-select-item-star ${c===h.value?"active":""}`,onClick:y=>m(h.value,y),"aria-label":c===h.value?"Remove from favorites":"Set as favorite"},Tn.default.createElement(rf,{size:14,fill:c===h.value?"currentColor":"none"})))),v&&Tn.default.createElement("button",{className:"csv-account-show-more",onClick:()=>l(!s)},s?Tn.default.createElement(Tn.default.Fragment,null,Tn.default.createElement(_v,{size:14})," Show less"):Tn.default.createElement(Tn.default.Fragment,null,Tn.default.createElement(cs,{size:14})," Show ",g.length-oY," more"))),Tn.default.createElement("div",{className:"csv-helper-text"},c?"Your favorite is auto-selected":"Star an account to auto-select it"))}});var ht,ASe,sY,NSe,LSe,FSe=F(()=>{ht=Y(Q());Ot();ASe=[{value:"IBKR",label:"Interactive Brokers (IBKR)"},{value:"TRADOVATE",label:"Tradovate"},{value:"TRADEZERO",label:"TradeZero"},{value:"TRADINGVIEW",label:"TradingView Paper Trading"},{value:"BYBIT",label:"Bybit (USDT Perpetuals)"},{value:"BLOFIN",label:"Blofin"},{value:"HYPERLIQUID",label:"Hyperliquid (Perpetuals)"}],sY=4,NSe=ht.default.memo(({plugin:e,selectedValue:t,onSelect:r,onTemplateLoad:n,localTemplateService:i,refreshTrigger:a})=>{let[o,s]=(0,ht.useState)([]),[l,c]=(0,ht.useState)(!0),[d,u]=(0,ht.useState)(!1),[p,m]=(0,ht.useState)(!1),g=(0,ht.useRef)(!1),[f,v]=(0,ht.useState)(()=>new Set(e.settings.csvHiddenBrokers||[])),[h,y]=(0,ht.useState)(e.settings.csvFavoriteBroker);(0,ht.useEffect)(()=>{b()},[a]),(0,ht.useEffect)(()=>{if(!g.current&&!t&&h&&!f.has(h)){let L=h.startsWith("template-");if(L&&o.length===0)return;if(L){let E=h.replace("template-",""),T=o.find($=>$.id===E);T&&(n==null||n(T))}r(h,L),g.current=!0}},[h,o.length,t,f,r,n]);let b=()=>{try{c(!0);let L=i.getTemplates();s(L)}catch(L){console.error("Failed to load templates:",L)}finally{c(!1)}},k=(0,ht.useCallback)(L=>{if(!L)return;let E=L.startsWith("template-");if(E){let T=L.replace("template-",""),$=o.find(_=>_.id===T);$&&n&&n($)}r(L,E)},[o,r,n]),x=(0,ht.useCallback)(async(L,E)=>{E.stopPropagation();let T=h===L?void 0:L;y(T);try{e.settings.csvFavoriteBroker=T,await e.settingsManager.saveSettings(e.settings)}catch($){console.error("[CSV] Failed to save favorite broker:",$),y(h)}},[e,h]),S=(0,ht.useCallback)(async(L,E)=>{E.stopPropagation();let T=new Set(f);T.add(L),v(T),h===L&&(y(void 0),e.settings.csvFavoriteBroker=void 0),t===L&&r("",!1);try{e.settings.csvHiddenBrokers=Array.from(T),await e.settingsManager.saveSettings(e.settings)}catch($){console.error("[CSV] Failed to save hidden brokers:",$)}},[e,f,h,t,r]),w=(0,ht.useCallback)(async L=>{let E=new Set(f);E.delete(L),v(E);try{e.settings.csvHiddenBrokers=Array.from(E),await e.settingsManager.saveSettings(e.settings)}catch(T){console.error("[CSV] Failed to restore broker:",T)}},[e,f]),C=(0,ht.useCallback)(async()=>{v(new Set),u(!1);try{e.settings.csvHiddenBrokers=[],await e.settingsManager.saveSettings(e.settings)}catch(L){console.error("[CSV] Failed to restore all brokers:",L)}},[e]),D=(0,ht.useMemo)(()=>ASe.filter(E=>!f.has(E.value)).sort((E,T)=>E.value===h?-1:T.value===h?1:0),[f,h]),P=(0,ht.useMemo)(()=>o.filter(E=>!f.has(`template-${E.id}`)).sort((E,T)=>{let $=`template-${E.id}`,_=`template-${T.id}`;return $===h?-1:_===h?1:0}),[o,f,h]),M=(0,ht.useMemo)(()=>{let L=[];return ASe.forEach(E=>{f.has(E.value)&&L.push(E)}),o.forEach(E=>{f.has(`template-${E.id}`)&&L.push({value:`template-${E.id}`,label:E.name})}),L},[f,o]),z=(0,ht.useMemo)(()=>{let L=[];return D.forEach(E=>{L.push({...E,isTemplate:!1,section:"broker"})}),P.forEach(E=>{L.push({value:`template-${E.id}`,label:E.name,isTemplate:!0,section:"template"})}),L},[D,P]),A=p?z:z.slice(0,sY),I=z.length>sY;return l?ht.default.createElement("div",{className:"csv-loading"},ht.default.createElement("div",{className:"csv-spinner"}),ht.default.createElement("span",null,"Loading brokers...")):ht.default.createElement("div",{className:"csv-broker-radio-selector"},ht.default.createElement("div",{className:"csv-broker-radio-header"},ht.default.createElement("label",{className:"csv-label"},"Broker / Import Format",ht.default.createElement("span",{className:"csv-required"},"*")),M.length>0&&ht.default.createElement("button",{className:"csv-broker-manage-btn",onClick:()=>u(!0),"aria-label":"Manage hidden brokers"},ht.default.createElement(yT,{size:14}),ht.default.createElement("span",null,M.length," hidden"))),ht.default.createElement("div",{className:"csv-broker-radio-group"},A.map((L,E)=>{let T=E===0&&L.section==="broker",$=L.section==="template"&&(E===0||A[E-1].section!=="template");return ht.default.createElement(ht.default.Fragment,{key:L.value},T&&D.length>0&&ht.default.createElement("div",{className:"csv-broker-radio-group-label"},"Supported Brokers"),$&&P.length>0&&ht.default.createElement("div",{className:"csv-broker-radio-group-label"},"My Templates"),ht.default.createElement(LSe,{value:L.value,label:L.label,isSelected:t===L.value,isFavorite:h===L.value,onSelect:k,onToggleFavorite:x,onHide:S}))}),I&&ht.default.createElement("button",{className:"csv-broker-show-more",onClick:()=>m(!p)},p?ht.default.createElement(ht.default.Fragment,null,ht.default.createElement(_v,{size:14})," Show less"):ht.default.createElement(ht.default.Fragment,null,ht.default.createElement(cs,{size:14})," Show ",z.length-sY," more"))),ht.default.createElement("div",{className:"csv-broker-radio-group",style:{marginTop:"8px"}},ht.default.createElement(LSe,{value:"MANUAL",label:"+ Create New Format",isSelected:t==="MANUAL",isFavorite:!1,onSelect:k,hideActions:!0})),ht.default.createElement("div",{className:"csv-helper-text"},h?"Your favorite is auto-selected":"Star a broker to auto-select it"),d&&ht.default.createElement("div",{className:"csv-broker-manage-overlay",onClick:()=>u(!1)},ht.default.createElement("div",{className:"csv-broker-manage-modal",onClick:L=>L.stopPropagation()},ht.default.createElement("div",{className:"csv-broker-manage-modal-header"},ht.default.createElement("h3",null,"Hidden Brokers"),ht.default.createElement("button",{className:"csv-broker-manage-close",onClick:()=>u(!1)},"\xD7")),ht.default.createElement("div",{className:"csv-broker-manage-modal-content"},M.length===0?ht.default.createElement("p",{className:"csv-broker-manage-empty"},"No hidden brokers"):ht.default.createElement(ht.default.Fragment,null,ht.default.createElement("ul",{className:"csv-broker-manage-list"},M.map(L=>ht.default.createElement("li",{key:L.value},ht.default.createElement("span",null,L.label),ht.default.createElement("button",{className:"csv-button csv-button-secondary",onClick:()=>w(L.value)},"Restore")))),ht.default.createElement("button",{className:"csv-button csv-button-secondary csv-broker-restore-all",onClick:C},"Restore All"))))))}),LSe=({value:e,label:t,isSelected:r,isFavorite:n,onSelect:i,onToggleFavorite:a,onHide:o,hideActions:s=!1})=>ht.default.createElement("div",{className:`csv-select-item ${r?"selected":""} ${n?"favorite":""}`,onClick:()=>i(e)},ht.default.createElement("span",{className:"csv-select-item-label"},t),!s&&ht.default.createElement("div",{className:"csv-select-item-actions"},o&&ht.default.createElement("button",{className:"csv-select-item-hide",onClick:l=>o(e,l),"aria-label":"Hide this broker"},ht.default.createElement(Wv,{size:14})),a&&ht.default.createElement("button",{className:`csv-select-item-star ${n?"active":""}`,onClick:l=>a(e,l),"aria-label":n?"Remove from favorites":"Set as favorite"},ht.default.createElement(rf,{size:14,fill:n?"currentColor":"none"}))))});var Ac,RKe,UKe,lY,OSe=F(()=>{Ac=Y(Q());Ot();RKe={TRADOVATE:{steps:['Navigate to "Reports" tab on Tradovate website','Click on "Orders" tab (NOT Performance tab)','Click "Download CSV" button'],warning:{emphasis:"Important:",message:"Use Orders tab only. The Performance tab is not compatible."},documentationUrl:"https://journalit.co/docs/broker-guides-tradovate",documentationLabel:"View detailed guide"},IBKR:{description:"One-time Flex Query setup required",steps:["Navigate to Performance & Statements \u2192 Reports \u2192 Flex Queries",'Create new "Trade Confirmation" query (select Orders, deselect Executions)','Set format: CSV, Date "yyyyMMdd", Time "HHmmss"',"Run query and download CSV file"],warning:{emphasis:"Must use Orders",message:"(not Executions) with specific date/time format"},documentationUrl:"https://journalit.co/docs/broker-guides-ibkr",documentationLabel:"View detailed setup guide"},TRADEZERO:{steps:["Export CSV file from TradeZero platform","Verify file is CSV format (NOT XLSX)","Import the file below"],warning:{emphasis:"Only CSV format supported.",message:"Excel (XLSX) files will not work."},documentationUrl:"https://journalit.co/docs/broker-guides-tradezero",documentationLabel:"View export instructions"},TRADINGVIEW:{description:"Paper Trading account only",steps:['Click on the "Paper Trading" broker type in TradingView','Click "Export data..." button','Select "Order History" from the dropdown'],warning:{emphasis:"Must use Order History.",message:"Other export types (such as Positions or Orders) will not work for import."},documentationUrl:"https://journalit.co/docs/broker-guides-tradingview",documentationLabel:"View detailed guide"},BYBIT:{description:"USDT Perpetuals Trade History",steps:["Go to Bybit \u2192 Orders \u2192 USDT Perpetual \u2192 Trade History",'Click "Export" button and select date range',"Download the Trade History CSV file (NOT Closed P&L)"],warning:{emphasis:"Use Trade History export.",message:"The Closed P&L export is missing commission data and individual fills."},documentationUrl:"https://journalit.co/docs/broker-guides-bybit",documentationLabel:"View export instructions"},BLOFIN:{description:"Blofin Order History Export (Website only)",steps:["Go to Assets \u2192 Order Center \u2192 Order History","Click Download, select Futures, and choose date range (max 180 days)","Click Export and wait for notification when ready"],warning:{emphasis:"Website only.",message:"Mobile app does not support exports. Files are available for 30 days after export."},documentationUrl:"https://journalit.co/docs/broker-guides-blofin",documentationLabel:"View export instructions"},HYPERLIQUID:{description:"Perpetuals Trade History",steps:["Connect wallet on Hyperliquid",'Click "Trade history" tab at the bottom of the page','Click "Export to CSV" button'],warning:{emphasis:"10,000 entry limit.",message:"Export regularly - older trades beyond 10,000 entries cannot be retrieved."},documentationUrl:"https://journalit.co/docs/broker-guides-hyperliquid",documentationLabel:"View export instructions"}},UKe=({brokerType:e})=>{let t=RKe[e];return t?Ac.default.createElement("div",{className:"broker-guide-content"},t.description&&Ac.default.createElement("p",{className:"broker-guide-description"},t.description),Ac.default.createElement("ol",{className:"broker-guide-steps"},t.steps.map((r,n)=>Ac.default.createElement("li",{key:n},r))),Ac.default.createElement("div",{className:"broker-guide-warning"},Ac.default.createElement(Dp,{size:16,className:"broker-guide-warning-icon"}),Ac.default.createElement("span",null,t.warning.emphasis&&Ac.default.createElement("strong",null,t.warning.emphasis," "),t.warning.message)),Ac.default.createElement("a",{href:t.documentationUrl,target:"_blank",rel:"noopener noreferrer",className:"broker-guide-link"},Ac.default.createElement(Ov,{size:16}),t.documentationLabel,Ac.default.createElement(aT,{size:12}))):null},lY=(0,Ac.memo)(UKe);lY.displayName="BrokerGuide"});var vp,cY,zSe,jSe=F(()=>{vp=Y(Q()),cY=require("obsidian"),zSe=vp.default.memo(({onFileSelect:e,disabled:t=!1})=>{let[r,n]=(0,vp.useState)(!1),i=(0,vp.useRef)(null),a=u=>{let p=u.target.files;p&&p[0]&&c(p[0])},o=u=>{if(u.preventDefault(),u.stopPropagation(),n(!1),t)return;let p=u.dataTransfer.files;p&&p[0]&&c(p[0])},s=u=>{u.preventDefault(),u.stopPropagation(),t||n(!0)},l=u=>{u.preventDefault(),u.stopPropagation(),n(!1)},c=u=>{if(!u.name.endsWith(".csv")){new cY.Notice("Please select a CSV file");return}let p=10*1024*1024;if(u.size>p){new cY.Notice("File is too large. Maximum size is 10MB");return}e(u)};return vp.default.createElement("div",{className:`csv-upload-area ${r?"dragover":""} ${t?"disabled":""}`,onClick:()=>{!t&&i.current&&i.current.click()},onDrop:o,onDragOver:s,onDragLeave:l},vp.default.createElement("input",{ref:i,type:"file",accept:".csv",onChange:a,style:{display:"none"},disabled:t}),vp.default.createElement("div",{className:"csv-upload-icon"},"\u{1F4C4}"),vp.default.createElement("div",{className:"csv-upload-text"},r?"Drop CSV file here":"Click to upload or drag and drop"),vp.default.createElement("div",{className:"csv-upload-hint"},"CSV files only, max 10MB"))})});var tc,_Se,BSe=F(()=>{tc=Y(Q()),_Se=tc.default.memo(({data:e,maxRows:t=10})=>{let r=e.rows.slice(0,t),n=e.rows.length>t;return tc.default.createElement("div",{className:"csv-preview-container"},tc.default.createElement("div",{className:"csv-preview-header"},"CSV Preview (",e.rowCount," total rows)",n&&` - Showing first ${t}`),tc.default.createElement("div",{className:"csv-preview-table-wrapper"},tc.default.createElement("table",{className:"csv-preview-table"},tc.default.createElement("thead",null,tc.default.createElement("tr",null,tc.default.createElement("th",{style:{width:"50px"}},"#"),e.headers.map((i,a)=>tc.default.createElement("th",{key:a},i||`Column ${a+1}`)))),tc.default.createElement("tbody",null,r.map((i,a)=>tc.default.createElement("tr",{key:a},tc.default.createElement("td",{style:{color:"var(--text-muted)",fontSize:"12px"}},a+1),i.map((o,s)=>tc.default.createElement("td",{key:s},o))))))),n&&tc.default.createElement("div",{className:"csv-preview-footer",style:{padding:"12px",textAlign:"center",color:"var(--text-muted)",fontSize:"13px"}},"+ ",e.rowCount-t," more rows"))})});var WSe,$Se,RSe=F(()=>{WSe=[{value:"",label:"Auto-detect (recommended for ISO/standard formats)"},{value:"MM/dd/yyyy",label:"US Date: 12/25/2024 (Schwab, Fidelity, E*TRADE)"},{value:"MM/dd/yyyy HH:mm:ss",label:"US DateTime: 12/25/2024 14:30:00 (Webull)"},{value:"M/d/yyyy",label:"US Short: 1/5/2024 (TradeZero)"},{value:"M/d/yyyy HH:mm:ss",label:"US Short DateTime: 1/5/2024 14:30:00"},{value:"yyyy-MM-dd HH:mm:ss",label:"ISO DateTime: 2024-12-25 14:30:00 (Bybit, Tradovate)"},{value:"yyyy-MM-dd",label:"ISO Date: 2024-12-25 (Interactive Brokers)"},{value:"dd/MM/yyyy",label:"EU Date: 25/12/2024 (day/month/year)"},{value:"dd/MM/yyyy HH:mm:ss",label:"EU DateTime: 25/12/2024 14:30:00"},{value:"dd-MM-yyyy",label:"EU Dash: 25-12-2024"},{value:"dd-MM-yyyy HH:mm:ss",label:"EU Dash DateTime: 25-12-2024 14:30:00"}],$Se=["symbol","direction","entry_time","exit_time","entry_price","exit_price","quantity","commission","profit_loss","notes","tags","asset_type","strike_price","expiration_date","option_type","contract_size","order_id","account_id","status"]});var Ft,USe,HSe=F(()=>{Ft=Y(Q());Zv();RSe();nv();USe=({csvHeaders:e,initialMappings:t={},initialAssetType:r="stock",initialDateFormat:n="",onMappingsChange:i,onAssetTypeChange:a,onDateFormatChange:o,sampleRows:s=[]})=>{let[l,c]=(0,Ft.useState)(()=>{let z={};return e.forEach(A=>{z[A]=t[A]||""}),z}),[d,u]=(0,Ft.useState)(r),[p,m]=(0,Ft.useState)(n);(0,Ft.useEffect)(()=>{if(!t)return;let z={};e.forEach(A=>{z[A]=t[A]||""}),c(z)},[t,e]);let g=(z,A)=>{c(I=>{let L={...I,[z]:A};return i(L),L})},f=z=>{u(z),a(z)},v=z=>{m(z),o==null||o(z)},h=z=>{let A=Object.entries(l).filter(([I,L])=>I!==z&&L!=="").map(([I,L])=>L);return[{value:"",label:"Do not import"},...$Se.filter(I=>!A.includes(I)).map(I=>({value:I,label:y(I)}))]},y=z=>({symbol:"Symbol",direction:"Direction (Long/Short)",entry_time:"Entry Time",exit_time:"Exit Time",entry_price:"Entry Price",exit_price:"Exit Price",quantity:"Quantity",commission:"Commission",profit_loss:"Profit/Loss",notes:"Notes",tags:"Tags",asset_type:"Asset Type",strike_price:"Strike Price",expiration_date:"Expiration Date",option_type:"Option Type",contract_size:"Contract Size",order_id:"Order ID",account_id:"Account ID",status:"Status"})[z]||z,b={strike_price:"Required for options trades",expiration_date:"Required for options trades",option_type:"Required for options (call or put)",contract_size:"Multiplier for options (usually 100) or futures",order_id:"Used to aggregate partial fills",asset_type:"stock, options, futures, forex, crypto",status:"Trade status: OPEN or CLOSED"},k=()=>{let z=S(d),I={"Required Fields":["symbol","direction","entry_time","entry_price","quantity"],"Optional Core Fields":["exit_time","commission","profit_loss","status"],Identifiers:["order_id","account_id"],Other:["notes","tags"]};return d==="options"?I["Options Fields"]=["strike_price","expiration_date","option_type","contract_size"]:d==="futures"&&(I["Futures Fields"]=["contract_size","expiration_date"]),I},x=z=>{if(!s||s.length===0)return"";let A=e.indexOf(z);if(A===-1)return"";let I=s[0];if(!I||!I[A])return"";let L=I[A];return L.length>30?L.substring(0,30)+"...":L},S=z=>{let A=["symbol","direction","entry_time","entry_price","quantity"];switch(z){case"options":return A;case"futures":return A;case"forex":return[...A];case"crypto":return[...A];default:return A}},w=z=>S(d).includes(z),C=()=>{let z=Object.values(l).filter(L=>L!==""),I=S(d).filter(L=>!z.includes(L));return{valid:I.length===0,missingFields:I}},D=()=>{let z=new Set(Object.values(l).filter(L=>L!=="")),A=k(),I={};return Object.entries(A).forEach(([L,E])=>{I[L]={mapped:E.filter(T=>z.has(T)),unmapped:E.filter(T=>!z.has(T))}}),I},P=C(),M=D();return Ft.default.createElement("div",{className:"csv-column-mapper"},Ft.default.createElement("div",{className:"csv-mapper-header"},Ft.default.createElement("h3",null,"Map CSV Columns to Trade Fields"),Ft.default.createElement("p",null,"Match your CSV columns to the trade fields they represent.")),Ft.default.createElement("div",{className:"asset-type-selector"},Ft.default.createElement("h3",null,"Asset Type ",Ft.default.createElement("span",{className:"csv-required"},"*")),Ft.default.createElement("p",{className:"csv-helper-text"},"Select the type of instrument in this CSV. This determines required fields and parsing logic."),Ft.default.createElement("div",{className:"asset-type-buttons"},Ft.default.createElement("button",{className:`asset-type-button ${d==="stock"?"active":""}`,onClick:()=>f("stock")},"Stock"),Ft.default.createElement("button",{className:`asset-type-button ${d==="options"?"active":""}`,onClick:()=>f("options")},"Options"),Ft.default.createElement("button",{className:`asset-type-button ${d==="futures"?"active":""}`,onClick:()=>f("futures")},"Futures"),Ft.default.createElement("button",{className:`asset-type-button ${d==="forex"?"active":""}`,onClick:()=>f("forex")},"Forex"),Ft.default.createElement("button",{className:`asset-type-button ${d==="crypto"?"active":""}`,onClick:()=>f("crypto")},"Crypto"))),Ft.default.createElement("div",{className:"date-format-selector"},Ft.default.createElement("h3",null,"Date Format in CSV"),Ft.default.createElement("p",{className:"csv-helper-text"},"How dates appear in your CSV file. Important for ambiguous formats like 01/02/2024 (Jan 2 vs Feb 1)."),Ft.default.createElement("div",{style:{maxWidth:"400px"}},Ft.default.createElement(Xi,{id:"date-format-select",value:p,onChange:v,options:WSe,placeholder:"Select date format..."}))),Ft.default.createElement("div",{className:"csv-message--info",style:{marginTop:"12px",padding:"10px"}},Ft.default.createElement("strong",null,"Tip: Map Additional Fields"),Ft.default.createElement("p",{style:{margin:"6px 0 0 0",fontSize:"0.9em"}},"Mapping optional fields like commission and profit_loss provides more complete trade data and better duplicate detection accuracy.")),!P.valid&&Ft.default.createElement("div",{className:"csv-message csv-message--error",style:{marginBottom:"20px"}},Ft.default.createElement("strong",null,"Missing required fields for ",d,":")," ",P.missingFields.map(z=>y(z)).join(", ")),Ft.default.createElement("div",{className:"csv-mapper-grid-container"},Ft.default.createElement("div",{className:"csv-mapper-grid"},e.map((z,A)=>{let I=l[z],L=w(I);return Ft.default.createElement("div",{key:A,className:"csv-mapper-row"},Ft.default.createElement("div",{className:"csv-mapper-source"},Ft.default.createElement("div",{className:"csv-column-header"},Ft.default.createElement("div",{className:"csv-column-name"},z),x(z)&&Ft.default.createElement("div",{className:"csv-column-sample"},"Example: ",Ft.default.createElement("span",{className:"csv-sample-value"},x(z))))),Ft.default.createElement("div",{className:"csv-mapper-arrow"},"\u2192"),Ft.default.createElement("div",{className:"csv-mapper-target"},Ft.default.createElement(Xi,{value:I,onChange:E=>g(z,E),options:h(z)}),L&&Ft.default.createElement("span",{className:"csv-required-badge"},"Required")))}))),Ft.default.createElement("div",{className:"csv-mapper-summary",style:{marginTop:"24px",padding:"16px",background:"var(--background-secondary)",borderRadius:"6px"}},Ft.default.createElement("strong",null,"Summary:")," ",Object.values(l).filter(z=>z!=="").length," of ",e.length," columns mapped",P.valid&&Ft.default.createElement("span",{style:{color:"var(--text-success)",marginLeft:"12px"}},"\u2713 All required fields mapped")),Ft.default.createElement("div",{style:{marginTop:"32px"}},Ft.default.createElement(ri,{title:"Available Trade Fields",defaultExpanded:!1},Ft.default.createElement("div",{className:"csv-mapper-fields-reference"},Ft.default.createElement("p",{style:{marginBottom:"16px",color:"var(--text-muted)"}},"Organized by category with descriptions for asset-specific fields"),Object.entries(M).map(([z,{mapped:A,unmapped:I}])=>A.length===0&&I.length===0?null:Ft.default.createElement("div",{key:z,className:"csv-field-category",style:{marginBottom:"20px"}},Ft.default.createElement("h4",{style:{fontSize:"13px",fontWeight:"600",marginBottom:"8px",color:"var(--text-normal)"}},z),Ft.default.createElement("div",{style:{paddingLeft:"12px"}},A.map(L=>Ft.default.createElement("div",{key:L,className:"csv-field-item",style:{marginBottom:"6px",color:"var(--text-success)",fontSize:"12px"}},Ft.default.createElement("span",{style:{marginRight:"8px"}},"\u2713"),Ft.default.createElement("strong",null,y(L)),w(L)&&Ft.default.createElement("span",{style:{marginLeft:"8px",padding:"2px 6px",background:"var(--interactive-accent)",color:"white",borderRadius:"3px",fontSize:"10px",fontWeight:"bold"}},"REQUIRED"),b[L]&&Ft.default.createElement("span",{style:{marginLeft:"8px",color:"var(--text-muted)",fontStyle:"italic"}},"\u2014 ",b[L]))),I.map(L=>Ft.default.createElement("div",{key:L,className:"csv-field-item",style:{marginBottom:"6px",color:"var(--text-muted)",fontSize:"12px"}},Ft.default.createElement("span",{style:{marginRight:"8px"}},"\u25CB"),y(L),w(L)&&Ft.default.createElement("span",{style:{marginLeft:"8px",padding:"2px 6px",background:"var(--text-error)",color:"white",borderRadius:"3px",fontSize:"10px",fontWeight:"bold"}},"REQUIRED"),b[L]&&Ft.default.createElement("span",{style:{marginLeft:"8px",color:"var(--text-muted)",fontStyle:"italic"}},"\u2014 ",b[L]))))))))))}});var Hz,qSe=F(()=>{vm();Hz=class{async getAIMappingSuggestions(t,r){try{let n=Bt.buildUrl("/api/v1/csv/ai-analyze"),i=await Bt.makeRequest(n,{method:"POST",body:JSON.stringify({headers:t,sample_rows:r})},"ai-analyze-csv");if(!(i!=null&&i.suggested_mappings))return console.log("[AI Mapping] No suggested_mappings in response"),{};let a={};for(let[o,s]of Object.entries(i.suggested_mappings))s&&s.trade_field&&(a[o]=s.trade_field);return console.log("[AI Mapping] Extracted from backend:",a),a}catch(n){throw console.error("AI mapping failed:",n),new Error("AI mapping unavailable")}}}});var as,qz,VSe,GSe=F(()=>{as=Y(Q()),qz=require("obsidian");qSe();VSe=({csvHeaders:e,sampleRows:t,onMappingsSuggested:r,disabled:n=!1})=>{let[i,a]=(0,as.useState)(!1),[o,s]=(0,as.useState)(""),[l,c]=(0,as.useState)(""),d=new Hz;return as.default.createElement("div",{className:"csv-ai-map-section"},as.default.createElement("div",{className:"csv-ai-map-header"},as.default.createElement("h4",null,"Need Help?"),as.default.createElement("p",null,"AI can analyze your CSV and suggest field mappings (optional)")),as.default.createElement("button",{type:"button",className:"csv-button csv-button-secondary csv-ai-button",onClick:async()=>{a(!0),s("Analyzing CSV structure"),c("");let p=setInterval(()=>{c(v=>v==="..."?"":v+".")},500),m=setTimeout(()=>s("Consulting AI for column mappings"),5e3),g=setTimeout(()=>s("Processing AI suggestions"),1e4),f=setTimeout(()=>s("Taking longer than usual, still working"),2e4);try{let v=t.slice(0,5),h=await d.getAIMappingSuggestions(e,v);if(console.log("[AI Mapping] Final extracted mappings:",h,"Count:",Object.keys(h).length),!(Object.keys(h).length>0&&Object.values(h).some(b=>b&&b.trim()!==""))){new qz.Notice("AI could not suggest mappings. Please map manually.");return}r(h),new qz.Notice(`AI suggested mappings for ${Object.keys(h).length} columns`)}catch(v){console.warn("AI mapping failed (backend may be offline):",v),new qz.Notice("AI mapping unavailable. Please map columns manually or use a saved template.")}finally{clearInterval(p),clearTimeout(m),clearTimeout(g),clearTimeout(f),a(!1),s(""),c("")}},disabled:n||i,title:"Uses AI to suggest column mappings. Requires backend connection."},i?as.default.createElement(as.default.Fragment,null,as.default.createElement("div",{className:"csv-spinner-small"}),as.default.createElement("span",null,o,l)):as.default.createElement(as.default.Fragment,null,as.default.createElement("span",null,"\u2728"),as.default.createElement("span",null,"Suggest Mappings with AI"))),as.default.createElement("div",{className:"csv-helper-text"},"AI suggestions should be verified before importing \u2014 always review mappings for accuracy."))}});var rx,rc,YSe,Vz,HKe,KSe=F(()=>{rx=require("obsidian"),rc=Y(Q()),YSe=Y(Ni()),Vz=class extends rx.Modal{constructor(r){super(r.app);this.root=null;this.mounted=!0;this.props=r,this.titleEl.setText("Save Import Template")}onOpen(){let{contentEl:r}=this;r.empty(),this.container=r.createDiv({cls:"csv-modal-container"}),this.root=(0,YSe.createRoot)(this.container),this.root.render(rc.default.createElement(HKe,{...this.props,onClose:()=>this.close(),isMounted:()=>this.mounted}))}onClose(){this.mounted=!1,this.root&&this.root.unmount(),this.props.onCancel()}},HKe=({columnMappings:e,assetType:t,dateFormat:r,onSave:n,onClose:i,localTemplateService:a,isMounted:o})=>{let[s,l]=(0,rc.useState)(""),[c,d]=(0,rc.useState)(!1);return rc.default.createElement(rc.default.Fragment,null,rc.default.createElement("p",null,"Save these column mappings as a reusable template for future imports."),rc.default.createElement("div",{className:"csv-dialog-body"},rc.default.createElement("div",{className:"csv-dialog-form-container"},rc.default.createElement("label",{htmlFor:"template-name",className:"csv-dialog-label"},"Template Name"),rc.default.createElement("input",{id:"template-name",type:"text",value:s,onChange:p=>l(p.target.value),placeholder:"e.g., My Broker Format",autoFocus:!0,disabled:c,className:"csv-dialog-input"}))),rc.default.createElement("div",{className:"csv-dialog-actions"},rc.default.createElement("button",{type:"button",className:"csv-button csv-button-primary",onClick:async()=>{let p=s.trim();if(!p){new rx.Notice("Please enter a template name");return}if(a.templateNameExists(p)){new rx.Notice("Template name already exists");return}d(!0);try{let m=await a.createTemplate({name:p,broker_type:"MANUAL",asset_type:t,column_mappings:e,date_format:r||void 0,has_headers:!0});new rx.Notice(`Template "${p}" saved successfully`),n(m.id,m.name),i()}catch(m){console.error("Failed to save template:",m),new rx.Notice("Failed to save template: "+(m instanceof Error?m.message:"Unknown error"))}finally{o()&&d(!1)}},disabled:c||!s.trim()},c?"Saving...":"Save Template"),rc.default.createElement("button",{type:"button",className:"csv-button csv-button-secondary",onClick:i,disabled:c},"Cancel")))}});function qKe(e){let t=new TextEncoder().encode(e),r="";for(let n=0;n<t.length;n++)r+=String.fromCharCode(t[n]);return btoa(r)}function VKe(e){let t=atob(e),r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return new TextDecoder().decode(r)}function Gz(e){let t={name:e.name,broker_type:e.broker_type,asset_type:e.asset_type,column_mappings:e.column_mappings,date_format:e.date_format,delimiter:e.delimiter,has_headers:e.has_headers},r=JSON.stringify(t);return`JTT-v1-${qKe(r)}`}function dY(e){if(!e.startsWith("JTT-"))throw new Error("Invalid template code: Must start with JTT-");if(e.length>GKe)throw new Error("Template code too large (possible corruption)");let t=e.split("-");if(t.length!==3)throw new Error("Invalid template code: Incorrect format");let[r,n,i]=t;if(n!=="v1")throw new Error(`Unsupported template version: ${n}. Please update your plugin.`);let a;try{a=VKe(i)}catch(l){throw new Error("Invalid template code: Base64 decoding failed")}let o;try{o=JSON.parse(a)}catch(l){throw new Error("Invalid template code: JSON parsing failed")}if(!o.name||!o.broker_type||!o.column_mappings)throw new Error("Invalid template code: Missing required fields");if(typeof o.name!="string"||o.name.trim()==="")throw new Error("Invalid template code: Invalid name field");if(typeof o.broker_type!="string")throw new Error("Invalid template code: Invalid broker_type field");let s=["stock","options","futures","forex","crypto"];if((!o.asset_type||!s.includes(o.asset_type))&&(o.asset_type="stock"),typeof o.column_mappings!="object"||Array.isArray(o.column_mappings))throw new Error("Invalid template code: Invalid column_mappings field");if(Object.keys(o.column_mappings).length===0)throw new Error("Invalid template code: column_mappings cannot be empty");if(typeof o.has_headers!="boolean")throw new Error("Invalid template code: Invalid has_headers field");return{id:gc(),name:o.name,broker_type:o.broker_type,asset_type:o.asset_type,column_mappings:o.column_mappings,date_format:o.date_format,delimiter:o.delimiter,has_headers:o.has_headers,created_at:new Date().toISOString(),last_used:void 0,usage_count:0}}function JSe(e){try{return dY(e),{valid:!0}}catch(t){return{valid:!1,error:t instanceof Error?t.message:"Unknown error"}}}var GKe,Yz=F(()=>{xy();GKe=1e4});var QSe,Ss,XSe,Kz,YKe,ZSe=F(()=>{QSe=require("obsidian"),Ss=Y(Q()),XSe=Y(Ni());Yz();Kz=class extends QSe.Modal{constructor(t){super(t.app),this.props=t,this.titleEl.setText(`Export Template: ${t.template.name}`)}onOpen(){let{contentEl:t}=this;t.empty(),this.container=t.createDiv({cls:"csv-modal-container"}),this.root=(0,XSe.createRoot)(this.container),this.root.render(Ss.default.createElement(YKe,{...this.props,onClose:()=>this.close()}))}onClose(){this.root&&this.root.unmount(),this.props.onClose()}},YKe=({template:e,onClose:t})=>{let[r,n]=(0,Ss.useState)(!1),i=(0,Ss.useRef)(null),a=Gz(e);(0,Ss.useEffect)(()=>()=>{i.current&&clearTimeout(i.current)},[]);let o=async()=>{try{await navigator.clipboard.writeText(a),n(!0),i.current=setTimeout(()=>n(!1),2e3)}catch(s){console.error("Failed to copy share code:",s)}};return Ss.default.createElement(Ss.default.Fragment,null,Ss.default.createElement("p",{className:"csv-dialog-description"},"Share this code with others to let them use your template configuration."),Ss.default.createElement("div",{className:"csv-export-code-container"},Ss.default.createElement("label",{className:"csv-label"},"Share Code"),Ss.default.createElement("div",{className:"csv-export-code-preview"},a.substring(0,60),"..."),Ss.default.createElement("div",{className:"csv-helper-text"},"Full code copied to clipboard when you click the button below")),Ss.default.createElement("div",{className:"csv-dialog-actions"},Ss.default.createElement("button",{className:"csv-button csv-button-primary",onClick:o},r?"Copied!":"Copy to Clipboard"),Ss.default.createElement("button",{className:"csv-button csv-button-secondary",onClick:t},"Close")))}});var eTe,Us,tTe,Jz,KKe,rTe=F(()=>{eTe=require("obsidian"),Us=Y(Q()),tTe=Y(Ni());Yz();Jz=class extends eTe.Modal{constructor(t){super(t.app),this.props=t,this.titleEl.setText("Import Template")}onOpen(){let{contentEl:t}=this;t.empty(),this.container=t.createDiv({cls:"csv-modal-container"}),this.root=(0,tTe.createRoot)(this.container),this.root.render(Us.default.createElement(KKe,{...this.props,onClose:()=>this.close()}))}onClose(){this.root&&this.root.unmount(),this.props.onClose()}},KKe=({localTemplateService:e,onClose:t,onImportSuccess:r})=>{let[n,i]=(0,Us.useState)(""),[a,o]=(0,Us.useState)(),[s,l]=(0,Us.useState)(!1),c=async()=>{o(void 0);let u=JSe(n.trim());if(!u.valid){o(u.error);return}try{l(!0);let p=await e.importTemplate(n.trim());r==null||r(p.name),t()}catch(p){o(p instanceof Error?p.message:"Failed to import template")}finally{l(!1)}};return Us.default.createElement(Us.default.Fragment,null,Us.default.createElement("p",{className:"csv-dialog-description"},"Paste a template share code (JTT-v1-...) to import it into your vault."),Us.default.createElement("div",{className:"csv-dialog-form-container"},Us.default.createElement("label",{htmlFor:"share-code-input",className:"csv-dialog-label"},"Share Code"),Us.default.createElement("input",{id:"share-code-input",type:"text",value:n,onChange:u=>i(u.target.value),onKeyDown:u=>{u.key==="Enter"&&n.trim()&&c()},placeholder:"JTT-v1-...",autoFocus:!0,disabled:s,className:a?"csv-dialog-input csv-dialog-input-error":"csv-dialog-input"}),a&&Us.default.createElement("div",{className:"csv-dialog-error-message"},a),Us.default.createElement("div",{className:"csv-dialog-helper-text"},"Template will be added to your local templates")),Us.default.createElement("div",{className:"csv-dialog-actions"},Us.default.createElement("button",{className:"csv-button csv-button-primary",onClick:c,disabled:!n.trim()||s},s?"Importing...":"Import Template"),Us.default.createElement("button",{className:"csv-button csv-button-secondary",onClick:t,disabled:s},"Cancel")))}});var nTe,Nm,iTe,Qz,JKe,aTe=F(()=>{nTe=require("obsidian"),Nm=Y(Q()),iTe=Y(Ni()),Qz=class extends nTe.Modal{constructor(t){super(t.app),this.props=t,this.titleEl.setText("Delete Template?")}onOpen(){let{contentEl:t}=this;t.empty(),this.container=t.createDiv({cls:"csv-modal-container"}),this.root=(0,iTe.createRoot)(this.container),this.root.render(Nm.default.createElement(JKe,{...this.props,onClose:()=>this.close()}))}onClose(){this.root&&this.root.unmount(),this.props.onCancel()}},JKe=({template:e,onConfirm:t,onClose:r})=>{let[n,i]=(0,Nm.useState)(!1),a=async()=>{i(!0);try{await t(),r()}catch(o){i(!1)}};return Nm.default.createElement(Nm.default.Fragment,null,Nm.default.createElement("p",{className:"csv-dialog-description"},'Are you sure you want to delete "',e.name,'"? This action cannot be undone.'),Nm.default.createElement("div",{className:"csv-dialog-actions"},Nm.default.createElement("button",{className:"csv-button csv-button-primary",onClick:a,disabled:n,style:{backgroundColor:"var(--text-error)"}},n?"Deleting...":"Delete Template"),Nm.default.createElement("button",{className:"csv-button csv-button-secondary",onClick:r,disabled:n},"Cancel")))}});var oTe,Da,sTe,Xz,QKe,lTe=F(()=>{oTe=require("obsidian"),Da=Y(Q()),sTe=Y(Ni()),Xz=class extends oTe.Modal{constructor(t){super(t.app),this.props=t}onOpen(){let{contentEl:t}=this;t.empty(),this.container=t.createDiv({cls:"csv-modal-container"}),this.root=(0,sTe.createRoot)(this.container),this.root.render(Da.default.createElement(QKe,{...this.props,onClose:()=>this.close()}))}onClose(){this.root&&this.root.unmount(),this.props.onClose()}},QKe=({onClose:e,onProceed:t,missingFields:r})=>{let{tradesCount:n,missingStrike:i,missingExpiry:a,missingOptionType:o}=r,s=()=>{t(),e()};return Da.default.createElement(Da.default.Fragment,null,Da.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"12px"}},Da.default.createElement("span",{style:{fontSize:"24px",color:"var(--text-warning)"}},"\u26A0"),Da.default.createElement("h3",{style:{margin:0}},"Incomplete Options Data Detected")),Da.default.createElement("p",{style:{marginBottom:"16px"}},n===1?"An options trade is missing required metadata:":`${n} options trades are missing required metadata:`),Da.default.createElement("ul",{style:{marginBottom:"20px",paddingLeft:"24px",color:"var(--text-normal)",fontSize:"14px",lineHeight:"1.8"}},i>0&&Da.default.createElement("li",null,Da.default.createElement("strong",null,i)," ",i===1?"trade":"trades"," missing strike price"),a>0&&Da.default.createElement("li",null,Da.default.createElement("strong",null,a)," ",a===1?"trade":"trades"," missing expiration date"),o>0&&Da.default.createElement("li",null,Da.default.createElement("strong",null,o)," ",o===1?"trade":"trades"," missing option type (call/put)")),Da.default.createElement("div",{style:{padding:"12px 16px",background:"rgba(255, 152, 0, 0.1)",border:"1px solid rgba(255, 152, 0, 0.3)",borderRadius:"6px",marginBottom:"20px"}},Da.default.createElement("p",{style:{margin:0,fontSize:"13px",color:"var(--text-muted)",lineHeight:"1.6"}},"These trades will be imported without complete options data, which may affect:"),Da.default.createElement("ul",{style:{margin:"8px 0 0 0",paddingLeft:"20px",fontSize:"13px",color:"var(--text-muted)",lineHeight:"1.6"}},Da.default.createElement("li",null,"Analytics and filtering"),Da.default.createElement("li",null,"P&L calculations"),Da.default.createElement("li",null,"Trade journal accuracy"))),Da.default.createElement("div",{className:"csv-dialog-actions"},Da.default.createElement("button",{className:"csv-button csv-button-primary",onClick:s,style:{backgroundColor:"var(--text-warning)"}},"Import Anyway"),Da.default.createElement("button",{className:"csv-button csv-button-secondary",onClick:e},"Cancel Import")))}});var hD,Wi,cTe,Zz,XKe,dTe=F(()=>{hD=require("obsidian"),Wi=Y(Q()),cTe=Y(Ni());uO();ds();Zz=class extends hD.Modal{constructor(r){super(r.app);this.container=null;this.root=null;this.props=r}onOpen(){let{contentEl:r}=this;r.empty(),this.container=r.createDiv({cls:"csv-modal-container"}),this.root=(0,cTe.createRoot)(this.container),this.root.render(Wi.default.createElement(XKe,{...this.props,onClose:()=>this.close()}))}onClose(){this.root&&(this.root.unmount(),this.root=null),this.container=null}},XKe=({plugin:e,symbols:t,specService:r,onMappingsCreated:n,onSkip:i,onClose:a})=>{let[o,s]=(0,Wi.useState)(t.reduce((h,y)=>({...h,[y.symbol]:""}),{})),[l,c]=(0,Wi.useState)({}),[d,u]=(0,Wi.useState)(!1),p=()=>{var y;return(((y=e.settings.customOptions)==null?void 0:y.instrument)||[]).map(b=>b.name.toUpperCase())},m=(h,y,b)=>{if(!y.trim())return null;let k=y.trim().toUpperCase();return(b==="futures"?og:b==="forex"?sg:{})[k]||p().includes(k)?null:`Symbol "${k}" not found in ${b} specs or custom tickers`},g=(h,y,b)=>{s(x=>({...x,[h]:y}));let k=m(h,y,b);c(x=>{if(k)return{...x,[h]:k};{let S={...x};return delete S[h],S}})},f=async()=>{u(!0);try{let h=0,y={};for(let b of t){let k=o[b.symbol];if(k.trim()){let x=m(b.symbol,k,b.assetType);x&&(y[b.symbol]=x)}}if(Object.keys(y).length>0){c(y),new hD.Notice("Please fix validation errors before saving"),u(!1);return}for(let b of t){let k=o[b.symbol];k.trim()&&await r.saveMapping(b.symbol,k.trim(),!1)&&h++}n(h),a()}catch(h){console.error("Failed to save mappings:",h),new hD.Notice("Failed to save mappings")}finally{u(!1)}},v=()=>{i(),a()};return Wi.default.createElement(Wi.default.Fragment,null,Wi.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"12px"}},Wi.default.createElement("span",{style:{fontSize:"24px",color:"var(--text-warning)"}},"\u26A0"),Wi.default.createElement("h3",{style:{margin:0}},"Unmapped Symbols Detected")),Wi.default.createElement("p",{style:{marginBottom:"16px"}},t.length===1?"A symbol without instrument specifications was found in your import:":`${t.length} symbols without instrument specifications were found in your import:`),Wi.default.createElement("div",{style:{maxHeight:"300px",overflowY:"auto",marginBottom:"20px",border:"1px solid var(--background-modifier-border)",borderRadius:"6px",padding:"12px"}},t.map(h=>{let y=l[h.symbol];return Wi.default.createElement("div",{key:`${h.symbol}-${h.assetType}`,style:{marginBottom:"16px",paddingBottom:"16px",borderBottom:"1px solid var(--background-modifier-border-hover)"}},Wi.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"8px"}},Wi.default.createElement("div",{style:{flex:"0 0 auto",minWidth:"180px",maxWidth:"180px",overflow:"hidden"}},Wi.default.createElement("strong",{style:{display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:h.symbol},h.symbol)),Wi.default.createElement("span",{style:{flex:"0 0 auto"}},"\u2192"),Wi.default.createElement("div",{style:{flex:"0 0 auto"}},Wi.default.createElement("label",{htmlFor:`mapping-input-${h.symbol}`,style:{display:"block",fontSize:"11px",color:"var(--text-muted)",marginBottom:"4px"}},"Map to base symbol/ticker:"),Wi.default.createElement("input",{id:`mapping-input-${h.symbol}`,type:"text",value:o[h.symbol]||"",onChange:b=>g(h.symbol,b.target.value,h.assetType),placeholder:"e.g., ES, NQ, GC",style:{width:"140px",padding:"6px 10px",borderRadius:"4px",border:y?"1px solid var(--text-error)":"1px solid var(--background-modifier-border)",background:"var(--background-primary)",color:"var(--text-normal)",fontSize:"13px"},disabled:d}))),y&&Wi.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-error)",marginLeft:"152px"}},y))})),Wi.default.createElement("div",{style:{padding:"12px 16px",background:"rgba(255, 152, 0, 0.1)",border:"1px solid rgba(255, 152, 0, 0.3)",borderRadius:"6px",marginBottom:"20px"}},Wi.default.createElement("p",{style:{margin:0,fontSize:"13px",color:"var(--text-muted)",lineHeight:"1.6"}},"Map these symbols to built-in specs or your custom tickers. Without specifications, trades will not have accurate tick sizes, dollar per point, or P&L calculations.")),Wi.default.createElement("div",{className:"csv-dialog-actions"},Wi.default.createElement("button",{className:"csv-button csv-button-primary",onClick:f,disabled:d||Object.keys(l).length>0,style:{opacity:d||Object.keys(l).length>0?.5:1,cursor:d||Object.keys(l).length>0?"not-allowed":"pointer"}},d?"Saving...":"Save Mappings"),Wi.default.createElement("button",{className:"csv-button csv-button-secondary",onClick:v,disabled:d},"Skip")))}});var uTe=Fe((uY,pY)=>{((e,t)=>{typeof define=="function"&&define.amd?define([],t):typeof pY=="object"&&typeof uY!="undefined"?pY.exports=t():e.Papa=t()})(uY,function e(){var t=typeof self!="undefined"?self:typeof window!="undefined"?window:t!==void 0?t:{},r,n=!t.document&&!!t.postMessage,i=t.IS_PAPA_WORKER||!1,a={},o=0,s={};function l(S){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(w){var C=b(w);C.chunkSize=parseInt(C.chunkSize),w.step||w.chunk||(C.chunkSize=null),this._handle=new m(C),(this._handle.streamer=this)._config=C}.call(this,S),this.parseChunk=function(w,C){var D=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<D){let M=this._config.newline;M||(P=this._config.quoteChar||'"',M=this._handle.guessLineEndings(w,P)),w=[...w.split(M).slice(D)].join(M)}this.isFirstChunk&&x(this._config.beforeFirstChunk)&&(P=this._config.beforeFirstChunk(w))!==void 0&&(w=P),this.isFirstChunk=!1,this._halted=!1;var D=this._partialLine+w,P=(this._partialLine="",this._handle.parse(D,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(w=P.meta.cursor,D=(this._finished||(this._partialLine=D.substring(w-this._baseIndex),this._baseIndex=w),P&&P.data&&(this._rowCount+=P.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),i)t.postMessage({results:P,workerId:s.WORKER_ID,finished:D});else if(x(this._config.chunk)&&!C){if(this._config.chunk(P,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=P=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(P.data),this._completeResults.errors=this._completeResults.errors.concat(P.errors),this._completeResults.meta=P.meta),this._completed||!D||!x(this._config.complete)||P&&P.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),D||P&&P.meta.paused||this._nextChunk(),P}this._halted=!0},this._sendError=function(w){x(this._config.error)?this._config.error(w):i&&this._config.error&&t.postMessage({workerId:s.WORKER_ID,error:w,finished:!1})}}function c(S){var w;(S=S||{}).chunkSize||(S.chunkSize=s.RemoteChunkSize),l.call(this,S),this._nextChunk=n?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(C){this._input=C,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(w=new XMLHttpRequest,this._config.withCredentials&&(w.withCredentials=this._config.withCredentials),n||(w.onload=k(this._chunkLoaded,this),w.onerror=k(this._chunkError,this)),w.open(this._config.downloadRequestBody?"POST":"GET",this._input,!n),this._config.downloadRequestHeaders){var C,D=this._config.downloadRequestHeaders;for(C in D)w.setRequestHeader(C,D[C])}var P;this._config.chunkSize&&(P=this._start+this._config.chunkSize-1,w.setRequestHeader("Range","bytes="+this._start+"-"+P));try{w.send(this._config.downloadRequestBody)}catch(M){this._chunkError(M.message)}n&&w.status===0&&this._chunkError()}},this._chunkLoaded=function(){w.readyState===4&&(w.status<200||400<=w.status?this._chunkError():(this._start+=this._config.chunkSize||w.responseText.length,this._finished=!this._config.chunkSize||this._start>=(C=>(C=C.getResponseHeader("Content-Range"))!==null?parseInt(C.substring(C.lastIndexOf("/")+1)):-1)(w),this.parseChunk(w.responseText)))},this._chunkError=function(C){C=w.statusText||C,this._sendError(new Error(C))}}function d(S){(S=S||{}).chunkSize||(S.chunkSize=s.LocalChunkSize),l.call(this,S);var w,C,D=typeof FileReader!="undefined";this.stream=function(P){this._input=P,C=P.slice||P.webkitSlice||P.mozSlice,D?((w=new FileReader).onload=k(this._chunkLoaded,this),w.onerror=k(this._chunkError,this)):w=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var P=this._input,M=(this._config.chunkSize&&(M=Math.min(this._start+this._config.chunkSize,this._input.size),P=C.call(P,this._start,M)),w.readAsText(P,this._config.encoding));D||this._chunkLoaded({target:{result:M}})},this._chunkLoaded=function(P){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(P.target.result)},this._chunkError=function(){this._sendError(w.error)}}function u(S){var w;l.call(this,S=S||{}),this.stream=function(C){return w=C,this._nextChunk()},this._nextChunk=function(){var C,D;if(!this._finished)return C=this._config.chunkSize,w=C?(D=w.substring(0,C),w.substring(C)):(D=w,""),this._finished=!w,this.parseChunk(D)}}function p(S){l.call(this,S=S||{});var w=[],C=!0,D=!1;this.pause=function(){l.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){l.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(P){this._input=P,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){D&&w.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),w.length?this.parseChunk(w.shift()):C=!0},this._streamData=k(function(P){try{w.push(typeof P=="string"?P:P.toString(this._config.encoding)),C&&(C=!1,this._checkIsFinished(),this.parseChunk(w.shift()))}catch(M){this._streamError(M)}},this),this._streamError=k(function(P){this._streamCleanUp(),this._sendError(P)},this),this._streamEnd=k(function(){this._streamCleanUp(),D=!0,this._streamData("")},this),this._streamCleanUp=k(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function m(S){var w,C,D,P,M=Math.pow(2,53),z=-M,A=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,I=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,L=this,E=0,T=0,$=!1,_=!1,B=[],W={data:[],errors:[],meta:{}};function N(O){return S.skipEmptyLines==="greedy"?O.join("").trim()==="":O.length===1&&O[0].length===0}function U(){if(W&&D&&(R("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+s.DefaultDelimiter+"'"),D=!1),S.skipEmptyLines&&(W.data=W.data.filter(function(J){return!N(J)})),j()){let J=function(K,G){x(S.transformHeader)&&(K=S.transformHeader(K,G)),B.push(K)};var V=J;if(W)if(Array.isArray(W.data[0])){for(var O=0;j()&&O<W.data.length;O++)W.data[O].forEach(J);W.data.splice(0,1)}else W.data.forEach(J)}function H(J,K){for(var G=S.header?{}:[],X=0;X<J.length;X++){var te=X,re=J[X],re=((Z,ne)=>(se=>(S.dynamicTypingFunction&&S.dynamicTyping[se]===void 0&&(S.dynamicTyping[se]=S.dynamicTypingFunction(se)),(S.dynamicTyping[se]||S.dynamicTyping)===!0))(Z)?ne==="true"||ne==="TRUE"||ne!=="false"&&ne!=="FALSE"&&((se=>{if(A.test(se)&&(se=parseFloat(se),z<se&&se<M))return 1})(ne)?parseFloat(ne):I.test(ne)?new Date(ne):ne===""?null:ne):ne)(te=S.header?X>=B.length?"__parsed_extra":B[X]:te,re=S.transform?S.transform(re,te):re);te==="__parsed_extra"?(G[te]=G[te]||[],G[te].push(re)):G[te]=re}return S.header&&(X>B.length?R("FieldMismatch","TooManyFields","Too many fields: expected "+B.length+" fields but parsed "+X,T+K):X<B.length&&R("FieldMismatch","TooFewFields","Too few fields: expected "+B.length+" fields but parsed "+X,T+K)),G}var q;W&&(S.header||S.dynamicTyping||S.transform)&&(q=1,!W.data.length||Array.isArray(W.data[0])?(W.data=W.data.map(H),q=W.data.length):W.data=H(W.data,0),S.header&&W.meta&&(W.meta.fields=B),T+=q)}function j(){return S.header&&B.length===0}function R(O,H,q,V){O={type:O,code:H,message:q},V!==void 0&&(O.row=V),W.errors.push(O)}x(S.step)&&(P=S.step,S.step=function(O){W=O,j()?U():(U(),W.data.length!==0&&(E+=O.data.length,S.preview&&E>S.preview?C.abort():(W.data=W.data[0],P(W,L))))}),this.parse=function(O,H,q){var V=S.quoteChar||'"',V=(S.newline||(S.newline=this.guessLineEndings(O,V)),D=!1,S.delimiter?x(S.delimiter)&&(S.delimiter=S.delimiter(O),W.meta.delimiter=S.delimiter):((V=((J,K,G,X,te)=>{var re,Z,ne,se;te=te||[",","	","|",";",s.RECORD_SEP,s.UNIT_SEP];for(var ee=0;ee<te.length;ee++){for(var ie,ve=te[ee],Se=0,Me=0,le=0,Ye=(ne=void 0,new f({comments:X,delimiter:ve,newline:K,preview:10}).parse(J)),ue=0;ue<Ye.data.length;ue++)G&&N(Ye.data[ue])?le++:(ie=Ye.data[ue].length,Me+=ie,ne===void 0?ne=ie:0<ie&&(Se+=Math.abs(ie-ne),ne=ie));0<Ye.data.length&&(Me/=Ye.data.length-le),(Z===void 0||Se<=Z)&&(se===void 0||se<Me)&&1.99<Me&&(Z=Se,re=ve,se=Me)}return{successful:!!(S.delimiter=re),bestDelimiter:re}})(O,S.newline,S.skipEmptyLines,S.comments,S.delimitersToGuess)).successful?S.delimiter=V.bestDelimiter:(D=!0,S.delimiter=s.DefaultDelimiter),W.meta.delimiter=S.delimiter),b(S));return S.preview&&S.header&&V.preview++,w=O,C=new f(V),W=C.parse(w,H,q),U(),$?{meta:{paused:!0}}:W||{meta:{paused:!1}}},this.paused=function(){return $},this.pause=function(){$=!0,C.abort(),w=x(S.chunk)?"":w.substring(C.getCharIndex())},this.resume=function(){L.streamer._halted?($=!1,L.streamer.parseChunk(w,!0)):setTimeout(L.resume,3)},this.aborted=function(){return _},this.abort=function(){_=!0,C.abort(),W.meta.aborted=!0,x(S.complete)&&S.complete(W),w=""},this.guessLineEndings=function(J,V){J=J.substring(0,1048576);var V=new RegExp(g(V)+"([^]*?)"+g(V),"gm"),q=(J=J.replace(V,"")).split("\r"),V=J.split(`
`),J=1<V.length&&V[0].length<q[0].length;if(q.length===1||J)return`
`;for(var K=0,G=0;G<q.length;G++)q[G][0]===`
`&&K++;return K>=q.length/2?`\r
`:"\r"}}function g(S){return S.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function f(S){var w=(S=S||{}).delimiter,C=S.newline,D=S.comments,P=S.step,M=S.preview,z=S.fastMode,A=null,I=!1,L=S.quoteChar==null?'"':S.quoteChar,E=L;if(S.escapeChar!==void 0&&(E=S.escapeChar),(typeof w!="string"||-1<s.BAD_DELIMITERS.indexOf(w))&&(w=","),D===w)throw new Error("Comment character same as delimiter");D===!0?D="#":(typeof D!="string"||-1<s.BAD_DELIMITERS.indexOf(D))&&(D=!1),C!==`
`&&C!=="\r"&&C!==`\r
`&&(C=`
`);var T=0,$=!1;this.parse=function(_,B,W){if(typeof _!="string")throw new Error("Input must be a string");var N=_.length,U=w.length,j=C.length,R=D.length,O=x(P),H=[],q=[],V=[],J=T=0;if(!_)return Se();if(z||z!==!1&&_.indexOf(L)===-1){for(var K=_.split(C),G=0;G<K.length;G++){if(V=K[G],T+=V.length,G!==K.length-1)T+=C.length;else if(W)return Se();if(!D||V.substring(0,R)!==D){if(O){if(H=[],se(V.split(w)),Me(),$)return Se()}else se(V.split(w));if(M&&M<=G)return H=H.slice(0,M),Se(!0)}}return Se()}for(var X=_.indexOf(w,T),te=_.indexOf(C,T),re=new RegExp(g(E)+g(L),"g"),Z=_.indexOf(L,T);;)if(_[T]===L)for(Z=T,T++;;){if((Z=_.indexOf(L,Z+1))===-1)return W||q.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:H.length,index:T}),ie();if(Z===N-1)return ie(_.substring(T,Z).replace(re,L));if(L===E&&_[Z+1]===E)Z++;else if(L===E||Z===0||_[Z-1]!==E){X!==-1&&X<Z+1&&(X=_.indexOf(w,Z+1));var ne=ee((te=te!==-1&&te<Z+1?_.indexOf(C,Z+1):te)===-1?X:Math.min(X,te));if(_.substr(Z+1+ne,U)===w){V.push(_.substring(T,Z).replace(re,L)),_[T=Z+1+ne+U]!==L&&(Z=_.indexOf(L,T)),X=_.indexOf(w,T),te=_.indexOf(C,T);break}if(ne=ee(te),_.substring(Z+1+ne,Z+1+ne+j)===C){if(V.push(_.substring(T,Z).replace(re,L)),ve(Z+1+ne+j),X=_.indexOf(w,T),Z=_.indexOf(L,T),O&&(Me(),$))return Se();if(M&&H.length>=M)return Se(!0);break}q.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:H.length,index:T}),Z++}}else if(D&&V.length===0&&_.substring(T,T+R)===D){if(te===-1)return Se();T=te+j,te=_.indexOf(C,T),X=_.indexOf(w,T)}else if(X!==-1&&(X<te||te===-1))V.push(_.substring(T,X)),T=X+U,X=_.indexOf(w,T);else{if(te===-1)break;if(V.push(_.substring(T,te)),ve(te+j),O&&(Me(),$))return Se();if(M&&H.length>=M)return Se(!0)}return ie();function se(le){H.push(le),J=T}function ee(le){var Ye=0;return Ye=le!==-1&&(le=_.substring(Z+1,le))&&le.trim()===""?le.length:Ye}function ie(le){return W||(le===void 0&&(le=_.substring(T)),V.push(le),T=N,se(V),O&&Me()),Se()}function ve(le){T=le,se(V),V=[],te=_.indexOf(C,T)}function Se(le){if(S.header&&!B&&H.length&&!I){var Ye=H[0],ue=Object.create(null),We=new Set(Ye);let Ke=!1;for(let Ze=0;Ze<Ye.length;Ze++){let St=Ye[Ze];if(ue[St=x(S.transformHeader)?S.transformHeader(St,Ze):St]){let Zr,Ee=ue[St];for(;Zr=St+"_"+Ee,Ee++,We.has(Zr););We.add(Zr),Ye[Ze]=Zr,ue[St]++,Ke=!0,(A=A===null?{}:A)[Zr]=St}else ue[St]=1,Ye[Ze]=St;We.add(St)}Ke&&console.warn("Duplicate headers found and renamed."),I=!0}return{data:H,errors:q,meta:{delimiter:w,linebreak:C,aborted:$,truncated:!!le,cursor:J+(B||0),renamedHeaders:A}}}function Me(){P(Se()),H=[],q=[]}},this.abort=function(){$=!0},this.getCharIndex=function(){return T}}function v(S){var w=S.data,C=a[w.workerId],D=!1;if(w.error)C.userError(w.error,w.file);else if(w.results&&w.results.data){var P={abort:function(){D=!0,h(w.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:y,resume:y};if(x(C.userStep)){for(var M=0;M<w.results.data.length&&(C.userStep({data:w.results.data[M],errors:w.results.errors,meta:w.results.meta},P),!D);M++);delete w.results}else x(C.userChunk)&&(C.userChunk(w.results,P,w.file),delete w.results)}w.finished&&!D&&h(w.workerId,w.results)}function h(S,w){var C=a[S];x(C.userComplete)&&C.userComplete(w),C.terminate(),delete a[S]}function y(){throw new Error("Not implemented.")}function b(S){if(typeof S!="object"||S===null)return S;var w,C=Array.isArray(S)?[]:{};for(w in S)C[w]=b(S[w]);return C}function k(S,w){return function(){S.apply(w,arguments)}}function x(S){return typeof S=="function"}return s.parse=function(S,w){var C=(w=w||{}).dynamicTyping||!1;if(x(C)&&(w.dynamicTypingFunction=C,C={}),w.dynamicTyping=C,w.transform=!!x(w.transform)&&w.transform,!w.worker||!s.WORKERS_SUPPORTED)return C=null,s.NODE_STREAM_INPUT,typeof S=="string"?(S=(D=>D.charCodeAt(0)!==65279?D:D.slice(1))(S),C=new(w.download?c:u)(w)):S.readable===!0&&x(S.read)&&x(S.on)?C=new p(w):(t.File&&S instanceof File||S instanceof Object)&&(C=new d(w)),C.stream(S);(C=(()=>{var D;return!!s.WORKERS_SUPPORTED&&(D=(()=>{var P=t.URL||t.webkitURL||null,M=e.toString();return s.BLOB_URL||(s.BLOB_URL=P.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",M,")();"],{type:"text/javascript"})))})(),(D=new t.Worker(D)).onmessage=v,D.id=o++,a[D.id]=D)})()).userStep=w.step,C.userChunk=w.chunk,C.userComplete=w.complete,C.userError=w.error,w.step=x(w.step),w.chunk=x(w.chunk),w.complete=x(w.complete),w.error=x(w.error),delete w.worker,C.postMessage({input:S,config:w,workerId:C.id})},s.unparse=function(S,w){var C=!1,D=!0,P=",",M=`\r
`,z='"',A=z+z,I=!1,L=null,E=!1,T=((()=>{if(typeof w=="object"){if(typeof w.delimiter!="string"||s.BAD_DELIMITERS.filter(function(B){return w.delimiter.indexOf(B)!==-1}).length||(P=w.delimiter),typeof w.quotes!="boolean"&&typeof w.quotes!="function"&&!Array.isArray(w.quotes)||(C=w.quotes),typeof w.skipEmptyLines!="boolean"&&typeof w.skipEmptyLines!="string"||(I=w.skipEmptyLines),typeof w.newline=="string"&&(M=w.newline),typeof w.quoteChar=="string"&&(z=w.quoteChar),typeof w.header=="boolean"&&(D=w.header),Array.isArray(w.columns)){if(w.columns.length===0)throw new Error("Option columns is empty");L=w.columns}w.escapeChar!==void 0&&(A=w.escapeChar+z),w.escapeFormulae instanceof RegExp?E=w.escapeFormulae:typeof w.escapeFormulae=="boolean"&&w.escapeFormulae&&(E=/^[=+\-@\t\r].*$/)}})(),new RegExp(g(z),"g"));if(typeof S=="string"&&(S=JSON.parse(S)),Array.isArray(S)){if(!S.length||Array.isArray(S[0]))return $(null,S,I);if(typeof S[0]=="object")return $(L||Object.keys(S[0]),S,I)}else if(typeof S=="object")return typeof S.data=="string"&&(S.data=JSON.parse(S.data)),Array.isArray(S.data)&&(S.fields||(S.fields=S.meta&&S.meta.fields||L),S.fields||(S.fields=Array.isArray(S.data[0])?S.fields:typeof S.data[0]=="object"?Object.keys(S.data[0]):[]),Array.isArray(S.data[0])||typeof S.data[0]=="object"||(S.data=[S.data])),$(S.fields||[],S.data||[],I);throw new Error("Unable to serialize unrecognized input");function $(B,W,N){var U="",j=(typeof B=="string"&&(B=JSON.parse(B)),typeof W=="string"&&(W=JSON.parse(W)),Array.isArray(B)&&0<B.length),R=!Array.isArray(W[0]);if(j&&D){for(var O=0;O<B.length;O++)0<O&&(U+=P),U+=_(B[O],O);0<W.length&&(U+=M)}for(var H=0;H<W.length;H++){var q=(j?B:W[H]).length,V=!1,J=j?Object.keys(W[H]).length===0:W[H].length===0;if(N&&!j&&(V=N==="greedy"?W[H].join("").trim()==="":W[H].length===1&&W[H][0].length===0),N==="greedy"&&j){for(var K=[],G=0;G<q;G++){var X=R?B[G]:G;K.push(W[H][X])}V=K.join("").trim()===""}if(!V){for(var te=0;te<q;te++){0<te&&!J&&(U+=P);var re=j&&R?B[te]:te;U+=_(W[H][re],te)}H<W.length-1&&(!N||0<q&&!J)&&(U+=M)}}return U}function _(B,W){var N,U;return B==null?"":B.constructor===Date?JSON.stringify(B).slice(1,25):(U=!1,E&&typeof B=="string"&&E.test(B)&&(B="'"+B,U=!0),N=B.toString().replace(T,A),(U=U||C===!0||typeof C=="function"&&C(B,W)||Array.isArray(C)&&C[W]||((j,R)=>{for(var O=0;O<R.length;O++)if(-1<j.indexOf(R[O]))return!0;return!1})(N,s.BAD_DELIMITERS)||-1<N.indexOf(P)||N.charAt(0)===" "||N.charAt(N.length-1)===" ")?z+N+z:N)}},s.RECORD_SEP="",s.UNIT_SEP="",s.BYTE_ORDER_MARK="\uFEFF",s.BAD_DELIMITERS=["\r",`
`,'"',s.BYTE_ORDER_MARK],s.WORKERS_SUPPORTED=!n&&!!t.Worker,s.NODE_STREAM_INPUT=1,s.LocalChunkSize=10485760,s.RemoteChunkSize=5242880,s.DefaultDelimiter=",",s.Parser=f,s.ParserHandle=m,s.NetworkStreamer=c,s.FileStreamer=d,s.StringStreamer=u,s.ReadableStreamStreamer=p,t.jQuery&&((r=t.jQuery).fn.parse=function(S){var w=S.config||{},C=[];return this.each(function(M){if(!(r(this).prop("tagName").toUpperCase()==="INPUT"&&r(this).attr("type").toLowerCase()==="file"&&t.FileReader)||!this.files||this.files.length===0)return!0;for(var z=0;z<this.files.length;z++)C.push({file:this.files[z],inputElem:this,instanceConfig:r.extend({},w)})}),D(),this;function D(){if(C.length===0)x(S.complete)&&S.complete();else{var M,z,A,I,L=C[0];if(x(S.before)){var E=S.before(L.file,L.inputElem);if(typeof E=="object"){if(E.action==="abort")return M="AbortError",z=L.file,A=L.inputElem,I=E.reason,void(x(S.error)&&S.error({name:M},z,A,I));if(E.action==="skip")return void P();typeof E.config=="object"&&(L.instanceConfig=r.extend(L.instanceConfig,E.config))}else if(E==="skip")return void P()}var T=L.instanceConfig.complete;L.instanceConfig.complete=function($){x(T)&&T($,L.file,L.inputElem),P()},s.parse(L.file,L.instanceConfig)}}function P(){C.splice(0,1),D()}}),i&&(t.onmessage=function(S){S=S.data,s.WORKER_ID===void 0&&S&&(s.WORKER_ID=S.workerId),typeof S.input=="string"?t.postMessage({workerId:s.WORKER_ID,results:s.parse(S.input,S.config),finished:!0}):(t.File&&S.input instanceof File||S.input instanceof Object)&&(S=s.parse(S.input,S.config))&&t.postMessage({workerId:s.WORKER_ID,results:S,finished:!0})}),(c.prototype=Object.create(l.prototype)).constructor=c,(d.prototype=Object.create(l.prototype)).constructor=d,(u.prototype=Object.create(u.prototype)).constructor=u,(p.prototype=Object.create(l.prototype)).constructor=p,s})});var mY,ej,pTe=F(()=>{mY=Y(uTe()),ej=class{async parseFile(t){return new Promise((r,n)=>{mY.parse(t,{complete:i=>{try{let a=this.processResults(i);r(a)}catch(a){n(a)}},error:i=>{n(new Error(`CSV parsing failed: ${i.message}`))},skipEmptyLines:!0,encoding:"UTF-8"})})}parseText(t,r){let n=mY.parse(t,{delimiter:r,skipEmptyLines:!0});return this.processResults(n)}processResults(t){if(!t.data||t.data.length===0)throw new Error("CSV file is empty");let r=t.data,n=t.meta.delimiter||",";r.length>1&&this.isMetadataLine(r[0])&&(r=r.slice(1));let i=r[0].map(o=>this.cleanHeader(o)),a=r.slice(1);if(a.length===0)throw new Error("CSV file contains only headers, no data rows");return{headers:i,rows:a,rowCount:a.length,delimiter:n}}isMetadataLine(t){var n;if(t.length===0)return!1;if(t.filter(i=>i&&i.trim()!=="").length<=2&&t.length>=5){let i=((n=t[0])==null?void 0:n.trim())||"";if(i.includes("UID:")||i.startsWith("UID"))return!0}return!1}cleanHeader(t){let r=t.replace(/^\uFEFF/,"");return r=r.trim(),r}detectDelimiter(t){let r=t.split(`
`)[0],n=[",",";","	","|"],i=0,a=",";for(let o of n){let s=r.split(o).length;s>i&&(i=s,a=o)}return a}validate(t){let r=[];t.headers.length===0&&r.push("No headers found in CSV file"),t.rows.length===0&&r.push("No data rows found in CSV file");let n=t.headers.length,i=t.rows.filter(a=>a.length!==n);return i.length>0&&r.push(`${i.length} rows have inconsistent column counts`),{valid:r.length===0,errors:r}}}});function En(e){if(!e||e.trim()==="")return null;let t=e.replace(/[,$]/g,""),r=parseFloat(t);return isNaN(r)?null:r}function Lc(e){let t=e.toUpperCase().trim();return t==="BUY"||t==="B"||t==="LONG"||t==="BOT"||t==="BOUGHT"||t==="COVER"||t==="BUY TO COVER"?"long":t==="SELL"||t==="S"||t==="SHORT"||t==="SLD"||t==="SOLD"||t==="SELL SHORT"?"short":null}function Ue(e,...t){let r={};for(let[n,i]of Object.entries(e))r[n.toLowerCase()]=i;for(let n of t){let i=r[n.toLowerCase()];if(i!==void 0)return i}}function ZKe(e,t){if(!/^[yMdHms\s\-\/.:\d]+$/.test(t))throw new Error("Invalid date format: contains disallowed characters");let n=["yyyy","MM","M","dd","d","HH","mm","ss","SSS"],i=t;for(let b of n)i=i.replace(new RegExp(b,"g"),"");if(!/^[\s\-\/.:\d]*$/.test(i))throw new Error("Invalid date format: contains unknown tokens");let o=t.replace(/yyyy/g,"___YYYY___").replace(/MM/g,"___MM___").replace(/dd/g,"___DD___").replace(/HH/g,"___HH___").replace(/mm/g,"___mm___").replace(/ss/g,"___SS___").replace(/SSS/g,"___SSS___").replace(/M/g,"___M___").replace(/d/g,"___D___").replace(/___YYYY___/g,"(\\d{4})").replace(/___MM___/g,"(\\d{2})").replace(/___M___/g,"(\\d{1,2})").replace(/___DD___/g,"(\\d{2})").replace(/___D___/g,"(\\d{1,2})").replace(/___HH___/g,"(\\d{2})").replace(/___mm___/g,"(\\d{2})").replace(/___SS___/g,"(\\d{2})").replace(/___SSS___/g,"(\\d{3})");o=o.replace(/[/.:\s\-]/g,"\\$&");let s=new RegExp(`^${o}$`),l=e.match(s);if(!l)return null;let c=t.match(/(yyyy|MM?|dd?|HH|mm|ss|SSS)/g)||[],d={};for(let b=0;b<c.length;b++){let k=c[b],x=parseInt(l[b+1],10);d[k]=x}let u=d.yyyy||0,p=(d.MM||d.M||1)-1,m=d.dd||d.d||1,g=d.HH||0,f=d.mm||0,v=d.ss||0,h=d.SSS||0,y=new Date(u,p,m,g,f,v,h);return isNaN(y.getTime())?null:y}function Fm(e,t){if(!e||e.trim()==="")return null;for(let n of t)try{let i=ZKe(e.trim(),n);if(i)return i}catch(i){}let r=new Date(e);return isNaN(r.getTime())?null:r}function Nc(e,t){return e==="long"&&t==="short"||e==="short"&&t==="long"}function mTe(e){if(typeof e!="string")return;let t=e.toLowerCase().trim();return["call","put"].includes(t)?t:void 0}function fTe(e){if(typeof e!="string")return;let t=e.toUpperCase().trim();return["OPEN","CLOSED"].includes(t)?t:void 0}var gg=F(()=>{});function gTe(e){let t=e.trim(),r=/^([A-Z]{1,6})\s*(\d{6})([CP])(\d{8})$/,n=t.match(r);if(!n)return null;let[i,a,o,s,l]=n,c=2e3+parseInt(o.substring(0,2),10),d=parseInt(o.substring(2,4),10)-1,u=parseInt(o.substring(4,6),10),p=new Date(Date.UTC(c,d,u)),m=s==="C"?"call":"put",g=parseInt(l,10)/1e3;return{underlying:a.trim(),expirationDate:p,optionType:m,strikePrice:g,success:!0,fullSymbol:t}}function hTe(e){let t=e.trim();return eJe.test(t)}var eJe,vTe=F(()=>{yf();eJe=/^[A-Z]{1,6}\s*\d{6}[CP]\d{8}$/});var kTe={};Ti(kTe,{IBKRAdapter:()=>aJe,parseIBKRRow:()=>wTe});function tJe(e){return!1}function yTe(e){if(!e||e.trim()==="")return null;let t=e.trim();if(/^\d{8};\d{6}$/.test(t)){let[a,o]=t.split(";"),s=parseInt(a.substring(0,4),10),l=parseInt(a.substring(4,6),10)-1,c=parseInt(a.substring(6,8),10),d=parseInt(o.substring(0,2),10),u=parseInt(o.substring(2,4),10),p=parseInt(o.substring(4,6),10),m=String(l+1).padStart(2,"0"),g=String(c).padStart(2,"0"),f=String(d).padStart(2,"0"),v=String(u).padStart(2,"0"),h=String(p).padStart(2,"0"),y=new Date(Date.UTC(s,l,c,d,u,p)),k=new Intl.DateTimeFormat("en-US",{timeZone:"America/New_York",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).formatToParts(y),x=L=>{var E;return parseInt(((E=k.find(T=>T.type===L))==null?void 0:E.value)||"0",10)},S=x("year"),w=x("month")-1,C=x("day"),D=x("hour"),P=x("minute"),M=x("second"),z=y.getTime()-new Date(S,w,C,D,P,M).getTime(),A=Math.round(z/6e4),I=new Date(Date.UTC(s,l,c,d-Math.floor(A/60),u-A%60,p));if(!isNaN(I.getTime()))return I}let n=Fm(t,["yyyy-MM-dd, HH:mm:ss","yyyy-MM-dd HH:mm:ss","MM/dd/yyyy, HH:mm:ss","MM/dd/yyyy HH:mm:ss","yyyy-MM-dd","MM/dd/yyyy"]);if(n)return n;let i=t.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(i){let[,a,o,s]=i,l=new Date(Date.UTC(parseInt(a,10),parseInt(o,10)-1,parseInt(s,10)));return isNaN(l.getTime())?null:l}return null}function bTe(e){let t=e.split(/\s+/);return t.length>0&&t[0].trim()?t[0].trim():e.trim()}function rJe(e){let r=e.trim().match(/^([A-Z]+)\s+(\d{6})([CP])(\d{8})$/);if(!r)return null;let[n,i,a,o,s]=r,l=2e3+parseInt(a.substring(0,2),10),c=parseInt(a.substring(2,4),10)-1,d=parseInt(a.substring(4,6),10),u=new Date(Date.UTC(l,c,d)),p=o==="C"?"call":"put",m=parseInt(s,10)/1e3;return{underlying:i,expirationDate:u,optionType:p,strikePrice:m}}function xTe(e){let t=e.toUpperCase().trim();return t==="B"||t==="BUY"||t==="BOT"?"long":t==="S"||t==="SELL"||t==="SLD"?"short":Lc(e)}function nx(e){if(!e||e.trim()===""||e==="-"||e==="N/A")return null;let t=e.trim();t=t.replace(/[$,]/g,""),t.startsWith("(")&&t.endsWith(")")&&(t="-"+t.substring(1,t.length-1));let r=parseFloat(t);return isNaN(r)?null:r}function wTe(e){try{let t=Ue(e,Xk.symbol,"Symbol","Underlying");if(!t||t.trim()==="")return null;let r=bTe(t),n=Ue(e,Xk.direction,"Buy/Sell","Side");if(!n)return null;let i=xTe(n);if(!i)return null;let a=Ue(e,"OrderID","Order ID","Execution ID","ExecID"),o=Ue(e,Xk.dateTime,"Date/Time","DateTime","Time");if(!o)return null;let s=yTe(o);if(!s)return null;let l=Ue(e,Xk.price,"Price","T. Price"),c=nx(l);if(c===null||c<=0)return null;let d=Ue(e,Xk.volume,"Quantity","Qty"),u=nx(d);if(u===null||u===0)return null;let p=Math.abs(u),m=Ue(e,Xk.commission,"Commission","Comm/Fee"),g=nx(m)||0,f="stock";return r.includes("/")||r.length===6?f="forex":(t.includes("C0")||t.includes("P0"))&&(f="options"),{symbol:r,direction:i,entryTime:s,entryPrice:c,quantity:p,commission:g,assetType:f}}catch(t){return console.error("Error parsing IBKR row:",t),null}}function nJe(e){let t=e.reduce((n,i)=>n+i.price*i.quantity,0),r=e.reduce((n,i)=>n+i.quantity,0);return r===0?0:t/r}function iJe(e){let t=[];for(let p of e)try{let m=Ue(p,"Symbol","Underlying")||"";if(!m||m.trim()==="")continue;let g=bTe(m),f=Ue(p,"Buy/Sell","Side");if(!f)continue;let v=xTe(f);if(!v)continue;let h=Ue(p,"OrderID","Order ID","Execution ID","ExecID"),y=Ue(p,"Date/Time","DateTime","Time");if(!y)continue;let b=yTe(y);if(!b)continue;let k=Ue(p,"Price","T. Price"),x=nx(k);if(x===null||x<=0)continue;let S=Ue(p,"Quantity","Qty"),w=nx(S);if(w===null||w===0)continue;let C=Math.abs(w),D=Ue(p,"Commission","Comm/Fee"),P=nx(D)||0,M=Ue(p,"Code","Codes"),z=Ue(p,"CurrencyPrimary","Currency"),A=Ue(p,"Multiplier"),I="stock";g.includes("/")||g.length===6?I="forex":(m.includes("C0")||m.includes("P0"))&&(I="options");let L,E,T,$;if(I==="options"){let B=rJe(m);B&&(L=B.strikePrice,E=B.expirationDate,T=B.optionType,$=nx(A)||100)}let _={fullSymbol:m.trim(),underlyingSymbol:g,direction:v,executionTime:b,price:x,quantity:C,commission:P,assetType:I,orderID:h,code:M,currency:z,strikePrice:L,expirationDate:E,optionType:T,contractSize:$};t.push(_)}catch(m){console.error("[IBKR] Error parsing row:",m);continue}let r=new Map;for(let p of t){let m=p.orderID?`${p.orderID}-${p.fullSymbol}-${p.direction}`:`${p.fullSymbol}-${p.direction}-${p.executionTime.getTime()}`;r.has(m)||r.set(m,[]),r.get(m).push(p)}let n=[];for(let[p,m]of r)if(m.length===1)n.push(m[0]);else{let g=m[0],f=m.map(h=>h.code).filter(h=>!!h).join(";")||void 0,v={fullSymbol:g.fullSymbol,underlyingSymbol:g.underlyingSymbol,direction:g.direction,executionTime:g.executionTime,price:nJe(m),quantity:m.reduce((h,y)=>h+y.quantity,0),commission:m.reduce((h,y)=>h+y.commission,0),assetType:g.assetType,orderID:g.orderID,code:f,currency:g.currency,strikePrice:g.strikePrice,expirationDate:g.expirationDate,optionType:g.optionType,contractSize:g.contractSize};n.push(v)}n.sort((p,m)=>p.executionTime.getTime()-m.executionTime.getTime());let i=new Set,a=new Set,o=new Set;for(let p of n)p.direction==="long"?i.add(p.fullSymbol):p.direction==="short"&&(a.add(p.fullSymbol),p.code&&p.code.split(";").map(m=>m.trim()).includes("C")&&o.add(p.fullSymbol));let s=new Map,l=[];for(let p of n){let m=s.get(p.fullSymbol);if(m&&Nc(m.direction,p.direction)){let g=Math.min(m.quantity,p.quantity),f=p.commission*(g/p.quantity),h=m.commission*(g/m.quantity)+f,y=m.contractSize||(m.assetType==="options"?100:1),b;m.direction==="long"?b=(p.price-m.entryPrice)*g*y:b=(m.entryPrice-p.price)*g*y,m.exits||(m.exits=[]),m.exits.push({time:p.executionTime,price:p.price,quantity:g,commission:f}),m.originalQuantity||(m.originalQuantity=m.quantity),m.quantity-=g;let k=m.exits.reduce((S,w)=>S+w.quantity,0);if(Math.abs(k-m.originalQuantity)<1e-4||k>=m.originalQuantity){m.quantity=m.originalQuantity,delete m.originalQuantity;let w=m.exits.reduce((z,A)=>z+A.price*A.quantity,0)/k,C=m.exits[m.exits.length-1];m.exitTime=C.time,m.exitPrice=w,m.status="CLOSED";let D=m.exits.reduce((z,A)=>z+A.commission,0),P=m.contractSize||(m.assetType==="options"?100:1),M;m.direction==="long"?M=(w-m.entryPrice)*k*P:M=(m.entryPrice-w)*k*P,M-=m.commission+D,m.profitLoss=M,m.commission=m.commission+D,l.push(m),s.delete(p.fullSymbol)}if(p.quantity>g){let S=p.commission-f,w={symbol:p.underlyingSymbol,direction:p.direction,entryTime:p.executionTime,entryPrice:p.price,quantity:p.quantity-g,commission:S,assetType:p.assetType,status:"OPEN",currency:p.currency,strikePrice:p.strikePrice,expirationDate:p.expirationDate,optionType:p.optionType,contractSize:p.contractSize};s.set(p.fullSymbol,w)}}else if(m&&m.direction===p.direction){m.entries||(m.entries=[{time:m.entryTime,price:m.entryPrice,quantity:m.quantity,commission:m.commission}]),m.entries.push({time:p.executionTime,price:p.price,quantity:p.quantity,commission:p.commission});let g=m.quantity+p.quantity,f=(m.quantity*m.entryPrice+p.quantity*p.price)/g;m.quantity=g,m.entryPrice=f,m.commission+=p.commission,p.executionTime<m.entryTime&&(m.entryTime=p.executionTime),p.strikePrice&&!m.strikePrice&&(m.strikePrice=p.strikePrice),p.expirationDate&&!m.expirationDate&&(m.expirationDate=p.expirationDate),p.optionType&&!m.optionType&&(m.optionType=p.optionType),p.contractSize&&!m.contractSize&&(m.contractSize=p.contractSize)}else{let g={symbol:p.underlyingSymbol,direction:p.direction,entryTime:p.executionTime,entryPrice:p.price,quantity:p.quantity,commission:p.commission,assetType:p.assetType,status:"OPEN",currency:p.currency,strikePrice:p.strikePrice,expirationDate:p.expirationDate,optionType:p.optionType,contractSize:p.contractSize};s.set(p.fullSymbol,g)}}let c=new Map;for(let p of e){let m=Ue(p,"Symbol","Underlying");if(m&&m.trim()!==""){let g=m.trim();c.set(g,(c.get(g)||0)+1)}}let d=[],u=0;d.push(...l.filter(p=>p.status==="CLOSED"));for(let[p,m]of s){let g=c.get(p)||0,f=i.has(p),v=a.has(p),h=o.has(p);if(!f&&v&&m.direction==="short"&&g>=2&&h){u++;continue}g>=2||g===1&&m.direction==="long"||g===1&&m.direction==="short"&&m.status==="OPEN"?d.push(m):u++}return d}var Xk,aJe,STe=F(()=>{gg();Xk={symbol:"Symbol",direction:"Buy/Sell",dateTime:"Date/Time",price:"Price",volume:"Quantity",commission:"Commission"};aJe={name:"Interactive Brokers",detect:tJe,parseRow:wTe,parseBatch:iJe}});var TTe={};Ti(TTe,{TradeZeroAdapter:()=>dJe,parseTradeZeroRow:()=>fY});function sJe(e,t){if(!e||!t||e.trim()===""||t.trim()==="")return null;try{let n=`${e.trim()} ${t.trim()}`.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})\s+(\d{1,2}):(\d{2}):(\d{2})$/);if(!n)return null;let[,i,a,o,s,l,c]=n,d=parseInt(o,10),u=parseInt(i,10)-1,p=parseInt(a,10),m=parseInt(s,10),g=parseInt(l,10),f=parseInt(c,10),v=new Date(Date.UTC(d,u,p,12,0,0)),h=oJe.format(v),b=12-parseInt(h,10);return new Date(Date.UTC(d,u,p,m+b,g,f))}catch(r){return Le.error("[TradeZero] Error parsing date/time:",r,{tradeDate:e,execTime:t}),null}}function lJe(e){let t=[Fc.commission,Fc.sec,Fc.taf,Fc.nscc,Fc.nasdaq,Fc.ecnRemove,Fc.ecnAdd],r=0;for(let n of t){let i=Ue(e,n),a=En(i);a!==null&&(r+=a)}return r}function fY(e){try{let t=Ue(e,Fc.symbol,"Symbol");if(!t||t.trim()==="")return null;let r=Ue(e,Fc.direction,"Side");if(!r)return null;let n=Lc(r);if(!n)return null;let i=Ue(e,Fc.tradeDate,"T/D"),a=Ue(e,Fc.execTime,"Exec Time");if(!i||!a)return null;let o=sJe(i,a);if(!o)return null;let s=Ue(e,Fc.price,"Price"),l=En(s);if(l===null||l<=0)return null;let c=Ue(e,Fc.volume,"Qty","Quantity"),d=En(c);if(d===null||d===0)return null;let u=Math.abs(d),p=lJe(e),m=Ue(e,Fc.accountId,"Account");return{symbol:t.trim(),direction:n,entryTime:o,entryPrice:l,quantity:u,commission:p,accountId:m==null?void 0:m.trim(),assetType:"stock"}}catch(t){return Le.error("[TradeZero] Error parsing row:",t,e),null}}function cJe(e){var l,c,d;let t=[];for(let u of e)try{let p=fY(u);if(!p)continue;let m={symbol:p.symbol,direction:p.direction,executionTime:p.entryTime,price:p.entryPrice,quantity:p.quantity,commission:p.commission,accountId:p.accountId};t.push(m)}catch(p){Le.error("[TradeZero] Error parsing row in batch:",p);continue}t.sort((u,p)=>u.executionTime.getTime()-p.executionTime.getTime());let r=new Set,n=new Set;for(let u of t){let p=`${(l=u.accountId)!=null?l:""}:${u.symbol}`;u.direction==="long"?r.add(p):u.direction==="short"&&n.add(p)}let i=new Map,a=[];for(let u of t){let p=`${(c=u.accountId)!=null?c:""}:${u.symbol}`,m=i.get(p);if(m&&Nc(m.direction,u.direction)){let g=Math.min(m.quantity,u.quantity),f=u.commission*(g/u.quantity);m.exits||(m.exits=[]),m.exits.push({time:u.executionTime,price:u.price,quantity:g,commission:f}),m.originalQuantity||(m.originalQuantity=m.quantity),m.quantity-=g;let v=m.exits.reduce((h,y)=>h+y.quantity,0);if(v>=m.originalQuantity){m.quantity=m.originalQuantity,delete m.originalQuantity;let y=m.exits.reduce((S,w)=>S+w.price*w.quantity,0)/v,b=m.exits[m.exits.length-1];m.exitTime=b.time,m.exitPrice=y,m.status="CLOSED";let k=m.exits.reduce((S,w)=>S+w.commission,0),x;m.direction==="long"?x=(y-m.entryPrice)*v:x=(m.entryPrice-y)*v,x-=m.commission+k,m.profitLoss=x,m.commission=m.commission+k,a.push(m),i.delete(p)}if(u.quantity>g){let h=u.commission-f,y={symbol:u.symbol,direction:u.direction,entryTime:u.executionTime,entryPrice:u.price,quantity:u.quantity-g,commission:h,accountId:u.accountId,assetType:"stock",status:"OPEN"};i.set(p,y)}}else if(m&&m.direction===u.direction){m.entries||(m.entries=[{time:m.entryTime,price:m.entryPrice,quantity:m.quantity,commission:m.commission}]),m.entries.push({time:u.executionTime,price:u.price,quantity:u.quantity,commission:u.commission});let g=m.quantity+u.quantity,f=(m.quantity*m.entryPrice+u.quantity*u.price)/g;m.quantity=g,m.entryPrice=f,m.commission+=u.commission,u.executionTime<m.entryTime&&(m.entryTime=u.executionTime)}else{let g={symbol:u.symbol,direction:u.direction,entryTime:u.executionTime,entryPrice:u.price,quantity:u.quantity,commission:u.commission,accountId:u.accountId,assetType:"stock",status:"OPEN"};i.set(p,g)}}let o=new Map;for(let u of t){let p=`${(d=u.accountId)!=null?d:""}:${u.symbol}`;o.set(p,(o.get(p)||0)+1)}let s=[];s.push(...a.filter(u=>u.status==="CLOSED"));for(let[u,p]of i){let m=o.get(u)||0,g=r.has(u),f=n.has(u);!g&&f&&p.direction==="short"&&m>=2||(m>=2||m===1&&p.direction==="long"||m===1&&p.direction==="short"&&p.status==="OPEN")&&s.push(p)}return s}var oJe,Fc,dJe,CTe=F(()=>{gg();yf();oJe=new Intl.DateTimeFormat("en-US",{timeZone:"America/New_York",hour:"2-digit",hour12:!1}),Fc={symbol:"Symbol",direction:"Side",tradeDate:"T/D",execTime:"Exec Time",price:"Price",volume:"Qty",commission:"Comm",sec:"SEC",taf:"TAF",nscc:"NSCC",nasdaq:"Nasdaq",ecnRemove:"ECN Remove",ecnAdd:"ECN Add",accountId:"Account",clearingBroker:"Clr Broker",liquidity:"Liq"};dJe={name:"TradeZero",detect:e=>!1,parseRow:fY,parseBatch:cJe}});var hY={};Ti(hY,{TradingViewAdapter:()=>vJe,parseTradingViewBatch:()=>PTe,parseTradingViewRow:()=>gY,setTradingViewAssetType:()=>hJe});function mJe(e){let t=e.split(":"),r=t.length>1?t[1]:e;if(r=r.trim(),r.length>=4){let i=r.substring(0,3);if(vD[i])return i}if(r.length>=3){let i=r.substring(0,2);if(vD[i])return i}if(/\d{4}$/.test(r))for(let i=0;i<r.length;i++){let a=r[i];if(pJe.includes(a)){let o=r.substring(0,i);if(o.length>0)return o}}return r}function fJe(e){return!e||e.trim()===""?null:Fm(e.trim(),uJe)}function gJe(e){return!1}function gY(e){let t=Ue(e,hg.status);if(!t||t.toLowerCase().trim()!=="filled")return null;let r=Ue(e,hg.symbol);if(!r||r.trim()==="")return null;let n=mJe(r);if(!n||n.trim()==="")return null;let i=Ue(e,hg.direction);if(!i)return null;let a=Lc(i);if(!a)return null;let o=Ue(e,hg.fillPrice);if(!o||o.trim()==="")return null;let s=En(o);if(s===null)return null;let l=Ue(e,hg.volume);if(!l)return null;let c=En(l);if(c===null||c===0)return null;c<0&&(c=-c);let d=Ue(e,hg.closingTime),u=Ue(e,hg.placingTime),p=d||u;if(!p)return null;let m=fJe(p);if(!m)return null;let g=Ue(e,hg.commission),f=g&&En(g)||0,h=Ue(e,hg.orderID)||void 0,y=vD[n]||{contractSize:1,tickSize:.01,tickValue:1};return{symbol:n,direction:a,entryTime:m,entryPrice:s,quantity:c,commission:f,orderID:h,assetType:xu,contractSize:xu==="futures"?y.contractSize:xu==="options"?100:1,tickSize:y.tickSize,tickValue:y.tickValue}}function PTe(e){let t=[];for(let c of e){let d=gY(c);d&&t.push({symbol:d.symbol,direction:d.direction,time:d.entryTime,price:d.entryPrice,quantity:d.quantity,commission:d.commission,orderID:d.orderID})}if(t.length===0)return[];let r=new Map;for(let c of t){let d=c.orderID?`${c.orderID}-${c.symbol}-${c.direction}`:`${c.symbol}-${c.direction}-${c.time.getTime()}`;r.has(d)||r.set(d,[]),r.get(d).push(c)}let n=[];for(let[c,d]of r)if(d.length===1)n.push(d[0]);else{let u=d.reduce((v,h)=>v+h.quantity,0),p=d.reduce((v,h)=>v+h.price*h.quantity,0);if(u===0)continue;let m=p/u,g=d.reduce((v,h)=>v+h.commission,0),f={...d[0],price:m,quantity:u,commission:g,time:d[0].time};n.push(f)}n.sort((c,d)=>c.time.getTime()-d.time.getTime());let i=[],a=new Map;for(let c of n){let d=a.get(c.symbol)||[],u=d[0];if(u&&Nc(u.direction,c.direction)){let p=Math.min(u.quantity,c.quantity),m=c.commission*(p/c.quantity),g=c.commission-m,v=(u.direction==="long"?c.price-u.entryPrice:u.entryPrice-c.price)*p*u.contractSize-m;if(u.exits.push({time:c.time,price:c.price,quantity:p,commission:m}),u.accumulatedPnL+=v,u.quantity-=p,u.quantity===0){let h=u.exits.reduce((S,w)=>S+w.commission,0),y=u.commission+h,k=u.exits.reduce((S,w)=>S+w.price*w.quantity,0)/u.originalQuantity,x=u.exits[u.exits.length-1];i.push({symbol:u.symbol,direction:u.direction,entryTime:u.entryTime,entryPrice:u.entryPrice,quantity:u.originalQuantity,exitTime:x.time,exitPrice:k,profitLoss:u.accumulatedPnL-u.commission,commission:y,status:"CLOSED",assetType:xu,contractSize:u.contractSize,tickSize:u.tickSize,tickValue:u.tickValue,entries:u.entries,exits:u.exits}),d.shift(),d.length===0?a.delete(c.symbol):a.set(c.symbol,d)}if(c.quantity>p){let h=vD[c.symbol]||{contractSize:1,tickSize:.01,tickValue:1},y={symbol:c.symbol,direction:c.direction,entryTime:c.time,entryPrice:c.price,quantity:c.quantity-p,commission:g,assetType:xu,contractSize:xu==="futures"?h.contractSize:xu==="options"?100:1,tickSize:h.tickSize,tickValue:h.tickValue,exits:[],accumulatedPnL:0,originalQuantity:c.quantity-p,orderID:c.orderID},b=a.get(c.symbol)||[];b.push(y),a.set(c.symbol,b)}}else{let p=vD[c.symbol]||{contractSize:1,tickSize:.01,tickValue:1};if(d.length>0&&d[0].direction===c.direction){let m=d[0];m.entries||(m.entries=[{time:m.entryTime,price:m.entryPrice,quantity:m.quantity,commission:m.commission}]),m.entries.push({time:c.time,price:c.price,quantity:c.quantity,commission:c.commission});let g=m.quantity+c.quantity,f=(m.quantity*m.entryPrice+c.quantity*c.price)/g;m.quantity=g,m.entryPrice=f,m.originalQuantity=g,m.commission+=c.commission,a.set(c.symbol,d)}else{let m={symbol:c.symbol,direction:c.direction,entryTime:c.time,entryPrice:c.price,quantity:c.quantity,commission:c.commission,assetType:xu,contractSize:xu==="futures"?p.contractSize:xu==="options"?100:1,tickSize:p.tickSize,tickValue:p.tickValue,exits:[],accumulatedPnL:0,originalQuantity:c.quantity,orderID:c.orderID},g=a.get(c.symbol)||[];g.push(m),a.set(c.symbol,g)}}}let o=Array.from(a.values()).flat();for(let c of o)i.push({symbol:c.symbol,direction:c.direction,entryTime:c.entryTime,entryPrice:c.entryPrice,quantity:c.quantity,commission:c.commission,status:"OPEN",assetType:xu,contractSize:c.contractSize,tickSize:c.tickSize,tickValue:c.tickValue});let s=new Map;for(let c of t){let d=c.symbol,u=s.get(d)||{buyCount:0,sellCount:0};c.direction==="long"?u.buyCount++:u.sellCount++,s.set(d,u)}let l=[];for(let c of i){let d=s.get(c.symbol)||{buyCount:0,sellCount:0},u=d.buyCount+d.sellCount;(u>=2||u===1&&c.direction==="long"||u===1&&c.direction==="short"&&c.status==="OPEN")&&l.push(c)}return l}function hJe(e){xu=e}var hg,vD,uJe,pJe,xu,vJe,vY=F(()=>{gg();hg={symbol:"Symbol",direction:"Side",orderType:"Type",volume:"Qty",limitPrice:"Limit Price",stopPrice:"Stop Price",fillPrice:"Fill Price",status:"Status",commission:"Commission",placingTime:"Placing Time",closingTime:"Closing Time",orderID:"Order ID",levelID:"Level ID",leverage:"Leverage",margin:"Margin"},vD={MNQ:{contractSize:2,tickSize:.25,tickValue:.5},NQ:{contractSize:20,tickSize:.25,tickValue:5},ES:{contractSize:50,tickSize:.25,tickValue:12.5},MES:{contractSize:5,tickSize:.25,tickValue:1.25},YM:{contractSize:5,tickSize:1,tickValue:5},MYM:{contractSize:.5,tickSize:1,tickValue:.5},RTY:{contractSize:50,tickSize:.1,tickValue:5},M2K:{contractSize:5,tickSize:.1,tickValue:.5},GC:{contractSize:100,tickSize:.1,tickValue:10},MGC:{contractSize:10,tickSize:.1,tickValue:1},CL:{contractSize:1e3,tickSize:.01,tickValue:10},MCL:{contractSize:100,tickSize:.01,tickValue:1}},uJe=["yyyy-MM-dd HH:mm:ss","yyyy-MM-dd HH:mm:ss.SSS","yyyy-MM-dd'T'HH:mm:ss","yyyy-MM-dd'T'HH:mm:ss.SSS'Z'"],pJe=["F","G","H","J","K","M","N","Q","U","V","X","Z"],xu="futures";vJe={name:"TradingView Paper Trading",detect:gJe,parseRow:gY,parseBatch:PTe}});var ETe={};Ti(ETe,{BybitAdapter:()=>wJe,detectBybit:()=>DTe,parseBybitRow:()=>yY});function yJe(e){if(e.length<2)return e;let t=e[0],r=Object.keys(t),n=r[0];if(!n.includes("UID:")&&!n.startsWith("UID"))return e;Le.debug("[Bybit] Detected UID metadata line, reconstructing with correct headers");let i=r.map(s=>t[s]||""),a=i.map(s=>s.toLowerCase());if(!a.includes("contracts")&&!a.includes("direction"))return Le.warn("[Bybit] Could not find expected headers in first data row"),e;let o=[];for(let s=1;s<e.length;s++){let l=e[s],c=r.map(u=>l[u]||""),d={};i.forEach((u,p)=>{u&&u.trim()&&(d[u]=c[p]||"")}),o.push(d)}return Le.debug(`[Bybit] Reconstructed ${o.length} rows with correct headers`),o}function bJe(e){if(!e||e.trim()==="")return null;try{let t=e.trim(),r=new Date(t.replace(" ","T")+"Z");return isNaN(r.getTime())?null:r}catch(t){return Le.error("[Bybit] Error parsing date/time:",t,{dateTimeStr:e}),null}}function yY(e){try{let t=Ue(e,vv.filledType,"Filled Type");if(!t||t==="Funding"||t==="--"||t.trim()==="")return null;let r=Ue(e,vv.symbol,"contracts","Contracts");if(!r||r.trim()==="")return null;let n=Ue(e,vv.direction,"Direction");if(!n)return null;let i=Lc(n);if(!i)return null;let a=Ue(e,vv.dateTime,"Transaction Time(UTC+0)");if(!a)return null;let o=bJe(a);if(!o)return null;let s=Ue(e,vv.price,"Filled Price"),l=En(s);if(l===null||l<=0)return null;let c=Ue(e,vv.quantity,"Filled Qty"),d=En(c);if(d===null||d===0)return null;let u=Ue(e,vv.commission,"Fees Paid"),p=En(u)||0,m=Ue(e,vv.orderId,"Order No.");return{symbol:r.trim().toUpperCase(),direction:i,entryTime:o,entryPrice:l,quantity:Math.abs(d),commission:Math.abs(p),orderID:m==null?void 0:m.trim(),assetType:"crypto"}}catch(t){return Le.error("[Bybit] Error parsing row:",t,e),null}}function xJe(e){let t=yJe(e),r=[];for(let c of t)try{let d=yY(c);if(!d)continue;let u={symbol:d.symbol,direction:d.direction,executionTime:d.entryTime,price:d.entryPrice,quantity:d.quantity,commission:d.commission,orderId:d.orderID};r.push(u)}catch(d){Le.error("[Bybit] Error parsing row in batch:",d);continue}if(r.length===0)return[];r.sort((c,d)=>c.executionTime.getTime()-d.executionTime.getTime());let n=new Set,i=new Set;for(let c of r)c.direction==="long"?n.add(c.symbol):c.direction==="short"&&i.add(c.symbol);let a=new Map,o=[];for(let c of r){let d=c.symbol,u=a.get(d);if(u&&Nc(u.direction,c.direction)){let p=Math.min(u.quantity,c.quantity),m=c.commission*(p/c.quantity);u.exits||(u.exits=[]),u.exits.push({time:c.executionTime,price:c.price,quantity:p,commission:m}),u.originalQuantity||(u.originalQuantity=u.quantity);let g=1e-9;u.quantity-=p,u.quantity<g&&(u.quantity=0);let f=u.exits.reduce((h,y)=>h+y.quantity,0);if(f>=u.originalQuantity-g){u.quantity=u.originalQuantity,delete u.originalQuantity;let y=u.exits.reduce((S,w)=>S+w.price*w.quantity,0)/f,b=u.exits[u.exits.length-1];u.exitTime=b.time,u.exitPrice=y,u.status="CLOSED";let k=u.exits.reduce((S,w)=>S+w.commission,0),x;u.direction==="long"?x=(y-u.entryPrice)*f:x=(u.entryPrice-y)*f,x-=u.commission+k,u.profitLoss=x,u.commission=u.commission+k,o.push(u),a.delete(d)}let v=c.quantity-p;if(v>g){let h=c.commission-m,y={symbol:c.symbol,direction:c.direction,entryTime:c.executionTime,entryPrice:c.price,quantity:v,commission:h,assetType:"crypto",status:"OPEN"};a.set(d,y)}}else if(u&&u.direction===c.direction){u.entries||(u.entries=[{time:u.entryTime,price:u.entryPrice,quantity:u.quantity,commission:u.commission}]),u.entries.push({time:c.executionTime,price:c.price,quantity:c.quantity,commission:c.commission});let p=u.quantity+c.quantity,m=(u.quantity*u.entryPrice+c.quantity*c.price)/p;u.quantity=p,u.entryPrice=m,u.commission+=c.commission,c.executionTime<u.entryTime&&(u.entryTime=c.executionTime)}else{let p={symbol:c.symbol,direction:c.direction,entryTime:c.executionTime,entryPrice:c.price,quantity:c.quantity,commission:c.commission,assetType:"crypto",status:"OPEN"};a.set(d,p)}}let s=new Map;for(let c of r)s.set(c.symbol,(s.get(c.symbol)||0)+1);let l=[];l.push(...o.filter(c=>c.status==="CLOSED"));for(let[c,d]of a){let u=s.get(c)||0,p=n.has(c),m=i.has(c);!p&&m&&d.direction==="short"&&u>=2||(delete d.originalQuantity,(u>=2||u===1&&d.direction==="long"||u===1&&d.direction==="short"&&d.status==="OPEN")&&l.push(d))}return l}function DTe(e){return!1}var vv,wJe,ITe=F(()=>{gg();yf();vv={symbol:"contracts",direction:"Direction",dateTime:"Transaction Time(UTC+0)",price:"Filled Price",quantity:"Filled Qty",commission:"Fees Paid",filledType:"Filled Type",orderId:"Order No.",orderType:"Order Type",orderPrice:"Order Price",feeRate:"Trading Fee Rate",transactionId:"Transaction ID"};wJe={name:"Bybit",detect:DTe,parseRow:yY,parseBatch:xJe}});var ATe={};Ti(ATe,{BlofinAdapter:()=>CJe,detectBlofin:()=>MTe,parseBlofinRow:()=>xY});function bY(e){if(!e||e==="--"||e.trim()==="")return null;let t=e.trim().split(" ")[0];return En(t)}function kJe(e){if(!e||e.trim()==="")return null;let t=e.replace(/\(TP\)|\(SL\)/gi,"").trim();return Lc(t)}function SJe(e){if(!e||e.trim()==="")return null;try{let t=e.trim(),r=t.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})\s+(\d{1,2}):(\d{2}):(\d{2})$/);if(!r){let d=new Date(t);return isNaN(d.getTime())?null:d}let[,n,i,a,o,s,l]=r,c=new Date(parseInt(a,10),parseInt(n,10)-1,parseInt(i,10),parseInt(o,10),parseInt(s,10),parseInt(l,10));return isNaN(c.getTime())?null:c}catch(t){return Le.error("[Blofin] Error parsing date/time:",t,{dateTimeStr:e}),null}}function xY(e){try{let t=Ue(e,ix.status,"Status");if(!t||t!=="Filled")return null;let r=Ue(e,ix.symbol,"Underlying Asset");if(!r||r.trim()==="")return null;let n=Ue(e,ix.direction,"Side"),i=kJe(n);if(!i)return null;let a=Ue(e,ix.dateTime,"Order Time"),o=SJe(a);if(!o)return null;let s=Ue(e,ix.avgFill,"Avg Fill"),l=bY(s);if(l===null||l<=0)return null;let c=Ue(e,ix.filled,"Filled"),d=bY(c);if(d===null||d===0)return null;let u=Ue(e,ix.fee,"Fee"),p=bY(u)||0;return{symbol:r.trim().toUpperCase(),direction:i,entryTime:o,entryPrice:l,quantity:Math.abs(d),commission:Math.abs(p),assetType:"crypto"}}catch(t){return Le.error("[Blofin] Error parsing row:",t,e),null}}function TJe(e){let t=[];for(let l of e)try{let c=xY(l);if(!c)continue;let d={symbol:c.symbol,direction:c.direction,executionTime:c.entryTime,price:c.entryPrice,quantity:c.quantity,commission:c.commission};t.push(d)}catch(c){Le.error("[Blofin] Error parsing row in batch:",c);continue}if(t.length===0)return[];t.sort((l,c)=>l.executionTime.getTime()-c.executionTime.getTime());let r=new Set,n=new Set;for(let l of t)l.direction==="long"?r.add(l.symbol):l.direction==="short"&&n.add(l.symbol);let i=new Map,a=[];for(let l of t){let c=l.symbol,d=i.get(c);if(d&&Nc(d.direction,l.direction)){let u=Math.min(d.quantity,l.quantity);if(l.quantity<=0)continue;let p=l.commission*(u/l.quantity);d.exits||(d.exits=[]),d.exits.push({time:l.executionTime,price:l.price,quantity:u,commission:p}),d.originalQuantity||(d.originalQuantity=d.quantity);let m=1e-9;d.quantity-=u,d.quantity<m&&(d.quantity=0);let g=d.exits.reduce((v,h)=>v+h.quantity,0);if(g>=d.originalQuantity-m){d.quantity=d.originalQuantity,delete d.originalQuantity;let h=d.exits.reduce((x,S)=>x+S.price*S.quantity,0)/g,y=d.exits[d.exits.length-1];d.exitTime=y.time,d.exitPrice=h,d.status="CLOSED";let b=d.exits.reduce((x,S)=>x+S.commission,0),k;d.direction==="long"?k=(h-d.entryPrice)*g:k=(d.entryPrice-h)*g,k-=d.commission+b,d.profitLoss=k,d.commission=d.commission+b,a.push(d),i.delete(c)}let f=l.quantity-u;if(f>m){let v=l.commission-p,h={symbol:l.symbol,direction:l.direction,entryTime:l.executionTime,entryPrice:l.price,quantity:f,commission:v,assetType:"crypto",status:"OPEN"};i.set(c,h)}}else if(d&&d.direction===l.direction){d.entries||(d.entries=[{time:d.entryTime,price:d.entryPrice,quantity:d.quantity,commission:d.commission}]),d.entries.push({time:l.executionTime,price:l.price,quantity:l.quantity,commission:l.commission});let u=d.quantity+l.quantity,p=(d.quantity*d.entryPrice+l.quantity*l.price)/u;d.quantity=u,d.entryPrice=p,d.commission+=l.commission,l.executionTime<d.entryTime&&(d.entryTime=l.executionTime)}else{let u={symbol:l.symbol,direction:l.direction,entryTime:l.executionTime,entryPrice:l.price,quantity:l.quantity,commission:l.commission,assetType:"crypto",status:"OPEN"};i.set(c,u)}}let o=new Map;for(let l of t)o.set(l.symbol,(o.get(l.symbol)||0)+1);let s=[];s.push(...a.filter(l=>l.status==="CLOSED"));for(let[l,c]of i){let d=o.get(l)||0,u=r.has(l),p=n.has(l);!u&&p&&c.direction==="short"&&d>=2||(delete c.originalQuantity,(d>=2||d===1&&c.direction==="long"||d===1&&c.direction==="short"&&c.status==="OPEN")&&s.push(c))}return s}function MTe(e){return!1}var ix,CJe,LTe=F(()=>{gg();yf();ix={symbol:"Underlying Asset",direction:"Side",dateTime:"Order Time",avgFill:"Avg Fill",price:"Price",filled:"Filled",total:"Total",pnl:"PNL",pnlPercent:"PNL%",fee:"Fee",orderOptions:"Order Options",reduceOnly:"Reduce-only",status:"Status",marginMode:"Margin Mode",leverage:"Leverage"};CJe={name:"Blofin",detect:MTe,parseRow:xY,parseBatch:TJe}});var jTe={};Ti(jTe,{HyperliquidAdapter:()=>DJe,detectHyperliquid:()=>zTe,parseHyperliquidRow:()=>OTe});function NTe(e){if(!e||e.trim()==="")return null;try{let r=e.trim().split(" - ");if(r.length!==2)return Le.warn("[Hyperliquid] Unexpected date format:",{dateTimeStr:e}),null;let[n,i]=r,a=n.split("/");if(a.length!==3)return null;let o=parseInt(a[0],10),s=parseInt(a[1],10),l=parseInt(a[2],10),c=i.split(":");if(c.length!==3)return null;let d=parseInt(c[0],10),u=parseInt(c[1],10),p=parseInt(c[2],10);if(o<1||o>12||s<1||s>31||d<0||d>23||u<0||u>59||p<0||p>59)return null;let m=new Date(Date.UTC(l,o-1,s,d,u,p));return isNaN(m.getTime())?null:m}catch(t){return Le.error("[Hyperliquid] Error parsing date/time:",t,{dateTimeStr:e}),null}}function FTe(e){if(!e||e.trim()==="")return null;let t=e.trim().toLowerCase(),r=t.includes("open"),n=t.includes("close"),i=t.includes("long"),a=t.includes("short");return r&&n||!r&&!n?(Le.warn("[Hyperliquid] Ambiguous action in direction:",{dirStr:e}),null):i&&a||!i&&!a?(Le.warn("[Hyperliquid] Ambiguous direction:",{dirStr:e}),null):{isEntry:r,direction:i?"long":"short"}}function OTe(e){try{let t=Ue(e,md.symbol,"coin","Coin");if(!t||t.trim()==="")return null;let r=Ue(e,md.direction,"dir","Dir");if(!r)return null;let n=FTe(r);if(!n)return null;let i=Ue(e,md.time,"time","Time");if(!i)return null;let a=NTe(i);if(!a)return null;let o=Ue(e,md.price,"px","Px"),s=En(o);if(s===null||s<=0)return null;let l=Ue(e,md.quantity,"sz","Sz"),c=En(l);if(c===null||c===0)return null;let d=Ue(e,md.commission,"fee","Fee"),u=En(d)||0;return{symbol:t.trim().toUpperCase(),direction:n.direction,entryTime:a,entryPrice:s,quantity:Math.abs(c),commission:Math.abs(u),assetType:"crypto"}}catch(t){return Le.error("[Hyperliquid] Error parsing row:",t,e),null}}function PJe(e){let t=[];for(let l of e)try{let c=Ue(l,md.symbol,"coin","Coin");if(!c||c.trim()==="")continue;let d=Ue(l,md.direction,"dir","Dir");if(!d)continue;let u=FTe(d);if(!u)continue;let p=Ue(l,md.time,"time","Time");if(!p)continue;let m=NTe(p);if(!m)continue;let g=Ue(l,md.price,"px","Px"),f=En(g);if(f===null||f<=0)continue;let v=Ue(l,md.quantity,"sz","Sz"),h=En(v);if(h===null||h===0)continue;let y=Ue(l,md.commission,"fee","Fee"),b=En(y)||0,k=Ue(l,md.closedPnl,"closedPnl","ClosedPnl"),x=En(k)||0;t.push({symbol:c.trim().toUpperCase(),isEntry:u.isEntry,direction:u.direction,executionTime:m,price:f,quantity:Math.abs(h),commission:Math.abs(b),closedPnl:x})}catch(c){Le.error("[Hyperliquid] Error parsing row in batch:",c);continue}if(t.length===0)return[];t.sort((l,c)=>l.executionTime.getTime()-c.executionTime.getTime());let r=new Set,n=new Set;for(let l of t)l.isEntry?r.add(l.symbol):n.add(l.symbol);let i=new Map,a=[];for(let l of t){let c=l.symbol,d=i.get(c);if(!l.isEntry&&d&&d.direction===l.direction){let u=Math.min(d.quantity,l.quantity),p=l.commission*(u/l.quantity);d.exits||(d.exits=[]),d.exits.push({time:l.executionTime,price:l.price,quantity:u,commission:p}),d.originalQuantity||(d.originalQuantity=d.quantity);let m=1e-9;d.quantity-=u,d.quantity<m&&(d.quantity=0);let g=d.exits.reduce((v,h)=>v+h.quantity,0);if(g>=d.originalQuantity-m){d.quantity=d.originalQuantity,delete d.originalQuantity;let h=d.exits.reduce((x,S)=>x+S.price*S.quantity,0)/g,y=d.exits[d.exits.length-1];d.exitTime=y.time,d.exitPrice=h,d.status="CLOSED";let b=d.exits.reduce((x,S)=>x+S.commission,0),k;d.direction==="long"?k=(h-d.entryPrice)*g:k=(d.entryPrice-h)*g,k-=d.commission+b,d.profitLoss=k,d.commission=d.commission+b,a.push(d),i.delete(c)}l.quantity-u>m&&Le.warn("[Hyperliquid] Close quantity exceeds open position, possible data issue")}else if(l.isEntry&&d&&d.direction===l.direction){d.entries||(d.entries=[{time:d.entryTime,price:d.entryPrice,quantity:d.quantity,commission:d.commission}]),d.entries.push({time:l.executionTime,price:l.price,quantity:l.quantity,commission:l.commission});let u=d.quantity+l.quantity,p=(d.quantity*d.entryPrice+l.quantity*l.price)/u;d.quantity=u,d.entryPrice=p,d.commission+=l.commission,l.executionTime<d.entryTime&&(d.entryTime=l.executionTime)}else if(l.isEntry){let u={symbol:l.symbol,direction:l.direction,entryTime:l.executionTime,entryPrice:l.price,quantity:l.quantity,commission:l.commission,assetType:"crypto",status:"OPEN"};i.set(c,u)}else Le.debug("[Hyperliquid] Skipping close without matching open:",{symbol:l.symbol})}let o=new Map;for(let l of t)o.set(l.symbol,(o.get(l.symbol)||0)+1);let s=[];s.push(...a.filter(l=>l.status==="CLOSED"));for(let[l,c]of i)r.has(l)&&(delete c.originalQuantity,s.push(c));return s}function zTe(e){return!1}var md,DJe,_Te=F(()=>{gg();yf();md={time:"time",symbol:"coin",direction:"dir",price:"px",quantity:"sz",notional:"ntl",commission:"fee",closedPnl:"closedPnl"};DJe={name:"Hyperliquid",detect:zTe,parseRow:OTe,parseBatch:PJe}});var WTe={};Ti(WTe,{TradovateAdapter:()=>NJe,parseTradovateBatch:()=>BTe,parseTradovateRow:()=>wY});function MJe(e){e=e.trim().replace(/\//g,"");let t=e.split(/\s+/);if(t.length>0&&(e=t[0]),e.length>=4){let r=e.substring(0,3);if(yD[r])return r}if(e.length>=3){let r=e.substring(0,2);if(yD[r])return r}if(!e.includes("_")&&e.length>=4&&e.length<=8)for(let r=2;r<Math.min(e.length,5);r++){let n=e[r];if(IJe.includes(n)&&e.substring(r+1).match(/^\d{1,2}$/))return e.substring(0,r)}return e}function AJe(e){return!e||e.trim()===""?null:Fm(e.trim(),EJe)}function LJe(e){return!1}function wY(e){let t=Ue(e,yp.status);if(t&&t.toLowerCase().trim()!=="filled")return null;let r=Ue(e,yp.symbol);if(!r||r.trim()==="")return null;let n=MJe(r),i=Ue(e,yp.direction);if(!i)return null;let a=Lc(i);if(!a)return null;let o=Ue(e,yp.dateTime);if(!o)return null;let s=AJe(o);if(!s)return null;let l=Ue(e,yp.price,yp.priceAlt);if(!l)return null;let c=En(l);if(c===null)return null;let d=Ue(e,yp.volume,yp.volumeAlt);if(!d)return null;let u=En(d);if(u===null||u===0)return null;u<0&&(u=-u);let p=Ue(e,yp.commission),m=p&&En(p)||0,g=Ue(e,yp.accountId),v=Ue(e,...yp.orderID)||void 0,h=yD[n]||{contractSize:1,tickSize:.01,tickValue:1};return{symbol:n,direction:a,entryTime:s,entryPrice:c,quantity:u,commission:m,accountId:g||void 0,orderID:v,assetType:"futures",contractSize:h.contractSize,tickSize:h.tickSize,tickValue:h.tickValue}}function BTe(e){let t=[];for(let d of e){let u=wY(d);u&&t.push({symbol:u.symbol,direction:u.direction,time:u.entryTime,price:u.entryPrice,quantity:u.quantity,commission:u.commission,orderID:u.orderID})}if(t.length===0)return[];let r=new Map;for(let d of t){let u=d.orderID?`${d.orderID}-${d.symbol}-${d.direction}`:`${d.symbol}-${d.direction}-${d.time.getTime()}`;r.has(u)||r.set(u,[]),r.get(u).push(d)}let n=[];for(let[d,u]of r)if(u.length===1)n.push(u[0]);else{let p=u.reduce((h,y)=>h+y.quantity,0),m=u.reduce((h,y)=>h+y.price*y.quantity,0);if(p===0)continue;let g=m/p,f=u.reduce((h,y)=>h+y.commission,0),v={...u[0],price:g,quantity:p,commission:f,time:u[0].time};n.push(v)}n.sort((d,u)=>d.time.getTime()-u.time.getTime());let i=[],a=new Map;for(let d of n){let u=a.get(d.symbol)||[],p=u[0];if(p&&Nc(p.direction,d.direction)){let m=Math.min(p.quantity,d.quantity),g=d.commission*(m/d.quantity),f=d.commission-g,h=(p.direction==="long"?d.price-p.entryPrice:p.entryPrice-d.price)*m*p.contractSize-g;if(p.exits.push({time:d.time,price:d.price,quantity:m,commission:g}),p.accumulatedPnL+=h,p.quantity-=m,p.quantity===0){let y=p.exits.reduce((w,C)=>w+C.commission,0),b=p.commission+y,x=p.exits.reduce((w,C)=>w+C.price*C.quantity,0)/p.originalQuantity,S=p.exits[p.exits.length-1];i.push({symbol:p.symbol,direction:p.direction,entryTime:p.entryTime,entryPrice:p.entryPrice,quantity:p.originalQuantity,exitTime:S.time,exitPrice:x,profitLoss:p.accumulatedPnL-p.commission,commission:b,status:"CLOSED",assetType:"futures",contractSize:p.contractSize,tickSize:p.tickSize,tickValue:p.tickValue,entries:p.entries,exits:p.exits}),u.shift(),u.length===0?a.delete(d.symbol):a.set(d.symbol,u)}if(d.quantity>m){let y=yD[d.symbol]||{contractSize:1,tickSize:.01,tickValue:1},b={symbol:d.symbol,direction:d.direction,entryTime:d.time,entryPrice:d.price,quantity:d.quantity-m,commission:f,assetType:"futures",contractSize:y.contractSize,tickSize:y.tickSize,tickValue:y.tickValue,exits:[],accumulatedPnL:0,originalQuantity:d.quantity-m,orderID:d.orderID},k=a.get(d.symbol)||[];k.push(b),a.set(d.symbol,k)}}else{let m=yD[d.symbol]||{contractSize:1,tickSize:.01,tickValue:1};if(u.length>0&&u[0].direction===d.direction){let g=u[0];g.entries||(g.entries=[{time:g.entryTime,price:g.entryPrice,quantity:g.quantity,commission:g.commission}]),g.entries.push({time:d.time,price:d.price,quantity:d.quantity,commission:d.commission});let f=g.quantity+d.quantity,v=(g.quantity*g.entryPrice+d.quantity*d.price)/f;g.quantity=f,g.entryPrice=v,g.originalQuantity=f,g.commission+=d.commission,a.set(d.symbol,u)}else{let g={symbol:d.symbol,direction:d.direction,entryTime:d.time,entryPrice:d.price,quantity:d.quantity,commission:d.commission,assetType:"futures",contractSize:m.contractSize,tickSize:m.tickSize,tickValue:m.tickValue,exits:[],accumulatedPnL:0,originalQuantity:d.quantity,orderID:d.orderID},f=a.get(d.symbol)||[];f.push(g),a.set(d.symbol,f)}}}let o=Array.from(a.values()).flat();for(let d of o)i.push({symbol:d.symbol,direction:d.direction,entryTime:d.entryTime,entryPrice:d.entryPrice,quantity:d.quantity,commission:d.commission,status:"OPEN",assetType:"futures",contractSize:d.contractSize,tickSize:d.tickSize,tickValue:d.tickValue});let s=new Map;for(let d of t){let u=d.symbol,p=s.get(u)||{buyCount:0,sellCount:0};d.direction==="long"?p.buyCount++:p.sellCount++,s.set(u,p)}let l=[],c=0;for(let d of i){let u=s.get(d.symbol)||{buyCount:0,sellCount:0},p=u.buyCount+u.sellCount;p>=2||p===1&&d.direction==="long"||p===1&&d.direction==="short"&&d.status==="OPEN"?l.push(d):c++}return l}var yp,yD,EJe,IJe,NJe,$Te=F(()=>{gg();yp={symbol:"Contract",direction:"B/S",dateTime:"Fill Time",price:"Avg Fill Price",priceAlt:"avgPrice",volume:"Filled Qty",volumeAlt:"filledQty",commission:"Commission",status:"Status",accountId:"Account",orderID:["Order ID","orderId","OrderID","order_id"]},yD={MNQ:{contractSize:2,tickSize:.25,tickValue:.5},NQ:{contractSize:20,tickSize:.25,tickValue:5},ES:{contractSize:50,tickSize:.25,tickValue:12.5},MES:{contractSize:5,tickSize:.25,tickValue:1.25},YM:{contractSize:5,tickSize:1,tickValue:5},MYM:{contractSize:.5,tickSize:1,tickValue:.5},RTY:{contractSize:50,tickSize:.1,tickValue:5},M2K:{contractSize:5,tickSize:.1,tickValue:.5},GC:{contractSize:100,tickSize:.1,tickValue:10},MGC:{contractSize:10,tickSize:.1,tickValue:1},CL:{contractSize:1e3,tickSize:.01,tickValue:10},MCL:{contractSize:100,tickSize:.01,tickValue:1}},EJe=["yyyy-MM-dd HH:mm:ss.SSS","yyyy-MM-dd HH:mm:ss","MM/dd/yyyy HH:mm:ss","M/d/yyyy HH:mm:ss","yyyy-MM-dd'T'HH:mm:ss","yyyy-MM-dd'T'HH:mm:ss.SSS'Z'","MM/dd/yyyy","M/d/yyyy"],IJe=["F","G","H","J","K","M","N","Q","U","V","X","Z"];NJe={name:"Tradovate",detect:LJe,parseRow:wY,parseBatch:BTe}});var tj,RTe=F(()=>{gg();pV();mV();qO();vTe();Tr();tj=class{constructor(t){var i;this.plugin=t;let r=((i=t.serviceManager)==null?void 0:i.getFolderPathService())||new pv(t.app,t),n=t.settings.backendIntegration||{syncEnabled:!1,userId:"",showSyncNotifications:!1,showNewTradeNotifications:!1};this.tradeSyncService=new hk(t,n,r),this.tradeFileGenerator=new vk(t,n,r),this.specService=t.specService}generateCSVImportId(t,r){let n=Math.floor(new Date(t.entryTime).getTime()/1e3),i=Math.floor(n/60)*60,a=Math.round(parseFloat(String(t.entryPrice))*1e5)/1e5;return`${r}_${t.symbol}_${t.direction}_${i}_${a}_${t.quantity}`}getAdapter(t){if(t==="IBKR"){let{IBKRAdapter:n}=(STe(),hd(kTe));return n}else if(t==="TRADEZERO"){let{TradeZeroAdapter:n}=(CTe(),hd(TTe));return n}else if(t==="TRADINGVIEW"){let{TradingViewAdapter:n}=(vY(),hd(hY));return n}else if(t==="BYBIT"){let{BybitAdapter:n}=(ITe(),hd(ETe));return n}else if(t==="BLOFIN"){let{BlofinAdapter:n}=(LTe(),hd(ATe));return n}else if(t==="HYPERLIQUID"){let{HyperliquidAdapter:n}=(_Te(),hd(jTe));return n}let{TradovateAdapter:r}=($Te(),hd(WTe));return r}async importWithBrokerAdapter(t,r,n,i){let a={success:!1,imported:0,duplicates:0,errors:[],failedRows:[],unmappedSymbols:[]};try{if(await this.tradeSyncService.buildTradeFileCache(),r==="TRADINGVIEW"&&i){let{setTradingViewAssetType:u}=(vY(),hd(hY));u(i)}let o=this.getAdapter(r),s;if(o.parseBatch)try{s=o.parseBatch(n)}catch(u){let p=u instanceof Error?u.message:String(u);return a.errors.push(`Batch parsing failed: ${p}`),a}else{s=[];for(let u=0;u<n.length;u++){let p=n[u];try{let m=o.parseRow(p);m&&s.push(m)}catch(m){let g=m instanceof Error?m.message:String(m);a.failedRows.push({row:u+1,reason:g})}}}let l=[],c=[];for(let u of s){let p=this.convertToTrade(u,t,a.unmappedSymbols);await this.checkDuplicate(p)?(l.push(u),a.duplicates++):c.push(p)}let d=[];for(let u=0;u<c.length;u++){let p=c[u];try{let m=await this.createTradeFile(p);a.imported++,d.length<5&&d.push({filePath:m,symbol:p.symbol,direction:p.direction==="BUY"?"long":"short",quantity:p.volume,entryPrice:p.entry_price,entryTime:p.entry_time,exitPrice:p.exit_price,profitLoss:p.profit_loss,status:p.status==="OPEN"||p.status==="CLOSED"?p.status:p.exit_price?"CLOSED":"OPEN"})}catch(m){let g=m instanceof Error?m.message:String(m);console.error("[CSV] ERROR processing trade:",p.symbol,"-",g),a.failedRows.push({row:u+1,reason:g})}}a.success=a.imported>0||a.duplicates>0,a.importedTrades=d,a.accountName=t,a.brokerType=r,console.log("[CSV] Import complete:",{imported:a.imported,duplicates:a.duplicates,errors:a.errors.length}),a.imported>0&&xe.publish("trade:changed",{action:"batch",importedCount:a.imported,timestamp:Date.now()})}catch(o){let s=o instanceof Error?o.message:String(o);a.errors.push(s)}return a}async importWithTemplate(t,r,n,i=!1){let a={success:!1,imported:0,duplicates:0,errors:[],failedRows:[],unmappedSymbols:[]};try{await this.tradeSyncService.buildTradeFileCache();let o;try{o=this.parseBatchWithTemplate(n,r)}catch(l){let c=l instanceof Error?l.message:String(l);return a.errors.push(`Batch parsing failed: ${c}`),a}if(r.asset_type==="options"&&!i){let l=this.validateOptionsData(o);if(!l.isValid)return{...a,needsWarning:!0,warningData:l.missingFields}}let s=[];for(let l=0;l<o.length;l++){let c=o[l];try{let d=this.convertToTrade(c,t,a.unmappedSymbols);if(await this.checkDuplicate(d)){a.duplicates++;continue}let u=await this.createTradeFile(d);a.imported++,s.length<5&&s.push({filePath:u,symbol:d.symbol,direction:d.direction==="BUY"?"long":"short",quantity:d.volume,entryPrice:d.entry_price,entryTime:d.entry_time,exitPrice:d.exit_price,profitLoss:d.profit_loss,status:d.status==="OPEN"||d.status==="CLOSED"?d.status:d.exit_price?"CLOSED":"OPEN"})}catch(d){let u=d instanceof Error?d.message:String(d);console.error("[CSV] ERROR creating file for trade:",c.symbol,"-",u),a.failedRows.push({row:l+1,reason:u})}}a.success=a.imported>0||a.duplicates>0,a.importedTrades=s,a.accountName=t,a.brokerType=r.broker_type,console.log("[CSV] Import complete:",{imported:a.imported,duplicates:a.duplicates,errors:a.errors.length}),a.imported>0&&xe.publish("trade:changed",{action:"batch",importedCount:a.imported,timestamp:Date.now()})}catch(o){let s=o instanceof Error?o.message:String(o);a.errors.push(s)}return a}validateOptionsData(t){let r=0,n=0,i=0;for(let s of t)s.strikePrice||r++,s.expirationDate||n++,s.optionType||i++;let a=t.length;return{isValid:!(r>0||n>0||i>0),missingFields:{tradesCount:a,missingStrike:r,missingExpiry:n,missingOptionType:i}}}parseBatchWithTemplate(t,r){let n=r.column_mappings,i=[];for(let c of t){let d=this.parseRowWithTemplate(c,r,r.asset_type);d&&i.push(d)}let a=Object.values(n).includes("order_id"),o=i;a&&(o=this.aggregateByOrderId(i));let s=new Map,l=[];for(let c of o){if(c.exitTime&&c.exitPrice){c.status="CLOSED",l.push(c);continue}let d=`${c.symbol}-${c.assetType||"stock"}`,u=s.get(d);if(u&&Nc(u.direction,c.direction)){let p=Math.min(u.quantity,c.quantity);if(p>0&&(u.exits||(u.exits=[]),u.exits.push({time:c.entryTime,price:c.entryPrice,quantity:p,commission:c.commission}),u.originalQuantity||(u.originalQuantity=u.quantity),u.quantity-=p,u.quantity===0)){u.quantity=u.originalQuantity,delete u.originalQuantity;let m=u.exits.reduce((h,y)=>h+y.price*y.quantity,0),g=u.exits.reduce((h,y)=>h+y.quantity,0);if(g===0){console.warn("[CSV] Warning: Trade has exits with zero total quantity, skipping exit price calculation"),s.delete(d);continue}let f=m/g,v=u.exits[u.exits.length-1];if(u.exitTime=v.time,u.exitPrice=f,u.status="CLOSED",!u.profitLoss){let h=u.contractSize||(u.assetType==="options"?100:1),y=u.direction==="long"?f-u.entryPrice:u.entryPrice-f,b=u.exits.reduce((k,x)=>k+x.commission,0);u.profitLoss=y*g*h-u.commission-b}delete u.exits,l.push(u),s.delete(d)}}else if(u&&u.direction===c.direction){u.entries||(u.entries=[{time:u.entryTime,price:u.entryPrice,quantity:u.quantity,commission:u.commission||0}]),u.entries.push({time:c.entryTime,price:c.entryPrice,quantity:c.quantity,commission:c.commission||0});let p=u.quantity+c.quantity,m=u.quantity*u.entryPrice+c.quantity*c.entryPrice;u.entryPrice=m/p,u.quantity=p,u.commission=(u.commission||0)+(c.commission||0),s.set(d,u)}else c.status="OPEN",s.set(d,c)}for(let[c,d]of s)l.push(d);return l}aggregateByOrderId(t){let r=new Map;for(let i of t){let a=i.orderID?`${i.orderID}-${i.symbol}-${i.direction}`:`${i.symbol}-${i.direction}-${i.entryTime.getTime()}`;r.has(a)||r.set(a,[]),r.get(a).push(i)}let n=[];for(let[i,a]of r)if(a.length===1)n.push(a[0]);else{let o=a.reduce((p,m)=>p+m.quantity,0);if(o<=0)continue;let l=a.reduce((p,m)=>p+m.entryPrice*m.quantity,0)/o,c=a.reduce((p,m)=>p+m.commission,0),d=a.reduce((p,m)=>m.entryTime<p?m.entryTime:p,a[0].entryTime),u={...a[0],entryTime:d,entryPrice:l,quantity:o,commission:c};n.push(u)}return n}parseRowWithTemplate(t,r,n="stock"){let i=r.column_mappings,a=(re,Z=[])=>{for(let[ne,se]of Object.entries(i))if(se===re||Z.includes(se))return ne},o=a("symbol",["Symbol","instrument"]),s=a("direction",["Direction","side","Side"]),l=a("entry_time",["dateTime","DateTime","date","time"]),c=a("entry_price",["price","Price","exec_price"]),d=a("quantity",["volume","Volume","qty","Quantity","shares"]),u=a("commission",["Commission","fee","comm"]);if(!o||!s||!l||!c||!d)return null;let p=Ue(t,o),m=Ue(t,s),g=Ue(t,l),f=Ue(t,c),v=Ue(t,d),h=u?Ue(t,u):void 0;if(!p||!m||!g||!f||!v)return null;let y=Lc(m);if(!y)return null;let b=r.date_format?[r.date_format,"yyyy-MM-dd HH:mm:ss","MM/dd/yyyy HH:mm:ss","yyyy-MM-dd"]:["yyyy-MM-dd HH:mm:ss","MM/dd/yyyy HH:mm:ss","yyyy-MM-dd","MM/dd/yyyy"],k=Fm(g,b);if(!k)return null;let x=En(f),S=En(v),w=h&&En(h)||0;if(x===null||S===null)return null;let C=a("exit_time",["exit_date"]),D=a("exit_price"),P=a("profit_loss",["pnl","p_l"]),M,z,A;if(C){let re=Ue(t,C);re&&(M=Fm(re,b)||void 0)}if(D){let re=Ue(t,D);z=En(re)||void 0}if(P){let re=Ue(t,P);A=En(re)||void 0}let I=a("asset_type",["instrument_type"]),L=a("strike_price",["strike"]),E=a("expiration_date",["expiry","exp_date"]),T=a("option_type",["call_put"]),$=a("contract_size",["multiplier","contract_mult"]),_=a("order_id",["order_number","order"]),B=a("account_id",["account"]),W=a("status",["trade_status"]),N=I?Ue(t,I):void 0,U=L&&En(Ue(t,L))||void 0,j=E&&Fm(Ue(t,E)||"",b)||void 0,R=T?mTe(Ue(t,T)):void 0,O=$&&En(Ue(t,$))||void 0,H=_?Ue(t,_):void 0,q=B?Ue(t,B):void 0,V=W?fTe(Ue(t,W)):void 0,J=p.trim(),K=U,G=j,X=R;if(n==="options"&&hTe(p)){let re=gTe(p);re&&(J=re.underlying,K=K||re.strikePrice,G=G||re.expirationDate,X=X||re.optionType)}return{symbol:J,direction:y,entryTime:k,entryPrice:x,quantity:S,commission:w,exitTime:M,exitPrice:z,profitLoss:A,status:V,assetType:N||n||"stock",strikePrice:K,expirationDate:G,optionType:X,contractSize:O,orderID:H,accountId:q}}convertToTrade(t,r,n){var s,l,c,d,u,p;let i=t.direction==="long"?"BUY":"SELL",a=t.status||(t.exitTime?"CLOSED":"OPEN"),o={id:0,symbol:t.symbol,entry_time:t.entryTime.toISOString(),entry_price:t.entryPrice,volume:t.quantity,direction:i,exit_time:(s=t.exitTime)==null?void 0:s.toISOString(),exit_price:t.exitPrice,profit_loss:t.profitLoss||0,commission:t.commission||0,swap:0,fees:0,account_id:0,mt_account_display_name:r,status:a,csvImportId:this.generateCSVImportId(t,r),entries:(c=(l=t.entries)==null?void 0:l.map(m=>({time:m.time.toISOString(),price:m.price,size:m.quantity})))!=null?c:[{time:t.entryTime.toISOString(),price:t.entryPrice,size:t.quantity}],exits:(u=(d=t.exits)==null?void 0:d.map(m=>({time:m.time.toISOString(),price:m.price,size:m.quantity})))!=null?u:t.exitTime&&t.exitPrice!==void 0?[{time:t.exitTime.toISOString(),price:t.exitPrice,size:t.quantity}]:[],assetType:t.assetType,strikePrice:t.strikePrice,expirationDate:(p=t.expirationDate)==null?void 0:p.toISOString(),optionType:t.optionType,contractSize:t.contractSize,currency:t.currency};if(o.assetType==="futures"||o.assetType==="forex"){let m=this.specService.getSpecsForSymbol(o.symbol,o.assetType);if(!m&&n&&(n.some(f=>f.symbol===o.symbol&&f.assetType===o.assetType)||n.push({symbol:o.symbol,assetType:o.assetType})),m){if(o.assetType==="futures"&&"dollarPerPoint"in m){if(o.dollarPerPoint=m.dollarPerPoint,o.tickSize=m.tickSize,o.tickValue=m.tickValue,o.profit_loss!==void 0&&o.exit_price!==void 0)if(!Number.isFinite(m.tickSize)||m.tickSize<=0)console.warn(`Invalid tickSize for ${o.symbol}: ${m.tickSize} - skipping P&L recalculation`);else if(!Number.isFinite(m.tickValue)||m.tickValue<=0)console.warn(`Invalid tickValue for ${o.symbol}: ${m.tickValue} - skipping P&L recalculation`);else{let v=(o.direction==="BUY"?o.exit_price-o.entry_price:o.entry_price-o.exit_price)/m.tickSize*m.tickValue*o.volume;o.profit_loss=v-(o.commission||0)}}else if(o.assetType==="forex"&&"lotSize"in m&&(o.lotSize=m.lotSize,o.pipValue=m.pipValue,o.pipSize=m.pipSize,o.profit_loss!==void 0&&o.exit_price!==void 0))if(!Number.isFinite(m.pipSize)||m.pipSize<=0)console.warn(`Invalid pipSize for ${o.symbol}: ${m.pipSize} - skipping P&L recalculation`);else if(!Number.isFinite(m.pipValue)||m.pipValue<=0)console.warn(`Invalid pipValue for ${o.symbol}: ${m.pipValue} - skipping P&L recalculation`);else{let v=(o.direction==="BUY"?o.exit_price-o.entry_price:o.entry_price-o.exit_price)/m.pipSize*m.pipValue*o.volume;o.profit_loss=v-(o.commission||0)}}}return o}async checkDuplicate(t){return await this.tradeSyncService.findExistingTradeFileFromCache(t)!==null}async createTradeFile(t){let r=await this.tradeFileGenerator.generateTradeMarkdown(t,t.mt_account_display_name),n=this.tradeFileGenerator.generateTradeFilePath(t),i=n.substring(0,n.lastIndexOf("/"));return await this.tradeFileGenerator.ensureDirectoryExists(i),await this.plugin.app.vault.create(n,r),n}}});var rj,UTe=F(()=>{xy();Yz();rj=class{constructor(t,r){this.plugin=t;this.settingsManager=r}getTemplates(){return this.plugin.settings.csvTemplates||[]}getTemplatesByUsage(){return[...this.getTemplates()].sort((t,r)=>t.last_used&&r.last_used?new Date(r.last_used).getTime()-new Date(t.last_used).getTime():t.last_used?-1:r.last_used?1:r.usage_count-t.usage_count)}getTemplate(t){return this.getTemplates().find(r=>r.id===t)}async createTemplate(t){let r={...t,id:gc(),created_at:new Date().toISOString(),usage_count:0},n=this.getTemplates();return n.push(r),this.plugin.settings.csvTemplates=n,await this.settingsManager.saveSettings(this.plugin.settings),r}async updateTemplate(t,r){let n=this.getTemplates(),i=n.findIndex(o=>o.id===t);if(i===-1)throw new Error(`Template not found: ${t}`);let a={...n[i],...r,id:n[i].id,created_at:n[i].created_at};return n[i]=a,this.plugin.settings.csvTemplates=n,await this.settingsManager.saveSettings(this.plugin.settings),a}async deleteTemplate(t){let r=this.getTemplates(),n=r.filter(i=>i.id!==t);if(n.length===r.length)throw new Error(`Template not found: ${t}`);this.plugin.settings.csvTemplates=n,await this.settingsManager.saveSettings(this.plugin.settings)}async markTemplateAsUsed(t){let r=this.getTemplate(t);r&&await this.updateTemplate(t,{last_used:new Date().toISOString(),usage_count:r.usage_count+1})}templateNameExists(t,r){let n=t.toLowerCase();return this.getTemplates().some(i=>i.name.toLowerCase()===n&&i.id!==r)}async importTemplate(t){let r=dY(t);this.templateNameExists(r.name)&&(r.name=`${r.name} (Imported)`);let n=this.getTemplates();return n.push(r),this.plugin.settings.csvTemplates=n,await this.settingsManager.saveSettings(this.plugin.settings),r}exportTemplate(t){let r=this.getTemplate(t);if(!r)throw new Error(`Template not found: ${t}`);return Gz(r)}}});function nj(e){return e!==null&&OJe.has(e)}var FJe,OJe,HTe=F(()=>{FJe=["IBKR","TRADOVATE","TRADEZERO","TRADINGVIEW","BYBIT","BLOFIN","HYPERLIQUID"],OJe=new Set(FJe)});var Te,os,qTe,VTe=F(()=>{Te=Y(Q()),os=require("obsidian");Ot();qt();As();QI();MSe();FSe();OSe();jSe();BSe();HSe();GSe();KSe();ZSe();rTe();aTe();lTe();dTe();t1();pTe();RTe();UTe();HTe();qTe=(0,Te.memo)(({plugin:e})=>{(0,Te.useEffect)(()=>(JI(),()=>KI()),[]);let[t,r]=(0,Te.useState)("select"),[n,i]=(0,Te.useState)(null),[a,o]=(0,Te.useState)(null),[s,l]=(0,Te.useState)(!1),[c,d]=(0,Te.useState)(null),[u,p]=(0,Te.useState)(null),[m,g]=(0,Te.useState)(null),[f,v]=(0,Te.useState)({}),[h,y]=(0,Te.useState)("stock"),[b,k]=(0,Te.useState)(""),[x,S]=(0,Te.useState)(!1),[w,C]=(0,Te.useState)(null),[D,P]=(0,Te.useState)(0),[M,z]=(0,Te.useState)(null),[A,I]=(0,Te.useState)(null),[L,E]=(0,Te.useState)({}),[T,$]=(0,Te.useState)(!1),_=(0,Te.useMemo)(()=>new ej,[]),B=(0,Te.useMemo)(()=>new tj(e),[e]),W=(0,Te.useMemo)(()=>new rj(e,e.settingsManager),[e]),N=(0,Te.useCallback)(ue=>ue.rows.map(We=>{let Ke={};return ue.headers.forEach((Ze,St)=>{Ke[Ze]=We[St]||""}),Ke}),[]),U=(0,Te.useCallback)(ue=>{i(ue)},[]),j=(0,Te.useCallback)((ue,We)=>{var Ke;if(o(ue),l(We),!We){d(null),E({}),$(!1);let Ze=(Ke=e.settings.csvLastAssetType)==null?void 0:Ke[ue];Ze&&y(Ze)}},[e]),R=(0,Te.useCallback)(ue=>{d(ue),y(ue.asset_type||"stock"),k(ue.date_format||""),E(ue.column_mappings),v(ue.column_mappings),$(!1)},[]),O=(0,Te.useCallback)(async(ue,We)=>{p(ue),S(!0);try{let Ke=await _.parseFile(ue),Ze=_.validate(Ke);if(!Ze.valid){new os.Notice(`CSV validation failed: ${Ze.errors.join(", ")}`),S(!1);return}g(Ke),r("preview"),new os.Notice(`CSV parsed successfully: ${Ke.rowCount} rows`)}catch(Ke){console.error("CSV parsing error:",Ke),new os.Notice("Failed to parse CSV file: "+(Ke instanceof Error?Ke.message:"Unknown error")),p(null)}finally{S(!1)}},[_]),H=(0,Te.useCallback)(()=>{c&&(v(c.column_mappings),y(c.asset_type||"stock")),r("mapping")},[c]),q=(0,Te.useCallback)(ue=>{v(ue)},[]),V=(0,Te.useCallback)(ue=>{if(v(ue),c){let We=JSON.stringify(ue)!==JSON.stringify(L);$(We)}},[c,L]),J=(0,Te.useCallback)(async ue=>{if(y(ue),a&&!s){let We=e.settings.csvLastAssetType||{};We[a]=ue,e.settings.csvLastAssetType=We,await e.settingsManager.saveSettings(e.settings)}},[e,a,s]),K=(0,Te.useCallback)(ue=>{k(ue)},[]),G=(0,Te.useMemo)(()=>{let ue=Object.values(f).filter(Ke=>Ke!=="");return["symbol","entry_time","direction","quantity","entry_price"].every(Ke=>ue.includes(Ke))},[f]),X=(0,Te.useCallback)(()=>{z(null),I(null),S(!1),r("mapping")},[]),te=(0,Te.useCallback)(async()=>{if(!a||!m||!u||!n){new os.Notice("Please complete all required fields");return}S(!0),r("processing");try{let ue,We=N(m),Ke=c?{...c,asset_type:h,column_mappings:f,date_format:b||void 0}:{id:"manual-temp",name:"Manual Import",broker_type:"MANUAL",asset_type:h,column_mappings:f,date_format:b||void 0,has_headers:!0,created_at:new Date().toISOString(),usage_count:0};if(nj(a))ue=await B.importWithBrokerAdapter(n,a,We,h);else if(a==="MANUAL"||s){if(!G){new os.Notice("Please map all required fields before importing"),r("mapping"),S(!1);return}ue=await B.importWithTemplate(n,Ke,We)}else throw new Error("Invalid broker/template selection");if(ue.needsWarning&&ue.warningData){let Ze=ue.warningData,St=async()=>{S(!0),r("processing");try{let Ee=await B.importWithTemplate(n,Ke,We,!0);if(C({success:Ee.success,importedCount:Ee.imported,duplicateCount:Ee.duplicates,errors:[...Ee.errors.map(ge=>({row:0,error:ge})),...Ee.failedRows.map(({row:ge,reason:oe})=>({row:ge,error:oe}))],importedTrades:Ee.importedTrades,accountName:Ee.accountName,brokerType:Ee.brokerType}),r("complete"),Ee.success){let ge=Ee.duplicates>0?`Imported ${Ee.imported} trades, skipped ${Ee.duplicates} duplicates`:`Successfully imported ${Ee.imported} trades!`;new os.Notice(ge)}}catch(Ee){C({success:!1,importedCount:0,duplicateCount:0,errors:[{row:0,error:Ee instanceof Error?Ee.message:"Unknown error occurred"}]}),r("complete"),new os.Notice("Import failed: "+(Ee instanceof Error?Ee.message:"Unknown error"))}finally{S(!1)}};z(Ze),I(()=>St),new Xz({app:e.app,onClose:X,onProceed:async()=>{await St(),z(null),I(null)},missingFields:Ze}).open(),S(!1);return}if(ue.unmappedSymbols&&ue.unmappedSymbols.length>0&&new Zz({app:e.app,plugin:e,symbols:ue.unmappedSymbols,specService:e.specService,onMappingsCreated:St=>{new os.Notice(`Created ${St} symbol mapping${St!==1?"s":""}`)},onSkip:()=>{new os.Notice("Skipped symbol mapping")}}).open(),C({success:ue.success,importedCount:ue.imported,duplicateCount:ue.duplicates,errors:[...ue.errors.map(Ze=>({row:0,error:Ze})),...ue.failedRows.map(({row:Ze,reason:St})=>({row:Ze,error:St}))],importedTrades:ue.importedTrades,accountName:ue.accountName,brokerType:ue.brokerType,unmappedSymbols:ue.unmappedSymbols}),r("complete"),ue.success){let Ze=ue.duplicates>0?`Imported ${ue.imported} trades, skipped ${ue.duplicates} duplicates`:`Successfully imported ${ue.imported} trades!`;new os.Notice(Ze)}else new os.Notice("Import failed: "+(ue.errors.join(", ")||"Unknown error"))}catch(ue){console.error("Import error:",ue),C({success:!1,importedCount:0,duplicateCount:0,errors:[{row:0,error:ue instanceof Error?ue.message:"Unknown error occurred"}]}),r("complete"),new os.Notice("Import failed: "+(ue instanceof Error?ue.message:"Unknown error"))}finally{S(!1)}},[a,m,u,n,c,f,h,B,N,G,s,e.app,X]),re=(0,Te.useCallback)((ue,We)=>{new os.Notice(`Template saved. You can now select "${We}" for future imports.`),P(Ke=>Ke+1)},[]),Z=(0,Te.useCallback)(async()=>{if(!(!c||!T))try{await W.updateTemplate(c.id,{column_mappings:f,asset_type:h}),new os.Notice(`Template "${c.name}" updated successfully`),E(f),$(!1),d({...c,column_mappings:f,asset_type:h})}catch(ue){console.error("Failed to update template:",ue),new os.Notice("Failed to update template: "+(ue instanceof Error?ue.message:"Unknown error"))}},[c,T,f,h,W]),ne=(0,Te.useCallback)(()=>{new Vz({app:e.app,columnMappings:f,assetType:h,dateFormat:b,onSave:re,onCancel:()=>{},localTemplateService:W}).open()},[e.app,f,h,b,re,W]),se=(0,Te.useCallback)(ue=>{P(We=>We+1),new os.Notice(`Template "${ue}" imported successfully`)},[]),ee=(0,Te.useCallback)(()=>{new Jz({app:e.app,localTemplateService:W,onClose:()=>{},onImportSuccess:se}).open()},[e.app,W,se]),ie=(0,Te.useCallback)(async()=>{if(c)try{await W.deleteTemplate(c.id),new os.Notice(`Template "${c.name}" deleted`),o(null),d(null),P(ue=>ue+1)}catch(ue){throw new os.Notice("Failed to delete template: "+(ue instanceof Error?ue.message:"Unknown error")),ue}},[c,W]),ve=(0,Te.useCallback)(()=>{c&&new Kz({app:e.app,template:c,onClose:()=>{}}).open()},[c,e.app]),Se=(0,Te.useCallback)(async()=>{if(!c)return;new Qz({app:e.app,template:c,onConfirm:ie,onCancel:()=>{}}).open()},[c,e.app,ie]),Me=(0,Te.useCallback)(async()=>{A&&await A(),z(null),I(null)},[A]),le=(0,Te.useCallback)(()=>{r("select"),p(null),g(null),o(null),l(!1),d(null),v({}),y("stock"),C(null),E({}),$(!1)},[]),Ye=(0,Te.useMemo)(()=>n&&a,[n,a]);return Te.default.createElement("div",{className:"journalit-csv-import"},Te.default.createElement("div",{className:"csv-import-header"},Te.default.createElement("h2",null,"Import Trades from CSV"),Te.default.createElement("p",null,"Upload your broker's CSV file to import trades into your journal.")),Te.default.createElement("div",{className:"csv-import-content"},t!=="complete"&&t!=="mapping"&&Te.default.createElement("div",{className:"csv-selection-section"},Te.default.createElement(ISe,{plugin:e,selectedAccountName:n,onAccountSelect:U}),n&&Te.default.createElement(Te.default.Fragment,null,Te.default.createElement(NSe,{plugin:e,selectedValue:a,onSelect:j,onTemplateLoad:R,localTemplateService:W,refreshTrigger:D}),a&&a.startsWith("template-")&&c&&Te.default.createElement("div",{className:"csv-template-actions",style:{marginTop:"12px",display:"flex",gap:"8px"}},Te.default.createElement("button",{className:"csv-button csv-button-secondary",onClick:ve},"Export Template"),Te.default.createElement("button",{className:"csv-button csv-button-secondary",onClick:Se,style:{color:"var(--text-error)"}},"Delete Template")),Te.default.createElement("div",{className:"csv-template-actions",style:{marginTop:"12px"}},Te.default.createElement("button",{className:"csv-button csv-button-secondary",onClick:ee},"Import Template")))),Ye&&t==="select"&&Te.default.createElement("div",{className:"csv-upload-section"},a&&nj(a)&&Te.default.createElement("div",{className:"csv-broker-guide-inline"},Te.default.createElement(my,{title:"How to Export from Your Broker",defaultOpen:!1,className:"broker-guide-inline"},Te.default.createElement(lY,{brokerType:a}))),Te.default.createElement(zSe,{onFileSelect:O,disabled:x})),x&&t!=="processing"&&Te.default.createElement("div",{className:"csv-loading"},Te.default.createElement("div",{className:"csv-spinner"}),Te.default.createElement("span",null,"Processing CSV file...")),m&&t==="preview"&&Te.default.createElement("div",{className:"csv-preview-section"},Te.default.createElement(_Se,{data:m,maxRows:10}),c&&Te.default.createElement("div",{style:{marginTop:"16px",padding:"12px",backgroundColor:"var(--background-secondary)",borderRadius:"4px"}},Te.default.createElement("span",{style:{color:"var(--text-muted)",fontSize:"0.9em"}},"Import Format: "),Te.default.createElement("strong",null,c.name)),a==="TRADINGVIEW"&&Te.default.createElement("div",{className:"asset-type-selector"},Te.default.createElement("h3",null,"Asset Type ",Te.default.createElement("span",{className:"csv-required"},"*")),Te.default.createElement("p",{className:"csv-helper-text"},"Select the type of instrument in this CSV. This determines contract specifications and validation rules."),Te.default.createElement("div",{className:"asset-type-buttons"},Te.default.createElement("button",{className:`asset-type-button ${h==="stock"?"active":""}`,onClick:()=>J("stock")},"Stock"),Te.default.createElement("button",{className:`asset-type-button ${h==="options"?"active":""}`,onClick:()=>J("options")},"Options"),Te.default.createElement("button",{className:`asset-type-button ${h==="futures"?"active":""}`,onClick:()=>J("futures")},"Futures"),Te.default.createElement("button",{className:`asset-type-button ${h==="forex"?"active":""}`,onClick:()=>J("forex")},"Forex"),Te.default.createElement("button",{className:`asset-type-button ${h==="crypto"?"active":""}`,onClick:()=>J("crypto")},"Crypto"))),Te.default.createElement("div",{className:"csv-import-actions",style:{display:"flex",gap:"12px",marginTop:"24px"}},nj(a)?Te.default.createElement("button",{className:"csv-button csv-button-primary",onClick:te,disabled:x},x?"Processing...":`Import ${m.rowCount} Rows`):c&&G?Te.default.createElement(Te.default.Fragment,null,Te.default.createElement("button",{className:"csv-button csv-button-secondary",onClick:H},"Edit Format"),Te.default.createElement("button",{className:"csv-button csv-button-primary",onClick:te,disabled:x},x?"Processing...":`Import ${m.rowCount} Rows`)):Te.default.createElement("button",{className:"csv-button csv-button-primary",onClick:H},"Continue to Column Mapping"),Te.default.createElement("button",{className:"csv-button csv-button-secondary",onClick:le,disabled:x},"Cancel"))),m&&t==="mapping"&&Te.default.createElement("div",{className:"csv-mapping-section"},Te.default.createElement(VSe,{csvHeaders:m.headers,sampleRows:m.rows,onMappingsSuggested:q,disabled:x}),Te.default.createElement(USe,{csvHeaders:m.headers,initialMappings:f,initialAssetType:h,initialDateFormat:b,onMappingsChange:V,onAssetTypeChange:J,onDateFormatChange:K,sampleRows:m.rows}),Te.default.createElement("div",{className:"csv-import-actions",style:{display:"flex",gap:"12px",marginTop:"24px"}},Te.default.createElement("button",{className:"csv-button csv-button-primary",onClick:te,disabled:x||!G},x?"Processing...":`Import ${m.rowCount} Rows`),c&&T&&G?Te.default.createElement("button",{className:"csv-button csv-button-secondary",onClick:Z,disabled:x},"Update Template"):!c&&G?Te.default.createElement("button",{className:"csv-button csv-button-secondary",onClick:ne,disabled:x},"Save as Template"):null,Te.default.createElement("button",{className:"csv-button csv-button-secondary",onClick:()=>r("preview"),disabled:x},"Back"))),t==="processing"&&Te.default.createElement("div",{className:"csv-loading"},Te.default.createElement("div",{className:"csv-spinner"}),Te.default.createElement("span",null,"Importing trades to account...")),t==="complete"&&w&&Te.default.createElement("div",{className:"csv-import-results"},Te.default.createElement("h3",null,w.success?"Import Complete":"Import Failed"),w.importedCount>0&&Te.default.createElement("div",{className:"result-item result-success"},Te.default.createElement(Gg,{className:"result-icon",size:20}),Te.default.createElement("span",{className:"result-text"},"Successfully imported ",w.importedCount," trade",w.importedCount!==1?"s":""," to Account: ",Te.default.createElement("strong",null,w.accountName||n))),w.duplicateCount>0&&Te.default.createElement("div",{className:"result-item result-warning"},Te.default.createElement(oa,{className:"result-icon",size:20}),Te.default.createElement("span",{className:"result-text"},"Skipped ",w.duplicateCount," duplicate trade",w.duplicateCount!==1?"s":""," (already in vault)")),w.success&&w.brokerType&&Te.default.createElement("div",{className:"result-item result-info"},Te.default.createElement("span",{className:"result-text",style:{fontSize:"13px",opacity:.8}},"Broker: ",w.brokerType)),w.importedTrades&&w.importedTrades.length>0&&Te.default.createElement("div",{className:"imported-trades-preview"},Te.default.createElement("div",{className:"preview-header"},"Recently Imported Trades (showing ",Math.min(5,w.importedTrades.length)," of ",w.importedCount,")"),Te.default.createElement("div",{className:"csv-trades-list"},w.importedTrades.map((ue,We)=>{var Ee,ge,oe,me,Ce,et,lt,mt;let Ke=(oe=(ge=(Ee=e==null?void 0:e.settings)==null?void 0:Ee.trade)==null?void 0:ge.displayRMultiples)!=null?oe:!1,Ze=(Ce=(me=e==null?void 0:e.settings)==null?void 0:me.trade)==null?void 0:Ce.defaultRiskAmount,St=(mt=(lt=(et=e==null?void 0:e.settings)==null?void 0:et.general)==null?void 0:lt.currency)!=null?mt:"USD";return Te.default.createElement("div",{key:We,className:"csv-trade-preview-item",onClick:async()=>{try{if(!ue.filePath||ue.filePath.trim()===""){console.error("Cannot navigate to trade: No valid file path found",ue);return}e&&e.openFile?await e.openFile(ue.filePath,!1):e!=null&&e.app?await e.app.workspace.openLinkText(ue.filePath,"",!1):console.error("Cannot navigate to trade: Plugin context not available")}catch(cn){console.error("Error navigating to trade:",cn,{path:ue.filePath,trade:ue})}}},Te.default.createElement("span",{className:"csv-trade-symbol"},ue.symbol),Te.default.createElement("span",{className:"csv-trade-date"},new Date(ue.entryTime).toLocaleDateString()),Te.default.createElement("span",{className:`csv-trade-direction ${ue.direction}`},ue.direction==="long"?Te.default.createElement($c,{size:14}):Te.default.createElement(Qv,{size:14}),ue.direction.toUpperCase()),Te.default.createElement("span",{className:"csv-trade-quantity"},ue.quantity," @ ",sa(ue.entryPrice,!1,St)),Te.default.createElement("span",{className:`csv-trade-status ${ue.status.toLowerCase()}`},ue.profitLoss!==void 0&&ue.profitLoss!==0?ye(ue.profitLoss,!0,St,Ke,Ke?ue.profitLoss/(Ze||1):void 0):ue.status))}),w.importedCount>5&&Te.default.createElement("div",{className:"trade-preview-more"},"and ",w.importedCount-5," more trade",w.importedCount-5!==1?"s":"","..."))),w.errors.length>0&&Te.default.createElement("div",{className:"import-results-errors"},Te.default.createElement("div",{className:"error-header"},"Errors (",w.errors.length,")"),Te.default.createElement("div",{className:"error-list"},w.errors.map((ue,We)=>Te.default.createElement("div",{key:We,className:"error-item"},ue.row>0?`Row ${ue.row}: `:"",ue.error)))),Te.default.createElement("div",{className:"csv-actions"},w.accountName&&Te.default.createElement("button",{className:"csv-button csv-button-primary",onClick:async()=>{await e.viewManager.openAccountPageView(w.accountName)}},"View in Account"),Te.default.createElement("button",{className:"csv-button csv-button-secondary",onClick:le},"Import Another File")))))})});var GTe,bp,ij,YTe=F(()=>{GTe=Y(Q());ch();VTe();QI();bp="journalit-csv-import-view",ij=class extends nl{constructor(t,r){super(t,{containerClass:"journalit-csv-import-view-container",rootId:"journalit-csv-import-view"}),this.plugin=r}getViewType(){return bp}getDisplayText(){return"CSV Import"}getIcon(){return"import"}async onOpen(){this.containerEl.addClass("react-view-container");try{await super.onOpen(),JI(),this.containerEl.addClass("journalit-csv-import-container")}catch(t){console.error("[CSVImportView] Failed to initialize:",t)}}getRenderFunction(){return()=>GTe.default.createElement(qTe,{plugin:this.plugin})}}});var pt,nc,ax,KTe,JTe,QTe=F(()=>{pt=Y(Q()),nc=require("obsidian");bf();Hp();Tr();ax=({title:e,isExpanded:t,onToggle:r,onAdd:n,children:i,disabled:a,disabledMessage:o})=>pt.default.createElement("div",{style:{marginBottom:"4px"}},pt.default.createElement("div",{onClick:r,style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",cursor:"pointer",userSelect:"none",color:"var(--text-muted)",fontSize:"11px",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.05em"}},pt.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"6px"}},pt.default.createElement("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{transform:t?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.15s ease"}},pt.default.createElement("polyline",{points:"9 18 15 12 9 6"})),e),n&&!a&&pt.default.createElement(pn,{content:`New ${e}`},pt.default.createElement("button",{onClick:s=>{s.stopPropagation(),n()},style:{background:"transparent",border:"none",cursor:"pointer",padding:"2px",color:"var(--text-muted)",display:"flex",alignItems:"center",justifyContent:"center"}},pt.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},pt.default.createElement("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),pt.default.createElement("line",{x1:"5",y1:"12",x2:"19",y2:"12"}))))),t&&pt.default.createElement("div",{style:{paddingLeft:"8px",paddingRight:"8px"}},a?pt.default.createElement("div",{style:{padding:"12px",color:"var(--text-muted)",fontSize:"12px",fontStyle:"italic"}},o||"Coming soon"):i)),KTe=({template:e,isSelected:t,isDefault:r,onClick:n,onSetDefault:i,onDuplicate:a,onDelete:o})=>pt.default.createElement("div",{onClick:n,className:`sidebar-template-item ${t?"sidebar-template-item--selected":""}`,style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"6px 8px",marginBottom:"2px",borderRadius:"var(--radius-s)",cursor:"pointer",background:t?"var(--interactive-accent)":"transparent",color:t?"var(--text-on-accent)":"var(--text-normal)"}},pt.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"6px",flex:1,minWidth:0}},pt.default.createElement(pn,{content:r?"Default template":"Set as default"},pt.default.createElement("span",{onClick:s=>{s.stopPropagation(),r||i()},style:{cursor:r?"default":"pointer",color:r?t?"var(--text-on-accent)":"var(--interactive-accent)":t?"var(--text-on-accent)":"var(--text-faint)",display:"flex",flexShrink:0,lineHeight:0}},pt.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:r?"currentColor":"none",stroke:"currentColor",strokeWidth:"2"},pt.default.createElement("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})))),pt.default.createElement("span",{style:{fontSize:"13px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},e.name),e.isBuiltIn&&pt.default.createElement("span",{style:{fontSize:"9px",padding:"1px 4px",background:t?"rgba(255,255,255,0.2)":"var(--background-modifier-border)",borderRadius:"3px",flexShrink:0}},"Built-in")),pt.default.createElement("div",{style:{display:"flex",gap:"2px",opacity:t?1:0,transition:"opacity 0.1s"},className:"template-item-actions"},pt.default.createElement(pn,{content:"Duplicate"},pt.default.createElement("button",{onClick:s=>{s.stopPropagation(),a()},style:{background:"transparent",border:"none",cursor:"pointer",padding:"2px",color:"inherit",opacity:.7}},pt.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},pt.default.createElement("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2"}),pt.default.createElement("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})))),!e.isBuiltIn&&pt.default.createElement(pn,{content:"Delete"},pt.default.createElement("button",{onClick:s=>{s.stopPropagation(),o()},style:{background:"transparent",border:"none",cursor:"pointer",padding:"2px",color:"var(--text-error)",opacity:.7}},pt.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},pt.default.createElement("polyline",{points:"3 6 5 6 21 6"}),pt.default.createElement("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})))))),JTe=({plugin:e,templateService:t,selection:r,onSelectionChange:n,onTemplatesChange:i,refreshKey:a})=>{var $,_,B,W,N,U;let[o,s]=(0,pt.useState)({trade:!0,drc:!0,weekly:!0,monthly:!0,quarterly:!0,yearly:!0,library:!0}),[l,c]=(0,pt.useState)([]),[d,u]=(0,pt.useState)([]),[p,m]=(0,pt.useState)([]),[g,f]=(0,pt.useState)([]),[v,h]=(0,pt.useState)([]),[y,b]=(0,pt.useState)([]),k=pt.default.useMemo(()=>new il(e),[e]),[x,S]=(0,pt.useState)({trade:(($=e.settings.templates)==null?void 0:$.defaultTrade)||null,drc:((_=e.settings.templates)==null?void 0:_.defaultDrc)||null,weekly:((B=e.settings.templates)==null?void 0:B.defaultWeekly)||null,monthly:((W=e.settings.templates)==null?void 0:W.defaultMonthly)||null,quarterly:((N=e.settings.templates)==null?void 0:N.defaultQuarterly)||null,yearly:((U=e.settings.templates)==null?void 0:U.defaultYearly)||null}),w=(0,pt.useCallback)(()=>{c(k.getTemplates()),u(t.getTemplates("drc")),m(t.getTemplates("weekly")),f(t.getTemplates("monthly")),h(t.getTemplates("quarterly")),b(t.getTemplates("yearly"))},[t,k]);(0,pt.useEffect)(()=>{w()},[w,a]),(0,pt.useEffect)(()=>{let j=R=>{S(O=>({...O,[R.type]:R.value}))};return xe.subscribe("default-template:changed",j)},[]),(0,pt.useEffect)(()=>{let j=xe.subscribe("review-template:changed",w),R=xe.subscribe("trade-template:changed",w);return()=>{j(),R()}},[w]);let C=j=>{s(R=>({...R,[j]:!R[j]}))},D=async j=>{try{let R=await t.createTemplate({name:`New ${j.toUpperCase()} Template`,type:j,isBuiltIn:!1,widgets:[{type:"header",locked:!0}]});w(),n({type:"template",id:R.id,templateType:j}),i==null||i(),new nc.Notice("Template created")}catch(R){console.error("Failed to create template:",R),new nc.Notice("Failed to create template")}},P=async(j,R)=>{let H={drc:"defaultDrc",weekly:"defaultWeekly",monthly:"defaultMonthly",quarterly:"defaultQuarterly",yearly:"defaultYearly"}[R];e.settings.templates||(e.settings.templates={defaultTrade:"builtin-trade-standard",defaultDrc:"builtin-drc-standard",defaultWeekly:"builtin-weekly-standard",defaultMonthly:"builtin-monthly-standard",defaultQuarterly:"builtin-quarterly-standard",defaultYearly:"builtin-yearly-standard"}),e.settings.templates[H]=j,await e.saveSettings(),S(q=>({...q,[R]:j})),xe.publish("default-template:changed",{type:R,value:j}),new nc.Notice("Default template updated")},M=async j=>{e.settings.templates||(e.settings.templates={defaultTrade:"builtin-trade-standard",defaultDrc:"builtin-drc-standard",defaultWeekly:"builtin-weekly-standard",defaultMonthly:"builtin-monthly-standard",defaultQuarterly:"builtin-quarterly-standard",defaultYearly:"builtin-yearly-standard"}),e.settings.templates.defaultTrade=j,await e.saveSettings(),S(R=>({...R,trade:j})),xe.publish("default-template:changed",{type:"trade",value:j}),new nc.Notice("Default trade template updated")},z=async(j,R)=>{let q={drc:d,weekly:p,monthly:g,quarterly:v,yearly:y}[R].find(V=>V.id===j);if(q)try{let V=await t.duplicateTemplate(j,`${q.name} (Copy)`);w(),n({type:"template",id:V.id,templateType:R}),i==null||i(),new nc.Notice("Template duplicated")}catch(V){console.error("Failed to duplicate template:",V),new nc.Notice("Failed to duplicate template")}},A=async j=>{let R=l.find(O=>O.id===j);if(R)try{let O=await k.duplicateTemplate(j,`${R.name} (Copy)`);w(),n({type:"template",id:O.id,templateType:"trade"}),i==null||i(),new nc.Notice("Trade template duplicated")}catch(O){console.error("Failed to duplicate trade template:",O),new nc.Notice("Failed to duplicate template")}},I=async(j,R)=>{let q={drc:d,weekly:p,monthly:g,quarterly:v,yearly:y}[R].find(V=>V.id===j);if(!q||q.isBuiltIn){new nc.Notice("Cannot delete built-in templates");return}try{await t.deleteTemplate(j),w(),(r==null?void 0:r.id)===j&&n(null),i==null||i(),new nc.Notice("Template deleted")}catch(V){console.error("Failed to delete template:",V),new nc.Notice("Failed to delete template")}},L=async j=>{let R=l.find(O=>O.id===j);if(!R||R.isBuiltIn){new nc.Notice("Cannot delete built-in templates");return}try{await k.deleteTemplate(j),w(),(r==null?void 0:r.id)===j&&n(null),i==null||i(),new nc.Notice("Trade template deleted")}catch(O){console.error("Failed to delete trade template:",O),new nc.Notice("Failed to delete template")}},E=(j,R)=>{if(j.length===0)return pt.default.createElement("div",{style:{padding:"8px",color:"var(--text-muted)",fontSize:"12px"}},"No templates yet");let O=j.find(H=>H.isBuiltIn);return j.map(H=>{let q=x[R]?x[R]===H.id:H.id===(O==null?void 0:O.id);return pt.default.createElement(KTe,{key:H.id,template:H,isSelected:(r==null?void 0:r.type)==="template"&&r.id===H.id,isDefault:q,onClick:()=>n({type:"template",id:H.id,templateType:R}),onSetDefault:()=>P(H.id,R),onDuplicate:()=>z(H.id,R),onDelete:()=>I(H.id,R)})})},T=()=>{if(l.length===0)return pt.default.createElement("div",{style:{padding:"8px",color:"var(--text-muted)",fontSize:"12px"}},"No templates yet");let j=l.find(R=>R.isBuiltIn);return l.map(R=>{let O=x.trade?x.trade===R.id:R.id===(j==null?void 0:j.id);return pt.default.createElement(KTe,{key:R.id,template:R,isSelected:(r==null?void 0:r.type)==="template"&&r.id===R.id,isDefault:O,onClick:()=>n({type:"template",id:R.id,templateType:"trade"}),onSetDefault:()=>M(R.id),onDuplicate:()=>A(R.id),onDelete:()=>L(R.id)})})};return pt.default.createElement("div",{style:{width:"240px",flexShrink:0,background:"var(--background-secondary)",borderRight:"1px solid var(--background-modifier-border)",display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"}},pt.default.createElement("div",{style:{height:"53px",padding:"0 16px",borderBottom:"1px solid var(--background-modifier-border)",display:"flex",alignItems:"center",flexShrink:0}},pt.default.createElement("h3",{style:{margin:0,fontSize:"14px",fontWeight:600}},"Layout Builder")),pt.default.createElement("div",{style:{flex:1,overflowY:"auto",padding:"8px 0"}},pt.default.createElement(ax,{title:"Trade",isExpanded:o.trade,onToggle:()=>C("trade")},T()),pt.default.createElement(ax,{title:"DRC",isExpanded:o.drc,onToggle:()=>C("drc"),onAdd:()=>D("drc")},E(d,"drc")),pt.default.createElement(ax,{title:"Weekly",isExpanded:o.weekly,onToggle:()=>C("weekly"),onAdd:()=>D("weekly")},E(p,"weekly")),pt.default.createElement(ax,{title:"Monthly",isExpanded:o.monthly,onToggle:()=>C("monthly"),onAdd:()=>D("monthly")},E(g,"monthly")),pt.default.createElement(ax,{title:"Quarterly",isExpanded:o.quarterly,onToggle:()=>C("quarterly"),onAdd:()=>D("quarterly")},E(v,"quarterly")),pt.default.createElement(ax,{title:"Yearly",isExpanded:o.yearly,onToggle:()=>C("yearly"),onAdd:()=>D("yearly")},E(y,"yearly")),pt.default.createElement("div",{style:{height:"1px",background:"var(--background-modifier-border)",margin:"8px 12px"}}),pt.default.createElement(ax,{title:"Library",isExpanded:o.library,onToggle:()=>C("library")},pt.default.createElement("div",{style:{padding:"4px 0"}},pt.default.createElement("button",{onClick:()=>n({type:"library",id:"share"}),style:{display:"flex",alignItems:"center",gap:"8px",padding:"8px 12px",background:(r==null?void 0:r.type)==="library"?"var(--interactive-accent)":"var(--background-primary)",color:(r==null?void 0:r.type)==="library"?"var(--text-on-accent)":"var(--text-normal)",border:"1px solid var(--background-modifier-border)",borderRadius:"var(--radius-s)",cursor:"pointer",fontSize:"13px",width:"100%",textAlign:"left"}},pt.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},pt.default.createElement("circle",{cx:"18",cy:"5",r:"3"}),pt.default.createElement("circle",{cx:"6",cy:"12",r:"3"}),pt.default.createElement("circle",{cx:"18",cy:"19",r:"3"}),pt.default.createElement("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),pt.default.createElement("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})),"Share Template")))),pt.default.createElement("style",null,`
        .sidebar-template-item:not(.sidebar-template-item--selected):hover {
          background: var(--background-modifier-hover) !important;
        }
        .template-item-actions {
          opacity: 0 !important;
        }
        div:hover > .template-item-actions {
          opacity: 1 !important;
        }
      `))}});function SY({options:e,value:t,onChange:r,size:n="medium",fullWidth:i=!1,className:a=""}){let s={small:{padding:"4px 10px",fontSize:"12px",gap:"2px",containerPadding:"2px",borderRadius:"6px"},medium:{padding:"6px 14px",fontSize:"13px",gap:"2px",containerPadding:"3px",borderRadius:"8px"},large:{padding:"8px 18px",fontSize:"14px",gap:"3px",containerPadding:"4px",borderRadius:"10px"}}[n];return kY.default.createElement("div",{className:`segmented-control ${a}`,style:{display:"inline-flex",alignItems:"center",gap:s.gap,padding:s.containerPadding,background:"var(--background-secondary)",borderRadius:s.borderRadius,border:"1px solid var(--background-modifier-border)",width:i?"100%":"auto"}},e.map(l=>{let c=l.value===t;return kY.default.createElement("button",{key:l.value,onClick:()=>r(l.value),className:`segmented-control-option ${c?"is-active":""}`,style:{flex:i?1:"none",padding:s.padding,fontSize:s.fontSize,fontWeight:500,border:"none",borderRadius:`calc(${s.borderRadius} - 2px)`,cursor:"pointer",transition:"all 0.15s ease",background:c?"var(--background-primary)":"transparent",color:c?"var(--text-normal)":"var(--text-muted)",boxShadow:c?"0 1px 3px rgba(0, 0, 0, 0.1)":"none"}},l.label)}))}var kY,XTe=F(()=>{kY=Y(Q());SY.displayName="SegmentedControl"});var zJe,wu,xp,jJe,i1e,_Je,BJe,WJe,$Je,TY,RJe,UJe,HJe,qJe,VJe,GJe,YJe,KJe,JJe,QJe,ZTe,e1e,t1e,r1e,n1e,XJe,ZJe,eQe,tQe,rQe,nQe,iQe,aQe,oQe,sQe,lQe,CY,a1e=F(()=>{zJe=[{id:"mock-daily-1",instrument:"META",ticker:"META",direction:"short",side:"short",entryPrice:375,exitPrice:370.25,positionSize:40,pnl:190,entryTime:new Date("2025-01-15T11:30:00"),exitTime:new Date("2025-01-15T14:00:00"),setup:["Reversal","Resistance Rejection"],account:"Main Account",tradeStatus:"CLOSED",rMultiple:1.3,riskAmount:150,stopLoss:378.75,images:[]},{id:"mock-daily-2",instrument:"AMZN",ticker:"AMZN",direction:"long",side:"long",entryPrice:155.5,exitPrice:154,positionSize:80,pnl:-120,entryTime:new Date("2025-01-15T09:40:00"),exitTime:new Date("2025-01-15T10:25:00"),setup:["Gap Up"],account:"Main Account",tradeStatus:"CLOSED",rMultiple:-.6,riskAmount:200,stopLoss:153,images:[]},{id:"mock-daily-3",instrument:"SPY",ticker:"SPY",direction:"long",side:"long",entryPrice:473.5,exitPrice:475.2,positionSize:100,pnl:170,entryTime:new Date("2025-01-15T13:15:00"),exitTime:new Date("2025-01-15T15:45:00"),setup:["Trend Continuation"],account:"Main Account",tradeStatus:"CLOSED",rMultiple:.85,riskAmount:200,stopLoss:471.5,images:[]}],wu=[{id:"mock-trade-1",instrument:"AAPL",ticker:"AAPL",direction:"long",side:"long",entryPrice:178.5,exitPrice:182.3,positionSize:100,pnl:380,entryTime:new Date("2025-01-13T09:35:00"),exitTime:new Date("2025-01-13T11:20:00"),setup:["Breakout","Gap Up"],account:"Main Account",tradeStatus:"CLOSED",rMultiple:1.9,riskAmount:200,stopLoss:176.5,images:[]},{id:"mock-trade-2",instrument:"TSLA",ticker:"TSLA",direction:"short",side:"short",entryPrice:245,exitPrice:248.5,positionSize:50,pnl:-175,entryTime:new Date("2025-01-13T13:45:00"),exitTime:new Date("2025-01-13T14:30:00"),setup:["Reversal"],account:"Main Account",tradeStatus:"CLOSED",rMultiple:-.7,riskAmount:250,stopLoss:247.5,images:[]},{id:"mock-trade-3",instrument:"SPY",ticker:"SPY",direction:"long",side:"long",entryPrice:472.25,exitPrice:475.8,positionSize:200,pnl:710,entryTime:new Date("2025-01-14T10:00:00"),exitTime:new Date("2025-01-14T15:30:00"),setup:["Trend Continuation"],account:"Main Account",tradeStatus:"CLOSED",rMultiple:2.4,riskAmount:300,stopLoss:470.75,images:[]},{id:"mock-trade-4",instrument:"NVDA",ticker:"NVDA",direction:"long",side:"long",entryPrice:485,exitPrice:492.5,positionSize:30,pnl:225,entryTime:new Date("2025-01-14T09:45:00"),exitTime:new Date("2025-01-14T12:15:00"),setup:["Breakout"],account:"Secondary",tradeStatus:"CLOSED",rMultiple:1.5,riskAmount:150,stopLoss:480,images:[]},{id:"mock-trade-5",instrument:"META",ticker:"META",direction:"short",side:"short",entryPrice:375,exitPrice:370.25,positionSize:40,pnl:190,entryTime:new Date("2025-01-15T11:30:00"),exitTime:new Date("2025-01-15T14:00:00"),setup:["Reversal","Resistance Rejection"],account:"Main Account",tradeStatus:"CLOSED",rMultiple:1.3,riskAmount:150,stopLoss:378.75,images:[]},{id:"mock-trade-6",instrument:"AMZN",ticker:"AMZN",direction:"long",side:"long",entryPrice:155.5,exitPrice:154,positionSize:80,pnl:-120,entryTime:new Date("2025-01-15T09:40:00"),exitTime:new Date("2025-01-15T10:25:00"),setup:["Gap Up"],account:"Main Account",tradeStatus:"CLOSED",rMultiple:-.6,riskAmount:200,stopLoss:153,images:[]},{id:"mock-trade-7",instrument:"GOOGL",ticker:"GOOGL",direction:"long",side:"long",entryPrice:142,exitPrice:145.5,positionSize:100,pnl:350,entryTime:new Date("2025-01-16T10:15:00"),exitTime:new Date("2025-01-16T14:45:00"),setup:["Trend Continuation"],account:"Main Account",tradeStatus:"CLOSED",rMultiple:1.75,riskAmount:200,stopLoss:140,images:[]},{id:"mock-trade-8",instrument:"MSFT",ticker:"MSFT",direction:"long",side:"long",entryPrice:390,exitPrice:388.5,positionSize:50,pnl:-75,entryTime:new Date("2025-01-17T09:30:00"),exitTime:new Date("2025-01-17T10:00:00"),setup:["Breakout"],account:"Secondary",tradeStatus:"CLOSED",rMultiple:-.5,riskAmount:150,stopLoss:387,images:[]}],xp=[{id:"mock-monthly-w1-1",instrument:"AAPL",ticker:"AAPL",direction:"long",side:"long",entryPrice:182,exitPrice:185.5,positionSize:100,pnl:350,entryTime:new Date("2025-01-06T10:15:00"),exitTime:new Date("2025-01-06T14:30:00"),setup:["Breakout"],account:"Main Account",tradeStatus:"CLOSED",rMultiple:1.75,riskAmount:200,stopLoss:180,images:[]},{id:"mock-monthly-w1-2",instrument:"TSLA",ticker:"TSLA",direction:"short",side:"short",entryPrice:252,exitPrice:248.5,positionSize:50,pnl:175,entryTime:new Date("2025-01-07T09:45:00"),exitTime:new Date("2025-01-07T11:30:00"),setup:["Reversal"],account:"Main Account",tradeStatus:"CLOSED",rMultiple:1.17,riskAmount:150,stopLoss:255,images:[]},{id:"mock-monthly-w1-3",instrument:"SPY",ticker:"SPY",direction:"long",side:"long",entryPrice:470,exitPrice:468.5,positionSize:150,pnl:-225,entryTime:new Date("2025-01-08T10:00:00"),exitTime:new Date("2025-01-08T11:15:00"),setup:["Support Bounce"],account:"Main Account",tradeStatus:"CLOSED",rMultiple:-.9,riskAmount:250,stopLoss:468.5,images:[]},{id:"mock-monthly-w1-4",instrument:"NVDA",ticker:"NVDA",direction:"long",side:"long",entryPrice:478,exitPrice:485,positionSize:40,pnl:280,entryTime:new Date("2025-01-09T09:35:00"),exitTime:new Date("2025-01-09T13:45:00"),setup:["Trend Continuation"],account:"Main Account",tradeStatus:"CLOSED",rMultiple:1.4,riskAmount:200,stopLoss:473,images:[]},{id:"mock-monthly-w1-5",instrument:"AMD",ticker:"AMD",direction:"long",side:"long",entryPrice:138,exitPrice:141.5,positionSize:80,pnl:280,entryTime:new Date("2025-01-10T11:00:00"),exitTime:new Date("2025-01-10T15:00:00"),setup:["Breakout"],account:"Secondary",tradeStatus:"CLOSED",rMultiple:1.4,riskAmount:200,stopLoss:136,images:[]},{id:"mock-monthly-w2-1",instrument:"AAPL",ticker:"AAPL",direction:"long",side:"long",entryPrice:178.5,exitPrice:182.3,positionSize:100,pnl:380,entryTime:new Date("2025-01-13T09:35:00"),exitTime:new Date("2025-01-13T11:20:00"),setup:["Breakout","Gap Up"],account:"Main Account",tradeStatus:"CLOSED",rMultiple:1.9,riskAmount:200,stopLoss:176.5,images:[]},{id:"mock-monthly-w2-2",instrument:"TSLA",ticker:"TSLA",direction:"short",side:"short",entryPrice:245,exitPrice:248.5,positionSize:50,pnl:-175,entryTime:new Date("2025-01-13T13:45:00"),exitTime:new Date("2025-01-13T14:30:00"),setup:["Reversal"],account:"Main Account",tradeStatus:"CLOSED",rMultiple:-.7,riskAmount:250,stopLoss:247.5,images:[]},{id:"mock-monthly-w2-3",instrument:"SPY",ticker:"SPY",direction:"long",side:"long",entryPrice:472.25,exitPrice:475.8,positionSize:200,pnl:710,entryTime:new Date("2025-01-14T10:00:00"),exitTime:new Date("2025-01-14T15:30:00"),setup:["Trend Continuation"],account:"Main Account",tradeStatus:"CLOSED",rMultiple:2.4,riskAmount:300,stopLoss:470.75,images:[]},{id:"mock-monthly-w2-4",instrument:"NVDA",ticker:"NVDA",direction:"long",side:"long",entryPrice:485,exitPrice:492.5,positionSize:30,pnl:225,entryTime:new Date("2025-01-14T09:45:00"),exitTime:new Date("2025-01-14T12:15:00"),setup:["Breakout"],account:"Secondary",tradeStatus:"CLOSED",rMultiple:1.5,riskAmount:150,stopLoss:480,images:[]},{id:"mock-monthly-w2-5",instrument:"META",ticker:"META",direction:"short",side:"short",entryPrice:375,exitPrice:370.25,positionSize:40,pnl:190,entryTime:new Date("2025-01-15T11:30:00"),exitTime:new Date("2025-01-15T14:00:00"),setup:["Reversal","Resistance Rejection"],account:"Main Account",tradeStatus:"CLOSED",rMultiple:1.3,riskAmount:150,stopLoss:378.75,images:[]},{id:"mock-monthly-w2-6",instrument:"GOOGL",ticker:"GOOGL",direction:"long",side:"long",entryPrice:142,exitPrice:145.5,positionSize:100,pnl:350,entryTime:new Date("2025-01-16T10:15:00"),exitTime:new Date("2025-01-16T14:45:00"),setup:["Trend Continuation"],account:"Main Account",tradeStatus:"CLOSED",rMultiple:1.75,riskAmount:200,stopLoss:140,images:[]},{id:"mock-monthly-w3-1",instrument:"AAPL",ticker:"AAPL",direction:"long",side:"long",entryPrice:185,exitPrice:183,positionSize:100,pnl:-200,entryTime:new Date("2025-01-21T09:45:00"),exitTime:new Date("2025-01-21T10:30:00"),setup:["Gap Up"],account:"Main Account",tradeStatus:"CLOSED",rMultiple:-1,riskAmount:200,stopLoss:183,images:[]},{id:"mock-monthly-w3-2",instrument:"TSLA",ticker:"TSLA",direction:"short",side:"short",entryPrice:240,exitPrice:244,positionSize:50,pnl:-200,entryTime:new Date("2025-01-21T13:00:00"),exitTime:new Date("2025-01-21T14:15:00"),setup:["Reversal"],account:"Main Account",tradeStatus:"CLOSED",rMultiple:-.8,riskAmount:250,stopLoss:243,images:[]},{id:"mock-monthly-w3-3",instrument:"SPY",ticker:"SPY",direction:"long",side:"long",entryPrice:475,exitPrice:478,positionSize:100,pnl:300,entryTime:new Date("2025-01-22T10:30:00"),exitTime:new Date("2025-01-22T15:00:00"),setup:["Support Bounce"],account:"Main Account",tradeStatus:"CLOSED",rMultiple:1.2,riskAmount:250,stopLoss:472.5,images:[]},{id:"mock-monthly-w3-4",instrument:"META",ticker:"META",direction:"long",side:"long",entryPrice:368,exitPrice:365,positionSize:50,pnl:-150,entryTime:new Date("2025-01-23T09:35:00"),exitTime:new Date("2025-01-23T10:45:00"),setup:["Breakout"],account:"Main Account",tradeStatus:"CLOSED",rMultiple:-.75,riskAmount:200,stopLoss:365,images:[]},{id:"mock-monthly-w3-5",instrument:"NFLX",ticker:"NFLX",direction:"short",side:"short",entryPrice:520,exitPrice:525,positionSize:30,pnl:-150,entryTime:new Date("2025-01-24T11:00:00"),exitTime:new Date("2025-01-24T12:30:00"),setup:["Resistance Rejection"],account:"Secondary",tradeStatus:"CLOSED",rMultiple:-.6,riskAmount:250,stopLoss:525,images:[]},{id:"mock-monthly-w3-6",instrument:"AMD",ticker:"AMD",direction:"long",side:"long",entryPrice:140,exitPrice:138.5,positionSize:80,pnl:-120,entryTime:new Date("2025-01-24T14:00:00"),exitTime:new Date("2025-01-24T15:30:00"),setup:["Support Bounce"],account:"Main Account",tradeStatus:"CLOSED",rMultiple:-.6,riskAmount:200,stopLoss:138.5,images:[]},{id:"mock-monthly-w4-1",instrument:"NVDA",ticker:"NVDA",direction:"long",side:"long",entryPrice:490,exitPrice:498,positionSize:50,pnl:400,entryTime:new Date("2025-01-27T09:35:00"),exitTime:new Date("2025-01-27T14:00:00"),setup:["Trend Continuation"],account:"Main Account",tradeStatus:"CLOSED",rMultiple:2,riskAmount:200,stopLoss:486,images:[]},{id:"mock-monthly-w4-2",instrument:"MSFT",ticker:"MSFT",direction:"long",side:"long",entryPrice:395,exitPrice:392.5,positionSize:60,pnl:-150,entryTime:new Date("2025-01-28T10:00:00"),exitTime:new Date("2025-01-28T11:00:00"),setup:["Breakout"],account:"Main Account",tradeStatus:"CLOSED",rMultiple:-.75,riskAmount:200,stopLoss:392.5,images:[]},{id:"mock-monthly-w4-3",instrument:"GOOGL",ticker:"GOOGL",direction:"long",side:"long",entryPrice:148,exitPrice:151,positionSize:100,pnl:300,entryTime:new Date("2025-01-29T09:45:00"),exitTime:new Date("2025-01-29T14:30:00"),setup:["Trend Continuation"],account:"Main Account",tradeStatus:"CLOSED",rMultiple:1.5,riskAmount:200,stopLoss:146,images:[]},{id:"mock-monthly-w4-4",instrument:"AMZN",ticker:"AMZN",direction:"short",side:"short",entryPrice:162,exitPrice:159,positionSize:80,pnl:240,entryTime:new Date("2025-01-30T11:30:00"),exitTime:new Date("2025-01-30T15:00:00"),setup:["Reversal"],account:"Secondary",tradeStatus:"CLOSED",rMultiple:1.2,riskAmount:200,stopLoss:164,images:[]},{id:"mock-monthly-w4-5",instrument:"SPY",ticker:"SPY",direction:"long",side:"long",entryPrice:480,exitPrice:478,positionSize:100,pnl:-200,entryTime:new Date("2025-01-31T09:35:00"),exitTime:new Date("2025-01-31T10:30:00"),setup:["Gap Up"],account:"Main Account",tradeStatus:"CLOSED",rMultiple:-.8,riskAmount:250,stopLoss:477.5,images:[]}],jJe=[{weekNumber:1,startDate:"2025-01-06",endDate:"2025-01-10",pnl:860,trades:5,winRate:80,avgR:1.16},{weekNumber:2,startDate:"2025-01-13",endDate:"2025-01-17",pnl:1680,trades:6,winRate:83,avgR:1.53},{weekNumber:3,startDate:"2025-01-20",endDate:"2025-01-24",pnl:-520,trades:6,winRate:17,avgR:-.43},{weekNumber:4,startDate:"2025-01-27",endDate:"2025-01-31",pnl:590,trades:5,winRate:60,avgR:.63}],i1e=(e,t,r,n)=>{let i=[],a=["AAPL","TSLA","SPY","NVDA","META","AMZN","GOOGL","MSFT","AMD","NFLX","QQQ","IWM"],o=["Breakout","Reversal","Trend Continuation","Gap Up","Support Bounce","Resistance Rejection","VWAP Bounce"],s=["Main Account","Secondary"],l=0,c=new Date(e);for(;c<=t;){if(c.getDay()!==0&&c.getDay()!==6){let d=Math.floor(Math.random()*3);for(let u=0;u<d&&l<r*52;u++){let p=a[l%a.length],m=Math.random()>.4,g=Math.random()>.4,f=100+Math.random()*400,v=(Math.random()*.05+.005)*f,h=m?g?f+v:f-v:g?f-v:f+v,y=Math.floor(20+Math.random()*180),b=Math.round((m?h-f:f-h)*y),k=9+Math.floor(Math.random()*6),x=Math.floor(Math.random()*60),S=k+1+Math.floor(Math.random()*3);i.push({id:`${n}-${l}`,instrument:p,ticker:p,direction:m?"long":"short",side:m?"long":"short",entryPrice:Math.round(f*100)/100,exitPrice:Math.round(h*100)/100,positionSize:y,pnl:b,entryTime:new Date(c.getFullYear(),c.getMonth(),c.getDate(),k,x),exitTime:new Date(c.getFullYear(),c.getMonth(),c.getDate(),S,x),setup:[o[Math.floor(Math.random()*o.length)]],account:s[Math.floor(Math.random()*s.length)],tradeStatus:"CLOSED",rMultiple:Math.round(b/200*100)/100,riskAmount:200,stopLoss:Math.round((m?f-2:f+2)*100)/100,images:[]}),l++}}c.setDate(c.getDate()+1)}return i},_Je=i1e(new Date("2025-01-01"),new Date("2025-03-31"),5,"mock-quarterly"),BJe=i1e(new Date("2025-01-01"),new Date("2025-12-31"),5,"mock-yearly"),WJe=[{month:1,monthName:"January",pnl:2610,trades:22,winRate:59,avgR:.58},{month:2,monthName:"February",pnl:3200,trades:24,winRate:67,avgR:.85},{month:3,monthName:"March",pnl:1850,trades:20,winRate:55,avgR:.42}],$Je=[{quarter:1,pnl:7660,trades:66,winRate:60,avgR:.62},{quarter:2,pnl:9200,trades:72,winRate:65,avgR:.78},{quarter:3,pnl:5400,trades:68,winRate:58,avgR:.45},{quarter:4,pnl:8100,trades:70,winRate:63,avgR:.71}],TY=[{text:"Follow my trading plan strictly",checked:!0},{text:"Maximum 3 trades per day",checked:!0},{text:"Wait for A+ setups only",checked:!1},{text:"Review each trade before closing",checked:!0}],RJe=[{text:"Review market conditions",checked:!0},{text:"Check economic calendar",checked:!0},{text:"Set risk limits for the day",checked:!1},{text:"Mental state check",checked:!1}],UJe={type:"drc",date:"2025-01-15",mentalGrade:"B",technicalGrade:"A",dailyGoals:TY.map(e=>e.text),dailyGoalStatus:TY.reduce((e,t,r)=>(e[`goal_${r}`]=t.checked,e),{}),previousDayGoals:["Stick to stop losses","No revenge trading","Take breaks between trades"],preTradeChecklist:{"Reviewed market conditions":!0,"Checked economic calendar":!0,"Set daily risk limit":!0,"Mental state check":!1},tradeRatings:{"mock-trade-5":"A","mock-trade-6":"C"},reviewQuestions:{"What went well today?":"Followed my rules on the META short, great patience.","What could be improved?":"Entered AMZN too early, should have waited for confirmation.","Key lessons learned?":"Patience pays off. Wait for the setup to come to me."},forecast:{daily:{notes:"Bullish bias, looking for longs above 4750",images:[]},fourHour:{notes:"Consolidating, wait for breakout",images:[]},oneHour:{notes:"Higher lows forming",images:[]},thirtyMin:{notes:"Clean uptrend",images:[]},bias:"bullish"}},HJe={type:"weekly-review",weekNumber:3,year:2025,startDate:"2025-01-13",endDate:"2025-01-17",mentalGrade:4,technicalGrade:5,weeklyGoals:["Maintain 60%+ win rate","Keep average loss under $200","Journal every trade same day"],previousWeekGoals:["Trade only A setups","Maximum 5 trades per day"],reviewNotes:"Strong week overall. Best performance on trend continuation setups."},qJe={type:"monthly-review",month:1,year:2025,mentalGrade:4,technicalGrade:4,monthlyGoals:["Grow account by 5%","Reduce revenge trading incidents","Complete trading journal course"],previousMonthGoals:["Establish consistent routine","Trade only during market hours","Review journal daily"],reviewNotes:"January was a transitional month. Implemented new journaling system. Week 3 was rough but recovered well.",demons:[{name:"FOMO",count:5},{name:"Revenge Trading",count:3},{name:"Overtrading",count:4},{name:"Moving Stop Loss",count:2},{name:"Early Exit",count:3},{name:"Chasing",count:2}],weeklyGrades:[{week:1,mental:4,technical:4},{week:2,mental:5,technical:5},{week:3,mental:2,technical:3},{week:4,mental:4,technical:4}]},VJe={type:"quarterly-review",quarter:1,year:2025,mentalGrade:4,technicalGrade:4,quarterlyGoals:["Achieve 10% account growth","Reduce maximum drawdown to under 5%","Develop two new trading setups"],previousQuarterGoals:["Establish consistent trading routine","Build proper risk management framework","Journal every trade within 24 hours"],reviewNotes:"Q1 2025 was a solid quarter. Best month was February with consistent execution. March had some challenges but recovered well by end of quarter."},GJe=e=>{let t=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],r=["January","February","March","April","May","June","July","August","September","October","November","December"];return`${t[e.getDay()]}, ${r[e.getMonth()]} ${e.getDate()}, ${e.getFullYear()}`},YJe=(e,t)=>`W${t} - ${["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()]} ${e.getFullYear()}`,KJe=e=>`${["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()]} ${e.getFullYear()}`,JJe=e=>`Q${Math.ceil((e.getMonth()+1)/3)} ${e.getFullYear()}`,QJe=e=>`${e.getFullYear()}`,ZTe=new Date("2025-01-15"),e1e=new Date("2025-01-13"),t1e=new Date("2025-01-01"),r1e=new Date("2025-01-01"),n1e=new Date("2025-01-01"),XJe={drc:{date:ZTe,title:GJe(ZTe),reviewType:"drc"},weekly:{date:e1e,title:YJe(e1e,3),reviewType:"weekly",weekNumber:3},monthly:{date:t1e,title:KJe(t1e),reviewType:"monthly",month:"January",year:2025},quarterly:{date:r1e,title:JJe(r1e),reviewType:"quarterly",quarter:1,year:2025},yearly:{date:n1e,title:QJe(n1e),reviewType:"yearly",year:2025}},ZJe={totalTrades:wu.length,winningTrades:wu.filter(e=>{var t;return((t=e.pnl)!=null?t:0)>0}).length,losingTrades:wu.filter(e=>{var t;return((t=e.pnl)!=null?t:0)<0}).length,totalPnl:wu.reduce((e,t)=>{var r;return e+((r=t.pnl)!=null?r:0)},0),winRate:Math.round(wu.filter(e=>{var t;return((t=e.pnl)!=null?t:0)>0}).length/wu.length*100),avgWin:Math.round(wu.filter(e=>{var t;return((t=e.pnl)!=null?t:0)>0}).reduce((e,t)=>{var r;return e+((r=t.pnl)!=null?r:0)},0)/wu.filter(e=>{var t;return((t=e.pnl)!=null?t:0)>0}).length),avgLoss:Math.round(Math.abs(wu.filter(e=>{var t;return((t=e.pnl)!=null?t:0)<0}).reduce((e,t)=>{var r;return e+((r=t.pnl)!=null?r:0)},0)/wu.filter(e=>{var t;return((t=e.pnl)!=null?t:0)<0}).length)),profitFactor:1.85,avgRMultiple:.88},eQe={totalTrades:xp.length,winningTrades:xp.filter(e=>{var t;return((t=e.pnl)!=null?t:0)>0}).length,losingTrades:xp.filter(e=>{var t;return((t=e.pnl)!=null?t:0)<0}).length,totalPnl:xp.reduce((e,t)=>{var r;return e+((r=t.pnl)!=null?r:0)},0),winRate:Math.round(xp.filter(e=>{var t;return((t=e.pnl)!=null?t:0)>0}).length/xp.length*100),avgWin:Math.round(xp.filter(e=>{var t;return((t=e.pnl)!=null?t:0)>0}).reduce((e,t)=>{var r;return e+((r=t.pnl)!=null?r:0)},0)/xp.filter(e=>{var t;return((t=e.pnl)!=null?t:0)>0}).length),avgLoss:Math.round(Math.abs(xp.filter(e=>{var t;return((t=e.pnl)!=null?t:0)<0}).reduce((e,t)=>{var r;return e+((r=t.pnl)!=null?r:0)},0)/xp.filter(e=>{var t;return((t=e.pnl)!=null?t:0)<0}).length)),profitFactor:1.62,avgRMultiple:.58},tQe=[{weekNumber:1,weekStartDate:new Date("2025-01-06"),weekEndDate:new Date("2025-01-10"),weeklyReviewPath:"Reviews/Weekly/2025-W01.md",mentalGradeDistribution:{A:2,B:2,C:1},technicalGradeDistribution:{A:3,B:1,C:1},mentalRating:3.8,technicalRating:4.2},{weekNumber:2,weekStartDate:new Date("2025-01-13"),weekEndDate:new Date("2025-01-17"),weeklyReviewPath:"Reviews/Weekly/2025-W02.md",mentalGradeDistribution:{A:3,B:2,C:0},technicalGradeDistribution:{A:4,B:1,C:0},mentalRating:4.5,technicalRating:4.8},{weekNumber:3,weekStartDate:new Date("2025-01-20"),weekEndDate:new Date("2025-01-24"),weeklyReviewPath:"Reviews/Weekly/2025-W03.md",mentalGradeDistribution:{A:1,B:2,C:3},technicalGradeDistribution:{A:1,B:3,C:2},mentalRating:2.5,technicalRating:2.8},{weekNumber:4,weekStartDate:new Date("2025-01-27"),weekEndDate:new Date("2025-01-31"),weeklyReviewPath:"Reviews/Weekly/2025-W04.md",mentalGradeDistribution:{A:2,B:2,C:1},technicalGradeDistribution:{A:2,B:3,C:0},mentalRating:3.6,technicalRating:4},{weekNumber:5,weekStartDate:new Date("2025-02-03"),weekEndDate:new Date("2025-02-07"),weeklyReviewPath:"Reviews/Weekly/2025-W05.md",mentalGradeDistribution:{A:3,B:1,C:1},technicalGradeDistribution:{A:4,B:0,C:1},mentalRating:4,technicalRating:4.4},{weekNumber:6,weekStartDate:new Date("2025-02-10"),weekEndDate:new Date("2025-02-14"),weeklyReviewPath:"Reviews/Weekly/2025-W06.md",mentalGradeDistribution:{A:2,B:3,C:0},technicalGradeDistribution:{A:3,B:2,C:0},mentalRating:4.2,technicalRating:4.6},{weekNumber:7,weekStartDate:new Date("2025-02-17"),weekEndDate:new Date("2025-02-21"),weeklyReviewPath:"Reviews/Weekly/2025-W07.md",mentalGradeDistribution:{A:1,B:3,C:1},technicalGradeDistribution:{A:2,B:2,C:1},mentalRating:3.2,technicalRating:3.6},{weekNumber:8,weekStartDate:new Date("2025-02-24"),weekEndDate:new Date("2025-02-28"),weeklyReviewPath:"Reviews/Weekly/2025-W08.md",mentalGradeDistribution:{A:4,B:1,C:0},technicalGradeDistribution:{A:3,B:2,C:0},mentalRating:4.8,technicalRating:4.5},{weekNumber:9,weekStartDate:new Date("2025-03-03"),weekEndDate:new Date("2025-03-07"),weeklyReviewPath:"Reviews/Weekly/2025-W09.md",mentalGradeDistribution:{A:2,B:2,C:1},technicalGradeDistribution:{A:3,B:1,C:1},mentalRating:3.6,technicalRating:4},{weekNumber:10,weekStartDate:new Date("2025-03-10"),weekEndDate:new Date("2025-03-14"),weeklyReviewPath:"Reviews/Weekly/2025-W10.md",mentalGradeDistribution:{A:3,B:2,C:0},technicalGradeDistribution:{A:4,B:1,C:0},mentalRating:4.4,technicalRating:4.8},{weekNumber:11,weekStartDate:new Date("2025-03-17"),weekEndDate:new Date("2025-03-21"),weeklyReviewPath:"Reviews/Weekly/2025-W11.md",mentalGradeDistribution:{A:1,B:2,C:2},technicalGradeDistribution:{A:2,B:2,C:1},mentalRating:2.8,technicalRating:3.2},{weekNumber:12,weekStartDate:new Date("2025-03-24"),weekEndDate:new Date("2025-03-28"),weeklyReviewPath:"Reviews/Weekly/2025-W12.md",mentalGradeDistribution:{A:2,B:3,C:0},technicalGradeDistribution:{A:3,B:2,C:0},mentalRating:4,technicalRating:4.4},{weekNumber:13,weekStartDate:new Date("2025-03-31"),weekEndDate:new Date("2025-04-04"),weeklyReviewPath:"Reviews/Weekly/2025-W13.md",mentalGradeDistribution:{A:3,B:1,C:1},technicalGradeDistribution:{A:2,B:3,C:0},mentalRating:3.8,technicalRating:4.2}],rQe=[{month:1,year:2025,monthName:"January",mentalGradeDistribution:{A:8,B:8,C:5},mentalRating:3.6},{month:2,year:2025,monthName:"February",mentalGradeDistribution:{A:10,B:8,C:2},mentalRating:4},{month:3,year:2025,monthName:"March",mentalGradeDistribution:{A:11,B:10,C:4},mentalRating:3.7},{month:4,year:2025,monthName:"April",mentalGradeDistribution:{A:9,B:7,C:4},mentalRating:3.8},{month:5,year:2025,monthName:"May",mentalGradeDistribution:{A:12,B:6,C:2},mentalRating:4.2},{month:6,year:2025,monthName:"June",mentalGradeDistribution:{A:7,B:9,C:4},mentalRating:3.5},{month:7,year:2025,monthName:"July",mentalGradeDistribution:{A:10,B:8,C:2},mentalRating:4},{month:8,year:2025,monthName:"August",mentalGradeDistribution:{A:8,B:10,C:2},mentalRating:3.8},{month:9,year:2025,monthName:"September",mentalGradeDistribution:{A:11,B:7,C:2},mentalRating:4.1},{month:10,year:2025,monthName:"October",mentalGradeDistribution:{A:9,B:8,C:3},mentalRating:3.9},{month:11,year:2025,monthName:"November",mentalGradeDistribution:{A:10,B:9,C:1},mentalRating:4.3},{month:12,year:2025,monthName:"December",mentalGradeDistribution:{A:8,B:7,C:5},mentalRating:3.6}],nQe=[{month:1,year:2025,monthName:"January",technicalGradeDistribution:{A:10,B:8,C:3},technicalRating:4},{month:2,year:2025,monthName:"February",technicalGradeDistribution:{A:12,B:6,C:2},technicalRating:4.3},{month:3,year:2025,monthName:"March",technicalGradeDistribution:{A:14,B:9,C:2},technicalRating:4.1},{month:4,year:2025,monthName:"April",technicalGradeDistribution:{A:11,B:7,C:2},technicalRating:4.2},{month:5,year:2025,monthName:"May",technicalGradeDistribution:{A:13,B:5,C:2},technicalRating:4.4},{month:6,year:2025,monthName:"June",technicalGradeDistribution:{A:9,B:8,C:3},technicalRating:3.8},{month:7,year:2025,monthName:"July",technicalGradeDistribution:{A:11,B:7,C:2},technicalRating:4.1},{month:8,year:2025,monthName:"August",technicalGradeDistribution:{A:10,B:9,C:1},technicalRating:4},{month:9,year:2025,monthName:"September",technicalGradeDistribution:{A:12,B:6,C:2},technicalRating:4.2},{month:10,year:2025,monthName:"October",technicalGradeDistribution:{A:10,B:8,C:2},technicalRating:4},{month:11,year:2025,monthName:"November",technicalGradeDistribution:{A:11,B:8,C:1},technicalRating:4.4},{month:12,year:2025,monthName:"December",technicalGradeDistribution:{A:9,B:8,C:3},technicalRating:3.9}],iQe=[{mistake:"Moving Stop Loss",occurrences:7,dates:["2025-01-06T10:30:00.000Z","2025-01-08T14:15:00.000Z","2025-01-13T09:45:00.000Z","2025-01-15T11:00:00.000Z","2025-01-21T10:30:00.000Z","2025-01-24T13:00:00.000Z","2025-01-28T09:30:00.000Z"]},{mistake:"FOMO",occurrences:5,dates:["2025-01-07T09:35:00.000Z","2025-01-14T10:00:00.000Z","2025-01-16T11:30:00.000Z","2025-01-22T09:45:00.000Z","2025-01-29T14:00:00.000Z"]},{mistake:"Overtrading",occurrences:4,dates:["2025-01-10T15:00:00.000Z","2025-01-17T14:30:00.000Z","2025-01-23T10:45:00.000Z","2025-01-30T11:00:00.000Z"]},{mistake:"Revenge Trading",occurrences:3,dates:["2025-01-13T14:30:00.000Z","2025-01-21T14:15:00.000Z","2025-01-28T11:00:00.000Z"]},{mistake:"Early Exit",occurrences:2,dates:["2025-01-09T13:45:00.000Z","2025-01-27T14:00:00.000Z"]}],aQe={support:[{price:"4,520",importance:"High"},{price:"4,480",importance:"Medium"},{price:"4,450",importance:null}],resistance:[{price:"4,600",importance:"High"},{price:"4,575",importance:"Low"}]},oQe=[{event:"FOMC Meeting",notes:"Interest rate decision expected",color:"red",day:"Wednesday"},{event:"NFP Report",notes:"Non-farm payrolls release",color:"orange",day:"Friday"},{event:"CPI Data",notes:"Inflation numbers",color:"yellow"},{event:"Earnings Season",notes:"Tech earnings this week",color:"gray"}],sQe=[{file:null,instrument:"ES",direction:"Long",setup:["Opening Range Breakout","VWAP Reclaim"],missedReason:"Was waiting for a deeper pullback that never came",entryTime:new Date("2024-01-15T10:30:00"),path:"mock/missed-trade-1.md"},{file:null,instrument:"NQ",direction:"Short",setup:["Failed Breakout"],missedReason:"Hesitated on entry, missed the move",entryTime:new Date("2024-01-15T14:15:00"),path:"mock/missed-trade-2.md"}],lQe=[{file:null,instrument:"ES",direction:"Long",setup:["Opening Range Breakout","VWAP Reclaim"],missedReason:"Was waiting for a deeper pullback that never came",entryTime:new Date("2024-01-15T10:30:00"),path:"mock/missed-trade-1.md"},{file:null,instrument:"NQ",direction:"Short",setup:["Failed Breakout"],missedReason:"Hesitated on entry",entryTime:new Date("2024-01-16T14:15:00"),path:"mock/missed-trade-2.md"},{file:null,instrument:"SPY",direction:"Long",setup:["Gap Fill","Support Bounce","Volume Confirmation"],missedReason:"Was in another trade when signal appeared",entryTime:new Date("2024-01-17T11:00:00"),path:"mock/missed-trade-3.md"},{file:null,instrument:"AAPL",direction:"Short",setup:["Double Top"],missedReason:"Didn't trust the setup near support",entryTime:new Date("2024-01-19T15:30:00"),path:"mock/missed-trade-4.md"}],CY={trades:wu,tradesDaily:zJe,tradesWeekly:wu,tradesMonthly:xp,tradesQuarterly:_Je,tradesYearly:BJe,weeklyPerformance:jJe,monthlyPerformance:WJe,quarterlyPerformance:$Je,weeklyGamePerformance:tQe,monthlyMentalGameData:rQe,monthlyTechnicalGameData:nQe,demonData:iQe,keyLevels:aQe,keyEvents:oQe,missedTradesDaily:sQe,missedTradesWeekly:lQe,goals:TY,drcFrontmatter:UJe,weeklyFrontmatter:HJe,monthlyFrontmatter:qJe,quarterlyFrontmatter:VJe,headerData:XJe,stats:ZJe,statsMonthly:eQe,checklist:RJe}});var Ut,o1e,cQe,dQe,PY,s1e=F(()=>{Ut=Y(Q());a1e();VB();wV();SV();bV();CV();PV();rz();DV();AV();dz();az();oz();sz();lz();cz();uz();pz();mz();fz();iz();gz();nz();vz();yz();xz();kz();Tz();Pz();Dz();Iz();o1e=({widgetType:e,description:t})=>Ut.default.createElement("div",{style:{padding:"1.5rem",background:"var(--background-secondary)",borderRadius:"var(--radius-m)",border:"2px dashed var(--background-modifier-border)",textAlign:"center"}},Ut.default.createElement("div",{style:{fontWeight:500,color:"var(--text-muted)",marginBottom:t?"0.5rem":0}},(n=>n.split("-").map(i=>i.charAt(0).toUpperCase()+i.slice(1)).join(" "))(e)),t&&Ut.default.createElement("div",{style:{fontSize:"0.85em",color:"var(--text-faint)"}},t)),cQe=({id:e})=>Ut.default.createElement("div",{style:{padding:"1rem",background:"transparent",borderRadius:"var(--radius-s)",border:"1px dashed var(--background-modifier-border-hover)",minHeight:"60px",display:"flex",alignItems:"center",justifyContent:"center"}},Ut.default.createElement("span",{style:{color:"var(--text-faint)",fontSize:"0.85em",fontStyle:"italic"}},"Markdown zone",e?` (${e})`:""," - users write here")),dQe=({widget:e,templateType:t,plugin:r})=>{var S;let{tradesDaily:n,tradesWeekly:i,tradesMonthly:a,tradesQuarterly:o,tradesYearly:s,goals:l,checklist:c,headerData:d,weeklyPerformance:u,weeklyGamePerformance:p,monthlyMentalGameData:m,monthlyTechnicalGameData:g,keyLevels:f,keyEvents:v,missedTradesDaily:h,missedTradesWeekly:y}=CY,b=t==="yearly"?s:t==="quarterly"?o:t==="monthly"?a:t==="weekly"?i:n,k=t==="weekly"?y:h,x={filePath:"",plugin:r,preview:!0};switch(e.type){case"header":return Ut.default.createElement("div",{className:"journalit-widget journalit-header"},Ut.default.createElement(bk,{...x,previewData:d[t]}));case"goals":return Ut.default.createElement(xk,{...x,previewData:{goals:l}});case"review":{let w=e.config,C=(w==null?void 0:w.gradeScale)||(t==="drc"?"letter":"numeric");return Ut.default.createElement(QP,{...x,config:e.config,previewData:{mentalGrade:C==="letter"?"B":4,technicalGrade:C==="letter"?"A":5,gradeScale:C}})}case"stats":return Ut.default.createElement(kk,{...x,config:e.config,previewData:{trades:b}});case"trades":return Ut.default.createElement(Pk,{...x,config:e.config,previewData:{trades:b}});case"pnl-chart":return Ut.default.createElement(Sk,{...x,config:e.config,previewData:{trades:b}});case"drawdown-chart":return Ut.default.createElement(Tk,{...x,config:e.config,previewData:{trades:b}});case"setup-performance":return Ut.default.createElement(Nk,{...x,config:e.config,previewData:{trades:b}});case"best-worst":{let w=e.config;switch((w==null?void 0:w.period)||"trades"){case"days":return Ut.default.createElement(Ik,{...x,config:e.config,previewData:{trades:b}});case"weeks":return Ut.default.createElement(Mk,{...x,config:e.config,previewData:{trades:b}});case"months":return Ut.default.createElement(Ak,{...x,config:e.config,previewData:{trades:b}});case"quarters":return Ut.default.createElement(Lk,{...x,config:e.config,previewData:{trades:b}});default:return Ut.default.createElement(Qb,{...x,config:e.config,previewData:{trades:b}})}}case"trades-chart":{let w=e.config;switch((w==null?void 0:w.period)||"trades"){case"daily":return Ut.default.createElement(eD,{...x,config:e.config,previewData:{trades:b}});case"weekly":return Ut.default.createElement(tD,{...x,config:e.config,previewData:{trades:b}});case"monthly":return Ut.default.createElement(rD,{...x,config:e.config,previewData:{trades:b}});case"quarterly":return Ut.default.createElement(nD,{...x,config:e.config,previewData:{trades:b}});default:return Ut.default.createElement(Ek,{...x,config:e.config,previewData:{trades:b}})}}case"directional-pnl":return Ut.default.createElement(Fk,{...x,config:e.config,previewData:{trades:b}});case"breakdown":{let w=e.config,C=(w==null?void 0:w.period)||"daily";return Ut.default.createElement(Dk,{...x,config:e.config,previewData:{trades:b},period:C})}case"images":return Ut.default.createElement(Ok,{...x,config:e.config,previewData:{images:["https://placehold.co/400x300/1a1a2e/eee?text=Chart+Screenshot","https://placehold.co/400x300/16213e/eee?text=Trade+Setup"]}});case"markdown-zone":return Ut.default.createElement(cQe,{id:e.id});case"markdown-header":{let w=e.config,C=(S=w==null?void 0:w.level)!=null?S:2,D=(w==null?void 0:w.text)||"Section Header",P={1:"2em",2:"1.5em",3:"1.25em",4:"1em",5:"0.875em",6:"0.85em"};return Ut.default.createElement(`h${C}`,{style:{fontSize:P[C],fontWeight:C===1?700:600,margin:"0.5rem 0",color:"var(--text-normal)"}},D)}case"mark-reviewed":return Ut.default.createElement(aD,{...x,previewData:{reviewed:!0,reviewedAt:new Date().toISOString()}});case"technical-game":{let w=t==="yearly"?"yearly-review":t==="quarterly"?"quarterly-review":"monthly-review";return Ut.default.createElement(jk,{...x,config:e.config,previewData:{weeks:p,noteType:w,monthlyData:t==="yearly"?g:void 0}})}case"mental-game":{let w=t==="yearly"?"yearly-review":t==="quarterly"?"quarterly-review":"monthly-review";return Ut.default.createElement(Bk,{...x,config:e.config,previewData:{weeks:p,noteType:w,monthlyData:t==="yearly"?m:void 0}})}case"checklist":return Ut.default.createElement(wk,{...x,previewData:{items:c}});case"key-levels":return Ut.default.createElement("div",{className:"journalit-widget journalit-key-levels"},Ut.default.createElement(Rk,{...x,config:e.config,previewData:{keyLevels:f}}));case"missed-trades":return Ut.default.createElement("div",{className:"journalit-widget journalit-missed-trades"},Ut.default.createElement(Hk,{...x,config:e.config,previewData:{missedTrades:k,noteType:t==="weekly"?"weekly-review":"drc"}}));case"key-events":return Ut.default.createElement("div",{className:"journalit-widget journalit-key-events"},Ut.default.createElement(Uk,{...x,previewData:{events:v,reviewMode:t==="weekly"?"weekly-review":"drc"}}));case"game-performance":return Ut.default.createElement(o1e,{widgetType:e.type,description:"Mental/Technical grade distributions"});case"demon-tracker":{let w=t==="yearly"?"yearly-review":t==="quarterly"?"quarterly-review":"monthly-review";return Ut.default.createElement("div",{className:"journalit-widget journalit-demon-tracker"},Ut.default.createElement($k,{...x,config:e.config,previewData:{demons:CY.demonData,noteType:w}}))}default:return Ut.default.createElement(o1e,{widgetType:e.type,description:"Unknown widget type"})}},PY=Ut.default.memo(({template:e,plugin:t})=>((0,Ut.useEffect)(()=>{xee()},[]),!e||!e.widgets||e.widgets.length===0?Ut.default.createElement("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-muted)"}},"No widgets in this template"):Ut.default.createElement("div",{className:"template-preview",style:{display:"flex",flexDirection:"column",padding:"1rem",background:"var(--background-primary)",borderRadius:"var(--radius-m)",border:"1px solid var(--background-modifier-border)",maxHeight:"100%",overflowY:"auto",maxWidth:"calc(var(--file-line-width, 700px) + 34px)",marginLeft:"auto",marginRight:"auto"}},Ut.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",paddingBottom:"0.75rem",borderBottom:"1px solid var(--background-modifier-border)",marginBottom:"1rem"}},Ut.default.createElement("div",null,Ut.default.createElement("div",{style:{fontWeight:600,color:"var(--text-normal)",fontSize:"0.95em"}},e.name),Ut.default.createElement("div",{style:{fontSize:"0.8em",color:"var(--text-muted)"}},e.type.toUpperCase()," Template - ",e.widgets.length," widgets")),Ut.default.createElement("div",{style:{padding:"4px 8px",background:"var(--background-secondary)",borderRadius:"var(--radius-s)",fontSize:"0.75em",color:"var(--text-muted)"}},"Preview Mode")),Ut.default.createElement("div",{className:"template-preview-content",style:{maxWidth:"var(--file-line-width, 700px)",marginLeft:"auto",marginRight:"auto",width:"100%",display:"flex",flexDirection:"column",gap:"1rem"}},e.widgets.map((r,n)=>Ut.default.createElement("div",{key:`${r.type}-${r.id||n}`,className:"template-preview-widget"},Ut.default.createElement(dQe,{widget:r,templateType:e.type,plugin:t})))))));PY.displayName="TemplatePreview"});function d1e(e){return DY.filter(t=>t.availableIn.includes(e))}function u1e(e){var r;let t=new Map;for(let n of l1e)t.set(n,[]);for(let n of e){let i=t.get(n.category);i&&i.push(n)}for(let n of l1e)((r=t.get(n))==null?void 0:r.length)===0&&t.delete(n);return t}function uQe(e){return DY.find(t=>t.type===e)}function pQe(e,t){return DY.find(r=>r.type!==e?!1:r.defaultConfig?t?Object.entries(r.defaultConfig).every(([n,i])=>t[n]===i):!1:!t||Object.keys(t).length===0)}function EY(e){let t=uQe(e);return t?t.name:e.split("-").map(r=>r.charAt(0).toUpperCase()+r.slice(1)).join(" ")}function p1e(e,t){let r=pQe(e,t);return r?r.name:EY(e)}var l1e,c1e,DY,IY=F(()=>{l1e=["content","charts","statistics","tables","layout"],c1e={charts:"Charts",statistics:"Statistics",content:"Content",tables:"Tables",layout:"Layout"},DY=[{type:"goals",name:"Goals",description:"Daily goals with completion checkboxes",category:"content",availableIn:["drc","weekly","monthly","quarterly","yearly"]},{type:"review",name:"Review",description:"Mental and technical performance grades",category:"content",availableIn:["drc","weekly","monthly","quarterly","yearly"]},{type:"checklist",name:"Checklist",description:"Pre-session preparation checklist",category:"content",availableIn:["drc"]},{type:"key-levels",name:"Key Levels",description:"Important price levels to watch",category:"content",availableIn:["drc"]},{type:"key-events",name:"Key Events",description:"Important events during the period",category:"content",availableIn:["drc","weekly"]},{type:"missed-trades",name:"Missed Trades",description:"Trades you identified but did not take",category:"content",availableIn:["drc","weekly"]},{type:"images",name:"Images",description:"Image carousel with upload support",category:"content",availableIn:["drc","weekly","monthly","quarterly","yearly"]},{type:"mark-reviewed",name:"Mark as Reviewed",description:"Banner to mark review as complete with timestamp",category:"content",availableIn:["drc","weekly","monthly","quarterly","yearly"]},{type:"pnl-chart",name:"Equity Curve",description:"Cumulative profit/loss over time",category:"charts",availableIn:["drc","weekly","monthly","quarterly","yearly"]},{type:"drawdown-chart",name:"Drawdown",description:"Maximum drawdown from peak equity",category:"charts",availableIn:["drc","weekly","monthly","quarterly","yearly"]},{type:"directional-pnl",name:"Directional P&L",description:"Long vs short performance comparison",category:"charts",availableIn:["drc","weekly","monthly","quarterly","yearly"]},{type:"trades-chart",name:"Trade P&L",description:"P&L bar for each individual trade",category:"charts",availableIn:["drc","weekly","monthly","quarterly","yearly"],defaultConfig:{period:"trades"}},{type:"trades-chart",name:"Daily P&L",description:"P&L aggregated by day",category:"charts",availableIn:["weekly","monthly","quarterly","yearly"],defaultConfig:{period:"daily"}},{type:"trades-chart",name:"Weekly P&L",description:"P&L aggregated by week",category:"charts",availableIn:["monthly","quarterly","yearly"],defaultConfig:{period:"weekly"}},{type:"trades-chart",name:"Monthly P&L",description:"P&L aggregated by month",category:"charts",availableIn:["quarterly","yearly"],defaultConfig:{period:"monthly"}},{type:"trades-chart",name:"Quarterly P&L",description:"P&L aggregated by quarter",category:"charts",availableIn:["yearly"],defaultConfig:{period:"quarterly"}},{type:"stats",name:"Stats Grid",description:"Key performance metrics in grid format",category:"statistics",availableIn:["drc","weekly","monthly","quarterly","yearly"]},{type:"setup-performance",name:"Setup Performance",description:"Performance breakdown by trading setup",category:"statistics",availableIn:["drc","weekly","monthly","quarterly","yearly"]},{type:"best-worst",name:"Best/Worst Trades",description:"Top winning and losing trades",category:"statistics",availableIn:["drc","weekly","monthly","quarterly","yearly"],defaultConfig:{period:"trades"}},{type:"best-worst",name:"Best/Worst Days",description:"Highest and lowest P&L days",category:"statistics",availableIn:["drc","weekly","monthly","quarterly","yearly"],defaultConfig:{period:"days"}},{type:"best-worst",name:"Best/Worst Weeks",description:"Highest and lowest P&L weeks",category:"statistics",availableIn:["weekly","monthly","quarterly","yearly"],defaultConfig:{period:"weeks"}},{type:"best-worst",name:"Best/Worst Months",description:"Highest and lowest P&L months",category:"statistics",availableIn:["quarterly","yearly"],defaultConfig:{period:"months"}},{type:"best-worst",name:"Best/Worst Quarters",description:"Highest and lowest P&L quarters",category:"statistics",availableIn:["yearly"],defaultConfig:{period:"quarters"}},{type:"technical-game",name:"Technical Game",description:"Weekly technical grade distribution from DRCs",category:"statistics",availableIn:["monthly","quarterly","yearly"],defaultConfig:{pageSize:5,showRating:!0}},{type:"mental-game",name:"Mental Game",description:"Weekly mental grade distribution from DRCs",category:"statistics",availableIn:["monthly","quarterly","yearly"],defaultConfig:{pageSize:5,showRating:!0}},{type:"demon-tracker",name:"Demon Tracker",description:"Track recurring trading mistakes",category:"statistics",availableIn:["monthly","quarterly","yearly"]},{type:"trades",name:"Trades",description:"List of trades with key details",category:"tables",availableIn:["drc","weekly","monthly","quarterly","yearly"]},{type:"breakdown",name:"Daily Summary",description:"Performance table grouped by day",category:"tables",availableIn:["drc","weekly","monthly","quarterly","yearly"],defaultConfig:{period:"daily"}},{type:"breakdown",name:"Weekly Summary",description:"Performance table grouped by week",category:"tables",availableIn:["weekly","monthly","quarterly","yearly"],defaultConfig:{period:"weekly"}},{type:"breakdown",name:"Monthly Summary",description:"Performance table grouped by month",category:"tables",availableIn:["quarterly","yearly"],defaultConfig:{period:"monthly"}},{type:"breakdown",name:"Quarterly Summary",description:"Performance table grouped by quarter",category:"tables",availableIn:["yearly"],defaultConfig:{period:"quarterly"}},{type:"markdown-zone",name:"Markdown Zone",description:"Free-form markdown content area",category:"layout",availableIn:["drc","weekly","monthly","quarterly","yearly"]},{type:"markdown-header",name:"Section Header",description:"Markdown heading (H1-H6) with custom text",category:"layout",availableIn:["drc","weekly","monthly","quarterly","yearly"]}]});var hn,MY,m1e=F(()=>{hn=Y(Q());Ot();IY();MY=hn.default.memo(({value:e,valueConfig:t,templateType:r,onChange:n,placeholder:i="Select a widget..."})=>{let[a,o]=(0,hn.useState)(!1),[s,l]=(0,hn.useState)(-1),c=(0,hn.useRef)(null),d=(0,hn.useRef)(null),u=(0,hn.useRef)([]),p=(0,hn.useMemo)(()=>d1e(r),[r]),m=(0,hn.useMemo)(()=>u1e(p),[p]),g=(0,hn.useMemo)(()=>{let C=[];return m.forEach(D=>{C.push(...D)}),C},[m]),f=(0,hn.useCallback)(C=>C.type!==e?!1:C.defaultConfig?t?Object.entries(C.defaultConfig).every(([D,P])=>t[D]===P):!1:!t||Object.keys(t).length===0,[e,t]),v=(0,hn.useMemo)(()=>g.find(C=>f(C)),[g,f]);(0,hn.useEffect)(()=>{if(a){let C=g.findIndex(D=>f(D));l(C>=0?C:0)}else l(-1)},[a,g,f]),(0,hn.useEffect)(()=>{var C;a&&s>=0&&u.current[s]&&((C=u.current[s])==null||C.scrollIntoView({block:"nearest",behavior:"smooth"}))},[s,a]),(0,hn.useEffect)(()=>{if(!a)return;let C=D=>{c.current&&!c.current.contains(D.target)&&o(!1)};return document.addEventListener("mousedown",C),()=>document.removeEventListener("mousedown",C)},[a]),(0,hn.useEffect)(()=>{if(!a)return;let C=D=>{var P;switch(D.key){case"Escape":D.preventDefault(),o(!1),(P=d.current)==null||P.focus();break;case"ArrowDown":D.preventDefault(),l(M=>M<g.length-1?M+1:0);break;case"ArrowUp":D.preventDefault(),l(M=>M>0?M-1:g.length-1);break;case"Enter":D.preventDefault(),s>=0&&s<g.length&&h(g[s]);break}};return document.addEventListener("keydown",C),()=>document.removeEventListener("keydown",C)},[a,s,g]);let h=(0,hn.useCallback)(C=>{var D;n(C),o(!1),(D=d.current)==null||D.focus()},[n]),y=(0,hn.useCallback)(()=>{o(C=>!C)},[]),b=(0,hn.useCallback)(C=>{C.key==="Enter"||C.key===" "?(C.preventDefault(),o(D=>!D)):C.key==="ArrowDown"&&!a&&(C.preventDefault(),o(!0))},[a]),k=(v==null?void 0:v.name)||(e?EY(e):i),x=`widget-picker-trigger${e?"":" widget-picker-trigger--placeholder"}`,S=`widget-picker-icon${a?" widget-picker-icon--open":""}`,w=0;return hn.default.createElement("div",{ref:c,className:"widget-picker-container"},hn.default.createElement("button",{ref:d,type:"button",onClick:y,onKeyDown:b,className:x,"aria-haspopup":"listbox","aria-expanded":a},hn.default.createElement("span",null,k),hn.default.createElement(cs,{size:14,className:S})),a&&hn.default.createElement("div",{className:"widget-picker-dropdown",role:"listbox"},Array.from(m.entries()).map(([C,D])=>hn.default.createElement("div",{key:C},hn.default.createElement("div",{className:"widget-picker-category"},c1e[C]),D.map(P=>{let M=w++,z=M===s,A=f(P),I=P.defaultConfig?`${P.type}-${JSON.stringify(P.defaultConfig)}`:P.type;return hn.default.createElement("button",{key:I,ref:L=>{u.current[M]=L},type:"button",onClick:()=>h(P),onMouseEnter:()=>l(M),className:`widget-picker-item${z?" widget-picker-item--focused":""}${A?" widget-picker-item--selected":""}`,role:"option","aria-selected":A},hn.default.createElement("span",{className:"widget-picker-item-content"},hn.default.createElement("span",{className:"widget-picker-item-name"},P.name),hn.default.createElement("span",{className:"widget-picker-item-description"},P.description)),A&&hn.default.createElement(Fi,{size:16,className:"widget-picker-item-check"}))})))))});MY.displayName="WidgetPicker"});var Je,aj,mQe,fQe,f1e,g1e=F(()=>{Je=Y(Q()),aj=require("obsidian");Ay();h0();mh();Ot();XTe();s1e();m1e();IY();mQe=({id:e,index:t,widget:r,isEditing:n,templateType:i,onWidgetChange:a,onConfigChange:o,onRemove:s})=>{var y,b;let{attributes:l,listeners:c,setNodeRef:d,transform:u,transition:p,isDragging:m}=Vp({id:e,disabled:!n||r.locked}),g={transform:al.Transform.toString(u),transition:m?p:void 0,opacity:m?.5:1,zIndex:m?1e3:"auto"},f=r.config,v=(y=f==null?void 0:f.level)!=null?y:2,h=(b=f==null?void 0:f.text)!=null?b:"";return Je.default.createElement("div",{ref:d,style:{...g,background:m?"var(--background-primary)":"var(--background-secondary)",borderRadius:"var(--radius-s)",border:`1px solid ${m?"var(--interactive-accent)":"var(--background-modifier-border)"}`}},Je.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"10px 12px"}},!r.locked&&Je.default.createElement("div",{...l,...c,style:{color:"var(--text-faint)",cursor:n?"grab":"default",padding:"4px",display:"flex",alignItems:"center",touchAction:"none",opacity:n?1:.3},onClick:k=>k.stopPropagation()},Je.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"currentColor"},Je.default.createElement("circle",{cx:"9",cy:"6",r:"2"}),Je.default.createElement("circle",{cx:"15",cy:"6",r:"2"}),Je.default.createElement("circle",{cx:"9",cy:"12",r:"2"}),Je.default.createElement("circle",{cx:"15",cy:"12",r:"2"}),Je.default.createElement("circle",{cx:"9",cy:"18",r:"2"}),Je.default.createElement("circle",{cx:"15",cy:"18",r:"2"}))),r.locked&&Je.default.createElement("div",{style:{width:"20px"}}),Je.default.createElement("div",{style:{flex:1}},n&&!r.locked?Je.default.createElement(MY,{value:r.type,valueConfig:r.config,templateType:i,onChange:k=>a(t,k),placeholder:"Select a widget..."}):Je.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px"}},Je.default.createElement("span",{style:{fontSize:"13px",fontWeight:500}},p1e(r.type,r.config)),r.locked&&Je.default.createElement("span",{style:{fontSize:"10px",padding:"2px 6px",background:"var(--background-modifier-border)",borderRadius:"4px",color:"var(--text-muted)"}},"Locked"))),n&&!r.locked&&Je.default.createElement("button",{onClick:()=>s(t),style:{padding:"4px 6px",background:"var(--background-primary)",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",cursor:"pointer",color:"var(--text-error)"}},Je.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},Je.default.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Je.default.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})))),r.type==="markdown-header"&&n&&Je.default.createElement("div",{style:{display:"flex",gap:"12px",padding:"0 12px 10px 40px",alignItems:"center"}},Je.default.createElement("select",{value:v,onChange:k=>o(t,{...r.config,level:parseInt(k.target.value,10),text:h}),style:{padding:"6px 10px",border:"1px solid var(--background-modifier-border)",borderRadius:"var(--radius-s)",background:"var(--background-primary)",color:"var(--text-normal)",fontSize:"13px",cursor:"pointer"}},Je.default.createElement("option",{value:1},"H1"),Je.default.createElement("option",{value:2},"H2"),Je.default.createElement("option",{value:3},"H3"),Je.default.createElement("option",{value:4},"H4"),Je.default.createElement("option",{value:5},"H5"),Je.default.createElement("option",{value:6},"H6")),Je.default.createElement("input",{type:"text",value:h,onChange:k=>o(t,{...r.config,level:v,text:k.target.value}),placeholder:"Header text...",style:{flex:1,padding:"6px 10px",border:"1px solid var(--background-modifier-border)",borderRadius:"var(--radius-s)",background:"var(--background-primary)",color:"var(--text-normal)",fontSize:"13px"}})),(r.type==="technical-game"||r.type==="mental-game")&&n&&(()=>{var w,C;let k=r.config,x=(w=k==null?void 0:k.pageSize)!=null?w:5,S=(C=k==null?void 0:k.showRating)!=null?C:!0;return Je.default.createElement("div",{style:{display:"flex",gap:"16px",padding:"0 12px 10px 40px",alignItems:"center"}},Je.default.createElement("label",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"13px",color:"var(--text-muted)"}},"Page size:",Je.default.createElement("select",{value:x,onChange:D=>o(t,{...r.config,pageSize:parseInt(D.target.value,10),showRating:S}),style:{padding:"4px 8px",border:"1px solid var(--background-modifier-border)",borderRadius:"var(--radius-s)",background:"var(--background-primary)",color:"var(--text-normal)",fontSize:"13px",cursor:"pointer"}},Je.default.createElement("option",{value:5},"5"),Je.default.createElement("option",{value:10},"10"),Je.default.createElement("option",{value:15},"15"),Je.default.createElement("option",{value:20},"20"))),Je.default.createElement("label",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"13px",color:"var(--text-muted)",cursor:"pointer"}},Je.default.createElement("input",{type:"checkbox",checked:S,onChange:D=>o(t,{...r.config,pageSize:x,showRating:D.target.checked}),style:{cursor:"pointer"}}),"Show rating column"))})())},fQe=[{value:"preview",label:"Preview"},{value:"editor",label:"Editor"}],f1e=({plugin:e,templateService:t,templateId:r,templateType:n,onTemplateChange:i})=>{let[a,o]=(0,Je.useState)(null),[s,l]=(0,Je.useState)("preview"),[c,d]=(0,Je.useState)(""),[u,p]=(0,Je.useState)([]),m=(0,Je.useCallback)(()=>{let M=t.getTemplates(n).find(z=>z.id===r);M&&(o(M),d(M.name),p(JSON.parse(JSON.stringify(M.widgets||[]))))},[t,r,n]);(0,Je.useEffect)(()=>{m()},[m,r]);let g=(0,Je.useMemo)(()=>{if(!a)return!1;let P=a.widgets||[];return c!==a.name||u.length!==P.length?!0:u.some((M,z)=>{let A=P[z];return A?M.type!==A.type||M.locked!==A.locked||JSON.stringify(M.config)!==JSON.stringify(A.config):!0})},[a,c,u]),f=s==="editor"&&a&&!a.isBuiltIn,v=(0,Je.useCallback)(async()=>{if(a)try{await t.updateTemplate(r,{name:c,widgets:u}),m(),i==null||i(),new aj.Notice("Template saved")}catch(P){console.error("Failed to save template:",P),new aj.Notice(P instanceof Error?P.message:"Failed to save template")}},[t,r,c,u,m,i,a]),h=(0,Je.useCallback)(()=>{a&&(d(a.name),p(JSON.parse(JSON.stringify(a.widgets||[]))))},[a]),y=(0,Je.useCallback)(()=>{p([...u,{type:""}])},[u]),b=(0,Je.useCallback)(P=>{if(u[P].locked){new aj.Notice("Cannot remove locked widgets");return}let M=[...u];M.splice(P,1),p(M)},[u]),k=(0,Je.useCallback)(P=>{if(P===0)return;let M=[...u];[M[P-1],M[P]]=[M[P],M[P-1]],p(M)},[u]),x=(0,Je.useCallback)(P=>{if(P===u.length-1)return;let M=[...u];[M[P],M[P+1]]=[M[P+1],M[P]],p(M)},[u]),S=(0,Je.useCallback)((P,M)=>{let z=[...u],A=M.defaultConfig?{...M.defaultConfig,...z[P].config}:z[P].config;z[P]={...z[P],type:M.type,config:A},p(z)},[u]),w=(0,Je.useCallback)((P,M)=>{let z=[...u];z[P]={...z[P],config:M},p(z)},[u]),C=(0,Je.useCallback)(P=>{let{active:M,over:z}=P;!z||M.id===z.id||p(A=>{let I=A.findIndex((_,B)=>`widget-${B}`===M.id),L=A.findIndex((_,B)=>`widget-${B}`===z.id);if(I===-1||L===-1)return A;let E=A.findIndex(_=>!_.locked);if(E>0&&L<E&&(L=E),L===I)return A;let T=[...A],[$]=T.splice(I,1);return T.splice(L,0,$),T})},[]);if(!a)return Je.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"var(--text-muted)"}},"Loading template...");let D=g?{...a,name:c,widgets:u}:a;return Je.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column"}},Je.default.createElement("div",{style:{height:"53px",display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0 20px",borderBottom:"1px solid var(--background-modifier-border)",background:"var(--background-primary)",flexShrink:0}},Je.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"16px"}},Je.default.createElement(SY,{options:fQe,value:s,onChange:P=>l(P),size:"small"}),Je.default.createElement("div",null,Je.default.createElement("span",{style:{fontWeight:600,fontSize:"14px"}},g?c:a.name),Je.default.createElement("span",{style:{marginLeft:"8px",fontSize:"11px",padding:"2px 6px",background:"var(--background-modifier-border)",borderRadius:"4px",color:"var(--text-muted)",textTransform:"uppercase"}},n),a.isBuiltIn&&Je.default.createElement("span",{style:{marginLeft:"6px",fontSize:"11px",color:"var(--text-muted)"}},"(Built-in)")))),Je.default.createElement("div",{className:"template-editor-canvas",style:{flex:1,overflow:"auto"}},s==="preview"?Je.default.createElement(PY,{template:D,plugin:e}):Je.default.createElement("div",{style:{padding:"20px",maxWidth:"600px",margin:"0 auto"}},(a==null?void 0:a.isBuiltIn)&&Je.default.createElement("div",{style:{display:"flex",alignItems:"flex-start",gap:"10px",padding:"12px 14px",marginBottom:"20px",background:"rgba(var(--color-yellow-rgb, 224, 175, 72), 0.1)",borderRadius:"var(--radius-s)",border:"1px solid rgba(var(--color-yellow-rgb, 224, 175, 72), 0.3)",fontSize:"13px",color:"var(--text-normal)"}},Je.default.createElement(Js,{size:16,style:{flexShrink:0,marginTop:"1px",color:"var(--color-yellow, #e0af48)"}}),Je.default.createElement("span",null,"Built-in templates cannot be edited. Duplicate this template or create a new one to customize.")),g&&f&&Je.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 14px",marginBottom:"20px",background:"rgba(var(--color-blue-rgb, 72, 138, 224), 0.1)",borderRadius:"var(--radius-s)",border:"1px solid rgba(var(--color-blue-rgb, 72, 138, 224), 0.3)",fontSize:"13px"}},Je.default.createElement("span",{style:{color:"var(--text-normal)"}},"Unsaved changes"),Je.default.createElement("div",{style:{display:"flex",gap:"8px"}},Je.default.createElement("button",{onClick:h,style:{padding:"5px 12px",background:"var(--background-primary)",border:"1px solid var(--background-modifier-border)",borderRadius:"var(--radius-s)",cursor:"pointer",fontSize:"12px",color:"var(--text-normal)"}},"Discard"),Je.default.createElement("button",{onClick:v,style:{padding:"5px 12px",background:"var(--interactive-accent)",border:"none",borderRadius:"var(--radius-s)",cursor:"pointer",fontSize:"12px",color:"var(--text-on-accent)",fontWeight:500}},"Save"))),Je.default.createElement("div",{style:{marginBottom:"24px"}},Je.default.createElement("label",{style:{display:"block",marginBottom:"8px",fontSize:"13px",fontWeight:500,color:"var(--text-normal)"}},"Template Name"),Je.default.createElement("input",{type:"text",value:c,onChange:P=>d(P.target.value),onKeyDown:P=>{P.key==="Enter"&&f&&g&&(P.preventDefault(),v())},disabled:!f,style:{width:"100%",padding:"10px 12px",border:"1px solid var(--background-modifier-border)",borderRadius:"var(--radius-s)",background:f?"var(--background-primary)":"var(--background-secondary)",color:"var(--text-normal)",fontSize:"14px",cursor:f?"text":"not-allowed",opacity:f?1:.7}})),Je.default.createElement("div",null,Je.default.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"}},Je.default.createElement("label",{style:{fontSize:"13px",fontWeight:500,color:"var(--text-normal)"}},"Widgets (",u.length,")"),f&&Je.default.createElement("button",{onClick:y,style:{padding:"4px 10px",background:"var(--background-secondary)",border:"1px solid var(--background-modifier-border)",borderRadius:"var(--radius-s)",cursor:"pointer",fontSize:"12px",color:"var(--text-normal)"}},"+ Add Widget")),Je.default.createElement(jd,{collisionDetection:zd,onDragEnd:C},Je.default.createElement(_d,{items:u.map((P,M)=>`widget-${M}`),strategy:gh},Je.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"6px"}},u.map((P,M)=>Je.default.createElement(mQe,{key:`widget-${M}`,id:`widget-${M}`,index:M,widget:P,isEditing:!!f,templateType:n,onWidgetChange:S,onConfigChange:w,onRemove:b})))))))))}});var be,oj,ox,yv,h1e,bD,v1e,gQe,AY,y1e,b1e=F(()=>{be=Y(Q()),oj=require("obsidian");Ot();Ay();h0();mh();ox=({checked:e,onChange:t,disabled:r})=>be.default.createElement("button",{onClick:()=>!r&&t(!e),style:{width:"36px",height:"20px",borderRadius:"10px",border:"none",background:e?"var(--interactive-accent)":"var(--background-modifier-border)",position:"relative",cursor:r?"not-allowed":"pointer",opacity:r?.5:1,transition:"background 0.2s"}},be.default.createElement("div",{style:{width:"16px",height:"16px",borderRadius:"50%",background:"white",position:"absolute",top:"2px",left:e?"18px":"2px",transition:"left 0.2s",boxShadow:"0 1px 2px rgba(0,0,0,0.2)"}})),yv=({label:e,description:t,children:r})=>be.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 0",borderBottom:"1px solid var(--background-modifier-border)"}},be.default.createElement("div",{style:{flex:1}},be.default.createElement("div",{style:{fontSize:"14px",fontWeight:500,color:"var(--text-normal)"}},e),t&&be.default.createElement("div",{style:{fontSize:"12px",color:"var(--text-muted)",marginTop:"2px"}},t)),be.default.createElement("div",{style:{marginLeft:"16px"}},r)),h1e=({value:e,options:t,onChange:r,disabled:n})=>be.default.createElement("select",{value:e,onChange:i=>r(i.target.value),disabled:n,style:{padding:"6px 10px",borderRadius:"var(--radius-s)",border:"1px solid var(--background-modifier-border)",background:"var(--background-primary)",color:"var(--text-normal)",fontSize:"13px",cursor:n?"not-allowed":"pointer",opacity:n?.5:1,textAlign:"center"}},t.map(i=>be.default.createElement("option",{key:i.value,value:i.value},i.label))),bD=({value:e,onChange:t,placeholder:r,multiline:n,rows:i=3,disabled:a})=>{let o={width:"100%",padding:"8px 10px",borderRadius:"var(--radius-s)",border:"1px solid var(--background-modifier-border)",background:"var(--background-primary)",color:"var(--text-normal)",fontSize:"13px",fontFamily:"inherit",resize:"vertical",opacity:a?.5:1};return n?be.default.createElement("textarea",{value:e,onChange:s=>t(s.target.value),placeholder:r,rows:i,disabled:a,style:o}):be.default.createElement("input",{type:"text",value:e,onChange:s=>t(s.target.value),placeholder:r,disabled:a,style:o})},v1e=e=>{switch(e){case"header":return"Header";case"checkbox":return"Checkbox";case"textarea":return"Text Area";case"checkboxList":return"Checkbox List"}},gQe=e=>e.title?e.title.replace(/\*\*/g,""):e.content?e.content.substring(0,30)+(e.content.length>30?"...":""):e.placeholder?e.placeholder.substring(0,30)+(e.placeholder.length>30?"...":""):`${v1e(e.type)} section`,AY=({id:e,section:t,isEditing:r,onUpdate:n,onRemove:i})=>{let{attributes:a,listeners:o,setNodeRef:s,transform:l,transition:c,isDragging:d}=Vp({id:e,disabled:!r}),u={transform:al.Transform.toString(l),transition:d?c:void 0,opacity:d?.5:1,zIndex:d?1e3:"auto"},[p,m]=(0,be.useState)(!1),g=y=>{let b={...t,type:y};y==="checkboxList"?(b.items=b.items||[""],b.content=void 0,b.placeholder=void 0):y==="textarea"?(b.placeholder=b.placeholder||"",b.content=void 0,b.items=void 0):(b.content=b.content||"",b.items=void 0,b.placeholder=void 0),n(b)},f=(y,b)=>{let k=[...t.items||[]];k[y]=b,n({...t,items:k})},v=()=>{let y=[...t.items||[],""];n({...t,items:y})},h=y=>{let b=(t.items||[]).filter((k,x)=>x!==y);n({...t,items:b.length>0?b:[""]})};return be.default.createElement("div",{ref:s,style:{...u,background:d?"var(--background-primary)":"var(--background-secondary)",borderRadius:"var(--radius-s)",border:`1px solid ${d?"var(--interactive-accent)":"var(--background-modifier-border)"}`}},be.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"12px",padding:"10px 12px"}},be.default.createElement("div",{...a,...o,style:{color:"var(--text-faint)",cursor:r?"grab":"default",padding:"4px",display:"flex",alignItems:"center",touchAction:"none",opacity:r?1:.3},onClick:y=>y.stopPropagation()},be.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"currentColor"},be.default.createElement("circle",{cx:"9",cy:"6",r:"2"}),be.default.createElement("circle",{cx:"15",cy:"6",r:"2"}),be.default.createElement("circle",{cx:"9",cy:"12",r:"2"}),be.default.createElement("circle",{cx:"15",cy:"12",r:"2"}),be.default.createElement("circle",{cx:"9",cy:"18",r:"2"}),be.default.createElement("circle",{cx:"15",cy:"18",r:"2"}))),be.default.createElement("div",{style:{flex:1,cursor:r?"pointer":"default"},onClick:()=>r&&m(!p)},be.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px"}},be.default.createElement("span",{style:{fontSize:"13px",fontWeight:500}},gQe(t)),be.default.createElement("span",{style:{fontSize:"10px",padding:"2px 6px",background:"var(--background-modifier-border)",borderRadius:"4px",color:"var(--text-muted)"}},v1e(t.type)))),r&&be.default.createElement("button",{onClick:()=>i(),style:{padding:"4px 6px",background:"var(--background-primary)",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",cursor:"pointer",color:"var(--text-error)"}},be.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},be.default.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),be.default.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})))),p&&r&&be.default.createElement("div",{style:{padding:"12px",borderTop:"1px solid var(--background-modifier-border)",display:"flex",flexDirection:"column",gap:"12px"}},be.default.createElement("div",null,be.default.createElement("label",{style:{fontSize:"12px",color:"var(--text-muted)",marginBottom:"4px",display:"block"}},"Section Type"),be.default.createElement(h1e,{value:t.type,options:[{value:"textarea",label:"Text Area"},{value:"checkbox",label:"Single Checkbox"},{value:"checkboxList",label:"Checkbox List"}],onChange:y=>g(y)})),be.default.createElement("div",null,be.default.createElement("label",{style:{fontSize:"12px",color:"var(--text-muted)",marginBottom:"4px",display:"block"}},"Title (supports **markdown**)"),be.default.createElement(bD,{value:t.title,onChange:y=>n({...t,title:y}),placeholder:"Section title"})),t.type==="header"&&be.default.createElement("div",null,be.default.createElement("label",{style:{fontSize:"12px",color:"var(--text-muted)",marginBottom:"4px",display:"block"}},"Content (supports markdown)"),be.default.createElement(bD,{value:t.content||"",onChange:y=>n({...t,content:y}),placeholder:"Header content",multiline:!0,rows:2})),t.type==="checkbox"&&be.default.createElement("div",null,be.default.createElement("label",{style:{fontSize:"12px",color:"var(--text-muted)",marginBottom:"4px",display:"block"}},"Checkbox Label (supports markdown)"),be.default.createElement(bD,{value:t.content||"",onChange:y=>n({...t,content:y}),placeholder:"Checkbox label",multiline:!0,rows:2})),t.type==="textarea"&&be.default.createElement("div",null,be.default.createElement("label",{style:{fontSize:"12px",color:"var(--text-muted)",marginBottom:"4px",display:"block"}},"Placeholder Text"),be.default.createElement(bD,{value:t.placeholder||"",onChange:y=>n({...t,placeholder:y}),placeholder:"Placeholder text shown when empty"})),t.type==="checkboxList"&&be.default.createElement("div",null,be.default.createElement("label",{style:{fontSize:"12px",color:"var(--text-muted)",marginBottom:"4px",display:"block"}},"Checkbox Items"),(t.items||[""]).map((y,b)=>be.default.createElement("div",{key:b,style:{display:"flex",gap:"8px",marginBottom:"8px"}},be.default.createElement(bD,{value:y,onChange:k=>f(b,k),placeholder:`Item ${b+1}`}),be.default.createElement("button",{onClick:()=>h(b),disabled:(t.items||[]).length<=1,style:{padding:"4px 6px",background:"var(--background-primary)",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",cursor:(t.items||[]).length<=1?"not-allowed":"pointer",color:"var(--text-error)",opacity:(t.items||[]).length<=1?.3:1}},be.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},be.default.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),be.default.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))))),be.default.createElement("button",{onClick:v,style:{padding:"4px 10px",background:"var(--background-secondary)",border:"1px solid var(--background-modifier-border)",borderRadius:"var(--radius-s)",cursor:"pointer",fontSize:"12px",color:"var(--text-normal)"}},"+ Add Item"))))},y1e=({plugin:e,tradeTemplateService:t,templateId:r,onTemplateChange:n})=>{var w,C;let[i,a]=(0,be.useState)(null),[o,s]=(0,be.useState)(""),[l,c]=(0,be.useState)(null),[d,u]=(0,be.useState)(!1),p=(0,be.useCallback)(()=>{let D=t.getTemplate(r);D&&(a(D),s(D.name),c(JSON.parse(JSON.stringify(D.sections))))},[r,t]);(0,be.useEffect)(()=>{p()},[p]);let m=(0,be.useMemo)(()=>!i||!l?!1:o!==i.name?!0:JSON.stringify(l)!==JSON.stringify(i.sections),[i,o,l]),g=(0,be.useCallback)(async()=>{if(!(!i||!l))try{if(i.isBuiltIn){new oj.Notice("Duplicate this template to customize it");return}await t.updateTemplate(i.id,{name:o,sections:l}),p(),n==null||n(),new oj.Notice("Template saved")}catch(D){console.error("Failed to save template:",D),new oj.Notice(D instanceof Error?D.message:"Failed to save template")}},[i,o,l,t,p,n]),f=(0,be.useCallback)(()=>{i&&(s(i.name),c(JSON.parse(JSON.stringify(i.sections))))},[i]),v=(0,be.useCallback)((D,P)=>{l&&c({...l,[D]:{...l[D],...P}})},[l]),h=(0,be.useCallback)(()=>{u(!1)},[]),y=(0,be.useCallback)(D=>P=>{let{active:M,over:z}=P;if(!z||M.id===z.id||!l)return;let A=l.review[D]||[],I=A.findIndex($=>$.id===M.id),L=A.findIndex($=>$.id===z.id);if(I===-1||L===-1)return;let E=[...A],[T]=E.splice(I,1);E.splice(L,0,T),v("review",{[D]:E})},[l,v]),[b,k]=(0,be.useState)("win");if(!i||!l)return be.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"var(--text-muted)"}},"Loading template...");let x=i.isBuiltIn,S=!x;return be.default.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",overflow:"hidden"}},be.default.createElement("div",{style:{height:"53px",padding:"0 20px",borderBottom:"1px solid var(--background-modifier-border)",background:"var(--background-primary)",display:"flex",alignItems:"center",justifyContent:"space-between",flexShrink:0}},be.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"12px"}},d&&S?be.default.createElement("input",{type:"text",value:o,onChange:D=>s(D.target.value),onBlur:h,onKeyDown:D=>{D.key==="Enter"&&h(),D.key==="Escape"&&(s(i.name),u(!1))},autoFocus:!0,style:{fontSize:"16px",fontWeight:600,padding:"4px 8px",border:"1px solid var(--interactive-accent)",borderRadius:"var(--radius-s)",background:"var(--background-primary)",color:"var(--text-normal)"}}):be.default.createElement("h2",{onClick:()=>S&&u(!0),style:{margin:0,fontSize:"16px",fontWeight:600,cursor:S?"pointer":"default"}},o),x&&be.default.createElement("span",{style:{fontSize:"11px",padding:"2px 6px",background:"var(--background-modifier-border)",borderRadius:"4px",color:"var(--text-muted)"}},"Built-in"))),be.default.createElement("div",{className:"template-editor-canvas",style:{flex:1,overflow:"auto"}},be.default.createElement("div",{style:{padding:"20px",maxWidth:"600px",margin:"0 auto"}},m&&S&&be.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"10px 14px",marginBottom:"20px",background:"rgba(var(--color-blue-rgb, 72, 138, 224), 0.1)",borderRadius:"var(--radius-s)",border:"1px solid rgba(var(--color-blue-rgb, 72, 138, 224), 0.3)",fontSize:"13px"}},be.default.createElement("span",{style:{color:"var(--text-normal)"}},"Unsaved changes"),be.default.createElement("div",{style:{display:"flex",gap:"8px"}},be.default.createElement("button",{onClick:f,style:{padding:"5px 12px",background:"var(--background-primary)",border:"1px solid var(--background-modifier-border)",borderRadius:"var(--radius-s)",cursor:"pointer",fontSize:"12px",color:"var(--text-normal)"}},"Discard"),be.default.createElement("button",{onClick:g,style:{padding:"5px 12px",background:"var(--interactive-accent)",border:"none",borderRadius:"var(--radius-s)",cursor:"pointer",fontSize:"12px",color:"var(--text-on-accent)",fontWeight:500}},"Save"))),be.default.createElement("div",{style:{background:"var(--background-secondary)",borderRadius:"var(--radius-m)",padding:"16px 20px",marginBottom:"20px"}},be.default.createElement("h3",{style:{margin:"0 0 16px 0",fontSize:"14px",fontWeight:600,color:"var(--text-normal)",display:"flex",alignItems:"center",gap:"8px"}},be.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},be.default.createElement("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),be.default.createElement("polyline",{points:"14 2 14 8 20 8"}),be.default.createElement("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),be.default.createElement("line",{x1:"16",y1:"17",x2:"8",y2:"17"})),"Trade Review"),x&&be.default.createElement("div",{style:{display:"flex",alignItems:"flex-start",gap:"10px",padding:"12px 14px",marginBottom:"16px",background:"rgba(var(--color-yellow-rgb, 224, 175, 72), 0.1)",borderRadius:"var(--radius-s)",border:"1px solid rgba(var(--color-yellow-rgb, 224, 175, 72), 0.3)",fontSize:"13px",color:"var(--text-normal)"}},be.default.createElement(Js,{size:16,style:{flexShrink:0,marginTop:"1px",color:"var(--color-yellow, #e0af48)"}}),be.default.createElement("span",null,"Built-in templates cannot be edited. Duplicate this template or create a new one to customize.")),be.default.createElement(yv,{label:"Show Review Section",description:"When to display the review section on trade notes"},be.default.createElement(h1e,{value:l.review.show,options:[{value:"always",label:"Always"},{value:"losses-only",label:"Losses Only"},{value:"never",label:"Never"}],onChange:D=>v("review",{show:D}),disabled:x})),l.review.show!=="never"&&be.default.createElement(be.default.Fragment,null,be.default.createElement(yv,{label:"Show for Missed Trades",description:"Also display review section on missed trade notes"},be.default.createElement(ox,{checked:(w=l.review.showForMissed)!=null?w:!1,onChange:D=>v("review",{showForMissed:D}),disabled:x})),be.default.createElement(yv,{label:"Show for Backtest Trades",description:"Also display review section on backtest trade notes"},be.default.createElement(ox,{checked:(C=l.review.showForBacktest)!=null?C:!1,onChange:D=>v("review",{showForBacktest:D}),disabled:x}))),l.review.show!=="never"&&be.default.createElement("div",{style:{marginTop:"16px"}},l.review.show==="losses-only"&&be.default.createElement(be.default.Fragment,null,be.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px"}},be.default.createElement("label",{style:{fontSize:"13px",fontWeight:500,color:"var(--text-normal)"}},"Review Sections"),S&&be.default.createElement("button",{onClick:()=>{let D={id:`section-${Date.now()}`,title:"",type:"textarea",placeholder:""},P=[...l.review.sections||[],D];v("review",{sections:P})},style:{padding:"4px 10px",background:"var(--background-secondary)",border:"1px solid var(--background-modifier-border)",borderRadius:"var(--radius-s)",cursor:"pointer",fontSize:"12px",color:"var(--text-normal)"}},"+ Add Section")),(l.review.sections||[]).length===0?be.default.createElement("div",{style:{padding:"20px",textAlign:"center",color:"var(--text-muted)",fontSize:"13px",background:"var(--background-primary)",borderRadius:"var(--radius-s)",border:"1px dashed var(--background-modifier-border)"}},"No review sections configured.",S&&' Click "+ Add Section" to create one.'):be.default.createElement(jd,{collisionDetection:zd,onDragEnd:y("sections")},be.default.createElement(_d,{items:(l.review.sections||[]).map(D=>D.id),strategy:gh},be.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"6px"}},(l.review.sections||[]).map((D,P)=>be.default.createElement(AY,{key:D.id,id:D.id,section:D,isEditing:S,onUpdate:M=>{let z=[...l.review.sections||[]];z[P]=M,v("review",{sections:z})},onRemove:()=>{let M=(l.review.sections||[]).filter((z,A)=>A!==P);v("review",{sections:M})}})))))),l.review.show==="always"&&be.default.createElement(be.default.Fragment,null,be.default.createElement("div",{style:{display:"flex",gap:"4px",marginBottom:"12px",borderBottom:"1px solid var(--background-modifier-border)",paddingBottom:"8px"}},be.default.createElement("button",{onClick:()=>k("win"),style:{padding:"6px 12px",fontSize:"12px",fontWeight:500,background:b==="win"?"var(--interactive-accent)":"transparent",color:b==="win"?"var(--text-on-accent)":"var(--text-muted)",border:b==="win"?"none":"1px solid var(--background-modifier-border)",borderRadius:"var(--radius-s)",cursor:"pointer"}},"Win Sections"),be.default.createElement("button",{onClick:()=>k("loss"),style:{padding:"6px 12px",fontSize:"12px",fontWeight:500,background:b==="loss"?"var(--interactive-accent)":"transparent",color:b==="loss"?"var(--text-on-accent)":"var(--text-muted)",border:b==="loss"?"none":"1px solid var(--background-modifier-border)",borderRadius:"var(--radius-s)",cursor:"pointer"}},"Loss Sections")),b==="win"&&be.default.createElement(be.default.Fragment,null,be.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px"}},be.default.createElement("label",{style:{fontSize:"12px",color:"var(--text-muted)"}},"Shown on winning and breakeven trades"),S&&be.default.createElement("button",{onClick:()=>{let D={id:`win-section-${Date.now()}`,title:"",type:"textarea",placeholder:""},P=[...l.review.winSections||[],D];v("review",{winSections:P})},style:{padding:"4px 10px",background:"var(--background-secondary)",border:"1px solid var(--background-modifier-border)",borderRadius:"var(--radius-s)",cursor:"pointer",fontSize:"12px",color:"var(--text-normal)"}},"+ Add Section")),(l.review.winSections||[]).length===0?be.default.createElement("div",{style:{padding:"20px",textAlign:"center",color:"var(--text-muted)",fontSize:"13px",background:"var(--background-primary)",borderRadius:"var(--radius-s)",border:"1px dashed var(--background-modifier-border)"}},"No win sections configured.",S&&' Click "+ Add Section" to create one.'):be.default.createElement(jd,{collisionDetection:zd,onDragEnd:y("winSections")},be.default.createElement(_d,{items:(l.review.winSections||[]).map(D=>D.id),strategy:gh},be.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"6px"}},(l.review.winSections||[]).map((D,P)=>be.default.createElement(AY,{key:D.id,id:D.id,section:D,isEditing:S,onUpdate:M=>{let z=[...l.review.winSections||[]];z[P]=M,v("review",{winSections:z})},onRemove:()=>{let M=(l.review.winSections||[]).filter((z,A)=>A!==P);v("review",{winSections:M})}})))))),b==="loss"&&be.default.createElement(be.default.Fragment,null,be.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px"}},be.default.createElement("label",{style:{fontSize:"12px",color:"var(--text-muted)"}},"Shown on losing trades"),S&&be.default.createElement("button",{onClick:()=>{let D={id:`loss-section-${Date.now()}`,title:"",type:"textarea",placeholder:""},P=[...l.review.lossSections||[],D];v("review",{lossSections:P})},style:{padding:"4px 10px",background:"var(--background-secondary)",border:"1px solid var(--background-modifier-border)",borderRadius:"var(--radius-s)",cursor:"pointer",fontSize:"12px",color:"var(--text-normal)"}},"+ Add Section")),(l.review.lossSections||[]).length===0?be.default.createElement("div",{style:{padding:"20px",textAlign:"center",color:"var(--text-muted)",fontSize:"13px",background:"var(--background-primary)",borderRadius:"var(--radius-s)",border:"1px dashed var(--background-modifier-border)"}},"No loss sections configured.",S&&' Click "+ Add Section" to create one.'):be.default.createElement(jd,{collisionDetection:zd,onDragEnd:y("lossSections")},be.default.createElement(_d,{items:(l.review.lossSections||[]).map(D=>D.id),strategy:gh},be.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"6px"}},(l.review.lossSections||[]).map((D,P)=>be.default.createElement(AY,{key:D.id,id:D.id,section:D,isEditing:S,onUpdate:M=>{let z=[...l.review.lossSections||[]];z[P]=M,v("review",{lossSections:z})},onRemove:()=>{let M=(l.review.lossSections||[]).filter((z,A)=>A!==P);v("review",{lossSections:M})}}))))))))),be.default.createElement("div",{style:{background:"var(--background-secondary)",borderRadius:"var(--radius-m)",padding:"16px 20px"}},be.default.createElement("h3",{style:{margin:"0 0 8px 0",fontSize:"14px",fontWeight:600,color:"var(--text-normal)"}},"Section Visibility"),be.default.createElement(yv,{label:"Navigation Bar",description:"Show trade timeline and review links"},be.default.createElement(ox,{checked:l.navigation.show,onChange:D=>v("navigation",{show:D}),disabled:!S})),be.default.createElement(yv,{label:"Images",description:"Show trade chart images"},be.default.createElement(ox,{checked:l.images.show,onChange:D=>v("images",{show:D}),disabled:!S})),be.default.createElement(yv,{label:"Metadata",description:"Show accounts, setups, and mistakes"},be.default.createElement(ox,{checked:l.metadata.show,onChange:D=>v("metadata",{show:D}),disabled:!S})),be.default.createElement(yv,{label:"Trade Details",description:"Show entry, exit, and P&L details"},be.default.createElement(ox,{checked:l.details.show,onChange:D=>v("details",{show:D}),disabled:!S})),be.default.createElement(yv,{label:"Mark Reviewed Button",description:"Show button to mark trade as reviewed"},be.default.createElement(ox,{checked:l.reviewButton.show,onChange:D=>v("reviewButton",{show:D}),disabled:!S}))))))}});var ku,sj,x1e=F(()=>{ku=class ku{exportReviewTemplate(t){let r={name:t.name,type:t.type,widgets:t.widgets};return this.encodePayload(r)}exportTradeTemplate(t){let r={name:t.name,type:"trade",sections:t.sections,display:t.display};return this.encodePayload(r)}validateShareCode(t){if(!t.startsWith(ku.SHARE_CODE_PREFIX))return{valid:!1,error:"Invalid share code format. Must start with JRT-"};let n=t.substring(ku.SHARE_CODE_PREFIX.length).split("-");if(n.length<2)return{valid:!1,error:"Invalid share code format. Expected JRT-{version}-{data}"};let i=n[0],a=n.slice(1).join("-");if(i!==ku.CURRENT_VERSION)return{valid:!1,error:`Unsupported version: ${i}. Only ${ku.CURRENT_VERSION} is supported.`};if(a.length>ku.MAX_PAYLOAD_LENGTH)return{valid:!1,error:"Share code exceeds maximum length (50KB)"};let o=this.decodePayload(a);if(!o)return{valid:!1,error:"Failed to decode share code. Data may be corrupted."};if(!o.name||typeof o.name!="string")return{valid:!1,error:"Invalid template: missing or invalid name field"};if(!o.type||typeof o.type!="string")return{valid:!1,error:"Invalid template: missing or invalid type field"};if(o.type==="trade"){let s=o;if(!s.sections||typeof s.sections!="object")return{valid:!1,error:"Invalid trade template: missing or invalid sections field"};if(!s.display||typeof s.display!="object")return{valid:!1,error:"Invalid trade template: missing or invalid display field"}}else if(["drc","weekly","monthly","quarterly","yearly"].includes(o.type)){if(!Array.isArray(o.widgets))return{valid:!1,error:"Invalid template: missing or invalid widgets field"}}else return{valid:!1,error:`Invalid template type: ${o.type}. Must be drc, weekly, monthly, quarterly, yearly, or trade.`};return{valid:!0,payload:o,templateName:o.name,templateType:o.type}}async importTemplate(t,r,n){let i=this.validateShareCode(t);if(!i.valid||!i.payload)throw new Error(i.error||"Invalid share code");let a=i.payload,o=a.name;if(a.type==="trade"){let l=n.getTemplates().map(d=>d.name);o=this.generateUniqueName(a.name,l);let c=a;return await n.createTemplate({name:o,type:"trade",isBuiltIn:!1,sections:c.sections,display:c.display})}else{let l=r.getTemplates(a.type).map(d=>d.name);o=this.generateUniqueName(a.name,l);let c=a;return await r.createTemplate({name:o,type:c.type,isBuiltIn:!1,widgets:c.widgets})}}encodePayload(t){let r=JSON.stringify(t),n=btoa(r);return`${ku.SHARE_CODE_PREFIX}${ku.CURRENT_VERSION}-${n}`}decodePayload(t){try{let r=atob(t);return JSON.parse(r)}catch(r){return console.error("Failed to decode payload:",r),null}}generateUniqueName(t,r){let n=t,i=0;for(;r.includes(n);)i++,i===1?n=`${t} (Imported)`:n=`${t} (Imported ${i})`;return n}};ku.SHARE_CODE_PREFIX="JRT-",ku.CURRENT_VERSION="v1",ku.MAX_PAYLOAD_LENGTH=5e4;sj=ku});function vQe(){try{let e="template-builder-styles";if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=hQe,document.head.appendChild(t)}catch(e){console.error("Failed to inject Template Builder styles:",e)}}function lj(){if(document.getElementById("template-builder-styles")||vQe(),!document.getElementById("critical-template-builder-styles")){let e=document.createElement("style");e.id="critical-template-builder-styles",e.textContent=`
      /* Critical core styles for Template Builder */
      .journalit-template-builder-container {
        display: flex !important;
        flex-direction: column !important;
        width: 100% !important;
        height: 100% !important;
        min-height: 0 !important;
        overflow: hidden !important;
        box-sizing: border-box !important;
      }

      .template-builder-view {
        display: flex !important;
        flex-direction: column !important;
        width: 100% !important;
        height: 100% !important;
        min-height: 0 !important;
        overflow: hidden !important;
      }

      .template-builder-tabs {
        display: flex !important;
        flex-shrink: 0 !important;
        border-bottom: 2px solid var(--background-modifier-border) !important;
      }

      .template-builder-content {
        flex: 1 !important;
        min-height: 0 !important;
        overflow-y: auto !important;
        overflow-x: hidden !important;
      }

      .template-list {
        display: flex !important;
        flex-direction: column !important;
        gap: 12px !important;
      }

      .template-editor {
        display: block !important;
        width: 100% !important;
      }

      /* Tooltip styles for Template Builder */
      .journalit-tooltip {
        background: var(--background-secondary) !important;
        border: 1px solid var(--background-modifier-border) !important;
        border-radius: 6px !important;
        padding: 6px 10px !important;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15) !important;
        font-size: 12px !important;
        color: var(--text-normal) !important;
        z-index: 9999 !important;
        pointer-events: none !important;
        max-width: 280px !important;
      }

      /* Widget Picker - Critical styles */
      .widget-picker-category {
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        gap: 10px !important;
        padding: 6px 14px !important;
        margin-top: 4px !important;
        font-size: 10px !important;
        font-weight: 600 !important;
        letter-spacing: 0.5px !important;
        text-transform: uppercase !important;
        color: var(--text-muted) !important;
        background: var(--background-primary) !important;
        position: sticky !important;
        top: 0 !important;
        z-index: 1 !important;
        border-bottom: none !important;
      }

      .widget-picker-category::before,
      .widget-picker-category::after {
        content: '' !important;
        flex: 1 !important;
        height: 1px !important;
        background: var(--background-modifier-border) !important;
      }

      .widget-picker-item {
        display: flex !important;
        flex-direction: row !important;
        align-items: center !important;
        justify-content: space-between !important;
        width: 100% !important;
        min-height: 50px !important;
        padding: 14px 14px !important;
        margin: 4px 0 !important;
        text-align: left !important;
        background: transparent !important;
        border: none !important;
        cursor: pointer !important;
        box-sizing: border-box !important;
        scroll-margin-top: 40px !important;
      }

      .widget-picker-item:hover,
      .widget-picker-item--focused {
        background: var(--background-secondary) !important;
      }

      .widget-picker-item-content {
        display: flex !important;
        flex-direction: column !important;
        align-items: flex-start !important;
        flex: 1 !important;
        min-width: 0 !important;
      }

      .widget-picker-item-name {
        display: block !important;
        width: 100% !important;
        font-size: 13px !important;
        font-weight: 500 !important;
        color: var(--text-normal) !important;
      }

      .widget-picker-item-description {
        display: block !important;
        width: 100% !important;
        font-size: 11px !important;
        color: var(--text-muted) !important;
        line-height: 1.4 !important;
        margin-top: 2px !important;
      }

      .widget-picker-item-check {
        flex-shrink: 0 !important;
        margin-left: 12px !important;
        color: var(--interactive-accent) !important;
      }
    `,document.head.appendChild(e)}}var hQe,LY=F(()=>{hQe=`
/* Template Builder Container */
.journalit-template-builder-container {
  background: var(--background-primary);
  color: var(--text-normal);
  overflow: hidden;
  height: 100%;
  min-height: 0;
  display: flex;
  flex-direction: column;
}

/* Preserve default view header height */
.journalit-template-builder-container .view-header {
  flex-shrink: 0;
}

/* Template Builder Main Layout */
.template-builder-view {
  display: flex;
  flex-direction: column;
  width: 100%;
  height: 100%;
  min-height: 0;
  overflow: hidden;
}

/* React root container - must have min-height: 0 for scroll to work */
.journalit-template-builder-container > div[id^="react-root-"],
.journalit-template-builder-container > div[id="journalit-template-builder-view"] {
  height: 100%;
  overflow: visible;
  display: flex;
  flex-direction: column;
  min-height: 0;
}

/* Tab Navigation Bar */
.template-builder-tabs {
  display: flex;
  border-bottom: 2px solid var(--background-modifier-border);
  background: var(--background-primary);
  flex-shrink: 0;
  padding: 0 16px;
  gap: 4px;
}

.template-builder-tab {
  padding: 12px 20px;
  cursor: pointer;
  border: none;
  border-bottom: 2px solid transparent;
  color: var(--text-muted);
  background: transparent;
  font-weight: 500;
  font-size: 14px;
  transition: all 0.2s ease;
  position: relative;
  bottom: -2px;
}

.template-builder-tab:hover {
  color: var(--text-normal);
  background: var(--background-modifier-hover);
}

.template-builder-tab.is-active {
  color: var(--text-accent);
  border-bottom-color: var(--interactive-accent);
  font-weight: 600;
}

/* Content Area */
.template-builder-content {
  flex: 1;
  min-height: 0;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 24px;
  background: var(--background-primary);
}

/* Template Editor Canvas - Dotted background for canvas feel */
.template-editor-canvas {
  background-color: var(--background-primary);
  background-size: 20px 20px;
  background-position: 0 0;
}

.theme-light .template-editor-canvas {
  background-image: radial-gradient(circle, rgba(0, 0, 0, 0.1) 1px, transparent 1px);
}

.theme-dark .template-editor-canvas {
  background-image: radial-gradient(circle, rgba(255, 255, 255, 0.04) 1px, transparent 1px);
}

/* Template List */
.template-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin-bottom: 24px;
}

.template-list-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  background: var(--background-primary-alt);
  cursor: pointer;
  transition: all 0.2s ease;
}

.template-list-item:hover {
  background: var(--background-modifier-hover);
  border-color: var(--background-modifier-border-hover);
}

.template-list-item--selected {
  border-color: var(--interactive-accent);
  background: var(--background-secondary);
}

.template-list-item-info {
  flex: 1;
  min-width: 0;
}

.template-list-item-name {
  font-weight: 600;
  color: var(--text-normal);
  margin-bottom: 4px;
  font-size: 15px;
}

.template-list-item-description {
  color: var(--text-muted);
  font-size: 13px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.template-list-item-actions {
  display: flex;
  gap: 8px;
  align-items: center;
  flex-shrink: 0;
}

/* Template Editor Panel */
.template-editor {
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  padding: 24px;
  background: var(--background-secondary);
}

.template-editor-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
  padding-bottom: 16px;
  border-bottom: 1px solid var(--background-modifier-border);
}

.template-editor-title {
  font-size: 18px;
  font-weight: 600;
  color: var(--text-normal);
  margin: 0;
}

.template-editor-actions {
  display: flex;
  gap: 8px;
  align-items: center;
}

/* Form Fields */
.template-form-field {
  margin-bottom: 20px;
}

.template-form-label {
  display: block;
  font-weight: 500;
  color: var(--text-normal);
  margin-bottom: 8px;
  font-size: 14px;
}

.template-form-input {
  width: 100%;
  padding: 10px 12px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  background: var(--background-primary);
  color: var(--text-normal);
  font-size: 14px;
  transition: border-color 0.2s ease, box-shadow 0.2s ease;
}

.template-form-input:focus {
  border-color: var(--interactive-accent);
  box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2);
  outline: none;
}

/* Select elements need explicit height/line-height to prevent text clipping */
select.template-form-input {
  height: 40px;
  min-height: 40px;
  line-height: 20px;
  padding: 8px 12px;
}

.template-form-textarea {
  min-height: 100px;
  resize: vertical;
  font-family: inherit;
  line-height: 1.5;
}

/* Section List */
.template-sections-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin-top: 12px;
}

.template-section-item {
  display: flex;
  align-items: center;
  padding: 12px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  background: var(--background-primary);
  transition: all 0.2s ease;
}

.template-section-item:hover {
  border-color: var(--background-modifier-border-hover);
  background: var(--background-modifier-hover);
}

.template-section-item--dragging {
  opacity: 0.5;
  cursor: grabbing;
}

/* Drag Handle */
.template-section-drag-handle {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  margin-right: 12px;
  cursor: grab;
  color: var(--text-muted);
  transition: color 0.2s ease;
}

.template-section-drag-handle:hover {
  color: var(--text-normal);
}

.template-section-drag-handle:active {
  cursor: grabbing;
}

/* Reorder Indicator */
.template-section-reorder-indicator {
  position: absolute;
  left: 0;
  right: 0;
  height: 2px;
  background: var(--interactive-accent);
  border-radius: 1px;
  pointer-events: none;
  z-index: 100;
}

.template-section-reorder-indicator--top {
  top: -1px;
}

.template-section-reorder-indicator--bottom {
  bottom: -1px;
}

.template-section-content {
  flex: 1;
  min-width: 0;
}

.template-section-title {
  font-weight: 500;
  color: var(--text-normal);
  margin-bottom: 4px;
  font-size: 14px;
}

.template-section-type {
  color: var(--text-muted);
  font-size: 12px;
}

.template-section-actions {
  display: flex;
  gap: 8px;
  align-items: center;
  flex-shrink: 0;
}

/* Action Buttons */
.template-action-button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  padding: 8px 16px;
  border-radius: 6px;
  font-size: 14px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  border: 1px solid transparent;
  white-space: nowrap;
}

.template-action-button--primary {
  background: var(--interactive-accent);
  color: var(--text-on-accent, white);
  border-color: var(--interactive-accent);
}

.template-action-button--primary:hover {
  background: var(--interactive-accent-hover);
  border-color: var(--interactive-accent-hover);
}

.template-action-button--secondary {
  background: var(--background-secondary);
  color: var(--text-normal);
  border-color: var(--background-modifier-border);
}

.template-action-button--secondary:hover {
  background: var(--background-modifier-hover);
  border-color: var(--background-modifier-border-hover);
}

.template-action-button--danger {
  background: var(--background-modifier-error);
  color: var(--text-on-accent, white);
  border-color: var(--background-modifier-error);
}

.template-action-button--danger:hover {
  opacity: 0.9;
}

.template-action-button--small {
  padding: 6px 12px;
  font-size: 13px;
}

.template-action-button--icon-only {
  padding: 8px;
  min-width: 36px;
  min-height: 36px;
}

.template-action-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.template-action-button-icon {
  width: 16px;
  height: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Import/Export Modal */
.template-modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  padding: 24px;
}

.template-modal {
  background: var(--background-primary);
  border-radius: 12px;
  max-width: 600px;
  width: 100%;
  max-height: 80vh;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.template-modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20px 24px;
  border-bottom: 1px solid var(--background-modifier-border);
}

.template-modal-title {
  font-size: 18px;
  font-weight: 600;
  color: var(--text-normal);
  margin: 0;
}

.template-modal-close {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  border: none;
  background: transparent;
  color: var(--text-muted);
  cursor: pointer;
  border-radius: 6px;
  transition: all 0.2s ease;
}

.template-modal-close:hover {
  background: var(--background-modifier-hover);
  color: var(--text-normal);
}

.template-modal-content {
  flex: 1;
  overflow-y: auto;
  padding: 24px;
}

.template-modal-footer {
  display: flex;
  justify-content: flex-end;
  gap: 12px;
  padding: 16px 24px;
  border-top: 1px solid var(--background-modifier-border);
}

/* Empty State */
.template-empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 64px 24px;
  text-align: center;
}

.template-empty-state-icon {
  width: 64px;
  height: 64px;
  margin-bottom: 16px;
  color: var(--text-muted);
  opacity: 0.5;
}

.template-empty-state-title {
  font-size: 18px;
  font-weight: 600;
  color: var(--text-normal);
  margin-bottom: 8px;
}

.template-empty-state-description {
  font-size: 14px;
  color: var(--text-muted);
  margin-bottom: 24px;
  max-width: 400px;
  line-height: 1.5;
}

/* Toolbar */
.template-toolbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 24px;
  background: var(--background-secondary);
  border-bottom: 1px solid var(--background-modifier-border);
  flex-shrink: 0;
}

.template-toolbar-left {
  display: flex;
  gap: 12px;
  align-items: center;
}

.template-toolbar-right {
  display: flex;
  gap: 12px;
  align-items: center;
}

/* Search Input */
.template-search-input {
  padding: 8px 12px 8px 36px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  background: var(--background-primary);
  color: var(--text-normal);
  font-size: 14px;
  width: 250px;
  transition: border-color 0.2s ease, box-shadow 0.2s ease;
}

.template-search-input:focus {
  border-color: var(--interactive-accent);
  box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2);
  outline: none;
}

.template-search-wrapper {
  position: relative;
  display: flex;
  align-items: center;
}

.template-search-icon {
  position: absolute;
  left: 12px;
  width: 16px;
  height: 16px;
  color: var(--text-muted);
  pointer-events: none;
}

/* Badges */
.template-badge {
  display: inline-flex;
  align-items: center;
  padding: 4px 10px;
  border-radius: 12px;
  font-size: 12px;
  font-weight: 500;
  background: var(--background-secondary);
  color: var(--text-muted);
}

.template-badge--active {
  background: var(--interactive-accent);
  color: var(--text-on-accent, white);
}

/* Dropdown Menu */
.template-dropdown {
  position: relative;
  display: inline-block;
}

.template-dropdown-menu {
  position: absolute;
  top: calc(100% + 4px);
  right: 0;
  min-width: 160px;
  background: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
  overflow: hidden;
  z-index: 100;
}

.template-dropdown-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 10px 14px;
  color: var(--text-normal);
  cursor: pointer;
  font-size: 14px;
  transition: background 0.15s ease;
  border: none;
  background: transparent;
  width: 100%;
  text-align: left;
}

.template-dropdown-item:hover {
  background: var(--background-modifier-hover);
}

.template-dropdown-item--danger {
  color: var(--text-error);
}

.template-dropdown-divider {
  height: 1px;
  background: var(--background-modifier-border);
  margin: 4px 0;
}

/* Responsive Styles */
@media (max-width: 768px) {
  .template-builder-tabs {
    padding: 0 8px;
    gap: 0;
  }

  .template-builder-tab {
    padding: 12px 12px;
    font-size: 13px;
  }

  .template-builder-content {
    padding: 16px;
  }

  .template-editor {
    padding: 16px;
  }

  .template-search-input {
    width: 180px;
  }

  .template-toolbar {
    flex-direction: column;
    gap: 12px;
    align-items: stretch;
  }

  .template-toolbar-left,
  .template-toolbar-right {
    flex-direction: column;
    width: 100%;
  }

  .template-search-wrapper {
    width: 100%;
  }

  .template-search-input {
    width: 100%;
  }
}

@media (max-width: 480px) {
  .template-builder-tab {
    padding: 10px 8px;
    font-size: 12px;
  }

  .template-modal {
    max-width: 100%;
    max-height: 100vh;
    border-radius: 0;
  }

  .template-list-item-description {
    display: none;
  }

  .template-action-button {
    padding: 6px 12px;
    font-size: 13px;
  }
}

/* Animation for smooth transitions */
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(-8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.template-editor,
.template-list-item,
.template-modal {
  animation: fadeIn 0.2s ease-out;
}

/* Widget Picker Dropdown */
.widget-picker-container {
  position: relative;
  width: 100%;
}

.widget-picker-trigger {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
  padding: 6px 10px;
  font-size: 13px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  background: var(--background-primary);
  color: var(--text-normal);
  cursor: pointer;
  text-align: left;
  transition: border-color 0.15s ease;
}

.widget-picker-trigger:hover {
  border-color: var(--interactive-accent);
}

.widget-picker-trigger--placeholder {
  color: var(--text-muted);
}

.widget-picker-icon {
  flex-shrink: 0;
  margin-left: 8px;
  color: var(--text-muted);
  transition: transform 0.15s ease;
}

.widget-picker-icon--open {
  transform: rotate(180deg);
}

.widget-picker-dropdown {
  position: absolute;
  top: calc(100% + 4px);
  left: 0;
  right: 0;
  max-height: 400px;
  overflow-y: auto;
  background: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  z-index: 1000;
}

.widget-picker-category {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
  padding: 12px 14px;
  font-size: 10px;
  font-weight: 600;
  letter-spacing: 0.5px;
  text-transform: uppercase;
  color: var(--text-muted);
  background: var(--background-primary);
  position: sticky;
  top: 0;
  z-index: 1;
  border-bottom: none;
}

.widget-picker-category::before,
.widget-picker-category::after {
  content: '';
  flex: 1;
  height: 1px;
  background: var(--background-modifier-border);
}

.widget-picker-item {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  width: 100%;
  padding: 12px 14px;
  margin: 4px 0;
  text-align: left;
  background: transparent;
  border: none;
  cursor: pointer;
  box-sizing: border-box;
  gap: 0;
  transition: background 0.1s ease;
}

.widget-picker-item:first-child {
  margin-top: 4px;
}

.widget-picker-item:hover {
  background: var(--background-secondary);
}

.widget-picker-item-name {
  display: block;
  width: 100%;
  font-size: 13px;
  font-weight: 500;
  color: var(--text-normal);
}

.widget-picker-item-description {
  display: block;
  width: 100%;
  font-size: 11px;
  color: var(--text-muted);
  line-height: 1.3;
}
`});function yQe(){if(document.getElementById("library-tab-styles"))return;let e=document.createElement("style");e.id="library-tab-styles",e.textContent=`
		.library-tab {
			max-width: 800px;
			margin: 0 auto;
		}

		.library-section {
			margin-bottom: 32px;
		}

		.library-section-title {
			font-size: 18px;
			font-weight: 600;
			color: var(--text-normal);
			margin: 0 0 8px 0;
		}

		.library-code-textarea {
			font-family: 'Courier New', Courier, monospace;
			font-size: 12px;
			resize: vertical;
		}

		.library-preview {
			display: flex;
			align-items: flex-start;
			gap: 12px;
			padding: 16px;
			border-radius: 8px;
			margin-top: 16px;
		}

		.library-preview-success {
			background: rgba(var(--color-green-rgb, 76, 175, 80), 0.1);
			border: 1px solid rgba(var(--color-green-rgb, 76, 175, 80), 0.4);
		}

		.library-preview-error {
			background: rgba(var(--color-red-rgb, 233, 30, 99), 0.1);
			border: 1px solid rgba(var(--color-red-rgb, 233, 30, 99), 0.4);
		}

		.library-preview-icon {
			display: flex;
			align-items: center;
			justify-content: center;
			width: 24px;
			height: 24px;
			border-radius: 50%;
			font-weight: bold;
			font-size: 16px;
			flex-shrink: 0;
		}

		.library-preview-success .library-preview-icon {
			background: rgba(var(--color-green-rgb, 76, 175, 80), 0.9);
			color: white;
		}

		.library-preview-error .library-preview-icon {
			background: rgba(var(--color-red-rgb, 233, 30, 99), 0.9);
			color: white;
		}

		.library-preview-content {
			flex: 1;
		}

		.library-preview-title {
			font-weight: 600;
			color: var(--text-normal);
			margin-bottom: 4px;
		}

		.library-preview-details {
			font-size: 13px;
			color: var(--text-muted);
		}

		.library-preview-success .library-preview-title {
			color: rgba(var(--color-green-rgb, 76, 175, 80), 1);
		}

		.library-preview-error .library-preview-title {
			color: rgba(var(--color-red-rgb, 233, 30, 99), 1);
		}

		.library-preview-success .library-preview-details,
		.library-preview-error .library-preview-details {
			color: var(--text-normal);
		}

		.template-actions {
			display: flex;
			gap: 12px;
			margin-top: 16px;
		}

		.library-export-result {
			margin-top: 24px;
			padding: 20px;
			background: var(--background-secondary);
			border-radius: 8px;
			border: 1px solid var(--background-modifier-border);
		}

		.library-empty-state {
			padding: 24px;
			background: var(--background-secondary);
			border-radius: 8px;
			border: 1px dashed var(--background-modifier-border);
			text-align: center;
			margin-top: 16px;
		}

		.library-empty-state p {
			margin: 0;
			color: var(--text-muted);
		}

		.library-empty-state p:first-child {
			font-weight: 500;
			color: var(--text-normal);
			margin-bottom: 8px;
		}

		.library-empty-hint {
			font-size: 13px;
		}
	`,document.head.appendChild(e)}var Wt,vg,w1e,k1e=F(()=>{Wt=Y(Q()),vg=require("obsidian");x1e();LY();Tr();w1e=({plugin:e,reviewTemplateService:t,tradeTemplateService:r})=>{let[n,i]=(0,Wt.useState)(""),[a,o]=(0,Wt.useState)("idle"),[s,l]=(0,Wt.useState)(null),[c,d]=(0,Wt.useState)(null),[u,p]=(0,Wt.useState)(null),[m,g]=(0,Wt.useState)(null),[f]=(0,Wt.useState)(()=>new sj),[v,h]=(0,Wt.useState)([]);(0,Wt.useLayoutEffect)(()=>{lj(),yQe()},[]);let y=(0,Wt.useCallback)(()=>{let w=[],C=t.getTemplates("drc"),D=t.getTemplates("weekly"),P=t.getTemplates("monthly"),M=t.getTemplates("quarterly"),z=t.getTemplates("yearly");C.filter(I=>!I.isBuiltIn).forEach(I=>{w.push({id:I.id,name:I.name,type:"DRC",template:I})}),D.filter(I=>!I.isBuiltIn).forEach(I=>{w.push({id:I.id,name:I.name,type:"Weekly",template:I})}),P.filter(I=>!I.isBuiltIn).forEach(I=>{w.push({id:I.id,name:I.name,type:"Monthly",template:I})}),M.filter(I=>!I.isBuiltIn).forEach(I=>{w.push({id:I.id,name:I.name,type:"Quarterly",template:I})}),z.filter(I=>!I.isBuiltIn).forEach(I=>{w.push({id:I.id,name:I.name,type:"Yearly",template:I})}),r.getTemplates().filter(I=>!I.isBuiltIn).forEach(I=>{w.push({id:I.id,name:I.name,type:"Trade",template:I})}),h(w)},[t,r]);(0,Wt.useEffect)(()=>{y();let w=xe.subscribe("review-template:changed",y),C=xe.subscribe("trade-template:changed",y);return()=>{w(),C()}},[y]);let b=()=>{if(!n.trim()){o("idle"),l(null),d(null);return}o("validating"),l(null),d(null);let w=f.validateShareCode(n.trim());w.valid&&w.payload?(o("valid"),d({type:w.templateType||w.payload.type,name:w.templateName||w.payload.name})):(o("invalid"),l(w.error||"Invalid share code"))},k=async()=>{if(!(a!=="valid"||!n.trim()))try{let w=await f.importTemplate(n.trim(),t,r);new vg.Notice(`Template "${w.name}" imported successfully!`),i(""),o("idle"),l(null),d(null),y()}catch(w){let C=w instanceof Error?w.message:"Failed to import template";l(C),o("invalid"),new vg.Notice(C,5e3)}},x=()=>{if(!u){new vg.Notice("Please select a template to export");return}let w=v.find(C=>C.id===u);if(!w){new vg.Notice("Template not found");return}try{let C;w.type==="Trade"?C=f.exportTradeTemplate(w.template):C=f.exportReviewTemplate(w.template),g(C),new vg.Notice("Share code generated!")}catch(C){let D=C instanceof Error?C.message:"Failed to export template";new vg.Notice(D,5e3)}},S=async()=>{if(m)try{await navigator.clipboard.writeText(m),new vg.Notice("Share code copied to clipboard!")}catch(w){new vg.Notice("Failed to copy to clipboard",5e3)}};return Wt.default.createElement("div",{className:"library-tab"},Wt.default.createElement("div",{className:"library-section library-import"},Wt.default.createElement("h3",{className:"library-section-title"},"Import Template"),Wt.default.createElement("p",{className:"setting-item-description"},"Paste a JRT-v1 share code to import a template from another user."),Wt.default.createElement("div",{className:"template-form-field"},Wt.default.createElement("label",{className:"template-form-label"},"Share Code"),Wt.default.createElement("textarea",{className:"template-form-input library-code-textarea",placeholder:"Paste JRT-v1-... share code here",value:n,onChange:w=>{i(w.target.value),o("idle"),l(null),d(null)},rows:6})),Wt.default.createElement("div",{className:"template-actions"},Wt.default.createElement("button",{className:"template-action-button template-action-button--secondary",onClick:b,disabled:!n.trim()},a==="validating"?"Validating...":"Validate"),Wt.default.createElement("button",{className:"template-action-button template-action-button--primary",onClick:k,disabled:a!=="valid"},"Import Template")),a==="valid"&&c&&Wt.default.createElement("div",{className:"library-preview library-preview-success"},Wt.default.createElement("div",{className:"library-preview-icon"},"\u2713"),Wt.default.createElement("div",{className:"library-preview-content"},Wt.default.createElement("div",{className:"library-preview-title"},"Valid Template"),Wt.default.createElement("div",{className:"library-preview-details"},Wt.default.createElement("strong",null,c.name)," (",c.type,")"))),a==="invalid"&&s&&Wt.default.createElement("div",{className:"library-preview library-preview-error"},Wt.default.createElement("div",{className:"library-preview-icon"},"\u2717"),Wt.default.createElement("div",{className:"library-preview-content"},Wt.default.createElement("div",{className:"library-preview-title"},"Invalid Share Code"),Wt.default.createElement("div",{className:"library-preview-details"},s)))),Wt.default.createElement("hr",{style:{margin:"32px 0",border:"none",borderTop:"1px solid var(--background-modifier-border)"}}),Wt.default.createElement("div",{className:"library-section library-export"},Wt.default.createElement("h3",{className:"library-section-title"},"Export Template"),Wt.default.createElement("p",{className:"setting-item-description"},"Select a template to generate a share code that others can import."),v.length===0?Wt.default.createElement("div",{className:"library-empty-state"},Wt.default.createElement("p",null,"No custom templates to export."),Wt.default.createElement("p",{className:"library-empty-hint"},"Create a custom template in the Review or Trade Templates tabs first, then come back here to share it.")):Wt.default.createElement(Wt.default.Fragment,null,Wt.default.createElement("div",{className:"template-form-field"},Wt.default.createElement("label",{className:"template-form-label"},"Select Template"),Wt.default.createElement("select",{className:"template-form-input",value:u||"",onChange:w=>{p(w.target.value||null),g(null)}},Wt.default.createElement("option",{value:""},"-- Select a template --"),v.map(w=>Wt.default.createElement("option",{key:w.id,value:w.id},w.name," (",w.type,")")))),Wt.default.createElement("div",{className:"template-actions"},Wt.default.createElement("button",{className:"template-action-button template-action-button--primary",onClick:x,disabled:!u},"Generate Share Code"))),m&&Wt.default.createElement("div",{className:"library-export-result"},Wt.default.createElement("div",{className:"template-form-field"},Wt.default.createElement("label",{className:"template-form-label"},"Share Code"),Wt.default.createElement("textarea",{className:"template-form-input library-code-textarea",value:m,readOnly:!0,rows:6,onClick:w=>w.target.select()})),Wt.default.createElement("div",{className:"template-actions"},Wt.default.createElement("button",{className:"template-action-button template-action-button--secondary template-action-btn",onClick:S},"Copy to Clipboard")))))}});var vr,bQe,S1e,T1e=F(()=>{vr=Y(Q());Ot();nr();QTe();g1e();b1e();k1e();Nd();bf();Hp();Xw();dq();bQe=({leaf:e,view:t})=>{let r=Ae(),[n,i]=(0,vr.useState)(null),[a,o]=(0,vr.useState)(0),[s,l]=(0,vr.useState)(()=>localStorage.getItem("journalit-legacy-banner-dismissed")==="true"),[c,d]=(0,vr.useState)({drc:!1,weekly:!1,monthly:!1,trade:!1}),u=(0,vr.useMemo)(()=>r?new uo(r):null,[r]),p=(0,vr.useMemo)(()=>r?new il(r):null,[r]),m=(0,vr.useCallback)(()=>{u&&u.reload(),p&&p.reload(),o(b=>b+1)},[u,p]),g=(0,vr.useRef)(!1);(0,vr.useEffect)(()=>{async function b(){if(!r||!u)return;let k=new il(r),x=await u.hasLegacyNotes(),S=await k.hasLegacyNotes();if(d({...x,trade:S}),(x.drc||x.weekly||x.monthly)&&!g.current){let C=await mu(r.app,Zh),D=localStorage.getItem("journalit-migration-modal-dismissed")==="true";if(!C&&!D){g.current=!0;let P=new ev(r),M=await P.countLegacyNotes();new tg(r.app,M,async()=>{let z=new rg(r.app,M.total);z.open();let A=await P.migrateAll({backup:!0,onProgress:(E,T)=>{z.updateProgress(E,T)}});z.close();let I=await u.hasLegacyNotes(),L=await k.hasLegacyNotes();d({...I,trade:L}),new ng(r.app,{migrated:A.migrated,failed:A.failed,skipped:A.skipped,backupsCreated:A.migrated}).open()},()=>{localStorage.setItem("journalit-migration-modal-dismissed","true")}).open()}}}b()},[r,u]);let v=(c.drc||c.weekly||c.monthly||c.trade)&&!s,h=()=>{l(!0),localStorage.setItem("journalit-legacy-banner-dismissed","true")};if(!r||!u||!p)return vr.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"var(--text-muted)"}},"Loading Layout Builder...");let y=()=>n?n.type==="template"&&n.templateType==="trade"?vr.default.createElement(y1e,{plugin:r,tradeTemplateService:p,templateId:n.id,onTemplateChange:m}):n.type==="template"&&n.templateType&&n.templateType!=="trade"?vr.default.createElement(f1e,{plugin:r,templateService:u,templateId:n.id,templateType:n.templateType,onTemplateChange:m}):n.type==="library"?vr.default.createElement("div",{style:{height:"100%",overflow:"auto"}},vr.default.createElement(w1e,{plugin:r,reviewTemplateService:u,tradeTemplateService:p})):n.type==="snippet"?vr.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:"var(--text-muted)"}},"Snippet editor coming soon"):null:vr.default.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",color:"var(--text-muted)",gap:"12px"}},vr.default.createElement("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",opacity:"0.5"},vr.default.createElement("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),vr.default.createElement("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),vr.default.createElement("line",{x1:"9",y1:"21",x2:"9",y2:"9"})),vr.default.createElement("div",{style:{fontSize:"14px"}},"Select a template to edit"),vr.default.createElement("div",{style:{fontSize:"12px",opacity:.7}},"Or create a new one from the sidebar"));return vr.default.createElement("div",{style:{display:"flex",height:"100%",overflow:"hidden",background:"var(--background-primary)"}},vr.default.createElement(JTe,{plugin:r,templateService:u,selection:n,onSelectionChange:i,onTemplatesChange:m,refreshKey:a}),vr.default.createElement("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden",minWidth:0}},v&&vr.default.createElement("div",{style:{padding:"10px 16px",background:"var(--background-secondary)",borderBottom:"1px solid var(--background-modifier-border)",display:"flex",alignItems:"flex-start",gap:"12px",fontSize:"12px",flexShrink:0}},vr.default.createElement(Js,{size:16,style:{flexShrink:0,marginTop:"1px",color:"var(--color-yellow, #e0af48)"}}),vr.default.createElement("div",{style:{flex:1}},vr.default.createElement("div",{style:{fontWeight:500,marginBottom:"4px",color:"var(--text-normal)"}},"Legacy Notes Detected"),vr.default.createElement("div",{style:{color:"var(--text-muted)",lineHeight:1.4}},"Your vault contains notes created before the template system. They will continue to work with their original layout.",c.drc&&vr.default.createElement("span",{style:{display:"block"}},"- DRC notes"),c.weekly&&vr.default.createElement("span",{style:{display:"block"}},"- Weekly reviews"),c.monthly&&vr.default.createElement("span",{style:{display:"block"}},"- Monthly reviews"),c.trade&&vr.default.createElement("span",{style:{display:"block"}},"- Trade notes"))),vr.default.createElement(pn,{content:"Dismiss"},vr.default.createElement("button",{onClick:h,style:{background:"transparent",border:"none",cursor:"pointer",padding:"4px",color:"var(--text-muted)",flexShrink:0}},vr.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2"},vr.default.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),vr.default.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))))),vr.default.createElement("div",{style:{flex:1,overflow:"hidden"}},y())))},S1e=vr.default.memo(bQe)});var C1e,P1e,Om,cj,D1e=F(()=>{C1e=Y(Q()),P1e=require("obsidian");ch();T1e();LY();Om="journalit-template-builder-view";(0,P1e.addIcon)("lucide-blocks",'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="14" y="2" width="8" height="8" rx="1"/><path d="M10 22V7a1 1 0 0 0-1-1H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-5a1 1 0 0 0-1-1H2"/></svg>');cj=class extends nl{constructor(t,r){super(t,{containerClass:"journalit-template-builder-view-container",rootId:"journalit-template-builder-view"}),this.plugin=r}getViewType(){return Om}getDisplayText(){return"Layout Builder"}getIcon(){return"lucide-blocks"}async onOpen(){this.containerEl.addClass("react-view-container");try{await super.onOpen(),lj(),this.containerEl.addClass("journalit-template-builder-container")}catch(t){console.error("[TemplateBuilderView] Failed to initialize:",t)}}getRenderFunction(){return()=>C1e.default.createElement(S1e,{leaf:this.leaf,view:this})}}});var E1e={};Ti(E1e,{ACCOUNT_DASHBOARD_VIEW_TYPE:()=>yg,ViewManager:()=>NY});var yg,NY,I1e=F(()=>{iq();yke();gSe();DSe();AP();YTe();D1e();Wp();yg="account-dashboard",NY=class e{constructor(t){this.registeredViews=new Set;this.plugin=t}static getInstance(t){return e.instance||(e.instance=new e(t)),e.instance}async registerAllViews(){}async registerDashboardView(){if(!this.registeredViews.has(sd))try{let t=this.plugin.app.workspace.getLeavesOfType(sd);t.length>0&&(console.log("[Journalit] Cleaning up existing dashboard view leaves before registration"),t.forEach(r=>r.detach())),this.plugin.registerView(sd,r=>new yP(r)),this.registeredViews.add(sd),console.log("[Journalit] Dashboard view registered successfully")}catch(t){console.error("[Journalit] Failed to register dashboard view:",t)}}async registerAccountDashboardView(){if(!this.registeredViews.has(yg))try{let t=this.plugin.app.workspace.getLeavesOfType(yg);t.length>0&&(console.log("[Journalit] Cleaning up existing account dashboard view leaves before registration"),t.forEach(r=>r.detach())),this.plugin.registerView(yg,r=>new _z(r,this.plugin)),this.registeredViews.add(yg),console.log("[Journalit] Account dashboard view registered successfully")}catch(t){console.error("[Journalit] Failed to register account dashboard view:",t)}}async registerTradeLogView(){if(!this.registeredViews.has(Lm))try{let t=this.plugin.app.workspace.getLeavesOfType(Lm);t.length>0&&(console.log("[Journalit] Cleaning up existing trade log view leaves before registration"),t.forEach(r=>r.detach())),this.plugin.registerView(Lm,r=>new Uz(r,this.plugin)),this.registeredViews.add(Lm),console.log("[Journalit] Trade log view registered successfully")}catch(t){console.error("[Journalit] Failed to register trade log view:",t)}}async registerHomeView(){if(!this.registeredViews.has(es))try{let t=this.plugin.app.workspace.getLeavesOfType(es);t.length>0&&(console.log("[Journalit] Cleaning up existing home view leaves before registration"),t.forEach(r=>r.detach())),this.plugin.registerView(es,r=>new kO(r,this.plugin)),this.registeredViews.add(es),console.log("[Journalit] Home view registered successfully")}catch(t){console.error("[Journalit] Failed to register home view:",t)}}async registerCSVImportView(){if(!this.registeredViews.has(bp))try{this.plugin.app.workspace.getLeavesOfType(bp).length===0?(this.plugin.registerView(bp,r=>new ij(r,this.plugin)),this.registeredViews.add(bp)):this.registeredViews.add(bp)}catch(t){console.error("Error registering CSV import view:",t)}}async registerTradeFormView(){}async openDashboardView(){await this.registerDashboardView();let t=this.plugin.app.workspace.getLeavesOfType(sd);if(t.length>0){this.plugin.app.workspace.revealLeaf(t[0]),typeof this.plugin.trackRecentView=="function"&&this.plugin.trackRecentView(sd,"Trading Dashboard","grip");return}let r=this.plugin.app.workspace.getLeaf("tab");r&&(await r.setViewState({type:sd,active:!0}),this.plugin.app.workspace.revealLeaf(r),typeof this.plugin.trackRecentView=="function"&&this.plugin.trackRecentView(sd,"Trading Dashboard","grip"))}async openAccountDashboardView(){await this.registerAccountDashboardView();let t=this.plugin.app.workspace.getLeavesOfType(yg);if(t.length>0){this.plugin.app.workspace.revealLeaf(t[0]),typeof this.plugin.trackRecentView=="function"&&this.plugin.trackRecentView(yg,"Account Dashboard","users");return}let r=this.plugin.app.workspace.getLeaf("tab");r&&(await r.setViewState({type:yg,active:!0}),this.plugin.app.workspace.revealLeaf(r),typeof this.plugin.trackRecentView=="function"&&this.plugin.trackRecentView(yg,"Account Dashboard","users"))}async openTradeLogView(){await this.registerTradeLogView();let t=this.plugin.app.workspace.getLeavesOfType(Lm);if(t.length>0){this.plugin.app.workspace.revealLeaf(t[0]),typeof this.plugin.trackRecentView=="function"&&this.plugin.trackRecentView(Lm,"Trade Log","folder-tree");return}let r=this.plugin.app.workspace.getLeaf("tab");r&&(await r.setViewState({type:Lm,active:!0}),this.plugin.app.workspace.revealLeaf(r),typeof this.plugin.trackRecentView=="function"&&this.plugin.trackRecentView(Lm,"Trade Log","folder-tree"))}async openHomeView(){await this.registerHomeView();let t=this.plugin.app.workspace.getLeavesOfType(es);if(t.length>0){let n=t[0].view;if(n&&n.getViewType()===es){this.plugin.app.workspace.revealLeaf(t[0]);return}else console.log("[Journalit] Detaching broken home view leaf"),t[0].detach()}let r=this.plugin.app.workspace.getLeaf("tab");if(r)try{await r.setViewState({type:es,active:!0}),this.plugin.app.workspace.revealLeaf(r)}catch(n){throw console.error("[Journalit] Failed to open home view:",n),n}}async openCSVImportView(){await this.registerCSVImportView();let t=this.plugin.app.workspace.getLeavesOfType(bp);if(t.length>0){this.plugin.app.workspace.revealLeaf(t[0]),typeof this.plugin.trackRecentView=="function"&&this.plugin.trackRecentView(bp,"CSV Import","import");return}let r=this.plugin.app.workspace.getLeaf("tab");r&&(await r.setViewState({type:bp,active:!0}),this.plugin.app.workspace.revealLeaf(r),typeof this.plugin.trackRecentView=="function"&&this.plugin.trackRecentView(bp,"CSV Import","import"))}async registerAccountPageView(){if(!this.registeredViews.has(hp))try{let t=this.plugin.app.workspace.getLeavesOfType(hp);t.length>0&&(console.log("[Journalit] Cleaning up existing account page view leaves before registration"),t.forEach(r=>r.detach())),this.plugin.registerView(hp,r=>new Qk(r)),this.registeredViews.add(hp),console.log("[Journalit] Account page view registered successfully")}catch(t){console.error("[Journalit] Failed to register account page view:",t)}}async openAccountPageView(t){await this.registerAccountPageView();let r=this.plugin.app.workspace.getLeavesOfType(hp);for(let i of r){let a=i.view;if(a instanceof Qk&&typeof a.getAccountName=="function"&&a.getAccountName()===t){this.plugin.app.workspace.revealLeaf(i),typeof this.plugin.trackRecentView=="function"&&this.plugin.trackRecentView(hp,`Account: ${t}`,"user");return}}let n=this.plugin.app.workspace.getLeaf("tab");n&&(await n.setViewState({type:hp,active:!0,state:{accountName:t}}),this.plugin.app.workspace.revealLeaf(n),typeof this.plugin.trackRecentView=="function"&&this.plugin.trackRecentView(hp,`Account: ${t}`,"user"))}async closeAccountPageViews(t){let r=this.plugin.app.workspace.getLeavesOfType(hp);for(let n of r){let i=n.view;i instanceof Qk&&typeof i.getAccountName=="function"&&i.getAccountName()===t&&n.detach()}}async navigateToAccountDashboard(){await this.openAccountDashboardView()}async openTradeFormView(t){new Eo({app:this.plugin.app,plugin:this.plugin,isEditMode:!1,initialData:t||{},filePath:""}).open()}async openTradeFormInEditMode(t,r){new Eo({app:this.plugin.app,plugin:this.plugin,isEditMode:!0,initialData:t||{},filePath:r||""}).open()}async registerTemplateBuilderView(){if(!this.registeredViews.has(Om))try{let t=this.plugin.app.workspace.getLeavesOfType(Om);t.length>0&&(console.log("[Journalit] Cleaning up existing template builder view leaves before registration"),t.forEach(r=>r.detach())),this.plugin.registerView(Om,r=>new cj(r,this.plugin)),this.registeredViews.add(Om),console.log("[Journalit] Template builder view registered successfully")}catch(t){console.error("[Journalit] Failed to register template builder view:",t)}}async openTemplateBuilderView(){await this.registerTemplateBuilderView();let t=this.plugin.app.workspace.getLeavesOfType(Om);if(t.length>0){this.plugin.app.workspace.revealLeaf(t[0]),typeof this.plugin.trackRecentView=="function"&&this.plugin.trackRecentView(Om,"Layout Builder","lucide-blocks");return}let r=this.plugin.app.workspace.getLeaf("tab");r&&(await r.setViewState({type:Om,active:!0}),this.plugin.app.workspace.revealLeaf(r),typeof this.plugin.trackRecentView=="function"&&this.plugin.trackRecentView(Om,"Layout Builder","lucide-blocks"))}isViewRegistered(t){return this.registeredViews.has(t)}cleanupViews(){try{for(let t of this.registeredViews)this.plugin.app.workspace.getLeavesOfType(t).forEach(r=>{r.detach()});this.registeredViews.clear(),e.instance=null}catch(t){console.error("Error cleaning up views:",t)}}}});function CQe(e){if(!e||typeof e!="string")return null;let t=e.trim().toUpperCase();if(t.length===0)return null;for(let i of kQe)if(t.startsWith(i)){let a=t.substring(i.length);if(a.length===0)return{baseSymbol:i,isMicro:!0};let o=xQe.find(s=>a.startsWith(s));if(o){let s=a.substring(1),l=s&&/^\d{1,2}$/.test(s)?s:void 0;return{baseSymbol:i,monthCode:o,year:l,isMicro:!0}}return null}let r=t.match(SQe);if(r){let[,i,a,o]=r;return{baseSymbol:i,monthCode:a,year:o,isMicro:!1}}let n=t.match(TQe);return n?{baseSymbol:n[1],isMicro:!1}:null}function M1e(e){let t=CQe(e);return t?t.baseSymbol:e}var xQe,wQe,kQe,SQe,TQe,A1e=F(()=>{xQe=["F","G","H","J","K","M","N","Q","U","V","X","Z"],wQe=["M2K","MES","MNQ","MYM","MGC","MCL","M6E","M6B","M6J","M6A","M6C","M6S"],kQe=[...wQe].sort((e,t)=>t.length-e.length),SQe=/^(?=.*[A-Z])([A-Z0-9]{1,4})([FGHJKMNQUVXZ])(\d{1,2})$/,TQe=/^(?=.*[A-Z])([A-Z0-9]{1,4})$/});var FY={};Ti(FY,{InstrumentSpecService:()=>dj,default:()=>PQe});var dj,PQe,OY=F(()=>{uO();A1e();Tr();dj=class{constructor(t){this.plugin=t,this.customMappings=new Map,this.customInstrumentsCache=new Map,this.unsubscribeOptions=xe.subscribe("options:changed",()=>{this.refreshCustomInstrumentsCache()})}dispose(){var t;(t=this.unsubscribeOptions)==null||t.call(this),this.customMappings.clear(),this.customInstrumentsCache.clear()}loadMappings(){var n;let t=this.plugin,r=((n=t.settings)==null?void 0:n.symbolMappings)||[];this.customMappings.clear();for(let i of r)this.customMappings.set(i.importedSymbol.toUpperCase(),i.baseSymbol.toUpperCase());if(this.customInstrumentsCache.clear(),t.optionsService){let a=t.optionsService.getAllOptions().instrument||[];for(let o of a){let s=`${o.name.toUpperCase()}_${o.assetType}`;this.customInstrumentsCache.set(s,o)}}}refreshCustomInstrumentsCache(){let t=this.plugin;if(this.customInstrumentsCache.clear(),t.optionsService){let n=t.optionsService.getAllOptions().instrument||[];for(let i of n){let a=`${i.name.toUpperCase()}_${i.assetType}`;this.customInstrumentsCache.set(a,i)}}}getSpecsForSymbol(t,r){if(!t||!r)return null;let n=t.toUpperCase(),i=`${n}_${r}`,a=this.customInstrumentsCache.get(i);if(a){if(r==="futures"&&a.futuresData){let s=a.futuresData;if(s.dollarPerPoint&&s.dollarPerPoint>0&&s.tickSize&&s.tickSize>0&&s.tickValue&&s.tickValue>0)return{dollarPerPoint:s.dollarPerPoint,tickSize:s.tickSize,tickValue:s.tickValue,name:a.name,exchange:void 0}}else if(r==="forex"&&a.forexData){let s=a.forexData;if(s.lotSize&&s.lotSize>0&&s.pipValue&&s.pipValue>0&&s.pipSize&&s.pipSize>0)return{lotSize:s.lotSize,pipValue:s.pipValue,pipSize:s.pipSize,name:a.name}}}let o=r==="futures"?og:r==="forex"?sg:null;if(!o)return null;if(o[n])return o[n];if(this.customMappings.has(n)){let s=this.customMappings.get(n);if(o[s])return o[s];console.warn(`InstrumentSpecService: Custom mapping ${n} \u2192 ${s} points to non-existent symbol. Update mapping in Settings > Custom Options > Symbol Mappings.`)}if(r==="futures"){let s=M1e(n);if(s&&s!==n&&o[s])return o[s]}return null}async saveMapping(t,r,n){if(!(t!=null&&t.trim())||!(r!=null&&r.trim()))return console.warn("InstrumentSpecService: Both importedSymbol and baseSymbol are required"),!1;let i=t.trim().toUpperCase(),a=r.trim().toUpperCase();!og[a]&&!sg[a]&&console.warn(`InstrumentSpecService: Base symbol "${a}" not found in specs database. Mapping will be saved but lookups will fail. Available futures: ${Object.keys(og).join(", ")}. Available forex: ${Object.keys(sg).join(", ")}`);let o=this.plugin;o.settings.symbolMappings||(o.settings.symbolMappings=[]);let s=o.settings.symbolMappings.findIndex(u=>u.importedSymbol.toUpperCase()===i),l=s!==-1?o.settings.symbolMappings[s]:void 0,c=this.customMappings.get(i),d={importedSymbol:i,baseSymbol:a,autoDetected:n,dateCreated:new Date().toISOString()};this.customMappings.set(i,a),s!==-1?o.settings.symbolMappings[s]=d:o.settings.symbolMappings.push(d);try{return await o.saveSettings(),!0}catch(u){return console.error(`InstrumentSpecService: Failed to persist symbol mapping "${i}" -> "${a}":`,u),c!==void 0?this.customMappings.set(i,c):this.customMappings.delete(i),l!==void 0?o.settings.symbolMappings[s]=l:o.settings.symbolMappings.pop(),!1}}getAllMappings(){var r;return((r=this.plugin.settings)==null?void 0:r.symbolMappings)||[]}async deleteMapping(t){let r=t==null?void 0:t.trim();if(!r)return;let n=r.toUpperCase(),i=this.plugin;if(!i.settings.symbolMappings){this.customMappings.delete(n);return}let a=this.customMappings.get(n),o=[...i.settings.symbolMappings];this.customMappings.delete(n);let s=i.settings.symbolMappings.filter(l=>l.importedSymbol.toUpperCase()!==n);i.settings.symbolMappings=s;try{await i.saveSettings()}catch(l){throw console.error(`InstrumentSpecService: Failed to persist deletion of mapping "${n}":`,l),a!==void 0&&this.customMappings.set(n,a),i.settings.symbolMappings=o,l}}},PQe=dj});var uj,pj,L1e=F(()=>{uj=Y(Q()),pj=({url:e,label:t,iconRef:r})=>uj.default.createElement("button",{onClick:()=>window.open(e,"_blank"),style:{background:"var(--background-secondary)",color:"var(--text-normal)",border:"1px solid var(--background-modifier-border)",borderRadius:"6px",padding:"6px 12px",fontSize:"12px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",transition:"all 0.2s ease"},onMouseEnter:n=>{n.currentTarget.style.background="var(--background-modifier-hover)"},onMouseLeave:n=>{n.currentTarget.style.background="var(--background-secondary)"}},uj.default.createElement("span",{ref:r,style:{width:"14px",height:"14px",display:"flex",alignItems:"center",justifyContent:"center"}}),uj.default.createElement("span",null,t))});function O1e(e,t,r,n,i,a,o){new zY({app:e,plugin:t,oldPath:r,newPath:n,hasExistingTrades:i,onConfirm:a,onCancel:o||(()=>{}),onClose:()=>{}}).open()}var N1e,Kn,F1e,zY,DQe,z1e=F(()=>{N1e=require("obsidian"),Kn=Y(Q()),F1e=Y(Ni());Ot();hi();zY=class extends N1e.Modal{constructor(t){super(t.app),this.props=t}onOpen(){let{contentEl:t}=this;t.empty(),this.container=t.createDiv(),this.root=(0,F1e.createRoot)(this.container),this.root.render(Kn.default.createElement(DQe,{...this.props,onClose:()=>this.close()})),t.addClass("path-change-instruction-modal"),t.classList.add("jl-modal-container")}onClose(){this.root&&this.root.unmount()}},DQe=({app:e,plugin:t,oldPath:r,newPath:n,hasExistingTrades:i,onConfirm:a,onCancel:o,onClose:s})=>Kn.default.createElement("div",{style:{fontFamily:"var(--default-font)",fontSize:"14px",lineHeight:"1.5"}},Kn.default.createElement("div",{style:{display:"flex",alignItems:"center",marginBottom:"20px",paddingBottom:"15px",borderBottom:"1px solid var(--background-modifier-border)"}},Kn.default.createElement(Zm,{size:24,style:{marginRight:"10px",color:"var(--text-accent)"}}),Kn.default.createElement("h2",{style:{margin:0,color:"var(--text-normal)"}},"Journal Folder Location Changed")),Kn.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"20px",padding:"15px",backgroundColor:"var(--background-secondary)",borderRadius:"8px"}},Kn.default.createElement("code",{style:{padding:"4px 8px",backgroundColor:"var(--background-primary)",borderRadius:"4px",fontFamily:"var(--font-monospace)"}},r),Kn.default.createElement(XS,{size:16,style:{margin:"0 15px",color:"var(--text-muted)"}}),Kn.default.createElement("code",{style:{padding:"4px 8px",backgroundColor:"var(--background-primary)",borderRadius:"4px",fontFamily:"var(--font-monospace)"}},n)),Kn.default.createElement("div",{style:{marginBottom:"25px"}},Kn.default.createElement("div",{style:{display:"flex",alignItems:"flex-start",marginBottom:"15px",padding:"12px",backgroundColor:"var(--background-secondary)",borderRadius:"6px",border:"1px solid var(--color-accent)"}},Kn.default.createElement(Js,{size:16,style:{marginRight:"8px",marginTop:"2px",color:"var(--color-accent)",flexShrink:0}}),Kn.default.createElement("div",null,Kn.default.createElement("strong",{style:{color:"var(--text-normal)"}},"New trades will be created in your new folder location"),Kn.default.createElement("div",{style:{color:"var(--text-muted)",marginTop:"4px"}},"All future trading journals will use: ",Kn.default.createElement("code",{style:{fontSize:"12px",backgroundColor:"var(--background-primary)",padding:"2px 4px",borderRadius:"3px"}},n)))),i&&Kn.default.createElement("div",{style:{padding:"12px",backgroundColor:"var(--background-secondary)",borderRadius:"6px",marginBottom:"15px"}},Kn.default.createElement("strong",{style:{color:"var(--text-normal)",display:"block",marginBottom:"8px"}},"Manual Action Required:"),Kn.default.createElement("div",{style:{color:"var(--text-muted)",marginBottom:"8px"}},"You have existing trades in your current folder. To move them:"),Kn.default.createElement("ol",{style:{color:"var(--text-muted)",marginLeft:"16px",paddingLeft:"0"}},Kn.default.createElement("li",{style:{marginBottom:"4px"}},"Open your vault's file explorer"),Kn.default.createElement("li",{style:{marginBottom:"4px"}},"Find your ",Kn.default.createElement("code",{style:{fontSize:"12px",backgroundColor:"var(--background-primary)",padding:"2px 4px",borderRadius:"3px"}},"!Journalit")," folder"),Kn.default.createElement("li",{style:{marginBottom:"4px"}},"Drag and drop it to your new location when convenient")),Kn.default.createElement("div",{style:{color:"var(--text-muted)",fontSize:"13px",fontStyle:"italic",marginTop:"8px"}},"This gives you full control over when and how your files are moved.")),Kn.default.createElement("div",{style:{marginTop:"1em",padding:"0.75em",backgroundColor:"var(--background-secondary)",borderRadius:"4px"}},Kn.default.createElement("strong",null,"Sync Mapping Update:"),Kn.default.createElement("div",{style:{marginTop:"0.5em",fontSize:"0.9em"}},"The plugin will automatically update your trade sync mappings to reflect the new folder path. This ensures your synced trades remain connected to their backend records."))),Kn.default.createElement("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",borderTop:"1px solid var(--background-modifier-border)",paddingTop:"15px"}},Kn.default.createElement(Ie,{variant:"secondary",onClick:()=>{o(),s()},style:{minWidth:"80px"}},"Cancel"),Kn.default.createElement(Ie,{variant:"primary",onClick:()=>{a(),s()},style:{minWidth:"120px"}},"I Understand")))});var mj,j1e=F(()=>{mj=class{constructor(t,r){this.app=t;this.tradeService=r}getImageBasePaths(t,r){let n=new Set,i=this.app.metadataCache.getFileCache(t),a=i==null?void 0:i.frontmatter;if(!a)return n;let o=r.replace(/\/$/,"")+"/",s=c=>{if(typeof c!="string")return null;let d=c.match(/^(.+?)\/\d{4}\/(?:\d{2}\/)?(?:W\d+\/)?media\//);return d?d[1]:null},l=c=>{if(c!=null&&c.images&&Array.isArray(c.images)){for(let d of c.images)if(typeof d=="string"){let u=s(d);u&&n.add(u)}}};if(a.images&&Array.isArray(a.images)){for(let c of a.images)if(typeof c=="string"){let d=s(c);d&&n.add(d)}}if(a.type==="drc"){if(a.forecast&&typeof a.forecast=="object")for(let c of Object.keys(a.forecast)){if(c==="bias"||c==="levels"||c==="keyLevels")continue;let d=a.forecast[c];c==="customTimeframes"&&typeof d=="object"?Object.values(d).forEach(l):l(d)}a.endOfDayReview&&l(a.endOfDayReview),a.missedTrades&&Array.isArray(a.missedTrades)&&a.missedTrades.forEach(l)}if(a.type==="weekly-review"&&a.forecast&&typeof a.forecast=="object")for(let c of Object.keys(a.forecast)){let d=a.forecast[c];c==="customTimeframes"&&typeof d=="object"?Object.values(d).forEach(l):l(d)}if(o){let c=new Set;for(let d of n)d!==o.replace(/\/$/,"")&&c.add(d);return c}return n}updateImagesArray(t,r,n){if(!t||!Array.isArray(t))return{updated:[],hasChanges:!1};let i=t.filter(s=>typeof s=="string"),a=!1;return{updated:i.map(s=>s.startsWith(r)?(a=!0,s.replace(r,n)):s),hasChanges:a}}updateForecastSection(t,r,n){if(!t||typeof t!="object")return!1;let i=!1;if(t.images){let a=this.updateImagesArray(t.images,r,n);a.hasChanges&&(t.images=a.updated,i=!0)}return i}async updateImagePathsForAllTrades(t,r,n){let i={success:0,failed:0,updated:0,errors:[]},a=t.replace(/\/$/,"")+"/",o=r.replace(/\/$/,"")+"/",s=this.app.vault.getMarkdownFiles(),l=[];for(let m of s){let g=this.app.metadataCache.getFileCache(m),f=g==null?void 0:g.frontmatter,v=!1;if(f!=null&&f.images&&Array.isArray(f.images)&&(v=f.images.filter(y=>typeof y=="string").some(y=>y.startsWith(a))),!v&&(f==null?void 0:f.type)==="drc"){let h=y=>y!=null&&y.images&&Array.isArray(y.images)?y.images.some(b=>typeof b=="string"&&b.startsWith(a)):!1;if(f.forecast&&typeof f.forecast=="object")for(let y of Object.keys(f.forecast)){if(y==="bias"||y==="levels"||y==="keyLevels")continue;let b=f.forecast[y];if(y==="customTimeframes"&&typeof b=="object"?v=Object.values(b).some(h):v=h(b),v)break}!v&&f.endOfDayReview&&(v=h(f.endOfDayReview)),!v&&f.missedTrades&&Array.isArray(f.missedTrades)&&(v=f.missedTrades.some(y=>h(y)))}if(!v&&(f==null?void 0:f.type)==="weekly-review"){let h=y=>y!=null&&y.images&&Array.isArray(y.images)?y.images.some(b=>typeof b=="string"&&b.startsWith(a)):!1;if(f.forecast&&typeof f.forecast=="object")for(let y of Object.keys(f.forecast)){let b=f.forecast[y];if(y==="customTimeframes"&&typeof b=="object"?v=Object.values(b).some(h):v=h(b),v)break}}v&&l.push(m)}let c=l.length,d=0,u=10,p=5;for(let m=0;m<l.length;m+=u){let g=l.slice(m,m+u);await Promise.all(g.map(async f=>{try{let v=this.app.metadataCache.getFileCache(f),h=v==null?void 0:v.frontmatter,y=!1,b=[];if(h!=null&&h.images&&Array.isArray(h.images)){let w=this.updateImagesArray(h.images,a,o);w.hasChanges&&(y=!0,b=w.updated)}let k=(h==null?void 0:h.type)==="drc",x=(h==null?void 0:h.type)==="weekly-review",S=!1;await this.app.fileManager.processFrontMatter(f,w=>{var C;if(y&&(w.images=b,S=!0),k){let D=!1;if(w.forecast&&typeof w.forecast=="object")for(let P of Object.keys(w.forecast)){if(P==="bias"||P==="levels"||P==="keyLevels")continue;let M=w.forecast[P];if(P==="customTimeframes"&&typeof M=="object")for(let z of Object.keys(M))this.updateForecastSection(M[z],a,o)&&(D=!0);else this.updateForecastSection(M,a,o)&&(D=!0)}if((C=w.endOfDayReview)!=null&&C.images){let P=this.updateImagesArray(w.endOfDayReview.images,a,o);P.hasChanges&&(w.endOfDayReview.images=P.updated,D=!0)}if(w.missedTrades&&Array.isArray(w.missedTrades)){for(let P of w.missedTrades)if(P&&typeof P=="object"&&P.images){let M=this.updateImagesArray(P.images,a,o);M.hasChanges&&(P.images=M.updated,D=!0)}}D&&(S=!0)}if(x){let D=!1;if(w.forecast&&typeof w.forecast=="object")for(let P of Object.keys(w.forecast)){let M=w.forecast[P];if(P==="customTimeframes"&&typeof M=="object")for(let z of Object.keys(M))this.updateForecastSection(M[z],a,o)&&(D=!0);else this.updateForecastSection(M,a,o)&&(D=!0)}D&&(S=!0)}}),S&&i.updated++,i.success++,d++,n&&n(d,c)}catch(v){i.failed++;let h=v instanceof Error?v.message:String(v);i.errors.push(`${f.path}: ${h}`),d++,n&&n(d,c)}})),m+u<l.length&&await new Promise(f=>setTimeout(f,p))}return i}}});var zm,fj,jY,_Y,_1e=F(()=>{zm=require("obsidian");Vc();fj=class{constructor(t){this.plugin=t}async exportSettings(){try{let t={_exportedAt:new Date().toISOString(),_version:this.plugin.manifest.version,_pluginId:this.plugin.manifest.id,settings:this.plugin.settings},r=`journalit-settings-${new Date().toISOString().split("T")[0]}.json`,n=JSON.stringify(t,null,2),i=new Blob([n],{type:"application/json"}),a=URL.createObjectURL(i),o=document.createElement("a");o.href=a,o.download=r;try{document.body.appendChild(o),o.click()}finally{document.body.removeChild(o),URL.revokeObjectURL(a)}new zm.Notice(`Settings exported to ${r}`,5e3)}catch(t){console.error("Failed to export settings:",t),new zm.Notice("Failed to export settings. Check console for details.",5e3)}}async importSettings(t){try{let r=await t.text(),n=JSON.parse(r);if(!n.settings||typeof n.settings!="object")throw new Error("Invalid settings file: missing settings object");if(!this.isValidSettingsStructure(n.settings))throw new Error("Invalid settings file: does not appear to be Journalit settings");let i=this.deepMergeSettings(this.plugin.settings,n.settings);this.plugin.settings=i,await this.plugin.saveSettings(),document.dispatchEvent(new CustomEvent("journalit-settings-updated",{detail:{source:"SettingsExporter.import"}}));let a=n._version||"unknown";return new zm.Notice(`Settings imported successfully from v${a}. Restart Obsidian to apply all changes.`,1e4),!0}catch(r){return console.error("Failed to import settings:",r),new zm.Notice(`Failed to import settings: ${r instanceof Error?r.message:String(r)}`,5e3),!1}}async resetToDefaults(t){return new Promise(r=>{new jY(t,async i=>{if(i)try{let a=await this.createBackupBeforeReset();if(!a&&!await new Promise(l=>{new _Y(t,l).open()})){r(!1);return}this.plugin.settings=JSON.parse(JSON.stringify(Qn)),await this.plugin.saveSettings(),document.dispatchEvent(new CustomEvent("journalit-settings-updated",{detail:{source:"SettingsExporter.reset"}}));let o=a?"Settings reset to defaults. A backup was created. Restart Obsidian to apply all changes.":"Settings reset to defaults. No backup was created. Restart Obsidian to apply all changes.";new zm.Notice(o,1e4),r(!0)}catch(a){console.error("Failed to reset settings:",a),new zm.Notice("Failed to reset settings. Check console for details.",5e3),r(!1)}else r(!1)}).open()})}async createBackupBeforeReset(){try{let t=`${this.plugin.app.vault.configDir}/plugins/journalit/data.pre-reset-backup.json`;return await this.plugin.app.vault.adapter.write(t,JSON.stringify(this.plugin.settings,null,2)),console.log("Pre-reset backup created at:",t),!0}catch(t){return console.warn("Failed to create pre-reset backup:",t),!1}}isValidSettingsStructure(t){if(!t||typeof t!="object")return!1;let n=["general","trade"].every(a=>a in t),i=Object.keys(t).length>=2;return n&&i}deepMergeSettings(t,r){let n={...t};for(let i in r)if(Object.prototype.hasOwnProperty.call(r,i)){let a=t[i],o=r[i];o!==null&&typeof o=="object"&&!Array.isArray(o)&&a!==null&&typeof a=="object"&&!Array.isArray(a)?n[i]=this.deepMergeSettings(a,o):n[i]=o}return n}openImportFilePicker(){return new Promise(t=>{let r=document.createElement("input");r.type="file",r.accept=".json",r.onchange=n=>{var a;let i=(a=n.target.files)==null?void 0:a[0];t(i||null)},r.oncancel=()=>{t(null)},r.click()})}},jY=class extends zm.Modal{constructor(t,r){super(t),this.titleEl.setText("Reset Settings to Defaults?"),this.onConfirm=r}onOpen(){let{contentEl:t}=this;t.empty();let r=t.createDiv();r.style.cssText="padding: 20px; font-family: var(--default-font);";let n=r.createEl("p");n.textContent="This will reset ALL plugin settings to their default values. This includes:",n.style.cssText="margin: 0 0 16px 0; color: var(--text-normal); font-size: 14px; line-height: 1.5;";let i=r.createDiv();i.style.cssText="background: var(--background-secondary); padding: 12px; border-radius: 6px; margin-bottom: 16px;";let a=i.createEl("ul");a.style.cssText="margin: 0; padding-left: 20px; color: var(--text-muted); font-size: 13px; line-height: 1.6;",a.createEl("li",{text:"All custom options (tickers, setups, mistakes)"}),a.createEl("li",{text:"Account settings and metadata"}),a.createEl("li",{text:"Dashboard layouts"}),a.createEl("li",{text:"Symbol mappings"}),a.createEl("li",{text:"CSV templates"}),a.createEl("li",{text:"All other customizations"});let o=r.createEl("p");o.innerHTML="<strong>Note:</strong> A backup will be created before reset.",o.style.cssText="margin: 0 0 16px 0; color: var(--text-muted); font-size: 13px; line-height: 1.4;";let s=r.createDiv();s.style.cssText="background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); padding: 12px; border-radius: 6px; margin-bottom: 20px;";let l=s.createEl("p");l.textContent="This action cannot be undone (except by restoring from backup).",l.style.cssText="margin: 0; color: var(--text-normal); font-size: 13px; line-height: 1.5;";let c=r.createDiv();c.style.cssText="display: flex; justify-content: flex-end; gap: 10px; padding-top: 12px; border-top: 1px solid var(--background-modifier-border);";let d=c.createEl("button");d.textContent="Cancel",d.style.cssText="padding: 8px 16px; border: 1px solid var(--background-modifier-border); background: var(--background-primary); color: var(--text-normal); border-radius: 4px; cursor: pointer;",d.addEventListener("click",()=>{this.onConfirm(!1),this.close()});let u=c.createEl("button");u.textContent="Reset to Defaults",u.style.cssText="padding: 8px 20px; border: none; background: #ef4444; color: white; border-radius: 4px; cursor: pointer; font-weight: 500;",u.addEventListener("click",()=>{this.onConfirm(!0),this.close()})}onClose(){let{contentEl:t}=this;t.empty()}},_Y=class extends zm.Modal{constructor(t,r){super(t),this.titleEl.setText("Backup Failed"),this.onConfirm=r}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("p",{text:"Unable to create a backup of your current settings.",cls:"reset-warning-text"}),t.createEl("p",{text:"If you proceed with the reset, you will not be able to restore your current settings.",cls:"reset-warning-text mod-warning"});let r=t.createDiv({cls:"modal-button-container"});r.createEl("button",{text:"Cancel Reset"}).addEventListener("click",()=>{this.onConfirm(!1),this.close()}),r.createEl("button",{text:"Proceed Anyway",cls:"mod-warning"}).addEventListener("click",()=>{this.onConfirm(!0),this.close()})}onClose(){let{contentEl:t}=this;t.empty()}}});var pe,Cn,B1e,W1e=F(()=>{pe=Y(Q()),Cn=require("obsidian");pg();L1e();Zv();nv();xG();z1e();As();ZE();j1e();Tr();_1e();B1e=({plugin:e})=>{var q,V,J,K,G,X,te,re,Z,ne,se,ee,ie,ve,Se,Me,le,Ye,ue,We,Ke,Ze,St,Zr,Ee;e.settings.general||(e.settings.general={currency:"USD"});let[t,r]=(0,pe.useState)(0),[n,i]=(0,pe.useState)(((q=e.settings.general)==null?void 0:q.displayName)||""),[a,o]=(0,pe.useState)(!1),[s,l]=(0,pe.useState)(((V=e.settings.general)==null?void 0:V.journalFolderPath)||""),[c,d]=(0,pe.useState)(!1),[u,p]=(0,pe.useState)(!1),[m,g]=(0,pe.useState)(!1),[f,v]=(0,pe.useState)(!1),[h,y]=(0,pe.useState)(!1),b=(0,pe.useRef)(new fj(e));(0,pe.useEffect)(()=>{var ge;i(((ge=e.settings.general)==null?void 0:ge.displayName)||""),o(!1)},[(J=e.settings.general)==null?void 0:J.displayName,t]),(0,pe.useEffect)(()=>{var ge;l(((ge=e.settings.general)==null?void 0:ge.journalFolderPath)||"")},[(K=e.settings.general)==null?void 0:K.journalFolderPath,t]),(0,pe.useEffect)(()=>{var oe;let ge=!1;e.settings.trade.skipWeekends===void 0&&(e.settings.trade.skipWeekends=!0,ge=!0),e.settings.trade.tradingDayCutoffTime===void 0&&(e.settings.trade.tradingDayCutoffTime="00:00",ge=!0),e.settings.drc.autoCreateDRCOnNavigation===void 0&&(e.settings.drc.autoCreateDRCOnNavigation=!0,ge=!0),e.settings.weekly.autoCreateWeeklyReviewOnNavigation===void 0&&(e.settings.weekly.autoCreateWeeklyReviewOnNavigation=!0,ge=!0),((oe=e.settings.monthly)==null?void 0:oe.autoCreateMonthlyReviewOnNavigation)===void 0&&(e.settings.monthly?e.settings.monthly.autoCreateMonthlyReviewOnNavigation=!0:e.settings.monthly={reviewQuestions:[],customTimeframes:[],autoCreateOnFirstTrade:!0,autoCreateMonthlyReviewOnNavigation:!0},ge=!0),ge&&e.saveSettings()},[]);let k=[{value:"DDMMYY",label:"DD/MM/YY (31/12/23)"},{value:"MMDDYY",label:"MM/DD/YY (12/31/23)"},{value:"YYMMDD",label:"YY/MM/DD (23/12/31)"}],x=async ge=>{e.settings.trade.autoOpenCreatedTrades=ge,await e.saveSettings(),r(oe=>oe+1),new Cn.Notice(`Auto-open created trades ${ge?"enabled":"disabled"}`)},S=async ge=>{e.settings.trade.dateFormat=ge,await e.saveSettings(),new Cn.Notice(`Trade note date format changed to ${ge}`)},w=async ge=>{e.settings.trade.skipWeekends=ge,await e.saveSettings(),r(oe=>oe+1),new Cn.Notice(`Skip weekends ${ge?"enabled":"disabled"}`)},C=async ge=>{e.settings.trade.useDollarValueInput=ge,await e.saveSettings(),r(oe=>oe+1),new Cn.Notice(`Position size input: ${ge?"Dollar value":"Quantity"}`)},D=async ge=>{let oe=ge.target.value;e.settings.trade.tradingDayCutoffTime=oe,await e.saveSettings(),new Cn.Notice(`Trading day cutoff time changed to ${oe}`)},P=async ge=>{let oe=ge;e.settings.general?e.settings.general.currency=oe:e.settings.general={currency:oe};try{await e.saveSettings();let me=new CustomEvent("journalit-currency-changed",{detail:{currency:oe}});window.dispatchEvent(me),r(Ce=>Ce+1),new Cn.Notice(`\u2713 Currency changed to ${oe}. All components will update immediately!`)}catch(me){console.error("Failed to save currency setting:",me),new Cn.Notice("\u274C Failed to save currency setting. Please try again.",5e3),r(Ce=>Ce+1)}},M=ge=>{var oe;i(ge),o(ge!==(((oe=e.settings.general)==null?void 0:oe.displayName)||""))},z=async()=>{try{e.settings.general?e.settings.general.displayName=n:e.settings.general={currency:"USD",displayName:n},await e.saveSettings(),o(!1);let ge=new CustomEvent("journalit:display-name-changed",{detail:{displayName:n}});window.dispatchEvent(ge),new Cn.Notice(`Display name ${n?`saved as "${n}"`:"cleared"}`)}catch(ge){console.error("Failed to save display name:",ge),new Cn.Notice("\u274C Failed to save display name. Please try again.",5e3)}},A=()=>{var ge;i(((ge=e.settings.general)==null?void 0:ge.displayName)||""),o(!1)},I=XE(async ge=>{var cn,ia;let oe=await e.serviceManager.getBackendIntegrationService();if(oe!=null&&oe.getIsSyncing()){new Cn.Notice("Cannot change folder path while sync is in progress. Please wait for sync to complete.",5e3);let yr=await((cn=e.serviceManager)==null?void 0:cn.getFolderPathService()),Li=(yr==null?void 0:yr.journalFolderPath)||"!Journalit";l(Li);return}let me=await((ia=e.serviceManager)==null?void 0:ia.getFolderPathService()),Ce=(me==null?void 0:me.journalFolderPath)||"!Journalit";if(ge===Ce)return;let et=!1;try{let Li=e.app.vault.getMarkdownFiles(),Ua=Ce||"!Journalit";et=Li.some(io=>io.path.startsWith(Ua))}catch(yr){console.warn("Failed to check for existing trades:",yr)}let lt=Ce||"!Journalit",mt;!ge||ge.trim()===""?mt="!Journalit":mt=`${ge.endsWith("/")?ge.slice(0,-1):ge}/!Journalit`,O1e(e.app,e,lt,mt,et,async()=>{try{e.settings.general?e.settings.general.journalFolderPath=mt:e.settings.general={currency:"USD",journalFolderPath:mt},await e.saveSettings(),xe.publish("settings:changed",{}),l(mt),r(yr=>yr+1),new Cn.Notice(`\u2705 Journal folder path updated. New trades will be created in: ${mt}`)}catch(yr){console.error("Failed to update journal folder path:",yr),new Cn.Notice(`\u274C Failed to update path: ${yr.message}`),l(Ce)}},()=>{l(Ce)})},2e3,{leading:!1,trailing:!0}),L=async ge=>{e.settings.general?e.settings.general.homeStartupBehavior=ge:e.settings.general={currency:"USD",homeStartupBehavior:ge},await e.saveSettings(),r(me=>me+1);let oe={always:"Always open + focus",ifNone:"Only if no active file",never:"Never (manual only)"};new Cn.Notice(`Journalit startup behavior changed to: ${oe[ge]}`)},E=async ge=>{e.settings.home?e.settings.home.filterRecentItemsToJournalit=ge:e.settings.home={layouts:{},activeLayout:"Default",recentItems:[],filterRecentItemsToJournalit:ge},await e.saveSettings();let oe=e.uiStateManager.getState().recentItems||[];xe.publish("recent-items:changed",{recentItems:oe.map(me=>({path:me.path||me.viewType||"",timestamp:new Date(me.openedAt).getTime(),type:me.type}))}),r(me=>me+1),new Cn.Notice(`Filter recent items to Journalit files ${ge?"enabled":"disabled"}`)},T=async ge=>{var me,Ce;if(ge&&e.settings.trade.displayRMultiples){new Cn.Notice("Cannot enable Copy Trading PnL while R-multiples display is active. Please disable R-multiples first.",5e3);return}let oe=(Ce=(me=e.settings.trade)==null?void 0:me.showCopyTradingPnL)!=null?Ce:!1;e.settings.trade?e.settings.trade.showCopyTradingPnL=ge:e.settings.trade={autoOpenCreatedTrades:!0,dateFormat:"DDMMYY",skipWeekends:!0,showCopyTradingPnL:ge};try{await e.saveSettings(),r(et=>et+1),new Cn.Notice(`Copy Trading PnL ${ge?"enabled":"disabled"}`)}catch(et){console.error("Failed to save Copy Trading PnL setting:",et),new Cn.Notice("\u274C Failed to save Copy Trading PnL setting. Please try again.",5e3),e.settings.trade&&(e.settings.trade.showCopyTradingPnL=oe),r(lt=>lt+1)}},$=async ge=>{var et;let oe=Number(ge.target.value);e.settings.trade.breakEvenRangeMin=oe>0?-oe:oe;let me=(et=e.settings.trade.breakEvenRangeMax)!=null?et:0;(oe>0?-oe:oe)>me&&new Cn.Notice("Warning: Minimum value is greater than maximum value. This will prevent trades from being classified as breakeven.",5e3),await e.saveSettings(),r(lt=>lt+1),e.tradeService&&await e.tradeService.clearCache(),e.accountPageService&&await e.accountPageService.refreshAllAccountData()},_=async ge=>{var Ce;let oe=Number(ge.target.value);e.settings.trade.breakEvenRangeMax=oe,((Ce=e.settings.trade.breakEvenRangeMin)!=null?Ce:0)>oe&&new Cn.Notice("Warning: Minimum value is greater than maximum value. This will prevent trades from being classified as breakeven.",5e3),await e.saveSettings(),r(et=>et+1),e.tradeService&&await e.tradeService.clearCache(),e.accountPageService&&await e.accountPageService.refreshAllAccountData()},B=()=>{new Cn.Notice("Break even range updated - views will refresh on next load")},W=async ge=>{let oe=ge.target.value===""?0:Number(ge.target.value);e.settings.trade.defaultRiskAmount=oe,await e.saveSettings(),r(me=>me+1)},N=async ge=>{if(ge&&e.settings.trade.showCopyTradingPnL){new Cn.Notice("Cannot enable R-multiples while Copy Trading PnL is active. Please disable Copy Trading PnL first.",5e3);return}e.settings.trade.displayRMultiples=ge,await e.saveSettings(),r(oe=>oe+1),new Cn.Notice(`R-multiples display ${ge?"enabled":"disabled"}`)},U=[{value:"price",label:"Price levels"},{value:"dollar",label:"Dollar values"}],j=async ge=>{e.settings.trade.maeMfeInputMode=ge,await e.saveSettings(),r(oe=>oe+1)},R=(0,pe.useRef)(null),O=(0,pe.useRef)(null),H=(0,pe.useRef)(null);return(0,pe.useEffect)(()=>{R.current&&(0,Cn.setIcon)(R.current,"book-open"),O.current&&(0,Cn.setIcon)(O.current,"messages-square"),H.current&&(0,Cn.setIcon)(H.current,"github")},[]),pe.default.createElement("div",{className:"journalit-settings-tab general-settings"},pe.default.createElement("h3",null,"General Settings"),pe.default.createElement("div",{style:{display:"flex",gap:"8px",marginBottom:"12px",alignItems:"center"}},pe.default.createElement(pj,{url:"https://journalit.co/docs",label:"Docs",iconRef:R}),pe.default.createElement(pj,{url:"https://discord.gg/AkSw3D9h8b",label:"Discord",iconRef:O}),pe.default.createElement(pj,{url:"https://github.com/Cursivez/journalit",label:"GitHub",iconRef:H})),pe.default.createElement("div",{className:"setting-item"},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Currency"),pe.default.createElement("div",{className:"setting-item-description"},"Choose the currency to display for all monetary values throughout the plugin")),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement(Xi,{value:((G=e.settings.general)==null?void 0:G.currency)||"USD",onChange:P,options:CX(),id:"currency-dropdown","aria-label":"Select currency for displaying monetary values"}))),pe.default.createElement("div",{className:"setting-item"},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Display Name"),pe.default.createElement("div",{className:"setting-item-description"},'Optional name to display in the Journalit view welcome message (e.g., "Good morning, Alex")')),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px"}},pe.default.createElement("input",{type:"text",value:n,onChange:ge=>M(ge.target.value),onKeyDown:ge=>{ge.key==="Enter"&&a?(ge.preventDefault(),z()):ge.key==="Escape"&&(ge.preventDefault(),A())},placeholder:"Add new display name...","aria-label":"Display name for welcome message",style:{flex:"1",padding:"8px 12px",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",backgroundColor:"var(--background-primary)",color:"var(--text-normal)",fontSize:"14px"}}),a&&pe.default.createElement(pe.default.Fragment,null,pe.default.createElement("button",{onClick:z,"aria-label":"Confirm display name change",style:{padding:"6px 8px",border:"none",borderRadius:"4px",backgroundColor:"var(--interactive-accent)",color:"var(--text-on-accent)",cursor:"pointer",fontSize:"12px",minWidth:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center"}},"\u2713"),pe.default.createElement("button",{onClick:A,"aria-label":"Cancel display name change",style:{padding:"6px 8px",border:"none",borderRadius:"4px",backgroundColor:"var(--background-modifier-error)",color:"var(--text-normal)",cursor:"pointer",fontSize:"12px",minWidth:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center"}},"\u2715"))))),pe.default.createElement(ri,{title:"Home View Settings",defaultExpanded:!1},pe.default.createElement("div",{className:"setting-item"},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Home View Auto-Open"),pe.default.createElement("div",{className:"setting-item-description"},"Choose when to automatically open the Home view")),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement(Xi,{value:((X=e.settings.general)==null?void 0:X.homeStartupBehavior)||"always",onChange:L,options:[{value:"always",label:"Always open + focus (default)"},{value:"ifNone",label:"Only if no active file"},{value:"never",label:"Never (manual only)"}],id:"home-startup-behavior-dropdown","aria-label":"Select home startup behavior"}))),pe.default.createElement("div",{className:"setting-item"},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Filter Recent Items to Journalit Files"),pe.default.createElement("div",{className:"setting-item-description"},"Only show Journalit-related files in the Recent Items widget (files within the .journalit folder). Hides all other vault files from the recent items list.")),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement(la,{checked:(re=(te=e.settings.home)==null?void 0:te.filterRecentItemsToJournalit)!=null?re:!1,onChange:E,id:"filter-recent-items-toggle",ariaLabel:"Filter recent items to Journalit files"})))),pe.default.createElement(ri,{title:"Folder Location & Image Paths",defaultExpanded:!1},pe.default.createElement("div",{className:"setting-item"},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Journal Folder Location"),pe.default.createElement("div",{className:"setting-item-description"},"Choose where your trading journals are stored in your vault.",pe.default.createElement("br",null),"Leave empty to use the default root folder location.")),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement(zz,{selectedPath:s,onChange:I,placeholder:s?"Select custom folder...":"Default: Root folder (!Journalit)",app:e.app}))),pe.default.createElement("div",{className:"setting-item",style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid var(--background-modifier-border)"}},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Update Image Paths"),pe.default.createElement("div",{className:"setting-item-description"},"Updates image paths in all trades to match current folder location. Use this after manually moving your !Journalit folder.")),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement("button",{onClick:async()=>{var ge;p(!0);try{let me=(((ge=e.settings.general)==null?void 0:ge.journalFolderPath)||"!Journalit").replace(/\/$/,"")+"/",Ce=e.app.vault.getMarkdownFiles(),et=new Map,lt=new mj(e.app,e.tradeService);for(let yr of Ce){let Li=lt.getImageBasePaths(yr,me);Li.size>0&&et.set(yr.path,{file:yr,oldPaths:Li})}if(et.size===0){new Cn.Notice("All image paths already match current folder location"),p(!1);return}let mt=0,cn=0,ia=[];for(let[yr,{file:Li,oldPaths:Ua}]of et)try{for(let io of Ua){let ao=await lt.updateImagePathsForAllTrades(io,me.replace(/\/$/,""));if(ao.updated>0){mt++;break}ao.failed>0&&(cn+=ao.failed,ia.push(...ao.errors))}}catch(io){cn++,ia.push(`${yr}: ${io instanceof Error?io.message:String(io)}`)}ia.length>0?(new Cn.Notice(`Updated ${mt} trades with ${cn} errors. Check console for details.`,8e3),console.error("Image path update errors:",ia)):mt>0?new Cn.Notice(`Successfully updated image paths in ${mt} trades`,5e3):new Cn.Notice("No image paths needed updating",3e3)}catch(oe){console.error("Failed to update image paths:",oe),new Cn.Notice("Failed to update image paths. Check console for details.",5e3)}finally{p(!1)}},disabled:u,style:{padding:"8px 16px",border:"none",borderRadius:"4px",backgroundColor:u?"var(--background-modifier-border)":"var(--interactive-accent)",color:"var(--text-on-accent)",cursor:u?"not-allowed":"pointer",fontSize:"14px",fontWeight:"500",opacity:u?.6:1}},u?"Updating...":"Update Image Paths")))),pe.default.createElement(ri,{title:"Trade Settings",defaultExpanded:!0},pe.default.createElement("div",{className:"setting-item"},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Auto-open Created Trades"),pe.default.createElement("div",{className:"setting-item-description"},"Automatically open trade notes in a new tab after they are created")),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement(la,{checked:e.settings.trade.autoOpenCreatedTrades||!1,onChange:x,id:"auto-open-trades-toggle",ariaLabel:"Auto-open created trades"}))),pe.default.createElement("div",{className:"setting-item"},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Date Format"),pe.default.createElement("div",{className:"setting-item-description"},"Format for displaying dates throughout the plugin")),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement(Xi,{value:e.settings.trade.dateFormat,onChange:S,options:k,id:"date-format-dropdown","aria-label":"Select date format for trade notes"}))),pe.default.createElement("div",{className:"setting-item"},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Skip Weekends in Navigation"),pe.default.createElement("div",{className:"setting-item-description"},"Skip weekends when navigating between trading days (e.g., Friday \u2192 Monday)")),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement(la,{checked:(Z=e.settings.trade.skipWeekends)!=null?Z:!0,onChange:w,id:"skip-weekends-toggle",ariaLabel:"Skip weekends when navigating"}))),pe.default.createElement("div",{className:"setting-item"},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Enter Position Size as Dollar Value"),pe.default.createElement("div",{className:"setting-item-description"},"When enabled, enter position size as a dollar amount (e.g., $10,000) instead of quantity (shares/lots/contracts). The quantity will be calculated automatically from the price. Works best for stocks; futures/forex have contract multipliers that aren't accounted for.")),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement(la,{checked:(ne=e.settings.trade.useDollarValueInput)!=null?ne:!1,onChange:C,id:"dollar-value-input-toggle",ariaLabel:"Enter position size as dollar value"}))),pe.default.createElement("div",{className:"setting-item"},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Trading Day Cutoff Time"),pe.default.createElement("div",{className:"setting-item-description"},"Time that defines the end of a trading day. Trades after this time will be grouped with the next day. (24-hour format, e.g., 23:30 for 11:30 PM)")),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement("input",{type:"time",value:(se=e.settings.trade.tradingDayCutoffTime)!=null?se:"00:00",onChange:D,id:"trading-day-cutoff-time","aria-label":"Trading day cutoff time",className:"setting-input time-input",style:{padding:"8px",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",backgroundColor:"var(--background-primary)",color:"var(--text-normal)",width:"120px"}}))),pe.default.createElement("div",{className:"setting-item"},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Break Even Range"),pe.default.createElement("div",{className:"setting-item-description"},"Define a P&L range to consider trades as break even. For example, setting Min: -20 and Max: 20 will treat trades between -$20 and +$20 as break even. Set both to 0 to only consider exact $0.00 as break even. Minimum must be less than or equal to maximum.")),pe.default.createElement("div",{className:"setting-item-control",style:{display:"flex",gap:"8px",alignItems:"center"}},pe.default.createElement("input",{type:"number",value:(ee=e.settings.trade.breakEvenRangeMin)!=null?ee:0,onChange:$,onBlur:B,onFocus:ge=>{(parseFloat(ge.target.value)===0||ge.target.value==="0"||/^0\.0+$/.test(ge.target.value))&&ge.target.select()},placeholder:"Min","aria-label":"Break even range minimum",className:"setting-input",style:{padding:"8px",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",backgroundColor:"var(--background-primary)",color:"var(--text-normal)",width:"80px"}}),pe.default.createElement("span",{style:{color:"var(--text-muted)"}},"to"),pe.default.createElement("input",{type:"number",value:(ie=e.settings.trade.breakEvenRangeMax)!=null?ie:0,onChange:_,onBlur:B,onFocus:ge=>{(parseFloat(ge.target.value)===0||ge.target.value==="0"||/^0\.0+$/.test(ge.target.value))&&ge.target.select()},placeholder:"Max","aria-label":"Break even range maximum",className:"setting-input",style:{padding:"8px",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",backgroundColor:"var(--background-primary)",color:"var(--text-normal)",width:"80px"}}))),pe.default.createElement("div",{className:"setting-item",style:{marginTop:"16px",paddingTop:"16px",borderTop:"1px solid var(--background-modifier-border)"}},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Default Risk Amount"),pe.default.createElement("div",{className:"setting-item-description"},"Default risk amount (in account currency) used for R-multiple calculations. Leave empty to require manual entry per trade.")),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement("input",{type:"number",value:(ve=e.settings.trade.defaultRiskAmount)!=null?ve:0,onChange:W,onFocus:ge=>{(parseFloat(ge.target.value)===0||ge.target.value==="0"||/^0\.0+$/.test(ge.target.value))&&ge.target.select()},placeholder:"0.00","aria-label":"Default risk amount",className:"setting-input",style:{padding:"8px",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",backgroundColor:"var(--background-primary)",color:"var(--text-normal)",width:"80px"}}))),pe.default.createElement("div",{className:"setting-item"},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Display R-Multiples"),pe.default.createElement("div",{className:"setting-item-description"},"Show R-multiple values (risk-to-reward ratios) instead of currency amounts throughout the plugin")),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement(la,{checked:(Se=e.settings.trade.displayRMultiples)!=null?Se:!1,onChange:N,id:"display-r-multiples-toggle",ariaLabel:"Display R-multiples in trade views"}))),pe.default.createElement("div",{className:"setting-item"},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Show Copy Trading PnL"),pe.default.createElement("div",{className:"setting-item-description"},"Multiply displayed PnL by the number of accounts attached to each trade.",pe.default.createElement("br",null),"Useful for copy trading across multiple accounts.")),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement(la,{checked:(le=(Me=e.settings.trade)==null?void 0:Me.showCopyTradingPnL)!=null?le:!1,onChange:T,id:"copy-trading-pnl-toggle",ariaLabel:"Show Copy Trading PnL"}))),pe.default.createElement("div",{className:"setting-item"},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"MAE/MFE Input Mode"),pe.default.createElement("div",{className:"setting-item-description"},"Choose how to enter Maximum Adverse/Favorable Excursion values in the trade form.",pe.default.createElement("br",null),pe.default.createElement("strong",null,"Price levels:")," Enter the lowest/highest price reached during the trade.",pe.default.createElement("br",null),pe.default.createElement("strong",null,"Dollar values:")," Enter the max drawdown/profit in dollars directly.")),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement(Xi,{value:(ue=(Ye=e.settings.trade)==null?void 0:Ye.maeMfeInputMode)!=null?ue:"dollar",onChange:j,options:U,id:"mae-mfe-input-mode-dropdown","aria-label":"Select MAE/MFE input mode"})))),pe.default.createElement(ri,{title:"Notification Settings",defaultExpanded:!1},pe.default.createElement("div",{className:"setting-item"},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Sync Notifications"),pe.default.createElement("div",{className:"setting-item-description"},"Show notifications when sync operations complete")),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement(la,{checked:(Ke=(We=e.settings.backendIntegration)==null?void 0:We.showSyncNotifications)!=null?Ke:!0,onChange:async ge=>{e.settings.backendIntegration||(e.settings.backendIntegration={serverUrl:"https://api.journalit.co",syncEnabled:!0,userId:"",showSyncNotifications:!0,showNewTradeNotifications:!0,showUpdateNotifications:!0,lastSeenVersion:""}),e.settings.backendIntegration.showSyncNotifications=ge,await e.saveSettings(),r(oe=>oe+1),new Cn.Notice(`Sync notifications ${ge?"enabled":"disabled"}`)},id:"sync-notifications-toggle",ariaLabel:"Enable sync notifications"}))),pe.default.createElement("div",{className:"setting-item"},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"New Trade Notifications"),pe.default.createElement("div",{className:"setting-item-description"},"Show notifications when new trade files are detected")),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement(la,{checked:(St=(Ze=e.settings.backendIntegration)==null?void 0:Ze.showNewTradeNotifications)!=null?St:!0,onChange:async ge=>{e.settings.backendIntegration||(e.settings.backendIntegration={serverUrl:"https://api.journalit.co",syncEnabled:!0,userId:"",showSyncNotifications:!0,showNewTradeNotifications:!0,showUpdateNotifications:!0,lastSeenVersion:""}),e.settings.backendIntegration.showNewTradeNotifications=ge,await e.saveSettings(),r(oe=>oe+1),new Cn.Notice(`New trade notifications ${ge?"enabled":"disabled"}`)},id:"new-trade-notifications-toggle",ariaLabel:"Enable new trade notifications"}))),pe.default.createElement("div",{className:"setting-item"},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Show Update Notifications"),pe.default.createElement("div",{className:"setting-item-description"},"Display a notification when a new plugin update is available")),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement(la,{checked:(Ee=(Zr=e.settings.backendIntegration)==null?void 0:Zr.showUpdateNotifications)!=null?Ee:!0,onChange:async ge=>{e.settings.backendIntegration||(e.settings.backendIntegration={serverUrl:"https://api.journalit.co",syncEnabled:!0,userId:"",showSyncNotifications:!0,showNewTradeNotifications:!0,showUpdateNotifications:!0,lastSeenVersion:""}),e.settings.backendIntegration.showUpdateNotifications=ge,await e.saveSettings(),r(oe=>oe+1),new Cn.Notice(`Update notifications ${ge?"enabled":"disabled"}`)},id:"show-update-notifications-toggle",ariaLabel:"Show update notifications"})))),pe.default.createElement(ri,{title:"Data Management",defaultExpanded:!1},pe.default.createElement("div",{className:"setting-item"},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Export Settings"),pe.default.createElement("div",{className:"setting-item-description"},"Download all plugin settings as a JSON file for backup or transfer to another vault")),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement("button",{onClick:async()=>{g(!0);try{await b.current.exportSettings()}finally{g(!1)}},disabled:m,style:{padding:"8px 16px",border:"none",borderRadius:"4px",backgroundColor:m?"var(--background-modifier-border)":"var(--interactive-accent)",color:"var(--text-on-accent)",cursor:m?"not-allowed":"pointer",fontSize:"14px",fontWeight:"500",opacity:m?.6:1}},m?"Exporting...":"Export Settings"))),pe.default.createElement("div",{className:"setting-item"},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Import Settings"),pe.default.createElement("div",{className:"setting-item-description"},"Restore settings from a previously exported JSON file. Settings will be merged with current values.")),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement("button",{onClick:async()=>{v(!0);try{let ge=await b.current.openImportFilePicker();ge&&await b.current.importSettings(ge)&&r(me=>me+1)}finally{v(!1)}},disabled:f,style:{padding:"8px 16px",border:"none",borderRadius:"4px",backgroundColor:f?"var(--background-modifier-border)":"var(--interactive-accent)",color:"var(--text-on-accent)",cursor:f?"not-allowed":"pointer",fontSize:"14px",fontWeight:"500",opacity:f?.6:1}},f?"Importing...":"Import Settings"))),pe.default.createElement("div",{className:"setting-item",style:{marginTop:"16px",paddingTop:"16px",borderTop:"1px solid var(--background-modifier-border)"}},pe.default.createElement("div",{className:"setting-item-info"},pe.default.createElement("div",{className:"setting-item-name"},"Reset to Defaults"),pe.default.createElement("div",{className:"setting-item-description"},"Reset all plugin settings to their default values. A backup will be created automatically.",pe.default.createElement("br",null),pe.default.createElement("span",{style:{color:"var(--text-error)"}},"Warning: This will remove all custom options, account settings, and layouts."))),pe.default.createElement("div",{className:"setting-item-control"},pe.default.createElement("button",{onClick:async()=>{y(!0);try{await b.current.resetToDefaults(e.app)&&r(oe=>oe+1)}finally{y(!1)}},disabled:h,style:{padding:"8px 16px",border:"none",borderRadius:"4px",backgroundColor:h?"var(--background-modifier-border)":"var(--background-modifier-error)",color:"var(--text-on-accent)",cursor:h?"not-allowed":"pointer",fontSize:"14px",fontWeight:"500",opacity:h?.6:1}},h?"Resetting...":"Reset to Defaults")))))}});var Ts,$1e,gj,R1e=F(()=>{Ts=Y(Q()),$1e=require("obsidian");Jg();pg();Tr();gj=({plugin:e,items:t,defaultItems:r,settingsPath:n,placeholder:i,onItemsChange:a,settingsEventComponent:o})=>{let[s,l]=(0,Ts.useState)(""),c=(g,f)=>{let v=g.split("."),h={...e.settings},y=h;for(let b=0;b<v.length-1;b++)y[v[b]]||(y[v[b]]={}),y=y[v[b]];return y[v[v.length-1]]=f,h},d=async g=>{let f=c(n,g);e.settings=f,await e.saveSettings(),o&&xe.publish("settings:changed",{component:o,settings:n.split(".")[0]===o?e.settings[o]:e.settings}),a&&a(g)},u=async()=>{if(!s.trim())return;let g=[...t,s.trim()];await d(g),l("")},p=async g=>{let f=[...t];f.splice(g,1),await d(f)};return Ts.default.createElement("div",{className:"item-manager"},Ts.default.createElement("div",{className:"setting-item"},Ts.default.createElement("div",{className:"setting-item-info"},Ts.default.createElement("div",{className:"setting-item-control"},Ts.default.createElement(Ie,{onClick:async()=>{await d([...r]),new $1e.Notice("Reset items to defaults")},variant:"secondary"},"Reset to Defaults")))),t.map((g,f)=>Ts.default.createElement("div",{key:f,className:"setting-item custom-item"},Ts.default.createElement("div",{className:"setting-item-info"},Ts.default.createElement("div",{className:"setting-item-name"},g)),Ts.default.createElement("div",{className:"setting-item-control"},Ts.default.createElement(Ie,{onClick:()=>p(f)},"Remove")))),Ts.default.createElement("div",{className:"setting-item custom-item-add"},Ts.default.createElement("div",{className:"setting-item-info"},Ts.default.createElement(qa,{value:s,onChange:g=>l(g),placeholder:i})),Ts.default.createElement("div",{className:"setting-item-control"},Ts.default.createElement(Ie,{onClick:u,disabled:!s.trim()},"Add"))))}});var Pe,bg,U1e,H1e=F(()=>{Pe=Y(Q()),bg=require("obsidian");Zv();pg();Nd();bf();nv();R1e();Tr();U1e=({plugin:e})=>{var V,J,K,G,X,te,re,Z,ne,se,ee,ie,ve,Se,Me,le,Ye,ue,We,Ke,Ze,St,Zr;let t=(0,Pe.useMemo)(()=>new uo(e),[e]),r=(0,Pe.useMemo)(()=>new il(e),[e]),n=(0,Pe.useMemo)(()=>t.getTemplates("drc"),[t]),i=(0,Pe.useMemo)(()=>t.getTemplates("weekly"),[t]),a=(0,Pe.useMemo)(()=>t.getTemplates("monthly"),[t]),o=(0,Pe.useMemo)(()=>t.getTemplates("quarterly"),[t]),s=(0,Pe.useMemo)(()=>t.getTemplates("yearly"),[t]),l=(0,Pe.useMemo)(()=>r.getTemplates(),[r]),[c,d]=(0,Pe.useState)(((V=e.settings.templates)==null?void 0:V.defaultTrade)||((J=l[0])==null?void 0:J.id)||"builtin-trade-standard"),[u,p]=(0,Pe.useState)(((K=e.settings.templates)==null?void 0:K.defaultDrc)||((G=n[0])==null?void 0:G.id)||"builtin-drc-standard"),[m,g]=(0,Pe.useState)(((X=e.settings.templates)==null?void 0:X.defaultWeekly)||((te=i[0])==null?void 0:te.id)||"builtin-weekly-standard"),[f,v]=(0,Pe.useState)(((re=e.settings.templates)==null?void 0:re.defaultMonthly)||((Z=a[0])==null?void 0:Z.id)||"builtin-monthly-standard"),[h,y]=(0,Pe.useState)(((ne=e.settings.templates)==null?void 0:ne.defaultQuarterly)||((se=o[0])==null?void 0:se.id)||"builtin-quarterly-standard"),[b,k]=(0,Pe.useState)(((ee=e.settings.templates)==null?void 0:ee.defaultYearly)||((ie=s[0])==null?void 0:ie.id)||"builtin-yearly-standard"),[x,S]=(0,Pe.useState)(((ve=e.settings.drc)==null?void 0:ve.recurringGoals)||[]),[w,C]=(0,Pe.useState)(((Se=e.settings.weekly)==null?void 0:Se.recurringGoals)||[]),[D,P]=(0,Pe.useState)(((Me=e.settings.drc)==null?void 0:Me.checklistItems)||[]),[M,z]=(0,Pe.useState)(()=>{var Ee;return((Ee=e.settings.reviews)==null?void 0:Ee.globalAutoCreate)===void 0?(e.settings.reviews?e.settings.reviews.globalAutoCreate=!0:e.settings.reviews={globalAutoCreate:!0},!0):e.settings.reviews.globalAutoCreate}),[A,I]=(0,Pe.useState)(0);(0,Pe.useEffect)(()=>{let Ee=ge=>{var me;let oe=(me=ge.value)!=null?me:"";switch(ge.type){case"trade":d(oe);break;case"drc":p(oe);break;case"weekly":g(oe);break;case"monthly":v(oe);break;case"quarterly":y(oe);break;case"yearly":k(oe);break}};return xe.subscribe("default-template:changed",Ee)},[]);let L=(0,Pe.useMemo)(()=>l.map(Ee=>({value:Ee.id,label:Ee.name})),[l]),E=(0,Pe.useMemo)(()=>n.map(Ee=>({value:Ee.id,label:Ee.name})),[n]),T=(0,Pe.useMemo)(()=>i.map(Ee=>({value:Ee.id,label:Ee.name})),[i]),$=(0,Pe.useMemo)(()=>a.map(Ee=>({value:Ee.id,label:Ee.name})),[a]),_=(0,Pe.useMemo)(()=>o.map(Ee=>({value:Ee.id,label:Ee.name})),[o]),B=(0,Pe.useMemo)(()=>s.map(Ee=>({value:Ee.id,label:Ee.name})),[s]),W=async(Ee,ge)=>{switch(e.settings.templates||(e.settings.templates={defaultTrade:"builtin-trade-standard",defaultDrc:"builtin-drc-standard",defaultWeekly:"builtin-weekly-standard",defaultMonthly:"builtin-monthly-standard",defaultQuarterly:"builtin-quarterly-standard",defaultYearly:"builtin-yearly-standard"}),e.settings.templates[Ee]=ge,await e.saveSettings(),Ee){case"defaultTrade":d(ge);break;case"defaultDrc":p(ge);break;case"defaultWeekly":g(ge);break;case"defaultMonthly":v(ge);break;case"defaultQuarterly":y(ge);break;case"defaultYearly":k(ge);break}let oe=Ee.replace("default","").toLowerCase();xe.publish("default-template:changed",{type:oe,value:ge}),new bg.Notice("Default template updated")},N=()=>{let Ee=e.app.commands;Ee!=null&&Ee.executeCommandById?Ee.executeCommandById("journalit:open-layout-builder"):new bg.Notice("Layout Builder command not found")},U=async()=>{let Ee=!M;z(Ee),e.settings.reviews?e.settings.reviews.globalAutoCreate=Ee:e.settings.reviews={globalAutoCreate:Ee},e.settings.drc&&(e.settings.drc.autoCreateOnFirstTrade=Ee),e.settings.weekly&&(e.settings.weekly.autoCreateOnFirstTrade=Ee),e.settings.monthly&&(e.settings.monthly.autoCreateOnFirstTrade=Ee),e.settings.quarterly&&(e.settings.quarterly.autoCreateOnFirstTrade=Ee),e.settings.yearly&&(e.settings.yearly.autoCreateOnFirstTrade=Ee),await e.saveSettings(),I(ge=>ge+1),xe.publish("settings:changed",{component:"reviews",settings:e.settings.reviews}),new bg.Notice(`Auto-create for all reviews ${Ee?"enabled":"disabled"}`)},j=async Ee=>{e.settings.drc.autoCreateDRCOnNavigation=Ee,await e.saveSettings(),I(ge=>ge+1),new bg.Notice(`Auto-create DRC on navigation ${Ee?"enabled":"disabled"}`)},R=async Ee=>{e.settings.weekly.autoCreateWeeklyReviewOnNavigation=Ee,await e.saveSettings(),I(ge=>ge+1),new bg.Notice(`Auto-create Weekly Review on navigation ${Ee?"enabled":"disabled"}`)},O=async Ee=>{e.settings.monthly?e.settings.monthly.autoCreateMonthlyReviewOnNavigation=Ee:e.settings.monthly={reviewQuestions:[],customTimeframes:[],autoCreateOnFirstTrade:!0,autoCreateMonthlyReviewOnNavigation:Ee},await e.saveSettings(),I(ge=>ge+1),new bg.Notice(`Auto-create Monthly Review on navigation ${Ee?"enabled":"disabled"}`)},H=async Ee=>{e.settings.quarterly?e.settings.quarterly.autoCreateQuarterlyReviewOnNavigation=Ee:e.settings.quarterly={reviewQuestions:[],customTimeframes:[],autoCreateOnFirstTrade:!0,autoCreateQuarterlyReviewOnNavigation:Ee},await e.saveSettings(),I(ge=>ge+1),new bg.Notice(`Auto-create Quarterly Review on navigation ${Ee?"enabled":"disabled"}`)},q=async Ee=>{e.settings.yearly?e.settings.yearly.autoCreateYearlyReviewOnNavigation=Ee:e.settings.yearly={reviewQuestions:[],customTimeframes:[],autoCreateOnFirstTrade:!0,autoCreateYearlyReviewOnNavigation:Ee},await e.saveSettings(),I(ge=>ge+1),new bg.Notice(`Auto-create Yearly Review on navigation ${Ee?"enabled":"disabled"}`)};return Pe.default.createElement("div",{className:"journalit-settings-tab templates-settings"},Pe.default.createElement("div",{className:"templates-defaults-section"},Pe.default.createElement("h4",null,"Default Templates"),Pe.default.createElement("p",{className:"setting-item-description"},"Select which template to use when creating new notes. You can also set defaults in the Template Builder."),Pe.default.createElement("div",{className:"setting-item"},Pe.default.createElement("div",{className:"setting-item-info"},Pe.default.createElement("div",{className:"setting-item-name"},"Trade Template"),Pe.default.createElement("div",{className:"setting-item-description"},"Template used for new Trade Notes")),Pe.default.createElement("div",{className:"setting-item-control"},Pe.default.createElement(Xi,{value:c,onChange:Ee=>W("defaultTrade",Ee),options:L}))),Pe.default.createElement("div",{className:"setting-item"},Pe.default.createElement("div",{className:"setting-item-info"},Pe.default.createElement("div",{className:"setting-item-name"},"DRC Template"),Pe.default.createElement("div",{className:"setting-item-description"},"Template used for new Daily Report Cards")),Pe.default.createElement("div",{className:"setting-item-control"},Pe.default.createElement(Xi,{value:u,onChange:Ee=>W("defaultDrc",Ee),options:E}))),Pe.default.createElement("div",{className:"setting-item"},Pe.default.createElement("div",{className:"setting-item-info"},Pe.default.createElement("div",{className:"setting-item-name"},"Weekly Template"),Pe.default.createElement("div",{className:"setting-item-description"},"Template used for new Weekly Reviews")),Pe.default.createElement("div",{className:"setting-item-control"},Pe.default.createElement(Xi,{value:m,onChange:Ee=>W("defaultWeekly",Ee),options:T}))),Pe.default.createElement("div",{className:"setting-item"},Pe.default.createElement("div",{className:"setting-item-info"},Pe.default.createElement("div",{className:"setting-item-name"},"Monthly Template"),Pe.default.createElement("div",{className:"setting-item-description"},"Template used for new Monthly Reviews")),Pe.default.createElement("div",{className:"setting-item-control"},Pe.default.createElement(Xi,{value:f,onChange:Ee=>W("defaultMonthly",Ee),options:$}))),Pe.default.createElement("div",{className:"setting-item"},Pe.default.createElement("div",{className:"setting-item-info"},Pe.default.createElement("div",{className:"setting-item-name"},"Quarterly Template"),Pe.default.createElement("div",{className:"setting-item-description"},"Template used for new Quarterly Reviews")),Pe.default.createElement("div",{className:"setting-item-control"},Pe.default.createElement(Xi,{value:h,onChange:Ee=>W("defaultQuarterly",Ee),options:_}))),Pe.default.createElement("div",{className:"setting-item"},Pe.default.createElement("div",{className:"setting-item-info"},Pe.default.createElement("div",{className:"setting-item-name"},"Yearly Template"),Pe.default.createElement("div",{className:"setting-item-description"},"Template used for new Yearly Reviews")),Pe.default.createElement("div",{className:"setting-item-control"},Pe.default.createElement(Xi,{value:b,onChange:Ee=>W("defaultYearly",Ee),options:B})))),Pe.default.createElement("hr",null),Pe.default.createElement("div",{className:"template-builder-section"},Pe.default.createElement("h4",null,"Template Builder"),Pe.default.createElement("p",{className:"setting-item-description"},"Create, edit, and manage your templates visually. The Builder View allows you to drag-and-drop sections, configure options, and preview your templates in real-time."),Pe.default.createElement("button",{className:"mod-cta",onClick:N,style:{marginTop:"12px"}},"Open Template Builder")),Pe.default.createElement("hr",null),Pe.default.createElement(ri,{title:"Recurring Goals",defaultExpanded:!1},Pe.default.createElement("p",{className:"setting-item-description",style:{marginBottom:"12px"}},"Define goals that automatically appear on every new review. These are copied when the review is created, and can be edited per-review."),Pe.default.createElement("h5",{style:{marginTop:"16px",marginBottom:"8px",color:"var(--text-muted)"}},"Daily Goals"),Pe.default.createElement(gj,{plugin:e,items:x,defaultItems:[],settingsPath:"drc.recurringGoals",placeholder:"Add a recurring daily goal...",onItemsChange:S,settingsEventComponent:"drc"}),Pe.default.createElement("h5",{style:{marginTop:"16px",marginBottom:"8px",color:"var(--text-muted)"}},"Weekly Goals"),Pe.default.createElement(gj,{plugin:e,items:w,defaultItems:[],settingsPath:"weekly.recurringGoals",placeholder:"Add a recurring weekly goal...",onItemsChange:C,settingsEventComponent:"weekly"})),Pe.default.createElement(ri,{title:"Pre-Trade Checklist",defaultExpanded:!1},Pe.default.createElement("p",{className:"setting-item-description",style:{marginBottom:"12px"}},"Define checklist items that automatically appear on every new Daily Report Card. These are copied to each DRC when created, and can be edited per-day."),Pe.default.createElement(gj,{plugin:e,items:D,defaultItems:[],settingsPath:"drc.checklistItems",placeholder:"Add a checklist item...",onItemsChange:P,settingsEventComponent:"drc"})),Pe.default.createElement(ri,{title:"Auto-Create Reviews",defaultExpanded:!1},Pe.default.createElement("div",{className:"setting-item"},Pe.default.createElement("div",{className:"setting-item-info"},Pe.default.createElement("div",{className:"setting-item-name"},"Global Auto-Create Reviews"),Pe.default.createElement("div",{className:"setting-item-description"},"Automatically create reviews when the first trade of the corresponding period is recorded. This setting applies to daily, weekly, monthly, quarterly, and yearly reviews.")),Pe.default.createElement("div",{className:"setting-item-control"},Pe.default.createElement(la,{checked:M,onChange:U,id:"global-auto-create-toggle",ariaLabel:"Global auto-create reviews"}))),Pe.default.createElement("div",{className:"setting-item"},Pe.default.createElement("div",{className:"setting-item-info"},Pe.default.createElement("div",{className:"setting-item-name"},"Auto-create DRC on Navigation"),Pe.default.createElement("div",{className:"setting-item-description"},"Automatically create a new Daily Report Card when navigating to a day that doesn't have one")),Pe.default.createElement("div",{className:"setting-item-control"},Pe.default.createElement(la,{checked:(le=e.settings.drc.autoCreateDRCOnNavigation)!=null?le:!0,onChange:j,id:"auto-create-drc-navigation-toggle",ariaLabel:"Auto-create DRC on navigation"}))),Pe.default.createElement("div",{className:"setting-item"},Pe.default.createElement("div",{className:"setting-item-info"},Pe.default.createElement("div",{className:"setting-item-name"},"Auto-create Weekly Review on Navigation"),Pe.default.createElement("div",{className:"setting-item-description"},"Automatically create a new Weekly Review when navigating to a week that doesn't have one")),Pe.default.createElement("div",{className:"setting-item-control"},Pe.default.createElement(la,{checked:(Ye=e.settings.weekly.autoCreateWeeklyReviewOnNavigation)!=null?Ye:!0,onChange:R,id:"auto-create-weekly-review-navigation-toggle",ariaLabel:"Auto-create Weekly Review on navigation"}))),Pe.default.createElement("div",{className:"setting-item"},Pe.default.createElement("div",{className:"setting-item-info"},Pe.default.createElement("div",{className:"setting-item-name"},"Auto-create Monthly Review on Navigation"),Pe.default.createElement("div",{className:"setting-item-description"},"Automatically create a new Monthly Review when navigating to a month that doesn't have one")),Pe.default.createElement("div",{className:"setting-item-control"},Pe.default.createElement(la,{checked:(We=(ue=e.settings.monthly)==null?void 0:ue.autoCreateMonthlyReviewOnNavigation)!=null?We:!0,onChange:O,id:"auto-create-monthly-review-navigation-toggle",ariaLabel:"Auto-create Monthly Review on navigation"}))),Pe.default.createElement("div",{className:"setting-item"},Pe.default.createElement("div",{className:"setting-item-info"},Pe.default.createElement("div",{className:"setting-item-name"},"Auto-create Quarterly Review on Navigation"),Pe.default.createElement("div",{className:"setting-item-description"},"Automatically create a new Quarterly Review when navigating to a quarter that doesn't have one")),Pe.default.createElement("div",{className:"setting-item-control"},Pe.default.createElement(la,{checked:(Ze=(Ke=e.settings.quarterly)==null?void 0:Ke.autoCreateQuarterlyReviewOnNavigation)!=null?Ze:!0,onChange:H,id:"auto-create-quarterly-review-navigation-toggle",ariaLabel:"Auto-create Quarterly Review on navigation"}))),Pe.default.createElement("div",{className:"setting-item"},Pe.default.createElement("div",{className:"setting-item-info"},Pe.default.createElement("div",{className:"setting-item-name"},"Auto-create Yearly Review on Navigation"),Pe.default.createElement("div",{className:"setting-item-description"},"Automatically create a new Yearly Review when navigating to a year that doesn't have one")),Pe.default.createElement("div",{className:"setting-item-control"},Pe.default.createElement(la,{checked:(Zr=(St=e.settings.yearly)==null?void 0:St.autoCreateYearlyReviewOnNavigation)!=null?Zr:!0,onChange:q,id:"auto-create-yearly-review-navigation-toggle",ariaLabel:"Auto-create Yearly Review on navigation"})))))}});var Xr,q1e,V1e,G1e=F(()=>{Xr=Y(Q()),q1e=require("obsidian");oV();hi();nv();Bu();V1e=({plugin:e})=>{var u;let[t,r]=(0,Xr.useState)(e.authManager.getAuthState()),[n,i]=(0,Xr.useState)(e.authManager.getSubscriptionTier()),[a,o]=(0,Xr.useState)(e.authManager.isAuthenticated());(0,Xr.useEffect)(()=>{let p=()=>{r(e.authManager.getAuthState()),i(e.authManager.getSubscriptionTier()),o(e.authManager.isAuthenticated())};return dv.on(uv.STATE_CHANGED,p),()=>{dv.off(uv.STATE_CHANGED,p)}},[e]);let s=async()=>{if(!a)try{await e.authManager.authenticate()}catch(p){let m={operation:"authenticate user",endpoint:"/api/v1/auth/login",statusCode:Be.extractStatusCode(p)};Be.handleError(p,m)}},l=async()=>{try{await e.authManager.logout(),new q1e.Notice("Successfully signed out")}catch(p){let m={operation:"sign out user",endpoint:"/api/v1/auth/logout",statusCode:Be.extractStatusCode(p)};Be.handleError(p,m)}},c=p=>{switch(p==null?void 0:p.toLowerCase()){case"free":return"Free plan with basic features.";case"pro":return"Pro plan with advanced analytics and unlimited storage.";case"enterprise":return"Enterprise plan with full feature access and priority support.";default:return"Subscription status unknown."}},d=()=>{var p;if((p=t.cache)!=null&&p.graceEnd){let m=new Date(t.cache.graceEnd),g=new Date,f=m.getTime()-g.getTime(),v=Math.ceil(f/(1e3*60*60*24));return Math.max(0,v)}return 0};return Xr.default.createElement("div",{className:"trading-journal-settings-container"},Xr.default.createElement("h3",null,"Authentication"),Xr.default.createElement("p",{className:"setting-item-description"},"Manage authentication and connection settings."),Xr.default.createElement(ri,{title:"Authentication",defaultExpanded:!0},Xr.default.createElement("div",{className:"setting-item"},Xr.default.createElement("div",{className:"setting-item-info"},Xr.default.createElement("div",{className:"setting-item-name"},"Status"),Xr.default.createElement("div",{className:"setting-item-description"},"Current connection and subscription status")),Xr.default.createElement("div",{className:"setting-item-control"},Xr.default.createElement("input",{type:"text",value:`${t.isOffline?"Offline (Grace Period)":"Online"}${n?` - ${n.charAt(0).toUpperCase()+n.slice(1)} Plan`:""}`,disabled:!0,className:"status-text"}))),Xr.default.createElement("div",{className:"setting-item"},Xr.default.createElement("div",{className:"setting-item-info"},Xr.default.createElement("div",{className:"setting-item-name"},"Authentication"),Xr.default.createElement("div",{className:"setting-item-description"},"Sign in to access your trading journal")),Xr.default.createElement("div",{className:"setting-item-control"},Xr.default.createElement(Ie,{variant:"primary",onClick:s,className:a?"connected":"login-button"},a?"Signed In":"Sign In / Sign Up"))),a&&Xr.default.createElement("div",{className:"setting-item"},Xr.default.createElement("div",{className:"setting-item-info"},Xr.default.createElement("div",{className:"setting-item-name"},"Sign Out"),Xr.default.createElement("div",{className:"setting-item-description"},"Sign out of your account")),Xr.default.createElement("div",{className:"setting-item-control"},Xr.default.createElement(Ie,{variant:"danger",onClick:l,className:"signout"},"Sign Out"))),a&&n&&Xr.default.createElement(Xr.default.Fragment,null,Xr.default.createElement("h4",null,"Subscription Features"),Xr.default.createElement("div",{className:"setting-item-description subscription-desc"},c(n))),t.error&&Xr.default.createElement("div",{className:"trading-journal-error"},"Error: ",t.error),t.isOffline&&Xr.default.createElement("div",{className:"trading-journal-warning"},Xr.default.createElement("strong",null,"Offline Mode"),Xr.default.createElement("p",null,"Operating in offline mode. Some features may be limited. Will automatically sync when online."),((u=t.cache)==null?void 0:u.graceEnd)&&Xr.default.createElement("p",null,"Grace period ends in ",d()," days"))))}});var fe,no,BY,WY,Y1e,bv,K1e=F(()=>{fe=Y(Q());Ot();no=require("obsidian");Bu();ds();cf();hi();bG();BY=class extends no.Modal{constructor(r,n,i){super(r);this.message=n;this.onConfirm=i}onOpen(){let{contentEl:r}=this;r.createEl("p",{text:this.message});let n=r.createDiv({cls:"modal-button-container"});n.createEl("button",{text:"OK (Update Notes)",cls:"mod-cta"}).addEventListener("click",()=>{this.close(),this.onConfirm(!0)}),n.createEl("button",{text:"Save Name Only"}).addEventListener("click",()=>{this.close(),this.onConfirm(!1)}),n.createEl("button",{text:"Cancel Action"}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:r}=this;r.empty()}},WY=class extends no.Modal{constructor(r,n,i){super(r);this.message=n;this.onConfirm=i}onOpen(){let{contentEl:r}=this;r.createEl("p",{text:this.message});let n=r.createDiv({cls:"modal-button-container"});n.createEl("button",{text:"Reset",cls:"mod-warning"}).addEventListener("click",()=>{this.close(),this.onConfirm()}),n.createEl("button",{text:"Cancel"}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:r}=this;r.empty()}},Y1e=["gray","red","orange","yellow"],bv=({plugin:e,filterType:t,showSymbolMappings:r=!1})=>{let[n,i]=(0,fe.useState)({}),[a,o]=(0,fe.useState)({}),[s,l]=(0,fe.useState)(e.optionsService),[c,d]=(0,fe.useState)({}),[u,p]=(0,fe.useState)("stock"),[m,g]=(0,fe.useState)({dollarPerPoint:"",tickSize:"",tickValue:"",lotSize:"",pipValue:"",pipSize:""}),[f,v]=(0,fe.useState)("gray"),[h,y]=(0,fe.useState)([]),[b,k]=(0,fe.useState)({importedSymbol:"",baseSymbol:""});(0,fe.useEffect)(()=>{(async()=>{await s.reloadOptions();let U=s.getAllOptions();i(U);let j={};Object.entries(U).forEach(([R,O])=>{j[R]={},R==="instrument"?O.forEach(H=>{var V,J,K,G,X,te;let q={text:H.name,isEditing:!1,editValue:H.name,editAssetType:H.assetType};H.assetType==="futures"&&H.futuresData&&(q.editDollarPerPoint=((V=H.futuresData.dollarPerPoint)==null?void 0:V.toString())||"",q.editTickSize=((J=H.futuresData.tickSize)==null?void 0:J.toString())||"",q.editTickValue=((K=H.futuresData.tickValue)==null?void 0:K.toString())||""),H.assetType==="forex"&&H.forexData&&(q.editLotSize=((G=H.forexData.lotSize)==null?void 0:G.toString())||"",q.editPipValue=((X=H.forexData.pipValue)==null?void 0:X.toString())||"",q.editPipSize=((te=H.forexData.pipSize)==null?void 0:te.toString())||""),j[R][H.name]=q}):R==="event"?O.forEach(H=>{j[R][H.name]={text:H.name,isEditing:!1,editValue:H.name,editColor:H.color||"gray"}}):O.forEach(H=>{j[R][H]={text:H,isEditing:!1,editValue:H}})}),o(j)})()},[e,s]),(0,fe.useEffect)(()=>{e.specService.loadMappings(),y(e.specService.getAllMappings())},[e]);let x=N=>{switch(N){case"instrument":return"Tickers";case"account":return"Accounts";case"account_type":return"Account Types";case"setup":return"Setups";case"mistake":return"Mistakes";case"tag":return"Tags";case"event":return"Events";default:return N}},S=N=>{switch(N){case"stock":return"Stock";case"options":return"Options";case"futures":return"Futures";case"forex":return"Forex";case"crypto":return"Crypto";case"cfd":return"CFD";default:return N.charAt(0).toUpperCase()+N.slice(1)}},w=(N,U)=>{N==="account_type"&&U.toLowerCase()==="archived"||(o(j=>{var V,J;let R=j[N]||{},O=R[U]||{text:U,isEditing:!1,editValue:U},H,q={...O};if(N==="instrument"){let K=n.instrument.find(G=>G.name===U);if(H=(K==null?void 0:K.assetType)||"stock",H==="futures"||H==="forex"){let G=e.specService.getSpecsForSymbol(U,H),X=H==="futures"?(K==null?void 0:K.futuresData)&&((V=K.futuresData.dollarPerPoint)!=null?V:0)>0:(K==null?void 0:K.forexData)&&((J=K.forexData.lotSize)!=null?J:0)>0;G&&!X&&(H==="futures"&&"dollarPerPoint"in G?(q.editDollarPerPoint=G.dollarPerPoint.toString(),q.editTickSize=G.tickSize.toString(),q.editTickValue=G.tickValue.toString()):H==="forex"&&"lotSize"in G&&(q.editLotSize=G.lotSize.toString(),q.editPipValue=G.pipValue.toString(),q.editPipSize=G.pipSize.toString()))}}return{...j,[N]:{...R,[U]:{...q,isEditing:!0,editValue:U,editAssetType:H}}}}),setTimeout(()=>{let j=document.querySelector(`.option-edit-input[data-option="${CSS.escape(U)}"]`);j&&(j.focus({preventScroll:!0}),j.select())},50))},C=(N,U)=>{o(j=>{let R=j[N]||{},O=R[U];return O?{...j,[N]:{...R,[U]:{...O,isEditing:!1}}}:j})},D=()=>{try{document.activeElement instanceof HTMLElement&&document.activeElement.blur();let N=document.createElement("input");N.classList.add("jl-focus-reset-input"),document.body.appendChild(N),requestAnimationFrame(()=>{N.focus(),requestAnimationFrame(()=>{N.blur(),document.body.contains(N)&&document.body.removeChild(N)})})}catch(N){console.error("Failed to reset focus state:",N)}},P=async N=>{var j,R,O,H,q,V,J;let U=(j=c[N])==null?void 0:j.trim();if(!U){new no.Notice("Option name cannot be empty");return}if(N==="instrument"&&!/^[A-Z0-9.]+$/i.test(U)){new no.Notice("Invalid ticker format. Only letters, numbers, and periods are allowed.");return}D();try{let K=!1;if(N==="event")K=await s.addOrUpdateEventOption(U,f);else if(N==="instrument"){let G;if(u==="futures"){let te=(R=m.dollarPerPoint)!=null&&R.trim()?parseFloat(m.dollarPerPoint):void 0,re=(O=m.tickSize)!=null&&O.trim()?parseFloat(m.tickSize):void 0,Z=(H=m.tickValue)!=null&&H.trim()?parseFloat(m.tickValue):void 0;(te!==void 0||re!==void 0||Z!==void 0)&&(G={dollarPerPoint:te!==void 0?te:0,tickSize:re!==void 0?re:0,tickValue:Z!==void 0?Z:0})}let X;if(u==="forex"){let te=(q=m.lotSize)!=null&&q.trim()?parseFloat(m.lotSize):void 0,re=(V=m.pipValue)!=null&&V.trim()?parseFloat(m.pipValue):void 0,Z=(J=m.pipSize)!=null&&J.trim()?parseFloat(m.pipSize):void 0;(te!==void 0||re!==void 0||Z!==void 0)&&(X={lotSize:te!==void 0?te:0,pipValue:re!==void 0?re:0,pipSize:Z!==void 0?Z:0})}K=await s.addOption(N,U,u,G,X)}else K=await s.addOption(N,U);if(K){new no.Notice(`Added option "${U}" to ${x(N)}`),d(te=>({...te,[N]:""})),N==="instrument"&&g({dollarPerPoint:"",tickSize:"",tickValue:"",lotSize:"",pipValue:"",pipSize:""}),N==="event"&&v("gray"),await s.reloadOptions();let G=s.getAllOptions();i(G);let X={};Object.entries(G).forEach(([te,re])=>{X[te]={},te==="instrument"?re.forEach(Z=>{var se,ee,ie,ve,Se,Me;let ne={text:Z.name,isEditing:!1,editValue:Z.name,editAssetType:Z.assetType};Z.assetType==="futures"&&Z.futuresData&&(ne.editDollarPerPoint=((se=Z.futuresData.dollarPerPoint)==null?void 0:se.toString())||"",ne.editTickSize=((ee=Z.futuresData.tickSize)==null?void 0:ee.toString())||"",ne.editTickValue=((ie=Z.futuresData.tickValue)==null?void 0:ie.toString())||""),Z.assetType==="forex"&&Z.forexData&&(ne.editLotSize=((ve=Z.forexData.lotSize)==null?void 0:ve.toString())||"",ne.editPipValue=((Se=Z.forexData.pipValue)==null?void 0:Se.toString())||"",ne.editPipSize=((Me=Z.forexData.pipSize)==null?void 0:Me.toString())||""),X[te][Z.name]=ne}):te==="event"?re.forEach(Z=>{X[te][Z.name]={text:Z.name,isEditing:!1,editValue:Z.name,editColor:Z.color||"gray"}}):re.forEach(Z=>{X[te][Z]={text:Z,isEditing:!1,editValue:Z}})}),o(X)}else Be.showError(new Error(`Duplicate option: ${U} already exists`),Be.createContext(`add ${x(N).toLowerCase()} option`))}catch(K){Be.handleError(K,Be.createContext(`add ${x(N).toLowerCase()} option`))}},M=(N,U,j)=>{o(R=>{let O=R[N]||{},H=O[U];return H?{...R,[N]:{...O,[U]:{...H,editValue:j}}}:(console.warn(`Initializing missing edit state for ${N} - ${U} during updateEditValue`),{...R,[N]:{...O,[U]:{text:U,isEditing:!0,editValue:j}}})})},z=(N,U,j)=>{N==="instrument"&&o(R=>{let O=R[N]||{},H=O[U];return H?{...R,[N]:{...O,[U]:{...H,editAssetType:j}}}:R})},A=(N,U,j,R)=>{N==="instrument"&&o(O=>{let H=O[N]||{},q=H[U];return q?{...O,[N]:{...H,[U]:{...q,[j]:R}}}:O})},I=(N,U,j)=>{N==="event"&&o(R=>{let O=R[N]||{},H=O[U];return H?{...R,[N]:{...O,[U]:{...H,editColor:j}}}:R})},L=async(N,U)=>{try{if(!a[N]||!a[N][U]){console.error(`Cannot save option: Edit state not found for type "${N}", key "${U}"`),new no.Notice("Error saving option: State not found.");return}let j=a[N][U].editValue;if(!j||j.trim()===""){new no.Notice("Option name cannot be empty");return}if(N==="instrument"&&!/^[A-Z0-9.]+$/i.test(j)){new no.Notice("Invalid ticker format. Only letters, numbers, and periods are allowed.");return}let R;if(N==="instrument"){if(R=a[N][U].editAssetType,!R){let H=n.instrument.find(q=>q.name===U);R=H==null?void 0:H.assetType}if(!R){new no.Notice("Asset type is required for instruments");return}}let O=async H=>{var V,J,K,G,X,te;D(),o(re=>{let Z={...re[N]||{}},ne=Z[U];return ne&&(delete Z[U],Z[j]={...ne,text:j,isEditing:!1,editValue:j}),{...re,[N]:Z}});let q;if(N==="instrument"){let re=a[N][U],Z;if(R==="futures"){let se=(V=re.editDollarPerPoint)!=null&&V.trim()?parseFloat(re.editDollarPerPoint):void 0,ee=(J=re.editTickSize)!=null&&J.trim()?parseFloat(re.editTickSize):void 0,ie=(K=re.editTickValue)!=null&&K.trim()?parseFloat(re.editTickValue):void 0;se!==void 0||ee!==void 0||ie!==void 0?Z={dollarPerPoint:se!==void 0?se:0,tickSize:ee!==void 0?ee:0,tickValue:ie!==void 0?ie:0}:Z=s.getFuturesDataForInstrument(U)}let ne;if(R==="forex"){let se=(G=re.editLotSize)!=null&&G.trim()?parseFloat(re.editLotSize):void 0,ee=(X=re.editPipValue)!=null&&X.trim()?parseFloat(re.editPipValue):void 0,ie=(te=re.editPipSize)!=null&&te.trim()?parseFloat(re.editPipSize):void 0;(se!==void 0||ee!==void 0||ie!==void 0)&&(ne={lotSize:se!==void 0?se:0,pipValue:ee!==void 0?ee:0,pipSize:ie!==void 0?ie:0})}q=await s.updateInstrument(U,j,R,Z,H,ne)}else if(N==="event"){let Z=a[N][U].editColor||"gray";U!==j&&await s.removeOption("event",U),q={success:await s.addOrUpdateEventOption(j,Z),updatedNotes:0}}else q=await s.updateOption(N,U,j,H);if(q.success){await s.reloadOptions();let re=s.getAllOptions();i(re);let Z={};Object.entries(re).forEach(([ne,se])=>{Z[ne]={},ne==="instrument"?se.forEach(ee=>{var Se,Me,le,Ye,ue,We,Ke,Ze,St;let ie=ne===N&&ee.name===j?!1:(le=(Me=(Se=a[ne])==null?void 0:Se[ee.name])==null?void 0:Me.isEditing)!=null?le:!1,ve={text:ee.name,isEditing:ie,editValue:ee.name,editAssetType:ee.assetType};ee.assetType==="futures"&&ee.futuresData&&(ve.editDollarPerPoint=((Ye=ee.futuresData.dollarPerPoint)==null?void 0:Ye.toString())||"",ve.editTickSize=((ue=ee.futuresData.tickSize)==null?void 0:ue.toString())||"",ve.editTickValue=((We=ee.futuresData.tickValue)==null?void 0:We.toString())||""),ee.assetType==="forex"&&ee.forexData&&(ve.editLotSize=((Ke=ee.forexData.lotSize)==null?void 0:Ke.toString())||"",ve.editPipValue=((Ze=ee.forexData.pipValue)==null?void 0:Ze.toString())||"",ve.editPipSize=((St=ee.forexData.pipSize)==null?void 0:St.toString())||""),Z[ne][ee.name]=ve}):ne==="event"?se.forEach(ee=>{var ve,Se,Me;let ie=ne===N&&ee.name===j?!1:(Me=(Se=(ve=a[ne])==null?void 0:ve[ee.name])==null?void 0:Se.isEditing)!=null?Me:!1;Z[ne][ee.name]={text:ee.name,isEditing:ie,editValue:ee.name,editColor:ee.color||"gray"}}):se.forEach(ee=>{var ve,Se,Me;let ie=ne===N&&ee===j?!1:(Me=(Se=(ve=a[ne])==null?void 0:ve[ee])==null?void 0:Se.isEditing)!=null?Me:!1;Z[ne][ee]={text:ee,isEditing:ie,editValue:ee}})}),o(Z),H&&q.updatedNotes!==void 0?new no.Notice(`Updated option from "${U}" to "${j}" and updated ${q.updatedNotes} notes`):new no.Notice(`Updated option from "${U}" to "${j}"`)}else Be.showError(new Error(`Duplicate option: ${j} already exists`),Be.createContext(`update ${x(N).toLowerCase()} option`)),o(re=>{var se,ee;let Z={...re[N]||{}};return Z[j]?(delete Z[j],Z[U]={...((se=a[N])==null?void 0:se[U])||{text:U,editValue:U},isEditing:!0,editValue:j}):(ee=re[N])!=null&&ee[U]&&(Z[U]={...re[N][U],isEditing:!0,editValue:j}),{...re,[N]:Z}})};if(U!==j){let H=`Do you want to update all existing notes that use "${U}" to use "${j}" instead?

This will search through all notes and update the option value wherever it's found.`;new BY(e.app,H,q=>{O(q)}).open()}else if(N==="instrument"){let H=n.instrument.find(J=>J.name===U),q=H==null?void 0:H.assetType,V=a[N][U].editAssetType;q!==V?O(!1):o(J=>{var K;return{...J,[N]:{...J[N]||{},[U]:{...((K=J[N])==null?void 0:K[U])||{text:U,editValue:U},isEditing:!1}}}})}else o(H=>{var q;return{...H,[N]:{...H[N]||{},[U]:{...((q=H[N])==null?void 0:q[U])||{text:U,editValue:U},isEditing:!1}}}})}catch(j){Be.handleError(j,Be.createContext(`update ${x(N).toLowerCase()} option`)),o(R=>{var O;return{...R,[N]:{...R[N]||{},[U]:{...((O=R[N])==null?void 0:O[U])||{text:U,editValue:U},isEditing:!0}}}})}},E=async(N,U)=>{if(N==="account_type"&&U.toLowerCase()==="archived"){new no.Notice('Cannot delete the "Archived" account type - it is reserved for archiving accounts');return}try{let j=`Are you sure you want to remove "${U}"? This cannot be undone.`;class R extends no.Modal{constructor(q,V,J){super(q);this.message=V;this.onConfirm=J}onOpen(){let{contentEl:q}=this;q.createEl("p",{text:this.message});let V=q.createDiv({cls:"modal-button-container"});V.createEl("button",{text:"Delete",cls:"mod-warning"}).addEventListener("click",()=>{this.close(),this.onConfirm()}),V.createEl("button",{text:"Cancel"}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:q}=this;q.empty()}}new R(e.app,j,async()=>{if(D(),await s.removeOption(N,U)){await s.reloadOptions();let H=s.getAllOptions();i(H);let q={};Object.entries(H).forEach(([V,J])=>{q[V]={},V==="instrument"?J.forEach(K=>{var X,te,re,Z,ne,se;let G={text:K.name,isEditing:!1,editValue:K.name,editAssetType:K.assetType};K.assetType==="futures"&&K.futuresData&&(G.editDollarPerPoint=((X=K.futuresData.dollarPerPoint)==null?void 0:X.toString())||"",G.editTickSize=((te=K.futuresData.tickSize)==null?void 0:te.toString())||"",G.editTickValue=((re=K.futuresData.tickValue)==null?void 0:re.toString())||""),K.assetType==="forex"&&K.forexData&&(G.editLotSize=((Z=K.forexData.lotSize)==null?void 0:Z.toString())||"",G.editPipValue=((ne=K.forexData.pipValue)==null?void 0:ne.toString())||"",G.editPipSize=((se=K.forexData.pipSize)==null?void 0:se.toString())||""),q[V][K.name]=G}):V==="event"?J.forEach(K=>{q[V][K.name]={text:K.name,isEditing:!1,editValue:K.name,editColor:K.color||"gray"}}):J.forEach(K=>{q[V][K]={text:K,isEditing:!1,editValue:K}})}),o(q),new no.Notice(`Removed option "${U}"`)}else Be.showError(new Error("Option removal failed"),Be.createContext(`remove ${x(N).toLowerCase()} option`))}).open()}catch(j){Be.handleError(j,Be.createContext(`remove ${x(N).toLowerCase()} option`))}},T=async N=>{try{let U=`Are you sure you want to reset all custom ${x(N).toLowerCase()}? This cannot be undone.`;new WY(e.app,U,async()=>{D();let j=await s.clearOptions(N);if(j>0){await s.reloadOptions();let R=s.getAllOptions();i(R),o(O=>({...O,[N]:{}})),new no.Notice(`Removed ${j} custom ${x(N).toLowerCase()}`)}else Be.showError(new Error("No options to reset"),Be.createContext(`reset ${x(N).toLowerCase()} options`))}).open()}catch(U){Be.handleError(U,Be.createContext(`reset ${x(N).toLowerCase()} options`))}},$=async()=>{if(!b.importedSymbol.trim()||!b.baseSymbol.trim()){new no.Notice("Both symbols are required");return}try{await e.specService.saveMapping(b.importedSymbol.trim(),b.baseSymbol.trim(),!1),y(e.specService.getAllMappings()),k({importedSymbol:"",baseSymbol:""}),new no.Notice(`Mapping added: ${b.importedSymbol} \u2192 ${b.baseSymbol}`)}catch(N){new no.Notice("Failed to add mapping"),console.error(N)}},_=async N=>{try{await e.specService.deleteMapping(N),y(e.specService.getAllMappings()),new no.Notice(`Mapping deleted: ${N}`)}catch(U){new no.Notice("Failed to delete mapping"),console.error(U)}},B=N=>r?!1:t?N===t:N!=="account",W=r||!t;return fe.default.createElement("div",{className:"journalit-settings-tab custom-options-settings",style:{maxHeight:"100%",overflowY:"visible"}},fe.default.createElement("div",{className:"custom-options-container"},Object.entries(n).filter(([N,U])=>B(N)).map(([N,U])=>{var j;return fe.default.createElement("div",{key:N,className:"option-category"},!U||U.length===0?fe.default.createElement("p",{className:"setting-item-description"},"No custom ",x(N).toLowerCase()," have been added yet."):fe.default.createElement("div",{className:"custom-options-container"},N==="instrument"?U.map((R,O)=>{var V;let H=R.name,q=(V=a[N])==null?void 0:V[H];return q?q.isEditing?fe.default.createElement("div",{key:`${N}-${H}-${O}`,className:"setting-item option-item"},fe.default.createElement("div",{className:"setting-item-control",style:{flexDirection:"column",alignItems:"stretch"}},fe.default.createElement("div",{style:{display:"flex",gap:"8px",width:"100%"}},fe.default.createElement("input",{type:"text",value:q.editValue,onChange:J=>M(N,H,J.target.value),onKeyDown:J=>{J.key==="Enter"?(J.preventDefault(),L(N,H)):J.key==="Escape"&&(J.preventDefault(),C(N,H))},className:"option-edit-input","data-option":H,"aria-label":`Edit ${H}`,style:{flex:"1"}}),fe.default.createElement("select",{value:q.editAssetType||R.assetType,onChange:J=>z(N,H,J.target.value),style:{width:"120px"}},Object.values(lf).map(J=>fe.default.createElement("option",{key:J,value:J},S(J))))),(q.editAssetType||R.assetType)==="futures"&&fe.default.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px",marginTop:"8px",padding:"8px",backgroundColor:"var(--background-secondary)",borderRadius:"4px"}},fe.default.createElement("div",null,fe.default.createElement("label",{style:{fontSize:"11px",color:"var(--text-muted)",display:"block",marginBottom:"4px"}},"Dollar Per Point"),fe.default.createElement("input",{type:"number",placeholder:"$/point",value:q.editDollarPerPoint||"",onChange:J=>A(N,H,"editDollarPerPoint",J.target.value),style:{width:"100%"},step:"any"})),fe.default.createElement("div",null,fe.default.createElement("label",{style:{fontSize:"11px",color:"var(--text-muted)",display:"block",marginBottom:"4px"}},"Tick Size"),fe.default.createElement("input",{type:"number",placeholder:"Tick size",value:q.editTickSize||"",onChange:J=>A(N,H,"editTickSize",J.target.value),style:{width:"100%"},step:"any"})),fe.default.createElement("div",null,fe.default.createElement("label",{style:{fontSize:"11px",color:"var(--text-muted)",display:"block",marginBottom:"4px"}},"Tick Value"),fe.default.createElement("input",{type:"number",placeholder:"Tick value",value:q.editTickValue||"",onChange:J=>A(N,H,"editTickValue",J.target.value),style:{width:"100%"},step:"any"}))),(q.editAssetType||R.assetType)==="forex"&&fe.default.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px",marginTop:"8px",padding:"8px",backgroundColor:"var(--background-secondary)",borderRadius:"4px"}},fe.default.createElement("div",null,fe.default.createElement("label",{style:{fontSize:"11px",color:"var(--text-muted)",display:"block",marginBottom:"4px"}},"Lot Size"),fe.default.createElement("input",{type:"number",placeholder:"Lot size",value:q.editLotSize||"",onChange:J=>A(N,H,"editLotSize",J.target.value),style:{width:"100%"},step:"any"})),fe.default.createElement("div",null,fe.default.createElement("label",{style:{fontSize:"11px",color:"var(--text-muted)",display:"block",marginBottom:"4px"}},"Pip Value"),fe.default.createElement("input",{type:"number",placeholder:"Pip value",value:q.editPipValue||"",onChange:J=>A(N,H,"editPipValue",J.target.value),style:{width:"100%"},step:"any"})),fe.default.createElement("div",null,fe.default.createElement("label",{style:{fontSize:"11px",color:"var(--text-muted)",display:"block",marginBottom:"4px"}},"Pip Size"),fe.default.createElement("input",{type:"number",placeholder:"Pip size",value:q.editPipSize||"",onChange:J=>A(N,H,"editPipSize",J.target.value),style:{width:"100%"},step:"any"}))),fe.default.createElement("div",{className:"option-actions",style:{marginTop:"8px"}},fe.default.createElement(Ic,{label:"Save changes",onClick:()=>L(N,H)},fe.default.createElement(Fi,{size:24})),fe.default.createElement(Ic,{label:"Cancel editing",onClick:()=>C(N,H)},fe.default.createElement(La,{size:24}))))):fe.default.createElement("div",{key:`${N}-${H}-${O}`,className:"setting-item option-item"},fe.default.createElement("div",{className:"setting-item-info"},fe.default.createElement("div",null,fe.default.createElement("div",{style:{display:"flex",alignItems:"center"}},fe.default.createElement("div",{className:"setting-item-name"},H),fe.default.createElement("span",{style:{display:"inline-block",marginLeft:"8px",fontSize:"12px",color:"var(--text-muted)",padding:"2px 6px",borderRadius:"4px",backgroundColor:"var(--background-secondary)"}},S(R.assetType))),(R.assetType==="futures"||R.assetType==="forex")&&(()=>{var X,te,re,Z,ne,se;let J=R.assetType==="futures"&&R.futuresData&&((X=R.futuresData.dollarPerPoint)!=null?X:0)>0&&((te=R.futuresData.tickSize)!=null?te:0)>0&&((re=R.futuresData.tickValue)!=null?re:0)>0,K=R.assetType==="forex"&&R.forexData&&((Z=R.forexData.lotSize)!=null?Z:0)>0&&((ne=R.forexData.pipValue)!=null?ne:0)>0&&((se=R.forexData.pipSize)!=null?se:0)>0;if(J){let ee=R.futuresData;return fe.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-muted)",marginTop:"4px"}},"$",ee.dollarPerPoint,"/pt, ",ee.tickSize," tick, $",ee.tickValue," tick val")}if(K){let ee=R.forexData;return fe.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-muted)",marginTop:"4px"}},ee.lotSize," lot, $",ee.pipValue," pip val, ",ee.pipSize," pip size")}let G=e.specService.getSpecsForSymbol(H,R.assetType);if(G){if(R.assetType==="futures"&&"dollarPerPoint"in G)return fe.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-muted)",marginTop:"4px"}},"$",G.dollarPerPoint,"/pt, ",G.tickSize," tick, $",G.tickValue," tick val",fe.default.createElement("span",{style:{marginLeft:"4px",fontStyle:"italic",color:"var(--text-faint)"}},"(built-in)"));if(R.assetType==="forex"&&"lotSize"in G)return fe.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-muted)",marginTop:"4px"}},G.lotSize," lot, $",G.pipValue," pip val, ",G.pipSize," pip size",fe.default.createElement("span",{style:{marginLeft:"4px",fontStyle:"italic",color:"var(--text-faint)"}},"(built-in)"))}return null})(),(()=>{let J=h.find(K=>K.importedSymbol.toUpperCase()===H.toUpperCase());return J?fe.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-accent)",marginTop:"4px",fontStyle:"italic"}},"Mapped to ",J.baseSymbol," (uses ",J.baseSymbol,"'s specs)"):null})(),(()=>{var X,te,re,Z;if(h.find(ne=>ne.importedSymbol.toUpperCase()===H.toUpperCase())||R.assetType!=="futures"&&R.assetType!=="forex")return null;let K=R.assetType==="futures"?((te=(X=R.futuresData)==null?void 0:X.dollarPerPoint)!=null?te:0)>0:((Z=(re=R.forexData)==null?void 0:re.lotSize)!=null?Z:0)>0,G=e.specService.getSpecsForSymbol(H,R.assetType);return!K&&!G?fe.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-faint)",marginTop:"4px",fontStyle:"italic"}},"(No specs set)"):null})())),fe.default.createElement("div",{className:"setting-item-control"},fe.default.createElement("div",{className:"option-actions"},fe.default.createElement(Ic,{label:`Edit ${H}`,onClick:()=>w(N,H)},fe.default.createElement(So,{size:24})),fe.default.createElement(Ic,{label:`Remove ${H}`,onClick:()=>E(N,H)},fe.default.createElement(Jv,{size:24}))))):null}):N==="event"?U.map((R,O)=>{var V;let H=R.name,q=(V=a[N])==null?void 0:V[H];return q?q.isEditing?fe.default.createElement("div",{key:`${N}-${H}-${O}`,className:"setting-item option-item"},fe.default.createElement("div",{className:"setting-item-control",style:{flexDirection:"column",alignItems:"stretch"}},fe.default.createElement("div",{style:{display:"flex",gap:"8px",width:"100%"}},fe.default.createElement("input",{type:"text",value:q.editValue,onChange:J=>M(N,H,J.target.value),onKeyDown:J=>{J.key==="Enter"?(J.preventDefault(),L(N,H)):J.key==="Escape"&&(J.preventDefault(),C(N,H))},className:"option-edit-input","data-option":H,"aria-label":`Edit ${H}`,style:{flex:"1"}})),fe.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginTop:"8px",padding:"8px",backgroundColor:"var(--background-secondary)",borderRadius:"4px"}},fe.default.createElement("span",{style:{fontSize:"12px",color:"var(--text-muted)"}},"Priority:"),Y1e.map(J=>fe.default.createElement("div",{key:J,className:"clickable-icon",onClick:()=>I(N,H,J),style:{display:"flex",alignItems:"center",justifyContent:"center",width:"28px",height:"28px",borderRadius:"4px",cursor:"pointer",padding:"4px",backgroundColor:q.editColor===J?"var(--background-modifier-hover)":"transparent",border:q.editColor===J?"2px solid var(--interactive-accent)":"2px solid transparent"},"aria-label":J.charAt(0).toUpperCase()+J.slice(1)},fe.default.createElement("span",{style:{width:"16px",height:"16px",borderRadius:"50%",backgroundColor:J==="gray"?"var(--text-muted)":`var(--color-${J}, ${J})`,border:"1px solid var(--background-modifier-border)"}})))),fe.default.createElement("div",{className:"option-actions",style:{marginTop:"8px"}},fe.default.createElement(Ic,{label:"Save changes",onClick:()=>L(N,H)},fe.default.createElement(Fi,{size:24})),fe.default.createElement(Ic,{label:"Cancel editing",onClick:()=>C(N,H)},fe.default.createElement(La,{size:24}))))):fe.default.createElement("div",{key:`${N}-${H}-${O}`,className:"setting-item option-item"},fe.default.createElement("div",{className:"setting-item-info"},fe.default.createElement("div",{className:"setting-item-name",style:{display:"flex",alignItems:"center"}},H,fe.default.createElement("span",{style:{display:"inline-block",width:"12px",height:"12px",borderRadius:"50%",marginLeft:"8px",backgroundColor:R.color==="gray"?"var(--text-muted)":`var(--color-${R.color}, ${R.color})`,border:"1px solid var(--background-modifier-border)"},title:`Priority: ${R.color}`}))),fe.default.createElement("div",{className:"setting-item-control"},fe.default.createElement("div",{className:"option-actions"},fe.default.createElement(Ic,{label:`Edit ${H}`,onClick:()=>w(N,H)},fe.default.createElement(So,{size:24})),fe.default.createElement(Ic,{label:`Remove ${H}`,onClick:()=>E(N,H)},fe.default.createElement(Jv,{size:24}))))):null}):U.map((R,O)=>{var q;let H=(q=a[N])==null?void 0:q[R];return H?H.isEditing?fe.default.createElement("div",{key:`${N}-${R}-${O}`,className:"setting-item option-item"},fe.default.createElement("div",{className:"setting-item-control"},fe.default.createElement("input",{type:"text",value:H.editValue,onChange:V=>M(N,R,V.target.value),onKeyDown:V=>{V.key==="Enter"?(V.preventDefault(),L(N,R)):V.key==="Escape"&&(V.preventDefault(),C(N,R))},className:"option-edit-input","data-option":R,"aria-label":`Edit ${R}`}),fe.default.createElement("div",{className:"option-actions"},fe.default.createElement(Ic,{label:"Save changes",onClick:()=>L(N,R)},fe.default.createElement(Fi,{size:24})),fe.default.createElement(Ic,{label:"Cancel editing",onClick:()=>C(N,R)},fe.default.createElement(La,{size:24}))))):fe.default.createElement("div",{key:`${N}-${R}-${O}`,className:"setting-item option-item"},fe.default.createElement("div",{className:"setting-item-info"},fe.default.createElement("div",{className:"setting-item-name",style:{display:"flex",alignItems:"center",gap:"6px"}},R,N==="account_type"&&R.toLowerCase()==="archived"&&fe.default.createElement(El,{size:14,style:{color:"var(--text-muted)",opacity:.7}}))),fe.default.createElement("div",{className:"setting-item-control"},fe.default.createElement("div",{className:"option-actions"},N==="account_type"&&R.toLowerCase()==="archived"?fe.default.createElement("span",{style:{fontSize:"11px",color:"var(--text-muted)",fontStyle:"italic"}},"Locked"):fe.default.createElement(fe.default.Fragment,null,fe.default.createElement(Ic,{label:`Edit ${R}`,onClick:()=>w(N,R)},fe.default.createElement(So,{size:24})),fe.default.createElement(Ic,{label:`Remove ${R}`,onClick:()=>E(N,R)},fe.default.createElement(Jv,{size:24})))))):null}),fe.default.createElement("div",{className:"custom-options-reset-container"},fe.default.createElement(Ie,{variant:"danger",size:"small",onClick:()=>T(N),className:"reset-category-button","aria-label":`Remove all custom ${x(N).toLowerCase()}`},"Reset All ",x(N)))),fe.default.createElement("div",{className:"setting-item custom-item-add"},fe.default.createElement("div",{className:"setting-item-info",style:{flexDirection:"column",alignItems:"stretch"}},N==="instrument"?fe.default.createElement(fe.default.Fragment,null,fe.default.createElement("div",{style:{display:"flex",gap:"8px",width:"100%"}},fe.default.createElement("input",{type:"text",value:c[N]||"",onChange:R=>d(O=>({...O,[N]:R.target.value})),placeholder:`New ${x(N).slice(0,-1)} Name`,"aria-label":`Add new ${x(N).toLowerCase()}`,onKeyDown:R=>{var O;R.key==="Enter"&&((O=c[N])!=null&&O.trim())&&(R.preventDefault(),P(N))},style:{flex:"1"}}),fe.default.createElement("select",{value:u,onChange:R=>p(R.target.value),style:{width:"120px"}},Object.values(lf).map(R=>fe.default.createElement("option",{key:R,value:R},S(R))))),u==="futures"&&fe.default.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px",marginTop:"8px",padding:"8px",backgroundColor:"var(--background-secondary)",borderRadius:"4px"}},fe.default.createElement("div",null,fe.default.createElement("label",{style:{fontSize:"11px",color:"var(--text-muted)",display:"block",marginBottom:"4px"}},"Dollar Per Point (optional)"),fe.default.createElement("input",{type:"number",placeholder:"$/point",value:m.dollarPerPoint,onChange:R=>g(O=>({...O,dollarPerPoint:R.target.value})),style:{width:"100%"},step:"any"})),fe.default.createElement("div",null,fe.default.createElement("label",{style:{fontSize:"11px",color:"var(--text-muted)",display:"block",marginBottom:"4px"}},"Tick Size (optional)"),fe.default.createElement("input",{type:"number",placeholder:"Tick size",value:m.tickSize,onChange:R=>g(O=>({...O,tickSize:R.target.value})),style:{width:"100%"},step:"any"})),fe.default.createElement("div",null,fe.default.createElement("label",{style:{fontSize:"11px",color:"var(--text-muted)",display:"block",marginBottom:"4px"}},"Tick Value (optional)"),fe.default.createElement("input",{type:"number",placeholder:"Tick value",value:m.tickValue,onChange:R=>g(O=>({...O,tickValue:R.target.value})),style:{width:"100%"},step:"any"}))),u==="forex"&&fe.default.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px",marginTop:"8px",padding:"8px",backgroundColor:"var(--background-secondary)",borderRadius:"4px"}},fe.default.createElement("div",null,fe.default.createElement("label",{style:{fontSize:"11px",color:"var(--text-muted)",display:"block",marginBottom:"4px"}},"Lot Size (optional)"),fe.default.createElement("input",{type:"number",placeholder:"Lot size",value:m.lotSize,onChange:R=>g(O=>({...O,lotSize:R.target.value})),style:{width:"100%"},step:"any"})),fe.default.createElement("div",null,fe.default.createElement("label",{style:{fontSize:"11px",color:"var(--text-muted)",display:"block",marginBottom:"4px"}},"Pip Value (optional)"),fe.default.createElement("input",{type:"number",placeholder:"Pip value",value:m.pipValue,onChange:R=>g(O=>({...O,pipValue:R.target.value})),style:{width:"100%"},step:"any"})),fe.default.createElement("div",null,fe.default.createElement("label",{style:{fontSize:"11px",color:"var(--text-muted)",display:"block",marginBottom:"4px"}},"Pip Size (optional)"),fe.default.createElement("input",{type:"number",placeholder:"Pip size",value:m.pipSize,onChange:R=>g(O=>({...O,pipSize:R.target.value})),style:{width:"100%"},step:"any"})))):N==="event"?fe.default.createElement(fe.default.Fragment,null,fe.default.createElement("input",{type:"text",value:c[N]||"",onChange:R=>d(O=>({...O,[N]:R.target.value})),placeholder:`New ${x(N).slice(0,-1)} Name`,"aria-label":`Add new ${x(N).toLowerCase()}`,onKeyDown:R=>{var O;R.key==="Enter"&&((O=c[N])!=null&&O.trim())&&(R.preventDefault(),P(N))}}),fe.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginTop:"8px",padding:"8px",backgroundColor:"var(--background-secondary)",borderRadius:"4px"}},fe.default.createElement("span",{style:{fontSize:"12px",color:"var(--text-muted)"}},"Priority:"),Y1e.map(R=>fe.default.createElement("div",{key:R,className:"clickable-icon",onClick:()=>v(R),style:{display:"flex",alignItems:"center",justifyContent:"center",width:"28px",height:"28px",borderRadius:"4px",cursor:"pointer",padding:"4px",backgroundColor:f===R?"var(--background-modifier-hover)":"transparent",border:f===R?"2px solid var(--interactive-accent)":"2px solid transparent"},"aria-label":R.charAt(0).toUpperCase()+R.slice(1)},fe.default.createElement("span",{style:{width:"16px",height:"16px",borderRadius:"50%",backgroundColor:R==="gray"?"var(--text-muted)":`var(--color-${R}, ${R})`,border:"1px solid var(--background-modifier-border)"}}))))):fe.default.createElement("input",{type:"text",value:c[N]||"",onChange:R=>d(O=>({...O,[N]:R.target.value})),placeholder:`New ${x(N).slice(0,-1)} Name`,"aria-label":`Add new ${x(N).toLowerCase()}`,onKeyDown:R=>{var O;R.key==="Enter"&&((O=c[N])!=null&&O.trim())&&(R.preventDefault(),P(N))}})),fe.default.createElement("div",{className:"setting-item-control"},fe.default.createElement(Ie,{onClick:()=>P(N),disabled:!((j=c[N])!=null&&j.trim()),"aria-label":`Confirm add ${x(N).toLowerCase()}`},"Add"))))}),W&&fe.default.createElement(fe.default.Fragment,null,fe.default.createElement("div",{className:"setting-item"},fe.default.createElement("div",{className:"setting-item-info"},fe.default.createElement("div",{className:"setting-item-description"},"Maps contract-specific symbols (e.g., NQZ5) to base symbols (e.g., NQ) for automatic spec lookup"))),h.length>0?fe.default.createElement("div",{className:"custom-options-container"},h.map(N=>fe.default.createElement("div",{key:N.importedSymbol,className:"setting-item option-item"},fe.default.createElement("div",{className:"setting-item-info"},fe.default.createElement("div",{className:"setting-item-name"},N.importedSymbol," \u2192 ",N.baseSymbol),fe.default.createElement("div",{className:"setting-item-description"},N.autoDetected?"Auto-detected":"Manual"," \u2022 Created ",new Date(N.dateCreated).toLocaleDateString())),fe.default.createElement("div",{className:"setting-item-control"},fe.default.createElement(Ie,{onClick:()=>_(N.importedSymbol),variant:"text"},"Delete"))))):fe.default.createElement("div",{className:"setting-item"},fe.default.createElement("div",{className:"setting-item-description"},"No symbol mappings yet. Mappings are created automatically during CSV imports when contract symbols are detected.")),fe.default.createElement("div",{className:"setting-item custom-item-add"},fe.default.createElement("div",{className:"setting-item-info",style:{display:"flex",gap:"8px",width:"100%"}},fe.default.createElement("input",{type:"text",value:b.importedSymbol,onChange:N=>k(U=>({...U,importedSymbol:N.target.value})),placeholder:"Imported symbol (e.g., NQZ5)",style:{flex:"1"}}),fe.default.createElement("span",null,"\u2192"),fe.default.createElement("input",{type:"text",value:b.baseSymbol,onChange:N=>k(U=>({...U,baseSymbol:N.target.value})),placeholder:"Base symbol (e.g., NQ)",style:{flex:"1"}})),fe.default.createElement("div",{className:"setting-item-control"},fe.default.createElement(Ie,{onClick:$,disabled:!b.importedSymbol.trim()||!b.baseSymbol.trim()},"Add Mapping"))))))}});var _e,EQe,$Y,J1e=F(()=>{_e=Y(Q());ny();hi();Zv();rI();Jg();EQe=({field:e,onSave:t,onCancel:r,onDelete:n,generateUniqueKey:i})=>{var h,y,b,k,x;let[a,o]=(0,_e.useState)({...e}),[s,l]=(0,_e.useState)(""),c=[{value:"text",label:"Text"},{value:"number",label:"Number"},{value:"dropdown",label:"Dropdown"},{value:"multiselect",label:"Multi-select"},{value:"date",label:"Date"},{value:"datetime",label:"Date & Time"},{value:"time",label:"Time"}],d=(S,w)=>{let C={...a,[S]:w};S==="type"&&(["date","datetime","dropdown","multiselect"].includes(w)&&(C.validation={}),w!=="dropdown"&&w!=="multiselect"&&(C.options=[])),S==="label"&&(C.fieldKey=i(w,a.id)),o(C)},u=(S,w)=>{o(C=>({...C,validation:{...C.validation,[S]:w}}))},p=()=>{if(s.trim()){let S=[...a.options||[],{value:s.trim(),label:s.trim()}];o(w=>({...w,options:S})),l("")}},m=S=>{let w=[...a.options||[]];w.splice(S,1),o(C=>({...C,options:w}))},g=()=>{t(a)},f=!0,v=["dropdown","multiselect"].includes(a.type);return _e.default.createElement("div",{className:"custom-field-editor"},_e.default.createElement("div",{className:"setting-item"},_e.default.createElement("div",{className:"setting-item-info"},_e.default.createElement("div",{className:"setting-item-name"},"Field Configuration"))),_e.default.createElement("div",{className:"setting-item"},_e.default.createElement("div",{className:"setting-item-info"},_e.default.createElement("div",{className:"setting-item-name"},"Field Label"),_e.default.createElement("div",{className:"setting-item-description"},"Display name for this field")),_e.default.createElement("div",{className:"setting-item-control"},_e.default.createElement(qa,{type:"text",value:a.label,onChange:S=>d("label",S),placeholder:"Enter field label",size:"md",onKeyDown:S=>{S.key==="Enter"&&S.preventDefault()}}))),_e.default.createElement("div",{className:"setting-item"},_e.default.createElement("div",{className:"setting-item-info"},_e.default.createElement("div",{className:"setting-item-name"},"Frontmatter Key"),_e.default.createElement("div",{className:"setting-item-description"},"This key will appear in your trade files: ",_e.default.createElement("code",{style:{backgroundColor:"var(--background-modifier-border)",padding:"2px 4px",borderRadius:"3px",fontSize:"0.9em",color:a.fieldKey&&Ux.has(a.fieldKey)?"var(--text-error)":"var(--text-accent)"}},a.fieldKey||"field_name"),a.fieldKey&&Ux.has(a.fieldKey)&&_e.default.createElement("span",{style:{color:"var(--text-error)",marginLeft:"8px"}},"\u26A0\uFE0F Reserved field name")))),_e.default.createElement("div",{className:"setting-item"},_e.default.createElement("div",{className:"setting-item-info"},_e.default.createElement("div",{className:"setting-item-name"},"Field Type"),_e.default.createElement("div",{className:"setting-item-description"},"Type of input field")),_e.default.createElement("div",{className:"setting-item-control"},_e.default.createElement(Xi,{options:c,value:a.type,onChange:S=>d("type",S)}))),_e.default.createElement("div",{className:"setting-item"},_e.default.createElement("div",{className:"setting-item-info"},_e.default.createElement("div",{className:"setting-item-name"},"Placeholder Text"),_e.default.createElement("div",{className:"setting-item-description"},"Optional placeholder text shown in empty field")),_e.default.createElement("div",{className:"setting-item-control"},_e.default.createElement(qa,{type:"text",value:a.placeholder||"",onChange:S=>d("placeholder",S),placeholder:"Enter placeholder text",size:"md",onKeyDown:S=>{S.key==="Enter"&&S.preventDefault()}}))),f&&_e.default.createElement(_e.default.Fragment,null,_e.default.createElement("div",{className:"setting-item"},_e.default.createElement("div",{className:"setting-item-info"},_e.default.createElement("div",{className:"setting-item-name"},"Validation"),_e.default.createElement("div",{className:"setting-item-description"},"Field validation rules"))),_e.default.createElement("div",{className:"setting-item"},_e.default.createElement("div",{className:"setting-item-info"},_e.default.createElement("div",{className:"setting-item-name"},"Required Field"),_e.default.createElement("div",{className:"setting-item-description"},"Make this field mandatory")),_e.default.createElement("div",{className:"setting-item-control"},_e.default.createElement("input",{type:"checkbox",checked:((h=a.validation)==null?void 0:h.required)||!1,onChange:S=>u("required",S.target.checked),style:{transform:"scale(1.2)"}}))),a.type==="text"&&_e.default.createElement(_e.default.Fragment,null,_e.default.createElement("div",{className:"setting-item"},_e.default.createElement("div",{className:"setting-item-info"},_e.default.createElement("div",{className:"setting-item-name"},"Minimum Length"),_e.default.createElement("div",{className:"setting-item-description"},"Minimum number of characters")),_e.default.createElement("div",{className:"setting-item-control"},_e.default.createElement($r,{value:((y=a.validation)==null?void 0:y.minLength)||void 0,onChange:S=>u("minLength",S),min:0,placeholder:"No minimum"}))),_e.default.createElement("div",{className:"setting-item"},_e.default.createElement("div",{className:"setting-item-info"},_e.default.createElement("div",{className:"setting-item-name"},"Maximum Length"),_e.default.createElement("div",{className:"setting-item-description"},"Maximum number of characters")),_e.default.createElement("div",{className:"setting-item-control"},_e.default.createElement($r,{value:((b=a.validation)==null?void 0:b.maxLength)||void 0,onChange:S=>u("maxLength",S),min:1,placeholder:"No maximum"})))),a.type==="number"&&_e.default.createElement(_e.default.Fragment,null,_e.default.createElement("div",{className:"setting-item"},_e.default.createElement("div",{className:"setting-item-info"},_e.default.createElement("div",{className:"setting-item-name"},"Minimum Value"),_e.default.createElement("div",{className:"setting-item-description"},"Minimum allowed number")),_e.default.createElement("div",{className:"setting-item-control"},_e.default.createElement($r,{value:((k=a.validation)==null?void 0:k.min)||void 0,onChange:S=>u("min",S),allowDecimal:!0,placeholder:"No minimum"}))),_e.default.createElement("div",{className:"setting-item"},_e.default.createElement("div",{className:"setting-item-info"},_e.default.createElement("div",{className:"setting-item-name"},"Maximum Value"),_e.default.createElement("div",{className:"setting-item-description"},"Maximum allowed number")),_e.default.createElement("div",{className:"setting-item-control"},_e.default.createElement($r,{value:((x=a.validation)==null?void 0:x.max)||void 0,onChange:S=>u("max",S),allowDecimal:!0,placeholder:"No maximum"}))))),v&&_e.default.createElement(_e.default.Fragment,null,_e.default.createElement("div",{className:"setting-item"},_e.default.createElement("div",{className:"setting-item-info"},_e.default.createElement("div",{className:"setting-item-name"},"Options"),_e.default.createElement("div",{className:"setting-item-description"},"Available choices for this field"))),(a.options||[]).map((S,w)=>_e.default.createElement("div",{key:w,className:"setting-item"},_e.default.createElement("div",{className:"setting-item-info"},_e.default.createElement("div",{className:"setting-item-name"},S.label)),_e.default.createElement("div",{className:"setting-item-control"},_e.default.createElement(Ie,{variant:"outline",size:"sm",onClick:()=>m(w)},"Remove")))),_e.default.createElement("div",{className:"setting-item"},_e.default.createElement("div",{className:"setting-item-info"},_e.default.createElement("div",{className:"setting-item-name"},"Add New Option"),_e.default.createElement("div",{className:"setting-item-description"},"Enter a new choice")),_e.default.createElement("div",{className:"setting-item-control"},_e.default.createElement("div",{style:{display:"flex",gap:"8px",alignItems:"center"}},_e.default.createElement(qa,{type:"text",value:s,onChange:S=>l(S),placeholder:"Enter new option",size:"md",style:{flex:1},onKeyDown:S=>{S.key==="Enter"&&(S.preventDefault(),s.trim()&&p())}}),_e.default.createElement(Ie,{variant:"primary",size:"md",onClick:p,disabled:!s.trim()},"Add")))),a.type==="multiselect"&&_e.default.createElement("div",{className:"setting-item"},_e.default.createElement("div",{className:"setting-item-info"},_e.default.createElement("div",{className:"setting-item-name"},"Allow Creating New Options"),_e.default.createElement("div",{className:"setting-item-description"},"Users can create new options when using this field in trade forms")),_e.default.createElement("div",{className:"setting-item-control"},_e.default.createElement("input",{type:"checkbox",checked:a.allowCreateOptions||!1,onChange:S=>d("allowCreateOptions",S.target.checked),style:{transform:"scale(1.2)"}})))),_e.default.createElement("div",{className:"setting-item",style:{justifyContent:"center",borderTop:"1px solid var(--background-modifier-border)",paddingTop:"16px",marginTop:"16px"}},_e.default.createElement("div",{style:{display:"flex",gap:"8px"}},_e.default.createElement(Ie,{variant:"primary",onClick:g},"Save Field"),_e.default.createElement(Ie,{variant:"outline",onClick:r},"Cancel"),_e.default.createElement(Ie,{variant:"outline",onClick:()=>n(e.id),style:{color:"var(--text-error)"}},"Delete Field"))))},$Y=(0,_e.memo)(EQe,(e,t)=>{if(e.field===t.field)return!0;if(e.field.id!==t.field.id||e.field.label!==t.field.label||e.field.type!==t.field.type||e.field.placeholder!==t.field.placeholder||e.field.fieldKey!==t.field.fieldKey||e.field.allowCreateOptions!==t.field.allowCreateOptions)return!1;let r=e.field.validation,n=t.field.validation;if(r!==n&&(!r||!n||r.required!==n.required||r.minLength!==n.minLength||r.maxLength!==n.maxLength||r.min!==n.min||r.max!==n.max))return!1;let i=e.field.options,a=t.field.options;if(i!==a){if(!i||!a||i.length!==a.length)return!1;if(i.length>0){let o=i.length-1;if(i[0]!==a[0]||i[o]!==a[o])return!1}}return!0});$Y.displayName="FieldEditor"});var tt,xD,IQe,Q1e,RY,UY,HY,qY,MQe,X1e=F(()=>{tt=Y(Q()),xD=require("obsidian");ny();hi();qi();Aq();J1e();IQe=({field:e,savedOptions:t,onDeleteOption:r,onClearAll:n,initialExpanded:i=!1})=>{let{isExpanded:a,toggleExpanded:o,accordionContainerStyle:s,accordionContentStyle:l,contentRef:c,containerRef:d,chevronSvgProps:u}=rO(i,{duration:{open:300,close:250},easing:"ease-in-out",stagger:{opacity:100}},{includeBackground:!1,includeBorder:!1,customPadding:{top:0,bottom:8,left:16,right:0}});return tt.default.createElement("div",{style:{marginLeft:"16px"}},tt.default.createElement("div",{className:"setting-item"},tt.default.createElement("div",{className:"setting-item-info"},tt.default.createElement("div",{className:"setting-item-name",style:{cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},onClick:o},tt.default.createElement("svg",{...u},tt.default.createElement("path",{d:"M4 2l4 4-4 4",stroke:"currentColor",strokeWidth:"1.5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})),tt.default.createElement("span",null,e.label," (",t.length," option",t.length!==1?"s":"",")")),tt.default.createElement("div",{className:"setting-item-description"},e.type==="dropdown"?"Dropdown":"Multi-select"," field")),tt.default.createElement("div",{className:"setting-item-control"},tt.default.createElement(Ie,{variant:"outline",size:"sm",onClick:()=>n(e.id,e.label),style:{color:"var(--text-error)"}},"Clear All"))),tt.default.createElement("div",{ref:d,style:s},tt.default.createElement("div",{ref:c,style:l},t.map((p,m)=>tt.default.createElement("div",{key:m,className:"setting-item",style:{minHeight:"auto",padding:"4px 0"}},tt.default.createElement("div",{className:"setting-item-info"},tt.default.createElement("div",{className:"setting-item-name",style:{fontSize:"0.9em"}},"\u2022 ",p)),tt.default.createElement("div",{className:"setting-item-control"},tt.default.createElement(Ie,{variant:"outline",size:"sm",onClick:()=>r(e.id,p),style:{padding:"2px 8px",fontSize:"0.8em"}},"Delete")))))))},Q1e=({plugin:e,onRequestExpansion:t,remeasureContent:r})=>{let{service:n,status:i}=uf("customFieldsService"),[a,o]=(0,tt.useState)([]),[s,l]=(0,tt.useState)(null),[c,d]=(0,tt.useState)(!1),[u,p]=(0,tt.useState)(0),m=(0,tt.useRef)(null),g=(0,tt.useCallback)(()=>{r&&(m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{requestAnimationFrame(()=>{r()})},16))},[r]);(0,tt.useEffect)(()=>()=>{m.current&&clearTimeout(m.current)},[]),(0,tt.useEffect)(()=>{f();let w=e.app,C=D=>{o(D.fields||[])};return w.workspace.on("journalit-custom-fields-changed",C),()=>{w.workspace.off("journalit-custom-fields-changed",C)}},[n,i]);let f=()=>{if(n&&i==="ready"){let w=n.getFields();o(w)}},v=()=>{t==null||t();let w=a.map(D=>D.fieldKey||Zg(D.label)),C=TX("text",w);l(C),d(!0)},h=w=>{t==null||t(),l({...w}),d(!1)},y=(0,tt.useCallback)((w,C)=>{let D=a.filter(P=>P.id!==C).map(P=>P.fieldKey||Zg(P.label));return qx(w,D)},[a]),b=(0,tt.useCallback)(async w=>{if(!n||i!=="ready"){console.error("CustomFieldsService not ready, status:",i);return}let C=aI(w.fieldKey);if(C){alert(`Cannot save field: ${C}`);return}let D=a.filter(P=>P.id!==w.id).map(P=>P.fieldKey||Zg(P.label));if(D.includes(w.fieldKey)){alert("Cannot save field: A field with this frontmatter key already exists");return}try{w.fieldKey||(w.fieldKey=qx(w.label,D)),(0,tt.startTransition)(()=>{l(null),d(!1)}),c?await n.addField(w):await n.updateField(w.id,w),f(),g()}catch(P){console.error("Failed to save field:",P),alert("Failed to save field. Please try again.")}},[n,i,a,c,g]),k=(0,tt.useCallback)(()=>{(0,tt.startTransition)(()=>{l(null),d(!1)})},[]),x=(0,tt.useCallback)(async w=>{if(!n||i!=="ready"){console.error("CustomFieldsService not ready, status:",i);return}let C=(s==null?void 0:s.id)===w?s:a.find(P=>P.id===w),D=(C==null?void 0:C.label)||"Unknown Field";new RY(e.app,D,async()=>{try{(0,tt.startTransition)(()=>{l(null),d(!1)}),await n.removeField(w),f(),g()}catch(P){console.error("Failed to delete field:",P)}}).open()},[n,i,s,a,e.app,g]),S=async()=>{if(!n||i!=="ready"){console.error("CustomFieldsService not ready, status:",i);return}new UY(e.app,async()=>{try{(0,tt.startTransition)(()=>{l(null),d(!1)}),await n.resetFields(),f(),g()}catch(w){console.error("Failed to reset fields:",w)}}).open()};return tt.default.createElement("div",{className:"custom-fields-manager"},tt.default.createElement("div",{className:"setting-item"},tt.default.createElement("div",{className:"setting-item-info"},tt.default.createElement("div",{className:"setting-item-description"},"Create custom fields that will appear in the Advanced tab of the trade form. These fields will be saved to your trade's frontmatter."))),a.length>0&&tt.default.createElement(tt.default.Fragment,null,tt.default.createElement("div",{className:"setting-item"},tt.default.createElement("div",{className:"setting-item-info"},tt.default.createElement("div",{className:"setting-item-name"},"Custom Fields (",a.length,")"),tt.default.createElement("div",{className:"setting-item-description"},"Manage your custom trade form fields"))),a.map(w=>{var C,D;return tt.default.createElement("div",{key:w.id,className:"setting-item"},tt.default.createElement("div",{className:"setting-item-info"},tt.default.createElement("div",{className:"setting-item-name"},w.label,((C=w.validation)==null?void 0:C.required)&&tt.default.createElement("span",{style:{color:"var(--text-error)",marginLeft:"4px"}},"*")),tt.default.createElement("div",{className:"setting-item-description"},"Type: ",w.type,((D=w.validation)==null?void 0:D.required)&&" \u2022 Required")),tt.default.createElement("div",{className:"setting-item-control"},tt.default.createElement(Ie,{variant:"outline",size:"sm",onClick:()=>h(w)},"Edit")))})),a.length===0&&!s&&tt.default.createElement("div",{className:"setting-item"},tt.default.createElement("div",{className:"setting-item-info"},tt.default.createElement("div",{className:"setting-item-name"},"No custom fields defined yet"),tt.default.createElement("div",{className:"setting-item-description"},`Custom fields will appear in the "Advanced" tab of the trade form and be saved to your trade notes' frontmatter.`))),s&&tt.default.createElement(tt.default.Fragment,null,tt.default.createElement("div",{className:"setting-item",style:{borderTop:"2px solid var(--background-modifier-border)",marginTop:"16px",paddingTop:"16px"}},tt.default.createElement("div",{className:"setting-item-info"},tt.default.createElement("div",{className:"setting-item-name"},c?"Add New Field":"Edit Field"),tt.default.createElement("div",{className:"setting-item-description"},"Configure your custom field settings below"))),tt.default.createElement($Y,{field:s,onSave:b,onCancel:k,onDelete:x,generateUniqueKey:y})),!s&&tt.default.createElement(MQe,{customFieldsService:n,fields:a,onOptionsChanged:()=>{p(w=>w+1)},plugin:e}),!s&&tt.default.createElement("div",{className:"setting-item",style:{justifyContent:"space-between"}},tt.default.createElement("div",{className:"setting-item-info"},tt.default.createElement("div",{className:"setting-item-name"},"Actions"),tt.default.createElement("div",{className:"setting-item-description"},"Manage your custom fields")),tt.default.createElement("div",{className:"setting-item-control"},tt.default.createElement("div",{style:{display:"flex",gap:"8px"}},tt.default.createElement(Ie,{variant:"primary",onClick:v},"Add Custom Field"),a.length>0&&tt.default.createElement(Ie,{variant:"outline",onClick:S,style:{color:"var(--text-error)"}},"Delete All Fields")))))},RY=class extends xD.Modal{constructor(r,n,i){super(r);this.fieldLabel=n;this.onConfirm=i}onOpen(){let{contentEl:r}=this;r.createEl("p",{text:`Are you sure you want to delete the custom field "${this.fieldLabel}"?`}),r.createEl("p",{text:"This action cannot be undone.",cls:"warning"});let n=r.createDiv({cls:"modal-button-container"});n.createEl("button",{text:"Delete",cls:"mod-warning"}).addEventListener("click",()=>{this.close(),this.onConfirm()}),n.createEl("button",{text:"Cancel"}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:r}=this;r.empty()}},UY=class extends xD.Modal{constructor(r,n){super(r);this.onConfirm=n}onOpen(){let{contentEl:r}=this;r.createEl("p",{text:"Are you sure you want to delete ALL custom fields?"}),r.createEl("p",{text:"This action cannot be undone.",cls:"warning"});let n=r.createDiv({cls:"modal-button-container"});n.createEl("button",{text:"Delete All",cls:"mod-warning"}).addEventListener("click",()=>{this.close(),this.onConfirm()}),n.createEl("button",{text:"Cancel"}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:r}=this;r.empty()}},HY=class extends xD.Modal{constructor(r,n,i){super(r);this.optionName=n;this.onConfirm=i}onOpen(){let{contentEl:r}=this;r.createEl("p",{text:`Are you sure you want to delete the option "${this.optionName}"?`});let n=r.createDiv({cls:"modal-button-container"});n.createEl("button",{text:"Delete",cls:"mod-warning"}).addEventListener("click",()=>{this.close(),this.onConfirm()}),n.createEl("button",{text:"Cancel"}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:r}=this;r.empty()}},qY=class extends xD.Modal{constructor(r,n,i){super(r);this.fieldLabel=n;this.onConfirm=i}onOpen(){let{contentEl:r}=this;r.createEl("p",{text:`Are you sure you want to delete ALL saved options for "${this.fieldLabel}"?`}),r.createEl("p",{text:"This action cannot be undone.",cls:"warning"});let n=r.createDiv({cls:"modal-button-container"});n.createEl("button",{text:"Clear All",cls:"mod-warning"}).addEventListener("click",()=>{this.close(),this.onConfirm()}),n.createEl("button",{text:"Cancel"}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:r}=this;r.empty()}},MQe=({customFieldsService:e,fields:t,onOptionsChanged:r,plugin:n})=>{let i=(0,tt.useMemo)(()=>e?t.filter(s=>(s.type==="dropdown"||s.type==="multiselect")&&s.allowCreateOptions&&e.getFieldOptions(s.id).length>0):[],[t,e]),a=(0,tt.useCallback)(async(s,l)=>{e&&new HY(n.app,l,async()=>{try{await e.removeFieldOption(s,l),r()}catch(c){console.error("Failed to delete option:",c),alert("Failed to delete option. Please try again.")}}).open()},[e,n.app,r]),o=(0,tt.useCallback)(async(s,l)=>{e&&new qY(n.app,l,async()=>{try{await e.removeAllFieldOptions(s),r()}catch(c){console.error("Failed to clear all options:",c),alert("Failed to clear options. Please try again.")}}).open()},[e,n.app,r]);return!e||i.length===0?null:tt.default.createElement("div",{style:{marginTop:"24px",paddingTop:"24px",borderTop:"1px solid var(--background-modifier-border)"}},tt.default.createElement("div",{className:"setting-item"},tt.default.createElement("div",{className:"setting-item-info"},tt.default.createElement("div",{className:"setting-item-name"},"Saved Custom Options"),tt.default.createElement("div",{className:"setting-item-description"},"Manage options that users have created for custom fields"))),i.map(s=>{let l=e.getFieldOptions(s.id);return tt.default.createElement(IQe,{key:s.id,field:s,savedOptions:l,onDeleteOption:a,onClearAll:o,initialExpanded:!1})}))}});var Ra,Z1e,eCe=F(()=>{Ra=Y(Q());K1e();X1e();nv();ds();Z1e=({plugin:e})=>{let[t,r]=(0,Ra.useState)(!1),[n,i]=(0,Ra.useState)(null);return Ra.default.createElement("div",{className:"journalit-settings-tab customization-settings"},Ra.default.createElement("h3",null,"Customisation"),Ra.default.createElement("p",{className:"setting-item-description"},"Customize options, appearance, and behavior of the Journalit plugin."),Ra.default.createElement(ri,{title:"Tickers/Symbols",defaultExpanded:!1},Ra.default.createElement(bv,{plugin:e,filterType:"instrument"})),Ra.default.createElement(ri,{title:"Symbol Mappings",defaultExpanded:!1},Ra.default.createElement(bv,{plugin:e,showSymbolMappings:!0})),Ra.default.createElement(ri,{title:"Account Types",defaultExpanded:!1},Ra.default.createElement(bv,{plugin:e,filterType:"account_type"})),Ra.default.createElement(ri,{title:"Setups",defaultExpanded:!1},Ra.default.createElement(bv,{plugin:e,filterType:"setup"})),Ra.default.createElement(ri,{title:"Mistakes",defaultExpanded:!1},Ra.default.createElement(bv,{plugin:e,filterType:"mistake"})),Ra.default.createElement(ri,{title:"Tags",defaultExpanded:!1},Ra.default.createElement(bv,{plugin:e,filterType:"tag"})),Ra.default.createElement(ri,{title:"Events",defaultExpanded:!1},Ra.default.createElement(bv,{plugin:e,filterType:"event"})),Ra.default.createElement(ri,{title:"Custom Trade Fields",defaultExpanded:!1,expanded:t,onExpandedChange:r,onRemeasureContentChange:i},Ra.default.createElement(Q1e,{plugin:e,onRequestExpansion:()=>r(!0),remeasureContent:n||void 0})))}});var st,tCe,rCe,nCe=F(()=>{st=Y(Q()),tCe=require("obsidian");Ot();qi();Bu();rCe=({userId:e})=>{let t=Ae(),{service:r}=uf("backendIntegrationService"),[n,i]=(0,st.useState)(null),[a,o]=(0,st.useState)(!1),[s,l]=(0,st.useState)(!1),[c,d]=(0,st.useState)(null),[u,p]=(0,st.useState)(null),[m,g]=(0,st.useState)(!1),[f,v]=(0,st.useState)(!1),h=(0,st.useCallback)(async()=>{var k,x;if(!(!e||!r)){o(!0),d(null);try{let S=await r.getFTPCredentials(e);S?(((k=t==null?void 0:t.settings.backendIntegration)==null?void 0:k.ftpPassword)&&!S.password?(v(!0),S.password=""):v(!1),i(S)):(i(null),v(!1))}catch(S){if(!(S instanceof Error)||!((x=S.message)!=null&&x.includes("404"))){let w={operation:"load FTP credentials",endpoint:`/api/v1/ftp-users/${e}`,statusCode:Be.extractStatusCode(S)},C=Be.getErrorMessage(S,w);d(C),Be.logError(S,w)}i(null)}finally{o(!1)}}},[e,r,t==null?void 0:t.settings.backendIntegration]);st.default.useEffect(()=>{h()},[e,h]),st.default.useEffect(()=>{let k=x=>{var S;(S=x.detail)!=null&&S.credentials?(i(x.detail.credentials),v(!1)):h()};return window.addEventListener("ftp-credentials-created",k),()=>{window.removeEventListener("ftp-credentials-created",k)}},[h]);let y=(0,st.useCallback)(async(k,x)=>{try{await navigator.clipboard.writeText(k),p(x),setTimeout(()=>p(null),2e3)}catch(S){let w={operation:"copy to clipboard",endpoint:void 0};Be.showError(new Error("Failed to copy to clipboard"),w),Be.logError(S,w)}},[]),b=(0,st.useCallback)(async()=>{if(!(!r||!e)){g(!0),d(null);try{let k=await r.resetFTPPassword(e);k?(i(k),v(!1),l(!0),new tCe.Notice("FTP password reset successfully! Save the new password."),t!=null&&t.settings.backendIntegration&&(t.settings.backendIntegration.ftpPassword=k.password||"",await t.saveSettings())):d("Failed to reset password")}catch(k){let x={operation:"reset FTP password",endpoint:`/api/v1/ftp-users/${e}/reset-password`,statusCode:Be.extractStatusCode(k)},S=Be.getErrorMessage(k,x);d(S),Be.handleError(k,x)}finally{g(!1)}}},[r,e,t]);return a&&!n?st.default.createElement("div",{className:"ftp-credentials-section"},st.default.createElement("h3",null,"FTP Credentials"),st.default.createElement("div",{className:"loading-container"},"Loading FTP credentials...")):st.default.createElement("div",{className:"ftp-credentials-section"},st.default.createElement("h3",null,"FTP Credentials for MetaTrader"),c&&st.default.createElement("div",{className:"ftp-error-message"},st.default.createElement(oa,{size:16}),st.default.createElement("span",null,c)),n?st.default.createElement(st.default.Fragment,null,st.default.createElement("div",{className:"ftp-info-message"},st.default.createElement("p",null,"Use these credentials to configure MetaTrader's FTP publishing settings:")),st.default.createElement("div",{className:"ftp-credentials-grid"},st.default.createElement("div",{className:"ftp-credential-field"},st.default.createElement("label",null,"FTP Server:"),st.default.createElement("div",{className:"input-with-action",style:{display:"flex",alignItems:"center",gap:"4px"}},st.default.createElement("input",{type:"text",value:`${n.server}:${n.port}`,readOnly:!0,className:"ftp-readonly-input"}),st.default.createElement("button",{className:"clickable-icon",onClick:()=>y(`${n.server}:${n.port}`,"server"),"aria-label":"Copy FTP server"},u==="server"?st.default.createElement(Fi,{size:16}):st.default.createElement(Pd,{size:16})))),st.default.createElement("div",{className:"ftp-credential-field"},st.default.createElement("label",null,"FTP Login:"),st.default.createElement("div",{className:"input-with-action",style:{display:"flex",alignItems:"center",gap:"4px"}},st.default.createElement("input",{type:"text",value:n.username,readOnly:!0,className:"ftp-readonly-input"}),st.default.createElement("button",{className:"clickable-icon",onClick:()=>y(n.username,"username"),"aria-label":"Copy FTP login"},u==="username"?st.default.createElement(Fi,{size:16}):st.default.createElement(Pd,{size:16})))),(n.password||f)&&st.default.createElement("div",{className:"ftp-credential-field"},st.default.createElement("label",null,"FTP Password:"),st.default.createElement("div",{className:"input-with-action",style:{display:"flex",alignItems:"center",gap:"4px"}},st.default.createElement("input",{type:s?"text":"password",value:f?"*".repeat(12):n.password,readOnly:!0,className:"ftp-readonly-input"}),st.default.createElement("button",{className:"clickable-icon",onClick:()=>y(n.password,"password"),disabled:f||!n.password,"aria-label":f?"Password not available for copying":"Copy password",style:{opacity:f?.5:1,cursor:f?"not-allowed":"pointer"}},f?st.default.createElement(rT,{size:16}):u==="password"?st.default.createElement(Fi,{size:16}):st.default.createElement(Pd,{size:16})),st.default.createElement("button",{className:"clickable-icon",onClick:()=>l(!s),disabled:f,"aria-label":f?"Password hidden":s?"Hide password":"Show password",style:{opacity:f?.5:1,cursor:f?"not-allowed":"pointer"}},f?st.default.createElement(El,{size:16}):s?st.default.createElement(Wv,{size:16}):st.default.createElement(oT,{size:16}))),st.default.createElement("div",{className:"ftp-password-notice"},st.default.createElement(oa,{size:14}),st.default.createElement("span",null,f?"Password is stored but not available for viewing/copying. Reset password to get a new one.":"Save this password securely. It cannot be retrieved later.")))),st.default.createElement("div",{className:"ftp-reset-password",style:{marginTop:"20px",marginBottom:"20px"}},st.default.createElement("button",{className:"mod-cta",onClick:b,disabled:m,style:{width:"auto"}},m?"Resetting Password...":"Reset FTP Password"),st.default.createElement("div",{style:{marginTop:"10px",fontSize:"14px",color:"var(--text-muted)"}},"Click this button to generate a new FTP password.")),st.default.createElement("div",{className:"ftp-setup-instructions"},st.default.createElement("h4",null,"MetaTrader Setup Instructions:"),st.default.createElement("ol",null,st.default.createElement("li",null,"Open MetaTrader\xA05 (MT5)"),st.default.createElement("li",null,"Click on the ",st.default.createElement("strong",null,'"Tools"')," menu at the top"),st.default.createElement("li",null,"Select ",st.default.createElement("strong",null,'"Options"')),st.default.createElement("li",null,"Navigate to the ",st.default.createElement("strong",null,'"FTP"')," tab and enter the FTP ",st.default.createElement("em",null,"Server"),", ",st.default.createElement("em",null,"Login"),", and ",st.default.createElement("em",null,"Password")," shown above"),st.default.createElement("li",null,"Enable ",st.default.createElement("strong",null,'"Passive mode"')),st.default.createElement("li",null,"Enable ",st.default.createElement("strong",null,"automatic publishing of reports via FTP")," and set the refresh interval to ",st.default.createElement("strong",null,"60\xA0minutes"))))):st.default.createElement("div",{className:"ftp-no-credentials"},st.default.createElement("p",null,'No FTP credentials found. Click "Create FTP Credentials" in the section above to generate them.')))}});var fi,wD,iCe,aCe=F(()=>{fi=Y(Q()),wD=require("obsidian");pg();Id();iCe=({plugin:e,accounts:t,onAccountsUpdated:r})=>{let[n,i]=(0,fi.useState)(""),[a,o]=(0,fi.useState)(""),[s,l]=(0,fi.useState)(!1),[c,d]=(0,fi.useState)([]);(0,fi.useEffect)(()=>{u()},[]);let u=async()=>{if(e.accountPageService)try{let g=(await e.accountPageService.getAllEnhancedAccounts()).map(f=>({id:f.id||f.name,name:f.name}));d(g)}catch(m){console.error("Failed to load Obsidian accounts:",m)}},p=async()=>{var m;if(!n||!a){new wD.Notice("Please select both source and target accounts");return}l(!0);try{let g=t.find(x=>x.accountId===n);if(!g)throw new Error("Source account not found");let f=c.find(x=>x.id===a);if(!f)throw new Error("Target account not found");if(((((m=e.settings.backendIntegration)==null?void 0:m.accountMapping)||{})[n]||g.displayName||`Account-${n}`)===f.name){new wD.Notice("This MT account is already linked to the selected Obsidian account"),l(!1);return}let y=e.serviceManager;if(!y)throw new Error("Service manager not available");let b=await y.getBackendIntegrationService();if(!b)throw new Error("Backend service not available");await b.updateAccountMapping(n,f.name);let k=await b.relinkAccountTrades(n,g.displayName||`Account-${n}`,f.name);new wD.Notice(`\u2705 Successfully relinked ${k.updatedCount} trades from ${g.displayName} to ${f.name}`),i(""),o(""),r()}catch(g){console.error("Failed to relink account:",g),new wD.Notice(`\u274C Failed to relink account: ${g.message}`)}finally{l(!1)}};return fi.default.createElement("div",{className:"account-linking-manager"},fi.default.createElement("div",{className:"setting-item"},fi.default.createElement("div",{className:"setting-item-info"},fi.default.createElement("div",{className:"setting-item-name"},"Change Account Linking"),fi.default.createElement("div",{className:"setting-item-description"},"Move all trades from one MT account to a different Obsidian account"))),fi.default.createElement("div",{className:"account-linking-controls"},fi.default.createElement("div",{className:"setting-item"},fi.default.createElement("div",{className:"setting-item-info"},fi.default.createElement("div",{className:"setting-item-name"},"Source MT Account"),fi.default.createElement("div",{className:"setting-item-description"},"Select the MT account whose trades you want to move")),fi.default.createElement("div",{className:"setting-item-control"},fi.default.createElement(Xi,{value:n,onChange:m=>i(m),options:t.map(m=>{var v;let f=(((v=e.settings.backendIntegration)==null?void 0:v.accountMapping)||{})[m.accountId]||m.displayName||`Account-${m.accountId}`;return{value:m.accountId,label:`${m.displayName||`Account-${m.accountId}`} (${m.accountId}) \u2192 ${f}`}}),placeholder:"Select source account...",style:{width:"350px"}}))),fi.default.createElement("div",{className:"setting-item"},fi.default.createElement("div",{className:"setting-item-info"},fi.default.createElement("div",{className:"setting-item-name"},"Target Obsidian Account"),fi.default.createElement("div",{className:"setting-item-description"},"Select the Obsidian account to link the trades to")),fi.default.createElement("div",{className:"setting-item-control"},fi.default.createElement(Xi,{value:a,onChange:m=>o(m),options:c.map(m=>({value:m.id,label:m.name})),placeholder:"Select target account...",style:{width:"250px"}}))),fi.default.createElement("div",{className:"setting-item"},fi.default.createElement("div",{className:"setting-item-control"},fi.default.createElement(Ie,{variant:"primary",onClick:p,disabled:s||!n||!a},s?"Processing...":"Relink Account"))),n&&a&&fi.default.createElement("div",{className:"account-linking-warning"},"\u26A0\uFE0F This will update all synced trades from the source account to be linked to the target account. This operation cannot be undone.")))}});var Su,oCe=F(()=>{Su={connectionStatus:{display:"flex",alignItems:"center",gap:"8px"},refreshButton:{marginLeft:"8px",padding:"4px 8px",fontSize:"12px"},buttonContent:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"center"},syncInfoText:{fontSize:"11px",color:"var(--text-muted)",marginTop:"4px"},connectionError:{fontSize:"11px",color:"var(--text-error)",marginTop:"4px"},loadingContainer:{display:"flex",alignItems:"center",gap:"12px"},accountLinkingDivider:{marginTop:"30px",borderTop:"1px solid var(--background-modifier-border)",paddingTop:"20px"},accountRefreshWrapper:{marginTop:"20px"}}});var De,xg,sCe,lCe=F(()=>{De=Y(Q());Ot();xg=require("obsidian");pg();pg();ph();nv();vm();Vc();nCe();aCe();Bu();oCe();sCe=({plugin:e})=>{var M,z;let t=e.settings.backendIntegration||Qn.backendIntegration,[r,n]=(0,De.useState)({status:"unknown",isSyncing:!1,lastSyncResult:null,syncStatus:null}),[i,a]=(0,De.useState)({accounts:[],isLoading:!1}),o=(0,De.useRef)(0),s=(0,De.useRef)(0),[l,c]=(0,De.useState)({hasCredentials:!1,isCreating:!1}),[d,u]=(0,De.useState)(0),p=De.default.useMemo(()=>{try{let A=e.app.vault.getName();if(A&&A!=="Obsidian Vault")return A.toLowerCase().replace(/[^a-z0-9]/g,"");let I=e.app.vault.adapter,L="";return xg.Platform.isDesktopApp&&I instanceof xg.FileSystemAdapter&&(L=I.getBasePath()),L?(L.split(/[/\\]/).pop()||"unknown").toLowerCase().replace(/[^a-z0-9]/g,""):`anon_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}catch(A){return`anon_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}},[e.app.vault]),[m,g]=(0,De.useState)(null);(0,De.useEffect)(()=>{let A=!0;return(async()=>{try{let L=await e.serviceManager.getBackendIntegrationService();if(!A)return;g(L),await f(),await Promise.allSettled([v(L),h(L),k(L)])}catch(L){let E=Be.createContext("initialize backend integration",void 0,Be.extractStatusCode(L));Be.logError(L,E)}})(),()=>{A=!1}},[e.serviceManager]);let f=(0,De.useCallback)(async()=>{try{let I=await Bt.checkHealth()?"connected":"disconnected";n(L=>({...L,status:I}))}catch(A){n(I=>({...I,status:"disconnected"}))}},[]),v=(0,De.useCallback)(async A=>{let I=A||m;if(I)try{let L=await I.getSyncStatus();if(n(E=>({...E,syncStatus:L})),L&&L.last_sync_time&&L.sync_count!==void 0){let E=new Date(L.last_sync_time).getTime(),T=t.lastSyncTime?new Date(t.lastSyncTime).getTime():0;(E>T||L.sync_count>(t.syncCount||0))&&(await y("lastSyncTime",L.last_sync_time),await y("syncCount",L.sync_count))}}catch(L){let E=Be.createContext("load sync status","/api/v1/sync/status",Be.extractStatusCode(L));Be.logError(L,E)}},[m,t.lastSyncTime,t.syncCount]),h=(0,De.useCallback)(async A=>{let I=A||m;if(!I||r.status==="disconnected"&&!A||i.isLoading)return;let L=Date.now();if(!(L-o.current<5e3)){o.current=L,a(E=>({...E,isLoading:!0}));try{let E=await I.fetchUserAccounts(),T=t.accountMapping||{},$=E.map(B=>({...B,displayName:T[B.accountId]||B.displayName||`Account-${B.accountId}`}));a(B=>({...B,accounts:$,isLoading:!1})),E.some(B=>B.displayName&&!T[B.accountId])&&await I.updateAccountMappings($)}catch(E){if(Date.now()-s.current>3e4){let T=Be.createContext("load MT accounts","/api/v1/mt-accounts",Be.extractStatusCode(E));Be.handleError(E,T),s.current=Date.now()}a(T=>({...T,isLoading:!1,accounts:[]}))}}},[m,r.status]);(0,De.useEffect)(()=>{r.status==="connected"&&m&&i.accounts.length===0&&!i.isLoading&&Date.now()-o.current>5e3&&h()},[r.status,m]);let y=(0,De.useCallback)(async(A,I)=>{A==="serverUrl"&&Bt.clearCache(),e.settings.backendIntegration={...e.settings.backendIntegration,[A]:I},await e.saveSettings(),m&&await m.updateSettings({[A]:I})},[e,m]),b=async A=>{await y("syncEnabled",A),u(I=>I+1),new xg.Notice(`Auto-sync ${A?"enabled":"disabled"}`)},k=(0,De.useCallback)(async A=>{let I=A||m;if(I)try{if(t.ftpUsername){let L=await I.getFTPCredentials(t.ftpUsername);c(E=>({...E,hasCredentials:!!L}))}else c(L=>({...L,hasCredentials:!1}))}catch(L){let E=Be.createContext("check FTP credentials","/api/v1/ftp-users",Be.extractStatusCode(L));Be.logError(L,E),c(T=>({...T,hasCredentials:!1}))}},[m,t.ftpUsername]),x=(0,De.useCallback)(async()=>{if(m){c(A=>({...A,isCreating:!0}));try{let A=await m.createOrGetFTPUser();if(A){await y("ftpUsername",A.username),await y("ftpPassword",A.password||""),c(L=>({...L,hasCredentials:!0})),new xg.Notice("FTP credentials created successfully");let I=new CustomEvent("ftp-credentials-created",{detail:{credentials:A}});window.dispatchEvent(I),await h()}}catch(A){let I=Be.createContext("create FTP credentials","/api/v1/ftp-users",Be.extractStatusCode(A));Be.handleError(A,I)}finally{c(A=>({...A,isCreating:!1}))}}},[m,y,h]),S=(0,De.useCallback)(async()=>{if(m){if(!e.authManager||!e.authManager.isAuthenticated()){new xg.Notice("Please sign in to register your vault.");return}n(A=>({...A,isSyncing:!0}));try{await y("userId",p),await m.registerVault()&&(n(I=>({...I,status:"connected"})),await v(),await k())}catch(A){let I=Be.createContext("vault registration","/api/v1/register-vault",Be.extractStatusCode(A));Be.handleError(A,I)}finally{n(A=>({...A,isSyncing:!1}))}}},[m,y,p,v,k,e.authManager]),w=(0,De.useCallback)(async()=>{if(m){if(!e.authManager||!e.authManager.isAuthenticated()){new xg.Notice("Please sign in to use automated sync.");return}n(A=>({...A,isSyncing:!0}));try{let A=await m.requestForceSync();n(I=>({...I,lastSyncResult:A})),await v()}catch(A){let I=Be.createContext("force sync","/api/v1/sync/force",Be.extractStatusCode(A));Be.handleError(A,I)}finally{n(A=>({...A,isSyncing:!1}))}}},[m,v,e.authManager]),C=(0,De.useMemo)(()=>{switch(r.status){case"connected":return"\u{1F7E2}";case"disconnected":return"\u{1F534}";default:return"\u{1F7E1}"}},[r.status]),D=(0,De.useMemo)(()=>{switch(r.status){case"connected":return"Connected";case"disconnected":return"Disconnected";default:return"Checking..."}},[r.status]),P=A=>{if(!A)return"Never";try{let I=new Date(A),L=e.settings.trade.dateFormat||"DDMMYY",E=String(I.getDate()).padStart(2,"0"),T=String(I.getMonth()+1).padStart(2,"0"),$=String(I.getFullYear()).slice(-2),_=String(I.getHours()).padStart(2,"0"),B=String(I.getMinutes()).padStart(2,"0"),W="";switch(L){case"DDMMYY":W=`${E}/${T}/${$}`;break;case"MMDDYY":W=`${T}/${E}/${$}`;break;case"YYMMDD":W=`${$}/${T}/${E}`;break;default:W=`${E}/${T}/${$}`}return`${W} ${_}:${B}`}catch(I){return"Invalid date"}};return De.default.createElement("div",{className:"journalit-settings-tab backend-integration-settings"},De.default.createElement("h3",null,"Backend Integration"),De.default.createElement("p",{className:"setting-item-description"},"Connect to the trading server for automatic trade synchronization."),De.default.createElement(ri,{title:"Connection Settings",defaultExpanded:!0},De.default.createElement("div",{className:"setting-item"},De.default.createElement("div",{className:"setting-item-info"},De.default.createElement("div",{className:"setting-item-name"},"Connection Status"),De.default.createElement("div",{className:"setting-item-description"},"Current connection status to the trading server")),De.default.createElement("div",{className:"setting-item-control"},De.default.createElement("span",{style:Su.connectionStatus},De.default.createElement("span",null,C),De.default.createElement("span",null,D),De.default.createElement(Ie,{variant:"secondary",onClick:f,style:Su.refreshButton},De.default.createElement(Gv,{size:16}))))),De.default.createElement("div",{className:"setting-item"},De.default.createElement("div",{className:"setting-item-info"},De.default.createElement("div",{className:"setting-item-name"},"Register Vault"),De.default.createElement("div",{className:"setting-item-description"},"Register this vault with the backend server for sync")),De.default.createElement("div",{className:"setting-item-control"},De.default.createElement(Ie,{variant:"primary",onClick:S,disabled:r.isSyncing||!m},De.default.createElement("div",{style:Su.buttonContent},r.isSyncing&&De.default.createElement(Io,{size:"small",message:""}),r.isSyncing?"Registering...":"Register Vault")))),r.status==="connected"&&!l.hasCredentials&&De.default.createElement("div",{className:"setting-item"},De.default.createElement("div",{className:"setting-item-info"},De.default.createElement("div",{className:"setting-item-name"},"FTP Credentials"),De.default.createElement("div",{className:"setting-item-description"},"Create FTP credentials to upload MetaTrader reports. A unique username will be generated automatically.")),De.default.createElement("div",{className:"setting-item-control"},De.default.createElement(Ie,{variant:"primary",onClick:x,disabled:l.isCreating||!m},De.default.createElement("div",{style:Su.buttonContent},l.isCreating&&De.default.createElement(Io,{size:"small",message:""}),l.isCreating?"Creating...":"Create FTP Credentials"))))),De.default.createElement(ri,{title:"Sync Settings",defaultExpanded:!0},De.default.createElement("div",{className:"setting-item"},De.default.createElement("div",{className:"setting-item-info"},De.default.createElement("div",{className:"setting-item-name"},"Enable Auto-Sync"),De.default.createElement("div",{className:"setting-item-description"},"Automatically sync trades from the backend server",De.default.createElement("div",{style:Su.syncInfoText},De.default.createElement(Js,{size:16})," Auto-sync checks for new trades every hour"))),De.default.createElement("div",{className:"setting-item-control"},De.default.createElement(la,{checked:t.syncEnabled||!1,onChange:b,id:"sync-enabled-toggle",ariaLabel:"Enable auto-sync"}))),De.default.createElement("div",{className:"setting-item"},De.default.createElement("div",{className:"setting-item-info"},De.default.createElement("div",{className:"setting-item-name"},"Manual Sync"),De.default.createElement("div",{className:"setting-item-description"},"Force immediate synchronization of trades",De.default.createElement("div",{style:Su.syncInfoText},De.default.createElement(Js,{size:16})," Average wait time: 2-3 minutes (maximum: 5 minutes)"))),De.default.createElement("div",{className:"setting-item-control"},De.default.createElement(Ie,{variant:"primary",onClick:w,disabled:r.isSyncing||!m},De.default.createElement("div",{style:Su.buttonContent},r.isSyncing&&De.default.createElement(Io,{size:"small",message:""}),r.isSyncing?"Syncing...":"Force Sync Now")))),r.lastSyncResult&&De.default.createElement("div",{className:"setting-item"},De.default.createElement("div",{className:"setting-item-info"},De.default.createElement("div",{className:"setting-item-name"},"Last Sync Result"),De.default.createElement("div",{className:"setting-item-description"},r.lastSyncResult.synced_trades>0?De.default.createElement(De.default.Fragment,null,De.default.createElement(Aa,{size:16})," Synced ",r.lastSyncResult.synced_trades," trades (",r.lastSyncResult.new_files," new files)"):De.default.createElement(De.default.Fragment,null,De.default.createElement(Aa,{size:16})," No new trades to sync")))),(t.lastSyncTime||r.syncStatus)&&De.default.createElement("div",{className:"setting-item"},De.default.createElement("div",{className:"setting-item-info"},De.default.createElement("div",{className:"setting-item-name"},"Sync Status"),De.default.createElement("div",{className:"setting-item-description"},"Last sync: ",P(t.lastSyncTime||((M=r.syncStatus)==null?void 0:M.last_sync_time))," | Total syncs: ",t.syncCount||((z=r.syncStatus)==null?void 0:z.sync_count)||0)))),De.default.createElement(ri,{title:"Trading Accounts",defaultExpanded:!1},De.default.createElement("div",{className:"setting-item"},De.default.createElement("div",{className:"setting-item-info"},De.default.createElement("div",{className:"setting-item-name"},"Linked MT Accounts"),De.default.createElement("div",{className:"setting-item-description"},"MetaTrader accounts detected from synced reports",r.status==="disconnected"&&De.default.createElement("div",{style:Su.connectionError},De.default.createElement(oa,{size:16})," Server is disconnected. Please check connection status.")))),i.isLoading?De.default.createElement("div",{className:"setting-item"},De.default.createElement("div",{className:"setting-item-info"},De.default.createElement("div",{style:Su.loadingContainer},De.default.createElement(Io,{message:"Loading accounts...",size:"small"})))):i.accounts.length===0?De.default.createElement("div",{className:"setting-item"},De.default.createElement("div",{className:"setting-item-info"},De.default.createElement("div",{className:"setting-item-description"},"No accounts found.",r.status==="connected"?"Sync some trades to detect accounts.":"Connect to the server and sync trades to see accounts."))):De.default.createElement("div",{className:"mt-accounts-list"},i.accounts.map(A=>De.default.createElement("div",{key:A.accountId,className:"mt-account-item"},De.default.createElement("div",{className:"mt-account-info"},De.default.createElement("div",{className:"mt-account-id"},"Account ID: ",A.accountId),A.brokerName&&De.default.createElement("div",{className:"mt-account-broker"},"Broker: ",A.brokerName),De.default.createElement("div",{className:"mt-account-dates"},A.firstSeen&&De.default.createElement("span",null,"First seen: ",P(A.firstSeen)),A.lastSeen&&De.default.createElement("span",null," | Last seen: ",P(A.lastSeen)))),De.default.createElement("div",{className:"mt-account-display"},De.default.createElement("div",{className:"mt-account-name"},De.default.createElement("span",null,A.displayName||`Account-${A.accountId}`)))))),De.default.createElement("div",{className:"setting-item",style:Su.accountRefreshWrapper},De.default.createElement("div",{className:"setting-item-control"},De.default.createElement(Ie,{variant:"secondary",onClick:()=>h(),disabled:i.isLoading||!m},"Refresh Accounts"))),i.accounts.length>0&&De.default.createElement("div",{style:Su.accountLinkingDivider},De.default.createElement(iCe,{plugin:e,accounts:i.accounts,onAccountsUpdated:h}))),l.hasCredentials&&De.default.createElement(ri,{title:"MetaTrader FTP Credentials",defaultExpanded:!1},De.default.createElement(rCe,{userId:t.ftpUsername||p})))}});var uCe={};Ti(uCe,{JournalitSettingsTab:()=>VY});var cCe,Sl,dCe,VY,AQe,pCe=F(()=>{cCe=require("obsidian"),Sl=Y(Q()),dCe=Y(Ni());W1e();H1e();G1e();eCe();lCe();rl();kB();VY=class extends cCe.PluginSettingTab{constructor(r,n){super(r,n);this.root=null;this.initialTab="general";this.plugin=n}setInitialTab(r){this.initialTab=r}display(){GT(),AI();let r=document.head.querySelector("#settings-tab-styles"),{containerEl:n}=this;n.empty(),n.addClass("journalit-settings");let i=n.createDiv({cls:"journalit-settings-wrapper"});this.root||(this.root=(0,dCe.createRoot)(i));let a=this.initialTab;this.initialTab="general",this.root.render(Sl.default.createElement(Sl.default.StrictMode,null,Sl.default.createElement(AQe,{plugin:this.plugin,initialTab:a})))}hide(){this.root&&(this.root.unmount(),this.root=null),this.containerEl.empty(),this.containerEl.removeClass("journalit-settings")}},AQe=Sl.default.memo(({plugin:e,initialTab:t="general"})=>{let[r,n]=(0,Sl.useState)(t),i=o=>{n(o)};return Sl.default.createElement("div",{className:"settings-tab-container"},Sl.default.createElement("nav",{className:"settings-tab-nav"},[{id:"general",label:"General"},{id:"reviews",label:"Reviews"},{id:"accounts",label:"Auth"},{id:"backend",label:"Backend Integration"},{id:"customization",label:"Customisation"}].map(o=>Sl.default.createElement("button",{key:o.id,className:`settings-tab-button ${r===o.id?"settings-tab-button--active":""}`,onClick:()=>i(o.id)},o.label))),Sl.default.createElement("div",{className:"settings-tab-content journalit-tab-content",role:"tabpanel","aria-labelledby":`tab-${r}`},r==="general"&&Sl.default.createElement(B1e,{plugin:e}),r==="reviews"&&Sl.default.createElement(U1e,{plugin:e}),r==="accounts"&&Sl.default.createElement(V1e,{plugin:e}),r==="backend"&&Sl.default.createElement(sCe,{plugin:e}),r==="customization"&&Sl.default.createElement(Z1e,{plugin:e})))})});var LQe={};Ti(LQe,{default:()=>gm});module.exports=hd(LQe);var kD=require("obsidian");Wp();co();co();var SMe=`
  /* Fix for duplicate tooltips */
  .journalit-icon-button,
  .journalit-button,
  .drc-note-grade-dropdown select {
    position: relative !important;
  }
  
  /* Hide Obsidian's native tooltips ONLY on Journalit buttons (scoped to prevent breaking Obsidian's tooltips) */
  .journalit-icon-button .tooltip,
  .journalit-icon-button + .tooltip,
  .journalit-button .tooltip,
  .journalit-button + .tooltip,
  .journalit-no-tooltip-button .tooltip,
  .journalit-no-tooltip-button + .tooltip {
    display: none !important;
    visibility: hidden !important;
    opacity: 0 !important;
    pointer-events: none !important;
  }

  /* Fix for grade display tooltips */
  .drc-note-grade-dropdown::before,
  .drc-note-grade-dropdown::after,
  .drc-note-grade-dropdown select::before,
  .drc-note-grade-dropdown select::after {
    content: none !important;
    display: none !important;
  }

  /* Hide any tooltips that appear within our custom components */
  .drc-container .tooltip,
  .drc-note-grade-dropdown .tooltip,
  .drc-note-grade-value .tooltip {
    display: none !important;
    visibility: hidden !important;
    opacity: 0 !important;
    z-index: -1 !important;
  }

  /* CRITICAL FIX: Ensure our grade elements display properly with accurate vertical centering */
  .drc-note-grade-value,
  select.drc-note-grade-value {
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    text-align: center !important;
    width: 60px !important;
    height: 60px !important;
    border-radius: 50% !important;
    margin: 0 auto !important;
    font-size: 18px !important;
    /* The padding-bottom adjustment is critical for proper vertical centering of text */
    padding: 0 0 4px 0 !important; 
    overflow: visible !important;
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    appearance: none !important;
    line-height: 1 !important; /* Critical for proper vertical centering */
    vertical-align: middle !important;
  }

  /* Ensure text is properly centered in all browsers */
  .drc-note-grade-value,
  .drc-note-grade-dropdown select,
  .drc-note-grade-dropdown option {
    text-align: center !important;
    text-align-last: center !important;
  }

  /* No-tooltip button styles - match IconButton */
  .journalit-no-tooltip-button {
    position: relative;
    background: none;
    border: none;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 6px;
    border-radius: 4px;
    transition: all 0.2s ease;
    color: var(--text-muted);
    width: 30px;
    height: 30px;
    margin: 0 2px;
    box-sizing: content-box;
  }

  /* Style hover state for buttons */
  .journalit-no-tooltip-button:hover {
    background-color: var(--background-modifier-hover);
    color: var(--text-normal);
  }

  /* Style active state for buttons */
  .journalit-no-tooltip-button:active {
    background-color: var(--background-modifier-active);
    transform: translateY(1px);
  }

  /* Custom tooltip implementation */
  .journalit-no-tooltip-button {
    position: relative;
  }

  /* Define tooltip using ::before pseudo-element */
  .journalit-no-tooltip-button::before {
    content: attr(data-label);
    position: absolute;
    bottom: 120%;
    left: 50%;
    transform: translateX(-50%);
    margin-bottom: 0;
    background-color: var(--background-secondary);
    color: var(--text-normal);
    padding: 5px 10px;
    border-radius: 4px;
    font-size: 12px;
    white-space: nowrap;
    opacity: 0;
    visibility: hidden;
    transition: all 0.2s ease;
    z-index: 10000;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    pointer-events: none;
  }

  /* Show tooltip on hover */
  .journalit-no-tooltip-button:hover::before {
    opacity: 1;
    visibility: visible;
    bottom: 100%;
    margin-bottom: 4px;
  }

  /* Fix for SVG within buttons */
  .journalit-no-tooltip-button svg {
    width: 18px;
    height: 18px;
    pointer-events: none;
    fill: none;
  }

  /* Style the debug outline */
  .journalit-no-tooltip-button.debug {
    outline: 1px solid red;
  }

  .journalit-no-tooltip-button:hover.debug {
    outline: 2px solid green;
  }
`;function TMe(){let e=document.createElement("style");e.id="tooltip-fix-styles",e.textContent=SMe,document.head.appendChild(e)}function CMe(){let e=document.head.querySelector("#tooltip-fix-styles");e&&e.remove()}we.tooltip={inject:TMe,remove:CMe};co();XT();we.shared={inject:FI,remove:AB};co();var PMe=`
/* Icon button hover states */
.jl-icon-button-hover {
  background: none;
  color: var(--text-muted);
  transition: background 0.2s ease, color 0.2s ease;
  cursor: pointer;
}

.jl-icon-button-hover:hover:not(:disabled) {
  background: var(--background-modifier-hover);
  color: var(--text-normal);
}

/* Restore/action button hover */
.jl-restore-button-hover {
  background-color: var(--background-secondary);
  border-color: var(--background-modifier-border);
  transition: all 0.2s ease;
}

.jl-restore-button-hover:hover:not(:disabled) {
  background-color: var(--background-modifier-hover);
  border-color: var(--text-accent);
}

/* Quick link buttons with lift effect */
.jl-quick-link-hover {
  background-color: var(--background-secondary);
  border-color: var(--background-modifier-border);
  transform: translateY(0);
  box-shadow: none;
  transition: all 0.2s ease;
}

.jl-quick-link-hover:hover:not(:disabled) {
  background-color: var(--background-modifier-hover);
  border-color: var(--link-color, var(--interactive-accent));
  transform: translateY(-1px);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

/* Recent item card hover */
.jl-recent-item-hover {
  background-color: var(--background-secondary);
  border-color: var(--background-modifier-border);
  transition: all 0.2s ease;
}

.jl-recent-item-hover:hover {
  background-color: var(--background-modifier-hover);
  border-color: var(--interactive-accent);
}

/* Checkbox hover states */
/* Unchecked hover state */
.jl-checkbox-wrapper:hover .jl-checkbox:not(.jl-checkbox-checked) {
  background-color: var(--background-modifier-hover);
  border-color: var(--interactive-accent);
}

/* Checked hover state - opacity change for clear feedback */
.jl-checkbox-wrapper:hover .jl-checkbox.jl-checkbox-checked {
  opacity: 0.85 !important;
  box-shadow: 0 0 0 2px var(--background-modifier-border) !important;
}

.jl-checkbox {
  background-color: var(--background-primary);
  border-color: var(--background-modifier-border);
  transition: background-color 0.2s ease, border-color 0.2s ease;
}

.jl-checkbox-checked {
  background-color: var(--interactive-accent);
  border-color: var(--interactive-accent);
}

/* Ensure SVG checkmark doesn't block hover/cursor */
.jl-checkbox svg {
  pointer-events: none !important;
}

/* Ensure the entire wrapper and all children show pointer cursor */
.jl-checkbox-wrapper,
.jl-checkbox-wrapper *:not(svg) {
  cursor: pointer !important;
}

/* Make sure the label covers the full clickable area */
.jl-checkbox-wrapper label {
  display: flex !important;
  align-items: center !important;
  cursor: pointer !important;
}

/* Ensure checkbox div maintains cursor */
.jl-checkbox {
  cursor: pointer !important;
}

/* Destructive actions */
.jl-button-destructive {
  background-color: var(--background-modifier-error);
  color: var(--text-on-accent);
  border-color: var(--background-modifier-error);
}

.jl-button-destructive:hover:not(:disabled) {
  background-color: var(--background-modifier-error-hover);
  opacity: 0.9;
}

/* Utility classes */
.jl-image-hidden {
  display: none;
}

.jl-component-visible {
  display: block !important;
}

.jl-force-redraw {
  opacity: 0.99;
  animation: redraw 0.01s;
}

@keyframes redraw {
  to { opacity: 1; }
}

/* Focus management utility */
.jl-focus-reset-input {
  position: absolute;
  opacity: 0;
  height: 0;
  width: 0;
  pointer-events: none;
}

/* Component container resets */
.jl-component-reset {
  margin: 0;
  padding: 0;
  border: none;
}

.jl-component-container-reset {
  margin: 0;
  padding: 0;
  border: none;
  width: 100%;
  display: block;
  box-sizing: border-box;
}

/* Drawdown widget account name base + hover */
.journalit-drawdown-account-name {
  font-size: 12px;
  color: var(--text-muted);
  font-weight: 400;
  transition: font-weight 0.1s ease, color 0.1s ease;
}

.journalit-drawdown-account-row:hover .journalit-drawdown-account-name {
  font-weight: 500;
  color: var(--text-normal);
}

/* AUM widget hover - minimal underline on label */
.journalit-aum-widget:hover .journalit-aum-label {
  text-decoration: underline;
}

/* Weekly Summary widget hover - minimal underline on label */
.journalit-weekly-widget:hover .journalit-weekly-label {
  text-decoration: underline;
}
`;function gee(){if(document.getElementById("journalit-interactions-styles"))return;let e=document.createElement("style");e.id="journalit-interactions-styles",e.textContent=PMe,document.head.appendChild(e)}function hee(){let e=document.getElementById("journalit-interactions-styles");e&&e.remove()}we.interactions={inject:gee,remove:hee};co();NB();we.combobox={inject:LB,remove:nee};co();var DMe=`
/**
 * File: src/styles/processor-components.css
 * Purpose: Utility classes for processor components to replace JavaScript inline styles
 * Related files:
 * - ../components/monthly/MonthlyReviewProcessor.ts
 * - ../components/weekly/WeeklyReviewProcessor.ts
 * - ../components/missedTrade/MissedTradeNoteProcessor.ts
 * - ../components/drc/DRCNoteProcessor.ts
 */

/* Component container resets */
.journalit-component-container {
  margin: 0;
  padding: 0;
  border: none;
  width: 100%;
  display: block;
  box-sizing: border-box;
}

/* Calendar-specific positioning */
.journalit-calendar-cell-relative {
  position: relative;
  display: flex;
  flex-direction: column;
  padding: 4px;
}

.journalit-calendar-day-number {
  position: absolute;
  top: 4px;
  left: 4px;
  text-align: left;
}

.journalit-calendar-pnl-centered {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 100%;
  margin-top: 0;
  text-align: center;
}

.journalit-calendar-trade-count {
  position: absolute;
  top: 65%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 100%;
  text-align: center;
}

/* Grid layout utilities */
.journalit-grid-weekdays-5 {
  display: grid;
  grid-template-columns: repeat(5, 1fr) 1fr;
  gap: 4px;
}

.journalit-grid-weekdays-7 {
  display: grid;
  grid-template-columns: repeat(7, 1fr) 1fr;
  gap: 4px;
}

/* Responsive text sizing with CSS custom properties */
.journalit-calendar-responsive {
  --cell-day-number-size: 12px;
  --cell-pnl-size: 12px;
  --cell-trade-size: 10px;
}

@media (max-width: 600px) {
  .journalit-calendar-responsive {
    --cell-day-number-size: 10px;
    --cell-pnl-size: 10px;
    --cell-trade-size: 8px;
  }
}

/* Container queries for calendar cells (modern browsers) */
.journalit-calendar-day {
  container-type: inline-size;
  container-name: calendar-cell;
}

@container calendar-cell (max-width: 30px) {
  .journalit-calendar-day-number { font-size: 8px; }
  .journalit-calendar-pnl-centered { font-size: 8px; }
  .journalit-calendar-trade-count { font-size: 7px; }
}

@container calendar-cell (min-width: 31px) and (max-width: 50px) {
  .journalit-calendar-day-number { font-size: 10px; }
  .journalit-calendar-pnl-centered { font-size: 10px; }
  .journalit-calendar-trade-count { font-size: 8px; }
}

@container calendar-cell (min-width: 51px) {
  .journalit-calendar-day-number { font-size: 12px; }
  .journalit-calendar-pnl-centered { font-size: 12px; }
  .journalit-calendar-trade-count { font-size: 10px; }
}
`;function vee(){if(document.getElementById("journalit-processor-component-styles"))return;let e=document.createElement("style");e.id="journalit-processor-component-styles",e.textContent=DMe,document.head.appendChild(e)}function yee(){let e=document.getElementById("journalit-processor-component-styles");e&&e.remove()}we.processorComponent={inject:vee,remove:yee};co();QT();we.chart={inject:NI,remove:EB};co();qE();we.image={inject:KS,remove:PJ};co();xB();we.weeklyReview={inject:bB,remove:$Z};wB();co();VB();we.reviewV2={inject:qB,remove:bee};co();HB();we.tradeForm={inject:VI,remove:GI};co();PB();we.dashboard={inject:r0,remove:XZ};co();var IMe=`
/* Account Note Styles */
.journalit-account-note {
  display: flex;
  flex-direction: column;
  width: 100%;
  font-family: var(--font-text);
  color: var(--text-normal);
}

/* Account Balance Chart Styles */
.journalit-account .account-balance-chart-container {
  margin-bottom: 25px;
  border-radius: 8px;
  padding: 12px 16px;
  /* Removed border to make chart feel less cramped */
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.journalit-account .account-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 15px;
  border-bottom: 1px solid var(--background-modifier-border);
}

.journalit-account .account-name {
  font-size: 1.8rem;
  font-weight: 600;
  color: var(--text-normal);
}

.journalit-account .account-type {
  font-size: 1rem;
  color: var(--text-muted);
  background-color: var(--background-secondary);
  padding: 4px 8px;
  border-radius: 4px;
}

.journalit-account .account-summary {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
  margin-bottom: 30px;
}

.journalit-account .account-metric {
  flex: 1;
  min-width: 200px;
  padding: 15px;
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.journalit-account .metric-label {
  font-size: 0.9rem;
  color: var(--text-muted);
  margin-bottom: 5px;
}

.journalit-account .metric-value {
  font-size: 1.3rem;
  font-weight: 600;
  color: var(--text-normal);
}

.journalit-account .account-details,
.journalit-account .account-performance {
  margin-bottom: 30px;
}

.journalit-account h3 {
  font-size: 1.3rem;
  font-weight: 600;
  margin-bottom: 15px;
  padding-bottom: 8px;
  border-bottom: 1px solid var(--background-modifier-border);
}

.journalit-account .details-grid,
.journalit-account .metrics-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 15px;
}

.journalit-account .detail-item,
.journalit-account .metric-item {
  padding: 10px;
  background-color: var(--background-secondary);
  border-radius: 4px;
  width: 100%;
  box-sizing: border-box;
}

.journalit-account .detail-label,
.journalit-account .metric-label {
  font-size: 0.8rem;
  color: var(--text-muted);
  margin-bottom: 5px;
}

.journalit-account .detail-value,
.journalit-account .metric-value {
  font-size: 1.1rem;
  font-weight: 500;
  color: var(--text-normal);
}

/* Cost details styles */
.journalit-account .cost-details {
  margin-top: 5px;
  font-size: 0.85rem;
  color: var(--text-muted);
}

.journalit-account .cost-total {
  font-weight: 500;
}

.journalit-account .cost-months {
  font-style: italic;
  font-size: 0.8rem;
}

/* Profit Target Styles */
.journalit-account .profit-target-item {
  grid-column: 1 / -1; /* Make the profit target item span the full width */
  width: 100%;
  box-sizing: border-box;
  margin: 0;
}

.journalit-account .target-date {
  font-size: 0.9rem;
  color: var(--text-muted);
  font-style: italic;
  margin-left: 5px;
}

.journalit-account .target-progress {
  font-size: 0.9rem;
  color: var(--text-muted);
  margin-left: 5px;
}

.journalit-account .profit-target-progress {
  margin-top: 10px;
}

.journalit-account .progress-container {
  width: 100%;
  height: 10px;
  background-color: var(--background-modifier-border);
  border-radius: 5px;
  overflow: hidden;
}

.journalit-account .progress-bar {
  height: 100%;
  background-color: var(--interactive-accent);
  border-radius: 5px;
  transition: width 0.5s ease;
}

.journalit-account .progress-bar.complete {
  background-color: gold; /* Gold color when target is reached */
}

/* Transaction Table Styles */
.journalit-account .account-transactions {
  margin-top: 20px;
}

.journalit-account .transactions-table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 10px;
  font-size: 0.9rem;
}

.journalit-account .transactions-table thead {
  background-color: var(--background-secondary);
}

.journalit-account .transactions-table th {
  text-align: left;
  padding: 10px;
  font-weight: 600;
  color: var(--text-normal);
  border-bottom: 2px solid var(--background-modifier-border);
}

.journalit-account .transactions-table td {
  padding: 10px;
  border-bottom: 1px solid var(--background-modifier-border);
}

.journalit-account .transactions-table .transaction-row:hover {
  background-color: var(--background-secondary);
}

.journalit-account .transactions-table .positive {
  color: var(--interactive-success);
}

.journalit-account .transactions-table .negative {
  color: var(--text-error);
}

.journalit-account .transactions-table .deposit {
  background-color: rgba(var(--interactive-success-rgb), 0.05);
}

.journalit-account .transactions-table .withdrawal {
  background-color: rgba(var(--text-error-rgb), 0.05);
}

.journalit-account .empty-transactions {
  padding: 20px;
  text-align: center;
  color: var(--text-muted);
  background-color: var(--background-secondary);
  border-radius: 4px;
}

/* Account Dashboard View Styles */
.journalit-account-dashboard-container {
  padding: 20px;
  height: 100%;
  overflow-y: auto;
  background-color: var(--background-primary);
}

.journalit-account-dashboard {
  width: 100%;
  padding: 20px;
}

.journalit-account-dashboard .dashboard-content {
  display: flex;
  flex-direction: column;
  width: 100%;
}

/* AUM Chart Styles */
.journalit-account-dashboard .aum-chart {
  width: 100%;
  margin-bottom: 10px;
}

/* Dashboard Header Styles */
.journalit-account-dashboard .dashboard-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 20px;
  padding: 16px 20px;
  background-color: var(--background-secondary);
  border-radius: 8px;
  border: 1px solid var(--background-modifier-border);
}

.journalit-account-dashboard .dashboard-title h2 {
  margin: 0 0 4px 0;
  font-size: 1.5rem;
  font-weight: 600;
  color: var(--text-normal);
}

.journalit-account-dashboard .dashboard-title p {
  margin: 0;
  font-size: 0.9rem;
  color: var(--text-muted);
}

.journalit-account-dashboard .dashboard-actions {
  display: flex;
  align-items: center;
  gap: 12px;
}

.journalit-account-dashboard .create-account-button {
  flex-shrink: 0;
  background-color: var(--interactive-accent);
  color: white;
  border: 1px solid var(--interactive-accent);
  border-radius: 6px;
  padding: 10px;
  cursor: pointer;
  transition: background-color 0.2s ease, transform 0.1s ease;
}

.journalit-account-dashboard .create-account-button:hover {
  background-color: var(--interactive-accent-hover);
  border-color: var(--interactive-accent-hover);
  transform: translateY(-1px);
}

.journalit-account-dashboard .settings-button {
  flex-shrink: 0;
  background-color: transparent;
  color: var(--text-muted);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  padding: 10px;
  cursor: pointer;
  transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease;
}

.journalit-account-dashboard .settings-button:hover {
  background-color: var(--background-modifier-hover);
  color: var(--text-normal);
  border-color: var(--background-modifier-border-hover);
}

/* Account Dashboard Settings Modal Styles */
.account-dashboard-settings-modal-container {
  max-width: 700px;
  margin: 0 auto;
  padding: 0 12px;
}

/* Folder Migration Modal Styles */
.folder-migration-modal-container {
  max-width: 600px;
  margin: 0 auto;
  padding: 0 12px;
}

.folder-migration-modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  z-index: 9999;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 20px;
}

.folder-migration-modal {
  background: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  padding: 0;
  max-width: 600px;
  width: 100%;
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
}

.migration-warning-header {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 20px 24px;
  background: linear-gradient(135deg, rgba(var(--color-red-rgb), 0.1) 0%, rgba(var(--color-red-rgb), 0.05) 100%);
  border-bottom: 1px solid var(--background-modifier-border);
  border-radius: 8px 8px 0 0;
}

.migration-warning-header .warning-icon {
  color: var(--text-error);
  flex-shrink: 0;
}

.migration-warning-header h3 {
  margin: 0;
  font-size: 1.2rem;
  font-weight: 600;
  color: var(--text-error);
  border: none;
  padding: 0;
}

.migration-content {
  padding: 24px;
}

.migration-warning {
  margin-bottom: 24px;
  padding: 16px;
  background: rgba(var(--color-red-rgb), 0.1);
  border: 1px solid rgba(var(--color-red-rgb), 0.3);
  border-radius: 6px;
}

.migration-warning p {
  margin: 0 0 8px 0;
  color: var(--text-normal);
  line-height: 1.5;
}

.migration-warning p:last-child {
  margin-bottom: 0;
}

.migration-details {
  margin-bottom: 24px;
}

.migration-path-container {
  display: flex;
  flex-direction: column;
  gap: 12px;
  padding: 16px;
  background: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
}

.migration-path {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 0;
}

.migration-path .path-label {
  font-weight: 500;
  color: var(--text-muted);
  min-width: 50px;
}

.migration-path .path-text {
  background: var(--background-modifier-form-field);
  padding: 4px 8px;
  border-radius: 4px;
  font-family: var(--font-monospace);
  font-size: 0.9rem;
  color: var(--text-normal);
  flex: 1;
}

.migration-arrow {
  color: var(--text-muted);
  align-self: center;
  margin: 4px 0;
}

.impact-analysis {
  margin-bottom: 24px;
}

.impact-analysis h4 {
  margin: 0 0 12px 0;
  font-size: 1rem;
  font-weight: 600;
  color: var(--text-normal);
}

.impact-details {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.impact-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  background: var(--background-secondary);
  border-radius: 4px;
  border-left: 3px solid var(--interactive-accent);
}

.impact-item svg {
  color: var(--interactive-accent);
  flex-shrink: 0;
}

.impact-item span {
  color: var(--text-normal);
  line-height: 1.4;
}

.backup-notice {
  margin-bottom: 24px;
  padding: 16px;
  background: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  border-left: 4px solid var(--interactive-accent);
}

.backup-notice-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 8px;
}

.backup-notice-header svg {
  color: var(--interactive-accent);
}

.backup-notice-header h5 {
  margin: 0;
  font-size: 0.95rem;
  font-weight: 600;
  color: var(--text-normal);
}

.backup-notice p {
  margin: 0 0 8px 0;
  color: var(--text-normal);
  line-height: 1.5;
}

.backup-details {
  margin-top: 8px;
  padding-top: 8px;
  border-top: 1px solid var(--background-modifier-border);
}

.backup-details span {
  font-size: 0.9rem;
  color: var(--text-muted);
}

.backup-details code {
  background: var(--background-modifier-form-field);
  padding: 2px 4px;
  border-radius: 3px;
  font-family: var(--font-monospace);
  font-size: 0.85rem;
}

.safety-information {
  margin-bottom: 24px;
}

.safety-information h5 {
  margin: 0 0 8px 0;
  font-size: 0.95rem;
  font-weight: 600;
  color: var(--text-normal);
}

.safety-information ul {
  margin: 0;
  padding-left: 20px;
  list-style: none;
}

.safety-information li {
  margin-bottom: 4px;
  color: var(--text-normal);
  line-height: 1.4;
  position: relative;
  padding-left: 4px;
}

.safety-information li::before {
  content: '\u2713';
  color: var(--text-success);
  font-weight: 600;
  position: absolute;
  left: -16px;
}

.final-warning {
  padding: 16px;
  background: rgba(var(--color-red-rgb), 0.1);
  border: 1px solid rgba(var(--color-red-rgb), 0.2);
  border-radius: 6px;
  margin-bottom: 0;
}

.final-warning p {
  margin: 0;
  color: var(--text-normal);
  line-height: 1.5;
}

/* Migration Modal Progress Bar - unique class names */
.migration-progress-bar {
  width: 100%;
  height: 8px;
  background: var(--background-modifier-border, #e0e0e0);
  border-radius: 4px;
  overflow: hidden;
  margin-bottom: 12px;
}

.migration-progress-fill {
  height: 100%;
  background: var(--interactive-accent, #007acc);
  transition: width 0.3s ease;
  border-radius: 4px;
  /* No default width - controlled by inline styles */
}

/* Migration Progress Section */
.migration-progress-section {
  background: var(--background-primary);
  padding: 20px;
  border-radius: 6px;
  margin-bottom: 16px;
  border: 1px solid var(--background-modifier-border);
}

.migration-progress-section h4 {
  margin: 0 0 16px 0;
  color: var(--text-normal);
  font-weight: 600;
  font-size: 14px;
}

.progress-container {
  margin-bottom: 16px;
}

.progress-bar {
  width: 100%;
  height: 8px;
  background: var(--background-secondary, #f0f0f0);
  border-radius: 4px;
  overflow: hidden;
  margin-bottom: 12px;
}

.progress-fill {
  height: 100%;
  background: var(--interactive-accent, #007acc);
  transition: width 0.3s ease;
  border-radius: 4px;
  /* No default width - allow inline styles to control width */
}

.progress-info {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}

.progress-phase {
  font-weight: 600;
  color: var(--text-normal);
  font-size: 13px;
  text-transform: capitalize;
}

.progress-message {
  color: var(--text-muted);
  font-size: 12px;
  flex: 1;
  text-align: center;
  margin: 0 16px;
}

.progress-percentage {
  font-weight: 600;
  color: var(--text-normal);
  font-size: 13px;
}

.detailed-progress {
  background: var(--background-secondary);
  padding: 8px 12px;
  border-radius: 4px;
  font-size: 11px;
  color: var(--text-muted);
  margin-top: 8px;
}

/* Migration Result Section */
.migration-result-section {
  background: var(--background-primary);
  padding: 20px;
  border-radius: 6px;
  margin-bottom: 16px;
  border: 1px solid var(--background-modifier-border);
}

.migration-result-section.success {
  border-color: var(--text-success);
  background: var(--background-primary);
}

.migration-result-section.error {
  border-color: var(--text-error);
  background: var(--background-primary);
}

.result-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 16px;
  font-weight: 600;
  font-size: 14px;
}

.migration-result-section.success .result-header {
  color: var(--text-success);
}

.migration-result-section.error .result-header {
  color: var(--text-error);
}

.result-details {
  color: var(--text-normal);
}

.result-details p {
  margin: 0 0 12px 0;
  line-height: 1.5;
}

.migration-stats {
  display: flex;
  gap: 24px;
  margin: 12px 0;
  padding: 12px;
  background: var(--background-secondary);
  border-radius: 4px;
  font-size: 13px;
}

.migration-stats span {
  color: var(--text-muted);
}

.backup-info {
  margin-top: 16px;
  padding: 12px;
  background: var(--background-secondary);
  border-radius: 4px;
  border-left: 3px solid var(--interactive-accent);
}

.backup-info p {
  margin: 0 0 8px 0;
  color: var(--text-normal);
  font-size: 13px;
}

.backup-info code {
  background: var(--background-primary);
  padding: 2px 6px;
  border-radius: 3px;
  font-family: var(--font-monospace);
  color: var(--text-accent);
  font-size: 12px;
}

.backup-cleanup-note {
  color: var(--text-muted) !important;
  font-size: 12px !important;
  margin-top: 8px !important;
}

.error-message {
  color: var(--text-error) !important;
  background: var(--background-secondary);
  padding: 8px 12px;
  border-radius: 4px;
  font-family: var(--font-monospace);
  font-size: 12px;
  margin: 8px 0;
}

.rollback-info {
  color: var(--text-accent) !important;
  background: var(--background-secondary);
  padding: 8px 12px;
  border-radius: 4px;
  font-size: 12px;
  margin: 8px 0;
}

.close-migration-button {
  min-width: 80px;
  padding: 8px 16px;
}

.migration-modal-actions {
  display: flex;
  gap: 12px;
  justify-content: flex-end;
  padding: 20px 24px;
  background: var(--background-secondary);
  border-top: 1px solid var(--background-modifier-border);
  border-radius: 0 0 8px 8px;
}

.cancel-migration-button {
  min-width: 100px;
  padding: 8px 16px;
}

.confirm-migration-button {
  min-width: 120px;
  padding: 8px 16px;
}

.migration-danger-button {
  background-color: var(--text-error) !important;
  border-color: var(--text-error) !important;
  color: white !important;
}

.migration-danger-button:hover {
  background-color: var(--background-modifier-error-hover) !important;
  border-color: var(--background-modifier-error-hover) !important;
}

/* Mobile responsiveness for migration modal */
@media (max-width: 600px) {
  .folder-migration-modal {
    margin: 10px;
    max-width: calc(100vw - 20px);
  }

  .migration-content {
    padding: 16px;
  }

  .migration-warning-header {
    padding: 16px;
  }

  .migration-path-container {
    padding: 12px;
  }

  .migration-path .path-text {
    font-size: 0.8rem;
    word-break: break-all;
  }

  .migration-modal-actions {
    flex-direction: column;
    gap: 8px;
    padding: 16px;
  }

  .cancel-migration-button,
  .confirm-migration-button {
    width: 100%;
  }
}

.account-dashboard-settings-form {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.account-dashboard-settings-form .setting-item {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 16px;
  background-color: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
}

.account-dashboard-settings-form .setting-item:last-child {
  border-bottom: 1px solid var(--background-modifier-border);
}

.account-dashboard-settings-form .setting-item-info {
  width: 100%;
}

.account-dashboard-settings-form .setting-item-name {
  font-size: 15px;
  font-weight: 600;
  color: var(--text-normal);
  margin-bottom: 3px;
}

.account-dashboard-settings-form .setting-item-description {
  font-size: 12px;
  color: var(--text-muted);
  line-height: 1.4;
  margin-bottom: 4px;
}

.account-dashboard-settings-form .setting-item-control {
  width: 100%;
}

.account-dashboard-settings-form .available-account-types {
  width: 100%;
}

.account-dashboard-settings-form .available-account-types > div {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  justify-content: flex-start;
  align-items: flex-start;
}

.account-type-badge {
  padding: 6px 12px;
  border-radius: 6px;
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  color: var(--text-normal);
  font-size: 13px;
  font-weight: 500;
}

.no-account-types {
  color: var(--text-muted);
  font-style: italic;
  text-align: left;
}

/* Account Types Settings Table */
.account-types-settings-table {
  width: 100%;
}

.account-types-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.account-type-setting-row {
  display: flex;
  align-items: center;
  padding: 12px;
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
}

.account-type-name {
  font-weight: 500;
  color: var(--text-normal);
  flex: 1;
  margin-right: 16px;
  min-width: 0;
  text-align: left;
}

.account-type-controls {
  display: flex;
  gap: 12px;
  align-items: center;
  flex-shrink: 0;
  margin-left: auto;
}

.toggle-label {
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 12px;
  color: var(--text-normal);
  cursor: pointer;
  white-space: nowrap;
}

.toggle-label input[type="checkbox"] {
  margin: 0;
  cursor: pointer;
  transform: scale(0.9);
}

/* Account Type Order Management */
.account-type-order-container {
  width: 100%;
  max-width: 400px;
  margin: 0 auto;
}

.account-type-order-list {
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  padding: 8px;
}

.order-list {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.order-list-item {
  display: flex;
  align-items: center;
  padding: 8px 10px;
  background-color: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 3px;
  transition: background-color 0.15s ease;
}

.order-list-item:hover {
  background-color: var(--background-modifier-hover);
}

.order-list-item .type-name {
  font-weight: 500;
  color: var(--text-normal);
  flex: 1;
  font-size: 13px;
  text-align: left;
  margin-right: 12px;
}

.order-controls {
  display: flex;
  gap: 2px;
  margin-left: auto;
  flex-shrink: 0;
}

.order-button {
  background-color: transparent;
  border: 1px solid var(--background-modifier-border);
  color: var(--text-muted);
  border-radius: 3px;
  padding: 4px 6px;
  cursor: pointer;
  font-size: 12px;
  font-weight: 600;
  transition: all 0.15s ease;
  min-width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  line-height: 1;
}

.order-button:hover:not(:disabled) {
  background-color: var(--background-modifier-hover);
  color: var(--text-normal);
  border-color: var(--background-modifier-border-hover);
}

.order-button:disabled {
  opacity: 0.3;
  cursor: not-allowed;
}

.settings-modal-buttons {
  display: flex;
  gap: 8px;
  justify-content: flex-end;
  margin-top: 16px;
  padding-top: 16px;
  border-top: 1px solid var(--background-modifier-border);
}

.settings-modal-buttons .save-settings-button {
  min-width: 90px;
  padding: 8px 16px;
}

.settings-modal-buttons .cancel-button {
  min-width: 60px;
  padding: 8px 12px;
}

/* Mobile responsiveness */
@media (max-width: 600px) {
  .account-dashboard-settings-modal-container {
    padding: 0 8px;
  }
  
  .account-dashboard-settings-form .setting-item {
    padding: 12px;
  }
  
  .account-type-setting-row {
    flex-direction: column;
    align-items: stretch;
    gap: 8px;
    padding: 10px;
  }
  
  .account-type-name {
    margin-right: 0;
    margin-bottom: 4px;
  }
  
  .account-type-controls {
    flex-direction: column;
    align-items: stretch;
    gap: 8px;
  }
  
  .toggle-label {
    justify-content: flex-start;
  }
  
  .settings-modal-buttons {
    flex-direction: column;
    gap: 8px;
  }
  
  .settings-modal-buttons .save-settings-button,
  .settings-modal-buttons .cancel-button {
    min-width: auto;
    width: 100%;
  }
}

.journalit-account-dashboard .create-account-primary-button {
  flex-shrink: 0;
  background-color: var(--interactive-accent);
  color: white;
  border: 1px solid var(--interactive-accent);
  border-radius: 6px;
  padding: 12px 24px;
  font-size: 1rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s ease, transform 0.1s ease;
}

.journalit-account-dashboard .create-account-primary-button:hover {
  background-color: var(--interactive-accent-hover);
  transform: translateY(-1px);
}

.journalit-account-dashboard .empty-state-with-action {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 20px;
  padding: 40px 20px;
}

.journalit-account-dashboard .empty-state-actions {
  display: flex;
  justify-content: center;
}

/* Dashboard placeholder styles */
.journalit-account-dashboard-placeholder {
  text-align: center;
  padding: 40px 20px;
  background-color: var(--background-secondary);
  border-radius: 8px;
  margin-top: 20px;
}

.journalit-account-dashboard-placeholder h2 {
  font-size: 1.8rem;
  margin-bottom: 20px;
  color: var(--text-normal);
}

.journalit-account-dashboard-placeholder p {
  font-size: 1rem;
  color: var(--text-muted);
  margin-bottom: 15px;
}

.journalit-account-dashboard-placeholder ul {
  text-align: left;
  max-width: 400px;
  margin: 20px auto;
}

.journalit-account-dashboard-placeholder li {
  margin-bottom: 8px;
  color: var(--text-normal);
}

/* New Account Dashboard Styles */

/* Dashboard Metrics Styles */
.journalit-account-dashboard .dashboard-metrics {
  display: flex;
  flex-direction: row;
  flex-wrap: nowrap;
  gap: 10px;
  margin-bottom: 30px;
  margin-top: 10px;
  padding: 0 10px;
  overflow-x: auto;
}

.journalit-account-dashboard .metric-item {
  flex: 1;
  min-width: 180px;
  max-width: 300px;
  padding: 15px;
  background-color: var(--background-secondary);
  border-radius: 8px;
  text-align: center;
  transition: transform 0.2s ease;
}

.journalit-account-dashboard .metric-item:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.journalit-account-dashboard .metric-value {
  font-size: 1.5rem;
  font-weight: 600;
  margin-bottom: 5px;
  color: var(--text-normal);
}

.journalit-account-dashboard .metric-value.positive {
  color: var(--text-success);
}

.journalit-account-dashboard .metric-value.negative {
  color: var(--text-error);
}

.journalit-account-dashboard .metric-label {
  font-size: 0.9rem;
  color: var(--text-muted);
}

/* Account Sections Styles */
.journalit-account-dashboard .account-sections {
  display: flex;
  flex-direction: column;
  gap: 15px;
  padding: 0 10px;
}

.journalit-account-dashboard .account-section {
  background-color: var(--background-primary);
  border-radius: 8px;
  padding: 0;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.journalit-account-dashboard .account-section h3 {
  font-size: 1.3rem;
  font-weight: 600;
  margin-bottom: 15px;
  padding-bottom: 10px;
  border-bottom: 1px solid var(--background-modifier-border);
  color: var(--text-normal);
}

/* Account Section Content - for empty state and virtualized list */
.journalit-account-dashboard .account-section-content {
  padding: 0 0 20px 0;
}

.journalit-account-dashboard .account-cards {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
  gap: 20px;
  padding: 0 0 20px 0;
}

/* Modern Account Card Styles */
.journalit-account-dashboard .account-card {
  background: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 12px;
  padding: 0;
  cursor: pointer;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  height: 100%; /* Ensure all cards have consistent height */
}

.journalit-account-dashboard .account-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
  border-color: var(--interactive-accent-hover);
}

/* Header Section */
.journalit-account-dashboard .account-card-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  padding: 20px 20px 16px 20px;
  border-bottom: 1px solid var(--background-modifier-border);
  background: linear-gradient(135deg, var(--background-secondary) 0%, var(--background-primary) 100%);
}

.journalit-account-dashboard .account-identity {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.journalit-account-dashboard .account-name {
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--text-normal);
  line-height: 1.2;
  margin: 0;
}

.journalit-account-dashboard .account-type-badge {
  font-size: 0.75rem;
  font-weight: 500;
  color: var(--text-muted);
  background: var(--background-modifier-form-field);
  padding: 4px 8px;
  border-radius: 6px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  width: fit-content;
}

.journalit-account-dashboard .account-balance {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 4px;
}

.journalit-account-dashboard .balance-amount {
  font-size: 1.25rem;
  font-weight: 700;
  color: var(--text-normal);
  line-height: 1.2;
}

.journalit-account-dashboard .balance-growth {
  font-size: 0.8rem;
  font-weight: 500;
  line-height: 1.2;
}

.journalit-account-dashboard .balance-growth.positive {
  color: var(--text-success);
}

.journalit-account-dashboard .balance-growth.negative {
  color: var(--text-error);
}

/* Body Section */
.journalit-account-dashboard .account-card-body {
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 20px;
  flex: 1; /* Allow body to grow and push footer to bottom */
}

/* Overall Dashboard Metrics - Original styles restored */
.journalit-account-dashboard .metric-item {
  flex: 1;
  min-width: 180px;
  max-width: 300px;
  padding: 15px;
  background-color: var(--background-secondary);
  border-radius: 8px;
  text-align: center;
  transition: transform 0.2s ease;
}

.journalit-account-dashboard .metric-item:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.journalit-account-dashboard .metric-value {
  font-size: 1.5rem;
  font-weight: 600;
  margin-bottom: 5px;
  color: var(--text-normal);
}

.journalit-account-dashboard .metric-value.positive {
  color: var(--text-success);
}

.journalit-account-dashboard .metric-value.negative {
  color: var(--text-error);
}

.journalit-account-dashboard .metric-label {
  font-size: 0.9rem;
  color: var(--text-muted);
}

/* Account Card Key Metrics - Specific styles */
.journalit-account-dashboard .account-card .key-metrics {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 12px;
}

.journalit-account-dashboard .account-card .key-metrics .metric-item {
  flex: none;
  min-width: 0;
  max-width: none;
  padding: 10px 6px;
  background: var(--background-modifier-form-field);
  transition: none;
  overflow: hidden;
}

.journalit-account-dashboard .account-card .key-metrics .metric-item:hover {
  transform: none;
  box-shadow: none;
  background: var(--background-modifier-form-field);
}

.journalit-account-dashboard .account-card .key-metrics .metric-item .metric-value {
  font-size: 0.9rem;
  font-weight: 600;
  color: var(--text-normal);
  margin-bottom: 4px;
  line-height: 1.2;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 100%;
}

.journalit-account-dashboard .account-card .key-metrics .metric-item .metric-label {
  font-size: 0.7rem;
  font-weight: 500;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  line-height: 1.2;
  white-space: nowrap;
}

/* Progress Section */
.journalit-account-dashboard .progress-section {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.journalit-account-dashboard .progress-item {
  display: flex;
  flex-direction: column;
  gap: 8px;
  min-height: 44px; /* Consistent height for all progress items */
}

.journalit-account-dashboard .progress-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  height: 20px; /* Fixed height for consistent alignment */
}

.journalit-account-dashboard .progress-label {
  font-size: 0.85rem;
  font-weight: 500;
  color: var(--text-muted);
}

/* Progress Label with Badge Container */
.journalit-account-dashboard .progress-label-with-badge {
  display: flex;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
}

/* Dashboard Status Badges (matching AccountPage badges) */
.journalit-account-dashboard .dashboard-status-badge {
  padding: 2px 6px;
  border-radius: 12px;
  font-size: 8px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.3px;
  border: 1px solid;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  white-space: nowrap;
  flex-shrink: 0;
}

.journalit-account-dashboard .dashboard-status-badge.in-progress {
  border-color: var(--color-warning);
  color: var(--color-warning);
  background: rgba(245, 158, 11, 0.1);
}

.journalit-account-dashboard .dashboard-status-badge.achieved {
  border-color: var(--text-success);
  color: var(--text-success);
  background: rgba(var(--color-green-rgb), 0.1);
}

.journalit-account-dashboard .dashboard-status-badge.breached {
  border-color: var(--text-error);
  color: var(--text-error);
  background: rgba(var(--color-red-rgb), 0.1);
}

.journalit-account-dashboard .progress-value {
  font-size: 0.85rem;
  font-weight: 600;
  color: var(--text-normal);
}

.journalit-account-dashboard .progress-value.not-set {
  color: var(--text-muted);
  font-style: italic;
  font-weight: 500;
}

/* Mute appearance for items without targets set */
.journalit-account-dashboard .progress-item.not-set {
  opacity: 0.7;
}

.journalit-account-dashboard .progress-bar-container {
  width: 100%;
  height: 8px;
  background: var(--background-modifier-border);
  border-radius: 4px;
  overflow: hidden;
  position: relative;
  margin-top: 8px; /* Consistent spacing */
}

.journalit-account-dashboard .progress-bar {
  height: 100%;
  border-radius: 4px;
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  position: absolute;
  left: 0;
  top: 0;
  min-width: 0;
}

/* Progress bar colors */
.journalit-account-dashboard .progress-bar.profit-target {
  background: linear-gradient(90deg, #3b82f6 0%, #2563eb 100%);
  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.2);
}

.journalit-account-dashboard .progress-bar.profit-target.complete {
  background: linear-gradient(90deg, #22c55e 0%, #16a34a 100%);
  box-shadow: 0 2px 8px rgba(34, 197, 94, 0.2);
}

.journalit-account-dashboard .progress-bar.drawdown.safe {
  background: linear-gradient(90deg, #22c55e 0%, #16a34a 100%);
  box-shadow: 0 2px 8px rgba(34, 197, 94, 0.2);
}

.journalit-account-dashboard .progress-bar.drawdown.warning {
  background: linear-gradient(90deg, #eab308 0%, #ca8a04 100%);
  box-shadow: 0 2px 8px rgba(234, 179, 8, 0.2);
}

.journalit-account-dashboard .progress-bar.drawdown.critical {
  background: linear-gradient(90deg, #ef4444 0%, #dc2626 100%);
  box-shadow: 0 2px 8px rgba(var(--color-red-rgb), 0.2);
}

/* Empty progress bar styling for consistency */
.journalit-account-dashboard .progress-bar.empty {
  background: transparent !important;
  width: 0% !important;
}

/* Hide progress bars when width is effectively 0 to prevent border-radius artifacts */
.journalit-account-dashboard .progress-bar[style*="width: 0%"] {
  display: none;
}

/* Footer */
.journalit-account-dashboard .account-card-footer {
  padding-top: 16px;
  border-top: 1px solid var(--background-modifier-border);
  display: flex;
  justify-content: space-between;
  align-items: center;
  min-height: 24px; /* Consistent footer height */
  gap: 12px;
}

.journalit-account-dashboard .footer-metric {
  display: flex;
  align-items: center;
  gap: 6px;
  min-width: 0; /* Allow shrinking */
}

.journalit-account-dashboard .footer-metric:first-child {
  flex: 1; /* Monthly cost takes remaining space */
}

.journalit-account-dashboard .footer-metric:last-child {
  flex: 0 0 auto; /* Total costs stays fixed size on the right */
  justify-content: flex-end;
}

.journalit-account-dashboard .footer-label {
  font-size: 0.75rem;
  color: var(--text-muted);
  font-weight: 500;
  white-space: nowrap;
}

.journalit-account-dashboard .footer-value {
  font-size: 0.75rem;
  color: var(--text-normal);
  font-weight: 600;
  white-space: nowrap;
}

/* Loading and Error States */
.journalit-account-dashboard.loading {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  font-size: 1.2rem;
  color: var(--text-muted);
}

.journalit-account-dashboard.error {
  padding: 20px;
  color: var(--text-error);
  background-color: rgba(var(--text-error-rgb), 0.05);
  border-left: 3px solid var(--text-error);
  margin: 20px;
  border-radius: 0 4px 4px 0;
}

.journalit-account-dashboard .loading-spinner {
  padding: 20px;
  text-align: center;
}

.journalit-account-dashboard .error-message {
  padding: 20px;
  font-weight: 500;
}

/* Enhanced Account Type Header Styles - Sleek Horizontal Layout */
.journalit-account-dashboard {
  /* Custom properties for easier overrides */
  --account-type-header-gap: 20px;
  --account-type-metrics-gap: 20px;
  --account-type-metrics-justify: flex-end;
  --account-type-metric-max-width: 120px;
}

.journalit-account-dashboard .account-type-header {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  gap: var(--account-type-header-gap, 20px);
  padding: 12px 10px;
  margin: 20px 0 16px 0;
  background: linear-gradient(135deg, var(--background-secondary) 0%, var(--background-primary) 100%);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
  position: relative;
  overflow: hidden;
}

/* Account Type Name Section - Enhanced Prominence */
.journalit-account-dashboard .account-type-header .account-type-name {
  /* Prevent inheritance from the generic .account-type-name { flex: 1 } rule */
  flex: 0 0 auto;
  margin-right: 0; /* rely on container gap for spacing */
  min-width: auto;
}

.journalit-account-dashboard .account-type-header .account-type-name h3 {
  margin: 0;
  font-size: 1.3rem;
  font-weight: 700;
  color: var(--text-normal);
  border: none;
  padding: 0;
  line-height: 1.2;
  text-transform: uppercase;
  letter-spacing: 0.3px;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

/* Metrics Container - Enhanced Responsiveness */
.journalit-account-dashboard .account-type-header .account-type-metrics {
  display: flex;
  align-items: center;
  gap: var(--account-type-metrics-gap, 20px);
  flex: 1;
  justify-content: var(--account-type-metrics-justify, flex-end);
  flex-wrap: wrap;
  min-width: 0; /* Allow container to shrink */
  margin-left: auto; /* Push metrics block to the right edge */
}

/* Individual Metric Items - Enhanced Flexibility */
.journalit-account-dashboard .account-type-header .metric-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
  min-width: 0;
  flex-shrink: 1;
  flex-basis: auto;
  padding: 0;
  background: none;
  border-radius: 0;
  transition: none;
  text-align: center;
  max-width: var(--account-type-metric-max-width, 120px); /* Prevent items from getting too wide */
}

.journalit-account-dashboard .account-type-header .metric-item:hover {
  transform: none;
  box-shadow: none;
  background: none;
}

/* Metric Values - Flexible Text Wrapping */
.journalit-account-dashboard .account-type-header .metric-item .metric-value {
  font-size: 0.9rem;
  font-weight: 600;
  color: var(--text-normal);
  margin: 0;
  line-height: 1.2;
  white-space: normal; /* Allow wrapping by default for better responsiveness */
  overflow-wrap: break-word; /* fallback */
  overflow-wrap: anywhere;   /* preferred modern behavior */
  word-break: normal;
  text-align: center;
}

/* Weight percent gets special emphasis */
.journalit-account-dashboard .account-type-header .metric-item .metric-value.weight-percent {
  font-size: 1rem;
  font-weight: 700;
  color: var(--color-info);
}

/* Excluded status styling */
.journalit-account-dashboard .account-type-header .metric-item .metric-value.excluded-status {
  font-size: 0.9rem;
  font-weight: 600;
  color: var(--text-muted);
  font-style: italic;
}

/* Growth color coding */
.journalit-account-dashboard .account-type-header .metric-item .metric-value.positive {
  color: var(--text-success);
}

.journalit-account-dashboard .account-type-header .metric-item .metric-value.negative {
  color: var(--text-error);
}

/* Metric Labels - Flexible Text Wrapping */
.journalit-account-dashboard .account-type-header .metric-item .metric-label {
  font-size: 0.7rem;
  font-weight: 500;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.3px;
  margin: 0;
  line-height: 1.2;
  white-space: normal; /* Allow wrapping by default for better responsiveness */
  overflow-wrap: break-word; /* fallback */
  overflow-wrap: anywhere;   /* preferred modern behavior */
  word-break: normal;
  text-align: center;
}

/* Align responsiveness with AccountCard single-column behavior (~370px) */
@media (max-width: 400px) {
  .journalit-account-dashboard .account-type-header {
    flex-direction: column;
    align-items: stretch;
    gap: 12px;
    padding: 16px 10px;
  }
  
  .journalit-account-dashboard .account-type-header .account-type-name {
    margin-right: 0;
    text-align: center;
    padding-bottom: 8px;
    border-bottom: 1px solid var(--background-modifier-border);
  }
  
  .journalit-account-dashboard .account-type-header .account-type-metrics {
    justify-content: center;
    gap: 16px;
  }
}

/* Grid layout for better metric organization */
@media (max-width: 350px) {
  .journalit-account-dashboard .account-type-header .account-type-metrics {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 16px 20px;
    justify-content: center;
  }
  
  .journalit-account-dashboard .account-type-header .metric-item .metric-value {
    font-size: 0.9rem;
    white-space: normal; /* Allow text wrapping */
    word-break: break-word;
  }
  
  .journalit-account-dashboard .account-type-header .metric-item .metric-label {
    font-size: 0.7rem;
    white-space: normal;
    word-break: break-word;
  }
}

/* More compact layout for smaller screens */
@media (max-width: 300px) {
  .journalit-account-dashboard .account-type-header .account-type-metrics {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px 16px;
    text-align: center;
  }
  
  .journalit-account-dashboard .account-type-header .metric-item {
    align-items: center;
    min-width: 0; /* Prevent overflow */
  }
  
  .journalit-account-dashboard .account-type-header .metric-item .metric-value {
    font-size: 0.8rem;
    white-space: normal;
    word-break: break-word;
    overflow-wrap: break-word;
  }
  
  .journalit-account-dashboard .account-type-header .metric-item .metric-label {
    font-size: 0.65rem;
    white-space: normal;
    word-break: break-word;
    overflow-wrap: break-word;
    line-height: 1.1;
  }
}

/* Extra small devices - hide less critical metrics */
@media (max-width: 480px) {
  .journalit-account-dashboard .account-type-header .account-type-metrics {
    gap: 10px 12px;
  }
  
  /* Hide withdrawals and trade count on very small screens to prioritize key metrics */
  .journalit-account-dashboard .account-type-header .metric-item:nth-child(3), /* Withdrawals */
  .journalit-account-dashboard .account-type-header .metric-item:nth-child(5) { /* Total Trades */
    display: none;
  }
  
  .journalit-account-dashboard .account-type-header .metric-item .metric-value {
    font-size: 0.75rem;
  }
  
  .journalit-account-dashboard .account-type-header .metric-item .metric-label {
    font-size: 0.6rem;
  }
}
`;function wee(){let e="journalit-account-styles";if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=IMe,document.head.appendChild(t)}function kee(){let e=document.getElementById("journalit-account-styles");e&&e.remove()}JB();OB();we.account={inject:wee,remove:kee};we.accountLinkModal={inject:YB,remove:KB};we.accountWeightBar={inject:FB,remove:iee};co();var MMe=`
/* Trade Log View Container
 * CRITICAL: All flex containers in the hierarchy must have min-height: 0
 * to fix Firefox and other browser flexbox scrolling issues.
 * See: https://stackoverflow.com/questions/36535656/using-flexbox-and-overflow-hidden-scroll-not-working-in-firefox
 */
.journalit-trade-log-view-container {
  height: 100%;
  overflow: hidden !important; /* Override ReactView inline styles */
  display: flex;
  flex-direction: column;
  padding: 0;
  min-height: 0; /* Critical for flexbox scrolling */
}

/* Target the React root element to prevent it from scrolling */
.journalit-trade-log-view-container > div[id^="react-root-"] {
  height: 100%;
  overflow: visible;
  display: flex;
  flex-direction: column;
  min-height: 0; /* Critical for flexbox scrolling */
}

/* Main Container */
.journalit-trade-log {
  display: flex;
  flex-direction: column;
  height: 100%;
  background: var(--background-primary);
  color: var(--text-normal);
  overflow: hidden;
  min-height: 0; /* Critical for flexbox scrolling */
}

/* Header */
.trade-log-header {
  padding: 12px 16px 6px 16px;
  border-bottom: 1px solid var(--background-modifier-border);
  background: var(--background-secondary);
}

.trade-log-controls {
  display: flex;
  gap: 16px;
  align-items: center;
  margin-bottom: 0;
  flex-wrap: wrap;
}

.trade-log-view-selector {
  display: flex;
  align-items: center;
  gap: 8px;
  flex: 0 0 auto;
  min-width: fit-content;
}

.trade-log-view-selector label {
  font-size: 13px;
  font-weight: 500;
  color: var(--text-muted);
  white-space: nowrap;
}

.trade-log-view-selector select {
  width: auto;
  padding: 6px 8px;
  border-radius: 4px;
  border: 1px solid var(--background-modifier-border);
  background: var(--background-primary);
  color: var(--text-normal);
  font-size: 13px;
  cursor: pointer;
}

/* Direct styling for view dropdown with minimal width */
.trade-log-view-dropdown {
  width: auto !important;
  max-width: fit-content !important;
  padding: 6px 8px !important;
  text-align: center !important;
}

.trade-log-view-selector select:hover {
  background: var(--background-modifier-hover);
}

.trade-log-view-selector select option {
  background-color: var(--background-primary) !important;
  color: var(--text-normal) !important;
  padding: 6px 8px !important;
}

.trade-log-view-selector select option:hover,
.trade-log-view-selector select option:focus {
  background-color: var(--background-modifier-hover) !important;
  color: var(--text-normal) !important;
}

.trade-log-filter-actions {
  display: flex;
  align-items: center;
  gap: 8px;
  flex: 0 0 auto;
  min-width: fit-content;
  margin-left: auto;
}

.trade-log-filter-actions > * {
  flex-shrink: 0;
}

/* Filter button base styles */
.journalit-filter-button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 6px;
  background-color: transparent;
  color: var(--text-muted);
  border: 1px solid transparent;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.journalit-filter-button:hover {
  background-color: var(--background-modifier-hover);
  color: var(--text-normal);
}

/* Multi-select button active state */
.journalit-filter-button-container .journalit-filter-button.active,
.journalit-filter-button.active {
  background-color: var(--interactive-accent);
  color: var(--text-on-accent);
}

.journalit-filter-button-container .journalit-filter-button.active:hover,
.journalit-filter-button.active:hover {
  background-color: var(--interactive-accent-hover);
}

.view-level-selector {
  display: flex;
  align-items: center;
  gap: 8px;
}

.view-level-selector label {
  font-weight: 500;
  color: var(--text-muted);
}

.date-range-selector {
  flex: 1;
  display: flex;
  justify-content: flex-end;
}

/* Advanced Filters */
.trade-log-advanced-filters {
  display: flex;
  align-items: center;
  gap: 24px;
  flex-wrap: wrap;
  padding: 12px;
  background: var(--background-primary-alt);
  border-radius: 4px;
  border: 1px solid var(--background-modifier-border);
}

.trade-type-filter-section {
  display: flex;
  align-items: center;
  gap: 12px;
}

.trade-type-filter-section label {
  font-weight: 500;
  color: var(--text-muted);
  white-space: nowrap;
}

.status-filter-section {
  display: flex;
  align-items: center;
  gap: 12px;
}

.status-filter-section label {
  font-weight: 500;
  color: var(--text-muted);
  white-space: nowrap;
}

/* Trade Type Filter Dropdown */
.journalit-tradelog-trade-type-filter {
  position: relative;
  min-width: 100px !important;
  max-width: 120px !important;
  width: 100% !important;
}

.journalit-tradelog-trade-type-dropdown {
  position: relative !important;
  width: 100% !important;
}

.journalit-tradelog-trade-type-summary {
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  padding: 5px 10px !important;
  background-color: var(--background-primary) !important;
  border: 1px solid var(--background-modifier-border) !important;
  border-radius: 4px !important;
  cursor: pointer !important;
  font-size: 0.9em !important;
  transition: all 0.2s ease !important;
  height: 28px !important;
  line-height: 1 !important;
  white-space: nowrap !important;
  gap: 8px !important;
}

.journalit-tradelog-trade-type-summary:hover {
  border-color: var(--interactive-accent) !important;
  background-color: var(--background-modifier-hover) !important;
}

.journalit-tradelog-trade-type-summary:focus-visible {
  outline: 2px solid var(--interactive-accent) !important;
  outline-offset: 2px !important;
}

.journalit-tradelog-trade-type-summary .dropdown-arrow {
  font-size: 10px;
  color: var(--text-muted);
  transition: transform 0.2s ease;
}

.journalit-tradelog-trade-type-options-dropdown {
  position: absolute;
  top: 100%;
  left: 0 !important;
  right: 0 !important;
  max-height: 250px;
  overflow-y: auto;
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  margin-top: 4px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  z-index: 100;
}

.journalit-tradelog-trade-type-option-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  cursor: pointer;
  transition: background-color 0.2s ease;
  font-size: 13px;
  white-space: nowrap;
}

.journalit-tradelog-trade-type-option-item:hover {
  background-color: var(--background-modifier-hover) !important;
}

.journalit-tradelog-trade-type-option-item:focus-visible {
  outline: 2px solid var(--interactive-accent) !important;
  outline-offset: -2px !important;
}

.journalit-tradelog-trade-type-option-item.select-all {
  font-weight: 500;
}

.journalit-tradelog-trade-type-divider {
  height: 1px;
  background-color: var(--background-modifier-border);
  margin: 4px 0;
}

/* Base Checkbox Styles (shared by all tradelog checkboxes) */
.journalit-tradelog-checkbox {
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  width: 14px !important;
  height: 14px !important;
  border: 1px solid var(--background-modifier-border) !important;
  border-radius: 2px !important;
  background-color: var(--background-primary) !important;
  font-size: 10px !important;
  color: var(--text-on-accent) !important;
  flex-shrink: 0 !important;
}

.journalit-tradelog-checkbox.checked {
  background-color: var(--interactive-accent) !important;
  border-color: var(--interactive-accent) !important;
}

.journalit-tradelog-trade-type-checkbox {
  /* Extends .journalit-tradelog-checkbox base class */
  /* Add any trade-type-specific overrides here if needed in future */
}

.journalit-tradelog-trade-type-checkbox.checked {
  /* Extends .journalit-tradelog-checkbox.checked base class */
}

.journalit-trade-log-view-container .journalit-tradelog-trade-type-option-item input[type="checkbox"] {
  margin: 0 !important;
  width: 14px !important;
  height: 14px !important;
  appearance: none !important;
  -webkit-appearance: none !important;
  border: 1px solid var(--background-modifier-border) !important;
  border-radius: 2px !important;
  background: var(--background-primary) !important;
  cursor: pointer !important;
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  position: relative !important;
  padding: 0 !important;
  font-size: 0 !important;
  min-width: 14px !important;
  max-width: 14px !important;
  min-height: 14px !important;
  max-height: 14px !important;
}

.journalit-trade-log-view-container .journalit-tradelog-trade-type-option-item input[type="checkbox"]:checked {
  background: var(--interactive-accent) !important;
  border-color: var(--interactive-accent) !important;
}

.journalit-trade-log-view-container .journalit-tradelog-trade-type-option-item input[type="checkbox"]:checked::after {
  content: '\u2713' !important;
  color: var(--text-on-accent) !important;
  font-size: 11px !important;
  font-weight: 900 !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  position: absolute !important;
  top: 0 !important;
  left: 0 !important;
  width: 100% !important;
  height: 100% !important;
  text-shadow: none !important;
  line-height: 1 !important;
}

.journalit-trade-log-view-container .journalit-tradelog-trade-type-option-item input[type="checkbox"]:checked + span {
  color: var(--interactive-accent);
  font-weight: 600;
}

/* Status Filter Dropdown */
.journalit-tradelog-status-filter {
  position: relative;
  min-width: 120px !important;
  max-width: 150px !important;
  width: 100% !important;
}

.journalit-tradelog-status-dropdown {
  position: relative !important;
  width: 100% !important;
}

.journalit-tradelog-status-summary {
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  padding: 5px 10px !important;
  background-color: var(--background-primary) !important;
  border: 1px solid var(--background-modifier-border) !important;
  border-radius: 4px !important;
  cursor: pointer !important;
  font-size: 0.9em !important;
  transition: all 0.2s ease !important;
  height: 28px !important;
  line-height: 1 !important;
  white-space: nowrap !important;
  gap: 8px !important;
}

.journalit-tradelog-status-summary:hover {
  border-color: var(--interactive-accent) !important;
  background-color: var(--background-modifier-hover) !important;
}

.journalit-tradelog-status-summary:focus-visible {
  outline: 2px solid var(--interactive-accent) !important;
  outline-offset: 2px !important;
}

.journalit-tradelog-status-summary .dropdown-arrow {
  font-size: 10px;
  color: var(--text-muted);
  transition: transform 0.2s ease;
}

.journalit-tradelog-status-options-dropdown {
  position: absolute;
  top: 100%;
  left: 0 !important;
  right: 0 !important;
  max-height: 300px;
  overflow-y: auto;
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  margin-top: 4px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  z-index: 100;
}

.journalit-tradelog-status-option-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  cursor: pointer;
  transition: background-color 0.2s ease;
  font-size: 13px;
  white-space: nowrap;
}

.journalit-tradelog-status-option-item:hover {
  background-color: var(--background-modifier-hover) !important;
}

.journalit-tradelog-status-option-item:focus-visible {
  outline: 2px solid var(--interactive-accent) !important;
  outline-offset: -2px !important;
}

.journalit-tradelog-status-option-item.select-all {
  font-weight: 500;
}

.journalit-tradelog-status-option-item.sub-option {
  padding-left: 24px;
  font-size: 12px;
  color: var(--text-muted);
}

.journalit-tradelog-status-divider {
  height: 1px;
  background-color: var(--background-modifier-border);
  margin: 4px 0;
}

.journalit-tradelog-status-checkbox {
  /* Extends .journalit-tradelog-checkbox base class */
  /* Add any status-specific overrides here if needed in future */
}

.journalit-tradelog-status-checkbox.checked {
  /* Extends .journalit-tradelog-checkbox.checked base class */
}

.journalit-trade-log-view-container .journalit-tradelog-status-option-item input[type="checkbox"] {
  margin: 0 !important;
  width: 14px !important;
  height: 14px !important;
  appearance: none !important;
  -webkit-appearance: none !important;
  border: 1px solid var(--background-modifier-border) !important;
  border-radius: 2px !important;
  background: var(--background-primary) !important;
  cursor: pointer !important;
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  position: relative !important;
  padding: 0 !important;
  font-size: 0 !important;
  min-width: 14px !important;
  max-width: 14px !important;
  min-height: 14px !important;
  max-height: 14px !important;
}

.journalit-trade-log-view-container .journalit-tradelog-status-option-item input[type="checkbox"]:checked {
  background: var(--interactive-accent) !important;
  border-color: var(--interactive-accent) !important;
}

.journalit-trade-log-view-container .journalit-tradelog-status-option-item input[type="checkbox"]:checked::after {
  content: '\u2713' !important;
  color: var(--text-on-accent) !important;
  font-size: 11px !important;
  font-weight: 900 !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  position: absolute !important;
  top: 0 !important;
  left: 0 !important;
  width: 100% !important;
  height: 100% !important;
  text-shadow: none !important;
  line-height: 1 !important;
}

.journalit-trade-log-view-container .journalit-tradelog-status-option-item input[type="checkbox"]:checked + span {
  color: var(--interactive-accent);
  font-weight: 600;
}

/* Content Area */
.trade-log-content {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 0 0 8px 0;
  position: relative;
  min-height: 0; /* Important for flex children to scroll properly */
  /* Optimize scrolling performance */
  -webkit-overflow-scrolling: touch;
  scroll-behavior: auto; /* Disable smooth scrolling for better performance */
  will-change: scroll-position;
  /* Cross-browser flexbox scrolling fix */
  contain: layout;
}


/* Ensure proper scrolling in trades view */

.trade-log-content.trades-view {

  display: flex;

  flex-direction: column;

  min-height: 0; /* Critical for flexbox scrolling */

  height: 100%; /* Force container to constrain children height */

  max-height: 100%; /* AnuPpuccin theme compatibility */

  overflow: visible; /* Remove outer scroll bar - let inner tree handle scrolling like days view */

}

/* Horizontal scroll wrapper for trades view (header + body share the same scroller) */
.trade-log-hscroll {
  width: 100%;
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  min-height: 0; /* allow child to scroll */
  overflow-x: auto;
  overflow-y: hidden;
  -webkit-overflow-scrolling: touch;
}

/* Inner container expands to actual table width (set via inline min-width) */
.trade-log-hscroll-inner {
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  min-height: 0; /* critical so react-window list can size + scroll */
  min-width: 100%; /* stretch to container width */
  width: max-content; /* allow content to grow wider than container for horizontal scrolling */
  position: relative; /* contain absolute positioned sizer row */
}

/* Ensure trades view content doesn\u2019t reserve extra vertical space below the list */
.trade-log-content.trades-view {
  overflow: hidden; /* prevent outer vertical gap, inner list handles scrolling */
}


/* Use native scrollbar for better performance */
.trade-log-content::-webkit-scrollbar {
  width: 8px;
}

.trade-log-content::-webkit-scrollbar-thumb {
  background: var(--background-modifier-border);
  border-radius: 4px;
}

/* Loading State */
.trade-log-loading {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 40px;
  color: var(--text-muted);
}

.spinner {
  display: inline-flex;
  align-items: center;
  gap: 8px;
}

.spinner::before {
  content: '';
  width: 16px;
  height: 16px;
  border: 2px solid var(--text-muted);
  border-top-color: transparent;
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}


/* Tree View */

.trade-log-tree {

  width: 100%;

  padding: 0;

  display: flex;
  flex-direction: column;
  flex: 1 1 auto; /* Allow tree to grow and shrink */
  height: auto;
  contain: layout; /* Improve rendering performance */

  min-height: 0; /* Critical for flexbox scrolling */

  /* Force proper overflow behavior in all browsers */

  overflow: visible;

}


/* Tree container for virtualized list */
.trade-log-tree-container {
  flex: 1;
  overflow: hidden;
  position: relative;
  min-height: 0; /* Critical for flexbox scrolling */
}

/* Empty state for when no data is available */
.trade-log-tree--empty {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 40px;
  color: var(--text-muted);
  font-style: italic;
}

/* Node Styles */
.trade-log-node {
  display: flex;
  align-items: stretch;
  min-height: 48px;
  position: relative;
  /* Fade in animation for lazy-loaded nodes */
  animation: fadeIn 0.2s ease-out;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.trade-log-node:hover {
  background-color: var(--background-modifier-hover);
}

/* Placeholder styles for lazy loading */
.trade-log-node-placeholder {
  display: flex;
  align-items: center;
  position: relative;
  opacity: 0.3;
}

/* Tree Structure Visualization */
.tree-structure {
  position: relative;
}

/* Only apply flex when tree-structure contains children (tree lines) */
.tree-structure:not(:empty) {
  display: flex;
  align-items: stretch;
}

.tree-level {
  width: 24px;
  position: relative;
}

.tree-level::before {
  content: '';
  position: absolute;
  left: 11px;
  top: 0;
  bottom: 0;
  width: 1px;
  background: var(--background-modifier-border);
}

/* Special case for last child - clip the vertical line */
.trade-log-node.is-last-child .tree-level.last-level::before {
  height: 24px;
}

/* Hide expand/collapse lines for leaf nodes */
.trade-log-node--trade .tree-expand-wrapper {
  height: auto;
  width: 12px;
  margin-right: 0;
}

/* Node wrapper */
.node-wrapper {
  flex: 1;
  display: flex;
  align-items: center;
  position: relative;
}

/* Trade node specific wrapper adjustment */
.trade-log-node--trade .node-wrapper {
  padding-left: 0;
}

/* Tree node indicator for trade items */
.tree-node-indicator {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 20px;
  position: relative;
  margin-right: 8px;
}

/* Tree connector line */
.tree-connector {
  position: absolute;
  left: -13px;
  top: 50%;
  width: 12px;
  height: 1px;
  background: var(--background-modifier-border);
}

.tree-connector--trade {
  top: 0;
}

/* Expand/collapse wrapper */
.tree-expand-wrapper {
  width: 20px;
  height: 48px;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  margin-right: 4px;
}

/* Tree leaf node (no children) */
.tree-leaf-node {
  width: 2px;
  height: 2px;
  background: var(--text-muted);
  border-radius: 50%;
  position: relative;
}

.tree-leaf-node::before {
  content: '';
  position: absolute;
  left: -5px;
  top: 50%;
  width: 5px;
  height: 1px;
  background: var(--background-modifier-border);
}

.tree-leaf-node--trade {
  background: var(--text-normal);
  margin-right: 0;
}

/* When in the tree indicator cell, adjust positioning */
.tree-indicator-cell .tree-leaf-node {
  margin-left: 7px;
}

.tree-indicator-cell .tree-connector {
  left: -6px;
  width: 6px;
  transform: translateY(-50%);
}


.node-content {
  display: flex;
  align-items: center;
  width: 100%;
  gap: 8px;
  padding-right: 16px;
}

/* Chevron Button */
.node-chevron {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 48px;
  padding: 0;
  border: none;
  background: transparent !important;
  color: var(--text-muted);
  cursor: pointer;
  position: relative;
}

.node-chevron:hover {
  background: transparent !important;
  color: var(--text-normal);
}

.node-chevron:active {
  background: transparent !important;
  color: var(--text-normal);
}

.node-chevron:focus {
  background: transparent !important;
  outline: none;
}

.node-chevron:focus-visible {
  background: transparent !important;
  outline: 2px solid var(--interactive-accent);
  outline-offset: 2px;
}

.node-chevron svg {
  width: 16px;
  height: 16px;
}

/* Node Label */
.node-label {
  flex: 0 0 auto;
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 0;
  border-radius: 0;
  cursor: pointer;
  font-weight: 700;
  text-transform: uppercase;
  color: var(--text-normal);
  transition: color 0.2s ease;
}

.node-label:hover {
  color: var(--text-accent);
  background-color: transparent;
}

/* Node type-specific styles */
.trade-log-node--year .node-label {
  font-size: 16px;
  font-weight: 600;
}

.trade-log-node--quarter .node-label,
.trade-log-node--month .node-label {
  font-size: 15px;
}

.trade-log-node--week .node-label,
.trade-log-node--day .node-label {
  font-size: 14px;
}

/* Metrics */
.node-metrics {
  display: flex;
  align-items: center;
  gap: 0;
  padding: 6px 12px;
  background: var(--background-modifier-border);
  border-radius: 4px;
  margin-left: auto;
}

.metric-column {
  display: flex;
  align-items: center;
  justify-content: center;
}

.metric-column--count {
  width: 90px;
  text-align: center;
}

.metric-column--winrate {
  width: 70px;
  text-align: center;
}

.metric-column--pnl {
  width: 130px;
  text-align: center;
}

.metric {
  font-size: 13px;
  font-weight: 500;
  white-space: nowrap;
  line-height: 1.4;
  font-family: var(--font-monospace);
}

.metric--count {
  color: var(--text-muted);
}

.metric--winrate {
  font-weight: 500;
}

.metric--winrate.high {
  color: var(--text-success);
}

.metric--winrate.medium {
  color: var(--text-warning);
}

.metric--winrate.low {
  color: var(--text-error);
}

.metric--pnl {
  font-weight: 600;
  font-family: var(--font-monospace);
}

.metric--pnl.positive {
  color: var(--color-green);
}

.metric--pnl.negative {
  color: var(--color-red);
}

.metric--pnl.neutral {
  color: var(--text-muted);
}

/* Performance Indicators */
.performance-indicator {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  margin-left: 8px;
  vertical-align: middle;
}

.performance-indicator svg {
  width: 16px;
  height: 16px;
  vertical-align: text-bottom;
}

.performance-indicator--best {
  color: var(--text-warning); /* Gold color for crown */
}

.performance-indicator--worst {
  color: var(--text-error); /* Red color for alert */
}

/* Make indicators more prominent on hover */
.node-label:hover .performance-indicator--best {
  color: var(--text-warning); /* Orange on hover */
}

.node-label:hover .performance-indicator--worst {
  color: var(--text-error); /* Lighter red on hover */
}

/* Column Headers */
.trade-log-headers {
  position: sticky;
  top: 0;
  background: var(--background-secondary);
  border-bottom: 2px solid var(--background-modifier-border);
  z-index: 10;
  padding: 0;
  flex-shrink: 0; /* Prevent headers from shrinking */
}

/* Max-width container for centering on large screens */
.trade-log-content-wrapper {
  max-width: 1600px;
  margin: 0 auto;
  width: 100%;
}


.trade-log-header-row {

  display: grid;

  /* grid-template-columns set via inline style from React */

  width: 100%;
  gap: 8px;

  align-items: center;

  padding: 12px 16px 12px 16px;

  font-size: 13px;

  font-weight: 600;

  color: var(--text-muted);

  text-transform: uppercase;

}


.header-cell {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  cursor: default;
}

.header-cell.sortable {
  cursor: pointer;
  user-select: none;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 4px;
  transition: color 0.2s ease;
}

.header-cell.sortable:hover {
  color: var(--text-normal);
  background-color: var(--background-modifier-hover);
  border-radius: 4px;
}

.header-cell.sorted {
  color: var(--interactive-accent);
  font-weight: 700;
}

.sort-indicator {
  flex-shrink: 0;
}

.sort-indicator-unsorted {
  flex-shrink: 0;
  color: var(--text-faint);
  opacity: 0.5;
}

.header-image {
  display: flex;
  align-items: center;
  justify-content: center;
}

.header-ticker {
  display: flex;
  align-items: center;
  justify-content: center;
}

.header-direction {
  display: flex;
  align-items: center;
  justify-content: center;
}

.header-duration {
  display: flex;
  align-items: center;
  justify-content: center;
}

.header-status {
  display: flex;
  align-items: center;
  justify-content: center;
}

.header-pnl {
  display: flex;
  align-items: center;
  justify-content: center;
}

.header-date {
  display: flex;
  align-items: center;
  justify-content: center;
}

.header-account {
  display: flex;
  align-items: center;
  justify-content: center;
}

.header-mistakes {
  display: flex;
  align-items: center;
  justify-content: center;
}

.header-setups {
  display: flex;
  align-items: center;
  justify-content: center;
}

.header-tags {
  display: flex;
  align-items: center;
  justify-content: center;
}

.header-reviewed {
  display: flex;
  align-items: center;
  justify-content: center;
}

.header-positionSize {
  display: flex;
  align-items: center;
  justify-content: center;
}

.header-thesis {
  display: flex;
  align-items: center;
  justify-content: center;
}

/* New column headers */
.header-exchange,
.header-entryTime,
.header-exitDate,
.header-exitTime,
.header-expirationDate,
.header-daysToExpiry,
.header-entryPrice,
.header-exitPrice,
.header-stopLoss,
.header-slDistanceDollar,
.header-slDistancePercent,
.header-riskAmount,
.header-rMultiple,
.header-positionValue,
.header-fees {
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Trade Details Row */
.trade-details-row {
  display: grid;
  /* grid-template-columns set via inline style from React */
  gap: 8px;
  align-items: center;
  flex: 1;
  padding: 0 16px;
}

/* Tree view trade details row */
.trade-details-row.tree-view-row {
  /* grid-template-columns set via inline style from React (includes 20px tree indicator) */
  gap: 6px;
  padding: 0 16px 0 0;
}

/* Tree indicator cell */
.tree-indicator-cell {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  position: relative;
  width: 20px;
}

/* Trades view mode specific styles */
.trade-log-content.trades-view .trade-log-node--trade {
  padding: 0;
}

.trade-log-content.trades-view .trade-details-row.trades-view-row {
  padding: 0 16px;
  width: 100%;
}

/* Make trade rows clickable */
.trade-log-node--trade {
  cursor: pointer;
}

.trade-log-node--trade:hover {
  background-color: var(--background-modifier-hover);
}

/* Trade cells */
.trade-image-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-image-wrapper {
  position: relative;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  /* Remove transition for better scroll performance */
  /* transition: transform 0.15s ease; */
}

.trade-image-wrapper:hover {
  /* Simpler hover effect without transform */
  opacity: 0.8;
}

.trade-preview-thumbnail {
  width: 40px;
  height: 40px;
  border-radius: 4px;
  overflow: hidden;
  border: 1px solid var(--background-modifier-border);
  background: var(--background-secondary);
  /* Prevent layout shift while images load */
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  /* Optimize image rendering */
  image-rendering: -webkit-optimize-contrast;
  backface-visibility: hidden;
  transform: translateZ(0);
}

.trade-image-count {
  position: absolute;
  bottom: -4px;
  right: -4px;
  background: var(--background-primary);
  color: var(--text-muted);
  font-size: 10px;
  padding: 2px 4px;
  border-radius: 3px;
  border: 1px solid var(--background-modifier-border);
  font-weight: 600;
}

.trade-no-image-icon {
  color: var(--text-faint);
}

.trade-ticker-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-ticker {
  font-weight: 600;
  color: var(--text-normal);
  display: inline-flex;
  align-items: center;
  gap: 6px;
}

.trade-direction-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-direction {
  font-size: 13px;
  font-weight: 500;
  text-transform: uppercase;
  color: var(--text-normal);
}

/* Trade Status */
.trade-status {
  display: inline-block;
  padding: 2px 8px;
  border-radius: 3px;
  font-size: 12px;
  font-weight: 600;
  text-transform: uppercase;
}

.status-win {
  background: rgba(76, 175, 80, 0.15);
  color: var(--color-green);
}

.status-loss {
  background: rgba(244, 67, 54, 0.15);
  color: var(--color-red);
}

.status-breakeven {
  background: rgba(128, 128, 128, 0.15);
  color: var(--text-muted);
}

.status-missed {
  background: rgba(255, 149, 0, 0.15);
  color: var(--color-warning);
}

.status-open {
  background: rgba(33, 150, 243, 0.15);
  color: var(--status-open-color);
}

.status-backtest {
  background: rgba(111, 66, 193, 0.15);
  color: var(--text-accent);
}

.trade-pnl-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-pnl {
  font-weight: 600;
  font-family: var(--font-monospace);
  font-size: 15px;
}

.trade-pnl.positive {
  color: var(--color-green);
}

.trade-pnl.negative {
  color: var(--color-red);
}

.trade-pnl.neutral {
  color: var(--text-muted);
}

.trade-pnl.open {
  color: var(--status-open-color);
  font-style: italic;
}

.trade-status-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-duration-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-duration {
  color: var(--text-muted);
  font-size: 13px;
}

.trade-date-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-date {
  color: var(--text-muted);
  font-size: 13px;
  font-family: var(--font-monospace);
}

.trade-mistakes-cell,
.trade-setups-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-account-cell {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 4px 8px;
}

/* Single account pill badge (matching STATUS column style) */
.trade-account-text {
  display: inline-block;
  padding: 2px 8px;
  border-radius: 3px;
  font-size: 12px;
  font-weight: 600;
  text-transform: uppercase;
  white-space: nowrap;
  background: var(--background-modifier-hover);
  color: var(--interactive-accent);
}

.trade-account-text:hover {
  background: var(--background-modifier-border);
}

/* Multiple accounts: icon wrapper with badge */
.trade-account-icon-wrapper {
  position: relative;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: help;
}

.trade-account-icon {
  color: var(--text-accent);
}

.trade-account-icon:hover {
  color: var(--interactive-accent);
}

/* Count badge (top-right corner of icon) */
.trade-account-count-badge {
  position: absolute;
  top: -5px;
  right: -5px;
  display: flex;
  align-items: center;
  justify-content: center;
  min-width: 12px;
  height: 12px;
  padding: 0 3px;
  border-radius: 6px;
  background: var(--interactive-accent);
  color: var(--text-on-accent);
  font-size: 8px;
  font-weight: 600;
  line-height: 12px;
  text-align: center;
}

/* Tags column */
.trade-tags-cell {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 4px 8px;
}

.trade-tags-icon-wrapper {
  position: relative;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: help;
}

.trade-tags-icon {
  color: var(--text-accent);
}

.trade-tags-icon:hover {
  color: var(--interactive-accent);
}

.trade-tags-count-badge {
  position: absolute;
  top: -5px;
  right: -5px;
  display: flex;
  align-items: center;
  justify-content: center;
  min-width: 12px;
  height: 12px;
  padding: 0 3px;
  border-radius: 6px;
  background: var(--interactive-accent);
  color: var(--text-on-accent);
  font-size: 8px;
  font-weight: 600;
  line-height: 12px;
  text-align: center;
}

.custom-tags-tooltip .tooltip-title {
  color: var(--interactive-accent);
}

/* Reviewed column */
.trade-reviewed-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-reviewed-icon {
  flex-shrink: 0;
}

.trade-reviewed-icon--yes {
  color: var(--color-green);
}

.trade-reviewed-icon--no {
  color: var(--text-muted);
}

/* Select checkbox cell */
.trade-select-cell {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
}

.trade-select-checkbox {
  width: 16px;
  height: 16px;
  cursor: pointer;
  accent-color: var(--interactive-accent);
}

.header-select {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
}

.header-select input[type="checkbox"] {
  width: 16px;
  height: 16px;
  cursor: pointer;
  accent-color: var(--interactive-accent);
}

/* Position Size column */
.trade-position-size-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-position-size {
  font-family: var(--font-monospace);
  font-size: 13px;
  color: var(--text-normal);
}

/* Expiration Date column */
.trade-expiration-date-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-expiration-date {
  font-family: var(--font-monospace);
  font-size: 13px;
  color: var(--text-normal);
}

/* Days to Expiry column */
.trade-dte-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-dte-circle {
  display: inline-block;
  padding: 3px 8px;
  border-radius: 4px;
  font-size: 12px;
  font-weight: 600;
  min-width: 28px;
  text-align: center;
}

.trade-dte-circle--green {
  background: rgba(76, 175, 80, 0.15);
  color: var(--color-green);
}

.trade-dte-circle--yellow {
  background: rgba(245, 158, 11, 0.15);
  color: #d97706;
}

.trade-dte-circle--red {
  background: rgba(244, 67, 54, 0.15);
  color: var(--color-red);
}

.trade-dte-number {
  line-height: 1;
}

.trade-dte-expired {
  font-size: 12px;
  color: var(--text-muted);
  font-style: italic;
}

.trade-thesis-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-thesis {
  font-size: 13px;
  color: var(--text-normal);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  cursor: help;
}

/* New Column Cells */
.trade-exchange-cell,
.trade-entry-time-cell,
.trade-exit-date-cell,
.trade-exit-time-cell,
.trade-entry-price-cell,
.trade-exit-price-cell,
.trade-stop-loss-cell,
.trade-sl-distance-cell,
.trade-sl-distance-percent-cell,
.trade-risk-amount-cell,
.trade-r-multiple-cell,
.trade-mae-cell,
.trade-mfe-cell,
.trade-mae-price-cell,
.trade-mfe-price-cell,
.trade-mae-percent-cell,
.trade-mfe-percent-cell,
.trade-position-value-cell,
.trade-fees-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-exchange {
  color: var(--text-muted);
  font-size: 13px;
}

.trade-entry-time,
.trade-exit-time {
  color: var(--text-muted);
  font-size: 13px;
  font-family: var(--font-monospace);
}

.trade-exit-date {
  color: var(--text-muted);
  font-size: 13px;
  font-family: var(--font-monospace);
}

.trade-entry-price,
.trade-exit-price,
.trade-stop-loss {
  color: var(--text-muted);
  font-size: 13px;
  font-family: var(--font-monospace);
}

.trade-sl-distance,
.trade-sl-distance-percent {
  color: var(--text-muted);
  font-size: 13px;
  font-family: var(--font-monospace);
}

.trade-risk-amount {
  color: var(--text-muted);
  font-size: 13px;
  font-family: var(--font-monospace);
}

.trade-r-multiple {
  font-size: 13px;
  font-weight: 600;
  font-family: var(--font-monospace);
}

.trade-r-multiple.positive {
  color: var(--color-green);
}

.trade-r-multiple.negative {
  color: var(--color-red);
}

.trade-position-value {
  color: var(--text-normal);
  font-size: 13px;
  font-family: var(--font-monospace);
}

.trade-fees {
  color: var(--text-muted);
  font-size: 13px;
  font-family: var(--font-monospace);
}

.trade-mae,
.trade-mfe {
  font-size: 13px;
  font-family: var(--font-monospace);
}

.trade-mae-price,
.trade-mfe-price {
  color: var(--text-muted);
  font-size: 13px;
  font-family: var(--font-monospace);
}

.trade-mae-percent,
.trade-mfe-percent {
  color: var(--text-muted);
  font-size: 13px;
  font-family: var(--font-monospace);
}

.trade-no-data {
  color: var(--text-faint);
  font-size: 13px;
}

/* Count Badges */
.count-badge {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  font-size: 12px;
  font-weight: 600;
  cursor: help;
  /* Remove transition for better performance */
  /* transition: all 0.15s ease; */
}

.count-badge--mistakes {
  background: rgba(244, 67, 54, 0.15);
  color: var(--color-red);
  border: 1px solid rgba(244, 67, 54, 0.3);
}

.count-badge--mistakes:hover {
  background: rgba(244, 67, 54, 0.25);
  /* Remove transform for better performance */
  /* transform: scale(1.1); */
}

.count-badge--setups {
  background: rgba(33, 150, 243, 0.15);
  color: var(--color-info);
  border: 1px solid rgba(33, 150, 243, 0.3);
}

.count-badge--setups:hover {
  background: rgba(33, 150, 243, 0.25);
  /* Remove transform for better performance */
  /* transform: scale(1.1); */
}

/* Sizer row for expanded mode - measures column widths */
/* Uses absolute position within a zero-height container to avoid affecting scroll */
.trade-log-sizer-row {
  position: absolute;
  top: 0;
  left: 0;
  height: 0;
  overflow: visible; /* Allow content to render for measurement */
  pointer-events: none;
  opacity: 0; /* Hide visually but keep in layout for measurement */
}

.trade-log-sizer-row .sizer-cell {
  display: inline-flex;
  flex-shrink: 0;
}

.trade-log-sizer-row .expanded-pills.sizer-pills {
  display: inline-flex;
  flex-wrap: nowrap;
  gap: 4px;
  /* No constraints - must report true intrinsic width */
  overflow: visible;
  max-width: none;
  width: auto;
}

/* Expanded Mode - Pills for tags/setups/mistakes */
.trade-setups-cell.expanded,
.trade-mistakes-cell.expanded,
.trade-tags-cell.expanded {
  justify-content: center;
  padding: 4px 0;
  min-width: 0;
}

.expanded-pills {
  display: flex;
  flex-wrap: nowrap;
  gap: 4px;
  align-items: center;
}

.pill {
  display: inline-flex;
  align-items: center;
  padding: 2px 8px;
  border-radius: 12px;
  font-size: 11px;
  font-weight: 500;
  white-space: nowrap;
  max-width: 120px;
  overflow: hidden;
  text-overflow: ellipsis;
}

.pill--setup {
  background: rgba(33, 150, 243, 0.15);
  color: var(--color-info);
  border: 1px solid rgba(33, 150, 243, 0.3);
}

.pill--mistake {
  background: rgba(244, 67, 54, 0.15);
  color: var(--color-red);
  border: 1px solid rgba(244, 67, 54, 0.3);
}

.pill--tag {
  background: var(--background-modifier-hover);
  color: var(--text-normal);
  border: 1px solid var(--background-modifier-border);
}

/* Tooltip Styles - scoped to trade log to avoid affecting other views */
.journalit-trade-log-view-container .tooltip-trigger {
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  width: 100%;
}

.journalit-tooltip {
  background: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  padding: 8px 12px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  max-width: 250px;
  min-width: 120px;
  font-size: 13px;
  color: var(--text-normal);
  z-index: 9999;
  pointer-events: none;
  position: fixed !important;
}

.tooltip-title {
  font-weight: 600;
  margin-bottom: 4px;
  color: var(--text-normal);
}

.tooltip-item {
  color: var(--text-muted);
  margin: 2px 0;
  line-height: 1.4;
  white-space: nowrap;
}

.mistakes-tooltip .tooltip-title {
  color: var(--color-red);
}

.setups-tooltip .tooltip-title {
  color: var(--interactive-accent);
}

.accounts-tooltip .tooltip-title {
  color: var(--text-accent);
}

.thesis-tooltip .tooltip-content {
  white-space: pre-wrap;
  word-break: break-word;
  line-height: 1.5;
  color: var(--text-normal);
}

/* Responsive Design */
@media (max-width: 1440px) {
  .journalit-dashboard-custom-date-dropdown {
    right: -250px !important;
    width: 300px !important;
  }

  .journalit-dashboard-custom-date-dropdown.position-left {
    left: -250px !important;
    width: 300px !important;
  }
}

@media (max-width: 1200px) {
  /* grid-template-columns handled dynamically by React for responsive column widths */

  .metric--best,
  .metric--worst {
    display: none;
  }

  .trade-pnl {
    font-size: 14px;
  }

  .trade-log-controls {
    gap: 12px;
  }

  .trade-log-view-selector select {
    min-width: 75px;
    font-size: 12px;
  }
}

@media (max-width: 996px) {
  .journalit-dashboard-custom-date-dropdown {
    right: -100px !important;
  }

  .journalit-dashboard-custom-date-dropdown.position-left {
    left: -100px !important;
  }
}

@media (max-width: 900px) {
  /* grid-template-columns handled dynamically by React for responsive column widths */


  /* Removed automatic hiding of account/mistakes/setups columns at small widths to prevent phantom blank space */
  .trade-account-cell,

  .header-account,

  .trade-mistakes-cell,

  .trade-setups-cell,

  .header-mistakes,

  .header-setups {

    /* display: none; */

  }


  .trade-pnl {
    font-size: 13px;
  }

  .trade-log-controls {
    gap: 8px;
  }

  .trade-log-view-selector {
    gap: 6px;
  }

  .trade-log-view-selector label {
    font-size: 12px;
  }

  .trade-log-filter-actions {
    gap: 6px;
  }
}

@media (max-width: 768px) {
  .trade-pnl {
    font-size: 12px;
  }

  .trade-log-controls {
    gap: 6px;
    flex-wrap: wrap;
  }

  .trade-log-view-selector label {
    display: none;
  }

  .trade-log-view-selector select {
    min-width: 68px;
    font-size: 11px;
    padding: 4px 6px;
  }

  .trade-log-filter-actions {
    gap: 4px;
  }

  .journalit-dashboard-custom-date-dropdown {
    position: static !important;
    width: 100% !important;
    margin-top: 8px !important;
    flex-direction: column !important;
    box-shadow: none !important;
    left: auto !important;
    right: auto !important;
  }

  .journalit-dashboard-custom-date-dropdown.position-left,
  .journalit-dashboard-custom-date-dropdown.position-below {
    position: static !important;
    left: auto !important;
    right: auto !important;
  }
}

@media (max-width: 600px) {
  .trade-pnl {
    font-size: 12px;
  }
}

@media (max-width: 480px) {
  .trade-log-controls {
    gap: 4px;
  }

  .trade-log-view-selector select {
    min-width: 65px;
    font-size: 10px;
  }

  .trade-log-filter-actions {
    gap: 2px;
  }

  .journalit-dashboard-custom-date-dropdown.position-below {
    max-width: 100% !important;
  }
}

/* Position below fallback for when horizontal space is insufficient */
.journalit-dashboard-custom-date-dropdown.position-below {
  top: 100% !important;
  left: 0 !important;
  right: auto !important;
  margin-top: 8px !important;
  width: 100% !important;
  max-width: 360px !important;
}

`;function Cee(){let e=document.createElement("style");e.id="trade-log-styles",e.textContent=MMe,document.head.appendChild(e)}function Pee(){let e=document.head.querySelector("#trade-log-styles");e&&e.remove()}we.tradeLog={inject:()=>{Cee()},remove:()=>{Pee()}};co();QI();we.csvImport={inject:QB,remove:KI};iq();wI();Tr();rl();aM();tM();i0();t1();var _F=class{constructor(t){this.plugin=t}async cleanup(){if(this.plugin.uiStateManager)try{await this.plugin.uiStateManager.flush()}catch(r){console.error("Error flushing UI state on unload:",r)}if(this.plugin.settingsManager)try{await this.plugin.settingsManager.getDebouncedSave().flush()}catch(r){(r instanceof Error?r.message:String(r)).includes("cancelled")||console.error("Error flushing settings manager debounced save on unload:",r)}window.__dropdownClickHandlerAdded=!1,window.__isHandlingComboBoxRemove=!1,window.__isInjectingStyles=!1,window.__JOURNALIT_INJECT_DRC_STYLES=void 0,window.__obsidianStartTime=void 0;try{this.plugin.viewManager?this.plugin.viewManager.cleanupViews():this.plugin.app.workspace.getLeavesOfType(sd).forEach(r=>{r.detach()})}catch(r){console.error("Error detaching view leaves:",r)}try{this.plugin.processorManager?this.plugin.processorManager.cleanupProcessors():this.plugin.tradeNoteProcessor&&this.plugin.tradeNoteProcessor.cleanup()}catch(r){console.error("Error cleaning up processors:",r)}this.plugin.tradeNoteProcessor=null;try{jp.getInstance().cleanup()}catch(r){console.error("Error cleaning up GlobalPasteManager:",r)}try{Wu(!1,!1,!1,!1,!1,!1,!1,!1)}catch(r){console.error("Error during style cleanup:",r)}try{pW()}catch(r){console.error("Error removing filter modal styles:",r)}try{lW()}catch(r){console.error("Error removing filter chip styles:",r)}try{tW()}catch(r){console.error("Error removing filter button styles:",r)}try{dW()}catch(r){console.error("Error removing collapsible section styles:",r)}if([".journalit-trade-view",".journalit-trade-note-wrapper",".journalit-drc-view",".journalit-drc-note-wrapper",".weekly-review-wrapper",".journalit-weekly-review-view",".weekly-review"].forEach(r=>{try{document.querySelectorAll(r).forEach(i=>{var a;try{r===".weekly-review"&&typeof i.empty=="function"&&((a=i.empty)==null||a.call(i)),i.remove()}catch(o){console.error(`Error removing element ${r}:`,o)}})}catch(n){console.error(`Error processing selector ${r}:`,n)}}),window.journalitPlugin=void 0,window.JournalitPlugin=void 0,gm.instance=null,this.plugin.serviceManager)this.plugin.serviceManager.cleanupServices();else{let r=this.plugin;r.authManager=null,r.tradeService=null,r.setupService=null,r.drcService=null,r.weeklyReviewService=null,r.monthlyReviewService=null,r.optionsService=null,r.customFieldsService=null,this.plugin.backendIntegrationService=null}this.plugin.backendIntegrationService=null,this.plugin.reviewDataCache&&(this.plugin.reviewDataCache.destroy(),this.plugin.reviewDataCache=null);try{th.resetInstance()}catch(r){console.error("Error cleaning up EventBus:",r)}this.plugin.updateNotificationService&&(this.plugin.updateNotificationService.cleanup(),this.plugin.updateNotificationService=null)}};var ebe=require("obsidian");Vc();sy();aq();var BGe="data.backup.json",WGe=300*1e3,BF=class{constructor(t){this.saveMutex=new Qw;this.lastKnownKeyCount=0;this.lastKnownKeys=new Set;this.lastBackupTime=0;this.plugin=t,this.debouncedSave=oy(()=>this.saveSettingsInternal(),1e3)}async loadSettings(){let t=null,r=!1;try{t=await this.plugin.loadData()}catch(i){console.error("SettingsManager: Failed to load main settings:",i)}if(!this.isValidSettingsStructure(t)){console.warn("SettingsManager: Main settings invalid or corrupted, attempting backup recovery...");let i=await this.tryLoadBackup();if(this.isValidSettingsStructure(i)){t=i,r=!0,console.log("SettingsManager: Successfully recovered settings from backup");try{await this.plugin.saveData(t),console.log("SettingsManager: Restored backup as main settings")}catch(a){console.error("SettingsManager: Failed to restore backup as main settings:",a)}}else console.warn("SettingsManager: No valid backup found, using defaults")}let n=this.deepMergeSettings(Qn,t||{});return this.lastKnownKeyCount=Object.keys(n).length,this.lastKnownKeys=new Set(Object.keys(n)),await this.migrateHttpToHttpsUrls(n),await this.migrateQuickLinks(n),await this.migrateCustomOptionsToNamespaced(n),await this.migrateDeprecatedHomeLayoutItems(n),this.lastKnownKeyCount=Object.keys(n).length,this.lastKnownKeys=new Set(Object.keys(n)),r&&this.plugin.app.workspace.onLayoutReady(()=>{new ebe.Notice("Settings were recovered from backup. Some recent changes may be lost.",1e4)}),n}isValidSettingsStructure(t){if(!t||typeof t!="object")return!1;let n=["general","trade"].every(a=>a in t),i=Object.keys(t).length>=5;return n&&i}async saveSettings(t){return this.saveMutex.withLock(async()=>{try{this.logSettingsChanges(t);let r=this.validateSettingsBeforeSave(t);if(!r.isValid)throw console.error("SettingsManager: Settings validation failed, aborting save to prevent data loss"),console.error("Validation errors:",r.errors),console.error("Settings keys present:",Object.keys(t)),new Error(`Settings validation failed: ${r.errors.join(", ")}`);r.warnings.length>0&&console.warn("SettingsManager: Settings validation warnings:",r.warnings),t.weekly||(t.weekly=Qn.weekly),t.dashboard||(t.dashboard=Qn.dashboard),(!t.dashboard.layouts||Object.keys(t.dashboard.layouts).length===0)&&(t.dashboard.layouts=Qn.dashboard.layouts),t.dashboard.layouts.Default||(t.dashboard.layouts.Default=Qn.dashboard.layouts.Default),(!t.dashboard.activeLayout||!t.dashboard.layouts[t.dashboard.activeLayout])&&(t.dashboard.activeLayout="Default"),t.backendIntegration||(t.backendIntegration=Qn.backendIntegration),await this.createBackup(),await this.plugin.saveData(t),this.lastKnownKeyCount=Object.keys(t).length,this.lastKnownKeys=new Set(Object.keys(t))}catch(r){throw console.error("SettingsManager: Failed to save settings",r),r}})}getDebouncedSave(){return this.debouncedSave}async saveSettingsInternal(){let t=this.plugin.settings;t&&await this.saveSettings(t)}logSettingsChanges(t){var o;if(this.lastKnownKeys.size===0)return;let r=new Set(Object.keys(t)),n=[];for(let s of this.lastKnownKeys)r.has(s)||n.push(s);let i=[];for(let s of r)this.lastKnownKeys.has(s)||i.push(s);(n.length>0||i.length>0)&&(console.log("SettingsManager: Settings keys changed during save"),i.length>0&&console.log("  Added keys:",i),n.length>0&&(console.warn("  REMOVED keys:",n),console.warn("  Save triggered from:",(o=new Error().stack)==null?void 0:o.split(`
`).slice(2,6).join(`
`))),console.log(`  Key count: ${this.lastKnownKeyCount} -> ${r.size}`));let a=["customOptions_options","customTradeFields_options"];for(let s of a){let l=this.lastKnownKeys.has(s),c=r.has(s);l&&!c&&(console.error(`SettingsManager: CRITICAL - Namespaced key "${s}" is being removed!`),console.error("  This likely indicates settings corruption."))}}validateSettingsBeforeSave(t){let r=[],n=[];if(!t||typeof t!="object")return r.push("Settings object is null, undefined, or not an object"),{isValid:!1,errors:r,warnings:n};let i=["general","trade","account"];for(let l of i)l in t||r.push(`Critical settings key missing: ${l}`);let a=Object.keys(t).length;this.lastKnownKeyCount>0&&a<this.lastKnownKeyCount-3&&r.push(`Settings key count dropped significantly: ${this.lastKnownKeyCount} -> ${a}. This may indicate data corruption. Missing keys may include user custom options.`);let o="customOptions"in t&&t.customOptions&&Object.keys(t.customOptions).length>0,s="customOptions_options"in t&&t.customOptions_options&&Object.keys(t.customOptions_options).length>0;return!o&&!s&&this.lastKnownKeyCount>15&&n.push("No custom options found in settings - this may indicate data loss if you had custom tickers/setups"),t.account&&typeof t.account!="object"&&r.push("Account settings is not an object"),t.backendIntegration&&(typeof t.backendIntegration!="object"&&r.push("Backend integration settings is not an object"),"syncEnabled"in t.backendIntegration||n.push("Backend integration missing syncEnabled field")),{isValid:r.length===0,errors:r,warnings:n}}getBackupPath(){return`${this.plugin.app.vault.configDir}/plugins/${this.plugin.manifest.id}/${BGe}`}async createBackup(){try{let t=Date.now();if(t-this.lastBackupTime<WGe)return;let r=await this.plugin.loadData();if(r&&typeof r=="object"&&Object.keys(r).length>5){let n=this.getBackupPath();await this.plugin.app.vault.adapter.write(n,JSON.stringify(r,null,2)),this.lastBackupTime=t,console.log("SettingsManager: Backup created successfully")}}catch(t){console.warn("SettingsManager: Failed to create settings backup:",t)}}async tryLoadBackup(){try{let t=this.getBackupPath();if(!await this.plugin.app.vault.adapter.exists(t))return console.log("SettingsManager: No backup file found"),null;let n=await this.plugin.app.vault.adapter.read(t),i=JSON.parse(n);return console.log("SettingsManager: Backup loaded successfully"),i}catch(t){return console.error("SettingsManager: Failed to load backup:",t),null}}deepMergeSettings(t,r){var i,a,o,s,l,c,d,u,p,m,g,f,v,h,y,b,k,x,S,w,C,D,P,M,z,A;let n={...t};if(!r)return n;r.trade&&(n.trade={...t.trade,...r.trade},n.trade.skipWeekends===void 0&&(n.trade.skipWeekends=!0)),r.drc&&(n.drc={...t.drc,...r.drc,checklistItems:r.drc.checklistItems||t.drc.checklistItems,reviewQuestions:r.drc.reviewQuestions||t.drc.reviewQuestions,recurringGoals:r.drc.recurringGoals||t.drc.recurringGoals}),r.customOptions&&(n.customOptions={...t.customOptions,...r.customOptions}),r.initializedOptionTypes&&(n.initializedOptionTypes=r.initializedOptionTypes),r.customTradeFields&&(n.customTradeFields={...t.customTradeFields,...r.customTradeFields}),r.customFieldOptions&&(n.customFieldOptions={...t.customFieldOptions,...r.customFieldOptions}),r.weekly&&(n.weekly={...t.weekly,...r.weekly,reviewQuestions:r.weekly.reviewQuestions||t.weekly.reviewQuestions}),r.dashboard&&(n.dashboard={...t.dashboard,layouts:{...((i=t.dashboard)==null?void 0:i.layouts)||{},...r.dashboard.layouts||{}},activeLayout:r.dashboard.activeLayout||((a=t.dashboard)==null?void 0:a.activeLayout)||"Default",defaultFilters:{...((o=t.dashboard)==null?void 0:o.defaultFilters)||{},...r.dashboard.defaultFilters||{}},lastUsedFilters:r.dashboard.lastUsedFilters||((s=t.dashboard)==null?void 0:s.lastUsedFilters)},n.dashboard&&!n.dashboard.layouts.Default&&((c=(l=t.dashboard)==null?void 0:l.layouts)!=null&&c.Default)&&(n.dashboard.layouts.Default=t.dashboard.layouts.Default),n.dashboard&&n.dashboard.activeLayout&&!n.dashboard.layouts[n.dashboard.activeLayout]&&(console.warn("Active layout not found in saved layouts, resetting to Default"),n.dashboard.activeLayout="Default")),r.account&&(n.account={...t.account,...r.account,excludedAccountTypes:r.account.excludedAccountTypes||((d=t.account)==null?void 0:d.excludedAccountTypes),includeWithdrawalsFromExcluded:r.account.includeWithdrawalsFromExcluded||((u=t.account)==null?void 0:u.includeWithdrawalsFromExcluded),accountMetadata:r.account.accountMetadata||((p=t.account)==null?void 0:p.accountMetadata)||{}}),r.backendIntegration&&(n.backendIntegration={...t.backendIntegration,...r.backendIntegration}),r.uiCustomization&&(n.uiCustomization={...t.uiCustomization,...r.uiCustomization}),r.reviews&&(n.reviews={...t.reviews,...r.reviews}),r.reviewV2&&(n.reviewV2={...t.reviewV2,...r.reviewV2,customWidgetTypes:r.reviewV2.customWidgetTypes||((m=t.reviewV2)==null?void 0:m.customWidgetTypes)||[],templates:r.reviewV2.templates||((g=t.reviewV2)==null?void 0:g.templates)||[],tradeTemplates:r.reviewV2.tradeTemplates||((f=t.reviewV2)==null?void 0:f.tradeTemplates)||[]}),r.templates&&(n.templates={...t.templates,...r.templates}),n.general={currency:(h=(v=r.general)==null?void 0:v.currency)!=null?h:t.general.currency,displayName:(b=(y=r.general)==null?void 0:y.displayName)!=null?b:t.general.displayName,homeStartupBehavior:(x=(k=r.general)==null?void 0:k.homeStartupBehavior)!=null?x:t.general.homeStartupBehavior,onboardingCompleted:(w=(S=r.general)==null?void 0:S.onboardingCompleted)!=null?w:t.general.onboardingCompleted,journalFolderPath:(D=(C=r.general)==null?void 0:C.journalFolderPath)!=null?D:t.general.journalFolderPath},r.home&&(n.home={...t.home,...r.home,layouts:{...((P=t.home)==null?void 0:P.layouts)||{},...r.home.layouts||{}},recentItems:r.home.recentItems||((M=t.home)==null?void 0:M.recentItems)||[]}),r.csvTemplates?n.csvTemplates=r.csvTemplates:t.csvTemplates&&(n.csvTemplates=t.csvTemplates),r.csvHiddenBrokers?n.csvHiddenBrokers=r.csvHiddenBrokers:t.csvHiddenBrokers&&(n.csvHiddenBrokers=t.csvHiddenBrokers),r.csvFavoriteBroker!==void 0&&(n.csvFavoriteBroker=r.csvFavoriteBroker),r.csvFavoriteAccount!==void 0&&(n.csvFavoriteAccount=r.csvFavoriteAccount),r.csvLastAssetType?n.csvLastAssetType=r.csvLastAssetType:t.csvLastAssetType&&(n.csvLastAssetType=t.csvLastAssetType),r.tradeLog&&(n.tradeLog={...t.tradeLog,...r.tradeLog}),r.viewFilters&&(n.viewFilters={dashboard:r.viewFilters.dashboard||((z=t.viewFilters)==null?void 0:z.dashboard),reviews:r.viewFilters.reviews||((A=t.viewFilters)==null?void 0:A.reviews)}),r.symbolMappings?n.symbolMappings=r.symbolMappings:t.symbolMappings&&(n.symbolMappings=t.symbolMappings);for(let I in r)r.hasOwnProperty(I)&&!(I in n)&&(n[I]=r[I]);return n}async migrateHttpToHttpsUrls(t){var n;let r=!1;if((n=t.backendIntegration)!=null&&n.serverUrl){let i=t.backendIntegration.serverUrl;(i.includes("88.198.181.204")||i.includes(":8180")||i.includes("stg-api")||i==="http://91.99.99.169"||i==="http://api.journalit.co"||i==="http://journalit.co"||i==="https://journalit.co")&&(t.backendIntegration.serverUrl="https://api.journalit.co",r=!0,console.log(`Journalit: Migrated backend URL from ${i} to https://api.journalit.co`))}r&&(await this.saveSettings(t),console.log("Journalit: Backend URL migration completed"))}async migrateQuickLinks(t){let r=!1;if(t.home||(t.home=Qn.home,r=!0),!t.home.quickLinks)t.home.quickLinks=Qn.home.quickLinks,r=!0;else{let n=new Set(t.home.quickLinks.map(a=>a.id)),i=Qn.home.quickLinks;for(let a of i)n.has(a.id)||(t.home.quickLinks.push(a),r=!0,console.log(`Journalit: Added missing quick link: ${a.id}`))}r&&(await this.saveSettings(t),console.log("Journalit: Quick links migration completed"))}async migrateCustomOptionsToNamespaced(t){let r=!1;t.customOptions&&(!t.customOptions_options||Object.keys(t.customOptions_options).length===0)?(t.customOptions_options={...t.customOptions},r=!0,console.log("Journalit: Migrated custom options to namespaced storage")):t.customOptions&&t.customOptions_options&&(delete t.customOptions,r=!0),r&&await this.saveSettings(t)}async migrateDeprecatedHomeLayoutItems(t){var a;let r=new Set(["welcome","quickLinks"]);if(!((a=t.home)!=null&&a.layouts))return;let n=!1,i=[];for(let o of Object.keys(t.home.layouts)){let s=t.home.layouts[o];for(let l of["lg","md","sm","xs","xxs"]){let c=s[l];if(!c||!Array.isArray(c))continue;let d=c.length,u=c.filter(p=>r.has(p.i)).map(p=>p.i);s[l]=c.filter(p=>!r.has(p.i)),s[l].length<d&&(n=!0,i.push({layout:o,breakpoint:l,items:u}))}}n&&(console.log("Journalit: Migrated deprecated home layout items"),i.forEach(({layout:o,breakpoint:s,items:l})=>{console.log(`  Removed from ${o}[${s}]: ${l.join(", ")}`)}),await this.saveSettings(t))}};sy();var $Ge="ui-state.json",WF={recentItems:[]},$F=class{constructor(t){this.state={...WF};this.plugin=t,this.debouncedSave=oy(()=>this.saveStateInternal(),1e3)}getStatePath(){return`${this.plugin.app.vault.configDir}/plugins/${this.plugin.manifest.id}/${$Ge}`}async loadState(){try{let t=this.getStatePath();if(!await this.plugin.app.vault.adapter.exists(t))return this.state={...WF},this.state;let n=await this.plugin.app.vault.adapter.read(t),i=JSON.parse(n);return this.state={...WF,...i},this.state}catch(t){return console.warn("UIStateManager: Failed to load UI state, using defaults:",t),this.state={...WF},this.state}}getState(){return this.state}async updateState(t){this.state={...this.state,...t},await this.debouncedSave()}getDebouncedSave(){return this.debouncedSave}async saveStateInternal(){try{let t=this.getStatePath();await this.plugin.app.vault.adapter.write(t,JSON.stringify(this.state,null,2))}catch(t){console.error("UIStateManager: Failed to save UI state:",t)}}async flush(){await this.debouncedSave.flush()}hasLegacyUIData(t){var r,n,i,a,o,s,l,c,d,u,p,m,g;return!!((n=(r=t.home)==null?void 0:r.recentItems)!=null&&n.length||(i=t.dashboard)!=null&&i.lastUsedFilters||t.viewFilters||t.tradeLog||(a=t.home)!=null&&a.selectedPeriod||(o=t.trade)!=null&&o.lastAssetType||(s=t.dashboard)!=null&&s.activeLayout||(l=t.home)!=null&&l.activeLayout||(c=t.backendIntegration)!=null&&c.lastSyncTime||((d=t.backendIntegration)==null?void 0:d.syncCount)!==void 0||(p=(u=t.home)==null?void 0:u.positionSizeDefaults)!=null&&p.lastFuturesSymbol||(g=(m=t.home)==null?void 0:m.positionSizeDefaults)!=null&&g.lastForexSymbol)}async migrateFromSettings(t){var n,i,a,o,s,l,c,d,u,p,m,g,f;let r=!1;return((i=(n=t.home)==null?void 0:n.recentItems)==null?void 0:i.length)>0&&(this.state.recentItems=[...t.home.recentItems],r=!0),(a=t.dashboard)!=null&&a.lastUsedFilters&&(this.state.lastUsedFilters={...t.dashboard.lastUsedFilters},r=!0),t.viewFilters&&(this.state.viewFilters={...t.viewFilters},r=!0),t.tradeLog&&(this.state.tradeLog={...t.tradeLog},r=!0),(o=t.home)!=null&&o.selectedPeriod&&(this.state.selectedPeriod=t.home.selectedPeriod,r=!0),(s=t.trade)!=null&&s.lastAssetType&&(this.state.lastAssetType=t.trade.lastAssetType,r=!0),(l=t.dashboard)!=null&&l.activeLayout&&(this.state.dashboardActiveLayout=t.dashboard.activeLayout,r=!0),(c=t.home)!=null&&c.activeLayout&&(this.state.homeActiveLayout=t.home.activeLayout,r=!0),(d=t.backendIntegration)!=null&&d.lastSyncTime&&(this.state.lastSyncTime=t.backendIntegration.lastSyncTime,r=!0),((u=t.backendIntegration)==null?void 0:u.syncCount)!==void 0&&(this.state.syncCount=t.backendIntegration.syncCount,r=!0),(m=(p=t.home)==null?void 0:p.positionSizeDefaults)!=null&&m.lastFuturesSymbol&&(this.state.lastFuturesSymbol=t.home.positionSizeDefaults.lastFuturesSymbol,r=!0),(f=(g=t.home)==null?void 0:g.positionSizeDefaults)!=null&&f.lastForexSymbol&&(this.state.lastForexSymbol=t.home.positionSizeDefaults.lastForexSymbol,r=!0),r&&await this.saveStateInternal(),r}cleanMigratedFields(t){var r,n,i,a,o,s,l,c,d,u;return(r=t.home)!=null&&r.recentItems&&delete t.home.recentItems,(n=t.dashboard)!=null&&n.lastUsedFilters&&delete t.dashboard.lastUsedFilters,t.viewFilters&&delete t.viewFilters,t.tradeLog&&delete t.tradeLog,(i=t.home)!=null&&i.selectedPeriod&&delete t.home.selectedPeriod,(a=t.trade)!=null&&a.lastAssetType&&delete t.trade.lastAssetType,(o=t.backendIntegration)!=null&&o.lastSyncTime&&delete t.backendIntegration.lastSyncTime,((s=t.backendIntegration)==null?void 0:s.syncCount)!==void 0&&delete t.backendIntegration.syncCount,(c=(l=t.home)==null?void 0:l.positionSizeDefaults)!=null&&c.lastFuturesSymbol&&delete t.home.positionSizeDefaults.lastFuturesSymbol,(u=(d=t.home)==null?void 0:d.positionSizeDefaults)!=null&&u.lastForexSymbol&&delete t.home.positionSizeDefaults.lastForexSymbol,t}};nr();co();eh();yB();function tbe(e=!1){if(!(window.__isInjectingStyles&&!e)){window.__isInjectingStyles=!0;try{Wu(!1,!1,!0,!0,!1,!1,!1,!0),we.shared&&we.shared.inject(),we.interactions&&we.interactions.inject(),we.combobox&&we.combobox.inject(),we.processorComponent&&we.processorComponent.inject(),we.settings&&we.settings.inject(),we.tooltip&&we.tooltip.inject(),Gx()}catch(t){console.error("Failed to inject critical styles:",t)}finally{window.__isInjectingStyles=!1}}}function rbe(){if(!window.__isInjectingStyles){window.__isInjectingStyles=!0;try{we.chart&&we.chart.inject(),we.dragOverlay&&we.dragOverlay.inject(),we.image&&we.image.inject(),we.tradeForm&&we.tradeForm.inject(),we.weeklyReview&&we.weeklyReview.inject(),we.drc&&we.drc.inject(),we.drcNote&&we.drcNote.inject(),we.tradeNote&&we.tradeNote.inject(),we.dashboard&&we.dashboard.inject(),we.account&&we.account.inject(),we.reviewV2&&we.reviewV2.inject(),typeof window!="undefined"&&we.drc&&(window.__JOURNALIT_INJECT_DRC_STYLES=we.drc.inject)}catch(e){console.error("Failed to inject non-critical styles:",e)}finally{window.__isInjectingStyles=!1}}}UF();wI();var Bi=require("obsidian");Wp();Xw();Tr();var VF=class{constructor(t){this.plugin=t}registerAllCommands(){this.registerAuthCommands(),this.registerRemainingCommands()}registerAuthCommands(){}registerRemainingCommands(){this.registerTradeCommands(),this.registerReviewCommands(),this.registerViewCommands(),this.registerSyncCommands(),this.registerMaintenanceCommands(),this.registerTemplateCommands()}registerTradeCommands(){this.plugin.addCommand({id:"add-trade",name:"Add New Trade",callback:async()=>{new Eo({app:this.plugin.app,plugin:this.plugin}).open()}}),this.plugin.addCommand({id:"import-trades-csv",name:"Import Trades from CSV",callback:async()=>{await this.plugin.viewManager.openCSVImportView()}})}registerReviewCommands(){this.plugin.addCommand({id:"create-drc",name:"Open DRC (Daily Report Card)",callback:async()=>{try{await(await this.plugin.serviceManager.getDRCService()).openDRC(new Date)}catch(t){console.error("Failed to open DRC:",t),new Bi.Notice("Failed to open DRC: "+(t instanceof Error?t.message:String(t)))}}}),this.plugin.addCommand({id:"create-weekly-review",name:"Open Weekly Review",callback:async()=>{try{await(await this.plugin.serviceManager.getWeeklyReviewService()).openWeeklyReview(new Date)}catch(t){console.error("Failed to open Weekly Review:",t),new Bi.Notice("Failed to open Weekly Review: "+(t instanceof Error?t.message:String(t)))}}}),this.plugin.addCommand({id:"create-monthly-review",name:"Open Monthly Review",callback:async()=>{try{await(await this.plugin.serviceManager.getMonthlyReviewService()).openMonthlyReview(new Date)}catch(t){console.error("Failed to open Monthly Review:",t),new Bi.Notice("Failed to open Monthly Review: "+(t instanceof Error?t.message:String(t)))}}}),this.plugin.addCommand({id:"create-quarterly-review",name:"Open Quarterly Review",callback:async()=>{try{await(await this.plugin.serviceManager.getQuarterlyReviewService()).openQuarterlyReview(new Date)}catch(t){console.error("Failed to open Quarterly Review:",t),new Bi.Notice("Failed to open Quarterly Review: "+(t instanceof Error?t.message:String(t)))}}}),this.plugin.addCommand({id:"create-yearly-review",name:"Open Yearly Review",callback:async()=>{try{await(await this.plugin.serviceManager.getYearlyReviewService()).openYearlyReview(new Date)}catch(t){console.error("Failed to open Yearly Review:",t),new Bi.Notice("Failed to open Yearly Review: "+(t instanceof Error?t.message:String(t)))}}})}registerViewCommands(){this.plugin.addCommand({id:"open-dashboard",name:"Open Trading Dashboard",callback:async()=>{await this.plugin.viewManager.openDashboardView()}}),this.plugin.addCommand({id:"open-account-dashboard",name:"Open Account Dashboard",callback:async()=>{await this.plugin.openAccountDashboard()}}),this.plugin.addCommand({id:"open-trade-log",name:"Open Trade Log",callback:async()=>{await this.plugin.viewManager.openTradeLogView()}}),this.plugin.addCommand({id:"open-home",name:"Open Home View",callback:async()=>{await this.plugin.viewManager.openHomeView()}})}registerSyncCommands(){this.plugin.addCommand({id:"force-sync",name:"Force Sync Trades",callback:async()=>{try{let r=await(await this.plugin.serviceManager.getBackendIntegrationService()).forceSync()}catch(t){console.error("Failed to force sync trades:",t),new Bi.Notice("Failed to sync trades: "+(t instanceof Error?t.message:String(t)))}}}),this.plugin.addCommand({id:"cancel-sync",name:"Cancel Trade Sync",callback:async()=>{try{(await this.plugin.serviceManager.getBackendIntegrationService()).cancelSync()}catch(t){new Bi.Notice("\u274C No sync in progress")}}})}registerMaintenanceCommands(){this.plugin.addCommand({id:"replay-onboarding",name:"Replay Onboarding Flow",callback:async()=>{await this.plugin.onboardingManager.showOnboardingModal()}}),this.plugin.addCommand({id:"open-release-notes",name:"View release notes",callback:async()=>{var t;try{await((t=this.plugin.updateNotificationService)==null?void 0:t.openReleaseNotes())}catch(r){console.error("Failed to open release notes:",r),new Bi.Notice("Failed to open release notes: "+(r instanceof Error?r.message:String(r)))}}}),this.plugin.addCommand({id:"migrate-legacy-reviews",name:"Migrate Legacy Review Notes to V2",callback:async()=>{try{let{LegacyMigrationService:t,MIGRATION_ID:r,LegacyMigrationConfirmModal:n,LegacyMigrationProgressModal:i,LegacyMigrationCompleteModal:a}=await Promise.resolve().then(()=>(dq(),obe)),o=new t(this.plugin);if(await mu(this.plugin.app,r)){new Bi.Notice("Legacy review migration has already been completed for this vault.");return}let l=await o.countLegacyNotes();if(l.total===0){new Bi.Notice("No legacy review notes found. All notes are already using Review V2!");return}new n(this.plugin.app,l,async()=>{let c=new i(this.plugin.app,l.total);c.open();try{let d=await o.migrateAll({backup:!0,onProgress:(u,p)=>{c.updateProgress(u,p)}});c.close(),new a(this.plugin.app,{migrated:d.migrated,failed:d.failed,skipped:d.skipped,backupsCreated:d.backupsCreated}).open()}catch(d){c.close(),console.error("Failed to migrate legacy reviews:",d),new Bi.Notice("Migration failed. Check console for details.")}},()=>{}).open()}catch(t){console.error("Failed to start legacy review migration:",t),new Bi.Notice("Failed to start migration: "+(t instanceof Error?t.message:String(t)))}}}),this.plugin.addCommand({id:"cleanup-migration-backups",name:"Clean Up Migration Backup Files",callback:async()=>{try{let r=this.plugin.app.vault.getFiles().filter(i=>i.path.endsWith(".legacy.md.bak"));if(r.length===0){new Bi.Notice("No backup files found to clean up.");return}let{BackupCleanupConfirmModal:n}=await Promise.resolve().then(()=>(qF(),abe));new n(this.plugin.app,r.length,async()=>{let i=0,a=0,o=new Bi.Notice(`Deleting backup files... 0/${r.length}`,0);for(let s of r){try{await this.plugin.app.vault.delete(s),i++}catch(l){console.error(`Failed to delete backup: ${s.path}`,l),a++}o.setMessage(`Deleting backup files... ${i+a}/${r.length}`)}o.hide(),a>0?new Bi.Notice(`Deleted ${i} backup files. ${a} failed.`):new Bi.Notice(`Successfully deleted ${i} backup files.`)},()=>{}).open()}catch(t){console.error("Failed to clean up backup files:",t),new Bi.Notice("Failed to clean up backup files: "+(t instanceof Error?t.message:String(t)))}}})}registerTemplateCommands(){this.plugin.addCommand({id:"open-layout-builder",name:"Open Layout Builder",callback:async()=>{try{await this.plugin.viewManager.openTemplateBuilderView()}catch(t){console.error("Failed to open Layout Builder:",t),new Bi.Notice("Failed to open Layout Builder: "+(t instanceof Error?t.message:String(t)))}}}),this.plugin.addCommand({id:"switch-template",name:"Switch Template",callback:async()=>{var t,r,n,i,a,o;try{let s=this.plugin.app.workspace.getActiveViewOfType(Bi.MarkdownView);if(!(s!=null&&s.file)){new Bi.Notice("No active file. Open a note first.");return}let l=this.plugin.app.metadataCache.getFileCache(s.file),c=l==null?void 0:l.frontmatter,d=c==null?void 0:c.type,u=c==null?void 0:c.templateId,{ReviewTemplateService:p}=await Promise.resolve().then(()=>(Nd(),IW)),{TradeTemplateService:m}=await Promise.resolve().then(()=>(bf(),MW)),{openTemplatePickerModal:g}=await Promise.resolve().then(()=>(EW(),DW)),f=[],v="Switch Template",h;if(d==="drc")f=new p(this.plugin).getTemplates("drc"),v="Switch DRC Template",h=(t=this.plugin.settings.templates)==null?void 0:t.defaultDrc;else if(d==="weekly-review")f=new p(this.plugin).getTemplates("weekly"),v="Switch Weekly Review Template",h=(r=this.plugin.settings.templates)==null?void 0:r.defaultWeekly;else if(d==="monthly-review")f=new p(this.plugin).getTemplates("monthly"),v="Switch Monthly Review Template",h=(n=this.plugin.settings.templates)==null?void 0:n.defaultMonthly;else if(d==="quarterly-review")f=new p(this.plugin).getTemplates("quarterly"),v="Switch Quarterly Review Template",h=(i=this.plugin.settings.templates)==null?void 0:i.defaultQuarterly;else if(d==="yearly-review")f=new p(this.plugin).getTemplates("yearly"),v="Switch Yearly Review Template",h=(a=this.plugin.settings.templates)==null?void 0:a.defaultYearly;else if(d==="trade"||d==="backtest-trade")f=new m(this.plugin).getTemplates(),v="Switch Trade Template",h=(o=this.plugin.settings.templates)==null?void 0:o.defaultTrade;else{new Bi.Notice("This note type does not support templates.");return}if(f.length===0){new Bi.Notice("No templates available for this note type.");return}g(this.plugin.app,f,u,v,async y=>{let b=s.file.path;if(d==="drc"||d==="weekly-review"||d==="monthly-review"||d==="quarterly-review"||d==="yearly-review"){let{TemplateTransformationService:k}=await Promise.resolve().then(()=>(uh(),vte));await new k(this.plugin).applyTemplate(b,y,!0)&&new Bi.Notice(`Switched to: ${y.name}`)}else await this.plugin.app.fileManager.processFrontMatter(s.file,k=>{k.templateId=y.id,k.templateVersion=y.version}),xe.publish("trade:changed",{action:"updated",filePaths:[b]}),new Bi.Notice(`Switched to: ${y.name}`)},h)}catch(s){console.error("Failed to switch template:",s),new Bi.Notice("Failed to switch template: "+(s instanceof Error?s.message:String(s)))}}})}};var sbe=require("obsidian"),GF=class{constructor(t){this.plugin=t}registerRibbonIcons(){this.registerHomeRibbon()}registerHomeRibbon(){this.plugin.addRibbonIcon("circle-dot-dashed","Open Journalit",async()=>{try{await this.plugin.viewManager.openHomeView()}catch(t){console.error("[Journalit] Failed to open home view from ribbon:",t),new sbe.Notice("Failed to open Journalit. Please try reloading Obsidian.")}})}};var Pbe=require("obsidian"),eO=class{constructor(t){this.plugin=t}async showOnboardingModal(){try{let t=await this.plugin.serviceManager.getOnboardingService();await t.startOnboarding();let{OnboardingWizardModalWrapper:r}=await Promise.resolve().then(()=>(Dq(),Pq));new r(this.plugin.app,this.plugin,async i=>{this.plugin.settings.general&&(this.plugin.settings.general.onboardingCompleted=!0),await this.plugin.saveSettings()},async()=>{await t.skipOnboarding()},void 0,void 0,t).open()}catch(t){console.error("Failed to launch onboarding flow:",t),new Pbe.Notice("Failed to open onboarding flow. Check console for details.")}}async checkAndShowOnboarding(){try{let t=`journalit-onboarding-ever-shown-${this.plugin.app.vault.getName()}`;if(localStorage.getItem(t))return;(await this.plugin.serviceManager.getOnboardingService()).shouldShowOnboarding()&&(localStorage.setItem(t,"true"),await this.showOnboardingModal())}catch(t){console.error("Error checking/showing onboarding:",t)}}};Oq();Nq();var zP=require("obsidian");AP();Op();var SO=class{constructor(t,r){this.plugin=t,this.app=t.app,this.viewManager=r}async openFile(t,r=!0){try{let n=this.app.vault.getAbstractFileByPath(t);if(n instanceof zP.TFile){let i=null;if(this.app.workspace.iterateAllLeaves(o=>{var c,d,u,p;if(i)return;if(o.view instanceof zP.FileView&&((c=o.view.file)==null?void 0:c.path)===t){i=o;return}let s=(d=o.view)==null?void 0:d.file;if(s instanceof zP.TFile&&s.path===t){i=o;return}let l=(p=(u=o.view)==null?void 0:u.getState)==null?void 0:p.call(u);if((l==null?void 0:l.file)===t){i=o;return}}),i){this.app.workspace.revealLeaf(i);return}await(r?this.app.workspace.getLeaf("tab"):this.app.workspace.getLeaf()).openFile(n)}else console.error(`Could not open file: ${t} - File not found or not a valid file`)}catch(n){console.error(`Error opening file: ${t}`,n)}}trackRecentView(t,r,n){if(t===es)return;let i={type:"view",title:r,viewType:t,icon:n,openedAt:new Date().toISOString()};this.addRecentItem(i)}async addRecentItem(t){let n=this.plugin.recentItems.filter(a=>t.type==="file"?a.path!==t.path:a.viewType!==t.viewType||a.title!==t.title);n.unshift(t);let i=n.length>20?n.slice(0,20):n;this.plugin.recentItems=i,await this.plugin.uiStateManager.updateState({recentItems:[...i]}),xe.publish("recent-items:changed",{recentItems:i.map(a=>({path:a.path||a.viewType||"",timestamp:new Date(a.openedAt).getTime(),type:a.type}))})}async openHomeOnStartup(){var t;try{let n=((t=this.plugin.settings.general)==null?void 0:t.homeStartupBehavior)||"always";if(n==="never")return;let i=this.app.workspace.getLeavesOfType(es);if(i.length>0){console.log("[Journalit] Home view already exists from workspace restoration"),n==="always"&&(console.log("[Journalit] Revealing existing home view"),this.app.workspace.revealLeaf(i[0]));return}let a=!1;if(n==="always")a=!0;else if(n==="ifNone"){let o=this.app.workspace.getActiveFile(),s=this.app.workspace.getLeavesOfType("markdown");a=!(o||s.length>0)}a&&(console.log("[Journalit] Opening Journalit view on startup"),await this.viewManager.openHomeView())}catch(r){console.error("Error opening Journalit on startup:",r)}}};var qb=require("obsidian");var Xq=require("obsidian"),TO=class{constructor(){this.containerEl=null;this.dismissed=!1;this.hideTimeoutId=null;this.onDismissCallback=null}createContainer(){this.containerEl=document.body.createDiv(),this.containerEl.addClass("journalit-update-toast"),this.containerEl.style.position="absolute",this.containerEl.style.bottom="24px",this.containerEl.style.left="24px",this.containerEl.style.zIndex="10000",this.containerEl.style.maxWidth="400px",this.containerEl.style.opacity="0",this.containerEl.style.transform="translateX(-100%)",this.containerEl.style.transition="opacity 0.3s ease-out, transform 0.3s ease-out",this.injectStyles()}injectStyles(){let t="journalit-update-toast-styles";if(document.getElementById(t))return;let r=document.createElement("style");r.id=t,r.textContent=`
			.journalit-update-toast {
				background: var(--background-primary);
				border: 1px solid var(--background-modifier-border);
				border-radius: 8px;
				box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
				padding: 0;
				font-family: var(--font-interface);
				position: relative;
				overflow: hidden;
			}

			.journalit-update-toast-title {
				color: var(--text-normal);
				font-size: 18px;
				font-weight: 500;
				margin: 0 0 12px 0;
				padding: 0 20px;
				letter-spacing: -0.02em;
				line-height: 1.3;
			}

			.journalit-update-toast-version {
				color: var(--text-accent);
				font-size: 11px;
				font-weight: 600;
				text-transform: uppercase;
				letter-spacing: 0.08em;
				margin: 0 0 4px 0;
				padding: 0 20px;
				display: block;
				opacity: 0.85;
			}

			.journalit-update-toast-close {
				position: absolute;
				top: 8px;
				right: 8px;
				background: var(--background-primary);
				border: 1px solid var(--background-modifier-border);
				border-radius: 50%;
				color: var(--text-muted);
				cursor: pointer;
				font-size: 14px;
				font-weight: 300;
				font-family: system-ui, -apple-system, sans-serif;
				line-height: 1;
				padding: 0;
				padding-bottom: 1px;
				width: 20px;
				height: 20px;
				display: flex;
				align-items: center;
				justify-content: center;
				z-index: 10;
			}

			.journalit-update-toast-close:hover {
				color: var(--text-normal);
				background: var(--background-secondary);
			}

			.journalit-update-toast-image {
				width: 100%;
				height: auto;
				border-radius: 8px 8px 0 0;
				margin-bottom: 12px;
				display: block;
			}

			.journalit-update-toast-description {
				color: var(--text-muted);
				font-size: 13px;
				line-height: 1.6;
				margin: 0 0 16px 0;
				padding: 0 20px;
				opacity: 0.9;
			}

			.journalit-update-toast-separator {
				border-top: 1px solid var(--background-modifier-border);
				margin: 0 0 12px 0;
			}

			.journalit-update-toast-button-container {
				padding: 0 20px 16px 20px;
				display: flex;
				justify-content: space-between;
				align-items: center;
			}

			.journalit-update-toast-button {
				background: var(--interactive-accent);
				color: var(--text-on-accent);
				border: none;
				border-radius: 6px;
				padding: 6px 12px;
				font-size: 12px;
				font-weight: 500;
				cursor: pointer;
				transition: background 0.2s ease;
				letter-spacing: 0.01em;
				display: flex;
				align-items: center;
				gap: 6px;
			}

			.journalit-update-toast-button:hover {
				background: var(--interactive-accent-hover);
			}

			.journalit-update-toast-discord-button {
				background: transparent;
				color: var(--text-muted);
				border: 1px solid var(--background-modifier-border);
				border-radius: 6px;
				padding: 6px 10px;
				font-size: 12px;
				font-weight: 500;
				cursor: pointer;
				transition: all 0.2s ease;
				display: flex;
				align-items: center;
				gap: 6px;
			}

			.journalit-update-toast-discord-button:hover {
				background: var(--background-secondary);
				color: var(--text-normal);
				border-color: var(--background-modifier-border-hover);
			}

			.journalit-update-toast-button-icon {
				width: 14px;
				height: 14px;
				display: flex;
				align-items: center;
				justify-content: center;
			}

			@media (max-width: 768px) {
				.journalit-update-toast {
					bottom: 80px;
					left: 12px;
					right: 12px;
					max-width: calc(100vw - 24px);
				}
			}
		`,document.head.appendChild(r)}async show(t){if(this.dismissed)return;if(this.onDismissCallback=t.onDismiss||null,this.containerEl||this.createContainer(),this.containerEl.empty(),this.containerEl.createEl("button",{cls:"journalit-update-toast-close",text:"\xD7"}).addEventListener("click",()=>this.hide()),t.imageUrl){let u=await this.loadImage(t.imageUrl);u&&(u.addClass("journalit-update-toast-image"),this.containerEl.appendChild(u))}let n=this.containerEl.createDiv({cls:"journalit-update-toast-version",text:t.version}),i=this.containerEl.createEl("h3",{cls:"journalit-update-toast-title",text:t.title}),a=this.containerEl.createDiv({cls:"journalit-update-toast-description",text:t.description});this.containerEl.createDiv({cls:"journalit-update-toast-separator"});let o=this.containerEl.createDiv({cls:"journalit-update-toast-button-container"}),s=o.createEl("button",{cls:"journalit-update-toast-discord-button"}),l=s.createSpan({cls:"journalit-update-toast-button-icon"});(0,Xq.setIcon)(l,"messages-square"),s.appendText("Discord"),s.addEventListener("click",()=>{window.open("https://discord.gg/AkSw3D9h8b","_blank")});let c=o.createEl("button",{cls:"journalit-update-toast-button",text:"Learn more"}),d=c.createSpan({cls:"journalit-update-toast-button-icon"});(0,Xq.setIcon)(d,"corner-down-right"),c.addEventListener("click",()=>{t.onViewReleaseNotes(),this.hide()}),this.containerEl.parentElement||(t.parentContainer||document.body).appendChild(this.containerEl),requestAnimationFrame(()=>{this.containerEl.style.opacity="1",this.containerEl.style.transform="translateX(0)"})}hide(){if(!(this.dismissed||!this.containerEl)){if(this.dismissed=!0,this.onDismissCallback){try{let t=this.onDismissCallback();t instanceof Promise&&t.catch(r=>console.error("[CustomUpdateToast] Dismiss callback error:",r))}catch(t){console.error("[CustomUpdateToast] Dismiss callback error:",t)}this.onDismissCallback=null}this.containerEl.style.opacity="0",this.containerEl.style.transform="translateX(-100%)",this.hideTimeoutId!==null&&clearTimeout(this.hideTimeoutId),this.hideTimeoutId=window.setTimeout(()=>{var t;(t=this.containerEl)==null||t.remove(),this.hideTimeoutId=null},300)}}cleanup(){this.hideTimeoutId!==null&&(clearTimeout(this.hideTimeoutId),this.hideTimeoutId=null),this.containerEl&&(this.containerEl.remove(),this.containerEl=null);let t=document.getElementById("journalit-update-toast-styles");t&&t.remove()}async loadImage(t){return new Promise(r=>{let n=new Image,i=setTimeout(()=>{n.src="",r(null)},5e3);n.onload=()=>{clearTimeout(i),r(n)},n.onerror=a=>{console.error("[CustomUpdateToast] Image load error:",a),clearTimeout(i),r(null)},n.src=t})}};var Qxe=Y(Q());ch();var Sr=Y(Q()),PO=require("obsidian");nr();var CO={"1.6.2-beta.1":{title:"Multi-Currency & MAE/MFE",description:"Multi-currency support, new trade metrics, and quality-of-life improvements.",imageUrl:"https://github.com/user-attachments/assets/e61a90ff-a11e-4764-9abe-05177a9145b7",features:["Multi-Currency Support","MAE/MFE Tracking","Position Size Dollar Input","Year Heatmap Selector","CSV Date Format Selector"],content:`# **1.6.2-beta.1**
Multi-currency support, new trade metrics, and quality-of-life improvements.

## **Multi-Currency Support**
![Multi-Currency Support](https://github.com/user-attachments/assets/e61a90ff-a11e-4764-9abe-05177a9145b7)
Automatic currency conversion for multi-currency portfolios
- **Unified P&L** - Trades in different currencies (USD, JPY, GBP, etc.) now convert to your display currency
- **ECB exchange rates** - Real-time rates with 24-hour caching for accurate conversions
- **Conversion transparency** - Tooltips show conversion dates, warnings for unsupported currencies
- **IBKR enhanced** - Currency field now extracted from IBKR imports automatically
*Configure your display currency in Settings to see converted totals across all charts and metrics*

## **MAE/MFE Tracking**
![MAE MFE columns](https://github.com/user-attachments/assets/553de95f-efa0-4ae9-8369-69853dc89689)
- **Flexible input** - Enter values as dollar amounts or price levels based on your preference
- **TradeLog columns** - Six new sortable columns for MAE/MFE analysis
*Add MAE/MFE values when creating/editing trades to analyze your entry and exit timing*

## **Position Size Dollar Input**
Enter position sizes as investment amounts instead of quantities
*Toggle dollar input mode in Settings*

## **Year Heatmap Selector**
![Year Heatmap Selector](https://github.com/user-attachments/assets/5c695c93-bcc6-402a-88a5-4def4af8080b)
- **Year navigation** - Interactive selector to view any year's trading heatmap
*Click the top right in the heatmap widget to browse previous years*

## **CSV Date Format Selector**
Manually specify date formats during manual CSV import

## **Fixes**
- Fixed year-boundary issues in weekly calendar causing incorrect quarters and missing events
- Fixed Trading Score widget incorrectly showing "insufficient data" at start of new year
- Fixed streak calculations incorrectly counting open trades (0 PnL) as streak breakers
- Fixed heatmap "Last 3/6 Months" views failing to cross year boundaries correctly
- Fixed modal styling inconsistencies across different Obsidian themes
- Dependency updates and under-the-hood improvements
`},"1.6.1-beta.1":{title:"Trade Log Expansion & Exchange Support",description:"13 new columns, smarter CSV imports, Hyperliquid & Blofin support",imageUrl:"https://github.com/user-attachments/assets/2b561777-dab7-4c8a-93fe-1ceb3c3f54a7",features:["Trade Log Columns","CSV Import Redesign","Hyperliquid Support","Blofin Support","Account Date Warning"],content:`# **1.6.1-beta.1**
Expanded trade analysis, streamlined CSV imports, and new exchange support.

## **Trade Log Columns**
![New Modal](https://github.com/user-attachments/assets/2cfa77f7-ce18-41ec-8fc2-b5401963abaf)
![Available Columns](https://github.com/user-attachments/assets/2b561777-dab7-4c8a-93fe-1ceb3c3f54a7)
13 new columns for comprehensive trade analysis
- **Timing columns** - Entry Time, Exit Time, Close Date for precise timing analysis
- **Price columns** - Weighted average Entry/Exit prices, Stop Loss level
- **Risk columns** - SL Distance ($/%%), Risk $, R:R ratio
- **Position columns** - Size $, Fees, Exchange
- **Expanded mode** - Display tags, setups, and mistakes as pill badges
*Access via settings in Trade Log - new two-panel modal with drag-to-reorder*

## **CSV Import Redesign**
![CSV Importer](https://github.com/user-attachments/assets/2868bf3d-aaa6-4917-bf89-e38182b92c7f)
Faster workflow with preferences and favorites
- **Radio selection** - Browse brokers and accounts at a glance
- **Favorites** - Star your most-used broker and account for auto-selection
- **Hide brokers** - Declutter the list by hiding unused brokers
- **Asset type memory** - Remembers last asset type per broker
*Archived accounts automatically hidden from selection*

## **Hyperliquid Support**
Import trades from Hyperliquid decentralized perpetuals exchange
*Export from Hyperliquid Trade History tab (10k entry limit)*

## **Blofin Support**
Import trades from Blofin crypto exchange

## **Account Date Warning**
Automatic detection of trades before account creation
Prevents balance calculation issues from date mismatches

## **Fixes**
- Fixed backup spam - UI state now stored separately, backups throttled to 5-minute intervals
- Fixed folder placement for trades and DRCs at year boundaries (W01-2026 disambiguation)
- Fixed timezone bug causing wrong dates in review widgets for negative UTC timezones
- Fixed review file creation - clicking DRC/Weekly/Monthly/Yearly in trade notes now auto-creates missing files
- Fixed account type validation when deleted type is no longer available
- Fixed deprecated layout items causing upgrade issues
- Fixed chart padding below x-axis labels
- Fixed account balance chart Y-axis to include drawdown levels
`},"1.6.0-beta.1":{title:"Review V2 & Customizable Home View",description:"Major release introducing Review V2, customizable Home View, and extensive improvements across the board.",imageUrl:"https://github.com/user-attachments/assets/9ef0236f-686f-4511-a05f-925e51f1224a",features:["Review V2 System","Customizable Home View","TradingView Image Links","Partial Trade Visualization","Tags Filter"],content:`# **1.6.0-beta.1**
Major release introducing Review V2, customizable Home View, and extensive improvements across the board.

## **Review V2 System**
![ReviewV2 Preview](https://github.com/user-attachments/assets/48bcc59a-2b17-4478-98b3-dce8677cca47)
Complete overhaul of the review note system with a template-based architecture
- **Layout Builder** - Create custom review templates with live preview and drag-and-drop sections
![Editor](https://github.com/user-attachments/assets/03f20e4b-37e7-43d9-94bf-fb444e43afbf)
- **20+ Widgets**
- **Quarterly and Yearly Reviews!** - Added a very detailed Yearly review template for end-of-year reflections
- **Template sharing**
- **[IMPORTANT] Migration Required** - Migrate from legacy review Notes

## **Customizable Home View**
![Home View Preview](https://github.com/user-attachments/assets/9ef0236f-686f-4511-a05f-925e51f1224a)
- **Drag-and-drop widgets** - Position and resize widgets to your preference
- **Position Size Calculator** - Built-in calculator with multi-asset and R:R ratio support
- **Goals & Streaks** - Track progress on daily/weekly/monthly targets
- **Embedded Notes** - Add any note from your vault directly to the home view
- **Filter persistence** - Selected filters carry over between sessions
*Access via the Layout Builder quicklink on the Home View*

## **TradingView Image Links**
Easily attach TradingView chart snapshots to your trades via image URLs (other image hosts supported too)

## **Partial Trade Visualization** (Trade Log)
- **Exit breakdown** 
- **Status indicators**

## **Tags Filter**
Filter trades by your custom tags

## **ByBit Csv Import Support**
Import your trade data from ByBit exchange

## **QoL changes**
- Human-readable hold times
- New currencies
- Image viewer improvements

## **Fixes**
bunch of bug fixes and performance improvements

this is a big one! looking forward to your feedback on Review V2 and the new Home View system.

Merry Christmas and happy trading! \u{1F385}
`},"1.5.3-beta.1":{title:"New Widgets + Instrument Specs",description:"Instrument specifications, TradingView import, enhanced dashboard metrics, and critical bug fixes.",imageUrl:"https://github.com/user-attachments/assets/c745828e-165f-4b9d-b013-7353700272f4",features:["Add TradingView broker guide support","Add resource links to general settings tab header","Add resource links to release notes view header","Update broker guide links to Journalit documentation","Enhance release workflow with interactive automation"],content:`# **1.5.3-beta.1**
Instrument specifications, TradingView import, enhanced dashboard metrics, and critical bug fixes.

## **Global Instrument Specifications**
![Global Specs](https://github.com/user-attachments/assets/f0f962e4-5e63-482c-9a65-b182a19debfd)
Define instrument parameters once and apply them automatically across all trades
- **Automatic symbol normalization** - Applies to all manual and imported trades
- **Symbol Mappings**
*Access via Settings > Customisation > Tickers/Symbols*

## **TradingView CSV Import**
Native support for TradingView paper trading exports

## **Dashboard Enhancements**
![Dashboard Widgets](https://github.com/user-attachments/assets/c745828e-165f-4b9d-b013-7353700272f4)
New metrics and improved widget controls
- **Avg win/loss hold time metrics**
- **Period selectors**
- **Rolling Win/Loss Ratio chart**

## **Update Notification System**
Stay informed about new releases
- **Release notes view** - Browse changelogs directly in the plugin *(CTRL + P, \`View release notes\`)*
*Can be disabled at the bottom of the general settings tab*

## **TradeLog Tags Column**
![TradeLog Tags](https://github.com/user-attachments/assets/9ad8d467-110c-4148-9f80-f286385d18b2)
Display custom user tags
- **Tags column** - See your trade tags at a glance without opening trade details
- **Legacy tag cleanup** - Removed auto generated tags. Please run **[Ctrl + P, \`search for "Clean"\`]** to remove legacy tags.

## **Fixes**
- Fixed critical P&L bugs: direction comparison, validation guards, error handling
- Fixed IBKR CSV import: SELL-only filtering and chronological sorting
- Fixed timezone bugs causing DRCs to show data from previous day
- Fixed UTC timezone shift in creation date handling
- Fixed account modal crashes from corrupted date data
- Fixed tag normalization and frontmatter serialization issues
- Fixed duplicate tags/mistakes with escaped quotes and tag paths
- Fixed cache not refreshed on options change
- Fixed trade note navigation to use NavigationManager
+ many more under the hood improvements and code quality enhancements

Please make sure to run **[Ctrl + P, \`search for "Clean"\`]** to remove legacy tags.
`},"1.5.2-beta.2":{title:"Quick Hotfix Update",description:"Bug fixes for daily goals, trade status detection, and TradeLog display",features:["Daily goals correctly carry over to next day","Trades with multiple entries but no exits show as OPEN","MISSED and BACKTEST trades display without needing filters","Default custom options can be removed properly","Thesis column alignment fixed in TradeLog"],content:`# **1.5.2-beta.2**
Quick hotfix update

## **Fixes**
- Daily goals now correctly carry over to next day
- Trades with multiple entries but no exits show as OPEN correctly
- MISSED and BACKTEST trades now display in TradeLog without needing filters
- Default custom options can now be removed properly
- Thesis column alignment fixed in TradeLog
`},"1.5.2-beta.1":{title:"Major Trade Log Overhaul",description:"Multi-select, enhanced filtering, and performance improvements",imageUrl:"https://github.com/user-attachments/assets/d8f1750e-8b7b-4db2-a487-8aff564d52e6",features:["Multi-select with batch operations toolbar","Column customization with drag-and-drop reordering","80-99% performance improvement","Advanced unified filter system","TradeZero CSV import support"],content:`# **1.5.2-beta.1**
Major Trade Log overhaul with multi-select, enhanced filtering, and performance improvements.

## **MAJOR Trade Log Enchacements**
![Trade Log](https://github.com/user-attachments/assets/d8f1750e-8b7b-4db2-a487-8aff564d52e6)
Complete rebuild with modern features and dramatic performance gains
![Multi-select](https://github.com/user-attachments/assets/1c2a3e56-375b-4e94-8142-0556543ebfbc)
- **Multi-select** - Shift-click to select multiple trades, batch operations toolbar for bulk actions
- **Batch Operation Toolbar** - Easily mark as reviewed, add setups, add mistakes or delete selected trades
![Column Customisation](https://github.com/user-attachments/assets/fa8b2223-8f14-4572-8cdf-5454ba037f47)
- **Column customization** - Choose which columns to display, reorder and resize to your preference
- **Scroll persistence** - TradeLog remembers your scroll position when navigating away
- **80-99% performance improvement** - Parallel cache refresh for lightning-fast data updates
*Access column settings via TradeLog header controls, multi-select with shift-click*

## **Advanced Filter System**
![Advanced Filters](https://github.com/user-attachments/assets/04da4feb-3c11-4339-95a7-2d90d69725d3)
Unified filtering interface with enhanced controls
*Access via filter button in Dashboard and TradeLog headers*

## **TradeZero CSV Import Support**
Import trades directly from TradeZero broker

## **Trade Form Protection**
![Form Protection](https://github.com/user-attachments/assets/2c3c1347-1272-42ef-93e0-a996977f410c)
Prevent accidental data loss with unsaved changes

## **Fixes**
- Fixed race condition in trade file creation causing data loss
- Fixed performance calendar month labels overlaying sticky header
- Fixed missing Direction field for option trades in frontmatter
- Fixed duplicate images pasting into DRC and Weekly Review
- Fixed trade status detection bugs for trades with multiple entries
- Fixed focus loss in entry/exit rows during editing
- Fixed accountMetadata data loss during settings reconstruction
+ many more under the hood improvements and code quality enhancements
`},"1.5.1-beta.2":{title:"Bug Fixes & Improvements",description:"Minor bug fixes and performance improvements",imageUrl:"https://github.com/user-attachments/assets/47aad6ac-4c8b-4dbe-b3ca-97337705dc48",features:["Fixed version comparison for build timestamps","Improved toast positioning in HomeView","Better error handling"]},"1.5.1-beta.1":{title:"Advanced Filtering System",description:"New filtering options across dashboard and TradeLog for better strategy analysis",imageUrl:"https://github.com/user-attachments/assets/0f58b43e-40d8-4b27-b293-7e3fd13fb2ef",features:["Setup filter for strategy analysis in dashboard","Account filtering in TradeLog","Trade rebates tracking for options trades","Copy trading P&L multiplier setting","Fixed multi-year monthly review backlinks","Fixed R-multiples calculation bugs"],content:`# 1.5.1-beta.1

Stability improvements, new filtering options, and enhanced trade management features.

## Setup Filter

![Dashboard Filter](https://github.com/user-attachments/assets/0f58b43e-40d8-4b27-b293-7e3fd13fb2ef)

Filter trades by specific setups in the trading dashboard

- Strategy analysis - Isolate performance by trade setup/strategy
- Pattern recognition - See which setups perform best
- Access via dashboard filter controls alongside Account and Ticker filters

## Trade Rebates

Support for rebate tracking on options trades

- Rebate field - Track credits received from brokers on options trades
- Net cost calculation - Automatically factors rebates into P&L
- Options-specific - Field restricted to options asset types only
- Add rebates when editing trades to see accurate net P&L

## Account Filtering in TradeLog

![TradeLog Filter](https://github.com/user-attachments/assets/93b8208d-a2a6-4b66-8273-bdc5f470ebbb)

Filter TradeLog view by specific accounts

- Multi-account support - View trades from selected accounts only
- Access via TradeLog header filter controls

## Copy Trading PnL Multiplier

Setting for copy trading account calculations

- Accurate tracking - Properly calculate P&L for copy trading setups
- Configure in Settings under General tab

## Fixes

- Fixed backlinks for multi-year monthly review collisions
- Fixed account-related errors in account page
- Fixed R-multiples calculation bugs in P&L calculations
- Many more under the hood fixes and improvements

Planning on upgrading the trade log with a bunch more features.
`},"1.5.0-beta.1":{title:"CSV Import, R-Multiples & Manual Drawdown",description:"Major update with CSV import system, R-multiple risk tracking, and manual trailing drawdown",imageUrl:"https://github.com/user-attachments/assets/5c272fb2-19c7-4db0-94c0-0fecf67281be",features:["CSV import system with IBKR and Tradovate adapters","Smart duplicate detection and AI-powered mapping","Manual trailing drawdown with snapshot system","R-multiple risk tracking with stop loss fields","Breakeven range configuration","Critical stability fixes for plugin reload and timezone issues"],content:`# 1.5.0-beta.1

Major update: CSV Import, R-Multiple tracking, and critical stability improvements.

## CSV Import System

![CSV Import](https://github.com/user-attachments/assets/5c272fb2-19c7-4db0-94c0-0fecf67281be)

Import trades from any broker directly into your vault

- Built-in broker adapters - IBKR and Tradovate support
- Smart duplicate detection - Prevents re-importing via time/price matching
- AI-powered mapping - Optional OpenAI assistance for custom formats

![CSV Import Manual Mapping](https://github.com/user-attachments/assets/9466227d-f819-44cc-a505-fb04fbc019bb)

- Manual mapping - Map any CSV for unsupported brokers
- Template sharing - JTT codes enable community template distribution
- Access via homepage \`Customize -> restore hidden\` or \`Ctrl+P\` search \`CSV\`

## Manual Trailing Drawdown

![Manual Drawdown Entry](https://github.com/user-attachments/assets/18c45c6e-52a5-438f-9402-632d1187faee)

![Manual Drawdown Settings](https://github.com/user-attachments/assets/893c2b86-61d9-4fa1-abf9-01e9fe4aebb0)

- Snapshot system - Log dated drawdown limits manually
- Stepped chart - Visualize how limits change over time
- Progress tracking - Auto-calculates remaining room and percentage used
- Perfect for prop firms with live equity trailing drawdowns

## R-Multiple Risk Tracking

![R-Multiples & Breakeven Settings](https://github.com/user-attachments/assets/39c9a2cd-21b2-47f0-8432-8b66d353dc34)

Measure trades in risk units instead of currency

- Stop Loss field - Auto-calculates risk from entry-to-stop distance
- Manual override - Set custom risk amounts with preview
- Default risk - Pre-fills from settings
- Display toggle - View ALL metrics in R-multiples instead of currency

## Breakeven Range

- Define a range for breakeven instead of exact zero

## Fixes

- Fixed "plugin gone away" errors on reload
- Fixed date mismatches for UTC-1 to UTC-12 timezones
- Fixed TradeLog creating duplicate trades with random suffixes
- Cross-platform workspace compatibility
- Custom options persistence
- Reviewed trades filtering
- Plus more under the hood improvements
`},"1.5.0":{title:"Major Performance Update",description:"Faster sync and improved UI responsiveness",features:["Trade sync optimization","UI performance improvements","Bug fixes"]},"1.4.2-beta.3":{title:"Hotfix: Folder Migration System",description:"Simplified folder location changes with manual file moving",features:["Removed automatic folder migration when changing Journalit folder location","Replaced with manual move of existing files","New trades automatically created in new folder location"],content:`# 1.4.2-beta.3

## Hotfix: Folder Migration System

- Removed automatic folder migration code when changing Journalit folder location in vault
- Replaced with manual move of existing files
- New trades will automatically be created in new folder location of choice
`},"1.4.2-beta.2":{title:"Account Filtering & Custom Folder Location",description:"Complete account filtering across review components and customisable journal folder location",imageUrl:"https://github.com/user-attachments/assets/2afaafc4-ef96-4ec2-9fd0-81edd5fae72d",features:["Account filtering across DRC, Weekly, and Monthly reviews","Trade status filtering in Trade Log (open/closed/win/loss/breakeven)","Fast date/time input system (e.g., '280925 1104P')","Customisable homepage quick links with drag-and-drop","Custom journal folder location with migration system","Calendar timezone fixes and phantom trade count elimination"],content:`# 1.4.2-beta.2

Working on the CSV importer as one of my main focuses for now but will still be fixing bugs and adding feature requests along the way.

## Review Notes Account Filtering

![Review Notes Account Filter](https://github.com/user-attachments/assets/2afaafc4-ef96-4ec2-9fd0-81edd5fae72d)

- Complete account filtering across all review components (DRC, Weekly Review, Monthly Review)
- Smart cache management to prevent calculation conflicts and improve performance
- Filter your data by specific accounts to get focused insights on individual trading strategies

## Trade Log Updates

![Trade Log Updates](https://github.com/user-attachments/assets/06be594f-30b8-4ebe-85e3-fc05561015b2)

- Added trade status filtering with open/closed/win/loss/breakeven options in Trade Log
- Added "This Quarter" time range filter button

## Better Date/Time Input in Trade Form

- Fast date/time input system with combined format support for quicker trade entry
- Type \`280925 1104P\` to get 28/09/25 1104PM

## Customisable Homepage Experience

- Drag-and-drop customisable quick links for personalised navigation
- Easily remove any of the homepage navigation buttons you don't want

## Custom Journalit Folder Location

- Customisable journal folder location with complete migration system
- Safety enhancements to prevent data loss during folder changes
- Centralised folder path management for better organisation
- Take full control of where your trading journal data is stored within your vault

## Calendar Fixes

- Eliminated phantom trade counts that were inflating statistics
- Resolved timezone date discrepancies between bar charts and calendar

## Other Fixes & Improvements

- Fixed Trade Log scrolling issues for datasets with \u226450 trades
- Improved tick size formatting and reduced unnecessary refreshes
- And more under the hood improvements
`},"1.4.1-beta.1":{title:"Home View & Backtest Trading",description:"Complete drag-and-drop home page with widgets and backtest trade support",imageUrl:"https://github.com/user-attachments/assets/6a770114-42e2-4df6-ad89-71511ff02dbc",features:["Drag-and-drop home page with Recent Items and Trading Heatmap widgets","GitHub-style contributions heatmap for daily P&L performance","Backtest trade system with dedicated 'B' prefix file naming","Percentage-based commission tracking","2-minute trade sync speed","Privacy-first analytics with explicit consent"],content:`# 1.4.1-beta.1

## Home View

![Home Page](https://github.com/user-attachments/assets/6a770114-42e2-4df6-ad89-71511ff02dbc)

- Complete drag-and-drop home page with 2 widgets (Recent Items, Trading Heatmap)
- GitHub-style contributions heatmap showing daily P&L performance with interactive tooltips
- Recent Items widget tracks your last 5 accessed files/views for quick navigation
- Ability to set your username for the greeting used in the homepage in the settings
- Ability to choose whether the home page loads every time you open Obsidian in the settings
- Removed all the other ribbon icons and consolidated them into 1 for less noise
- You can still access all the other pages from the home page, commands (Ctrl+P), or custom hotkeys

## Trade Sync Enhancements

- Trade sync should take MAXIMUM 2 minutes before they reach your trading vault now

## Backtest Trade System

![Backtest Trade Type](https://github.com/user-attachments/assets/bb80dea8-7808-4eec-82ee-e3cfe742b744)

- Backtesting trade management with dedicated 'B' prefix file naming
- Easily select this in our dropdown selector in the trade form

## Enhanced Commission & Cost Tracking

- Percentage-based commission option (0-100%) alongside existing fixed dollar amounts
- Track your costs more accurately whether you pay fixed fees or percentage-based commissions

## Privacy-First Analytics

- Optional telemetry system with explicit user consent (disabled by default)
- Help us improve the plugin while maintaining complete privacy over your trading data

## Other Fixes & Improvements

- Major performance optimizations
- Enhanced error handling system with user-friendly notifications and better debugging
- Added optional exit date/time fields for enhanced DirectPnL mode precision
- Cleaned up frontmatter from not showing other asset type fields
- Fixed options PNL calculations to follow contract pricing
`}};var Kxe=({leaf:e,view:t})=>{let r=Ae(),[n,i]=(0,Sr.useState)([]),[a,o]=(0,Sr.useState)(null),[s,l]=(0,Sr.useState)(!0),c=(0,Sr.useRef)(null),d=(0,Sr.useRef)(null),u=(0,Sr.useRef)(null);if((0,Sr.useEffect)(()=>{r&&p()},[r]),(0,Sr.useEffect)(()=>{c.current&&(0,PO.setIcon)(c.current,"book-open"),d.current&&(0,PO.setIcon)(d.current,"messages-square"),u.current&&(0,PO.setIcon)(u.current,"github")},[]),!r)return Sr.default.createElement("div",{className:"release-notes-view"},Sr.default.createElement("div",{className:"loading"},"Loading plugin..."));let p=()=>{try{l(!0);let h=Object.entries(CO).filter(([,y])=>y.content).map(([y,b])=>({version:y,content:b.content}));h.sort((y,b)=>{let k=w=>{let[C,D]=w.split("-"),[P,M,z]=C.split(".").map(Number),A=null;return D!=null&&D.startsWith("beta.")&&(A=parseInt(D.replace("beta.",""),10)),{major:P,minor:M,patch:z,isBeta:!!D,betaNum:A}},x=k(y.version),S=k(b.version);return S.major!==x.major?S.major-x.major:S.minor!==x.minor?S.minor-x.minor:S.patch!==x.patch?S.patch-x.patch:x.isBeta!==S.isBeta?x.isBeta?1:-1:x.isBeta&&S.isBeta&&x.betaNum!==S.betaNum?(S.betaNum||0)-(x.betaNum||0):0}),i(h),h.length>0&&o(h[0].version)}catch(v){console.error("Failed to load changelogs:",v),i([])}finally{l(!1)}},m=v=>v.replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>").replace(/(?<!\*)\*([^*]+)\*(?!\*)/g,"<em>$1</em>").replace(/`([^`]+)`/g,"<code>$1</code>").replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank">$1</a>'),g=v=>{let h=v.split(`
`),y=[],b=[],k=0,x=()=>{b.length>0&&(y.push(Sr.default.createElement("ul",{key:`list-${k++}`},b.map((S,w)=>Sr.default.createElement("li",{key:w,dangerouslySetInnerHTML:{__html:S}})))),b=[])};for(let S=0;S<h.length;S++){let w=h[S];if(w.trim()===""){x();continue}if(w.startsWith("# ")){x();let D=m(w.slice(2));y.push(Sr.default.createElement("h2",{key:`h2-${k++}`,dangerouslySetInnerHTML:{__html:D}}));continue}if(w.startsWith("## ")){x();let D=m(w.slice(3));y.push(Sr.default.createElement("h3",{key:`h3-${k++}`,dangerouslySetInnerHTML:{__html:D}}));continue}if(w.startsWith("### ")){x();let D=m(w.slice(4));y.push(Sr.default.createElement("h4",{key:`h4-${k++}`,dangerouslySetInnerHTML:{__html:D}}));continue}let C=w.match(/!\[([^\]]*)\]\(([^)]+)\)/);if(C){x();let[,D,P]=C,M=P;(P.startsWith("./")||P.startsWith("../"))&&console.warn("[ReleaseNotes] Relative image paths not supported, use remote URLs:",P),y.push(Sr.default.createElement("div",{key:`img-${k++}`,className:"changelog-image"},Sr.default.createElement("img",{src:M,alt:D})));continue}if(w.match(/^[\s]*[-*]\s+/)){let D=w.replace(/^[\s]*[-*]\s+/,"");b.push(m(D));continue}x(),y.push(Sr.default.createElement("p",{key:`p-${k++}`,dangerouslySetInnerHTML:{__html:m(w)}}))}return x(),Sr.default.createElement(Sr.default.Fragment,null,y)},f=v=>{o(a===v?null:v)};return Sr.default.createElement("div",{className:"release-notes-view"},Sr.default.createElement("div",{className:"release-notes-header"},Sr.default.createElement("h2",null,"Release Notes"),Sr.default.createElement("div",{className:"release-notes-header-actions"},Sr.default.createElement("button",{className:"release-notes-action-button",onClick:()=>window.open("https://journalit.co/docs","_blank")},Sr.default.createElement("span",{ref:c,className:"button-icon"}),Sr.default.createElement("span",null,"Docs")),Sr.default.createElement("button",{className:"release-notes-action-button",onClick:()=>window.open("https://discord.gg/AkSw3D9h8b","_blank")},Sr.default.createElement("span",{ref:d,className:"button-icon"}),Sr.default.createElement("span",null,"Discord")),Sr.default.createElement("button",{className:"release-notes-action-button",onClick:()=>window.open("https://github.com/Cursivez/journalit","_blank")},Sr.default.createElement("span",{ref:u,className:"button-icon"}),Sr.default.createElement("span",null,"GitHub"))),Sr.default.createElement("div",{className:"current-version"},"Current: v",r.manifest.version)),s?Sr.default.createElement("div",{className:"loading"},"Loading release notes..."):n.length===0?Sr.default.createElement("div",{className:"no-content"},"No release notes found"):Sr.default.createElement("div",{className:"changelog-list"},n.map(({version:v,content:h})=>Sr.default.createElement("div",{key:v,className:`changelog-entry ${a===v?"expanded":""}`},Sr.default.createElement("div",{className:"changelog-header",onClick:()=>f(v)},Sr.default.createElement("h3",null,"Version ",v),Sr.default.createElement("span",{className:"expand-icon"},a===v?"\u25BC":"\u25B6")),a===v&&Sr.default.createElement("div",{className:"changelog-content"},g(h))))))};var KYe=`
/* Release Notes Container */
.journalit-release-notes-container {
  background: var(--background-primary);
  color: var(--text-normal);
  overflow-y: auto;
  height: 100%;
}

/* Preserve default view header height */
.journalit-release-notes-container .view-header {
  flex-shrink: 0;
}

.release-notes-view {
  max-width: 800px;
  margin: 0 auto;
  padding: 24px;
}

.release-notes-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
  padding-bottom: 16px;
  border-bottom: 2px solid var(--background-modifier-border);
}

.release-notes-header h2 {
  margin: 0;
  font-size: 24px;
  font-weight: 600;
}

.current-version {
  font-size: 14px;
  color: var(--text-muted);
  background: var(--background-secondary);
  padding: 4px 12px;
  border-radius: 12px;
}

.release-notes-header-actions {
  display: flex;
  gap: 8px;
  align-items: center;
}

.release-notes-action-button {
  background: var(--background-secondary);
  color: var(--text-normal);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  padding: 4px 10px;
  font-size: 12px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  gap: 4px;
}

.release-notes-action-button:hover {
  background: var(--background-modifier-hover);
  border-color: var(--background-modifier-border-hover);
}

.release-notes-action-button .button-icon {
  width: 12px;
  height: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.changelog-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.changelog-entry {
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  overflow: hidden;
  background: var(--background-primary-alt);
}

.changelog-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px;
  cursor: pointer;
  background: var(--background-primary-alt);
  transition: background 0.2s;
}

.changelog-header:hover {
  background: var(--background-modifier-hover);
}

.changelog-header h3 {
  margin: 0;
  font-size: 16px;
  font-weight: 600;
}

.expand-icon {
  color: var(--text-muted);
  font-size: 12px;
  transition: transform 0.2s;
}

.changelog-content {
  padding: 0 16px 16px 16px;
  line-height: 1.6;
  animation: expandDown 0.3s ease-out;
}

.changelog-content h3 {
  margin-top: 16px;
  margin-bottom: 8px;
  font-size: 18px;
  font-weight: 600;
}

.changelog-content h4 {
  margin-top: 12px;
  margin-bottom: 6px;
  font-size: 16px;
  font-weight: 600;
}

.changelog-content img {
  max-width: 100%;
  border-radius: 8px;
  margin: 16px 0;
  border: 1px solid var(--background-modifier-border);
}

.changelog-content ul {
  padding-left: 24px;
  margin: 8px 0;
}

.changelog-content li {
  margin: 4px 0;
}

.loading {
  text-align: center;
  padding: 48px;
  color: var(--text-muted);
}

@keyframes expandDown {
  from {
    opacity: 0;
    max-height: 0;
  }
  to {
    opacity: 1;
    max-height: 5000px;
  }
}
`;function JYe(){try{let e="release-notes-styles";if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=KYe,document.head.appendChild(t)}catch(e){console.error("Failed to inject Release Notes styles:",e)}}function Jxe(){if(document.getElementById("release-notes-styles")||JYe(),!document.getElementById("critical-release-notes-styles")){let e=document.createElement("style");e.id="critical-release-notes-styles",e.textContent=`
      /* Critical core styles for Release Notes */
      .journalit-release-notes-container {
        display: block !important;
        width: 100% !important;
        height: 100% !important;
        overflow: auto !important;
        box-sizing: border-box !important;
      }

      .release-notes-view {
        display: block !important;
        width: 100% !important;
        padding: 24px !important;
        box-sizing: border-box !important;
      }

      .changelog-list {
        display: flex !important;
        flex-direction: column !important;
        gap: 16px !important;
      }

      .changelog-entry {
        display: block !important;
        border: 1px solid var(--background-modifier-border) !important;
        border-radius: 8px !important;
        overflow: hidden !important;
      }

      .changelog-header {
        display: flex !important;
        justify-content: space-between !important;
        align-items: center !important;
        padding: 12px 16px !important;
        cursor: pointer !important;
      }
    `,document.head.appendChild(e)}}var Hb="journalit-release-notes",jP=class extends nl{getDisplayText(){return"Release Notes"}getViewType(){return Hb}getIcon(){return"scroll"}async onOpen(){Jxe(),this.containerEl.classList.add("journalit-release-notes-container"),await super.onOpen()}getRenderFunction(){return()=>Qxe.default.createElement(Kxe,{leaf:this.leaf,view:this})}};AP();var _P=class{constructor(t){this.currentToast=null;this.pendingNotificationVersion=null;this.statusBarItem=null;this.isCheckingForUpdates=!1;this.openHomeViewTimeoutId=null;this.plugin=t}getPendingNotificationVersion(){return this.pendingNotificationVersion}async checkForUpdates(){var t;if(!this.isCheckingForUpdates&&(t=this.plugin.settings.backendIntegration)!=null&&t.showUpdateNotifications){this.isCheckingForUpdates=!0;try{let r=this.plugin.manifest.version,n=this.plugin.settings.backendIntegration;if(!n)return;let i=n.lastSeenVersion,a=n.dismissedVersion,o=!1;if(!i){if(n.lastSeenVersion=r,n.dismissedVersion=r,o=!0,o)try{await this.plugin.saveSettings()}catch(s){console.error("[UpdateNotification] Failed to save settings:",s)}return}if(i&&!a&&(n.dismissedVersion=i,a=i,o=!0),i!==r&&(n.lastSeenVersion=r,o=!0),o)try{await this.plugin.saveSettings()}catch(s){console.error("[UpdateNotification] Failed to save settings:",s)}this.shouldShowNotification(r,a)&&(this.pendingNotificationVersion=r,await this.showUpdateNotification(r))}finally{this.isCheckingForUpdates=!1}}}shouldShowNotification(t,r){return r?this.isNewerVersion(t,r):!0}async showUpdateNotification(t){var r;if((r=this.plugin.settings.backendIntegration)!=null&&r.showUpdateNotifications)try{let n=this.loadReleaseMetadata(),i=this.normalizeVersionForLookup(t),a=n[i];if(!a){new qb.Notice(`Journalit updated to v${t}!`,8e3);return}let o=this.plugin.app.workspace.getLeavesOfType(es);if(o.length===0){this.showStatusBarIndicator(t);return}let l=o[0].view.containerEl;(!l.style.position||l.style.position==="static")&&(l.style.position="relative"),this.currentToast=new TO,await this.currentToast.show({version:t,title:a.title,description:a.description,imageUrl:a.imageUrl,parentContainer:l,onViewReleaseNotes:()=>this.openReleaseNotes(),onDismiss:()=>this.handleNotificationDismissed()})}catch(n){console.error("[UpdateNotification] Failed to show update notification:",n),console.error("[UpdateNotification] Error stack:",n instanceof Error?n.stack:"No stack trace"),new qb.Notice(`Journalit updated to v${t}!`,8e3)}}loadReleaseMetadata(){return CO}isNewerVersion(t,r){let n=g=>{let f=g.match(/^(\d+\.\d+\.\d+)/);return f?f[1]:g},i=n(t),a=n(r),o=i.split(".").map(Number),s=a.split(".").map(Number),[l=0,c=0,d=0]=o,[u=0,p=0,m=0]=s;return!Number.isFinite(l)||!Number.isFinite(c)||!Number.isFinite(d)||!Number.isFinite(u)||!Number.isFinite(p)||!Number.isFinite(m)?!1:l>u||l===u&&c>p||l===u&&c===p&&d>m}normalizeVersionForLookup(t){return t.replace(/-\d{13}$/,"")}async handleNotificationDismissed(){var r;let t=(r=this.pendingNotificationVersion)!=null?r:this.plugin.manifest.version;this.plugin.settings.backendIntegration&&(this.plugin.settings.backendIntegration.dismissedVersion=t,await this.plugin.saveSettings()),this.pendingNotificationVersion=null,this.removeStatusBarIndicator()}showStatusBarIndicator(t){if(this.statusBarItem)return;this.statusBarItem=this.plugin.addStatusBarItem(),this.statusBarItem.addClass("journalit-update-status-bar");let r=this.statusBarItem.createSpan({cls:"journalit-update-status-icon"});(0,qb.setIcon)(r,"gift"),this.statusBarItem.createSpan({text:"Update available",cls:"journalit-update-status-text"}),this.statusBarItem.setAttribute("aria-label",`Journalit ${t} - Click to view`),this.statusBarItem.addClass("mod-clickable"),this.plugin.registerDomEvent(this.statusBarItem,"click",async()=>{await this.openHomeViewAndShowToast(t)}),this.injectStatusBarStyles()}removeStatusBarIndicator(){this.statusBarItem&&(this.statusBarItem.remove(),this.statusBarItem=null)}async openHomeViewAndShowToast(t){let{workspace:r}=this.plugin.app;try{let n=r.getLeavesOfType(es);n.length===0&&(await r.getLeaf("tab").setViewState({type:es,active:!0}),n=r.getLeavesOfType(es)),n.length>0&&(r.revealLeaf(n[0]),this.openHomeViewTimeoutId!==null&&clearTimeout(this.openHomeViewTimeoutId),this.openHomeViewTimeoutId=window.setTimeout(async()=>{this.openHomeViewTimeoutId=null,this.removeStatusBarIndicator(),await this.showUpdateNotification(t)},200))}catch(n){console.error("[UpdateNotification] Failed to open HomeView:",n),new qb.Notice("Failed to open update notification. Please try again.",5e3)}}injectStatusBarStyles(){let t="journalit-update-status-bar-styles";if(document.getElementById(t))return;let r=document.createElement("style");r.id=t,r.textContent=`
			.journalit-update-status-bar {
				display: flex;
				align-items: center;
				gap: 4px;
				cursor: pointer;
				padding: 0 8px;
				border-radius: 4px;
				transition: background 0.2s ease;
			}

			.journalit-update-status-bar:hover {
				background: var(--background-modifier-hover);
			}

			.journalit-update-status-icon {
				color: var(--text-accent);
				display: flex;
				align-items: center;
			}

			.journalit-update-status-icon svg {
				width: 14px;
				height: 14px;
			}

			.journalit-update-status-text {
				font-size: 12px;
				color: var(--text-muted);
			}
		`,document.head.appendChild(r)}async openReleaseNotes(){let{workspace:t}=this.plugin.app,r=t.getLeavesOfType(Hb)[0];try{r||(r=t.getLeaf("tab"),await r.setViewState({type:Hb,active:!0})),t.revealLeaf(r)}catch(n){console.error("[UpdateNotification] Failed to open release notes:",n),new qb.Notice("Failed to open release notes. Please try again.",5e3)}}cleanup(){this.openHomeViewTimeoutId!==null&&(clearTimeout(this.openHomeViewTimeoutId),this.openHomeViewTimeoutId=null),this.currentToast&&(this.currentToast.cleanup(),this.currentToast=null),this.removeStatusBarIndicator();let t=document.getElementById("journalit-update-status-bar-styles");t&&t.remove()}};var Zq=require("obsidian");Jn();function Xxe(e,t){var n,i,a,o,s,l;if(!t)return e;let r=e;if(((n=t.accounts)==null?void 0:n.length)>0&&(r=r.filter(c=>(Array.isArray(c.account)?c.account:[c.account]).some(u=>t.accounts.includes(u)))),((i=t.tickers)==null?void 0:i.length)>0&&(r=r.filter(c=>{var u;let d=((u=c.instrument)==null?void 0:u.toLowerCase())||"";return t.tickers.some(p=>d.includes(p.toLowerCase()))})),((a=t.setups)==null?void 0:a.length)>0){let c=t.setups.includes("__NO_SETUP__"),d=t.setups.filter(u=>u!=="__NO_SETUP__");r=r.filter(u=>{let p=!u.setup||u.setup.length===0;return c&&p?!0:d.length>0&&u.setup&&Array.isArray(u.setup)&&u.setup.length>0?u.setup.some(m=>d.some(g=>m.toLowerCase()===g.toLowerCase())):!1})}if(((o=t.tags)==null?void 0:o.length)>0){let c=t.tags.includes("__NO_TAGS__"),d=t.tags.filter(u=>u!=="__NO_TAGS__");r=r.filter(u=>{var m;let p=!u.tags||u.tags.length===0;return!!(c&&p||d.length>0&&((m=u.tags)!=null&&m.some(g=>d.includes(g))))})}return((s=t.tradeTypes)==null?void 0:s.length)>0&&(r=r.filter(c=>c.isMissedTrade?t.tradeTypes.includes("missed"):c.isBacktestTrade?t.tradeTypes.includes("backtest"):t.tradeTypes.includes("regular"))),((l=t.statuses)==null?void 0:l.length)>0&&(r=r.filter(c=>{if(yt(c))return t.statuses.includes("open");let u=Xg(c);return u>0?t.statuses.includes("win"):u<0?t.statuses.includes("loss"):t.statuses.includes("breakeven")})),r}Oa();_t();Tr();var fk=class fk{constructor(t,r){this.cache=new Map;this.subscribers=new Map;this.pendingPopulations=new Map;this.populateDebounceTimers=new Map;this.eventCleanup=[];this.debugEnabled=!1;this.app=t,this.plugin=r,this.setupEventListeners(),this.setupFileOpenListener(),this.startCleanupInterval()}setDebug(t){this.debugEnabled=t}log(...t){this.debugEnabled&&console.log("[ReviewDataCache]",...t)}setupEventListeners(){let t=a=>{if(a.action==="updated"||a.action==="created"||a.action==="deleted")if(a.filePath)this.invalidateByTradeChange(a.filePath);else if(a.filePaths&&a.filePaths.length>0)for(let o of a.filePaths)this.invalidateByTradeChange(o);else this.invalidateAll();else a.action==="batch"&&this.invalidateAll()},r=a=>{let{filePath:o,filters:s}=a;o&&s&&this.cache.get(o)&&this.reapplyFilters(o,s)},n=()=>{this.notifyAllSubscribers()},i=a=>{this.cache.has(a.path)&&this.populateDebounced(a.path)};this.eventCleanup.push(xe.subscribe("trade:changed",t),xe.subscribe("filter:changed",r),xe.subscribe("settings:changed",n)),this.plugin.registerEvent(this.app.metadataCache.on("changed",i))}setupFileOpenListener(){let t=r=>{var a;if(!r)return;let n=this.app.metadataCache.getFileCache(r),i=(a=n==null?void 0:n.frontmatter)==null?void 0:a.type;i&&["drc","weekly-review","monthly-review","quarterly-review","yearly-review"].includes(i)&&(this.cache.has(r.path)||(this.log("Pre-populating on file open:",r.path),this.populate(r.path)))};this.plugin.registerEvent(this.app.workspace.on("file-open",t))}startCleanupInterval(){let t=window.setInterval(()=>{this.cleanupStaleEntries()},3e5);this.eventCleanup.push(()=>{window.clearInterval(t)})}cleanupStaleEntries(){let t=Date.now(),r=0;for(let[n,i]of this.cache.entries()){let a=t-i.populatedAt,o=this.subscribers.has(n)&&this.subscribers.get(n).size>0;a>fk.CACHE_TTL_MS&&!o&&(this.cache.delete(n),r++)}r>0&&this.log(`Cleaned up ${r} stale cache entries`)}get(t){let r=this.cache.get(t);return r?this.log("Cache hit:",t):this.log("Cache miss:",t),r||null}has(t){return this.cache.has(t)}async populate(t){let r=this.pendingPopulations.get(t);if(r)return this.log("Returning existing population promise:",t),r.promise;this.log("Starting population:",t);let n=this.doPopulate(t);this.pendingPopulations.set(t,{promise:n,timestamp:Date.now()});try{await n,this.log("Population complete:",t)}finally{this.pendingPopulations.delete(t)}}populateDebounced(t){let r=this.populateDebounceTimers.get(t);r&&clearTimeout(r);let n=setTimeout(()=>{this.populateDebounceTimers.delete(t),this.populate(t)},fk.POPULATE_DEBOUNCE_MS);this.populateDebounceTimers.set(t,n)}async doPopulate(t){var h,y,b;let r=this.app.vault.getAbstractFileByPath(t);if(!(r instanceof Zq.TFile))return;let n=this.app.metadataCache.getFileCache(r),i=n==null?void 0:n.frontmatter;if(!i){await this.retryPopulate(t,5,150);return}if(!["drc","weekly-review","monthly-review","quarterly-review","yearly-review","trade"].includes(i.type))return;let o=i.type==="trade"?i.entryTime:i.date,s=ur(o);if(!s)return;let l,c,d;if(i.type==="drc"){d=mc(s,this.plugin);let k=Zt(s,this.plugin);l=new Date(k),l.setHours(0,0,0,0),c=new Date(k),c.setHours(23,59,59,999)}else if(i.type==="weekly-review")l=i.weekStart&&(h=ur(i.weekStart))!=null?h:s,c=i.weekEnd?(y=ur(i.weekEnd))!=null?y:new Date(l.getTime()+10080*60*1e3):new Date(l.getTime()+10080*60*1e3);else if(i.type==="monthly-review")l=new Date(s.getFullYear(),s.getMonth(),1),c=new Date(s.getFullYear(),s.getMonth()+1,0,23,59,59,999);else if(i.type==="quarterly-review"){let k=i.quarterStart?ur(i.quarterStart):null,x=i.quarterEnd?ur(i.quarterEnd):null;if(k&&x)l=k,c=x,c.setHours(23,59,59,999);else{let w=Math.floor(s.getMonth()/3)*3;l=new Date(s.getFullYear(),w,1),c=new Date(s.getFullYear(),w+3,0,23,59,59,999)}}else if(i.type==="yearly-review"){let k=i.yearStart?ur(i.yearStart):null,x=i.yearEnd?ur(i.yearEnd):null;if(k&&x)l=k,c=x,c.setHours(23,59,59,999);else{let S=i.year||s.getFullYear();l=new Date(S,0,1,0,0,0,0),c=new Date(S,11,31,23,59,59,999)}}else l=s,c=s;let u=(b=this.plugin.settings.viewFilters)==null?void 0:b.reviews,p={accounts:(u==null?void 0:u.accounts)||[],tickers:(u==null?void 0:u.tickers)||[],setups:(u==null?void 0:u.setups)||[],tags:(u==null?void 0:u.tags)||[],tradeTypes:(u==null?void 0:u.tradeTypes)||[],statuses:(u==null?void 0:u.statuses)||[]},m=[];if(this.plugin.tradeService)try{let k=await this.plugin.tradeService.getTradeData({fresh:!1});d?m=k.filter(x=>{if(!x.entryTime)return!1;let S=new Date(x.entryTime);return mc(S,this.plugin)===d}):m=k.filter(x=>{if(!x.entryTime)return!1;let S=new Date(x.entryTime);return S>=l&&S<=c}),m=Xxe(m,p)}catch(k){console.error("[ReviewDataCache] Error fetching trades:",k)}let g=this.cache.get(t),f=g?g.version+1:1,v={frontmatter:i,noteType:i.type,dateRange:{start:l,end:c},tradingDayStr:d,filters:p,trades:m,version:f,populatedAt:Date.now()};this.cache.set(t,v),this.notifySubscribers(t,v)}async retryPopulate(t,r,n){for(let i=0;i<r;i++){await new Promise(s=>setTimeout(s,n));let a=this.app.vault.getAbstractFileByPath(t);if(!(a instanceof Zq.TFile))return;let o=this.app.metadataCache.getFileCache(a);if(o!=null&&o.frontmatter){await this.doPopulate(t);return}}}async reapplyFilters(t,r){this.cache.get(t)&&await this.populate(t)}invalidate(t){this.cache.delete(t),this.notifySubscribers(t,null)}invalidateAll(){let t=Array.from(this.cache.keys());this.cache.clear();for(let r of t)this.notifySubscribers(r,null);for(let r of t)this.populateDebounced(r)}invalidateByTradeChange(t,r){if(!r){this.invalidateAll();return}let n=new Date(r);if(isNaN(n.getTime())){this.invalidateAll();return}for(let[i,a]of this.cache.entries()){let{start:o,end:s}=a.dateRange;n>=o&&n<=s&&(this.invalidate(i),this.populateDebounced(i))}}subscribe(t,r){return this.subscribers.has(t)||this.subscribers.set(t,new Set),this.subscribers.get(t).add(r),()=>{let n=this.subscribers.get(t);n&&(n.delete(r),n.size===0&&this.subscribers.delete(t))}}notifySubscribers(t,r){let n=this.subscribers.get(t);if(n)for(let i of n)try{i(r)}catch(a){console.error("[ReviewDataCache] Subscriber error:",a)}}notifyAllSubscribers(){for(let[t,r]of this.cache.entries())this.notifySubscribers(t,r)}getStats(){let t=0;for(let r of this.subscribers.values())t+=r.size;return{entries:this.cache.size,subscribers:t,pending:this.pendingPopulations.size}}destroy(){for(let t of this.populateDebounceTimers.values())clearTimeout(t);this.populateDebounceTimers.clear(),this.pendingPopulations.clear(),this.cache.clear(),this.subscribers.clear();for(let t of this.eventCleanup)t();this.eventCleanup=[]}};fk.POPULATE_DEBOUNCE_MS=150,fk.CACHE_TTL_MS=600*1e3;var BP=fk;Tr();var lv=require("obsidian");Xw();_t();var Vb="quarterly-folder-structure-v1";function sv(e,t){if(typeof e!="string")return null;let r=t.replace(/\/$/,""),n=new RegExp(`^(${QYe(r)})/(\\d{4})/(0[1-9]|1[0-2])/(.+)$`),i=e.match(n);if(!i)return null;let[,a,o,s,l]=i,c=parseInt(s,10),d=Oi(c),u=zu(d);return`${a}/${o}/${u}/${s}/${l}`}function QYe(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function EO(e,t){if(!e||!Array.isArray(e))return{updated:[],hasChanges:!1};let r=!1;return{updated:e.map(i=>{if(typeof i!="string")return i;let a=sv(i,t);return a?(r=!0,a):i}),hasChanges:r}}function DO(e,t){if(!e||typeof e!="object")return!1;if(e.images&&Array.isArray(e.images)){let r=EO(e.images,t);if(r.hasChanges)return e.images=r.updated,!0}return!1}function nV(){if(!document.getElementById("jl-migration-styles")){let e=document.createElement("style");e.id="jl-migration-styles",e.textContent=`
      @keyframes jl-spin {
        to { transform: rotate(360deg); }
      }
      .jl-migration-modal .modal-close-button { display: none !important; }
    `,document.head.appendChild(e)}}var eV=class extends lv.Modal{constructor(t,r,n){super(t),this.titleEl.setText("Journalit: Migration Required"),this.modalEl.addClass("jl-migration-modal"),this.legacyFolderCount=r,this.onConfirm=n}onOpen(){let{contentEl:t}=this;t.empty(),nV();let r=t.createDiv();r.style.cssText="padding: 20px; font-family: var(--default-font);";let n=r.createDiv();n.style.cssText="display: flex; align-items: center; margin-bottom: 16px; padding-bottom: 12px; border-bottom: 1px solid var(--background-modifier-border);";let i=n.createDiv();i.style.cssText="width: 36px; height: 36px; border-radius: 50%; background: rgba(59, 130, 246, 0.15); display: flex; align-items: center; justify-content: center;",i.innerHTML='<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#3b82f6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>';let a=r.createEl("p");a.textContent=`Journalit has updated to a new folder structure that organizes your trades by quarter. This one-time migration will reorganize ${this.legacyFolderCount} folder${this.legacyFolderCount!==1?"s":""}.`,a.style.cssText="margin: 0 0 16px 0; color: var(--text-normal); font-size: 14px; line-height: 1.5;";let o=r.createDiv();o.style.cssText="background: var(--background-secondary); padding: 12px; border-radius: 6px; margin-bottom: 16px;";let s=o.createEl("p");s.innerHTML="<strong>What will happen:</strong>",s.style.cssText="margin: 0 0 8px 0; color: var(--text-normal); font-size: 13px;";let l=o.createEl("ul");l.style.cssText="margin: 0; padding-left: 20px; color: var(--text-muted); font-size: 13px; line-height: 1.6;",["Folders will move from <code>Year/Month/</code> to <code>Year/Quarter/Month/</code>","All your trades and notes will be preserved","Takes only a few seconds"].forEach(m=>{let g=l.createEl("li");g.innerHTML=m});let d=r.createEl("p");d.innerHTML="<strong>Important:</strong> After migration, you'll need to reload Obsidian for changes to take effect.",d.style.cssText="margin: 0 0 20px 0; color: var(--text-muted); font-size: 13px; line-height: 1.4;";let u=r.createDiv();u.style.cssText="display: flex; justify-content: flex-end; padding-top: 12px; border-top: 1px solid var(--background-modifier-border);";let p=u.createEl("button");p.textContent="Start Migration",p.style.cssText="padding: 8px 20px; border: none; background: var(--interactive-accent); color: var(--text-on-accent); border-radius: 4px; cursor: pointer; font-weight: 500;",p.onclick=()=>{this.close(),this.onConfirm()}}onClose(){let{contentEl:t}=this;t.empty()}},tV=class extends lv.Modal{constructor(r){super(r);this.statusEl=null;this.titleEl.setText("Journalit: Migrating..."),this.modalEl.addClass("jl-migration-modal")}onOpen(){let{contentEl:r}=this;r.empty(),nV();let n=r.createDiv({cls:"jl-migration-container"});n.style.cssText="padding: 24px; text-align: center; min-width: 300px;";let i=n.createDiv();i.style.cssText="margin-bottom: 16px;";let a=i.createEl("div");a.style.cssText=`
      width: 40px;
      height: 40px;
      border: 3px solid var(--background-modifier-border);
      border-top-color: var(--interactive-accent);
      border-radius: 50%;
      margin: 0 auto;
      animation: jl-spin 1s linear infinite;
    `,this.statusEl=n.createEl("p"),this.statusEl.textContent="Moving folders to quarterly structure...",this.statusEl.style.cssText="margin: 0 0 16px 0; color: var(--text-muted); font-size: 14px;";let o=n.createEl("p");o.textContent="Your data is safe. This only takes a moment.",o.style.cssText="margin: 0; color: var(--text-faint); font-size: 12px;"}updateStatus(r){this.statusEl&&(this.statusEl.textContent=r)}onClose(){let{contentEl:r}=this;r.empty()}},rV=class extends lv.Modal{constructor(t,r,n=0){super(t),this.titleEl.setText("Journalit: Migration Complete"),this.modalEl.addClass("jl-migration-modal"),this.foldersMovedCount=r,this.imagesUpdatedCount=n}onOpen(){let{contentEl:t}=this;t.empty(),nV();let r=t.createDiv();r.style.cssText="padding: 20px; font-family: var(--default-font);";let n=r.createEl("p"),i=`Successfully reorganized ${this.foldersMovedCount} folder${this.foldersMovedCount!==1?"s":""} into the new quarterly structure.`;this.imagesUpdatedCount>0&&(i+=` Updated image paths in ${this.imagesUpdatedCount} file${this.imagesUpdatedCount!==1?"s":""}.`),n.textContent=i,n.style.cssText="margin: 0 0 16px 0; color: var(--text-normal); font-size: 14px; line-height: 1.5;";let a=r.createDiv();a.style.cssText="background: var(--background-secondary); padding: 12px; border-radius: 6px; margin-bottom: 20px;";let o=a.createEl("p");o.innerHTML="<strong>Please reload Obsidian now</strong> to complete the update.",o.style.cssText="margin: 0 0 8px 0; color: var(--text-normal); font-size: 13px;";let s=a.createEl("p");s.innerHTML='Press <kbd style="background: var(--background-primary); padding: 2px 6px; border-radius: 3px; border: 1px solid var(--background-modifier-border); font-family: monospace; font-size: 12px;">Ctrl+R</kbd> (or <kbd style="background: var(--background-primary); padding: 2px 6px; border-radius: 3px; border: 1px solid var(--background-modifier-border); font-family: monospace; font-size: 12px;">Cmd+R</kbd> on Mac)',s.style.cssText="margin: 0; color: var(--text-muted); font-size: 12px;";let l=r.createDiv();l.style.cssText="display: flex; justify-content: flex-end; gap: 10px; padding-top: 12px; border-top: 1px solid var(--background-modifier-border);";let c=l.createEl("button");c.textContent="Later",c.style.cssText="padding: 8px 16px; border: 1px solid var(--background-modifier-border); background: var(--background-primary); color: var(--text-normal); border-radius: 4px; cursor: pointer;",c.onclick=()=>this.close();let d=l.createEl("button");d.textContent="Reload Now",d.style.cssText="padding: 8px 20px; border: none; background: var(--interactive-accent); color: var(--text-on-accent); border-radius: 4px; cursor: pointer; font-weight: 500;",d.onclick=()=>{this.close(),this.app.commands.executeCommandById("app:reload")}}onClose(){let{contentEl:t}=this;t.empty()}};function Zxe(e){let t=parseInt(e,10);return/^\d{2}$/.test(e)&&t>=1&&t<=12}function e0e(e){let t=parseInt(e,10);return/^\d{4}$/.test(e)&&t>=2e3&&t<=2100}async function t0e(e,t){let r=0,i=(await e.vault.adapter.list(t)).folders.map(a=>a.split("/").pop()||"").filter(e0e);for(let a of i){let o=`${t}/${a}`,l=(await e.vault.adapter.list(o)).folders.map(c=>c.split("/").pop()||"").filter(Zxe);r+=l.length}return r}async function XYe(e,t){var o,s,l,c,d,u,p;let r=[],n=0,a=e.vault.getMarkdownFiles().filter(m=>m.path.startsWith(t));console.log(`[QuarterlyMigration] Scanning ${a.length} files for image path updates`);for(let m of a)try{let g=e.metadataCache.getFileCache(m),f=g==null?void 0:g.frontmatter;if(!f)continue;let v=!1;if(f.images&&Array.isArray(f.images)){for(let y of f.images)if(typeof y=="string"&&sv(y,t)){v=!0;break}}if(!v&&f.type==="drc"){if(f.forecast&&typeof f.forecast=="object")for(let y of Object.keys(f.forecast)){if(y==="bias"||y==="levels"||y==="keyLevels")continue;let b=f.forecast[y];if(y==="customTimeframes"&&typeof b=="object"){for(let k of Object.values(b))if((o=k==null?void 0:k.images)!=null&&o.some(x=>typeof x=="string"&&sv(x,t))){v=!0;break}}else(s=b==null?void 0:b.images)!=null&&s.some(k=>typeof k=="string"&&sv(k,t))&&(v=!0);if(v)break}if(!v&&((c=(l=f.endOfDayReview)==null?void 0:l.images)!=null&&c.some(y=>typeof y=="string"&&sv(y,t)))&&(v=!0),!v&&f.missedTrades&&Array.isArray(f.missedTrades)){for(let y of f.missedTrades)if((d=y==null?void 0:y.images)!=null&&d.some(b=>typeof b=="string"&&sv(b,t))){v=!0;break}}}if(!v&&f.type==="weekly-review"&&f.forecast&&typeof f.forecast=="object")for(let y of Object.keys(f.forecast)){let b=f.forecast[y];if(y==="customTimeframes"&&typeof b=="object"){for(let k of Object.values(b))if((u=k==null?void 0:k.images)!=null&&u.some(x=>typeof x=="string"&&sv(x,t))){v=!0;break}}else(p=b==null?void 0:b.images)!=null&&p.some(k=>typeof k=="string"&&sv(k,t))&&(v=!0);if(v)break}if(!v)continue;let h=!1;await e.fileManager.processFrontMatter(m,y=>{var b;if(y.images&&Array.isArray(y.images)){let k=EO(y.images,t);k.hasChanges&&(y.images=k.updated,h=!0)}if(y.type==="drc"){if(y.forecast&&typeof y.forecast=="object")for(let k of Object.keys(y.forecast)){if(k==="bias"||k==="levels"||k==="keyLevels")continue;let x=y.forecast[k];if(k==="customTimeframes"&&typeof x=="object")for(let S of Object.keys(x))DO(x[S],t)&&(h=!0);else DO(x,t)&&(h=!0)}if((b=y.endOfDayReview)!=null&&b.images){let k=EO(y.endOfDayReview.images,t);k.hasChanges&&(y.endOfDayReview.images=k.updated,h=!0)}if(y.missedTrades&&Array.isArray(y.missedTrades)){for(let k of y.missedTrades)if(k!=null&&k.images){let x=EO(k.images,t);x.hasChanges&&(k.images=x.updated,h=!0)}}}if(y.type==="weekly-review"&&y.forecast&&typeof y.forecast=="object")for(let k of Object.keys(y.forecast)){let x=y.forecast[k];if(k==="customTimeframes"&&typeof x=="object")for(let S of Object.keys(x))DO(x[S],t)&&(h=!0);else DO(x,t)&&(h=!0)}}),h&&(n++,console.log(`[QuarterlyMigration] Updated image paths in: ${m.path}`))}catch(g){let f=`Failed to update images in ${m.path}: ${g instanceof Error?g.message:String(g)}`;r.push(f),console.error(`[QuarterlyMigration] ${f}`)}return{updatedCount:n,errors:r}}async function r0e(e,t){return await mu(e,Vb)||!await e.vault.adapter.exists(t)?!1:await t0e(e,t)>0}async function ZYe(e,t){if(await mu(e,Vb))return console.log("[QuarterlyMigration] Already completed, skipping"),{migrated:!1,foldersMovedCount:0,imagesUpdatedCount:0,errors:[]};if(!await e.vault.adapter.exists(t))return await Wb(e,Vb,{version:"1.0.0",fileCount:0}),console.log("[QuarterlyMigration] No journal folder exists, marking complete"),{migrated:!0,foldersMovedCount:0,imagesUpdatedCount:0,errors:[]};let i=[],a=0,o=0;try{let l=(await e.vault.adapter.list(t)).folders.map(d=>d.split("/").pop()||"").filter(e0e);for(let d of l){let u=`${t}/${d}`,m=(await e.vault.adapter.list(u)).folders.map(g=>g.split("/").pop()||"").filter(Zxe);for(let g of m){let f=parseInt(g,10),v=Oi(f),h=zu(v),y=`${u}/${g}`,b=`${u}/${h}`,k=`${b}/${g}`;try{await e.vault.adapter.exists(b)||await e.vault.adapter.mkdir(b),await e.vault.adapter.rename(y,k),a++,console.log(`[QuarterlyMigration] Moved ${y} \u2192 ${k}`)}catch(x){let S=`Failed to move ${y}: ${x instanceof Error?x.message:String(x)}`;i.push(S),console.error(`[QuarterlyMigration] ${S}`)}}}console.log("[QuarterlyMigration] Now updating image paths in frontmatter..."),a>0&&await new Promise(d=>setTimeout(d,500));let c=await XYe(e,t);return o=c.updatedCount,i.push(...c.errors),console.log(`[QuarterlyMigration] Updated image paths in ${o} files`),await Wb(e,Vb,{version:"1.0.0",fileCount:a,errors:i.length}),console.log(`[QuarterlyMigration] Complete. Moved ${a} folders, updated ${o} files with image paths, ${i.length} errors`),{migrated:!0,foldersMovedCount:a,imagesUpdatedCount:o,errors:i}}catch(s){let l=`Migration failed: ${s instanceof Error?s.message:String(s)}`;return i.push(l),console.error(`[QuarterlyMigration] ${l}`),{migrated:!1,foldersMovedCount:a,imagesUpdatedCount:o,errors:i}}}async function n0e(e,t){if(await mu(e,Vb))return{migrated:!1,foldersMovedCount:0,imagesUpdatedCount:0,errors:[]};if(!await e.vault.adapter.exists(t))return await Wb(e,Vb,{version:"1.0.0",fileCount:0}),{migrated:!0,foldersMovedCount:0,imagesUpdatedCount:0,errors:[]};let i=await t0e(e,t);return i===0?(await Wb(e,Vb,{version:"1.0.0",fileCount:0}),console.log("[QuarterlyMigration] No legacy folders found, marking complete"),{migrated:!0,foldersMovedCount:0,imagesUpdatedCount:0,errors:[]}):new Promise(a=>{new eV(e,i,async()=>{let s=new tV(e);s.open();let l={migrated:!1,foldersMovedCount:0,imagesUpdatedCount:0,errors:[]};try{await new Promise(c=>setTimeout(c,100)),l=await ZYe(e,t),l.foldersMovedCount>0?new rV(e,l.foldersMovedCount,l.imagesUpdatedCount).open():l.errors.length>0?new lv.Notice(`Journalit: Migration encountered ${l.errors.length} errors. Check console for details.`,8e3):new lv.Notice("Journalit: Migration complete. Please reload Obsidian.",5e3)}catch(c){console.error("[QuarterlyMigration] Unexpected error:",c),new lv.Notice("Journalit: Migration failed. Check console for details.",8e3),l={migrated:!1,foldersMovedCount:0,imagesUpdatedCount:0,errors:[String(c)]}}finally{s.close()}a(l)}).open()})}var hj=class{constructor(t){this.plugin=t}async initialize(){let t=Date.now();window.__obsidianStartTime=t,await this.initializeCriticalPath();let{migrationPending:r}=await this.initializeCoreServices();if(r){console.log("[Journalit] Plugin load complete (migration pending)");return}await this.setupEssentialUI(),await this.registerCoreFunctionality(),this.plugin.app.workspace.onLayoutReady(()=>{this.initializeNonCriticalComponents(),setTimeout(()=>{this.openHomeOnStartup()},100)})}async initializeCriticalPath(){_X(this.plugin),window.journalitPlugin=this.plugin,window.JournalitPlugin=gm,gm.instance=this.plugin,this.plugin.settings=await this.plugin.settingsManager.loadSettings();let t=await this.plugin.uiStateManager.loadState();t.recentItems.length===0&&!t.lastUsedFilters&&!t.viewFilters&&!t.tradeLog&&this.plugin.uiStateManager.hasLegacyUIData(this.plugin.settings)&&await this.plugin.uiStateManager.migrateFromSettings(this.plugin.settings)&&(this.plugin.settings=this.plugin.uiStateManager.cleanMigratedFields(this.plugin.settings),await this.plugin.settingsManager.saveSettings(this.plugin.settings)),this.plugin.recentItems=[...this.plugin.uiStateManager.getState().recentItems],await this.cleanupOldFiles(),this.plugin.lastFileOpenTime=Date.now();let{removeInjectedStyles:n}=await Promise.resolve().then(()=>(rl(),cee));n(!1,!1,!0,!0),tbe();let{ServiceManager:i}=await Promise.resolve().then(()=>(YO(),O0e)),{ProcessorManager:a}=await Promise.resolve().then(()=>(Ewe(),Dwe)),{ViewManager:o}=await Promise.resolve().then(()=>(I1e(),E1e));this.plugin.serviceManager=i.getInstance(this.plugin.app,this.plugin),this.plugin.processorManager=a.getInstance(this.plugin.app,this.plugin),this.plugin.viewManager=o.getInstance(this.plugin),this.plugin.eventBus=th.getInstance(),this.plugin.processorManager.getWidgetCodeblockProcessor(),this.plugin.navigationManager=new SO(this.plugin,this.plugin.viewManager)}async initializeCoreServices(){var i;let t=((i=this.plugin.settings.general)==null?void 0:i.journalFolderPath)||"!Journalit";if(await r0e(this.plugin.app,t))return console.log("[Journalit] Migration needed - deferring service initialization"),n0e(this.plugin.app,t).then(()=>{console.log("[Journalit] Migration complete - now initializing services"),this.completeInitializationAfterMigration()}).catch(a=>{console.error("[Journalit] Migration failed:",a)}),{migrationPending:!0};await this.plugin.serviceManager.initializeCoreServices(),this.plugin.authManager=this.plugin.serviceManager.getAuthManager(),this.plugin.tradeService=this.plugin.serviceManager.getTradeService(),this.plugin.customFieldsService=this.plugin.serviceManager.getCustomFieldsService(),this.plugin.optionsService=this.plugin.serviceManager.getOptionsServiceSync(),this.plugin.reviewDataCache=new BP(this.plugin.app,this.plugin),this.plugin.tradeService.getTradeData({fresh:!1}).catch(a=>{console.error("[Journalit] Failed to pre-warm trade cache:",a)});let{InstrumentSpecService:n}=await Promise.resolve().then(()=>(OY(),FY));this.plugin.specService=new n(this.plugin);try{this.plugin.specService.loadMappings(),console.log("[Journalit] InstrumentSpecService initialized")}catch(a){console.error("[Journalit] Failed to load symbol mappings from settings, continuing with empty mappings:",a)}this.plugin.updateNotificationService=new _P(this.plugin),this.plugin.registerView(Hb,a=>new jP(a));try{await this.plugin.viewManager.registerHomeView()}catch(a){console.error("[Journalit] Failed to register home view early:",a)}return{migrationPending:!1}}async completeInitializationAfterMigration(){try{await this.plugin.serviceManager.initializeCoreServices(),this.plugin.authManager=this.plugin.serviceManager.getAuthManager(),this.plugin.tradeService=this.plugin.serviceManager.getTradeService(),this.plugin.customFieldsService=this.plugin.serviceManager.getCustomFieldsService(),this.plugin.optionsService=this.plugin.serviceManager.getOptionsServiceSync(),this.plugin.reviewDataCache=new BP(this.plugin.app,this.plugin),this.plugin.tradeService.getTradeData({fresh:!1}).catch(r=>{console.error("[Journalit] Failed to pre-warm trade cache:",r)});let{InstrumentSpecService:t}=await Promise.resolve().then(()=>(OY(),FY));this.plugin.specService=new t(this.plugin);try{this.plugin.specService.loadMappings(),console.log("[Journalit] InstrumentSpecService initialized")}catch(r){console.error("[Journalit] Failed to load symbol mappings:",r)}this.plugin.updateNotificationService=new _P(this.plugin),this.plugin.registerView(Hb,r=>new jP(r));try{await this.plugin.viewManager.registerHomeView()}catch(r){console.error("[Journalit] Failed to register home view:",r)}await this.setupEssentialUI(),await this.registerCoreFunctionality(),this.initializeNonCriticalComponents(),console.log("[Journalit] Post-migration initialization complete")}catch(t){console.error("[Journalit] Failed to complete initialization after migration:",t)}}async setupEssentialUI(){let{JournalitSettingsTab:t}=await Promise.resolve().then(()=>(pCe(),uCe));await Promise.resolve();let r=new t(this.plugin.app,this.plugin);this.plugin.settingsTab=r,this.plugin.addSettingTab(r),this.setupEventHandlers()}setupEventHandlers(){this.plugin.registerEvent(this.plugin.app.workspace.on("file-open",t=>{if(this.plugin.lastFileOpenTime=Date.now(),t){let r={type:"file",title:t.basename,path:t.path,icon:"file-text",openedAt:new Date().toISOString()};this.plugin.navigationManager.addRecentItem(r)}})),this.plugin.registerEvent(this.plugin.app.workspace.on("active-leaf-change",t=>{if(t&&t.view){let r=t.view.getViewType(),i=(a=>{switch(a){case"journalit-dashboard-view":return{label:"Trading Dashboard",icon:"grip"};case"account-dashboard":return{label:"Account Dashboard",icon:"users"};case"journalit-trade-log-view":return{label:"Trade Log",icon:"folder-tree"};case"journalit-account-page-view":return{label:t.getDisplayText()||"Account Page",icon:"user"};default:return null}})(r);i&&this.plugin.navigationManager.trackRecentView(r,i.label,i.icon)}}))}async registerCoreFunctionality(){await this.plugin.viewManager.registerDashboardView(),await this.plugin.viewManager.registerAccountDashboardView(),await this.plugin.viewManager.registerTradeLogView(),await this.plugin.viewManager.registerAccountPageView(),await this.plugin.viewManager.registerCSVImportView(),await this.plugin.viewManager.registerTemplateBuilderView(),console.log("[Journalit] All views registered successfully")}async initializeNonCriticalComponents(){let t=Date.now();try{rbe();try{this.plugin.serviceManager.preInitializeServices(["onboardingService"]),typeof window.requestIdleCallback=="function"&&window.requestIdleCallback(()=>{var r;(r=this.plugin.onboardingManager)==null||r.checkAndShowOnboarding()}),typeof window.requestIdleCallback=="function"&&window.requestIdleCallback(async()=>{try{await Promise.resolve().then(()=>(Dq(),Pq))}catch(r){}})}catch(r){console.warn("[Journalit] Failed to warm-up onboarding modules:",r)}this.plugin.commandRegistry=new VF(this.plugin),this.plugin.ribbonManager=new GF(this.plugin),this.plugin.onboardingManager=new eO(this.plugin),await bP([()=>{this.plugin.commandRegistry.registerAllCommands(),this.plugin.ribbonManager.registerRibbonIcons()},async()=>{await this.plugin.processorManager.initializeRequiredProcessors(),this.plugin.processorManager.registerProcessor("missed-trade",new ck(this.plugin.app,this.plugin)),this.plugin.processorManager.registerRenderer("missed-trade",new lk(this.plugin.app));let r=this.plugin.processorManager.getAllInitializedProcessors();this.plugin.tradeNoteProcessor=r.tradeNoteProcessor},async()=>{try{this.plugin.setupService=await this.plugin.serviceManager.getSetupService(),this.plugin.drcService=await this.plugin.serviceManager.getDRCService()}catch(r){console.error("Error initializing high-priority services:",r)}},async()=>{try{this.plugin.weeklyReviewService=await this.plugin.serviceManager.getWeeklyReviewService(),this.plugin.monthlyReviewService=await this.plugin.serviceManager.getMonthlyReviewService(),this.plugin.quarterlyReviewService=await this.plugin.serviceManager.getQuarterlyReviewService(),this.plugin.missedTradeService=await this.plugin.serviceManager.getMissedTradeService(),this.plugin.backtestTradeService=await this.plugin.serviceManager.getBacktestTradeService(),jp.getInstance().initialize()}catch(r){console.error("Error initializing secondary services:",r)}},async()=>{try{this.plugin.accountPageService=await this.plugin.serviceManager.getAccountPageService()}catch(r){console.error("Error initializing background services:",r)}},async()=>{await this.plugin.viewManager.registerAllViews()},async()=>{await this.handleInitialFileRendering()},async()=>{var r,n;try{if((r=this.plugin.settings.backendIntegration)!=null&&r.syncEnabled){let i=await this.plugin.serviceManager.getBackendIntegrationService();this.plugin.backendIntegrationService=i,await i.registerVault()}}catch(i){console.error("Error initializing backend integration:",i)}try{await((n=this.plugin.updateNotificationService)==null?void 0:n.checkForUpdates())}catch(i){console.error("Error checking for plugin updates:",i)}}],30)}catch(r){console.error("Error during non-critical initialization:",r)}}async handleInitialFileRendering(){let t=this.plugin.app.workspace.getActiveFile();if(!t)return;let r=this.plugin.app.metadataCache.getFileCache(t),n=r==null?void 0:r.frontmatter;n&&n.type==="trade"&&(this.plugin.tradeNoteProcessor||(this.plugin.tradeNoteProcessor=await this.plugin.processorManager.getTradeNoteProcessor()))}async openHomeOnStartup(){await this.plugin.navigationManager.openHomeOnStartup()}async cleanupOldFiles(){try{let t=`${this.plugin.app.vault.configDir}/plugins/journalit/main.css`,r=this.plugin.app.vault.adapter;await r.exists(t)&&(await r.remove(t),console.log("[Journalit] Removed deprecated main.css file"))}catch(t){console.error("[Journalit] Error cleaning up old files:",t)}}};window&&(document.querySelectorAll("script").forEach(t=>{let r=t.textContent||"";(r.includes("DROPDOWN_FIX")||r.includes("COMBOBOX")||r.includes("TRADEFORM"))&&t.remove()}),window.__dropdownClickHandlerAdded=!1,window.__isHandlingComboBoxRemove=!1,window.__isInjectingStyles=!1);var gm=class extends kD.Plugin{constructor(){super(...arguments);this.backendIntegrationService=null;this.reviewDataCache=null;this.tradeNoteProcessor=null;this.recentItems=[];this.updateNotificationService=null;this.settingsTab=null}async onload(){this.settingsManager=new BF(this),this.uiStateManager=new $F(this),this.cleanupManager=new _F(this),this.pluginInitializer=new hj(this),await this.pluginInitializer.initialize()}openSettingsToTab(r){this.settingsTab&&this.settingsTab.setInitialTab(r),this.app.setting.open(),this.app.setting.openTabById(this.manifest.id)}async openAccountDashboard(){try{await this.viewManager.openAccountDashboardView()}catch(r){console.error("Error opening account dashboard:",r),new kD.Notice("Failed to open account dashboard: "+(r instanceof Error?r.message:String(r)))}}async onunload(){try{await this.cleanupManager.cleanup()}catch(r){console.error("Error during plugin cleanup:",r)}}async saveSettings(){await this.settingsManager.saveSettings(this.settings)}async openTradeFormInEditMode(r,n){try{new Eo({app:this.app,plugin:this,isEditMode:!0,initialData:r||{},filePath:n||""}).open()}catch(i){console.error("Failed to open trade form in edit mode:",i),new kD.Notice("Failed to open trade form in edit mode: "+(i instanceof Error?i.message:String(i)))}}async openFile(r,n=!0){await this.navigationManager.openFile(r,n)}trackRecentView(r,n,i){this.navigationManager.trackRecentView(r,n,i)}};gm.instance=null;
/*! Bundled license information:

react/cjs/react.production.min.js:
  (**
   * @license React
   * react.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

scheduler/cjs/scheduler.production.min.js:
  (**
   * @license React
   * scheduler.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

react-dom/cjs/react-dom.production.min.js:
  (**
   * @license React
   * react-dom.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/shared/src/utils.js:
lucide-react/dist/esm/defaultAttributes.js:
lucide-react/dist/esm/Icon.js:
lucide-react/dist/esm/createLucideIcon.js:
lucide-react/dist/esm/icons/arrow-down-1-0.js:
lucide-react/dist/esm/icons/arrow-down-wide-narrow.js:
lucide-react/dist/esm/icons/arrow-down-z-a.js:
lucide-react/dist/esm/icons/arrow-right.js:
lucide-react/dist/esm/icons/arrow-up-0-1.js:
lucide-react/dist/esm/icons/arrow-up-a-z.js:
lucide-react/dist/esm/icons/arrow-up-down.js:
lucide-react/dist/esm/icons/arrow-up-narrow-wide.js:
lucide-react/dist/esm/icons/award.js:
lucide-react/dist/esm/icons/badge-check.js:
lucide-react/dist/esm/icons/ban.js:
lucide-react/dist/esm/icons/blocks.js:
lucide-react/dist/esm/icons/book-open.js:
lucide-react/dist/esm/icons/brain.js:
lucide-react/dist/esm/icons/calendar-check.js:
lucide-react/dist/esm/icons/calendar-range.js:
lucide-react/dist/esm/icons/calendar.js:
lucide-react/dist/esm/icons/chart-column.js:
lucide-react/dist/esm/icons/check.js:
lucide-react/dist/esm/icons/chevron-down.js:
lucide-react/dist/esm/icons/chevron-right.js:
lucide-react/dist/esm/icons/chevron-up.js:
lucide-react/dist/esm/icons/circle-alert.js:
lucide-react/dist/esm/icons/circle-check.js:
lucide-react/dist/esm/icons/circle-plus.js:
lucide-react/dist/esm/icons/circle-question-mark.js:
lucide-react/dist/esm/icons/circle.js:
lucide-react/dist/esm/icons/clipboard-check.js:
lucide-react/dist/esm/icons/clipboard-paste.js:
lucide-react/dist/esm/icons/clock.js:
lucide-react/dist/esm/icons/copy.js:
lucide-react/dist/esm/icons/ellipsis.js:
lucide-react/dist/esm/icons/external-link.js:
lucide-react/dist/esm/icons/eye-off.js:
lucide-react/dist/esm/icons/eye.js:
lucide-react/dist/esm/icons/file-pen.js:
lucide-react/dist/esm/icons/file-text.js:
lucide-react/dist/esm/icons/file.js:
lucide-react/dist/esm/icons/flame.js:
lucide-react/dist/esm/icons/flask-conical.js:
lucide-react/dist/esm/icons/folder-open.js:
lucide-react/dist/esm/icons/folder-tree.js:
lucide-react/dist/esm/icons/funnel.js:
lucide-react/dist/esm/icons/gem.js:
lucide-react/dist/esm/icons/ghost.js:
lucide-react/dist/esm/icons/grid-2x2-plus.js:
lucide-react/dist/esm/icons/grip-vertical.js:
lucide-react/dist/esm/icons/grip.js:
lucide-react/dist/esm/icons/import.js:
lucide-react/dist/esm/icons/info.js:
lucide-react/dist/esm/icons/key.js:
lucide-react/dist/esm/icons/layout-template.js:
lucide-react/dist/esm/icons/lock.js:
lucide-react/dist/esm/icons/message-circle.js:
lucide-react/dist/esm/icons/minus.js:
lucide-react/dist/esm/icons/plus.js:
lucide-react/dist/esm/icons/radio.js:
lucide-react/dist/esm/icons/refresh-cw.js:
lucide-react/dist/esm/icons/rocket.js:
lucide-react/dist/esm/icons/rotate-ccw.js:
lucide-react/dist/esm/icons/save.js:
lucide-react/dist/esm/icons/settings.js:
lucide-react/dist/esm/icons/settings-2.js:
lucide-react/dist/esm/icons/shield.js:
lucide-react/dist/esm/icons/sliders-horizontal.js:
lucide-react/dist/esm/icons/snowflake.js:
lucide-react/dist/esm/icons/sparkles.js:
lucide-react/dist/esm/icons/square-check-big.js:
lucide-react/dist/esm/icons/square-pen.js:
lucide-react/dist/esm/icons/square.js:
lucide-react/dist/esm/icons/star.js:
lucide-react/dist/esm/icons/tag.js:
lucide-react/dist/esm/icons/target.js:
lucide-react/dist/esm/icons/trash-2.js:
lucide-react/dist/esm/icons/trash.js:
lucide-react/dist/esm/icons/trending-down.js:
lucide-react/dist/esm/icons/trending-up.js:
lucide-react/dist/esm/icons/triangle-alert.js:
lucide-react/dist/esm/icons/user.js:
lucide-react/dist/esm/icons/users.js:
lucide-react/dist/esm/icons/wrench.js:
lucide-react/dist/esm/icons/x.js:
lucide-react/dist/esm/icons/zap.js:
lucide-react/dist/esm/lucide-react.js:
  (**
   * @license lucide-react v0.562.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

use-sync-external-store/cjs/use-sync-external-store-shim.production.js:
  (**
   * @license React
   * use-sync-external-store-shim.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.production.js:
  (**
   * @license React
   * use-sync-external-store-shim/with-selector.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

decimal.js-light/decimal.js:
  (*! decimal.js-light v2.5.1 https://github.com/MikeMcl/decimal.js-light/LICENCE *)

react-is/cjs/react-is.production.min.js:
  (**
   * @license React
   * react-is.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

use-sync-external-store/cjs/use-sync-external-store-with-selector.production.js:
  (**
   * @license React
   * use-sync-external-store-with-selector.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

react/cjs/react-jsx-runtime.production.min.js:
  (**
   * @license React
   * react-jsx-runtime.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

papaparse/papaparse.min.js:
  (* @license
  Papa Parse
  v5.5.3
  https://github.com/mholt/PapaParse
  License: MIT
  *)
*/
