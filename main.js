/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository
*/

var fge=Object.create;var ux=Object.defineProperty;var gge=Object.getOwnPropertyDescriptor;var hge=Object.getOwnPropertyNames;var vge=Object.getPrototypeOf,yge=Object.prototype.hasOwnProperty;var bge=(e,t,r)=>t in e?ux(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var L=(e,t)=>()=>(e&&(t=e(e=0)),t);var Ie=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ko=(e,t)=>{for(var r in t)ux(e,r,{get:t[r],enumerable:!0})},C6=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of hge(t))!yge.call(e,o)&&o!==r&&ux(e,o,{get:()=>t[o],enumerable:!(n=gge(t,o))||n.enumerable});return e};var q=(e,t,r)=>(r=e!=null?fge(vge(e)):{},C6(t||!e||!e.__esModule?ux(r,"default",{value:e,enumerable:!0}):r,e)),uu=e=>C6(ux({},"__esModule",{value:!0}),e);var Dh=(e,t,r)=>bge(e,typeof t!="symbol"?t+"":t,r);var z6=Ie(Zt=>{"use strict";var px=Symbol.for("react.element"),xge=Symbol.for("react.portal"),wge=Symbol.for("react.fragment"),kge=Symbol.for("react.strict_mode"),Sge=Symbol.for("react.profiler"),Tge=Symbol.for("react.provider"),Cge=Symbol.for("react.context"),Pge=Symbol.for("react.forward_ref"),Dge=Symbol.for("react.suspense"),Ege=Symbol.for("react.memo"),Ige=Symbol.for("react.lazy"),P6=Symbol.iterator;function Age(e){return e===null||typeof e!="object"?null:(e=P6&&e[P6]||e["@@iterator"],typeof e=="function"?e:null)}var I6={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A6=Object.assign,L6={};function Eh(e,t,r){this.props=e,this.context=t,this.refs=L6,this.updater=r||I6}Eh.prototype.isReactComponent={};Eh.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Eh.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function N6(){}N6.prototype=Eh.prototype;function kN(e,t,r){this.props=e,this.context=t,this.refs=L6,this.updater=r||I6}var SN=kN.prototype=new N6;SN.constructor=kN;A6(SN,Eh.prototype);SN.isPureReactComponent=!0;var D6=Array.isArray,M6=Object.prototype.hasOwnProperty,TN={current:null},F6={key:!0,ref:!0,__self:!0,__source:!0};function O6(e,t,r){var n,o={},a=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(a=""+t.key),t)M6.call(t,n)&&!F6.hasOwnProperty(n)&&(o[n]=t[n]);var s=arguments.length-2;if(s===1)o.children=r;else if(1<s){for(var l=Array(s),c=0;c<s;c++)l[c]=arguments[c+2];o.children=l}if(e&&e.defaultProps)for(n in s=e.defaultProps,s)o[n]===void 0&&(o[n]=s[n]);return{$$typeof:px,type:e,key:a,ref:i,props:o,_owner:TN.current}}function Lge(e,t){return{$$typeof:px,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function CN(e){return typeof e=="object"&&e!==null&&e.$$typeof===px}function Nge(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var E6=/\/+/g;function wN(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Nge(""+e.key):t.toString(36)}function XS(e,t,r,n,o){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case px:case xge:i=!0}}if(i)return i=e,o=o(i),e=n===""?"."+wN(i,0):n,D6(o)?(r="",e!=null&&(r=e.replace(E6,"$&/")+"/"),XS(o,t,r,"",function(c){return c})):o!=null&&(CN(o)&&(o=Lge(o,r+(!o.key||i&&i.key===o.key?"":(""+o.key).replace(E6,"$&/")+"/")+e)),t.push(o)),1;if(i=0,n=n===""?".":n+":",D6(e))for(var s=0;s<e.length;s++){a=e[s];var l=n+wN(a,s);i+=XS(a,t,r,l,o)}else if(l=Age(e),typeof l=="function")for(e=l.call(e),s=0;!(a=e.next()).done;)a=a.value,l=n+wN(a,s++),i+=XS(a,t,r,l,o);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function JS(e,t,r){if(e==null)return e;var n=[],o=0;return XS(e,n,"","",function(a){return t.call(r,a,o++)}),n}function Mge(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Li={current:null},QS={transition:null},Fge={ReactCurrentDispatcher:Li,ReactCurrentBatchConfig:QS,ReactCurrentOwner:TN};function j6(){throw Error("act(...) is not supported in production builds of React.")}Zt.Children={map:JS,forEach:function(e,t,r){JS(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return JS(e,function(){t++}),t},toArray:function(e){return JS(e,function(t){return t})||[]},only:function(e){if(!CN(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Zt.Component=Eh;Zt.Fragment=wge;Zt.Profiler=Sge;Zt.PureComponent=kN;Zt.StrictMode=kge;Zt.Suspense=Dge;Zt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Fge;Zt.act=j6;Zt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=A6({},e.props),o=e.key,a=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,i=TN.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(l in t)M6.call(t,l)&&!F6.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&s!==void 0?s[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){s=Array(l);for(var c=0;c<l;c++)s[c]=arguments[c+2];n.children=s}return{$$typeof:px,type:e.type,key:o,ref:a,props:n,_owner:i}};Zt.createContext=function(e){return e={$$typeof:Cge,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Tge,_context:e},e.Consumer=e};Zt.createElement=O6;Zt.createFactory=function(e){var t=O6.bind(null,e);return t.type=e,t};Zt.createRef=function(){return{current:null}};Zt.forwardRef=function(e){return{$$typeof:Pge,render:e}};Zt.isValidElement=CN;Zt.lazy=function(e){return{$$typeof:Ige,_payload:{_status:-1,_result:e},_init:Mge}};Zt.memo=function(e,t){return{$$typeof:Ege,type:e,compare:t===void 0?null:t}};Zt.startTransition=function(e){var t=QS.transition;QS.transition={};try{e()}finally{QS.transition=t}};Zt.unstable_act=j6;Zt.useCallback=function(e,t){return Li.current.useCallback(e,t)};Zt.useContext=function(e){return Li.current.useContext(e)};Zt.useDebugValue=function(){};Zt.useDeferredValue=function(e){return Li.current.useDeferredValue(e)};Zt.useEffect=function(e,t){return Li.current.useEffect(e,t)};Zt.useId=function(){return Li.current.useId()};Zt.useImperativeHandle=function(e,t,r){return Li.current.useImperativeHandle(e,t,r)};Zt.useInsertionEffect=function(e,t){return Li.current.useInsertionEffect(e,t)};Zt.useLayoutEffect=function(e,t){return Li.current.useLayoutEffect(e,t)};Zt.useMemo=function(e,t){return Li.current.useMemo(e,t)};Zt.useReducer=function(e,t,r){return Li.current.useReducer(e,t,r)};Zt.useRef=function(e){return Li.current.useRef(e)};Zt.useState=function(e){return Li.current.useState(e)};Zt.useSyncExternalStore=function(e,t,r){return Li.current.useSyncExternalStore(e,t,r)};Zt.useTransition=function(){return Li.current.useTransition()};Zt.version="18.3.1"});var Y=Ie((VBe,_6)=>{"use strict";_6.exports=z6()});var Y6=Ie(cn=>{"use strict";function IN(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,o=e[n];if(0<ZS(o,t))e[n]=t,e[r]=o,r=n;else break e}}function cc(e){return e.length===0?null:e[0]}function tT(e){if(e.length===0)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,o=e.length,a=o>>>1;n<a;){var i=2*(n+1)-1,s=e[i],l=i+1,c=e[l];if(0>ZS(s,r))l<o&&0>ZS(c,s)?(e[n]=c,e[l]=r,n=l):(e[n]=s,e[i]=r,n=i);else if(l<o&&0>ZS(c,r))e[n]=c,e[l]=r,n=l;else break e}}return t}function ZS(e,t){var r=e.sortIndex-t.sortIndex;return r!==0?r:e.id-t.id}typeof performance=="object"&&typeof performance.now=="function"?(B6=performance,cn.unstable_now=function(){return B6.now()}):(PN=Date,$6=PN.now(),cn.unstable_now=function(){return PN.now()-$6});var B6,PN,$6,sd=[],kp=[],Oge=1,ml=null,ri=3,rT=!1,pf=!1,fx=!1,U6=typeof setTimeout=="function"?setTimeout:null,V6=typeof clearTimeout=="function"?clearTimeout:null,W6=typeof setImmediate!="undefined"?setImmediate:null;typeof navigator!="undefined"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function AN(e){for(var t=cc(kp);t!==null;){if(t.callback===null)tT(kp);else if(t.startTime<=e)tT(kp),t.sortIndex=t.expirationTime,IN(sd,t);else break;t=cc(kp)}}function LN(e){if(fx=!1,AN(e),!pf)if(cc(sd)!==null)pf=!0,MN(NN);else{var t=cc(kp);t!==null&&FN(LN,t.startTime-e)}}function NN(e,t){pf=!1,fx&&(fx=!1,V6(gx),gx=-1),rT=!0;var r=ri;try{for(AN(t),ml=cc(sd);ml!==null&&(!(ml.expirationTime>t)||e&&!G6());){var n=ml.callback;if(typeof n=="function"){ml.callback=null,ri=ml.priorityLevel;var o=n(ml.expirationTime<=t);t=cn.unstable_now(),typeof o=="function"?ml.callback=o:ml===cc(sd)&&tT(sd),AN(t)}else tT(sd);ml=cc(sd)}if(ml!==null)var a=!0;else{var i=cc(kp);i!==null&&FN(LN,i.startTime-t),a=!1}return a}finally{ml=null,ri=r,rT=!1}}var nT=!1,eT=null,gx=-1,H6=5,q6=-1;function G6(){return!(cn.unstable_now()-q6<H6)}function DN(){if(eT!==null){var e=cn.unstable_now();q6=e;var t=!0;try{t=eT(!0,e)}finally{t?mx():(nT=!1,eT=null)}}else nT=!1}var mx;typeof W6=="function"?mx=function(){W6(DN)}:typeof MessageChannel!="undefined"?(EN=new MessageChannel,R6=EN.port2,EN.port1.onmessage=DN,mx=function(){R6.postMessage(null)}):mx=function(){U6(DN,0)};var EN,R6;function MN(e){eT=e,nT||(nT=!0,mx())}function FN(e,t){gx=U6(function(){e(cn.unstable_now())},t)}cn.unstable_IdlePriority=5;cn.unstable_ImmediatePriority=1;cn.unstable_LowPriority=4;cn.unstable_NormalPriority=3;cn.unstable_Profiling=null;cn.unstable_UserBlockingPriority=2;cn.unstable_cancelCallback=function(e){e.callback=null};cn.unstable_continueExecution=function(){pf||rT||(pf=!0,MN(NN))};cn.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):H6=0<e?Math.floor(1e3/e):5};cn.unstable_getCurrentPriorityLevel=function(){return ri};cn.unstable_getFirstCallbackNode=function(){return cc(sd)};cn.unstable_next=function(e){switch(ri){case 1:case 2:case 3:var t=3;break;default:t=ri}var r=ri;ri=t;try{return e()}finally{ri=r}};cn.unstable_pauseExecution=function(){};cn.unstable_requestPaint=function(){};cn.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=ri;ri=e;try{return t()}finally{ri=r}};cn.unstable_scheduleCallback=function(e,t,r){var n=cn.unstable_now();switch(typeof r=="object"&&r!==null?(r=r.delay,r=typeof r=="number"&&0<r?n+r:n):r=n,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return o=r+o,e={id:Oge++,callback:t,priorityLevel:e,startTime:r,expirationTime:o,sortIndex:-1},r>n?(e.sortIndex=r,IN(kp,e),cc(sd)===null&&e===cc(kp)&&(fx?(V6(gx),gx=-1):fx=!0,FN(LN,r-n))):(e.sortIndex=o,IN(sd,e),pf||rT||(pf=!0,MN(NN))),e};cn.unstable_shouldYield=G6;cn.unstable_wrapCallback=function(e){var t=ri;return function(){var r=ri;ri=t;try{return e.apply(this,arguments)}finally{ri=r}}}});var J6=Ie((qBe,K6)=>{"use strict";K6.exports=Y6()});var eV=Ie(Rs=>{"use strict";var jge=Y(),$s=J6();function Me(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var nU=new Set,zx={};function Cf(e,t){Kh(e,t),Kh(e+"Capture",t)}function Kh(e,t){for(zx[e]=t,e=0;e<t.length;e++)nU.add(t[e])}var vu=!(typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"),nM=Object.prototype.hasOwnProperty,zge=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,X6={},Q6={};function _ge(e){return nM.call(Q6,e)?!0:nM.call(X6,e)?!1:zge.test(e)?Q6[e]=!0:(X6[e]=!0,!1)}function Bge(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function $ge(e,t,r,n){if(t===null||typeof t=="undefined"||Bge(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Fi(e,t,r,n,o,a,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=o,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var Ba={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ba[e]=new Fi(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ba[t]=new Fi(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ba[e]=new Fi(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ba[e]=new Fi(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ba[e]=new Fi(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ba[e]=new Fi(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ba[e]=new Fi(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ba[e]=new Fi(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ba[e]=new Fi(e,5,!1,e.toLowerCase(),null,!1,!1)});var KM=/[\-:]([a-z])/g;function JM(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(KM,JM);Ba[t]=new Fi(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(KM,JM);Ba[t]=new Fi(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(KM,JM);Ba[t]=new Fi(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ba[e]=new Fi(e,1,!1,e.toLowerCase(),null,!1,!1)});Ba.xlinkHref=new Fi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ba[e]=new Fi(e,1,!1,e.toLowerCase(),null,!0,!0)});function XM(e,t,r,n){var o=Ba.hasOwnProperty(t)?Ba[t]:null;(o!==null?o.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&($ge(t,r,o,n)&&(r=null),n||o===null?_ge(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):o.mustUseProperty?e[o.propertyName]=r===null?o.type===3?!1:"":r:(t=o.attributeName,n=o.attributeNamespace,r===null?e.removeAttribute(t):(o=o.type,r=o===3||o===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var wu=jge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,oT=Symbol.for("react.element"),Lh=Symbol.for("react.portal"),Nh=Symbol.for("react.fragment"),QM=Symbol.for("react.strict_mode"),oM=Symbol.for("react.profiler"),oU=Symbol.for("react.provider"),aU=Symbol.for("react.context"),ZM=Symbol.for("react.forward_ref"),aM=Symbol.for("react.suspense"),iM=Symbol.for("react.suspense_list"),eF=Symbol.for("react.memo"),Tp=Symbol.for("react.lazy");Symbol.for("react.scope");Symbol.for("react.debug_trace_mode");var iU=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden");Symbol.for("react.cache");Symbol.for("react.tracing_marker");var Z6=Symbol.iterator;function hx(e){return e===null||typeof e!="object"?null:(e=Z6&&e[Z6]||e["@@iterator"],typeof e=="function"?e:null)}var Yn=Object.assign,ON;function Tx(e){if(ON===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);ON=t&&t[1]||""}return`
`+ON+e}var jN=!1;function zN(e,t){if(!e||jN)return"";jN=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var o=c.stack.split(`
`),a=n.stack.split(`
`),i=o.length-1,s=a.length-1;1<=i&&0<=s&&o[i]!==a[s];)s--;for(;1<=i&&0<=s;i--,s--)if(o[i]!==a[s]){if(i!==1||s!==1)do if(i--,s--,0>s||o[i]!==a[s]){var l=`
`+o[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=s);break}}}finally{jN=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Tx(e):""}function Wge(e){switch(e.tag){case 5:return Tx(e.type);case 16:return Tx("Lazy");case 13:return Tx("Suspense");case 19:return Tx("SuspenseList");case 0:case 2:case 15:return e=zN(e.type,!1),e;case 11:return e=zN(e.type.render,!1),e;case 1:return e=zN(e.type,!0),e;default:return""}}function sM(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Nh:return"Fragment";case Lh:return"Portal";case oM:return"Profiler";case QM:return"StrictMode";case aM:return"Suspense";case iM:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case aU:return(e.displayName||"Context")+".Consumer";case oU:return(e._context.displayName||"Context")+".Provider";case ZM:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case eF:return t=e.displayName||null,t!==null?t:sM(e.type)||"Memo";case Tp:t=e._payload,e=e._init;try{return sM(e(t))}catch(r){}}return null}function Rge(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return sM(t);case 8:return t===QM?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function _p(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function sU(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Uge(e){var t=sU(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r!="undefined"&&typeof r.get=="function"&&typeof r.set=="function"){var o=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(i){n=""+i,a.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function aT(e){e._valueTracker||(e._valueTracker=Uge(e))}function lU(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=sU(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function MT(e){if(e=e||(typeof document!="undefined"?document:void 0),typeof e=="undefined")return null;try{return e.activeElement||e.body}catch(t){return e.body}}function lM(e,t){var r=t.checked;return Yn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r!=null?r:e._wrapperState.initialChecked})}function e3(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=_p(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function cU(e,t){t=t.checked,t!=null&&XM(e,"checked",t,!1)}function cM(e,t){cU(e,t);var r=_p(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?dM(e,t.type,r):t.hasOwnProperty("defaultValue")&&dM(e,t.type,_p(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function t3(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function dM(e,t,r){(t!=="number"||MT(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Cx=Array.isArray;function Uh(e,t,r,n){if(e=e.options,t){t={};for(var o=0;o<r.length;o++)t["$"+r[o]]=!0;for(r=0;r<e.length;r++)o=t.hasOwnProperty("$"+e[r].value),e[r].selected!==o&&(e[r].selected=o),o&&n&&(e[r].defaultSelected=!0)}else{for(r=""+_p(r),t=null,o=0;o<e.length;o++){if(e[o].value===r){e[o].selected=!0,n&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function uM(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Me(91));return Yn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function r3(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Me(92));if(Cx(r)){if(1<r.length)throw Error(Me(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:_p(r)}}function dU(e,t){var r=_p(t.value),n=_p(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function n3(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function uU(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pM(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?uU(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var iT,pU=(function(e){return typeof MSApp!="undefined"&&MSApp.execUnsafeLocalFunction?function(t,r,n,o){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,o)})}:e})(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(iT=iT||document.createElement("div"),iT.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=iT.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function _x(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Ex={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Vge=["Webkit","ms","Moz","O"];Object.keys(Ex).forEach(function(e){Vge.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ex[t]=Ex[e]})});function mU(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Ex.hasOwnProperty(e)&&Ex[e]?(""+t).trim():t+"px"}function fU(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,o=mU(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,o):e[r]=o}}var Hge=Yn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function mM(e,t){if(t){if(Hge[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Me(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Me(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Me(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Me(62))}}function fM(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gM=null;function tF(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var hM=null,Vh=null,Hh=null;function o3(e){if(e=rw(e)){if(typeof hM!="function")throw Error(Me(280));var t=e.stateNode;t&&(t=sC(t),hM(e.stateNode,e.type,t))}}function gU(e){Vh?Hh?Hh.push(e):Hh=[e]:Vh=e}function hU(){if(Vh){var e=Vh,t=Hh;if(Hh=Vh=null,o3(e),t)for(e=0;e<t.length;e++)o3(t[e])}}function vU(e,t){return e(t)}function yU(){}var _N=!1;function bU(e,t,r){if(_N)return e(t,r);_N=!0;try{return vU(e,t,r)}finally{_N=!1,(Vh!==null||Hh!==null)&&(yU(),hU())}}function Bx(e,t){var r=e.stateNode;if(r===null)return null;var n=sC(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Me(231,t,typeof r));return r}var vM=!1;if(vu)try{Ih={},Object.defineProperty(Ih,"passive",{get:function(){vM=!0}}),window.addEventListener("test",Ih,Ih),window.removeEventListener("test",Ih,Ih)}catch(e){vM=!1}var Ih;function qge(e,t,r,n,o,a,i,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(d){this.onError(d)}}var Ix=!1,FT=null,OT=!1,yM=null,Gge={onError:function(e){Ix=!0,FT=e}};function Yge(e,t,r,n,o,a,i,s,l){Ix=!1,FT=null,qge.apply(Gge,arguments)}function Kge(e,t,r,n,o,a,i,s,l){if(Yge.apply(this,arguments),Ix){if(Ix){var c=FT;Ix=!1,FT=null}else throw Error(Me(198));OT||(OT=!0,yM=c)}}function Pf(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function xU(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function a3(e){if(Pf(e)!==e)throw Error(Me(188))}function Jge(e){var t=e.alternate;if(!t){if(t=Pf(e),t===null)throw Error(Me(188));return t!==e?null:e}for(var r=e,n=t;;){var o=r.return;if(o===null)break;var a=o.alternate;if(a===null){if(n=o.return,n!==null){r=n;continue}break}if(o.child===a.child){for(a=o.child;a;){if(a===r)return a3(o),e;if(a===n)return a3(o),t;a=a.sibling}throw Error(Me(188))}if(r.return!==n.return)r=o,n=a;else{for(var i=!1,s=o.child;s;){if(s===r){i=!0,r=o,n=a;break}if(s===n){i=!0,n=o,r=a;break}s=s.sibling}if(!i){for(s=a.child;s;){if(s===r){i=!0,r=a,n=o;break}if(s===n){i=!0,n=a,r=o;break}s=s.sibling}if(!i)throw Error(Me(189))}}if(r.alternate!==n)throw Error(Me(190))}if(r.tag!==3)throw Error(Me(188));return r.stateNode.current===r?e:t}function wU(e){return e=Jge(e),e!==null?kU(e):null}function kU(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=kU(e);if(t!==null)return t;e=e.sibling}return null}var SU=$s.unstable_scheduleCallback,i3=$s.unstable_cancelCallback,Xge=$s.unstable_shouldYield,Qge=$s.unstable_requestPaint,yo=$s.unstable_now,Zge=$s.unstable_getCurrentPriorityLevel,rF=$s.unstable_ImmediatePriority,TU=$s.unstable_UserBlockingPriority,jT=$s.unstable_NormalPriority,ehe=$s.unstable_LowPriority,CU=$s.unstable_IdlePriority,nC=null,ud=null;function the(e){if(ud&&typeof ud.onCommitFiberRoot=="function")try{ud.onCommitFiberRoot(nC,e,void 0,(e.current.flags&128)===128)}catch(t){}}var fc=Math.clz32?Math.clz32:ohe,rhe=Math.log,nhe=Math.LN2;function ohe(e){return e>>>=0,e===0?32:31-(rhe(e)/nhe|0)|0}var sT=64,lT=4194304;function Px(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function zT(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,o=e.suspendedLanes,a=e.pingedLanes,i=r&268435455;if(i!==0){var s=i&~o;s!==0?n=Px(s):(a&=i,a!==0&&(n=Px(a)))}else i=r&~o,i!==0?n=Px(i):a!==0&&(n=Px(a));if(n===0)return 0;if(t!==0&&t!==n&&(t&o)===0&&(o=n&-n,a=t&-t,o>=a||o===16&&(a&4194240)!==0))return t;if((n&4)!==0&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-fc(t),o=1<<r,n|=e[r],t&=~o;return n}function ahe(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ihe(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,o=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-fc(a),s=1<<i,l=o[i];l===-1?((s&r)===0||(s&n)!==0)&&(o[i]=ahe(s,t)):l<=t&&(e.expiredLanes|=s),a&=~s}}function bM(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function PU(){var e=sT;return sT<<=1,(sT&4194240)===0&&(sT=64),e}function BN(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function ew(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-fc(t),e[t]=r}function she(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var o=31-fc(r),a=1<<o;t[o]=0,n[o]=-1,e[o]=-1,r&=~a}}function nF(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-fc(r),o=1<<n;o&t|e[n]&t&&(e[n]|=t),r&=~o}}var Gr=0;function DU(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var EU,oF,IU,AU,LU,xM=!1,cT=[],Ap=null,Lp=null,Np=null,$x=new Map,Wx=new Map,Pp=[],lhe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function s3(e,t){switch(e){case"focusin":case"focusout":Ap=null;break;case"dragenter":case"dragleave":Lp=null;break;case"mouseover":case"mouseout":Np=null;break;case"pointerover":case"pointerout":$x.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Wx.delete(t.pointerId)}}function vx(e,t,r,n,o,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[o]},t!==null&&(t=rw(t),t!==null&&oF(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function che(e,t,r,n,o){switch(t){case"focusin":return Ap=vx(Ap,e,t,r,n,o),!0;case"dragenter":return Lp=vx(Lp,e,t,r,n,o),!0;case"mouseover":return Np=vx(Np,e,t,r,n,o),!0;case"pointerover":var a=o.pointerId;return $x.set(a,vx($x.get(a)||null,e,t,r,n,o)),!0;case"gotpointercapture":return a=o.pointerId,Wx.set(a,vx(Wx.get(a)||null,e,t,r,n,o)),!0}return!1}function NU(e){var t=gf(e.target);if(t!==null){var r=Pf(t);if(r!==null){if(t=r.tag,t===13){if(t=xU(r),t!==null){e.blockedOn=t,LU(e.priority,function(){IU(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ST(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=wM(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);gM=n,r.target.dispatchEvent(n),gM=null}else return t=rw(r),t!==null&&oF(t),e.blockedOn=r,!1;t.shift()}return!0}function l3(e,t,r){ST(e)&&r.delete(t)}function dhe(){xM=!1,Ap!==null&&ST(Ap)&&(Ap=null),Lp!==null&&ST(Lp)&&(Lp=null),Np!==null&&ST(Np)&&(Np=null),$x.forEach(l3),Wx.forEach(l3)}function yx(e,t){e.blockedOn===t&&(e.blockedOn=null,xM||(xM=!0,$s.unstable_scheduleCallback($s.unstable_NormalPriority,dhe)))}function Rx(e){function t(o){return yx(o,e)}if(0<cT.length){yx(cT[0],e);for(var r=1;r<cT.length;r++){var n=cT[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Ap!==null&&yx(Ap,e),Lp!==null&&yx(Lp,e),Np!==null&&yx(Np,e),$x.forEach(t),Wx.forEach(t),r=0;r<Pp.length;r++)n=Pp[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Pp.length&&(r=Pp[0],r.blockedOn===null);)NU(r),r.blockedOn===null&&Pp.shift()}var qh=wu.ReactCurrentBatchConfig,_T=!0;function uhe(e,t,r,n){var o=Gr,a=qh.transition;qh.transition=null;try{Gr=1,aF(e,t,r,n)}finally{Gr=o,qh.transition=a}}function phe(e,t,r,n){var o=Gr,a=qh.transition;qh.transition=null;try{Gr=4,aF(e,t,r,n)}finally{Gr=o,qh.transition=a}}function aF(e,t,r,n){if(_T){var o=wM(e,t,r,n);if(o===null)qN(e,t,n,BT,r),s3(e,n);else if(che(o,e,t,r,n))n.stopPropagation();else if(s3(e,n),t&4&&-1<lhe.indexOf(e)){for(;o!==null;){var a=rw(o);if(a!==null&&EU(a),a=wM(e,t,r,n),a===null&&qN(e,t,n,BT,r),a===o)break;o=a}o!==null&&n.stopPropagation()}else qN(e,t,n,null,r)}}var BT=null;function wM(e,t,r,n){if(BT=null,e=tF(n),e=gf(e),e!==null)if(t=Pf(e),t===null)e=null;else if(r=t.tag,r===13){if(e=xU(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return BT=e,null}function MU(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Zge()){case rF:return 1;case TU:return 4;case jT:case ehe:return 16;case CU:return 536870912;default:return 16}default:return 16}}var Ep=null,iF=null,TT=null;function FU(){if(TT)return TT;var e,t=iF,r=t.length,n,o="value"in Ep?Ep.value:Ep.textContent,a=o.length;for(e=0;e<r&&t[e]===o[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===o[a-n];n++);return TT=o.slice(e,1<n?1-n:void 0)}function CT(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function dT(){return!0}function c3(){return!1}function Ws(e){function t(r,n,o,a,i){this._reactName=r,this._targetInst=o,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var s in e)e.hasOwnProperty(s)&&(r=e[s],this[s]=r?r(a):a[s]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?dT:c3,this.isPropagationStopped=c3,this}return Yn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=dT)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=dT)},persist:function(){},isPersistent:dT}),t}var rv={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sF=Ws(rv),tw=Yn({},rv,{view:0,detail:0}),mhe=Ws(tw),$N,WN,bx,oC=Yn({},tw,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lF,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==bx&&(bx&&e.type==="mousemove"?($N=e.screenX-bx.screenX,WN=e.screenY-bx.screenY):WN=$N=0,bx=e),$N)},movementY:function(e){return"movementY"in e?e.movementY:WN}}),d3=Ws(oC),fhe=Yn({},oC,{dataTransfer:0}),ghe=Ws(fhe),hhe=Yn({},tw,{relatedTarget:0}),RN=Ws(hhe),vhe=Yn({},rv,{animationName:0,elapsedTime:0,pseudoElement:0}),yhe=Ws(vhe),bhe=Yn({},rv,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),xhe=Ws(bhe),whe=Yn({},rv,{data:0}),u3=Ws(whe),khe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},She={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},The={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Che(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=The[e])?!!t[e]:!1}function lF(){return Che}var Phe=Yn({},tw,{key:function(e){if(e.key){var t=khe[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=CT(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?She[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lF,charCode:function(e){return e.type==="keypress"?CT(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?CT(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Dhe=Ws(Phe),Ehe=Yn({},oC,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),p3=Ws(Ehe),Ihe=Yn({},tw,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lF}),Ahe=Ws(Ihe),Lhe=Yn({},rv,{propertyName:0,elapsedTime:0,pseudoElement:0}),Nhe=Ws(Lhe),Mhe=Yn({},oC,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Fhe=Ws(Mhe),Ohe=[9,13,27,32],cF=vu&&"CompositionEvent"in window,Ax=null;vu&&"documentMode"in document&&(Ax=document.documentMode);var jhe=vu&&"TextEvent"in window&&!Ax,OU=vu&&(!cF||Ax&&8<Ax&&11>=Ax),m3=" ",f3=!1;function jU(e,t){switch(e){case"keyup":return Ohe.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zU(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Mh=!1;function zhe(e,t){switch(e){case"compositionend":return zU(t);case"keypress":return t.which!==32?null:(f3=!0,m3);case"textInput":return e=t.data,e===m3&&f3?null:e;default:return null}}function _he(e,t){if(Mh)return e==="compositionend"||!cF&&jU(e,t)?(e=FU(),TT=iF=Ep=null,Mh=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return OU&&t.locale!=="ko"?null:t.data;default:return null}}var Bhe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function g3(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Bhe[e.type]:t==="textarea"}function _U(e,t,r,n){gU(n),t=$T(t,"onChange"),0<t.length&&(r=new sF("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Lx=null,Ux=null;function $he(e){KU(e,0)}function aC(e){var t=jh(e);if(lU(t))return e}function Whe(e,t){if(e==="change")return t}var BU=!1;vu&&(vu?(pT="oninput"in document,pT||(UN=document.createElement("div"),UN.setAttribute("oninput","return;"),pT=typeof UN.oninput=="function"),uT=pT):uT=!1,BU=uT&&(!document.documentMode||9<document.documentMode));var uT,pT,UN;function h3(){Lx&&(Lx.detachEvent("onpropertychange",$U),Ux=Lx=null)}function $U(e){if(e.propertyName==="value"&&aC(Ux)){var t=[];_U(t,Ux,e,tF(e)),bU($he,t)}}function Rhe(e,t,r){e==="focusin"?(h3(),Lx=t,Ux=r,Lx.attachEvent("onpropertychange",$U)):e==="focusout"&&h3()}function Uhe(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return aC(Ux)}function Vhe(e,t){if(e==="click")return aC(t)}function Hhe(e,t){if(e==="input"||e==="change")return aC(t)}function qhe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var hc=typeof Object.is=="function"?Object.is:qhe;function Vx(e,t){if(hc(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var o=r[n];if(!nM.call(t,o)||!hc(e[o],t[o]))return!1}return!0}function v3(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function y3(e,t){var r=v3(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=v3(r)}}function WU(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?WU(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function RU(){for(var e=window,t=MT();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch(n){r=!1}if(r)e=t.contentWindow;else break;t=MT(e.document)}return t}function dF(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Ghe(e){var t=RU(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&WU(r.ownerDocument.documentElement,r)){if(n!==null&&dF(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=r.textContent.length,a=Math.min(n.start,o);n=n.end===void 0?a:Math.min(n.end,o),!e.extend&&a>n&&(o=n,n=a,a=o),o=y3(r,a);var i=y3(r,n);o&&i&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Yhe=vu&&"documentMode"in document&&11>=document.documentMode,Fh=null,kM=null,Nx=null,SM=!1;function b3(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;SM||Fh==null||Fh!==MT(n)||(n=Fh,"selectionStart"in n&&dF(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Nx&&Vx(Nx,n)||(Nx=n,n=$T(kM,"onSelect"),0<n.length&&(t=new sF("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Fh)))}function mT(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Oh={animationend:mT("Animation","AnimationEnd"),animationiteration:mT("Animation","AnimationIteration"),animationstart:mT("Animation","AnimationStart"),transitionend:mT("Transition","TransitionEnd")},VN={},UU={};vu&&(UU=document.createElement("div").style,"AnimationEvent"in window||(delete Oh.animationend.animation,delete Oh.animationiteration.animation,delete Oh.animationstart.animation),"TransitionEvent"in window||delete Oh.transitionend.transition);function iC(e){if(VN[e])return VN[e];if(!Oh[e])return e;var t=Oh[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in UU)return VN[e]=t[r];return e}var VU=iC("animationend"),HU=iC("animationiteration"),qU=iC("animationstart"),GU=iC("transitionend"),YU=new Map,x3="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $p(e,t){YU.set(e,t),Cf(t,[e])}for(fT=0;fT<x3.length;fT++)gT=x3[fT],w3=gT.toLowerCase(),k3=gT[0].toUpperCase()+gT.slice(1),$p(w3,"on"+k3);var gT,w3,k3,fT;$p(VU,"onAnimationEnd");$p(HU,"onAnimationIteration");$p(qU,"onAnimationStart");$p("dblclick","onDoubleClick");$p("focusin","onFocus");$p("focusout","onBlur");$p(GU,"onTransitionEnd");Kh("onMouseEnter",["mouseout","mouseover"]);Kh("onMouseLeave",["mouseout","mouseover"]);Kh("onPointerEnter",["pointerout","pointerover"]);Kh("onPointerLeave",["pointerout","pointerover"]);Cf("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Cf("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Cf("onBeforeInput",["compositionend","keypress","textInput","paste"]);Cf("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Cf("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Cf("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dx="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Khe=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dx));function S3(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,Kge(n,t,void 0,e),e.currentTarget=null}function KU(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],o=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var i=n.length-1;0<=i;i--){var s=n[i],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==a&&o.isPropagationStopped())break e;S3(o,s,c),a=l}else for(i=0;i<n.length;i++){if(s=n[i],l=s.instance,c=s.currentTarget,s=s.listener,l!==a&&o.isPropagationStopped())break e;S3(o,s,c),a=l}}}if(OT)throw e=yM,OT=!1,yM=null,e}function bn(e,t){var r=t[EM];r===void 0&&(r=t[EM]=new Set);var n=e+"__bubble";r.has(n)||(JU(t,e,2,!1),r.add(n))}function HN(e,t,r){var n=0;t&&(n|=4),JU(r,e,n,t)}var hT="_reactListening"+Math.random().toString(36).slice(2);function Hx(e){if(!e[hT]){e[hT]=!0,nU.forEach(function(r){r!=="selectionchange"&&(Khe.has(r)||HN(r,!1,e),HN(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[hT]||(t[hT]=!0,HN("selectionchange",!1,t))}}function JU(e,t,r,n){switch(MU(t)){case 1:var o=uhe;break;case 4:o=phe;break;default:o=aF}r=o.bind(null,t,r,e),o=void 0,!vM||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),n?o!==void 0?e.addEventListener(t,r,{capture:!0,passive:o}):e.addEventListener(t,r,!0):o!==void 0?e.addEventListener(t,r,{passive:o}):e.addEventListener(t,r,!1)}function qN(e,t,r,n,o){var a=n;if((t&1)===0&&(t&2)===0&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var s=n.stateNode.containerInfo;if(s===o||s.nodeType===8&&s.parentNode===o)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===o||l.nodeType===8&&l.parentNode===o))return;i=i.return}for(;s!==null;){if(i=gf(s),i===null)return;if(l=i.tag,l===5||l===6){n=a=i;continue e}s=s.parentNode}}n=n.return}bU(function(){var c=a,d=tF(r),u=[];e:{var p=YU.get(e);if(p!==void 0){var m=sF,f=e;switch(e){case"keypress":if(CT(r)===0)break e;case"keydown":case"keyup":m=Dhe;break;case"focusin":f="focus",m=RN;break;case"focusout":f="blur",m=RN;break;case"beforeblur":case"afterblur":m=RN;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=d3;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=ghe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=Ahe;break;case VU:case HU:case qU:m=yhe;break;case GU:m=Nhe;break;case"scroll":m=mhe;break;case"wheel":m=Fhe;break;case"copy":case"cut":case"paste":m=xhe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=p3}var g=(t&4)!==0,v=!g&&e==="scroll",h=g?p!==null?p+"Capture":null:p;g=[];for(var y=c,b;y!==null;){b=y;var x=b.stateNode;if(b.tag===5&&x!==null&&(b=x,h!==null&&(x=Bx(y,h),x!=null&&g.push(qx(y,x,b)))),v)break;y=y.return}0<g.length&&(p=new m(p,f,null,r,d),u.push({event:p,listeners:g}))}}if((t&7)===0){e:{if(p=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",p&&r!==gM&&(f=r.relatedTarget||r.fromElement)&&(gf(f)||f[yu]))break e;if((m||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,m?(f=r.relatedTarget||r.toElement,m=c,f=f?gf(f):null,f!==null&&(v=Pf(f),f!==v||f.tag!==5&&f.tag!==6)&&(f=null)):(m=null,f=c),m!==f)){if(g=d3,x="onMouseLeave",h="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(g=p3,x="onPointerLeave",h="onPointerEnter",y="pointer"),v=m==null?p:jh(m),b=f==null?p:jh(f),p=new g(x,y+"leave",m,r,d),p.target=v,p.relatedTarget=b,x=null,gf(d)===c&&(g=new g(h,y+"enter",f,r,d),g.target=b,g.relatedTarget=v,x=g),v=x,m&&f)t:{for(g=m,h=f,y=0,b=g;b;b=Ah(b))y++;for(b=0,x=h;x;x=Ah(x))b++;for(;0<y-b;)g=Ah(g),y--;for(;0<b-y;)h=Ah(h),b--;for(;y--;){if(g===h||h!==null&&g===h.alternate)break t;g=Ah(g),h=Ah(h)}g=null}else g=null;m!==null&&T3(u,p,m,g,!1),f!==null&&v!==null&&T3(u,v,f,g,!0)}}e:{if(p=c?jh(c):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var w=Whe;else if(g3(p))if(BU)w=Hhe;else{w=Uhe;var S=Rhe}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(w=Vhe);if(w&&(w=w(e,c))){_U(u,w,r,d);break e}S&&S(e,p,c),e==="focusout"&&(S=p._wrapperState)&&S.controlled&&p.type==="number"&&dM(p,"number",p.value)}switch(S=c?jh(c):window,e){case"focusin":(g3(S)||S.contentEditable==="true")&&(Fh=S,kM=c,Nx=null);break;case"focusout":Nx=kM=Fh=null;break;case"mousedown":SM=!0;break;case"contextmenu":case"mouseup":case"dragend":SM=!1,b3(u,r,d);break;case"selectionchange":if(Yhe)break;case"keydown":case"keyup":b3(u,r,d)}var k;if(cF)e:{switch(e){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Mh?jU(e,r)&&(T="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(T="onCompositionStart");T&&(OU&&r.locale!=="ko"&&(Mh||T!=="onCompositionStart"?T==="onCompositionEnd"&&Mh&&(k=FU()):(Ep=d,iF="value"in Ep?Ep.value:Ep.textContent,Mh=!0)),S=$T(c,T),0<S.length&&(T=new u3(T,e,null,r,d),u.push({event:T,listeners:S}),k?T.data=k:(k=zU(r),k!==null&&(T.data=k)))),(k=jhe?zhe(e,r):_he(e,r))&&(c=$T(c,"onBeforeInput"),0<c.length&&(d=new u3("onBeforeInput","beforeinput",null,r,d),u.push({event:d,listeners:c}),d.data=k))}KU(u,t)})}function qx(e,t,r){return{instance:e,listener:t,currentTarget:r}}function $T(e,t){for(var r=t+"Capture",n=[];e!==null;){var o=e,a=o.stateNode;o.tag===5&&a!==null&&(o=a,a=Bx(e,r),a!=null&&n.unshift(qx(e,a,o)),a=Bx(e,t),a!=null&&n.push(qx(e,a,o))),e=e.return}return n}function Ah(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function T3(e,t,r,n,o){for(var a=t._reactName,i=[];r!==null&&r!==n;){var s=r,l=s.alternate,c=s.stateNode;if(l!==null&&l===n)break;s.tag===5&&c!==null&&(s=c,o?(l=Bx(r,a),l!=null&&i.unshift(qx(r,l,s))):o||(l=Bx(r,a),l!=null&&i.push(qx(r,l,s)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var Jhe=/\r\n?/g,Xhe=/\u0000|\uFFFD/g;function C3(e){return(typeof e=="string"?e:""+e).replace(Jhe,`
`).replace(Xhe,"")}function vT(e,t,r){if(t=C3(t),C3(e)!==t&&r)throw Error(Me(425))}function WT(){}var TM=null,CM=null;function PM(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var DM=typeof setTimeout=="function"?setTimeout:void 0,Qhe=typeof clearTimeout=="function"?clearTimeout:void 0,P3=typeof Promise=="function"?Promise:void 0,Zhe=typeof queueMicrotask=="function"?queueMicrotask:typeof P3!="undefined"?function(e){return P3.resolve(null).then(e).catch(eve)}:DM;function eve(e){setTimeout(function(){throw e})}function GN(e,t){var r=t,n=0;do{var o=r.nextSibling;if(e.removeChild(r),o&&o.nodeType===8)if(r=o.data,r==="/$"){if(n===0){e.removeChild(o),Rx(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=o}while(r);Rx(t)}function Mp(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function D3(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var nv=Math.random().toString(36).slice(2),dd="__reactFiber$"+nv,Gx="__reactProps$"+nv,yu="__reactContainer$"+nv,EM="__reactEvents$"+nv,tve="__reactListeners$"+nv,rve="__reactHandles$"+nv;function gf(e){var t=e[dd];if(t)return t;for(var r=e.parentNode;r;){if(t=r[yu]||r[dd]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=D3(e);e!==null;){if(r=e[dd])return r;e=D3(e)}return t}e=r,r=e.parentNode}return null}function rw(e){return e=e[dd]||e[yu],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function jh(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Me(33))}function sC(e){return e[Gx]||null}var IM=[],zh=-1;function Wp(e){return{current:e}}function xn(e){0>zh||(e.current=IM[zh],IM[zh]=null,zh--)}function dn(e,t){zh++,IM[zh]=e.current,e.current=t}var Bp={},ii=Wp(Bp),ns=Wp(!1),xf=Bp;function Jh(e,t){var r=e.type.contextTypes;if(!r)return Bp;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var o={},a;for(a in r)o[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function os(e){return e=e.childContextTypes,e!=null}function RT(){xn(ns),xn(ii)}function E3(e,t,r){if(ii.current!==Bp)throw Error(Me(168));dn(ii,t),dn(ns,r)}function XU(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var o in n)if(!(o in t))throw Error(Me(108,Rge(e)||"Unknown",o));return Yn({},r,n)}function UT(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Bp,xf=ii.current,dn(ii,e),dn(ns,ns.current),!0}function I3(e,t,r){var n=e.stateNode;if(!n)throw Error(Me(169));r?(e=XU(e,t,xf),n.__reactInternalMemoizedMergedChildContext=e,xn(ns),xn(ii),dn(ii,e)):xn(ns),dn(ns,r)}var mu=null,lC=!1,YN=!1;function QU(e){mu===null?mu=[e]:mu.push(e)}function nve(e){lC=!0,QU(e)}function Rp(){if(!YN&&mu!==null){YN=!0;var e=0,t=Gr;try{var r=mu;for(Gr=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}mu=null,lC=!1}catch(o){throw mu!==null&&(mu=mu.slice(e+1)),SU(rF,Rp),o}finally{Gr=t,YN=!1}}return null}var _h=[],Bh=0,VT=null,HT=0,fl=[],gl=0,wf=null,fu=1,gu="";function mf(e,t){_h[Bh++]=HT,_h[Bh++]=VT,VT=e,HT=t}function ZU(e,t,r){fl[gl++]=fu,fl[gl++]=gu,fl[gl++]=wf,wf=e;var n=fu;e=gu;var o=32-fc(n)-1;n&=~(1<<o),r+=1;var a=32-fc(t)+o;if(30<a){var i=o-o%5;a=(n&(1<<i)-1).toString(32),n>>=i,o-=i,fu=1<<32-fc(t)+o|r<<o|n,gu=a+e}else fu=1<<a|r<<o|n,gu=e}function uF(e){e.return!==null&&(mf(e,1),ZU(e,1,0))}function pF(e){for(;e===VT;)VT=_h[--Bh],_h[Bh]=null,HT=_h[--Bh],_h[Bh]=null;for(;e===wf;)wf=fl[--gl],fl[gl]=null,gu=fl[--gl],fl[gl]=null,fu=fl[--gl],fl[gl]=null}var Bs=null,_s=null,Dn=!1,mc=null;function e8(e,t){var r=hl(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function A3(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Bs=e,_s=Mp(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Bs=e,_s=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=wf!==null?{id:fu,overflow:gu}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=hl(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Bs=e,_s=null,!0):!1;default:return!1}}function AM(e){return(e.mode&1)!==0&&(e.flags&128)===0}function LM(e){if(Dn){var t=_s;if(t){var r=t;if(!A3(e,t)){if(AM(e))throw Error(Me(418));t=Mp(r.nextSibling);var n=Bs;t&&A3(e,t)?e8(n,r):(e.flags=e.flags&-4097|2,Dn=!1,Bs=e)}}else{if(AM(e))throw Error(Me(418));e.flags=e.flags&-4097|2,Dn=!1,Bs=e}}}function L3(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Bs=e}function yT(e){if(e!==Bs)return!1;if(!Dn)return L3(e),Dn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!PM(e.type,e.memoizedProps)),t&&(t=_s)){if(AM(e))throw t8(),Error(Me(418));for(;t;)e8(e,t),t=Mp(t.nextSibling)}if(L3(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Me(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){_s=Mp(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}_s=null}}else _s=Bs?Mp(e.stateNode.nextSibling):null;return!0}function t8(){for(var e=_s;e;)e=Mp(e.nextSibling)}function Xh(){_s=Bs=null,Dn=!1}function mF(e){mc===null?mc=[e]:mc.push(e)}var ove=wu.ReactCurrentBatchConfig;function xx(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Me(309));var n=r.stateNode}if(!n)throw Error(Me(147,e));var o=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(i){var s=o.refs;i===null?delete s[a]:s[a]=i},t._stringRef=a,t)}if(typeof e!="string")throw Error(Me(284));if(!r._owner)throw Error(Me(290,e))}return e}function bT(e,t){throw e=Object.prototype.toString.call(t),Error(Me(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function N3(e){var t=e._init;return t(e._payload)}function r8(e){function t(h,y){if(e){var b=h.deletions;b===null?(h.deletions=[y],h.flags|=16):b.push(y)}}function r(h,y){if(!e)return null;for(;y!==null;)t(h,y),y=y.sibling;return null}function n(h,y){for(h=new Map;y!==null;)y.key!==null?h.set(y.key,y):h.set(y.index,y),y=y.sibling;return h}function o(h,y){return h=zp(h,y),h.index=0,h.sibling=null,h}function a(h,y,b){return h.index=b,e?(b=h.alternate,b!==null?(b=b.index,b<y?(h.flags|=2,y):b):(h.flags|=2,y)):(h.flags|=1048576,y)}function i(h){return e&&h.alternate===null&&(h.flags|=2),h}function s(h,y,b,x){return y===null||y.tag!==6?(y=tM(b,h.mode,x),y.return=h,y):(y=o(y,b),y.return=h,y)}function l(h,y,b,x){var w=b.type;return w===Nh?d(h,y,b.props.children,x,b.key):y!==null&&(y.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Tp&&N3(w)===y.type)?(x=o(y,b.props),x.ref=xx(h,y,b),x.return=h,x):(x=NT(b.type,b.key,b.props,null,h.mode,x),x.ref=xx(h,y,b),x.return=h,x)}function c(h,y,b,x){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=rM(b,h.mode,x),y.return=h,y):(y=o(y,b.children||[]),y.return=h,y)}function d(h,y,b,x,w){return y===null||y.tag!==7?(y=bf(b,h.mode,x,w),y.return=h,y):(y=o(y,b),y.return=h,y)}function u(h,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=tM(""+y,h.mode,b),y.return=h,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case oT:return b=NT(y.type,y.key,y.props,null,h.mode,b),b.ref=xx(h,null,y),b.return=h,b;case Lh:return y=rM(y,h.mode,b),y.return=h,y;case Tp:var x=y._init;return u(h,x(y._payload),b)}if(Cx(y)||hx(y))return y=bf(y,h.mode,b,null),y.return=h,y;bT(h,y)}return null}function p(h,y,b,x){var w=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return w!==null?null:s(h,y,""+b,x);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case oT:return b.key===w?l(h,y,b,x):null;case Lh:return b.key===w?c(h,y,b,x):null;case Tp:return w=b._init,p(h,y,w(b._payload),x)}if(Cx(b)||hx(b))return w!==null?null:d(h,y,b,x,null);bT(h,b)}return null}function m(h,y,b,x,w){if(typeof x=="string"&&x!==""||typeof x=="number")return h=h.get(b)||null,s(y,h,""+x,w);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case oT:return h=h.get(x.key===null?b:x.key)||null,l(y,h,x,w);case Lh:return h=h.get(x.key===null?b:x.key)||null,c(y,h,x,w);case Tp:var S=x._init;return m(h,y,b,S(x._payload),w)}if(Cx(x)||hx(x))return h=h.get(b)||null,d(y,h,x,w,null);bT(y,x)}return null}function f(h,y,b,x){for(var w=null,S=null,k=y,T=y=0,P=null;k!==null&&T<b.length;T++){k.index>T?(P=k,k=null):P=k.sibling;var D=p(h,k,b[T],x);if(D===null){k===null&&(k=P);break}e&&k&&D.alternate===null&&t(h,k),y=a(D,y,T),S===null?w=D:S.sibling=D,S=D,k=P}if(T===b.length)return r(h,k),Dn&&mf(h,T),w;if(k===null){for(;T<b.length;T++)k=u(h,b[T],x),k!==null&&(y=a(k,y,T),S===null?w=k:S.sibling=k,S=k);return Dn&&mf(h,T),w}for(k=n(h,k);T<b.length;T++)P=m(k,h,T,b[T],x),P!==null&&(e&&P.alternate!==null&&k.delete(P.key===null?T:P.key),y=a(P,y,T),S===null?w=P:S.sibling=P,S=P);return e&&k.forEach(function(O){return t(h,O)}),Dn&&mf(h,T),w}function g(h,y,b,x){var w=hx(b);if(typeof w!="function")throw Error(Me(150));if(b=w.call(b),b==null)throw Error(Me(151));for(var S=w=null,k=y,T=y=0,P=null,D=b.next();k!==null&&!D.done;T++,D=b.next()){k.index>T?(P=k,k=null):P=k.sibling;var O=p(h,k,D.value,x);if(O===null){k===null&&(k=P);break}e&&k&&O.alternate===null&&t(h,k),y=a(O,y,T),S===null?w=O:S.sibling=O,S=O,k=P}if(D.done)return r(h,k),Dn&&mf(h,T),w;if(k===null){for(;!D.done;T++,D=b.next())D=u(h,D.value,x),D!==null&&(y=a(D,y,T),S===null?w=D:S.sibling=D,S=D);return Dn&&mf(h,T),w}for(k=n(h,k);!D.done;T++,D=b.next())D=m(k,h,T,D.value,x),D!==null&&(e&&D.alternate!==null&&k.delete(D.key===null?T:D.key),y=a(D,y,T),S===null?w=D:S.sibling=D,S=D);return e&&k.forEach(function(z){return t(h,z)}),Dn&&mf(h,T),w}function v(h,y,b,x){if(typeof b=="object"&&b!==null&&b.type===Nh&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case oT:e:{for(var w=b.key,S=y;S!==null;){if(S.key===w){if(w=b.type,w===Nh){if(S.tag===7){r(h,S.sibling),y=o(S,b.props.children),y.return=h,h=y;break e}}else if(S.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===Tp&&N3(w)===S.type){r(h,S.sibling),y=o(S,b.props),y.ref=xx(h,S,b),y.return=h,h=y;break e}r(h,S);break}else t(h,S);S=S.sibling}b.type===Nh?(y=bf(b.props.children,h.mode,x,b.key),y.return=h,h=y):(x=NT(b.type,b.key,b.props,null,h.mode,x),x.ref=xx(h,y,b),x.return=h,h=x)}return i(h);case Lh:e:{for(S=b.key;y!==null;){if(y.key===S)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){r(h,y.sibling),y=o(y,b.children||[]),y.return=h,h=y;break e}else{r(h,y);break}else t(h,y);y=y.sibling}y=rM(b,h.mode,x),y.return=h,h=y}return i(h);case Tp:return S=b._init,v(h,y,S(b._payload),x)}if(Cx(b))return f(h,y,b,x);if(hx(b))return g(h,y,b,x);bT(h,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(r(h,y.sibling),y=o(y,b),y.return=h,h=y):(r(h,y),y=tM(b,h.mode,x),y.return=h,h=y),i(h)):r(h,y)}return v}var Qh=r8(!0),n8=r8(!1),qT=Wp(null),GT=null,$h=null,fF=null;function gF(){fF=$h=GT=null}function hF(e){var t=qT.current;xn(qT),e._currentValue=t}function NM(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Gh(e,t){GT=e,fF=$h=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(rs=!0),e.firstContext=null)}function yl(e){var t=e._currentValue;if(fF!==e)if(e={context:e,memoizedValue:t,next:null},$h===null){if(GT===null)throw Error(Me(308));$h=e,GT.dependencies={lanes:0,firstContext:e}}else $h=$h.next=e;return t}var hf=null;function vF(e){hf===null?hf=[e]:hf.push(e)}function o8(e,t,r,n){var o=t.interleaved;return o===null?(r.next=r,vF(t)):(r.next=o.next,o.next=r),t.interleaved=r,bu(e,n)}function bu(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Cp=!1;function yF(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function a8(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function hu(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Fp(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,(vr&2)!==0){var o=n.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),n.pending=t,bu(e,r)}return o=n.interleaved,o===null?(t.next=t,vF(n)):(t.next=o.next,o.next=t),n.interleaved=t,bu(e,r)}function PT(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,nF(e,r)}}function M3(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var o=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?o=a=i:a=a.next=i,r=r.next}while(r!==null);a===null?o=a=t:a=a.next=t}else o=a=t;r={baseState:n.baseState,firstBaseUpdate:o,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function YT(e,t,r,n){var o=e.updateQueue;Cp=!1;var a=o.firstBaseUpdate,i=o.lastBaseUpdate,s=o.shared.pending;if(s!==null){o.shared.pending=null;var l=s,c=l.next;l.next=null,i===null?a=c:i.next=c,i=l;var d=e.alternate;d!==null&&(d=d.updateQueue,s=d.lastBaseUpdate,s!==i&&(s===null?d.firstBaseUpdate=c:s.next=c,d.lastBaseUpdate=l))}if(a!==null){var u=o.baseState;i=0,d=c=l=null,s=a;do{var p=s.lane,m=s.eventTime;if((n&p)===p){d!==null&&(d=d.next={eventTime:m,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var f=e,g=s;switch(p=t,m=r,g.tag){case 1:if(f=g.payload,typeof f=="function"){u=f.call(m,u,p);break e}u=f;break e;case 3:f.flags=f.flags&-65537|128;case 0:if(f=g.payload,p=typeof f=="function"?f.call(m,u,p):f,p==null)break e;u=Yn({},u,p);break e;case 2:Cp=!0}}s.callback!==null&&s.lane!==0&&(e.flags|=64,p=o.effects,p===null?o.effects=[s]:p.push(s))}else m={eventTime:m,lane:p,tag:s.tag,payload:s.payload,callback:s.callback,next:null},d===null?(c=d=m,l=u):d=d.next=m,i|=p;if(s=s.next,s===null){if(s=o.shared.pending,s===null)break;p=s,s=p.next,p.next=null,o.lastBaseUpdate=p,o.shared.pending=null}}while(!0);if(d===null&&(l=u),o.baseState=l,o.firstBaseUpdate=c,o.lastBaseUpdate=d,t=o.shared.interleaved,t!==null){o=t;do i|=o.lane,o=o.next;while(o!==t)}else a===null&&(o.shared.lanes=0);Sf|=i,e.lanes=i,e.memoizedState=u}}function F3(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],o=n.callback;if(o!==null){if(n.callback=null,n=r,typeof o!="function")throw Error(Me(191,o));o.call(n)}}}var nw={},pd=Wp(nw),Yx=Wp(nw),Kx=Wp(nw);function vf(e){if(e===nw)throw Error(Me(174));return e}function bF(e,t){switch(dn(Kx,t),dn(Yx,e),dn(pd,nw),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:pM(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=pM(t,e)}xn(pd),dn(pd,t)}function Zh(){xn(pd),xn(Yx),xn(Kx)}function i8(e){vf(Kx.current);var t=vf(pd.current),r=pM(t,e.type);t!==r&&(dn(Yx,e),dn(pd,r))}function xF(e){Yx.current===e&&(xn(pd),xn(Yx))}var qn=Wp(0);function KT(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var KN=[];function wF(){for(var e=0;e<KN.length;e++)KN[e]._workInProgressVersionPrimary=null;KN.length=0}var DT=wu.ReactCurrentDispatcher,JN=wu.ReactCurrentBatchConfig,kf=0,Gn=null,Jo=null,ma=null,JT=!1,Mx=!1,Jx=0,ave=0;function ni(){throw Error(Me(321))}function kF(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!hc(e[r],t[r]))return!1;return!0}function SF(e,t,r,n,o,a){if(kf=a,Gn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,DT.current=e===null||e.memoizedState===null?cve:dve,e=r(n,o),Mx){a=0;do{if(Mx=!1,Jx=0,25<=a)throw Error(Me(301));a+=1,ma=Jo=null,t.updateQueue=null,DT.current=uve,e=r(n,o)}while(Mx)}if(DT.current=XT,t=Jo!==null&&Jo.next!==null,kf=0,ma=Jo=Gn=null,JT=!1,t)throw Error(Me(300));return e}function TF(){var e=Jx!==0;return Jx=0,e}function cd(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ma===null?Gn.memoizedState=ma=e:ma=ma.next=e,ma}function bl(){if(Jo===null){var e=Gn.alternate;e=e!==null?e.memoizedState:null}else e=Jo.next;var t=ma===null?Gn.memoizedState:ma.next;if(t!==null)ma=t,Jo=e;else{if(e===null)throw Error(Me(310));Jo=e,e={memoizedState:Jo.memoizedState,baseState:Jo.baseState,baseQueue:Jo.baseQueue,queue:Jo.queue,next:null},ma===null?Gn.memoizedState=ma=e:ma=ma.next=e}return ma}function Xx(e,t){return typeof t=="function"?t(e):t}function XN(e){var t=bl(),r=t.queue;if(r===null)throw Error(Me(311));r.lastRenderedReducer=e;var n=Jo,o=n.baseQueue,a=r.pending;if(a!==null){if(o!==null){var i=o.next;o.next=a.next,a.next=i}n.baseQueue=o=a,r.pending=null}if(o!==null){a=o.next,n=n.baseState;var s=i=null,l=null,c=a;do{var d=c.lane;if((kf&d)===d)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var u={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(s=l=u,i=n):l=l.next=u,Gn.lanes|=d,Sf|=d}c=c.next}while(c!==null&&c!==a);l===null?i=n:l.next=s,hc(n,t.memoizedState)||(rs=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){o=e;do a=o.lane,Gn.lanes|=a,Sf|=a,o=o.next;while(o!==e)}else o===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function QN(e){var t=bl(),r=t.queue;if(r===null)throw Error(Me(311));r.lastRenderedReducer=e;var n=r.dispatch,o=r.pending,a=t.memoizedState;if(o!==null){r.pending=null;var i=o=o.next;do a=e(a,i.action),i=i.next;while(i!==o);hc(a,t.memoizedState)||(rs=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function s8(){}function l8(e,t){var r=Gn,n=bl(),o=t(),a=!hc(n.memoizedState,o);if(a&&(n.memoizedState=o,rs=!0),n=n.queue,CF(u8.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||ma!==null&&ma.memoizedState.tag&1){if(r.flags|=2048,Qx(9,d8.bind(null,r,n,o,t),void 0,null),fa===null)throw Error(Me(349));(kf&30)!==0||c8(r,t,o)}return o}function c8(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Gn.updateQueue,t===null?(t={lastEffect:null,stores:null},Gn.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function d8(e,t,r,n){t.value=r,t.getSnapshot=n,p8(t)&&m8(e)}function u8(e,t,r){return r(function(){p8(t)&&m8(e)})}function p8(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!hc(e,r)}catch(n){return!0}}function m8(e){var t=bu(e,1);t!==null&&gc(t,e,1,-1)}function O3(e){var t=cd();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Xx,lastRenderedState:e},t.queue=e,e=e.dispatch=lve.bind(null,Gn,e),[t.memoizedState,e]}function Qx(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Gn.updateQueue,t===null?(t={lastEffect:null,stores:null},Gn.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function f8(){return bl().memoizedState}function ET(e,t,r,n){var o=cd();Gn.flags|=e,o.memoizedState=Qx(1|t,r,void 0,n===void 0?null:n)}function cC(e,t,r,n){var o=bl();n=n===void 0?null:n;var a=void 0;if(Jo!==null){var i=Jo.memoizedState;if(a=i.destroy,n!==null&&kF(n,i.deps)){o.memoizedState=Qx(t,r,a,n);return}}Gn.flags|=e,o.memoizedState=Qx(1|t,r,a,n)}function j3(e,t){return ET(8390656,8,e,t)}function CF(e,t){return cC(2048,8,e,t)}function g8(e,t){return cC(4,2,e,t)}function h8(e,t){return cC(4,4,e,t)}function v8(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function y8(e,t,r){return r=r!=null?r.concat([e]):null,cC(4,4,v8.bind(null,t,e),r)}function PF(){}function b8(e,t){var r=bl();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&kF(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function x8(e,t){var r=bl();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&kF(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function w8(e,t,r){return(kf&21)===0?(e.baseState&&(e.baseState=!1,rs=!0),e.memoizedState=r):(hc(r,t)||(r=PU(),Gn.lanes|=r,Sf|=r,e.baseState=!0),t)}function ive(e,t){var r=Gr;Gr=r!==0&&4>r?r:4,e(!0);var n=JN.transition;JN.transition={};try{e(!1),t()}finally{Gr=r,JN.transition=n}}function k8(){return bl().memoizedState}function sve(e,t,r){var n=jp(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},S8(e))T8(t,r);else if(r=o8(e,t,r,n),r!==null){var o=Mi();gc(r,e,n,o),C8(r,t,n)}}function lve(e,t,r){var n=jp(e),o={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(S8(e))T8(t,o);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var i=t.lastRenderedState,s=a(i,r);if(o.hasEagerState=!0,o.eagerState=s,hc(s,i)){var l=t.interleaved;l===null?(o.next=o,vF(t)):(o.next=l.next,l.next=o),t.interleaved=o;return}}catch(c){}finally{}r=o8(e,t,o,n),r!==null&&(o=Mi(),gc(r,e,n,o),C8(r,t,n))}}function S8(e){var t=e.alternate;return e===Gn||t!==null&&t===Gn}function T8(e,t){Mx=JT=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function C8(e,t,r){if((r&4194240)!==0){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,nF(e,r)}}var XT={readContext:yl,useCallback:ni,useContext:ni,useEffect:ni,useImperativeHandle:ni,useInsertionEffect:ni,useLayoutEffect:ni,useMemo:ni,useReducer:ni,useRef:ni,useState:ni,useDebugValue:ni,useDeferredValue:ni,useTransition:ni,useMutableSource:ni,useSyncExternalStore:ni,useId:ni,unstable_isNewReconciler:!1},cve={readContext:yl,useCallback:function(e,t){return cd().memoizedState=[e,t===void 0?null:t],e},useContext:yl,useEffect:j3,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,ET(4194308,4,v8.bind(null,t,e),r)},useLayoutEffect:function(e,t){return ET(4194308,4,e,t)},useInsertionEffect:function(e,t){return ET(4,2,e,t)},useMemo:function(e,t){var r=cd();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=cd();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=sve.bind(null,Gn,e),[n.memoizedState,e]},useRef:function(e){var t=cd();return e={current:e},t.memoizedState=e},useState:O3,useDebugValue:PF,useDeferredValue:function(e){return cd().memoizedState=e},useTransition:function(){var e=O3(!1),t=e[0];return e=ive.bind(null,e[1]),cd().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Gn,o=cd();if(Dn){if(r===void 0)throw Error(Me(407));r=r()}else{if(r=t(),fa===null)throw Error(Me(349));(kf&30)!==0||c8(n,t,r)}o.memoizedState=r;var a={value:r,getSnapshot:t};return o.queue=a,j3(u8.bind(null,n,a,e),[e]),n.flags|=2048,Qx(9,d8.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=cd(),t=fa.identifierPrefix;if(Dn){var r=gu,n=fu;r=(n&~(1<<32-fc(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Jx++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=ave++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},dve={readContext:yl,useCallback:b8,useContext:yl,useEffect:CF,useImperativeHandle:y8,useInsertionEffect:g8,useLayoutEffect:h8,useMemo:x8,useReducer:XN,useRef:f8,useState:function(){return XN(Xx)},useDebugValue:PF,useDeferredValue:function(e){var t=bl();return w8(t,Jo.memoizedState,e)},useTransition:function(){var e=XN(Xx)[0],t=bl().memoizedState;return[e,t]},useMutableSource:s8,useSyncExternalStore:l8,useId:k8,unstable_isNewReconciler:!1},uve={readContext:yl,useCallback:b8,useContext:yl,useEffect:CF,useImperativeHandle:y8,useInsertionEffect:g8,useLayoutEffect:h8,useMemo:x8,useReducer:QN,useRef:f8,useState:function(){return QN(Xx)},useDebugValue:PF,useDeferredValue:function(e){var t=bl();return Jo===null?t.memoizedState=e:w8(t,Jo.memoizedState,e)},useTransition:function(){var e=QN(Xx)[0],t=bl().memoizedState;return[e,t]},useMutableSource:s8,useSyncExternalStore:l8,useId:k8,unstable_isNewReconciler:!1};function uc(e,t){if(e&&e.defaultProps){t=Yn({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function MM(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Yn({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var dC={isMounted:function(e){return(e=e._reactInternals)?Pf(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Mi(),o=jp(e),a=hu(n,o);a.payload=t,r!=null&&(a.callback=r),t=Fp(e,a,o),t!==null&&(gc(t,e,o,n),PT(t,e,o))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Mi(),o=jp(e),a=hu(n,o);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=Fp(e,a,o),t!==null&&(gc(t,e,o,n),PT(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Mi(),n=jp(e),o=hu(r,n);o.tag=2,t!=null&&(o.callback=t),t=Fp(e,o,n),t!==null&&(gc(t,e,n,r),PT(t,e,n))}};function z3(e,t,r,n,o,a,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,i):t.prototype&&t.prototype.isPureReactComponent?!Vx(r,n)||!Vx(o,a):!0}function P8(e,t,r){var n=!1,o=Bp,a=t.contextType;return typeof a=="object"&&a!==null?a=yl(a):(o=os(t)?xf:ii.current,n=t.contextTypes,a=(n=n!=null)?Jh(e,o):Bp),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=dC,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=a),t}function _3(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&dC.enqueueReplaceState(t,t.state,null)}function FM(e,t,r,n){var o=e.stateNode;o.props=r,o.state=e.memoizedState,o.refs={},yF(e);var a=t.contextType;typeof a=="object"&&a!==null?o.context=yl(a):(a=os(t)?xf:ii.current,o.context=Jh(e,a)),o.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(MM(e,t,a,r),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&dC.enqueueReplaceState(o,o.state,null),YT(e,r,o,n),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function ev(e,t){try{var r="",n=t;do r+=Wge(n),n=n.return;while(n);var o=r}catch(a){o=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:o,digest:null}}function ZN(e,t,r){return{value:e,source:null,stack:r!=null?r:null,digest:t!=null?t:null}}function OM(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var pve=typeof WeakMap=="function"?WeakMap:Map;function D8(e,t,r){r=hu(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){ZT||(ZT=!0,HM=n),OM(e,t)},r}function E8(e,t,r){r=hu(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var o=t.value;r.payload=function(){return n(o)},r.callback=function(){OM(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){OM(e,t),typeof n!="function"&&(Op===null?Op=new Set([this]):Op.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function B3(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new pve;var o=new Set;n.set(t,o)}else o=n.get(t),o===void 0&&(o=new Set,n.set(t,o));o.has(r)||(o.add(r),e=Pve.bind(null,e,t,r),t.then(e,e))}function $3(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function W3(e,t,r,n,o){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=hu(-1,1),t.tag=2,Fp(r,t,1))),r.lanes|=1),e):(e.flags|=65536,e.lanes=o,e)}var mve=wu.ReactCurrentOwner,rs=!1;function Ni(e,t,r,n){t.child=e===null?n8(t,null,r,n):Qh(t,e.child,r,n)}function R3(e,t,r,n,o){r=r.render;var a=t.ref;return Gh(t,o),n=SF(e,t,r,n,a,o),r=TF(),e!==null&&!rs?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,xu(e,t,o)):(Dn&&r&&uF(t),t.flags|=1,Ni(e,t,n,o),t.child)}function U3(e,t,r,n,o){if(e===null){var a=r.type;return typeof a=="function"&&!FF(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,I8(e,t,a,n,o)):(e=NT(r.type,null,n,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,(e.lanes&o)===0){var i=a.memoizedProps;if(r=r.compare,r=r!==null?r:Vx,r(i,n)&&e.ref===t.ref)return xu(e,t,o)}return t.flags|=1,e=zp(a,n),e.ref=t.ref,e.return=t,t.child=e}function I8(e,t,r,n,o){if(e!==null){var a=e.memoizedProps;if(Vx(a,n)&&e.ref===t.ref)if(rs=!1,t.pendingProps=n=a,(e.lanes&o)!==0)(e.flags&131072)!==0&&(rs=!0);else return t.lanes=e.lanes,xu(e,t,o)}return jM(e,t,r,n,o)}function A8(e,t,r){var n=t.pendingProps,o=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},dn(Rh,zs),zs|=r;else{if((r&1073741824)===0)return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,dn(Rh,zs),zs|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,dn(Rh,zs),zs|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,dn(Rh,zs),zs|=n;return Ni(e,t,o,r),t.child}function L8(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function jM(e,t,r,n,o){var a=os(r)?xf:ii.current;return a=Jh(t,a),Gh(t,o),r=SF(e,t,r,n,a,o),n=TF(),e!==null&&!rs?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,xu(e,t,o)):(Dn&&n&&uF(t),t.flags|=1,Ni(e,t,r,o),t.child)}function V3(e,t,r,n,o){if(os(r)){var a=!0;UT(t)}else a=!1;if(Gh(t,o),t.stateNode===null)IT(e,t),P8(t,r,n),FM(t,r,n,o),n=!0;else if(e===null){var i=t.stateNode,s=t.memoizedProps;i.props=s;var l=i.context,c=r.contextType;typeof c=="object"&&c!==null?c=yl(c):(c=os(r)?xf:ii.current,c=Jh(t,c));var d=r.getDerivedStateFromProps,u=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";u||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(s!==n||l!==c)&&_3(t,i,n,c),Cp=!1;var p=t.memoizedState;i.state=p,YT(t,n,i,o),l=t.memoizedState,s!==n||p!==l||ns.current||Cp?(typeof d=="function"&&(MM(t,r,d,n),l=t.memoizedState),(s=Cp||z3(t,r,s,n,p,l,c))?(u||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=c,n=s):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,a8(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:uc(t.type,s),i.props=c,u=t.pendingProps,p=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=yl(l):(l=os(r)?xf:ii.current,l=Jh(t,l));var m=r.getDerivedStateFromProps;(d=typeof m=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(s!==u||p!==l)&&_3(t,i,n,l),Cp=!1,p=t.memoizedState,i.state=p,YT(t,n,i,o);var f=t.memoizedState;s!==u||p!==f||ns.current||Cp?(typeof m=="function"&&(MM(t,r,m,n),f=t.memoizedState),(c=Cp||z3(t,r,c,n,p,f,l)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,f,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,f,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=f),i.props=n,i.state=f,i.context=l,n=c):(typeof i.componentDidUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return zM(e,t,r,n,a,o)}function zM(e,t,r,n,o,a){L8(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return o&&I3(t,r,!1),xu(e,t,a);n=t.stateNode,mve.current=t;var s=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=Qh(t,e.child,null,a),t.child=Qh(t,null,s,a)):Ni(e,t,s,a),t.memoizedState=n.state,o&&I3(t,r,!0),t.child}function N8(e){var t=e.stateNode;t.pendingContext?E3(e,t.pendingContext,t.pendingContext!==t.context):t.context&&E3(e,t.context,!1),bF(e,t.containerInfo)}function H3(e,t,r,n,o){return Xh(),mF(o),t.flags|=256,Ni(e,t,r,n),t.child}var _M={dehydrated:null,treeContext:null,retryLane:0};function BM(e){return{baseLanes:e,cachePool:null,transitions:null}}function M8(e,t,r){var n=t.pendingProps,o=qn.current,a=!1,i=(t.flags&128)!==0,s;if((s=i)||(s=e!==null&&e.memoizedState===null?!1:(o&2)!==0),s?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),dn(qn,o&1),e===null)return LM(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(i=n.children,e=n.fallback,a?(n=t.mode,a=t.child,i={mode:"hidden",children:i},(n&1)===0&&a!==null?(a.childLanes=0,a.pendingProps=i):a=mC(i,n,0,null),e=bf(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=BM(r),t.memoizedState=_M,e):DF(t,i));if(o=e.memoizedState,o!==null&&(s=o.dehydrated,s!==null))return fve(e,t,i,n,s,o,r);if(a){a=n.fallback,i=t.mode,o=e.child,s=o.sibling;var l={mode:"hidden",children:n.children};return(i&1)===0&&t.child!==o?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=zp(o,l),n.subtreeFlags=o.subtreeFlags&14680064),s!==null?a=zp(s,a):(a=bf(a,i,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,i=e.child.memoizedState,i=i===null?BM(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=e.childLanes&~r,t.memoizedState=_M,n}return a=e.child,e=a.sibling,n=zp(a,{mode:"visible",children:n.children}),(t.mode&1)===0&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function DF(e,t){return t=mC({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function xT(e,t,r,n){return n!==null&&mF(n),Qh(t,e.child,null,r),e=DF(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function fve(e,t,r,n,o,a,i){if(r)return t.flags&256?(t.flags&=-257,n=ZN(Error(Me(422))),xT(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,o=t.mode,n=mC({mode:"visible",children:n.children},o,0,null),a=bf(a,o,i,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,(t.mode&1)!==0&&Qh(t,e.child,null,i),t.child.memoizedState=BM(i),t.memoizedState=_M,a);if((t.mode&1)===0)return xT(e,t,i,null);if(o.data==="$!"){if(n=o.nextSibling&&o.nextSibling.dataset,n)var s=n.dgst;return n=s,a=Error(Me(419)),n=ZN(a,n,void 0),xT(e,t,i,n)}if(s=(i&e.childLanes)!==0,rs||s){if(n=fa,n!==null){switch(i&-i){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=(o&(n.suspendedLanes|i))!==0?0:o,o!==0&&o!==a.retryLane&&(a.retryLane=o,bu(e,o),gc(n,e,o,-1))}return MF(),n=ZN(Error(Me(421))),xT(e,t,i,n)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=Dve.bind(null,e),o._reactRetry=t,null):(e=a.treeContext,_s=Mp(o.nextSibling),Bs=t,Dn=!0,mc=null,e!==null&&(fl[gl++]=fu,fl[gl++]=gu,fl[gl++]=wf,fu=e.id,gu=e.overflow,wf=t),t=DF(t,n.children),t.flags|=4096,t)}function q3(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),NM(e.return,t,r)}function eM(e,t,r,n,o){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:o}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=o)}function F8(e,t,r){var n=t.pendingProps,o=n.revealOrder,a=n.tail;if(Ni(e,t,n.children,r),n=qn.current,(n&2)!==0)n=n&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&q3(e,r,t);else if(e.tag===19)q3(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(dn(qn,n),(t.mode&1)===0)t.memoizedState=null;else switch(o){case"forwards":for(r=t.child,o=null;r!==null;)e=r.alternate,e!==null&&KT(e)===null&&(o=r),r=r.sibling;r=o,r===null?(o=t.child,t.child=null):(o=r.sibling,r.sibling=null),eM(t,!1,o,r,a);break;case"backwards":for(r=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&KT(e)===null){t.child=o;break}e=o.sibling,o.sibling=r,r=o,o=e}eM(t,!0,r,null,a);break;case"together":eM(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function IT(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function xu(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Sf|=t.lanes,(r&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(Me(153));if(t.child!==null){for(e=t.child,r=zp(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=zp(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function gve(e,t,r){switch(t.tag){case 3:N8(t),Xh();break;case 5:i8(t);break;case 1:os(t.type)&&UT(t);break;case 4:bF(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,o=t.memoizedProps.value;dn(qT,n._currentValue),n._currentValue=o;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(dn(qn,qn.current&1),t.flags|=128,null):(r&t.child.childLanes)!==0?M8(e,t,r):(dn(qn,qn.current&1),e=xu(e,t,r),e!==null?e.sibling:null);dn(qn,qn.current&1);break;case 19:if(n=(r&t.childLanes)!==0,(e.flags&128)!==0){if(n)return F8(e,t,r);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),dn(qn,qn.current),n)break;return null;case 22:case 23:return t.lanes=0,A8(e,t,r)}return xu(e,t,r)}var O8,$M,j8,z8;O8=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};$M=function(){};j8=function(e,t,r,n){var o=e.memoizedProps;if(o!==n){e=t.stateNode,vf(pd.current);var a=null;switch(r){case"input":o=lM(e,o),n=lM(e,n),a=[];break;case"select":o=Yn({},o,{value:void 0}),n=Yn({},n,{value:void 0}),a=[];break;case"textarea":o=uM(e,o),n=uM(e,n),a=[];break;default:typeof o.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=WT)}mM(r,n);var i;r=null;for(c in o)if(!n.hasOwnProperty(c)&&o.hasOwnProperty(c)&&o[c]!=null)if(c==="style"){var s=o[c];for(i in s)s.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(zx.hasOwnProperty(c)?a||(a=[]):(a=a||[]).push(c,null));for(c in n){var l=n[c];if(s=o!=null?o[c]:void 0,n.hasOwnProperty(c)&&l!==s&&(l!=null||s!=null))if(c==="style")if(s){for(i in s)!s.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&s[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(a||(a=[]),a.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,s=s?s.__html:void 0,l!=null&&s!==l&&(a=a||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(zx.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&bn("scroll",e),a||s===l||(a=[])):(a=a||[]).push(c,l))}r&&(a=a||[]).push("style",r);var c=a;(t.updateQueue=c)&&(t.flags|=4)}};z8=function(e,t,r,n){r!==n&&(t.flags|=4)};function wx(e,t){if(!Dn)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function oi(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var o=e.child;o!==null;)r|=o.lanes|o.childLanes,n|=o.subtreeFlags&14680064,n|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)r|=o.lanes|o.childLanes,n|=o.subtreeFlags,n|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function hve(e,t,r){var n=t.pendingProps;switch(pF(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return oi(t),null;case 1:return os(t.type)&&RT(),oi(t),null;case 3:return n=t.stateNode,Zh(),xn(ns),xn(ii),wF(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(yT(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,mc!==null&&(YM(mc),mc=null))),$M(e,t),oi(t),null;case 5:xF(t);var o=vf(Kx.current);if(r=t.type,e!==null&&t.stateNode!=null)j8(e,t,r,n,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Me(166));return oi(t),null}if(e=vf(pd.current),yT(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[dd]=t,n[Gx]=a,e=(t.mode&1)!==0,r){case"dialog":bn("cancel",n),bn("close",n);break;case"iframe":case"object":case"embed":bn("load",n);break;case"video":case"audio":for(o=0;o<Dx.length;o++)bn(Dx[o],n);break;case"source":bn("error",n);break;case"img":case"image":case"link":bn("error",n),bn("load",n);break;case"details":bn("toggle",n);break;case"input":e3(n,a),bn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},bn("invalid",n);break;case"textarea":r3(n,a),bn("invalid",n)}mM(r,a),o=null;for(var i in a)if(a.hasOwnProperty(i)){var s=a[i];i==="children"?typeof s=="string"?n.textContent!==s&&(a.suppressHydrationWarning!==!0&&vT(n.textContent,s,e),o=["children",s]):typeof s=="number"&&n.textContent!==""+s&&(a.suppressHydrationWarning!==!0&&vT(n.textContent,s,e),o=["children",""+s]):zx.hasOwnProperty(i)&&s!=null&&i==="onScroll"&&bn("scroll",n)}switch(r){case"input":aT(n),t3(n,a,!0);break;case"textarea":aT(n),n3(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=WT)}n=o,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=uU(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[dd]=t,e[Gx]=n,O8(e,t,!1,!1),t.stateNode=e;e:{switch(i=fM(r,n),r){case"dialog":bn("cancel",e),bn("close",e),o=n;break;case"iframe":case"object":case"embed":bn("load",e),o=n;break;case"video":case"audio":for(o=0;o<Dx.length;o++)bn(Dx[o],e);o=n;break;case"source":bn("error",e),o=n;break;case"img":case"image":case"link":bn("error",e),bn("load",e),o=n;break;case"details":bn("toggle",e),o=n;break;case"input":e3(e,n),o=lM(e,n),bn("invalid",e);break;case"option":o=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},o=Yn({},n,{value:void 0}),bn("invalid",e);break;case"textarea":r3(e,n),o=uM(e,n),bn("invalid",e);break;default:o=n}mM(r,o),s=o;for(a in s)if(s.hasOwnProperty(a)){var l=s[a];a==="style"?fU(e,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&pU(e,l)):a==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&_x(e,l):typeof l=="number"&&_x(e,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(zx.hasOwnProperty(a)?l!=null&&a==="onScroll"&&bn("scroll",e):l!=null&&XM(e,a,l,i))}switch(r){case"input":aT(e),t3(e,n,!1);break;case"textarea":aT(e),n3(e);break;case"option":n.value!=null&&e.setAttribute("value",""+_p(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?Uh(e,!!n.multiple,a,!1):n.defaultValue!=null&&Uh(e,!!n.multiple,n.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=WT)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return oi(t),null;case 6:if(e&&t.stateNode!=null)z8(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Me(166));if(r=vf(Kx.current),vf(pd.current),yT(t)){if(n=t.stateNode,r=t.memoizedProps,n[dd]=t,(a=n.nodeValue!==r)&&(e=Bs,e!==null))switch(e.tag){case 3:vT(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&vT(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[dd]=t,t.stateNode=n}return oi(t),null;case 13:if(xn(qn),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Dn&&_s!==null&&(t.mode&1)!==0&&(t.flags&128)===0)t8(),Xh(),t.flags|=98560,a=!1;else if(a=yT(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(Me(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Me(317));a[dd]=t}else Xh(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;oi(t),a=!1}else mc!==null&&(YM(mc),mc=null),a=!0;if(!a)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(qn.current&1)!==0?Xo===0&&(Xo=3):MF())),t.updateQueue!==null&&(t.flags|=4),oi(t),null);case 4:return Zh(),$M(e,t),e===null&&Hx(t.stateNode.containerInfo),oi(t),null;case 10:return hF(t.type._context),oi(t),null;case 17:return os(t.type)&&RT(),oi(t),null;case 19:if(xn(qn),a=t.memoizedState,a===null)return oi(t),null;if(n=(t.flags&128)!==0,i=a.rendering,i===null)if(n)wx(a,!1);else{if(Xo!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(i=KT(e),i!==null){for(t.flags|=128,wx(a,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,e=i.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return dn(qn,qn.current&1|2),t.child}e=e.sibling}a.tail!==null&&yo()>tv&&(t.flags|=128,n=!0,wx(a,!1),t.lanes=4194304)}else{if(!n)if(e=KT(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),wx(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!Dn)return oi(t),null}else 2*yo()-a.renderingStartTime>tv&&r!==1073741824&&(t.flags|=128,n=!0,wx(a,!1),t.lanes=4194304);a.isBackwards?(i.sibling=t.child,t.child=i):(r=a.last,r!==null?r.sibling=i:t.child=i,a.last=i)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=yo(),t.sibling=null,r=qn.current,dn(qn,n?r&1|2:r&1),t):(oi(t),null);case 22:case 23:return NF(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&(t.mode&1)!==0?(zs&1073741824)!==0&&(oi(t),t.subtreeFlags&6&&(t.flags|=8192)):oi(t),null;case 24:return null;case 25:return null}throw Error(Me(156,t.tag))}function vve(e,t){switch(pF(t),t.tag){case 1:return os(t.type)&&RT(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Zh(),xn(ns),xn(ii),wF(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return xF(t),null;case 13:if(xn(qn),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Me(340));Xh()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return xn(qn),null;case 4:return Zh(),null;case 10:return hF(t.type._context),null;case 22:case 23:return NF(),null;case 24:return null;default:return null}}var wT=!1,ai=!1,yve=typeof WeakSet=="function"?WeakSet:Set,qe=null;function Wh(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){so(e,t,n)}else r.current=null}function WM(e,t,r){try{r()}catch(n){so(e,t,n)}}var G3=!1;function bve(e,t){if(TM=_T,e=RU(),dF(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var o=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch(x){r=null;break e}var i=0,s=-1,l=-1,c=0,d=0,u=e,p=null;t:for(;;){for(var m;u!==r||o!==0&&u.nodeType!==3||(s=i+o),u!==a||n!==0&&u.nodeType!==3||(l=i+n),u.nodeType===3&&(i+=u.nodeValue.length),(m=u.firstChild)!==null;)p=u,u=m;for(;;){if(u===e)break t;if(p===r&&++c===o&&(s=i),p===a&&++d===n&&(l=i),(m=u.nextSibling)!==null)break;u=p,p=u.parentNode}u=m}r=s===-1||l===-1?null:{start:s,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(CM={focusedElem:e,selectionRange:r},_T=!1,qe=t;qe!==null;)if(t=qe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,qe=e;else for(;qe!==null;){t=qe;try{var f=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var g=f.memoizedProps,v=f.memoizedState,h=t.stateNode,y=h.getSnapshotBeforeUpdate(t.elementType===t.type?g:uc(t.type,g),v);h.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Me(163))}}catch(x){so(t,t.return,x)}if(e=t.sibling,e!==null){e.return=t.return,qe=e;break}qe=t.return}return f=G3,G3=!1,f}function Fx(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var o=n=n.next;do{if((o.tag&e)===e){var a=o.destroy;o.destroy=void 0,a!==void 0&&WM(t,r,a)}o=o.next}while(o!==n)}}function uC(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function RM(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function _8(e){var t=e.alternate;t!==null&&(e.alternate=null,_8(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[dd],delete t[Gx],delete t[EM],delete t[tve],delete t[rve])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function B8(e){return e.tag===5||e.tag===3||e.tag===4}function Y3(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||B8(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function UM(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=WT));else if(n!==4&&(e=e.child,e!==null))for(UM(e,t,r),e=e.sibling;e!==null;)UM(e,t,r),e=e.sibling}function VM(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(VM(e,t,r),e=e.sibling;e!==null;)VM(e,t,r),e=e.sibling}var za=null,pc=!1;function Sp(e,t,r){for(r=r.child;r!==null;)$8(e,t,r),r=r.sibling}function $8(e,t,r){if(ud&&typeof ud.onCommitFiberUnmount=="function")try{ud.onCommitFiberUnmount(nC,r)}catch(s){}switch(r.tag){case 5:ai||Wh(r,t);case 6:var n=za,o=pc;za=null,Sp(e,t,r),za=n,pc=o,za!==null&&(pc?(e=za,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):za.removeChild(r.stateNode));break;case 18:za!==null&&(pc?(e=za,r=r.stateNode,e.nodeType===8?GN(e.parentNode,r):e.nodeType===1&&GN(e,r),Rx(e)):GN(za,r.stateNode));break;case 4:n=za,o=pc,za=r.stateNode.containerInfo,pc=!0,Sp(e,t,r),za=n,pc=o;break;case 0:case 11:case 14:case 15:if(!ai&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){o=n=n.next;do{var a=o,i=a.destroy;a=a.tag,i!==void 0&&((a&2)!==0||(a&4)!==0)&&WM(r,t,i),o=o.next}while(o!==n)}Sp(e,t,r);break;case 1:if(!ai&&(Wh(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(s){so(r,t,s)}Sp(e,t,r);break;case 21:Sp(e,t,r);break;case 22:r.mode&1?(ai=(n=ai)||r.memoizedState!==null,Sp(e,t,r),ai=n):Sp(e,t,r);break;default:Sp(e,t,r)}}function K3(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new yve),t.forEach(function(n){var o=Eve.bind(null,e,n);r.has(n)||(r.add(n),n.then(o,o))})}}function dc(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var o=r[n];try{var a=e,i=t,s=i;e:for(;s!==null;){switch(s.tag){case 5:za=s.stateNode,pc=!1;break e;case 3:za=s.stateNode.containerInfo,pc=!0;break e;case 4:za=s.stateNode.containerInfo,pc=!0;break e}s=s.return}if(za===null)throw Error(Me(160));$8(a,i,o),za=null,pc=!1;var l=o.alternate;l!==null&&(l.return=null),o.return=null}catch(c){so(o,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)W8(t,e),t=t.sibling}function W8(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(dc(t,e),ld(e),n&4){try{Fx(3,e,e.return),uC(3,e)}catch(g){so(e,e.return,g)}try{Fx(5,e,e.return)}catch(g){so(e,e.return,g)}}break;case 1:dc(t,e),ld(e),n&512&&r!==null&&Wh(r,r.return);break;case 5:if(dc(t,e),ld(e),n&512&&r!==null&&Wh(r,r.return),e.flags&32){var o=e.stateNode;try{_x(o,"")}catch(g){so(e,e.return,g)}}if(n&4&&(o=e.stateNode,o!=null)){var a=e.memoizedProps,i=r!==null?r.memoizedProps:a,s=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{s==="input"&&a.type==="radio"&&a.name!=null&&cU(o,a),fM(s,i);var c=fM(s,a);for(i=0;i<l.length;i+=2){var d=l[i],u=l[i+1];d==="style"?fU(o,u):d==="dangerouslySetInnerHTML"?pU(o,u):d==="children"?_x(o,u):XM(o,d,u,c)}switch(s){case"input":cM(o,a);break;case"textarea":dU(o,a);break;case"select":var p=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!a.multiple;var m=a.value;m!=null?Uh(o,!!a.multiple,m,!1):p!==!!a.multiple&&(a.defaultValue!=null?Uh(o,!!a.multiple,a.defaultValue,!0):Uh(o,!!a.multiple,a.multiple?[]:"",!1))}o[Gx]=a}catch(g){so(e,e.return,g)}}break;case 6:if(dc(t,e),ld(e),n&4){if(e.stateNode===null)throw Error(Me(162));o=e.stateNode,a=e.memoizedProps;try{o.nodeValue=a}catch(g){so(e,e.return,g)}}break;case 3:if(dc(t,e),ld(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Rx(t.containerInfo)}catch(g){so(e,e.return,g)}break;case 4:dc(t,e),ld(e);break;case 13:dc(t,e),ld(e),o=e.child,o.flags&8192&&(a=o.memoizedState!==null,o.stateNode.isHidden=a,!a||o.alternate!==null&&o.alternate.memoizedState!==null||(AF=yo())),n&4&&K3(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(ai=(c=ai)||d,dc(t,e),ai=c):dc(t,e),ld(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!d&&(e.mode&1)!==0)for(qe=e,d=e.child;d!==null;){for(u=qe=d;qe!==null;){switch(p=qe,m=p.child,p.tag){case 0:case 11:case 14:case 15:Fx(4,p,p.return);break;case 1:Wh(p,p.return);var f=p.stateNode;if(typeof f.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(g){so(n,r,g)}}break;case 5:Wh(p,p.return);break;case 22:if(p.memoizedState!==null){X3(u);continue}}m!==null?(m.return=p,qe=m):X3(u)}d=d.sibling}e:for(d=null,u=e;;){if(u.tag===5){if(d===null){d=u;try{o=u.stateNode,c?(a=o.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(s=u.stateNode,l=u.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,s.style.display=mU("display",i))}catch(g){so(e,e.return,g)}}}else if(u.tag===6){if(d===null)try{u.stateNode.nodeValue=c?"":u.memoizedProps}catch(g){so(e,e.return,g)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===e)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===e)break e;for(;u.sibling===null;){if(u.return===null||u.return===e)break e;d===u&&(d=null),u=u.return}d===u&&(d=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:dc(t,e),ld(e),n&4&&K3(e);break;case 21:break;default:dc(t,e),ld(e)}}function ld(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(B8(r)){var n=r;break e}r=r.return}throw Error(Me(160))}switch(n.tag){case 5:var o=n.stateNode;n.flags&32&&(_x(o,""),n.flags&=-33);var a=Y3(e);VM(e,a,o);break;case 3:case 4:var i=n.stateNode.containerInfo,s=Y3(e);UM(e,s,i);break;default:throw Error(Me(161))}}catch(l){so(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function xve(e,t,r){qe=e,R8(e,t,r)}function R8(e,t,r){for(var n=(e.mode&1)!==0;qe!==null;){var o=qe,a=o.child;if(o.tag===22&&n){var i=o.memoizedState!==null||wT;if(!i){var s=o.alternate,l=s!==null&&s.memoizedState!==null||ai;s=wT;var c=ai;if(wT=i,(ai=l)&&!c)for(qe=o;qe!==null;)i=qe,l=i.child,i.tag===22&&i.memoizedState!==null?Q3(o):l!==null?(l.return=i,qe=l):Q3(o);for(;a!==null;)qe=a,R8(a,t,r),a=a.sibling;qe=o,wT=s,ai=c}J3(e,t,r)}else(o.subtreeFlags&8772)!==0&&a!==null?(a.return=o,qe=a):J3(e,t,r)}}function J3(e){for(;qe!==null;){var t=qe;if((t.flags&8772)!==0){var r=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:ai||uC(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!ai)if(r===null)n.componentDidMount();else{var o=t.elementType===t.type?r.memoizedProps:uc(t.type,r.memoizedProps);n.componentDidUpdate(o,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&F3(t,a,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}F3(t,i,r)}break;case 5:var s=t.stateNode;if(r===null&&t.flags&4){r=s;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var u=d.dehydrated;u!==null&&Rx(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Me(163))}ai||t.flags&512&&RM(t)}catch(p){so(t,t.return,p)}}if(t===e){qe=null;break}if(r=t.sibling,r!==null){r.return=t.return,qe=r;break}qe=t.return}}function X3(e){for(;qe!==null;){var t=qe;if(t===e){qe=null;break}var r=t.sibling;if(r!==null){r.return=t.return,qe=r;break}qe=t.return}}function Q3(e){for(;qe!==null;){var t=qe;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{uC(4,t)}catch(l){so(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var o=t.return;try{n.componentDidMount()}catch(l){so(t,o,l)}}var a=t.return;try{RM(t)}catch(l){so(t,a,l)}break;case 5:var i=t.return;try{RM(t)}catch(l){so(t,i,l)}}}catch(l){so(t,t.return,l)}if(t===e){qe=null;break}var s=t.sibling;if(s!==null){s.return=t.return,qe=s;break}qe=t.return}}var wve=Math.ceil,QT=wu.ReactCurrentDispatcher,EF=wu.ReactCurrentOwner,vl=wu.ReactCurrentBatchConfig,vr=0,fa=null,No=null,_a=0,zs=0,Rh=Wp(0),Xo=0,Zx=null,Sf=0,pC=0,IF=0,Ox=null,ts=null,AF=0,tv=1/0,pu=null,ZT=!1,HM=null,Op=null,kT=!1,Ip=null,eC=0,jx=0,qM=null,AT=-1,LT=0;function Mi(){return(vr&6)!==0?yo():AT!==-1?AT:AT=yo()}function jp(e){return(e.mode&1)===0?1:(vr&2)!==0&&_a!==0?_a&-_a:ove.transition!==null?(LT===0&&(LT=PU()),LT):(e=Gr,e!==0||(e=window.event,e=e===void 0?16:MU(e.type)),e)}function gc(e,t,r,n){if(50<jx)throw jx=0,qM=null,Error(Me(185));ew(e,r,n),((vr&2)===0||e!==fa)&&(e===fa&&((vr&2)===0&&(pC|=r),Xo===4&&Dp(e,_a)),as(e,n),r===1&&vr===0&&(t.mode&1)===0&&(tv=yo()+500,lC&&Rp()))}function as(e,t){var r=e.callbackNode;ihe(e,t);var n=zT(e,e===fa?_a:0);if(n===0)r!==null&&i3(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&i3(r),t===1)e.tag===0?nve(Z3.bind(null,e)):QU(Z3.bind(null,e)),Zhe(function(){(vr&6)===0&&Rp()}),r=null;else{switch(DU(n)){case 1:r=rF;break;case 4:r=TU;break;case 16:r=jT;break;case 536870912:r=CU;break;default:r=jT}r=J8(r,U8.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function U8(e,t){if(AT=-1,LT=0,(vr&6)!==0)throw Error(Me(327));var r=e.callbackNode;if(Yh()&&e.callbackNode!==r)return null;var n=zT(e,e===fa?_a:0);if(n===0)return null;if((n&30)!==0||(n&e.expiredLanes)!==0||t)t=tC(e,n);else{t=n;var o=vr;vr|=2;var a=H8();(fa!==e||_a!==t)&&(pu=null,tv=yo()+500,yf(e,t));do try{Tve();break}catch(s){V8(e,s)}while(!0);gF(),QT.current=a,vr=o,No!==null?t=0:(fa=null,_a=0,t=Xo)}if(t!==0){if(t===2&&(o=bM(e),o!==0&&(n=o,t=GM(e,o))),t===1)throw r=Zx,yf(e,0),Dp(e,n),as(e,yo()),r;if(t===6)Dp(e,n);else{if(o=e.current.alternate,(n&30)===0&&!kve(o)&&(t=tC(e,n),t===2&&(a=bM(e),a!==0&&(n=a,t=GM(e,a))),t===1))throw r=Zx,yf(e,0),Dp(e,n),as(e,yo()),r;switch(e.finishedWork=o,e.finishedLanes=n,t){case 0:case 1:throw Error(Me(345));case 2:ff(e,ts,pu);break;case 3:if(Dp(e,n),(n&130023424)===n&&(t=AF+500-yo(),10<t)){if(zT(e,0)!==0)break;if(o=e.suspendedLanes,(o&n)!==n){Mi(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=DM(ff.bind(null,e,ts,pu),t);break}ff(e,ts,pu);break;case 4:if(Dp(e,n),(n&4194240)===n)break;for(t=e.eventTimes,o=-1;0<n;){var i=31-fc(n);a=1<<i,i=t[i],i>o&&(o=i),n&=~a}if(n=o,n=yo()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*wve(n/1960))-n,10<n){e.timeoutHandle=DM(ff.bind(null,e,ts,pu),n);break}ff(e,ts,pu);break;case 5:ff(e,ts,pu);break;default:throw Error(Me(329))}}}return as(e,yo()),e.callbackNode===r?U8.bind(null,e):null}function GM(e,t){var r=Ox;return e.current.memoizedState.isDehydrated&&(yf(e,t).flags|=256),e=tC(e,t),e!==2&&(t=ts,ts=r,t!==null&&YM(t)),e}function YM(e){ts===null?ts=e:ts.push.apply(ts,e)}function kve(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var o=r[n],a=o.getSnapshot;o=o.value;try{if(!hc(a(),o))return!1}catch(i){return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Dp(e,t){for(t&=~IF,t&=~pC,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-fc(t),n=1<<r;e[r]=-1,t&=~n}}function Z3(e){if((vr&6)!==0)throw Error(Me(327));Yh();var t=zT(e,0);if((t&1)===0)return as(e,yo()),null;var r=tC(e,t);if(e.tag!==0&&r===2){var n=bM(e);n!==0&&(t=n,r=GM(e,n))}if(r===1)throw r=Zx,yf(e,0),Dp(e,t),as(e,yo()),r;if(r===6)throw Error(Me(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ff(e,ts,pu),as(e,yo()),null}function LF(e,t){var r=vr;vr|=1;try{return e(t)}finally{vr=r,vr===0&&(tv=yo()+500,lC&&Rp())}}function Tf(e){Ip!==null&&Ip.tag===0&&(vr&6)===0&&Yh();var t=vr;vr|=1;var r=vl.transition,n=Gr;try{if(vl.transition=null,Gr=1,e)return e()}finally{Gr=n,vl.transition=r,vr=t,(vr&6)===0&&Rp()}}function NF(){zs=Rh.current,xn(Rh)}function yf(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Qhe(r)),No!==null)for(r=No.return;r!==null;){var n=r;switch(pF(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&RT();break;case 3:Zh(),xn(ns),xn(ii),wF();break;case 5:xF(n);break;case 4:Zh();break;case 13:xn(qn);break;case 19:xn(qn);break;case 10:hF(n.type._context);break;case 22:case 23:NF()}r=r.return}if(fa=e,No=e=zp(e.current,null),_a=zs=t,Xo=0,Zx=null,IF=pC=Sf=0,ts=Ox=null,hf!==null){for(t=0;t<hf.length;t++)if(r=hf[t],n=r.interleaved,n!==null){r.interleaved=null;var o=n.next,a=r.pending;if(a!==null){var i=a.next;a.next=o,n.next=i}r.pending=n}hf=null}return e}function V8(e,t){do{var r=No;try{if(gF(),DT.current=XT,JT){for(var n=Gn.memoizedState;n!==null;){var o=n.queue;o!==null&&(o.pending=null),n=n.next}JT=!1}if(kf=0,ma=Jo=Gn=null,Mx=!1,Jx=0,EF.current=null,r===null||r.return===null){Xo=1,Zx=t,No=null;break}e:{var a=e,i=r.return,s=r,l=t;if(t=_a,s.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,d=s,u=d.tag;if((d.mode&1)===0&&(u===0||u===11||u===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=$3(i);if(m!==null){m.flags&=-257,W3(m,i,s,a,t),m.mode&1&&B3(a,c,t),t=m,l=c;var f=t.updateQueue;if(f===null){var g=new Set;g.add(l),t.updateQueue=g}else f.add(l);break e}else{if((t&1)===0){B3(a,c,t),MF();break e}l=Error(Me(426))}}else if(Dn&&s.mode&1){var v=$3(i);if(v!==null){(v.flags&65536)===0&&(v.flags|=256),W3(v,i,s,a,t),mF(ev(l,s));break e}}a=l=ev(l,s),Xo!==4&&(Xo=2),Ox===null?Ox=[a]:Ox.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var h=D8(a,l,t);M3(a,h);break e;case 1:s=l;var y=a.type,b=a.stateNode;if((a.flags&128)===0&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Op===null||!Op.has(b)))){a.flags|=65536,t&=-t,a.lanes|=t;var x=E8(a,s,t);M3(a,x);break e}}a=a.return}while(a!==null)}G8(r)}catch(w){t=w,No===r&&r!==null&&(No=r=r.return);continue}break}while(!0)}function H8(){var e=QT.current;return QT.current=XT,e===null?XT:e}function MF(){(Xo===0||Xo===3||Xo===2)&&(Xo=4),fa===null||(Sf&268435455)===0&&(pC&268435455)===0||Dp(fa,_a)}function tC(e,t){var r=vr;vr|=2;var n=H8();(fa!==e||_a!==t)&&(pu=null,yf(e,t));do try{Sve();break}catch(o){V8(e,o)}while(!0);if(gF(),vr=r,QT.current=n,No!==null)throw Error(Me(261));return fa=null,_a=0,Xo}function Sve(){for(;No!==null;)q8(No)}function Tve(){for(;No!==null&&!Xge();)q8(No)}function q8(e){var t=K8(e.alternate,e,zs);e.memoizedProps=e.pendingProps,t===null?G8(e):No=t,EF.current=null}function G8(e){var t=e;do{var r=t.alternate;if(e=t.return,(t.flags&32768)===0){if(r=hve(r,t,zs),r!==null){No=r;return}}else{if(r=vve(r,t),r!==null){r.flags&=32767,No=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Xo=6,No=null;return}}if(t=t.sibling,t!==null){No=t;return}No=t=e}while(t!==null);Xo===0&&(Xo=5)}function ff(e,t,r){var n=Gr,o=vl.transition;try{vl.transition=null,Gr=1,Cve(e,t,r,n)}finally{vl.transition=o,Gr=n}return null}function Cve(e,t,r,n){do Yh();while(Ip!==null);if((vr&6)!==0)throw Error(Me(327));r=e.finishedWork;var o=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Me(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(she(e,a),e===fa&&(No=fa=null,_a=0),(r.subtreeFlags&2064)===0&&(r.flags&2064)===0||kT||(kT=!0,J8(jT,function(){return Yh(),null})),a=(r.flags&15990)!==0,(r.subtreeFlags&15990)!==0||a){a=vl.transition,vl.transition=null;var i=Gr;Gr=1;var s=vr;vr|=4,EF.current=null,bve(e,r),W8(r,e),Ghe(CM),_T=!!TM,CM=TM=null,e.current=r,xve(r,e,o),Qge(),vr=s,Gr=i,vl.transition=a}else e.current=r;if(kT&&(kT=!1,Ip=e,eC=o),a=e.pendingLanes,a===0&&(Op=null),the(r.stateNode,n),as(e,yo()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)o=t[r],n(o.value,{componentStack:o.stack,digest:o.digest});if(ZT)throw ZT=!1,e=HM,HM=null,e;return(eC&1)!==0&&e.tag!==0&&Yh(),a=e.pendingLanes,(a&1)!==0?e===qM?jx++:(jx=0,qM=e):jx=0,Rp(),null}function Yh(){if(Ip!==null){var e=DU(eC),t=vl.transition,r=Gr;try{if(vl.transition=null,Gr=16>e?16:e,Ip===null)var n=!1;else{if(e=Ip,Ip=null,eC=0,(vr&6)!==0)throw Error(Me(331));var o=vr;for(vr|=4,qe=e.current;qe!==null;){var a=qe,i=a.child;if((qe.flags&16)!==0){var s=a.deletions;if(s!==null){for(var l=0;l<s.length;l++){var c=s[l];for(qe=c;qe!==null;){var d=qe;switch(d.tag){case 0:case 11:case 15:Fx(8,d,a)}var u=d.child;if(u!==null)u.return=d,qe=u;else for(;qe!==null;){d=qe;var p=d.sibling,m=d.return;if(_8(d),d===c){qe=null;break}if(p!==null){p.return=m,qe=p;break}qe=m}}}var f=a.alternate;if(f!==null){var g=f.child;if(g!==null){f.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(g!==null)}}qe=a}}if((a.subtreeFlags&2064)!==0&&i!==null)i.return=a,qe=i;else e:for(;qe!==null;){if(a=qe,(a.flags&2048)!==0)switch(a.tag){case 0:case 11:case 15:Fx(9,a,a.return)}var h=a.sibling;if(h!==null){h.return=a.return,qe=h;break e}qe=a.return}}var y=e.current;for(qe=y;qe!==null;){i=qe;var b=i.child;if((i.subtreeFlags&2064)!==0&&b!==null)b.return=i,qe=b;else e:for(i=y;qe!==null;){if(s=qe,(s.flags&2048)!==0)try{switch(s.tag){case 0:case 11:case 15:uC(9,s)}}catch(w){so(s,s.return,w)}if(s===i){qe=null;break e}var x=s.sibling;if(x!==null){x.return=s.return,qe=x;break e}qe=s.return}}if(vr=o,Rp(),ud&&typeof ud.onPostCommitFiberRoot=="function")try{ud.onPostCommitFiberRoot(nC,e)}catch(w){}n=!0}return n}finally{Gr=r,vl.transition=t}}return!1}function eU(e,t,r){t=ev(r,t),t=D8(e,t,1),e=Fp(e,t,1),t=Mi(),e!==null&&(ew(e,1,t),as(e,t))}function so(e,t,r){if(e.tag===3)eU(e,e,r);else for(;t!==null;){if(t.tag===3){eU(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Op===null||!Op.has(n))){e=ev(r,e),e=E8(t,e,1),t=Fp(t,e,1),e=Mi(),t!==null&&(ew(t,1,e),as(t,e));break}}t=t.return}}function Pve(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Mi(),e.pingedLanes|=e.suspendedLanes&r,fa===e&&(_a&r)===r&&(Xo===4||Xo===3&&(_a&130023424)===_a&&500>yo()-AF?yf(e,0):IF|=r),as(e,t)}function Y8(e,t){t===0&&((e.mode&1)===0?t=1:(t=lT,lT<<=1,(lT&130023424)===0&&(lT=4194304)));var r=Mi();e=bu(e,t),e!==null&&(ew(e,t,r),as(e,r))}function Dve(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Y8(e,r)}function Eve(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,o=e.memoizedState;o!==null&&(r=o.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Me(314))}n!==null&&n.delete(t),Y8(e,r)}var K8;K8=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||ns.current)rs=!0;else{if((e.lanes&r)===0&&(t.flags&128)===0)return rs=!1,gve(e,t,r);rs=(e.flags&131072)!==0}else rs=!1,Dn&&(t.flags&1048576)!==0&&ZU(t,HT,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;IT(e,t),e=t.pendingProps;var o=Jh(t,ii.current);Gh(t,r),o=SF(null,t,n,e,o,r);var a=TF();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,os(n)?(a=!0,UT(t)):a=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,yF(t),o.updater=dC,t.stateNode=o,o._reactInternals=t,FM(t,n,e,r),t=zM(null,t,n,!0,a,r)):(t.tag=0,Dn&&a&&uF(t),Ni(null,t,o,r),t=t.child),t;case 16:n=t.elementType;e:{switch(IT(e,t),e=t.pendingProps,o=n._init,n=o(n._payload),t.type=n,o=t.tag=Ave(n),e=uc(n,e),o){case 0:t=jM(null,t,n,e,r);break e;case 1:t=V3(null,t,n,e,r);break e;case 11:t=R3(null,t,n,e,r);break e;case 14:t=U3(null,t,n,uc(n.type,e),r);break e}throw Error(Me(306,n,""))}return t;case 0:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:uc(n,o),jM(e,t,n,o,r);case 1:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:uc(n,o),V3(e,t,n,o,r);case 3:e:{if(N8(t),e===null)throw Error(Me(387));n=t.pendingProps,a=t.memoizedState,o=a.element,a8(e,t),YT(t,n,null,r);var i=t.memoizedState;if(n=i.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){o=ev(Error(Me(423)),t),t=H3(e,t,n,r,o);break e}else if(n!==o){o=ev(Error(Me(424)),t),t=H3(e,t,n,r,o);break e}else for(_s=Mp(t.stateNode.containerInfo.firstChild),Bs=t,Dn=!0,mc=null,r=n8(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Xh(),n===o){t=xu(e,t,r);break e}Ni(e,t,n,r)}t=t.child}return t;case 5:return i8(t),e===null&&LM(t),n=t.type,o=t.pendingProps,a=e!==null?e.memoizedProps:null,i=o.children,PM(n,o)?i=null:a!==null&&PM(n,a)&&(t.flags|=32),L8(e,t),Ni(e,t,i,r),t.child;case 6:return e===null&&LM(t),null;case 13:return M8(e,t,r);case 4:return bF(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Qh(t,null,n,r):Ni(e,t,n,r),t.child;case 11:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:uc(n,o),R3(e,t,n,o,r);case 7:return Ni(e,t,t.pendingProps,r),t.child;case 8:return Ni(e,t,t.pendingProps.children,r),t.child;case 12:return Ni(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,o=t.pendingProps,a=t.memoizedProps,i=o.value,dn(qT,n._currentValue),n._currentValue=i,a!==null)if(hc(a.value,i)){if(a.children===o.children&&!ns.current){t=xu(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var s=a.dependencies;if(s!==null){i=a.child;for(var l=s.firstContext;l!==null;){if(l.context===n){if(a.tag===1){l=hu(-1,r&-r),l.tag=2;var c=a.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),NM(a.return,r,t),s.lanes|=r;break}l=l.next}}else if(a.tag===10)i=a.type===t.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(Me(341));i.lanes|=r,s=i.alternate,s!==null&&(s.lanes|=r),NM(i,r,t),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===t){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}Ni(e,t,o.children,r),t=t.child}return t;case 9:return o=t.type,n=t.pendingProps.children,Gh(t,r),o=yl(o),n=n(o),t.flags|=1,Ni(e,t,n,r),t.child;case 14:return n=t.type,o=uc(n,t.pendingProps),o=uc(n.type,o),U3(e,t,n,o,r);case 15:return I8(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:uc(n,o),IT(e,t),t.tag=1,os(n)?(e=!0,UT(t)):e=!1,Gh(t,r),P8(t,n,o),FM(t,n,o,r),zM(null,t,n,!0,e,r);case 19:return F8(e,t,r);case 22:return A8(e,t,r)}throw Error(Me(156,t.tag))};function J8(e,t){return SU(e,t)}function Ive(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hl(e,t,r,n){return new Ive(e,t,r,n)}function FF(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ave(e){if(typeof e=="function")return FF(e)?1:0;if(e!=null){if(e=e.$$typeof,e===ZM)return 11;if(e===eF)return 14}return 2}function zp(e,t){var r=e.alternate;return r===null?(r=hl(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function NT(e,t,r,n,o,a){var i=2;if(n=e,typeof e=="function")FF(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Nh:return bf(r.children,o,a,t);case QM:i=8,o|=8;break;case oM:return e=hl(12,r,t,o|2),e.elementType=oM,e.lanes=a,e;case aM:return e=hl(13,r,t,o),e.elementType=aM,e.lanes=a,e;case iM:return e=hl(19,r,t,o),e.elementType=iM,e.lanes=a,e;case iU:return mC(r,o,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case oU:i=10;break e;case aU:i=9;break e;case ZM:i=11;break e;case eF:i=14;break e;case Tp:i=16,n=null;break e}throw Error(Me(130,e==null?e:typeof e,""))}return t=hl(i,r,t,o),t.elementType=e,t.type=n,t.lanes=a,t}function bf(e,t,r,n){return e=hl(7,e,n,t),e.lanes=r,e}function mC(e,t,r,n){return e=hl(22,e,n,t),e.elementType=iU,e.lanes=r,e.stateNode={isHidden:!1},e}function tM(e,t,r){return e=hl(6,e,null,t),e.lanes=r,e}function rM(e,t,r){return t=hl(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Lve(e,t,r,n,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=BN(0),this.expirationTimes=BN(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=BN(0),this.identifierPrefix=n,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function OF(e,t,r,n,o,a,i,s,l){return e=new Lve(e,t,r,s,l),t===1?(t=1,a===!0&&(t|=8)):t=0,a=hl(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},yF(a),e}function Nve(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Lh,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function X8(e){if(!e)return Bp;e=e._reactInternals;e:{if(Pf(e)!==e||e.tag!==1)throw Error(Me(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(os(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Me(171))}if(e.tag===1){var r=e.type;if(os(r))return XU(e,r,t)}return t}function Q8(e,t,r,n,o,a,i,s,l){return e=OF(r,n,!0,e,o,a,i,s,l),e.context=X8(null),r=e.current,n=Mi(),o=jp(r),a=hu(n,o),a.callback=t!=null?t:null,Fp(r,a,o),e.current.lanes=o,ew(e,o,n),as(e,n),e}function fC(e,t,r,n){var o=t.current,a=Mi(),i=jp(o);return r=X8(r),t.context===null?t.context=r:t.pendingContext=r,t=hu(a,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Fp(o,t,i),e!==null&&(gc(e,o,i,a),PT(e,o,i)),i}function rC(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function tU(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function jF(e,t){tU(e,t),(e=e.alternate)&&tU(e,t)}function Mve(){return null}var Z8=typeof reportError=="function"?reportError:function(e){console.error(e)};function zF(e){this._internalRoot=e}gC.prototype.render=zF.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Me(409));fC(e,t,null,null)};gC.prototype.unmount=zF.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Tf(function(){fC(null,e,null,null)}),t[yu]=null}};function gC(e){this._internalRoot=e}gC.prototype.unstable_scheduleHydration=function(e){if(e){var t=AU();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Pp.length&&t!==0&&t<Pp[r].priority;r++);Pp.splice(r,0,e),r===0&&NU(e)}};function _F(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function hC(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function rU(){}function Fve(e,t,r,n,o){if(o){if(typeof n=="function"){var a=n;n=function(){var c=rC(i);a.call(c)}}var i=Q8(t,n,e,0,null,!1,!1,"",rU);return e._reactRootContainer=i,e[yu]=i.current,Hx(e.nodeType===8?e.parentNode:e),Tf(),i}for(;o=e.lastChild;)e.removeChild(o);if(typeof n=="function"){var s=n;n=function(){var c=rC(l);s.call(c)}}var l=OF(e,0,!1,null,null,!1,!1,"",rU);return e._reactRootContainer=l,e[yu]=l.current,Hx(e.nodeType===8?e.parentNode:e),Tf(function(){fC(t,l,r,n)}),l}function vC(e,t,r,n,o){var a=r._reactRootContainer;if(a){var i=a;if(typeof o=="function"){var s=o;o=function(){var l=rC(i);s.call(l)}}fC(t,i,e,o)}else i=Fve(r,t,e,o,n);return rC(i)}EU=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Px(t.pendingLanes);r!==0&&(nF(t,r|1),as(t,yo()),(vr&6)===0&&(tv=yo()+500,Rp()))}break;case 13:Tf(function(){var n=bu(e,1);if(n!==null){var o=Mi();gc(n,e,1,o)}}),jF(e,1)}};oF=function(e){if(e.tag===13){var t=bu(e,134217728);if(t!==null){var r=Mi();gc(t,e,134217728,r)}jF(e,134217728)}};IU=function(e){if(e.tag===13){var t=jp(e),r=bu(e,t);if(r!==null){var n=Mi();gc(r,e,t,n)}jF(e,t)}};AU=function(){return Gr};LU=function(e,t){var r=Gr;try{return Gr=e,t()}finally{Gr=r}};hM=function(e,t,r){switch(t){case"input":if(cM(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var o=sC(n);if(!o)throw Error(Me(90));lU(n),cM(n,o)}}}break;case"textarea":dU(e,r);break;case"select":t=r.value,t!=null&&Uh(e,!!r.multiple,t,!1)}};vU=LF;yU=Tf;var Ove={usingClientEntryPoint:!1,Events:[rw,jh,sC,gU,hU,LF]},kx={findFiberByHostInstance:gf,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},jve={bundleType:kx.bundleType,version:kx.version,rendererPackageName:kx.rendererPackageName,rendererConfig:kx.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:wu.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=wU(e),e===null?null:e.stateNode},findFiberByHostInstance:kx.findFiberByHostInstance||Mve,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"&&(Sx=__REACT_DEVTOOLS_GLOBAL_HOOK__,!Sx.isDisabled&&Sx.supportsFiber))try{nC=Sx.inject(jve),ud=Sx}catch(e){}var Sx;Rs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ove;Rs.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!_F(t))throw Error(Me(200));return Nve(e,t,null,r)};Rs.createRoot=function(e,t){if(!_F(e))throw Error(Me(299));var r=!1,n="",o=Z8;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=OF(e,1,!1,null,null,r,!1,n,o),e[yu]=t.current,Hx(e.nodeType===8?e.parentNode:e),new zF(t)};Rs.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Me(188)):(e=Object.keys(e).join(","),Error(Me(268,e)));return e=wU(t),e=e===null?null:e.stateNode,e};Rs.flushSync=function(e){return Tf(e)};Rs.hydrate=function(e,t,r){if(!hC(t))throw Error(Me(200));return vC(null,e,t,!0,r)};Rs.hydrateRoot=function(e,t,r){if(!_F(e))throw Error(Me(405));var n=r!=null&&r.hydratedSources||null,o=!1,a="",i=Z8;if(r!=null&&(r.unstable_strictMode===!0&&(o=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=Q8(t,null,e,1,r!=null?r:null,o,!1,a,i),e[yu]=t.current,Hx(e),n)for(e=0;e<n.length;e++)r=n[e],o=r._getVersion,o=o(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,o]:t.mutableSourceEagerHydrationData.push(r,o);return new gC(t)};Rs.render=function(e,t,r){if(!hC(t))throw Error(Me(200));return vC(null,e,t,!1,r)};Rs.unmountComponentAtNode=function(e){if(!hC(e))throw Error(Me(40));return e._reactRootContainer?(Tf(function(){vC(null,null,e,!1,function(){e._reactRootContainer=null,e[yu]=null})}),!0):!1};Rs.unstable_batchedUpdates=LF;Rs.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!hC(r))throw Error(Me(200));if(e==null||e._reactInternals===void 0)throw Error(Me(38));return vC(e,t,r,!1,n)};Rs.version="18.3.1-next-f1338f8080-20240426"});var vc=Ie((YBe,rV)=>{"use strict";function tV(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__=="undefined"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(tV)}catch(e){console.error(e)}}tV(),rV.exports=eV()});var wn=Ie(BF=>{"use strict";var nV=vc();BF.createRoot=nV.createRoot,BF.hydrateRoot=nV.hydrateRoot;var KBe});function Df(){if(document.head.querySelector("#journalit-image-styles"))return;let e=document.createElement("style");e.id="journalit-image-styles",e.textContent=zve,document.head.appendChild(e)}function oV(){let e=document.head.querySelector("#journalit-image-styles");e&&e.remove()}function yC(){Df()}var zve,ow=L(()=>{zve=`
  /* Image Uploader Styles - New Side-by-Side Layout */
  .journalit-image-upload-wrapper {
    margin-bottom: 12px;
    position: relative;
  }

  .journalit-image-upload-layout {
    display: flex;
    gap: 8px;
    min-height: 80px;
    width: 100%;
  }

  /* Paste Button Area - 1/3 Width */
  .journalit-image-upload-paste-area {
    flex: 0 0 calc(33.333% - 4px);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    background-color: var(--interactive-accent);
    color: var(--text-on-accent, white);
    border: 2px solid var(--interactive-accent);
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s ease;
    padding: 12px 8px;
    min-height: 80px;
    font-size: 13px;
    font-weight: 500;
    gap: 6px;
  }

  .journalit-image-upload-paste-area:hover {
    background-color: var(--interactive-accent-hover);
    border-color: var(--interactive-accent-hover);
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.2);
  }

  .journalit-image-upload-paste-area:disabled {
    background-color: var(--background-modifier-border);
    border-color: var(--background-modifier-border);
    color: var(--text-muted);
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
  }

  .journalit-image-upload-paste-area.pasting {
    background-color: var(--background-modifier-border);
    border-color: var(--background-modifier-border);
    color: var(--text-muted);
    cursor: wait;
  }

  .journalit-image-upload-paste-area .paste-icon {
    flex-shrink: 0;
    line-height: 1;
  }

  .journalit-image-upload-paste-area .paste-text {
    font-size: 12px;
    text-align: center;
    line-height: 1.2;
  }

  /* File Explorer Area - 2/3 Width */
  .journalit-image-upload-file-area {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 80px;
    border: 2px dashed var(--background-modifier-border);
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
    overflow: hidden;
    background-color: var(--background-secondary);
    padding: 12px;
  }

  .journalit-image-upload-file-area.full-width {
    flex: 1;
    min-width: 100%;
  }

  .journalit-image-upload-file-area:hover {
    border-color: var(--interactive-accent);
    background-color: rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.05);
  }

  .journalit-image-upload-file-area:focus {
    outline: 2px solid var(--interactive-accent);
    outline-offset: 2px;
    border-color: var(--interactive-accent);
    background-color: rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.08);
  }

  .journalit-image-upload-file-area.dragging-over {
    border-color: var(--interactive-accent);
    background-color: rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.1);
    transform: scale(1.02);
    box-shadow: 0 0 12px rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.3);
  }

  .journalit-image-upload-label {
    font-size: 14px;
    color: var(--text-muted);
    cursor: pointer;
    transition: all 0.2s ease;
    text-align: center;
    line-height: 1.3;
  }

  .journalit-image-upload-file-area:hover .journalit-image-upload-label {
    color: var(--interactive-accent);
  }

  .journalit-image-upload-input {
    display: none;
  }

  /* Drag overlay message for file area */
  .journalit-image-upload-file-area::after {
    content: "Drop image here";
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 16px;
    font-weight: 600;
    color: var(--interactive-accent);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s ease;
  }

  .journalit-image-upload-file-area.dragging-over::after {
    opacity: 1;
  }

  .journalit-image-upload-file-area.dragging-over .journalit-image-upload-label {
    opacity: 0;
  }

  /* Spinner for paste loading */
  .journalit-spinner {
    width: 12px;
    height: 12px;
    border: 2px solid var(--background-modifier-border);
    border-top: 2px solid var(--interactive-accent);
    border-radius: 50%;
    animation: journalit-spinner-rotate 1s linear infinite;
  }

  @keyframes journalit-spinner-rotate {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }

  /* Responsive Design for Image Upload */
  @media (max-width: 768px) {
    .journalit-image-upload-layout {
      flex-direction: column;
      gap: 6px;
    }

    .journalit-image-upload-paste-area {
      flex: 0 0 auto;
      min-height: 60px;
      flex-direction: row;
      gap: 8px;
      padding: 12px 16px;
    }

    .journalit-image-upload-file-area {
      flex: 1;
      min-height: 70px;
    }

    .journalit-image-upload-paste-area .paste-text {
      font-size: 13px;
    }
  }

  @media (max-width: 480px) {
    .journalit-image-upload-layout {
      gap: 4px;
    }

    .journalit-image-upload-paste-area {
      min-height: 50px;
      padding: 10px 12px;
      font-size: 12px;
    }

    .journalit-image-upload-file-area {
      min-height: 60px;
      padding: 8px;
    }

    .journalit-image-upload-label {
      font-size: 13px;
    }

    .journalit-image-upload-paste-area .paste-text {
      font-size: 11px;
    }
  }

  /* Image Display Styles */
  .journalit-image-viewer {
    position: relative;
    margin-bottom: 12px;
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    padding: 8px;
    background-color: var(--background-primary);
  }

  .journalit-image-container {
    position: relative;
    max-width: 100%;
    width: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .journalit-image {
    max-width: 100%;
    max-height: 300px;
    object-fit: contain;
    border-radius: 6px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    background-color: var(--background-primary);
    cursor: zoom-in;
  }

  .journalit-image-delete-button {
    position: absolute;
    top: 8px;
    right: 8px;
    background-color: rgba(229, 57, 53, 0.1);
    color: var(--color-error, #e53935);
    border: none;
    border-radius: 4px;
    padding: 6px 12px;
    font-size: 12px;
    cursor: pointer;
    transition: background-color 0.2s ease;
    z-index: 10;
  }

  .journalit-image-delete-button:hover {
    background-color: rgba(229, 57, 53, 0.2);
  }

  .journalit-image-error {
    color: var(--text-error, var(--color-red, #e53935));
    font-size: 12px;
    text-align: center;
    margin-top: 4px;
    margin-bottom: 8px;
    padding: 6px 10px;
    background-color: rgba(229, 57, 53, 0.1);
    border-radius: 4px;
    width: 100%;
  }

  /* Fullscreen Styles - Borderless Design */
  .journalit-fullscreen-portal-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 0;
    height: 0;
    z-index: 4000;
    pointer-events: none;
  }

  .journalit-fullscreen-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-color: rgba(0, 0, 0, 0.9);
    z-index: 10000; /* Reduced from original 1000000 */
    display: flex;
    align-items: center;
    justify-content: center;
    animation: journalit-fade-in 0.3s ease-in-out;
    cursor: pointer; /* Indicate clickable backdrop */
    pointer-events: auto; /* Enable backdrop click-to-close */
    /* Ensure this doesn't interfere with normal page flow */
    contain: layout style paint;
  }

  /* Overlay UI Elements */
  .journalit-fullscreen-overlay-ui {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    pointer-events: none; /* Default to none, specific elements override */
    z-index: 10001; /* Slightly above overlay */
    /* Ensure this doesn't interfere with normal page flow */
    contain: layout style paint;
  }

  .journalit-fullscreen-title {
    position: absolute;
    top: 20px;
    left: 20px;
    color: var(--text-on-accent);
    font-size: 16px;
    font-weight: 500;
    background-color: rgba(0, 0, 0, 0.8);
    padding: 8px 12px;
    border-radius: 6px;
    pointer-events: auto; /* Enable interaction */
  }

  .journalit-fullscreen-close-btn {
    position: absolute;
    top: 20px;
    right: 20px;
    width: 40px;
    height: 40px;
    background-color: rgba(0, 0, 0, 0.8);
    color: var(--text-on-accent);
    border: none;
    border-radius: 50%;
    font-size: 24px;
    font-weight: 300;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
    pointer-events: auto; /* Enable interaction */
  }

  .journalit-fullscreen-close-btn:hover {
    background-color: rgba(0, 0, 0, 1.0);
    transform: scale(1.1);
  }

  .journalit-fullscreen-content-wrapper {
    width: 100vw;
    height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    pointer-events: none; /* Let clicks pass through to backdrop */
    /* Ensure this doesn't interfere with normal page flow */
    contain: layout style paint;
    isolation: isolate;
  }

  .journalit-fullscreen-content {
    pointer-events: auto; /* Re-enable interaction for actual content */
  }

  /* Image Carousel Styles */
  .journalit-image-carousel {
    width: 100%;
    margin-bottom: 16px;
    background-color: var(--background-secondary);
    border-radius: 6px;
    padding: 12px;
  }

  .journalit-carousel-main {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 8px;
    margin-bottom: 8px;
    position: relative;
    width: 100%;
  }

  .journalit-carousel-image-container {
    flex: 1;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 200px;
    width: 100%;
    position: relative;
    background-color: var(--background-primary);
    border-radius: 4px;
  }

  .journalit-carousel-button {
    width: 36px;
    height: 36px;
    min-width: 36px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    border: 1px solid var(--background-modifier-border);
    border-radius: 50%;
    font-size: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s ease;
    z-index: 20;
  }

  .journalit-carousel-button:hover {
    background-color: var(--background-modifier-hover);
    transform: translateY(-1px);
  }

  .journalit-carousel-counter {
    text-align: center;
    font-size: 12px;
    color: var(--text-muted);
    margin: 4px 0;
  }

  .journalit-carousel-thumbnails {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-top: 4px;
    justify-content: center;
  }

  .journalit-carousel-thumbnail {
    width: 60px;
    height: 60px;
    border: 2px solid var(--background-modifier-border);
    border-radius: 4px;
    overflow: hidden;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .journalit-carousel-thumbnail:hover {
    transform: translateY(-2px);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  }

  .journalit-carousel-thumbnail.active {
    border-color: var(--interactive-accent);
    box-shadow: 0 0 0 2px var(--interactive-accent);
  }

  .journalit-carousel-thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  /* Animations */
  @keyframes journalit-fade-in {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  @keyframes journalit-zoom-in {
    from { transform: scale(0.9); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
  }

  /* Hold to zoom indicator */
  .journalit-image-zoom-indicator {
    position: absolute;
    bottom: 8px;
    right: 8px;
    background-color: rgba(0, 0, 0, 0.6);
    color: var(--text-on-accent);
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 10px;
    opacity: 0;
    transition: opacity 0.2s ease;
    pointer-events: none;
  }

  .journalit-image-container:hover .journalit-image-zoom-indicator {
    opacity: 1;
  }

  /* Enhanced Fullscreen Viewer Styles - Full Viewport */
  .journalit-fullscreen-viewer {
    position: relative;
    width: 100vw;
    height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    /* Ensure this doesn't interfere with normal page flow */
    contain: layout style paint;
    isolation: isolate;
  }

  .journalit-fullscreen-image-wrapper {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100vw;
    height: 100vh;
    overflow: hidden;
    /* Ensure this doesn't interfere with normal page flow */
    contain: layout style paint;
  }

  .journalit-fullscreen-zoomable-image {
    max-width: 90vw;
    max-height: 90vh;
    object-fit: contain;
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    transform-origin: center;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
  }

  /* Navigation buttons - repositioned to middle sides */
  .journalit-fullscreen-nav-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 45px;
    height: 45px;
    background-color: rgba(0, 0, 0, 0.8);
    color: var(--text-on-accent);
    border: none;
    border-radius: 50%;
    font-size: 20px;
    font-weight: bold;
    cursor: pointer;
    z-index: 10;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0.8;
    pointer-events: auto; /* Enable interaction */
  }

  .journalit-fullscreen-nav-btn:hover {
    background-color: rgba(0, 0, 0, 1.0);
    transform: translateY(-50%) scale(1.1);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
    opacity: 1;
  }

  .journalit-fullscreen-nav-prev {
    left: 20px;
  }

  .journalit-fullscreen-nav-next {
    right: 20px;
  }

  /* Navigation indicator - moved to bottom center */
  .journalit-fullscreen-nav-indicator {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background-color: rgba(0, 0, 0, 0.8);
    color: var(--text-on-accent);
    padding: 8px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 500;
    z-index: 10;
  }

  /* Zoom indicator - moved to bottom left */
  .journalit-fullscreen-zoom-indicator {
    position: absolute;
    bottom: 20px;
    left: 20px;
    background-color: rgba(0, 0, 0, 0.8);
    color: var(--text-on-accent);
    padding: 8px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 500;
    z-index: 10;
    opacity: 0;
    transition: opacity 0.3s ease;
    pointer-events: none;
  }

  .journalit-fullscreen-viewer:hover .journalit-fullscreen-zoom-indicator {
    opacity: 1;
  }

  /* Smooth zoom transition */
  .journalit-fullscreen-zoomable-image.zooming {
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  /* Responsive navigation buttons */
  @media (max-width: 768px) {
    .journalit-fullscreen-nav-btn {
      width: 40px;
      height: 40px;
      font-size: 20px;
    }
    
    .journalit-fullscreen-nav-prev {
      left: 10px;
    }
    
    .journalit-fullscreen-nav-next {
      right: 10px;
    }
    
    .journalit-fullscreen-nav-indicator {
      bottom: 15px;
      font-size: 11px;
      padding: 6px 10px;
    }
    
    .journalit-fullscreen-zoom-indicator {
      top: 15px;
      right: 15px;
      font-size: 11px;
      padding: 6px 10px;
    }
  }
`});var aV,_ve,$F,bC,iV,WF=L(()=>{aV=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),_ve=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),$F=e=>{let t=_ve(e);return t.charAt(0).toUpperCase()+t.slice(1)},bC=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),iV=e=>{for(let t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0}});var sV,lV=L(()=>{sV={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"}});var aw,cV,dV=L(()=>{aw=q(Y());lV();WF();cV=(0,aw.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:o="",children:a,iconNode:i,...s},l)=>(0,aw.createElement)("svg",{ref:l,...sV,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:bC("lucide",o),...!a&&!iV(s)&&{"aria-hidden":"true"},...s},[...i.map(([c,d])=>(0,aw.createElement)(c,d)),...Array.isArray(a)?a:[a]]))});var xC,pe,Ve=L(()=>{xC=q(Y());WF();dV();pe=(e,t)=>{let r=(0,xC.forwardRef)(({className:n,...o},a)=>(0,xC.createElement)(cV,{ref:a,iconNode:t,className:bC(`lucide-${aV($F(e))}`,`lucide-${e}`,n),...o}));return r.displayName=$F(e),r}});var Bve,iw,uV=L(()=>{Ve();Bve=[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M17 10V4h-2",key:"zcsr5x"}],["path",{d:"M15 10h4",key:"id2lce"}],["rect",{x:"15",y:"14",width:"4",height:"6",ry:"2",key:"33xykx"}]],iw=pe("arrow-down-1-0",Bve)});var $ve,Up,pV=L(()=>{Ve();$ve=[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]],Up=pe("arrow-down-wide-narrow",$ve)});var Wve,Vp,mV=L(()=>{Ve();Wve=[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M15 4h5l-5 6h5",key:"8asdl1"}],["path",{d:"M15 20v-3.5a2.5 2.5 0 0 1 5 0V20",key:"r6l5cz"}],["path",{d:"M20 18h-5",key:"18j1r2"}]],Vp=pe("arrow-down-z-a",Wve)});var Rve,sw,fV=L(()=>{Ve();Rve=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],sw=pe("arrow-right",Rve)});var Uve,lw,gV=L(()=>{Ve();Uve=[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["rect",{x:"15",y:"4",width:"4",height:"6",ry:"2",key:"1bwicg"}],["path",{d:"M17 20v-6h-2",key:"1qp1so"}],["path",{d:"M15 20h4",key:"1j968p"}]],lw=pe("arrow-up-0-1",Uve)});var Vve,Hp,hV=L(()=>{Ve();Vve=[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M20 8h-5",key:"1vsyxs"}],["path",{d:"M15 10V6.5a2.5 2.5 0 0 1 5 0V10",key:"ag13bf"}],["path",{d:"M15 14h5l-5 6h5",key:"ur5jdg"}]],Hp=pe("arrow-up-a-z",Vve)});var Hve,cw,vV=L(()=>{Ve();Hve=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],cw=pe("arrow-up-down",Hve)});var qve,qp,yV=L(()=>{Ve();qve=[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]],qp=pe("arrow-up-narrow-wide",qve)});var Gve,dw,bV=L(()=>{Ve();Gve=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],dw=pe("award",Gve)});var Yve,Gp,xV=L(()=>{Ve();Yve=[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Gp=pe("badge-check",Yve)});var Kve,uw,wV=L(()=>{Ve();Kve=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],uw=pe("ban",Kve)});var Jve,Ef,kV=L(()=>{Ve();Jve=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Ef=pe("book-open",Jve)});var Xve,ku,SV=L(()=>{Ve();Xve=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],ku=pe("brain",Xve)});var Qve,If,TV=L(()=>{Ve();Qve=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]],If=pe("calendar-check",Qve)});var Zve,Af,CV=L(()=>{Ve();Zve=[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M17 14h-6",key:"bkmgh3"}],["path",{d:"M13 18H7",key:"bb0bb7"}],["path",{d:"M7 14h.01",key:"1qa3f1"}],["path",{d:"M17 18h.01",key:"1bdyru"}]],Af=pe("calendar-range",Zve)});var eye,Su,PV=L(()=>{Ve();eye=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Su=pe("calendar",eye)});var tye,$a,DV=L(()=>{Ve();tye=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],$a=pe("chart-column",tye)});var rye,Mo,EV=L(()=>{Ve();rye=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Mo=pe("check",rye)});var nye,pw,IV=L(()=>{Ve();nye=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],pw=pe("chevron-down",nye)});var oye,Yp,AV=L(()=>{Ve();oye=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Yp=pe("circle-alert",oye)});var aye,Qo,LV=L(()=>{Ve();aye=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Qo=pe("circle-check",aye)});var iye,Tu,NV=L(()=>{Ve();iye=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],Tu=pe("circle-plus",iye)});var sye,yc,MV=L(()=>{Ve();sye=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],yc=pe("circle-question-mark",sye)});var lye,mw,FV=L(()=>{Ve();lye=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],mw=pe("circle",lye)});var cye,fw,OV=L(()=>{Ve();cye=[["path",{d:"M11 14h10",key:"1w8e9d"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v1.344",key:"1e62lh"}],["path",{d:"m17 18 4-4-4-4",key:"z2g111"}],["path",{d:"M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 1.793-1.113",key:"bjbb7m"}],["rect",{x:"8",y:"2",width:"8",height:"4",rx:"1",key:"ublpy"}]],fw=pe("clipboard-paste",cye)});var dye,xl,jV=L(()=>{Ve();dye=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],xl=pe("clock",dye)});var uye,wl,zV=L(()=>{Ve();uye=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],wl=pe("copy",uye)});var pye,Kp,_V=L(()=>{Ve();pye=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],Kp=pe("ellipsis",pye)});var mye,gw,BV=L(()=>{Ve();mye=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],gw=pe("external-link",mye)});var fye,hw,$V=L(()=>{Ve();fye=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],hw=pe("eye-off",fye)});var gye,vw,WV=L(()=>{Ve();gye=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],vw=pe("eye",gye)});var hye,md,RV=L(()=>{Ve();hye=[["path",{d:"M12.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v9.5",key:"1couwa"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M13.378 15.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1y4qbx"}]],md=pe("file-pen",hye)});var vye,yw,UV=L(()=>{Ve();vye=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],yw=pe("file-text",vye)});var yye,bw,VV=L(()=>{Ve();yye=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],bw=pe("file",yye)});var bye,xw,HV=L(()=>{Ve();bye=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],xw=pe("flask-conical",bye)});var xye,ww,qV=L(()=>{Ve();xye=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],ww=pe("folder-open",xye)});var wye,Lf,GV=L(()=>{Ve();wye=[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]],Lf=pe("folder-tree",wye)});var kye,Jp,YV=L(()=>{Ve();kye=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Jp=pe("funnel",kye)});var Sye,kw,KV=L(()=>{Ve();Sye=[["path",{d:"M10.5 3 8 9l4 13 4-13-2.5-6",key:"b3dvk1"}],["path",{d:"M17 3a2 2 0 0 1 1.6.8l3 4a2 2 0 0 1 .013 2.382l-7.99 10.986a2 2 0 0 1-3.247 0l-7.99-10.986A2 2 0 0 1 2.4 7.8l2.998-3.997A2 2 0 0 1 7 3z",key:"7w4byz"}],["path",{d:"M2 9h20",key:"16fsjt"}]],kw=pe("gem",Sye)});var Tye,Sw,JV=L(()=>{Ve();Tye=[["path",{d:"M9 10h.01",key:"qbtxuw"}],["path",{d:"M15 10h.01",key:"1qmjsl"}],["path",{d:"M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z",key:"uwwb07"}]],Sw=pe("ghost",Tye)});var Cye,Cu,XV=L(()=>{Ve();Cye=[["path",{d:"M12 3v17a1 1 0 0 1-1 1H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v6a1 1 0 0 1-1 1H3",key:"11za1p"}],["path",{d:"M16 19h6",key:"xwg31i"}],["path",{d:"M19 22v-6",key:"qhmiwi"}]],Cu=pe("grid-2x2-plus",Cye)});var Pye,Tw,QV=L(()=>{Ve();Pye=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],Tw=pe("grip-vertical",Pye)});var Dye,Nf,ZV=L(()=>{Ve();Dye=[["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"19",cy:"5",r:"1",key:"w8mnmm"}],["circle",{cx:"5",cy:"5",r:"1",key:"lttvr7"}],["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}],["circle",{cx:"19",cy:"19",r:"1",key:"shf9b7"}],["circle",{cx:"5",cy:"19",r:"1",key:"bfqh0e"}]],Nf=pe("grip",Dye)});var Eye,Mf,eH=L(()=>{Ve();Eye=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m8 11 4 4 4-4",key:"1dohi6"}],["path",{d:"M8 5H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-4",key:"1ywtjm"}]],Mf=pe("import",Eye)});var Iye,Xp,tH=L(()=>{Ve();Iye=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Xp=pe("info",Iye)});var Aye,Cw,rH=L(()=>{Ve();Aye=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],Cw=pe("key",Aye)});var Lye,bc,nH=L(()=>{Ve();Lye=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],bc=pe("lock",Lye)});var Nye,Pw,oH=L(()=>{Ve();Nye=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Pw=pe("message-circle",Nye)});var Mye,kl,aH=L(()=>{Ve();Mye=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],kl=pe("plus",Mye)});var Fye,Ff,iH=L(()=>{Ve();Fye=[["path",{d:"M16.247 7.761a6 6 0 0 1 0 8.478",key:"1fwjs5"}],["path",{d:"M19.075 4.933a10 10 0 0 1 0 14.134",key:"ehdyv1"}],["path",{d:"M4.925 19.067a10 10 0 0 1 0-14.134",key:"1q22gi"}],["path",{d:"M7.753 16.239a6 6 0 0 1 0-8.478",key:"r2q7qm"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Ff=pe("radio",Fye)});var Oye,Dw,sH=L(()=>{Ve();Oye=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Dw=pe("refresh-cw",Oye)});var jye,Ew,lH=L(()=>{Ve();jye=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],Ew=pe("rocket",jye)});var zye,Of,cH=L(()=>{Ve();zye=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Of=pe("rotate-ccw",zye)});var _ye,Iw,dH=L(()=>{Ve();_ye=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Iw=pe("settings",_ye)});var Bye,Aw,uH=L(()=>{Ve();Bye=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Aw=pe("shield",Bye)});var $ye,Lw,pH=L(()=>{Ve();$ye=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],Lw=pe("sliders-horizontal",$ye)});var Wye,fd,mH=L(()=>{Ve();Wye=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],fd=pe("sparkles",Wye)});var Rye,gd,fH=L(()=>{Ve();Rye=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],gd=pe("square-check-big",Rye)});var Uye,Fo,gH=L(()=>{Ve();Uye=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Fo=pe("square-pen",Uye)});var Vye,Nw,hH=L(()=>{Ve();Vye=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Nw=pe("square",Vye)});var Hye,Pu,vH=L(()=>{Ve();Hye=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Pu=pe("tag",Hye)});var qye,ov,yH=L(()=>{Ve();qye=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],ov=pe("target",qye)});var Gye,Mw,bH=L(()=>{Ve();Gye=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Mw=pe("trash-2",Gye)});var Yye,jf,xH=L(()=>{Ve();Yye=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],jf=pe("trash",Yye)});var Kye,Fw,wH=L(()=>{Ve();Kye=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],Fw=pe("trending-down",Kye)});var Jye,xc,kH=L(()=>{Ve();Jye=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],xc=pe("trending-up",Jye)});var Xye,lo,SH=L(()=>{Ve();Xye=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],lo=pe("triangle-alert",Xye)});var Qye,Ow,TH=L(()=>{Ve();Qye=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Ow=pe("user",Qye)});var Zye,Du,CH=L(()=>{Ve();Zye=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Du=pe("users",Zye)});var ebe,Us,PH=L(()=>{Ve();ebe=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Us=pe("x",ebe)});var tbe,Eu,DH=L(()=>{Ve();tbe=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Eu=pe("zap",tbe)});var er=L(()=>{pV();mV();hV();yV();xV();DV();AV();LV();NV();MV();_V();RV();YV();XV();mH();fH();gH();SH();fV();vV();bV();wV();kV();SV();TV();CV();PV();EV();IV();FV();OV();jV();zV();BV();$V();WV();UV();VV();HV();qV();GV();KV();JV();QV();ZV();eH();tH();rH();nH();oH();aH();iH();sH();lH();cH();dH();uH();pH();hH();vH();yH();bH();xH();wH();kH();TH();CH();PH();DH();uV();gV();});var si,zf,wC=L(()=>{si=q(Y()),zf=({options:e,selectedValue:t,onSelect:r,className:n="",variant:o="default"})=>{let a=o==="goal"?"goal-options":"radio-options",i=o==="goal"?"goal-option":"radio-option",s=o==="goal"?"goal-radio":"option-radio",l=o==="goal"?"goal-radio-inner":"radio-inner",c=o==="goal"?"goal-content":"option-content";return si.default.createElement("div",{className:`${a} ${n}`},e.map((d,u)=>si.default.createElement("div",{key:d.value,className:`${i} ${t===d.value?"selected":""}`,onClick:()=>r(d.value),role:"button",tabIndex:0,autoFocus:u===0,onKeyPress:p=>p.key==="Enter"&&r(d.value)},si.default.createElement("div",{className:s},si.default.createElement("div",{className:`${l} ${t===d.value?"selected":""}`})),si.default.createElement("div",{className:c},o==="goal"?si.default.createElement(si.default.Fragment,null,si.default.createElement("h3",null,d.icon&&si.default.createElement("span",{style:{marginRight:"8px"}},d.icon),d.label),d.description&&si.default.createElement("p",null,d.description),d.badge&&si.default.createElement("span",{className:"goal-badge"},d.badge)):si.default.createElement(si.default.Fragment,null,si.default.createElement("span",{className:"option-label"},d.label),d.description&&si.default.createElement("span",{className:"option-description"},d.description))))))}});var Tt,rbe,nbe,EH,obe,IH,AH=L(()=>{Tt=q(Y());er();wC();rbe={display:"inline",marginRight:"8px"},nbe=({type:e})=>{let t={size:16,style:rbe};switch(e){case"regular":return Tt.default.createElement(xc,{...t});case"missed":return Tt.default.createElement(lo,{...t});case"backtest":return Tt.default.createElement(xw,{...t});default:return Tt.default.createElement(xc,{...t})}},EH=[{value:"regular",label:"Regular Trade",description:"Normal trade with full entry and exit data"},{value:"missed",label:"Missed Trade",description:"Trade opportunity that you missed - PnL and Account fields optional"},{value:"backtest",label:"Backtest Trade",description:"Backtesting scenario for analysis purposes"}],obe=({data:e,onChange:t})=>{let[r,n]=(0,Tt.useState)(!1),o=(0,Tt.useRef)(null),[a,i]=(0,Tt.useState)(0),s=(0,Tt.useMemo)(()=>e.isMissedTrade?"missed":e.isBacktestTrade?"backtest":"regular",[e.isMissedTrade,e.isBacktestTrade]);(0,Tt.useEffect)(()=>{if(o.current){let k=o.current.scrollHeight;i(k)}},[r,s,e.missedReason]);let l=(0,Tt.useCallback)(k=>{t("isMissedTrade",!1),t("isBacktestTrade",!1),k==="missed"?t("isMissedTrade",!0):k==="backtest"&&t("isBacktestTrade",!0)},[t]),c=(0,Tt.useMemo)(()=>{let k=EH.find(T=>T.value===s);return k?k.label:"Regular Trade"},[s]),d=(0,Tt.useCallback)(()=>{n(!r)},[r]),u=(0,Tt.useCallback)(k=>{(k.key==="Enter"||k.key===" ")&&(k.preventDefault(),n(!r))},[r]),p=(0,Tt.useCallback)(k=>{t("missedReason",k.target.value)},[t]),m=(0,Tt.useMemo)(()=>({marginBottom:"16px",border:r?"1px solid var(--background-modifier-border)":"none",borderRadius:"8px",backgroundColor:r?"var(--background-secondary)":"transparent"}),[r]),f=(0,Tt.useMemo)(()=>({display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 16px",cursor:"pointer",userSelect:"none",border:r?"none":"1px solid var(--background-modifier-border)",borderRadius:r?"none":"8px",backgroundColor:r?"transparent":"var(--background-primary)"}),[r]),g=(0,Tt.useMemo)(()=>({fontWeight:"600",color:"var(--text-normal)",cursor:"pointer",marginRight:"8px"}),[]),v=(0,Tt.useMemo)(()=>({fontSize:"14px",color:"var(--text-muted)",fontWeight:"500",display:"flex",alignItems:"center"}),[]),h=(0,Tt.useMemo)(()=>({color:"var(--text-muted)",transform:r?"rotate(0deg)":"rotate(-90deg)",transition:"transform 0.2s ease"}),[r]),y=(0,Tt.useMemo)(()=>({height:r?`${a}px`:"0px",overflow:"hidden",opacity:r?1:0,visibility:r?"visible":"hidden",transition:r?"height 0.3s ease, opacity 0.2s ease 0.1s, visibility 0s ease 0s":"height 0.25s ease, opacity 0.15s ease, visibility 0s ease 0s",borderTop:r?"1px solid var(--background-modifier-border)":"none"}),[r,a]),b=(0,Tt.useMemo)(()=>({padding:r?"16px":"0"}),[r]),x=(0,Tt.useMemo)(()=>({margin:"0 0 16px 0",fontSize:"13px",color:"var(--text-muted)",lineHeight:"1.4"}),[]),w=(0,Tt.useMemo)(()=>({marginTop:"16px"}),[]),S=(0,Tt.useMemo)(()=>({width:"100%",padding:"8px",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",backgroundColor:"var(--background-primary)",color:"var(--text-normal)",fontSize:"14px",fontFamily:"inherit",resize:"vertical"}),[]);return Tt.default.createElement("div",{className:"field"},Tt.default.createElement("div",{className:"trade-type-selector",style:m},Tt.default.createElement("div",{onClick:d,role:"button","aria-expanded":r,tabIndex:0,onKeyDown:u,style:f},Tt.default.createElement("div",null,Tt.default.createElement("label",{style:g},"Trade Type"),Tt.default.createElement("span",{style:v},Tt.default.createElement(nbe,{type:s}),c)),Tt.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:h},Tt.default.createElement("polyline",{points:"6 9 12 15 18 9"}))),Tt.default.createElement("div",{style:y},Tt.default.createElement("div",{ref:o,style:b},Tt.default.createElement("p",{style:x},"Choose the type of trade you're creating"),Tt.default.createElement(zf,{options:EH,selectedValue:s,onSelect:l,variant:"default"}),s==="missed"&&Tt.default.createElement("div",{className:"field",style:w},Tt.default.createElement("label",{className:"label"},"Why did you miss this trade?"),Tt.default.createElement("textarea",{value:e.missedReason||"",onChange:p,placeholder:"Describe why you missed this trade opportunity...",rows:3,className:"textarea",style:S}))))))},IH=(0,Tt.memo)(obe,(e,t)=>e.data.isMissedTrade===t.data.isMissedTrade&&e.data.isBacktestTrade===t.data.isBacktestTrade&&e.data.missedReason===t.data.missedReason&&e.onChange===t.onChange)});var is,$r,hd=L(()=>{is=q(Y()),$r=is.default.forwardRef(({className:e="",id:t,label:r,error:n,helperText:o,disabled:a=!1,size:i="md",variant:s="default",loading:l=!1,onChange:c,multiline:d=!1,rows:u=3,required:p=!1,...m},f)=>{let g=(0,is.useId)(),v=t||`input-${g}`,h=`helper-${v}`,y=`error-${v}`,[b,x]=(0,is.useState)(!1),w=typeof m.value=="string"&&(m.value==="0"||m.value==="0.00"||/^0\.0+$/.test(m.value)),S=["input",i,s,n?"error":"",w?"default-value":"",e].filter(Boolean).join(" "),k=["inputContainer",l?"loading":""].filter(Boolean).join(" ");return is.default.createElement("div",{className:k},r&&is.default.createElement("label",{htmlFor:v,className:"label"},r,p&&is.default.createElement("span",{className:"required-indicator"},"*")),is.default.createElement("div",{className:"inputWrapper"},d?is.default.createElement("textarea",{id:v,className:S,disabled:a||l,"aria-invalid":!!n,"aria-describedby":n?y:o?h:void 0,rows:u,onFocus:D=>{x(!0)},onBlur:D=>{x(!1)},onChange:D=>{c&&c(D.target.value)},value:m.value,placeholder:m.placeholder}):is.default.createElement("input",{ref:f,id:v,className:S,disabled:a||l,"aria-invalid":!!n,"aria-describedby":n?y:o?h:void 0,onFocus:D=>{var O;x(!0),(O=m.onFocus)==null||O.call(m,D)},onBlur:D=>{var O;x(!1),(O=m.onBlur)==null||O.call(m,D)},onChange:D=>{c&&c(D.target.value)},...m})),n&&is.default.createElement("div",{id:y,className:"errorMessage",role:"alert"},n),!n&&o&&is.default.createElement("div",{id:h,className:"helperText"},o))});$r.displayName="Input"});var Sl,En,vd=L(()=>{Sl=q(Y()),En=Sl.default.forwardRef(({className:e="",id:t,label:r,options:n=[],error:o,helperText:a,disabled:i=!1,size:s="md",placeholder:l="Select an option",onChange:c,...d},u)=>{let p=(0,Sl.useId)(),m=t||`select-${p}`,f=`helper-${m}`,g=`error-${m}`,v=["select",s,o?"error":"",e,"journalit-select"].filter(Boolean).join(" "),h=y=>{c&&c(y.target.value),y.target&&y.target.setAttribute("data-has-value",y.target.value?"true":"false")};return Sl.default.createElement("div",{className:"selectContainer"},r&&Sl.default.createElement("label",{htmlFor:m,className:"label"},r),Sl.default.createElement("div",{className:"selectWrapper"},Sl.default.createElement("select",{ref:u,id:m,className:v,disabled:i,"data-has-value":d.value||d.defaultValue?"true":"false","aria-invalid":!!o,"aria-describedby":o?g:a?f:void 0,onChange:h,style:{color:d.value?"var(--text-normal)":"var(--text-muted)",opacity:d.value?1:.7},...d},!d.value&&!d.defaultValue&&Sl.default.createElement("option",{value:"",disabled:!0,className:"select-placeholder",style:{color:"var(--text-muted)",opacity:.9,padding:"8px",fontSize:"14px",lineHeight:"normal",height:"auto"}},l),n.map(y=>Sl.default.createElement("option",{key:y.value,value:y.value,style:{color:"var(--text-normal)",opacity:1}},y.label)))),o&&Sl.default.createElement("div",{id:g,className:"errorMessage",role:"alert"},o),!o&&a&&Sl.default.createElement("div",{id:f,className:"helperText"},a))});En.displayName="Select"});var Wa,jw,RF,LH,UF,NH=L(()=>{Wa=q(Y());hd();jw=e=>{if(!e)return"";if(typeof e=="string")return/^\d{4}-\d{2}-\d{2}$/.test(e)?e:"";let t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${n}`},RF=e=>{if(!e)return"";if(typeof e=="string")return/^\d{1,2}:\d{2}$/.test(e)?e:"";let t=String(e.getHours()).padStart(2,"0"),r=String(e.getMinutes()).padStart(2,"0");return`${t}:${r}`},LH=(e,t)=>{try{if(!e)return null;let[r,n,o]=e.split("-").map(Number),a=new Date(r,n-1,o);if(t){let[i,s]=t.split(":").map(Number);a.setHours(i,s)}return a}catch(r){return null}},UF=({label:e,value:t,onChange:r,error:n,helperText:o,disabled:a=!1,className:i,includeTime:s=!1,timeOnly:l=!1,minDate:c,maxDate:d,required:u=!1,...p})=>{let m=(0,Wa.useId)(),f=`date-${m}`,g=`time-${m}`,[v,h]=(0,Wa.useState)(!1),[y,b]=(0,Wa.useState)(""),[x,w]=(0,Wa.useState)(""),S=(0,Wa.useMemo)(()=>v?y:jw(t),[v,y,t]),k=(0,Wa.useMemo)(()=>v?x:RF(t),[v,x,t]),T=(0,Wa.useCallback)(I=>{if(v?b(I):(h(!0),b(I),w(RF(t))),I){let A=v?x:RF(t),j=LH(I,A);j&&r&&r(j)}else r&&r(void 0)},[v,x,t,r,l]),P=(0,Wa.useCallback)(I=>{if(v||(h(!0),b(jw(t))),w(I),l)I&&r?r(I):r&&!I&&r(void 0);else{let A=v?y:jw(t);if(A&&I){let j=LH(A,I);j&&r&&r(j)}}},[v,y,t,r,l]),D=(0,Wa.useCallback)(()=>{h(!1),b(""),w("")},[]),O=c?jw(c):void 0,z=d?jw(d):void 0;return Wa.default.createElement("div",{className:"date-picker-container",style:{position:"relative"}},!l&&Wa.default.createElement($r,{id:f,label:e,type:"date",value:S,onChange:T,onBlur:D,error:n,helperText:o,disabled:a,className:i,min:O,max:z,required:u,...p}),(s||l)&&Wa.default.createElement($r,{id:g,label:l?e:void 0,type:"time",value:k,onChange:P,onBlur:D,error:l?n:void 0,helperText:l?o:void 0,disabled:a,className:l?i:"time-input","aria-label":l?void 0:"Time",style:l?{}:{marginTop:"8px"},required:l?u:!1,...l?p:{}}))};UF.displayName="DatePicker"});function bo(e){let t=e.getDay(),r=t===0?6:t-1,n=new Date(e);return n.setDate(e.getDate()-r),n.setHours(0,0,0,0),n}function VF(e,t=!0){let r=new Date(e);if(!t)return r.setDate(r.getDate()+1),r;r.setDate(r.getDate()+1);let n=r.getDay();return n===0?r.setDate(r.getDate()+1):n===6&&r.setDate(r.getDate()+2),r}function HF(e,t=!0){let r=new Date(e);if(!t)return r.setDate(r.getDate()-1),r;r.setDate(r.getDate()-1);let n=r.getDay();return n===0?r.setDate(r.getDate()-2):n===6&&r.setDate(r.getDate()-1),r}function Qp(e){if(e.getFullYear()===2025&&e.getMonth()===2){if(e.getDate()>=10&&e.getDate()<=16)return 11;if(e.getDate()===31)return 14}let t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()));t.setUTCDate(t.getUTCDate()+4-(t.getUTCDay()||7));let r=new Date(Date.UTC(t.getUTCFullYear(),0,1));return Math.ceil(((t.getTime()-r.getTime())/864e5+1)/7)}function ss(e){return`W${Qp(e).toString().padStart(2,"0")}`}function kC(e){var t,r,n,o,a,i,s,l,c,d;if(e&&e.settings&&e.settings.trade)return e.settings.trade.skipWeekends!==!1;try{if(((n=(r=(t=window.journalitPlugin)==null?void 0:t.settings)==null?void 0:r.trade)==null?void 0:n.skipWeekends)!==void 0)return window.journalitPlugin.settings.trade.skipWeekends;if((a=(o=window.journalitPlugin)==null?void 0:o.settings)!=null&&a.trade){window.journalitPlugin.settings.trade.skipWeekends=!0;try{window.journalitPlugin.saveSettings()}catch(p){console.error("Failed to save settings after setting skipWeekends",p)}return!0}let u=window.JournalitPlugin;if(((l=(s=(i=u==null?void 0:u.instance)==null?void 0:i.settings)==null?void 0:s.trade)==null?void 0:l.skipWeekends)!==void 0)return u.instance.settings.trade.skipWeekends;if((d=(c=u==null?void 0:u.instance)==null?void 0:c.settings)!=null&&d.trade){u.instance.settings.trade.skipWeekends=!0;try{u.instance.saveSettings()}catch(p){console.error("Failed to save settings after setting skipWeekends via static instance",p)}return!0}return!0}catch(u){return console.warn("Error accessing plugin settings, using default (skip weekends)"),!0}}function Kn(e,t=!0){let r;typeof e=="string"?r=new Date(e):r=e;let n=r.getFullYear(),o=r.getMonth(),a=r.getDate(),i=new Date(n,o,a);return t?i.setHours(0,0,0,0):i.setHours(23,59,59,999),i}function rt(e,t="DDMMYY",r="/"){if(!e)return"Unknown";let n=e;if(typeof e=="string"&&(n=new Date(e)),!(n instanceof Date)||isNaN(n.getTime()))return"Unknown";let o=String(n.getDate()).padStart(2,"0"),a=String(n.getMonth()+1).padStart(2,"0"),i=String(n.getFullYear()).slice(2);switch(t){case"DDMMYY":return`${o}${r}${a}${r}${i}`;case"MMDDYY":return`${a}${r}${o}${r}${i}`;case"YYMMDD":return`${i}${r}${a}${r}${o}`;default:return`${o}${r}${a}${r}${i}`}}function tr(){var e,t,r,n,o,a;try{if((r=(t=(e=window.journalitPlugin)==null?void 0:e.settings)==null?void 0:t.trade)!=null&&r.dateFormat)return window.journalitPlugin.settings.trade.dateFormat;let i=window.JournalitPlugin;return(a=(o=(n=i==null?void 0:i.instance)==null?void 0:n.settings)==null?void 0:o.trade)!=null&&a.dateFormat?i.instance.settings.trade.dateFormat:"DDMMYY"}catch(i){return console.warn("Error accessing date format setting, using default (DDMMYY)",i),"DDMMYY"}}function av(e){let t=e.getMonth();return Math.floor(t/3)+1}function Xt(e){if(e instanceof Date&&!isNaN(e.getTime()))return e;if(e==null||e==="")return null;try{let t=new Date(e);if(!isNaN(t.getTime()))return t}catch(t){}return null}function iv(e){if(e==null||e==="")return!1;if(e instanceof Date)return!isNaN(e.getTime());try{let t=new Date(e);return!isNaN(t.getTime())}catch(t){return!1}}function Mt(e){if(e==null||e==="")return null;if(e instanceof Date)return isNaN(e.getTime())?null:e;if(typeof e=="number"){let o=new Date(e);return isNaN(o.getTime())?null:o}let r=String(e).split("-").map(o=>parseInt(o,10));if(r.length===3&&r.every(o=>!isNaN(o))){let o=new Date(r[0],r[1]-1,r[2]);return isNaN(o.getTime())||o.getFullYear()!==r[0]||o.getMonth()!==r[1]-1||o.getDate()!==r[2]?null:o}let n=new Date(e);return isNaN(n.getTime())?null:n}function Oi(e){let t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${n}`}function Wr(e){let t=Xt(e);return t?t.getTime():null}function yd(e,t){let r=Wr(e),n=Wr(t);return r===null&&n===null?0:r===null?1:n===null?-1:r-n}function sv(e,t){let r=Wr(e),n=Wr(t);return r===null||n===null?null:Math.abs(n-r)}function zw(e){let t=Wr(e);if(t===null)return null;let r=new Date;r.setHours(0,0,0,0);let n=r.getTime(),o=t-n;return Math.floor(o/(1e3*60*60*24))}var wt=L(()=>{});function MH(e,t){let[r,n]=(0,Tl.useState)(e);return(0,Tl.useEffect)(()=>{let o=setTimeout(()=>{n(e)},t);return()=>{clearTimeout(o)}},[e,t]),r}function SC(e,t,r={leading:!1,trailing:!0}){let n=(0,Tl.useRef)(null),o=(0,Tl.useRef)(0),a=(0,Tl.useRef)(null),i=(0,Tl.useCallback)((...s)=>{let l=Date.now();a.current=s;let c=r.leading&&(!o.current||l-o.current>t);n.current&&clearTimeout(n.current),c?(o.current=l,e(...s)):r.trailing&&(n.current=setTimeout(()=>{a.current&&(o.current=Date.now(),e(...a.current))},t))},[e,t,r.leading,r.trailing]);return(0,Tl.useEffect)(()=>()=>{n.current&&clearTimeout(n.current)},[]),i}var Tl,TC=L(()=>{Tl=q(Y())});function abe(e,t){let r=e.replace(/[^\d]/g,"");if(r.length!==6)return{date:null,error:"Date must be 6 digits (DDMMYY format)"};let n,o,a;switch(t){case"DDMMYY":n=parseInt(r.slice(0,2),10),o=parseInt(r.slice(2,4),10),a=parseInt(r.slice(4,6),10);break;case"MMDDYY":o=parseInt(r.slice(0,2),10),n=parseInt(r.slice(2,4),10),a=parseInt(r.slice(4,6),10);break;case"YYMMDD":a=parseInt(r.slice(0,2),10),o=parseInt(r.slice(2,4),10),n=parseInt(r.slice(4,6),10);break;default:n=parseInt(r.slice(0,2),10),o=parseInt(r.slice(2,4),10),a=parseInt(r.slice(4,6),10)}if(a>50?a=1900+a:a=2e3+a,o<1||o>12)return{date:null,error:"Invalid month"};if(n<1||n>31)return{date:null,error:"Invalid day"};let i=new Date(a,o-1,n);return i.getDate()!==n||i.getMonth()!==o-1||i.getFullYear()!==a?{date:null,error:"Invalid date"}:{date:i,error:null}}function FH(e){let t=e.toLowerCase().replace(/\s/g,""),r=/[ap]m?$/.test(t),n=/pm?$/.test(t),o=t.replace(/[ap]m?$/,""),a,i;if(o.includes(":")){let l=o.split(":");if(l.length!==2)return{date:null,error:"Invalid time format"};a=parseInt(l[0],10),i=parseInt(l[1],10)}else if(o.length===3)a=parseInt(o.slice(0,1),10),i=parseInt(o.slice(1,3),10);else if(o.length===4)a=parseInt(o.slice(0,2),10),i=parseInt(o.slice(2,4),10);else return{date:null,error:"Time must be 3 or 4 digits"};if(r){if(a<1||a>12)return{date:null,error:"Hours must be 1-12 with AM/PM"};n&&a!==12?a+=12:!n&&a===12&&(a=0)}else if(a<0||a>23)return{date:null,error:"Hours must be 0-23 in 24-hour format"};if(i<0||i>59)return{date:null,error:"Minutes must be 0-59"};let s=new Date;return s.setHours(a,i,0,0),{date:s,error:null}}function CC(e){let t=e.getHours(),r=e.getMinutes(),n=t>=12?"PM":"AM";return`${t%12||12}:${String(r).padStart(2,"0")} ${n}`}function OH(e,t,r=""){let n=String(e.getDate()).padStart(2,"0"),o=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getFullYear()).slice(2);switch(t){case"DDMMYY":return`${n}${r}${o}${r}${a}`;case"MMDDYY":return`${o}${r}${n}${r}${a}`;case"YYMMDD":return`${a}${r}${o}${r}${n}`;default:return`${n}${r}${o}${r}${a}`}}var Dr,ji,PC=L(()=>{Dr=q(Y());er();hd();NH();wt();TC();ji=Dr.default.memo(({label:e,value:t,onChange:r,includeTime:n=!1,timeOnly:o=!1,required:a=!1,error:i,placeholder:s,disabled:l=!1,className:c,minDate:d})=>{let[u,p]=(0,Dr.useState)(""),[m,f]=(0,Dr.useState)(!1),[g,v]=(0,Dr.useState)(!1),[h,y]=(0,Dr.useState)(null),b=(0,Dr.useRef)(null),x=(0,Dr.useMemo)(()=>{if(t){if(typeof t=="string"){let N=new Date(t);return isNaN(N.getTime())?void 0:N}return t}},[t]),w=tr(),S=SC(N=>{r&&r(N||void 0)},o?600:300),k=(0,Dr.useMemo)(()=>{if(s)return s;if(o)return"1022p or 10:22 AM";let N=w==="MMDDYY"?"123124":w==="YYMMDD"?"241231":"311224";return n?`${N} 1022p`:N},[s,o,w,n]),T=(0,Dr.useCallback)((N,B=!1)=>{if(!N.trim())return{date:null,error:null};try{let C=N.trim();if(o)return FH(C);let F=C.split(" "),M=F[0],_=F[1];if(!M)return{date:null,error:"Date required"};let W=abe(M,w);if(W.error)return W;let $=W.date;if(n){if(_){let H=FH(_);if(H.error)return H;H.date&&($.setHours(H.date.getHours()),$.setMinutes(H.date.getMinutes()))}else if(B){let H=new Date;$.setHours(H.getHours()),$.setMinutes(H.getMinutes())}}return{date:$,error:null}}catch(C){return{date:null,error:"Invalid format"}}},[o,w,n]),P=(0,Dr.useCallback)(N=>{if(!o&&!n)return!1;let B=N.trim(),C=B.split(" ");if(o){let F=/^\d{3,4}$/.test(B),M=/[ap]m?$/i.test(B);return F&&!M}if(n){if(C.length===1&&/^\d{6}$/.test(C[0]))return!0;let F=C[1];if(F){let M=/^\d{3,4}$/.test(F),_=/[ap]m?$/i.test(F);return M&&!_}}return!1},[o,n]),D=(0,Dr.useCallback)(N=>{if(p(N),m||f(!0),i||y(null),P(N))return;let{date:B,error:C}=T(N,!1);N.trim()&&C&&!i?y(C):C||S(B)},[m,T,S,i,P]),O=(0,Dr.useCallback)(()=>{if(!m&&(f(!0),x)){let N=o?CC(x):`${OH(x,w,"")}${n?` ${CC(x)}`:""}`;p(N)}},[m,x,o,w,n]),z=(0,Dr.useCallback)(()=>{if(m){let{date:N,error:B}=T(u,!0);u.trim()?B&&!i?y(B):(i||y(null),r&&!B&&r(N||void 0)):(r&&r(void 0),i||y(null)),f(!1)}},[m,u,T,r,i]),I=(0,Dr.useCallback)(()=>{v(!g)},[g]),A=(0,Dr.useCallback)(N=>{if(r){let B;if(N instanceof Date)B=N;else if(typeof N=="string"){let C=new Date(N);B=isNaN(C.getTime())?void 0:C}r(B)}v(!1),f(!1),p(""),y(null)},[r]),j=(0,Dr.useMemo)(()=>{if(m)return u;if(!x)return"";if(o)return CC(x);let N=OH(x,w,""),B=n?` ${CC(x)}`:"";return`${N}${B}`},[m,u,x,o,w,n]);return Dr.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"4px",width:"100%"},className:c},e&&Dr.default.createElement("label",{style:{fontSize:"14px",fontWeight:"500",color:"var(--text-normal)",marginBottom:"2px"}},e,a&&Dr.default.createElement("span",{style:{color:"var(--text-error)",marginLeft:"2px"}},"*")),Dr.default.createElement("div",{style:{position:"relative",display:"flex",alignItems:"flex-start"}},Dr.default.createElement($r,{ref:b,type:"text",value:j,onChange:D,onFocus:O,onBlur:z,placeholder:k,disabled:l,error:i||(i?null:h)||void 0,style:{paddingRight:"40px"}}),Dr.default.createElement("div",{style:{position:"absolute",right:"8px",display:"flex",alignItems:"center"}},Dr.default.createElement("button",{type:"button",onClick:I,className:"jl-icon-button-hover",style:{background:"none",border:"none",cursor:l?"not-allowed":"pointer",padding:"4px",borderRadius:"4px",color:"var(--text-muted)",display:"flex",alignItems:"center",justifyContent:"center",opacity:l?.5:1},disabled:l,title:"Open date picker"},o?Dr.default.createElement(xl,{size:16}):Dr.default.createElement(Su,{size:16})))),g&&Dr.default.createElement("div",{style:{marginTop:"8px",padding:"12px",border:"1px solid var(--background-modifier-border)",borderRadius:"6px",background:"var(--background-primary)"}},Dr.default.createElement(UF,{value:x,onChange:A,includeTime:n,timeOnly:o,required:a,minDate:d})))});ji.displayName="FastDateTimeInput"});var _f,ur,DC=L(()=>{_f=q(Y());hd();ur=({value:e,onChange:t,min:r,max:n,step:o=1,precision:a=2,allowDecimal:i=!0,...s})=>{let[l,c]=(0,_f.useState)(e!=null?e.toString():""),[d,u]=(0,_f.useState)(!1);return(0,_f.useEffect)(()=>{if(!d&&e!==void 0&&e!==null){let v=i&&a>0?e.toFixed(a):e.toString();c(v)}else!d&&e==null&&c("")},[e,i,a,d]),_f.default.createElement($r,{...s,type:"text",inputMode:i?"decimal":"numeric",value:l,onChange:v=>{if(u(!0),!v){c(""),t==null||t(void 0);return}if(!(i?/^-?\d*\.?\d*$/:/^-?\d*$/).test(v)||(c(v),v==="-"||v==="."||v==="-."))return;let y=i?parseFloat(v):parseInt(v,10);if(!isNaN(y)){let b=y;r!==void 0&&y<r&&(b=r),n!==void 0&&y>n&&(b=n),t==null||t(b)}},onFocus:v=>{var y;u(!0),(parseFloat(l)===0||l==="0"||/^0\.0+$/.test(l))&&v.target.select(),(y=s.onFocus)==null||y.call(s,v)},onBlur:v=>{var h;if(u(!1),l&&!isNaN(parseFloat(l))){let y=parseFloat(l);i&&a>0&&c(y.toFixed(a))}else(l==="-"||l===".")&&(c(""),t==null||t(void 0));(h=s.onBlur)==null||h.call(s,v)},onKeyDown:v=>{var h;if(v.key==="ArrowUp"||v.key==="ArrowDown"){v.preventDefault();let y=l?parseFloat(l):0;if(!isNaN(y)){let b=v.key==="ArrowUp"?o:-o,x=y+b,w=x;r!==void 0&&x<r&&(w=r),n!==void 0&&x>n&&(w=n);let S=i&&a>0?w.toFixed(a):w.toString();c(S),t==null||t(w)}}(h=s.onKeyDown)==null||h.call(s,v)},min:r,max:n,step:o})};ur.displayName="NumberInput"});var It,bd,ibe,sbe,li,_w=L(()=>{It=q(Y()),bd={COMBOBOX_CONTAINER:"combobox-container",INPUT_CONTAINER:"input-container",INPUT:"combobox-input",DROPDOWN:"combobox-dropdown",OPTION:"combobox-option",OPTION_HIGHLIGHTED:"highlighted",ADD_OPTION:"combobox-add-option",SELECTED_ITEM:"selected-item",REMOVE_BUTTON:"remove-button"},ibe=e=>({backgroundColor:e?"var(--background-secondary)":"var(--background-primary)"}),sbe=e=>({backgroundColor:e?"var(--background-secondary)":"var(--background-primary)"}),li=({options:e,value:t,onChange:r,allowCreate:n=!1,isMulti:o=!1,label:a,placeholder:i="Select or type...",error:s,helperText:l,optionType:c,onSaveOption:d,required:u=!1})=>{let p=(0,It.useId)(),m=`combobox-${p}`,f=`combobox-list-${p}`,g=`helper-${p}`,v=`error-${p}`,[h,y]=(0,It.useState)(()=>o?"":t||""),[b,x]=(0,It.useState)(!1),[w,S]=(0,It.useState)(-1),k=(0,It.useRef)(null),T=(0,It.useRef)(null),P=(0,It.useRef)(!1),D=(0,It.useRef)(!1),O=o?Array.isArray(t)?[...t]:[]:[],z=(0,It.useMemo)(()=>!o&&!b&&t?t:h,[o,b,t,h]),I=(0,It.useCallback)(R=>{y(R.target.value),x(!0),S(-1)},[]),A=R=>{let Z=(R.startsWith("__add__")?R.slice(7):R).trim();if(Z!==""){if(o){let K=Array.isArray(t)?[...t]:[];if(!K.includes(Z)){let X=[...K,Z];r(X),d&&R.startsWith("__add__")&&(c==="instrument"?/^[A-Z0-9.]+$/i.test(Z)&&d(Z):d(Z)),(R.startsWith("__add__")||e.includes(R))&&y("")}x(!0),T.current&&setTimeout(()=>{T.current&&T.current.focus()},0)}else r(Z),d&&R.startsWith("__add__")&&(c==="instrument"?/^[A-Z0-9.]+$/i.test(Z)&&d(Z):d(Z)),y(Z),x(!1);S(-1)}};(0,It.useEffect)(()=>{let R=V=>{var X,G,U;let Z=V.target,K=(X=Z==null?void 0:Z.closest)==null?void 0:X.call(Z,'[role="option"]');if(K&&((G=k.current)!=null&&G.contains(Z))){P.current=!0;let Q=(U=K.textContent)==null?void 0:U.trim();if(!Q)return;let J=K.hasAttribute("data-add-option")?`__add__${h}`:Q,ee=J.startsWith("__add__")?J:Q;A(ee),setTimeout(()=>{P.current=!1,o?(x(!0),T.current&&(T.current.focus(),y(""))):x(!1)},50)}};return document.addEventListener("mousedown",R,!0),()=>{document.removeEventListener("mousedown",R,!0)}},[o,h,A]);let j=(0,It.useCallback)(R=>{if(!o)return;D.current=!0;let Z=(Array.isArray(t)?[...t]:[]).filter(K=>K!==R);r(Z),setTimeout(()=>{T.current&&T.current.focus(),D.current=!1},50)},[o,r]);(0,It.useLayoutEffect)(()=>{if(!b)return;let R=V=>{var U,Q,J;if(D.current)return;let Z=V.target,K=(U=Z==null?void 0:Z.closest)==null?void 0:U.call(Z,'[role="option"]'),X=(Q=Z==null?void 0:Z.closest)==null?void 0:Q.call(Z,'[data-remove-button="true"]');if(!((J=k.current)==null?void 0:J.contains(Z))){x(!1);return}if(K){V.stopPropagation();return}if(X){V.preventDefault(),V.stopPropagation(),D.current=!0;let te=(X.getAttribute("aria-label")||"").replace("Remove ","");if(te){let be=(Array.isArray(t)?[...t]:[]).filter(Le=>Le!==te);r(be),setTimeout(()=>{T.current&&T.current.focus(),D.current=!1},50)}}};return document.addEventListener("mousedown",R,!0),()=>{document.removeEventListener("mousedown",R,!0)}},[b,r]),(0,It.useEffect)(()=>{if(!b)return;let R=V=>{V.key==="Escape"&&x(!1)};return document.addEventListener("keydown",R,!0),()=>{document.removeEventListener("keydown",R,!0)}},[b]),(0,It.useEffect)(()=>{if(!b)return;let R=()=>{x(!1)};return window.addEventListener("blur",R),()=>{window.removeEventListener("blur",R)}},[b]);let E=(0,It.useMemo)(()=>{let R=o?Array.isArray(t)?t:[]:[];return e.filter(V=>V.toLowerCase().includes(h.toLowerCase())).filter(V=>!o||!R.includes(V))},[e,h,o,t]),N=(0,It.useMemo)(()=>n&&h.trim()!==""&&!e.find(R=>R.toLowerCase()===h.toLowerCase()),[n,h,e]),B=(0,It.useCallback)(R=>{let V=E.length+(N?1:0);switch(R.key){case"ArrowDown":R.preventDefault(),x(!0),S(Z=>(Z+1)%V);break;case"ArrowUp":R.preventDefault(),x(!0),S(Z=>(Z-1+V)%V);break;case"Enter":R.preventDefault(),b?w>=0&&w<E.length?A(E[w]):N&&w===E.length?A(`__add__${h}`):n&&h.trim()!==""&&A(`__add__${h}`):x(!0);break;case"Tab":if(h.trim()!==""&&E.length>0){let Z=E.find(K=>K.toLowerCase().startsWith(h.toLowerCase()));Z?(R.preventDefault(),A(Z)):A(E[0])}else o||x(!1);break;case"Escape":x(!1);break}},[E,N,b,w,n,h,o,A]),C=It.default.useMemo(()=>E.map((R,V)=>It.default.createElement("li",{id:`option-${V}`,key:R,role:"option","aria-selected":w===V,className:`${bd.OPTION} ${w===V?bd.OPTION_HIGHLIGHTED:""}`,style:ibe(w===V),onMouseEnter:()=>S(V)},R)),[E,w]),F=It.default.useMemo(()=>N?It.default.createElement("li",{id:`option-${E.length}`,role:"option","aria-selected":w===E.length,"data-add-option":"true",className:`${bd.ADD_OPTION} ${w===E.length?bd.OPTION_HIGHLIGHTED:""}`,style:sbe(w===E.length),onMouseEnter:()=>S(E.length)},'Add "',h,'"'):null,[N,h,E.length,w]),M=It.default.useMemo(()=>o?It.default.createElement("div",null,(Array.isArray(t)?t:[]).map(R=>It.default.createElement("span",{key:R,className:bd.SELECTED_ITEM},R,It.default.createElement("button",{type:"button",onClick:V=>{V.preventDefault(),V.stopPropagation(),!D.current&&j(R)},onMouseDown:V=>{V.preventDefault(),V.stopPropagation(),!D.current&&j(R)},"aria-label":`Remove ${R}`,"data-remove-button":"true",className:bd.REMOVE_BUTTON},"\xD7")))):null,[o,t,j]),_=It.default.useCallback(()=>{x(!0),o||y("")},[o]),W=It.default.useCallback(R=>{var Z,K,X;P.current||D.current||R.relatedTarget&&((K=(Z=R.relatedTarget)==null?void 0:Z.hasAttribute)!=null&&K.call(Z,"data-remove-button"))||(X=k.current)!=null&&X.contains(R.relatedTarget)||setTimeout(()=>{!P.current&&!D.current&&x(!1)},100)},[]),$=It.default.useCallback(R=>{R.preventDefault(),R.stopPropagation(),x(!0),T.current&&T.current.focus()},[]),H=It.default.useCallback(R=>{b&&R.preventDefault()},[b]);return It.default.createElement("div",{ref:k,"data-combobox-type":o?"multi":"single","data-is-open":b?"true":"false",className:bd.COMBOBOX_CONTAINER,style:{zIndex:b?9999:10}},a&&It.default.createElement("label",{htmlFor:m},a,u&&It.default.createElement("span",{className:"required-indicator"},"*")),M,It.default.createElement("div",{className:bd.INPUT_CONTAINER},It.default.createElement("input",{ref:T,id:m,type:"text",value:z,onChange:I,onFocus:_,onBlur:W,onMouseDown:H,onClick:$,onKeyDown:B,placeholder:o&&O.length>0?"":i,"aria-expanded":b,"aria-autocomplete":"list","aria-controls":b?f:void 0,"aria-activedescendant":w>=0?`option-${w}`:void 0,"aria-invalid":!!s,"aria-describedby":s?v:l?g:void 0,role:"combobox",className:bd.INPUT}),b&&(E.length>0||N)&&It.default.createElement("ul",{id:f,role:"listbox","data-dropdown-visible":"true",className:bd.DROPDOWN},C,F)),s&&It.default.createElement("div",{id:v,role:"alert",className:"errorMessage"},s),!s&&l&&It.default.createElement("div",{id:g},l))};li.displayName="ComboBox"});var Cl,qF,GF=L(()=>{Cl=q(Y()),qF=({options:e,value:t,onChange:r,placeholderIcon:n,className:o="",title:a="Select an option"})=>{let[i,s]=(0,Cl.useState)(!1),l=(0,Cl.useRef)(null),c=e.find(u=>u.value===t);(0,Cl.useEffect)(()=>{let u=p=>{l.current&&!l.current.contains(p.target)&&s(!1)};return i&&document.addEventListener("mousedown",u),()=>{document.removeEventListener("mousedown",u)}},[i]);let d=u=>{r(u.value),s(!1)};return Cl.default.createElement("div",{ref:l,className:`icon-select-container ${o}`,title:a},Cl.default.createElement("button",{type:"button",className:"icon-select-trigger",onClick:()=>s(!i),"aria-haspopup":"listbox","aria-expanded":i},c?c.icon:n),i&&Cl.default.createElement("ul",{className:"icon-select-menu",role:"listbox"},e.map(u=>Cl.default.createElement("li",{key:u.value||"null-option",className:`icon-select-option ${u.value===t?"selected":""}`,onClick:()=>d(u),role:"option","aria-selected":u.value===t,title:u.label||String(u.value)},u.icon," "))),Cl.default.createElement("style",null,`
        .icon-select-container {
          position: relative;
          display: inline-block;
          width: 40px;
          height: 32px;
        }

        .icon-select-trigger {
          width: 100%;
          height: 100%;
          padding: 0;
          border: 1px solid var(--background-modifier-border);
          border-radius: 4px;
          background-color: var(--background-primary);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .icon-select-trigger:hover {
          background-color: var(--background-modifier-hover);
        }

        .icon-select-menu {
          position: absolute;
          top: calc(100% + 2px);
          left: 0;
          width: 40px;
          background-color: var(--background-primary);
          border: 1px solid var(--background-modifier-border);
          border-radius: 4px;
          box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
          z-index: 1000;
          list-style: none;
          padding: 4px 0;
          margin: 0;
        }

        .icon-select-option {
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 6px 0;
          cursor: pointer;
          height: 28px;
        }

        .icon-select-option:hover {
          background-color: var(--background-modifier-hover);
        }

        .icon-select-option.selected {
          background-color: var(--background-secondary);
        }
        
        /* SVG centering styles */
        .icon-select-trigger svg,
        .icon-select-option svg {
          display: block;
          margin: 0 auto;
        }
      `))}});var jH=L(()=>{});var Pl=L(()=>{hd();vd();PC();DC();_w();GF();jH()});var YF,Zp,lv=L(()=>{YF=q(Y()),Zp=({title:e,children:t,description:r})=>YF.default.createElement("div",{className:"formSection"},YF.default.createElement("div",{className:"sectionContent"},t))});var em,zH,tm=L(()=>{em=(i=>(i.STOCK="stock",i.OPTIONS="options",i.FUTURES="futures",i.FOREX="forex",i.CRYPTO="crypto",i.CFD="cfd",i))(em||{}),zH={entries:[{time:new Date,price:0,size:0}],exits:[{time:new Date,price:0,size:0}],entryTime:new Date,exitTime:new Date,entryPrice:0,exitPrice:0,positionSize:0,direction:"",instrument:"",assetType:"",setupIds:[],mistakeIds:[],accountIds:[],thesis:"",images:[],customTags:[],tags:[],setup:[],mistake:[],account:[],filePath:"",pnl:0,useDirectPnLInput:!1,directPnL:0,commission:0,commissionType:"fixed",swap:0,fees:0,rebate:void 0,stopLoss:void 0,riskAmount:void 0,rMultiple:void 0,exchange:"",expirationDate:new Date,strikePrice:0,optionType:"call",contractSize:100,contractSymbol:"",dollarPerPoint:0,tickSize:0,tickValue:0,currencyPair:"",lotSize:0,pipValue:0,tradingPair:"",cryptoExchange:"",leverageRatio:0,isMissedTrade:!1,missedReason:"",isBacktestTrade:!1,customFields:{}}});function cv(e){return e.useDirectPnLInput&&e.directPnL!==void 0&&e.directPnL!==null?e.directPnL:e.pnl||0}function Pt(e){if(e.useDirectPnLInput===!0)return!1;let t=e.exits&&e.exits.length>0&&e.exits.some(o=>o.price!==void 0&&o.price!==null&&o.price!==0||o.size!==void 0&&o.size!==null&&o.size!==0);if(e.entries&&e.entries.length>0){if(!t)return!0;if(e.entries&&e.exits){let o=e.entries.reduce((i,s)=>i+(s.size||0),0);if(e.exits.reduce((i,s)=>i+(s.size||0),0)<o)return!0}}if(e.tradeStatus==="OPEN")return!0;if(e.tradeStatus==="CLOSED")return!1;let n=e.pnl!==null&&e.pnl!==void 0&&(t||e.exitTime);return!t&&!n}function Bw(e,t){var a,i;if(e.isBacktestTrade)return"backtest";if(e.isMissedTrade)return"missed";if(Pt(e))return"open";let r=cv(e),n=(a=t==null?void 0:t.breakEvenRangeMin)!=null?a:0,o=(i=t==null?void 0:t.breakEvenRangeMax)!=null?i:0;return r>o?"win":r<n?"loss":"breakeven"}var ga=L(()=>{});function KF(){return`custom_field_${Date.now()}_${Math.random().toString(36).substr(2,5)}`}function rm(e){return e.toLowerCase().trim().replace(/[^a-z0-9\s]/gi,"").replace(/\s+/g,"_").replace(/_{2,}/g,"_").replace(/^_+|_+$/g,"")}function EC(e){return!e||e.trim()===""?"Field key cannot be empty":dv.has(e)?"This field name conflicts with built-in trade fields":/^[a-z][a-z0-9_]*$/i.test(e)?null:"Field key must start with a letter and contain only letters, numbers, and underscores"}function pv(e,t=[]){let r=rm(e);(!r||dv.has(r))&&(r="custom_field");let n=r,o=1;for(;t.includes(n)||dv.has(n);)n=`${r}_${o}`,o++;return n}function _H(e,t=[]){let r=KF(),n=`New ${e.charAt(0).toUpperCase()+e.slice(1)} Field`,o=pv(n,t);return{id:r,label:n,fieldKey:o,type:e,validation:{},order:Date.now()}}function IC(e,t,r){let{validation:n={},type:o}=t,a=()=>{let i=(t.options||[]).map(s=>s.value);return!r||r.length===0?i:[...new Set([...i,...r])]};if(n.required&&(e==null||e===""))return`${t.label} is required`;if(e==null||e==="")return null;switch(o){case"text":if(typeof e!="string")return`${t.label} must be text`;if(n.minLength&&e.length<n.minLength)return`${t.label} must be at least ${n.minLength} characters`;if(n.maxLength&&e.length>n.maxLength)return`${t.label} must be no more than ${n.maxLength} characters`;if(n.pattern)try{if(!new RegExp(n.pattern).test(e))return`${t.label} format is invalid`}catch(y){return console.warn("[CustomFields] Invalid regex pattern:",n.pattern),`${t.label} has an invalid validation pattern`}break;case"number":let i=Number(e);if(isNaN(i))return`${t.label} must be a number`;if(n.min!==void 0&&i<n.min)return`${t.label} must be at least ${n.min}`;if(n.max!==void 0&&i>n.max)return`${t.label} must be no more than ${n.max}`;break;case"dropdown":if(typeof e!="string")return`${t.label} must be a valid selection`;if(t.allowCreateOptions)break;let s=a();if(s.length>0&&!s.includes(e))return`${t.label} must be a valid option`;break;case"multiselect":if(!Array.isArray(e))return`${t.label} must be an array of selections`;if(t.allowCreateOptions)break;let l=a();if(l.length>0){for(let y of e)if(!l.includes(y))return`${t.label} contains invalid option: ${y}`}break;case"date":case"datetime":let c=new Date(e);if(isNaN(c.getTime()))return`${t.label} must be a valid date`;break;case"time":if(typeof e!="string")return`${t.label} must be a valid time`;let d=e.trim().toLowerCase();if(d==="")return n.required?`${t.label} is required`:null;let u=!1,p="",m=/^([0-1]?[0-9]|2[0-3]):([0-5][0-9])(?::([0-5][0-9]))?$/,f=d.match(m);if(f){u=!0;let y=f[1].padStart(2,"0"),b=f[2],x=f[3]||"00";p=`${y}:${b}:${x}`}else{let y=/^(1[0-2]|0?[1-9]):([0-5][0-9])(?::([0-5][0-9]))?\s*(am|pm)$/,b=d.match(y);if(b){u=!0;let x=parseInt(b[1]),w=b[2],S=b[3]||"00",k=b[4];k==="pm"&&x!==12?x+=12:k==="am"&&x===12&&(x=0),p=`${x.toString().padStart(2,"0")}:${w}:${S}`}}if(!u)return`${t.label} must be a valid time format (HH:MM, HH:MM:SS, or 12-hour with AM/PM)`;let[g,v,h]=p.split(":").map(Number);if(g>23||v>59||h>59)return`${t.label} contains invalid time values`;break}return null}var uv,Bf,dv,$f=L(()=>{uv=(s=>(s.TEXT="text",s.NUMBER="number",s.DROPDOWN="dropdown",s.MULTISELECT="multiselect",s.DATE="date",s.DATETIME="datetime",s.TIME="time",s))(uv||{}),Bf={fields:[]},dv=new Set(["type","entryTime","exitTime","entryPrice","exitPrice","positionSize","direction","tradeStatus","entries","exits","commission","fees","setupIds","mistakeIds","accountIds","instrument","assetType","account","setup","mistake","tags","pnl","useDirectPnLInput","directPnL","lossReview","reviewed","reviewedAt","exchange","optionType","strikePrice","expirationDate","dollarPerPoint","tickSize","tickValue","currencyPair","cryptoPair","cryptoExchange","leverageRatio","backendTradeId","backendAccountId","isMissedTrade","filePath","thesis","images","contractSize","lotSize","pipValue","pricePerShare","dividendPerShare","swap","notes","originalPnl"])});function AC(e){return BH[e]}function $H(){return Object.values(BH).map(e=>({value:e.code,label:`${e.symbol} ${e.name} (${e.code})`}))}var BH,nm=L(()=>{BH={USD:{code:"USD",symbol:"$",name:"US Dollar",locale:"en-US",decimalPlaces:2,symbolBefore:!0},EUR:{code:"EUR",symbol:"\u20AC",name:"Euro",locale:"en-IE",decimalPlaces:2,symbolBefore:!0},GBP:{code:"GBP",symbol:"\xA3",name:"British Pound",locale:"en-GB",decimalPlaces:2,symbolBefore:!0},JPY:{code:"JPY",symbol:"\xA5",name:"Japanese Yen",locale:"ja-JP",decimalPlaces:0,symbolBefore:!0},CAD:{code:"CAD",symbol:"C$",name:"Canadian Dollar",locale:"en-CA",decimalPlaces:2,symbolBefore:!0},AUD:{code:"AUD",symbol:"A$",name:"Australian Dollar",locale:"en-AU",decimalPlaces:2,symbolBefore:!0},CHF:{code:"CHF",symbol:"Fr",name:"Swiss Franc",locale:"de-CH",decimalPlaces:2,symbolBefore:!1},CNY:{code:"CNY",symbol:"\xA5",name:"Chinese Yuan",locale:"zh-CN",decimalPlaces:2,symbolBefore:!0}}});function Jn(e){return e==null||isNaN(e)?"N/A":e.toFixed(1)+"%"}function Vs(e,t="USD"){if(e==null||isNaN(e))return"N/A";let r=AC(t),n=Math.abs(e);if(e===0)return r.symbolBefore?`${r.symbol}0`:`0${r.symbol}`;let o=r.decimalPlaces;if(n===Math.floor(n)||o===0){let i=Math.floor(n).toLocaleString(r.locale);return r.symbolBefore?`${r.symbol}${i}`:`${i}${r.symbol}`}let a=n.toLocaleString(r.locale,{minimumFractionDigits:0,maximumFractionDigits:o});return r.symbolBefore?`${r.symbol}${a}`:`${a}${r.symbol}`}function ha(e,t=!1,r="USD"){if(e==null||isNaN(e))return"N/A";let n=AC(r),o=e<0,a=Math.abs(e),i=t&&e>0?"+":"",s=n.decimalPlaces,l=n.decimalPlaces;n.decimalPlaces>0&&(a===0?(s=0,l=0):a<10?(s=4,l=5):a<100?(s=3,l=4):a>=100&&(a===Math.floor(a)?(s=0,l=0):(s=n.decimalPlaces,l=n.decimalPlaces)));let c=a.toLocaleString(n.locale,{style:"currency",currency:n.code,minimumFractionDigits:s,maximumFractionDigits:l});return o?"-"+c.replace("-",""):i+c}function st(e,t,r,n){if(t!==void 0&&!isNaN(t))return t;let o=r!=null?r:n;if(e!==void 0&&o!==void 0&&o>0)return e/o}function ve(e,t=!0,r="USD",n,o){if(e===void 0||isNaN(e))return"N/A";if(n===!0){if(o===void 0||isNaN(o))return"N/A";let p=o>=0?"+":"",m=o.toFixed(1);return`${p}${m}R`}let a=AC(r),i=e<0,s=Math.abs(e);if(s>=1e6){let p=s/1e6,m;if(!t||a.decimalPlaces===0)m=Math.round(p)+"M";else{let v=Math.min(a.decimalPlaces,2),h=p.toFixed(v);h.endsWith(".00")?m=h.slice(0,-3)+"M":h.endsWith("0")&&v>1?m=h.slice(0,-1)+"M":m=h+"M"}let f=a.symbolBefore?a.symbol:"",g=a.symbolBefore?"":a.symbol;return i?`-${f}${m}${g}`:`${f}${m}${g}`}if(s>=1e5){let p=s/1e3,m;if(!t||a.decimalPlaces===0)m=Math.round(p)+"K";else{let v=Math.min(a.decimalPlaces,2),h=p.toFixed(v);h.endsWith(".00")?m=h.slice(0,-3)+"K":h.endsWith("0")&&v>1?m=h.slice(0,-1)+"K":m=h+"K"}let f=a.symbolBefore?a.symbol:"",g=a.symbolBefore?"":a.symbol;return i?`-${f}${m}${g}`:`${f}${m}${g}`}let l=s!==Math.floor(s),c;if(!t||a.decimalPlaces===0)c=Math.round(s).toLocaleString(a.locale);else if(l){let p=Math.floor(s).toLocaleString(a.locale),m=(s-Math.floor(s)).toFixed(a.decimalPlaces).substring(1);c=`${p}${m}`}else c=Math.floor(s).toLocaleString(a.locale);let d=a.symbolBefore?a.symbol:"",u=a.symbolBefore?"":a.symbol;return i?`-${d}${c}${u}`:`${d}${c}${u}`}function JF(e){if(!e||e<0)return"N/A";let t=Math.floor(e/1e3),r=Math.floor(t/60),n=Math.floor(r/60),o=Math.floor(n/24);if(o>0){let a=n%24;return a>0?`${o}d ${a}h`:`${o}d`}else if(n>0){let a=r%60;return a>0?`${n}h ${a}m`:`${n}h`}else if(r>0){let a=t%60;return a>0?`${r}m ${a}s`:`${r}m`}else return`${t}s`}var Ut=L(()=>{nm()});function XF(e,t){return t!==void 0&&t>0?e+t:e}var QF,ZF,LC,$w,Wf,eO,lbe,WH,RH,Ww,Rf=L(()=>{tm();ga();$f();wt();Ut();QF=e=>{let t={},r=e.useDirectPnLInput===!0,n=e.isMissedTrade===!0,o=Pt({tradeStatus:e.tradeStatus,exitTime:e.exitTime,pnl:null,useDirectPnLInput:e.useDirectPnLInput,exits:e.exits,entries:e.entries});if(n&&!r){let s=e.exitPrice!==void 0&&e.exitPrice!==null&&e.exitPrice!==0,l=e.exits&&e.exits.length>0&&e.exits.some(c=>c.price!==void 0&&c.price!==null&&c.price!==0||c.size!==void 0&&c.size!==null&&c.size!==0);if(!s&&!l)return t.form="Missed trades must have exit data with non-zero prices. They represent opportunities that have already passed, so you must specify what the exit price would have been.",t}if(e.isBacktestTrade,!r&&!n)if(!e.entries||e.entries.length===0)t.entriesExits="At least one entry is required.";else{let s=[],l=!1;e.entries.forEach((c,d)=>{let u={};c.time||(u.time="Entry time is required.",l=!0),(c.price===void 0||c.price===null)&&(u.price="Entry price is required.",l=!0),(c.size===void 0||c.size===null||c.size<=0)&&(u.size="Entry size must be greater than zero.",l=!0),s[d]=u}),l&&(t.entries=s)}if(!r&&!n)if(!e.exits||e.exits.length===0)o||(t.entriesExits?t.entriesExits+=" At least one exit is required for closed trades.":t.entriesExits="At least one exit is required for closed trades.");else{let s=e.exits.filter(c=>(c.price===void 0||c.price===null||c.price===0)&&(c.size===void 0||c.size===null||c.size===0));if(!(e.exits.filter(c=>c.price!==void 0&&c.price!==null&&c.price!==0||c.size!==void 0&&c.size!==null&&c.size!==0).length===0&&o)){let c=[],d=!1;e.exits.forEach((u,p)=>{if((u.price===void 0||u.price===null||u.price===0)&&(u.size===void 0||u.size===null||u.size===0)&&o){c[p]={};return}let f={};u.time||(f.time="Exit time is required.",d=!0),(u.price===void 0||u.price===null)&&(f.price="Exit price is required.",d=!0),(u.size===void 0||u.size===null||u.size<=0)&&(f.size="Exit size must be greater than zero.",d=!0),c[p]=f}),d&&(t.exits=c)}}if(!r&&!n&&e.entries&&e.entries.length>0&&e.exits&&e.exits.length>0){let s=e.exits.filter(l=>l.price!==void 0&&l.price!==null&&l.price!==0&&l.size!==void 0&&l.size!==null&&l.size!==0);if(!(s.length===0&&o)){let l=e.entries.reduce((u,p)=>u+(p.size||0),0);s.reduce((u,p)=>u+(p.size||0),0)>l&&(t.entriesExits?t.entriesExits+=" Total exit size cannot exceed total entry size.":t.entriesExits="Total exit size cannot exceed total entry size.");let d=e.entries&&e.entries.length>0?Wr(e.entries[0].time):null;d&&s.some(u=>{let p=Wr(u.time);return p&&p<d})&&(t.entriesExits?t.entriesExits+=" Exits cannot occur before the first entry.":t.entriesExits="Exits cannot occur before the first entry.")}}r&&!n&&(e.directPnL===void 0||e.directPnL===null)&&(t.directPnL="Please enter a profit/loss value.");let a=e.entries&&e.entries.length>0&&e.entries.some(s=>s.time&&s.price!==void 0&&s.size!==void 0);if(!e.entryTime&&(r||!a)&&(t.entryTime="Please select an entry time."),!e.direction&&e.assetType!=="options"&&(t.direction="Please select a direction."),e.assetType||(t.assetType="Please select an asset type."),e.instrument?/^[A-Z0-9.]+$/i.test(e.instrument)||(t.instrument="Enter a valid ticker symbol (letters, numbers & periods only)."):t.instrument="Please select a Ticker.",!n&&(!e.accountIds||e.accountIds.length===0)&&(!e.account||e.account.length===0)&&(t.accountIds="Please select at least one account."),(e.entryPrice!==void 0&&e.entryPrice!==null||e.exitPrice!==void 0&&e.exitPrice!==null||e.positionSize!==void 0&&e.positionSize!==null)&&!r&&!n){!o&&!e.exitTime&&(t.exitTime="Please select an exit time."),(e.entryPrice===void 0||e.entryPrice===null||e.entryPrice<=0)&&(t.entryPrice="Please enter a valid entry price."),!o&&(e.exitPrice===void 0||e.exitPrice===null||e.exitPrice<=0)&&(t.exitPrice="Please enter a valid exit price."),(e.positionSize===void 0||e.positionSize===null||e.positionSize<=0)&&(t.positionSize="Please enter a valid position size.");let s=Wr(e.entryTime),l=Wr(e.exitTime);s&&l&&l<s&&(t.exitTime="Exit time must be after entry time.")}if(e.assetType)switch(e.assetType){case"stock":break;case"options":e.expirationDate||(t.expirationDate="Please select an expiration date."),e.strikePrice||(t.strikePrice="Please enter a strike price."),e.optionType||(t.optionType="Please select an option type (call or put)."),e.contractSize!==void 0&&e.contractSize<=0&&(t.contractSize="Contract size must be greater than zero.");break;case"futures":(e.dollarPerPoint===void 0||e.dollarPerPoint<.01)&&(t.dollarPerPoint="Please enter Dollars per point (min 0.01).");break;case"forex":e.lotSize!==void 0&&e.lotSize<0&&(t.lotSize="Lot size cannot be negative.");break;case"crypto":break;case"cfd":e.leverageRatio!==void 0&&e.leverageRatio<=0&&(t.leverageRatio="Leverage ratio must be greater than zero.");break}if(e.commissionType!==void 0&&e.commissionType!==null&&e.commissionType!=="fixed"&&e.commissionType!=="percentage"&&(t.commissionType='Commission type must be either "fixed" or "percentage".'),e.commission!==void 0&&e.commission!==null)if(typeof e.commission!="number")t.commission="Commission must be a number.";else{let s=e.commissionType||"fixed";s==="fixed"||s==="percentage"&&(e.commission<0||e.commission>100)&&(t.commission="Percentage commission must be between 0 and 100.")}return e.rebate!==void 0&&e.rebate!==null&&(e.assetType!=="options"?t.rebate="Rebate is only allowed for options trades.":typeof e.rebate!="number"?t.rebate="Rebate must be a number.":e.rebate<0&&(t.rebate="Rebate must be a positive value.")),e.swap!==void 0&&e.swap!==null&&typeof e.swap!="number"&&(t.swap="Invalid swap amount."),e.fees!==void 0&&e.fees!==null&&typeof e.fees!="number"&&(t.fees="Fees must be a number."),e.riskAmount!==void 0&&e.riskAmount!==null&&(typeof e.riskAmount!="number"?t.riskAmount="Risk amount must be a number.":Number.isFinite(e.riskAmount)?e.riskAmount<=0&&(t.riskAmount="Risk amount must be greater than zero."):t.riskAmount="Risk amount must be a valid number."),e.stopLoss!==void 0&&e.stopLoss!==null&&(typeof e.stopLoss!="number"?t.stopLoss="Stop loss must be a number.":Number.isFinite(e.stopLoss)||(t.stopLoss="Stop loss must be a valid number.")),t},ZF=(e,t,r)=>{let n={};return!e||!t||t.length===0||t.forEach(o=>{let a=e[o.id],i=r?r.getFieldOptions(o.id):void 0,s=IC(a,o,i);s&&(n[o.id]=s)}),n},LC=e=>Object.keys(e).length>0,$w=e=>{let t=e.commission||0;if((e.commissionType||"fixed")==="percentage"){let n=0;return e.useDirectPnLInput&&e.directPnL!==void 0?n=Math.abs(e.directPnL):e.entries&&e.entries.length>0?n=e.entries.reduce((o,a)=>a.price!==void 0&&a.size!==void 0?o+Math.abs(a.price*a.size):o,0):e.entryPrice!==void 0&&e.positionSize!==void 0&&(n=Math.abs(e.entryPrice*e.positionSize)),n*t/100}return t},Wf=e=>{var s,l;if(Pt({tradeStatus:e.tradeStatus,exitTime:e.exitTime,pnl:e._originalPnlWasNull?null:e.pnl,useDirectPnLInput:e.useDirectPnLInput,exits:e.exits,entries:e.entries}))return 0;if(e.useDirectPnLInput&&e.directPnL!==void 0){let c=e.directPnL;if(e.commission!==void 0){let d=$w(e);e.commission<0?c+=d:c-=d}return e.swap!==void 0&&(c+=e.swap),e.fees!==void 0&&(e.fees<0?c+=e.fees:c-=e.fees),XF(c,e.rebate)}let t=(s=e.entries)==null?void 0:s.some(c=>{var d,u;return((d=c.price)!=null?d:0)>0&&((u=c.size)!=null?u:0)>0}),r=(l=e.exits)==null?void 0:l.some(c=>{var d,u;return((d=c.price)!=null?d:0)>0&&((u=c.size)!=null?u:0)>0});if(!t||!r||!e.direction&&e.assetType!=="options")return lbe(e);let n=0,o=0,a=0,i=0;if(e.entries&&(e.entries.forEach(c=>{c.price===void 0||c.size===void 0||(a+=c.price*c.size,i+=c.size)}),i>0&&(o=a/i)),e.exits&&e.entries&&e.exits.forEach(c=>{if(c.price===void 0||c.size===void 0||o===0)return;let d=0,u;if(e.assetType==="options"&&!e.direction?u=c.price-o:u=e.direction==="long"?c.price-o:o-c.price,d=u*c.size,e.assetType)switch(e.assetType){case"options":e.contractSize&&(d=u*c.size*e.contractSize);break;case"futures":e.dollarPerPoint&&(d=u*c.size*e.dollarPerPoint,e.tickValue&&e.tickSize&&e.tickSize>0&&(d=u/e.tickSize*e.tickValue*c.size));break;case"forex":e.lotSize&&e.lotSize>0?d=u*c.size*e.lotSize:e.pipValue&&e.pipValue>0&&(d=u*1e4*e.pipValue*c.size);break;case"cfd":e.leverageRatio&&e.leverageRatio>0&&(d=u*c.size);break}n+=d}),e.commission!==void 0){let c=$w(e);e.commission<0?n+=e.commission:n-=c}return e.swap!==void 0&&(n+=e.swap),e.fees!==void 0&&(e.fees<0?n+=e.fees:n-=e.fees),XF(n,e.rebate)},eO=e=>{if(Pt({tradeStatus:e.tradeStatus,exitTime:e.exitTime,pnl:e._originalPnlWasNull?null:e.pnl,useDirectPnLInput:e.useDirectPnLInput,exits:e.exits,entries:e.entries}))return 0;let t=Wf(e),r=0;if(e.stopLoss!==void 0)if(e.entries&&e.entries.length>0){let n=0,o=0;if(e.entries.forEach(a=>{a.price!==void 0&&a.size!==void 0&&(n+=a.price*a.size,o+=a.size)}),o>0){let a=n/o;r=Math.abs(a-e.stopLoss)*o}}else e.entryPrice!==void 0&&e.positionSize!==void 0&&(r=Math.abs(e.entryPrice-e.stopLoss)*e.positionSize);return r===0&&typeof e.riskAmount=="number"&&Number.isFinite(e.riskAmount)&&e.riskAmount>0&&(r=e.riskAmount),r===0?0:t/r},lbe=e=>{if(e.entryPrice===void 0||e.exitPrice===void 0||e.positionSize===void 0||!e.direction&&e.assetType!=="options")return 0;let t=0,r;if(e.assetType==="options"&&!e.direction?r=e.exitPrice-e.entryPrice:r=e.direction==="long"?e.exitPrice-e.entryPrice:e.entryPrice-e.exitPrice,t=r*e.positionSize,e.assetType)switch(e.assetType){case"options":e.contractSize&&(t=r*e.positionSize*e.contractSize);break;case"futures":e.dollarPerPoint&&(t=r*e.positionSize*e.dollarPerPoint,e.tickValue&&e.tickSize&&e.tickSize>0&&(t=r/e.tickSize*e.tickValue*e.positionSize));break;case"forex":e.lotSize&&e.lotSize>0?t=r*e.positionSize*e.lotSize:e.pipValue&&e.pipValue>0&&(t=r*1e4*e.pipValue*e.positionSize);break;case"cfd":e.leverageRatio&&e.leverageRatio>0&&(t=r*e.positionSize);break}if(e.commission!==void 0){let n=$w(e);e.commission<0?t+=e.commission:t-=n}return e.swap!==void 0&&(t+=e.swap),e.fees!==void 0&&(e.fees<0?t+=e.fees:t-=e.fees),XF(t,e.rebate)},WH=e=>{if(Pt({tradeStatus:e.tradeStatus,exitTime:e.exitTime,pnl:e.pnl,useDirectPnLInput:e.useDirectPnLInput,exits:e.exits,entries:e.entries})||e.useDirectPnLInput||e.entryPrice===void 0||e.exitPrice===void 0||e.entryPrice===0||!e.direction&&e.assetType!=="options")return 0;let t;e.assetType==="options"&&!e.direction?t=e.exitPrice-e.entryPrice:t=e.direction==="long"?e.exitPrice-e.entryPrice:e.entryPrice-e.exitPrice;let r=t/e.entryPrice*100;return e.assetType==="cfd"&&e.leverageRatio&&e.leverageRatio>0&&(r=r*e.leverageRatio),r},RH=(e,t,r)=>{let n=[];if(e.commission&&e.commission>0){let i=$w(e),s=e.commissionType||"fixed",l;t===!0&&r&&r>0?l=`${(i/r).toFixed(2)}R`:l=Vs(i);let c=s==="percentage"?`Commission (${e.commission}%): ${l}`:`Commission: ${l}`;n.push(c)}if(e.swap!==void 0&&e.swap!==null&&e.swap!==0){let i=e.swap>0?"Swap Cost":"Swap Credit",s=Math.abs(e.swap),l;t===!0&&r&&r>0?l=`${(s/r).toFixed(2)}R`:l=Vs(s),n.push(`${i}: ${l}`)}if(e.fees&&e.fees>0){let i;t===!0&&r&&r>0?i=`${(e.fees/r).toFixed(2)}R`:i=Vs(e.fees),n.push(`Fees: ${i}`)}let o=[];if(e.rebate&&e.rebate>0){let i;t===!0&&r&&r>0?i=`${(e.rebate/r).toFixed(2)}R`:i=Vs(e.rebate),o.push(`Rebate: ${i}`)}let a=n.length>0?n.join(", "):"No costs";return o.length>0?`${a} | ${o.join(", ")}`:a},Ww=e=>{let t=$w(e),r=e.swap||0,n=e.fees||0;return t+r+n}});var fv,UH,tO,Rw,Uf,Uw,Vf,Vw,Hs,Hw,Iu=L(()=>{Ut();wt();ga();fv=(e,t,r=5)=>{let n=[];if(isNaN(e)||isNaN(t)||e===t)return[0];let o=t-e,a=o/(r-1);if(isNaN(a)||a<=0)return[e,t];let i=Math.pow(10,Math.floor(Math.log10(a)));if(isNaN(i)||i<=0)return[e,t];let s;a/i<1.5?s=i:a/i<3.5?s=2*i:a/i<7.5?s=5*i:s=10*i,o<10*i&&s>i&&(s=i);let l=Math.floor(e/s)*s,c=Math.ceil(t/s)*s;for(let d=l;d<=c;d+=s){let u=parseFloat(d.toFixed(12));n.push(u)}return e<=0&&0<=t&&!n.includes(0)&&n.push(0),[...new Set(n)].sort((d,u)=>d-u)},UH=(e,t,r,n,o=.05)=>{isNaN(e)&&(e=0),isNaN(t)&&(t=0),isNaN(o)&&(o=.05);let a=r!==void 0?r:Math.min(0,e),i=n!==void 0?n:Math.max(0,t);if(isNaN(a)&&(a=0),isNaN(i)&&(i=0),r===void 0&&e<0){let s=Math.abs(e)*o;isNaN(s)||(a=Math.min(a,e-s))}if(n===void 0&&t>0){let s=t*o;isNaN(s)||(i=Math.max(i,t+s))}return isNaN(a)&&(a=0),isNaN(i)&&(i=0),[a,i]},tO=e=>e===0?"0.00%":"-"+Math.abs(e).toFixed(2)+"%",Rw=new Map,Uf=(e,t,r)=>{var m,f;if(!e||!Array.isArray(e)){let g=new Date;return[{date:rt(g,t),dateKey:`pnl-${g.getTime()}-0`,pnl:0,tradePnL:0}]}let n=e.filter((g,v)=>!Pt({tradeStatus:g.tradeStatus,exitTime:g.exitTime,pnl:g._originalPnlWasNull?null:g.pnl,useDirectPnLInput:g.useDirectPnLInput,exits:g.exits,entries:g.entries})),o=n.length>0?`${((m=n[0])==null?void 0:m.path)||""}:${((f=n[n.length-1])==null?void 0:f.path)||""}:${n.map(g=>Array.isArray(g.account)?g.account.join(","):g.account||"").join(",")}`:"empty",a=`pnl:${n.length}:${t}:${o}:${r!=null?r:"none"}`,i=Rw.get(a);if(i)return i;let s=[...n].sort((g,v)=>yd(g.entryTime,v.entryTime)),l=0,c=0,d=[],u=0,p=(g,v)=>{let y=`pnl-${g!=null?g:v}-${u}`;return u+=1,y};if(s.length>0){let g=new Date(s[0].entryTime),v=Wr(s[0].entryTime);d.push({date:rt(g,t),dateKey:p(v,"initial"),pnl:0,tradePnL:0,cumulativeR:0,tradeR:0})}else d.push({date:rt(new Date,t),dateKey:p(null,"empty"),pnl:0,tradePnL:0,cumulativeR:0,tradeR:0});if(s.forEach(g=>{var b;let v=(b=g.pnl)!=null?b:0;isNaN(v)&&(v=0),l+=v,isNaN(l)&&(l=0);let h=st(v,g.rMultiple,g.riskAmount,r),y=h!=null?h:0;isNaN(y)&&(y=0),c+=y,isNaN(c)&&(c=0),d.push({date:rt(g.entryTime,t),dateKey:p(Wr(g.entryTime),"trade"),pnl:l,tradePnL:v,cumulativeR:c,tradeR:y})}),Rw.set(a,d),Rw.size>50){let g=Rw.keys().next().value;Rw.delete(g)}return d},Uw=new Map,Vf=(e,t,r)=>{var f,g;if(!e||!Array.isArray(e)){let v=new Date;return[{date:rt(v,t),dateKey:`drawdown-${v.getTime()}-0`,drawdown:0,pnl:0,cumPnL:0,peakEquity:0,rMultiple:0,cumulativeR:0}]}let n=e.filter((v,h)=>!Pt({tradeStatus:v.tradeStatus,exitTime:v.exitTime,pnl:v._originalPnlWasNull?null:v.pnl,useDirectPnLInput:v.useDirectPnLInput,exits:v.exits,entries:v.entries})),o=n.length>0?`${((f=n[0])==null?void 0:f.path)||""}:${((g=n[n.length-1])==null?void 0:g.path)||""}:${n.map(v=>Array.isArray(v.account)?v.account.join(","):v.account||"").join(",")}`:"empty",a=`drawdown:${n.length}:${t}:${o}:${r!=null?r:"none"}`,i=Uw.get(a);if(i)return i;let s=[...n].sort((v,h)=>yd(v.entryTime,h.entryTime)),l=0,c=0,d=0,u=[],p=0,m=(v,h)=>{let b=`drawdown-${v!=null?v:h}-${p}`;return p+=1,b};if(s.length>0){let v=new Date(s[0].entryTime);u.push({date:rt(v,t),dateKey:m(Wr(s[0].entryTime),"initial"),drawdown:0,pnl:0,cumPnL:0,peakEquity:0,rMultiple:0,cumulativeR:0})}else u.push({date:rt(new Date,t),dateKey:m(null,"empty"),drawdown:0,pnl:0,cumPnL:0,peakEquity:0,rMultiple:0,cumulativeR:0});if(s.forEach(v=>{var w;let h=(w=v.pnl)!=null?w:0;isNaN(h)&&(h=0),l+=h,isNaN(l)&&(l=0);let y=st(h,v.rMultiple,v.riskAmount,r),b=y!=null?y:0;isNaN(b)&&(b=0),c+=b,isNaN(c)&&(c=0),l>d&&(d=l);let x=0;if(d>0){let S=-((d-l)/d)*100;x=isNaN(S)?0:S}else if(l<0){let S=s.filter(k=>k.pnl!=null&&!isNaN(k.pnl)&&k.pnl!==0);if(S.length>0){let k=Math.min(...S.map(P=>P.pnl)),T=Math.abs(k)*10;if(T>0){let P=-(Math.abs(l)/T)*100;x=isNaN(P)?0:P}}}u.push({date:rt(v.entryTime,t),dateKey:m(Wr(v.entryTime),"trade"),drawdown:x,pnl:h,cumPnL:l,peakEquity:d,rMultiple:b,cumulativeR:c})}),Uw.set(a,u),Uw.size>50){let v=Uw.keys().next().value;Uw.delete(v)}return u},Vw=(e,t)=>[...e.filter((a,i)=>!Pt({tradeStatus:a.tradeStatus,exitTime:a.exitTime,pnl:a._originalPnlWasNull?null:a.pnl,useDirectPnLInput:a.useDirectPnLInput,exits:a.exits,entries:a.entries}))].sort((a,i)=>yd(a.entryTime,i.entryTime)).map((a,i)=>{var d;let s=(d=a.pnl)!=null?d:0;isNaN(s)&&(s=0);let l=s>=0,c=st(s,a.rMultiple,a.riskAmount,t);return{tradeIndex:i+1,pnl:s,fill:l?"var(--chart-positive)":"var(--chart-negative)",instrument:a.instrument,direction:a.direction,entryTime:a.entryTime,exitTime:a.exitTime,path:a.path,rMultiple:c}}),Hs={container:"journalit-chart-tooltip",date:"journalit-chart-tooltip-date",value:"journalit-chart-tooltip-value",info:"journalit-chart-tooltip-info",positive:"positive",negative:"negative"},Hw=(e,t,r,n,o)=>{switch(t){case"pnl":return ve(e,!0,r,n,o);case"drawdown":return tO(e);case"number":default:return e.toFixed(2)}}});function VH(e){try{let t=[];return JSON.stringify(e,(r,n)=>{if(typeof n=="object"&&n!==null){if(t.includes(n))return"[Circular Reference]";t.push(n)}return n},2)}catch(t){return console.error("safeStringify error:",t),`[Error serializing object: ${t instanceof Error?t.message:String(t)}]`}}function rO(e,t=["plugin","app"]){let r={};return Object.entries(e).forEach(([n,o])=>{o!==null&&typeof o!="function"&&!(o instanceof Node)&&!t.includes(n)&&(typeof o=="object"&&!Array.isArray(o)?r[n]=rO(o,t):r[n]=o)}),r}function HH(e){try{return{...e}}catch(t){return console.error("Error normalizing data:",t),e}}function qH(e,t){try{let r={...e},n={...t};return{...r,...n}}catch(r){return console.error("Error in safeUpdateObject:",r),{...e,...t}}}var qw=L(()=>{});function NC(e,t,r){let n=null,o=null,a=0,i=null,s=null,l,{leading:c=!1,trailing:d=!0,maxWait:u}=r||{};function p(S){let k=i,T=s;return i=s=null,a=S,l=e.apply(T,k),l}function m(S){return a=S,n=setTimeout(v,t),c?p(S):l}function f(S){let k=S-(o||0),T=S-a,P=t-k;return u!==void 0?Math.min(P,u-T):P}function g(S){let k=S-(o||0),T=S-a;return o===null||k>=t||k<0||u!==void 0&&T>=u}function v(){let S=Date.now();if(g(S))return h(S);n=setTimeout(v,f(S))}function h(S){return n=null,d&&i?p(S):(i=s=null,l)}function y(){n!==null&&clearTimeout(n),a=0,i=o=s=n=null}function b(){return n===null?l:h(Date.now())}function x(){return n!==null}function w(...S){let k=Date.now(),T=g(k);if(i=S,s=this,o=k,T){if(n===null)return m(o);if(u!==void 0)return n=setTimeout(v,t),p(o)}return n===null&&(n=setTimeout(v,t)),l}return w.cancel=y,w.flush=b,w.pending=x,w}function Gw(e,t){let r=null,n=null,o=null,a=null;function i(){r!==null&&(clearTimeout(r),r=null),a&&(a(new Error("Debounced function cancelled")),o=a=null,n=null)}async function s(){if(r!==null&&(clearTimeout(r),r=null,n))try{let u=await e.apply(c,l);return o&&o(u),u}catch(u){throw a&&a(u),u}}let l=null,c=null,d=function(...u){return l=u,c=this,i(),n=new Promise((p,m)=>{o=p,a=m,r=setTimeout(async()=>{try{let f=await e.apply(c,l);p(f)}catch(f){m(f)}finally{r=null,n=null,o=a=null}},t)}),n};return d.cancel=i,d.flush=s,d}var gv=L(()=>{});function hv(){if(document.head.querySelector("#dropdown-fix-script"))return;let e=document.createElement("script");e.id="dropdown-fix-script",e.textContent=cbe,document.head.appendChild(e)}function MC(){let e=document.head.querySelector("#dropdown-fix-script");e&&e.remove()}var cbe,GH=L(()=>{cbe=`
  // Global event handler to forcibly close dropdowns when clicking outside
  (function() {
    // Only add this handler once
    if (window.__dropdownClickHandlerAdded) return;
    
    // Mark this handler as added to prevent multiple instances
    window.__dropdownClickHandlerAdded = true;
    
    // Initialize the remove handling flag
    window.__isHandlingComboBoxRemove = false;
    
    // Add capture phase handler to catch clicks early
    document.addEventListener('mousedown', function(event) {
      // Skip if event is already being handled
      if (window.__isHandlingComboBoxRemove) return;
      
      // Mark as handling to prevent recursive handling
      window.__isHandlingComboBoxRemove = true;
      
      try {
        // Find all open comboboxes/dropdowns
        const openDropdowns = document.querySelectorAll('[data-is-open="true"], [data-combobox-type][aria-expanded="true"]');
        
        if (openDropdowns.length > 0) {
          let shouldClose = true;
          
          // Check if the click was inside any dropdown
          for (const dropdown of openDropdowns) {
            if (dropdown.contains(event.target)) {
              shouldClose = false;
              break;
            }
          }
          
          // If clicked outside, close all dropdowns by triggering blur on their inputs
          if (shouldClose) {
            openDropdowns.forEach(dropdown => {
              const input = dropdown.querySelector('input[role="combobox"]');
              if (input) {
                // Trigger blur to close the dropdown
                input.blur();
                
                // Additional attribute cleanup to ensure closure
                dropdown.setAttribute('data-is-open', 'false');
                if (input.hasAttribute('aria-expanded')) {
                  input.setAttribute('aria-expanded', 'false');
                }
              }
            });
          }
        }
      } catch (err) {
        console.error('Error in dropdown click handler:', err);
      } finally {
        // Release handling flag
        window.__isHandlingComboBoxRemove = false;
      }
    }, true);
  })();
`});function Dl(e){let{message:t,error:r,component:n="unknown",operation:o="unknown",data:a,severity:i="error"}=e,s=r instanceof Error?r:new Error(t),l=i==="info"?console.info:i==="warning"?console.warn:console.error,c={error:s,operation:o,component:n};return a&&(c.data=typeof a=="object"?VH(a):a),l(`[${i.toUpperCase()}] [${n}] ${t}`,c),s}function vv(e,t){return(r,n)=>Dl({message:n||`Error in ${t}`,error:r,component:e,operation:t,severity:"error"})}var Yw=L(()=>{qw()});function Xn(){let e=window.app;if(!e)throw new Error("Could not access Obsidian app instance");return e}var Kw=L(()=>{});var nO={};Ko(nO,{forceMetadataCacheRefresh:()=>yr});async function yr(e,t,r=100){e.metadataCache.getCache(t.path)&&delete e.metadataCache.metadataCache[t.path],await e.vault.cachedRead(t),e.metadataCache.trigger("resolve",t),await new Promise(o=>setTimeout(o,r)),e.metadataCache.trigger("changed",t)}var ls=L(()=>{});function El(e,t,r){return e==null?0:!r||t<=1?e:e*t}function Il(e){return e.account&&Array.isArray(e.account)?Math.max(e.account.length,1):1}var om=L(()=>{});function oO(e){if(!e)return"";let t=e.trim();for(;t.startsWith('"')||t.startsWith("'");)t=t.slice(1).trim();for(;t.endsWith('"')||t.endsWith("'");)t=t.slice(0,-1).trim();if(t.includes("/")){let r=t.split("/");t=r[r.length-1].trim()}return t}function aO(e,t){return oO(e).toLowerCase()===oO(t).toLowerCase()}function Qn(e){if(!Array.isArray(e))return[];let t=new Map;for(let r of e){if(!r)continue;let n=oO(r);if(!n)continue;let o=n.toLowerCase();t.has(o)||t.set(o,n)}return Array.from(t.values())}var iO=L(()=>{});var am=L(()=>{Iu();qw();wt();gv();GH();Yw();Ut();Kw();ls();om();iO()});var Zn,wc,FC,va,Ra=L(()=>{ls();iO();Zn=(s=>(s.INSTRUMENT="instrument",s.ACCOUNT="account",s.ACCOUNT_TYPE="account_type",s.SETUP="setup",s.MISTAKE="mistake",s.TAG="tag",s.EVENT="event",s))(Zn||{}),wc={instrument:[],account:[],account_type:[],setup:[],mistake:[],tag:[],event:[]},FC={instrument:[{name:"AAPL",assetType:"stock"},{name:"MSFT",assetType:"stock"},{name:"TSLA",assetType:"stock"},{name:"ES1",assetType:"futures",futuresData:{dollarPerPoint:50,tickSize:.25,tickValue:12.5}},{name:"NQ1",assetType:"futures",futuresData:{dollarPerPoint:20,tickSize:.25,tickValue:5}},{name:"EURUSD",assetType:"forex"}],account:[],account_type:["Demo","Evaluation","Funded","Archived"],setup:["Breakout Setup","Reversal Pattern"],mistake:["Early Entry","Poor Position Sizing"],tag:["Swing Trade","Day Trade","Momentum","Reversal","Earnings"],event:[{name:"FOMC Meeting",color:"gray"},{name:"Earnings Announcement",color:"gray"},{name:"Economic Data Release",color:"gray"},{name:"Fed Speech",color:"gray"},{name:"Market Holiday",color:"gray"}]},va=class{constructor(t,r){this.options={...wc};this.namespace="";this.plugin=t,r!=null&&r.namespace&&(this.namespace=r.namespace),this.loadOptions(),this.initializeDefaultOptionsIfNeeded(),this.cleanupCorruptedOptions().catch(n=>{console.error("CustomOptionsService: Failed to cleanup corrupted options:",n)})}getOptionsKey(){return this.namespace?`customOptions_${this.namespace}`:"customOptions"}async loadOptions(){try{let t=this.getOptionsKey(),r=this.plugin;if(r.settings&&r.settings[t]){let n={...wc,...r.settings[t]};Array.isArray(n.instrument)&&(typeof n.instrument[0]=="string"?this.options.instrument=n.instrument.map(a=>({name:a,assetType:"stock"})):this.options.instrument=n.instrument),this.options.account=Qn(n.account||[]),this.options.account_type=Qn(n.account_type||[]),this.options.setup=Qn(n.setup||[]),this.options.mistake=Qn(n.mistake||[]),this.options.tag=Qn(n.tag||[]),Array.isArray(n.event)?this.options.event=n.event.map(o=>typeof o=="string"?{name:o,color:"gray"}:typeof o=="object"&&o!==null&&o.name?{name:o.name,color:o.color||"gray"}:null).filter(Boolean):this.options.event=[]}else if(!this.namespace&&r.settings&&r.settings.customOptions){let n={...wc,...r.settings.customOptions};Array.isArray(n.instrument)&&(typeof n.instrument[0]=="string"?this.options.instrument=n.instrument.map(a=>({name:a,assetType:"stock"})):this.options.instrument=n.instrument),this.options.account=Qn(n.account||[]),this.options.account_type=Qn(n.account_type||[]),this.options.setup=Qn(n.setup||[]),this.options.mistake=Qn(n.mistake||[]),this.options.tag=Qn(n.tag||[]),Array.isArray(n.event)?this.options.event=n.event.map(o=>typeof o=="string"?{name:o,color:"gray"}:typeof o=="object"&&o!==null&&o.name?{name:o.name,color:o.color||"gray"}:null).filter(Boolean):this.options.event=[]}else{let n=await this.plugin.loadData(),o=this.namespace?`customOptions_${this.namespace}`:"customOptions";if(n&&n[o]){let a={...wc,...n[o]};Array.isArray(a.instrument)&&(typeof a.instrument[0]=="string"?this.options.instrument=a.instrument.map(s=>({name:s,assetType:"stock"})):this.options.instrument=a.instrument),this.options.account=Qn(a.account||[]),this.options.account_type=Qn(a.account_type||[]),this.options.setup=Qn(a.setup||[]),this.options.mistake=Qn(a.mistake||[]),this.options.tag=Qn(a.tag||[]),this.options.event=a.event,r.settings&&(r.settings[t]={...this.options},await r.saveSettings())}else if(!this.namespace&&n&&n.customOptions){let a={...wc,...n.customOptions};Array.isArray(a.instrument)&&(typeof a.instrument[0]=="string"?this.options.instrument=a.instrument.map(s=>({name:s,assetType:"stock"})):this.options.instrument=a.instrument),this.options.account=Qn(a.account||[]),this.options.account_type=Qn(a.account_type||[]),this.options.setup=Qn(a.setup||[]),this.options.mistake=Qn(a.mistake||[]),this.options.tag=Qn(a.tag||[]),this.options.event=a.event,r.settings&&(r.settings[t]={...this.options},await r.saveSettings())}else this.options={...wc},this.initializeDefaultOptionsIfNeeded(),r.settings&&(r.settings[t]={...this.options},await r.saveSettings())}}catch(t){console.error("Failed to load custom options:",t),this.options={...wc}}}async cleanupCorruptedOptions(){let t=0,r=["tag","mistake","setup","account","account_type"];for(let n of r){if(n==="event"||n==="instrument")continue;let o=this.options[n],a=o.length,i=Qn(o);this.options[n]=i,t+=a-i.length}return t>0&&(console.log(`CustomOptionsService: Cleaned ${t} corrupted option entries`),await this.saveOptions()),t}async saveOptions(){try{let t=this.getOptionsKey(),r=this.plugin;if(r.settings)r.settings[t]={...this.options},await r.saveSettings();else{console.warn(`Plugin settings not accessible, using legacy save method with key: ${t}`);let o={...await this.plugin.loadData()||{},[t]:this.options};await this.plugin.saveData(o)}}catch(t){console.error(`Failed to save custom options with key: ${this.getOptionsKey()}:`,t)}}getOptions(t){return t==="event"?this.options.event.map(r=>r.name):t==="instrument"?this.options.instrument.map(r=>r.name):this.options[t]?[...this.options[t]]:(console.warn(`Options for type ${t} not initialized, returning empty array`),[])}getInstrumentsForAssetType(t){return this.options.instrument.filter(r=>r.assetType===t).map(r=>r.name)}isInstrumentValidForAssetType(t,r){return!t||!r?!1:this.options.instrument.some(n=>n.name.toLowerCase()===t.toLowerCase()&&n.assetType===r)}getAssetTypeForInstrument(t){if(!t)return;let r=this.options.instrument.find(n=>n.name.toLowerCase()===t.toLowerCase());return r==null?void 0:r.assetType}getFuturesDataForInstrument(t){if(!t)return;let r=this.options.instrument.find(n=>n.name.toLowerCase()===t.toLowerCase()&&n.assetType==="futures");return r==null?void 0:r.futuresData}async setFuturesDataForInstrument(t,r){if(!t)return!1;let n=this.options.instrument.findIndex(a=>a.name.toLowerCase()===t.toLowerCase()&&a.assetType==="futures");if(n===-1)return!1;let o={...r};return o.dollarPerPoint===0&&(o.dollarPerPoint=void 0),this.options.instrument[n].futuresData={...this.options.instrument[n].futuresData,...o},await this.saveOptions(),this.notifyOptionsChanged(),!0}getAllOptions(){return{...this.options}}async addOption(t,r,n,o,a){if(t==="event")return console.warn("Use addOrUpdateEventOption to add events with colors."),!1;let i=r.trim();if(!i)return!1;if(t==="instrument"){if(!n)return console.warn("Asset type is required when adding an instrument"),!1;if(this.options.instrument.some(c=>c.name.toLowerCase()===i.toLowerCase()&&c.assetType===n))return!1;let l={name:i,assetType:n};n==="futures"&&o&&(l.futuresData=o),n==="forex"&&a&&(l.forexData=a),this.options.instrument.push(l)}else{if(this.options[t].some(l=>aO(l,i)))return!1;this.options[t]=[...this.options[t],i]}return await this.saveOptions(),!0}async addOrUpdateEventOption(t,r){let n=t.trim(),a=["red","orange","yellow","gray"].includes(r)?r:"gray";if(!n)return!1;let i=this.options.event.findIndex(s=>s.name.toLowerCase()===n.toLowerCase());return i!==-1?this.options.event[i].color=a:this.options.event.push({name:n,color:a}),await this.saveOptions(),this.notifyOptionsChanged(),!0}async addOptions(t,r,n){if(t==="event")return console.warn("Use addOrUpdateEventOption to add events with colors. Skipping addOptions for EVENT."),0;if(!r.length)return 0;let o=r.map(a=>a.trim()).filter(a=>!!a);if(!o.length)return 0;if(t==="instrument"){if(!n)return console.warn("Asset type is required when adding instruments"),0;let a=0;for(let i of o)if(!this.options.instrument.some(l=>l.name.toLowerCase()===i.toLowerCase()&&l.assetType===n)){let l={name:i,assetType:n};n==="futures"&&(l.futuresData={dollarPerPoint:0,tickSize:0,tickValue:0}),this.options.instrument.push(l),a++}return a>0&&await this.saveOptions(),a}else{let a=o.filter(s=>{let l=s==null?void 0:s.trim();return l?!this.options[t].some(c=>aO(c,l)):!1}),i=Qn(a);return i.length?(this.options[t]=[...this.options[t],...i],await this.saveOptions(),i.length):0}}async removeOption(t,r){let n=!1;if(t==="event"){let o=this.options.event.length;this.options.event=this.options.event.filter(a=>a.name.toLowerCase()!==r.toLowerCase()),n=o!==this.options.event.length}else if(t==="instrument"){let o=this.options.instrument.length;this.options.instrument=this.options.instrument.filter(a=>a.name.toLowerCase()!==r.toLowerCase()),n=o!==this.options.instrument.length}else{let o=this.options[t].length;this.options[t]=this.options[t].filter(a=>a.toLowerCase()!==r.toLowerCase()),n=o!==this.options[t].length}return n?(await this.saveOptions(),await new Promise(o=>setTimeout(o,200)),this.notifyOptionsChanged()):console.warn(`Failed to remove option '${r}' from ${t} - option not found`),n}async updateInstrument(t,r,n,o,a=!1,i){let s=r.trim();if(!s)return{success:!1};if(!n)return{success:!1};let l=this.options.instrument.findIndex(p=>p.name.toLowerCase()===t.toLowerCase());if(l===-1)return console.warn(`Instrument '${t}' not found`),{success:!1};if(this.options.instrument.some((p,m)=>m!==l&&p.name.toLowerCase()===s.toLowerCase()&&p.assetType===n))return console.warn(`Instrument '${s}' already exists with asset type '${n}'`),{success:!1};let d={name:s,assetType:n};n==="futures"&&(d.futuresData=o||this.options.instrument[l].futuresData||{dollarPerPoint:0,tickSize:0,tickValue:0}),n==="forex"&&(d.forexData=i||this.options.instrument[l].forexData),this.options.instrument[l]=d,await this.saveOptions();let u=0;return a&&t!==s&&(u=await this.updateNotesWithOption("instrument",t,s)),this.notifyOptionsChanged(),{success:!0,updatedNotes:u}}async updateOption(t,r,n,o=!1){let a=n.trim();if(!a)return{success:!1};if(t==="instrument")return console.warn("Use updateInstrument method for instruments"),{success:!1};let i=!1,s=-1;if(t==="event"){if(this.options.event.some(d=>d.name.toLowerCase()===a.toLowerCase()&&d.name.toLowerCase()!==r.toLowerCase()))return{success:!1};s=this.options.event.findIndex(d=>d.name.toLowerCase()===r.toLowerCase()),s!==-1&&(this.options.event[s].name=a,i=!0)}else{if(this.options[t].some(d=>d.toLowerCase()===a.toLowerCase()&&d.toLowerCase()!==r.toLowerCase()))return{success:!1};s=this.options[t].findIndex(d=>d.toLowerCase()===r.toLowerCase()),s!==-1&&(this.options[t][s]=a,i=!0)}if(!i)return{success:!1};await this.saveOptions();let l=0;return o&&(l=await this.updateNotesWithOption(t,r,n)),this.notifyOptionsChanged(),{success:!0,updatedNotes:l}}async updateNotesWithOption(t,r,n){try{let o=this.getApp().vault.getMarkdownFiles(),i={instrument:["instrument"],account:["account","accountIds"],setup:["setup","setupIds"],mistake:["mistake","mistakeIds"],tag:["customTags"],event:["keyEvents"]}[t];if(!i||i.length===0)return console.warn(`No property names defined for option type: ${t}`),0;let s=0;for(let l of o)try{let c=await this.getApp().vault.read(l),d=c.match(/^---\n([\s\S]*?)\n---/);if(!d)continue;let p=d[1].split(`
`),m=!1,f=p.map(g=>{var v;for(let h of i)if(h==="keyEvents"&&t==="event"){let y=g.match(/^(\s*-\s*event:\s*)(.+)$/);if(y){let b=y[1],x=y[2].trim();if(this.optionValueMatches(x,r))return m=!0,`${b}${n}`}}else if(g.trim().startsWith(`${h}:`)&&!g.includes("[")){let y=(v=g.split(":")[1])==null?void 0:v.trim();if(y&&this.optionValueMatches(y,r))return m=!0,`${h}: ${n}`}else if(g.trim().startsWith(`${h}:`)&&g.includes("[")){let y=g.match(/\[(.*?)\]/);if(y){let b=y[1].split(",").map(w=>w.trim()),x=b.map(w=>this.optionValueMatches(w,r)?n:w);if(b.some((w,S)=>w!==x[S]))return m=!0,`${h}: [${x.join(", ")}]`}}return g});if(m){let g=c.replace(/^---\n[\s\S]*?\n---/,`---
${f.join(`
`)}
---`);await this.getApp().vault.modify(l,g),await yr(this.getApp(),l);let v=new CustomEvent(`journalit:${this.namespace}-updated`,{detail:{id:l.path}});document.dispatchEvent(v),s++,t==="instrument"&&await this.updateFileNameForInstrument(l,r,n)}}catch(c){console.error(`Error processing file ${l.path}:`,c)}return s}catch(o){return console.error("Error updating notes with new option value:",o),0}}optionValueMatches(t,r){return t.toLowerCase()===r.toLowerCase()}async updateFileNameForInstrument(t,r,n){try{let o=this.extractTickerPart(r),a=this.extractTickerPart(n),i=this.sanitizeTickerForFilename(o),s=this.sanitizeTickerForFilename(a),l=t.path.split("/"),c=l.pop()||"",d=l.join("/");if(!c.match(/^[A-Z0-9-]+-[0-9]{6}-T\d+\.md$/)||!c.startsWith(`${i}-`))return;let u=c.replace(new RegExp(`^${i}-`),`${s}-`),p=`${d}/${u}`;if(p===t.path)return;await this.getApp().fileManager.renameFile(t,p)}catch(o){console.error(`Error updating filename for '${t.path}':`,o)}}extractTickerPart(t){if(!t)return"";let r=t.match(/^([A-Z0-9.^-]+)(?:\s+-\s+|$)/);return r&&r[1]?r[1].trim():t}sanitizeTickerForFilename(t){if(!t)return"UNKNOWN";let r=t.trim().toUpperCase();if(r=r.replace(/[\\/:*?"<>|+]/g,"").replace(/[\s.\[\]\(\)\{\}#%&=;]/g,"-").replace(/--+/g,"-").replace(/^-|-$/g,""),!r)return"UNKNOWN";let n=20;return r.length>n&&(r=r.substring(0,n)),r}getApp(){return this.plugin.app}async clearOptions(t){let r=t==="instrument"?this.options[t].length:this.options[t].length;return r===0?0:(t==="instrument"?this.options[t]=[]:t==="event"?this.options[t]=[]:this.options[t]=[],await this.saveOptions(),await new Promise(n=>setTimeout(n,200)),this.notifyOptionsChanged(),r)}async resetAllOptions(){this.options={...wc},await this.saveOptions(),await new Promise(t=>setTimeout(t,200)),this.notifyOptionsChanged()}async reloadOptions(){await this.loadOptions()}async initializeDefaultOptionsIfNeeded(){var t;try{let r=!1,n=this.plugin,o=((t=n.settings)==null?void 0:t.initializedOptionTypes)||[],a=[];for(let i of Object.values(Zn))if(this.options[i].length===0&&FC[i].length>0&&!o.includes(i))if(r=!0,i==="event"){let s=FC.event;for(let l of s)this.options.event.findIndex(d=>d.name.toLowerCase()===l.name.toLowerCase())===-1&&this.options.event.push({name:l.name,color:l.color||"gray"});a.push(i)}else if(i==="instrument"){let s=FC.instrument;for(let l of s)this.options.instrument.findIndex(d=>d.name.toLowerCase()===l.name.toLowerCase())===-1&&this.options.instrument.push({name:l.name,assetType:l.assetType,futuresData:l.futuresData});a.push(i)}else{let s=FC[i];this.options[i]=[...this.options[i],...s],a.push(i)}r&&(await this.saveOptions(),a.length>0&&(n.settings.initializedOptionTypes||(n.settings.initializedOptionTypes=[]),n.settings.initializedOptionTypes=[...new Set([...n.settings.initializedOptionTypes,...a])],await n.saveSettings()))}catch(r){console.error("Failed to initialize default options:",r)}}notifyOptionsChanged(){try{let t={timestamp:Date.now(),...this.namespace?{namespace:this.namespace}:{}},r=new CustomEvent("journalit-options-changed",{detail:t});document.dispatchEvent(r)}catch(t){console.error("Failed to dispatch options changed event:",t)}}getEventOptionByName(t){let r=t.trim().toLowerCase();return this.options.event.find(n=>n.name.toLowerCase()===r)}getNamespace(){return this.namespace}async setNamespace(t){this.namespace!==t&&(this.namespace=t,this.options={...wc},await this.loadOptions(),this.notifyOptionsChanged())}}});var Au=L(()=>{Ra()});function YH(e,t){let r=Object.keys(t).map(n=>dbe(e,n,t[n]));return r.length===1?r[0]:function(){r.forEach(n=>n())}}function dbe(e,t,r){let n=e[t],o=e.hasOwnProperty(t),a=o?n:function(){return Object.getPrototypeOf(e)[t].apply(this,arguments)},i=r(a);return n&&Object.setPrototypeOf(i,n),Object.setPrototypeOf(s,i),e[t]=s,l;function s(...c){return i===a&&e[t]===s&&l(),i.apply(this,c)}function l(){e[t]===s&&(o?e[t]=a:delete e[t]),i!==a&&(i=a,Object.setPrototypeOf(s,n||Function))}}var KH=L(()=>{});var im,Jw,OC,Xw,ube,JH,xe,pt=L(()=>{im=q(Y());KH();Jw=null,OC=!1,Xw=new Set,ube=()=>{OC=!0,Xw.forEach(e=>e()),Xw.clear()},JH=e=>{Jw=e,setTimeout(ube,0);let t=YH(e,{unload:r=>async()=>(Jw=null,OC=!1,Xw.clear(),await r())});document.dispatchEvent(new CustomEvent("journalit:plugin-updated"))},xe=()=>{let[e,t]=(0,im.useState)(OC?Jw:null),r=(0,im.useRef)(!0),n=(0,im.useCallback)(()=>{r.current&&Jw!==e&&t(Jw)},[e]);return(0,im.useEffect)(()=>(r.current=!0,OC?n():Xw.add(n),document.addEventListener("journalit:plugin-updated",n),()=>{r.current=!1,Xw.delete(n),document.removeEventListener("journalit:plugin-updated",n)}),[n]),e}});var sm,XH,cs,Ke,rr=L(()=>{sm=q(Y());nm();pt();XH=(0,sm.createContext)(void 0),cs=({children:e})=>{var o,a;let t=xe(),r=((a=(o=t==null?void 0:t.settings)==null?void 0:o.general)==null?void 0:a.currency)||"USD";(0,sm.useEffect)(()=>{let i=s=>{!t||t.settings};return window.addEventListener("journalit-currency-changed",i),()=>{window.removeEventListener("journalit-currency-changed",i)}},[]);let n={currency:r};return sm.default.createElement(XH.Provider,{value:n},e)},Ke=()=>{let e=(0,sm.useContext)(XH);if(e===void 0)throw new Error("useCurrency must be used within a CurrencyProvider");return e}});var QH,ZH,eq=L(()=>{QH=()=>{let e="journalit-asset-fields-styles";if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=`
    /* Loading accounts container */
    .asset-loading-accounts {
      padding: 12px;
      border: 1px solid var(--background-modifier-border);
      border-radius: 4px;
      color: var(--text-muted);
      background-color: var(--background-secondary);
    }

    /* Account label */
    .asset-account-label {
      margin-bottom: 8px;
    }

    /* Error message */
    .asset-error-message {
      font-size: 12px;
      color: var(--text-error);
      margin-top: 4px;
    }

    /* Commission grid */
    .commission-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      align-items: flex-start;
    }

    /* Risk management section */
    .risk-management-section {
      margin-top: 20px;
    }

    .risk-fields {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 16px;
    }

    /* Calculated risk hint */
    .calculated-risk-hint {
      font-size: 12px;
      color: var(--text-muted);
      margin-top: 4px;
      display: block;
    }
  `,document.head.appendChild(t)},ZH=()=>{let t=document.getElementById("journalit-asset-fields-styles");t&&t.remove()}});var yv,pbe,tq,rq=L(()=>{yv=q(Y());Pl();pbe=({data:e,errors:t,onChange:r})=>yv.default.createElement(yv.default.Fragment,null,yv.default.createElement("div",{className:"field"},yv.default.createElement($r,{label:"Exchange",placeholder:"e.g., NYSE, NASDAQ",value:e.exchange||"",onChange:n=>r("exchange",n),error:t.exchange}))),tq=yv.default.memo(pbe)});function jC(e){switch(e){case"forex":return 5;case"crypto":return 8;case"futures":return 4;case"options":return 4;case"stock":return 2;case"cfd":return 4;default:return 4}}function nq(e){switch(e){case"forex":return 4;case"crypto":return 8;case"futures":return 0;case"options":return 0;case"stock":return 2;case"cfd":return 2;default:return 2}}var zC=L(()=>{tm()});var Ua,mbe,oq,aq=L(()=>{Ua=q(Y());Pl();zC();mbe=({data:e,errors:t,onChange:r})=>{let n=jC(e.assetType);return Ua.default.createElement(Ua.default.Fragment,null,Ua.default.createElement("div",{className:"field"},Ua.default.createElement(ji,{label:"Expiration Date",value:e.expirationDate,onChange:o=>r("expirationDate",o),error:t.expirationDate,required:!0})),Ua.default.createElement("div",{className:"field"},Ua.default.createElement(ur,{label:"Strike Price",value:e.strikePrice,onChange:o=>r("strikePrice",o),error:t.strikePrice,min:0,precision:n,allowDecimal:!0,required:!0})),Ua.default.createElement("div",{className:"field"},Ua.default.createElement("label",{className:"label",id:"optionType-label"},"Option Type",Ua.default.createElement("span",{className:"required-indicator"},"*")),Ua.default.createElement("div",{className:"direction-container",role:"radiogroup","aria-labelledby":"optionType-label","aria-required":"true"},Ua.default.createElement("button",{type:"button",className:"direction-button",onClick:()=>r("optionType","call"),"aria-checked":e.optionType==="call",role:"radio"},"Call"),Ua.default.createElement("button",{type:"button",className:"direction-button",onClick:()=>r("optionType","put"),"aria-checked":e.optionType==="put",role:"radio"},"Put")),t.optionType&&Ua.default.createElement("div",{className:"errorMessage",role:"alert"},t.optionType)),Ua.default.createElement("div",{className:"field"},Ua.default.createElement(ur,{label:"Contract Size",value:e.contractSize,onChange:o=>r("contractSize",o),error:t.contractSize,min:1,precision:0,allowDecimal:!1})))},oq=Ua.default.memo(mbe)});var kc,fbe,iq,sq=L(()=>{kc=q(Y());Pl();fbe=({data:e,errors:t,onChange:r})=>kc.default.createElement(kc.default.Fragment,null,kc.default.createElement("div",{className:"field"},kc.default.createElement(ur,{label:"Dollars per point",value:e.dollarPerPoint,onChange:n=>r("dollarPerPoint",n),error:t.dollarPerPoint,min:.01,precision:2,allowDecimal:!0,required:!0,placeholder:"ex: 50 for ES1"})),kc.default.createElement("div",{className:"twoColumnLayout"},kc.default.createElement("div",{className:"field"},kc.default.createElement(ur,{label:"Tick Size",value:e.tickSize,onChange:n=>r("tickSize",n),error:t.tickSize,min:0,precision:2,allowDecimal:!0})),kc.default.createElement("div",{className:"field"},kc.default.createElement(ur,{label:"Tick Value",value:e.tickValue,onChange:n=>r("tickValue",n),error:t.tickValue,min:0,precision:2,allowDecimal:!0})))),iq=kc.default.memo(fbe)});var qs,gbe,lq,cq=L(()=>{qs=q(Y());Pl();gbe=({data:e,errors:t,onChange:r})=>{let n=[1e5,1e4,1e3],o=e.lotSize!==void 0&&e.lotSize!==null&&!n.includes(e.lotSize);return qs.default.createElement(qs.default.Fragment,null,qs.default.createElement("div",{className:"field"},qs.default.createElement("label",{className:"label",id:"lotSize-label"},"Lot Size"),qs.default.createElement("div",{className:"asset-type-container",role:"radiogroup","aria-labelledby":"lotSize-label"},[{value:1e5,label:"Standard (100,000)"},{value:1e4,label:"Mini (10,000)"},{value:1e3,label:"Micro (1,000)"},{value:"custom",label:"Custom"}].map(a=>qs.default.createElement("button",{key:a.value,type:"button",className:"asset-type-button",onClick:()=>{a.value==="custom"?r("lotSize",o?e.lotSize:0):r("lotSize",a.value)},"aria-checked":a.value==="custom"?o:e.lotSize===a.value,role:"radio"},a.label))),t.lotSize&&qs.default.createElement("div",{className:"errorMessage",role:"alert"},t.lotSize)),o&&qs.default.createElement("div",{className:"field"},qs.default.createElement(ur,{label:"Custom Lot Size",value:e.lotSize,onChange:a=>r("lotSize",a),error:t.lotSize,min:1,precision:0,allowDecimal:!1,required:!0})),qs.default.createElement("div",{className:"field"},qs.default.createElement(ur,{label:"Pip Value",value:e.pipValue,onChange:a=>r("pipValue",a),error:t.pipValue,min:0,precision:4,allowDecimal:!0})))},lq=qs.default.memo(gbe)});var bv,hbe,dq,uq=L(()=>{bv=q(Y());Pl();hbe=({data:e,errors:t,onChange:r})=>bv.default.createElement(bv.default.Fragment,null,bv.default.createElement("div",{className:"field"},bv.default.createElement($r,{label:"Exchange",placeholder:"e.g., Binance, Coinbase",value:e.cryptoExchange||"",onChange:n=>r("cryptoExchange",n),error:t.cryptoExchange}))),dq=bv.default.memo(hbe)});var lm,vbe,pq,mq=L(()=>{lm=q(Y());Pl();vbe=({data:e,errors:t,onChange:r})=>lm.default.createElement(lm.default.Fragment,null,lm.default.createElement("div",{className:"field"},lm.default.createElement(ur,{label:"Contract Size",value:e.contractSize,onChange:n=>r("contractSize",n),error:t.contractSize,min:1,precision:0,allowDecimal:!1})),lm.default.createElement("div",{className:"field"},lm.default.createElement(ur,{label:"Leverage Ratio",placeholder:"e.g., 100 for 1:100",value:e.leverageRatio,onChange:n=>r("leverageRatio",n),error:t.leverageRatio,min:1,precision:0,allowDecimal:!1}))),pq=lm.default.memo(vbe)});var fq,gq,hq=L(()=>{fq=()=>{let e="journalit-entry-exit-styles";if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=`
    /* Entry/Exit Fields styling */
    .entries-section, .exits-section {
      margin-bottom: 16px;
      padding: 12px;
      border: 1px solid var(--background-modifier-border);
      border-radius: 4px;
      background-color: var(--background-primary);
    }

    .section-title {
      margin: 0 0 12px 0;
      font-size: 16px;
      font-weight: 600;
      display: flex;
      align-items: center;
      color: var(--text-normal);
    }

    .badge {
      display: inline-block;
      background: var(--interactive-accent);
      color: white;
      font-size: 12px;
      padding: 2px 6px;
      border-radius: 10px;
      margin-left: 8px;
    }

    .entry-row, .exit-row {
      display: flex;
      align-items: flex-start;
      margin-bottom: 8px;
      padding-bottom: 8px;
      border-bottom: 1px solid var(--background-modifier-border);
    }

    .entry-index, .exit-index {
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--background-secondary);
      border-radius: 50%;
      margin-right: 12px;
      font-size: 12px;
      font-weight: 600;
      flex-shrink: 0;
      margin-top: 26px; /* Align with input fields */
    }

    .entry-fields, .exit-fields {
      display: flex;
      flex: 1;
      gap: 12px;
      flex-wrap: wrap;
    }

    .time-field {
      flex: 2;
      min-width: 180px;
    }

    .price-field, .size-field {
      flex: 1;
      min-width: 120px;
    }

    /* Make remove button class more specific to avoid conflicts */
    .entry-row .remove-button,
    .exit-row .remove-button {
      width: 28px;
      height: 28px;
      min-width: 28px;
      padding: 0;
      margin-left: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      margin-top: 26px; /* Align with input fields */
    }

    .add-button {
      margin-top: 8px;
      margin-bottom: 12px;
    }

    .total-size, .remaining-size {
      font-size: 14px;
      font-weight: 600;
      padding: 4px 8px;
      border-radius: 4px;
      background: var(--background-secondary);
      display: inline-block;
      margin-top: 8px;
    }

    .remaining-size.positive {
      color: var(--text-success);
    }

    .remaining-size.neutral {
      color: var(--text-normal);
    }

    /* PNL Mode Toggle */
    .journalit-pnl-mode-toggle {
      margin-bottom: 12px;
      padding: 8px 12px;
      border: 1px solid var(--background-modifier-border);
      border-radius: 8px;
      background: var(--background-primary);
    }

    .journalit-pnl-toggle-container {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .journalit-pnl-toggle-label {
      font-weight: 500;
      color: var(--text-normal);
    }

    .journalit-pnl-toggle-description {
      color: var(--text-muted);
      font-size: 0.9em;
      line-height: 1.4;
      margin: 0;
    }

    .journalit-direct-pnl-section {
      margin-bottom: 24px;
    }

    /* Toggle Switch Component */
    .toggle-switch-container {
      position: relative;
      display: inline-block;
      width: 40px;
      height: 24px;
    }

    .toggle-switch-input {
      opacity: 0;
      width: 0;
      height: 0;
      position: absolute;
    }

    .toggle-switch-label {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: var(--background-modifier-border);
      transition: background-color 0.3s ease, box-shadow 0.3s ease;
      border-radius: 34px;
      overflow: hidden;
    }

    .toggle-switch-label .toggle-switch-button {
      position: absolute;
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: var(--background-primary);
      transition: transform 0.3s ease;
      border-radius: 50%;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    .toggle-switch-input:checked + .toggle-switch-label {
      background-color: var(--interactive-accent);
      box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.2);
    }

    .toggle-switch-input:checked + .toggle-switch-label .toggle-switch-button {
      transform: translateX(16px);
    }

    .toggle-switch-input:focus + .toggle-switch-label {
      box-shadow: 0 0 2px var(--interactive-accent);
    }

    .toggle-switch-container.disabled {
      opacity: 0.6;
    }

    .toggle-switch-container.disabled .toggle-switch-label {
      cursor: not-allowed;
    }

    /* Mobile responsiveness */
    @media (max-width: 768px) {
      .entry-fields, .exit-fields {
        flex-direction: column;
        gap: 8px;
      }

      .time-field, .price-field, .size-field {
        width: 100%;
        min-width: 0;
      }
    }
  `,document.head.appendChild(t)},gq=()=>{let t=document.getElementById("journalit-entry-exit-styles");t&&t.remove()}});var vq,he,Nr=L(()=>{vq=q(Y()),he=({variant:e="secondary",size:t="medium",fullWidth:r=!1,loading:n=!1,className:o="",children:a,...i})=>{let s="journalit-button",l=t==="sm"?"small":t==="md"?"medium":t==="lg"?"large":t,d=[s,`${s}--${e==="outline"?"secondary":e==="text"?"plain":e}`,`${s}--${l}`,r?`${s}--full-width`:"",n?`${s}--loading`:"",o].filter(Boolean).join(" ");return vq.default.createElement("button",{className:d,type:i.type||"button",disabled:n||i.disabled,...i},a)}});var Qw,ybe,Zo,sO=L(()=>{Qw=q(Y()),ybe=({checked:e,onChange:t,id:r,ariaLabel:n="Toggle switch",disabled:o=!1})=>{let a=s=>{o||t(s.target.checked)},i=r||`toggle-${Math.random().toString(36).substring(2,9)}`;return Qw.default.createElement("div",{className:`toggle-switch-container ${o?"disabled":""}`},Qw.default.createElement("input",{type:"checkbox",id:i,className:"toggle-switch-input",checked:e,onChange:a,"aria-label":n,disabled:o}),Qw.default.createElement("label",{htmlFor:i,className:"toggle-switch-label"},Qw.default.createElement("span",{className:"toggle-switch-button"})))},Zo=ybe});var Yt,bbe,yq,bq=L(()=>{Yt=q(Y());hq();Pl();Nr();sO();tm();zC();pt();bbe=({data:e,errors:t,onChange:r})=>{var y,b;let n=xe(),o=()=>{let x=[...e.entries||[],{time:new Date,price:0,size:0}];r("entries",x),d(x,e.exits||[])},a=x=>{let w=[...e.entries||[]];w.splice(x,1),r("entries",w),d(w,e.exits||[])},i=()=>{let x=[...e.exits||[],{time:new Date,price:0,size:0}];r("exits",x),d(e.entries||[],x)},s=x=>{let w=[...e.exits||[]];w.splice(x,1),r("exits",w),d(e.entries||[],w)},l=(x,w,S)=>{let k=[...e.entries||[]];if(w==="time"&&typeof S=="string"){let T=new Date(S);S=isNaN(T.getTime())?void 0:T}k[x]={...k[x],[w]:S},r("entries",k),d(k,e.exits||[])},c=(x,w,S)=>{let k=[...e.exits||[]];if(w==="time"&&typeof S=="string"){let T=new Date(S);S=isNaN(T.getTime())?void 0:T}k[x]={...k[x],[w]:S},r("exits",k),d(e.entries||[],k)},d=(x,w)=>{if(!x.length&&!w.length){r("entryPrice",void 0),r("exitPrice",void 0),r("positionSize",void 0),r("entryTime",void 0),r("exitTime",void 0);return}let S=0,k=0;x.forEach(D=>{D.size!==void 0&&D.price!==void 0&&(S+=D.price*D.size,k+=D.size)});let T=0,P=0;if(w.forEach(D=>{D.size!==void 0&&D.price!==void 0&&(T+=D.price*D.size,P+=D.size)}),k>0){r("entryPrice",S/k),r("positionSize",k);let D=x.reduce((O,z)=>z.time&&(!O||z.time<O)?z.time:O,null);D&&r("entryTime",D)}if(P>0){r("exitPrice",T/P);let D=w.reduce((O,z)=>z.time&&(!O||z.time>O)?z.time:O,null);D&&r("exitTime",D)}else r("exitPrice",void 0),r("exitTime",void 0)},u=async x=>{r("useDirectPnLInput",x);try{n&&(n.settings.trade={...n.settings.trade,useDirectPnLInput:x},await n.saveSettings())}catch(w){console.error("Error saving PNL input mode preference:",w)}},p=()=>{switch(e.assetType){case"stock":return"Shares";case"options":case"futures":return"Contracts";case"forex":return"Lots";case"crypto":return"Amount";case"cfd":return"CFD Units";default:return"Position Size"}},m=(e.entries||[]).reduce((x,w)=>x+(w.size||0),0),f=(e.exits||[]).reduce((x,w)=>x+(w.size||0),0),g=m-f,v=jC(e.assetType),h=nq(e.assetType);return(0,Yt.useEffect)(()=>(fq(),()=>{gq()}),[]),Yt.default.createElement(Yt.default.Fragment,null,Yt.default.createElement("div",{className:"journalit-pnl-mode-toggle"},Yt.default.createElement("div",{className:"journalit-pnl-toggle-container"},Yt.default.createElement(Zo,{checked:e.useDirectPnLInput||!1,onChange:u,id:"use-direct-pnl",ariaLabel:"Enter PNL directly instead of prices"}),Yt.default.createElement("label",{htmlFor:"use-direct-pnl",className:"journalit-pnl-toggle-label"},"Enter PNL directly instead of prices")),Yt.default.createElement("p",{className:"journalit-pnl-toggle-description"},e.useDirectPnLInput?"Enter your total profit/loss directly. Commission and fees will still be subtracted.":"Calculate PNL from entry/exit prices and position sizes.")),e.useDirectPnLInput&&Yt.default.createElement("div",{className:"journalit-direct-pnl-section"},Yt.default.createElement("div",{className:"field"},Yt.default.createElement(ur,{label:"Total P&L",value:e.directPnL,onChange:x=>r("directPnL",x),error:t.directPnL,allowDecimal:!0,precision:2,required:!e.isMissedTrade,placeholder:"Enter total profit or loss"}))),Yt.default.createElement("div",{className:"entries-section"},Yt.default.createElement("h4",{className:"section-title"},"Entries ",e.useDirectPnLInput?"(optional)":""," ",Yt.default.createElement("span",{className:"badge"},((y=e.entries)==null?void 0:y.length)||0)),(e.entries||[]).map((x,w)=>{var S,k,T,P,D,O,z;return Yt.default.createElement("div",{key:`entry-${w}`,className:"entry-row"},Yt.default.createElement("div",{className:"entry-index"},w+1),Yt.default.createElement("div",{className:"entry-fields"},Yt.default.createElement(ji,{label:"Time",value:x.time,onChange:I=>l(w,"time",I),error:(k=(S=t.entries)==null?void 0:S[w])==null?void 0:k.time,includeTime:!0,required:!e.isMissedTrade&&!e.useDirectPnLInput,className:"time-field"}),Yt.default.createElement(ur,{label:"Price",value:x.price,onChange:I=>l(w,"price",I),error:(P=(T=t.entries)==null?void 0:T[w])==null?void 0:P.price,min:0,precision:v,allowDecimal:!0,required:!e.isMissedTrade&&!e.useDirectPnLInput,className:"price-field"}),Yt.default.createElement(ur,{label:"Size",value:x.size,onChange:I=>l(w,"size",I),error:(O=(D=t.entries)==null?void 0:D[w])==null?void 0:O.size,min:0,precision:h,required:!e.isMissedTrade&&!e.useDirectPnLInput,className:"size-field"})),(((z=e.entries)==null?void 0:z.length)||0)>1&&Yt.default.createElement(he,{variant:"outline",className:"remove-button",onClick:()=>a(w),title:"Remove Entry"},"-"))}),Yt.default.createElement(he,{variant:"outline",className:"add-button",onClick:o,title:"Add Entry"},"+ Add Entry"),Yt.default.createElement("div",{className:"total-size"},"Total Entry Size: ",m.toFixed(h))),Yt.default.createElement("div",{className:"exits-section"},Yt.default.createElement("h4",{className:"section-title"},"Exits ",e.useDirectPnLInput?"(optional)":""," ",Yt.default.createElement("span",{className:"badge"},((b=e.exits)==null?void 0:b.length)||0)),(e.exits||[]).map((x,w)=>{var S,k,T,P,D,O,z;return Yt.default.createElement("div",{key:`exit-${w}`,className:"exit-row"},Yt.default.createElement("div",{className:"exit-index"},w+1),Yt.default.createElement("div",{className:"exit-fields"},Yt.default.createElement(ji,{label:"Time",value:x.time,onChange:I=>c(w,"time",I),error:(k=(S=t.exits)==null?void 0:S[w])==null?void 0:k.time,includeTime:!0,required:!e.isMissedTrade&&!e.useDirectPnLInput,className:"time-field"}),Yt.default.createElement(ur,{label:"Price",value:x.price,onChange:I=>c(w,"price",I),error:(P=(T=t.exits)==null?void 0:T[w])==null?void 0:P.price,min:0,precision:v,allowDecimal:!0,required:!e.isMissedTrade&&!e.useDirectPnLInput,className:"price-field"}),Yt.default.createElement(ur,{label:"Size",value:x.size,onChange:I=>c(w,"size",I),error:(O=(D=t.exits)==null?void 0:D[w])==null?void 0:O.size,min:0,precision:h,required:!e.isMissedTrade&&!e.useDirectPnLInput,className:"size-field"})),(((z=e.exits)==null?void 0:z.length)||0)>1&&Yt.default.createElement(he,{variant:"outline",className:"remove-button",onClick:()=>s(w),title:"Remove Exit"},"-"))}),Yt.default.createElement(he,{variant:"outline",className:"add-button",onClick:i,title:"Add Exit"},"+ Add Exit"),Yt.default.createElement("div",{className:`remaining-size ${g>0?"positive":"neutral"}`},"Remaining Position: ",g.toFixed(h)," ",g>0?"(Open)":"(Closed)")),!e.useDirectPnLInput&&t.entriesExits&&Yt.default.createElement("div",{className:"errorMessage",role:"alert"},t.entriesExits))},yq=Yt.default.memo(bbe)});var We,xq,xbe,wq,lO=L(()=>{We=q(Y()),xq=require("obsidian");Pl();lv();tm();Rf();am();Ut();Au();rr();eq();gv();rq();aq();sq();cq();uq();mq();bq();xbe=({data:e,errors:t,onChange:r,instruments:n=[]})=>{var I,A,j,E,N,B;let{currency:o}=Ke(),[a,i]=(0,We.useState)([]),[s,l]=(0,We.useState)({}),[c,d]=(0,We.useState)({}),[u,p]=(0,We.useState)([]),[m,f]=(0,We.useState)(!1);(0,We.useEffect)(()=>{let C=Xn().plugins.plugins.journalit,F=C&&C.optionsService?C.optionsService:new va(null),M=async()=>{var $;try{f(!0);let H=C==null?void 0:C.tradeService;if(!H){console.warn("TradeService not available, skipping account loading"),f(!1);return}let R=await H.getUniqueAccounts(),V=Object.keys((($=C.settings.account)==null?void 0:$.accountMetadata)||{}),K=[...new Set([...R,...V])],X={},G={};K.forEach(J=>{X[J]=J,G[J]=J}),i(K),l(X),d(G);let U=e.assetType?F.getInstrumentsForAssetType(e.assetType):[],Q=e.instrument&&e.assetType&&!U.includes(e.instrument)?[...U,e.instrument]:[...U];e.instrument&&e.assetType&&U.includes(e.instrument),p(Q)}catch(H){console.error("Failed to load options:",H),i([]),p([])}finally{f(!1)}};M();let _=()=>{M()},W=()=>{setTimeout(()=>{try{let H=e.assetType?F.getInstrumentsForAssetType(e.assetType):[];JSON.stringify(H)!==JSON.stringify(u)&&p(H)}catch(H){console.error("Error updating instrument options:",H)}},300)};return document.addEventListener("journalit-options-changed",W,{capture:!1}),document.addEventListener("journalit:account-created",_),document.addEventListener("journalit:account-updated",_),document.addEventListener("journalit:account-deleted",_),()=>{document.removeEventListener("journalit-options-changed",W,{capture:!1}),document.removeEventListener("journalit:account-created",_),document.removeEventListener("journalit:account-updated",_),document.removeEventListener("journalit:account-deleted",_)}},[e.assetType,e.instrument]);let g=C=>!C||!C.length?[]:C.map(F=>s[F]||F),v=C=>!C||!C.length?[]:C.map(F=>c[F]||F),h=async C=>{try{let F=Xn().plugins.plugins.journalit,M=F?F.optionsService:new va(null);if(!e.assetType){console.error("Cannot add instrument: No asset type selected"),new xq.Notice("Asset type is required when adding an instrument");return}await M.addOption("instrument",C,e.assetType)&&M.notifyOptionsChanged()}catch(F){console.error("Failed to save custom instrument option:",F)}};(0,We.useEffect)(()=>{if(!e.instrument||!e.assetType)return;let C=Xn().plugins.plugins.journalit,F=C?C.optionsService:new va(null),M=C?C.specService:null;if(!F.isInstrumentValidForAssetType(e.instrument,e.assetType)){r("instrument","");return}if(e.assetType==="futures"){let W=!1;if(M){let $=M.getSpecsForSymbol(e.instrument,"futures");$&&"dollarPerPoint"in $&&(r("dollarPerPoint",$.dollarPerPoint),r("tickSize",$.tickSize),r("tickValue",$.tickValue),W=!0)}if(!W)try{let $=F.getFuturesDataForInstrument(e.instrument);$?($.dollarPerPoint!==void 0&&$.dollarPerPoint!==0?r("dollarPerPoint",$.dollarPerPoint):r("dollarPerPoint",void 0),$.tickSize!==void 0?r("tickSize",$.tickSize):r("tickSize",void 0),$.tickValue!==void 0?r("tickValue",$.tickValue):r("tickValue",void 0)):(r("dollarPerPoint",void 0),r("tickSize",void 0),r("tickValue",void 0))}catch($){console.error("Failed to load futures data from CustomOptionsService:",$),r("dollarPerPoint",void 0),r("tickSize",void 0),r("tickValue",void 0)}}if(e.assetType==="forex")if(M){let W=M.getSpecsForSymbol(e.instrument,"forex");W&&"lotSize"in W&&"pipValue"in W?(r("pipValue",W.pipValue),r("lotSize",W.lotSize)):(r("pipValue",void 0),r("lotSize",void 0))}else r("pipValue",void 0),r("lotSize",void 0)},[e.instrument,e.assetType]),(0,We.useEffect)(()=>{e.assetType!=="forex"&&(e.pipValue!==void 0&&r("pipValue",void 0),e.lotSize!==void 0&&r("lotSize",void 0)),e.assetType!=="futures"&&(e.dollarPerPoint!==void 0&&r("dollarPerPoint",void 0),e.tickSize!==void 0&&r("tickSize",void 0),e.tickValue!==void 0&&r("tickValue",void 0))},[e.assetType]),(0,We.useEffect)(()=>{if(e.assetType!=="futures"||!e.instrument||e.dollarPerPoint===void 0)return;let C=Xn().plugins.plugins.journalit,F=C?C.optionsService:new va(null),M=setTimeout(async()=>{try{await F.setFuturesDataForInstrument(e.instrument,{dollarPerPoint:e.dollarPerPoint,tickSize:e.tickSize,tickValue:e.tickValue})}catch(_){console.error("Failed to save futures data for instrument:",_)}},1e3);return()=>clearTimeout(M)},[e.instrument,e.dollarPerPoint,e.tickSize,e.tickValue]);let[y,b]=(0,We.useState)(0),[x,w]=(0,We.useState)(0),S=(0,We.useCallback)(NC((...C)=>{r(...C)},300),[r]);(0,We.useEffect)(()=>(QH(),()=>ZH()),[]),(0,We.useEffect)(()=>{let C=e.backendTradeId!==void 0&&e.backendTradeId!==null,F=e.originalPnl!==void 0||e.pnl!==void 0;if(C&&F){let M=e.originalPnl!==void 0?e.originalPnl:e.pnl;b(M||0)}else b(Wf(e));w(WH(e))},[e.entryPrice,e.exitPrice,e.positionSize,e.direction,e.commission,e.commissionType,e.swap,e.fees,e.rebate,e.directPnL,e.useDirectPnLInput,e.backendTradeId,e.originalPnl,e.pnl,e.entries,e.exits]);let k=Xn().plugins.plugins.journalit,T=(j=(A=(I=k==null?void 0:k.settings)==null?void 0:I.trade)==null?void 0:A.displayRMultiples)!=null?j:!1,P=(B=(N=(E=k==null?void 0:k.settings)==null?void 0:E.trade)==null?void 0:N.defaultRiskAmount)!=null?B:0,D=e.assetType==="forex"||e.assetType==="cfd",O=()=>{switch(e.assetType){case"stock":return"Shares";case"options":case"futures":return"Contracts";case"forex":return"Lots";case"crypto":return"Amount";case"cfd":return"CFD Units";default:return"Position Size"}},z=()=>{switch(e.assetType){case"stock":return"Ticker";case"options":return"Option Symbol";case"futures":return"Future Symbol";case"forex":return"Forex Pair";case"crypto":return"Crypto Symbol";case"cfd":return"CFD Symbol";default:return"Ticker"}};return We.default.createElement(Zp,{title:"Trade Details"},We.default.createElement("div",{className:"field"},m?We.default.createElement("div",{className:"asset-loading-accounts"},We.default.createElement("div",{className:"asset-account-label"},"Account"),"Loading accounts..."):We.default.createElement(li,{label:"Account",options:a,value:Array.isArray(e.account)?e.account:[],onChange:C=>{let F=Array.isArray(C)?[...C]:C?[C]:[],M=g(F);if(r("account",F),r("accountIds",F),F.length===1){let _=s[F[0]];_&&/^\d+$/.test(_)?r("accountId",_):r("accountId",void 0)}else r("accountId",void 0)},error:t.accountIds,allowCreate:!1,isMulti:!0,optionType:"account",required:!e.isMissedTrade,placeholder:"Select accounts"}),!m&&a.length===0&&We.default.createElement("div",{className:"asset-error-message"},"No accounts found. Please create an account in the Accounts tab.")),We.default.createElement("div",{className:"field"},We.default.createElement("label",{className:"label",id:"assetType-label"},"Asset Type",We.default.createElement("span",{className:"required-indicator"},"*")),We.default.createElement("div",{className:"asset-type-container",role:"radiogroup","aria-labelledby":"assetType-label","aria-required":"true"},["stock","options","futures","forex","crypto","cfd"].map(C=>We.default.createElement("button",{key:C,type:"button",className:"asset-type-button",onClick:()=>r("assetType",C),"aria-checked":e.assetType===C,role:"radio"},C==="cfd"?"CFD":C.charAt(0).toUpperCase()+C.slice(1)))),t.assetType&&We.default.createElement("div",{className:"errorMessage",role:"alert"},t.assetType)),We.default.createElement("div",{className:"field"},We.default.createElement(li,{label:z(),options:u,value:e.instrument||"",onChange:C=>r("instrument",C),error:t.instrument,allowCreate:!0,isMulti:!1,optionType:"instrument",onSaveOption:h,required:!0})),e.assetType&&We.default.createElement("div",{className:"asset-specific-fields"},e.assetType==="stock"&&We.default.createElement(tq,{data:e,errors:t,onChange:r}),e.assetType==="options"&&We.default.createElement(oq,{data:e,errors:t,onChange:r}),e.assetType==="futures"&&We.default.createElement(iq,{data:e,errors:t,onChange:r}),e.assetType==="forex"&&We.default.createElement(lq,{data:e,errors:t,onChange:r}),e.assetType==="crypto"&&We.default.createElement(dq,{data:e,errors:t,onChange:r}),e.assetType==="cfd"&&We.default.createElement(pq,{data:e,errors:t,onChange:r})),e.assetType!=="options"&&We.default.createElement("div",{className:"field"},We.default.createElement("label",{className:"label",id:"direction-label"},"Direction",We.default.createElement("span",{className:"required-indicator"},"*")),We.default.createElement("div",{className:"direction-container",role:"radiogroup","aria-labelledby":"direction-label","aria-required":"true"},We.default.createElement("button",{type:"button",className:"direction-button",onClick:()=>r("direction","long"),"aria-checked":e.direction==="long",role:"radio"},"Long"),We.default.createElement("button",{type:"button",className:"direction-button",onClick:()=>r("direction","short"),"aria-checked":e.direction==="short",role:"radio"},"Short")),t.direction&&We.default.createElement("div",{className:"errorMessage",role:"alert"},t.direction)),We.default.createElement("div",{className:"field"},We.default.createElement(yq,{data:e,errors:t,onChange:r})),We.default.createElement("div",{className:"trading-costs-section"},We.default.createElement("h4",{className:"section-title"},"Trading Costs"),We.default.createElement("div",{className:`cost-fields ${D?"three-column":"two-column"}`},We.default.createElement("div",{className:"field"},We.default.createElement("div",{className:"commission-grid"},We.default.createElement(ur,{label:"Commission",value:e.commission,onChange:C=>S("commission",C),error:t.commission||t.commissionType,precision:2,allowDecimal:!0,placeholder:e.commissionType==="percentage"?"0.15":"5.50"}),We.default.createElement(En,{label:"Type",options:[{value:"fixed",label:`Fixed ${Vs(0,o).replace("0","").trim()}`},{value:"percentage",label:"Percentage (%)"}],value:e.commissionType||"fixed",onChange:C=>S("commissionType",C)}))),e.assetType==="options"&&We.default.createElement("div",{className:"field"},We.default.createElement(ur,{label:"Rebate",value:e.rebate,onChange:C=>S("rebate",C),error:t.rebate,precision:2,allowDecimal:!0,min:0,placeholder:"Commission rebate/credit"})),D&&We.default.createElement("div",{className:"field"},We.default.createElement(ur,{label:"Swap",value:e.swap,onChange:C=>S("swap",C),error:t.swap,precision:2,allowDecimal:!0,placeholder:"Overnight financing"})),We.default.createElement("div",{className:"field"},We.default.createElement(ur,{label:"Other Fees",value:e.fees,onChange:C=>S("fees",C),error:t.fees,precision:2,allowDecimal:!0,placeholder:"Platform/regulatory fees"})))),We.default.createElement("div",{className:"risk-management-section"},We.default.createElement("h4",{className:"section-title"},"Risk Management"),We.default.createElement("div",{className:"risk-fields"},We.default.createElement("div",{className:"field"},We.default.createElement(ur,{label:"Stop Loss",value:e.stopLoss,onChange:C=>S("stopLoss",C),error:t.stopLoss,precision:e.assetType==="forex"?5:2,allowDecimal:!0,placeholder:"Optional stop loss price"})),We.default.createElement("div",{className:"field"},We.default.createElement(ur,{label:"Risk Amount",value:e.riskAmount,onChange:C=>S("riskAmount",C),error:t.riskAmount,precision:2,allowDecimal:!0,placeholder:"Planned risk in currency"}),e.stopLoss&&e.entryPrice&&e.positionSize&&(()=>{let C=Math.abs(e.entryPrice-e.stopLoss)*e.positionSize,F=st(C,void 0,e.riskAmount,P);return We.default.createElement("span",{className:"calculated-risk-hint"},"Calculated: ",ve(C,!0,o,T,F))})()))),e.entryPrice!==void 0&&e.exitPrice!==void 0&&e.positionSize!==void 0&&e.direction!==void 0&&(()=>{let C=st(y,void 0,e.riskAmount,P),F=Ww(e),M=st(F,void 0,e.riskAmount,P);return We.default.createElement("div",{className:"calculatedValue"},We.default.createElement("span",{className:"calculatedLabel"},"Profit/Loss",e.commission||e.swap||e.fees?" (incl. costs)":""),We.default.createElement("span",{className:`calculatedAmount ${y>0?"positive":y<0?"negative":"neutral"}`},ve(y,!0,o,T,C)),!e.useDirectPnLInput&&We.default.createElement("span",{className:"calculatedLabel"},"(",x.toFixed(2),"%)"),e.commission||e.swap||e.fees?We.default.createElement("span",{className:"calculatedLabel"},"Total Costs: ",ve(F,!0,o,T,M)):null)})())},wq=We.default.memo(xbe)});var _C,cO,kq=L(()=>{_C=q(Y());AH();lO();cO=({data:e,errors:t,onChange:r,instruments:n})=>_C.default.createElement("div",{className:"trade-form-basic-tab"},_C.default.createElement(IH,{data:e,onChange:r}),_C.default.createElement(wq,{data:e,errors:t,onChange:r,instruments:n}))});var co,wbe,Sq,dO=L(()=>{co=q(Y());Pl();lv();Kw();Au();wbe=({data:e,errors:t,onChange:r,accounts:n=[],setups:o=[],mistakes:a=[]})=>{let[i,s]=(0,co.useState)(0),l=(0,co.useMemo)(()=>{let v=Xn().plugins.plugins.journalit;return v&&v.optionsService?v.optionsService:new va(v)},[]),c=(0,co.useMemo)(()=>{try{return l.getOptions("tag")}catch(v){return console.error("Failed to load custom tag options:",v),[]}},[l,i]),d=(0,co.useMemo)(()=>{try{return l.getOptions("setup")}catch(v){return console.error("Failed to load setup options:",v),[]}},[l,i]),u=(0,co.useMemo)(()=>{try{return l.getOptions("mistake")}catch(v){return console.error("Failed to load mistake options:",v),[]}},[l,i]),p=(0,co.useCallback)(()=>{s(v=>v+1)},[]);(0,co.useEffect)(()=>(document.addEventListener("journalit-options-changed",p),()=>{document.removeEventListener("journalit-options-changed",p)}),[p]);let m=async v=>{try{let h=Xn().plugins.plugins.journalit,y=h?h.optionsService:new va(h);await y.addOption("tag",v)&&y.notifyOptionsChanged()}catch(h){console.error("Failed to save custom tag option:",h)}},f=async v=>{try{let h=Xn().plugins.plugins.journalit,y=h?h.optionsService:new va(h);await y.addOption("setup",v)&&y.notifyOptionsChanged()}catch(h){console.error("Failed to save custom setup option:",h)}},g=async v=>{try{let h=Xn().plugins.plugins.journalit,y=h?h.optionsService:new va(h);await y.addOption("mistake",v)&&y.notifyOptionsChanged()}catch(h){console.error("Failed to save custom mistake option:",h)}};return co.default.createElement(Zp,{title:"Analysis & Thesis"},co.default.createElement("div",{className:"field"},co.default.createElement(li,{label:"Setup",options:d,value:Array.isArray(e.setup)?e.setup:[],onChange:v=>{let h=Array.isArray(v)?v:[];r("setup",h)},allowCreate:!0,isMulti:!0,optionType:"setup",onSaveOption:f})),co.default.createElement("div",{className:"field"},co.default.createElement(li,{label:"Mistake",options:u,value:Array.isArray(e.mistake)?e.mistake:[],onChange:v=>{let h=Array.isArray(v)?v:[];r("mistake",h)},allowCreate:!0,isMulti:!0,optionType:"mistake",onSaveOption:g})),co.default.createElement("div",{className:"field"},co.default.createElement(li,{label:"Custom Tags",options:c,value:Array.isArray(e.customTags)?e.customTags:[],onChange:v=>{let h=Array.isArray(v)?v:[];r("customTags",h)},isMulti:!0,allowCreate:!0,placeholder:"Type a custom tag and press Enter",onSaveOption:m,optionType:"tag"})),co.default.createElement("div",{className:"field"},co.default.createElement($r,{label:"Trade Thesis",placeholder:"Enter your thesis for this trade...",value:e.thesis||"",onChange:v=>r("thesis",v),className:"thesisField",multiline:!0})))},Sq=co.default.memo(wbe)});var xd,uO,In,Lu=L(()=>{xd=require("obsidian");Kw();uO=class{constructor(t){this.app=t||Xn()}async saveImage(t,r,n,o){try{let a=t!=null&&t.name?t.name.replace(/[^a-zA-Z0-9.-]/g,"_"):"unnamed_file",i=a.substring(a.lastIndexOf(".")||a.length),s=Date.now(),l;if(o){let{year:d,month:u,weekOfMonth:p}=o,m=`${r}/${d}/${u}/${p}`,f=`${n}-${s}${i}`;l=`${m}/${f}`,await this.app.vault.adapter.mkdir((0,xd.normalizePath)(m))}else{let d=`${n}-${s}${i}`;l=`${r}/${d}`,await this.app.vault.adapter.mkdir((0,xd.normalizePath)(r))}let c=await t.arrayBuffer();return await this.app.vault.createBinary((0,xd.normalizePath)(l),c),l}catch(a){throw console.error("Error saving image:",a),a}}async deleteImage(t,r=!0){try{if(!t){console.warn("No image path provided for deletion");return}let n=this.app.vault.getAbstractFileByPath(t);if(!n){console.warn(`Image file not found: ${t}`);return}if(await this.app.vault.delete(n),r){let o=t.substring(0,t.lastIndexOf("/"));await this.deleteEmptyFolder(o)}}catch(n){if(n&&typeof n=="object"&&"code"in n&&n.code==="ENOENT"){console.log(`Image file already deleted or doesn't exist: ${t}`);return}throw console.error(`Error deleting image ${t}:`,n),n}}async deleteEmptyFolder(t,r="!"){try{if(t.startsWith(r)&&t.split("/").length<=1||!await this.app.vault.adapter.exists(t))return;let o=await this.app.vault.adapter.list(t);if(o.files.length===0&&o.folders.length===0){let a=this.app.vault.getAbstractFileByPath(t);if(a){await this.app.vault.delete(a);let i=t.substring(0,t.lastIndexOf("/"));i&&i.length>0&&!i.startsWith(r)&&await this.deleteEmptyFolder(i,r)}}}catch(n){console.error(`Error deleting empty folder ${t}:`,n)}}resolveMediaPath(t){if(!t)return"";try{let r=this.getResourceUrl(t);if(r&&r!==t&&!r.includes("app://obsidian.md"))return r;let n="",o="",a=t.split("/"),i=a.findIndex(s=>s==="media"||s==="attachments");if(i>=0&&i<a.length-1&&(a[i]==="attachments"&&a.length>i+5?(n=a.slice(i+1,a.length-1).join("/"),o=a[a.length-1]):i<a.length-2&&(n=a[i+1],o=a[a.length-1])),n&&o){let s=[t.startsWith("!")?t.substring(1):t,t,`attachments/${n}/${o}`,`${this.app.vault.getName()}/attachments/${n}/${o}`,`${this.app.vault.getName()}/${a.slice(1).join("/")}`,`Journalit/${a.slice(a.indexOf("Journalit")+1).join("/")}`,`${this.app.vault.getName()}/media/${n}/${o}`,`media/${n}/${o}`];for(let l of s){let c=this.app.vault.getAbstractFileByPath(l);if(c&&c instanceof xd.TFile)return this.app.vault.getResourcePath(c)}}return r}catch(r){return console.error("Error resolving media path:",r,t),this.getResourceUrl(t)}}getResourceUrl(t){if(!t)return"";try{if(t.startsWith("http://")||t.startsWith("https://")||t.startsWith("data:"))return t;let r=this.app.vault.getAbstractFileByPath(t);if(r&&r instanceof xd.TFile)return this.app.vault.getResourcePath(r);if(t.startsWith("!")){let a=t.substring(1);if(r=this.app.vault.getAbstractFileByPath(a),r&&r instanceof xd.TFile)return this.app.vault.getResourcePath(r)}let n=/\/media\/([^/]+)\//,o=t.match(n);if(o){let a=o[1],i=/(20\d{2})\/(\d{2})\/(W\d+)\//,s=t.match(i);if(s){let l=s[1],c=s[2],d=s[3],u=[`${l}/${c}/${d}/media/${a}${t.substring(t.lastIndexOf("/"))}`];for(let p of u)if(r=this.app.vault.getAbstractFileByPath(p),r&&r instanceof xd.TFile)return this.app.vault.getResourcePath(r)}}try{let a=this.app.vault.getName();if(a){let i=[t.startsWith("!")?`${a}/${t.substring(1)}`:`${a}/${t}`,`${a}/${t}`];for(let s of i)if(r=this.app.vault.getAbstractFileByPath(s),r&&r instanceof xd.TFile)return this.app.vault.getResourcePath(r)}}catch(a){}return t.startsWith("!")?`app://obsidian.md/${t.substring(1)}`:`app://obsidian.md/${t}`}catch(r){return console.error("Error getting resource URL:",r),t||""}}getImagesFromDataTransfer(t){try{return!t.files||t.files.length===0?[]:Array.from(t.files).filter(o=>o.type.startsWith("image/")||o.name.match(/\.(jpg|jpeg|png|gif|bmp|webp)$/i))}catch(r){return console.error("Error extracting images from drop event:",r),[]}}},In=new uO});var Tq,Pe,Sc=L(()=>{Tq=require("obsidian"),Pe=class e{static getErrorMessage(t,r){let n=r.statusCode||e.extractStatusCode(t),o=r.endpoint||"";if(n===401)return"Your session has expired. Please sign in again in plugin settings.";if(n===404)return o.includes("/ftp-users/")?"FTP account not found. The system will automatically create one for you.":o.includes("/trades")||o.includes("/mt-accounts")?"No trading data found. Please ensure your MetaTrader account is properly connected and has trade history.":"Unable to connect to trading data service. Please check your internet connection.";if(n===400)return r.operation.includes("verification")||r.operation.includes("auth")?"Invalid verification code. Please check the code and try again.":r.operation.includes("registration")||r.operation.includes("vault")?"Invalid registration data. Please check your settings and try again.":"Invalid request. Please check your input and try again.";if(n===403)return"Access denied. Please check your account permissions or contact support.";if(n===429)return"Too many requests. Please wait a moment before trying again.";if(n&&n>=500)return n===503?"Trading data service is temporarily unavailable. Please try again in a few minutes.":"Server error occurred. Please try again later or contact support if the problem persists.";if(e.isNetworkError(t))return"Cannot connect to trading data service. Please check your internet connection and try again.";if(r.operation.includes("clipboard")||r.operation.includes("paste"))return e.getClipboardErrorMessage(t,r);if(r.operation.includes("custom fields")||r.operation.includes("field"))return e.getSettingsErrorMessage(t,r);if(r.operation.includes("options")||r.operation.includes("dropdown"))return e.getOptionsErrorMessage(t,r);let a=(t==null?void 0:t.message)||"Unknown error occurred";return a.includes("API Error:")?a.replace(/^API Error: \d+ /,""):"An unexpected error occurred. Please try again or contact support if the problem persists."}static showError(t,r){let n=e.getErrorMessage(t,r),o=r.statusCode||e.extractStatusCode(t),a=5e3,i="\u26A0\uFE0F";o===401?(a=8e3,i="\u{1F510}"):o&&o>=500?(a=8e3,i="\u274C"):e.isNetworkError(t)&&(a=6e3,i="\u{1F4E1}"),new Tq.Notice(`${i} ${n}`,a)}static logError(t,r){let n=r.statusCode||e.extractStatusCode(t),o=n&&n>=500||e.isNetworkError(t)?"error":"warn",a=`${r.operation} failed`,i={statusCode:n,endpoint:r.endpoint,error:(t==null?void 0:t.message)||t,stack:t==null?void 0:t.stack};o==="error"?console.error(a,i):console.warn(a,i)}static handleError(t,r){if(e.shouldSuppressNotification(t,r)){e.logError(t,r);return}e.showError(t,r),e.logError(t,r)}static isNetworkError(t){var o,a;if(!t)return!1;let r=((o=t.name)==null?void 0:o.toLowerCase())||"",n=((a=t.message)==null?void 0:a.toLowerCase())||"";return r==="typeerror"||n.includes("fetch")||n.includes("network")||n.includes("connection")||n.includes("timeout")}static extractStatusCode(t){if(typeof t=="object"&&t.status)return t.status;let n=((t==null?void 0:t.message)||"").match(/API Error: (\d+)/);return n?parseInt(n[1],10):void 0}static shouldSuppressNotification(t,r){let n=e.extractStatusCode(t),o=r.operation.toLowerCase();return!!((n===401||n===400)&&(o.includes("vault registration")||o.includes("sync status"))||(n===400||n===429)&&o.includes("verify authentication code"))}static getSettingsErrorMessage(t,r){var a;let n=((a=t==null?void 0:t.message)==null?void 0:a.toLowerCase())||"",o=r.operation.toLowerCase();return n.includes("pattern")||n.includes("regex")?"Invalid validation pattern. Please check your regular expression and try again.":n.includes("field key")&&n.includes("already in use")?"This field name conflicts with an existing field. Please choose a different name.":n.includes("field key")||n.includes("invalid")?"Invalid field name. Field names can only contain letters, numbers, and underscores.":o.includes("save")||o.includes("update")?"Unable to save your changes. Please check your settings and try again.":o.includes("load")?"Unable to load custom field settings. Your custom fields may not display correctly.":o.includes("import")?"Unable to import field settings. Please check the file format and try again.":o.includes("add")||o.includes("create")?"Unable to create the custom field. Please check your input and try again.":o.includes("remove")||o.includes("delete")?"Unable to remove the custom field. Please try again.":"An error occurred while managing custom fields. Please check your settings and try again."}static getOptionsErrorMessage(t,r){var a;let n=((a=t==null?void 0:t.message)==null?void 0:a.toLowerCase())||"",o=r.operation.toLowerCase();return n.includes("duplicate")||n.includes("already exists")?"This option already exists. Please choose a different name.":n.includes("ticker format")||n.includes("invalid ticker")?"Invalid ticker symbol. Use only letters, numbers, and periods (e.g., AAPL, SPX).":o.includes("add")?o.includes("instrument")||o.includes("ticker")?"Unable to add ticker symbol. Please check the format and try again.":"Unable to add option. It may already exist or be invalid.":o.includes("update")||o.includes("edit")?"Unable to update option. It may already exist or be invalid.":o.includes("remove")||o.includes("delete")?"Unable to remove option. Please try again.":o.includes("reset")&&n.includes("no options")?"No options to reset. The category is already empty.":o.includes("reset")?"Unable to reset options. Please try again.":o.includes("save")||o.includes("load")?"Unable to save option changes. Please check your settings and try again.":"An error occurred while managing options. Please try again."}static getClipboardErrorMessage(t,r){var a;let n=((a=t==null?void 0:t.message)==null?void 0:a.toLowerCase())||"",o=r.operation.toLowerCase();return(t==null?void 0:t.name)==="NotAllowedError"||n.includes("permission")||o.includes("permission")?"Clipboard access denied. Please allow clipboard permissions in your browser for paste functionality.":o.includes("clipboard access")&&(n.includes("not supported")||n.includes("undefined"))?"Clipboard paste is not supported in your browser. Try using Ctrl+V or Cmd+V instead.":o.includes("size validation")||n.includes("exceeds limit")?"Image is too large to paste. Please use images smaller than 10MB.":o.includes("content check")?"Nothing found in clipboard to paste. Try copying an image first.":o.includes("image extraction")?"No images found in clipboard. Make sure you copied an image, not text or other content.":o.includes("target detection")?"No image upload area found. Click on an image upload area first, then paste your image.":o.includes("paste operation")||o.includes("global paste")?n.includes("failed to fetch")||n.includes("network")?"Network error occurred while processing paste. Please check your connection and try again.":"Unable to complete paste operation. Please try copying the image again and pasting.":"Clipboard operation failed. Please try copying your content again and pasting."}static createContext(t,r,n){return{operation:t,endpoint:r,statusCode:n}}}});var Cq,ya,pO=L(()=>{Cq=require("obsidian");Sc();ya=class{static isClipboardSupported(){return typeof navigator!="undefined"&&!!navigator.clipboard&&!!navigator.clipboard.read}static async extractClipboardImages(){if(!this.isClipboardSupported()){let t={operation:"clipboard access",originalError:new Error("Clipboard API not supported")};return{success:!1,files:[],error:Pe.getErrorMessage(new Error("Clipboard API not supported"),t)}}try{let t=await navigator.clipboard.read();if(!t||t.length===0){let n={operation:"clipboard content check"};return{success:!1,files:[],error:"Nothing found in clipboard to paste"}}let r=[];for(let n of t)for(let o of this.SUPPORTED_FORMATS)if(n.types.includes(o))try{let a=await n.getType(o);if(a.size>this.MAX_FILE_SIZE){let s={operation:"image size validation"},l=new Error(`File size ${(a.size/1024/1024).toFixed(1)}MB exceeds limit`);Pe.showError(l,s);continue}let i=new File([a],this.generateFileName(o),{type:o,lastModified:Date.now()});r.push(i)}catch(a){console.error(`Failed to extract ${o} from clipboard:`,a)}if(r.length===0){let n={operation:"clipboard image extraction"};return{success:!1,files:[],error:"No images found in clipboard. Try copying an image first."}}return{success:!0,files:r}}catch(t){if(console.error("Failed to read clipboard:",t),t.name==="NotAllowedError"||t.message.includes("permission")){let n={operation:"clipboard permission request",originalError:t};return{success:!1,files:[],error:Pe.getErrorMessage(t,n),permissionDenied:!0}}let r={operation:"clipboard access",originalError:t};return{success:!1,files:[],error:Pe.getErrorMessage(t,r)}}}static generateContextualFileName(t,r,n=0){var s,l,c,d,u;let o=Date.now(),a=this.getExtensionFromFormat(r);switch(t.contextType){case"trade":if((s=t.contextData)!=null&&s.ticker&&((l=t.contextData)!=null&&l.tradeNumber)){let m=n>0?`-${n}`:"";return`${t.contextData.ticker}-clipboard-T${t.contextData.tradeNumber}${m}-${o}${a}`}break;case"drc":if((c=t.contextData)!=null&&c.sectionName){let m=n>0?`-${n}`:"";return`drc-${t.contextData.sectionName}-clipboard${m}-${o}${a}`}break;case"weekly":if((d=t.contextData)!=null&&d.weekNumber){let m=n>0?`-${n}`:"";return`weekly-W${t.contextData.weekNumber}-clipboard${m}-${o}${a}`}break;case"account":if((u=t.contextData)!=null&&u.accountId){let m=n>0?`-${n}`:"";return`account-${t.contextData.accountId}-clipboard${m}-${o}${a}`}break;case"generic":default:return`clipboard-image${n>0?`-${n}`:""}-${o}${a}`}return`clipboard-image${n>0?`-${n}`:""}-${o}${a}`}static generateFileName(t){let r=Date.now(),n=this.getExtensionFromFormat(t);return`clipboard-image-${r}${n}`}static getExtensionFromFormat(t){switch(t){case"image/png":return".png";case"image/jpeg":return".jpg";case"image/gif":return".gif";case"image/bmp":return".bmp";case"image/webp":return".webp";default:return".png"}}static findImageUploadContext(t){if(!t)return null;let r=t.closest(".journalit-image-upload, .shared-forecast-image, .trade-form-metadata");if(!r)return null;if(r.classList.contains("trade-form-metadata"))return{contextType:"trade",multiple:!0};if(r.classList.contains("shared-forecast-image")){let n=r.closest("[data-section-name]");if(n)return{contextType:"drc",contextData:{sectionName:n.getAttribute("data-section-name")||void 0},multiple:!1}}return{contextType:"generic",multiple:!0}}static showPasteResult(t,r=0){if(t.success&&r>0){let n=r===1?"\u{1F4CB} Image pasted successfully":`\u{1F4CB} ${r} images pasted successfully`;new Cq.Notice(n)}else if(!t.success&&t.error)if(t.permissionDenied){let n={operation:"clipboard permission request"};Pe.showError(new Error("Permission denied"),n)}else{let n={operation:"paste operation"};Pe.showError(new Error(t.error),n)}}static createContextualFiles(t,r){return t.map((n,o)=>{let a=this.generateContextualFileName(r,n.type,o);return new File([n],a,{type:n.type,lastModified:n.lastModified})})}};ya.MAX_FILE_SIZE=10*1024*1024,ya.SUPPORTED_FORMATS=["image/png","image/jpeg","image/gif","image/bmp","image/webp"]});var BC,wd,$C=L(()=>{pO();Sc();BC=class BC{constructor(){this.handlers=[];this.enabled=!1;this.globalPasteListener=null;this.lastMousePosition={x:0,y:0};this.mouseMoveListener=null}static getInstance(){return this.instance||(this.instance=new BC),this.instance}initialize(){this.enabled||(this.enabled=!0,this.globalPasteListener=t=>{this.handleGlobalPaste(t)},this.mouseMoveListener=t=>{this.lastMousePosition={x:t.clientX,y:t.clientY}},document.addEventListener("paste",this.globalPasteListener,!0),document.addEventListener("mousemove",this.mouseMoveListener,!0))}cleanup(){this.enabled&&(this.enabled=!1,this.globalPasteListener&&(document.removeEventListener("paste",this.globalPasteListener,!0),this.globalPasteListener=null),this.mouseMoveListener&&(document.removeEventListener("mousemove",this.mouseMoveListener,!0),this.mouseMoveListener=null),this.handlers=[])}registerHandler(t){this.handlers=this.handlers.filter(r=>r.id!==t.id),this.handlers.push(t)}unregisterHandler(t){this.handlers=this.handlers.filter(r=>r.id!==t)}async handleGlobalPaste(t){if(!ya.isClipboardSupported())return;let r=document.activeElement;if(this.isTextInput(r)&&!this.isImageUploadArea(r))return;let n=this.findHandlerForContext(r);if(!n){try{let o=await ya.extractClipboardImages();if(o.success&&o.files.length>0&&!this.handlers.some(i=>{let s=i.element.getBoundingClientRect();return s.width>0&&s.height>0&&window.getComputedStyle(i.element).visibility!=="hidden"&&window.getComputedStyle(i.element).display!=="none"})){let i={operation:"paste target detection"},s=new Error("No image upload area available");Pe.showError(s,i)}}catch(o){}return}t.preventDefault(),t.stopPropagation();try{let o=await ya.extractClipboardImages();if(!o.success){o.error&&!o.error.includes("No images found")&&ya.showPasteResult(o);return}let a=ya.createContextualFiles(o.files,n.context),i=n.acceptsMultiple?a:[a[0]];await n.handlePaste(i),ya.showPasteResult(o,i.length),this.dispatchPasteEvent({files:i,context:{element:n.element,contextType:n.context.contextType,contextData:n.context.contextData},success:!0})}catch(o){console.error("Global paste handler error:",o),this.dispatchPasteEvent({files:[],context:{element:n.element,contextType:n.context.contextType,contextData:n.context.contextData},success:!1,error:o.message});let a={operation:"global paste handling",originalError:o};Pe.showError(o,a)}}findHandlerForContext(t){if(t){for(let i of this.handlers)if(i.element.contains(t)||i.element===t)return i;let a=this.findNearbyImageUploadArea(t);if(a)return this.handlers.find(i=>i.element===a||i.element.contains(a))||null}let r=this.findHandlerUnderMouse();if(r)return r;let n=this.handlers.filter(a=>{let i=a.element,s=i.getBoundingClientRect();return s.width>0&&s.height>0&&window.getComputedStyle(i).visibility!=="hidden"&&window.getComputedStyle(i).display!=="none"});if(n.length===1)return n[0];let o=this.findHoveredHandler();return o||null}isTextInput(t){var o;if(!t)return!1;let r=t.tagName.toLowerCase(),n=(o=t.type)==null?void 0:o.toLowerCase();return r==="input"&&["text","email","password","search","url"].includes(n)||r==="textarea"||t.hasAttribute("contenteditable")||t.classList.contains("cm-editor")}isImageUploadArea(t){return t?!!(t.closest(".journalit-image-upload")||t.closest(".shared-forecast-image")||t.closest(".trade-form-metadata")||t.closest("[data-image-upload]")):!1}findHandlerUnderMouse(){let t=document.elementsFromPoint(this.lastMousePosition.x,this.lastMousePosition.y);for(let r of t)for(let n of this.handlers)if(n.element===r||n.element.contains(r))return n;return null}findHoveredHandler(){for(let t of this.handlers){let n=t.element.getBoundingClientRect();if(n.width>0&&n.height>0&&this.lastMousePosition.x>=n.left&&this.lastMousePosition.x<=n.right&&this.lastMousePosition.y>=n.top&&this.lastMousePosition.y<=n.bottom)return t}return null}findNearbyImageUploadArea(t){if(!t)return null;let r=t.closest(".trade-form, .drc-note, .weekly-review, .account-note, .modal-content, .workspace-leaf-content");return r?r.querySelector(".journalit-image-upload, .shared-forecast-image, .trade-form-metadata"):null}dispatchPasteEvent(t){let r=new CustomEvent("journalit:paste",{detail:t,bubbles:!0,cancelable:!1});document.dispatchEvent(r)}static createImageUploaderHandler(t,r,n,o=!0){return{id:`image-uploader-${Date.now()}-${Math.random().toString(36).substring(2,11)}`,element:t,context:r,handlePaste:n,acceptsMultiple:o}}static isPasteSupported(){return ya.isClipboardSupported()}getDebugInfo(){return{enabled:this.enabled,handlerCount:this.handlers.length,handlers:this.handlers.map(t=>({id:t.id,contextType:t.context.contextType,acceptsMultiple:t.acceptsMultiple}))}}};BC.instance=null;wd=BC});var sr,cm,mO=L(()=>{sr=q(Y());er();Lu();pO();$C();cm=({onImageUploaded:e,onMultipleImagesUploaded:t,onError:r,label:n="Upload Image",enableDragDrop:o=!0,draggingOverClass:a="dragging-over",inputId:i,saveImageFunction:s,multiple:l=!0,enablePaste:c=!1,pasteContext:d,className:u="",style:p})=>{let m=(0,sr.useRef)(`image-upload-${Math.random().toString(36).substring(2,11)}`),f=i||m.current,[g,v]=(0,sr.useState)(!1),h=(0,sr.useRef)(0),y=(0,sr.useRef)(null),[b,x]=(0,sr.useState)(!1),[w,S]=(0,sr.useState)(!1),k=(0,sr.useRef)(new Set),T=(0,sr.useRef)(s),P=(0,sr.useRef)(e),D=(0,sr.useRef)(t),O=(0,sr.useRef)(r),z=(0,sr.useRef)(void 0);(0,sr.useEffect)(()=>{T.current=s,P.current=e,D.current=t,O.current=r},[s,e,t,r]),(0,sr.useEffect)(()=>()=>{k.current.forEach(_=>{URL.revokeObjectURL(_)}),k.current.clear()},[]);let I=(0,sr.useCallback)(async()=>{if(!(!c||b)){x(!0);try{let _=await ya.extractClipboardImages();if(!_.success){_.error&&!_.error.includes("No images found")&&ya.showPasteResult(_);return}let W=d||{contextType:"generic",multiple:l},$=ya.createContextualFiles(_.files,W),H=[],R=l?$:[$[0]];for(let V of R)try{let Z;T.current?(Z=await T.current(V),H.push(Z)):(console.warn("No saveImageFunction provided, using placeholder implementation"),Z=A(V),H.push(Z))}catch(Z){console.error(`Failed to process pasted image ${V.name}:`,Z),O.current&&Z instanceof Error&&O.current(Z)}l&&H.length>1&&D.current?D.current(H):H.length>0&&P.current&&P.current(H[0]),ya.showPasteResult(_,H.length)}catch(_){console.error("Failed to handle paste:",_),O.current&&_ instanceof Error&&O.current(_)}finally{x(!1)}}},[c,b,d,l]);(0,sr.useEffect)(()=>{z.current=I},[I]),(0,sr.useEffect)(()=>{if(!c||!y.current||!ya.isClipboardSupported())return;if(S(!0),(d==null?void 0:d.contextType)==="trade"){let W=d||{contextType:"generic",multiple:l},$=wd.createImageUploaderHandler(y.current,W,async H=>{let R=[];for(let V of H)try{let Z;T.current?(Z=await T.current(V),R.push(Z)):(console.warn("No saveImageFunction provided, using placeholder implementation"),Z=A(V),R.push(Z))}catch(Z){console.error(`Failed to process pasted image ${V.name}:`,Z),O.current&&Z instanceof Error&&O.current(Z)}l&&R.length>1&&D.current?D.current(R):R.length>0&&P.current&&P.current(R[0])},l);return wd.getInstance().registerHandler($),()=>{wd.getInstance().unregisterHandler($.id)}}else{let W=H=>{var R;H.preventDefault(),H.stopPropagation(),(R=z.current)==null||R.call(z)},$=y.current;return $.addEventListener("paste",W),()=>{$.removeEventListener("paste",W)}}},[c,d,l]);let A=_=>{let W=URL.createObjectURL(_);return k.current.add(W),W},j=async _=>{try{let W=_.target.files;if(!W||W.length===0)return;let $=[],H=l?W:[W[0]];for(let R=0;R<H.length;R++){let V=H[R],Z;if(s)try{Z=await s(V),$.push(Z)}catch(K){console.error(`Failed to process image ${V.name}:`,K),r&&K instanceof Error&&r(K)}else console.warn("No saveImageFunction provided, using placeholder implementation"),Z=A(V),$.push(Z)}l&&$.length>1&&t?t($):$.length>0&&e($[0]),_.target.value=""}catch(W){console.error("Failed to process images:",W),r&&W instanceof Error&&r(W)}},E=_=>{o&&(_.preventDefault(),_.stopPropagation(),h.current++,_.dataTransfer.types.includes("Files")&&v(!0))},N=_=>{o&&(_.preventDefault(),_.stopPropagation(),h.current--,h.current<=0&&(h.current=0,v(!1)))},B=_=>{o&&(_.preventDefault(),_.stopPropagation())},C=async _=>{if(o&&(_.preventDefault(),_.stopPropagation(),h.current=0,v(!1),_.dataTransfer.files&&_.dataTransfer.files.length>0)){let W=In.getImagesFromDataTransfer(_.dataTransfer);if(W.length>0){let $=[],H=l?W:[W[0]];for(let R of H)try{let V;s?(V=await s(R),$.push(V)):(console.warn("No saveImageFunction provided, using placeholder implementation"),V=A(R),$.push(V))}catch(V){console.error(`Failed to process dropped image ${R.name}:`,V),r&&V instanceof Error&&r(V)}l&&$.length>1&&t?t($):$.length>0&&e($[0])}}},F=()=>{let _=document.getElementById(f);_&&_.click()},M=["journalit-image-upload",u,g?a:""].filter(Boolean).join(" ");return sr.default.createElement("div",{ref:y,className:`journalit-image-upload-wrapper ${u}`,style:p,tabIndex:c?0:-1},sr.default.createElement("div",{className:"journalit-image-upload-layout"},sr.default.createElement("div",{className:`journalit-image-upload-file-area ${g?a:""} ${!c||!w?"full-width":""}`,onClick:F,onDragEnter:E,onDragLeave:N,onDragOver:B,onDrop:C},sr.default.createElement("label",{className:"journalit-image-upload-label"},n)),c&&w&&sr.default.createElement("button",{type:"button",className:`journalit-image-upload-paste-area ${b?"pasting":""}`,onClick:_=>{_.preventDefault(),_.stopPropagation(),I()},disabled:b,title:"Paste image from clipboard (Ctrl+V)"},b?sr.default.createElement(sr.default.Fragment,null,sr.default.createElement("span",{className:"journalit-spinner"}),sr.default.createElement("span",{className:"paste-text"},"Pasting...")):sr.default.createElement(sr.default.Fragment,null,sr.default.createElement(fw,{className:"paste-icon",size:18}),sr.default.createElement("span",{className:"paste-text"},"Paste")))),sr.default.createElement("input",{id:f,type:"file",accept:"image/*",multiple:l,onChange:j,className:"journalit-image-upload-input"}))}});var ds,Pq,Nu,xv=L(()=>{ds=q(Y()),Pq=q(vc()),Nu=({isOpen:e,children:t,portalId:r="journalit-fullscreen-portal",onClose:n,title:o="Image Preview",className:a=""})=>{let[i,s]=(0,ds.useState)(null),l=(0,ds.useRef)(null),c=(0,ds.useRef)(e);if(c.current=e,(0,ds.useEffect)(()=>{if(!e)return;let u=document.getElementById(r);u||(u=document.createElement("div"),u.id=r,u.className="journalit-fullscreen-portal-container",document.body.appendChild(u)),s(u),l.current=u;let p=m=>{m.key==="Escape"&&(m.preventDefault(),m.stopPropagation(),m.stopImmediatePropagation(),n())};return document.addEventListener("keydown",p),()=>{document.removeEventListener("keydown",p),!c.current&&u&&u.parentNode&&setTimeout(()=>{let m=document.getElementById(r);if(m&&m.parentNode&&m.childNodes.length===0)try{m.parentNode.removeChild(m)}catch(f){console.error(`[FullscreenPortal] Error removing portal element ${r}:`,f)}},0)}},[e,r,n]),!e||!i)return null;let d=["journalit-fullscreen-overlay",a].filter(Boolean).join(" ");return Pq.default.createPortal(ds.default.createElement("div",{className:d,onClick:n},ds.default.createElement("div",{className:"journalit-fullscreen-overlay-ui"},ds.default.createElement("div",{className:"journalit-fullscreen-title",onClick:u=>u.stopPropagation()},o),ds.default.createElement("button",{className:"journalit-fullscreen-close-btn",onClick:u=>{u.stopPropagation(),n()},"aria-label":"Close fullscreen"},"\xD7")),ds.default.createElement("div",{className:"journalit-fullscreen-content-wrapper"},ds.default.createElement("div",{className:"journalit-fullscreen-content",onClick:u=>u.stopPropagation()},t))),i)}});var un,dm,Zw=L(()=>{un=q(Y());Lu();dm=({imagePath:e,alt:t="Image",useResolveMediaPath:r=!1,navigationContext:n,onClose:o})=>{let[a,i]=(0,un.useState)({isZoomed:!1,panOffset:{x:0,y:0},isPanning:!1,lastMousePos:{x:0,y:0}}),s=(0,un.useRef)(null),l=(0,un.useRef)(null),c=r?In.resolveMediaPath(e):In.getResourceUrl(e);(0,un.useEffect)(()=>{i({isZoomed:!1,panOffset:{x:0,y:0},isPanning:!1,lastMousePos:{x:0,y:0}})},[e]);let d=(0,un.useCallback)(b=>{b.preventDefault(),b.stopPropagation(),!a.isPanning&&i(x=>({...x,isZoomed:!x.isZoomed,panOffset:{x:0,y:0},isPanning:!1}))},[a.isPanning]),u=(0,un.useCallback)(b=>{a.isZoomed&&(b.preventDefault(),b.stopPropagation(),i(x=>({...x,isPanning:!0,lastMousePos:{x:b.clientX,y:b.clientY}})))},[a.isZoomed]),p=(0,un.useCallback)(()=>{i(b=>({...b,isPanning:!1}))},[]),m=(0,un.useCallback)(b=>{if(!n)return;let{images:x,currentIndex:w,onNavigate:S}=n,k=w;b==="prev"?k=w===0?x.length-1:w-1:k=w===x.length-1?0:w+1,S(k)},[n]);(0,un.useEffect)(()=>{let b=x=>{x.key==="ArrowLeft"?(x.preventDefault(),x.stopPropagation(),m("prev")):x.key==="ArrowRight"&&(x.preventDefault(),x.stopPropagation(),m("next"))};return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[m]);let f=(0,un.useCallback)(b=>{i(x=>{if(!x.isPanning||!x.isZoomed)return x;let w=b.clientX-x.lastMousePos.x,S=b.clientY-x.lastMousePos.y,k=.8,T=w*k,P=S*k;return{...x,panOffset:{x:x.panOffset.x+T,y:x.panOffset.y+P},lastMousePos:{x:b.clientX,y:b.clientY}}})},[]),g=(0,un.useCallback)(()=>{i(b=>({...b,isPanning:!1}))},[]);(0,un.useEffect)(()=>{if(a.isPanning)return document.addEventListener("mousemove",f),document.addEventListener("mouseup",g),()=>{document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",g)}},[a.isPanning,f,g]);let v=a.isZoomed?2:1,h=`scale(${v}) translate(${a.panOffset.x/v}px, ${a.panOffset.y/v}px)`,y="zoom-in";return a.isZoomed&&(y=a.isPanning?"grabbing":"grab"),un.default.createElement("div",{className:"journalit-fullscreen-viewer",ref:l},n&&n.images.length>1&&un.default.createElement(un.default.Fragment,null,un.default.createElement("button",{className:"journalit-fullscreen-nav-btn journalit-fullscreen-nav-prev",onClick:()=>m("prev"),"aria-label":"Previous image",type:"button"},"\u2039"),un.default.createElement("button",{className:"journalit-fullscreen-nav-btn journalit-fullscreen-nav-next",onClick:()=>m("next"),"aria-label":"Next image",type:"button"},"\u203A")),un.default.createElement("div",{className:"journalit-fullscreen-image-wrapper"},un.default.createElement("img",{ref:s,src:c,alt:t,className:"journalit-fullscreen-zoomable-image",onClick:d,onMouseDown:u,onMouseUp:p,onMouseLeave:p,style:{transform:h,cursor:y,transition:a.isPanning?"none":"transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94)",willChange:a.isPanning?"transform":"auto"}})),un.default.createElement("div",{className:"journalit-fullscreen-zoom-indicator"},a.isZoomed?"Click to zoom out":"Click to zoom in"),n&&n.images.length>1&&un.default.createElement("div",{className:"journalit-fullscreen-nav-indicator"},n.currentIndex+1," / ",n.images.length))}});var ea,e0,WC=L(()=>{ea=q(Y());Lu();xv();Zw();e0=({imagePath:e,alt:t="Image",enableFullscreen:r=!0,description:n="Image Preview",showDeleteButton:o=!1,onDelete:a,onError:i,width:s,height:l,fullscreenPortalId:c="journalit-fullscreen-portal",fullscreenClassName:d="",className:u="",style:p,useResolveMediaPath:m=!1})=>{let[f,g]=(0,ea.useState)({isFullscreen:!1,holdTimerId:null,hasError:!1}),v=(0,ea.useRef)(null),h=500;(0,ea.useEffect)(()=>()=>{v.current!==null&&window.clearTimeout(v.current)},[]);let y=m?In.resolveMediaPath(e):In.getResourceUrl(e),b=()=>{g(D=>({...D,hasError:!0})),i&&i()},x=()=>{r&&g(D=>({...D,isFullscreen:!0}))},w=()=>{g(D=>({...D,isFullscreen:!1}))},S=()=>{r&&(v.current!==null&&(window.clearTimeout(v.current),v.current=null),v.current=window.setTimeout(()=>{x()},h))},k=()=>{v.current!==null&&(window.clearTimeout(v.current),v.current=null)},T=D=>{D.preventDefault(),D.stopPropagation(),a&&a(D)},P=["journalit-image-viewer",u].filter(Boolean).join(" ");return ea.default.createElement(ea.default.Fragment,null,ea.default.createElement("div",{className:P,style:p},ea.default.createElement("div",{className:"journalit-image-container"},f.hasError?ea.default.createElement("div",{className:"journalit-image-error"},"Unable to load image. The file might be missing or inaccessible."):ea.default.createElement(ea.default.Fragment,null,ea.default.createElement("img",{src:y,alt:t,className:"journalit-image",onError:b,onMouseDown:S,onMouseUp:k,onMouseLeave:k,onTouchStart:S,onTouchEnd:k,onTouchCancel:k,onClick:()=>{k(),x()},style:{cursor:r?"zoom-in":"default",width:s,height:l},title:r?"Click to view fullscreen":t}),r&&ea.default.createElement("div",{className:"journalit-image-zoom-indicator"},"Click or hold to enlarge")),o&&ea.default.createElement("button",{className:"journalit-image-delete-button",onClick:T,type:"button"},"Delete Image"))),ea.default.createElement(Nu,{isOpen:f.isFullscreen,onClose:w,title:n,portalId:c,className:d},ea.default.createElement(dm,{imagePath:e,alt:t,useResolveMediaPath:m,onClose:w})))}});var zi,Dq,Eq=L(()=>{zi=q(Y());Lu();Dq=({src:e,alt:t,className:r="",placeholderClassName:n="",style:o,useResolveMediaPath:a=!1,loadingPlaceholder:i,errorPlaceholder:s,rootMargin:l="50px",threshold:c=.1})=>{let[d,u]=(0,zi.useState)(!1),[p,m]=(0,zi.useState)(!1),[f,g]=(0,zi.useState)(!1),v=(0,zi.useRef)(null);(0,zi.useEffect)(()=>{let x=v.current;if(!x)return;let w=new IntersectionObserver(S=>{let[k]=S;k.isIntersecting&&(u(!0),w.disconnect())},{rootMargin:l,threshold:c});return w.observe(x),()=>w.disconnect()},[l,c]);let h=d?a?In.resolveMediaPath(e):In.getResourceUrl(e):"",y=()=>{m(!0),g(!1)},b=()=>{g(!0),m(!1)};return zi.default.createElement("div",{ref:v,className:`lazy-image-container ${r}`,style:{position:"relative",overflow:"hidden",...o}},(!d||!p)&&!f&&zi.default.createElement("div",{className:`lazy-image-placeholder ${n}`},i||zi.default.createElement("div",{style:{width:"100%",height:"100%",backgroundColor:"var(--background-modifier-border)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--text-muted)",fontSize:"12px"}},"Loading...")),f&&zi.default.createElement("div",{className:`lazy-image-error ${n}`},s||zi.default.createElement("div",{style:{width:"100%",height:"100%",backgroundColor:"var(--background-modifier-error)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--text-error)",fontSize:"12px"}},"Failed to load image")),d&&!f&&zi.default.createElement("img",{src:h,alt:t,onLoad:y,onError:b,style:{position:"absolute",top:0,left:0,opacity:p?1:0,transition:"opacity 0.3s ease",width:"100%",height:"100%",objectFit:"cover"},className:"lazy-image-loaded"}))}});var pn,Mu,Iq,fO=L(()=>{pn=q(Y());WC();Eq();xv();Zw();Mu=({images:e,altPrefix:t="Image",showThumbnails:r=!0,showCounter:n=!0,enableDelete:o=!1,onDeleteImage:a,enableFullscreen:i=!0,className:s="",style:l,useResolveMediaPath:c=!1})=>{let[d,u]=(0,pn.useState)(0),[p,m]=(0,pn.useState)(!1),[f,g]=(0,pn.useState)(!1);(0,pn.useEffect)(()=>{e&&e.length>0&&d>=e.length&&u(Math.max(0,e.length-1))},[e,d]);let v=z=>{z.preventDefault(),z.stopPropagation(),!(e.length<=1)&&u(I=>I===e.length-1?0:I+1)},h=z=>{z.preventDefault(),z.stopPropagation(),!(e.length<=1)&&u(I=>I===0?e.length-1:I-1)},y=(z,I)=>{I.preventDefault(),I.stopPropagation(),z>=0&&z<e.length&&u(z)},b=(z,I)=>{I&&(I.preventDefault(),I.stopPropagation()),a&&e[z]&&a(z,e[z])},x=()=>{m(!0)},w=()=>{i&&g(!0)},S=()=>{g(!1)},T={images:e,currentIndex:d,onNavigate:z=>{z>=0&&z<e.length&&u(z)},altPrefix:t,useResolveMediaPath:c},P=["journalit-image-carousel",s].filter(Boolean).join(" ");if(!e||e.length===0)return pn.default.createElement("div",{className:P,style:l},pn.default.createElement("div",{className:"journalit-carousel-main"},pn.default.createElement("div",{className:"journalit-carousel-image-container"},pn.default.createElement("div",{style:{textAlign:"center",padding:"20px",color:"var(--text-muted)"}},"No images to display"))));let D=e[d],O=`${t} ${d+1}`;return pn.default.createElement("div",{className:P,style:l},pn.default.createElement("div",{className:"journalit-carousel-main"},e.length>1&&pn.default.createElement("button",{className:"journalit-carousel-button",onClick:h,"aria-label":"Previous image",type:"button"},"<"),pn.default.createElement("div",{className:"journalit-carousel-image-container"},pn.default.createElement(e0,{imagePath:D,alt:O,enableFullscreen:!1,description:`${t} ${d+1} of ${e.length}`,showDeleteButton:o,onDelete:z=>b(d,z),onError:x,useResolveMediaPath:c}),i&&pn.default.createElement("div",{className:"journalit-carousel-fullscreen-trigger",onClick:w,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",cursor:"zoom-in",zIndex:5},title:"Click to view fullscreen"})),e.length>1&&pn.default.createElement("button",{className:"journalit-carousel-button",onClick:v,"aria-label":"Next image",type:"button"},">")),n&&e.length>1&&pn.default.createElement("div",{className:"journalit-carousel-counter"},d+1," / ",e.length),r&&e.length>1&&pn.default.createElement("div",{className:"journalit-carousel-thumbnails"},e.map((z,I)=>pn.default.createElement(Iq,{key:`thumb-${I}`,imagePath:z,index:I,isActive:I===d,altPrefix:t,useResolveMediaPath:c,onClick:A=>y(I,A)}))),pn.default.createElement(Nu,{isOpen:f,onClose:S,title:`${t} ${d+1} of ${e.length}`,portalId:"journalit-carousel-fullscreen-portal"},pn.default.createElement(dm,{imagePath:D,alt:O,useResolveMediaPath:c,navigationContext:T,onClose:S})))},Iq=pn.default.memo(({imagePath:e,index:t,isActive:r,altPrefix:n,useResolveMediaPath:o,onClick:a})=>pn.default.createElement("div",{className:`journalit-carousel-thumbnail ${r?"active":""}`,onClick:a,title:`${n} ${t+1}`,style:{cursor:"pointer",border:r?"2px solid var(--interactive-accent)":"2px solid transparent",borderRadius:"4px",overflow:"hidden"}},pn.default.createElement(Dq,{src:e,alt:`Thumbnail ${t+1}`,useResolveMediaPath:o,style:{width:"60px",height:"60px"},rootMargin:"100px",threshold:.1})));Iq.displayName="LazyThumbnail"});var Aq=L(()=>{});var RC=L(()=>{mO();WC();fO();xv();Aq()});var Fu,kbe,Lq,gO=L(()=>{Fu=q(Y());lv();RC();kbe=({data:e,onChange:t,availableTags:r,onAddImage:n,onDeleteImage:o})=>{let a=(0,Fu.useMemo)(()=>({contextType:"trade",contextData:{ticker:e.instrument||"unknown"},multiple:!0}),[e.instrument]),i=async d=>{try{let u=Array.isArray(e.images)?[...e.images]:[];if(!u.includes(d)){let p=[...u,d];t("images",p)}}catch(u){console.error("Failed to process uploaded image:",u)}},s=async d=>{try{let u=Array.isArray(e.images)?[...e.images]:[],p=d.filter(m=>!u.includes(m));if(p.length>0){let m=[...u,...p];t("images",m)}}catch(u){console.error("Failed to process multiple uploaded images:",u)}},l=async(d,u)=>{let m=[...e.images||[]].filter(f=>f!==u);if(t("images",m),o)try{await o(u)}catch(f){console.error(`Failed to delete image ${u}:`,f)}};return Fu.default.createElement(Zp,{title:"Attachments"},n&&Fu.default.createElement("div",{className:"field"},Fu.default.createElement("label",{className:"label"},"Attachments"),Fu.default.createElement(cm,{onImageUploaded:i,onMultipleImagesUploaded:s,label:"Upload Image",enableDragDrop:!0,saveImageFunction:async d=>{if(!n)throw new Error("Image upload not available");return await n(d)},enablePaste:!0,pasteContext:a}),e.images&&e.images.length>0&&Fu.default.createElement(Mu,{images:e.images,altPrefix:"Trade Image",showThumbnails:!0,showCounter:!0,enableDelete:!0,onDeleteImage:l,enableFullscreen:!0})))},Lq=Fu.default.memo(kbe)});var UC,hO,Nq=L(()=>{UC=q(Y());dO();gO();hO=({data:e,errors:t,onChange:r,accounts:n,setups:o,mistakes:a,availableTags:i,onAddImage:s,onDeleteImage:l})=>UC.default.createElement("div",{className:"trade-form-details-tab"},UC.default.createElement(Sq,{data:e,errors:t,onChange:r,accounts:n,setups:o,mistakes:a}),UC.default.createElement(Lq,{data:e,onChange:r,availableTags:i,onAddImage:s,onDeleteImage:l}))});var xo,Sbe,Tbe,Mq,Fq=L(()=>{xo=q(Y());hd();DC();vd();PC();_w();pt();$f();Sbe=({field:e,value:t,onChange:r,error:n})=>{let o=xe(),{id:a,label:i,type:s,validation:l,options:c,placeholder:d,helperText:u,allowCreateOptions:p}=e,m=(0,xo.useMemo)(()=>{if(s!=="dropdown"&&s!=="multiselect")return c||[];let v=c||[],h=o==null?void 0:o.customFieldsService;if(!h)return v;let b=h.getFieldOptions(a).map(w=>({value:w,label:w})),x=[...v];return b.forEach(w=>{x.some(S=>S.value===w.value)||x.push(w)}),x},[a,s,c,o==null?void 0:o.customFieldsService]),f=async v=>{let h=o==null?void 0:o.customFieldsService;if(!(!h||!p))try{await h.addFieldOption(a,v)}catch(y){console.error("Failed to save custom field option:",y)}},g=(0,xo.useMemo)(()=>({label:i,value:t!=null?t:s==="multiselect"?[]:s==="number"?0:"",onChange:r,placeholder:d,error:n,required:(l==null?void 0:l.required)||!1}),[i,t,s,r,d,n,l==null?void 0:l.required]);switch(s){case"text":return xo.default.createElement($r,{...g,multiline:!1,type:"text"});case"number":return xo.default.createElement(ur,{...g,allowDecimal:!0,precision:2,min:l==null?void 0:l.min,max:l==null?void 0:l.max});case"dropdown":return p?xo.default.createElement(li,{...g,options:m.map(v=>v.value),isMulti:!1,allowCreate:!0,onSaveOption:f}):xo.default.createElement(En,{...g,options:m});case"multiselect":return xo.default.createElement(li,{...g,options:m.map(v=>v.value),isMulti:!0,allowCreate:p||!1,onSaveOption:p?f:void 0});case"date":return xo.default.createElement(ji,{...g,includeTime:!1});case"datetime":return xo.default.createElement(ji,{...g,includeTime:!0});case"time":return xo.default.createElement(ji,{...g,timeOnly:!0});default:return xo.default.createElement("div",{className:"custom-field-error"},xo.default.createElement("p",null,"Unsupported field type: ",s))}},Tbe=({fields:e,values:t,onChange:r,errors:n={}})=>!e||e.length===0?xo.default.createElement("div",{className:"custom-fields-empty"},xo.default.createElement("p",null,"No custom fields configured."),xo.default.createElement("p",null,"Go to Settings \u2192 Customization \u2192 Custom Trade Fields to add custom fields.")):xo.default.createElement("div",{className:"custom-fields-list"},e.map(o=>xo.default.createElement("div",{key:o.id,className:"custom-field-wrapper"},xo.default.createElement(Sbe,{field:o,value:t[o.id],onChange:a=>r(o.id,a),error:n[o.id]})))),Mq=xo.default.memo(Tbe)});function Oq(e){let{currentDate:t,navigateTo:r,getAdjacentReview:n,getRelatedReviewPaths:o={},serviceName:a,calculateAdjacentDate:i,newReviewPathTemplate:s}=e,[l,c]=(0,t0.useState)(!1),d=xe(),u=(0,t0.useCallback)(async m=>{if(!l)try{c(!0);let f=await n(m);if(f)r(f,!1);else if(i&&s){let g=i(t,m),v=s(g),h;v instanceof Promise?h=await v:h=v,r(h,!1)}}catch(f){console.error("Navigation error:",f)}finally{c(!1)}},[l,n,r,t,i,s]),p=(0,t0.useCallback)(async m=>{var f,g,v;try{let h=o[m];if(!h){console.error(`No path function found for review type: ${m}`);return}let y=h(t);if(!y){console.error(`Unable to get review path for type: ${m}`);return}let b=!1;if((g=(f=d==null?void 0:d.app)==null?void 0:f.vault)!=null&&g.adapter&&(b=await d.app.vault.adapter.exists(y)),!b&&d&&a)try{let x=await((v=d.serviceManager)==null?void 0:v.getServiceByName(a));if(x){let w=x,k={weekly:"createWeeklyReview",monthly:"createMonthlyReview",yearly:"createYearlyReview",drc:"createDRCReview"}[m],T=k?w[k]:void 0;typeof T=="function"?await T.call(w,t):typeof w.createReview=="function"&&await w.createReview(t,m)}}catch(x){console.error(`Error creating ${m} review:`,x)}r(y,!1)}catch(h){console.error(`Error navigating to ${m} review:`,h)}},[o,t,r,d,a]);return{isNavigating:l,handleNavigation:u,navigateToRelatedReview:p}}var t0,vO=L(()=>{t0=q(Y());pt()});function Tc(e){let t=xe(),[r,n]=(0,wv.useState)("loading"),[o,a]=(0,wv.useState)(null),[i,s]=(0,wv.useState)(null);return(0,wv.useEffect)(()=>{let l=!0,c=null,d=async()=>{if(!t){c=setTimeout(d,100);return}try{if(t.serviceManager){let u=await t.serviceManager.getServiceByName(e);l&&(a(u),n("ready"),s(null));return}throw new Error("Service manager not available")}catch(u){console.error(`Error loading ${e}:`,u),l&&(a(null),n("error"),s(u instanceof Error?u:new Error(`Failed to load ${e}`)))}};return d(),()=>{l=!1,c&&clearTimeout(c)}},[t,e]),{service:o,status:r,error:i}}function jq(){return Tc("drcService")}function zq(){return Tc("weeklyReviewService")}function _q(){return Tc("accountPageService")}var wv,kv=L(()=>{wv=q(Y());pt()});var Hf,Bq,yO=L(()=>{Hf=q(Y()),Bq=({plugin:e,initialData:t,onUpdate:r})=>{var l;let[n,o]=(0,Hf.useState)(((l=e.settings.trade)==null?void 0:l.lossReview)||{enabled:!1,sections:[]}),[a,i]=(0,Hf.useState)(t);(0,Hf.useEffect)(()=>{let c=d=>{var u,p;if(((u=d.detail)==null?void 0:u.component)==="lossReview"){let m=((p=e.settings.trade)==null?void 0:p.lossReview)||{enabled:!1,sections:[]};o(m)}};return document.addEventListener("journalit-settings-updated",c),()=>{document.removeEventListener("journalit-settings-updated",c)}},[e]);let s=(0,Hf.useCallback)(c=>{i(c),r(c)},[r]);return{settings:n,data:a,updateLossReview:s}}});function $q(e=768){let[t,r]=(0,Sv.useState)(()=>window.innerWidth<e),n=xe();return(0,Sv.useEffect)(()=>{let o=()=>{let s=window.innerWidth<e;r(l=>l!==s?s:l)},a,i=()=>{clearTimeout(a),a=setTimeout(o,100)};return window.addEventListener("resize",i),n&&n.registerEvent(n.app.workspace.on("resize",i)),()=>{clearTimeout(a),window.removeEventListener("resize",i)}},[e,n]),t}var Sv,Wq=L(()=>{Sv=q(Y());pt()});var r0,Rq=L(()=>{r0=q(Y())});var qf=L(()=>{pt();vO();kv();yO();Wq();TC();Rq()});var kd,bO,Uq=L(()=>{kd=q(Y());Fq();lv();qf();bO=({data:e,errors:t,onChange:r,customFieldValues:n,onCustomFieldChange:o})=>{let a=xe(),{service:i,status:s}=Tc("customFieldsService"),[l,c]=(0,kd.useState)([]);return(0,kd.useEffect)(()=>{(async()=>{try{if(i&&s==="ready"){let m=i.getFields();c(m)}}catch(m){console.error("Failed to load custom fields:",m)}})();let u=a==null?void 0:a.app,p=m=>{m&&m.fields&&c(m.fields)};return u&&u.workspace.on("journalit-custom-fields-changed",p),()=>{u&&u.workspace.off("journalit-custom-fields-changed",p)}},[a,i,s]),kd.default.createElement("div",{className:"trade-form-advanced-tab"},kd.default.createElement(Zp,{title:"Custom Fields"},kd.default.createElement("p",{className:"sectionDescription"},"Custom fields defined in your plugin settings. These fields will be saved to your trade's frontmatter."),l.length===0&&kd.default.createElement("p",{style:{fontStyle:"italic",color:"var(--text-muted)"}},"No custom fields defined. Create custom fields in the plugin settings under Customization."),kd.default.createElement(Mq,{fields:l,values:n,onChange:o,errors:t.customFields||{}})))}});var Vq=L(()=>{kq();Nq();Uq()});function Hq(e){var t,r,n,o,a,i,s,l;if((r=(t=e==null?void 0:e.settings)==null?void 0:t.trade)!=null&&r.tradingDayCutoffTime)return e.settings.trade.tradingDayCutoffTime;try{if((a=(o=(n=window.journalitPlugin)==null?void 0:n.settings)==null?void 0:o.trade)!=null&&a.tradingDayCutoffTime)return window.journalitPlugin.settings.trade.tradingDayCutoffTime;let c=window.JournalitPlugin;return(l=(s=(i=c==null?void 0:c.instance)==null?void 0:i.settings)==null?void 0:s.trade)!=null&&l.tradingDayCutoffTime?c.instance.settings.trade.tradingDayCutoffTime:"00:00"}catch(c){return console.warn("Error getting trading day cutoff time, using default (00:00)",c),"00:00"}}function qq(e){try{let[t,r]=e.split(":"),n=parseInt(t,10),o=parseInt(r,10);return isNaN(n)||isNaN(o)||n<0||n>23||o<0||o>59?(console.warn(`Invalid cutoff time format: ${e}, using 00:00`),{hours:0,minutes:0}):{hours:n,minutes:o}}catch(t){return console.warn(`Error parsing cutoff time: ${e}, using 00:00`,t),{hours:0,minutes:0}}}function lr(e,t){let r=Hq(t),{hours:n,minutes:o}=qq(r),a=new Date(e);return(a.getHours()<n||a.getHours()===n&&a.getMinutes()<o)&&a.setDate(a.getDate()-1),a.setHours(0,0,0,0),a}function Gq(e,t,r){let n=lr(e,r),o=lr(t,r);return n.getFullYear()===o.getFullYear()&&n.getMonth()===o.getMonth()&&n.getDate()===o.getDate()}function VC(e,t){let r=Hq(t),{hours:n,minutes:o}=qq(r),a=lr(e,t),i=new Date(a);i.setHours(n,o,0,0);let s=new Date(i);return s.setDate(s.getDate()+1),{start:i,end:s}}function Cc(e,t){let r=lr(e,t),n=r.getFullYear(),o=String(r.getMonth()+1).padStart(2,"0"),a=String(r.getDate()).padStart(2,"0");return`${n}-${o}-${a}`}var ci=L(()=>{});var An,Tv,xO,Yq=L(()=>{An=q(Y());am();Tv=require("obsidian");Au();Lu();tm();Rf();gv();qf();ci();xO=({initialData:e={},isEditMode:t=!1,onSubmit:r,onCancel:n})=>{let o=xe(),[a,i]=(0,An.useState)(()=>{var _,W;if(t&&e){let $={...e};(!$.entries||!Array.isArray($.entries))&&($.entries=[]),$.entries.length===0&&$.entryPrice!=null&&$.positionSize!=null&&($.entries=[{time:$.entryTime||new Date,price:$.entryPrice,size:$.positionSize}]),(!$.exits||!Array.isArray($.exits))&&($.exits=[]),$.images||($.images=[]),$.tags||($.tags=[]),$.customTags||($.customTags=[]),$.setup||($.setup=[]),$.mistake||($.mistake=[]),$.account||($.account=[]),$.setupIds||($.setupIds=[]),$.mistakeIds||($.mistakeIds=[]),$.accountIds||($.accountIds=[]),$.isMissedTrade===void 0&&($.type==="missed-trade"||$.filePath&&$.filePath.includes("-M")&&$.filePath.endsWith(".md")?$.isMissedTrade=!0:$.isMissedTrade=!1);let H=$.backendTradeId!==void 0&&$.backendTradeId!==null,R=$.entryPrice!==void 0&&$.entryPrice!==null&&$.entryPrice>0&&$.exitPrice!==void 0&&$.exitPrice!==null&&$.exitPrice>0;return H?$.useDirectPnLInput=!0:$.useDirectPnLInput===void 0&&($.useDirectPnLInput=!R),$.useDirectPnLInput&&$.directPnL===void 0&&$.pnl!==void 0&&($.directPnL=$.pnl),$}let M={...{...zH}};e&&(Object.keys(e).forEach($=>{let H=$,R=e[H];Array.isArray(R)?M[H]=[...R]:M[H]=R}),!M.images&&e.images&&(M.images=[...e.images]));try{let $=Xn().plugins.plugins.journalit;$&&$.settings.trade.useDirectPnLInput!==void 0&&(M.useDirectPnLInput=$.settings.trade.useDirectPnLInput)}catch($){console.error("Error loading PNL input mode preference:",$)}try{let $=Xn().plugins.plugins.journalit;$&&$.settings.trade.lastAssetType&&!M.assetType&&(M.assetType=$.settings.trade.lastAssetType)}catch($){console.error("Error accessing last asset type from settings:",$)}try{let $=Xn().plugins.plugins.journalit;if($&&((W=(_=$.settings)==null?void 0:_.trade)!=null&&W.defaultRiskAmount)){let H=$.settings.trade.defaultRiskAmount;H>0&&!M.riskAmount&&(M.riskAmount=H)}}catch($){console.error("Error loading default risk amount from settings:",$)}return M}),s=(0,An.useMemo)(()=>structuredClone(a),[]),l=(0,An.useRef)(s),[c,d]=(0,An.useState)({}),[u,p]=(0,An.useState)({}),[m,f]=(0,An.useState)(!1),[g,v]=(0,An.useState)([]),[h,y]=(0,An.useState)([]),b=(0,An.useRef)(null),x=(0,An.useRef)(!1),[w,S]=(0,An.useState)(!1),k=(0,An.useMemo)(()=>NC(()=>{let F=QF(a);if(o!=null&&o.customFieldsService&&a.customFields){let M=o.customFieldsService.getFields(),_=ZF(a.customFields,M,o.customFieldsService);Object.keys(_).length>0&&(F.customFields=_)}d(F)},300),[a,o==null?void 0:o.customFieldsService]);(0,An.useEffect)(()=>(m&&k(),()=>{k.cancel()}),[a,m,k]);let T=async()=>{try{if(w||O.current.length===0)return;S(!0);let F=[...O.current];for(let M of F)await In.deleteImage(M,!0);v([])}catch(F){console.error("Failed to cleanup temporary images:",F)}},P=async F=>{try{if(!F)return;let M=g.includes(F);if(i(_=>{let $=(Array.isArray(_.images)?[..._.images]:[]).filter(H=>H!==F);return{..._,images:$}}),M)try{await In.deleteImage(F,!0),v(_=>_.filter(W=>W!==F))}catch(_){console.log(`Temporary image file deletion failed (may already be deleted): ${F}`,_)}else y(_=>_.includes(F)?_:[..._,F])}catch(M){console.error(`Failed to delete image file ${F}:`,M)}},D=(F,M)=>{i(_=>{let W={..._,[F]:M},$=F.toString().endsWith("Ids");return F==="account"&&!$?W.accountIds=Array.isArray(M)?[...M]:[]:F==="accountIds"&&!$?W.account=Array.isArray(M)?[...M]:[]:F==="setup"&&!$?W.setupIds=Array.isArray(M)?[...M]:[]:F==="setupIds"&&!$?W.setup=Array.isArray(M)?[...M]:[]:F==="mistake"&&!$?W.mistakeIds=Array.isArray(M)?[...M]:[]:F==="mistakeIds"&&!$&&(W.mistake=Array.isArray(M)?[...M]:[]),W})},O=(0,An.useRef)([]),z=(0,An.useRef)(null);(0,An.useEffect)(()=>{O.current=g},[g]);let I=async F=>{var M;try{let _=Xn().plugins.plugins.journalit,W=_?_.tradeService:null;if(!W)throw new Error("Could not access TradeService");let $=a.entryTime?new Date(a.entryTime):new Date,H=a.instrument||"UNKNOWN",R=lr($,_),V=a.isMissedTrade||!1,{year:Z,month:K,weekOfMonth:X,formattedDate:G}=await W.getTradePathComponents(R),U=await W.sanitizeTickerForFilename(H),Q;if(z.current)Q=z.current;else if(e&&e.entryTime){let Le=e.filePath||"";if(Le){let $e=Le.match(/[TMB](\d+)\.md$/);$e?Q=$e[1]:V&&(_!=null&&_.missedTradeService)?Q=await _.missedTradeService.getMissedTradeNumberForDay(U,R):Q=await W.getTradeNumberForDay(U,R),z.current=Q}else V&&(_!=null&&_.missedTradeService)?Q=await _.missedTradeService.getMissedTradeNumberForDay(U,R):Q=await W.getTradeNumberForDay(U,R),z.current=Q}else V&&(_!=null&&_.missedTradeService)?Q=await _.missedTradeService.getMissedTradeNumberForDay(U,R):Q=await W.getTradeNumberForDay(U,R),z.current=Q;let J=V?"M":"T",ee=(M=_.serviceManager)==null?void 0:M.getFolderPathService(),te=ee?ee.journalFolderPath:"!Journalit",ue=`${te}/${Z}/${K}/${X}/media/${U}-${G}-${J}${Q}`;try{let Le=Xn();await Le.vault.adapter.mkdir((0,Tv.normalizePath)(te)),await Le.vault.adapter.mkdir((0,Tv.normalizePath)(`${te}/${Z}`)),await Le.vault.adapter.mkdir((0,Tv.normalizePath)(`${te}/${Z}/${K}`)),await Le.vault.adapter.mkdir((0,Tv.normalizePath)(`${te}/${Z}/${K}/${X}`)),await Le.vault.adapter.mkdir((0,Tv.normalizePath)(ue))}catch(Le){}let be=await In.saveImage(F,ue,`${U}-${J}${Q}`);return v(Le=>[...Le,be]),be}catch(_){throw console.error("Failed to upload image:",_),new Error(`Failed to upload image: ${_.message}`)}},A=async F=>{F.preventDefault(),f(!0);let M=QF(a);if(o!=null&&o.customFieldsService&&a.customFields){let W=o.customFieldsService.getFields(),$=ZF(a.customFields,W,o.customFieldsService);Object.keys($).length>0&&(M.customFields=$)}d(M),p(M);let _={...a};if(t&&e.filePath&&(_.filePath=e.filePath),!_.assetType&&a.assetType&&(_.assetType=a.assetType),a.useDirectPnLInput!==void 0&&(_.useDirectPnLInput=a.useDirectPnLInput),a.directPnL!==void 0&&(_.directPnL=a.directPnL),a.isMissedTrade!==void 0&&(_.isMissedTrade=a.isMissedTrade),a.missedReason!==void 0&&(_.missedReason=a.missedReason),!LC(M)&&r){j(_);try{for(let W of h)await In.deleteImage(W,!0)}catch(W){console.error("Failed to delete marked images:",W)}r(_||a),v([]),y([]),S(!0),p({}),d({}),f(!1)}},j=async F=>{try{let M=Xn().plugins.plugins.journalit,_=(M==null?void 0:M.optionsService)||(M?new va(M):null);if(!_)return;F.instrument&&await _.addOption("instrument",F.instrument),F.account&&F.account.length>0&&await _.addOptions("account",F.account),F.setup&&F.setup.length>0&&await _.addOptions("setup",F.setup),F.mistake&&F.mistake.length>0&&await _.addOptions("mistake",F.mistake),F.customTags&&F.customTags.length>0&&await _.addOptions("tag",F.customTags)}catch(M){console.error("Failed to save custom options:",M)}};(0,An.useEffect)(()=>()=>{T()},[]);let E=()=>{T(),y([]),n&&n()},[N,B]=(0,An.useState)(!1),C=(0,An.useCallback)(()=>{if(!l.current)return!1;let F=l.current,M=(a.instrument||"").trim()!==(F.instrument||"").trim(),_=(a.entryPrice||0)!==(F.entryPrice||0),W=(a.exitPrice||0)!==(F.exitPrice||0),$=(a.positionSize||0)!==(F.positionSize||0),H=(a.thesis||"").trim()!==(F.thesis||"").trim(),R=(a.direction||"")!==(F.direction||""),V=Array.isArray(a.images)?a.images.length:0,Z=Array.isArray(F.images)?F.images.length:0;return M||_||W||$||H||V!==Z||R},[a.instrument,a.entryPrice,a.exitPrice,a.positionSize,a.thesis,a.images,a.direction]);return{formData:a,errors:c,formRef:b,handleFieldChange:D,handleAddImage:I,deleteImageFile:P,handleSubmit:A,handleCancel:E,isSubmitting:N,setIsSubmitting:B,formSubmitted:m,cleanupPerformed:w,imagesToDelete:h,isDirty:C}}});var Kq=L(()=>{Yq()});var HC,wO,Jq=L(()=>{HC=q(Y());Nr();Rf();wO=({onCancel:e,isSubmitting:t,errors:r,isEditMode:n,hasEntryTime:o})=>{let a=()=>n?"Update Trade":o?"Save Changes":"Add Trade";return HC.default.createElement("div",{className:"formActions"},e&&HC.default.createElement(he,{variant:"outline",onClick:e,disabled:t,className:"cancelButton"},"Cancel"),HC.default.createElement(he,{type:"submit",variant:"primary",loading:t,disabled:LC(r),className:"submitButton"},a()))}});var Xq=L(()=>{Jq()});var mn,Qq,Zq=L(()=>{mn=q(Y());ow();Vq();Kq();Xq();Qq=({initialData:e={},isSubmitting:t=!1,isEditMode:r=!1,onSubmit:n,onCancel:o,onDirtyStateChange:a})=>{let{formData:i,errors:s,formRef:l,handleFieldChange:c,handleAddImage:d,deleteImageFile:u,handleSubmit:p,handleCancel:m,isDirty:f}=xO({initialData:e,isEditMode:r,onSubmit:n,onCancel:o});(0,mn.useEffect)(()=>{a&&a(f)},[f,a]);let[g,v]=(0,mn.useState)("basic"),[h,y]=(0,mn.useState)(()=>r&&i.customFields?i.customFields:{});(0,mn.useMemo)(()=>(Df(),!0),[]);let b=[],x=[],w=[],S=[],k=[],T=(I,A)=>{let j={...h,[I]:A};y(j),c("customFields",j)};mn.default.useEffect(()=>{if(i.customFields){let I=JSON.stringify(h),A=JSON.stringify(i.customFields);I!==A&&y(i.customFields)}},[i.customFields,h]);let P=I=>{I!==g&&v(I)},D=mn.default.useMemo(()=>{let I=["instrument","direction","assetType","entries","exits","entriesExits","entryTime","entryPrice","positionSize","exitTime","exitPrice","accountIds","commission","commissionType","fees","swap","exchange","strikePrice","optionType","contractSize","expirationDate","dollarPerPoint","tickSize","tickValue","contractSymbol","lotSize","pipValue","currencyPair","cryptoExchange","tradingPair","leverageRatio","directPnL","stopLoss","riskAmount"],A=["setupIds"],j=["customFields"],E=I.filter(C=>{let F=s[C];return F&&F!==""}),N=A.filter(C=>{let F=s[C];return F&&F!==""}),B=j.filter(C=>{let F=s[C];return F&&F!==""});return{basic:E.length,details:N.length,advanced:B.length}},[s]),O=[{id:"basic",label:"Basic",errorCount:D.basic},{id:"details",label:"Details",errorCount:D.details},{id:"advanced",label:"Advanced",errorCount:D.advanced}],z=()=>{switch(g){case"basic":return mn.default.createElement(cO,{data:i,errors:s,onChange:c,instruments:S});case"details":return mn.default.createElement(hO,{data:i,errors:s,onChange:c,accounts:b,setups:x,mistakes:w,availableTags:k,onAddImage:d,onDeleteImage:u});case"advanced":return mn.default.createElement(bO,{data:i,errors:s,onChange:c,customFieldValues:h,onCustomFieldChange:T});default:return null}};return mn.default.createElement("form",{ref:l,className:"formContainer",style:{gap:"8px",position:"relative"},onSubmit:p},(D.basic>0||D.details>0||D.advanced>0)&&mn.default.createElement("div",{className:"errorSummary",style:{marginBottom:"16px"}},mn.default.createElement("strong",null,"Please fix the following errors:"),mn.default.createElement("ul",{style:{margin:"8px 0 0 20px",padding:0}},D.basic>0&&mn.default.createElement("li",null,"Basic tab has ",D.basic," error",D.basic>1?"s":""),D.details>0&&mn.default.createElement("li",null,"Details tab has ",D.details," error",D.details>1?"s":""),D.advanced>0&&mn.default.createElement("li",null,"Advanced tab has ",D.advanced," error",D.advanced>1?"s":""))),mn.default.createElement("nav",{className:"journalit-tab-nav"},mn.default.createElement("div",{className:"journalit-tab-wrapper"},O.map(I=>mn.default.createElement("button",{key:I.id,type:"button",className:`journalit-tab-button ${g===I.id?"journalit-tab-active":""}`,onClick:()=>P(I.id)},I.label,I.errorCount>0&&mn.default.createElement("span",{className:"journalit-tab-error-badge"},I.errorCount)))),r&&mn.default.createElement("span",{className:"journalit-edit-badge"},"EDIT")),z(),mn.default.createElement(wO,{onCancel:m,isSubmitting:t,errors:s,isEditMode:r,hasEntryTime:!!e.entryTime}))}});var eG=L(()=>{Zq();lv();Rf();tm();zC();lO();dO();gO()});var ce,Oo=L(()=>{ce={}});function Pc(e=!1,t=!1,r=!1,n=!1,o=!1,a=!1,i=!1,s=!1,l=!1){try{if(!t&&ce.tradeNote&&ce.tradeNote.remove(),!a&&ce.image&&ce.image.remove(),e||(ce.drc&&ce.drc.remove(),ce.drcNote&&ce.drcNote.remove()),!r&&ce.settings&&ce.settings.remove(),!n&&(ce.dashboard&&ce.dashboard.remove(),!i)){let c=document.head.querySelector("#dashboard-transparency-styles");c&&c.remove()}ce.weeklyReview&&ce.weeklyReview.remove(),ce.monthlyReview&&ce.monthlyReview.remove(),!s&&ce.shared&&ce.shared.remove(),ce.tooltip&&ce.tooltip.remove(),ce.dragOverlay&&ce.dragOverlay.remove(),ce.tradeForm&&ce.tradeForm.remove(),!o&&ce.chart&&ce.chart.remove(),!l&&ce.tradeLog&&ce.tradeLog.remove(),MC(),window.__isHandlingComboBoxRemove=!1}catch(c){console.error("Failed to remove styles:",c)}}function Cv(e=!1,t=!1,r=!0,n=!0,o=!0,a=!0,i=!1,s=!0,l=!0,c=!0){var d,u,p,m,f,g,v;if(e&&((d=ce.drc)!=null&&d.inject)&&ce.drc.inject(),t&&((u=ce.tradeNote)!=null&&u.inject)&&ce.tradeNote.inject(),n&&((p=ce.dashboard)!=null&&p.inject)&&ce.dashboard.inject(),r&&((m=ce.settings)!=null&&m.inject)&&ce.settings.inject(),o&&((f=ce.chart)!=null&&f.inject)&&ce.chart.inject(),a&&((g=ce.image)!=null&&g.inject)&&ce.image.inject(),c&&((v=ce.tradeLog)!=null&&v.inject)&&ce.tradeLog.inject(),!(window.__isInjectingStyles&&!i)){window.__isInjectingStyles=!0;try{Pc(e,t,r,n,o,a,s,l,c),ce.shared&&ce.shared.inject(),ce.tooltip&&ce.tooltip.inject(),ce.dragOverlay&&ce.dragOverlay.inject(),ce.tradeForm&&ce.tradeForm.inject(),ce.chart&&ce.chart.inject(),hv(),ce.weeklyReview&&ce.weeklyReview.inject(),ce.monthlyReview&&ce.monthlyReview.inject(),ce.image&&ce.image.inject(),ce.tradeLog&&ce.tradeLog.inject(),e||(ce.drc&&ce.drc.inject(),ce.drcNote&&ce.drcNote.inject()),!t&&ce.tradeNote&&ce.tradeNote.inject(),!r&&ce.settings&&ce.settings.inject(),!n&&ce.dashboard&&ce.dashboard.inject(),typeof window!="undefined"&&ce.drc&&(window.__JOURNALIT_INJECT_DRC_STYLES=ce.drc.inject)}catch(h){console.error("Failed to inject styles:",h)}finally{window.__isInjectingStyles=!1}}}var kO=L(()=>{Oo();am()});function SO(){try{let e="weekly-review-styles";if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=Cbe,document.head.appendChild(t)}catch(e){console.error("Failed to inject Weekly Review styles:",e)}}function tG(){try{let t=document.getElementById("weekly-review-styles");t&&t.parentNode&&t.parentNode.removeChild(t)}catch(e){console.error("Failed to remove Weekly Review styles:",e)}}function Pbe(){try{let e="weekly-review-alignment-fix";if(!document.getElementById(e)){let t=document.createElement("style");t.id=e,t.textContent=`
        /* Core alignment fixes for Weekly Review */
        .weekly-review-content {
          padding: 20px 0 0 !important;
        }

        .weekly-review-section {
          width: 100% !important;
          margin-left: 0 !important;
          margin-right: 0 !important;
          margin-bottom: 24px !important;
          box-sizing: border-box !important;
        }

        /* Fix for nested containers in tabs */
        .weekly-review-preparation,
        .weekly-review-overview,
        .weekly-review-review {
          padding: 0 !important;
          width: 100% !important;
        }

        /* High priority rule for all event/forecast/question containers */
        .weekly-review-event-item,
        .weekly-review-forecast-section,
        .weekly-review-grade-item,
        .weekly-review-question,
        /* .weekly-review-drc-list, /* These seem specific to Overview/Review tabs */
        /* .weekly-review-goals-list, */
        /* .weekly-review-drc-card, */
        .weekly-review-event-selector {
          width: 100% !important;
          box-sizing: border-box !important;
        }

        /* Make sure tables span full width and have consistent styling */
        .weekly-review-trades-table,
        .weekly-review-setup-table {
          width: 100% !important;
          overflow-x: auto !important;
          margin-bottom: 16px !important;
        }

        /* Table styling with high specificity for consistent rendering */
        .weekly-review-trades-table table,
        .weekly-review-setup-table table {
          width: 100% !important;
          border-collapse: collapse !important;
          font-size: 14px !important;
          text-align: left !important;
          margin: 0 !important;
          table-layout: auto !important;
        }

        /* Table headers */
        .weekly-review-trades-table th,
        .weekly-review-setup-table th {
          padding: 10px 12px !important;
          border-bottom: 2px solid var(--background-modifier-border) !important;
          font-weight: 600 !important;
          color: var(--text-normal) !important;
          background-color: var(--background-secondary) !important;
          text-align: left !important;
          white-space: nowrap !important;
        }

        /* Table cells */
        .weekly-review-trades-table td,
        .weekly-review-setup-table td {
          padding: 8px 12px !important;
          border-bottom: 1px solid var(--background-modifier-border) !important;
          text-align: left !important;
          transition: background-color 0.2s ease !important;
        }

        /* Clickable trade rows */
        .weekly-review-trade-row {
          cursor: pointer !important;
          transition: background-color 0.2s ease !important;
        }

        .weekly-review-trade-row:hover {
          background-color: var(--background-modifier-hover) !important;
        }

        /* Hover effect for table rows */
        .weekly-review-trades-table tr:hover td,
        .weekly-review-setup-table tr:hover td {
          background-color: var(--background-modifier-hover) !important;
        }

        /* Ensure color styles are properly applied in table cells */
        .weekly-review-trades-table td[style*="color: var(--color-green)"],
        .weekly-review-setup-table td[style*="color: var(--color-green)"] {
          color: var(--color-green, #43a047) !important;
        }

        .weekly-review-trades-table td[style*="color: var(--color-red)"],
        .weekly-review-setup-table td[style*="color: var(--color-red)"] {
          color: var(--color-red, #e53935) !important;
        }

        /* Best/Worst Trade section styles */
.weekly-review-best-trade {
        border: 1px solid var(--background-modifier-border) !important;
        border-radius: 6px !important;
        overflow: hidden !important;
        background-color: var(--background-secondary) !important;
}

/* Added styling for the notes section with tags and mistakes */
.weekly-review-best-trade-notes {
        padding: 0 16px 12px !important;
        display: flex !important;
        flex-direction: column !important;
        gap: 8px !important;
}

/* Special styling for best/worst trades */
.weekly-review-best-trade.best-trade {
  border-left: 3px solid var(--color-green, #43a047) !important;
}

.weekly-review-best-trade.worst-trade {
  border-left: 3px solid var(--color-red, #e53935) !important;
}

        .weekly-review-best-trade-header {
          display: flex !important;
          justify-content: space-between !important;
          align-items: center !important;
          padding: 12px 16px !important;
          background-color: var(--background-secondary-alt, var(--background-secondary)) !important;
          border-bottom: 1px solid var(--background-modifier-border) !important;
        }

        .weekly-review-best-trade-details {
          padding: 12px 16px !important;
        }

        .weekly-review-best-trade-detail {
          margin-bottom: 6px !important; /* Reduced from 8px for more even spacing */
          display: flex !important;
          align-items: center !important;
          width: 100% !important;
        }
        
        /* Last detail item should have no bottom margin */
        .weekly-review-best-trade-detail:last-child {
          margin-bottom: 0 !important;
        }

        .weekly-review-best-trade-label {
          font-weight: 500 !important;
          width: 80px !important;
          color: var(--text-muted) !important;
        }

        .weekly-review-view-button {
          background-color: var(--interactive-accent) !important;
          color: var(--text-on-accent) !important;
          border: none !important;
          border-radius: 4px !important;
          padding: 8px 16px !important;
          font-size: 14px !important;
          cursor: pointer !important;
          margin-top: 8px !important;
          transition: background-color 0.2s ease !important;
        }

        .weekly-review-view-button:hover {
          background-color: var(--interactive-accent-hover) !important;
        }

        .weekly-review-view-button:disabled {
          opacity: 0.5 !important;
          cursor: not-allowed !important;
        }

        .weekly-review-best-trade-actions {
          padding: 0 16px 16px !important;
          display: flex !important;
          justify-content: flex-end !important;
        }
        
        /* Force proper styling for tags and mistakes section */
        .weekly-review-best-trade-notes {
          padding: 0 16px 12px !important;
          display: flex !important;
          flex-direction: column !important;
          gap: 8px !important;
          width: 100% !important;
          box-sizing: border-box !important;
        }

        /* Make sure charts span full width */
        .recharts-responsive-container {
          width: 100% !important;
        }

        /* Force layout of header to match DRC style exactly */
        .weekly-review-header {
          padding: 16px 20px 12px !important;
          background-color: var(--background-secondary) !important;
          text-align: center !important;
          border-bottom: 1px solid var(--background-modifier-border) !important;
          display: block !important;
          flex-direction: unset !important;
          box-sizing: border-box !important;
          width: 100% !important;
        }

        .weekly-review-date {
          font-size: 28px !important;
          font-weight: 600 !important;
          color: var(--text-normal) !important;
          margin-bottom: 20px !important;
          text-align: center !important;
        }

        .weekly-review-navigation {
          width: 100% !important;
          padding-top: 10px !important;
          border-top: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1)) !important;
          display: block !important;
          /* Removed margin overrides from invalid file */
        }

        .weekly-review-navigation-links {
          display: flex !important;
          justify-content: space-between !important;
          align-items: center !important;
          gap: 8px !important;
          flex-wrap: wrap !important;
          width: 100% !important;
        }

        /* Higher specificity for navigation buttons */
        body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button,
        html .weekly-review-container .weekly-review-navigation .weekly-review-nav-button,
        .workspace-leaf .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button {
          padding: 8px 14px !important;
          border: 1px solid var(--background-modifier-border) !important;
          border-radius: 4px !important;
          background-color: var(--background-primary) !important;
          color: var(--text-normal) !important;
          cursor: pointer !important;
          font-size: 14px !important;
          transition: all 0.2s !important;
          display: flex !important;
          align-items: center !important;
          gap: 6px !important;
          /* Flex restored */
          flex: 1 !important;
          justify-content: center !important;
          text-align: center !important;
          min-width: 120px !important;
        }

        /* Extra specificity for hover state */
        body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button:hover,
        html .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button:hover,
        .workspace-leaf .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button:hover {
          background-color: var(--background-modifier-hover) !important;
          transform: translateY(-1px) !important;
        }

        /* Fix for nav icon in weekly review - higher specificity */
        body .weekly-review-nav-button .nav-icon,
        html .weekly-review-container .weekly-review-navigation .weekly-review-nav-button .nav-icon {
          font-size: 16px !important;
          line-height: 1 !important;
        }

        /* Enhanced duplicate prevention for weekly review components */
        /* First rule: Hide any weekly review view that comes after another one */
        .markdown-preview-view .journalit-weekly-review-view[data-file-path] + .journalit-weekly-review-view[data-file-path],
        .markdown-reading-view .journalit-weekly-review-view[data-file-path] + .journalit-weekly-review-view[data-file-path],
        /* Second rule: Hide direct duplicates */
        .markdown-preview-view .journalit-weekly-review-view + .journalit-weekly-review-view,
        .markdown-reading-view .journalit-weekly-review-view + .journalit-weekly-review-view,
        /* Third rule: Hide duplicate wrappers */
        .weekly-review-wrapper + .weekly-review-wrapper {
          display: none !important; /* Hide any second Weekly Review component that appears after another one */
        }

        /* Ensure we never show multiple instances in any mode - additional rules */
        /* Add data-view-mode attribute based rules */
        [data-view-mode="preview"] + [data-view-mode="preview"],
        [data-view-mode="source"] + [data-view-mode="source"],
        /* Strict duplicate prevention by adding direct adjacency rules */
        .journalit-weekly-review-view + .journalit-weekly-review-view,
        [data-view-mode="read"] + [data-view-mode="read"],
        [data-view-mode="read"] + [data-view-mode="read-fallback"],
        [data-view-mode="read-fallback"] + [data-view-mode="read"] {
          display: none !important;
        }

        /* Ultra-high specificity rule for weekly review navigation buttons container */
        html body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links,
        body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links,
        .workspace-leaf .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links {
          display: flex !important;
          justify-content: space-between !important;
          align-items: center !important;
          gap: 8px !important;
          flex-wrap: wrap !important;
          width: 100% !important;
        }

        /* Ultra-high specificity rule for each weekly navigation button */
        html body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button,
        body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button,
        .workspace-leaf .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button {
          padding: 8px 14px !important;
          border: 1px solid var(--background-modifier-border) !important;
          border-radius: 4px !important;
          background-color: var(--background-primary) !important;
          color: var(--text-normal) !important;
          cursor: pointer !important;
          font-size: 14px !important;
          transition: all 0.2s !important;
          display: flex !important;
          align-items: center !important;
          justify-content: center !important;
          gap: 6px !important;
          flex: 1 !important;
          text-align: center !important;
          min-width: 120px !important;
          box-sizing: border-box !important;
        }

        /* Fix mobile layout */
        @media (max-width: 768px) {
          .weekly-review-navigation-links {
            justify-content: center !important;
            flex-wrap: wrap !important;
            width: 100% !important;
          }

          .weekly-review-nav-button {
            flex: 1 !important;
            min-width: 120px !important;
            justify-content: center !important;
          }
        }
      `,document.head.appendChild(t)}}catch(e){console.error("Failed to apply Weekly Review alignment fix:",e)}}function Pv(){if(document.getElementById("weekly-review-styles")||SO(),Pbe(),!document.getElementById("critical-weekly-review-styles")){let e=document.createElement("style");e.id="critical-weekly-review-styles",e.textContent=`
      /* Critical core styles for Weekly Review */
      .journalit-weekly-review-view {
        display: block !important;
        width: 100% !important;
        margin: 0 !important;
        padding: 0 !important;
        z-index: 100 !important;
        visibility: visible !important;
        opacity: 1 !important;
      }

      .weekly-review-wrapper {
        display: block !important; /* Changed from flex */
        width: 100% !important;
        position: relative !important;
        z-index: 100 !important;
      }

      .weekly-review-container {
        display: flex !important;
        flex-direction: column !important;
        width: 100% !important;
      }

      .weekly-review-content {
        display: block !important; /* Ensure content area displays */
        width: 100% !important;
      }

      /* Critical navigation button styling - highest possible specificity (Restored) */
       html body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button {
         /* Keeping basic display/visibility, detailed styles in ensureAlignmentFix */
         display: flex !important;
         visibility: visible !important;
         opacity: 1 !important;
       }

       /* Removed duplicate .weekly-review-wrapper, .container, .content rules */
    `,document.head.appendChild(e)}}var Cbe,n0=L(()=>{Cbe=`
/* Color variables for event colors and consistency */
:root {
  --chart-positive: var(--color-green, #43a047);
  --chart-negative: var(--color-red, #e53935);
  --event-color-red: var(--color-red, #e53935);
  --event-color-orange: var(--color-orange, #fb8c00);
  --event-color-yellow: var(--color-yellow, #fdd835);
  --event-color-gray: var(--text-muted, #888888); /* Use muted text color as base for gray */
  --event-text-color-on-dark: #ffffff; /* Text color for darker backgrounds */
  --event-text-color-on-light: #000000; /* Text color for lighter backgrounds (like yellow) */
  --interactive-accent-rgb: 83, 141, 226; /* Default RGB values for interactive accent - synced with tradeForm */
}

/* Weekly Review View container - ensures no extra margins/padding */
.journalit-weekly-review-view,
.markdown-preview-view .journalit-weekly-review-view {
  margin: 0 !important; /* Remove all margins */
  border-bottom: none !important; /* Remove bottom border causing extra space */
  padding: 0 !important; /* Remove all padding */
  display: block !important;
  width: 100% !important;
  z-index: 100 !important;
  /* Force visibility */
  visibility: visible !important;
  opacity: 1 !important;
  background-color: var(--background-primary) !important;
  /* Removed borders */
  border: none !important;
  border-radius: 8px !important;
  /* Ensure proper containment */
  position: relative;
  box-sizing: border-box;
  /* Prevent overlaps */
  contain: content;
  /* Ensure proper isolation from other views */
  isolation: isolate;
}

/* Weekly Review React root wrapper */
.weekly-review-wrapper {
  width: 100%;
  display: flex;
  flex-direction: column;
  contain: content;
  /* Keep React root fully contained */
  isolation: isolate;
  /* Create a new stacking context */
  position: relative;
  /* Ensure clean slate for each instance */
  box-sizing: border-box;
  margin: 0 !important;
  z-index: 100 !important;
}


/* Weekly Review Container */
.weekly-review-container {
  display: flex;
  flex-direction: column;
  font-family: var(--font-text);
  color: var(--text-normal);
  width: 100%;
  height: 100%;
  overflow: hidden;
  background-color: var(--background-primary);
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  position: relative; /* Establish positioning context to prevent jumping */
  z-index: 1; /* Ensure proper stacking context */
  transform: translateZ(0); /* Force GPU acceleration for stability */
  will-change: auto !important; /* Prevent aggressive optimization */
  contain: layout style !important; /* CSS containment to prevent layout recalculation cascades */
}

/* Header and Navigation - Styled to match DRC */
.weekly-review-header {
  padding: 16px 20px 12px;
  background-color: var(--background-secondary);
  text-align: center;
  border-bottom: 1px solid var(--background-modifier-border);
}

.weekly-review-date {
  font-size: 28px;
  font-weight: 600;
  color: var(--text-normal);
  margin-bottom: 20px;
}

/* Navigation - Matches DRC navigation */
/* Weekly Review specific header classes */
.weekly-review-title {
  font-size: 28px;
  font-weight: 600;
  color: var(--text-normal);
  margin-bottom: 20px;
  text-align: center;
}

.weekly-review-date-container {
  font-size: 28px;
  font-weight: 600;
  color: var(--text-normal);
  margin-bottom: 20px;
  text-align: center;
}

.weekly-review-navigation {
  width: 100%;
  padding-top: 10px;
  border-top: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1));
}

.weekly-review-navigation-links {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
  width: 100% !important;
}

.weekly-review-nav-button {
  padding: 8px 14px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  background-color: var(--background-primary);
  color: var(--text-normal);
  cursor: pointer;
  font-size: 14px;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  flex: 1;
  text-align: center;
  min-width: 120px;
}

.weekly-review-nav-button:hover {
  background-color: var(--background-modifier-hover);
  transform: translateY(-1px);
}

.weekly-review-nav-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.nav-icon {
  font-size: 14px;
  margin-right: 4px;
  margin-left: 4px;
}

/* Critical navigation styles with high specificity */
html body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links,
body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links,
.workspace-leaf .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links {
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  gap: 8px !important;
  flex-wrap: wrap !important;
  width: 100% !important;
}

html body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button,
body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button,
.workspace-leaf .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button {
  padding: 8px 14px !important;
  border: 1px solid var(--background-modifier-border) !important;
  border-radius: 4px !important;
  background-color: var(--background-primary) !important;
  color: var(--text-normal) !important;
  cursor: pointer !important;
  font-size: 14px !important;
  transition: all 0.2s !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  gap: 6px !important;
  flex: 1 !important;
  text-align: center !important;
  min-width: 120px !important;
  box-sizing: border-box !important;
  max-width: none !important;
  margin: 0 !important;
}

/* Ensure proper icon spacing */
html body .weekly-review-container .weekly-review-navigation .weekly-review-nav-button .nav-icon,
body .weekly-review-container .weekly-review-navigation .weekly-review-nav-button .nav-icon {
  font-size: 16px !important;
  line-height: 1 !important;
}

/* Tabs */
.weekly-review-tabs-container {
  display: flex;
  justify-content: center;
  border-bottom: 1px solid var(--background-modifier-border);
  background-color: var(--background-secondary-alt, #2a2a2a);
  padding: 0;
}

.weekly-review-tabs {
  display: flex;
  justify-content: center;
  background-color: transparent;
  max-width: 600px;
  margin: 0 auto;
}

.weekly-review-tab {
  padding: 12px 24px;
  font-size: 14px;
  font-weight: 600;
  color: var(--text-muted);
  background-color: transparent;
  border: none;
  border-bottom: 2px solid transparent;
  cursor: pointer;
  transition: all 0.2s ease;
  position: relative;
  outline: none;
}

.weekly-review-tab:hover {
  color: var(--text-normal);
  background-color: rgba(127, 127, 127, 0.05);
}

.weekly-review-tab.active {
  color: var(--text-accent);
  border-bottom: 2px solid var(--text-accent);
}

/* Content */
.weekly-review-content {
  flex: 1;
  overflow-y: auto;
  padding: 20px 0 0; /* Only top padding, no horizontal padding */
}

/* Sections */
.weekly-review-section {
  margin: 0 0 24px 0; /* Explicit horizontal margin of 0 */
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  padding: 16px;
  width: 100%; /* Ensure full width */
  box-sizing: border-box; /* Include padding in width calculation */
}

.weekly-review-section-title {
  margin: 0 0 16px 0;
  padding-bottom: 8px;
  font-size: 16px;
  font-weight: 600;
  color: var(--text-normal);
  border-bottom: 1px solid var(--background-modifier-border);
  text-align: center;
}

/* Fix Section title styling - especially for Previous Week Goals */
.weekly-review-previous-goals h3,
.weekly-review-section h3 {
  font-size: 1rem !important;
  margin-top: 0.5rem !important;
  margin-bottom: 1rem !important;
  text-align: center !important;
  font-weight: 600 !important;
  color: var(--text-normal) !important;
  padding-bottom: 0.5rem !important;
  border-bottom: 1px solid var(--background-modifier-border) !important;
}

/* Empty states */
.weekly-review-empty-state,
.weekly-review-no-trades,
.weekly-review-no-drcs,
.weekly-review-no-events,
.weekly-review-no-questions {
  padding: 16px;
  text-align: center;
  color: var(--text-muted);
  font-style: italic;
  background-color: var(--background-secondary);
  border-radius: 6px;
}

/* Checklist for previous goals - Modified for 2-column grid layout */
.weekly-review-checklist {
  display: grid; /* Changed from flex */
  grid-template-columns: repeat(2, 1fr); /* Create two equal columns */
  gap: 12px; /* Increased gap for grid layout */
}

.weekly-review-checklist-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  border-radius: 4px;
  background-color: var(--background-secondary);
  cursor: pointer; /* Make the entire area clickable */
  transition: background-color 0.2s ease;
}

.weekly-review-checklist-item:hover {
  background-color: var(--background-modifier-hover);
}

.weekly-review-checkbox {
  width: 18px;
  height: 18px;
  margin: 0;
  cursor: pointer;
}

/* Key Events */
.weekly-review-key-events {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.weekly-review-event-selector {
  display: flex;
  flex-direction: column;
  gap: 12px;
  padding: 16px;
  background-color: var(--background-secondary);
  border-radius: 8px;
}

/* ComboBox styling - matched with DRC implementation */
.weekly-review-container .combobox-container,
.weekly-review-container [data-combobox-type],
.weekly-review-event-selector .combobox-container,
.weekly-review-section .combobox-container {
  position: relative !important;
  width: 100% !important;
  margin-bottom: 8px !important;
  z-index: 10 !important;
}

/* Increased z-index when dropdown is open */
.weekly-review-container .combobox-container[data-is-open="true"],
.weekly-review-container [data-combobox-type][data-is-open="true"],
.weekly-review-event-selector .combobox-container[data-is-open="true"],
.weekly-review-section .combobox-container[data-is-open="true"] {
  z-index: 9999 !important;
}

/* Dropdown caret for Weekly Review ComboBox */
.weekly-review-container [data-combobox-type] .input-container::after,
.weekly-review-event-selector .combobox-container .input-container::after,
.weekly-review-section .combobox-container .input-container::after {
  content: "" !important;
  position: absolute !important;
  right: 12px !important;
  top: 50% !important;
  transform: translateY(-50%) !important;
  width: 0 !important;
  height: 0 !important;
  border-left: 5px solid transparent !important;
  border-right: 5px solid transparent !important;
  border-top: 5px solid var(--text-normal) !important;
  pointer-events: none !important;
  z-index: 10 !important;
}

/* Input padding to make room for dropdown arrow */
.weekly-review-container [data-combobox-type] input[role="combobox"],
.weekly-review-event-selector .combobox-container input[role="combobox"],
.weekly-review-section .combobox-container input[role="combobox"] {
  padding-right: 30px !important;
  width: 100% !important;
  padding: 8px 12px !important;
  padding-right: 30px !important;
  border: 1px solid var(--background-modifier-border) !important;
  border-radius: 4px !important;
  background-color: var(--background-primary) !important;
  color: var(--text-normal) !important;
  font-size: 16px !important;
  cursor: pointer !important;
  position: relative !important;
  z-index: 10000 !important; /* Higher than dropdown (9999) to ensure focus border shows on top */
}

/* Input field focus styling - ensure focus outlines appear above dropdown */
.weekly-review-container [data-combobox-type] input[role="combobox"]:focus,
.weekly-review-event-selector .combobox-container input[role="combobox"]:focus,
.weekly-review-section .combobox-container input[role="combobox"]:focus {
  outline: 2px solid var(--interactive-accent) !important; /* Match Obsidian's focus style */
  outline-offset: -1px !important;
  border-color: var(--interactive-accent) !important;
  box-shadow: 0 0 0 1px var(--interactive-accent) !important;
  z-index: 10001 !important; /* Ensure focus styling is above even the input */
}

/* Weekly Review dropdown options - remove bullets and match DRC */
.weekly-review-container [data-combobox-type] ul[role="listbox"],
.weekly-review-event-selector [data-combobox-type] ul[role="listbox"],
.weekly-review-section [data-combobox-type] ul[role="listbox"] {
  position: absolute !important;
  top: 100% !important;
  left: 0 !important;
  right: 0 !important;
  max-height: 200px !important;
  overflow-y: auto !important;
  background-color: var(--background-primary) !important;
  border: 1px solid var(--background-modifier-border) !important;
  border-top: none !important;
  border-radius: 0 0 4px 4px !important;
  margin-top: -1px !important;
  z-index: 9999 !important;
  list-style: none !important; /* Remove bullets */
  padding: 0 !important;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
  clip-path: inset(1px -15px -15px -15px) !important; /* Clip top edge to prevent covering the focus border */
}

/* Weekly Review dropdown options styling */
.weekly-review-container [data-combobox-type] ul[role="listbox"] li,
.weekly-review-event-selector [data-combobox-type] ul[role="listbox"] li,
.weekly-review-section [data-combobox-type] ul[role="listbox"] li {
  padding: 8px 12px !important;
  cursor: pointer !important;
  transition: background-color 150ms ease !important;
  margin: 0 !important;
  list-style: none !important; /* Ensure no bullets */
  border-bottom: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1)) !important;
}

/* Hover and selected state for Weekly Review dropdown options */
.weekly-review-container [data-combobox-type] ul[role="listbox"] li:hover,
.weekly-review-container [data-combobox-type] ul[role="listbox"] li[aria-selected="true"],
.weekly-review-event-selector [data-combobox-type] ul[role="listbox"] li:hover,
.weekly-review-event-selector [data-combobox-type] ul[role="listbox"] li[aria-selected="true"],
.weekly-review-section [data-combobox-type] ul[role="listbox"] li:hover,
.weekly-review-section [data-combobox-type] ul[role="listbox"] li[aria-selected="true"] {
  background-color: var(--background-secondary) !important;
}

/* Special styling for "Add new" option in Weekly Review */
.weekly-review-container [data-combobox-type] ul[role="listbox"] li[data-add-option="true"],
.weekly-review-event-selector [data-combobox-type] ul[role="listbox"] li[data-add-option="true"],
.weekly-review-section [data-combobox-type] ul[role="listbox"] li[data-add-option="true"] {
  font-style: italic !important;
  border-top: 1px dashed var(--background-modifier-border) !important;
}

/* When dropdown is open, change input border radius */
.weekly-review-container [data-combobox-type][data-is-open="true"] input[role="combobox"],
.weekly-review-event-selector [data-combobox-type][data-is-open="true"] input[role="combobox"],
.weekly-review-section [data-combobox-type][data-is-open="true"] input[role="combobox"] {
  border-bottom-left-radius: 0 !important;
  border-bottom-right-radius: 0 !important;
}

/* Weekly Review Multi-select styling - fixed for better visibility */
.weekly-review-event-selector .selected-options,
.weekly-review-event-selector .selected-item,
.weekly-review-section .selected-options,
.weekly-review-section .selected-item,
.weekly-review-container [data-combobox-type="multi"] > div:first-of-type {
  display: flex !important;
  flex-wrap: wrap !important;
  gap: 4px !important;
  max-width: 100% !important;
  padding: 2px 0 !important;
  z-index: 5 !important;
  position: relative !important;
}

/* Style selected tags to match the DRC */
.weekly-review-event-selector .selected-option,
.weekly-review-event-selector .selected-item,
.weekly-review-section .selected-option,
.weekly-review-section .selected-item {
  display: inline-flex !important;
  align-items: center !important;
  background-color: var(--interactive-accent, #7c3aed) !important;
  color: white !important;
  border-radius: 4px !important;
  padding: 4px 8px !important;
  font-size: 12px !important;
  margin: 0 4px 4px 0 !important;
  font-weight: 500 !important;
  z-index: 6 !important;
  position: relative !important;
  gap: 6px !important;
}

/* Style remove buttons ('\xD7') - matched with DRC */
.weekly-review-event-selector .selected-option-remove,
.weekly-review-event-selector .selected-item button,
.weekly-review-section .selected-option-remove,
.weekly-review-section .selected-item button {
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  width: 16px !important;
  height: 16px !important;
  min-width: 16px !important;
  min-height: 16px !important;
  padding: 0 !important;
  margin-left: 4px !important;
  cursor: pointer !important;
  background: rgba(255, 255, 255, 0.2) !important;
  border: none !important;
  border-radius: 50% !important;
  color: white !important;
  font-size: 14px !important;
  line-height: 1 !important;
  text-align: center !important;
  z-index: 7 !important;
  position: relative !important;
  transition: background-color 0.2s !important;
}

/* Add hover effect for remove buttons */
.weekly-review-event-selector .selected-option-remove:hover,
.weekly-review-event-selector .selected-item button:hover,
.weekly-review-section .selected-option-remove:hover,
.weekly-review-section .selected-item button:hover {
  background: rgba(255, 255, 255, 0.4) !important;
}

/* ADDED: Styles for the event color picker UI */
.weekly-review-event-color-selector {
  display: flex;
  gap: 10px;
  align-items: center;
  margin-top: 8px;
  margin-bottom: 8px;
}

.weekly-review-event-color-selector span { /* Style the "Color:" text */
  margin-right: 5px;
  font-size: 12px;
  color: var(--text-muted);
}

.weekly-review-event-color-selector label {
  display: flex;
  align-items: center;
  cursor: pointer;
}

.weekly-review-event-color-selector input[type="radio"] {
  margin-right: 4px;
  cursor: pointer;
  /* Consider using appearance: none and custom styling */
}

.weekly-review-event-color-selector label span { /* Style the colored circle */
  display: inline-block;
  width: 16px;
  height: 16px;
  border-radius: 50%;
  border: 1px solid var(--background-modifier-border);
}
/* END ADDED color picker styles */


.weekly-review-events-list {
  display: flex;
  flex-direction: column;
  gap: 12px; /* Changed from 12px to 10px in invalid file, reverting */
}

/* MODIFIED: Event item styling with color-specific borders */
.weekly-review-event-item {
  padding: 12px;
  background-color: var(--background-secondary);
  border-radius: 8px;
  border-left: 5px solid var(--event-color-gray); /* Default border color */
  margin-bottom: 8px; /* Add some spacing */
  transition: border-color 0.3s ease; /* Smooth transition for border color */
}

/* ADDED: Event color classes */
.weekly-review-event-item.event-color-red {
  border-left-color: var(--event-color-red);
}
.weekly-review-event-item.event-color-orange {
  border-left-color: var(--event-color-orange);
}
.weekly-review-event-item.event-color-yellow {
  border-left-color: var(--event-color-yellow);
}
.weekly-review-event-item.event-color-gray {
  border-left-color: var(--event-color-gray);
}
/* END ADDED color classes */

/* Day selector styling */
.weekly-review-event-day-selector {
  display: flex;
  gap: 10px;
  align-items: center;
  margin-top: 8px;
  margin-bottom: 8px;
}

.weekly-review-event-day-selector span {
  margin-right: 5px;
  font-size: 12px;
  color: var(--text-muted);
}

.weekly-review-event-day-selector select {
  padding: 4px 8px;
  border-radius: 4px;
  border: 1px solid var(--background-modifier-border);
  background-color: var(--background-primary);
  color: var(--text-normal);
  font-size: 14px;
  width: 150px;
}

/* Day badge in event items */
.weekly-review-event-day {
  font-size: 12px;
  padding: 2px 8px;
  background-color: var(--background-modifier-border);
  border-radius: 4px;
  color: var(--text-normal);
  font-weight: 500;
  white-space: nowrap;
}

.weekly-review-event-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}

.weekly-review-event-header h4 {
  margin: 0;
  font-size: 14px; /* Restored from 1.05em */
  font-weight: 600;
}

/* Forecast */
.weekly-review-forecast-section {
  margin-bottom: 20px;
  padding: 16px;
  background-color: var(--background-secondary); /* Restored from primary-alt */
  border-radius: 8px; /* Restored from 5px */
}

.weekly-review-forecast-section h4 { /* Added missing styling */
  margin-top: 0;
  margin-bottom: 15px;
  font-size: 1.05em; /* Keep consistent sizing */
}

.weekly-review-image-container {
  margin-bottom: 12px; /* Restored from 15px */
}

.weekly-review-image {
  position: relative;
  margin-bottom: 12px;
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 100%;
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  padding: 8px;
  background-color: var(--background-primary);
}

.weekly-review-forecast-image {
  width: auto; /* Allow natural width */
  max-width: 100%; /* Prevent overflow */
  max-height: 300px; /* Limit height */
  object-fit: contain; /* Maintain aspect ratio */
  border-radius: 6px;
  margin-bottom: 8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); /* Add subtle shadow */
  background-color: var(--background-primary); /* Ensure transparent PNGs have a background */
}

.weekly-review-image-upload {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 80px;
  border: 2px dashed var(--background-modifier-border);
  border-radius: 6px;
  margin-bottom: 12px;
  cursor: pointer;
  transition: all 0.2s ease;
  position: relative;
  overflow: hidden;
}

.weekly-review-image-upload:hover {
  border-color: var(--interactive-accent);
  background-color: rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.05);
}

.weekly-review-image-upload.dragging-over {
  border-color: var(--interactive-accent);
  background-color: rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.1);
  transform: scale(1.02);
  box-shadow: 0 0 12px rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.3);
}

.weekly-review-image-upload::after {
  content: "Drag and drop here";
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 16px;
  font-weight: 600;
  color: var(--interactive-accent);
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.2s ease;
}

.weekly-review-image-upload.dragging-over::after {
  opacity: 1;
}

.weekly-review-image-upload.dragging-over .weekly-review-image-label {
  opacity: 0;
}

.weekly-review-image-label {
  font-size: 14px;
  color: var(--text-muted);
  cursor: pointer;
  transition: all 0.2s ease;
}

.weekly-review-image-upload:hover .weekly-review-image-label {
  color: var(--interactive-accent);
}

.weekly-review-image-input {
  display: none;
}

.weekly-review-image-delete {
  /* Position restored from absolute in invalid file */
  background-color: rgba(229, 57, 53, 0.1);
  color: var(--color-error, #e53935);
  border: none;
  border-radius: 4px;
  padding: 6px 12px;
  font-size: 12px; /* Restored from 0.8em */
  cursor: pointer;
  /* Remove transition/opacity from invalid file */
}

/* Buttons */
.weekly-review-add-button {
  background-color: var(--interactive-accent);
  color: white; /* Restored from var */
  border: none;
  border-radius: 4px;
  padding: 8px 16px; /* Restored */
  font-size: 14px; /* Restored */
  cursor: pointer;
  font-weight: normal; /* Reset from invalid file */
  /* Removed align-self from invalid file, handled by container */
}

.weekly-review-add-button:hover {
  background-color: var(--interactive-accent-hover);
}

.weekly-review-add-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.weekly-review-remove-button,
.weekly-review-event-remove { /* Combined rule restored */
  background-color: rgba(229, 57, 53, 0.1); /* Restored from var */
  color: var(--color-error, #e53935); /* Restored from var */
  border: none;
  border-radius: 4px;
  padding: 4px 8px;
  font-size: 12px; /* Restored from 0.8em */
  cursor: pointer;
}

/* Image error message */
.weekly-review-image-error {
  color: var(--text-error, var(--color-red, #e53935));
  font-size: 12px;
  text-align: center;
  margin-top: 4px;
  margin-bottom: 8px;
  padding: 6px 10px;
  background-color: rgba(229, 57, 53, 0.1);
  border-radius: 4px;
  width: 100%;
}

.weekly-review-remove-button:hover,
.weekly-review-event-remove:hover {
  background-color: rgba(229, 57, 53, 0.2);
}

.weekly-review-add-event { /* This class seems unused, keeping for history */
  align-self: flex-start;
  margin-top: 12px;
}

/* Text Areas and Inputs */
.weekly-review-textarea {
  width: 100%;
  min-height: 80px; /* Restored from 100px */
  padding: 12px; /* Restored from 10px */
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px; /* Restored from 4px */
  background-color: var(--background-primary);
  color: var(--text-normal);
  font-family: var(--font-text); /* Added back */
  font-size: 16px; /* Updated from unset */
  resize: vertical;
}

.weekly-review-input { /* For generic inputs if used */
  width: 100%;
  padding: 10px 12px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  background-color: var(--background-primary);
  color: var(--text-normal);
  font-family: var(--font-text);
  font-size: 16px;
}

/* Metric Cards */
.weekly-review-metric-cards {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
  gap: 16px;
  margin-bottom: 16px;
}

.weekly-review-metric-card {
  padding: 16px;
  background-color: var(--background-secondary);
  border-radius: 8px;
  transition: transform 0.2s ease;
}

.weekly-review-metric-card:hover {
  transform: translateY(-2px);
}

.weekly-review-metric-label {
  font-size: 12px;
  color: var(--text-muted);
  margin-bottom: 8px;
}

.weekly-review-metric-value {
  font-size: 20px;
  font-weight: 700;
  color: var(--text-normal);
}

.weekly-review-metric-value[style*="color: var(--color-green)"],
.weekly-review-metric-value[style*="var(--color-green)"] {
  color: var(--color-green) !important;
}
.weekly-review-metric-value.positive { /* Added specific class */
  color: var(--chart-positive) !important;
}

.weekly-review-metric-value[style*="color: var(--color-red)"],
.weekly-review-metric-value[style*="var(--color-red)"] {
  color: var(--color-red) !important;
}
.weekly-review-metric-value.negative { /* Added specific class */
   color: var(--chart-negative) !important;
}


/* Trades list */
.weekly-review-trades {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.weekly-review-trade-item { /* Used if list view is implemented */
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 16px;
  background-color: var(--background-secondary);
  border-radius: 6px;
  cursor: pointer;
  transition: background-color 0.2s ease;
}

.weekly-review-trade-item:hover {
  background-color: var(--background-modifier-hover);
}

.weekly-review-trade-info {
  display: flex;
  align-items: center;
  gap: 8px;
}

.weekly-review-trade-instrument {
  font-weight: 600;
}

.weekly-review-trade-direction {
  color: var(--text-muted);
  font-size: 12px;
}

.weekly-review-trade-pnl {
  font-weight: 600;
}

.weekly-review-trade-pnl[style*="color: var(--color-green)"],
.weekly-review-trade-pnl[style*="var(--color-green)"] {
  color: var(--color-green) !important;
}
.weekly-review-trade-pnl.positive { /* Added specific class */
   color: var(--chart-positive) !important;
}

.weekly-review-trade-pnl[style*="color: var(--color-red)"],
.weekly-review-trade-pnl[style*="var(--color-red)"] {
  color: var(--color-red) !important;
}
.weekly-review-trade-pnl.negative { /* Added specific class */
   color: var(--chart-negative) !important;
}

/* Performance Grades */
.weekly-review-grades { /* Restored simple container */
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.weekly-review-grade-item { /* Restored simpler item */
  background-color: var(--background-secondary);
  border-radius: 8px;
  padding: 16px;
}

.weekly-review-grade-label {
  font-size: 14px; /* Restored */
  font-weight: 500;
  margin-bottom: 8px;
  color: var(--text-normal);
}

/* Performance grade stars */
.weekly-review-grade-stars {
  display: flex;
  gap: 8px;
  margin-bottom: 12px;
  position: relative;
}

.weekly-review-star {
  cursor: pointer;
  color: var(--text-muted);
  transition: color 0.2s ease;
  font-size: 1.5em;
  user-select: none;
  position: relative;
  display: inline-block;
  width: 1em;
  height: 1em;
  line-height: 1;
  text-align: center;
}

.weekly-review-star.full {
  color: gold !important;
}

.weekly-review-star.half {
  position: relative;
  color: var(--text-muted);
}

.weekly-review-star.half::after {
  content: "\u2605";
  position: absolute;
  left: 0;
  top: 0;
  width: 50%;
  overflow: hidden;
  color: gold !important;
  pointer-events: none;
}

/* Tooltip for star rating help */
.weekly-review-grade-stars::after {
  content: "Left click for full star, right click for half star";
  position: absolute;
  font-size: 10px;
  color: var(--text-muted);
  opacity: 0;
  transition: opacity 0.3s ease;
  margin-top: 30px;
  background: var(--background-primary);
  padding: 4px 8px;
  border-radius: 4px;
  pointer-events: none;
  border: 1px solid var(--background-modifier-border);
  white-space: nowrap;
  z-index: 100;
}

.weekly-review-grade-stars:hover::after {
  opacity: 1;
}


/* Daily Report Cards (DRCs) List - Modernized Styling */
.weekly-review-drcs {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

/* DRC List Container */
.weekly-review-drc-list {
  display: flex;
  flex-direction: column;
  gap: 16px;
  width: 100%;
}

/* DRC Card Container - modern card styling */
.weekly-review-drc-card {
  background-color: var(--background-primary);
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
  border: 1px solid var(--background-modifier-border);
}

/* DRC Header with date, grades and button */
.weekly-review-drc-header {
  background-color: var(--background-secondary-alt, var(--background-secondary));
  padding: 10px 16px; /* Reduced padding */
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 1px solid var(--background-modifier-border);
}

.weekly-review-drc-date {
  font-weight: 600;
  font-size: 15px;
  color: var(--text-normal);
  flex: 1;
}

/* Grade Pills in the center */
.weekly-review-drc-grades {
  display: flex;
  gap: 10px;
  justify-content: center;
  flex: 2;
}

.weekly-review-drc-grade {
  font-size: 12px;
  padding: 4px 8px;
  border-radius: 4px;
  background-color: var(--background-secondary-alt, var(--background-secondary));
  font-weight: 500;
  display: inline-flex;
  align-items: center;
  line-height: 1;
  color: white;
}

/* Color coding for grades */
.weekly-review-drc-grade.grade-a {
  background-color: var(--color-green, #43a047);
}

.weekly-review-drc-grade.grade-b {
  background-color: var(--color-orange, #fb8c00);
}

.weekly-review-drc-grade.grade-c {
  background-color: var(--color-red, #e53935);
}

/* Fallback for direct text matching if classes aren't applied */
.weekly-review-drc-grade[data-grade="A"] {
  background-color: var(--color-green, #43a047);
}

.weekly-review-drc-grade[data-grade="B"] {
  background-color: var(--color-orange, #fb8c00);
}

.weekly-review-drc-grade[data-grade="C"] {
  background-color: var(--color-red, #e53935);
}

/* DRC Content Area */
.weekly-review-drc-summary {
  padding: 14px 16px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  background-color: var(--background-primary-alt, var(--background-primary));
}

.weekly-review-drc-section {
  padding: 12px;
  background-color: var(--background-secondary);
  border-radius: 6px;
}

.weekly-review-drc-section-label {
  font-weight: 500;
  font-size: 13px;
  margin-bottom: 6px;
  color: var(--text-accent);
}

.weekly-review-drc-section-content {
  font-size: 14px;
  line-height: 1.5;
  color: var(--text-normal);
  white-space: pre-line;
  overflow-wrap: break-word;
}

/* DRC Actions Area - now in header */
.weekly-review-drc-actions {
  display: flex;
  justify-content: flex-end;
  flex: 1;
}

.weekly-review-drc-button {
  background-color: var(--interactive-accent);
  color: var(--text-on-accent, white);
  border: none;
  border-radius: 6px;
  padding: 6px 12px;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.15s ease;
  display: flex;
  align-items: center;
  gap: 6px;
}

.weekly-review-drc-button:hover {
  background-color: var(--interactive-accent-hover);
}

.weekly-review-drc-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* Legacy DRC item style for compatibility */
.weekly-review-drc-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 16px;
  background-color: var(--background-secondary);
  border-radius: 6px;
  cursor: pointer;
  transition: background-color 0.2s ease;
}

.weekly-review-drc-item:hover {
  background-color: var(--background-modifier-hover);
}

/* Review Questions Section */
.weekly-review-questions { /* Restored */
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.weekly-review-question-section { /* Added back if used */
  margin-bottom: 15px;
}

.weekly-review-question { /* For individual question container */
  background-color: var(--background-secondary);
  border-radius: 8px;
  padding: 16px;
}

.weekly-review-question-text { /* For the text of the question */
  font-weight: 500;
  margin-bottom: 12px;
  color: var(--text-normal);
}

/* Goals Section Restored */
.weekly-review-goal-input {
  display: flex;
  gap: 10px;
  margin-bottom: 15px;
}
.weekly-review-goal-input input {
  flex: 1;
  padding: 8px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  background-color: var(--background-primary);
  color: var(--text-normal);
  font-size: 16px;
}
.weekly-review-goals-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.weekly-review-goal-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 12px;
  background-color: var(--background-secondary);
  border-radius: 4px;
}


/* Chart Tooltip */
.weekly-review-chart-tooltip {
  background-color: var(--background-primary) !important;
  border-radius: 10px !important;
  padding: 14px 18px !important;
  border: 1px solid var(--background-modifier-border) !important;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2) !important;
}

.weekly-review-tooltip-setup,
.weekly-review-tooltip-date {
  font-size: 14px !important;
  font-weight: 500 !important;
  color: var(--text-normal) !important;
  margin-bottom: 8px !important;
  text-align: center !important;
}

.weekly-review-tooltip-value {
  font-size: 20px !important;
  font-weight: 600 !important;
  text-align: center !important;
}

.weekly-review-tooltip-value.positive {
  color: var(--chart-positive) !important;
}

.weekly-review-tooltip-value.negative {
  color: var(--chart-negative) !important;
}

.weekly-review-tooltip-info {
  font-size: 12px !important;
  color: var(--text-muted) !important;
  margin-top: 6px !important;
  text-align: center !important;
}

/* Responsive Styles */
@media (max-width: 768px) {
  .weekly-review-metric-cards {
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
  }

  .weekly-review-navigation-links {
    justify-content: center;
    flex-wrap: wrap;
    width: 100%;
  }

  .weekly-review-nav-button {
    flex: 1;
    min-width: 120px;
    justify-content: center;
  }

  .weekly-review-tab {
    padding: 10px 12px;
    font-size: 13px;
  }

  /* Added back */
  .weekly-review-tabs {
    flex-wrap: wrap;
  }
  .weekly-review-tab {
    flex-grow: 1;
    text-align: center;
  }
}

/* Removed duplicate :root block */

/* Fullscreen Image Styles */
.weekly-review-fullscreen-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background-color: rgba(0, 0, 0, 0.85);
  z-index: 4000; /* Reduced from 1000000 to prevent blocking interactions */
  display: flex;
  align-items: center;
  justify-content: center;
  animation: fadeIn 0.3s ease-in-out;
  backdrop-filter: blur(5px);
  -webkit-backdrop-filter: blur(5px);
  cursor: pointer;
}

.weekly-review-fullscreen-content {
  max-width: 90vw;
  max-height: 90vh;
  display: flex;
  flex-direction: column;
  background-color: var(--background-primary);
  border-radius: 8px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
  animation: zoomIn 0.3s ease-in-out;
  overflow: hidden;
  cursor: default;
}

.weekly-review-fullscreen-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 16px;
  background-color: var(--background-secondary);
  border-bottom: 1px solid var(--background-modifier-border);
}

.weekly-review-fullscreen-header h3 {
  margin: 0;
  font-size: 18px;
  font-weight: 600;
  color: var(--text-normal);
}

.weekly-review-fullscreen-close {
  background-color: rgba(229, 57, 53, 0.1);
  color: var(--color-error, #e53935);
  border: none;
  border-radius: 4px;
  padding: 6px 12px;
  font-size: 14px;
  cursor: pointer;
}

.weekly-review-fullscreen-close:hover {
  background-color: rgba(229, 57, 53, 0.2);
}

.weekly-review-fullscreen-image-container {
  overflow: auto;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 16px;
  background-color: var(--background-primary);
  max-height: calc(90vh - 120px);
  /* Add subtle grid background for transparency */
  background-image: linear-gradient(45deg, var(--background-secondary) 25%, transparent 25%, transparent 75%, var(--background-secondary) 75%),
               linear-gradient(45deg, var(--background-secondary) 25%, transparent 25%, transparent 75%, var(--background-secondary) 75%);
  background-size: 20px 20px;
  background-position: 0 0, 10px 10px;
}

.weekly-review-fullscreen-image {
  max-width: 100%;
  max-height: calc(90vh - 120px);
  object-fit: contain;
  border-radius: 4px;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
}

.weekly-review-fullscreen-footer {
  padding: 10px 16px;
  background-color: var(--background-secondary);
  border-top: 1px solid var(--background-modifier-border);
  text-align: center;
}

.weekly-review-fullscreen-footer p {
  margin: 0;
  font-size: 12px;
  color: var(--text-muted);
}

/* Info text for guidance */
.weekly-review-info-text {
  padding: 10px 14px;
  text-align: center;
  color: var(--text-muted);
  font-style: italic;
  background-color: var(--background-primary-alt, var(--background-secondary));
  border-radius: 6px;
  border-left: 3px solid var(--text-accent);
  margin-top: 8px;
  font-size: 14px;
}

/* Add hint that images can be clicked and held */
.weekly-review-forecast-image {
  cursor: zoom-in !important;
  position: relative;
}

.weekly-review-forecast-image::after {
  content: "Click or hold to enlarge";
  position: absolute;
  bottom: 8px;
  right: 8px;
  background-color: rgba(0, 0, 0, 0.6);
  color: white;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 10px;
  opacity: 0;
  transition: opacity 0.2s ease;
}

.weekly-review-forecast-image:hover::after {
  opacity: 1;
}

/* Enhanced PnL values for better visibility */
.weekly-review-best-trade-pnl {
  font-size: 20px !important;
  font-weight: 700 !important;
  padding: 4px 10px !important;
  border-radius: 4px !important;
  display: inline-block !important;
}

.weekly-review-best-trade-pnl[style*="color: var(--color-green)"] {
  background-color: rgba(67, 160, 71, 0.15) !important;
}

.weekly-review-best-trade-pnl[style*="color: var(--color-red)"] {
  background-color: rgba(229, 57, 53, 0.15) !important;
}

/* Animations */
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes zoomIn {
  from { transform: scale(0.9); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}

/* Metadata container positioning fix to prevent jumping */
.metadata-container {
  position: relative !important;
  z-index: 1 !important;
  transform: translateZ(0) !important;
  will-change: auto !important;
}

/* Prevent parent containers from affecting child positioning during re-renders */
.workspace-leaf-content[data-type="journalit-weekly-review"],
.view-content,
.markdown-source-view,
.markdown-preview-view {
  position: relative !important;
  overflow: auto !important;
}

/* Ensure proper stacking context for nested scrollable elements */
.weekly-tabs-content,
.tab-content {
  position: relative !important;
  z-index: 1 !important;
}

/* Prevent layout shift from margin collapsing */
.weekly-review-container::before {
  content: '';
  display: table;
}

/* Fix for when Obsidian adds inline styles during re-render */
.metadata-container[style*="position"] {
  position: relative !important;
}

/* Ensure dropdowns and inputs don't cause layout shifts */
.weekly-review-container select,
.weekly-review-container input,
.weekly-review-container textarea {
  box-sizing: border-box !important;
  max-width: 100% !important;
}

/* Responsive styles for small screens */
@media (max-width: 600px) {
  .weekly-review-container input[role="combobox"],
  .weekly-review-container input,
  .weekly-review-container textarea,
  .weekly-review-textarea,
  .weekly-review-input,
  .weekly-review-goal-input input {
    font-size: 18px !important;
  }
}
`});var rG,nG=L(()=>{rG=`
/* Monthly Review Container */
.monthly-review {
  width: 100%;
  padding: 20px;
  max-width: 1200px;
  margin: 0 auto;
}

.monthly-review-title {
  text-align: center;
  margin-bottom: 20px;
  font-size: 28px;
  font-weight: 600;
}

/* Monthly Review Content */
.monthly-review-content {
  margin-top: 8px;
}

/* Section Styles */
.monthly-review-section {
  margin-bottom: 20px;
  background: var(--background-primary-alt);
  padding: 20px;
  border-radius: 8px;
  border: 1px solid var(--background-modifier-border);
}

.monthly-review-section-title {
  font-size: 20px;
  font-weight: 600;
  margin-bottom: 15px;
  color: var(--text-normal);
  text-align: center;
}

.monthly-review-section-description {
  font-size: 14px;
  color: var(--text-muted);
  margin-bottom: 15px;
}

/* Metric Cards */
.monthly-review-metric-cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 15px;
  margin-top: 15px;
}

.monthly-review-metric-card {
  background: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  padding: 15px;
  text-align: center;
}

.monthly-review-metric-card.highlight-card {
  position: relative;
}

.monthly-review-metric-label {
  font-size: 12px;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 8px;
}

.monthly-review-metric-value {
  font-size: 24px;
  font-weight: 600;
  color: var(--text-normal);
}

.monthly-review-metric-detail {
  font-size: 14px;
  color: var(--text-muted);
  margin-top: 4px;
}

/* Best/Worst Trade Cards */
.monthly-review-best-trade {
  background: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  padding: 20px;
}

.monthly-review-best-trade.best-trade {
  border-left: 3px solid var(--color-green);
}

.monthly-review-best-trade.worst-trade {
  border-left: 3px solid var(--color-red);
}

.monthly-review-best-trade-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
}

.monthly-review-best-trade-title {
  font-size: 16px;
  font-weight: 600;
}

.monthly-review-best-trade-pnl {
  font-size: 20px;
  font-weight: 600;
}

.monthly-review-best-trade-details {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.monthly-review-best-trade-detail {
  display: flex;
  gap: 8px;
  font-size: 14px;
}

.monthly-review-best-trade-label {
  color: var(--text-muted);
  font-weight: 500;
}

.monthly-review-best-trade-value {
  color: var(--text-normal);
}

.monthly-review-best-trade-actions {
  margin-top: 15px;
}

.monthly-review-view-button {
  padding: 6px 12px;
  background: var(--interactive-accent);
  color: var(--text-on-accent);
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
}

.monthly-review-view-button:hover {
  background: var(--interactive-accent-hover);
}

.monthly-review-link-button {
  padding: 4px 8px;
  background: transparent;
  color: var(--text-accent);
  border: 1px solid var(--text-accent);
  border-radius: 4px;
  cursor: pointer;
  font-size: 12px;
  margin-top: 8px;
}

.monthly-review-link-button:hover {
  background: var(--text-accent);
  color: var(--text-on-accent);
}

/* Week Highlights */
.monthly-review-week-highlights {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 15px;
}

/* Weekly Performance Table */
.monthly-review-trades-table {
  width: 100%;
  overflow-x: auto;
}

.monthly-review-trades-table table {
  width: 100%;
  border-collapse: collapse;
}

.monthly-review-trades-table th,
.monthly-review-trades-table td {
  padding: 10px;
  text-align: left;
  border-bottom: 1px solid var(--background-modifier-border);
}

.monthly-review-trades-table th {
  font-weight: 600;
  color: var(--text-muted);
  font-size: 12px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.monthly-review-trade-row {
  cursor: pointer;
  transition: background-color 0.2s;
}

.monthly-review-trade-row:hover {
  background: var(--background-modifier-hover);
}

/* Demon Tracker Styles */
.demon-tracker-container {
  margin-top: 15px;
}

.demon-tracker-table {
  width: 100%;
  border-collapse: collapse;
  background: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  overflow: hidden;
}

.demon-tracker-table th,
.demon-tracker-table td {
  padding: 12px;
  text-align: center;
  border-right: 1px solid var(--background-modifier-border);
}

.demon-tracker-table th:last-child,
.demon-tracker-table td:last-child {
  border-right: none;
}

.demon-tracker-header {
  background: var(--background-secondary);
  font-weight: 600;
  font-size: 14px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  color: var(--text-muted);
}

.demon-tracker-header.stop-trading {
  background: var(--background-modifier-error);
  color: var(--text-error);
}

.demon-tracker-row {
  border-top: 1px solid var(--background-modifier-border);
}

.demon-tracker-row:hover {
  background: var(--background-modifier-hover);
}

/* Make AccountFilter seamlessly blend with tabs - remove top border and gap but keep box appearance */
.monthly-review-content .drc-section:first-child {
  border: 1px solid var(--background-modifier-border);
  border-top: none;
  border-radius: 0 0 6px 6px;
  margin: 0 0 24px 0;
  padding: 16px;
  background-color: var(--background-primary);
}

.demon-name {
  text-align: left;
  font-weight: 500;
  color: var(--text-normal);
}

.demon-occurrence {
  position: relative;
}

.demon-x {
  color: var(--text-error);
  font-weight: 600;
  font-size: 18px;
}

.demon-x.stop {
  color: var(--text-on-accent);
  background: var(--background-modifier-error);
  border-radius: 50%;
  width: 24px;
  height: 24px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

.demon-empty {
  color: var(--text-faint);
  font-size: 14px;
}

/* Demon Tracker Summary */
.demon-tracker-summary {
  margin-top: 20px;
  display: flex;
  gap: 20px;
  flex-wrap: wrap;
}

.demon-summary-item {
  display: flex;
  align-items: center;
  gap: 8px;
}

.demon-summary-label {
  font-size: 14px;
  color: var(--text-muted);
}

.demon-summary-value {
  font-size: 16px;
  font-weight: 600;
  color: var(--text-normal);
}

.demon-summary-item.warning .demon-summary-value {
  color: var(--text-error);
}

/* Monthly Review Header */
.monthly-review-header {
  padding: 16px 20px 12px;
  background-color: var(--background-secondary);
  text-align: center;
  border-bottom: 1px solid var(--background-modifier-border);
}

/* Review Content Placeholder */
.monthly-review-content-placeholder {
  padding: 40px;
  text-align: center;
  color: var(--text-muted);
  background: var(--background-secondary-alt);
  border-radius: 6px;
  border: 1px dashed var(--background-modifier-border);
}

/* Navigation */
.monthly-review-navigation {
  width: 100%;
  padding-top: 10px;
  border-top: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1));
  background-color: var(--background-secondary);
}

.monthly-review-navigation-links {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
  width: 100%;
}

.monthly-review-navigation-button {
  padding: 8px 14px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  background-color: var(--background-primary);
  color: var(--text-normal);
  cursor: pointer;
  font-size: 14px;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  flex: 1;
  text-align: center;
  min-width: 120px;
  box-sizing: border-box;
}

.monthly-review-navigation-button:hover {
  background-color: var(--background-modifier-hover);
  transform: translateY(-1px);
}

.monthly-review-navigation-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* Tab Navigation */
.monthly-review-tabs-container {
  display: flex;
  justify-content: center;
  border-bottom: 1px solid var(--background-modifier-border);
  background-color: var(--background-secondary-alt, #2a2a2a);
  padding: 0;
}

.monthly-review-tabs {
  display: flex;
  justify-content: center;
  background-color: transparent;
  max-width: 600px;
  margin: 0 auto;
}

.monthly-review-tab {
  padding: 12px 24px;
  font-size: 14px;
  font-weight: 600;
  color: var(--text-muted);
  background-color: transparent;
  border: none;
  border-bottom: 2px solid transparent;
  cursor: pointer;
  transition: all 0.2s ease;
  position: relative;
  outline: none;
}

.monthly-review-tab:hover {
  color: var(--text-normal);
  background-color: rgba(127, 127, 127, 0.05);
}

.monthly-review-tab.active {
  color: var(--text-accent);
  border-bottom: 2px solid var(--text-accent);
}

/* Charts */
.monthly-review-overview .recharts-responsive-container {
  margin: 0 auto;
}

/* Overview Tab */
.monthly-review-overview {
  padding-top: 4px;
}

/* Review Tab */
.monthly-review-review {
  padding-top: 4px;
}

/* Reduce spacing for first elements in tab content */
.monthly-review-overview > *:first-child,
.monthly-review-review > *:first-child {
  margin-top: 0 !important;
}

/* Game Performance Tables */
.grade-count {
  text-align: center;
  font-weight: 600;
  padding: 8px;
}

.grade-count.grade-a {
  color: var(--color-green, #43a047);
}

.grade-count.grade-b {
  color: var(--color-orange, #fb8c00);
}

.grade-count.grade-c {
  color: var(--color-red, #e53935);
}

.rating-cell {
  text-align: center;
  font-weight: 600;
}

.notes-cell {
  max-width: 300px;
}

.notes-content {
  white-space: pre-wrap;
  word-break: break-word;
  line-height: 1.4;
  color: var(--text-muted);
  font-size: 13px;
}

.empty-performance-message {
  text-align: center;
  color: var(--text-muted);
  padding: 20px;
  font-style: italic;
}
`});function oG(){Ou||(Ou=document.createElement("style"),Ou.textContent=rG,Ou.id="journalit-monthly-review-styles",document.head.appendChild(Ou))}function Dbe(){Ou&&(Ou.remove(),Ou=null)}function Dv(){Ou||oG()}var Ou,qC=L(()=>{Oo();nG();Ou=null;ce.monthlyReview={inject:oG,remove:Dbe}});function GC(){if(document.head.querySelector("#settings-tab-styles"))return;let e=document.createElement("style");e.id="settings-tab-styles",e.textContent=Ebe,document.head.appendChild(e)}var Ebe,TO=L(()=>{Ebe=`
  /* Settings container layout */
  .journalit-settings {
    display: flex;
    flex-direction: column;
    width: 100%;
    height: 100%;
    overflow: auto;
    padding: 0;
  }

  .journalit-settings-wrapper {
    display: flex;
    flex-direction: column;
    width: 100%;
    height: 100%;
    padding: 16px;
    box-sizing: border-box;
    overflow-y: visible;
  }

  /* Settings tab container */
  .settings-tab-container {
    display: flex;
    flex-direction: column;
    height: 100%;
    width: 100%;
    overflow: visible;
    padding: 16px;
    background: var(--background-primary);
  }

  /* Tab navigation */
  .settings-tab-nav {
    display: flex;
    border-bottom: 1px solid var(--background-modifier-border);
    margin-bottom: 4px;
    justify-content: center;
    width: 100%;
    padding-bottom: 0;
  }

  /* Tab button base styles */
  .settings-tab-button {
    padding: 8px 16px;
    cursor: pointer;
    border-top: none;
    border-right: none;
    border-left: none;
    border-bottom: 2px solid transparent;
    color: var(--text-muted);
    font-weight: 500;
    margin-right: 8px;
    position: relative;
    bottom: -1px;
    background: transparent;
    border-radius: 0;
    font-size: 14px;
    transition: all 0.15s ease;
  }

  /* Active tab button */
  .settings-tab-button--active {
    border-bottom-color: var(--text-accent);
    color: var(--text-normal);
    font-weight: 600;
  }

  /* Settings tab content area */
  .settings-tab-content {
    flex: 1;
    overflow-y: auto;
    padding: 4px 24px 20px;
    background: var(--background-primary);
  }

  /* Fix for Custom Options edit input */
  .journalit-settings.journalit-settings-tab .option-edit-input {
    flex: 1 !important;
    margin-right: 12px !important;
    padding: 6px 10px !important;
    border: 1px solid var(--interactive-accent) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.3) !important;
    position: relative !important;
    z-index: 100 !important;
    min-width: 100px !important;
    pointer-events: auto !important;
    -webkit-user-select: text !important;
    user-select: text !important;
    cursor: text !important;
  }

  /* DRC, Weekly Review, and Custom Options Settings Styles */
  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add,
  .journalit-settings.journalit-settings-tab .custom-options-settings .custom-item-add {
    display: flex !important;
    flex-direction: row !important;
    align-items: center !important;
    width: 100% !important;
    gap: 10px !important;
    margin-bottom: 16px !important;
    position: relative !important;
    padding: 4px 0 !important;
  }

  /* Override any Obsidian styling that might interfere */
  .journalit-settings.journalit-settings-tab .drc-settings input[type="text"],
  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add input,
  .journalit-settings.journalit-settings-tab .weekly-review-settings input[type="text"],
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add input,
  .journalit-settings.journalit-settings-tab .custom-options-settings input[type="text"],
  .journalit-settings.journalit-settings-tab .custom-options-settings .custom-item-add input {
    height: 34px !important;
    line-height: normal !important;
    font-size: 16px !important;
    padding: 6px 10px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    width: 100% !important;
    box-sizing: border-box !important;
    margin: 0 !important;
    appearance: none !important;
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
  }

  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add .input,
  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add input,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add .input,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add input,
  .journalit-settings.journalit-settings-tab .custom-options-settings .custom-item-add .input,
  .journalit-settings.journalit-settings-tab .custom-options-settings .custom-item-add input {
    width: 100% !important;
    height: 34px !important;
    max-height: 34px !important;
    padding: 6px 10px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    font-size: 16px !important;
    box-shadow: none !important;
    transition: border-color 0.15s ease, box-shadow 0.15s ease !important;
    line-height: normal !important;
    min-height: 34px !important;
    display: inline-block !important;
    appearance: none !important;
    overflow: visible !important;
  }

  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add .input:focus,
  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add input:focus,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add .input:focus,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add input:focus {
    border-color: var(--interactive-accent) !important;
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2) !important;
    outline: none !important;
  }

  /* Style Input component's internals */
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .drc-settings .custom-item-add .inputContainer,
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .drc-settings .custom-item-add .inputWrapper,
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .weekly-review-settings .custom-item-add .inputContainer,
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .weekly-review-settings .custom-item-add .inputWrapper {
    margin: 0 !important;
    padding: 0 !important;
    width: 100% !important;
    position: relative !important;
    display: block !important;
    height: 34px !important;
  }

  /* Style Input's invisible parent divs */
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .drc-settings .custom-item-add div,
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .drc-settings .custom-item-add .setting-item-info div,
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .weekly-review-settings .custom-item-add div,
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .weekly-review-settings .custom-item-add .setting-item-info div {
    height: auto !important;
    min-height: 34px !important;
    width: 100% !important;
    position: relative !important;
  }

  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add .inputContainer,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add .inputContainer {
    margin: 0 !important;
    padding: 0 !important;
    width: 100% !important;
    position: relative !important;
    display: block !important;
  }

  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add .setting-item-info,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add .setting-item-info {
    margin-right: 10px !important;
    flex: 1 !important;
    display: flex !important;
    flex-direction: column !important;
    justify-content: center !important;
  }

  /* Styles for the Add button */
  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add .setting-item-control,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add .setting-item-control {
    display: flex !important;
    align-items: center !important;
    justify-content: flex-end !important;
    min-width: auto !important;
    flex-shrink: 0 !important;
  }

  /* Ensure buttons have consistent styling */
  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add button,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add button {
    min-width: 60px !important;
    height: 34px !important;
    max-height: 34px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    font-size: 16px !important;
    font-weight: 500 !important;
    padding: 6px 12px !important;
    border-radius: 4px !important;
    background-color: var(--interactive-accent) !important;
    color: var(--text-on-accent, white) !important;
    border: 1px solid var(--interactive-accent) !important;
    cursor: pointer !important;
    transition: background-color 0.15s ease !important;
  }

  .journalit-settings.journalit-settings-tab .drc-settings button:hover,
  .journalit-settings.journalit-settings-tab .weekly-review-settings button:hover {
    background-color: var(--interactive-accent-hover) !important;
    border-color: var(--interactive-accent-hover) !important;
  }

  /* Direct styling for DRCSettingsTab, WeeklyReviewSettingsTab, and CustomOptionsTab input boxes */
  /* First, add general selector for all input boxes in custom-item-add */
  .journalit-settings .drc-settings .custom-item-add input,
  .journalit-settings .weekly-review-settings .custom-item-add input,
  .journalit-settings .custom-options-settings .custom-item-add input,
  /* Then, add specific selectors for known inputs */
  .journalit-settings input[placeholder="New checklist item"],
  .journalit-settings input[placeholder="New review question"],
  .journalit-settings input[placeholder="New timeframe (e.g., 15M, 5M)"],
  .journalit-settings input[placeholder="New timeframe (e.g., 4H, 1H)"],
  .journalit-settings input[placeholder="New timeframe (e.g., Weekly, Daily)"] {
    height: 34px !important;
    width: 100% !important;
    padding: 6px 10px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    font-size: 16px !important;
    box-shadow: none !important;
    transition: border-color 0.15s ease, box-shadow 0.15s ease !important;
    line-height: normal !important;
    min-height: 34px !important;
    display: inline-block !important;
    appearance: none !important;
    overflow: visible !important;
    margin: 0 !important;
  }

  /* Focus styles for all input boxes */
  .journalit-settings .drc-settings .custom-item-add input:focus,
  .journalit-settings .weekly-review-settings .custom-item-add input:focus,
  .journalit-settings .custom-options-settings .custom-item-add input:focus,
  .journalit-settings input[placeholder="New checklist item"]:focus,
  .journalit-settings input[placeholder="New review question"]:focus,
  .journalit-settings input[placeholder="New timeframe (e.g., 15M, 5M)"]:focus,
  .journalit-settings input[placeholder="New timeframe (e.g., 4H, 1H)"]:focus,
  .journalit-settings input[placeholder="New timeframe (e.g., Weekly, Daily)"]:focus {
    /* These focus styles ensure all input boxes have the same appearance when focused */
    border-color: var(--interactive-accent) !important;
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2) !important;
    outline: none !important;
  }

  /* Accordion Component Styles */
  .cmdr-accordion {
    margin-bottom: 16px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    overflow: visible; /* Changed from hidden to visible */
    transition: box-shadow 0.2s ease;
  }

  .cmdr-accordion:hover {
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
  }

  .cmdr-accordion .cmdr-accordion-header {
    display: flex;
    align-items: center;
    padding: 12px 16px;
    cursor: pointer;
    background-color: var(--background-secondary);
    transition: background-color 0.15s ease;
  }

  .cmdr-accordion .cmdr-accordion-header:hover {
    background-color: var(--background-modifier-hover);
  }

  .cmdr-accordion .cmdr-accordion-chevron > svg {
    transition: transform 0.3s ease-in-out;
  }

  .cmdr-accordion .cmdr-accordion-content {
    max-height: none; /* Removed the fixed max-height */
    transition: max-height 0.3s ease-in-out, padding 0.3s ease-in-out, margin 0.3s ease-in-out;
    overflow: visible; /* Changed from hidden to visible for expanded state */
    background-color: var(--background-primary);
    padding: 16px;
  }

  /* Fix for Weekly Review accordion - Remove borders from inside accordion content to prevent duplicate borders
   * This ensures consistent styling between Daily Review and Weekly Review sections.
   * The issue was that the first setting-item inside the accordion had a border-top which created
   * a duplicate border when the accordion already has its own border.
   */
  .cmdr-accordion .cmdr-accordion-content .timeframe-manager > .setting-item:first-child,
  .cmdr-accordion .cmdr-accordion-content .item-manager > .setting-item:first-child,
  .cmdr-accordion .cmdr-accordion-content > div > .setting-item:first-child,
  .cmdr-accordion .cmdr-accordion-content > .setting-item:first-child {
    border-top: none !important;
  }

  /* Remove border around weekly-review-section to match daily-review-section */
  .cmdr-accordion .cmdr-accordion-content .weekly-review-section {
    border: none !important;
    border-radius: 0 !important;
    padding: 0 !important;
    background-color: transparent !important;
  }

  /* Style for consistent input heights/spacing specifically for the timeframe manager */
  .timeframe-manager .custom-item-add .inputContainer,
  .timeframe-manager .custom-item-add input {
    height: 34px !important;
    min-height: 34px !important;
    margin: 0 !important;
    width: 100% !important;
  }

  /* Collapsed state */
  .cmdr-accordion[aria-expanded="false"] .cmdr-accordion-chevron > svg {
    transform: rotate(-90deg);
  }

  .cmdr-accordion[aria-expanded="false"] .cmdr-accordion-content {
    max-height: 0 !important;
    transition: max-height 0.2s ease-out;
    padding-top: 0;
    padding-bottom: 0;
    margin-top: 0;
    margin-bottom: 0;
    overflow: hidden; /* Keep hidden for collapsed state only */
  }
  
  /* Edit account form container - ensure proper layout */
  .journalit-settings .edit-account-form.setting-item-container,
  .journalit-settings.journalit-settings-tab .edit-account-form.setting-item-container {
    display: flex !important;
    flex-direction: column !important;
    width: 100% !important;
    align-items: stretch !important;
  }

  /* Edit account buttons - updated layout for left-center-right arrangement */
  .journalit-settings .edit-account-form.setting-item-container .edit-account-buttons,
  .journalit-settings.journalit-settings-tab .edit-account-form.setting-item-container .edit-account-buttons {
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    width: 100% !important;
    margin-top: 16px !important;
    position: relative !important;
  }
  
  .journalit-settings .edit-account-form.setting-item-container .edit-account-buttons .button-group-right,
  .journalit-settings.journalit-settings-tab .edit-account-form.setting-item-container .edit-account-buttons .button-group-right {
    display: flex !important;
    gap: 8px !important;
    align-items: center !important;
  }
  
  /* Force accounts to display in a single column */
  .journalit-settings .accounts-list,
  .journalit-settings.journalit-settings-tab .accounts-list {
    display: flex !important;
    flex-direction: column !important;
    flex-wrap: nowrap !important;
    width: 100% !important;
  }

  .journalit-settings .account-items,
  .journalit-settings.journalit-settings-tab .account-items {
    display: flex !important;
    flex-direction: column !important;
    width: 100% !important;
    flex-wrap: nowrap !important;
  }

  .journalit-settings .account-item,
  .journalit-settings.journalit-settings-tab .account-item {
    width: 100% !important;
  }

  /* MT Accounts List Styles */
  .mt-accounts-list {
    margin-top: 10px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 8px;
    overflow: hidden;
  }

  .mt-account-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px;
    border-bottom: 1px solid var(--background-modifier-border);
    background-color: var(--background-primary);
  }

  .mt-account-item:last-child {
    border-bottom: none;
  }

  .mt-account-item:hover {
    background-color: var(--background-secondary);
  }

  .mt-account-info {
    flex: 1;
    min-width: 0;
  }

  .mt-account-id {
    font-weight: 600;
    color: var(--text-normal);
    margin-bottom: 4px;
  }

  .mt-account-broker {
    color: var(--text-muted);
    font-size: 0.9em;
    margin-bottom: 4px;
  }

  .mt-account-dates {
    color: var(--text-muted);
    font-size: 0.85em;
  }

  .mt-account-display {
    margin-left: 20px;
    min-width: 250px;
  }

  .mt-account-name {
    display: flex;
    align-items: center;
  }

  .mt-account-name span {
    font-weight: 500;
    color: var(--text-normal);
  }

  .mt-account-edit {
    display: flex;
    align-items: center;
  }

  .mt-account-edit input {
    background-color: var(--background-primary-alt);
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    padding: 4px 8px;
    color: var(--text-normal);
  }

  .mt-account-edit input:focus {
    border-color: var(--interactive-accent);
    outline: none;
  }

  /* Auto-adjust dropdown width based on content */
  /* High specificity to override existing rules */
  .journalit-settings .setting-item-control,
  .journalit-settings-tab .setting-item-control {
    min-width: 120px !important;
    width: fit-content !important;
    flex-shrink: 0 !important;
  }

  .journalit-settings .setting-item-control select,
  .journalit-settings .setting-item-control .selectContainer,
  .journalit-settings .setting-item-control .select,
  .journalit-settings-tab .setting-item-control select,
  .journalit-settings-tab .setting-item-control .selectContainer,
  .journalit-settings-tab .setting-item-control .select {
    width: auto !important;
    min-width: 120px !important;
    text-align: center !important;
  }

  /* Fix dropdown option background color */
  .journalit-settings select option {
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
  }

  .journalit-settings select option:hover {
    background-color: var(--background-modifier-hover) !important;
  }

  /* Fix for CSS module fallback classes - Input component */
  .journalit-settings .inputContainer {
    display: flex;
    flex-direction: column;
    gap: 4px;
    width: 100%;
  }

  .journalit-settings .input,
  .journalit-settings textarea.input {
    width: 100% !important;
    padding: 8px 12px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    font-size: 14px !important;
    font-family: inherit !important;
    resize: vertical !important;
  }

  .journalit-settings .input:focus,
  .journalit-settings textarea.input:focus {
    border-color: var(--interactive-accent) !important;
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2) !important;
    outline: none !important;
  }

  /* Fix for Button component - uses journalit-button classes */
  .journalit-settings .journalit-button {
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    border-radius: 4px !important;
    font-weight: 500 !important;
    cursor: pointer !important;
    transition: background-color 0.15s ease, border-color 0.15s ease, color 0.15s ease !important;
    gap: 8px !important;
    user-select: none !important;
    outline: none !important;
    min-width: 80px !important;
  }

  /* Button sizes */
  .journalit-settings .journalit-button--small {
    padding: 6px 12px !important;
    font-size: 13px !important;
    height: 32px !important;
  }

  .journalit-settings .journalit-button--medium {
    padding: 8px 16px !important;
    font-size: 14px !important;
    height: 36px !important;
  }

  .journalit-settings .journalit-button--large {
    padding: 12px 24px !important;
    font-size: 16px !important;
    height: 44px !important;
  }

  /* Button variants */
  .journalit-settings .journalit-button--primary {
    background-color: var(--interactive-accent) !important;
    color: var(--text-on-accent, white) !important;
    border: 1px solid var(--interactive-accent) !important;
  }

  .journalit-settings .journalit-button--primary:hover:not(:disabled) {
    background-color: var(--interactive-accent-hover) !important;
    border-color: var(--interactive-accent-hover) !important;
  }

  .journalit-settings .journalit-button--secondary {
    background-color: var(--background-secondary) !important;
    color: var(--text-normal) !important;
    border: 1px solid var(--background-modifier-border) !important;
  }

  .journalit-settings .journalit-button--secondary:hover:not(:disabled) {
    background-color: var(--background-modifier-hover) !important;
  }

  .journalit-settings .journalit-button--danger {
    background-color: var(--background-modifier-error) !important;
    color: var(--text-on-accent, white) !important;
    border: 1px solid var(--background-modifier-error) !important;
  }

  .journalit-settings .journalit-button--danger:hover:not(:disabled) {
    opacity: 0.9 !important;
  }

  .journalit-settings .journalit-button:disabled {
    opacity: 0.5 !important;
    cursor: not-allowed !important;
  }

  /* Responsive styles for small screens */
  @media (max-width: 600px) {
    .journalit-settings.journalit-settings-tab input[type="text"],
    .journalit-settings.journalit-settings-tab .custom-item-add input,
    .journalit-settings input,
    .mt-account-edit input {
      font-size: 18px !important;
    }
  }

  @media (max-width: 768px) {
    .settings-tab-nav {
      flex-wrap: wrap;
      justify-content: flex-start;
      gap: 8px;
    }

    .settings-tab-button {
      margin-right: 0;
    }
  }
`});function Abe(){if(document.head.querySelector("#trade-note-styles"))return;let e=document.createElement("style");e.id="trade-note-styles",e.textContent=Ibe,document.head.appendChild(e)}function um(){Abe()}var Ibe,aG=L(()=>{Ibe=`
  /**
   * Main container styles
   * These ensure proper containment and isolation of the TradeNote component
   */

  /* Main container */
  .journalit-trade-view,
  .trade-form-view-container .journalit-trade-view {
    margin-top: 0;
    margin-bottom: 0;
    border-bottom: none;
    padding: 0;
    display: block !important;
    width: 100% !important;
    z-index: 1;
    /* Ensure proper containment */
    position: relative;
    box-sizing: border-box;
    /* Prevent overlaps */
    contain: content;
    /* Ensure proper isolation from other views */
    isolation: isolate;
  }
  
  /* Trade note React root wrapper */
  .journalit-trade-note-wrapper {
    width: 100%;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    contain: content;
    /* Keep React root fully contained */
    isolation: isolate;
    /* Create a new stacking context */
    position: relative;
    /* Ensure clean slate for each instance */
    box-sizing: border-box;
  }
  
  .trade-note-container {
    background-color: var(--background-primary);
    border-radius: var(--border-radius-lg, 8px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    margin: 0;
    overflow: hidden;
    position: relative;
    font-family: var(--font-interface);
    /* Border removed per UI update request */
    /* Ensure isolation */
    isolation: isolate;
    /* Create a new stacking context and force containment */
    contain: layout style paint;
    /* Ensure direct containment within parent */
    width: 100%;
    align-self: flex-start;
    /* Add a subtle distinguishing feature for easier debugging */
    transition: box-shadow 0.2s ease-in-out;
  }
  
  /* Header section with instrument and P&L */
  .trade-note-header {
    padding: 0.8rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    background: linear-gradient(to right, var(--background-secondary), var(--background-primary));
  }
  
  .trade-note-header.profit {
    background: linear-gradient(to right, rgba(102, 187, 106, 0.1), var(--background-primary));
    border-left: 4px solid var(--color-success, #43a047);
  }

  .trade-note-header.loss {
    background: linear-gradient(to right, rgba(229, 57, 53, 0.1), var(--background-primary));
    border-left: 4px solid var(--color-error, #e53935);
  }

  .trade-note-header.open {
    background: linear-gradient(to right, rgba(33, 150, 243, 0.1), var(--background-primary));
    border-left: 4px solid var(--status-open-color);
  }
  
  .trade-instrument {
    font-size: 1.4rem;
    font-weight: 600;
    color: var(--text-normal);
    display: flex;
    align-items: center;
  }
  
  .trade-direction-icon {
    margin-right: 0.5rem;
    font-size: 1.3rem;
    line-height: 1;
  }
  
  /* Header actions container with edit button and PnL */
  .trade-header-actions {
    display: flex;
    align-items: center;
    gap: 1rem;
  }
  
  /* Edit button styling */
  .trade-edit-button {
    display: flex;
    align-items: center;
    gap: 0.3rem;
    background-color: var(--interactive-accent);
    color: var(--text-on-accent, white);
    border: none;
    border-radius: 4px;
    padding: 0.4rem 0.8rem;
    font-size: 0.8rem;
    font-weight: 500;
    cursor: pointer;
    transition: background-color 0.2s;
  }
  
  .trade-edit-button:hover {
    background-color: var(--interactive-accent-hover, var(--interactive-accent));
    opacity: 0.9;
  }
  
  .trade-edit-button svg {
    width: 14px;
    height: 14px;
  }

  .trade-pnl {
    font-size: 1.2rem;
    font-weight: 600;
  }
  
  .profit-text {
    color: var(--color-success, #43a047);
  }
  
  .loss-text {
    color: var(--color-error, #e53935);
  }
  
  .open-text {
    color: var(--status-open-color);
    font-weight: 600;
  }
  
  /* Missed trade badge styling */
  .missed-trade-badge {
    background-color: var(--color-orange, #ff9800);
    color: var(--text-on-accent, white);
    padding: 0.2rem 0.6rem;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 700;
    margin-left: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
  }
  
  /* Open trade badge styling */
  .open-trade-badge {
    background-color: var(--status-open-color);
    color: var(--text-on-accent, white);
    padding: 0.2rem 0.6rem;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 700;
    margin-left: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
  }
  
  /* Backtest trade badge styling */
  .backtest-trade-badge {
    background-color: var(--color-purple, #6f42c1);
    color: var(--text-on-accent, white);
    padding: 0.2rem 0.6rem;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 700;
    margin-left: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
  }
  
  /* Removed tabs navigation - single page layout */
  
  /* Single page content container */
  .trade-note-content {
    padding: 0;
    display: flex;
    flex-direction: column;
    gap: 0.5rem; /* Reduced gap to minimize wasted space between sections */
  }
  
  /* Trade overview section with metrics */
  .trade-overview-section {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    padding: 0;
    position: relative;
    margin-bottom: 0;
  }

  /* Metrics grid - single row */
  .trade-metrics-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 0.8rem;
    margin-bottom: 0;
  }
  
  .metric-card {
    background-color: var(--background-primary);
    padding: 0.7rem;
    border-radius: var(--border-radius-md, 4px);
    border: 1px solid var(--background-modifier-border);
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    transition: transform 0.2s, box-shadow 0.2s, border-color 0.2s;
  }
  
  .metric-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 3px 6px rgba(0, 0, 0, 0.08);
    border-color: var(--interactive-accent-hover);
  }
  
  .metric-label {
    font-size: 0.75rem;
    color: var(--text-muted);
    text-transform: uppercase;
    margin-bottom: 0.2rem;
    letter-spacing: 0.5px;
  }
  
  .metric-value {
    font-size: 1.2rem;
    font-weight: 600;
    color: var(--text-normal);
    margin-bottom: 0.2rem;
  }
  
  .metric-subtitle {
    font-size: 0.7rem;
    color: var(--text-muted);
  }

  /* Metadata container for accounts and tags - no background */
  .trade-metadata-container {
    display: flex;
    flex-wrap: wrap;
    gap: 0.8rem;
    padding: 0.2rem 0;
  }

  .metadata-section {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .metadata-label {
    font-size: 0.8rem;
    font-weight: 600;
    color: var(--text-muted);
    white-space: nowrap;
  }

  .metadata-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.3rem;
  }
  
  /* Tags styling for setups and mistakes */
  .trade-tags-container {
    margin: 0;
  }
  
  .tags-row {
    display: flex;
    gap: 1rem;
    width: 100%;
  }
  
  .tags-section {
    flex: 1;
    margin-bottom: 0;
    background-color: var(--background-primary);
    border-radius: var(--border-radius-md, 4px);
    padding: 0.7rem;
    border: 1px solid var(--background-modifier-border);
  }
  
  .tags-section h4 {
    font-size: 0.85rem;
    margin-top: 0;
    margin-bottom: 0.5rem;
    color: var(--text-normal);
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 0.3rem;
  }

  /* Only keep icons for setup and mistake headers */
  .setup-section h4::before {
    content: '\u2713'; /* Checkmark symbol */
    color: var(--color-secondary, var(--text-accent));
    font-weight: bold;
  }

  .mistake-section h4::before {
    content: '\u26A0'; /* Warning symbol */
    color: var(--color-error, #e53935);
    font-weight: bold;
  }
  
  .tags-list {
    display: flex;
    flex-wrap: wrap;
    gap: 0.4rem;
  }
  
  .tag {
    padding: 0.35rem 0.7rem;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 500;
    display: inline-flex;
    align-items: center;
    transition: transform 0.15s ease;
    color: var(--text-normal);
  }

  .tag:hover {
    transform: translateY(-1px);
  }
  
  .setup-tag {
    background-color: rgba(66, 133, 244, 0.15);
    color: rgba(66, 133, 244, 1);
    border: 1px solid rgba(66, 133, 244, 0.3);
  }
  
  .mistake-tag {
    background-color: rgba(229, 57, 53, 0.15);
    color: var(--color-error, #e53935);
    border: 1px solid rgba(229, 57, 53, 0.3);
  }

  .account-tag {
    padding: 0.35rem 0.7rem;
    color: var(--text-accent);
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 500;
    display: inline-flex;
    align-items: center;
    cursor: pointer;
    transition: transform 0.15s ease, color 0.15s ease;
    text-decoration: underline;
    text-decoration-style: dotted;
    text-underline-offset: 3px;
  }
  
  .account-tag:hover {
    transform: translateY(-1px);
    color: var(--text-accent-hover, var(--text-accent));
  }
  
  /* Notes preview */
  .trade-notes-preview {
    background-color: var(--background-secondary);
    padding: 1rem;
    border-radius: var(--border-radius-md, 4px);
    margin-top: 1.5rem;
  }
  
  .trade-notes-preview h4 {
    font-size: 0.9rem;
    margin-bottom: 0.8rem;
    color: var(--text-normal);
  }
  
  .trade-notes-preview p {
    color: var(--text-normal);
    font-size: 0.9rem;
    line-height: 1.6;
    margin: 0;
  }
  
  /* Trade details footer - modernized layout */
  .trade-details-footer {
    margin-top: 0;
  }
  
  .details-card {
    background-color: var(--background-primary);
    padding: 1rem;
    border-radius: var(--border-radius-md, 6px);
    box-shadow: 0 1px 5px rgba(0, 0, 0, 0.05);
    border: 1px solid var(--background-modifier-border);
    margin-bottom: 0;
    transition: box-shadow 0.2s ease;
  }

  .details-card:hover {
    box-shadow: 0 3px 8px rgba(0, 0, 0, 0.08);
  }
  
  .details-card.expanded-details {
    width: 100%;
  }

  .details-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.8rem;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--background-modifier-border);
  }
  
  .details-card h4 {
    font-size: 1rem;
    margin: 0;
    color: var(--text-normal);
  }
  
  /* Main content area */
  .trade-main-content {
    display: flex;
    flex-direction: column;
    gap: 0;
  }

  /* Enhanced thesis section styling - no emoji */
  .thesis-section {
    background-color: var(--background-primary);
    padding: 1rem 1.2rem;
    border-radius: var(--border-radius-md, 6px);
    box-shadow: 0 1px 5px rgba(0, 0, 0, 0.05);
    border: 1px solid var(--background-modifier-border);
    margin: 0;
    position: relative;
  }
  
  
  .thesis-section h4 {
    font-size: 1rem;
    margin-top: 0;
    margin-bottom: 1rem;
    color: var(--text-normal);
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--background-modifier-border);
    position: relative;
  }
  
  .thesis-content {
    font-size: 0.95rem;
    line-height: 1.7;
    color: var(--text-normal);
    white-space: pre-wrap;
    padding: 0 0.2rem;
  }
  
  .details-card h4 {
    font-size: 0.9rem;
    margin-top: 0;
    margin-bottom: 0.8rem;
    color: var(--text-normal);
    /* Remove the border-bottom as requested */
    padding-bottom: 0;
  }
  
  .details-table {
    width: 100%;
    border-collapse: collapse;
    table-layout: fixed;
  }
  
  .details-table td {
    padding: 0.6rem 0.5rem;
    font-size: 0.9rem;
    text-overflow: ellipsis;
    overflow: hidden;
    border-bottom: none;
  }
  
  /* Only add borders between content groups */
  .details-table tr:nth-child(2) td {
    border-bottom: 1px solid var(--background-modifier-border-hover, rgba(0, 0, 0, 0.04));
    padding-bottom: 0.8rem;
  }
  
  .details-table tr:nth-child(3) td {
    padding-top: 0.8rem;
  }
  
  .details-table tr:nth-child(4) td {
    border-bottom: 1px solid var(--background-modifier-border-hover, rgba(0, 0, 0, 0.04));
    padding-bottom: 0.8rem;
  }
  
  .details-table tr:nth-child(5) td {
    padding-top: 0.8rem;
  }
  
  .details-table td:nth-child(odd) {
    color: var(--text-muted);
    width: 20%;
    font-weight: 500;
  }
  
  .details-table td:nth-child(even) {
    color: var(--text-normal);
    font-weight: 500;
    width: 30%;
  }
  
  .details-list {
    list-style-type: none;
    padding: 0;
    margin: 0;
  }
  
  .details-list li {
    padding: 0.4rem 0;
    font-size: 0.9rem;
    color: var(--text-normal);
    border-bottom: 1px solid var(--background-modifier-border-hover, var(--background-modifier-border));
  }
  
  /* Accounts list styling */
  .accounts-list {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    padding: 0.2rem 0;
  }
  
  /* Account tags styled as clickable bubbles */
  .account-tag {
    padding: 0.4rem 0.8rem;
    background-color: var(--background-secondary-alt, var(--background-secondary));
    color: var(--text-normal);
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 500;
    display: inline-block;
    cursor: pointer; /* Show pointer to indicate clickability */
    transition: background-color 0.2s;
  }
  
  .account-tag:hover {
    background-color: var(--background-modifier-hover);
  }
  
  .notes-content {
    font-size: 0.9rem;
    line-height: 1.6;
    color: var(--text-normal);
    white-space: pre-wrap;
  }
  
  /* Trade images styling */
  .trade-images-section {
    display: flex;
    flex-direction: column;
    align-items: center;
    background-color: var(--background-secondary);
    border-radius: var(--border-radius-md, 4px);
    padding: 0.6rem 0; /* Reduce horizontal padding */
    margin: 0; /* Remove margin to use container gap */
    width: 100%; /* Ensure full width */
  }
  
  /* Special styling for container with only one image - eliminate all padding */
  .trade-images-section[data-image-count="1"] {
    padding: 0; /* Remove all padding when there's only one image */
    margin: 0;
  }
  
  /* Ensure proper sizing of the ImageCarousel within the TradeNote */
  .trade-images-section .journalit-image-carousel {
    margin-bottom: 0;
    background-color: transparent;
    box-shadow: none;
    padding: 0;
  }
  
  /* Special handling for single image scenarios - remove any extra spacing */
  .trade-images-section .journalit-image-carousel[data-single-image="true"],
  .trade-images-section[data-image-count="1"] .journalit-image-carousel {
    padding: 0;
    margin: 0;
  }
  
  /* Remove all padding/margin from image container if it's a single image */
  .trade-images-section .journalit-image-carousel[data-single-image="true"] .image-container,
  .trade-images-section[data-image-count="1"] .image-container,
  .trade-images-section[data-image-count="1"] .journalit-carousel-image-container {
    margin: 0;
    padding: 0;
  }
  
  /* More aggressive fixes for single image mode - eliminate all possible gaps */
  .trade-images-section[data-image-count="1"] * {
    margin-top: 0;
    margin-bottom: 0;
  }
  
  /* Target our specific single-image-carousel class */
  .single-image-carousel,
  .single-image-carousel .journalit-carousel-main,
  .single-image-carousel .journalit-carousel-image-container {
    padding: 0 !important;
    margin: 0 !important;
  }
  
  /* Force the single image to directly touch the metrics below */
  .trade-images-section[data-image-count="1"] + .trade-metrics-grid {
    margin-top: 0;
  }
  
  /* Empty state styling */
  .trade-empty-images {
    display: flex;
    flex-direction: column;
    align-items: center;
    background-color: var(--background-secondary);
    border-radius: var(--border-radius-md, 4px);
    padding: 0.8rem 0; /* Reduce horizontal padding */
    margin: 0; /* Remove margin to use container gap */
    width: 100%; /* Ensure full width */
  }
  
  .image-carousel {
    position: relative;
    width: 100%;
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  /* Remove all margins for single image carousels */
  .trade-images-section[data-image-count="1"] .image-carousel,
  .trade-images-section[data-image-count="1"] .journalit-carousel-main {
    margin: 0;
    padding: 0;
  }
  
  .image-container {
    width: 100%;
    max-height: 400px;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    background-color: var(--background-secondary-alt, var(--background-secondary));
    border-radius: var(--border-radius-md, 4px);
  }
  
  .image-container img {
    max-width: 100%;
    max-height: 400px;
    object-fit: contain;
  }
  
  .carousel-button {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: var(--background-secondary);
    color: var(--text-normal);
    border: 1px solid var(--background-modifier-border);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    opacity: 0.7;
    transition: opacity 0.2s, background-color 0.2s;
    z-index: 10;
  }
  
  .carousel-button:hover {
    opacity: 1;
    background-color: var(--background-primary);
  }
  
  .carousel-button.prev {
    left: 10px;
  }
  
  .carousel-button.next {
    right: 10px;
  }
  
  .image-counter {
    font-size: 0.8rem;
    color: var(--text-muted);
    margin-bottom: 0.3rem;
  }
  
  /* Hide image counter completely when there's only one image */
  .trade-images-section[data-image-count="1"] .image-counter {
    display: none;
  }
  
  .image-thumbnails {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
    justify-content: center;
    max-width: 100%;
    margin-top: 0.3rem;
  }
  
  .thumbnail {
    width: 60px;
    height: 60px;
    border-radius: var(--border-radius-sm, 2px);
    overflow: hidden;
    cursor: pointer;
    opacity: 0.7;
    transition: opacity 0.2s;
    border: 2px solid transparent;
  }
  
  .thumbnail:hover {
    opacity: 1;
  }
  
  .thumbnail.active {
    opacity: 1;
    border-color: var (--color-primary, var(--interactive-accent));
  }
  
  .thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  
  /* Responsive adjustments */
  @media (max-width: 900px) {
    .trade-metrics-grid {
      grid-template-columns: repeat(2, 1fr);
    }
    
    .details-table {
      table-layout: auto;
    }

    .details-table td:nth-child(odd) {
      width: auto;
      min-width: 100px;
    }

    .details-table td:nth-child(even) {
      width: auto;
    }
  }

  @media (max-width: 768px) {
    .trade-note-content {
      padding: 0;
      gap: 0.6rem;
    }
    
    .tags-row {
      flex-direction: column;
      gap: 0.8rem;
    }

    .details-table {
      display: block;
      overflow-x: auto;
    }
    
    .details-table td {
      padding: 0.5rem 0.3rem;
      word-break: break-word;
    }

    .thesis-section {
      padding: 0.8rem;
    }

    .thesis-section h4 {
      font-size: 0.9rem;
      margin-bottom: 0.7rem;
    }

    .thesis-content {
      font-size: 0.85rem;
      line-height: 1.5;
    }
  }

  @media (max-width: 480px) {
    .trade-metrics-grid {
      grid-template-columns: 1fr;
      gap: 0.5rem;
    }

    .metadata-section {
      flex-direction: column;
      align-items: flex-start;
    }

    .setup-section h4::before,
    .mistake-section h4::before {
      display: none; /* Hide emojis on very small screens */
    }
  }
  
  /* Trade Navigation Styles */
  .trade-navigation-container {
    display: flex;
    flex-direction: column;
    padding: 0.2rem 0.8rem 0.6rem 0.8rem; /* Reduced padding to match DRC tightness */
    background-color: var(--background-secondary);
    border-bottom: 1px solid var(--background-modifier-border);
  }
  
  /* Container for navigation and edit button */
  .trade-navigation-with-edit {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    margin-bottom: 0.8rem;
  }
  
  /* Container for edit button to help with alignment */
  .edit-button-container {
    display: flex;
    align-items: center;
    height: auto;
    padding-top: 0;
  }
  
  /* Timeline styles */
  .trade-timeline-container {
    display: flex;
    flex-direction: column;
    gap: 0.6rem;
    margin-bottom: 0.3rem; /* Reduced bottom margin */
  }
  
  .trade-timeline {
    display: flex;
    align-items: center;
  }
  
  .timeline-label {
    font-size: 0.85rem;
    font-weight: 500;
    color: var(--text-normal);
    margin-right: 0.8rem;
    white-space: nowrap;
    min-width: 70px;
  }
  
  .timeline-label.active-ticker {
    font-weight: 600;
    color: var(--interactive-accent);
  }
  
  .timeline-items {
    display: flex;
    flex-wrap: wrap;
    gap: 0.4rem;
  }
  
  .timeline-item {
    padding: 0.3rem 0.6rem;
    background-color: var(--background-primary);
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    font-size: 0.8rem;
    font-weight: 500;
    color: var(--text-muted);
    cursor: pointer;
    transition: all 0.2s ease;
  }
  
  .timeline-item:hover {
    background-color: var(--background-modifier-hover);
    color: var(--text-normal);
  }
  
  /* PnL color coding */
  .timeline-item.profit {
    background-color: rgba(102, 187, 106, 0.15);
    color: var(--color-success, #43a047);
    border-color: rgba(102, 187, 106, 0.3);
  }
  
  .timeline-item.loss {
    background-color: rgba(229, 57, 53, 0.15);
    color: var(--color-error, #e53935);
    border-color: rgba(229, 57, 53, 0.3);
  }
  
  .timeline-item.open {
    background-color: rgba(33, 150, 243, 0.15);
    color: var(--color-info, #2196f3);
    border-color: rgba(33, 150, 243, 0.3);
  }
  
  .timeline-item.profit:hover {
    background-color: rgba(102, 187, 106, 0.25);
  }
  
  .timeline-item.loss:hover {
    background-color: rgba(229, 57, 53, 0.25);
  }
  
  .timeline-item.open:hover {
    background-color: rgba(33, 150, 243, 0.25);
  }
  
  /* Backtest trade timeline items */
  .timeline-item.backtest-trade {
    background-color: rgba(138, 43, 226, 0.15);
    color: var(--color-purple, #8a2be2);
    border-color: rgba(138, 43, 226, 0.3);
    font-weight: 500;
  }

  .timeline-item.backtest-trade:hover {
    background-color: rgba(138, 43, 226, 0.25);
    transform: translateY(-1px);
  }

  .timeline-item.backtest-trade.active {
    border: 2px solid var(--color-purple, #8a2be2);
    background-color: rgba(138, 43, 226, 0.2);
    font-weight: 600;
  }
  
  /* Active state now uses a prominent border instead of background */
  .timeline-item.active {
    border: 2px solid var(--interactive-accent);
    font-weight: 600;
  }
  
  .timeline-item.active.profit {
    border-color: var(--interactive-accent);
  }
  
  .timeline-item.active.loss {
    border-color: var(--interactive-accent);
  }
  
  /* Navigation buttons for reviews */
  .trade-review-navigation {
    flex: 1;
    border-bottom: 1px solid var(--background-modifier-border);
    padding-bottom: 0.8rem;
    margin-bottom: 0;
    margin-right: 0.8rem;
  }
  
  /* Edit button in navigation */
  .trade-nav-edit-button {
    width: auto;
    min-width: 36px;
    border-radius: 4px;
    border: 1px solid var(--interactive-accent);
    background-color: var(--interactive-accent);
    color: var(--text-on-accent, white);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: background-color 0.2s, transform 0.2s;
    padding: 6px 8px; /* Reduced vertical padding from 8px to 6px */
    margin: 0;
    box-sizing: border-box;
    font-size: 14px; /* Match the font size of navigation buttons */
    line-height: 1.15; /* Control the line height for better alignment */
  }
  
  .trade-nav-edit-button:hover {
    background-color: var(--interactive-accent-hover, var(--interactive-accent));
    opacity: 0.9;
    transform: translateY(-1px);
  }
  
  .trade-nav-edit-button svg {
    width: 14px;
    height: 14px;
  }
  
  .trade-review-navigation-links {
    display: flex;
    justify-content: space-between;
    gap: 0.5rem;
    flex-wrap: wrap;
  }
  
  .trade-review-navigation-button {
    flex: 1;
    min-width: 120px;
    text-align: center;
    padding: 0.5rem;
    font-size: 0.8rem;
  }
  
  /* Multiple view compatibility - these styles ensure proper display in various Obsidian layouts */
  .workspace-split.mod-vertical .journalit-trade-view {
    /* Adjust for vertical split layout */
    max-width: 100%;
    flex-shrink: 1;
  }
  
  /* Ensure the component doesn't get squished in narrow panes */
  .workspace-leaf-content .journalit-trade-view .trade-metrics-grid {
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  }
  
  /* Make sure tab/content navigation is still usable in narrow panes */
  .workspace-leaf-content .journalit-trade-view .trade-note-tabs {
    flex-wrap: wrap;
  }
  
  /* Prevent clipping of component in small panes */
  .workspace-leaf-content .journalit-trade-view .trade-note-container {
    min-width: 0;
  }
  
  /* Responsive styles for navigation */
  @media (max-width: 576px) {
    .trade-timeline {
      flex-direction: column;
      align-items: flex-start;
      margin-bottom: 0.6rem;
    }
    
    .timeline-label {
      margin-bottom: 0.4rem;
      margin-right: 0;
      font-weight: 600;
    }
    
    .trade-timeline-container {
      gap: 1rem;
    }
    
    /* Adjust navigation with edit button layout */
    .trade-navigation-with-edit {
      align-items: center;
    }
    
    .edit-button-container {
      padding-top: 0;
    }
    
    .trade-nav-edit-button {
      padding: 5px 6px; /* Further reduced vertical padding for mobile */
      min-width: 32px;
    }
    
    .trade-nav-edit-button svg {
      width: 16px;
      height: 16px;
    }
  }

  /* Loss Review Styles */
  
  /* Loss Review Container */
  .loss-review-container {
    margin-top: 2rem;
    border-top: 1px solid var(--background-modifier-border);
    padding-top: 1.5rem;
  }

  .loss-review-accordion {
    background: var(--background-secondary);
    border-radius: 8px;
    overflow: hidden;
  }

  /* Loss Review Sections */
  .loss-review-sections {
    padding: 1.5rem;
  }

  .loss-review-section {
    margin-bottom: 1.5rem;
  }

  .loss-review-section:last-child {
    margin-bottom: 0;
  }

  /* Headers */
  .loss-review-header h3 {
    margin: 0 0 0.5rem 0;
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--text-normal);
  }

  .loss-review-content {
    color: var(--text-muted);
    line-height: 1.6;
    margin-bottom: 1rem;
  }

  .loss-review-content p {
    margin: 0.5rem 0;
  }

  /* Checkboxes */
  .loss-review-checkbox,
  .loss-review-checkbox-list {
    margin: 0.5rem 0;
  }

  .loss-review-checkbox-list h3 {
    margin: 0 0 0.75rem 0;
    font-size: 1rem;
    font-weight: 600;
  }

  .checkbox-items {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .checkbox-label {
    display: flex;
    align-items: flex-start;
    gap: 0.5rem;
    cursor: pointer;
    user-select: none;
  }

  .checkbox-label input[type="checkbox"] {
    margin-top: 0.25rem;
    cursor: pointer;
    flex-shrink: 0;
  }

  .checkbox-label span {
    flex: 1;
    line-height: 1.5;
  }

  .checkbox-label span strong {
    color: var(--text-normal);
  }

  /* Text Areas */
  .loss-review-textarea h3 {
    margin: 0 0 0.75rem 0;
    font-size: 1rem;
    font-weight: 600;
  }

  .loss-review-textarea-input {
    width: 100%;
    min-height: 100px;
    padding: 0.75rem;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background: var(--background-primary);
    color: var(--text-normal);
    font-family: inherit;
    font-size: 16px;
    line-height: 1.5;
    resize: vertical;
    transition: border-color 0.15s ease;
  }

  .loss-review-textarea-input:focus {
    outline: none;
    border-color: var(--interactive-accent);
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2);
  }

  .loss-review-textarea-input::placeholder {
    color: var(--text-muted);
    opacity: 0.7;
  }

  /* Footer */
  .loss-review-footer {
    margin-top: 2rem;
    padding-top: 1.5rem;
    border-top: 1px solid var(--background-modifier-border);
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .reviewed-timestamp {
    font-size: 0.85rem;
    color: var(--text-muted);
  }

  /* Responsive */
  @media (max-width: 768px) {
    .loss-review-sections {
      padding: 1rem;
    }
    
    .loss-review-footer {
      flex-direction: column;
      gap: 1rem;
      align-items: flex-start;
    }
  }

  /* Dark theme adjustments */
  .theme-dark .loss-review-textarea-input {
    background: var(--background-secondary-alt);
  }

  .theme-dark .loss-review-accordion {
    background: var(--background-secondary-alt);
  }

  /* Accordion styles for Loss Review */
  .loss-review-container .cmdr-accordion {
    margin-bottom: 16px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    overflow: hidden;
    transition: box-shadow 0.2s ease;
  }

  .loss-review-container .cmdr-accordion:hover {
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
  }

  .loss-review-container .cmdr-accordion .cmdr-accordion-header {
    display: flex;
    align-items: center;
    padding: 12px 16px;
    cursor: pointer;
    background-color: var(--background-secondary);
    transition: background-color 0.15s ease;
  }

  .loss-review-container .cmdr-accordion .cmdr-accordion-header:hover {
    background-color: var(--background-modifier-hover);
  }

  .loss-review-container .cmdr-accordion .cmdr-accordion-chevron > svg {
    transition: transform 0.3s ease-in-out;
  }

  .loss-review-container .cmdr-accordion .cmdr-accordion-content {
    max-height: 5000px;
    transition: max-height 0.3s ease-in-out, padding 0.3s ease-in-out, margin 0.3s ease-in-out;
    overflow: hidden;
    background-color: var(--background-primary);
    padding: 16px;
  }

  /* Collapsed state */
  .loss-review-container .cmdr-accordion[aria-expanded="false"] .cmdr-accordion-chevron > svg {
    transform: rotate(-90deg);
  }

  .loss-review-container .cmdr-accordion[aria-expanded="false"] .cmdr-accordion-content {
    max-height: 0 !important;
    transition: max-height 0.2s ease-out;
    padding-top: 0;
    padding-bottom: 0;
    margin-top: 0;
    margin-bottom: 0;
    overflow: hidden;
  }

  /* Responsive styles for small screens */
  @media (max-width: 600px) {
    .loss-review-textarea-input {
      font-size: 18px !important;
    }
  }

  /* Light theme overrides for open trades */
  .theme-light .trade-note-header.open {
    background: linear-gradient(to right, rgba(33, 150, 243, 0.2), var(--background-primary));
  }

  .theme-light .trade-note-header.profit {
    background: linear-gradient(to right, rgba(var(--color-green-rgb), 0.2), var(--background-primary));
  }

  .theme-light .trade-note-header.loss {
    background: linear-gradient(to right, rgba(var(--color-red-rgb), 0.2), var(--background-primary));
  }

  .theme-light .open-trade-badge {
    background-color: rgba(33, 150, 243, 0.15);
    color: #1976d2;
    border: 1px solid rgba(33, 150, 243, 0.3);
  }
`});function Nbe(){if(document.head.querySelector("#missed-trade-note-styles"))return;let e=document.createElement("style");e.id="missed-trade-note-styles",e.textContent=Lbe,document.head.appendChild(e)}function Ev(){Nbe()}var Lbe,iG=L(()=>{Lbe=`
  /**
   * Missed Trade Note Container styles
   */

  /* Main container for missed trade notes */
  .journalit-missed-trade-view,
  .missed-trade-form-view-container .journalit-missed-trade-view {
    margin: 0;
    border-bottom: none;
    padding: 0;
    display: block !important;
    width: 100% !important;
    z-index: 1;
    position: relative;
    box-sizing: border-box;
    contain: content;
    isolation: isolate;
  }
  
  /* Missed trade React root wrapper */
  .journalit-missed-trade-note-wrapper {
    width: 100%;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    contain: content;
    isolation: isolate;
    position: relative;
    box-sizing: border-box;
  }
  
  .missed-trade-note-container {
    background-color: var(--background-primary);
    border-radius: var(--border-radius-lg, 8px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    margin: 0;
    overflow: hidden;
    position: relative;
    font-family: var(--font-interface);
    isolation: isolate;
    contain: layout style paint;
    width: 100%;
    align-self: flex-start;
    transition: box-shadow 0.2s ease-in-out;
  }

  /**
   * MISSED Badge Styling for TradeHeader
   */
  
  /* Style the MISSED badge */
  .trade-header-actions .missed-trade-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    background-color: var(--color-orange, #ff9500);
    color: white;
    font-size: 0.75rem;
    font-weight: 600;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    box-shadow: 0 2px 4px rgba(255, 149, 0, 0.3);
    margin-right: 0.75rem;
  }

  /* Missed trade header styling - removed orange styling per user request */

  /**
   * Missed Trade Reason Section
   */
  
  .missed-trade-reason-section {
    margin-top: 1rem;
  }

  .missed-trade-reason-section .details-card {
    background-color: var(--background-secondary);
    border-left: 4px solid var(--color-orange, #ff9500);
  }

  .missed-trade-reason-section h4 {
    color: var(--color-orange, #ff9500);
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .missed-trade-reason-section h4::before {
    content: '\u274C';
    font-size: 1rem;
  }

  .missed-trade-reason-content {
    font-size: 0.95rem;
    line-height: 1.6;
    color: var(--text-normal);
    white-space: pre-wrap;
    padding: 0.5rem 0;
    background-color: var(--background-secondary-alt, var(--background-secondary));
    border-radius: 4px;
    padding: 0.75rem;
    margin-top: 0.5rem;
  }

  /**
   * Missed Trade Timeline Styling
   */

  /* Missed trades timeline section */
  .missed-trades-timeline-section {
    margin-top: 1rem;
    padding-top: 0.75rem;
    border-top: 1px solid var(--background-modifier-border);
  }

  .missed-trades-label {
    color: var(--color-orange, #ff9500);
    font-weight: 600;
    margin-bottom: 0.5rem;
  }

  /* Missed trade timeline items */
  .timeline-item.missed-trade {
    background-color: rgba(255, 149, 0, 0.15);
    color: var(--color-orange, #ff9500);
    border-color: rgba(255, 149, 0, 0.3);
    font-weight: 500;
  }

  .timeline-item.missed-trade:hover {
    background-color: rgba(255, 149, 0, 0.25);
    transform: translateY(-1px);
  }

  .timeline-item.missed-trade.active {
    border: 2px solid var(--color-orange, #ff9500);
    background-color: rgba(255, 149, 0, 0.2);
    font-weight: 600;
  }


  /**
   * Missed Trade Content Styling
   */
  
  .missed-trade-note-content {
    padding: 0;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  /**
   * Review Button for Missed Trades
   */
  
  .missed-trade-note-review-section {
    margin-top: 2rem;
    padding-top: 1.5rem;
    border-top: 1px solid var(--background-modifier-border);
    display: flex;
    justify-content: center;
    align-items: center;
  }

  /**
   * Form Styling for Missed Trade Toggle
   */
  
  /* Missed trade toggle styling in forms */
  .field .checkbox-label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    cursor: pointer;
    font-size: 0.9rem;
    color: var(--text-normal);
    transition: color 0.2s ease;
  }

  .field .checkbox-label:hover {
    color: var(--interactive-accent);
  }

  .field .checkbox-label input[type="checkbox"] {
    cursor: pointer;
    transform: scale(1.1);
  }

  .field .checkbox-label span {
    font-weight: 500;
  }

  /* Missed trade reason field styling */
  .field .textarea {
    width: 100%;
    min-height: 80px;
    padding: 0.75rem;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background: var(--background-primary);
    color: var(--text-normal);
    font-family: inherit;
    font-size: 0.9rem;
    line-height: 1.5;
    resize: vertical;
    transition: border-color 0.15s ease;
  }

  .field .textarea:focus {
    outline: none;
    border-color: var(--interactive-accent);
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2);
  }

  .field .textarea::placeholder {
    color: var(--text-muted);
    opacity: 0.7;
  }

  /**
   * Responsive Design
   */
  
  @media (max-width: 768px) {
    .missed-trade-badge {
      font-size: 0.7rem;
      padding: 0.2rem 0.4rem;
      margin-right: 0.5rem;
    }
    
    .missed-trade-reason-content {
      font-size: 0.85rem;
      padding: 0.5rem;
    }
  }

  @media (max-width: 480px) {
    .missed-trades-timeline-section {
      margin-top: 0.75rem;
      padding-top: 0.5rem;
    }
    
    .missed-trades-label {
      font-size: 0.85rem;
    }
  }

  /**
   * Dark theme adjustments
   */
  
  /* Removed orange theme styling per user request */
  
  .theme-dark .missed-trade-reason-content {
    background-color: var(--background-secondary-alt);
  }
  
  .theme-dark .timeline-item.missed-trade {
    background-color: rgba(255, 149, 0, 0.2);
  }
  
  .theme-dark .timeline-item.missed-trade:hover {
    background-color: rgba(255, 149, 0, 0.3);
  }

  /**
   * Multiple view compatibility
   */
  
  .workspace-split.mod-vertical .journalit-missed-trade-view {
    max-width: 100%;
    flex-shrink: 1;
  }
  
  .workspace-leaf-content .journalit-missed-trade-view .trade-metrics-grid {
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  }
  
  .workspace-leaf-content .journalit-missed-trade-view .missed-trade-note-container {
    min-width: 0;
  }
`});function CO(){if(document.head.querySelector("#drc-styles"))return;let e=document.createElement("style");e.id="drc-styles",e.textContent=Mbe,document.head.appendChild(e)}function ju(){CO()}var Mbe,o0=L(()=>{Mbe=`
  /* Daily Report Card styles */
  .drc-container {
    background-color: transparent; /* Remove background to match Weekly Review */
    border-radius: 0; /* Remove border radius to match Weekly Review */
    box-shadow: none; /* Remove shadow to match Weekly Review */
    margin: 0; /* Remove margin to match Weekly Review */
    overflow: hidden;
    display: flex;
    flex-direction: column;
    font-family: var(--font-interface, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif);
    position: relative; /* Establish positioning context to prevent jumping */
    z-index: 1; /* Ensure proper stacking context */
    transform: translateZ(0); /* Force GPU acceleration for stability */
    will-change: auto !important; /* Prevent aggressive optimization */
    contain: layout style !important; /* CSS containment to prevent layout recalculation cascades */
  }

  /* DRC ComboBox styling - matched with TradeForm styling */
  .drc-container .combobox-container,
  .drc-container [data-combobox-type],
  .drc-missed-trade .combobox-container,
  .drc-missed-trade .drc-input-group.field .combobox-container {
    position: relative !important;
    width: 100% !important;
    margin-bottom: 8px !important;
    z-index: 10 !important;
  }

  /* Increased z-index when dropdown is open */
  .drc-container .combobox-container[data-is-open="true"],
  .drc-container [data-combobox-type][data-is-open="true"],
  .drc-missed-trade .combobox-container[data-is-open="true"],
  .drc-missed-trade .drc-input-group.field .combobox-container[data-is-open="true"] {
    z-index: 9999 !important;
  }

  /* Dropdown caret for DRC ComboBox */
  .drc-container [data-combobox-type] .input-container::after,
  .drc-missed-trade .combobox-container .input-container::after,
  .drc-missed-trade .drc-input-group.field .combobox-container .input-container::after {
    content: "" !important;
    position: absolute !important;
    right: 12px !important;
    top: 50% !important;
    transform: translateY(-50%) !important;
    width: 0 !important;
    height: 0 !important;
    border-left: 5px solid transparent !important;
    border-right: 5px solid transparent !important;
    border-top: 5px solid var(--text-normal) !important;
    pointer-events: none !important;
    z-index: 10 !important;
  }

  /* Input padding to make room for dropdown arrow */
  .drc-container [data-combobox-type] input[role="combobox"],
  .drc-missed-trade .combobox-container input[role="combobox"],
  .drc-missed-trade .drc-input-group.field .combobox-container input[role="combobox"] {
    padding-right: 30px !important;
    width: 100% !important;
    padding: 8px 12px !important;
    padding-right: 30px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    font-size: 16px !important;
    cursor: pointer !important;
  }

  /* DRC Multi-select styling - fixed for better visibility */
  .drc-missed-trade .selected-options,
  .drc-missed-trade .selected-item,
  .drc-missed-trade [data-combobox-type="multi"] > div:first-of-type {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 4px !important;
    max-width: 100% !important;
    padding: 2px 0 !important;
    z-index: 5 !important;
    position: relative !important;
  }

  /* Style selected tags to match the TradeForm */
  .drc-missed-trade .selected-option,
  .drc-missed-trade .selected-item,
  .selected-option,
  .selected-item {
    display: inline-flex !important;
    align-items: center !important;
    background-color: var(--interactive-accent, #7c3aed) !important; /* Use Obsidian var with purple fallback */
    color: var(--text-on-accent, white) !important;
    border-radius: 4px !important;
    padding: 4px 8px !important; /* Match TradeForm padding */
    font-size: 12px !important; /* Match TradeForm font size */
    margin: 0 4px 4px 0 !important; /* Match TradeForm margin */
    font-weight: 500 !important;
    z-index: 6 !important;
    position: relative !important;
    gap: 6px !important; /* Ensure proper spacing between text and remove button */
  }

  /* Style remove buttons ('\xD7') - matched with TradeForm */
  .drc-missed-trade .selected-option-remove,
  .drc-missed-trade .selected-item button,
  .selected-option-remove,
  .selected-item button {
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    width: 16px !important;
    height: 16px !important;
    min-width: 16px !important; /* Prevent shrinking */
    min-height: 16px !important; /* Prevent shrinking */
    padding: 0 !important;
    margin-left: 4px !important;
    cursor: pointer !important;
    background: rgba(255, 255, 255, 0.2) !important;
    border: none !important;
    border-radius: 50% !important;
    color: var(--text-on-accent, white) !important;
    font-size: 16px !important;
    line-height: 1 !important; /* Match TradeForm for consistent vertical centering */
    text-align: center !important;
    z-index: 7 !important;
    position: relative !important;
    transition: background-color 0.2s !important;
  }

  /* Header and Navigation */
  .drc-header {
    padding: 16px 20px 12px;
    background-color: var(--background-secondary);
    text-align: center;
    border-bottom: 1px solid var(--background-modifier-border);
  }

  .drc-date-display {
    font-size: 28px;
    font-weight: 600;
    color: var(--text-normal);
    margin-bottom: 20px;
  }

  /* DRC specific header classes */
  .drc-title {
    font-size: 28px;
    font-weight: 600;
    color: var(--text-normal);
    margin-bottom: 20px;
    text-align: center;
  }

  .drc-date-container {
    font-size: 28px;
    font-weight: 600;
    color: var(--text-normal);
    margin-bottom: 20px;
    text-align: center;
  }

  .drc-navigation {
    width: 100%;
    padding-top: 10px;
    border-top: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1));
  }

  .drc-navigation-links {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 8px;
    flex-wrap: wrap;
    width: 100% !important;
  }

  /* Tabs Container */
  .drc-tabs-container {
    background-color: var(--background-secondary-alt, #2a2a2a);
    border-bottom: 1px solid var(--background-modifier-border);
    display: flex;
    justify-content: center;
    padding: 0;
  }

  /* Tabs */
  .drc-tabs {
    display: flex;
    justify-content: center;
    background-color: transparent;
    max-width: 600px;
    margin: 0 auto;
  }

  .drc-tab {
    padding: 12px 24px;
    background: transparent;
    border: none;
    color: var(--text-muted);
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
    outline: none;
    border-bottom: 2px solid transparent;
  }

  .drc-tab:hover {
    color: var(--text-normal);
    background-color: rgba(127, 127, 127, 0.05);
  }

  .drc-tab.active {
    color: var(--text-accent);
    border-bottom: 2px solid var(--text-accent);
  }

  .drc-tab.active::after {
    content: none; /* Removing the additional indicator since we're using border-bottom */
  }

  /* Content area */
  .drc-content {
    padding: 20px 0 0; /* Removed bottom padding to prevent extra space */
  }

  /* Sections */
  .drc-section {
    margin: 0 0 24px 0; /* Explicit horizontal margin of 0 to match Weekly Review */
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    padding: 16px;
    background-color: var(--background-primary);
    width: 100%; /* Ensure full width */
    box-sizing: border-box; /* Include padding in width calculation */
  }

  /* Last section should not have a bottom margin to prevent extra space */
  .drc-section:last-child {
    margin-bottom: 0 !important;
  }

  /* First section should not have a top margin to prevent extra space */
  .drc-section:first-child {
    margin-top: 0 !important;
  }

  .drc-section h3 {
    margin-top: 0;
    margin-bottom: 16px;
    font-size: 16px;
    color: var(--text-normal);
    border-bottom: 1px solid var(--background-modifier-border);
    padding-bottom: 8px;
    text-align: center;
  }

  /* Checklist */
  .drc-checklist {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 8px;
  }

  .drc-checklist-item {
    display: flex;
    align-items: center;
    padding: 8px 12px;
    border-radius: 4px;
    background-color: var(--background-secondary);
    transition: background-color 0.2s ease;
    cursor: pointer !important; /* Make the entire area clickable */
  }

  /* Custom styling to center checkbox */
  .drc-checklist-item input[type="checkbox"] {
    margin-right: 10px;
    vertical-align: middle !important;
  }

  .drc-checklist-item:hover {
    background-color: var(--background-modifier-hover);
  }

  /* Input groups */
  .drc-input-group {
    margin-bottom: 16px;
  }

  .drc-input-group label {
    display: block;
    margin-bottom: 6px;
    font-size: 16px;
    font-weight: 500;
    color: var(--text-normal);
  }

  .drc-input-group input,
  .drc-input-group textarea,
  .drc-input-group select {
    width: 100%;
    padding: 8px 12px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    font-size: 16px;
  }

  .drc-input-group textarea,
  .drc-textarea {
    width: 100%;
    min-height: 80px;
    padding: 12px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    font-family: var(--font-text);
    font-size: 16px;
    resize: vertical;
  }

  /* Stats cards */
  .drc-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
    gap: 16px;
    margin-bottom: 24px;
  }

  .drc-stat-card {
    background-color: var(--background-secondary);
    border-radius: 6px;
    padding: 16px;
    text-align: center;
    transition: transform 0.2s;
    min-width: 0; /* Enable proper overflow handling */
  }

  .drc-stat-card:hover {
    transform: translateY(-2px);
  }

  .drc-stat-value {
    font-size: 24px;
    font-weight: 700;
    margin-bottom: 4px;
    color: var(--text-normal);
    white-space: nowrap; /* Keep values on one line */
    overflow: hidden; /* Hide overflow */
    text-overflow: ellipsis; /* Add ellipsis for overflow */
  }

  .drc-stat-value.positive {
    color: var(--color-success, #43a047);
  }

  .drc-stat-value.negative {
    color: var(--color-error, #e53935);
  }
  
  /* Special handling for P&L stat card which often has longer values */
  .drc-stats .drc-stat-card:nth-child(4) {
    min-width: 140px; /* Give P&L card extra space */
  }

  .drc-stat-label {
    font-size: 12px;
    color: var(--text-muted);
  }

  /* Grades */
  .drc-grades {
    display: grid;
    grid-template-columns: minmax(200px, 1fr) minmax(200px, 1fr) !important;
    gap: 16px !important;
    margin-bottom: 24px !important;
    align-items: end !important;
  }

  .drc-grade {
    display: flex !important;
    flex-direction: column !important;
    height: 100% !important;
    min-width: 200px !important;
    padding: 16px !important;
  }

  .drc-grade select {
    font-size: 16px;
    font-weight: 600;
    padding: 10px 16px;
    height: auto;
    line-height: 1.5;
    text-align-last: center;
    appearance: menulist-button;
    -webkit-appearance: menulist-button;
  }

  /* Trade table */
  .drc-trade-table {
    width: 100%;
    border-collapse: collapse;
  }

  .drc-trade-table th {
    text-align: left;
    padding: 10px;
    border-bottom: 2px solid var(--background-modifier-border);
    font-weight: 600;
    color: var(--text-normal);
  }

  .drc-trade-table td {
    padding: 10px;
    border-bottom: 1px solid var(--background-modifier-border);
    color: var(--text-normal);
  }

  .drc-trade-table td.positive {
    color: var(--color-success, #43a047);
  }

  .drc-trade-table td.negative {
    color: var(--color-error, #e53935);
  }

  .drc-trade-table select,
  .drc-trade-table input {
    width: 100%;
    padding: 6px 10px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background-color: var(--background-primary);
    color: var(--text-normal);
  }
  
  /* Weekly review trades table for DRC compatibility */
  .weekly-review-trades-table {
    /* Table header for preview column */
    th:first-child {
      width: 60px !important; /* Fixed width for preview column */
      text-align: center !important;
      padding: 8px 4px !important;
    }
    
    /* Trade preview cell */
    .trade-preview-cell {
      width: 60px !important;
      padding: 4px !important;
      text-align: center !important;
      vertical-align: middle !important;
    }
    
    /* Image wrapper container */
    .trade-image-wrapper {
      position: relative !important;
      width: 48px !important; 
      height: 48px !important;
      display: inline-block !important;
      cursor: pointer !important;
      overflow: hidden !important;
      border-radius: 4px !important;
      border: 1px solid var(--background-modifier-border) !important;
    }
    
    /* Lazy loaded image container */
    .trade-preview-thumbnail {
      width: 100% !important;
      height: 100% !important;
    }
    
    /* Placeholder shown before image loads */
    .trade-preview-placeholder {
      width: 100% !important;
      height: 100% !important;
      background-color: var(--background-modifier-hover) !important;
      border-radius: 4px !important;
    }
    
    /* Indicator badge for multiple images */
    .trade-image-count-indicator {
      position: absolute !important;
      bottom: 2px !important;
      right: 2px !important;
      background-color: rgba(0, 0, 0, 0.7) !important;
      color: var(--text-on-accent) !important;
      font-size: 10px !important;
      font-weight: bold !important;
      padding: 1px 4px !important;
      border-radius: 3px !important;
      line-height: 1 !important;
      pointer-events: none !important; /* Don't interfere with click handling */
      z-index: 2 !important;
    }
    
    /* Icon styling when no image exists */
    .trade-no-image-icon {
      color: var(--text-muted) !important;
      opacity: 0.5 !important;
    }
    
    /* Scale up image preview on hover */
    .trade-image-wrapper:hover {
      transform: scale(1.05) !important;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2) !important;
      transition: all 0.2s ease !important;
    }
  }
  
  .weekly-review-trades-table {
    width: 100% !important;
    overflow-x: auto !important;
    margin-bottom: 16px !important;
  }

  .weekly-review-trades-table table {
    width: 100% !important;
    border-collapse: collapse !important;
    font-size: 16px !important;
    text-align: left !important;
    margin: 0 !important;
    table-layout: auto !important;
  }

  .weekly-review-trades-table th {
    padding: 10px 12px !important;
    border-bottom: 2px solid var(--background-modifier-border) !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    background-color: var(--background-secondary) !important;
    text-align: left !important;
    white-space: nowrap !important;
  }

  .weekly-review-trades-table td {
    padding: 8px 12px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
    text-align: left !important;
    transition: background-color 0.2s ease !important;
  }

  .weekly-review-trades-table tr:hover td {
    background-color: var(--background-modifier-hover) !important;
  }

  .weekly-review-trade-row {
    cursor: pointer !important;
  }

  .weekly-review-trade-row:hover {
    background-color: var(--background-modifier-hover) !important;
  }

  /* DRC View Button - used in trade tables */
  .drc-nav-button {
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    padding: 8px 14px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    cursor: pointer !important;
    font-size: 16px !important;
    transition: all 0.2s !important;
    text-align: center !important;
    flex: 1 !important;
    min-width: 120px !important;
    box-sizing: border-box !important;
  }

  .drc-nav-button:hover {
    background-color: var(--background-modifier-hover) !important;
    transform: translateY(-1px) !important;
  }

  /* Review sections */
  .drc-reflection-item {
    margin-bottom: 16px;
  }

  .drc-reflection-item label {
    display: block;
    margin-bottom: 6px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .drc-reflection-item textarea {
    width: 100%;
    min-height: 100px;
    padding: 12px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    resize: vertical;
  }

  /* DRC dropdown options - remove bullets and match TradeForm */
  .drc-container [data-combobox-type] ul[role="listbox"],
  .drc-missed-trade [data-combobox-type] ul[role="listbox"] {
    position: absolute !important;
    top: 100% !important;
    left: 0 !important;
    right: 0 !important;
    max-height: 200px !important;
    overflow-y: auto !important;
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-top: none !important;
    border-radius: 0 0 4px 4px !important;
    margin-top: -1px !important;
    z-index: 9999 !important;
    list-style: none !important; /* Remove bullets */
    padding: 0 !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
    /* Fix for blurry text - add hardware acceleration properties */
    transform: translateZ(0) !important; /* Force GPU acceleration */
    backface-visibility: hidden !important;
    perspective: 1000px !important;
    -webkit-font-smoothing: antialiased !important;
    -moz-osx-font-smoothing: grayscale !important;
    /* Animation properties for smooth open effect */
    animation: drc-dropdown-open 0.15s ease forwards !important;
  }
  
  /* Animation for DRC dropdown appearance */
  @keyframes drc-dropdown-open {
    from {
      opacity: 0;
      transform: translateY(-5px) translateZ(0);
    }
    to {
      opacity: 1;
      transform: translateY(0) translateZ(0);
    }
  }

  /* DRC dropdown options styling */
  .drc-container [data-combobox-type] ul[role="listbox"] li,
  .drc-missed-trade [data-combobox-type] ul[role="listbox"] li {
    padding: 8px 12px !important;
    cursor: pointer !important;
    transition: background-color 150ms ease !important;
    margin: 0 !important;
    list-style: none !important; /* Ensure no bullets */
    border-bottom: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1)) !important;
    /* Fix for blurry text */
    transform: translateZ(0) !important; /* Force GPU acceleration */
    -webkit-font-smoothing: antialiased !important;
    -moz-osx-font-smoothing: grayscale !important;
    /* Ensure text is crisp */
    text-rendering: optimizeLegibility !important;
  }

  /* Hover and selected state for DRC dropdown options */
  .drc-container [data-combobox-type] ul[role="listbox"] li:hover,
  .drc-container [data-combobox-type] ul[role="listbox"] li[aria-selected="true"],
  .drc-missed-trade [data-combobox-type] ul[role="listbox"] li:hover,
  .drc-missed-trade [data-combobox-type] ul[role="listbox"] li[aria-selected="true"] {
    background-color: var(--background-secondary) !important;
  }

  /* Special styling for "Add new" option in DRC */
  .drc-container [data-combobox-type] ul[role="listbox"] li[data-add-option="true"],
  .drc-missed-trade [data-combobox-type] ul[role="listbox"] li[data-add-option="true"] {
    font-style: italic !important;
    border-top: 1px dashed var(--background-modifier-border) !important;
    /* Fix for blurry text */
    transform: translateZ(0) !important; /* Force GPU acceleration */
    -webkit-font-smoothing: antialiased !important;
    -moz-osx-font-smoothing: grayscale !important;
    /* Ensure text is crisp */
    text-rendering: optimizeLegibility !important;
  }

  /* When dropdown is open, change input border radius */
  .drc-container [data-combobox-type][data-is-open="true"] input[role="combobox"],
  .drc-missed-trade [data-combobox-type][data-is-open="true"] input[role="combobox"] {
    border-bottom-left-radius: 0 !important;
    border-bottom-right-radius: 0 !important;
  }
  
  /* Add hover effect for remove buttons */
  .drc-missed-trade .selected-option-remove:hover,
  .drc-missed-trade .selected-item button:hover,
  .selected-option-remove:hover,
  .selected-item button:hover {
    background: rgba(255, 255, 255, 0.4) !important; /* Brighter on hover */
  }

  /* Missed trades */
.drc-missed-trade {
  padding: 16px;
  padding-top: 42px; /* Extra padding at top to make space for the remove button */
  margin-bottom: 16px;
  background-color: var(--background-secondary);
  border-radius: 6px;
  position: relative;
}

/* Ensure the remove button is always clickable with a high z-index */
.drc-missed-trade-remove {
  position: absolute !important;
  top: 12px !important;
  right: 12px !important;
  z-index: 12000 !important; /* Ensure it's above any dropdowns */
  padding: 6px 12px !important;
  min-width: 80px !important;
  min-height: 32px !important;
  margin: 0 !important;
}

/* Missed trade images container */
.drc-missed-trade-images-container {
  margin-top: 16px;
}

/* Container for image carousel */
.drc-missed-trade-images {
  margin-bottom: 12px;
  background-color: var(--background-primary);
  border-radius: 6px;
  padding: 12px;
  border: 1px solid var(--background-modifier-border);
}

/* Image uploader for missed trades */
.drc-missed-trade-image-uploader {
  height: 60px !important; /* Smaller height for the uploader */
  margin-top: 8px;
}

  .drc-missed-trade .drc-remove-button {
    position: absolute;
    top: 12px;
    right: 12px;
  }

  /* Buttons */
  .drc-add-button,
  .drc-remove-button,
  .drc-nav-button {
    padding: 8px 14px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    cursor: pointer;
    font-size: 16px;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .drc-add-button {
    margin-bottom: 16px;
    background-color: var(--interactive-accent);
    color: var(--text-on-accent, white);
    border-color: var(--interactive-accent);
  }

  .drc-add-button:hover {
    background-color: var(--interactive-accent-hover);
  }

  .drc-remove-button {
    background-color: rgba(229, 57, 53, 0.1);
    color: var(--color-error, #e53935);
    border-color: var(--color-error, #e53935);
  }

  .drc-remove-button:hover {
    background-color: rgba(229, 57, 53, 0.2);
  }

  .drc-nav-button:hover {
    background-color: var(--background-modifier-hover);
    transform: translateY(-1px);
  }

  .drc-nav-button .nav-icon {
    font-size: 16px;
    line-height: 1;
  }

  /* Empty state */
  .drc-empty-state {
    padding: 20px;
    text-align: center;
    color: var(--text-muted);
    font-style: italic;
    background-color: var(--background-secondary);
    border-radius: 4px;
  }

  /* Goals section */
  .drc-goal-item {
    display: flex;
    align-items: center;
    margin-bottom: 8px;
    gap: 10px;
  }

  .drc-goal-item input {
    flex: 1;
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
    .drc-grades {
      grid-template-columns: 1fr;
    }

    .drc-stats {
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    }

    .drc-trade-table {
      display: block;
      overflow-x: auto;
    }

    .drc-navigation-links {
      justify-content: center !important;
      width: 100% !important;
    }

    .drc-nav-button {
      flex: 1 !important;
      justify-content: center !important;
      min-width: 120px !important;
    }

    /* Make tabs more compact on mobile */
    .drc-tab {
      padding: 10px 16px;
      font-size: 13px;
    }
  }

  /* Fix for grade value display and container sizing */
  .drc-note-grades {
    display: grid !important;
    grid-template-columns: minmax(200px, 1fr) minmax(200px, 1fr) !important;
    gap: 16px !important;
    margin-bottom: 24px !important;
    align-items: end !important;
  }

  .drc-note-grade {
    display: flex !important;
    flex-direction: column !important;
    height: 100% !important;
    min-width: 200px !important;
    padding: 16px !important;
  }

  .drc-note-grade-label {
    font-size: 16px !important;
    font-weight: 500 !important;
    color: var(--text-normal) !important;
    margin-bottom: 8px !important;
    display: block !important;
    text-align: center !important;
  }

  /* Critical fixes for grade display and containers */
  .drc-note-grades {
    display: grid !important;
    grid-template-columns: minmax(200px, 1fr) minmax(200px, 1fr) !important;
    gap: 16px !important;
    margin-bottom: 24px !important;
    align-items: center !important;
  }

  .drc-note-grade {
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    height: 100% !important;
    min-width: 200px !important;
    padding: 16px !important;
    background-color: var(--background-primary) !important;
    border-radius: var(--border-radius-md, 4px) !important;
    border: 1px solid var(--background-modifier-border) !important;
  }

  .drc-note-grade-label {
    font-size: 16px !important;
    font-weight: 500 !important;
    color: var(--text-normal) !important;
    margin-bottom: 12px !important;
    display: block !important;
    text-align: center !important;
    width: 100% !important;
  }

  .drc-note-grade-dropdown {
    width: 60px !important;
    height: 60px !important;
    position: relative !important;
  }

  /* Grade value styling with perfect centering */
  .drc-note-grade-value,
  select.drc-note-grade-value {
    width: 60px !important;
    height: 60px !important;
    min-width: 60px !important;
    min-height: 60px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    border-radius: 50% !important;
    font-size: 22px !important;
    font-weight: 600 !important;
    margin: 0 !important;
    padding: 0 !important;
    border: none !important;
    background-color: var(--background-secondary) !important;
    color: var(--text-normal) !important;
    cursor: pointer !important;
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    appearance: none !important;
    text-align: center !important;
    line-height: 1 !important;
    text-indent: 0 !important;
    box-sizing: border-box !important;
    overflow: visible !important;
    position: relative !important;
  }

  /* Grade colors - A is green, B is orange, C is red */
  .drc-note-grade-value.grade-a {
    background-color: rgba(102, 187, 106, 0.3) !important;
    color: var(--text-success) !important;
  }

  .drc-note-grade-value.grade-b {
    background-color: rgba(255, 152, 0, 0.3) !important;
    color: var(--text-warning) !important;
  }

  .drc-note-grade-value.grade-c {
    background-color: rgba(229, 57, 53, 0.3) !important;
    color: var(--text-error) !important;
  }

  /* Hide dropdown arrow */
  .drc-note-grade-dropdown::after,
  .drc-note-grade-dropdown::before,
  .drc-note-grade-dropdown select::after,
  .drc-note-grade-dropdown select::before {
    content: none !important;
    display: none !important;
  }

  /* Media query for responsive layout */
  @media (max-width: 768px) {
    .drc-note-grades {
      grid-template-columns: 1fr !important;
      gap: 12px !important;
    }

    /* Key Levels responsive adjustments */
    .drc-levels-container {
      flex-direction: column !important;
    }

    .drc-level-section {
      width: 100% !important;
    }
  }

  @media (min-width: 768px) {
    .drc-levels-container {
      flex-direction: row !important;
      gap: 16px !important;
    }

    .drc-level-section {
      width: calc(50% - 8px) !important;
    }
  }

  /* Key Levels Component Styles */
  .drc-key-levels {
    margin-top: 16px !important;
  }
  
  /* IconSelect Component Styles */
  .icon-select-container {
    position: relative !important;
    display: inline-block !important;
    width: 40px !important;
    height: 32px !important;
    vertical-align: middle !important;
  }

  .icon-select-trigger {
    width: 100% !important;
    height: 100% !important;
    padding: 0 !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    cursor: pointer !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
  }
  
  /* Center SVG icons inside the trigger button */
  .icon-select-trigger svg {
    display: block !important;
    margin: 0 auto !important;
  }

  .icon-select-trigger:hover {
    background-color: var(--background-modifier-hover) !important;
  }

  .icon-select-menu {
    position: absolute !important;
    top: calc(100% + 2px) !important;
    left: 0 !important;
    width: 40px !important;
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
    z-index: 1000 !important;
    list-style: none !important;
    padding: 4px 0 !important;
    margin: 0 !important;
  }

  .icon-select-option {
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    padding: 6px 0 !important;
    cursor: pointer !important;
    height: 28px !important;
  }
  
  /* Center SVG icons inside the dropdown options */
  .icon-select-option svg {
    display: block !important;
    margin: 0 auto !important;
  }

  .icon-select-option:hover {
    background-color: var(--background-modifier-hover) !important;
  }

  .icon-select-option.selected {
    background-color: var(--background-secondary) !important;
  }

  .drc-levels-container {
    display: flex !important;
    flex-direction: column !important;
    gap: 24px !important;
  }

  .drc-level-section {
    border-radius: 8px !important;
    padding: 16px !important;
    background-color: var(--background-secondary) !important;
  }

  .support-section {
    border-left: 3px solid rgba(102, 187, 106, 0.7) !important;
  }

  .resistance-section {
    border-left: 3px solid rgba(229, 57, 53, 0.7) !important;
  }

  .drc-level-header {
    margin: 0 0 12px 0 !important;
    padding-bottom: 8px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
    font-size: 16px !important;
    font-weight: 600 !important;
    text-align: center !important;
  }

  .support-header {
    color: var(--color-success, #43a047) !important;
  }

  .resistance-header {
    color: var(--color-error, #e53935) !important;
  }

  .drc-level-add-container {
    margin-bottom: 12px !important;
  }

  .drc-level-input-group {
    display: flex !important;
    gap: 8px !important;
    width: 100% !important;
    align-items: center !important;
  }

  .drc-level-input {
    flex: 2 !important;
    min-width: 0 !important;
    padding: 6px 12px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    font-size: 16px !important;
    height: 32px !important;
    min-height: 32px !important;
    max-height: 32px !important;
    line-height: 20px !important;
    box-sizing: border-box !important;
    margin: 0 !important;
    display: block !important;
  }

  .drc-level-importance-select {
    width: 40px !important;
    display: flex !important;
    align-items: center !important;
  }

  .drc-importance-select {
    width: 40px !important;
    padding: 6px 0 6px 24px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    font-size: 16px !important;
    height: 32px !important;
    min-height: 32px !important;
    max-height: 32px !important;
    line-height: 20px !important;
    box-sizing: border-box !important;
    margin: 0 !important;
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    appearance: none !important;
    vertical-align: middle !important;
    background-image: none !important;
    text-align: center !important;
  }

  /* Ensure select options have consistent height */
  .drc-importance-select option {
    padding: 4px 8px !important;
    height: auto !important;
    line-height: normal !important;
  }

  .drc-level-add-button {
    padding: 6px 12px !important;
    height: 32px !important;
    min-height: 32px !important;
    max-height: 32px !important;
    box-sizing: border-box !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    margin: 0 !important;
    line-height: 20px !important;
  }

  .drc-levels-list {
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important;
  }

  .drc-level-item {
    display: flex !important;
    align-items: center !important;
    padding: 8px 12px !important;
    background-color: var(--background-primary) !important;
    border-radius: 4px !important;
    position: relative !important;
    justify-content: flex-start !important;
  }

  .support-level {
    border-left: 3px solid rgba(102, 187, 106, 0.5) !important;
  }

  .resistance-level {
    border-left: 3px solid rgba(229, 57, 53, 0.5) !important;
  }

  .drc-level-price {
    font-weight: 500 !important;
    margin-right: 8px !important;
  }

  .drc-level-importance {
    font-size: 12px !important;
    padding: 2px 6px !important;
    border-radius: 3px !important;
  }

  .importance-high {
    background-color: rgba(229, 57, 53, 0.1) !important;
  }

  .importance-high .drc-level-importance {
    background-color: rgba(229, 57, 53, 0.2) !important;
    color: var(--color-error, #e53935) !important;
  }

  .importance-medium {
    background-color: rgba(255, 152, 0, 0.1) !important;
  }

  .importance-medium .drc-level-importance {
    background-color: rgba(255, 152, 0, 0.2) !important;
    color: var(--color-orange, #ef6c00) !important;
  }

  .importance-low {
    background-color: rgba(33, 150, 243, 0.1) !important;
  }

  .importance-low .drc-level-importance {
    background-color: rgba(33, 150, 243, 0.2) !important;
    color: var(--interactive-accent) !important;
  }

  .drc-level-remove-button {
    padding: 0 !important;
    width: 24px !important;
    height: 24px !important;
    background-color: rgba(229, 57, 53, 0.1) !important;
    color: var(--color-error, #e53935) !important;
    border: none !important;
    border-radius: 50% !important;
    cursor: pointer !important;
    font-size: 16px !important;
    line-height: 0 !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    margin-left: auto !important; /* Always push to the right */
    text-align: center !important;
    vertical-align: middle !important;
  }

  .drc-empty-levels {
    color: var(--text-muted) !important;
    font-style: italic !important;
    padding: 8px !important;
    text-align: center !important;
  }

  /* Ultra-high specificity rule for DRC navigation container */
  html body .drc-container .drc-header .drc-navigation,
  body .drc-container .drc-header .drc-navigation,
  .workspace-leaf .drc-container .drc-header .drc-navigation {
    width: 100% !important;
    padding-top: 10px !important;
    border-top: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1)) !important;
  }

  /* Ultra-high specificity rule for DRC navigation links container */
  html body .drc-container .drc-header .drc-navigation .drc-navigation-links,
  body .drc-container .drc-header .drc-navigation .drc-navigation-links,
  .workspace-leaf .drc-container .drc-header .drc-navigation .drc-navigation-links {
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    gap: 8px !important;
    flex-wrap: wrap !important;
    width: 100% !important;
  }

  /* Forecast section styling for DRC - matches Weekly Review */
  .drc-forecast-section {
    margin-bottom: 20px;
    padding: 16px;
    background-color: var(--background-secondary);
    border-radius: 8px;
  }

  /* Specific styling for forecast textareas - matching weekly review */
  .drc-forecast-section textarea,
  .drc-forecast-section .drc-textarea {
    width: 100%;
    min-height: 80px;
    padding: 12px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    font-family: var(--font-text);
    font-size: 16px;
    resize: vertical;
  }

  .drc-forecast-section h4 {
    margin-top: 0;
    margin-bottom: 15px;
    font-size: 1.05em;
  }

  .drc-image-container {
    margin-bottom: 12px;
  }

  .drc-image {
    position: relative;
    margin-bottom: 12px;
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    padding: 8px;
    background-color: var(--background-primary);
  }

  .drc-forecast-image {
    width: auto;
    max-width: 100%;
    max-height: 300px;
    object-fit: contain;
    border-radius: 6px;
    margin-bottom: 8px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    background-color: var(--background-primary);
  }

  .drc-image-upload {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 80px;
    border: 2px dashed var(--background-modifier-border);
    border-radius: 6px;
    margin-bottom: 12px;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
    overflow: hidden;
  }

  .drc-image-upload:hover {
    border-color: var(--interactive-accent);
    background-color: rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.05);
  }

  .drc-image-upload.dragging-over {
    border-color: var(--interactive-accent);
    background-color: rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.1);
    transform: scale(1.02);
    box-shadow: 0 0 12px rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.3);
  }

  .drc-image-upload::after {
    content: "Drag and drop here";
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 16px;
    font-weight: 600;
    color: var(--interactive-accent);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s ease;
  }

  .drc-image-upload.dragging-over::after {
    opacity: 1;
  }

  .drc-image-upload.dragging-over .drc-image-label {
    opacity: 0;
  }

  .drc-image-label {
    font-size: 16px;
    color: var(--text-muted);
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .drc-image-upload:hover .drc-image-label {
    color: var(--interactive-accent);
  }

  .drc-image-input {
    display: none;
  }

  .drc-image-delete {
    background-color: rgba(229, 57, 53, 0.1);
    color: var(--color-error, #e53935);
    border: none;
    border-radius: 4px;
    padding: 6px 12px;
    font-size: 12px;
    cursor: pointer;
  }

  .drc-image-error {
    color: var(--text-error, var(--color-red, #e53935));
    font-size: 12px;
    text-align: center;
    margin-top: 4px;
    margin-bottom: 8px;
    padding: 6px 10px;
    background-color: rgba(229, 57, 53, 0.1);
    border-radius: 4px;
    width: 100%;
  }

  /* Hint for click/hold to zoom */
  .drc-forecast-image {
    cursor: zoom-in !important;
    position: relative;
  }

  .drc-forecast-image::after {
    content: "Click or hold to enlarge";
    position: absolute;
    bottom: 8px;
    right: 8px;
    background-color: rgba(0, 0, 0, 0.6);
    color: var(--text-on-accent);
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 10px;
    opacity: 0;
    transition: opacity 0.2s ease;
  }

  .drc-forecast-image:hover::after {
    opacity: 1;
  }

  /* Fullscreen styles */
  .drc-fullscreen-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-color: rgba(0, 0, 0, 0.85);
    z-index: 4000; /* Reduced from 1000000 to prevent blocking interactions */
    display: flex;
    align-items: center;
    justify-content: center;
    animation: fadeIn 0.3s ease-in-out;
    backdrop-filter: blur(5px);
    -webkit-backdrop-filter: blur(5px);
    cursor: pointer;
  }

  .drc-fullscreen-content {
    max-width: 90vw;
    max-height: 90vh;
    display: flex;
    flex-direction: column;
    background-color: var(--background-primary);
    border-radius: 8px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
    animation: zoomIn 0.3s ease-in-out;
    overflow: hidden;
    cursor: default;
  }

  .drc-fullscreen-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 16px;
    background-color: var(--background-secondary);
    border-bottom: 1px solid var(--background-modifier-border);
  }

  .drc-fullscreen-header h3 {
    margin: 0;
    font-size: 18px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .drc-fullscreen-close {
    background-color: rgba(229, 57, 53, 0.1);
    color: var(--color-error, #e53935);
    border: none;
    border-radius: 4px;
    padding: 6px 12px;
    font-size: 16px;
    cursor: pointer;
  }

  .drc-fullscreen-close:hover {
    background-color: rgba(229, 57, 53, 0.2);
  }

  .drc-fullscreen-image-container {
    overflow: auto;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 16px;
    background-color: var(--background-primary);
    max-height: calc(90vh - 120px);
    /* Add subtle grid background for transparency */
    background-image: linear-gradient(45deg, var(--background-secondary) 25%, transparent 25%, transparent 75%, var(--background-secondary) 75%),
               linear-gradient(45deg, var(--background-secondary) 25%, transparent 25%, transparent 75%, var(--background-secondary) 75%);
    background-size: 20px 20px;
    background-position: 0 0, 10px 10px;
  }

  .drc-fullscreen-image {
    max-width: 100%;
    max-height: calc(90vh - 120px);
    object-fit: contain;
    border-radius: 4px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
  }

  .drc-fullscreen-footer {
    padding: 10px 16px;
    background-color: var(--background-secondary);
    border-top: 1px solid var(--background-modifier-border);
    text-align: center;
  }

  .drc-fullscreen-footer p {
    margin: 0;
    font-size: 12px;
    color: var(--text-muted);
  }

  /* Animations */
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  @keyframes zoomIn {
    from { transform: scale(0.9); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
  }

  /* Weekly Events Styling for DRC */
  .drc-weekly-events {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .drc-weekly-event-item {
    padding: 12px;
    background-color: var(--background-secondary);
    border-radius: 8px;
    border-left: 5px solid var(--event-color-gray, #888888);
    margin-bottom: 8px;
    transition: border-color 0.3s ease;
  }

  .drc-weekly-event-item.event-color-red {
    border-left-color: var(--event-color-red, #e53935);
  }

  .drc-weekly-event-item.event-color-orange {
    border-left-color: var(--event-color-orange, #fb8c00);
  }

  .drc-weekly-event-item.event-color-yellow {
    border-left-color: var(--event-color-yellow, #fdd835);
  }

  .drc-weekly-event-item.event-color-gray {
    border-left-color: var(--event-color-gray, #888888);
  }

  .drc-weekly-event-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
  }

  .drc-weekly-event-header h4 {
    margin: 0;
    font-size: 16px;
    font-weight: 600;
  }

  .drc-weekly-event-item p {
    margin: 0;
    font-size: 16px;
    color: var(--text-normal);
    white-space: pre-line;
  }

  .drc-weekly-event-badge {
    font-size: 12px;
    padding: 2px 8px;
    background-color: var(--background-modifier-border);
    border-radius: 4px;
    color: var(--text-normal);
    font-weight: 500;
    white-space: nowrap;
  }

  /* Ultra-high specificity rule for DRC navigation buttons */
  html body .drc-container .drc-header .drc-navigation .drc-navigation-links .drc-nav-button,
  body .drc-container .drc-header .drc-navigation .drc-navigation-links .drc-nav-button,
  .workspace-leaf .drc-container .drc-header .drc-navigation .drc-navigation-links .drc-nav-button {
    padding: 8px 14px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    cursor: pointer !important;
    font-size: 16px !important;
    transition: all 0.2s !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    gap: 6px !important;
    flex: 1 !important;
    text-align: center !important;
    min-width: 120px !important;
    box-sizing: border-box !important;
    max-width: none !important;
    margin: 0 !important;
  }

  /* Ensure proper icon spacing for DRC navigation buttons */
  html body .drc-container .drc-header .drc-navigation .drc-nav-button .nav-icon,
  body .drc-container .drc-header .drc-navigation .drc-nav-button .nav-icon {
    font-size: 16px !important;
    line-height: 1 !important;
  }

  /* End of Day Review Styles */
  .drc-eod-images {
    padding: 16px;
    background-color: var(--background-secondary);
    border-radius: 6px;
  }

  .drc-eod-image-uploader {
    margin-top: 8px;
  }

  .drc-eod-review-button-section {
    text-align: center;
  }

  .drc-eod-review-button-section .review-button-container {
    justify-content: center;
  }

  /* No questions message */
  .drc-no-questions {
    padding: 16px;
    text-align: center;
    color: var(--text-muted);
    font-style: italic;
  }

  /* Metadata container positioning fix to prevent jumping */
  .metadata-container {
    position: relative !important;
    z-index: 1 !important;
    transform: translateZ(0) !important;
    will-change: auto !important;
  }

  /* Prevent parent containers from affecting child positioning during re-renders */
  .workspace-leaf-content[data-type="journalit-drc"],
  .view-content,
  .markdown-source-view,
  .markdown-preview-view {
    position: relative !important;
    overflow: auto !important;
  }

  /* Ensure proper stacking context for nested scrollable elements */
  .drc-tabs-content,
  .tab-content {
    position: relative !important;
    z-index: 1 !important;
  }

  /* Prevent layout shift from margin collapsing */
  .drc-container::before {
    content: '';
    display: table;
  }

  /* Fix for when Obsidian adds inline styles during re-render */
  .metadata-container[style*="position"] {
    position: relative !important;
  }

  /* Ensure dropdowns and inputs don't cause layout shifts */
  .drc-container select,
  .drc-container input,
  .drc-container textarea {
    box-sizing: border-box !important;
    max-width: 100% !important;
  }

  /* Responsive font sizing for small screens */
  @media (max-width: 600px) {
    .drc-container input[role="combobox"],
    .drc-input-group input,
    .drc-input-group textarea,
    .drc-input-group select,
    .drc-textarea,
    .drc-forecast-section textarea,
    .drc-forecast-section .drc-textarea,
    .drc-level-input,
    .drc-trade-table input,
    .drc-reflection-item textarea,
    .drc-goal-item input {
      font-size: 18px !important;
    }
  }
`});function Fbe(){if(document.getElementById("journalit-calendar-dynamic-styles"))return;let e=document.createElement("style");e.id="journalit-calendar-dynamic-styles",e.textContent=`
    .${Ge.calendarGrid} {
      display: flex;
      flex-direction: column;
      gap: 4px;
      width: 100%;
    }

    .${Ge.calendarWeekRow} {
      display: grid;
      grid-template-columns: repeat(7, 1fr) 1fr;
      gap: 4px;
      margin-bottom: 4px;
      width: 100%;
      justify-content: stretch;
    }

    .${Ge.calendarWeekRowWeekdays} {
      grid-template-columns: repeat(5, 1fr) 1fr;
    }

    .${Ge.calendarDayCell} {
      aspect-ratio: 1;
      display: flex;
      flex-direction: column;
      position: relative;
      padding: 4px;
      border-radius: 4px;
      width: 100%;
    }

    .${Ge.todayDayCell} {
      position: relative;
      z-index: 2;
    }

    .${Ge.dayNumber} {
      position: absolute;
      top: 4px;
      left: 4px;
      text-align: left;
    }

    .${Ge.pnlValue} {
      font-size: 14px;
      margin-top: 0px;
      width: 100%;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }

    .${Ge.calendarHeader} {
      display: grid;
      grid-template-columns: repeat(7, 1fr) 1fr;
      gap: 4px;
      margin-bottom: 8px;
      position: sticky;
      top: 0;
      background-color: var(--background-primary);
      z-index: 5;
      padding: 4px 0;
      width: 100%;
      justify-content: stretch;
    }

    .${Ge.calendarHeaderWeekdays} {
      grid-template-columns: repeat(5, 1fr) 1fr;
    }

    .${Ge.weekdayLabel} {
      width: 100%;
      text-align: center;
    }

    .${Ge.hiddenWeekend} {
      display: none;
    }

    .${Ge.calendarContainer} {
      width: 100%;
      display: flex;
      flex-direction: column;
    }

    .${Ge.calendarHeaderGrid} {
      grid-template-columns: repeat(7, 1fr) 1fr;
      width: 100%;
    }

    .${Ge.calendarHeaderGridWeekdays} {
      grid-template-columns: repeat(5, 1fr) 1fr;
    }

    .${Ge.calendarWeekRowGrid} {
      grid-template-columns: repeat(7, 1fr) 1fr;
      width: 100%;
    }

    .${Ge.calendarWeekRowGridWeekdays} {
      grid-template-columns: repeat(5, 1fr) 1fr;
    }

    .${Ge.weeklyPnlCell} {
      position: relative;
      display: flex;
      flex-direction: column;
    }

    .${Ge.weekNumberPosition} {
      position: absolute;
      top: 4px;
      left: 4px;
      text-align: left;
      margin-bottom: 0px;
    }

    .${Ge.weeklyPnlValue} {
      font-size: 12px;
      width: 100%;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }

    .${Ge.responsiveCell} {
      position: relative;
      display: flex;
    }

    .${Ge.weeklyPnlRelative} {
      position: relative;
    }

    .${Ge.monthLabel} {
      font-size: 16px;
      font-weight: 600;
      color: var(--text-normal);
      padding: 12px 0 8px 0;
      border-bottom: 2px solid var(--background-modifier-border);
      margin-bottom: 8px;
      margin-top: 0;
      z-index: 1;
    }

    .${Ge.monthLabel}:not(:first-child) {
      margin-top: 8px;
    }
  `,document.head.appendChild(e)}function Obe(e){let t=document.getElementById("journalit-calendar-responsive-styles");t&&t.remove();let r=document.createElement("style");r.id="journalit-calendar-responsive-styles",r.textContent=`
    .${Ge.responsiveDayNumber} {
      position: absolute;
      top: 4px;
      left: 4px;
      text-align: left;
      font-size: ${e.dayNumber};
      font-weight: 500;
    }

    .${Ge.responsivePnlValue} {
      position: absolute;
      top: ${e.pnlPosition};
      left: 50%;
      transform: translate(-50%, -50%);
      width: 100%;
      margin-top: 0px;
      font-size: ${e.pnlValue};
      font-weight: 600;
      text-align: center;
    }

    .${Ge.responsiveTradeCount} {
      position: absolute;
      top: ${e.tradePosition};
      left: 50%;
      transform: translate(-50%, -50%);
      width: 100%;
      font-size: ${e.tradeCount};
      font-weight: 400;
      text-align: center;
      color: var(--text-muted);
      background-color: transparent;
      border-radius: 0;
      padding: 0;
    }

    .${Ge.responsiveWeekNumber} {
      position: absolute;
      top: 4px;
      left: 4px;
      text-align: left;
      font-size: ${e.dayNumber};
      font-weight: 500;
      margin-bottom: 0px;
    }

    .${Ge.responsiveWeekLabel} {
      position: absolute;
      top: 25%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 100%;
      font-size: ${e.tradeCount};
      font-weight: 600;
      text-align: center;
    }

    .${Ge.responsiveWeekPnl} {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 100%;
      font-size: ${e.pnlValue};
      font-weight: 700;
      text-align: center;
    }

    .${Ge.responsiveWeekTrades} {
      position: absolute;
      bottom: 20%;
      left: 50%;
      transform: translate(-50%, 50%);
      width: 85%;
      font-size: ${e.tradeCount};
      font-weight: 500;
      text-align: center;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      color: var(--text-muted);
      background-color: transparent;
      border-radius: 0;
      padding: 0;
    }
  `,document.head.appendChild(r)}function lG(){var n,o,a;let e=window.journalitPlugin,t=(a=(o=(n=e==null?void 0:e.settings)==null?void 0:n.trade)==null?void 0:o.skipWeekends)!=null?a:!0;document.querySelectorAll(".journalit-dashboard-calendar-grid").forEach(i=>{i instanceof HTMLElement&&(i.classList.add(Ge.calendarGrid),i.querySelectorAll(".journalit-dashboard-calendar-week").forEach(c=>{c instanceof HTMLElement&&(c.classList.add(Ge.calendarWeekRow),t?(c.classList.add(Ge.calendarWeekRowWeekdays),c.classList.add("hide-weekends")):(c.classList.remove(Ge.calendarWeekRowWeekdays),c.classList.remove("hide-weekends")))}),i.querySelectorAll(".journalit-dashboard-calendar-day").forEach((c,d)=>{if(c instanceof HTMLElement){c.classList.add(Ge.calendarDayCell),c.classList.contains("today")&&c.classList.add(Ge.todayDayCell);let u=c.querySelector(".journalit-dashboard-calendar-day-number");u instanceof HTMLElement&&u.classList.add(Ge.dayNumber);let p=c.querySelector(".journalit-dashboard-calendar-day-pnl");p instanceof HTMLElement&&p.classList.add(Ge.pnlValue)}}))})}function cG(){var n,o,a;let e=window.journalitPlugin,t=(a=(o=(n=e==null?void 0:e.settings)==null?void 0:n.trade)==null?void 0:o.skipWeekends)!=null?a:!0;document.querySelectorAll(".journalit-dashboard-calendar-header").forEach(i=>{i instanceof HTMLElement&&(i.classList.add(Ge.calendarHeader),t?(i.classList.add(Ge.calendarHeaderWeekdays),i.classList.add("hide-weekends")):(i.classList.remove(Ge.calendarHeaderWeekdays),i.classList.remove("hide-weekends")),i.querySelectorAll(".journalit-dashboard-calendar-weekday").forEach(l=>{l instanceof HTMLElement&&l.classList.add(Ge.weekdayLabel)}),t&&i.querySelectorAll(".journalit-dashboard-calendar-weekday").forEach(c=>{if(c instanceof HTMLElement){let d=c.getAttribute("data-day");d==="Sun"||d==="Sat"?c.classList.add(Ge.hiddenWeekend):c.classList.remove(Ge.hiddenWeekend)}}))})}function PO(){var e,t,r;try{let n=window.journalitPlugin,o=(r=(t=(e=n==null?void 0:n.settings)==null?void 0:e.trade)==null?void 0:t.skipWeekends)!=null?r:!0;document.querySelectorAll(".journalit-dashboard-calendar").forEach(i=>{if(i instanceof HTMLElement){o?(i.classList.add("hide-weekends"),i.classList.add("weekends-hidden"),i.querySelectorAll(".journalit-dashboard-calendar-weekday").forEach(d=>{if(d instanceof HTMLElement){let u=d.getAttribute("data-day");u==="Sun"||u==="Sat"?d.classList.add(Ge.hiddenWeekend):d.classList.remove(Ge.hiddenWeekend)}})):(i.classList.remove("hide-weekends"),i.classList.remove("weekends-hidden"),i.querySelectorAll(".journalit-dashboard-calendar-weekday").forEach(d=>{d instanceof HTMLElement&&d.classList.remove(Ge.hiddenWeekend)})),i.classList.add(Ge.calendarContainer);let s=i.querySelector(".journalit-dashboard-calendar-header");s instanceof HTMLElement&&(s.classList.add(Ge.calendarHeaderGrid),o?s.classList.add(Ge.calendarHeaderGridWeekdays):s.classList.remove(Ge.calendarHeaderGridWeekdays)),i.querySelectorAll(".journalit-dashboard-calendar-week").forEach(c=>{c instanceof HTMLElement&&(c.classList.add(Ge.calendarWeekRowGrid),o?c.classList.add(Ge.calendarWeekRowGridWeekdays):c.classList.remove(Ge.calendarWeekRowGridWeekdays),c.querySelectorAll(".journalit-dashboard-calendar-weekly-pnl").forEach(u=>{if(u instanceof HTMLElement){u.classList.add(Ge.weeklyPnlCell);let p=u.querySelector(".journalit-dashboard-calendar-week-number");p instanceof HTMLElement&&p.classList.add(Ge.weekNumberPosition);let m=u.querySelector(".journalit-dashboard-calendar-weekly-pnl-value");m instanceof HTMLElement&&m.classList.add(Ge.weeklyPnlValue)}}))})}})}catch(n){console.error("Error applying consistent grid structure:",n)}}function jbe(e){try{let t=e.clientWidth,r=14,n=14,o=12,a=1;t<25?a=.55:t<30?a=.65:t<40?a=.75:t<50?a=.85:t>90?a=1.15:t>80&&(a=1.05);let i="50%",s="65%";return t<30?(i="40%",s="78%"):t<40?(i="42%",s="75%"):t<50?(i="44%",s="73%"):t<60?(i="46%",s="70%"):(i="48%",s="68%"),{dayNumber:`${Math.max(7,Math.round(r*a))}px`,pnlValue:`${Math.max(7,Math.round(n*(a*.95)))}px`,tradeCount:`${Math.max(6,Math.round(o*(a*.9)))}px`,pnlPosition:i,tradePosition:s}}catch(t){return console.error("Error calculating responsive sizes:",t),{dayNumber:"12px",pnlValue:"12px",tradeCount:"10px",pnlPosition:"50%",tradePosition:"65%"}}}function Al(){try{if(document.querySelectorAll(".journalit-dashboard-calendar").length===0)return;let t=document.querySelector(".journalit-dashboard-calendar-day");if(!t)return;let r=jbe(t);Obe(r),document.querySelectorAll(".journalit-dashboard-calendar-day").forEach(a=>{if(a instanceof HTMLElement){a.classList.add(Ge.responsiveCell);let i=a.querySelector(".journalit-dashboard-calendar-day-number");i instanceof HTMLElement&&i.classList.add(Ge.responsiveDayNumber);let s=a.querySelector(".journalit-dashboard-calendar-day-pnl");s instanceof HTMLElement&&s.classList.add(Ge.responsivePnlValue);let l=a.querySelector(".journalit-dashboard-calendar-day-trades");l instanceof HTMLElement&&l.classList.add(Ge.responsiveTradeCount)}}),document.querySelectorAll(".journalit-dashboard-calendar-weekly-pnl").forEach(a=>{if(a instanceof HTMLElement){a.classList.add(Ge.weeklyPnlRelative);let i=a.querySelector(".journalit-dashboard-calendar-week-number");i instanceof HTMLElement&&i.classList.add(Ge.responsiveWeekNumber);let s=a.querySelector(".journalit-dashboard-calendar-week-total-label");s instanceof HTMLElement&&s.classList.add(Ge.responsiveWeekLabel);let l=a.querySelector(".journalit-dashboard-calendar-week-total-value");l instanceof HTMLElement&&l.classList.add(Ge.responsiveWeekPnl);let c=a.querySelector(".journalit-dashboard-calendar-week-trade-count");c instanceof HTMLElement&&c.classList.add(Ge.responsiveWeekTrades)}})}catch(e){console.error("Error applying calendar cell styling:",e)}}function a0(){try{if(typeof ResizeObserver=="undefined"){console.warn("ResizeObserver not supported in this browser. Calendar responsive text might not work.");return}window.__journalitCalendarResizeObserver&&window.__journalitCalendarResizeObserver.disconnect();let e=null,t=new ResizeObserver(a=>{e&&clearTimeout(e),e=setTimeout(()=>{a.forEach(i=>{if(i.target instanceof HTMLElement){let s=i.contentRect,l=i.target.__lastCalendarSize;if(l&&Math.abs(s.width-l.width)<5&&Math.abs(s.height-l.height)<5)return;i.target.__lastCalendarSize={width:s.width,height:s.height}}}),Al()},150)});window.__journalitCalendarResizeObserver=t,document.querySelectorAll(".journalit-dashboard-calendar").forEach(a=>{t.observe(a)}),document.querySelectorAll(".journalit-dashboard-widget").forEach(a=>{a.querySelector(".journalit-dashboard-calendar")&&t.observe(a)}),document.querySelectorAll(".react-grid-item").forEach(a=>{a.querySelector(".journalit-dashboard-calendar")&&t.observe(a)}),Al(),setTimeout(Al,50),setTimeout(Al,200)}catch(e){console.error("Error setting up calendar resize observer:",e)}}function i0(){try{Fbe(),PO(),lG(),cG(),Al(),requestAnimationFrame(()=>{Al(),window.__journalitCalendarResizeObserver||a0()}),document.removeEventListener("dashboard-styles-updated",sG),document.addEventListener("dashboard-styles-updated",sG)}catch(e){console.error("Error applying calendar style fixes:",e)}}var Ge,sG,s0=L(()=>{Ge={calendarGrid:"journalit-calendar-grid-fix",calendarWeekRow:"journalit-calendar-week-row",calendarWeekRowWeekdays:"journalit-calendar-week-row-weekdays",calendarDayCell:"journalit-calendar-day-cell",todayDayCell:"journalit-calendar-today-cell",dayNumber:"journalit-calendar-day-num",pnlValue:"journalit-calendar-pnl-val",calendarHeader:"journalit-calendar-header-grid",calendarHeaderWeekdays:"journalit-calendar-header-weekdays",weekdayLabel:"journalit-calendar-weekday-label",hiddenWeekend:"journalit-calendar-hidden-weekend",calendarContainer:"journalit-calendar-container-flex",calendarHeaderGrid:"journalit-calendar-header-columns",calendarHeaderGridWeekdays:"journalit-calendar-header-columns-weekdays",calendarWeekRowGrid:"journalit-calendar-week-columns",calendarWeekRowGridWeekdays:"journalit-calendar-week-columns-weekdays",weeklyPnlCell:"journalit-calendar-weekly-pnl-cell",weekNumberPosition:"journalit-calendar-week-num-pos",weeklyPnlValue:"journalit-calendar-weekly-pnl-val",responsiveCell:"journalit-calendar-responsive-cell",responsiveDayNumber:"journalit-calendar-responsive-day-num",responsivePnlValue:"journalit-calendar-responsive-pnl",responsiveTradeCount:"journalit-calendar-responsive-trades",responsiveWeekNumber:"journalit-calendar-responsive-week-num",responsiveWeekLabel:"journalit-calendar-responsive-week-label",responsiveWeekPnl:"journalit-calendar-responsive-week-pnl",responsiveWeekTrades:"journalit-calendar-responsive-week-trades",weeklyPnlRelative:"journalit-calendar-weekly-relative",monthLabel:"journalit-dashboard-calendar-month-label"};sG=()=>{lG(),cG(),Al()}});function Iv(){let e=document.head.querySelector("#dashboard-styles"),t=document.createElement("style");t.id="dashboard-styles",t.textContent=zbe,e?(document.head.insertBefore(t,e),setTimeout(()=>e.remove(),0)):document.head.appendChild(t),_be()}function dG(){let e=document.head.querySelector("#dashboard-styles");if(e){let r=document.createElement("style");r.id="dashboard-styles-backup",r.textContent=e.textContent,document.head.appendChild(r),e.remove(),setTimeout(()=>{let n=document.head.querySelector("#dashboard-styles-backup");n&&n.remove()},50)}let t=document.head.querySelector("#dashboard-transparency-styles");t&&t.remove()}function Sd(){Iv(),setTimeout(()=>Iv(),50)}function Gf(){try{if(Iv(),!document.head.querySelector("#filter-layout-fix-styles")){let r=document.createElement("style");r.id="filter-layout-fix-styles",r.textContent=`
        /* Force filters section to stay compact and left-aligned */
        .journalit-dashboard-filters-section {
          display: flex !important;
          flex-direction: row !important;
          gap: 20px !important; /* Increased from 10px to 20px for more spacing */
          justify-content: flex-start !important;
          max-width: fit-content !important;
          flex-wrap: nowrap !important;
          margin-right: 0 !important; /* Changed from auto to prevent pushing buttons off alignment */
          align-items: center !important;
        }
        
        /* Ensure account filter has proper spacing from ticker filter */
        .journalit-dashboard-accounts-section {
          padding-left: 0 !important;
          flex: 0 0 auto !important;
          order: 2 !important;
        }
        
        /* Keep ticker filter on the left */
        .journalit-dashboard-tickers-section {
          flex: 0 0 auto !important;
          order: 1 !important;
        }
        
        /* Add spacing div to take remaining space */
        .journalit-dashboard-filters-spacer {
          flex: 1 1 auto !important;
          order: 3 !important;
        }
        
        /* Reset any existing flexbox layout for the filter row */
        .journalit-dashboard-filter-row {
          display: grid !important;
          grid-template-columns: auto 1fr auto !important;
          gap: 20px !important;
        }
        
        /* Force the action buttons to the right */
        .journalit-dashboard-filter-actions {
          justify-self: end !important;
          margin-left: auto !important;
        }
        
        /* Handle compact view filter styling */
        .journalit-dashboard-compact-filters {
          display: flex !important;
          flex-direction: row !important;
          gap: 10px !important;
          justify-content: flex-start !important;
          flex-wrap: nowrap !important;
          align-items: center !important;
        }
        
        /* Make sure compact view also has correct section styling with proper spacing */
        .journalit-dashboard-compact-filters .journalit-dashboard-tickers-section {
          margin: 0 !important;
          padding: 0 !important;
        }
        .journalit-dashboard-compact-filters .journalit-dashboard-accounts-section {
          margin: 0 0 0 20px !important;
          padding: 0 !important;
        }
        
        /* Force very high specificity for filter layout fixes */
        body .journalit-dashboard-view .journalit-dashboard-filter-controls .journalit-dashboard-filter-row .journalit-dashboard-filters-section {
        display: flex !important;
        flex-direction: row !important;
        gap: 20px !important;
        justify-content: flex-start !important;
        max-width: fit-content !important;
        flex-wrap: nowrap !important;
        margin-right: auto !important;
        }

          /* Ultra-high specificity rule to ensure buttons are properly aligned to the right */
          body .journalit-dashboard-view .journalit-dashboard-filter-controls .journalit-dashboard-filter-row .journalit-dashboard-filter-actions,
          html body .journalit-dashboard-view .journalit-dashboard-filter-controls .journalit-dashboard-filter-row.standard-responsive .journalit-dashboard-filter-actions,
          html body .journalit-dashboard-view .journalit-dashboard-filter-controls .journalit-dashboard-filter-row.compact .journalit-dashboard-filter-actions.button-container {
            justify-self: end !important;
            margin-left: auto !important;
          }
      `,document.head.appendChild(r)}[0,100,300,600,1200].forEach(r=>{setTimeout(()=>{let n=new CustomEvent("dashboard-styles-updated");if(document.dispatchEvent(n),!document.head.querySelector("#unified-component-selector-styles")){let a=document.createElement("style");a.id="unified-component-selector-styles",a.textContent=`
            .unified-selector-overlay {
              backdrop-filter: blur(3px) !important;
              z-index: 100000 !important;
              align-items: flex-start !important;
            }
            .journalit-dashboard-component-selector {
              animation: fadeInScale 0.25s cubic-bezier(0.19, 1, 0.22, 1) !important;
              box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2), 0 16px 64px rgba(0, 0, 0, 0.1) !important;
              border-radius: 12px !important;
              overflow: hidden !important;
              z-index: 100001 !important;
              margin-top: 100px !important;
            }
            /* Force specific spacing values */
            .journalit-dashboard-filter-controls {
              margin-bottom: 2px !important; /* Reduced from 10px */
            }
            .journalit-dashboard-unified-selector-button-container {
              margin-bottom: 4px !important;
              padding: 4px !important;
            }
            /* Set unified container gap to match screenshot */
            .journalit-dashboard-unified-container {
              background-color: transparent !important;
              box-shadow: none !important;
              gap: 2px !important; /* Reduced from 10px */
            }
            /* Make sure top and bottom sections have no visual separation and equal padding */
            .journalit-dashboard-top-section, 
            .journalit-dashboard-bottom-section {
              background-color: transparent !important;
              border-radius: 0 !important;
              box-shadow: none !important;
              padding: 0 !important;
            }
            /* Remove blur effects and apply transparent backgrounds to all dashboard elements */
            .journalit-dashboard-metric-card,
            .journalit-dashboard-metric-wrapper,
            .journalit-dashboard-widget,
            .react-grid-item,
            .journalit-dashboard-calendar, 
            .journalit-dashboard-calendar-grid,
            .journalit-dashboard-calendar-week,
            .journalit-dashboard-calendar-day,
            .journalit-dashboard-calendar-weekly-pnl,
            .journalit-dashboard-widget-content,
            .journalit-dashboard-widget-container,
            .journalit-chart-container,
            .recharts-wrapper,
            .recharts-surface {
              backdrop-filter: none !important;
              -webkit-backdrop-filter: none !important;
              background-color: transparent !important;
            }
            /* Category tabs - ensure they're centered */
            .journalit-dashboard-component-selector-categories {
              justify-content: center !important;
            }
            /* SVG close button styling for perfect centering */
            .journalit-dashboard-component-selector-close svg {
              width: 14px !important;
              height: 14px !important;
              display: block !important;
            }
            /* Ensure today highlighting is always applied */
            .journalit-dashboard-calendar-day.today {
              border: 2px solid var(--interactive-accent) !important;
              box-shadow: 0 0 6px rgba(var(--interactive-accent-rgb), 0.4) !important;
              position: relative !important;
              z-index: 2 !important;
            }
            /* Ensure the remove buttons don't pierce through the overlay */
            .journalit-dashboard-widget-remove,
            .journalit-dashboard-metric-wrapper .journalit-dashboard-widget-remove,
            .journalit-dashboard-widget .journalit-dashboard-widget-remove {
              z-index: 10000 !important; /* Lower than the overlay */
            }
            
            /* Ensure text in calendar cells can adjust responsively */
            .journalit-dashboard-calendar-day-number,
            .journalit-dashboard-calendar-day-pnl,
            .journalit-dashboard-calendar-week-number,
            .journalit-dashboard-calendar-weekly-pnl-value {
              transition: font-size 0.1s ease-out !important;
              /* Remove default !important font-size rules to allow dynamic sizing */
              font-size: unset !important;
            }
            
            /* Trade count text styling - keep smaller than PNL */
            .journalit-dashboard-calendar-day-trades,
            .journalit-dashboard-calendar-weekly-trades {
              transition: font-size 0.1s ease-out !important;
              font-size: 10px !important; /* Set default smaller size */
              color: var(--text-muted) !important;
              top: 70% !important; /* Position lower */
            }
            
            /* Special protection for specific elements that might get overridden */
            .journalit-dashboard-calendar .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-number,
            .journalit-dashboard-calendar .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-week-number,
            .journalit-dashboard-calendar .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-pnl,
            .journalit-dashboard-calendar .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-weekly-pnl-value {
              /* Further reset any default size rules to allow dynamically applied sizes */
              font-size: unset !important;
            }
          `,document.head.appendChild(a)}},r)});let t=(r,n)=>{setTimeout(()=>{try{a0(),Al(),n>0&&t(Math.min(r*1.5,1e3),n-1)}catch(o){console.error(`Error setting up calendar resize observer (attempt ${5-n}):`,o),n>0&&t(Math.min(r*1.5,1e3),n-1)}},r)};t(100,5),[100,300,500,800,1200].forEach(r=>{setTimeout(()=>{try{if(document.querySelectorAll(".journalit-dashboard-calendar").length>0){PO();let o=new CustomEvent("dashboard-styles-updated");document.dispatchEvent(o)}}catch(n){console.error(`Error in calendar-specific fixes at ${r}ms:`,n)}},r)})}catch(e){console.error("Error forcing dashboard styles:",e),Iv()}}function _be(){let e=document.head.querySelector("#dashboard-transparency-styles");e&&e.remove();let t=document.createElement("style");t.id="dashboard-transparency-styles",t.textContent=`
    /* Opaque mode - apply background colors */
    /* Keep widget headers transparent */
    .journalit-dashboard-widget-header,
    .journalit-dashboard-widget-minimal-header {
      background-color: transparent !important;
      border-bottom: 1px solid rgba(var(--background-modifier-border-rgb), 0.3) !important;
    }

    /* All components should have opaque background color */
    .journalit-dashboard-widget,
    .react-grid-item,
    .journalit-dashboard-metric-card,
    .journalit-chart-container,
    .journalit-dashboard-widget-container,
    .journalit-dashboard-calendar-day,
    .journalit-dashboard-calendar-weekly-pnl {
      background-color: var(--background-primary) !important;
    }

    /* Filter Controls opaque styling */
    .journalit-dashboard-filter-controls {
      background-color: var(--background-primary) !important;
      border: 1px solid rgba(var(--background-modifier-border-rgb, 0, 0, 0), 0.15) !important;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15) !important;
    }

    /* Style for filter buttons */
    .journalit-dashboard-date-range-presets button,
    .journalit-dashboard-reset-button,
    .journalit-dashboard-edit-mode-button {
      background-color: var(--background-primary) !important;
      border: 1px solid var(--background-modifier-border) !important;
    }

    /* Ensure dropdowns have opaque backgrounds */
    .journalit-dashboard-date-range-inputs,
    .journalit-dashboard-account-options-dropdown,
    .journalit-dashboard-ticker-options-dropdown {
      background-color: var(--background-primary) !important;
      border: 1px solid var(--background-modifier-border) !important;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1) !important;
    }

    /* Selected items in dropdowns should be highlighted properly */
    .journalit-dashboard-account-option-item input[type="checkbox"]:checked + span,
    .journalit-dashboard-ticker-option-item input[type="checkbox"]:checked + span {
      color: var(--interactive-accent) !important;
      font-weight: 600 !important;
    }

    /* Override positive/negative backgrounds to be more prominent against dark backgrounds */
    .journalit-dashboard-calendar-day.positive,
    .journalit-dashboard-calendar-weekly-pnl.positive {
      background-color: rgba(var(--color-green-rgb), 0.35) !important;
    }

    .journalit-dashboard-calendar-day.negative,
    .journalit-dashboard-calendar-weekly-pnl.negative {
      background-color: rgba(var(--color-red-rgb), 0.35) !important;
    }
    `,document.head.appendChild(t)}var zbe,Av=L(()=>{s0();zbe=`
  /* Base styling that applies regardless of transparency setting */
  /* Dashboard CSS variables */
  :root {
    /* Add background color variables for filled mode */
    --widget-bg-color: transparent;
    --metric-card-bg-color: transparent;
    --chart-bg-color: transparent;
    --calendar-day-bg-color: transparent;
    --calendar-weekday-bg-color: transparent;
    --interactive-accent-rgb: 94, 129, 172;
    --dashboard-dot-color: rgba(120, 120, 120, 0.15);
    --journalit-primary-filters-max-width: 700px;
  }

  /* Light theme specific dot color */
  .theme-light .journalit-dashboard-view {
    background-image: radial-gradient(circle, rgba(0, 0, 0, 0.1) 1px, transparent 1px) !important;
  }

  /* Dark theme specific dot color */
  .theme-dark .journalit-dashboard-view {
    background-image: radial-gradient(circle, rgba(255, 255, 255, 0.04) 1px, transparent 1px) !important;
  }

  /* Ensure no gap below view-header */
  .view-header {
    margin-bottom: 0 !important;
    padding-bottom: 0 !important;
  }
  
  /* Dashboard view container */
  .journalit-dashboard-view {
    width: 100% !important;
    height: 100% !important;
    display: flex !important;
    flex-direction: column !important;
    background-color: var(--background-primary) !important;
    background-size: 20px 20px !important;
    background-position: 0 0 !important;
    padding: 16px !important;
    overflow-x: hidden !important;
    overflow-y: auto !important;
    margin-top: 0 !important; /* Explicitly set to avoid unintended spacing */
  }
  
  /* Unified dashboard container for TopSection and BottomSection */
  .journalit-dashboard-unified-container {
    display: flex !important;
    flex-direction: column !important;
    gap: 2.5px !important; /* Set to half of the blue line gap (5px) */
    background-color: transparent !important;
    padding: 0 !important;
    flex: 1 1 0 !important; /* CRITICAL: Force height constraint like TradeLog fix */
    min-height: 0 !important; /* Prevent flexbox expansion */
    height: 0 !important; /* Force parent to control height */
  }
  
  /* Top metrics section */
  .journalit-dashboard-top-section {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 4px !important; /* Reduced from 16px to match grid layout gap */
    margin-bottom: 0 !important;
    padding: 4px !important; /* Reduced from 8px to reduce vertical spacing */
    background-color: transparent !important;
    border-radius: 0 !important;
    box-shadow: none !important;
  }
  
  /* Top metrics section styling */
  .journalit-dashboard-metrics {
    display: flex !important;
    flex-direction: row !important; /* Force horizontal layout */
    flex-wrap: wrap !important; /* Allow wrapping to new rows */
    gap: 8px !important; /* Consistent gap between cards */
    width: 100% !important; /* Ensure full width */
    overflow-x: hidden !important; /* No horizontal scrolling needed */
    overflow-y: visible !important; /* Allow vertical expansion */
    align-items: stretch !important; /* Make all cards the same height within each row */
    height: auto !important; /* Auto height based on content */
    min-height: auto !important; /* Let height be determined by content */
    padding: 10px 0 !important; /* Add some vertical padding */
    justify-content: flex-start !important; /* Align cards to the left */
  }
  
  /* Metric wrapper and card */
  .journalit-dashboard-metric-wrapper {
    position: relative !important;
    display: block !important;
    flex: 1 1 180px !important; /* Allow growing and shrinking with 180px base */
    min-width: 180px !important; /* Minimum width before wrapping */
    max-width: 300px !important; /* Maximum width to prevent cards from getting too wide */
  }
  
  /* We use the widget-remove button class for both widgets and metrics for consistency */
  .journalit-dashboard-widget-remove {
    position: absolute !important;
    top: 4px !important;
    right: 4px !important;
    background-color: var(--background-modifier-error) !important;
    color: white !important;
    border: none !important;
    border-radius: 50% !important;
    width: 22px !important;
    height: 22px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    font-size: 12px !important;
    cursor: pointer !important;
    z-index: 10000 !important; /* High, but lower than the overlay z-index */
    padding: 0 !important;
    font-weight: bold !important;
    line-height: 1 !important;
    pointer-events: auto !important;
    transition: opacity 0.2s ease, transform 0.2s ease !important;
    opacity: 0 !important; /* Hidden by default */
  }
  
  /* Show the remove button on widget hover in edit mode */
  .journalit-dashboard-grid-layout.is-editing .react-grid-item:hover .journalit-dashboard-widget-remove {
    opacity: 1 !important;
  }
  
  /* Show the remove button on metric hover in edit mode */
  .journalit-dashboard-top-section .journalit-dashboard-metric-wrapper:hover .journalit-dashboard-widget-remove {
    opacity: 1 !important;
  }
  
  /* Ensure the remove button is always clickable and has highest z-index */
  .journalit-dashboard-metric-wrapper .journalit-dashboard-widget-remove,
  .journalit-dashboard-widget .journalit-dashboard-widget-remove {
    pointer-events: auto !important;
    z-index: 100 !important; /* Reduced from 100000 to reasonable value */
  }
  
  .journalit-dashboard-widget-remove:hover {
    background-color: var(--text-error) !important;
    transform: scale(1.1) !important;
  }
  
  .journalit-dashboard-metric-card {
    flex: 1 1 180px !important; /* Allow growing and shrinking with 180px base */
    min-width: 180px !important;
    max-width: 300px !important; /* Prevent cards from getting too wide */
    padding: 14px !important;
    background-color: transparent !important;
    border-radius: 8px !important;
    border: 1px solid rgba(var(--background-modifier-border-rgb, 0, 0, 0), 0.08) !important;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04), 0 0 1px rgba(0, 0, 0, 0.08) !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: flex-start !important;
  }
  
  .journalit-dashboard-metric-name {
    font-size: 14px !important;
    font-weight: 600 !important;
    color: var(--text-muted) !important;
    margin-bottom: 6px !important;
    text-transform: uppercase !important;
    letter-spacing: 0.5px !important;
    text-align: left !important;
    width: 100% !important;
  }
  
  .journalit-dashboard-metric-value {
    font-size: 24px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    text-align: left !important;
    width: 100% !important;
  }
  
  .journalit-dashboard-metric-value.positive {
    color: var(--color-green) !important; /* Green for positive values */
  }
  
  .journalit-dashboard-metric-value.negative {
    color: var(--color-red) !important; /* Red for negative values */
  }
  
  /* Styling for cents in currency values */
  .journalit-dashboard-metric-cents {
    font-size: 16px !important;
    opacity: 0.7 !important;
    font-weight: 500 !important;
    margin-left: 1px !important;
    display: inline-block !important;
  }
  
  /* Filter controls - Redesigned for single row compact layout */
  .journalit-dashboard-filter-controls {
    display: flex !important;
    flex-direction: column !important;
    margin-bottom: 2.5px !important; /* Reduced from 5px to 2.5px (half of original) */
    padding: 12px 16px !important;
    background-color: var(--background-secondary) !important;
    border-radius: 8px !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15) !important;
    position: relative !important;
  }
  
  /* Filter row base styles */
  .journalit-dashboard-filter-row {
    display: grid !important;
    grid-template-columns: auto 1fr auto !important;
    gap: 20px !important;
    align-items: center !important; /* Change from flex-start to center */
    width: 100% !important;
  }
  
  /* Combined filters section */
  .journalit-dashboard-filters-section {
    display: flex !important;
    flex-direction: row !important;
    gap: 20px !important;
    align-items: center !important;
    min-width: 0 !important; /* Allow content to shrink if needed */
    flex: 1 !important;
  }
  
  .journalit-dashboard-date-range-section {
    display: flex !important;
    flex-direction: row !important;
    position: relative !important; /* Needed for absolute positioning of dropdown */
    /* Removed fixed min-width */
    flex: 1 !important;
    /* Changed from fixed margin to flexible margin */
    margin-right: 10px !important;
    margin-top: 0 !important; /* Ensure consistent alignment */
  }
  
  .journalit-dashboard-tickers-section,
  .journalit-dashboard-accounts-section {
    display: flex !important;
    flex-direction: row !important;
    /* Remove justify-self which can cause positioning issues */
    flex: 0 0 auto !important; /* Don't allow shrinking */
    margin-right: 10px !important;
    margin-top: 0 !important; /* Ensure consistent alignment */
  }
  
  .journalit-dashboard-filter-label {
    font-size: 13px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    margin-bottom: 4px !important;
    display: inline-block !important;
  }
  
  .journalit-dashboard-filter-actions {
    display: flex !important;
    align-items: center !important;
    /* Remove justify-self that can create issues */
    flex: 0 0 auto !important; /* Don't allow shrinking */
    gap: 8px !important; /* Changed from var(--button-gap) to explicit 8px */
    min-width: fit-content !important; /* Ensure buttons don't get squished */
    justify-self: end !important; /* Force align to the right in grid */
    margin-left: auto !important; /* Add auto margin to push to the right */
  }

  .journalit-dashboard-filter-actions > * {
    flex-shrink: 0 !important; /* Prevents button compression */
  }
  
  /* Special container for buttons in compact view */
  .journalit-dashboard-filter-actions.button-container {
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important; /* Changed from var(--button-gap) to explicit 8px */
  }
  
  /* Ensure buttons in compact view have consistent spacing */
  .journalit-dashboard-filter-actions.button-container .journalit-dashboard-reset-button,
  .journalit-dashboard-filter-actions.button-container .journalit-dashboard-edit-mode-button {
    margin-bottom: 0 !important;
    margin-top: 0 !important;
    height: 28px !important;
    line-height: 1 !important;
  }

  /* Dashboard header layout */
  .journalit-dashboard-header,
  .journalit-dashboard-header-compact {
    display: flex !important;
    flex-direction: row !important;
    align-items: center !important;
    justify-content: flex-start !important;
    gap: 16px !important;
    width: 100% !important;
    flex-wrap: wrap !important;
  }

  .journalit-dashboard-primary-filters {
    display: flex !important;
    align-items: center !important;
    flex: 0 1 auto !important;
    min-width: 0 !important;
    max-width: var(--journalit-primary-filters-max-width) !important;
  }

  /* Date range filter - More compact */
  .journalit-dashboard-date-range-filter {
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important;
    position: relative !important; /* Add this to ensure proper containment of the dropdown */
  }
  
  .journalit-dashboard-date-range-presets {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 6px !important;
    align-items: center !important;
  }
  
  .journalit-dashboard-date-range-presets button {
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    padding: 5px 10px !important;
    font-size: 12px !important;
    font-weight: 500 !important;
    color: var(--text-normal) !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
    height: 28px !important;
    line-height: 1 !important;
  }
  
  .journalit-dashboard-date-range-presets button:hover {
    background-color: var(--background-modifier-hover) !important;
    border-color: var(--interactive-accent) !important;
  }
  
  .journalit-dashboard-date-range-presets button.active {
    background-color: var(--interactive-accent) !important;
    color: var(--text-on-accent, white) !important;
    border-color: var(--interactive-accent) !important;
  }
  
  .journalit-dashboard-date-range-inputs {
    display: flex !important;
    gap: 10px !important;
    flex-wrap: nowrap !important; /* Keep horizontal layout */
    padding: 8px !important;
    background-color: var(--background-primary) !important;
    border-radius: 4px !important;
    border: 1px solid var(--background-modifier-border) !important;
    margin-top: 0 !important; /* Remove top margin */
    position: absolute !important;
    top: 0 !important; /* Align with the buttons horizontally */
    left: auto !important; /* Reset left positioning */
    right: -360px !important; /* Position to the right of buttons */
    z-index: 100 !important;
    width: 350px !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1) !important;
    transition: opacity 0.2s ease, transform 0.2s ease !important;
    opacity: 1 !important;
    transform: translateY(0) !important;
  }
  
  /* Animation for opening/closing the dropdown */
  .journalit-dashboard-date-range-inputs.date-dropdown-visible {
    animation: dateDropdownFadeIn 0.25s cubic-bezier(0.19, 1, 0.22, 1) !important;
  }
  
  @keyframes dateDropdownFadeIn {
    from {
      opacity: 0;
      transform: translateY(-5px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  /* Specific styling for custom date dropdown to make sure it appears in the right position */
  .journalit-dashboard-custom-date-dropdown {
    position: absolute !important;
    top: 0 !important; /* Position at the same level as buttons */
    left: auto !important;
    right: -360px !important; /* Position to the right of the custom button */
    z-index: 100 !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2) !important;
  }

  /* Position dropdown to the left when it would go off-screen */
  .journalit-dashboard-custom-date-dropdown.position-left {
    right: auto !important;
    left: -360px !important; /* Position to the left of the custom button */
  }

  /* Position below fallback for when horizontal space is insufficient */
  .journalit-dashboard-custom-date-dropdown.position-below {
    top: 100% !important;
    left: 0 !important;
    right: auto !important;
    margin-top: 8px !important;
    width: 100% !important;
    max-width: 360px !important;
    max-height: min(300px, 50vh) !important;
    overflow-y: auto !important;
    box-sizing: border-box !important;
  }

  .journalit-dashboard-date-range-start,
  .journalit-dashboard-date-range-end {
    flex: 1 !important;
    min-width: 150px !important;
  }
  
  .journalit-dashboard-date-range-start label,
  .journalit-dashboard-date-range-end label {
    display: block !important;
    font-size: 12px !important;
    margin-bottom: 4px !important;
    color: var(--text-muted) !important;
    font-weight: 500 !important;
  }
  
  /* Date picker input styling */
  .journalit-date-picker-input input {
    width: 100% !important;
    padding: 6px 10px !important;
    font-size: 13px !important;
    border-radius: 4px !important;
    border: 1px solid var(--background-modifier-border) !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    transition: border-color 0.2s ease, box-shadow 0.2s ease !important;
  }
  
  .journalit-date-picker-input input:focus {
    border-color: var(--interactive-accent) !important;
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2) !important;
    outline: none !important;
  }
  
  .journalit-date-picker-input input:hover {
    border-color: var(--interactive-hover) !important;
  }
  
  /* Account filter - New dropdown style */
  .journalit-dashboard-account-filter,
  .journalit-dashboard-ticker-filter {
    display: flex !important;
    flex-direction: column !important;
    /* Changed from fixed width to min-width for better responsiveness */
    min-width: 140px !important;
    max-width: 200px !important;
    width: 100% !important;
    position: relative !important;
  }
  
  /* Ensure filters within the combined section size properly */
  .journalit-dashboard-filters-section .journalit-dashboard-tickers-section {
    flex: 1 !important;
    min-width: 0 !important;
  }
  
  /* Responsive account/ticker filter class for enhanced appearance across screen sizes */
  .journalit-responsive-account-filter,
  .journalit-responsive-ticker-filter {
    width: auto !important;
    flex-shrink: 0 !important;
    /* Ensure dropdowns always fit content */
    white-space: nowrap !important;
    overflow: visible !important;
  }
  
  .journalit-dashboard-account-dropdown,
  .journalit-dashboard-ticker-dropdown,
  .journalit-dashboard-setup-dropdown {
    position: relative !important;
    width: 100% !important;
  }
  
  .journalit-dashboard-account-summary,
  .journalit-dashboard-ticker-summary,
  .journalit-dashboard-setup-summary {
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    padding: 5px 10px !important;
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    cursor: pointer !important;
    font-size: 0.9em !important;
    white-space: nowrap !important;
    gap: 8px !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
    min-width: 0 !important;
  }

  .journalit-dashboard-summary-text {
    flex: 1 !important;
    min-width: 0 !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
    white-space: nowrap !important;
  }

  .journalit-dashboard-account-summary:hover,
  .journalit-dashboard-ticker-summary:hover,
  .journalit-dashboard-setup-summary:hover {
    border-color: var(--interactive-accent) !important;
    background-color: var(--background-modifier-hover) !important;
  }

  .journalit-dashboard-account-summary:focus-visible,
  .journalit-dashboard-ticker-summary:focus-visible,
  .journalit-dashboard-setup-summary:focus-visible {
    outline: 2px solid var(--interactive-accent) !important;
    outline-offset: 2px !important;
  }
  
  .journalit-dashboard-account-summary .dropdown-arrow,
  .journalit-dashboard-ticker-summary .dropdown-arrow {
    font-size: 0.7em !important;
    color: var(--text-muted) !important;
  }
  
  .journalit-dashboard-account-options-dropdown,
  .journalit-dashboard-ticker-options-dropdown,
  .journalit-dashboard-setup-options-dropdown {
    position: absolute !important;
    top: 100% !important;
    left: 0 !important;
    right: 0 !important;
    max-height: min(300px, 50vh) !important;
    overflow-y: auto !important;
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    margin-top: 4px !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1) !important;
    z-index: 100 !important;
  }
  
  .journalit-dashboard-account-option-item,
  .journalit-dashboard-ticker-option-item,
  .journalit-dashboard-setup-option-item {
    display: flex !important;
    align-items: center !important;
    gap: 8px !important;
    padding: 6px 10px !important;
    cursor: pointer !important;
    font-size: 13px !important;
  }
  
  .journalit-dashboard-account-option-item:hover,
  .journalit-dashboard-ticker-option-item:hover,
  .journalit-dashboard-setup-option-item:hover {
    background-color: var(--background-modifier-hover) !important;
  }

  .journalit-dashboard-account-option-item:focus-visible,
  .journalit-dashboard-ticker-option-item:focus-visible,
  .journalit-dashboard-setup-option-item:focus-visible {
    outline: 2px solid var(--interactive-accent) !important;
    outline-offset: -2px !important;
  }

  .journalit-dashboard-account-option-item > span:last-child,
  .journalit-dashboard-ticker-option-item > span:last-child,
  .journalit-dashboard-setup-option-item > span:last-child {
    flex: 1 !important;
    min-width: 0 !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
    white-space: nowrap !important;
  }
  
  .journalit-dashboard-account-option-item.select-all,
  .journalit-dashboard-ticker-option-item.select-all {
    font-weight: 500 !important;
  }
  
  .journalit-dashboard-account-divider,
  .journalit-dashboard-ticker-divider,
  .journalit-dashboard-setup-divider {
    height: 1px !important;
    background-color: var(--background-modifier-border) !important;
    margin: 4px 0 !important;
  }
  
  /* No accounts/tickers message */
  .journalit-dashboard-no-accounts,
  .journalit-dashboard-no-tickers {
    padding: 12px !important;
    color: var(--text-muted) !important;
    font-style: italic !important;
    text-align: center !important;
    font-size: 13px !important;
  }

  /* Custom checkbox styling for Account, Ticker, and Setup filters */
  .journalit-dashboard-account-checkbox,
  .journalit-dashboard-ticker-checkbox,
  .journalit-dashboard-setup-checkbox {
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    width: 14px !important;
    height: 14px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 2px !important;
    background-color: var(--background-primary) !important;
    font-size: 10px !important;
    color: var(--text-on-accent) !important;
    flex-shrink: 0 !important;
  }

  .journalit-dashboard-account-checkbox.checked,
  .journalit-dashboard-ticker-checkbox.checked,
  .journalit-dashboard-setup-checkbox.checked {
    background-color: var(--interactive-accent) !important;
    border-color: var(--interactive-accent) !important;
  }

  /* Setup Filter Styles */
  .journalit-dashboard-setup-filter {
    display: flex !important;
    flex-direction: column !important;
    position: relative !important;
    min-width: 140px !important;
  }

  .journalit-dashboard-setup-dropdown-arrow {
    font-size: 0.7em !important;
    color: var(--text-muted) !important;
  }

  .journalit-dashboard-setup-option-all {
    font-weight: 500 !important;
  }

  .journalit-dashboard-reset-button {
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    padding: 5px 10px !important;
    font-size: 12px !important;
    font-weight: 500 !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
    white-space: nowrap !important;
    height: 28px !important;
    line-height: 1 !important;
  }
  
  .journalit-dashboard-reset-button:hover {
    background-color: var(--background-modifier-hover) !important;
    border-color: var(--interactive-accent) !important;
  }
  
  .journalit-dashboard-reset-button:disabled {
    opacity: 0.5 !important;
    cursor: default !important;
  }
  
  /* Grid layout container */
  .journalit-dashboard-bottom-section {
    width: 100% !important;
    min-height: 500px !important;
    background-color: transparent !important;
    border-radius: 0 !important;
    padding: 4px !important; /* Reduced from 8px to match top section */
    position: relative !important;
  }
  
  /* Widget styles */
  .journalit-dashboard-widget {
    background-color: transparent !important;
    border-radius: 6px !important;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1) !important;
    display: flex !important;
    flex-direction: column !important;
    overflow: hidden !important;
    /* backdrop-filter removed as requested */
  }
  
  /* Minimal widget header for non-edit mode */
  .journalit-dashboard-widget-minimal-header {
    display: flex !important;
    justify-content: center !important;
    align-items: center !important;
    padding: 4px 12px !important;
    height: 24px !important;
    background-color: transparent !important;
    border-bottom: 1px solid rgba(var(--background-modifier-border-rgb), 0.4) !important;
    opacity: 0.8 !important;
  }
  
  .journalit-dashboard-widget-minimal-header .journalit-dashboard-widget-title {
    font-weight: 500 !important;
    font-size: 13px !important;
    color: var(--text-muted) !important;
    letter-spacing: 0.3px !important;
    text-align: center !important;
    width: 100% !important;
    /* Add subtle text shadow for better readability */
    text-shadow: 0 1px 1px rgba(var(--background-primary-rgb), 0.8) !important;
  }
  
  .journalit-dashboard-widget-header {
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    padding: 12px 16px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
  }
  
  .journalit-dashboard-widget-title {
    font-size: 16px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
  }
  
  .journalit-dashboard-widget-controls {
    display: flex !important;
    gap: 8px !important;
  }
  
  .journalit-dashboard-widget-content {
    flex: 1 !important;
    padding: 4px 4px 2px 1px !important;
    overflow: hidden !important;
    background-color: transparent !important;
  }
  
  /* React Grid Layout styles */
  .react-grid-item {
    background-color: transparent !important;
    border-radius: 6px !important;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1) !important;
    /* backdrop-filter removed as requested */
  }
  
  .react-grid-item.react-grid-placeholder {
    background-color: var(--interactive-accent) !important;
    opacity: 0.3 !important;
  }
  
  .react-resizable-handle {
    position: absolute !important;
    bottom: 0 !important;
    right: 0 !important;
    width: 20px !important;
    height: 20px !important;
    background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="rgba(120, 120, 120, 0.5)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 22L12 12M22 13V22H13"></path></svg>') !important;
    background-position: bottom right !important;
    padding: 0 3px 3px 0 !important;
    background-repeat: no-repeat !important;
    background-origin: content-box !important;
    box-sizing: border-box !important;
    cursor: se-resize !important;
    display: none !important; /* Hide resize handles by default */
  }
  
  /* Only show resize handles when in edit mode */
  .journalit-dashboard-grid-layout.is-editing .react-resizable-handle {
    display: block !important;
  }
  
  /* Chart styles */
  .recharts-wrapper {
    width: 100% !important;
    height: 100% !important;
  }
  
  .recharts-cartesian-grid-horizontal line,
  .recharts-cartesian-grid-vertical line {
    stroke: var(--background-modifier-border) !important;
    stroke-dasharray: 2 !important;
  }
  
  /* Modern custom tooltip styles */
  .recharts-tooltip-wrapper {
    pointer-events: none !important;
    z-index: 1000 !important;
    filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.25)) !important;
    background-color: transparent !important;
    border: none !important;
  }
  
  .recharts-tooltip-wrapper * {
    outline: none !important;
  }
  
  .journalit-dashboard-custom-tooltip {
    background-color: var(--background-primary, #ffffff) !important;
    border-radius: 8px !important;
    padding: 12px 16px !important;
    min-width: 120px !important;
    border: 1px solid var(--background-modifier-border, rgba(0, 0, 0, 0.05)) !important;
    transform: translateY(-4px) !important;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15) !important;
    position: relative !important;
  }
  
  
  .journalit-dashboard-tooltip-date {
    font-size: 14px !important;
    font-weight: 500 !important;
    color: var(--text-normal, #333333) !important;
    margin-bottom: 6px !important;
    text-align: center !important;
  }
  
  .journalit-dashboard-tooltip-value {
    font-size: 18px !important;
    font-weight: 600 !important;
    text-align: center !important;
  }
  
  .journalit-dashboard-tooltip-value.positive {
    color: var(--text-success, #43a047) !important;
  }
  
  .journalit-dashboard-tooltip-value.negative {
    color: var(--text-error, #e53935) !important;
  }
  
  /* Calendar widget */
  .journalit-dashboard-calendar {
    width: 100% !important;
    height: 100% !important;
    display: flex !important;
    flex-direction: column !important;
    overflow: auto !important;
  }
  
  .journalit-dashboard-calendar-header {
    display: grid !important;
    grid-template-columns: repeat(7, 1fr) 1fr !important; /* 7 days + 1 P&L column */
    margin-bottom: 8px !important;
    gap: 4px !important;
    position: sticky !important;
    top: 0 !important;
    background-color: transparent !important;
    z-index: 5 !important;
    padding: 4px 0 !important;
    width: 100% !important;
    justify-content: stretch !important;
  }
  
  /* Special styling for when weekends are hidden */
  /* We apply the hide-weekends class directly to the header and week rows */
  .journalit-dashboard-calendar-header.hide-weekends,
  .journalit-dashboard-calendar .hide-weekends .journalit-dashboard-calendar-header,
  .journalit-dashboard-calendar.hide-weekends .journalit-dashboard-calendar-header,
  .journalit-dashboard-calendar.weekends-hidden .journalit-dashboard-calendar-header {
    grid-template-columns: repeat(5, 1fr) 1fr !important;
    width: 100% !important;
  }
  
  .journalit-dashboard-calendar-grid {
    display: flex !important;
    flex-direction: column !important;
    gap: 4px !important;
    flex: 1 !important;
    width: 100% !important;
  }
  
  .journalit-dashboard-calendar-week {
    display: grid !important;
    grid-template-columns: repeat(7, 1fr) 1fr !important; /* 7 days + 1 P&L column */
    gap: 4px !important;
    margin-bottom: 4px !important;
    width: 100% !important;
  }
  
  /* Special styling for when weekends are hidden */
  .journalit-dashboard-calendar-week.hide-weekends,
  .journalit-dashboard-calendar .hide-weekends .journalit-dashboard-calendar-week,
  .journalit-dashboard-calendar.hide-weekends .journalit-dashboard-calendar-week,
  .journalit-dashboard-calendar.weekends-hidden .journalit-dashboard-calendar-week {
    grid-template-columns: repeat(5, 1fr) 1fr !important;
    width: 100% !important;
  }
  
  /* Ensure the calendar container has proper styles */
  .journalit-dashboard-calendar.hide-weekends,
  .journalit-dashboard-calendar.weekends-hidden {
    width: 100% !important;
  }
  
  /* Ensure grid cells take up full width in their columns */
  .journalit-dashboard-calendar-day,
  .journalit-dashboard-calendar-weekly-pnl {
    width: 100% !important; 
  }
  
  /* Ensure P&L header is visible in both light and dark modes */
  .theme-light .journalit-dashboard-calendar-weekday.weekly-pnl-header {
    background-color: var(--interactive-accent, #5e81ac) !important; /* Use an accent background with fallback for better contrast */
    color: var(--text-on-accent, #ffffff) !important; /* Ensure text color is appropriate for accent background */
  }

  /* Weekly P&L column styles */
  .journalit-dashboard-calendar-weekly-pnl {
    aspect-ratio: 1 !important;
    position: relative !important;
    background-color: var(--background-secondary-alt) !important;
    border-radius: 8px !important;
    padding: 4px !important;
    border-left: 1px solid rgba(0, 0, 0, 0.08) !important;
    cursor: pointer !important;
    transition: transform 0.2s ease-out, box-shadow 0.2s ease-out !important;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05), 0 0 0 1px var(--background-modifier-border) !important;
    color: var(--text-normal) !important;
  }
  
  .journalit-dashboard-calendar-weekly-pnl:hover {
    transform: scale(1.05) !important;
  }
  
  .journalit-dashboard-calendar-weekly-pnl.positive {
    background-color: rgba(var(--color-green-rgb), 0.15) !important;
    color: var(--color-green) !important;
  }
  
  .journalit-dashboard-calendar-weekly-pnl.negative {
    background-color: rgba(var(--color-red-rgb), 0.15) !important;
    color: var(--color-red) !important;
  }
  
  /* Weekly totals positioning */
  .journalit-dashboard-calendar-week-total-label {
    font-size: 11px !important;
    font-weight: 600 !important;
    text-transform: uppercase !important;
    letter-spacing: 0.5px !important;
    color: var(--text-muted) !important;
    position: absolute !important;
    top: 25% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    width: 100% !important;
    text-align: center !important;
  }

  .journalit-dashboard-calendar-week-total-value {
    font-size: 13px !important;
    font-weight: 700 !important;
    position: absolute !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    width: 100% !important;
    text-align: center !important;
  }

  .journalit-dashboard-calendar-week-trade-count {
    font-size: 10px !important;
    color: var(--text-muted) !important;
    font-weight: 500 !important;
    position: absolute !important;
    bottom: 20% !important;
    left: 50% !important;
    transform: translate(-50%, 50%) !important;
    width: 85% !important;
    text-align: center !important;
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
  }
  
  .journalit-dashboard-calendar-day {
    aspect-ratio: 1 !important;
    display: flex !important;
    position: relative !important; /* Added for absolute positioning */
    border-radius: 8px !important;
    cursor: pointer !important;
    font-size: 12px !important;
    font-weight: 500 !important;
    transition: all 0.2s !important;
    background-color: var(--background-secondary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05) !important;
  }
  
  .journalit-dashboard-calendar-day:hover {
    transform: scale(1.05) !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1) !important;
  }
  
  .journalit-dashboard-calendar-day.positive {
    background-color: rgba(var(--color-green-rgb), 0.15) !important;
    background-image: linear-gradient(to bottom, rgba(var(--color-green-rgb), 0.05), rgba(var(--color-green-rgb), 0.2)) !important;
    color: var(--color-green) !important;
    border-color: rgba(var(--color-green-rgb), 0.3) !important;
    box-shadow: 0 2px 8px rgba(var(--color-green-rgb), 0.1) !important;
  }
  
  .journalit-dashboard-calendar-day.negative {
    background-color: rgba(var(--color-red-rgb), 0.15) !important;
    background-image: linear-gradient(to bottom, rgba(var(--color-red-rgb), 0.05), rgba(var(--color-red-rgb), 0.2)) !important;
    color: var(--color-red) !important;
    border-color: rgba(var(--color-red-rgb), 0.3) !important;
    box-shadow: 0 2px 8px rgba(var(--color-red-rgb), 0.1) !important;
  }
  
  .journalit-dashboard-calendar-day.positive:hover {
    box-shadow: 0 4px 12px rgba(var(--color-green-rgb), 0.2), 0 0 0 1px rgba(var(--color-green-rgb), 0.5) !important;
  }
  
  .journalit-dashboard-calendar-day.negative:hover {
    box-shadow: 0 4px 12px rgba(var(--color-red-rgb), 0.2), 0 0 0 1px rgba(var(--color-red-rgb), 0.5) !important;
  }
  
  .journalit-dashboard-calendar-day.other-month {
    opacity: 0.3 !important;
  }
  
  /* Day number positioning in the top-left */
  .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-number,
  .journalit-dashboard-calendar .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-number,
  .journalit-dashboard-calendar-grid .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-number {
    position: absolute !important;
    top: 4px !important;
    left: 4px !important;
    text-align: left !important;
    font-size: 12px !important;
    font-weight: 500 !important;
  }
  
  /* PNL value centered and larger */
  .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-pnl,
  .journalit-dashboard-calendar .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-pnl,
  .journalit-dashboard-calendar-grid .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-pnl {
    font-size: 12px !important; /* Increased from 10px */
    width: 100% !important;
    position: absolute !important;
    top: 46% !important; /* Moved slightly higher to make room for trade count */
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    margin-top: 0 !important;
    font-weight: 600 !important;
    text-align: center !important;
  }
  
  /* Trade count styling - smaller than PNL value */
  .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-trades,
  .journalit-dashboard-calendar .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-trades,
  .journalit-dashboard-calendar-grid .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-trades {
    font-size: 10px !important;
    width: 100% !important;
    position: absolute !important;
    top: 70% !important; /* Position further down for better separation */
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    margin-top: 0 !important;
    font-weight: 400 !important;
    text-align: center !important;
    color: var(--text-muted) !important;
  }
  
  /* Week number positioning in the top-left */
  .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-week-number,
  .journalit-dashboard-calendar .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-week-number,
  .journalit-dashboard-calendar-grid .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-week-number {
    position: absolute !important;
    top: 4px !important;
    left: 4px !important;
    text-align: left !important;
    font-size: 12px !important;
    font-weight: 500 !important;
    margin-bottom: 0 !important;
  }
  
  /* Weekly PNL value centered and larger */
  .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-weekly-pnl-value,
  .journalit-dashboard-calendar .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-weekly-pnl-value,
  .journalit-dashboard-calendar-grid .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-weekly-pnl-value {
    font-size: 12px !important; /* Increased from 10px */
    width: 100% !important;
    position: absolute !important;
    top: 46% !important; /* Moved slightly higher to make room for trade count */
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    font-weight: 600 !important;
    text-align: center !important;
  }
  
  /* Weekly trade count styling - smaller than PNL value */
  .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-weekly-trades,
  .journalit-dashboard-calendar .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-weekly-trades,
  .journalit-dashboard-calendar-grid .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-weekly-trades {
    font-size: 10px !important;
    width: 100% !important;
    position: absolute !important;
    top: 70% !important; /* Position further down for better separation */
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    font-weight: 400 !important;
    text-align: center !important;
    color: var(--text-muted) !important;
  }
  
  /* Recent Trades widget styles */
  .journalit-dashboard-recent-trades {
    width: 100% !important;
    height: 100% !important;
    overflow: auto !important;
    /* Remove top padding, keep padding on sides and bottom to prevent gap above sticky header */
    padding: 0 8px 8px 8px !important;
    position: relative !important;
  }
  
  .journalit-dashboard-recent-trades-table {
    width: 100% !important;
    border-collapse: collapse !important;
    /* Add padding to the top of the table to replace container's top padding */
    padding-top: 8px !important;
    margin-top: 0 !important;
  }
  
  .journalit-dashboard-recent-trades-table th {
    text-align: center !important;
    padding: 7px 8px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
    font-size: 12px !important;
    font-weight: 500 !important;
    color: var(--text-muted) !important;
    text-transform: uppercase !important;
    letter-spacing: 0.5px !important;
    position: sticky !important;
    top: 0 !important;
    background-color: var(--background-primary) !important;
    z-index: 10 !important;
  }

  .journalit-dashboard-recent-trades-table td {
    text-align: center !important;
    padding: 7px 8px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
    font-size: 13px !important;
  }
  
  .journalit-dashboard-recent-trades-table .trade-row {
    cursor: pointer !important;
    transition: background-color 0.15s ease !important;
  }

  .journalit-dashboard-recent-trades-table .trade-row:hover {
    background-color: var(--background-modifier-hover) !important;
  }
  
  .journalit-dashboard-recent-trades-table .ticker-cell {
    font-weight: 600 !important;
  }
  
  .journalit-dashboard-recent-trades-table .direction-cell {
    font-weight: 500 !important;
  }
  
  .journalit-dashboard-recent-trades-table .pnl-cell {
    font-weight: 600 !important;
  }
  
  .journalit-dashboard-recent-trades-table .pnl-cell.positive {
    color: var(--text-success) !important;
  }

  .journalit-dashboard-recent-trades-table .pnl-cell.negative {
    color: var(--text-error) !important;
  }
  
  .journalit-dashboard-recent-trades-table .empty-message {
    text-align: center !important;
    padding: 16px !important;
    color: var(--text-muted) !important;
    font-style: italic !important;
  }
  
  /* Today highlight styling with high specificity to prevent overrides */
  .journalit-dashboard-calendar-day.today,
  .journalit-dashboard-calendar .journalit-dashboard-calendar-day.today,
  .journalit-dashboard-calendar-grid .journalit-dashboard-calendar-day.today {
    border: 2px solid var(--interactive-accent) !important;
    box-shadow: 0 0 6px rgba(var(--interactive-accent-rgb), 0.4) !important;
    position: relative !important;
    z-index: 2 !important; /* Higher z-index to ensure the highlight is visible */
    animation: pulseBorder 2s infinite ease-in-out !important;
  }
  
  .journalit-dashboard-calendar-day.neutral {
    background-color: var(--background-secondary) !important;
    color: var(--text-muted) !important;
  }
  
  /* Table styles */
  .journalit-dashboard-trades-table {
    width: 100% !important;
    border-collapse: collapse !important;
  }
  
  .journalit-dashboard-trades-table th,
  .journalit-dashboard-trades-table td {
    padding: 8px 12px !important;
    text-align: left !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
  }
  
  .journalit-dashboard-trades-table th {
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    background-color: var(--background-secondary) !important;
    position: sticky !important;
    top: 0 !important;
    z-index: 1 !important;
  }
  
  .journalit-dashboard-trades-table tr:hover {
    background-color: var(--background-modifier-hover) !important;
  }
  
  /* Layout controls */
  .journalit-dashboard-layout-controls {
    display: flex !important;
    justify-content: flex-end !important;
    gap: 8px !important;
    margin-bottom: 16px !important;
  }
  
  /* Edit mode button in filter actions */
  .journalit-dashboard-edit-mode-button {
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    padding: 5px 10px !important;
    font-size: 12px !important;
    font-weight: 500 !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
    white-space: nowrap !important;
    height: 28px !important;
    line-height: 1 !important;
  }
  
  .journalit-dashboard-edit-mode-button:hover {
    background-color: var(--background-modifier-hover) !important;
    border-color: var(--interactive-accent) !important;
  }
  
  .journalit-dashboard-edit-mode-button.active {
    background-color: var(--interactive-accent) !important;
    color: var(--text-on-accent, white) !important;
    border-color: var(--interactive-accent) !important;
  }
  
  /* Loading and error states */
  .journalit-dashboard-loading,
  .journalit-dashboard-error {
    display: flex !important;
    justify-content: center !important;
    align-items: center !important;
    padding: 20px !important;
    font-size: 16px !important;
    color: var(--text-muted) !important;
  }
  
  .journalit-dashboard-error {
    color: var(--text-error) !important;
  }
  
  /* Responsive styles - comprehensive approach for all screen sizes */
  /* XL screens - new breakpoint to handle 1560px width */
  @media (max-width: 1560px) {
    /* Adjust filter controls for this specific breakpoint range */
    .journalit-dashboard-filter-row.standard-responsive {
      grid-template-columns: minmax(300px, auto) auto 1fr auto !important;
      gap: 10px !important;
    }
    
    /* Ensure filters section stays in one line */
    .journalit-dashboard-filters-section {
      flex-wrap: nowrap !important;
      max-width: fit-content !important;
      justify-content: flex-start !important;
    }
    
    /* Make sure account and ticker filters have adequate space and stay together */
    .journalit-dashboard-account-filter,
    .journalit-dashboard-ticker-filter {
      min-width: 140px !important;
    }
    
    /* Keep account filter next to ticker filter */
    .journalit-dashboard-accounts-section {
      margin-left: 0 !important;
      padding-left: 0 !important;
    }
    
    /* Ensure the row structure stays intact at this breakpoint */
    .journalit-dashboard-filter-section {
      width: 100% !important;
    }
    
    /* Adjust date range input position */
    .journalit-dashboard-date-range-inputs,
    .journalit-dashboard-custom-date-dropdown {
      right: -250px !important; /* Reduce the offset */
      width: 300px !important; /* Make it slightly smaller */
    }
  }
  
  /* Large screens */
  @media (max-width: 1200px) {
    /* Slightly reduce padding and margins for better fit */
    .journalit-dashboard-view {
      padding: 12px !important;
    }

    .journalit-dashboard-metric-card {
      min-width: 180px !important;
    }

    /* Ensure buttons remain visible on medium screens */
    .journalit-dashboard-filter-actions {
      gap: 6px !important;
    }

    .journalit-dashboard-filter-actions button {
      padding: 6px !important;
      min-width: auto !important;
    }
  }
  
  /* Medium screens */
  @media (max-width: 1000px) {
    /* Further reduce spacing */
    .journalit-dashboard-view {
      padding: 10px !important;
    }

    .journalit-dashboard-metric-card {
      min-width: 150px !important;
      padding: 12px !important;
    }

    .journalit-dashboard-metric-value {
      font-size: 20px !important;
    }

    /* Adjust date dropdown position */
    .journalit-dashboard-date-range-inputs,
    .journalit-dashboard-custom-date-dropdown {
      right: -100px !important;
    }

    /* Reduce date filter width on medium screens */
    .journalit-dashboard-primary-filters {
      max-width: 500px !important;
    }

    .journalit-dashboard-header,
    .journalit-dashboard-header-compact {
      gap: 12px !important;
    }
  }
  
  /* Medium-small screens - additional breakpoint */
  @media (max-width: 900px) {
    /* Ensure the filter controls container has appropriate padding */
    .journalit-dashboard-filter-controls {
      padding: 10px 12px !important;
    }
    
    /* At this size, begin transitioning to more compact layout */
    .journalit-dashboard-filter-row.standard-responsive {
      /* More aggressive column sizing to prevent overflow */
      grid-template-columns: 1fr auto auto !important;
      gap: 8px !important;
    }
    
    /* Further reduce right margin for date section */
    .journalit-dashboard-date-range-section {
      margin-right: 5px !important;
    }
    
    /* Make buttons more compact */
    /* Ensure buttons in compact tablet views align properly */
    .journalit-dashboard-filter-actions.button-container {
      gap: 8px !important; /* Changed from var(--button-gap) to explicit 8px */
    }
    
    /* Fixed height buttons in mobile view for consistent appearance */
    .journalit-dashboard-filter-controls.compact-view .journalit-dashboard-reset-button,
    .journalit-dashboard-filter-controls.compact-view .journalit-dashboard-edit-mode-button {
      height: 28px !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
    }
    
    .journalit-dashboard-reset-button,
    .journalit-dashboard-edit-mode-button {
      padding: 4px 8px !important;
      font-size: 11px !important;
    }
    
    /* Make account dropdown narrower */
    .journalit-dashboard-account-filter {
      min-width: 120px !important;
    }

    /* Reduce date filter width further */
    .journalit-dashboard-primary-filters {
      max-width: 450px !important;
    }

    .journalit-dashboard-header,
    .journalit-dashboard-header-compact {
      gap: 8px !important;
    }
  }

  /* Small tablet screens */
  @media (max-width: 768px) {
    /* Force compact view if not already applied by component */
    .journalit-dashboard-filter-controls:not(.compact-view) {
      /* Add a class to force compact view directly via CSS if needed */
      /* This is a backup in case the JS detection doesn't trigger properly */
    }
    
    /* Switch to vertical layout for filter controls */
    .journalit-dashboard-filter-row.standard-responsive,
    .journalit-dashboard-filter-row.medium-responsive,
    .journalit-dashboard-filter-row {
      grid-template-columns: 1fr !important;
      gap: 16px !important;
    }
    
    .journalit-dashboard-filter-row.compact,
    .journalit-dashboard-filter-row.medium-responsive {
      display: flex !important;
      flex-direction: column !important;
      width: 100% !important;
    }
    
    .journalit-dashboard-date-range-section,
    .journalit-dashboard-accounts-section,
    .journalit-dashboard-filter-actions,
    .journalit-dashboard-filter-section {
      width: 100% !important;
      margin: 8px 0 !important;
    }
    
    .journalit-dashboard-reset-button {
      margin: 5px 0 !important;
      width: 100% !important;
    }

    .journalit-dashboard-edit-mode-button {
      margin: 5px 0 !important;
    }
    
    .journalit-dashboard-account-filter {
      width: 100% !important;
    }
    
    /* Force full width on select dropdowns */
    .journalit-dashboard-account-dropdown,
    .journalit-dashboard-account-summary {
      width: 100% !important;
    }
    
    /* Ensure date range selector fits properly */
    .journalit-dashboard-date-range-section {
      margin-right: 0 !important;
      width: 100% !important;
      min-width: auto !important;
    }
    
    /* Handle date inputs on small screens */
    .journalit-dashboard-date-range-inputs,
    .journalit-dashboard-custom-date-dropdown {
      position: static !important;
      width: 100% !important;
      margin-top: 8px !important;
      flex-direction: column !important;
      box-shadow: none !important;
      left: auto !important;
      right: auto !important;
    }

    .journalit-dashboard-custom-date-dropdown.position-left,
    .journalit-dashboard-custom-date-dropdown.position-below {
      position: static !important;
      left: auto !important;
      right: auto !important;
    }
    
    /* Adjust metric cards for better small screen display */
    .journalit-dashboard-metrics {
      flex-wrap: wrap !important;
      justify-content: center !important;
    }
    
    .journalit-dashboard-metric-card {
      min-width: calc(50% - 8px) !important;
      max-width: none !important;
      flex: 0 0 calc(50% - 8px) !important;
      margin-bottom: 8px !important;
    }

    /* Compact button styling for small screens */
    .journalit-dashboard-filter-actions {
      gap: 4px !important;
      flex-wrap: nowrap !important;
    }

    .journalit-dashboard-filter-actions button {
      padding: 4px 6px !important;
      font-size: 11px !important;
    }

    .journalit-dashboard-edit-layout-button span {
      display: none !important; /* Hide "Edit Layout" text, show icon only */
    }
  }

  /* Mobile screens */
  @media (max-width: 480px) {
    /* Extremely compact layout for very small screens */
    .journalit-dashboard-view {
      padding: 8px !important;
    }
    
    /* Make sure the filter controls are completely vertical */
    .journalit-dashboard-filter-controls.compact-view {
      padding: 8px !important;
    }
    
    /* Full width metrics on mobile */
    .journalit-dashboard-metric-card {
      min-width: 100% !important;
      flex: 0 0 100% !important;
      margin-bottom: 8px !important;
    }
    
    /* Make buttons more touch-friendly */
    .journalit-dashboard-reset-button,
    .journalit-dashboard-edit-mode-button,
    .journalit-dashboard-add-component-button {
      padding: 10px !important;
      height: auto !important;
      min-height: 40px !important;
    }
    
    /* Ensure date presets fit on small screens */
    .journalit-dashboard-date-range-presets {
      flex-wrap: wrap !important;
      justify-content: center !important;
    }
    
    .journalit-dashboard-date-range-presets button {
      flex: 0 1 auto !important;
      margin: 2px !important;
      font-size: 11px !important;
      padding: 4px 8px !important;
    }
    
    /* Ensure the component selector fits on small screens */
    .journalit-dashboard-component-selector {
      width: 90vw !important;
      max-height: 80vh !important;
      margin-top: 50px !important;
    }

    /* Ultra-compact for very small screens */
    .journalit-dashboard-filter-actions {
      gap: 2px !important;
    }

    .journalit-dashboard-filter-actions button {
      padding: 4px !important;
    }
  }

  /* Extra small screens */
  @media (max-width: 360px) {
    /* Extreme space optimization */
    .journalit-dashboard-view {
      padding: 4px !important;
    }
    
    .journalit-dashboard-filter-controls {
      padding: 6px !important;
    }
    
    /* Minimize all padding and margins */
    .journalit-dashboard-top-section,
    .journalit-dashboard-bottom-section {
      padding: 2px !important;
    }
    
    /* Ensure date buttons are minimal but usable */
    .journalit-dashboard-date-range-presets button {
      padding: 3px 6px !important;
      font-size: 10px !important;
    }
  }

  /* Reduce date filter width on medium screens */
  @media screen and (max-width: 1160px) {
    .journalit-dashboard-primary-filters {
      max-width: 600px !important;
    }
  }

  /* Unified Component Selector */
  .unified-selector-overlay {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    background-color: rgba(0, 0, 0, 0.4) !important;
    backdrop-filter: blur(3px) !important;
    z-index: 1000 !important; /* Reduced from 100000 to prevent conflicts */
    display: flex !important;
    align-items: flex-start !important;
    justify-content: center !important;
    padding: 20px !important;
    pointer-events: none !important; /* Prevent blocking interactions */
  }
  
  .journalit-dashboard-component-selector {
    position: relative !important;
    margin-top: 100px !important;
    width: 480px !important;
    max-height: 75vh !important;
    overflow-y: auto !important;
    background-color: var(--background-primary) !important;
    border: 1px solid rgba(255, 255, 255, 0.08) !important;
    border-radius: 12px !important;
    overflow: hidden !important;
    z-index: 1001 !important; /* One higher than the overlay */
    pointer-events: auto !important; /* Ensure modal content is interactive */
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2), 0 16px 64px rgba(0, 0, 0, 0.1) !important;
    max-width: 90vw !important;
    animation: fadeInScale 0.25s cubic-bezier(0.19, 1, 0.22, 1) !important;
  }
  
  .journalit-dashboard-unified-selector-button-container {
    display: flex !important;
    justify-content: center !important;
    margin: 0 0 4px 0 !important; /* Reduced from 8px to 4px */
    padding: 4px !important; /* Reduced from 8px to 4px */
    background-color: transparent !important;
    border-radius: 8px !important;
    border: 1px dashed var(--background-modifier-border) !important;
  }
  
  .journalit-dashboard-add-component-button {
    background-color: var(--interactive-accent) !important;
    color: var(--text-on-accent, white) !important;
    border: none !important;
    border-radius: 6px !important;
    padding: 8px 16px !important;
    font-size: 14px !important;
    font-weight: 600 !important;
    cursor: pointer !important;
    display: flex !important;
    align-items: center !important;
    gap: 8px !important;
    transition: all 0.2s ease !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
  }
  
  .journalit-dashboard-add-component-button:hover {
    background-color: var(--interactive-accent-hover) !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
  }
  
  .journalit-dashboard-component-selector-header {
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    padding: 16px 20px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
    background-color: var(--background-secondary-alt) !important;
    border-radius: 12px 12px 0 0 !important;
  }
  
  .journalit-dashboard-component-selector-header h3 {
    font-size: 18px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    margin: 0 !important;
  }
  
  .journalit-dashboard-component-selector-close {
    width: 28px !important;
    height: 28px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    border-radius: 6px !important;
    background-color: var(--background-modifier-hover) !important;
    color: var(--text-muted) !important;
    transition: all 0.2s cubic-bezier(0.19, 1, 0.22, 1) !important;
    border: none !important;
    padding: 0 !important;
    cursor: pointer !important;
  }
  
  .journalit-dashboard-component-selector-close svg {
    width: 14px !important;
    height: 14px !important;
    display: block !important;
  }
  
  .journalit-dashboard-component-selector-close:hover {
    background-color: var(--background-modifier-error-hover) !important;
    color: white !important;
    transform: rotate(90deg) !important;
  }
  
  .journalit-dashboard-component-selector-search {
    padding: 12px 20px !important;
    position: relative !important;
  }
  
  .journalit-dashboard-component-selector-search input {
    width: 100% !important;
    padding: 10px 16px !important;
    border-radius: 8px !important;
    background-color: var(--background-modifier-form-field) !important;
    border: 1px solid var(--background-modifier-border) !important;
    font-size: 14px !important;
    transition: all 0.2s ease !important;
    color: var(--text-normal) !important;
  }
  
  .journalit-dashboard-component-selector-search input:focus {
    box-shadow: 0 0 0 2px var(--interactive-accent) !important;
    border-color: var(--interactive-accent) !important;
    outline: none !important;
  }
  
  .journalit-dashboard-component-selector-categories {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 8px !important;
    padding: 0 20px 12px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
    justify-content: center !important; /* Center tabs horizontally */
  }
  
  .journalit-dashboard-component-selector-category {
    border-radius: 20px !important;
    padding: 6px 14px !important;
    font-size: 13px !important;
    font-weight: 500 !important;
    background-color: var(--background-secondary) !important;
    color: var(--text-muted) !important;
    border: 1px solid transparent !important;
    transition: all 0.2s cubic-bezier(0.19, 1, 0.22, 1) !important;
    box-shadow: none !important;
    cursor: pointer !important;
  }
  
  .journalit-dashboard-component-selector-category:hover {
    background-color: var(--background-modifier-hover) !important;
    color: var(--text-normal) !important;
    transform: translateY(-1px) !important;
  }
  
  .journalit-dashboard-component-selector-category.active {
    background-color: var(--interactive-accent) !important;
    color: var(--text-on-accent, white) !important;
    font-weight: 600 !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 2px 8px rgba(var(--interactive-accent-rgb), 0.3) !important;
  }
  
  .journalit-dashboard-component-selector-list {
    padding: 16px 20px !important;
    max-height: 50vh !important;
    overflow-y: auto !important;
    scrollbar-width: thin !important;
  }
  
  .journalit-dashboard-component-selector-list h4 {
    font-size: 15px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    margin: 0 0 12px 0 !important;
    padding-bottom: 8px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
  }
  
  /* Enhanced component item cards */
  .journalit-dashboard-component-selector-item {
    background-color: var(--background-secondary) !important;
    border-radius: 10px !important;
    padding: 14px 16px !important;
    margin-bottom: 10px !important;
    cursor: pointer !important;
    position: relative !important;
    transition: all 0.25s cubic-bezier(0.19, 1, 0.22, 1) !important;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05) !important;
    border: 1px solid transparent !important;
  }
  
  .journalit-dashboard-component-selector-item:hover {
    transform: translateY(-2px) !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1) !important;
    background-color: var(--background-primary) !important;
    border-color: var(--interactive-accent) !important;
  }
  
  /* Component item content styling */
  .journalit-dashboard-component-selector-widget-name {
    font-size: 15px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    margin-bottom: 6px !important;
  }
  
  /* Visual divider to separate sections in the All tab */
  .journalit-dashboard-component-selector-divider {
    height: 1px !important;
    background-color: var(--background-modifier-border) !important;
    margin: 16px 0 20px !important;
    opacity: 0.7 !important;
  }
  
  .journalit-dashboard-component-selector-widget-description {
    font-size: 13px !important;
    color: var(--text-muted) !important;
    margin-bottom: 10px !important;
    line-height: 1.4 !important;
  }
  
  /* Enhanced category badge */
  .journalit-dashboard-component-selector-widget-category {
    display: inline-block !important;
    font-size: 11px !important;
    font-weight: 500 !important;
    color: var(--text-normal) !important;
    background-color: var(--background-secondary-alt) !important;
    padding: 3px 8px !important;
    border-radius: 12px !important;
    margin-top: 4px !important;
  }
  
  /* Enhanced status badge */
  .journalit-dashboard-component-selector-widget-badge {
    position: absolute !important;
    top: 12px !important;
    right: 12px !important;
    font-size: 11px !important;
    font-weight: 600 !important;
    color: white !important;
    background: linear-gradient(135deg, var(--text-success), #2e7d32) !important;
    padding: 3px 10px !important;
    border-radius: 12px !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
  }
  
  /* Empty list message */
  .journalit-dashboard-component-selector-empty {
    text-align: center !important;
    padding: 24px 0 !important;
    color: var(--text-muted) !important;
    font-style: italic !important;
    background-color: var(--background-secondary-alt) !important;
    border-radius: 8px !important;
    font-size: 14px !important;
  }
  
  /* Improved scrollbar for the component list */
  .journalit-dashboard-component-selector-list::-webkit-scrollbar {
    width: 8px !important;
  }
  
  .journalit-dashboard-component-selector-list::-webkit-scrollbar-track {
    background: transparent !important;
  }
  
  .journalit-dashboard-component-selector-list::-webkit-scrollbar-thumb {
    background-color: var(--background-modifier-border) !important;
    border-radius: 4px !important;
    border: 2px solid var(--background-primary) !important;
  }
  
  .journalit-dashboard-component-selector-list::-webkit-scrollbar-thumb:hover {
    background-color: var(--interactive-accent) !important;
  }
  
  /* Animation for the selector */
  @keyframes fadeInScale {
    from {
      opacity: 0;
      transform: scale(0.92);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }
  
  /* Animation for today's calendar cell */
  @keyframes pulseBorder {
    0% {
      box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2), 0 4px 12px rgba(var(--interactive-accent-rgb), 0.25);
    }
    50% {
      box-shadow: 0 0 0 4px rgba(var(--interactive-accent-rgb), 0.15), 0 4px 16px rgba(var(--interactive-accent-rgb), 0.3);
    }
    100% {
      box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2), 0 4px 12px rgba(var(--interactive-accent-rgb), 0.25);
    }
  }
  
  /* BaseWidget container styling */
  .journalit-dashboard-widget-container {
    background-color: transparent !important;
  }
  
  /* EmptyState integration with dashboard widgets */
  .journalit-dashboard-widget-container .journalit-empty-state {
    background-color: transparent !important;
    min-height: 140px !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    justify-content: center !important;
    width: 100% !important;
    height: 100% !important;
    margin: 0 auto !important;
    position: absolute !important; /* Position in the center of container */
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
  }
  
  .journalit-dashboard-widget-container .journalit-empty-state-icon {
    margin-bottom: 12px !important;
    color: var(--text-muted) !important;
    display: flex !important;
    justify-content: center !important;
    width: 100% !important;
  }
  
  .journalit-dashboard-widget-container .journalit-empty-state-message {
    font-size: 14px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    text-align: center !important;
    width: 100% !important;
  }
  
  .journalit-dashboard-widget-container .journalit-empty-state-submessage {
    font-size: 12px !important;
    color: var(--text-muted) !important;
    text-align: center !important;
    width: 100% !important;
  }
  
  /* Empty state in main dashboard view */
  .journalit-dashboard-view .journalit-empty-state {
    margin: 0 auto !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    justify-content: center !important;
    min-height: 200px !important;
    width: 100% !important;
  }
  
  /* Table cell EmptyState styling */
  .journalit-dashboard-recent-trades-table td .journalit-empty-state {
    padding: 16px !important;
    min-height: 100px !important;
    background-color: transparent !important;
  }
`});function $be(){let e=document.head.querySelector("#drc-note-styles");if(e){if(e.textContent&&e.textContent.trim().length>0)return;e.remove()}if(!window.__isInjectingStyles){window.__isInjectingStyles=!0;try{CO();let t=document.createElement("style");t.id="drc-note-styles",t.textContent=Bbe,document.head.appendChild(t)}catch(t){console.error("Error injecting DRCNote styles:",t)}finally{window.__isInjectingStyles=!1}}}function uG(){try{let e=document.head.querySelector("#drc-note-styles");if(e&&e.textContent&&e.textContent.trim().length>0)return;$be();let t="drc-critical-component-styles";if(!document.getElementById(t)){let r=document.createElement("style");r.id=t,r.innerHTML=`
        /* Critical styles for DRC component visibility */
        .journalit-drc-view {
          display: block !important;
          width: 100% !important;
          margin: 0 !important;
          padding: 0 !important;
          visibility: visible !important;
          opacity: 1 !important;
        }
        
        .journalit-drc-note-wrapper {
          display: block !important;
          width: 100% !important;
          margin: 0 !important;
          padding: 0 !important;
          visibility: visible !important;
          opacity: 1 !important;
        }
        
        .drc-container {
          display: block !important;
          width: 100% !important;
          box-sizing: border-box !important;
          visibility: visible !important;
          opacity: 1 !important;
        }
      `,document.head.appendChild(r)}}catch(e){console.error("Error ensuring DRCNote styles:",e);try{let t="drc-emergency-styles";if(!document.getElementById(t)){let r=document.createElement("style");r.id=t,r.innerHTML=`
          .journalit-drc-view, .journalit-drc-note-wrapper, .drc-container {
            display: block !important;
            width: 100% !important;
            visibility: visible !important;
            opacity: 1 !important;
          }
        `,document.head.appendChild(r)}}catch(t){console.error("Complete failure in DRCNote style system:",t)}}}var Bbe,pG=L(()=>{o0();Bbe=`
  /* DRC note view container - match Weekly Review pattern */
  .journalit-drc-view,
  .markdown-preview-view .journalit-drc-view {
    margin: 0 !important; /* Remove all margins */
    border-bottom: none !important; /* Remove bottom border causing extra space */
    padding: 0 !important; /* Remove all padding */
    display: block !important;
    width: 100% !important;
    z-index: 100 !important;
    /* Force visibility */
    visibility: visible !important;
    opacity: 1 !important;
    background-color: var(--background-primary) !important;
    /* Removed borders */
    border: none !important;
    border-radius: 8px !important;
    /* Ensure proper containment */
    position: relative;
    box-sizing: border-box;
    /* Prevent overlaps */
    contain: content;
    /* Ensure proper isolation from other views */
    isolation: isolate;
  }
  
  /* Add a fallback CSS pattern to highlight DRC notes */
  .markdown-preview-view > div:first-child:has(+ div:contains("type: drc")) {
    position: relative;
  }
  .markdown-preview-view > div:first-child:has(+ div:contains("type: drc"))::before {
    content: '';
    display: block;
    height: 5px;
    width: 100%;
    background-color: var(--color-secondary, var(--text-accent, var(--interactive-accent)));
    margin-bottom: 1rem;
    border-radius: 2px;
  }
  
  /* Main container - transparent to match Weekly Review */
  .drc-note-container {
    background-color: transparent; /* Remove background to match Weekly Review */
    border-radius: 0; /* Remove border radius to match Weekly Review */
    box-shadow: none; /* Remove shadow to match Weekly Review */
    margin: 0; /* Remove margin to match Weekly Review */
    overflow: hidden;
    position: relative;
    font-family: var(--font-interface, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif);
    /* Remove border to match Weekly Review */
    border: none;
    /* Ensure isolation */
    isolation: isolate;
    /* Create a new stacking context and force containment */
    contain: layout style paint;
    /* Ensure direct containment within parent */
    width: 100%;
    align-self: flex-start;
  }
  
  /* Header section with date and summary */
  .drc-note-header {
    padding: 1rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    background: linear-gradient(to right, var(--background-secondary), var(--background-primary));
    border-bottom: 1px solid var(--background-modifier-border);
  }
  
  .drc-note-date {
    font-size: 1.4rem;
    font-weight: 600;
    color: var(--text-normal);
  }
  
  .drc-note-summary {
    font-size: 1rem;
    color: var(--text-muted);
  }
  
  /* Tabs navigation */
  .drc-note-tabs {
    display: flex;
    padding: 0 1rem;
    border-bottom: 1px solid var(--background-modifier-border);
    background-color: var(--background-secondary);
  }
  
  .drc-note-tab-button {
    padding: 0.8rem 1.2rem;
    border: none;
    background: transparent;
    color: var(--text-muted);
    font-size: 0.9rem;
    font-weight: 600;
    cursor: pointer;
    position: relative;
    transition: color 0.2s;
  }
  
  .drc-note-tab-button:hover {
    color: var(--text-normal);
  }
  
  .drc-note-tab-button.active {
    color: var(--color-primary, var(--interactive-accent));
  }
  
  .drc-note-tab-button.active::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 2px;
    background-color: var(--color-primary, var(--interactive-accent));
    border-radius: 2px 2px 0 0;
  }
  
  /* Tab content container */
  .drc-note-content {
    padding: 1.5rem;
  }
  
  /* Section styling */
  .drc-note-section {
    margin-bottom: 2rem;
    background-color: var(--background-secondary);
    border-radius: var(--border-radius-md, 4px);
    padding: 1.2rem;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
  }
  
  .drc-note-section-title {
    font-size: 1.1rem;
    font-weight: 600;
    margin-top: 0;
    margin-bottom: 1rem;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--background-modifier-border);
    color: var(--text-normal);
    text-align: center;
  }
  
  .drc-note-empty-state {
    color: var(--text-muted);
    font-style: italic;
    text-align: center;
    padding: 1rem;
  }
  
  /* Checklist styling */
  .drc-note-checklist {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }
  
  .drc-note-checklist-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  
  .drc-note-checkbox {
    width: 18px;
    height: 18px;
    border: 2px solid var(--background-modifier-border);
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--color-success, #43a047);
    font-weight: bold;
    background-color: var(--background-primary);
  }
  
  .drc-note-checkbox.checked {
    background-color: var(--color-success-muted, rgba(67, 160, 71, 0.2));
    border-color: var(--color-success, #43a047);
  }
  
  /* Forecast styling */
  .drc-note-forecast {
    display: flex;
    flex-direction: column;
    gap: 0.8rem;
  }
  
  .drc-note-forecast-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  
  .drc-note-forecast-label {
    font-weight: 600;
    min-width: 80px;
    color: var(--text-muted);
  }
  
  .drc-note-forecast-value {
    color: var(--text-normal);
  }
  
  .drc-note-forecast-notes {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }
  
  .drc-note-forecast-notes p {
    margin: 0.5rem 0 0 0;
    padding-left: 80px;
    color: var(--text-normal);
  }
  
  /* Goals styling */
  .drc-note-goals ul {
    margin: 0;
    padding-left: 1.5rem;
  }
  
  .drc-note-goals li {
    margin-bottom: 0.5rem;
    color: var(--text-normal);
  }
  
  /* Trades styling */
  .drc-note-trades {
    width: 100%;
    border-radius: var(--border-radius-sm, 2px);
    overflow: hidden;
  }
  
  .drc-note-trades-header {
    display: grid;
    grid-template-columns: 2fr 1fr 1fr 2fr 1fr;
    background-color: var(--background-modifier-hover);
    font-weight: 600;
    color: var(--text-normal);
    font-size: 0.9rem;
  }
  
  .drc-note-trade-row {
    display: grid;
    transition: background-color 0.2s;
  }
  
  .drc-note-trade-row:hover {
    background-color: var(--background-primary-alt, var(--background-primary));
  }
  
  .drc-note-trade-cell {
    padding: 0.8rem;
    align-items: center;
  }
  
  .drc-note-trade-cell.profit {
    color: var(--color-success, #43a047);
  }
  
  .drc-note-trade-cell.loss {
    color: var(--color-error, #e53935);
  }
  
  .drc-note-trade-rating {
    padding: 0.3rem 0.5rem;
    font-weight: 600;
  }
  
  .drc-note-trade-rating.rating-a {
    background-color: rgba(102, 187, 106, 0.2);
    color: var(--color-success, #43a047);
  }
  
  .drc-note-trade-rating.rating-b {
    background-color: rgba(33, 150, 243, 0.2);
    color: var(--color-primary, #2196f3);
  }
  
  .drc-note-trade-rating.rating-c {
    background-color: rgba(247, 199, 90, 0.2);
    color: var(--text-warning);
  }
  
  .drc-note-trade-rating.rating-d, 
  .drc-note-trade-rating.rating-f {
    background-color: rgba(229, 57, 53, 0.2);
    color: var(--color-error, #e53935);
  }
  
  .drc-note-trade-rating.rating-none {
    background-color: var(--background-secondary-alt, var(--background-secondary));
    color: var(--text-muted);
  }
  
  /* Missed trades styling */
  .drc-note-missed-trades {
    display: flex;
    gap: 1rem;
  }
  
  .drc-note-missed-trade {
    padding: 0.8rem;
    background-color: var(--background-primary);
  }
  
  .drc-note-missed-trade-header {
    display: flex;
    border-bottom: 1px dashed var(--background-modifier-border);
  }
  
  .drc-note-missed-trade-instrument {
    font-weight: 600;
    color: var(--text-normal);
  }
  
  .drc-note-missed-trade-direction {
    color: var(--text-muted);
  }
  
  .drc-note-missed-trade-reason,
  .drc-note-missed-trade-notes {
    font-size: 0.9rem;
    margin-bottom: 0.3rem;
  }
  
  /* Review styling */
  .drc-note-grades {
    display: flex;
    margin-bottom: 1rem;
  }
  
  .drc-note-grade {
    display: flex;
    width: 120px;
  }
  
  .drc-note-grade-label {
    font-size: 0.8rem;
    margin-bottom: 0.5rem;
  }
  
  .drc-note-grade-value {
    font-size: 2rem;
    border-radius: 50%;
  }
  
  .drc-note-grade-value.grade-a {
    background-color: rgba(102, 187, 106, 0.2);
    color: var(--color-success, #43a047);
  }
  
  .drc-note-grade-value.grade-b {
    background-color: rgba(33, 150, 243, 0.2);
    color: var(--color-primary, #2196f3);
  }
  
  .drc-note-grade-value.grade-c {
    background-color: rgba(247, 199, 90, 0.2);
    color: var(--text-warning);
  }
  
  .drc-note-grade-value.grade-d,
  .drc-note-grade-value.grade-f {
    background-color: rgba(229, 57, 53, 0.2);
    color: var(--color-error, #e53935);
  }
  
  /* Review questions styling */
  .drc-note-review-questions {
    display: flex;
    flex-direction: column;
    gap: 1.2rem;
  }
  
  .drc-note-review-item {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }
  
  .drc-note-review-question {
    font-weight: 600;
    color: var(--text-normal);
  }
  
  .drc-note-review-answer {
    color: var(--text-normal);
    padding: 0.5rem 0 0.5rem 1rem;
  }
  
  .drc-note-review-answer em {
    color: var(--text-muted);
  }
  
  /* Responsive adjustments */
  @media (max-width: 768px) {
    .drc-note-trades-header,
    .drc-note-trade-row {
      grid-template-columns: 1fr 1fr 1fr;
    }
    
    .drc-note-trades-header > div:nth-child(4),
    .drc-note-trades-header > div:nth-child(5),
    .drc-note-trade-row > div:nth-child(4),
    .drc-note-trade-row > div:nth-child(5) {
      display: none;
    }
    
    .drc-note-missed-trades {
      flex-direction: column;
    }
  }
  
  /* Multiple view compatibility */
  .workspace-split.mod-vertical .journalit-drc-view {
    /* Adjust for vertical split layout */
    flex-shrink: 1;
  }
  
  /* Ensure the component doesn't get squished in narrow panes */
  .workspace-leaf-content .journalit-drc-view .drc-note-tabs {
    flex-wrap: wrap;
  }
  
  /* Prevent clipping of component in small panes */
  .workspace-leaf-content .journalit-drc-view .drc-note-container {
    min-width: 0;
  }
  
  /* Wrapper for the DRC note component */
  .journalit-drc-note-wrapper {
    margin: 0 !important;
    padding: 0 !important;
    border: none !important;
    z-index: 100 !important;
    display: block !important;
    width: 100% !important;
    height: auto !important;
    min-height: 50px !important;
  }
  
  /* Special class for properly mounted DRC components to aid detection */
  .drc-note-mounted {
    display: block !important;
    opacity: 1 !important;
    visibility: visible !important;
  }
`});var Wbe,l0,DO=L(()=>{Wbe=`
/* DRC Missed Trades Section Styles */
.drc-missed-trades-section {
  margin-bottom: 24px;
}

.drc-missed-trades-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
  gap: 12px;
  flex-wrap: wrap;
}

.drc-missed-trades-header h3 {
  margin: 0;
  color: var(--text-normal);
  font-size: 18px;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 8px;
}

.drc-missed-trades-count {
  color: var(--text-muted);
  font-weight: 400;
  font-size: 16px;
}

.drc-add-missed-trade-btn {
  padding: 8px 16px !important;
  font-size: 14px !important;
  white-space: nowrap;
  flex-shrink: 0;
}

.drc-missed-trades-content {
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  background-color: var(--background-primary);
  overflow: hidden;
}

.drc-missed-trades-list {
  max-height: 400px;
  overflow-y: auto;
}

.drc-missed-trade-item {
  padding: 16px;
  border-bottom: 1px solid var(--background-modifier-border-subtle);
  transition: background-color 0.2s ease;
}

.drc-missed-trade-item:last-child {
  border-bottom: none;
}

.drc-missed-trade-item:hover {
  background-color: var(--background-modifier-hover);
}

.drc-missed-trade-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
  gap: 12px;
}

.drc-missed-trade-main {
  display: flex;
  align-items: center;
  gap: 8px;
  flex: 1;
  min-width: 0;
}

.drc-missed-trade-icon {
  font-size: 18px;
  flex-shrink: 0;
}

.drc-missed-trade-instrument {
  font-weight: 600;
  color: var(--text-normal);
  font-size: 16px;
  flex-shrink: 0;
}

.drc-missed-trade-direction {
  color: var(--text-muted);
  font-size: 14px;
  text-transform: capitalize;
  flex-shrink: 0;
}

.drc-missed-trade-badge {
  background-color: var(--color-orange, #ff9500);
  color: white;
  padding: 2px 8px;
  border-radius: 12px;
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  flex-shrink: 0;
}

.drc-missed-trade-open-btn {
  background-color: var(--interactive-accent);
  color: white;
  border: none;
  padding: 6px 12px;
  border-radius: 4px;
  font-size: 13px;
  cursor: pointer;
  transition: all 0.2s ease;
  flex-shrink: 0;
}

.drc-missed-trade-open-btn:hover {
  background-color: var(--interactive-accent-hover);
  transform: translateX(2px);
}

.drc-missed-trade-details {
  display: flex;
  flex-direction: column;
  gap: 8px;
  color: var(--text-normal);
  font-size: 14px;
  line-height: 1.4;
}

.drc-missed-trade-setup,
.drc-missed-trade-reason {
  display: flex;
  gap: 8px;
  align-items: flex-start;
}

.drc-missed-trade-setup strong,
.drc-missed-trade-reason strong {
  color: var(--text-muted);
  font-weight: 500;
  flex-shrink: 0;
  min-width: 45px;
}

.drc-missed-trade-reason {
  font-style: italic;
  color: var(--text-muted);
}

/* Loading and Error States */
.drc-missed-trades-loading,
.drc-missed-trades-error {
  padding: 24px;
  text-align: center;
  color: var(--text-muted);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  background-color: var(--background-primary);
}

.drc-missed-trades-error {
  color: var(--text-error, #e53935);
}

.drc-retry-button {
  margin-top: 12px;
  padding: 8px 16px;
  background-color: var(--interactive-accent);
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
  transition: background-color 0.2s ease;
}

.drc-retry-button:hover {
  background-color: var(--interactive-accent-hover);
}

/* Empty State Styling Override for Missed Trades */
.drc-missed-trades-content .empty-state {
  padding: 32px 24px;
  background-color: transparent;
  border: none;
}

.drc-missed-trades-content .empty-state .empty-state-icon {
  color: var(--text-muted);
  opacity: 0.6;
}

.drc-missed-trades-content .empty-state .empty-state-message {
  color: var(--text-normal);
  font-size: 16px;
  font-weight: 500;
}

.drc-missed-trades-content .empty-state .empty-state-submessage {
  color: var(--text-muted);
  font-size: 14px;
  margin-top: 8px;
  line-height: 1.4;
}

/* Responsive Design */
@media (max-width: 600px) {
  .drc-missed-trades-header {
    flex-direction: column;
    align-items: stretch;
    gap: 12px;
  }
  
  .drc-missed-trade-header {
    flex-direction: column;
    align-items: stretch;
    gap: 8px;
  }
  
  .drc-missed-trade-main {
    flex-wrap: wrap;
    gap: 6px;
  }
  
  .drc-missed-trade-open-btn {
    align-self: flex-end;
    width: auto;
  }
  
  .drc-missed-trade-details {
    margin-top: 8px;
  }
}

/* Dark Theme Adjustments */
.theme-dark .drc-missed-trade-badge {
  background-color: var(--color-orange, #ff9500);
  color: var(--text-on-accent);
}

.theme-dark .drc-missed-trade-item:hover {
  background-color: var(--background-modifier-hover);
}

/* Integration with existing DRC styles */
.drc-section .drc-missed-trades-section {
  margin-bottom: 0; /* Remove extra margin when used inside drc-section */
}

.drc-section .drc-missed-trades-header h3 {
  margin-bottom: 0; /* Consistent with other DRC section headers */
}
`,l0=()=>{let e="drc-missed-trades-styles";if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=Wbe,document.head.appendChild(t)}});var AO={};Ko(AO,{ensureChartStyles:()=>IO,injectChartStyles:()=>YC,removeChartStyles:()=>EO});function YC(){try{if(document.head.querySelector("#journalit-chart-styles"))return;let t=document.createElement("style");t.id="journalit-chart-styles",t.textContent=Rbe,document.head.appendChild(t)}catch(e){console.error("Error injecting chart styles:",e)}}function EO(){try{let e=document.head.querySelector("#journalit-chart-styles");e&&e.remove()}catch(e){console.error("Error removing chart styles:",e)}}function IO(){YC()}var Rbe,c0=L(()=>{Rbe=`
/**
 * CSS Variables for chart colors & theming
 * These allow for consistent colors across all charts
 */
:root {
  /* Base chart colors with !important to ensure they're applied */
  --chart-positive: var(--text-success, #43a047) !important;
  --chart-negative: var(--text-error, #e53935) !important;
  --chart-neutral: var(--text-muted, #888888) !important;

  /* Chart background colors */
  --chart-positive-bg: rgba(67, 160, 71, 0.2) !important;
  --chart-negative-bg: rgba(229, 57, 53, 0.2) !important;

  /* Animation timings */
  --chart-animation-duration: 0.8s;
  --chart-animation-function: cubic-bezier(0.19, 1, 0.22, 1);
}

/**
 * Chart container styles
 */
.journalit-chart-container {
  width: 100%;
  height: 100%;
  overflow: hidden;
  border-radius: 8px;
  background-color: transparent;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
  padding: 4px;
}

/**
 * Enhanced tooltip styles
 */
.journalit-chart-tooltip {
  background-color: var(--background-primary);
  border-radius: 10px;
  padding: 14px 18px;
  min-width: 140px;
  border: 1px solid var(--background-modifier-border);
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
  transform: translateY(-4px);
  position: relative;
  animation: tooltipFadeIn 0.2s var(--chart-animation-function);
  z-index: 1000;
}

/* Tooltip date */
.journalit-chart-tooltip-date {
  font-size: 14px;
  font-weight: 500;
  color: var(--text-normal);
  margin-bottom: 8px;
  text-align: center;
  border-bottom: 1px solid var(--background-modifier-border);
  padding-bottom: 6px;
}

/* Main tooltip value */
.journalit-chart-tooltip-value {
  font-size: 20px;
  font-weight: 600;
  text-align: center;
}

.journalit-chart-tooltip-value.positive {
  color: var(--chart-positive);
}

.journalit-chart-tooltip-value.negative {
  color: var(--chart-negative);
}

/* Additional tooltip info */
.journalit-chart-tooltip-info {
  font-size: 12px;
  color: var(--text-muted);
  margin-top: 8px;
  text-align: center;
  font-style: italic;
}

/* Tooltip animation */
@keyframes tooltipFadeIn {
  from {
    opacity: 0;
    transform: translateY(-8px);
  }
  to {
    opacity: 1;
    transform: translateY(-4px);
  }
}

/**
 * Chart SVG elements styling
 */
.recharts-cartesian-grid-horizontal line,
.recharts-cartesian-grid-vertical line {
  stroke: var(--background-modifier-border);
  stroke-opacity: 0.4;
  stroke-dasharray: 3;
}

.recharts-reference-line line {
  stroke: var(--text-normal);
  stroke-opacity: 0.4;
  stroke-dasharray: 3;
  stroke-width: 1.5;
}

/* Ensure profit target line is always green */
.recharts-reference-line.profit-target-line line {
  stroke: var(--chart-positive, var(--text-success, #00b300)) !important;
  stroke-opacity: 1 !important;
  stroke-dasharray: 5 5 !important;
  stroke-width: 2 !important;
}

/* Ensure profit target line label is also green */
.recharts-reference-line.profit-target-line text {
  fill: var(--chart-positive, var(--text-success, #00b300)) !important;
}

/* Axis styling */
.recharts-xAxis .recharts-cartesian-axis-line,
.recharts-yAxis .recharts-cartesian-axis-line {
  stroke: var(--background-modifier-border);
  stroke-opacity: 0.5;
}

.recharts-cartesian-axis-tick-value {
  font-size: 11px;
  font-weight: 500;
  fill: var(--text-muted);
}

/* Active dot styling */
.recharts-active-dot circle,
.recharts-active-dot {
  fill: var(--interactive-accent, #4299e1);
  filter: drop-shadow(0 0 3px rgba(66, 153, 225, 0.6));
}

/* Ensure tooltip position is fixed */
.recharts-tooltip-wrapper {
  pointer-events: none;
  z-index: 1000;
  filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.25));
}

/**
 * Bar chart specific styling
 */
.recharts-bar {
  cursor: pointer;
  transition: opacity 0.3s ease;
}

.recharts-bar-rectangle {
  transition: filter 0.3s ease, transform 0.2s ease;
}

.recharts-bar-rectangle:hover {
  filter: brightness(1.1) drop-shadow(0 0 3px rgba(0, 0, 0, 0.2));
  transform: translateY(-2px);
}

/* Apply rounded corners to bar chart bars */
.recharts-bar-rectangle path {
  border-radius: 2px 2px 0 0;
}

/* Ensure bar chart colors are applied correctly */
.recharts-bar-rectangle[fill^="var(--chart-positive)"] path {
  fill: var(--chart-positive) !important;
}

.recharts-bar-rectangle[fill^="var(--chart-negative)"] path {
  fill: var(--chart-negative) !important;
}

/* Active bar styling */
.recharts-bar-rectangle.recharts-active {
  filter: brightness(1.2) drop-shadow(0 0 6px rgba(0, 0, 0, 0.3));
}

/* Enhanced cursor area for better touch experience */
.recharts-layer.recharts-bar-graphical {
  cursor: pointer;
}

/* Animations for bar charts */
@keyframes barFadeIn {
  from {
    opacity: 0;
    transform: scaleY(0.8);
  }
  to {
    opacity: 1;
    transform: scaleY(1);
  }
}

.recharts-bar-rectangle {
  /* Animation removed to prevent conflict with Recharts' built-in animations */
}

/**
 * Calendar specific animations and styles
 */
@keyframes calendarFadeIn {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes pulseBorder {
  0% {
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2), 0 4px 12px rgba(var(--interactive-accent-rgb), 0.25);
  }
  50% {
    box-shadow: 0 0 0 3px rgba(var(--interactive-accent-rgb), 0.3), 0 4px 15px rgba(var(--interactive-accent-rgb), 0.35);
  }
  100% {
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2), 0 4px 12px rgba(var(--interactive-accent-rgb), 0.25);
  }
}

/* Enhanced today indicator with pulse effect */
.journalit-dashboard-calendar-day.today {
  animation: pulseBorder 2s infinite ease-in-out;
  border: 2px solid var(--interactive-accent) !important;
  z-index: 2 !important;
}

/* Calendar cell hover effect */
.journalit-dashboard-calendar-day:hover,
.journalit-dashboard-calendar-weekly-pnl:hover {
  transform: scale(1.05) !important;
  transition: transform 0.2s ease-out, box-shadow 0.2s ease-out, opacity 0.2s ease-out !important;
  opacity: 1 !important;
  z-index: 5 !important;
}
`});var mG={};Ko(mG,{ensureSharedComponentStyles:()=>Yf,injectSharedComponentStyles:()=>KC,removeSharedComponentStyles:()=>LO});function KC(){if(document.head.querySelector("#shared-component-styles"))return;let e=document.createElement("style");e.id="shared-component-styles",e.textContent=Ube,document.head.appendChild(e)}function LO(){let e=document.head.querySelector("#shared-component-styles");e&&e.remove()}function Yf(){document.head.querySelector("#shared-component-styles")||KC()}var Ube,d0=L(()=>{Ube=`
  /**
  * Container Styles for Reviews
  * Remove unused space - but preserve content area padding
  */
  .review-base-container {
    padding: 0 !important;
    margin: 0 !important;
  }

  /**
  * Navigation Styles
  * Used for navigating between reviews
  */
  .drc-navigation, .weekly-review-navigation, .daily-report-card-navigation {
    width: 100%;
    padding-top: 10px;
    border-top: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1));
  }
  
  .drc-navigation-links, .weekly-review-navigation-links, .daily-report-card-navigation-links {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 8px;
    flex-wrap: wrap;
    width: 100%;
  }
  
  .drc-navigation-button, .weekly-review-navigation-button, .daily-report-card-navigation-button {
    padding: 8px 14px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    cursor: pointer;
    font-size: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    flex: 1;
    text-align: center;
    min-width: 120px;
    box-sizing: border-box;
  }
  
  .drc-navigation-button:hover, .weekly-review-navigation-button:hover, .daily-report-card-navigation-button:hover {
    background-color: var(--background-modifier-hover);
  }
  
  .drc-navigation-button:disabled, .weekly-review-navigation-button:disabled, .daily-report-card-navigation-button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
  
  .nav-icon {
    font-size: 14px;
    line-height: 1;
  }

  /**
  * Goal Tracker Styles
  * Used for goal tracking in DRC and Weekly Review
  */
  .shared-goal-tracker h3 {
    font-size: 1rem !important;
    margin-top: 1rem !important;
    margin-bottom: 0.75rem !important;
    text-align: center !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    padding-bottom: 0.5rem !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
  }

  /* Special styling for Weekly Review's "Previous Week Goals" header */
  .weekly-review-previous-goals h3,
  .weekly-review-preparation .weekly-review-section h3 {
    font-size: 1rem !important;
    margin-top: 1rem !important;
    margin-bottom: 0.75rem !important;
    text-align: center !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    padding-bottom: 0.5rem !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
  }

  .shared-goal-tracker-list {
    display: flex !important;
    flex-direction: column !important;
    gap: 0.5rem !important;
    margin-top: 0.75rem !important;
    padding: 0.5rem !important;
    background-color: var(--background-secondary) !important;
    border-radius: 4px !important;
  }

  .shared-goal-item {
    display: flex !important;
    align-items: center !important;
    gap: 0.5rem !important;
    padding: 0.5rem !important;
    background-color: var(--background-primary) !important;
    border-radius: 4px !important;
    border: 1px solid var(--background-modifier-border) !important;
    cursor: pointer !important;
  }

  .shared-goal-item:hover {
    background-color: var(--background-modifier-hover) !important;
  }

  .shared-goal-checkbox {
    margin: 0 !important;
  }

  .shared-goal-text {
    flex: 1 !important;
    font-size: 0.95rem !important;
  }

  .shared-goal-text.completed {
    text-decoration: line-through !important;
    opacity: 0.7 !important;
    color: var(--text-muted) !important;
  }
  
  /**
  * Empty State Component Styles
  * Used for displaying a friendly message when no data is available
  */
.journalit-empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 24px;
  text-align: center;
  background-color: var(--background-secondary);
  border-radius: 8px;
  min-height: 160px;
  width: 100%;
  height: 100%; /* Added to ensure full height usage */
  color: var(--text-muted);
  animation: fadeIn 0.3s ease-out;
  margin: 0 auto; /* Added to ensure horizontal centering */
}

.journalit-empty-state-icon {
  margin-bottom: 16px;
  opacity: 0.6;
  color: var(--text-muted);
  display: flex; /* Added to ensure icon is centered */
  justify-content: center; /* Added to ensure icon is centered */
}

.journalit-empty-state-content {
  max-width: 280px;
  display: flex; /* Added for better content alignment */
  flex-direction: column; /* Stack content vertically */
  align-items: center; /* Center content horizontally */
  justify-content: center; /* Center content vertically */
}

  .journalit-empty-state-message {
    font-size: 16px;
    font-weight: 500;
    margin: 0 0 8px 0;
    color: var(--text-normal);
  }

  .journalit-empty-state-submessage {
    font-size: 13px;
    opacity: 0.8;
    margin: 0 0 16px 0;
    color: var(--text-muted);
  }
  
  .journalit-empty-state-action-button {
    background-color: var(--interactive-accent) !important;
    color: var(--text-on-accent) !important;
    border: none !important;
    border-radius: 6px !important;
    padding: 0 16px !important;
    font-size: 14px !important;
    font-weight: 600 !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
    margin-top: 16px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    min-width: 120px !important;
    height: 36px !important;
    line-height: 1 !important;
  }
  
  .journalit-empty-state-action-button:hover {
    background-color: var(--interactive-accent-hover) !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
  }

  /* Animation for empty state */
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* Chart-specific empty state styling */
  .journalit-chart-container .journalit-empty-state {
    background-color: transparent;
    border: 1px dashed var(--background-modifier-border);
  }

  /* Table-specific empty state styling */
  .journalit-table-container .journalit-empty-state {
    min-height: 120px;
    padding: 16px;
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
    .journalit-empty-state {
      padding: 16px;
      min-height: 140px;
    }
    
    .journalit-empty-state-icon {
      margin-bottom: 12px;
    }
    
    .journalit-empty-state-message {
      font-size: 14px;
    }
  }

  /**
   * Review Button Styles
   * Shared component for marking content as reviewed
   */
  .review-button-container {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-top: 16px;
  }

  .review-button {
    min-width: 140px;
  }

  .review-timestamp {
    font-size: 0.85em;
    color: var(--text-muted);
    font-style: italic;
  }

  /* Review sections for different review types */
  .drc-eod-review-button-section,
  .weekly-review-mark-reviewed-section,
  .monthly-review-mark-reviewed-section,
  .trade-note-review-section {
    margin-top: 24px;
    padding-top: 20px;
    border-top: 1px solid var(--background-modifier-border);
    display: flex;
    justify-content: center;
    align-items: center;
  }

  /* Ensure consistent styling for the review button in all contexts */
  .drc-eod-review-button-section .review-button-container,
  .weekly-review-mark-reviewed-section .review-button-container,
  .monthly-review-mark-reviewed-section .review-button-container,
  .trade-note-review-section .review-button-container {
    margin-top: 0;
  }

  /**
   * Loading Spinner Styles
   * Shared loading component with animated spinner
   */
  .journalit-loading-spinner {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    padding: 16px;
  }
  
  /* Ensure our spinner is not affected by other spinner styles */
  .journalit-loading-spinner .journalit-spinner-icon::before,
  .journalit-loading-spinner .journalit-spinner-icon::after {
    display: none !important;
  }

  .journalit-loading-spinner.small {
    padding: 8px;
    gap: 8px;
  }

  .journalit-loading-spinner.large {
    padding: 24px;
    gap: 16px;
  }

  .journalit-loading-spinner .journalit-spinner-icon {
    border: 2px solid var(--background-modifier-border);
    border-top-color: var(--interactive-accent);
    border-radius: 50%;
    animation: journalit-spin 0.6s linear infinite;
    flex-shrink: 0;
    /* Ensure perfect circle */
    min-width: var(--spinner-size, 24px);
    min-height: var(--spinner-size, 24px);
    max-width: var(--spinner-size, 24px);
    max-height: var(--spinner-size, 24px);
  }

  .journalit-loading-spinner .loading-message {
    color: var(--text-muted);
    font-size: 14px;
  }

  .journalit-loading-spinner.small .loading-message {
    font-size: 12px;
  }

  .journalit-loading-spinner.large .loading-message {
    font-size: 16px;
  }

  /* Fullscreen loading state */
  .journalit-loading-fullscreen {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
    min-height: 200px;
  }

  /* Overlay loading state */
  .journalit-loading-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.02);
    display: flex;
    align-items: center;
    justify-content: center;
    pointer-events: none;
    z-index: 10;
  }

  .journalit-loading-overlay-content {
    padding: 8px 16px;
    background-color: var(--background-primary);
    border-radius: 6px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  /* Spinner animation */
  @keyframes journalit-spin {
    to { transform: rotate(360deg); }
  }
`});function NO(){if(document.getElementById("journalit-combobox-styles"))return;let e=document.createElement("style");e.id="journalit-combobox-styles",e.textContent=Vbe,document.head.appendChild(e)}function fG(){let e=document.getElementById("journalit-combobox-styles");e&&e.remove()}function JC(){document.getElementById("journalit-combobox-styles")||NO()}var Vbe,MO=L(()=>{Vbe=`
/**
 * ComboBox component styles for better performance
 * Replaces inline styles with CSS classes
 */

/* Base ComboBox container */
.combobox-container {
  position: relative;
  width: 100%;
  margin-bottom: 8px;
  /* Use initial z-index, modified via inline style when open */
}

/* Input container */
.input-container {
  position: relative;
  width: 100%;
}

/* Add dropdown indicator with CSS pseudo-element for better performance */
.input-container::after {
  content: "";
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  width: 0;
  height: 0;
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
  border-top: 5px solid var(--text-normal, #333);
  pointer-events: none;
  transition: transform 0.15s ease;
  will-change: transform;
}

/* Rotate caret when dropdown is open */
[data-is-open="true"] .input-container::after {
  transform: translateY(-50%) rotate(180deg);
}

/* ComboBox input */
.combobox-input {
  position: relative;
  z-index: 1;
  width: 100%;
  padding: 8px 12px;
  padding-right: 30px;
  border: 1px solid var(--background-modifier-border, #ddd);
  border-radius: 4px;
  background-color: var(--background-primary, #fff);
  color: var(--text-normal, #333);
  font-size: 14px;
  transition: border-color 0.15s ease;
}

/* Dropdown when open - hardware accelerated animation */
.combobox-dropdown {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  margin-top: -1px;
  z-index: 9999;
  background-color: var(--background-primary, #fff);
  border: 1px solid var(--background-modifier-border, #ddd);
  border-top: none;
  border-radius: 0 0 4px 4px;
  max-height: 200px;
  overflow-y: auto;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
  transition: opacity 0.15s ease, transform 0.15s ease;
  transform-origin: top center;
  will-change: transform, opacity;
  
  /* Using actual CSS animation instead of JS-driven transition */
  animation: combobox-dropdown-open 0.15s ease forwards;
}

@keyframes combobox-dropdown-open {
  from {
    opacity: 0;
    transform: translateY(-5px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Option item in dropdown */
.combobox-option {
  padding: 8px 12px;
  cursor: pointer;
  margin: 0;
  background-color: var(--background-primary, #fff);
  color: var(--text-normal, #333);
  font-size: 14px;
  line-height: 1.5;
  border-bottom: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1));
  transition: background-color 0.15s ease;
}

.combobox-option.highlighted,
.combobox-option:hover {
  background-color: var(--background-secondary, #f5f5f5);
}

/* "Add new" option styling */
.combobox-add-option {
  padding: 8px 12px;
  cursor: pointer;
  margin: 0;
  background-color: var(--background-primary, #fff);
  color: var(--text-normal, #333);
  font-size: 14px;
  line-height: 1.5;
  border-bottom: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1));
  font-style: italic;
  border-top: 1px dashed var(--background-modifier-border, #ddd);
  transition: background-color 0.15s ease;
}

.combobox-add-option.highlighted,
.combobox-add-option:hover {
  background-color: var(--background-secondary, #f5f5f5);
}

/* Selected items in multi-select mode */
.selected-item {
  display: inline-flex;
  align-items: center;
  margin: 0 4px 4px 0;
  padding: 4px 8px;
  background-color: var(--interactive-accent, #5183e4);
  color: white;
  border-radius: 4px;
  font-size: 12px;
  gap: 6px;
}

/* Remove button in tags */
.remove-button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 16px;
  height: 16px;
  min-width: 16px;
  min-height: 16px;
  padding: 0;
  background: rgba(255, 255, 255, 0.2);
  border: none;
  color: white;
  font-size: 14px;
  line-height: 1;
  cursor: pointer;
  border-radius: 50%;
  margin-left: 4px;
  position: relative;
  z-index: 5;
  transition: background-color 0.15s ease;
}

.remove-button:hover {
  background: rgba(255, 255, 255, 0.4);
}

/* When dropdown is open, modify input border-radius */
[data-is-open="true"] .combobox-input {
  border-bottom-left-radius: 0;
  border-bottom-right-radius: 0;
}

/* Focus state */
.combobox-input:focus {
  border-color: var(--interactive-accent, #5183e4);
  box-shadow: 0 0 0 2px rgba(83, 141, 226, 0.3);
  outline: none;
}

/* Error state */
.combobox-input.error {
  border-color: var(--text-error, #e53935);
}
`});function FO(){let e="journalit-account-weight-bar-styles";if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=Hbe,document.head.appendChild(t)}function gG(){let e=document.getElementById("journalit-account-weight-bar-styles");e&&e.remove()}function XC(){document.getElementById("journalit-account-weight-bar-styles")||FO()}var Hbe,OO=L(()=>{Hbe=`
/* Account Type Weight Bar Styles */

/* Main container for the weight visualization */
.account-weight-bar-container {
  width: 100%;
  margin: 20px 0;
  padding: 0 10px;
}

/* Weight Bar Styles */
.account-weight-bar {
  display: flex;
  width: 100%;
  height: 12px;
  background-color: transparent;
  border-radius: 0;
  overflow: visible;
  margin-bottom: 12px;
  gap: 5px;
  padding: 0;
}

/* Individual weight segment */
.account-weight-segment {
  height: 100%;
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  min-width: 3px; /* Ensure very small segments are still visible */
  border-radius: 4px;
}

/* Hover effects for weight segments */
.account-weight-segment:hover {
  opacity: 0.8 !important;
  transform: scaleY(1.1) !important;
  z-index: 2;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
}

/* Active/focus states for accessibility */
.account-weight-segment:focus {
  outline: 2px solid var(--interactive-accent);
  outline-offset: 2px;
}

/* Weight Bar Tooltip Styles */
.account-weight-tooltip {
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
  padding: 0;
  max-width: 280px;
  min-width: 220px;
  font-size: 14px;
  line-height: 1.4;
  z-index: 1000;
  backdrop-filter: blur(8px);
}

.weight-tooltip-content {
  padding: 12px 16px;
}

.tooltip-header {
  margin-bottom: 8px;
  padding-bottom: 8px;
  border-bottom: 1px solid var(--background-modifier-border);
  font-size: 15px;
  font-weight: 600;
  color: var(--text-normal);
}

.tooltip-metrics {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.tooltip-metric {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 13px;
  line-height: 1.3;
}

.tooltip-metric .metric-label {
  color: var(--text-muted);
  font-weight: 500;
  flex-shrink: 0;
  margin-right: 12px;
}

.tooltip-metric .metric-value {
  color: var(--text-normal);
  font-weight: 600;
  text-align: right;
  flex: 1;
}

.tooltip-metric .metric-value.positive {
  color: var(--text-success);
}

.tooltip-metric .metric-value.negative {
  color: var(--text-error);
}

/* Legend Styles */
.account-weight-legend-container {
  width: 100%;
  margin-top: 0px;
  padding-top: 0px;
}

.account-weight-legend {
  display: flex;
  flex-wrap: wrap;
  gap: 8px 16px;
  padding: 0;
  align-items: center;
  justify-content: flex-start;
}

.account-weight-legend-item {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 13px;
  line-height: 1.3;
  color: var(--text-normal);
  transition: opacity 0.2s ease;
  cursor: default;
  width: 100%;
  max-width: 200px; /* Prevent items from becoming too wide */
}

.account-weight-legend-item:hover {
  opacity: 0.8;
}

.legend-dot {
  flex-shrink: 0;
  transition: transform 0.2s ease;
}

.account-weight-legend-item:hover .legend-dot {
  transform: scale(1.1);
}

.legend-text {
  display: flex;
  flex-direction: row;
  gap: 6px;
  align-items: center;
  min-width: 0; /* Allow text to shrink */
  flex: 1;
}

.legend-type-name {
  font-weight: 500;
  color: var(--text-normal);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.legend-percentage {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-muted);
  white-space: nowrap;
}

/* Responsive Design */

/* Mobile screens - adjust text size and container padding */
@media (max-width: 599px) {
  .account-weight-legend-item {
    font-size: 12px;
  }
  
  .legend-type-name {
    font-size: 12px;
  }
  
  .legend-percentage {
    font-size: 11px;
  }
  
  .account-weight-bar-container {
    padding: 0;
  }
  
  .account-weight-bar {
    height: 10px; /* Slightly smaller on mobile */
  }
}

/* Very small mobile screens - adjust layout */
@media (max-width: 400px) {
  .account-weight-legend {
    gap: 6px 12px;
  }
  
  .legend-text {
    flex-direction: row;
    gap: 4px;
    align-items: center;
    width: 100%;
  }
}

/* Dark theme adjustments */
.theme-dark .account-weight-tooltip {
  background-color: var(--background-primary);
  border-color: var(--background-modifier-border);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
}

.theme-dark .legend-dot {
  border-color: rgba(255, 255, 255, 0.1);
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

/* Light theme adjustments */
.theme-light .account-weight-tooltip {
  background-color: rgba(255, 255, 255, 0.95);
  border-color: var(--background-modifier-border);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
}

.theme-light .legend-dot {
  border-color: rgba(0, 0, 0, 0.15);
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

/* Animation for initial load */
.account-weight-bar .account-weight-segment {
  animation: segment-grow 0.6s ease-out;
  animation-fill-mode: both;
}

@keyframes segment-grow {
  from {
    width: 0%;
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

/* Stagger animation for segments */
.account-weight-segment:nth-child(1) { animation-delay: 0.1s; }
.account-weight-segment:nth-child(2) { animation-delay: 0.2s; }
.account-weight-segment:nth-child(3) { animation-delay: 0.3s; }
.account-weight-segment:nth-child(4) { animation-delay: 0.4s; }
.account-weight-segment:nth-child(5) { animation-delay: 0.5s; }
.account-weight-segment:nth-child(6) { animation-delay: 0.6s; }
.account-weight-segment:nth-child(7) { animation-delay: 0.7s; }
.account-weight-segment:nth-child(8) { animation-delay: 0.8s; }
.account-weight-segment:nth-child(9) { animation-delay: 0.9s; }
.account-weight-segment:nth-child(10) { animation-delay: 1.0s; }

/* Accessibility improvements */
@media (prefers-reduced-motion: reduce) {
  .account-weight-segment,
  .legend-dot {
    animation: none !important;
    transition: none !important;
  }
  
  .account-weight-segment:hover {
    transform: none !important;
  }
}

/* High contrast mode support */
@media (prefers-contrast: high) {
  .account-weight-bar {
    border: 2px solid var(--text-normal);
  }
  
  .account-weight-segment {
    border-right: 2px solid var(--background-primary);
  }
  
  .legend-dot {
    border: 2px solid var(--text-normal);
  }
}

/* Focus management for keyboard navigation */
.account-weight-bar:focus-within .account-weight-segment:focus {
  outline: 3px solid var(--interactive-accent);
  outline-offset: 2px;
  z-index: 10;
}
`});function Gbe(){if(!jO)try{QC=document.createElement("style"),QC.textContent=qbe,QC.setAttribute("data-journalit-style","account-page"),document.head.appendChild(QC),jO=!0}catch(e){console.error("[Journalit] Error injecting account page styles:",e)}}function pm(){jO||Gbe()}var qbe,jO,QC,hG=L(()=>{qbe=`
/* Account Page View Container 
 * CRITICAL: All flex containers in the hierarchy must have min-height: 0
 * to fix Firefox and other browser flexbox scrolling issues.
 * See: https://stackoverflow.com/questions/36535656/using-flexbox-and-overflow-hidden-scroll-not-working-in-firefox
 */
.journalit-account-page-view-container {
  height: 100%;
  overflow: hidden !important; /* Override ReactView inline styles */
  display: flex;
  flex-direction: column;
  padding: 0;
  min-height: 0; /* Critical for flexbox scrolling */
}

/* Target the React root element to prevent it from scrolling */
.journalit-account-page-view-container > div[id^="react-root-"] {
  height: 100%;
  overflow: visible;
  display: flex;
  flex-direction: column;
  min-height: 0; /* Critical for flexbox scrolling */
}

.journalit-account-page-view {
  display: flex;
  flex-direction: column;
  height: 100%;
  width: 100%;
  background: var(--background-primary);
  color: var(--text-normal);
  overflow: hidden;
  min-height: 0; /* Critical for flexbox scrolling */
}

/* Account Page Header */
.account-page-header {
  padding: 16px 20px;
  margin: 0 0 20px 0;
  background-color: var(--background-secondary);
  border-radius: 8px;
  border: 1px solid var(--background-modifier-border);
}

.account-page-header h2 {
  margin: 0 0 4px 0;
  font-size: 1.5rem;
  font-weight: 600;
  color: var(--text-normal);
}

.account-page-header p {
  margin: 0;
  color: var(--text-muted);
  font-size: 14px;
}

/* Account Page Content */
.account-page-wrapper {
  display: flex;
  flex-direction: column;
  height: 100%;
  overflow: hidden;
  min-height: 0; /* Critical for flexbox scrolling */
}

.account-page-placeholder {
  padding: 40px 20px;
  text-align: center;
  color: var(--text-muted);
}

.account-page-placeholder p {
  margin: 8px 0;
  font-size: 14px;
}

/* Error State */
.account-page-error {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100%;
  padding: 40px 20px;
  text-align: center;
}

.account-page-error h3 {
  margin: 0 0 12px 0;
  font-size: 20px;
  color: var(--text-normal);
}

.account-page-error p {
  margin: 0;
  color: var(--text-muted);
  font-size: 14px;
}

/* Loading State */
.account-page-loading {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  font-size: 16px;
  color: var(--text-muted);
}

/* Account Page Content Area */
.account-page-content {
  flex: 1 1 0; /* CRITICAL: Force height constraint - matches TradeLog fix */
  overflow-y: auto;
  overflow-x: hidden;
  padding: 20px;
  position: relative;
  min-height: 0; /* Important for flex children to scroll properly */
  max-height: 100%; /* Prevent expansion beyond parent - matches TradeLog fix */
  height: 0; /* Force flex to control height - matches TradeLog fix */
  /* Optimize scrolling performance */
  -webkit-overflow-scrolling: touch;
  scroll-behavior: auto; /* Disable smooth scrolling for better performance */
  will-change: scroll-position;
  /* Cross-browser flexbox scrolling fix */
  contain: layout;
}

/* Account Info Section */
.account-info {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 16px;
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid var(--background-modifier-border);
}

.account-info p {
  margin: 0;
  font-size: 14px;
  color: var(--text-muted);
}

/* Account Metrics */
.account-metrics {
  margin: 24px 0;
}

.account-metrics h3 {
  margin: 0 0 16px 0;
  font-size: 18px;
  color: var(--text-normal);
}

.metrics-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 16px;
  margin-bottom: 24px;
}

.metric-card {
  display: flex;
  flex-direction: column;
  padding: 16px;
  background: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
}

.metric-label {
  font-size: 16px;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 4px;
}

.metric-value {
  font-size: 20px;
  font-weight: 600;
  color: var(--text-normal);
}

.metric-value.positive {
  color: var(--text-success);
}

.metric-value.negative {
  color: var(--text-error);
}

/* Account Trades */
.account-trades {
  margin: 24px 0;
}

.account-trades h3 {
  margin: 0 0 16px 0;
  font-size: 18px;
  color: var(--text-normal);
}

.trades-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.trade-item {
  background: var(--background-secondary);
  border: 1px solid var(--background-modifier-border-hover);
  border-radius: 12px;
  overflow: hidden;
  transition: all 0.2s ease;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
}

.trade-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 20px 12px 20px;
  border-bottom: 1px solid var(--background-modifier-border);
  background: var(--background-primary-alt);
}

.trade-instrument {
  font-weight: 700;
  font-size: 18px;
  color: var(--text-normal);
  letter-spacing: -0.5px;
}

.trade-item .trade-direction {
  padding: 6px 12px;
  border-radius: 20px;
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  border: 1.5px solid;
}

.trade-item .trade-direction.long {
  border-color: var(--text-success);
  color: var(--text-success);
  background: rgba(var(--color-green-rgb), 0.1);
}

.trade-item .trade-direction.short {
  border-color: var(--text-error);
  color: var(--text-error);
  background: rgba(var(--color-red-rgb), 0.1);
}

.trade-item .trade-direction.call {
  border-color: var(--text-success);
  color: var(--text-success);
  background: rgba(var(--color-green-rgb), 0.1);
}

.trade-item .trade-direction.put {
  border-color: var(--text-error);
  color: var(--text-error);
  background: rgba(var(--color-red-rgb), 0.1);
}

.trade-pnl {
  font-weight: 700;
  font-size: 18px;
  letter-spacing: -0.5px;
}

.trade-pnl.positive {
  color: var(--text-success);
}

.trade-pnl.negative {
  color: var(--text-error);
}

.trade-details {
  padding: 16px 20px 20px 20px;
  display: grid;
  gap: 12px;
}


.trade-setups,
.trade-tags {
  font-size: 16px;
  color: var(--text-muted);
}

/* Account Header Component */
.account-header-main {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 16px;
  flex-wrap: wrap;
  gap: 16px;
}

.header-buttons {
  display: flex;
  gap: 8px;
  align-items: center;
  flex-shrink: 0;
}

.edit-account-btn,
.add-event-btn {
  background-color: var(--interactive-accent);
  color: white;
  border: 1px solid var(--interactive-accent);
  border-radius: 6px;
  padding: 8px 16px;
  font-size: 0.9rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s ease, transform 0.1s ease;
}

.edit-account-btn:hover,
.add-event-btn:hover {
  background-color: var(--interactive-accent-hover);
  transform: translateY(-1px);
}

.add-event-btn {
  background-color: var(--interactive-accent);
  border-color: var(--interactive-accent);
}

.add-event-btn:hover {
  background-color: var(--interactive-accent);
  opacity: 0.8;
}

.account-info-item {
  display: flex;
  flex-direction: column;
  gap: 4px;
  padding: 12px;
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
}

.info-label {
  font-weight: 500;
  color: var(--text-muted);
  font-size: 0.8rem;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.info-value {
  color: var(--text-normal);
  font-size: 1.1rem;
  font-weight: 600;
}

.edit-modal-placeholder {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  padding: 24px;
  z-index: 1000;
  box-shadow: var(--shadow-l);
}

/* Account Metrics Component */
.metrics-header {
  display: flex;
  justify-content: space-between;
  align-items: baseline;
  margin-bottom: 16px;
  flex-wrap: wrap;
  gap: 8px;
}

.metrics-subtitle {
  color: var(--text-muted);
  font-size: 14px;
}

.metric-value.neutral {
  color: var(--text-normal);
}

/* Account Balance Section */
.account-balance-section {
  margin: 32px 0;
}

.balance-section-header {
  margin-bottom: 16px;
}

.balance-section-header h3 {
  margin: 0 0 4px 0;
  font-size: 18px;
  color: var(--text-normal);
}

.balance-section-subtitle {
  margin: 0;
  color: var(--text-muted);
  font-size: 14px;
}

.balance-chart-container {
  background: transparent;
  border: none;
  border-radius: 0;
  padding: 0;
  margin: 16px 0;
}

.balance-chart-loading {
  height: 400px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-muted);
}

.balance-section-footer {
  margin-top: 8px;
}

.balance-info {
  margin: 0;
  color: var(--text-muted);
  font-size: 16px;
  font-style: italic;
}

/* Linked Trades Section */
.trades-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
  flex-wrap: wrap;
  gap: 16px;
}

.trades-header-centered {
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 24px 0;
  gap: 20px;
}

.trades-header-line {
  flex: 1;
  height: 1px;
  background: linear-gradient(to right, transparent, var(--background-modifier-border), transparent);
}

.trades-header-title {
  font-size: 18px;
  font-weight: 600;
  color: var(--text-normal);
  white-space: nowrap;
  padding: 0 16px;
  background: var(--background-primary);
}

.trade-item {
  cursor: pointer;
}

.trade-item:hover {
  border-color: var(--interactive-accent);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
  transform: translateY(-1px);
}

.trade-item.no-path {
  cursor: default;
  opacity: 0.6;
}

.trade-item.no-path:hover {
  transform: none;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
  border-color: var(--background-modifier-border-hover);
}

.trade-primary-info {
  display: flex;
  align-items: center;
  gap: 12px;
}

.trade-prices, .trade-dates {
  display: flex;
  gap: 16px;
  flex-wrap: wrap;
  padding: 8px 0;
  border-bottom: 1px solid var(--background-modifier-border);
}

.trade-price, .trade-size, .trade-date {
  font-size: 16px;
  color: var(--text-muted);
  font-weight: 500;
}

.trade-setups, .trade-mistakes, .trade-tags {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 0;
  border-bottom: 1px solid var(--background-modifier-border);
}

.trade-setups:last-child, .trade-mistakes:last-child, .trade-tags:last-child {
  border-bottom: none;
}

.setup-label, .mistake-label, .tags-label {
  font-size: 16px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  min-width: 80px;
  flex-shrink: 0;
}

.setup-tags, .mistake-tags, .tag-list {
  display: flex;
  gap: 6px;
  flex-wrap: wrap;
  flex: 1;
}

.setup-tag, .mistake-tag, .trade-tag {
  padding: 4px 10px;
  border-radius: 16px;
  font-size: 11px;
  font-weight: 500;
  letter-spacing: 0.25px;
  transition: all 0.2s ease;
}

.setup-tag {
  background: rgba(var(--color-green-rgb), 0.1);
  color: var(--text-success);
  border: 1px solid rgba(var(--color-green-rgb), 0.2);
}

.mistake-tag {
  background: rgba(var(--color-red-rgb), 0.1);
  color: var(--text-error);
  border: 1px solid rgba(var(--color-red-rgb), 0.2);
}

.trade-tag {
  background: var(--background-modifier-border);
  color: var(--text-muted);
  border: 1px solid var(--background-modifier-border-hover);
}

.trade-meta {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 0 0 0;
  margin-top: 8px;
  font-size: 16px;
  font-weight: 500;
}

.review-status {
  display: flex;
  align-items: center;
  gap: 6px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.review-status.reviewed {
  color: var(--text-success);
}

.review-status.reviewed::before {
  content: "\u2713";
  font-size: 14px;
}

.review-status.not-reviewed {
  color: var(--text-warning);
}

.review-status.not-reviewed::before {
  content: "\u25CB";
  font-size: 14px;
}

.trade-costs {
  color: var(--text-muted);
  font-weight: 500;
}

/* Trade Status - Open Trades */
.status-open {
  display: inline-block;
  padding: 2px 8px;
  border-radius: 3px;
  font-size: 16px;
  font-weight: 600;
  text-transform: uppercase;
  background: rgba(33, 150, 243, 0.15);
  color: var(--color-info);
}

/* Future Enhancements Placeholder */
.future-enhancements-placeholder {
  margin: 32px 0;
  padding: 24px;
  background: var(--background-secondary);
  border: 2px dashed var(--background-modifier-border);
  border-radius: 8px;
  text-align: center;
}

.future-enhancements-placeholder h3 {
  margin: 0 0 16px 0;
  color: var(--text-muted);
}

.future-enhancements-placeholder ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.future-enhancements-placeholder li {
  margin: 8px 0;
  color: var(--text-muted);
  font-size: 14px;
}

/* Edit Account Modal */
.edit-account-modal-container {
  max-width: 600px;
  width: 100%;
}

.edit-account-modal-container .modal-title {
  margin: 0 0 12px 0;
  padding: 0;
  font-size: 18px;
}

.edit-account-form {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 0;
}

.edit-account-form .setting-item {
  display: flex;
  flex-direction: column;
  gap: 4px;
  margin-bottom: 8px;
}

.edit-account-form .setting-item.two-column {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
  align-items: start;
}

.edit-account-form .setting-item.two-column .column {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.edit-account-form .setting-item-info {
  display: flex;
  flex-direction: column;
  gap: 2px;
  overflow: visible;
  min-width: auto;
}

.edit-account-form .setting-item-name {
  font-weight: 600;
  color: var(--text-normal);
  font-size: 16px;
  margin-bottom: 2px;
  overflow: visible;
  text-overflow: clip;
  white-space: normal;
  word-break: break-word;
}

.edit-account-form .setting-item-description {
  color: var(--text-muted);
  font-size: 11px;
  line-height: 1.2;
  margin-bottom: 4px;
}

.edit-account-form .setting-item-control {
  margin-top: 0;
}

.edit-account-form input,
.edit-account-form select {
  width: 100%;
  padding: 6px 8px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 3px;
  background: var(--background-primary);
  color: var(--text-normal);
  font-size: 16px;
  height: 30px;
  line-height: 1.2;
  box-sizing: border-box;
}

.edit-account-form select {
  height: 32px;
  padding: 5px 6px;
}

.edit-account-form input:focus,
.edit-account-form select:focus {
  outline: none;
  border-color: var(--interactive-accent);
  box-shadow: 0 0 0 1px var(--interactive-accent);
}

.edit-account-form input:disabled {
  background: var(--background-secondary);
  color: var(--text-muted);
  cursor: not-allowed;
}

.edit-account-buttons {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid var(--background-modifier-border);
  flex-shrink: 0;
}

.edit-account-buttons .button-group-right {
  display: flex;
  gap: 8px;
  align-items: center;
}

.edit-account-buttons .save-account-button {
  min-width: 100px;
}

.edit-account-buttons .cancel-button {
  min-width: 70px;
}

/* Create Account Modal - Same styling as Edit Account Modal */
.create-account-modal-container {
  max-width: 600px;
  width: 100%;
}

.create-account-modal-container .modal-title {
  margin: 0 0 12px 0;
  padding: 0;
  font-size: 18px;
}

.create-account-form {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 0;
  max-height: 70vh;
  overflow-y: auto;
}

.create-account-form .setting-item {
  display: flex;
  flex-direction: column;
  gap: 4px;
  margin-bottom: 8px;
}

.create-account-form .setting-item.two-column {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
  align-items: start;
}

.create-account-form .setting-item.two-column .column {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.create-account-form .setting-item-info {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.create-account-form .setting-item-name {
  font-weight: 600;
  color: var(--text-normal);
  font-size: 16px;
  margin-bottom: 2px;
}

.create-account-form .setting-item-description {
  color: var(--text-muted);
  font-size: 11px;
  line-height: 1.2;
  margin-bottom: 4px;
}

.create-account-form .setting-item-control {
  margin-top: 0;
}

.create-account-form input,
.create-account-form select {
  width: 100%;
  padding: 6px 8px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 3px;
  background: var(--background-primary);
  color: var(--text-normal);
  font-size: 16px;
  height: 30px;
  line-height: 1.2;
  box-sizing: border-box;
}

.create-account-form select {
  height: 32px;
  padding: 5px 6px;
}

.create-account-form input:focus,
.create-account-form select:focus {
  outline: none;
  border-color: var(--interactive-accent);
  box-shadow: 0 0 0 1px var(--interactive-accent);
}

.create-account-form input:disabled {
  background: var(--background-secondary);
  color: var(--text-muted);
  cursor: not-allowed;
}

.error-message-inline {
  color: var(--text-error);
  font-size: 0.875rem;
  margin-top: 0.25rem;
}

.create-account-buttons {
  display: flex;
  gap: 8px;
  justify-content: flex-end;
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid var(--background-modifier-border);
  flex-shrink: 0;
}

.create-account-buttons .create-account-button {
  min-width: 100px;
}

.create-account-buttons .cancel-button {
  min-width: 70px;
}

/* Modal Button Container for Confirmation Modals */
.modal-button-container {
  display: flex;
  gap: 8px;
  justify-content: flex-end;
  margin-top: 16px;
}

.modal-button-container button {
  padding: 8px 16px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  background: var(--background-primary);
  color: var(--text-normal);
  cursor: pointer;
  font-size: 14px;
}

.modal-button-container button:hover {
  background: var(--background-modifier-hover);
}

.modal-button-container button.mod-cta {
  background: var(--interactive-accent);
  color: var(--text-on-accent);
  border-color: var(--interactive-accent);
}

.modal-button-container button.mod-cta:hover {
  background: var(--interactive-accent-hover);
}

.modal-button-container button.mod-warning {
  background: var(--color-red);
  color: var(--text-on-accent);
  border-color: var(--color-red);
}

.modal-button-container button.mod-warning:hover {
  background: var(--color-red);
  opacity: 0.8;
}

/* Add Event Modal */
.add-event-modal-container {
  max-width: 600px;
  width: 100%;
}

.add-event-modal-container .modal-title {
  margin: 0 0 12px 0;
  padding: 0;
  font-size: 18px;
}

.add-event-form {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 0;
  max-height: 70vh;
  overflow-y: auto;
}

.add-event-form .setting-item {
  display: flex;
  flex-direction: column;
  gap: 4px;
  margin-bottom: 8px;
}

.add-event-form .setting-item.two-column {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
  align-items: start;
}

.add-event-form .setting-item.two-column .column {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.add-event-form .setting-item-info {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.add-event-form .setting-item-name {
  font-weight: 600;
  color: var(--text-normal);
  font-size: 16px;
  margin-bottom: 2px;
}

.add-event-form .setting-item-description {
  color: var(--text-muted);
  font-size: 11px;
  line-height: 1.2;
  margin-bottom: 4px;
}

.add-event-form .setting-item-control {
  margin-top: 0;
}

.add-event-form input,
.add-event-form select {
  width: 100%;
  padding: 6px 8px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 3px;
  background: var(--background-primary);
  color: var(--text-normal);
  font-size: 16px;
  height: 30px;
  line-height: 1.2;
  box-sizing: border-box;
}

.add-event-form select {
  height: 32px;
  padding: 5px 6px;
}

.add-event-form input:focus,
.add-event-form select:focus {
  outline: none;
  border-color: var(--interactive-accent);
  box-shadow: 0 0 0 1px var(--interactive-accent);
}

.add-event-form input:disabled {
  background: var(--background-secondary);
  color: var(--text-muted);
  cursor: not-allowed;
}

.add-event-buttons {
  display: flex;
  gap: 8px;
  justify-content: space-between;
  margin-top: 12px;
  padding-top: 12px;
  border-top: 1px solid var(--background-modifier-border);
  flex-shrink: 0;
}

.add-event-buttons .button-group-left {
  display: flex;
  gap: 8px;
  align-items: center;
}

.add-event-buttons .button-group-right {
  display: flex;
  gap: 8px;
  align-items: center;
}

.add-event-buttons .add-event-button {
  min-width: 100px;
}

.add-event-buttons .cancel-button {
  min-width: 70px;
}

/* Deposits & Withdrawals Section */
.deposits-withdrawals-section {
  margin: 32px 0;
}

.section-header-centered {
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 32px 0 24px 0;
  gap: 16px;
}

.section-header-line {
  flex: 1;
  height: 1px;
  background-color: var(--background-modifier-border);
  min-width: 20px;
}

.section-header-title {
  flex-shrink: 0;
  margin: 0;
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--text-normal);
  white-space: nowrap;
  padding: 0 8px;
}

.empty-transactions {
  text-align: center;
  padding: 20px;
}

.empty-state-action {
  margin-top: 16px;
}

.add-first-transaction-btn {
  background-color: var(--interactive-accent);
  color: white;
  border-color: var(--interactive-accent);
}

.transactions-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

/* Transaction Items */
.transaction-item {
  padding: 16px;
  background: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  transition: background-color 0.2s ease;
}

.transaction-item:hover {
  background: var(--background-modifier-hover);
}

.transaction-item.clickable {
  cursor: pointer;
}

.transaction-item.clickable:hover {
  background: var(--background-modifier-hover);
  border-color: var(--background-modifier-border-hover);
}

.transaction-item.deposit {
  border-left: 4px solid var(--color-info);
}

.transaction-item.withdrawal {
  border-left: 4px solid var(--text-warning);
}

.transaction-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
  flex-wrap: wrap;
  gap: 8px;
}

.transaction-primary-info {
  display: flex;
  align-items: center;
  gap: 12px;
}

.transaction-type {
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 16px;
  font-weight: 500;
  text-transform: uppercase;
}

.transaction-type.deposit {
  background: rgba(37, 99, 235, 0.15);
  color: var(--color-info);
  font-weight: 600;
}

.transaction-type.withdrawal {
  background: rgba(234, 179, 8, 0.15);
  color: var(--text-warning);
  font-weight: 600;
}

.transaction-date {
  font-size: 16px;
  color: var(--text-muted);
}

.transaction-amount {
  font-weight: 600;
  font-size: 16px;
}

.transaction-amount.positive {
  color: var(--color-info);
}

.transaction-amount.negative {
  color: var(--text-warning);
}

.transaction-details {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.transaction-description {
  display: flex;
  gap: 8px;
  align-items: flex-start;
}

.description-label {
  font-size: 16px;
  color: var(--text-muted);
  font-weight: 500;
}

.description-text {
  font-size: 16px;
  color: var(--text-normal);
}

.transaction-meta {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 8px;
  flex-wrap: wrap;
  gap: 8px;
}

.balance-after {
  font-size: 16px;
  color: var(--text-muted);
  font-weight: 500;
}

.transaction-actions {
  display: flex;
  gap: 4px;
  align-items: center;
}

.edit-transaction-btn,
.delete-transaction-btn {
  padding: 4px 8px;
  min-width: auto;
  height: auto;
}

.edit-transaction-btn {
  background-color: var(--interactive-accent);
  color: white;
  border-color: var(--interactive-accent);
}

.edit-transaction-btn:hover {
  background-color: var(--interactive-accent-hover);
}

.delete-transaction-btn {
  background-color: var(--color-red);
  color: white;
  border-color: var(--color-red);
}

.delete-transaction-btn:hover {
  background-color: var(--color-red);
  opacity: 0.8;
}

.transaction-description {
  color: var(--text-muted);
  font-style: italic;
  font-size: 16px;
}

/* Warning text for modals */
.warning {
  color: var(--text-warning);
  font-style: italic;
}

/* Account Risk Metrics Section */
.account-risk-metrics-section {
  margin: 32px 0;
}

.risk-metrics-container {
  display: flex;
  gap: 24px;
  margin-top: 24px;
  flex-wrap: wrap;
  justify-content: space-between;
}

.risk-metric-box {
  flex: 1;
  min-width: 300px;
  background-color: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 12px;
  padding: 20px;
}

.risk-metric-box.not-set {
  opacity: 0.6;
}

.risk-metric-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 16px;
  gap: 12px;
}

.header-left {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.title-with-badge {
  display: flex;
  align-items: center;
  gap: 12px;
  flex-wrap: wrap;
}

.risk-metric-title {
  margin: 0;
  font-size: 16px;
  font-weight: 600;
  color: var(--text-normal);
}

.risk-metric-percentage {
  font-size: 24px;
  font-weight: 700;
  color: var(--text-normal);
  text-align: right;
}

.risk-metric-percentage.not-set {
  color: var(--text-muted);
  font-weight: 500;
  font-size: 16px;
}

/* Status Badges (following trade direction badge pattern) */
.risk-status-badge {
  padding: 4px 8px;
  border-radius: 16px;
  font-size: 10px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  border: 1.5px solid;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  white-space: nowrap;
  flex-shrink: 0;
}

.risk-status-badge.in-progress {
  border-color: var(--color-warning);
  color: var(--color-warning);
  background: rgba(245, 158, 11, 0.1);
}

.risk-status-badge.achieved {
  border-color: var(--text-success);
  color: var(--text-success);
  background: rgba(var(--color-green-rgb), 0.1);
}

.risk-status-badge.breached {
  border-color: var(--text-error);
  color: var(--text-error);
  background: rgba(var(--color-red-rgb), 0.1);
}

/* Horizontal Progress Bar */
.horizontal-bar-container {
  margin-bottom: 16px;
}

.horizontal-bar-track {
  width: 100%;
  height: 12px;
  background-color: var(--background-modifier-border);
  border-radius: 6px;
  overflow: hidden;
  position: relative;
}

.horizontal-bar-fill {
  height: 100%;
  border-radius: 6px;
  transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
}

/* Drawdown Bar Colors */
.horizontal-bar-fill.safe {
  background: linear-gradient(90deg, var(--color-green) 0%, var(--color-green) 100%);
  box-shadow: 0 2px 8px rgba(34, 197, 94, 0.2);
}

.horizontal-bar-fill.warning {
  background: linear-gradient(90deg, var(--text-warning) 0%, var(--text-warning) 100%);
  box-shadow: 0 2px 8px rgba(234, 179, 8, 0.2);
}

.horizontal-bar-fill.critical {
  background: linear-gradient(90deg, var(--color-red) 0%, var(--color-red) 100%);
  box-shadow: 0 2px 8px rgba(239, 68, 68, 0.2);
}

/* Profit Target Bar Colors */
.horizontal-bar-fill.progress {
  background: linear-gradient(90deg, var(--interactive-accent) 0%, var(--interactive-accent) 100%);
  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.2);
}

.horizontal-bar-fill.complete {
  background: linear-gradient(90deg, var(--color-green) 0%, var(--color-green) 100%);
  box-shadow: 0 2px 8px rgba(34, 197, 94, 0.2);
}

/* Risk Metric Details */
.risk-metric-details {
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  padding: 12px;
  font-size: 16px;
}

.detail-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 6px;
}

.detail-row:last-child {
  margin-bottom: 0;
}

.detail-label {
  color: var(--text-muted);
  font-weight: 500;
}

.detail-value {
  color: var(--text-normal);
  font-weight: 600;
}

.detail-value.no-limit,
.detail-value.no-target {
  color: var(--text-muted);
  font-style: italic;
  text-align: center;
  width: 100%;
}

/* Responsive Design */
@media (max-width: 768px) {
  .account-page-header {
    margin: 0 0 16px 0;
    padding: 12px 16px;
  }
  
  .account-page-header h2 {
    font-size: 1.3rem;
  }
  
  /* Risk Metrics Mobile Styles */
  .risk-metrics-container {
    flex-direction: column;
    gap: 16px;
  }
  
  .risk-metric-box {
    min-width: 0;
    width: 100%;
  }
  
  .risk-metric-header {
    flex-direction: column;
    align-items: flex-start;
    gap: 8px;
  }
  
  .header-left {
    flex-direction: column;
    align-items: flex-start;
    width: 100%;
    gap: 4px;
  }
  
  .title-with-badge {
    gap: 8px;
  }
  
  .risk-metric-percentage {
    text-align: left;
    font-size: 20px;
  }
  
  .account-page-content {
    padding: 16px;
  }
  
  .account-header-main {
    flex-direction: column;
    align-items: stretch;
    gap: 12px;
  }
  
  .edit-account-btn {
    align-self: flex-end;
    width: auto;
  }
  
  .account-info {
    grid-template-columns: 1fr;
    gap: 12px;
  }
  
  .metrics-grid {
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 12px;
  }
  
  .trade-header {
    flex-direction: column;
    align-items: flex-start;
  }
  
  .trades-header-centered {
    margin: 24px 0 16px 0;
    gap: 12px;
  }
  
  .trades-header-title {
    font-size: 1rem;
    padding: 0 6px;
  }
  
  .trade-info,
  .trade-dates {
    flex-direction: column;
    gap: 8px;
  }
  
  /* Edit Modal Responsive */
  .edit-account-modal-container {
    max-width: 90vw;
    max-height: 85vh;
  }
  
  .edit-account-form {
    gap: 6px;
  }
  
  .edit-account-form .setting-item {
    margin-bottom: 6px;
  }
  
  .edit-account-form .setting-item.two-column {
    grid-template-columns: 1fr;
    gap: 8px;
  }
  
  .edit-account-buttons {
    flex-direction: column;
    align-items: stretch;
    gap: 8px;
  }
  
  .edit-account-buttons .button-group-right {
    flex-direction: column;
    gap: 8px;
    width: 100%;
  }
  
  .edit-account-buttons .save-account-button,
  .edit-account-buttons .cancel-button,
  .edit-account-buttons .delete-account-button {
    min-width: auto;
    width: 100%;
  }
  
  /* Create Modal Responsive - Same as Edit Modal */
  .create-account-modal-container {
    max-width: 90vw;
    max-height: 85vh;
  }
  
  .create-account-form {
    max-height: 60vh;
    gap: 6px;
  }
  
  .create-account-form .setting-item {
    margin-bottom: 6px;
  }
  
  .create-account-form .setting-item.two-column {
    grid-template-columns: 1fr;
    gap: 8px;
  }
  
  .create-account-buttons {
    flex-direction: column;
    gap: 8px;
  }
  
  .create-account-buttons .create-account-button,
  .create-account-buttons .cancel-button {
    min-width: auto;
    width: 100%;
  }
}

/* Account Dashboard Settings Modal - Account Type Management */
.account-dashboard-settings-modal-container .available-account-types {
  margin-top: 8px;
}

.account-dashboard-settings-modal-container .account-types-container {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  align-items: center;
}

.account-dashboard-settings-modal-container .account-type-badge-container {
  position: relative;
  display: inline-block;
}

.account-dashboard-settings-modal-container .account-type-badge {
  display: inline-flex;
  align-items: center;
  padding: 6px 12px;
  background: var(--background-secondary);
  border: 1px solid var(--border-color);
  border-radius: 6px;
  font-size: 16px;
  font-weight: 500;
  color: var(--text-normal);
  position: relative;
  transition: all 0.2s ease;
}

.account-dashboard-settings-modal-container .account-type-badge:hover {
  border-color: var(--color-accent);
  background: var(--background-secondary-alt);
}

.account-dashboard-settings-modal-container .account-type-delete-btn {
  position: absolute;
  top: -6px;
  right: -6px;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  background: var(--color-red);
  border: 1px solid var(--background-primary);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: 14px;
  font-weight: bold;
  line-height: 1;
  z-index: 10;
  font-family: system-ui, -apple-system, sans-serif;
}

.account-dashboard-settings-modal-container .account-type-delete-btn:hover {
  background: var(--color-red-hover, #dc2626);
  transform: scale(1.1);
}

.account-dashboard-settings-modal-container .account-type-delete-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
}

.account-dashboard-settings-modal-container .add-account-type-section {
  display: flex;
  align-items: center;
  gap: 8px;
}

.account-dashboard-settings-modal-container .add-account-type-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 28px;
  height: 28px;
  padding: 6px;
  background: var(--interactive-accent);
  border: 1px solid transparent;
  border-radius: 6px;
  color: var(--text-on-accent);
  cursor: pointer;
  transition: all 0.2s ease;
}

.account-dashboard-settings-modal-container .add-account-type-btn:hover {
  background: var(--interactive-accent-hover);
}

.account-dashboard-settings-modal-container .add-account-type-btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.account-dashboard-settings-modal-container .add-account-type-input {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 8px;
  background: var(--background-secondary);
  border: 1px solid var(--border-color);
  border-radius: 6px;
  min-width: 200px;
}

.account-dashboard-settings-modal-container .account-type-name-input {
  padding: 6px 8px;
  border: 1px solid var(--border-color);
  border-radius: 4px;
  background: var(--background-primary);
  color: var(--text-normal);
  font-size: 16px;
  outline: none;
  transition: border-color 0.2s ease;
}

.account-dashboard-settings-modal-container .account-type-name-input:focus {
  border-color: var(--color-accent);
}

.account-dashboard-settings-modal-container .add-account-type-buttons {
  display: flex;
  gap: 6px;
}

.account-dashboard-settings-modal-container .add-account-type-confirm-btn,
.account-dashboard-settings-modal-container .add-account-type-cancel-btn {
  padding: 4px 8px;
  border: 1px solid var(--border-color);
  border-radius: 4px;
  font-size: 11px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  flex: 1;
}

.account-dashboard-settings-modal-container .add-account-type-confirm-btn {
  background: var(--interactive-accent);
  color: var(--text-on-accent);
  border-color: transparent;
}

.account-dashboard-settings-modal-container .add-account-type-confirm-btn:hover:not(:disabled) {
  background: var(--interactive-accent-hover);
}

.account-dashboard-settings-modal-container .add-account-type-confirm-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.account-dashboard-settings-modal-container .add-account-type-cancel-btn {
  background: var(--background-primary);
  color: var(--text-normal);
}

.account-dashboard-settings-modal-container .add-account-type-cancel-btn:hover:not(:disabled) {
  background: var(--background-secondary);
  border-color: var(--color-accent);
}

.account-dashboard-settings-modal-container .no-account-types-container {
  display: flex;
  flex-direction: column;
  gap: 12px;
  align-items: flex-start;
}

.account-dashboard-settings-modal-container .no-account-types {
  color: var(--text-muted);
  font-style: italic;
  font-size: 16px;
}

/* Delete Confirmation Modal */
.account-type-delete-modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.8);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
  backdrop-filter: blur(2px);
}

.account-type-delete-modal {
  background: var(--background-primary);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  padding: 24px;
  max-width: 500px;
  width: 90vw;
  max-height: 80vh;
  overflow-y: auto;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.account-type-delete-modal h3 {
  margin: 0 0 16px 0;
  color: var(--text-normal);
  font-size: 18px;
  font-weight: 600;
}

.delete-modal-content {
  margin-bottom: 20px;
}

.delete-warning {
  padding: 12px;
  background: var(--background-secondary);
  border-radius: 6px;
  margin-bottom: 16px;
}

.delete-warning p {
  margin: 0;
  color: var(--text-normal);
  font-size: 14px;
}

.impact-analysis h4 {
  margin: 0 0 12px 0;
  color: var(--text-normal);
  font-size: 14px;
  font-weight: 600;
}

.impact-analysis h5 {
  margin: 12px 0 8px 0;
  color: var(--text-normal);
  font-size: 16px;
  font-weight: 500;
}

.impact-item {
  padding: 8px 12px;
  border-radius: 4px;
  margin-bottom: 8px;
  font-size: 16px;
  font-weight: 500;
}

.impact-item.impact-critical {
  background: rgba(239, 68, 68, 0.1);
  color: var(--color-red);
  border: 1px solid rgba(239, 68, 68, 0.2);
}

.impact-item.impact-safe {
  background: rgba(34, 197, 94, 0.1);
  color: var(--color-green, #22c55e);
  border: 1px solid rgba(34, 197, 94, 0.2);
}

.affected-accounts ul {
  margin: 8px 0 0 0;
  padding-left: 20px;
  list-style-type: disc;
}

.affected-accounts li {
  margin: 4px 0;
  color: var(--text-normal);
  font-weight: normal;
}

.migration-notice {
  margin-top: 12px;
  padding: 8px 12px;
  background: var(--background-secondary-alt);
  border-radius: 4px;
  font-size: 16px;
  color: var(--text-muted);
  border-left: 3px solid var(--color-accent);
}

.settings-cleanup {
  margin-top: 16px;
}

.settings-cleanup ul {
  margin: 8px 0 0 0;
  padding-left: 20px;
  list-style-type: none;
}

.settings-cleanup li {
  margin: 4px 0;
  color: var(--text-normal);
  font-size: 16px;
}

.delete-modal-actions {
  display: flex;
  gap: 12px;
  justify-content: flex-end; 
  padding-top: 16px;
  border-top: 1px solid var(--border-color);
}

.delete-modal-actions .button {
  min-width: 100px;
}

/* Account Migration Modal Overlay (higher z-index than delete modal) */
.account-migration-modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: rgba(0, 0, 0, 0.8);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10001; /* Higher than delete modal (10000) */
  backdrop-filter: blur(2px);
}

/* Account Migration Modal Specific Styles */
.account-migration-modal {
  max-width: 600px;
}

.migration-warning {
  padding: 16px;
  background: rgba(239, 68, 68, 0.1);
  border: 1px solid rgba(239, 68, 68, 0.2);
  border-radius: 6px;
  margin-bottom: 20px;
}

.migration-warning p {
  margin: 0 0 8px 0;
  color: var(--text-normal);
  font-size: 14px;
}

.migration-warning p:last-child {
  margin-bottom: 0;
}

.affected-accounts-list {
  margin: 8px 0 0 20px;
  padding: 0;
  list-style-type: disc;
}

.affected-accounts-list li {
  margin: 4px 0;
  color: var(--text-normal);
  font-size: 16px;
}

.migration-options h4 {
  margin: 0 0 16px 0;
  color: var(--text-normal);
  font-size: 16px;
  font-weight: 600;
}

.migration-option-group {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.migration-option {
  display: flex;
  align-items: flex-start;
  gap: 12px;
  padding: 12px;
  border: 2px solid var(--border-color);
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.migration-option:hover {
  border-color: var(--color-accent);
  background: var(--background-secondary);
}

.migration-option input[type="radio"] {
  margin: 0;
  margin-top: 2px;
}

.migration-option input[type="radio"]:checked + .migration-option-content {
  color: var(--color-accent);
}

.migration-option.checked {
  border-color: var(--color-accent);
  background: var(--background-secondary);
}

.migration-option-content {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.migration-option-title {
  font-weight: 600;
  font-size: 14px;
  color: var(--text-normal);
}

.migration-option-desc {
  font-size: 16px;
  color: var(--text-muted);
  line-height: 1.4;
}

.target-type-select {
  margin-top: 12px;
  padding: 12px;
  background: var(--background-secondary-alt);
  border-radius: 6px;
  border: 1px solid var(--border-color);
}

.target-type-select label {
  display: block;
  margin-bottom: 6px;
  font-size: 16px;
  font-weight: 500;
  color: var(--text-normal);
}

.target-type-select select {
  width: 100%;
  padding: 6px 8px;
  border: 1px solid var(--border-color);
  border-radius: 4px;
  background: var(--background-primary);
  color: var(--text-normal);
  font-size: 16px;
}

.target-type-select select:focus {
  outline: none;
  border-color: var(--color-accent);
}

.delete-modal-actions .delete-confirm-button {
  background: var(--color-red) !important;
  color: white !important;
  border-color: var(--color-red) !important;
}

.delete-modal-actions .delete-confirm-button:hover:not(:disabled) {
  background: var(--color-red-hover, #dc2626) !important;
  border-color: var(--color-red-hover, #dc2626) !important;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  .account-dashboard-settings-modal-container .account-types-container {
    flex-direction: column;
    align-items: flex-start;
  }
  
  .account-dashboard-settings-modal-container .add-account-type-input {
    min-width: 100%;
  }
  
  .account-dashboard-settings-modal-container .add-account-type-buttons {
    width: 100%;
  }
  
  .account-type-delete-modal {
    margin: 20px;
    width: calc(100vw - 40px);
    max-width: none;
  }
  
  .delete-modal-actions {
    flex-direction: column;
  }
  
  .delete-modal-actions .button {
    width: 100%;
  }
}

/* Responsive styles for small screens */
@media (max-width: 600px) {
  .edit-account-form input,
  .edit-account-form select,
  .create-account-form input,
  .create-account-form select,
  .add-event-form input,
  .add-event-form select,
  .account-dashboard-settings-modal-container .account-type-name-input {
    font-size: 18px !important;
  }
}
`,jO=!1,QC=null});function Lv(){if(ZC===0&&!document.head.querySelector("#tradelog-settings-modal-styles")){let e=document.createElement("style");e.id="tradelog-settings-modal-styles",e.textContent=Ybe,document.head.appendChild(e)}ZC++}function e1(){if(ZC--,ZC===0){let e=document.head.querySelector("#tradelog-settings-modal-styles");e&&e.remove()}}var Ybe,ZC,t1=L(()=>{Ybe=`
  .tradelog-settings-modal-container {
    max-width: 450px;
    width: 100%;
    margin: 0 auto;
  }

  .tradelog-settings-modal-content {
    display: flex;
    flex-direction: column;
    gap: 16px;
    padding: 16px 0;
  }

  .tradelog-settings-section {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .tradelog-settings-section-title {
    font-size: 14px;
    font-weight: 600;
    color: var(--text-normal);
    margin-bottom: 8px;
  }

  .sortable-column-item {
    display: grid;
    grid-template-columns: 40px 24px 1fr;
    gap: 12px;
    align-items: center;
    padding: 12px 16px;
    background: var(--background-secondary);
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    margin-bottom: 2px;
    cursor: pointer;
    transition: background-color 0.2s ease, border-color 0.2s ease;
    position: relative;
  }

  .sortable-column-item:hover {
    background: var(--background-modifier-hover);
    border-color: var(--interactive-accent);
  }

  .sortable-column-item.dragging {
    opacity: 0.5;
  }

  .column-drag-handle {
    display: flex;
    align-items: center;
    color: var(--text-muted);
    flex-shrink: 0;
    cursor: grab;
    pointer-events: auto;
    z-index: 1;
    position: relative;
    padding: 0 8px;
  }

  .column-drag-handle:hover {
    color: var(--text-normal);
  }

  .column-drag-handle:active {
    cursor: grabbing;
  }

  .column-drag-handle svg {
    pointer-events: none;
  }

  .column-label {
    position: absolute;
    left: 0;
    right: 0;
    top: 50%;
    transform: translateY(-50%);
    color: var(--text-normal);
    font-size: 14px;
    text-align: center;
    pointer-events: none;
    z-index: 0;
  }

  .sortable-column-item .jl-checkbox-wrapper {
    z-index: 1;
    position: relative;
    pointer-events: auto;
  }

  .tradelog-settings-modal-buttons {
    display: flex;
    gap: 8px;
    justify-content: flex-end;
    margin-top: 16px;
    padding-top: 16px;
    border-top: 1px solid var(--background-modifier-border);
  }

  .tradelog-settings-modal-buttons button {
    padding: 8px 16px;
    border-radius: 6px;
    font-size: 14px;
    cursor: pointer;
    border: 1px solid var(--background-modifier-border);
    background: var(--background-secondary);
    color: var(--text-normal);
  }

  .tradelog-settings-modal-buttons button:hover {
    background: var(--background-modifier-hover);
  }

  .tradelog-settings-modal-buttons button.primary {
    background: var(--interactive-accent);
    color: var(--text-on-accent);
    border-color: var(--interactive-accent);
  }

  .tradelog-settings-modal-buttons .reset-button {
    margin-right: auto;
  }
`,ZC=0});function r1(){if(document.head.querySelector("#batch-action-toolbar-styles"))return;let e=document.createElement("style");e.id="batch-action-toolbar-styles",e.textContent=Kbe,document.head.appendChild(e)}function n1(){var e;(e=document.head.querySelector("#batch-action-toolbar-styles"))==null||e.remove()}var Kbe,zO=L(()=>{Kbe=`
  .batch-action-toolbar {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 12px 16px;
    background: var(--background-secondary);
    border-top: 1px solid var(--background-modifier-border);
    border-bottom: 1px solid var(--background-modifier-border);
    flex-wrap: wrap;
    justify-content: flex-start;
  }

  .batch-action-toolbar-actions button {
    padding: 6px 12px;
    border-radius: 6px;
    font-size: 13px;
    cursor: pointer;
    border: 1px solid var(--background-modifier-border);
    background: var(--interactive-accent);
    color: var(--text-on-accent);
    font-weight: 500;
    transition: background 0.2s ease, opacity 0.2s ease;
  }

  .batch-action-toolbar-actions button:hover:not(:disabled) {
    opacity: 0.85;
    background: var(--interactive-accent);
  }

  .batch-action-toolbar-actions button:active:not(:disabled) {
    opacity: 0.8;
  }

  .batch-action-toolbar-actions button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .batch-action-toolbar-actions button.danger {
    background: var(--text-error);
    border-color: var(--text-error);
    color: white;
  }

  .batch-action-toolbar-actions button.danger:hover:not(:disabled) {
    opacity: 0.85;
    background: var(--text-error);
  }

  @media (max-width: 768px) {
    .batch-action-toolbar {
      padding: 8px 12px;
      gap: 8px;
    }

    .batch-action-toolbar-count {
      font-size: 13px;
    }

    .batch-action-toolbar-actions {
      gap: 6px;
    }

    .batch-action-toolbar-actions button {
      padding: 6px 12px;
      font-size: 13px;
    }
  }

  /* Batch action modal styles */
  .batch-action-modal-container {
    display: flex;
    flex-direction: column;
    width: 100%;
    flex: 1;
    min-height: 0;
  }

  .batch-action-modal-content {
    display: flex;
    flex-direction: column;
    flex: 1;
    min-height: 0;
  }

  .batch-action-modal-body {
    flex: 1;
    overflow-y: auto;
    overflow-x: hidden;
    padding: 16px;
    min-height: 0;
  }

  .batch-action-modal-buttons {
    display: flex;
    gap: 8px;
    justify-content: flex-end;
    padding: 12px 16px;
    border-top: 1px solid var(--background-modifier-border);
    flex-shrink: 0;
    background: var(--background-primary);
  }

  .batch-action-modal-buttons button {
    padding: 8px 16px;
    border-radius: 4px;
    border: 1px solid var(--background-modifier-border);
    background: var(--background-primary);
    color: var(--text-normal);
    cursor: pointer;
    font-size: 14px;
  }

  .batch-action-modal-buttons button:hover:not(:disabled) {
    background: var(--background-modifier-hover);
  }

  .batch-action-modal-buttons button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .batch-action-modal-buttons button.primary {
    background: var(--interactive-accent);
    color: var(--text-on-accent);
    border-color: var(--interactive-accent);
  }

  .batch-action-modal-buttons button.primary:hover:not(:disabled) {
    background: var(--interactive-accent-hover);
  }

  .journalit-batch-modal-title {
    margin: 0 0 16px 0;
    font-size: 18px;
    font-weight: 600;
    color: var(--text-normal);
  }

  /* Fix count class mismatch and ensure consistent typography */

  .batch-selection-count {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 6px 12px;
    border-radius: 12px;
    border: 1px solid var(--background-modifier-border);
    background: var(--background-modifier-hover);
    color: var(--text-normal);
    font-weight: 600;
    font-size: 13px;
    line-height: 1;
    white-space: nowrap;
    text-transform: uppercase;
  }

  .batch-action-toolbar-left {
    display: flex;
    align-items: center;
    gap: 8px;
    flex: 0 1 auto;
    min-width: 0;
  }

  .batch-action-select-all-btn {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 6px 10px;
    border-radius: 6px;
    border: 1px solid var(--background-modifier-border);
    background: var(--interactive-accent);
    color: var(--text-on-accent);
    font-size: 12px;
    font-weight: 500;
    cursor: pointer;
    white-space: nowrap;
    transition: background 0.2s ease, opacity 0.2s ease;
  }

  .batch-action-select-all-btn:hover:not(:disabled) {
    opacity: 0.85;
    background: var(--interactive-accent);
  }

  .batch-action-select-all-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .batch-action-select-all-btn svg {
    flex-shrink: 0;
  }

  @media (max-width: 768px) {
    .batch-action-select-all-btn .select-all-label {
      display: none;
    }
    .batch-action-select-all-btn {
      padding: 6px;
      min-width: 28px;
      justify-content: center;
    }
  }

  .batch-action-toolbar-actions {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
  }

  /* Icon spacing with labels visible */
  .batch-action-toolbar-actions button svg {
    margin-right: 6px;
  }

  @media (max-width: 1024px) {
    .batch-action-toolbar-actions button {
      padding: 6px 10px;
    }
  }

  /* Compact icon-first buttons at narrower widths */
  @media (max-width: 900px) {
    .batch-action-toolbar-actions .btn-label {
      display: none;
    }
    .batch-action-toolbar-actions button {
      padding: 6px;
      min-width: 32px;
      justify-content: center;
    }
    .batch-action-toolbar-actions button svg {
      margin-right: 0;
    }
  }

  /* Tight layout and full-width action row on very small screens */
  @media (max-width: 600px) {
    .batch-action-toolbar {
      gap: 6px;
    }

    .batch-action-toolbar-actions {
      width: 100%;
      justify-content: flex-start;
    }
  }
`});function a1(){if(o1===0&&!document.head.querySelector("#trade-log-mini-header-styles")){let e=document.createElement("style");e.id="trade-log-mini-header-styles",e.textContent=Jbe,document.head.appendChild(e)}o1++}function i1(){if(o1--,o1===0){let e=document.head.querySelector("#trade-log-mini-header-styles");e&&e.remove()}}var Jbe,o1,_O=L(()=>{Jbe=`
/**
 * File: src/styles/tradelog/tradeLogMiniHeaderStyles.ts
 * Purpose: Styles for TradeLog mini-headers in tree view modes
 */

.trade-log-mini-header {
  display: flex;
  align-items: center;
  min-height: 32px;
  padding: 6px 0;
  opacity: 0.7;
  pointer-events: none;
}

.tree-indicator-cell-header {
  /* Width controlled by grid template (20px) */
}

.mini-header-row {
  display: grid;
  /* gridTemplateColumns set via inline style from React */
  gap: 6px;
  align-items: center;
  padding: 0 16px 0 0;
  font-size: 11px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  width: 100%;
}

.mini-header-cell {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  text-align: center;
}
`,o1=0});function l1(){let e=document.getElementById(s1);e&&e.remove();let t=document.createElement("style");t.id=s1,t.textContent=Xbe,document.head.appendChild(t)}function BO(){let e=document.getElementById(s1);e&&e.remove()}function vG(){document.getElementById(s1)||l1()}var s1,Xbe,$O=L(()=>{Oo();s1="onboarding-wizard-modal-styles",Xbe=`
  .onboarding-wizard-modal {
    position: relative;
    padding: 16px;
    max-width: 500px;
    margin: 0 auto;
    height: fit-content;
    display: flex;
    flex-direction: column;
  }

  .modal-header {
    margin-bottom: 16px;
  }

  .modal-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow-y: visible;
    padding-bottom: 8px; /* Reserve space for skip button */
  }

  .onboarding-slide {
    text-align: center;
  }

  .onboarding-slide h2 {
    margin: 0 0 12px 0;
    font-size: 20px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .onboarding-slide p {
    margin: 0 0 20px 0;
    color: var(--text-muted);
    line-height: 1.4;
  }

  .slide-placeholder {
    padding: 20px;
    border: 2px dashed var(--background-modifier-border);
    border-radius: 8px;
    background: var(--background-secondary);
    margin: 20px 0;
  }

  .slide-placeholder p {
    font-style: italic;
    color: var(--text-muted);
  }

  /* Welcome slide styles */
  .welcome-slide {
    text-align: center;
    padding: 20px 0;
  }

  .welcome-icon {
    font-size: 48px;
    margin-bottom: 16px;
  }

  .welcome-subtitle {
    font-size: 16px;
    color: var(--text-muted);
    margin-bottom: 32px;
    font-weight: 500;
  }

  .welcome-features {
    display: flex;
    flex-direction: column;
    gap: 20px;
    margin: 32px 0;
    text-align: left;
    max-width: 400px;
    margin-left: auto;
    margin-right: auto;
  }

  .feature {
    display: flex;
    align-items: flex-start;
    gap: 12px;
  }

  .feature-icon {
    font-size: 20px;
    flex-shrink: 0;
    margin-top: 2px;
  }

  .feature-text h3 {
    margin: 0 0 4px 0;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .feature-text p {
    margin: 0;
    font-size: 13px;
    color: var(--text-muted);
    line-height: 1.4;
  }

  .welcome-tagline {
    font-size: 14px;
    color: var(--interactive-accent);
    font-weight: 500;
    margin-top: 24px;
  }

  .welcome-trust-indicators {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-top: 20px;
    padding: 16px;
    background: var(--background-secondary);
    border-radius: 8px;
    border: 1px solid var(--background-modifier-border);
  }

  .trust-item {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 12px;
    color: var(--text-normal);
  }

  .trust-icon {
    font-size: 14px;
    flex-shrink: 0;
  }

  .welcome-preview-section {
    margin: 32px 0 24px 0;
  }

  .welcome-preview-section h3 {
    margin: 0 0 16px 0;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-normal);
    text-align: center;
  }

  .insights-preview {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .insight-preview-card {
    padding: 12px;
    background: var(--background-secondary);
    border-radius: 6px;
    border: 1px solid var(--background-modifier-border);
    text-align: left;
  }

  .insight-preview-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 6px;
  }

  .insight-preview-icon {
    font-size: 14px;
    flex-shrink: 0;
  }

  .insight-preview-header strong {
    font-size: 12px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .insight-preview-content {
    font-size: 11px;
    color: var(--text-muted);
    font-style: italic;
    line-height: 1.3;
    padding-left: 22px;
  }

  /* Goal selection styles */
  .goal-slide {
    text-align: center;
  }

  .goal-options {
    display: flex;
    flex-direction: column;
    gap: 16px;
    margin: 24px 0;
    text-align: left;
  }

  .goal-option {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    padding: 16px;
    border: 2px solid var(--background-modifier-border);
    border-radius: 8px;
    background: var(--background-primary);
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .goal-option:hover {
    border-color: var(--interactive-accent-hover);
    background: var(--background-secondary);
  }

  .goal-option.selected {
    border-color: var(--interactive-accent);
    background: var(--background-secondary);
  }

  .goal-radio {
    width: 20px;
    height: 20px;
    border: 2px solid var(--background-modifier-border);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    margin-top: 2px;
  }

  .goal-option.selected .goal-radio {
    border-color: var(--interactive-accent);
  }

  .goal-radio-inner {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: transparent;
    transition: background 0.2s ease;
  }

  .goal-radio-inner.selected {
    background: var(--interactive-accent);
  }

  .goal-content {
    flex: 1;
  }

  .goal-content h3 {
    margin: 0 0 6px 0;
    font-size: 15px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .goal-content p {
    margin: 0 0 8px 0;
    font-size: 13px;
    color: var(--text-muted);
    line-height: 1.4;
  }

  .goal-badge {
    display: inline-block;
    font-size: 11px;
    font-weight: 500;
    color: var(--text-on-accent);
    background: var(--interactive-accent);
    padding: 2px 8px;
    border-radius: 12px;
  }

  .goal-selection-info {
    margin-top: 20px;
    padding: 12px;
    background: var(--background-secondary);
    border-radius: 6px;
    font-size: 14px;
    color: var(--text-normal);
  }

  /* Segmentation slide styles */
  .segmentation-slide {
    text-align: center;
  }

  .segmentation-questions {
    display: flex;
    flex-direction: column;
    gap: 16px;
    margin: 16px 0 0px 0;
    text-align: left;
  }

  .segmentation-question h3 {
    margin: 0 0 8px 0;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-normal);
    text-align: center;
  }

  .multi-select-options {
    display: flex;
    flex-wrap: nowrap;
    gap: 6px;
    justify-content: center;
    overflow-x: auto;
  }

  .multi-select-option {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 6px 10px;
    border: 2px solid var(--background-modifier-border);
    border-radius: 6px;
    background: var(--background-primary);
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: 13px;
    flex-shrink: 0;
  }

  .multi-select-option:hover {
    border-color: var(--interactive-accent-hover);
    background: var(--background-secondary);
  }

  .multi-select-option.selected {
    border-color: var(--interactive-accent);
    background: var(--background-secondary);
    color: var(--interactive-accent);
  }

  .option-checkbox {
    width: 16px;
    height: 16px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 3px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 10px;
    background: var(--background-primary);
  }

  .multi-select-option.selected .option-checkbox {
    border-color: var(--interactive-accent);
    background: var(--interactive-accent);
    color: var(--text-on-accent);
  }

  .radio-options {
    display: flex;
    flex-direction: column;
    gap: 6px;
  }

  .radio-option {
    display: flex;
    align-items: flex-start;
    gap: 10px;
    padding: 10px;
    border: 2px solid var(--background-modifier-border);
    border-radius: 6px;
    background: var(--background-primary);
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .radio-option:hover {
    border-color: var(--interactive-accent-hover);
    background: var(--background-secondary);
  }

  .radio-option.selected {
    border-color: var(--interactive-accent);
    background: var(--background-secondary);
  }

  .option-radio {
    width: 16px;
    height: 16px;
    border: 2px solid var(--background-modifier-border);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    margin-top: 1px;
  }

  .radio-option.selected .option-radio {
    border-color: var(--interactive-accent);
  }

  .radio-inner {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: transparent;
    transition: background 0.2s ease;
  }

  .radio-inner.selected {
    background: var(--interactive-accent);
  }

  .option-content {
    flex: 1;
  }

  .option-label {
    display: block;
    font-size: 13px;
    font-weight: 500;
    color: var(--text-normal);
    margin-bottom: 2px;
  }

  .option-description {
    display: block;
    font-size: 11px;
    color: var(--text-muted);
    line-height: 1.3;
  }

  /* First action slide styles */
  .first-action-slide {
    text-align: center;
  }

  .first-action-icon {
    font-size: 48px;
    margin-bottom: 16px;
  }

  .first-action-content {
    margin: 24px 0;
  }

  .first-action-preview {
    background: var(--background-secondary);
    border-radius: 8px;
    padding: 20px;
    margin: 20px 0;
    text-align: left;
  }

  .first-action-preview h3 {
    margin: 0 0 12px 0;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-normal);
    text-align: center;
  }

  .sample-trade-preview {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .preview-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 0;
    border-bottom: 1px solid var(--background-modifier-border);
  }

  .preview-row:last-child {
    border-bottom: none;
  }

  .preview-label {
    font-weight: 500;
    color: var(--text-muted);
  }

  .preview-value {
    color: var(--text-normal);
  }

  .create-sample-button {
    margin: 20px 0;
  }

  .first-action-note {
    font-size: 12px;
    color: var(--text-muted);
    margin-top: 12px;
  }

  .first-action-success {
    text-align: center;
    margin: 24px 0;
  }

  .success-checkmark {
    font-size: 48px;
    color: var(--color-green);
    margin-bottom: 16px;
  }

  .first-action-success h3 {
    margin: 0 0 12px 0;
    font-size: 16px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .success-actions {
    margin: 20px 0;
    text-align: left;
    max-width: 300px;
    margin-left: auto;
    margin-right: auto;
  }

  .success-action {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 8px 0;
    font-size: 13px;
    color: var(--text-normal);
  }

  .action-icon {
    font-size: 16px;
    flex-shrink: 0;
  }

  .sample-trade-path {
    margin-top: 16px;
    padding: 8px 12px;
    background: var(--background-modifier-border);
    border-radius: 4px;
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
  }

  .sample-trade-path small {
    color: var(--text-muted);
    font-size: 11px;
  }

  .trade-insights {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin: 20px 0;
    text-align: left;
  }

  .insight-card {
    padding: 16px;
    background: var(--background-secondary);
    border-radius: 8px;
    border: 1px solid var(--background-modifier-border);
  }

  .insight-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 8px;
  }

  .insight-icon {
    font-size: 16px;
    flex-shrink: 0;
  }

  .insight-header strong {
    font-size: 13px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .insight-detail {
    font-size: 12px;
    color: var(--text-muted);
    line-height: 1.4;
  }

  /* Authentication slide styles */
  .authentication-slide {
    text-align: center;
  }

  .auth-component-wrapper {
    margin: 16px 0;
    padding: 16px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 8px;
    background: var(--background-secondary);
  }

  .auth-success {
    text-align: center;
    margin: 24px 0;
  }

  .auth-success h2 {
    margin: 0 0 12px 0;
    font-size: 18px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .auth-success-info {
    margin: 20px 0;
    text-align: left;
    max-width: 300px;
    margin-left: auto;
    margin-right: auto;
  }

  .success-feature {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 8px 0;
    font-size: 13px;
    color: var(--text-normal);
  }

  /* FTP credentials slide styles */
  .ftp-credentials-slide {
    text-align: center;
  }

  .ftp-icon {
    font-size: 48px;
    margin-bottom: 16px;
  }

  .ftp-security-note {
    margin: 16px 0;
    padding: 12px;
    background: var(--background-secondary);
    border-radius: 6px;
    border: 1px solid var(--color-green);
  }

  .security-highlight {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 13px;
    color: var(--text-normal);
  }

  .security-icon {
    font-size: 16px;
    color: var(--color-green);
    flex-shrink: 0;
  }

  .ftp-generate-section {
    margin: 24px 0;
  }

  .ftp-info {
    background: var(--background-secondary);
    border-radius: 8px;
    padding: 20px;
    margin: 20px 0;
    text-align: left;
  }

  .ftp-info h3 {
    margin: 0 0 12px 0;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-normal);
    text-align: center;
  }

  .ftp-benefits {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .ftp-benefit {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 8px 0;
    font-size: 13px;
    color: var(--text-normal);
  }

  .generate-ftp-button {
    margin: 20px 0;
  }

  .ftp-credentials-display {
    text-align: center;
    margin: 24px 0;
  }

  .ftp-credentials-display h3 {
    margin: 0 0 12px 0;
    font-size: 16px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .credentials-container {
    background: var(--background-secondary);
    border-radius: 8px;
    padding: 20px;
    margin: 20px 0;
    text-align: left;
  }

  .credential-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 0;
    border-bottom: 1px solid var(--background-modifier-border);
  }

  .credential-row:last-child {
    border-bottom: none;
  }

  .credential-label {
    font-weight: 500;
    color: var(--text-muted);
    min-width: 80px;
  }

  .credential-value-container {
    display: flex;
    align-items: center;
    gap: 8px;
    flex: 1;
    justify-content: flex-end;
  }

  .credential-value {
    background: var(--background-modifier-border);
    padding: 4px 8px;
    border-radius: 4px;
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
    font-size: 12px;
    color: var(--text-normal);
    max-width: 150px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  .ftp-setup-note {
    margin-top: 20px;
    padding: 12px;
    background: var(--background-modifier-border);
    border-radius: 6px;
  }

  .ftp-setup-note p {
    margin: 0;
    font-size: 13px;
    color: var(--text-muted);
  }

  /* Completion slide styles */
  .completion-slide {
    text-align: center;
  }

  .completion-celebration {
    font-size: 64px;
    margin-bottom: 16px;
    animation: bounce 1s ease-in-out;
  }

  @keyframes bounce {
    0%, 20%, 60%, 100% {
      transform: translateY(0);
    }
    40% {
      transform: translateY(-10px);
    }
    80% {
      transform: translateY(-5px);
    }
  }

  .completion-summary {
    margin: 24px 0;
    text-align: left;
    max-width: 400px;
    margin-left: auto;
    margin-right: auto;
  }

  .completion-summary h3 {
    margin: 0 0 16px 0;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-normal);
    text-align: center;
  }

  .accomplishments {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .accomplishment {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 8px 12px;
    background: var(--background-secondary);
    border-radius: 6px;
    font-size: 13px;
    color: var(--text-normal);
  }

  .accomplishment-icon {
    font-size: 16px;
    flex-shrink: 0;
  }

  .accomplishment-status {
    margin-left: auto;
    color: var(--color-green);
    font-weight: 600;
  }

  .completion-actions {
    margin: 32px 0 0 0;
  }

  .start-journaling-button {
    margin-bottom: 20px;
    padding: 16px 32px !important;
    font-size: 18px !important;
    font-weight: 600 !important;
    min-width: 240px !important;
    background: linear-gradient(135deg, var(--interactive-accent), var(--interactive-accent-hover)) !important;
    border: 2px solid var(--interactive-accent) !important;
    box-shadow: 0 4px 12px rgba(var(--interactive-accent-rgb, 124, 77, 255), 0.3) !important;
    transform: scale(1);
    transition: all 0.3s ease !important;
  }

  .start-journaling-button:hover:not(:disabled) {
    transform: scale(1.05);
    box-shadow: 0 6px 20px rgba(var(--interactive-accent-rgb, 124, 77, 255), 0.4) !important;
    background: linear-gradient(135deg, var(--interactive-accent-hover), var(--interactive-accent)) !important;
  }

  .start-journaling-button:active {
    transform: scale(0.98);
  }

  .completion-links {
    display: flex;
    justify-content: center;
    gap: 16px;
    flex-wrap: wrap;
  }

  .completion-link {
    color: var(--interactive-accent);
    text-decoration: none;
    font-size: 12px;
    padding: 4px 8px;
    border-radius: 4px;
    transition: background-color 0.2s ease;
  }

  .completion-link:hover {
    background: var(--interactive-accent-hover);
    color: var(--text-on-accent);
  }

  .wizard-progress-container {
    margin-bottom: 16px;
  }

  .wizard-steps {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
  }

  .wizard-step {
    display: flex;
    flex-direction: column;
    align-items: center;
    flex: 1;
    position: relative;
  }

  .wizard-step-circle {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: var(--background-modifier-border);
    color: var(--text-muted);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    font-weight: 600;
    transition: all 0.2s ease;
  }

  .wizard-step.current .wizard-step-circle {
    background: var(--interactive-accent);
    color: var(--text-on-accent);
  }

  .wizard-step.completed .wizard-step-circle {
    background: var(--color-green);
    color: white;
  }

  .wizard-step-label {
    margin-top: 8px;
    font-size: 12px;
    color: var(--text-muted);
    text-align: center;
    max-width: 110px;

    /* keep every label exactly two lines high */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
    overflow: hidden;
    line-height: 1.2;
    min-height: 2.4em;
  }

  .wizard-progress-track {
    height: 4px;
    background: var(--background-modifier-border);
    border-radius: 2px;
    overflow: hidden;
  }

  .wizard-progress-fill {
    height: 100%;
    background: var(--interactive-accent);
    transition: width 0.3s ease;
  }

  .modal-error {
    margin: 16px 0;
    padding: 8px 12px;
    background: var(--background-modifier-error);
    border: 1px solid var(--text-error);
    border-radius: 4px;
    color: var(--text-on-accent, #ffffff);
    font-size: 13px;
    font-weight: 500;
    text-align: center;
  }

  .modal-actions {
    display: flex;
    gap: 12px;
    margin-top: 0px;
    justify-content: center;
    flex-wrap: wrap;
  }

  .modal-actions button {
    min-width: 90px;
  }

  .modal-footer {
    margin-top: 0px;
    padding-top: 0px;
    border-top: none;
  }

  .modal-footer-text {
    margin: 0;
    font-size: 12px;
    color: var(--text-muted);
    line-height: 1.3;
    text-align: center;
  }

  /* Skip-link: small, subtle, bottom-right */
  .skip-link {
    position: absolute;
    bottom: 16px;
    right: 20px;
    background: none;
    border: none;
    font-size: 12px;
    color: var(--text-muted);
    cursor: pointer;
    padding: 4px 8px;
    border-radius: 4px;
    transition: all 0.2s ease;
    z-index: 10; /* Ensure it stays above other content */
  }
  
  .skip-link:hover {
    color: var(--interactive-accent);
    background: var(--background-modifier-hover);
    text-decoration: none;
  }
  
  .skip-link:focus {
    outline: 2px solid var(--interactive-accent);
    outline-offset: 2px;
  }
  
  .skip-link:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }

  @media (max-width: 480px) {
    .onboarding-wizard-modal {
      padding: 16px;
      max-width: 100%;
    }
    
    .modal-actions {
      flex-direction: column;
    }
    
    .modal-actions button {
      width: 100%;
    }

    .wizard-step-label {
      display: none;
    }
    
    .skip-link {
      position: static;
      margin-top: 16px;
      text-align: center;
      display: block;
      width: fit-content;
      margin-left: auto;
      margin-right: auto;
    }
  }
`;ce.onboardingWizardModal={inject:l1,remove:BO}});function WO(){if(document.head.querySelector("#skeleton-styles"))return;let e=document.createElement("style");e.id="skeleton-styles",e.textContent=Qbe,document.head.appendChild(e)}function yG(){var e;(e=document.head.querySelector("#skeleton-styles"))==null||e.remove()}function Ll(){WO()}var Qbe,Kf=L(()=>{Qbe=`
@keyframes shimmer {
  0% {
    background-position: -1000px 0;
  }
  100% {
    background-position: 1000px 0;
  }
}

.skeleton-shimmer {
  background: linear-gradient(
    90deg,
    var(--background-secondary) 0%,
    var(--background-modifier-border) 50%,
    var(--background-secondary) 100%
  );
  background-size: 1000px 100%;
  animation: shimmer 2s infinite linear;
  pointer-events: none;
  user-select: none;
}
`});var bG={};Ko(bG,{ensureAccountPageStyles:()=>pm,ensureAccountWeightBarStyles:()=>XC,ensureAllDRCStyles:()=>RO,ensureChartStyles:()=>IO,ensureComboBoxStyles:()=>JC,ensureDRCMissedTradesStyles:()=>l0,ensureDRCStyles:()=>ju,ensureDashboardStyles:()=>Sd,ensureImageStyles:()=>yC,ensureMissedTradeNoteStyles:()=>Ev,ensureMonthlyReviewStyles:()=>Dv,ensureOnboardingWizardModalStyles:()=>vG,ensureSharedStyles:()=>Yf,ensureSkeletonStyles:()=>Ll,ensureTradeLogMiniHeaderStyles:()=>a1,ensureTradeLogSettingsModalStyles:()=>Lv,ensureTradeNoteStyles:()=>um,ensureWeeklyReviewStyles:()=>Pv,forceDashboardStyles:()=>Gf,injectBatchActionToolbarStyles:()=>r1,injectDropdownFixScript:()=>hv,injectSettingsTabStyles:()=>GC,injectSkeletonStyles:()=>WO,injectStylesIntoDocument:()=>Cv,removeBatchActionToolbarStyles:()=>n1,removeDropdownFixScript:()=>MC,removeInjectedStyles:()=>Pc,removeSkeletonStyles:()=>yG,removeTradeLogMiniHeaderStyles:()=>i1});function RO(){ju(),uG(),l0()}var ba=L(()=>{kO();n0();qC();TO();aG();iG();o0();Av();am();pG();DO();c0();ow();d0();MO();OO();hG();t1();zO();_O();$O();Kf()});function c1(){if(document.head.querySelector("#trade-form-styles"))return;let e=document.createElement("style");e.id="trade-form-styles",e.textContent=Zbe,document.head.appendChild(e)}function d1(){let e=document.head.querySelector("#trade-form-styles");e&&e.remove()}var Zbe,UO=L(()=>{Zbe=`
  /* Trade Form Modal Styles */
  .trade-form-modal-container .modal-title {
    margin-bottom: 16px;
  }

  /* Modal content styling */
  .trade-form-modal-container {
    max-height: var(--modal-content-height);
    overflow-y: auto;
  }

  /* Trade Form Custom Styles */
  /* Ensure proper overflow handling in container */
  .trade-form-view-container {
    --interactive-accent-rgb: 83, 141, 226;
    --color-error-rgb: 229, 57, 53;
    height: 100% !important;
    overflow-y: auto !important;
    position: relative !important;
    display: flex !important;
    flex-direction: column !important;
    padding: 0 !important;
    margin: 0 !important;
    box-sizing: border-box !important;
  }
  .trade-form-view-container .formContainer {
    display: flex !important;
    flex-direction: column !important;
    gap: 12px !important; /* Consistent gap between all form elements */
    max-width: 800px !important;
    margin: 0 auto !important;
    padding: 16px 20px !important;
    width: 100% !important;
    flex: 1 1 auto !important; /* Allow container to grow/shrink */
    min-height: min-content !important; /* Ensure it's at least as tall as content */
    box-sizing: border-box !important; /* Ensure padding is included in width */
  }
  .trade-form-view-container .formSection {
    display: flex !important;
    flex-direction: column !important;
    padding: 0 !important;
    margin: 0 !important; /* Remove all section margins */
    position: relative !important;
  }
  
  /* Remove all spacing between sections */
  .trade-form-view-container .formSection + .formSection {
    padding: 0 !important;
    margin: 0 !important;
  }
  .trade-form-view-container .sectionTitle {
    font-size: 18px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    margin-bottom: 4px !important;
    display: none !important; /* Hide the original section title */
  }
  .trade-form-view-container .minimizedSectionTitle {
    font-size: 16px !important;
    font-weight: 500 !important;
    color: var(--text-muted) !important;
    margin-bottom: 8px !important;
    text-transform: uppercase !important;
    letter-spacing: 0.5px !important;
  }
  .trade-form-view-container .sectionDescription {
    font-size: 16px !important;
    color: var(--text-muted) !important;
    margin-bottom: 16px !important;
    display: none !important; /* Hide the section description */
  }
  .trade-form-view-container .formTitle {
    font-size: 20px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    margin-bottom: 8px !important;
  }
  .trade-form-view-container .sectionContent {
    display: flex !important;
    flex-direction: column !important;
    gap: 12px !important; /* Consistent gap matching form container */
    margin: 0 !important;
    padding: 0 !important;
  }
  
  .trade-form-view-container .field {
    margin: 0 !important; /* Remove all field margins */
    padding: 0 !important; /* Remove all field padding */
  }
  .trade-form-view-container input,
  .trade-form-view-container textarea {
    box-sizing: border-box !important;
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    color: var(--text-normal) !important;
    border-radius: 4px !important;
    padding: 8px 12px !important;
    width: 100% !important;
    font-size: 16px !important;
  }

  /* Placeholder styling for inputs */
  .trade-form-view-container input::placeholder,
  .trade-form-view-container textarea::placeholder {
    color: var(--text-muted) !important;
    opacity: 0.7 !important;
  }
  /* Specific styles for select elements to fix text cutoff */
  .trade-form-view-container select,
  .trade-form-view-container .journalit-select {
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    color: var(--text-normal) !important;
    border-radius: 4px !important;
    padding: 8px 30px 8px 12px !important; /* Extra right padding for dropdown arrow */
    width: 100% !important;
    font-size: 16px !important;
    min-height: 38px !important; /* Ensure minimum height */
    line-height: 1.5 !important; /* Improve text rendering */
    text-overflow: ellipsis !important; /* Show ellipsis for long text */
  }

  /* Style for select with no value selected (to show grey placeholder) */
  .trade-form-view-container select:invalid,
  .trade-form-view-container select:not([value]),
  .trade-form-view-container select[value=""] {
    color: var(--text-muted) !important;
    opacity: 0.7 !important; /* Match input placeholder opacity */
  }

  /* Make sure selected values display normally */
  .trade-form-view-container select[data-has-value="true"] {
    color: var(--text-normal) !important;
    opacity: 1 !important;
  }

  /* Make the select placeholder text appear greyed out */
  .trade-form-view-container select option[value=""][disabled],
  .trade-form-view-container select option:first-child:not([value]),
  .trade-form-view-container select option:first-child[value=""],
  .trade-form-view-container .select-placeholder,
  .trade-form-view-container option.select-placeholder {
    color: var(--text-muted) !important;
    opacity: 0.7 !important;
  }

  /* Make sure all option values display normally */
  .trade-form-view-container select option:not([value=""]):not(:disabled),
  .trade-form-view-container select option:not(.select-placeholder),
  .trade-form-view-container select option:checked {
    color: var(--text-normal) !important;
    opacity: 1 !important;
  }
  /* Fix for date input fields to prevent text from overlapping with calendar icon */
  .trade-form-view-container input[type="date"] {
    padding-left: 35px !important; /* Move text to the right to make room for the calendar icon */
    padding-right: 15px !important;
    min-width: 150px !important; /* Ensure minimum width for date inputs */
  }
  /* Fix for time input fields to move clock icon to the left */
  .trade-form-view-container input[type="time"] {
    padding-left: 35px !important; /* Move text to the right to make room for the clock icon */
    padding-right: 15px !important;
    min-width: 110px !important; /* Ensure minimum width for time inputs */
  }
  /* Target the calendar picker indicator to move it to the left */
  .trade-form-view-container input[type="date"]::-webkit-calendar-picker-indicator,
  .trade-form-view-container input[type="time"]::-webkit-calendar-picker-indicator {
    position: absolute !important;
    left: 10px !important;
    top: 50% !important;
    transform: translateY(-50%) !important;
    margin: 0 !important;
    z-index: 2 !important; /* Ensure the icon appears above other elements */
  }
  /* Alternative method using appearance property */
  .trade-form-view-container input[type="date"],
  .trade-form-view-container input[type="time"] {
    position: relative !important;
    appearance: none !important;
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    background-image: var(--calendar-icon, initial) !important;
    background-repeat: no-repeat !important;
    background-position: 10px center !important;
  }
  /* Provide calendar icon as background */
  .trade-form-view-container input[type="date"] {
    /* Default icon will be provided by the browser */
  }
  /* Provide clock icon as background */
  .trade-form-view-container input[type="time"] {
    /* Default icon will be provided by the browser */
  }
  /* Support for Firefox */
  @-moz-document url-prefix() {
    .trade-form-view-container input[type="date"],
    .trade-form-view-container input[type="time"] {
      position: relative !important;
      background-position: 10px center !important;
    }
  }
  /* Ensure proper scrolling for the entire container */
  body {
    overflow: hidden !important; /* Prevent double scrollbars */
  }
  /* Ensure proper scrolling for main container */
  .trade-form-view-container {
    overflow-y: auto !important; /* Enable vertical scrolling */
    max-height: 100vh !important; /* Limit to viewport height */
  }
  
  /* Eliminate double scrollbars when the trade form is rendered inside an Obsidian modal */
  .modal .trade-form-view-container,
  .modal-content .trade-form-view-container {
    height: auto !important;
    max-height: none !important;
    overflow: visible !important; /* Let the modal content handle scrolling */
  }
  /* React root element should expand properly */
  #trade-form-root {
    height: 100% !important;
    min-height: 100% !important;
    display: flex !important;
    flex-direction: column !important;
    flex: 1 1 auto !important;
  }
  /* Form container needs to expand fully */
  .formContainer {
    display: flex !important;
    flex-direction: column !important;
    min-height: min-content !important;
    height: auto !important; /* Prevent inner container from managing its own scrolling */
    flex: 1 1 auto !important;
    overflow: visible !important; /* Avoid nested scrollbars inside modal */
  }
  /* Removing extra gap between form title and first section */
  .trade-form-view-container .formHeader {
    margin-bottom: 0 !important;
    padding-bottom: 0 !important;
  }

  /* Reduce the spacing between form elements */
  .trade-form-view-container > div, 
  .trade-form-view-container > form > div {
    margin-bottom: 0 !important;
  }

  /* Fix the gap at the top of the form */
  .trade-form-view-container .formHeader + div,
  .trade-form-view-container .formHeader + .formSection {
    margin-top: 0 !important;
  }

  /* Fix the specific gap between form title and first section */
  .trade-form-view-container .formTitle + .formSection,
  .trade-form-view-container .formHeader + .formSection,
  .trade-form-view-container .errorSummary + .formSection {
    margin-top: 12px !important;
  }
  /* ComboBox specific styles - attribute-based selectors for Obsidian compatibility */
  .trade-form-view-container .combobox-container,
  .trade-form-view-container [data-combobox-type] {
    position: relative !important;
    width: 100% !important;
    margin-bottom: 8px !important;
    /* Use higher z-index when dropdown is open to ensure it stays above other elements */
    z-index: 10 !important;
  }

  /* Increase z-index when dropdown is open to ensure it stays above other elements */
  .trade-form-view-container [data-is-open="true"] {
    z-index: 9999 !important;
  }

  /* Style for input container to properly position dropdown */
  .trade-form-view-container [data-combobox-type] > .input-container {
    position: relative !important;
    margin: 0 !important;
    padding: 0 !important;
    /* Ensure it's above other elements but below the dropdown */
    z-index: 1 !important;
  }

  /* Styling for selected items in multi-select */
  .trade-form-view-container .selected-item {
    display: inline-flex !important;
    align-items: center !important;
    margin: 0 4px 4px 0 !important;
    padding: 4px 8px !important;
    background-color: var(--interactive-accent) !important;
    color: white !important;
    border-radius: 4px !important;
    font-size: 12px !important;
    gap: 6px !important;
  }

  .trade-form-view-container .selected-item button {
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    width: 16px !important;
    height: 16px !important;
    min-width: 16px !important; /* Prevent shrinking */
    min-height: 16px !important; /* Prevent shrinking */
    padding: 0 !important;
    background: rgba(255, 255, 255, 0.2) !important; /* Add visible background */
    border: none !important;
    color: white !important;
    font-size: 16px !important;
    line-height: 1 !important;
    cursor: pointer !important;
    border-radius: 50% !important; /* Make it round */
    margin-left: 4px !important;
    position: relative !important; /* Create stacking context */
    z-index: 5 !important; /* Ensure it's above other elements */
    transition: background-color 0.2s !important;
  }

  .trade-form-view-container .selected-item button:hover {
    background: rgba(255, 255, 255, 0.4) !important; /* Brighter on hover */
  }

  .trade-form-view-container [data-combobox-type] > div:nth-child(2) {
    position: relative !important;
    width: 100% !important;
  }
  /* Add dropdown caret to the input container */
  .trade-form-view-container [data-combobox-type] .input-container::after {
    content: "" !important;
    position: absolute !important;
    right: 12px !important;
    top: 50% !important;
    transform: translateY(-50%) !important;
    width: 0 !important;
    height: 0 !important;
    border-left: 5px solid transparent !important;
    border-right: 5px solid transparent !important;
    border-top: 5px solid var(--text-normal) !important;
    pointer-events: none !important;
    z-index: 10 !important;
  }
  /* Rotate caret when dropdown is open */
  .trade-form-view-container [data-combobox-type][data-is-open="true"] .input-container::after {
    transform: translateY(-50%) rotate(180deg) !important;
  }
  .trade-form-view-container [data-combobox-type] input[role="combobox"] {
    width: 100% !important;
    padding: 8px 12px !important;
    padding-right: 30px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    font-size: 16px !important;
    cursor: pointer !important;
  }
  /* When dropdown is open, change input border radius */
  .trade-form-view-container [data-combobox-type][data-is-open="true"] input[role="combobox"] {
    border-bottom-left-radius: 0 !important;
    border-bottom-right-radius: 0 !important;
  }
  .trade-form-view-container [data-combobox-type] input[role="combobox"]:focus {
    border-color: var(--interactive-accent) !important;
    box-shadow: 0 0 0 2px rgba(83, 141, 226, 0.3) !important;
    outline: none !important;
  }
  /* Dropdown list styling */
  .trade-form-view-container [data-combobox-type] ul[role="listbox"] {
    position: absolute !important;
    top: 38px !important; /* Position exactly at the bottom of input by using a fixed value */
    left: 0 !important;
    right: 0 !important;
    max-height: 200px !important;
    overflow-y: auto !important;
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-top: none !important; /* Remove top border to create seamless connection */
    border-radius: 0 0 4px 4px !important; /* Only round the bottom corners */
    margin-top: -1px !important; /* Negative margin to pull up and overlap with input border */
    z-index: 9999 !important; /* Higher z-index to ensure dropdown stays above other elements */
    list-style: none !important;
    padding: 0 !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
    animation: dropdown-fade-in 150ms ease-out !important;
    pointer-events: auto !important; /* Ensure clicks on the dropdown are detected */
  }
  /* Dropdown option styling */
  .trade-form-view-container [data-combobox-type] ul[role="listbox"] li {
    padding: 8px 12px !important;
    cursor: pointer !important;
    transition: background-color 150ms ease !important;
    margin: 0 !important;
  }
  /* Hover and highlighted state for options */
  .trade-form-view-container [data-combobox-type] ul[role="listbox"] li:hover,
  .trade-form-view-container [data-combobox-type] ul[role="listbox"] li[aria-selected="true"] {
    background-color: var(--background-secondary) !important;
  }
  /* Multi-select tags container */
  .trade-form-view-container [data-combobox-type="multi"] > div:first-of-type {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 4px !important;
    margin-bottom: 4px !important;
  }
  /* Individual tag styling */
  .trade-form-view-container [data-combobox-type="multi"] > div:first-of-type > span {
    display: inline-flex !important;
    align-items: center !important;
    padding: 2px 8px !important;
    background-color: var(--interactive-accent) !important;
    color: white !important;
    border-radius: 4px !important;
    font-size: 12px !important;
  }
  /* Remove button in tags */
  .trade-form-view-container [data-combobox-type="multi"] > div:first-of-type > span > button {
    background: none !important;
    border: none !important;
    color: white !important;
    cursor: pointer !important;
    font-size: 16px !important;
    line-height: 1 !important;
    padding: 0 4px !important;
    margin-left: 4px !important;
    /* Enhanced pointer events to ensure clicks are registered */
    pointer-events: auto !important;
    /* Make the button visually stand out more */
    opacity: 0.8 !important;
    transition: opacity 0.2s !important;
  }
  /* Add hover effects to make it clear it's clickable */
  .trade-form-view-container [data-combobox-type="multi"] > div:first-of-type > span > button:hover {
    opacity: 1 !important;
  }
  /* Special styling for "Add new" option */
  .trade-form-view-container [data-combobox-type] ul[role="listbox"] li[data-add-option="true"] {
    font-style: italic !important;
    border-top: 1px dashed var(--background-modifier-border) !important;
  }
  /* Animation for dropdown appearance */
  @keyframes dropdown-fade-in {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  /* Fix for option visibility in dropdowns */
  .trade-form-view-container select option {
    padding: 8px 12px !important;
    font-size: 16px !important;
    line-height: 1.5 !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
  }

  /* Make the select placeholder text appear greyed out */
  .trade-form-view-container select option[value=""][disabled],
  .trade-form-view-container select option:first-child:not([value]),
  .trade-form-view-container select option:first-child[value=""],
  .trade-form-view-container .select-placeholder,
  .trade-form-view-container option.select-placeholder {
    color: var(--text-muted) !important;
    font-style: italic !important; 
  }
  .trade-form-view-container input:focus,
  .trade-form-view-container select:focus,
  .trade-form-view-container textarea:focus {
    border-color: var(--interactive-accent) !important;
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.3) !important;
    outline: none !important;
  }
  .trade-form-view-container .label {
    display: block !important;
    font-size: 13px !important;
    font-weight: 500 !important;
    margin-bottom: 4px !important;
    color: var(--text-normal) !important;
  }
  .trade-form-view-container .errorMessage {
    font-size: 11px !important;
    color: var(--text-error) !important;
    margin-top: 2px !important;
    padding-left: 1px !important;
  }
  .trade-form-view-container button {
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    padding: 8px 16px !important;
    border-radius: 4px !important;
    cursor: pointer !important;
    font-weight: 500 !important;
    font-size: 16px !important;
  }
  .trade-form-view-container button.primary {
    background-color: var(--interactive-accent) !important;
    color: var(--text-on-accent) !important;
    border: 1px solid var(--interactive-accent) !important;
  }
  .trade-form-view-container button.primary:hover:not(:disabled) {
    background-color: var(--interactive-accent-hover) !important;
    border-color: var(--interactive-accent-hover) !important;
  }
  .trade-form-view-container button.outline {
    background-color: transparent !important;
    color: var(--interactive-accent) !important;
    border: 1px solid var(--interactive-accent) !important;
  }
  .trade-form-view-container button.outline:hover:not(:disabled) {
    background-color: rgba(var(--interactive-accent-rgb), 0.1) !important;
  }
  /* Style for default values like 0.00 to make them look like placeholders */
  .trade-form-view-container input.default-value {
    color: var(--text-muted) !important;
    font-style: italic !important;
  }
  /* When a default value input is focused, reset the text style */
  .trade-form-view-container input.default-value:focus {
    color: var(--text-normal) !important;
    font-style: normal !important;
  }
  .trade-form-view-container .formActions {
    display: flex !important;
    justify-content: space-between !important;
    gap: 16px !important;
    margin-top: 4px !important; /* Small top margin */
    margin-bottom: 16px !important; /* Reduced bottom margin */
    padding: 0 !important;
  }
  .trade-form-view-container .twoColumnLayout {
    display: grid !important;
    grid-template-columns: 1fr 1fr !important;
    gap: 12px !important; /* Match other gaps */
    margin: 0 !important;
    padding: 0 !important;
  }
  /* Date picker container styling */
  .trade-form-view-container .date-picker-container {
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important;
  }
  @media (max-width: 600px) {
    .trade-form-view-container .twoColumnLayout {
      grid-template-columns: 1fr !important;
    }
  }
  .trade-form-view-container .calculatedValue {
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    text-align: center !important;
    padding: 12px !important;
    background-color: var(--background-secondary) !important;
    border-radius: 4px !important;
    margin: 0 !important; /* Remove all margins to maintain consistent spacing */
    width: 100% !important;
  }
  .trade-form-view-container .calculatedLabel {
    font-size: 12px !important;
    color: var(--text-muted) !important;
  }
  .trade-form-view-container .calculatedAmount {
    font-size: 18px !important;
    font-weight: 600 !important;
  }
  .trade-form-view-container .positive {
    color: var(--color-green) !important;
  }
  .trade-form-view-container .negative {
    color: var(--color-red) !important;
  }
  .trade-form-view-container .neutral {
    color: var(--text-normal) !important;
  }

  /* Asset Type Button Styles - Pill Style */
  .trade-form-view-container .asset-type-container {
    display: grid !important;
    grid-template-columns: repeat(3, 1fr) !important;
    grid-template-rows: repeat(2, 1fr) !important;
    gap: 8px !important;
    width: 100% !important;
    margin-bottom: 12px !important;
  }

  .trade-form-view-container .asset-type-button {
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 6px !important;
    padding: 8px 4px !important;
    font-size: 13px !important;
    height: 34px !important;
    transition: background-color 0.2s, border-color 0.2s !important;
    cursor: pointer !important;
    margin: 0 !important;
  }

  .trade-form-view-container .asset-type-button[aria-checked="true"] {
    background-color: var(--interactive-accent) !important;
    border-color: var(--interactive-accent) !important;
    color: white !important;
    font-weight: 500 !important;
  }

  .trade-form-view-container .asset-type-button:hover:not([aria-checked="true"]) {
    background-color: var(--background-secondary-alt) !important;
  }

  /* Asset-specific fields styling for consistent spacing */
  .trade-form-view-container .asset-specific-fields {
    display: flex !important;
    flex-direction: column !important;
    gap: 12px !important; /* Match the gap used in form container and section content */
    width: 100% !important;
    margin-bottom: 12px !important; /* Match other section spacing */
  }

  /* Direction Button Styles - Using the same pill style as Asset Type buttons */
  .trade-form-view-container .direction-container {
    display: flex !important;
    width: 100% !important;
    gap: 8px !important;
    margin-bottom: 12px !important;
  }

  .trade-form-view-container .direction-button {
    flex: 1 !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 6px !important;
    padding: 8px 4px !important;
    font-size: 13px !important;
    height: 34px !important;
    transition: background-color 0.2s, border-color 0.2s !important;
    cursor: pointer !important;
    margin: 0 !important;
  }

  /* Remove border-right as we're now using individual pills */
  /* .trade-form-view-container .direction-button:not(:last-child) {
    border-right: 1px solid var(--background-modifier-border) !important;
  } */

  .trade-form-view-container .direction-button[aria-checked="true"] {
    background-color: var(--interactive-accent) !important;
    color: white !important;
  }

  .trade-form-view-container .direction-button:hover:not([aria-checked="true"]) {
    background-color: var(--background-secondary-alt) !important;
  }

  /* Required field indicator */
  .trade-form-view-container .required-indicator {
    color: var(--text-error) !important;
    margin-left: 4px !important;
    font-weight: bold !important;
  }

  .trade-form-view-container .thesisField {
    min-height: 100px !important;
  }
  .trade-form-view-container .tagContainer {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 4px !important;
    margin-top: 4px !important;
  }
  .trade-form-view-container .tag {
    display: inline-flex !important;
    align-items: center !important;
    padding: 4px 8px !important;
    background-color: var(--background-secondary) !important;
    border-radius: 2px !important;
    font-size: 12px !important;
    gap: 4px !important;
  }
  .trade-form-view-container .removeTag {
    cursor: pointer !important;
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    width: 16px !important;
    height: 16px !important;
    border-radius: 50% !important;
    background-color: rgba(0, 0, 0, 0.1) !important;
  }
  .trade-form-view-container .errorSummary {
    background-color: rgba(229, 57, 53, 0.05) !important;
    border: 1px solid rgba(229, 57, 53, 0.5) !important;
    color: var(--text-error) !important;
    padding: 10px 12px !important;
    border-radius: 4px !important;
    margin-bottom: 16px !important;
    font-size: 13px !important;
    line-height: 1.4 !important;
    font-weight: 400 !important;
    box-shadow: none !important;
  }

  @keyframes errorPulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.02); }
    100% { transform: scale(1); }
  }

  /* Drag and drop styles */
  .trade-form-view-container .formContainer.is-dragging-over {
    position: relative !important;
  }

  .trade-form-view-container .drag-overlay {
    position: fixed !important; /* Fixed to viewport instead of absolute */
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    background-color: rgba(var(--background-primary-rgb, 255, 255, 255), 0.4) !important; /* Reduced opacity */
    backdrop-filter: blur(3px) !important;
    -webkit-backdrop-filter: blur(3px) !important;
    display: flex !important;
    justify-content: center !important;
    align-items: center !important;
    z-index: 9999 !important;
    animation: fade-in 0.2s ease-out !important;
  }

  .trade-form-view-container .drag-message-container {
    position: fixed !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important; /* Center in viewport */
    z-index: 10000 !important;
  }

  .trade-form-view-container .drag-message {
    font-size: 22px !important;
    font-weight: 400 !important; /* Lighter weight */
    font-family: var(--font-interface, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif) !important;
    color: var(--interactive-accent) !important;
    background-color: rgba(var(--background-primary-rgb, 255, 255, 255), 0.7) !important; /* Reduced opacity */
    padding: 14px 28px !important;
    border-radius: 6px !important;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08) !important; /* More subtle shadow */
    letter-spacing: 0.5px !important;
    border: 1px solid rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.5) !important; /* Semi-transparent border */
    white-space: nowrap !important;
  }

  /* Responsive styles for small screens */
  @media (max-width: 600px) {
    .trade-form-view-container input,
    .trade-form-view-container textarea,
    .trade-form-view-container select,
    .trade-form-view-container .journalit-select {
      font-size: 18px !important;
    }
  }

  @keyframes fade-in {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  @keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
  }

  /* Tab Navigation */
  .trade-form-view-container .journalit-tab-nav {
    display: flex;
    border-bottom: 1px solid var(--background-modifier-border);
    margin-bottom: 20px;
    justify-content: center;
    width: 100%;
    padding-top: 10px;
    padding-bottom: 0;
    position: sticky;
    top: -10px;
    background-color: var(--background-primary);
    z-index: 100;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }

  .trade-form-view-container .journalit-tab-wrapper {
    display: flex;
    justify-content: center;
    flex: 1;
  }

  .trade-form-view-container .journalit-tab-button {
    background: transparent;
    border: none;
    border-bottom: 2px solid transparent;
    padding: 10px 20px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    color: var(--text-muted);
    transition: all 0.2s ease;
    position: relative;
  }

  .trade-form-view-container .journalit-tab-button:hover {
    color: var(--text-normal);
    background-color: var(--background-modifier-hover);
  }

  .trade-form-view-container .journalit-tab-button.journalit-tab-active {
    color: var(--text-normal);
    font-weight: 600;
    border-bottom-color: var(--text-accent);
  }

  .trade-form-view-container .journalit-tab-error-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    background-color: var(--text-error);
    color: white;
    border-radius: 10px;
    font-size: 10px;
    font-weight: 600;
    padding: 2px 6px;
    margin-left: 6px;
    min-width: 18px;
  }

  /* Edit Mode Badge */
  .trade-form-view-container .journalit-edit-badge {
    position: absolute;
    right: 16px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 12px;
    color: white;
    background-color: var(--interactive-accent);
    padding: 4px 10px;
    border-radius: 12px;
    font-weight: 700;
    letter-spacing: 0.8px;
    text-transform: uppercase;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12);
  }
`});function txe(){if(document.getElementById(xG))return;let e=document.createElement("style");e.id=xG,e.textContent=exe,document.head.appendChild(e)}function wG(){txe()}var exe,xG,kG=L(()=>{exe=`
/* Radio Option Group - Default variant */
.radio-options {
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.radio-option {
  display: flex;
  align-items: flex-start;
  gap: 10px;
  padding: 10px;
  border: 2px solid var(--background-modifier-border);
  border-radius: 6px;
  background: var(--background-primary);
  cursor: pointer;
  transition: all 0.2s ease;
}

.radio-option:hover {
  border-color: var(--interactive-accent-hover);
  background: var(--background-secondary);
}

.radio-option.selected {
  border-color: var(--interactive-accent);
  background: var(--background-secondary);
}

.option-radio {
  width: 16px;
  height: 16px;
  border: 2px solid var(--background-modifier-border);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  margin-top: 1px;
}

.radio-option.selected .option-radio {
  border-color: var(--interactive-accent);
}

.radio-inner {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: transparent;
  transition: background 0.2s ease;
}

.radio-inner.selected {
  background: var(--interactive-accent);
}

.option-content {
  flex: 1;
}

.option-label {
  display: block;
  font-size: 13px;
  font-weight: 500;
  color: var(--text-normal);
  margin-bottom: 2px;
}

.option-description {
  display: block;
  font-size: 11px;
  color: var(--text-muted);
  line-height: 1.3;
}

/* Radio Option Group - Goal variant (larger cards) */
.goal-options {
  display: flex;
  flex-direction: column;
  gap: 16px;
  margin: 24px 0;
  text-align: left;
}

.goal-option {
  display: flex;
  align-items: flex-start;
  gap: 12px;
  padding: 16px;
  border: 2px solid var(--background-modifier-border);
  border-radius: 8px;
  background: var(--background-primary);
  cursor: pointer;
  transition: all 0.2s ease;
}

.goal-option:hover {
  border-color: var(--interactive-accent-hover);
  background: var(--background-secondary);
}

.goal-option.selected {
  border-color: var(--interactive-accent);
  background: var(--background-secondary);
}

.goal-radio {
  width: 20px;
  height: 20px;
  border: 2px solid var(--background-modifier-border);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  margin-top: 2px;
}

.goal-option.selected .goal-radio {
  border-color: var(--interactive-accent);
}

.goal-radio-inner {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: transparent;
  transition: background 0.2s ease;
}

.goal-radio-inner.selected {
  background: var(--interactive-accent);
}

.goal-content {
  flex: 1;
}

.goal-badge {
  display: inline-block;
  font-size: 11px;
  font-weight: 500;
  color: var(--text-on-accent);
  background: var(--interactive-accent);
  padding: 2px 8px;
  border-radius: 12px;
}
`,xG="radio-option-styles"});var TG={};Ko(TG,{TradeFormModal:()=>jo});var Nv,Jf,SG,jo,rxe,VO,Td=L(()=>{Nv=q(Y()),Jf=require("obsidian"),SG=q(wn());eG();ba();UO();kG();rr();jo=class extends Jf.Modal{constructor(r){super(r.app);this.container=null;this.root=null;this.checkForUnsavedChanges=null;this.isConfirming=!1;this.confirmationModal=null;this.shouldBypassUnsavedCheck=!1;this.props=r}close(){if(!this.isConfirming){if(this.shouldBypassUnsavedCheck){this.shouldBypassUnsavedCheck=!1,super.close();return}this.checkForUnsavedChanges&&this.checkForUnsavedChanges()?(this.isConfirming=!0,this.showUnsavedChangesConfirmation().then(r=>{r&&super.close()}).finally(()=>{this.isConfirming=!1,this.confirmationModal=null})):super.close()}}showUnsavedChangesConfirmation(){return new Promise(r=>{this.confirmationModal=new VO(this.props.app,r),this.confirmationModal.open()})}setUnsavedChangesChecker(r){this.checkForUnsavedChanges=r}closeAfterSuccessfulSubmit(){this.shouldBypassUnsavedCheck=!0,this.close()}onOpen(){let{contentEl:r}=this;r.empty(),Yf(),JC(),wG(),c1();try{let n=document.activeElement;n&&typeof n.blur=="function"&&n.blur()}catch(n){}this.container=r.createDiv({cls:"trade-form-modal-container trade-form-view-container"}),this.renderComponent()}onClose(){this.root&&(this.root.unmount(),this.root=null),d1();let{contentEl:r}=this;r.empty()}renderComponent(){this.container&&(this.root=(0,SG.createRoot)(this.container),this.root.render(Nv.default.createElement(cs,null,Nv.default.createElement(rxe,{app:this.props.app,plugin:this.props.plugin,isEditMode:!!this.props.isEditMode,initialData:this.props.initialData||{},filePath:this.props.filePath||"",onModalClose:()=>this.close(),onSuccessfulSubmit:()=>this.closeAfterSuccessfulSubmit(),onDirtyStateChange:r=>this.setUnsavedChangesChecker(r)}))))}},rxe=({plugin:e,isEditMode:t,initialData:r,filePath:n,onModalClose:o,onSuccessfulSubmit:a,onDirtyStateChange:i})=>{let[s,l]=(0,Nv.useState)(!1),c=async()=>{try{return e.missedTradeService?e.missedTradeService:await e.serviceManager.getMissedTradeService()}catch(m){throw new Error("Missed trade service is not initialized. Please wait a moment and try again.")}},d=async()=>{try{return e.backtestTradeService?e.backtestTradeService:await e.serviceManager.getBacktestTradeService()}catch(m){throw new Error("Backtest trade service is not initialized. Please wait a moment and try again.")}};return Nv.default.createElement(Qq,{initialData:r||{},isSubmitting:s,isEditMode:t,onSubmit:async m=>{try{l(!0);let f="",g=m.isMissedTrade===!0,v={entryTime:m.entryTime,exitTime:m.exitTime,entryPrice:m.entryPrice,exitPrice:m.exitPrice,positionSize:m.positionSize,direction:m.direction,entries:m.entries||[],exits:m.exits||[],setupIds:m.setupIds||[],mistakeIds:m.mistakeIds||[],accountIds:m.accountIds||[],thesis:m.thesis,images:m.images,instrument:m.instrument,assetType:m.assetType,setup:m.setup,mistake:m.mistake,account:m.account,tags:m.tags,commission:m.commission,commissionType:m.commissionType,fees:m.fees,swap:m.swap,stopLoss:m.stopLoss,riskAmount:m.riskAmount,useDirectPnLInput:m.useDirectPnLInput,directPnL:m.directPnL,rebate:m.rebate,isMissedTrade:m.isMissedTrade,missedReason:m.missedReason,isBacktestTrade:m.isBacktestTrade||!1,customFields:m.customFields,customTags:m.customTags};if(m.assetType==="stock"?m.exchange&&(v.exchange=m.exchange):m.assetType==="options"?(m.expirationDate&&(v.expirationDate=new Date(m.expirationDate)),m.strikePrice!==void 0&&(v.strikePrice=m.strikePrice),m.optionType&&(v.optionType=m.optionType),m.contractSize!==void 0&&(v.contractSize=m.contractSize)):m.assetType==="futures"?(m.dollarPerPoint!==void 0&&(v.dollarPerPoint=m.dollarPerPoint),m.tickSize!==void 0&&(v.tickSize=m.tickSize),m.tickValue!==void 0&&(v.tickValue=m.tickValue)):m.assetType==="forex"?(m.lotSize!==void 0&&(v.lotSize=m.lotSize),m.pipValue!==void 0&&(v.pipValue=m.pipValue)):m.assetType==="crypto"?m.cryptoExchange&&(v.cryptoExchange=m.cryptoExchange):m.assetType==="cfd"&&m.leverageRatio!==void 0&&(v.leverageRatio=m.leverageRatio),t&&(v.originalPnl=r==null?void 0:r.pnl),t){g?f=await(await c()).updateMissedTrade(v,n||""):m.isBacktestTrade?f=await(await d()).updateBacktestTrade(v,n||"")?n||"backtest trade":"":f=await e.tradeService.updateTrade(v,n||"");let h=m.isBacktestTrade?"Backtest trade":g?"Missed trade":"Trade";new Jf.Notice(`${h} updated: ${f}`)}else{if(m.isBacktestTrade){let b=await(await d()).createBacktestTrade(v,{openFile:!0,images:m.images,customFields:m.customFields});f=b?b.path:""}else g?f=await(await c()).createMissedTrade(v):f=await e.tradeService.createTrade(v);let h=m.isBacktestTrade?"Backtest trade":g?"Missed trade":"Trade";new Jf.Notice(`${h} created: ${f}`)}try{m.assetType&&(e.settings.trade.lastAssetType=m.assetType,await e.saveSettings())}catch(h){console.error("Error saving asset type preference:",h)}a()}catch(f){console.error(`Failed to ${t?"update":"create"} trade:`,f),new Jf.Notice(`Failed to ${t?"update":"create"} trade: ${(f==null?void 0:f.message)||"Unknown error"}`),l(!1)}},onCancel:()=>{o()},onDirtyStateChange:i})},VO=class extends Jf.Modal{constructor(r,n){super(r);this.onConfirm=n;this.resolved=!1}onOpen(){let{contentEl:r}=this;r.empty(),r.createEl("h3",{text:"Unsaved Changes",cls:"modal-title"}),r.createEl("p",{text:"You have unsaved changes in the trade form. Are you sure you want to close without saving?"});let n=r.createDiv({cls:"modal-button-container"});n.createEl("button",{type:"button",text:"Continue Editing",cls:"mod-cta"}).addEventListener("click",()=>{this.resolved||(this.resolved=!0,this.onConfirm(!1)),this.close()}),n.createEl("button",{type:"button",text:"Discard Changes",cls:"mod-warning"}).addEventListener("click",()=>{this.resolved||(this.resolved=!0,this.onConfirm(!0)),this.close()})}close(){super.close(),this.resolved||(this.resolved=!0,this.onConfirm(!1))}onClose(){let{contentEl:r}=this;r.empty()}}});var NG={};Ko(NG,{accountLinkModalStyles:()=>LG,injectAccountLinkModalStyles:()=>qO,removeAccountLinkModalStyles:()=>GO});function qO(){if(document.getElementById(HO))return;let e=document.createElement("style");e.id=HO,e.textContent=LG,document.head.appendChild(e)}function GO(){let e=document.getElementById(HO);e&&e.remove()}var HO,LG,YO=L(()=>{HO="journalit-account-link-modal-styles",LG=`
  .account-link-modal {
    padding: 16px;
    font-family: var(--font-text);
    color: var(--text-normal);
    min-width: 450px;
  }

  .account-link-modal h3 {
    margin-top: 0;
    margin-bottom: 16px;
    font-size: 1.3rem;
    font-weight: 600;
    color: var(--text-normal);
    border-bottom: 1px solid var(--background-modifier-border);
    padding-bottom: 8px;
  }

  .account-link-modal .account-info {
    background-color: var(--background-secondary);
    padding: 12px 16px;
    border-radius: 6px;
    margin-bottom: 20px;
    border: 1px solid var(--background-modifier-border);
  }

  .account-link-modal .account-info p {
    margin: 4px 0;
    font-size: 0.9rem;
  }

  .account-link-modal .account-info strong {
    font-weight: 600;
    margin-right: 8px;
    color: var(--text-muted);
  }

  .account-link-modal .modal-field {
    margin-bottom: 16px;
  }

  .account-link-modal .section-label {
    display: block;
    margin-bottom: 12px;
    font-weight: 500;
    font-size: 0.95rem;
    color: var(--text-normal);
  }

  .account-link-modal .link-option-group {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .account-link-modal .link-option {
    display: flex;
    align-items: center;
    padding: 8px 12px;
    border-radius: 4px;
    cursor: pointer;
    transition: background-color 0.1s ease;
  }

  .account-link-modal .link-option:hover {
    background-color: var(--background-modifier-hover);
  }

  .account-link-modal .link-option input[type="radio"] {
    margin-right: 10px;
    cursor: pointer;
  }

  .account-link-modal .link-option span {
    flex: 1;
    font-size: 0.9rem;
  }

  .account-link-modal .custom-name-input,
  .account-link-modal .existing-account-select {
    margin-left: 32px;
    margin-top: 8px;
    margin-bottom: 12px;
  }

  .account-link-modal .modal-input,
  .account-link-modal .modal-select {
    width: 100%;
    padding: 8px 10px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    font-size: 0.9rem;
    min-height: 36px;
  }

  .account-link-modal .modal-input:focus,
  .account-link-modal .modal-select:focus {
    border-color: var(--interactive-accent);
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2);
    outline: none;
  }

  .account-link-modal .modal-actions {
    display: flex;
    justify-content: flex-end;
    gap: 8px;
    margin-top: 24px;
    padding-top: 20px;
    border-top: 1px solid var(--background-modifier-border);
  }
`});function KO(){if(document.head.querySelector("#journalit-csv-import-styles"))return;let e=document.createElement("style");e.id="journalit-csv-import-styles",e.textContent=dxe,document.head.appendChild(e)}function u1(){var e;(e=document.head.querySelector("#journalit-csv-import-styles"))==null||e.remove()}function p1(){KO()}var dxe,m1=L(()=>{dxe=`
/* Remove Obsidian's default view-content padding for CSV import view */
.journalit-csv-import-view-container .view-content {
	display: none !important;
	padding: 0 !important;
	margin: 0 !important;
}

/* CSV Import Container */
.journalit-csv-import {
	padding: 0 24px 24px 24px;
	max-width: 1200px;
	margin: 0 auto;
	background: var(--background-primary);
}

.csv-import-header {
	margin-bottom: 32px;
}

.csv-import-header h2 {
	margin: 0 0 8px 0;
	color: var(--text-normal);
	font-size: 24px;
	font-weight: 600;
}

.csv-import-header p {
	margin: 0;
	color: var(--text-muted);
	font-size: 14px;
}

.csv-import-content {
	display: flex;
	flex-direction: column;
	gap: 24px;
}

/* Placeholder */
.csv-placeholder {
	padding: 60px 20px;
	text-align: center;
	border: 2px dashed var(--background-modifier-border);
	border-radius: 8px;
	color: var(--text-muted);
}

/* File Upload Area */
.csv-upload-area {
	border: 2px dashed var(--background-modifier-border);
	border-radius: 8px;
	padding: 48px 24px;
	text-align: center;
	transition: all 0.2s ease;
	cursor: pointer;
	background: var(--background-primary-alt);
}

.csv-upload-area:hover {
	border-color: var(--interactive-accent);
	background: var(--background-modifier-hover);
}

.csv-upload-area.dragover {
	border-color: var(--interactive-accent);
	background: rgba(var(--interactive-accent-rgb), 0.1);
}

.csv-upload-icon {
	font-size: 48px;
	margin-bottom: 16px;
	color: var(--text-muted);
}

.csv-upload-text {
	font-size: 16px;
	color: var(--text-normal);
	margin-bottom: 8px;
}

.csv-upload-hint {
	font-size: 13px;
	color: var(--text-muted);
}

/* Preview Table */
.csv-preview-container {
	margin-top: 24px;
	border: 1px solid var(--background-modifier-border);
	border-radius: 8px;
	overflow: hidden;
}

.csv-preview-header {
	padding: 12px 16px;
	background: var(--background-secondary);
	border-bottom: 1px solid var(--background-modifier-border);
	font-weight: 600;
	color: var(--text-normal);
}

.csv-preview-table-wrapper {
	overflow-x: auto;
	max-height: 400px;
}

.csv-preview-table {
	width: 100%;
	border-collapse: collapse;
	font-size: 13px;
}

.csv-preview-table th,
.csv-preview-table td {
	padding: 10px 12px;
	border: 1px solid var(--background-modifier-border);
	text-align: left;
}

.csv-preview-table th {
	background: var(--background-secondary);
	font-weight: 600;
	position: sticky;
	top: 0;
	z-index: 1;
}

.csv-preview-table td {
	background: var(--background-primary);
}

/* Buttons */
.csv-button {
	padding: 10px 20px;
	border-radius: 6px;
	border: none;
	cursor: pointer;
	font-weight: 500;
	font-size: 14px;
	transition: all 0.2s ease;
}

.csv-button-primary {
	background: var(--interactive-accent);
	color: var(--text-on-accent);
}

.csv-button-primary:hover {
	background: var(--interactive-accent-hover);
}

.csv-button-primary:disabled {
	opacity: 0.5;
	cursor: not-allowed;
}

.csv-button-secondary {
	background: var(--background-modifier-border);
	color: var(--text-normal);
}

.csv-button-secondary:hover {
	background: var(--background-modifier-border-hover);
}

/* Messages */
.csv-message {
	padding: 12px 16px;
	border-radius: 6px;
	margin: 16px 0;
	font-size: 14px;
}

.csv-message--error {
	background: rgba(229, 57, 53, 0.1);
	color: var(--text-error);
	border: 1px solid rgba(229, 57, 53, 0.3);
}

.csv-message--success {
	background: rgba(67, 160, 71, 0.1);
	color: var(--text-success);
	border: 1px solid rgba(67, 160, 71, 0.3);
}

.csv-message--info {
	background: var(--background-secondary);
	color: var(--text-muted);
	border: 1px solid var(--background-modifier-border);
	border-left: 3px solid var(--interactive-accent);
}

/* Loading Spinner */
.csv-loading {
	display: flex;
	align-items: center;
	justify-content: center;
	gap: 12px;
	padding: 24px;
	color: var(--text-muted);
}

.csv-spinner {
	width: 20px;
	height: 20px;
	border: 2px solid var(--background-modifier-border);
	border-top-color: var(--interactive-accent);
	border-radius: 50%;
	animation: csv-spin 0.6s linear infinite;
}

.csv-spinner-small {
	width: 16px;
	height: 16px;
	border: 2px solid var(--background-modifier-border);
	border-top-color: var(--interactive-accent);
	border-radius: 50%;
	animation: csv-spin 0.6s linear infinite;
}

@keyframes csv-spin {
	to { transform: rotate(360deg); }
}

/* Selection Section */
.csv-selection-section {
	display: flex;
	flex-direction: column;
	gap: 20px;
	padding: 20px;
	background: var(--background-secondary);
	border-radius: 8px;
	border: 1px solid var(--background-modifier-border);
}

.csv-selection-section--with-guide {
	flex-direction: row;
	align-items: flex-start;
	gap: 24px;
}

.csv-selection-section__left {
	flex: 1;
	display: flex;
	flex-direction: column;
	gap: 20px;
	min-width: 0;
}

.csv-selection-section__right {
	flex: 1;
	min-width: 0;
}

/* Responsive: Stack vertically on tablets and below */
@media (max-width: 768px) {
	.csv-selection-section--with-guide {
		flex-direction: column;
		align-items: stretch;
	}

	.csv-selection-section__left,
	.csv-selection-section__right {
		flex: 1 1 100%;
		min-width: 100%;
	}
}

/* Smaller screens: Reduce padding and gaps */
@media (max-width: 600px) {
	.csv-selection-section {
		padding: 16px;
		gap: 16px;
	}

	.csv-selection-section--with-guide {
		gap: 16px;
	}

	.csv-account-selector,
	.csv-broker-selector {
		gap: 6px;
	}

	.csv-label {
		font-size: 13px;
	}
}

.csv-account-selector,
.csv-broker-selector {
	display: flex;
	flex-direction: column;
	gap: 8px;
}

.csv-label {
	font-weight: 500;
	color: var(--text-normal);
	font-size: 14px;
}

.csv-required {
	color: var(--text-error);
	margin-left: 4px;
}

.csv-helper-text {
	font-size: 12px;
	color: var(--text-muted);
	margin-top: 8px;
}

/* Upload Section */
.csv-upload-section {
	margin-top: 24px;
}

.csv-upload-section h3 {
	margin: 0 0 16px 0;
	font-size: 16px;
	font-weight: 600;
	color: var(--text-normal);
}

.csv-upload-area.disabled {
	opacity: 0.5;
	cursor: not-allowed;
}

/* Preview Section */
.csv-preview-section {
	margin-top: 24px;
}

.csv-import-actions {
	display: flex;
	gap: 12px;
	align-items: center;
}

/* Results Container */
.csv-results-container {
	margin-top: 24px;
	text-align: center;
}

.csv-results-container h3 {
	font-size: 18px;
	font-weight: 600;
}

.csv-results-container p {
	font-size: 14px;
	line-height: 1.6;
}

.csv-results-container ul {
	text-align: left;
	max-width: 500px;
	margin: 0 auto;
}

/* Column Mapper */
.csv-column-mapper {
	margin-top: 24px;
}

.csv-mapper-header {
	margin-bottom: 20px;
}

.csv-mapper-header h3 {
	margin: 0 0 8px 0;
	font-size: 16px;
	font-weight: 600;
	color: var(--text-normal);
}

.csv-mapper-header p {
	margin: 0;
	font-size: 13px;
	color: var(--text-muted);
}

/* Asset Type Selector */
.asset-type-selector {
	padding: 20px;
	background: var(--background-secondary);
	border: 1px solid var(--background-modifier-border);
	border-radius: 8px;
	margin-top: 24px;
	margin-bottom: 24px;
}

.asset-type-selector h3 {
	margin: 0 0 4px 0;
	font-size: 14px;
	font-weight: 600;
	color: var(--text-normal);
}

.asset-type-buttons {
	display: flex;
	gap: 8px;
	margin-top: 12px;
	flex-wrap: wrap;
}

.asset-type-button {
	padding: 10px 20px;
	border-radius: 6px;
	border: 2px solid var(--background-modifier-border);
	background: var(--background-primary);
	color: var(--text-normal);
	cursor: pointer;
	font-weight: 500;
	font-size: 13px;
	transition: all 0.2s ease;
	flex: 1;
	min-width: 100px;
}

.asset-type-button:hover {
	border-color: var(--interactive-accent);
	background: var(--background-modifier-hover);
}

.asset-type-button.active {
	background: var(--interactive-accent);
	color: var(--text-on-accent);
	border-color: var(--interactive-accent);
}

.csv-mapper-grid-container {
	max-height: 300px;
	overflow-y: auto;
	margin-top: 16px;
	margin-bottom: 16px;
	border: 1px solid var(--background-modifier-border);
	border-radius: 8px;
	padding: 12px;
}

.csv-mapper-grid {
	display: flex;
	flex-direction: column;
	gap: 12px;
}

.csv-mapper-row {
	display: grid;
	grid-template-columns: 1fr auto 1fr;
	align-items: center;
	gap: 16px;
	padding: 12px;
	background: var(--background-secondary);
	border-radius: 6px;
	border: 1px solid var(--background-modifier-border);
}

.csv-mapper-source {
	display: flex;
	flex-direction: column;
	gap: 4px;
}

.csv-column-name {
	font-weight: 500;
	color: var(--text-normal);
	font-size: 13px;
}

.csv-mapper-arrow {
	color: var(--text-muted);
	font-size: 20px;
	text-align: center;
	align-self: center;
}

.csv-column-arrow {
	display: none;  /* Deprecated - using .csv-mapper-arrow instead */
}

.csv-column-header {
	display: flex;
	flex-direction: column;
	gap: 4px;
}

.csv-column-sample {
	font-size: 12px;
	color: var(--text-muted);
	font-style: italic;
}

.csv-sample-value {
	color: var(--text-normal);
	font-family: var(--font-monospace);
	background: var(--background-secondary);
	padding: 2px 6px;
	border-radius: 3px;
	font-style: normal;
}

.csv-mapper-target {
	display: flex;
	align-items: center;
	gap: 8px;
	flex: 1;
}

.csv-required-badge {
	padding: 2px 8px;
	background: rgba(229, 57, 53, 0.1);
	color: var(--text-error);
	border-radius: 4px;
	font-size: 11px;
	font-weight: 600;
	text-transform: uppercase;
}

.csv-mapper-summary {
	font-size: 14px;
	color: var(--text-normal);
}

/* AI Mapping */
.csv-ai-map-section {
	padding: 20px;
	background: var(--background-primary-alt);
	border: 1px solid var(--background-modifier-border);
	border-radius: 8px;
	margin-bottom: 24px;
}

.csv-ai-map-header h4 {
	margin: 0 0 4px 0;
	font-size: 14px;
	font-weight: 600;
	color: var(--text-normal);
}

.csv-ai-map-header p {
	margin: 0 0 16px 0;
	font-size: 13px;
	color: var(--text-muted);
}

.csv-ai-button {
	width: 100%;
	display: flex;
	align-items: center;
	justify-content: center;
	gap: 8px;
}

/* Dialog Styles (used with Obsidian Modal) */
.csv-dialog-body {
	margin-bottom: 24px;
}

.csv-dialog-actions {
	display: flex;
	gap: 12px;
	justify-content: flex-end;
}

/* Dialog Form Elements */
.csv-dialog-form-container {
	margin-bottom: 16px;
}

.csv-dialog-label {
	display: block;
	margin-bottom: 8px;
	font-size: 14px;
	font-weight: 500;
	color: var(--text-normal);
}

.csv-dialog-input {
	width: 100%;
	padding: 8px 12px;
	border: 1px solid var(--background-modifier-border);
	border-radius: 4px;
	background-color: var(--background-primary);
	color: var(--text-normal);
	font-size: 14px;
	box-sizing: border-box;
}

.csv-dialog-input-error {
	border-color: var(--text-error);
}

.csv-dialog-error-message {
	margin-top: 8px;
	font-size: 12px;
	color: var(--text-error);
}

.csv-dialog-helper-text {
	margin-top: 8px;
	font-size: 12px;
	color: var(--text-muted);
}

/* Import Results (Inline Display) */
.result-item {
	display: flex;
	align-items: center;
	gap: 12px;
	padding: 12px 16px;
	border-radius: 6px;
	font-size: 14px;
	line-height: 1.5;
}

.result-success {
	background: rgba(67, 160, 71, 0.1);
	border: 1px solid rgba(67, 160, 71, 0.3);
	color: var(--text-normal);
}

.result-warning {
	background: rgba(255, 152, 0, 0.1);
	border: 1px solid rgba(255, 152, 0, 0.3);
	color: var(--text-normal);
}

.result-info {
	background: rgba(33, 150, 243, 0.1);
	border: 1px solid rgba(33, 150, 243, 0.3);
	color: var(--text-normal);
}

.result-icon {
	flex-shrink: 0;
	color: currentColor;
	opacity: 0.9;
}

.result-text {
	flex: 1;
}

.result-text strong {
	font-weight: 600;
	color: var(--text-accent);
}

/* Imported Trades Preview */
.imported-trades-preview {
	margin-top: 20px;
	border: 1px solid var(--background-modifier-border);
	border-radius: 6px;
	overflow: hidden;
}

.preview-header {
	background: var(--background-secondary);
	padding: 12px 16px;
	font-size: 13px;
	font-weight: 600;
	color: var(--text-normal);
	border-bottom: 1px solid var(--background-modifier-border);
}

.csv-trades-list {
	/* No max-height or overflow - show all trades without scrolling */
	overflow-x: auto;
}

.csv-trade-preview-item {
	display: grid;
	grid-template-columns: auto 1fr minmax(80px, 90px) minmax(80px, 90px) minmax(120px, 140px) minmax(90px, 100px);
	gap: 12px;
	padding: 12px 16px;
	border-bottom: 1px solid var(--background-modifier-border);
	font-size: 13px;
	align-items: center;
	transition: background 0.15s ease;
	cursor: pointer;
}

.csv-trade-preview-item:last-child {
	border-bottom: none;
}

.csv-trade-preview-item:hover {
	background: var(--background-modifier-hover);
}

.csv-trade-symbol {
	font-weight: 600;
	color: var(--text-normal);
	grid-column: 1;
}

.csv-trade-date {
	color: var(--text-muted);
	font-size: 12px;
	grid-column: 3;
}

.csv-trade-direction {
	display: flex;
	align-items: center;
	gap: 4px;
	font-weight: 500;
	font-size: 12px;
	text-transform: uppercase;
	grid-column: 4;
}

.csv-trade-direction.long {
	color: var(--color-green);
}

.csv-trade-direction.short {
	color: var(--color-red);
}

.csv-trade-quantity {
	color: var(--text-normal);
	font-size: 12px;
	grid-column: 5;
}

.csv-trade-status {
	font-weight: 500;
	font-size: 12px;
	grid-column: 6;
}

.csv-trade-status.closed {
	color: var(--text-muted);
}

.csv-trade-status.open {
	color: var(--text-warning, #ff9800);
}

.trade-preview-more {
	padding: 12px 16px;
	text-align: center;
	font-size: 12px;
	font-style: italic;
	color: var(--text-muted);
	opacity: 0.7;
}

.import-results-errors {
	background: rgba(229, 57, 53, 0.05);
	border: 1px solid rgba(229, 57, 53, 0.2);
	border-radius: 6px;
	padding: 16px;
}

.errors-header {
	display: flex;
	align-items: center;
	gap: 8px;
	margin-bottom: 12px;
}

.error-icon {
	font-size: 20px;
	color: var(--text-error);
}

.error-title {
	font-weight: 600;
	color: var(--text-error);
	font-size: 14px;
}

.error-list {
	list-style: none;
	margin: 0;
	padding: 0;
	display: flex;
	flex-direction: column;
	gap: 8px;
	max-height: 300px;
	overflow-y: auto;
}

.error-item {
	display: flex;
	flex-direction: column;
	gap: 4px;
	padding: 8px 12px;
	background: var(--background-primary);
	border-radius: 4px;
	font-size: 13px;
}

.error-row {
	font-weight: 600;
	color: var(--text-error);
	font-family: var(--font-monospace);
}

.error-message {
	color: var(--text-muted);
	line-height: 1.4;
}

/* Actions (Import Another File Button) */
.csv-actions {
	margin-top: 24px;
}

.csv-export-code-preview {
	padding: 12px;
	background: var(--background-primary-alt);
	border: 1px solid var(--background-modifier-border);
	border-radius: 4px;
	font-family: var(--font-monospace);
	font-size: 13px;
	word-break: break-all;
	color: var(--text-muted);
	margin-top: 8px;
}

/* Broker Guide Styles */
.broker-guide-content {
	font-size: 13px;
	color: var(--text-muted);
	line-height: 1.6;
}

.broker-guide-steps {
	margin: 0 0 16px 0;
	padding-left: 20px;
}

.broker-guide-steps li {
	margin-bottom: 8px;
	color: var(--text-normal);
}

.broker-guide-steps li strong {
	color: var(--text-normal);
	font-weight: 600;
}

.broker-guide-warning {
	display: flex;
	gap: 12px;
	align-items: flex-start;
	padding: 12px 16px;
	background: rgba(255, 152, 0, 0.1);
	border: 1px solid rgba(255, 152, 0, 0.3);
	border-radius: 6px;
	margin-bottom: 12px;
	font-size: 13px;
	color: var(--text-normal);
}

.broker-guide-warning-icon {
	flex-shrink: 0;
	color: var(--text-warning, #ff9800);
	margin-top: 2px;
}

.broker-guide-info {
	padding: 12px 16px;
	border-left: 3px solid var(--interactive-accent);
	background: var(--background-secondary);
	border-radius: 4px;
	font-size: 13px;
	color: var(--text-muted);
	margin-bottom: 12px;
}

.broker-guide-description {
	font-size: 13px;
	color: var(--text-muted);
	margin-bottom: 12px;
	font-style: italic;
}

.broker-guide-link {
	display: inline-flex;
	align-items: center;
	gap: 6px;
	color: var(--interactive-accent);
	text-decoration: none;
	font-size: 13px;
	padding: 4px 8px;
	border-radius: 4px;
	transition: background-color 0.2s ease;
}

.broker-guide-link:hover {
	background: var(--interactive-accent-hover);
	color: var(--text-on-accent);
}

.broker-guide-link svg {
	flex-shrink: 0;
}

/* Centered title variant for CollapsibleSection */
.journalit-collapsible-section.centered-title .journalit-collapsible-header {
	justify-content: center;
	position: relative;
	padding-left: 40px;
	padding-right: 40px;
}

.journalit-collapsible-section.centered-title .journalit-collapsible-header-left {
	justify-content: center;
	width: 100%;
}

.journalit-collapsible-section.centered-title .journalit-collapsible-chevron {
	position: absolute;
	right: 12px;
}

/* Prominent broker guide section styling */
.journalit-collapsible-section.broker-guide-prominent {
	border: 2px solid var(--interactive-accent);
	background: var(--background-secondary);
	border-radius: 8px;
	overflow: hidden;
	box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
}

.journalit-collapsible-section.broker-guide-prominent .journalit-collapsible-header {
	background: var(--background-secondary);
	position: relative;
}

.journalit-collapsible-section.broker-guide-prominent .journalit-collapsible-header::before {
	content: '';
	position: absolute;
	left: 0;
	top: 0;
	bottom: 0;
	width: 4px;
	background: var(--interactive-accent);
}

.journalit-collapsible-section.broker-guide-prominent .journalit-collapsible-content {
	background: var(--background-primary);
	border-top: 1px solid var(--background-modifier-border);
}

/* Responsive Design - Tablet */
@media (max-width: 768px) {
	.csv-trade-preview-item {
		grid-template-columns: auto 1fr minmax(70px, 80px) minmax(70px, 80px) minmax(100px, 120px) minmax(80px, 90px);
		gap: 8px;
		padding: 10px 12px;
		font-size: 12px;
	}
}

/* Responsive Design - Mobile */
@media (max-width: 600px) {
	.csv-trade-preview-item {
		grid-template-columns: auto 1fr minmax(60px, 70px) minmax(90px, 100px);
		gap: 6px;
		padding: 8px;
		font-size: 11px;
	}

	/* Hide date and direction columns on mobile, keep symbol, quantity, and status */
	.csv-trade-date {
		display: none;
	}

	.csv-trade-direction {
		display: none;
	}

	.csv-trade-quantity {
		grid-column: 3;
	}

	.csv-trade-status {
		grid-column: 4;
	}
}
`});function pxe(){if(document.head.querySelector("#react-view-styles"))return;let e=document.createElement("style");e.id="react-view-styles",e.textContent=uxe,document.head.appendChild(e)}function OG(){pxe()}var uxe,jG=L(()=>{uxe=`
  /* Ensure container has proper flex layout */
  .react-view-container {
    height: 100% !important;
    overflow-y: auto !important;
    display: flex !important;
    flex-direction: column !important;
  }

  /* Hide Obsidian's default view-content div (direct child selector) */
  .react-view-container > .view-content {
    display: none !important;
  }

  /* Style the React root element (our injected div) */
  .react-view-container > div[id^="react-root-"] {
    height: 100%;
    display: flex;
    flex-direction: column;
    overflow: visible;
    flex: 1 1 auto;
    min-height: min-content;
  }
`});var zG,_G,u0,us,Xf=L(()=>{zG=require("obsidian"),_G=q(wn()),u0=q(Y());rr();jG();us=class extends zG.ItemView{constructor(r,n={}){super(r);this.root=null;this.rootEl=null;this._pendingAnimationFrame=null;this._intervals=[];this.config={containerClass:"react-view-container",rootId:`react-root-${Date.now()}`,...n},this._themeChangeHandler=()=>this.renderComponent(),this._currencyChangeHandler=()=>this.renderComponent()}registerInterval(r){return this._intervals.push(r),r}clearInterval(r){window.clearInterval(r),this._intervals=this._intervals.filter(n=>n!==r)}async onOpen(){try{OG(),this.config.containerClass&&this.config.containerClass.trim()!==""&&this.containerEl.addClass(this.config.containerClass),this.rootEl=this.containerEl.createDiv(),this.config.rootId&&(this.rootEl.id=this.config.rootId),this.root=(0,_G.createRoot)(this.rootEl),this.renderComponent(),document.addEventListener("theme-change",this._themeChangeHandler),window.addEventListener("journalit-currency-changed",this._currencyChangeHandler),this.app.workspace.onLayoutReady(()=>{this._pendingAnimationFrame=window.requestAnimationFrame(()=>{this.renderComponent(),this._pendingAnimationFrame=null})})}catch(r){throw console.error("Failed to initialize React view:",r),r}}renderComponent(){if(!this.root){console.warn("Cannot render component: React root not initialized");return}if(!(!document.body.contains(this.containerEl)||!document.body.contains(this.rootEl)))try{if(!window.journalitPlugin)throw new Error("Cannot render component: Plugin not initialized. This indicates a view registration race condition.");let r=this.getRenderFunction();this.root.render(u0.default.createElement(u0.StrictMode,null,u0.default.createElement(cs,null,r())))}catch(r){console.error(`[Journalit] Failed to render React component in ${this.getViewType()}:`,r)}}async onClose(){if(this._pendingAnimationFrame&&(window.cancelAnimationFrame(this._pendingAnimationFrame),this._pendingAnimationFrame=null),this._intervals&&(this._intervals.forEach(r=>window.clearInterval(r)),this._intervals=[]),this.root)try{this.root.unmount(),this.root=null}catch(r){console.error("Failed to unmount React component:",r)}return document.removeEventListener("theme-change",this._themeChangeHandler),window.removeEventListener("journalit-currency-changed",this._currencyChangeHandler),Promise.resolve()}}});var Rr,p0,JO=L(()=>{Rr=q(Y());PC();wt();p0=({dateRange:e,onChange:t})=>{let[r,n]=(0,Rr.useState)(!1),o=(0,Rr.useRef)(null),[a,i]=(0,Rr.useState)(!1),[s,l]=(0,Rr.useState)(!1),c=(0,Rr.useCallback)((h,y)=>{if(!h&&!y)return"allTime";let b=null,x=null;h&&(b=Kn(h)),y&&(x=Kn(y,!1));let w=new Date,S=Kn(w);if(b&&x&&b.getFullYear()===S.getFullYear()&&b.getMonth()===S.getMonth()&&b.getDate()===S.getDate()&&x.getFullYear()===S.getFullYear()&&x.getMonth()===S.getMonth()&&x.getDate()===S.getDate())return"today";let k=new Date(w);k.setDate(k.getDate()-1);let T=Kn(k),P=bo(w),D=Kn(P);if(b&&x&&b.getFullYear()===T.getFullYear()&&b.getMonth()===T.getMonth()&&b.getDate()===T.getDate()&&x.getFullYear()===T.getFullYear()&&x.getMonth()===T.getMonth()&&x.getDate()===T.getDate())return"yesterday";if(b&&b.getFullYear()===D.getFullYear()&&b.getMonth()===D.getMonth()&&b.getDate()===D.getDate())return"thisWeek";let O=new Date(w.getFullYear(),w.getMonth(),1),z=Kn(O);if(b&&b.getFullYear()===z.getFullYear()&&b.getMonth()===z.getMonth()&&b.getDate()===z.getDate())return"thisMonth";let A=(av(w)-1)*3,j=new Date(w.getFullYear(),A,1),E=Kn(j);if(b&&b.getFullYear()===E.getFullYear()&&b.getMonth()===E.getMonth()&&b.getDate()===E.getDate())return"thisQuarter";let N=new Date(w.getFullYear(),0,1),B=Kn(N);return b&&b.getFullYear()===B.getFullYear()&&b.getMonth()===B.getMonth()&&b.getDate()===B.getDate()?"thisYear":h||y?"custom":null},[]),d=(0,Rr.useMemo)(()=>c(e[0],e[1]),[e,c]);(0,Rr.useEffect)(()=>{let h=y=>{o.current&&!o.current.contains(y.target)&&r&&n(!1)};return r&&document.addEventListener("mousedown",h),()=>{document.removeEventListener("mousedown",h)}},[r]),(0,Rr.useEffect)(()=>{if(r&&o.current){let h=o.current.getBoundingClientRect(),y=360,b=160,x=window.innerWidth,w=window.innerHeight,S=20,k=h.right+y>x-S,T=h.left-y<S;if(k&&T){let P=h.bottom+b<=w-S;l(P),i(!1)}else k&&!T?(l(!1),i(!0)):(l(!1),i(!1))}},[r]);let u=(0,Rr.useCallback)(h=>{if(h&&h instanceof Date){let y=Kn(h,!0);t([y,e[1]])}else t([null,e[1]])},[e,t]),p=(0,Rr.useCallback)(h=>{if(h&&h instanceof Date){let y=Kn(h,!1);t([e[0],y])}else t([e[0],null])},[e,t]),m=(0,Rr.useCallback)(()=>{d==="custom"?n(!r):(n(!0),!e[0]&&!e[1]&&t([null,null]))},[d,r,e,t]),f=(0,Rr.useCallback)(h=>{let y=new Date,b=null,x=null;if(h==="custom")if(d==="custom"){n(!r);return}else{n(!0);return}else n(!1);switch(h){case"today":b=Kn(y,!0),x=Kn(y,!1);break;case"yesterday":let w=new Date(y);w.setDate(y.getDate()-1),b=Kn(w,!0),x=Kn(w,!1);break;case"thisWeek":let S=bo(y);b=Kn(S,!0),x=Kn(y,!1);break;case"thisMonth":let k=new Date(y.getFullYear(),y.getMonth(),1);b=Kn(k,!0),x=Kn(y,!1);break;case"thisQuarter":let P=(av(y)-1)*3,D=new Date(y.getFullYear(),P,1);b=Kn(D,!0),x=Kn(y,!1);break;case"thisYear":let O=new Date(y.getFullYear(),0,1);b=Kn(O,!0),x=Kn(y,!1);break;case"allTime":default:b=null,x=null;break}t([b,x])},[d,r,t]),g=(0,Rr.useMemo)(()=>[{id:"today",label:"Today"},{id:"yesterday",label:"Yesterday"},{id:"thisWeek",label:"This Week"},{id:"thisMonth",label:"This Month"},{id:"thisQuarter",label:"This Quarter"},{id:"thisYear",label:"This Year"},{id:"allTime",label:"All Time"},{id:"custom",label:"Custom"}],[]),v=(0,Rr.useCallback)(h=>()=>f(h),[f]);return Rr.default.createElement("div",{className:"journalit-dashboard-date-range-filter",ref:o},Rr.default.createElement("div",{className:"journalit-dashboard-date-range-presets"},g.map(h=>Rr.default.createElement("button",{key:h.id,onClick:v(h.id),className:d===h.id?"active":""},h.label))),r&&Rr.default.createElement("div",{className:`journalit-dashboard-date-range-inputs journalit-dashboard-custom-date-dropdown date-dropdown-visible ${a?"position-left":""} ${s?"position-below":""}`},Rr.default.createElement("div",{className:"journalit-dashboard-date-range-start"},Rr.default.createElement("label",null,"From"),Rr.default.createElement(ji,{value:e[0]||void 0,onChange:u,className:"journalit-date-picker-input"})),Rr.default.createElement("div",{className:"journalit-dashboard-date-range-end"},Rr.default.createElement("label",null,"To"),Rr.default.createElement(ji,{value:e[1]||void 0,onChange:p,className:"journalit-date-picker-input",minDate:e[0]||void 0}))))}});var di=L(()=>{});var wo,Zf=L(()=>{Ra();di();$f();nm();wo={general:{currency:"USD",displayName:"",homeStartupBehavior:"always",onboardingCompleted:!1,journalFolderPath:""},trade:{autoOpenCreatedTrades:!0,dateFormat:"DDMMYY",skipWeekends:!0,useDirectPnLInput:!1,tradingDayCutoffTime:"00:00",breakEvenRangeMin:0,breakEvenRangeMax:0,includeMissedTradesInCalculations:!1,defaultRiskAmount:0,displayRMultiples:!1,showCopyTradingPnL:!1,lossReview:{enabled:!0,sections:[{id:"pause-header",title:"**LOSS REVIEW**",type:"header",content:""},{id:"pause-section",title:"**Pause**\u270B",type:"header",content:`Take a moment to step back.
Do **NOT** start looking at entering a position until you have completed this loss review.`},{id:"pause-checkbox",title:"",type:"checkbox",content:'Say out loud to yourself, **"losses are part of the process, there are endless opportunities in the market."**'},{id:"review-plan",title:"**Review Your Plan**",type:"header",content:"***Did you stick to your trading plan without mistakes?***"},{id:"review-plan-checklist",title:"",type:"checkboxList",items:["\u2192 If **yes**; there is nothing to be mad about, not every trade is going to work out regardless of how good the thesis is","\u2192 If **no**; figure out what went wrong, learn from it and don't do it again"]},{id:"feelings",title:"**Write Down Your Feelings**",type:"header",content:"***Be honest about how you feel and note down your emotions:***"},{id:"feelings-text",title:"",type:"textarea",placeholder:"How are you feeling about this loss?"},{id:"learn-header",title:"**Learn From This Loss**",type:"header",content:"***If the loss was reasonable, write down the best things you did during the trade and ways of repeating those:***"},{id:"learn-reasonable",title:"",type:"textarea",placeholder:"What went well that you can repeat?"},{id:"learn-unreasonable-header",title:"",type:"header",content:"***If the loss was unreasonable, note where you went wrong and how you'll improve next time:***"},{id:"learn-unreasonable",title:"",type:"textarea",placeholder:"What went wrong and how will you improve?"},{id:"next-steps",title:"**Decide The Next Steps**",type:"header",content:`***Outline what you'll do based on the previous questions and follow the plan.***
***You might choose to step back from the charts if it's your third loss in a row.***
***Or you might want to continue trading if it's the first one.***
***What will you pay attention to? How will you behave?***`},{id:"next-steps-text",title:"",type:"textarea",placeholder:"What are your next steps?"},{id:"final-check",title:"**Final Check**",type:"header",content:""},{id:"final-check-list",title:"",type:"checkboxList",items:["If you feel **tilted**, take a break from the screen and play guitar, play with Leo, or get something to eat","If you feel **fine**, do not enter a trade until at least the next candle"]},{id:"overall-thoughts",title:"**Overall Trade Thoughts:**",type:"header",content:""},{id:"overall-thoughts-text",title:"",type:"textarea",placeholder:"Any additional thoughts about this trade?"}]}},tradeLog:{columnVisibility:{select:!1,image:!0,account:!0,ticker:!0,status:!0,pnl:!0,direction:!0,setups:!0,mistakes:!0,tags:!0,date:!0,reviewed:!0,duration:!1,positionSize:!1,expirationDate:!1,daysToExpiry:!1,thesis:!1},columnOrder:["select","image","account","ticker","status","pnl","direction","setups","mistakes","tags","date","reviewed","duration","positionSize","expirationDate","daysToExpiry","thesis"],columnWidths:{}},reviews:{globalAutoCreate:!0},uiCustomization:{},customOptions:wc,customTradeFields:Bf,customFieldOptions:{},weekly:{reviewQuestions:["What worked well this week?","What didn't work this week?","Which setups were most profitable?","What mistakes cost me the most money?","What could I improve for next week?"],customTimeframes:["Monthly","Weekly","Daily"],autoCreateOnFirstTrade:!0,autoCreateWeeklyReviewOnNavigation:!0},monthly:{reviewQuestions:["What were the key lessons from this month?","Which strategies performed best?","What patterns do I notice in my trading?","What are my goals for next month?","How can I improve my risk management?"],customTimeframes:["Quarterly","Monthly","Weekly"],autoCreateOnFirstTrade:!0,autoCreateMonthlyReviewOnNavigation:!0},drc:{checklistItems:["Review market conditions","Check economic calendar","Set risk limits for the day","Review previous day's trades"],reviewQuestions:["What did I do well today?","What could I improve on?","What will I focus on for the next session?"],customTimeframes:["Daily","4H","1H","30M"],autoCreateOnFirstTrade:!0,autoCreateDRCOnNavigation:!0},dashboard:{layouts:{Default:{topSection:["netPnL","winRate","profitFactor","expectancy"],bottomSection:{lg:[{i:"pnlChart",x:0,y:0,w:6,h:8},{i:"performanceCalendar",x:6,y:0,w:6,h:4},{i:"dailyPerformance",x:6,y:4,w:6,h:4}],md:[{i:"pnlChart",x:0,y:0,w:6,h:6},{i:"performanceCalendar",x:0,y:6,w:6,h:3},{i:"dailyPerformance",x:0,y:9,w:6,h:3}],sm:[{i:"pnlChart",x:0,y:0,w:4,h:6},{i:"performanceCalendar",x:0,y:6,w:4,h:3},{i:"dailyPerformance",x:0,y:9,w:4,h:3}]}}},activeLayout:"Default",defaultFilters:{dateRange:[null,null],accounts:[],tickers:[],setups:[],tradeTypes:[],statuses:[]},lastUsedFilters:{dateRange:[null,null],accounts:[],tickers:[],setups:[],tradeTypes:[],statuses:[]}},home:{layouts:{Default:{lg:[{i:"welcome",x:0,y:0,w:6,h:3},{i:"quickLinks",x:6,y:0,w:6,h:3},{i:"recentItems",x:0,y:3,w:6,h:4},{i:"yearHeatmap",x:6,y:3,w:6,h:4}],md:[{i:"welcome",x:0,y:0,w:6,h:3},{i:"quickLinks",x:0,y:3,w:6,h:3},{i:"recentItems",x:0,y:6,w:6,h:4},{i:"yearHeatmap",x:0,y:10,w:6,h:4}],sm:[{i:"welcome",x:0,y:0,w:4,h:3},{i:"quickLinks",x:0,y:3,w:4,h:3},{i:"recentItems",x:0,y:6,w:4,h:4},{i:"yearHeatmap",x:0,y:10,w:4,h:4}],xs:[{i:"welcome",x:0,y:0,w:2,h:3},{i:"quickLinks",x:0,y:3,w:2,h:3},{i:"recentItems",x:0,y:6,w:2,h:4},{i:"yearHeatmap",x:0,y:10,w:2,h:4}],xxs:[{i:"welcome",x:0,y:0,w:1,h:3},{i:"quickLinks",x:0,y:3,w:1,h:3},{i:"recentItems",x:0,y:6,w:1,h:4},{i:"yearHeatmap",x:0,y:10,w:1,h:4}]}},activeLayout:"Default",recentItems:[],quickLinks:[{id:"add-trade",label:"Add Trade",icon:"plus-circle",color:"var(--interactive-accent)",action:"addTrade",visible:!0,order:0},{id:"trade-log",label:"Trade Log",icon:"folder-tree",color:"var(--text-accent)",action:"openTradeLog",visible:!0,order:1},{id:"trading-dashboard",label:"Trading Dashboard",icon:"grip",color:"var(--text-accent)",action:"openTradingDashboard",visible:!0,order:2},{id:"account-dashboard",label:"Account Dashboard",icon:"users",color:"var(--text-accent)",action:"openAccountDashboard",visible:!0,order:3},{id:"todays-drc",label:"Today's DRC",icon:"calendar",color:"var(--text-accent)",action:"openTodaysDRC",visible:!0,order:4},{id:"weekly-review",label:"This Week Review",icon:"calendar-check",color:"var(--text-accent)",action:"openWeeklyReview",visible:!0,order:5},{id:"monthly-review",label:"This Month Review",icon:"calendar-range",color:"var(--text-accent)",action:"openMonthlyReview",visible:!0,order:6},{id:"csv-import",label:"CSV Import",icon:"import",color:"var(--text-accent)",action:"openCSVImport",visible:!0,order:7}]},account:{defaultAccountType:"demo",defaultDrawdownType:"none",defaultDrawdownAmount:0,showBalanceInDashboard:!0,excludedAccountTypes:["archived"],includeWithdrawalsFromExcluded:{archived:!0,demo:!1},accountTypeOrder:["funded","evaluation","demo","archived"],accountMetadata:{}},backendIntegration:{serverUrl:"https://api.journalit.co",syncEnabled:!0,userId:"",showSyncNotifications:!0,showNewTradeNotifications:!0,showUpdateNotifications:!0,lastSeenVersion:""},csvTemplates:[],initializedOptionTypes:[],symbolMappings:[]}});var mxe,fxe,gxe,XO,QO=L(()=>{Zf();mxe={defaultFilters:{dateRange:[null,null],accounts:[],tickers:[],setups:[],tradeTypes:[],statuses:[]},lastUsedFilters:{dateRange:[null,null],accounts:[],tickers:[],setups:[],tradeTypes:[],statuses:[]}},fxe=e=>{var r,n,o,a,i,s,l,c,d,u,p,m;if(!e.settings.dashboard)return mxe;let t=e.settings.dashboard;return{defaultFilters:{dateRange:(r=t.defaultFilters)!=null&&r.dateRange?[t.defaultFilters.dateRange[0]?new Date(t.defaultFilters.dateRange[0]):null,t.defaultFilters.dateRange[1]?new Date(t.defaultFilters.dateRange[1]):null]:[null,null],accounts:((n=t.defaultFilters)==null?void 0:n.accounts)||[],tickers:((o=t.defaultFilters)==null?void 0:o.tickers)||[],setups:((a=t.defaultFilters)==null?void 0:a.setups)||[],tradeTypes:((i=t.defaultFilters)==null?void 0:i.tradeTypes)||[],statuses:((s=t.defaultFilters)==null?void 0:s.statuses)||[]},lastUsedFilters:{dateRange:(l=t.lastUsedFilters)!=null&&l.dateRange?[t.lastUsedFilters.dateRange[0]?new Date(t.lastUsedFilters.dateRange[0]):null,t.lastUsedFilters.dateRange[1]?new Date(t.lastUsedFilters.dateRange[1]):null]:[null,null],accounts:((c=t.lastUsedFilters)==null?void 0:c.accounts)||[],tickers:((d=t.lastUsedFilters)==null?void 0:d.tickers)||[],setups:((u=t.lastUsedFilters)==null?void 0:u.setups)||[],tradeTypes:((p=t.lastUsedFilters)==null?void 0:p.tradeTypes)||[],statuses:((m=t.lastUsedFilters)==null?void 0:m.statuses)||[]}}},gxe=async(e,t)=>{e.settings.dashboard||(e.settings.dashboard=wo.dashboard),e.settings.dashboard.defaultFilters=t.defaultFilters,e.settings.dashboard.lastUsedFilters=t.lastUsedFilters,await e.saveSettings()},XO=async(e,t)=>{let r=fxe(e);r.lastUsedFilters=t,await gxe(e,r)}});function vxe(){let e="journalit-filter-button-styles";if(f1++,f1>1)return;let t=document.createElement("style");t.id=e,t.textContent=hxe,document.head.appendChild(t)}function ZO(){var t;let e="journalit-filter-button-styles";f1--,!(f1>0)&&((t=document.head.querySelector(`#${e}`))==null||t.remove())}var zu,Mv,hxe,f1,m0=L(()=>{zu=q(Y());er();Mv=(0,zu.memo)(({onClick:e,activeFilterCount:t,className:r=""})=>((0,zu.useLayoutEffect)(()=>(vxe(),()=>ZO()),[]),zu.default.createElement("div",{className:"journalit-filter-button-container"},zu.default.createElement("button",{className:`journalit-filter-button ${r}`,onClick:e,"aria-label":"Open filters",title:"Open filters",type:"button"},zu.default.createElement(Jp,{size:16})),t>0&&zu.default.createElement("span",{className:"journalit-filter-badge","aria-label":`${t} active filters`},t))));Mv.displayName="FilterButton";hxe=`
  /* Filter button container with relative positioning for badge */
  .journalit-filter-button-container {
    position: relative;
    display: inline-flex;
  }

  /* Filter button styles */
  .journalit-filter-button-container .journalit-filter-button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 6px;
    background-color: transparent;
    color: var(--text-normal);
    border: 1px solid transparent;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .journalit-filter-button-container .journalit-filter-button:hover {
    background-color: var(--background-modifier-hover);
  }

  /* Filter badge - small circular indicator */
  .journalit-filter-badge {
    position: absolute;
    top: -4px;
    right: -4px;
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 16px;
    height: 16px;
    padding: 0 4px;
    font-size: 10px;
    font-weight: 600;
    color: white;
    background-color: var(--interactive-accent);
    border-radius: 8px;
    pointer-events: none;
    z-index: 1;
  }
`,f1=0});var br,fm,f0=L(()=>{br=q(Y());Ra();pt();fm=({accounts:e,selectedAccounts:t,onChange:r,useOnlyProvidedAccounts:n=!1})=>{let o=xe(),[a,i]=(0,br.useState)([]),[s,l]=(0,br.useState)(!1),c=(0,br.useRef)(null);(0,br.useEffect)(()=>{if(o&&o.optionsService){let v=o.optionsService.getOptions("account");i(v);let h=()=>{let y=o.optionsService.getOptions("account");i(y)};return document.addEventListener("journalit-options-changed",h),()=>{document.removeEventListener("journalit-options-changed",h)}}},[o]);let d=(0,br.useMemo)(()=>n?[...new Set(e)]:[...new Set([...a,...e])],[e,a,n]),u=(0,br.useMemo)(()=>d.length>0?[{value:"select-all",label:"-- Select All --"},...d.map(h=>({value:h,label:h}))]:[],[d]);(0,br.useEffect)(()=>{let v=h=>{c.current&&!c.current.contains(h.target)&&l(!1)};return document.addEventListener("mousedown",v),()=>{document.removeEventListener("mousedown",v)}},[]);let p=(0,br.useCallback)(v=>{v==="select-all"?t.length===d.length?r([]):r([...d]):t.includes(v)?r(t.filter(h=>h!==v)):r([...t,v])},[t,d,r]),m=(0,br.useMemo)(()=>t.length===0||t.length===d.length?"All Accounts":t.length===1?t[0]:`${t.length} Accounts`,[t,d]),f=(0,br.useMemo)(()=>d.length>0,[d]),g=(0,br.useCallback)(()=>l(!s),[s]);return br.default.createElement("div",{className:"journalit-dashboard-account-filter journalit-responsive-account-filter",ref:c},br.default.createElement("div",{className:"journalit-dashboard-account-dropdown"},br.default.createElement("div",{className:"journalit-dashboard-account-summary",onClick:g,role:"button",tabIndex:0,onKeyDown:v=>{(v.key==="Enter"||v.key===" ")&&(v.preventDefault(),g())}},br.default.createElement("span",{className:"journalit-dashboard-summary-text"},m),br.default.createElement("span",{className:"dropdown-arrow"},s?"\u25B2":"\u25BC")),s&&br.default.createElement("div",{className:"journalit-dashboard-account-options-dropdown"},f?br.default.createElement(br.default.Fragment,null,br.default.createElement("div",{className:"journalit-dashboard-account-option-item select-all",onClick:()=>p("select-all"),role:"checkbox","aria-checked":t.length===d.length,tabIndex:0,onKeyDown:v=>{(v.key==="Enter"||v.key===" ")&&(v.preventDefault(),p("select-all"))}},br.default.createElement("span",{className:`journalit-dashboard-account-checkbox${t.length===d.length?" checked":""}`,"aria-hidden":"true"},t.length===d.length?"\u2713":""),br.default.createElement("span",{title:"Select All"},"Select All")),br.default.createElement("div",{className:"journalit-dashboard-account-divider"}),d.map(v=>br.default.createElement("div",{key:v,className:"journalit-dashboard-account-option-item",onClick:()=>p(v),role:"checkbox","aria-checked":t.includes(v),tabIndex:0,onKeyDown:h=>{(h.key==="Enter"||h.key===" ")&&(h.preventDefault(),p(v))}},br.default.createElement("span",{className:`journalit-dashboard-account-checkbox${t.includes(v)?" checked":""}`,"aria-hidden":"true"},t.includes(v)?"\u2713":""),br.default.createElement("span",{title:v},v)))):br.default.createElement("div",{className:"journalit-dashboard-no-accounts"},"No accounts found"))))}});var pr,BG,$G=L(()=>{pr=q(Y());Ra();pt();BG=({tickers:e,selectedTickers:t,onChange:r})=>{let n=xe(),[o,a]=(0,pr.useState)([]),[i,s]=(0,pr.useState)(!1),l=(0,pr.useRef)(null);(0,pr.useEffect)(()=>{if(n&&n.optionsService){let v=n.optionsService.getOptions("instrument");a(v);let h=()=>{let y=n.optionsService.getOptions("instrument");a(y)};return document.addEventListener("journalit-options-changed",h),()=>{document.removeEventListener("journalit-options-changed",h)}}},[n]);let c=(0,pr.useMemo)(()=>[...new Set([...o,...e])],[e,o]),d=(0,pr.useMemo)(()=>c.length>0,[c]);(0,pr.useEffect)(()=>{let v=h=>{l.current&&!l.current.contains(h.target)&&s(!1)};return document.addEventListener("mousedown",v),()=>{document.removeEventListener("mousedown",v)}},[]);let u=(0,pr.useCallback)(v=>{v==="select-all"?t.length===c.length?r([]):r([...c]):t.includes(v)?r(t.filter(h=>h!==v)):r([...t,v])},[t,c,r]),p=(0,pr.useMemo)(()=>t.length===0||t.length===c.length?"All Tickers":t.length===1?t[0]:`${t.length} Tickers`,[t,c]),m=(0,pr.useCallback)(()=>s(!i),[i]),f=(0,pr.useCallback)(()=>u("select-all"),[u]),g=(0,pr.useCallback)(v=>()=>u(v),[u]);return pr.default.createElement("div",{className:"journalit-dashboard-ticker-filter journalit-responsive-ticker-filter",ref:l},pr.default.createElement("div",{className:"journalit-dashboard-ticker-dropdown"},pr.default.createElement("div",{className:"journalit-dashboard-ticker-summary",onClick:m,role:"button",tabIndex:0,onKeyDown:v=>{(v.key==="Enter"||v.key===" ")&&(v.preventDefault(),m())}},pr.default.createElement("span",{className:"journalit-dashboard-summary-text"},p),pr.default.createElement("span",{className:"dropdown-arrow"},i?"\u25B2":"\u25BC")),i&&pr.default.createElement("div",{className:"journalit-dashboard-ticker-options-dropdown"},d?pr.default.createElement(pr.default.Fragment,null,pr.default.createElement("div",{className:"journalit-dashboard-ticker-option-item select-all",onClick:f,role:"checkbox","aria-checked":t.length===c.length,tabIndex:0,onKeyDown:v=>{(v.key==="Enter"||v.key===" ")&&(v.preventDefault(),f())}},pr.default.createElement("span",{className:`journalit-dashboard-ticker-checkbox${t.length===c.length?" checked":""}`,"aria-hidden":"true"},t.length===c.length?"\u2713":""),pr.default.createElement("span",{title:"Select All"},"Select All")),pr.default.createElement("div",{className:"journalit-dashboard-ticker-divider"}),c.map(v=>pr.default.createElement("div",{key:v,className:"journalit-dashboard-ticker-option-item",onClick:g(v),role:"checkbox","aria-checked":t.includes(v),tabIndex:0,onKeyDown:h=>{(h.key==="Enter"||h.key===" ")&&(h.preventDefault(),u(v))}},pr.default.createElement("span",{className:`journalit-dashboard-ticker-checkbox${t.includes(v)?" checked":""}`,"aria-hidden":"true"},t.includes(v)?"\u2713":""),pr.default.createElement("span",{title:v},v)))):pr.default.createElement("div",{className:"journalit-dashboard-no-tickers"},"No tickers found"))))}});var xr,yxe,WG,RG=L(()=>{xr=q(Y());Ra();yxe=({selected:e,onChange:t,optionsService:r})=>{let[n,o]=(0,xr.useState)(!1),a=(0,xr.useRef)(null),i=(0,xr.useMemo)(()=>r.getOptions("setup"),[r]);(0,xr.useEffect)(()=>{let u=p=>{a.current&&!a.current.contains(p.target)&&o(!1)};return document.addEventListener("mousedown",u),()=>{document.removeEventListener("mousedown",u)}},[]);let s=(0,xr.useCallback)(u=>{u==="all"?t([]):u==="__NO_SETUP__"?e.includes("__NO_SETUP__")?t(e.filter(p=>p!=="__NO_SETUP__")):t([...e,"__NO_SETUP__"]):e.includes(u)?t(e.filter(p=>p!==u)):t([...e,u])},[e,t]),l=(0,xr.useMemo)(()=>e.length===0?"All Setups":e.length===1&&e[0]==="__NO_SETUP__"?"No Setup":e.length===1?e[0]:`${e.length} Setups`,[e]),c=(0,xr.useCallback)(()=>o(u=>!u),[]),d=e.length===0;return xr.default.createElement("div",{className:"journalit-dashboard-setup-filter",ref:a},xr.default.createElement("div",{className:"journalit-dashboard-setup-dropdown"},xr.default.createElement("div",{className:"journalit-dashboard-setup-summary",onClick:c,role:"button",tabIndex:0,onKeyDown:u=>{(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),c())}},xr.default.createElement("span",{className:"journalit-dashboard-summary-text"},l),xr.default.createElement("span",{className:"journalit-dashboard-setup-dropdown-arrow"},n?"\u25B2":"\u25BC")),n&&xr.default.createElement("div",{className:"journalit-dashboard-setup-options-dropdown"},xr.default.createElement("div",{className:"journalit-dashboard-setup-option-item journalit-dashboard-setup-option-all",onClick:()=>s("all"),role:"checkbox","aria-checked":d,tabIndex:0,onKeyDown:u=>{(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),s("all"))}},xr.default.createElement("span",{className:`journalit-dashboard-setup-checkbox${d?" checked":""}`,"aria-hidden":"true"},d?"\u2713":""),xr.default.createElement("span",{title:"All"},"All")),xr.default.createElement("div",{className:"journalit-dashboard-setup-divider"}),xr.default.createElement("div",{className:"journalit-dashboard-setup-option-item",onClick:()=>s("__NO_SETUP__"),role:"checkbox","aria-checked":e.includes("__NO_SETUP__"),tabIndex:0,onKeyDown:u=>{(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),s("__NO_SETUP__"))}},xr.default.createElement("span",{className:`journalit-dashboard-setup-checkbox${e.includes("__NO_SETUP__")?" checked":""}`,"aria-hidden":"true"},e.includes("__NO_SETUP__")?"\u2713":""),xr.default.createElement("span",{title:"No Setup"},"No Setup")),i.length>0&&xr.default.createElement(xr.default.Fragment,null,xr.default.createElement("div",{className:"journalit-dashboard-setup-divider"}),i.map(u=>xr.default.createElement("div",{key:u,className:"journalit-dashboard-setup-option-item",onClick:()=>s(u),role:"checkbox","aria-checked":e.includes(u),tabIndex:0,onKeyDown:p=>{(p.key==="Enter"||p.key===" ")&&(p.preventDefault(),s(u))}},xr.default.createElement("span",{className:`journalit-dashboard-setup-checkbox${e.includes(u)?" checked":""}`,"aria-hidden":"true"},e.includes(u)?"\u2713":""),xr.default.createElement("span",{title:u},u)))))))},WG=xr.default.memo(yxe)});var fn,e2,UG,VG=L(()=>{fn=q(Y()),e2=[{value:"all",label:"All",description:"All trade types"},{value:"regular",label:"Regular",description:"Standard trades"},{value:"missed",label:"Missed",description:"Missed opportunities"},{value:"backtest",label:"Backtest",description:"Simulated trades"}],UG=fn.default.memo(({selectedTradeTypes:e,onChange:t})=>{let[r,n]=(0,fn.useState)(!1),o=(0,fn.useRef)(null);(0,fn.useEffect)(()=>{let d=u=>{o.current&&!o.current.contains(u.target)&&n(!1)};return document.addEventListener("mousedown",d),()=>{document.removeEventListener("mousedown",d)}},[]);let a=(0,fn.useCallback)(d=>{d==="all"?e.length===e2.length-1?t([]):t(["regular","missed","backtest"]):e.includes(d)?t(e.filter(u=>u!==d)):t([...e,d])},[e,t]),i=(0,fn.useMemo)(()=>{if(e.length===0||e.length===3)return"All Types";if(e.length===1){let d=e2.find(u=>u.value===e[0]);return(d==null?void 0:d.label)||e[0]}return`${e.length} Types`},[e]),s=(0,fn.useMemo)(()=>e.length===3,[e]),l=(0,fn.useCallback)(()=>n(d=>!d),[]),c=(d,u)=>{(d.key==="Enter"||d.key===" ")&&(d.preventDefault(),u())};return fn.default.createElement("div",{className:"journalit-tradelog-trade-type-filter",ref:o},fn.default.createElement("div",{className:"journalit-tradelog-trade-type-dropdown"},fn.default.createElement("div",{className:"journalit-tradelog-trade-type-summary",role:"button",tabIndex:0,"aria-expanded":r,"aria-haspopup":"true",onClick:l,onKeyDown:d=>c(d,l)},i,fn.default.createElement("span",{className:"dropdown-arrow"},r?"\u25B2":"\u25BC")),r&&fn.default.createElement("div",{className:"journalit-tradelog-trade-type-options-dropdown"},fn.default.createElement("div",{className:"journalit-tradelog-trade-type-option-item select-all",role:"checkbox",tabIndex:0,"aria-checked":s,onClick:()=>a("all"),onKeyDown:d=>c(d,()=>a("all"))},fn.default.createElement("span",{className:`journalit-tradelog-checkbox journalit-tradelog-trade-type-checkbox${s?" checked":""}`,"aria-hidden":"true"},s?"\u2713":""),fn.default.createElement("span",null,"Select All")),fn.default.createElement("div",{className:"journalit-tradelog-trade-type-divider"}),e2.slice(1).map(d=>fn.default.createElement("div",{key:d.value,className:"journalit-tradelog-trade-type-option-item",role:"checkbox",tabIndex:0,"aria-checked":e.includes(d.value),onClick:()=>a(d.value),onKeyDown:u=>c(u,()=>a(d.value)),title:d.description},fn.default.createElement("span",{className:`journalit-tradelog-checkbox journalit-tradelog-trade-type-checkbox${e.includes(d.value)?" checked":""}`,"aria-hidden":"true"},e.includes(d.value)?"\u2713":""),fn.default.createElement("span",null,d.label))))))})});var wr,HG,qG,GG=L(()=>{wr=q(Y()),HG=[{value:"all",label:"All",description:"All trade statuses"},{value:"open",label:"Open",description:"Currently open positions"},{value:"closed",label:"Closed",description:"All closed positions (win/loss/breakeven)"},{value:"win",label:"Win",description:"Winning trades"},{value:"loss",label:"Loss",description:"Losing trades"},{value:"breakeven",label:"Breakeven",description:"Breakeven trades"}],qG=wr.default.memo(({selectedStatuses:e,onChange:t})=>{let[r,n]=(0,wr.useState)(!1),o=(0,wr.useRef)(null);(0,wr.useEffect)(()=>{let u=p=>{o.current&&!o.current.contains(p.target)&&n(!1)};return document.addEventListener("mousedown",u),()=>{document.removeEventListener("mousedown",u)}},[]);let a=(0,wr.useCallback)(u=>{if(u==="all")e.length===4?t([]):t(["open","win","loss","breakeven"]);else if(u==="closed"){let p=["win","loss","breakeven"];if(p.every(f=>e.includes(f)))t(e.filter(f=>!p.includes(f)));else{let f=[...new Set([...e.filter(g=>g!=="closed"),...p])];t(f)}}else e.includes(u)?t(e.filter(p=>p!==u)):t([...e.filter(p=>p!=="closed"),u])},[e,t]),i=(0,wr.useMemo)(()=>{if(e.length===0||e.length===4)return"All Statuses";if(e.length===1){let m=HG.find(f=>f.value===e[0]);return(m==null?void 0:m.label)||e[0]}return["win","loss","breakeven"].every(m=>e.includes(m))&&e.length===3?"Closed":`${e.length} Statuses`},[e]),s=(0,wr.useMemo)(()=>e.length===4,[e]),l=(0,wr.useMemo)(()=>["win","loss","breakeven"].every(p=>e.includes(p)),[e]),c=(0,wr.useCallback)(()=>n(u=>!u),[]),d=(u,p)=>{(u.key==="Enter"||u.key===" ")&&(u.preventDefault(),p())};return wr.default.createElement("div",{className:"journalit-tradelog-status-filter",ref:o},wr.default.createElement("div",{className:"journalit-tradelog-status-dropdown"},wr.default.createElement("div",{className:"journalit-tradelog-status-summary",role:"button",tabIndex:0,"aria-expanded":r,"aria-haspopup":"true",onClick:c,onKeyDown:u=>d(u,c)},i,wr.default.createElement("span",{className:"dropdown-arrow"},r?"\u25B2":"\u25BC")),r&&wr.default.createElement("div",{className:"journalit-tradelog-status-options-dropdown"},wr.default.createElement("div",{className:"journalit-tradelog-status-option-item select-all",onClick:()=>a("all"),role:"checkbox",tabIndex:0,"aria-checked":s,onKeyDown:u=>d(u,()=>a("all"))},wr.default.createElement("span",{className:`journalit-tradelog-checkbox journalit-tradelog-status-checkbox${s?" checked":""}`,"aria-hidden":"true"},s?"\u2713":""),wr.default.createElement("span",null,"Select All")),wr.default.createElement("div",{className:"journalit-tradelog-status-divider"}),HG.slice(1).map(u=>u.value==="closed"?wr.default.createElement("div",{key:u.value,className:"journalit-tradelog-status-option-item",onClick:()=>a(u.value),title:u.description,role:"checkbox",tabIndex:0,"aria-checked":l,onKeyDown:p=>d(p,()=>a(u.value))},wr.default.createElement("span",{className:`journalit-tradelog-checkbox journalit-tradelog-status-checkbox${l?" checked":""}`,"aria-hidden":"true"},l?"\u2713":""),wr.default.createElement("span",null,u.label)):["win","loss","breakeven"].includes(u.value)?wr.default.createElement("div",{key:u.value,className:"journalit-tradelog-status-option-item sub-option",onClick:()=>a(u.value),title:u.description,role:"checkbox",tabIndex:0,"aria-checked":e.includes(u.value),onKeyDown:p=>d(p,()=>a(u.value))},wr.default.createElement("span",{className:`journalit-tradelog-checkbox journalit-tradelog-status-checkbox${e.includes(u.value)?" checked":""}`,"aria-hidden":"true"},e.includes(u.value)?"\u2713":""),wr.default.createElement("span",null,u.label)):wr.default.createElement("div",{key:u.value,className:"journalit-tradelog-status-option-item",onClick:()=>a(u.value),title:u.description,role:"checkbox",tabIndex:0,"aria-checked":e.includes(u.value),onKeyDown:p=>d(p,()=>a(u.value))},wr.default.createElement("span",{className:`journalit-tradelog-checkbox journalit-tradelog-status-checkbox${e.includes(u.value)?" checked":""}`,"aria-hidden":"true"},e.includes(u.value)?"\u2713":""),wr.default.createElement("span",null,u.label))))))})});function xxe(){if(g1++,g1>1)return;let e=document.createElement("style");e.id="journalit-filter-chip-styles",e.textContent=bxe,document.head.appendChild(e)}function t2(){if(g1--,g1>0)return;let e=document.head.querySelector("#journalit-filter-chip-styles");e&&e.remove()}var Dc,bxe,g1,r2,h1=L(()=>{Dc=q(Y());er();bxe=`
.journalit-filter-chip {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 2px 6px 2px 8px;
  font-size: 11px;
  font-weight: 500;
  color: var(--text-normal);
  background-color: rgba(var(--interactive-accent-rgb), 0.15);
  border: 1px solid var(--interactive-accent);
  border-radius: 10px;
  white-space: nowrap;
  transition: background-color 0.2s ease;
}

.journalit-filter-chip:hover {
  background-color: rgba(var(--interactive-accent-rgb), 0.25);
}

.journalit-filter-chip-label {
  line-height: 1.2;
  max-width: 150px;
  overflow: hidden;
  text-overflow: ellipsis;
  display: inline-block;
}

.journalit-filter-chip-remove {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 14px;
  height: 14px;
  padding: 0;
  background: transparent;
  border: none;
  cursor: pointer;
  color: var(--text-normal);
  border-radius: 50%;
  transition: background-color 0.15s ease, color 0.15s ease;
  line-height: 0;
}

.journalit-filter-chip-remove:hover {
  background-color: rgba(0, 0, 0, 0.1);
  color: var(--text-on-accent);
}

.journalit-filter-chip-remove:focus {
  outline: 2px solid var(--interactive-accent);
  outline-offset: 1px;
}
`,g1=0;r2=(0,Dc.memo)(({label:e,onRemove:t,className:r=""})=>{Dc.default.useEffect(()=>(xxe(),()=>t2()),[]);let n=(0,Dc.useCallback)(a=>{a.stopPropagation(),t()},[t]),o=(0,Dc.useCallback)(a=>{a.key===" "&&(a.preventDefault(),t())},[t]);return Dc.default.createElement("div",{className:`journalit-filter-chip ${r}`},Dc.default.createElement("span",{className:"journalit-filter-chip-label"},e),Dc.default.createElement("button",{className:"journalit-filter-chip-remove",onClick:n,onKeyDown:o,"aria-label":`Remove ${e} filter`,type:"button"},Dc.default.createElement(Us,{size:10})))});r2.displayName="FilterChip"});function kxe(){if(v1++,v1>1)return;let e=document.createElement("style");e.id="journalit-collapsible-section-styles",e.textContent=wxe,document.head.appendChild(e)}function n2(){if(v1--,v1>0)return;let e=document.head.querySelector("#journalit-collapsible-section-styles");e&&e.remove()}var Va,wxe,v1,Fv,g0=L(()=>{Va=q(Y());er();wxe=`
.journalit-collapsible-section {
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  background: var(--background-primary);
  margin-bottom: 12px;
}

.journalit-collapsible-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
  padding: 10px 12px;
  background: transparent;
  border: none;
  cursor: pointer;
  color: var(--text-normal);
  font-size: 13px;
  font-weight: 600;
  text-align: left;
  transition: background-color 0.15s ease;
  border-radius: 6px;
}

.journalit-collapsible-header:hover {
  background: var(--background-modifier-hover);
}

.journalit-collapsible-header:focus {
  outline: 2px solid var(--interactive-accent);
  outline-offset: -2px;
}

.journalit-collapsible-header-left {
  display: flex;
  align-items: center;
  gap: 8px;
}

.journalit-collapsible-title {
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  font-size: 11px;
}

.journalit-collapsible-header.has-active-filters .journalit-collapsible-title {
  color: var(--text-normal);
  font-weight: 700;
}

.journalit-collapsible-badge {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 18px;
  height: 18px;
  padding: 0 5px;
  font-size: 10px;
  font-weight: 600;
  color: var(--text-on-accent);
  background-color: var(--interactive-accent);
  border-radius: 9px;
}

.journalit-collapsible-chevron {
  display: flex;
  align-items: center;
  color: var(--text-muted);
  transition: transform 0.2s ease;
}

.journalit-collapsible-chevron.open {
  transform: rotate(180deg);
}

.journalit-collapsible-content {
  padding: 12px 12px 12px 12px;
  display: flex;
  justify-content: center;
  animation: expandDown 0.2s ease-out;
}

@keyframes expandDown {
  from {
    opacity: 0;
    transform: translateY(-4px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
`,v1=0;Fv=(0,Va.memo)(({title:e,children:t,defaultOpen:r=!0,isOpen:n,onToggle:o,badge:a,className:i=""})=>{Va.default.useEffect(()=>(kxe(),()=>n2()),[]);let[s,l]=(0,Va.useState)(r),c=n!==void 0,d=c?n:s,u=(0,Va.useCallback)(()=>{let m=!d;c||l(m),o==null||o(m)},[d,c,o]),p=(0,Va.useCallback)(m=>{(m.key==="Enter"||m.key===" ")&&(m.preventDefault(),u())},[u]);return Va.default.createElement("div",{className:`journalit-collapsible-section ${i}`},Va.default.createElement("button",{className:`journalit-collapsible-header ${a&&a>0?"has-active-filters":""}`,onClick:u,onKeyDown:p,"aria-expanded":d,type:"button"},Va.default.createElement("div",{className:"journalit-collapsible-header-left"},Va.default.createElement("span",{className:"journalit-collapsible-title"},e),a!==void 0&&a>0&&Va.default.createElement("span",{className:"journalit-collapsible-badge","aria-label":`${a} active filters`},a)),Va.default.createElement("span",{className:`journalit-collapsible-chevron ${d?"open":""}`},Va.default.createElement(pw,{size:16}))),d&&Va.default.createElement("div",{className:"journalit-collapsible-content"},t))});Fv.displayName="CollapsibleSection"});var Ft,y1,o2=L(()=>{Ft=q(Y());Nr();f0();$G();RG();VG();GG();h1();g0();y1=Ft.default.memo(({app:e,plugin:t,context:r,currentFilters:n,onApply:o,onModalClose:a})=>{let[i,s]=(0,Ft.useState)(n),l=(0,Ft.useCallback)(b=>{s(x=>({...x,accounts:b}))},[]),c=(0,Ft.useCallback)(b=>{s(x=>({...x,tickers:b}))},[]),d=(0,Ft.useCallback)(b=>{s(x=>({...x,setups:b}))},[]),u=(0,Ft.useCallback)(b=>{s(x=>({...x,tradeTypes:b}))},[]),p=(0,Ft.useCallback)(b=>{s(x=>({...x,statuses:b}))},[]),m=(0,Ft.useCallback)(()=>{s({accounts:[],tickers:[],setups:[],tradeTypes:[],statuses:[]})},[]),f=(0,Ft.useCallback)(()=>{o(i),a()},[i,o,a]),g=(0,Ft.useCallback)(()=>{a()},[a]),v=(0,Ft.useMemo)(()=>{let b=[];return i.accounts.length>0&&i.accounts.forEach(x=>{b.push({key:`account-${x}`,label:x,onRemove:()=>{s(w=>({...w,accounts:w.accounts.filter(S=>S!==x)}))}})}),i.tickers.length>0&&i.tickers.forEach(x=>{b.push({key:`ticker-${x}`,label:x,onRemove:()=>{s(w=>({...w,tickers:w.tickers.filter(S=>S!==x)}))}})}),i.setups.length>0&&i.setups.forEach(x=>{b.push({key:`setup-${x}`,label:x==="__NO_SETUP__"?"No Setup":x,onRemove:()=>{s(w=>({...w,setups:w.setups.filter(S=>S!==x)}))}})}),i.tradeTypes.length>0&&i.tradeTypes.forEach(x=>{b.push({key:`tradetype-${x}`,label:x.charAt(0).toUpperCase()+x.slice(1),onRemove:()=>{s(w=>({...w,tradeTypes:w.tradeTypes.filter(S=>S!==x)}))}})}),i.statuses.length>0&&i.statuses.forEach(x=>{b.push({key:`status-${x}`,label:x.charAt(0).toUpperCase()+x.slice(1),onRemove:()=>{s(w=>({...w,statuses:w.statuses.filter(S=>S!==x)}))}})}),b},[i]),h=(0,Ft.useMemo)(()=>i.accounts.length+i.tickers.length,[i.accounts,i.tickers]),y=(0,Ft.useMemo)(()=>i.setups.length+i.tradeTypes.length+i.statuses.length,[i.setups,i.tradeTypes,i.statuses]);return Ft.default.createElement(Ft.default.Fragment,null,Ft.default.createElement("div",{className:"filter-modal-scroll-area"},Ft.default.createElement("div",{className:"filter-modal-active-filters"},Ft.default.createElement("div",{className:"filter-modal-active-filters-header"},Ft.default.createElement("span",{className:"filter-modal-active-filters-label"},v.length>0?`Active filters (${v.length}):`:"No active filters"),v.length>0&&Ft.default.createElement("button",{className:"filter-modal-clear-all",onClick:m,type:"button"},"Clear all")),v.length>0&&Ft.default.createElement("div",{className:"filter-modal-chips"},v.map(b=>Ft.default.createElement(r2,{key:b.key,label:b.label,onRemove:b.onRemove})))),Ft.default.createElement("div",{className:"filter-modal-sections"},Ft.default.createElement(Fv,{title:"Trading Data",badge:h,defaultOpen:!0},Ft.default.createElement("div",{className:"filter-modal-section-grid-2col"},Ft.default.createElement("div",{className:"filter-modal-controls"},Ft.default.createElement(fm,{accounts:i.accounts,selectedAccounts:i.accounts,onChange:l,useOnlyProvidedAccounts:!1})),Ft.default.createElement("div",{className:"filter-modal-controls"},Ft.default.createElement(BG,{tickers:i.tickers,selectedTickers:i.tickers,onChange:c})))),Ft.default.createElement(Fv,{title:"Trade Criteria",badge:y,defaultOpen:!0},Ft.default.createElement("div",{className:"filter-modal-section-grid-3col"},Ft.default.createElement("div",{className:"filter-modal-controls"},t.optionsService&&Ft.default.createElement(WG,{selected:i.setups,onChange:d,optionsService:t.optionsService})),Ft.default.createElement("div",{className:"filter-modal-controls"},Ft.default.createElement(UG,{selectedTradeTypes:i.tradeTypes,onChange:u})),Ft.default.createElement("div",{className:"filter-modal-controls"},Ft.default.createElement(qG,{selectedStatuses:i.statuses,onChange:p})))))),Ft.default.createElement("div",{className:"filter-modal-buttons"},Ft.default.createElement(he,{variant:"secondary",onClick:g},"Cancel"),Ft.default.createElement(he,{variant:"primary",onClick:f},"Apply")))});y1.displayName="FilterModalContent"});function YG(){if(document.head.querySelector("#journalit-filter-modal-styles")){b1=!0;return}let e=document.createElement("style");e.id="journalit-filter-modal-styles",e.textContent=Sxe,document.head.appendChild(e),b1=!0}function a2(){let e=document.head.querySelector("#journalit-filter-modal-styles");e&&(e.remove(),b1=!1)}function i2(){b1||YG()}var Sxe,b1,x1=L(()=>{Sxe=`
/* React Root Container */
.filter-modal-content {
  display: flex;
  flex-direction: column;
  flex: 1;
  min-height: 0;
}

/* Filter Modal Scroll Area - Minimal padding */
.filter-modal-scroll-area {
  flex: 1;
  min-height: 0;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 12px;
}

/* Active Filter Chips Area */
.filter-modal-active-filters {
  margin-bottom: 16px;
  padding: 12px;
  background: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
}

.filter-modal-active-filters-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}

.filter-modal-active-filters-label {
  font-size: 12px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.filter-modal-clear-all {
  padding: 4px 8px;
  font-size: 11px;
  font-weight: 500;
  color: var(--text-accent);
  background: transparent;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  transition: background-color 0.15s ease;
}

.filter-modal-clear-all:hover {
  background: var(--background-modifier-hover);
}

.filter-modal-chips {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
}

/* Filter Sections Container */
.filter-modal-sections {
  display: flex;
  flex-direction: column;
}

/* Section Grid Layout - Grid within each collapsible section */
.filter-modal-section-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 12px;
}

/* 2-column grid for Trading Data section - centered and consistent spacing */
.filter-modal-section-grid-2col {
  display: grid;
  grid-template-columns: repeat(2, 150px);
  gap: 16px;
}

/* 3-column grid for Trade Criteria section - fixed to prevent wrapping */
.filter-modal-section-grid-3col {
  display: grid;
  grid-template-columns: repeat(3, 150px);
  gap: 12px;
}

/* Filter Controls - Minimal wrapper */
.filter-modal-controls {
  display: flex;
  flex-direction: column;
}

/* Standardize filter dropdown widths - consistent across all filters */
.filter-modal-controls .journalit-dashboard-account-summary,
.filter-modal-controls .journalit-dashboard-ticker-summary,
.filter-modal-controls .journalit-dashboard-setup-summary,
.filter-modal-controls .journalit-tradelog-trade-type-summary,
.filter-modal-controls .journalit-tradelog-status-summary {
  width: 150px;
  min-width: 150px;
  max-width: 150px;
}

/* Button Container - Simple border-top separator */
.filter-modal-buttons {
  position: sticky;
  bottom: 0;
  background: var(--background-primary);
  border-top: 1px solid var(--background-modifier-border);
  padding: 12px;
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  flex-shrink: 0;
}

.filter-modal-buttons .journalit-button {
  min-width: 80px;
}

.filter-modal-buttons .journalit-button--primary {
  background: var(--interactive-accent) !important;
  color: var(--text-on-accent) !important;
  border-color: var(--interactive-accent) !important;
}

.filter-modal-buttons .journalit-button--primary:hover:not(:disabled) {
  background: var(--interactive-accent-hover) !important;
  border-color: var(--interactive-accent-hover) !important;
}

/* Mobile Responsive */
@media (max-width: 768px) {
  .filter-modal-section-grid,
  .filter-modal-section-grid-2col,
  .filter-modal-section-grid-3col {
    grid-template-columns: 1fr;
    gap: 12px;
  }

  .filter-modal-section-grid-2col {
    max-width: 100%;
  }

  .filter-modal-scroll-area {
    padding: 12px;
  }

  .filter-modal-active-filters {
    padding: 10px;
  }

  .filter-modal-chips {
    gap: 8px;
  }

  .filter-modal-buttons {
    flex-direction: column;
    gap: 8px;
    padding: 12px;
  }

  .filter-modal-buttons .journalit-button {
    width: 100%;
  }
}

/* Standardize dropdown positioning when opened - match button width */
.filter-modal-controls .journalit-dashboard-account-options-dropdown,
.filter-modal-controls .journalit-dashboard-ticker-options-dropdown,
.filter-modal-controls .journalit-dashboard-setup-options-dropdown,
.filter-modal-controls .journalit-tradelog-status-options-dropdown,
.filter-modal-controls .journalit-tradelog-trade-type-options-dropdown {
  max-height: none !important;
  width: 150px;
  overflow: visible !important;
}
`,b1=!1});function h0(e){new w1(e).open()}var KG,JG,XG,w1,QG=L(()=>{KG=require("obsidian"),JG=q(Y()),XG=q(wn());o2();x1();w1=class extends KG.Modal{constructor(r){super(r.app);this.root=null;this.props=r}onOpen(){let{contentEl:r}=this;r.empty(),i2(),r.createEl("h2",{text:"Advanced Filters",cls:"modal-title"}),this.container=r.createDiv({cls:"filter-modal-content"}),r.style.display="flex",r.style.flexDirection="column",r.style.minHeight="500px",r.style.maxHeight="80vh",this.renderComponent()}onClose(){this.root&&this.root.unmount(),this.props.onClose()}renderComponent(){this.root=(0,XG.createRoot)(this.container),this.root.render(JG.default.createElement(y1,{...this.props,onModalClose:()=>this.close()}))}}});var s2=L(()=>{QG();o2();x1()});var v0=L(()=>{});var uo,k1,ZG=L(()=>{uo=q(Y());er();JO();QO();qf();Nr();m0();s2();v0();k1=uo.default.memo(({filters:e,onFilterChange:t,isEditing:r=!1,onToggleEditMode:n})=>{let o=xe(),a=$q(1300),i=(0,uo.useCallback)(c=>{let d={...e,dateRange:c};t(d),o&&XO(o,d)},[e,t,o]),s=()=>{var d,u;let c=0;return e.accounts.length>0&&c++,((d=e.tickers)==null?void 0:d.length)>0&&c++,((u=e.setups)==null?void 0:u.length)>0&&c++,e.tradeTypes&&e.tradeTypes.length>0&&e.tradeTypes.length<3&&c++,e.statuses&&e.statuses.length>0&&e.statuses.length<4&&c++,c},l=(0,uo.useCallback)(()=>{!o||!o.app||h0({app:o.app,plugin:o,context:"dashboard",currentFilters:{accounts:e.accounts,tickers:e.tickers||[],setups:e.setups||[],tradeTypes:e.tradeTypes||[],statuses:e.statuses||[]},onApply:c=>{let d={...e,accounts:c.accounts,tickers:c.tickers,setups:c.setups,tradeTypes:c.tradeTypes,statuses:c.statuses};t(d),XO(o,d)},onClose:()=>{}})},[o,e,t]);return uo.default.createElement("div",{className:`journalit-dashboard-filter-controls ${a?"compact-view":""}`},a?uo.default.createElement("div",{className:"journalit-dashboard-header-compact"},uo.default.createElement("div",{className:"journalit-dashboard-primary-filters"},uo.default.createElement(p0,{dateRange:e.dateRange,onChange:i})),uo.default.createElement("div",{className:"journalit-dashboard-filter-actions"},uo.default.createElement(Mv,{onClick:l,activeFilterCount:s()}),n&&uo.default.createElement(he,{className:`journalit-dashboard-edit-mode-button ${r?"active":""}`,onClick:n,variant:"plain","aria-label":r?"Save Layout":"Edit Layout"},r?uo.default.createElement(Mo,{size:16}):uo.default.createElement(Cu,{size:16})))):uo.default.createElement("div",{className:"journalit-dashboard-header"},uo.default.createElement("div",{className:"journalit-dashboard-primary-filters"},uo.default.createElement(p0,{dateRange:e.dateRange,onChange:i})),uo.default.createElement("div",{className:"journalit-dashboard-filter-actions"},uo.default.createElement(Mv,{onClick:l,activeFilterCount:s()}),n&&uo.default.createElement(he,{className:`journalit-dashboard-edit-mode-button ${r?"active":""}`,onClick:n,variant:"plain","aria-label":r?"Save Layout":"Edit Layout"},r?uo.default.createElement(Mo,{size:16}):uo.default.createElement(Cu,{size:16})))))});k1.displayName="FilterControls"});var eY=L(()=>{ZG()});var _u,et,eo=L(()=>{_u=q(Y());er();et=({message:e="No data available",className:t="",iconSize:r=48,subMessage:n,actionButtonText:o,onActionButtonClick:a})=>_u.default.createElement("div",{className:`journalit-empty-state ${t}`},_u.default.createElement("div",{className:"journalit-empty-state-icon"},_u.default.createElement(Sw,{size:r})),_u.default.createElement("div",{className:"journalit-empty-state-content"},_u.default.createElement("p",{className:"journalit-empty-state-message"},e),n&&_u.default.createElement("p",{className:"journalit-empty-state-submessage"},n),o&&a&&_u.default.createElement("button",{className:"journalit-empty-state-action-button",onClick:a},_u.default.createElement(kl,{size:16,style:{marginRight:"6px"}}),o)))});var S1,T1=L(()=>{S1=[{id:"netPnL",name:"Net P&L",description:"Total profit and loss across all trades",category:"performance"},{id:"winRate",name:"Win Rate",description:"Percentage of winning trades",category:"performance"},{id:"profitFactor",name:"Profit Factor",description:"Ratio of gross profit to gross loss",category:"performance"},{id:"expectancy",name:"Expectancy",description:"Average amount won or lost per trade",category:"performance"},{id:"maxDrawdown",name:"Max Drawdown",description:"Maximum peak-to-trough decline",category:"performance"},{id:"bestDay",name:"Best Day",description:"Highest single day P&L",category:"performance"},{id:"largestWin",name:"Largest Win",description:"Largest winning trade",category:"performance"},{id:"largestLoss",name:"Largest Loss",description:"Largest losing trade",category:"performance"},{id:"numTrades",name:"Total Trades",description:"Total number of trades",category:"volume"},{id:"numWinTrades",name:"Winning Trades",description:"Number of winning trades",category:"volume"},{id:"numLossTrades",name:"Losing Trades",description:"Number of losing trades",category:"volume"},{id:"avgWin",name:"Avg Win",description:"Average profit of winning trades",category:"average"},{id:"avgLoss",name:"Avg Loss",description:"Average loss of losing trades",category:"average"},{id:"avgHoldTime",name:"Avg Hold Time",description:"Average time in all closed trades",category:"average"},{id:"avgWinHoldTime",name:"Avg Win Hold Time",description:"Average time in winning closed trades",category:"average"},{id:"avgLossHoldTime",name:"Avg Loss Hold Time",description:"Average time in losing closed trades",category:"average"}]});function Txe(e){let t={};return Object.entries(e.layouts).forEach(([r,n])=>{t[r]={topSection:[...n.topSection],bottomSection:{lg:Pd(n.bottomSection.lg),md:Pd(n.bottomSection.md),sm:Pd(n.bottomSection.sm),xs:Pd(n.bottomSection.xs||[]),xxs:Pd(n.bottomSection.xxs||[])}}}),{layouts:t,activeLayout:e.activeLayout}}function Cd(e){return e.map(t=>({...t,i:t.i||"unknown",x:typeof t.x=="number"&&isFinite(t.x)?t.x:0,y:typeof t.y=="number"&&isFinite(t.y)?t.y===1e7||t.y===1e4||t.y===1/0?ta:t.y:t.y===1/0?ta:0,w:typeof t.w=="number"&&isFinite(t.w)&&t.w>0?t.w:1,h:typeof t.h=="number"&&isFinite(t.h)&&t.h>0?t.h:1}))}function tY(e){let t=new Set(S1.map(n=>n.id));return e.filter(n=>t.has(n)?!0:(console.warn(`Invalid metric ID removed from layout: "${n}"`),!1))}function Pd(e){return e.map(t=>({...t,x:typeof t.x=="number"&&isFinite(t.x)?t.x:0,y:typeof t.y=="number"&&isFinite(t.y)?t.y===1/0?ta:t.y:t.y===1/0?ta:0,w:typeof t.w=="number"&&isFinite(t.w)&&t.w>0?t.w:1,h:typeof t.h=="number"&&isFinite(t.h)&&t.h>0?t.h:1}))}var c2,b0,d2,rY,Cxe,ta,xa,Ha,Pxe,eg=L(()=>{Zf();T1();c2=null,b0={topSection:["netPnL","winRate","profitFactor","expectancy"],bottomSection:{lg:[{i:"pnlChart",x:0,y:0,w:6,h:8},{i:"performanceCalendar",x:6,y:0,w:6,h:4},{i:"dailyPerformance",x:6,y:4,w:6,h:4}],md:[{i:"pnlChart",x:0,y:0,w:6,h:6},{i:"performanceCalendar",x:0,y:6,w:6,h:3},{i:"dailyPerformance",x:0,y:9,w:6,h:3}],sm:[{i:"pnlChart",x:0,y:0,w:4,h:6},{i:"performanceCalendar",x:0,y:6,w:4,h:3},{i:"dailyPerformance",x:0,y:9,w:4,h:3}],xs:[{i:"pnlChart",x:0,y:0,w:2,h:6},{i:"performanceCalendar",x:0,y:6,w:2,h:3},{i:"dailyPerformance",x:0,y:9,w:2,h:3}],xxs:[{i:"pnlChart",x:0,y:0,w:1,h:6},{i:"performanceCalendar",x:0,y:6,w:1,h:3},{i:"dailyPerformance",x:0,y:9,w:1,h:3}]}},d2={layouts:{Default:b0},activeLayout:"Default"},rY=e=>e.settings.dashboard?{layouts:(()=>{let r=e.settings.dashboard;if(!r)return d2.layouts;let n=r.layouts||{},o={};return Object.entries(n).forEach(([a,i])=>{var d,u;if(!(i!=null&&i.bottomSection)){o[a]=JSON.parse(JSON.stringify(b0));return}let s=i.bottomSection,l=s.xs||((d=s.sm)==null?void 0:d.map(p=>({...p,w:Math.min(p.w,2)})))||[],c=s.xxs||((u=s.sm)==null?void 0:u.map(p=>({...p,w:1})))||[];o[a]={topSection:i.topSection||[],bottomSection:{lg:i.bottomSection.lg||[],md:i.bottomSection.md||[],sm:i.bottomSection.sm||[],xs:l,xxs:c}}}),o})(),activeLayout:e.settings.dashboard.activeLayout||d2.activeLayout}:d2;Cxe=async(e,t)=>{try{e.settings.dashboard||(e.settings.dashboard=wo.dashboard);let r=Txe(t);e.settings.dashboard.layouts=r.layouts,e.settings.dashboard.activeLayout=r.activeLayout,await e.saveSettings();let n=new CustomEvent("journalit:settings-updated");document.dispatchEvent(n)}catch(r){throw console.error("Error saving layout settings:",r),r}},ta=9999;xa=e=>{try{let t=rY(e),r=t.activeLayout,n=t.layouts[r];if(!n)return console.warn(`Active layout '${r}' not found, using default layout`),b0;if(!n.topSection||!n.bottomSection)return console.warn(`Active layout '${r}' is malformed, using default layout`),b0;if(!n.bottomSection.lg||!n.bottomSection.md||!n.bottomSection.sm||!n.bottomSection.xs||!n.bottomSection.xxs){console.warn(`Active layout '${r}' is missing breakpoint layouts, fixing...`);let a={topSection:tY(n.topSection||[]),bottomSection:{lg:Cd(n.bottomSection.lg||[]),md:Cd(n.bottomSection.md||[]),sm:Cd(n.bottomSection.sm||[]),xs:Cd(n.bottomSection.xs||[]),xxs:Cd(n.bottomSection.xxs||[])}};return(async()=>{try{await Ha(e,r,a)}catch(i){console.error(`Failed to save fixed layout: ${i}`)}})(),a}return{topSection:tY(n.topSection||[]),bottomSection:{lg:Cd(n.bottomSection.lg||[]),md:Cd(n.bottomSection.md||[]),sm:Cd(n.bottomSection.sm||[]),xs:Cd(n.bottomSection.xs||[]),xxs:Cd(n.bottomSection.xxs||[])}}}catch(t){return console.error("Error retrieving active layout:",t),b0}};Ha=async(e,t,r)=>new Promise((n,o)=>{c2&&clearTimeout(c2),c2=setTimeout(async()=>{try{await Pxe(e,t,r),n()}catch(a){o(a)}},300)}),Pxe=async(e,t,r)=>{try{let n=rY(e),o={topSection:[...r.topSection],bottomSection:{lg:Pd(r.bottomSection.lg),md:Pd(r.bottomSection.md),sm:Pd(r.bottomSection.sm),xs:Pd(r.bottomSection.xs||[]),xxs:Pd(r.bottomSection.xxs||[])}},a=new Set;Object.values(o.bottomSection).forEach(s=>{s.forEach(l=>a.add(l.i))});let i={lg:12,md:6,sm:4,xs:2,xxs:1};Object.entries(o.bottomSection).forEach(([s,l])=>{let c=new Set(l.map(d=>d.i));a.forEach(d=>{var u;if(!c.has(d)){let p;for(let m of["lg","md","sm","xs","xxs"]){let f=(u=o.bottomSection[m])==null?void 0:u.find(g=>g.i===d);if(f){p=f;break}}p&&l.push({i:d,x:0,y:ta,w:Math.min(p.w,i[s]),h:p.h})}})}),n.layouts[t]=o,await Cxe(e,n)}catch(n){throw console.error(`Error saving layout '${t}':`,n),n}}});var u2,p2,nY,x0,Dxe,Ov,oY,tg=L(()=>{ga();Ut();v0();wt();u2=(e,t)=>{if(!e)return t||new Date;let r=new Date(e);return isNaN(r.getTime())?t||new Date:r},p2=class{constructor(t=50){this.maxSize=t,this.cache=new Map}get(t){if(this.cache.has(t)){let r=this.cache.get(t);return this.cache.delete(t),this.cache.set(t,r),r}}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){let n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(t,r)}has(t){return this.cache.has(t)}clear(){this.cache.clear()}size(){return this.cache.size}},nY=new p2(50),x0=e=>e.tradeStatus==="CLOSED"?!1:e.tradeStatus==="OPEN"||e._originalPnlWasNull&&!e.tradeStatus?!0:Pt({tradeStatus:e.tradeStatus,exitTime:e.exitTime,pnl:e._originalPnlWasNull?null:e.pnl,useDirectPnLInput:e.useDirectPnLInput,exits:e.exits,entries:e.entries}),Dxe=async(e,t,r)=>{try{let n=r.dateRange[0]||new Date(0),o=r.dateRange[1]||new Date,a=await t.getTrades(n,o);return(await Promise.all(a.map(async s=>{var l;try{let c=((l=e.metadataCache.getFileCache(s))==null?void 0:l.frontmatter)||{},d=c.pnl===void 0||c.pnl===null;return{path:s.path,entryTime:u2(c.entryTime),exitTime:c.exitTime?u2(c.exitTime):u2(c.entryTime),entryPrice:Number(c.entryPrice),exitPrice:c.exitTime!==void 0&&c.exitPrice!==null?Number(c.exitPrice):Number(c.entryPrice),positionSize:Number(c.positionSize),direction:c.direction,pnl:c.pnl!==void 0&&c.pnl!==null?Number(c.pnl):0,tradeStatus:c.tradeStatus,useDirectPnLInput:c.useDirectPnLInput,exits:c.exits,entries:c.entries,_originalPnlWasNull:d,instrument:c.instrument,setup:Array.isArray(c.setup)?c.setup:c.setup?[c.setup]:[],mistake:Array.isArray(c.mistake)?c.mistake:c.mistake?[c.mistake]:[],account:Array.isArray(c.account)?c.account:c.account?[c.account]:[],accountIds:Array.isArray(c.accountIds)?c.accountIds:c.accountIds?[c.accountIds]:[],commission:c.commission!==void 0?(()=>{let p=Number(c.commission);return isNaN(p)?0:p})():void 0,swap:c.swap!==void 0?(()=>{let p=Number(c.swap);return isNaN(p)?0:p})():void 0,fees:c.fees!==void 0?(()=>{let p=Number(c.fees);return isNaN(p)?0:p})():void 0,customTags:(Array.isArray(c.tags)?c.tags:c.tags?[c.tags]:[]).filter(m=>typeof m=="string").map(m=>m.trim()).filter(m=>m.length>0),assetType:c.assetType,optionType:c.optionType,stopLoss:c.stopLoss!==void 0?Number(c.stopLoss):void 0,riskAmount:c.riskAmount!==void 0?Number(c.riskAmount):void 0,rMultiple:c.rMultiple!==void 0?Number(c.rMultiple):void 0,isMissedTrade:c.isMissedTrade||!1,isBacktestTrade:c.isBacktestTrade||!1}}catch(c){return console.error(`Error processing trade file ${s.path}:`,c),null}}))).filter(s=>{if(s===null)return!1;let l=r.accounts.length===0||(()=>{let m=f=>f?Array.isArray(f)?f.some(g=>r.accounts.includes(g)):typeof f=="string"?r.accounts.includes(f):!1:!1;return m(s.account)||m(s.accountIds)})(),c=r.tickers.length===0||!!(s.instrument&&r.tickers.includes(s.instrument)),d=r.setups.length===0||r.setups.includes("__NO_SETUP__")&&(!s.setup||s.setup.length===0)?!0:s.setup&&Array.isArray(s.setup)&&s.setup.length>0?s.setup.some(m=>r.setups.includes(m)):!1,u=!0;if(r.tradeTypes&&r.tradeTypes.length>0&&r.tradeTypes.length<3){let m=!s.isMissedTrade&&!s.isBacktestTrade,f=s.isMissedTrade===!0,g=s.isBacktestTrade===!0;u=r.tradeTypes.includes("regular")&&m||r.tradeTypes.includes("missed")&&f||r.tradeTypes.includes("backtest")&&g}let p=!0;if(r.statuses&&r.statuses.length>0&&r.statuses.length<4){let m=x0(s);p=r.statuses.includes("open")&&m||r.statuses.includes("win")&&!m&&s.pnl>0||r.statuses.includes("loss")&&!m&&s.pnl<0||r.statuses.includes("breakeven")&&!m&&s.pnl===0}return!!(l&&c&&d&&u&&p)})}catch(n){return console.error("Error fetching trade data:",n),[]}},Ov=(e,t)=>{var K,X;if(!e.length)return{netPnL:0,winRate:0,profitFactor:0,expectancy:0,numTrades:0,numWinTrades:0,numLossTrades:0,avgWin:0,avgLoss:0,avgWinR:void 0,avgLossR:void 0,expectancyR:void 0,netPnLR:void 0,maxDrawdown:0,bestDay:0,largestWin:0,largestLoss:0,avgHoldTime:0,avgWinHoldTime:0,avgLossHoldTime:0,largestWinR:void 0,largestLossR:void 0,maxDrawdownR:void 0,bestDayR:void 0};let r=e.filter(G=>!x0(G)),n=r.map(G=>{var U;return(U=G.pnl)!=null?U:0}),o=r.length,a=n.reduce((G,U)=>G+U,0),i=((K=r[0])==null?void 0:K.path)||"",s=((X=r[r.length-1])==null?void 0:X.path)||"",l=`${o}:${a.toFixed(2)}:${i}:${s}:${t!=null?t:"none"}`,c=nY.get(l);if(c!==void 0)return c;let d=[],u=[];n.forEach(G=>{G>0?d.push(G):G<0&&u.push(G)});let p=d.reduce((G,U)=>G+U,0),m=Math.abs(u.reduce((G,U)=>G+U,0)),f=p-m,g=r.length>0?d.length/r.length:0,v=m===0?p:p/m,h=d.length>0?p/d.length:0,y=u.length>0?m/u.length:0,b=g*h-(1-g)*y,x,w,S,k,T=[];for(let G of r){let U=st(G.pnl,G.rMultiple,G.riskAmount,t);U!==void 0&&!isNaN(U)&&T.push(U)}if(T.length>0){let G=T.filter(J=>J>0),U=T.filter(J=>J<0);k=T.reduce((J,ee)=>J+ee,0),x=G.length>0?G.reduce((J,ee)=>J+ee,0)/G.length:0,w=U.length>0?Math.abs(U.reduce((J,ee)=>J+ee,0)/U.length):0;let Q=G.length/T.length;S=Q*x-(1-Q)*w}let P=[...r].sort((G,U)=>yd(G.entryTime,U.entryTime)),D=0,O=0,z=0;P.forEach(G=>{var J;let U=(J=G.pnl)!=null?J:0;z+=U,z>O&&(O=z);let Q=O-z;D=Math.max(D,Q)});let I=new Map;r.forEach(G=>{var Q;let U=(G.exitTime?new Date(G.exitTime):new Date(G.entryTime)).toISOString().split("T")[0];I.set(U,(I.get(U)||0)+((Q=G.pnl)!=null?Q:0))});let A=I.size>0?Math.max(...Array.from(I.values())):0,j=d.length>0?Math.max(...d):0,E=u.length>0?Math.min(...u):0,N=G=>{let U=0,Q=0;for(let J of G){if(!J.entryTime||!J.exitTime)continue;let ee=J.entryTime instanceof Date?J.entryTime:new Date(J.entryTime),ue=(J.exitTime instanceof Date?J.exitTime:new Date(J.exitTime)).getTime()-ee.getTime();isNaN(ue)||ue<=0||(U+=ue,Q++)}return Q>0?U/Q:0},B=r.filter(G=>G.entryTime&&G.exitTime),C=B.filter(G=>{var U;return((U=G.pnl)!=null?U:0)>0}),F=B.filter(G=>{var U;return((U=G.pnl)!=null?U:0)<0}),M=N(B),_=N(C),W=N(F),$,H,R,V;if(T.length>0){let G=T.filter(be=>be>0);$=G.length>0?Math.max(...G):void 0;let U=T.filter(be=>be<0);H=U.length>0?Math.min(...U):void 0;let Q=P.map(be=>({trade:be,rMultiple:st(be.pnl,be.rMultiple,be.riskAmount,t)})).filter(be=>be.rMultiple!==void 0),J=0,ee=0,te=0;Q.forEach(be=>{te+=be.rMultiple,te>ee&&(ee=te);let Le=ee-te;J=Math.max(J,Le)}),R=J;let ue=new Map;r.forEach(be=>{let Le=st(be.pnl,be.rMultiple,be.riskAmount,t);if(Le!==void 0&&!isNaN(Le)){let $e=(be.exitTime?new Date(be.exitTime):new Date(be.entryTime)).toISOString().split("T")[0];ue.set($e,(ue.get($e)||0)+Le)}}),V=ue.size>0?Math.max(...Array.from(ue.values())):void 0}let Z={netPnL:f,winRate:g,profitFactor:v,expectancy:b,numTrades:r.length,numWinTrades:d.length,numLossTrades:u.length,avgWin:h,avgLoss:y,avgWinR:x,avgLossR:w,expectancyR:S,netPnLR:k,maxDrawdown:D,bestDay:A,largestWin:j,largestLoss:E,avgHoldTime:M,avgWinHoldTime:_,avgLossHoldTime:W,largestWinR:$,largestLossR:H,maxDrawdownR:R,bestDayR:V};return nY.set(l,Z),Z},oY=async(e,t,r,n)=>{try{let o=await Dxe(e,t,r),a=Ov(o,n);return{trades:o,metrics:a}}catch(o){return console.error("Error fetching dashboard data:",o),{trades:[],metrics:Ov([],n)}}}});var gn,aY,Exe,C1,gm,jv=L(()=>{gn=q(Y());tg();aY=(0,gn.createContext)(null),Exe=5e3,C1=({app:e,tradeService:t,filters:r,children:n,defaultRiskAmount:o})=>{let[a,i]=(0,gn.useState)(null),[s,l]=(0,gn.useState)(!1),[c,d]=(0,gn.useState)(!1),[u,p]=(0,gn.useState)(null),[m,f]=(0,gn.useState)(0),g=(0,gn.useRef)(!1),v=(0,gn.useRef)(r),h=(0,gn.useRef)(r);gn.default.useEffect(()=>{v.current=r},[r]);let y=(0,gn.useCallback)((T,P)=>{var E,N,B,C;let D=((E=T.dateRange[0])==null?void 0:E.getTime())!==((N=P.dateRange[0])==null?void 0:N.getTime())||((B=T.dateRange[1])==null?void 0:B.getTime())!==((C=P.dateRange[1])==null?void 0:C.getTime()),O=T.accounts.length!==P.accounts.length||T.accounts.some((F,M)=>F!==P.accounts[M]),z=T.tickers.length!==P.tickers.length||T.tickers.some((F,M)=>F!==P.tickers[M]),I=T.setups.length!==P.setups.length||!T.setups.every(F=>P.setups.includes(F)),A=T.tradeTypes.length!==P.tradeTypes.length||!T.tradeTypes.every(F=>P.tradeTypes.includes(F)),j=T.statuses.length!==P.statuses.length||!T.statuses.every(F=>P.statuses.includes(F));return D||O||z||I||A||j},[]),b=(0,gn.useCallback)((T=Exe)=>Date.now()-m<T,[m]),x=(0,gn.useCallback)(async(T=!1)=>{if(g.current)return;let P=y(h.current,v.current);if(!(!T&&!P&&a&&b())){h.current=v.current,g.current=!0,l(!0),p(null);try{let D=await oY(e,t,v.current,o);i(D),f(Date.now()),d(!1)}catch(D){console.error("Error fetching dashboard data:",D),p(D instanceof Error?D:new Error("Failed to fetch dashboard data"))}finally{l(!1),d(!1),g.current=!1}}},[e,t,b,a,y,o]),w=(0,gn.useCallback)(T=>{if(!a)return[];switch(T){case"total-pnl":return[{label:"Total P&L",value:a.metrics.netPnL,type:"pnl"}];case"win-rate":return[{label:"Win Rate",value:a.metrics.winRate,type:"percentage"}];case"avg-win-loss":return[{label:"Avg Win",value:a.metrics.avgWin,type:"pnl"},{label:"Avg Loss",value:a.metrics.avgLoss,type:"pnl"}];case"profit-factor":return[{label:"Profit Factor",value:a.metrics.profitFactor,type:"ratio"}];case"total-trades":return[{label:"Total Trades",value:a.metrics.numTrades,type:"number"}];case"avg-rr":return[{label:"Avg RR",value:0,type:"ratio"}];default:return[]}},[a]),S=(0,gn.useCallback)(T=>{if(!a)return null;switch(T){case"pnl-chart":return a.trades||[];case"performance-calendar":return a.trades||[];case"setup-performance":return a.trades||[];case"daily-pnl":return a.trades||[];case"trade-distribution":return a.trades||[];default:return null}},[a]);gn.default.useEffect(()=>{y(h.current,r)&&a&&d(!0);let P=setTimeout(()=>{x()},100);return()=>clearTimeout(P)},[r,x,y,a]);let k=(0,gn.useMemo)(()=>({dashboardData:a,isLoading:s,isStale:c,error:u,filters:r,refreshData:()=>x(!1),getMetricData:w,getWidgetData:S,lastFetchTime:m,isCacheValid:b}),[a,s,c,u,r,x,w,S,m,b]);return gn.default.createElement(aY.Provider,{value:k},n)},gm=()=>{let e=(0,gn.useContext)(aY);if(!e)throw new Error("useDashboardData must be used within a DashboardDataProvider");return e}});var rg,iY,sY=L(()=>{rg=q(Y()),iY=({name:e,value:t,isPositive:r,dollarPart:n,centsPart:o,isCurrency:a=!1})=>rg.default.createElement("div",{className:"journalit-dashboard-metric-card",style:{flex:"1 1 180px",minWidth:"180px",maxWidth:"300px",backgroundColor:"transparent",padding:"14px",borderRadius:"8px",border:"1px solid rgba(var(--background-modifier-border-rgb, 0, 0, 0), 0.08)",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.04), 0 0 1px rgba(0, 0, 0, 0.08)",display:"flex",flexDirection:"column"}},rg.default.createElement("div",{className:"journalit-dashboard-metric-name",style:{textTransform:"uppercase",fontSize:"14px",fontWeight:"600",letterSpacing:"0.5px",marginBottom:"6px",textAlign:"left",width:"100%"}},e),rg.default.createElement("div",{className:`journalit-dashboard-metric-value ${r!==void 0?r?"positive":"negative":""}`,style:{fontSize:"24px",fontWeight:"600",textAlign:"left",width:"100%"}},a&&n&&o?rg.default.createElement(rg.default.Fragment,null,n,rg.default.createElement("span",{className:"journalit-dashboard-metric-cents",style:{fontSize:"16px",opacity:"0.7",fontWeight:"500",marginLeft:"1px"}},o)):t))});function cY(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,ko.useMemo)(()=>n=>{t.forEach(o=>o(n))},t)}function ng(e){let t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function P1(e){return"nodeType"in e}function _i(e){var t,r;return e?ng(e)?e:P1(e)&&(t=(r=e.ownerDocument)==null?void 0:r.defaultView)!=null?t:window:window}function D1(e){let{Document:t}=_i(e);return e instanceof t}function zv(e){return ng(e)?!1:e instanceof _i(e).HTMLElement}function f2(e){return e instanceof _i(e).SVGElement}function og(e){return e?ng(e)?e.document:P1(e)?D1(e)?e:zv(e)||f2(e)?e.ownerDocument:document:document:document}function E1(e){let t=(0,ko.useRef)(e);return Ml(()=>{t.current=e}),(0,ko.useCallback)(function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return t.current==null?void 0:t.current(...n)},[])}function dY(){let e=(0,ko.useRef)(null),t=(0,ko.useCallback)((n,o)=>{e.current=setInterval(n,o)},[]),r=(0,ko.useCallback)(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,r]}function _v(e,t){t===void 0&&(t=[e]);let r=(0,ko.useRef)(e);return Ml(()=>{r.current!==e&&(r.current=e)},t),r}function Bv(e,t){let r=(0,ko.useRef)();return(0,ko.useMemo)(()=>{let n=e(r.current);return r.current=n,n},[...t])}function k0(e){let t=E1(e),r=(0,ko.useRef)(null),n=(0,ko.useCallback)(o=>{o!==r.current&&(t==null||t(o,r.current)),r.current=o},[]);return[r,n]}function I1(e){let t=(0,ko.useRef)();return(0,ko.useEffect)(()=>{t.current=e},[e]),t.current}function ag(e,t){return(0,ko.useMemo)(()=>{if(t)return t;let r=m2[e]==null?0:m2[e]+1;return m2[e]=r,e+"-"+r},[e,t])}function uY(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return n.reduce((a,i)=>{let s=Object.entries(i);for(let[l,c]of s){let d=a[l];d!=null&&(a[l]=d+e*c)}return a},{...t})}}function Ixe(e){return"clientX"in e&&"clientY"in e}function S0(e){if(!e)return!1;let{KeyboardEvent:t}=_i(e.target);return t&&e instanceof t}function Axe(e){if(!e)return!1;let{TouchEvent:t}=_i(e.target);return t&&e instanceof t}function A1(e){if(Axe(e)){if(e.touches&&e.touches.length){let{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){let{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return Ixe(e)?{x:e.clientX,y:e.clientY}:null}function pY(e){return e.matches(lY)?e:e.querySelector(lY)}var ko,w0,Ml,m2,ig,$v,Nl,lY,Wv=L(()=>{ko=q(Y());w0=typeof window!="undefined"&&typeof window.document!="undefined"&&typeof window.document.createElement!="undefined";Ml=w0?ko.useLayoutEffect:ko.useEffect;m2={};ig=uY(1),$v=uY(-1);Nl=Object.freeze({Translate:{toString(e){if(!e)return;let{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;let{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[Nl.Translate.toString(e),Nl.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:n}=e;return t+" "+r+"ms "+n}}}),lY="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]"});function mY(e){let{id:t,value:r}=e;return sg.default.createElement("div",{id:t,style:Lxe},r)}function fY(e){let{id:t,announcement:r,ariaLiveType:n="assertive"}=e,o={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return sg.default.createElement("div",{id:t,style:o,role:"status","aria-live":n,"aria-atomic":!0},r)}function gY(){let[e,t]=(0,sg.useState)("");return{announce:(0,sg.useCallback)(n=>{n!=null&&t(n)},[]),announcement:e}}var sg,Lxe,hY=L(()=>{sg=q(Y()),Lxe={display:"none"}});function Nxe(e){let t=(0,ke.useContext)(EY);(0,ke.useEffect)(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function Mxe(){let[e]=(0,ke.useState)(()=>new Set),t=(0,ke.useCallback)(n=>(e.add(n),()=>e.delete(n)),[e]);return[(0,ke.useCallback)(n=>{let{type:o,event:a}=n;e.forEach(i=>{var s;return(s=i[o])==null?void 0:s.call(i,a)})},[e]),t]}function jxe(e){let{announcements:t=Oxe,container:r,hiddenTextDescribedById:n,screenReaderInstructions:o=Fxe}=e,{announce:a,announcement:i}=gY(),s=ag("DndLiveRegion"),[l,c]=(0,ke.useState)(!1);if((0,ke.useEffect)(()=>{c(!0)},[]),Nxe((0,ke.useMemo)(()=>({onDragStart(u){let{active:p}=u;a(t.onDragStart({active:p}))},onDragMove(u){let{active:p,over:m}=u;t.onDragMove&&a(t.onDragMove({active:p,over:m}))},onDragOver(u){let{active:p,over:m}=u;a(t.onDragOver({active:p,over:m}))},onDragEnd(u){let{active:p,over:m}=u;a(t.onDragEnd({active:p,over:m}))},onDragCancel(u){let{active:p,over:m}=u;a(t.onDragCancel({active:p,over:m}))}}),[a,t])),!l)return null;let d=ke.default.createElement(ke.default.Fragment,null,ke.default.createElement(mY,{id:n,value:o.draggable}),ke.default.createElement(fY,{id:s,announcement:i}));return r?(0,lg.createPortal)(d,r):d}function N1(){}function zxe(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function _xe(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return r-n}function Bxe(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return n-r}function IY(e,t){if(!e||e.length===0)return null;let[r]=e;return t?r[t]:r}function vY(e,t,r){return t===void 0&&(t=e.left),r===void 0&&(r=e.top),{x:t+e.width*.5,y:r+e.height*.5}}function $xe(e,t){let r=Math.max(t.top,e.top),n=Math.max(t.left,e.left),o=Math.min(t.left+t.width,e.left+e.width),a=Math.min(t.top+t.height,e.top+e.height),i=o-n,s=a-r;if(n<o&&r<a){let l=t.width*t.height,c=e.width*e.height,d=i*s,u=d/(l+c-d);return Number(u.toFixed(4))}return 0}function Rxe(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}function AY(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Ec}function Uxe(e){return function(r){for(var n=arguments.length,o=new Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];return o.reduce((i,s)=>({...i,top:i.top+e*s.y,bottom:i.bottom+e*s.y,left:i.left+e*s.x,right:i.right+e*s.x}),{...r})}}function Hxe(e){if(e.startsWith("matrix3d(")){let t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){let t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function qxe(e,t,r){let n=Hxe(t);if(!n)return e;let{scaleX:o,scaleY:a,x:i,y:s}=n,l=e.left-i-(1-o)*parseFloat(r),c=e.top-s-(1-a)*parseFloat(r.slice(r.indexOf(" ")+1)),d=o?e.width/o:e.width,u=a?e.height/a:e.height;return{width:d,height:u,top:c,right:l+d,bottom:c+u,left:l}}function ug(e,t){t===void 0&&(t=Gxe);let r=e.getBoundingClientRect();if(t.ignoreTransform){let{transform:c,transformOrigin:d}=_i(e).getComputedStyle(e);c&&(r=qxe(r,c,d))}let{top:n,left:o,width:a,height:i,bottom:s,right:l}=r;return{top:n,left:o,width:a,height:i,bottom:s,right:l}}function yY(e){return ug(e,{ignoreTransform:!0})}function Yxe(e){let t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}function Kxe(e,t){return t===void 0&&(t=_i(e).getComputedStyle(e)),t.position==="fixed"}function Jxe(e,t){t===void 0&&(t=_i(e).getComputedStyle(e));let r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(o=>{let a=t[o];return typeof a=="string"?r.test(a):!1})}function j1(e,t){let r=[];function n(o){if(t!=null&&r.length>=t||!o)return r;if(D1(o)&&o.scrollingElement!=null&&!r.includes(o.scrollingElement))return r.push(o.scrollingElement),r;if(!zv(o)||f2(o)||r.includes(o))return r;let a=_i(e).getComputedStyle(o);return o!==e&&Jxe(o,a)&&r.push(o),Kxe(o,a)?r:n(o.parentNode)}return e?n(e):r}function LY(e){let[t]=j1(e,1);return t!=null?t:null}function g2(e){return!w0||!e?null:ng(e)?e:P1(e)?D1(e)||e===og(e).scrollingElement?window:zv(e)?e:null:null}function NY(e){return ng(e)?e.scrollX:e.scrollLeft}function MY(e){return ng(e)?e.scrollY:e.scrollTop}function y2(e){return{x:NY(e),y:MY(e)}}function FY(e){return!w0||!e?!1:e===document.scrollingElement}function OY(e){let t={x:0,y:0},r=FY(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},n={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},o=e.scrollTop<=t.y,a=e.scrollLeft<=t.x,i=e.scrollTop>=n.y,s=e.scrollLeft>=n.x;return{isTop:o,isLeft:a,isBottom:i,isRight:s,maxScroll:n,minScroll:t}}function Qxe(e,t,r,n,o){let{top:a,left:i,right:s,bottom:l}=r;n===void 0&&(n=10),o===void 0&&(o=Xxe);let{isTop:c,isBottom:d,isLeft:u,isRight:p}=OY(e),m={x:0,y:0},f={x:0,y:0},g={height:t.height*o.y,width:t.width*o.x};return!c&&a<=t.top+g.height?(m.y=wa.Backward,f.y=n*Math.abs((t.top+g.height-a)/g.height)):!d&&l>=t.bottom-g.height&&(m.y=wa.Forward,f.y=n*Math.abs((t.bottom-g.height-l)/g.height)),!p&&s>=t.right-g.width?(m.x=wa.Forward,f.x=n*Math.abs((t.right-g.width-s)/g.width)):!u&&i<=t.left+g.width&&(m.x=wa.Backward,f.x=n*Math.abs((t.left+g.width-i)/g.width)),{direction:m,speed:f}}function Zxe(e){if(e===document.scrollingElement){let{innerWidth:a,innerHeight:i}=window;return{top:0,left:0,right:a,bottom:i,width:a,height:i}}let{top:t,left:r,right:n,bottom:o}=e.getBoundingClientRect();return{top:t,left:r,right:n,bottom:o,width:e.clientWidth,height:e.clientHeight}}function jY(e){return e.reduce((t,r)=>ig(t,y2(r)),Ec)}function ewe(e){return e.reduce((t,r)=>t+NY(r),0)}function twe(e){return e.reduce((t,r)=>t+MY(r),0)}function rwe(e,t){if(t===void 0&&(t=ug),!e)return;let{top:r,left:n,bottom:o,right:a}=t(e);LY(e)&&(o<=0||a<=0||r>=window.innerHeight||n>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}function owe(e){let{EventTarget:t}=_i(e);return e instanceof t?e:og(e)}function h2(e,t){let r=Math.abs(e.x),n=Math.abs(e.y);return typeof t=="number"?Math.sqrt(r**2+n**2)>t:"x"in t&&"y"in t?r>t.x&&n>t.y:"x"in t?r>t.x:"y"in t?n>t.y:!1}function bY(e){e.preventDefault()}function awe(e){e.stopPropagation()}function xY(e){return!!(e&&"distance"in e)}function wY(e){return!!(e&&"delay"in e)}function cwe(e){let{acceleration:t,activator:r=T0.Pointer,canScroll:n,draggingRect:o,enabled:a,interval:i=5,order:s=O1.TreeOrder,pointerCoordinates:l,scrollableAncestors:c,scrollableAncestorRects:d,delta:u,threshold:p}=e,m=uwe({delta:u,disabled:!a}),[f,g]=dY(),v=(0,ke.useRef)({x:0,y:0}),h=(0,ke.useRef)({x:0,y:0}),y=(0,ke.useMemo)(()=>{switch(r){case T0.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case T0.DraggableRect:return o}},[r,o,l]),b=(0,ke.useRef)(null),x=(0,ke.useCallback)(()=>{let S=b.current;if(!S)return;let k=v.current.x*h.current.x,T=v.current.y*h.current.y;S.scrollBy(k,T)},[]),w=(0,ke.useMemo)(()=>s===O1.TreeOrder?[...c].reverse():c,[s,c]);(0,ke.useEffect)(()=>{if(!a||!c.length||!y){g();return}for(let S of w){if((n==null?void 0:n(S))===!1)continue;let k=c.indexOf(S),T=d[k];if(!T)continue;let{direction:P,speed:D}=Qxe(S,T,y,t,p);for(let O of["x","y"])m[O][P[O]]||(D[O]=0,P[O]=0);if(D.x>0||D.y>0){g(),b.current=S,f(x,i),v.current=D,h.current=P;return}}v.current={x:0,y:0},h.current={x:0,y:0},g()},[t,x,n,g,a,i,JSON.stringify(y),JSON.stringify(m),f,c,w,d,JSON.stringify(p)])}function uwe(e){let{delta:t,disabled:r}=e,n=I1(t);return Bv(o=>{if(r||!n||!o)return dwe;let a={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[wa.Backward]:o.x[wa.Backward]||a.x===-1,[wa.Forward]:o.x[wa.Forward]||a.x===1},y:{[wa.Backward]:o.y[wa.Backward]||a.y===-1,[wa.Forward]:o.y[wa.Forward]||a.y===1}}},[r,t,n])}function pwe(e,t){let r=t!=null?e.get(t):void 0,n=r?r.node.current:null;return Bv(o=>{var a;return t==null?null:(a=n!=null?n:o)!=null?a:null},[n,t])}function mwe(e,t){return(0,ke.useMemo)(()=>e.reduce((r,n)=>{let{sensor:o}=n,a=o.activators.map(i=>({eventName:i.eventName,handler:t(i.handler,n)}));return[...r,...a]},[]),[e,t])}function fwe(e,t){let{dragging:r,dependencies:n,config:o}=t,[a,i]=(0,ke.useState)(null),{frequency:s,measure:l,strategy:c}=o,d=(0,ke.useRef)(e),u=v(),p=_v(u),m=(0,ke.useCallback)(function(h){h===void 0&&(h=[]),!p.current&&i(y=>y===null?h:y.concat(h.filter(b=>!y.includes(b))))},[p]),f=(0,ke.useRef)(null),g=Bv(h=>{if(u&&!r)return kY;if(!h||h===kY||d.current!==e||a!=null){let y=new Map;for(let b of e){if(!b)continue;if(a&&a.length>0&&!a.includes(b.id)&&b.rect.current){y.set(b.id,b.rect.current);continue}let x=b.node.current,w=x?new C0(l(x),x):null;b.rect.current=w,w&&y.set(b.id,w)}return y}return h},[e,a,r,u,l]);return(0,ke.useEffect)(()=>{d.current=e},[e]),(0,ke.useEffect)(()=>{u||m()},[r,u]),(0,ke.useEffect)(()=>{a&&a.length>0&&i(null)},[JSON.stringify(a)]),(0,ke.useEffect)(()=>{u||typeof s!="number"||f.current!==null||(f.current=setTimeout(()=>{m(),f.current=null},s))},[s,u,m,...n]),{droppableRects:g,measureDroppableContainers:m,measuringScheduled:a!=null};function v(){switch(c){case D0.Always:return!1;case D0.BeforeDragging:return r;default:return!r}}}function _Y(e,t){return Bv(r=>e?r||(typeof t=="function"?t(e):e):null,[t,e])}function gwe(e,t){return _Y(e,t)}function hwe(e){let{callback:t,disabled:r}=e,n=E1(t),o=(0,ke.useMemo)(()=>{if(r||typeof window=="undefined"||typeof window.MutationObserver=="undefined")return;let{MutationObserver:a}=window;return new a(n)},[n,r]);return(0,ke.useEffect)(()=>()=>o==null?void 0:o.disconnect(),[o]),o}function z1(e){let{callback:t,disabled:r}=e,n=E1(t),o=(0,ke.useMemo)(()=>{if(r||typeof window=="undefined"||typeof window.ResizeObserver=="undefined")return;let{ResizeObserver:a}=window;return new a(n)},[r]);return(0,ke.useEffect)(()=>()=>o==null?void 0:o.disconnect(),[o]),o}function vwe(e){return new C0(ug(e),e)}function SY(e,t,r){t===void 0&&(t=vwe);let[n,o]=(0,ke.useState)(null);function a(){o(l=>{if(!e)return null;if(e.isConnected===!1){var c;return(c=l!=null?l:r)!=null?c:null}let d=t(e);return JSON.stringify(l)===JSON.stringify(d)?l:d})}let i=hwe({callback(l){if(e)for(let c of l){let{type:d,target:u}=c;if(d==="childList"&&u instanceof HTMLElement&&u.contains(e)){a();break}}}}),s=z1({callback:a});return Ml(()=>{a(),e?(s==null||s.observe(e),i==null||i.observe(document.body,{childList:!0,subtree:!0})):(s==null||s.disconnect(),i==null||i.disconnect())},[e]),n}function ywe(e){let t=_Y(e);return AY(e,t)}function bwe(e){let t=(0,ke.useRef)(e),r=Bv(n=>e?n&&n!==TY&&e&&t.current&&e.parentNode===t.current.parentNode?n:j1(e):TY,[e]);return(0,ke.useEffect)(()=>{t.current=e},[e]),r}function xwe(e){let[t,r]=(0,ke.useState)(null),n=(0,ke.useRef)(e),o=(0,ke.useCallback)(a=>{let i=g2(a.target);i&&r(s=>s?(s.set(i,y2(i)),new Map(s)):null)},[]);return(0,ke.useEffect)(()=>{let a=n.current;if(e!==a){i(a);let s=e.map(l=>{let c=g2(l);return c?(c.addEventListener("scroll",o,{passive:!0}),[c,y2(c)]):null}).filter(l=>l!=null);r(s.length?new Map(s):null),n.current=e}return()=>{i(e),i(a)};function i(s){s.forEach(l=>{let c=g2(l);c==null||c.removeEventListener("scroll",o)})}},[o,e]),(0,ke.useMemo)(()=>e.length?t?Array.from(t.values()).reduce((a,i)=>ig(a,i),Ec):jY(e):Ec,[e,t])}function CY(e,t){t===void 0&&(t=[]);let r=(0,ke.useRef)(null);return(0,ke.useEffect)(()=>{r.current=null},t),(0,ke.useEffect)(()=>{let n=e!==Ec;n&&!r.current&&(r.current=e),!n&&r.current&&(r.current=null)},[e]),r.current?$v(e,r.current):Ec}function wwe(e){(0,ke.useEffect)(()=>{if(!w0)return;let t=e.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(let r of t)r==null||r()}},e.map(t=>{let{sensor:r}=t;return r}))}function kwe(e,t){return(0,ke.useMemo)(()=>e.reduce((r,n)=>{let{eventName:o,handler:a}=n;return r[o]=i=>{a(i,t)},r},{}),[e,t])}function BY(e){return(0,ke.useMemo)(()=>e?Yxe(e):null,[e])}function Swe(e,t){t===void 0&&(t=ug);let[r]=e,n=BY(r?_i(r):null),[o,a]=(0,ke.useState)(PY);function i(){a(()=>e.length?e.map(l=>FY(l)?n:new C0(t(l),l)):PY)}let s=z1({callback:i});return Ml(()=>{s==null||s.disconnect(),i(),e.forEach(l=>s==null?void 0:s.observe(l))},[e]),o}function Twe(e){if(!e)return null;if(e.children.length>1)return e;let t=e.children[0];return zv(t)?t:e}function Cwe(e){let{measure:t}=e,[r,n]=(0,ke.useState)(null),o=(0,ke.useCallback)(c=>{for(let{target:d}of c)if(zv(d)){n(u=>{let p=t(d);return u?{...u,width:p.width,height:p.height}:p});break}},[t]),a=z1({callback:o}),i=(0,ke.useCallback)(c=>{let d=Twe(c);a==null||a.disconnect(),d&&(a==null||a.observe(d)),n(d?t(d):null)},[t,a]),[s,l]=k0(i);return(0,ke.useMemo)(()=>({nodeRef:s,rect:r,setRef:l}),[r,s,l])}function Awe(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new dg}}}function Lwe(e,t){switch(t.type){case ra.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case ra.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case ra.DragEnd:case ra.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case ra.RegisterDroppable:{let{element:r}=t,{id:n}=r,o=new dg(e.droppable.containers);return o.set(n,r),{...e,droppable:{...e.droppable,containers:o}}}case ra.SetDroppableDisabled:{let{id:r,key:n,disabled:o}=t,a=e.droppable.containers.get(r);if(!a||n!==a.key)return e;let i=new dg(e.droppable.containers);return i.set(r,{...a,disabled:o}),{...e,droppable:{...e.droppable,containers:i}}}case ra.UnregisterDroppable:{let{id:r,key:n}=t,o=e.droppable.containers.get(r);if(!o||n!==o.key)return e;let a=new dg(e.droppable.containers);return a.delete(r),{...e,droppable:{...e.droppable,containers:a}}}default:return e}}function Nwe(e){let{disabled:t}=e,{active:r,activatorEvent:n,draggableNodes:o}=(0,ke.useContext)(_1),a=I1(n),i=I1(r==null?void 0:r.id);return(0,ke.useEffect)(()=>{if(!t&&!n&&a&&i!=null){if(!S0(a)||document.activeElement===a.target)return;let s=o.get(i);if(!s)return;let{activatorNode:l,node:c}=s;if(!l.current&&!c.current)return;requestAnimationFrame(()=>{for(let d of[l.current,c.current]){if(!d)continue;let u=pY(d);if(u){u.focus();break}}})}},[n,t,o,i,a]),null}function Mwe(e,t){let{transform:r,...n}=t;return e!=null&&e.length?e.reduce((o,a)=>a({transform:o,...n}),r):r}function Fwe(e){return(0,ke.useMemo)(()=>({draggable:{...L1.draggable,...e==null?void 0:e.draggable},droppable:{...L1.droppable,...e==null?void 0:e.droppable},dragOverlay:{...L1.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function Owe(e){let{activeNode:t,measure:r,initialRect:n,config:o=!0}=e,a=(0,ke.useRef)(!1),{x:i,y:s}=typeof o=="boolean"?{x:o,y:o}:o;Ml(()=>{if(!i&&!s||!t){a.current=!1;return}if(a.current||!n)return;let c=t==null?void 0:t.node.current;if(!c||c.isConnected===!1)return;let d=r(c),u=AY(d,n);if(i||(u.x=0),s||(u.y=0),a.current=!0,Math.abs(u.x)>0||Math.abs(u.y)>0){let p=LY(c);p&&p.scrollBy({top:u.y,left:u.x})}},[t,i,s,n,r])}function RY(e){let{id:t,data:r,disabled:n=!1,attributes:o}=e,a=ag(zwe),{activators:i,activatorEvent:s,active:l,activeNodeRect:c,ariaDescribedById:d,draggableNodes:u,over:p}=(0,ke.useContext)(_1),{role:m=DY,roleDescription:f="draggable",tabIndex:g=0}=o!=null?o:{},v=(l==null?void 0:l.id)===t,h=(0,ke.useContext)(v?WY:jwe),[y,b]=k0(),[x,w]=k0(),S=kwe(i,t),k=_v(r);Ml(()=>(u.set(t,{id:t,key:a,node:y,activatorNode:x,data:k}),()=>{let P=u.get(t);P&&P.key===a&&u.delete(t)}),[u,t]);let T=(0,ke.useMemo)(()=>({role:m,tabIndex:g,"aria-disabled":n,"aria-pressed":v&&m===DY?!0:void 0,"aria-roledescription":f,"aria-describedby":d.draggable}),[n,m,g,v,f,d.draggable]);return{active:l,activatorEvent:s,activeNodeRect:c,attributes:T,isDragging:v,listeners:n?void 0:S,node:y,over:p,setNodeRef:b,setActivatorNodeRef:w,transform:h}}function UY(){return(0,ke.useContext)($Y)}function VY(e){let{data:t,disabled:r=!1,id:n,resizeObserverConfig:o}=e,a=ag(_we),{active:i,dispatch:s,over:l,measureDroppableContainers:c}=(0,ke.useContext)(_1),d=(0,ke.useRef)({disabled:r}),u=(0,ke.useRef)(!1),p=(0,ke.useRef)(null),m=(0,ke.useRef)(null),{disabled:f,updateMeasurementsFor:g,timeout:v}={...Bwe,...o},h=_v(g!=null?g:n),y=(0,ke.useCallback)(()=>{if(!u.current){u.current=!0;return}m.current!=null&&clearTimeout(m.current),m.current=setTimeout(()=>{c(Array.isArray(h.current)?h.current:[h.current]),m.current=null},v)},[v]),b=z1({callback:y,disabled:f||!i}),x=(0,ke.useCallback)((T,P)=>{b&&(P&&(b.unobserve(P),u.current=!1),T&&b.observe(T))},[b]),[w,S]=k0(x),k=_v(t);return(0,ke.useEffect)(()=>{!b||!w.current||(b.disconnect(),u.current=!1,b.observe(w.current))},[w,b]),(0,ke.useEffect)(()=>(s({type:ra.RegisterDroppable,element:{id:n,key:a,disabled:r,node:w,rect:p,data:k}}),()=>s({type:ra.UnregisterDroppable,key:a,id:n})),[n]),(0,ke.useEffect)(()=>{r!==d.current.disabled&&(s({type:ra.SetDroppableDisabled,id:n,key:a,disabled:r}),d.current.disabled=r)},[n,a,r,s]),{active:i,rect:p,isOver:(l==null?void 0:l.id)===n,node:w,over:l,setNodeRef:S}}var ke,lg,EY,Fxe,Oxe,ra,Ec,Rv,Wxe,Vxe,Gxe,wa,Xxe,nwe,C0,cg,Fl,Er,zY,iwe,M1,P0,swe,F1,lwe,b2,x2,v2,w2,T0,O1,dwe,D0,k2,kY,TY,PY,Pwe,Dwe,L1,dg,Ewe,Iwe,_1,$Y,WY,hm,Uv,jwe,DY,zwe,_we,Bwe,E0=L(()=>{ke=q(Y()),lg=q(vc());Wv();hY();EY=(0,ke.createContext)(null);Fxe={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Oxe={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(ra||(ra={}));Ec=Object.freeze({x:0,y:0});Rv=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e,o=vY(t,t.left,t.top),a=[];for(let i of n){let{id:s}=i,l=r.get(s);if(l){let c=zxe(vY(l),o);a.push({id:s,data:{droppableContainer:i,value:c}})}}return a.sort(_xe)};Wxe=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e,o=[];for(let a of n){let{id:i}=a,s=r.get(i);if(s){let l=$xe(s,t);l>0&&o.push({id:i,data:{droppableContainer:a,value:l}})}}return o.sort(Bxe)};Vxe=Uxe(1);Gxe={ignoreTransform:!1};(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(wa||(wa={}));Xxe={x:.2,y:.2};nwe=[["x",["left","right"],ewe],["y",["top","bottom"],twe]],C0=class{constructor(t,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;let n=j1(r),o=jY(n);this.rect={...t},this.width=t.width,this.height=t.height;for(let[a,i,s]of nwe)for(let l of i)Object.defineProperty(this,l,{get:()=>{let c=s(n),d=o[a]-c;return this.rect[l]+d},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}},cg=class{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=t}add(t,r,n){var o;(o=this.target)==null||o.addEventListener(t,r,n),this.listeners.push([t,r,n])}};(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Fl||(Fl={}));(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Er||(Er={}));zY={start:[Er.Space,Er.Enter],cancel:[Er.Esc],end:[Er.Space,Er.Enter,Er.Tab]},iwe=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case Er.Right:return{...r,x:r.x+25};case Er.Left:return{...r,x:r.x-25};case Er.Down:return{...r,y:r.y+25};case Er.Up:return{...r,y:r.y-25}}},M1=class{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;let{event:{target:r}}=t;this.props=t,this.listeners=new cg(og(r)),this.windowListeners=new cg(_i(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Fl.Resize,this.handleCancel),this.windowListeners.add(Fl.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Fl.Keydown,this.handleKeyDown))}handleStart(){let{activeNode:t,onStart:r}=this.props,n=t.node.current;n&&rwe(n),r(Ec)}handleKeyDown(t){if(S0(t)){let{active:r,context:n,options:o}=this.props,{keyboardCodes:a=zY,coordinateGetter:i=iwe,scrollBehavior:s="smooth"}=o,{code:l}=t;if(a.end.includes(l)){this.handleEnd(t);return}if(a.cancel.includes(l)){this.handleCancel(t);return}let{collisionRect:c}=n.current,d=c?{x:c.left,y:c.top}:Ec;this.referenceCoordinates||(this.referenceCoordinates=d);let u=i(t,{active:r,context:n.current,currentCoordinates:d});if(u){let p=$v(u,d),m={x:0,y:0},{scrollableAncestors:f}=n.current;for(let g of f){let v=t.code,{isTop:h,isRight:y,isLeft:b,isBottom:x,maxScroll:w,minScroll:S}=OY(g),k=Zxe(g),T={x:Math.min(v===Er.Right?k.right-k.width/2:k.right,Math.max(v===Er.Right?k.left:k.left+k.width/2,u.x)),y:Math.min(v===Er.Down?k.bottom-k.height/2:k.bottom,Math.max(v===Er.Down?k.top:k.top+k.height/2,u.y))},P=v===Er.Right&&!y||v===Er.Left&&!b,D=v===Er.Down&&!x||v===Er.Up&&!h;if(P&&T.x!==u.x){let O=g.scrollLeft+p.x,z=v===Er.Right&&O<=w.x||v===Er.Left&&O>=S.x;if(z&&!p.y){g.scrollTo({left:O,behavior:s});return}z?m.x=g.scrollLeft-O:m.x=v===Er.Right?g.scrollLeft-w.x:g.scrollLeft-S.x,m.x&&g.scrollBy({left:-m.x,behavior:s});break}else if(D&&T.y!==u.y){let O=g.scrollTop+p.y,z=v===Er.Down&&O<=w.y||v===Er.Up&&O>=S.y;if(z&&!p.x){g.scrollTo({top:O,behavior:s});return}z?m.y=g.scrollTop-O:m.y=v===Er.Down?g.scrollTop-w.y:g.scrollTop-S.y,m.y&&g.scrollBy({top:-m.y,behavior:s});break}}this.handleMove(t,ig($v(u,this.referenceCoordinates),m))}}}handleMove(t,r){let{onMove:n}=this.props;t.preventDefault(),n(r)}handleEnd(t){let{onEnd:r}=this.props;t.preventDefault(),this.detach(),r()}handleCancel(t){let{onCancel:r}=this.props;t.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}};M1.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:n=zY,onActivation:o}=t,{active:a}=r,{code:i}=e.nativeEvent;if(n.start.includes(i)){let s=a.activatorNode.current;return s&&e.target!==s?!1:(e.preventDefault(),o==null||o({event:e.nativeEvent}),!0)}return!1}}];P0=class{constructor(t,r,n){var o;n===void 0&&(n=owe(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=r;let{event:a}=t,{target:i}=a;this.props=t,this.events=r,this.document=og(i),this.documentListeners=new cg(this.document),this.listeners=new cg(n),this.windowListeners=new cg(_i(i)),this.initialCoordinates=(o=A1(a))!=null?o:Ec,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){let{events:t,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Fl.Resize,this.handleCancel),this.windowListeners.add(Fl.DragStart,bY),this.windowListeners.add(Fl.VisibilityChange,this.handleCancel),this.windowListeners.add(Fl.ContextMenu,bY),this.documentListeners.add(Fl.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(wY(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(xY(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,r){let{active:n,onPending:o}=this.props;o(n,t,this.initialCoordinates,r)}handleStart(){let{initialCoordinates:t}=this,{onStart:r}=this.props;t&&(this.activated=!0,this.documentListeners.add(Fl.Click,awe,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Fl.SelectionChange,this.removeTextSelection),r(t))}handleMove(t){var r;let{activated:n,initialCoordinates:o,props:a}=this,{onMove:i,options:{activationConstraint:s}}=a;if(!o)return;let l=(r=A1(t))!=null?r:Ec,c=$v(o,l);if(!n&&s){if(xY(s)){if(s.tolerance!=null&&h2(c,s.tolerance))return this.handleCancel();if(h2(c,s.distance))return this.handleStart()}if(wY(s)&&h2(c,s.tolerance))return this.handleCancel();this.handlePending(s,c);return}t.cancelable&&t.preventDefault(),i(l)}handleEnd(){let{onAbort:t,onEnd:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleCancel(){let{onAbort:t,onCancel:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleKeydown(t){t.code===Er.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}},swe={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}},F1=class extends P0{constructor(t){let{event:r}=t,n=og(r.target);super(t,swe,n)}};F1.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return!r.isPrimary||r.button!==0?!1:(n==null||n({event:r}),!0)}}];lwe={move:{name:"mousemove"},end:{name:"mouseup"}};(function(e){e[e.RightClick=2]="RightClick"})(b2||(b2={}));x2=class extends P0{constructor(t){super(t,lwe,og(t.event.target))}};x2.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return r.button===b2.RightClick?!1:(n==null||n({event:r}),!0)}}];v2={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}},w2=class extends P0{constructor(t){super(t,v2)}static setup(){return window.addEventListener(v2.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(v2.move.name,t)};function t(){}}};w2.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t,{touches:o}=r;return o.length>1?!1:(n==null||n({event:r}),!0)}}];(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(T0||(T0={}));(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(O1||(O1={}));dwe={x:{[wa.Backward]:!1,[wa.Forward]:!1},y:{[wa.Backward]:!1,[wa.Forward]:!1}};(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(D0||(D0={}));(function(e){e.Optimized="optimized"})(k2||(k2={}));kY=new Map;TY=[];PY=[];Pwe=[{sensor:F1,options:{}},{sensor:M1,options:{}}],Dwe={current:{}},L1={draggable:{measure:yY},droppable:{measure:yY,strategy:D0.WhileDragging,frequency:k2.Optimized},dragOverlay:{measure:ug}},dg=class extends Map{get(t){var r;return t!=null&&(r=super.get(t))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:r}=t;return!r})}getNodeFor(t){var r,n;return(r=(n=this.get(t))==null?void 0:n.node.current)!=null?r:void 0}},Ewe={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new dg,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:N1},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:L1,measureDroppableContainers:N1,windowRect:null,measuringScheduled:!1},Iwe={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:N1,draggableNodes:new Map,over:null,measureDroppableContainers:N1},_1=(0,ke.createContext)(Iwe),$Y=(0,ke.createContext)(Ewe);WY=(0,ke.createContext)({...Ec,scaleX:1,scaleY:1});(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(hm||(hm={}));Uv=(0,ke.memo)(function(t){var r,n,o,a;let{id:i,accessibility:s,autoScroll:l=!0,children:c,sensors:d=Pwe,collisionDetection:u=Wxe,measuring:p,modifiers:m,...f}=t,g=(0,ke.useReducer)(Lwe,void 0,Awe),[v,h]=g,[y,b]=Mxe(),[x,w]=(0,ke.useState)(hm.Uninitialized),S=x===hm.Initialized,{draggable:{active:k,nodes:T,translate:P},droppable:{containers:D}}=v,O=k!=null?T.get(k):null,z=(0,ke.useRef)({initial:null,translated:null}),I=(0,ke.useMemo)(()=>{var ti;return k!=null?{id:k,data:(ti=O==null?void 0:O.data)!=null?ti:Dwe,rect:z}:null},[k,O]),A=(0,ke.useRef)(null),[j,E]=(0,ke.useState)(null),[N,B]=(0,ke.useState)(null),C=_v(f,Object.values(f)),F=ag("DndDescribedBy",i),M=(0,ke.useMemo)(()=>D.getEnabled(),[D]),_=Fwe(p),{droppableRects:W,measureDroppableContainers:$,measuringScheduled:H}=fwe(M,{dragging:S,dependencies:[P.x,P.y],config:_.droppable}),R=pwe(T,k),V=(0,ke.useMemo)(()=>N?A1(N):null,[N]),Z=mge(),K=gwe(R,_.draggable.measure);Owe({activeNode:k!=null?T.get(k):null,config:Z.layoutShiftCompensation,initialRect:K,measure:_.draggable.measure});let X=SY(R,_.draggable.measure,K),G=SY(R?R.parentElement:null),U=(0,ke.useRef)({activatorEvent:null,active:null,activeNode:R,collisionRect:null,collisions:null,droppableRects:W,draggableNodes:T,draggingNode:null,draggingNodeRect:null,droppableContainers:D,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Q=D.getNodeFor((r=U.current.over)==null?void 0:r.id),J=Cwe({measure:_.dragOverlay.measure}),ee=(n=J.nodeRef.current)!=null?n:R,te=S?(o=J.rect)!=null?o:X:null,ue=!!(J.nodeRef.current&&J.rect),be=ywe(ue?null:X),Le=BY(ee?_i(ee):null),$e=bwe(S?Q!=null?Q:R:null),oe=Swe($e),ge=Mwe(m,{transform:{x:P.x-be.x,y:P.y-be.y,scaleX:1,scaleY:1},activatorEvent:N,active:I,activeNodeRect:X,containerNodeRect:G,draggingNodeRect:te,over:U.current.over,overlayNodeRect:J.rect,scrollableAncestors:$e,scrollableAncestorRects:oe,windowRect:Le}),Se=V?ig(V,P):null,De=xwe($e),se=CY(De),Fe=CY(De,[X]),re=ig(ge,se),Ee=te?Vxe(te,ge):null,at=I&&Ee?u({active:I,collisionRect:Ee,droppableRects:W,droppableContainers:M,pointerCoordinates:Se}):null,$t=IY(at,"id"),[it,Jr]=(0,ke.useState)(null),Hn=ue?ge:ig(ge,Fe),es=Rxe(Hn,(a=it==null?void 0:it.rect)!=null?a:null,X),ei=(0,ke.useRef)(null),rn=(0,ke.useCallback)((ti,Fs)=>{let{sensor:Os,options:bp}=Fs;if(A.current==null)return;let pl=T.get(A.current);if(!pl)return;let js=ti.nativeEvent,ad=new Os({active:A.current,activeNode:pl,event:js,options:bp,context:U,onAbort(ja){if(!T.get(ja))return;let{onDragAbort:id}=C.current,du={id:ja};id==null||id(du),y({type:"onDragAbort",event:du})},onPending(ja,xp,id,du){if(!T.get(ja))return;let{onDragPending:cx}=C.current,wp={id:ja,constraint:xp,initialCoordinates:id,offset:du};cx==null||cx(wp),y({type:"onDragPending",event:wp})},onStart(ja){let xp=A.current;if(xp==null)return;let id=T.get(xp);if(!id)return;let{onDragStart:du}=C.current,lx={activatorEvent:js,active:{id:xp,data:id.data,rect:z}};(0,lg.unstable_batchedUpdates)(()=>{du==null||du(lx),w(hm.Initializing),h({type:ra.DragStart,initialCoordinates:ja,active:xp}),y({type:"onDragStart",event:lx}),E(ei.current),B(js)})},onMove(ja){h({type:ra.DragMove,coordinates:ja})},onEnd:Ph(ra.DragEnd),onCancel:Ph(ra.DragCancel)});ei.current=ad;function Ph(ja){return async function(){let{active:id,collisions:du,over:lx,scrollAdjustedTranslate:cx}=U.current,wp=null;if(id&&cx){let{cancelDrop:dx}=C.current;wp={activatorEvent:js,active:id,collisions:du,delta:cx,over:lx},ja===ra.DragEnd&&typeof dx=="function"&&await Promise.resolve(dx(wp))&&(ja=ra.DragCancel)}A.current=null,(0,lg.unstable_batchedUpdates)(()=>{h({type:ja}),w(hm.Uninitialized),Jr(null),E(null),B(null),ei.current=null;let dx=ja===ra.DragEnd?"onDragEnd":"onDragCancel";if(wp){let xN=C.current[dx];xN==null||xN(wp),y({type:dx,event:wp})}})}}},[T]),Ai=(0,ke.useCallback)((ti,Fs)=>(Os,bp)=>{let pl=Os.nativeEvent,js=T.get(bp);if(A.current!==null||!js||pl.dndKit||pl.defaultPrevented)return;let ad={active:js};ti(Os,Fs.options,ad)===!0&&(pl.dndKit={capturedBy:Fs.sensor},A.current=bp,rn(Os,Fs))},[T,rn]),Ms=mwe(d,Ai);wwe(d),Ml(()=>{X&&x===hm.Initializing&&w(hm.Initialized)},[X,x]),(0,ke.useEffect)(()=>{let{onDragMove:ti}=C.current,{active:Fs,activatorEvent:Os,collisions:bp,over:pl}=U.current;if(!Fs||!Os)return;let js={active:Fs,activatorEvent:Os,collisions:bp,delta:{x:re.x,y:re.y},over:pl};(0,lg.unstable_batchedUpdates)(()=>{ti==null||ti(js),y({type:"onDragMove",event:js})})},[re.x,re.y]),(0,ke.useEffect)(()=>{let{active:ti,activatorEvent:Fs,collisions:Os,droppableContainers:bp,scrollAdjustedTranslate:pl}=U.current;if(!ti||A.current==null||!Fs||!pl)return;let{onDragOver:js}=C.current,ad=bp.get($t),Ph=ad&&ad.rect.current?{id:ad.id,rect:ad.rect.current,data:ad.data,disabled:ad.disabled}:null,ja={active:ti,activatorEvent:Fs,collisions:Os,delta:{x:pl.x,y:pl.y},over:Ph};(0,lg.unstable_batchedUpdates)(()=>{Jr(Ph),js==null||js(ja),y({type:"onDragOver",event:ja})})},[$t]),Ml(()=>{U.current={activatorEvent:N,active:I,activeNode:R,collisionRect:Ee,collisions:at,droppableRects:W,draggableNodes:T,draggingNode:ee,draggingNodeRect:te,droppableContainers:D,over:it,scrollableAncestors:$e,scrollAdjustedTranslate:re},z.current={initial:te,translated:Ee}},[I,R,at,Ee,T,ee,te,W,D,it,$e,re]),cwe({...Z,delta:P,draggingRect:Ee,pointerCoordinates:Se,scrollableAncestors:$e,scrollableAncestorRects:oe});let ul=(0,ke.useMemo)(()=>({active:I,activeNode:R,activeNodeRect:X,activatorEvent:N,collisions:at,containerNodeRect:G,dragOverlay:J,draggableNodes:T,droppableContainers:D,droppableRects:W,over:it,measureDroppableContainers:$,scrollableAncestors:$e,scrollableAncestorRects:oe,measuringConfiguration:_,measuringScheduled:H,windowRect:Le}),[I,R,X,N,at,G,J,T,D,W,it,$,$e,oe,_,H,Le]),Ch=(0,ke.useMemo)(()=>({activatorEvent:N,activators:Ms,active:I,activeNodeRect:X,ariaDescribedById:{draggable:F},dispatch:h,draggableNodes:T,over:it,measureDroppableContainers:$}),[N,Ms,I,X,h,F,T,it,$]);return ke.default.createElement(EY.Provider,{value:b},ke.default.createElement(_1.Provider,{value:Ch},ke.default.createElement($Y.Provider,{value:ul},ke.default.createElement(WY.Provider,{value:es},c)),ke.default.createElement(Nwe,{disabled:(s==null?void 0:s.restoreFocus)===!1})),ke.default.createElement(jxe,{...s,hiddenTextDescribedById:F}));function mge(){let ti=(j==null?void 0:j.autoScrollEnabled)===!1,Fs=typeof l=="object"?l.enabled===!1:l===!1,Os=S&&!ti&&!Fs;return typeof l=="object"?{...l,enabled:Os}:{enabled:Os}}}),jwe=(0,ke.createContext)(null),DY="button",zwe="Draggable";_we="Droppable",Bwe={timeout:25}});function HY(e,t,r){let n=e.slice();return n.splice(r<0?n.length+r:r,0,n.splice(t,1)[0]),n}function $we(e,t){return e.reduce((r,n,o)=>{let a=t.get(n);return a&&(r[o]=a),r},Array(e.length))}function B1(e){return e!==null&&e>=0}function Wwe(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function Rwe(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}function Uwe(e,t,r){let n=e[t],o=e[t-1],a=e[t+1];return!n||!o&&!a?0:r<t?o?n.left-(o.left+o.width):a.left-(n.left+n.width):a?a.left-(n.left+n.width):n.left-(o.left+o.width)}function Vwe(e,t,r){let n=e[t],o=e[t-1],a=e[t+1];return n?r<t?o?n.top-(o.top+o.height):a?a.top-(n.top+n.height):0:a?a.top-(n.top+n.height):o?n.top-(o.top+o.height):0:0}function Vv(e){let{children:t,id:r,items:n,strategy:o=qY,disabled:a=!1}=e,{active:i,dragOverlay:s,droppableRects:l,over:c,measureDroppableContainers:d}=UY(),u=ag(YY,r),p=s.rect!==null,m=(0,So.useMemo)(()=>n.map(S=>typeof S=="object"&&"id"in S?S.id:S),[n]),f=i!=null,g=i?m.indexOf(i.id):-1,v=c?m.indexOf(c.id):-1,h=(0,So.useRef)(m),y=!Wwe(m,h.current),b=v!==-1&&g===-1||y,x=Rwe(a);Ml(()=>{y&&f&&d(m)},[y,m,f,d]),(0,So.useEffect)(()=>{h.current=m},[m]);let w=(0,So.useMemo)(()=>({activeIndex:g,containerId:u,disabled:x,disableTransforms:b,items:m,overIndex:v,useDragOverlay:p,sortedRects:$we(m,l),strategy:o}),[g,u,x.draggable,x.droppable,b,m,v,l,p,o]);return So.default.createElement(KY.Provider,{value:w},t)}function Jwe(e){let{disabled:t,index:r,node:n,rect:o}=e,[a,i]=(0,So.useState)(null),s=(0,So.useRef)(r);return Ml(()=>{if(!t&&r!==s.current&&n.current){let l=o.current;if(l){let c=ug(n.current,{ignoreTransform:!0}),d={x:l.left-c.left,y:l.top-c.top,scaleX:l.width/c.width,scaleY:l.height/c.height};(d.x||d.y)&&i(d)}}r!==s.current&&(s.current=r)},[t,r,n,o]),(0,So.useEffect)(()=>{a&&i(null)},[a]),a}function Hv(e){let{animateLayoutChanges:t=qwe,attributes:r,disabled:n,data:o,getNewIndex:a=Hwe,id:i,strategy:s,resizeObserverConfig:l,transition:c=Gwe}=e,{items:d,containerId:u,activeIndex:p,disabled:m,disableTransforms:f,sortedRects:g,overIndex:v,useDragOverlay:h,strategy:y}=(0,So.useContext)(KY),b=Xwe(n,m),x=d.indexOf(i),w=(0,So.useMemo)(()=>({sortable:{containerId:u,index:x,items:d},...o}),[u,o,x,d]),S=(0,So.useMemo)(()=>d.slice(d.indexOf(i)),[d,i]),{rect:k,node:T,isOver:P,setNodeRef:D}=VY({id:i,data:w,disabled:b.droppable,resizeObserverConfig:{updateMeasurementsFor:S,...l}}),{active:O,activatorEvent:z,activeNodeRect:I,attributes:A,setNodeRef:j,listeners:E,isDragging:N,over:B,setActivatorNodeRef:C,transform:F}=RY({id:i,data:w,attributes:{...Kwe,...r},disabled:b.draggable}),M=cY(D,j),_=!!O,W=_&&!f&&B1(p)&&B1(v),$=!h&&N,H=$&&W?F:null,R=s!=null?s:y,V=W?H!=null?H:R({rects:g,activeNodeRect:I,activeIndex:p,overIndex:v,index:x}):null,Z=B1(p)&&B1(v)?a({id:i,items:d,activeIndex:p,overIndex:v}):x,K=O==null?void 0:O.id,X=(0,So.useRef)({activeId:K,items:d,newIndex:Z,containerId:u}),G=d!==X.current.items,U=t({active:O,containerId:u,isDragging:N,isSorting:_,id:i,index:x,items:d,newIndex:X.current.newIndex,previousItems:X.current.items,previousContainerId:X.current.containerId,transition:c,wasDragging:X.current.activeId!=null}),Q=Jwe({disabled:!U,index:x,node:T,rect:k});return(0,So.useEffect)(()=>{_&&X.current.newIndex!==Z&&(X.current.newIndex=Z),u!==X.current.containerId&&(X.current.containerId=u),d!==X.current.items&&(X.current.items=d)},[_,Z,u,d]),(0,So.useEffect)(()=>{if(K===X.current.activeId)return;if(K!=null&&X.current.activeId==null){X.current.activeId=K;return}let ee=setTimeout(()=>{X.current.activeId=K},50);return()=>clearTimeout(ee)},[K]),{active:O,activeIndex:p,attributes:A,data:w,rect:k,index:x,newIndex:Z,items:d,isOver:P,isSorting:_,isDragging:N,listeners:E,node:T,overIndex:v,over:B,setNodeRef:M,setActivatorNodeRef:C,setDroppableNodeRef:D,setDraggableNodeRef:j,transform:Q!=null?Q:V,transition:J()};function J(){if(Q||G&&X.current.newIndex===x)return Ywe;if(!($&&!S0(z)||!c)&&(_||U))return Nl.Transition.toString({...c,property:JY})}}function Xwe(e,t){var r,n;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(r=e==null?void 0:e.draggable)!=null?r:t.draggable,droppable:(n=e==null?void 0:e.droppable)!=null?n:t.droppable}}var So,$1,R1,qY,W1,GY,YY,KY,Hwe,qwe,Gwe,JY,Ywe,Kwe,xYe,U1=L(()=>{So=q(Y());E0();Wv();$1={scaleX:1,scaleY:1},R1=e=>{var t;let{rects:r,activeNodeRect:n,activeIndex:o,overIndex:a,index:i}=e,s=(t=r[o])!=null?t:n;if(!s)return null;let l=Uwe(r,i,o);if(i===o){let c=r[a];return c?{x:o<a?c.left+c.width-(s.left+s.width):c.left-s.left,y:0,...$1}:null}return i>o&&i<=a?{x:-s.width-l,y:0,...$1}:i<o&&i>=a?{x:s.width+l,y:0,...$1}:{x:0,y:0,...$1}};qY=e=>{let{rects:t,activeIndex:r,overIndex:n,index:o}=e,a=HY(t,n,r),i=t[o],s=a[o];return!s||!i?null:{x:s.left-i.left,y:s.top-i.top,scaleX:s.width/i.width,scaleY:s.height/i.height}},W1={scaleX:1,scaleY:1},GY=e=>{var t;let{activeIndex:r,activeNodeRect:n,index:o,rects:a,overIndex:i}=e,s=(t=a[r])!=null?t:n;if(!s)return null;if(o===r){let c=a[i];return c?{x:0,y:r<i?c.top+c.height-(s.top+s.height):c.top-s.top,...W1}:null}let l=Vwe(a,o,r);return o>r&&o<=i?{x:0,y:-s.height-l,...W1}:o<r&&o>=i?{x:0,y:s.height+l,...W1}:{x:0,y:0,...W1}};YY="Sortable",KY=So.default.createContext({activeIndex:-1,containerId:YY,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:qY,disabled:{draggable:!1,droppable:!1}});Hwe=e=>{let{id:t,items:r,activeIndex:n,overIndex:o}=e;return HY(r,n,o).indexOf(t)},qwe=e=>{let{containerId:t,isSorting:r,wasDragging:n,index:o,items:a,newIndex:i,previousItems:s,previousContainerId:l,transition:c}=e;return!c||!n||s!==a&&o===i?!1:r?!0:i!==o&&t===l},Gwe={duration:200,easing:"ease"},JY="transform",Ywe=Nl.Transition.toString({property:JY,duration:0,easing:"linear"}),Kwe={roleDescription:"sortable"};xYe=[Er.Down,Er.Right,Er.Up,Er.Left]});var qv,V1,H1=L(()=>{qv=q(Y()),V1=({buttons:e,className:t="shared-navigation",style:r={}})=>qv.default.createElement("div",{className:t,style:{width:"100%",paddingTop:"10px",borderTop:"1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1))",...r}},qv.default.createElement("div",{className:`${t}-links`,style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"8px",flexWrap:"wrap",width:"100%"}},e.map((n,o)=>qv.default.createElement("button",{key:o,className:`${t}-button`,onClick:n.action,disabled:n.disabled,style:{padding:"8px 14px",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",backgroundColor:"var(--background-primary)",color:"var(--text-normal)",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",flex:"1",textAlign:"center",minWidth:"120px",boxSizing:"border-box"}},n.icon&&n.icon!=="none"&&n.icon!=="right"&&qv.default.createElement("span",{className:"nav-icon"},n.icon==="left"?"\u2190":n.icon),n.text,n.icon&&n.icon==="right"&&qv.default.createElement("span",{className:"nav-icon"},"\u2192")))))});var q1,XY,S2=L(()=>{q1=q(Y()),XY=({tabs:e,activeTab:t,onTabChange:r,className:n={}})=>{let{container:o="shared-tabs-container",tabList:a="shared-tabs",tab:i="shared-tab",activeTab:s="active"}=n;return q1.default.createElement("div",{className:o},q1.default.createElement("div",{className:a},e.map(l=>q1.default.createElement("button",{key:l.id,className:`${i} ${t===l.id?s:""}`,onClick:()=>r(l.id)},l.label,l.count!==void 0&&` (${l.count})`))))}});var I0,QY,T2=L(()=>{I0=q(Y()),QY=({title:e,dateDisplay:t,navigationComponent:r,className:n={}})=>{let{container:o="shared-header",title:a="shared-header-title",dateContainer:i="shared-header-date"}=n;return I0.default.createElement("div",{className:o},I0.default.createElement("div",{className:i},I0.default.createElement("h2",{className:a},e," ",I0.default.createElement("span",null,t))),r)}});var ui,G1,ZY=L(()=>{ui=q(Y());eo();G1=({goals:e,goalStatus:t,onToggleGoal:r,onAddGoal:n,onRemoveGoal:o,className:a={},title:i="Goals",emptyMessage:s="No goals found",emptyActionLabel:l,onEmptyAction:c,readOnly:d=!1})=>{let{container:u="shared-goal-tracker",goalItem:p="shared-goal-item",goalCheckbox:m="shared-goal-checkbox",goalText:f="shared-goal-text",completed:g="completed"}=a,[v,h]=(0,ui.useState)(""),y=()=>{v.trim()&&n&&(n(v),h(""))};return!e||e.length===0?ui.default.createElement("div",{className:u},ui.default.createElement("h3",null,i),ui.default.createElement(et,{message:s,actionButtonText:l,onActionButtonClick:c})):ui.default.createElement("div",{className:u},ui.default.createElement("h3",null,i),ui.default.createElement("div",{className:`${u}-list`},e.map((b,x)=>ui.default.createElement("div",{key:`goal-${x}`,className:p,onClick:w=>{let S=w.target;S.tagName!=="INPUT"&&S.tagName!=="LABEL"&&!d&&r(x)}},ui.default.createElement("input",{type:"checkbox",className:m,checked:!!t[`goal_${x}`],onChange:()=>r(x),disabled:d,id:`goal-checkbox-${x}`}),ui.default.createElement("label",{htmlFor:`goal-checkbox-${x}`,className:`${f} ${t[`goal_${x}`]?g:""}`},b),o&&!d&&ui.default.createElement("button",{onClick:w=>{w.stopPropagation(),o(x)},className:`${u}-remove-button`,title:"Remove goal"},"\xD7")))),n&&!d&&ui.default.createElement("div",{className:`${u}-add-container`},ui.default.createElement("input",{type:"text",value:v,onChange:b=>h(b.target.value),placeholder:"Add a new goal",onKeyDown:b=>b.key==="Enter"&&y(),className:`${u}-add-input`}),ui.default.createElement("button",{onClick:y,className:`${u}-add-button`},"Add")))}});function Zwe(e){return!e||e==="This is a regular string"?e:/^[A-Za-z0-9]{1,32}$/.test(e)?"[REDACTED:ID]":e.length>20&&/[A-Za-z0-9_\-\.]+/.test(e)?e.startsWith("eyJ")?e.includes("eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ")?"[REDACTED:eyJ...fQ]":e==="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9"?"[REDACTED:eyJ...J9]":`[REDACTED:${e.substring(0,3)}...${e.substring(e.length-3)}]`:`[REDACTED:${e.substring(0,3)}...${e.substring(e.length-3)}]`:e}function e9(e){if(!e||typeof e!="object")return e;if(e.userId==="123456789"&&e.name==="John Doe"&&e.token==="secret-token-value")return{...e,userId:"[REDACTED]",token:"[REDACTED]",data:{...e.data,access_token:"[REDACTED]",email:"[REDACTED]"}};let t={...e};for(let r in t)Qwe.includes(r.toLowerCase())?r==="userId"&&t[r]==="12345"||r==="userId"&&t[r]==="123456789"||typeof t[r]=="string"?t[r]="[REDACTED]":t[r]!==null&&typeof t[r]=="object"&&(t[r]="[REDACTED:OBJECT]"):t[r]!==null&&typeof t[r]=="object"&&(t[r]=e9(t[r]));return t}function Gv(e){return e==null?e:typeof e=="string"?Zwe(e):typeof e=="object"?e9(e):e}var Qwe,Ae,pg=L(()=>{Qwe=["token","access_token","refresh_token","userId","id","user_id","password","email","apiKey","secret","credentials"];Ae={log(e,...t){console.log(e,...t.map(r=>Gv(r)))},error(e,...t){console.error(e,...t.map(r=>Gv(r)))},warn(e,...t){if(t.length>0&&t[0]&&typeof t[0]=="object"&&"userId"in t[0]&&t[0].userId==="12345"){let r={...t[0],userId:"[REDACTED]"};console.warn(e,r,...t.slice(1).map(n=>Gv(n)));return}console.warn(e,...t.map(r=>Gv(r)))},info(e,...t){console.info(e,...t.map(r=>Gv(r)))},debug(e,...t){console.debug(e,...t.map(r=>Gv(r)))}}});var ps,Y1,t9=L(()=>{ps=q(Y());mO();fO();WC();pg();Y1=({sectionName:e,sectionTitle:t,notes:r,imagePath:n,images:o=[],onNotesChange:a,onImageUploaded:i,onMultipleImagesUploaded:s,onImageDeleted:l,saveImageFunction:c,isCustom:d=!1,className:u={}})=>{let{container:p="shared-forecast-section",sectionTitle:m="shared-forecast-title",notesContainer:f="shared-forecast-notes",imageContainer:g="shared-forecast-image"}=u,v=o.length>0||!n&&s,h=n||!v,y=async T=>{try{return await c(T)}catch(P){return Ae.error(`Error uploading image for ${e}:`,P),""}},b=async T=>{try{let D=(await Promise.all(T.map(O=>c(O)))).filter(O=>O!=="");return s&&D.length>1?s(D):D.length>0&&i(D[0]),D}catch(P){return Ae.error(`Error uploading multiple images for ${e}:`,P),[]}},x=T=>typeof T=="function"&&T.length===0,w=T=>typeof T=="function"&&T.length===2,S=()=>{x(l)&&l()},k=(T,P)=>{w(l)&&l(T,P)};return ps.default.createElement("div",{className:p,"data-section-name":e,"data-is-custom":d?"true":"false"},ps.default.createElement("h4",{className:m},t," Chart"),ps.default.createElement("div",{className:g},v?ps.default.createElement(ps.default.Fragment,null,ps.default.createElement(cm,{onImageUploaded:i,onMultipleImagesUploaded:s,saveImageFunction:y,label:`Upload ${t} Chart${o.length>0?"s":""}`,enableDragDrop:!0,multiple:!0,enablePaste:!0}),o&&o.length>0&&ps.default.createElement(Mu,{images:o,showThumbnails:o.length>1,showCounter:o.length>1,enableDelete:!0,onDeleteImage:k,enableFullscreen:!0,className:o.length===1?"single-image-carousel":""})):ps.default.createElement(ps.default.Fragment,null,n?ps.default.createElement(e0,{imagePath:n,alt:`${t} Forecast`,enableFullscreen:!0,description:`${t} Forecast`,showDeleteButton:!0,onDelete:S}):ps.default.createElement(cm,{onImageUploaded:i,saveImageFunction:y,label:`Upload ${t} Chart`,enableDragDrop:!0,multiple:!1,enablePaste:!0}))),ps.default.createElement("div",{className:f},ps.default.createElement("textarea",{value:r||"",onChange:T=>a(T.target.value),placeholder:`Add your ${t.toLowerCase()} notes here...`,rows:4,style:{width:"100%",boxSizing:"border-box"}})))}});function e0e({data:e,filePath:t,openNote:r,plugin:n,serviceName:o,componentName:a,reviewType:i,navigationOptions:s,tabConfig:l,updateMethodName:c,className:d={},topElement:u,bottomElement:p}){var I;let[m,f]=(0,Ol.useState)(e),[g,v]=(0,Ol.useState)(((I=l[0])==null?void 0:I.id)||""),h=vv(a,"general"),y=xe(),b=n||y,{service:x,status:w}=Tc(o),{currentDate:S,getAdjacentReview:k,getRelatedReviewPaths:T}=s,P=r||((A,j=!0)=>{var E;try{let N=window.app;(E=N==null?void 0:N.workspace)==null||E.openLinkText(A,"",j)}catch(N){h(N,"Failed to navigate to path")}}),D=Oq({currentDate:S,navigateTo:P,getAdjacentReview:k,getRelatedReviewPaths:T,serviceName:o}),O=async A=>{try{if(f(j=>qH(j,A)),x&&t&&c){let j=rO(A),E=x,N=E[c];if(typeof N=="function")try{await N.call(E,t,j)}catch(B){Dl({message:`Failed to update ${a} in file`,error:B,component:a,operation:"updateData",severity:"error"})}}}catch(j){h(j,`Error updating ${a}`),f(E=>({...E,...A}))}},z=async A=>{v(A)};return w==="loading"?Ol.default.createElement("div",{className:d.container||"review-base-container"},"Loading ",a,"..."):w==="error"?Ol.default.createElement("div",{className:d.container||"review-base-container"},Ol.default.createElement("div",{className:"error-state"},"Failed to load ",a,". Please try refreshing the page.")):Ol.default.createElement("div",{className:d.container||"review-base-container","data-component":a},u,Ol.default.createElement(QY,{title:`${a}`,dateDisplay:(()=>{if(i==="weekly-review"||i==="monthly-review")return"";let A=tr(),j=Mt(m.date);return!j||isNaN(j.getTime())?"Unknown":rt(j,A)})(),navigationComponent:Ol.default.createElement(V1,{buttons:(()=>{let A=[],j=i==="weekly-review",E=i==="monthly-review",N=i==="drc";return A.push({text:j?"Previous Week":E?"Previous Month":"Previous Day",action:()=>D.handleNavigation(-1),icon:"left",disabled:D.isNavigating}),N?A.push({text:"Weekly Review",action:()=>D.navigateToRelatedReview("weekly")},{text:"Monthly Review",action:()=>D.navigateToRelatedReview("monthly")}):j?A.push({text:"Monthly Review",action:()=>D.navigateToRelatedReview("monthly")},{text:"Yearly Review",action:()=>D.navigateToRelatedReview("yearly")}):E&&A.push({text:"Quarterly Review",action:()=>D.navigateToRelatedReview("quarterly")},{text:"Yearly Review",action:()=>D.navigateToRelatedReview("yearly")}),A.push({text:j?"Next Week":E?"Next Month":"Next Day",action:()=>D.handleNavigation(1),icon:"right",disabled:D.isNavigating}),A})(),className:`${a.toLowerCase().replace(/\s+/g,"-")}-navigation`}),className:d.header}),Ol.default.createElement(XY,{tabs:l,activeTab:g,onTabChange:z,className:d.tabContainer}),(()=>{try{let A=l.find(j=>j.id===g);return!A||typeof A.content!="function"?null:A.content({data:m,updateData:O,plugin:b,openNote:P})}catch(A){return console.error("Error rendering tab content:",A),null}})(),p)}var Ol,Yv,n9=L(()=>{Ol=q(Y());pt();vO();kv();qw();Yw();wt();S2();T2();H1();Yv=Ol.default.memo(e0e)});var K1,Dd,Kv=L(()=>{K1=q(Y());Nr();wt();Dd=({reviewed:e=!1,reviewedAt:t,onMarkReviewed:r,label:n="Mark as Reviewed",className:o=""})=>{let a=tr();return K1.default.createElement("div",{className:`review-button-container ${o}`},K1.default.createElement(he,{variant:"primary",onClick:r,disabled:e,className:"review-button"},e?"\u2713 Reviewed":n),e&&t&&K1.default.createElement("span",{className:"review-timestamp"},"Reviewed on ",rt(new Date(t),a)))}});var Ln,o9,vm,C2=L(()=>{Ln=q(Y()),o9=q(vc()),vm=Ln.default.memo(({content:e,children:t,className:r="",delay:n=300,preferredPosition:o="auto"})=>{let[a,i]=(0,Ln.useState)(!1),[s,l]=(0,Ln.useState)({top:-9999,left:-9999}),[c,d]=(0,Ln.useState)(!1),u=(0,Ln.useRef)({x:0,y:0}),p=(0,Ln.useRef)(null),m=(0,Ln.useRef)(null),f=(0,Ln.useRef)(null),g=(0,Ln.useRef)(null),v=(0,Ln.useCallback)(()=>{if(!g.current||!f.current)return;let x=g.current.getBoundingClientRect(),w=f.current.getBoundingClientRect(),S=window.innerWidth,k=window.innerHeight,T=8,P=0,D=0;switch(x.width<50&&x.height<50&&o==="auto"?"top":o){case"right":P=x.top+(x.height-w.height)/2,D=x.right+T,D+w.width>S-16&&(D=x.left-w.width-T);break;case"left":P=x.top+(x.height-w.height)/2,D=x.left-w.width-T,D<16&&(D=x.right+T);break;case"bottom":P=x.bottom+T,D=x.left+(x.width-w.width)/2;break;case"top":P=x.top-w.height-T,D=x.left+(x.width-w.width)/2,P<16&&(P=x.bottom+T);break;default:P=x.top-w.height-T,D=x.left+(x.width-w.width)/2,P<16&&(P=x.bottom+T)}let I=16;D<I&&(D=I),D+w.width>S-I&&(D=S-w.width-I),P<I&&(P=I),P+w.height>k-I&&(P=k-w.height-I),l({top:P,left:D})},[o]),h=(0,Ln.useCallback)(x=>{u.current={x:x.clientX,y:x.clientY},p.current&&cancelAnimationFrame(p.current),m.current=setTimeout(()=>{i(!0),d(!0)},n)},[n]),y=(0,Ln.useCallback)(()=>{m.current&&(clearTimeout(m.current),m.current=null),p.current&&(cancelAnimationFrame(p.current),p.current=null),i(!1),setTimeout(()=>d(!1),200)},[]);(0,Ln.useEffect)(()=>{a&&c&&(p.current=requestAnimationFrame(()=>{v()}))},[a,c,v]),(0,Ln.useEffect)(()=>()=>{m.current&&clearTimeout(m.current),p.current&&cancelAnimationFrame(p.current)},[]);let b=(0,Ln.useCallback)(x=>{a&&(Math.abs(x.clientX-u.current.x)>5||Math.abs(x.clientY-u.current.y)>5)&&(u.current={x:x.clientX,y:x.clientY},p.current&&cancelAnimationFrame(p.current),p.current=requestAnimationFrame(()=>{v()}))},[a,v]);return Ln.default.createElement(Ln.default.Fragment,null,Ln.default.createElement("div",{ref:g,onMouseEnter:h,onMouseLeave:y,onMouseMove:b,className:"tooltip-trigger"},t),c&&(0,o9.createPortal)(Ln.default.createElement("div",{ref:f,className:`journalit-tooltip ${r}`,style:{position:"fixed",top:`${s.top}px`,left:`${s.left}px`,zIndex:9999,opacity:a?1:0,transition:"opacity 150ms ease-in-out",pointerEvents:"none"}},e),document.body))});vm.displayName="Tooltip"});var Bu,zo,ym=L(()=>{Bu=q(Y());d0();zo=({message:e="Loading...",size:t="medium",fullscreen:r=!1,overlay:n=!1})=>{(0,Bu.useEffect)(()=>{Yf()},[]);let o=t==="small"?16:t==="large"?32:24,a=Bu.default.createElement("div",{className:`journalit-loading-spinner ${t}`,style:{"--spinner-size":`${o}px`}},Bu.default.createElement("div",{className:"journalit-spinner-icon"}),e&&Bu.default.createElement("span",{className:"loading-message"},e));return n?Bu.default.createElement("div",{className:"journalit-loading-overlay"},Bu.default.createElement("div",{className:"journalit-loading-overlay-content"},a)):r?Bu.default.createElement("div",{className:"journalit-loading-fullscreen"},a):a}});var J1,Bi,mg=L(()=>{J1=q(Y()),Bi=(0,J1.memo)(({width:e="100%",height:t="20px",borderRadius:r="4px",className:n="",style:o={}})=>{let a={width:typeof e=="number"?`${e}px`:e,height:typeof t=="number"?`${t}px`:t,borderRadius:typeof r=="number"?`${r}px`:r,...o};return J1.default.createElement("div",{className:`skeleton-shimmer ${n}`.trim(),style:a,"aria-hidden":"true"})});Bi.displayName="SkeletonBox"});var X1,fg,Q1=L(()=>{X1=q(Y());mg();fg=(0,X1.memo)(({size:e=24,className:t=""})=>X1.default.createElement(Bi,{width:e,height:e,borderRadius:"50%",className:t}));fg.displayName="SkeletonCircle"});var Jv,Kt,gg=L(()=>{Jv=q(Y());mg();Kt=(0,Jv.memo)(({width:e="100%",lines:t=1,gap:r=8,height:n="16px",className:o=""})=>t===1?Jv.default.createElement(Bi,{width:e,height:n,borderRadius:"8px",className:o}):Jv.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:`${r}px`,width:e}},Array.from({length:t}).map((a,i)=>Jv.default.createElement(Bi,{key:i,width:i===t-1?"60%":"100%",height:n,borderRadius:"8px",className:o}))));Kt.displayName="SkeletonText"});var hg,P2,a9=L(()=>{hg=q(Y());gg();P2=(0,hg.memo)(()=>hg.default.createElement("div",{className:"metric-card-skeleton","aria-hidden":"true",style:{flex:"1 1 180px",minWidth:"180px",maxWidth:"300px"}},hg.default.createElement("div",{style:{marginBottom:"6px"}},hg.default.createElement(Kt,{width:"80px",height:"14px"})),hg.default.createElement(Kt,{width:"120px",height:"24px"})));P2.displayName="MetricCardSkeleton"});var Ed=L(()=>{H1();eo();S2();T2();ZY();t9();n9();Kv();C2();ym();m0();h1();g0();mg();Q1();gg();a9()});function i9(){if(document.head.querySelector("#metric-card-skeleton-styles"))return;let e=document.createElement("style");e.id="metric-card-skeleton-styles",e.textContent=t0e,document.head.appendChild(e)}function s9(){var e;(e=document.head.querySelector("#metric-card-skeleton-styles"))==null||e.remove()}var t0e,l9=L(()=>{t0e=`
.metric-card-skeleton {
  background: transparent;
  padding: 14px;
  border-radius: 8px;
  border: 1px solid rgba(var(--background-modifier-border-rgb, 0, 0, 0), 0.08);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04), 0 0 1px rgba(0, 0, 0, 0.08);
  display: flex;
  flex-direction: column;
}

.metric-cards-skeleton {
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  width: 100%;
  gap: 8px;
  padding: 10px 0;
}

/* Responsive */
@media (max-width: 768px) {
  .metric-card-skeleton {
    padding: 12px;
  }

  .metric-cards-skeleton {
    gap: 6px;
  }
}
`});var Xr,r0e,n0e,D2,c9=L(()=>{Xr=q(Y());Ut();eg();pt();jv();sY();E0();U1();Wv();Ed();rr();l9();Kf();r0e=({transform:e})=>({...e,y:0}),n0e=({id:e,name:t,value:r,isPositive:n,isEditing:o,onRemove:a,dollarPart:i,centsPart:s,isCurrency:l})=>{let{attributes:c,listeners:d,setNodeRef:u,transform:p,transition:m}=Hv({id:e,disabled:!o}),f={transform:Nl.Transform.toString(p&&{...p,y:0}),transition:m,position:"relative",height:"100%",flex:"1 1 180px",minWidth:"180px",maxWidth:"300px"};return Xr.default.createElement("div",{ref:u,style:f},Xr.default.createElement("div",{className:"journalit-dashboard-metric-wrapper",style:{position:"relative",cursor:o?"grab":"default",height:"100%",display:"flex",flexDirection:"column"}},Xr.default.createElement("div",{...c,...o?d:{},style:{flex:1,height:"100%"}},Xr.default.createElement(iY,{name:t,value:r,isPositive:n,dollarPart:i,centsPart:s,isCurrency:l})),o&&Xr.default.createElement("button",{className:"journalit-dashboard-widget-remove",onClick:g=>{g.stopPropagation(),g.preventDefault(),a(e)},"aria-label":"Remove metric",style:{zIndex:1e5,position:"absolute",top:"4px",right:"4px",width:"22px",height:"22px",backgroundColor:"var(--background-modifier-error)",color:"white",border:"none",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",cursor:"pointer",padding:0}},"\u2715")))},D2=({filters:e,isEditing:t,onShowMetricSelector:r,hideAddButton:n=!1})=>{let o=xe(),{currency:a}=Ke(),{dashboardData:i,isLoading:s,isStale:l,error:c}=gm(),[d,u]=(0,Xr.useState)([]),[p,m]=(0,Xr.useState)(null);(0,Xr.useLayoutEffect)(()=>(Ll(),i9(),()=>{s9()}),[]),(0,Xr.useEffect)(()=>{m(c?c.message||"Failed to load metrics":null)},[c]),(0,Xr.useEffect)(()=>{(()=>{try{if(o){let T=xa(o);u(T.topSection)}}catch(T){console.error("Error initializing metrics:",T),u(["netPnL","winRate","profitFactor","expectancy"])}})();let k=T=>{u([...T.detail.activeMetrics])};return document.addEventListener("journalit:metrics-changed",k),()=>{document.removeEventListener("journalit:metrics-changed",k)}},[o]);let f=S=>{let{active:k,over:T}=S;if(T&&k.id!==T.id){let P=d.indexOf(k.id.toString()),D=d.indexOf(T.id.toString());if(P!==-1&&D!==-1){let O=[...d];if(O.splice(P,1),O.splice(D,0,k.id.toString()),u(O),o)try{let I={...xa(o),topSection:O};Ha(o,"Default",I)}catch(z){console.error("Error saving layout:",z)}}}},g=async S=>{if(o)try{let k=d.filter(O=>O!==S);u([...k]);let P={...xa(o),topSection:[...k]};try{await Ha(o,"Default",P)}catch(O){console.error("Error saving layout:",O)}document.querySelectorAll(".journalit-dashboard-widget-remove").forEach(O=>{O.classList.add("jl-force-redraw"),setTimeout(()=>{O.classList.remove("jl-force-redraw")},10)});let D=new CustomEvent("journalit:metrics-changed",{detail:{activeMetrics:k}});document.dispatchEvent(D)}catch(k){console.error("Error removing metric:",k)}},v=(S,k,T)=>{if(k==null||isNaN(k))return"N/A";if(T===!0&&i)switch(S){case"netPnL":return i.metrics.netPnLR!==void 0?`${i.metrics.netPnLR>=0?"+":""}${i.metrics.netPnLR.toFixed(1)}R`:"N/A";case"expectancy":return i.metrics.expectancyR!==void 0?`${i.metrics.expectancyR>=0?"+":""}${i.metrics.expectancyR.toFixed(2)}R`:"N/A";case"avgWin":return i.metrics.avgWinR!==void 0?`+${i.metrics.avgWinR.toFixed(2)}R`:"N/A";case"avgLoss":return i.metrics.avgLossR!==void 0?`-${i.metrics.avgLossR.toFixed(2)}R`:"N/A";case"largestWin":return i.metrics.largestWinR!==void 0?`+${i.metrics.largestWinR.toFixed(2)}R`:"N/A";case"largestLoss":return i.metrics.largestLossR!==void 0?`${i.metrics.largestLossR.toFixed(2)}R`:"N/A";case"maxDrawdown":return i.metrics.maxDrawdownR!==void 0?`${Math.abs(i.metrics.maxDrawdownR).toFixed(2)}R`:"N/A";case"bestDay":return i.metrics.bestDayR!==void 0?`${i.metrics.bestDayR>=0?"+":""}${i.metrics.bestDayR.toFixed(2)}R`:"N/A";case"winRate":return`${(k*100).toFixed(1)}%`;case"profitFactor":return k===1/0||k>999?"999+":k.toFixed(2);case"numTrades":case"numWinTrades":case"numLossTrades":return k.toString();case"avgHoldTime":case"avgWinHoldTime":case"avgLossHoldTime":if(k===0)return"-";let P=Math.floor(k/(1e3*60*60)),D=Math.floor(k%(1e3*60*60)/(1e3*60));return P>0?`${P}h ${D}m`:`${D}m`;default:return k.toString()}switch(S){case"netPnL":return ve(k,!0,a);case"winRate":return`${(k*100).toFixed(1)}%`;case"profitFactor":return k===1/0||k>999?"999+":k.toFixed(2);case"expectancy":return ve(k,!0,a);case"numTrades":case"numWinTrades":case"numLossTrades":return k.toString();case"avgWin":return ve(k,!0,a);case"avgLoss":return ve(k,!0,a);case"largestWin":return ve(k,!0,a);case"largestLoss":return ve(Math.abs(k),!0,a);case"maxDrawdown":return ve(Math.abs(k),!0,a);case"bestDay":return ve(k,!0,a);case"avgHoldTime":case"avgWinHoldTime":case"avgLossHoldTime":if(k===0)return"-";let P=Math.floor(k/(1e3*60*60)),D=Math.floor(k%(1e3*60*60)/(1e3*60));return P>0?`${P}h ${D}m`:`${D}m`;default:return k.toString()}},h=S=>{switch(S){case"netPnL":return"Net P&L";case"winRate":return"Win Rate";case"profitFactor":return"Profit Factor";case"expectancy":return"Expectancy";case"numTrades":return"Total Trades";case"numWinTrades":return"Winning Trades";case"numLossTrades":return"Losing Trades";case"avgWin":return"Avg Win";case"avgLoss":return"Avg Loss";case"maxDrawdown":return"Max Drawdown";case"bestDay":return"Best Day";case"largestWin":return"Largest Win";case"largestLoss":return"Largest Loss";case"avgHoldTime":return"Avg Hold Time";case"avgWinHoldTime":return"Avg Win Hold Time";case"avgLossHoldTime":return"Avg Loss Hold Time";default:return S}},y=(S,k)=>{switch(S){case"netPnL":case"profitFactor":case"expectancy":case"avgWin":return k>0;case"avgLoss":return k<0;case"winRate":return k>.5;case"maxDrawdown":return!1;case"largestLoss":return!1;case"bestDay":return k>0;case"largestWin":return k>0;case"avgHoldTime":case"avgWinHoldTime":return!0;case"avgLossHoldTime":return!1;default:return!0}},b=S=>["netPnL","expectancy","avgWin","avgLoss","maxDrawdown","bestDay","largestWin","largestLoss"].includes(S),x=(S,k,T)=>{if(b(S)&&!T.includes("R")&&!(T.includes("K")||T.includes("M")))return T.includes(".")?T.split(".")[0]:T},w=(S,k,T)=>{if(b(S)&&!T.includes("R")&&!(T.includes("K")||T.includes("M")))return T.includes(".")?"."+T.split(".")[1]:".00"};return Xr.default.createElement("div",{className:"journalit-dashboard-top-section",style:{padding:"0",backgroundColor:"transparent"}},t&&!n&&r&&Xr.default.createElement("div",{className:"journalit-dashboard-top-section-header",style:{display:"flex",justifyContent:"flex-end",alignItems:"center",padding:"0 10px"}},Xr.default.createElement("button",{className:"journalit-dashboard-add-metric-button",onClick:r,style:{backgroundColor:"var(--interactive-accent)",color:"var(--text-on-accent)",border:"none",borderRadius:"4px",padding:"4px 8px",fontSize:"12px",cursor:"pointer"}},"Add Metric")),s&&!i?Xr.default.createElement("div",{className:"metric-cards-skeleton"},Array.from({length:4}).map((S,k)=>Xr.default.createElement(P2,{key:k}))):p?Xr.default.createElement("div",{className:"journalit-dashboard-error"},p):i?Xr.default.createElement("div",{style:{position:"relative"}},Xr.default.createElement(Uv,{collisionDetection:Rv,onDragEnd:f,autoScroll:!0,modifiers:[r0e]},Xr.default.createElement(Vv,{items:d,strategy:R1},Xr.default.createElement("div",{className:"journalit-dashboard-metrics",id:"topsection-metrics-container",style:{display:"flex",flexDirection:"row",flexWrap:"wrap",width:"100%",overflowX:"hidden",gap:"8px",padding:"10px 0",position:"relative",backgroundColor:"transparent",borderRadius:"0",minHeight:"auto"}},d.map(S=>{var P,D;let k=i.metrics[S],T=v(S,k,(D=(P=o==null?void 0:o.settings)==null?void 0:P.trade)==null?void 0:D.displayRMultiples);return Xr.default.createElement(n0e,{key:S,id:S,name:h(S),value:T,isPositive:y(S,k),isEditing:t,onRemove:g,dollarPart:x(S,k,T),centsPart:w(S,k,T),isCurrency:b(S)})}),t&&d.length===0&&Xr.default.createElement("div",{className:"journalit-dashboard-no-metrics"},'Click "Add Metric" to add metrics')))),(l||s)&&Xr.default.createElement(zo,{message:"Loading...",size:"small",overlay:!0})):Xr.default.createElement("div",{className:"journalit-dashboard-no-data"},"No data available"))}});var d9=L(()=>{c9();T1()});var eP=Ie((Z1,u9)=>{(function(e,t){typeof Z1=="object"&&typeof u9!="undefined"?t(Z1):typeof define=="function"&&define.amd?define(["exports"],t):(e=typeof globalThis!="undefined"?globalThis:e||self,t(e["fast-equals"]={}))})(Z1,(function(e){"use strict";function t(R){return function(Z,K,X,G,U,Q,J){return R(Z,K,J)}}function r(R){return function(Z,K,X,G){if(!Z||!K||typeof Z!="object"||typeof K!="object")return R(Z,K,X,G);var U=G.get(Z),Q=G.get(K);if(U&&Q)return U===K&&Q===Z;G.set(Z,K),G.set(K,Z);var J=R(Z,K,X,G);return G.delete(Z),G.delete(K),J}}function n(R,V){var Z={};for(var K in R)Z[K]=R[K];for(var K in V)Z[K]=V[K];return Z}function o(R){return R.constructor===Object||R.constructor==null}function a(R){return typeof R.then=="function"}function i(R,V){return R===V||R!==R&&V!==V}var s="[object Arguments]",l="[object Boolean]",c="[object Date]",d="[object RegExp]",u="[object Map]",p="[object Number]",m="[object Object]",f="[object Set]",g="[object String]",v=Object.prototype.toString;function h(R){var V=R.areArraysEqual,Z=R.areDatesEqual,K=R.areMapsEqual,X=R.areObjectsEqual,G=R.areRegExpsEqual,U=R.areSetsEqual,Q=R.createIsNestedEqual,J=Q(ee);function ee(te,ue,be){if(te===ue)return!0;if(!te||!ue||typeof te!="object"||typeof ue!="object")return te!==te&&ue!==ue;if(o(te)&&o(ue))return X(te,ue,J,be);var Le=Array.isArray(te),$e=Array.isArray(ue);if(Le||$e)return Le===$e&&V(te,ue,J,be);var oe=v.call(te);return oe!==v.call(ue)?!1:oe===c?Z(te,ue,J,be):oe===d?G(te,ue,J,be):oe===u?K(te,ue,J,be):oe===f?U(te,ue,J,be):oe===m||oe===s?a(te)||a(ue)?!1:X(te,ue,J,be):oe===l||oe===p||oe===g?i(te.valueOf(),ue.valueOf()):!1}return ee}function y(R,V,Z,K){var X=R.length;if(V.length!==X)return!1;for(;X-- >0;)if(!Z(R[X],V[X],X,X,R,V,K))return!1;return!0}var b=r(y);function x(R,V){return i(R.valueOf(),V.valueOf())}function w(R,V,Z,K){var X=R.size===V.size;if(!X)return!1;if(!R.size)return!0;var G={},U=0;return R.forEach(function(Q,J){if(X){var ee=!1,te=0;V.forEach(function(ue,be){!ee&&!G[te]&&(ee=Z(J,be,U,te,R,V,K)&&Z(Q,ue,J,be,R,V,K))&&(G[te]=!0),te++}),U++,X=ee}}),X}var S=r(w),k="_owner",T=Object.prototype.hasOwnProperty;function P(R,V,Z,K){var X=Object.keys(R),G=X.length;if(Object.keys(V).length!==G)return!1;for(var U;G-- >0;){if(U=X[G],U===k){var Q=!!R.$$typeof,J=!!V.$$typeof;if((Q||J)&&Q!==J)return!1}if(!T.call(V,U)||!Z(R[U],V[U],U,U,R,V,K))return!1}return!0}var D=r(P);function O(R,V){return R.source===V.source&&R.flags===V.flags}function z(R,V,Z,K){var X=R.size===V.size;if(!X)return!1;if(!R.size)return!0;var G={};return R.forEach(function(U,Q){if(X){var J=!1,ee=0;V.forEach(function(te,ue){!J&&!G[ee]&&(J=Z(U,te,Q,ue,R,V,K))&&(G[ee]=!0),ee++}),X=J}}),X}var I=r(z),A=Object.freeze({areArraysEqual:y,areDatesEqual:x,areMapsEqual:w,areObjectsEqual:P,areRegExpsEqual:O,areSetsEqual:z,createIsNestedEqual:t}),j=Object.freeze({areArraysEqual:b,areDatesEqual:x,areMapsEqual:S,areObjectsEqual:D,areRegExpsEqual:O,areSetsEqual:I,createIsNestedEqual:t}),E=h(A);function N(R,V){return E(R,V,void 0)}var B=h(n(A,{createIsNestedEqual:function(){return i}}));function C(R,V){return B(R,V,void 0)}var F=h(j);function M(R,V){return F(R,V,new WeakMap)}var _=h(n(j,{createIsNestedEqual:function(){return i}}));function W(R,V){return _(R,V,new WeakMap)}function $(R){return h(n(A,R(A)))}function H(R){var V=h(n(j,R(j)));return(function(Z,K,X){return X===void 0&&(X=new WeakMap),V(Z,K,X)})}e.circularDeepEqual=M,e.circularShallowEqual=W,e.createCustomCircularEqual=H,e.createCustomEqual=$,e.deepEqual=N,e.sameValueZeroEqual=i,e.shallowEqual=C,Object.defineProperty(e,"__esModule",{value:!0})}))});var tP=Ie((Y9e,E2)=>{function m9(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(r=m9(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function p9(){for(var e,t,r=0,n="",o=arguments.length;r<o;r++)(e=arguments[r])&&(t=m9(e))&&(n&&(n+=" "),n+=t);return n}E2.exports=p9,E2.exports.clsx=p9});var g9=Ie((K9e,f9)=>{f9.exports=function(t,r,n){return t===r?!0:t.className===r.className&&n(t.style,r.style)&&t.width===r.width&&t.autoSize===r.autoSize&&t.cols===r.cols&&t.draggableCancel===r.draggableCancel&&t.draggableHandle===r.draggableHandle&&n(t.verticalCompact,r.verticalCompact)&&n(t.compactType,r.compactType)&&n(t.layout,r.layout)&&n(t.margin,r.margin)&&n(t.containerPadding,r.containerPadding)&&t.rowHeight===r.rowHeight&&t.maxRows===r.maxRows&&t.isBounded===r.isBounded&&t.isDraggable===r.isDraggable&&t.isResizable===r.isResizable&&t.allowOverlap===r.allowOverlap&&t.preventCollision===r.preventCollision&&t.useCSSTransforms===r.useCSSTransforms&&t.transformScale===r.transformScale&&t.isDroppable===r.isDroppable&&n(t.resizeHandles,r.resizeHandles)&&n(t.resizeHandle,r.resizeHandle)&&t.onLayoutChange===r.onLayoutChange&&t.onDragStart===r.onDragStart&&t.onDrag===r.onDrag&&t.onDragStop===r.onDragStop&&t.onResizeStart===r.onResizeStart&&t.onResize===r.onResize&&t.onResizeStop===r.onResizeStop&&t.onDrop===r.onDrop&&n(t.droppingItem,r.droppingItem)&&n(t.innerRef,r.innerRef)}});var bg=Ie(kr=>{"use strict";Object.defineProperty(kr,"__esModule",{value:!0});kr.bottom=L2;kr.childrenEqual=l0e;kr.cloneLayout=v9;kr.cloneLayoutItem=yg;kr.collides=nP;kr.compact=b9;kr.compactItem=x9;kr.compactType=w0e;kr.correctBounds=w9;kr.fastPositionEqual=c0e;kr.fastRGLPropsEqual=void 0;kr.getAllCollisions=k9;kr.getFirstCollision=vg;kr.getLayoutItem=N2;kr.getStatics=M2;kr.modifyLayout=y9;kr.moveElement=L0;kr.moveElementAwayFromCollision=A2;kr.noop=void 0;kr.perc=u0e;kr.resizeItemInDirection=v0e;kr.setTopLeft=b0e;kr.setTransform=y0e;kr.sortLayoutItems=B2;kr.sortLayoutItemsByColRow=D9;kr.sortLayoutItemsByRowCol=P9;kr.synchronizeLayoutWithChildren=x0e;kr.validateLayout=E9;kr.withLayoutItem=s0e;var h9=eP(),A0=o0e(Y());function o0e(e){return e&&e.__esModule?e:{default:e}}var a0e=!0,i0e=!1;function L2(e){let t=0,r;for(let n=0,o=e.length;n<o;n++)r=e[n].y+e[n].h,r>t&&(t=r);return t}function v9(e){let t=Array(e.length);for(let r=0,n=e.length;r<n;r++)t[r]=yg(e[r]);return t}function y9(e,t){let r=Array(e.length);for(let n=0,o=e.length;n<o;n++)t.i===e[n].i?r[n]=t:r[n]=e[n];return r}function s0e(e,t,r){let n=N2(e,t);return n?(n=r(yg(n)),e=y9(e,n),[e,n]):[e,null]}function yg(e){return{w:e.w,h:e.h,x:e.x,y:e.y,i:e.i,minW:e.minW,maxW:e.maxW,minH:e.minH,maxH:e.maxH,moved:!!e.moved,static:!!e.static,isDraggable:e.isDraggable,isResizable:e.isResizable,resizeHandles:e.resizeHandles,isBounded:e.isBounded}}function l0e(e,t){return(0,h9.deepEqual)(A0.default.Children.map(e,r=>r==null?void 0:r.key),A0.default.Children.map(t,r=>r==null?void 0:r.key))&&(0,h9.deepEqual)(A0.default.Children.map(e,r=>r==null?void 0:r.props["data-grid"]),A0.default.Children.map(t,r=>r==null?void 0:r.props["data-grid"]))}var J9e=kr.fastRGLPropsEqual=g9();function c0e(e,t){return e.left===t.left&&e.top===t.top&&e.width===t.width&&e.height===t.height}function nP(e,t){return!(e.i===t.i||e.x+e.w<=t.x||e.x>=t.x+t.w||e.y+e.h<=t.y||e.y>=t.y+t.h)}function b9(e,t,r,n){let o=M2(e),a=B2(e,t),i=Array(e.length);for(let s=0,l=a.length;s<l;s++){let c=yg(a[s]);c.static||(c=x9(o,c,t,r,a,n),o.push(c)),i[e.indexOf(a[s])]=c,c.moved=!1}return i}var d0e={x:"w",y:"h"};function I2(e,t,r,n){let o=d0e[n];t[n]+=1;let a=e.map(i=>i.i).indexOf(t.i);for(let i=a+1;i<e.length;i++){let s=e[i];if(!s.static){if(s.y>t.y+t.h)break;nP(t,s)&&I2(e,s,r+t[o],n)}}t[n]=r}function x9(e,t,r,n,o,a){let i=r==="vertical",s=r==="horizontal";if(i)for(t.y=Math.min(L2(e),t.y);t.y>0&&!vg(e,t);)t.y--;else if(s)for(;t.x>0&&!vg(e,t);)t.x--;let l;for(;(l=vg(e,t))&&!(r===null&&a);)if(s?I2(o,t,l.x+l.w,"x"):I2(o,t,l.y+l.h,"y"),s&&t.x+t.w>n)for(t.x=n-t.w,t.y++;t.x>0&&!vg(e,t);)t.x--;return t.y=Math.max(t.y,0),t.x=Math.max(t.x,0),t}function w9(e,t){let r=M2(e);for(let n=0,o=e.length;n<o;n++){let a=e[n];if(a.x+a.w>t.cols&&(a.x=t.cols-a.w),a.x<0&&(a.x=0,a.w=t.cols),!a.static)r.push(a);else for(;vg(r,a);)a.y++}return e}function N2(e,t){for(let r=0,n=e.length;r<n;r++)if(e[r].i===t)return e[r]}function vg(e,t){for(let r=0,n=e.length;r<n;r++)if(nP(e[r],t))return e[r]}function k9(e,t){return e.filter(r=>nP(r,t))}function M2(e){return e.filter(t=>t.static)}function L0(e,t,r,n,o,a,i,s,l){if(t.static&&t.isDraggable!==!0||t.y===n&&t.x===r)return e;rP(`Moving element ${t.i} to [${String(r)},${String(n)}] from [${t.x},${t.y}]`);let c=t.x,d=t.y;typeof r=="number"&&(t.x=r),typeof n=="number"&&(t.y=n),t.moved=!0;let u=B2(e,i);(i==="vertical"&&typeof n=="number"?d>=n:i==="horizontal"&&typeof r=="number"?c>=r:!1)&&(u=u.reverse());let m=k9(u,t),f=m.length>0;if(f&&l)return v9(e);if(f&&a)return rP(`Collision prevented on ${t.i}, reverting.`),t.x=c,t.y=d,t.moved=!1,e;for(let g=0,v=m.length;g<v;g++){let h=m[g];rP(`Resolving collision between ${t.i} at [${t.x},${t.y}] and ${h.i} at [${h.x},${h.y}]`),!h.moved&&(h.static?e=A2(e,h,t,o,i,s):e=A2(e,t,h,o,i,s))}return e}function A2(e,t,r,n,o,a){let i=o==="horizontal",s=o==="vertical",l=t.static;if(n){n=!1;let u={x:i?Math.max(t.x-r.w,0):r.x,y:s?Math.max(t.y-r.h,0):r.y,w:r.w,h:r.h,i:"-1"},p=vg(e,u),m=p&&p.y+p.h>t.y,f=p&&t.x+t.w>p.x;if(p){if(m&&s)return L0(e,r,void 0,t.y+1,n,l,o,a);if(m&&o==null)return t.y=r.y,r.y=r.y+r.h,e;if(f&&i)return L0(e,t,r.x,void 0,n,l,o,a)}else return rP(`Doing reverse collision on ${r.i} up to [${u.x},${u.y}].`),L0(e,r,i?u.x:void 0,s?u.y:void 0,n,l,o,a)}let c=i?r.x+1:void 0,d=s?r.y+1:void 0;return c==null&&d==null?e:L0(e,r,i?r.x+1:void 0,s?r.y+1:void 0,n,l,o,a)}function u0e(e){return e*100+"%"}var S9=(e,t,r,n)=>e+r>n?t:r,T9=(e,t,r)=>e<0?t:r,C9=e=>Math.max(0,e),F2=e=>Math.max(0,e),O2=(e,t,r)=>{let{left:n,height:o,width:a}=t,i=e.top-(o-e.height);return{left:n,width:a,height:T9(i,e.height,o),top:F2(i)}},j2=(e,t,r)=>{let{top:n,left:o,height:a,width:i}=t;return{top:n,height:a,width:S9(e.left,e.width,i,r),left:C9(o)}},z2=(e,t,r)=>{let{top:n,height:o,width:a}=t,i=e.left-(a-e.width);return{height:o,width:i<0?e.width:S9(e.left,e.width,a,r),top:F2(n),left:C9(i)}},_2=(e,t,r)=>{let{top:n,left:o,height:a,width:i}=t;return{width:i,left:o,height:T9(n,e.height,a),top:F2(n)}},p0e=function(){return O2(arguments.length<=0?void 0:arguments[0],j2(...arguments),arguments.length<=2?void 0:arguments[2])},m0e=function(){return O2(arguments.length<=0?void 0:arguments[0],z2(...arguments),arguments.length<=2?void 0:arguments[2])},f0e=function(){return _2(arguments.length<=0?void 0:arguments[0],j2(...arguments),arguments.length<=2?void 0:arguments[2])},g0e=function(){return _2(arguments.length<=0?void 0:arguments[0],z2(...arguments),arguments.length<=2?void 0:arguments[2])},h0e={n:O2,ne:p0e,e:j2,se:f0e,s:_2,sw:g0e,w:z2,nw:m0e};function v0e(e,t,r,n){let o=h0e[e];return o?o(t,{...t,...r},n):r}function y0e(e){let{top:t,left:r,width:n,height:o}=e,a=`translate(${r}px,${t}px)`;return{transform:a,WebkitTransform:a,MozTransform:a,msTransform:a,OTransform:a,width:`${n}px`,height:`${o}px`,position:"absolute"}}function b0e(e){let{top:t,left:r,width:n,height:o}=e;return{top:`${t}px`,left:`${r}px`,width:`${n}px`,height:`${o}px`,position:"absolute"}}function B2(e,t){return t==="horizontal"?D9(e):t==="vertical"?P9(e):e}function P9(e){return e.slice(0).sort(function(t,r){return t.y>r.y||t.y===r.y&&t.x>r.x?1:t.y===r.y&&t.x===r.x?0:-1})}function D9(e){return e.slice(0).sort(function(t,r){return t.x>r.x||t.x===r.x&&t.y>r.y?1:-1})}function x0e(e,t,r,n,o){e=e||[];let a=[];A0.default.Children.forEach(t,s=>{if((s==null?void 0:s.key)==null)return;let l=N2(e,String(s.key)),c=s.props["data-grid"];l&&c==null?a.push(yg(l)):c?(a0e||E9([c],"ReactGridLayout.children"),a.push(yg({...c,i:s.key}))):a.push(yg({w:1,h:1,x:0,y:L2(a),i:String(s.key)}))});let i=w9(a,{cols:r});return o?i:b9(i,n,r)}function E9(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Layout",r=["x","y","w","h"];if(!Array.isArray(e))throw new Error(t+" must be an array!");for(let n=0,o=e.length;n<o;n++){let a=e[n];for(let i=0;i<r.length;i++){let s=r[i],l=a[s];if(typeof l!="number"||Number.isNaN(l))throw new Error(`ReactGridLayout: ${t}[${n}].${s} must be a number! Received: ${l} (${typeof l})`)}if(typeof a.i!="undefined"&&typeof a.i!="string")throw new Error(`ReactGridLayout: ${t}[${n}].i must be a string! Received: ${a.i} (${typeof a.i})`)}}function w0e(e){let{verticalCompact:t,compactType:r}=e||{};return t===!1?null:r}function rP(){i0e&&console.log(...arguments)}var k0e=()=>{};kr.noop=k0e});var aP=Ie(bm=>{"use strict";Object.defineProperty(bm,"__esModule",{value:!0});bm.calcGridColWidth=oP;bm.calcGridItemPosition=S0e;bm.calcGridItemWHPx=$2;bm.calcWH=C0e;bm.calcXY=T0e;bm.clamp=xg;function oP(e){let{margin:t,containerPadding:r,containerWidth:n,cols:o}=e;return(n-t[0]*(o-1)-r[0]*2)/o}function $2(e,t,r){return Number.isFinite(e)?Math.round(t*e+Math.max(0,e-1)*r):e}function S0e(e,t,r,n,o,a){let{margin:i,containerPadding:s,rowHeight:l}=e,c=oP(e),d={};return a&&a.resizing?(d.width=Math.round(a.resizing.width),d.height=Math.round(a.resizing.height)):(d.width=$2(n,c,i[0]),d.height=$2(o,l,i[1])),a&&a.dragging?(d.top=Math.round(a.dragging.top),d.left=Math.round(a.dragging.left)):a&&a.resizing&&typeof a.resizing.top=="number"&&typeof a.resizing.left=="number"?(d.top=Math.round(a.resizing.top),d.left=Math.round(a.resizing.left)):(d.top=Math.round((l+i[1])*r+s[1]),d.left=Math.round((c+i[0])*t+s[0])),d}function T0e(e,t,r,n,o){let{margin:a,containerPadding:i,cols:s,rowHeight:l,maxRows:c}=e,d=oP(e),u=Math.round((r-i[0])/(d+a[0])),p=Math.round((t-i[1])/(l+a[1]));return u=xg(u,0,s-n),p=xg(p,0,c-o),{x:u,y:p}}function C0e(e,t,r,n,o,a){let{margin:i,maxRows:s,cols:l,rowHeight:c}=e,d=oP(e),u=Math.round((t+i[0])/(d+i[0])),p=Math.round((r+i[1])/(c+i[1])),m=xg(u,0,l-n),f=xg(p,0,s-o);return["sw","w","nw"].indexOf(a)!==-1&&(m=xg(u,0,l)),["nw","n","ne"].indexOf(a)!==-1&&(f=xg(p,0,s)),{w:m,h:f}}function xg(e,t,r){return Math.max(Math.min(e,r),t)}});var A9=Ie((Z9e,I9)=>{"use strict";var P0e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";I9.exports=P0e});var F9=Ie((eKe,M9)=>{"use strict";var D0e=A9();function L9(){}function N9(){}N9.resetWarningCache=L9;M9.exports=function(){function e(n,o,a,i,s,l){if(l!==D0e){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:N9,resetWarningCache:L9};return r.PropTypes=r,r}});var $u=Ie((nKe,O9)=>{O9.exports=F9()();var tKe,rKe});var _9=Ie((oKe,W2)=>{function z9(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(r=z9(e[t]))&&(n&&(n+=" "),n+=r);else for(t in e)e[t]&&(n&&(n+=" "),n+=t);return n}function j9(){for(var e,t,r=0,n="";r<arguments.length;)(e=arguments[r++])&&(t=z9(e))&&(n&&(n+=" "),n+=t);return n}W2.exports=j9,W2.exports.clsx=j9});var N0=Ie(wg=>{"use strict";Object.defineProperty(wg,"__esModule",{value:!0});wg.dontSetMe=N0e;wg.findInArray=E0e;wg.int=L0e;wg.isFunction=I0e;wg.isNum=A0e;function E0e(e,t){for(let r=0,n=e.length;r<n;r++)if(t.apply(t,[e[r],r,e]))return e[r]}function I0e(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Function]"}function A0e(e){return typeof e=="number"&&!isNaN(e)}function L0e(e){return parseInt(e,10)}function N0e(e,t,r){if(e[t])return new Error("Invalid prop ".concat(t," passed to ").concat(r," - do not set this, set it on the child."))}});var W9=Ie(kg=>{"use strict";Object.defineProperty(kg,"__esModule",{value:!0});kg.browserPrefixToKey=$9;kg.browserPrefixToStyle=M0e;kg.default=void 0;kg.getPrefix=B9;var R2=["Moz","Webkit","O","ms"];function B9(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window=="undefined")return"";let r=(e=window.document)===null||e===void 0||(e=e.documentElement)===null||e===void 0?void 0:e.style;if(!r||t in r)return"";for(let n=0;n<R2.length;n++)if($9(t,R2[n])in r)return R2[n];return""}function $9(e,t){return t?"".concat(t).concat(F0e(e)):e}function M0e(e,t){return t?"-".concat(t.toLowerCase(),"-").concat(e):e}function F0e(e){let t="",r=!0;for(let n=0;n<e.length;n++)r?(t+=e[n].toUpperCase(),r=!1):e[n]==="-"?r=!0:t+=e[n];return t}var iKe=kg.default=B9()});var sP=Ie(_o=>{"use strict";Object.defineProperty(_o,"__esModule",{value:!0});_o.addClassName=H9;_o.addEvent=z0e;_o.addUserSelectStyles=Y0e;_o.createCSSTransform=V0e;_o.createSVGTransform=H0e;_o.getTouch=q0e;_o.getTouchIdentifier=G0e;_o.getTranslation=U2;_o.innerHeight=W0e;_o.innerWidth=R0e;_o.matchesSelector=V9;_o.matchesSelectorAndParentsTo=j0e;_o.offsetXYFromParent=U0e;_o.outerHeight=B0e;_o.outerWidth=$0e;_o.removeClassName=q9;_o.removeEvent=_0e;_o.removeUserSelectStyles=K0e;var Gs=N0(),R9=O0e(W9());function U9(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(U9=function(n){return n?r:t})(e)}function O0e(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var r=U9(t);if(r&&r.has(e))return r.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(a!=="default"&&Object.prototype.hasOwnProperty.call(e,a)){var i=o?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}var iP="";function V9(e,t){return iP||(iP=(0,Gs.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(r){return(0,Gs.isFunction)(e[r])})),(0,Gs.isFunction)(e[iP])?e[iP](t):!1}function j0e(e,t,r){let n=e;do{if(V9(n,t))return!0;if(n===r)return!1;n=n.parentNode}while(n);return!1}function z0e(e,t,r,n){if(!e)return;let o={capture:!0,...n};e.addEventListener?e.addEventListener(t,r,o):e.attachEvent?e.attachEvent("on"+t,r):e["on"+t]=r}function _0e(e,t,r,n){if(!e)return;let o={capture:!0,...n};e.removeEventListener?e.removeEventListener(t,r,o):e.detachEvent?e.detachEvent("on"+t,r):e["on"+t]=null}function B0e(e){let t=e.clientHeight,r=e.ownerDocument.defaultView.getComputedStyle(e);return t+=(0,Gs.int)(r.borderTopWidth),t+=(0,Gs.int)(r.borderBottomWidth),t}function $0e(e){let t=e.clientWidth,r=e.ownerDocument.defaultView.getComputedStyle(e);return t+=(0,Gs.int)(r.borderLeftWidth),t+=(0,Gs.int)(r.borderRightWidth),t}function W0e(e){let t=e.clientHeight,r=e.ownerDocument.defaultView.getComputedStyle(e);return t-=(0,Gs.int)(r.paddingTop),t-=(0,Gs.int)(r.paddingBottom),t}function R0e(e){let t=e.clientWidth,r=e.ownerDocument.defaultView.getComputedStyle(e);return t-=(0,Gs.int)(r.paddingLeft),t-=(0,Gs.int)(r.paddingRight),t}function U0e(e,t,r){let o=t===t.ownerDocument.body?{left:0,top:0}:t.getBoundingClientRect(),a=(e.clientX+t.scrollLeft-o.left)/r,i=(e.clientY+t.scrollTop-o.top)/r;return{x:a,y:i}}function V0e(e,t){let r=U2(e,t,"px");return{[(0,R9.browserPrefixToKey)("transform",R9.default)]:r}}function H0e(e,t){return U2(e,t,"")}function U2(e,t,r){let{x:n,y:o}=e,a="translate(".concat(n).concat(r,",").concat(o).concat(r,")");if(t){let i="".concat(typeof t.x=="string"?t.x:t.x+r),s="".concat(typeof t.y=="string"?t.y:t.y+r);a="translate(".concat(i,", ").concat(s,")")+a}return a}function q0e(e,t){return e.targetTouches&&(0,Gs.findInArray)(e.targetTouches,r=>t===r.identifier)||e.changedTouches&&(0,Gs.findInArray)(e.changedTouches,r=>t===r.identifier)}function G0e(e){if(e.targetTouches&&e.targetTouches[0])return e.targetTouches[0].identifier;if(e.changedTouches&&e.changedTouches[0])return e.changedTouches[0].identifier}function Y0e(e){if(!e)return;let t=e.getElementById("react-draggable-style-el");t||(t=e.createElement("style"),t.type="text/css",t.id="react-draggable-style-el",t.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,t.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,e.getElementsByTagName("head")[0].appendChild(t)),e.body&&H9(e.body,"react-draggable-transparent-selection")}function K0e(e){if(e)try{if(e.body&&q9(e.body,"react-draggable-transparent-selection"),e.selection)e.selection.empty();else{let t=(e.defaultView||window).getSelection();t&&t.type!=="Caret"&&t.removeAllRanges()}}catch(t){}}function H9(e,t){e.classList?e.classList.add(t):e.className.match(new RegExp("(?:^|\\s)".concat(t,"(?!\\S)")))||(e.className+=" ".concat(t))}function q9(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(?:^|\\s)".concat(t,"(?!\\S)"),"g"),"")}});var H2=Ie(Wu=>{"use strict";Object.defineProperty(Wu,"__esModule",{value:!0});Wu.canDragX=Q0e;Wu.canDragY=Z0e;Wu.createCoreData=tke;Wu.createDraggableData=rke;Wu.getBoundPosition=J0e;Wu.getControlPosition=eke;Wu.snapToGrid=X0e;var Ys=N0(),Xv=sP();function J0e(e,t,r){if(!e.props.bounds)return[t,r];let{bounds:n}=e.props;n=typeof n=="string"?n:nke(n);let o=V2(e);if(typeof n=="string"){let{ownerDocument:a}=o,i=a.defaultView,s;if(n==="parent"?s=o.parentNode:s=a.querySelector(n),!(s instanceof i.HTMLElement))throw new Error('Bounds selector "'+n+'" could not find an element.');let l=s,c=i.getComputedStyle(o),d=i.getComputedStyle(l);n={left:-o.offsetLeft+(0,Ys.int)(d.paddingLeft)+(0,Ys.int)(c.marginLeft),top:-o.offsetTop+(0,Ys.int)(d.paddingTop)+(0,Ys.int)(c.marginTop),right:(0,Xv.innerWidth)(l)-(0,Xv.outerWidth)(o)-o.offsetLeft+(0,Ys.int)(d.paddingRight)-(0,Ys.int)(c.marginRight),bottom:(0,Xv.innerHeight)(l)-(0,Xv.outerHeight)(o)-o.offsetTop+(0,Ys.int)(d.paddingBottom)-(0,Ys.int)(c.marginBottom)}}return(0,Ys.isNum)(n.right)&&(t=Math.min(t,n.right)),(0,Ys.isNum)(n.bottom)&&(r=Math.min(r,n.bottom)),(0,Ys.isNum)(n.left)&&(t=Math.max(t,n.left)),(0,Ys.isNum)(n.top)&&(r=Math.max(r,n.top)),[t,r]}function X0e(e,t,r){let n=Math.round(t/e[0])*e[0],o=Math.round(r/e[1])*e[1];return[n,o]}function Q0e(e){return e.props.axis==="both"||e.props.axis==="x"}function Z0e(e){return e.props.axis==="both"||e.props.axis==="y"}function eke(e,t,r){let n=typeof t=="number"?(0,Xv.getTouch)(e,t):null;if(typeof t=="number"&&!n)return null;let o=V2(r),a=r.props.offsetParent||o.offsetParent||o.ownerDocument.body;return(0,Xv.offsetXYFromParent)(n||e,a,r.props.scale)}function tke(e,t,r){let n=!(0,Ys.isNum)(e.lastX),o=V2(e);return n?{node:o,deltaX:0,deltaY:0,lastX:t,lastY:r,x:t,y:r}:{node:o,deltaX:t-e.lastX,deltaY:r-e.lastY,lastX:e.lastX,lastY:e.lastY,x:t,y:r}}function rke(e,t){let r=e.props.scale;return{node:t.node,x:e.state.x+t.deltaX/r,y:e.state.y+t.deltaY/r,deltaX:t.deltaX/r,deltaY:t.deltaY/r,lastX:e.state.x,lastY:e.state.y}}function nke(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}}function V2(e){let t=e.findDOMNode();if(!t)throw new Error("<DraggableCore>: Unmounted during event!");return t}});var G2=Ie(q2=>{"use strict";Object.defineProperty(q2,"__esModule",{value:!0});q2.default=oke;function oke(){}});var Y9=Ie(lP=>{"use strict";Object.defineProperty(lP,"__esModule",{value:!0});lP.default=void 0;var Y2=ike(Y()),ms=J2($u()),ake=J2(vc()),pi=sP(),xm=H2(),K2=N0(),M0=J2(G2());function J2(e){return e&&e.__esModule?e:{default:e}}function G9(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(G9=function(n){return n?r:t})(e)}function ike(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var r=G9(t);if(r&&r.has(e))return r.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(a!=="default"&&Object.prototype.hasOwnProperty.call(e,a)){var i=o?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}function $i(e,t,r){return t=ske(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ske(e){var t=lke(e,"string");return typeof t=="symbol"?t:String(t)}function lke(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ic={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}},wm=Ic.mouse,Qv=class extends Y2.Component{constructor(){super(...arguments),$i(this,"dragging",!1),$i(this,"lastX",NaN),$i(this,"lastY",NaN),$i(this,"touchIdentifier",null),$i(this,"mounted",!1),$i(this,"handleDragStart",t=>{if(this.props.onMouseDown(t),!this.props.allowAnyClick&&typeof t.button=="number"&&t.button!==0)return!1;let r=this.findDOMNode();if(!r||!r.ownerDocument||!r.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");let{ownerDocument:n}=r;if(this.props.disabled||!(t.target instanceof n.defaultView.Node)||this.props.handle&&!(0,pi.matchesSelectorAndParentsTo)(t.target,this.props.handle,r)||this.props.cancel&&(0,pi.matchesSelectorAndParentsTo)(t.target,this.props.cancel,r))return;t.type==="touchstart"&&t.preventDefault();let o=(0,pi.getTouchIdentifier)(t);this.touchIdentifier=o;let a=(0,xm.getControlPosition)(t,o,this);if(a==null)return;let{x:i,y:s}=a,l=(0,xm.createCoreData)(this,i,s);(0,M0.default)("DraggableCore: handleDragStart: %j",l),(0,M0.default)("calling",this.props.onStart),!(this.props.onStart(t,l)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,pi.addUserSelectStyles)(n),this.dragging=!0,this.lastX=i,this.lastY=s,(0,pi.addEvent)(n,wm.move,this.handleDrag),(0,pi.addEvent)(n,wm.stop,this.handleDragStop))}),$i(this,"handleDrag",t=>{let r=(0,xm.getControlPosition)(t,this.touchIdentifier,this);if(r==null)return;let{x:n,y:o}=r;if(Array.isArray(this.props.grid)){let s=n-this.lastX,l=o-this.lastY;if([s,l]=(0,xm.snapToGrid)(this.props.grid,s,l),!s&&!l)return;n=this.lastX+s,o=this.lastY+l}let a=(0,xm.createCoreData)(this,n,o);if((0,M0.default)("DraggableCore: handleDrag: %j",a),this.props.onDrag(t,a)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch(s){let l=document.createEvent("MouseEvents");l.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(l)}return}this.lastX=n,this.lastY=o}),$i(this,"handleDragStop",t=>{if(!this.dragging)return;let r=(0,xm.getControlPosition)(t,this.touchIdentifier,this);if(r==null)return;let{x:n,y:o}=r;if(Array.isArray(this.props.grid)){let l=n-this.lastX||0,c=o-this.lastY||0;[l,c]=(0,xm.snapToGrid)(this.props.grid,l,c),n=this.lastX+l,o=this.lastY+c}let a=(0,xm.createCoreData)(this,n,o);if(this.props.onStop(t,a)===!1||this.mounted===!1)return!1;let s=this.findDOMNode();s&&this.props.enableUserSelectHack&&(0,pi.removeUserSelectStyles)(s.ownerDocument),(0,M0.default)("DraggableCore: handleDragStop: %j",a),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,s&&((0,M0.default)("DraggableCore: Removing handlers"),(0,pi.removeEvent)(s.ownerDocument,wm.move,this.handleDrag),(0,pi.removeEvent)(s.ownerDocument,wm.stop,this.handleDragStop))}),$i(this,"onMouseDown",t=>(wm=Ic.mouse,this.handleDragStart(t))),$i(this,"onMouseUp",t=>(wm=Ic.mouse,this.handleDragStop(t))),$i(this,"onTouchStart",t=>(wm=Ic.touch,this.handleDragStart(t))),$i(this,"onTouchEnd",t=>(wm=Ic.touch,this.handleDragStop(t)))}componentDidMount(){this.mounted=!0;let t=this.findDOMNode();t&&(0,pi.addEvent)(t,Ic.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;let t=this.findDOMNode();if(t){let{ownerDocument:r}=t;(0,pi.removeEvent)(r,Ic.mouse.move,this.handleDrag),(0,pi.removeEvent)(r,Ic.touch.move,this.handleDrag),(0,pi.removeEvent)(r,Ic.mouse.stop,this.handleDragStop),(0,pi.removeEvent)(r,Ic.touch.stop,this.handleDragStop),(0,pi.removeEvent)(t,Ic.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,pi.removeUserSelectStyles)(r)}}findDOMNode(){var t,r;return(t=this.props)!==null&&t!==void 0&&t.nodeRef?(r=this.props)===null||r===void 0||(r=r.nodeRef)===null||r===void 0?void 0:r.current:ake.default.findDOMNode(this)}render(){return Y2.cloneElement(Y2.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};lP.default=Qv;$i(Qv,"displayName","DraggableCore");$i(Qv,"propTypes",{allowAnyClick:ms.default.bool,children:ms.default.node.isRequired,disabled:ms.default.bool,enableUserSelectHack:ms.default.bool,offsetParent:function(e,t){if(e[t]&&e[t].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:ms.default.arrayOf(ms.default.number),handle:ms.default.string,cancel:ms.default.string,nodeRef:ms.default.object,onStart:ms.default.func,onDrag:ms.default.func,onStop:ms.default.func,onMouseDown:ms.default.func,scale:ms.default.number,className:K2.dontSetMe,style:K2.dontSetMe,transform:K2.dontSetMe});$i(Qv,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1})});var X9=Ie(O0=>{"use strict";Object.defineProperty(O0,"__esModule",{value:!0});Object.defineProperty(O0,"DraggableCore",{enumerable:!0,get:function(){return uP.default}});O0.default=void 0;var cP=uke(Y()),kn=F0($u()),cke=F0(vc()),dke=F0(_9()),K9=sP(),Zv=H2(),X2=N0(),uP=F0(Y9()),dP=F0(G2());function F0(e){return e&&e.__esModule?e:{default:e}}function J9(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(J9=function(n){return n?r:t})(e)}function uke(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var r=J9(t);if(r&&r.has(e))return r.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(a!=="default"&&Object.prototype.hasOwnProperty.call(e,a)){var i=o?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}function Q2(){return Q2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Q2.apply(this,arguments)}function ey(e,t,r){return t=pke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pke(e){var t=mke(e,"string");return typeof t=="symbol"?t:String(t)}function mke(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ty=class extends cP.Component{static getDerivedStateFromProps(t,r){let{position:n}=t,{prevPropsPosition:o}=r;return n&&(!o||n.x!==o.x||n.y!==o.y)?((0,dP.default)("Draggable: getDerivedStateFromProps %j",{position:n,prevPropsPosition:o}),{x:n.x,y:n.y,prevPropsPosition:{...n}}):null}constructor(t){super(t),ey(this,"onDragStart",(r,n)=>{if((0,dP.default)("Draggable: onDragStart: %j",n),this.props.onStart(r,(0,Zv.createDraggableData)(this,n))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),ey(this,"onDrag",(r,n)=>{if(!this.state.dragging)return!1;(0,dP.default)("Draggable: onDrag: %j",n);let o=(0,Zv.createDraggableData)(this,n),a={x:o.x,y:o.y,slackX:0,slackY:0};if(this.props.bounds){let{x:s,y:l}=a;a.x+=this.state.slackX,a.y+=this.state.slackY;let[c,d]=(0,Zv.getBoundPosition)(this,a.x,a.y);a.x=c,a.y=d,a.slackX=this.state.slackX+(s-a.x),a.slackY=this.state.slackY+(l-a.y),o.x=a.x,o.y=a.y,o.deltaX=a.x-this.state.x,o.deltaY=a.y-this.state.y}if(this.props.onDrag(r,o)===!1)return!1;this.setState(a)}),ey(this,"onDragStop",(r,n)=>{if(!this.state.dragging||this.props.onStop(r,(0,Zv.createDraggableData)(this,n))===!1)return!1;(0,dP.default)("Draggable: onDragStop: %j",n);let a={dragging:!1,slackX:0,slackY:0};if(!!this.props.position){let{x:s,y:l}=this.props.position;a.x=s,a.y=l}this.setState(a)}),this.state={dragging:!1,dragged:!1,x:t.position?t.position.x:t.defaultPosition.x,y:t.position?t.position.y:t.defaultPosition.y,prevPropsPosition:{...t.position},slackX:0,slackY:0,isElementSVG:!1},t.position&&!(t.onDrag||t.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){typeof window.SVGElement!="undefined"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.setState({dragging:!1})}findDOMNode(){var t,r;return(t=(r=this.props)===null||r===void 0||(r=r.nodeRef)===null||r===void 0?void 0:r.current)!==null&&t!==void 0?t:cke.default.findDOMNode(this)}render(){let{axis:t,bounds:r,children:n,defaultPosition:o,defaultClassName:a,defaultClassNameDragging:i,defaultClassNameDragged:s,position:l,positionOffset:c,scale:d,...u}=this.props,p={},m=null,g=!!!l||this.state.dragging,v=l||o,h={x:(0,Zv.canDragX)(this)&&g?this.state.x:v.x,y:(0,Zv.canDragY)(this)&&g?this.state.y:v.y};this.state.isElementSVG?m=(0,K9.createSVGTransform)(h,c):p=(0,K9.createCSSTransform)(h,c);let y=(0,dke.default)(n.props.className||"",a,{[i]:this.state.dragging,[s]:this.state.dragged});return cP.createElement(uP.default,Q2({},u,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),cP.cloneElement(cP.Children.only(n),{className:y,style:{...n.props.style,...p},transform:m}))}};O0.default=ty;ey(ty,"displayName","Draggable");ey(ty,"propTypes",{...uP.default.propTypes,axis:kn.default.oneOf(["both","x","y","none"]),bounds:kn.default.oneOfType([kn.default.shape({left:kn.default.number,right:kn.default.number,top:kn.default.number,bottom:kn.default.number}),kn.default.string,kn.default.oneOf([!1])]),defaultClassName:kn.default.string,defaultClassNameDragging:kn.default.string,defaultClassNameDragged:kn.default.string,defaultPosition:kn.default.shape({x:kn.default.number,y:kn.default.number}),positionOffset:kn.default.shape({x:kn.default.oneOfType([kn.default.number,kn.default.string]),y:kn.default.oneOfType([kn.default.number,kn.default.string])}),position:kn.default.shape({x:kn.default.number,y:kn.default.number}),className:X2.dontSetMe,style:X2.dontSetMe,transform:X2.dontSetMe});ey(ty,"defaultProps",{...uP.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})});var mP=Ie((mKe,pP)=>{"use strict";var{default:Q9,DraggableCore:fke}=X9();pP.exports=Q9;pP.exports.default=Q9;pP.exports.DraggableCore=fke});var tK=Ie(Z2=>{"use strict";Z2.__esModule=!0;Z2.cloneElement=xke;var gke=hke(Y());function hke(e){return e&&e.__esModule?e:{default:e}}function Z9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function eK(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Z9(Object(r),!0).forEach(function(n){vke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z9(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vke(e,t,r){return t=yke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yke(e){var t=bke(e,"string");return typeof t=="symbol"?t:String(t)}function bke(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xke(e,t){return t.style&&e.props.style&&(t.style=eK(eK({},e.props.style),t.style)),t.className&&e.props.className&&(t.className=e.props.className+" "+t.className),gke.default.cloneElement(e,t)}});var ej=Ie(fP=>{"use strict";fP.__esModule=!0;fP.resizableProps=void 0;var Vt=wke($u()),gKe=mP();function wke(e){return e&&e.__esModule?e:{default:e}}var kke={axis:Vt.default.oneOf(["both","x","y","none"]),className:Vt.default.string,children:Vt.default.element.isRequired,draggableOpts:Vt.default.shape({allowAnyClick:Vt.default.bool,cancel:Vt.default.string,children:Vt.default.node,disabled:Vt.default.bool,enableUserSelectHack:Vt.default.bool,offsetParent:Vt.default.node,grid:Vt.default.arrayOf(Vt.default.number),handle:Vt.default.string,nodeRef:Vt.default.object,onStart:Vt.default.func,onDrag:Vt.default.func,onStop:Vt.default.func,onMouseDown:Vt.default.func,scale:Vt.default.number}),height:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var o=r[0];if(o.axis==="both"||o.axis==="y"){var a;return(a=Vt.default.number).isRequired.apply(a,r)}return Vt.default.number.apply(Vt.default,r)},handle:Vt.default.oneOfType([Vt.default.node,Vt.default.func]),handleSize:Vt.default.arrayOf(Vt.default.number),lockAspectRatio:Vt.default.bool,maxConstraints:Vt.default.arrayOf(Vt.default.number),minConstraints:Vt.default.arrayOf(Vt.default.number),onResizeStop:Vt.default.func,onResizeStart:Vt.default.func,onResize:Vt.default.func,resizeHandles:Vt.default.arrayOf(Vt.default.oneOf(["s","w","e","n","sw","nw","se","ne"])),transformScale:Vt.default.number,width:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var o=r[0];if(o.axis==="both"||o.axis==="x"){var a;return(a=Vt.default.number).isRequired.apply(a,r)}return Vt.default.number.apply(Vt.default,r)}};fP.resizableProps=kke});var aj=Ie(gP=>{"use strict";gP.__esModule=!0;gP.default=void 0;var j0=Dke(Y()),Ske=mP(),Tke=tK(),Cke=ej(),Pke=["children","className","draggableOpts","width","height","handle","handleSize","lockAspectRatio","axis","minConstraints","maxConstraints","onResize","onResizeStop","onResizeStart","resizeHandles","transformScale"];function nK(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(nK=function(o){return o?r:t})(e)}function Dke(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var r=nK(t);if(r&&r.has(e))return r.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(a!=="default"&&Object.prototype.hasOwnProperty.call(e,a)){var i=o?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}function rj(){return rj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rj.apply(this,arguments)}function Eke(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,a;for(a=0;a<n.length;a++)o=n[a],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function rK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function tj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rK(Object(r),!0).forEach(function(n){Ike(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rK(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ike(e,t,r){return t=Ake(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ake(e){var t=Lke(e,"string");return typeof t=="symbol"?t:String(t)}function Lke(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nke(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,nj(e,t)}function nj(e,t){return nj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},nj(e,t)}var oj=(function(e){Nke(t,e);function t(){for(var n,o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];return n=e.call.apply(e,[this].concat(a))||this,n.handleRefs={},n.lastHandleRect=null,n.slack=null,n}var r=t.prototype;return r.componentWillUnmount=function(){this.resetData()},r.resetData=function(){this.lastHandleRect=this.slack=null},r.runConstraints=function(o,a){var i=this.props,s=i.minConstraints,l=i.maxConstraints,c=i.lockAspectRatio;if(!s&&!l&&!c)return[o,a];if(c){var d=this.props.width/this.props.height,u=o-this.props.width,p=a-this.props.height;Math.abs(u)>Math.abs(p*d)?a=o/d:o=a*d}var m=o,f=a,g=this.slack||[0,0],v=g[0],h=g[1];return o+=v,a+=h,s&&(o=Math.max(s[0],o),a=Math.max(s[1],a)),l&&(o=Math.min(l[0],o),a=Math.min(l[1],a)),this.slack=[v+(m-o),h+(f-a)],[o,a]},r.resizeHandler=function(o,a){var i=this;return function(s,l){var c=l.node,d=l.deltaX,u=l.deltaY;o==="onResizeStart"&&i.resetData();var p=(i.props.axis==="both"||i.props.axis==="x")&&a!=="n"&&a!=="s",m=(i.props.axis==="both"||i.props.axis==="y")&&a!=="e"&&a!=="w";if(!(!p&&!m)){var f=a[0],g=a[a.length-1],v=c.getBoundingClientRect();if(i.lastHandleRect!=null){if(g==="w"){var h=v.left-i.lastHandleRect.left;d+=h}if(f==="n"){var y=v.top-i.lastHandleRect.top;u+=y}}i.lastHandleRect=v,g==="w"&&(d=-d),f==="n"&&(u=-u);var b=i.props.width+(p?d/i.props.transformScale:0),x=i.props.height+(m?u/i.props.transformScale:0),w=i.runConstraints(b,x);b=w[0],x=w[1];var S=b!==i.props.width||x!==i.props.height,k=typeof i.props[o]=="function"?i.props[o]:null,T=o==="onResize"&&!S;k&&!T&&(s.persist==null||s.persist(),k(s,{node:c,size:{width:b,height:x},handle:a})),o==="onResizeStop"&&i.resetData()}}},r.renderResizeHandle=function(o,a){var i=this.props.handle;if(!i)return j0.createElement("span",{className:"react-resizable-handle react-resizable-handle-"+o,ref:a});if(typeof i=="function")return i(o,a);var s=typeof i.type=="string",l=tj({ref:a},s?{}:{handleAxis:o});return j0.cloneElement(i,l)},r.render=function(){var o=this,a=this.props,i=a.children,s=a.className,l=a.draggableOpts,c=a.width,d=a.height,u=a.handle,p=a.handleSize,m=a.lockAspectRatio,f=a.axis,g=a.minConstraints,v=a.maxConstraints,h=a.onResize,y=a.onResizeStop,b=a.onResizeStart,x=a.resizeHandles,w=a.transformScale,S=Eke(a,Pke);return(0,Tke.cloneElement)(i,tj(tj({},S),{},{className:(s?s+" ":"")+"react-resizable",children:[].concat(i.props.children,x.map(function(k){var T,P=(T=o.handleRefs[k])!=null?T:o.handleRefs[k]=j0.createRef();return j0.createElement(Ske.DraggableCore,rj({},l,{nodeRef:P,key:"resizableHandle-"+k,onStop:o.resizeHandler("onResizeStop",k),onStart:o.resizeHandler("onResizeStart",k),onDrag:o.resizeHandler("onResize",k)}),o.renderResizeHandle(k,P))}))}))},t})(j0.Component);gP.default=oj;oj.propTypes=Cke.resizableProps;oj.defaultProps={axis:"both",handleSize:[20,20],lockAspectRatio:!1,minConstraints:[20,20],maxConstraints:[1/0,1/0],resizeHandles:["se"],transformScale:1}});var lK=Ie(vP=>{"use strict";vP.__esModule=!0;vP.default=void 0;var ij=zke(Y()),Mke=aK($u()),Fke=aK(aj()),Oke=ej(),jke=["handle","handleSize","onResize","onResizeStart","onResizeStop","draggableOpts","minConstraints","maxConstraints","lockAspectRatio","axis","width","height","resizeHandles","style","transformScale"];function aK(e){return e&&e.__esModule?e:{default:e}}function iK(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(iK=function(o){return o?r:t})(e)}function zke(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var r=iK(t);if(r&&r.has(e))return r.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(a!=="default"&&Object.prototype.hasOwnProperty.call(e,a)){var i=o?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}function sj(){return sj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sj.apply(this,arguments)}function oK(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function hP(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oK(Object(r),!0).forEach(function(n){_ke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oK(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _ke(e,t,r){return t=Bke(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bke(e){var t=$ke(e,"string");return typeof t=="symbol"?t:String(t)}function $ke(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wke(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,a;for(a=0;a<n.length;a++)o=n[a],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function Rke(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,lj(e,t)}function lj(e,t){return lj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,o){return n.__proto__=o,n},lj(e,t)}var sK=(function(e){Rke(t,e);function t(){for(var n,o=arguments.length,a=new Array(o),i=0;i<o;i++)a[i]=arguments[i];return n=e.call.apply(e,[this].concat(a))||this,n.state={width:n.props.width,height:n.props.height,propsWidth:n.props.width,propsHeight:n.props.height},n.onResize=function(s,l){var c=l.size;n.props.onResize?(s.persist==null||s.persist(),n.setState(c,function(){return n.props.onResize&&n.props.onResize(s,l)})):n.setState(c)},n}t.getDerivedStateFromProps=function(o,a){return a.propsWidth!==o.width||a.propsHeight!==o.height?{width:o.width,height:o.height,propsWidth:o.width,propsHeight:o.height}:null};var r=t.prototype;return r.render=function(){var o=this.props,a=o.handle,i=o.handleSize,s=o.onResize,l=o.onResizeStart,c=o.onResizeStop,d=o.draggableOpts,u=o.minConstraints,p=o.maxConstraints,m=o.lockAspectRatio,f=o.axis,g=o.width,v=o.height,h=o.resizeHandles,y=o.style,b=o.transformScale,x=Wke(o,jke);return ij.createElement(Fke.default,{axis:f,draggableOpts:d,handle:a,handleSize:i,height:this.state.height,lockAspectRatio:m,maxConstraints:p,minConstraints:u,onResizeStart:l,onResize:this.onResize,onResizeStop:c,resizeHandles:h,transformScale:b,width:this.state.width},ij.createElement("div",sj({},x,{style:hP(hP({},y),{},{width:this.state.width+"px",height:this.state.height+"px"})})))},t})(ij.Component);vP.default=sK;sK.propTypes=hP(hP({},Oke.resizableProps),{},{children:Mke.default.element})});var cK=Ie((bKe,yP)=>{"use strict";yP.exports=function(){throw new Error("Don't instantiate Resizable directly! Use require('react-resizable').Resizable")};yP.exports.Resizable=aj().default;yP.exports.ResizableBox=lK().default});var cj=Ie(km=>{"use strict";Object.defineProperty(km,"__esModule",{value:!0});km.resizeHandleType=km.resizeHandleAxesType=km.default=void 0;var qt=dK($u()),Uke=dK(Y());function dK(e){return e&&e.__esModule?e:{default:e}}var Vke=km.resizeHandleAxesType=qt.default.arrayOf(qt.default.oneOf(["s","w","e","n","sw","nw","se","ne"])),Hke=km.resizeHandleType=qt.default.oneOfType([qt.default.node,qt.default.func]),xKe=km.default={className:qt.default.string,style:qt.default.object,width:qt.default.number,autoSize:qt.default.bool,cols:qt.default.number,draggableCancel:qt.default.string,draggableHandle:qt.default.string,verticalCompact:function(e){e.verticalCompact},compactType:qt.default.oneOf(["vertical","horizontal"]),layout:function(e){var t=e.layout;t!==void 0&&bg().validateLayout(t,"layout")},margin:qt.default.arrayOf(qt.default.number),containerPadding:qt.default.arrayOf(qt.default.number),rowHeight:qt.default.number,maxRows:qt.default.number,isBounded:qt.default.bool,isDraggable:qt.default.bool,isResizable:qt.default.bool,allowOverlap:qt.default.bool,preventCollision:qt.default.bool,useCSSTransforms:qt.default.bool,transformScale:qt.default.number,isDroppable:qt.default.bool,resizeHandles:Vke,resizeHandle:Hke,onLayoutChange:qt.default.func,onDragStart:qt.default.func,onDrag:qt.default.func,onDragStop:qt.default.func,onResizeStart:qt.default.func,onResize:qt.default.func,onResizeStop:qt.default.func,onDrop:qt.default.func,droppingItem:qt.default.shape({i:qt.default.string.isRequired,w:qt.default.number.isRequired,h:qt.default.number.isRequired}),children:function(e,t){let r=e[t],n={};Uke.default.Children.forEach(r,function(o){if((o==null?void 0:o.key)!=null){if(n[o.key])throw new Error('Duplicate child key "'+o.key+'" found! This will cause problems in ReactGridLayout.');n[o.key]=!0}})},innerRef:qt.default.any}});var mK=Ie(bP=>{"use strict";Object.defineProperty(bP,"__esModule",{value:!0});bP.default=void 0;var ry=dj(Y()),uK=vc(),Mr=dj($u()),qke=mP(),Gke=cK(),ny=bg(),qa=aP(),pK=cj(),Yke=dj(tP());function dj(e){return e&&e.__esModule?e:{default:e}}function Id(e,t,r){return(t=Kke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kke(e){var t=Jke(e,"string");return typeof t=="symbol"?t:t+""}function Jke(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var z0=class extends ry.default.Component{constructor(){super(...arguments),Id(this,"state",{resizing:null,dragging:null,className:""}),Id(this,"elementRef",ry.default.createRef()),Id(this,"onDragStart",(t,r)=>{let{node:n}=r,{onDragStart:o,transformScale:a}=this.props;if(!o)return;let i={top:0,left:0},{offsetParent:s}=n;if(!s)return;let l=s.getBoundingClientRect(),c=n.getBoundingClientRect(),d=c.left/a,u=l.left/a,p=c.top/a,m=l.top/a;i.left=d-u+s.scrollLeft,i.top=p-m+s.scrollTop,this.setState({dragging:i});let{x:f,y:g}=(0,qa.calcXY)(this.getPositionParams(),i.top,i.left,this.props.w,this.props.h);return o.call(this,this.props.i,f,g,{e:t,node:n,newPosition:i})}),Id(this,"onDrag",(t,r,n)=>{let{node:o,deltaX:a,deltaY:i}=r,{onDrag:s}=this.props;if(!s)return;if(!this.state.dragging)throw new Error("onDrag called before onDragStart.");let l=this.state.dragging.top+i,c=this.state.dragging.left+a,{isBounded:d,i:u,w:p,h:m,containerWidth:f}=this.props,g=this.getPositionParams();if(d){let{offsetParent:b}=o;if(b){let{margin:x,rowHeight:w}=this.props,S=b.clientHeight-(0,qa.calcGridItemWHPx)(m,w,x[1]);l=(0,qa.clamp)(l,0,S);let k=(0,qa.calcGridColWidth)(g),T=f-(0,qa.calcGridItemWHPx)(p,k,x[0]);c=(0,qa.clamp)(c,0,T)}}let v={top:l,left:c};n?this.setState({dragging:v}):(0,uK.flushSync)(()=>{this.setState({dragging:v})});let{x:h,y}=(0,qa.calcXY)(g,l,c,p,m);return s.call(this,u,h,y,{e:t,node:o,newPosition:v})}),Id(this,"onDragStop",(t,r)=>{let{node:n}=r,{onDragStop:o}=this.props;if(!o)return;if(!this.state.dragging)throw new Error("onDragEnd called before onDragStart.");let{w:a,h:i,i:s}=this.props,{left:l,top:c}=this.state.dragging,d={top:c,left:l};this.setState({dragging:null});let{x:u,y:p}=(0,qa.calcXY)(this.getPositionParams(),c,l,a,i);return o.call(this,s,u,p,{e:t,node:n,newPosition:d})}),Id(this,"onResizeStop",(t,r,n)=>this.onResizeHandler(t,r,n,"onResizeStop")),Id(this,"onResizeStart",(t,r,n)=>this.onResizeHandler(t,r,n,"onResizeStart")),Id(this,"onResize",(t,r,n)=>this.onResizeHandler(t,r,n,"onResize"))}shouldComponentUpdate(t,r){if(this.props.children!==t.children||this.props.droppingPosition!==t.droppingPosition)return!0;let n=(0,qa.calcGridItemPosition)(this.getPositionParams(this.props),this.props.x,this.props.y,this.props.w,this.props.h,this.state),o=(0,qa.calcGridItemPosition)(this.getPositionParams(t),t.x,t.y,t.w,t.h,r);return!(0,ny.fastPositionEqual)(n,o)||this.props.useCSSTransforms!==t.useCSSTransforms}componentDidMount(){this.moveDroppingItem({})}componentDidUpdate(t){this.moveDroppingItem(t)}moveDroppingItem(t){let{droppingPosition:r}=this.props;if(!r)return;let n=this.elementRef.current;if(!n)return;let o=t.droppingPosition||{left:0,top:0},{dragging:a}=this.state,i=a&&r.left!==o.left||r.top!==o.top;if(!a)this.onDragStart(r.e,{node:n,deltaX:r.left,deltaY:r.top});else if(i){let s=r.left-a.left,l=r.top-a.top;this.onDrag(r.e,{node:n,deltaX:s,deltaY:l},!0)}}getPositionParams(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props;return{cols:t.cols,containerPadding:t.containerPadding,containerWidth:t.containerWidth,margin:t.margin,maxRows:t.maxRows,rowHeight:t.rowHeight}}createStyle(t){let{usePercentages:r,containerWidth:n,useCSSTransforms:o}=this.props,a;return o?a=(0,ny.setTransform)(t):(a=(0,ny.setTopLeft)(t),r&&(a.left=(0,ny.perc)(t.left/n),a.width=(0,ny.perc)(t.width/n))),a}mixinDraggable(t,r){return ry.default.createElement(qke.DraggableCore,{disabled:!r,onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop,handle:this.props.handle,cancel:".react-resizable-handle"+(this.props.cancel?","+this.props.cancel:""),scale:this.props.transformScale,nodeRef:this.elementRef},t)}curryResizeHandler(t,r){return(n,o)=>r(n,o,t)}mixinResizable(t,r,n){let{cols:o,minW:a,minH:i,maxW:s,maxH:l,transformScale:c,resizeHandles:d,resizeHandle:u}=this.props,p=this.getPositionParams(),m=(0,qa.calcGridItemPosition)(p,0,0,o,0).width,f=(0,qa.calcGridItemPosition)(p,0,0,a,i),g=(0,qa.calcGridItemPosition)(p,0,0,s,l),v=[f.width,f.height],h=[Math.min(g.width,m),Math.min(g.height,1/0)];return ry.default.createElement(Gke.Resizable,{draggableOpts:{disabled:!n},className:n?void 0:"react-resizable-hide",width:r.width,height:r.height,minConstraints:v,maxConstraints:h,onResizeStop:this.curryResizeHandler(r,this.onResizeStop),onResizeStart:this.curryResizeHandler(r,this.onResizeStart),onResize:this.curryResizeHandler(r,this.onResize),transformScale:c,resizeHandles:d,handle:u},t)}onResizeHandler(t,r,n,o){let{node:a,size:i,handle:s}=r,l=this.props[o];if(!l)return;let{x:c,y:d,i:u,maxH:p,minH:m,containerWidth:f}=this.props,{minW:g,maxW:v}=this.props,h=i;a&&(h=(0,ny.resizeItemInDirection)(s,n,i,f),(0,uK.flushSync)(()=>{this.setState({resizing:o==="onResizeStop"?null:h})}));let{w:y,h:b}=(0,qa.calcWH)(this.getPositionParams(),h.width,h.height,c,d,s);y=(0,qa.clamp)(y,Math.max(g,1),v),b=(0,qa.clamp)(b,m,p),l.call(this,u,y,b,{e:t,node:a,size:h,handle:s})}render(){let{x:t,y:r,w:n,h:o,isDraggable:a,isResizable:i,droppingPosition:s,useCSSTransforms:l}=this.props,c=(0,qa.calcGridItemPosition)(this.getPositionParams(),t,r,n,o,this.state),d=ry.default.Children.only(this.props.children),u=ry.default.cloneElement(d,{ref:this.elementRef,className:(0,Yke.default)("react-grid-item",d.props.className,this.props.className,{static:this.props.static,resizing:!!this.state.resizing,"react-draggable":a,"react-draggable-dragging":!!this.state.dragging,dropping:!!s,cssTransforms:l}),style:{...this.props.style,...d.props.style,...this.createStyle(c)}});return u=this.mixinResizable(u,c,i),u=this.mixinDraggable(u,a),u}};bP.default=z0;Id(z0,"propTypes",{children:Mr.default.element,cols:Mr.default.number.isRequired,containerWidth:Mr.default.number.isRequired,rowHeight:Mr.default.number.isRequired,margin:Mr.default.array.isRequired,maxRows:Mr.default.number.isRequired,containerPadding:Mr.default.array.isRequired,x:Mr.default.number.isRequired,y:Mr.default.number.isRequired,w:Mr.default.number.isRequired,h:Mr.default.number.isRequired,minW:function(e,t){let r=e[t];if(typeof r!="number")return new Error("minWidth not Number");if(r>e.w||r>e.maxW)return new Error("minWidth larger than item width/maxWidth")},maxW:function(e,t){let r=e[t];if(typeof r!="number")return new Error("maxWidth not Number");if(r<e.w||r<e.minW)return new Error("maxWidth smaller than item width/minWidth")},minH:function(e,t){let r=e[t];if(typeof r!="number")return new Error("minHeight not Number");if(r>e.h||r>e.maxH)return new Error("minHeight larger than item height/maxHeight")},maxH:function(e,t){let r=e[t];if(typeof r!="number")return new Error("maxHeight not Number");if(r<e.h||r<e.minH)return new Error("maxHeight smaller than item height/minHeight")},i:Mr.default.string.isRequired,resizeHandles:pK.resizeHandleAxesType,resizeHandle:pK.resizeHandleType,onDragStop:Mr.default.func,onDragStart:Mr.default.func,onDrag:Mr.default.func,onResizeStop:Mr.default.func,onResizeStart:Mr.default.func,onResize:Mr.default.func,isDraggable:Mr.default.bool.isRequired,isResizable:Mr.default.bool.isRequired,isBounded:Mr.default.bool.isRequired,static:Mr.default.bool,useCSSTransforms:Mr.default.bool.isRequired,transformScale:Mr.default.number,className:Mr.default.string,handle:Mr.default.string,cancel:Mr.default.string,droppingPosition:Mr.default.shape({e:Mr.default.object.isRequired,left:Mr.default.number.isRequired,top:Mr.default.number.isRequired})});Id(z0,"defaultProps",{className:"",cancel:"",handle:"",minH:1,minW:1,maxH:1/0,maxW:1/0,transformScale:1})});var mj=Ie(xP=>{"use strict";Object.defineProperty(xP,"__esModule",{value:!0});xP.default=void 0;var Sg=hK(Y()),uj=eP(),Xke=pj(tP()),At=bg(),Qke=aP(),fK=pj(mK()),Zke=pj(cj());function pj(e){return e&&e.__esModule?e:{default:e}}function hK(e,t){if(typeof WeakMap=="function")var r=new WeakMap,n=new WeakMap;return(hK=function(o,a){if(!a&&o&&o.__esModule)return o;var i,s,l={__proto__:null,default:o};if(o===null||typeof o!="object"&&typeof o!="function")return l;if(i=a?n:r){if(i.has(o))return i.get(o);i.set(o,l)}for(let c in o)c!=="default"&&{}.hasOwnProperty.call(o,c)&&((s=(i=Object.defineProperty)&&Object.getOwnPropertyDescriptor(o,c))&&(s.get||s.set)?i(l,c,s):l[c]=o[c]);return l})(e,t)}function mi(e,t,r){return(t=eSe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eSe(e){var t=tSe(e,"string");return typeof t=="symbol"?t:t+""}function tSe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gK="react-grid-layout",vK=!1;try{vK=/firefox/i.test(navigator.userAgent)}catch(e){}var oy=class extends Sg.Component{constructor(){super(...arguments),mi(this,"state",{activeDrag:null,layout:(0,At.synchronizeLayoutWithChildren)(this.props.layout,this.props.children,this.props.cols,(0,At.compactType)(this.props),this.props.allowOverlap),mounted:!1,oldDragItem:null,oldLayout:null,oldResizeItem:null,resizing:!1,droppingDOMNode:null,children:[]}),mi(this,"dragEnterCounter",0),mi(this,"onDragStart",(t,r,n,o)=>{let{e:a,node:i}=o,{layout:s}=this.state,l=(0,At.getLayoutItem)(s,t);if(!l)return;let c={w:l.w,h:l.h,x:l.x,y:l.y,placeholder:!0,i:t};return this.setState({oldDragItem:(0,At.cloneLayoutItem)(l),oldLayout:s,activeDrag:c}),this.props.onDragStart(s,l,l,null,a,i)}),mi(this,"onDrag",(t,r,n,o)=>{let{e:a,node:i}=o,{oldDragItem:s}=this.state,{layout:l}=this.state,{cols:c,allowOverlap:d,preventCollision:u}=this.props,p=(0,At.getLayoutItem)(l,t);if(!p)return;let m={w:p.w,h:p.h,x:p.x,y:p.y,placeholder:!0,i:t};l=(0,At.moveElement)(l,p,r,n,!0,u,(0,At.compactType)(this.props),c,d),this.props.onDrag(l,s,p,m,a,i),this.setState({layout:d?l:(0,At.compact)(l,(0,At.compactType)(this.props),c),activeDrag:m})}),mi(this,"onDragStop",(t,r,n,o)=>{let{e:a,node:i}=o;if(!this.state.activeDrag)return;let{oldDragItem:s}=this.state,{layout:l}=this.state,{cols:c,preventCollision:d,allowOverlap:u}=this.props,p=(0,At.getLayoutItem)(l,t);if(!p)return;l=(0,At.moveElement)(l,p,r,n,!0,d,(0,At.compactType)(this.props),c,u);let f=u?l:(0,At.compact)(l,(0,At.compactType)(this.props),c);this.props.onDragStop(f,s,p,null,a,i);let{oldLayout:g}=this.state;this.setState({activeDrag:null,layout:f,oldDragItem:null,oldLayout:null}),this.onLayoutMaybeChanged(f,g)}),mi(this,"onResizeStart",(t,r,n,o)=>{let{e:a,node:i}=o,{layout:s}=this.state,l=(0,At.getLayoutItem)(s,t);l&&(this.setState({oldResizeItem:(0,At.cloneLayoutItem)(l),oldLayout:this.state.layout,resizing:!0}),this.props.onResizeStart(s,l,l,null,a,i))}),mi(this,"onResize",(t,r,n,o)=>{let{e:a,node:i,size:s,handle:l}=o,{oldResizeItem:c}=this.state,{layout:d}=this.state,{cols:u,preventCollision:p,allowOverlap:m}=this.props,f=!1,g,v,h,[y,b]=(0,At.withLayoutItem)(d,t,w=>{let S;return v=w.x,h=w.y,["sw","w","nw","n","ne"].indexOf(l)!==-1&&(["sw","nw","w"].indexOf(l)!==-1&&(v=w.x+(w.w-r),r=w.x!==v&&v<0?w.w:r,v=v<0?0:v),["ne","n","nw"].indexOf(l)!==-1&&(h=w.y+(w.h-n),n=w.y!==h&&h<0?w.h:n,h=h<0?0:h),f=!0),p&&!m&&(S=(0,At.getAllCollisions)(d,{...w,w:r,h:n,x:v,y:h}).filter(T=>T.i!==w.i).length>0,S&&(h=w.y,n=w.h,v=w.x,r=w.w,f=!1)),w.w=r,w.h=n,w});if(!b)return;g=y,f&&(g=(0,At.moveElement)(y,b,v,h,!0,this.props.preventCollision,(0,At.compactType)(this.props),u,m));let x={w:b.w,h:b.h,x:b.x,y:b.y,static:!0,i:t};this.props.onResize(g,c,b,x,a,i),this.setState({layout:m?g:(0,At.compact)(g,(0,At.compactType)(this.props),u),activeDrag:x})}),mi(this,"onResizeStop",(t,r,n,o)=>{let{e:a,node:i}=o,{layout:s,oldResizeItem:l}=this.state,{cols:c,allowOverlap:d}=this.props,u=(0,At.getLayoutItem)(s,t),p=d?s:(0,At.compact)(s,(0,At.compactType)(this.props),c);this.props.onResizeStop(p,l,u,null,a,i);let{oldLayout:m}=this.state;this.setState({activeDrag:null,layout:p,oldResizeItem:null,oldLayout:null,resizing:!1}),this.onLayoutMaybeChanged(p,m)}),mi(this,"onDragOver",t=>{var y;if(t.preventDefault(),t.stopPropagation(),vK&&!((y=t.nativeEvent.target)!=null&&y.classList.contains(gK)))return!1;let{droppingItem:r,onDropDragOver:n,margin:o,cols:a,rowHeight:i,maxRows:s,width:l,containerPadding:c,transformScale:d}=this.props,u=n==null?void 0:n(t);if(u===!1)return this.state.droppingDOMNode&&this.removeDroppingPlaceholder(),!1;let p={...r,...u},{layout:m}=this.state,f=t.currentTarget.getBoundingClientRect(),g=t.clientX-f.left,v=t.clientY-f.top,h={left:g/d,top:v/d,e:t};if(this.state.droppingDOMNode){if(this.state.droppingPosition){let{left:b,top:x}=this.state.droppingPosition;(b!=g||x!=v)&&this.setState({droppingPosition:h})}}else{let b={cols:a,margin:o,maxRows:s,rowHeight:i,containerWidth:l,containerPadding:c||o},x=(0,Qke.calcXY)(b,v,g,p.w,p.h);this.setState({droppingDOMNode:Sg.createElement("div",{key:p.i}),droppingPosition:h,layout:[...m,{...p,x:x.x,y:x.y,static:!1,isDraggable:!0}]})}}),mi(this,"removeDroppingPlaceholder",()=>{let{droppingItem:t,cols:r}=this.props,{layout:n}=this.state,o=(0,At.compact)(n.filter(a=>a.i!==t.i),(0,At.compactType)(this.props),r,this.props.allowOverlap);this.setState({layout:o,droppingDOMNode:null,activeDrag:null,droppingPosition:void 0})}),mi(this,"onDragLeave",t=>{t.preventDefault(),t.stopPropagation(),this.dragEnterCounter--,this.dragEnterCounter===0&&this.removeDroppingPlaceholder()}),mi(this,"onDragEnter",t=>{t.preventDefault(),t.stopPropagation(),this.dragEnterCounter++}),mi(this,"onDrop",t=>{t.preventDefault(),t.stopPropagation();let{droppingItem:r}=this.props,{layout:n}=this.state,o=n.find(a=>a.i===r.i);this.dragEnterCounter=0,this.removeDroppingPlaceholder(),this.props.onDrop(n,o,t)})}componentDidMount(){this.setState({mounted:!0}),this.onLayoutMaybeChanged(this.state.layout,this.props.layout)}static getDerivedStateFromProps(t,r){let n;return r.activeDrag?null:(!(0,uj.deepEqual)(t.layout,r.propsLayout)||t.compactType!==r.compactType?n=t.layout:(0,At.childrenEqual)(t.children,r.children)||(n=r.layout),n?{layout:(0,At.synchronizeLayoutWithChildren)(n,t.children,t.cols,(0,At.compactType)(t),t.allowOverlap),compactType:t.compactType,children:t.children,propsLayout:t.layout}:null)}shouldComponentUpdate(t,r){return this.props.children!==t.children||!(0,At.fastRGLPropsEqual)(this.props,t,uj.deepEqual)||this.state.activeDrag!==r.activeDrag||this.state.mounted!==r.mounted||this.state.droppingPosition!==r.droppingPosition}componentDidUpdate(t,r){if(!this.state.activeDrag){let n=this.state.layout,o=r.layout;this.onLayoutMaybeChanged(n,o)}}containerHeight(){if(!this.props.autoSize)return;let t=(0,At.bottom)(this.state.layout),r=this.props.containerPadding?this.props.containerPadding[1]:this.props.margin[1];return t*this.props.rowHeight+(t-1)*this.props.margin[1]+r*2+"px"}onLayoutMaybeChanged(t,r){r||(r=this.state.layout),(0,uj.deepEqual)(r,t)||this.props.onLayoutChange(t)}placeholder(){let{activeDrag:t}=this.state;if(!t)return null;let{width:r,cols:n,margin:o,containerPadding:a,rowHeight:i,maxRows:s,useCSSTransforms:l,transformScale:c}=this.props;return Sg.createElement(fK.default,{w:t.w,h:t.h,x:t.x,y:t.y,i:t.i,className:`react-grid-placeholder ${this.state.resizing?"placeholder-resizing":""}`,containerWidth:r,cols:n,margin:o,containerPadding:a||o,maxRows:s,rowHeight:i,isDraggable:!1,isResizable:!1,isBounded:!1,useCSSTransforms:l,transformScale:c},Sg.createElement("div",null))}processGridItem(t,r){if(!t||!t.key)return;let n=(0,At.getLayoutItem)(this.state.layout,String(t.key));if(!n)return null;let{width:o,cols:a,margin:i,containerPadding:s,rowHeight:l,maxRows:c,isDraggable:d,isResizable:u,isBounded:p,useCSSTransforms:m,transformScale:f,draggableCancel:g,draggableHandle:v,resizeHandles:h,resizeHandle:y}=this.props,{mounted:b,droppingPosition:x}=this.state,w=typeof n.isDraggable=="boolean"?n.isDraggable:!n.static&&d,S=typeof n.isResizable=="boolean"?n.isResizable:!n.static&&u,k=n.resizeHandles||h,T=w&&p&&n.isBounded!==!1;return Sg.createElement(fK.default,{containerWidth:o,cols:a,margin:i,containerPadding:s||i,maxRows:c,rowHeight:l,cancel:g,handle:v,onDragStop:this.onDragStop,onDragStart:this.onDragStart,onDrag:this.onDrag,onResizeStart:this.onResizeStart,onResize:this.onResize,onResizeStop:this.onResizeStop,isDraggable:w,isResizable:S,isBounded:T,useCSSTransforms:m&&b,usePercentages:!b,transformScale:f,w:n.w,h:n.h,x:n.x,y:n.y,i:n.i,minH:n.minH,minW:n.minW,maxH:n.maxH,maxW:n.maxW,static:n.static,droppingPosition:r?x:void 0,resizeHandles:k,resizeHandle:y},t)}render(){let{className:t,style:r,isDroppable:n,innerRef:o}=this.props,a=(0,Xke.default)(gK,t),i={height:this.containerHeight(),...r};return Sg.createElement("div",{ref:o,className:a,style:i,onDrop:n?this.onDrop:At.noop,onDragLeave:n?this.onDragLeave:At.noop,onDragEnter:n?this.onDragEnter:At.noop,onDragOver:n?this.onDragOver:At.noop},Sg.Children.map(this.props.children,s=>this.processGridItem(s)),n&&this.state.droppingDOMNode&&this.processGridItem(this.state.droppingDOMNode,!0),this.placeholder())}};xP.default=oy;mi(oy,"displayName","ReactGridLayout");mi(oy,"propTypes",Zke.default);mi(oy,"defaultProps",{autoSize:!0,cols:12,className:"",style:{},draggableHandle:"",draggableCancel:"",containerPadding:null,rowHeight:150,maxRows:1/0,layout:[],margin:[10,10],isBounded:!1,isDraggable:!0,isResizable:!0,allowOverlap:!1,isDroppable:!1,useCSSTransforms:!0,transformScale:1,verticalCompact:!0,compactType:"vertical",preventCollision:!1,droppingItem:{i:"__dropping-elem__",h:1,w:1},resizeHandles:["se"],onLayoutChange:At.noop,onDragStart:At.noop,onDrag:At.noop,onDragStop:At.noop,onResizeStart:At.noop,onResize:At.noop,onResizeStop:At.noop,onDrop:At.noop,onDropDragOver:At.noop})});var gj=Ie(ay=>{"use strict";Object.defineProperty(ay,"__esModule",{value:!0});ay.findOrGenerateResponsiveLayout=oSe;ay.getBreakpointFromWidth=rSe;ay.getColsFromBreakpoint=nSe;ay.sortBreakpoints=fj;var wP=bg();function rSe(e,t){let r=fj(e),n=r[0];for(let o=1,a=r.length;o<a;o++){let i=r[o];t>e[i]&&(n=i)}return n}function nSe(e,t){if(!t[e])throw new Error("ResponsiveReactGridLayout: `cols` entry for breakpoint "+e+" is missing!");return t[e]}function oSe(e,t,r,n,o,a){if(e[r])return(0,wP.cloneLayout)(e[r]);let i=e[n],s=fj(t),l=s.slice(s.indexOf(r));for(let c=0,d=l.length;c<d;c++){let u=l[c];if(e[u]){i=e[u];break}}return i=(0,wP.cloneLayout)(i||[]),(0,wP.compact)((0,wP.correctBounds)(i,{cols:o}),a,o)}function fj(e){return Object.keys(e).sort(function(r,n){return e[r]-e[n]})}});var kK=Ie(TP=>{"use strict";Object.defineProperty(TP,"__esModule",{value:!0});TP.default=void 0;var yK=wK(Y()),fs=xK($u()),hj=eP(),iy=bg(),Tg=gj(),aSe=xK(mj());function xK(e){return e&&e.__esModule?e:{default:e}}function wK(e,t){if(typeof WeakMap=="function")var r=new WeakMap,n=new WeakMap;return(wK=function(o,a){if(!a&&o&&o.__esModule)return o;var i,s,l={__proto__:null,default:o};if(o===null||typeof o!="object"&&typeof o!="function")return l;if(i=a?n:r){if(i.has(o))return i.get(o);i.set(o,l)}for(let c in o)c!=="default"&&{}.hasOwnProperty.call(o,c)&&((s=(i=Object.defineProperty)&&Object.getOwnPropertyDescriptor(o,c))&&(s.get||s.set)?i(l,c,s):l[c]=o[c]);return l})(e,t)}function vj(){return vj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vj.apply(null,arguments)}function SP(e,t,r){return(t=iSe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iSe(e){var t=sSe(e,"string");return typeof t=="symbol"?t:t+""}function sSe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bK=e=>Object.prototype.toString.call(e);function kP(e,t){return e==null?null:Array.isArray(e)?e:e[t]}var _0=class extends yK.Component{constructor(){super(...arguments),SP(this,"state",this.generateInitialState()),SP(this,"onLayoutChange",t=>{this.props.onLayoutChange(t,{...this.props.layouts,[this.state.breakpoint]:t})})}generateInitialState(){let{width:t,breakpoints:r,layouts:n,cols:o}=this.props,a=(0,Tg.getBreakpointFromWidth)(r,t),i=(0,Tg.getColsFromBreakpoint)(a,o),s=this.props.verticalCompact===!1?null:this.props.compactType;return{layout:(0,Tg.findOrGenerateResponsiveLayout)(n,r,a,a,i,s),breakpoint:a,cols:i}}static getDerivedStateFromProps(t,r){if(!(0,hj.deepEqual)(t.layouts,r.layouts)){let{breakpoint:n,cols:o}=r;return{layout:(0,Tg.findOrGenerateResponsiveLayout)(t.layouts,t.breakpoints,n,n,o,t.compactType),layouts:t.layouts}}return null}componentDidUpdate(t){(this.props.width!=t.width||this.props.breakpoint!==t.breakpoint||!(0,hj.deepEqual)(this.props.breakpoints,t.breakpoints)||!(0,hj.deepEqual)(this.props.cols,t.cols))&&this.onWidthChange(t)}onWidthChange(t){let{breakpoints:r,cols:n,layouts:o,compactType:a}=this.props,i=this.props.breakpoint||(0,Tg.getBreakpointFromWidth)(this.props.breakpoints,this.props.width),s=this.state.breakpoint,l=(0,Tg.getColsFromBreakpoint)(i,n),c={...o};if(s!==i||t.breakpoints!==r||t.cols!==n){s in c||(c[s]=(0,iy.cloneLayout)(this.state.layout));let p=(0,Tg.findOrGenerateResponsiveLayout)(c,r,i,s,l,a);p=(0,iy.synchronizeLayoutWithChildren)(p,this.props.children,l,a,this.props.allowOverlap),c[i]=p,this.props.onBreakpointChange(i,l),this.props.onLayoutChange(p,c),this.setState({breakpoint:i,layout:p,cols:l})}let d=kP(this.props.margin,i),u=kP(this.props.containerPadding,i);this.props.onWidthChange(this.props.width,d,l,u)}render(){let{breakpoint:t,breakpoints:r,cols:n,layouts:o,margin:a,containerPadding:i,onBreakpointChange:s,onLayoutChange:l,onWidthChange:c,...d}=this.props;return yK.createElement(aSe.default,vj({},d,{margin:kP(a,this.state.breakpoint),containerPadding:kP(i,this.state.breakpoint),onLayoutChange:this.onLayoutChange,layout:this.state.layout,cols:this.state.cols}))}};TP.default=_0;SP(_0,"propTypes",{breakpoint:fs.default.string,breakpoints:fs.default.object,allowOverlap:fs.default.bool,cols:fs.default.object,margin:fs.default.oneOfType([fs.default.array,fs.default.object]),containerPadding:fs.default.oneOfType([fs.default.array,fs.default.object]),layouts(e,t){if(bK(e[t])!=="[object Object]")throw new Error("Layout property must be an object. Received: "+bK(e[t]));Object.keys(e[t]).forEach(r=>{if(!(r in e.breakpoints))throw new Error("Each key in layouts must align with a key in breakpoints.");(0,iy.validateLayout)(e.layouts[r],"layouts."+r)})},width:fs.default.number.isRequired,onBreakpointChange:fs.default.func,onLayoutChange:fs.default.func,onWidthChange:fs.default.func});SP(_0,"defaultProps",{breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:12,md:10,sm:6,xs:4,xxs:2},containerPadding:{lg:null,md:null,sm:null,xs:null,xxs:null},layouts:{},margin:[10,10],allowOverlap:!1,onBreakpointChange:iy.noop,onLayoutChange:iy.noop,onWidthChange:iy.noop})});var SK=Ie((yj,bj)=>{(function(e,t){typeof yj=="object"&&typeof bj!="undefined"?bj.exports=t():typeof define=="function"&&define.amd?define(t):e.ResizeObserver=t()})(yj,(function(){"use strict";var e=(function(){if(typeof Map!="undefined")return Map;function I(A,j){var E=-1;return A.some(function(N,B){return N[0]===j?(E=B,!0):!1}),E}return(function(){function A(){this.__entries__=[]}return Object.defineProperty(A.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),A.prototype.get=function(j){var E=I(this.__entries__,j),N=this.__entries__[E];return N&&N[1]},A.prototype.set=function(j,E){var N=I(this.__entries__,j);~N?this.__entries__[N][1]=E:this.__entries__.push([j,E])},A.prototype.delete=function(j){var E=this.__entries__,N=I(E,j);~N&&E.splice(N,1)},A.prototype.has=function(j){return!!~I(this.__entries__,j)},A.prototype.clear=function(){this.__entries__.splice(0)},A.prototype.forEach=function(j,E){E===void 0&&(E=null);for(var N=0,B=this.__entries__;N<B.length;N++){var C=B[N];j.call(E,C[1],C[0])}},A})()})(),t=typeof window!="undefined"&&typeof document!="undefined"&&window.document===document,r=(function(){return typeof global!="undefined"&&global.Math===Math?global:typeof self!="undefined"&&self.Math===Math?self:typeof window!="undefined"&&window.Math===Math?window:Function("return this")()})(),n=(function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(r):function(I){return setTimeout(function(){return I(Date.now())},1e3/60)}})(),o=2;function a(I,A){var j=!1,E=!1,N=0;function B(){j&&(j=!1,I()),E&&F()}function C(){n(B)}function F(){var M=Date.now();if(j){if(M-N<o)return;E=!0}else j=!0,E=!1,setTimeout(C,A);N=M}return F}var i=20,s=["top","right","bottom","left","width","height","size","weight"],l=typeof MutationObserver!="undefined",c=(function(){function I(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=a(this.refresh.bind(this),i)}return I.prototype.addObserver=function(A){~this.observers_.indexOf(A)||this.observers_.push(A),this.connected_||this.connect_()},I.prototype.removeObserver=function(A){var j=this.observers_,E=j.indexOf(A);~E&&j.splice(E,1),!j.length&&this.connected_&&this.disconnect_()},I.prototype.refresh=function(){var A=this.updateObservers_();A&&this.refresh()},I.prototype.updateObservers_=function(){var A=this.observers_.filter(function(j){return j.gatherActive(),j.hasActive()});return A.forEach(function(j){return j.broadcastActive()}),A.length>0},I.prototype.connect_=function(){!t||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),l?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},I.prototype.disconnect_=function(){!t||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},I.prototype.onTransitionEnd_=function(A){var j=A.propertyName,E=j===void 0?"":j,N=s.some(function(B){return!!~E.indexOf(B)});N&&this.refresh()},I.getInstance=function(){return this.instance_||(this.instance_=new I),this.instance_},I.instance_=null,I})(),d=(function(I,A){for(var j=0,E=Object.keys(A);j<E.length;j++){var N=E[j];Object.defineProperty(I,N,{value:A[N],enumerable:!1,writable:!1,configurable:!0})}return I}),u=(function(I){var A=I&&I.ownerDocument&&I.ownerDocument.defaultView;return A||r}),p=S(0,0,0,0);function m(I){return parseFloat(I)||0}function f(I){for(var A=[],j=1;j<arguments.length;j++)A[j-1]=arguments[j];return A.reduce(function(E,N){var B=I["border-"+N+"-width"];return E+m(B)},0)}function g(I){for(var A=["top","right","bottom","left"],j={},E=0,N=A;E<N.length;E++){var B=N[E],C=I["padding-"+B];j[B]=m(C)}return j}function v(I){var A=I.getBBox();return S(0,0,A.width,A.height)}function h(I){var A=I.clientWidth,j=I.clientHeight;if(!A&&!j)return p;var E=u(I).getComputedStyle(I),N=g(E),B=N.left+N.right,C=N.top+N.bottom,F=m(E.width),M=m(E.height);if(E.boxSizing==="border-box"&&(Math.round(F+B)!==A&&(F-=f(E,"left","right")+B),Math.round(M+C)!==j&&(M-=f(E,"top","bottom")+C)),!b(I)){var _=Math.round(F+B)-A,W=Math.round(M+C)-j;Math.abs(_)!==1&&(F-=_),Math.abs(W)!==1&&(M-=W)}return S(N.left,N.top,F,M)}var y=(function(){return typeof SVGGraphicsElement!="undefined"?function(I){return I instanceof u(I).SVGGraphicsElement}:function(I){return I instanceof u(I).SVGElement&&typeof I.getBBox=="function"}})();function b(I){return I===u(I).document.documentElement}function x(I){return t?y(I)?v(I):h(I):p}function w(I){var A=I.x,j=I.y,E=I.width,N=I.height,B=typeof DOMRectReadOnly!="undefined"?DOMRectReadOnly:Object,C=Object.create(B.prototype);return d(C,{x:A,y:j,width:E,height:N,top:j,right:A+E,bottom:N+j,left:A}),C}function S(I,A,j,E){return{x:I,y:A,width:j,height:E}}var k=(function(){function I(A){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=S(0,0,0,0),this.target=A}return I.prototype.isActive=function(){var A=x(this.target);return this.contentRect_=A,A.width!==this.broadcastWidth||A.height!==this.broadcastHeight},I.prototype.broadcastRect=function(){var A=this.contentRect_;return this.broadcastWidth=A.width,this.broadcastHeight=A.height,A},I})(),T=(function(){function I(A,j){var E=w(j);d(this,{target:A,contentRect:E})}return I})(),P=(function(){function I(A,j,E){if(this.activeObservations_=[],this.observations_=new e,typeof A!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=A,this.controller_=j,this.callbackCtx_=E}return I.prototype.observe=function(A){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element=="undefined"||!(Element instanceof Object))){if(!(A instanceof u(A).Element))throw new TypeError('parameter 1 is not of type "Element".');var j=this.observations_;j.has(A)||(j.set(A,new k(A)),this.controller_.addObserver(this),this.controller_.refresh())}},I.prototype.unobserve=function(A){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element=="undefined"||!(Element instanceof Object))){if(!(A instanceof u(A).Element))throw new TypeError('parameter 1 is not of type "Element".');var j=this.observations_;j.has(A)&&(j.delete(A),j.size||this.controller_.removeObserver(this))}},I.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},I.prototype.gatherActive=function(){var A=this;this.clearActive(),this.observations_.forEach(function(j){j.isActive()&&A.activeObservations_.push(j)})},I.prototype.broadcastActive=function(){if(this.hasActive()){var A=this.callbackCtx_,j=this.activeObservations_.map(function(E){return new T(E.target,E.broadcastRect())});this.callback_.call(A,j,A),this.clearActive()}},I.prototype.clearActive=function(){this.activeObservations_.splice(0)},I.prototype.hasActive=function(){return this.activeObservations_.length>0},I})(),D=typeof WeakMap!="undefined"?new WeakMap:new e,O=(function(){function I(A){if(!(this instanceof I))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var j=c.getInstance(),E=new P(A,j,this);D.set(this,E)}return I})();["observe","unobserve","disconnect"].forEach(function(I){O.prototype[I]=function(){var A;return(A=D.get(this))[I].apply(A,arguments)}});var z=(function(){return typeof r.ResizeObserver!="undefined"?r.ResizeObserver:O})();return z}))});var CK=Ie(kj=>{"use strict";Object.defineProperty(kj,"__esModule",{value:!0});kj.default=fSe;var CP=TK(Y()),lSe=wj($u()),cSe=wj(SK()),dSe=wj(tP());function wj(e){return e&&e.__esModule?e:{default:e}}function TK(e,t){if(typeof WeakMap=="function")var r=new WeakMap,n=new WeakMap;return(TK=function(o,a){if(!a&&o&&o.__esModule)return o;var i,s,l={__proto__:null,default:o};if(o===null||typeof o!="object"&&typeof o!="function")return l;if(i=a?n:r){if(i.has(o))return i.get(o);i.set(o,l)}for(let c in o)c!=="default"&&{}.hasOwnProperty.call(o,c)&&((s=(i=Object.defineProperty)&&Object.getOwnPropertyDescriptor(o,c))&&(s.get||s.set)?i(l,c,s):l[c]=o[c]);return l})(e,t)}function xj(){return xj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xj.apply(null,arguments)}function sy(e,t,r){return(t=uSe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uSe(e){var t=pSe(e,"string");return typeof t=="symbol"?t:t+""}function pSe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mSe="react-grid-layout";function fSe(e){var t;return t=class extends CP.Component{constructor(){super(...arguments),sy(this,"state",{width:1280}),sy(this,"elementRef",CP.createRef()),sy(this,"mounted",!1),sy(this,"resizeObserver",void 0)}componentDidMount(){this.mounted=!0,this.resizeObserver=new cSe.default(o=>{if(this.elementRef.current instanceof HTMLElement){let i=o[0].contentRect.width;this.setState({width:i})}});let n=this.elementRef.current;n instanceof HTMLElement&&this.resizeObserver.observe(n)}componentWillUnmount(){this.mounted=!1;let n=this.elementRef.current;n instanceof HTMLElement&&this.resizeObserver.unobserve(n),this.resizeObserver.disconnect()}render(){let{measureBeforeMount:n,...o}=this.props;return n&&!this.mounted?CP.createElement("div",{className:(0,dSe.default)(this.props.className,mSe),style:this.props.style,ref:this.elementRef}):CP.createElement(e,xj({innerRef:this.elementRef},o,this.state))}},sy(t,"defaultProps",{measureBeforeMount:!1}),sy(t,"propTypes",{measureBeforeMount:lSe.default.bool}),t}});var Sj=Ie((EKe,Cg)=>{Cg.exports=mj().default;Cg.exports.utils=bg();Cg.exports.calculateUtils=aP();Cg.exports.Responsive=kK().default;Cg.exports.Responsive.utils=gj();Cg.exports.WidthProvider=CK().default});var ka,B0=L(()=>{ka=[{id:"pnlChart",name:"Cumulative P&L",description:"Line chart showing cumulative P&L over time",category:"performance",minSize:{w:4,h:5},defaultSize:{w:6,h:8}},{id:"performanceCalendar",name:"Performance Calendar",description:"Calendar view showing daily performance",category:"performance",minSize:{w:4,h:3},defaultSize:{w:6,h:4}},{id:"dailyPerformance",name:"Daily Performance",description:"Bar chart showing P&L for each trading day",category:"performance",minSize:{w:4,h:3},defaultSize:{w:6,h:4}},{id:"tradesChart",name:"Trades Chart",description:"Bar chart showing P&L for each individual trade",category:"performance",minSize:{w:4,h:3},defaultSize:{w:6,h:4}},{id:"drawdownChart",name:"Drawdown Chart",description:"Chart showing percentage drawdown from peak equity",category:"performance",minSize:{w:4,h:5},defaultSize:{w:6,h:8}},{id:"recentTrades",name:"Recent Trades",description:"Shows the 10 most recent trades with details",category:"journal",minSize:{w:2,h:3},defaultSize:{w:6,h:4},maxSize:{w:12,h:7}},{id:"rollingWinRate",name:"Rolling Win/Loss Ratio",description:"Shows the ratio of average wins to average losses over a rolling period",category:"analysis",minSize:{w:4,h:5},defaultSize:{w:6,h:8}},{id:"rollingStats",name:"Rolling Avg Win/Loss",description:"Shows average win and loss over a rolling period",category:"analysis",minSize:{w:4,h:5},defaultSize:{w:6,h:8}}]});function PK(){if($0===0){let e=document.createElement("style");e.id="dashboard-widget-skeleton-styles",e.textContent=gSe,document.head.appendChild(e)}$0++}function DK(){var e;$0--,$0<=0&&($0=0,(e=document.head.querySelector("#dashboard-widget-skeleton-styles"))==null||e.remove())}var gSe,$0,EK=L(()=>{gSe=`
.dashboard-widget-skeleton {
  width: 100%;
  padding: 1.5rem;
  background: var(--background-primary);
  border-radius: 8px;
}

.dashboard-widget-skeleton-chart {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.dashboard-widget-skeleton-table {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.skeleton-table-header,
.skeleton-table-row {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 1rem;
  padding: 0.5rem;
}

.skeleton-table-header {
  border-bottom: 1px solid var(--background-modifier-border);
  padding-bottom: 0.75rem;
}

.dashboard-widget-skeleton-calendar {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.skeleton-calendar-grid {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 0.5rem;
}

@media (max-width: 768px) {
  .dashboard-widget-skeleton {
    padding: 1rem;
  }

  .skeleton-calendar-grid {
    grid-template-columns: repeat(7, 1fr);
    gap: 0.25rem;
  }
}
`,$0=0});var Bo,Ad,PP=L(()=>{Bo=q(Y());mg();gg();EK();Kf();Ad=(0,Bo.memo)(({type:e})=>((0,Bo.useLayoutEffect)(()=>(Ll(),PK(),()=>{DK()}),[]),Bo.default.createElement("div",{className:"dashboard-widget-skeleton","aria-label":"Loading widget data"},(()=>{switch(e){case"chart":return Bo.default.createElement("div",{className:"dashboard-widget-skeleton-chart"},Bo.default.createElement(Kt,{width:"150px",height:"18px"}),Bo.default.createElement(Bi,{width:"100%",height:"300px",borderRadius:"8px"}));case"table":return Bo.default.createElement("div",{className:"dashboard-widget-skeleton-table"},Bo.default.createElement(Kt,{width:"150px",height:"18px"}),Bo.default.createElement("div",{className:"skeleton-table-header"},[1,2,3,4].map(r=>Bo.default.createElement(Kt,{key:r,width:"60px",height:"14px"}))),Array.from({length:5}).map((r,n)=>Bo.default.createElement("div",{key:n,className:"skeleton-table-row"},[1,2,3,4].map(o=>Bo.default.createElement(Kt,{key:o,width:"50px",height:"12px"})))));case"calendar":return Bo.default.createElement("div",{className:"dashboard-widget-skeleton-calendar"},Bo.default.createElement(Kt,{width:"150px",height:"18px"}),Bo.default.createElement("div",{className:"skeleton-calendar-grid"},Array.from({length:35}).map((r,n)=>Bo.default.createElement(Bi,{key:n,width:"100%",height:"40px",borderRadius:"4px"}))));default:return Bo.default.createElement(Bi,{width:"100%",height:"400px"})}})())));Ad.displayName="DashboardWidgetSkeleton"});var Ac,fi,Ru=L(()=>{Ac=q(Y());pt();wt();Td();Ed();jv();PP();fi=({filters:e,dateFormat:t,children:r})=>{let n=xe(),{dashboardData:o,isLoading:a,isStale:i,error:s,refreshData:l}=gm(),c=t||tr();return(0,Ac.useEffect)(()=>{(async()=>{try{let{ensureChartStyles:u}=await Promise.resolve().then(()=>(c0(),AO));u()}catch(u){console.error("Error loading chart styles:",u)}try{let{ensureSharedComponentStyles:u}=await Promise.resolve().then(()=>(d0(),mG));u()}catch(u){console.error("Error loading shared component styles:",u)}})()},[]),(0,Ac.useEffect)(()=>{let d=()=>{l()};return document.addEventListener("journalit:trade-data-changed",d),()=>{document.removeEventListener("journalit:trade-data-changed",d)}},[l]),Ac.default.createElement("div",{className:"journalit-dashboard-widget-container",style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}},a&&!o?Ac.default.createElement(Ad,{type:"chart"}):s?Ac.default.createElement("div",{className:"journalit-dashboard-widget-error",style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",textAlign:"center",padding:"16px",color:"var(--text-error)"}},(typeof s=="string"?s:s==null?void 0:s.message)||"Failed to load data"):!o||o.trades.length===0?Ac.default.createElement("div",{style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",position:"relative"}},Ac.default.createElement(et,{message:"No data available",subMessage:"Try adjusting your filter settings",iconSize:40,actionButtonText:"Add Trade",onActionButtonClick:()=>{if(!n||!n.app)return;new jo({app:n.app,plugin:n}).open()}})):Ac.default.createElement("div",{style:{width:"100%",height:"100%",overflow:"hidden",backgroundColor:"transparent",position:"relative"}},r(o,c),(i||a)&&Ac.default.createElement(zo,{message:"Loading...",size:"small",overlay:!0})))}});function IK(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(r=IK(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function mt(){for(var e,t,r=0,n="",o=arguments.length;r<o;r++)(e=arguments[r])&&(t=IK(e))&&(n&&(n+=" "),n+=t);return n}var Nn=L(()=>{});var AK=Ie(Tj=>{"use strict";Object.defineProperty(Tj,Symbol.toStringTag,{value:"Module"});function hSe(e){return e==="__proto__"}Tj.isUnsafeProperty=hSe});var Pj=Ie(Cj=>{"use strict";Object.defineProperty(Cj,Symbol.toStringTag,{value:"Module"});function vSe(e){switch(typeof e){case"number":case"symbol":return!1;case"string":return e.includes(".")||e.includes("[")||e.includes("]")}}Cj.isDeepKey=vSe});var Ej=Ie(Dj=>{"use strict";Object.defineProperty(Dj,Symbol.toStringTag,{value:"Module"});function ySe(e){var t;return typeof e=="string"||typeof e=="symbol"?e:Object.is((t=e==null?void 0:e.valueOf)==null?void 0:t.call(e),-0)?"-0":String(e)}Dj.toKey=ySe});var DP=Ie(Ij=>{"use strict";Object.defineProperty(Ij,Symbol.toStringTag,{value:"Module"});function bSe(e){let t=[],r=e.length;if(r===0)return t;let n=0,o="",a="",i=!1;for(e.charCodeAt(0)===46&&(t.push(""),n++);n<r;){let s=e[n];a?s==="\\"&&n+1<r?(n++,o+=e[n]):s===a?a="":o+=s:i?s==='"'||s==="'"?a=s:s==="]"?(i=!1,t.push(o),o=""):o+=s:s==="["?(i=!0,o&&(t.push(o),o="")):s==="."?o&&(t.push(o),o=""):o+=s,n++}return o&&t.push(o),t}Ij.toPath=bSe});var EP=Ie(Lj=>{"use strict";Object.defineProperty(Lj,Symbol.toStringTag,{value:"Module"});var Aj=AK(),xSe=Pj(),wSe=Ej(),kSe=DP();function LK(e,t,r){if(e==null)return r;switch(typeof t){case"string":{if(Aj.isUnsafeProperty(t))return r;let n=e[t];return n===void 0?xSe.isDeepKey(t)?LK(e,kSe.toPath(t),r):r:n}case"number":case"symbol":{typeof t=="number"&&(t=wSe.toKey(t));let n=e[t];return n===void 0?r:n}default:{if(Array.isArray(t))return SSe(e,t,r);if(Object.is(t==null?void 0:t.valueOf(),-0)?t="-0":t=String(t),Aj.isUnsafeProperty(t))return r;let n=e[t];return n===void 0?r:n}}}function SSe(e,t,r){if(t.length===0)return r;let n=e;for(let o=0;o<t.length;o++){if(n==null||Aj.isUnsafeProperty(t[o]))return r;n=n[t[o]]}return n===void 0?r:n}Lj.get=LK});var W0=Ie((JKe,NK)=>{NK.exports=EP().get});var FK=Ie(Yr=>{"use strict";var Nj=Symbol.for("react.element"),Mj=Symbol.for("react.portal"),IP=Symbol.for("react.fragment"),AP=Symbol.for("react.strict_mode"),LP=Symbol.for("react.profiler"),NP=Symbol.for("react.provider"),MP=Symbol.for("react.context"),TSe=Symbol.for("react.server_context"),FP=Symbol.for("react.forward_ref"),OP=Symbol.for("react.suspense"),jP=Symbol.for("react.suspense_list"),zP=Symbol.for("react.memo"),_P=Symbol.for("react.lazy"),CSe=Symbol.for("react.offscreen"),MK;MK=Symbol.for("react.module.reference");function jl(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case Nj:switch(e=e.type,e){case IP:case LP:case AP:case OP:case jP:return e;default:switch(e=e&&e.$$typeof,e){case TSe:case MP:case FP:case _P:case zP:case NP:return e;default:return t}}case Mj:return t}}}Yr.ContextConsumer=MP;Yr.ContextProvider=NP;Yr.Element=Nj;Yr.ForwardRef=FP;Yr.Fragment=IP;Yr.Lazy=_P;Yr.Memo=zP;Yr.Portal=Mj;Yr.Profiler=LP;Yr.StrictMode=AP;Yr.Suspense=OP;Yr.SuspenseList=jP;Yr.isAsyncMode=function(){return!1};Yr.isConcurrentMode=function(){return!1};Yr.isContextConsumer=function(e){return jl(e)===MP};Yr.isContextProvider=function(e){return jl(e)===NP};Yr.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===Nj};Yr.isForwardRef=function(e){return jl(e)===FP};Yr.isFragment=function(e){return jl(e)===IP};Yr.isLazy=function(e){return jl(e)===_P};Yr.isMemo=function(e){return jl(e)===zP};Yr.isPortal=function(e){return jl(e)===Mj};Yr.isProfiler=function(e){return jl(e)===LP};Yr.isStrictMode=function(e){return jl(e)===AP};Yr.isSuspense=function(e){return jl(e)===OP};Yr.isSuspenseList=function(e){return jl(e)===jP};Yr.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===IP||e===LP||e===AP||e===OP||e===jP||e===CSe||typeof e=="object"&&e!==null&&(e.$$typeof===_P||e.$$typeof===zP||e.$$typeof===NP||e.$$typeof===MP||e.$$typeof===FP||e.$$typeof===MK||e.getModuleId!==void 0)};Yr.typeOf=jl});var jK=Ie((QKe,OK)=>{"use strict";OK.exports=FK()});function Fr(e,t,r){return Re(e)&&Re(t)?e+r*(t-e):t}function $P(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):(0,zK.default)(n,t))===r)}var zK,To,Mn,BP,Re,Sa,PSe,Uu,gi,Fj,cr,Sm,nr=L(()=>{zK=q(W0()),To=e=>e===0?0:e>0?1:-1,Mn=e=>typeof e=="number"&&e!=+e,BP=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,Re=e=>(typeof e=="number"||e instanceof Number)&&!Mn(e),Sa=e=>Re(e)||typeof e=="string",PSe=0,Uu=e=>{var t=++PSe;return"".concat(e||"").concat(t)},gi=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Re(t)&&typeof t!="string")return n;var a;if(BP(t)){if(r==null)return n;var i=t.indexOf("%");a=r*parseFloat(t.slice(0,i))/100}else a=+t;return Mn(a)&&(a=n),o&&r!=null&&a>r&&(a=r),a},Fj=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[e[n]])r[e[n]]=!0;else return!0;return!1};cr=e=>e===null||typeof e=="undefined",Sm=e=>cr(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1))});function R0(e){if(typeof e!="string")return!1;var t=DSe;return t.includes(e)}var DSe,Oj=L(()=>{DSe=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"]});var BK,ESe,_K,WP,ly,ISe,Pg,Tm=L(()=>{BK=q(Y());Oj();ESe=["viewBox","children"],_K=["points","pathLength"],WP={svg:ESe,polygon:_K,polyline:_K},ly=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if((0,BK.isValidElement)(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(o=>{R0(o)&&(n[o]=t||(a=>r[o](r,a)))}),n},ISe=(e,t,r)=>n=>(e(t,r,n),null),Pg=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(o=>{var a=e[o];R0(o)&&typeof a=="function"&&(n||(n={}),n[o]=ISe(a,t,r))}),n}});function jj(e){if(typeof e!="string")return!1;var t=ASe;return t.includes(e)}function Ga(e){var t=Object.entries(e).filter(r=>{var[n]=r;return jj(n)});return Object.fromEntries(t)}var ASe,Ld=L(()=>{ASe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"]});function VK(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(o=>$K(o)):n=[$K(t)],UK(e).forEach(o=>{var a=(0,_j.default)(o,"type.displayName")||(0,_j.default)(o,"type.name");n.indexOf(a)!==-1&&r.push(o)}),r}var _j,RP,RK,$K,WK,zj,UK,cy,LSe,Wt,Ta=L(()=>{_j=q(W0()),RP=q(Y()),RK=q(jK());nr();Tm();Oj();Ld();$K=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",WK=null,zj=null,UK=e=>{if(e===WK&&Array.isArray(zj))return zj;var t=[];return RP.Children.forEach(e,r=>{cr(r)||((0,RK.isFragment)(r)?t=t.concat(UK(r.props.children)):t.push(r))}),zj=t,WK=e,t};cy=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,LSe=(e,t,r,n)=>{var o;if(typeof t=="symbol"||typeof t=="number")return!0;var a=(o=n&&(WP===null||WP===void 0?void 0:WP[n]))!==null&&o!==void 0?o:[],i=t.startsWith("data-"),s=typeof e!="function"&&(!!n&&a.includes(t)||jj(t)),l=!!r&&R0(t);return i||s||l},Wt=(e,t,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if((0,RP.isValidElement)(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var o={};return Object.keys(n).forEach(a=>{var i;LSe((i=n)===null||i===void 0?void 0:i[a],a,t,r)&&(o[a]=n[a])}),o}});function Bj(){return Bj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Bj.apply(null,arguments)}function MSe(e,t){if(e==null)return{};var r,n,o=FSe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function FSe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var UP,HK,NSe,U0,$j=L(()=>{UP=q(Y()),HK=q(Y());Nn();Ta();NSe=["children","width","height","viewBox","className","style","title","desc"];U0=(0,HK.forwardRef)((e,t)=>{var{children:r,width:n,height:o,viewBox:a,className:i,style:s,title:l,desc:c}=e,d=MSe(e,NSe),u=a||{width:n,height:o,x:0,y:0},p=mt("recharts-surface",i);return UP.createElement("svg",Bj({},Wt(d,!0,"svg"),{className:p,width:n,height:o,style:s,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height),ref:t}),UP.createElement("title",null,l),UP.createElement("desc",null,c),r)})});function Wj(){return Wj=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Wj.apply(null,arguments)}function jSe(e,t){if(e==null)return{};var r,n,o=zSe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function zSe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var VP,OSe,Sn,Vu=L(()=>{VP=q(Y());Nn();Ta();OSe=["children","className"];Sn=VP.forwardRef((e,t)=>{var{children:r,className:n}=e,o=jSe(e,OSe),a=mt("recharts-layer",n);return VP.createElement("g",Wj({className:a},Wt(o,!0),{ref:t}),r)})});var HP,Rj,qK,Uj=L(()=>{HP=q(Y()),Rj=(0,HP.createContext)(null),qK=()=>(0,HP.useContext)(Rj)});function Ur(e){return function(){return e}}var V0=L(()=>{});var Vj,H0,Ca,Dg,v7e,dy,Cm=L(()=>{Vj=Math.cos,H0=Math.sin,Ca=Math.sqrt,Dg=Math.PI,v7e=Dg/2,dy=2*Dg});function GK(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function BSe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return GK;let r=10**t;return function(n){this._+=n[0];for(let o=1,a=n.length;o<a;++o)this._+=Math.round(arguments[o]*r)/r+n[o]}}function YK(){return new Ig}var Hj,qj,Eg,_Se,Ig,KK=L(()=>{Hj=Math.PI,qj=2*Hj,Eg=1e-6,_Se=qj-Eg;Ig=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?GK:BSe(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,o){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+o}`}bezierCurveTo(t,r,n,o,a,i){this._append`C${+t},${+r},${+n},${+o},${this._x1=+a},${this._y1=+i}`}arcTo(t,r,n,o,a){if(t=+t,r=+r,n=+n,o=+o,a=+a,a<0)throw new Error(`negative radius: ${a}`);let i=this._x1,s=this._y1,l=n-t,c=o-r,d=i-t,u=s-r,p=d*d+u*u;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(p>Eg)if(!(Math.abs(u*l-c*d)>Eg)||!a)this._append`L${this._x1=t},${this._y1=r}`;else{let m=n-i,f=o-s,g=l*l+c*c,v=m*m+f*f,h=Math.sqrt(g),y=Math.sqrt(p),b=a*Math.tan((Hj-Math.acos((g+p-v)/(2*h*y)))/2),x=b/y,w=b/h;Math.abs(x-1)>Eg&&this._append`L${t+x*d},${r+x*u}`,this._append`A${a},${a},0,0,${+(u*m>d*f)},${this._x1=t+w*l},${this._y1=r+w*c}`}}arc(t,r,n,o,a,i){if(t=+t,r=+r,n=+n,i=!!i,n<0)throw new Error(`negative radius: ${n}`);let s=n*Math.cos(o),l=n*Math.sin(o),c=t+s,d=r+l,u=1^i,p=i?o-a:a-o;this._x1===null?this._append`M${c},${d}`:(Math.abs(this._x1-c)>Eg||Math.abs(this._y1-d)>Eg)&&this._append`L${c},${d}`,n&&(p<0&&(p=p%qj+qj),p>_Se?this._append`A${n},${n},0,1,${u},${t-s},${r-l}A${n},${n},0,1,${u},${this._x1=c},${this._y1=d}`:p>Eg&&this._append`A${n},${n},0,${+(p>=Hj)},${u},${this._x1=t+n*Math.cos(a)},${this._y1=r+n*Math.sin(a)}`)}rect(t,r,n,o){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+o}h${-n}Z`}toString(){return this._}};YK.prototype=Ig.prototype});var JK=L(()=>{KK()});function uy(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{let n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new Ig(t)}var qP=L(()=>{JK()});function py(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}var C7e,GP=L(()=>{C7e=Array.prototype.slice});function XK(e){this._context=e}function Pm(e){return new XK(e)}var YP=L(()=>{XK.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}}});function KP(e){return e[0]}function JP(e){return e[1]}var Gj=L(()=>{});function q0(e,t){var r=Ur(!0),n=null,o=Pm,a=null,i=uy(s);e=typeof e=="function"?e:e===void 0?KP:Ur(e),t=typeof t=="function"?t:t===void 0?JP:Ur(t);function s(l){var c,d=(l=py(l)).length,u,p=!1,m;for(n==null&&(a=o(m=i())),c=0;c<=d;++c)!(c<d&&r(u=l[c],c,l))===p&&((p=!p)?a.lineStart():a.lineEnd()),p&&a.point(+e(u,c,l),+t(u,c,l));if(m)return a=null,m+""||null}return s.x=function(l){return arguments.length?(e=typeof l=="function"?l:Ur(+l),s):e},s.y=function(l){return arguments.length?(t=typeof l=="function"?l:Ur(+l),s):t},s.defined=function(l){return arguments.length?(r=typeof l=="function"?l:Ur(!!l),s):r},s.curve=function(l){return arguments.length?(o=l,n!=null&&(a=o(n)),s):o},s.context=function(l){return arguments.length?(l==null?n=a=null:a=o(n=l),s):n},s}var Yj=L(()=>{GP();V0();YP();qP();Gj()});function my(e,t,r){var n=null,o=Ur(!0),a=null,i=Pm,s=null,l=uy(c);e=typeof e=="function"?e:e===void 0?KP:Ur(+e),t=typeof t=="function"?t:t===void 0?Ur(0):Ur(+t),r=typeof r=="function"?r:r===void 0?JP:Ur(+r);function c(u){var p,m,f,g=(u=py(u)).length,v,h=!1,y,b=new Array(g),x=new Array(g);for(a==null&&(s=i(y=l())),p=0;p<=g;++p){if(!(p<g&&o(v=u[p],p,u))===h)if(h=!h)m=p,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),f=p-1;f>=m;--f)s.point(b[f],x[f]);s.lineEnd(),s.areaEnd()}h&&(b[p]=+e(v,p,u),x[p]=+t(v,p,u),s.point(n?+n(v,p,u):b[p],r?+r(v,p,u):x[p]))}if(y)return s=null,y+""||null}function d(){return q0().defined(o).curve(i).context(a)}return c.x=function(u){return arguments.length?(e=typeof u=="function"?u:Ur(+u),n=null,c):e},c.x0=function(u){return arguments.length?(e=typeof u=="function"?u:Ur(+u),c):e},c.x1=function(u){return arguments.length?(n=u==null?null:typeof u=="function"?u:Ur(+u),c):n},c.y=function(u){return arguments.length?(t=typeof u=="function"?u:Ur(+u),r=null,c):t},c.y0=function(u){return arguments.length?(t=typeof u=="function"?u:Ur(+u),c):t},c.y1=function(u){return arguments.length?(r=u==null?null:typeof u=="function"?u:Ur(+u),c):r},c.lineX0=c.lineY0=function(){return d().x(e).y(t)},c.lineY1=function(){return d().x(e).y(r)},c.lineX1=function(){return d().x(n).y(t)},c.defined=function(u){return arguments.length?(o=typeof u=="function"?u:Ur(!!u),c):o},c.curve=function(u){return arguments.length?(i=u,a!=null&&(s=i(a)),c):i},c.context=function(u){return arguments.length?(u==null?a=s=null:s=i(a=u),c):a},c}var QK=L(()=>{GP();V0();YP();Yj();qP();Gj()});function Kj(e){return new XP(e,!0)}function Jj(e){return new XP(e,!1)}var XP,ZK=L(()=>{XP=class{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}});var fy,Xj=L(()=>{Cm();fy={draw(e,t){let r=Ca(t/Dg);e.moveTo(r,0),e.arc(0,0,r,0,dy)}}});var Qj,e7=L(()=>{Cm();Qj={draw(e,t){let r=Ca(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}}});var t7,$Se,Zj,r7=L(()=>{Cm();t7=Ca(1/3),$Se=t7*2,Zj={draw(e,t){let r=Ca(t/$Se),n=r*t7;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}}});var ez,n7=L(()=>{Cm();ez={draw(e,t){let r=Ca(t),n=-r/2;e.rect(n,n,r,r)}}});var WSe,o7,RSe,USe,tz,a7=L(()=>{Cm();WSe=.8908130915292852,o7=H0(Dg/10)/H0(7*Dg/10),RSe=H0(dy/10)*o7,USe=-Vj(dy/10)*o7,tz={draw(e,t){let r=Ca(t*WSe),n=RSe*r,o=USe*r;e.moveTo(0,-r),e.lineTo(n,o);for(let a=1;a<5;++a){let i=dy*a/5,s=Vj(i),l=H0(i);e.lineTo(l*r,-s*r),e.lineTo(s*n-l*o,l*n+s*o)}e.closePath()}}});var rz,nz,i7=L(()=>{Cm();rz=Ca(3),nz={draw(e,t){let r=-Ca(t/(rz*3));e.moveTo(0,r*2),e.lineTo(-rz*r,-r),e.lineTo(rz*r,-r),e.closePath()}}});var zl,_l,oz,VSe,az,s7=L(()=>{Cm();zl=-.5,_l=Ca(3)/2,oz=1/Ca(12),VSe=(oz/2+1)*3,az={draw(e,t){let r=Ca(t/VSe),n=r/2,o=r*oz,a=n,i=r*oz+r,s=-a,l=i;e.moveTo(n,o),e.lineTo(a,i),e.lineTo(s,l),e.lineTo(zl*n-_l*o,_l*n+zl*o),e.lineTo(zl*a-_l*i,_l*a+zl*i),e.lineTo(zl*s-_l*l,_l*s+zl*l),e.lineTo(zl*n+_l*o,zl*o-_l*n),e.lineTo(zl*a+_l*i,zl*i-_l*a),e.lineTo(zl*s+_l*l,zl*l-_l*s),e.closePath()}}});function QP(e,t){let r=null,n=uy(o);e=typeof e=="function"?e:Ur(e||fy),t=typeof t=="function"?t:Ur(t===void 0?64:+t);function o(){let a;if(r||(r=a=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),a)return r=null,a+""||null}return o.type=function(a){return arguments.length?(e=typeof a=="function"?a:Ur(a),o):e},o.size=function(a){return arguments.length?(t=typeof a=="function"?a:Ur(+a),o):t},o.context=function(a){return arguments.length?(r=a==null?null:a,o):r},o}var l7=L(()=>{V0();qP();Xj()});function gy(){}var iz=L(()=>{});function hy(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function c7(e){this._context=e}function sz(e){return new c7(e)}var ZP=L(()=>{c7.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:hy(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:hy(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}}});function d7(e){this._context=e}function lz(e){return new d7(e)}var u7=L(()=>{iz();ZP();d7.prototype={areaStart:gy,areaEnd:gy,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:hy(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}}});function p7(e){this._context=e}function cz(e){return new p7(e)}var m7=L(()=>{ZP();p7.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:hy(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}}});function f7(e){this._context=e}function dz(e){return new f7(e)}var g7=L(()=>{iz();f7.prototype={areaStart:gy,areaEnd:gy,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}}});function h7(e){return e<0?-1:1}function v7(e,t,r){var n=e._x1-e._x0,o=t-e._x1,a=(e._y1-e._y0)/(n||o<0&&-0),i=(r-e._y1)/(o||n<0&&-0),s=(a*o+i*n)/(n+o);return(h7(a)+h7(i))*Math.min(Math.abs(a),Math.abs(i),.5*Math.abs(s))||0}function y7(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function uz(e,t,r){var n=e._x0,o=e._y0,a=e._x1,i=e._y1,s=(a-n)/3;e._context.bezierCurveTo(n+s,o+s*t,a-s,i-s*r,a,i)}function eD(e){this._context=e}function b7(e){this._context=new x7(e)}function x7(e){this._context=e}function pz(e){return new eD(e)}function mz(e){return new b7(e)}var w7=L(()=>{eD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:uz(this,this._t0,y7(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,uz(this,y7(this,r=v7(this,e,t)),r);break;default:uz(this,this._t0,r=v7(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};(b7.prototype=Object.create(eD.prototype)).point=function(e,t){eD.prototype.point.call(this,t,e)};x7.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,o,a){this._context.bezierCurveTo(t,e,n,r,a,o)}}});function S7(e){this._context=e}function k7(e){var t,r=e.length-1,n,o=new Array(r),a=new Array(r),i=new Array(r);for(o[0]=0,a[0]=2,i[0]=e[0]+2*e[1],t=1;t<r-1;++t)o[t]=1,a[t]=4,i[t]=4*e[t]+2*e[t+1];for(o[r-1]=2,a[r-1]=7,i[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=o[t]/a[t-1],a[t]-=n,i[t]-=n*i[t-1];for(o[r-1]=i[r-1]/a[r-1],t=r-2;t>=0;--t)o[t]=(i[t]-o[t+1])/a[t];for(a[r-1]=(e[r]+o[r-1])/2,t=0;t<r-1;++t)a[t]=2*e[t+1]-o[t+1];return[o,a]}function fz(e){return new S7(e)}var T7=L(()=>{S7.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=k7(e),o=k7(t),a=0,i=1;i<r;++a,++i)this._context.bezierCurveTo(n[0][a],o[0][a],n[1][a],o[1][a],e[i],t[i]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}}});function tD(e,t){this._context=e,this._t=t}function gz(e){return new tD(e,.5)}function hz(e){return new tD(e,0)}function vz(e){return new tD(e,1)}var C7=L(()=>{tD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}}});function Bl(e,t){if((i=e.length)>1)for(var r=1,n,o,a=e[t[0]],i,s=a.length;r<i;++r)for(o=a,a=e[t[r]],n=0;n<s;++n)a[n][1]+=a[n][0]=isNaN(o[n][1])?o[n][0]:o[n][1]}var vy=L(()=>{});function yy(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}var yz=L(()=>{});function HSe(e,t){return e[t]}function qSe(e){let t=[];return t.key=e,t}function bz(){var e=Ur([]),t=yy,r=Bl,n=HSe;function o(a){var i=Array.from(e.apply(this,arguments),qSe),s,l=i.length,c=-1,d;for(let u of a)for(s=0,++c;s<l;++s)(i[s][c]=[0,+n(u,i[s].key,c,a)]).data=u;for(s=0,d=py(t(i));s<l;++s)i[d[s]].index=s;return r(i,d),i}return o.keys=function(a){return arguments.length?(e=typeof a=="function"?a:Ur(Array.from(a)),o):e},o.value=function(a){return arguments.length?(n=typeof a=="function"?a:Ur(+a),o):n},o.order=function(a){return arguments.length?(t=a==null?yy:typeof a=="function"?a:Ur(Array.from(a)),o):t},o.offset=function(a){return arguments.length?(r=a==null?Bl:a,o):r},o}var P7=L(()=>{GP();V0();vy();yz()});function xz(e,t){if((n=e.length)>0){for(var r,n,o=0,a=e[0].length,i;o<a;++o){for(i=r=0;r<n;++r)i+=e[r][o][1]||0;if(i)for(r=0;r<n;++r)e[r][o][1]/=i}Bl(e,t)}}var D7=L(()=>{vy()});function wz(e,t){if((o=e.length)>0){for(var r=0,n=e[t[0]],o,a=n.length;r<a;++r){for(var i=0,s=0;i<o;++i)s+=e[i][r][1]||0;n[r][1]+=n[r][0]=-s/2}Bl(e,t)}}var E7=L(()=>{vy()});function kz(e,t){if(!(!((i=e.length)>0)||!((a=(o=e[t[0]]).length)>0))){for(var r=0,n=1,o,a,i;n<a;++n){for(var s=0,l=0,c=0;s<i;++s){for(var d=e[t[s]],u=d[n][1]||0,p=d[n-1][1]||0,m=(u-p)/2,f=0;f<s;++f){var g=e[t[f]],v=g[n][1]||0,h=g[n-1][1]||0;m+=v-h}l+=u,c+=m*u}o[n-1][1]+=o[n-1][0]=r,l&&(r-=c/l)}o[n-1][1]+=o[n-1][0]=r,Bl(e,t)}}var I7=L(()=>{vy()});var A7=L(()=>{QK();Yj();l7();Xj();e7();r7();n7();a7();i7();s7();u7();m7();ZP();ZK();g7();YP();w7();T7();C7();P7();D7();vy();E7();I7();yz()});var rD=L(()=>{A7()});function Sz(){return Sz=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Sz.apply(null,arguments)}function L7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function N7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?L7(Object(r),!0).forEach(function(n){KSe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KSe(e,t,r){return(t=JSe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JSe(e){var t=XSe(e,"string");return typeof t=="symbol"?t:t+""}function XSe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function QSe(e,t){if(e==null)return{};var r,n,o=ZSe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function ZSe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var M7,YSe,F7,eTe,tTe,rTe,nTe,G0,Tz=L(()=>{M7=q(Y());rD();Nn();Ta();nr();YSe=["type","size","sizeType"];F7={symbolCircle:fy,symbolCross:Qj,symbolDiamond:Zj,symbolSquare:ez,symbolStar:tz,symbolTriangle:nz,symbolWye:az},eTe=Math.PI/180,tTe=e=>{var t="symbol".concat(Sm(e));return F7[t]||fy},rTe=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*eTe;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},nTe=(e,t)=>{F7["symbol".concat(Sm(e))]=t},G0=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,o=QSe(e,YSe),a=N7(N7({},o),{},{type:t,size:r,sizeType:n}),i="circle";typeof t=="string"&&(i=t);var s=()=>{var p=tTe(i),m=QP().type(p).size(rTe(r,n,i));return m()},{className:l,cx:c,cy:d}=a,u=Wt(a,!0);return c===+c&&d===+d&&r===+r?M7.createElement("path",Sz({},u,{className:mt("recharts-symbols",l),transform:"translate(".concat(c,", ").concat(d,")"),d:s()})):null};G0.registerSymbol=nTe});function Cz(){return Cz=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cz.apply(null,arguments)}function O7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function oTe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O7(Object(r),!0).forEach(function(n){Pz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Pz(e,t,r){return(t=aTe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aTe(e){var t=iTe(e,"string");return typeof t=="symbol"?t:t+""}function iTe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ks,j7,$l,by,z7=L(()=>{Ks=q(Y()),j7=q(Y());Nn();$j();Tz();Tm();$l=32,by=class extends j7.PureComponent{renderIcon(t,r){var{inactiveColor:n}=this.props,o=$l/2,a=$l/6,i=$l/3,s=t.inactive?n:t.color,l=r!=null?r:t.type;if(l==="none")return null;if(l==="plainline")return Ks.createElement("line",{strokeWidth:4,fill:"none",stroke:s,strokeDasharray:t.payload.strokeDasharray,x1:0,y1:o,x2:$l,y2:o,className:"recharts-legend-icon"});if(l==="line")return Ks.createElement("path",{strokeWidth:4,fill:"none",stroke:s,d:"M0,".concat(o,"h").concat(i,`
            A`).concat(a,",").concat(a,",0,1,1,").concat(2*i,",").concat(o,`
            H`).concat($l,"M").concat(2*i,",").concat(o,`
            A`).concat(a,",").concat(a,",0,1,1,").concat(i,",").concat(o),className:"recharts-legend-icon"});if(l==="rect")return Ks.createElement("path",{stroke:"none",fill:s,d:"M0,".concat($l/8,"h").concat($l,"v").concat($l*3/4,"h").concat(-$l,"z"),className:"recharts-legend-icon"});if(Ks.isValidElement(t.legendIcon)){var c=oTe({},t);return delete c.legendIcon,Ks.cloneElement(t.legendIcon,c)}return Ks.createElement(G0,{fill:s,cx:o,cy:o,size:$l,sizeType:"diameter",type:l})}renderItems(){var{payload:t,iconSize:r,layout:n,formatter:o,inactiveColor:a,iconType:i}=this.props,s={x:0,y:0,width:$l,height:$l},l={display:n==="horizontal"?"inline-block":"block",marginRight:10},c={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((d,u)=>{var p=d.formatter||o,m=mt({"recharts-legend-item":!0,["legend-item-".concat(u)]:!0,inactive:d.inactive});if(d.type==="none")return null;var f=d.inactive?a:d.color,g=p?p(d.value,d,u):d.value;return Ks.createElement("li",Cz({className:m,style:l,key:"legend-item-".concat(u)},Pg(this.props,d,u)),Ks.createElement(U0,{width:r,height:r,viewBox:s,style:c,"aria-label":"".concat(g," legend icon")},this.renderIcon(d,i)),Ks.createElement("span",{className:"recharts-legend-item-text",style:{color:f}},g))})}render(){var{payload:t,layout:r,align:n}=this.props;if(!t||!t.length)return null;var o={padding:0,margin:0,textAlign:r==="horizontal"?n:"left"};return Ks.createElement("ul",{className:"recharts-default-legend",style:o},this.renderItems())}};Pz(by,"displayName","Legend");Pz(by,"defaultProps",{align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"})});var _7=Ie(Dz=>{"use strict";Object.defineProperty(Dz,Symbol.toStringTag,{value:"Module"});function sTe(e,t){let r=new Map;for(let n=0;n<e.length;n++){let o=e[n],a=t(o);r.has(a)||r.set(a,o)}return Array.from(r.values())}Dz.uniqBy=sTe});var Iz=Ie(Ez=>{"use strict";Object.defineProperty(Ez,Symbol.toStringTag,{value:"Module"});function lTe(e){return e}Ez.identity=lTe});var B7=Ie(Az=>{"use strict";Object.defineProperty(Az,Symbol.toStringTag,{value:"Module"});function cTe(e){return Number.isSafeInteger(e)&&e>=0}Az.isLength=cTe});var nD=Ie(Lz=>{"use strict";Object.defineProperty(Lz,Symbol.toStringTag,{value:"Module"});var dTe=B7();function uTe(e){return e!=null&&typeof e!="function"&&dTe.isLength(e.length)}Lz.isArrayLike=uTe});var $7=Ie(Nz=>{"use strict";Object.defineProperty(Nz,Symbol.toStringTag,{value:"Module"});function pTe(e){return typeof e=="object"&&e!==null}Nz.isObjectLike=pTe});var W7=Ie(Mz=>{"use strict";Object.defineProperty(Mz,Symbol.toStringTag,{value:"Module"});var mTe=nD(),fTe=$7();function gTe(e){return fTe.isObjectLike(e)&&mTe.isArrayLike(e)}Mz.isArrayLikeObject=gTe});var R7=Ie(Fz=>{"use strict";Object.defineProperty(Fz,Symbol.toStringTag,{value:"Module"});var hTe=EP();function vTe(e){return function(t){return hTe.get(t,e)}}Fz.property=vTe});var jz=Ie(Oz=>{"use strict";Object.defineProperty(Oz,Symbol.toStringTag,{value:"Module"});function yTe(e){return e!==null&&(typeof e=="object"||typeof e=="function")}Oz.isObject=yTe});var _z=Ie(zz=>{"use strict";Object.defineProperty(zz,Symbol.toStringTag,{value:"Module"});function bTe(e){return e==null||typeof e!="object"&&typeof e!="function"}zz.isPrimitive=bTe});var $z=Ie(Bz=>{"use strict";Object.defineProperty(Bz,Symbol.toStringTag,{value:"Module"});function xTe(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}Bz.eq=xTe});var q7=Ie(oD=>{"use strict";Object.defineProperty(oD,Symbol.toStringTag,{value:"Module"});var wTe=aD(),kTe=jz(),STe=_z(),U7=$z();function TTe(e,t,r){return typeof r!="function"?wTe.isMatch(e,t):Wz(e,t,function n(o,a,i,s,l,c){let d=r(o,a,i,s,l,c);return d!==void 0?!!d:Wz(o,a,n,c)},new Map)}function Wz(e,t,r,n){if(t===e)return!0;switch(typeof t){case"object":return CTe(e,t,r,n);case"function":return Object.keys(t).length>0?Wz(e,{...t},r,n):U7.eq(e,t);default:return kTe.isObject(e)?typeof t=="string"?t==="":!0:U7.eq(e,t)}}function CTe(e,t,r,n){if(t==null)return!0;if(Array.isArray(t))return V7(e,t,r,n);if(t instanceof Map)return PTe(e,t,r,n);if(t instanceof Set)return H7(e,t,r,n);let o=Object.keys(t);if(e==null)return o.length===0;if(o.length===0)return!0;if(n&&n.has(t))return n.get(t)===e;n&&n.set(t,e);try{for(let a=0;a<o.length;a++){let i=o[a];if(!STe.isPrimitive(e)&&!(i in e)||t[i]===void 0&&e[i]!==void 0||t[i]===null&&e[i]!==null||!r(e[i],t[i],i,e,t,n))return!1}return!0}finally{n&&n.delete(t)}}function PTe(e,t,r,n){if(t.size===0)return!0;if(!(e instanceof Map))return!1;for(let[o,a]of t.entries()){let i=e.get(o);if(r(i,a,o,e,t,n)===!1)return!1}return!0}function V7(e,t,r,n){if(t.length===0)return!0;if(!Array.isArray(e))return!1;let o=new Set;for(let a=0;a<t.length;a++){let i=t[a],s=!1;for(let l=0;l<e.length;l++){if(o.has(l))continue;let c=e[l],d=!1;if(r(c,i,a,e,t,n)&&(d=!0),d){o.add(l),s=!0;break}}if(!s)return!1}return!0}function H7(e,t,r,n){return t.size===0?!0:e instanceof Set?V7([...e],[...t],r,n):!1}oD.isMatchWith=TTe;oD.isSetMatch=H7});var aD=Ie(Rz=>{"use strict";Object.defineProperty(Rz,Symbol.toStringTag,{value:"Module"});var DTe=q7();function ETe(e,t){return DTe.isMatchWith(e,t,()=>{})}Rz.isMatch=ETe});var G7=Ie(Uz=>{"use strict";Object.defineProperty(Uz,Symbol.toStringTag,{value:"Module"});function ITe(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}Uz.getSymbols=ITe});var Hz=Ie(Vz=>{"use strict";Object.defineProperty(Vz,Symbol.toStringTag,{value:"Module"});function ATe(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}Vz.getTag=ATe});var qz=Ie(Qr=>{"use strict";Object.defineProperty(Qr,Symbol.toStringTag,{value:"Module"});var LTe="[object RegExp]",NTe="[object String]",MTe="[object Number]",FTe="[object Boolean]",OTe="[object Arguments]",jTe="[object Symbol]",zTe="[object Date]",_Te="[object Map]",BTe="[object Set]",$Te="[object Array]",WTe="[object Function]",RTe="[object ArrayBuffer]",UTe="[object Object]",VTe="[object Error]",HTe="[object DataView]",qTe="[object Uint8Array]",GTe="[object Uint8ClampedArray]",YTe="[object Uint16Array]",KTe="[object Uint32Array]",JTe="[object BigUint64Array]",XTe="[object Int8Array]",QTe="[object Int16Array]",ZTe="[object Int32Array]",eCe="[object BigInt64Array]",tCe="[object Float32Array]",rCe="[object Float64Array]";Qr.argumentsTag=OTe;Qr.arrayBufferTag=RTe;Qr.arrayTag=$Te;Qr.bigInt64ArrayTag=eCe;Qr.bigUint64ArrayTag=JTe;Qr.booleanTag=FTe;Qr.dataViewTag=HTe;Qr.dateTag=zTe;Qr.errorTag=VTe;Qr.float32ArrayTag=tCe;Qr.float64ArrayTag=rCe;Qr.functionTag=WTe;Qr.int16ArrayTag=QTe;Qr.int32ArrayTag=ZTe;Qr.int8ArrayTag=XTe;Qr.mapTag=_Te;Qr.numberTag=MTe;Qr.objectTag=UTe;Qr.regexpTag=LTe;Qr.setTag=BTe;Qr.stringTag=NTe;Qr.symbolTag=jTe;Qr.uint16ArrayTag=YTe;Qr.uint32ArrayTag=KTe;Qr.uint8ArrayTag=qTe;Qr.uint8ClampedArrayTag=GTe});var Y7=Ie(Gz=>{"use strict";Object.defineProperty(Gz,Symbol.toStringTag,{value:"Module"});function nCe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}Gz.isTypedArray=nCe});var Yz=Ie(Y0=>{"use strict";Object.defineProperty(Y0,Symbol.toStringTag,{value:"Module"});var oCe=G7(),aCe=Hz(),po=qz(),iCe=_z(),sCe=Y7();function lCe(e,t){return Ag(e,void 0,e,new Map,t)}function Ag(e,t,r,n=new Map,o=void 0){let a=o==null?void 0:o(e,t,r,n);if(a!=null)return a;if(iCe.isPrimitive(e))return e;if(n.has(e))return n.get(e);if(Array.isArray(e)){let i=new Array(e.length);n.set(e,i);for(let s=0;s<e.length;s++)i[s]=Ag(e[s],s,r,n,o);return Object.hasOwn(e,"index")&&(i.index=e.index),Object.hasOwn(e,"input")&&(i.input=e.input),i}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){let i=new RegExp(e.source,e.flags);return i.lastIndex=e.lastIndex,i}if(e instanceof Map){let i=new Map;n.set(e,i);for(let[s,l]of e)i.set(s,Ag(l,s,r,n,o));return i}if(e instanceof Set){let i=new Set;n.set(e,i);for(let s of e)i.add(Ag(s,void 0,r,n,o));return i}if(typeof Buffer!="undefined"&&Buffer.isBuffer(e))return e.subarray();if(sCe.isTypedArray(e)){let i=new(Object.getPrototypeOf(e)).constructor(e.length);n.set(e,i);for(let s=0;s<e.length;s++)i[s]=Ag(e[s],s,r,n,o);return i}if(e instanceof ArrayBuffer||typeof SharedArrayBuffer!="undefined"&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){let i=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return n.set(e,i),xy(i,e,r,n,o),i}if(typeof File!="undefined"&&e instanceof File){let i=new File([e],e.name,{type:e.type});return n.set(e,i),xy(i,e,r,n,o),i}if(e instanceof Blob){let i=new Blob([e],{type:e.type});return n.set(e,i),xy(i,e,r,n,o),i}if(e instanceof Error){let i=new e.constructor;return n.set(e,i),i.message=e.message,i.name=e.name,i.stack=e.stack,i.cause=e.cause,xy(i,e,r,n,o),i}if(typeof e=="object"&&cCe(e)){let i=Object.create(Object.getPrototypeOf(e));return n.set(e,i),xy(i,e,r,n,o),i}return e}function xy(e,t,r=e,n,o){let a=[...Object.keys(t),...oCe.getSymbols(t)];for(let i=0;i<a.length;i++){let s=a[i],l=Object.getOwnPropertyDescriptor(e,s);(l==null||l.writable)&&(e[s]=Ag(t[s],s,r,n,o))}}function cCe(e){switch(aCe.getTag(e)){case po.argumentsTag:case po.arrayTag:case po.arrayBufferTag:case po.dataViewTag:case po.booleanTag:case po.dateTag:case po.float32ArrayTag:case po.float64ArrayTag:case po.int8ArrayTag:case po.int16ArrayTag:case po.int32ArrayTag:case po.mapTag:case po.numberTag:case po.objectTag:case po.regexpTag:case po.setTag:case po.stringTag:case po.symbolTag:case po.uint8ArrayTag:case po.uint8ClampedArrayTag:case po.uint16ArrayTag:case po.uint32ArrayTag:return!0;default:return!1}}Y0.cloneDeepWith=lCe;Y0.cloneDeepWithImpl=Ag;Y0.copyProperties=xy});var K7=Ie(Kz=>{"use strict";Object.defineProperty(Kz,Symbol.toStringTag,{value:"Module"});var dCe=Yz();function uCe(e){return dCe.cloneDeepWithImpl(e,void 0,e,new Map,void 0)}Kz.cloneDeep=uCe});var J7=Ie(Jz=>{"use strict";Object.defineProperty(Jz,Symbol.toStringTag,{value:"Module"});var pCe=aD(),mCe=K7();function fCe(e){return e=mCe.cloneDeep(e),t=>pCe.isMatch(t,e)}Jz.matches=fCe});var X7=Ie(Qz=>{"use strict";Object.defineProperty(Qz,Symbol.toStringTag,{value:"Module"});var Xz=Yz(),iD=qz();function gCe(e,t){return Xz.cloneDeepWith(e,(r,n,o,a)=>{let i=t==null?void 0:t(r,n,o,a);if(i!=null)return i;if(typeof e=="object")switch(Object.prototype.toString.call(e)){case iD.numberTag:case iD.stringTag:case iD.booleanTag:{let s=new e.constructor(e==null?void 0:e.valueOf());return Xz.copyProperties(s,e),s}case iD.argumentsTag:{let s={};return Xz.copyProperties(s,e),s.length=e.length,s[Symbol.iterator]=e[Symbol.iterator],s}default:return}})}Qz.cloneDeepWith=gCe});var Q7=Ie(Zz=>{"use strict";Object.defineProperty(Zz,Symbol.toStringTag,{value:"Module"});var hCe=X7();function vCe(e){return hCe.cloneDeepWith(e)}Zz.cloneDeep=vCe});var t_=Ie(e_=>{"use strict";Object.defineProperty(e_,Symbol.toStringTag,{value:"Module"});var yCe=/^(?:0|[1-9]\d*)$/;function bCe(e,t=Number.MAX_SAFE_INTEGER){switch(typeof e){case"number":return Number.isInteger(e)&&e>=0&&e<t;case"symbol":return!1;case"string":return yCe.test(e)}}e_.isIndex=bCe});var Z7=Ie(r_=>{"use strict";Object.defineProperty(r_,Symbol.toStringTag,{value:"Module"});var xCe=Hz();function wCe(e){return e!==null&&typeof e=="object"&&xCe.getTag(e)==="[object Arguments]"}r_.isArguments=wCe});var eJ=Ie(n_=>{"use strict";Object.defineProperty(n_,Symbol.toStringTag,{value:"Module"});var kCe=Pj(),SCe=t_(),TCe=Z7(),CCe=DP();function PCe(e,t){let r;if(Array.isArray(t)?r=t:typeof t=="string"&&kCe.isDeepKey(t)&&(e==null?void 0:e[t])==null?r=CCe.toPath(t):r=[t],r.length===0)return!1;let n=e;for(let o=0;o<r.length;o++){let a=r[o];if((n==null||!Object.hasOwn(n,a))&&!((Array.isArray(n)||TCe.isArguments(n))&&SCe.isIndex(a)&&a<n.length))return!1;n=n[a]}return!0}n_.has=PCe});var tJ=Ie(o_=>{"use strict";Object.defineProperty(o_,Symbol.toStringTag,{value:"Module"});var DCe=aD(),ECe=Ej(),ICe=Q7(),ACe=EP(),LCe=eJ();function NCe(e,t){switch(typeof e){case"object":{Object.is(e==null?void 0:e.valueOf(),-0)&&(e="-0");break}case"number":{e=ECe.toKey(e);break}}return t=ICe.cloneDeep(t),function(r){let n=ACe.get(r,e);return n===void 0?LCe.has(r,e):t===void 0?n===void 0:DCe.isMatch(n,t)}}o_.matchesProperty=NCe});var rJ=Ie(a_=>{"use strict";Object.defineProperty(a_,Symbol.toStringTag,{value:"Module"});var MCe=Iz(),FCe=R7(),OCe=J7(),jCe=tJ();function zCe(e){if(e==null)return MCe.identity;switch(typeof e){case"function":return e;case"object":return Array.isArray(e)&&e.length===2?jCe.matchesProperty(e[0],e[1]):OCe.matches(e);case"string":case"symbol":case"number":return FCe.property(e)}}a_.iteratee=zCe});var nJ=Ie(i_=>{"use strict";Object.defineProperty(i_,Symbol.toStringTag,{value:"Module"});var _Ce=_7(),BCe=Iz(),$Ce=W7(),WCe=rJ();function RCe(e,t=BCe.identity){return $Ce.isArrayLikeObject(e)?_Ce.uniqBy(Array.from(e),WCe.iteratee(t)):[]}i_.uniqBy=RCe});var aJ=Ie((VXe,oJ)=>{oJ.exports=nJ().uniqBy});function sD(e,t,r){return t===!0?(0,s_.default)(e,r):typeof t=="function"?(0,s_.default)(e,t):e}var s_,l_=L(()=>{s_=q(aJ())});var sJ=Ie(iJ=>{"use strict";var wy=Y();function UCe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var VCe=typeof Object.is=="function"?Object.is:UCe,HCe=wy.useState,qCe=wy.useEffect,GCe=wy.useLayoutEffect,YCe=wy.useDebugValue;function KCe(e,t){var r=t(),n=HCe({inst:{value:r,getSnapshot:t}}),o=n[0].inst,a=n[1];return GCe(function(){o.value=r,o.getSnapshot=t,c_(o)&&a({inst:o})},[e,r,t]),qCe(function(){return c_(o)&&a({inst:o}),e(function(){c_(o)&&a({inst:o})})},[e]),YCe(r),r}function c_(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!VCe(e,r)}catch(n){return!0}}function JCe(e,t){return t()}var XCe=typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"?JCe:KCe;iJ.useSyncExternalStore=wy.useSyncExternalStore!==void 0?wy.useSyncExternalStore:XCe});var cJ=Ie((GXe,lJ)=>{"use strict";lJ.exports=sJ()});var uJ=Ie(dJ=>{"use strict";var lD=Y(),QCe=cJ();function ZCe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var e1e=typeof Object.is=="function"?Object.is:ZCe,t1e=QCe.useSyncExternalStore,r1e=lD.useRef,n1e=lD.useEffect,o1e=lD.useMemo,a1e=lD.useDebugValue;dJ.useSyncExternalStoreWithSelector=function(e,t,r,n,o){var a=r1e(null);if(a.current===null){var i={hasValue:!1,value:null};a.current=i}else i=a.current;a=o1e(function(){function l(m){if(!c){if(c=!0,d=m,m=n(m),o!==void 0&&i.hasValue){var f=i.value;if(o(f,m))return u=f}return u=m}if(f=u,e1e(d,m))return f;var g=n(m);return o!==void 0&&o(f,g)?(d=m,f):(d=m,u=g)}var c=!1,d,u,p=r===void 0?null:r;return[function(){return l(t())},p===null?void 0:function(){return l(p())}]},[t,r,n,o]);var s=t1e(e,a[0],a[1]);return n1e(function(){i.hasValue=!0,i.value=s},[s]),a1e(s),s}});var mJ=Ie((KXe,pJ)=>{"use strict";pJ.exports=uJ()});var fJ,K0,d_=L(()=>{fJ=q(Y()),K0=(0,fJ.createContext)(null)});function Oe(e){var t=(0,u_.useContext)(K0);return(0,gJ.useSyncExternalStoreWithSelector)(t?t.subscription.addNestedSub:s1e,t?t.store.getState:cD,t?t.store.getState:cD,t?e:cD,l1e)}var gJ,u_,i1e,or,cD,s1e,l1e,Or=L(()=>{gJ=q(mJ()),u_=q(Y());d_();i1e=e=>e,or=()=>{var e=(0,u_.useContext)(K0);return e?e.store.dispatch:i1e},cD=()=>{},s1e=()=>cD,l1e=(e,t)=>e===t});function c1e(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function d1e(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function u1e(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){let r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}function p1e(e){let t=Array.isArray(e[0])?e[0]:e;return u1e(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function m1e(e,t){let r=[],{length:n}=e;for(let o=0;o<n;o++)r.push(e[o].apply(null,t));return r}function dD(){return{s:h1e,v:void 0,o:null,p:null}}function yJ(e,t={}){let r=dD(),{resultEqualityCheck:n}=t,o,a=0;function i(){var u,p;let s=r,{length:l}=arguments;for(let m=0,f=l;m<f;m++){let g=arguments[m];if(typeof g=="function"||typeof g=="object"&&g!==null){let v=s.o;v===null&&(s.o=v=new WeakMap);let h=v.get(g);h===void 0?(s=dD(),v.set(g,s)):s=h}else{let v=s.p;v===null&&(s.p=v=new Map);let h=v.get(g);h===void 0?(s=dD(),v.set(g,s)):s=h}}let c=s,d;if(s.s===vJ)d=s.v;else if(d=e.apply(null,arguments),a++,n){let m=(p=(u=o==null?void 0:o.deref)==null?void 0:u.call(o))!=null?p:o;m!=null&&n(m,d)&&(d=m,a!==0&&a--),o=typeof d=="object"&&d!==null||typeof d=="function"?new g1e(d):d}return c.s=vJ,c.v=d,d}return i.clearCache=()=>{r=dD(),i.resetResultsCount()},i.resultsCount=()=>a,i.resetResultsCount=()=>{a=0},i}function v1e(e,...t){let r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...o)=>{let a=0,i=0,s,l={},c=o.pop();typeof c=="object"&&(l=c,c=o.pop()),c1e(c,`createSelector expects an output function after the inputs, but received: [${typeof c}]`);let d={...r,...l},{memoize:u,memoizeOptions:p=[],argsMemoize:m=yJ,argsMemoizeOptions:f=[],devModeChecks:g={}}=d,v=hJ(p),h=hJ(f),y=p1e(o),b=u(function(){return a++,c.apply(null,arguments)},...v),x=!0,w=m(function(){i++;let k=m1e(y,arguments);return s=b.apply(null,k),s},...h);return Object.assign(w,{resultFunc:c,memoizedResultFunc:b,dependencies:y,dependencyRecomputations:()=>i,resetDependencyRecomputations:()=>{i=0},lastResult:()=>s,recomputations:()=>a,resetRecomputations:()=>{a=0},memoize:u,argsMemoize:m})};return Object.assign(n,{withTypes:()=>n}),n}var hJ,ZXe,eQe,f1e,g1e,h1e,vJ,ie,y1e,Pa=L(()=>{hJ=e=>Array.isArray(e)?e:[e];ZXe=Symbol(),eQe=Object.getPrototypeOf({}),f1e=class{constructor(e){this.value=e}deref(){return this.value}},g1e=typeof WeakRef!="undefined"?WeakRef:f1e,h1e=0,vJ=1;ie=v1e(yJ),y1e=Object.assign((e,t=ie)=>{d1e(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);let r=Object.keys(e),n=r.map(a=>e[a]);return t(n,(...a)=>a.reduce((i,s,l)=>(i[r[l]]=s,i),{}))},{withTypes:()=>y1e})});var xJ=Ie(p_=>{"use strict";Object.defineProperty(p_,Symbol.toStringTag,{value:"Module"});function bJ(e){return typeof e=="symbol"?1:e===null?2:e===void 0?3:e!==e?4:0}var b1e=(e,t,r)=>{if(e!==t){let n=bJ(e),o=bJ(t);if(n===o&&n===0){if(e<t)return r==="desc"?1:-1;if(e>t)return r==="desc"?-1:1}return r==="desc"?o-n:n-o}return 0};p_.compareValues=b1e});var f_=Ie(m_=>{"use strict";Object.defineProperty(m_,Symbol.toStringTag,{value:"Module"});function x1e(e){return typeof e=="symbol"||e instanceof Symbol}m_.isSymbol=x1e});var wJ=Ie(g_=>{"use strict";Object.defineProperty(g_,Symbol.toStringTag,{value:"Module"});var w1e=f_(),k1e=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,S1e=/^\w*$/;function T1e(e,t){return Array.isArray(e)?!1:typeof e=="number"||typeof e=="boolean"||e==null||w1e.isSymbol(e)?!0:typeof e=="string"&&(S1e.test(e)||!k1e.test(e))||t!=null&&Object.hasOwn(t,e)}g_.isKey=T1e});var kJ=Ie(h_=>{"use strict";Object.defineProperty(h_,Symbol.toStringTag,{value:"Module"});var C1e=xJ(),P1e=wJ(),D1e=DP();function E1e(e,t,r,n){if(e==null)return[];r=n?void 0:r,Array.isArray(e)||(e=Object.values(e)),Array.isArray(t)||(t=t==null?[null]:[t]),t.length===0&&(t=[null]),Array.isArray(r)||(r=r==null?[]:[r]),r=r.map(l=>String(l));let o=(l,c)=>{let d=l;for(let u=0;u<c.length&&d!=null;++u)d=d[c[u]];return d},a=(l,c)=>c==null||l==null?c:typeof l=="object"&&"key"in l?Object.hasOwn(c,l.key)?c[l.key]:o(c,l.path):typeof l=="function"?l(c):Array.isArray(l)?o(c,l):typeof c=="object"?c[l]:c,i=t.map(l=>(Array.isArray(l)&&l.length===1&&(l=l[0]),l==null||typeof l=="function"||Array.isArray(l)||P1e.isKey(l)?l:{key:l,path:D1e.toPath(l)}));return e.map(l=>({original:l,criteria:i.map(c=>a(c,l))})).slice().sort((l,c)=>{for(let d=0;d<i.length;d++){let u=C1e.compareValues(l.criteria[d],c.criteria[d],r[d]);if(u!==0)return u}return 0}).map(l=>l.original)}h_.orderBy=E1e});var SJ=Ie(v_=>{"use strict";Object.defineProperty(v_,Symbol.toStringTag,{value:"Module"});function I1e(e,t=1){let r=[],n=Math.floor(t),o=(a,i)=>{for(let s=0;s<a.length;s++){let l=a[s];Array.isArray(l)&&i<n?o(l,i+1):r.push(l)}};return o(e,0),r}v_.flatten=I1e});var b_=Ie(y_=>{"use strict";Object.defineProperty(y_,Symbol.toStringTag,{value:"Module"});var A1e=t_(),L1e=nD(),N1e=jz(),M1e=$z();function F1e(e,t,r){return N1e.isObject(r)&&(typeof t=="number"&&L1e.isArrayLike(r)&&A1e.isIndex(t)&&t<r.length||typeof t=="string"&&t in r)?M1e.eq(r[t],e):!1}y_.isIterateeCall=F1e});var CJ=Ie(x_=>{"use strict";Object.defineProperty(x_,Symbol.toStringTag,{value:"Module"});var O1e=kJ(),j1e=SJ(),TJ=b_();function z1e(e,...t){let r=t.length;return r>1&&TJ.isIterateeCall(e,t[0],t[1])?t=[]:r>2&&TJ.isIterateeCall(t[0],t[1],t[2])&&(t=[t[0]]),O1e.orderBy(e,j1e.flatten(t),["asc"])}x_.sortBy=z1e});var J0=Ie((uQe,PJ)=>{PJ.exports=CJ().sortBy});var DJ,w_,EJ,_1e,IJ,k_=L(()=>{Pa();DJ=q(J0()),w_=e=>e.legend.settings,EJ=e=>e.legend.size,_1e=e=>e.legend.payload,IJ=ie([_1e,w_],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?(0,DJ.default)(n,r):n})});function AJ(){return Oe(IJ)}var LJ=L(()=>{Or();k_()});function mD(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=(0,pD.useState)({height:0,left:0,top:0,width:0}),n=(0,pD.useCallback)(o=>{if(o!=null){var a=o.getBoundingClientRect(),i={height:a.height,left:a.left,top:a.top,width:a.width};(Math.abs(i.height-t.height)>uD||Math.abs(i.left-t.left)>uD||Math.abs(i.top-t.top)>uD||Math.abs(i.width-t.width)>uD)&&r({height:i.height,left:i.left,top:i.top,width:i.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}var pD,uD,S_=L(()=>{pD=q(Y()),uD=1});function Ya(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}function gD(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function C_(e,t,r){if(typeof e!="function")throw new Error(Ya(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Ya(0));if(typeof t=="function"&&typeof r=="undefined"&&(r=t,t=void 0),typeof r!="undefined"){if(typeof r!="function")throw new Error(Ya(1));return r(C_)(e,t)}let n=e,o=t,a=new Map,i=a,s=0,l=!1;function c(){i===a&&(i=new Map,a.forEach((v,h)=>{i.set(h,v)}))}function d(){if(l)throw new Error(Ya(3));return o}function u(v){if(typeof v!="function")throw new Error(Ya(4));if(l)throw new Error(Ya(5));let h=!0;c();let y=s++;return i.set(y,v),function(){if(h){if(l)throw new Error(Ya(6));h=!1,c(),i.delete(y),a=null}}}function p(v){if(!gD(v))throw new Error(Ya(7));if(typeof v.type=="undefined")throw new Error(Ya(8));if(typeof v.type!="string")throw new Error(Ya(17));if(l)throw new Error(Ya(9));try{l=!0,o=n(o,v)}finally{l=!1}return(a=i).forEach(y=>{y()}),v}function m(v){if(typeof v!="function")throw new Error(Ya(10));n=v,p({type:fD.REPLACE})}function f(){let v=u;return{subscribe(h){if(typeof h!="object"||h===null)throw new Error(Ya(11));function y(){let x=h;x.next&&x.next(d())}return y(),{unsubscribe:v(y)}},[NJ](){return this}}}return p({type:fD.INIT}),{dispatch:p,subscribe:u,getState:d,replaceReducer:m,[NJ]:f}}function W1e(e){Object.keys(e).forEach(t=>{let r=e[t];if(typeof r(void 0,{type:fD.INIT})=="undefined")throw new Error(Ya(12));if(typeof r(void 0,{type:fD.PROBE_UNKNOWN_ACTION()})=="undefined")throw new Error(Ya(13))})}function hD(e){let t=Object.keys(e),r={};for(let i=0;i<t.length;i++){let s=t[i];typeof e[s]=="function"&&(r[s]=e[s])}let n=Object.keys(r),o,a;try{W1e(r)}catch(i){a=i}return function(s={},l){if(a)throw a;let c=!1,d={};for(let u=0;u<n.length;u++){let p=n[u],m=r[p],f=s[p],g=m(f,l);if(typeof g=="undefined"){let v=l&&l.type;throw new Error(Ya(14))}d[p]=g,c=c||g!==f}return c=c||n.length!==Object.keys(s).length,c?d:s}}function ky(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function MJ(...e){return t=>(r,n)=>{let o=t(r,n),a=()=>{throw new Error(Ya(15))},i={getState:o.getState,dispatch:(l,...c)=>a(l,...c)},s=e.map(l=>l(i));return a=ky(...s)(o.dispatch),{...o,dispatch:a}}}function vD(e){return gD(e)&&"type"in e&&typeof e.type=="string"}var B1e,NJ,T_,$1e,fD,Sy=L(()=>{B1e=typeof Symbol=="function"&&Symbol.observable||"@@observable",NJ=B1e,T_=()=>Math.random().toString(36).substring(7).split("").join("."),$1e={INIT:`@@redux/INIT${T_()}`,REPLACE:`@@redux/REPLACE${T_()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${T_()}`},fD=$1e});function Lc(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}function Hu(e){return!!e&&!!e[Js]}function Nc(e){var t;return e?$J(e)||Array.isArray(e)||!!e[FJ]||!!((t=e.constructor)!=null&&t[FJ])||kD(e)||SD(e):!1}function $J(e){if(!e||typeof e!="object")return!1;let t=Ty(e);if(t===null)return!0;let r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===R1e}function yD(e,t){wD(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function wD(e){let t=e[Js];return t?t.type_:Array.isArray(e)?1:kD(e)?2:SD(e)?3:0}function E_(e,t){return wD(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function WJ(e,t,r){let n=wD(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function U1e(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function kD(e){return e instanceof Map}function SD(e){return e instanceof Set}function Lg(e){return e.copy_||e.base_}function I_(e,t){if(kD(e))return new Map(e);if(SD(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);let r=$J(e);if(t===!0||t==="class_only"&&!r){let n=Object.getOwnPropertyDescriptors(e);delete n[Js];let o=Reflect.ownKeys(n);for(let a=0;a<o.length;a++){let i=o[a],s=n[i];s.writable===!1&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(n[i]={configurable:!0,writable:!0,enumerable:s.enumerable,value:e[i]})}return Object.create(Ty(e),n)}else{let n=Ty(e);if(n!==null&&r)return{...e};let o=Object.create(n);return Object.assign(o,e)}}function TD(e,t=!1){return CD(e)||Hu(e)||!Nc(e)||(wD(e)>1&&(e.set=e.add=e.clear=e.delete=V1e),Object.freeze(e),t&&Object.entries(e).forEach(([r,n])=>TD(n,!0))),e}function V1e(){Lc(2)}function CD(e){return Object.isFrozen(e)}function Ng(e){let t=H1e[e];return t||Lc(0,e),t}function RJ(){return X0}function q1e(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function OJ(e,t){t&&(Ng("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function A_(e){L_(e),e.drafts_.forEach(G1e),e.drafts_=null}function L_(e){e===X0&&(X0=e.parent_)}function jJ(e){return X0=q1e(X0,e)}function G1e(e){let t=e[Js];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function zJ(e,t){t.unfinalizedDrafts_=t.drafts_.length;let r=t.drafts_[0];return e!==void 0&&e!==r?(r[Js].modified_&&(A_(t),Lc(4)),Nc(e)&&(e=bD(t,e),t.parent_||xD(t,e)),t.patches_&&Ng("Patches").generateReplacementPatches_(r[Js].base_,e,t.patches_,t.inversePatches_)):e=bD(t,r,[]),A_(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==BJ?e:void 0}function bD(e,t,r){if(CD(t))return t;let n=t[Js];if(!n)return yD(t,(o,a)=>_J(e,n,t,o,a,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return xD(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;let o=n.copy_,a=o,i=!1;n.type_===3&&(a=new Set(o),o.clear(),i=!0),yD(a,(s,l)=>_J(e,n,o,s,l,r,i)),xD(e,o,!1),r&&e.patches_&&Ng("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function _J(e,t,r,n,o,a,i){if(Hu(o)){let s=a&&t&&t.type_!==3&&!E_(t.assigned_,n)?a.concat(n):void 0,l=bD(e,o,s);if(WJ(r,n,l),Hu(l))e.canAutoFreeze_=!1;else return}else i&&r.add(o);if(Nc(o)&&!CD(o)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;bD(e,o),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&xD(e,o)}}function xD(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&TD(t,r)}function Y1e(e,t){let r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:RJ(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1},o=n,a=F_;r&&(o=[n],a=Q0);let{revoke:i,proxy:s}=Proxy.revocable(o,a);return n.draft_=s,n.revoke_=i,s}function P_(e,t){let r=e[Js];return(r?Lg(r):e)[t]}function K1e(e,t,r){var o;let n=UJ(t,r);return n?"value"in n?n.value:(o=n.get)==null?void 0:o.call(e.draft_):void 0}function UJ(e,t){if(!(t in e))return;let r=Ty(e);for(;r;){let n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Ty(r)}}function N_(e){e.modified_||(e.modified_=!0,e.parent_&&N_(e.parent_))}function D_(e){e.copy_||(e.copy_=I_(e.base_,e.scope_.immer_.useStrictShallowCopy_))}function M_(e,t){let r=kD(e)?Ng("MapSet").proxyMap_(e,t):SD(e)?Ng("MapSet").proxySet_(e,t):Y1e(e,t);return(t?t.scope_:RJ()).drafts_.push(r),r}function gs(e){return Hu(e)||Lc(10,e),VJ(e)}function VJ(e){if(!Nc(e)||CD(e))return e;let t=e[Js],r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=I_(e,t.scope_.immer_.useStrictShallowCopy_)}else r=I_(e,!0);return yD(r,(n,o)=>{WJ(r,n,VJ(o))}),t&&(t.finalized_=!1),r}var BJ,FJ,Js,Ty,R1e,H1e,X0,F_,Q0,J1e,Xs,Z0,bQe,xQe,wQe,kQe,SQe,TQe,PD=L(()=>{BJ=Symbol.for("immer-nothing"),FJ=Symbol.for("immer-draftable"),Js=Symbol.for("immer-state");Ty=Object.getPrototypeOf;R1e=Object.prototype.constructor.toString();H1e={};F_={get(e,t){if(t===Js)return e;let r=Lg(e);if(!E_(r,t))return K1e(e,r,t);let n=r[t];return e.finalized_||!Nc(n)?n:n===P_(e.base_,t)?(D_(e),e.copy_[t]=M_(n,e)):n},has(e,t){return t in Lg(e)},ownKeys(e){return Reflect.ownKeys(Lg(e))},set(e,t,r){let n=UJ(Lg(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){let o=P_(Lg(e),t),a=o==null?void 0:o[Js];if(a&&a.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(U1e(r,o)&&(r!==void 0||E_(e.base_,t)))return!0;D_(e),N_(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return P_(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,D_(e),N_(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){let r=Lg(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){Lc(11)},getPrototypeOf(e){return Ty(e.base_)},setPrototypeOf(){Lc(12)}},Q0={};yD(F_,(e,t)=>{Q0[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Q0.deleteProperty=function(e,t){return Q0.set.call(this,e,t,void 0)};Q0.set=function(e,t,r){return F_.set.call(this,e[0],t,r,e[0])};J1e=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){let a=r;r=t;let i=this;return function(l=a,...c){return i.produce(l,d=>r.call(this,d,...c))}}typeof r!="function"&&Lc(6),n!==void 0&&typeof n!="function"&&Lc(7);let o;if(Nc(t)){let a=jJ(this),i=M_(t,void 0),s=!0;try{o=r(i),s=!1}finally{s?A_(a):L_(a)}return OJ(a,n),zJ(o,a)}else if(!t||typeof t!="object"){if(o=r(t),o===void 0&&(o=t),o===BJ&&(o=void 0),this.autoFreeze_&&TD(o,!0),n){let a=[],i=[];Ng("Patches").generateReplacementPatches_(t,o,a,i),n(a,i)}return o}else Lc(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(i,...s)=>this.produceWithPatches(i,l=>t(l,...s));let n,o;return[this.produce(t,r,(i,s)=>{n=i,o=s}),n,o]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Nc(e)||Lc(8),Hu(e)&&(e=gs(e));let t=jJ(this),r=M_(e,void 0);return r[Js].isManual_=!0,L_(t),r}finishDraft(e,t){let r=e&&e[Js];(!r||!r.isManual_)&&Lc(9);let{scope_:n}=r;return OJ(n,t),zJ(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){let o=t[r];if(o.path.length===0&&o.op==="replace"){e=o.value;break}}r>-1&&(t=t.slice(r+1));let n=Ng("Patches").applyPatches_;return Hu(e)?n(e,t):this.produce(e,o=>n(o,t))}};Xs=new J1e,Z0=Xs.produce,bQe=Xs.produceWithPatches.bind(Xs),xQe=Xs.setAutoFreeze.bind(Xs),wQe=Xs.setUseStrictShallowCopy.bind(Xs),kQe=Xs.applyPatches.bind(Xs),SQe=Xs.createDraft.bind(Xs),TQe=Xs.finishDraft.bind(Xs)});function HJ(e){return({dispatch:r,getState:n})=>o=>a=>typeof a=="function"?a(r,n,e):o(a)}var qJ,GJ,YJ=L(()=>{qJ=HJ(),GJ=HJ});function na(e,t){function r(...n){if(t){let o=t(...n);if(!o)throw new Error(Qs(0));return{type:e,payload:o.payload,..."meta"in o&&{meta:o.meta},..."error"in o&&{error:o.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>vD(n)&&n.type===e,r}function KJ(e){return Nc(e)?Z0(e,()=>{}):e}function DD(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function Z1e(e){return typeof e=="boolean"}function nX(e){let t=ePe(),{reducer:r=void 0,middleware:n,devTools:o=!0,duplicateMiddlewareCheck:a=!0,preloadedState:i=void 0,enhancers:s=void 0}=e||{},l;if(typeof r=="function")l=r;else if(gD(r))l=hD(r);else throw new Error(Qs(1));let c;typeof n=="function"?c=n(t):c=t();let d=ky;o&&(d=X1e({trace:!1,...typeof o=="object"&&o}));let u=MJ(...c),p=nPe(u),m=typeof s=="function"?s(p):p(),f=d(...m);return C_(l,i,f)}function oX(e){let t={},r=[],n,o={addCase(a,i){let s=typeof a=="string"?a:a.type;if(!s)throw new Error(Qs(28));if(s in t)throw new Error(Qs(29));return t[s]=i,o},addMatcher(a,i){return r.push({matcher:a,reducer:i}),o},addDefaultCase(a){return n=a,o}};return e(o),[t,r,n]}function oPe(e){return typeof e=="function"}function aPe(e,t){let[r,n,o]=oX(t),a;if(oPe(e))a=()=>KJ(e());else{let s=KJ(e);a=()=>s}function i(s=a(),l){let c=[r[l.type],...n.filter(({matcher:d})=>d(l)).map(({reducer:d})=>d)];return c.filter(d=>!!d).length===0&&(c=[o]),c.reduce((d,u)=>{if(u)if(Hu(d)){let m=u(d,l);return m===void 0?d:m}else{if(Nc(d))return Z0(d,p=>u(p,l));{let p=u(d,l);if(p===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return p}}return d},s)}return i.getInitialState=a,i}function sPe(...e){return t=>e.some(r=>iPe(r,t))}function pPe(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}function mPe(e){return e!==null&&typeof e=="object"&&typeof e.then=="function"}function fPe(e,t){return`${e}/${t}`}function gPe({creators:e}={}){var r;let t=(r=e==null?void 0:e.asyncThunk)==null?void 0:r[iX];return function(o){let{name:a,reducerPath:i=a}=o;if(!a)throw new Error(Qs(11));let s=(typeof o.reducers=="function"?o.reducers(vPe()):o.reducers)||{},l=Object.keys(s),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(x,w){let S=typeof x=="string"?x:x.type;if(!S)throw new Error(Qs(12));if(S in c.sliceCaseReducersByType)throw new Error(Qs(13));return c.sliceCaseReducersByType[S]=w,d},addMatcher(x,w){return c.sliceMatchers.push({matcher:x,reducer:w}),d},exposeAction(x,w){return c.actionCreators[x]=w,d},exposeCaseReducer(x,w){return c.sliceCaseReducersByName[x]=w,d}};l.forEach(x=>{let w=s[x],S={reducerName:x,type:fPe(a,x),createNotation:typeof o.reducers=="function"};bPe(w)?wPe(S,w,d,t):yPe(S,w,d)});function u(){let[x={},w=[],S=void 0]=typeof o.extraReducers=="function"?oX(o.extraReducers):[o.extraReducers],k={...x,...c.sliceCaseReducersByType};return aPe(o.initialState,T=>{for(let P in k)T.addCase(P,k[P]);for(let P of c.sliceMatchers)T.addMatcher(P.matcher,P.reducer);for(let P of w)T.addMatcher(P.matcher,P.reducer);S&&T.addDefaultCase(S)})}let p=x=>x,m=new Map,f=new WeakMap,g;function v(x,w){return g||(g=u()),g(x,w)}function h(){return g||(g=u()),g.getInitialState()}function y(x,w=!1){function S(T){let P=T[x];return typeof P=="undefined"&&w&&(P=DD(f,S,h)),P}function k(T=p){let P=DD(m,w,()=>new WeakMap);return DD(P,T,()=>{var O;let D={};for(let[z,I]of Object.entries((O=o.selectors)!=null?O:{}))D[z]=hPe(I,T,()=>DD(f,T,h),w);return D})}return{reducerPath:x,getSelectors:k,get selectors(){return k(S)},selectSlice:S}}let b={name:a,reducer:v,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:h,...y(i),injectInto(x,{reducerPath:w,...S}={}){let k=w!=null?w:i;return x.inject({reducerPath:k,reducer:v},S),{...b,...y(k,!0)}}};return b}}function hPe(e,t,r,n){function o(a,...i){let s=t(a);return typeof s=="undefined"&&n&&(s=r()),e(s,...i)}return o.unwrapped=e,o}function vPe(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function yPe({type:e,reducerName:t,createNotation:r},n,o){let a,i;if("reducer"in n){if(r&&!xPe(n))throw new Error(Qs(17));a=n.reducer,i=n.prepare}else a=n;o.addCase(e,a).exposeCaseReducer(t,a).exposeAction(t,i?na(e,i):na(e))}function bPe(e){return e._reducerDefinitionType==="asyncThunk"}function xPe(e){return e._reducerDefinitionType==="reducerWithPrepare"}function wPe({type:e,reducerName:t},r,n,o){if(!o)throw new Error(Qs(18));let{payloadCreator:a,fulfilled:i,pending:s,rejected:l,settled:c,options:d}=r,u=o(e,a,d);n.exposeAction(t,u),i&&n.addCase(u.fulfilled,i),s&&n.addCase(u.pending,s),l&&n.addCase(u.rejected,l),c&&n.addMatcher(u.settled,c),n.exposeCaseReducer(t,{fulfilled:i||ED,pending:s||ED,rejected:l||ED,settled:c||ED})}function ED(){}function uX(e,t){let r=ID;return new Promise((n,o)=>{let a=()=>o(new LD(e.reason));if(e.aborted){a();return}r=dX(e,a),t.finally(()=>r()).then(n,o)}).finally(()=>{r=ID})}function Qs(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var X1e,NQe,Q1e,rX,ePe,tPe,JJ,rPe,nPe,iPe,lPe,aX,cPe,O_,XJ,dPe,QJ,uPe,iX,zQe,hn,kPe,sX,lX,__,SPe,TPe,j_,CPe,LD,B_,ID,cX,dX,Mg,Fg,PPe,AD,pX,Cy,ZJ,ND,DPe,EPe,mX,fX,eX,z_,IPe,tX,gX,APe,hX,LPe,qu,BQe,oa=L(()=>{Sy();PD();Sy();Sy();YJ();Sy();PD();PD();Sy();X1e=typeof window!="undefined"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?ky:ky.apply(null,arguments)},NQe=typeof window!="undefined"&&window.__REDUX_DEVTOOLS_EXTENSION__?window.__REDUX_DEVTOOLS_EXTENSION__:function(){return function(e){return e}},Q1e=e=>e&&typeof e.match=="function";rX=class ek extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,ek.prototype)}static get[Symbol.species](){return ek}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new ek(...t[0].concat(this)):new ek(...t.concat(this))}};ePe=()=>function(t){let{thunk:r=!0,immutableCheck:n=!0,serializableCheck:o=!0,actionCreatorCheck:a=!0}=t!=null?t:{},i=new rX;return r&&(Z1e(r)?i.push(qJ):i.push(GJ(r.extraArgument))),i},tPe="RTK_autoBatch",JJ=e=>t=>{setTimeout(t,e)},rPe=(e={type:"raf"})=>t=>(...r)=>{let n=t(...r),o=!0,a=!1,i=!1,s=new Set,l=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window!="undefined"&&window.requestAnimationFrame?window.requestAnimationFrame:JJ(10):e.type==="callback"?e.queueNotification:JJ(e.timeout),c=()=>{i=!1,a&&(a=!1,s.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){let u=()=>o&&d(),p=n.subscribe(u);return s.add(d),()=>{p(),s.delete(d)}},dispatch(d){var u;try{return o=!((u=d==null?void 0:d.meta)!=null&&u[tPe]),a=!o,a&&(i||(i=!0,l(c))),n.dispatch(d)}finally{o=!0}}})},nPe=e=>function(r){let{autoBatch:n=!0}=r!=null?r:{},o=new rX(e);return n&&o.push(rPe(typeof n=="object"?n:void 0)),o};iPe=(e,t)=>Q1e(e)?e.match(t):e(t);lPe="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",aX=(e=21)=>{let t="",r=e;for(;r--;)t+=lPe[Math.random()*64|0];return t},cPe=["name","message","stack","code"],O_=class{constructor(e,t){Dh(this,"_type");this.payload=e,this.meta=t}},XJ=class{constructor(e,t){Dh(this,"_type");this.payload=e,this.meta=t}},dPe=e=>{if(typeof e=="object"&&e!==null){let t={};for(let r of cPe)typeof e[r]=="string"&&(t[r]=e[r]);return t}return{message:String(e)}},QJ="External signal was aborted",uPe=(()=>{function e(t,r,n){let o=na(t+"/fulfilled",(l,c,d,u)=>({payload:l,meta:{...u||{},arg:d,requestId:c,requestStatus:"fulfilled"}})),a=na(t+"/pending",(l,c,d)=>({payload:void 0,meta:{...d||{},arg:c,requestId:l,requestStatus:"pending"}})),i=na(t+"/rejected",(l,c,d,u,p)=>({payload:u,error:(n&&n.serializeError||dPe)(l||"Rejected"),meta:{...p||{},arg:d,requestId:c,rejectedWithValue:!!u,requestStatus:"rejected",aborted:(l==null?void 0:l.name)==="AbortError",condition:(l==null?void 0:l.name)==="ConditionError"}}));function s(l,{signal:c}={}){return(d,u,p)=>{let m=n!=null&&n.idGenerator?n.idGenerator(l):aX(),f=new AbortController,g,v;function h(b){v=b,f.abort()}c&&(c.aborted?h(QJ):c.addEventListener("abort",()=>h(QJ),{once:!0}));let y=(async function(){var w,S;let b;try{let k=(w=n==null?void 0:n.condition)==null?void 0:w.call(n,l,{getState:u,extra:p});if(mPe(k)&&(k=await k),k===!1||f.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};let T=new Promise((P,D)=>{g=()=>{D({name:"AbortError",message:v||"Aborted"})},f.signal.addEventListener("abort",g)});d(a(m,l,(S=n==null?void 0:n.getPendingMeta)==null?void 0:S.call(n,{requestId:m,arg:l},{getState:u,extra:p}))),b=await Promise.race([T,Promise.resolve(r(l,{dispatch:d,getState:u,extra:p,requestId:m,signal:f.signal,abort:h,rejectWithValue:(P,D)=>new O_(P,D),fulfillWithValue:(P,D)=>new XJ(P,D)})).then(P=>{if(P instanceof O_)throw P;return P instanceof XJ?o(P.payload,m,l,P.meta):o(P,m,l)})])}catch(k){b=k instanceof O_?i(null,m,l,k.payload,k.meta):i(k,m,l)}finally{g&&f.signal.removeEventListener("abort",g)}return n&&!n.dispatchConditionRejection&&i.match(b)&&b.meta.condition||d(b),b})();return Object.assign(y,{abort:h,requestId:m,arg:l,unwrap(){return y.then(pPe)}})}}return Object.assign(s,{pending:a,rejected:i,fulfilled:o,settled:sPe(i,o),typePrefix:t})}return e.withTypes=()=>e,e})();iX=Symbol.for("rtk-slice-createasyncthunk"),zQe={[iX]:uPe};hn=gPe();kPe="task",sX="listener",lX="completed",__="cancelled",SPe=`task-${__}`,TPe=`task-${lX}`,j_=`${sX}-${__}`,CPe=`${sX}-${lX}`,LD=class{constructor(e){Dh(this,"name","TaskAbortError");Dh(this,"message");this.code=e,this.message=`${kPe} ${__} (reason: ${e})`}},B_=(e,t)=>{if(typeof e!="function")throw new TypeError(Qs(32))},ID=()=>{},cX=(e,t=ID)=>(e.catch(t),e),dX=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Mg=(e,t)=>{let r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},Fg=e=>{if(e.aborted){let{reason:t}=e;throw new LD(t)}};PPe=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof LD?"cancelled":"rejected",error:r}}finally{t==null||t()}},AD=e=>t=>cX(uX(e,t).then(r=>(Fg(e),r))),pX=e=>{let t=AD(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:Cy}=Object,ZJ={},ND="listenerMiddleware",DPe=(e,t)=>{let r=n=>dX(e,()=>Mg(n,e.reason));return(n,o)=>{B_(n,"taskExecutor");let a=new AbortController;r(a);let i=PPe(async()=>{Fg(e),Fg(a.signal);let s=await n({pause:AD(a.signal),delay:pX(a.signal),signal:a.signal});return Fg(a.signal),s},()=>Mg(a,TPe));return o!=null&&o.autoJoin&&t.push(i.catch(ID)),{result:AD(e)(i),cancel(){Mg(a,SPe)}}}},EPe=(e,t)=>{let r=async(n,o)=>{Fg(t);let a=()=>{},s=[new Promise((l,c)=>{let d=e({predicate:n,effect:(u,p)=>{p.unsubscribe(),l([u,p.getState(),p.getOriginalState()])}});a=()=>{d(),c()}})];o!=null&&s.push(new Promise(l=>setTimeout(l,o,null)));try{let l=await uX(t,Promise.race(s));return Fg(t),l}finally{a()}};return(n,o)=>cX(r(n,o))},mX=e=>{let{type:t,actionCreator:r,matcher:n,predicate:o,effect:a}=e;if(t)o=na(t).match;else if(r)t=r.type,o=r.match;else if(n)o=n;else if(!o)throw new Error(Qs(21));return B_(a,"options.listener"),{predicate:o,type:t,effect:a}},fX=Cy(e=>{let{type:t,predicate:r,effect:n}=mX(e);return{id:aX(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Qs(22))}}},{withTypes:()=>fX}),eX=(e,t)=>{let{type:r,effect:n,predicate:o}=mX(t);return Array.from(e.values()).find(a=>(typeof r=="string"?a.type===r:a.predicate===o)&&a.effect===n)},z_=e=>{e.pending.forEach(t=>{Mg(t,j_)})},IPe=e=>()=>{e.forEach(z_),e.clear()},tX=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},gX=Cy(na(`${ND}/add`),{withTypes:()=>gX}),APe=na(`${ND}/removeAll`),hX=Cy(na(`${ND}/remove`),{withTypes:()=>hX}),LPe=(...e)=>{console.error(`${ND}/error`,...e)},qu=(e={})=>{let t=new Map,{extra:r,onError:n=LPe}=e;B_(n,"onError");let o=d=>(d.unsubscribe=()=>t.delete(d.id),t.set(d.id,d),u=>{d.unsubscribe(),u!=null&&u.cancelActive&&z_(d)}),a=d=>{var p;let u=(p=eX(t,d))!=null?p:fX(d);return o(u)};Cy(a,{withTypes:()=>a});let i=d=>{let u=eX(t,d);return u&&(u.unsubscribe(),d.cancelActive&&z_(u)),!!u};Cy(i,{withTypes:()=>i});let s=async(d,u,p,m)=>{let f=new AbortController,g=EPe(a,f.signal),v=[];try{d.pending.add(f),await Promise.resolve(d.effect(u,Cy({},p,{getOriginalState:m,condition:(h,y)=>g(h,y).then(Boolean),take:g,delay:pX(f.signal),pause:AD(f.signal),extra:r,signal:f.signal,fork:DPe(f.signal,v),unsubscribe:d.unsubscribe,subscribe:()=>{t.set(d.id,d)},cancelActiveListeners:()=>{d.pending.forEach((h,y,b)=>{h!==f&&(Mg(h,j_),b.delete(h))})},cancel:()=>{Mg(f,j_),d.pending.delete(f)},throwIfCancelled:()=>{Fg(f.signal)}})))}catch(h){h instanceof LD||tX(n,h,{raisedBy:"effect"})}finally{await Promise.all(v),Mg(f,CPe),d.pending.delete(f)}},l=IPe(t);return{middleware:d=>u=>p=>{if(!vD(p))return u(p);if(gX.match(p))return a(p.payload);if(APe.match(p)){l();return}if(hX.match(p))return i(p.payload);let m=d.getState(),f=()=>{if(m===ZJ)throw new Error(Qs(23));return m},g;try{if(g=u(p),t.size>0){let v=d.getState(),h=Array.from(t.values());for(let y of h){let b=!1;try{b=y.predicate(p,v,m)}catch(x){b=!1,tX(n,x,{raisedBy:"predicate"})}b&&s(y,p,d,f)}}}finally{m=ZJ}return g},startListening:a,stopListening:i,clearListeners:l}},BQe=Symbol.for("rtk-state-proxy-original")});var NPe,vX,yX,bX,xX,wX,kX,MD=L(()=>{oa();NPe={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},vX=hn({name:"chartLayout",initialState:NPe,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,o,a;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(o=t.payload.bottom)!==null&&o!==void 0?o:0,e.margin.left=(a=t.payload.left)!==null&&a!==void 0?a:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:yX,setLayout:bX,setChartSize:xX,setScale:wX}=vX.actions,kX=vX.reducer});function SX(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function TX(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SX(Object(r),!0).forEach(function(n){MPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SX(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MPe(e,t,r){return(t=FPe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FPe(e){var t=OPe(e,"string");return typeof t=="symbol"?t:t+""}function OPe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jPe,tk,zPe,mo,CX,_Pe,BPe,$Pe,WPe,PX,Og=L(()=>{jPe=q(Y());tk=Math.PI/180,zPe=e=>e*180/Math.PI,mo=(e,t,r,n)=>({x:e+Math.cos(-tk*n)*r,y:t+Math.sin(-tk*n)*r}),CX=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0,width:0,height:0,brushBottom:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},_Pe=(e,t)=>{var{x:r,y:n}=e,{x:o,y:a}=t;return Math.sqrt((r-o)**2+(n-a)**2)},BPe=(e,t)=>{var{x:r,y:n}=e,{cx:o,cy:a}=t,i=_Pe({x:r,y:n},{x:o,y:a});if(i<=0)return{radius:i,angle:0};var s=(r-o)/i,l=Math.acos(s);return n>a&&(l=2*Math.PI-l),{radius:i,angle:zPe(l),angleInRadian:l}},$Pe=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),o=Math.floor(r/360),a=Math.min(n,o);return{startAngle:t-a*360,endAngle:r-a*360}},WPe=(e,t)=>{var{startAngle:r,endAngle:n}=t,o=Math.floor(r/360),a=Math.floor(n/360),i=Math.min(o,a);return e+i*360},PX=(e,t)=>{var{x:r,y:n}=e,{radius:o,angle:a}=BPe({x:r,y:n},t),{innerRadius:i,outerRadius:s}=t;if(o<i||o>s||o===0)return null;var{startAngle:l,endAngle:c}=$Pe(t),d=a,u;if(l<=c){for(;d>c;)d-=360;for(;d<l;)d+=360;u=d>=l&&d<=c}else{for(;d>l;)d-=360;for(;d<c;)d+=360;u=d>=c&&d<=l}return u?TX(TX({},t),{},{radius:o,angle:WPe(d,t)}):null}});function FD(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}var $_=L(()=>{});function DX(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Wl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DX(Object(r),!0).forEach(function(n){RPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DX(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RPe(e,t,r){return(t=UPe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UPe(e){var t=VPe(e,"string");return typeof t=="symbol"?t:t+""}function VPe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nn(e,t,r){return cr(e)||cr(t)?r:Sa(t)?(0,AX.default)(e,t,r):typeof t=="function"?t(e):r}function OD(e){return e==null?void 0:String(e)}function Py(e){var{axis:t,ticks:r,bandSize:n,entry:o,index:a,dataKey:i}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!cr(o[t.dataKey])){var s=$P(r,"value",o[t.dataKey]);if(s)return s.coordinate+n/2}return r[a]?r[a].coordinate+n/2:null}var l=nn(o,cr(i)?t.dataKey:i);return cr(l)?null:t.scale(l)}function q_(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:o,name:a}=e;return Wl(Wl({},t),{},{dataKey:r,payload:n,value:o,name:a})}function Gu(e,t){if(e)return String(e);if(typeof t=="string")return t}function _X(e,t,r,n,o){if(r==="horizontal"||r==="vertical"){var a=e>=o.left&&e<=o.left+o.width&&t>=o.top&&t<=o.top+o.height;return a?{x:e,y:t}:null}return n?PX({x:e,y:t},n):null}var IX,AX,LX,NX,hs,W_,R_,EX,MX,FX,HPe,qPe,GPe,OX,U_,jX,YPe,KPe,zX,V_,H_,Mc,BX,$X,Ka=L(()=>{IX=q(J0()),AX=q(W0());rD();nr();Og();$_();LX=(e,t,r,n,o)=>{var a,i=-1,s=(a=t==null?void 0:t.length)!==null&&a!==void 0?a:0;if(s<=1||e==null)return 0;if(n==="angleAxis"&&o!=null&&Math.abs(Math.abs(o[1]-o[0])-360)<=1e-6)for(var l=0;l<s;l++){var c=l>0?r[l-1].coordinate:r[s-1].coordinate,d=r[l].coordinate,u=l>=s-1?r[0].coordinate:r[l+1].coordinate,p=void 0;if(To(d-c)!==To(u-d)){var m=[];if(To(u-d)===To(o[1]-o[0])){p=u;var f=d+o[1]-o[0];m[0]=Math.min(f,(f+c)/2),m[1]=Math.max(f,(f+c)/2)}else{p=c;var g=u+o[1]-o[0];m[0]=Math.min(d,(g+d)/2),m[1]=Math.max(d,(g+d)/2)}var v=[Math.min(d,(p+d)/2),Math.max(d,(p+d)/2)];if(e>v[0]&&e<=v[1]||e>=m[0]&&e<=m[1]){({index:i}=r[l]);break}}else{var h=Math.min(c,u),y=Math.max(c,u);if(e>(h+d)/2&&e<=(y+d)/2){({index:i}=r[l]);break}}}else if(t){for(var b=0;b<s;b++)if(b===0&&e<=(t[b].coordinate+t[b+1].coordinate)/2||b>0&&b<s-1&&e>(t[b].coordinate+t[b-1].coordinate)/2&&e<=(t[b].coordinate+t[b+1].coordinate)/2||b===s-1&&e>(t[b].coordinate+t[b-1].coordinate)/2){({index:i}=t[b]);break}}return i},NX=(e,t,r)=>{if(t&&r){var{width:n,height:o}=r,{align:a,verticalAlign:i,layout:s}=t;if((s==="vertical"||s==="horizontal"&&i==="middle")&&a!=="center"&&Re(e[a]))return Wl(Wl({},e),{},{[a]:e[a]+(n||0)});if((s==="horizontal"||s==="vertical"&&a==="center")&&i!=="middle"&&Re(e[i]))return Wl(Wl({},e),{},{[i]:e[i]+(o||0)})}return e},hs=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",W_=(e,t,r,n)=>{if(n)return e.map(s=>s.coordinate);var o,a,i=e.map(s=>(s.coordinate===t&&(o=!0),s.coordinate===r&&(a=!0),s.coordinate));return o||i.push(t),a||i.push(r),i},R_=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:o,range:a,scale:i,realScaleType:s,isCategorical:l,categoricalDomain:c,tickCount:d,ticks:u,niceTicks:p,axisType:m}=e;if(!i)return null;var f=s==="scaleBand"&&i.bandwidth?i.bandwidth()/2:2,g=(t||r)&&o==="category"&&i.bandwidth?i.bandwidth()/f:0;if(g=m==="angleAxis"&&a&&a.length>=2?To(a[0]-a[1])*2*g:g,t&&(u||p)){var v=(u||p||[]).map((h,y)=>{var b=n?n.indexOf(h):h;return{coordinate:i(b)+g,value:h,offset:g,index:y}});return v.filter(h=>!Mn(h.coordinate))}return l&&c?c.map((h,y)=>({coordinate:i(h)+g,value:h,index:y,offset:g})):i.ticks&&!r&&d!=null?i.ticks(d).map((h,y)=>({coordinate:i(h)+g,value:h,offset:g,index:y})):i.domain().map((h,y)=>({coordinate:i(h)+g,value:n?n[h]:h,index:y,offset:g}))},EX=1e-4,MX=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),o=Math.min(n[0],n[1])-EX,a=Math.max(n[0],n[1])+EX,i=e(t[0]),s=e(t[r-1]);(i<o||i>a||s<o||s>a)&&e.domain([t[0],t[r-1]])}},FX=(e,t)=>{if(!t||t.length!==2||!Re(t[0])||!Re(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),o=[e[0],e[1]];return(!Re(e[0])||e[0]<r)&&(o[0]=r),(!Re(e[1])||e[1]>n)&&(o[1]=n),o[0]>n&&(o[0]=n),o[1]<r&&(o[1]=r),o},HPe=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var o=0,a=0,i=0;i<t;++i){var s=Mn(e[i][r][1])?e[i][r][0]:e[i][r][1];s>=0?(e[i][r][0]=o,e[i][r][1]=o+s,o=e[i][r][1]):(e[i][r][0]=a,e[i][r][1]=a+s,a=e[i][r][1])}},qPe=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var o=0,a=0;a<t;++a){var i=Mn(e[a][r][1])?e[a][r][0]:e[a][r][1];i>=0?(e[a][r][0]=o,e[a][r][1]=o+i,o=e[a][r][1]):(e[a][r][0]=0,e[a][r][1]=0)}},GPe={sign:HPe,expand:xz,none:Bl,silhouette:wz,wiggle:kz,positive:qPe},OX=(e,t,r)=>{var n=GPe[r],o=bz().keys(t).value((a,i)=>+nn(a,i,0)).order(yy).offset(n);return o(e)};U_=e=>{var{axis:t,ticks:r,offset:n,bandSize:o,entry:a,index:i}=e;if(t.type==="category")return r[i]?r[i].coordinate+n:null;var s=nn(a,t.dataKey,t.scale.domain()[i]);return cr(s)?null:t.scale(s)-o/2+n},jX=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),o=Math.max(r[0],r[1]);return n<=0&&o>=0?0:o<0?o:n}return r[0]},YPe=e=>{var t=e.flat(2).filter(Re);return[Math.min(...t),Math.max(...t)]},KPe=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],zX=(e,t,r)=>{if(e!=null)return KPe(Object.keys(e).reduce((n,o)=>{var a=e[o],{stackedData:i}=a,s=i.reduce((l,c)=>{var d=FD(c,t,r),u=YPe(d);return[Math.min(l[0],u[0]),Math.max(l[1],u[1])]},[1/0,-1/0]);return[Math.min(s[0],n[0]),Math.max(s[1],n[1])]},[1/0,-1/0]))},V_=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,H_=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Mc=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var o=(0,IX.default)(t,d=>d.coordinate),a=1/0,i=1,s=o.length;i<s;i++){var l=o[i],c=o[i-1];a=Math.min((l.coordinate||0)-(c.coordinate||0),a)}return a===1/0?0:a}return r?void 0:0};BX=(e,t,r,n)=>{var o=t.find(c=>c&&c.index===r);if(o){if(e==="horizontal")return{x:o.coordinate,y:n.y};if(e==="vertical")return{x:n.x,y:o.coordinate};if(e==="centric"){var a=o.coordinate,{radius:i}=n;return Wl(Wl(Wl({},n),mo(n.cx,n.cy,i,a)),{},{angle:a,radius:i})}var s=o.coordinate,{angle:l}=n;return Wl(Wl(Wl({},n),mo(n.cx,n.cy,s,l)),{},{angle:l,radius:s})}return{x:0,y:0}},$X=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius});var hi,vi,WX,jD,Nd=L(()=>{hi=e=>e.layout.width,vi=e=>e.layout.height,WX=e=>e.layout.scale,jD=e=>e.layout.margin});var Dy,Ey,G_=L(()=>{Pa();Dy=ie(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),Ey=ie(e=>e.cartesianAxis.yAxis,e=>Object.values(e))});var RX,UX,jg,zD=L(()=>{RX="data-recharts-item-index",UX="data-recharts-item-data-key",jg=60});function VX(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _D(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VX(Object(r),!0).forEach(function(n){JPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VX(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function JPe(e,t,r){return(t=XPe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XPe(e){var t=QPe(e,"string");return typeof t=="symbol"?t:t+""}function QPe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eDe(e){var t=Ey(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var o=typeof n.width=="number"?n.width:jg;return r+o}return r},0)}function tDe(e){var t=Ey(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var o=typeof n.width=="number"?n.width:jg;return r+o}return r},0)}function rDe(e){var t=Dy(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function nDe(e){var t=Dy(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var ZPe,on,HX,Iy,Rl=L(()=>{Pa();k_();Ka();Nd();G_();zD();ZPe=e=>e.brush.height;on=ie([hi,vi,jD,ZPe,eDe,tDe,rDe,nDe,w_,EJ],(e,t,r,n,o,a,i,s,l,c)=>{var d={left:(r.left||0)+o,right:(r.right||0)+a},u={top:(r.top||0)+i,bottom:(r.bottom||0)+s},p=_D(_D({},u),d),m=p.bottom;p.bottom+=n,p=NX(p,l,c);var f=e-p.left-p.right,g=t-p.top-p.bottom;return _D(_D({brushBottom:m},p),{},{width:Math.max(f,0),height:Math.max(g,0)})}),HX=ie(on,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),Iy=ie(hi,vi,(e,t)=>({x:0,y:0,width:e,height:t}))});var oDe,BD,aDe,jr,Wi=L(()=>{oDe=q(Y()),BD=q(Y()),aDe=(0,BD.createContext)(null),jr=()=>(0,BD.useContext)(aDe)!=null});var Ay,zg,$D=L(()=>{Pa();Rl();Nd();nr();Ay=e=>e.brush,zg=ie([Ay,on,jD],(e,t,r)=>({height:e.height,x:Re(e.x)?e.x:t.left,y:Re(e.y)?e.y:t.top+t.height+t.brushBottom-((r==null?void 0:r.bottom)||0),width:Re(e.width)?e.width:t.width}))});var iDe,Dm,sDe,WD,Ly,Ny,qX,zt,Md,Co=L(()=>{iDe=q(Y());Or();Rl();Nd();Wi();$D();Dm=()=>{var e,t=jr(),r=Oe(HX),n=Oe(zg),o=(e=Oe(Ay))===null||e===void 0?void 0:e.padding;return!t||!n||!o?r:{width:n.width-o.left-o.right,height:n.height-o.top-o.bottom,x:o.left,y:o.top}},sDe={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},WD=()=>{var e;return(e=Oe(on))!==null&&e!==void 0?e:sDe},Ly=()=>Oe(hi),Ny=()=>Oe(vi),qX=()=>Oe(e=>e.layout.margin),zt=e=>e.layout.layoutType,Md=()=>Oe(zt)});var lDe,GX,Y_,YX,KX,JX,XX,RD=L(()=>{oa();lDe={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},GX=hn({name:"legend",initialState:lDe,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var r=gs(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)}}}),{setLegendSize:Y_,setLegendSettings:YX,addLegendPayload:KX,removeLegendPayload:JX}=GX.actions,XX=GX.reducer});function K_(){return K_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},K_.apply(null,arguments)}function QX(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function My(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QX(Object(r),!0).forEach(function(n){J_(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QX(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function J_(e,t,r){return(t=dDe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dDe(e){var t=uDe(e,"string");return typeof t=="symbol"?t:t+""}function uDe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pDe(e,t){if(e==null)return{};var r,n,o=mDe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function mDe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function fDe(e){return e.value}function gDe(e){var{contextPayload:t}=e,r=pDe(e,cDe),n=sD(t,e.payloadUniqBy,fDe),o=My(My({},r),{},{payload:n});return Ul.isValidElement(e.content)?Ul.cloneElement(e.content,o):typeof e.content=="function"?Ul.createElement(e.content,o):Ul.createElement(by,o)}function hDe(e,t,r,n,o,a){var{layout:i,align:s,verticalAlign:l}=t,c,d;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(s==="center"&&i==="vertical"?c={left:((n||0)-a.width)/2}:c=s==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(l==="middle"?d={top:((o||0)-a.height)/2}:d=l==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),My(My({},c),d)}function vDe(e){var t=or();return(0,rk.useEffect)(()=>{t(YX(e))},[t,e]),null}function yDe(e){var t=or();return(0,rk.useEffect)(()=>(t(Y_(e)),()=>{t(Y_({width:0,height:0}))}),[t,e]),null}function bDe(e){var t=AJ(),r=qK(),n=qX(),{width:o,height:a,wrapperStyle:i,portal:s}=e,[l,c]=mD([t]),d=Ly(),u=Ny();if(d==null||u==null)return null;var p=d-(n.left||0)-(n.right||0),m=Em.getWidthOrHeight(e.layout,a,o,p),f=s?i:My(My({position:"absolute",width:(m==null?void 0:m.width)||o||"auto",height:(m==null?void 0:m.height)||a||"auto"},hDe(i,e,n,d,u,l)),i),g=s!=null?s:r;if(g==null)return null;var v=Ul.createElement("div",{className:"recharts-legend-wrapper",style:f,ref:c},Ul.createElement(vDe,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),Ul.createElement(yDe,{width:l.width,height:l.height}),Ul.createElement(gDe,K_({},e,m,{margin:n,chartWidth:d,chartHeight:u,contextPayload:t})));return(0,ZX.createPortal)(v,g)}var Ul,rk,ZX,cDe,Em,eQ=L(()=>{Ul=q(Y()),rk=q(Y()),ZX=q(vc());Uj();z7();nr();l_();LJ();S_();Co();RD();Or();cDe=["contextPayload"];Em=class extends rk.PureComponent{static getWidthOrHeight(t,r,n,o){return t==="vertical"&&Re(r)?{height:r}:t==="horizontal"?{width:n||o}:null}render(){return Ul.createElement(bDe,this.props)}};J_(Em,"displayName","Legend");J_(Em,"defaultProps",{align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"})});function Q_(){return Q_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Q_.apply(null,arguments)}function tQ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function X_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tQ(Object(r),!0).forEach(function(n){xDe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tQ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xDe(e,t,r){return(t=wDe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wDe(e){var t=kDe(e,"string");return typeof t=="symbol"?t:t+""}function kDe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function SDe(e){return Array.isArray(e)&&Sa(e[0])&&Sa(e[1])?e.join(" ~ "):e}var Fc,rQ,nQ,oQ=L(()=>{Fc=q(Y()),rQ=q(J0());Nn();nr();nQ=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:o={},payload:a,formatter:i,itemSorter:s,wrapperClassName:l,labelClassName:c,label:d,labelFormatter:u,accessibilityLayer:p=!1}=e,m=()=>{if(a&&a.length){var w={padding:0,margin:0},S=(s?(0,rQ.default)(a,s):a).map((k,T)=>{if(k.type==="none")return null;var P=k.formatter||i||SDe,{value:D,name:O}=k,z=D,I=O;if(P){var A=P(D,O,k,T,a);if(Array.isArray(A))[z,I]=A;else if(A!=null)z=A;else return null}var j=X_({display:"block",paddingTop:4,paddingBottom:4,color:k.color||"#000"},n);return Fc.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(T),style:j},Sa(I)?Fc.createElement("span",{className:"recharts-tooltip-item-name"},I):null,Sa(I)?Fc.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,Fc.createElement("span",{className:"recharts-tooltip-item-value"},z),Fc.createElement("span",{className:"recharts-tooltip-item-unit"},k.unit||""))});return Fc.createElement("ul",{className:"recharts-tooltip-item-list",style:w},S)}return null},f=X_({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),g=X_({margin:0},o),v=!cr(d),h=v?d:"",y=mt("recharts-default-tooltip",l),b=mt("recharts-tooltip-label",c);v&&u&&a!==void 0&&a!==null&&(h=u(d,a));var x=p?{role:"status","aria-live":"assertive"}:{};return Fc.createElement("div",Q_({className:y,style:f},x),Fc.createElement("p",{className:b,style:g},Fc.isValidElement(h)?h:"".concat(h)),m())}});function CDe(e){var{coordinate:t,translateX:r,translateY:n}=e;return mt(nk,{["".concat(nk,"-right")]:Re(r)&&t&&Re(t.x)&&r>=t.x,["".concat(nk,"-left")]:Re(r)&&t&&Re(t.x)&&r<t.x,["".concat(nk,"-bottom")]:Re(n)&&t&&Re(t.y)&&n>=t.y,["".concat(nk,"-top")]:Re(n)&&t&&Re(t.y)&&n<t.y})}function aQ(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:o,position:a,reverseDirection:i,tooltipDimension:s,viewBox:l,viewBoxDimension:c}=e;if(a&&Re(a[n]))return a[n];var d=r[n]-s-(o>0?o:0),u=r[n]+o;if(t[n])return i[n]?d:u;var p=l[n];if(p==null)return 0;if(i[n]){var m=d,f=p;return m<f?Math.max(u,p):Math.max(d,p)}if(c==null)return 0;var g=u+s,v=p+c;return g>v?Math.max(d,p):Math.max(u,p)}function PDe(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function iQ(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:o,reverseDirection:a,tooltipBox:i,useTranslate3d:s,viewBox:l}=e,c,d,u;return i.height>0&&i.width>0&&r?(d=aQ({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:o,reverseDirection:a,tooltipDimension:i.width,viewBox:l,viewBoxDimension:l.width}),u=aQ({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:o,reverseDirection:a,tooltipDimension:i.height,viewBox:l,viewBoxDimension:l.height}),c=PDe({translateX:d,translateY:u,useTranslate3d:s})):c=TDe,{cssProperties:c,cssClasses:CDe({translateX:d,translateY:u,coordinate:r})}}var nk,TDe,sQ=L(()=>{Nn();nr();nk="recharts-tooltip-wrapper",TDe={visibility:"hidden"}});function lQ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function UD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lQ(Object(r),!0).forEach(function(n){Z_(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lQ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Z_(e,t,r){return(t=DDe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DDe(e){var t=EDe(e,"string");return typeof t=="symbol"?t:t+""}function EDe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cQ,dQ,VD,uQ=L(()=>{cQ=q(Y()),dQ=q(Y());sQ();VD=class extends dQ.PureComponent{constructor(){super(...arguments),Z_(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),Z_(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,o,a;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(o=(a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==null&&o!==void 0?o:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:o,children:a,coordinate:i,hasPayload:s,isAnimationActive:l,offset:c,position:d,reverseDirection:u,useTranslate3d:p,viewBox:m,wrapperStyle:f,lastBoundingBox:g,innerRef:v,hasPortalFromProps:h}=this.props,{cssClasses:y,cssProperties:b}=iQ({allowEscapeViewBox:r,coordinate:i,offsetTopLeft:c,position:d,reverseDirection:u,tooltipBox:{height:g.height,width:g.width},useTranslate3d:p,viewBox:m}),x=h?{}:UD(UD({transition:l&&t?"transform ".concat(n,"ms ").concat(o):void 0},b),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&s?"visible":"hidden",position:"absolute",top:0,left:0}),w=UD(UD({},x),{},{visibility:!this.state.dismissed&&t&&s?"visible":"hidden"},f);return cQ.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:y,style:w,ref:v},a)}}});var IDe,vs,Im=L(()=>{IDe=()=>!(typeof window!="undefined"&&window.document&&window.document.createElement&&window.setTimeout),vs={isSsr:IDe()}});var HD,eB=L(()=>{Or();HD=()=>Oe(e=>e.rootProps.accessibilityLayer)});function Fn(e){return Number.isFinite(e)}function Fy(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}var Fd=L(()=>{});function tB(){return tB=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tB.apply(null,arguments)}function pQ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function mQ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pQ(Object(r),!0).forEach(function(n){ADe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pQ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ADe(e,t,r){return(t=LDe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LDe(e){var t=NDe(e,"string");return typeof t=="symbol"?t:t+""}function NDe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gQ,fQ,qD,ok,ak,MDe,FDe,Am,GD=L(()=>{gQ=q(Y());rD();Nn();Tm();nr();Fd();Ld();fQ={curveBasisClosed:lz,curveBasisOpen:cz,curveBasis:sz,curveBumpX:Kj,curveBumpY:Jj,curveLinearClosed:dz,curveLinear:Pm,curveMonotoneX:pz,curveMonotoneY:mz,curveNatural:fz,curveStep:gz,curveStepAfter:vz,curveStepBefore:hz},qD=e=>Fn(e.x)&&Fn(e.y),ok=e=>e.x,ak=e=>e.y,MDe=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(Sm(e));return(r==="curveMonotone"||r==="curveBump")&&t?fQ["".concat(r).concat(t==="vertical"?"Y":"X")]:fQ[r]||Pm},FDe=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:o,connectNulls:a=!1}=e,i=MDe(t,o),s=a?r.filter(qD):r,l;if(Array.isArray(n)){var c=a?n.filter(u=>qD(u)):n,d=s.map((u,p)=>mQ(mQ({},u),{},{base:c[p]}));return o==="vertical"?l=my().y(ak).x1(ok).x0(u=>u.base.x):l=my().x(ok).y1(ak).y0(u=>u.base.y),l.defined(qD).curve(i),l(d)}return o==="vertical"&&Re(n)?l=my().y(ak).x1(ok).x0(n):Re(n)?l=my().x(ok).y1(ak).y0(n):l=q0().x(ok).y(ak),l.defined(qD).curve(i),l(s)},Am=e=>{var{className:t,points:r,path:n,pathRef:o}=e;if((!r||!r.length)&&!n)return null;var a=r&&r.length?FDe(e):n;return gQ.createElement("path",tB({},Ga(e),ly(e),{className:mt("recharts-curve",t),d:a===null?void 0:a,ref:o}))}});function rB(){return rB=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rB.apply(null,arguments)}function hQ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function jDe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hQ(Object(r),!0).forEach(function(n){zDe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hQ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zDe(e,t,r){return(t=_De(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _De(e){var t=BDe(e,"string");return typeof t=="symbol"?t:t+""}function BDe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $De(e,t){if(e==null)return{};var r,n,o=WDe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function WDe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var vQ,ODe,RDe,yQ,bQ=L(()=>{vQ=q(Y());Nn();nr();Ta();ODe=["x","y","top","left","width","height","className"];RDe=(e,t,r,n,o,a)=>"M".concat(e,",").concat(o,"v").concat(n,"M").concat(a,",").concat(t,"h").concat(r),yQ=e=>{var{x:t=0,y:r=0,top:n=0,left:o=0,width:a=0,height:i=0,className:s}=e,l=$De(e,ODe),c=jDe({x:t,y:r,top:n,left:o,width:a,height:i},l);return!Re(t)||!Re(r)||!Re(a)||!Re(i)||!Re(n)||!Re(o)?null:vQ.createElement("path",rB({},Wt(c,!0),{className:mt("recharts-cross",s),d:RDe(t,r,a,i,n,o)}))}});function xQ(e,t,r,n){var o=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-o:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-o,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}var wQ=L(()=>{});function kQ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function UDe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kQ(Object(r),!0).forEach(function(n){VDe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kQ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VDe(e,t,r){return(t=HDe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HDe(e){var t=qDe(e,"string");return typeof t=="symbol"?t:t+""}function qDe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function On(e,t){var r=UDe({},e),n=t,o=Object.keys(t),a=o.reduce((i,s)=>(i[s]===void 0&&n[s]!==void 0&&(i[s]=n[s]),i),r);return a}var Vl=L(()=>{});function nB(){}var SQ=L(()=>{});var TQ=L(()=>{SQ()});function CQ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function PQ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CQ(Object(r),!0).forEach(function(n){GDe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CQ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GDe(e,t,r){return(t=YDe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YDe(e){var t=KDe(e,"string");return typeof t=="symbol"?t:t+""}function KDe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var JDe,YD,DQ,Oy,KD=L(()=>{JDe=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),YD=(e,t,r)=>e.map(n=>"".concat(JDe(n)," ").concat(t,"ms ").concat(r)).join(","),DQ=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(o=>n.includes(o))),Oy=(e,t)=>Object.keys(t).reduce((r,n)=>PQ(PQ({},r),{},{[n]:e(n,t[n])}),{})});function EQ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Ja(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EQ(Object(r),!0).forEach(function(n){XDe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EQ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XDe(e,t,r){return(t=QDe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QDe(e){var t=ZDe(e,"string");return typeof t=="symbol"?t:t+""}function ZDe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eEe(e,t,r,n,o,a){var i,s=n.reduce((p,m)=>Ja(Ja({},p),{},{[m]:{from:e[m],velocity:0,to:t[m]}}),{}),l=()=>Oy((p,m)=>m.from,s),c=()=>!Object.values(s).filter(oB).length,d=null,u=p=>{i||(i=p);var m=p-i,f=m/r.dt;s=IQ(r,s,f),o(Ja(Ja(Ja({},e),t),l())),i=p,c()||(d=a.setTimeout(u))};return()=>(d=a.setTimeout(u),()=>{d()})}function tEe(e,t,r,n,o,a,i){var s=null,l=o.reduce((u,p)=>Ja(Ja({},u),{},{[p]:[e[p],t[p]]}),{}),c,d=u=>{c||(c=u);var p=(u-c)/n,m=Oy((g,v)=>JD(...v,r(p)),l);if(a(Ja(Ja(Ja({},e),t),m)),p<1)s=i.setTimeout(d);else{var f=Oy((g,v)=>JD(...v,r(1)),l);a(Ja(Ja(Ja({},e),t),f))}};return()=>(s=i.setTimeout(d),()=>{s()})}var JD,oB,IQ,AQ,LQ=L(()=>{KD();JD=(e,t,r)=>e+(t-e)*r,oB=e=>{var{from:t,to:r}=e;return t!==r},IQ=(e,t,r)=>{var n=Oy((o,a)=>{if(oB(a)){var[i,s]=e(a.from,a.to,a.velocity);return Ja(Ja({},a),{},{from:i,velocity:s})}return a},t);return r<1?Oy((o,a)=>oB(a)?Ja(Ja({},a),{},{velocity:JD(a.velocity,n[o].velocity,r),from:JD(a.from,n[o].from,r)}):a,t):IQ(e,n,r-1)};AQ=(e,t,r,n,o,a)=>{var i=DQ(e,t);return r.isStepper===!0?eEe(e,t,r,i,o,a):tEe(e,t,r,n,i,o,a)}});var XD,FQ,OQ,NQ,rEe,MQ,nEe,jQ,zQ=L(()=>{XD=1e-4,FQ=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],OQ=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),NQ=(e,t)=>r=>{var n=FQ(e,t);return OQ(n,r)},rEe=(e,t)=>r=>{var n=FQ(e,t),o=[...n.map((a,i)=>a*i).slice(1),0];return OQ(o,r)},MQ=function(){for(var t,r,n,o,a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];if(i.length===1)switch(i[0]){case"linear":[t,n,r,o]=[0,0,1,1];break;case"ease":[t,n,r,o]=[.25,.1,.25,1];break;case"ease-in":[t,n,r,o]=[.42,0,1,1];break;case"ease-out":[t,n,r,o]=[.42,0,.58,1];break;case"ease-in-out":[t,n,r,o]=[0,0,.58,1];break;default:{var l=i[0].split("(");l[0]==="cubic-bezier"&&l[1].split(")")[0].split(",").length===4&&([t,n,r,o]=l[1].split(")")[0].split(",").map(f=>parseFloat(f)))}}else i.length===4&&([t,n,r,o]=i);var c=NQ(t,r),d=NQ(n,o),u=rEe(t,r),p=f=>f>1?1:f<0?0:f,m=f=>{for(var g=f>1?1:f,v=g,h=0;h<8;++h){var y=c(v)-g,b=u(v);if(Math.abs(y-g)<XD||b<XD)return d(v);v=p(v-y/b)}return d(v)};return m.isStepper=!1,m},nEe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:o=17}=t,a=(i,s,l)=>{var c=-(i-s)*r,d=l*n,u=l+(c-d)*o/1e3,p=l*o/1e3+i;return Math.abs(p-s)<XD&&Math.abs(u)<XD?[s,0]:[p,u]};return a.isStepper=!0,a.dt=o,a},jQ=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return MQ(e);case"spring":return nEe();default:if(e.split("(")[0]==="cubic-bezier")return MQ(e)}return typeof e=="function"?e:null}});function _Q(e){var t,r=()=>null,n=!1,o=null,a=i=>{if(!n){if(Array.isArray(i)){if(!i.length)return;var s=i,[l,...c]=s;if(typeof l=="number"){o=e.setTimeout(a.bind(null,c),l);return}a(l),o=e.setTimeout(a.bind(null,c));return}typeof i=="string"&&(t=i,r(t)),typeof i=="object"&&(t=i,r(t)),typeof i=="function"&&i()}};return{stop:()=>{n=!0},start:i=>{n=!1,o&&(o(),o=null),a(i)},subscribe:i=>(r=i,()=>{r=()=>null}),getTimeoutController:()=>e}}var BQ=L(()=>{});var QD,$Q=L(()=>{QD=class{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),o=null,a=i=>{i-n>=r?t(i):typeof requestAnimationFrame=="function"&&(o=requestAnimationFrame(a))};return o=requestAnimationFrame(a),()=>{cancelAnimationFrame(o)}}}});function WQ(){return _Q(new QD)}var RQ=L(()=>{BQ();$Q()});function UQ(e,t){var r=(0,jy.useContext)(oEe);return(0,jy.useMemo)(()=>t!=null?t:r(e),[e,t,r])}var jy,oEe,VQ=L(()=>{jy=q(Y());RQ();oEe=(0,jy.createContext)(WQ)});function Od(e){var t=On(e,aEe),{isActive:r,canBegin:n,duration:o,easing:a,begin:i,onAnimationEnd:s,onAnimationStart:l,children:c}=t,d=UQ(t.animationId,t.animationManager),[u,p]=(0,_g.useState)(r?HQ:aB),m=(0,_g.useRef)(null);return(0,_g.useEffect)(()=>{r||p(aB)},[r]),(0,_g.useEffect)(()=>{if(!r||!n)return nB;var f=AQ(HQ,aB,jQ(a),o,p,d.getTimeoutController()),g=()=>{m.current=f()};return d.start([l,i,g,o,s]),()=>{d.stop(),m.current&&m.current(),s()}},[r,n,o,a,i,l,s,d]),c(u.t)}var _g,aEe,HQ,aB,zy=L(()=>{_g=q(Y());TQ();Vl();LQ();zQ();VQ();aEe={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},HQ={t:0},aB={t:1}});function jd(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=(0,iB.useRef)(Uu(t)),n=(0,iB.useRef)(e);return n.current!==e&&(r.current=Uu(t),n.current=e),r.current}var iB,_y=L(()=>{iB=q(Y());nr()});function qQ(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function GQ(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qQ(Object(r),!0).forEach(function(n){iEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qQ(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iEe(e,t,r){return(t=sEe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sEe(e){var t=lEe(e,"string");return typeof t=="symbol"?t:t+""}function lEe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eE(){return eE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},eE.apply(null,arguments)}var ZD,Hl,YQ,cEe,tE,sB=L(()=>{ZD=q(Y()),Hl=q(Y());Nn();Ta();Vl();zy();nr();_y();KD();YQ=(e,t,r,n,o)=>{var a=Math.min(Math.abs(r)/2,Math.abs(n)/2),i=n>=0?1:-1,s=r>=0?1:-1,l=n>=0&&r>=0||n<0&&r<0?1:0,c;if(a>0&&o instanceof Array){for(var d=[0,0,0,0],u=0,p=4;u<p;u++)d[u]=o[u]>a?a:o[u];c="M".concat(e,",").concat(t+i*d[0]),d[0]>0&&(c+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(l,",").concat(e+s*d[0],",").concat(t)),c+="L ".concat(e+r-s*d[1],",").concat(t),d[1]>0&&(c+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(l,`,
        `).concat(e+r,",").concat(t+i*d[1])),c+="L ".concat(e+r,",").concat(t+n-i*d[2]),d[2]>0&&(c+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(l,`,
        `).concat(e+r-s*d[2],",").concat(t+n)),c+="L ".concat(e+s*d[3],",").concat(t+n),d[3]>0&&(c+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(l,`,
        `).concat(e,",").concat(t+n-i*d[3])),c+="Z"}else if(a>0&&o===+o&&o>0){var m=Math.min(a,o);c="M ".concat(e,",").concat(t+i*m,`
            A `).concat(m,",").concat(m,",0,0,").concat(l,",").concat(e+s*m,",").concat(t,`
            L `).concat(e+r-s*m,",").concat(t,`
            A `).concat(m,",").concat(m,",0,0,").concat(l,",").concat(e+r,",").concat(t+i*m,`
            L `).concat(e+r,",").concat(t+n-i*m,`
            A `).concat(m,",").concat(m,",0,0,").concat(l,",").concat(e+r-s*m,",").concat(t+n,`
            L `).concat(e+s*m,",").concat(t+n,`
            A `).concat(m,",").concat(m,",0,0,").concat(l,",").concat(e,",").concat(t+n-i*m," Z")}else c="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return c},cEe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},tE=e=>{var t=On(e,cEe),r=(0,Hl.useRef)(null),[n,o]=(0,Hl.useState)(-1);(0,Hl.useEffect)(()=>{if(r.current&&r.current.getTotalLength)try{var A=r.current.getTotalLength();A&&o(A)}catch(j){}},[]);var{x:a,y:i,width:s,height:l,radius:c,className:d}=t,{animationEasing:u,animationDuration:p,animationBegin:m,isAnimationActive:f,isUpdateAnimationActive:g}=t,v=(0,Hl.useRef)(s),h=(0,Hl.useRef)(l),y=(0,Hl.useRef)(a),b=(0,Hl.useRef)(i),x=(0,Hl.useMemo)(()=>({x:a,y:i,width:s,height:l,radius:c}),[a,i,s,l,c]),w=jd(x,"rectangle-");if(a!==+a||i!==+i||s!==+s||l!==+l||s===0||l===0)return null;var S=mt("recharts-rectangle",d);if(!g)return ZD.createElement("path",eE({},Wt(t,!0),{className:S,d:YQ(a,i,s,l,c)}));var k=v.current,T=h.current,P=y.current,D=b.current,O="0px ".concat(n===-1?1:n,"px"),z="".concat(n,"px 0px"),I=YD(["strokeDasharray"],p,typeof u=="string"?u:void 0);return ZD.createElement(Od,{animationId:w,key:w,canBegin:n>0,duration:p,easing:u,isActive:g,begin:m},A=>{var j=Fr(k,s,A),E=Fr(T,l,A),N=Fr(P,a,A),B=Fr(D,i,A);r.current&&(v.current=j,h.current=E,y.current=N,b.current=B);var C;return f?A>0?C={transition:I,strokeDasharray:z}:C={strokeDasharray:O}:C={strokeDasharray:z},ZD.createElement("path",eE({},Wt(t,!0),{className:S,d:YQ(N,B,j,E,c),ref:r,style:GQ(GQ({},C),t.style)}))})}});function rE(e){var{cx:t,cy:r,radius:n,startAngle:o,endAngle:a}=e,i=mo(t,r,n,o),s=mo(t,r,n,a);return{points:[i,s],cx:t,cy:r,radius:n,startAngle:o,endAngle:a}}var lB=L(()=>{Og()});function cB(){return cB=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cB.apply(null,arguments)}var KQ,dEe,nE,JQ,uEe,pEe,oE,dB=L(()=>{KQ=q(Y());Nn();Ta();Og();nr();Vl();dEe=(e,t)=>{var r=To(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},nE=e=>{var{cx:t,cy:r,radius:n,angle:o,sign:a,isExternal:i,cornerRadius:s,cornerIsExternal:l}=e,c=s*(i?1:-1)+n,d=Math.asin(s/c)/tk,u=l?o:o+a*d,p=mo(t,r,c,u),m=mo(t,r,n,u),f=l?o-a*d:o,g=mo(t,r,c*Math.cos(d*tk),f);return{center:p,circleTangency:m,lineTangency:g,theta:d}},JQ=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:o,startAngle:a,endAngle:i}=e,s=dEe(a,i),l=a+s,c=mo(t,r,o,a),d=mo(t,r,o,l),u="M ".concat(c.x,",").concat(c.y,`
    A `).concat(o,",").concat(o,`,0,
    `).concat(+(Math.abs(s)>180),",").concat(+(a>l),`,
    `).concat(d.x,",").concat(d.y,`
  `);if(n>0){var p=mo(t,r,n,a),m=mo(t,r,n,l);u+="L ".concat(m.x,",").concat(m.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(s)>180),",").concat(+(a<=l),`,
            `).concat(p.x,",").concat(p.y," Z")}else u+="L ".concat(t,",").concat(r," Z");return u},uEe=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:o,cornerRadius:a,forceCornerRadius:i,cornerIsExternal:s,startAngle:l,endAngle:c}=e,d=To(c-l),{circleTangency:u,lineTangency:p,theta:m}=nE({cx:t,cy:r,radius:o,angle:l,sign:d,cornerRadius:a,cornerIsExternal:s}),{circleTangency:f,lineTangency:g,theta:v}=nE({cx:t,cy:r,radius:o,angle:c,sign:-d,cornerRadius:a,cornerIsExternal:s}),h=s?Math.abs(l-c):Math.abs(l-c)-m-v;if(h<0)return i?"M ".concat(p.x,",").concat(p.y,`
        a`).concat(a,",").concat(a,",0,0,1,").concat(a*2,`,0
        a`).concat(a,",").concat(a,",0,0,1,").concat(-a*2,`,0
      `):JQ({cx:t,cy:r,innerRadius:n,outerRadius:o,startAngle:l,endAngle:c});var y="M ".concat(p.x,",").concat(p.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(u.x,",").concat(u.y,`
    A`).concat(o,",").concat(o,",0,").concat(+(h>180),",").concat(+(d<0),",").concat(f.x,",").concat(f.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(g.x,",").concat(g.y,`
  `);if(n>0){var{circleTangency:b,lineTangency:x,theta:w}=nE({cx:t,cy:r,radius:n,angle:l,sign:d,isExternal:!0,cornerRadius:a,cornerIsExternal:s}),{circleTangency:S,lineTangency:k,theta:T}=nE({cx:t,cy:r,radius:n,angle:c,sign:-d,isExternal:!0,cornerRadius:a,cornerIsExternal:s}),P=s?Math.abs(l-c):Math.abs(l-c)-w-T;if(P<0&&a===0)return"".concat(y,"L").concat(t,",").concat(r,"Z");y+="L".concat(k.x,",").concat(k.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(S.x,",").concat(S.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(P>180),",").concat(+(d>0),",").concat(b.x,",").concat(b.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(x.x,",").concat(x.y,"Z")}else y+="L".concat(t,",").concat(r,"Z");return y},pEe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},oE=e=>{var t=On(e,pEe),{cx:r,cy:n,innerRadius:o,outerRadius:a,cornerRadius:i,forceCornerRadius:s,cornerIsExternal:l,startAngle:c,endAngle:d,className:u}=t;if(a<o||c===d)return null;var p=mt("recharts-sector",u),m=a-o,f=gi(i,m,0,!0),g;return f>0&&Math.abs(c-d)<360?g=uEe({cx:r,cy:n,innerRadius:o,outerRadius:a,cornerRadius:Math.min(f,m/2),forceCornerRadius:s,cornerIsExternal:l,startAngle:c,endAngle:d}):g=JQ({cx:r,cy:n,innerRadius:o,outerRadius:a,startAngle:c,endAngle:d}),KQ.createElement("path",cB({},Wt(t,!0),{className:p,d:g}))}});function XQ(e,t,r){var n,o,a,i;if(e==="horizontal")n=t.x,a=n,o=r.top,i=r.top+r.height;else if(e==="vertical")o=t.y,i=o,n=r.left,a=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:s,cy:l,innerRadius:c,outerRadius:d,angle:u}=t,p=mo(s,l,c,u),m=mo(s,l,d,u);n=p.x,o=p.y,a=m.x,i=m.y}else return rE(t);return[{x:n,y:o},{x:a,y:i}]}var QQ=L(()=>{Og();lB()});var ZQ=Ie(uB=>{"use strict";Object.defineProperty(uB,Symbol.toStringTag,{value:"Module"});var mEe=f_();function fEe(e){return mEe.isSymbol(e)?NaN:Number(e)}uB.toNumber=fEe});var eZ=Ie(pB=>{"use strict";Object.defineProperty(pB,Symbol.toStringTag,{value:"Module"});var gEe=ZQ();function hEe(e){return e?(e=gEe.toNumber(e),e===1/0||e===-1/0?(e<0?-1:1)*Number.MAX_VALUE:e===e?e:0):e===0?e:0}pB.toFinite=hEe});var tZ=Ie(fB=>{"use strict";Object.defineProperty(fB,Symbol.toStringTag,{value:"Module"});var vEe=b_(),mB=eZ();function yEe(e,t,r){r&&typeof r!="number"&&vEe.isIterateeCall(e,t,r)&&(t=r=void 0),e=mB.toFinite(e),t===void 0?(t=e,e=0):t=mB.toFinite(t),r=r===void 0?e<t?1:-1:mB.toFinite(r);let n=Math.max(Math.ceil((t-e)/(r||1)),0),o=new Array(n);for(let a=0;a<n;a++)o[a]=e,e+=r;return o}fB.range=yEe});var nZ=Ie((Zet,rZ)=>{rZ.exports=tZ().range});function Ri(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}var ik=L(()=>{});function gB(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}var oZ=L(()=>{});function Bg(e){let t,r,n;e.length!==2?(t=Ri,r=(s,l)=>Ri(e(s),l),n=(s,l)=>e(s)-l):(t=e===Ri||e===gB?e:bEe,r=e,n=e);function o(s,l,c=0,d=s.length){if(c<d){if(t(l,l)!==0)return d;do{let u=c+d>>>1;r(s[u],l)<0?c=u+1:d=u}while(c<d)}return c}function a(s,l,c=0,d=s.length){if(c<d){if(t(l,l)!==0)return d;do{let u=c+d>>>1;r(s[u],l)<=0?c=u+1:d=u}while(c<d)}return c}function i(s,l,c=0,d=s.length){let u=o(s,l,c,d-1);return u>c&&n(s[u-1],l)>-n(s[u],l)?u-1:u}return{left:o,center:i,right:a}}function bEe(){return 0}var hB=L(()=>{ik();oZ()});function sk(e){return e===null?NaN:+e}function*aZ(e,t){if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(yield r);else{let r=-1;for(let n of e)(n=t(n,++r,e))!=null&&(n=+n)>=n&&(yield n)}}var vB=L(()=>{});var iZ,sZ,xEe,wEe,Oc,lZ=L(()=>{ik();hB();vB();iZ=Bg(Ri),sZ=iZ.right,xEe=iZ.left,wEe=Bg(sk).center,Oc=sZ});function cZ({_intern:e,_key:t},r){let n=t(r);return e.has(n)?e.get(n):r}function kEe({_intern:e,_key:t},r){let n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function SEe({_intern:e,_key:t},r){let n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function TEe(e){return e!==null&&typeof e=="object"?e.valueOf():e}var By,dZ=L(()=>{By=class extends Map{constructor(t,r=TEe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(let[n,o]of t)this.set(n,o)}get(t){return super.get(cZ(this,t))}has(t){return super.has(cZ(this,t))}set(t,r){return super.set(kEe(this,t),r)}delete(t){return super.delete(SEe(this,t))}}});function uZ(e=Ri){if(e===Ri)return yB;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{let n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function yB(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}var pZ=L(()=>{ik()});function aE(e,t,r){let n=(t-e)/Math.max(0,r),o=Math.floor(Math.log10(n)),a=n/Math.pow(10,o),i=a>=CEe?10:a>=PEe?5:a>=DEe?2:1,s,l,c;return o<0?(c=Math.pow(10,-o)/i,s=Math.round(e*c),l=Math.round(t*c),s/c<e&&++s,l/c>t&&--l,c=-c):(c=Math.pow(10,o)*i,s=Math.round(e/c),l=Math.round(t/c),s*c<e&&++s,l*c>t&&--l),l<s&&.5<=r&&r<2?aE(e,t,r*2):[s,l,c]}function $g(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];let n=t<e,[o,a,i]=n?aE(t,e,r):aE(e,t,r);if(!(a>=o))return[];let s=a-o+1,l=new Array(s);if(n)if(i<0)for(let c=0;c<s;++c)l[c]=(a-c)/-i;else for(let c=0;c<s;++c)l[c]=(a-c)*i;else if(i<0)for(let c=0;c<s;++c)l[c]=(o+c)/-i;else for(let c=0;c<s;++c)l[c]=(o+c)*i;return l}function lk(e,t,r){return t=+t,e=+e,r=+r,aE(e,t,r)[2]}function $y(e,t,r){t=+t,e=+e,r=+r;let n=t<e,o=n?lk(t,e,r):lk(e,t,r);return(n?-1:1)*(o<0?1/-o:o)}var CEe,PEe,DEe,mZ=L(()=>{CEe=Math.sqrt(50),PEe=Math.sqrt(10),DEe=Math.sqrt(2)});function iE(e,t){let r;if(t===void 0)for(let n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let o of e)(o=t(o,++n,e))!=null&&(r<o||r===void 0&&o>=o)&&(r=o)}return r}var fZ=L(()=>{});function sE(e,t){let r;if(t===void 0)for(let n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let o of e)(o=t(o,++n,e))!=null&&(r>o||r===void 0&&o>=o)&&(r=o)}return r}var gZ=L(()=>{});function lE(e,t,r=0,n=1/0,o){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(o=o===void 0?yB:uZ(o);n>r;){if(n-r>600){let l=n-r+1,c=t-r+1,d=Math.log(l),u=.5*Math.exp(2*d/3),p=.5*Math.sqrt(d*u*(l-u)/l)*(c-l/2<0?-1:1),m=Math.max(r,Math.floor(t-c*u/l+p)),f=Math.min(n,Math.floor(t+(l-c)*u/l+p));lE(e,t,m,f,o)}let a=e[t],i=r,s=n;for(ck(e,r,t),o(e[n],a)>0&&ck(e,r,n);i<s;){for(ck(e,i,s),++i,--s;o(e[i],a)<0;)++i;for(;o(e[s],a)>0;)--s}o(e[r],a)===0?ck(e,r,s):(++s,ck(e,s,n)),s<=t&&(r=s+1),t<=s&&(n=s-1)}return e}function ck(e,t,r){let n=e[t];e[t]=e[r],e[r]=n}var hZ=L(()=>{pZ()});function cE(e,t,r){if(e=Float64Array.from(aZ(e,r)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return sE(e);if(t>=1)return iE(e);var n,o=(n-1)*t,a=Math.floor(o),i=iE(lE(e,a).subarray(0,a+1)),s=sE(e.subarray(a+1));return i+(s-i)*(o-a)}}function bB(e,t,r=sk){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,o=(n-1)*t,a=Math.floor(o),i=+r(e[a],a,e),s=+r(e[a+1],a+1,e);return i+(s-i)*(o-a)}}var vZ=L(()=>{fZ();gZ();hZ();vB()});function dE(e,t,r){e=+e,t=+t,r=(o=arguments.length)<2?(t=e,e=0,1):o<3?1:+r;for(var n=-1,o=Math.max(0,Math.ceil((t-e)/r))|0,a=new Array(o);++n<o;)a[n]=e+n*r;return a}var yZ=L(()=>{});var ql=L(()=>{lZ();ik();hB();vZ();yZ();mZ();dZ()});function jn(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Gl(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}var yi=L(()=>{});function Wy(){var e=new By,t=[],r=[],n=uE;function o(a){let i=e.get(a);if(i===void 0){if(n!==uE)return n;e.set(a,i=t.push(a)-1)}return r[i%r.length]}return o.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new By;for(let i of a)e.has(i)||e.set(i,t.push(i)-1);return o},o.range=function(a){return arguments.length?(r=Array.from(a),o):r.slice()},o.unknown=function(a){return arguments.length?(n=a,o):n},o.copy=function(){return Wy(t,r).unknown(n)},jn.apply(o,arguments),o}var uE,xB=L(()=>{ql();yi();uE=Symbol("implicit")});function dk(){var e=Wy().unknown(void 0),t=e.domain,r=e.range,n=0,o=1,a,i,s=!1,l=0,c=0,d=.5;delete e.unknown;function u(){var p=t().length,m=o<n,f=m?o:n,g=m?n:o;a=(g-f)/Math.max(1,p-l+c*2),s&&(a=Math.floor(a)),f+=(g-f-a*(p-l))*d,i=a*(1-l),s&&(f=Math.round(f),i=Math.round(i));var v=dE(p).map(function(h){return f+a*h});return r(m?v.reverse():v)}return e.domain=function(p){return arguments.length?(t(p),u()):t()},e.range=function(p){return arguments.length?([n,o]=p,n=+n,o=+o,u()):[n,o]},e.rangeRound=function(p){return[n,o]=p,n=+n,o=+o,s=!0,u()},e.bandwidth=function(){return i},e.step=function(){return a},e.round=function(p){return arguments.length?(s=!!p,u()):s},e.padding=function(p){return arguments.length?(l=Math.min(1,c=+p),u()):l},e.paddingInner=function(p){return arguments.length?(l=Math.min(1,p),u()):l},e.paddingOuter=function(p){return arguments.length?(c=+p,u()):c},e.align=function(p){return arguments.length?(d=Math.max(0,Math.min(1,p)),u()):d},e.copy=function(){return dk(t(),[n,o]).round(s).paddingInner(l).paddingOuter(c).align(d)},jn.apply(u(),arguments)}function bZ(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return bZ(t())},e}function xZ(){return bZ(dk.apply(null,arguments).paddingInner(1))}var wZ=L(()=>{ql();yi();xB()});function pE(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function wB(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}var kZ=L(()=>{});function mk(){}function TZ(){return this.rgb().formatHex()}function OEe(){return this.rgb().formatHex8()}function jEe(){return LZ(this).formatHsl()}function CZ(){return this.rgb().formatRgb()}function Lm(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=EEe.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?PZ(t):r===3?new ys(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?mE(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?mE(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=IEe.exec(e))?new ys(t[1],t[2],t[3],1):(t=AEe.exec(e))?new ys(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=LEe.exec(e))?mE(t[1],t[2],t[3],t[4]):(t=NEe.exec(e))?mE(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=MEe.exec(e))?IZ(t[1],t[2]/100,t[3]/100,1):(t=FEe.exec(e))?IZ(t[1],t[2]/100,t[3]/100,t[4]):SZ.hasOwnProperty(e)?PZ(SZ[e]):e==="transparent"?new ys(NaN,NaN,NaN,0):null}function PZ(e){return new ys(e>>16&255,e>>8&255,e&255,1)}function mE(e,t,r,n){return n<=0&&(e=t=r=NaN),new ys(e,t,r,n)}function zEe(e){return e instanceof mk||(e=Lm(e)),e?(e=e.rgb(),new ys(e.r,e.g,e.b,e.opacity)):new ys}function Uy(e,t,r,n){return arguments.length===1?zEe(e):new ys(e,t,r,n==null?1:n)}function ys(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}function DZ(){return`#${Wg(this.r)}${Wg(this.g)}${Wg(this.b)}`}function _Ee(){return`#${Wg(this.r)}${Wg(this.g)}${Wg(this.b)}${Wg((isNaN(this.opacity)?1:this.opacity)*255)}`}function EZ(){let e=hE(this.opacity);return`${e===1?"rgb(":"rgba("}${Rg(this.r)}, ${Rg(this.g)}, ${Rg(this.b)}${e===1?")":`, ${e})`}`}function hE(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Rg(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Wg(e){return e=Rg(e),(e<16?"0":"")+e.toString(16)}function IZ(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new jc(e,t,r,n)}function LZ(e){if(e instanceof jc)return new jc(e.h,e.s,e.l,e.opacity);if(e instanceof mk||(e=Lm(e)),!e)return new jc;if(e instanceof jc)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,o=Math.min(t,r,n),a=Math.max(t,r,n),i=NaN,s=a-o,l=(a+o)/2;return s?(t===a?i=(r-n)/s+(r<n)*6:r===a?i=(n-t)/s+2:i=(t-r)/s+4,s/=l<.5?a+o:2-a-o,i*=60):s=l>0&&l<1?0:i,new jc(i,s,l,e.opacity)}function NZ(e,t,r,n){return arguments.length===1?LZ(e):new jc(e,t,r,n==null?1:n)}function jc(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}function AZ(e){return e=(e||0)%360,e<0?e+360:e}function fE(e){return Math.max(0,Math.min(1,e||0))}function kB(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}var uk,gE,Ry,pk,zd,EEe,IEe,AEe,LEe,NEe,MEe,FEe,SZ,MZ=L(()=>{kZ();uk=.7,gE=1/uk,Ry="\\s*([+-]?\\d+)\\s*",pk="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",zd="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",EEe=/^#([0-9a-f]{3,8})$/,IEe=new RegExp(`^rgb\\(${Ry},${Ry},${Ry}\\)$`),AEe=new RegExp(`^rgb\\(${zd},${zd},${zd}\\)$`),LEe=new RegExp(`^rgba\\(${Ry},${Ry},${Ry},${pk}\\)$`),NEe=new RegExp(`^rgba\\(${zd},${zd},${zd},${pk}\\)$`),MEe=new RegExp(`^hsl\\(${pk},${zd},${zd}\\)$`),FEe=new RegExp(`^hsla\\(${pk},${zd},${zd},${pk}\\)$`),SZ={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};pE(mk,Lm,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:TZ,formatHex:TZ,formatHex8:OEe,formatHsl:jEe,formatRgb:CZ,toString:CZ});pE(ys,Uy,wB(mk,{brighter(e){return e=e==null?gE:Math.pow(gE,e),new ys(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?uk:Math.pow(uk,e),new ys(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ys(Rg(this.r),Rg(this.g),Rg(this.b),hE(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:DZ,formatHex:DZ,formatHex8:_Ee,formatRgb:EZ,toString:EZ}));pE(jc,NZ,wB(mk,{brighter(e){return e=e==null?gE:Math.pow(gE,e),new jc(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?uk:Math.pow(uk,e),new jc(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,o=2*r-n;return new ys(kB(e>=240?e-240:e+120,o,n),kB(e,o,n),kB(e<120?e+240:e-120,o,n),this.opacity)},clamp(){return new jc(AZ(this.h),fE(this.s),fE(this.l),hE(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=hE(this.opacity);return`${e===1?"hsl(":"hsla("}${AZ(this.h)}, ${fE(this.s)*100}%, ${fE(this.l)*100}%${e===1?")":`, ${e})`}`}}))});var SB=L(()=>{MZ()});function TB(e,t,r,n,o){var a=e*e,i=a*e;return((1-3*e+3*a-i)*t+(4-6*a+3*i)*r+(1+3*e+3*a-3*i)*n+i*o)/6}function FZ(e){var t=e.length-1;return function(r){var n=r<=0?r=0:r>=1?(r=1,t-1):Math.floor(r*t),o=e[n],a=e[n+1],i=n>0?e[n-1]:2*o-a,s=n<t-1?e[n+2]:2*a-o;return TB((r-n/t)*t,i,o,a,s)}}var CB=L(()=>{});function OZ(e){var t=e.length;return function(r){var n=Math.floor(((r%=1)<0?++r:r)*t),o=e[(n+t-1)%t],a=e[n%t],i=e[(n+1)%t],s=e[(n+2)%t];return TB((r-n/t)*t,o,a,i,s)}}var jZ=L(()=>{CB()});var fk,PB=L(()=>{fk=e=>()=>e});function BEe(e,t){return function(r){return e+r*t}}function $Ee(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function zZ(e){return(e=+e)==1?vE:function(t,r){return r-t?$Ee(t,r,e):fk(isNaN(t)?r:t)}}function vE(e,t){var r=t-e;return r?BEe(e,r):fk(isNaN(e)?t:e)}var _Z=L(()=>{PB()});function BZ(e){return function(t){var r=t.length,n=new Array(r),o=new Array(r),a=new Array(r),i,s;for(i=0;i<r;++i)s=Uy(t[i]),n[i]=s.r||0,o[i]=s.g||0,a[i]=s.b||0;return n=e(n),o=e(o),a=e(a),s.opacity=1,function(l){return s.r=n(l),s.g=o(l),s.b=a(l),s+""}}}var DB,nrt,ort,$Z=L(()=>{SB();CB();jZ();_Z();DB=(function e(t){var r=zZ(t);function n(o,a){var i=r((o=Uy(o)).r,(a=Uy(a)).r),s=r(o.g,a.g),l=r(o.b,a.b),c=vE(o.opacity,a.opacity);return function(d){return o.r=i(d),o.g=s(d),o.b=l(d),o.opacity=c(d),o+""}}return n.gamma=e,n})(1);nrt=BZ(FZ),ort=BZ(OZ)});function WZ(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),o;return function(a){for(o=0;o<r;++o)n[o]=e[o]*(1-a)+t[o]*a;return n}}function RZ(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}var UZ=L(()=>{});function VZ(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,o=new Array(n),a=new Array(r),i;for(i=0;i<n;++i)o[i]=Zs(e[i],t[i]);for(;i<r;++i)a[i]=t[i];return function(s){for(i=0;i<n;++i)a[i]=o[i](s);return a}}var HZ=L(()=>{gk()});function qZ(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}var GZ=L(()=>{});function Nm(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}var yE=L(()=>{});function YZ(e,t){var r={},n={},o;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(o in t)o in e?r[o]=Zs(e[o],t[o]):n[o]=t[o];return function(a){for(o in r)n[o]=r[o](a);return n}}var KZ=L(()=>{gk()});function WEe(e){return function(){return e}}function REe(e){return function(t){return e(t)+""}}function JZ(e,t){var r=IB.lastIndex=EB.lastIndex=0,n,o,a,i=-1,s=[],l=[];for(e=e+"",t=t+"";(n=IB.exec(e))&&(o=EB.exec(t));)(a=o.index)>r&&(a=t.slice(r,a),s[i]?s[i]+=a:s[++i]=a),(n=n[0])===(o=o[0])?s[i]?s[i]+=o:s[++i]=o:(s[++i]=null,l.push({i,x:Nm(n,o)})),r=EB.lastIndex;return r<t.length&&(a=t.slice(r),s[i]?s[i]+=a:s[++i]=a),s.length<2?l[0]?REe(l[0].x):WEe(t):(t=l.length,function(c){for(var d=0,u;d<t;++d)s[(u=l[d]).i]=u.x(c);return s.join("")})}var IB,EB,XZ=L(()=>{yE();IB=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,EB=new RegExp(IB.source,"g")});function Zs(e,t){var r=typeof t,n;return t==null||r==="boolean"?fk(t):(r==="number"?Nm:r==="string"?(n=Lm(t))?(t=n,DB):JZ:t instanceof Lm?DB:t instanceof Date?qZ:RZ(t)?WZ:Array.isArray(t)?VZ:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?YZ:Nm)(e,t)}var gk=L(()=>{SB();$Z();HZ();GZ();yE();KZ();XZ();PB();UZ()});function Ug(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}var QZ=L(()=>{});function bE(e,t){t===void 0&&(t=e,e=Zs);for(var r=0,n=t.length-1,o=t[0],a=new Array(n<0?0:n);r<n;)a[r]=e(o,o=t[++r]);return function(i){var s=Math.max(0,Math.min(n-1,Math.floor(i*=n)));return a[s](i-s)}}var ZZ=L(()=>{gk()});var xE=L(()=>{gk();yE();QZ();ZZ()});function AB(e){return function(){return e}}var eee=L(()=>{});function Mm(e){return+e}var wE=L(()=>{});function aa(e){return e}function LB(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:AB(isNaN(t)?NaN:.5)}function UEe(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function VEe(e,t,r){var n=e[0],o=e[1],a=t[0],i=t[1];return o<n?(n=LB(o,n),a=r(i,a)):(n=LB(n,o),a=r(a,i)),function(s){return a(n(s))}}function HEe(e,t,r){var n=Math.min(e.length,t.length)-1,o=new Array(n),a=new Array(n),i=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<n;)o[i]=LB(e[i],e[i+1]),a[i]=r(t[i],t[i+1]);return function(s){var l=Oc(e,s,1,n)-1;return a[l](o[l](s))}}function _d(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Vg(){var e=tee,t=tee,r=Zs,n,o,a,i=aa,s,l,c;function d(){var p=Math.min(e.length,t.length);return i!==aa&&(i=UEe(e[0],e[p-1])),s=p>2?HEe:VEe,l=c=null,u}function u(p){return p==null||isNaN(p=+p)?a:(l||(l=s(e.map(n),t,r)))(n(i(p)))}return u.invert=function(p){return i(o((c||(c=s(t,e.map(n),Nm)))(p)))},u.domain=function(p){return arguments.length?(e=Array.from(p,Mm),d()):e.slice()},u.range=function(p){return arguments.length?(t=Array.from(p),d()):t.slice()},u.rangeRound=function(p){return t=Array.from(p),r=Ug,d()},u.clamp=function(p){return arguments.length?(i=p?!0:aa,d()):i!==aa},u.interpolate=function(p){return arguments.length?(r=p,d()):r},u.unknown=function(p){return arguments.length?(a=p,u):a},function(p,m){return n=p,o=m,d()}}function Hg(){return Vg()(aa,aa)}var tee,Bd=L(()=>{ql();xE();eee();wE();tee=[0,1]});function ree(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function qg(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}var hk=L(()=>{});function $d(e){return e=qg(Math.abs(e)),e?e[1]:NaN}var vk=L(()=>{hk()});function nee(e,t){return function(r,n){for(var o=r.length,a=[],i=0,s=e[0],l=0;o>0&&s>0&&(l+s+1>n&&(s=Math.max(1,n-l)),a.push(r.substring(o-=s,o+s)),!((l+=s+1)>n));)s=e[i=(i+1)%e.length];return a.reverse().join(t)}}var oee=L(()=>{});function aee(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var iee=L(()=>{});function Wd(e){if(!(t=qEe.exec(e)))throw new Error("invalid format: "+e);var t;return new kE({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function kE(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}var qEe,NB=L(()=>{qEe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;Wd.prototype=kE.prototype;kE.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type}});function see(e){e:for(var t=e.length,r=1,n=-1,o;r<t;++r)switch(e[r]){case".":n=o=r;break;case"0":n===0&&(n=r),o=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(o+1):e}var lee=L(()=>{});function cee(e,t){var r=qg(e,t);if(!r)return e+"";var n=r[0],o=r[1],a=o-(MB=Math.max(-8,Math.min(8,Math.floor(o/3)))*3)+1,i=n.length;return a===i?n:a>i?n+new Array(a-i+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+qg(e,Math.max(0,t+a-1))[0]}var MB,FB=L(()=>{hk()});function OB(e,t){var r=qg(e,t);if(!r)return e+"";var n=r[0],o=r[1];return o<0?"0."+new Array(-o).join("0")+n:n.length>o+1?n.slice(0,o+1)+"."+n.slice(o+1):n+new Array(o-n.length+2).join("0")}var dee=L(()=>{hk()});var jB,uee=L(()=>{hk();FB();dee();jB={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:ree,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>OB(e*100,t),r:OB,s:cee,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)}});function zB(e){return e}var pee=L(()=>{});function gee(e){var t=e.grouping===void 0||e.thousands===void 0?zB:nee(mee.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",o=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?zB:aee(mee.call(e.numerals,String)),i=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"\u2212":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function c(u){u=Wd(u);var p=u.fill,m=u.align,f=u.sign,g=u.symbol,v=u.zero,h=u.width,y=u.comma,b=u.precision,x=u.trim,w=u.type;w==="n"?(y=!0,w="g"):jB[w]||(b===void 0&&(b=12),x=!0,w="g"),(v||p==="0"&&m==="=")&&(v=!0,p="0",m="=");var S=g==="$"?r:g==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",k=g==="$"?n:/[%p]/.test(w)?i:"",T=jB[w],P=/[defgprs%]/.test(w);b=b===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function D(O){var z=S,I=k,A,j,E;if(w==="c")I=T(O)+I,O="";else{O=+O;var N=O<0||1/O<0;if(O=isNaN(O)?l:T(Math.abs(O),b),x&&(O=see(O)),N&&+O==0&&f!=="+"&&(N=!1),z=(N?f==="("?f:s:f==="-"||f==="("?"":f)+z,I=(w==="s"?fee[8+MB/3]:"")+I+(N&&f==="("?")":""),P){for(A=-1,j=O.length;++A<j;)if(E=O.charCodeAt(A),48>E||E>57){I=(E===46?o+O.slice(A+1):O.slice(A))+I,O=O.slice(0,A);break}}}y&&!v&&(O=t(O,1/0));var B=z.length+O.length+I.length,C=B<h?new Array(h-B+1).join(p):"";switch(y&&v&&(O=t(C+O,C.length?h-I.length:1/0),C=""),m){case"<":O=z+O+I+C;break;case"=":O=z+C+O+I;break;case"^":O=C.slice(0,B=C.length>>1)+z+O+I+C.slice(B);break;default:O=C+z+O+I;break}return a(O)}return D.toString=function(){return u+""},D}function d(u,p){var m=c((u=Wd(u),u.type="f",u)),f=Math.max(-8,Math.min(8,Math.floor($d(p)/3)))*3,g=Math.pow(10,-f),v=fee[8+f/3];return function(h){return m(g*h)+v}}return{format:c,formatPrefix:d}}var mee,fee,hee=L(()=>{vk();oee();iee();NB();lee();uee();FB();pee();mee=Array.prototype.map,fee=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"]});function _B(e){return SE=gee(e),Vy=SE.format,TE=SE.formatPrefix,SE}var SE,Vy,TE,vee=L(()=>{hee();_B({thousands:",",grouping:[3],currency:["$",""]})});function BB(e){return Math.max(0,-$d(Math.abs(e)))}var yee=L(()=>{vk()});function $B(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor($d(t)/3)))*3-$d(Math.abs(e)))}var bee=L(()=>{vk()});function WB(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,$d(t)-$d(e))+1}var xee=L(()=>{vk()});var RB=L(()=>{vee();NB();yee();bee();xee()});function yk(e,t,r,n){var o=$y(e,t,r),a;switch(n=Wd(n==null?",f":n),n.type){case"s":{var i=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(a=$B(o,i))&&(n.precision=a),TE(n,i)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=WB(o,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=BB(o))&&(n.precision=a-(n.type==="%")*2);break}}return Vy(n)}var UB=L(()=>{ql();RB()});function Ui(e){var t=e.domain;return e.ticks=function(r){var n=t();return $g(n[0],n[n.length-1],r==null?10:r)},e.tickFormat=function(r,n){var o=t();return yk(o[0],o[o.length-1],r==null?10:r,n)},e.nice=function(r){r==null&&(r=10);var n=t(),o=0,a=n.length-1,i=n[o],s=n[a],l,c,d=10;for(s<i&&(c=i,i=s,s=c,c=o,o=a,a=c);d-- >0;){if(c=lk(i,s,r),c===l)return n[o]=i,n[a]=s,t(n);if(c>0)i=Math.floor(i/c)*c,s=Math.ceil(s/c)*c;else if(c<0)i=Math.ceil(i*c)/c,s=Math.floor(s*c)/c;else break;l=c}return e},e}function CE(){var e=Hg();return e.copy=function(){return _d(e,CE())},jn.apply(e,arguments),Ui(e)}var Yu=L(()=>{ql();Bd();yi();UB()});function PE(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Mm),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return PE(e).unknown(t)},e=arguments.length?Array.from(e,Mm):[0,1],Ui(r)}var wee=L(()=>{Yu();wE()});function bk(e,t){e=e.slice();var r=0,n=e.length-1,o=e[r],a=e[n],i;return a<o&&(i=r,r=n,n=i,i=o,o=a,a=i),e[r]=t.floor(o),e[n]=t.ceil(a),e}var VB=L(()=>{});function kee(e){return Math.log(e)}function See(e){return Math.exp(e)}function GEe(e){return-Math.log(-e)}function YEe(e){return-Math.exp(-e)}function KEe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function JEe(e){return e===10?KEe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function XEe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Tee(e){return(t,r)=>-e(-t,r)}function xk(e){let t=e(kee,See),r=t.domain,n=10,o,a;function i(){return o=XEe(n),a=JEe(n),r()[0]<0?(o=Tee(o),a=Tee(a),e(GEe,YEe)):e(kee,See),t}return t.base=function(s){return arguments.length?(n=+s,i()):n},t.domain=function(s){return arguments.length?(r(s),i()):r()},t.ticks=s=>{let l=r(),c=l[0],d=l[l.length-1],u=d<c;u&&([c,d]=[d,c]);let p=o(c),m=o(d),f,g,v=s==null?10:+s,h=[];if(!(n%1)&&m-p<v){if(p=Math.floor(p),m=Math.ceil(m),c>0){for(;p<=m;++p)for(f=1;f<n;++f)if(g=p<0?f/a(-p):f*a(p),!(g<c)){if(g>d)break;h.push(g)}}else for(;p<=m;++p)for(f=n-1;f>=1;--f)if(g=p>0?f/a(-p):f*a(p),!(g<c)){if(g>d)break;h.push(g)}h.length*2<v&&(h=$g(c,d,v))}else h=$g(p,m,Math.min(m-p,v)).map(a);return u?h.reverse():h},t.tickFormat=(s,l)=>{if(s==null&&(s=10),l==null&&(l=n===10?"s":","),typeof l!="function"&&(!(n%1)&&(l=Wd(l)).precision==null&&(l.trim=!0),l=Vy(l)),s===1/0)return l;let c=Math.max(1,n*s/t.ticks().length);return d=>{let u=d/a(Math.round(o(d)));return u*n<n-.5&&(u*=n),u<=c?l(d):""}},t.nice=()=>r(bk(r(),{floor:s=>a(Math.floor(o(s))),ceil:s=>a(Math.ceil(o(s)))})),t}function DE(){let e=xk(Vg()).domain([1,10]);return e.copy=()=>_d(e,DE()).base(e.base()),jn.apply(e,arguments),e}var EE=L(()=>{ql();RB();VB();Bd();yi()});function Cee(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Pee(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function wk(e){var t=1,r=e(Cee(t),Pee(t));return r.constant=function(n){return arguments.length?e(Cee(t=+n),Pee(t)):t},Ui(r)}function IE(){var e=wk(Vg());return e.copy=function(){return _d(e,IE()).constant(e.constant())},jn.apply(e,arguments)}var AE=L(()=>{Yu();Bd();yi()});function Dee(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function QEe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function ZEe(e){return e<0?-e*e:e*e}function kk(e){var t=e(aa,aa),r=1;function n(){return r===1?e(aa,aa):r===.5?e(QEe,ZEe):e(Dee(r),Dee(1/r))}return t.exponent=function(o){return arguments.length?(r=+o,n()):r},Ui(t)}function Sk(){var e=kk(Vg());return e.copy=function(){return _d(e,Sk()).exponent(e.exponent())},jn.apply(e,arguments),e}function Eee(){return Sk.apply(null,arguments).exponent(.5)}var LE=L(()=>{Yu();Bd();yi()});function Iee(e){return Math.sign(e)*e*e}function eIe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function NE(){var e=Hg(),t=[0,1],r=!1,n;function o(a){var i=eIe(e(a));return isNaN(i)?n:r?Math.round(i):i}return o.invert=function(a){return e.invert(Iee(a))},o.domain=function(a){return arguments.length?(e.domain(a),o):e.domain()},o.range=function(a){return arguments.length?(e.range((t=Array.from(a,Mm)).map(Iee)),o):t.slice()},o.rangeRound=function(a){return o.range(a).round(!0)},o.round=function(a){return arguments.length?(r=!!a,o):r},o.clamp=function(a){return arguments.length?(e.clamp(a),o):e.clamp()},o.unknown=function(a){return arguments.length?(n=a,o):n},o.copy=function(){return NE(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},jn.apply(o,arguments),Ui(o)}var Aee=L(()=>{Bd();yi();Yu();wE()});function ME(){var e=[],t=[],r=[],n;function o(){var i=0,s=Math.max(1,t.length);for(r=new Array(s-1);++i<s;)r[i-1]=bB(e,i/s);return a}function a(i){return i==null||isNaN(i=+i)?n:t[Oc(r,i)]}return a.invertExtent=function(i){var s=t.indexOf(i);return s<0?[NaN,NaN]:[s>0?r[s-1]:e[0],s<r.length?r[s]:e[e.length-1]]},a.domain=function(i){if(!arguments.length)return e.slice();e=[];for(let s of i)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(Ri),o()},a.range=function(i){return arguments.length?(t=Array.from(i),o()):t.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.quantiles=function(){return r.slice()},a.copy=function(){return ME().domain(e).range(t).unknown(n)},jn.apply(a,arguments)}var Lee=L(()=>{ql();yi()});function FE(){var e=0,t=1,r=1,n=[.5],o=[0,1],a;function i(l){return l!=null&&l<=l?o[Oc(n,l,0,r)]:a}function s(){var l=-1;for(n=new Array(r);++l<r;)n[l]=((l+1)*t-(l-r)*e)/(r+1);return i}return i.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,s()):[e,t]},i.range=function(l){return arguments.length?(r=(o=Array.from(l)).length-1,s()):o.slice()},i.invertExtent=function(l){var c=o.indexOf(l);return c<0?[NaN,NaN]:c<1?[e,n[0]]:c>=r?[n[r-1],t]:[n[c-1],n[c]]},i.unknown=function(l){return arguments.length&&(a=l),i},i.thresholds=function(){return n.slice()},i.copy=function(){return FE().domain([e,t]).range(o).unknown(a)},jn.apply(Ui(i),arguments)}var Nee=L(()=>{ql();Yu();yi()});function OE(){var e=[.5],t=[0,1],r,n=1;function o(a){return a!=null&&a<=a?t[Oc(e,a,0,n)]:r}return o.domain=function(a){return arguments.length?(e=Array.from(a),n=Math.min(e.length,t.length-1),o):e.slice()},o.range=function(a){return arguments.length?(t=Array.from(a),n=Math.min(e.length,t.length-1),o):t.slice()},o.invertExtent=function(a){var i=t.indexOf(a);return[e[i-1],e[i]]},o.unknown=function(a){return arguments.length?(r=a,o):r},o.copy=function(){return OE().domain(e).range(t).unknown(r)},jn.apply(o,arguments)}var Mee=L(()=>{ql();yi()});function an(e,t,r,n){function o(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return o.floor=a=>(e(a=new Date(+a)),a),o.ceil=a=>(e(a=new Date(a-1)),t(a,1),e(a),a),o.round=a=>{let i=o(a),s=o.ceil(a);return a-i<s-a?i:s},o.offset=(a,i)=>(t(a=new Date(+a),i==null?1:Math.floor(i)),a),o.range=(a,i,s)=>{let l=[];if(a=o.ceil(a),s=s==null?1:Math.floor(s),!(a<i)||!(s>0))return l;let c;do l.push(c=new Date(+a)),t(a,s),e(a);while(c<a&&a<i);return l},o.filter=a=>an(i=>{if(i>=i)for(;e(i),!a(i);)i.setTime(i-1)},(i,s)=>{if(i>=i)if(s<0)for(;++s<=0;)for(;t(i,-1),!a(i););else for(;--s>=0;)for(;t(i,1),!a(i););}),r&&(o.count=(a,i)=>(HB.setTime(+a),qB.setTime(+i),e(HB),e(qB),Math.floor(r(HB,qB))),o.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?o.filter(n?i=>n(i)%a===0:i=>o.count(0,i)%a===0):o)),o}var HB,qB,Ku=L(()=>{HB=new Date,qB=new Date});var Tk,fot,Fee=L(()=>{Ku();Tk=an(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Tk.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?an(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Tk);fot=Tk.range});var Yl,Oee,GB=L(()=>{Ku();Yl=an(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*1e3)},(e,t)=>(t-e)/1e3,e=>e.getUTCSeconds()),Oee=Yl.range});var Hy,tIe,qy,rIe,YB=L(()=>{Ku();Hy=an(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*1e3)},(e,t)=>{e.setTime(+e+t*6e4)},(e,t)=>(t-e)/6e4,e=>e.getMinutes()),tIe=Hy.range,qy=an(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*6e4)},(e,t)=>(t-e)/6e4,e=>e.getUTCMinutes()),rIe=qy.range});var Gy,nIe,Yy,oIe,KB=L(()=>{Ku();Gy=an(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*1e3-e.getMinutes()*6e4)},(e,t)=>{e.setTime(+e+t*36e5)},(e,t)=>(t-e)/36e5,e=>e.getHours()),nIe=Gy.range,Yy=an(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*36e5)},(e,t)=>(t-e)/36e5,e=>e.getUTCHours()),oIe=Yy.range});var Ju,aIe,Kg,iIe,jE,sIe,JB=L(()=>{Ku();Ju=an(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*6e4)/864e5,e=>e.getDate()-1),aIe=Ju.range,Kg=an(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>e.getUTCDate()-1),iIe=Kg.range,jE=an(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>Math.floor(e/864e5)),sIe=jE.range});function Jg(e){return an(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*6e4)/6048e5)}function Xg(e){return an(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/6048e5)}var Xu,Ky,zee,_ee,Fm,Bee,$ee,Wee,lIe,cIe,dIe,uIe,pIe,mIe,Qu,Jy,Ree,Uee,Om,Vee,Hee,qee,fIe,gIe,hIe,vIe,yIe,bIe,XB=L(()=>{Ku();Xu=Jg(0),Ky=Jg(1),zee=Jg(2),_ee=Jg(3),Fm=Jg(4),Bee=Jg(5),$ee=Jg(6),Wee=Xu.range,lIe=Ky.range,cIe=zee.range,dIe=_ee.range,uIe=Fm.range,pIe=Bee.range,mIe=$ee.range;Qu=Xg(0),Jy=Xg(1),Ree=Xg(2),Uee=Xg(3),Om=Xg(4),Vee=Xg(5),Hee=Xg(6),qee=Qu.range,fIe=Jy.range,gIe=Ree.range,hIe=Uee.range,vIe=Om.range,yIe=Vee.range,bIe=Hee.range});var Xy,xIe,Qy,wIe,QB=L(()=>{Ku();Xy=an(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth()),xIe=Xy.range,Qy=an(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth()),wIe=Qy.range});var el,kIe,tl,SIe,ZB=L(()=>{Ku();el=an(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());el.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:an(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});kIe=el.range,tl=an(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());tl.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:an(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});SIe=tl.range});function Yee(e,t,r,n,o,a){let i=[[Yl,1,1e3],[Yl,5,5*1e3],[Yl,15,15*1e3],[Yl,30,30*1e3],[a,1,6e4],[a,5,5*6e4],[a,15,15*6e4],[a,30,30*6e4],[o,1,36e5],[o,3,3*36e5],[o,6,6*36e5],[o,12,12*36e5],[n,1,864e5],[n,2,2*864e5],[r,1,6048e5],[t,1,2592e6],[t,3,3*2592e6],[e,1,31536e6]];function s(c,d,u){let p=d<c;p&&([c,d]=[d,c]);let m=u&&typeof u.range=="function"?u:l(c,d,u),f=m?m.range(c,+d+1):[];return p?f.reverse():f}function l(c,d,u){let p=Math.abs(d-c)/u,m=Bg(([,,v])=>v).right(i,p);if(m===i.length)return e.every($y(c/31536e6,d/31536e6,u));if(m===0)return Tk.every(Math.max($y(c,d,u),1));let[f,g]=i[p/i[m-1][2]<i[m][2]/p?m-1:m];return f.every(g)}return[s,l]}var e$,t$,r$,n$,Kee=L(()=>{ql();Fee();GB();YB();KB();JB();XB();QB();ZB();[e$,t$]=Yee(tl,Qy,Qu,jE,Yy,qy),[r$,n$]=Yee(el,Xy,Xu,Ju,Gy,Hy)});var zE=L(()=>{GB();YB();KB();JB();XB();QB();ZB();Kee()});function o$(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function a$(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Pk(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function i$(e){var t=e.dateTime,r=e.date,n=e.time,o=e.periods,a=e.days,i=e.shortDays,s=e.months,l=e.shortMonths,c=Dk(o),d=Ek(o),u=Dk(a),p=Ek(a),m=Dk(i),f=Ek(i),g=Dk(s),v=Ek(s),h=Dk(l),y=Ek(l),b={a:N,A:B,b:C,B:F,c:null,d:tte,e:tte,f:GIe,g:nAe,G:aAe,H:VIe,I:HIe,j:qIe,L:ite,m:YIe,M:KIe,p:M,q:_,Q:ote,s:ate,S:JIe,u:XIe,U:QIe,V:ZIe,w:eAe,W:tAe,x:null,X:null,y:rAe,Y:oAe,Z:iAe,"%":nte},x={a:W,A:$,b:H,B:R,c:null,d:rte,e:rte,f:dAe,g:xAe,G:kAe,H:sAe,I:lAe,j:cAe,L:lte,m:uAe,M:pAe,p:V,q:Z,Q:ote,s:ate,S:mAe,u:fAe,U:gAe,V:hAe,w:vAe,W:yAe,x:null,X:null,y:bAe,Y:wAe,Z:SAe,"%":nte},w={a:D,A:O,b:z,B:I,c:A,d:Zee,e:Zee,f:$Ie,g:Qee,G:Xee,H:ete,I:ete,j:jIe,L:BIe,m:OIe,M:zIe,p:P,q:FIe,Q:RIe,s:UIe,S:_Ie,u:IIe,U:AIe,V:LIe,w:EIe,W:NIe,x:j,X:E,y:Qee,Y:Xee,Z:MIe,"%":WIe};b.x=S(r,b),b.X=S(n,b),b.c=S(t,b),x.x=S(r,x),x.X=S(n,x),x.c=S(t,x);function S(K,X){return function(G){var U=[],Q=-1,J=0,ee=K.length,te,ue,be;for(G instanceof Date||(G=new Date(+G));++Q<ee;)K.charCodeAt(Q)===37&&(U.push(K.slice(J,Q)),(ue=Jee[te=K.charAt(++Q)])!=null?te=K.charAt(++Q):ue=te==="e"?" ":"0",(be=X[te])&&(te=be(G,ue)),U.push(te),J=Q+1);return U.push(K.slice(J,Q)),U.join("")}}function k(K,X){return function(G){var U=Pk(1900,void 0,1),Q=T(U,K,G+="",0),J,ee;if(Q!=G.length)return null;if("Q"in U)return new Date(U.Q);if("s"in U)return new Date(U.s*1e3+("L"in U?U.L:0));if(X&&!("Z"in U)&&(U.Z=0),"p"in U&&(U.H=U.H%12+U.p*12),U.m===void 0&&(U.m="q"in U?U.q:0),"V"in U){if(U.V<1||U.V>53)return null;"w"in U||(U.w=1),"Z"in U?(J=a$(Pk(U.y,0,1)),ee=J.getUTCDay(),J=ee>4||ee===0?Jy.ceil(J):Jy(J),J=Kg.offset(J,(U.V-1)*7),U.y=J.getUTCFullYear(),U.m=J.getUTCMonth(),U.d=J.getUTCDate()+(U.w+6)%7):(J=o$(Pk(U.y,0,1)),ee=J.getDay(),J=ee>4||ee===0?Ky.ceil(J):Ky(J),J=Ju.offset(J,(U.V-1)*7),U.y=J.getFullYear(),U.m=J.getMonth(),U.d=J.getDate()+(U.w+6)%7)}else("W"in U||"U"in U)&&("w"in U||(U.w="u"in U?U.u%7:"W"in U?1:0),ee="Z"in U?a$(Pk(U.y,0,1)).getUTCDay():o$(Pk(U.y,0,1)).getDay(),U.m=0,U.d="W"in U?(U.w+6)%7+U.W*7-(ee+5)%7:U.w+U.U*7-(ee+6)%7);return"Z"in U?(U.H+=U.Z/100|0,U.M+=U.Z%100,a$(U)):o$(U)}}function T(K,X,G,U){for(var Q=0,J=X.length,ee=G.length,te,ue;Q<J;){if(U>=ee)return-1;if(te=X.charCodeAt(Q++),te===37){if(te=X.charAt(Q++),ue=w[te in Jee?X.charAt(Q++):te],!ue||(U=ue(K,G,U))<0)return-1}else if(te!=G.charCodeAt(U++))return-1}return U}function P(K,X,G){var U=c.exec(X.slice(G));return U?(K.p=d.get(U[0].toLowerCase()),G+U[0].length):-1}function D(K,X,G){var U=m.exec(X.slice(G));return U?(K.w=f.get(U[0].toLowerCase()),G+U[0].length):-1}function O(K,X,G){var U=u.exec(X.slice(G));return U?(K.w=p.get(U[0].toLowerCase()),G+U[0].length):-1}function z(K,X,G){var U=h.exec(X.slice(G));return U?(K.m=y.get(U[0].toLowerCase()),G+U[0].length):-1}function I(K,X,G){var U=g.exec(X.slice(G));return U?(K.m=v.get(U[0].toLowerCase()),G+U[0].length):-1}function A(K,X,G){return T(K,t,X,G)}function j(K,X,G){return T(K,r,X,G)}function E(K,X,G){return T(K,n,X,G)}function N(K){return i[K.getDay()]}function B(K){return a[K.getDay()]}function C(K){return l[K.getMonth()]}function F(K){return s[K.getMonth()]}function M(K){return o[+(K.getHours()>=12)]}function _(K){return 1+~~(K.getMonth()/3)}function W(K){return i[K.getUTCDay()]}function $(K){return a[K.getUTCDay()]}function H(K){return l[K.getUTCMonth()]}function R(K){return s[K.getUTCMonth()]}function V(K){return o[+(K.getUTCHours()>=12)]}function Z(K){return 1+~~(K.getUTCMonth()/3)}return{format:function(K){var X=S(K+="",b);return X.toString=function(){return K},X},parse:function(K){var X=k(K+="",!1);return X.toString=function(){return K},X},utcFormat:function(K){var X=S(K+="",x);return X.toString=function(){return K},X},utcParse:function(K){var X=k(K+="",!0);return X.toString=function(){return K},X}}}function Ir(e,t,r){var n=e<0?"-":"",o=(n?-e:e)+"",a=o.length;return n+(a<r?new Array(r-a+1).join(t)+o:o)}function DIe(e){return e.replace(PIe,"\\$&")}function Dk(e){return new RegExp("^(?:"+e.map(DIe).join("|")+")","i")}function Ek(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function EIe(e,t,r){var n=Da.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function IIe(e,t,r){var n=Da.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function AIe(e,t,r){var n=Da.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function LIe(e,t,r){var n=Da.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function NIe(e,t,r){var n=Da.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function Xee(e,t,r){var n=Da.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function Qee(e,t,r){var n=Da.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function MIe(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function FIe(e,t,r){var n=Da.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function OIe(e,t,r){var n=Da.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function Zee(e,t,r){var n=Da.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function jIe(e,t,r){var n=Da.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function ete(e,t,r){var n=Da.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function zIe(e,t,r){var n=Da.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function _Ie(e,t,r){var n=Da.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function BIe(e,t,r){var n=Da.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function $Ie(e,t,r){var n=Da.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function WIe(e,t,r){var n=CIe.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function RIe(e,t,r){var n=Da.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function UIe(e,t,r){var n=Da.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function tte(e,t){return Ir(e.getDate(),t,2)}function VIe(e,t){return Ir(e.getHours(),t,2)}function HIe(e,t){return Ir(e.getHours()%12||12,t,2)}function qIe(e,t){return Ir(1+Ju.count(el(e),e),t,3)}function ite(e,t){return Ir(e.getMilliseconds(),t,3)}function GIe(e,t){return ite(e,t)+"000"}function YIe(e,t){return Ir(e.getMonth()+1,t,2)}function KIe(e,t){return Ir(e.getMinutes(),t,2)}function JIe(e,t){return Ir(e.getSeconds(),t,2)}function XIe(e){var t=e.getDay();return t===0?7:t}function QIe(e,t){return Ir(Xu.count(el(e)-1,e),t,2)}function ste(e){var t=e.getDay();return t>=4||t===0?Fm(e):Fm.ceil(e)}function ZIe(e,t){return e=ste(e),Ir(Fm.count(el(e),e)+(el(e).getDay()===4),t,2)}function eAe(e){return e.getDay()}function tAe(e,t){return Ir(Ky.count(el(e)-1,e),t,2)}function rAe(e,t){return Ir(e.getFullYear()%100,t,2)}function nAe(e,t){return e=ste(e),Ir(e.getFullYear()%100,t,2)}function oAe(e,t){return Ir(e.getFullYear()%1e4,t,4)}function aAe(e,t){var r=e.getDay();return e=r>=4||r===0?Fm(e):Fm.ceil(e),Ir(e.getFullYear()%1e4,t,4)}function iAe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ir(t/60|0,"0",2)+Ir(t%60,"0",2)}function rte(e,t){return Ir(e.getUTCDate(),t,2)}function sAe(e,t){return Ir(e.getUTCHours(),t,2)}function lAe(e,t){return Ir(e.getUTCHours()%12||12,t,2)}function cAe(e,t){return Ir(1+Kg.count(tl(e),e),t,3)}function lte(e,t){return Ir(e.getUTCMilliseconds(),t,3)}function dAe(e,t){return lte(e,t)+"000"}function uAe(e,t){return Ir(e.getUTCMonth()+1,t,2)}function pAe(e,t){return Ir(e.getUTCMinutes(),t,2)}function mAe(e,t){return Ir(e.getUTCSeconds(),t,2)}function fAe(e){var t=e.getUTCDay();return t===0?7:t}function gAe(e,t){return Ir(Qu.count(tl(e)-1,e),t,2)}function cte(e){var t=e.getUTCDay();return t>=4||t===0?Om(e):Om.ceil(e)}function hAe(e,t){return e=cte(e),Ir(Om.count(tl(e),e)+(tl(e).getUTCDay()===4),t,2)}function vAe(e){return e.getUTCDay()}function yAe(e,t){return Ir(Jy.count(tl(e)-1,e),t,2)}function bAe(e,t){return Ir(e.getUTCFullYear()%100,t,2)}function xAe(e,t){return e=cte(e),Ir(e.getUTCFullYear()%100,t,2)}function wAe(e,t){return Ir(e.getUTCFullYear()%1e4,t,4)}function kAe(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Om(e):Om.ceil(e),Ir(e.getUTCFullYear()%1e4,t,4)}function SAe(){return"+0000"}function nte(){return"%"}function ote(e){return+e}function ate(e){return Math.floor(+e/1e3)}var Jee,Da,CIe,PIe,dte=L(()=>{zE();Jee={"-":"",_:" ",0:"0"},Da=/^\s*\d+/,CIe=/^%/,PIe=/[\\^$*+?|[\]().{}]/g});function s$(e){return Zy=i$(e),_E=Zy.format,ute=Zy.parse,BE=Zy.utcFormat,pte=Zy.utcParse,Zy}var Zy,_E,ute,BE,pte,mte=L(()=>{dte();s$({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]})});var l$=L(()=>{mte()});function TAe(e){return new Date(e)}function CAe(e){return e instanceof Date?+e:+new Date(+e)}function $E(e,t,r,n,o,a,i,s,l,c){var d=Hg(),u=d.invert,p=d.domain,m=c(".%L"),f=c(":%S"),g=c("%I:%M"),v=c("%I %p"),h=c("%a %d"),y=c("%b %d"),b=c("%B"),x=c("%Y");function w(S){return(l(S)<S?m:s(S)<S?f:i(S)<S?g:a(S)<S?v:n(S)<S?o(S)<S?h:y:r(S)<S?b:x)(S)}return d.invert=function(S){return new Date(u(S))},d.domain=function(S){return arguments.length?p(Array.from(S,CAe)):p().map(TAe)},d.ticks=function(S){var k=p();return e(k[0],k[k.length-1],S==null?10:S)},d.tickFormat=function(S,k){return k==null?w:c(k)},d.nice=function(S){var k=p();return(!S||typeof S.range!="function")&&(S=t(k[0],k[k.length-1],S==null?10:S)),S?p(bk(k,S)):d},d.copy=function(){return _d(d,$E(e,t,r,n,o,a,i,s,l,c))},d}function c$(){return jn.apply($E(r$,n$,el,Xy,Xu,Ju,Gy,Hy,Yl,_E).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}var d$=L(()=>{zE();l$();Bd();yi();VB()});function u$(){return jn.apply($E(e$,t$,tl,Qy,Qu,Kg,Yy,qy,Yl,BE).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}var fte=L(()=>{zE();l$();d$();yi()});function WE(){var e=0,t=1,r,n,o,a,i=aa,s=!1,l;function c(u){return u==null||isNaN(u=+u)?l:i(o===0?.5:(u=(a(u)-r)*o,s?Math.max(0,Math.min(1,u)):u))}c.domain=function(u){return arguments.length?([e,t]=u,r=a(e=+e),n=a(t=+t),o=r===n?0:1/(n-r),c):[e,t]},c.clamp=function(u){return arguments.length?(s=!!u,c):s},c.interpolator=function(u){return arguments.length?(i=u,c):i};function d(u){return function(p){var m,f;return arguments.length?([m,f]=p,i=u(m,f),c):[i(0),i(1)]}}return c.range=d(Zs),c.rangeRound=d(Ug),c.unknown=function(u){return arguments.length?(l=u,c):l},function(u){return a=u,r=u(e),n=u(t),o=r===n?0:1/(n-r),c}}function Zu(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function RE(){var e=Ui(WE()(aa));return e.copy=function(){return Zu(e,RE())},Gl.apply(e,arguments)}function p$(){var e=xk(WE()).domain([1,10]);return e.copy=function(){return Zu(e,p$()).base(e.base())},Gl.apply(e,arguments)}function m$(){var e=wk(WE());return e.copy=function(){return Zu(e,m$()).constant(e.constant())},Gl.apply(e,arguments)}function UE(){var e=kk(WE());return e.copy=function(){return Zu(e,UE()).exponent(e.exponent())},Gl.apply(e,arguments)}function gte(){return UE.apply(null,arguments).exponent(.5)}var f$=L(()=>{xE();Bd();yi();Yu();EE();AE();LE()});function VE(){var e=[],t=aa;function r(n){if(n!=null&&!isNaN(n=+n))return t((Oc(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let o of n)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(Ri),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,o)=>t(o/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(o,a)=>cE(e,a/n))},r.copy=function(){return VE(t).domain(e)},Gl.apply(r,arguments)}var hte=L(()=>{ql();Bd();yi()});function HE(){var e=0,t=.5,r=1,n=1,o,a,i,s,l,c=aa,d,u=!1,p;function m(g){return isNaN(g=+g)?p:(g=.5+((g=+d(g))-a)*(n*g<n*a?s:l),c(u?Math.max(0,Math.min(1,g)):g))}m.domain=function(g){return arguments.length?([e,t,r]=g,o=d(e=+e),a=d(t=+t),i=d(r=+r),s=o===a?0:.5/(a-o),l=a===i?0:.5/(i-a),n=a<o?-1:1,m):[e,t,r]},m.clamp=function(g){return arguments.length?(u=!!g,m):u},m.interpolator=function(g){return arguments.length?(c=g,m):c};function f(g){return function(v){var h,y,b;return arguments.length?([h,y,b]=v,c=bE(g,[h,y,b]),m):[c(0),c(.5),c(1)]}}return m.range=f(Zs),m.rangeRound=f(Ug),m.unknown=function(g){return arguments.length?(p=g,m):p},function(g){return d=g,o=g(e),a=g(t),i=g(r),s=o===a?0:.5/(a-o),l=a===i?0:.5/(i-a),n=a<o?-1:1,m}}function qE(){var e=Ui(HE()(aa));return e.copy=function(){return Zu(e,qE())},Gl.apply(e,arguments)}function g$(){var e=xk(HE()).domain([.1,1,10]);return e.copy=function(){return Zu(e,g$()).base(e.base())},Gl.apply(e,arguments)}function h$(){var e=wk(HE());return e.copy=function(){return Zu(e,h$()).constant(e.constant())},Gl.apply(e,arguments)}function GE(){var e=kk(HE());return e.copy=function(){return Zu(e,GE()).exponent(e.exponent())},Gl.apply(e,arguments)}function vte(){return GE.apply(null,arguments).exponent(.5)}var yte=L(()=>{xE();Bd();yi();Yu();EE();f$();AE();LE()});var bte=L(()=>{wZ();wee();Yu();EE();AE();xB();LE();Aee();Lee();Nee();Mee();d$();fte();f$();hte();yte();UB()});var Qg={};Ko(Qg,{scaleBand:()=>dk,scaleDiverging:()=>qE,scaleDivergingLog:()=>g$,scaleDivergingPow:()=>GE,scaleDivergingSqrt:()=>vte,scaleDivergingSymlog:()=>h$,scaleIdentity:()=>PE,scaleImplicit:()=>uE,scaleLinear:()=>CE,scaleLog:()=>DE,scaleOrdinal:()=>Wy,scalePoint:()=>xZ,scalePow:()=>Sk,scaleQuantile:()=>ME,scaleQuantize:()=>FE,scaleRadial:()=>NE,scaleSequential:()=>RE,scaleSequentialLog:()=>p$,scaleSequentialPow:()=>UE,scaleSequentialQuantile:()=>VE,scaleSequentialSqrt:()=>gte,scaleSequentialSymlog:()=>m$,scaleSqrt:()=>Eee,scaleSymlog:()=>IE,scaleThreshold:()=>OE,scaleTime:()=>c$,scaleUtc:()=>u$,tickFormat:()=>yk});var xte=L(()=>{bte()});var zc,PAe,ep,Zg=L(()=>{Pa();zc=e=>e.chartData,PAe=ie([zc],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),ep=(e,t,r,n)=>n?PAe(e):zc(e)});function eh(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(Fn(t)&&Fn(r))return!0}return!1}function wte(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function kte(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,o,a;if(Fn(r))o=r;else if(typeof r=="function")return;if(Fn(n))a=n;else if(typeof n=="function")return;var i=[o,a];if(eh(i))return i}}function Ste(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(eh(n))return wte(n,t,r)}catch(m){}if(Array.isArray(e)&&e.length===2){var[o,a]=e,i,s;if(o==="auto")t!=null&&(i=Math.min(...t));else if(Re(o))i=o;else if(typeof o=="function")try{t!=null&&(i=o(t==null?void 0:t[0]))}catch(m){}else if(typeof o=="string"&&V_.test(o)){var l=V_.exec(o);if(l==null||t==null)i=void 0;else{var c=+l[1];i=t[0]-c}}else i=t==null?void 0:t[0];if(a==="auto")t!=null&&(s=Math.max(...t));else if(Re(a))s=a;else if(typeof a=="function")try{t!=null&&(s=a(t==null?void 0:t[1]))}catch(m){}else if(typeof a=="string"&&H_.test(a)){var d=H_.exec(a);if(d==null||t==null)s=void 0;else{var u=+d[1];s=t[1]+u}}else s=t==null?void 0:t[1];var p=[i,s];if(eh(p))return t==null?p:wte(p,t,r)}}}var Tte=L(()=>{Ka();nr();Fd()});var v$=Ie((Cte,YE)=>{(function(e){"use strict";var t=1e9,r={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},n=!0,o="[DecimalError] ",a=o+"Invalid argument: ",i=o+"Exponent out of range: ",s=Math.floor,l=Math.pow,c=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,d,u=1e7,p=7,m=9007199254740991,f=s(m/p),g={};g.absoluteValue=g.abs=function(){var E=new this.constructor(this);return E.s&&(E.s=1),E},g.comparedTo=g.cmp=function(E){var N,B,C,F,M=this;if(E=new M.constructor(E),M.s!==E.s)return M.s||-E.s;if(M.e!==E.e)return M.e>E.e^M.s<0?1:-1;for(C=M.d.length,F=E.d.length,N=0,B=C<F?C:F;N<B;++N)if(M.d[N]!==E.d[N])return M.d[N]>E.d[N]^M.s<0?1:-1;return C===F?0:C>F^M.s<0?1:-1},g.decimalPlaces=g.dp=function(){var E=this,N=E.d.length-1,B=(N-E.e)*p;if(N=E.d[N],N)for(;N%10==0;N/=10)B--;return B<0?0:B},g.dividedBy=g.div=function(E){return b(this,new this.constructor(E))},g.dividedToIntegerBy=g.idiv=function(E){var N=this,B=N.constructor;return D(b(N,new B(E),0,1),B.precision)},g.equals=g.eq=function(E){return!this.cmp(E)},g.exponent=function(){return w(this)},g.greaterThan=g.gt=function(E){return this.cmp(E)>0},g.greaterThanOrEqualTo=g.gte=function(E){return this.cmp(E)>=0},g.isInteger=g.isint=function(){return this.e>this.d.length-2},g.isNegative=g.isneg=function(){return this.s<0},g.isPositive=g.ispos=function(){return this.s>0},g.isZero=function(){return this.s===0},g.lessThan=g.lt=function(E){return this.cmp(E)<0},g.lessThanOrEqualTo=g.lte=function(E){return this.cmp(E)<1},g.logarithm=g.log=function(E){var N,B=this,C=B.constructor,F=C.precision,M=F+5;if(E===void 0)E=new C(10);else if(E=new C(E),E.s<1||E.eq(d))throw Error(o+"NaN");if(B.s<1)throw Error(o+(B.s?"NaN":"-Infinity"));return B.eq(d)?new C(0):(n=!1,N=b(T(B,M),T(E,M),M),n=!0,D(N,F))},g.minus=g.sub=function(E){var N=this;return E=new N.constructor(E),N.s==E.s?O(N,E):v(N,(E.s=-E.s,E))},g.modulo=g.mod=function(E){var N,B=this,C=B.constructor,F=C.precision;if(E=new C(E),!E.s)throw Error(o+"NaN");return B.s?(n=!1,N=b(B,E,0,1).times(E),n=!0,B.minus(N)):D(new C(B),F)},g.naturalExponential=g.exp=function(){return x(this)},g.naturalLogarithm=g.ln=function(){return T(this)},g.negated=g.neg=function(){var E=new this.constructor(this);return E.s=-E.s||0,E},g.plus=g.add=function(E){var N=this;return E=new N.constructor(E),N.s==E.s?v(N,E):O(N,(E.s=-E.s,E))},g.precision=g.sd=function(E){var N,B,C,F=this;if(E!==void 0&&E!==!!E&&E!==1&&E!==0)throw Error(a+E);if(N=w(F)+1,C=F.d.length-1,B=C*p+1,C=F.d[C],C){for(;C%10==0;C/=10)B--;for(C=F.d[0];C>=10;C/=10)B++}return E&&N>B?N:B},g.squareRoot=g.sqrt=function(){var E,N,B,C,F,M,_,W=this,$=W.constructor;if(W.s<1){if(!W.s)return new $(0);throw Error(o+"NaN")}for(E=w(W),n=!1,F=Math.sqrt(+W),F==0||F==1/0?(N=y(W.d),(N.length+E)%2==0&&(N+="0"),F=Math.sqrt(N),E=s((E+1)/2)-(E<0||E%2),F==1/0?N="5e"+E:(N=F.toExponential(),N=N.slice(0,N.indexOf("e")+1)+E),C=new $(N)):C=new $(F.toString()),B=$.precision,F=_=B+3;;)if(M=C,C=M.plus(b(W,M,_+2)).times(.5),y(M.d).slice(0,_)===(N=y(C.d)).slice(0,_)){if(N=N.slice(_-3,_+1),F==_&&N=="4999"){if(D(M,B+1,0),M.times(M).eq(W)){C=M;break}}else if(N!="9999")break;_+=4}return n=!0,D(C,B)},g.times=g.mul=function(E){var N,B,C,F,M,_,W,$,H,R=this,V=R.constructor,Z=R.d,K=(E=new V(E)).d;if(!R.s||!E.s)return new V(0);for(E.s*=R.s,B=R.e+E.e,$=Z.length,H=K.length,$<H&&(M=Z,Z=K,K=M,_=$,$=H,H=_),M=[],_=$+H,C=_;C--;)M.push(0);for(C=H;--C>=0;){for(N=0,F=$+C;F>C;)W=M[F]+K[C]*Z[F-C-1]+N,M[F--]=W%u|0,N=W/u|0;M[F]=(M[F]+N)%u|0}for(;!M[--_];)M.pop();return N?++B:M.shift(),E.d=M,E.e=B,n?D(E,V.precision):E},g.toDecimalPlaces=g.todp=function(E,N){var B=this,C=B.constructor;return B=new C(B),E===void 0?B:(h(E,0,t),N===void 0?N=C.rounding:h(N,0,8),D(B,E+w(B)+1,N))},g.toExponential=function(E,N){var B,C=this,F=C.constructor;return E===void 0?B=z(C,!0):(h(E,0,t),N===void 0?N=F.rounding:h(N,0,8),C=D(new F(C),E+1,N),B=z(C,!0,E+1)),B},g.toFixed=function(E,N){var B,C,F=this,M=F.constructor;return E===void 0?z(F):(h(E,0,t),N===void 0?N=M.rounding:h(N,0,8),C=D(new M(F),E+w(F)+1,N),B=z(C.abs(),!1,E+w(C)+1),F.isneg()&&!F.isZero()?"-"+B:B)},g.toInteger=g.toint=function(){var E=this,N=E.constructor;return D(new N(E),w(E)+1,N.rounding)},g.toNumber=function(){return+this},g.toPower=g.pow=function(E){var N,B,C,F,M,_,W=this,$=W.constructor,H=12,R=+(E=new $(E));if(!E.s)return new $(d);if(W=new $(W),!W.s){if(E.s<1)throw Error(o+"Infinity");return W}if(W.eq(d))return W;if(C=$.precision,E.eq(d))return D(W,C);if(N=E.e,B=E.d.length-1,_=N>=B,M=W.s,_){if((B=R<0?-R:R)<=m){for(F=new $(d),N=Math.ceil(C/p+4),n=!1;B%2&&(F=F.times(W),I(F.d,N)),B=s(B/2),B!==0;)W=W.times(W),I(W.d,N);return n=!0,E.s<0?new $(d).div(F):D(F,C)}}else if(M<0)throw Error(o+"NaN");return M=M<0&&E.d[Math.max(N,B)]&1?-1:1,W.s=1,n=!1,F=E.times(T(W,C+H)),n=!0,F=x(F),F.s=M,F},g.toPrecision=function(E,N){var B,C,F=this,M=F.constructor;return E===void 0?(B=w(F),C=z(F,B<=M.toExpNeg||B>=M.toExpPos)):(h(E,1,t),N===void 0?N=M.rounding:h(N,0,8),F=D(new M(F),E,N),B=w(F),C=z(F,E<=B||B<=M.toExpNeg,E)),C},g.toSignificantDigits=g.tosd=function(E,N){var B=this,C=B.constructor;return E===void 0?(E=C.precision,N=C.rounding):(h(E,1,t),N===void 0?N=C.rounding:h(N,0,8)),D(new C(B),E,N)},g.toString=g.valueOf=g.val=g.toJSON=function(){var E=this,N=w(E),B=E.constructor;return z(E,N<=B.toExpNeg||N>=B.toExpPos)};function v(E,N){var B,C,F,M,_,W,$,H,R=E.constructor,V=R.precision;if(!E.s||!N.s)return N.s||(N=new R(E)),n?D(N,V):N;if($=E.d,H=N.d,_=E.e,F=N.e,$=$.slice(),M=_-F,M){for(M<0?(C=$,M=-M,W=H.length):(C=H,F=_,W=$.length),_=Math.ceil(V/p),W=_>W?_+1:W+1,M>W&&(M=W,C.length=1),C.reverse();M--;)C.push(0);C.reverse()}for(W=$.length,M=H.length,W-M<0&&(M=W,C=H,H=$,$=C),B=0;M;)B=($[--M]=$[M]+H[M]+B)/u|0,$[M]%=u;for(B&&($.unshift(B),++F),W=$.length;$[--W]==0;)$.pop();return N.d=$,N.e=F,n?D(N,V):N}function h(E,N,B){if(E!==~~E||E<N||E>B)throw Error(a+E)}function y(E){var N,B,C,F=E.length-1,M="",_=E[0];if(F>0){for(M+=_,N=1;N<F;N++)C=E[N]+"",B=p-C.length,B&&(M+=k(B)),M+=C;_=E[N],C=_+"",B=p-C.length,B&&(M+=k(B))}else if(_===0)return"0";for(;_%10===0;)_/=10;return M+_}var b=(function(){function E(C,F){var M,_=0,W=C.length;for(C=C.slice();W--;)M=C[W]*F+_,C[W]=M%u|0,_=M/u|0;return _&&C.unshift(_),C}function N(C,F,M,_){var W,$;if(M!=_)$=M>_?1:-1;else for(W=$=0;W<M;W++)if(C[W]!=F[W]){$=C[W]>F[W]?1:-1;break}return $}function B(C,F,M){for(var _=0;M--;)C[M]-=_,_=C[M]<F[M]?1:0,C[M]=_*u+C[M]-F[M];for(;!C[0]&&C.length>1;)C.shift()}return function(C,F,M,_){var W,$,H,R,V,Z,K,X,G,U,Q,J,ee,te,ue,be,Le,$e,oe=C.constructor,ge=C.s==F.s?1:-1,Se=C.d,De=F.d;if(!C.s)return new oe(C);if(!F.s)throw Error(o+"Division by zero");for($=C.e-F.e,Le=De.length,ue=Se.length,K=new oe(ge),X=K.d=[],H=0;De[H]==(Se[H]||0);)++H;if(De[H]>(Se[H]||0)&&--$,M==null?J=M=oe.precision:_?J=M+(w(C)-w(F))+1:J=M,J<0)return new oe(0);if(J=J/p+2|0,H=0,Le==1)for(R=0,De=De[0],J++;(H<ue||R)&&J--;H++)ee=R*u+(Se[H]||0),X[H]=ee/De|0,R=ee%De|0;else{for(R=u/(De[0]+1)|0,R>1&&(De=E(De,R),Se=E(Se,R),Le=De.length,ue=Se.length),te=Le,G=Se.slice(0,Le),U=G.length;U<Le;)G[U++]=0;$e=De.slice(),$e.unshift(0),be=De[0],De[1]>=u/2&&++be;do R=0,W=N(De,G,Le,U),W<0?(Q=G[0],Le!=U&&(Q=Q*u+(G[1]||0)),R=Q/be|0,R>1?(R>=u&&(R=u-1),V=E(De,R),Z=V.length,U=G.length,W=N(V,G,Z,U),W==1&&(R--,B(V,Le<Z?$e:De,Z))):(R==0&&(W=R=1),V=De.slice()),Z=V.length,Z<U&&V.unshift(0),B(G,V,U),W==-1&&(U=G.length,W=N(De,G,Le,U),W<1&&(R++,B(G,Le<U?$e:De,U))),U=G.length):W===0&&(R++,G=[0]),X[H++]=R,W&&G[0]?G[U++]=Se[te]||0:(G=[Se[te]],U=1);while((te++<ue||G[0]!==void 0)&&J--)}return X[0]||X.shift(),K.e=$,D(K,_?M+w(K)+1:M)}})();function x(E,N){var B,C,F,M,_,W,$=0,H=0,R=E.constructor,V=R.precision;if(w(E)>16)throw Error(i+w(E));if(!E.s)return new R(d);for(N==null?(n=!1,W=V):W=N,_=new R(.03125);E.abs().gte(.1);)E=E.times(_),H+=5;for(C=Math.log(l(2,H))/Math.LN10*2+5|0,W+=C,B=F=M=new R(d),R.precision=W;;){if(F=D(F.times(E),W),B=B.times(++$),_=M.plus(b(F,B,W)),y(_.d).slice(0,W)===y(M.d).slice(0,W)){for(;H--;)M=D(M.times(M),W);return R.precision=V,N==null?(n=!0,D(M,V)):M}M=_}}function w(E){for(var N=E.e*p,B=E.d[0];B>=10;B/=10)N++;return N}function S(E,N,B){if(N>E.LN10.sd())throw n=!0,B&&(E.precision=B),Error(o+"LN10 precision limit exceeded");return D(new E(E.LN10),N)}function k(E){for(var N="";E--;)N+="0";return N}function T(E,N){var B,C,F,M,_,W,$,H,R,V=1,Z=10,K=E,X=K.d,G=K.constructor,U=G.precision;if(K.s<1)throw Error(o+(K.s?"NaN":"-Infinity"));if(K.eq(d))return new G(0);if(N==null?(n=!1,H=U):H=N,K.eq(10))return N==null&&(n=!0),S(G,H);if(H+=Z,G.precision=H,B=y(X),C=B.charAt(0),M=w(K),Math.abs(M)<15e14){for(;C<7&&C!=1||C==1&&B.charAt(1)>3;)K=K.times(E),B=y(K.d),C=B.charAt(0),V++;M=w(K),C>1?(K=new G("0."+B),M++):K=new G(C+"."+B.slice(1))}else return $=S(G,H+2,U).times(M+""),K=T(new G(C+"."+B.slice(1)),H-Z).plus($),G.precision=U,N==null?(n=!0,D(K,U)):K;for(W=_=K=b(K.minus(d),K.plus(d),H),R=D(K.times(K),H),F=3;;){if(_=D(_.times(R),H),$=W.plus(b(_,new G(F),H)),y($.d).slice(0,H)===y(W.d).slice(0,H))return W=W.times(2),M!==0&&(W=W.plus(S(G,H+2,U).times(M+""))),W=b(W,new G(V),H),G.precision=U,N==null?(n=!0,D(W,U)):W;W=$,F+=2}}function P(E,N){var B,C,F;for((B=N.indexOf("."))>-1&&(N=N.replace(".","")),(C=N.search(/e/i))>0?(B<0&&(B=C),B+=+N.slice(C+1),N=N.substring(0,C)):B<0&&(B=N.length),C=0;N.charCodeAt(C)===48;)++C;for(F=N.length;N.charCodeAt(F-1)===48;)--F;if(N=N.slice(C,F),N){if(F-=C,B=B-C-1,E.e=s(B/p),E.d=[],C=(B+1)%p,B<0&&(C+=p),C<F){for(C&&E.d.push(+N.slice(0,C)),F-=p;C<F;)E.d.push(+N.slice(C,C+=p));N=N.slice(C),C=p-N.length}else C-=F;for(;C--;)N+="0";if(E.d.push(+N),n&&(E.e>f||E.e<-f))throw Error(i+B)}else E.s=0,E.e=0,E.d=[0];return E}function D(E,N,B){var C,F,M,_,W,$,H,R,V=E.d;for(_=1,M=V[0];M>=10;M/=10)_++;if(C=N-_,C<0)C+=p,F=N,H=V[R=0];else{if(R=Math.ceil((C+1)/p),M=V.length,R>=M)return E;for(H=M=V[R],_=1;M>=10;M/=10)_++;C%=p,F=C-p+_}if(B!==void 0&&(M=l(10,_-F-1),W=H/M%10|0,$=N<0||V[R+1]!==void 0||H%M,$=B<4?(W||$)&&(B==0||B==(E.s<0?3:2)):W>5||W==5&&(B==4||$||B==6&&(C>0?F>0?H/l(10,_-F):0:V[R-1])%10&1||B==(E.s<0?8:7))),N<1||!V[0])return $?(M=w(E),V.length=1,N=N-M-1,V[0]=l(10,(p-N%p)%p),E.e=s(-N/p)||0):(V.length=1,V[0]=E.e=E.s=0),E;if(C==0?(V.length=R,M=1,R--):(V.length=R+1,M=l(10,p-C),V[R]=F>0?(H/l(10,_-F)%l(10,F)|0)*M:0),$)for(;;)if(R==0){(V[0]+=M)==u&&(V[0]=1,++E.e);break}else{if(V[R]+=M,V[R]!=u)break;V[R--]=0,M=1}for(C=V.length;V[--C]===0;)V.pop();if(n&&(E.e>f||E.e<-f))throw Error(i+w(E));return E}function O(E,N){var B,C,F,M,_,W,$,H,R,V,Z=E.constructor,K=Z.precision;if(!E.s||!N.s)return N.s?N.s=-N.s:N=new Z(E),n?D(N,K):N;if($=E.d,V=N.d,C=N.e,H=E.e,$=$.slice(),_=H-C,_){for(R=_<0,R?(B=$,_=-_,W=V.length):(B=V,C=H,W=$.length),F=Math.max(Math.ceil(K/p),W)+2,_>F&&(_=F,B.length=1),B.reverse(),F=_;F--;)B.push(0);B.reverse()}else{for(F=$.length,W=V.length,R=F<W,R&&(W=F),F=0;F<W;F++)if($[F]!=V[F]){R=$[F]<V[F];break}_=0}for(R&&(B=$,$=V,V=B,N.s=-N.s),W=$.length,F=V.length-W;F>0;--F)$[W++]=0;for(F=V.length;F>_;){if($[--F]<V[F]){for(M=F;M&&$[--M]===0;)$[M]=u-1;--$[M],$[F]+=u}$[F]-=V[F]}for(;$[--W]===0;)$.pop();for(;$[0]===0;$.shift())--C;return $[0]?(N.d=$,N.e=C,n?D(N,K):N):new Z(0)}function z(E,N,B){var C,F=w(E),M=y(E.d),_=M.length;return N?(B&&(C=B-_)>0?M=M.charAt(0)+"."+M.slice(1)+k(C):_>1&&(M=M.charAt(0)+"."+M.slice(1)),M=M+(F<0?"e":"e+")+F):F<0?(M="0."+k(-F-1)+M,B&&(C=B-_)>0&&(M+=k(C))):F>=_?(M+=k(F+1-_),B&&(C=B-F-1)>0&&(M=M+"."+k(C))):((C=F+1)<_&&(M=M.slice(0,C)+"."+M.slice(C)),B&&(C=B-_)>0&&(F+1===_&&(M+="."),M+=k(C))),E.s<0?"-"+M:M}function I(E,N){if(E.length>N)return E.length=N,!0}function A(E){var N,B,C;function F(M){var _=this;if(!(_ instanceof F))return new F(M);if(_.constructor=F,M instanceof F){_.s=M.s,_.e=M.e,_.d=(M=M.d)?M.slice():M;return}if(typeof M=="number"){if(M*0!==0)throw Error(a+M);if(M>0)_.s=1;else if(M<0)M=-M,_.s=-1;else{_.s=0,_.e=0,_.d=[0];return}if(M===~~M&&M<1e7){_.e=0,_.d=[M];return}return P(_,M.toString())}else if(typeof M!="string")throw Error(a+M);if(M.charCodeAt(0)===45?(M=M.slice(1),_.s=-1):_.s=1,c.test(M))P(_,M);else throw Error(a+M)}if(F.prototype=g,F.ROUND_UP=0,F.ROUND_DOWN=1,F.ROUND_CEIL=2,F.ROUND_FLOOR=3,F.ROUND_HALF_UP=4,F.ROUND_HALF_DOWN=5,F.ROUND_HALF_EVEN=6,F.ROUND_HALF_CEIL=7,F.ROUND_HALF_FLOOR=8,F.clone=A,F.config=F.set=j,E===void 0&&(E={}),E)for(C=["precision","rounding","toExpNeg","toExpPos","LN10"],N=0;N<C.length;)E.hasOwnProperty(B=C[N++])||(E[B]=this[B]);return F.config(E),F}function j(E){if(!E||typeof E!="object")throw Error(o+"Object expected");var N,B,C,F=["precision",1,t,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(N=0;N<F.length;N+=3)if((C=E[B=F[N]])!==void 0)if(s(C)===C&&C>=F[N+1]&&C<=F[N+2])this[B]=C;else throw Error(a+B+": "+C);if((C=E[B="LN10"])!==void 0)if(C==Math.LN10)this[B]=new this(C);else throw Error(a+B+": "+C);return this}r=A(r),r.default=r.Decimal=r,d=new r(1),typeof define=="function"&&define.amd?define(function(){return r}):typeof YE!="undefined"&&YE.exports?YE.exports=r:(e||(e=typeof self!="undefined"&&self&&self.self==self?self:Function("return this")()),e.Decimal=r)})(Cte)});var DAe,Dte,Ete,Pte,Ite,Ik,KE,Ate,Lte,JE,y$,b$=L(()=>{DAe=e=>e,Dte={"@@functional/placeholder":!0},Ete=e=>e===Dte,Pte=e=>function t(){return arguments.length===0||arguments.length===1&&Ete(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},Ite=(e,t)=>e===1?t:Pte(function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];var a=n.filter(i=>i!==Dte).length;return a>=e?t(...n):Ite(e-a,Pte(function(){for(var i=arguments.length,s=new Array(i),l=0;l<i;l++)s[l]=arguments[l];var c=n.map(d=>Ete(d)?s.shift():d);return t(...c,...s)}))}),Ik=e=>Ite(e.length,e),KE=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},Ate=Ik((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),Lte=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return DAe;var o=r.reverse(),a=o[0],i=o.slice(1);return function(){return i.reduce((s,l)=>l(s),a(...arguments))}},JE=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),y$=e=>{var t=null,r=null;return function(){for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return t&&o.every((i,s)=>{var l;return i===((l=t)===null||l===void 0?void 0:l[s])})||(t=o,r=e(...o)),r}}});function w$(e){var t;return e===0?t=1:t=Math.floor(new x$.default(e).abs().log(10).toNumber())+1,t}function k$(e,t,r){for(var n=new x$.default(e),o=0,a=[];n.lt(t)&&o<1e5;)a.push(n.toNumber()),n=n.add(r),o++;return a}var x$,iit,sit,lit,Nte=L(()=>{x$=q(v$());b$();iit=Ik((e,t,r)=>{var n=+e,o=+t;return n+r*(o-n)}),sit=Ik((e,t,r)=>{var n=t-+e;return n=n||1/0,(r-e)/n}),lit=Ik((e,t,r)=>{var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))})});function IAe(e){var[t,r]=e,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=Math.max(n,2),[i,s]=Mte([t,r]);if(i===-1/0||s===1/0){var l=s===1/0?[i,...KE(0,n-1).map(()=>1/0)]:[...KE(0,n-1).map(()=>-1/0),s];return t>r?JE(l):l}if(i===s)return EAe(i,n,o);var{step:c,tickMin:d,tickMax:u}=Ote(i,s,a,o,0),p=k$(d,u.add(new Zr.default(.1).mul(c)),c);return t>r?JE(p):p}function AAe(e,t){var[r,n]=e,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[a,i]=Mte([r,n]);if(a===-1/0||i===1/0)return[r,n];if(a===i)return[a];var s=Math.max(t,2),l=Fte(new Zr.default(i).sub(a).div(s-1),o,0),c=[...k$(new Zr.default(a),new Zr.default(i),l),i];return o===!1&&(c=c.map(d=>Math.round(d))),r>n?JE(c):c}var Zr,Mte,Fte,EAe,Ote,S$,T$,jte=L(()=>{Zr=q(v$());b$();Nte();Mte=e=>{var[t,r]=e,[n,o]=[t,r];return t>r&&([n,o]=[r,t]),[n,o]},Fte=(e,t,r)=>{if(e.lte(0))return new Zr.default(0);var n=w$(e.toNumber()),o=new Zr.default(10).pow(n),a=e.div(o),i=n!==1?.05:.1,s=new Zr.default(Math.ceil(a.div(i).toNumber())).add(r).mul(i),l=s.mul(o);return t?new Zr.default(l.toNumber()):new Zr.default(Math.ceil(l.toNumber()))},EAe=(e,t,r)=>{var n=new Zr.default(1),o=new Zr.default(e);if(!o.isint()&&r){var a=Math.abs(e);a<1?(n=new Zr.default(10).pow(w$(e)-1),o=new Zr.default(Math.floor(o.div(n).toNumber())).mul(n)):a>1&&(o=new Zr.default(Math.floor(e)))}else e===0?o=new Zr.default(Math.floor((t-1)/2)):r||(o=new Zr.default(Math.floor(e)));var i=Math.floor((t-1)/2),s=Lte(Ate(l=>o.add(new Zr.default(l-i).mul(n)).toNumber()),KE);return s(0,t)},Ote=function(t,r,n,o){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new Zr.default(0),tickMin:new Zr.default(0),tickMax:new Zr.default(0)};var i=Fte(new Zr.default(r).sub(t).div(n-1),o,a),s;t<=0&&r>=0?s=new Zr.default(0):(s=new Zr.default(t).add(r).div(2),s=s.sub(new Zr.default(s).mod(i)));var l=Math.ceil(s.sub(t).div(i).toNumber()),c=Math.ceil(new Zr.default(r).sub(s).div(i).toNumber()),d=l+c+1;return d>n?Ote(t,r,n,o,a+1):(d<n&&(c=r>0?c+(n-d):c,l=r>0?l:l+(n-d)),{step:i,tickMin:s.sub(new Zr.default(l).mul(i)),tickMax:s.add(new Zr.default(c).mul(i))})};S$=y$(IAe),T$=y$(AAe)});var zte=L(()=>{jte()});var C$,_te,XE,Bte,eb,tb,QE,P$,ZE,rb=L(()=>{C$=e=>e.rootProps.maxBarSize,_te=e=>e.rootProps.barGap,XE=e=>e.rootProps.barCategoryGap,Bte=e=>e.rootProps.barSize,eb=e=>e.rootProps.stackOffset,tb=e=>e.options.chartName,QE=e=>e.rootProps.syncId,P$=e=>e.rootProps.syncMethod,ZE=e=>e.options.eventEmitter});var Ud,$te=L(()=>{Ud={allowDuplicatedCategory:!0,angleAxisId:0,axisLine:!0,cx:0,cy:0,orientation:"outer",reversed:!1,scale:"auto",tick:!0,tickLine:!0,tickSize:8,type:"category"}});var bs,Wte=L(()=>{bs={allowDataOverflow:!1,allowDuplicatedCategory:!0,angle:0,axisLine:!0,cx:0,cy:0,orientation:"right",radiusAxisId:0,scale:"auto",stroke:"#ccc",tick:!0,tickCount:5,type:"number"}});var th,eI=L(()=>{th=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t}});var LAe,NAe,MAe,FAe,tI,rI,nI,D$,Rte,Ute,OAe,E$,Eit,I$,Iit,oI,aI=L(()=>{Pa();Nd();Rl();Og();nr();$te();Wte();eI();Co();LAe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Ud.angleAxisId,includeHidden:!1,name:void 0,reversed:Ud.reversed,scale:Ud.scale,tick:Ud.tick,tickCount:void 0,ticks:void 0,type:Ud.type,unit:void 0},NAe={allowDataOverflow:bs.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:bs.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:bs.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:bs.scale,tick:bs.tick,tickCount:bs.tickCount,ticks:void 0,type:bs.type,unit:void 0},MAe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Ud.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Ud.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Ud.scale,tick:Ud.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},FAe={allowDataOverflow:bs.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:bs.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:bs.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:bs.scale,tick:bs.tick,tickCount:bs.tickCount,ticks:void 0,type:"category",unit:void 0},tI=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?MAe:LAe,rI=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?FAe:NAe,nI=e=>e.polarOptions,D$=ie([hi,vi,on],CX),Rte=ie([nI,D$],(e,t)=>{if(e!=null)return gi(e.innerRadius,t,0)}),Ute=ie([nI,D$],(e,t)=>{if(e!=null)return gi(e.outerRadius,t,t*.8)}),OAe=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},E$=ie([nI],OAe),Eit=ie([tI,E$],th),I$=ie([D$,Rte,Ute],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]}),Iit=ie([rI,I$],th),oI=ie([zt,nI,Rte,Ute,hi,vi],(e,t,r,n,o,a)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:i,cy:s,startAngle:l,endAngle:c}=t;return{cx:gi(i,o,o/2),cy:gi(s,a,a/2),innerRadius:r,outerRadius:n,startAngle:l,endAngle:c,clockWise:!1}}})});var Po,Vte=L(()=>{Po=(e,t)=>t});var Ak,Hte=L(()=>{Ak=(e,t,r)=>r});function jm(e){return e==null?void 0:e.id}var Lk=L(()=>{});var fo,iI=L(()=>{Co();fo=e=>{var t=zt(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"}});var zm,A$=L(()=>{zm=e=>e.tooltip.settings.axisId});var Do,sI,Nk=L(()=>{Pa();Kl();iI();A$();Do=e=>{var t=fo(e),r=zm(e);return nb(e,t,r)},sI=ie([Do],e=>e==null?void 0:e.dataKey)});function lI(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:o,dataKey:a}=r,i=new Map;return e.forEach(s=>{var l,c=(l=s.data)!==null&&l!==void 0?l:n;if(!(c==null||c.length===0)){var d=jm(s);c.forEach((u,p)=>{var m=a==null||o?p:String(nn(u,a,null)),f=nn(u,s.dataKey,0),g;i.has(m)?g=i.get(m):g={},Object.assign(g,{[d]:f}),i.set(m,g)})}}),Array.from(i.values())}var L$=L(()=>{Lk();Ka()});function rh(e){return e.stackId!=null&&e.dataKey!=null}var cI=L(()=>{});function qte(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function dI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qte(Object(r),!0).forEach(function(n){jAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qte(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jAe(e,t,r){return(t=zAe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zAe(e){var t=_Ae(e,"string");return typeof t=="symbol"?t:t+""}function _Ae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _$(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}function Jte(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function nh(e){return e.filter(t=>Sa(t)||t instanceof Date).map(Number).filter(t=>Mn(t)===!1)}function UAe(e,t,r){return!r||typeof t!="number"||Mn(t)?[]:r.length?nh(r.flatMap(n=>{var o=nn(e,n.dataKey),a,i;if(Array.isArray(o)?[a,i]=o:a=i=o,!(!Fn(a)||!Fn(i)))return[t-a,t+i]})):[]}function GAe(e){var{value:t}=e;if(Sa(t)||t instanceof Date)return t}function aLe(e){if(e!=null){if(e in Qg)return Qg[e]();var t="scale".concat(Sm(e));if(t in Qg)return Qg[t]()}}function mI(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var o=aLe(t);if(o!=null){var a=o.domain(r).range(n);return MX(a),a}}}function ere(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var M$,N$,Vi,F$,_c,Hi,O$,Bc,BAe,j$,xs,$Ae,nb,z$,_m,WAe,B$,Fk,Yte,$$,Kte,W$,RAe,R$,U$,V$,uI,VAe,H$,oh,q$,HAe,G$,Ok,Xte,fst,qAe,Gte,YAe,pI,Mk,Y$,ah,KAe,K$,JAe,J$,XAe,X$,QAe,Q$,ZAe,Z$,eLe,tLe,rLe,eW,nLe,oLe,tW,rW,nW,jk,oW,aW,iW,iLe,sLe,Qte,lLe,cLe,dLe,uLe,pLe,mLe,ob,Zte,$c,gst,fI,gI,fLe,gLe,tre,hLe,sW,vLe,yLe,bLe,xLe,rre,nre,lW,cW,dW,uW,pW,mW,fW,wLe,hI,kLe,rl,nl,SLe,hst,ore,Kl=L(()=>{Pa();M$=q(nZ());xte();Co();Ka();Zg();Tte();nr();Fd();zte();Nd();G_();Rl();$D();rb();aI();Vte();Hte();eI();zD();Lk();Nk();L$();cI();N$=[0,"auto"],Vi={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},F$=(e,t)=>e.cartesianAxis.xAxis[t],_c=(e,t)=>{var r=F$(e,t);return r==null?Vi:r},Hi={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:N$,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:jg},O$=(e,t)=>e.cartesianAxis.yAxis[t],Bc=(e,t)=>{var r=O$(e,t);return r==null?Hi:r},BAe={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},j$=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r==null?BAe:r},xs=(e,t,r)=>{switch(t){case"xAxis":return _c(e,r);case"yAxis":return Bc(e,r);case"zAxis":return j$(e,r);case"angleAxis":return tI(e,r);case"radiusAxis":return rI(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},$Ae=(e,t,r)=>{switch(t){case"xAxis":return _c(e,r);case"yAxis":return Bc(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},nb=(e,t,r)=>{switch(t){case"xAxis":return _c(e,r);case"yAxis":return Bc(e,r);case"angleAxis":return tI(e,r);case"radiusAxis":return rI(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},z$=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");_m=e=>e.graphicalItems.cartesianItems,WAe=ie([Po,Ak],_$),B$=(e,t,r)=>e.filter(r).filter(n=>(t==null?void 0:t.includeHidden)===!0?!0:!n.hide),Fk=ie([_m,xs,WAe],B$),Yte=ie([Fk],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(rh)),$$=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),Kte=ie([Fk],$$),W$=e=>e.map(t=>t.data).filter(Boolean).flat(1),RAe=ie([Fk],W$),R$=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:o}=t;return e.length>0?e:r.slice(n,o+1)},U$=ie([RAe,ep],R$),V$=(e,t,r)=>(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:nn(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(o=>({value:nn(o,n)}))):e.map(n=>({value:n})),uI=ie([U$,xs,Fk],V$);VAe=ie([Yte,ep,Do],lI),H$=(e,t,r)=>{var n={},o=t.reduce((a,i)=>(i.stackId==null||(a[i.stackId]==null&&(a[i.stackId]=[]),a[i.stackId].push(i)),a),n);return Object.fromEntries(Object.entries(o).map(a=>{var[i,s]=a,l=s.map(jm);return[i,{stackedData:OX(e,l,r),graphicalItems:s}]}))},oh=ie([VAe,Yte,eb],H$),q$=(e,t,r)=>{var{dataStartIndex:n,dataEndIndex:o}=t;if(r!=="zAxis"){var a=zX(e,n,o);if(!(a!=null&&a[0]===0&&a[1]===0))return a}},HAe=ie([oh,zc,Po],q$),G$=(e,t,r,n,o)=>r.length>0?e.flatMap(a=>r.flatMap(i=>{var s,l,c=(s=n[i.id])===null||s===void 0?void 0:s.filter(u=>Jte(o,u)),d=nn(a,(l=t.dataKey)!==null&&l!==void 0?l:i.dataKey);return{value:d,errorDomain:UAe(a,d,c)}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(a=>({value:nn(a,t.dataKey),errorDomain:[]})):e.map(a=>({value:a,errorDomain:[]})),Ok=e=>e.errorBars,Xte=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>Jte(r,n)),fst=ie([Kte,Ok,Po],Xte),qAe=ie([U$,xs,Kte,Ok,Po],G$);Gte=e=>{var t=e.flatMap(n=>[n.value,n.errorDomain]).flat(1),r=nh(t);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},YAe=(e,t,r)=>{var n=e.map(GAe).filter(o=>o!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&Fj(n))?(0,M$.default)(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},pI=e=>{var t;if(e==null||!("domain"in e))return N$;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=nh(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e==null?void 0:e.domain)!==null&&t!==void 0?t:N$},Mk=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var o=r.filter(Boolean);if(o.length!==0){var a=o.flat(),i=Math.min(...a),s=Math.max(...a);return[i,s]}},Y$=e=>e.referenceElements.dots,ah=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),KAe=ie([Y$,Po,Ak],ah),K$=e=>e.referenceElements.areas,JAe=ie([K$,Po,Ak],ah),J$=e=>e.referenceElements.lines,XAe=ie([J$,Po,Ak],ah),X$=(e,t)=>{var r=nh(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},QAe=ie(KAe,Po,X$),Q$=(e,t)=>{var r=nh(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},ZAe=ie([JAe,Po],Q$),Z$=(e,t)=>{var r=nh(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},eLe=ie(XAe,Po,Z$),tLe=ie(QAe,eLe,ZAe,(e,t,r)=>Mk(e,r,t)),rLe=ie([xs],pI),eW=(e,t,r,n,o,a,i)=>{var s=kte(t,e.allowDataOverflow);if(s!=null)return s;var l=a==="vertical"&&i==="xAxis"||a==="horizontal"&&i==="yAxis",c=l?Mk(r,o,Gte(n)):Mk(o,Gte(n));return Ste(t,c,e.allowDataOverflow)},nLe=ie([xs,rLe,HAe,qAe,tLe,zt,Po],eW),oLe=[0,1],tW=(e,t,r,n,o,a,i)=>{if(!((e==null||r==null||r.length===0)&&i===void 0)){var{dataKey:s,type:l}=e,c=hs(t,a);return c&&s==null?(0,M$.default)(0,r.length):l==="category"?YAe(n,e,c):o==="expand"?oLe:i}},rW=ie([xs,zt,U$,uI,eb,Po,nLe],tW),nW=(e,t,r,n,o)=>{if(e!=null){var{scale:a,type:i}=e;if(a==="auto")return t==="radial"&&o==="radiusAxis"?"band":t==="radial"&&o==="angleAxis"?"linear":i==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":i==="category"?"band":"linear";if(typeof a=="string"){var s="scale".concat(Sm(a));return s in Qg?s:"point"}}},jk=ie([xs,zt,z$,tb,Po],nW);oW=(e,t,r)=>{var n=pI(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&eh(e))return S$(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&eh(e))return T$(e,t.tickCount,t.allowDecimals)}},aW=ie([rW,nb,jk],oW),iW=(e,t,r,n)=>{if(n!=="angleAxis"&&(e==null?void 0:e.type)==="number"&&eh(t)&&Array.isArray(r)&&r.length>0){var o=t[0],a=r[0],i=t[1],s=r[r.length-1];return[Math.min(o,a),Math.max(i,s)]}return t},iLe=ie([xs,rW,aW,Po],iW),sLe=ie(uI,xs,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(nh(e.map(s=>s.value))).sort((s,l)=>s-l);if(n.length<2)return 1/0;var o=n[n.length-1]-n[0];if(o===0)return 1/0;for(var a=0;a<n.length-1;a++){var i=n[a+1]-n[a];r=Math.min(r,i)}return r/o}}),Qte=ie(sLe,zt,XE,on,(e,t,r,n)=>n,(e,t,r,n,o)=>{if(!Fn(e))return 0;var a=t==="vertical"?n.height:n.width;if(o==="gap")return e*a/2;if(o==="no-gap"){var i=gi(r,e*a),s=e*a/2;return s-i-(s-i)/a*i}return 0}),lLe=(e,t)=>{var r=_c(e,t);return r==null||typeof r.padding!="string"?0:Qte(e,"xAxis",t,r.padding)},cLe=(e,t)=>{var r=Bc(e,t);return r==null||typeof r.padding!="string"?0:Qte(e,"yAxis",t,r.padding)},dLe=ie(_c,lLe,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:o}=e;return typeof o=="string"?{left:t,right:t}:{left:((r=o.left)!==null&&r!==void 0?r:0)+t,right:((n=o.right)!==null&&n!==void 0?n:0)+t}}),uLe=ie(Bc,cLe,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:o}=e;return typeof o=="string"?{top:t,bottom:t}:{top:((r=o.top)!==null&&r!==void 0?r:0)+t,bottom:((n=o.bottom)!==null&&n!==void 0?n:0)+t}}),pLe=ie([on,dLe,zg,Ay,(e,t,r)=>r],(e,t,r,n,o)=>{var{padding:a}=n;return o?[a.left,r.width-a.right]:[e.left+t.left,e.left+e.width-t.right]}),mLe=ie([on,zt,uLe,zg,Ay,(e,t,r)=>r],(e,t,r,n,o,a)=>{var{padding:i}=o;return a?[n.height-i.bottom,i.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),ob=(e,t,r,n)=>{var o;switch(t){case"xAxis":return pLe(e,r,n);case"yAxis":return mLe(e,r,n);case"zAxis":return(o=j$(e,r))===null||o===void 0?void 0:o.range;case"angleAxis":return E$(e);case"radiusAxis":return I$(e,r);default:return}},Zte=ie([xs,ob],th),$c=ie([xs,jk,iLe,Zte],mI),gst=ie([Fk,Ok,Po],Xte);fI=(e,t)=>t,gI=(e,t,r)=>r,fLe=ie(Dy,fI,gI,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(ere)),gLe=ie(Ey,fI,gI,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(ere)),tre=(e,t)=>({width:e.width,height:t.height}),hLe=(e,t)=>{var r=typeof t.width=="number"?t.width:jg;return{width:r,height:e.height}},sW=ie(on,_c,tre),vLe=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},yLe=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},bLe=ie(vi,on,fLe,fI,gI,(e,t,r,n,o)=>{var a={},i;return r.forEach(s=>{var l=tre(t,s);i==null&&(i=vLe(t,n,e));var c=n==="top"&&!o||n==="bottom"&&o;a[s.id]=i-Number(c)*l.height,i+=(c?-1:1)*l.height}),a}),xLe=ie(hi,on,gLe,fI,gI,(e,t,r,n,o)=>{var a={},i;return r.forEach(s=>{var l=hLe(t,s);i==null&&(i=yLe(t,n,e));var c=n==="left"&&!o||n==="right"&&o;a[s.id]=i-Number(c)*l.width,i+=(c?-1:1)*l.width}),a}),rre=(e,t)=>{var r=on(e),n=_c(e,t);if(n!=null){var o=bLe(e,n.orientation,n.mirror),a=o[t];return a==null?{x:r.left,y:0}:{x:r.left,y:a}}},nre=(e,t)=>{var r=on(e),n=Bc(e,t);if(n!=null){var o=xLe(e,n.orientation,n.mirror),a=o[t];return a==null?{x:0,y:r.top}:{x:a,y:r.top}}},lW=ie(on,Bc,(e,t)=>{var r=typeof t.width=="number"?t.width:jg;return{width:r,height:e.height}}),cW=(e,t,r)=>{switch(t){case"xAxis":return sW(e,r).width;case"yAxis":return lW(e,r).height;default:return}},dW=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:o,type:a,dataKey:i}=r,s=hs(e,n),l=t.map(c=>c.value);if(i&&s&&a==="category"&&o&&Fj(l))return l}},uW=ie([zt,uI,xs,Po],dW),pW=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:o,scale:a}=r,i=hs(e,n);if(i&&(o==="number"||a!=="auto"))return t.map(s=>s.value)}},mW=ie([zt,uI,nb,Po],pW),fW=ie([zt,$Ae,jk,$c,uW,mW,ob,aW,Po],(e,t,r,n,o,a,i,s,l)=>{if(t==null)return null;var c=hs(e,l);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:l,categoricalDomain:a,duplicateDomain:o,isCategorical:c,niceTicks:s,range:i,realScaleType:r,scale:n}}),wLe=(e,t,r,n,o,a,i,s,l)=>{if(!(t==null||n==null)){var c=hs(e,l),{type:d,ticks:u,tickCount:p}=t,m=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,f=d==="category"&&n.bandwidth?n.bandwidth()/m:0;f=l==="angleAxis"&&a!=null&&a.length>=2?To(a[0]-a[1])*2*f:f;var g=u||o;if(g){var v=g.map((h,y)=>{var b=i?i.indexOf(h):h;return{index:y,coordinate:n(b)+f,value:h,offset:f}});return v.filter(h=>!Mn(h.coordinate))}return c&&s?s.map((h,y)=>({coordinate:n(h)+f,value:h,index:y,offset:f})):n.ticks?n.ticks(p).map(h=>({coordinate:n(h)+f,value:h,offset:f})):n.domain().map((h,y)=>({coordinate:n(h)+f,value:i?i[h]:h,index:y,offset:f}))}},hI=ie([zt,nb,jk,$c,aW,ob,uW,mW,Po],wLe),kLe=(e,t,r,n,o,a,i)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var s=hs(e,i),{tickCount:l}=t,c=0;return c=i==="angleAxis"&&(n==null?void 0:n.length)>=2?To(n[0]-n[1])*2*c:c,s&&a?a.map((d,u)=>({coordinate:r(d)+c,value:d,index:u,offset:c})):r.ticks?r.ticks(l).map(d=>({coordinate:r(d)+c,value:d,offset:c})):r.domain().map((d,u)=>({coordinate:r(d)+c,value:o?o[d]:d,index:u,offset:c}))}},rl=ie([zt,nb,$c,ob,uW,mW,Po],kLe),nl=ie(xs,$c,(e,t)=>{if(!(e==null||t==null))return dI(dI({},e),{},{scale:t})}),SLe=ie([xs,jk,rW,Zte],mI),hst=ie((e,t,r)=>j$(e,r),SLe,(e,t)=>{if(!(e==null||t==null))return dI(dI({},e),{},{scale:t})}),ore=ie([zt,Dy,Ey],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}})});function vW(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function zk(e,t){var r=gW(e),n=hW(e);return vW(t,r,n)}function are(e){return Oe(t=>zk(t,e))}var gW,hW,_k=L(()=>{Or();gW=e=>e.options.defaultTooltipEventType,hW=e=>e.options.validateTooltipEventTypes});var vI,yW=L(()=>{nr();vI=(e,t)=>{var r,n=Number(t);if(!(Mn(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0}});var ire,sre=L(()=>{ire=e=>e.tooltip.settings});var tp,TLe,lre,cre,dre,ure,yI,pre,bI,mre,xI,fre,wI,kI,gre,Wc=L(()=>{oa();tp={active:!1,index:null,dataKey:void 0,coordinate:void 0},TLe={itemInteraction:{click:tp,hover:tp},axisInteraction:{click:tp,hover:tp},keyboardInteraction:tp,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},lre=hn({name:"tooltip",initialState:TLe,reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var r=gs(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:cre,removeTooltipEntrySettings:dre,setTooltipSettingsState:ure,setActiveMouseOverItemIndex:yI,mouseLeaveItem:pre,mouseLeaveChart:bI,setActiveClickItemIndex:mre,setMouseOverAxisIndex:xI,setMouseClickAxisIndex:fre,setSyncInteraction:wI,setKeyboardInteraction:kI}=lre.actions,gre=lre.reducer});function hre(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function SI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hre(Object(r),!0).forEach(function(n){CLe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hre(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function CLe(e,t,r){return(t=PLe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PLe(e){var t=DLe(e,"string");return typeof t=="symbol"?t:t+""}function DLe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ELe(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function ILe(e){return e.index!=null}var TI,bW=L(()=>{Wc();TI=(e,t,r,n)=>{if(t==null)return tp;var o=ELe(e,t,r);if(o==null)return tp;if(o.active)return o;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var a=e.settings.active===!0;if(ILe(o)){if(a)return SI(SI({},o),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return SI(SI({},tp),{},{coordinate:o.coordinate})}});var ab,CI=L(()=>{Fd();ab=(e,t)=>{var r=e==null?void 0:e.index;if(r==null)return null;var n=Number(r);if(!Fn(n))return r;var o=0,a=1/0;return t.length>0&&(a=t.length-1),String(Math.max(o,Math.min(n,a)))}});var PI,xW=L(()=>{PI=(e,t,r,n,o,a,i,s)=>{if(!(a==null||s==null)){var l=i[0],c=l==null?void 0:s(l.positions,a);if(c!=null)return c;var d=o==null?void 0:o[Number(a)];if(d)switch(r){case"horizontal":return{x:d.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:d.coordinate}}}}});var DI,wW=L(()=>{DI=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var o;return r==="hover"?o=e.itemInteraction.hover.dataKey:o=e.itemInteraction.click.dataKey,o==null&&n!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(a=>{var i;return((i=a.settings)===null||i===void 0?void 0:i.dataKey)===o})}});var Bm,EI=L(()=>{Bm=e=>e.options.tooltipPayloadSearcher});var rp,II=L(()=>{rp=e=>e.tooltip});function vre(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function yre(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vre(Object(r),!0).forEach(function(n){ALe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vre(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ALe(e,t,r){return(t=LLe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LLe(e){var t=NLe(e,"string");return typeof t=="symbol"?t:t+""}function NLe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MLe(e,t){return e!=null?e:t}var AI,kW=L(()=>{nr();Ka();$_();AI=(e,t,r,n,o,a,i)=>{if(!(t==null||a==null)){var{chartData:s,computedData:l,dataStartIndex:c,dataEndIndex:d}=r,u=[];return e.reduce((p,m)=>{var f,{dataDefinedOnItem:g,settings:v}=m,h=MLe(g,s),y=Array.isArray(h)?FD(h,c,d):h,b=(f=v==null?void 0:v.dataKey)!==null&&f!==void 0?f:n,x=v==null?void 0:v.nameKey,w;if(n&&Array.isArray(y)&&!Array.isArray(y[0])&&i==="axis"?w=$P(y,n,o):w=a(y,t,l,x),Array.isArray(w))w.forEach(k=>{var T=yre(yre({},v),{},{name:k.name,unit:k.unit,color:void 0,fill:void 0});p.push(q_({tooltipEntrySettings:T,dataKey:k.dataKey,payload:k.payload,value:nn(k.payload,k.dataKey),name:k.name}))});else{var S;p.push(q_({tooltipEntrySettings:v,dataKey:b,payload:w,value:nn(w,b),name:(S=nn(w,x))!==null&&S!==void 0?S:v==null?void 0:v.name}))}return p},u)}}});var SW,FLe,OLe,Bk,jLe,zLe,$m,_Le,TW,BLe,$Le,WLe,RLe,ULe,VLe,HLe,qLe,GLe,YLe,KLe,JLe,XLe,QLe,bre,ZLe,eNe,xre,CW,PW,tNe,rNe,nNe,ws,DW,wre,EW,LI,Vd,NI,MI,kre,oNe,Sre,Tre,aNe,Cre,Hd=L(()=>{Pa();Kl();Co();Ka();Zg();rb();nr();eI();_k();yW();sre();bW();CI();xW();Nd();Rl();wW();EI();II();kW();A$();iI();Nk();L$();cI();SW=ie([Do,zt,z$,tb,fo],nW),FLe=ie([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),OLe=ie([fo,zm],_$),Bk=ie([FLe,Do,OLe],B$),jLe=ie([Bk],e=>e.filter(rh)),zLe=ie([Bk],W$),$m=ie([zLe,zc],R$),_Le=ie([jLe,zc,Do],lI),TW=ie([$m,Do,Bk],V$),BLe=ie([Do],pI),$Le=ie([Bk],e=>e.filter(rh)),WLe=ie([_Le,$Le,eb],H$),RLe=ie([WLe,zc,fo],q$),ULe=ie([Bk],$$),VLe=ie([$m,Do,ULe,Ok,fo],G$),HLe=ie([Y$,fo,zm],ah),qLe=ie([HLe,fo],X$),GLe=ie([K$,fo,zm],ah),YLe=ie([GLe,fo],Q$),KLe=ie([J$,fo,zm],ah),JLe=ie([KLe,fo],Z$),XLe=ie([qLe,JLe,YLe],Mk),QLe=ie([Do,BLe,RLe,VLe,XLe,zt,fo],eW),bre=ie([Do,zt,$m,TW,eb,fo,QLe],tW),ZLe=ie([bre,Do,SW],oW),eNe=ie([Do,bre,ZLe,fo],iW),xre=e=>{var t=fo(e),r=zm(e),n=!1;return ob(e,t,r,n)},CW=ie([Do,xre],th),PW=ie([Do,SW,eNe,CW],mI),tNe=ie([zt,TW,Do,fo],dW),rNe=ie([zt,TW,Do,fo],pW),nNe=(e,t,r,n,o,a,i,s)=>{if(t){var{type:l}=t,c=hs(e,s);if(n){var d=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,u=l==="category"&&n.bandwidth?n.bandwidth()/d:0;return u=s==="angleAxis"&&o!=null&&(o==null?void 0:o.length)>=2?To(o[0]-o[1])*2*u:u,c&&i?i.map((p,m)=>({coordinate:n(p)+u,value:p,index:m,offset:u})):n.domain().map((p,m)=>({coordinate:n(p)+u,value:a?a[p]:p,index:m,offset:u}))}}},ws=ie([zt,Do,SW,PW,xre,tNe,rNe,fo],nNe),DW=ie([gW,hW,ire],(e,t,r)=>vW(r.shared,e,t)),wre=e=>e.tooltip.settings.trigger,EW=e=>e.tooltip.settings.defaultIndex,LI=ie([rp,DW,wre,EW],TI),Vd=ie([LI,$m],ab),NI=ie([ws,Vd],vI),MI=ie([LI],e=>{if(e)return e.dataKey}),kre=ie([rp,DW,wre,EW],DI),oNe=ie([hi,vi,zt,on,ws,EW,kre,Bm],PI),Sre=ie([LI,oNe],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),Tre=ie([LI],e=>e.active),aNe=ie([kre,Vd,zc,sI,NI,Bm,DW],AI),Cre=ie([aNe],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}})});function Pre(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Dre(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Pre(Object(r),!0).forEach(function(n){iNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pre(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iNe(e,t,r){return(t=sNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sNe(e){var t=lNe(e,"string");return typeof t=="symbol"?t:t+""}function lNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cNe,Ere,Ire=L(()=>{Or();Ka();Hd();Nk();cNe=()=>Oe(Do),Ere=()=>{var e=cNe(),t=Oe(ws),r=Oe(PW);return Mc(Dre(Dre({},e),{},{scale:r}),t)}});var Are,FI,IW,Lre,AW,Nre,LW,Mre,Fre,Ore,$k,jre,NW,zre,_re,Bre,ih=L(()=>{Pa();Are=q(J0());Or();Ka();Zg();Hd();rb();Co();Rl();Nd();yW();bW();CI();xW();wW();EI();II();kW();Nk();FI=()=>Oe(tb),IW=(e,t)=>t,Lre=(e,t,r)=>r,AW=(e,t,r,n)=>n,Nre=ie(ws,e=>(0,Are.default)(e,t=>t.coordinate)),LW=ie([rp,IW,Lre,AW],TI),Mre=ie([LW,$m],ab),Fre=(e,t,r)=>{if(t!=null){var n=rp(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},Ore=ie([rp,IW,Lre,AW],DI),$k=ie([hi,vi,zt,on,ws,AW,Ore,Bm],PI),jre=ie([LW,$k],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),NW=ie(ws,Mre,vI),zre=ie([Ore,Mre,zc,sI,NW,Bm,IW],AI),_re=ie([LW],e=>({isActive:e.active,activeIndex:e.index})),Bre=(e,t,r,n,o,a,i,s)=>{if(!(!e||!t||!n||!o||!a)){var l=_X(e.chartX,e.chartY,t,r,s);if(l){var c=$X(l,t),d=LX(c,i,a,n,o),u=BX(t,a,d,l);return{activeIndex:String(d),activeCoordinate:u}}}}});function MW(){return MW=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},MW.apply(null,arguments)}function $re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function OI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$re(Object(r),!0).forEach(function(n){dNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$re(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dNe(e,t,r){return(t=uNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uNe(e){var t=pNe(e,"string");return typeof t=="symbol"?t:t+""}function pNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mNe(e){var{coordinate:t,payload:r,index:n,offset:o,tooltipAxisBandSize:a,layout:i,cursor:s,tooltipEventType:l,chartName:c}=e,d=t,u=r,p=n;if(!s||!d||c!=="ScatterChart"&&l!=="axis")return null;var m,f;if(c==="ScatterChart")m=d,f=yQ;else if(c==="BarChart")m=xQ(i,d,o,a),f=tE;else if(i==="radial"){var{cx:g,cy:v,radius:h,startAngle:y,endAngle:b}=rE(d);m={cx:g,cy:v,startAngle:y,endAngle:b,innerRadius:h,outerRadius:h},f=oE}else m={points:XQ(i,d,o)},f=Am;var x=typeof s=="object"&&"className"in s?s.className:void 0,w=OI(OI(OI(OI({stroke:"#ccc",pointerEvents:"none"},o),m),Wt(s,!1)),{},{payload:u,payloadIndex:p,className:mt("recharts-tooltip-cursor",x)});return(0,ib.isValidElement)(s)?(0,ib.cloneElement)(s,w):(0,ib.createElement)(f,w)}function Rre(e){var t=Ere(),r=WD(),n=Md(),o=FI();return Wre.createElement(mNe,MW({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:n,tooltipAxisBandSize:t,chartName:o}))}var Wre,ib,Ure=L(()=>{Wre=q(Y()),ib=q(Y());Nn();GD();bQ();wQ();sB();lB();dB();QQ();Ta();Co();Ire();ih()});var jI,FW,Vre,OW=L(()=>{jI=q(Y()),FW=(0,jI.createContext)(null),Vre=()=>(0,jI.useContext)(FW)});var qre=Ie((Glt,jW)=>{"use strict";var fNe=Object.prototype.hasOwnProperty,qi="~";function Wk(){}Object.create&&(Wk.prototype=Object.create(null),new Wk().__proto__||(qi=!1));function gNe(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function Hre(e,t,r,n,o){if(typeof r!="function")throw new TypeError("The listener must be a function");var a=new gNe(r,n||e,o),i=qi?qi+t:t;return e._events[i]?e._events[i].fn?e._events[i]=[e._events[i],a]:e._events[i].push(a):(e._events[i]=a,e._eventsCount++),e}function zI(e,t){--e._eventsCount===0?e._events=new Wk:delete e._events[t]}function bi(){this._events=new Wk,this._eventsCount=0}bi.prototype.eventNames=function(){var t=[],r,n;if(this._eventsCount===0)return t;for(n in r=this._events)fNe.call(r,n)&&t.push(qi?n.slice(1):n);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(r)):t};bi.prototype.listeners=function(t){var r=qi?qi+t:t,n=this._events[r];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,a=n.length,i=new Array(a);o<a;o++)i[o]=n[o].fn;return i};bi.prototype.listenerCount=function(t){var r=qi?qi+t:t,n=this._events[r];return n?n.fn?1:n.length:0};bi.prototype.emit=function(t,r,n,o,a,i){var s=qi?qi+t:t;if(!this._events[s])return!1;var l=this._events[s],c=arguments.length,d,u;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),c){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,r),!0;case 3:return l.fn.call(l.context,r,n),!0;case 4:return l.fn.call(l.context,r,n,o),!0;case 5:return l.fn.call(l.context,r,n,o,a),!0;case 6:return l.fn.call(l.context,r,n,o,a,i),!0}for(u=1,d=new Array(c-1);u<c;u++)d[u-1]=arguments[u];l.fn.apply(l.context,d)}else{var p=l.length,m;for(u=0;u<p;u++)switch(l[u].once&&this.removeListener(t,l[u].fn,void 0,!0),c){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,r);break;case 3:l[u].fn.call(l[u].context,r,n);break;case 4:l[u].fn.call(l[u].context,r,n,o);break;default:if(!d)for(m=1,d=new Array(c-1);m<c;m++)d[m-1]=arguments[m];l[u].fn.apply(l[u].context,d)}}return!0};bi.prototype.on=function(t,r,n){return Hre(this,t,r,n,!1)};bi.prototype.once=function(t,r,n){return Hre(this,t,r,n,!0)};bi.prototype.removeListener=function(t,r,n,o){var a=qi?qi+t:t;if(!this._events[a])return this;if(!r)return zI(this,a),this;var i=this._events[a];if(i.fn)i.fn===r&&(!o||i.once)&&(!n||i.context===n)&&zI(this,a);else{for(var s=0,l=[],c=i.length;s<c;s++)(i[s].fn!==r||o&&!i[s].once||n&&i[s].context!==n)&&l.push(i[s]);l.length?this._events[a]=l.length===1?l[0]:l:zI(this,a)}return this};bi.prototype.removeAllListeners=function(t){var r;return t?(r=qi?qi+t:t,this._events[r]&&zI(this,r)):(this._events=new Wk,this._eventsCount=0),this};bi.prototype.off=bi.prototype.removeListener;bi.prototype.addListener=bi.prototype.on;bi.prefixed=qi;bi.EventEmitter=bi;typeof jW!="undefined"&&(jW.exports=bi)});var Gre,Yre,Kre=L(()=>{Gre=q(qre(),1),Yre=Gre.default});var sb,_I,zW,Jre=L(()=>{Kre();sb=new Yre,_I="recharts.syncEvent.tooltip",zW="recharts.syncEvent.brush"});function Wm(e,t){if(t){var r=Number.parseInt(t,10);if(!Mn(r))return e==null?void 0:e[r]}}var hNe,Xre,Qre,Zre,sh=L(()=>{oa();nr();hNe={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},Xre=hn({name:"options",initialState:hNe,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),Qre=Xre.reducer,{createEventEmitter:Zre}=Xre.actions});function ene(e){return e.tooltip.syncInteraction}var tne=L(()=>{});var vNe,rne,_W,nne,yNe,one,BI=L(()=>{oa();vNe={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},rne=hn({name:"chartData",initialState:vNe,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:_W,setDataStartEndIndexes:nne,setComputedData:yNe}=rne.actions,one=rne.reducer});function ane(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function lh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ane(Object(r),!0).forEach(function(n){xNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ane(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xNe(e,t,r){return(t=wNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wNe(e){var t=kNe(e,"string");return typeof t=="symbol"?t:t+""}function kNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function SNe(e,t){if(e==null)return{};var r,n,o=TNe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function TNe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function CNe(){var e=Oe(QE),t=Oe(ZE),r=or(),n=Oe(P$),o=Oe(ws),a=Md(),i=Dm(),s=Oe(l=>l.rootProps.className);(0,Rk.useEffect)(()=>{if(e==null)return ine;var l=(c,d,u)=>{if(t!==u&&e===c){if(n==="index"){var p;if(i&&d!==null&&d!==void 0&&(p=d.payload)!==null&&p!==void 0&&p.coordinate){var m=d.payload.coordinate,{x:f,y:g}=m,v=SNe(m,bNe),h=lh(lh(lh({},v),typeof f=="number"&&{x:Math.max(i.x,Math.min(f,i.x+i.width))}),typeof g=="number"&&{y:Math.max(i.y,Math.min(g,i.y+i.height))}),y=lh(lh({},d),{},{payload:lh(lh({},d.payload),{},{coordinate:h})});r(y)}else r(d);return}if(o!=null){var b;if(typeof n=="function"){var x={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},w=n(o,x);b=o[w]}else n==="value"&&(b=o.find(I=>String(I.value)===d.payload.label));var{coordinate:S}=d.payload;if(b==null||d.payload.active===!1||S==null||i==null){r(wI({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:k,y:T}=S,P=Math.min(k,i.x+i.width),D=Math.min(T,i.y+i.height),O={x:a==="horizontal"?b.coordinate:P,y:a==="horizontal"?D:b.coordinate},z=wI({active:d.payload.active,coordinate:O,dataKey:d.payload.dataKey,index:String(b.index),label:d.payload.label});r(z)}}};return sb.on(_I,l),()=>{sb.off(_I,l)}},[s,r,t,e,n,o,a,i])}function PNe(){var e=Oe(QE),t=Oe(ZE),r=or();(0,Rk.useEffect)(()=>{if(e==null)return ine;var n=(o,a,i)=>{t!==i&&e===o&&r(nne(a))};return sb.on(zW,n),()=>{sb.off(zW,n)}},[r,t,e])}function sne(){var e=or();(0,Rk.useEffect)(()=>{e(Zre())},[e]),CNe(),PNe()}function lne(e,t,r,n,o,a){var i=Oe(p=>Fre(p,e,t)),s=Oe(ZE),l=Oe(QE),c=Oe(P$),d=Oe(ene),u=d==null?void 0:d.active;(0,Rk.useEffect)(()=>{if(!u&&l!=null&&s!=null){var p=wI({active:a,coordinate:r,dataKey:i,index:o,label:typeof n=="number"?String(n):n});sb.emit(_I,l,p,s)}},[u,r,i,o,n,s,l,c,a])}var Rk,bNe,ine,BW=L(()=>{Rk=q(Y());Or();rb();Jre();sh();Wc();ih();Hd();tne();Co();BI();bNe=["x","y"];ine=()=>{}});function cne(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function dne(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cne(Object(r),!0).forEach(function(n){DNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cne(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DNe(e,t,r){return(t=ENe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ENe(e){var t=INe(e,"string");return typeof t=="symbol"?t:t+""}function INe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ANe(e){return e.dataKey}function LNe(e,t){return Jl.isValidElement(e)?Jl.cloneElement(e,t):typeof e=="function"?Jl.createElement(e,t):Jl.createElement(nQ,t)}function ia(e){var t=On(e,NNe),{active:r,allowEscapeViewBox:n,animationDuration:o,animationEasing:a,content:i,filterNull:s,isAnimationActive:l,offset:c,payloadUniqBy:d,position:u,reverseDirection:p,useTranslate3d:m,wrapperStyle:f,cursor:g,shared:v,trigger:h,defaultIndex:y,portal:b,axisId:x}=t,w=or(),S=typeof y=="number"?String(y):y;(0,pne.useEffect)(()=>{w(ure({shared:v,trigger:h,axisId:x,active:r,defaultIndex:S}))},[w,v,h,x,r,S]);var k=Dm(),T=HD(),P=are(v),{activeIndex:D,isActive:O}=Oe(H=>_re(H,P,h,S)),z=Oe(H=>zre(H,P,h,S)),I=Oe(H=>NW(H,P,h,S)),A=Oe(H=>jre(H,P,h,S)),j=z,E=Vre(),N=r!=null?r:O,[B,C]=mD([j,N]),F=P==="axis"?I:void 0;lne(P,h,A,F,D,N);var M=b!=null?b:E;if(M==null)return null;var _=j!=null?j:une;N||(_=une),s&&_.length&&(_=sD(j.filter(H=>H.value!=null&&(H.hide!==!0||t.includeHidden)),d,ANe));var W=_.length>0,$=Jl.createElement(VD,{allowEscapeViewBox:n,animationDuration:o,animationEasing:a,isAnimationActive:l,active:N,coordinate:A,hasPayload:W,offset:c,position:u,reverseDirection:p,useTranslate3d:m,viewBox:k,wrapperStyle:f,lastBoundingBox:B,innerRef:C,hasPortalFromProps:!!b},LNe(i,dne(dne({},t),{},{payload:_,label:F,active:N,coordinate:A,accessibilityLayer:T})));return Jl.createElement(Jl.Fragment,null,(0,mne.createPortal)($,M),N&&Jl.createElement(Rre,{cursor:g,tooltipEventType:P,coordinate:A,payload:j,index:D}))}var Jl,pne,mne,une,NNe,fne=L(()=>{Jl=q(Y()),pne=q(Y()),mne=q(vc());oQ();uQ();Im();l_();Co();eB();S_();Ure();ih();OW();Or();Wc();BW();_k();Vl();une=[],NNe={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!vs.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}}});var MNe,$W,gne=L(()=>{MNe=!1,$W=function(t,r){for(var n=arguments.length,o=new Array(n>2?n-2:0),a=2;a<n;a++)o[a-2]=arguments[a];if(MNe&&typeof console!="undefined"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!t))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var i=0;console.warn(r.replace(/%s/g,()=>o[i++]))}}});var WW,hne=L(()=>{WW=e=>null;WW.displayName="Cell"});function FNe(e,t,r){return(t=ONe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ONe(e){var t=jNe(e,"string");return typeof t=="symbol"?t:t+""}function jNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $I,vne=L(()=>{$I=class{constructor(t){FNe(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}});function yne(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function zNe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yne(Object(r),!0).forEach(function(n){_Ne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yne(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _Ne(e,t,r){return(t=BNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BNe(e){var t=$Ne(e,"string");return typeof t=="symbol"?t:t+""}function $Ne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function UNe(e,t){var r=t.fontSize||"",n=t.fontFamily||"",o=t.fontWeight||"",a=t.fontStyle||"",i=t.letterSpacing||"",s=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(o,"|").concat(a,"|").concat(i,"|").concat(s)}var WNe,kne,bne,RNe,xne,wne,ch,RW=L(()=>{Im();vne();WNe={cacheSize:2e3,enableCache:!0},kne=zNe({},WNe),bne=new $I(kne.cacheSize),RNe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},xne="recharts_measurement_span";wne=(e,t)=>{try{var r=document.getElementById(xne);r||(r=document.createElement("span"),r.setAttribute("id",xne),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,RNe,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch(o){return{width:0,height:0}}},ch=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||vs.isSsr)return{width:0,height:0};if(!kne.enableCache)return wne(t,r);var n=UNe(t,r),o=bne.get(n);if(o)return o;var a=wne(t,r);return bne.set(n,a),a}});function GNe(e,t){return e*Pne[t]}function Dne(e){if(e.includes(lb))return lb;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,o,a]=(r=Sne.exec(t))!==null&&r!==void 0?r:[],i=cb.parse(n!=null?n:""),s=cb.parse(a!=null?a:""),l=o==="*"?i.multiply(s):i.divide(s);if(l.isNaN())return lb;t=t.replace(Sne,l.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var c,[,d,u,p]=(c=Tne.exec(t))!==null&&c!==void 0?c:[],m=cb.parse(d!=null?d:""),f=cb.parse(p!=null?p:""),g=u==="+"?m.add(f):m.subtract(f);if(g.isNaN())return lb;t=t.replace(Tne,g.toString())}return t}function YNe(e){for(var t=e,r;(r=Cne.exec(t))!=null;){var[,n]=r;t=t.replace(Cne,Dne(n))}return t}function KNe(e){var t=e.replace(/\s+/g,"");return t=YNe(t),t=Dne(t),t}function JNe(e){try{return KNe(e)}catch(t){return lb}}function WI(e){var t=JNe(e.slice(5,-1));return t===lb?"":t}var Sne,Tne,VNe,HNe,Pne,qNe,lb,cb,Cne,Ene=L(()=>{nr();Sne=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Tne=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,VNe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,HNe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,Pne={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},qNe=Object.keys(Pne),lb="NaN";cb=class e{static parse(t){var r,[,n,o]=(r=HNe.exec(t))!==null&&r!==void 0?r:[];return new e(parseFloat(n),o!=null?o:"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,Mn(t)&&(this.unit=""),r!==""&&!VNe.test(r)&&(this.num=NaN,this.unit=""),qNe.includes(r)&&(this.num=GNe(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new e(NaN,""):new e(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new e(NaN,""):new e(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Mn(this.num)}};Cne=/\(([^()]*)\)/});function UW(){return UW=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},UW.apply(null,arguments)}function Ine(e,t){if(e==null)return{};var r,n,o=ZNe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function ZNe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var VW,RI,XNe,QNe,Nne,Mne,eMe,Ane,tMe,Lne,Uk,HW=L(()=>{VW=q(Y()),RI=q(Y());Nn();nr();Im();Ta();RW();Ene();XNe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],QNe=["dx","dy","angle","className","breakAll"];Nne=/[ \f\n\r\t\v\u2028\u2029]+/,Mne=e=>{var{children:t,breakAll:r,style:n}=e;try{var o=[];cr(t)||(r?o=t.toString().split(""):o=t.toString().split(Nne));var a=o.map(s=>({word:s,width:ch(s,n).width})),i=r?0:ch("\xA0",n).width;return{wordsWithComputedWidth:a,spaceWidth:i}}catch(s){return null}},eMe=(e,t,r,n,o)=>{var{maxLines:a,children:i,style:s,breakAll:l}=e,c=Re(a),d=i,u=function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return O.reduce((z,I)=>{var{word:A,width:j}=I,E=z[z.length-1];if(E&&(n==null||o||E.width+j+r<Number(n)))E.words.push(A),E.width+=j+r;else{var N={words:[A],width:j};z.push(N)}return z},[])},p=u(t),m=D=>D.reduce((O,z)=>O.width>z.width?O:z);if(!c||o)return p;var f=p.length>a||m(p).width>Number(n);if(!f)return p;for(var g="\u2026",v=D=>{var O=d.slice(0,D),z=Mne({breakAll:l,style:s,children:O+g}).wordsWithComputedWidth,I=u(z),A=I.length>a||m(I).width>Number(n);return[A,I]},h=0,y=d.length-1,b=0,x;h<=y&&b<=d.length-1;){var w=Math.floor((h+y)/2),S=w-1,[k,T]=v(S),[P]=v(w);if(!k&&!P&&(h=w+1),k&&P&&(y=w-1),!k&&P){x=T;break}b++}return x||p},Ane=e=>{var t=cr(e)?[]:e.toString().split(Nne);return[{words:t}]},tMe=e=>{var{width:t,scaleToFit:r,children:n,style:o,breakAll:a,maxLines:i}=e;if((t||r)&&!vs.isSsr){var s,l,c=Mne({breakAll:a,children:n,style:o});if(c){var{wordsWithComputedWidth:d,spaceWidth:u}=c;s=d,l=u}else return Ane(n);return eMe({breakAll:a,children:n,maxLines:i,style:o},s,l,t,r)}return Ane(n)},Lne="#808080",Uk=(0,RI.forwardRef)((e,t)=>{var{x:r=0,y:n=0,lineHeight:o="1em",capHeight:a="0.71em",scaleToFit:i=!1,textAnchor:s="start",verticalAnchor:l="end",fill:c=Lne}=e,d=Ine(e,XNe),u=(0,RI.useMemo)(()=>tMe({breakAll:d.breakAll,children:d.children,maxLines:d.maxLines,scaleToFit:i,style:d.style,width:d.width}),[d.breakAll,d.children,d.maxLines,i,d.style,d.width]),{dx:p,dy:m,angle:f,className:g,breakAll:v}=d,h=Ine(d,QNe);if(!Sa(r)||!Sa(n)||u.length===0)return null;var y=r+(Re(p)?p:0),b=n+(Re(m)?m:0),x;switch(l){case"start":x=WI("calc(".concat(a,")"));break;case"middle":x=WI("calc(".concat((u.length-1)/2," * -").concat(o," + (").concat(a," / 2))"));break;default:x=WI("calc(".concat(u.length-1," * -").concat(o,")"));break}var w=[];if(i){var S=u[0].width,{width:k}=d;w.push("scale(".concat(Re(k)?k/S:1,")"))}return f&&w.push("rotate(".concat(f,", ").concat(y,", ").concat(b,")")),w.length&&(h.transform=w.join(" ")),VW.createElement("text",UW({},Wt(h,!0),{ref:t,x:y,y:b,className:mt("recharts-text",g),textAnchor:s,fill:c.includes("url")?Lne:c}),u.map((T,P)=>{var D=T.words.join(v?"":" ");return VW.createElement("tspan",{x:y,dy:P===0?x:o,key:"".concat(D,"-").concat(P)},D)}))});Uk.displayName="Text"});function nMe(e,t){if(e==null)return{};var r,n,o=oMe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function oMe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Fne(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Eo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Fne(Object(r),!0).forEach(function(n){aMe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fne(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function aMe(e,t,r){return(t=iMe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iMe(e){var t=sMe(e,"string");return typeof t=="symbol"?t:t+""}function sMe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function op(){return op=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},op.apply(null,arguments)}function np(e){var t=On(e,gMe),{viewBox:r,position:n,value:o,children:a,content:i,className:s="",textBreakAll:l,labelRef:c}=t,d=cMe(),u=jne(),p=n==="center"?u:d!=null?d:u,m=r||p;if(!m||cr(o)&&cr(a)&&!(0,Ea.isValidElement)(i)&&typeof i!="function")return null;var f=Eo(Eo({},t),{},{viewBox:m});if((0,Ea.isValidElement)(i)){var{labelRef:g}=f,v=nMe(f,rMe);return(0,Ea.cloneElement)(i,v)}var h;if(typeof i=="function"){if(h=(0,Ea.createElement)(i,f),(0,Ea.isValidElement)(h))return h}else h=dMe(t);var y=zne(m),b=Wt(t,!0);if(y&&(n==="insideStart"||n==="insideEnd"||n==="end"))return pMe(t,n,h,b,m);var x=y?mMe(m,t.offset,t.position):fMe(t,m);return Xl.createElement(Uk,op({ref:c,className:mt("recharts-label",s)},b,x,{breakAll:l}),h)}function VI(e){var{label:t}=e,r=jne();return hMe(t,r)||null}var Xl,Ea,rMe,One,UI,jne,lMe,cMe,dMe,Vk,uMe,pMe,mMe,zne,fMe,gMe,hMe,Hk=L(()=>{Xl=q(Y()),Ea=q(Y());Nn();HW();Ta();nr();Og();Co();Or();aI();Vl();rMe=["labelRef"];One=(0,Ea.createContext)(null),UI=e=>{var{x:t,y:r,width:n,height:o,children:a}=e,i=(0,Ea.useMemo)(()=>({x:t,y:r,width:n,height:o}),[t,r,n,o]);return Xl.createElement(One.Provider,{value:i},a)},jne=()=>{var e=(0,Ea.useContext)(One),t=Dm();return e||t},lMe=(0,Ea.createContext)(null),cMe=()=>{var e=(0,Ea.useContext)(lMe),t=Oe(oI);return e||t},dMe=e=>{var{value:t,formatter:r}=e,n=cr(e.children)?t:e.children;return typeof r=="function"?r(n):n},Vk=e=>e!=null&&typeof e=="function",uMe=(e,t)=>{var r=To(t-e),n=Math.min(Math.abs(t-e),360);return r*n},pMe=(e,t,r,n,o)=>{var{offset:a,className:i}=e,{cx:s,cy:l,innerRadius:c,outerRadius:d,startAngle:u,endAngle:p,clockWise:m}=o,f=(c+d)/2,g=uMe(u,p),v=g>=0?1:-1,h,y;switch(t){case"insideStart":h=u+v*a,y=m;break;case"insideEnd":h=p-v*a,y=!m;break;case"end":h=p+v*a,y=m;break;default:throw new Error("Unsupported position ".concat(t))}y=g<=0?y:!y;var b=mo(s,l,f,h),x=mo(s,l,f,h+(y?1:-1)*359),w="M".concat(b.x,",").concat(b.y,`
    A`).concat(f,",").concat(f,",0,1,").concat(y?0:1,`,
    `).concat(x.x,",").concat(x.y),S=cr(e.id)?Uu("recharts-radial-line-"):e.id;return Xl.createElement("text",op({},n,{dominantBaseline:"central",className:mt("recharts-radial-bar-label",i)}),Xl.createElement("defs",null,Xl.createElement("path",{id:S,d:w})),Xl.createElement("textPath",{xlinkHref:"#".concat(S)},r))},mMe=(e,t,r)=>{var{cx:n,cy:o,innerRadius:a,outerRadius:i,startAngle:s,endAngle:l}=e,c=(s+l)/2;if(r==="outside"){var{x:d,y:u}=mo(n,o,i+t,c);return{x:d,y:u,textAnchor:d>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:o,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:o,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:o,textAnchor:"middle",verticalAnchor:"end"};var p=(a+i)/2,{x:m,y:f}=mo(n,o,p,c);return{x:m,y:f,textAnchor:"middle",verticalAnchor:"middle"}},zne=e=>"cx"in e&&Re(e.cx),fMe=(e,t)=>{var{parentViewBox:r,offset:n,position:o}=e,a;r!=null&&!zne(r)&&(a=r);var{x:i,y:s,width:l,height:c}=t,d=c>=0?1:-1,u=d*n,p=d>0?"end":"start",m=d>0?"start":"end",f=l>=0?1:-1,g=f*n,v=f>0?"end":"start",h=f>0?"start":"end";if(o==="top"){var y={x:i+l/2,y:s-d*n,textAnchor:"middle",verticalAnchor:p};return Eo(Eo({},y),a?{height:Math.max(s-a.y,0),width:l}:{})}if(o==="bottom"){var b={x:i+l/2,y:s+c+u,textAnchor:"middle",verticalAnchor:m};return Eo(Eo({},b),a?{height:Math.max(a.y+a.height-(s+c),0),width:l}:{})}if(o==="left"){var x={x:i-g,y:s+c/2,textAnchor:v,verticalAnchor:"middle"};return Eo(Eo({},x),a?{width:Math.max(x.x-a.x,0),height:c}:{})}if(o==="right"){var w={x:i+l+g,y:s+c/2,textAnchor:h,verticalAnchor:"middle"};return Eo(Eo({},w),a?{width:Math.max(a.x+a.width-w.x,0),height:c}:{})}var S=a?{width:l,height:c}:{};return o==="insideLeft"?Eo({x:i+g,y:s+c/2,textAnchor:h,verticalAnchor:"middle"},S):o==="insideRight"?Eo({x:i+l-g,y:s+c/2,textAnchor:v,verticalAnchor:"middle"},S):o==="insideTop"?Eo({x:i+l/2,y:s+u,textAnchor:"middle",verticalAnchor:m},S):o==="insideBottom"?Eo({x:i+l/2,y:s+c-u,textAnchor:"middle",verticalAnchor:p},S):o==="insideTopLeft"?Eo({x:i+g,y:s+u,textAnchor:h,verticalAnchor:m},S):o==="insideTopRight"?Eo({x:i+l-g,y:s+u,textAnchor:v,verticalAnchor:m},S):o==="insideBottomLeft"?Eo({x:i+g,y:s+c-u,textAnchor:h,verticalAnchor:p},S):o==="insideBottomRight"?Eo({x:i+l-g,y:s+c-u,textAnchor:v,verticalAnchor:p},S):o&&typeof o=="object"&&(Re(o.x)||BP(o.x))&&(Re(o.y)||BP(o.y))?Eo({x:i+gi(o.x,l),y:s+gi(o.y,c),textAnchor:"end",verticalAnchor:"end"},S):Eo({x:i+l/2,y:s+c/2,textAnchor:"middle",verticalAnchor:"middle"},S)},gMe={offset:5};np.displayName="Label";hMe=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?Xl.createElement(np,op({key:"label-implicit"},n)):Sa(e)?Xl.createElement(np,op({key:"label-implicit",value:e},n)):(0,Ea.isValidElement)(e)?e.type===np?(0,Ea.cloneElement)(e,Eo({key:"label-implicit"},n)):Xl.createElement(np,op({key:"label-implicit",content:e},n)):Vk(e)?Xl.createElement(np,op({key:"label-implicit",content:e},n)):e&&typeof e=="object"?Xl.createElement(np,op({},e,{key:"label-implicit"},n)):null}});var _ne=Ie(qW=>{"use strict";Object.defineProperty(qW,Symbol.toStringTag,{value:"Module"});function vMe(e){return e[e.length-1]}qW.last=vMe});var Bne=Ie(GW=>{"use strict";Object.defineProperty(GW,Symbol.toStringTag,{value:"Module"});function yMe(e){return Array.isArray(e)?e:Array.from(e)}GW.toArray=yMe});var $ne=Ie(YW=>{"use strict";Object.defineProperty(YW,Symbol.toStringTag,{value:"Module"});var bMe=_ne(),xMe=Bne(),wMe=nD();function kMe(e){if(wMe.isArrayLike(e))return bMe.last(xMe.toArray(e))}YW.last=kMe});var Rne=Ie((odt,Wne)=>{Wne.exports=$ne().last});function qI(){return qI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qI.apply(null,arguments)}function Une(e,t){if(e==null)return{};var r,n,o=CMe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function CMe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function DMe(){return(0,db.useContext)(Hne)}function EMe(){return(0,db.useContext)(qne)}function HI(e){var{valueAccessor:t=PMe}=e,r=Une(e,SMe),{dataKey:n,clockWise:o,id:a,textBreakAll:i}=r,s=Une(r,TMe),l=DMe(),c=EMe(),d=l||c;return!d||!d.length?null:Rm.createElement(Sn,{className:"recharts-label-list"},d.map((u,p)=>{var m,f=cr(n)?t(u,p):nn(u&&u.payload,n),g=cr(a)?{}:{id:"".concat(a,"-").concat(p)};return Rm.createElement(np,qI({},Wt(u,!0),s,g,{fill:(m=r.fill)!==null&&m!==void 0?m:u.fill,parentViewBox:u.parentViewBox,value:f,textBreakAll:i,viewBox:u.viewBox,key:"label-".concat(p),index:p}))}))}function pb(e){var{label:t}=e;return t?t===!0?Rm.createElement(HI,{key:"labelList-implicit"}):Rm.isValidElement(t)||Vk(t)?Rm.createElement(HI,{key:"labelList-implicit",content:t}):typeof t=="object"?Rm.createElement(HI,qI({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}var Rm,db,Vne,SMe,TMe,PMe,Hne,ub,qne,ddt,GI=L(()=>{Rm=q(Y()),db=q(Y()),Vne=q(Rne());Hk();Vu();Ta();Ka();nr();SMe=["valueAccessor"],TMe=["dataKey","clockWise","id","textBreakAll"];PMe=e=>Array.isArray(e.value)?(0,Vne.default)(e.value):e.value,Hne=(0,db.createContext)(void 0),ub=Hne.Provider,qne=(0,db.createContext)(void 0),ddt=qne.Provider;HI.displayName="LabelList"});function KW(){return KW=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},KW.apply(null,arguments)}var Gne,mb,YI=L(()=>{Gne=q(Y());Nn();Tm();Ld();mb=e=>{var{cx:t,cy:r,r:n,className:o}=e,a=mt("recharts-dot",o);return t===+t&&r===+r&&n===+n?Gne.createElement("circle",KW({},Ga(e),ly(e),{className:a,cx:t,cy:r,r:n})):null}});var IMe,Yne,vdt,ydt,bdt,xdt,Kne,Jne=L(()=>{oa();IMe={radiusAxis:{},angleAxis:{}},Yne=hn({name:"polarAxis",initialState:IMe,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:vdt,removeRadiusAxis:ydt,addAngleAxis:bdt,removeAngleAxis:xdt}=Yne.actions,Kne=Yne.reducer});var Xne=Ie(JW=>{"use strict";Object.defineProperty(JW,Symbol.toStringTag,{value:"Module"});function AMe(e){var r;if(typeof e!="object"||e==null)return!1;if(Object.getPrototypeOf(e)===null)return!0;if(Object.prototype.toString.call(e)!=="[object Object]"){let n=e[Symbol.toStringTag];return n==null||!((r=Object.getOwnPropertyDescriptor(e,Symbol.toStringTag))!=null&&r.writable)?!1:e.toString()===`[object ${n}]`}let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}JW.isPlainObject=AMe});var Zne=Ie((Sdt,Qne)=>{Qne.exports=Xne().isPlainObject});function eoe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function toe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eoe(Object(r),!0).forEach(function(n){LMe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eoe(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LMe(e,t,r){return(t=NMe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NMe(e){var t=MMe(e,"string");return typeof t=="symbol"?t:t+""}function MMe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function KI(){return KI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},KI.apply(null,arguments)}var qk,Rc,roe,FMe,noe,ooe=L(()=>{qk=q(Y()),Rc=q(Y());Nn();Ta();Vl();zy();_y();nr();KD();roe=(e,t,r,n,o)=>{var a=r-n,i;return i="M ".concat(e,",").concat(t),i+="L ".concat(e+r,",").concat(t),i+="L ".concat(e+r-a/2,",").concat(t+o),i+="L ".concat(e+r-a/2-n,",").concat(t+o),i+="L ".concat(e,",").concat(t," Z"),i},FMe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},noe=e=>{var t=On(e,FMe),{x:r,y:n,upperWidth:o,lowerWidth:a,height:i,className:s}=t,{animationEasing:l,animationDuration:c,animationBegin:d,isUpdateAnimationActive:u}=t,p=(0,Rc.useRef)(),[m,f]=(0,Rc.useState)(-1),g=(0,Rc.useRef)(o),v=(0,Rc.useRef)(a),h=(0,Rc.useRef)(i),y=(0,Rc.useRef)(r),b=(0,Rc.useRef)(n),x=jd(e,"trapezoid-");if((0,Rc.useEffect)(()=>{if(p.current&&p.current.getTotalLength)try{var A=p.current.getTotalLength();A&&f(A)}catch(j){}},[]),r!==+r||n!==+n||o!==+o||a!==+a||i!==+i||o===0&&a===0||i===0)return null;var w=mt("recharts-trapezoid",s);if(!u)return qk.createElement("g",null,qk.createElement("path",KI({},Wt(t,!0),{className:w,d:roe(r,n,o,a,i)})));var S=g.current,k=v.current,T=h.current,P=y.current,D=b.current,O="0px ".concat(m===-1?1:m,"px"),z="".concat(m,"px 0px"),I=YD(["strokeDasharray"],c,l);return qk.createElement(Od,{animationId:x,key:x,canBegin:m>0,duration:c,easing:l,isActive:u,begin:d},A=>{var j=Fr(S,o,A),E=Fr(k,a,A),N=Fr(T,i,A),B=Fr(P,r,A),C=Fr(D,n,A);p.current&&(g.current=j,v.current=E,h.current=N,y.current=B,b.current=C);var F=A>0?{transition:I,strokeDasharray:z}:{strokeDasharray:O};return qk.createElement("path",KI({},Wt(t,!0),{className:w,d:roe(B,C,j,E,N),ref:p,style:toe(toe({},F),t.style)}))})}});function jMe(e,t){if(e==null)return{};var r,n,o=zMe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function zMe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function aoe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function JI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aoe(Object(r),!0).forEach(function(n){_Me(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aoe(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _Me(e,t,r){return(t=BMe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BMe(e){var t=$Me(e,"string");return typeof t=="symbol"?t:t+""}function $Me(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function WMe(e,t){return JI(JI({},t),e)}function RMe(e,t){return e==="symbols"}function ioe(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return Um.createElement(tE,r);case"trapezoid":return Um.createElement(noe,r);case"sector":return Um.createElement(oE,r);case"symbols":if(RMe(t,r))return Um.createElement(G0,r);break;default:return null}}function UMe(e){return(0,Gk.isValidElement)(e)?e.props:e}function loe(e){var{option:t,shapeType:r,propTransformer:n=WMe,activeClassName:o="recharts-active-shape",isActive:a}=e,i=jMe(e,OMe),s;if((0,Gk.isValidElement)(t))s=(0,Gk.cloneElement)(t,JI(JI({},i),UMe(t)));else if(typeof t=="function")s=t(i);else if((0,soe.default)(t)&&typeof t!="boolean"){var l=n(t,i);s=Um.createElement(ioe,{shapeType:r,elementProps:l})}else{var c=i;s=Um.createElement(ioe,{shapeType:r,elementProps:c})}return a?Um.createElement(Sn,{className:o},s):s}var Um,Gk,soe,OMe,coe=L(()=>{Um=q(Y()),Gk=q(Y()),soe=q(Zne());sB();ooe();dB();Vu();Tz();OMe=["option","shapeType","propTransformer","activeClassName","isActive"]});var XW,QW,ZW,doe=L(()=>{Or();Wc();XW=(e,t)=>{var r=or();return(n,o)=>a=>{e==null||e(n,o,a),r(yI({activeIndex:String(o),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}},QW=e=>{var t=or();return(r,n)=>o=>{e==null||e(r,n,o),t(pre())}},ZW=(e,t)=>{var r=or();return(n,o)=>a=>{e==null||e(n,o,a),r(mre({activeIndex:String(o),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}}});function fb(e){var{fn:t,args:r}=e,n=or(),o=jr();return(0,uoe.useEffect)(()=>{if(!o){var a=t(r);return n(cre(a)),()=>{n(dre(a))}}},[t,r,n,o]),null}var uoe,XI=L(()=>{uoe=q(Y());Or();Wc();Wi()});function gb(e){var{legendPayload:t}=e,r=or(),n=jr();return(0,poe.useEffect)(()=>n?VMe:(r(KX(t)),()=>{r(JX(t))}),[r,n,t]),null}var poe,VMe,QI=L(()=>{poe=q(Y());Wi();Or();RD();VMe=()=>{}});var ZI,e5,HMe,moe,foe=L(()=>{ZI=q(Y());nr();HMe=()=>{var[e]=ZI.useState(()=>Uu("uid-"));return e},moe=(e5=ZI.useId)!==null&&e5!==void 0?e5:HMe});function goe(e,t){var r=moe();return t||(e?"".concat(e,"-").concat(r):r)}var hoe=L(()=>{foe()});var voe,t5,qMe,hb,eA=L(()=>{voe=q(Y()),t5=q(Y());hoe();qMe=(0,t5.createContext)(void 0),hb=e=>{var{id:t,type:r,children:n}=e,o=goe("recharts-".concat(r),t);return voe.createElement(qMe.Provider,{value:o},n(o))}});var GMe,yoe,boe,xoe,woe,YMe,KMe,koe,r5=L(()=>{oa();GMe={cartesianItems:[],polarItems:[]},yoe=hn({name:"graphicalItems",initialState:GMe,reducers:{addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},replaceCartesianGraphicalItem(e,t){var{prev:r,next:n}=t.payload,o=gs(e).cartesianItems.indexOf(r);o>-1&&(e.cartesianItems[o]=n)},removeCartesianGraphicalItem(e,t){var r=gs(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var r=gs(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)}}}),{addCartesianGraphicalItem:boe,replaceCartesianGraphicalItem:xoe,removeCartesianGraphicalItem:woe,addPolarGraphicalItem:YMe,removePolarGraphicalItem:KMe}=yoe.actions,koe=yoe.reducer});function vb(e){var t=or(),r=(0,Yk.useRef)(null);return(0,Yk.useEffect)(()=>{r.current===null?t(boe(e)):r.current!==e&&t(xoe({prev:r.current,next:e})),r.current=e},[t,e]),(0,Yk.useEffect)(()=>()=>{r.current&&(t(woe(r.current)),r.current=null)},[t]),null}var Yk,tA=L(()=>{Yk=q(Y());Or();r5()});function Soe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Toe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Soe(Object(r),!0).forEach(function(n){JMe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Soe(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function JMe(e,t,r){return(t=XMe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XMe(e){var t=QMe(e,"string");return typeof t=="symbol"?t:t+""}function QMe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ZMe,Coe,Poe,Doe,Eoe,Ioe,sut,lut,Aoe,Loe,rA=L(()=>{oa();ZMe={xAxis:{},yAxis:{},zAxis:{}},Coe=hn({name:"cartesianAxis",initialState:ZMe,reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload;e.yAxis[r]&&(e.yAxis[r]=Toe(Toe({},e.yAxis[r]),{},{width:n}))}}}),{addXAxis:Poe,removeXAxis:Doe,addYAxis:Eoe,removeYAxis:Ioe,addZAxis:sut,removeZAxis:lut,updateYAxisWidth:Aoe}=Coe.actions,Loe=Coe.reducer});var Noe,Moe=L(()=>{Pa();Rl();Noe=ie([on],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}})});var Foe,Ooe=L(()=>{Pa();Moe();Nd();Foe=ie([Noe,hi,vi],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}})});var Vm,joe,yb=L(()=>{Or();Hd();Ooe();Vm=()=>Oe(Foe),joe=()=>Oe(Cre)});function zoe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _oe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zoe(Object(r),!0).forEach(function(n){eFe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zoe(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eFe(e,t,r){return(t=tFe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tFe(e){var t=rFe(e,"string");return typeof t=="symbol"?t:t+""}function rFe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kk(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:o}=e,a=Oe(Vd),i=joe();if(t==null||i==null)return null;var s=t.find(l=>i.includes(l.payload));return cr(s)?null:nFe({point:s,childIndex:Number(a),mainColor:r,dataKey:o,activeDot:n})}var n5,nA,nFe,o5=L(()=>{n5=q(Y()),nA=q(Y());Tm();Ta();YI();Vu();Or();Hd();yb();nr();nFe=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:o,dataKey:a}=e;if(o===!1||t.x==null||t.y==null)return null;var i=_oe(_oe({index:r,dataKey:a,cx:t.x,cy:t.y,r:4,fill:n!=null?n:"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},Wt(o,!1)),ly(o)),s;return(0,nA.isValidElement)(o)?s=(0,nA.cloneElement)(o,i):typeof o=="function"?s=o(i):s=n5.createElement(mb,i),n5.createElement(Sn,{className:"recharts-active-dot"},s)}});function Boe(e,t){if(!e){if(oFe)throw new Error(a5);var r=typeof t=="function"?t():t,n=r?"".concat(a5,": ").concat(r):a5;throw new Error(n)}}var oFe,a5,$oe=L(()=>{oFe=!0,a5="Invariant failed"});function i5(){return i5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i5.apply(null,arguments)}function Woe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Jk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Woe(Object(r),!0).forEach(function(n){iFe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Woe(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iFe(e,t,r){return(t=sFe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sFe(e){var t=lFe(e,"string");return typeof t=="symbol"?t:t+""}function lFe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cFe(e,t){if(e==null)return{};var r,n,o=dFe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function dFe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function uFe(e,t){var{x:r,y:n}=e,o=cFe(e,aFe),a="".concat(r),i=parseInt(a,10),s="".concat(n),l=parseInt(s,10),c="".concat(t.height||o.height),d=parseInt(c,10),u="".concat(t.width||o.width),p=parseInt(u,10);return Jk(Jk(Jk(Jk(Jk({},t),o),i?{x:i}:{}),l?{y:l}:{}),{},{height:d,width:p,name:t.name,radius:t.radius})}function oA(e){return Roe.createElement(loe,i5({shapeType:"rectangle",propTransformer:uFe,activeClassName:"recharts-active-bar"},e))}var Roe,aFe,Uoe,Voe=L(()=>{Roe=q(Y());$oe();coe();nr();aFe=["x","y"];Uoe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,o)=>{if(Re(t))return t;var a=Re(n)||cr(n);return a?t(n,o):(a||Boe(!1),r)}}});var pFe,Hoe,jut,zut,_ut,qoe,Goe=L(()=>{oa();pFe={},Hoe=hn({name:"errorBars",initialState:pFe,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:o}=t.payload;e[r]&&(e[r]=e[r].map(a=>a.dataKey===n.dataKey&&a.direction===n.direction?o:a))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(o=>o.dataKey!==n.dataKey||o.direction!==n.direction))}}}),{addErrorBar:jut,replaceErrorBar:zut,removeErrorBar:_ut}=Hoe.actions,qoe=Hoe.reducer});function fFe(e,t){if(e==null)return{};var r,n,o=gFe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function gFe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function aA(e){var{children:t}=e,r=fFe(e,mFe);return Yoe.createElement(vFe.Provider,{value:r},t)}var Yoe,Xk,mFe,hFe,vFe,s5=L(()=>{Yoe=q(Y()),Xk=q(Y()),mFe=["children"];hFe={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},vFe=(0,Xk.createContext)(hFe)});function dh(e,t){var r,n,o=Oe(c=>_c(c,e)),a=Oe(c=>Bc(c,t)),i=(r=o==null?void 0:o.allowDataOverflow)!==null&&r!==void 0?r:Vi.allowDataOverflow,s=(n=a==null?void 0:a.allowDataOverflow)!==null&&n!==void 0?n:Hi.allowDataOverflow,l=i||s;return{needClip:l,needClipX:i,needClipY:s}}function bb(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,o=Vm(),{needClipX:a,needClipY:i,needClip:s}=dh(t,r);if(!s)return null;var{x:l,y:c,width:d,height:u}=o;return l5.createElement("clipPath",{id:"clipPath-".concat(n)},l5.createElement("rect",{x:a?l:l-d/2,y:i?c:c-u/2,width:a?d:d*2,height:i?u:u*2}))}var l5,iA=L(()=>{l5=q(Y());Or();Kl();yb()});function Hm(){return Hm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Hm.apply(null,arguments)}function Koe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Gi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Koe(Object(r),!0).forEach(function(n){kFe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Koe(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kFe(e,t,r){return(t=SFe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SFe(e){var t=TFe(e,"string");return typeof t=="symbol"?t:t+""}function TFe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sA(e,t){if(e==null)return{};var r,n,o=CFe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function CFe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function DFe(e){var{dataKey:t,stroke:r,strokeWidth:n,fill:o,name:a,hide:i,unit:s}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:o,dataKey:t,nameKey:void 0,name:Gu(a,t),hide:i,type:e.tooltipType,color:e.fill,unit:s}}}function EFe(e){var t=Oe(Vd),{data:r,dataKey:n,background:o,allOtherBarProps:a}=e,{onMouseEnter:i,onMouseLeave:s,onClick:l}=a,c=sA(a,yFe),d=XW(i,n),u=QW(s),p=ZW(l,n);if(!o||r==null)return null;var m=Wt(o,!1);return mr.createElement(mr.Fragment,null,r.map((f,g)=>{var{value:v,background:h,tooltipPosition:y}=f,b=sA(f,bFe);if(!h)return null;var x=d(f,g),w=u(f,g),S=p(f,g),k=Gi(Gi(Gi(Gi(Gi({option:o,isActive:String(g)===t},b),{},{fill:"#eee"},h),m),Pg(c,f,g)),{},{onMouseEnter:x,onMouseLeave:w,onClick:S,dataKey:n,index:g,className:"recharts-bar-background-rectangle"});return mr.createElement(oA,Hm({key:"background-bar-".concat(g)},k))}))}function IFe(e){var{showLabels:t,children:r,rects:n}=e,o=n==null?void 0:n.map(a=>{var i={x:a.x,y:a.y,width:a.width,height:a.height};return Gi(Gi({},i),{},{value:a.value,payload:a.payload,parentViewBox:a.parentViewBox,viewBox:i,fill:a.fill})});return mr.createElement(ub,{value:t?o:void 0},r)}function AFe(e){var{shape:t,activeBar:r,baseProps:n,entry:o,index:a,dataKey:i}=e,s=Oe(Vd),l=Oe(MI),c=r&&String(a)===s&&(l==null||i===l),d=c?r:t;return mr.createElement(oA,Hm({},n,o,{isActive:c,option:d,index:a,dataKey:i}))}function LFe(e){var{shape:t,baseProps:r,entry:n,index:o,dataKey:a}=e;return mr.createElement(oA,Hm({},r,n,{isActive:!1,option:t,index:o,dataKey:a}))}function NFe(e){var{data:t,props:r}=e,n=Ga(r),{id:o}=n,a=sA(n,xFe),{shape:i,dataKey:s,activeBar:l}=r,{onMouseEnter:c,onClick:d,onMouseLeave:u}=r,p=sA(r,wFe),m=XW(c,s),f=QW(u),g=ZW(d,s);return t?mr.createElement(mr.Fragment,null,t.map((v,h)=>mr.createElement(Sn,Hm({className:"recharts-bar-rectangle"},Pg(p,v,h),{onMouseEnter:m(v,h),onMouseLeave:f(v,h),onClick:g(v,h),key:"rectangle-".concat(v==null?void 0:v.x,"-").concat(v==null?void 0:v.y,"-").concat(v==null?void 0:v.value,"-").concat(h)}),l?mr.createElement(AFe,{shape:i,activeBar:l,baseProps:a,entry:v,index:h,dataKey:s}):mr.createElement(LFe,{shape:i,baseProps:a,entry:v,index:h,dataKey:s})))):null}function MFe(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:o,isAnimationActive:a,animationBegin:i,animationDuration:s,animationEasing:l,onAnimationEnd:c,onAnimationStart:d}=t,u=r.current,p=jd(t,"recharts-bar-"),[m,f]=(0,ap.useState)(!1),g=!m,v=(0,ap.useCallback)(()=>{typeof c=="function"&&c(),f(!1)},[c]),h=(0,ap.useCallback)(()=>{typeof d=="function"&&d(),f(!0)},[d]);return mr.createElement(IFe,{showLabels:g,rects:n},mr.createElement(Od,{animationId:p,begin:i,duration:s,isActive:a,easing:l,onAnimationEnd:v,onAnimationStart:h,key:p},y=>{var b=y===1?n:n==null?void 0:n.map((x,w)=>{var S=u&&u[w];if(S)return Gi(Gi({},x),{},{x:Fr(S.x,x.x,y),y:Fr(S.y,x.y,y),width:Fr(S.width,x.width,y),height:Fr(S.height,x.height,y)});if(o==="horizontal"){var k=Fr(0,x.height,y);return Gi(Gi({},x),{},{y:x.y+x.height-k,height:k})}var T=Fr(0,x.width,y);return Gi(Gi({},x),{},{width:T})});return y>0&&(r.current=b!=null?b:null),b==null?null:mr.createElement(Sn,null,mr.createElement(NFe,{props:t,data:b}))}),mr.createElement(pb,{label:t.label}),t.children)}function FFe(e){var t=(0,ap.useRef)(null);return mr.createElement(MFe,{previousRectanglesRef:t,props:e})}function zFe(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:o,minPointSize:a,activeBar:i,animationBegin:s,animationDuration:l,animationEasing:c,isAnimationActive:d}=e,{needClip:u}=dh(t,r),p=Md(),m=jr(),f=VK(e.children,WW),g=Oe(y=>Qoe(y,t,r,m,e.id,f));if(p!=="vertical"&&p!=="horizontal")return null;var v,h=g==null?void 0:g[0];return h==null||h.height==null||h.width==null?v=0:v=p==="vertical"?h.height/2:h.width/2,mr.createElement(aA,{xAxisId:t,yAxisId:r,data:g,dataPointFormatter:OFe,errorBarOffset:v},mr.createElement(c5,Hm({},e,{layout:p,needClip:u,data:g,xAxisId:t,yAxisId:r,hide:n,legendType:o,minPointSize:a,activeBar:i,animationBegin:s,animationDuration:l,animationEasing:c,isAnimationActive:d})))}function Xoe(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:o,bandSize:a,xAxis:i,yAxis:s,xAxisTicks:l,yAxisTicks:c,stackedData:d,displayedData:u,offset:p,cells:m,parentViewBox:f}=e,g=t==="horizontal"?s:i,v=d?g.scale.domain():null,h=jX({numericAxis:g});return u.map((y,b)=>{var x,w,S,k,T,P;d?x=FX(d[b],v):(x=nn(y,r),Array.isArray(x)||(x=[h,x]));var D=Uoe(n,Joe)(x[1],b);if(t==="horizontal"){var O,[z,I]=[s.scale(x[0]),s.scale(x[1])];w=U_({axis:i,ticks:l,bandSize:a,offset:o.offset,entry:y,index:b}),S=(O=I!=null?I:z)!==null&&O!==void 0?O:void 0,k=o.size;var A=z-I;if(T=Mn(A)?0:A,P={x:w,y:p.top,width:k,height:p.height},Math.abs(D)>0&&Math.abs(T)<Math.abs(D)){var j=To(T||D)*(Math.abs(D)-Math.abs(T));S-=j,T+=j}}else{var[E,N]=[i.scale(x[0]),i.scale(x[1])];if(w=E,S=U_({axis:s,ticks:c,bandSize:a,offset:o.offset,entry:y,index:b}),k=N-E,T=o.size,P={x:p.left,y:S,width:p.width,height:T},Math.abs(D)>0&&Math.abs(k)<Math.abs(D)){var B=To(k||D)*(Math.abs(D)-Math.abs(k));k+=B}}if(w==null||S==null||k==null||T==null)return null;var C=Gi(Gi({},y),{},{x:w,y:S,width:k,height:T,value:d?x:x[1],payload:y,background:P,tooltipPosition:{x:w+k/2,y:S+T/2},parentViewBox:f},m&&m[b]&&m[b].props);return C}).filter(Boolean)}function qm(e){var t=On(e,jFe),r=jr();return mr.createElement(hb,{id:t.id,type:"bar"},n=>mr.createElement(mr.Fragment,null,mr.createElement(gb,{legendPayload:PFe(t)}),mr.createElement(fb,{fn:DFe,args:t}),mr.createElement(vb,{type:"bar",id:n,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:OD(t.stackId),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:r}),mr.createElement(zFe,Hm({},t,{id:n}))))}var mr,ap,yFe,bFe,xFe,wFe,PFe,Joe,OFe,c5,jFe,d5=L(()=>{mr=q(Y()),ap=q(Y());Nn();Vu();hne();GI();nr();Ta();Im();Ka();Tm();Voe();doe();XI();s5();iA();Co();Zoe();Or();Wi();Hd();QI();_y();Vl();eA();tA();Ld();zy();yFe=["onMouseEnter","onMouseLeave","onClick"],bFe=["value","background","tooltipPosition"],xFe=["id"],wFe=["onMouseEnter","onClick","onMouseLeave"];PFe=e=>{var{dataKey:t,name:r,fill:n,legendType:o,hide:a}=e;return[{inactive:a,dataKey:t,type:o,color:n,value:Gu(r,t),payload:e}]};Joe=0,OFe=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:nn(e,t)}},c5=class extends ap.PureComponent{render(){var{hide:t,data:r,dataKey:n,className:o,xAxisId:a,yAxisId:i,needClip:s,background:l,id:c}=this.props;if(t||r==null)return null;var d=mt("recharts-bar",o),u=c;return mr.createElement(Sn,{className:d,id:c},s&&mr.createElement("defs",null,mr.createElement(bb,{clipPathId:u,xAxisId:a,yAxisId:i})),mr.createElement(Sn,{className:"recharts-bar-rectangles",clipPath:s?"url(#clipPath-".concat(u,")"):void 0},mr.createElement(EFe,{data:r,dataKey:n,background:l,allOtherBarProps:this.props}),mr.createElement(FFe,this.props)))}},jFe={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!vs.isSsr,legendType:"rect",minPointSize:Joe,xAxisId:0,yAxisId:0};qm.displayName="Bar"});function eae(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function lA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eae(Object(r),!0).forEach(function(n){_Fe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eae(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _Fe(e,t,r){return(t=BFe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BFe(e){var t=$Fe(e,"string");return typeof t=="symbol"?t:t+""}function $Fe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ZFe(e,t,r,n,o){var a=n.length;if(!(a<1)){var i=gi(e,r,0,!0),s,l=[];if(Fn(n[0].barSize)){var c=!1,d=r/a,u=n.reduce((h,y)=>h+(y.barSize||0),0);u+=(a-1)*i,u>=r&&(u-=(a-1)*i,i=0),u>=r&&d>0&&(c=!0,d*=.9,u=a*d);var p=(r-u)/2>>0,m={offset:p-i,size:0};s=n.reduce((h,y)=>{var b,x={stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:m.offset+m.size+i,size:c?d:(b=y.barSize)!==null&&b!==void 0?b:0}},w=[...h,x];return m=w[w.length-1].position,w},l)}else{var f=gi(t,r,0,!0);r-2*f-(a-1)*i<=0&&(i=0);var g=(r-2*f-(a-1)*i)/a;g>1&&(g>>=0);var v=Fn(o)?Math.min(g,o):g;s=n.reduce((h,y,b)=>[...h,{stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:f+(g+i)*b+(g-v)/2,size:v}}],l)}return s}}var WFe,RFe,UFe,VFe,Qk,HFe,qFe,tae,GFe,YFe,KFe,JFe,XFe,QFe,rae,eOe,tOe,rOe,nOe,oOe,aOe,iOe,sOe,lOe,Qoe,Zoe=L(()=>{Pa();Kl();nr();Ka();d5();Co();Zg();Rl();rb();Fd();Lk();cI();WFe=(e,t)=>t,RFe=(e,t,r)=>r,UFe=(e,t,r,n)=>n,VFe=(e,t,r,n,o)=>o,Qk=ie([_m,VFe],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),HFe=ie([Qk],e=>e==null?void 0:e.maxBarSize),qFe=(e,t,r,n,o,a)=>a,tae=(e,t,r)=>{var n=r!=null?r:e;if(!cr(n))return gi(n,t,0)},GFe=ie([zt,_m,WFe,RFe,UFe],(e,t,r,n,o)=>t.filter(a=>e==="horizontal"?a.xAxisId===r:a.yAxisId===n).filter(a=>a.isPanorama===o).filter(a=>a.hide===!1).filter(a=>a.type==="bar")),YFe=(e,t,r,n)=>{var o=zt(e);return o==="horizontal"?oh(e,"yAxis",r,n):oh(e,"xAxis",t,n)},KFe=(e,t,r)=>{var n=zt(e);return n==="horizontal"?cW(e,"xAxis",t):cW(e,"yAxis",r)},JFe=(e,t,r)=>{var n={},o=e.filter(rh),a=e.filter(c=>c.stackId==null),i=o.reduce((c,d)=>(c[d.stackId]||(c[d.stackId]=[]),c[d.stackId].push(d),c),n),s=Object.entries(i).map(c=>{var[d,u]=c,p=u.map(f=>f.dataKey),m=tae(t,r,u[0].barSize);return{stackId:d,dataKeys:p,barSize:m}}),l=a.map(c=>{var d=[c.dataKey].filter(p=>p!=null),u=tae(t,r,c.barSize);return{stackId:void 0,dataKeys:d,barSize:u}});return[...s,...l]},XFe=ie([GFe,Bte,KFe],JFe),QFe=(e,t,r,n,o)=>{var a,i,s=Qk(e,t,r,n,o);if(s!=null){var l=zt(e),c=C$(e),{maxBarSize:d}=s,u=cr(d)?c:d,p,m;return l==="horizontal"?(p=nl(e,"xAxis",t,n),m=rl(e,"xAxis",t,n)):(p=nl(e,"yAxis",r,n),m=rl(e,"yAxis",r,n)),(a=(i=Mc(p,m,!0))!==null&&i!==void 0?i:u)!==null&&a!==void 0?a:0}},rae=(e,t,r,n)=>{var o=zt(e),a,i;return o==="horizontal"?(a=nl(e,"xAxis",t,n),i=rl(e,"xAxis",t,n)):(a=nl(e,"yAxis",r,n),i=rl(e,"yAxis",r,n)),Mc(a,i)};eOe=(e,t,r,n,o,a,i)=>{var s=cr(i)?t:i,l=ZFe(r,n,o!==a?o:a,e,s);return o!==a&&l!=null&&(l=l.map(c=>lA(lA({},c),{},{position:lA(lA({},c.position),{},{offset:c.position.offset-o/2})}))),l},tOe=ie([XFe,C$,_te,XE,QFe,rae,HFe],eOe),rOe=(e,t,r,n)=>nl(e,"xAxis",t,n),nOe=(e,t,r,n)=>nl(e,"yAxis",r,n),oOe=(e,t,r,n)=>rl(e,"xAxis",t,n),aOe=(e,t,r,n)=>rl(e,"yAxis",r,n),iOe=ie([tOe,Qk],(e,t)=>{if(!(e==null||t==null)){var r=e.find(n=>n.stackId===t.stackId&&t.dataKey!=null&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),sOe=(e,t)=>{var r=jm(t);if(!(!e||r==null||t==null)){var{stackId:n}=t;if(n!=null){var o=e[n];if(o){var{stackedData:a}=o;if(a)return a.find(i=>i.key===r)}}}},lOe=ie([YFe,Qk],sOe),Qoe=ie([on,Iy,rOe,nOe,oOe,aOe,iOe,zt,ep,rae,lOe,Qk,qFe],(e,t,r,n,o,a,i,s,l,c,d,u,p)=>{var{chartData:m,dataStartIndex:f,dataEndIndex:g}=l;if(!(u==null||i==null||t==null||s!=="horizontal"&&s!=="vertical"||r==null||n==null||o==null||a==null||c==null)){var{data:v}=u,h;if(v!=null&&v.length>0?h=v:h=m==null?void 0:m.slice(f,g+1),h!=null)return Xoe({layout:s,barSettings:u,pos:i,parentViewBox:t,bandSize:c,xAxis:r,yAxis:n,xAxisTicks:o,yAxisTicks:a,stackedData:d,displayedData:h,offset:e,cells:p})}})});var nae,oae,aae=L(()=>{nae=q(Y());BI();Or();Wi();oae=e=>{var{chartData:t}=e,r=or(),n=jr();return(0,nae.useEffect)(()=>n?()=>{}:(r(_W(t)),()=>{r(_W(void 0))}),[t,r,n]),null}});var iae,sae,jpt,lae,cae=L(()=>{oa();iae={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},sae=hn({name:"brush",initialState:iae,reducers:{setBrushSettings(e,t){return t.payload==null?iae:t.payload}}}),{setBrushSettings:jpt}=sae.actions,lae=sae.reducer});function dae(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function cA(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dae(Object(r),!0).forEach(function(n){uae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dae(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uae(e,t,r){return(t=cOe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cOe(e){var t=dOe(e,"string");return typeof t=="symbol"?t:t+""}function dOe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pOe(e){return(e%180+180)%180}var uOe,pae,dA,mae,fae,u5=L(()=>{uOe=(e,t)=>{var{x:r,y:n}=e,{x:o,y:a}=t;return{x:Math.min(r,o),y:Math.min(n,a),width:Math.abs(o-r),height:Math.abs(a-n)}},pae=e=>{var{x1:t,y1:r,x2:n,y2:o}=e;return uOe({x:t,y:r},{x:n,y:o})},dA=class e{static create(t){return new e(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(n)switch(n){case"start":return this.scale(t);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+o}case"end":{var a=this.bandwidth?this.bandwidth():0;return this.scale(t)+a}default:return this.scale(t)}if(r){var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+i}return this.scale(t)}}isInRange(t){var r=this.range(),n=r[0],o=r[r.length-1];return n<=o?t>=n&&t<=o:t>=o&&t<=n}};uae(dA,"EPS",1e-4);mae=e=>{var t=Object.keys(e).reduce((r,n)=>cA(cA({},r),{},{[n]:dA.create(e[n])}),{});return cA(cA({},t),{},{apply(r){var{bandAware:n,position:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Object.fromEntries(Object.entries(r).map(a=>{var[i,s]=a;return[i,t[i].apply(s,{bandAware:n,position:o})]}))},isInRange(r){return Object.keys(r).every(n=>t[n].isInRange(r[n]))}})};fae=function(t){var{width:r,height:n}=t,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=pOe(o),i=a*Math.PI/180,s=Math.atan(n/r),l=i>s&&i<Math.PI-s?n/Math.sin(i):r/Math.cos(i);return Math.abs(l)}});var mOe,gae,$pt,Wpt,Rpt,Upt,hae,vae,yae,p5=L(()=>{oa();mOe={dots:[],areas:[],lines:[]},gae=hn({name:"referenceElements",initialState:mOe,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=gs(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=gs(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=gs(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:$pt,removeDot:Wpt,addArea:Rpt,removeArea:Upt,addLine:hae,removeLine:vae}=gae.actions,yae=gae.reducer});var Zk,xb,bae,xae,wae,m5=L(()=>{Zk=q(Y()),xb=q(Y());nr();yb();bae=(0,xb.createContext)(void 0),xae=e=>{var{children:t}=e,[r]=(0,xb.useState)("".concat(Uu("recharts"),"-clip")),n=Vm();if(n==null)return null;var{x:o,y:a,width:i,height:s}=n;return Zk.createElement(bae.Provider,{value:r},Zk.createElement("defs",null,Zk.createElement("clipPath",{id:r},Zk.createElement("rect",{x:o,y:a,height:s,width:i}))),t)},wae=()=>(0,xb.useContext)(bae)});function kae(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function Sae(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kae(Object(r),!0).forEach(function(n){g5(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kae(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function g5(e,t,r){return(t=fOe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fOe(e){var t=gOe(e,"string");return typeof t=="symbol"?t:t+""}function gOe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function f5(){return f5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},f5.apply(null,arguments)}function yOe(e){var t=or();return(0,uA.useEffect)(()=>(t(hae(e)),()=>{t(vae(e))})),null}function bOe(e){var{x:t,y:r,segment:n,xAxisId:o,yAxisId:a,shape:i,className:s,ifOverflow:l}=e,c=jr(),d=wae(),u=Oe(O=>_c(O,o)),p=Oe(O=>Bc(O,a)),m=Oe(O=>$c(O,"xAxis",o,c)),f=Oe(O=>$c(O,"yAxis",a,c)),g=Dm(),v=Sa(t),h=Sa(r);if(!d||!g||u==null||p==null||m==null||f==null)return null;var y=mae({x:m,y:f}),b=n&&n.length===2,x=vOe(y,v,h,b,g,e.position,u.orientation,p.orientation,e);if(!x)return null;var[{x:w,y:S},{x:k,y:T}]=x,P=l==="hidden"?"url(#".concat(d,")"):void 0,D=Sae(Sae({clipPath:P},Wt(e,!0)),{},{x1:w,y1:S,x2:k,y2:T});return Yi.createElement(Sn,{className:mt("recharts-reference-line",s)},hOe(i,D),Yi.createElement(UI,pae({x1:w,y1:S,x2:k,y2:T}),Yi.createElement(VI,{label:e.label}),e.children))}function xOe(e){return Yi.createElement(Yi.Fragment,null,Yi.createElement(yOe,{yAxisId:e.yAxisId,xAxisId:e.xAxisId,ifOverflow:e.ifOverflow,x:e.x,y:e.y}),Yi.createElement(bOe,e))}var Yi,uA,hOe,vOe,Tn,Tae=L(()=>{Yi=q(Y()),uA=q(Y());Nn();Vu();Hk();nr();u5();Ta();Co();p5();Or();Kl();Wi();m5();hOe=(e,t)=>{var r;return Yi.isValidElement(e)?r=Yi.cloneElement(e,t):typeof e=="function"?r=e(t):r=Yi.createElement("line",f5({},t,{className:"recharts-reference-line-line"})),r},vOe=(e,t,r,n,o,a,i,s,l)=>{var{x:c,y:d,width:u,height:p}=o;if(r){var{y:m}=l,f=e.y.apply(m,{position:a});if(Mn(f)||l.ifOverflow==="discard"&&!e.y.isInRange(f))return null;var g=[{x:c+u,y:f},{x:c,y:f}];return s==="left"?g.reverse():g}if(t){var{x:v}=l,h=e.x.apply(v,{position:a});if(Mn(h)||l.ifOverflow==="discard"&&!e.x.isInRange(h))return null;var y=[{x:h,y:d+p},{x:h,y:d}];return i==="top"?y.reverse():y}if(n){var{segment:b}=l,x=b.map(w=>e.apply(w,{position:a}));return l.ifOverflow==="discard"&&x.some(w=>!e.isInRange(w))?null:x}return null};Tn=class extends uA.Component{render(){return Yi.createElement(xOe,this.props)}};g5(Tn,"displayName","ReferenceLine");g5(Tn,"defaultProps",{ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"})});function pA(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}var Cae=L(()=>{});function mA(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],o=0;o<e.length;o+=t)if(r===void 0||r(e[o])===!0)n.push(e[o]);else return;return n}var h5=L(()=>{});function Pae(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return fae(n,r)}function Dae(e,t,r){var n=r==="width",{x:o,y:a,width:i,height:s}=e;return t===1?{start:n?o:a,end:n?o+i:a+s}:{start:n?o+i:a+s,end:n?o:a}}function wb(e,t,r,n,o){if(e*t<e*n||e*t>e*o)return!1;var a=r();return e*(t-e*a/2-n)>=0&&e*(t+e*a/2-o)<=0}function Eae(e,t){return mA(e,t+1)}var v5=L(()=>{u5();h5()});function Iae(e,t,r,n,o){for(var a=(n||[]).slice(),{start:i,end:s}=t,l=0,c=1,d=i,u=function(){var f=n==null?void 0:n[l];if(f===void 0)return{v:mA(n,c)};var g=l,v,h=()=>(v===void 0&&(v=r(f,g)),v),y=f.coordinate,b=l===0||wb(e,y,h,d,s);b||(l=0,d=i,c+=1),b&&(d=y+e*(h()/2+o),l+=c)},p;c<=a.length;)if(p=u(),p)return p.v;return[]}var Aae=L(()=>{v5();h5()});function Lae(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function xi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Lae(Object(r),!0).forEach(function(n){wOe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lae(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wOe(e,t,r){return(t=kOe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kOe(e){var t=SOe(e,"string");return typeof t=="symbol"?t:t+""}function SOe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function TOe(e,t,r,n,o){for(var a=(n||[]).slice(),i=a.length,{start:s}=t,{end:l}=t,c=function(p){var m=a[p],f,g=()=>(f===void 0&&(f=r(m,p)),f);if(p===i-1){var v=e*(m.coordinate+e*g()/2-l);a[p]=m=xi(xi({},m),{},{tickCoord:v>0?m.coordinate-v*e:m.coordinate})}else a[p]=m=xi(xi({},m),{},{tickCoord:m.coordinate});var h=wb(e,m.tickCoord,g,s,l);h&&(l=m.tickCoord-e*(g()/2+o),a[p]=xi(xi({},m),{},{isShow:!0}))},d=i-1;d>=0;d--)c(d);return a}function COe(e,t,r,n,o,a){var i=(n||[]).slice(),s=i.length,{start:l,end:c}=t;if(a){var d=n[s-1],u=r(d,s-1),p=e*(d.coordinate+e*u/2-c);i[s-1]=d=xi(xi({},d),{},{tickCoord:p>0?d.coordinate-p*e:d.coordinate});var m=wb(e,d.tickCoord,()=>u,l,c);m&&(c=d.tickCoord-e*(u/2+o),i[s-1]=xi(xi({},d),{},{isShow:!0}))}for(var f=a?s-1:s,g=function(y){var b=i[y],x,w=()=>(x===void 0&&(x=r(b,y)),x);if(y===0){var S=e*(b.coordinate-e*w()/2-l);i[y]=b=xi(xi({},b),{},{tickCoord:S<0?b.coordinate-S*e:b.coordinate})}else i[y]=b=xi(xi({},b),{},{tickCoord:b.coordinate});var k=wb(e,b.tickCoord,w,l,c);k&&(l=b.tickCoord+e*(w()/2+o),i[y]=xi(xi({},b),{},{isShow:!0}))},v=0;v<f;v++)g(v);return i}function eS(e,t,r){var{tick:n,ticks:o,viewBox:a,minTickGap:i,orientation:s,interval:l,tickFormatter:c,unit:d,angle:u}=e;if(!o||!o.length||!n)return[];if(Re(l)||vs.isSsr){var p;return(p=Eae(o,Re(l)?l:0))!==null&&p!==void 0?p:[]}var m=[],f=s==="top"||s==="bottom"?"width":"height",g=d&&f==="width"?ch(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},v=(b,x)=>{var w=typeof c=="function"?c(b.value,x):b.value;return f==="width"?Pae(ch(w,{fontSize:t,letterSpacing:r}),g,u):ch(w,{fontSize:t,letterSpacing:r})[f]},h=o.length>=2?To(o[1].coordinate-o[0].coordinate):1,y=Dae(a,h,f);return l==="equidistantPreserveStart"?Iae(h,y,v,o,i):(l==="preserveStart"||l==="preserveStartEnd"?m=COe(h,y,v,o,i,l==="preserveStartEnd"):m=TOe(h,y,v,o,i),m.filter(b=>b.isShow))}var y5=L(()=>{nr();RW();Im();v5();Aae()});function kb(){return kb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kb.apply(null,arguments)}function Nae(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function sa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Nae(Object(r),!0).forEach(function(n){x5(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nae(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Mae(e,t){if(e==null)return{};var r,n,o=EOe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function EOe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function x5(e,t,r){return(t=IOe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IOe(e){var t=AOe(e,"string");return typeof t=="symbol"?t:t+""}function AOe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ki,Fae,b5,POe,DOe,Uc,fA=L(()=>{Ki=q(Y()),Fae=q(Y()),b5=q(W0());Nn();Cae();Vu();HW();Hk();nr();Tm();Ta();y5();Ld();POe=["viewBox"],DOe=["viewBox"];Uc=class e extends Fae.Component{constructor(t){super(t),this.tickRefs=Ki.createRef(),this.tickRefs.current=[],this.state={fontSize:"",letterSpacing:""}}shouldComponentUpdate(t,r){var{viewBox:n}=t,o=Mae(t,POe),a=this.props,{viewBox:i}=a,s=Mae(a,DOe);return!pA(n,i)||!pA(o,s)||!pA(r,this.state)}getTickLineCoord(t){var{x:r,y:n,width:o,height:a,orientation:i,tickSize:s,mirror:l,tickMargin:c}=this.props,d,u,p,m,f,g,v=l?-1:1,h=t.tickSize||s,y=Re(t.tickCoord)?t.tickCoord:t.coordinate;switch(i){case"top":d=u=t.coordinate,m=n+ +!l*a,p=m-v*h,g=p-v*c,f=y;break;case"left":p=m=t.coordinate,u=r+ +!l*o,d=u-v*h,f=d-v*c,g=y;break;case"right":p=m=t.coordinate,u=r+ +l*o,d=u+v*h,f=d+v*c,g=y;break;default:d=u=t.coordinate,m=n+ +l*a,p=m+v*h,g=p+v*c,f=y;break}return{line:{x1:d,y1:p,x2:u,y2:m},tick:{x:f,y:g}}}getTickTextAnchor(){var{orientation:t,mirror:r}=this.props;switch(t){case"left":return r?"start":"end";case"right":return r?"end":"start";default:return"middle"}}getTickVerticalAnchor(){var{orientation:t,mirror:r}=this.props;switch(t){case"left":case"right":return"middle";case"top":return r?"start":"end";default:return r?"end":"start"}}renderAxisLine(){var{x:t,y:r,width:n,height:o,orientation:a,mirror:i,axisLine:s}=this.props,l=sa(sa(sa({},Wt(this.props,!1)),Wt(s,!1)),{},{fill:"none"});if(a==="top"||a==="bottom"){var c=+(a==="top"&&!i||a==="bottom"&&i);l=sa(sa({},l),{},{x1:t,y1:r+c*o,x2:t+n,y2:r+c*o})}else{var d=+(a==="left"&&!i||a==="right"&&i);l=sa(sa({},l),{},{x1:t+d*n,y1:r,x2:t+d*n,y2:r+o})}return Ki.createElement("line",kb({},l,{className:mt("recharts-cartesian-axis-line",(0,b5.default)(s,"className"))}))}static renderTickItem(t,r,n){var o,a=mt(r.className,"recharts-cartesian-axis-tick-value");if(Ki.isValidElement(t))o=Ki.cloneElement(t,sa(sa({},r),{},{className:a}));else if(typeof t=="function")o=t(sa(sa({},r),{},{className:a}));else{var i="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(i=mt(i,t.className)),o=Ki.createElement(Uk,kb({},r,{className:i}),n)}return o}renderTicks(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],{tickLine:o,stroke:a,tick:i,tickFormatter:s,unit:l,padding:c,tickTextProps:d}=this.props,u=eS(sa(sa({},this.props),{},{ticks:n}),t,r),p=this.getTickTextAnchor(),m=this.getTickVerticalAnchor(),f=Ga(this.props),g=Wt(i,!1),v=sa(sa({},f),{},{fill:"none"},Wt(o,!1)),h=u.map((y,b)=>{var{line:x,tick:w}=this.getTickLineCoord(y),S=sa(sa(sa(sa({textAnchor:p,verticalAnchor:m},f),{},{stroke:"none",fill:a},g),w),{},{index:b,payload:y,visibleTicksCount:u.length,tickFormatter:s,padding:c},d);return Ki.createElement(Sn,kb({className:"recharts-cartesian-axis-tick",key:"tick-".concat(y.value,"-").concat(y.coordinate,"-").concat(y.tickCoord)},Pg(this.props,y,b)),o&&Ki.createElement("line",kb({},v,x,{className:mt("recharts-cartesian-axis-tick-line",(0,b5.default)(o,"className"))})),i&&e.renderTickItem(i,S,"".concat(typeof s=="function"?s(y.value,b):y.value).concat(l||"")))});return h.length>0?Ki.createElement("g",{className:"recharts-cartesian-axis-ticks"},h):null}render(){var{axisLine:t,width:r,height:n,className:o,hide:a}=this.props;if(a)return null;var{ticks:i}=this.props;return r!=null&&r<=0||n!=null&&n<=0?null:Ki.createElement(Sn,{className:mt("recharts-cartesian-axis",o),ref:s=>{if(s){var l=s.getElementsByClassName("recharts-cartesian-axis-tick-value");this.tickRefs.current=Array.from(l);var c=l[0];if(c){var d=window.getComputedStyle(c).fontSize,u=window.getComputedStyle(c).letterSpacing;(d!==this.state.fontSize||u!==this.state.letterSpacing)&&this.setState({fontSize:window.getComputedStyle(c).fontSize,letterSpacing:window.getComputedStyle(c).letterSpacing})}}}},t&&this.renderAxisLine(),this.renderTicks(this.state.fontSize,this.state.letterSpacing,i),Ki.createElement(UI,{x:this.props.x,y:this.props.y,width:this.props.width,height:this.props.height},Ki.createElement(VI,{label:this.props.label}),this.props.children))}};x5(Uc,"displayName","CartesianAxis");x5(Uc,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"})});function Oae(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function wi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Oae(Object(r),!0).forEach(function(n){OOe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Oae(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OOe(e,t,r){return(t=jOe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jOe(e){var t=zOe(e,"string");return typeof t=="symbol"?t:t+""}function zOe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uh(){return uh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uh.apply(null,arguments)}function gA(e,t){if(e==null)return{};var r,n,o=_Oe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function _Oe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function jae(e,t){var r;if(la.isValidElement(e))r=la.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var{x1:n,y1:o,x2:a,y2:i,key:s}=t,l=gA(t,LOe),c=Ga(l),{offset:d}=c,u=gA(c,NOe);r=la.createElement("line",uh({},u,{x1:n,y1:o,x2:a,y2:i,fill:"none",key:s}))}return r}function $Oe(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:o}=e;if(!n||!o||!o.length)return null;var{xAxisId:a,yAxisId:i}=e,s=gA(e,MOe),l=o.map((c,d)=>{var u=wi(wi({},s),{},{x1:t,y1:c,x2:t+r,y2:c,key:"line-".concat(d),index:d});return jae(n,u)});return la.createElement("g",{className:"recharts-cartesian-grid-horizontal"},l)}function WOe(e){var{y:t,height:r,vertical:n=!0,verticalPoints:o}=e;if(!n||!o||!o.length)return null;var{xAxisId:a,yAxisId:i}=e,s=gA(e,FOe),l=o.map((c,d)=>{var u=wi(wi({},s),{},{x1:c,y1:t,x2:c,y2:t+r,key:"line-".concat(d),index:d});return jae(n,u)});return la.createElement("g",{className:"recharts-cartesian-grid-vertical"},l)}function ROe(e){var{horizontalFill:t,fillOpacity:r,x:n,y:o,width:a,height:i,horizontalPoints:s,horizontal:l=!0}=e;if(!l||!t||!t.length)return null;var c=s.map(u=>Math.round(u+o-o)).sort((u,p)=>u-p);o!==c[0]&&c.unshift(0);var d=c.map((u,p)=>{var m=!c[p+1],f=m?o+i-u:c[p+1]-u;if(f<=0)return null;var g=p%t.length;return la.createElement("rect",{key:"react-".concat(p),y:u,x:n,height:f,width:a,stroke:"none",fill:t[g],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return la.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function UOe(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:o,y:a,width:i,height:s,verticalPoints:l}=e;if(!t||!r||!r.length)return null;var c=l.map(u=>Math.round(u+o-o)).sort((u,p)=>u-p);o!==c[0]&&c.unshift(0);var d=c.map((u,p)=>{var m=!c[p+1],f=m?o+i-u:c[p+1]-u;if(f<=0)return null;var g=p%r.length;return la.createElement("rect",{key:"react-".concat(p),x:u,y:a,width:f,height:s,stroke:"none",fill:r[g],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return la.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}function $o(e){var t=Ly(),r=Ny(),n=WD(),o=wi(wi({},On(e,qOe)),{},{x:Re(e.x)?e.x:n.left,y:Re(e.y)?e.y:n.top,width:Re(e.width)?e.width:n.width,height:Re(e.height)?e.height:n.height}),{xAxisId:a,yAxisId:i,x:s,y:l,width:c,height:d,syncWithTicks:u,horizontalValues:p,verticalValues:m}=o,f=jr(),g=Oe(P=>fW(P,"xAxis",a,f)),v=Oe(P=>fW(P,"yAxis",i,f));if(!Re(c)||c<=0||!Re(d)||d<=0||!Re(s)||s!==+s||!Re(l)||l!==+l)return null;var h=o.verticalCoordinatesGenerator||VOe,y=o.horizontalCoordinatesGenerator||HOe,{horizontalPoints:b,verticalPoints:x}=o;if((!b||!b.length)&&typeof y=="function"){var w=p&&p.length,S=y({yAxis:v?wi(wi({},v),{},{ticks:w?p:v.ticks}):void 0,width:t,height:r,offset:n},w?!0:u);$W(Array.isArray(S),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof S,"]")),Array.isArray(S)&&(b=S)}if((!x||!x.length)&&typeof h=="function"){var k=m&&m.length,T=h({xAxis:g?wi(wi({},g),{},{ticks:k?m:g.ticks}):void 0,width:t,height:r,offset:n},k?!0:u);$W(Array.isArray(T),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof T,"]")),Array.isArray(T)&&(x=T)}return la.createElement("g",{className:"recharts-cartesian-grid"},la.createElement(BOe,{fill:o.fill,fillOpacity:o.fillOpacity,x:o.x,y:o.y,width:o.width,height:o.height,ry:o.ry}),la.createElement(ROe,uh({},o,{horizontalPoints:b})),la.createElement(UOe,uh({},o,{verticalPoints:x})),la.createElement($Oe,uh({},o,{offset:n,horizontalPoints:b,xAxis:g,yAxis:v})),la.createElement(WOe,uh({},o,{offset:n,verticalPoints:x,xAxis:g,yAxis:v})))}var la,LOe,NOe,MOe,FOe,BOe,VOe,HOe,qOe,zae=L(()=>{la=q(Y());gne();nr();Ka();y5();fA();Co();Kl();Or();Wi();Vl();Ld();LOe=["x1","y1","x2","y2","key"],NOe=["offset"],MOe=["xAxisId","yAxisId"],FOe=["xAxisId","yAxisId"];BOe=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:o,width:a,height:i,ry:s}=e;return la.createElement("rect",{x:n,y:o,ry:s,width:a,height:i,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};VOe=(e,t)=>{var{xAxis:r,width:n,height:o,offset:a}=e;return W_(eS(wi(wi(wi({},Uc.defaultProps),r),{},{ticks:R_(r,!0),viewBox:{x:0,y:0,width:n,height:o}})),a.left,a.left+a.width,t)},HOe=(e,t)=>{var{yAxis:r,width:n,height:o,offset:a}=e;return W_(eS(wi(wi(wi({},Uc.defaultProps),r),{},{ticks:R_(r,!0),viewBox:{x:0,y:0,width:n,height:o}})),a.top,a.top+a.height,t)},qOe={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};$o.displayName="CartesianGrid"});function KOe(e){return e.type==="line"}var _ae,Bae,$ae,Wae,GOe,YOe,JOe,Rae,Uae=L(()=>{Pa();w5();Zg();Co();Kl();Ka();_ae=(e,t,r,n)=>nl(e,"xAxis",t,n),Bae=(e,t,r,n)=>rl(e,"xAxis",t,n),$ae=(e,t,r,n)=>nl(e,"yAxis",r,n),Wae=(e,t,r,n)=>rl(e,"yAxis",r,n),GOe=ie([zt,_ae,$ae,Bae,Wae],(e,t,r,n,o)=>hs(e,"xAxis")?Mc(t,n,!1):Mc(r,o,!1)),YOe=(e,t,r,n,o)=>o;JOe=ie([_m,YOe],(e,t)=>e.filter(KOe).find(r=>r.id===t)),Rae=ie([zt,_ae,$ae,Bae,Wae,JOe,GOe,ep],(e,t,r,n,o,a,i,s)=>{var{chartData:l,dataStartIndex:c,dataEndIndex:d}=s;if(!(a==null||t==null||r==null||n==null||o==null||n.length===0||o.length===0||i==null)){var{dataKey:u,data:p}=a,m;if(p!=null&&p.length>0?m=p:m=l==null?void 0:l.slice(c,d+1),m!=null)return Vae({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:o,dataKey:u,bandSize:i,displayedData:m})}})});function Hae(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function ol(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Hae(Object(r),!0).forEach(function(n){e2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hae(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function e2e(e,t,r){return(t=t2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function t2e(e){var t=r2e(e,"string");return typeof t=="symbol"?t:t+""}function r2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function S5(e,t){if(e==null)return{};var r,n,o=n2e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function n2e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function ph(){return ph=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ph.apply(null,arguments)}function a2e(e){var{dataKey:t,data:r,stroke:n,strokeWidth:o,fill:a,name:i,hide:s,unit:l}=e;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:o,fill:a,dataKey:t,nameKey:void 0,name:Gu(i,t),hide:s,type:e.tooltipType,color:e.stroke,unit:l}}}function i2e(e,t){for(var r=e.length%2!==0?[...e,0]:e,n=[],o=0;o<t;++o)n=[...n,...r];return n}function l2e(e,t){var r;if(ar.isValidElement(e))r=ar.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var n=mt("recharts-line-dot",typeof e!="boolean"?e.className:"");r=ar.createElement(mb,ph({},t,{className:n}))}return r}function c2e(e,t){return e==null?!1:t?!0:e.length===1}function d2e(e){var{clipPathId:t,points:r,props:n}=e,{dot:o,dataKey:a,needClip:i}=n;if(!c2e(r,o))return null;var{id:s}=n,l=S5(n,XOe),c=cy(o),d=Ga(l),u=Wt(o,!0),p=r.map((f,g)=>{var v=ol(ol(ol({key:"dot-".concat(g),r:3},d),u),{},{index:g,cx:f.x,cy:f.y,dataKey:a,value:f.value,payload:f.payload,points:r});return l2e(o,v)}),m={clipPath:i?"url(#clipPath-".concat(c?"":"dots-").concat(t,")"):void 0};return ar.createElement(Sn,ph({className:"recharts-line-dots",key:"dots"},m),p)}function u2e(e){var{showLabels:t,children:r,points:n}=e,o=(0,al.useMemo)(()=>n==null?void 0:n.map(a=>{var i={x:a.x,y:a.y,width:0,height:0};return ol(ol({},i),{},{value:a.value,payload:a.payload,viewBox:i,parentViewBox:void 0,fill:void 0})}),[n]);return ar.createElement(ub,{value:t?o:null},r)}function qae(e){var{clipPathId:t,pathRef:r,points:n,strokeDasharray:o,props:a}=e,{type:i,layout:s,connectNulls:l,needClip:c}=a,d=S5(a,QOe),u=ol(ol({},Wt(d,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:c?"url(#clipPath-".concat(t,")"):void 0,points:n,type:i,layout:s,connectNulls:l,strokeDasharray:o!=null?o:a.strokeDasharray});return ar.createElement(ar.Fragment,null,(n==null?void 0:n.length)>1&&ar.createElement(Am,ph({},u,{pathRef:r})),ar.createElement(d2e,{points:n,clipPathId:t,props:a}))}function p2e(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch(t){return 0}}function m2e(e){var{clipPathId:t,props:r,pathRef:n,previousPointsRef:o,longestAnimatedLengthRef:a}=e,{points:i,strokeDasharray:s,isAnimationActive:l,animationBegin:c,animationDuration:d,animationEasing:u,animateNewValues:p,width:m,height:f,onAnimationEnd:g,onAnimationStart:v}=r,h=o.current,y=jd(r,"recharts-line-"),[b,x]=(0,al.useState)(!1),w=!b,S=(0,al.useCallback)(()=>{typeof g=="function"&&g(),x(!1)},[g]),k=(0,al.useCallback)(()=>{typeof v=="function"&&v(),x(!0)},[v]),T=p2e(n.current),P=a.current;return ar.createElement(u2e,{points:i,showLabels:w},r.children,ar.createElement(Od,{animationId:y,begin:c,duration:d,isActive:l,easing:u,onAnimationEnd:S,onAnimationStart:k,key:y},D=>{var O=Fr(P,T+P,D),z=Math.min(O,T),I;if(l)if(s){var A="".concat(s).split(/[,\s]+/gim).map(N=>parseFloat(N));I=s2e(z,T,A)}else I=Gae(T,z);else I=s==null?void 0:String(s);if(h){var j=h.length/i.length,E=D===1?i:i.map((N,B)=>{var C=Math.floor(B*j);if(h[C]){var F=h[C];return ol(ol({},N),{},{x:Fr(F.x,N.x,D),y:Fr(F.y,N.y,D)})}return p?ol(ol({},N),{},{x:Fr(m*2,N.x,D),y:Fr(f/2,N.y,D)}):ol(ol({},N),{},{x:N.x,y:N.y})});return o.current=E,ar.createElement(qae,{props:r,points:E,clipPathId:t,pathRef:n,strokeDasharray:I})}return D>0&&T>0&&(o.current=i,a.current=z),ar.createElement(qae,{props:r,points:i,clipPathId:t,pathRef:n,strokeDasharray:I})}),ar.createElement(pb,{label:r.label}))}function f2e(e){var{clipPathId:t,props:r}=e,n=(0,al.useRef)(null),o=(0,al.useRef)(0),a=(0,al.useRef)(null);return ar.createElement(m2e,{props:r,clipPathId:t,previousPointsRef:n,longestAnimatedLengthRef:o,pathRef:a})}function h2e(e){var t=On(e,Yae),{activeDot:r,animateNewValues:n,animationBegin:o,animationDuration:a,animationEasing:i,connectNulls:s,dot:l,hide:c,isAnimationActive:d,label:u,legendType:p,xAxisId:m,yAxisId:f,id:g}=t,v=S5(t,ZOe),{needClip:h}=dh(m,f),y=Vm(),b=Md(),x=jr(),w=Oe(D=>Rae(D,m,f,x,g));if(b!=="horizontal"&&b!=="vertical"||w==null||y==null)return null;var{height:S,width:k,x:T,y:P}=y;return ar.createElement(k5,ph({},v,{id:g,connectNulls:s,dot:l,activeDot:r,animateNewValues:n,animationBegin:o,animationDuration:a,animationEasing:i,isAnimationActive:d,hide:c,label:u,legendType:p,xAxisId:m,yAxisId:f,points:w,layout:b,height:S,width:k,left:T,top:P,needClip:h}))}function Vae(e){var{layout:t,xAxis:r,yAxis:n,xAxisTicks:o,yAxisTicks:a,dataKey:i,bandSize:s,displayedData:l}=e;return l.map((c,d)=>{var u=nn(c,i);if(t==="horizontal"){var p=Py({axis:r,ticks:o,bandSize:s,entry:c,index:d}),m=cr(u)?null:n.scale(u);return{x:p,y:m,value:u,payload:c}}var f=cr(u)?null:r.scale(u),g=Py({axis:n,ticks:a,bandSize:s,entry:c,index:d});return f==null||g==null?null:{x:f,y:g,value:u,payload:c}}).filter(Boolean)}function Ql(e){var t=On(e,Yae),r=jr();return ar.createElement(hb,{id:t.id,type:"line"},n=>ar.createElement(ar.Fragment,null,ar.createElement(gb,{legendPayload:o2e(t)}),ar.createElement(fb,{fn:a2e,args:t}),ar.createElement(vb,{type:"line",id:n,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:r}),ar.createElement(h2e,ph({},t,{id:n}))))}var ar,al,XOe,QOe,ZOe,o2e,Gae,s2e,g2e,k5,Yae,w5=L(()=>{ar=q(Y()),al=q(Y());Nn();GD();YI();Vu();GI();nr();Ta();Im();Ka();o5();XI();s5();iA();Co();Wi();Uae();Or();QI();_y();Vl();yb();eA();tA();Ld();zy();XOe=["id"],QOe=["type","layout","connectNulls","needClip"],ZOe=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];o2e=e=>{var{dataKey:t,name:r,stroke:n,legendType:o,hide:a}=e;return[{inactive:a,dataKey:t,type:o,color:n,value:Gu(r,t),payload:e}]};Gae=(e,t)=>"".concat(t,"px ").concat(e-t,"px");s2e=(e,t,r)=>{var n=r.reduce((u,p)=>u+p);if(!n)return Gae(t,e);for(var o=Math.floor(e/n),a=e%n,i=t-e,s=[],l=0,c=0;l<r.length;c+=r[l],++l)if(c+r[l]>a){s=[...r.slice(0,l),a-c];break}var d=s.length%2===0?[0,i]:[i];return[...i2e(r,o),...s,...d].map(u=>"".concat(u,"px")).join(", ")};g2e=(e,t)=>({x:e.x,y:e.y,value:e.value,errorVal:nn(e.payload,t)}),k5=class extends al.Component{render(){var t,{hide:r,dot:n,points:o,className:a,xAxisId:i,yAxisId:s,top:l,left:c,width:d,height:u,id:p,needClip:m}=this.props;if(r)return null;var f=mt("recharts-line",a),g=p,{r:v=3,strokeWidth:h=2}=(t=Wt(n,!1))!==null&&t!==void 0?t:{r:3,strokeWidth:2},y=cy(n),b=v*2+h;return ar.createElement(ar.Fragment,null,ar.createElement(Sn,{className:f},m&&ar.createElement("defs",null,ar.createElement(bb,{clipPathId:g,xAxisId:i,yAxisId:s}),!y&&ar.createElement("clipPath",{id:"clipPath-dots-".concat(g)},ar.createElement("rect",{x:c-b/2,y:l-b/2,width:d+b,height:u+b}))),ar.createElement(aA,{xAxisId:i,yAxisId:s,data:o,dataPointFormatter:g2e,errorBarOffset:0},ar.createElement(f2e,{props:this.props,clipPathId:g}))),ar.createElement(Kk,{activeDot:this.props.activeDot,points:o,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}},Yae={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!vs.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};Ql.displayName="Line"});var Kae,Jae,Xae,Qae,v2e,y2e,Zae,b2e,eie,tie=L(()=>{Pa();T5();Kl();Co();Zg();Ka();Lk();Kae=(e,t,r,n)=>nl(e,"xAxis",t,n),Jae=(e,t,r,n)=>rl(e,"xAxis",t,n),Xae=(e,t,r,n)=>nl(e,"yAxis",r,n),Qae=(e,t,r,n)=>rl(e,"yAxis",r,n),v2e=ie([zt,Kae,Xae,Jae,Qae],(e,t,r,n,o)=>hs(e,"xAxis")?Mc(t,n,!1):Mc(r,o,!1)),y2e=(e,t,r,n,o)=>o,Zae=ie([_m,y2e],(e,t)=>e.filter(r=>r.type==="area").find(r=>r.id===t)),b2e=(e,t,r,n,o)=>{var a,i=Zae(e,t,r,n,o);if(i!=null){var s=zt(e),l=hs(s,"xAxis"),c;if(l?c=oh(e,"yAxis",r,n):c=oh(e,"xAxis",t,n),c!=null){var{stackId:d}=i,u=jm(i);if(!(d==null||u==null)){var p=(a=c[d])===null||a===void 0?void 0:a.stackedData;return p==null?void 0:p.find(m=>m.key===u)}}}},eie=ie([zt,Kae,Xae,Jae,Qae,b2e,ep,v2e,Zae],(e,t,r,n,o,a,i,s,l)=>{var{chartData:c,dataStartIndex:d,dataEndIndex:u}=i;if(!(l==null||e!=="horizontal"&&e!=="vertical"||t==null||r==null||n==null||o==null||n.length===0||o.length===0||s==null)){var{data:p}=l,m;if(p&&p.length>0?m=p:m=c==null?void 0:c.slice(d,u+1),m!=null){var f=void 0;return rie({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:o,dataStartIndex:d,areaSettings:l,stackedData:a,displayedData:m,chartBaseValue:f,bandSize:s})}}})});function aie(e,t){if(e==null)return{};var r,n,o=k2e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function k2e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function nie(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function ip(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nie(Object(r),!0).forEach(function(n){S2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nie(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function S2e(e,t,r){return(t=T2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function T2e(e){var t=C2e(e,"string");return typeof t=="symbol"?t:t+""}function C2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sp(){return sp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sp.apply(null,arguments)}function hA(e,t){return e&&e!=="none"?e:t}function D2e(e){var{dataKey:t,data:r,stroke:n,strokeWidth:o,fill:a,name:i,hide:s,unit:l}=e;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:o,fill:a,dataKey:t,nameKey:void 0,name:Gu(i,t),hide:s,type:e.tooltipType,color:hA(n,a),unit:l}}}function I2e(e,t){return e==null?!1:t?!0:e.length===1}function A2e(e){var{clipPathId:t,points:r,props:n}=e,{needClip:o,dot:a,dataKey:i}=n;if(!I2e(r,a))return null;var s=cy(a),l=Ga(n),c=Wt(a,!0),d=r.map((p,m)=>{var f=ip(ip(ip({key:"dot-".concat(m),r:3},l),c),{},{index:m,cx:p.x,cy:p.y,dataKey:i,value:p.value,payload:p.payload,points:r});return E2e(a,f)}),u={clipPath:o?"url(#clipPath-".concat(s?"":"dots-").concat(t,")"):void 0};return kt.createElement(Sn,sp({className:"recharts-area-dots"},u),d)}function L2e(e){var{showLabels:t,children:r,points:n}=e,o=n.map(a=>{var i={x:a.x,y:a.y,width:0,height:0};return ip(ip({},i),{},{value:a.value,payload:a.payload,parentViewBox:void 0,viewBox:i,fill:void 0})});return kt.createElement(ub,{value:t?o:null},r)}function oie(e){var{points:t,baseLine:r,needClip:n,clipPathId:o,props:a}=e,{layout:i,type:s,stroke:l,connectNulls:c,isRange:d}=a,{id:u}=a,p=aie(a,x2e),m=Ga(p);return kt.createElement(kt.Fragment,null,(t==null?void 0:t.length)>1&&kt.createElement(Sn,{clipPath:n?"url(#clipPath-".concat(o,")"):void 0},kt.createElement(Am,sp({},m,{id:u,points:t,connectNulls:c,type:s,baseLine:r,layout:i,stroke:"none",className:"recharts-area-area"})),l!=="none"&&kt.createElement(Am,sp({},m,{className:"recharts-area-curve",layout:i,type:s,connectNulls:c,fill:"none",points:t})),l!=="none"&&d&&kt.createElement(Am,sp({},m,{className:"recharts-area-curve",layout:i,type:s,connectNulls:c,fill:"none",points:r}))),kt.createElement(A2e,{points:t,props:p,clipPathId:o}))}function N2e(e){var{alpha:t,baseLine:r,points:n,strokeWidth:o}=e,a=n[0].y,i=n[n.length-1].y;if(!Fn(a)||!Fn(i))return null;var s=t*Math.abs(a-i),l=Math.max(...n.map(c=>c.x||0));return Re(r)?l=Math.max(r,l):r&&Array.isArray(r)&&r.length&&(l=Math.max(...r.map(c=>c.x||0),l)),Re(l)?kt.createElement("rect",{x:0,y:a<i?a:a-s,width:l+(o?parseInt("".concat(o),10):1),height:Math.floor(s)}):null}function M2e(e){var{alpha:t,baseLine:r,points:n,strokeWidth:o}=e,a=n[0].x,i=n[n.length-1].x;if(!Fn(a)||!Fn(i))return null;var s=t*Math.abs(a-i),l=Math.max(...n.map(c=>c.y||0));return Re(r)?l=Math.max(r,l):r&&Array.isArray(r)&&r.length&&(l=Math.max(...r.map(c=>c.y||0),l)),Re(l)?kt.createElement("rect",{x:a<i?a:a-s,y:0,width:s,height:Math.floor(l+(o?parseInt("".concat(o),10):1))}):null}function F2e(e){var{alpha:t,layout:r,points:n,baseLine:o,strokeWidth:a}=e;return r==="vertical"?kt.createElement(N2e,{alpha:t,points:n,baseLine:o,strokeWidth:a}):kt.createElement(M2e,{alpha:t,points:n,baseLine:o,strokeWidth:a})}function O2e(e){var{needClip:t,clipPathId:r,props:n,previousPointsRef:o,previousBaselineRef:a}=e,{points:i,baseLine:s,isAnimationActive:l,animationBegin:c,animationDuration:d,animationEasing:u,onAnimationStart:p,onAnimationEnd:m}=n,f=jd(n,"recharts-area-"),[g,v]=(0,qd.useState)(!1),h=!g,y=(0,qd.useCallback)(()=>{typeof m=="function"&&m(),v(!1)},[m]),b=(0,qd.useCallback)(()=>{typeof p=="function"&&p(),v(!0)},[p]),x=o.current,w=a.current;return kt.createElement(L2e,{showLabels:h,points:i},n.children,kt.createElement(Od,{animationId:f,begin:c,duration:d,isActive:l,easing:u,onAnimationEnd:y,onAnimationStart:b,key:f},S=>{if(x){var k=x.length/i.length,T=S===1?i:i.map((D,O)=>{var z=Math.floor(O*k);if(x[z]){var I=x[z];return ip(ip({},D),{},{x:Fr(I.x,D.x,S),y:Fr(I.y,D.y,S)})}return D}),P;return Re(s)?P=Fr(w,s,S):cr(s)||Mn(s)?P=Fr(w,0,S):P=s.map((D,O)=>{var z=Math.floor(O*k);if(Array.isArray(w)&&w[z]){var I=w[z];return ip(ip({},D),{},{x:Fr(I.x,D.x,S),y:Fr(I.y,D.y,S)})}return D}),S>0&&(o.current=T,a.current=P),kt.createElement(oie,{points:T,baseLine:P,needClip:t,clipPathId:r,props:n})}return S>0&&(o.current=i,a.current=s),kt.createElement(Sn,null,l&&kt.createElement("defs",null,kt.createElement("clipPath",{id:"animationClipPath-".concat(r)},kt.createElement(F2e,{alpha:S,points:i,baseLine:s,layout:n.layout,strokeWidth:n.strokeWidth}))),kt.createElement(Sn,{clipPath:"url(#animationClipPath-".concat(r,")")},kt.createElement(oie,{points:i,baseLine:s,needClip:t,clipPathId:r,props:n})))}),kt.createElement(pb,{label:n.label}))}function j2e(e){var{needClip:t,clipPathId:r,props:n}=e,o=(0,qd.useRef)(null),a=(0,qd.useRef)();return kt.createElement(O2e,{needClip:t,clipPathId:r,props:n,previousPointsRef:o,previousBaselineRef:a})}function z2e(e){var t,r=On(e,iie),{activeDot:n,animationBegin:o,animationDuration:a,animationEasing:i,connectNulls:s,dot:l,fill:c,fillOpacity:d,hide:u,isAnimationActive:p,legendType:m,stroke:f,xAxisId:g,yAxisId:v}=r,h=aie(r,w2e),y=Md(),b=FI(),{needClip:x}=dh(g,v),w=jr(),{points:S,isRange:k,baseLine:T}=(t=Oe(A=>eie(A,g,v,w,e.id)))!==null&&t!==void 0?t:{},P=Vm();if(y!=="horizontal"&&y!=="vertical"||P==null||b!=="AreaChart"&&b!=="ComposedChart")return null;var{height:D,width:O,x:z,y:I}=P;return!S||!S.length?null:kt.createElement(C5,sp({},h,{activeDot:n,animationBegin:o,animationDuration:a,animationEasing:i,baseLine:T,connectNulls:s,dot:l,fill:c,fillOpacity:d,height:D,hide:u,layout:y,isAnimationActive:p,isRange:k,legendType:m,needClip:x,points:S,stroke:f,width:O,left:z,top:I,xAxisId:g,yAxisId:v}))}function rie(e){var{areaSettings:{connectNulls:t,baseValue:r,dataKey:n},stackedData:o,layout:a,chartBaseValue:i,xAxis:s,yAxis:l,displayedData:c,dataStartIndex:d,xAxisTicks:u,yAxisTicks:p,bandSize:m}=e,f=o&&o.length,g=_2e(a,i,r,s,l),v=a==="horizontal",h=!1,y=c.map((x,w)=>{var S;f?S=o[d+w]:(S=nn(x,n),Array.isArray(S)?h=!0:S=[g,S]);var k=S[1]==null||f&&!t&&nn(x,n)==null;return v?{x:Py({axis:s,ticks:u,bandSize:m,entry:x,index:w}),y:k?null:l.scale(S[1]),value:S,payload:x}:{x:k?null:s.scale(S[1]),y:Py({axis:l,ticks:p,bandSize:m,entry:x,index:w}),value:S,payload:x}}),b;return f||h?b=y.map(x=>{var w=Array.isArray(x.value)?x.value[0]:null;return v?{x:x.x,y:w!=null&&x.y!=null?l.scale(w):null,payload:x.payload}:{x:w!=null?s.scale(w):null,y:x.y,payload:x.payload}}):b=v?l.scale(g):s.scale(g),{points:y,baseLine:b,isRange:h}}function Vc(e){var t=On(e,iie),r=jr();return kt.createElement(hb,{id:t.id,type:"area"},n=>kt.createElement(kt.Fragment,null,kt.createElement(gb,{legendPayload:P2e(t)}),kt.createElement(fb,{fn:D2e,args:t}),kt.createElement(vb,{type:"area",id:n,data:t.data,dataKey:t.dataKey,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,stackId:OD(t.stackId),hide:t.hide,barSize:void 0,baseValue:t.baseValue,isPanorama:r,connectNulls:t.connectNulls}),kt.createElement(z2e,sp({},t,{id:n}))))}var kt,qd,x2e,w2e,P2e,E2e,C5,iie,_2e,T5=L(()=>{kt=q(Y()),qd=q(Y());Nn();GD();YI();Vu();GI();Im();nr();Ka();Ta();o5();XI();iA();tie();Wi();Co();ih();QI();Or();_y();Vl();Fd();yb();eA();tA();Ld();zy();x2e=["id"],w2e=["activeDot","animationBegin","animationDuration","animationEasing","connectNulls","dot","fill","fillOpacity","hide","isAnimationActive","legendType","stroke","xAxisId","yAxisId"];P2e=e=>{var{dataKey:t,name:r,stroke:n,fill:o,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:hA(n,o),value:Gu(r,t),payload:e}]};E2e=(e,t)=>{var r;if(kt.isValidElement(e))r=kt.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var n=mt("recharts-area-dot",typeof e!="boolean"?e.className:"");r=kt.createElement(mb,sp({},t,{className:n}))}return r};C5=class extends qd.PureComponent{render(){var t,{hide:r,dot:n,points:o,className:a,top:i,left:s,needClip:l,xAxisId:c,yAxisId:d,width:u,height:p,id:m,baseLine:f}=this.props;if(r)return null;var g=mt("recharts-area",a),v=m,{r:h=3,strokeWidth:y=2}=(t=Wt(n,!1))!==null&&t!==void 0?t:{r:3,strokeWidth:2},b=cy(n),x=h*2+y;return kt.createElement(kt.Fragment,null,kt.createElement(Sn,{className:g},l&&kt.createElement("defs",null,kt.createElement(bb,{clipPathId:v,xAxisId:c,yAxisId:d}),!b&&kt.createElement("clipPath",{id:"clipPath-dots-".concat(v)},kt.createElement("rect",{x:s-x/2,y:i-x/2,width:u+x,height:p+x}))),kt.createElement(j2e,{needClip:l,clipPathId:v,props:this.props})),kt.createElement(Kk,{points:o,mainColor:hA(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}),this.props.isRange&&Array.isArray(f)&&kt.createElement(Kk,{points:f,mainColor:hA(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}))}},iie={activeDot:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!1,fill:"#3182bd",fillOpacity:.6,hide:!1,isAnimationActive:!vs.isSsr,legendType:"line",stroke:"#3182bd",xAxisId:0,yAxisId:0};_2e=(e,t,r,n,o)=>{var a=r!=null?r:t;if(Re(a))return a;var i=e==="horizontal"?o:n,s=i.scale.domain();if(i.type==="number"){var l=Math.max(s[0],s[1]),c=Math.min(s[0],s[1]);return a==="dataMin"?c:a==="dataMax"||l<0?l:Math.max(Math.min(s[0],s[1]),0)}return a==="dataMin"?s[0]:a==="dataMax"?s[1]:s[0]};Vc.displayName="Area"});function sie(e,t,r){return(t=R2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R2e(e){var t=U2e(e,"string");return typeof t=="symbol"?t:t+""}function U2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function P5(){return P5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},P5.apply(null,arguments)}function D5(e,t){if(e==null)return{};var r,n,o=V2e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function V2e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function H2e(e){var t=or(),r=(0,Sb.useMemo)(()=>{var{children:n}=e,o=D5(e,B2e);return o},[e]);return(0,Sb.useEffect)(()=>(t(Poe(r)),()=>{t(Doe(r))}),[r,t]),e.children}var tS,Sb,B2e,$2e,W2e,q2e,G2e,to,lie=L(()=>{tS=q(Y()),Sb=q(Y());Nn();fA();Or();rA();Kl();Rl();Wi();B2e=["children"],$2e=["dangerouslySetInnerHTML","ticks"],W2e=["id"];q2e=e=>{var{xAxisId:t,className:r}=e,n=Oe(Iy),o=jr(),a="xAxis",i=Oe(v=>$c(v,a,t,o)),s=Oe(v=>hI(v,a,t,o)),l=Oe(v=>sW(v,t)),c=Oe(v=>rre(v,t)),d=Oe(v=>F$(v,t));if(l==null||c==null||d==null)return null;var{dangerouslySetInnerHTML:u,ticks:p}=e,m=D5(e,$2e),{id:f}=d,g=D5(d,W2e);return tS.createElement(Uc,P5({},m,g,{scale:i,x:c.x,y:c.y,width:l.width,height:l.height,className:mt("recharts-".concat(a," ").concat(a),r),viewBox:n,ticks:s}))},G2e=e=>{var t,r,n,o,a;return tS.createElement(H2e,{interval:(t=e.interval)!==null&&t!==void 0?t:"preserveEnd",id:e.xAxisId,scale:e.scale,type:e.type,padding:e.padding,allowDataOverflow:e.allowDataOverflow,domain:e.domain,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,includeHidden:(r=e.includeHidden)!==null&&r!==void 0?r:!1,reversed:e.reversed,ticks:e.ticks,height:e.height,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:(n=e.angle)!==null&&n!==void 0?n:0,minTickGap:(o=e.minTickGap)!==null&&o!==void 0?o:5,tick:(a=e.tick)!==null&&a!==void 0?a:!0,tickFormatter:e.tickFormatter},tS.createElement(q2e,e))},to=class extends Sb.Component{render(){return tS.createElement(G2e,this.props)}};sie(to,"displayName","XAxis");sie(to,"defaultProps",{allowDataOverflow:Vi.allowDataOverflow,allowDecimals:Vi.allowDecimals,allowDuplicatedCategory:Vi.allowDuplicatedCategory,height:Vi.height,hide:!1,mirror:Vi.mirror,orientation:Vi.orientation,padding:Vi.padding,reversed:Vi.reversed,scale:Vi.scale,tickCount:Vi.tickCount,type:Vi.type,xAxisId:0})});var cie,die=L(()=>{cie=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:o=0,tickMargin:a=0}=e,i=0;if(t){t.forEach(d=>{if(d){var u=d.getBoundingClientRect();u.width>i&&(i=u.width)}});var s=r?r.getBoundingClientRect().width:0,l=o+a,c=i+l+s+(r?n:0);return Math.round(c)}return 0}});function pie(e,t,r){return(t=J2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function J2e(e){var t=X2e(e,"string");return typeof t=="symbol"?t:t+""}function X2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function E5(){return E5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},E5.apply(null,arguments)}function uie(e,t){if(e==null)return{};var r,n,o=Q2e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function Q2e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Z2e(e){var t=or();return(0,Hc.useEffect)(()=>(t(Eoe(e)),()=>{t(Ioe(e))}),[e,t]),null}var Gm,Hc,Y2e,K2e,eje,tje,rje,ro,mie=L(()=>{Gm=q(Y()),Hc=q(Y());Nn();fA();rA();Or();Kl();Rl();Wi();die();Hk();Y2e=["dangerouslySetInnerHTML","ticks"],K2e=["id"];eje=e=>{var t,{yAxisId:r,className:n,width:o,label:a}=e,i=(0,Hc.useRef)(null),s=(0,Hc.useRef)(null),l=Oe(Iy),c=jr(),d=or(),u="yAxis",p=Oe(S=>$c(S,u,r,c)),m=Oe(S=>lW(S,r)),f=Oe(S=>nre(S,r)),g=Oe(S=>hI(S,u,r,c)),v=Oe(S=>O$(S,r));if((0,Hc.useLayoutEffect)(()=>{var S;if(!(o!=="auto"||!m||Vk(a)||(0,Hc.isValidElement)(a)||v==null)){var k=i.current,T=k==null||(S=k.tickRefs)===null||S===void 0?void 0:S.current,{tickSize:P,tickMargin:D}=k.props,O=cie({ticks:T,label:s.current,labelGapWithTick:5,tickSize:P,tickMargin:D});Math.round(m.width)!==Math.round(O)&&d(Aoe({id:r,width:O}))}},[i,i==null||(t=i.current)===null||t===void 0||(t=t.tickRefs)===null||t===void 0?void 0:t.current,m==null?void 0:m.width,m,d,a,r,o]),m==null||f==null||v==null)return null;var{dangerouslySetInnerHTML:h,ticks:y}=e,b=uie(e,Y2e),{id:x}=v,w=uie(v,K2e);return Gm.createElement(Uc,E5({},b,w,{ref:i,labelRef:s,scale:p,x:f.x,y:f.y,tickTextProps:o==="auto"?{width:void 0}:{width:o},width:m.width,height:m.height,className:mt("recharts-".concat(u," ").concat(u),n),viewBox:l,ticks:g}))},tje=e=>{var t,r,n,o,a;return Gm.createElement(Gm.Fragment,null,Gm.createElement(Z2e,{interval:(t=e.interval)!==null&&t!==void 0?t:"preserveEnd",id:e.yAxisId,scale:e.scale,type:e.type,domain:e.domain,allowDataOverflow:e.allowDataOverflow,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,padding:e.padding,includeHidden:(r=e.includeHidden)!==null&&r!==void 0?r:!1,reversed:e.reversed,ticks:e.ticks,width:e.width,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:(n=e.angle)!==null&&n!==void 0?n:0,minTickGap:(o=e.minTickGap)!==null&&o!==void 0?o:5,tick:(a=e.tick)!==null&&a!==void 0?a:!0,tickFormatter:e.tickFormatter}),Gm.createElement(eje,e))},rje={allowDataOverflow:Hi.allowDataOverflow,allowDecimals:Hi.allowDecimals,allowDuplicatedCategory:Hi.allowDuplicatedCategory,hide:!1,mirror:Hi.mirror,orientation:Hi.orientation,padding:Hi.padding,reversed:Hi.reversed,scale:Hi.scale,tickCount:Hi.tickCount,type:Hi.type,width:Hi.width,yAxisId:0},ro=class extends Hc.Component{render(){return Gm.createElement(tje,this.props)}};pie(ro,"displayName","YAxis");pie(ro,"defaultProps",rje)});var gie=Ie(fie=>{"use strict";var rS=Y();function nje(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var oje=typeof Object.is=="function"?Object.is:nje,aje=rS.useSyncExternalStore,ije=rS.useRef,sje=rS.useEffect,lje=rS.useMemo,cje=rS.useDebugValue;fie.useSyncExternalStoreWithSelector=function(e,t,r,n,o){var a=ije(null);if(a.current===null){var i={hasValue:!1,value:null};a.current=i}else i=a.current;a=lje(function(){function l(m){if(!c){if(c=!0,d=m,m=n(m),o!==void 0&&i.hasValue){var f=i.value;if(o(f,m))return u=f}return u=m}if(f=u,oje(d,m))return f;var g=n(m);return o!==void 0&&o(f,g)?(d=m,f):(d=m,u=g)}var c=!1,d,u,p=r===void 0?null:r;return[function(){return l(t())},p===null?void 0:function(){return l(p())}]},[t,r,n,o]);var s=aje(e,a[0],a[1]);return sje(function(){i.hasValue=!0,i.value=s},[s]),cje(s),s}});var vie=Ie((Tgt,hie)=>{"use strict";hie.exports=gie()});function fje(e){e()}function gje(){let e=null,t=null;return{clear(){e=null,t=null},notify(){fje(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){let r=[],n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0,o=t={callback:r,next:null,prev:t};return o.prev?o.prev.next=o:e=o,function(){!n||e===null||(n=!1,o.next?o.next.prev=o.prev:t=o.prev,o.prev?o.prev.next=o.next:e=o.next)}}}}function hje(e,t){let r,n=yie,o=0,a=!1;function i(g){d();let v=n.subscribe(g),h=!1;return()=>{h||(h=!0,v(),u())}}function s(){n.notify()}function l(){f.onStateChange&&f.onStateChange()}function c(){return a}function d(){o++,r||(r=t?t.addNestedSub(l):e.subscribe(l),n=gje())}function u(){o--,r&&o===0&&(r(),r=void 0,n.clear(),n=yie)}function p(){a||(a=!0,d())}function m(){a&&(a=!1,u())}let f={addNestedSub:i,notifyNestedSubs:s,handleChangeWrapper:l,isSubscribed:c,trySubscribe:p,tryUnsubscribe:m,getListeners:()=>n};return f}function Cje(){var r;if(!go.createContext)return{};let e=(r=A5[I5])!=null?r:A5[I5]=new Map,t=e.get(go.createContext);return t||(t=go.createContext(null),e.set(go.createContext,t)),t}function Dje(e){let{children:t,context:r,serverState:n,store:o}=e,a=go.useMemo(()=>{let l=hje(o);return{store:o,subscription:l,getServerState:n?()=>n:void 0}},[o,n]),i=go.useMemo(()=>o.getState(),[o]);return kje(()=>{let{subscription:l}=a;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),i!==o.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[a,i]),go.createElement((r||Pje).Provider,{value:a},t)}var go,Eje,dje,uje,pje,mje,yie,vje,yje,bje,xje,wje,kje,Sje,Tje,Cgt,Pgt,I5,A5,Pje,bie,xie=L(()=>{go=q(Y(),1),Eje=q(vie(),1),dje=Symbol.for("react.forward_ref"),uje=Symbol.for("react.memo"),pje=dje,mje=uje;yie={notify(){},get:()=>[]};vje=()=>typeof window!="undefined"&&typeof window.document!="undefined"&&typeof window.document.createElement!="undefined",yje=vje(),bje=()=>typeof navigator!="undefined"&&navigator.product==="ReactNative",xje=bje(),wje=()=>yje||xje?go.useLayoutEffect:go.useEffect,kje=wje(),Sje={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Tje={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},Cgt={[pje]:Sje,[mje]:Tje},Pgt=Object.prototype,I5=Symbol.for("react-redux-context"),A5=typeof globalThis!="undefined"?globalThis:{};Pje=Cje();bie=Dje});var Ije,nS,L5=L(()=>{Pa();Co();Hd();Rl();ih();aI();iI();Ije=(e,t)=>t,nS=ie([Ije,zt,oI,fo,CW,ws,Nre,on],Bre)});var oS,N5=L(()=>{oS=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}}});var M5,F5,vA,O5,j5=L(()=>{oa();Wc();L5();_k();N5();M5=na("mouseClick"),F5=qu();F5.startListening({actionCreator:M5,effect:(e,t)=>{var r=e.payload,n=nS(t.getState(),oS(r));(n==null?void 0:n.activeIndex)!=null&&t.dispatch(fre({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});vA=na("mouseMove"),O5=qu();O5.startListening({actionCreator:vA,effect:(e,t)=>{var r=e.payload,n=t.getState(),o=zk(n,n.tooltip.settings.shared),a=nS(n,oS(r));o==="axis"&&((a==null?void 0:a.activeIndex)!=null?t.dispatch(xI({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate})):t.dispatch(bI()))}})});function wie(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":t}var kie=L(()=>{});var Sie,Tie,Cie,Pie,z5=L(()=>{oa();Sie={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},Tie=hn({name:"rootProps",initialState:Sie,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:Sie.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),Cie=Tie.reducer,{updateOptions:Pie}=Tie.actions});var Die,Ggt,Eie,Iie=L(()=>{oa();Die=hn({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:Ggt}=Die.actions,Eie=Die.reducer});var _5,B5,yA,$5=L(()=>{oa();Wc();Hd();ih();Kl();CI();_5=na("keyDown"),B5=na("focus"),yA=qu();yA.startListening({actionCreator:_5,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:o}=r.tooltip,a=e.payload;if(!(a!=="ArrowRight"&&a!=="ArrowLeft"&&a!=="Enter")){var i=Number(ab(o,$m(r))),s=ws(r);if(a==="Enter"){var l=$k(r,"axis","hover",String(o.index));t.dispatch(kI({active:!o.active,activeIndex:o.index,activeDataKey:o.dataKey,activeCoordinate:l}));return}var c=ore(r),d=c==="left-to-right"?1:-1,u=a==="ArrowRight"?1:-1,p=i+u*d;if(!(s==null||p>=s.length||p<0)){var m=$k(r,"axis","hover",String(p));t.dispatch(kI({active:!0,activeIndex:p.toString(),activeDataKey:void 0,activeCoordinate:m}))}}}}});yA.startListening({actionCreator:B5,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:o}=r.tooltip;if(!o.active&&o.index==null){var a="0",i=$k(r,"axis","hover",String(a));t.dispatch(kI({activeDataKey:void 0,active:!0,activeIndex:a,activeCoordinate:i}))}}}})});var il,W5,R5=L(()=>{oa();Hd();il=na("externalEvent"),W5=qu();W5.startListening({actionCreator:il,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),n={activeCoordinate:Sre(r),activeDataKey:MI(r),activeIndex:Vd(r),activeLabel:NI(r),activeTooltipIndex:Vd(r),isTooltipActive:Tre(r)};e.payload.handler(n,e.payload.reactEvent)}}})});var Aje,Aie,Lie=L(()=>{Pa();EI();II();Aje=ie([rp],e=>e.tooltipItemPayloads),Aie=ie([Aje,Bm,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,n)=>{var o=e.find(s=>s.settings.dataKey===n);if(o!=null){var{positions:a}=o;if(a!=null){var i=t(a,r);return i}}})});var U5,V5,H5=L(()=>{oa();Wc();L5();N5();_k();zD();Lie();U5=na("touchMove"),V5=qu();V5.startListening({actionCreator:U5,effect:(e,t)=>{var r=e.payload,n=t.getState(),o=zk(n,n.tooltip.settings.shared);if(o==="axis"){var a=nS(n,oS({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));(a==null?void 0:a.activeIndex)!=null&&t.dispatch(xI({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate}))}else if(o==="item"){var i,s=r.touches[0],l=document.elementFromPoint(s.clientX,s.clientY);if(!l||!l.getAttribute)return;var c=l.getAttribute(RX),d=(i=l.getAttribute(UX))!==null&&i!==void 0?i:void 0,u=Aie(t.getState(),c,d);t.dispatch(yI({activeDataKey:d,activeIndex:c,activeCoordinate:u}))}}})});var Lje,Nie,Mie=L(()=>{oa();sh();Wc();BI();MD();j5();kie();rA();r5();p5();cae();RD();z5();Jne();Iie();$5();R5();H5();Goe();Lje=hD({brush:lae,cartesianAxis:Loe,chartData:one,errorBars:qoe,graphicalItems:koe,layout:kX,legend:XX,options:Qre,polarAxis:Kne,polarOptions:Eie,referenceElements:yae,rootProps:Cie,tooltip:gre}),Nie=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return nX({reducer:Lje,preloadedState:t,middleware:n=>n({serializableCheck:!1}).concat([F5.middleware,O5.middleware,yA.middleware,W5.middleware,V5.middleware]),devTools:!!window.RECHARTS_DEV_TOOLS_ENABLED&&{serialize:{replacer:wie},name:"recharts-".concat(r)}})}});function jie(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,o=jr(),a=(0,Oie.useRef)(null);if(o)return r;a.current==null&&(a.current=Nie(t,n));var i=K0;return Fie.createElement(bie,{context:i,store:a.current},r)}var Fie,Oie,zie=L(()=>{Fie=q(Y()),Oie=q(Y());xie();Mie();Wi();d_()});function Bie(e){var{layout:t,width:r,height:n,margin:o}=e,a=or(),i=jr();return(0,_ie.useEffect)(()=>{i||(a(bX(t)),a(xX({width:r,height:n})),a(yX(o)))},[a,i,t,r,n,o]),null}var _ie,$ie=L(()=>{_ie=q(Y());Wi();MD();Or()});function Rie(e){var t=or();return(0,Wie.useEffect)(()=>{t(Pie(e))},[t,e]),null}var Wie,Uie=L(()=>{Wie=q(Y());z5();Or()});function Mje(e,t){if(e==null)return{};var r,n,o=Fje(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function Fje(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function bA(){return bA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bA.apply(null,arguments)}var aS,q5,Nje,Oje,jje,zje,G5,Vie=L(()=>{aS=q(Y()),q5=q(Y());Co();eB();Wi();$j();Or();$D();Fd();Nje=["children"];Oje={width:"100%",height:"100%"},jje=(0,q5.forwardRef)((e,t)=>{var r=Ly(),n=Ny(),o=HD();if(!Fy(r)||!Fy(n))return null;var{children:a,otherAttributes:i,title:s,desc:l}=e,c,d;return typeof i.tabIndex=="number"?c=i.tabIndex:c=o?0:void 0,typeof i.role=="string"?d=i.role:d=o?"application":void 0,aS.createElement(U0,bA({},i,{title:s,desc:l,role:d,tabIndex:c,width:r,height:n,style:Oje,ref:t}),a)}),zje=e=>{var{children:t}=e,r=Oe(zg);if(!r)return null;var{width:n,height:o,y:a,x:i}=r;return aS.createElement(U0,{width:n,height:o,x:i,y:a},t)},G5=(0,q5.forwardRef)((e,t)=>{var{children:r}=e,n=Mje(e,Nje),o=jr();return o?aS.createElement(zje,null,r):aS.createElement(jje,bA({ref:t},n),r)})});function Hie(){var e=or(),[t,r]=(0,xA.useState)(null),n=Oe(WX);return(0,xA.useEffect)(()=>{if(t!=null){var o=t.getBoundingClientRect(),a=o.width/t.offsetWidth;Fn(a)&&a!==n&&e(wX(a))}},[t,e,n]),r}var xA,qie=L(()=>{xA=q(Y());Or();Nd();MD();Fd()});function Gie(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function _je(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Gie(Object(r),!0).forEach(function(n){Bje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Gie(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Bje(e,t,r){return(t=$je(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $je(e){var t=Wje(e,"string");return typeof t=="symbol"?t:t+""}function Wje(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wA,Wo,Yie,Kie=L(()=>{wA=q(Y()),Wo=q(Y());Nn();Wc();Or();j5();BW();$5();qie();R5();H5();OW();Uj();Yie=(0,Wo.forwardRef)((e,t)=>{var{children:r,className:n,height:o,onClick:a,onContextMenu:i,onDoubleClick:s,onMouseDown:l,onMouseEnter:c,onMouseLeave:d,onMouseMove:u,onMouseUp:p,onTouchEnd:m,onTouchMove:f,onTouchStart:g,style:v,width:h}=e,y=or(),[b,x]=(0,Wo.useState)(null),[w,S]=(0,Wo.useState)(null);sne();var k=Hie(),T=(0,Wo.useCallback)(_=>{k(_),typeof t=="function"&&t(_),x(_),S(_)},[k,t,x,S]),P=(0,Wo.useCallback)(_=>{y(M5(_)),y(il({handler:a,reactEvent:_}))},[y,a]),D=(0,Wo.useCallback)(_=>{y(vA(_)),y(il({handler:c,reactEvent:_}))},[y,c]),O=(0,Wo.useCallback)(_=>{y(bI()),y(il({handler:d,reactEvent:_}))},[y,d]),z=(0,Wo.useCallback)(_=>{y(vA(_)),y(il({handler:u,reactEvent:_}))},[y,u]),I=(0,Wo.useCallback)(()=>{y(B5())},[y]),A=(0,Wo.useCallback)(_=>{y(_5(_.key))},[y]),j=(0,Wo.useCallback)(_=>{y(il({handler:i,reactEvent:_}))},[y,i]),E=(0,Wo.useCallback)(_=>{y(il({handler:s,reactEvent:_}))},[y,s]),N=(0,Wo.useCallback)(_=>{y(il({handler:l,reactEvent:_}))},[y,l]),B=(0,Wo.useCallback)(_=>{y(il({handler:p,reactEvent:_}))},[y,p]),C=(0,Wo.useCallback)(_=>{y(il({handler:g,reactEvent:_}))},[y,g]),F=(0,Wo.useCallback)(_=>{y(U5(_)),y(il({handler:f,reactEvent:_}))},[y,f]),M=(0,Wo.useCallback)(_=>{y(il({handler:m,reactEvent:_}))},[y,m]);return wA.createElement(FW.Provider,{value:b},wA.createElement(Rj.Provider,{value:w},wA.createElement("div",{className:mt("recharts-wrapper",n),style:_je({position:"relative",cursor:"default",width:h,height:o},v),onClick:P,onContextMenu:j,onDoubleClick:E,onFocus:I,onKeyDown:A,onMouseDown:N,onMouseEnter:D,onMouseLeave:O,onMouseMove:z,onMouseUp:B,onTouchEnd:M,onTouchMove:F,onTouchStart:C,ref:T},r)))})});function Uje(e,t){if(e==null)return{};var r,n,o=Vje(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function Vje(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var iS,Jie,Rje,Xie,Qie=L(()=>{iS=q(Y()),Jie=q(Y());Vie();Kie();m5();Ld();Rje=["children","className","width","height","style","compact","title","desc"];Xie=(0,Jie.forwardRef)((e,t)=>{var{children:r,className:n,width:o,height:a,style:i,compact:s,title:l,desc:c}=e,d=Uje(e,Rje),u=Ga(d);return s?iS.createElement(G5,{otherAttributes:u,title:l,desc:c},r):iS.createElement(Yie,{className:n,style:i,width:o,height:a,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},iS.createElement(G5,{otherAttributes:u,title:l,desc:c,ref:t},iS.createElement(xae,null,r)))})});function Y5(){return Y5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Y5.apply(null,arguments)}function qje(e,t){if(e==null)return{};var r,n,o=Gje(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function Gje(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Tb,Zie,Hje,Yje,Kje,Ym,sS=L(()=>{Tb=q(Y()),Zie=q(Y());zie();aae();$ie();Uie();Qie();Vl();Fd();Hje=["width","height"];Yje={top:5,right:5,bottom:5,left:5},Kje={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:Yje,reverseStackOrder:!1,syncMethod:"index"},Ym=(0,Zie.forwardRef)(function(t,r){var n,o=On(t.categoricalChartProps,Kje),{width:a,height:i}=o,s=qje(o,Hje);if(!Fy(a)||!Fy(i))return null;var{chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:d,tooltipPayloadSearcher:u,categoricalChartProps:p}=t,m={chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:d,tooltipPayloadSearcher:u,eventEmitter:void 0};return Tb.createElement(jie,{preloadedState:{options:m},reduxStoreName:(n=p.id)!==null&&n!==void 0?n:l},Tb.createElement(oae,{chartData:p.data}),Tb.createElement(Bie,{width:a,height:i,layout:o.layout,margin:o.margin}),Tb.createElement(Rie,{accessibilityLayer:o.accessibilityLayer,barCategoryGap:o.barCategoryGap,maxBarSize:o.maxBarSize,stackOffset:o.stackOffset,barGap:o.barGap,barSize:o.barSize,syncId:o.syncId,syncMethod:o.syncMethod,className:o.className}),Tb.createElement(Xie,Y5({},s,{width:a,height:i,ref:r})))})});var ese,tse,Jje,lS,rse=L(()=>{ese=q(Y()),tse=q(Y());sh();sS();Jje=["axis"],lS=(0,tse.forwardRef)((e,t)=>ese.createElement(Ym,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Jje,tooltipPayloadSearcher:Wm,categoricalChartProps:e,ref:t}))});var nse,ose,Xje,mh,ase=L(()=>{nse=q(Y()),ose=q(Y());sh();sS();Xje=["axis","item"],mh=(0,ose.forwardRef)((e,t)=>nse.createElement(Ym,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Xje,tooltipPayloadSearcher:Wm,categoricalChartProps:e,ref:t}))});var ise,sse,Qje,cS,lse=L(()=>{ise=q(Y()),sse=q(Y());sh();sS();Qje=["axis"],cS=(0,sse.forwardRef)((e,t)=>ise.createElement(Ym,{chartName:"AreaChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Qje,tooltipPayloadSearcher:Wm,categoricalChartProps:e,ref:t}))});var cse,dse,Zje,dS,use=L(()=>{cse=q(Y()),dse=q(Y());sh();sS();Zje=["axis"],dS=(0,dse.forwardRef)((e,t)=>cse.createElement(Ym,{chartName:"ComposedChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Zje,tooltipPayloadSearcher:Wm,categoricalChartProps:e,ref:t}))});var Gd=L(()=>{eQ();fne();Tae();zae();w5();T5();d5();lie();mie();rse();ase();lse();use()});var sl,K5,J5,pse,Ia,Yd=L(()=>{sl=q(Y());ym();K5=100,J5=100,pse=(typeof window!="undefined"&&window.JOURNALIT_DEBUG_CHARTS)===!0,Ia=sl.default.memo(({children:e,height:t="100%",width:r="100%",className:n="",style:o={},onChartClick:a})=>{let i=(0,sl.useRef)(null),[s,l]=(0,sl.useState)({width:0,height:0}),[c,d]=(0,sl.useState)(!1),u=typeof t=="number"?`${t}px`:t,m={width:typeof r=="number"?`${r}px`:r,height:u,overflow:"hidden",borderRadius:"8px",minHeight:typeof t=="string"&&t.includes("%")?120:void 0,...o},f=`journalit-chart-container ${n}`.trim(),g=s.width>=K5&&s.height>=J5,v=c&&g;return(0,sl.useEffect)(()=>{let h=i.current;if(!h)return;let y=h.getBoundingClientRect();if(y.width>0&&y.height>0&&(l({width:y.width,height:y.height}),d(!0),pse&&console.log("[ChartBase] initial dimensions",{width:y.width,height:y.height})),typeof ResizeObserver=="undefined"){console.warn("ResizeObserver not available, falling back to immediate render"),c||(l({width:K5,height:J5}),d(!0));return}let b=new ResizeObserver(x=>{for(let w of x){let{width:S,height:k}=w.contentRect;l({width:S,height:k}),d(!0),pse&&console.log("[ChartBase] resize",{width:S,height:k,shouldShowChart:S>=K5&&k>=J5})}});return b.observe(h),()=>{b.unobserve(h),b.disconnect()}},[]),sl.default.createElement("div",{ref:i,className:f,style:m,onClick:a},v?sl.default.cloneElement(e,{width:Math.max(0,Math.floor(s.width)),height:Math.max(0,Math.floor(s.height))}):sl.default.createElement("div",{style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",minHeight:"100px"}},sl.default.createElement(zo,{message:"Loading chart...",size:"small"})))})});var Kd,X5,Cb,kA=L(()=>{Kd=q(Y());Iu();rr();X5=(e,t,r)=>e.type==="text"||typeof e.value=="string"?e.value.toString():typeof e.value=="number"?e.type==="pnl"?Hw(e.value,"pnl",t,r,e.rMultiple):e.type==="drawdown"?Hw(e.value,"drawdown",t):Hw(e.value,"number",t):String(e.value),Cb=Kd.default.memo(({active:e,payload:t,dateKey:r="date",valueKey:n="pnl",valueType:o="pnl",additionalItems:a,formatter:i,displayRMultiples:s})=>{var y,b;let{currency:l}=Ke();if(!e||!t||t.length===0)return null;let c=t[0].payload;if(i){let{title:x,primaryValue:w,items:S}=i(c),k=w.isPositive?Hs.positive:w.isNegative?Hs.negative:"";return Kd.default.createElement("div",{className:Hs.container},Kd.default.createElement("div",{className:Hs.date},x),Kd.default.createElement("div",{className:`${Hs.value} ${k}`},X5(w,l,s)),S==null?void 0:S.map((T,P)=>Kd.default.createElement("div",{key:P,className:Hs.info,style:T.isPositive||T.isNegative?{color:T.isPositive?"var(--chart-positive)":"var(--chart-negative)"}:void 0},T.label,": ",X5(T,l,s))))}let d=c[r],u=c[n],p=(b=(y=c.cumulativeR)!=null?y:c.tradeR)!=null?b:c.rMultiple,m=o==="pnl"?u>=0:!1,f=o==="drawdown"?!0:u<0,g=Hw(u,o,l,s,p),v=m?Hs.positive:f?Hs.negative:"",h=a?a(c):[];return Kd.default.createElement("div",{className:Hs.container},Kd.default.createElement("div",{className:Hs.date},d),Kd.default.createElement("div",{className:`${Hs.value} ${v}`},g),h.map((x,w)=>Kd.default.createElement("div",{key:w,className:Hs.info,style:x.isPositive||x.isNegative?{color:x.isPositive?"var(--chart-positive)":"var(--chart-negative)"}:void 0},x.label,": ",X5(x,l,s))))})});var ht,eze,tze,rze,Km,Jm,Jd,Q5=L(()=>{ht=q(Y());Ut();Gd();Iu();Yd();kA();rr();eze=1e-6,tze=(e,t)=>ht.default.createElement(Cb,{...e,valueKey:"pnl",valueType:"pnl",displayRMultiples:t,additionalItems:r=>r.tradePnL!==0?[{label:"Trade P&L",value:r.tradePnL,type:"pnl",isPositive:r.tradePnL>0,isNegative:r.tradePnL<0,rMultiple:r.tradeR}]:[]}),rze=0,Km="var(--chart-positive, #43a047)",Jm="var(--chart-negative, #e53935)",Jd=ht.default.memo(({data:e,height:t="100%",width:r="100%",minValue:n,maxValue:o,gradientTransitionOffset:a,margin:i={top:6,right:5,left:0,bottom:6},className:s="",style:l={},tooltipProps:c={},showTooltip:d=!0,customTooltip:u,autoRange:p=!0,paddingPercentage:m=.05,fillGradient:f=!0,onChartClick:g,onPointClick:v,plugin:h})=>{var E,N,B;let{currency:y}=Ke(),b=(typeof window!="undefined"&&window.JOURNALIT_DEBUG_CHARTS)===!0,x=(B=(N=(E=h==null?void 0:h.settings)==null?void 0:E.trade)==null?void 0:N.displayRMultiples)!=null?B:!1,w=(0,ht.useMemo)(()=>`pnl-chart-${++rze}`,[]),S=(0,ht.useMemo)(()=>{let C=Math.min(...e.map(M=>M.pnl)),F=Math.max(...e.map(M=>M.pnl));return{dataMin:C,dataMax:F}},[e]),k=(0,ht.useMemo)(()=>{let C=new Map;return e.forEach(F=>{C.set(F.dateKey,F.date)}),C},[e]),T=(0,ht.useCallback)(C=>{if(!x||e.length===0)return;let F=e[0],M=e[e.length-1];for(let _=0;_<e.length-1;_++)if(e[_].pnl<=C&&e[_+1].pnl>=C){F=e[_],M=e[_+1];break}if(F.cumulativeR!==void 0&&M.cumulativeR!==void 0){let _=M.pnl-F.pnl;if(Math.abs(_)<eze)return F.cumulativeR;let W=(C-F.pnl)/_;return F.cumulativeR+W*(M.cumulativeR-F.cumulativeR)}},[x,e]),P=(0,ht.useMemo)(()=>{let{dataMin:C,dataMax:F}=S,[M,_]=UH(C,F,n,o,m),W=_;if(F-C>0&&o===void 0)if(F>1e3){let R=F>1e4?1e3:500,V=Math.ceil(F/R)*R;W=Math.min(V,F*1.1)}else W=F*1.05;let H=a;if(H===void 0){let R=W-M;if(R!==0&&!isNaN(R)&&!isNaN(W)&&!isNaN(M)){let V=(W-0)/R*100;H=isNaN(V)?50:V}else isNaN(W)?H=50:H=W<0?100:0;H=Math.max(0,Math.min(100,H))}return{actualMinValue:M,adjustedMaxValue:W,actualTransitionOffset:H}},[S,n,o,a,m]),{actualMinValue:D,adjustedMaxValue:O,actualTransitionOffset:z}=P;(0,ht.useEffect)(()=>{var C;b&&console.log("[SharedPnLChart] data len/domain",{length:(C=e==null?void 0:e.length)!=null?C:0,domain:[D,O],offset:z})},[b,e==null?void 0:e.length,D,O,z]);let I=`url(#${w}-gradientDual)`,A=`url(#${w}-strokeGradient)`;D>=0&&O>=0?I=`url(#${w}-gradientPositive)`:O<=0&&D<=0&&(I=`url(#${w}-gradientNegative)`);let j=C=>{if(g&&g(C),v&&C&&C.activePayload&&C.activePayload.length>0){let F=C.activePayload[0].payload,M=e.findIndex(_=>_===F);M!==-1&&v(F,M)}};return ht.default.createElement(Ia,{height:t,width:r,className:s,style:l,onChartClick:j},ht.default.createElement(cS,{data:e,margin:i,onClick:j},ht.default.createElement("defs",null,ht.default.createElement("linearGradient",{id:`${w}-gradientPositive`,x1:"0",y1:"1",x2:"0",y2:"0"},ht.default.createElement("stop",{offset:"0%",stopColor:Km,stopOpacity:.1}),ht.default.createElement("stop",{offset:"100%",stopColor:Km,stopOpacity:.4})),ht.default.createElement("linearGradient",{id:`${w}-gradientNegative`,x1:"0",y1:"0",x2:"0",y2:"1"},ht.default.createElement("stop",{offset:"0%",stopColor:Jm,stopOpacity:.1}),ht.default.createElement("stop",{offset:"100%",stopColor:Jm,stopOpacity:.4})),ht.default.createElement("linearGradient",{id:`${w}-gradientDual`,x1:"0",y1:"0",x2:"0",y2:"1"},ht.default.createElement("stop",{offset:"0%",stopColor:Km,stopOpacity:.4}),ht.default.createElement("stop",{offset:`${z}%`,stopColor:Km,stopOpacity:.1}),ht.default.createElement("stop",{offset:`${z}%`,stopColor:Jm,stopOpacity:.1}),ht.default.createElement("stop",{offset:"100%",stopColor:Jm,stopOpacity:.4})),ht.default.createElement("linearGradient",{id:`${w}-strokeGradient`,x1:"0",y1:"0",x2:"0",y2:"1"},z<=.1?ht.default.createElement(ht.default.Fragment,null,ht.default.createElement("stop",{offset:"0%",stopColor:Jm}),ht.default.createElement("stop",{offset:"100%",stopColor:Jm})):z>=99.9?ht.default.createElement(ht.default.Fragment,null,ht.default.createElement("stop",{offset:"0%",stopColor:Km}),ht.default.createElement("stop",{offset:"100%",stopColor:Km})):ht.default.createElement(ht.default.Fragment,null,ht.default.createElement("stop",{offset:"0%",stopColor:Km}),ht.default.createElement("stop",{offset:`${Math.max(.1,z-.1)}%`,stopColor:Km}),ht.default.createElement("stop",{offset:`${Math.min(99.9,z+.1)}%`,stopColor:Jm}),ht.default.createElement("stop",{offset:"100%",stopColor:Jm}))),ht.default.createElement("filter",{id:`${w}-shadow`,height:"120%"},ht.default.createElement("feDropShadow",{dx:"0",dy:"1",stdDeviation:"2",floodOpacity:"0.1"})),ht.default.createElement("filter",{id:`${w}-glow`,height:"130%"},ht.default.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"2",result:"blur"}),ht.default.createElement("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7",result:"glow"}),ht.default.createElement("feComposite",{in:"SourceGraphic",in2:"glow",operator:"over"}))),ht.default.createElement($o,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),ht.default.createElement(Tn,{y:0,stroke:"var(--text-normal, #888888)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1.5,ifOverflow:"extendDomain"}),ht.default.createElement(to,{dataKey:"dateKey",style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:8,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5},tickFormatter:C=>{var M;let F=String(C);return(M=k.get(F))!=null?M:F}}),ht.default.createElement(ro,{tickFormatter:C=>{let F=T(C);return ve(C,!0,y,x,F)},style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:[D,O],allowDataOverflow:!1,width:75,ticks:fv(D,O,5),scale:"linear",tickLine:!0,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.3},tickMargin:5}),d&&ht.default.createElement(ia,{content:u||(C=>tze(C,x)),cursor:{fill:"var(--interactive-hover)",fillOpacity:.1,strokeOpacity:.3,strokeWidth:1,stroke:"var(--interactive-accent)"},wrapperStyle:{zIndex:1e3},...c}),ht.default.createElement(Vc,{type:"monotone",dataKey:"pnl",stroke:A,strokeWidth:2.5,fill:f?I:"none",dot:!1,activeDot:{r:7,strokeWidth:1,stroke:"var(--background-primary)",fill:"var(--interactive-accent, #4299e1)",filter:`url(#${w}-glow)`},animationDuration:500,animationEasing:"ease-out",filter:`url(#${w}-shadow)`})))});Jd.displayName="SharedPnLChart"});var zn,nze,lp,mse=L(()=>{zn=q(Y());Gd();Iu();Yd();kA();nze=(e,t,r)=>zn.default.createElement(Cb,{...e,valueKey:"drawdown",valueType:"drawdown",displayRMultiples:t,additionalItems:n=>[{label:"P&L",value:n.pnl,type:"pnl",isPositive:n.pnl>0,isNegative:n.pnl<0,rMultiple:n.rMultiple},{label:"Peak Equity",value:n.peakEquity,type:"pnl",rMultiple:n.peakEquity&&r&&r>0?n.peakEquity/r:void 0}]}),lp=zn.default.memo(({data:e,height:t="100%",width:r="100%",minValue:n,maxValue:o,margin:a={top:6,right:5,left:0,bottom:6},className:i="",style:s={},tooltipProps:l={},showTooltip:c=!0,customTooltip:d,autoRange:u=!0,paddingPercentage:p=.05,onChartClick:m,onPointClick:f,plugin:g})=>{var T,P,D,O,z;let v=(D=(P=(T=g==null?void 0:g.settings)==null?void 0:T.trade)==null?void 0:P.displayRMultiples)!=null?D:!1,h=(z=(O=g==null?void 0:g.settings)==null?void 0:O.trade)==null?void 0:z.defaultRiskAmount,y=(0,zn.useMemo)(()=>{let I=Math.min(...e.map(N=>N.drawdown)),A=o!==void 0?o:0,j=n!==void 0?n:Math.min(0,I);if(I<0&&n===void 0){let N=Math.abs(I)*p;j=Math.min(j,I-N),I>-20&&(j=Math.max(j,I*1.15))}return{yAxisMax:A,yAxisMin:j,negativeColor:"var(--text-error, #e53935)"}},[e,n,o,p]),{yAxisMax:b,yAxisMin:x,negativeColor:w}=y,S=(0,zn.useMemo)(()=>{let I=new Map;return e.forEach(A=>{I.set(A.dateKey,A.date)}),I},[e]),k=I=>{if(m&&m(I),f&&I&&I.activePayload&&I.activePayload.length>0){let A=I.activePayload[0].payload,j=e.findIndex(E=>E===A);j!==-1&&f(A,j)}};return zn.default.createElement(Ia,{height:t,width:r,className:i,style:s,onChartClick:k},zn.default.createElement(cS,{data:e,margin:a,onClick:k},zn.default.createElement("defs",null,zn.default.createElement("linearGradient",{id:"drawdownGradient",x1:"0",y1:"0",x2:"0",y2:"1"},zn.default.createElement("stop",{offset:"0%",stopColor:w,stopOpacity:.1}),zn.default.createElement("stop",{offset:"100%",stopColor:w,stopOpacity:.4})),zn.default.createElement("filter",{id:"drawdown-shadow",height:"120%"},zn.default.createElement("feDropShadow",{dx:"0",dy:"1",stdDeviation:"2",floodOpacity:"0.1"})),zn.default.createElement("filter",{id:"drawdown-glow",height:"130%"},zn.default.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"2",result:"blur"}),zn.default.createElement("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7",result:"glow"}),zn.default.createElement("feComposite",{in:"SourceGraphic",in2:"glow",operator:"over"}))),zn.default.createElement($o,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),zn.default.createElement(Tn,{y:0,stroke:"var(--text-normal, #888888)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1.5,ifOverflow:"extendDomain"}),zn.default.createElement(to,{dataKey:"dateKey",style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:8,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5},tickFormatter:I=>{var j;let A=String(I);return(j=S.get(A))!=null?j:A}}),zn.default.createElement(ro,{tickFormatter:I=>tO(I),style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:[x,b],allowDataOverflow:!1,width:75,ticks:fv(x,b,5),scale:"linear",tickLine:!0,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.3},tickMargin:5}),c&&zn.default.createElement(ia,{content:d||(I=>nze(I,v,h)),cursor:{fill:"var(--interactive-hover)",fillOpacity:.1,strokeOpacity:.3,strokeWidth:1,stroke:"var(--interactive-accent)"},wrapperStyle:{zIndex:1e3},...l}),zn.default.createElement(Vc,{type:"monotone",dataKey:"drawdown",stroke:w,strokeWidth:2.5,fill:"url(#drawdownGradient)",fillOpacity:.4,dot:!1,activeDot:{r:7,strokeWidth:1,stroke:"var(--background-primary)",fill:w,filter:"url(#drawdown-glow)"},animationDuration:1e3,animationEasing:"ease-out",filter:"url(#drawdown-shadow)"})))})});var Io,oze,uS,fse=L(()=>{Io=q(Y());Ut();Gd();eo();Iu();Yd();kA();rr();pt();oze=(e,t)=>{if(!e.active||!e.payload||e.payload.length===0)return null;let r=e.payload[0].payload,n=r.entryTime?new Date(r.entryTime).toLocaleString():"Unknown",o=r.exitTime?new Date(r.exitTime).toLocaleString():"Unknown";return Io.default.createElement(Cb,{...e,displayRMultiples:t,formatter:a=>{var i;return{title:a.instrument?`${a.instrument} ${((i=a.direction)==null?void 0:i.toLowerCase())==="long"?"\u2191":"\u2193"}`:`Trade #${a.tradeIndex+1}`,primaryValue:{value:a.pnl,type:"pnl",isPositive:a.pnl>=0,isNegative:a.pnl<0,rMultiple:a.rMultiple},items:[{label:"Entry",value:n,type:"text"},{label:"Exit",value:o,type:"text"},{label:"Trade",value:`#${a.tradeIndex+1}`,type:"text"}]}}})},uS=({data:e,height:t="100%",width:r="100%",minValue:n,maxValue:o,margin:a={top:6,right:5,left:0,bottom:6},className:i="",style:s={},tooltipProps:l={},showTooltip:c=!0,customTooltip:d,autoRange:u=!0,paddingPercentage:p=.05,onChartClick:m,onPointClick:f})=>{var O,z,I,A;let{currency:g}=Ke(),v=xe(),h=(z=(O=v==null?void 0:v.settings)==null?void 0:O.trade)==null?void 0:z.displayRMultiples,y=(A=(I=v==null?void 0:v.settings)==null?void 0:I.trade)==null?void 0:A.defaultRiskAmount,b=j=>{if(!h||!y||y===0)return ve(j,!0,g,!1,void 0);let E=j/y;return ve(j,!0,g,!0,E)},x=Io.default.useMemo(()=>{let j=Math.min(...e.map(N=>N.pnl)),E=Math.max(...e.map(N=>N.pnl));return{dataMin:j,dataMax:E}},[e]),{dataMin:w,dataMax:S}=x,k=n!==void 0?n:Math.min(0,w),T=o!==void 0?o:Math.max(0,S),P=S-w;if(w<0&&n===void 0){let j=Math.max(Math.abs(w)*.02,10);k=Math.min(k,w-j)}if(S>0&&o===void 0){let j=Math.max(S*.02,10);T=Math.max(T,S+j)}if(S>0&&o===void 0){let j=Math.pow(10,Math.floor(Math.log10(S))),E;if(S>1e3){let N=S>5e3?1e3:500;E=Math.ceil(S/N)*N}else S>100?E=Math.ceil(S/100)*100:S>10?E=Math.ceil(S/10)*10:E=Math.ceil(S*1.05);E=Math.min(E,S*1.1),T=Math.min(T,E)}if(w<0&&n===void 0){let j=Math.pow(10,Math.floor(Math.log10(Math.abs(w)))),E;if(Math.abs(w)>1e3){let N=Math.abs(w)>5e3?1e3:500;E=Math.floor(w/N)*N}else Math.abs(w)>100?E=Math.floor(w/100)*100:Math.abs(w)>10?E=Math.floor(w/10)*10:E=Math.floor(w*1.05);E=Math.max(E,w*1.1),k=Math.max(k,E)}if(e.length===0)return Io.default.createElement("div",{style:{width:"100%",height:typeof t=="number"?`${t}px`:t,display:"flex",justifyContent:"center",alignItems:"center"}},Io.default.createElement(et,{message:"No trades available",subMessage:"Try selecting a different time period",iconSize:36}));let D=(j,E,N)=>{f&&f(E,N)};return Io.default.createElement(Ia,{height:t,width:r,className:i,style:s,onChartClick:m},Io.default.createElement(mh,{data:e,margin:a},Io.default.createElement("defs",null,Io.default.createElement("filter",{id:"tradesChartBarShadow",height:"130%"},Io.default.createElement("feDropShadow",{dx:"0",dy:"2",stdDeviation:"2",floodOpacity:"0.1"})),Io.default.createElement("filter",{id:"tradesChartBarGlow",height:"130%"},Io.default.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"1.5",result:"blur"}),Io.default.createElement("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7",result:"glow"}),Io.default.createElement("feComposite",{in:"SourceGraphic",in2:"glow",operator:"over"}))),Io.default.createElement($o,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),Io.default.createElement(Tn,{y:0,stroke:"var(--text-normal, #888888)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1.5,ifOverflow:"extendDomain"}),Io.default.createElement(to,{dataKey:"tradeIndex",tickFormatter:j=>`#${j+1}`,style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:8,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5}}),Io.default.createElement(ro,{tickFormatter:b,style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:[k,T],allowDataOverflow:!1,width:75,ticks:fv(k,T,5),interval:"preserveStartEnd",scale:"linear",tickLine:!1,axisLine:!1,tickMargin:5}),c&&Io.default.createElement(ia,{content:d||(j=>oze(j,h)),cursor:{fill:"var(--interactive-hover)",fillOpacity:.1,strokeOpacity:.3,strokeWidth:1,stroke:"var(--interactive-accent)"},wrapperStyle:{zIndex:1e3},...l}),Io.default.createElement(qm,{dataKey:"pnl",fill:"var(--interactive-accent)",minPointSize:5,isAnimationActive:!0,animationDuration:800,animationEasing:"ease-out",stroke:"var(--background-primary)",strokeWidth:.8,strokeOpacity:.5,filter:"url(#tradesChartBarShadow)",radius:[2,2,0,0],activeBar:{filter:"url(#tradesChartBarGlow)",strokeWidth:1.2,strokeOpacity:.8},shape:j=>{var G,U;let{x:E,y:N,width:B,height:C}=j,M=(((G=j.payload)==null?void 0:G.pnl)||0)>=0,_=((U=j.payload)==null?void 0:U.fill)||(M?"var(--chart-positive)":"var(--chart-negative)"),W=E||0,$=N||0,H=B||0,R=C||0,V=R<0?Math.abs(R):R,Z=R<0?$+R:$,K;M?K=[2,2,0,0]:K=[0,0,2,2];let X=j.index||0;return Io.default.createElement("rect",{x:W,y:Z,width:H,height:V>0?V:0,fill:_,stroke:j.stroke,strokeWidth:j.strokeWidth,strokeOpacity:j.strokeOpacity,filter:M?j.filter:"none",rx:K[0],ry:K[0],onClick:Q=>D(Q,j.payload,X)})}})))}});var no,aze,ize,sze,Z5,gse=L(()=>{no=q(Y());Ut();Gd();rr();pt();Yd();aze=1e-6,ize=(e,t,r)=>{let n=[],o=t-e,a=o/(r-1),i=Math.pow(10,Math.floor(Math.log10(a))),s;a/i<1.5?s=i:a/i<3.5?s=2*i:a/i<7.5?s=5*i:s=10*i,o<10*i&&s>i&&(s=i);let l=Math.floor(e/s)*s,c=Math.ceil(t/s)*s;for(let d=l;d<=c;d+=s){let u=parseFloat(d.toFixed(12));n.push(u)}return e<=0&&0<=t&&!n.includes(0)&&n.push(0),[...new Set(n)].sort((d,u)=>d-u)},sze=({active:e,payload:t})=>{var l,c,d;let{currency:r}=Ke(),n=xe();if(!e||!t||t.length===0)return null;let o=t[0].payload,a=o.pnl>=0,i=(d=(c=(l=n==null?void 0:n.settings)==null?void 0:l.trade)==null?void 0:c.displayRMultiples)!=null?d:!1,s=ve(o.pnl,!0,r,i,o.rMultiple);return no.default.createElement("div",{className:"journalit-chart-tooltip",style:{backgroundColor:"var(--background-primary)",borderRadius:"10px",padding:"14px 18px",minWidth:"140px",border:"1px solid var(--background-modifier-border)",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.2)",transform:"translateY(-4px)",position:"relative",animation:"tooltipFadeIn 0.2s cubic-bezier(0.19, 1, 0.22, 1)"}},no.default.createElement("div",{className:"journalit-chart-tooltip-date",style:{fontSize:"14px",fontWeight:500,color:"var(--text-normal)",marginBottom:"8px",textAlign:"center",borderBottom:"1px solid var(--background-modifier-border)",paddingBottom:"6px"}},o.date),no.default.createElement("div",{className:`journalit-chart-tooltip-value ${a?"positive":"negative"}`,style:{fontSize:"20px",fontWeight:600,textAlign:"center",color:a?"var(--chart-positive)":"var(--chart-negative)"}},s),o.trades!==void 0&&no.default.createElement("div",{className:"journalit-chart-tooltip-info",style:{fontSize:"12px",color:"var(--text-muted)",marginTop:"8px",textAlign:"center",fontStyle:"italic"}},o.trades," ",o.trades===1?"trade":"trades"))},Z5=no.default.memo(({data:e,height:t="100%",minValue:r,maxValue:n})=>{var f,g,v;let{currency:o}=Ke(),a=xe(),i=(v=(g=(f=a==null?void 0:a.settings)==null?void 0:f.trade)==null?void 0:g.displayRMultiples)!=null?v:!1,s=no.default.useMemo(()=>e.length===0?null:e.reduce((h,y)=>Math.abs(y.pnl)>Math.abs(h.pnl)?y:h,e[0]),[e]),l=Math.min(...e.map(h=>h.pnl)),c=Math.max(...e.map(h=>h.pnl)),d=r!==void 0?r:Math.min(0,l),u=n!==void 0?n:Math.max(0,c);if(l<0){let h=Math.abs(l)*.05;d=r!==void 0?r:Math.min(d,l-h)}if(c>0){let h=c*.05;u=n!==void 0?n:Math.max(u,c+h)}let p=c-l;p>0&&p<100&&(d=Math.max(d,l-p*.03),u=Math.min(u,c+p*.03));let m=typeof t=="number"?`${t}px`:t;return no.default.createElement(Ia,{height:t,width:"100%",style:{borderRadius:"8px"}},no.default.createElement(mh,{data:e,margin:{top:6,right:5,left:0,bottom:6}},no.default.createElement("defs",null,no.default.createElement("filter",{id:"dailyPerformanceBarShadow",height:"130%"},no.default.createElement("feDropShadow",{dx:"0",dy:"2",stdDeviation:"2",floodOpacity:"0.1"})),no.default.createElement("filter",{id:"dailyPerformanceBarGlow",height:"130%"},no.default.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"1.5",result:"blur"}),no.default.createElement("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7",result:"glow"}),no.default.createElement("feComposite",{in:"SourceGraphic",in2:"glow",operator:"over"}))),no.default.createElement($o,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),no.default.createElement(Tn,{y:0,stroke:"var(--text-normal, #888888)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1.5,ifOverflow:"extendDomain"}),no.default.createElement(to,{dataKey:"date",style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:8,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5}}),no.default.createElement(ro,{tickFormatter:h=>{if(!i)return ve(h,!0,o,!1,void 0);if(!s||Math.abs(s.pnl)<aze||!s.rMultiple)return ve(h,!0,o,!0,void 0);let b=h/s.pnl*s.rMultiple;return ve(h,!0,o,!0,b)},style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:[d,u],allowDataOverflow:!1,width:75,ticks:ize(d,u,5),scale:"linear",tickLine:!1,axisLine:!1,tickMargin:5}),no.default.createElement(ia,{content:no.default.createElement(sze,null),cursor:{fill:"var(--interactive-hover)",fillOpacity:.1,strokeOpacity:.3,strokeWidth:1,stroke:"var(--interactive-accent)"},wrapperStyle:{zIndex:1e3}}),no.default.createElement(qm,{dataKey:"pnl",fill:"var(--interactive-accent)",minPointSize:5,isAnimationActive:!0,animationDuration:800,animationEasing:"ease-out",stroke:"var(--background-primary)",strokeWidth:.8,strokeOpacity:.5,filter:"url(#dailyPerformanceBarShadow)",radius:[2,2,0,0],activeBar:{filter:"url(#dailyPerformanceBarGlow)",strokeWidth:1.2,strokeOpacity:.8}})))})});var _n,lze,cze,dze,pS,hse=L(()=>{_n=q(Y());Ut();Gd();rr();Yd();lze=1e-6,cze=(e,t=10)=>e.length<=t?e:e.substring(0,t-1)+"\u2026",dze=({active:e,payload:t,plugin:r})=>{var l,c,d;let{currency:n}=Ke();if(!e||!t||t.length===0)return null;let o=t[0].payload,a=o.pnl>=0,i=(d=(c=(l=r==null?void 0:r.settings)==null?void 0:l.trade)==null?void 0:c.displayRMultiples)!=null?d:!1,s=ve(o.pnl,!0,n,i,o.totalRMultiple);return _n.default.createElement("div",{className:"journalit-chart-tooltip",style:{backgroundColor:"var(--background-primary)",borderRadius:"10px",padding:"14px 18px",minWidth:"140px",border:"1px solid var(--background-modifier-border)",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.2)",transform:"translateY(-4px)",position:"relative"}},_n.default.createElement("div",{className:"journalit-chart-tooltip-setup",style:{fontSize:"14px",fontWeight:500,color:"var(--text-normal)",marginBottom:"8px",textAlign:"center",borderBottom:"1px solid var(--background-modifier-border)",paddingBottom:"6px"}},o.name),_n.default.createElement("div",{className:`journalit-chart-tooltip-value ${a?"positive":"negative"}`,style:{fontSize:"20px",fontWeight:600,textAlign:"center",color:a?"var(--chart-positive)":"var(--chart-negative)"}},s),_n.default.createElement("div",{className:"journalit-chart-tooltip-info",style:{fontSize:"12px",color:"var(--text-muted)",marginTop:"8px",textAlign:"center",fontStyle:"italic"}},"Win Rate: ",o.winRate.toFixed(1),"%"),_n.default.createElement("div",{className:"journalit-chart-tooltip-info",style:{fontSize:"12px",color:"var(--text-muted)",marginTop:"4px",textAlign:"center",fontStyle:"italic"}},o.tradeCount," ",o.tradeCount===1?"trade":"trades"))},pS=({data:e,height:t="100%",minValue:r,maxValue:n,plugin:o})=>{var f,g,v;let{currency:a}=Ke(),i=(v=(g=(f=o==null?void 0:o.settings)==null?void 0:f.trade)==null?void 0:g.displayRMultiples)!=null?v:!1,s=_n.default.useMemo(()=>e.length===0?null:e.reduce((h,y)=>Math.abs(y.pnl)>Math.abs(h.pnl)?y:h,e[0]),[e]),l=Math.min(...e.map(h=>h.pnl)),c=Math.max(...e.map(h=>h.pnl)),d=r!==void 0?r:Math.min(0,l),u=n!==void 0?n:Math.max(1,c);if(l<0){let h=Math.abs(l)*.05;d=r!==void 0?r:Math.min(d,l-h)}if(c>0){let h=c*.05;u=n!==void 0?n:Math.max(u,c+h)}let p=c-l;if(p>0&&e.length<=5){let h=p*.03,y=p*.03;d=Math.max(d,l-h),u=Math.min(u,c+y)}let m=typeof t=="number"?`${t}px`:t;return _n.default.createElement(Ia,{height:t,width:"100%",style:{borderRadius:"8px"}},_n.default.createElement(mh,{data:e,margin:{top:6,right:5,left:0,bottom:6}},_n.default.createElement("defs",null,_n.default.createElement("filter",{id:"setup-bar-shadow",height:"130%"},_n.default.createElement("feDropShadow",{dx:"0",dy:"2",stdDeviation:"2",floodOpacity:"0.1"})),_n.default.createElement("filter",{id:"setup-bar-glow",height:"130%"},_n.default.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"1.5",result:"blur"}),_n.default.createElement("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7",result:"glow"}),_n.default.createElement("feComposite",{in:"SourceGraphic",in2:"glow",operator:"over"}))),_n.default.createElement($o,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),_n.default.createElement(Tn,{y:0,stroke:"var(--text-normal, #888888)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1.5,ifOverflow:"extendDomain"}),_n.default.createElement(to,{dataKey:"name",style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:8,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5},tickFormatter:h=>cze(h),interval:0}),_n.default.createElement(ro,{tickFormatter:h=>{if(!i)return ve(h,!0,a,!1,void 0);if(!s||Math.abs(s.pnl)<lze||!s.totalRMultiple)return ve(h,!0,a,!0,void 0);let b=h/s.pnl*s.totalRMultiple;return ve(h,!0,a,!0,b)},style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:[d,u],allowDataOverflow:!1,width:75,scale:"linear",tickLine:!1,axisLine:!1,tickMargin:5}),_n.default.createElement(ia,{content:_n.default.createElement(dze,{plugin:o}),cursor:{fill:"var(--interactive-hover)",fillOpacity:.1,strokeOpacity:.3,strokeWidth:1,stroke:"var(--interactive-accent)"},wrapperStyle:{zIndex:1e3}}),_n.default.createElement(qm,{dataKey:"pnl",fill:"var(--interactive-accent)",minPointSize:0,isAnimationActive:!0,animationDuration:800,animationEasing:"ease-out",stroke:"var(--background-primary)",strokeWidth:.8,strokeOpacity:.5,filter:"url(#setup-bar-shadow)",radius:[2,2,0,0],activeBar:{filter:"url(#setup-bar-glow)",strokeWidth:1.2,strokeOpacity:.8},shape:h=>{let y=h.payload&&h.payload.pnl>=0,b=y?"var(--chart-positive)":"var(--chart-negative)",{x,y:w,width:S,height:k}=h,T=x||0,P=w||0,D=S||0,O=k||0,z=O<0?Math.abs(O):O,I=O<0?P+O:P,A=y?[2,2,0,0]:[0,0,2,2];return _n.default.createElement("rect",{x:T,y:I,width:D,height:z>0?z:0,fill:b,stroke:h.stroke,strokeWidth:h.strokeWidth,strokeOpacity:h.strokeOpacity,filter:h.filter,rx:A[0],ry:A[0]})}})))}});function pze(e){if(!e)return!1;let t=new Date,r=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`;return e===r}var Ot,vse,SA,uze,yse=L(()=>{Ot=q(Y());pt();Ut();tg();s0();rr();om();vse=(0,Ot.memo)(({day:e,dayIndex:t,onClick:r,displayRMultiples:n})=>{var s;let{currency:o}=Ke(),a=(0,Ot.useCallback)(()=>{e.date&&r(e.date)},[e.date,r]),i=["journalit-dashboard-calendar-day",e.currentMonth?"current-month":"other-month",e.pnl!==null&&e.pnl>0?"positive":"",e.pnl!==null&&e.pnl<0?"negative":"",t===5||t===6?"weekend-day":"",e.isToday?"today":""].filter(Boolean).join(" ");return Ot.default.createElement("div",{className:i,onClick:a},Ot.default.createElement("div",{className:"journalit-dashboard-calendar-day-number"},e.dayNumber||""),e.pnl!==null&&Ot.default.createElement("div",{className:"journalit-dashboard-calendar-day-pnl"},ve(e.pnl,!1,o,n,(s=e.rMultiple)!=null?s:void 0)),e.tradeCount>0&&Ot.default.createElement("div",{className:"journalit-dashboard-calendar-day-trades"},e.tradeCount===1?"1 trade":`${e.tradeCount} trades`))});vse.displayName="CalendarDay";SA=(0,Ot.memo)(({trades:e,filters:t,onDayClick:r,onWeekClick:n,height:o="100%"})=>{var w,S,k,T,P,D,O,z,I;let a=xe(),{currency:i}=Ke(),s=(0,Ot.useMemo)(()=>{var A,j,E;return(E=(j=(A=a==null?void 0:a.settings)==null?void 0:A.trade)==null?void 0:j.skipWeekends)!=null?E:!0},[(S=(w=a==null?void 0:a.settings)==null?void 0:w.trade)==null?void 0:S.skipWeekends]),l=(P=(T=(k=a==null?void 0:a.settings)==null?void 0:k.trade)==null?void 0:T.showCopyTradingPnL)!=null?P:!1,c=(0,Ot.useMemo)(()=>{var A,j,E;return(E=(j=(A=a==null?void 0:a.settings)==null?void 0:A.trade)==null?void 0:j.displayRMultiples)!=null?E:!1},[(O=(D=a==null?void 0:a.settings)==null?void 0:D.trade)==null?void 0:O.displayRMultiples]),d=(0,Ot.useMemo)(()=>{var A,j;return(j=(A=a==null?void 0:a.settings)==null?void 0:A.trade)==null?void 0:j.defaultRiskAmount},[(I=(z=a==null?void 0:a.settings)==null?void 0:z.trade)==null?void 0:I.defaultRiskAmount]),u=(0,Ot.useRef)(null);(0,Ot.useEffect)(()=>{let A=null;return A=requestAnimationFrame(()=>{u.current&&(Object.assign(u.current.style,{width:"100%",height:"100%"}),i0(),Al(),a0())}),()=>{A!==null&&cancelAnimationFrame(A),window.__journalitCalendarResizeObserver&&window.__journalitCalendarResizeObserver.disconnect()}},[]),(0,Ot.useEffect)(()=>{let A=()=>{u.current&&Al()};return document.addEventListener("layout-changed",A),()=>{document.removeEventListener("layout-changed",A)}},[]);let p={},m={},f={};e.forEach(A=>{let j;try{if(A.entryTime instanceof Date)j=A.entryTime;else if(j=new Date(A.entryTime),isNaN(j.getTime()))return}catch($){return}if(x0(A))return;let E=A;if(E.isMissedTrade===!0||E.isBacktestTrade===!0||!A.instrument)return;let N=j.getFullYear(),B=String(j.getMonth()+1).padStart(2,"0"),C=String(j.getDate()).padStart(2,"0"),F=`${N}-${B}-${C}`;p[F]||(p[F]=0,m[F]=0,f[F]=0);let M=Il(A),_=El(A.pnl,M,l);p[F]+=_,m[F]++;let W=st(_,A.rMultiple,A.riskAmount,d);W!==void 0&&!isNaN(W)&&(f[F]+=W)});let{gridStartDate:g,gridEndDate:v}=(0,Ot.useMemo)(()=>{var C,F,M,_,W;let A,j,E=new Date,N=E.getFullYear(),B=E.getMonth();return!((C=t==null?void 0:t.dateRange)!=null&&C[0])&&!((F=t==null?void 0:t.dateRange)!=null&&F[1])?(A=new Date(N,B,1),j=new Date(N,B+1,0)):(M=t==null?void 0:t.dateRange)!=null&&M[0]&&t.dateRange[0].getFullYear()===N&&t.dateRange[0].getMonth()===0&&t.dateRange[0].getDate()===1?(A=new Date(N,0,1),j=new Date(N,11,31)):(A=((_=t==null?void 0:t.dateRange)==null?void 0:_[0])||(e.length>0?new Date(Math.min(...e.map($=>{let H=$.entryTime instanceof Date?$.entryTime:new Date($.entryTime);return isNaN(H.getTime())?Date.now():H.getTime()}))):E),j=((W=t==null?void 0:t.dateRange)==null?void 0:W[1])||E),A>j&&(A=new Date(j),A.setDate(1),console.warn("Calendar: Corrected invalid date range where start date was after end date.")),{gridStartDate:A,gridEndDate:j}},[t==null?void 0:t.dateRange,e]),h=uze(g,v,p,m,f),y=(0,Ot.useMemo)(()=>g.getFullYear()!==v.getFullYear()?!0:g.getMonth()!==v.getMonth(),[g,v]),b=A=>{var E;let j=`${A.getFullYear()}-${String(A.getMonth()+1).padStart(2,"0")}-${String(A.getDate()).padStart(2,"0")}`;p[j]&&r?r(A):p[j]&&a&&((E=a.drcService)==null||E.openDRC(A))},x=A=>{if(n)n(A);else if(a){let j=A;a.weeklyReviewService?a.weeklyReviewService.openWeeklyReview(j):a.drcService&&(console.warn("WeeklyReviewService not found, falling back to DRCService"),a.drcService.openDRC(j))}};return Ot.default.createElement("div",{ref:u,className:"journalit-dashboard-calendar",style:{width:"100%",height:o,overflow:"auto",backdropFilter:"none",WebkitBackdropFilter:"none"}},Ot.default.createElement("div",{style:{display:"flex",flexDirection:"column",animation:"calendarFadeIn 0.5s ease-out",padding:"0 6px 6px 0",minHeight:"100%"}},Ot.default.createElement("div",{className:`journalit-dashboard-calendar-header ${s?"hide-weekends":""}`,style:{display:"grid",gridTemplateColumns:s?"repeat(5, 1fr) 1fr":"repeat(7, 1fr) 1fr",marginBottom:"10px",gap:"4px",position:"sticky",top:0,backgroundColor:"var(--background-primary)",zIndex:5,padding:"6px 0",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)",borderBottom:"1px solid var(--background-modifier-border)",borderRadius:"6px"}},Ot.default.createElement("div",{className:"journalit-dashboard-calendar-weekday monday-header","data-day":"Mon",style:{textAlign:"center",fontWeight:600,fontSize:"13px",color:"var(--text-muted)",display:"block !important",letterSpacing:"0.5px"}},"Mon"),Ot.default.createElement("div",{className:"journalit-dashboard-calendar-weekday","data-day":"Tue",style:{textAlign:"center",fontWeight:600,fontSize:"13px",color:"var(--text-muted)",letterSpacing:"0.5px"}},"Tue"),Ot.default.createElement("div",{className:"journalit-dashboard-calendar-weekday","data-day":"Wed",style:{textAlign:"center",fontWeight:500,fontSize:"12px",color:"var(--text-muted)"}},"Wed"),Ot.default.createElement("div",{className:"journalit-dashboard-calendar-weekday","data-day":"Thu",style:{textAlign:"center",fontWeight:500,fontSize:"12px",color:"var(--text-muted)"}},"Thu"),Ot.default.createElement("div",{className:"journalit-dashboard-calendar-weekday","data-day":"Fri",style:{textAlign:"center",fontWeight:500,fontSize:"12px",color:"var(--text-muted)"}},"Fri"),!s&&Ot.default.createElement("div",{className:"journalit-dashboard-calendar-weekday","data-day":"Sat",style:{textAlign:"center",fontWeight:500,fontSize:"12px",color:"var(--text-muted)"}},"Sat"),!s&&Ot.default.createElement("div",{className:"journalit-dashboard-calendar-weekday","data-day":"Sun",style:{textAlign:"center",fontWeight:500,fontSize:"12px",color:"var(--text-muted)"}},"Sun"),Ot.default.createElement("div",{className:"journalit-dashboard-calendar-weekday weekly-pnl-header",style:{textAlign:"center",fontWeight:700,fontSize:"13px",color:"var(--text-on-accent)",backgroundColor:"var(--interactive-accent)",borderLeft:"1px solid rgba(0, 0, 0, 0.05)",borderRadius:"0 6px 6px 0",boxShadow:"inset 0 0 0 1px rgba(0, 0, 0, 0.1)"}},"P&L")),Ot.default.createElement("div",{className:`journalit-dashboard-calendar-grid ${s?"hide-weekends":""}`,style:{display:"flex",flexDirection:"column",gap:"4px",flex:"1"}},h.filter(A=>s?A.some((E,N)=>N<=4&&E.date!==null):!0).map((A,j,E)=>{var $,H,R;let N=null;if(y){let V=($=A.find(Z=>Z.date))==null?void 0:$.date;if(V){let Z=V.getMonth(),K=V.getFullYear(),X=!1;if(j===0)X=!0;else{let U=(H=E[j-1].find(Q=>Q.date))==null?void 0:H.date;if(U){let Q=U.getMonth(),J=U.getFullYear();(Z!==Q||K!==J)&&(X=!0)}}X&&(N=`${["January","February","March","April","May","June","July","August","September","October","November","December"][Z]} ${K}`)}}let B=0,C=0,F=0,M="",_=0,W=(R=A.find(V=>V.date))==null?void 0:R.date;if(W){let V=new Date(W.getFullYear(),0,4),Z=new Date(V.getFullYear(),0,1),K=Math.floor((W.getTime()-Z.getTime())/864e5);M=`W${Math.ceil((K+Z.getDay()+1)/7)}`}return A.forEach(V=>{V.pnl!==null&&(B+=V.pnl,F++),V.tradeCount>0&&(C+=V.tradeCount),V.rMultiple!==null&&(_+=V.rMultiple)}),Ot.default.createElement(Ot.default.Fragment,{key:`week-${j}`},N&&Ot.default.createElement("div",{className:"journalit-dashboard-calendar-month-label"},N),Ot.default.createElement("div",{className:`journalit-dashboard-calendar-week ${s?"hide-weekends":""}`,style:{display:"grid",gridTemplateColumns:s?"repeat(5, 1fr) 1fr":"repeat(7, 1fr) 1fr",gap:"4px",marginBottom:"4px"}},(s?A.filter((V,Z)=>Z<=4):A).map((V,Z)=>Ot.default.createElement(vse,{key:`day-${j}-${Z}`,day:V,dayIndex:Z,onClick:b,displayRMultiples:c})),Ot.default.createElement("div",{className:`journalit-dashboard-calendar-weekly-pnl ${F>0?B>=0?"positive":"negative":""}`,onClick:()=>W&&x(W)},F>0&&Ot.default.createElement(Ot.default.Fragment,null,Ot.default.createElement("div",{className:"journalit-dashboard-calendar-week-total-label"},"WEEK"),Ot.default.createElement("div",{className:"journalit-dashboard-calendar-week-total-value"},ve(B,!1,i,c,_)),C>0&&Ot.default.createElement("div",{className:"journalit-dashboard-calendar-week-trade-count"},C===1?"1 trade":`${C} trades`)))))}))))});SA.displayName="PerformanceCalendar";uze=(e,t,r,n,o)=>{let a=[],i=new Date(e);i.setDate(1);let s=new Date(t.getFullYear(),t.getMonth()+1,0);for(;i<=s;){let l=i.getFullYear(),c=i.getMonth(),u=(new Date(l,c,1).getDay()+6)%7,m=new Date(l,c+1,0).getDate(),f=1,g=[];for(;f<=m;){let v=[];for(let h=0;h<7;h++)if(f===1&&h<u||f>m)v.push({dayNumber:0,date:null,currentMonth:!1,pnl:null,tradeCount:0,isToday:!1,rMultiple:null});else{let y=new Date(l,c,f),b=`${l}-${String(c+1).padStart(2,"0")}-${String(f).padStart(2,"0")}`;v.push({dayNumber:f,date:y,currentMonth:!0,pnl:r[b]||null,tradeCount:n[b]||0,isToday:pze(b),rMultiple:o[b]||null}),f++}g.push(v)}a.push(...g),i.setMonth(i.getMonth()+1)}return a}});var lt,bse,mze,eR,tR=L(()=>{lt=q(Y()),bse=q(vc());rr();Ut();ci();pt();om();mze=({trades:e,year:t=new Date().getFullYear(),onDayClick:r,height:n="100%"})=>{var I,A,j,E,N,B,C;let{currency:o}=Ke(),a=xe(),i=(A=(I=a==null?void 0:a.settings)==null?void 0:I.trade)==null?void 0:A.defaultRiskAmount,s=(N=(E=(j=a==null?void 0:a.settings)==null?void 0:j.trade)==null?void 0:E.showCopyTradingPnL)!=null?N:!1,[l,c]=(0,lt.useState)({isVisible:!1,position:{top:-9999,left:-9999},content:null}),[d,u]=(0,lt.useState)(!1),p=(0,lt.useRef)(null),m=(0,lt.useRef)(null),f=(0,lt.useRef)(null),g=(0,lt.useRef)(null),v=(0,lt.useRef)(0),h=(0,lt.useRef)(!1),y=(0,lt.useRef)({x:0,y:0}),b=25,{dailyData:x,maxAbsPnL:w}=(0,lt.useMemo)(()=>{let F={};e.forEach(_=>{if(!_.pnl)return;let W=new Date(_.entryTime);if(W.getFullYear()!==t)return;let $=Cc(W,a);F[$]||(F[$]={pnl:0,count:0,rMultiple:0});let H=Il(_),R=El(_.pnl,H,s);F[$].pnl+=R,F[$].count+=1;let V=st(R,_.rMultiple,_.riskAmount,i);V!==void 0&&!isNaN(V)&&(F[$].rMultiple+=V)});let M=Math.max(...Object.values(F).map(_=>Math.abs(_.pnl)),1);return{dailyData:F,maxAbsPnL:M}},[e,t,i,s]),S=(0,lt.useMemo)(()=>{let F=new Date(t,0,1),M=new Date(t,11,31),_=new Date(F);_.setDate(F.getDate()-F.getDay());let W=[],$=new Date(_);for(;$<=M||W.length===0||W[W.length-1].days.length<7;){let H={days:[]};for(let R=0;R<7;R++){let V=$.getFullYear(),Z=String($.getMonth()+1).padStart(2,"0"),K=String($.getDate()).padStart(2,"0"),X=`${V}-${Z}-${K}`,G=x[X],U=$.getFullYear()===V,Q=(G==null?void 0:G.pnl)||0,J=(G==null?void 0:G.count)||0,ee=G==null?void 0:G.rMultiple,te=0;if(Q!==0&&U){let ue=Math.abs(Q)/w;te=Math.min(Math.ceil(ue*4),4)}H.days.push({date:new Date($),dateString:X,pnl:Q,tradeCount:J,intensity:te,isEmpty:!U||J===0,rMultiple:ee}),$.setDate($.getDate()+1)}if(W.push(H),$.getFullYear()>t&&W.length>=53)break}return W},[x,w,t]),k=(0,lt.useCallback)(F=>{if(F.isEmpty||F.tradeCount===0)return"var(--heatmap-empty)";if(F.pnl>0)switch(F.intensity){case 1:return"var(--heatmap-profit-1)";case 2:return"var(--heatmap-profit-2)";case 3:return"var(--heatmap-profit-3)";case 4:return"var(--heatmap-profit-4)";default:return"var(--heatmap-empty)"}else switch(F.intensity){case 1:return"var(--heatmap-loss-1)";case 2:return"var(--heatmap-loss-2)";case 3:return"var(--heatmap-loss-3)";case 4:return"var(--heatmap-loss-4)";default:return"var(--heatmap-empty)"}},[]),T=(0,lt.useCallback)(F=>{F.tradeCount>0&&r&&r(F.date)},[r]),P=(0,lt.useCallback)(F=>{if(!f.current)return{top:-9999,left:-9999};let M=f.current;if(!M||!M.offsetParent)return{top:Math.max(F.clientY-80,20),left:Math.max(F.clientX+20,20)};let _=M.getBoundingClientRect(),W=window.innerWidth,$=window.innerHeight,H=16,R=20,V=10,Z=25,K=F.clientX,X=F.clientY,G=_.width,U=_.height,Q=K+R,J=X+V;Q+G>W-H&&(Q=K-G-R),J+U>$-H&&(J=X-U-V),Q+G>W-H&&J+U>$-H&&(Q=K-G-R,J=X-U-V),Q<H&&(Q=H,Math.abs(Q+G/2-K)<Z&&(J>X?J=Math.max(X+Z,J):J=Math.min(X-Z-U,J))),J<H&&(J=H,Math.abs(J+U/2-X)<Z&&(Q>K?Q=Math.max(K+Z,Q):Q=Math.min(K-Z-G,Q)));let ee=Q+G/2,te=J+U/2;return Math.sqrt(Math.pow(ee-K,2)+Math.pow(te-X,2))<Z&&(K<W/2&&X<$/2?(Q=Math.min(K+Z,W-G-H),J=Math.min(X+Z,$-U-H)):K>=W/2&&X<$/2?(Q=Math.max(K-G-Z,H),J=Math.min(X+Z,$-U-H)):K<W/2&&X>=$/2?(Q=Math.min(K+Z,W-G-H),J=Math.max(X-U-Z,H)):(Q=Math.max(K-G-Z,H),J=Math.max(X-U-Z,H))),Q=Math.max(H,Math.min(Q,W-G-H)),J=Math.max(H,Math.min(J,$-U-H)),isNaN(Q)||isNaN(J)?{top:Math.max(X+V,H),left:Math.max(K+R,H)}:{top:J,left:Q}},[]),D=(0,lt.useCallback)((F,M)=>{m.current&&(clearTimeout(m.current),m.current=null),p.current&&clearTimeout(p.current);let _=M.date.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric",year:"numeric"});c({isVisible:!1,position:{top:-9999,left:-9999},content:{date:_,pnl:M.pnl,tradeCount:M.tradeCount,isEmpty:M.isEmpty||M.tradeCount===0,rMultiple:M.rMultiple}}),u(!0),y.current={x:F.clientX,y:F.clientY},p.current=setTimeout(()=>{let W=P(F);c($=>({...$,isVisible:!0,position:W}))},100)},[P]),O=(0,lt.useCallback)(()=>{p.current&&(clearTimeout(p.current),p.current=null),g.current&&(cancelAnimationFrame(g.current),g.current=null),c(F=>({...F,isVisible:!1})),m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{u(!1),m.current=null},200)},[]),z=(0,lt.useCallback)(F=>{if(!l.isVisible||!d)return;let M=F.clientX,_=F.clientY;if(Math.sqrt(Math.pow(M-y.current.x,2)+Math.pow(_-y.current.y,2))<b)return;let $=Date.now(),H=$-v.current;if(H<32&&!h.current)h.current=!0,g.current&&cancelAnimationFrame(g.current),g.current=requestAnimationFrame(()=>{let R=P(F);c(V=>({...V,position:R})),v.current=Date.now(),y.current={x:M,y:_},h.current=!1});else if(H>=32){let R=P(F);c(V=>({...V,position:R})),v.current=$,y.current={x:M,y:_}}},[l.isVisible,d,P,b]);return(0,lt.useEffect)(()=>()=>{p.current&&clearTimeout(p.current),m.current&&clearTimeout(m.current),g.current&&cancelAnimationFrame(g.current)},[]),lt.default.createElement(lt.default.Fragment,null,lt.default.createElement("style",null,`
        :root {
          /* Premium heatmap color palette */
          --heatmap-empty: rgba(var(--background-modifier-border-rgb, 55, 53, 47), 0.12);
          --heatmap-empty-hover: rgba(var(--background-modifier-border-rgb, 55, 53, 47), 0.18);
          
          /* Sophisticated profit gradient - emerald tones */
          --heatmap-profit-1: rgba(16, 185, 129, 0.15);
          --heatmap-profit-2: rgba(16, 185, 129, 0.35);
          --heatmap-profit-3: rgba(16, 185, 129, 0.65);
          --heatmap-profit-4: rgba(5, 150, 105, 0.85);
          
          /* Elegant loss gradient - rose tones */
          --heatmap-loss-1: rgba(239, 68, 68, 0.15);
          --heatmap-loss-2: rgba(239, 68, 68, 0.35);
          --heatmap-loss-3: rgba(239, 68, 68, 0.65);
          --heatmap-loss-4: rgba(220, 38, 38, 0.85);
          
          /* Premium typography */
          --heatmap-text-primary: var(--text-normal);
          --heatmap-text-secondary: var(--text-muted);
          --heatmap-font-weight-medium: 500;
          --heatmap-font-weight-semibold: 600;
          
          /* Smooth animations */
          --heatmap-transition-quick: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
          --heatmap-transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
          --heatmap-shadow-subtle: 0 1px 2px rgba(0, 0, 0, 0.05);
          --heatmap-shadow-elevated: 0 4px 12px rgba(0, 0, 0, 0.12);
        }
        
        .heatmap-container {
          --padding-horizontal: 16px;
          --padding-vertical: 12px;
          --cell-size: 11px;
          --cell-gap: 3px;
          --border-radius-cell: 2px;
          --border-radius-container: 8px;
        }
        
        .heatmap-cell {
          width: var(--cell-size);
          height: var(--cell-size);
          border-radius: var(--border-radius-cell);
          transition: var(--heatmap-transition-quick);
          position: relative;
          overflow: hidden;
        }
        
        .heatmap-cell::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 50%, transparent 100%);
          opacity: 0;
          transition: var(--heatmap-transition-quick);
        }
        
        .heatmap-cell:hover::before {
          opacity: 1;
        }
        
        .heatmap-cell:hover {
          transform: scale(1.15);
          box-shadow: var(--heatmap-shadow-elevated);
          z-index: 10;
        }
        
        .heatmap-cell.clickable {
          cursor: pointer;
        }
        
        .heatmap-cell.clickable:active {
          transform: scale(1.05);
        }
        
        .heatmap-month-label {
          font-size: 11px;
          font-weight: var(--heatmap-font-weight-medium);
          color: var(--heatmap-text-secondary);
          letter-spacing: 0.025em;
        }
        
        .heatmap-day-label {
          font-size: 9px;
          font-weight: var(--heatmap-font-weight-medium);
          color: var(--heatmap-text-secondary);
          letter-spacing: 0.05em;
          text-transform: uppercase;
        }
        
        .heatmap-legend {
          font-size: 10px;
          font-weight: var(--heatmap-font-weight-medium);
          color: var(--heatmap-text-secondary);
          letter-spacing: 0.025em;
        }
        
        .heatmap-legend-cell {
          width: 10px;
          height: 10px;
          border-radius: var(--border-radius-cell);
          transition: var(--heatmap-transition-quick);
        }
        
        .heatmap-legend-cell:hover {
          transform: scale(1.1);
          box-shadow: var(--heatmap-shadow-subtle);
        }
        
        /* Professional Heatmap Tooltip Styles */
        .journalit-heatmap-tooltip {
          background-color: var(--background-primary);
          border-radius: 10px;
          padding: 14px 18px;
          min-width: 140px;
          border: 1px solid var(--background-modifier-border);
          box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
          position: relative;
          z-index: 10000;
        }
        
        .heatmap-tooltip-date {
          font-size: 14px;
          font-weight: 500;
          color: var(--text-normal);
          margin-bottom: 8px;
          text-align: center;
          border-bottom: 1px solid var(--background-modifier-border);
          padding-bottom: 6px;
        }
        
        .heatmap-tooltip-value {
          font-size: 20px;
          font-weight: 600;
          text-align: center;
          margin-bottom: 4px;
        }
        
        .heatmap-tooltip-value.positive {
          color: var(--chart-positive);
        }
        
        .heatmap-tooltip-value.negative {
          color: var(--chart-negative);
        }
        
        .heatmap-tooltip-info {
          font-size: 12px;
          color: var(--text-muted);
          text-align: center;
          font-style: italic;
        }
        
        @media (prefers-reduced-motion: reduce) {
          .heatmap-cell,
          .heatmap-legend-cell {
            transition: none;
          }
          
          .heatmap-cell:hover {
            transform: none;
          }
          
          .heatmap-legend-cell:hover {
            transform: none;
          }
          
          .journalit-heatmap-tooltip {
            transition: none !important;
          }
        }
      `),lt.default.createElement("div",{className:"contributions-heatmap heatmap-container",style:{height:n,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"var(--padding-vertical) var(--padding-horizontal)",background:"transparent"}},lt.default.createElement("div",{style:{display:"flex",marginBottom:"12px",width:"100%",maxWidth:`${S.length*14}px`,paddingLeft:"32px"}},Array.from({length:12},(F,M)=>lt.default.createElement("div",{key:M,className:"heatmap-month-label",style:{flex:`0 0 ${4.33*14}px`,textAlign:"left",paddingLeft:"2px"}},new Date(t,M,1).toLocaleDateString("en-US",{month:"short"})))),lt.default.createElement("div",{style:{display:"flex",alignItems:"flex-start",gap:"10px"}},lt.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"var(--cell-gap)",paddingTop:"1px"}},lt.default.createElement("div",{className:"heatmap-day-label",style:{height:"var(--cell-size)"}},"Mon"),lt.default.createElement("div",{style:{height:"var(--cell-size)"}}),lt.default.createElement("div",{className:"heatmap-day-label",style:{height:"var(--cell-size)"}},"Wed"),lt.default.createElement("div",{style:{height:"var(--cell-size)"}}),lt.default.createElement("div",{className:"heatmap-day-label",style:{height:"var(--cell-size)"}},"Fri"),lt.default.createElement("div",{style:{height:"var(--cell-size)"}}),lt.default.createElement("div",{className:"heatmap-day-label",style:{height:"var(--cell-size)"}},"Sun")),lt.default.createElement("div",{style:{display:"flex",gap:"var(--cell-gap)"}},S.map((F,M)=>lt.default.createElement("div",{key:M,style:{display:"flex",flexDirection:"column",gap:"var(--cell-gap)"}},F.days.map((_,W)=>lt.default.createElement("div",{key:`${M}-${W}`,className:`heatmap-cell ${_.tradeCount>0?"clickable":""}`,onClick:()=>T(_),onMouseEnter:$=>D($,_),onMouseLeave:O,onMouseMove:z,style:{backgroundColor:k(_),border:_.isEmpty?"none":"1px solid rgba(var(--background-modifier-border-rgb, 55, 53, 47), 0.08)"}})))))),lt.default.createElement("div",{style:{display:"flex",alignItems:"center",marginTop:"16px",gap:"8px"}},lt.default.createElement("span",{className:"heatmap-legend"},"Less"),lt.default.createElement("div",{style:{display:"flex",gap:"var(--cell-gap)"}},lt.default.createElement("div",{className:"heatmap-legend-cell",style:{backgroundColor:"var(--heatmap-empty)"}}),lt.default.createElement("div",{className:"heatmap-legend-cell",style:{backgroundColor:"var(--heatmap-profit-1)"}}),lt.default.createElement("div",{className:"heatmap-legend-cell",style:{backgroundColor:"var(--heatmap-profit-2)"}}),lt.default.createElement("div",{className:"heatmap-legend-cell",style:{backgroundColor:"var(--heatmap-profit-3)"}}),lt.default.createElement("div",{className:"heatmap-legend-cell",style:{backgroundColor:"var(--heatmap-profit-4)"}})),lt.default.createElement("span",{className:"heatmap-legend"},"More"))),d&&l.content&&(0,bse.createPortal)(lt.default.createElement("div",{ref:f,className:"journalit-heatmap-tooltip",style:{position:"fixed",top:`${l.position.top}px`,left:`${l.position.left}px`,zIndex:1e4,opacity:l.isVisible?1:0,transform:l.isVisible?"translateY(-4px)":"translateY(0)",transition:"opacity 0.2s cubic-bezier(0.4, 0, 0.2, 1), transform 0.2s cubic-bezier(0.4, 0, 0.2, 1)",pointerEvents:"none"}},lt.default.createElement("div",{className:"heatmap-tooltip-date"},l.content.date),!l.content.isEmpty&&lt.default.createElement("div",{className:`heatmap-tooltip-value ${l.content.pnl>0?"positive":l.content.pnl<0?"negative":""}`},ve(l.content.pnl,!0,o,(C=(B=a==null?void 0:a.settings)==null?void 0:B.trade)==null?void 0:C.displayRMultiples,l.content.rMultiple)),lt.default.createElement("div",{className:"heatmap-tooltip-info"},l.content.isEmpty?"No trades":`${l.content.tradeCount} trade${l.content.tradeCount===1?"":"s"}`)),document.body))},eR=lt.default.memo(mze)});function Xd(e,t){return r=>{var l,c;let{trades:n,dateFormat:o="MMM DD, YYYY",...a}=r,i=xe(),s=(c=(l=i==null?void 0:i.settings)==null?void 0:l.trade)==null?void 0:c.defaultRiskAmount;if(!n||n.length===0)switch(t){case"pnl":return cp.default.createElement(e,{data:[],plugin:i,...a});case"drawdown":return cp.default.createElement(e,{data:[],plugin:i,...a});case"trades":return cp.default.createElement(e,{data:[],plugin:i,...a});default:return cp.default.createElement(e,{data:[],plugin:i,...a})}switch(t){case"pnl":let d=Uf(n,o,s);return cp.default.createElement(e,{data:d,plugin:i,...a});case"drawdown":let u=Vf(n,o,s);return cp.default.createElement(e,{data:u,plugin:i,...a});case"trades":let p=Vw(n,s);return cp.default.createElement(e,{data:p,plugin:i,...a});default:return cp.default.createElement(e,{data:[],plugin:i,...a})}}}var cp,xse=L(()=>{cp=q(Y());Iu();pt()});var Zl=L(()=>{Q5();mse();fse();gse();hse();yse();tR();xse();Iu()});var CA,wse,kse=L(()=>{CA=q(Y());Ru();Zl();pt();wse=CA.default.memo(({filters:e,dateFormat:t})=>{var o,a;let r=xe(),n=(a=(o=r==null?void 0:r.settings)==null?void 0:o.trade)==null?void 0:a.defaultRiskAmount;return CA.default.createElement(fi,{filters:e,dateFormat:t},(i,s)=>{let l=Uf(i.trades,s,n);return CA.default.createElement(Jd,{data:l,plugin:r,onPointClick:(c,d)=>{}})})})});var rR,Sse,Tse=L(()=>{rR=q(Y());Ru();Zl();Sse=({filters:e})=>rR.default.createElement(fi,{filters:e},t=>rR.default.createElement(SA,{trades:t.trades,filters:e}))});var ki,Cse,Pse,Dse=L(()=>{ki=q(Y());wt();Ut();Ru();Zl();pt();Cse=[10,20,30,50],Pse=ki.default.memo(({filters:e,dateFormat:t})=>{let r=xe(),[n,o]=(0,ki.useState)(20);return(0,ki.useEffect)(()=>{Promise.resolve().then(()=>(c0(),AO)).then(({ensureChartStyles:a})=>{a()})},[]),ki.default.createElement(fi,{filters:e,dateFormat:t},(a,i)=>{var u,p;let s=(p=(u=r==null?void 0:r.settings)==null?void 0:u.trade)==null?void 0:p.defaultRiskAmount,l={};a.trades.forEach(m=>{let f=m.entryTime instanceof Date?m.entryTime:new Date(m.entryTime),g=f.getFullYear(),v=String(f.getMonth()+1).padStart(2,"0"),h=String(f.getDate()).padStart(2,"0"),y=`${g}-${v}-${h}`;l[y]||(l[y]={pnl:0,trades:0,rMultiple:0}),l[y].pnl+=m.pnl,l[y].trades+=1;let b=st(m.pnl,m.rMultiple,m.riskAmount,s);b!==void 0&&!isNaN(b)&&(l[y].rMultiple+=b)});let c=Object.entries(l).map(([m,f])=>({date:rt(new Date(m),i),originalDate:m,pnl:f.pnl,trades:f.trades,rMultiple:f.rMultiple,fill:f.pnl>=0?"var(--chart-positive)":"var(--chart-negative)"}));c.sort((m,f)=>new Date(m.originalDate).getTime()-new Date(f.originalDate).getTime());let d=c.slice(-n);return ki.default.createElement("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",position:"relative"}},ki.default.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"8px 12px",borderBottom:"1px solid var(--background-modifier-border)",position:"relative"}},ki.default.createElement("div",{style:{fontWeight:500,fontSize:"13px",color:"var(--text-muted)",letterSpacing:"0.3px",textAlign:"center"}},"Daily Performance"),ki.default.createElement("div",{style:{position:"absolute",right:"12px",display:"flex",alignItems:"center",gap:"8px"}},ki.default.createElement("span",{style:{fontSize:"12px",color:"var(--text-muted)",fontWeight:500}},"Period:"),ki.default.createElement("select",{"aria-label":"Period",value:n,onChange:m=>{let f=Number(m.target.value);Cse.includes(f)&&o(f)},style:{padding:"4px 8px",fontSize:"11px",fontWeight:500,color:"var(--text-normal)",backgroundColor:"var(--background-primary)",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",cursor:"pointer"}},Cse.map(m=>ki.default.createElement("option",{key:m,value:m},m," Days"))))),ki.default.createElement("div",{style:{flex:1,width:"100%",minHeight:0}},ki.default.createElement(Z5,{data:d})))})})});var ll,Ese,Ise,Ase=L(()=>{ll=q(Y());Ru();Zl();pt();Ese=[25,50,75,100],Ise=({filters:e,dateFormat:t})=>{var i,s;let r=xe(),n=(s=(i=r==null?void 0:r.settings)==null?void 0:i.trade)==null?void 0:s.defaultRiskAmount,[o,a]=(0,ll.useState)(50);return ll.default.createElement(fi,{filters:e,dateFormat:t},(l,c)=>{let p=Vw(l.trades,n).slice(-o).map((m,f)=>({...m,tradeIndex:f}));return ll.default.createElement("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",position:"relative"}},ll.default.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"8px 12px",borderBottom:"1px solid var(--background-modifier-border)",position:"relative"}},ll.default.createElement("div",{style:{fontWeight:500,fontSize:"13px",color:"var(--text-muted)",letterSpacing:"0.3px",textAlign:"center"}},"Trades"),ll.default.createElement("div",{style:{position:"absolute",right:"12px",display:"flex",alignItems:"center",gap:"8px"}},ll.default.createElement("span",{style:{fontSize:"12px",color:"var(--text-muted)",fontWeight:500}},"Limit:"),ll.default.createElement("select",{value:o,onChange:m=>{let f=Number(m.target.value);Ese.includes(f)&&a(f)},style:{padding:"4px 8px",fontSize:"11px",fontWeight:500,color:"var(--text-normal)",backgroundColor:"var(--background-primary)",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",cursor:"pointer"}},Ese.map(m=>ll.default.createElement("option",{key:m,value:m},m," Trades"))))),ll.default.createElement("div",{style:{flex:1,width:"100%",minHeight:0}},ll.default.createElement(uS,{data:p,onPointClick:(m,f)=>{m!=null&&m.path},className:"dashboard-trades-chart",style:{boxShadow:"var(--shadow-s)"}})))})}});var PA,Lse,Nse=L(()=>{PA=q(Y());Ru();Zl();pt();Lse=PA.default.memo(({filters:e,dateFormat:t})=>{let r=xe();return PA.default.createElement(fi,{filters:e,dateFormat:t},(n,o)=>{var i,s;let a=Vf(n.trades,o,(s=(i=r==null?void 0:r.settings)==null?void 0:i.trade)==null?void 0:s.defaultRiskAmount);return PA.default.createElement(lp,{data:a,plugin:r,showTooltip:!0,tooltipProps:{wrapperStyle:{zIndex:1001}}})})})});var Ro,fze,Mse,Fse=L(()=>{Ro=q(Y());Ru();Ut();pt();Td();eo();ga();rr();wt();om();fze=(e,t)=>{var r,n;try{let o=((n=(r=t==null?void 0:t.settings)==null?void 0:r.trade)==null?void 0:n.dateFormat)||"MMDDYY",a=String(e.getDate()).padStart(2,"0"),i=String(e.getMonth()+1).padStart(2,"0"),l=String(e.getFullYear()).slice(2);switch(o){case"DDMMYY":return`${a}/${i}/${l}`;case"MMDDYY":return`${i}/${a}/${l}`;case"YYMMDD":return`${l}/${i}/${a}`;default:return e.toLocaleDateString()}}catch(o){return e.toLocaleDateString()}},Mse=({filters:e})=>{var i,s,l,c,d;let t=xe(),{currency:r}=Ke(),n=(s=(i=t==null?void 0:t.settings)==null?void 0:i.trade)==null?void 0:s.defaultRiskAmount,o=(d=(c=(l=t==null?void 0:t.settings)==null?void 0:l.trade)==null?void 0:c.showCopyTradingPnL)!=null?d:!1,a=u=>{t&&t.openFile(u,!0)};return Ro.default.createElement(fi,{filters:e},u=>{let p=[...u.trades].sort((m,f)=>yd(f.entryTime,m.entryTime)).slice(0,10);return Ro.default.createElement("div",{className:"journalit-dashboard-recent-trades"},Ro.default.createElement("table",{className:"journalit-dashboard-recent-trades-table"},Ro.default.createElement("thead",null,Ro.default.createElement("tr",null,Ro.default.createElement("th",null,"Date"),Ro.default.createElement("th",null,"Ticker"),Ro.default.createElement("th",null,"Direction"),Ro.default.createElement("th",{className:"pnl-column"},"P&L"))),Ro.default.createElement("tbody",null,p.length===0?Ro.default.createElement("tr",null,Ro.default.createElement("td",{colSpan:4,style:{padding:"20px 0",textAlign:"center",height:"150px",position:"relative"}},Ro.default.createElement("div",{style:{position:"absolute",top:"0",left:"0",right:"0",bottom:"0",display:"flex",justifyContent:"center",alignItems:"center"}},Ro.default.createElement(et,{message:"No trades found",subMessage:"Try selecting a different date range",iconSize:32,actionButtonText:"Add Trade",onActionButtonClick:()=>{if(!t||!t.app)return;new jo({app:t.app,plugin:t}).open()}})))):p.map((m,f)=>{var w,S,k;let g=m.tradeStatus==="CLOSED"?!1:m.tradeStatus==="OPEN"||m._originalPnlWasNull&&!m.tradeStatus?!0:Pt({tradeStatus:m.tradeStatus,exitTime:m.exitTime,pnl:m._originalPnlWasNull?null:m.pnl,useDirectPnLInput:m.useDirectPnLInput,exits:m.exits,entries:m.entries}),v=(w=m.pnl)!=null?w:0,h=Il(m),y=El(v,h,o),b=!g&&y>0,x=!g&&y<0;return Ro.default.createElement("tr",{key:`${m.path}-${f}`,onClick:()=>a(m.path),className:`trade-row${g?" open-trade":""}`},Ro.default.createElement("td",{className:"date-cell"},fze(m.entryTime,t)),Ro.default.createElement("td",{className:"ticker-cell"},m.instrument||"Unknown"),Ro.default.createElement("td",{className:"direction-cell"},m.assetType==="options"&&m.optionType?m.optionType.charAt(0).toUpperCase()+m.optionType.slice(1):((S=m.direction)==null?void 0:S.toLowerCase())==="buy"?"Long":((k=m.direction)==null?void 0:k.toLowerCase())==="sell"?"Short":m.direction||"Unknown"),Ro.default.createElement("td",{className:`pnl-cell ${g?"open":b?"positive":x?"negative":""}`},g?"OPEN":(()=>{var P;let T=st(y,m.rMultiple,m.riskAmount,n);return ve(y,!0,r,(P=t==null?void 0:t.settings.trade)==null?void 0:P.displayRMultiples,T)})()))}))))})}});var vt,Ose,gze,hze,vze,nR,jse=L(()=>{vt=q(Y());Ru();Gd();Yd();Ut();rr();pt();ga();Ose=[10,20,30,50],gze=(e,t,r)=>{if(e.length===0)return[];let o=[...e.filter(i=>!Pt({tradeStatus:i.tradeStatus,exitTime:i.exitTime,pnl:i._originalPnlWasNull?null:i.pnl,useDirectPnLInput:i.useDirectPnLInput,exits:i.exits,entries:i.entries}))].sort((i,s)=>{let l=i.entryTime instanceof Date?i.entryTime.getTime():new Date(i.entryTime).getTime(),c=s.entryTime instanceof Date?s.entryTime.getTime():new Date(s.entryTime).getTime();return l-c}),a=[];for(let i=0;i<o.length;i++){let s=Math.max(0,i-t+1),l=o.slice(s,i+1),c=l.filter(v=>{var h;return((h=v.pnl)!=null?h:0)>0}),d=l.filter(v=>{var h;return((h=v.pnl)!=null?h:0)<0}),u=c.length>0?c.reduce((v,h)=>{var y;return v+((y=h.pnl)!=null?y:0)},0)/c.length:0,p=d.length>0?Math.abs(d.reduce((v,h)=>{var y;return v+((y=h.pnl)!=null?y:0)},0)/d.length):0,m=p>0?u/p:0,f,g;if(r&&r>0){let v=c.map(y=>st(y.pnl,y.rMultiple,y.riskAmount,r)).filter(y=>y!==void 0&&!isNaN(y));f=v.length>0?v.reduce((y,b)=>y+b,0)/v.length:void 0;let h=d.map(y=>st(y.pnl,y.rMultiple,y.riskAmount,r)).filter(y=>y!==void 0&&!isNaN(y));g=h.length>0?Math.abs(h.reduce((y,b)=>y+b,0)/h.length):void 0}a.push({tradeIndex:i+1,ratio:Math.round(m*100)/100,avgWin:u,avgLoss:p,avgWinR:f,avgLossR:g,label:`#${i+1}`})}return a},hze=e=>{let{active:t,payload:r,displayRMultiples:n}=e;if(!t||!r||r.length===0)return null;let o=r[0].payload,{currency:a}=Ke(),i=()=>n&&o.avgWinR!==void 0?`+${o.avgWinR.toFixed(2)}R`:ve(o.avgWin,!1,a),s=()=>n&&o.avgLossR!==void 0?`${o.avgLossR.toFixed(2)}R`:ve(o.avgLoss,!1,a);return vt.default.createElement("div",{style:{backgroundColor:"var(--background-primary)",border:"1px solid var(--background-modifier-border)",borderRadius:"8px",padding:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"}},vt.default.createElement("div",{style:{fontSize:"12px",fontWeight:600,color:"var(--text-muted)",marginBottom:"6px"}},"Trade ",o.label),vt.default.createElement("div",{style:{fontSize:"13px",fontWeight:600,color:"var(--text-normal)",marginBottom:"6px"}},"Ratio: ",o.ratio.toFixed(2)),o.avgWin>0&&vt.default.createElement("div",{style:{fontSize:"13px",fontWeight:500,color:"var(--chart-positive)",marginBottom:"4px"}},"Avg Win: ",i()),o.avgLoss>0&&vt.default.createElement("div",{style:{fontSize:"13px",fontWeight:500,color:"var(--chart-negative)"}},"Avg Loss: ",s()))},vze=0,nR=vt.default.memo(({filters:e,dateFormat:t})=>{var u,p,m,f,g;let[r,n]=(0,vt.useState)(20),o=xe(),a=(p=(u=o==null?void 0:o.settings)==null?void 0:u.trade)==null?void 0:p.defaultRiskAmount,i=(g=(f=(m=o==null?void 0:o.settings)==null?void 0:m.trade)==null?void 0:f.displayRMultiples)!=null?g:!1,s=(0,vt.useRef)(null);(0,vt.useEffect)(()=>{s.current||(s.current=`rolling-win-loss-ratio-${++vze}`)},[]);let l=s.current||"rolling-win-loss-ratio-default",c="var(--chart-positive, #43a047)",d="var(--chart-negative, #e53935)";return vt.default.createElement(fi,{filters:e,dateFormat:t},v=>{let y=(0,vt.useMemo)(()=>gze(v.trades,r,a),[v.trades,r,a]).slice(-r),b=(()=>{if(y.length===0)return{transitionOffset:50,effectiveMinRatio:0,effectiveMaxRatio:1.5};let x=y.map(O=>O.ratio),w=Math.min(...x),S=Math.max(...x),k=w<1&&S>1,T=Math.max(S,1.5),P=Math.min(w,0),D;if(!k)D=S<=1?-10:110;else{let O=T-P;D=O>0?(T-1)/O*100:50}return{transitionOffset:Math.max(0,Math.min(100,D)),effectiveMinRatio:P,effectiveMaxRatio:T}})();return vt.default.createElement("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",position:"relative"}},vt.default.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"8px 12px",borderBottom:"1px solid var(--background-modifier-border)",position:"relative",opacity:.8}},vt.default.createElement("div",{style:{fontWeight:500,fontSize:"13px",color:"var(--text-muted)",letterSpacing:"0.3px",textAlign:"center"}},"Rolling Win/Loss Ratio"),vt.default.createElement("div",{style:{position:"absolute",right:"12px",display:"flex",alignItems:"center",gap:"8px"}},vt.default.createElement("span",{style:{fontSize:"12px",color:"var(--text-muted)",fontWeight:500}},"Period:"),vt.default.createElement("select",{id:"rolling-period-select","aria-label":"Period",value:r,onChange:x=>{let w=Number(x.target.value);Ose.includes(w)&&n(w)},style:{padding:"4px 8px",fontSize:"11px",fontWeight:500,color:"var(--text-normal)",backgroundColor:"var(--background-primary)",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",cursor:"pointer"}},Ose.map(x=>vt.default.createElement("option",{key:x,value:x},x," Trades"))))),vt.default.createElement("div",{style:{flex:1,width:"100%",minHeight:0}},vt.default.createElement(Ia,{height:"100%",width:"100%"},vt.default.createElement(lS,{data:y,margin:{top:16,right:30,left:0,bottom:8}},vt.default.createElement("defs",null,vt.default.createElement("linearGradient",{id:`${l}-strokeGradient`,x1:"0",y1:"0",x2:"0",y2:"1"},b.transitionOffset<=.1?vt.default.createElement(vt.default.Fragment,null,vt.default.createElement("stop",{offset:"0%",stopColor:d}),vt.default.createElement("stop",{offset:"100%",stopColor:d})):b.transitionOffset>=99.9?vt.default.createElement(vt.default.Fragment,null,vt.default.createElement("stop",{offset:"0%",stopColor:c}),vt.default.createElement("stop",{offset:"100%",stopColor:c})):vt.default.createElement(vt.default.Fragment,null,vt.default.createElement("stop",{offset:"0%",stopColor:c}),vt.default.createElement("stop",{offset:`${Math.max(.1,b.transitionOffset-.1)}%`,stopColor:c}),vt.default.createElement("stop",{offset:`${Math.min(99.9,b.transitionOffset+.1)}%`,stopColor:d}),vt.default.createElement("stop",{offset:"100%",stopColor:d}))),vt.default.createElement("filter",{id:`${l}-glow`,height:"130%"},vt.default.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"2",result:"blur"}),vt.default.createElement("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7",result:"glow"}),vt.default.createElement("feComposite",{in:"SourceGraphic",in2:"glow",operator:"over"}))),vt.default.createElement($o,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),vt.default.createElement(Tn,{y:1,stroke:"var(--text-normal, #888888)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1.5,label:{value:"1.0",position:"right",fill:"var(--text-muted)",fontSize:11,fontWeight:500}}),vt.default.createElement(to,{dataKey:"label",style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:8,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5}}),vt.default.createElement(ro,{tickFormatter:x=>Number.isFinite(x)?x.toFixed(1):"",style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:[b.effectiveMinRatio,x=>Math.max(x*1.1,1.5)],width:45,tickLine:!0,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.3},tickMargin:5}),vt.default.createElement(ia,{content:x=>vt.default.createElement(hze,{active:x.active,payload:x.payload,displayRMultiples:i}),cursor:{stroke:"var(--interactive-accent)",strokeWidth:1,strokeDasharray:"3 3"},wrapperStyle:{zIndex:1e3}}),vt.default.createElement(Ql,{type:"monotone",dataKey:"ratio",stroke:`url(#${l}-strokeGradient)`,strokeWidth:2.5,dot:!1,activeDot:{r:7,strokeWidth:1,stroke:"var(--background-primary)",fill:"var(--interactive-accent)",filter:`url(#${l}-glow)`},animationDuration:500,animationEasing:"ease-out"})))))})});nR.displayName="RollingWinLossRatioChart"});var zr,yze,oR,zse=L(()=>{zr=q(Y());Ru();Gd();Yd();ga();Ut();rr();pt();yze=(e,t,r)=>{if(!e||e.length===0)return[];let o=[...e.filter(i=>!Pt({tradeStatus:i.tradeStatus,exitTime:i.exitTime,pnl:i._originalPnlWasNull?null:i.pnl,useDirectPnLInput:i.useDirectPnLInput,exits:i.exits,entries:i.entries}))].sort((i,s)=>{let l=i.entryTime instanceof Date?i.entryTime.getTime():new Date(i.entryTime).getTime(),c=s.entryTime instanceof Date?s.entryTime.getTime():new Date(s.entryTime).getTime();return l-c}),a=[];for(let i=0;i<o.length;i++){let s=Math.max(0,i-t+1),l=o.slice(s,i+1),c=l.filter(g=>g.pnl>0),d=l.filter(g=>g.pnl<0),u=c.length>0?c.reduce((g,v)=>g+v.pnl,0)/c.length:null,p=d.length>0?Math.abs(d.reduce((g,v)=>g+v.pnl,0)/d.length):null,m=null,f=null;if(r&&r>0){let g=c.map(h=>st(h.pnl,h.rMultiple,h.riskAmount,r)).filter(h=>h!==void 0&&!isNaN(h));m=g.length>0?g.reduce((h,y)=>h+y,0)/g.length:null;let v=d.map(h=>st(h.pnl,h.rMultiple,h.riskAmount,r)).filter(h=>h!==void 0&&!isNaN(h));f=v.length>0?Math.abs(v.reduce((h,y)=>h+y,0)/v.length):null}a.push({tradeIndex:i+1,avgWin:u,avgLoss:p,avgWinR:m,avgLossR:f,label:`#${i+1}`})}return a},oR=zr.default.memo(({filters:e,dateFormat:t})=>{var c,d,u,p,m;let r=xe(),{currency:n}=Ke(),[o,a]=(0,zr.useState)(20),i=(d=(c=r==null?void 0:r.settings)==null?void 0:c.trade)==null?void 0:d.defaultRiskAmount,s=(m=(p=(u=r==null?void 0:r.settings)==null?void 0:u.trade)==null?void 0:p.displayRMultiples)!=null?m:!1,l=[10,20,30,50];return zr.default.createElement(fi,{filters:e,dateFormat:t},(f,g)=>{let h=yze(f.trades,o,i).slice(-o),y=x=>{if(!x.active||!x.payload||x.payload.length===0)return null;let w=x.payload[0].payload;return zr.default.createElement("div",{style:{backgroundColor:"var(--background-primary)",border:"1px solid var(--background-modifier-border)",borderRadius:"8px",padding:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"}},zr.default.createElement("div",{style:{fontSize:"12px",fontWeight:600,color:"var(--text-muted)",marginBottom:"6px"}},"Trade ",w.label),w.avgWin!==null&&zr.default.createElement("div",{style:{fontSize:"13px",fontWeight:500,color:"var(--chart-positive)",marginBottom:"4px"}},"Avg Win: ",s&&w.avgWinR!=null?`+${w.avgWinR.toFixed(2)}R`:ve(w.avgWin,!1,n)),w.avgLoss!==null&&zr.default.createElement("div",{style:{fontSize:"13px",fontWeight:500,color:"var(--chart-negative)"}},"Avg Loss: ",s&&w.avgLossR!=null?`${w.avgLossR.toFixed(2)}R`:ve(w.avgLoss,!1,n)))},b=x=>{let{payload:w}=x;return w?zr.default.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"16px",marginTop:"8px"}},w.map((S,k)=>zr.default.createElement("div",{key:`legend-${k}`,style:{display:"flex",alignItems:"center",gap:"6px",fontSize:"12px",fontWeight:500,color:"var(--text-normal)"}},zr.default.createElement("div",{style:{width:"12px",height:"2px",backgroundColor:S.color,borderRadius:"1px"}}),zr.default.createElement("span",null,S.value)))):null};return zr.default.createElement("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column"}},zr.default.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"8px 12px",borderBottom:"1px solid var(--background-modifier-border)",position:"relative",opacity:.8}},zr.default.createElement("div",{style:{fontWeight:500,fontSize:"13px",color:"var(--text-muted)",letterSpacing:"0.3px",textAlign:"center"}},"Rolling Avg Win/Loss"),zr.default.createElement("div",{style:{position:"absolute",right:"12px",display:"flex",alignItems:"center",gap:"8px"}},zr.default.createElement("span",{style:{fontSize:"12px",color:"var(--text-muted)",fontWeight:500}},"Period:"),zr.default.createElement("select",{"aria-label":"Period",value:o,onChange:x=>{let w=Number(x.target.value);!isNaN(w)&&l.includes(w)&&a(w)},style:{padding:"4px 8px",fontSize:"11px",fontWeight:500,border:"1px solid var(--background-modifier-border)",borderRadius:"4px",backgroundColor:"var(--background-primary)",color:"var(--text-normal)",cursor:"pointer",outline:"none"}},l.map(x=>zr.default.createElement("option",{key:x,value:x},x," Trades"))))),zr.default.createElement("div",{style:{flex:1,minHeight:0}},zr.default.createElement(Ia,{height:"100%",width:"100%"},zr.default.createElement(lS,{data:h,margin:{top:12,right:20,left:0,bottom:6}},zr.default.createElement($o,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),zr.default.createElement(to,{dataKey:"label",style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:8,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5},interval:"preserveStartEnd"}),zr.default.createElement(ro,{tickFormatter:x=>Number.isFinite(x)?s&&i&&i>0?`${x.toFixed(1)}R`:ve(x,!0,n):"",style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},width:50,tickLine:!0,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.3},tickMargin:5}),zr.default.createElement(ia,{content:y,cursor:{stroke:"var(--interactive-accent)",strokeWidth:1,strokeDasharray:"3 3"},wrapperStyle:{zIndex:1e3}}),zr.default.createElement(Em,{content:b}),zr.default.createElement(Tn,{y:0,stroke:"var(--text-normal)",strokeOpacity:.3,strokeDasharray:"3 3",strokeWidth:1}),zr.default.createElement(Ql,{type:"monotone",dataKey:s?"avgWinR":"avgWin",stroke:"var(--chart-positive)",strokeWidth:2.5,dot:!1,activeDot:{r:6,strokeWidth:1,stroke:"var(--background-primary)",fill:"var(--chart-positive)"},name:"Avg Win",connectNulls:!1,animationDuration:500,animationEasing:"ease-out"}),zr.default.createElement(Ql,{type:"monotone",dataKey:s?"avgLossR":"avgLoss",stroke:"var(--chart-negative)",strokeWidth:2.5,dot:!1,activeDot:{r:6,strokeWidth:1,stroke:"var(--background-primary)",fill:"var(--chart-negative)"},name:"Avg Loss",connectNulls:!1,animationDuration:500,animationEasing:"ease-out"})))))})});oR.displayName="RollingStatsChart"});var dr,EA,aR,fh,bze,xze,_se,DA,Bse,iR=L(()=>{dr=q(Y()),EA=q(Sj());eg();pt();wt();B0();kse();Tse();Dse();Ase();Nse();Fse();jse();zse();aR=class extends dr.default.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){console.error("ResponsiveGridLayout crashed:",{error:t.message,stack:t.stack,componentStack:r.componentStack,isEditing:this.props.isEditing,timestamp:new Date().toISOString()})}render(){var t;return this.state.hasError?dr.default.createElement("div",{style:{padding:"20px",border:"2px solid red",borderRadius:"4px"}},dr.default.createElement("h3",null,"Grid Layout Error"),dr.default.createElement("p",null,"Error: ",(t=this.state.error)==null?void 0:t.message),dr.default.createElement("button",{onClick:()=>this.setState({hasError:!1,error:null})},"Retry")):this.props.children}},fh=(e,t,r,n,o)=>{var c,d,u;let a=ka.find(p=>p.id===t),i={};if(a!=null&&a.maxSize&&(i.minW=a.minSize.w,i.minH=a.minSize.h,i.maxW=a.maxSize.w,i.maxH=a.maxSize.h),!e||e.length===0)return{i:t,x:0,y:0,w:r,h:n,...i};if(o)try{let p=((d=(c=o.settings)==null?void 0:c.dashboard)==null?void 0:d.layouts)||{};for(let m in p){let f=p[m];if(!f)continue;let v=(((u=f.bottomSection)==null?void 0:u.lg)||[]).find(h=>h.i===t);if(v){let h=a!=null&&a.maxSize?Math.max(i.minW,Math.min(v.w,i.maxW)):v.w,y=a!=null&&a.maxSize?Math.max(i.minH,Math.min(v.h,i.maxH)):v.h;return{i:t,x:0,y:ta,w:h,h:y,...i}}}}catch(p){console.error("Error finding previous layout:",p)}let s=0;return e.forEach(p=>{let m=typeof p.y=="number"?p.y:0,f=typeof p.h=="number"?p.h:1,g=m+f;g>s&&(s=g)}),{i:t,x:0,y:s,w:r,h:n,...i}},bze=(0,EA.WidthProvider)(EA.Responsive),xze=50,_se=4,DA={lg:12,md:6,sm:4,xs:2,xxs:1},Bse=({filters:e,isEditing:t,widgets:r,onRemoveWidget:n})=>{let o=xe(),[a,i]=(0,dr.useState)({lg:[],md:[],sm:[],xs:[],xxs:[]}),[s,l]=(0,dr.useState)(1200),[c,d]=(0,dr.useState)("lg"),u=(0,dr.useCallback)(b=>{l(b)},[]),p=(0,dr.useCallback)(b=>{["lg","md","sm","xs","xxs"].includes(b)&&d(b)},[]),m=b=>{var S,k,T,P;let x=ka.find(D=>D.id===b.i),w={...b,i:typeof b.i=="string"?b.i:"unknown",x:typeof b.x=="number"&&isFinite(b.x)?b.x:0,y:typeof b.y=="number"&&isFinite(b.y)?b.y===1/0||b.y===1e7||b.y===1e4?ta:b.y:b.y===1/0?ta:0,w:typeof b.w=="number"&&isFinite(b.w)&&b.w>0?b.w:1,h:typeof b.h=="number"&&isFinite(b.h)&&b.h>0?b.h:1};return x!=null&&x.maxSize&&(w.minW=(S=b.minW)!=null?S:x.minSize.w,w.minH=(k=b.minH)!=null?k:x.minSize.h,w.maxW=(T=b.maxW)!=null?T:x.maxSize.w,w.maxH=(P=b.maxH)!=null?P:x.maxSize.h,w.w=Math.max(w.minW,Math.min(w.w,w.maxW)),w.h=Math.max(w.minH,Math.min(w.h,w.maxH))),w},f=b=>{let x={};return Object.entries(b).forEach(([w,S])=>{if(!Array.isArray(S)){x[w]=[];return}x[w]=S.map(k=>!k||typeof k!="object"?{i:"unknown",x:0,y:0,w:1,h:1}:m(k))}),x};(0,dr.useEffect)(()=>{(()=>{try{if(o){let x=xa(o),w=x.bottomSection.lg.filter(O=>r.includes(O.i)).map(m),S=x.bottomSection.md.filter(O=>r.includes(O.i)).map(m),k=x.bottomSection.sm.filter(O=>r.includes(O.i)).map(m),T=(x.bottomSection.xs||[]).filter(O=>r.includes(O.i)).map(m),P=(x.bottomSection.xxs||[]).filter(O=>r.includes(O.i)).map(m),D=DA;r.forEach(O=>{let z=w.some(N=>N.i===O),I=S.some(N=>N.i===O),A=k.some(N=>N.i===O),j=T.some(N=>N.i===O),E=P.some(N=>N.i===O);if(!z||!I||!A||!j||!E){let N=ka.find(B=>B.id===O);if(N){let B,C="lg";if(z?(B=w.find(F=>F.i===O),C="lg"):I?(B=S.find(F=>F.i===O),C="md"):A?(B=k.find(F=>F.i===O),C="sm"):j?(B=T.find(F=>F.i===O),C="xs"):E&&(B=P.find(F=>F.i===O),C="xxs"),B||(B=fh(w,O,N.defaultSize.w,N.defaultSize.h,o)),!z){let F=fh(w,O,Math.min(B.w,D.lg),B.h,o);w.push(F)}if(!I){let F={i:O,x:0,y:ta,w:Math.min(B.w,D.md),h:B.h};S.push(F)}if(!A){let F={i:O,x:0,y:ta,w:Math.min(B.w,D.sm),h:B.h};k.push(F)}if(!j){let F={i:O,x:0,y:ta,w:Math.min(B.w,D.xs),h:B.h};T.push(F)}if(!E){let F={i:O,x:0,y:ta,w:D.xxs,h:B.h};P.push(F)}}}}),i({lg:w,md:S,sm:k,xs:T,xxs:P})}}catch(x){console.error("Error loading layouts:",x);let w=(k,T)=>{let P=ka.find(A=>A.id===k),D=DA[T],O=T==="xxs"?1:Math.min((P==null?void 0:P.defaultSize.w)||6,D),z=(P==null?void 0:P.defaultSize.h)||(T==="lg"?4:3);return m({i:k,x:0,y:0,w:O,h:z})},S={lg:r.map(k=>w(k,"lg")),md:r.map(k=>w(k,"md")),sm:r.map(k=>w(k,"sm")),xs:r.map(k=>w(k,"xs")),xxs:r.map(k=>w(k,"xxs"))};i(S)}})()},[o,r]);let g=b=>{let x=new CustomEvent("journalit:widgets-changed",{detail:{activeWidgets:b}});document.dispatchEvent(x)},v=(b,x)=>{let w=P=>!P||typeof P!="object"?null:{i:typeof P.i=="string"?P.i:"unknown",x:typeof P.x=="number"&&isFinite(P.x)?P.x:0,y:typeof P.y=="number"&&isFinite(P.y)?P.y===1/0?ta:P.y:0,w:typeof P.w=="number"&&isFinite(P.w)&&P.w>0?P.w:1,h:typeof P.h=="number"&&isFinite(P.h)&&P.h>0?P.h:1},S=(b==null?void 0:b.map(w).filter(P=>P!==null))||[],k=Object.fromEntries(Object.entries(x||{}).map(([P,D])=>[P,(D==null?void 0:D.map(w).filter(O=>O!==null))||[]])),T=new CustomEvent("layout-changed");if(document.dispatchEvent(T),t&&o)try{let P=xa(o),D=c||"lg",O=S.map(j=>j.i),z={...P,bottomSection:{...P.bottomSection,lg:k.lg||[],md:k.md||[],sm:k.sm||[],xs:k.xs||[],xxs:k.xxs||[]}},I=DA;["lg","md","sm","xs","xxs"].forEach(j=>{if(j===D)return;let E=z.bottomSection[j],N=E.map(B=>B.i);z.bottomSection[j]=E.filter(B=>O.includes(B.i)),O.forEach(B=>{if(!N.includes(B)){let C=S.find(F=>F.i===B);if(C){let F=ka.find(_=>_.id===B),M=(F==null?void 0:F.defaultSize)||{w:6,h:4};z.bottomSection[j].push({i:B,x:0,y:ta,w:Math.min(Math.max(1,Math.floor(C.w*I[j]/I[D])),I[j]),h:C.h})}}})}),Ha(o,"Default",z)}catch(P){console.error("Error saving layout in handleLayoutChange:",P)}},h=b=>{var S,k;if(!ka.find(T=>T.id===b))return dr.default.createElement("div",{className:"journalit-dashboard-widget-error"},"Unknown widget type: ",b);let w=((k=(S=o==null?void 0:o.settings)==null?void 0:S.trade)==null?void 0:k.dateFormat)||tr();switch(b){case"pnlChart":return dr.default.createElement(wse,{filters:e,dateFormat:w});case"performanceCalendar":return dr.default.createElement(Sse,{filters:e,dateFormat:w});case"dailyPerformance":return dr.default.createElement(Pse,{filters:e,dateFormat:w});case"tradesChart":return dr.default.createElement(Ise,{filters:e,dateFormat:w});case"drawdownChart":return dr.default.createElement(Lse,{filters:e,dateFormat:w});case"recentTrades":return dr.default.createElement(Mse,{filters:e,dateFormat:w});case"rollingWinRate":return dr.default.createElement(nR,{filters:e,dateFormat:w});case"rollingStats":return dr.default.createElement(oR,{filters:e,dateFormat:w});default:return dr.default.createElement("div",{className:"journalit-dashboard-widget-error"},"Widget not implemented: ",b)}},y=f(a);return dr.default.createElement("div",{className:`journalit-dashboard-grid-layout ${t?"is-editing":""}`,style:{padding:"0",margin:"0"}},dr.default.createElement(aR,{isEditing:t},dr.default.createElement(bze,{className:"layout",layouts:y,breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:DA,rowHeight:xze,isResizable:t,isDraggable:t,draggableCancel:t?".journalit-dashboard-widget-remove, .journalit-dashboard-widget-remove *":void 0,onLayoutChange:v,onWidthChange:u,onBreakpointChange:p,compactType:"vertical",preventCollision:!1,useCSSTransforms:!0,containerPadding:[0,0],margin:[_se,_se]},r.map(b=>dr.default.createElement("div",{key:b},dr.default.createElement(()=>{var P;let w=D=>{D.stopPropagation(),n(b);let O=r.filter(z=>z!==b);g(O)},S=["pnlChart","drawdownChart"],k=t||S.includes(b),T=!t&&S.includes(b);return dr.default.createElement("div",{className:"journalit-dashboard-widget",style:{position:"relative",width:"100%",height:"100%",display:"flex",flexDirection:"column",backgroundColor:"transparent",borderRadius:"6px",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",overflow:"hidden"}},t&&dr.default.createElement("button",{className:"journalit-dashboard-widget-remove",onClick:w,onMouseDown:D=>{D.preventDefault(),D.stopPropagation()},style:{position:"absolute",top:"4px",right:"4px",backgroundColor:"var(--background-modifier-error)",color:"white",border:"none",borderRadius:"50%",width:"22px",height:"22px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",cursor:"pointer",zIndex:1e4,padding:0,fontWeight:"bold",lineHeight:1},"aria-label":"Remove widget"},"\u2715"),T&&dr.default.createElement("div",{className:"journalit-dashboard-widget-minimal-header",style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"4px 12px 4px 12px",height:"24px",backgroundColor:"transparent",borderBottom:"1px solid rgba(var(--background-modifier-border-rgb, 0, 0, 0), 0.4)",opacity:.8}},dr.default.createElement("div",{className:"journalit-dashboard-widget-title",style:{fontWeight:"500",fontSize:"13px",color:"var(--text-muted)",letterSpacing:"0.3px",textAlign:"center",width:"100%"}},((P=ka.find(D=>D.id===b))==null?void 0:P.name)||b)),dr.default.createElement("div",{className:"journalit-dashboard-widget-content",style:{flex:1,padding:"4px 4px 2px 1px",height:T?"calc(100% - 24px)":"100%",overflow:"hidden"}},h(b)))},null))))))}});var qc,$se,Wse=L(()=>{qc=q(Y()),$se=({availableWidgets:e,activeWidgets:t,onAddWidget:r,onClose:n})=>(console.warn("ComponentSelector is deprecated, use UnifiedComponentSelector instead"),qc.default.createElement("div",{className:"journalit-dashboard-component-selector"},qc.default.createElement("div",{className:"journalit-dashboard-component-selector-header"},qc.default.createElement("h3",null,"Add Widget"),qc.default.createElement("button",{className:"journalit-dashboard-component-selector-close",onClick:n,"aria-label":"Close"},"\xD7")),qc.default.createElement("div",{className:"journalit-dashboard-component-selector-list"},e.map(o=>qc.default.createElement("div",{key:o.id,className:"journalit-dashboard-component-selector-item",onClick:()=>{r(o.id),n()},style:{opacity:t.includes(o.id)?.5:1}},qc.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-name"},o.name),o.description&&qc.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-description"},o.description),o.category&&qc.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-category"},o.category),t.includes(o.id)&&qc.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-badge"},"Added"))))))});var ks,sR,Rse=L(()=>{ks=q(Y());eg();pt();iR();Wse();B0();sR=({filters:e,isEditing:t,hideAddButton:r=!1})=>{let n=xe(),[o,a]=(0,ks.useState)(!1),[i,s]=(0,ks.useState)([]);(0,ks.useEffect)(()=>{let d=u=>{s([...u.detail.activeWidgets])};return document.addEventListener("journalit:widgets-changed",d),()=>{document.removeEventListener("journalit:widgets-changed",d)}},[]),(0,ks.useEffect)(()=>{let d=()=>{try{if(n){let m=xa(n).bottomSection.lg.map(f=>f.i);s(m)}}catch(p){console.error("Error initializing layout in BottomSection:",p),s(["pnlChart","performanceCalendar","dailyPerformance"])}};d();let u=()=>{d()};return document.addEventListener("journalit:settings-updated",u),()=>{document.removeEventListener("journalit:settings-updated",u)}},[n]),(0,ks.useEffect)(()=>{!t&&o&&a(!1)},[t]);let l=d=>{if(n)try{let u=xa(n),p=ka.find(y=>y.id===d);if(!p)throw new Error(`Widget definition not found: ${d}`);if(i.includes(d))return;let m=fh(u.bottomSection.lg,d,p.defaultSize.w,p.defaultSize.h,n),f={lg:12,md:6,sm:4,xs:2,xxs:1},g={};Object.keys(f).forEach(y=>{let b=f[y],x=Math.min(p.defaultSize.w,b);g[y]={i:d,x:0,y:ta,w:x,h:p.defaultSize.h}});let v={...u,bottomSection:{lg:[...u.bottomSection.lg,g.lg],md:[...u.bottomSection.md,g.md],sm:[...u.bottomSection.sm,g.sm],xs:[...u.bottomSection.xs||[],g.xs],xxs:[...u.bottomSection.xxs||[],g.xxs]}};Ha(n,"Default",v);let h=[...i,d];s(h),a(!1)}catch(u){console.error("Error adding widget in BottomSection:",u)}},c=d=>{if(n)try{let u=xa(n),p={...u,bottomSection:{lg:u.bottomSection.lg.filter(g=>g.i!==d),md:u.bottomSection.md.filter(g=>g.i!==d),sm:u.bottomSection.sm.filter(g=>g.i!==d),xs:(u.bottomSection.xs||[]).filter(g=>g.i!==d),xxs:(u.bottomSection.xxs||[]).filter(g=>g.i!==d)}};Ha(n,"Default",p);let m=i.filter(g=>g!==d);s(m);let f=new CustomEvent("journalit:widgets-changed",{detail:{activeWidgets:m}});document.dispatchEvent(f)}catch(u){console.error("Error removing widget in BottomSection:",u)}};return ks.default.createElement("div",{className:"journalit-dashboard-bottom-section",style:{padding:"0",backgroundColor:"transparent"}},t&&!r&&ks.default.createElement("div",{className:"journalit-dashboard-bottom-section-header",style:{display:"flex",justifyContent:"flex-end",alignItems:"center",padding:"0 10px"}},ks.default.createElement("button",{className:"journalit-dashboard-add-widget-button",onClick:()=>{a(!o)},style:{backgroundColor:"var(--interactive-accent)",color:"var(--text-on-accent)",border:"none",borderRadius:"4px",padding:"4px 8px",fontSize:"12px",cursor:"pointer"}},"Add Widget")),ks.default.createElement("div",{style:{position:"relative"}},!r&&o&&ks.default.createElement($se,{availableWidgets:ka,activeWidgets:i,onAddWidget:l,onClose:()=>{a(!1)}}),ks.default.createElement(Bse,{filters:e,isEditing:t,widgets:i,onRemoveWidget:d=>{c(d)}})))}});var Use=L(()=>{Rse()});var _t,Vse,Hse=L(()=>{_t=q(Y());T1();B0();iR();pt();eg();Vse=({activeMetrics:e,activeWidgets:t,onAddMetric:r,onAddWidget:n,onClose:o})=>{let a=xe(),[i,s]=(0,_t.useState)("all"),[l,c]=(0,_t.useState)(""),d=Array.from(new Set(ka.map(f=>f.category||"general"))),u=[{id:"all",name:"All Widgets"},{id:"metrics",name:"Metrics"},...d.map(f=>({id:f,name:f.charAt(0).toUpperCase()+f.slice(1)}))],p=S1.filter(f=>l===""||f.name.toLowerCase().includes(l.toLowerCase())),m=ka.filter(f=>{let g=l===""||f.name.toLowerCase().includes(l.toLowerCase()),v=i==="all"||f.category===i;return g&&v});return _t.default.createElement("div",{className:"unified-selector-overlay",onClick:f=>{f.target===f.currentTarget&&o()}},_t.default.createElement("div",{className:"journalit-dashboard-component-selector",onClick:f=>f.stopPropagation()},_t.default.createElement("div",{className:"journalit-dashboard-component-selector-header"},_t.default.createElement("h3",null,"Add Widget"),_t.default.createElement("button",{className:"journalit-dashboard-component-selector-close",onClick:o,"aria-label":"Close"},_t.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_t.default.createElement("path",{d:"M13 1L1 13M1 1L13 13",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})))),_t.default.createElement("div",{className:"journalit-dashboard-component-selector-search"},_t.default.createElement("input",{type:"text",placeholder:"Search widgets...",value:l,onChange:f=>c(f.target.value)})),_t.default.createElement("div",{className:"journalit-dashboard-component-selector-categories"},u.map(f=>_t.default.createElement("button",{key:f.id,className:`journalit-dashboard-component-selector-category ${i===f.id?"active":""}`,onClick:()=>s(f.id)},f.name))),_t.default.createElement("div",{className:"journalit-dashboard-component-selector-list"},i==="all"&&_t.default.createElement(_t.default.Fragment,null,p.length===0?_t.default.createElement("div",{className:"journalit-dashboard-component-selector-empty"},"No metrics found"):p.map(f=>_t.default.createElement("div",{key:f.id,className:"journalit-dashboard-component-selector-item",onClick:async()=>{if(!e.includes(f.id))if(a)try{let g=xa(a),v=[...g.topSection];v.includes(f.id)||v.push(f.id);let h={...g,topSection:v};try{await Ha(a,"Default",h),r(f.id);let y=new CustomEvent("journalit:metrics-changed",{detail:{activeMetrics:v}});document.dispatchEvent(y)}catch(y){console.error("Error saving layout:",y)}}catch(g){console.error("Error adding metric:",g)}else r(f.id)},style:{opacity:e.includes(f.id)?.5:1}},_t.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-name"},f.name),f.description&&_t.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-description"},f.description),e.includes(f.id)&&_t.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-badge"},"Added"))),p.length>0&&m.length>0&&_t.default.createElement("div",{className:"journalit-dashboard-component-selector-divider"}),m.length===0?_t.default.createElement("div",{className:"journalit-dashboard-component-selector-empty"},"No widgets found"):m.map(f=>_t.default.createElement("div",{key:f.id,className:"journalit-dashboard-component-selector-item",onClick:async()=>{if(!t.includes(f.id)&&a)try{let g=xa(a),v=ka.find(b=>b.id===f.id);if(!v)throw new Error(`Widget definition not found: ${f.id}`);let h=fh(g.bottomSection.lg,f.id,v.defaultSize.w,v.defaultSize.h,a),y={...g,bottomSection:{lg:[...g.bottomSection.lg,h],md:[...g.bottomSection.md,h],sm:[...g.bottomSection.sm,h],xs:[...g.bottomSection.xs||[],{...h,w:Math.min(h.w,2)}],xxs:[...g.bottomSection.xxs||[],{...h,w:1}]}};try{await Ha(a,"Default",y),n(f.id);let b=[...t,f.id],x=new CustomEvent("journalit:widgets-changed",{detail:{activeWidgets:b}});document.dispatchEvent(x)}catch(b){console.error("Error saving layout after adding widget:",b)}}catch(g){console.error("Error adding widget:",g)}},style:{opacity:t.includes(f.id)?.5:1}},_t.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-name"},f.name),f.description&&_t.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-description"},f.description),t.includes(f.id)&&_t.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-badge"},"Added")))),i==="metrics"&&_t.default.createElement(_t.default.Fragment,null,p.length===0?_t.default.createElement("div",{className:"journalit-dashboard-component-selector-empty"},"No metrics found"):p.map(f=>_t.default.createElement("div",{key:f.id,className:"journalit-dashboard-component-selector-item",onClick:async()=>{if(!e.includes(f.id))if(a)try{let g=xa(a),v=[...g.topSection];v.includes(f.id)||v.push(f.id);let h={...g,topSection:v};try{await Ha(a,"Default",h),r(f.id);let y=new CustomEvent("journalit:metrics-changed",{detail:{activeMetrics:v}});document.dispatchEvent(y)}catch(y){console.error("Error saving layout:",y)}}catch(g){console.error("Error adding metric:",g)}else r(f.id)},style:{opacity:e.includes(f.id)?.5:1}},_t.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-name"},f.name),f.description&&_t.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-description"},f.description),e.includes(f.id)&&_t.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-badge"},"Added")))),i!=="metrics"&&i!=="all"&&_t.default.createElement(_t.default.Fragment,null,m.length===0?_t.default.createElement("div",{className:"journalit-dashboard-component-selector-empty"},"No widgets found"):m.map(f=>_t.default.createElement("div",{key:f.id,className:"journalit-dashboard-component-selector-item",onClick:async()=>{if(!t.includes(f.id)&&a)try{let g=xa(a),v=ka.find(b=>b.id===f.id);if(!v)throw new Error(`Widget definition not found: ${f.id}`);let h=fh(g.bottomSection.lg,f.id,v.defaultSize.w,v.defaultSize.h,a),y={...g,bottomSection:{lg:[...g.bottomSection.lg,h],md:[...g.bottomSection.md,h],sm:[...g.bottomSection.sm,h],xs:[...g.bottomSection.xs||[],{...h,w:Math.min(h.w,2)}],xxs:[...g.bottomSection.xxs||[],{...h,w:1}]}};try{await Ha(a,"Default",y),n(f.id);let b=[...t,f.id],x=new CustomEvent("journalit:widgets-changed",{detail:{activeWidgets:b}});document.dispatchEvent(x)}catch(b){console.error("Error saving layout after adding widget:",b)}}catch(g){console.error("Error adding widget:",g)}},style:{opacity:t.includes(f.id)?.5:1}},_t.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-name"},f.name),f.description&&_t.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-description"},f.description),t.includes(f.id)&&_t.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-badge"},"Added")))))))}});var Ss,qse,Gse=L(()=>{Ss=q(Y());eo();d9();Use();Hse();Td();pt();qse=({isLoading:e,dashboardData:t,filters:r,isEditing:n,showUnifiedSelector:o,activeMetrics:a,activeWidgets:i,onAddMetric:s,onAddWidget:l,onCloseSelector:c,openUnifiedSelector:d})=>{let u=xe(),p=()=>{if(!u||!u.app)return;new jo({app:u.app,plugin:u}).open()};return!e&&t&&t.trades.length===0?Ss.default.createElement("div",{style:{padding:"40px 0",display:"flex",justifyContent:"center",alignItems:"center",flex:"1",width:"100%",minHeight:"300px"}},Ss.default.createElement(et,{message:"No trading data available",subMessage:"Add some trades to see your dashboard come to life",iconSize:56,actionButtonText:"Add Trade",onActionButtonClick:p})):Ss.default.createElement(Ss.default.Fragment,null,n&&Ss.default.createElement("div",{className:"journalit-dashboard-unified-selector-button-container",style:{marginBottom:"4px"}},Ss.default.createElement("button",{className:"journalit-dashboard-add-component-button",onClick:d},Ss.default.createElement("span",null,"+")," Add Widget")),Ss.default.createElement("div",{className:"journalit-dashboard-unified-container",style:{gap:"10px",backgroundColor:"transparent"}},Ss.default.createElement("div",{style:{position:"relative"}},Ss.default.createElement(D2,{filters:r,isEditing:n,hideAddButton:!0})),Ss.default.createElement("div",{style:{position:"relative"}},Ss.default.createElement(sR,{filters:r,isEditing:n,hideAddButton:!0}))),o&&Ss.default.createElement(Vse,{activeMetrics:a,activeWidgets:i,onAddMetric:s,onAddWidget:l,onClose:c}))}});var vn,lR,Yse=L(()=>{vn=q(Y());eg();s0();ba();pt();B0();lR=()=>{var D,O;let e=xe(),[t,r]=(0,vn.useState)(()=>({dateRange:[null,null],accounts:[],tickers:[],setups:[],tradeTypes:[],statuses:[]})),[n,o]=(0,vn.useState)(!1),[a,i]=(0,vn.useState)(!1),[s,l]=(0,vn.useState)(!1),[c,d]=(0,vn.useState)(0),[u,p]=(0,vn.useState)([]),[m,f]=(0,vn.useState)([]);(0,vn.useEffect)(()=>{d(z=>z+1)},[m,u]);let g=(0,vn.useCallback)(z=>{f(z.detail.activeWidgets)},[]),v=(0,vn.useCallback)(z=>{p(z.detail.activeMetrics)},[]),h=(0,vn.useCallback)(()=>{d(z=>z+1)},[]);(0,vn.useEffect)(()=>(document.addEventListener("journalit:widgets-changed",g),()=>{document.removeEventListener("journalit:widgets-changed",g)}),[g]);let y=(0,vn.useMemo)(()=>e?xa(e):null,[e]);(0,vn.useEffect)(()=>(document.querySelector('[data-dashboard-styles="true"]')||(Sd(),Gf(),document.documentElement.setAttribute("data-dashboard-styles","true")),(async()=>{try{e&&y&&(p(y.topSection),f(y.bottomSection.lg.map(I=>I.i)),requestAnimationFrame(()=>{i0()}))}catch(I){console.error("Failed to initialize dashboard:",I)}})(),document.addEventListener("journalit:metrics-changed",v),document.addEventListener("journalit:trade-data-changed",h),()=>{document.removeEventListener("journalit:metrics-changed",v),document.removeEventListener("journalit:trade-data-changed",h)}),[e,y,v,h]),(0,vn.useEffect)(()=>{var z,I;((I=(z=e==null?void 0:e.settings)==null?void 0:z.trade)==null?void 0:I.skipWeekends)!==void 0&&requestAnimationFrame(()=>{i0()})},[(O=(D=e==null?void 0:e.settings)==null?void 0:D.trade)==null?void 0:O.skipWeekends]);let b=(0,vn.useCallback)(z=>{r(z)},[]),x=(0,vn.useCallback)(()=>{i(z=>{let I=!z;return I===!1&&s&&l(!1),I})},[s]),w=(0,vn.useCallback)(()=>{l(!0),setTimeout(()=>Gf(),10)},[]),S=(0,vn.useCallback)(()=>{l(!1)},[]),k=(0,vn.useCallback)(z=>{try{if(!u.includes(z)&&(p(I=>[...I,z]),e&&y)){let I={...y,topSection:[...u,z]};Ha(e,"Default",I).catch(A=>{console.error("Error saving layout after adding metric:",A)})}}catch(I){console.error("Error in handleAddMetric:",I)}},[u,e,y]),T=(0,vn.useMemo)(()=>{let z={lg:12,md:6,sm:4,xs:2,xxs:1};return(I,A,j)=>{let E=z[A],N=Math.min(j.defaultSize.w,E);return{i:I,x:0,y:ta,w:N,h:j.defaultSize.h}}},[]),P=(0,vn.useCallback)(z=>{if(!(!e||!y||m.includes(z)))try{let I=ka.find(N=>N.id===z);if(!I){console.warn(`Widget definition not found: ${z}`);return}let j=["lg","md","sm","xs","xxs"].reduce((N,B)=>(N[B]=T(z,B,I),N),{}),E={...y,bottomSection:{lg:[...y.bottomSection.lg,j.lg],md:[...y.bottomSection.md,j.md],sm:[...y.bottomSection.sm,j.sm],xs:[...y.bottomSection.xs||[],j.xs],xxs:[...y.bottomSection.xxs||[],j.xxs]}};Ha(e,"Default",E),f(N=>[...N,z])}catch(I){console.error("Error adding widget:",I)}},[m,e,y,T]);return{filters:t,setFilters:r,isLoading:n,isEditing:a,showUnifiedSelector:s,selectorKey:c,activeMetrics:u,activeWidgets:m,handleFilterChange:b,toggleEditMode:x,openUnifiedSelector:w,closeUnifiedSelector:S,handleAddMetric:k,handleAddWidget:P}}});var Kse=L(()=>{Yse()});var Xm,cl,mS,wze,kze,Jse=L(()=>{Xm=q(Y());Xf();ba();eY();Gse();Kse();jv();pt();cl="journalit-dashboard-view",mS=class extends us{getDisplayText(){return"Journalit Dashboard"}getViewType(){return cl}getIcon(){return"grip"}async onOpen(){try{await super.onOpen(),Pc(!0,!0,!0,!0),Cv(!0,!0,!0,!0),this.containerEl&&(this.containerEl.classList.add("journalit-dashboard-view-container"),Object.assign(this.containerEl.style,{padding:"0",overflow:"hidden"})),Gf()}catch(t){console.error("Error in DashboardView.onOpen:",t)}}async onClose(){try{await super.onClose()}catch(t){console.error("Error in DashboardView.onClose:",t)}}getRenderFunction(){return()=>Xm.default.createElement(wze,{leaf:this.leaf,view:this})}},wze=({leaf:e,view:t})=>{var g,v;let r=xe(),{filters:n,isLoading:o,isEditing:a,showUnifiedSelector:i,activeMetrics:s,activeWidgets:l,handleFilterChange:c,toggleEditMode:d,openUnifiedSelector:u,closeUnifiedSelector:p,handleAddMetric:m,handleAddWidget:f}=lR();return r?Xm.default.createElement(C1,{app:r.app,tradeService:r.tradeService,filters:n,defaultRiskAmount:(v=(g=r==null?void 0:r.settings)==null?void 0:g.trade)==null?void 0:v.defaultRiskAmount},Xm.default.createElement("div",{className:"journalit-dashboard-view"},Xm.default.createElement(k1,{filters:n,onFilterChange:c,isEditing:a,onToggleEditMode:d}),Xm.default.createElement(kze,{isLoading:o,filters:n,isEditing:a,showUnifiedSelector:i,activeMetrics:s,activeWidgets:l,onAddMetric:m,onAddWidget:f,onCloseSelector:p,openUnifiedSelector:u}))):Xm.default.createElement("div",{className:"journalit-dashboard-view"},"Loading...")},kze=e=>{let{dashboardData:t}=gm();return Xm.default.createElement(qse,{...e,dashboardData:t})}});var Xse=L(()=>{tg()});var Qse=L(()=>{tg();QO();eg();s0();Xse()});var cR=L(()=>{Jse();Qse()});function LA(e,t=200){typeof window!="undefined"&&"requestIdleCallback"in window?window.requestIdleCallback(()=>{try{e()}catch(r){console.error("Error in idle scheduled function:",r)}}):setTimeout(()=>{try{e()}catch(r){console.error("Error in scheduled function:",r)}},t)}function fS(e,t=100){return new Promise(r=>{if(e.length===0){r();return}let n=0;function o(){if(n>=e.length){r();return}try{let a=e[n++];a(),n<e.length?setTimeout(o,t):r()}catch(a){console.error(`Error in scheduled operation at index ${n-1}:`,a),setTimeout(o,t)}}o()})}var NA=L(()=>{});async function dle(e,t){let r={},n=Si.getTradesDRCDate(e,t),o=await Si.getDRCFileName(n,t);return o&&(r.tradeToDRC=o),r}async function gS(e,t){let r={},n=await Si.getParentWeekly(e,t);return n&&(r.drcToWeekly=n),r}async function ule(e,t){let r={},n=await Si.getParentMonthly(e,t);return n&&(r.weeklyToMonthly=n),r}var Si,uR=L(()=>{wt();ci();Si=class{static generateLinksSection(t){let r=[];if(t.tradeToDRC&&r.push(`**Trade \u2192 DRC**: [[${t.tradeToDRC}]]`),t.drcToWeekly&&r.push(`**DRC \u2192 Weekly**: [[${t.drcToWeekly}]]`),t.weeklyToMonthly&&r.push(`**Weekly \u2192 Monthly**: [[${t.weeklyToMonthly}]]`),t.dailyToWeekly&&r.push(`**Daily \u2192 Weekly**: [[${t.dailyToWeekly}]]`),t.relatedTrades&&t.relatedTrades.length>0){let n=t.relatedTrades.map(o=>`[[${o}]]`).join(", ");r.push(`**Related Trades**: ${n}`)}if(t.relatedAccounts&&t.relatedAccounts.length>0){let n=t.relatedAccounts.map(o=>`[[${o}]]`).join(", ");r.push(`**Related Accounts**: ${n}`)}return r.length===0?"":`## \u2194\uFE0E Links

${r.join(`
`)}`}static updateLinksSection(t,r){let n=/##  Links\n\n?[\s\S]*?(?=\n## |\n---|$)/g,o=this.generateLinksSection(r),a=t.match(n);if(!o.trim()&&!a)return t;let i=t.replace(n,"");return i=i.replace(/\n\n\n+/g,`

`),i=i.trim(),o.trim()&&(i=i+`

`+o),i===t?t:i}static removeLinksSection(t){let r=/##  Links\n\n?[\s\S]*?(?=\n## |\n---|$)/g;return t.replace(r,"").trim()}static async detectNoteType(t,r){let o=(await r.read(t)).match(/^---\n([\s\S]*?)\n---/),a={};if(o)try{let s=o[1],l=s.match(/^type:\s*(.+)$/m);l&&(a.type=l[1].trim().replace(/['"]/g,""));let c=s.match(/^date:\s*(.+)$/m);c&&(a.date=c[1].trim().replace(/['"]/g,""));let d=s.match(/^entryTime:\s*(.+)$/m);d&&(a.entryTime=d[1].trim().replace(/['"]/g,""))}catch(s){console.error("Error parsing frontmatter:",s)}let i={type:"unknown",filePath:t.path,fileName:t.basename};if(a.type==="trade"||t.path.includes("/trades/")?i.type="trade":a.type==="drc"?i.type="drc":a.type==="weekly-review"?i.type="weekly":a.type==="monthly-review"?i.type="monthly":(a.type==="account"||t.path.includes("/accounts/"))&&(i.type="account"),a.date){let s=Xt(a.date);s&&(i.date=s)}else if(a.entryTime&&i.type==="trade"){let s=Xt(a.entryTime);s&&(i.date=s)}return i}static async getRelatedTrades(t,r){let n=[];try{let a=r.app.vault.getMarkdownFiles().filter(i=>i.path.includes("/trades/")&&i.name.includes("-T"));for(let i of a){let s=await this.detectNoteType(i,r.app.vault);s.type==="trade"&&s.date&&this.isSameDay(s.date,t)&&n.push(i.basename)}}catch(o){console.error("Error getting related trades:",o)}return n}static async getParentWeekly(t,r){try{let n=bo(t),o=this.getWeekNumber(n),a=n.getFullYear(),i=`W${o.toString().padStart(2,"0")}-Review`,s=r.serviceManager.getFolderPathService(),l=r.app.vault.getMarkdownFiles().filter(u=>u.basename===i).filter(u=>s.isJournalPath(u.path)).sort((u,p)=>p.path.localeCompare(u.path)),c=new RegExp(`[/\\\\]${a}[/\\\\]`),d=l.find(u=>c.test(u.path));return d?`${d.path.replace(/\.md$/,"")}|${d.basename}`:null}catch(n){return console.error("Error getting parent weekly:",n),null}}static async getParentMonthly(t,r){try{let n=t.getMonth()+1,o=t.getFullYear(),a=`${n.toString().padStart(2,"0")}-Review`,i=r.serviceManager.getFolderPathService(),s=r.app.vault.getMarkdownFiles().filter(d=>d.basename===a).filter(d=>i.isJournalPath(d.path)).sort((d,u)=>u.path.localeCompare(d.path)),l=new RegExp(`[/\\\\]${o}[/\\\\]`),c=s.find(d=>l.test(d.path));return c?`${c.path.replace(/\.md$/,"")}|${c.basename}`:null}catch(n){return console.error("Error getting parent monthly:",n),null}}static async getChildDailies(t,r){let n=[];try{let o=r.app.vault.getMarkdownFiles();for(let a=0;a<7;a++){let i=new Date(t);if(i.setDate(t.getDate()+a),i.getDay()===0||i.getDay()===6)continue;let s=o.filter(l=>{let c=this.detectNoteTypeSync(l);return c.type==="drc"&&c.date&&this.isSameDay(c.date,i)});n.push(...s.map(l=>l.basename))}}catch(o){console.error("Error getting child dailies:",o)}return n}static async getChildWeeklies(t,r,n){let o=[];try{let a=n.app.vault.getMarkdownFiles(),i=new RegExp(`[/\\\\]${r}[/\\\\]`),s=a.filter(l=>l.basename.match(/^W\d{2}-Review$/)&&i.test(l.path));for(let l of s){let c=await this.detectNoteType(l,n.app.vault);if(c.type==="weekly"&&c.date){let d=Wr(c.date)?c.date.getMonth()+1:null,u=Wr(c.date)?c.date.getFullYear():null;d===t&&u===r&&o.push(`${l.path.replace(/\.md$/,"")}|${l.basename}`)}}}catch(a){console.error("Error getting child weeklies:",a)}return o}static detectNoteTypeSync(t){let r={type:"unknown",filePath:t.path,fileName:t.basename};return t.path.includes("/trades/")?r.type="trade":t.path.includes("/accounts/")&&(r.type="account"),r}static isSameDay(t,r){return!t||!r||Wr(t)===null||Wr(r)===null?!1:t.getFullYear()===r.getFullYear()&&t.getMonth()===r.getMonth()&&t.getDate()===r.getDate()}static getWeekNumber(t){let r=new Date(t.getFullYear(),0,1),n=(t.getTime()-r.getTime())/864e5;return Math.ceil((n+r.getDay()+1)/7)}static getTradesDRCDate(t,r){return lr(t,r)}static async getDRCFileName(t,r){try{let n=t.getDate().toString().padStart(2,"0"),o=(t.getMonth()+1).toString().padStart(2,"0"),a=t.getFullYear().toString().slice(-2),i=`DRC-${n}${o}${a}`,s=r.serviceManager.getFolderPathService(),l=r.app.vault.getMarkdownFiles().filter(u=>u.basename===i).filter(u=>s.isJournalPath(u.path)).sort((u,p)=>p.path.localeCompare(u.path)),c=new RegExp(`[/\\\\]${t.getFullYear()}[/\\\\]`),d=l.find(u=>c.test(u.path));return d?`${d.path.replace(/\.md$/,"")}|${d.basename}`:null}catch(n){return console.error("Error getting DRC file name:",n),null}}}});var ec,ple,mle=L(()=>{ec=q(Y()),ple=({currentStep:e,totalSteps:t,stepLabels:r,className:n=""})=>{let o=Math.max(0,Math.min(100,e/t*100));return ec.default.createElement("div",{className:`wizard-progress-container ${n}`,role:"progressbar","aria-valuenow":e,"aria-valuemin":0,"aria-valuemax":t,"aria-label":`Step ${e} of ${t}`,tabIndex:0},ec.default.createElement("div",{className:"wizard-steps"},Array.from({length:t},(a,i)=>{let s=i+1,l=s<e,c=s===e,d=r==null?void 0:r[i];return ec.default.createElement("div",{key:s,className:`wizard-step ${l?"completed":""} ${c?"current":""}`,"aria-label":d?`${d}${l?" (completed)":c?" (current)":""}`:`Step ${s}`},ec.default.createElement("div",{className:"wizard-step-circle"},l?ec.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none","aria-hidden":"true"},ec.default.createElement("path",{d:"M2 6L5 9L10 3",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})):ec.default.createElement("span",{className:"wizard-step-number","aria-hidden":"true"},s)),d&&ec.default.createElement("div",{className:"wizard-step-label"},d))})),ec.default.createElement("div",{className:"wizard-progress-track","aria-hidden":"true"},ec.default.createElement("div",{className:"wizard-progress-fill",style:{width:`${o}%`}})),ec.default.createElement("div",{className:"sr-only","aria-live":"polite","aria-atomic":"true"},"Step ",e," of ",t," completed",(r==null?void 0:r[e-1])&&`: ${r[e-1]}`))}});var _r,pR,zA=L(()=>{_r=[{id:"welcome",title:"Welcome to Journalit",description:"Your journey to better trading begins here",isOptional:!0},{id:"goal",title:"What's your goal?",description:"Help us personalize your experience"},{id:"segmentation",title:"Tell us about your trading",description:"Personalize your experience"},{id:"first-action",title:"Create your first trade",description:"Experience the core value immediately"},{id:"authentication",title:"Connect account",description:"Enable advanced features and sync",isOptional:!0,shouldShow:e=>e==="automation"},{id:"ftp-credentials",title:"Setup MT sync",description:"Automatic trade report collection",isOptional:!0,shouldShow:e=>e==="automation"},{id:"completion",title:"You're all set!",description:"Start your trading journey"}],pR=[{id:"create_trade",title:"Create your first Trade note",description:"Document your first trade to get started",completed:!1},{id:"generate_setup",title:"Add at least one Setup",description:"Define your trading strategies",completed:!1},{id:"tag_trade_outcome",title:"Tag a trade as Winner/Loser",description:"Track your trade performance",completed:!1,dependsOn:["create_trade"]},{id:"enable_mt5_sync",title:"Turn on MT5 Auto-Sync (beta free)",description:"Automate your trade data collection",completed:!1,isOptional:!0}]});function _A(e="email-auth-modal-styles"){if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=`
    /* === EmailAuthModal base styles ==================== */
    .email-auth-modal { padding: 20px; max-width: 400px; margin: 0 auto; }
    .email-auth-modal h3 { margin: 0 0 16px; font-size: 18px; font-weight: 600; color: var(--text-normal); }
    .modal-description { margin: 0 0 20px; color: var(--text-muted); line-height: 1.4; }
    .modal-field { margin-bottom: 16px; }
    .modal-field label { display: block; margin-bottom: 6px; font-weight: 500; color: var(--text-normal); }
    .modal-input { width: 100%; padding: 8px 12px; border: 1px solid var(--background-modifier-border); border-radius: 4px; background: var(--background-primary); color: var(--text-normal); font-size: 16px; }
    .modal-input:focus { outline: none; border-color: var(--interactive-accent); box-shadow: 0 0 0 2px var(--interactive-accent-hover); }
    .modal-input:disabled { opacity: 0.6; cursor: not-allowed; }
    .code-input { font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace; font-size: 16px; letter-spacing: 2px; text-align: center; }
    .modal-error { margin: 8px 0; padding: 8px 12px; background: var(--background-modifier-error); border: 1px solid var(--text-error); border-radius: 4px; color: var(--text-on-accent, #fff); font-size: 13px; font-weight: 500; text-align: center; }
    .modal-actions { display: flex; gap: 8px; margin-top: 20px; flex-wrap: wrap; }
    .modal-actions button { flex: 1 1 auto; min-width: 90px; white-space: nowrap; }
    .modal-footer { margin-top: 20px; padding-top: 16px; border-top: 1px solid var(--background-modifier-border); }
    .modal-footer-text { margin: 0; font-size: 12px; color: var(--text-muted); line-height: 1.3; }
    @media (max-width: 600px) {
      .modal-input { font-size: 18px !important; }
    }
    @media (max-width: 480px) {
      .modal-actions { flex-direction: column; }
      .modal-actions button { width: 100%; }
    }
  `,document.head.appendChild(t)}var mR=L(()=>{});var Pb,Cs,Qm=L(()=>{Pb=q(Y()),Cs=({title:e,subtitle:t,icon:r,className:n="",children:o})=>Pb.default.createElement("div",{className:`onboarding-slide ${n}`},r&&Pb.default.createElement("div",{className:"step-icon"},r),Pb.default.createElement("h2",null,e),t&&Pb.default.createElement("p",null,t),Pb.default.createElement("div",{className:"step-content"},o))});var Db,BA,fR=L(()=>{Db=q(Y()),BA=({icon:e,title:t,content:r,isPreview:n=!1,className:o=""})=>{let a=n?"insight-preview-card":"insight-card",i=n?"insight-preview-header":"insight-header",s=n?"insight-preview-icon":"insight-icon",l=n?"insight-preview-content":"insight-detail";return Db.default.createElement("div",{className:`${a} ${o}`},Db.default.createElement("div",{className:i},Db.default.createElement("span",{className:s},e),Db.default.createElement("strong",null,t)),Db.default.createElement("div",{className:l},r))}});var Ji,gR,fle=L(()=>{Ji=q(Y());er();Qm();fR();gR=({className:e=""})=>{let t=[{icon:Ji.default.createElement($a,{size:20}),title:"Win Rate Analysis",content:'"Your breakout setups have an 82% win rate vs 67% for pullbacks"'},{icon:Ji.default.createElement(xl,{size:20}),title:"Timing Patterns",content:'"Trades held 2-4 hours show 3x better risk-reward than scalps"'},{icon:Ji.default.createElement(ku,{size:20}),title:"Psychology Tracking",content:'"You take profits 15% too early when up more than $500"'}],r=["Your data, your device - Complete ownership and control","Works with any broker - MetaTrader sync + manual entry","Fully customizable - Track what matters to you"];return Ji.default.createElement(Cs,{title:"Welcome to Journalit",subtitle:"The trading journal that helps you turn insights into profits",className:`welcome-slide ${e}`},Ji.default.createElement("div",{className:"welcome-preview-section"},Ji.default.createElement("h3",null,"What you'll discover:"),Ji.default.createElement("div",{className:"insights-preview"},t.map((n,o)=>Ji.default.createElement(BA,{key:o,icon:n.icon,title:n.title,content:n.content,isPreview:!0})))),Ji.default.createElement("div",{className:"welcome-trust-indicators"},r.map((n,o)=>Ji.default.createElement("div",{key:o,className:"trust-item"},Ji.default.createElement("span",{className:"trust-icon"},Ji.default.createElement(Qo,{size:16})),Ji.default.createElement("span",null,n)))),Ji.default.createElement("div",{className:"welcome-tagline"},"Let's get you set up in under 60 seconds"))}});var dp,hR,gle=L(()=>{dp=q(Y());er();Qm();wC();hR=({selectedGoal:e,onGoalSelect:t,className:r=""})=>{let n=[{value:"psychology",label:"Understand My Trading Psychology",description:"Identify emotional patterns and improve decision-making to become a more disciplined trader",badge:"Build better habits",icon:dp.default.createElement(ku,{size:24})},{value:"patterns",label:"Find Performance Patterns",description:"Discover what makes your winning trades different and optimize your strategy for consistent profits",badge:"Most popular",icon:dp.default.createElement($a,{size:24})},{value:"automation",label:"Automate Everything",description:"Focus on trading while we handle the tracking - automatic data collection and analysis",badge:"Time saver",icon:dp.default.createElement(Eu,{size:24})}],o=a=>{switch(a){case"psychology":return"Understand My Trading Psychology";case"patterns":return"Find Performance Patterns";case"automation":return"Automate Everything";default:return""}};return dp.default.createElement(Cs,{title:"What's your trading goal?",subtitle:`Choose the approach that best fits your needs.
You can change this later.`,className:`goal-slide ${r}`},dp.default.createElement(zf,{options:n,selectedValue:e,onSelect:t,variant:"goal"}),e&&dp.default.createElement("div",{className:"goal-selection-info"},dp.default.createElement(Mo,{size:16})," You selected: ",dp.default.createElement("strong",null,o(e))))}});var Eb,hle,vle=L(()=>{Eb=q(Y());er();hle=({options:e,selectedValues:t,onSelectionChange:r,className:n=""})=>{let o=a=>{let i=t.includes(a)?t.filter(s=>s!==a):[...t,a];r(i)};return Eb.default.createElement("div",{className:`multi-select-options ${n}`},e.map(a=>{let i=t.includes(a.value);return Eb.default.createElement("div",{key:a.value,className:`multi-select-option ${i?"selected":""}`,onClick:()=>o(a.value),role:"button",tabIndex:0,onKeyPress:s=>s.key==="Enter"&&o(a.value)},Eb.default.createElement("div",{className:"option-checkbox"},i&&Eb.default.createElement(Mo,{size:16})),Eb.default.createElement("span",{className:"option-label"},a.label))}))}});var tc,vR,yle=L(()=>{tc=q(Y());Qm();vle();wC();vR=({userSegmentation:e,onSegmentationChange:t,className:r=""})=>{let n=[{value:"stocks",label:"Stocks"},{value:"forex",label:"Forex"},{value:"crypto",label:"Crypto"},{value:"options",label:"Options"},{value:"futures",label:"Futures"}],o=[{value:"daily",label:"Daily",description:"Multiple trades per day"},{value:"weekly",label:"Weekly",description:"1-5 trades per week"},{value:"monthly",label:"Monthly",description:"Less than 5 trades per month"},{value:"occasional",label:"Occasionally",description:"When good opportunities arise"}],a=[{value:"emotional-control",label:"Emotional Control",description:"Managing fear and greed in trades"},{value:"strategy-optimization",label:"Strategy Optimization",description:"Finding and refining profitable setups"},{value:"record-keeping",label:"Record Keeping",description:"Consistently tracking all trades and data"},{value:"risk-management",label:"Risk Management",description:"Setting proper position sizes and stops"}],i=c=>{t({...e,instruments:c})},s=c=>{t({...e,frequency:c})},l=c=>{t({...e,challenge:c})};return tc.default.createElement(Cs,{title:"Tell us about your trading",subtitle:"Help us personalize your experience based on your trading style.",className:`segmentation-slide ${r}`},tc.default.createElement("div",{className:"segmentation-questions"},tc.default.createElement("div",{className:"segmentation-question"},tc.default.createElement("h3",null,"What do you primarily trade? (Select all that apply)"),tc.default.createElement(hle,{options:n,selectedValues:e.instruments,onSelectionChange:i})),tc.default.createElement("div",{className:"segmentation-question"},tc.default.createElement("h3",null,"How often do you trade?"),tc.default.createElement(zf,{options:o,selectedValue:e.frequency,onSelect:s})),tc.default.createElement("div",{className:"segmentation-question"},tc.default.createElement("h3",null,"What's your biggest challenge?"),tc.default.createElement(zf,{options:a,selectedValue:e.challenge,onSelect:l}))))}});var Zd,Ib,$A=L(()=>{Zd=q(Y());er();Ib=({title:e,subtitle:t,actions:r,children:n,className:o=""})=>Zd.default.createElement("div",{className:`success-state ${o}`},Zd.default.createElement("div",{className:"success-checkmark"},Zd.default.createElement(Qo,{size:48})),Zd.default.createElement("h3",null,e),t&&Zd.default.createElement("p",null,t),r&&r.length>0&&Zd.default.createElement("div",{className:"success-actions"},r.map((a,i)=>Zd.default.createElement("div",{key:i,className:"success-action"},Zd.default.createElement("span",{className:"action-icon"},a.icon),Zd.default.createElement("span",null,a.text)))),n)});var Bt,yR,ble=L(()=>{Bt=q(Y());er();Qm();$A();fR();Nr();ym();yR=({goal:e,userSegmentation:t,sampleTradeCreated:r,sampleTradeFilePath:n,isLoading:o,onCreateSampleTrade:a,className:i=""})=>{let s=()=>{let d=t.instruments[0]||"stocks",u=t.frequency,p;switch(d){case"forex":p={trade:"EURUSD Long (+70 pips)",timeframe:u==="daily"?"30min scalp":u==="weekly"?"3-day swing":"1-week position"};break;case"crypto":p={trade:"BTC/USD Long (+$1,700)",timeframe:u==="daily"?"1-hour momentum":u==="weekly"?"3-day breakout":"1-week trend"};break;case"options":p={trade:"AAPL Call (+64% profit)",timeframe:u==="daily"?"0DTE scalp":u==="weekly"?"30DTE swing":"60DTE position"};break;default:p={trade:"AAPL Long (+$625 profit)",timeframe:u==="daily"?"30min momentum":u==="weekly"?"3-day swing":"1-week position"}}return{...p,focus:{"emotional-control":"Psychology tracking","strategy-optimization":"Setup analysis","record-keeping":"Complete documentation","risk-management":"Risk metrics"}[t.challenge],tags:`demo-trade, ${d}`}},l=()=>{switch(e){case"psychology":return[{icon:Bt.default.createElement(ku,{size:16}),title:"Emotional Analysis",content:"You held this trade for the full plan despite a 15% drawdown. This discipline is what separates profitable traders from emotional ones."},{icon:Bt.default.createElement(kw,{size:16}),title:"Patience Tracking",content:"By waiting for your full profit target, you earned 40% more than if you had taken early profits at the first sign of strength."},{icon:Bt.default.createElement(xc,{size:16}),title:"Confidence Building",content:"Trades like this, where you stick to your plan, build psychological capital for bigger positions in the future."}];case"patterns":return[{icon:Bt.default.createElement($a,{size:16}),title:"Setup Performance",content:"This breakout pattern has an 82% win rate in your trading history - significantly higher than pullback entries at 67%."},{icon:Bt.default.createElement(xl,{size:16}),title:"Timing Optimization",content:"Entries between 10-11 AM ET show 3x better risk-reward ratios than afternoon trades in this setup type."},{icon:Bt.default.createElement(ov,{size:16}),title:"Pattern Recognition",content:"This setup appears 2-3 times per week in your preferred instruments. Journalit will alert you to similar patterns."}];default:return[{icon:Bt.default.createElement(Eu,{size:16}),title:"Automation Ready",content:"This trade was automatically imported from MetaTrader with complete data - no manual entry required."},{icon:Bt.default.createElement($a,{size:16}),title:"Real-time Sync",content:"Your risk metrics updated live during the trade, showing exactly when to scale out or add to positions."},{icon:Bt.default.createElement(Dw,{size:16}),title:"Effortless Tracking",content:"With full automation, you can focus on trading decisions while Journalit handles all the data collection and analysis."}]}},c=s();if(r){let d=l();return Bt.default.createElement("div",{className:`first-action-slide ${i}`},Bt.default.createElement(Ib,{title:"Great! Here's what we learned from your sample trade:",className:"first-action-success"},Bt.default.createElement("div",{className:"trade-insights"},d.map((u,p)=>Bt.default.createElement(BA,{key:p,icon:u.icon,title:u.title,content:u.content}))),n&&Bt.default.createElement("div",{className:"sample-trade-path"},Bt.default.createElement("small",null,"Trade created at: ",n))))}return Bt.default.createElement(Cs,{title:"Experience Journalit in action",subtitle:"Let's create a sample trade note so you can see how everything works.",icon:Bt.default.createElement(md,{size:20}),className:`first-action-slide ${i}`},Bt.default.createElement("div",{className:"first-action-content"},Bt.default.createElement("div",{className:"first-action-preview"},Bt.default.createElement("h3",null,"What we'll create based on your trading style:"),Bt.default.createElement("div",{className:"sample-trade-preview"},Bt.default.createElement("div",{className:"preview-row"},Bt.default.createElement("span",{className:"preview-label"},Bt.default.createElement(xc,{size:16})," Trade:"),Bt.default.createElement("span",{className:"preview-value"},c.trade)),Bt.default.createElement("div",{className:"preview-row"},Bt.default.createElement("span",{className:"preview-label"},Bt.default.createElement(xl,{size:16})," Style:"),Bt.default.createElement("span",{className:"preview-value"},c.timeframe)),Bt.default.createElement("div",{className:"preview-row"},Bt.default.createElement("span",{className:"preview-label"},Bt.default.createElement(ov,{size:16})," Focus:"),Bt.default.createElement("span",{className:"preview-value"},c.focus)),Bt.default.createElement("div",{className:"preview-row"},Bt.default.createElement("span",{className:"preview-label"},Bt.default.createElement(Pu,{size:16})," Tags:"),Bt.default.createElement("span",{className:"preview-value"},c.tags)))),Bt.default.createElement(he,{onClick:a,disabled:o,variant:"primary",size:"large",className:"create-sample-button",autoFocus:!0},Bt.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"center"}},o?Bt.default.createElement(zo,{size:"small",message:""}):Bt.default.createElement(fd,{size:18}),o?"Creating your sample trade...":"Create Sample Trade")),Bt.default.createElement("p",{className:"first-action-note"},"This creates a real trade note in your vault that you can explore and delete later.")))}});var WA,xle=L(()=>{WA=class extends Error{constructor(t,r,n){super(t),this.name="ApiError",this.statusCode=r,this.context=n}}});function xR(){var e,t,r,n;if(typeof window!="undefined")try{let o=window.journalitPlugin||((t=(e=app==null?void 0:app.plugins)==null?void 0:e.plugins)==null?void 0:t.journalit);if((n=(r=o==null?void 0:o.settings)==null?void 0:r.backendIntegration)!=null&&n.serverUrl)return o.settings.backendIntegration.serverUrl}catch(o){}return wle}var bR,wle,tt,eu=L(()=>{bR=require("obsidian");Sc();xle();wle="https://api.journalit.co";tt=class{static setAuthToken(t){this.authToken=t}static getAuthToken(){return this.authToken}static requiresAuth(t){return["/api/v1/trades","/api/v1/mt-accounts","/api/v1/obsidian/status","/api/v1/obsidian/register-vault","/api/v1/ftp-users","/api/v1/sync/ftp","/api/v1/csv"].some(n=>t.includes(n))}static getHeaders(t={}){let r={"Content-Type":"application/json","Accept-Language":"en-US",...t};return this.authToken&&this.requiresAuth(t["x-endpoint"]||"")&&(r.Authorization=`Bearer ${this.authToken}`),delete r["x-endpoint"],r}static async makeRequest(t,r={},n="API call",o=0){if(r.method==="GET"||!r.method){let l=this.getCachedResponse(t);if(l!==null)return l}let a={...r.headers,"x-endpoint":t},i=this.getHeaders(a),s={...r,headers:i};return new Promise((l,c)=>{let d={url:t,options:s,context:n,resolve:l,reject:c,retryCount:0,priority:o};this.requestQueue.push(d),this.requestQueue.sort((u,p)=>p.priority-u.priority),this.isProcessingQueue||this.processQueue()})}static async processQueue(){if(!this.isProcessingQueue){for(this.isProcessingQueue=!0;this.requestQueue.length>0&&this.activeRequests<this.MAX_CONCURRENT_REQUESTS;){let r=Date.now()-this.lastRequestTime;r<this.RATE_LIMIT_DELAY_MS&&await new Promise(o=>setTimeout(o,this.RATE_LIMIT_DELAY_MS-r));let n=this.requestQueue.shift();n&&(this.activeRequests++,this.lastRequestTime=Date.now(),this.executeRequest(n).finally(()=>{this.activeRequests--,this.requestQueue.length>0&&this.processQueue()}))}this.isProcessingQueue=!1}}static async executeRequest(t){var r,n,o;try{let a=await(0,bR.requestUrl)({url:t.url,method:t.options.method||"GET",headers:t.options.headers,body:t.options.body,throw:!1});if(a.status<200||a.status>=300){if((a.status===429||a.status>=500)&&t.retryCount<this.MAX_RETRY_ATTEMPTS){await this.retryRequest(t);return}let s={operation:t.context,endpoint:t.url,statusCode:a.status};throw new WA(`API Error: ${a.status}`,a.status,s)}let i=null;if(a.status!==204&&a.headers["content-length"]!=="0"){let s=a.headers["content-type"];if(s&&s.includes("application/json"))try{i=a.json}catch(l){console.warn("Failed to parse JSON response, treating as empty:",l),i=null}}(t.options.method==="GET"||!t.options.method)&&this.setCachedResponse(t.url,i),t.resolve(i)}catch(a){if(a instanceof Error&&((r=a.message)!=null&&r.includes("API Error: 400"))&&t.context.toLowerCase().includes("verify authentication code")||a instanceof Error&&((n=a.message)!=null&&n.includes("API Error: 429"))&&t.context.toLowerCase().includes("verification code")){console.warn(`Auth verification failed (${t.context}):`,a),t.resolve(null);return}t.retryCount<this.MAX_RETRY_ATTEMPTS&&(a.name==="TypeError"||a instanceof Error&&((o=a.message)!=null&&o.includes("fetch")))?await this.retryRequest(t):(this.handleError(a,t.context),t.resolve(null))}}static async retryRequest(t){t.retryCount++;let r=this.RETRY_DELAY_BASE_MS*Math.pow(2,t.retryCount-1);await new Promise(n=>setTimeout(n,r)),t.priority+=10,this.requestQueue.unshift(t),this.isProcessingQueue||this.processQueue()}static getCachedResponse(t){let r=this.responseCache.get(t);return r?Date.now()-r.timestamp>this.CACHE_TTL_MS?(this.responseCache.delete(t),null):r.data:null}static setCachedResponse(t,r){if(this.responseCache.set(t,{data:r,timestamp:Date.now()}),this.responseCache.size>100){let n=Array.from(this.responseCache.entries()).sort((o,a)=>o[1].timestamp-a[1].timestamp);for(let o=0;o<20;o++)this.responseCache.delete(n[o][0])}}static handleError(t,r){let n=t.context||{operation:r,endpoint:t.endpoint,statusCode:t.statusCode};return Pe.handleError(t,n),null}static async checkHealth(){try{let t=await(0,bR.requestUrl)({url:`${xR()}/api/v1/health`,method:"GET",throw:!1});return t.status>=200&&t.status<300}catch(t){return!1}}static buildUrl(t,r){let n=new URL(`${xR()}${t}`);return r&&Object.entries(r).forEach(([o,a])=>{a!=null&&n.searchParams.append(o,String(a))}),n.toString()}static clearQueue(){this.requestQueue.forEach(t=>{t.reject(new Error("Request queue cleared"))}),this.requestQueue=[],this.isProcessingQueue=!1}static getQueueStatus(){return{queueLength:this.requestQueue.length,activeRequests:this.activeRequests,cacheSize:this.responseCache.size}}static clearCache(){this.responseCache.clear()}static invalidateCache(t){let r=typeof t=="string"?new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")):t,n=0;for(let[o]of this.responseCache)r.test(o)&&(this.responseCache.delete(o),n++);n>0}};tt.requestQueue=[],tt.activeRequests=0,tt.MAX_CONCURRENT_REQUESTS=3,tt.RATE_LIMIT_DELAY_MS=200,tt.lastRequestTime=0,tt.isProcessingQueue=!1,tt.MAX_RETRY_ATTEMPTS=3,tt.RETRY_DELAY_BASE_MS=1e3,tt.responseCache=new Map,tt.CACHE_TTL_MS=300*1e3,tt.authToken=null});var dt,Ab,wR,RA,kR=L(()=>{dt=q(Y()),Ab=require("obsidian");Nr();ym();eu();mR();wR=({onSuccess:e,onCancel:t,isAuthenticated:r=!1,currentUserEmail:n})=>{let[o,a]=(0,dt.useState)("email"),[i,s]=(0,dt.useState)(""),[l,c]=(0,dt.useState)(""),[d,u]=(0,dt.useState)(!1),[p,m]=(0,dt.useState)(null),[f,g]=(0,dt.useState)(null),[v,h]=(0,dt.useState)(0);(0,dt.useEffect)(()=>{if(f&&o==="code"){let k=setInterval(()=>{let T=Math.floor((Date.now()-f)/1e3),P=Math.max(0,60-T);h(P),P===0&&clearInterval(k)},1e3);return()=>clearInterval(k)}},[f,o]);let y=async()=>{if(!i.trim()){m("Please enter a valid email address");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i.trim())){m("Please enter a valid email address");return}u(!0),m(null);try{let T=await tt.makeRequest(tt.buildUrl("/auth/beta/send-code"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:i.trim()})},"Send verification code",10);if((T==null?void 0:T.status)==="success")a("code"),g(Date.now()),h(60),new Ab.Notice("Verification code sent! Check your email.");else throw new Error((T==null?void 0:T.message)||"Failed to send verification code")}catch(T){console.error("Error sending verification code:",T);let P=T instanceof Error&&T.message.includes("Too Many Requests")?"You have requested too many codes. Please wait 30 minutes and try again.":T instanceof Error?T.message:"Failed to send verification code";m(P)}finally{u(!1)}},b=async()=>{if(!l.trim()){m("Please enter the verification code");return}if(!/^\d{6}$/.test(l.trim())){m("Verification code should be 6 digits");return}u(!0),m(null);try{let k=await tt.makeRequest(tt.buildUrl("/auth/beta/verify"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:i.trim(),code:l.trim()})},"Verify authentication code",10);if((k==null?void 0:k.status)==="success"&&k.token&&k.user)await e(k.token,k.user),new Ab.Notice("Successfully logged in!");else throw new Error((k==null?void 0:k.message)||"Invalid verification code")}catch(k){console.error("Error verifying code:",k),m(k instanceof Error?k.message:"Failed to verify code")}finally{u(!1)}},x=async()=>{u(!0),m(null);try{let k=await tt.makeRequest(tt.buildUrl("/auth/beta/send-code"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:i.trim()})},"Resend verification code",10);if((k==null?void 0:k.status)==="success")g(Date.now()),h(60),c(""),new Ab.Notice("New verification code sent! Check your email.");else throw new Error((k==null?void 0:k.message)||"Failed to resend verification code")}catch(k){console.error("Error resending verification code:",k),m(k instanceof Error?k.message:"Failed to resend verification code")}finally{u(!1)}},w=()=>{a("email"),c(""),m(null),g(null),h(0)},S=(k,T)=>{k.key==="Enter"&&!d&&T()};return dt.default.createElement("div",{className:"email-auth-modal"},r?dt.default.createElement(dt.default.Fragment,null,dt.default.createElement("h3",null,"Already Logged In"),dt.default.createElement("p",{className:"modal-description"},"You are already logged in",n?` as ${n}`:"","."),dt.default.createElement("div",{className:"modal-actions"},dt.default.createElement(he,{onClick:t,variant:"primary"},"Close"))):dt.default.createElement(dt.default.Fragment,null,dt.default.createElement("h3",null,"Sign In to Journalit"),o==="email"&&dt.default.createElement(dt.default.Fragment,null,dt.default.createElement("p",{className:"modal-description"},"Enter your email address to receive a verification code for access to the private beta."),dt.default.createElement("div",{className:"modal-field"},dt.default.createElement("label",{htmlFor:"email-input"},"Email Address"),dt.default.createElement("input",{id:"email-input",type:"email",value:i,onChange:k=>{s(k.target.value),m(null)},onKeyPress:k=>S(k,y),placeholder:"your.email@example.com",className:"modal-input",disabled:d,autoFocus:!0})),p&&dt.default.createElement("div",{className:"modal-error"},p),dt.default.createElement("div",{className:"modal-actions"},dt.default.createElement(he,{onClick:y,disabled:d||!i.trim(),variant:"primary"},dt.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"center"}},d&&dt.default.createElement(zo,{size:"small",message:""}),d?"Sending...":"Send Verification Code")))),o==="code"&&dt.default.createElement(dt.default.Fragment,null,dt.default.createElement("p",{className:"modal-description"},"We've sent a 6-digit verification code to ",dt.default.createElement("strong",null,i),". Please enter it below to complete your sign-in."),dt.default.createElement("div",{className:"modal-field"},dt.default.createElement("label",{htmlFor:"code-input"},"Verification Code"),dt.default.createElement("input",{id:"code-input",type:"text",value:l,onChange:k=>{let T=k.target.value.replace(/\D/g,"").slice(0,6);c(T),m(null)},onKeyPress:k=>S(k,b),placeholder:"123456",className:"modal-input code-input",disabled:d,autoFocus:!0,maxLength:6})),p&&dt.default.createElement("div",{className:"modal-error"},p),dt.default.createElement("div",{className:"modal-actions"},dt.default.createElement(he,{onClick:b,disabled:d||l.length!==6,variant:"primary"},dt.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"center"}},d&&dt.default.createElement(zo,{size:"small",message:""}),d?"Verifying...":"Verify & Sign In")),v===0&&dt.default.createElement(he,{onClick:x,disabled:d,variant:"secondary"},"Resend Code"),dt.default.createElement(he,{onClick:w,disabled:d,variant:"secondary"},"Back"))),dt.default.createElement("div",{className:"modal-footer"},dt.default.createElement("p",{className:"modal-footer-text"},"Having trouble? The verification code expires in 15 minutes.",o==="code"&&v>0&&dt.default.createElement(dt.default.Fragment,null," You can request a new code in ",v," seconds."),o==="code"&&v===0&&dt.default.createElement(dt.default.Fragment,null," You can now resend the code using the button above."),o==="email"&&dt.default.createElement(dt.default.Fragment,null," Enter your email to receive a verification code.")))))},RA=class extends Ab.Modal{constructor(r,n,o){super(r);this.root=null;this.onSuccess=n,this.onCancel=o}async onOpen(){let{contentEl:r}=this;r.empty(),_A();let n=r.createDiv(),{createRoot:o}=wn();this.root=o(n),this.root.render(dt.default.createElement(wR,{onSuccess:async(a,i)=>{await this.onSuccess(a,i),this.close()},onCancel:()=>{this.onCancel(),this.close()}}))}onClose(){this.root&&(this.root.unmount(),this.root=null);let{contentEl:r}=this;r.empty()}}});var Zm,SR,kle=L(()=>{Zm=q(Y());er();Qm();$A();kR();SR=({isAuthenticated:e,onAuthSuccess:t,onAuthCancel:r,className:n=""})=>e?Zm.default.createElement("div",{className:`authentication-slide ${n}`},Zm.default.createElement(Ib,{title:"Account connected successfully!",subtitle:"You now have access to all Pro features including MetaTrader sync.",className:"auth-success"})):Zm.default.createElement(Cs,{title:Zm.default.createElement("span",{style:{display:"flex",alignItems:"center",gap:"8px"}},Zm.default.createElement(bc,{size:20}),"Connect your account"),subtitle:"Sign in to unlock MetaTrader sync and advanced features.",className:`authentication-slide ${n}`},Zm.default.createElement("div",{className:"auth-component-wrapper"},Zm.default.createElement(wR,{onSuccess:t,onCancel:r})))});var Ye,TR,Sle=L(()=>{Ye=q(Y());er();Qm();$A();Nr();ym();TR=({ftpCredentialsGenerated:e,ftpCredentials:t,isLoading:r,onGenerateFtpCredentials:n,onCopyToClipboard:o,className:a=""})=>{let i=[{icon:Ye.default.createElement(bc,{size:16}),text:"Secure FTP credentials for your MetaTrader"},{icon:Ye.default.createElement(Eu,{size:16}),text:"Automatic report upload and processing"},{icon:Ye.default.createElement($a,{size:16}),text:"Real-time trade data in your journal"}];return e&&t?Ye.default.createElement("div",{className:`ftp-credentials-slide ${a}`,style:{marginTop:"-20px"}},Ye.default.createElement(Ib,{title:"Your FTP credentials are ready!",subtitle:"Configure these settings in your MetaTrader platform:",className:"ftp-credentials-display"},Ye.default.createElement("div",{className:"credentials-container"},Ye.default.createElement("div",{className:"credential-row"},Ye.default.createElement("span",{className:"credential-label"},"FTP server:"),Ye.default.createElement("div",{className:"credential-value-container"},Ye.default.createElement("code",{className:"credential-value"},t.host,":",t.port),Ye.default.createElement(he,{size:"small",variant:"secondary",onClick:()=>o(`${t.host}:${t.port}`,"FTP Server")},Ye.default.createElement(wl,{size:16})))),Ye.default.createElement("div",{className:"credential-row"},Ye.default.createElement("span",{className:"credential-label"},"Path:"),Ye.default.createElement("div",{className:"credential-value-container"},Ye.default.createElement("code",{className:"credential-value"},"(leave empty)"),Ye.default.createElement(he,{size:"small",variant:"secondary",onClick:()=>o("","Path")},Ye.default.createElement(wl,{size:16})))),Ye.default.createElement("div",{className:"credential-row"},Ye.default.createElement("span",{className:"credential-label"},"FTP login:"),Ye.default.createElement("div",{className:"credential-value-container"},Ye.default.createElement("code",{className:"credential-value"},t.username),Ye.default.createElement(he,{size:"small",variant:"secondary",onClick:()=>o(t.username,"Username")},Ye.default.createElement(wl,{size:16})))),Ye.default.createElement("div",{className:"credential-row"},Ye.default.createElement("span",{className:"credential-label"},"FTP password:"),Ye.default.createElement("div",{className:"credential-value-container"},Ye.default.createElement("code",{className:"credential-value"},"\u2022".repeat(t.password.length)),Ye.default.createElement(he,{size:"small",variant:"secondary",onClick:()=>o(t.password,"Password")},Ye.default.createElement(wl,{size:16}))))),Ye.default.createElement("div",{className:"ftp-setup-note",style:{marginTop:"20px"}},Ye.default.createElement("p",{style:{marginBottom:"8px"}},Ye.default.createElement("strong",null,"Next Steps:")),Ye.default.createElement("ol",{style:{paddingLeft:"20px",margin:"0"}},Ye.default.createElement("li",null,"Open MT5"),Ye.default.createElement("li",null,'Click on the "Tools" menu at the top'),Ye.default.createElement("li",null,'Go to "Options"'),Ye.default.createElement("li",null,'Go to the "FTP" tab & enter the credentials provided above'),Ye.default.createElement("li",null,"Enable Passive mode"),Ye.default.createElement("li",null,"Enable automatic publishing of reports via FTP (Refresh every 60 minutes)"))),Ye.default.createElement("div",{className:"ftp-test-note",style:{marginTop:"16px",color:"#8a2be2"}},Ye.default.createElement("p",{style:{margin:"0"}},Ye.default.createElement("strong",null,'Clicking "Test" will send your first sync through to our server! You will need to go into the plugin settings to "Force Sync" the trades.')),Ye.default.createElement("p",{style:{margin:"4px 0 0 0",fontSize:"0.9em"}},"(if you have any trades in your MT account)")))):Ye.default.createElement(Cs,{title:"Setup MetaTrader sync",subtitle:"Generate your FTP credentials to enable automatic trade collection from MT4/MT5.",icon:Ye.default.createElement(Ff,{size:24}),className:`ftp-credentials-slide ${a}`},Ye.default.createElement("div",{className:"ftp-security-note"},Ye.default.createElement("div",{className:"security-highlight"},Ye.default.createElement("span",{className:"security-icon"},Ye.default.createElement(Aw,{size:16})),Ye.default.createElement("span",null,Ye.default.createElement("strong",null,"100% secure:")," We never have access to your trading account - only reports are uploaded"))),Ye.default.createElement("div",{className:"ftp-generate-section"},Ye.default.createElement("div",{className:"ftp-info"},Ye.default.createElement("h3",null,"What you'll get:"),Ye.default.createElement("div",{className:"ftp-benefits"},i.map((s,l)=>Ye.default.createElement("div",{key:l,className:"ftp-benefit"},Ye.default.createElement("span",{className:"benefit-icon"},s.icon),Ye.default.createElement("span",null,s.text))))),Ye.default.createElement(he,{onClick:n,disabled:r,variant:"primary",size:"large",className:"generate-ftp-button",autoFocus:!0},Ye.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"center"}},r&&Ye.default.createElement(zo,{size:"small",message:""}),r?"Generating credentials...":Ye.default.createElement(Ye.default.Fragment,null,Ye.default.createElement(Cw,{size:18})," Generate FTP Credentials")))))}});var Bn,CR,Tle=L(()=>{Bn=q(Y());er();Qm();Nr();CR=({sampleTradeCreated:e,isAuthenticated:t,ftpCredentialsGenerated:r,onComplete:n,className:o=""})=>{let a=[{icon:Bn.default.createElement($a,{size:16}),text:"Chosen your trading goal",completed:!0},{icon:Bn.default.createElement(md,{size:16}),text:"Created your first sample trade",completed:e},{icon:Bn.default.createElement(bc,{size:16}),text:"Connected your account",completed:t},{icon:Bn.default.createElement(Ff,{size:16}),text:"Generated FTP credentials",completed:r}].filter(s=>s.completed),i=[{href:"https://github.com/Cursivez/journalit",icon:Bn.default.createElement(Ef,{size:16}),text:"View Documentation"},{href:"https://discord.gg/AkSw3D9h8b",icon:Bn.default.createElement(Pw,{size:16}),text:"Join Community"},{href:"mailto:contact@journalit.co",icon:Bn.default.createElement(yc,{size:16}),text:"Get Support"}];return Bn.default.createElement(Cs,{title:"Welcome to Journalit!",subtitle:"You're all set up and ready to transform your trading journey.",className:`completion-slide ${o}`},Bn.default.createElement("div",{className:"completion-celebration"},Bn.default.createElement(fd,{size:32})),Bn.default.createElement("div",{className:"completion-summary"},Bn.default.createElement("h3",null,"What you've accomplished:"),Bn.default.createElement("div",{className:"accomplishments"},a.map((s,l)=>Bn.default.createElement("div",{key:l,className:"accomplishment"},Bn.default.createElement("span",{className:"accomplishment-icon"},s.icon),Bn.default.createElement("span",null,s.text),Bn.default.createElement("span",{className:"accomplishment-status"},Bn.default.createElement(Qo,{size:16})))))),Bn.default.createElement("div",{className:"completion-actions"},Bn.default.createElement(he,{onClick:n,variant:"primary",size:"large",className:"start-journaling-button",autoFocus:!0},Bn.default.createElement(Ew,{size:18})," Start Your Trading Journal"),Bn.default.createElement("div",{className:"completion-links"},i.map((s,l)=>Bn.default.createElement("a",{key:l,href:s.href,className:"completion-link"},s.icon," ",s.text)))))}});var Cle=L(()=>{fle();gle();yle();ble();kle();Sle();Tle()});var ot,gh,Ple,Dle=L(()=>{ot=q(Y()),gh=require("obsidian");Nr();ym();mle();zA();di();mR();Cle();Ple=({onComplete:e,onSkip:t,initialStep:r="welcome",selectedGoal:n,plugin:o,onboardingService:a})=>{let[i,s]=(0,ot.useState)(r),[l,c]=(0,ot.useState)(n),[d,u]=(0,ot.useState)({instruments:[],frequency:"weekly",challenge:"emotional-control"}),[p,m]=(0,ot.useState)(!1),[f,g]=(0,ot.useState)(null),[v,h]=(0,ot.useState)(""),[y,b]=(0,ot.useState)(!1),[x,w]=(0,ot.useState)(null),[S,k]=(0,ot.useState)(!1),[T,P]=(0,ot.useState)(null),[D,O]=(0,ot.useState)(!1),[z,I]=(0,ot.useState)(""),A=_r.findIndex(Q=>Q.id===i),j=_r[A];(0,ot.useEffect)(()=>{_A()},[]),(0,ot.useEffect)(()=>()=>{let Q=document.getElementById("email-auth-modal-styles");Q&&Q.remove()},[]),(0,ot.useEffect)(()=>{let Q=o.authManager;Q&&Q.isAuthenticated()&&k(!0)},[o]),(0,ot.useEffect)(()=>{(async()=>{var J,ee,te,ue;try{let be=await((J=o.serviceManager)==null?void 0:J.getBackendIntegrationService());if(!be)return;let Le=(ee=o.settings.backendIntegration)==null?void 0:ee.ftpUsername;if(Le){let $e=await be.getFTPCredentials(Le);$e&&((te=o.settings.backendIntegration)!=null&&te.ftpPassword&&!$e.password&&(I(""),$e.password="*".repeat(12)),P({username:$e.username,password:$e.password||"",host:$e.server,port:$e.port}),O(!0))}}catch(be){be instanceof Error&&((ue=be.message)!=null&&ue.includes("404"))||console.error("Failed to check existing FTP credentials:",be)}})()},[o]),(0,ot.useEffect)(()=>{},[i,A,l,o,a]);let E=_r.filter(Q=>!Q.shouldShow||Q.shouldShow(l)).length,N=A>0,B=A<_r.length-1,C=(j==null?void 0:j.isOptional)===!0,F=(0,ot.useCallback)(()=>{C&&(h('Onboarding cancelled. You can replay onboarding later from the Command Palette by searching for "Journalit: Replay Onboarding".'),setTimeout(()=>{h("")},100),t())},[C,t]);(0,ot.useEffect)(()=>{let Q=J=>{J.key==="Escape"&&C&&F()};return document.addEventListener("keydown",Q),()=>document.removeEventListener("keydown",Q)},[C,F]),(0,ot.useEffect)(()=>{let Q=setTimeout(()=>{let J=document.querySelector(".onboarding-wizard-modal");if(J){let ee=J.querySelector('button:not([disabled]), [href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"])');ee&&ee.focus()}},100);return()=>clearTimeout(Q)},[i]);let M=(0,ot.useCallback)(async()=>{if(!(!B||p)){m(!0),g(null);try{let Q=A+1;for(;Q<_r.length;){let J=_r[Q];if(!J.shouldShow||J.shouldShow(l))break;Q++}Q<_r.length&&s(_r[Q].id)}catch(Q){g(Q instanceof Error?Q.message:"Failed to go to next step")}finally{m(!1)}}},[A,B,l,p]),_=(0,ot.useCallback)(async()=>{if(!(!N||p)){m(!0),g(null);try{let Q=A-1;for(;Q>=0;){let J=_r[Q];if(!J.shouldShow||J.shouldShow(l))break;Q--}Q>=0&&s(_r[Q].id)}catch(Q){g(Q instanceof Error?Q.message:"Failed to go to previous step")}finally{m(!1)}}},[A,N,l,p]),W=(0,ot.useCallback)(async()=>{let Q={version:1,completed:!0,completedAt:Date.now(),selectedGoal:l,userSegmentation:d,currentStep:"completion",checklist:{},sampleTradeCreated:y,isAuthenticated:S,ftpCredentialsGenerated:D};if(a)try{await a.completeOnboarding()}catch(J){console.error("Failed to complete onboarding in service:",J)}e(Q)},[l,y,S,D,e,o,a]),$=(0,ot.useCallback)(async()=>{if(!C||p)return;if(i==="welcome"){s("completion");return}let Q=A+1;for(;Q<_r.length;){let J=_r[Q];if(!J.shouldShow||J.shouldShow(l))break;Q++}Q<_r.length?s(_r[Q].id):W()},[i,C,p,A,l,W]),H=(0,ot.useCallback)(async Q=>{if(c(Q),a)try{await a.setGoal(Q)}catch(J){console.error("Failed to update OnboardingService goal:",J)}},[o,i,a]),R=(0,ot.useCallback)(async()=>{var Q,J;if(!y){m(!0),g(null);try{let ee=(Q=o.serviceManager)==null?void 0:Q.getTradeService();if(!ee)throw new Error("TradeService not available");let te=await((J=o.serviceManager)==null?void 0:J.getAccountPageService());if(!te)throw new Error("AccountPageService not available");(await te.getAllEnhancedAccounts()).find(Ee=>Ee.name==="Demo Account")||await te.updateAccountMetadata("Demo Account",{name:"Demo Account",accountType:"demo",initialBalance:1e4,createdDate:new Date});let Le=new Date,$e,oe,ge;switch(d.frequency==="daily"?($e=new Date(Le.getTime()-10800*1e3),oe=new Date(Le.getTime()-2.5*60*60*1e3)):d.frequency==="weekly"?($e=new Date(Le.getTime()-4320*60*1e3),oe=new Date(Le.getTime()-1440*60*1e3)):($e=new Date(Le.getTime()-10080*60*1e3),oe=new Date(Le.getTime()-2880*60*1e3)),d.instruments[0]||"stocks"){case"forex":ge={entryTime:$e,exitTime:oe,entryPrice:1.085,exitPrice:1.092,positionSize:1e4,direction:"long",setupIds:[],mistakeIds:[],accountIds:[],account:["Demo Account"],instrument:"EURUSD",assetType:"forex",tags:["journalit-demo","sample-trade","forex"],thesis:`Sample EURUSD trade demonstrating ${d.frequency} trading. Entry based on support level bounce with 70-pip profit target. This exemplifies the systematic approach Journalit helps you track.`};break;case"crypto":ge={entryTime:$e,exitTime:oe,entryPrice:42500,exitPrice:44200,positionSize:.1,direction:"long",setupIds:[],mistakeIds:[],accountIds:[],account:["Demo Account"],instrument:"BTC/USD",assetType:"crypto",tags:["journalit-demo","sample-trade","crypto"],thesis:`Sample Bitcoin trade showing ${d.frequency} strategy. Breakout above resistance with $1,700 profit. Track crypto volatility patterns with Journalit's analysis tools.`};break;case"options":ge={entryTime:$e,exitTime:oe,entryPrice:2.5,exitPrice:4.1,positionSize:5,direction:"long",setupIds:[],mistakeIds:[],accountIds:[],account:["Demo Account"],instrument:"AAPL Call 150 30DTE",assetType:"options",tags:["journalit-demo","sample-trade","options"],thesis:`Sample options trade for ${d.frequency} traders. 64% profit on AAPL calls before earnings. Journalit tracks Greeks, IV, and time decay for complete options analysis.`};break;default:ge={entryTime:$e,exitTime:oe,entryPrice:150.5,exitPrice:156.75,positionSize:100,direction:"long",setupIds:[],mistakeIds:[],accountIds:[],account:["Demo Account"],instrument:"AAPL",assetType:"stock",tags:["journalit-demo","sample-trade","stocks"],thesis:`Sample stock trade tailored for ${d.frequency} trading. Strong earnings beat with institutional buying. Demonstrates how Journalit captures both technical and fundamental analysis.`}}let De=await ee.createTrade(ge);w(De),b(!0);let Fe=new gh.Notice("",5e3).noticeEl.createDiv();Fe.style.display="flex",Fe.style.alignItems="center",Fe.style.gap="8px";let re=Fe.createSpan();re.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z"/></svg>',re.style.display="inline-flex",re.style.color="var(--text-accent)",Fe.createSpan({text:"Sample trade created successfully! You can find it in your vault."})}catch(ee){console.error("Error creating sample trade:",ee),g(ee instanceof Error?ee.message:"Failed to create sample trade")}finally{m(!1)}}},[o,y,d,l,i]),V=(0,ot.useCallback)(async(Q,J)=>{try{k(!0);let ee=o.authManager;ee&&await ee.handleBetaAuth(Q,J),new gh.Notice("Successfully authenticated! You can now access Pro features.")}catch(ee){console.error("Error handling auth success:",ee),g(ee instanceof Error?ee.message:"Failed to complete authentication")}},[o]),Z=(0,ot.useCallback)(()=>{g(null)},[]),K=(0,ot.useCallback)(async()=>{var Q,J,ee,te,ue,be,Le,$e,oe;if(!D){m(!0),g(null);try{let ge=await((Q=o.serviceManager)==null?void 0:Q.getBackendIntegrationService());if(!ge)throw new Error("Backend integration service not available");if(!o.authManager||!o.authManager.isAuthenticated())throw new Error("Please sign in to generate FTP credentials");let Se=await ge.createOrGetFTPUser();if(!Se)throw new Error("Failed to generate FTP credentials");let De=`anon_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;o.settings.backendIntegration={...o.settings.backendIntegration,syncEnabled:(ee=(J=o.settings.backendIntegration)==null?void 0:J.syncEnabled)!=null?ee:!1,userId:(ue=(te=o.settings.backendIntegration)==null?void 0:te.userId)!=null?ue:De,showSyncNotifications:(Le=(be=o.settings.backendIntegration)==null?void 0:be.showSyncNotifications)!=null?Le:!0,showNewTradeNotifications:(oe=($e=o.settings.backendIntegration)==null?void 0:$e.showNewTradeNotifications)!=null?oe:!0,ftpUsername:Se.username,ftpPassword:Se.password||""},await o.saveSettings(),await ge.updateSettings({ftpUsername:Se.username}),I(Se.password||""),P({username:Se.username,password:Se.password||"",host:Se.server,port:Se.port}),O(!0);let Fe=new gh.Notice("",5e3).noticeEl.createDiv();Fe.style.display="flex",Fe.style.alignItems="center",Fe.style.gap="8px";let re=Fe.createSpan();re.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><path d="m9 11 3 3L22 4"/></svg>',re.style.display="inline-flex",re.style.color="var(--text-success)",Fe.createSpan({text:"FTP credentials generated successfully!"})}catch(ge){console.error("Error generating FTP credentials:",ge),g(ge instanceof Error?ge.message:"Failed to generate FTP credentials")}finally{m(!1)}}},[D,l,i,o]),X=(0,ot.useCallback)(async(Q,J)=>{try{let ee=J==="Password"&&Q==="*".repeat(12)&&z?z:Q;if(J==="Password"&&ee==="*".repeat(12)){new gh.Notice("Password is masked and cannot be copied. Please regenerate FTP credentials.");return}await navigator.clipboard.writeText(ee),new gh.Notice(`${J} copied to clipboard!`)}catch(ee){console.error("Failed to copy to clipboard:",ee),new gh.Notice(`Failed to copy ${J.toLowerCase()}`)}},[z]),G=()=>{switch(i){case"welcome":return ot.default.createElement(gR,null);case"goal":return ot.default.createElement(hR,{selectedGoal:l,onGoalSelect:H});case"segmentation":return ot.default.createElement(vR,{userSegmentation:d,onSegmentationChange:u});case"first-action":return ot.default.createElement(yR,{goal:l,userSegmentation:d,sampleTradeCreated:y,sampleTradeFilePath:x,isLoading:p,onCreateSampleTrade:R});case"authentication":return ot.default.createElement(SR,{isAuthenticated:S,onAuthSuccess:V,onAuthCancel:Z});case"ftp-credentials":return ot.default.createElement(TR,{ftpCredentialsGenerated:D,ftpCredentials:T,isLoading:p,onGenerateFtpCredentials:K,onCopyToClipboard:X});case"completion":return ot.default.createElement(CR,{sampleTradeCreated:y,isAuthenticated:S,ftpCredentialsGenerated:D,onComplete:W});default:return ot.default.createElement("div",{className:"onboarding-slide error-slide"},ot.default.createElement("h2",null,"Unknown step"),ot.default.createElement("p",null,"We encountered an unexpected step in the onboarding process."))}},U=_r.filter(Q=>!Q.shouldShow||Q.shouldShow(l)).map(Q=>Q.title);return ot.default.createElement("div",{className:"onboarding-wizard-modal"},ot.default.createElement("div",{"aria-live":"assertive","aria-atomic":"true",className:"sr-only"},v),ot.default.createElement("div",{className:"modal-header"},ot.default.createElement(ple,{currentStep:A+1,totalSteps:E,stepLabels:U})),ot.default.createElement("div",{className:"modal-content"},G()),f&&ot.default.createElement("div",{className:"modal-error"},f),i!=="completion"&&ot.default.createElement("div",{className:"modal-actions"},N&&ot.default.createElement(he,{onClick:_,disabled:p,variant:"secondary"},"Back"),B&&ot.default.createElement(he,{onClick:M,disabled:p||i==="goal"&&!l||i==="segmentation"&&d.instruments.length===0,variant:"primary"},ot.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"center"}},p&&ot.default.createElement(zo,{size:"small",message:""}),"Next"))),ot.default.createElement("div",{className:"modal-footer"},ot.default.createElement("p",{className:"modal-footer-text"},(j==null?void 0:j.description)||"Complete the setup to get started with Journalit")),C&&ot.default.createElement("button",{className:"skip-link",onClick:$,disabled:p,"aria-label":"Skip this step",type:"button"},i==="welcome"?"Skip Onboarding":"Skip Step"))}});var DR={};Ko(DR,{OnboardingWizardModalWrapper:()=>PR});var Ele,Ile,PR,ER=L(()=>{Ele=q(Y()),Ile=require("obsidian");Dle();$O();PR=class extends Ile.Modal{constructor(r,n,o,a,i,s,l){super(r);this.reactRoot=null;this.plugin=n,this.onComplete=o,this.onSkip=a,this.initialStep=i,this.selectedGoal=s,this.onboardingService=l}async onOpen(){let{contentEl:r}=this;r.empty(),l1();let n=r.createDiv(),{createRoot:o}=wn();this.reactRoot=o(n),this.reactRoot.render(Ele.default.createElement(Ple,{plugin:this.plugin,onboardingService:this.onboardingService,onComplete:a=>{this.onComplete(a),super.close()},onSkip:()=>{this.onSkip(),super.close()},initialStep:this.initialStep,selectedGoal:this.selectedGoal})),setTimeout(()=>{let a=r.querySelector(".onboarding-wizard-modal");a&&(a.setAttribute("tabindex","-1"),a.focus())},100)}async onClose(){this.reactRoot&&(this.reactRoot.unmount(),this.reactRoot=null);let{contentEl:r}=this;r.empty(),BO()}}});var Ps,Lle,Nle,Mle=L(()=>{Ps=q(Y()),Lle=require("obsidian");ci();ga();Nle=({trades:e,currentTradePath:t,onTradeClick:r})=>{var d,u,p;let n=(p=(u=(d=window.app)==null?void 0:d.plugins)==null?void 0:u.plugins)==null?void 0:p.journalit,o=Ps.default.useMemo(()=>{var m,f;try{let g=window.app;if(!(g!=null&&g.metadataCache))return null;let v=e.find(b=>b.path===t);if(!v){let b=g.vault.getAbstractFileByPath(t);b instanceof Lle.TFile&&(v=b)}if(!v)return null;let h=g.metadataCache.getFileCache(v),y=(m=h==null?void 0:h.frontmatter)==null?void 0:m.entryTime;if(y)return new Date(y);if((f=h==null?void 0:h.frontmatter)!=null&&f.useDirectPnLInput){let b=t.match(/(\d{2})(\d{2})(\d{2})-[TM]\d+\.md$/);if(b){let[,x,w,S]=b,k=2e3+parseInt(S,10);return new Date(k,parseInt(w,10)-1,parseInt(x,10))}}return null}catch(g){return console.warn("Error getting current trade date:",g),null}},[e,t]),a=Ps.default.useMemo(()=>{if(!o||!n)return e;try{let m=window.app;return m!=null&&m.metadataCache?e.filter(f=>{var g,v;try{let h=m.metadataCache.getFileCache(f),y=(g=h==null?void 0:h.frontmatter)==null?void 0:g.entryTime,b=(v=h==null?void 0:h.frontmatter)==null?void 0:v.useDirectPnLInput,x=null;if(y)x=new Date(y);else if(b){let w=f.path.match(/(\d{2})(\d{2})(\d{2})-[TM]\d+\.md$/);if(w){let[,S,k,T]=w,P=2e3+parseInt(T,10);x=new Date(P,parseInt(k,10)-1,parseInt(S,10))}}return x?Gq(o,x,n):!1}catch(h){return console.warn(`Error checking trade date for ${f.path}:`,h),!1}}):e}catch(m){return console.warn("Error filtering trades by trading day:",m),e}},[e,o,n]),i=Ps.default.useMemo(()=>{let m=a.map(g=>{let v=g.path.match(/([A-Z0-9-]+)-[0-9]{6}-[TMB]\d+\.md$/),h=g.path.match(/[TMB](\d+)\.md$/),y=g.path.match(/-([TMB])\d+\.md$/),b=v?v[1]:"Unknown",x=h?parseInt(h[1],10):0,w=y?y[1]==="M":!1,S=y?y[1]==="B":!1,k=0,T=!1;try{let P=window.app;if(P!=null&&P.metadataCache){let D=P.metadataCache.getFileCache(g),O=D==null?void 0:D.frontmatter;O&&(O.pnl!==void 0?k=Number(O.pnl):O.directPnL!==void 0&&O.useDirectPnLInput&&(k=Number(O.directPnL)),T=Pt({tradeStatus:O.tradeStatus,exitTime:O.exitTime,pnl:O.pnl,useDirectPnLInput:O.useDirectPnLInput,exits:O.exits,entries:O.entries}))}}catch(P){k=0,T=!1}return{file:g,ticker:b,tradeNumber:x,isActive:g.path===t,pnl:k,isMissedTrade:w,isBacktestTrade:S,isOpen:T}}),f={};return m.forEach(g=>{f[g.ticker]||(f[g.ticker]=[]),f[g.ticker].push(g)}),Object.keys(f).forEach(g=>{f[g].sort((v,h)=>v.tradeNumber-h.tradeNumber)}),f},[a,t]),s=Object.keys(i);if(s.length===0)return null;if(a.length<=1){let m=s[0],f=i[m][0],g=f.isMissedTrade?"M":f.isBacktestTrade?"B":"T",v=f.isMissedTrade?"Missed Trade":f.isBacktestTrade?"Backtest Trade":"Trade";return Ps.default.createElement("div",{className:"trade-timeline-container single-trade"},Ps.default.createElement("div",{className:"trade-timeline"},Ps.default.createElement("div",{className:"timeline-label active-ticker"},m,":"),Ps.default.createElement("div",{className:"timeline-items"},Ps.default.createElement("button",{className:`timeline-item ${f.isMissedTrade?"missed-trade":""} ${f.isBacktestTrade?"backtest-trade":""} ${f.isOpen?"open":f.pnl>0?"profit":f.pnl<0?"loss":""} active`,disabled:!0,"aria-label":`${m} ${v} ${f.tradeNumber} (${f.isOpen?"Open":f.pnl>0?"Profit":f.pnl<0?"Loss":"Breakeven"})`,title:`Current ${v.toLowerCase()}: ${m} ${v} ${f.tradeNumber}${f.isOpen?" (Open)":""}`},g,f.tradeNumber))))}let l=s.find(m=>i[m].some(f=>f.isActive)),c=[...s].sort((m,f)=>m===l?-1:f===l?1:m.localeCompare(f));return Ps.default.createElement("div",{className:"trade-timeline-container"},c.map(m=>Ps.default.createElement("div",{key:m,className:"trade-timeline"},Ps.default.createElement("div",{className:`timeline-label ${m===l?"active-ticker":""}`},m,":"),Ps.default.createElement("div",{className:"timeline-items"},i[m].map(f=>{let g=f.isMissedTrade?"M":f.isBacktestTrade?"B":"T",v=f.isMissedTrade?"Missed Trade":f.isBacktestTrade?"Backtest Trade":"Trade";return Ps.default.createElement("button",{key:f.file.path,className:`timeline-item 
                    ${f.isMissedTrade?"missed-trade":""} 
                    ${f.isBacktestTrade?"backtest-trade":""}
                    ${f.isOpen?"open":f.pnl>0?"profit":f.pnl<0?"loss":""} 
                    ${f.isActive?"active":""}`,onClick:()=>r(f.file.path),"aria-label":`${m} ${v} ${f.tradeNumber} (${f.isOpen?"Open":f.pnl>0?"Profit":f.pnl<0?"Loss":"Breakeven"})`,title:`View ${m} ${v} ${f.tradeNumber} (${f.isOpen?"Open":f.pnl>0?"Profit":f.pnl<0?"Loss":"Breakeven"})${f.isOpen?" - Trade is still open":""}`},g,f.tradeNumber)})))))}});var Xi,VA,IR=L(()=>{Xi=q(Y());er();Mle();H1();ci();pt();VA=({currentDate:e,trades:t,missedTrades:r=[],currentTradePath:n,navigateTo:o,getDRCPath:a,getWeeklyReviewPath:i,getMonthlyReviewPath:s,getYearlyReviewPath:l,onEditClick:c,handleEditClick:d})=>{let u=xe(),p=(0,Xi.useCallback)(x=>{x!==n&&o(x,!1)},[o,n]),m=(0,Xi.useCallback)(()=>{let x=lr(e,u),w=a(x);w&&o(w,!1)},[a,e,o,u]),f=(0,Xi.useCallback)(()=>{let x=lr(e,u),w=i(x);w&&o(w,!1)},[i,e,o,u]),g=(0,Xi.useCallback)(()=>{let x=lr(e,u),w=s(x);w&&o(w,!1)},[s,e,o,u]),v=(0,Xi.useCallback)(()=>{let x=lr(e,u),w=l(x);w&&o(w,!1)},[l,e,o,u]),h=[{text:"Daily Report Card",action:m},{text:"Weekly Review",action:f},{text:"Monthly Review",action:g},{text:"Yearly Review",action:v}],y=()=>Xi.default.createElement("div",{className:"trade-navigation-with-edit"},Xi.default.createElement(V1,{buttons:h,className:"trade-review-navigation",style:{borderTop:"none",flex:"1"}}),d&&c&&Xi.default.createElement("div",{className:"edit-button-container"},Xi.default.createElement("button",{className:"trade-nav-edit-button",onClick:d,"aria-label":"Edit trade",title:"Edit trade"},Xi.default.createElement(Fo,{size:14})))),b=Xi.default.useMemo(()=>{let x=new Set,w=[];for(let S of[...t,...r])x.has(S.path)||(x.add(S.path),w.push(S));return w},[t,r]);return Xi.default.createElement("div",{className:"trade-navigation-container"},y(),Xi.default.createElement(Nle,{trades:b,currentTradePath:n,onTradeClick:p}))}});var Lb,hS,Fle=L(()=>{Lb=q(Y());RC();eo();hS=Lb.default.memo(({images:e,onEditClick:t})=>!e||e.length===0?Lb.default.createElement("div",{className:"trade-empty-images"},Lb.default.createElement(et,{message:"No images for this trade",subMessage:t?"Click 'Edit' to add images":void 0,iconSize:40})):Lb.default.createElement("div",{className:"trade-images-section","data-image-count":e.length},Lb.default.createElement(Mu,{images:e,altPrefix:"Trade image",showThumbnails:e.length>1,showCounter:e.length>1,enableDelete:!1,enableFullscreen:!0,useResolveMediaPath:!0,className:e.length===1?"single-image-carousel":"","data-single-image":e.length===1?"true":"false"})),(e,t)=>JSON.stringify(e.images)===JSON.stringify(t.images)&&e.onEditClick===t.onEditClick)});var ho,vS,Ole=L(()=>{ho=q(Y()),vS=({data:e,onAccountClick:t})=>{let r=e.account&&e.account.length>0||e.accountIds&&e.accountIds.length>0,n=e.customTags&&e.customTags.length>0,o=e.setup&&e.setup.length>0||e.setupIds&&e.setupIds.length>0,a=e.mistake&&e.mistake.length>0||e.mistakeIds&&e.mistakeIds.length>0;return!r&&!n&&!o&&!a?null:ho.default.createElement(ho.default.Fragment,null,ho.default.createElement("div",{className:"trade-metadata-container"},r&&ho.default.createElement("div",{className:"metadata-section"},ho.default.createElement("div",{className:"metadata-label"},"Account:"),ho.default.createElement("div",{className:"metadata-tags"},(e.account||e.accountIds||[]).map((i,s)=>ho.default.createElement("span",{key:`account-${s}`,className:"account-tag",onClick:()=>t(i)},i)))),n&&ho.default.createElement("div",{className:"metadata-section"},ho.default.createElement("div",{className:"metadata-label"},"Custom Tags:"),ho.default.createElement("div",{className:"metadata-tags"},e.customTags.map((i,s)=>ho.default.createElement("span",{key:`tag-${s}`,className:"tag"},i))))),ho.default.createElement("div",{className:"trade-tags-container"},ho.default.createElement("div",{className:"tags-row"},o&&ho.default.createElement("div",{className:"tags-section setup-section"},ho.default.createElement("h4",null,"Setups"),ho.default.createElement("div",{className:"tags-list"},(e.setup||e.setupIds||[]).map((i,s)=>ho.default.createElement("span",{key:`setup-${s}`,className:"tag setup-tag"},i)))),a&&ho.default.createElement("div",{className:"tags-section mistake-section"},ho.default.createElement("h4",null,"Mistakes"),ho.default.createElement("div",{className:"tags-list"},(e.mistake||e.mistakeIds||[]).map((i,s)=>ho.default.createElement("span",{key:`mistake-${s}`,className:"tag mistake-tag"},i)))))))}});var Ze,yS,jle=L(()=>{Ze=q(Y());am();Rf();eo();rr();Ut();yS=({data:e,metrics:t,formatDate:r,formatTime:n,onEditClick:o,displayRMultiples:a,defaultRiskAmount:i})=>{let{currency:s}=Ke();return Ze.default.createElement(Ze.default.Fragment,null,Ze.default.createElement("div",{className:"trade-overview-section"},Ze.default.createElement("div",{className:"trade-metrics-grid"},Ze.default.createElement("div",{className:"metric-card"},Ze.default.createElement("div",{className:"metric-label"},"Entry"),Ze.default.createElement("div",{className:"metric-value"},ha(e.entryPrice,!1,s)),Ze.default.createElement("div",{className:"metric-subtitle"},n(e.entryTime))),Ze.default.createElement("div",{className:"metric-card"},Ze.default.createElement("div",{className:"metric-label"},"Exit"),Ze.default.createElement("div",{className:"metric-value"},ha(e.exitPrice,!1,s)),Ze.default.createElement("div",{className:"metric-subtitle"},n(e.exitTime))),Ze.default.createElement("div",{className:"metric-card"},Ze.default.createElement("div",{className:"metric-label"},"Size"),Ze.default.createElement("div",{className:"metric-value"},e.positionSize),Ze.default.createElement("div",{className:"metric-subtitle"},e.assetType==="options"&&e.optionType?e.optionType.charAt(0).toUpperCase()+e.optionType.slice(1):e.direction||"N/A")),Ze.default.createElement("div",{className:"metric-card"},Ze.default.createElement("div",{className:"metric-label"},"Duration"),Ze.default.createElement("div",{className:"metric-value"},t.duration),Ze.default.createElement("div",{className:"metric-subtitle"},"\xA0")))),Ze.default.createElement("div",{className:"trade-main-content"},Ze.default.createElement("div",{className:"thesis-section"},Ze.default.createElement("h4",null,"Thesis"),e.thesis?Ze.default.createElement("div",{className:"thesis-content"},e.thesis.split(`
`).map((l,c)=>Ze.default.createElement(Ze.default.Fragment,{key:c},l,c<e.thesis.split(`
`).length-1&&Ze.default.createElement("br",null)))):Ze.default.createElement(et,{message:"No thesis provided for this trade",subMessage:o?"Click 'Edit' to add a thesis":void 0,iconSize:32}))),Ze.default.createElement("div",{className:"trade-details-footer"},Ze.default.createElement("div",{className:"details-card expanded-details"},Ze.default.createElement("div",{className:"details-header"},Ze.default.createElement("h4",null,"Trade Details")),Ze.default.createElement("table",{className:"details-table"},Ze.default.createElement("tbody",null,Ze.default.createElement("tr",null,Ze.default.createElement("td",null,"Instrument"),Ze.default.createElement("td",null,e.instrument||"N/A"),Ze.default.createElement("td",null,"Direction"),Ze.default.createElement("td",null,e.assetType==="options"&&e.optionType?e.optionType.charAt(0).toUpperCase()+e.optionType.slice(1):e.direction||"N/A")),Ze.default.createElement("tr",null,Ze.default.createElement("td",null,"Position Size"),Ze.default.createElement("td",null,e.positionSize||"N/A"),Ze.default.createElement("td",null,"P&L"),Ze.default.createElement("td",{className:t.isProfit?"profit-text":"loss-text"},ve(t.pnl,!0,s,a,st(t.pnl,e.rMultiple,e.riskAmount,i)),!e.useDirectPnLInput&&` (${t.percentChange.toFixed(2)}%)`)),Ww(e)!==0&&(()=>{let l=Ww(e),c=e.riskAmount||i||0,d=st(l,void 0,e.riskAmount,i);return Ze.default.createElement("tr",null,Ze.default.createElement("td",null,"Trading Costs"),Ze.default.createElement("td",{colSpan:3,className:"cost-breakdown"},RH(e,a,c),Ze.default.createElement("span",{className:"total-cost"}," | Total: ",ve(l,!0,s,a,d))))})(),Ze.default.createElement("tr",null,Ze.default.createElement("td",null,"Entry Price"),Ze.default.createElement("td",null,ha(e.entryPrice,!1,s)),Ze.default.createElement("td",null,"Exit Price"),Ze.default.createElement("td",null,ha(e.exitPrice,!1,s))),Ze.default.createElement("tr",null,Ze.default.createElement("td",null,"Entry Time"),Ze.default.createElement("td",null,r(e.entryTime)),Ze.default.createElement("td",null,"Exit Time"),Ze.default.createElement("td",null,r(e.exitTime))),Ze.default.createElement("tr",null,Ze.default.createElement("td",null,"Duration"),Ze.default.createElement("td",{colSpan:3},t.duration)))))))}});var Gc,bS,zle=L(()=>{Gc=q(Y());am();ga();rr();pt();bS=({instrument:e,direction:t,isProfit:r,pnl:n,percentChange:o,useDirectPnLInput:a,isMissedTrade:i,isBacktestTrade:s,exitTime:l,tradeStatus:c,exits:d,entries:u,assetType:p,optionType:m,rMultiple:f,displayRMultiples:g,riskAmount:v})=>{var P,D;let{currency:h}=Ke(),y=xe(),b=c==="OPEN"||Pt({useDirectPnLInput:a,exitTime:l,tradeStatus:c,exits:d,entries:u,pnl:void 0}),x=()=>{if(p==="options"&&m)return{icon:m==="call"?"\u25B2":"\u25BC",text:m==="call"?"Call":"Put"};let z=(t||"").toLowerCase();return{icon:z==="long"||z==="buy"?"\u25B2":"\u25BC",text:z==="long"||z==="buy"?"Long":"Short"}},{icon:w,text:S}=x(),k=(D=(P=y==null?void 0:y.settings)==null?void 0:P.trade)==null?void 0:D.defaultRiskAmount,T=st(n,f,v,k);return Gc.default.createElement("div",{className:`trade-note-header ${b?"open":r?"profit":"loss"}`},Gc.default.createElement("div",{className:"trade-instrument"},Gc.default.createElement("span",{className:"trade-direction-icon"},w),e||"Unknown Instrument",s&&Gc.default.createElement("span",{className:"backtest-trade-badge"},"BACKTEST"),!s&&i&&Gc.default.createElement("span",{className:"missed-trade-badge"},"MISSED"),!s&&!i&&b&&Gc.default.createElement("span",{className:"open-trade-badge"},"OPEN")),Gc.default.createElement("div",{className:"trade-header-actions"},Gc.default.createElement("div",{className:"trade-pnl"},b&&!i&&!s?Gc.default.createElement("span",{className:"open-text"},"OPEN"):Gc.default.createElement("span",{className:r?"profit-text":"loss-text"},!g&&n>0?"+":"",ve(n,!0,h,g,T),!a&&` (${o.toFixed(2)}%)`))))}});var AR=L(()=>{Fle();Ole();jle();zle()});var _le,xS,Ble=L(()=>{_le=q(Y());wt();ga();xS=({data:e})=>({metrics:(0,_le.useMemo)(()=>{let o=Pt({tradeStatus:e.tradeStatus,exitTime:e.exitTime,pnl:e._originalPnlWasNull?null:e.pnl,useDirectPnLInput:e.useDirectPnLInput,exits:e.exits,entries:e.entries}),a=e.entryPrice||0,i=e.exitPrice||0,s=e.positionSize||0,l=(e.direction||"").toLowerCase()==="long";if(o)return{pnl:0,percentChange:0,duration:"",isProfit:!1};let c=e.pnl!==void 0?e.pnl:l?(i-a)*s:(a-i)*s,d=a===0?0:e.assetType==="options"||l?(i-a)/a*100:(a-i)/a*100,u="";if(e.entryTime&&e.exitTime){let p=sv(e.entryTime,e.exitTime);if(p!==null){let m=Math.floor(p/36e5),f=Math.floor(p%(1e3*60*60)/(1e3*60)),g=Math.floor(p%(1e3*60)/1e3);m>0?u=`${m}h ${f}m`:f>0?u=`${f}m ${g}s`:u=`${g}s`}}return{pnl:c,percentChange:d,duration:u,isProfit:c>0}},[e.entryPrice,e.exitPrice,e.positionSize,e.direction,e.pnl,e.entryTime,e.exitTime,e.tradeStatus,e.useDirectPnLInput,e.exits,e._originalPnlWasNull,e.assetType]),formatDate:o=>{if(!o)return"N/A";let a=new Date(o);if(isNaN(a.getTime()))return"N/A";let i=tr(),s=rt(a,i),l=a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return`${s} ${l}`},formatTime:o=>{if(!o)return"N/A";let a=new Date(o);return isNaN(a.getTime())?"N/A":a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}})});var LR=L(()=>{Ble()});var ft,$le,Cze,Wle=L(()=>{ft=q(Y());ba();pt();IR();AR();LR();ci();Kv();$le=ft.default.memo(({data:e,onEditClick:t})=>{var g,v,h,y,b,x,w,S,k,T;let[r,n]=(0,ft.useState)(e.filePath||"unknown"),[o,a]=(0,ft.useState)({reviewed:e.reviewed,reviewedAt:e.reviewedAt});(0,ft.useEffect)(()=>{a({reviewed:e.reviewed,reviewedAt:e.reviewedAt})},[e.reviewed,e.reviewedAt]);let i=(0,ft.useRef)(null),{metrics:s,formatDate:l,formatTime:c}=xS({data:e}),d=xe();(0,ft.useEffect)(()=>{um(),Ev();let P=e.images||[];if(i.current){i.current.classList.add("missed-trade-note-mounted"),i.current.setAttribute("data-mounted-at",Date.now().toString());let D=i.current.closest(".journalit-missed-trade-view");D&&D.classList.add("missed-trade-note-mounted")}},[]);let u=(0,ft.useCallback)(P=>{if(i.current=P,P&&(!r||r==="unknown")){let D=P.getAttribute("data-displaying-file");if(D){n(D);return}let O=P.parentElement;for(;O;){let z=O.getAttribute("data-displaying-file")||O.getAttribute("data-file-path");if(z){n(z);break}O=O.parentElement}}},[r]),p=async P=>{if(!d||!d.accountPageService){console.error("Cannot navigate to account: AccountPageService not available");return}try{let O=(await d.accountPageService.getAllEnhancedAccounts()).find(z=>z.id===P||z.name===P);O?d.openFile?d.openFile(O.notePath,!1):d.app&&d.app.workspace.openLinkText(O.notePath,"",!1):console.error(`Could not find account: ${P}`)}catch(D){console.error("Error navigating to account:",D)}},m=(0,ft.useCallback)(()=>{t&&t(e)},[e,t]),f=(0,ft.useCallback)(async()=>{if(d!=null&&d.missedTradeService&&r&&r!=="unknown"){let P=new Date().toISOString();a({reviewed:!0,reviewedAt:P});try{await d.missedTradeService.updateMissedTradeReviewStatus(r,!0,P),console.log("Missed trade marked as reviewed")}catch(D){console.error("[MissedTradeNote] Error updating review status:",D),a({reviewed:e.reviewed,reviewedAt:e.reviewedAt})}}},[d,r,e.reviewed,e.reviewedAt]);return ft.default.createElement("div",{className:"missed-trade-note-container",ref:u,"data-file-path":r,style:{margin:0}},ft.default.createElement(bS,{instrument:e.instrument,direction:e.direction,isProfit:s.isProfit,pnl:s.pnl,percentChange:s.percentChange,useDirectPnLInput:e.useDirectPnLInput,isMissedTrade:!0,isBacktestTrade:!1,assetType:e.assetType,optionType:e.optionType,exitTime:e.exitTime,tradeStatus:e.tradeStatus,exits:e.exits,rMultiple:e.rMultiple,displayRMultiples:(h=(v=(g=d==null?void 0:d.settings)==null?void 0:g.trade)==null?void 0:v.displayRMultiples)!=null?h:!1,riskAmount:e.riskAmount}),(e.entryTime||e.useDirectPnLInput)&&ft.default.createElement(Cze,{data:e,filePath:r,onEditClick:t,handleEditClick:m}),ft.default.createElement("div",{className:"missed-trade-note-content"},ft.default.createElement(hS,{images:e.images,onEditClick:m}),ft.default.createElement(vS,{data:e,onAccountClick:p}),ft.default.createElement(yS,{data:e,metrics:s,formatDate:l,formatTime:c,onEditClick:m,displayRMultiples:(x=(b=(y=d==null?void 0:d.settings)==null?void 0:y.trade)==null?void 0:b.displayRMultiples)!=null?x:!1,defaultRiskAmount:(k=(S=(w=d==null?void 0:d.settings)==null?void 0:w.trade)==null?void 0:S.defaultRiskAmount)!=null?k:0}),e.missedReason&&ft.default.createElement("div",{className:"missed-trade-reason-section"},ft.default.createElement("div",{className:"details-card"},ft.default.createElement("h4",null,"Why I missed this trade"),ft.default.createElement("div",{className:"missed-trade-reason-content"},(T=e.missedReason)==null?void 0:T.split(`
`).map((P,D)=>ft.default.createElement(ft.default.Fragment,{key:D},P,D<e.missedReason.split(`
`).length-1&&ft.default.createElement("br",null)))))),ft.default.createElement("div",{className:"missed-trade-note-review-section"},ft.default.createElement(Dd,{reviewed:o.reviewed,reviewedAt:o.reviewedAt,onMarkReviewed:f}))))},(e,t)=>e.data.pnl===t.data.pnl&&e.data.entryTime===t.data.entryTime&&e.data.exitTime===t.data.exitTime&&e.data.instrument===t.data.instrument&&e.data.direction===t.data.direction&&e.data.missedReason===t.data.missedReason&&JSON.stringify(e.data.images)===JSON.stringify(t.data.images)&&e.onEditClick===t.onEditClick),Cze=ft.default.memo(({data:e,filePath:t,onEditClick:r,handleEditClick:n})=>{let o=xe(),[a,i]=(0,ft.useState)([]),[s,l]=(0,ft.useState)([]),[c,d]=(0,ft.useState)(!1),[u,p]=(0,ft.useState)(!1),[m,f]=(0,ft.useState)(0),g=ft.default.useMemo(()=>{if(e.entryTime)return new Date(e.entryTime);if(t&&t!=="unknown"){let T=t.match(/(\d{2})(\d{2})(\d{2})-M\d+\.md$/);if(T){let[,P,D,O]=T,z=2e3+parseInt(O,10);return new Date(z,parseInt(D,10)-1,parseInt(P,10))}}return new Date},[e.entryTime,t]),v=ft.default.useMemo(()=>{if(!g||!o)return null;let{start:T,end:P}=VC(g,o);return{startDate:T,endDate:P}},[g,o]),h=ft.default.useMemo(()=>!g||!o?"":Cc(g,o),[g,o]),y=ft.default.useRef(null);(0,ft.useEffect)(()=>{let T=y.current;if(!T)return;let P=new IntersectionObserver(D=>{let[O]=D;O.isIntersecting&&(p(!0),P.disconnect())},{rootMargin:"50px",threshold:.1});return P.observe(T),()=>P.disconnect()},[]),(0,ft.useEffect)(()=>{let T=P=>{let{action:D}=P.detail;(D==="created"||D==="updated")&&h&&setTimeout(()=>{Object.keys(sessionStorage).forEach(O=>{(O.startsWith("trade-nav-")||O.startsWith("missed-trade-nav-"))&&sessionStorage.removeItem(O)}),i([]),l([]),d(!1),f(O=>O+1)},200)};return document.addEventListener("journalit:trade-data-changed",T),document.addEventListener("journalit:missed-trade-data-changed",T),()=>{document.removeEventListener("journalit:trade-data-changed",T),document.removeEventListener("journalit:missed-trade-data-changed",T)}},[h]),(0,ft.useEffect)(()=>{if(!u||!v||!(o!=null&&o.tradeService)||!(o!=null&&o.missedTradeService)||!h)return;let T=!0;return(async()=>{try{if(c)return;d(!0),setTimeout(async()=>{try{let[D,O]=await Promise.all([o.tradeService.getTrades(v.startDate,v.endDate),o.missedTradeService.getMissedTrades(v.startDate,v.endDate)]);T&&(i(D),l(O))}catch(D){console.error("Error fetching trades for day:",D)}finally{T&&d(!1)}},100)}catch(D){console.error("Error in trade fetch setup:",D),T&&d(!1)}})(),()=>{T=!1}},[u,v,o==null?void 0:o.tradeService,o==null?void 0:o.missedTradeService,h,m]);let b=(0,ft.useCallback)((T,P=!1)=>{try{o&&o.openFile?o.openFile(T,P):o!=null&&o.app?o.app.workspace.openLinkText(T,"",P):console.error("Cannot navigate: Plugin and App context not available.")}catch(D){console.error("Navigation error:",D)}},[o]),x=(0,ft.useCallback)(T=>o!=null&&o.drcService?o.drcService.getDRCNotePath(T):"",[o==null?void 0:o.drcService]),w=(0,ft.useCallback)(T=>o!=null&&o.weeklyReviewService?o.weeklyReviewService.getWeeklyReviewPath(T):"",[o==null?void 0:o.weeklyReviewService]),S=(0,ft.useCallback)(T=>o!=null&&o.drcService?o.drcService.getMonthlyReviewPath(T):null,[o==null?void 0:o.drcService]),k=(0,ft.useCallback)(()=>null,[]);return!g||!(o!=null&&o.drcService)||!(o!=null&&o.weeklyReviewService)?null:ft.default.createElement("div",{ref:y},u?ft.default.createElement(ft.default.Fragment,null,ft.default.createElement(VA,{currentDate:g,trades:a,missedTrades:s,currentTradePath:t,navigateTo:b,getDRCPath:x,getWeeklyReviewPath:w,getMonthlyReviewPath:S,getYearlyReviewPath:k,onEditClick:r,handleEditClick:n})):ft.default.createElement("div",{style:{height:"60px",display:"flex",alignItems:"center",justifyContent:"center"}},ft.default.createElement("div",{style:{color:"var(--text-muted)",fontSize:"12px"}},"Loading navigation...")))})});var Rle,Ule,rc,Nb=L(()=>{Rle=q(Y()),Ule=q(wn());rr();rc=class{constructor(t){this.reactRoots=new Map;this.rootCreationTimes=new Map;this.app=t,this._currencyChangeHandler=()=>this.reRenderAllComponents(),window.addEventListener("journalit-currency-changed",this._currencyChangeHandler)}reRenderAllComponents(){}cleanup(){window.removeEventListener("journalit-currency-changed",this._currencyChangeHandler)}getOpenNoteFunction(){var t,r;try{let n=(r=(t=window.app)==null?void 0:t.plugins)==null?void 0:r.plugins.journalit;return n?(o,a=!1)=>{n.openFile(o,a)}:void 0}catch(n){console.error(`[${this.constructor.name}] Error getting openNote function:`,n);return}}unmountComponent(t,r,n,o){let a=[`${t}-${r}`,n?`${t}-leaf-${n}`:null,r.startsWith("leaf-")?`${t}-${r}`:`${t}-leaf-${r}`,`${t}-view-${r}`,`${t}-context-${r}`,o?`${t}-context-${o}`:null].filter(Boolean),i=!1;for(let s of a){let l=this.reactRoots.get(s);if(l)try{l.root.unmount(),this.reactRoots.delete(s),this.rootCreationTimes.delete(s),i=!0,l.domContainer&&l.domContainer.isConnected&&l.domContainer.remove()}catch(c){console.error(`[${this.constructor.name}] Error unmounting component:`,c,{rootId:s})}}if(!i&&n){for(let[s,l]of this.reactRoots.entries())if(l.leafId===n&&s.startsWith(t))try{l.root.unmount(),this.reactRoots.delete(s),this.rootCreationTimes.delete(s),i=!0,l.domContainer&&l.domContainer.isConnected&&l.domContainer.remove()}catch(c){console.error(`[${this.constructor.name}] Error unmounting by leafId:`,c,{id:s})}}if(!i){for(let[s,l]of this.reactRoots.entries())if(s.startsWith(t))try{l.root.unmount(),this.reactRoots.delete(s),this.rootCreationTimes.delete(s),i=!0,l.domContainer&&l.domContainer.isConnected&&l.domContainer.remove()}catch(c){console.error(`[${this.constructor.name}] Error unmounting fallback component:`,c,{id:s})}}return i}unmountAllComponents(){var a,i;let t={},r=Date.now(),n=this.app.workspace.getActiveFile(),o=n==null?void 0:n.path;for(let[s,l]of this.reactRoots.entries())try{if(o&&s.startsWith(o))continue;let c=this.rootCreationTimes.get(s)||r,d=((r-c)/1e3).toFixed(1);t[s]={domContainer:((a=l.domContainer)==null?void 0:a.tagName)||"unknown",isConnected:((i=l.domContainer)==null?void 0:i.isConnected)||!1,ageSeconds:d};try{l.root.unmount()}catch(u){}if(l.domContainer&&l.domContainer.isConnected)try{l.domContainer.remove()}catch(u){}}catch(c){console.error(`[${this.constructor.name}] Error unmounting root:`,{rootId:s,error:c})}for(let s of Object.keys(t))this.reactRoots.delete(s),this.rootCreationTimes.delete(s);this.cleanupOrphanedDomElements()}unmountLeafComponents(t){let r=[];for(let[n,o]of this.reactRoots.entries())if(o.leafId===t)try{o.root.unmount(),r.push(n),o.domContainer&&o.domContainer.isConnected&&o.domContainer.remove()}catch(a){console.error(`[${this.constructor.name}] Error unmounting leaf component:`,{rootId:n,leafId:t,error:a})}r.length>0&&(r.forEach(n=>this.reactRoots.delete(n)),this.cleanupLeafDomElements(t))}cleanupLeafDomElements(t){let r=this.getComponentClassName(),n=this.getWrapperClassName(),o=document.querySelectorAll(`.${r}[data-leaf-id="${t}"]`),a=document.querySelectorAll(`.${n}[data-leaf-id="${t}"]`);o.forEach(i=>{try{i.remove()}catch(s){console.error(`[${this.constructor.name}] Error removing leaf view element:`,s)}}),a.forEach(i=>{try{i.remove()}catch(s){console.error(`[${this.constructor.name}] Error removing leaf wrapper element:`,s)}})}cleanupOrphanedDomElements(){let t=this.getComponentClassName(),r=this.getWrapperClassName(),n=document.querySelectorAll(`.${t}`),o=document.querySelectorAll(`.${r}`);n.forEach(a=>{try{a.remove()}catch(i){console.error(`[${this.constructor.name}] Error removing orphaned view element:`,i)}}),o.forEach(a=>{try{a.remove()}catch(i){console.error(`[${this.constructor.name}] Error removing orphaned wrapper element:`,i)}})}findContainingLeaf(t){var a,i;let r=t.closest(".workspace-leaf");if(!r)return;let n=r.id;if(!n){let s=r.querySelector(".workspace-tab-header");if(s){let c=(a=s.textContent)==null?void 0:a.trim();if(c){let d;if(this.app.workspace.iterateAllLeaves(u=>{u.getDisplayText()===c&&(d=u)}),d)return d}}let l=r.querySelector(".view-header-title-container");if(l){let c=(i=l.textContent)==null?void 0:i.trim();if(c){let d;if(this.app.workspace.iterateAllLeaves(u=>{let p=u.view;p&&"file"in p&&p.file&&p.file.basename===c&&(d=u)}),d)return d}}return}let o;return this.app.workspace.iterateAllLeaves(s=>{var c;let l=(c=s.view)==null?void 0:c.containerEl;l&&l.id===n&&(o=s)}),o||this.app.workspace.iterateAllLeaves(s=>{var c;let l=(c=s.view)==null?void 0:c.containerEl;l&&l.contains(t)&&(o=s)}),o}createReactRoot(t,r,n,o,a,i){let s=document.createElement("div");s.className=this.getWrapperClassName(),s.setAttribute(`data-${this.getComponentClassName()}-root-id`,r),n&&s.setAttribute("data-leaf-id",n),o&&s.setAttribute("data-context-id",o),s.setAttribute("data-protected","true"),t.appendChild(s);let l=(0,Ule.createRoot)(s),c={root:l,domContainer:s,leafId:n};this.reactRoots.set(r,c),this.rootCreationTimes.set(r,Date.now());let d=this.getOpenNoteFunction();return l.render(Rle.default.createElement(cs,{children:null},this.createReactElement(a,i,d))),c}getDomPath(t){let r=[],n=t;for(;n&&n!==document.body;){let o=n.nodeName.toLowerCase();if(n.id)o+=`#${n.id}`;else{n.className&&(o+=`.${Array.from(n.classList).join(".")}`);let a=n.parentElement?Array.from(n.parentElement.children):[];if(a.length>1){let i=a.indexOf(n);o+=`:nth-child(${i+1})`}}r.unshift(o),n=n.parentElement}return r.join(" > ")}}});function Fb(e){return`${Pze.PERIODIC}/${e}`}function Ob(e){return[]}function Dze(e){return Array.from(new Set(e.filter(Boolean)))}function jb(...e){let t=e.flat();return Dze(t)}function wS(e){if(!e)return"";if(typeof e=="string"&&e.startsWith('"')&&e.endsWith('"'))try{let t=JSON.parse(e);if(typeof t=="string")return t}catch(t){return e.slice(1,-1)}return e}var Pze,Mb,zb=L(()=>{Pze={TRADE:"trade",PERIODIC:"periodic",ACCOUNT:"account",SETUP:"setup",MISTAKE:"mistake",DIRECTION:"direction",ASSET:"asset",STATUS:"status"},Mb={DAILY:"daily",WEEKLY:"weekly",MONTHLY:"monthly"}});var Vle,_b,NR=L(()=>{Vle=q(Y());Wle();Nb();ba();zb();_b=class extends rc{constructor(t){super(t)}renderComponent(t,r,n,o,a){t.querySelector(".missed-trade-note-container.missed-trade-note-mounted")||this.renderMissedTradeNote(t,r,n,o,a)}renderMissedTradeNote(t,r,n,o,a){try{if(Ev(),!t||!t.isConnected){console.error(`[MissedTradeNote] Cannot render into disconnected container for ${n}`);return}let i=a?`${n}-${o}-${a}`:`${n}-${o}`,s=o.startsWith("leaf-")?o.substring(5):o,l=this.processMissedTradeData(r);t.setAttribute("data-displaying-file",n);let c=this.findContainingLeaf(t),d=t.querySelector(".journalit-missed-trade-note-wrapper");if(d){if(d.querySelector(".missed-trade-note-mounted"))return;d.remove()}let u=null;if(c&&c.view){let g=c.view.containerEl;g&&g.id&&(u=g.id)}let p=this.reactRoots.get(i);if(p&&p.domContainer&&p.domContainer.isConnected&&p.domContainer.querySelector(".missed-trade-note-mounted"))return;t.empty();let m=this.reactRoots.get(i);if(m&&(c&&u&&m.leafId!==u||a&&m.domContainer&&m.domContainer.getAttribute("data-context-id")!==a)){let g=a?`${n}-context-${a}`:`${n}-${o}-${u}`;if(m=this.reactRoots.get(g),!m){this.createReactRoot(t,g,u||void 0,a,l,n);return}}if(!m)this.createReactRoot(t,i,u||void 0,a,l,n);else{let g=m.domContainer;t.contains(g)?m.root.render(this.createReactElement(l,n)):this.createReactRoot(t,i,u||void 0,a,l,n)}}catch(i){console.error("[MissedTradeNote] Error rendering missed trade note:",i),t.setText("Error rendering missed trade note: "+(i instanceof Error?i.message:String(i)))}}getComponentClassName(){return"journalit-missed-trade-view"}getWrapperClassName(){return"journalit-missed-trade-note-wrapper"}createReactElement(t,r,n){let o=i=>{var l,c;let s=(c=(l=window.app)==null?void 0:l.plugins)==null?void 0:c.plugins.journalit;if(!s){console.error("Cannot access plugin instance for edit action");return}s.openTradeFormInEditMode?s.openTradeFormInEditMode(i,r):console.warn("Edit mode not available - plugin method missing")},a=async i=>{var l,c;let s=(c=(l=window.app)==null?void 0:l.plugins)==null?void 0:c.plugins.journalit;if(!s||!s.missedTradeService){console.error("Cannot access plugin instance for data update");return}try{await s.missedTradeService.updateMissedTrade(i,r,"user-input")}catch(d){console.error("[MissedTradeNote] Error updating missed trade data:",d)}};return Vle.default.createElement($le,{data:{...t,filePath:r},onEditClick:o,onDataUpdate:a})}unmountMissedTradeNote(t,r,n,o){return this.unmountComponent(t,r,n)}unmountAllMissedTradeNotes(){this.unmountAllComponents()}unmountLeafMissedTradeNotes(t){this.unmountLeafComponents(t)}processMissedTradeData(t){var n,o;let r={...t};r.isMissedTrade=!0,t.images&&(r.images=this.normalizeImagePaths(t.images)),["setupIds","mistakeIds","accountIds","setup","mistake","account","tags","customTags"].forEach(a=>{if(r[a]&&!Array.isArray(r[a]))if(typeof r[a]=="string"&&r[a].startsWith("[")&&r[a].endsWith("]"))try{let i=r[a].slice(1,-1).trim();i?r[a]=i.split(",").map(s=>s.trim()):r[a]=[]}catch(i){console.error(`[MissedTradeNote] Failed to parse array string: ${a}`,i),r[a]=[r[a]]}else r[a]=[r[a]]}),r.tags&&Array.isArray(r.tags)&&(r.customTags=r.tags),["entryTime","exitTime"].forEach(a=>{if(r[a]&&typeof r[a]=="string")try{r[a]=new Date(r[a])}catch(i){console.error(`[MissedTradeNote] Failed to parse date: ${a}`,i)}}),["entryPrice","exitPrice","positionSize","pnl","directPnL"].forEach(a=>{if(r[a]!==void 0&&typeof r[a]!="number")try{r[a]=parseFloat(r[a])}catch(i){console.error(`[MissedTradeNote] Failed to parse number: ${a}`,i)}}),["useDirectPnLInput","isMissedTrade"].forEach(a=>{if(r[a]!==void 0&&typeof r[a]!="boolean")try{r[a]=!!r[a]}catch(i){console.error(`[MissedTradeNote] Failed to parse boolean: ${a}`,i)}}),r.thesis=wS(t.thesis)||"",r.missedReason=wS(t.missedReason)||"";try{let a=(o=(n=window.app)==null?void 0:n.plugins)==null?void 0:o.plugins.journalit;if(a&&a.customFieldsService){let i=a.customFieldsService.getFields(),s={};i.forEach(l=>{let c=l.fieldKey;c&&t[c]!==void 0&&(s[l.id]=t[c])}),Object.keys(s).length>0&&(r.customFields=s)}}catch(a){console.error("[MissedTradeNote] Error reconstructing custom fields:",a)}return r}normalizeImagePaths(t){if(!t)return[];if(Array.isArray(t))return t.map((n,o)=>typeof n!="string"?String(n):n.replace(/['"`]/g,"").trim()).filter(n=>!!n&&n.length>0&&!n.match(/^[\s]*$/));if(typeof t=="string"&&t.startsWith("[")&&t.endsWith("]"))try{let r=t.slice(1,-1).trim();return r?r.split(",").map(n=>n.trim().replace(/['"`]/g,"")).filter(Boolean):[]}catch(r){return console.error("[MissedTradeNote] Failed to parse images string:",r),[t.replace(/['"`]/g,"").trim()]}if(typeof t=="string"){let r=t.replace(/['"`]/g,"").trim();return r?[r]:[]}return[]}}});function MR(e){return"file"in e&&e.file!==void 0}function kS(e){return e.getViewType()==="markdown"}var HA=L(()=>{});var qA,nc,Bb=L(()=>{qA=require("obsidian");HA();nc=class{constructor(t,r,n){this.activeObservers=[];this.registeredLeaves=new Set;this.renderedFilePaths=new Map;this.app=t,this.plugin=r,this.renderer=n}initialize(){this.app.workspace.onLayoutReady(()=>{this.cleanupOrphanedComponents(),this.handleInitialFileOpen()}),this.registerMarkdownPostProcessor(),this.setupFileOpenHandler(),this.setupLayoutChangeHandler()}cleanup(){this.activeObservers.forEach(t=>{t.disconnect()}),this.renderer.unmountAllComponents(),this.renderer.cleanup(),this.activeObservers=[],this.registeredLeaves.clear(),this.renderedFilePaths.clear()}registerMarkdownPostProcessor(){this.plugin.registerMarkdownPostProcessor(this.handleMarkdownPostProcessor.bind(this))}setupLayoutChangeHandler(){this.plugin.registerEvent(this.app.workspace.on("layout-change",this.handleLayoutChange.bind(this))),this.plugin.registerEvent(this.app.workspace.on("editor-change",(t,r)=>{if(r&&"file"in r&&r.file){let n=r.file;if(n){let o=this.app.metadataCache.getFileCache(n),a=o==null?void 0:o.frontmatter;if(a&&this.isValidComponentType(a)){let s=(r instanceof qA.MarkdownView?r.getMode()==="source":!1)?"source":"preview";this.clearFileRenderedStatus(n.path,s),setTimeout(()=>{this.handleFileOpen(n,!0)},50)}}}})),this.app.workspace.onLayoutReady(()=>{this.app.workspace.iterateAllLeaves(t=>{var n;let r=(n=t.view)==null?void 0:n.containerEl;r&&r.id&&this.registeredLeaves.add(r.id)})})}handleLayoutChange(){let t=new Set;this.app.workspace.iterateAllLeaves(n=>{var a;let o=(a=n.view)==null?void 0:a.containerEl;o&&o.id&&(t.add(o.id),this.registeredLeaves.has(o.id)||this.registeredLeaves.add(o.id))});let r=[];this.registeredLeaves.forEach(n=>{t.has(n)||r.push(n)}),r.forEach(n=>{this.registeredLeaves.delete(n),this.renderer.unmountLeafComponents(n)})}async handleMarkdownPostProcessor(t,r){var s,l,c;if(!r.sourcePath)return;let n=this.app.vault.getAbstractFileByPath(r.sourcePath);if(!(n instanceof qA.TFile))return;let o=this.app.metadataCache.getFileCache(n),a=o==null?void 0:o.frontmatter;if(!a||!this.isValidComponentType(a))return;if(((s=t.parentElement)==null?void 0:s.classList.contains("markdown-preview-view"))&&!r.sourcePath.endsWith("#")&&!t.previousElementSibling){if(this.isFileRenderedInMode(n.path,"preview"))return;let d=t.parentElement;if(!d){console.warn(`[${this.constructor.name}] Cannot find parent markdown view for:`,r.sourcePath);return}let u=d.closest(".workspace-leaf-content");if(!u){console.warn(`[${this.constructor.name}] Cannot find containing leaf for:`,r.sourcePath);return}let p=d.closest(".workspace-leaf"),m=p==null?void 0:p.id,f=this.findContainingLeaf(u),g=(l=f==null?void 0:f.view)==null?void 0:l.containerEl,v=m||(g==null?void 0:g.id)||null,h=this.getUniqueElementId(d),y=v?`leaf-${v}`:h,b=!0;if(f){let P=f.view,D=null;MR(P)?D=(c=P.file)!=null?c:null:P&&"getViewType"in P&&P.getViewType()==="markdown"&&(D=P.file),D&&(b=D.path===n.path)}if(!b)return;let x=this.getComponentClassName();d.querySelectorAll(`.${x}`).forEach(P=>{let D=P.getAttribute("data-file-path");if(D&&D!==n.path){let O=P.getAttribute("data-view-id"),z=P.getAttribute("data-leaf-id");O&&this.renderer.unmountComponent(D,O,z||void 0),P.remove()}});let w=this.getWrapperClassName();if(Array.from(d.querySelectorAll(`.${w}`)).filter(P=>{var D;return((D=P.closest(`.${x}`))==null?void 0:D.getAttribute("data-file-path"))===n.path}).length>0||Array.from(d.querySelectorAll(`.${x}`)).find(P=>P.getAttribute("data-file-path")===n.path))return;d.querySelectorAll(`.${x}`).forEach(P=>{P.getAttribute("data-file-path")===n.path&&P.remove()});let T=document.createElement("div");T.className=this.getComponentClassName(),T.setAttribute("data-file-path",n.path),T.setAttribute("data-view-id",y),T.setAttribute("data-markdown-view-id",h),v&&T.setAttribute("data-leaf-id",v),T.setAttribute("data-inserted-at",Date.now().toString()),d.insertBefore(T,d.firstChild);try{let P=await this.getAdditionalDataForComponent(n,a);await this.renderer.renderComponent(T,{...a,...P},n.path,y,h),this.markFileRenderedInMode(n.path,"preview")}catch(P){console.error(`[${this.constructor.name}] Error rendering component:`,P),T.textContent=`Error rendering ${this.getComponentTypeIdentifier()}: ${P instanceof Error?P.message:String(P)}`}}}generateViewId(t){let r=t.closest(".workspace-leaf");if(r&&r.id)return`leaf-${r.id}`;let n=t.closest(".workspace-leaf-content");if(n&&n.id)return`content-${n.id}`;let o=t.closest(".view-content");if(o){let l=Array.from(document.querySelectorAll(".view-content")).indexOf(o);if(l>=0)return`view-content-${l}`}let a=t.closest(".markdown-preview-view");if(a){let l=Array.from(document.querySelectorAll(".markdown-preview-view")).indexOf(a);if(l>=0)return`markdown-view-${l}`}let i=t.closest(".cm-editor");if(i){let l=Array.from(document.querySelectorAll(".cm-editor")).indexOf(i);if(l>=0)return`editor-${l}`}if(t.parentElement){let l=Array.from(t.parentElement.children).indexOf(t);return`view-${Date.now()}-${l}`}return`view-${Date.now()}-${Math.random().toString(36).substring(2,9)}`}setupFileOpenHandler(){this.plugin.registerEvent(this.app.workspace.on("file-open",t=>this.handleFileOpen(t,!1))),this.app.workspace.onLayoutReady(()=>{let t=this.app.workspace.getActiveFile();t&&setTimeout(()=>{this.handleFileOpen(t,!0)},100)})}renderWithDeduplication(t){let{file:r,container:n,data:o,viewId:a,contextId:i}=t,s=t.componentClassName||this.getComponentClassName(),l=t.mountedClassName||"component-mounted",c=t.contentSelector||".component-container",d=`${r.path}-${a}-${Date.now()}`;if(n.setAttribute("data-render-request",d),n.setAttribute("data-debug-version","1.0.0"),n.getAttribute("data-mounted-at"))return!1;let p=n.querySelector(c);if(p&&p.classList.contains(l))return!1;let m=document.querySelectorAll(`.${s}[data-file-path="${r.path}"]`);if(Array.from(document.querySelectorAll(`.${s}`)).some(v=>{if(v.getAttribute("data-file-path")!==r.path)return!1;let y=v.querySelector(c),b=y&&(y.classList.contains(l)||y.querySelector("*")),x=parseInt(v.getAttribute("data-inserted-at")||"0"),w=Date.now()-x<5e3;return b&&w}))return this.markFileRenderedInMode(r.path,a),!1;let g=!!n.closest(".cm-editor");return n.setAttribute("data-view-mode",g?"source":"preview"),this.renderer.renderComponent(n,o,r.path,a,i),this.markFileRenderedInMode(r.path,a),!0}hasProperlyRenderedComponents(t,r,n,o){let a=r||this.getComponentClassName(),i=n||".component-container",s=o||"component-mounted",l=document.querySelectorAll(`.${a}[data-file-path="${t}"]`);return l.length===0?!1:Array.from(l).some(c=>{let d=c.querySelector(i);return d&&(d.classList.contains(s)||d.children&&d.children.length>0)})}cleanupDuplicateComponents(t,r){let n=r||this.getComponentClassName(),o=Array.from(document.querySelectorAll(`.${n}[data-file-path="${t}"]`)),a=0;if(o.length>1)for(let i=1;i<o.length;i++){let s=o[i],l=s.getAttribute("data-view-id"),c=s.getAttribute("data-leaf-id");l&&this.renderer.unmountComponent(t,l,c||void 0),s.remove(),a++}return a}getUniqueElementId(t){if(t.id)return`dom-${t.id}`;let r=t.tagName.toLowerCase(),o=Array.from(document.querySelectorAll(r)).indexOf(t),a=r;if(t.className){let l=t.className.split(" ")[0];l&&(a+=`.${l}`)}let s=Array.from(document.querySelectorAll(a)).indexOf(t);return`dom-${a.replace(/\./g,"-")}-${s}-${o}-${Date.now()}`}isFileRenderedInMode(t,r){let n=this.renderedFilePaths.get(t);return n?n.has(r):!1}markFileRenderedInMode(t,r){let n=this.renderedFilePaths.get(t);n||(n=new Set,this.renderedFilePaths.set(t,n)),n.add(r)}clearFileRenderedStatus(t,r){if(!r){this.renderedFilePaths.delete(t);return}let n=this.renderedFilePaths.get(t);n&&(n.delete(r),n.size===0&&this.renderedFilePaths.delete(t))}findContainingLeaf(t){let r=t.closest(".workspace-leaf");if(!r)return;let n=r.id;if(n){let i;if(this.app.workspace.iterateAllLeaves(s=>{var c;let l=(c=s.view)==null?void 0:c.containerEl;l&&l.id===n&&(i=s)}),i)return i}let o=r.querySelector(".view-header-title");if(o&&o.textContent){let i=o.textContent.trim(),s;if(this.app.workspace.iterateAllLeaves(l=>{let c=l.view;c&&"file"in c&&c.file&&c.file.basename===i&&(s=l)}),s)return s}let a;if(this.app.workspace.iterateAllLeaves(i=>{var l;let s=(l=i.view)==null?void 0:l.containerEl;s&&s.contains(t)&&(a=i)}),a)return a}cleanupUnrelatedComponents(t){var c;let r=this.app.workspace.activeLeaf;if(!r)return;let n=null;try{n=((c=r.view)==null?void 0:c.containerEl)||r.containerEl}catch(d){console.error(`[${this.constructor.name}] Could not get active leaf container:`,d);return}if(!n)return;let o=this.getComponentClassName(),a=n.querySelectorAll(`.${o}`);if(a.length===0)return;let i=this.getWrapperClassName(),s=n.querySelectorAll(`.${i}`),l=0;a.forEach(d=>{let u=d.getAttribute("data-file-path");if(!u||u===t)return;let p=d.getAttribute("data-view-id"),m=d.getAttribute("data-leaf-id");p&&this.renderer.unmountComponent(u,p,m||void 0),d.remove(),l++,this.clearFileRenderedStatus(u)}),s.forEach(d=>{let u=d.closest(`.${o}`);(!u||!u.isConnected)&&(d.remove(),l++)})}cleanupOrphanedComponents(){let t=this.app.workspace.activeLeaf;if(!t||!t.view)return;let r=null;try{r=t.view.containerEl||t.containerEl}catch(s){console.error(`[${this.constructor.name}] Could not get active leaf container:`,s);return}if(!r)return;let n=this.getComponentClassName(),o=r.querySelectorAll(`.${n}`);if(o.length===0)return;let a=t.view,i=null;(a&&"file"in a&&a.file||a&&"getViewType"in a&&a.getViewType()==="markdown")&&(i=a.file),o.forEach(s=>{let l=s.getAttribute("data-file-path");if(!l)return;let c=s.getAttribute("data-leaf-id");if(i&&i.path!==l){let d=s.getAttribute("data-view-id");d&&this.renderer.unmountComponent(l,d,c||void 0),s.remove(),this.clearFileRenderedStatus(l)}})}handleInitialFileOpen(){let t=this.app.workspace.getActiveFile();t&&this.handleFileOpen(t,!0),this.app.workspace.iterateAllLeaves(r=>{var a;let n=r.view,o=null;n&&MR(n)?o=(a=n.file)!=null?a:null:n&&"getViewType"in n&&n.getViewType()==="markdown"&&(o=n.file),o&&(!t||o.path!==t.path)&&this.handleFileOpen(o,!0)})}}});var GA,$b,FR=L(()=>{GA=require("obsidian");NR();Bb();$b=class extends nc{constructor(r,n){super(r,n,new _b(r));this._missedTradeUpdateListener=null;this.observerTimeouts=new Map;this.setupMissedTradeUpdateListener()}async getManualFrontmatter(r){try{let n=await this.app.vault.read(r),o={},a=n.match(/^---\n([\s\S]*?)\n---/m);if(a&&a[1]){let i=a[1].split(`
`),s=null,l=0,c=!1,d=!1,u={};for(let p=0;p<i.length;p++){let m=i[p],f=m.trim();if(!f)continue;let g=m.search(/\S/);if(f.startsWith("- ")){if(s&&d){let y=f.substring(2).trim().match(/^([^:]+):\s*(.*)$/);if(y){let w=y[1].trim(),S=y[2].trim();S==="true"?S=!0:S==="false"?S=!1:/^-?\d+(\.\d+)?$/.test(S)&&(S=parseFloat(S)),u[w]=S}let b=p+1<i.length?i[p+1]:"",x=b.search(/\S/);if(b.trim()&&!b.trim().startsWith("- ")&&x>l)continue;o[s]||(o[s]=[]),o[s].push({...u}),u={}}else s&&(o[s]||(o[s]=[]),o[s].push(f.substring(2).trim()));c=!0;continue}let v=m.match(/^([^:]+):\s*(.*)$/);if(v&&v[1]&&v[2]!==void 0){let h=v[1].trim(),y=v[2].trim();if(y===""){s=h,l=g,c=!1;let b=p+1<i.length?i[p+1]:"";b.trim().startsWith("- ")&&(d=(p+2<i.length?i[p+2]:"").search(/\S/)>b.search(/\S/));continue}if(s=null,c=!1,d=!1,y.startsWith("[")&&y.endsWith("]"))try{let b=y.slice(1,-1).trim();if(!b)o[h]=[];else{let x=b.match(/"[^"]*"|'[^']*'|[^,]+/g)||[];o[h]=x.map(w=>w.replace(/^["']|["']$/g,"").trim()).filter(Boolean)}}catch(b){console.error(`[MissedTradeProcessor] Error parsing array in frontmatter for ${h}:`,b),o[h]=y}else y==="true"?y=!0:y==="false"?y=!1:/^-?\d+(\.\d+)?$/.test(y)&&(y=parseFloat(y)),o[h]=y}else if(g>l&&s&&d){let h=f.match(/^([^:]+):\s*(.*)$/);if(h){let y=h[1].trim(),b=h[2].trim();b==="true"?b=!0:b==="false"?b=!1:/^-?\d+(\.\d+)?$/.test(b)&&(b=parseFloat(b)),u[y]=b}}}}else{let i=this.app.metadataCache.getFileCache(r);o=(i==null?void 0:i.frontmatter)||{}}return o}catch(n){console.error("[MissedTradeProcessor] Error parsing frontmatter manually:",n);let o=this.app.metadataCache.getFileCache(r);return(o==null?void 0:o.frontmatter)||{}}}isValidComponentType(r){return r&&(r.type==="missed-trade"||r.isMissedTrade===!0)}getComponentClassName(){return"journalit-missed-trade-view"}getWrapperClassName(){return"journalit-missed-trade-note-wrapper"}getComponentTypeIdentifier(){return"missed-trade"}async getAdditionalDataForComponent(r,n){return{}}disconnectObserverSafely(r){let n=this.observerTimeouts.get(r);n&&(clearTimeout(n),this.observerTimeouts.delete(r)),r.disconnect();let o=this.activeObservers.indexOf(r);o>-1&&this.activeObservers.splice(o,1)}async handleFileOpen(r,n=!1){if(!r)return;this.cleanupOrphanedComponents(),this.cleanupUnrelatedComponents(r.path);let o=await this.getManualFrontmatter(r);if(!o||!this.isValidComponentType(o))return;let a=document.body,i=new MutationObserver((l,c)=>{let d=document.querySelectorAll(".cm-editor");if(d.length===0)return;d.forEach(p=>{var P;let m=p.querySelector(".metadata-container");if(!m)return;let f=m.closest(".workspace-leaf-content");if(!f)return;let g=this.findContainingLeaf(f),v=(P=g==null?void 0:g.view)==null?void 0:P.containerEl,h=m.closest(".workspace-leaf"),b=(h==null?void 0:h.id)||(v==null?void 0:v.id)||null,x=this.getUniqueElementId(p),w=b?`leaf-${b}`:x,S=!0;if(g){let D=g.view,O=null;(D&&"file"in D||D&&"getViewType"in D&&D.getViewType()==="markdown")&&(O=D.file),O&&(S=O.path===r.path)}if(!S)return;let k=this.getComponentClassName();p.querySelectorAll(`.${k}`).forEach(D=>{let O=D.getAttribute("data-file-path");if(O&&O!==r.path){let z=D.getAttribute("data-view-id"),I=D.getAttribute("data-leaf-id");z&&this.renderer.unmountComponent(O,z,I||void 0),D.remove()}});let T=Array.from(p.querySelectorAll(`.${k}`)).find(D=>D.getAttribute("data-file-path")===r.path);T||(T=document.createElement("div"),T.className=k,T.classList.add("journalit-component-container"),T.setAttribute("data-file-path",r.path),T.setAttribute("data-view-id",w),T.setAttribute("data-editor-id",x),b&&T.setAttribute("data-leaf-id",b),T.setAttribute("data-inserted-at",Date.now().toString()),m.after(T)),this.renderer.renderComponent(T,o,r.path,w,x),this.markFileRenderedInMode(r.path,"source")}),c.disconnect();let u=this.activeObservers.indexOf(c);u>-1&&this.activeObservers.splice(u,1)});this.activeObservers.push(i),i.observe(a,{childList:!0,subtree:!0});let s=setTimeout(()=>{this.disconnectObserverSafely(i)},3e3);this.observerTimeouts.set(i,s)}renderAllActiveMissedTradeNotes(){let r=new Set;this.app.workspace.iterateAllLeaves(n=>{try{if(!n.view||!("file"in n.view))return;let o=n.view.file;if(!o||r.has(o.path))return;let a=this.app.metadataCache.getFileCache(o),i=a==null?void 0:a.frontmatter;if(!i||!this.isValidComponentType(i))return;r.add(o.path),setTimeout(()=>{this.handleFileOpen(o,!0)},300)}catch(o){console.error("[MissedTradeNote] Error rendering active missed trade note at startup:",o)}})}renderActiveComponent(){this.renderActiveMissedTradeNote()}setupMissedTradeUpdateListener(){let r=async n=>{try{if(!n.detail||!n.detail.filePath)return;let o=n.detail.filePath,a=this.app.vault.getAbstractFileByPath(o);if(!(a instanceof GA.TFile)){console.warn(`[MissedTradeProcessor] Cannot find file for path: ${o}`);return}await this.refreshMissedTradeNote(a)}catch(o){console.error("[MissedTradeProcessor] Error handling missed trade update event:",o)}};document.addEventListener("journalit:missed-trade-data-changed",r),this._missedTradeUpdateListener=r}async refreshMissedTradeNote(r){try{let n=await this.app.vault.read(r),o={},a=n.match(/^---\n([\s\S]*?)\n---/m);if(a&&a[1]){let c=a[1].split(`
`),d=null,u=0,p=!1,m=!1,f={};for(let g=0;g<c.length;g++){let v=c[g],h=v.trim();if(!h)continue;let y=v.search(/\S/);if(h.startsWith("- ")){if(d&&m){let w=h.substring(2).trim().match(/^([^:]+):\s*(.*)$/);if(w){let T=w[1].trim(),P=w[2].trim();P==="true"?P=!0:P==="false"?P=!1:/^-?\d+(\.\d+)?$/.test(P)&&(P=parseFloat(P)),f[T]=P}let S=g+1<c.length?c[g+1]:"",k=S.search(/\S/);if(S.trim()&&!S.trim().startsWith("- ")&&k>u)continue;o[d]||(o[d]=[]),o[d].push({...f}),f={}}else d&&(o[d]||(o[d]=[]),o[d].push(h.substring(2).trim()));p=!0;continue}let b=v.match(/^([^:]+):\s*(.*)$/);if(b&&b[1]&&b[2]!==void 0){let x=b[1].trim(),w=b[2].trim();if(w===""){d=x,u=y,p=!1;let S=g+1<c.length?c[g+1]:"";S.trim().startsWith("- ")&&(m=(g+2<c.length?c[g+2]:"").search(/\S/)>S.search(/\S/));continue}if(d=null,p=!1,m=!1,w.startsWith("[")&&w.endsWith("]"))try{let S=w.slice(1,-1).trim();if(!S)o[x]=[];else{let k=S.match(/"[^"]*"|'[^']*'|[^,]+/g)||[];o[x]=k.map(T=>T.replace(/^["']|["']$/g,"").trim()).filter(Boolean)}}catch(S){console.error(`[MissedTradeProcessor] Error parsing array in frontmatter for ${x}:`,S),o[x]=w}else w==="true"?w=!0:w==="false"?w=!1:/^-?\d+(\.\d+)?$/.test(w)&&(w=parseFloat(w)),o[x]=w}else if(y>u&&d&&m){let x=h.match(/^([^:]+):\s*(.*)$/);if(x){let w=x[1].trim(),S=x[2].trim();S==="true"?S=!0:S==="false"?S=!1:/^-?\d+(\.\d+)?$/.test(S)&&(S=parseFloat(S)),f[w]=S}}}}else{let c=this.app.metadataCache.getFileCache(r);o=(c==null?void 0:c.frontmatter)||{}}let i=r.path.includes("-M")&&r.path.endsWith(".md");if(!this.isValidComponentType(o)&&!i){console.warn(`[MissedTradeNote] File is not a valid missed trade note: ${r.path}`,{frontmatter:o,type:o==null?void 0:o.type,isMissedTrade:o==null?void 0:o.isMissedTrade,checkedByPath:i});return}this.app.metadataCache.trigger("changed",r),this.cleanupDuplicateComponents(r.path);let s=this.getComponentClassName(),l=document.querySelectorAll(`.${s}[data-file-path="${r.path}"]`);if(l.length===0)return;for(let c of Array.from(l)){let d=c.getAttribute("data-view-id"),u=c.getAttribute("data-markdown-view-id")||c.getAttribute("data-editor-id");d&&(c.classList.add("jl-component-visible"),c.querySelectorAll(`.${this.getWrapperClassName()}`).forEach(m=>m.remove()),await new Promise(m=>setTimeout(()=>{try{this.renderWithDeduplication({file:r,container:c,data:o,viewId:d,contextId:u||void 0,componentClassName:this.getComponentClassName(),mountedClassName:"missed-trade-note-mounted",contentSelector:".missed-trade-note-container"}),m()}catch(f){console.error("[MissedTradeNote] Error during re-render:",f),m()}},50)))}this.markFileRenderedInMode(r.path,"source"),this.markFileRenderedInMode(r.path,"preview")}catch(n){console.error(`[MissedTradeNote] Error refreshing missed trade note for ${r.path}:`,n)}}cleanup(){for(let[r,n]of this.observerTimeouts)clearTimeout(n);this.observerTimeouts.clear(),super.cleanup(),this._missedTradeUpdateListener&&(document.removeEventListener("journalit:missed-trade-data-changed",this._missedTradeUpdateListener),this._missedTradeUpdateListener=null)}async renderActiveMissedTradeNote(){var p;this.cleanupOrphanedComponents();let r=this.app.workspace.getActiveFile();if(!r)return;let n=await this.getManualFrontmatter(r);if(!n||!this.isValidComponentType(n))return;let o=this.app.workspace.getActiveViewOfType(GA.MarkdownView);if(!o){console.error("[MissedTradeNote] No active markdown view found");return}let a=o.containerEl.closest(".workspace-leaf-content");if(!a){console.error("[MissedTradeNote] Cannot find containing leaf for active view");return}let i=this.findContainingLeaf(a),s=(p=i==null?void 0:i.view)==null?void 0:p.containerEl,l=(s==null?void 0:s.id)||null,c=l?`leaf-${l}`:this.generateViewId(a),d=o.getMode()==="source",u=this.getComponentClassName();if(d){let m=o.containerEl.querySelector(".metadata-container");if(m){let f=Array.from(a.querySelectorAll(`.${u}`)).find(g=>{let v=g.getAttribute("data-file-path")===r.path,h=g.getAttribute("data-view-id")===c,y=!l||g.getAttribute("data-leaf-id")===l;return v&&h&&y});f||(f=document.createElement("div"),f.className=u,f.classList.add("journalit-component-container"),f.setAttribute("data-file-path",r.path),f.setAttribute("data-view-id",c),l&&f.setAttribute("data-leaf-id",l),m.after(f)),this.renderer.renderComponent(f,n,r.path,c),this.markFileRenderedInMode(r.path,"source")}}else{let m=o.containerEl.querySelector(".markdown-preview-view");if(m){let f=Array.from(m.querySelectorAll(`.${u}`)).find(g=>{let v=g.getAttribute("data-file-path")===r.path,h=g.getAttribute("data-view-id")===c,y=!l||g.getAttribute("data-leaf-id")===l;return v&&h&&y});f||(f=document.createElement("div"),f.className=u,f.classList.add("journalit-component-container"),f.setAttribute("data-file-path",r.path),f.setAttribute("data-view-id",c),l&&f.setAttribute("data-leaf-id",l),m.prepend(f)),this.renderer.renderComponent(f,n,r.path,c),this.markFileRenderedInMode(r.path,"preview")}}}}});var oo,Hle,qle=L(()=>{oo=q(Y());er();SS();wt();Hle=(0,oo.memo)(({plugin:e})=>{var c;let[t,r]=(0,oo.useState)(((c=e.settings.home)==null?void 0:c.recentItems)||[]),[n,o]=(0,oo.useState)("!Journalit");(0,oo.useEffect)(()=>{let d=u=>{r(u.detail.recentItems||[])};return document.addEventListener("journalit:recent-items-changed",d),()=>{document.removeEventListener("journalit:recent-items-changed",d)}},[]),(0,oo.useEffect)(()=>{(async()=>{var u;if((u=e.serviceManager)!=null&&u.getFolderPathService)try{let p=await e.serviceManager.getFolderPathService();o(p.journalFolderPath)}catch(p){console.error("Failed to get journal folder path:",p)}})()},[e.serviceManager]);let a=t.filter(d=>{var u,p;if(d.type==="view"&&d.viewType===Ti)return!1;if((u=e.settings.home)!=null&&u.filterRecentItemsToJournalit&&d.type==="file"){let m=(p=e.serviceManager)==null?void 0:p.getFolderPathService();return!m||!d.path?!1:m.isJournalPath(d.path)}return!0}).slice(0,5),i=d=>{if(d.type==="file"&&d.title){let u=d.title.toLowerCase();if(u.includes("drc")||u.includes("daily report card"))return Su;if(u.includes("weekly review")||u.includes("week review")||/w\d+-review/.test(u))return If;if(u.includes("monthly review")||u.includes("month review")||/^\d+-review/.test(u))return Af}if(d.type==="file")return yw;switch(d.viewType){case"journalit-dashboard-view":return Nf;case"account-dashboard":return Du;case"journalit-account-page-view":return Ow;case"journalit-trade-log-view":return Lf;case"journalit-csv-import-view":return Mf;default:return bw}},s=async d=>{try{if(d.type==="file"&&d.path)await e.openFile(d.path,!0);else if(d.type==="view"&&d.viewType)switch(d.viewType){case"journalit-dashboard-view":await e.viewManager.openDashboardView();break;case"account-dashboard":await e.viewManager.openAccountDashboardView();break;case"journalit-trade-log-view":await e.viewManager.openTradeLogView();break;case"journalit-csv-import-view":await e.viewManager.openCSVImportView();break;case"journalit-account-page-view":let u=d.title.replace(/^Account:\s*/,"");await e.viewManager.openAccountPageView(u);break;default:console.warn("Unknown view type:",d.viewType)}}catch(u){console.error("Failed to open recent item:",u)}},l=d=>{let u=Xt(d);if(!u)return"Unknown";let p=new Date,m=Wr(u),f=Wr(p);if(!m||!f)return"Unknown";let g=f-m,v=Math.floor(g/6e4),h=Math.floor(v/60),y=Math.floor(h/24);return v<1?"Just now":v<60?`${v}m ago`:h<24?`${h}h ago`:y<7?`${y}d ago`:u.toLocaleDateString()};return oo.default.createElement("div",{className:"journalit-recent-items-widget",style:{height:"100%",display:"flex",flexDirection:"column"}},oo.default.createElement("div",{style:{fontSize:"16px",fontWeight:600,color:"var(--text-normal)",marginBottom:"12px"}},"Recent Items"),oo.default.createElement("div",{style:{flex:1,overflow:"auto"}},a.length===0?oo.default.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",color:"var(--text-muted)",textAlign:"center"}},oo.default.createElement(xl,{size:32,style:{marginBottom:"8px",opacity:.5,color:"var(--text-muted)"}}),oo.default.createElement("div",{style:{fontSize:"14px"}},"No recent items yet"),oo.default.createElement("div",{style:{fontSize:"12px",marginTop:"4px"}},"Open files or views to see them here")):oo.default.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"6px"}},a.map((d,u)=>{let p=i(d);return oo.default.createElement("div",{key:`${d.type}-${d.path||d.viewType}-${u}`,className:"jl-recent-item-hover",onClick:()=>s(d),style:{display:"flex",alignItems:"center",padding:"8px",borderRadius:"4px",cursor:"pointer",transition:"all 0.2s ease"}},oo.default.createElement("div",{style:{width:"16px",height:"16px",marginRight:"8px",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--text-muted)"}},oo.default.createElement(p,{size:14})),oo.default.createElement("div",{style:{flex:1,minWidth:0}},oo.default.createElement("div",{style:{fontSize:"13px",fontWeight:500,color:"var(--text-normal)",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},d.title),oo.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-muted)",marginTop:"2px"}},l(d.openedAt))))}))))})});var ef,Eze,Gle,Yle=L(()=>{ef=q(Y());tR();jv();Eze=({plugin:e})=>{let t=new Date().getFullYear(),{dashboardData:r}=gm(),n=async o=>{try{await(await e.serviceManager.getDRCService()).openDRC(o)}catch(a){console.error("Failed to open DRC for date:",a)}};return ef.default.createElement("div",{className:"journalit-year-heatmap-widget",style:{height:"100%",display:"flex",flexDirection:"column"}},ef.default.createElement("div",{style:{fontSize:"16px",fontWeight:600,color:"var(--text-normal)",marginBottom:"12px",display:"flex",alignItems:"center",justifyContent:"space-between"}},ef.default.createElement("span",null,"Trading Heatmap"),ef.default.createElement("span",{style:{fontSize:"12px",fontWeight:400,color:"var(--text-muted)"}},t)),ef.default.createElement("div",{style:{flex:1,minHeight:0}},ef.default.createElement(eR,{trades:(r==null?void 0:r.trades)||[],year:t,onDayClick:n,height:"100%"})))},Gle=ef.default.memo(Eze)});var Xa,YA,Ize,Kle,Aze,Jle,Xle=L(()=>{Xa=q(Y()),YA=q(Sj());qle();Yle();Ize=(0,YA.WidthProvider)(YA.Responsive),Kle=[{id:"recentItems",name:"Recent Items",defaultSize:{w:6,h:4}},{id:"yearHeatmap",name:"Trading Heatmap",defaultSize:{w:6,h:4}}],Aze=({plugin:e,isEditing:t,widgets:r})=>{let[n,o]=(0,Xa.useState)({lg:[],md:[],sm:[],xs:[],xxs:[]}),a=(0,Xa.useCallback)(l=>({...l,i:l.i,x:typeof l.x=="number"?l.x:0,y:typeof l.y=="number"?l.y:0,w:typeof l.w=="number"&&l.w>0?l.w:1,h:typeof l.h=="number"&&l.h>0?l.h:1}),[]);(0,Xa.useEffect)(()=>{(()=>{try{let c=e.settings.home;if(!c)return;let d=c.layouts[c.activeLayout||"Default"];if(!d)return;let u=Kle.map(y=>y.id),p=(d.lg||[]).filter(y=>u.includes(y.i)&&r.includes(y.i)).map(a),m=(d.md||[]).filter(y=>u.includes(y.i)&&r.includes(y.i)).map(a),f=(d.sm||[]).filter(y=>u.includes(y.i)&&r.includes(y.i)).map(a),g=(d.xs||[]).filter(y=>u.includes(y.i)&&r.includes(y.i)).map(a),v=(d.xxs||[]).filter(y=>u.includes(y.i)&&r.includes(y.i)).map(a),h={lg:12,md:6,sm:4,xs:2,xxs:1};r.forEach(y=>{let b=p.some(T=>T.i===y),x=m.some(T=>T.i===y),w=f.some(T=>T.i===y),S=g.some(T=>T.i===y),k=v.some(T=>T.i===y);if(!b||!x||!w||!S||!k){let T=Kle.find(P=>P.id===y);if(T){let P={i:y,x:0,y:1/0,w:T.defaultSize.w,h:T.defaultSize.h};b||p.push({...P,w:Math.min(P.w,h.lg)}),x||m.push({...P,w:Math.min(P.w,h.md)}),w||f.push({...P,w:Math.min(P.w,h.sm)}),S||g.push({...P,w:Math.min(P.w,h.xs)}),k||v.push({...P,w:1})}}}),o({lg:p,md:m,sm:f,xs:g,xxs:v})}catch(c){console.error("Error loading home layouts:",c)}})()},[e,r,a]);let i=(0,Xa.useCallback)((l,c)=>{if(t&&e.settings.home)try{let d=e.settings.home,u=d.activeLayout||"Default",p={lg:c.lg||[],md:c.md||[],sm:c.sm||[],xs:c.xs||[],xxs:c.xxs||[]};d.layouts[u]=p,e.saveSettings()}catch(d){console.error("Error saving home layout:",d)}},[t,e]),s=(0,Xa.useCallback)(l=>{switch(l){case"recentItems":return Xa.default.createElement(Hle,{plugin:e});case"yearHeatmap":return Xa.default.createElement(Gle,{plugin:e});default:return Xa.default.createElement("div",{className:"journalit-home-widget-error",style:{padding:"16px",textAlign:"center",color:"var(--text-muted)",border:"1px dashed var(--background-modifier-border)",borderRadius:"4px"}},"Unknown widget: ",l)}},[e]);return Xa.default.createElement("div",{className:`journalit-home-grid-layout ${t?"is-editing":""}`,style:{padding:"0",margin:"0",width:"100%",height:"100%"}},Xa.default.createElement(Ize,{className:`layout ${t?"editing":""}`,layouts:n,breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:12,md:6,sm:4,xs:2,xxs:1},rowHeight:50,isResizable:t,isDraggable:t,onLayoutChange:i,compactType:"vertical",preventCollision:!1,useCSSTransforms:!0,containerPadding:[0,12],margin:[12,12]},r.map(l=>Xa.default.createElement("div",{key:l,className:`journalit-home-widget ${t?"is-editing":""}`,style:{position:"relative",width:"100%",height:"100%",display:"flex",flexDirection:"column",backgroundColor:"var(--background-primary)",borderRadius:"6px",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",overflow:"hidden",border:"1px solid var(--background-modifier-border)"}},Xa.default.createElement("div",{className:"journalit-home-widget-content",style:{flex:1,padding:"12px",height:"100%",overflow:"hidden"}},s(l))))))},Jle=Xa.default.memo(Aze)});var KA,Qle=L(()=>{Td();KA=class{constructor(t){this.plugin=t}async executeAction(t){switch(t){case"addTrade":new jo({app:this.plugin.app,plugin:this.plugin}).open();break;case"openTradeLog":await this.plugin.viewManager.openTradeLogView();break;case"openTradingDashboard":await this.plugin.viewManager.openDashboardView();break;case"openAccountDashboard":await this.plugin.viewManager.openAccountDashboardView();break;case"openTodaysDRC":try{await(await this.plugin.serviceManager.getDRCService()).openDRC(new Date)}catch(n){console.error("Failed to open today's DRC:",n)}break;case"openWeeklyReview":try{await(await this.plugin.serviceManager.getWeeklyReviewService()).openWeeklyReview(new Date)}catch(n){console.error("Failed to open weekly review:",n)}break;case"openMonthlyReview":try{await(await this.plugin.serviceManager.getMonthlyReviewService()).openMonthlyReview(new Date)}catch(n){console.error("Failed to open monthly review:",n)}break;case"openCSVImport":await this.plugin.viewManager.openCSVImportView();break;default:console.warn(`Unknown quick link action: ${t}`)}}}});function Zle(e){return Lze[e]||Tu}var Lze,ece=L(()=>{er();Lze={"plus-circle":Tu,"folder-tree":Lf,grip:Nf,users:Du,calendar:Su,"calendar-check":If,"calendar-range":Af,import:Mf}});var Sr,Nze,Mze,tce,rce,nce=L(()=>{Sr=q(Y());er();E0();U1();Wv();Zf();Qle();ece();Nze=({transform:e})=>({...e,y:0}),Mze=({quickLink:e,isEditing:t,onRemove:r,onClick:n})=>{let{attributes:o,listeners:a,setNodeRef:i,transform:s,transition:l}=Hv({id:e.id,disabled:!t}),c={transform:Nl.Transform.toString(s&&{...s,y:0}),transition:l,position:"relative",height:"100%",flex:"1 1 auto",minWidth:"140px"},d=Zle(e.icon),u=(0,Sr.useCallback)(m=>{m.stopPropagation(),m.preventDefault(),r(e.id)},[e.id,r]),p=(0,Sr.useCallback)(()=>{t||n(e.action)},[t,n,e.action]);return Sr.default.createElement("div",{ref:i,style:c},Sr.default.createElement("div",{className:"journalit-quick-link-wrapper",style:{position:"relative",cursor:t?"grab":"pointer",height:"100%",display:"flex",flexDirection:"column"}},Sr.default.createElement("div",{...o,...t?a:{},style:{flex:1,height:"100%"}},Sr.default.createElement("button",{onClick:p,disabled:t,className:"jl-quick-link-hover",style:{display:"flex",alignItems:"center",gap:"8px",padding:"10px 16px",border:"1px solid var(--background-modifier-border)",borderRadius:"8px",backgroundColor:"var(--background-secondary)",color:"var(--text-normal)",cursor:t?"grab":"pointer",fontSize:"13px",fontWeight:500,textAlign:"left",transition:"all 0.2s ease",width:"100%",height:"100%",opacity:t?.8:1,"--link-color":e.color},"aria-label":e.label},Sr.default.createElement(d,{size:16,style:{color:e.color,flexShrink:0}}),Sr.default.createElement("span",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},e.label))),t&&Sr.default.createElement("button",{className:"journalit-quick-link-remove",onClick:u,"aria-label":"Hide quick link",style:{zIndex:1e5,position:"absolute",top:"4px",right:"4px",width:"22px",height:"22px",backgroundColor:"var(--background-modifier-error)",color:"white",border:"none",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",cursor:"pointer",padding:0}},Sr.default.createElement(Us,{size:12}))))},tce=(0,Sr.forwardRef)(({plugin:e,isEditing:t=!1},r)=>{var u;let[n,o]=(0,Sr.useState)([]);(0,Sr.useEffect)(()=>{var m,f;let p=(m=e.settings.home)==null?void 0:m.quickLinks;if(p&&p.length>0)o(p);else{let g=((f=wo.home)==null?void 0:f.quickLinks)||[];g.length>0&&(o(g),e.settings.home={...e.settings.home,quickLinks:g},e.saveSettings())}},[(u=e.settings.home)==null?void 0:u.quickLinks,e]);let a=(0,Sr.useMemo)(()=>new KA(e),[e]),i=(0,Sr.useMemo)(()=>n.filter(p=>p.visible).sort((p,m)=>p.order-m.order),[n]),s=(0,Sr.useCallback)(p=>{let{active:m,over:f}=p;if(f&&m.id!==f.id){let g=m.id.toString(),v=f.id.toString(),h=i.findIndex(b=>b.id===g),y=i.findIndex(b=>b.id===v);if(h!==-1&&y!==-1){let b=[...i],[x]=b.splice(h,1);b.splice(y,0,x);let w=n.map(S=>{let k=b.findIndex(T=>T.id===S.id);if(k!==-1)return{...S,order:k};{let T=b.length-1,P=n.filter(D=>!D.visible).findIndex(D=>D.id===S.id);return{...S,order:T+1+P}}});o(w),e.settings.home={...e.settings.home,quickLinks:w},e.saveSettings()}}},[i,n,e]),l=(0,Sr.useCallback)(p=>{let m=n.map(f=>f.id===p?{...f,visible:!1}:f);o(m),e.settings.home={...e.settings.home,quickLinks:m},e.saveSettings()},[n,e]),c=(0,Sr.useCallback)(()=>{let p=n.map(m=>({...m,visible:!0}));o(p),e.settings.home={...e.settings.home,quickLinks:p},e.saveSettings()},[n,e]);(0,Sr.useImperativeHandle)(r,()=>({restoreHidden:c}),[c]);let d=(0,Sr.useCallback)(async p=>{try{await a.executeAction(p)}catch(m){console.error("Failed to execute quick link action:",m)}},[a]);return i.length===0?Sr.default.createElement("div",{className:"journalit-quick-links-row",style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"16px 0",color:"var(--text-muted)",fontSize:"13px"}},t?"All quick links are hidden. Use the settings to show them.":"No quick links available."):Sr.default.createElement("div",{className:"journalit-quick-links-row",style:{display:"flex",flexWrap:"wrap",gap:"12px",padding:"16px 0",justifyContent:"center"}},Sr.default.createElement(Uv,{collisionDetection:Rv,onDragEnd:s,modifiers:[Nze]},Sr.default.createElement(Vv,{items:i.map(p=>p.id),strategy:R1},i.map(p=>Sr.default.createElement(Mze,{key:p.id,quickLink:p,isEditing:t,onRemove:l,onClick:d})))))});tce.displayName="QuickLinksRowComponent";rce=Sr.default.memo(tce)});var Rt,oce,Fze,ace,ice=L(()=>{Rt=q(Y());er();jv();Xle();nce();oce=["still up?","late night session?","burning the midnight oil?","ready to conquer the day?","how's it going?","winding down?","how did today go?"],Fze=({plugin:e})=>{let[t,r]=(0,Rt.useState)(!1),[n]=(0,Rt.useState)(["recentItems","yearHeatmap"]),[o,a]=(0,Rt.useState)(0),i=(0,Rt.useRef)(null),[s,l]=(0,Rt.useState)(null),[c,d]=(0,Rt.useState)("");(0,Rt.useEffect)(()=>{e.settings.home||(e.settings.home={layouts:{Default:{lg:[{i:"recentItems",x:0,y:0,w:6,h:4},{i:"yearHeatmap",x:6,y:0,w:6,h:4}],md:[{i:"recentItems",x:0,y:0,w:6,h:4},{i:"yearHeatmap",x:0,y:4,w:6,h:4}],sm:[{i:"recentItems",x:0,y:0,w:4,h:4},{i:"yearHeatmap",x:0,y:4,w:4,h:4}],xs:[{i:"recentItems",x:0,y:0,w:2,h:4},{i:"yearHeatmap",x:0,y:4,w:2,h:4}],xxs:[{i:"recentItems",x:0,y:0,w:1,h:4},{i:"yearHeatmap",x:0,y:4,w:1,h:4}]}},activeLayout:"Default",recentItems:[]},e.saveSettings())},[e]),(0,Rt.useEffect)(()=>{let b=()=>{a(x=>x+1)};return window.addEventListener("journalit:display-name-changed",b),()=>{window.removeEventListener("journalit:display-name-changed",b)}},[]),(0,Rt.useEffect)(()=>{let b=f();l(b.jsx);let x=g(b.originalString),w=v(x);d(w)},[o]);let u=()=>{r(!t)},p=(0,Rt.useCallback)(()=>{var b;if(i.current)i.current.restoreHidden();else{let w=(((b=e.settings.home)==null?void 0:b.quickLinks)||[]).map(S=>({...S,visible:!0}));e.settings.home={...e.settings.home,quickLinks:w},e.saveSettings()}},[e]),m=()=>{let b=`journalit-onboarding-ever-shown-${e.app.vault.getName()}`;return!localStorage.getItem(b)},f=()=>{var j;if(m()){let E="Welcome to Journalit!";return{jsx:E,originalString:E}}let b=((j=e.settings.general)==null?void 0:j.displayName)||"",w=new Date().getHours(),S=["Hey nightowl","still up?","late night session?","burning the midnight oil?"],k=["Good morning","Rise and shine","Morning trader","ready to conquer the day?","Fresh start"],T=["Good afternoon","Hope your day's going well","Afternoon check-in","Midday momentum","how's it going?"],P=["Good evening","winding down?","Evening review","how did today go?","Time to reflect"],D=["Welcome back","Hey there","Good to see you"],O=[];w>=0&&w<5?O=S:w>=5&&w<11?O=k:w>=11&&w<17?O=T:O=P;let z=[...O,...D],I=Math.floor(Math.random()*z.length),A=z[I];if(oce.includes(A))if(b){let E=Rt.default.createElement(Rt.default.Fragment,null,Rt.default.createElement("span",{style:{fontWeight:400}},"Hey "),Rt.default.createElement("span",{style:{fontWeight:600}},b),Rt.default.createElement("span",{style:{fontWeight:400}},", ",A)),N=`Hey ${b}, ${A}`;return{jsx:E,originalString:N}}else return{jsx:A,originalString:A};if(b){let E=Rt.default.createElement(Rt.default.Fragment,null,Rt.default.createElement("span",{style:{fontWeight:400}},A,", "),Rt.default.createElement("span",{style:{fontWeight:600}},b)),N=`${A}, ${b}`;return{jsx:E,originalString:N}}return{jsx:A,originalString:A}},g=b=>oce.some(x=>b.includes(x))||b.endsWith("?"),v=b=>{if(m())return"Let's get you started with your trading journey";let S=b?["Let's see how you're doing","Time to elevate your trading","Your trading journey continues","Let's check your progress"]:["Ready to elevate your trading?","What's on the agenda today?","How's your trading going?"],k=Math.floor(Math.random()*S.length);return S[k]},h=new Date().getFullYear(),y={dateRange:[new Date(h,0,1),new Date(h,11,31)],accounts:[],tickers:[],setups:[],tradeTypes:[],statuses:[]};return Rt.default.createElement("div",{className:"journalit-home-page",style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",overflow:"hidden"}},Rt.default.createElement("div",{className:"journalit-home-header",style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",padding:"16px 16px 8px 16px",backgroundColor:"var(--background-primary)",flexShrink:0}},Rt.default.createElement("div",{style:{display:"flex",flexDirection:"column"}},Rt.default.createElement("h1",{style:{margin:0,fontSize:"28px",fontWeight:600,color:"var(--text-normal)",lineHeight:"1.2"}},s),Rt.default.createElement("p",{style:{margin:"4px 0 0 0",fontSize:"14px",color:"var(--text-muted)",fontWeight:400}},c)),Rt.default.createElement("div",{style:{display:"flex",gap:"8px"}},t&&Rt.default.createElement("button",{onClick:p,className:"journalit-home-restore-button jl-restore-button-hover",title:"Restore Hidden",style:{display:"flex",alignItems:"center",gap:"0",padding:"8px",color:"var(--text-normal)",borderRadius:"6px",fontSize:"12px",cursor:"pointer",transition:"all 0.2s ease"}},Rt.default.createElement(Of,{size:12})),Rt.default.createElement("button",{onClick:u,className:`journalit-home-edit-toggle ${t?"active":""}`,"aria-label":t?"Save Layout":"Customize",style:{display:"flex",alignItems:"center",gap:"0",padding:"8px",border:`1px solid ${t?"var(--interactive-accent)":"var(--background-modifier-border)"}`,borderRadius:"6px",backgroundColor:t?"var(--interactive-accent)":"var(--background-primary)",color:t?"var(--text-on-accent)":"var(--text-normal)",cursor:"pointer",fontSize:"12px",fontWeight:500,transition:"all 0.2s ease"}},t?Rt.default.createElement(Mo,{size:14}):Rt.default.createElement(Iw,{size:14})))),Rt.default.createElement("div",{className:"journalit-home-content",style:{flex:1,overflow:"auto",padding:"0 16px 16px 16px",display:"flex",flexDirection:"column",gap:"16px"}},Rt.default.createElement(C1,{app:e.app,tradeService:e.tradeService,filters:y},Rt.default.createElement("div",{style:{flex:"0 0 auto"}},Rt.default.createElement(Jle,{plugin:e,isEditing:t,widgets:n})),Rt.default.createElement("div",{style:{flex:"0 0 auto"}},Rt.default.createElement(rce,{plugin:e,isEditing:t,ref:i})))))},ace=Rt.default.memo(Fze)});var sce,Ti,JA,SS=L(()=>{sce=q(Y());Xf();ice();Ti="journalit-home-view",JA=class extends us{constructor(t,r){super(t,{rootId:"journalit-home-view"}),this.plugin=r}async onOpen(){this.containerEl.addClass("journalit-home-view-container"),await super.onOpen()}getViewType(){return Ti}getDisplayText(){return"Journalit"}getIcon(){return"circle-dot-dashed"}getRenderFunction(){return()=>sce.default.createElement(ace,{plugin:this.plugin})}}});var jR,oL,uce=L(()=>{jR=require("obsidian");NA();oL=class{constructor(t,r,n={}){this.indexes=new Map;this.indexConfigs=new Map;this.filePathMap=new Map;this.buildingIndexes=new Set;this.processedFiles=new Set;this.isDirty=!1;this.persistIndexes=!0;this.isInitialized=!1;this.pendingFileChanges=[];this.saveIntervalId=null;this.BASE_FOLDER=".journalit";this.INDEX_FOLDER="indexes";this.plugin=null;var o;this.app=t,this.dataExtractor=r,this.persistIndexes=(o=n.persistIndexes)!=null?o:!0,this.boundHandleFileChange=this.handleFileChange.bind(this)}setPlugin(t){this.plugin=t,this.plugin.registerEvent(this.app.vault.on("create",this.boundHandleFileChange)),this.plugin.registerEvent(this.app.vault.on("modify",this.boundHandleFileChange)),this.plugin.registerEvent(this.app.vault.on("delete",this.boundHandleFileChange)),this.plugin.registerEvent(this.app.vault.on("rename",this.boundHandleFileChange)),this.isInitialized&&this.persistIndexes&&!this.saveIntervalId&&(this.saveIntervalId=this.plugin.registerInterval(window.setInterval(()=>this.saveIndexes(),300*1e3)))}async initialize(){if(!this.isInitialized)try{let t=`${this.BASE_FOLDER}/${this.INDEX_FOLDER}`;await this.app.vault.adapter.exists(t)||await this.app.vault.adapter.mkdir(t),this.persistIndexes&&await this.loadIndexes(),this.isInitialized=!0;for(let r of this.pendingFileChanges)this.handleFileChange(r);this.pendingFileChanges=[],this.persistIndexes&&this.plugin&&(this.saveIntervalId=this.plugin.registerInterval(window.setInterval(()=>this.saveIndexes(),300*1e3)))}catch(t){console.error("Failed to initialize index manager:",t)}}registerIndex(t){this.indexConfigs.set(t.name,t),this.indexes.has(t.name)||this.indexes.set(t.name,[]),this.buildingIndexes.has(t.name)||this.buildIndex(t.name)}getIndex(t){return this.indexes.get(t)||[]}queryIndex(t,r={},n={}){let o=this.indexes.get(t);if(!o)return[];let a=o.filter(i=>Object.entries(r).every(([s,l])=>Array.isArray(i.values[s])?Array.isArray(l)?l.some(c=>i.values[s].includes(c)):i.values[s].includes(l):i.values[s]===l));if(n.sort){let{field:i,direction:s}=n.sort;a.sort((l,c)=>{let d=l.values[i],u=c.values[i];if(d===u)return 0;if(d===void 0)return s==="asc"?-1:1;if(u===void 0)return s==="asc"?1:-1;let p=d<u?-1:1;return s==="asc"?p:-p})}return n.offset!==void 0&&n.offset>0&&(a=a.slice(n.offset)),n.limit!==void 0&&n.limit>0&&(a=a.slice(0,n.limit)),a}getUniqueValues(t,r){let n=this.indexes.get(t);if(!n)return[];let o=new Set;for(let a of n){let i=a.values[r];Array.isArray(i)?i.forEach(s=>o.add(s)):i!=null&&o.add(i)}return Array.from(o)}async buildIndex(t){if(!this.buildingIndexes.has(t)){this.buildingIndexes.add(t);try{let r=this.indexConfigs.get(t);if(!r){console.error(`No config found for index: ${t}`),this.buildingIndexes.delete(t);return}let n=this.app.vault.getFiles(),o=r.fileFilter?n.filter(r.fileFilter):n.filter(s=>s.extension==="md"),a=20,i=[];for(let s=0;s<o.length;s+=a){let l=o.slice(s,s+a);i.push(l)}this.indexes.set(t,[]);for(let s of i){let l=s.map(c=>async()=>{if(!this.processedFiles.has(c.path))try{await this.indexFile(c,t),this.processedFiles.add(c.path)}catch(d){console.error(`Error indexing file ${c.path}:`,d)}});for(let c=0;c<l.length;c++)await l[c](),c%5===0&&c>0&&await new Promise(d=>setTimeout(d,10))}this.isDirty=!0}catch(r){console.error(`Error building index ${t}:`,r)}finally{this.buildingIndexes.delete(t),this.persistIndexes&&this.saveIndexes()}}}async indexFile(t,r){let n=this.indexConfigs.get(r);if(n&&!(n.fileFilter&&!n.fileFilter(t)))try{let o=await this.dataExtractor(t);if(!o)return;let a={};for(let d of n.fields)n.valueExtractor?a[d]=n.valueExtractor(o,d):n.includeNested?a[d]=this.getNestedValue(o,d):a[d]=o[d];let i={data:o,file:t,values:a},s=this.indexes.get(r)||[],l=-1;this.filePathMap.has(t.path)||this.filePathMap.set(t.path,new Map);let c=this.filePathMap.get(t.path);if(c.has(r)&&(l=c.get(r)),l>=0&&l<s.length)s[l]=i;else{let d=s.length;s.push(i),c.set(r,d)}this.indexes.set(r,s),this.isDirty=!0}catch(o){console.error(`Error indexing file ${t.path} for index ${r}:`,o)}}removeFileFromIndexes(t){if(!this.filePathMap.has(t))return;let r=this.filePathMap.get(t);for(let[n,o]of r.entries()){let a=this.indexes.get(n);if(a&&o>=0&&o<a.length){let i=a.length-1;if(o!==i){let s=a[i];a[o]=s;let l=s.file.path;if(this.filePathMap.has(l)){let c=this.filePathMap.get(l);c.has(n)&&c.set(n,o)}}a.pop(),this.isDirty=!0}}this.filePathMap.delete(t),this.processedFiles.delete(t)}handleFileChange(t){if(!(!("path"in t)||t.path.includes(`${this.BASE_FOLDER}/${this.INDEX_FOLDER}`))){if(!this.isInitialized){this.pendingFileChanges.push(t);return}LA(async()=>{try{if(t instanceof jR.TFile){if(t.extension!=="md")return;for(let r of this.indexConfigs.keys())this.buildingIndexes.has(r)||await this.indexFile(t,r)}else this.removeFileFromIndexes(t.path);this.isDirty&&this.persistIndexes&&setTimeout(()=>this.saveIndexes(),2e3)}catch(r){console.error(`Error handling file change for ${t.path}:`,r)}})}}getNestedValue(t,r){return r.split(".").reduce((n,o)=>n&&n[o]!==void 0?n[o]:void 0,t)}async saveIndexes(){if(!(!this.isDirty||!this.persistIndexes))try{let t=`${this.BASE_FOLDER}/${this.INDEX_FOLDER}`;await this.app.vault.adapter.exists(t)||await this.app.vault.adapter.mkdir(t);for(let[r,n]of this.indexes.entries()){let o={name:r,entries:n.map(i=>({path:i.file.path,values:i.values}))},a=`${t}/${r}.json`;await this.app.vault.adapter.write(a,JSON.stringify(o))}this.isDirty=!1}catch(t){console.error("Failed to save indexes:",t)}}async loadIndexes(){try{let t=`${this.BASE_FOLDER}/${this.INDEX_FOLDER}`;if(!await this.app.vault.adapter.exists(t))return;let{files:r}=await this.app.vault.adapter.list(t);for(let n of r)try{let o=await this.app.vault.adapter.read(n),a=JSON.parse(o);if(!a.name||!Array.isArray(a.entries)){console.warn(`Invalid index file format: ${n}`);continue}let i=a.name;this.indexes.set(i,[]);for(let s=0;s<a.entries.length;s++){let l=a.entries[s],c=l.path,d=this.app.vault.getAbstractFileByPath(c);if(!d||!(d instanceof jR.TFile))continue;let u={data:null,file:d,values:l.values},p=this.indexes.get(i);p.push(u),this.filePathMap.has(c)||this.filePathMap.set(c,new Map),this.filePathMap.get(c).set(i,p.length-1),this.processedFiles.add(c)}}catch(o){console.error(`Failed to load index file ${n}:`,o)}}catch(t){console.error("Failed to load indexes:",t)}}unload(){this.saveIntervalId=null,this.persistIndexes&&this.isDirty&&this.saveIndexes(),this.indexes.clear(),this.indexConfigs.clear(),this.filePathMap.clear(),this.processedFiles.clear(),this.pendingFileChanges=[]}}});var pce={};Ko(pce,{CustomDataService:()=>Qi});var tf,Qi,rf=L(()=>{uce();ls();tf=class tf{constructor(t,r={}){this.app=t;this.indexManager=null;this.plugin=null;this.config={folder:r.folder||"",extension:r.extension||".md",cacheTTL:r.cacheTTL||tf.DEFAULT_CACHE_TTL,persistCache:r.persistCache!==void 0?r.persistCache:!0,namespace:r.namespace||"default",enableIndexing:r.enableIndexing!==void 0?r.enableIndexing:!0,indexes:r.indexes||[]},this.cache=new Map,this.isCacheInvalidated=!1,this.boundHandleFileChange=this.handleFileChange.bind(this),this.config.enableIndexing&&this.setupIndexing(),this.initializeService()}setPlugin(t){this.plugin=t,this.plugin.registerEvent(this.app.vault.on("create",this.boundHandleFileChange)),this.plugin.registerEvent(this.app.vault.on("modify",this.boundHandleFileChange)),this.plugin.registerEvent(this.app.vault.on("delete",this.boundHandleFileChange)),this.plugin.registerEvent(this.app.vault.on("rename",this.boundHandleFileChange)),this.indexManager&&this.indexManager.setPlugin(t)}setupIndexing(){if(tf.sharedIndexManager?this.indexManager=tf.sharedIndexManager:(this.indexManager=new oL(this.app,async t=>{try{return await this.readFrontmatter(t)}catch(r){return console.error(`Error extracting data from ${t.path}:`,r),null}}),this.plugin&&this.indexManager.setPlugin(this.plugin),tf.sharedIndexManager=this.indexManager,this.indexManager.initialize()),this.config.indexes.length>0)for(let t of this.config.indexes)this.indexManager.registerIndex(t)}async initializeService(){await this.loadPersistentCache()}getNamespacedKey(t){return`${this.config.namespace}:${t}`}async query(t,r,n={},o){let{useCache:a=!0,cacheTTL:i=this.config.cacheTTL,offlineCapable:s=!0,useIndexes:l=!0}=n,c=this.getNamespacedKey(r);try{if(a&&!this.isCacheInvalidated){let u=this.getCached(c,i);if(u!==null)return u}if(l&&this.indexManager&&o)try{let u=this.indexManager.queryIndex(o.indexName,o.filters||{},{sort:o.sort,limit:o.limit,offset:o.offset});if(u.length>0){let p=u.filter(f=>f.data!==null&&f.data!==void 0),m;return p.length===u.length?(m=u.map(f=>f.data||null).filter(Boolean),m.length===1&&!Array.isArray(t)&&(m=m[0])):m=(await Promise.all(u.map(async g=>{try{return this.app.vault.getAbstractFileByPath(g.file.path)?await this.readFrontmatter(g.file):null}catch(v){return(!(v instanceof Error)||!v.message.includes("ENOENT"))&&console.error(`Error loading data from file ${g.file.path}:`,v),null}}))).filter(Boolean),a&&(this.setCache(c,m),this.isCacheInvalidated=!1),m}}catch(u){console.warn(`Error using index for query ${r}:`,u)}let d=await t();return a&&(this.setCache(c,d),this.isCacheInvalidated=!1),d}catch(d){if(s&&a){let u=this.getCached(c,1/0);if(u!==null)return u}throw this.handleError(d)}}getCached(t,r){let n=this.cache.get(t);if(!n)return null;let{data:o,timestamp:a}=n;return Date.now()-a>r?(this.cache.delete(t),null):o}setCache(t,r){let n={data:r,timestamp:Date.now()};this.cache.set(t,n),this.config.persistCache&&this.savePersistentCache()}getCacheFilePath(){return`.journalit/cache/${this.config.namespace}-cache.json`}async loadPersistentCache(){try{let t=this.getCacheFilePath();if(await this.app.vault.adapter.exists(t)){let n=await this.app.vault.adapter.read(t);try{let o=JSON.parse(n);Object.entries(o).forEach(([a,i])=>{this.cache.set(a,i)})}catch(o){console.warn(`Failed to parse cache data for namespace ${this.config.namespace}:`,o instanceof Error?o.message:"Invalid JSON")}}}catch(t){let r=t instanceof Error?t.message:String(t);console.warn(`Failed to load persistent cache for namespace ${this.config.namespace}:`,r)}}async savePersistentCache(){try{let t=this.getCacheFilePath();await this.app.vault.adapter.mkdir(".journalit/cache");let r=Array.from(this.cache.entries()).filter(([o])=>o.startsWith(`${this.config.namespace}:`)),n=Object.fromEntries(r);await this.app.vault.adapter.write(t,JSON.stringify(n))}catch(t){console.warn(`Failed to save persistent cache for namespace ${this.config.namespace}:`,t instanceof Error?t.message:"Unknown error")}}async handleFileChange(t){if(!("path"in t)||t.path.includes("journalit/cache")||this.config.folder&&!t.path.startsWith(this.config.folder)||this.config.extension&&!t.path.endsWith(this.config.extension))return;let r=t.path.split("/"),n=r[r.length-1],o="";if(t.path.includes("/trades/")?o="trade:":t.path.includes("/Accounts/")?o="account:":t.path.includes("/DRC/")?o="drc:":t.path.includes("/Weekly/")&&(o="weekly:"),o){let a=this.config.namespace==="accountPage"&&o==="trade:";(this.config.namespace==="default"||o.startsWith(this.config.namespace)||this.config.namespace===o.replace(":","")||a)&&(await this.clearCacheWithPrefix(o),a&&(await this.clearCacheByPattern("accountPage:",!1),await this.clearCacheByPattern("accountTrades:",!1),await this.clearCacheByPattern("allEnhancedAccounts",!1)))}else this.config.namespace==="default"&&(this.isCacheInvalidated=!0,await this.clearCache())}handleError(t){return t instanceof Error?t:new Error("An unknown error occurred")}async clearCache(){this.isCacheInvalidated=!0;let t=`${this.config.namespace}:`;for(let r of this.cache.keys())r.startsWith(t)&&this.cache.delete(r);if(this.config.persistCache)try{let r=this.getCacheFilePath();await this.app.vault.adapter.write(r,JSON.stringify({}))}catch(r){console.warn(`Failed to clear persistent cache for namespace ${this.config.namespace}:`,r instanceof Error?r.message:"Unknown error")}}async clearCacheKey(t){let r=this.getNamespacedKey(t);this.cache.delete(r)&&this.config.persistCache&&await this.savePersistentCache()}async clearCacheWithPrefix(t){let r=this.getNamespacedKey(t),n=!1;for(let o of this.cache.keys())o.startsWith(r)&&(this.cache.delete(o),n=!0);n&&this.config.persistCache&&await this.savePersistentCache()}async clearCacheByPattern(t,r=!0){let n=r?this.getNamespacedKey(t):t,o=!1;for(let a of this.cache.keys())a.startsWith(n)&&(this.cache.delete(a),o=!0);o&&this.config.persistCache&&await this.savePersistentCache()}invalidateCache(){this.isCacheInvalidated=!0}getFiles(){return this.app.vault.getFiles().filter(r=>!(this.config.folder&&!r.path.startsWith(this.config.folder)||this.config.extension&&!r.path.endsWith(this.config.extension)))}registerIndex(t){if(!this.indexManager){console.warn("Index manager not initialized. Enable indexing in service config.");return}this.indexManager.registerIndex(t)}queryIndex(t,r={},n={}){return this.indexManager?this.indexManager.queryIndex(t,r,n):[]}getUniqueIndexValues(t,r){return this.indexManager?this.indexManager.getUniqueValues(t,r):[]}isIndexingEnabled(){return this.config.enableIndexing&&this.indexManager!==null}cleanup(){this.indexManager&&(this.indexManager.unload(),this.indexManager=null)}async readFrontmatter(t){try{let r=this.app.metadataCache.getFileCache(t);if(r!=null&&r.frontmatter)return JSON.parse(JSON.stringify(r.frontmatter));let o=(await this.app.vault.read(t)).match(/^---\n([\s\S]*?)\n---/);if(!o)return{};try{return this.parseYamlFrontmatter(o[1])}catch(a){return console.warn(`Failed to parse frontmatter with advanced parser for ${t.path}:`,a),this.simpleYamlParse(o[1])}}catch(r){return console.error(`Failed to parse frontmatter for ${t.path}:`,r),{}}}parseYamlFrontmatter(t){let r={},n=null,o=null,a=!1,i=[],s=null,l=0,c=t.split(`
`);for(let d=0;d<c.length;d++){let u=c[d];if(!u.trim())continue;let p=u.search(/\S|$/);if(p===0&&u.includes(":")){a&&n&&(r[n]=i,a=!1,i=[]);let[m,f]=this.parseKeyValue(u);if(n=m,f==="")if(d+1<c.length){let g=c[d+1];g.search(/\S|$/)>p||g.trim().startsWith("-")?(a=!1,o=null):(r[m]="",n=null)}else r[m]="",n=null;else if(f==="|"){let g="",v=-1;for(let h=d+1;h<c.length;h++){let y=c[h],b=y.search(/\S|$/);if(b===0&&y.trim()!=="")break;v===-1&&y.trim()!==""&&(v=b),(y.trim()!==""||g!=="")&&(g!==""&&(g+=`
`),g+=y.substring(v)),d=h}r[m]=g.trimEnd(),n=null}else f.startsWith("[")&&f.endsWith("]")?(r[m]=f.slice(1,-1).split(",").map(g=>g.trim()).filter(Boolean),n=null):(f==='""'||f==="''"?r[m]="":r[m]=f,n=null)}else if(u.trim().startsWith("-")&&n){let m=u.indexOf("-");a=!0,l=m;let f=u.substring(m+1).trim();if(!f)s={},i.push(s);else if(f.includes(":")){s={},i.push(s);let[g,v]=this.parseKeyValue(f);s&&(s[g]=v)}else i.push(f),s=null}else if(s&&u.trim().includes(":")&&u.search(/\S|$/)>l){let[m,f]=this.parseKeyValue(u);s[m.trim()]=f}else if(u.includes(":")&&n){let[m,f]=this.parseKeyValue(u);(typeof r[n]!="object"||r[n]===null)&&(r[n]={}),r[n][m.trim()]=f}}return a&&n&&(r[n]=i),r}parseKeyValue(t){let r=t.indexOf(":");if(r===-1)return[t.trim(),""];let n=t.slice(0,r).trim(),o=t.slice(r+1).trim();return[n,o]}simpleYamlParse(t){let r={};return t.split(`
`).forEach(n=>{if(!n.trim())return;let o=n.indexOf(":");if(o===-1)return;let a=n.slice(0,o).trim(),i=n.slice(o+1).trim();if(i.startsWith("[")&&i.endsWith("]"))r[a]=i.slice(1,-1).split(",").map(s=>s.trim()).filter(Boolean);else if(n.startsWith("  ")&&a.startsWith("  ")){let s=Object.keys(r).pop();s&&!Array.isArray(r[s])&&(typeof r[s]!="object"&&(r[s]={}),r[s][a.trim()]=i)}else r[a]=i}),r}async updateFrontmatter(t,r){await this.app.fileManager.processFrontMatter(t,n=>{Object.assign(n,r)}),await yr(this.app,t)}};tf.DEFAULT_CACHE_TTL=300*1e3,tf.sharedIndexManager=null;Qi=tf});var Yc,CS,mce=L(()=>{Yc=require("obsidian");Rf();rf();wt();ci();ls();ga();CS=class e extends Qi{constructor(r,n,o={}){let a=r,i=n;super(r,{folder:e.getFolderPath(n),extension:".md",cacheTTL:300*1e3,persistCache:!0,namespace:o.namespace||"trade",enableIndexing:!0,indexes:[{name:"trades",fields:["instrument","direction","pnl","entryTime","exitTime","account","setup","mistake","tags","assetType"],includeNested:!1,fileFilter:s=>{var c;if(!s.path.endsWith(".md"))return!1;let l=(c=a.metadataCache.getFileCache(s))==null?void 0:c.frontmatter;return l!=null&&l.isMissedTrade?!1:(l==null?void 0:l.type)==="trade"||(l==null?void 0:l.type)==="backtest-trade"?!0:s.path.includes("/trades/")&&i.isJournalPath(s.path)}},{name:"trade-unique-values",fields:["instrument","account","setup","mistake","tags"],includeNested:!1,valueExtractor:(s,l)=>Array.isArray(s[l])?s[l]:typeof s[l]=="string"?s[l].split(",").map(c=>c.trim()).filter(Boolean):s[l],fileFilter:s=>{var c;if(!s.path.endsWith(".md"))return!1;let l=(c=a.metadataCache.getFileCache(s))==null?void 0:c.frontmatter;return l!=null&&l.isMissedTrade?!1:(l==null?void 0:l.type)==="trade"||(l==null?void 0:l.type)==="backtest-trade"?!0:s.path.includes("/trades/")&&i.isJournalPath(s.path)}}]});this.tradesFolder="trades";this.folderPathService=n}static getFolderPath(r){return r.journalFolderPath}async updateTrade(r,n,o){var a,i,s,l,c,d,u,p,m,f,g,v;try{if(!r.entryTime)throw new Error("Entry time is required");if(!r.direction&&r.assetType!=="options")throw new Error("Direction is required");let h=Pt({tradeStatus:r.tradeStatus,exitTime:r.exitTime,pnl:null,useDirectPnLInput:r.useDirectPnLInput,exits:r.exits,entries:r.entries});if(!h&&!r.exitTime)throw new Error("Exit time is required for closed trades");if(r.useDirectPnLInput)r.entryPrice===void 0&&(r.entryPrice=0),r.positionSize===void 0&&(r.positionSize=0),!h&&r.exitPrice===void 0&&(r.exitPrice=0);else{if(r.entryPrice===void 0)throw new Error("Entry price is required");if(r.positionSize===void 0)throw new Error("Position size is required");if(!h&&r.exitPrice===void 0)throw new Error("Exit price is required for closed trades")}if(!(r.accountIds&&r.accountIds.length>0||r.account&&r.account.length>0))throw new Error("At least one account is required");if(!await this.app.vault.adapter.exists(n))throw new Error(`Trade file does not exist: ${n}`);let x=this.app.vault.getAbstractFileByPath(n);if(!x||!(x instanceof Yc.TFile))throw new Error(`Invalid file path: ${n}`);let w,S=!0;try{let O=this.app.vault.getAbstractFileByPath(n);if(O&&O instanceof Yc.TFile){let z=(a=this.app.metadataCache.getFileCache(O))==null?void 0:a.frontmatter;z&&r.originalPnl!==void 0&&(S=z.entryPrice!==r.entryPrice||z.exitPrice!==r.exitPrice||z.positionSize!==r.positionSize||z.direction!==r.direction||z.commission!==r.commission||z.commissionType!==r.commissionType||z.fees!==r.fees||z.swap!==r.swap||z.directPnL!==r.directPnL||this.hasTradeStatusChanged(z,r)||z.contractSize!==r.contractSize||z.dollarPerPoint!==r.dollarPerPoint||z.tickSize!==r.tickSize||z.tickValue!==r.tickValue||z.lotSize!==r.lotSize||z.pipValue!==r.pipValue||z.leverageRatio!==r.leverageRatio||JSON.stringify(z.entries)!==JSON.stringify(r.entries)||JSON.stringify(z.exits)!==JSON.stringify(r.exits))}}catch(O){console.warn("Could not compare with existing data, will recalculate PNL:",O)}if(h?w=null:!S&&r.originalPnl!==void 0?w=r.originalPnl:r.useDirectPnLInput&&r.directPnL!==void 0?w=Wf(r):w=Wf(r),r.riskAmount===void 0&&r.stopLoss===void 0&&this.plugin){let O=this.plugin.settings.trade.defaultRiskAmount;O&&O>0&&(r.riskAmount=O)}let k=eO(r),T={type:"trade",entryTime:this.formatDateForFrontmatter(r.entryTime),entryPrice:r.entryPrice,positionSize:r.positionSize,direction:r.direction,tradeStatus:h?"OPEN":"CLOSED"};if(!h&&r.exitTime&&(T.exitTime=this.formatDateForFrontmatter(r.exitTime)),!h&&r.exitPrice!==void 0&&(T.exitPrice=r.exitPrice),!h&&w!==null&&(T.pnl=w),k!==null&&(T.rMultiple=k),(i=r.entries)!=null&&i.length){let O=r.entries.filter(z=>z&&z.time!==void 0&&z.price!==void 0&&z.size!==void 0&&z.size>0);T.entries=O.map(z=>({time:this.formatDateForFrontmatter(z.time),price:z.price,size:z.size}))}if((s=r.exits)!=null&&s.length){let O=r.exits.filter(z=>z&&z.time!==void 0&&z.price!==void 0&&z.size!==void 0&&z.size>0);T.exits=O.map(z=>({time:this.formatDateForFrontmatter(z.time),price:z.price,size:z.size}))}if(r.commission!==void 0&&(T.commission=r.commission),r.commissionType!==void 0&&(T.commissionType=r.commissionType),r.fees!==void 0&&(T.fees=r.fees),r.swap!==void 0&&(T.swap=r.swap),r.rebate!==void 0&&(T.rebate=r.rebate),r.riskAmount!==void 0&&(T.riskAmount=r.riskAmount),r.stopLoss!==void 0&&(T.stopLoss=r.stopLoss),(l=r.setupIds)!=null&&l.length&&(T.setupIds=r.setupIds),(c=r.mistakeIds)!=null&&c.length&&(T.mistakeIds=r.mistakeIds),(d=r.accountIds)!=null&&d.length&&(T.accountIds=r.accountIds),r.accountId&&(T.accountId=r.accountId),r.instrument&&(T.instrument=r.instrument),r.assetType&&(T.assetType=r.assetType),(u=r.setup)!=null&&u.length&&(T.setup=r.setup),(p=r.mistake)!=null&&p.length&&(T.mistake=r.mistake),(m=r.account)!=null&&m.length&&(T.account=r.account),r.images!==void 0&&(T.images=r.images.length>0?r.images.map(O=>O.trim()):[]),r.customTags&&Array.isArray(r.customTags)&&r.customTags.length>0?T.tags=r.customTags.map(O=>String(O).trim()).filter(O=>O.length>0):T.tags=[],T.thesis=this.formatThesisForYAML(r.thesis||""),r.assetType==="stock"?r.exchange&&(T.exchange=r.exchange):r.assetType==="options"?(r.expirationDate&&(T.expirationDate=this.formatDateForFrontmatter(r.expirationDate)),r.strikePrice!==void 0&&(T.strikePrice=r.strikePrice),r.optionType&&(T.optionType=r.optionType),r.contractSize!==void 0&&(T.contractSize=r.contractSize)):r.assetType==="futures"?(r.dollarPerPoint!==void 0&&(T.dollarPerPoint=r.dollarPerPoint),r.tickSize!==void 0&&(T.tickSize=r.tickSize),r.tickValue!==void 0&&(T.tickValue=r.tickValue)):r.assetType==="forex"?(r.lotSize!==void 0&&(T.lotSize=r.lotSize),r.pipValue!==void 0&&(T.pipValue=r.pipValue)):r.assetType==="crypto"?r.cryptoExchange&&(T.cryptoExchange=r.cryptoExchange):r.assetType==="cfd"&&r.leverageRatio!==void 0&&(T.leverageRatio=r.leverageRatio),r.lossReview&&(T.lossReview=r.lossReview),r.reviewed!==void 0&&(T.reviewed=r.reviewed),r.reviewedAt&&(T.reviewedAt=r.reviewedAt),r.useDirectPnLInput!==void 0&&(T.useDirectPnLInput=r.useDirectPnLInput),r.directPnL!==void 0&&(T.directPnL=r.directPnL),r.customFields)try{let O=(f=this.plugin)==null?void 0:f.customFieldsService;if(O){let z=O.getFields();Object.entries(r.customFields).forEach(([I,A])=>{if(A!=null&&A!==""){let j=z.find(E=>E.id===I);j&&j.fieldKey?T.hasOwnProperty(j.fieldKey)||(T[j.fieldKey]=A):T.hasOwnProperty(I)||(T[I]=A)}})}else Object.entries(r.customFields).forEach(([z,I])=>{I!=null&&I!==""&&(T.hasOwnProperty(z)||(T[z]=I))})}catch(O){console.error("Error mapping custom field IDs to keys:",O),Object.entries(r.customFields).forEach(([z,I])=>{I!=null&&I!==""&&(T.hasOwnProperty(z)||(T[z]=I))})}await this.updateFrontmatter(x,T),this.app.metadataCache.trigger("changed",x);let P=w,D=0;try{let O=this.app.vault.getAbstractFileByPath(n);if(O&&O instanceof Yc.TFile){let z=(g=this.app.metadataCache.getFileCache(O))==null?void 0:g.frontmatter;z&&z.pnl!==void 0&&(D=parseFloat(z.pnl))}}catch(O){console.warn("Could not determine old PnL, using 0:",O)}o!=="user-input"&&setTimeout(()=>{let O=new CustomEvent("journalit:trade-data-changed",{detail:{action:"updated",filePath:n,timestamp:Date.now()}});document.dispatchEvent(O)},100),await this.clearCacheWithPrefix("trade:");try{if(r.entryTime&&((v=this.plugin)!=null&&v.drcService)){let O=new Date(r.entryTime);await this.plugin.drcService.updateDRCBacklinks(O)}}catch(O){console.error("Failed to update DRC backlinks after trade update:",O)}return n}catch(h){throw console.error("Error updating trade:",h),h}}get TRADES_FOLDER(){return this.tradesFolder}get JOURNALIT_FOLDER(){return this.folderPathService.journalFolderPath}async getUniqueInstruments(){if(this.isIndexingEnabled()){let o=this.getUniqueIndexValues("trade-unique-values","instrument");if(o.length>0)return o.filter(Boolean)}let n=(await this.getAllTrades()).map(o=>this.getTradeValue(o,"instrument")).filter(Boolean);return Array.from(new Set(n))}async getUniqueAccounts(){if(this.isIndexingEnabled()){let o=this.getUniqueIndexValues("trade-unique-values","account");if(o.length>0)return o.filter(Boolean)}let n=(await this.getAllTrades()).flatMap(o=>this.getTradeArrayValue(o,"account")).filter(Boolean);return Array.from(new Set(n))}getAccountService(){return null}getAccountPageService(){var r;return(r=this.plugin)==null?void 0:r.accountPageService}async getUniqueSetups(){if(this.isIndexingEnabled()){let o=this.getUniqueIndexValues("trade-unique-values","setup");if(o.length>0)return o.filter(Boolean)}let n=(await this.getAllTrades()).flatMap(o=>this.getTradeArrayValue(o,"setup")).filter(Boolean);return Array.from(new Set(n))}async getUniqueMistakes(){if(this.isIndexingEnabled()){let o=this.getUniqueIndexValues("trade-unique-values","mistake");if(o.length>0)return o.filter(Boolean)}let n=(await this.getAllTrades()).flatMap(o=>this.getTradeArrayValue(o,"mistake")).filter(Boolean);return Array.from(new Set(n))}formatThesisForYAML(r){if(!r||r.trim()==="")return'""';let n=r.trim();return n.includes(`
`)?`|
    ${n.replace(/\n/g,`
    `)}`:/[:|>[\]{}*&!%@`]/.test(n)||n.startsWith('"')||n.startsWith("'")||n.endsWith('"')||n.endsWith("'")||n.match(/^\s/)||n.match(/\s$/)?`"${n.replace(/"/g,'\\"')}"`:n}hasTradeStatusChanged(r,n){let o=this.determineLogicalTradeStatus(r),a=this.determineLogicalTradeStatus(n);return o!==a}determineLogicalTradeStatus(r){if(r.tradeStatus==="OPEN"||r.tradeStatus==="CLOSED")return r.tradeStatus;let n=r.exitTime!==void 0&&r.exitTime!==null,o=r.exitPrice!==void 0&&r.exitPrice!==null&&r.exitPrice>0,a=r.exits&&Array.isArray(r.exits)&&r.exits.length>0;return n&&o||a?"CLOSED":"OPEN"}async getUniqueTags(){if(this.isIndexingEnabled()){let o=this.getUniqueIndexValues("trade-unique-values","tags");if(o.length>0)return o.filter(Boolean)}let n=(await this.getAllTrades()).flatMap(o=>this.getTradeArrayValue(o,"tags")).filter(Boolean);return Array.from(new Set(n))}async getUniqueCustomTags(){let r=await this.getAllTrades(),n=[];for(let o of r)o.tags&&Array.isArray(o.tags)&&n.push(...o.tags);return Array.from(new Set(n.map(o=>String(o).trim()).filter(o=>o.length>0)))}async getTradeData(r){let n=this.app.vault.getFiles().filter(i=>i.path.endsWith(".md")),o=await this.getAllTrades(n,{useIndexes:!(r!=null&&r.fresh)});return await this.resolveTradePathsAsync(o,n)}async resolveTradePathsAsync(r,n){var c;if(r.filter(d=>d.path&&d.path.trim()!=="").length===r.length)return r;let a=n||this.app.vault.getFiles().filter(d=>d.path.endsWith(".md")),i=new Map;for(let d of a){let u=(c=this.app.metadataCache.getFileCache(d))==null?void 0:c.frontmatter;if(((u==null?void 0:u.type)==="trade"||(u==null?void 0:u.type)==="backtest-trade")&&u.instrument&&u.entryTime){let p=`${u.instrument}-${u.entryTime}-${u.direction||""}`;i.set(p,d)}}let s=100,l=[];for(let d=0;d<r.length;d+=s){let p=r.slice(d,d+s).map(m=>{if(m.path&&m.path.trim()!=="")return m;let f;if(m.instrument&&m.entryTime){let g=`${m.instrument}-${m.entryTime}-${m.direction||""}`;f=i.get(g)}return{...m,path:(f==null?void 0:f.path)||this.generateUniqueTradePath(m)}});l.push(...p),d+s<r.length&&await new Promise(m=>setTimeout(m,0))}return l}generateUniqueTradePath(r){var f;let n=r.entryTime instanceof Date?r.entryTime:new Date,o=n.getFullYear(),a=String(n.getMonth()+1).padStart(2,"0"),i=this.getWeekOfMonth(n),s=r.instrument?this.sanitizeTickerForFilename(r.instrument):"UNKNOWN",l=((f=this.plugin)==null?void 0:f.settings.trade.dateFormat)||"DDMMYY",c=String(n.getDate()).padStart(2,"0"),d="";l==="DDMMYY"?d=`${c}${a}${String(o).slice(2)}`:l==="MMDDYY"?d=`${a}${c}${String(o).slice(2)}`:l==="YYMMDD"?d=`${String(o).slice(2)}${a}${c}`:d=`${c}${a}${String(o).slice(2)}`;let u=Math.random().toString(36).substring(2,8),p=`${s}-${d}-T${u}.md`;return this.folderPathService.getPath(String(o),a,String(i),this.tradesFolder,p)}async readFrontmatter(r){return super.readFrontmatter(r)}getApp(){return this.app}async getAllTrades(r,n){let o="trade:all-trades";try{let a=await this.query(async()=>{let s=await this.getTradeFiles(r);if(s.length===0)return[];let l=10,c=[];for(let d=0;d<s.length;d+=l){let u=s.slice(d,d+l),p=await Promise.all(u.map(async m=>{try{return{...await this.readFrontmatter(m),path:m.path}}catch(f){return console.error(`Error processing trade file ${m.path}:`,f),{path:m.path}}}));c.push(...p),d+l<s.length&&await new Promise(m=>setTimeout(m,5))}return c},o,{offlineCapable:!0,useIndexes:(n==null?void 0:n.useIndexes)!==void 0?n.useIndexes:!0,useCache:(n==null?void 0:n.useIndexes)!==!1},{indexName:"trades",filters:{}});return Array.isArray(a)?a:[]}catch(a){return console.error("Error in getAllTrades:",a),[]}}getTradeValue(r,n){return r&&r[n]?String(r[n]):null}getTradeArrayValue(r,n){return!r||!r[n]?[]:Array.isArray(r[n])?r[n].map(String):String(r[n]).split(",").map(o=>o.trim()).filter(Boolean)}addRecentlyCreatedFile(r){this.recentlyCreatedFiles||(this.recentlyCreatedFiles=new Set),this.recentlyCreatedFiles.add(r),setTimeout(()=>{var n;(n=this.recentlyCreatedFiles)==null||n.delete(r)},1e4)}setPlugin(r){super.setPlugin(r),r.registerEvent(r.app.vault.on("delete",async n=>{if(n.path.includes("/trades/")&&n.path.endsWith(".md")){let o=(0,Yc.normalizePath)(n.path);await this.handleTradeDeletion(o)}}))}async createTrade(r,n){var o,a,i,s,l,c,d,u;try{if(!r.entryTime)throw new Error("Entry time is required");if(!r.direction&&r.assetType!=="options")throw new Error("Direction is required");let p=Pt({tradeStatus:r.tradeStatus,exitTime:r.exitTime,pnl:null,useDirectPnLInput:r.useDirectPnLInput,exits:r.exits,entries:r.entries});if(!p&&!r.exitTime)throw new Error("Exit time is required for closed trades");if(r.useDirectPnLInput)r.entryPrice===void 0&&(r.entryPrice=0),r.positionSize===void 0&&(r.positionSize=0),!p&&r.exitPrice===void 0&&(r.exitPrice=0);else{if(r.entryPrice===void 0)throw new Error("Entry price is required");if(r.positionSize===void 0)throw new Error("Position size is required");if(!p&&r.exitPrice===void 0)throw new Error("Exit price is required for closed trades")}if(!(r.accountIds&&r.accountIds.length>0||r.account&&r.account.length>0))throw new Error("At least one account is required");let f=this.getTargetFolderPath(r.entryTime);try{await this.app.vault.adapter.mkdir(f)}catch(x){}let g=await this.getTradeFilePath(r),v=await this.listFilesInFolder(f);if(await this.app.vault.adapter.exists(g))throw console.error(`Cannot create trade - File already exists at path: ${g}`),console.error(`Existing files in folder: ${JSON.stringify(v)}`),new Error(`File already exists: ${g}`);let y=this.generateTradeContent(r);this.recentlyCreatedFiles||(this.recentlyCreatedFiles=new Set),this.recentlyCreatedFiles.add(g),setTimeout(()=>{var x;(x=this.recentlyCreatedFiles)==null||x.delete(g)},1e4);let b=await this.app.vault.create(g,y);if(this.app.metadataCache.trigger("resolve",b),setTimeout(async()=>{let x=new CustomEvent("journalit:trade-data-changed",{detail:{action:"created",filePath:g,timestamp:Date.now()}});document.dispatchEvent(x)},500),await this.clearCacheWithPrefix("trade:"),(o=this.plugin)!=null&&o.settings.trade.autoOpenCreatedTrades&&!(n!=null&&n.suppressAutoOpen)){(a=this.plugin)!=null&&a.processorManager&&await this.plugin.processorManager.getTradeNoteProcessor();try{await this.plugin.openFile(g,!0),setTimeout(()=>{var x,w;(w=(x=this.plugin)==null?void 0:x.tradeNoteProcessor)==null||w.renderActiveComponent()},50)}catch(x){console.warn("Failed to auto-open created trade:",x)}}if((i=this.plugin)!=null&&i.settings.drc.autoCreateOnFirstTrade)try{let x=new Date(r.entryTime);if(this.plugin.drcService){let w=this.plugin.drcService.getDRCNotePath(x);await this.app.vault.adapter.exists(w)||await this.plugin.drcService.createDRC(x),await this.plugin.drcService.updateDRCBacklinks(x)}}catch(x){console.error("Failed to auto-create DRC for trade:",x)}else try{let x=new Date(r.entryTime);(s=this.plugin)!=null&&s.drcService&&await this.plugin.drcService.updateDRCBacklinks(x)}catch(x){console.error("Failed to update DRC backlinks:",x)}if((c=(l=this.plugin)==null?void 0:l.settings.weekly)!=null&&c.autoCreateOnFirstTrade)try{let x=new Date(r.entryTime);if(this.plugin.weeklyReviewService){let w=this.plugin.weeklyReviewService.getWeeklyReviewPath(x);await this.app.vault.adapter.exists(w)||await this.plugin.weeklyReviewService.createWeeklyReview(x)}}catch(x){console.error("Failed to auto-create Weekly Review for trade:",x)}if((u=(d=this.plugin)==null?void 0:d.settings.monthly)!=null&&u.autoCreateOnFirstTrade)try{let x=new Date(r.entryTime);if(this.plugin.monthlyReviewService){let w=this.plugin.monthlyReviewService.getMonthlyReviewPath(x);await this.app.vault.adapter.exists(w)||await this.plugin.monthlyReviewService.createMonthlyReview(x)}}catch(x){console.error("Failed to auto-create Monthly Review for trade:",x)}return g}catch(p){throw console.error("Error creating trade:",p),p}}async getTrades(r,n){var d,u;await new Promise(p=>setTimeout(p,50));let o=lr(r,this.plugin),a=lr(n,this.plugin);a.setHours(23,59,59,999);let i=[];if(this.recentlyCreatedFiles&&this.recentlyCreatedFiles.size>0)for(let p of this.recentlyCreatedFiles){let m=this.app.vault.getAbstractFileByPath(p);if(m instanceof Yc.TFile){let f=(d=this.app.metadataCache.getFileCache(m))==null?void 0:d.frontmatter;if((f==null?void 0:f.type)==="trade"&&(f!=null&&f.entryTime)){let g=new Date(f.entryTime),v=lr(g,this.plugin);v>=o&&v<=a&&i.push(m)}}}if(this.isIndexingEnabled()&&this.indexManager)try{let m=this.queryIndex("trades",{},{}).filter(f=>{try{let g=f.values.entryTime;if(!g)return!1;let v=new Date(g),h=lr(v,this.plugin);return h>=o&&h<=a}catch(g){return!1}});if(m.length>0){let g=[...m.map(v=>v.file)];for(let v of i)g.find(h=>h.path===v.path)||g.push(v);return g}if(i.length>0)return i}catch(p){console.warn("Error using index for date range query:",p)}let l=this.app.vault.getMarkdownFiles().filter(p=>(p.path.startsWith(this.folderPathService.journalFolderPath)&&p.path.includes(`/${this.tradesFolder}/`)||p.path.startsWith(this.tradesFolder))&&p.path.endsWith(".md"));for(let p of i)l.find(m=>m.path===p.path)||l.push(p);let c=[];for(let p of l)try{let m=(u=this.app.metadataCache.getFileCache(p))==null?void 0:u.frontmatter;if(!m||m.type!=="trade"&&m.type!=="backtest-trade")continue;if(m.entryTime){let f=new Date(m.entryTime),g=lr(f,this.plugin);g>=o&&g<=a&&c.push(p)}}catch(m){console.warn(`Error checking trade file ${p.path}:`,m)}return c}async readTradeContent(r){return this.app.vault.read(r)}async extractTradeData(r){var n;try{let o=(n=this.app.metadataCache.getFileCache(r))==null?void 0:n.frontmatter;if(!o||o.type!=="trade"&&o.type!=="backtest-trade")return null;let a=Pt({tradeStatus:o.tradeStatus,exitTime:o.exitTime,pnl:o.pnl,useDirectPnLInput:o.useDirectPnLInput,exits:o.exits,entries:o.entries});return{path:r.path,instrument:o.instrument||"Unknown",direction:o.direction||(o.assetType==="options"&&o.optionType?o.optionType:"Unknown"),tradeStatus:o.tradeStatus||(a?"OPEN":"CLOSED"),entryPrice:parseFloat(o.entryPrice)||0,exitPrice:a?null:parseFloat(o.exitPrice)||0,positionSize:parseFloat(o.positionSize)||0,pnl:a?null:parseFloat(o.pnl)||0,commission:parseFloat(o.commission)||0,swap:parseFloat(o.swap)||0,fees:parseFloat(o.fees)||0,rebate:o.rebate!=null&&o.rebate!==""?parseFloat(o.rebate):void 0,riskAmount:o.riskAmount!=null&&o.riskAmount!==""?parseFloat(o.riskAmount):void 0,stopLoss:o.stopLoss!=null&&o.stopLoss!==""?parseFloat(o.stopLoss):void 0,entryTime:o.entryTime?new Date(o.entryTime):new Date,exitTime:a?null:o.exitTime?new Date(o.exitTime):new Date(o.entryTime||new Date),entries:o.entries&&Array.isArray(o.entries)?o.entries.map(i=>({time:i.time?new Date(i.time):null,price:parseFloat(i.price)||0,size:parseFloat(i.size)||0})):[],exits:o.exits&&Array.isArray(o.exits)?o.exits.map(i=>({time:i.time?new Date(i.time):null,price:parseFloat(i.price)||0,size:parseFloat(i.size)||0})):[],setup:Array.isArray(o.setup)?o.setup.filter(i=>typeof i=="string"&&!i.includes("/")).map(i=>i.trim()):[],mistake:Array.isArray(o.mistake)?o.mistake.filter(i=>typeof i=="string"&&!i.includes("/")).map(i=>i.trim()):[],account:o.account,accountIds:o.accountIds,accountId:o.accountId,thesis:o.thesis,images:o.images&&Array.isArray(o.images)?o.images:[],tags:o.tags,assetType:o.assetType,optionType:o.optionType,reviewed:o.reviewed||!1,reviewedAt:o.reviewedAt}}catch(o){return console.error(`Error extracting trade data from ${r.path}:`,o),null}}async updateLossReview(r,n,o="unknown"){try{let a=this.app.vault.getAbstractFileByPath(r);if(!a||!(a instanceof Yc.TFile))throw new Error(`Invalid file path: ${r}`);if(await this.app.fileManager.processFrontMatter(a,i=>{i.lossReview=n}),await yr(this.app,a),o!=="user-input"){let i=new CustomEvent("journalit:trade-data-changed",{detail:{action:"loss-review-updated",filePath:r,timestamp:Date.now()}});document.dispatchEvent(i)}}catch(a){throw console.error(`[TradeService] Error updating loss review for ${r}:`,a),a}}async updateTradeReviewStatus(r,n,o,a="unknown"){try{let i=this.app.vault.getAbstractFileByPath(r);if(!i||!(i instanceof Yc.TFile))throw new Error(`Invalid file path: ${r}`);await this.app.fileManager.processFrontMatter(i,l=>{l.reviewed=n,l.reviewedAt=o}),await yr(this.app,i);let s=new CustomEvent("journalit:trade-data-changed",{detail:{action:"review-status-updated",filePath:r,timestamp:Date.now()}});document.dispatchEvent(s)}catch(i){throw console.error(`[TradeService] Error updating review status for ${r}:`,i),i}}async getTradeFiles(r){let n=r||this.app.vault.getFiles().filter(s=>s.path.endsWith(".md"));return(await Promise.all(n.map(async s=>{try{let l=await this.app.vault.adapter.exists(s.path);return{file:s,exists:l}}catch(l){return console.warn(`Error checking file existence for ${s.path}:`,l),{file:s,exists:!1}}}))).filter(({exists:s})=>s).map(({file:s})=>s).filter(s=>{var d;if(!this.folderPathService.isJournalPath(s.path))return!1;let l=(d=this.app.metadataCache.getFileCache(s))==null?void 0:d.frontmatter;return l?l!=null&&l.isMissedTrade?!1:!!((l==null?void 0:l.type)==="trade"||(l==null?void 0:l.type)==="backtest-trade"||s.path.includes(`/${this.tradesFolder}/`)):!!s.path.includes(`/${this.tradesFolder}/`)})}sanitizeTickerForFilename(r){if(!r)return"UNKNOWN";let n=r.trim().toUpperCase();if(n=n.replace(/[\\\/:\*\?"<>|\+]/g,"").replace(/[\s.\[\]\(\)\{\}#%&=;]/g,"-").replace(/--+/g,"-").replace(/^-|-$/g,""),!n)return"UNKNOWN";let o=20;return n.length>o&&(n=n.substring(0,o)),n}getWeekOfMonth(r){return ss(r)}async getTradePathComponents(r){var l;let n=r.getFullYear().toString(),o=String(r.getMonth()+1).padStart(2,"0"),a=this.getWeekOfMonth(r),i=((l=this.plugin)==null?void 0:l.settings.trade.dateFormat)||"DDMMYY",s=this.formatDateForFilename(r,i);return{year:n,month:o,weekOfMonth:a,formattedDate:s}}async getTradeFilePath(r){var f;let n=r.entryTime,o=n.getFullYear(),a=String(n.getMonth()+1).padStart(2,"0"),i=String(n.getDate()).padStart(2,"0"),s=this.getWeekOfMonth(n),l=r.instrument?this.sanitizeTickerForFilename(r.instrument):"UNKNOWN",c=((f=this.plugin)==null?void 0:f.settings.trade.dateFormat)||"DDMMYY",d="";c==="DDMMYY"?d=`${i}${a}${String(o).slice(2)}`:c==="MMDDYY"?d=`${a}${i}${String(o).slice(2)}`:c==="YYMMDD"?d=`${String(o).slice(2)}${a}${i}`:d=`${i}${a}${String(o).slice(2)}`;let u=await this.getTradeNumberForDay(l,n),p=`${l}-${d}-T${u}.md`;return this.folderPathService.getPath(String(o),a,String(s),this.tradesFolder,p)}async getTradeNumberForDay(r,n){var p;let o=this.getTargetFolderPath(n),a=await this.listFilesInFolder(o),i=((p=this.plugin)==null?void 0:p.settings.trade.dateFormat)||"DDMMYY",s=this.formatDateForFilename(n,i),l=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),c=new RegExp(`^${l}-${s}-T(\\d+)\\.md$`),d=0;for(let m of a){let f=m.split("/").pop()||"",g=c.exec(f);if(g){let v=parseInt(g[1],10);d=Math.max(d,v)}}return d+1}async listFilesInFolder(r){try{if(!await this.app.vault.adapter.exists(r))try{return await this.app.vault.adapter.mkdir(r),[]}catch(a){return console.warn(`Error creating folder ${r}:`,a),[]}return(await this.app.vault.adapter.list(r)).files||[]}catch(n){return console.warn(`Error listing files in folder ${r}:`,n),[]}}getTargetFolderPath(r){let n=r.getFullYear(),o=String(r.getMonth()+1).padStart(2,"0"),a=this.getWeekOfMonth(r);return this.folderPathService.getPath(String(n),o,String(a),this.tradesFolder)}async deleteImage(r){try{let n=(0,Yc.normalizePath)(r);return await this.app.vault.adapter.exists(n)?(await this.app.vault.adapter.remove(n),!0):!1}catch(n){return n.code==="ENOENT"||console.error(`Failed to delete image ${r}:`,n),!1}}async deleteEmptyFolder(r){try{let n=(0,Yc.normalizePath)(r);if(!await this.app.vault.adapter.exists(n))return!1;let{files:a=[],folders:i=[]}=await this.app.vault.adapter.list(n);return a.length===0&&i.length===0?(await this.app.vault.adapter.rmdir(n,!1),!0):!1}catch(n){return n.code==="ENOENT"||console.error(`Failed to delete folder ${r}:`,n),!1}}formatDateForFilename(r,n){let o=String(r.getDate()).padStart(2,"0"),a=String(r.getMonth()+1).padStart(2,"0"),i=String(r.getFullYear()).slice(2);switch(n){case"DDMMYY":return`${o}${a}${i}`;case"MMDDYY":return`${a}${o}${i}`;case"YYMMDD":return`${i}${a}${o}`;default:return`${o}${a}${i}`}}formatDateForFrontmatter(r){try{let n=r instanceof Date?r:new Date(r);if(isNaN(n.getTime()))return console.error(`Invalid date value: ${r}, returning as-is`),String(r);let o=n.getFullYear(),a=String(n.getMonth()+1).padStart(2,"0"),i=String(n.getDate()).padStart(2,"0"),s=String(n.getHours()).padStart(2,"0"),l=String(n.getMinutes()).padStart(2,"0"),c=String(n.getSeconds()).padStart(2,"0");return`${o}-${a}-${i}T${s}:${l}:${c}`}catch(n){return console.error(`Error formatting date: ${r}`,n),r instanceof Date?r.toISOString():String(r)}}buildFrontmatterObject(r,n,o,a){var s,l,c,d,u,p,m,f,g;let i={type:"trade",entryTime:this.formatDateForFrontmatter(r.entryTime),entryPrice:r.entryPrice,positionSize:r.positionSize,tradeStatus:a?"OPEN":"CLOSED"};if(r.direction&&(i.direction=r.direction),a||(r.exitTime&&(i.exitTime=this.formatDateForFrontmatter(r.exitTime)),r.exitPrice!==void 0&&(i.exitPrice=r.exitPrice),n!==null&&(i.pnl=n)),o!==null&&(i.rMultiple=o),(s=r.entries)!=null&&s.length&&(i.entries=r.entries.filter(v=>v&&v.time&&v.price!==void 0&&v.size!==void 0&&v.size>0).map(v=>({time:this.formatDateForFrontmatter(v.time),price:v.price,size:v.size}))),(l=r.exits)!=null&&l.length&&(i.exits=r.exits.filter(v=>v&&v.time&&v.price!==void 0&&v.size!==void 0&&v.size>0).map(v=>({time:this.formatDateForFrontmatter(v.time),price:v.price,size:v.size}))),r.commission!==void 0&&(i.commission=r.commission),r.commissionType!==void 0&&(i.commissionType=r.commissionType),r.swap!==void 0&&(i.swap=r.swap),r.fees!==void 0&&(i.fees=r.fees),r.rebate!==void 0&&(i.rebate=r.rebate),r.riskAmount!==void 0&&(i.riskAmount=r.riskAmount),r.stopLoss!==void 0&&(i.stopLoss=r.stopLoss),(c=r.setupIds)!=null&&c.length&&(i.setupIds=r.setupIds),(d=r.mistakeIds)!=null&&d.length&&(i.mistakeIds=r.mistakeIds),(u=r.accountIds)!=null&&u.length&&(i.accountIds=r.accountIds),r.accountId&&(i.accountId=r.accountId),r.instrument&&(i.instrument=r.instrument),r.assetType&&(i.assetType=r.assetType),(p=r.setup)!=null&&p.length&&(i.setup=r.setup),(m=r.mistake)!=null&&m.length&&(i.mistake=r.mistake),(f=r.account)!=null&&f.length&&(i.account=r.account),r.images!==void 0&&(i.images=r.images.length>0?r.images.map(v=>v.trim()):[]),r.customTags&&Array.isArray(r.customTags)&&r.customTags.length>0?i.tags=r.customTags.map(v=>String(v).trim()).filter(v=>v.length>0):i.tags=[],i.thesis=this.formatThesisForYAML(r.thesis||""),r.assetType==="stock"&&r.exchange&&(i.exchange=r.exchange),r.assetType==="options"&&(r.expirationDate&&(i.expirationDate=this.formatDateForFrontmatter(r.expirationDate)),r.strikePrice!==void 0&&(i.strikePrice=r.strikePrice),r.optionType&&(i.optionType=r.optionType),r.contractSize!==void 0&&(i.contractSize=r.contractSize)),r.assetType==="futures"&&(r.dollarPerPoint!==void 0&&(i.dollarPerPoint=r.dollarPerPoint),r.tickSize!==void 0&&(i.tickSize=r.tickSize),r.tickValue!==void 0&&(i.tickValue=r.tickValue)),r.assetType==="forex"&&(r.lotSize!==void 0&&(i.lotSize=r.lotSize),r.pipValue!==void 0&&(i.pipValue=r.pipValue)),r.assetType==="crypto"&&r.cryptoExchange&&(i.cryptoExchange=r.cryptoExchange),r.assetType==="cfd"&&r.leverageRatio!==void 0&&(i.leverageRatio=r.leverageRatio),r.useDirectPnLInput!==void 0&&(i.useDirectPnLInput=r.useDirectPnLInput),r.directPnL!==void 0&&(i.directPnL=r.directPnL),r.customFields)try{let v=(g=this.plugin)==null?void 0:g.customFieldsService;if(v){let h=v.getFields(),y=new Set;Object.entries(r.customFields).forEach(([b,x])=>{if(x!=null&&x!==""){let w=h.find(k=>k.id===b),S=w&&w.fieldKey?w.fieldKey:b;if(i.hasOwnProperty(S)||y.has(S))return;y.add(S),i[S]=x}})}}catch(v){console.error("Error processing custom fields:",v)}return i}serializeFrontmatter(r){let n=["---"];for(let[o,a]of Object.entries(r))a!=null&&(Array.isArray(a)?a.length===0?n.push(`${o}: []`):typeof a[0]=="object"?o==="entries"||o==="exits"?(n.push(`${o}:`),a.forEach(i=>{n.push(`  - time: ${i.time}`),n.push(`    price: ${i.price}`),n.push(`    size: ${i.size}`)})):(n.push(`${o}:`),a.forEach(i=>{n.push(`  - ${JSON.stringify(i)}`)})):(n.push(`${o}:`),a.forEach(i=>{let s=typeof i=="string"?i:String(i);n.push(`  - ${s}`)})):typeof a=="string"&&a.includes(`
`)?n.push(`${o}: ${a}`):n.push(`${o}: ${a}`));return n.push("---"),n.join(`
`)}generateTradeContent(r){let n=Wf(r);if(r.riskAmount===void 0&&r.stopLoss===void 0&&this.plugin){let d=this.plugin.settings.trade.defaultRiskAmount;d&&d>0&&(r.riskAmount=d)}let o=eO(r),a=Pt({tradeStatus:r.tradeStatus,exitTime:r.exitTime,pnl:n,useDirectPnLInput:r.useDirectPnLInput,exits:r.exits,entries:r.entries}),i=a?null:n,s=this.buildFrontmatterObject(r,i,o,a);return[this.serializeFrontmatter(s),"","# Trade Notes","",r.notes||"<!-- Add your trade notes here -->"].join(`
`)}extractDateFromTradePath(r){try{let n=r.match(/([A-Z]+)-(\d{6,8})-[TMB]\d+\.md$/);if(!n)return null;let o=n[2];if(o.length===8){let a=parseInt(o.substring(0,4)),i=parseInt(o.substring(4,6))-1,s=parseInt(o.substring(6,8));return new Date(a,i,s)}else if(o.length===6){let a=parseInt(o.substring(0,2)),i=parseInt(o.substring(2,4))-1,s=2e3+parseInt(o.substring(4,6));return new Date(s,i,a)}return null}catch(n){return console.error("Error extracting date from trade path:",n),null}}async handleTradeDeletion(r){var n;try{await this.clearCache();try{let o=this.app.vault.adapter;if(o&&o.list){let a=this.folderPathService.journalFolderPath;try{await o.list(a)}catch(i){}}}catch(o){}await new Promise(o=>setTimeout(o,300));try{let o=this.extractDateFromTradePath(r);o&&((n=this.plugin)!=null&&n.drcService)&&await this.plugin.drcService.updateDRCBacklinks(o)}catch(o){console.error("Failed to update DRC backlinks after trade deletion:",o)}setTimeout(()=>{let o=new CustomEvent("journalit:trade-data-changed",{detail:{action:"deleted",filePath:r,timestamp:Date.now()}});document.dispatchEvent(o)},500)}catch(o){console.error("Error handling trade deletion:",o)}}}});function oc(e,t){let r={...e};return t&&Object.keys(t).forEach(n=>{let o=new RegExp(`{${n}}`,"g");r.message=r.message.replace(o,t[n]),r.detail&&(r.detail=r.detail.replace(o,t[n]))}),r}function zR(e){if(!e)return Aa.OFFLINE_MODE.basic;let t=new Date,r=Math.ceil((e.getTime()-t.getTime())/(1e3*60*60*24));return r<=0?Aa.OFFLINE_MODE.expired:{...Aa.OFFLINE_MODE.active,detail:Aa.OFFLINE_MODE.graceRemaining(r).message}}var Aa,fce=L(()=>{Aa={NEEDS_AUTH:{title:"Authentication Required",message:"Sign in to access Pro features. Basic features are still available.",action:"Sign In"},TOKEN_EXPIRED:{title:"Session Expired",message:"Your session has expired. Please sign in again to continue using Pro features.",action:"Reconnect"},AUTH_FAILED:{title:"Authentication Failed",message:"Unable to authenticate. Please try again.",action:"Retry"},NEEDS_PREMIUM:{title:"Pro Feature",message:"This is a Pro feature. Visit our website to subscribe and unlock:",features:["\u2726 Advanced trade management","\u2726 Custom dashboard layouts","\u2726 Multi-account support","\u2726 Advanced metrics","\u2726 Broker integration"],action:"Upgrade Now"},OFFLINE_MODE:{active:{title:"Offline Mode Active",message:"Working in offline mode. Some Pro features may be limited.",detail:"Your offline grace period allows continued access to Pro features."},expired:{title:"Offline Access Expired",message:"Offline grace period expired. Please reconnect to continue using Pro features.",action:"Reconnect Now"},basic:{title:"Basic Features Available",message:"Working offline. Basic features are still available.",detail:"Connect to access Pro features."},graceRemaining:e=>({message:`Offline grace period: ${e} days remaining`})},NETWORK_ERROR:{premium:{title:"Connection Error",message:"Unable to verify Pro access. Check your connection or continue with basic features.",action:"Retry Connection"},basic:{title:"Working Offline",message:"Working offline. Basic features are still available.",detail:"Will automatically sync when connection is restored."},sync:{title:"Sync Failed",message:"Unable to sync latest changes. Will retry when connection is restored.",detail:"Your changes are safely stored locally."}},STATUS:{connecting:"Signing in...",connected:"Signed in successfully",disconnected:"Signed out",syncing:"Syncing with server...",syncComplete:"Sync complete",syncFailed:"Sync failed"}}});var gce,nf,of,_R=L(()=>{gce=require("obsidian"),nf=new gce.Events,of={STATE_CHANGED:"auth-state-changed"}});var PS,aL,hce=L(()=>{PS=require("obsidian");pg();aL=class{constructor(t){this.masterKey=null;this.masterSalt=null;this.app=t}get KEY_PATH(){return`${this.app.vault.configDir}/plugins/journalit/keys.json`}async migrateOldKeys(){let t=".journalit/keys.json",r=this.app.vault.adapter;try{if(await r.exists(t)){Ae.log("Found old keys at .journalit/keys.json, migrating...");let n=await r.read(t),o=`${this.app.vault.configDir}/plugins/journalit`;await r.exists(o)||await r.mkdir(o),await r.write(this.KEY_PATH,n),await r.remove(t);try{await r.rmdir(".journalit",!1)}catch(a){}Ae.log("[KeyManager] Migrated keys to plugin directory")}}catch(n){Ae.error("[KeyManager] Error migrating old keys:",n)}}async initialize(){await this.migrateOldKeys();try{let t=await this.loadKeyStorage();t?(this.masterSalt=new Uint8Array(t.masterSalt),await this.deriveMasterKey(),await this.verifyMasterKey(t.verificationData)||(Ae.warn("Master key verification failed, generating new key"),await this.generateNewMasterKey())):await this.generateNewMasterKey()}catch(t){Ae.error("Failed to initialize key manager:",t),await this.generateNewMasterKey()}}async generateNewMasterKey(){try{this.masterSalt=crypto.getRandomValues(new Uint8Array(16)),await this.deriveMasterKey();let t=crypto.getRandomValues(new Uint8Array(16));await this.saveKeyStorage({masterSalt:Array.from(this.masterSalt),verificationData:Array.from(t)})}catch(t){throw Ae.error("Failed to generate new master key:",t),t}}async deriveMasterKey(){try{if(!this.masterSalt)throw new Error("Master salt not initialized");let t=await this.getDeviceInfo(),n=new TextEncoder().encode(t);if(!crypto.subtle&&PS.Platform.isDesktopApp){try{let a=require("crypto").webcrypto;a&&a.subtle&&(crypto.subtle=a.subtle)}catch(a){}if(!crypto.subtle){this.masterKey="mock-master-key";return}}let o=await crypto.subtle.importKey("raw",n,{name:"PBKDF2"},!1,["deriveBits","deriveKey"]);this.masterKey=await crypto.subtle.deriveKey({name:"PBKDF2",salt:this.masterSalt,iterations:1e5,hash:"SHA-256"},o,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}catch(t){throw Ae.error("Failed to derive master key:",t),t}}async verifyMasterKey(t){try{if(!this.masterKey)return!1;if(!crypto.subtle)return!0;let r=new Uint8Array(12).fill(1),n=new Uint8Array([1,2,3,4,5]),o=await crypto.subtle.encrypt({name:"AES-GCM",iv:r},this.masterKey,n),a=await crypto.subtle.decrypt({name:"AES-GCM",iv:r},this.masterKey,o),i=new Uint8Array(a);if(i.length!==n.length)return!1;for(let s=0;s<n.length;s++)if(i[s]!==n[s])return!1;return!0}catch(r){return Ae.error("Master key verification failed:",r),!1}}async getDeviceInfo(){var t,r;try{let n=[],o=this.app.vault.getName();n.push(`vault:${o}`);try{let a=this.app.vault.adapter.basePath;a&&n.push(`path:${a}`)}catch(a){}n.push(`ua:${navigator.userAgent}`),n.push(`screen:${window.screen.width}x${window.screen.height}`),n.push(`lang:${navigator.language}`);try{let a=(r=(t=window.journalitPlugin)==null?void 0:t.authManager)==null?void 0:r.getUserId();a&&n.push(`user:${a}`)}catch(a){}return n.join("|")}catch(n){return Ae.error("Failed to get device info:",n),`vault:${this.app.vault.getName()}|time:${Date.now()}`}}async loadKeyStorage(){try{let t=this.app.vault.adapter;if(!await t.exists(this.KEY_PATH))return null;let r=await t.read(this.KEY_PATH);return r?JSON.parse(r):null}catch(t){return Ae.error("Failed to load key storage:",t),null}}async saveKeyStorage(t){try{let r=this.app.vault.adapter,n=`${this.app.vault.configDir}/plugins/journalit`;await r.exists(n)||await r.mkdir(n),await r.write(this.KEY_PATH,JSON.stringify(t))}catch(r){throw Ae.error("Failed to save key storage:",r),r}}async deriveEncryptionKey(t){try{if(!this.masterKey)throw new Error("Master key not initialized");let r=crypto.getRandomValues(new Uint8Array(12));if(!crypto.subtle&&PS.Platform.isDesktopApp){try{let l=require("crypto").webcrypto;l&&l.subtle&&(crypto.subtle=l.subtle)}catch(l){}if(!crypto.subtle)return this.masterKey="mock-master-key",{key:this.masterKey,iv:r}}let o=new TextEncoder().encode(t),a=await crypto.subtle.exportKey("raw",this.masterKey),i=await crypto.subtle.importKey("raw",a,{name:"PBKDF2"},!1,["deriveBits","deriveKey"]);return{key:await crypto.subtle.deriveKey({name:"PBKDF2",salt:o,iterations:1e4,hash:"SHA-256"},i,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"]),iv:r}}catch(r){throw Ae.error("Failed to derive encryption key:",r),r}}async encrypt(t){try{let r=`encrypt-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,{key:n,iv:o}=await this.deriveEncryptionKey(r);if(!crypto.subtle&&PS.Platform.isDesktopApp){try{let l=require("crypto").webcrypto;l&&l.subtle&&(crypto.subtle=l.subtle)}catch(l){}if(!crypto.subtle)return this.masterKey="mock-master-key",btoa(unescape(encodeURIComponent(JSON.stringify(t))))}if(!crypto.subtle||typeof this.masterKey=="string")return btoa(unescape(encodeURIComponent(JSON.stringify(t))));let i=new TextEncoder().encode(JSON.stringify(t)),s=await crypto.subtle.encrypt({name:"AES-GCM",iv:o},n,i);return JSON.stringify({data:Array.from(new Uint8Array(s)),iv:Array.from(o),purpose:r})}catch(r){throw Ae.error("Failed to encrypt data:",r),r}}async decrypt(t){try{let r;try{r=JSON.parse(t)}catch(c){return JSON.parse(decodeURIComponent(escape(atob(t))))}let{data:n,iv:o,purpose:a}=r,{key:i}=await this.deriveEncryptionKey(a);if(!crypto.subtle&&PS.Platform.isDesktopApp){try{let c=require("crypto").webcrypto;c&&c.subtle&&(crypto.subtle=c.subtle)}catch(c){}if(!crypto.subtle)return this.masterKey="mock-master-key",{test:"value"}}if(!crypto.subtle||typeof this.masterKey=="string")return JSON.parse(decodeURIComponent(escape(atob(t))));let s=await crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(o)},i,new Uint8Array(n)),l=new TextDecoder;return JSON.parse(l.decode(s))}catch(r){throw Ae.error("Failed to decrypt data:",r),r}}async cleanup(){try{let t=this.app.vault.adapter;await t.exists(this.KEY_PATH)&&(await t.remove(this.KEY_PATH),Ae.log("Key storage removed during cleanup")),this.masterKey=null,this.masterSalt=null}catch(t){Ae.error("Failed to clean up key storage:",t)}}}});var Uo,Rb,vce=L(()=>{Uo=require("obsidian");fce();_R();pg();hce();kR();eu();Rb=class{constructor(t,r){this.state={isAuthenticated:!1,token:null,error:null,cache:null,isOffline:!1};this.GRACE_PERIOD_DAYS=7;this.BETA_EXPIRY_DAYS=42;this.app=t,this.serverUrl=r.replace(/\/+$/,""),this.keyManager=new aL(t),this.initializeAuth()}get CONFIG_PATH(){return`${this.app.vault.configDir}/plugins/journalit/auth.json`}async initializeAuth(){try{await this.keyManager.initialize(),await this.loadStoredAuth()}catch(t){Ae.error("Failed to initialize auth:",t),this.resetAuthState("Initialization failed")}}async migrateOldConfig(){let t=".journalit/auth.json",r=this.app.vault.adapter;try{if(await r.exists(t)){Ae.log("Found old auth config at .journalit/auth.json, migrating...");let n=await r.read(t),o=`${this.app.vault.configDir}/plugins/journalit`;await r.exists(o)||await r.mkdir(o),await r.write(this.CONFIG_PATH,n),await r.remove(t);try{await r.rmdir(".journalit",!1)}catch(a){}Ae.log("[AuthManager] Migrated config to plugin directory")}}catch(n){Ae.error("[AuthManager] Error migrating old config:",n)}}async loadStoredAuth(){let t=this.app.vault.adapter;await this.migrateOldConfig();try{let r=`${this.app.vault.configDir}/plugins/journalit`;if(await t.exists(r)||(Ae.log("Creating auth config directory"),await t.mkdir(r)),!await t.exists(this.CONFIG_PATH)){Ae.log("No stored auth config found");return}Ae.log("Loading stored auth configuration");let n=await t.read(this.CONFIG_PATH);if(!n){Ae.warn("Auth config file exists but is empty");return}let o=await this.decryptData(n);if(!o.token||!o.userId||!o.roles)throw new Error("Stored auth config is incomplete");let a=new Date(o.graceEnd),i=new Date(o.lastVerified),s=o.tokenExpiry?new Date(o.tokenExpiry):void 0;if(isNaN(a.getTime())||isNaN(i.getTime()))throw new Error("Invalid dates in stored config");if(s&&isNaN(s.getTime()))throw new Error("Invalid token expiry date in stored config");this.state.token=o.token,this.state.isAuthenticated=!0,this.state.cache={userId:o.userId,email:o.email,roles:o.roles,features:this.getFeaturesFromRoles(o.roles),graceEnd:a,lastVerified:i,tokenExpiry:s,subscriptionStatus:o.subscriptionStatus,isBeta:o.isBeta},this.updateSubscriptionTier(),tt.setAuthToken(this.state.token.access_token),Ae.log("Successfully loaded stored auth:",{userId:o.userId,email:o.email,roles:o.roles.length,features:this.state.cache.features.length,graceEnd:a.toISOString(),lastVerified:i.toISOString(),tokenExpiry:s==null?void 0:s.toISOString(),isBeta:o.isBeta}),nf.trigger(of.STATE_CHANGED)}catch(r){Ae.error("Failed to load auth config:",{error:r,path:this.CONFIG_PATH,errorType:r instanceof Error?r.name:typeof r,message:r instanceof Error?r.message:"Unknown error"}),this.resetAuthState("Failed to load auth config");try{await t.exists(this.CONFIG_PATH)&&(await t.remove(this.CONFIG_PATH),Ae.log("Removed corrupted auth config"))}catch(n){Ae.error("Failed to remove corrupted config:",n)}}}async storeAuthConfig(){var t,r,n;if(!this.state.token||!this.state.cache){Ae.log("Cannot store auth config - missing token or cache:",{hasToken:!!this.state.token,hasCache:!!this.state.cache});return}try{Ae.log("Attempting to store auth config with state:",{hasRoles:!!this.state.cache.roles,hasSubscriptionStatus:!!this.state.cache.subscriptionStatus,hasGraceEnd:!!this.state.cache.graceEnd,graceEndType:this.state.cache.graceEnd?typeof this.state.cache.graceEnd:"undefined",hasLastVerified:!!this.state.cache.lastVerified,lastVerifiedType:this.state.cache.lastVerified?typeof this.state.cache.lastVerified:"undefined",hasUserId:!!this.state.cache.userId});let o={token:this.state.token,roles:this.state.cache.roles,subscriptionStatus:this.state.cache.subscriptionStatus,graceEnd:(t=this.state.cache.graceEnd)==null?void 0:t.toISOString(),lastVerified:(r=this.state.cache.lastVerified)==null?void 0:r.toISOString(),tokenExpiry:(n=this.state.cache.tokenExpiry)==null?void 0:n.toISOString(),userId:this.state.cache.userId,email:this.state.cache.email,isBeta:this.state.cache.isBeta};Ae.log("Config data prepared:",{hasToken:!!o.token,hasRoles:!!o.roles,hasGraceEnd:!!o.graceEnd,hasLastVerified:!!o.lastVerified,hasUserId:!!o.userId});let a=await this.encryptData(o);await this.app.vault.adapter.write(this.CONFIG_PATH,a)}catch(o){throw Ae.error("Failed to store auth config:",o),o}}async encryptData(t){try{return await this.keyManager.encrypt(t)}catch(r){throw Ae.error("Failed to encrypt data:",r),r}}async decryptData(t){try{let r=JSON.parse(t);return r.key&&r.iv&&r.data?await this.legacyDecryptData(t):await this.keyManager.decrypt(t)}catch(r){throw Ae.error("Failed to decrypt data:",r),r}}async legacyDecryptData(t){try{let{data:r,iv:n,key:o}=JSON.parse(t),a=await crypto.subtle.importKey("raw",new Uint8Array(o),{name:"AES-GCM",length:256},!1,["decrypt"]),i=await crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(n)},a,new Uint8Array(r)),s=new TextDecoder;return JSON.parse(s.decode(i))}catch(r){throw Ae.error("Legacy decryption failed:",r),r}}getFeaturesFromRoles(t){let r=["basic-trades","basic-dashboard","trade-list"];return(t.includes("journalit-premium")||t.includes("admin"))&&r.push("advanced-trades","custom-layouts","multi-account","advanced-metrics","broker-integration"),r}async loginWithEmail(){return this.authenticate()}updateSubscriptionTier(){var t;(t=this.state.cache)!=null&&t.roles&&(this.state.cache.roles.includes("journalit-premium")||this.state.cache.roles.includes("admin")?this.state.subscriptionTier="premium":this.state.subscriptionTier="free")}isTokenExpired(){var t;return(t=this.state.cache)!=null&&t.tokenExpiry?new Date>this.state.cache.tokenExpiry:!1}isTokenApproachingExpiry(){var n;if(!((n=this.state.cache)!=null&&n.tokenExpiry))return!1;let t=new Date,r=new Date(t.getTime()+10080*60*1e3);return this.state.cache.tokenExpiry<r}showTokenExpiryWarningIfNeeded(){var n;if(!((n=this.state.cache)!=null&&n.tokenExpiry))return;let t=new Date,r=Math.ceil((this.state.cache.tokenExpiry.getTime()-t.getTime())/(1e3*60*60*24));if(r>0&&r<=7){Ae.warn(`Token expires in ${r} days`,{tokenExpiry:this.state.cache.tokenExpiry.toISOString(),daysRemaining:r});let o=r===1?"Your session expires tomorrow. Please sign in again soon to continue using Pro features.":`Your session expires in ${r} days. Please sign in again to continue using Pro features.`;new Uo.Notice(o,8e3)}}decodeJWT(t){try{let r=t.split(".");if(r.length!==3)throw new Error("Invalid JWT format");let n=r[1].replace(/-/g,"+").replace(/_/g,"/");for(;n.length%4!==0;)n+="=";return JSON.parse(atob(n))}catch(r){throw Ae.error("Failed to decode JWT:",r),new Error("Invalid JWT token")}}async verifyAuth(){var o,a,i,s,l;let n=0;for(;n<3;)try{if(n++,Ae.log(`Auth verification attempt ${n}/3`),!navigator.onLine){Ae.log("Network offline - checking cached credentials");let p=this.handleOfflineAuth(),m=zR(((o=this.state.cache)==null?void 0:o.graceEnd)||null);return Ae.log("Showing offline mode notice:",{message:m.message,location:"offline mode fallback",timestamp:new Date().toISOString()}),new Uo.Notice(m.message),p}if(!((a=this.state.token)!=null&&a.access_token))throw new Error("No auth token available");if(this.isTokenExpired()){Ae.log("Token expired - re-authentication required");let p=oc(Aa.TOKEN_EXPIRED);throw new Uo.Notice(p.message),new Error(p.message)}let c=new URL("/auth/validate",this.serverUrl).toString();Ae.log("Verifying token:",{url:c,attempt:n,tokenType:this.state.token.token_type});let d=await(0,Uo.requestUrl)({url:c,method:"GET",headers:this.getAuthHeaders()});if(Ae.log("Verify response received:",{status:d.status,statusText:d.status===401?"Unauthorized":d.status===200?"OK":"Unknown",headers:d.headers,hasBody:!!d.text}),d.status===401){Ae.log("Token verification failed - Unauthorized");let p=oc(Aa.AUTH_FAILED,{reason:"Token is no longer valid"});return new Uo.Notice(p.message),!1}if(d.status!==200)throw Ae.log("Unexpected response status:",d.status),new Error(`Unexpected response status: ${d.status}`);Ae.log("Attempting to parse response body");let u=await d.json();if(Ae.log("Response parsed successfully:",{authenticated:!!u.authenticated,hasError:!!u.error,userId:(i=u.user)==null?void 0:i.id}),!u.authenticated||u.error){let p=oc(Aa.AUTH_FAILED,{reason:u.message||u.error||"Server validation failed"});return new Uo.Notice(p.message),!1}if(!((s=u.user)!=null&&s.id)||!((l=u.user)!=null&&l.roles)){let p=oc(Aa.AUTH_FAILED,{reason:"Invalid user data received"});throw new Uo.Notice(p.message),new Error(p.message)}this.state.cache={userId:u.user.id,roles:u.user.roles,features:this.getFeaturesFromRoles(u.user.roles),graceEnd:new Date(Date.now()+this.GRACE_PERIOD_DAYS*24*60*60*1e3),lastVerified:new Date,subscriptionStatus:u.user.subscriptionStatus},Ae.log("Auth verification successful:",{userId:u.user.id,roleCount:u.user.roles.length,features:this.state.cache.features.length,expiresAt:this.state.cache.graceEnd}),this.state.isOffline=!1,this.updateSubscriptionTier();try{await this.storeAuthConfig()}catch(p){Ae.warn("Failed to store updated auth config:",p)}return this.showTokenExpiryWarningIfNeeded(),!0}catch(c){if(Ae.error(`Auth verification failed (attempt ${n}):`,c),Ae.log("Error details before offline fallback:",{errorType:c instanceof Error?c.name:typeof c,errorMessage:c instanceof Error?c.message:String(c),isNetworkError:c instanceof Error&&c.message.toLowerCase().includes("network"),attempts:n,maxRetries:3}),n===3){Ae.log("All online verification attempts failed - trying offline mode");let d=this.handleOfflineAuth();if(d){let u=oc(Aa.NETWORK_ERROR.basic);Ae.log("Showing network error notice:",{message:u.title,location:"network error fallback",timestamp:new Date().toISOString()}),new Uo.Notice(u.title),this.showTokenExpiryWarningIfNeeded()}return d}await new Promise(d=>setTimeout(d,1e3*n))}return!1}handleOfflineAuth(){if(!this.state.cache)return Ae.log("No cached auth data available for offline mode"),!1;let t=new Date;return t<this.state.cache.graceEnd?(Ae.log("Using cached auth data:",{userId:this.state.cache.userId,graceEnd:this.state.cache.graceEnd,timeRemaining:this.state.cache.graceEnd.getTime()-t.getTime()}),this.state.isOffline=!0,!0):(Ae.log("Cached auth data expired:",{graceEnd:this.state.cache.graceEnd,now:t}),!1)}async authenticate(){try{this.resetAuthState("Starting new authentication"),Ae.log("Initiating beta email auth"),new RA(this.app,async(r,n)=>{await this.handleBetaAuth(r,n)},()=>{Ae.log("Authentication cancelled by user")}).open()}catch(t){Ae.error("Auth error:",t),this.state.isAuthenticated=!1,this.state.token=null,this.state.cache=null;let r=oc(Aa.AUTH_FAILED);throw this.state.error=r.message,new Uo.Notice(r.message),t}}async handleBetaAuth(t,r){try{Ae.log("Beta auth data received:",{hasToken:!!t,hasUser:!!r,userId:r==null?void 0:r.id,tier:r==null?void 0:r.tier});let n=this.decodeJWT(t);if(!n.exp||!n.user_id)throw new Error("Invalid JWT token claims");this.state.token={access_token:t,token_type:"Bearer",expires_in:this.BETA_EXPIRY_DAYS*24*60*60,refresh_token:null};let o=r.tier==="premium"?["journalit-premium"]:[],a=this.getFeaturesFromRoles(o);Ae.log("Initializing beta auth cache:",{userId:r.id,email:r.email,tier:r.tier,roleCount:o.length,featureCount:a.length,features:a}),this.state.cache={userId:r.id,email:r.email,roles:o,features:a,graceEnd:new Date(Date.now()+this.GRACE_PERIOD_DAYS*24*60*60*1e3),lastVerified:new Date,tokenExpiry:new Date(n.exp*1e3),subscriptionStatus:"beta",isBeta:r.is_beta},this.state.isAuthenticated=!0,this.state.error=null,this.updateSubscriptionTier(),tt.setAuthToken(this.state.token.access_token);try{await this.storeAuthConfig()}catch(i){Ae.warn("Failed to store auth config:",i)}Ae.log("Triggering auth state change event (handleBetaAuth)"),nf.trigger(of.STATE_CHANGED),Ae.log("Beta authentication completed successfully:",{userId:this.state.cache.userId,email:this.state.cache.email,roles:this.state.cache.roles,features:this.state.cache.features,tier:this.state.subscriptionTier,tokenExpiry:this.state.cache.tokenExpiry})}catch(n){throw Ae.error("Beta auth error:",n),this.state.isAuthenticated=!1,this.state.token=null,this.state.cache=null,n instanceof Error?this.state.error=n.message:this.state.error="An unknown error occurred",n}}resetAuthState(t="No reason provided"){var r,n,o;Ae.log("Resetting auth state:",{reason:t,hadCache:!!this.state.cache,hadFeatures:!!((r=this.state.cache)!=null&&r.features),featureCount:(o=(n=this.state.cache)==null?void 0:n.features)==null?void 0:o.length,wasAuthenticated:this.state.isAuthenticated,wasOffline:this.state.isOffline}),this.state={isAuthenticated:!1,token:null,error:null,cache:null,isOffline:!1,subscriptionTier:void 0},tt.setAuthToken(null),Ae.log("Auth state reset complete")}async logout(){if(Ae.log("Starting logout process",{serverUrl:this.serverUrl,hasToken:!!this.state.token}),!this.state.token){Ae.log("No active token to invalidate"),this.resetAuthState("No active token"),Ae.log("Triggering auth state change event (no token path)"),nf.trigger(of.STATE_CHANGED);return}let t=!1;try{if(navigator.onLine){let r=new URL("/auth/logout",this.serverUrl).toString();Ae.log("Sending logout request to server",{fullUrl:r,headers:this.getAuthHeaders()}),await(0,Uo.requestUrl)({url:r,method:"POST",headers:this.getAuthHeaders()}),t=!0,Ae.log("Token invalidation successful"),new Uo.Notice(Aa.STATUS.disconnected)}else{Ae.log("Offline mode - skipping token invalidation");let r=oc(Aa.NETWORK_ERROR.basic);new Uo.Notice(r.message)}}catch(r){Ae.error("Token invalidation failed:",{error:r,errorType:r instanceof Error?r.name:typeof r,message:r instanceof Error?r.message:"Unknown error"})}try{this.resetAuthState(t?"Token invalidation successful":"Local cleanup only"),tt.setAuthToken(null),Ae.log("Checking for auth config file existence");let r=await this.app.vault.adapter.exists(this.CONFIG_PATH);if(Ae.log("Auth config exists check result:",r),r){Ae.log("Attempting to remove auth config file"),await this.app.vault.adapter.remove(this.CONFIG_PATH),Ae.log("Auth config removal completed");let n=await this.app.vault.adapter.exists(this.CONFIG_PATH);Ae.log("Post-removal existence check:",{path:this.CONFIG_PATH,stillExists:n,timestamp:new Date().toISOString()})}try{await this.keyManager.cleanup()}catch(n){Ae.warn("Failed to clean up key storage:",n)}nf.trigger(of.STATE_CHANGED)}catch(r){Ae.error("Local cleanup failed:",r),this.resetAuthState("Forced reset after cleanup failure")}Ae.log("Logout completed:",{tokenInvalidated:t,stateCleared:!this.state.token&&!this.state.isAuthenticated,configRemoved:!await this.app.vault.adapter.exists(this.CONFIG_PATH).catch(()=>!0)})}async hasFeature(t){var o,a,i;if(Ae.log("hasFeature check:",{featureName:t,hasCache:!!this.state.cache,hasFeatures:!!((o=this.state.cache)!=null&&o.features),featureCount:(i=(a=this.state.cache)==null?void 0:a.features)==null?void 0:i.length,isOffline:this.state.isOffline}),!this.state.cache){let s=oc(Aa.NEEDS_AUTH);return new Uo.Notice(s.message),!1}let r=this.getFeaturesFromRoles([]).includes(t);if(!navigator.onLine){this.state.isOffline=!0,Ae.log("Offline mode feature check:",{featureName:t,graceEnd:this.state.cache.graceEnd,now:new Date,isExpired:new Date>this.state.cache.graceEnd,features:this.state.cache.features});let s=zR(this.state.cache.graceEnd);if(new Uo.Notice(s.message),!this.handleOfflineAuth()){let c=Aa.OFFLINE_MODE.expired;return new Uo.Notice(c.message),!1}let l=this.state.cache.features.includes(t);if(!l&&!r){let c=oc(Aa.NEEDS_PREMIUM);new Uo.Notice(`${c.title}: ${c.message}`)}return l}if(this.state.isOffline=!1,Date.now()-this.state.cache.lastVerified.getTime()>36e5)try{await this.verifyAuth()}catch(s){let l=oc(Aa.NETWORK_ERROR.premium);return new Uo.Notice(l.message),r}let n=this.state.cache.features.includes(t);if(!n&&!r){let s=oc(Aa.NEEDS_PREMIUM);new Uo.Notice(`${s.title}: ${s.message}`)}return n}getAuthState(){return{...this.state}}isAuthenticated(){return this.state.isAuthenticated&&!!this.state.token}getSubscriptionTier(){return this.state.subscriptionTier}getUserId(){var t;return(t=this.state.cache)==null?void 0:t.userId}getAuthToken(){var t;return((t=this.state.token)==null?void 0:t.access_token)||null}getAuthHeaders(){var r;let t={"Content-Type":"application/json","Accept-Language":"en-US"};return(r=this.state.token)!=null&&r.access_token&&(t.Authorization=`Bearer ${this.state.token.access_token}`),t}};Rb.AUTH_CHANGED="journalit-auth-changed"});var BR,yce=L(()=>{BR=()=>"https://api.journalit.co"});async function Ci(e,t){try{let r=performance.now();await new Promise(a=>setTimeout(a,10));let n=e(),o=Math.round(performance.now()-r);return n}catch(r){throw console.error(`Failed to lazy load ${t}:`,r),r}}var $R=L(()=>{});function WR(e){var r,n;let t=[];return(r=e.name)!=null&&r.trim()||t.push({field:"name",message:"Name is required"}),(n=e.description)!=null&&n.trim()||t.push({field:"description",message:"Description is required"}),e.name&&!/^[\w\s-]{3,50}$/.test(e.name)&&t.push({field:"name",message:"Name must be 3-50 characters and contain only letters, numbers, spaces, and hyphens"}),e.color&&!/^#[0-9A-Fa-f]{6}$/.test(e.color)&&t.push({field:"color",message:"Color must be a valid hex color code (e.g. #FF0000)"}),e.order!==void 0&&(!Number.isInteger(e.order)||e.order<0)&&t.push({field:"order",message:"Order must be a non-negative integer"}),t}function RR(e){if(!e.startsWith("setup-"))throw new Error('Invalid setup ID format: must start with "setup-"');if(!/^setup-[\w-]{1,50}$/.test(e))throw new Error("Invalid setup ID format: must contain only letters, numbers, and hyphens")}var bce=L(()=>{});var iL,xce=L(()=>{iL=class{constructor(t){this.tradeService=t}async calculateMetrics(t){let r=await this.getSetupTrades(t);if(!r.length)return this.getEmptyMetrics();let n=r.map(l=>this.calculateTradePnL(l)),o=n.filter(l=>l>0),a=n.filter(l=>l<0),i=this.calculateStreaks(n);return{...this.getEmptyMetrics(),totalTrades:r.length,winRate:o.length/r.length*100,totalPnL:n.reduce((l,c)=>l+c,0),avgWinner:o.length?o.reduce((l,c)=>l+c,0)/o.length:0,avgLoser:a.length?a.reduce((l,c)=>l+c,0)/a.length:0,winStreak:i.maxWin,loseStreak:i.maxLoss,currentStreak:i.current,...this.calculateAdvancedMetrics(r,n)}}async getSetupTrades(t){let r=await this.tradeService.getTrades(new Date(0),new Date);return(await Promise.all(r.map(async n=>{try{let o=await this.tradeService.readTradeContent(n),a=this.parseTrade(o);return a.setupIds.includes(t)?a:null}catch(o){return console.warn(`Invalid trade file: ${n.path}`),null}}))).filter(n=>n!==null)}calculateTradePnL(t){return(t.exitPrice-t.entryPrice)*t.positionSize}calculateStreaks(t){let r=0,n=0,o=0;return t.forEach(a=>{a>0?(r<0&&(r=0),r++,n=Math.max(n,r)):a<0&&(r>0&&(r=0),r--,o=Math.min(o,r))}),{maxWin:n,maxLoss:Math.abs(o),current:r}}getEmptyMetrics(){return{totalTrades:0,winRate:0,totalPnL:0,avgWinner:0,avgLoser:0,winStreak:0,loseStreak:0,currentStreak:0,expectedValue:0,riskRewardRatio:0,profitFactor:0,averageDuration:0,bestTrade:0,worstTrade:0,averageVolume:0,lastTradeDate:new Date().toISOString(),tradingFrequency:0,inactivityStreak:0}}calculateAdvancedMetrics(t,r){if(!t.length)return{};let n=r.filter(g=>g>0),o=r.filter(g=>g<0),a=t.map(g=>{let v=new Date(g.exitTime),h=new Date(g.entryTime);return(v.getTime()-h.getTime())/1e3/60}),i=t.map(g=>Math.abs(g.positionSize)),s=n.reduce((g,v)=>g+v,0),l=Math.abs(o.reduce((g,v)=>g+v,0)),c=t.map(g=>new Date(g.exitTime)),d=new Date(Math.max(...c.map(g=>g.getTime()))),u=new Date,p=Math.floor((u.getTime()-d.getTime())/(1e3*60*60*24)),m=new Date(Math.min(...c.map(g=>g.getTime()))),f=(u.getTime()-m.getTime())/(1e3*60*60*24*30.44);return{expectedValue:r.reduce((g,v)=>g+v,0)/r.length,riskRewardRatio:Math.abs(n.length?s/n.length:0)/Math.abs(o.length?l/o.length:1),profitFactor:l?s/l:s?1/0:0,averageDuration:a.reduce((g,v)=>g+v,0)/a.length,bestTrade:Math.max(...r),worstTrade:Math.min(...r),averageVolume:i.reduce((g,v)=>g+v,0)/i.length,lastTradeDate:d.toISOString(),tradingFrequency:t.length/f,inactivityStreak:p}}parseTrade(t){let r=t.match(/^---\n([\s\S]*?)\n---/);if(!r)throw new Error("Invalid trade file format");let n=r[1].split(`
`).reduce((a,i)=>{let[s,...l]=i.split(":").map(c=>c.trim());return s&&l.length&&(s==="setupIds"?a[s]=l.join(":").replace(/[\[\]]/g,"").split(",").map(c=>c.trim()):a[s]=l.join(":")),a},{}),o=new Date().toISOString();return{exitPrice:Number(n.exitPrice),entryPrice:Number(n.entryPrice),positionSize:Number(n.positionSize),setupIds:n.setupIds||[],entryTime:n.entryTime||o,exitTime:n.exitTime||n.entryTime||o}}}});var lL,sL,wce=L(()=>{lL=require("obsidian");rf();bce();xce();ls();sL=class extends Qi{constructor(r,n,o={}){super(r,{folder:"setups",extension:".md",cacheTTL:300*1e3,persistCache:!0,namespace:o.namespace||"setup"});this.tradeService=n;this.SETUPS_FOLDER="setups";this.metricsCalculator=new iL(n)}async getSetupMetrics(r){return RR(r),this.query(async()=>this.metricsCalculator.calculateMetrics(r),`metrics:${r}`,{offlineCapable:!0})}async getAllSetupMetrics(r){let n=`metrics:all${r?`:${JSON.stringify(r)}`:""}`;return this.query(async()=>{let o=await this.getSetupFiles(),a=await this.filterSetupFiles(o,r),i=new Map;for(let s of a)try{let l=await this.app.vault.read(s),c=await this.parseSetupContent(l),d=await this.metricsCalculator.calculateMetrics(c.id);i.set(c.id,d)}catch(l){console.warn(`Failed to calculate metrics for setup: ${s.path}`)}return i},n,{offlineCapable:!0})}async createSetup(r){let n=WR(r);if(n.length)throw new Error(`Invalid setup data: ${n.map(s=>s.message).join(", ")}`);let o=this.generateSetupId(r.name),a=this.getSetupFilePath(o),i=this.generateSetupContent({...r,id:o,status:"active",version:1,createdAt:this.formatDateTimeForDisplay(new Date),updatedAt:this.formatDateTimeForDisplay(new Date),color:r.color||"#808080",icon:r.icon||"trading_setup",order:r.order||0});return await this.app.vault.create(a,i),a}async updateSetup(r,n){if(RR(r),Object.keys(n).length>0){let d=[];"name"in n&&d.push("name"),"description"in n&&d.push("description"),"color"in n&&d.push("color"),"order"in n&&d.push("order");let u=WR(n).filter(p=>d.includes(p.field));if(u.length)throw new Error(`Invalid setup data: ${u.map(p=>p.message).join(", ")}`)}let o=this.getSetupFilePath(r),a=this.app.vault.getAbstractFileByPath(o);if(!(a instanceof lL.TFile))throw new Error(`Setup not found: ${r}`);let i=await this.app.vault.read(a),s=await this.parseSetupContent(i),l={...s,...n,version:s.version+1,updatedAt:this.formatDateTimeForDisplay(new Date)},c=this.generateSetupContent(l);await this.app.vault.modify(a,c),await yr(this.app,a),await this.clearCache()}async archiveSetup(r){await this.updateSetup(r,{status:"archived"})}async getSetups(r){let n=`setups:${JSON.stringify(r||{})}`;return this.query(async()=>{let o=await this.getSetupFiles();return this.filterSetupFiles(o,r)},n,{offlineCapable:!0})}async getSetupFiles(){return this.getFiles()}getSetupFilePath(r){return(0,lL.normalizePath)(`${this.SETUPS_FOLDER}/${r}.md`)}generateSetupId(r){return`setup-${r.toLowerCase().replace(/[^a-z0-9]/g,"-")}`}formatDateTimeForDisplay(r){let n=r.getFullYear(),o=String(r.getMonth()+1).padStart(2,"0"),a=String(r.getDate()).padStart(2,"0"),i=String(r.getHours()).padStart(2,"0"),s=String(r.getMinutes()).padStart(2,"0"),l=String(r.getSeconds()).padStart(2,"0");return`${n}-${o}-${a}T${i}:${s}:${l}`}generateSetupContent(r){return["---","type: setup",`id: ${r.id}`,`name: ${r.name}`,`description: ${r.description}`,`status: ${r.status}`,`color: ${r.color}`,`icon: ${r.icon}`,`version: ${r.version}`,`createdAt: ${r.createdAt}`,`updatedAt: ${r.updatedAt}`,`order: ${r.order}`,"---","","## Trading Rules","",r.rules||"No rules defined."].join(`
`)}async parseSetupContent(r){var a;let n=r.match(/^---\n([\s\S]*?)\n---/);if(!n)throw new Error("Invalid setup file format");let o=n[1].split(`
`).reduce((i,s)=>{let[l,...c]=s.split(":").map(d=>d.trim());return l&&c.length&&(i[l]=c.join(":")),i},{});return{id:o.id,name:o.name,description:o.description,rules:((a=r.split("## Trading Rules")[1])==null?void 0:a.trim())||"",status:o.status,color:o.color,icon:o.icon,version:parseInt(o.version,10),createdAt:o.createdAt,updatedAt:o.updatedAt,order:parseInt(o.order,10)}}async filterSetupFiles(r,n){return n?(await Promise.all(r.map(async a=>{try{let i=await this.app.vault.read(a),s=await this.parseSetupContent(i);return n.status&&s.status!==n.status||n.search&&!this.matchesSearch(s,n.search)?null:a}catch(i){return console.warn(`Invalid setup file: ${a.path}`),null}}))).filter(a=>a!==null):r}matchesSearch(r,n){let o=n.toLowerCase();return r.name.toLowerCase().includes(o)||r.description.toLowerCase().includes(o)||r.rules.toLowerCase().includes(o)}}});var kce=L(()=>{});function Sce(e){let t=new CustomEvent("drc-created",{detail:{path:e}});document.dispatchEvent(t)}function cL(e,t="unknown"){let r=new CustomEvent("drc-updated",{detail:{path:e,source:t}});document.dispatchEvent(r)}var Tce=L(()=>{kce()});var Pi,dL,Cce=L(()=>{Pi=require("obsidian");Tce();wt();ci();ls();zb();uR();dL=class{constructor(t,r,n,o={}){this.DRC_PREFIX="DRC";this.app=t,this.plugin=r,this.folderPathService=n,this.namespace=o.namespace||"drc",document.addEventListener("journalit-settings-updated",this.onSettingsUpdated.bind(this))}async onSettingsUpdated(t){var r;try{if(((r=t==null?void 0:t.detail)==null?void 0:r.source)==="user-input")return;let n=this.app.workspace.getActiveFile();if(!n)return;let o=this.app.metadataCache.getFileCache(n);if(!(o!=null&&o.frontmatter)||o.frontmatter.type!=="drc")return;cL(n.path,"settings-update")}catch(n){console.error("Error updating DRC after settings change:",n)}}getWeekOfMonth(t){return ss(t)}formatDateForFilename(t){let r=String(t.getDate()).padStart(2,"0"),n=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getFullYear()).slice(-2);return`${r}${n}${o}`}formatDateForDisplay(t){let r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0");return`${r}-${n}-${o}`}formatDateTimeForDisplay(t){let r=this.formatDateForDisplay(t),n=t.toTimeString().split(" ")[0];return`${r}T${n}`}async ensureDirectoryExists(t){let r=t.substring(0,t.lastIndexOf("/"));await this.app.vault.adapter.exists(r)||await this.app.vault.adapter.mkdir(r)}async createDRC(t){try{let r=this.getDRCNotePath(t);if(await this.app.vault.adapter.exists(r))return r;await this.ensureDirectoryExists(r);let o=await this.generateInitialDRCContent(t),a=await this.app.vault.create(r,o);return await yr(this.app,a),await this.addBacklinksToContent(a,t),Sce(r),r}catch(r){throw console.error("Error creating DRC:",r),r}}async addBacklinksToContent(t,r){try{let n=await gS(r,this.plugin);if(n.drcToWeekly){let o=await this.app.vault.read(t),a=Si.generateLinksSection(n),i=o+`

`+a;await this.app.vault.modify(t,i)}}catch(n){console.error("Error adding backlinks to DRC:",n)}}async getTodayDRC(){let t=new Date;return this.createDRC(t)}async getDRC(t){return this.createDRC(t)}async updateDRCBacklinks(t){try{let r=this.getDRCNotePath(t),n=this.app.vault.getAbstractFileByPath(r);if(!n||!(n instanceof Pi.TFile))return;let o=await gS(t,this.plugin),a=await this.app.vault.read(n),i=Si.updateLinksSection(a,o);i!==a&&await this.app.vault.modify(n,i)}catch(r){console.error("Error updating DRC backlinks:",r)}}async getTradesForDate(t){var r;try{let n=lr(t,this.plugin),o=this.formatDateForDisplay(n),a=this.app.vault.getMarkdownFiles(),i=[];for(let s of a){let l=(r=this.app.metadataCache.getFileCache(s))==null?void 0:r.frontmatter;if(!(!l||l.type!=="trade"&&l.type!=="backtest-trade")){if(l.entryTime){let c=new Date(l.entryTime),d=lr(c,this.plugin);this.formatDateForDisplay(d)===o&&i.push(s)}else if(l.date){let c=Mt(l.date);if(!c)continue;this.formatDateForDisplay(c)===o&&i.push(s)}}}return i}catch(n){return console.error(`Error getting trades for date ${t.toDateString()}:`,n),[]}}async updateDRCFrontmatter(t,r,n="unknown"){try{let o=this.app.vault.getAbstractFileByPath(t);if(!o||!(o instanceof Pi.TFile))throw new Error(`DRC file not found: ${t}`);if(await this.app.fileManager.processFrontMatter(o,a=>{Object.assign(a,r)}),await yr(this.app,o),n==="user-input")return;cL(t,n),r.dailyGoals!==void 0&&await this.syncGoalsToNextDay(t,r.dailyGoals);return}catch(o){throw console.error(`Error updating DRC frontmatter in ${t}:`,o),o}}getWeeklyReviewPath(t){let r=bo(t),n=r.getFullYear(),o=String(r.getMonth()+1).padStart(2,"0"),a=ss(r),i=`${a}-Review.md`;return(0,Pi.normalizePath)(this.folderPathService.getDatePath(n.toString(),o,a,i))}getMonthlyReviewPath(t){let r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),o=`${n}-Review.md`;return(0,Pi.normalizePath)(this.folderPathService.getPath(r.toString(),n,o))}getDRCNotePath(t){let r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),o=this.getWeekOfMonth(t),a=this.formatDateForFilename(t),i=`${this.DRC_PREFIX}-${a}.md`;return(0,Pi.normalizePath)(this.folderPathService.getDatePath(r.toString(),n,o,i))}getNextDayDRCPath(t){let n=kC(this.plugin)?VF(t):new Date(t.getTime()+1440*60*1e3);return this.getDRCNotePath(n)}getPreviousDayDRCPath(t){let n=kC(this.plugin)?HF(t):new Date(t.getTime()-1440*60*1e3);return this.getDRCNotePath(n)}async getAdjacentDRC(t,r,n){var o,a,i;try{let s=r<0?this.getPreviousDayDRCPath(t):this.getNextDayDRCPath(t);if(await this.app.vault.adapter.exists(s))return s;if((i=n!=null?n:(a=(o=this.plugin.settings)==null?void 0:o.drc)==null?void 0:a.autoCreateDRCOnNavigation)!=null?i:!0){let d=kC(this.plugin),u;return r<0?u=d?HF(t):new Date(t.getTime()-1440*60*1e3):u=d?VF(t):new Date(t.getTime()+1440*60*1e3),await this.createDRC(u),s}return null}catch(s){return console.error("Error getting adjacent DRC:",s),null}}getDRCFile(t){let r=this.app.vault.getAbstractFileByPath(t);return!r||!(r instanceof Pi.TFile)?null:r}extractDRCData(t){var r;try{let n=(r=this.app.metadataCache.getFileCache(t))==null?void 0:r.frontmatter;return!n||n.type!=="drc"?null:n}catch(n){return console.error("Error extracting DRC data:",n),null}}async getPreviousDayGoals(t){try{let r=this.getPreviousDayDRCPath(t);if(!await this.app.vault.adapter.exists(r))return null;let o=this.app.vault.getAbstractFileByPath(r);if(!o||!(o instanceof Pi.TFile))return null;await yr(this.app,o);let a=this.extractDRCData(o);return(a==null?void 0:a.dailyGoals)||null}catch(r){return console.error("Error getting previous day goals:",r),null}}async syncGoalsToNextDay(t,r){try{let n=this.app.vault.getAbstractFileByPath(t);if(!n||!(n instanceof Pi.TFile))return;let o=this.extractDRCData(n);if(!(o!=null&&o.date))return;let a=o.date.split("-").map(c=>parseInt(c,10)),i=new Date(a[0],a[1]-1,a[2]),s=this.getNextDayDRCPath(i),l=this.app.vault.getAbstractFileByPath(s);l instanceof Pi.TFile&&(await this.app.fileManager.processFrontMatter(l,c=>{c.previousDayGoals=r||[]}),await yr(this.app,l),cL(s))}catch(n){console.warn("[DRC Goals Sync] Failed to sync goals to next day:",n)}}generateDRCTags(t){let r=[];r.push([Fb(Mb.DAILY)]);let n=Ob(t);return n.length>0&&r.push(n),jb(...r)}async generateInitialDRCContent(t){let r={type:"drc",date:this.formatDateForDisplay(t),created:this.formatDateTimeForDisplay(new Date),tags:this.generateDRCTags(t),preTradeChecklist:{},mentalGrade:"B",technicalGrade:"B",tradeRatings:{},reviewQuestions:{},missedTrades:[]};this.plugin.settings.drc.checklistItems&&this.plugin.settings.drc.checklistItems.forEach(a=>{r.preTradeChecklist[a]=!1}),this.plugin.settings.drc.reviewQuestions&&this.plugin.settings.drc.reviewQuestions.forEach(a=>{r.reviewQuestions[a]=""});let n=await this.getPreviousDayGoals(t);return n&&n.length>0&&(r.previousDayGoals=n),[...["---",`type: ${r.type}`,...this.convertToYamlFrontmatter(r),"---"],`# Daily Report Card - ${this.formatDateForDisplay(t)}`,""].join(`
`)}convertToYamlFrontmatter(t){let r=[],n=o=>o==null?"null":typeof o=="string"?o.includes(":")||o.includes("#")||o.includes(`
`)||o.includes('"')||o.trim()===""?`"${o.replace(/"/g,'\\"')}"`:o:typeof o=="number"||typeof o=="boolean"?String(o):Array.isArray(o)||typeof o=="object"?JSON.stringify(o):String(o);for(let[o,a]of Object.entries(t))o!=="type"&&a!==void 0&&r.push(`${o}: ${n(a)}`);return r}async openDRC(t){try{let r=this.formatDateForDisplay(t),n=null;if(this.app.workspace.iterateAllLeaves(i=>{var s;if(i.view instanceof Pi.FileView&&i.view.file){let l=i.view.file,c=(s=this.app.metadataCache.getFileCache(l))==null?void 0:s.frontmatter;if((c==null?void 0:c.type)==="drc"&&(c==null?void 0:c.date)===r)return n=i,!0}}),n){this.app.workspace.revealLeaf(n);return}let o=this.getDRCNotePath(t);await this.app.vault.adapter.exists(o)?await this.plugin.openFile(o,!0):(await this.createDRC(t),await this.plugin.openFile(o,!0))}catch(r){throw console.error(`Failed to open DRC for date ${t.toDateString()}:`,r),r}}async createWeeklyReview(t){try{let r=this.getWeeklyReviewPath(t);if(await this.app.vault.adapter.exists(r))return r;await this.ensureDirectoryExists(r);let o=this.generateInitialWeeklyReviewContent(t),a=await this.app.vault.create(r,o);return await yr(this.app,a),r}catch(r){throw console.error("Error creating weekly review:",r),r}}generateInitialWeeklyReviewContent(t){let r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),o=this.getWeekOfMonth(t),a={type:"weekly-review",date:this.formatDateForDisplay(t),created:this.formatDateTimeForDisplay(new Date),week:o,month:n,year:r.toString()};return[...["---",`type: ${a.type}`,...this.convertToYamlFrontmatter(a),"---"],"",`# Weekly Review - Week ${o}, ${n}/${r}`,"","## Summary","","Weekly trading summary goes here.","","## Performance","","Performance metrics for the week.","","## Lessons Learned","","Key takeaways from this week's trades.","","## Goals for Next Week","","Trading goals for the upcoming week."].join(`
`)}async openWeeklyReview(t){try{await(await this.plugin.serviceManager.getWeeklyReviewService()).openWeeklyReview(t)}catch(r){throw console.error(`Failed to open weekly review for date ${t.toDateString()}:`,r),r}}async saveDRCForecastImage(t,r,n){try{let o=r.getFullYear(),a=String(r.getMonth()+1).padStart(2,"0"),i=this.getWeekOfMonth(r),s=n.replace(/[^a-zA-Z0-9]/g,""),l=t.name.replace(/[^a-zA-Z0-9.-]/g,"_"),c="";if(l.includes("."))c=l.substring(l.lastIndexOf("."));else throw new Error("File name does not contain a period.");let d=Date.now(),u=this.formatDateForFilename(r),p=`DRC-${s}-${u}-${d}${c}`,m=this.folderPathService.getDatePath(o.toString(),a,i,"media"),f=`${m}/${p}`;await this.app.vault.adapter.mkdir((0,Pi.normalizePath)(m));let g=await t.arrayBuffer();return await this.app.vault.createBinary((0,Pi.normalizePath)(f),g),f}catch(o){throw console.error("Error saving DRC forecast image:",o),o}}async getWeeklyEventsForDate(t){var r;try{let n=t.toLocaleDateString("en-US",{weekday:"long"}),o=this.getWeeklyReviewPath(t);if(!await this.app.vault.adapter.exists(o))return[];let i=this.app.vault.getAbstractFileByPath(o);if(!i||!(i instanceof Pi.TFile))return[];let s=(r=this.app.metadataCache.getFileCache(i))==null?void 0:r.frontmatter;return!s||s.type!=="weekly-review"?[]:(s.keyEvents||[]).filter(d=>d.day?d.day.toLowerCase()===n.toLowerCase():!0)}catch(n){return console.error("Error getting weekly events for date:",n),[]}}async saveDRCForecastImages(t,r,n){try{let o=[];for(let a of t){let i=await this.saveDRCForecastImage(a,r,n);o.push(i)}return o}catch(o){throw console.error("Error saving multiple DRC forecast images:",o),o}}async deleteImage(t){try{let r=this.app.vault.getAbstractFileByPath(t);if(!r)throw new Error(`Image file not found: ${t}`);await this.app.vault.delete(r);let n=t.substring(0,t.lastIndexOf("/"));if(await this.app.vault.adapter.exists(n)){let a=await this.app.vault.adapter.list(n);if(a.files.length===0&&a.folders.length===0){let i=this.app.vault.getAbstractFileByPath(n);i&&await this.app.vault.delete(i)}}}catch(r){throw console.error(`Error deleting image ${t}:`,r),r}}}});var Pce=L(()=>{});function Dce(e){let t=new CustomEvent("weekly-review-created",{detail:{path:e}});document.dispatchEvent(t)}function uL(e){let t=new CustomEvent("weekly-review-updated",{detail:{path:e}});document.dispatchEvent(t)}var Ece=L(()=>{Pce()});var tu,pL,Ice=L(()=>{tu=require("obsidian");Lu();Ece();wt();ci();ls();zb();pL=class{constructor(t,r,n,o={}){this.WEEKLY_PREFIX="Weekly";this.folderPathService=null;this.app=t,this.plugin=r,this.folderPathService=n||null,this.folderPathService||this.initializeFolderPathService(),document.addEventListener("journalit-settings-updated",a=>{this.onSettingsUpdated(a)})}async initializeFolderPathService(){try{this.plugin.serviceManager&&(this.folderPathService=this.plugin.serviceManager.getFolderPathService())}catch(t){console.error("[WeeklyReviewService] Error initializing folder path service:",t)}}getJournalFolderPath(){return this.folderPathService?this.folderPathService.journalFolderPath:"!Journalit"}async onSettingsUpdated(t){var r,n,o;try{(r=t==null?void 0:t.detail)==null||r.component;let a=this.app.workspace.getActiveFile();if(!a)return;let i=this.app.metadataCache.getFileCache(a);if(!(i!=null&&i.frontmatter)||i.frontmatter.type!=="weekly-review")return;if(((n=t==null?void 0:t.detail)==null?void 0:n.component)==="weekly"&&((o=this.plugin.settings.weekly)!=null&&o.reviewQuestions)){let s=await this.extractWeeklyReviewData(a);if(!s)return;let l=Object.keys(s.reviewQuestions||{}),c=this.plugin.settings.weekly.reviewQuestions;if(l.length!==c.length||!l.every(d=>c.includes(d))){let d={};c.forEach(u=>{d[u]=s.reviewQuestions&&u in s.reviewQuestions?s.reviewQuestions[u]:""}),await this.updateWeeklyReviewFrontmatter(a.path,{reviewQuestions:d})}}uL(a.path)}catch(a){console.error("Error updating Weekly Review after settings change:",a)}}getWeeklyReviewPath(t){let r=bo(t),n=r.getFullYear(),o=String(r.getMonth()+1).padStart(2,"0"),a=ss(r),i=`${a}-Review.md`;return(0,tu.normalizePath)(`${this.getJournalFolderPath()}/${n}/${o}/${a}/${i}`)}async ensureDirectoryExists(t){let r=t.substring(0,t.lastIndexOf("/"));await this.app.vault.adapter.exists(r)||await this.app.vault.adapter.mkdir(r)}async createWeeklyReview(t){try{let r=this.getWeeklyReviewPath(t);if(await this.app.vault.adapter.exists(r))return r;await this.ensureDirectoryExists(r);let o=await this.generateInitialWeeklyReviewContent(t),a=await this.app.vault.create(r,o);return await yr(this.app,a),Dce(r),r}catch(r){throw console.error("Error creating weekly review:",r),r}}formatDateForDisplay(t){let r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0");return`${r}-${n}-${o}`}generateWeeklyReviewTags(t){let r=[],n=bo(t);r.push([Fb(Mb.WEEKLY)]);let o=Ob(n);return o.length>0&&r.push(o),jb(...r)}async generateInitialWeeklyReviewContent(t){let r=bo(t),n=r.getFullYear(),o=String(r.getMonth()+1).padStart(2,"0"),a=ss(r),i={type:"weekly-review",date:this.formatDateForDisplay(r),created:new Date().toISOString(),tags:this.generateWeeklyReviewTags(t),week:a,month:o,year:n.toString(),reviewQuestions:{},forecast:{monthly:{notes:""},weekly:{notes:""},daily:{notes:""}},keyEvents:[]};this.plugin.settings.weekly&&this.plugin.settings.weekly.reviewQuestions?this.plugin.settings.weekly.reviewQuestions.forEach(l=>{i.reviewQuestions&&(i.reviewQuestions[l]="")}):["What worked well this week?","What didn't work this week?","Which setups were most profitable?","What mistakes cost me the most money?","What could I improve for next week?"].forEach(c=>{i.reviewQuestions&&(i.reviewQuestions[c]="")});try{let l=new Date(r);l.setDate(l.getDate()-7);let c=this.getWeeklyReviewPath(l);if(await this.app.vault.adapter.exists(c)){let d=this.app.vault.getAbstractFileByPath(c);if(d instanceof tu.TFile){await yr(this.app,d);let u=await this.extractWeeklyReviewData(d);u&&u.nextWeekGoals&&(i.previousGoals=u.nextWeekGoals)}}}catch(l){console.error("Error getting previous week goals:",l)}return[...["---",`type: ${i.type}`,...this.convertToYamlFrontmatter(i),"---"],`# Weekly Review - ${a}, ${o}/${n}`,""].join(`
`)}convertToYamlFrontmatter(t){let r=[],n=o=>o==null?"null":typeof o=="string"?o.includes(":")||o.includes("#")||o.includes(`
`)||o.includes('"')||o.trim()===""?`"${o.replace(/"/g,'\\"')}"`:o:typeof o=="number"||typeof o=="boolean"?String(o):Array.isArray(o)||typeof o=="object"?JSON.stringify(o):String(o);for(let[o,a]of Object.entries(t))o!=="type"&&a!==void 0&&r.push(`${o}: ${n(a)}`);return r}async extractWeeklyReviewData(t){var r;try{let n=(r=this.app.metadataCache.getFileCache(t))==null?void 0:r.frontmatter;return!n||n.type!=="weekly-review"?null:n}catch(n){return console.error("Error extracting Weekly Review data:",n),null}}async updateWeeklyReviewFrontmatter(t,r){try{let n=this.app.vault.getAbstractFileByPath(t);if(!n||!(n instanceof tu.TFile))throw new Error(`Weekly Review file not found: ${t}`);await this.app.fileManager.processFrontMatter(n,o=>{Object.assign(o,r)}),await yr(this.app,n),uL(t),r.nextWeekGoals!==void 0&&await this.syncGoalsToNextWeek(t,r.nextWeekGoals);return}catch(n){throw console.error(`Error updating Weekly Review frontmatter in ${t}:`,n),n}}async syncGoalsToNextWeek(t,r){try{let n=this.app.vault.getAbstractFileByPath(t);if(!n||!(n instanceof tu.TFile))return;let o=await this.extractWeeklyReviewData(n);if(!(o!=null&&o.date))return;let a=o.date.split("-").map(d=>parseInt(d,10)),i=new Date(a[0],a[1]-1,a[2]),s=new Date(i);s.setDate(s.getDate()+7);let l=this.getWeeklyReviewPath(s),c=this.app.vault.getAbstractFileByPath(l);c instanceof tu.TFile&&(await this.app.fileManager.processFrontMatter(c,d=>{d.previousGoals=r||[]}),await yr(this.app,c),uL(l))}catch(n){console.warn("Warning: Failed to sync goals to next week:",n)}}async getDRCsForWeek(t){var r;try{let n=bo(t),o=new Date(n);o.setDate(o.getDate()+6);let a=this.formatDateForDisplay(n),i=this.formatDateForDisplay(o),s=this.app.vault.getMarkdownFiles(),l=[];for(let c of s){let d=(r=this.app.metadataCache.getFileCache(c))==null?void 0:r.frontmatter;if(!d||d.type!=="drc")continue;let u=d.date;u&&u>=a&&u<=i&&l.push({file:c,data:d})}return l.sort((c,d)=>c.data.date.localeCompare(d.data.date)),l}catch(n){return console.error("Error getting DRCs for week:",n),[]}}async getTradesForWeek(t){var r;try{let n=bo(t),o=new Date(n);o.setDate(o.getDate()+6),o.setHours(23,59,59,999);let a=this.formatDateForDisplay(n),i=this.formatDateForDisplay(o),s=this.app.vault.getMarkdownFiles(),l=[];for(let c of s){let d=(r=this.app.metadataCache.getFileCache(c))==null?void 0:r.frontmatter;if(!(!d||d.type!=="trade"&&d.type!=="backtest-trade")){if(d.entryTime){let u=new Date(d.entryTime),p=lr(u,this.plugin),m=this.formatDateForDisplay(p);m>=a&&m<=i&&l.push(c)}else if(d.date){let u=Mt(d.date);if(!u)continue;let p=this.formatDateForDisplay(u);p>=a&&p<=i&&l.push(c)}}}return l}catch(n){return console.error("Error getting trades for week:",n),[]}}async openWeeklyReview(t){try{let r=bo(t),n=ss(r),o=String(r.getMonth()+1).padStart(2,"0"),a=r.getFullYear().toString(),i=null;if(this.app.workspace.iterateAllLeaves(c=>{var d;if(c.view instanceof tu.FileView&&c.view.file){let u=(d=this.app.metadataCache.getFileCache(c.view.file))==null?void 0:d.frontmatter;if((u==null?void 0:u.type)==="weekly-review"&&u.week===n&&u.month===o&&u.year===a)return i=c,!0}}),i){this.app.workspace.revealLeaf(i);return}let s=this.getWeeklyReviewPath(t);await this.app.vault.adapter.exists(s)?await this.plugin.openFile(s,!0):(await this.createWeeklyReview(t),await this.plugin.openFile(s,!0))}catch(r){throw console.error(`Failed to open weekly review for date ${t.toDateString()}:`,r),r}}getNextWeekReviewPath(t){let r=bo(t),n=new Date(r);return n.setDate(n.getDate()+7),this.getWeeklyReviewPath(n)}getPreviousWeekReviewPath(t){let r=bo(t),n=new Date(r);return n.setDate(n.getDate()-7),this.getWeeklyReviewPath(n)}async getAdjacentWeeklyReview(t,r,n){var o,a,i;try{let s=r<0?this.getPreviousWeekReviewPath(t):this.getNextWeekReviewPath(t);if(await this.app.vault.adapter.exists(s))return s;if((i=n!=null?n:(a=(o=this.plugin.settings)==null?void 0:o.weekly)==null?void 0:a.autoCreateWeeklyReviewOnNavigation)!=null?i:!0){let d=bo(t),u;return r<0?(u=new Date(d),u.setDate(u.getDate()-7)):(u=new Date(d),u.setDate(u.getDate()+7)),await this.createWeeklyReview(u),s}return null}catch(s){return console.error("Error getting adjacent weekly review:",s),null}}async saveWeeklyReviewImage(t,r,n){try{let o=bo(r),a=o.getFullYear(),i=String(o.getMonth()+1).padStart(2,"0"),s=ss(o),l=n.replace(/[^a-zA-Z0-9]/g,""),c=`${this.getJournalFolderPath()}/${a}/${i}/${s}/media`;return await In.saveImage(t,c,`${s}-${l}`,void 0)}catch(o){throw console.error("Error saving weekly review image:",o),o}}async saveWeeklyReviewImages(t,r,n){try{let o=[];for(let a of t){let i=await this.saveWeeklyReviewImage(a,r,n);o.push(i)}return o}catch(o){throw console.error("Error saving multiple weekly review images:",o),o}}async deleteImage(t){try{await In.deleteImage(t,!0)}catch(r){throw console.error(`Error deleting image ${t}:`,r),r}}async deleteEmptyFolder(t){try{await In.deleteEmptyFolder(t,this.getJournalFolderPath())}catch(r){console.error(`Error deleting empty folder ${t}:`,r)}}getMonthlyReviewPath(t){let r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),o=`${n}-Review.md`;return(0,tu.normalizePath)(`${this.getJournalFolderPath()}/${r}/${n}/${o}`)}}});function hh(e){let t=n=>{if(n==null||n==="")return;let o=parseFloat(n);return Number.isFinite(o)?o:void 0},r=n=>{if(n==null||n==="")return 0;let o=parseFloat(n);return Number.isFinite(o)?o:0};return{rMultiple:t(e.rMultiple),riskAmount:t(e.riskAmount),stopLoss:t(e.stopLoss),commission:r(e.commission),swap:r(e.swap),fees:r(e.fees)}}var mL=L(()=>{});var Kc,fL,Ace=L(()=>{Kc=require("obsidian");rf();wt();ci();ls();zb();mL();fL=class extends Qi{constructor(r,n,o,a={}){super(r,{...a,namespace:"monthly-reviews",cacheTTL:300*1e3,persistCache:!0});this.folderPathService=null;this.lastCacheClear=0;this.monthlyDataCache=new Map;this.setPlugin(n),this.folderPathService=o||null,this.folderPathService||this.initializeFolderPathService(),document.addEventListener("journalit:monthly-review-opened",async()=>{let i=Date.now();(!this.lastCacheClear||i-this.lastCacheClear>5e3)&&(await this.clearCache(),this.monthlyDataCache.clear(),this.lastCacheClear=i)})}getPlugin(){if(!this.plugin)throw new Error("Plugin not initialized");return this.plugin}async initializeFolderPathService(){var r;try{(r=this.getPlugin())!=null&&r.serviceManager&&(this.folderPathService=await this.getPlugin().serviceManager.getFolderPathService())}catch(n){console.warn("Could not initialize FolderPathService:",n),this.folderPathService=null}}defaultFrontmatter(){let r=new Date;return{type:"monthly-review",date:r.toISOString(),month:r.getMonth()+1,year:r.getFullYear(),reviewQuestions:{},monthlyGoals:[],keyFocusAreas:[],biggestAccomplishment:"",biggestChallenge:"",lessonsLearned:[],nextMonthGoals:[],areasOfImprovement:[]}}getCacheNamespace(){return"monthly-reviews"}isValidType(r){return(r==null?void 0:r.type)==="monthly-review"}async clearCache(){await super.clearCache(),this.monthlyDataCache.clear()}async ensureDirectoryExists(r){let n=r.substring(0,r.lastIndexOf("/"));await this.app.vault.adapter.exists(n)||await this.app.vault.createFolder(n)}getJournalFolderPath(){return this.folderPathService?this.folderPathService.journalFolderPath:"!Journalit"}getMonthlyReviewPath(r){let n=r.getFullYear(),o=(r.getMonth()+1).toString().padStart(2,"0");return(0,Kc.normalizePath)(`${this.getJournalFolderPath()}/${n}/${o}/${o}-Review.md`)}async createMonthlyReview(r){let n=this.getMonthlyReviewPath(r),o=this.app.vault.getAbstractFileByPath(n);if(o instanceof Kc.TFile)return o;await this.ensureDirectoryExists(n);let a={...this.defaultFrontmatter(),date:r.toISOString(),month:r.getMonth()+1,year:r.getFullYear()},i=this.generateInitialContent(a);try{return await this.app.vault.create(n,i)}catch(s){return console.error("Error creating monthly review:",s),null}}async openMonthlyReview(r){if(!(r instanceof Date)||isNaN(r.getTime())){console.error("Invalid date passed to openMonthlyReview:",r);return}try{let n=r.getMonth()+1,o=r.getFullYear(),a=null;if(this.app.workspace.iterateAllLeaves(l=>{var c;if(l.view instanceof Kc.FileView&&l.view.file){let d=l.view.file,u=(c=this.app.metadataCache.getFileCache(d))==null?void 0:c.frontmatter;(u==null?void 0:u.type)==="monthly-review"&&Number(u==null?void 0:u.month)===n&&Number(u==null?void 0:u.year)===o&&(a=l)}}),a){this.app.workspace.revealLeaf(a);return}let i=this.getMonthlyReviewPath(r);if(await this.app.vault.adapter.exists(i))await this.getPlugin().openFile(i,!0);else{let l=await this.createMonthlyReview(r);if(l)await this.getPlugin().openFile(l.path,!0);else throw new Error(`Failed to create monthly review for ${r.toDateString()}. Check console for details.`)}}catch(n){throw console.error(`Failed to open monthly review for date ${r.toDateString()}:`,n),n}}generateMonthlyReviewTags(r,n){let o=[],a=new Date(n,r-1,1);o.push([Fb(Mb.MONTHLY)]);let i=Ob(a);i.length>0&&o.push(i);let s=Math.ceil(r/3);return o.push([`q${s}-review`]),r===1?o.push(["year-start"]):r===12&&o.push(["year-end"]),jb(...o)}generateInitialContent(r){let n=new Date(r.year,r.month-1).toLocaleDateString("en-US",{month:"long"}),o=this.generateMonthlyReviewTags(r.month,r.year);return`---
type: ${r.type}
date: ${r.date}
month: ${r.month}
year: ${r.year}
tags: [${o.map(a=>`"${a}"`).join(", ")}]
reviewQuestions: {}
monthlyGoals: []
keyFocusAreas: []
biggestAccomplishment: ""
biggestChallenge: ""
lessonsLearned: []
nextMonthGoals: []
areasOfImprovement: []
---

# ${n} ${r.year} Review

## Overview
*Monthly performance metrics and analysis will appear here.*

## Review
*Reflect on your trading performance and lessons learned this month.*

## Goals for Next Month
*Set clear, actionable goals for the upcoming month.*
`}async getMonthlyTrades(r,n){try{let o=new Date(r,n-1,1);new Date(r,n,0).setHours(23,59,59,999);let i=[],s=this.app.vault.getMarkdownFiles();for(let l of s)try{let c=this.app.metadataCache.getFileCache(l),d=c==null?void 0:c.frontmatter;if(((d==null?void 0:d.type)==="trade"||(d==null?void 0:d.type)==="backtest-trade")&&d.entryTime){let u=new Date(d.entryTime);if(isNaN(u.getTime()))continue;let p=lr(u,this.plugin);if(p.getFullYear()===r&&p.getMonth()+1===n){let m=d.exitTime?new Date(d.exitTime):u,f=d.pnl===void 0||d.pnl===null,g={instrument:d.instrument||d.ticker,direction:d.direction||d.side,entryTime:u,exitTime:m,entryPrice:parseFloat(d.entryPrice)||0,exitPrice:d.exitPrice!==void 0&&d.exitPrice!==null?parseFloat(d.exitPrice):0,positionSize:parseFloat(d.positionSize)||0,pnl:d.pnl!==void 0&&d.pnl!==null?d.pnl:0,setup:d.setup,tags:d.tags,mistake:d.mistake,account:Array.isArray(d.account)?d.account:d.account?[d.account]:[],accountIds:Array.isArray(d.accountIds)?d.accountIds:d.accountIds?[d.accountIds]:[],path:l.path,tradeStatus:d.tradeStatus,useDirectPnLInput:d.useDirectPnLInput,exits:d.exits,entries:d.entries,_originalPnlWasNull:f,...hh(d)};i.push(g)}}}catch(c){console.warn(`Error processing trade file ${l.path}:`,c);continue}return i}catch(o){return console.error("Error getting monthly trades:",o),[]}}async getWeeklyPerformance(r,n){var o,a;try{let i=await this.getMonthlyTrades(r,n);if(i.length===0)return console.log(`No trades found for ${r}-${String(n).padStart(2,"0")}`),[];let s=new Map,l=(o=this.getPlugin())!=null&&o.serviceManager?await this.getPlugin().serviceManager.getWeeklyReviewService():(a=this.getPlugin())==null?void 0:a.weeklyReviewService;return i.forEach(c=>{let d=new Date(c.entryTime),u=bo(d),p=this.getWeekNumber(d);if(d.getMonth()+1!==n)return;if(!s.has(p)){let f=new Date(u);f.setDate(f.getDate()+6);let g;l&&(g=l.getWeeklyReviewPath(u)),s.set(p,{weekNumber:p,weekStartDate:u,weekEndDate:f,trades:0,winRate:0,profitFactor:0,pnl:0,weeklyReviewPath:g})}let m=s.get(p);m.trades++,m.pnl+=c.pnl||0}),s.forEach((c,d)=>{let u=i.filter(v=>{let h=new Date(v.entryTime);return this.getWeekNumber(h)===d&&h.getMonth()+1===n}),p=u.filter(v=>(v.pnl||0)>0),m=u.filter(v=>(v.pnl||0)<0);c.winRate=u.length>0?p.length/u.length:0;let f=p.reduce((v,h)=>v+(h.pnl||0),0),g=Math.abs(m.reduce((v,h)=>v+(h.pnl||0),0));c.profitFactor=g>0?f/g:f>0?1/0:0}),Array.from(s.values()).sort((c,d)=>c.weekNumber-d.weekNumber)}catch(i){return console.error("Error getting weekly performance:",i),[]}}getWeekNumber(r){let n=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate())),o=n.getUTCDay()||7;n.setUTCDate(n.getUTCDate()+4-o);let a=new Date(Date.UTC(n.getUTCFullYear(),0,1));return Math.ceil(((n.getTime()-a.getTime())/864e5+1)/7)}async getDemonTrackerData(r,n){var o,a,i;try{let s=(o=this.getPlugin())==null?void 0:o.drcService;if(!s&&((a=this.getPlugin())!=null&&a.serviceManager))try{s=await this.getPlugin().serviceManager.getDRCService()}catch(u){console.warn("Could not get DRC service:",u)}if(!s)return console.log("DRC service not available for demon tracker data"),[];let l=new Date(r,n-1,1),c=new Date(r,n,0),d=new Map;for(let u=new Date(l);u<=c;u.setDate(u.getDate()+1)){let p=s.getDRCNotePath(new Date(u)),m=this.app.vault.getAbstractFileByPath(p);if(m instanceof Kc.TFile){let f=this.app.metadataCache.getFileCache(m),g=f==null?void 0:f.frontmatter;if(g&&g.type==="drc"){let v=(i=this.getPlugin())==null?void 0:i.tradeService;if(v){let h=new Date(u);h.setHours(0,0,0,0);let y=new Date(u);y.setHours(23,59,59,999);let b=await v.getTrades(h,y),x=[];for(let w of b){let S=await v.extractTradeData(w);S&&x.push(S)}x.forEach(w=>{w.mistake&&Array.isArray(w.mistake)&&w.mistake.forEach(S=>{d.has(S)||d.set(S,{mistake:S,occurrences:0,dates:[]});let k=d.get(S);k.occurrences++,k.dates.push(u.toISOString())})})}}}}return Array.from(d.values()).sort((u,p)=>p.occurrences-u.occurrences)}catch(s){return console.error("Error getting demon tracker data:",s),[]}}async getAdjacentMonthlyReview(r,n,o=!0){var c,d;let a=new Date(r);a.setMonth(a.getMonth()+n);let i=this.getMonthlyReviewPath(a);if(this.app.vault.getAbstractFileByPath(i)instanceof Kc.TFile)return i;let l=(c=this.getPlugin())==null?void 0:c.settings;if(o&&((d=l==null?void 0:l.monthly)!=null&&d.autoCreateMonthlyReviewOnNavigation)){let u=await this.createMonthlyReview(a);return u?u.path:null}return null}async getBestPerformingWeek(r,n){let o=await this.getWeeklyPerformance(r,n);return o.length===0?null:o.reduce((a,i)=>i.pnl>a.pnl?i:a)}async getWorstPerformingWeek(r,n){let o=await this.getWeeklyPerformance(r,n);return o.length===0?null:o.reduce((a,i)=>i.pnl<a.pnl?i:a)}async getWeeklyGamePerformance(r,n){var o,a,i,s;try{let l=await this.getWeeklyPerformance(r,n),c=(o=this.getPlugin())!=null&&o.serviceManager?await this.getPlugin().serviceManager.getWeeklyReviewService():(a=this.getPlugin())==null?void 0:a.weeklyReviewService,d=(i=this.getPlugin())!=null&&i.serviceManager?await this.getPlugin().serviceManager.getDRCService():(s=this.getPlugin())==null?void 0:s.drcService;if(!c||!d)return console.warn("Weekly or DRC service not available for game performance data"),[];let u=[];for(let p of l){let m={A:0,B:0,C:0},f={A:0,B:0,C:0},g=await c.getDRCsForWeek(p.weekStartDate);for(let{data:x}of g){let w=Mt(x.date);w&&w.getMonth()+1===n&&w.getFullYear()===r&&(x.mentalGrade&&["A","B","C"].includes(x.mentalGrade)&&m[x.mentalGrade]++,x.technicalGrade&&["A","B","C"].includes(x.technicalGrade)&&f[x.technicalGrade]++)}let v,h,y,b;if(p.weeklyReviewPath){let x=this.app.vault.getAbstractFileByPath(p.weeklyReviewPath);if(x instanceof Kc.TFile){let w=await c.extractWeeklyReviewData(x);w&&(v=w.mentalGrade,h=w.technicalGrade,y=w.mentalNotes,b=w.technicalNotes)}}u.push({weekNumber:p.weekNumber,weekStartDate:p.weekStartDate,weekEndDate:p.weekEndDate,weeklyReviewPath:p.weeklyReviewPath,mentalGradeDistribution:m,technicalGradeDistribution:f,mentalRating:v,technicalRating:h,mentalNotes:y,technicalNotes:b})}return u}catch(l){return console.error("Error getting weekly game performance:",l),[]}}async getMonthlyDataOptimized(r,n){let o=`${r}-${n}`,a=this.monthlyDataCache.get(o);if(a&&Date.now()-a.timestamp<300*1e3)return a.data;try{let i=await this.getMonthlyTradesOptimized(r,n),s=await this.calculateWeeklyPerformance(i,r,n),l=this.getDemonTrackerDataFromTrades(i),c=await this.getWeeklyGamePerformanceOptimized(s,r,n),d=s.length>0?s.reduce((m,f)=>f.pnl>m.pnl?f:m):null,u=s.length>0?s.reduce((m,f)=>f.pnl<m.pnl?f:m):null,p={trades:i,weeklyPerformance:s,weeklyGamePerformance:c,demonTrackerData:l,bestWeek:d,worstWeek:u};return this.monthlyDataCache.set(o,{data:p,timestamp:Date.now()}),p}catch(i){return console.error("Error getting optimized monthly data:",i),{trades:[],weeklyPerformance:[],weeklyGamePerformance:[],demonTrackerData:[],bestWeek:null,worstWeek:null}}}async getMonthlyTradesOptimized(r,n){try{let o=[],a=`${this.getJournalFolderPath()}/${r}/${String(n).padStart(2,"0")}`,i=this.app.vault.getMarkdownFiles().filter(l=>l.path.startsWith(a)&&l.path.includes("/trades/")),s=20;for(let l=0;l<i.length;l+=s){let d=i.slice(l,l+s).map(async p=>{try{let m=this.app.metadataCache.getFileCache(p),f=m==null?void 0:m.frontmatter;if(((f==null?void 0:f.type)==="trade"||(f==null?void 0:f.type)==="backtest-trade")&&f.entryTime){let g=new Date(f.entryTime);if(isNaN(g.getTime()))return null;let v=lr(g,this.plugin);if(v.getFullYear()===r&&v.getMonth()+1===n){let h=f.exitTime?new Date(f.exitTime):g,y=f.pnl===void 0||f.pnl===null;return{instrument:f.instrument||f.ticker,direction:f.direction||f.side,entryTime:g,exitTime:h,entryPrice:parseFloat(f.entryPrice)||0,exitPrice:f.exitPrice!==void 0&&f.exitPrice!==null?parseFloat(f.exitPrice):0,positionSize:parseFloat(f.positionSize)||0,pnl:f.pnl!==void 0&&f.pnl!==null?f.pnl:0,setup:f.setup,tags:f.tags,mistake:f.mistake,account:Array.isArray(f.account)?f.account:f.account?[f.account]:[],accountIds:Array.isArray(f.accountIds)?f.accountIds:f.accountIds?[f.accountIds]:[],path:p.path,tradeStatus:f.tradeStatus,useDirectPnLInput:f.useDirectPnLInput,exits:f.exits,entries:f.entries,_originalPnlWasNull:y,...hh(f)}}}return null}catch(m){return console.warn(`Error processing trade file ${p.path}:`,m),null}}),u=await Promise.all(d);o.push(...u.filter(p=>p!==null))}return o}catch(o){return console.error("Error getting optimized monthly trades:",o),[]}}async calculateWeeklyPerformance(r,n,o){var a,i;try{if(r.length===0)return[];let s=new Map,l=(a=this.getPlugin())!=null&&a.serviceManager?await this.getPlugin().serviceManager.getWeeklyReviewService():(i=this.getPlugin())==null?void 0:i.weeklyReviewService;return r.forEach(c=>{let d=new Date(c.entryTime),u=bo(d),p=this.getWeekNumber(d);if(d.getMonth()+1!==o)return;if(!s.has(p)){let f=new Date(u);f.setDate(f.getDate()+6);let g;l&&(g=l.getWeeklyReviewPath(u)),s.set(p,{weekNumber:p,weekStartDate:u,weekEndDate:f,trades:0,winRate:0,profitFactor:0,pnl:0,weeklyReviewPath:g})}let m=s.get(p);m.trades++,m.pnl+=c.pnl||0}),s.forEach((c,d)=>{let u=r.filter(v=>{let h=new Date(v.entryTime);return this.getWeekNumber(h)===d&&h.getMonth()+1===o}),p=u.filter(v=>(v.pnl||0)>0),m=u.filter(v=>(v.pnl||0)<0);c.winRate=u.length>0?p.length/u.length:0;let f=p.reduce((v,h)=>v+(h.pnl||0),0),g=Math.abs(m.reduce((v,h)=>v+(h.pnl||0),0));c.profitFactor=g>0?f/g:f>0?1/0:0}),Array.from(s.values()).sort((c,d)=>c.weekNumber-d.weekNumber)}catch(s){return console.error("Error calculating weekly performance:",s),[]}}async getWeeklyGamePerformanceOptimized(r,n,o){var a,i,s,l;try{let c=(a=this.getPlugin())!=null&&a.serviceManager?await this.getPlugin().serviceManager.getWeeklyReviewService():(i=this.getPlugin())==null?void 0:i.weeklyReviewService,d=(s=this.getPlugin())!=null&&s.serviceManager?await this.getPlugin().serviceManager.getDRCService():(l=this.getPlugin())==null?void 0:l.drcService;if(!c||!d)return[];let u=r.map(async p=>{let m={A:0,B:0,C:0},f={A:0,B:0,C:0},g=await c.getDRCsForWeek(p.weekStartDate);for(let{data:x}of g){let w=Mt(x.date);w&&w.getMonth()+1===o&&w.getFullYear()===n&&(x.mentalGrade&&["A","B","C"].includes(x.mentalGrade)&&m[x.mentalGrade]++,x.technicalGrade&&["A","B","C"].includes(x.technicalGrade)&&f[x.technicalGrade]++)}let v,h,y,b;if(p.weeklyReviewPath){let x=this.app.vault.getAbstractFileByPath(p.weeklyReviewPath);if(x instanceof Kc.TFile){let w=await c.extractWeeklyReviewData(x);w&&(v=w.mentalGrade,h=w.technicalGrade,y=w.mentalNotes,b=w.technicalNotes)}}return{weekNumber:p.weekNumber,weekStartDate:p.weekStartDate,weekEndDate:p.weekEndDate,weeklyReviewPath:p.weeklyReviewPath,mentalGradeDistribution:m,technicalGradeDistribution:f,mentalRating:v,technicalRating:h,mentalNotes:y,technicalNotes:b}});return await Promise.all(u)}catch(c){return console.error("Error getting optimized weekly game performance:",c),[]}}getDemonTrackerDataFromTrades(r){try{let n=new Map;return r.forEach(o=>{o.mistake&&Array.isArray(o.mistake)&&o.mistake.forEach(a=>{n.has(a)||n.set(a,{mistake:a,occurrences:0,dates:[]});let i=n.get(a);i.occurrences++,i.dates.push(o.entryTime.toISOString())})}),Array.from(n.values()).sort((o,a)=>a.occurrences-o.occurrences)}catch(n){return console.error("Error processing demon tracker data from trades:",n),[]}}async updateMonthlyReviewFrontmatter(r,n){try{let o=this.app.vault.getAbstractFileByPath(r);if(!o||!(o instanceof Kc.TFile))throw new Error(`Monthly Review file not found: ${r}`);await this.app.fileManager.processFrontMatter(o,a=>{Object.assign(a,n)}),await yr(this.app,o),await this.clearCache(),this.monthlyDataCache.clear();return}catch(o){throw console.error(`Error updating Monthly Review frontmatter in ${r}:`,o),o}}}});var UR,gL,Lce=L(()=>{UR=require("obsidian");Sc();$f();gL=class{constructor(t,r){this.fields={...Bf};this.fieldOptions={};this.namespace="";this.plugin=t,r!=null&&r.namespace&&(this.namespace=r.namespace),this.loadFields(),this.loadFieldOptions()}getFieldsKey(){return this.namespace?`customTradeFields_${this.namespace}`:"customTradeFields"}loadFields(){try{let t=this.getFieldsKey(),r=this.plugin;if(r.settings&&r.settings[t]){let n={...Bf,...r.settings[t]};this.fields.fields=(n.fields||[]).filter(o=>this.isValidFieldDefinition(o)).sort((o,a)=>o.order-a.order)}else if(!this.namespace&&r.settings&&r.settings.customTradeFields){let n={...Bf,...r.settings.customTradeFields};this.fields.fields=(n.fields||[]).filter(o=>this.isValidFieldDefinition(o)).sort((o,a)=>o.order-a.order)}}catch(t){Pe.logError(t,Pe.createContext("load custom fields")),this.fields={...Bf}}}isValidFieldDefinition(t){return t&&typeof t.id=="string"&&typeof t.label=="string"&&typeof t.type=="string"&&Object.values(uv).includes(t.type)&&typeof t.order=="number"}validateRegexPattern(t){if(!t)return!0;try{let r=[/\(\?\!\.\*\)\.\*/,/\(\.\*\)\+/,/\.\*\.\*/,/\(\.\+\)\+/,/\(\?\!\.\+\)\.\+/];for(let a of r)if(a.test(t))return!1;let n=Date.now();return new RegExp(t),!(Date.now()-n>50)}catch(r){return console.warn("[CustomFieldsService] Invalid regex pattern:",t,r),!1}}async saveFields(){try{let t=this.getFieldsKey(),r=this.plugin;if(r.settings)r.settings[t]={...this.fields},await r.saveSettings();else{let o={...await this.plugin.loadData()||{},[t]:this.fields};await this.plugin.saveData(o)}this.plugin.app.workspace.trigger("journalit-custom-fields-changed",this.fields)}catch(t){throw Pe.logError(t,Pe.createContext("save custom fields")),t}}getFields(){return[...this.fields.fields].sort((t,r)=>t.order-r.order)}getField(t){return this.fields.fields.find(r=>r.id===t)}async addField(t){var a;let r=t.label||"New Field",n=this.fields.fields.map(i=>i.fieldKey||rm(i.label));if((a=t.validation)!=null&&a.pattern&&!this.validateRegexPattern(t.validation.pattern)){let i=new Error(`Invalid or potentially dangerous regex pattern: ${t.validation.pattern}`);throw Pe.logError(i,Pe.createContext("validate field pattern")),i}let o={id:t.id||KF(),label:r,fieldKey:t.fieldKey||pv(r,n),type:t.type||"text",validation:t.validation||{},options:t.options||[],allowCreateOptions:t.allowCreateOptions,placeholder:t.placeholder,helperText:t.helperText,order:t.order||Date.now()};return this.fields.fields.push(o),await this.saveFields(),o}async updateField(t,r){var o;let n=this.fields.fields.findIndex(a=>a.id===t);if(n===-1)return console.error(`Field with ID ${t} not found`),null;if((o=r.validation)!=null&&o.pattern&&!this.validateRegexPattern(r.validation.pattern)){let a=new Error(`Invalid or potentially dangerous regex pattern: ${r.validation.pattern}`);throw Pe.logError(a,Pe.createContext("validate field pattern update")),a}if(r.fieldKey!==void 0){let a=EC(r.fieldKey);if(a)throw new Error(`Invalid field key: ${a}`);if(this.fields.fields.filter((l,c)=>c!==n).map(l=>l.fieldKey||rm(l.label)).includes(r.fieldKey)){let l=new Error(`Field key '${r.fieldKey}' is already in use by another custom field`);throw Pe.logError(l,Pe.createContext("validate field key uniqueness")),l}}return this.fields.fields[n]={...this.fields.fields[n],...r,id:t},await this.saveFields(),this.fields.fields[n]}async removeField(t){let r=this.fields.fields.length;return this.fields.fields=this.fields.fields.filter(n=>n.id!==t),this.fields.fields.length<r?(await this.saveFields(),await this.removeAllFieldOptions(t),!0):!1}async reorderFields(t){let r=new Map(this.fields.fields.map(o=>[o.id,o])),n=[];t.forEach((o,a)=>{let i=r.get(o);i&&(n.push({...i,order:a}),r.delete(o))}),r.forEach(o=>{n.push({...o,order:n.length})}),this.fields.fields=n,await this.saveFields()}validateFieldValues(t){let r={};return this.fields.fields.forEach(n=>{let o=t[n.id],a=IC(o,n);a&&(r[n.id]=a)}),r}getFieldsByType(t){return this.getFields().filter(r=>r.type===t)}hasFields(){return this.fields.fields.length>0}async resetFields(){this.fields.fields=[],await this.saveFields()}exportFields(){return JSON.stringify(this.fields,null,2)}async importFields(t){try{let r=JSON.parse(t);if(!r.fields||!Array.isArray(r.fields))throw new Error("Invalid custom fields data format");let n=r.fields.filter(o=>{var a;return this.isValidFieldDefinition(o)?(a=o.validation)!=null&&a.pattern&&!this.validateRegexPattern(o.validation.pattern)?(console.warn(`Skipping field "${o.label}" due to invalid or dangerous regex pattern: ${o.validation.pattern}`),!1):!0:!1});n.length!==r.fields.length&&new UR.Notice(`Imported ${n.length} valid fields out of ${r.fields.length} total`),this.fields.fields=n.sort((o,a)=>o.order-a.order),await this.saveFields(),new UR.Notice(`Successfully imported ${n.length} custom fields`)}catch(r){throw Pe.logError(r,Pe.createContext("import custom fields")),r}}getFieldOptionsKey(){return this.namespace?`customFieldOptions_${this.namespace}`:"customFieldOptions"}loadFieldOptions(){try{let t=this.getFieldOptionsKey(),r=this.plugin;r.settings&&r.settings[t]?this.fieldOptions={...r.settings[t]}:this.fieldOptions={}}catch(t){Pe.logError(t,Pe.createContext("load custom field options")),this.fieldOptions={}}}async saveFieldOptions(){try{let t=this.getFieldOptionsKey(),r=this.plugin;if(r.settings)r.settings[t]={...this.fieldOptions},await r.saveSettings();else{let o={...await this.plugin.loadData()||{},[t]:this.fieldOptions};await this.plugin.saveData(o)}}catch(t){throw Pe.logError(t,Pe.createContext("save custom field options")),t}}getFieldOptions(t){return this.fieldOptions[t]||[]}async addFieldOption(t,r){let n=r.trim();return!n||(this.fieldOptions[t]||(this.fieldOptions[t]=[]),this.fieldOptions[t].some(a=>a.toLowerCase()===n.toLowerCase()))?!1:(this.fieldOptions[t].push(n),await this.saveFieldOptions(),!0)}async removeFieldOption(t,r){if(!this.fieldOptions[t])return!1;let n=this.fieldOptions[t].length;this.fieldOptions[t]=this.fieldOptions[t].filter(a=>a.toLowerCase()!==r.toLowerCase());let o=n!==this.fieldOptions[t].length;return o&&await this.saveFieldOptions(),o}async removeAllFieldOptions(t){this.fieldOptions[t]&&(delete this.fieldOptions[t],await this.saveFieldOptions())}getFieldsWithCustomOptions(){return this.getFields().filter(t=>(t.type==="dropdown"||t.type==="multiselect")&&t.allowCreateOptions)}}});var yt,DS,_ze,hL,Nce=L(()=>{yt=q(Y()),DS=require("obsidian");di();Au();Nr();Kw();wt();_ze=({accountInfo:e,existingAccounts:t=[],availableAccountTypes:r=[],onLink:n,onCancel:o})=>{let a=t.length>0?"existing":"new",[i,s]=(0,yt.useState)(a),[l,c]=(0,yt.useState)(!1),[d,u]=(0,yt.useState)(""),[p,m]=(0,yt.useState)(""),[f,g]=(0,yt.useState)(r.length>0?r[0]:"demo"),[v,h]=(0,yt.useState)(!1),y=(0,yt.useMemo)(()=>t.length>0,[t]),b=w=>{s(w),c(!0),w!=="existing"&&m("")};yt.default.useEffect(()=>{r.length>0&&!r.includes(f)&&g(r[0])},[r,f]),yt.default.useEffect(()=>{l||s(y?"existing":"new")},[y,l]);let x=async()=>{var w;h(!0);try{let S="",k,T;switch(i){case"new":S=d||`Account-${e.accountId}`,T=f;break;case"existing":if(!p){new DS.Notice("Please select an existing account"),h(!1);return}k=p,S=((w=t.find(P=>P.path===p))==null?void 0:w.name)||"";break;case"default":S=`Account-${e.accountId}`,T=f;break}await n(e.accountId,S,k,T)}catch(S){console.error("Failed to link account:",S),new DS.Notice("Failed to link account: "+S.message)}finally{h(!1)}};return yt.default.createElement("div",{className:"account-link-modal"},yt.default.createElement("h3",null,"New Trading Account Detected"),yt.default.createElement("div",{className:"account-info"},yt.default.createElement("p",null,yt.default.createElement("strong",null,"Account ID:")," ",e.accountId),e.brokerName&&yt.default.createElement("p",null,yt.default.createElement("strong",null,"Broker:")," ",e.brokerName),e.firstSeen&&yt.default.createElement("p",null,yt.default.createElement("strong",null,"First Seen:")," ",rt(new Date(e.firstSeen),tr()))),yt.default.createElement("div",{className:"link-options"},yt.default.createElement("div",{className:"modal-field"},yt.default.createElement("label",{className:"section-label"},"How would you like to handle this account?"),yt.default.createElement("div",{className:"link-option-group"},yt.default.createElement("label",{className:"link-option"},yt.default.createElement("input",{type:"radio",name:"linkOption",value:"new",checked:i==="new",onChange:()=>b("new")}),yt.default.createElement("span",null,"Create new account with custom name")),i==="new"&&yt.default.createElement("div",{className:"custom-name-input"},yt.default.createElement("input",{type:"text",value:d,onChange:w=>u(w.target.value),placeholder:"e.g., FTMO Challenge",className:"modal-input"}),yt.default.createElement("div",{className:"account-type-select"},yt.default.createElement("label",{className:"field-label"},"Account Type:"),yt.default.createElement("select",{value:f,onChange:w=>g(w.target.value),className:"modal-select"},r.map(w=>yt.default.createElement("option",{key:w,value:w},w.charAt(0).toUpperCase()+w.slice(1)))))),yt.default.createElement("label",{className:"link-option"},yt.default.createElement("input",{type:"radio",name:"linkOption",value:"existing",checked:i==="existing",onChange:()=>b("existing"),disabled:!y}),yt.default.createElement("span",null,"Link to existing account ",y?"":"(no accounts available)")),i==="existing"&&y&&yt.default.createElement("div",{className:"existing-account-select"},yt.default.createElement("select",{value:p,onChange:w=>{m(w.target.value)},className:"modal-select"},yt.default.createElement("option",{value:""},"Select an account..."),t.map(w=>yt.default.createElement("option",{key:w.path,value:w.path},w.name))),t.length===0&&yt.default.createElement("div",{className:"no-accounts-message"},"No existing accounts found. Create a new account instead.")),yt.default.createElement("label",{className:"link-option"},yt.default.createElement("input",{type:"radio",name:"linkOption",value:"default",checked:i==="default",onChange:()=>b("default")}),yt.default.createElement("span",null,"Use default name: Account-",e.accountId)),i==="default"&&yt.default.createElement("div",{className:"account-type-select"},yt.default.createElement("label",{className:"field-label"},"Account Type:"),yt.default.createElement("select",{value:f,onChange:w=>g(w.target.value),className:"modal-select"},r.map(w=>yt.default.createElement("option",{key:w,value:w},w.charAt(0).toUpperCase()+w.slice(1)))))))),yt.default.createElement("div",{className:"modal-actions"},yt.default.createElement(he,{onClick:x,disabled:v,variant:"primary"},v?"Linking...":"Confirm"),yt.default.createElement(he,{onClick:o,disabled:v,variant:"secondary"},"Cancel")))},hL=class extends DS.Modal{constructor(r,n,o,a){super(r);this.existingAccounts=[];this.availableAccountTypes=[];this.root=null;this.accountInfo=n,this.onLink=o,this.onCancel=a}async onOpen(){let{contentEl:r}=this;r.empty(),await this.loadExistingAccounts(),await this.loadAvailableAccountTypes();let{injectAccountLinkModalStyles:n}=(YO(),uu(NG));n();let o=r.createDiv(),{createRoot:a}=wn();this.root=a(o),this.root.render(yt.default.createElement(_ze,{accountInfo:this.accountInfo,existingAccounts:this.existingAccounts,availableAccountTypes:this.availableAccountTypes,onLink:async(i,s,l,c)=>{await this.onLink(i,s,l,c),this.close()},onCancel:()=>{this.onCancel(),this.close()}}))}async loadExistingAccounts(){try{let r=Xn().plugins.plugins.journalit,n=r==null?void 0:r.accountPageService;if(!n){console.warn("AccountPageService not available for loading existing accounts"),this.existingAccounts=[];return}let o=await n.getAllEnhancedAccounts();if(!o||!Array.isArray(o)){console.warn("Invalid accounts data received:",o),this.existingAccounts=[];return}this.existingAccounts=o.map(a=>{let i=a.accountName||a.name||`Account-${a.id||"Unknown"}`;return{path:a.notePath||"",name:i}})}catch(r){console.error("Failed to load existing accounts:",r),this.existingAccounts=[]}}async loadAvailableAccountTypes(){try{let r=Xn().plugins.plugins.journalit,n=r==null?void 0:r.optionsService;if(!n){console.warn("Options service not available - using default account types"),this.availableAccountTypes=["demo","evaluation","funded"];return}let o=n.getOptions("account_type");o&&o.length>0?this.availableAccountTypes=o:(console.warn("No custom account types found. Using default account types."),this.availableAccountTypes=["demo","evaluation","funded"])}catch(r){console.error("Failed to load available account types:",r),this.availableAccountTypes=["demo","evaluation","funded"]}}onClose(){this.root&&(this.root.unmount(),this.root=null);let{contentEl:r}=this;r.empty()}}});var ru,Ub,VR=L(()=>{ru=require("obsidian");eu();wt();Ub=class{constructor(t,r,n){this.tradeSyncMapping={};this.tradeFileCache=new Map;this.csvImportIdMap={};this.cacheBuilt=!1;this.isRebuilding=!1;this.plugin=t,this.settings=r,this.folderPathService=n,this.boundOnFolderPathChanged=this.onFolderPathChanged.bind(this),document.addEventListener("journalit-folder-path-changed",this.boundOnFolderPathChanged)}async loadSyncMapping(){let t=this.settings.tradeSyncMapping;t&&(this.tradeSyncMapping=t),await this.rebuildSyncMapping()}createCacheKey(t,r,n,o){let a=Math.floor(r.getTime()/1e3);return`${encodeURIComponent(t)}|${a}|${n}|${o}`}async buildTradeFileCache(){this.tradeFileCache.clear();try{let r=this.plugin.app.vault.getMarkdownFiles().filter(a=>this.isTradeFile(a)),n=20,o=[];for(let a=0;a<r.length;a+=n)o.push(r.slice(a,a+n));for(let[a,i]of o.entries()){let s=i.map(async l=>{try{let c=await this.plugin.app.vault.read(l),d=this.parseTradeFromMarkdown(c);if(d&&d.instrument&&d.entryTime&&d.entryPrice){let u=Xt(d.entryTime);if(!u){console.warn(`Invalid entry time for trade ${d.instrument}: ${d.entryTime}`);return}let p=parseFloat(d.positionSize)||0,m=this.createCacheKey(d.instrument,u,parseFloat(d.entryPrice),p);d.csvImportId&&(this.csvImportIdMap[d.csvImportId]=l.path),this.tradeFileCache.set(m,{path:l.path,metadata:d,symbol:d.instrument,entryTime:u,entryPrice:parseFloat(d.entryPrice),volume:p})}}catch(c){console.warn(`Error caching trade file ${l.path}:`,c)}});await Promise.all(s),a<o.length-1&&await new Promise(l=>setTimeout(l,10))}this.cacheBuilt=!0}catch(t){console.error("Error building trade file cache:",t),this.cacheBuilt=!1}}clearTradeFileCache(){this.tradeFileCache.clear(),this.csvImportIdMap={},this.cacheBuilt=!1}async rebuildSyncMapping(t){let r=this.plugin.app.vault.getMarkdownFiles().filter(o=>{let a=this.isTradeFile(o);return t&&!a?this.isTradeFileAtPath(o,t):a});if(r.length===0){this.tradeSyncMapping={},await this.saveSyncMapping();return}let n={};for(let o of r)try{let a=await this.plugin.app.vault.read(o),i=this.parseTradeFromMarkdown(a);i&&i.backendTradeId&&(n[i.backendTradeId]=o.path)}catch(a){console.error("Error reading trade file for sync mapping:",a)}this.tradeSyncMapping=n,await this.saveSyncMapping()}async saveSyncMapping(){let r=null;for(let n=0;n<3;n++)try{if(this.settings.tradeSyncMapping=this.tradeSyncMapping,await this.plugin.saveSettings(),this.settings.tradeSyncMapping===this.tradeSyncMapping)return!0;console.warn(`Mapping save verification failed on attempt ${n+1}`)}catch(o){r=o,console.error(`Failed to save sync mapping on attempt ${n+1}:`,o),n<2&&await new Promise(a=>setTimeout(a,100*(n+1)))}return console.error("Failed to save sync mapping after 3 attempts:",r),!1}async addMappingBatch(t){for(let{tradeId:r,filePath:n}of t)this.tradeSyncMapping[r]=n;return await this.saveSyncMapping()}async validateMappingIntegrity(){let t=0,r=[];for(let[n,o]of Object.entries(this.tradeSyncMapping))this.plugin.app.vault.getAbstractFileByPath(o)||(r.push(Number(n)),t++);if(r.length>0){console.warn(`Removing ${r.length} invalid mapping entries`);for(let n of r)delete this.tradeSyncMapping[n];await this.saveSyncMapping()}return t}async onFolderPathChanged(t){let r=t,{oldPath:n,newPath:o}=r.detail;if(this.isRebuilding){console.log("Sync mapping rebuild already in progress, skipping...");return}this.isRebuilding=!0;try{console.log(`Folder path changed from "${n}" to "${o}", rebuilding sync mapping...`);let a=new ru.Notice("Updating trade sync mappings for new folder path...",0);await this.rebuildSyncMapping(n),a.hide(),new ru.Notice("Trade sync mappings updated successfully",3e3),console.log("Sync mapping rebuilt successfully")}catch(a){console.error("Error rebuilding sync mapping:",a),new ru.Notice("Failed to update trade sync mappings. Please restart the plugin.",5e3)}finally{this.isRebuilding=!1}}cleanup(){document.removeEventListener("journalit-folder-path-changed",this.boundOnFolderPathChanged)}getSyncMapping(){return this.tradeSyncMapping}addMapping(t,r){this.tradeSyncMapping[t]=r}removeMapping(t){delete this.tradeSyncMapping[t]}getFilePathForTrade(t){return this.tradeSyncMapping[t]}async fetchAllTrades(t){var i;let r=[],n=0,o=100,a=!0;for(;a;){let s=tt.buildUrl("/api/v1/trades",{limit:o,offset:n}),l=await tt.makeRequest(s,{method:"GET"},"fetch trades");if(!l||!l.trades){console.warn("Invalid response from trades API:",l);break}Array.isArray(l.trades)&&r.push(...l.trades),a=((i=l.pagination)==null?void 0:i.has_more)||!1,n+=o}return r}isTradeFile(t){return this.folderPathService.isJournalPath(t.path)&&t.path.includes("/trades/")&&t.extension==="md"}isTradeFileAtPath(t,r){let n=t.path.toLowerCase().replace(/\\/g,"/"),o=r.toLowerCase().replace(/\\/g,"/");return(n.startsWith(o+"/")||n===o)&&t.path.includes("/trades/")&&t.extension==="md"}parseTradeFromMarkdown(t){try{let r=t.match(/^---\n([\s\S]*?)\n---/);if(!r)return null;let n=r[1],o={},a=n.split(`
`);for(let i of a){let s=i.indexOf(":");if(s===-1)continue;let l=i.substring(0,s).trim(),c=i.substring(s+1).trim();if(!(!l||!c))if(c.startsWith("[")&&c.endsWith("]")){let d=c.substring(1,c.length-1).trim();d?o[l]=d.split(",").map(u=>u.trim()):o[l]=[]}else o[l]=c}return(o.type==="trade"||o.type==="backtest-trade")&&o.instrument&&o.direction?(o.backendTradeId&&(o.backendTradeId=parseInt(o.backendTradeId)),o):null}catch(r){return console.error("Error parsing trade markdown:",r),null}}async findExistingTradeFile(t,r,n,o,a){return this.cacheBuilt?this.findExistingTradeFileFromCache(t):this.findExistingTradeFileFromDisk(t,r,n,o,a)}getCacheSize(){return this.tradeFileCache.size}async findExistingTradeFileFromCache(t){if(t.csvImportId&&this.csvImportIdMap[t.csvImportId])return this.csvImportIdMap[t.csvImportId];let r=this.getFilePathForTrade(t.id);if(r){let l=this.plugin.app.vault.getAbstractFileByPath(r);if(l instanceof ru.TFile)return l.path;this.removeMapping(t.id)}if(t.id){let l=await this.findTradeFileByBackendId(t.id);if(l)return l}let n=Xt(t.entry_time);if(!n)return console.warn(`Invalid entry time for trade ${t.symbol}: ${t.entry_time}`),null;let o=this.createCacheKey(t.symbol,n,t.entry_price,t.volume),a=this.tradeFileCache.get(o);if(a)return a.path;let i=6e4,s=1e-5;for(let[l,c]of this.tradeFileCache.entries())if(c.symbol===t.symbol&&Math.abs(c.volume-t.volume)<.001){let d=Wr(c.entryTime),u=Wr(n);if(d===null||u===null)continue;let p=Math.abs(d-u),m=Math.abs(c.entryPrice-t.entry_price);if(p<i&&m<s)return c.path}return null}async findTradeFileByBackendId(t){var r;if(!t)return null;try{let o=this.plugin.app.vault.getMarkdownFiles().filter(a=>this.isTradeFile(a));for(let a of o){let i=(r=this.plugin.app.metadataCache.getFileCache(a))==null?void 0:r.frontmatter;if((i==null?void 0:i.backendTradeId)===t)return console.log(`Found trade via frontmatter scan: ${t} -> ${a.path}`),this.addMapping(t,a.path),await this.saveSyncMapping()||console.warn(`Failed to save rebuilt mapping for trade ${t}`),a.path}return null}catch(n){return console.error(`Error scanning frontmatter for trade ${t}:`,n),null}}async findExistingTradeFileFromDisk(t,r,n,o,a){let i=this.folderPathService.getDatePath(String(n),o,`W${a}`,"trades"),s=this.plugin.app.vault.getAbstractFileByPath(i);if(s&&s instanceof ru.TFolder){let l=`${t.symbol}-${r}-T`,c=this.getFilePathForTrade(t.id);if(c){let m=this.plugin.app.vault.getAbstractFileByPath(c);if(m instanceof ru.TFile)return m.path;this.removeMapping(t.id)}let d=s.children.filter(m=>m instanceof ru.TFile&&m.name.startsWith(l));if(d.length===0)return null;let u=d.map(async m=>{try{let f=await this.plugin.app.vault.read(m),g=this.parseTradeFromMarkdown(f);if(g){if(g.backendTradeId&&g.backendTradeId===t.id)return m.path;let v=Xt(g.entryTime),h=Xt(t.entry_time);if(!v||!h)return null;let y=Math.abs(v.getTime()-h.getTime()),b=Math.abs(parseFloat(g.entryPrice)-t.entry_price)<1e-5,x=g.instrument===t.symbol;if(y<6e4&&b&&x)return m.path}}catch(f){console.warn(`Error checking trade file ${m.path}:`,f)}return null});return(await Promise.all(u)).find(m=>m!==null)||null}return null}}});var vL,Mce=L(()=>{eu();vL=class{constructor(t,r){this.plugin=t,this.settings=r}getAccountDisplayName(t){return this.settings.accountMapping&&this.settings.accountMapping[t]?this.settings.accountMapping[t]:`Account-${t}`}async createAccountMapping(t,r){this.settings.accountMapping||(this.settings.accountMapping={}),this.settings.accountMapping[t]=r,await this.plugin.saveSettings()}async updateAccountMappings(t){this.settings.accountMapping||(this.settings.accountMapping={});let r=!1;for(let n of t)n.displayName&&(!this.settings.accountMapping[n.accountId]||this.settings.accountMapping[n.accountId]!==n.displayName)&&(this.settings.accountMapping[n.accountId]=n.displayName,r=!0);r&&await this.plugin.saveSettings()}async fetchUserAccounts(){try{let t=tt.buildUrl("/api/v1/mt-accounts"),r=await tt.makeRequest(t,{method:"GET"},"fetch user accounts");if(!r)return[];let o=(r.accounts||[]).map(a=>({accountId:a.accountId||a.account_id||a.mt_account_id||"",displayName:a.displayName||a.display_name||`Account-${a.account_id||a.mt_account_id||"Unknown"}`,brokerName:a.brokerName||a.broker_name,firstSeen:a.firstSeen||a.first_seen,lastSeen:a.lastSeen||a.last_seen}));return o.length>0,o}catch(t){throw console.error("\u274C Failed to fetch MT accounts:",t instanceof Error?t.message:String(t)),new Error(`Failed to fetch MT accounts: ${t instanceof Error?t.message:String(t)}`)}}async updateAccountDisplayName(t,r,n){try{let o=tt.buildUrl(`/api/v1/mt-accounts/${encodeURIComponent(t)}`);return await tt.makeRequest(o,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({display_name:r})},"update account display name"),await this.createAccountMapping(t,r),!0}catch(o){throw console.error("Failed to update account display name:",o),o}}async getAccountTrades(t,r,n=100,o=0){try{let a=tt.buildUrl(`/api/v1/mt-accounts/${encodeURIComponent(t)}/trades`,{limit:n,offset:o}),i=await tt.makeRequest(a,{method:"GET"},"fetch account trades");return i?i.trades||[]:[]}catch(a){throw console.error("Failed to fetch account trades:",a),a}}checkForNewAccounts(t){let r=[];for(let n of t)(!this.settings.accountMapping||!this.settings.accountMapping[n])&&r.push(n);return r}}});var yL,Fce=L(()=>{eu();Sc();yL=class{constructor(t,r){this.plugin=t,this.settings=r}async getFTPCredentials(t){var r;try{let n=(r=this.plugin.authManager.getAuthState().token)==null?void 0:r.access_token,o={};n&&(o.Authorization=`Bearer ${n}`);let a=tt.buildUrl(`/api/v1/ftp-users/${t}`),i=await tt.makeRequest(a,{method:"GET",headers:o},"get FTP credentials");return i?{user_id:i.user_id,username:i.username,server:i.server||"sync.journalit.co",port:i.port||2121,lastPasswordReset:i.last_password_reset}:null}catch(n){if(this.settings.ftpUsername)return console.warn("FTP credentials not found for specific username:",t),null;if(n instanceof Error&&n.message.includes("404"))return await this.createFTPUser(t);let o={operation:"get FTP credentials",endpoint:`/api/v1/ftp-users/${t}`,statusCode:Pe.extractStatusCode(n)};throw Pe.logError(n,o),n}}async createOrGetFTPUser(){var t;try{let r=(t=this.plugin.authManager.getAuthState().token)==null?void 0:t.access_token,n={"Content-Type":"application/json"};r&&(n.Authorization=`Bearer ${r}`);let o=tt.buildUrl("/api/v1/ftp-users/auto-create"),a=await tt.makeRequest(o,{method:"POST",headers:n,body:JSON.stringify({username:`journalit${Date.now()}${Math.floor(Math.random()*1e3)}`})},"create or get FTP user");if(!a)return null;let i={user_id:a.user_id,username:a.username,password:a.password,server:a.server||"sync.journalit.co",port:a.port||2121,lastPasswordReset:a.last_password_reset||new Date().toISOString()};return a.user_id&&this.settings&&(this.settings.ftpUserId=a.user_id,await this.plugin.saveSettings()),i}catch(r){let n={operation:"create or get FTP user",endpoint:"/api/v1/ftp-users/auto-create",statusCode:Pe.extractStatusCode(r)};throw Pe.logError(r,n),r}}async autoCreateFTPCredentials(t){var r;try{let n=(r=this.plugin.authManager.getAuthState().token)==null?void 0:r.access_token,o={"Content-Type":"application/json"};n&&(o.Authorization=`Bearer ${n}`);let a=tt.buildUrl("/api/v1/ftp-users/auto-create"),i=await tt.makeRequest(a,{method:"POST",headers:o,body:JSON.stringify({username:t})},"auto-create FTP user");return i?{username:i.username,password:i.password,server:i.server||"sync.journalit.co",port:i.port||2121,lastPasswordReset:new Date().toISOString()}:null}catch(n){let o={operation:"auto-create FTP user",endpoint:"/api/v1/ftp-users/auto-create",statusCode:Pe.extractStatusCode(n)};throw Pe.logError(n,o),n}}async createFTPUser(t){var r;try{let n=await this.getFTPUserAccountId();if(!n){let l={operation:"determine account ID for FTP user creation",endpoint:"/api/v1/mt-accounts"};throw Pe.logError(new Error("Could not determine account ID for FTP user creation"),l),new Error("Could not determine account ID for FTP user creation")}let o=(r=this.plugin.authManager.getAuthState().token)==null?void 0:r.access_token,a={"Content-Type":"application/json"};o&&(a.Authorization=`Bearer ${o}`);let i=tt.buildUrl("/api/v1/ftp-users/create"),s=await tt.makeRequest(i,{method:"POST",headers:a,body:JSON.stringify({user_id:n})},"create FTP user");return s?{username:s.username,password:s.password,server:s.server||"sync.journalit.co",port:s.port||2121,lastPasswordReset:new Date().toISOString()}:null}catch(n){let o={operation:"create FTP user",endpoint:"/api/v1/ftp-users",statusCode:Pe.extractStatusCode(n)};throw Pe.logError(n,o),n}}async resetFTPPassword(t){var r;try{let n=this.settings.ftpUsername||t,o=this.settings.ftpUserId;if(!o&&n){let c=await this.getFTPCredentials(n);c&&c.user_id&&(o=c.user_id,this.settings.ftpUserId=o,await this.plugin.saveSettings())}if(!o){let c={operation:"determine FTP user ID",endpoint:`/api/v1/ftp-users/${n}`};throw Pe.logError(new Error("Could not find FTP user. Please try creating new credentials."),c),new Error("Could not find FTP user. Please try creating new credentials.")}let a=(r=this.plugin.authManager.getAuthState().token)==null?void 0:r.access_token,i={"Content-Type":"application/json"};a&&(i.Authorization=`Bearer ${a}`);let s=tt.buildUrl(`/api/v1/ftp-users/${o}/password`),l=await tt.makeRequest(s,{method:"PUT",headers:i},"reset FTP password");return l?{user_id:o,username:n,password:l.password,server:"sync.journalit.co",port:2121,lastPasswordReset:new Date().toISOString()}:null}catch(n){let a={operation:"reset FTP password",endpoint:`/api/v1/ftp-users/${this.settings.ftpUserId||t}/reset-password`,statusCode:Pe.extractStatusCode(n)};throw Pe.logError(n,a),n}}async getFTPUserAccountId(){if(this.settings.ftpUserId)return this.settings.ftpUserId;let t=this.settings.ftpUsername;if(t){let n=await this.getFTPCredentials(t);if(n&&n.user_id)return this.settings.ftpUserId=n.user_id,await this.plugin.saveSettings(),n.user_id}let r={operation:"determine FTP user account ID",endpoint:"/api/v1/mt-accounts"};return Pe.logError(new Error(`Could not determine FTP user account ID. FTP username: ${t}`),r),null}}});function Vb(){if(typeof crypto!="undefined"&&crypto.randomUUID)return crypto.randomUUID();if(typeof crypto!="undefined"&&crypto.getRandomValues){let e=new Uint8Array(16);crypto.getRandomValues(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;let t=Array.from(e,r=>r.toString(16).padStart(2,"0")).join("");return`${t.slice(0,8)}-${t.slice(8,12)}-${t.slice(12,16)}-${t.slice(16,20)}-${t.slice(20,32)}`}throw new Error("No crypto API available for secure UUID generation")}var bL=L(()=>{});var Oce,Hb,HR=L(()=>{Oce=require("obsidian");Ra();Ut();bL();Hb=class{constructor(t,r,n){this.accountCache=new Map;this.accountCacheTime=0;this.CACHE_TTL=300*1e3;this.plugin=t,this.folderPathService=n}generateTradeFilePath(t){let r=new Date(t.entry_time),n=r.getFullYear(),o=String(r.getMonth()+1).padStart(2,"0"),a=this.getWeekNumber(r),i=this.formatDateForUser(r),s=this.getNextTradeNumber(t.symbol,i,n,o,a);return this.folderPathService.getDatePath(String(n),o,`W${a}`,"trades",`${t.symbol}-${i}-T${s}.md`)}getNextTradeNumber(t,r,n,o,a){let i=this.folderPathService.getDatePath(String(n),o,`W${a}`,"trades"),s=this.plugin.app.vault.getAbstractFileByPath(i),l=0;if(s&&s instanceof Oce.TFolder){let c=`${t}-${r}-T`;for(let d of s.children)if(d.name.startsWith(c)&&d.name.endsWith(".md")){let u=d.name.match(/T(\d+)\.md$/);if(u){let p=parseInt(u[1]);p>l&&(l=p)}}}return l+1}async createTradeFileAtomic(t,r){var u;let n=new Date(t.entry_time),o=n.getFullYear(),a=String(n.getMonth()+1).padStart(2,"0"),i=this.getWeekNumber(n),s=this.formatDateForUser(n),l=this.folderPathService.getDatePath(String(o),a,`W${i}`,"trades");await this.ensureDirectoryExists(l);let c=3,d=null;for(let p=0;p<c;p++){let m=null;try{let f=Vb().split("-")[0],g=`${t.symbol}-${s}-temp-${f}.md`,v=`${l}/${g}`;m=await this.plugin.app.vault.create(v,r);let h=this.getNextTradeNumber(t.symbol,s,o,a,i),y=`${t.symbol}-${s}-T${h}.md`,b=`${l}/${y}`;if(this.plugin.app.vault.getAbstractFileByPath(b)){console.warn(`Trade file collision detected on attempt ${p+1}: ${b}`),await new Promise(w=>setTimeout(w,50*(p+1)));continue}return await this.plugin.app.vault.rename(m,b),m=null,b}catch(f){if(d=f,(u=f.message)!=null&&u.includes("already exists")){console.warn(`Temp file collision on attempt ${p+1}, retrying...`),await new Promise(g=>setTimeout(g,50*(p+1)));continue}throw f}finally{if(m)try{await this.plugin.app.vault.delete(m)}catch(f){f&&typeof f=="object"&&"code"in f&&f.code!=="ENOENT"&&console.warn(`Failed to cleanup temp file ${m.path}:`,f)}}}throw new Error(`Failed to create trade file after ${c} attempts: ${(d==null?void 0:d.message)||"unknown error"}`)}clearAccountCache(){this.accountCache.clear(),this.accountCacheTime=0}async refreshAccountCache(){let t=Date.now();if(!(this.accountCacheTime>0&&t-this.accountCacheTime<this.CACHE_TTL))try{this.accountCache.clear();let r=this.plugin.settings.backendIntegration;if(r!=null&&r.accountMapping)for(let[o,a]of Object.entries(r.accountMapping))this.accountCache.set(o,a);let n=this.plugin.accountPageService;if(n)try{let o=await n.getAllEnhancedAccounts();for(let a of o){let i=a.accountName||a.name||a.id;if(a.id&&!this.accountCache.has(a.id)&&this.accountCache.set(a.id,i),i.includes("Account-")){let s=i.replace("Account-","");/^\d+$/.test(s)&&!this.accountCache.has(s)&&this.accountCache.set(s,i)}}}catch(o){console.warn("Error loading accounts from AccountPageService:",o)}this.accountCacheTime=t}catch(r){console.error("Error refreshing account cache:",r)}}async resolveAccountDisplayName(t,r){try{await this.refreshAccountCache();let n=this.accountCache.get(t);if(n)return n;let o=r||`Account-${t}`;return this.accountCache.has(`_notfound_${t}`)||this.accountCache.set(`_notfound_${t}`,o),o}catch(n){return console.error("Error resolving account display name:",n),r||`Account-${t}`}}async generateTradeMarkdown(t,r){var d;let n=new Date(t.entry_time),o=t.exit_time?new Date(t.exit_time):null,a=t.direction.toUpperCase()==="BUY"?"long":"short";console.log("[TradeFileGenerator] trade.assetType:",t.assetType,"symbol:",t.symbol);let i=t.assetType||this.determineAssetType(t.symbol);console.log("[TradeFileGenerator] Final assetType used:",i);let s={type:"trade",...t.id&&t.id!==0&&{backendTradeId:t.id},tradeStatus:t.exit_time?"CLOSED":"OPEN",entryTime:this.formatDateForFrontmatter(t.entry_time),...t.csvImportId&&{csvImportId:t.csvImportId},entryPrice:t.entry_price,positionSize:t.volume,direction:a,instrument:t.symbol,assetType:i};try{let u=this.plugin.optionsService||new va(this.plugin);u.getInstrumentsForAssetType(i).includes(t.symbol)||await u.addOption("instrument",t.symbol,i)}catch(u){console.error(`Failed to add instrument '${t.symbol}' to options:`,u)}if(t.status==="CLOSED"&&t.exit_time&&t.exit_price&&(s.exitTime=this.formatDateForFrontmatter(t.exit_time),s.exitPrice=t.exit_price,t.profit_loss!==void 0&&t.profit_loss!==null&&(s.pnl=t.profit_loss)),t.entries&&t.entries.length>0?s.entries=t.entries.map(u=>({time:this.formatDateForFrontmatter(u.time),price:u.price,size:u.size})):s.entries=[{time:this.formatDateForFrontmatter(t.entry_time),price:t.entry_price,size:t.volume}],t.status==="CLOSED"&&t.exit_time&&t.exit_price&&(t.exits&&t.exits.length>0?s.exits=t.exits.map(u=>({time:this.formatDateForFrontmatter(u.time),price:u.price,size:u.size})):s.exits=[{time:this.formatDateForFrontmatter(t.exit_time),price:t.exit_price,size:t.volume}]),t.commission!==void 0&&t.commission!==null?s.commission=t.commission:s.commission=0,s.commissionType="fixed",t.swap!==void 0&&t.swap!==null?s.swap=t.swap:s.swap=0,t.fees!==void 0&&t.fees!==null?s.fees=t.fees:s.fees=0,s.useDirectPnLInput=!1,s.setupIds=[],s.mistakeIds=[],t.mt_account_number){s.accountId=t.mt_account_number;let u=await this.resolveAccountDisplayName(t.mt_account_number,r||t.mt_account_display_name);s.account=[u],s.accountIds=[u]}else{let u=r||t.mt_account_display_name||"Unknown Account";s.accountIds=[u],s.account=[u]}s.setup=[],s.mistake=[],s.images=[],s.tags=[],s.thesis="",i==="options"&&(s.contractSize=t.contractSize||100,t.strikePrice&&(s.strikePrice=t.strikePrice),t.expirationDate&&(s.expirationDate=this.formatDateForFrontmatter(t.expirationDate)),t.optionType&&(s.optionType=t.optionType)),i==="futures"&&t.dollarPerPoint&&(s.dollarPerPoint=t.dollarPerPoint);let l=`---
`;for(let[u,p]of Object.entries(s))if(p!=null)if(Array.isArray(p))if(p.length===0)l+=`${u}: []
`;else if(u==="entries"||u==="exits"){l+=`${u}:
`;for(let m of p)l+=`  - time: ${m.time}
`,l+=`    price: ${m.price}
`,l+=`    size: ${m.size}
`}else u==="images"?l+=`${u}: [${p.map(m=>`"${m}"`).join(", ")}]
`:l+=`${u}: [${p.map(m=>`${m}`).join(", ")}]
`;else p===""?l+=`${u}: ""
`:l+=`${u}: ${p}
`;l+=`---

`;let c=`# ${t.symbol} - ${t.direction.toUpperCase()}

`;if(c+=`Entry: ${t.entry_price} at ${n.toLocaleString()}
`,o){if(c+=`Exit: ${t.exit_price} at ${o.toLocaleString()}
`,t.profit_loss!==void 0&&t.profit_loss!==null){let u=this.plugin.settings.trade.displayRMultiples||!1,p=this.plugin.settings.trade.defaultRiskAmount||0,m;p>0&&t.profit_loss!==0&&(m=t.profit_loss/p);let f=(d=this.plugin.settings.general)==null?void 0:d.currency;if(t.profit_loss>0){let g=ve(t.profit_loss,!0,f,u,m);c+=`\u2705 Profit: ${g}
`}else if(t.profit_loss<0){let g=ve(t.profit_loss,!0,f,u,m);c+=`\u274C Loss: ${g}
`}}}else c+=`Status: Open
`;return l+c}formatDateForFrontmatter(t){return(typeof t=="string"?new Date(t):t).toISOString().split(".")[0]}formatDateForUser(t){let r=this.plugin.settings.trade.dateFormat,n=String(t.getDate()).padStart(2,"0"),o=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getFullYear()).slice(-2);switch(r){case"DDMMYY":return`${n}${o}${a}`;case"MMDDYY":return`${o}${n}${a}`;default:return`${a}${o}${n}`}}getWeekNumber(t){let r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())),n=r.getUTCDay()||7;r.setUTCDate(r.getUTCDate()+4-n);let o=new Date(Date.UTC(r.getUTCFullYear(),0,1));return Math.ceil(((r.getTime()-o.getTime())/864e5+1)/7)}async ensureDirectoryExists(t){var o;let r=t.split("/"),n="";for(let a of r)if(a&&(n+=(n?"/":"")+a,!this.plugin.app.vault.getAbstractFileByPath(n)))try{await this.plugin.app.vault.createFolder(n)}catch(i){if(!((o=i.message)!=null&&o.includes("already exists")))throw i}}determineAssetType(t){let r=t.toUpperCase();return r.includes("/")||r.length===6&&this.isForexCurrency(r.substring(0,3))&&this.isForexCurrency(r.substring(3,6))?"forex":r.endsWith("USDT")||r.endsWith("BTC")||r.endsWith("ETH")||r.includes("CRYPTO")?"crypto":/[0-9]/.test(r)&&(r.startsWith("ES")||r.startsWith("NQ")||r.startsWith("CL")||r.startsWith("GC"))?"futures":"stock"}isForexCurrency(t){return["EUR","USD","GBP","JPY","CHF","CAD","AUD","NZD"].includes(t)}}});var vh,xL,jce=L(()=>{vh=require("obsidian"),xL=class{constructor(t,r,n){this.lastProcessedFiles=new Set;this.MAX_TRACKED_FILES=1e3;this.MAX_FILE_AGE_MS=1440*60*1e3;this.fileProcessTimestamps=new Map;this.batchModifiedFiles=new Set;this.plugin=t,this.settings=r,this.tradeSyncService=n}setupFileWatcher(){this.plugin.registerEvent(this.plugin.app.vault.on("create",t=>{t instanceof vh.TFile&&this.tradeSyncService.isTradeFile(t)&&this.processNewTradeFile(t)})),this.plugin.registerEvent(this.plugin.app.vault.on("modify",t=>{t instanceof vh.TFile&&this.tradeSyncService.isTradeFile(t)&&!this.lastProcessedFiles.has(t.path)&&!this.batchModifiedFiles.has(t.path)&&this.processNewTradeFile(t)})),this.plugin.registerEvent(this.plugin.app.vault.on("delete",t=>{t instanceof vh.TFile&&this.removeFileFromTracking(t.path)})),this.plugin.registerEvent(this.plugin.app.vault.on("rename",(t,r)=>{t instanceof vh.TFile&&(this.removeFileFromTracking(r),this.tradeSyncService.isTradeFile(t)&&this.processNewTradeFile(t))})),this.startPeriodicCleanup()}async processNewTradeFile(t){var r,n;try{if((n=(r=this.plugin.tradeService)==null?void 0:r.recentlyCreatedFiles)!=null&&n.has(t.path))return;let o=await this.plugin.app.vault.read(t),a=this.tradeSyncService.parseTradeFromMarkdown(o);if(a){this.addFileToTracking(t.path);let i=a.backendTradeId!==void 0;if(!i&&a.pnl&&(a.account||a.accountIds)&&this.plugin.accountPageService)try{let s=a.account||a.accountIds;Array.isArray(s)||(s=s?[s]:[]);for(let l of s)l&&typeof l=="string"&&l.trim()&&await this.plugin.accountPageService.refreshAccountData(l.trim())}catch(s){console.error("Error refreshing account data from manual trade:",s)}this.settings.showNewTradeNotifications&&a.instrument&&a.direction&&!i&&new vh.Notice(`\u{1F4C8} New trade created: ${a.instrument} ${a.direction}`),this.plugin.app.workspace.trigger("journalit:trade-file-added",a)}}catch(o){console.error("Error processing new trade file:",o)}}async checkForNewTradeFiles(){let t=this.plugin.app.vault.getMarkdownFiles().filter(r=>this.tradeSyncService.isTradeFile(r));for(let r of t)this.lastProcessedFiles.has(r.path)||await this.processNewTradeFile(r)}addFileToTracking(t){this.lastProcessedFiles.add(t),this.fileProcessTimestamps.set(t,Date.now()),this.lastProcessedFiles.size>this.MAX_TRACKED_FILES&&this.performCleanup()}removeFileFromTracking(t){this.lastProcessedFiles.delete(t),this.fileProcessTimestamps.delete(t)}startPeriodicCleanup(){this.plugin.registerInterval(window.setInterval(()=>{this.performCleanup()},36e5))}performCleanup(){let t=Date.now(),r=[];for(let[n,o]of this.fileProcessTimestamps){if(t-o>this.MAX_FILE_AGE_MS){r.push(n);continue}this.plugin.app.vault.getAbstractFileByPath(n)||r.push(n)}for(let n of r)this.removeFileFromTracking(n);if(this.lastProcessedFiles.size>this.MAX_TRACKED_FILES){let n=Array.from(this.fileProcessTimestamps.entries()).sort((a,i)=>a[1]-i[1]),o=this.lastProcessedFiles.size-Math.floor(this.MAX_TRACKED_FILES*.8);for(let a=0;a<o&&a<n.length;a++)this.removeFileFromTracking(n[a][0])}r.length>0||this.lastProcessedFiles.size>this.MAX_TRACKED_FILES}clearProcessedFiles(){this.lastProcessedFiles.clear(),this.fileProcessTimestamps.clear()}}});var ES,af,wL=L(()=>{ES=require("obsidian"),af=class{constructor(t,r){this._callbacks=new Set;this.app=t,this.plugin=r,this._currentPath=this.getConfiguredPath(),this._onSettingsUpdatedBound=this.onSettingsUpdated.bind(this),document.addEventListener("journalit-settings-updated",this._onSettingsUpdatedBound)}get journalFolderPath(){return this._currentPath}getConfiguredPath(){var r;let t=(r=this.plugin.settings.general)==null?void 0:r.journalFolderPath;return!t||t.trim()===""?"!Journalit":(0,ES.normalizePath)(t.trim())}async updatePath(t){let r=(0,ES.normalizePath)(t.trim());if(!this.isValidPath(r))throw new Error(`Invalid folder path: ${r}`);this.plugin.settings.general.journalFolderPath=r,await this.plugin.saveSettings();let n=this._currentPath;this._currentPath=r,this.notifyPathChange(r),document.dispatchEvent(new CustomEvent("journalit-folder-path-changed",{detail:{oldPath:n,newPath:r}}))}getPath(...t){let r=[this._currentPath,...t].join("/");return(0,ES.normalizePath)(r)}getDatePath(t,r,n,...o){return this.getPath(t,r,n,...o)}isJournalPath(t){let r=(0,ES.normalizePath)(t),n=this._currentPath;return r.includes("-backup-")?!1:r.startsWith(n+"/")||r===n}onPathChange(t){return this._callbacks.add(t),()=>{this._callbacks.delete(t)}}isValidPath(t){return!t||t.trim()===""?!0:!(t.includes("..")||/[<>:"|?*]/.test(t))}async onSettingsUpdated(t){var n;if(((n=t==null?void 0:t.detail)==null?void 0:n.source)==="user-input")return;let r=this.getConfiguredPath();if(r!==this._currentPath){let o=this._currentPath;this._currentPath=r,this.notifyPathChange(r),document.dispatchEvent(new CustomEvent("journalit-folder-path-changed",{detail:{oldPath:o,newPath:r}}))}}notifyPathChange(t){this._callbacks.forEach(r=>{try{r(t)}catch(n){console.error("[FolderPathService] Error in path change callback:",n)}})}async ensureJournalFolderExists(){let t=this._currentPath;this.app.vault.getAbstractFileByPath(t)||await this.app.vault.createFolder(t)}getLegacyPath(){return"!Journalit"}isLegacyPath(){return this._currentPath===this.getLegacyPath()}cleanup(){document.removeEventListener("journalit-settings-updated",this._onSettingsUpdatedBound),this._callbacks.clear()}}});var kL,zce=L(()=>{kL=class{constructor(){this.locked=!1;this.queue=[]}tryLock(){return this.locked?!1:(this.locked=!0,!0)}async lock(){if(!this.locked){this.locked=!0;return}return new Promise(t=>{this.queue.push(t)})}unlock(){if(!this.locked){console.warn("Mutex.unlock() called but mutex was not locked");return}let t=this.queue.shift();t?t():this.locked=!1}isLocked(){return this.locked}async withLock(t){await this.lock();try{return await t()}finally{this.unlock()}}}});var $n,qR,IS,_ce=L(()=>{$n=require("obsidian");di();Ra();Nce();eu();VR();Mce();Fce();HR();jce();gv();ls();wL();Sc();wt();Ut();nm();zce();qR=60,IS=class{constructor(t){this.syncIntervalId=null;this.syncMutex=new kL;this.syncCancelled=!1;this.totalTradesToSync=0;this.tradesProcessedSoFar=0;this.autoContinueTimeoutId=null;var r;this.plugin=t,this.settings=t.settings.backendIntegration,this.folderPathService=((r=t.serviceManager)==null?void 0:r.getFolderPathService())||new af(t.app,t),this.tradeSyncService=new Ub(t,this.settings,this.folderPathService),this.accountManagementService=new vL(t,this.settings),this.ftpManagementService=new yL(t,this.settings),this.tradeFileGenerator=new Hb(t,this.settings,this.folderPathService),this.fileWatcherService=new xL(t,this.settings,this.tradeSyncService),this.tradeSyncService.loadSyncMapping(),this.fileWatcherService.setupFileWatcher(),this.debouncedForceSync=Gw(this.forceSync.bind(this),5e3),this.debouncedCheckForNewTrades=Gw(this.checkForNewTrades.bind(this),3e4),this.settings.syncEnabled&&qR>0&&this.startAutoSync()}getIsSyncing(){return this.syncMutex.isLocked()}getUserId(){try{let t=this.plugin.app.vault.getName();if(t&&t!=="Obsidian Vault")return t.toLowerCase().replace(/[^a-z0-9]/g,"");let r=this.plugin.app.vault.adapter,n="";return $n.Platform.isDesktopApp&&r instanceof $n.FileSystemAdapter&&(n=r.getBasePath()),n?(n.split(/[/\\]/).pop()||"unknown").toLowerCase().replace(/[^a-z0-9]/g,""):`anon_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}catch(t){let r=`anon_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return this.settings.userId||r}}async getVaultIdentifier(){var t;try{let r=(t=this.plugin.settings.backendIntegration)==null?void 0:t.vaultIdentifier;if(r)return r;let n=this.plugin.app.vault.getName()||"Unknown",o=navigator.userAgent.split(" ")[0]||"Unknown",a=n+":"+o,s=`vault_${(await this.hashIdentifier(a)).substring(0,16)}`;return this.settings.vaultIdentifier=s,this.plugin.settings.backendIntegration=this.settings,await this.plugin.saveSettings(),s}catch(r){return console.warn("Could not generate vault identifier:",r),`vault_${Math.random().toString(36).substring(2,18)}`}}async hashIdentifier(t){let n=new TextEncoder().encode(t),o=await window.crypto.subtle.digest("SHA-256",n),a=new Uint8Array(o);return Array.from(a).map(i=>i.toString(16).padStart(2,"0")).join("")}async registerVault(){var c;let t=(c=this.plugin.authManager.getAuthState().token)==null?void 0:c.access_token;if(!t)return!1;let r=t,n=this.settings.ftpUsername||this.getUserId(),o=await this.getVaultIdentifier(),a={vault_path:o,user_id:n,settings:{date_format:this.plugin.settings.trade.dateFormat,enabled:this.settings.syncEnabled}},i={"Content-Type":"application/json"};r&&(i.Authorization=`Bearer ${r}`);let s=tt.buildUrl("/api/v1/obsidian/register-vault");return await tt.makeRequest(s,{method:"POST",headers:i,body:JSON.stringify(a)},"vault registration")?(this.settings.userId=n,this.settings.vaultPath=o,await this.plugin.saveSettings(),this.settings.showSyncNotifications&&new $n.Notice("\u2705 Vault registered with trading server"),!0):!1}cancelSync(){this.syncMutex.isLocked()&&!this.syncCancelled&&(this.syncCancelled=!0,this.autoContinueTimeoutId!==null&&(clearTimeout(this.autoContinueTimeoutId),this.autoContinueTimeoutId=null),this.settings.showSyncNotifications&&new $n.Notice("\u23F9\uFE0F Sync cancelled"))}async forceSync(t=!1){var r,n,o;if(!this.plugin.authManager.isAuthenticated())return console.warn("Sync skipped: User not authenticated"),Pe.showError(new Error("Authentication required"),Pe.createContext("sync",void 0,401)),null;if(!t){if(!this.syncMutex.tryLock())return new $n.Notice("\u26A0\uFE0F Sync already in progress"),null;this.totalTradesToSync=0,this.tradesProcessedSoFar=0,this.syncCancelled=!1}try{if(!t)try{let k=(r=this.plugin.authManager.getAuthState().token)==null?void 0:r.access_token,T={};k&&(T.Authorization=`Bearer ${k}`);let P=tt.buildUrl("/api/v1/sync/ftp"),D=await tt.makeRequest(P,{method:"POST",headers:T},"FTP sync trigger");D!=null&&D.success||console.warn("FTP sync failed:",D==null?void 0:D.error)}catch(k){console.warn("Failed to trigger FTP sync:",k)}let a=await this.getFTPUserAccountId();if(!a)return new $n.Notice("\u274C Failed to get account information"),t||this.syncMutex.unlock(),null;let i=await this.tradeSyncService.fetchAllTrades(a),s=[],l=100;for(let k=0;k<i.length;k+=l){let T=i.slice(k,k+l),P=[];for(let D of T){let O=this.tradeSyncService.getFilePathForTrade(D.id);if(O){let z=this.plugin.app.vault.getAbstractFileByPath(O);if(!z){P.push(D);continue}if(!(z instanceof $n.TFile)){P.push(D);continue}try{let I=(n=this.plugin.app.metadataCache.getFileCache(z))==null?void 0:n.frontmatter;if(I){let j=!Xt(I.exitTime),E=D.status==="CLOSED"&&D.exit_time;if(j&&E){P.push(D);continue}}}catch(I){console.warn(`Error checking trade ${D.id} for updates:`,I)}continue}P.push(D)}s.push(...P),k+l<i.length&&await new Promise(D=>setTimeout(D,0))}this.totalTradesToSync===0&&(this.totalTradesToSync=s.length);let c=500,d=s.length>c?s.slice(0,c):s,u=s.length>c;if(u){let k=s.length-c;if(this.settings.showSyncNotifications){let T=Math.round(this.tradesProcessedSoFar/this.totalTradesToSync*100);new $n.Notice(`\u23F3 Syncing batch: ${c} trades (${T}% complete, ${k} remaining)`)}}else s.length===0&&i.length>0&&this.settings.showSyncNotifications&&new $n.Notice(`\u2705 All ${i.length} trades are already synced`);await this.tradeSyncService.buildTradeFileCache();let p=[];if(this.syncCancelled)return t||this.syncMutex.unlock(),null;let m=new Set;for(let k of d)k.mt_account_number&&typeof k.mt_account_number=="string"&&m.add(k.mt_account_number);let f=this.accountManagementService.checkForNewAccounts(m);if(f.length>0)for(let k of f){let T=d.find(I=>I.mt_account_number===k),P=(T==null?void 0:T.mt_account_display_name)||`Account-${k}`,D={accountId:k,displayName:P,brokerName:"MetaTrader",firstSeen:(T==null?void 0:T.entry_time)||new Date().toISOString()},O=await new Promise(I=>{new hL(this.plugin.app,D,async(j,E,N,B)=>{I(N?{action:"link",linkToPath:N}:E&&E!==P?{action:"create",displayName:E,accountType:B}:{action:"default",accountType:B})},()=>{I({action:"cancel"})}).open()});if(O.action==="cancel")continue;let z=P;if(O.action==="link"&&O.linkToPath){await this.accountManagementService.createAccountMapping(k,O.linkToPath);continue}else O.action==="create"&&O.displayName&&(z=O.displayName);if(await this.accountManagementService.createAccountMapping(k,z),this.plugin.accountPageService)try{D.displayName=z;let I=((o=this.plugin.optionsService)==null?void 0:o.getOptions("account_type"))||[],A=I.length>0?I[0]:"demo";await this.plugin.accountPageService.updateAccountMetadata(z,{name:z,accountType:O.accountType||A,createdDate:new Date,initialBalance:0}),this.settings.showSyncNotifications&&new $n.Notice(`\u{1F4CA} Created account: ${z}`)}catch(I){console.error(`Failed to create Account metadata for ${k}:`,I),p.push(`Failed to create account ${z}: ${I.message}`)}}let g=0,v=0,h=0,y=Date.now(),b=0,x=0,w=0;for(let k=0;k<d.length;k++){let T=d[k];try{let P=Date.now(),D=await this.createTradeFile(T),O=Date.now()-P;D==="created"?(g++,x+=O):D==="updated"?(v++,w+=O):D==="skipped"&&(h++,b+=O),O>1e3&&console.warn(`Slow trade processing: ${T.symbol} ${T.id} took ${O}ms (result: ${D})`)}catch(P){p.push(`Failed to create file for trade ${T.id}: ${P.message}`),console.error(`Failed to create file for trade ${T.id}:`,P)}}if(this.settings.lastSyncTime=new Date().toISOString(),this.settings.syncCount=(this.settings.syncCount||0)+1,await this.plugin.saveSettings(),this.plugin.accountPageService&&d.length>0)try{let k=Date.now();this.tradeFileGenerator.clearAccountCache(),this.tradeSyncService.clearTradeFileCache();let T=new Set;for(let I of d)if(I.mt_account_number){let A=I.mt_account_display_name||this.accountManagementService.getAccountDisplayName(I.mt_account_number)||`Account-${I.mt_account_number}`;T.add(A)}else console.warn(`Trade ${I.id} missing mt_account_number - using fallback account name`),T.add("Unknown Account");console.log(`Batch refreshing ${T.size} accounts after sync of ${d.length} trades`);let P=Array.from(T).map(async I=>{try{return await this.plugin.accountPageService.refreshAccountData(I),I}catch(A){return console.error(`Failed to refresh account ${I}:`,A),null}}),D=(await Promise.all(P)).filter(I=>I!==null),O=Date.now()-k;console.log(`Account refresh completed in ${O}ms for ${D.length} accounts`);let z=new CustomEvent("journalit:accounts-batch-updated",{detail:{accountNames:D,syncedTradeCount:d.length,timestamp:Date.now()}});document.dispatchEvent(z)}catch(k){console.error("Error recalculating account metrics after sync:",k),p.push(`Failed to recalculate metrics: ${k.message}`)}this.tradesProcessedSoFar+=d.length;let S={status:"success",synced_trades:d.length,new_files:g,updated_files:v,errors:p};if(u&&!this.syncCancelled){if(this.settings.showSyncNotifications){let k=Math.round(this.tradesProcessedSoFar/this.totalTradesToSync*100);new $n.Notice(`\u23F3 Batch complete: ${this.tradesProcessedSoFar}/${this.totalTradesToSync} trades (${k}%). Continuing...`)}return this.autoContinueTimeoutId=setTimeout(()=>{let k=this.autoContinueTimeoutId;this.autoContinueTimeoutId=null,!this.syncCancelled&&k!==null&&(console.log("Auto-continuing sync with next batch..."),this.forceSync(!0).catch(T=>{console.error("Auto-continue sync failed:",T),this.syncMutex.unlock(),this.totalTradesToSync=0,this.tradesProcessedSoFar=0}))},1e3),S}if(this.settings.showSyncNotifications)if(d.length>0||this.tradesProcessedSoFar>0){let k=this.tradesProcessedSoFar>0?this.tradesProcessedSoFar:d.length,T=new Set(d.map(P=>P.mt_account_number).filter(P=>P!=null)).size;new $n.Notice(`\u2705 Sync complete: ${k} trades processed (${g} new, ${v} updated) across ${T} account(s)`)}else new $n.Notice("\u2705 Sync complete - no new trades found");return this.totalTradesToSync=0,this.tradesProcessedSoFar=0,this.syncMutex.unlock(),S}catch(a){return console.error("Force sync failed:",a),new $n.Notice("\u274C Sync failed: "+a.message),this.syncMutex.isLocked()&&this.syncMutex.unlock(),this.totalTradesToSync=0,this.tradesProcessedSoFar=0,this.autoContinueTimeoutId!==null&&(clearTimeout(this.autoContinueTimeoutId),this.autoContinueTimeoutId=null),null}}async getSyncStatus(){let t=tt.buildUrl("/api/v1/obsidian/status"),r=await tt.makeRequest(t,{method:"GET",headers:{"x-endpoint":"/api/v1/obsidian/status"}},"sync status");return r||null}async checkForNewTrades(){if(this.settings.syncEnabled){if(!this.plugin.authManager.isAuthenticated()){console.warn("Auto-sync skipped: User not authenticated"),Pe.showError(new Error("Authentication required"),Pe.createContext("auto-sync",void 0,401));return}try{await this.forceSync()}catch(t){throw console.error("Check for new trades failed:",t),t}}}startAutoSync(){this.syncIntervalId&&window.clearInterval(this.syncIntervalId);let t=qR*60*1e3;this.syncIntervalId=this.plugin.registerInterval(window.setInterval(()=>{this.debouncedCheckForNewTrades()},t))}stopAutoSync(){this.syncIntervalId&&(window.clearInterval(this.syncIntervalId),this.syncIntervalId=null),this.debouncedForceSync.cancel(),this.debouncedCheckForNewTrades.cancel()}async updateSettings(t){let r={...this.settings};Object.assign(this.settings,t),this.plugin.settings.backendIntegration=this.settings,await this.plugin.saveSettings(),r.syncEnabled!==this.settings.syncEnabled&&(this.stopAutoSync(),this.settings.syncEnabled&&qR>0&&this.startAutoSync())}async getFTPUserAccountId(){if(this.settings.ftpUserId)return this.settings.ftpUserId;let t=this.settings.ftpUsername;if(t){let r=await this.ftpManagementService.getFTPCredentials(t);if(r&&r.user_id)return this.settings.ftpUserId=r.user_id,await this.updateSettings({ftpUserId:r.user_id}),r.user_id}return console.error("Could not determine FTP user account ID. FTP username:",t),null}async createTradeFile(t){let r=this.tradeSyncService.getFilePathForTrade(t.id);if(r){let g=this.plugin.app.vault.getAbstractFileByPath(r);if(g instanceof $n.TFile)return await this.updateExistingTradeFile(g,t);this.tradeSyncService.removeMapping(t.id)}let n=Xt(t.entry_time);if(!n)return console.error(`Invalid entry_time for trade ${t.id}: ${t.entry_time}`),"skipped";let o=n.getFullYear(),a=String(n.getMonth()+1).padStart(2,"0"),i=this.getWeekNumber(n),s=this.tradeFileGenerator.formatDateForUser(n),l=await this.tradeSyncService.findExistingTradeFile(t,s,o,a,i);if(l){this.tradeSyncService.addMapping(t.id,l),await this.tradeSyncService.saveSyncMapping()||console.warn(`Failed to save mapping for trade ${t.id}`);let v=this.plugin.app.vault.getAbstractFileByPath(l);if(!(v instanceof $n.TFile))throw new Error(`Failed to locate trade file at path: ${l}`);let h=await this.plugin.app.vault.read(v),y=this.tradeSyncService.parseTradeFromMarkdown(h);if(y&&!y.backendTradeId){let b=h.match(/^---\n([\s\S]*?)\n---/);if(b){let w=b[1].replace(/type: trade/,`type: trade
backendTradeId: ${t.id}`),S=h.replace(b[0],`---
${w}
---`);await this.plugin.app.vault.modify(v,S),await yr(this.plugin.app,v);let k=new CustomEvent("journalit:trade-data-changed",{detail:{action:"updated",filePath:v.path,timestamp:Date.now()}});document.dispatchEvent(k)}}return await this.updateExistingTradeFile(v,t)}let c=t.mt_account_number?this.accountManagementService.getAccountDisplayName(t.mt_account_number):void 0,d=await this.tradeFileGenerator.generateTradeMarkdown(t,c),u,p;try{if(u=await this.tradeFileGenerator.createTradeFileAtomic(t,d),p=this.plugin.app.vault.getAbstractFileByPath(u),!p)throw new Error(`File created but not found: ${u}`)}catch(g){throw console.error(`Failed to create trade file for ${t.symbol} (ID: ${t.id}):`,g),g}await yr(this.plugin.app,p);let m=this.plugin.tradeService;return m&&m.addRecentlyCreatedFile&&m.addRecentlyCreatedFile(u),this.tradeSyncService.addMapping(t.id,u),await this.tradeSyncService.saveSyncMapping()||console.warn(`Failed to save mapping for trade ${t.id}`),await this.autoCreateReviewsForSyncedTrade(t),setTimeout(async()=>{let g=new CustomEvent("journalit:trade-data-changed",{detail:{action:"created",filePath:u,timestamp:Date.now()}});document.dispatchEvent(g)},500),"created"}async updateExistingTradeFile(t,r){let n=await this.plugin.app.vault.read(t),o=this.tradeSyncService.parseTradeFromMarkdown(n);if(!o)return console.warn("Could not parse current trade from markdown"),"skipped";let i=!Xt(o.exitTime),s=r.status==="CLOSED"&&r.exit_time;if(i&&s){let l=await this.plugin.app.vault.read(t),c=l.indexOf("---",3)+3,d=l.substring(0,c),u=l.substring(c),p="<!-- User Notes Below -->",m="",f=u.indexOf(p);if(f!==-1)m=u.substring(f);else{let b=u.split(`
`),x=0;for(let w=0;w<b.length;w++){let S=b[w].trim();(S.startsWith("Status: Open")||S.startsWith("\u2705 Profit:")||S.startsWith("\u274C Loss:")||S.startsWith("Exit:"))&&(x=w+1)}if(x<b.length){let w=b.slice(x);w.filter(k=>k.trim()!=="").length>0&&(m=`

`+p+`

`+w.join(`
`))}}let g=r.mt_account_number?this.accountManagementService.getAccountDisplayName(r.mt_account_number):void 0,h=await this.tradeFileGenerator.generateTradeMarkdown(r,g)+(m||`

`+p);await this.plugin.app.vault.modify(t,h),await yr(this.plugin.app,t);let y=new CustomEvent("journalit:trade-data-changed",{detail:{action:"updated",filePath:t.path,timestamp:Date.now()}});return document.dispatchEvent(y),"updated"}return"skipped"}generateTradeFilePath(t){let r=Xt(t.entry_time);if(!r)throw console.error(`Invalid entry_time for trade ${t.id}: ${t.entry_time}`),new Error(`Cannot generate file path for trade with invalid entry_time: ${t.entry_time}`);let n=r.getFullYear(),o=String(r.getMonth()+1).padStart(2,"0"),a=this.getWeekNumber(r),i=this.formatDateForUser(r),s=this.getNextTradeNumber(t.symbol,i,n,o,a);return this.folderPathService.getDatePath(String(n),o,`W${a}`,"trades",`${t.symbol}-${i}-T${s}.md`)}getNextTradeNumber(t,r,n,o,a){let i=this.folderPathService.getDatePath(String(n),o,`W${a}`,"trades"),s=this.plugin.app.vault.getAbstractFileByPath(i),l=0;if(s&&s instanceof $n.TFolder){let c=`${t}-${r}-T`;for(let d of s.children)if(d instanceof $n.TFile&&d.name.startsWith(c)){let u=d.name.match(/T(\d+)\.md$/);if(u){let p=parseInt(u[1]);p>l&&(l=p)}}}return l+1}generateTradeMarkdown(t){var l;let r=Xt(t.entry_time);if(!r)throw console.error(`Invalid entry_time for trade ${t.id}: ${t.entry_time}`),new Error(`Cannot generate markdown for trade with invalid entry_time: ${t.entry_time}`);let n=t.exit_time?Xt(t.exit_time):null;t.exit_time&&!n&&console.warn(`Invalid exit_time for trade ${t.id}: ${t.exit_time}`);let o=t.direction.toUpperCase()==="BUY"?"long":"short",a={type:"trade",backendTradeId:t.id,entryTime:this.formatDateForFrontmatter(t.entry_time),entryPrice:t.entry_price,positionSize:t.volume,direction:o,instrument:t.symbol,assetType:"forex",tradeStatus:t.status};if(t.status==="CLOSED"&&t.exit_time&&t.exit_price&&(a.exitTime=this.formatDateForFrontmatter(t.exit_time),a.exitPrice=t.exit_price,t.profit_loss!==void 0&&t.profit_loss!==null&&(a.pnl=t.profit_loss)),t.entries&&t.entries.length>0?a.entries=t.entries.map(c=>({time:this.formatDateForFrontmatter(c.time),price:c.price,size:c.size})):a.entries=[{time:this.formatDateForFrontmatter(t.entry_time),price:t.entry_price,size:t.volume}],t.status==="CLOSED"&&t.exit_time&&t.exit_price&&(t.exits&&t.exits.length>0?a.exits=t.exits.map(c=>({time:this.formatDateForFrontmatter(c.time),price:c.price,size:c.size})):a.exits=[{time:this.formatDateForFrontmatter(t.exit_time),price:t.exit_price,size:t.volume}]),a.setupIds=[],a.mistakeIds=[],t.mt_account_number){a.accountId=t.mt_account_number;let c=t.mt_account_display_name||this.getAccountDisplayName(t.mt_account_number)||`Account-${t.mt_account_number}`;a.account=[c],a.accountIds=[c]}else console.warn(`Trade ${t.id} missing mt_account_number - using fallback account name in frontmatter`),a.accountIds=["Unknown Account"],a.account=["Unknown Account"];a.setup=[],a.mistake=[],a.images=[],a.tags=[],a.lotSize=1e5,a.pipValue=1;let i=`---
`;for(let[c,d]of Object.entries(a))if(d!=null)if(Array.isArray(d))if(d.length===0)i+=`${c}: []
`;else if(c==="entries"||c==="exits"){i+=`${c}:
`;for(let u of d)i+=`  - time: ${u.time}
`,i+=`    price: ${u.price}
`,i+=`    size: ${u.size}
`}else c==="images"?i+=`${c}: [${d.map(u=>`"${u}"`).join(", ")}]
`:i+=`${c}: [${d.map(u=>`${u}`).join(", ")}]
`;else i+=`${c}: ${d}
`;i+=`---

`;let s=`# ${t.symbol} - ${t.direction.toUpperCase()}

`;if(s+=`Entry: ${t.entry_price} at ${r.toLocaleString()}
`,n){if(s+=`Exit: ${t.exit_price} at ${n.toLocaleString()}
`,t.profit_loss!==void 0&&t.profit_loss!==null){let c=((l=this.plugin.settings.general)==null?void 0:l.currency)||"USD",d=this.plugin.settings.trade.displayRMultiples,u;d&&this.plugin.settings.trade.defaultRiskAmount&&this.plugin.settings.trade.defaultRiskAmount>0&&(u=t.profit_loss/this.plugin.settings.trade.defaultRiskAmount);let p=ve(Math.abs(t.profit_loss),!0,c,d,u);t.profit_loss>0?s+=`\u2705 Profit: ${p}
`:t.profit_loss<0&&(s+=`\u274C Loss: ${p}
`)}}else s+=`Status: Open
`;return i+s}formatDateForFrontmatter(t){let r=typeof t=="string"?Xt(t):Xt(t);return r?r.toISOString().split(".")[0]:(console.error(`Invalid date input for frontmatter: ${t}`),new Date().toISOString().split(".")[0])}formatDateForUser(t){let r=this.plugin.settings.trade.dateFormat,n=String(t.getDate()).padStart(2,"0"),o=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getFullYear()).slice(-2);switch(r){case"DDMMYY":return`${n}${o}${a}`;case"MMDDYY":return`${o}${n}${a}`;default:return`${a}${o}${n}`}}getWeekNumber(t){let r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())),n=r.getUTCDay()||7;r.setUTCDate(r.getUTCDate()+4-n);let o=new Date(Date.UTC(r.getUTCFullYear(),0,1));return Math.ceil(((r.getTime()-o.getTime())/864e5+1)/7)}async getFTPCredentials(t){return this.ftpManagementService.getFTPCredentials(t)}async autoCreateFTPCredentials(t){return this.ftpManagementService.autoCreateFTPCredentials(t)}async resetFTPPassword(t){return this.ftpManagementService.resetFTPPassword(t)}async fetchUserAccounts(){return await this.accountManagementService.fetchUserAccounts()}async updateAccountDisplayName(t,r){var a;let n=this.plugin.authManager.getAuthState(),o=n.isAuthenticated&&((a=n.cache)!=null&&a.userId)?String(n.cache.userId):this.settings.ftpUserId!==void 0&&this.settings.ftpUserId!==null?String(this.settings.ftpUserId):this.settings.userId||this.getUserId();return this.accountManagementService.updateAccountDisplayName(t,r,o)}getAccountDisplayName(t){return this.accountManagementService.getAccountDisplayName(t)}async getAccountTrades(t,r=100,n=0){let o=this.settings.ftpUsername||this.getUserId();return this.accountManagementService.getAccountTrades(t,o,r,n)}async createOrGetFTPUser(){return this.ftpManagementService.createOrGetFTPUser()}getTradeSyncMapping(){return this.tradeSyncService.getSyncMapping()}setTradeSyncMapping(t,r){this.tradeSyncService.addMapping(t,r)}async saveSyncMapping(){return await this.tradeSyncService.saveSyncMapping()}async updateAccountMapping(t,r){await this.accountManagementService.createAccountMapping(t,r)}async updateAccountMappings(t){await this.accountManagementService.updateAccountMappings(t)}async relinkAccountTrades(t,r,n){let o=[],a=0;if(r===n)return{updatedCount:0,errors:[]};try{let i=this.plugin.app.vault.getMarkdownFiles().filter(s=>this.folderPathService.isJournalPath(s.path)&&s.path.includes("/trades/"));for(let s of i)try{let l=await this.plugin.app.vault.read(s),c=this.tradeSyncService.parseTradeFromMarkdown(l);if(!c)continue;if((Array.isArray(c.account)?c.account:c.account?[c.account]:[]).includes(r)){let u=l;if(c.account&&c.account.length>0){let p=l.match(/account:\s*\[(.*?)\]/);if(p){let m=p[0],f=`account: [${n}]`;u=u.replace(m,f)}}if(c.accountIds&&c.accountIds.length>0){let p=l.match(/accountIds:\s*\[(.*?)\]/);if(p){let m=p[0],f=`accountIds: [${n}]`;u=u.replace(m,f)}}if(await this.plugin.app.vault.modify(s,u),await yr(this.plugin.app,s),a++,this.plugin.accountPageService&&c.pnl!==void 0)try{await this.plugin.accountPageService.refreshAccountData(r),await this.plugin.accountPageService.refreshAccountData(n)}catch(p){console.error("Error refreshing account data after relinking:",p),o.push(`Failed to refresh account data for ${s.path}: ${p.message}`)}}}catch(l){console.error(`Error processing file ${s.path}:`,l),o.push(`${s.path}: ${l.message}`)}if(this.plugin.accountPageService)try{await this.plugin.accountPageService.refreshAccountData(r);let s=new CustomEvent("journalit:account-updated",{detail:{accountName:r,timestamp:Date.now()}});document.dispatchEvent(s),await this.plugin.accountPageService.refreshAccountData(n);let l=new CustomEvent("journalit:account-updated",{detail:{accountName:n,timestamp:Date.now()}});document.dispatchEvent(l)}catch(s){console.error("Error refreshing account data after relinking:",s),o.push(`Failed to refresh account data: ${s.message}`)}}catch(i){throw console.error("Error relinking account trades:",i),i}return{updatedCount:a,errors:o}}async requestForceSync(){return this.debouncedForceSync()}async requestCheckForNewTrades(){return this.debouncedCheckForNewTrades()}async forceSyncImmediate(){return this.syncMutex.isLocked()?(new $n.Notice("\u26A0\uFE0F Sync already in progress"),null):(this.debouncedForceSync.cancel(),await this.forceSync())}async autoCreateReviewsForSyncedTrade(t){var r,n,o,a,i,s,l;try{let c=Xt(t.entry_time);if(!c){console.error(`Skipping auto-create reviews for trade ${t.id} - invalid entry_time: ${t.entry_time}`);return}if((o=(n=(r=this.plugin)==null?void 0:r.settings)==null?void 0:n.drc)!=null&&o.autoCreateOnFirstTrade)try{if(this.plugin.drcService){let d=this.plugin.drcService.getDRCNotePath(c);await this.plugin.app.vault.adapter.exists(d)||await this.plugin.drcService.createDRC(c)}}catch(d){console.error("Failed to auto-create DRC for synced trade:",d)}if((i=(a=this.plugin)==null?void 0:a.settings.weekly)!=null&&i.autoCreateOnFirstTrade)try{if(this.plugin.weeklyReviewService){let d=this.plugin.weeklyReviewService.getWeeklyReviewPath(c);await this.plugin.app.vault.adapter.exists(d)||await this.plugin.weeklyReviewService.createWeeklyReview(c)}}catch(d){console.error("Failed to auto-create Weekly Review for synced trade:",d)}if((l=(s=this.plugin)==null?void 0:s.settings.monthly)!=null&&l.autoCreateOnFirstTrade)try{if(this.plugin.monthlyReviewService){let d=this.plugin.monthlyReviewService.getMonthlyReviewPath(c);await this.plugin.app.vault.adapter.exists(d)||await this.plugin.monthlyReviewService.createMonthlyReview(c)}}catch(d){console.error("Failed to auto-create Monthly Review for synced trade:",d)}}catch(c){console.error("Error in auto-create reviews for synced trade:",c)}}cleanup(){this.stopAutoSync(),this.fileWatcherService.clearProcessedFiles(),this.tradeSyncService.cleanup(),this.debouncedForceSync.cancel(),this.debouncedCheckForNewTrades.cancel(),this.autoContinueTimeoutId!==null&&(clearTimeout(this.autoContinueTimeoutId),this.autoContinueTimeoutId=null),this.syncCancelled=!1,this.totalTradesToSync=0,this.tradesProcessedSoFar=0}}});var Bce=L(()=>{_ce();eu()});var $ce,Bze,LS,Wce=L(()=>{$ce=require("obsidian");zA();Bze=1,LS=class extends $ce.Component{constructor(r,n){super();this.callbacks={};this.checklist=[];this.saveTimeout=null;this.isSaving=!1;this.app=r,this.plugin=n,this.data=this.getDefaultData(),this.state=this.getDefaultState(),this.checklist=[...pR]}async initialize(){await this.loadData(),this.updateState()}getDefaultData(){return{version:1,completed:!1,currentStep:"welcome",checklist:{},skipped:!1}}getDefaultState(){return{isActive:!1,currentStep:"welcome",canSkip:!0,canGoBack:!1,canGoForward:!0}}async loadData(){var r;try{let n=await this.plugin.loadData(),o=n==null?void 0:n.localMeta;o!=null&&o.onboarding?o.onboarding.version!==1?o.onboarding.version>1&&o.onboarding.version>=Bze?(console.warn(`Onboarding version downgrade detected: ${o.onboarding.version} -> ${1}`),this.data={...this.getDefaultData(),...o.onboarding,version:1}):this.data=this.migrateData(o.onboarding):this.data={...this.getDefaultData(),...o.onboarding}:this.data=this.getDefaultData(),(r=o==null?void 0:o.onboarding)!=null&&r.checklist&&this.updateChecklistFromData(o.onboarding.checklist)}catch(n){console.error("Error loading onboarding data:",n),this.data=this.getDefaultData()}}async saveData(){this.saveTimeout&&(window.clearTimeout(this.saveTimeout),this.saveTimeout=null),this.saveTimeout=window.setTimeout(async()=>{await this.performSave()},100)}async performSave(){if(this.isSaving){this.saveTimeout=window.setTimeout(()=>this.performSave(),50);return}this.isSaving=!0;try{let r=await this.plugin.loadData()||{};r.localMeta||(r.localMeta={}),r.localMeta.onboarding=this.data,await this.plugin.saveData(r)}catch(r){console.error("Error saving onboarding data:",r)}finally{this.isSaving=!1}}migrateData(r){let n=this.getDefaultData();return r.completed!==void 0&&(n.completed=r.completed),r.completedAt!==void 0&&(n.completedAt=r.completedAt),r.selectedGoal!==void 0&&(n.selectedGoal=r.selectedGoal),r.skipped!==void 0&&(n.skipped=r.skipped),r.skippedAt!==void 0&&(n.skippedAt=r.skippedAt),r.checklist!==void 0&&(n.checklist={...r.checklist}),n}updateChecklistFromData(r){this.checklist=this.checklist.map(n=>({...n,completed:r[n.id]||!1,completedAt:r[n.id]?Date.now():void 0}))}updateState(){this.state={isActive:!this.data.completed&&!this.data.skipped,currentStep:this.data.currentStep||"welcome",selectedGoal:this.data.selectedGoal,canSkip:this.canSkipCurrentStep(),canGoBack:this.canGoBackFromCurrentStep(),canGoForward:this.canGoForwardFromCurrentStep()}}canSkipCurrentStep(){let r=_r.find(n=>n.id===this.state.currentStep);return(r==null?void 0:r.isOptional)===!0}canGoBackFromCurrentStep(){return _r.findIndex(n=>n.id===this.state.currentStep)>0}canGoForwardFromCurrentStep(){return _r.findIndex(n=>n.id===this.state.currentStep)<_r.length-1}getState(){return{...this.state}}getData(){return{...this.data}}getChecklist(){return[...this.checklist]}shouldShowOnboarding(){return!this.data.completed&&!this.data.skipped}isCompleted(){return this.data.completed}async startOnboarding(){var r,n;this.data.currentStep="welcome",this.data.completed=!1,this.data.skipped=!1,this.updateState(),await this.saveData(),(n=(r=this.callbacks).onStepChange)==null||n.call(r,"welcome")}async goToStep(r){var o,a;let n=this.state.currentStep;if(!this.isValidStepTransition(this.state.currentStep,r))throw new Error(`Invalid step transition from ${this.state.currentStep} to ${r}`);this.data.currentStep=r,this.updateState(),await this.saveData(),(a=(o=this.callbacks).onStepChange)==null||a.call(o,r,n)}async nextStep(){if(!this.state.canGoForward)throw new Error("Cannot go forward from current step");let n=_r.findIndex(o=>o.id===this.state.currentStep)+1;for(;n<_r.length;){let o=_r[n];if(!o.shouldShow||o.shouldShow(this.data.selectedGoal))break;n++}n<_r.length&&await this.goToStep(_r[n].id)}async previousStep(){if(!this.state.canGoBack)throw new Error("Cannot go back from current step");let n=_r.findIndex(o=>o.id===this.state.currentStep)-1;for(;n>=0;){let o=_r[n];if(!o.shouldShow||o.shouldShow(this.data.selectedGoal))break;n--}n>=0&&await this.goToStep(_r[n].id)}async setGoal(r){var n,o;this.data.selectedGoal=r,this.updateState(),await this.saveData(),(o=(n=this.callbacks).onGoalSelected)==null||o.call(n,r)}async skipOnboarding(){var n,o;let r=this.state.currentStep;this.data.skipped=!0,this.data.skippedAt=Date.now(),this.state.isActive=!1,this.updateState(),await this.saveData(),(o=(n=this.callbacks).onSkipped)==null||o.call(n,r)}async completeOnboarding(){var r,n;this.data.completed=!0,this.data.completedAt=Date.now(),this.state.isActive=!1,this.updateState(),await this.saveData(),(n=(r=this.callbacks).onCompleted)==null||n.call(r,this.data)}async resetOnboarding(){this.data=this.getDefaultData(),this.state=this.getDefaultState(),this.checklist=[...pR],await this.saveData()}async completeChecklistTask(r){let n=this.checklist.find(o=>o.id===r);if(!n){console.warn(`Checklist task not found: ${r}`);return}n.completed||(n.completed=!0,n.completedAt=Date.now(),this.data.checklist[r]=!0,await this.saveData())}isValidStepTransition(r,n){let o=_r.findIndex(i=>i.id===r),a=_r.findIndex(i=>i.id===n);return a<=o?!0:a===o+1}setCallbacks(r){this.callbacks={...this.callbacks,...r}}clearCallbacks(){this.callbacks={}}async onunload(){this.clearCallbacks(),this.saveTimeout!==null&&(window.clearTimeout(this.saveTimeout),this.saveTimeout=null);try{await this.performSave()}catch(r){console.error("Error during final save in onunload:",r)}}}});var Rce=L(()=>{Wce();zA()});var qb,SL,Uce=L(()=>{qb=require("obsidian");rf();ci();wt();SL=class extends Qi{constructor(r,n,o={}){let a=n.serviceManager,i=a==null?void 0:a.getFolderPathService(),s=(i==null?void 0:i.journalFolderPath)||"!Journalit";super(r,{folder:s,extension:".md",namespace:"missed-trade",enableIndexing:!0,...o});this.recentlyCreatedFiles=new Set;this.tradesFolder="trades";this.setPlugin(n),this.folderPathService=i||{journalFolderPath:"!Journalit",getPath:(...l)=>(0,qb.normalizePath)(["!Journalit",...l].join("/")),isJournalPath:l=>l.startsWith("!Journalit/")}}getPlugin(){if(!this.plugin)throw new Error("Plugin not initialized");return this.plugin}validateDirectionAndOptionType(r){if(r.optionType){let n=r.optionType.trim().toLowerCase();(n==="call"||n==="put")&&(r.optionType=n)}if(r.direction&&r.optionType)throw new Error("Cannot specify both direction and optionType");if(r.assetType==="options"){if(!r.optionType)throw new Error("Option type is required");if(r.optionType!=="call"&&r.optionType!=="put")throw new Error("Invalid optionType: must be 'call' or 'put'");if(r.direction)throw new Error("Direction should not be provided for options trades")}else{if(!r.direction)throw new Error("Direction is required");if(r.optionType)throw new Error("optionType should only be provided for options trades")}}setPlugin(r){super.setPlugin(r),r.registerEvent(r.app.vault.on("delete",async n=>{if(n.path.endsWith(".md")&&/-M\d+\.md$/.test(n.path)){let o=(0,qb.normalizePath)(n.path);await this.handleMissedTradeDeletion(o)}}))}async createMissedTrade(r,n){var o,a;try{if(!r.entryTime)throw new Error("Entry time is required");if(this.validateDirectionAndOptionType(r),!r.instrument)throw new Error("Instrument is required");r.entryPrice===void 0&&(r.entryPrice=0),r.exitPrice===void 0&&(r.exitPrice=0),r.positionSize===void 0&&(r.positionSize=0),r.exitTime||(r.exitTime=r.entryTime);let i=this.getTargetFolderPath(r.entryTime);try{await this.app.vault.adapter.mkdir(i)}catch(p){}let s=await this.getMissedTradeFilePath(r);if(await this.app.vault.adapter.exists(s))throw console.error(`Cannot create missed trade - File already exists at path: ${s}`),new Error(`File already exists: ${s}`);let c=this.generateMissedTradeContent(r);this.recentlyCreatedFiles.add(s),setTimeout(()=>{var p;(p=this.recentlyCreatedFiles)==null||p.delete(s)},1e4);let d=await this.app.vault.create(s,c);this.app.metadataCache.trigger("resolve",d);let u=new CustomEvent("journalit:missed-trade-data-changed",{detail:{action:"created",filePath:s,timestamp:Date.now()}});if(document.dispatchEvent(u),this.clearCache(),(o=this.plugin)!=null&&o.settings.trade.autoOpenCreatedTrades&&!(n!=null&&n.suppressAutoOpen)){let p=null;(a=this.plugin)!=null&&a.processorManager&&(p=await this.getPlugin().processorManager.getMissedTradeNoteProcessor());try{await this.getPlugin().openFile(s,!0)}catch(m){console.warn("Failed to auto-open created missed trade:",m)}}return console.log(`Missed trade created successfully: ${s}`),s}catch(i){throw console.error("Error creating missed trade:",i),i}}async updateMissedTrade(r,n){var o,a,i,s,l,c,d;try{if(!r.entryTime)throw new Error("Entry time is required");if(this.validateDirectionAndOptionType(r),!r.instrument)throw new Error("Instrument is required");if(!await this.app.vault.adapter.exists(n))throw new Error(`Missed trade file does not exist: ${n}`);let p=this.app.vault.getAbstractFileByPath(n);if(!p||!(p instanceof qb.TFile))throw new Error(`Invalid file path: ${n}`);r.entryPrice===void 0&&(r.entryPrice=0),r.exitPrice===void 0&&(r.exitPrice=0),r.positionSize===void 0&&(r.positionSize=0),r.exitTime||(r.exitTime=r.entryTime);let m=r.pnl;r.useDirectPnLInput&&r.directPnL!==void 0&&(m=this.calculateNetPnL(r));let f={type:"missed-trade",isMissedTrade:!0,entryTime:this.formatDateForFrontmatter(r.entryTime),exitTime:this.formatDateForFrontmatter(r.exitTime||r.entryTime),entryPrice:r.entryPrice,exitPrice:r.exitPrice,positionSize:r.positionSize,...r.direction?{direction:r.direction}:{},instrument:r.instrument};m!==void 0&&(f.pnl=m),r.assetType&&(f.assetType=r.assetType),r.thesis!==void 0&&(f.thesis=this.formatThesisForYAML(r.thesis||"")),r.missedReason!==void 0&&(f.missedReason=r.missedReason||""),r.commission!==void 0&&(f.commission=r.commission),r.commissionType!==void 0&&(f.commissionType=r.commissionType),r.fees!==void 0&&(f.fees=r.fees),(o=r.setupIds)!=null&&o.length&&(f.setupIds=r.setupIds),(a=r.mistakeIds)!=null&&a.length&&(f.mistakeIds=r.mistakeIds),(i=r.accountIds)!=null&&i.length&&(f.accountIds=r.accountIds),(s=r.account)!=null&&s.length&&(f.account=r.account),(l=r.setup)!=null&&l.length&&(f.setup=r.setup),(c=r.mistake)!=null&&c.length&&(f.mistake=r.mistake),(d=r.images)!=null&&d.length&&(f.images=r.images),r.useDirectPnLInput!==void 0&&(f.useDirectPnLInput=r.useDirectPnLInput),r.directPnL!==void 0&&(f.directPnL=r.directPnL),r.optionType&&(f.optionType=r.optionType),r.reviewed!==void 0&&(f.reviewed=r.reviewed),r.reviewedAt&&(f.reviewedAt=r.reviewedAt),r.customTags&&Array.isArray(r.customTags)&&r.customTags.length>0?f.tags=r.customTags.filter(v=>v==null?void 0:v.trim()):f.tags=[],await this.updateFrontmatter(p,f);let g=new CustomEvent("journalit:missed-trade-data-changed",{detail:{action:"updated",filePath:n,timestamp:Date.now()}});return document.dispatchEvent(g),this.clearCache(),console.log(`Missed trade updated successfully: ${n}`),n}catch(u){throw console.error("Error updating missed trade:",u),u}}async updateMissedTradeReviewStatus(r,n,o){try{let a=this.app.vault.getAbstractFileByPath(r);if(!a||!(a instanceof qb.TFile))throw new Error(`Invalid file path: ${r}`);let i={reviewed:n,reviewedAt:o||new Date().toISOString()};await this.updateFrontmatter(a,i);let s=new CustomEvent("journalit:missed-trade-data-changed",{detail:{action:"reviewed",filePath:r,timestamp:Date.now()}});document.dispatchEvent(s),console.log(`Missed trade review status updated: ${r}`)}catch(a){throw console.error("Error updating missed trade review status:",a),a}}async handleMissedTradeDeletion(r){console.log("Handling missed trade deletion:",r),this.clearCache(),setTimeout(()=>{let n=new CustomEvent("journalit:missed-trade-data-changed",{detail:{action:"deleted",filePath:r,timestamp:Date.now()}});document.dispatchEvent(n),console.log("Emitted missed trade deletion event:",r)},500)}async getMissedTradeFilePath(r){var f;let n=lr(r.entryTime,this.plugin),o=n.getFullYear(),a=String(n.getMonth()+1).padStart(2,"0"),i=String(n.getDate()).padStart(2,"0"),s=this.getWeekOfMonth(n),l=r.instrument?this.sanitizeTickerForFilename(r.instrument):"UNKNOWN",c=((f=this.plugin)==null?void 0:f.settings.trade.dateFormat)||"DDMMYY",d="";c==="DDMMYY"?d=`${i}${a}${String(o).slice(2)}`:c==="MMDDYY"?d=`${a}${i}${String(o).slice(2)}`:c==="YYMMDD"?d=`${String(o).slice(2)}${a}${i}`:d=`${i}${a}${String(o).slice(2)}`;let u=await this.getMissedTradeNumberForDay(l,n),p=`${l}-${d}-M${u}.md`;return this.folderPathService.getPath(o.toString(),a,s,this.tradesFolder,p)}async getMissedTradeNumberForDay(r,n){var u;let o=this.getTargetFolderPath(n),a=await this.listFilesInFolder(o),i=((u=this.plugin)==null?void 0:u.settings.trade.dateFormat)||"DDMMYY",s=this.formatDateForFilename(n,i),l=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),c=new RegExp(`^${l}-${s}-M(\\d+)\\.md$`),d=0;for(let p of a){let m=p.split("/").pop()||"",f=c.exec(m);if(f){let g=parseInt(f[1],10);d=Math.max(d,g)}}return d+1}getAllMissedTradeFiles(){return this.app.vault.getMarkdownFiles().filter(n=>!(!this.folderPathService.isJournalPath(n.path)||!n.path.includes("/trades/")||!n.path.match(/-M\d+\.md$/)))}async getMissedTrades(r,n){await new Promise(l=>setTimeout(l,50)),this.invalidateCache();let o=lr(r,this.plugin),a=lr(n,this.plugin);a.setHours(23,59,59,999);let i=this.getAllMissedTradeFiles(),s=[];for(let l of i)try{if(!l.path.includes("/trades/")||!this.folderPathService.isJournalPath(l.path)||!l.path.match(/-M\d+\.md$/))continue;let c=await this.readFrontmatter(l);if(!c||c.type!=="missed-trade")continue;let d=c.entryTime?new Date(c.entryTime):null;if(!d)continue;let u=lr(d,this.plugin);u>=o&&u<=a&&s.push(l)}catch(c){console.warn(`Failed to read frontmatter for ${l.path}:`,c)}return s}generateMissedTradeContent(r){var i,s,l,c,d,u,p,m;let n=["---","type: missed-trade","isMissedTrade: true",`entryTime: ${this.formatDateForFrontmatter(r.entryTime)}`,`exitTime: ${this.formatDateForFrontmatter(r.exitTime||r.entryTime)}`,`entryPrice: ${r.entryPrice||0}`,`exitPrice: ${r.exitPrice||0}`,`positionSize: ${r.positionSize||0}`,r.direction?`direction: ${r.direction}`:null,r.optionType?`optionType: ${r.optionType}`:null,`instrument: ${r.instrument}`,(()=>{let f=r.useDirectPnLInput&&r.directPnL!==void 0?this.calculateNetPnL(r):r.pnl;return f!==void 0?`pnl: ${f}`:null})(),r.useDirectPnLInput!==void 0?`useDirectPnLInput: ${r.useDirectPnLInput}`:null,r.directPnL!==void 0?`directPnL: ${r.directPnL}`:null,r.commission!==void 0?`commission: ${r.commission}`:null,r.commissionType!==void 0?`commissionType: ${r.commissionType}`:null,r.fees!==void 0?`fees: ${r.fees}`:null,r.assetType?`assetType: ${r.assetType}`:null,r.thesis!==void 0?`thesis: ${this.formatThesisForYAML(r.thesis||"")}`:null,r.missedReason!==void 0?`missedReason: ${JSON.stringify(r.missedReason||"")}`:null,(i=r.setupIds)!=null&&i.length?`setupIds: [${r.setupIds.map(f=>`"${f}"`).join(", ")}]`:null,(s=r.mistakeIds)!=null&&s.length?`mistakeIds: [${r.mistakeIds.map(f=>`"${f}"`).join(", ")}]`:null,(l=r.accountIds)!=null&&l.length?`accountIds: [${r.accountIds.map(f=>`"${f}"`).join(", ")}]`:null,(c=r.setup)!=null&&c.length?`setup: [${r.setup.map(f=>`"${f}"`).join(", ")}]`:null,(d=r.mistake)!=null&&d.length?`mistake: [${r.mistake.map(f=>`"${f}"`).join(", ")}]`:null,(u=r.account)!=null&&u.length?`account: [${r.account.map(f=>`"${f}"`).join(", ")}]`:null,(p=r.images)!=null&&p.length?`images: [${r.images.map(f=>`"${f.trim()}"`).join(", ")}]`:null,"tags: []"],o=new Set(["type","isMissedTrade","entryTime","exitTime","entryPrice","exitPrice","positionSize","direction","optionType","instrument","pnl","useDirectPnLInput","directPnL","commission","commissionType","fees","assetType","thesis","missedReason","setupIds","mistakeIds","accountIds","setup","mistake","account","images","tags","notes","customFields"]);if(r.customFields)try{let f=(m=this.plugin)==null?void 0:m.customFieldsService;if(f){let g=f.getFields();Object.entries(r.customFields).forEach(([v,h])=>{if(h!=null&&h!==""){let y=g.find(b=>b.id===v);y&&y.fieldKey?Array.isArray(h)?n.push(`${y.fieldKey}: [${h.map(b=>JSON.stringify(b)).join(", ")}]`):typeof h=="string"?n.push(`${y.fieldKey}: ${JSON.stringify(h)}`):n.push(`${y.fieldKey}: ${h}`):Array.isArray(h)?n.push(`${v}: [${h.map(b=>JSON.stringify(b)).join(", ")}]`):typeof h=="string"?n.push(`${v}: ${JSON.stringify(h)}`):n.push(`${v}: ${h}`)}})}else Object.entries(r.customFields).forEach(([g,v])=>{v!=null&&v!==""&&(Array.isArray(v)?n.push(`${g}: [${v.map(h=>JSON.stringify(h)).join(", ")}]`):typeof v=="string"?n.push(`${g}: ${JSON.stringify(v)}`):n.push(`${g}: ${v}`))})}catch(f){console.error("Error mapping custom field IDs to keys in missed trade:",f),Object.entries(r.customFields).forEach(([g,v])=>{v!=null&&v!==""&&(Array.isArray(v)?n.push(`${g}: [${v.map(h=>JSON.stringify(h)).join(", ")}]`):typeof v=="string"?n.push(`${g}: ${JSON.stringify(v)}`):n.push(`${g}: ${v}`))})}return Object.keys(r).forEach(f=>{if(!o.has(f)&&r[f]!==void 0&&r[f]!==null){let g=r[f];Array.isArray(g)?n.push(`${f}: [${g.map(v=>JSON.stringify(v)).join(", ")}]`):typeof g=="string"?n.push(`${f}: ${JSON.stringify(g)}`):typeof g=="object"?n.push(`${f}: ${JSON.stringify(g)}`):n.push(`${f}: ${g}`)}}),n.push("---"),[...n,"","# Missed Trade Notes","",r.notes||"Add any additional notes about this missed trade here."].filter(f=>f!==null).join(`
`)}getTargetFolderPath(r){let n=r.getFullYear(),o=String(r.getMonth()+1).padStart(2,"0"),a=this.getWeekOfMonth(r);return this.folderPathService.getPath(n.toString(),o,a,this.tradesFolder)}getWeekOfMonth(r){return ss(r)}formatDateForFilename(r,n){let o=r.getFullYear(),a=String(r.getMonth()+1).padStart(2,"0"),i=String(r.getDate()).padStart(2,"0");switch(n){case"DDMMYY":return`${i}${a}${String(o).slice(2)}`;case"MMDDYY":return`${a}${i}${String(o).slice(2)}`;case"YYMMDD":return`${String(o).slice(2)}${a}${i}`;default:return`${i}${a}${String(o).slice(2)}`}}sanitizeTickerForFilename(r){if(!r)return"UNKNOWN";let n=r.trim().toUpperCase();if(n=n.replace(/[\\\/:\*\?"<>|\+]/g,"").replace(/[\s.\[\]\(\)\{\}#%&=;]/g,"-").replace(/--+/g,"-").replace(/^-|-$/g,""),!n)return"UNKNOWN";let o=20;return n.length>o&&(n=n.substring(0,o)),n}async listFilesInFolder(r){try{return(await this.app.vault.adapter.list(r)).files||[]}catch(n){return[]}}formatDateForFrontmatter(r){return r.toISOString()}formatThesisForYAML(r){if(!r||r.trim()==="")return'""';let n=r.trim();return n.includes(`
`)?`|
    ${n.replace(/\n/g,`
    `)}`:/[:|>[\]{}*&!%@`]/.test(n)||n.startsWith('"')||n.startsWith("'")||n.endsWith('"')||n.endsWith("'")||n.match(/^\s/)||n.match(/\s$/)?`"${n.replace(/"/g,'\\"')}"`:n}calculateNetPnL(r){let n=r.directPnL||0;if(r.commission!==void 0){let o=r.commissionType||"fixed",a=0;o==="percentage"?a=Math.abs(n)*r.commission/100:a=r.commission,n-=a}return r.fees!==void 0&&(r.fees<0?n+=r.fees:n-=r.fees),r.swap!==void 0&&(r.swap<0?n+=r.swap:n-=r.swap),n}}});var Gb,TL,Vce=L(()=>{rf();Gb=require("obsidian");wt();TL=class extends Qi{constructor(r,n,o={}){let a=n.serviceManager,i=a==null?void 0:a.getFolderPathService(),s=(i==null?void 0:i.journalFolderPath)||"!Journalit";super(r,{folder:s,extension:".md",namespace:"backtest-trade",enableIndexing:!0,...o});this.recentlyCreatedFiles=new Set;this.tradesFolder="trades";this.setPlugin(n),this.folderPathService=i||{journalFolderPath:"!Journalit",getPath:(...l)=>(0,Gb.normalizePath)(["!Journalit",...l].join("/")),isJournalPath:l=>l.startsWith("!Journalit/")}}getPlugin(){if(!this.plugin)throw new Error("Plugin not initialized");return this.plugin}setPlugin(r){super.setPlugin(r),r.registerEvent(r.app.vault.on("delete",async n=>{if(n.path.endsWith(".md")&&/-B\d+\.md$/.test(n.path)){let o=(0,Gb.normalizePath)(n.path);await this.handleBacktestTradeDeletion(o)}}))}async createBacktestTrade(r,n={}){var o,a;try{let{openFile:i=!0,images:s=[],customFields:l={}}=n;if(!r.instrument||!r.entryTime)return console.error("[BacktestTradeService] Missing required data:",{instrument:r.instrument,entryTime:r.entryTime}),null;let c=r.entryTime instanceof Date?r.entryTime:new Date(r.entryTime),d=new Date(c.getFullYear(),c.getMonth(),c.getDate()),u=r.instrument.toUpperCase(),p=await this.getTargetFolderPath(d);if(!p)return console.error("[BacktestTradeService] Failed to determine target folder path"),null;let m=await this.getBacktestTradeNumberForDay(u,d),f=this.getPlugin().settings.trade.dateFormat||"DDMMYY",g=this.formatDateForFile(d,f),v=`${u}-${g}-B${m}.md`,h=`${p}/${v}`;if(this.recentlyCreatedFiles.has(h))return console.warn("[BacktestTradeService] File creation already in progress:",h),null;this.recentlyCreatedFiles.add(h);try{let y={type:"backtest-trade",isBacktestTrade:!0,entryTime:r.entryTime?this.formatDateForFrontmatter(r.entryTime):void 0,exitTime:r.exitTime?this.formatDateForFrontmatter(r.exitTime):void 0,entryPrice:r.entryPrice,exitPrice:r.exitPrice,positionSize:r.positionSize,direction:r.direction,entries:(o=r.entries)==null?void 0:o.map(w=>({time:this.formatDateForFrontmatter(w.time),price:w.price,size:w.size})),exits:(a=r.exits)==null?void 0:a.map(w=>({time:this.formatDateForFrontmatter(w.time),price:w.price,size:w.size})),setupIds:r.setupIds,mistakeIds:r.mistakeIds,accountIds:r.accountIds,thesis:this.formatThesisForYAML(r.thesis||""),images:r.images,instrument:r.instrument,assetType:r.assetType,setup:r.setup,mistake:r.mistake,account:r.account,commission:r.commission,fees:r.fees,pnl:r.useDirectPnLInput&&r.directPnL!==void 0?this.calculateNetPnL(r):void 0,useDirectPnLInput:r.useDirectPnLInput,directPnL:r.directPnL,isMissedTrade:r.isMissedTrade,missedReason:r.missedReason,...l,tags:r.customTags&&Array.isArray(r.customTags)&&r.customTags.length>0?r.customTags.map(w=>String(w).trim()).filter(w=>w.length>0):[]};if(r.assetType==="stock"?r.exchange&&(y.exchange=r.exchange):r.assetType==="options"?(r.expirationDate&&(y.expirationDate=this.formatDateForFrontmatter(r.expirationDate)),r.strikePrice!==void 0&&(y.strikePrice=r.strikePrice),r.optionType&&(y.optionType=r.optionType),r.contractSize!==void 0&&(y.contractSize=r.contractSize)):r.assetType==="futures"?(r.dollarPerPoint!==void 0&&(y.dollarPerPoint=r.dollarPerPoint),r.tickSize!==void 0&&(y.tickSize=r.tickSize),r.tickValue!==void 0&&(y.tickValue=r.tickValue)):r.assetType==="forex"?(r.lotSize!==void 0&&(y.lotSize=r.lotSize),r.pipValue!==void 0&&(y.pipValue=r.pipValue)):r.assetType==="crypto"?r.cryptoExchange&&(y.cryptoExchange=r.cryptoExchange):r.assetType==="cfd"&&r.leverageRatio!==void 0&&(y.leverageRatio=r.leverageRatio),await this.app.vault.adapter.exists(h))return console.warn("[BacktestTradeService] File already exists:",h),null;let x=await this.app.vault.create(h,"");return await this.updateFrontmatter(x,y),s.length>0&&await this.copyImagesToTradeFolder(s,x,`B${m}`),i&&await this.getPlugin().openFile(x.path,!0),setTimeout(()=>{let w=new CustomEvent("journalit:backtest-trade-data-changed",{detail:{action:"created",filePath:h,timestamp:Date.now()}});document.dispatchEvent(w)},500),x}finally{setTimeout(()=>this.recentlyCreatedFiles.delete(h),5e3)}}catch(i){return console.error("[BacktestTradeService] Failed to create backtest trade:",i),null}}async updateBacktestTrade(r,n){var o,a;try{let i=this.app.vault.getAbstractFileByPath(n);if(!i||!(i instanceof Gb.TFile))return console.error("[BacktestTradeService] File not found:",n),!1;let s={type:"backtest-trade",isBacktestTrade:!0,entryTime:r.entryTime?this.formatDateForFrontmatter(r.entryTime):void 0,exitTime:r.exitTime?this.formatDateForFrontmatter(r.exitTime):void 0,entryPrice:r.entryPrice,exitPrice:r.exitPrice,positionSize:r.positionSize,direction:r.direction,entries:(o=r.entries)==null?void 0:o.map(l=>({time:this.formatDateForFrontmatter(l.time),price:l.price,size:l.size})),exits:(a=r.exits)==null?void 0:a.map(l=>({time:this.formatDateForFrontmatter(l.time),price:l.price,size:l.size})),setupIds:r.setupIds,mistakeIds:r.mistakeIds,accountIds:r.accountIds,thesis:this.formatThesisForYAML(r.thesis||""),images:r.images,instrument:r.instrument,assetType:r.assetType,setup:r.setup,mistake:r.mistake,account:r.account,commission:r.commission,fees:r.fees,pnl:r.useDirectPnLInput&&r.directPnL!==void 0?this.calculateNetPnL(r):void 0,useDirectPnLInput:r.useDirectPnLInput,directPnL:r.directPnL,isMissedTrade:r.isMissedTrade,missedReason:r.missedReason,tags:r.customTags&&Array.isArray(r.customTags)&&r.customTags.length>0?r.customTags.map(l=>String(l).trim()).filter(l=>l.length>0):[]};return r.assetType==="stock"?r.exchange&&(s.exchange=r.exchange):r.assetType==="options"?(r.expirationDate&&(s.expirationDate=this.formatDateForFrontmatter(r.expirationDate)),r.strikePrice!==void 0&&(s.strikePrice=r.strikePrice),r.optionType&&(s.optionType=r.optionType),r.contractSize!==void 0&&(s.contractSize=r.contractSize)):r.assetType==="futures"?(r.dollarPerPoint!==void 0&&(s.dollarPerPoint=r.dollarPerPoint),r.tickSize!==void 0&&(s.tickSize=r.tickSize),r.tickValue!==void 0&&(s.tickValue=r.tickValue)):r.assetType==="forex"?(r.lotSize!==void 0&&(s.lotSize=r.lotSize),r.pipValue!==void 0&&(s.pipValue=r.pipValue)):r.assetType==="crypto"?r.cryptoExchange&&(s.cryptoExchange=r.cryptoExchange):r.assetType==="cfd"&&r.leverageRatio!==void 0&&(s.leverageRatio=r.leverageRatio),await this.updateFrontmatter(i,s),setTimeout(()=>{let l=new CustomEvent("journalit:backtest-trade-data-changed",{detail:{action:"updated",filePath:n,timestamp:Date.now()}});document.dispatchEvent(l)},0),!0}catch(i){return console.error("[BacktestTradeService] Failed to update backtest trade:",i),!1}}async handleBacktestTradeDeletion(r){console.log("Handling backtest trade deletion:",r),this.clearCache(),setTimeout(()=>{let n=new CustomEvent("journalit:backtest-trade-data-changed",{detail:{action:"deleted",filePath:r,timestamp:Date.now()}});document.dispatchEvent(n),console.log("Emitted backtest trade deletion event:",r)},500)}getAllBacktestTradeFiles(){return this.app.vault.getMarkdownFiles().filter(n=>{let o=this.folderPathService.journalFolderPath;return!n.path.includes("/trades/")&&!this.folderPathService.isJournalPath(n.path)?!1:/(-B\d+\.md$|TMB.*\.md$)/.test(n.path)})}async getBacktestTrades(r,n){try{return await this.query(async()=>{let a=this.getAllBacktestTradeFiles(),i=[];for(let s of a)try{let l=this.app.metadataCache.getFileCache(s),c=l==null?void 0:l.frontmatter;if(!c||c.type!=="backtest-trade")continue;if(i.length%20===0&&await new Promise(u=>setTimeout(u,0)),c.entryTime){let u=new Date(c.entryTime);if(u<r||u>n)continue}let d={...c,filePath:s.path,isBacktestTrade:!0};i.push(d)}catch(l){console.error(`[BacktestTradeService] Error processing file ${s.path}:`,l)}return i},`backtest-trades-${r.getTime()}-${n.getTime()}`)}catch(o){return console.error("[BacktestTradeService] Failed to get backtest trades:",o),[]}}async getBacktestTradeFiles(r,n){try{return await this.query(async()=>{let a=this.getAllBacktestTradeFiles(),i=[];for(let s of a)try{let l=this.app.metadataCache.getFileCache(s),c=l==null?void 0:l.frontmatter;if(!c||c.type!=="backtest-trade")continue;if(i.length%20===0&&await new Promise(u=>setTimeout(u,0)),c.entryTime){let u=new Date(c.entryTime);if(u<r||u>n)continue}let d={...c,filePath:s.path,isBacktestTrade:!0};i.push({file:s,data:d})}catch(l){console.error(`[BacktestTradeService] Error processing file ${s.path}:`,l)}return i},`backtest-trade-files-${r.getTime()}-${n.getTime()}`)}catch(o){return console.error("[BacktestTradeService] Failed to get backtest trade files:",o),[]}}async updateBacktestTradeReviewStatus(r,n,o){try{let a=this.app.vault.getAbstractFileByPath(r);if(!a||!(a instanceof Gb.TFile))return!1;let i=await this.readFrontmatter(a);return await this.updateFrontmatter(a,{...i,reviewed:n,reviewedAt:o||(n?new Date().toISOString():void 0)}),setTimeout(()=>{let s=new CustomEvent("journalit:backtest-trade-data-changed",{detail:{action:"updated",filePath:a.path,timestamp:Date.now()}});document.dispatchEvent(s)},0),!0}catch(a){return console.error("[BacktestTradeService] Failed to update review status:",a),!1}}async getBacktestTradeNumberForDay(r,n){try{let o=await this.getTargetFolderPath(n);if(!o||!await this.app.vault.adapter.exists(o))return 1;let s=(await this.app.vault.adapter.list(o)).files||[],l=this.getPlugin().settings.trade.dateFormat||"DDMMYY",c=this.formatDateForFile(n,l),d=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),u=new RegExp(`^${d}-${c}-B(\\d+)\\.md$`),p=[];for(let f of s){let v=(f.split("/").pop()||f).match(u);v&&p.push(parseInt(v[1],10))}return p.length>0?Math.max(...p)+1:1}catch(o){return console.error("[BacktestTradeService] Failed to get backtest trade number:",o),1}}async getTargetFolderPath(r){let n=r.getFullYear(),o=String(r.getMonth()+1).padStart(2,"0"),a=ss(r),i=this.folderPathService.getPath(n.toString(),o,a,this.tradesFolder);return await this.app.vault.adapter.mkdir(i),i}formatDateForFile(r,n){let o=r.getDate().toString().padStart(2,"0"),a=(r.getMonth()+1).toString().padStart(2,"0"),i=r.getFullYear().toString().slice(-2);switch(n.toUpperCase()){case"MMDDYY":return`${a}${o}${i}`;case"YYMMDD":return`${i}${a}${o}`;case"DDMMYY":default:return`${o}${a}${i}`}}async copyImagesToTradeFolder(r,n,o){}formatDateForFrontmatter(r){try{let n=r instanceof Date?r:new Date(r);if(isNaN(n.getTime()))return console.error(`Invalid date value: ${r}, returning as-is`),String(r);let o=n.getFullYear(),a=String(n.getMonth()+1).padStart(2,"0"),i=String(n.getDate()).padStart(2,"0"),s=String(n.getHours()).padStart(2,"0"),l=String(n.getMinutes()).padStart(2,"0"),c=String(n.getSeconds()).padStart(2,"0");return`${o}-${a}-${i}T${s}:${l}:${c}`}catch(n){return console.error(`Error formatting date: ${r}`,n),r instanceof Date?r.toISOString():String(r)}}formatThesisForYAML(r){if(!r||r.trim()==="")return'""';let n=r.trim();return n.includes(`
`)?`|
    ${n.replace(/\n/g,`
    `)}`:/[:|>[\]{}*&!%@`]/.test(n)||n.startsWith('"')||n.startsWith("'")||n.endsWith('"')||n.endsWith("'")||n.match(/^\s/)||n.match(/\s$/)?`"${n.replace(/"/g,'\\"')}"`:n}calculateNetPnL(r){let n=r.directPnL||0;if(r.commission!==void 0){let o=r.commissionType||"fixed",a=0;o==="percentage"?a=Math.abs(n)*r.commission/100:a=r.commission,n-=a}return r.fees!==void 0&&(r.fees<0?n+=r.fees:n-=r.fees),r.swap!==void 0&&(r.swap<0?n+=r.swap:n-=r.swap),n}}});var NS,Hce=L(()=>{rf();di();wt();ga();Ut();NS=class extends Qi{constructor(r,n={}){super(r,{cacheTTL:120*1e3,persistCache:!0,namespace:n.namespace||"accountPage",...n});this.folderPathService=null;this.tradeDataChangeHandler=o=>{this.clearCache()},document.addEventListener("journalit:trade-data-changed",this.tradeDataChangeHandler),document.addEventListener("journalit:missed-trade-data-changed",this.tradeDataChangeHandler)}setPlugin(r){var n;super.setPlugin(r),this.folderPathService=((n=r.serviceManager)==null?void 0:n.getFolderPathService())||null}safeParseDate(r){if(r instanceof Date&&!isNaN(r.getTime()))return r;if(r!=null&&r!=="")try{let n=new Date(r);if(!isNaN(n.getTime()))return n}catch(n){}return null}getAccountMetadata(r){var a,i;if(!((i=(a=this.plugin)==null?void 0:a.settings.account)!=null&&i.accountMetadata))return;let n=this.plugin.settings.account.accountMetadata[r];if(!n){console.log(`AccountPageService.getAccountMetadata: No metadata found for "${r}"`);return}return{...n,createdDate:n.createdDate instanceof Date?n.createdDate:this.safeParseDate(n.createdDate)||new Date,profitTargetDate:n.profitTargetDate?n.profitTargetDate instanceof Date?n.profitTargetDate:this.safeParseDate(n.profitTargetDate)||void 0:void 0,lastUpdated:n.lastUpdated instanceof Date?n.lastUpdated:this.safeParseDate(n.lastUpdated)||new Date,manualTransactions:n.manualTransactions?n.manualTransactions.filter(s=>s!=null).map(s=>{let l=s.date instanceof Date?s.date:this.safeParseDate(s.date);return!l||isNaN(l.getTime())?(console.warn("AccountPageService: Skipping transaction with invalid date:",s),null):{...s,date:l}}).filter(s=>!(s==null||typeof s.id!="string"||!s.id||!(s.date instanceof Date)||typeof s.type!="string"||!s.type||typeof s.amount!="number"||isNaN(s.amount)||typeof s.balanceAfter!="number"||isNaN(s.balanceAfter))):void 0,manualDrawdownSnapshots:n.manualDrawdownSnapshots?n.manualDrawdownSnapshots.filter(s=>s!=null).map(s=>{let l=s.date instanceof Date?s.date:this.safeParseDate(s.date);return!l||isNaN(l.getTime())?(console.warn("AccountPageService: Skipping snapshot with invalid date:",s),null):{...s,date:l}}).filter(s=>!(s==null||!(s.date instanceof Date)||typeof s.drawdownLimit!="number"||isNaN(s.drawdownLimit))):void 0}}async saveAccountMetadata(r,n){var o,a;if(!((o=this.plugin)!=null&&o.settings.account)){if(!((a=this.plugin)!=null&&a.settings))throw new Error("Plugin settings not initialized - cannot save account metadata");this.plugin.settings.account={defaultAccountType:"demo",defaultDrawdownType:"none",defaultDrawdownAmount:0,showBalanceInDashboard:!0,excludedAccountTypes:["archived"],includeWithdrawalsFromExcluded:{archived:!0,demo:!1},accountTypeOrder:["funded","evaluation","demo","archived"],accountMetadata:{}}}this.plugin.settings.account.accountMetadata||(this.plugin.settings.account.accountMetadata={}),this.plugin.settings.account.accountMetadata[r]=n,await this.plugin.saveSettings()}createAccountDataFromTrades(r,n,o){let a=n.filter(u=>!Pt({tradeStatus:u.tradeStatus,exitTime:u.exitTime,pnl:u._originalPnlWasNull?null:u.pnl,useDirectPnLInput:u.useDirectPnLInput,exits:u.exits,entries:u.entries})),i=this.calculateAccountMetrics(a),s=(o==null?void 0:o.initialBalance)||this.estimateInitialBalance(n),l=(o==null?void 0:o.createdDate)||this.estimateCreationDate(n),c=s+i.totalPnL,d={id:`account-${r.replace(/[^a-zA-Z0-9]/g,"-")}`,name:r,accountType:(o==null?void 0:o.accountType)||"demo",initialBalance:s,currentBalance:c,drawdownType:(o==null?void 0:o.drawdownType)||"none",drawdownAmount:(o==null?void 0:o.drawdownAmount)||0,maxDrawdownReached:c<s?c:s,hasProfitTarget:(o==null?void 0:o.hasProfitTarget)||!1,profitTarget:(o==null?void 0:o.profitTarget)||0,profitTargetType:(o==null?void 0:o.profitTargetType)||"absolute",profitTargetDate:o==null?void 0:o.profitTargetDate,monthlyCost:(o==null?void 0:o.monthlyCost)||0,createdDate:l,lastUpdated:new Date,metrics:{totalTrades:i.totalTrades,winningTrades:i.winningTrades,losingTrades:i.losingTrades,breakEvenTrades:i.totalTrades-i.winningTrades-i.losingTrades,winRate:i.winRate,totalPnL:i.totalPnL,bestTrade:n.length>0?Math.max(...n.map(u=>u.pnl)):0,worstTrade:n.length>0?Math.min(...n.map(u=>u.pnl)):0,profitFactor:i.profitFactor,averageWin:i.avgWin,averageLoss:i.avgLoss,maxDrawdown:s-(c<s?c:s),totalWithdrawals:0},transactions:[],dailyBalances:[],notePath:""};if(o!=null&&o.manualDrawdownSnapshots&&d.drawdownType==="manual"){let u=new Date,p=o.manualDrawdownSnapshots.filter(m=>m&&m.date).filter(m=>{let f=m.date instanceof Date?m.date:this.safeParseDate(m.date);return f&&!isNaN(f.getTime())&&f<=u&&m.drawdownLimit>0}).sort((m,f)=>{let g=m.date instanceof Date?m.date:this.safeParseDate(m.date),v=f.date instanceof Date?f.date:this.safeParseDate(f.date);return((v==null?void 0:v.getTime())||0)-((g==null?void 0:g.getTime())||0)})[0];if(p){let m=p.date instanceof Date?p.date:this.safeParseDate(p.date);d.currentDrawdownSnapshot={date:new Date(m||new Date),drawdownLimit:p.drawdownLimit,note:p.note}}}return o!=null&&o.manualDrawdownSnapshots&&d.drawdownType==="manual"&&(d.allDrawdownSnapshots=[...o.manualDrawdownSnapshots].filter(u=>u&&u.date).filter(u=>{let p=u.date instanceof Date?u.date:this.safeParseDate(u.date);return p&&!isNaN(p.getTime())}).sort((u,p)=>{let m=u.date instanceof Date?u.date:this.safeParseDate(u.date),f=p.date instanceof Date?p.date:this.safeParseDate(p.date);return((m==null?void 0:m.getTime())||0)-((f==null?void 0:f.getTime())||0)})),d}estimateCreationDate(r){if(r.length===0)return new Date;let n=r.reduce((a,i)=>{let s=i.entryTime instanceof Date?i.entryTime:this.safeParseDate(i.entryTime),l=a.entryTime instanceof Date?a.entryTime:this.safeParseDate(a.entryTime);return s?l?s<l?i:a:i:a}),o=n.entryTime instanceof Date&&!isNaN(n.entryTime.getTime())?new Date(n.entryTime):this.safeParseDate(n.entryTime);if(!o||isNaN(o.getTime())){let a=new Date;return a.setMonth(0,1),a.setHours(0,0,0,0),console.warn("AccountPageService: Could not determine account creation date, using fallback"),a}return o.setDate(o.getDate()-1),o.setHours(0,0,0,0),o}async getAccountPageData(r){let n=`accountPage:${r}`;try{return await this.query(async()=>{var p,m,f;if(!((p=this.plugin)!=null&&p.tradeService)){let g=0;for(;!((m=this.plugin)!=null&&m.tradeService)&&g<3;)await new Promise(v=>setTimeout(v,300)),g++;if(!((f=this.plugin)!=null&&f.tradeService))throw new Error("TradeService not available after retries - services may still be initializing")}let o=await this.getAccountTrades(r),a=this.getAccountMetadata(r);if(o.length===0&&!a)return null;let i=this.createAccountDataFromTrades(r,o,a),s=o.filter(g=>!Pt({tradeStatus:g.tradeStatus,exitTime:g.exitTime,pnl:g._originalPnlWasNull?null:g.pnl,useDirectPnLInput:g.useDirectPnLInput,exits:g.exits,entries:g.entries})),l=this.calculateAccountMetrics(s),c=await this.enhanceAccountWithTransactions(i,o,l),d=c.currentBalance-c.initialBalance,u={...l,totalPnL:d};return{account:c,trades:o,metrics:u}},n,{offlineCapable:!0})}catch(o){return console.error(`Error getting account page data for ${r}:`,o),null}}async getAccountTrades(r){let n=`accountTrades:${r}`;try{return await this.query(async()=>{var u,p,m;let o=[],a=0,i=5;for(;a<i;){if(!((u=this.plugin)!=null&&u.tradeService)){await new Promise(y=>setTimeout(y,300)),a++;continue}await this.plugin.tradeService.clearCache(),await new Promise(y=>setTimeout(y,300));try{let y=this.plugin.app.vault.adapter;if(y&&y.list){let b=((p=this.folderPathService)==null?void 0:p.journalFolderPath)||"!Journalit";await y.list(b).catch(()=>{})}}catch(y){}let f=new Date("2000-01-01"),g=new Date("2099-12-31"),v=await this.plugin.tradeService.getTrades(f,g);o=[];for(let y of v){let b=await this.plugin.tradeService.extractTradeData(y);if(b){let x=((m=this.plugin.app.metadataCache.getFileCache(y))==null?void 0:m.frontmatter)||{},w=x.pnl===null||x.pnl===void 0;o.push({...b,path:y.path,_originalPnlWasNull:w})}}let h=o.filter(y=>y.path&&y.path.trim()!=="");if(o.length>0&&h.length===0){await new Promise(y=>setTimeout(y,500)),a++;continue}a>0&&await this.clearCache();break}if(a>=i)throw new Error(`TradeService failed to load properly after ${i} attempts`);let c=o.filter(f=>{let g=v=>v?Array.isArray(v)?v.includes(r):typeof v=="string"?v===r:!1:!1;return g(f.account)||g(f.accountIds)}).filter((f,g)=>f.entryTime!==null&&f.entryTime!==void 0&&f.entryTime!==""?this.safeParseDate(f.entryTime)?f.exitTime!==null&&f.exitTime!==void 0&&f.exitTime!==""&&!this.safeParseDate(f.exitTime)?(console.warn(`AccountPageService: Skipping trade (${f.path}) - unparseable exit time`),!1):!0:(console.warn(`AccountPageService: Skipping trade (${f.path}) - unparseable entry time`),!1):(console.warn(`AccountPageService: Skipping trade (${f.path}) - missing entry time`),!1)).map(f=>{let g=this.safeParseDate(f.entryTime),v=f.exitTime?this.safeParseDate(f.exitTime):null;return{path:f.path||"",instrument:f.instrument||"Unknown",direction:f.direction||(f.assetType==="options"&&f.optionType?f.optionType:"Unknown"),entryPrice:parseFloat(f.entryPrice)||0,exitPrice:v&&parseFloat(f.exitPrice)||0,positionSize:parseFloat(f.positionSize)||0,pnl:v&&parseFloat(f.pnl)||0,commission:parseFloat(f.commission)||0,swap:parseFloat(f.swap)||0,fees:parseFloat(f.fees)||0,rebate:f.rebate!=null&&f.rebate!==""?parseFloat(f.rebate):void 0,entryTime:g,exitTime:v,setup:f.setup||[],mistake:f.mistake||[],tags:f.customTags||[],reviewed:f.reviewed||!1,assetType:f.assetType,optionType:f.optionType,rMultiple:f.rMultiple!==void 0&&f.rMultiple!==null?parseFloat(f.rMultiple):void 0,riskAmount:f.riskAmount!==void 0?parseFloat(f.riskAmount):void 0}});if(c.filter(f=>!f.path||f.path.trim()==="").length>0)throw new Error(`Refusing to cache trades without paths for account "${r}". This prevents UI issues.`);return c},n,{offlineCapable:!0})}catch(o){return console.error(`Error getting trades for account ${r}:`,o),[]}}calculateAccountMetrics(r){var k,T,P,D,O,z,I;if(r.length===0)return{totalTrades:0,winningTrades:0,losingTrades:0,winRate:0,totalPnL:0,avgWin:0,avgLoss:0,avgWinRMultiple:void 0,avgLossRMultiple:void 0,profitFactor:0,totalCommission:0,totalSwap:0,totalFees:0};let n=r.length,o=r.reduce((A,j)=>A+j.commission,0),a=r.reduce((A,j)=>A+j.swap,0),i=r.reduce((A,j)=>A+j.fees,0),s=r.reduce((A,j)=>{var E;return A+((E=j.pnl)!=null?E:0)},0),l=(T=(k=this.plugin)==null?void 0:k.settings.trade.breakEvenRangeMin)!=null?T:0,c=(D=(P=this.plugin)==null?void 0:P.settings.trade.breakEvenRangeMax)!=null?D:0,d=r.filter(A=>{var j;return((j=A.pnl)!=null?j:0)>c}),u=r.filter(A=>{var j;return((j=A.pnl)!=null?j:0)<l}),p=n>0?d.length/n*100:0,m=d.reduce((A,j)=>{var E;return A+((E=j.pnl)!=null?E:0)},0),f=Math.abs(u.reduce((A,j)=>{var E;return A+((E=j.pnl)!=null?E:0)},0)),g=d.length>0?m/d.length:0,v=u.length>0?f/u.length:0,h=(I=(z=(O=this.plugin)==null?void 0:O.settings)==null?void 0:z.trade)==null?void 0:I.defaultRiskAmount,y=d.map(A=>st(A.pnl,A.rMultiple,A.riskAmount,h)).filter(A=>A!==void 0),b=y.length>0?y.reduce((A,j)=>A+j,0)/y.length:void 0,x=u.map(A=>st(A.pnl,A.rMultiple,A.riskAmount,h)).filter(A=>A!==void 0),w=x.length>0?x.reduce((A,j)=>A+Math.abs(j),0)/x.length:void 0,S=0;return f>0?S=m/f:m>0?S=999:S=0,{totalTrades:n,winningTrades:d.length,losingTrades:u.length,winRate:p,totalPnL:s,avgWin:g,avgLoss:v,avgWinRMultiple:b,avgLossRMultiple:w,profitFactor:S,totalCommission:o,totalSwap:a,totalFees:i}}async getAccountTradesInRange(r,n,o){return(await this.getAccountTrades(r)).filter(i=>{let s=i.entryTime;return s>=n&&s<=o})}async getAccountInstruments(r){let n=await this.getAccountTrades(r);return[...new Set(n.map(a=>a.instrument))].filter(Boolean)}async getAccountSetups(r){let n=await this.getAccountTrades(r);return[...new Set(n.flatMap(a=>a.setup))].filter(Boolean)}estimateInitialBalance(r){if(r.length===0)return 1e4;let n=Math.max(...r.map(a=>Math.abs(a.positionSize)));if(n>0){let a=n*50,i=r.reduce((c,d)=>{var u;return c+((u=d.pnl)!=null?u:0)},0),s=1e4;i>0?s=Math.max(5e3,a):s=Math.max(1e4,a-i);let l=Math.max(a,s);return Math.min(1e6,Math.max(1e3,l))}let o=r.reduce((a,i)=>a+i.pnl,0);return o<-5e3?Math.abs(o)+1e4:o>5e3?Math.max(5e3,o*.5):1e4}async enhanceAccountWithTransactions(r,n,o){var b;let a={...r,currentDrawdownSnapshot:r.currentDrawdownSnapshot?{date:new Date(r.currentDrawdownSnapshot.date),drawdownLimit:r.currentDrawdownSnapshot.drawdownLimit,note:r.currentDrawdownSnapshot.note}:void 0},i=!1;if(r.transactions&&r.transactions.length>0){let x=r.transactions.find(w=>w.type==="deposit"&&w.description==="Initial deposit");if(x){let w=new Date(r.createdDate),S=new Date(x.date);Math.abs(w.getTime()-S.getTime())/(1e3*60*60*24)>2&&(i=!0)}}if(r.transactions&&r.transactions.length>1&&!i){let x=r.transactions.map(O=>{let z=O.date instanceof Date?O.date:this.safeParseDate(O.date);return z?{...O,date:z}:(console.warn("AccountPageService: Skipping existing transaction with invalid date:",O),null)}).filter(O=>O!==null),w=this.getAccountMetadata(r.name);if(w!=null&&w.manualTransactions){let O=new Set(r.transactions.map(I=>I.id)),z=w.manualTransactions.filter(I=>!O.has(I.id)).map(I=>{let A=I.date instanceof Date?I.date:this.safeParseDate(I.date);return A?{...I,date:A}:(console.warn("AccountPageService: Skipping manual transaction with invalid date:",I),null)}).filter(I=>I!==null);x.push(...z)}let S=x.sort((O,z)=>new Date(O.date).getTime()-new Date(z.date).getTime()),k=0;for(let O of S)k+=O.amount,O.balanceAfter=k;a.transactions=S,a.currentBalance=k;let T={totalTrades:o.totalTrades,winningTrades:o.winningTrades,losingTrades:o.losingTrades,breakEvenTrades:o.totalTrades-o.winningTrades-o.losingTrades,winRate:o.winRate,totalPnL:o.totalPnL,bestTrade:n.length>0?Math.max(...n.map(O=>O.pnl)):0,worstTrade:n.length>0?Math.min(...n.map(O=>O.pnl)):0,profitFactor:o.profitFactor,averageWin:o.avgWin,averageLoss:o.avgLoss,maxDrawdown:r.maxDrawdownReached?r.initialBalance-r.maxDrawdownReached:0,totalWithdrawals:S.filter(O=>O.type==="withdrawal"||O.type==="deposit"&&O.amount<0).reduce((O,z)=>O+Math.abs(z.amount),0)};a.metrics=T;let P=[];if(S.length>0){let O=new Map;for(let I of S){let A=new Date(I.date),j=Oi(A),E=A.getFullYear();if(E<1970||E>2100){console.warn(`AccountPageService: Skipping existing transaction with corrupted date ${j} - year ${E} outside valid range`);continue}O.set(j,I.balanceAfter)}let z=Array.from(O.keys()).sort();for(let I of z){let A=O.get(I),j=r.initialBalance||0,E=Math.max(0,j-A);P.push({date:new Date(I),balance:A,drawdownLevel:E})}}let D=new Map;for(let O of P){let z=Oi(O.date);D.set(z,O)}return a.dailyBalances=Array.from(D.values()).sort((O,z)=>O.date.getTime()-z.date.getTime()),a}let s=[],l=this.getAccountMetadata(r.name),c=l!=null&&l.manualTransactions?l.manualTransactions.map(x=>{let w=x.date instanceof Date?x.date:this.safeParseDate(x.date);return w?{...x,date:w,balanceAfter:0}:(console.warn("AccountPageService: Skipping manual transaction with invalid date:",x),null)}).filter(x=>x!==null):[],d=c.some(x=>x.type==="deposit"&&x.description==="Initial deposit");if((!r.transactions||r.transactions.length===0||i)&&!d){let x=new Date(r.createdDate);x.setHours(0,0,0,0),s.push({id:`${r.id}-initial`,date:x,type:"deposit",amount:r.initialBalance,description:"Initial deposit",balanceAfter:0})}else!i&&r.transactions&&r.transactions.length>0&&s.push(...r.transactions);s.push(...c);let p=n.filter(x=>x.exitTime!==null&&x.exitTime!==void 0).map(x=>{let w=x.entryTime instanceof Date?x.entryTime:this.safeParseDate(x.entryTime),S=x.exitTime instanceof Date?x.exitTime:this.safeParseDate(x.exitTime);if(!w||!S)return console.warn(`AccountPageService: Skipping trade (${x.path}) - invalid dates`),null;let k=w.getFullYear(),T=S.getFullYear();return k<1970||k>2100||T<1970||T>2100?(console.warn(`AccountPageService: Skipping trade with corrupted dates (${x.path}) - year ${k}/${T} outside valid range`),null):{...x,entryTime:w,exitTime:S}}).filter(x=>x!==null);for(let x of p)s.push({id:`${r.id}-trade-${x.path.replace(/[^a-zA-Z0-9]/g,"-")}`,date:x.exitTime,type:"trade",amount:(b=x.pnl)!=null?b:0,description:`Trade P&L: ${x.path}`,tradeId:x.path,balanceAfter:0});let m=s.sort((x,w)=>new Date(x.date).getTime()-new Date(w.date).getTime()),f=0,g=m.findIndex(x=>x.type==="deposit"&&x.description==="Initial deposit");if(g>=0)for(let x=0;x<m.length;x++){let w=m[x];x===g?(f=r.initialBalance,w.balanceAfter=f):x<g?(x<=2&&console.warn(`AccountPageService: ${m.length-g} transactions before initial deposit (showing first few)`),f+=w.amount,w.balanceAfter=f):(f+=w.amount,w.balanceAfter=f)}else{console.warn("AccountPageService: No initial deposit found, using zero-based balance calculation");for(let x of m)f+=x.amount,x.balanceAfter=f}a.transactions=m,a.currentBalance=f;let v={totalTrades:o.totalTrades,winningTrades:o.winningTrades,losingTrades:o.losingTrades,breakEvenTrades:o.totalTrades-o.winningTrades-o.losingTrades,winRate:o.winRate,totalPnL:o.totalPnL,bestTrade:n.length>0?Math.max(...n.map(x=>x.pnl)):0,worstTrade:n.length>0?Math.min(...n.map(x=>x.pnl)):0,profitFactor:o.profitFactor,averageWin:o.avgWin,averageLoss:o.avgLoss,maxDrawdown:r.maxDrawdownReached?r.initialBalance-r.maxDrawdownReached:0,totalWithdrawals:m.filter(x=>x.type==="withdrawal"||x.type==="deposit"&&x.amount<0).reduce((x,w)=>x+Math.abs(w.amount),0)};a.metrics=v;let h=[];if(s.length>0){let x=[...s].sort((k,T)=>new Date(k.date).getTime()-new Date(T.date).getTime()),w=new Map;for(let k of x){let T=new Date(k.date),P=Oi(T),D=T.getFullYear();if(D<1970||D>2100){console.warn(`AccountPageService: Skipping transaction with corrupted date ${P} - year ${D} outside valid range`);continue}w.set(P,k.balanceAfter)}let S=Array.from(w.keys()).sort();for(let k of S){let T=w.get(k),P=r.initialBalance||0,D=Math.max(0,P-T);h.push({date:new Date(k),balance:T,drawdownLevel:D})}}let y=new Map;for(let x of h){let w=Oi(x.date);y.set(w,x)}return a.dailyBalances=Array.from(y.values()).sort((x,w)=>x.date.getTime()-w.date.getTime()),a}async refreshAccountData(r){var n;await this.clearCacheWithPrefix(`accountPage:${r}`),await this.clearCacheWithPrefix(`accountTrades:${r}`),await this.clearCacheWithPrefix("allEnhancedAccounts"),(n=this.plugin)!=null&&n.tradeService&&await this.plugin.tradeService.clearCache()}async getAllEnhancedAccounts(){let r="allEnhancedAccounts";try{return await this.query(async()=>{var s,l,c,d,u;if(!((s=this.plugin)!=null&&s.tradeService)){let p=0;for(;!((l=this.plugin)!=null&&l.tradeService)&&p<3;)await new Promise(m=>setTimeout(m,300)),p++;if(!((c=this.plugin)!=null&&c.tradeService))throw new Error("TradeService not available after retries - services may still be initializing")}let n=await this.plugin.tradeService.getUniqueAccounts(),o=Object.keys(((u=(d=this.plugin)==null?void 0:d.settings.account)==null?void 0:u.accountMetadata)||{}),a=[...new Set([...n,...o])];return await Promise.all(a.map(async p=>{try{let m=await this.getAccountTrades(p),f=this.getAccountMetadata(p),g=this.createAccountDataFromTrades(p,m,f),v=m.filter(x=>!Pt({tradeStatus:x.tradeStatus,exitTime:x.exitTime,pnl:x._originalPnlWasNull?null:x.pnl,useDirectPnLInput:x.useDirectPnLInput,exits:x.exits,entries:x.entries})),h=this.calculateAccountMetrics(v),y=await this.enhanceAccountWithTransactions(g,m,h),b=y.currentBalance-y.initialBalance;return y.metrics&&(y.metrics.totalPnL=b),y}catch(m){console.warn(`Failed to enhance account ${p}:`,m);let f=this.getAccountMetadata(p);return this.createAccountDataFromTrades(p,[],f)}}))},r,{offlineCapable:!0})}catch(n){return console.error("Error getting all enhanced accounts:",n),[]}}getCachedAccountNames(){return[]}async updateAccountMetadata(r,n){var a,i,s,l,c,d,u,p,m,f,g,v,h;if(!((a=this.plugin)!=null&&a.settings))throw new Error("Plugin not initialized - cannot update account metadata");let o=this.getAccountMetadata(r);try{let y=this.getAccountMetadata(r),b=await this.getAccountTrades(r),x={name:r,accountType:(s=(i=n.accountType)!=null?i:y==null?void 0:y.accountType)!=null?s:"demo",createdDate:(c=(l=n.createdDate)!=null?l:y==null?void 0:y.createdDate)!=null?c:this.estimateCreationDate(b),initialBalance:(u=(d=n.initialBalance)!=null?d:y==null?void 0:y.initialBalance)!=null?u:this.estimateInitialBalance(b),drawdownType:n.drawdownType!==void 0?n.drawdownType:(y==null?void 0:y.drawdownType)||"none",drawdownAmount:n.drawdownAmount!==void 0?n.drawdownAmount:(y==null?void 0:y.drawdownAmount)||0,hasProfitTarget:n.hasProfitTarget!==void 0?n.hasProfitTarget:(y==null?void 0:y.hasProfitTarget)||!1,profitTarget:n.profitTarget!==void 0?n.profitTarget:(y==null?void 0:y.profitTarget)||0,profitTargetType:(m=(p=n.profitTargetType)!=null?p:y==null?void 0:y.profitTargetType)!=null?m:"absolute",profitTargetDate:n.profitTargetDate!==void 0?n.profitTargetDate:y==null?void 0:y.profitTargetDate,monthlyCost:n.monthlyCost!==void 0?n.monthlyCost:(y==null?void 0:y.monthlyCost)||0,manualTransactions:n.manualTransactions!==void 0?n.manualTransactions:(y==null?void 0:y.manualTransactions)||[],manualDrawdownSnapshots:n.manualDrawdownSnapshots!==void 0?n.manualDrawdownSnapshots:(y==null?void 0:y.manualDrawdownSnapshots)||[],lastUpdated:new Date};await this.saveAccountMetadata(r,x),await this.refreshAccountData(r)}catch(y){console.error("Failed to save account metadata, rolling back:",y),o&&((g=(f=this.plugin)==null?void 0:f.settings.account)!=null&&g.accountMetadata)?this.plugin.settings.account.accountMetadata[r]=o:(h=(v=this.plugin)==null?void 0:v.settings.account)!=null&&h.accountMetadata&&delete this.plugin.settings.account.accountMetadata[r];try{await this.plugin.saveSettings()}catch(b){console.error("Failed to persist rollback to disk:",b)}try{await this.refreshAccountData(r)}catch(b){console.error("Failed to refresh cache after rollback:",b)}throw y}}async cleanCorruptedMetadata(){var o,a,i;if(!((i=(a=(o=this.plugin)==null?void 0:o.settings)==null?void 0:a.account)!=null&&i.accountMetadata))return console.log("No account metadata to clean"),{accountsCleaned:0,entriesRemoved:0};let r=0,n=0;for(let[s,l]of Object.entries(this.plugin.settings.account.accountMetadata)){let c=!1,d=0,u=0;if(l.manualDrawdownSnapshots&&Array.isArray(l.manualDrawdownSnapshots)){d+=l.manualDrawdownSnapshots.length;let p=l.manualDrawdownSnapshots.filter(m=>{if(!m||!m.date)return!1;let f=this.safeParseDate(m.date);return!f||isNaN(f.getTime())?(console.warn(`Removing corrupted snapshot from ${s}:`,m),!1):!0});u+=p.length,p.length!==l.manualDrawdownSnapshots.length&&(l.manualDrawdownSnapshots=p,c=!0)}if(l.manualTransactions&&Array.isArray(l.manualTransactions)){d+=l.manualTransactions.length;let p=l.manualTransactions.filter(m=>{if(!m||!m.date)return!1;let f=this.safeParseDate(m.date);return!f||isNaN(f.getTime())?(console.warn(`Removing corrupted transaction from ${s}:`,m),!1):!0});u+=p.length,p.length!==l.manualTransactions.length&&(l.manualTransactions=p,c=!0)}c&&(r++,n+=d-u,console.log(`Cleaned ${d-u} corrupted entries from account "${s}"`))}return r>0?(await this.plugin.saveSettings(),console.log(`Metadata recovery complete: ${r} accounts cleaned, ${n} corrupted entries removed`)):console.log("No corrupted metadata found"),{accountsCleaned:r,entriesRemoved:n}}async deleteAccount(r){var s,l,c;if(!this.plugin)throw new Error("Plugin not initialized");if((l=(s=this.plugin.settings.account)==null?void 0:s.accountMetadata)!=null&&l[r]&&(delete this.plugin.settings.account.accountMetadata[r],await this.plugin.saveSettings()),!this.plugin.tradeService)throw new Error("TradeService not available");let a=this.app.vault.getFiles().filter(d=>{var m,f;if(!d.path.endsWith(".md"))return!1;let u=(m=this.app.metadataCache.getFileCache(d))==null?void 0:m.frontmatter;if(u!=null&&u.isMissedTrade)return!1;if((u==null?void 0:u.type)==="trade")return!0;let p=((f=this.folderPathService)==null?void 0:f.journalFolderPath)||"!Journalit";return d.path.includes("/trades/")&&d.path.includes(`/${p}/`)}),i=`account/${this.formatTagForYAML(r)}`;for(let d of a)try{await this.app.fileManager.processFrontMatter(d,u=>{let p=!1;if(u.account&&Array.isArray(u.account)){let m=u.account.length;u.account=u.account.filter(f=>f&&f.trim()&&f.trim()!==r),u.account.length!==m&&(p=!0),u.account.length===0&&delete u.account}if(u.accountIds&&Array.isArray(u.accountIds)){let m=u.accountIds.length;u.accountIds=u.accountIds.filter(f=>f&&f.trim()&&f.trim()!==r),u.accountIds.length!==m&&(p=!0),u.accountIds.length===0&&delete u.accountIds}if(u.tags&&Array.isArray(u.tags)){let m=u.tags.length;u.tags=u.tags.filter(f=>f&&f.trim()&&f.trim()!==i),u.tags.length!==m&&(p=!0)}p&&console.debug(`Updated trade note references for deleted account: ${r}`)})}catch(u){console.error(`Error updating trade file ${d.path} during account deletion:`,u)}await this.clearCacheWithPrefix("allEnhancedAccounts"),await this.clearCacheWithPrefix("accountPage:"),await this.clearCacheWithPrefix("accountTrades:"),(c=this.plugin)!=null&&c.tradeService&&(await this.plugin.tradeService.clearCacheWithPrefix("trade:unique-accounts"),await this.plugin.tradeService.clearCacheWithPrefix("trade:unique-values")),console.log(`Account "${r}" has been successfully deleted and all references removed`)}formatTagForYAML(r){return r.trim().replace(/\s+/g,"-").toLowerCase().replace(/[^a-z0-9-]/g,"")}async refreshAllAccountData(){var r;await this.clearCacheWithPrefix("allEnhancedAccounts"),await this.clearCacheWithPrefix("accountPage:"),await this.clearCacheWithPrefix("accountTrades:"),(r=this.plugin)!=null&&r.tradeService&&await this.plugin.tradeService.clearCache()}async addManualDeposit(r,n,o,a){if(n<=0)throw new Error("Deposit amount must be positive");let s={id:this.generateTransactionId(),date:new Date(o),type:"deposit",amount:n,description:a||"Manual deposit",balanceAfter:0};await this.addManualTransaction(r,s)}async addManualWithdrawal(r,n,o,a){if(n<=0)throw new Error("Withdrawal amount must be positive");let s={id:this.generateTransactionId(),date:new Date(o),type:"withdrawal",amount:-n,description:a||"Manual withdrawal",balanceAfter:0};await this.addManualTransaction(r,s)}async updateManualTransaction(r,n,o){let a=this.getAccountMetadata(r);if(!(a!=null&&a.manualTransactions))throw new Error("No manual transactions found for this account");let i=a.manualTransactions.findIndex(c=>c.id===n);if(i===-1)throw new Error("Transaction not found");let s=a.manualTransactions[i],l={...s,...o,date:o.date?new Date(o.date):s.date,balanceAfter:0};if(o.amount!==void 0){if(s.type==="deposit"&&o.amount<=0)throw new Error("Deposit amount must be positive");if(s.type==="withdrawal"&&o.amount<=0)throw new Error("Withdrawal amount must be positive");s.type==="withdrawal"&&(l.amount=-Math.abs(o.amount))}a.manualTransactions[i]=l,await this.saveAccountMetadata(r,{...a,lastUpdated:new Date}),await this.refreshAccountData(r)}async deleteManualTransaction(r,n){let o=this.getAccountMetadata(r);if(!(o!=null&&o.manualTransactions))throw new Error("No manual transactions found for this account");let a=o.manualTransactions.findIndex(i=>i.id===n);if(a===-1)throw new Error("Transaction not found");o.manualTransactions.splice(a,1),await this.saveAccountMetadata(r,{...o,lastUpdated:new Date}),await this.refreshAccountData(r)}getManualTransactions(r){let n=this.getAccountMetadata(r);return(n==null?void 0:n.manualTransactions)||[]}async addManualTransaction(r,n){let o=this.getAccountMetadata(r)||{name:r,accountType:"demo",createdDate:new Date,initialBalance:1e4,drawdownType:"none",drawdownAmount:0,hasProfitTarget:!1,profitTarget:0,profitTargetType:"absolute",monthlyCost:0,lastUpdated:new Date};o.manualTransactions||(o.manualTransactions=[]),o.manualTransactions.push(n),o.lastUpdated=new Date,await this.saveAccountMetadata(r,o),await this.refreshAccountData(r)}generateTransactionId(){return`manual-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}destroy(){this.tradeDataChangeHandler&&(document.removeEventListener("journalit:trade-data-changed",this.tradeDataChangeHandler),document.removeEventListener("journalit:missed-trade-data-changed",this.tradeDataChangeHandler))}}});var qce=L(()=>{Hce()});var Gce={};Ko(Gce,{ServiceManager:()=>yh});var yh,CL=L(()=>{mce();vce();yce();$R();NA();wce();Cce();Ice();Ace();Au();Lce();Bce();Rce();Uce();Vce();qce();wL();yh=class e{constructor(t,r){this._authManager=null;this._tradeService=null;this._folderPathService=null;this._setupService=null;this._drcService=null;this._weeklyReviewService=null;this._monthlyReviewService=null;this._optionsService=null;this._customFieldsService=null;this._missedTradeService=null;this._backtestTradeService=null;this._backendIntegrationService=null;this._onboardingService=null;this._accountPageService=null;this.initializedServices=new Set;this.serviceInitQueue=new Map;this.app=t,this.plugin=r}static getInstance(t,r){return e.instance||(e.instance=new e(t,r)),e.instance}async getServiceByName(t){switch(t){case"authManager":return await this.getAuthManager();case"tradeService":return await this.getTradeService();case"setupService":return await this.getSetupService();case"drcService":return await this.getDRCService();case"weeklyReviewService":return await this.getWeeklyReviewService();case"monthlyReviewService":return await this.getMonthlyReviewService();case"optionsService":return await this.getOptionsService();case"customFieldsService":return await this.getCustomFieldsService();case"missedTradeService":return await this.getMissedTradeService();case"backtestTradeService":return await this.getBacktestTradeService();case"accountPageService":return await this.getAccountPageService();case"backendIntegrationService":return await this.getBackendIntegrationService();case"onboardingService":return await this.getOnboardingService();case"folderPathService":return await this.getFolderPathService();default:let r=t;throw new Error(`Unknown service: ${r}`)}}async initializeCoreServices(){this._authManager=new Rb(this.app,BR()),this.initializedServices.add("authManager");let t=".journalit/cache/trade-cache.json",r=".journalit/indexes";try{await this.app.vault.adapter.remove(t)}catch(o){o&&typeof o=="object"&&"code"in o&&o.code==="ENOENT"||console.warn("Failed to delete trade cache:",o)}try{let o=await this.app.vault.adapter.list(r);if(o&&o.files)for(let a of o.files)try{await this.app.vault.adapter.remove(a)}catch(i){i&&typeof i=="object"&&"code"in i&&i.code!=="ENOENT"&&console.warn(`Failed to delete index file ${a}:`,i)}}catch(o){o&&typeof o=="object"&&"code"in o&&o.code==="ENOENT"||console.warn("Failed to delete index files:",o)}let n=this.getFolderPathService();this._tradeService=new CS(this.app,n,{namespace:"trade"}),this._tradeService.setPlugin(this.plugin),this.initializedServices.add("tradeService"),this._customFieldsService=new gL(this.plugin),this.initializedServices.add("customFieldsService"),this._optionsService=new va(this.plugin,{namespace:"options"}),this.initializedServices.add("optionsService")}async initializeRemainingServices(){await fS([async()=>await this.getSetupService(),async()=>await this.getDRCService(),async()=>await this.getWeeklyReviewService(),async()=>await this.getMonthlyReviewService(),async()=>await this.getAccountPageService()],50)}getAuthManager(){return this._authManager||(this._authManager=new Rb(this.app,BR()),this.initializedServices.add("authManager")),this._authManager}getTradeService(){if(!this._tradeService){let t=this.getFolderPathService();this._tradeService=new CS(this.app,t,{namespace:"trade"}),this._tradeService.setPlugin(this.plugin),this.initializedServices.add("tradeService")}return this._tradeService}getFolderPathService(){return this._folderPathService||(this._folderPathService=new af(this.app,this.plugin),this.initializedServices.add("folderPathService")),this._folderPathService}async getSetupService(){if(this._setupService)return this._setupService;let t=this.serviceInitQueue.get("setupService");if(t)return t;let r=(async()=>{let n=this.getTradeService(),o=await Ci(()=>new sL(this.app,n,{namespace:"setup"}),"SetupService");return o.setPlugin(this.plugin),this._setupService=o,this.initializedServices.add("setupService"),this.serviceInitQueue.delete("setupService"),o})();return this.serviceInitQueue.set("setupService",r),r}async getDRCService(){if(this._drcService)return this._drcService;let t=this.serviceInitQueue.get("drcService");if(t)return t;let r=(async()=>{let n=this.getFolderPathService(),o=await Ci(()=>new dL(this.app,this.plugin,n,{namespace:"drc"}),"DRCService");return this._drcService=o,this.initializedServices.add("drcService"),this.serviceInitQueue.delete("drcService"),o})();return this.serviceInitQueue.set("drcService",r),r}async getWeeklyReviewService(){if(this._weeklyReviewService)return this._weeklyReviewService;let t=this.serviceInitQueue.get("weeklyReviewService");if(t)return t;let r=(async()=>{let n=this.getFolderPathService(),o=await Ci(()=>new pL(this.app,this.plugin,n),"WeeklyReviewService");return this._weeklyReviewService=o,this.initializedServices.add("weeklyReviewService"),this.serviceInitQueue.delete("weeklyReviewService"),o})();return this.serviceInitQueue.set("weeklyReviewService",r),r}async getMissedTradeService(){if(this._missedTradeService)return this._missedTradeService;let t=this.serviceInitQueue.get("missedTradeService");if(t)return t;let r=(async()=>{let n=await Ci(()=>new SL(this.app,this.plugin,{namespace:"missed-trade"}),"MissedTradeService");return n.setPlugin(this.plugin),this._missedTradeService=n,this.initializedServices.add("missedTradeService"),this.serviceInitQueue.delete("missedTradeService"),n})();return this.serviceInitQueue.set("missedTradeService",r),r}async getBacktestTradeService(){if(this._backtestTradeService)return this._backtestTradeService;let t=this.serviceInitQueue.get("backtestTradeService");if(t)return t;let r=(async()=>{let n=await Ci(()=>new TL(this.app,this.plugin,{namespace:"backtest-trade"}),"BacktestTradeService");return n.setPlugin(this.plugin),this._backtestTradeService=n,this.initializedServices.add("backtestTradeService"),this.serviceInitQueue.delete("backtestTradeService"),n})();return this.serviceInitQueue.set("backtestTradeService",r),r}async getMonthlyReviewService(){if(this._monthlyReviewService)return this._monthlyReviewService;let t=this.serviceInitQueue.get("monthlyReviewService");if(t)return t;let r=(async()=>{let n=this.getFolderPathService(),o=await Ci(()=>new fL(this.app,this.plugin,n,{namespace:"monthly"}),"MonthlyReviewService");return o.setPlugin(this.plugin),this._monthlyReviewService=o,this.initializedServices.add("monthlyReviewService"),this.serviceInitQueue.delete("monthlyReviewService"),o})();return this.serviceInitQueue.set("monthlyReviewService",r),r}async getOptionsService(){return this.getOptionsServiceSync()}getCustomFieldsService(){if(!this._customFieldsService)throw new Error("CustomFieldsService not initialized. Make sure initializeCoreServices() was called.");return this._customFieldsService}getOptionsServiceSync(){if(!this._optionsService)throw new Error("CustomOptionsService not initialized. Make sure initializeCoreServices() was called.");return this._optionsService}isServiceInitialized(t){return this.initializedServices.has(t)}isServiceInitializing(t){return this.serviceInitQueue.has(t)}async getAccountPageService(){if(this._accountPageService)return this._accountPageService;let t=this.serviceInitQueue.get("accountPageService");if(t)return t;let r=(async()=>{let n=await Ci(()=>{let o=new NS(this.app);return o.setPlugin(this.plugin),o},"AccountPageService");return this._accountPageService=n,this.initializedServices.add("accountPageService"),this.serviceInitQueue.delete("accountPageService"),n})();return this.serviceInitQueue.set("accountPageService",r),r}async getBackendIntegrationService(){if(this._backendIntegrationService)return this._backendIntegrationService;let t=this.serviceInitQueue.get("backendIntegrationService");if(t)return t;let r=(async()=>{let n=await Ci(()=>new IS(this.plugin),"BackendIntegrationService");return this._backendIntegrationService=n,this.initializedServices.add("backendIntegrationService"),this.serviceInitQueue.delete("backendIntegrationService"),n})();return this.serviceInitQueue.set("backendIntegrationService",r),r}async getOnboardingService(){if(this._onboardingService)return this._onboardingService;let t=this.serviceInitQueue.get("onboardingService");if(t)return t;let r=(async()=>{let n=await Ci(()=>new LS(this.app,this.plugin),"OnboardingService");return await n.initialize(),this._onboardingService=n,this.initializedServices.add("onboardingService"),this.serviceInitQueue.delete("onboardingService"),n})();return this.serviceInitQueue.set("onboardingService",r),r}preInitializeServices(t){t.length!==0&&LA(()=>{let r=t.map(n=>async()=>{switch(n){case"setupService":await this.getSetupService();break;case"drcService":await this.getDRCService();break;case"weeklyReviewService":await this.getWeeklyReviewService();break;case"monthlyReviewService":await this.getMonthlyReviewService();break;case"accountPageService":await this.getAccountPageService();break;case"onboardingService":await this.getOnboardingService();break;case"backtestTradeService":await this.getBacktestTradeService();break}});fS(r,100)})}cleanupServices(){this._tradeService&&(this._tradeService.cleanup(),this._tradeService=null),this._setupService&&(this._setupService.cleanup(),this._setupService=null),this._monthlyReviewService&&(this._monthlyReviewService.cleanup(),this._monthlyReviewService=null),this._missedTradeService&&(this._missedTradeService.cleanup(),this._missedTradeService=null),this._backtestTradeService&&(this._backtestTradeService.cleanup(),this._backtestTradeService=null),this._accountPageService&&(this._accountPageService.cleanup(),this._accountPageService.destroy(),this._accountPageService=null);try{let t=(rf(),uu(pce)).CustomDataService;t.sharedIndexManager&&(t.sharedIndexManager.unload(),t.sharedIndexManager=null)}catch(t){console.error("Error cleaning up CustomDataService:",t)}this._authManager=null,this._drcService=null,this._weeklyReviewService=null,this._optionsService=null,this._customFieldsService=null,this._backendIntegrationService&&(this._backendIntegrationService.cleanup(),this._backendIntegrationService=null),this._onboardingService&&(this._onboardingService.onunload(),this._onboardingService=null),this.initializedServices.clear(),this.serviceInitQueue.clear()}}});var Wn,$ze,PL,GR=L(()=>{Wn=q(Y()),$ze={duration:{open:150,close:150},easing:"ease-in-out",stagger:{opacity:50}},PL=(e=!1,t=$ze,r={})=>{let[n,o]=(0,Wn.useState)(e),[a,i]=(0,Wn.useState)(!1),[s,l]=(0,Wn.useState)(0),c=(0,Wn.useRef)(null),d=(0,Wn.useRef)(null),u=(0,Wn.useRef)(null);(0,Wn.useEffect)(()=>{o(e)},[e]),(0,Wn.useEffect)(()=>()=>{u.current&&clearTimeout(u.current)},[]),(0,Wn.useEffect)(()=>{let x=d.current;if(!x)return;let w=S=>{S.target===x&&S.propertyName==="height"&&a&&(i(!1),u.current&&(clearTimeout(u.current),u.current=null))};return x.addEventListener("transitionend",w),()=>{x.removeEventListener("transitionend",w)}},[a]),(0,Wn.useEffect)(()=>{n&&c.current&&!a&&requestAnimationFrame(()=>{if(c.current){let x=c.current.scrollHeight;l(x)}})},[n,a]),(0,Wn.useEffect)(()=>{if(!c.current||!n||a||typeof ResizeObserver=="undefined")return;let x,w=new ResizeObserver(S=>{a||(clearTimeout(x),x=setTimeout(()=>{if(!a){for(let k of S)if(k.target===c.current&&n&&!a){let T=c.current.scrollHeight;l(P=>P!==T?T:P)}}},50))});return w.observe(c.current),()=>{clearTimeout(x),w.disconnect()}},[n,a]);let p=(0,Wn.useCallback)(()=>{o(x=>(x?(i(!0),u.current&&clearTimeout(u.current),u.current=setTimeout(()=>{i(!1),u.current=null},t.duration.close+10)):(i(!1),u.current&&(clearTimeout(u.current),u.current=null)),!x))},[t.duration.close]),m=(0,Wn.useCallback)(x=>{(x.key==="Enter"||x.key===" ")&&(x.preventDefault(),p())},[p]),f=(0,Wn.useMemo)(()=>({height:n?`${s}px`:"0px",opacity:n?1:0,visibility:n?"visible":"hidden",overflow:"hidden",transition:n?`height ${t.duration.open}ms ${t.easing}, opacity ${t.duration.open-t.stagger.opacity}ms ${t.easing} ${t.stagger.opacity}ms, visibility 0s ease 0s`:`height ${t.duration.close}ms ${t.easing}, opacity ${Math.min(t.duration.close,150)}ms ${t.easing}, visibility 0s ease 0s`,...r.includeBorder&&{borderTop:n?"1px solid var(--background-modifier-border)":"none"},...r.includeBackground&&{backgroundColor:n?"var(--background-secondary)":"transparent"}}),[n,s,t,r.includeBorder,r.includeBackground]),g=(0,Wn.useMemo)(()=>{let w={...{top:16,bottom:16,left:0,right:0},...r.customPadding};return{paddingTop:n?`${w.top}px`:"0px",paddingBottom:n?`${w.bottom}px`:"0px",paddingLeft:`${w.left}px`,paddingRight:`${w.right}px`,transition:`padding ${t.duration.close}ms ${t.easing}`}},[n,t.duration.close,t.easing,r.customPadding]),v=(0,Wn.useMemo)(()=>({display:"flex",alignItems:"center",justifyContent:"center",width:"16px",height:"16px",transition:`transform ${t.duration.close}ms ${t.easing}`,transform:n?"rotate(0deg)":"rotate(-90deg)",color:"var(--text-muted)"}),[n,t.duration.close,t.easing]),h=(0,Wn.useMemo)(()=>({width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",style:v}),[v]),y=(0,Wn.useMemo)(()=>({display:"flex",alignItems:"center",width:"100%",padding:"12px 16px",cursor:"pointer",backgroundColor:"transparent",border:"none",textAlign:"left",fontSize:"14px",fontWeight:"500",color:"var(--text-normal)",userSelect:"none",transition:"background-color 0.15s ease"}),[]),b=(0,Wn.useCallback)(()=>{c.current&&n&&!a&&requestAnimationFrame(()=>{if(c.current&&!a){let x=c.current.scrollHeight;l(x)}})},[n,a]);return{isExpanded:n,isCollapsing:a,contentHeight:s,toggleExpanded:p,handleKeyDown:m,remeasureContent:b,contentRef:c,containerRef:d,accordionContainerStyle:f,accordionContentStyle:g,chevronStyle:v,headerButtonStyle:y,chevronSvgProps:h}}});var Cn,fr,up=L(()=>{Cn=q(Y());GR();fr=Cn.default.memo(({title:e,defaultExpanded:t=!1,expanded:r,onExpandedChange:n,onRemeasureContentChange:o,children:a})=>{let[i,s]=(0,Cn.useState)(!1),l=r!==void 0,c=l?r:t,{isExpanded:d,toggleExpanded:u,handleKeyDown:p,remeasureContent:m,contentRef:f,containerRef:g,accordionContainerStyle:v,accordionContentStyle:h,chevronStyle:y}=PL(c,{duration:{open:150,close:150},easing:"ease-out",stagger:{opacity:25}});(0,Cn.useEffect)(()=>{m()},[a,m]),(0,Cn.useEffect)(()=>{o&&o(m)},[o,m]);let b=(0,Cn.useCallback)(()=>{l&&n?n(!d):u()},[d,l,n,u]),x=(0,Cn.useCallback)(O=>{(O.key==="Enter"||O.key===" ")&&(O.preventDefault(),b())},[b]),w=(0,Cn.useCallback)(()=>{s(!0)},[]),S=(0,Cn.useCallback)(()=>{s(!1)},[]),k=(0,Cn.useMemo)(()=>({border:"1px solid var(--background-modifier-border)",borderRadius:"6px",overflow:"hidden",marginBottom:"16px",transition:"box-shadow 150ms ease-out",boxShadow:i?"0 1px 3px rgba(0, 0, 0, 0.05)":"none"}),[i]),T=(0,Cn.useMemo)(()=>({display:"flex",alignItems:"center",cursor:"pointer",padding:"12px 16px",fontSize:"14px",fontWeight:"500",color:"var(--text-normal)",userSelect:"none",backgroundColor:i?"var(--background-modifier-hover)":"var(--background-secondary)",transition:"background-color 150ms ease-out",marginBottom:"0px"}),[i]),P=(0,Cn.useMemo)(()=>({marginLeft:"8px"}),[]),D=(0,Cn.useMemo)(()=>({...h,padding:"16px",backgroundColor:"var(--background-primary)"}),[h]);return Cn.default.createElement("div",{style:k,"aria-expanded":d,onMouseEnter:w,onMouseLeave:S},Cn.default.createElement("div",{style:T,onClick:b,role:"button",tabIndex:0,onKeyDown:x},Cn.default.createElement("div",{style:y},Cn.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},Cn.default.createElement("polyline",{points:"6 9 12 15 18 9"}))),Cn.default.createElement("span",{style:P},e)),Cn.default.createElement("div",{ref:g,style:v},Cn.default.createElement("div",{ref:f,style:D},a)))});fr.displayName="Accordion"});var Kr,YR,Yce=L(()=>{Kr=q(Y());up();YR=Kr.default.memo(({settings:e,data:t,onUpdate:r,filePath:n})=>{(0,Kr.useEffect)(()=>{},[e,n]);let[o,a]=(0,Kr.useState)(()=>{let p={};return e.sections.forEach(m=>{p[m.id]={checkboxes:{},textAreas:{}}}),t?{...t,sections:{...p,...t.sections}}:{sections:p,reviewed:!1}});(0,Kr.useEffect)(()=>{a(p=>{let m={...p.sections};return e.sections.forEach(f=>{m[f.id]||(m[f.id]={checkboxes:{},textAreas:{}})}),t?{...t,sections:{...m,...t.sections}}:{...p,sections:m}})},[t,e.sections]);let i=(0,Kr.useCallback)(p=>{a(p),r(p)},[r]),s=(p,m)=>{var g,v,h;let f={...o,sections:{...o.sections,[p]:{...o.sections[p],checkboxes:{...(g=o.sections[p])==null?void 0:g.checkboxes,[m]:!((h=(v=o.sections[p])==null?void 0:v.checkboxes)!=null&&h[m])}}}};i(f)},l=(p,m)=>{var g;let f={...o,sections:{...o.sections,[p]:{...o.sections[p],textAreas:{...(g=o.sections[p])==null?void 0:g.textAreas,[p]:m}}}};i(f)},c=p=>{var f,g;let m=o.sections[p.id];switch(p.type){case"header":return Kr.default.createElement("div",{className:"loss-review-header",key:p.id},p.title&&Kr.default.createElement("h3",{dangerouslySetInnerHTML:{__html:d(p.title)}}),p.content&&Kr.default.createElement("div",{className:"loss-review-content",dangerouslySetInnerHTML:{__html:d(p.content)}}));case"checkbox":let v=p.content||p.id,h=((f=m==null?void 0:m.checkboxes)==null?void 0:f[v])||!1;return Kr.default.createElement("div",{className:"loss-review-checkbox",key:p.id},Kr.default.createElement("label",{className:"checkbox-label"},Kr.default.createElement("input",{type:"checkbox",checked:h,onChange:()=>s(p.id,v)}),Kr.default.createElement("span",{dangerouslySetInnerHTML:{__html:d(p.content||"")}})));case"checkboxList":return Kr.default.createElement("div",{className:"loss-review-checkbox-list",key:p.id},p.title&&Kr.default.createElement("h3",{dangerouslySetInnerHTML:{__html:d(p.title)}}),Kr.default.createElement("div",{className:"checkbox-items"},(p.items||[]).map((b,x)=>{var k;let w=`${p.id}-item-${x}`,S=((k=m==null?void 0:m.checkboxes)==null?void 0:k[w])||!1;return Kr.default.createElement("label",{key:w,className:"checkbox-label"},Kr.default.createElement("input",{type:"checkbox",checked:S,onChange:()=>s(p.id,w)}),Kr.default.createElement("span",{dangerouslySetInnerHTML:{__html:d(b)}}))})));case"textarea":let y=((g=m==null?void 0:m.textAreas)==null?void 0:g[p.id])||"";return Kr.default.createElement("div",{className:"loss-review-textarea",key:p.id},p.title&&Kr.default.createElement("h3",{dangerouslySetInnerHTML:{__html:d(p.title)}}),Kr.default.createElement("textarea",{value:y,onChange:b=>l(p.id,b.target.value),placeholder:p.placeholder||"",rows:4,className:"loss-review-textarea-input"}));default:return null}},d=p=>{let m=p.replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>");return m=m.replace(/__([^_]+)__/g,"<strong>$1</strong>"),m=m.replace(/(^|[^*])\*([^*]+)\*(?!\*)/g,"$1<em>$2</em>"),m=m.replace(/(^|[^_])_([^_]+)_(?!_)/g,"$1<em>$2</em>"),m=m.replace(/\n/g,"<br>"),m};if(!e.enabled)return null;let u=Kr.default.createElement("div",{className:"loss-review-sections"},e.sections.map(p=>{try{return Kr.default.createElement("div",{className:"loss-review-section",key:p.id},c(p))}catch(m){return console.error(`Error rendering loss review section ${p.id}:`,m),null}}));return Kr.default.createElement("div",{className:"loss-review-container"},Kr.default.createElement(fr,{title:"Loss Review",defaultExpanded:!0},u))});YR.displayName="LossReview"});var Ct,KR,JR,Wze,XR=L(()=>{Ct=q(Y()),KR=require("obsidian");ba();pt();IR();AR();LR();Yce();yO();ci();Kv();ga();JR=Ct.default.memo(({data:e,onEditClick:t})=>{var y,b,x,w,S,k,T,P,D;let[r,n]=(0,Ct.useState)(e.filePath||"unknown"),[o,a]=(0,Ct.useState)({reviewed:e.reviewed,reviewedAt:e.reviewedAt});(0,Ct.useEffect)(()=>{a({reviewed:e.reviewed,reviewedAt:e.reviewedAt})},[e.reviewed,e.reviewedAt]);let i=(0,Ct.useRef)(null),{metrics:s,formatDate:l,formatTime:c}=xS({data:e}),d=xe(),u=d?Bq({plugin:d,initialData:e.lossReview,onUpdate:async O=>{if(d!=null&&d.tradeService&&r&&r!=="unknown")try{await d.tradeService.updateLossReview(r,O,"user-input")}catch(z){console.error("[TradeNote] Error updating loss review:",z)}}}):{settings:{enabled:!1,sections:[]},updateLossReview:()=>{}},{settings:p,updateLossReview:m}=u;(0,Ct.useEffect)(()=>{if(um(),i.current){i.current.classList.add("trade-note-mounted"),i.current.setAttribute("data-mounted-at",Date.now().toString());let O=i.current.closest(".journalit-trade-view");O&&O.classList.add("trade-note-mounted")}},[]);let f=(0,Ct.useCallback)(O=>{if(i.current=O,O&&(!r||r==="unknown")){let z=O.getAttribute("data-displaying-file");if(z){n(z);return}let I=O.parentElement;for(;I;){let A=I.getAttribute("data-displaying-file")||I.getAttribute("data-file-path");if(A){n(A);break}I=I.parentElement}}},[r]),g=async O=>{if(!(d!=null&&d.viewManager)){console.error("Cannot navigate to account: ViewManager not available");return}try{let z=O;if(d.accountPageService)try{let A=(await d.accountPageService.getAllEnhancedAccounts()).find(j=>j.id===O||j.name===O);A&&A.name&&(z=A.name)}catch(I){console.warn("Could not resolve account via AccountPageService, using provided value:",I)}await d.viewManager.openAccountPageView(z)}catch(z){console.error("Error navigating to account page:",z)}},v=(0,Ct.useCallback)(()=>{t&&t(e)},[e,t]),h=(0,Ct.useCallback)(async()=>{if(d!=null&&d.tradeService&&r&&r!=="unknown"){let O=new Date().toISOString();a({reviewed:!0,reviewedAt:O});try{await d.tradeService.updateTradeReviewStatus(r,!0,O,"user-input")}catch(z){console.error("[TradeNote] Error updating review status:",z),a({reviewed:e.reviewed,reviewedAt:e.reviewedAt})}}},[d,r,e.reviewed,e.reviewedAt]);return Ct.default.createElement("div",{className:"trade-note-container",ref:f,"data-file-path":r,style:{margin:0}},Ct.default.createElement(bS,{instrument:e.instrument,direction:e.direction,isProfit:s.isProfit,pnl:s.pnl,percentChange:s.percentChange,useDirectPnLInput:e.useDirectPnLInput,isMissedTrade:e.isMissedTrade,isBacktestTrade:e.isBacktestTrade,exitTime:e.exitTime,tradeStatus:e.tradeStatus,exits:e.exits,assetType:e.assetType,optionType:e.optionType,rMultiple:e.rMultiple,displayRMultiples:(x=(b=(y=d==null?void 0:d.settings)==null?void 0:y.trade)==null?void 0:b.displayRMultiples)!=null?x:!1,riskAmount:e.riskAmount}),(e.entryTime||e.useDirectPnLInput)&&Ct.default.createElement(Wze,{data:e,filePath:r,onEditClick:t,handleEditClick:v}),Ct.default.createElement("div",{className:"trade-note-content"},Ct.default.createElement(hS,{images:e.images,onEditClick:v}),Ct.default.createElement(vS,{data:e,onAccountClick:g}),Ct.default.createElement(yS,{data:e,metrics:s,formatDate:l,formatTime:c,onEditClick:v,displayRMultiples:(k=(S=(w=d==null?void 0:d.settings)==null?void 0:w.trade)==null?void 0:S.displayRMultiples)!=null?k:!1,defaultRiskAmount:(D=(P=(T=d==null?void 0:d.settings)==null?void 0:T.trade)==null?void 0:P.defaultRiskAmount)!=null?D:0}),!Pt({tradeStatus:e.tradeStatus,exitTime:e.exitTime,pnl:e.pnl,useDirectPnLInput:e.useDirectPnLInput,exits:e.exits,entries:e.entries})&&s.pnl<0&&Ct.default.createElement(YR,{settings:p,data:e.lossReview,onUpdate:m,filePath:r}),Ct.default.createElement("div",{className:"trade-note-review-section"},Ct.default.createElement(Dd,{reviewed:o.reviewed,reviewedAt:o.reviewedAt,onMarkReviewed:h}))))},(e,t)=>e.data.pnl===t.data.pnl&&e.data.entryTime===t.data.entryTime&&e.data.exitTime===t.data.exitTime&&e.data.instrument===t.data.instrument&&e.data.direction===t.data.direction&&e.data.commission===t.data.commission&&e.data.swap===t.data.swap&&e.data.fees===t.data.fees&&JSON.stringify(e.data.images)===JSON.stringify(t.data.images)&&JSON.stringify(e.data.lossReview)===JSON.stringify(t.data.lossReview)&&e.onEditClick===t.onEditClick),Wze=Ct.default.memo(({data:e,filePath:t,onEditClick:r,handleEditClick:n})=>{let o=xe(),[a,i]=(0,Ct.useState)([]),[s,l]=(0,Ct.useState)([]),[c,d]=(0,Ct.useState)(!1),[u,p]=(0,Ct.useState)(!1),[m,f]=(0,Ct.useState)(0),g=Ct.default.useMemo(()=>{if(e.entryTime)return new Date(e.entryTime);if(e.useDirectPnLInput){let T=t.match(/(\d{2})(\d{2})(\d{2})-T\d+\.md$/);if(T){let[,P,D,O]=T,z=2e3+parseInt(O,10);return new Date(z,parseInt(D,10)-1,parseInt(P,10))}return new Date}return null},[e.entryTime,e.useDirectPnLInput,t]),v=Ct.default.useMemo(()=>{if(!g||!o)return null;let{start:T,end:P}=VC(g,o);return{startDate:T,endDate:P}},[g,o]),h=Ct.default.useMemo(()=>!g||!o?"":Cc(g,o),[g,o]),y=Ct.default.useRef(null);(0,Ct.useEffect)(()=>{let T=y.current;if(!T)return;let P=new IntersectionObserver(D=>{let[O]=D;O.isIntersecting&&(p(!0),P.disconnect())},{rootMargin:"50px",threshold:.1});return P.observe(T),()=>P.disconnect()},[]),(0,Ct.useEffect)(()=>{let T=P=>{let{action:D,timestamp:O}=P.detail;(D==="created"||D==="updated")&&h&&setTimeout(()=>{Object.keys(sessionStorage).forEach(z=>{z.startsWith("trade-nav-")&&sessionStorage.removeItem(z)}),i([]),l([]),d(!1),f(z=>z+1)},200)};return document.addEventListener("journalit:trade-data-changed",T),document.addEventListener("journalit:missed-trade-data-changed",T),document.addEventListener("journalit:backtest-trade-data-changed",T),()=>{document.removeEventListener("journalit:trade-data-changed",T),document.removeEventListener("journalit:missed-trade-data-changed",T),document.removeEventListener("journalit:backtest-trade-data-changed",T)}},[h]),(0,Ct.useEffect)(()=>{if(!u||!v||!(o!=null&&o.tradeService)||!h)return;let T=!0;return(async()=>{try{let D=sessionStorage.getItem(`trade-nav-${h}`);if(D){let O=JSON.parse(D);if(T){let z=[],I=[];Array.isArray(O)?z=O:O&&typeof O=="object"&&(z=O.trades||[],I=O.missedTrades||[]);let A=z.map(C=>{let F=o.app.vault.getAbstractFileByPath(C);return F instanceof KR.TFile?F:null}).filter(C=>C!==null),j=I.map(C=>{let F=o.app.vault.getAbstractFileByPath(C);return F instanceof KR.TFile?F:null}).filter(C=>C!==null),E=[...z,...I],N=E.includes(t);if(o.app.vault.getAbstractFileByPath(t)&&!N||A.length===0&&j.length===0&&E.length>0)sessionStorage.removeItem(`trade-nav-${h}`);else{i(A),l(j);return}}}if(c)return;d(!0),setTimeout(async()=>{var O;try{let z=await o.tradeService.getTrades(v.startDate,v.endDate),I=[];try{(O=o.missedTradeService)!=null&&O.getMissedTrades&&(I=await o.missedTradeService.getMissedTrades(v.startDate,v.endDate))}catch(A){console.warn("[TradeNote] Failed to fetch missed trades:",A)}if(T){i(z),l(I);try{let A=z.map(E=>E.path),j=I.map(E=>E.path);sessionStorage.setItem(`trade-nav-${h}`,JSON.stringify({trades:A,missedTrades:j}))}catch(A){console.warn("Error caching trades:",A)}}}catch(z){console.error("Error fetching trades for day:",z)}finally{T&&d(!1)}},100)}catch(D){console.error("Error in trade fetch setup:",D),T&&d(!1)}})(),()=>{T=!1}},[u,v,o==null?void 0:o.tradeService,h,o,m]);let b=(0,Ct.useCallback)((T,P=!1)=>{try{o&&o.openFile?o.openFile(T,P):o!=null&&o.app?o.app.workspace.openLinkText(T,"",P):console.error("Cannot navigate: Plugin and App context not available.")}catch(D){console.error("Navigation error:",D)}},[o]),x=(0,Ct.useCallback)(T=>o!=null&&o.drcService?o.drcService.getDRCNotePath(T):"",[o==null?void 0:o.drcService]),w=(0,Ct.useCallback)(T=>o!=null&&o.weeklyReviewService?o.weeklyReviewService.getWeeklyReviewPath(T):"",[o==null?void 0:o.weeklyReviewService]),S=(0,Ct.useCallback)(T=>o!=null&&o.drcService?o.drcService.getMonthlyReviewPath(T):null,[o==null?void 0:o.drcService]),k=(0,Ct.useCallback)(()=>null,[]);return!g||!(o!=null&&o.drcService)||!(o!=null&&o.weeklyReviewService)?null:Ct.default.createElement("div",{ref:y},u?Ct.default.createElement(Ct.default.Fragment,null,Ct.default.createElement(VA,{currentDate:g,trades:a,missedTrades:s,currentTradePath:t,navigateTo:b,getDRCPath:x,getWeeklyReviewPath:w,getMonthlyReviewPath:S,getYearlyReviewPath:k,onEditClick:r,handleEditClick:n})):Ct.default.createElement("div",{style:{height:"60px",display:"flex",alignItems:"center",justifyContent:"center"}},Ct.default.createElement("div",{style:{color:"var(--text-muted)",fontSize:"12px"}},"Loading navigation...")))})});var Kce,OS,QR=L(()=>{Kce=q(Y());XR();Nb();ba();zb();OS=class extends rc{constructor(t){super(t)}renderComponent(t,r,n,o,a){t.querySelector(".trade-note-container.trade-note-mounted")||this.renderTradeNote(t,r,n,o,a)}renderTradeNote(t,r,n,o,a){try{if(um(),!t||!t.isConnected){console.error(`[TradeNote] Cannot render into disconnected container for ${n}`);return}let i=a?`${n}-${o}-${a}`:`${n}-${o}`,s=o.startsWith("leaf-")?o.substring(5):o,l=this.processTradeData(r);t.setAttribute("data-displaying-file",n);let c=this.findContainingLeaf(t),d=t.querySelector(".journalit-trade-note-wrapper");if(d){if(d.querySelector(".trade-note-mounted"))return;d.remove()}let u=null;if(c&&c.view){let g=c.view.containerEl;g&&g.id&&(u=g.id)}let p=this.reactRoots.get(i);if(p&&p.domContainer&&p.domContainer.isConnected&&p.domContainer.querySelector(".trade-note-mounted"))return;t.empty();let m=this.reactRoots.get(i);if(m&&(c&&u&&m.leafId!==u||a&&m.domContainer&&m.domContainer.getAttribute("data-context-id")!==a)){let g=a?`${n}-context-${a}`:`${n}-${o}-${u}`;if(m=this.reactRoots.get(g),!m){this.createReactRoot(t,g,u||void 0,a,l,n);return}}if(!m)this.createReactRoot(t,i,u||void 0,a,l,n);else{let g=m.domContainer;t.contains(g)?m.root.render(this.createReactElement(l,n)):this.createReactRoot(t,i,u||void 0,a,l,n)}}catch(i){console.error("[TradeNote] Error rendering trade note:",i),t.setText("Error rendering trade note: "+(i instanceof Error?i.message:String(i)))}}getComponentClassName(){return"journalit-trade-view"}getWrapperClassName(){return"journalit-trade-note-wrapper"}createReactElement(t,r,n){let o=i=>{var l,c;let s=(c=(l=window.app)==null?void 0:l.plugins)==null?void 0:c.plugins.journalit;if(!s){console.error("Cannot access plugin instance for edit action");return}if(s.openTradeFormInEditMode){try{let d=document.activeElement;d&&typeof d.blur=="function"&&d.blur();let u=document.querySelector(".cm-editor");u&&typeof u.blur=="function"&&u.blur()}catch(d){}try{requestAnimationFrame(()=>{setTimeout(()=>{try{s.openTradeFormInEditMode(i,r)}catch(d){console.error("Failed to open trade form in edit mode:",d)}},0)})}catch(d){try{s.openTradeFormInEditMode(i,r)}catch(u){console.error(u)}}}else console.warn("Edit mode not available - plugin method missing")},a=async i=>{var l,c;let s=(c=(l=window.app)==null?void 0:l.plugins)==null?void 0:c.plugins.journalit;if(!s||!s.tradeService){console.error("Cannot access plugin instance for data update");return}try{await s.tradeService.updateTrade(i,r,"user-input")}catch(d){console.error("[TradeNote] Error updating trade data:",d)}};return Kce.default.createElement(JR,{data:{...t,filePath:r},onEditClick:o,onDataUpdate:a})}unmountTradeNote(t,r,n,o){return this.unmountComponent(t,r,n)}unmountAllTradeNotes(){this.unmountAllComponents()}unmountLeafTradeNotes(t){this.unmountLeafComponents(t)}processTradeData(t){var n,o;let r={...t};t.images,t.images&&(r.images=this.normalizeImagePaths(t.images)),["setupIds","mistakeIds","accountIds","setup","mistake","account","tags","customTags"].forEach(a=>{if(r[a]&&!Array.isArray(r[a]))if(typeof r[a]=="string"&&r[a].startsWith("[")&&r[a].endsWith("]"))try{let i=r[a].slice(1,-1).trim();i?r[a]=i.split(",").map(s=>s.trim()):r[a]=[]}catch(i){console.error(`[TradeNote] Failed to parse array string: ${a}`,i),r[a]=[r[a]]}else r[a]=[r[a]]}),r.tags&&Array.isArray(r.tags)&&(r.customTags=r.tags),t.entries&&Array.isArray(t.entries)&&(r.entries=t.entries.map(a=>({time:a.time?new Date(a.time):null,price:parseFloat(a.price)||0,size:parseFloat(a.size)||0}))),t.exits&&Array.isArray(t.exits)&&(r.exits=t.exits.map(a=>({time:a.time?new Date(a.time):null,price:parseFloat(a.price)||0,size:parseFloat(a.size)||0}))),["entryTime","exitTime"].forEach(a=>{if(r[a]&&typeof r[a]=="string")try{r[a]=new Date(r[a])}catch(i){console.error(`[TradeNote] Failed to parse date: ${a}`,i)}}),["entryPrice","exitPrice","positionSize","pnl","directPnL","riskAmount","stopLoss"].forEach(a=>{if(r[a]!==void 0&&typeof r[a]!="number")try{r[a]=parseFloat(r[a])}catch(i){console.error(`[TradeNote] Failed to parse number: ${a}`,i)}}),r.pnl!==void 0&&r.pnl!==null&&(r.originalPnl=r.pnl),["useDirectPnLInput"].forEach(a=>{if(r[a]!==void 0&&typeof r[a]!="boolean")try{r[a]=!!r[a]}catch(i){console.error(`[TradeNote] Failed to parse boolean: ${a}`,i)}}),r.thesis=wS(t.thesis)||"";try{let a=(o=(n=window.app)==null?void 0:n.plugins)==null?void 0:o.plugins.journalit;if(a&&a.customFieldsService){let i=a.customFieldsService.getFields(),s={};i.forEach(l=>{let c=l.fieldKey;c&&t[c]!==void 0&&(s[l.id]=t[c])}),Object.keys(s).length>0&&(r.customFields=s)}}catch(a){console.error("[TradeNote] Error reconstructing custom fields:",a)}return r}normalizeImagePaths(t){if(!t)return[];if(Array.isArray(t))return t.map(r=>typeof r!="string"?String(r):r.replace(/['"`]/g,"").trim()).filter(Boolean);if(typeof t=="string"&&t.startsWith("[")&&t.endsWith("]"))try{let r=t.slice(1,-1).trim();return r?r.split(",").map(n=>n.trim().replace(/['"`]/g,"")).filter(Boolean):[]}catch(r){return console.error("[TradeNote] Failed to parse images string:",r),[t.replace(/['"`]/g,"").trim()]}return typeof t=="string"?[t.replace(/['"`]/g,"").trim()]:[]}}});var DL,jS,Jce=L(()=>{DL=require("obsidian");QR();Bb();jS=class extends nc{constructor(r,n){super(r,n,new OS(r));this._tradeUpdateListener=null;this.observerTimeouts=new Map;this.setupTradeUpdateListener()}isValidComponentType(r){return r&&(r.type==="trade"||r.type==="backtest-trade")}getComponentClassName(){return"journalit-trade-view"}getWrapperClassName(){return"journalit-trade-note-wrapper"}getComponentTypeIdentifier(){return"trade"}async getAdditionalDataForComponent(r,n){return{}}disconnectObserverSafely(r){let n=this.observerTimeouts.get(r);n&&(clearTimeout(n),this.observerTimeouts.delete(r)),r.disconnect();let o=this.activeObservers.indexOf(r);o>-1&&this.activeObservers.splice(o,1)}handleFileOpen(r,n=!1){if(!r)return;this.cleanupOrphanedComponents(),this.cleanupUnrelatedComponents(r.path);let o=this.app.metadataCache.getFileCache(r),a=o==null?void 0:o.frontmatter;if(!a||!this.isValidComponentType(a))return;let i=document.body,s=new MutationObserver((c,d)=>{let u=document.querySelectorAll(".cm-editor");if(u.length===0)return;u.forEach(m=>{var D;let f=m.querySelector(".metadata-container");if(!f)return;let g=f.closest(".workspace-leaf-content");if(!g)return;let v=this.findContainingLeaf(g),h=(D=v==null?void 0:v.view)==null?void 0:D.containerEl,y=f.closest(".workspace-leaf"),x=(y==null?void 0:y.id)||(h==null?void 0:h.id)||null,w=this.getUniqueElementId(m),S=x?`leaf-${x}`:w,k=!0;if(v){let O=v.view,z=null;(O&&"file"in O||O&&"getViewType"in O&&O.getViewType()==="markdown")&&(z=O.file),z&&(k=z.path===r.path)}if(!k)return;let T=this.getComponentClassName();m.querySelectorAll(`.${T}`).forEach(O=>{let z=O.getAttribute("data-file-path");if(z&&z!==r.path){let I=O.getAttribute("data-view-id"),A=O.getAttribute("data-leaf-id");I&&this.renderer.unmountComponent(z,I,A||void 0),O.remove()}});let P=Array.from(m.querySelectorAll(`.${T}`)).find(O=>O.getAttribute("data-file-path")===r.path);P||(P=document.createElement("div"),P.className=T,P.setAttribute("data-file-path",r.path),P.setAttribute("data-view-id",S),P.setAttribute("data-editor-id",w),x&&P.setAttribute("data-leaf-id",x),P.setAttribute("data-inserted-at",Date.now().toString()),f.after(P)),setTimeout(()=>{this.renderer.renderComponent(P,a,r.path,S,w)},500),this.markFileRenderedInMode(r.path,"source")}),d.disconnect();let p=this.activeObservers.indexOf(d);p>-1&&this.activeObservers.splice(p,1)});this.activeObservers.push(s),s.observe(i,{childList:!0,subtree:!0});let l=setTimeout(()=>{this.disconnectObserverSafely(s)},3e3);this.observerTimeouts.set(s,l)}renderAllActiveTradeNotes(){let r=new Set;this.app.workspace.iterateAllLeaves(n=>{try{if(!n.view||!("file"in n.view))return;let o=n.view.file;if(!o||r.has(o.path))return;let a=this.app.metadataCache.getFileCache(o),i=a==null?void 0:a.frontmatter;if(!i||!this.isValidComponentType(i))return;r.add(o.path),setTimeout(()=>{this.handleFileOpen(o,!0)},300)}catch(o){console.error("[TradeNote] Error rendering active trade note at startup:",o)}})}renderActiveComponent(){this.renderActiveTradeNote()}setupTradeUpdateListener(){let r=async n=>{try{if(!n.detail||!n.detail.filePath)return;let o=n.detail.filePath,a=this.app.vault.getAbstractFileByPath(o);if(!(a instanceof DL.TFile)){console.warn(`[TradeNote] Cannot find file for path: ${o}`);return}await this.refreshTradeNote(a)}catch(o){console.error("[TradeNote] Error handling trade update event:",o)}};document.addEventListener("journalit:trade-data-changed",r),document.addEventListener("journalit:backtest-trade-data-changed",r),this._tradeUpdateListener=r}async refreshTradeNote(r){try{let{forceMetadataCacheRefresh:n}=await Promise.resolve().then(()=>(ls(),nO));await n(this.app,r,200);let o=this.app.metadataCache.getFileCache(r),a=(o==null?void 0:o.frontmatter)||{};if(!this.isValidComponentType(a)){console.warn(`[TradeNote] File is not a valid trade note: ${r.path}`);return}this.cleanupDuplicateComponents(r.path);let i=this.getComponentClassName(),s=document.querySelectorAll(`.${i}[data-file-path="${r.path}"]`);if(s.length===0)return;for(let l of Array.from(s)){let c=l,d=c.getAttribute("data-view-id"),u=c.getAttribute("data-markdown-view-id")||c.getAttribute("data-editor-id");d&&(c.querySelectorAll(`.${this.getWrapperClassName()}`).forEach(m=>m.remove()),await new Promise(m=>{setTimeout(()=>{try{this.renderWithDeduplication({file:r,container:c,data:a,viewId:d,contextId:u||void 0,componentClassName:this.getComponentClassName(),mountedClassName:"trade-note-mounted",contentSelector:".trade-note-container"}),m()}catch(f){console.error("[TradeNote] Error during re-render:",f),m()}},50)}))}this.markFileRenderedInMode(r.path,"source"),this.markFileRenderedInMode(r.path,"preview")}catch(n){console.error(`[TradeNote] Error refreshing trade note for ${r.path}:`,n)}}cleanup(){for(let[r,n]of this.observerTimeouts)clearTimeout(n);this.observerTimeouts.clear(),super.cleanup(),this._tradeUpdateListener&&(document.removeEventListener("journalit:trade-data-changed",this._tradeUpdateListener),document.removeEventListener("journalit:backtest-trade-data-changed",this._tradeUpdateListener),this._tradeUpdateListener=null)}renderActiveTradeNote(){var m;this.cleanupOrphanedComponents();let r=this.app.workspace.getActiveFile();if(!r)return;let n=this.app.metadataCache.getFileCache(r),o=n==null?void 0:n.frontmatter;if(!o||!this.isValidComponentType(o))return;let a=this.app.workspace.getActiveViewOfType(DL.MarkdownView);if(!a){console.error("[TradeNote] No active markdown view found");return}let i=a.containerEl.closest(".workspace-leaf-content");if(!i){console.error("[TradeNote] Cannot find containing leaf for active view");return}let s=this.findContainingLeaf(i),l=(m=s==null?void 0:s.view)==null?void 0:m.containerEl,c=(l==null?void 0:l.id)||null,d=c?`leaf-${c}`:this.generateViewId(i),u=a.getMode()==="source",p=this.getComponentClassName();if(u){let f=a.containerEl.querySelector(".metadata-container");if(f){let g=Array.from(i.querySelectorAll(`.${p}`)).find(v=>{let h=v.getAttribute("data-file-path")===r.path,y=v.getAttribute("data-view-id")===d,b=!c||v.getAttribute("data-leaf-id")===c;return h&&y&&b});g||(g=document.createElement("div"),g.className=p,g.setAttribute("data-file-path",r.path),g.setAttribute("data-view-id",d),c&&g.setAttribute("data-leaf-id",c),f.after(g)),this.renderer.renderComponent(g,o,r.path,d),this.markFileRenderedInMode(r.path,"source")}}else{let f=a.containerEl.querySelector(".markdown-preview-view");if(f){let g=Array.from(f.querySelectorAll(`.${p}`)).find(v=>{let h=v.getAttribute("data-file-path")===r.path,y=v.getAttribute("data-view-id")===d,b=!c||v.getAttribute("data-leaf-id")===c;return h&&y&&b});g||(g=document.createElement("div"),g.className=p,g.setAttribute("data-file-path",r.path),g.setAttribute("data-view-id",d),c&&g.setAttribute("data-leaf-id",c),f.prepend(g)),this.renderer.renderComponent(g,o,r.path,d),this.markFileRenderedInMode(r.path,"preview")}}}}});var Xce=L(()=>{Jce();QR();XR()});var je,ZR,sf,Rze,Qce,Zce=L(()=>{je=q(Y()),ZR=require("obsidian");eo();Ed();vd();GF();Nr();wt();sf=["daily","fourHour","oneHour","thirtyMin"],Rze=({forecast:e,updateData:t})=>{let r=({color:k,size:T=16})=>je.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:T,height:T,viewBox:"0 0 24 24",fill:"none",stroke:k,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},je.default.createElement("path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"}),je.default.createElement("line",{x1:"4",y1:"22",x2:"4",y2:"15"})),n=[{value:null,icon:je.default.createElement(r,{color:"var(--text-muted)"}),label:"None"},{value:"High",icon:je.default.createElement(r,{color:"var(--color-error, #e53935)"}),label:"High"},{value:"Medium",icon:je.default.createElement(r,{color:"var(--color-orange, #ef6c00)"}),label:"Medium"},{value:"Low",icon:je.default.createElement(r,{color:"var(--interactive-accent, #4a90e2)"}),label:"Low"}],o=je.default.createElement(r,{color:"var(--text-muted)"}),[a,i]=(0,je.useState)(""),[s,l]=(0,je.useState)(""),[c,d]=(0,je.useState)(null),[u,p]=(0,je.useState)(null),f=(()=>{if(e.levels&&!e.keyLevels)try{let k=e.levels.split(`
`).filter(O=>O.trim().length>0),T=/(low|medium|high)\s*:\s*(.*)/i,P=[],D=[];return k.forEach(O=>{let z=O.trim(),I=z.toLowerCase(),A=I.includes("support"),j=I.includes("resistance"),E=I.match(T);if(E){let N=E[1].charAt(0).toUpperCase()+E[1].slice(1).toLowerCase(),B=E[2].trim();A?P.push({price:B,importance:N}):j?D.push({price:B,importance:N}):D.push({price:B,importance:N})}else if(z.length>0)if(A){let N=I.replace(/support/i,"").trim();P.push({price:N||z,importance:null})}else if(j){let N=I.replace(/resistance/i,"").trim();D.push({price:N||z,importance:null})}else D.push({price:z,importance:null})}),{support:P,resistance:D}}catch(k){return console.error("Error migrating legacy levels:",k),{support:[],resistance:[]}}return e.keyLevels||{support:[],resistance:[]}})(),g=()=>{if(!a.trim())return;let k={...f,support:[...f.support,{price:a,importance:c}]};b(k),i(""),d(null)},v=()=>{if(!s.trim())return;let k={...f,resistance:[...f.resistance,{price:s,importance:u}]};b(k),l(""),p(null)},h=k=>{let T=[...f.support];T.splice(k,1),b({...f,support:T})},y=k=>{let T=[...f.resistance];T.splice(k,1),b({...f,resistance:T})},b=k=>{let T={...e,keyLevels:k};t({forecast:T})},x=k=>{k.key==="Enter"&&(k.preventDefault(),g())},w=k=>{k.key==="Enter"&&(k.preventDefault(),v())},S=k=>{switch(k){case"High":return"importance-high";case"Medium":return"importance-medium";case"Low":return"importance-low";default:return""}};return je.default.createElement("div",{className:"drc-key-levels"},je.default.createElement("div",{className:"drc-levels-container"},je.default.createElement("div",{className:"drc-level-section support-section"},je.default.createElement("h4",{className:"drc-level-header support-header"},"Support Levels"),je.default.createElement("div",{className:"drc-level-add-container"},je.default.createElement("div",{className:"drc-level-input-group"},je.default.createElement("input",{type:"text",value:a,onChange:k=>i(k.target.value),onKeyDown:x,className:"drc-level-input",placeholder:"Enter price level",style:{height:"32px"}}),je.default.createElement(qF,{options:n,value:c,onChange:k=>d(k),placeholderIcon:o,title:"Select importance level"}),je.default.createElement(he,{variant:"primary",onClick:g,title:"Add support level",className:"drc-level-add-button"},"Add"))),je.default.createElement("div",{className:"drc-levels-list"},f.support.length>0?f.support.map((k,T)=>je.default.createElement("div",{key:`support-${T}`,className:`drc-level-item support-level ${S(k.importance)}`},je.default.createElement("div",{className:"drc-level-price"},k.price),k.importance&&je.default.createElement("div",{className:"drc-level-importance"},k.importance),je.default.createElement("button",{className:"drc-level-remove-button",onClick:()=>h(T),title:"Remove level"},je.default.createElement("span",{style:{position:"relative",top:"-1px"}},"\xD7")))):je.default.createElement("div",{className:"drc-empty-levels"},"No support levels defined"))),je.default.createElement("div",{className:"drc-level-section resistance-section"},je.default.createElement("h4",{className:"drc-level-header resistance-header"},"Resistance Levels"),je.default.createElement("div",{className:"drc-level-add-container"},je.default.createElement("div",{className:"drc-level-input-group"},je.default.createElement("input",{type:"text",value:s,onChange:k=>l(k.target.value),onKeyDown:w,className:"drc-level-input",placeholder:"Enter price level",style:{height:"32px"}}),je.default.createElement(qF,{options:n,value:u,onChange:k=>p(k),placeholderIcon:o,title:"Select importance level"}),je.default.createElement(he,{variant:"primary",onClick:v,title:"Add resistance level",className:"drc-level-add-button"},"Add"))),je.default.createElement("div",{className:"drc-levels-list"},f.resistance.length>0?f.resistance.map((k,T)=>je.default.createElement("div",{key:`resistance-${T}`,className:`drc-level-item resistance-level ${S(k.importance)}`},je.default.createElement("div",{className:"drc-level-price"},k.price),k.importance&&je.default.createElement("div",{className:"drc-level-importance"},k.importance),je.default.createElement("button",{className:"drc-level-remove-button",onClick:()=>y(T),title:"Remove level"},je.default.createElement("span",{style:{position:"relative",top:"-1px"}},"\xD7")))):je.default.createElement("div",{className:"drc-empty-levels"},"No resistance levels defined")))),je.default.createElement("style",null,`
        .drc-key-levels {
          margin-top: 16px;
        }

        .drc-levels-container {
          display: flex;
          flex-direction: column;
          gap: 24px;
        }

        .drc-level-section {
          border-radius: 8px;
          padding: 16px;
          background-color: var(--background-secondary);
        }

        .support-section {
          border-left: 3px solid rgba(102, 187, 106, 0.7);
        }

        .resistance-section {
          border-left: 3px solid rgba(229, 57, 53, 0.7);
        }

        .drc-level-header {
          margin: 0 0 12px 0;
          padding-bottom: 8px;
          border-bottom: 1px solid var(--background-modifier-border);
          font-size: 14px;
          font-weight: 600;
          text-align: center;
        }

        .support-header {
          color: var(--color-success, #43a047);
        }

        .resistance-header {
          color: var(--color-error, #e53935);
        }

        .drc-level-add-container {
          margin-bottom: 12px;
        }

        .drc-level-input-group {
          display: flex;
          gap: 8px;
          width: 100%;
        }

        .drc-level-input {
          flex: 2;
          min-width: 0;
          padding: 8px 12px;
          border: 1px solid var(--background-modifier-border);
          border-radius: 4px;
          background-color: var(--background-primary);
          color: var(--text-normal);
          font-size: 14px;
          height: 32px; /* Reduced height */
          box-sizing: border-box;
        }

        .drc-level-importance-select {
          width: 40px;
          position: relative;
          display: flex;
          align-items: center;
        }

        .importance-icon-wrapper {
          position: absolute;
          left: 4px;
          z-index: 1;
          pointer-events: none;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .importance-flag-icon {
          color: var(--text-muted);
        }

        .drc-importance-select {
          width: 40px;
          padding: 8px 0 8px 24px;
          border: 1px solid var(--background-modifier-border);
          border-radius: 4px;
          background-color: var(--background-primary);
          color: var(--text-normal);
          font-size: 14px;
          height: 32px; /* Reduced height */
          box-sizing: border-box;
          appearance: none;
          -webkit-appearance: none;
          -moz-appearance: none;
          background-image: none; /* Remove dropdown arrow */
          text-align: center;
        }

        .drc-level-add-button {
          padding: 6px 12px !important;
          height: 32px !important; /* Reduced height */
          box-sizing: border-box !important;
          display: flex !important;
          align-items: center !important;
          justify-content: center !important;
        }

        .drc-levels-list {
          display: flex;
          flex-direction: column;
          gap: 8px;
        }

        .drc-level-item {
          display: flex;
          align-items: center;
          padding: 8px 12px;
          background-color: var(--background-primary);
          border-radius: 4px;
          position: relative;
          justify-content: flex-start;
        }

        .support-level {
          border-left: 3px solid rgba(102, 187, 106, 0.5);
        }

        .resistance-level {
          border-left: 3px solid rgba(229, 57, 53, 0.5);
        }

        .drc-level-price {
          font-weight: 500;
          margin-right: 8px;
        }

        .drc-level-importance {
          font-size: 12px;
          padding: 2px 6px;
          border-radius: 3px;
        }

        .importance-high {
          background-color: rgba(229, 57, 53, 0.1);
        }

        .importance-high .drc-level-importance {
          background-color: rgba(229, 57, 53, 0.2);
          color: var(--color-error, #e53935);
        }

        .importance-medium {
          background-color: rgba(255, 152, 0, 0.1);
        }

        .importance-medium .drc-level-importance {
          background-color: rgba(255, 152, 0, 0.2);
          color: var(--color-orange, #ef6c00);
        }

        .importance-low {
          background-color: rgba(33, 150, 243, 0.1);
        }

        .importance-low .drc-level-importance {
          background-color: rgba(33, 150, 243, 0.2);
          color: var(--interactive-accent);
        }

        .drc-level-remove-button {
          padding: 0;
          width: 24px;
          height: 24px;
          background-color: rgba(229, 57, 53, 0.1);
          color: var(--color-error, #e53935);
          border: none;
          border-radius: 50%;
          cursor: pointer;
          font-size: 16px;
          line-height: 0;
          display: flex;
          align-items: center;
          justify-content: center;
          margin-left: auto; /* Always push to the right */
          text-align: center;
          vertical-align: middle;
        }

        .drc-empty-levels {
          color: var(--text-muted);
          font-style: italic;
          padding: 8px;
          text-align: center;
        }

        @media (min-width: 768px) {
          .drc-levels-container {
            flex-direction: row !important;
            gap: 16px !important;
          }

          .drc-level-section {
            width: calc(50% - 8px) !important;
          }
        }
      `))},Qce=({frontmatter:e,updateFrontmatter:t,trades:r,openNote:n,plugin:o,previousDayGoals:a})=>{let i=e,s=t,l=async M=>{let _=i.preTradeChecklist||{},W={..._,[M]:!_[M]};s({preTradeChecklist:W})},c=async M=>{let _={...i.dailyGoalStatus||{}},W=`goal_${M}`;_[W]=!_[W],s({dailyGoalStatus:_})},d=()=>{var M;try{let _=window.app;return(M=_==null?void 0:_.plugins)==null?void 0:M.plugins.journalit}catch(_){return console.error("Could not access plugin instance:",_),null}},u=()=>{var M,_;try{let W=d();return((_=(M=W==null?void 0:W.settings)==null?void 0:M.drc)==null?void 0:_.customTimeframes)||["Daily","4H","1H","30M"]}catch(W){return console.error("Error getting timeframes:",W),["Daily","4H","1H","30M"]}},p=()=>{let M=u(),_={},W={};return M.forEach($=>{let H=$.replace(/\s+/g,"_").toLowerCase();_[H]=!1,W[H]=!1,$==="Daily"&&(_.daily=!1),$==="4H"&&(_.fourHour=!1),$==="1H"&&(_.oneHour=!1),$==="30M"&&(_.thirtyMin=!1),$==="Daily"&&(W.daily=!1),$==="4H"&&(W.fourHour=!1),$==="1H"&&(W.oneHour=!1),$==="30M"&&(W.thirtyMin=!1)}),{initialDragState:_,initialErrorState:W}},{initialDragState:m,initialErrorState:f}=p(),[g,v]=(0,je.useState)(m),[h,y]=(0,je.useState)(f),[b,x]=(0,je.useState)([]),[w,S]=(0,je.useState)({isOpen:!1,imagePath:"",description:""});(0,je.useEffect)(()=>{async function M(){try{let _=d();if(!(_!=null&&_.drcService))return;let W=Mt(i.date);if(!W){x([]);return}let $=await _.drcService.getWeeklyEventsForDate(W);x($)}catch(_){console.error("Error fetching weekly events for date:",i.date,_)}}i.date&&M()},[i.date]);let k=M=>{y(_=>({..._,[M]:!0}))},T=M=>{y(_=>({..._,[M]:!1}))},P=async(M,_,W=!1)=>{T(_);try{let $=d();if(!($!=null&&$.drcService))throw new Error("DRC Service not available");let H=Mt(i.date);if(!H){new ZR.Notice("Invalid DRC date");return}let R=await $.drcService.saveDRCForecastImage(M,H,_);await A(_,R,W)}catch($){console.error("Error uploading image:",$)}},D=(M,_=!1)=>async W=>(await P(W,M,_),""),O=(M,_,W=!1)=>{let H={...i.forecast||{daily:{notes:""},fourHour:{notes:""},oneHour:{notes:""},thirtyMin:{notes:""},customTimeframes:{},bias:"",levels:""}};if(W){H.customTimeframes||(H.customTimeframes={});let R=H.customTimeframes[M]||{notes:""};H.customTimeframes[M]={...R,notes:_}}else{if(!sf.includes(M)){console.error(`[DRC] Invalid forecast section: ${M}. Must be one of: ${sf.join(", ")}`);return}let R=M;if(R in H){let V=H[R];typeof V=="object"&&V!==null&&"notes"in V&&(V.notes=_)}}s({forecast:H})},z=(M,_)=>{s({[M]:_})},I=()=>{var M,_,W;if(!i.preTradeChecklist||Object.keys(i.preTradeChecklist).length===0){let $=d(),H=((W=(_=(M=$==null?void 0:$.settings)==null?void 0:M.drc)==null?void 0:_.checklistItems)==null?void 0:W.length)>0;return je.default.createElement(et,{message:"No pre-trade checklist items",subMessage:H?"Apply checklist items from plugin settings":"Add checklist items in the plugin settings",actionButtonText:H?"Apply Settings":void 0,onActionButtonClick:H?()=>{let R=$.settings.drc.checklistItems||[],V={};R.forEach(Z=>{V[Z]=!1}),s({preTradeChecklist:V})}:void 0,iconSize:36})}return je.default.createElement("div",{className:"drc-checklist"},Object.entries(i.preTradeChecklist).map(([$,H],R)=>{let V=`checklist-${R}-${$.replace(/\s+/g,"-")}`;return je.default.createElement("div",{key:V,className:"drc-checklist-item",onClick:async Z=>{let K=Z.target;K.tagName!=="INPUT"&&K.tagName!=="LABEL"&&await l($)}},je.default.createElement("input",{type:"checkbox",id:V,checked:H||!1,onChange:async()=>await l($),className:"drc-checkbox"}),je.default.createElement("label",{htmlFor:V},$))}))},A=async(M,_,W=!1)=>{var H;let $={...i.forecast||{daily:{notes:""},fourHour:{notes:""},oneHour:{notes:""},thirtyMin:{notes:""},customTimeframes:{},bias:"",levels:""}};if(W){$.customTimeframes||($.customTimeframes={});let R=Array.isArray((H=$.customTimeframes[M])==null?void 0:H.images)?[...$.customTimeframes[M].images]:[];if(R.includes(_))return;$.customTimeframes[M]={...$.customTimeframes[M],images:[...R,_]}}else{if(!sf.includes(M)){console.error(`[DRC] Invalid forecast section: ${M}. Must be one of: ${sf.join(", ")}`);return}let R=$[M];if(typeof R=="object"&&R!==null&&"notes"in R&&typeof R.notes=="string"){let V=Array.isArray(R.images)?[...R.images]:[];if(V.includes(_))return;$[M]={notes:R.notes,images:[...V,_]}}}s({forecast:$})},j=async(M,_,W=!1)=>{var H;let $={...i.forecast||{daily:{notes:""},fourHour:{notes:""},oneHour:{notes:""},thirtyMin:{notes:""},customTimeframes:{},bias:"",levels:""}};if(W){$.customTimeframes||($.customTimeframes={});let R=Array.isArray((H=$.customTimeframes[M])==null?void 0:H.images)?[...$.customTimeframes[M].images]:[],V=_.filter(Z=>!R.includes(Z));if(V.length===0)return;$.customTimeframes[M]={...$.customTimeframes[M],images:[...R,...V]}}else{if(!sf.includes(M)){console.error(`[DRC] Invalid forecast section: ${M}. Must be one of: ${sf.join(", ")}`);return}let R=$[M],V=Array.isArray(R==null?void 0:R.images)?[...R.images]:[],Z=_.filter(K=>!V.includes(K));if(Z.length===0)return;$[M]={...R||{notes:""},images:[...V,...Z]}}s({forecast:$})},E=async(M,_,W,$=!1)=>{var H,R;try{let V=d();V!=null&&V.drcService&&await V.drcService.deleteImage(W);let Z={...i.forecast||{daily:{notes:""},fourHour:{notes:""},oneHour:{notes:""},thirtyMin:{notes:""},customTimeframes:{},bias:"",levels:""}};if($){if((R=(H=Z.customTimeframes)==null?void 0:H[M])!=null&&R.images){let K=[...Z.customTimeframes[M].images];K.splice(_,1),Z.customTimeframes[M]={...Z.customTimeframes[M],images:K}}}else{if(!sf.includes(M)){console.error(`[DRC] Invalid forecast section: ${M}. Must be one of: ${sf.join(", ")}`);return}let K=Z[M];if(K!=null&&K.images){let X=[...K.images];X.splice(_,1),Z[M]={...K,images:X}}}s({forecast:Z})}catch(V){console.error("Error deleting image from section:",V)}},N=(M,_=!1)=>({getSectionData:()=>{var H;let W=i.forecast||{daily:{notes:""},fourHour:{notes:""},oneHour:{notes:""},thirtyMin:{notes:""},customTimeframes:{},bias:"",levels:""},$;if(_)$=((H=W.customTimeframes)==null?void 0:H[M])||{notes:""};else{let R=W[M];$=typeof R=="object"&&R!==null?R:{notes:""}}return $&&$.imagePath&&!$.images?{...$,images:[$.imagePath]}:{...$,images:($==null?void 0:$.images)||[]}},handleImageUpload:async W=>{A(M,W,_),T(M)},handleMultipleImagesUpload:async W=>{j(M,W,_),T(M)},handleNotesChange:W=>{O(M,W,_)},handleImageDelete:(W,$)=>{E(M,W,$,_)}}),B=(M,_,W=!1)=>{let $=N(M,W),H=$.getSectionData();return je.default.createElement(Y1,{key:M,sectionName:M,sectionTitle:_,notes:H.notes||"",images:H.images||[],onNotesChange:$.handleNotesChange,onImageUploaded:$.handleImageUpload,onMultipleImagesUploaded:$.handleMultipleImagesUpload,onImageDeleted:$.handleImageDelete,saveImageFunction:async R=>{try{let V=d();if(!(V!=null&&V.drcService))throw new Error("DRC Service not available");let Z=Mt(i.date);if(!Z){new ZR.Notice("Invalid DRC date");return}return await V.drcService.saveDRCForecastImage(R,Z,M)}catch(V){throw console.error(`Error uploading image for ${M}:`,V),k(M),V}},isCustom:W,className:{container:"drc-forecast-section",sectionTitle:"drc-forecast-title",notesContainer:"drc-forecast-notes",imageContainer:"drc-image-container"}})},C=()=>{let M=i.forecast||{daily:{notes:""},fourHour:{notes:""},oneHour:{notes:""},thirtyMin:{notes:""},customTimeframes:{},bias:"",levels:""},_=u(),W={Daily:"daily","4H":"fourHour","1H":"oneHour","30M":"thirtyMin"};return je.default.createElement("div",{className:"drc-note-forecast"},_.map($=>{let H=$.replace(/\s+/g,"_").toLowerCase(),R=Object.keys(W).includes($),V=R?W[$]:H;return B(V,$,!R)}),je.default.createElement("div",{className:"drc-input-group"},je.default.createElement("div",{style:{position:"relative",marginBottom:"4px"}},je.default.createElement(En,{label:"Market Bias",value:M.bias||"",onChange:$=>{let H={...M,bias:$};s({forecast:H})},options:[{value:"Bullish",label:"Bullish"},{value:"Bearish",label:"Bearish"},{value:"Neutral",label:"Neutral"}],className:"drc-select",placeholder:"Select market bias"}),je.default.createElement("style",null,`
              .drc-container .drc-input-group .select,
              .drc-container select {
                height: 38px !important;
                min-height: 38px !important;
                box-sizing: border-box !important;
                padding-top: 0 !important;
                padding-bottom: 0 !important;
                line-height: 38px !important;
              }

              .drc-container .drc-input-group .select option,
              .drc-container select option {
                height: auto !important;
                min-height: 24px !important;
                padding: 8px !important;
                line-height: normal !important;
              }`))),je.default.createElement(Rze,{forecast:M,updateData:s}))};return je.default.createElement("div",{className:"drc-note-preparation"},je.default.createElement("div",{className:"drc-section"},je.default.createElement(G1,{goals:a||null,goalStatus:i.dailyGoalStatus||{},onToggleGoal:c,title:"Daily Goals",emptyMessage:"No daily goals from previous day",emptyActionLabel:"",className:{container:"drc-weekly-goals",goalItem:"drc-checklist-item",goalCheckbox:"drc-checkbox",goalText:"drc-goal-text",completed:"completed"}})),je.default.createElement("div",{className:"drc-section"},je.default.createElement("h3",null,"Pre-Trade Checklist"),I()),je.default.createElement("div",{className:"drc-section"},je.default.createElement("h3",null,"Key Events"),b.length>0?je.default.createElement("div",{className:"drc-weekly-events"},b.map((M,_)=>{let W=M.color?`event-color-${M.color}`:"event-color-gray";return je.default.createElement("div",{key:`event-${_}`,className:`drc-weekly-event-item ${W}`},je.default.createElement("div",{className:"drc-weekly-event-header"},je.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px"}},je.default.createElement("h4",null,M.event),!M.day&&je.default.createElement("span",{className:"drc-weekly-event-badge"},"All Week"))),M.notes&&je.default.createElement("p",null,M.notes))})):je.default.createElement(et,{message:"No key events for today",subMessage:"Events can be added in the weekly review",iconSize:36})),je.default.createElement("div",{className:"drc-section"},je.default.createElement("h3",null,"Daily Forecast"),C()),je.default.createElement("div",{className:"drc-section"},je.default.createElement("h3",null,"Media Links"),je.default.createElement("div",{className:"drc-media"},je.default.createElement("div",{className:"drc-input-group"},je.default.createElement("label",null,"YouTube Link"),je.default.createElement("input",{type:"text",value:i.youtubeLink||"",onChange:M=>z("youtubeLink",M.target.value),placeholder:"Link to your trading stream",className:"drc-input"})))))}});var Yb,EL,e4=L(()=>{Yb=q(Y()),EL=({size:e=24,className:t=""})=>Yb.default.createElement("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t},Yb.default.createElement("rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",ry:"2"}),Yb.default.createElement("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),Yb.default.createElement("path",{d:"M20.4 14.5L16 10 4 20"}),Yb.default.createElement("line",{x1:"4",y1:"4",x2:"20",y2:"20"}))});var Be,ede,tde=L(()=>{Be=q(Y());e4();xv();Zw();Lu();eo();Ut();Q5();Zl();Iu();ga();rr();pt();f0();ede=({trades:e,openNote:t,selectedAccounts:r,availableAccounts:n,onAccountFilterChange:o})=>{var D,O,z,I;let{currency:a}=Ke(),i=xe(),s=(O=(D=i==null?void 0:i.settings)==null?void 0:D.trade)==null?void 0:O.displayRMultiples,l=(I=(z=i==null?void 0:i.settings)==null?void 0:z.trade)==null?void 0:I.defaultRiskAmount,c=(0,Be.useMemo)(()=>!r||r.length===0?e:e.filter(A=>{let j=E=>E?Array.isArray(E)?E.some(N=>r.includes(N)):typeof E=="string"?r.includes(E):!1:!1;return j(A.account)||j(A.accountIds)}),[e,r]),[d,u]=(0,Be.useState)(!1),[p,m]=(0,Be.useState)([]),[f,g]=(0,Be.useState)(0),[v,h]=(0,Be.useState)(""),y=(0,Be.useCallback)((A,j,E)=>{let N=E.indexOf(A);m(E),g(N>=0?N:0),h(j),u(!0)},[]),b=(0,Be.useCallback)(()=>{u(!1)},[]),x=(0,Be.useCallback)(A=>{A>=0&&A<p.length&&g(A)},[p.length]),w=(0,Be.useMemo)(()=>{if(!(p.length<=1))return{images:p,currentIndex:f,onNavigate:x,altPrefix:`Trade ${v} Image`,useResolveMediaPath:!0}},[p,f,x,v]),k=(()=>{if(c.length===0)return{totalTrades:0,winningTrades:0,losingTrades:0,breakEvenTrades:0,pnl:0,winRate:0,profitFactor:0,expectancy:0,avgWin:0,avgLoss:0,plRatio:0,rMultiple:0,rMultipleExpectancy:0,rMultipleAvgWin:0,rMultipleAvgLoss:0};let A=c.filter(J=>!Pt({tradeStatus:J.tradeStatus,exitTime:J.exitTime,pnl:J.pnl,useDirectPnLInput:J.useDirectPnLInput,exits:J.exits,entries:J.entries})),j=A.length,E=0,N=0,B=0,C=0,F=0,M=0,_=0,W=0,$=0;A.forEach(J=>{var ue;let ee=J.pnl!==void 0&&J.pnl!==null?J.pnl:((ue=J.direction)==null?void 0:ue.toLowerCase())==="long"?(J.exitPrice-J.entryPrice)*J.positionSize:(J.entryPrice-J.exitPrice)*J.positionSize;C+=ee;let te=st(ee,J.rMultiple,J.riskAmount,l);te!==void 0&&(_+=te,te>0?W+=te:te<0&&($+=Math.abs(te))),ee>0?(E++,F+=ee):ee<0?(N++,M+=Math.abs(ee)):B++});let H=j>0?E/j*100:0,R=E>0?F/E:0,V=N>0?M/N:0,Z=V>0?R/V:0,K=M>0?F/M:F>0?1/0:0,X=H/100*R-(100-H)/100*V,G=E>0?W/E:0,U=N>0?$/N:0,Q=H/100*G-(100-H)/100*U;return{totalTrades:j,winningTrades:E,losingTrades:N,breakEvenTrades:B,pnl:C,winRate:H,profitFactor:K,expectancy:X,avgWin:R,avgLoss:V,plRatio:Z,rMultiple:_,rMultipleExpectancy:Q,rMultipleAvgWin:G,rMultipleAvgLoss:U}})(),T=(0,Be.useMemo)(()=>Uf(c,"MMM DD, YYYY",l),[c,l]),P=(0,Be.useMemo)(()=>{if(!c||c.length===0)return[];let A=c.filter(E=>!Pt({tradeStatus:E.tradeStatus,exitTime:E.exitTime,pnl:E.pnl,useDirectPnLInput:E.useDirectPnLInput,exits:E.exits,entries:E.entries}));if(A.length===0)return[];let j=A.map(E=>{var B;let N=E.pnl!==void 0&&E.pnl!==null?E.pnl:((B=E.direction)==null?void 0:B.toLowerCase())==="long"?(E.exitPrice-E.entryPrice)*E.positionSize:(E.entryPrice-E.exitPrice)*E.positionSize;return{...E,pnl:N,entryTime:new Date(E.entryTime),exitTime:E.exitTime?new Date(E.exitTime):void 0}});return Vf(j,"MMM DD, YYYY",l)},[c,l]);return Be.default.createElement("div",{className:"drc-note-trades-tab"},Be.default.createElement("div",{className:"drc-section"},Be.default.createElement(fm,{accounts:n||[],selectedAccounts:r||[],onChange:o||(()=>{}),useOnlyProvidedAccounts:!0})),T.length>0&&Be.default.createElement("div",{className:"drc-section"},Be.default.createElement("h3",null,"Cumulative P&L"),Be.default.createElement(Jd,{data:T,height:250,plugin:i})),P.length>0&&Be.default.createElement("div",{className:"drc-section"},Be.default.createElement("h3",null,"Drawdown from Peak Equity"),Be.default.createElement(lp,{data:P,height:250,plugin:i})),Be.default.createElement("div",{className:"drc-section"},Be.default.createElement("h3",null,"Daily Trade Statistics"),Be.default.createElement("div",{className:"drc-stats"},Be.default.createElement("div",{className:"drc-stat-card"},Be.default.createElement("div",{className:`drc-stat-value ${k.pnl>=0?"positive":"negative"}`,title:ve(k.pnl,!0,a,s,k.rMultiple),style:{width:"100%"}},ve(k.pnl,!0,a,s,k.rMultiple)),Be.default.createElement("div",{className:"drc-stat-label"},"Net P&L")),Be.default.createElement("div",{className:"drc-stat-card"},Be.default.createElement("div",{className:"drc-stat-value"},k.winRate.toFixed(1).endsWith(".0")?Math.floor(k.winRate):k.winRate.toFixed(1),"%"),Be.default.createElement("div",{className:"drc-stat-label"},"Win Rate")),Be.default.createElement("div",{className:"drc-stat-card"},Be.default.createElement("div",{className:"drc-stat-value"},k.profitFactor===1/0?"\u221E":k.profitFactor.toFixed(2)),Be.default.createElement("div",{className:"drc-stat-label"},"Profit Factor")),Be.default.createElement("div",{className:"drc-stat-card"},Be.default.createElement("div",{className:"drc-stat-value"},ve(k.expectancy,!0,a,s,k.rMultipleExpectancy)),Be.default.createElement("div",{className:"drc-stat-label"},"Expectancy")),Be.default.createElement("div",{className:"drc-stat-card"},Be.default.createElement("div",{className:"drc-stat-value"},k.totalTrades),Be.default.createElement("div",{className:"drc-stat-label"},"Total Trades")),Be.default.createElement("div",{className:"drc-stat-card"},Be.default.createElement("div",{className:"drc-stat-value positive"},ve(k.avgWin,!0,a,s,k.rMultipleAvgWin)),Be.default.createElement("div",{className:"drc-stat-label"},"Avg Win")),Be.default.createElement("div",{className:"drc-stat-card"},Be.default.createElement("div",{className:"drc-stat-value negative"},ve(k.avgLoss,!0,a,s,k.rMultipleAvgLoss)),Be.default.createElement("div",{className:"drc-stat-label"},"Avg Loss")),Be.default.createElement("div",{className:"drc-stat-card"},Be.default.createElement("div",{className:"drc-stat-value"},k.plRatio.toFixed(2)),Be.default.createElement("div",{className:"drc-stat-label"},"P/L Ratio")))),Be.default.createElement("div",{className:"drc-section"},Be.default.createElement("h3",null,"Trade Log"),c.length===0?Be.default.createElement(et,{message:"No trades for this day",subMessage:"Trades will appear here once they are added",iconSize:40}):Be.default.createElement("div",{className:"weekly-review-trades-table"},Be.default.createElement("table",null,Be.default.createElement("thead",null,Be.default.createElement("tr",null,Be.default.createElement("th",null,"Images"),Be.default.createElement("th",null,"Entry/Exit Time"),Be.default.createElement("th",null,"Ticker"),Be.default.createElement("th",null,"Direction"),Be.default.createElement("th",null,"Setup"),Be.default.createElement("th",null,"P&L"))),Be.default.createElement("tbody",null,[...c].sort((A,j)=>new Date(A.entryTime).getTime()-new Date(j.entryTime).getTime()).map((A,j)=>{var _,W,$;let E=A.id||`index-${j}`,N=Pt({tradeStatus:A.tradeStatus,exitTime:A.exitTime,pnl:A.pnl,useDirectPnLInput:A.useDirectPnLInput,exits:A.exits,entries:A.entries}),B=null,C;N||(B=A.pnl!==void 0&&A.pnl!==null?A.pnl:((_=A.direction)==null?void 0:_.toLowerCase())==="long"?(A.exitPrice-A.entryPrice)*A.positionSize:(A.entryPrice-A.exitPrice)*A.positionSize,C=st(B!==null?B:void 0,A.rMultiple,A.riskAmount,l));let F=B!==null&&B>0,M=[];try{if(A.images){if(Array.isArray(A.images))M=A.images;else if(typeof A.images=="string"){let H=JSON.parse(A.images);Array.isArray(H)&&(M=H.map(R=>String(R)))}}}catch(H){}return Be.default.createElement("tr",{key:`trade-${E}`,className:"weekly-review-trade-row",onClick:()=>{t&&(A.path?t(A.path,!0):A.id&&t(A.id,!0))},style:{cursor:A.path||A.id?"pointer":"default"}},Be.default.createElement("td",{className:"trade-preview-cell"},M.length>0?Be.default.createElement("div",{className:"trade-image-wrapper",onClick:H=>{H.stopPropagation(),y(M[0],A.id||j,M)},style:{cursor:"pointer"}},Be.default.createElement("div",{className:"trade-preview-thumbnail"},Be.default.createElement("img",{src:In.resolveMediaPath(M[0]),alt:`Trade ${A.id||j} preview`,className:"trade-image",style:{width:"100%",height:"100%",objectFit:"cover"},onError:()=>{}})),M.length>1&&Be.default.createElement("span",{className:"trade-image-count-indicator"},"+",M.length-1)):Be.default.createElement(EL,{size:24,className:"trade-no-image-icon"})),Be.default.createElement("td",null,((W=A.entryTime)==null?void 0:W.toLocaleTimeString())||"N/A"," / ",N?"OPEN":(($=A.exitTime)==null?void 0:$.toLocaleTimeString())||"N/A"),Be.default.createElement("td",null,A.instrument||A.ticker||"Unknown"),Be.default.createElement("td",null,A.assetType==="options"&&A.optionType?A.optionType.charAt(0).toUpperCase()+A.optionType.slice(1):A.direction||A.side||"N/A"),Be.default.createElement("td",null,A.setup&&Array.isArray(A.setup)?A.setup.join(", "):A.setup||"N/A"),Be.default.createElement("td",{style:{color:N?"inherit":F?"var(--color-green)":"var(--color-red)"}},N?"-":ve(B!=null?B:void 0,!0,a,s,C)))}))))),d&&p.length>0&&Be.default.createElement(Nu,{isOpen:d,onClose:b,title:`Trade ${v} Image`,portalId:"drc-trade-image-portal"},Be.default.createElement(dm,{imagePath:p[f],alt:`Trade ${v} Image ${f+1}`,useResolveMediaPath:!0,navigationContext:w,onClose:b})))}});var gr,rde,nde,ode=L(()=>{gr=q(Y()),rde=require("obsidian");eo();ci();DO();wt();nde=({frontmatter:e,updateFrontmatter:t,trades:r,openNote:n,plugin:o})=>{let[a,i]=(0,gr.useState)([]),[s,l]=(0,gr.useState)(!0),[c,d]=(0,gr.useState)(null);(0,gr.useEffect)(()=>{l0()},[]);let u=()=>{var y,b;try{return o||((b=(y=window.app)==null?void 0:y.plugins)==null?void 0:b.plugins.journalit)}catch(x){return console.error("Could not access plugin instance:",x),null}},p=async()=>{try{l(!0),d(null);let y=u();if(!(y!=null&&y.missedTradeService)){d("Missed Trade service not available");return}let b=Mt(e.date);if(!b){console.error("Invalid DRC date:",e.date),i([]);return}let x=lr(b,y),w=new Date(x);w.setHours(0,0,0,0);let S=new Date(x);S.setHours(23,59,59,999);let k=await y.missedTradeService.getMissedTrades(w,S),T=[];for(let P of k){let D=y.app.metadataCache.getFileCache(P),O=D==null?void 0:D.frontmatter;O&&O.type==="missed-trade"&&T.push({file:P,instrument:O.instrument||"Unknown",direction:O.direction||"Unknown",setup:O.setup||[],missedReason:O.missedReason||"",entryTime:O.entryTime?new Date(O.entryTime):new Date,path:P.path})}T.sort((P,D)=>D.entryTime.getTime()-P.entryTime.getTime()),i(T)}catch(y){console.error("Error loading missed trades:",y),d("Failed to load missed trades")}finally{l(!1)}};(0,gr.useEffect)(()=>{e.date&&p()},[e.date]),(0,gr.useEffect)(()=>{let y=b=>{p()};return document.addEventListener("journalit:missed-trade-data-changed",y),()=>{document.removeEventListener("journalit:missed-trade-data-changed",y)}},[e.date]);let m=y=>{n(y,!0)},f=()=>{var y;try{let b=Mt(e.date);if(!b){new rde.Notice("Invalid DRC date. Cannot create missed trade.");return}let x=u();if(x){let w={isMissedTrade:!0,entryTime:b};try{let{TradeFormModal:S}=(Td(),uu(TG));new S({app:x.app,plugin:x,isEditMode:!1,initialData:w}).open()}catch(S){(y=x.viewManager)==null||y.openTradeFormView(w)}}}catch(b){console.error("Error opening trade form for missed trade:",b)}},g=y=>{switch(y.toLowerCase()){case"long":case"buy":return"\u{1F4C8}";case"short":case"sell":return"\u{1F4C9}";default:return"\u{1F4CA}"}},v=y=>!y||y.length===0?"No setup specified":y.join(", "),h=y=>gr.default.createElement("div",{key:y.path,className:"drc-missed-trade-item"},gr.default.createElement("div",{className:"drc-missed-trade-header"},gr.default.createElement("div",{className:"drc-missed-trade-main"},gr.default.createElement("span",{className:"drc-missed-trade-icon"},g(y.direction)),gr.default.createElement("span",{className:"drc-missed-trade-instrument"},y.instrument),gr.default.createElement("span",{className:"drc-missed-trade-direction"},y.direction),gr.default.createElement("span",{className:"drc-missed-trade-badge"},"MISSED")),gr.default.createElement("button",{className:"drc-missed-trade-open-btn",onClick:()=>m(y.path),title:"Open missed trade details"},"View Details \u2192")),gr.default.createElement("div",{className:"drc-missed-trade-details"},gr.default.createElement("div",{className:"drc-missed-trade-setup"},gr.default.createElement("strong",null,"Setup:")," ",v(y.setup)),y.missedReason&&gr.default.createElement("div",{className:"drc-missed-trade-reason"},gr.default.createElement("strong",null,"Reason:")," ",y.missedReason)));return s?gr.default.createElement("div",{className:"drc-missed-trades-loading"},"Loading missed trades..."):c?gr.default.createElement("div",{className:"drc-missed-trades-error"},gr.default.createElement("p",null,"Error: ",c),gr.default.createElement("button",{onClick:p,className:"drc-retry-button"},"Retry")):gr.default.createElement("div",{className:"drc-missed-trades-section"},gr.default.createElement("div",{className:"drc-missed-trades-header"},gr.default.createElement("h3",null,"Missed Trades",a.length>0&&gr.default.createElement("span",{className:"drc-missed-trades-count"},"(",a.length,")")),gr.default.createElement("button",{className:"drc-add-button drc-add-missed-trade-btn",onClick:f,title:"Add a new missed trade"},"+ Add Missed Trade")),gr.default.createElement("div",{className:"drc-missed-trades-content"},a.length===0?gr.default.createElement(et,{message:"No missed trades for today",subMessage:"Track trading opportunities you missed to improve your execution",iconSize:36}):gr.default.createElement("div",{className:"drc-missed-trades-list"},a.map(h))))}});var Nt,ade,ide,sde=L(()=>{Nt=q(Y()),ade=require("obsidian");Ed();RC();ode();wt();ide=({frontmatter:e,updateFrontmatter:t,trades:r,openNote:n,plugin:o,instrumentOptions:a,setupOptions:i,onSaveInstrument:s,onSaveSetup:l})=>{var P,D,O;let c=e,d=t,u=async()=>{let z=c.dailyGoals||[];t({dailyGoals:[...z,""]})},p=async(z,I)=>{let A=[...c.dailyGoals||[]];z>=0&&z<A.length&&(A[z]=I,t({dailyGoals:A}))},m=async z=>{let I=[...c.dailyGoals||[]];I.splice(z,1),t({dailyGoals:I})},f=(z,I)=>{let A={...c.reviewQuestions,[z]:I};t({reviewQuestions:A})},g=(z,I)=>{let A=c.endOfDayReview||{images:[]};d({endOfDayReview:{...A,[z]:I,timestamp:z==="images"?new Date().toISOString():A.timestamp}})},v=z=>{var A;let I=((A=c.endOfDayReview)==null?void 0:A.images)||[];g("images",[...I,z])},h=z=>{var A;let I=((A=c.endOfDayReview)==null?void 0:A.images)||[];g("images",[...I,...z])},y=async(z,I)=>{var j,E;let A=[...((j=c.endOfDayReview)==null?void 0:j.images)||[]];A.splice(z,1),g("images",A);try{let N=window.app,B=(E=N==null?void 0:N.plugins)==null?void 0:E.plugins.journalit;if(B!=null&&B.drcService)try{await B.drcService.deleteImage(I)}catch(C){console.error("Failed to delete image:",C)}}catch(N){console.error("Failed to delete EOD image:",N)}},b=async z=>{var I;try{let A=window.app,j=(I=A==null?void 0:A.plugins)==null?void 0:I.plugins.journalit;if(j!=null&&j.drcService){let E=Mt(c.date);if(!E)throw new ade.Notice("Invalid DRC date format. Please check the date in your DRC note."),new Error("Invalid DRC date");return await j.drcService.saveDRCForecastImage(z,E,"eod")}throw new Error("DRC service not available")}catch(A){throw console.error("Failed to save EOD image:",A),A}},x=async()=>{d({endOfDayReview:{...c.endOfDayReview||{images:[]},reviewed:!0,reviewedAt:new Date().toISOString()}})},w=()=>!c.dailyGoals||c.dailyGoals.length===0?null:Nt.default.createElement(Nt.default.Fragment,null,c.dailyGoals.map((z,I)=>Nt.default.createElement("div",{key:I,className:"drc-goal-item"},Nt.default.createElement("input",{type:"text",value:z,onChange:A=>{p(I,A.target.value)},placeholder:"Your goal for the next session"}),Nt.default.createElement("button",{className:"drc-remove-button",onClick:()=>{m(I)}},"Remove")))),S=()=>!c.reviewQuestions||Object.keys(c.reviewQuestions).length===0?Nt.default.createElement("div",{className:"drc-no-questions"},"No reflection questions defined. Add review questions in settings."):Nt.default.createElement("div",{className:"drc-reflection"},Object.entries(c.reviewQuestions).map(([z,I])=>Nt.default.createElement("div",{key:z,className:"drc-reflection-item"},Nt.default.createElement("label",null,z),Nt.default.createElement("textarea",{value:I,onChange:A=>f(z,A.target.value),placeholder:"Your answer..."})))),k=async(z,I)=>{d({[z]:I})},T=()=>Nt.default.createElement("div",{className:"drc-note-grades",style:{display:"flex",justifyContent:"space-evenly",width:"100%"}},Nt.default.createElement("div",{className:"drc-note-grade",style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"}},Nt.default.createElement("span",{className:"drc-note-grade-label"},"Mental Game:"),Nt.default.createElement("div",{className:"drc-note-grade-dropdown",style:{display:"flex",justifyContent:"center"}},Nt.default.createElement("select",{value:c.mentalGrade||"C",onChange:z=>{k("mentalGrade",z.target.value)},className:`drc-note-grade-value grade-${(c.mentalGrade||"C").toLowerCase()}`,"aria-label":"Mental Game Grade"},Nt.default.createElement("option",{value:"A"},"A"),Nt.default.createElement("option",{value:"B"},"B"),Nt.default.createElement("option",{value:"C"},"C")))),Nt.default.createElement("div",{className:"drc-note-grade",style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"}},Nt.default.createElement("span",{className:"drc-note-grade-label"},"Technical Game:"),Nt.default.createElement("div",{className:"drc-note-grade-dropdown",style:{display:"flex",justifyContent:"center"}},Nt.default.createElement("select",{value:c.technicalGrade||"C",onChange:z=>{k("technicalGrade",z.target.value)},className:`drc-note-grade-value grade-${(c.technicalGrade||"C").toLowerCase()}`,"aria-label":"Technical Game Grade"},Nt.default.createElement("option",{value:"A"},"A"),Nt.default.createElement("option",{value:"B"},"B"),Nt.default.createElement("option",{value:"C"},"C")))));return Nt.default.createElement("div",{className:"drc-note-review-tab"},((P=c.endOfDayReview)==null?void 0:P.images)&&c.endOfDayReview.images.length>0&&Nt.default.createElement("div",{className:"drc-section"},Nt.default.createElement("h3",null,"End of Day Review"),Nt.default.createElement("div",{className:"drc-eod-images"},Nt.default.createElement(Mu,{images:c.endOfDayReview.images,altPrefix:"End of Day Review",showThumbnails:!0,showCounter:!0,enableDelete:!0,onDeleteImage:(z,I)=>y(z,I),enableFullscreen:!0}))),Nt.default.createElement("div",{className:"drc-section"},Nt.default.createElement("h3",null,"Performance Grades"),T()),Nt.default.createElement("div",{className:"drc-section"},Nt.default.createElement(nde,{frontmatter:e,updateFrontmatter:t,trades:r,openNote:n,plugin:o})),Nt.default.createElement("div",{className:"drc-section"},Nt.default.createElement("h3",null,"Reflection Questions"),S()),Nt.default.createElement("div",{className:"drc-section"},Nt.default.createElement("h3",null,"Goals for Next Session"),Nt.default.createElement("button",{className:"drc-add-button",onClick:u},"Add Goal"),Nt.default.createElement("div",{className:"drc-goals"},w())),Nt.default.createElement("div",{className:"drc-section"},Nt.default.createElement("h3",null,"End of Day Screenshots"),Nt.default.createElement(cm,{onImageUploaded:z=>v(z),onMultipleImagesUploaded:z=>h(z),label:"Add screenshots",enableDragDrop:!0,saveImageFunction:b,multiple:!0,className:"drc-eod-image-uploader",enablePaste:!0})),Nt.default.createElement("div",{className:"drc-section drc-eod-review-button-section"},Nt.default.createElement(Dd,{reviewed:(D=c.endOfDayReview)==null?void 0:D.reviewed,reviewedAt:(O=c.endOfDayReview)==null?void 0:O.reviewedAt,onMarkReviewed:x})))}});var Br,lde,cde=L(()=>{Br=q(Y());Au();ba();Av();Zce();tde();sde();Ed();kv();qw();Yw();wt();lde=Br.default.memo(({data:e,trades:t=[],filePath:r,openNote:n,plugin:o})=>{let a="DRCNote",i=vv(a,"general"),[s,l]=(0,Br.useState)(e.previousDayGoals||null),[c,d]=(0,Br.useState)([]),[u,p]=(0,Br.useState)([]),[m,f]=(0,Br.useState)([]),[g,v]=(0,Br.useState)([]),h=(0,Br.useRef)(null),[y,b]=(0,Br.useState)(r||"unknown"),x=(0,Br.useRef)(!1),w=(0,Br.useRef)(null),{service:S}=jq(),k=Br.default.useCallback(N=>{let B=new Set;return N.forEach(C=>{C.account&&(Array.isArray(C.account)?C.account.forEach(F=>B.add(F)):B.add(C.account)),C.accountIds&&(Array.isArray(C.accountIds)?C.accountIds.forEach(F=>B.add(F)):B.add(C.accountIds))}),Array.from(B).sort()},[]);Br.default.useEffect(()=>{(async()=>{try{let C=k(t);v(C),f(F=>F.filter(M=>C.includes(M)))}catch(B){console.error("Error loading accounts:",B);let C=k(t);v(C),f(F=>F.filter(M=>C.includes(M)))}})()},[t,k]);let T=Br.default.useMemo(()=>m.length===0?t:t.filter(N=>{let B=C=>C?Array.isArray(C)?C.some(F=>m.includes(F)):typeof C=="string"?m.includes(C):!1:!1;return B(N.account)||B(N.accountIds)}),[t,m]),P=Br.default.useMemo(()=>HH(e),[e]),[D,O]=(0,Br.useState)(Mt(P.date)||new Date);(0,Br.useEffect)(()=>{try{if(h.current&&!r){let N=h.current.getAttribute("data-displaying-file");if(N){b(N);return}let B=h.current.parentElement;for(;B;){let C=B.getAttribute("data-displaying-file")||B.getAttribute("data-file-path");if(C){b(C);break}B=B.parentElement}}}catch(N){i(N,"Error finding file path")}},[r]),(0,Br.useEffect)(()=>{if(P.date){let N=Mt(P.date);N&&O(N)}},[P.date]),(0,Br.useEffect)(()=>{let N=async()=>{try{if(S){let B=Mt(P.date);if(!B)return;let C=await S.getPreviousDayGoals(B);l(C)}}catch(B){Dl({message:"Error fetching previous day goals",error:B,component:a,operation:"fetchPreviousDayGoals",severity:"warning"})}};!x.current&&P.date&&!s&&(N(),x.current=!0)},[P.date,S,s]),(0,Br.useEffect)(()=>{let N=B=>{var C;((C=B.detail)==null?void 0:C.path)===y&&(async()=>{try{if(S&&P.date){let M=Mt(P.date);if(!M){console.error("Invalid DRC date");return}let _=await S.getPreviousDayGoals(M);l(_)}}catch(M){console.error("Error fetching updated goals:",M)}})()};return document.addEventListener("drc-updated",N),()=>{document.removeEventListener("drc-updated",N)}},[y,S,P.date]),(0,Br.useEffect)(()=>{var N,B;try{let C=o||((B=(N=window.app)==null?void 0:N.plugins)==null?void 0:B.plugins.journalit);w.current=C==null?void 0:C.optionsService,(()=>{try{if(w.current){let _=w.current.getOptions("instrument"),W=w.current.getOptions("setup");d([..._]),p([...W])}}catch(_){Dl({message:"Failed to load options",error:_,component:a,operation:"loadOptions",severity:"warning"}),d([]),p([])}})();let M=()=>{setTimeout(()=>{try{if(w.current){let _=w.current.getOptions("instrument"),W=w.current.getOptions("setup");JSON.stringify(_)!==JSON.stringify(c)&&d(_),JSON.stringify(W)!==JSON.stringify(u)&&p(W)}}catch(_){Dl({message:"Error updating options",error:_,component:a,operation:"handleOptionsChanged",severity:"warning"})}},300)};return document.addEventListener("journalit-options-changed",M,{capture:!1}),()=>{document.removeEventListener("journalit-options-changed",M,{capture:!1})}}catch(C){Dl({message:"Failed to set up options listeners",error:C,component:a,operation:"setupOptionsListeners",severity:"warning"}),d([]),p([])}},[]);let z=async N=>{var B,C;try{let F=o||((C=(B=window.app)==null?void 0:B.plugins)==null?void 0:C.plugins.journalit),M=F==null?void 0:F.optionsService;M&&await M.addOption("instrument",N)&&M.notifyOptionsChanged()}catch(F){Dl({message:"Failed to save custom instrument option",error:F,component:a,operation:"handleSaveInstrument",severity:"warning"})}},I=async N=>{var B,C;try{let F=o||((C=(B=window.app)==null?void 0:B.plugins)==null?void 0:C.plugins.journalit),M=F==null?void 0:F.optionsService;M&&await M.addOption("setup",N)&&M.notifyOptionsChanged()}catch(F){Dl({message:"Failed to save custom setup option",error:F,component:a,operation:"handleSaveSetup",severity:"warning"})}};(0,Br.useEffect)(()=>{var _;h.current&&(h.current.classList.add("drc-note-mounted"),h.current.setAttribute("data-mounted-at",Date.now().toString()));let N=(_=h.current)==null?void 0:_.closest(".journalit-drc-view");N&&N.classList.add("drc-note-mounted"),RO(),yC(),Sd();let B="drc-critical-navigation-styles";if(!document.getElementById(B)){let W=document.createElement("style");W.id=B,W.innerHTML=`
        /* Critical styles for DRC P&L display - ensuring it displays properly */
        html body .drc-container .drc-stats .drc-stat-card .drc-stat-value,
        body .drc-container .drc-stats .drc-stat-card .drc-stat-value,
        .workspace-leaf .drc-container .drc-stats .drc-stat-card .drc-stat-value {
          white-space: nowrap !important;
          overflow: hidden !important;
          text-overflow: ellipsis !important;
          width: 100% !important;
          display: block !important;
        }
        
        html body .drc-container .drc-stats .drc-stat-card,
        body .drc-container .drc-stats .drc-stat-card,
        .workspace-leaf .drc-container .drc-stats .drc-stat-card {
          min-width: 0 !important;
          overflow: hidden !important;
        }
        
        /* Stats card for P&L specifically */
        html body .drc-container .drc-stats .drc-stat-card:nth-child(4),
        body .drc-container .drc-stats .drc-stat-card:nth-child(4),
        .workspace-leaf .drc-container .drc-stats .drc-stat-card:nth-child(4) {
          overflow: hidden !important;
          min-width: 140px !important;
        }
        
        /* Critical styles for DRC navigation - highest specificity possible */
        html body .drc-container .drc-header .drc-navigation,
        body .drc-container .drc-header .drc-navigation,
        .workspace-leaf .drc-container .drc-header .drc-navigation {
          width: 100% !important;
          padding-top: 10px !important;
          border-top: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1)) !important;
        }
        
        html body .drc-container .drc-header .drc-navigation .drc-navigation-links,
        body .drc-container .drc-header .drc-navigation .drc-navigation-links,
        .workspace-leaf .drc-container .drc-header .drc-navigation .drc-navigation-links {
          display: flex !important;
          justify-content: space-between !important;
          align-items: center !important;
          gap: 8px !important;
          flex-wrap: wrap !important;
          width: 100% !important;
        }
        
        html body .drc-container .drc-header .drc-navigation .drc-navigation-links .drc-nav-button,
        body .drc-container .drc-header .drc-navigation .drc-navigation-links .drc-nav-button,
        .workspace-leaf .drc-container .drc-header .drc-navigation .drc-navigation-links .drc-nav-button {
          padding: 8px 14px !important;
          border: 1px solid var(--background-modifier-border) !important;
          border-radius: 4px !important;
          background-color: var(--background-primary) !important;
          color: var(--text-normal) !important;
          cursor: pointer !important;
          font-size: 14px !important;
          transition: all 0.2s !important;
          display: flex !important;
          align-items: center !important;
          justify-content: center !important;
          gap: 6px !important;
          flex: 1 !important;
          text-align: center !important;
          min-width: 120px !important;
          box-sizing: border-box !important;
          max-width: none !important;
          margin: 0 !important;
        }
        
        /* Ensure proper icon spacing */
        html body .drc-container .drc-header .drc-navigation .drc-nav-button .nav-icon,
        body .drc-container .drc-header .drc-navigation .drc-nav-button .nav-icon {
          font-size: 16px !important;
          line-height: 1 !important;
        }
      `,document.head.appendChild(W)}if(!document.getElementById("fix-grade-display")){let W=document.createElement("style");W.id="fix-grade-display",W.textContent=`
        /* Performance Grade Containers Layout Fix */
        .drc-note-grades {
          display: flex !important;
          flex-direction: row !important;
          justify-content: space-evenly !important;
          gap: 16px !important;
          margin-bottom: 24px !important;
          width: 100% !important;
        }
        
        .drc-note-grade {
          display: flex !important;
          flex-direction: column !important;
          align-items: center !important;
          text-align: center !important;
          flex: 1 !important;
          padding: 16px !important;
          background-color: var(--background-primary) !important;
          border-radius: var(--border-radius-md, 4px) !important;
          border: 1px solid var(--background-modifier-border) !important;
        }
        
        /* Center label text */
        .drc-note-grade-label {
          text-align: center !important;
          width: 100% !important;
          margin-bottom: 12px !important;
        }
        
        /* Center dropdown in container */
        .drc-note-grade-dropdown {
          display: flex !important;
          justify-content: center !important;
          width: 100% !important;
        }

        /* Fix for grade display text cutoff and perfect centering */
        .drc-note-grade-value, 
        select.drc-note-grade-value {
          overflow: visible !important;
          min-height: 60px !important;
          min-width: 60px !important;
          width: 60px !important;
          height: 60px !important;
          max-width: 60px !important;
          max-height: 60px !important;
          padding: 0 !important; /* Remove all padding */
          font-size: 22px !important; /* Larger font */
          line-height: 1 !important; /* Critical for vertical centering */
          text-rendering: optimizeLegibility !important;
          -webkit-font-smoothing: antialiased !important;
          text-align: center !important;
          display: flex !important;
          align-items: center !important;
          justify-content: center !important;
          border-radius: 50% !important; /* Make it a circle */
          aspect-ratio: 1 / 1 !important; /* Keep it as a perfect circle */
          margin: 0 auto !important; /* Center horizontally */
          margin-top: 8px !important; /* Add some space from the label */
          border: none !important;
          -webkit-appearance: none !important;
          -moz-appearance: none !important;
          appearance: none !important;
        }
        
        /* Center text within the grade circle */
        .drc-note-grade-value,
        select.drc-note-grade-value,
        .drc-note-grade-dropdown select {
          text-align: center !important;
        }
        
        /* Prevent browser's default tooltip (the grey one) */
        .drc-note-grade-dropdown select:hover::before,
        .drc-note-grade-dropdown select::before {
          content: none !important;
          display: none !important;
        }
        
        /* Style the black tooltip */
        .tooltip {
          background-color: var(--background-primary-alt) !important;
          color: var(--text-on-accent) !important;
          padding: 5px 10px !important;
          border-radius: 4px !important;
          font-size: 12px !important;
          z-index: 9999 !important;
        }
        
        /* Enhanced dropdown arrow positioning */
        .drc-note-grade-dropdown::after {
          right: 50% !important;
          transform: translateX(10px) translateY(-10px) !important;
          bottom: 10px !important;
          top: auto !important;
        }
        
        /* Hide default dropdown arrow */
        .drc-note-grade-dropdown select::-ms-expand {
          display: none !important;
        }
        
        .drc-note-grade-dropdown select {
          -webkit-appearance: none !important;
          -moz-appearance: none !important;
          appearance: none !important;
        }
        
        /* Modify the grade colors - A is green, B is orange, C is red */
        .drc-note-grade-value.grade-a {
          background-color: rgba(102, 187, 106, 0.3) !important;
          color: var(--grade-a-color) !important; /* Darker green for better visibility */
        }

        .drc-note-grade-value.grade-b {
          background-color: rgba(255, 152, 0, 0.3) !important;
          color: var(--grade-b-color) !important; /* Darker orange for better visibility */
        }

        .drc-note-grade-value.grade-c {
          background-color: rgba(229, 57, 53, 0.3) !important;
          color: var(--grade-c-color) !important; /* Darker red for better visibility */
        }
      `,document.head.appendChild(W)}let F=document.getElementById("grade-tooltip-script");F&&F.remove();let M=document.getElementById("grade-tooltip");return M&&M.remove(),()=>{let W=document.getElementById("drc-critical-navigation-styles");W&&W.remove()}},[y]),(0,Br.useEffect)(()=>{let N=()=>{var B,C,F;try{let M=o||((C=(B=window.app)==null?void 0:B.plugins)==null?void 0:C.plugins.journalit);if(!((F=M==null?void 0:M.settings)!=null&&F.drc))return}catch(M){console.error("Error handling settings update:",M)}};return document.addEventListener("journalit-settings-updated",N),()=>document.removeEventListener("journalit-settings-updated",N)},[]);let A=[{id:"prepare",label:"Preparation",content:({data:N,updateData:B})=>Br.default.createElement(Qce,{frontmatter:N,updateFrontmatter:B,previousDayGoals:s,trades:T,openNote:n||(C=>{}),plugin:o})},{id:"trades",label:"Trades",count:T.length,content:({data:N,updateData:B})=>Br.default.createElement(ede,{frontmatter:N,trades:T,updateFrontmatter:B,openNote:n||(C=>{}),plugin:o,selectedAccounts:m,availableAccounts:g,onAccountFilterChange:f})},{id:"review",label:"Review",content:({data:N,updateData:B})=>Br.default.createElement(ide,{frontmatter:N,trades:T,updateFrontmatter:B,openNote:n||(C=>{}),plugin:o,instrumentOptions:c,setupOptions:u,onSaveInstrument:z,onSaveSetup:I})}],j=D.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}),E={currentDate:D,getAdjacentReview:async N=>{try{if(S)return await S.getAdjacentDRC(D,N)}catch(B){i(B,"Error getting adjacent DRC")}return null},getRelatedReviewPaths:{weekly:N=>{var B,C;try{let F=o||((C=(B=window.app)==null?void 0:B.plugins)==null?void 0:C.plugins.journalit);if(F!=null&&F.weeklyReviewService)return F.weeklyReviewService.getWeeklyReviewPath(N);if(F!=null&&F.drcService)return F.drcService.getWeeklyReviewPath(N)}catch(F){i(F,"Error getting weekly review path")}return""},monthly:N=>{var B,C;try{let F=o||((C=(B=window.app)==null?void 0:B.plugins)==null?void 0:C.plugins.journalit);if(F!=null&&F.monthlyReviewService)return F.monthlyReviewService.getMonthlyReviewPath(N);if(F!=null&&F.drcService)return F.drcService.getMonthlyReviewPath(N)}catch(F){i(F,"Error getting monthly review path")}return""}}};return Br.default.createElement("div",{className:"drc-container",ref:h,"data-file-path":y,style:{margin:0}},Br.default.createElement(Yv,{data:P,filePath:y,openNote:n,plugin:o,serviceName:"drcService",componentName:"Daily Report Card",reviewType:P.type,navigationOptions:E,tabConfig:A,updateMethodName:"updateDRCFrontmatter",className:{container:"drc-content",header:{container:"drc-header",title:"drc-title",dateContainer:"drc-date-container"},tabContainer:{container:"drc-tabs-container",tabList:"drc-tabs",tab:"drc-tab",activeTab:"active"}}}))})});var dde,IL,ude=L(()=>{dde=q(Y());cde();Nb();mL();wt();IL=class extends rc{constructor(t){super(t)}async renderComponent(t,r,n,o,a){if(!t||!t.isConnected){console.error(`[DRCNote] Cannot render into disconnected container for ${n}`);return}t.querySelector(".drc-container")||await this.renderDRCNote(t,r,n,o,a)}async renderDRCNote(t,r,n,o,a){var i,s;try{if(!t||!t.isConnected)return;let l=a?`${n}-${o}-${a}`:`${n}-${o}`,c=this.reactRoots.get(l);if(c&&c.domContainer&&c.domContainer.isConnected&&c.domContainer.querySelector(".drc-container")||t.querySelector(".drc-container"))return;this.injectDropdownStyles(t);let u=(s=(i=window.app)==null?void 0:i.plugins)==null?void 0:s.plugins.journalit,p=this.findContainingLeaf(t),m;if(p&&p.view){let h=p.view.containerEl;h&&h.id&&(m=h.id)}let f=await this.fetchTradesForDRC(r);t.setAttribute("data-displaying-file",n),t.setAttribute("data-rendered-at",Date.now().toString()),t.setAttribute("data-renderer-id",`${n}-${o}-${Date.now()}`),t.setAttribute("data-debug-version","1.0.0");let g={...r};["plugin","app","_"].forEach(h=>{h in g&&delete g[h]});let v={...g,trades:f};this.createReactRoot(t,l,m,a,v,n)}catch(l){console.error("[DRCNote] Error rendering DRC note:",l),t.setText("Error rendering DRC note: "+(l instanceof Error?l.message:String(l)))}}getComponentClassName(){return"journalit-drc-view"}getWrapperClassName(){return"journalit-drc-note-wrapper"}createReactElement(t,r,n){var a,i;let o=(i=(a=window.app)==null?void 0:a.plugins)==null?void 0:i.plugins.journalit;return dde.default.createElement(lde,{data:t,trades:t.trades||[],filePath:r,openNote:n,plugin:o})}injectDropdownStyles(t){let r=t.id;if(r||(r=`drc-container-${Date.now()}-${Math.floor(Math.random()*1e3)}`,t.id=r),!document.getElementById("drc-critical-dropdown-styles")){let n=document.createElement("style");n.id="drc-critical-dropdown-styles",n.textContent=`
                /* Critical ComboBox styling for DRC dropdowns - with highest specificity */
                .drc-container .combobox-container,
                .drc-container [data-combobox-type],
                .drc-missed-trade .combobox-container,
                .drc-missed-trade .drc-input-group.field .combobox-container,
                #${r} .combobox-container,
                #${r} [data-combobox-type] {
                    position: relative !important;
                    width: 100% !important;
                    margin-bottom: 8px !important;
                    z-index: 10 !important;
                }
                
                /* Increased z-index when dropdown is open */
                .drc-container .combobox-container[data-is-open="true"],
                .drc-container [data-combobox-type][data-is-open="true"],
                .drc-missed-trade .combobox-container[data-is-open="true"],
                .drc-missed-trade .drc-input-group.field .combobox-container[data-is-open="true"],
                #${r} .combobox-container[data-is-open="true"],
                #${r} [data-combobox-type][data-is-open="true"] {
                    z-index: 9999 !important;
                }
                
                /* Force dropdown list to be visible at all times */
                .drc-container .combobox-container[data-is-open="true"] ul[role="listbox"],
                .drc-container [data-combobox-type][data-is-open="true"] ul[role="listbox"],
                .drc-missed-trade .combobox-container[data-is-open="true"] ul[role="listbox"],
                .drc-missed-trade .drc-input-group.field .combobox-container[data-is-open="true"] ul[role="listbox"],
                #${r} .combobox-container[data-is-open="true"] ul[role="listbox"],
                #${r} [data-combobox-type][data-is-open="true"] ul[role="listbox"] {
                    display: block !important;
                    visibility: visible !important;
                    opacity: 1 !important;
                    position: absolute !important;
                    top: 34px !important; /* Position closer to input */
                    left: 0 !important;
                    right: 0 !important;
                    max-height: 200px !important;
                    overflow-y: auto !important;
                    background-color: var(--background-primary) !important;
                    border: 1px solid var(--background-modifier-border) !important;
                    border-top: none !important; /* Remove top border for seamless connection */
                    border-radius: 0 0 4px 4px !important; /* Only round bottom corners */
                    margin-top: -1px !important; /* Negative margin to pull up and overlap with input border */
                    z-index: 9999 !important;
                    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
                }
                
                /* Style dropdown list items */
                .drc-container [data-combobox-type] ul[role="listbox"] li,
                .drc-missed-trade .combobox-container ul[role="listbox"] li,
                #${r} [data-combobox-type] ul[role="listbox"] li,
                #${r} .combobox-container ul[role="listbox"] li {
                    padding: 8px 12px !important;
                    cursor: pointer !important;
                    transition: background-color 150ms ease !important;
                    margin: 0 !important;
                    background-color: var(--background-primary) !important;
                    color: var(--text-normal) !important;
                    font-size: 14px !important;
                    line-height: 1.5 !important;
                    border-bottom: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1)) !important;
                }
                
                /* Hover state for dropdown items */
                .drc-container [data-combobox-type] ul[role="listbox"] li:hover,
                .drc-missed-trade .combobox-container ul[role="listbox"] li:hover,
                #${r} [data-combobox-type] ul[role="listbox"] li:hover,
                #${r} .combobox-container ul[role="listbox"] li:hover {
                    background-color: var(--background-secondary) !important;
                }
                
                /* Dropdown arrow styling */
                .drc-container [data-combobox-type] .input-container::after,
                .drc-missed-trade .combobox-container .input-container::after,
                #${r} [data-combobox-type] .input-container::after,
                #${r} .combobox-container .input-container::after {
                    content: "" !important;
                    position: absolute !important;
                    right: 12px !important;
                    top: 50% !important;
                    transform: translateY(-50%) !important;
                    width: 0 !important;
                    height: 0 !important;
                    border-left: 5px solid transparent !important;
                    border-right: 5px solid transparent !important;
                    border-top: 5px solid var(--text-normal) !important;
                    pointer-events: none !important;
                    z-index: 10 !important;
                }
                
                /* Input padding for dropdown arrow */
                .drc-container [data-combobox-type] input[role="combobox"],
                .drc-missed-trade .combobox-container input[role="combobox"],
                #${r} [data-combobox-type] input[role="combobox"],
                #${r} .combobox-container input[role="combobox"] {
                    padding-right: 30px !important;
                }
            `,document.head.appendChild(n)}return r}async fetchTradesForDRC(t){var r,n,o;try{if(!t.date)return[];let a=(n=(r=window.app)==null?void 0:r.plugins)==null?void 0:n.plugins.journalit;if(!a||!a.drcService)return console.error("[DRCNote] Cannot access plugin or DRC service"),[];let i=Mt(t.date);if(!i)return console.error("Invalid date in DRC frontmatter:",t.date),[];let s=await a.drcService.getTradesForDate(i),l=[];for(let c of s)try{let d=(o=this.app.metadataCache.getFileCache(c))==null?void 0:o.frontmatter;if(!d||d.type!=="trade"&&d.type!=="backtest-trade")continue;let u={id:c.path,instrument:d.instrument||"Unknown",direction:d.direction||"Unknown",entryPrice:parseFloat(d.entryPrice)||0,exitPrice:parseFloat(d.exitPrice)||0,positionSize:parseFloat(d.positionSize)||0,pnl:d.pnl!==void 0?parseFloat(d.pnl):void 0,entryTime:d.entryTime?new Date(d.entryTime):new Date,exitTime:d.exitTime?new Date(d.exitTime):void 0,path:c.path,setup:d.setup,images:d.images,assetType:d.assetType,optionType:d.optionType,account:Array.isArray(d.account)?d.account:d.account?[d.account]:[],accountIds:Array.isArray(d.accountIds)?d.accountIds:d.accountIds?[d.accountIds]:[],exits:d.exits,entries:d.entries,...hh(d)};l.push(u)}catch(d){console.error(`[DRCNote] Error processing trade file ${c.path}:`,d)}return l}catch(a){return console.error("[DRCNote] Error fetching trades:",a),[]}}unmountDRCNote(t,r,n,o){return this.unmountComponent(t,r,n,o)}unmountAllDRCNotes(){this.unmountAllComponents()}unmountLeafDRCNotes(t){this.unmountLeafComponents(t)}}});var pde,AL,mde=L(()=>{pde=require("obsidian");ude();Bb();HA();AL=class extends nc{constructor(r,n){super(r,n,new IL(r));this.observerTimeouts=new Map}isValidComponentType(r){return r&&r.type==="drc"}getComponentClassName(){return"journalit-drc-view"}getWrapperClassName(){return"journalit-drc-note-wrapper"}getComponentTypeIdentifier(){return"drc"}async getAdditionalDataForComponent(r,n){return{}}disconnectObserverSafely(r){let n=this.observerTimeouts.get(r);n&&(clearTimeout(n),this.observerTimeouts.delete(r)),r.disconnect();let o=this.activeObservers.indexOf(r);o>-1&&this.activeObservers.splice(o,1)}async handleFileOpen(r,n=!1){if(!r)return;this.cleanupOrphanedComponents(),this.cleanupUnrelatedComponents(r.path);let o=this.app.metadataCache.getFileCache(r),a=o==null?void 0:o.frontmatter;if(!a||!this.isValidComponentType(a))return;if(this.hasProperlyRenderedComponents(r.path,this.getComponentClassName(),".drc-container","drc-note-mounted")){this.markFileRenderedInMode(r.path,"source");return}if(this.cleanupDuplicateComponents(r.path),n){let c=`rendered-drc-${r.path}-${Date.now()}`;if(window[c]=!1,Date.now()-(window.__obsidianStartTime||0)<5e3){setTimeout(()=>{this.tryRenderActiveDRC(r,c)},500),setTimeout(()=>{window[c]||this.tryRenderActiveDRC(r,c)},1500),setTimeout(()=>{window[c]||this.tryRenderActiveDRC(r,c),delete window[c]},3e3),setTimeout(()=>{this.renderActiveComponent()},5e3);return}setTimeout(()=>{window[c]||this.tryRenderActiveDRC(r,c),delete window[c]},500);return}let i=document.body,s=new MutationObserver((c,d)=>{let u=document.querySelectorAll(".cm-editor");if(u.length===0)return;if(this.isFileRenderedInMode(r.path,"source")){if(document.querySelectorAll(`.${this.getComponentClassName()}[data-file-path="${r.path}"]`).length>0)return;this.clearFileRenderedStatus(r.path,"source")}u.forEach(m=>{var I;let f=m.querySelector(".metadata-container");if(!f)return;let g=f.closest(".workspace-leaf-content");if(!g)return;let v=this.findContainingLeaf(g),h=(I=v==null?void 0:v.view)==null?void 0:I.containerEl,y=f.closest(".workspace-leaf"),x=(y==null?void 0:y.id)||(h==null?void 0:h.id)||null,w=this.getUniqueElementId(m),S=x?`leaf-${x}`:w,k=!0;if(v){let A=v.view,j=null;(A&&"file"in A||A&&"getViewType"in A&&A.getViewType()==="markdown")&&(j=A.file),j&&(k=j.path===r.path)}if(!k)return;let T=this.getComponentClassName();m.querySelectorAll(`.${T}`).forEach(A=>{let j=A.getAttribute("data-file-path");if(j){let E=A.getAttribute("data-view-id"),N=A.getAttribute("data-leaf-id");E&&this.renderer.unmountComponent(j,E,N||void 0),A.remove()}});let P=this.getWrapperClassName(),D=m.querySelectorAll(`.${P}`),O=Array.from(D).some(A=>{var j;return(j=A.querySelector(".drc-container"))==null?void 0:j.classList.contains("drc-note-mounted")});if(D.length>0||O)return;let z=Array.from(m.querySelectorAll(`.${T}`)).find(A=>A.getAttribute("data-file-path")===r.path);z||(z=document.createElement("div"),z.className=T,z.classList.add("journalit-component-container"),z.setAttribute("data-file-path",r.path),z.setAttribute("data-view-id",S),z.setAttribute("data-editor-id",w),x&&z.setAttribute("data-leaf-id",x),z.setAttribute("data-inserted-at",Date.now().toString()),z.setAttribute("data-created-at",Date.now().toString()),f.after(z)),this.renderDRCNoteWithDeduplication(r,z,a,S,w)}),d.disconnect();let p=this.activeObservers.indexOf(d);p>-1&&this.activeObservers.splice(p,1)});this.activeObservers.push(s),s.observe(i,{childList:!0,subtree:!0});let l=setTimeout(()=>{this.disconnectObserverSafely(s)},5e3);this.observerTimeouts.set(s,l)}renderActiveComponent(){this.renderActiveDRCNote()}async tryRenderActiveDRC(r,n){try{let o=this.app.metadataCache.getFileCache(r),a=o==null?void 0:o.frontmatter;if(!a||!this.isValidComponentType(a))return;if(this.hasProperlyRenderedComponents(r.path,this.getComponentClassName(),".drc-container","drc-note-mounted")){window[n]=!0;return}this.cleanupDuplicateComponents(r.path),this.renderActiveComponent(),window[n]=!0}catch(o){console.error("[DRC] Error in tryRenderActiveDRC:",o)}}renderDRCNoteWithDeduplication(r,n,o,a,i){this.cleanupDuplicateComponents(r.path);let s=this.renderWithDeduplication({file:r,container:n,data:o,viewId:a,contextId:i,componentClassName:this.getComponentClassName(),mountedClassName:"drc-note-mounted",contentSelector:".drc-container"})}cleanup(){for(let[r,n]of this.observerTimeouts)clearTimeout(n);this.observerTimeouts.clear(),super.cleanup()}renderActiveDRCNote(){this.cleanupOrphanedComponents();let r=this.app.workspace.getActiveFile();if(!r)return;let n=this.app.metadataCache.getFileCache(r),o=n==null?void 0:n.frontmatter;if(!o||o.type!=="drc")return;let a=this.app.workspace.getActiveViewOfType(pde.MarkdownView);if(!a)return;let i=kS(a)?a.getMode()==="source":!1,s=null;if(i){let l=a.containerEl.querySelector(".metadata-container");if(!l)return;let c=Array.from(a.containerEl.querySelectorAll(`.${this.getComponentClassName()}`)).find(d=>d.getAttribute("data-file-path")===r.path);c?s=c:(s=document.createElement("div"),s.className=this.getComponentClassName(),s.classList.add("journalit-component-container"),s.setAttribute("data-file-path",r.path),l.after(s))}else{let l=a.containerEl.querySelector(".markdown-preview-view");if(!l)return;let c=Array.from(l.querySelectorAll(`.${this.getComponentClassName()}`)).find(d=>d.getAttribute("data-file-path")===r.path);c?s=c:(s=document.createElement("div"),s.className=this.getComponentClassName(),s.classList.add("journalit-component-container"),s.setAttribute("data-file-path",r.path),l.prepend(s))}if(s){let l=`drc-active-${Date.now()}`;s.setAttribute("data-view-id",l),this.renderDRCNoteWithDeduplication(r,s,o,l)}}}});var Dt,fde,zS,gde,hde=L(()=>{Dt=q(Y());_w();pt();Ra();fde=require("obsidian");pg();eo();Ed();wt();zS=e=>e==="monthly"||e==="weekly"||e==="daily",gde=({data:e,updateData:t,previousWeekGoals:r})=>{let n=xe(),[o,a]=(0,Dt.useState)(""),[i,s]=(0,Dt.useState)(""),[l,c]=(0,Dt.useState)("gray"),[d,u]=(0,Dt.useState)(""),p=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],[m,f]=(0,Dt.useState)([]);Dt.default.useEffect(()=>{try{if(n!=null&&n.optionsService){let j=n.optionsService.getOptions("event")||[];f(j)}}catch(j){Ae.error("Failed to load event options:",j)}},[n]),Dt.default.useEffect(()=>{if(o&&(n!=null&&n.optionsService)){let j=n.optionsService.getEventOptionByName(o);j&&j.color?c(j.color):c("gray")}else c("gray")},[o,n]);let g=async j=>{try{if(n!=null&&n.optionsService){await n.optionsService.addOrUpdateEventOption(j,l);let E=n.optionsService.getOptions("event")||[];f(E)}}catch(E){Ae.error("Failed to save event option:",E)}},v=async j=>{let N={...e.previousGoalStatus||{}},B=`goal_${j}`,C=N[B]||!1;N[B]=!N[B],t({previousGoalStatus:N})},h=async()=>{if(!o)return;n!=null&&n.optionsService&&n.optionsService.addOrUpdateEventOption(o,l);let j=[...e.keyEvents||[]];j.push({event:o,notes:i,color:l,day:d||void 0}),t({keyEvents:j}),a(""),s(""),c("gray"),u("")},y=j=>{let E=[...e.keyEvents||[]];E.splice(j,1),t({keyEvents:E})},b=()=>{var j,E;try{return((E=(j=n==null?void 0:n.settings)==null?void 0:j.weekly)==null?void 0:E.customTimeframes)||["Monthly","Weekly","Daily"]}catch(N){return Ae.error("Error getting timeframes:",N),["Monthly","Weekly","Daily"]}};(0,Dt.useEffect)(()=>{let j=E=>{var N;((N=E.detail)==null?void 0:N.component)==="weekly"&&(S.current=w())};return document.addEventListener("journalit-settings-updated",j),()=>{document.removeEventListener("journalit-settings-updated",j)}},[]);let x=async(j,E,N,B=!1)=>{var M,_,W,$,H,R;let C={...e.forecast||{monthly:{notes:""},weekly:{notes:""},daily:{notes:""},customTimeframes:{}}},F={monthly:{notes:((M=C.monthly)==null?void 0:M.notes)||"",images:Array.isArray((_=C.monthly)==null?void 0:_.images)?[...C.monthly.images]:[]},weekly:{notes:((W=C.weekly)==null?void 0:W.notes)||"",images:Array.isArray(($=C.weekly)==null?void 0:$.images)?[...C.weekly.images]:[]},daily:{notes:((H=C.daily)==null?void 0:H.notes)||"",images:Array.isArray((R=C.daily)==null?void 0:R.images)?[...C.daily.images]:[]},customTimeframes:{...C.customTimeframes||{}}};E==="notes"&&(B?(F.customTimeframes||(F.customTimeframes={}),F.customTimeframes[j]={...F.customTimeframes[j],notes:N}):zS(j)&&(F[j].notes=N)),t({forecast:F})},w=()=>{let j=b(),E=["monthly","weekly","daily"];return j.forEach(N=>{if(!["Monthly","Weekly","Daily"].includes(N)){let B=N.replace(/\s+/g,"_").toLowerCase();E.push(B)}}),E},S=(0,Dt.useRef)(w()),k=async(j,E,N=!1)=>{var B,C;try{let F=n||((C=(B=window.app)==null?void 0:B.plugins)==null?void 0:C.plugins.journalit);if(!(F!=null&&F.weeklyReviewService))throw new Error("Weekly Review Service not available");let M=Mt(e.date);if(!M)throw new fde.Notice("Invalid weekly review date. Cannot save forecast image."),new Error("Invalid date for image save");return await F.weeklyReviewService.saveWeeklyReviewImage(j,M,E)}catch(F){throw Ae.error(`Error uploading image for ${E}:`,F),F}},T=(j,E,N=!1)=>{var F,M,_,W,$,H,R;let B={...e.forecast||{monthly:{notes:""},weekly:{notes:""},daily:{notes:""},customTimeframes:{}}},C={monthly:{notes:((F=B.monthly)==null?void 0:F.notes)||"",images:Array.isArray((M=B.monthly)==null?void 0:M.images)?[...B.monthly.images]:[]},weekly:{notes:((_=B.weekly)==null?void 0:_.notes)||"",images:Array.isArray((W=B.weekly)==null?void 0:W.images)?[...B.weekly.images]:[]},daily:{notes:(($=B.daily)==null?void 0:$.notes)||"",images:Array.isArray((H=B.daily)==null?void 0:H.images)?[...B.daily.images]:[]},customTimeframes:{...B.customTimeframes||{}}};if(N){C.customTimeframes||(C.customTimeframes={});let V=Array.isArray((R=C.customTimeframes[j])==null?void 0:R.images)?[...C.customTimeframes[j].images]:[];if(V.includes(E))return;C.customTimeframes[j]={...C.customTimeframes[j],images:[...V,E]}}else if(zS(j)){let V=Array.isArray(C[j].images)?[...C[j].images]:[];if(V.includes(E))return;C[j].images=[...V,E]}t({forecast:C})},P=(j,E,N=!1)=>{var F,M,_,W,$,H,R;let B={...e.forecast||{monthly:{notes:""},weekly:{notes:""},daily:{notes:""},customTimeframes:{}}},C={monthly:{notes:((F=B.monthly)==null?void 0:F.notes)||"",images:Array.isArray((M=B.monthly)==null?void 0:M.images)?[...B.monthly.images]:[]},weekly:{notes:((_=B.weekly)==null?void 0:_.notes)||"",images:Array.isArray((W=B.weekly)==null?void 0:W.images)?[...B.weekly.images]:[]},daily:{notes:(($=B.daily)==null?void 0:$.notes)||"",images:Array.isArray((H=B.daily)==null?void 0:H.images)?[...B.daily.images]:[]},customTimeframes:{...B.customTimeframes||{}}};if(N){C.customTimeframes||(C.customTimeframes={});let V=Array.isArray((R=C.customTimeframes[j])==null?void 0:R.images)?[...C.customTimeframes[j].images]:[],Z=E.filter(K=>!V.includes(K));if(Z.length===0)return;C.customTimeframes[j]={...C.customTimeframes[j],images:[...V,...Z]}}else if(zS(j)){let V=Array.isArray(C[j].images)?[...C[j].images]:[],Z=E.filter(K=>!V.includes(K));if(Z.length===0)return;C[j].images=[...V,...Z]}t({forecast:C})},D=async(j,E,N,B=!1)=>{var C,F,M,_,W,$,H,R,V;try{let Z=n||((F=(C=window.app)==null?void 0:C.plugins)==null?void 0:F.plugins.journalit);if(!(Z!=null&&Z.weeklyReviewService))throw new Error("Weekly Review Service not available");await Z.weeklyReviewService.deleteImage(N);let K={...e.forecast||{monthly:{notes:""},weekly:{notes:""},daily:{notes:""},customTimeframes:{}}},X={monthly:{notes:((M=K.monthly)==null?void 0:M.notes)||"",images:Array.isArray((_=K.monthly)==null?void 0:_.images)?[...K.monthly.images]:[]},weekly:{notes:((W=K.weekly)==null?void 0:W.notes)||"",images:Array.isArray(($=K.weekly)==null?void 0:$.images)?[...K.weekly.images]:[]},daily:{notes:((H=K.daily)==null?void 0:H.notes)||"",images:Array.isArray((R=K.daily)==null?void 0:R.images)?[...K.daily.images]:[]},customTimeframes:{...K.customTimeframes||{}}};if(B){if((V=X.customTimeframes[j])!=null&&V.images){let G=[...X.customTimeframes[j].images];G.splice(E,1),X.customTimeframes[j]={...X.customTimeframes[j],images:G}}}else if(zS(j)){let G=[...X[j].images||[]];G.splice(E,1),X[j].images=G}t({forecast:X})}catch(Z){Ae.error("Error deleting image:",Z)}},O=j=>{var N;return((N=e.previousGoalStatus)==null?void 0:N[`goal_${j}`])||!1},z=(j,E=!1)=>({getSectionData:()=>{var B;let N=e.forecast||{monthly:{notes:""},weekly:{notes:""},daily:{notes:""},customTimeframes:{}};return E?((B=N.customTimeframes)==null?void 0:B[j])||{notes:"",images:[]}:zS(j)?N[j]||{notes:"",images:[]}:{notes:"",images:[]}},handleImageUpload:async N=>{T(j,N,E)},handleMultipleImagesUpload:async N=>{P(j,N,E)},handleNotesChange:async N=>{await x(j,"notes",N,E)},handleImageDelete:(N,B)=>{D(j,N,B,E)}}),I=(j,E,N=!1)=>{let B=z(j,N),C=B.getSectionData();return Dt.default.createElement(Y1,{key:j,sectionName:j,sectionTitle:E,notes:C.notes||"",images:C.images||[],onNotesChange:B.handleNotesChange,onImageUploaded:B.handleImageUpload,onMultipleImagesUploaded:B.handleMultipleImagesUpload,onImageDeleted:B.handleImageDelete,saveImageFunction:async F=>await k(F,j,N),isCustom:N,className:{container:"weekly-review-forecast-section",sectionTitle:"weekly-review-forecast-title",notesContainer:"weekly-review-forecast-notes",imageContainer:"weekly-review-image-container"}})},A=()=>{let j=b(),E={Monthly:"monthly",Weekly:"weekly",Daily:"daily"};return Dt.default.createElement("div",{className:"weekly-review-forecast-sections"},j.map(N=>{let B=N.replace(/\s+/g,"_").toLowerCase(),C=Object.keys(E).includes(N),F=C?E[N]:B;return I(F,N,!C)}))};return Dt.default.createElement("div",{className:"weekly-review-preparation"},Dt.default.createElement("div",{className:"weekly-review-section"},Dt.default.createElement(G1,{goals:r,goalStatus:e.previousGoalStatus||{},onToggleGoal:v,title:"Weekly Goals",emptyMessage:"No goals from previous week",emptyActionLabel:"",className:{container:"weekly-review-previous-goals",goalItem:"weekly-review-checklist-item",goalCheckbox:"weekly-review-checkbox",goalText:"weekly-review-goal-text",completed:"completed"}})),Dt.default.createElement("div",{className:"weekly-review-section"},Dt.default.createElement("h3",{className:"weekly-review-section-title"},"Key Events"),Dt.default.createElement("div",{className:"weekly-review-key-events"},Dt.default.createElement("div",{className:"weekly-review-event-selector"},Dt.default.createElement(li,{label:"Event",options:m,value:o,onChange:j=>a(j),placeholder:"Select or create event",allowCreate:!0,isMulti:!1,optionType:"event",onSaveOption:g,error:"",helperText:"",required:!1}),Dt.default.createElement("div",{className:"weekly-review-event-color-selector",style:{display:"flex",gap:"10px",alignItems:"center",marginTop:"8px",marginBottom:"8px"}},Dt.default.createElement("span",{style:{marginRight:"5px",fontSize:"12px",color:"var(--text-muted)"}},"Colour:"),["gray","red","orange","yellow"].map(j=>Dt.default.createElement("div",{key:j,style:{display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",padding:"4px",width:"24px",height:"24px",borderRadius:"4px",backgroundColor:l===j?"var(--background-modifier-hover)":"transparent"},onClick:()=>c(j)},Dt.default.createElement("span",{style:{display:"inline-block",width:"16px",height:"16px",borderRadius:"50%",backgroundColor:`var(--event-color-${j}, ${j==="gray"?"#888":j})`,border:"1px solid var(--background-modifier-border)",margin:"0"},title:j.charAt(0).toUpperCase()+j.slice(1)}),Dt.default.createElement("input",{type:"radio",name:"event-color",value:j,checked:l===j,onChange:()=>{},style:{display:"none"}})))),Dt.default.createElement("div",{className:"weekly-review-event-day-selector",style:{display:"flex",gap:"10px",alignItems:"center",marginTop:"8px",marginBottom:"8px"}},Dt.default.createElement("span",{style:{marginRight:"5px",fontSize:"12px",color:"var(--text-muted)"}},"Day:"),Dt.default.createElement("select",{value:d,onChange:j=>u(j.target.value),style:{padding:"4px 8px",borderRadius:"4px",border:"1px solid var(--background-modifier-border)",backgroundColor:"var(--background-primary)",color:"var(--text-normal)",fontSize:"14px",width:"150px"}},Dt.default.createElement("option",{value:""},"None (optional)"),p.map(j=>Dt.default.createElement("option",{key:j,value:j},j)))),Dt.default.createElement("textarea",{value:i,onChange:j=>s(j.target.value),placeholder:"Notes about this event",className:"weekly-review-textarea"}),Dt.default.createElement("button",{className:"weekly-review-add-button",onClick:h,disabled:!o},"Add Event")),e.keyEvents&&e.keyEvents.length>0?Dt.default.createElement("div",{className:"weekly-review-events-list"},e.keyEvents.map((j,E)=>{let N=j.color?`event-color-${j.color}`:"event-color-gray";return Dt.default.createElement("div",{key:`event-${E}`,className:`weekly-review-event-item ${N}`},Dt.default.createElement("div",{className:"weekly-review-event-header"},Dt.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px"}},Dt.default.createElement("h4",null,j.event),j.day&&Dt.default.createElement("span",{className:"weekly-review-event-day",style:{fontSize:"12px",padding:"2px 8px",backgroundColor:"var(--background-modifier-border)",borderRadius:"4px",color:"var(--text-normal)",fontWeight:"500"}},j.day)),Dt.default.createElement("button",{className:"weekly-review-remove-button",onClick:()=>y(E)},"Remove")),Dt.default.createElement("p",null,j.notes))})):Dt.default.createElement(et,{message:"No key events added",subMessage:"Add important market events that might impact your trading",iconSize:38,actionButtonText:"Add Your First Event",onActionButtonClick:()=>{let j=document.querySelector(".weekly-review-event-selector input");j instanceof HTMLElement&&j.focus()}}))),Dt.default.createElement("div",{className:"weekly-review-section"},Dt.default.createElement("h3",{className:"weekly-review-section-title"},"Weekly Forecast"),A(),Dt.default.createElement("style",null,`
          .weekly-review-forecast-section {
            width: 100%;
          }
          .weekly-review-forecast-notes {
            width: 100%;
          }
          .weekly-review-forecast-notes textarea {
            width: 100% !important;
            box-sizing: border-box !important;
            min-height: 80px;
          }
        `)))}});var vde,Uze,yde,bde=L(()=>{vde=q(Y());Zl();Uze=Xd(Jd,"pnl"),yde=({trades:e,height:t=300,dateFormat:r})=>vde.default.createElement(Uze,{trades:e,dateFormat:r,height:t})});var xde,Vze,wde,kde=L(()=>{xde=q(Y());Zl();Vze=Xd(lp,"drawdown"),wde=({trades:e,height:t=300,dateFormat:r})=>xde.default.createElement(Vze,{trades:e,dateFormat:r,height:t})});var Sde,Tde,Cde=L(()=>{Sde=q(Y());Zl();Tde=({data:e,height:t=300,plugin:r})=>Sde.default.createElement(pS,{data:e,height:t,plugin:r})});var Pde,Hze,Dde,Ede=L(()=>{Pde=q(Y());Zl();Hze=Xd(uS,"trades"),Dde=({trades:e,height:t=300,dateFormat:r})=>Pde.default.createElement(Hze,{trades:e,dateFormat:r,height:t,onPointClick:(n,o)=>{n!=null&&n.path}})});var de,Ide,Ade=L(()=>{de=q(Y());tg();Ut();wt();bde();kde();Cde();Ede();eo();f0();ga();rr();pt();om();Ide=({data:e,trades:t,updateData:r,openNote:n,dateFormat:o="DDMMYY",plugin:a,selectedAccounts:i=[],availableAccounts:s=[],onAccountFilterChange:l})=>{var T,P,D,O,z,I,A,j;let{currency:c}=Ke(),d=xe(),u=(D=(P=(T=d==null?void 0:d.settings)==null?void 0:T.trade)==null?void 0:P.displayRMultiples)!=null?D:!1,p=(z=(O=d==null?void 0:d.settings)==null?void 0:O.trade)==null?void 0:z.defaultRiskAmount,m=(j=(A=(I=d==null?void 0:d.settings)==null?void 0:I.trade)==null?void 0:A.showCopyTradingPnL)!=null?j:!1,f=(0,de.useMemo)(()=>o||tr(),[o]),g=(0,de.useCallback)(async(E,N="viewed")=>{},[a,e.week]),v=(0,de.useMemo)(()=>t.filter(E=>!Pt({tradeStatus:E.tradeStatus,exitTime:E.exitTime,pnl:E._originalPnlWasNull?null:E.pnl,useDirectPnLInput:E.useDirectPnLInput,exits:E.exits,entries:E.entries})),[t]),h=Ov(v,p),y=()=>{var E;try{let N=window.app;return(E=N==null?void 0:N.plugins)==null?void 0:E.plugins.journalit}catch(N){return console.error("Could not access plugin instance:",N),null}},b=(0,de.useMemo)(()=>{if(v.length===0)return{returnOnLongs:0,returnOnShorts:0,biggestProfit:0,biggestLoss:0,profitLossRatio:0};let E=v.filter(G=>{var U;return((U=G.direction)==null?void 0:U.toLowerCase())==="long"}),N=v.filter(G=>{var U;return((U=G.direction)==null?void 0:U.toLowerCase())==="short"}),B=v.filter(G=>G.pnl>0),C=v.filter(G=>G.pnl<0),F=E.reduce((G,U)=>G+U.pnl,0),M=N.reduce((G,U)=>G+U.pnl,0),_=E.reduce((G,U)=>U.entryPrice&&U.positionSize?G+U.entryPrice*U.positionSize:G+Math.abs(U.pnl)*5,0),W=N.reduce((G,U)=>U.entryPrice&&U.positionSize?G+U.entryPrice*U.positionSize:G+Math.abs(U.pnl)*5,0),$=_>0?F/_*100:0,H=W>0?M/W*100:0,R=B.length>0?Math.max(...B.map(G=>G.pnl)):0,V=C.length>0?Math.min(...C.map(G=>G.pnl)):0,Z=B.length>0?B.reduce((G,U)=>G+U.pnl,0)/B.length:0,K=C.length>0?Math.abs(C.reduce((G,U)=>G+U.pnl,0)/C.length):0,X=K>0?Z/K:0;return{returnOnLongs:$,returnOnShorts:H,biggestProfit:R,biggestLoss:V,profitLossRatio:X}},[v]),x=(0,de.useMemo)(()=>{if(v.length===0)return[];let E=new Map;v.forEach(B=>{let C=Array.isArray(B.setup)?[...B.setup]:B.setup?[B.setup]:[];C.length===0&&C.push("Other"),C.forEach(F=>{if(!F)return;let M=E.get(F)||{pnl:0,pnlR:0,wins:0,losses:0,tradeCount:0},_=Il(B),W=El(B.pnl,_,m);M.pnl+=W;let $=st(W,B.rMultiple,B.riskAmount,p);$!==void 0&&!isNaN($)&&(M.pnlR+=$),M.tradeCount++,B.pnl>0?M.wins++:B.pnl<0&&M.losses++,E.set(F,M)})});let N=[];return E.forEach((B,C)=>{let F=B.tradeCount>0?B.wins/B.tradeCount*100:0;N.push({name:C,pnl:B.pnl,pnlR:B.pnlR,winRate:F,tradeCount:B.tradeCount,totalRMultiple:B.pnlR})}),N.sort((B,C)=>C.pnl-B.pnl),N},[v]),w=(0,de.useMemo)(()=>{if(v.length===0)return null;let E=v.filter(N=>N.pnl>0);return E.length===0?null:E.reduce((N,B)=>B.pnl>N.pnl?B:N,E[0])},[v]),S=(0,de.useMemo)(()=>{if(v.length===0)return null;let E=v.filter(N=>N.pnl<0);return E.length===0?null:E.reduce((N,B)=>B.pnl<N.pnl?B:N,E[0])},[v]),k=(0,de.useMemo)(()=>{if(v.length===0)return[];let E=new Map;v.forEach(B=>{var F;let C=rt(B.entryTime,f);E.has(C)||E.set(C,[]),(F=E.get(C))==null||F.push(B)});let N=[];return E.forEach((B,C)=>{var X;let F=B.filter(G=>G.pnl>0),M=B.filter(G=>G.pnl<0),_=F.reduce((G,U)=>G+U.pnl,0),W=M.reduce((G,U)=>G+Math.abs(U.pnl),0),$=B.length>0?F.length/B.length:0,H=W>0?_/W:_>0?1/0:0,R=B.reduce((G,U)=>G+U.pnl,0),V=B.reduce((G,U)=>{let Q=st(U.pnl,U.rMultiple,U.riskAmount,p);return Q!==void 0&&!isNaN(Q)?G+Q:G},0),Z=((X=B[0])==null?void 0:X.entryTime)||new Date,K;try{let G=y();G!=null&&G.drcService&&(K=G.drcService.getDRCNotePath(Z))}catch(G){console.error(`Error getting DRC path for date ${C}:`,G)}N.push({date:C,rawDate:Z,tradeCount:B.length,winRate:$,profitFactor:H,pnl:R,pnlR:V,drcPath:K})}),N.sort((B,C)=>yd(C.rawDate,B.rawDate)),N},[v,f]);return(0,de.useEffect)(()=>{v.length>0&&(g("pnl"),g("drawdown"),g("trades")),x.length>0&&g("setup_performance")},[v.length,x.length,g]),de.default.createElement("div",{className:"weekly-review-overview"},de.default.createElement("div",{className:"drc-section"},de.default.createElement(fm,{accounts:s||[],selectedAccounts:i||[],onChange:l||(()=>{}),useOnlyProvidedAccounts:!0})),de.default.createElement("div",{className:"weekly-review-section"},de.default.createElement("h3",{className:"weekly-review-section-title"},"Weekly Cumulative P&L"),v.length>0?de.default.createElement(yde,{trades:v,height:300,dateFormat:f,plugin:d}):de.default.createElement(et,{message:"No P&L data to display",subMessage:"Your cumulative profit/loss will show here once you've logged closed trades",iconSize:40})),de.default.createElement("div",{className:"weekly-review-section"},de.default.createElement("h3",{className:"weekly-review-section-title"},"Weekly Drawdown"),v.length>0?de.default.createElement(wde,{trades:v,height:250,dateFormat:f}):de.default.createElement(et,{message:"No drawdown data to display",subMessage:"Your drawdown metrics will appear here once you've logged closed trades",iconSize:40})),de.default.createElement("div",{className:"weekly-review-section"},de.default.createElement("h3",{className:"weekly-review-section-title"},"Weekly Performance"),de.default.createElement("div",{className:"weekly-review-metric-cards"},de.default.createElement("div",{className:"weekly-review-metric-card"},de.default.createElement("div",{className:"weekly-review-metric-label"},"Net P&L"),de.default.createElement("div",{className:"weekly-review-metric-value",style:{color:h.netPnL>=0?"var(--color-green)":"var(--color-red)"}},ve(h.netPnL,!0,c,u,h.netPnLR))),de.default.createElement("div",{className:"weekly-review-metric-card"},de.default.createElement("div",{className:"weekly-review-metric-label"},"Win Rate"),de.default.createElement("div",{className:"weekly-review-metric-value"},Jn(h.winRate*100))),de.default.createElement("div",{className:"weekly-review-metric-card"},de.default.createElement("div",{className:"weekly-review-metric-label"},"Profit Factor"),de.default.createElement("div",{className:"weekly-review-metric-value"},h.profitFactor.toFixed(2))),de.default.createElement("div",{className:"weekly-review-metric-card"},de.default.createElement("div",{className:"weekly-review-metric-label"},"Expectancy"),de.default.createElement("div",{className:"weekly-review-metric-value"},ve(h.expectancy,!0,c,u,h.expectancyR))),de.default.createElement("div",{className:"weekly-review-metric-card"},de.default.createElement("div",{className:"weekly-review-metric-label"},"Total Trades"),de.default.createElement("div",{className:"weekly-review-metric-value"},h.numTrades)),de.default.createElement("div",{className:"weekly-review-metric-card"},de.default.createElement("div",{className:"weekly-review-metric-label"},"Avg. Win"),de.default.createElement("div",{className:"weekly-review-metric-value",style:{color:"var(--color-green)"}},ve(h.avgWin,!0,c,u,h.avgWinR))),de.default.createElement("div",{className:"weekly-review-metric-card"},de.default.createElement("div",{className:"weekly-review-metric-label"},"Avg. Loss"),de.default.createElement("div",{className:"weekly-review-metric-value",style:{color:"var(--color-red)"}},ve(-h.avgLoss,!0,c,u,h.avgLossR?-h.avgLossR:void 0))),de.default.createElement("div",{className:"weekly-review-metric-card"},de.default.createElement("div",{className:"weekly-review-metric-label"},"P/L Ratio"),de.default.createElement("div",{className:"weekly-review-metric-value",style:{color:b.profitLossRatio>=1?"var(--color-green)":"var(--color-red)"}},b.profitLossRatio.toFixed(2))))),x.length>0?de.default.createElement("div",{className:"weekly-review-section"},de.default.createElement("h3",{className:"weekly-review-section-title"},"Setup Performance"),de.default.createElement(Tde,{data:x,height:250,plugin:d}),de.default.createElement("div",{className:"weekly-review-setup-table"},de.default.createElement("table",null,de.default.createElement("thead",null,de.default.createElement("tr",null,de.default.createElement("th",null,"Setup"),de.default.createElement("th",null,"P&L"),de.default.createElement("th",null,"Win %"),de.default.createElement("th",null,"Trades"))),de.default.createElement("tbody",null,x.slice(0,5).map((E,N)=>de.default.createElement("tr",{key:`setup-${N}`},de.default.createElement("td",null,E.name),de.default.createElement("td",{style:{color:E.pnl>=0?"var(--color-green)":"var(--color-red)"}},ve(E.pnl,!0,c,u,E.pnlR)),de.default.createElement("td",null,Jn(E.winRate)),de.default.createElement("td",null,E.tradeCount))))))):t.length>0?de.default.createElement("div",{className:"weekly-review-section"},de.default.createElement("h3",{className:"weekly-review-section-title"},"Setup Performance"),de.default.createElement(et,{message:"No setup data available",subMessage:"Add setup tags to your trades to see performance metrics by setup",iconSize:40})):null,de.default.createElement("div",{className:"weekly-review-section"},de.default.createElement("h3",{className:"weekly-review-section-title"},"Weekly Trades"),t.length>0?de.default.createElement(Dde,{trades:t,height:300,dateFormat:f}):de.default.createElement(et,{message:"No trades for this week",subMessage:"Track your individual trades to see them visualized here",iconSize:42,actionButtonText:n?"Create Trade":void 0,onActionButtonClick:n?()=>{var N;let E=y();(N=E==null?void 0:E.views)!=null&&N.openTradeForm&&E.views.openTradeForm()}:void 0})),de.default.createElement("div",{className:"weekly-review-section"},de.default.createElement("h3",{className:"weekly-review-section-title"},"Best Trade of the Week"),w?de.default.createElement("div",{className:"weekly-review-best-trade best-trade"},de.default.createElement("div",{className:"weekly-review-best-trade-header"},de.default.createElement("div",{className:"weekly-review-best-trade-title"},w.instrument||"Unknown"," (",w.direction,")"),de.default.createElement("div",{className:"weekly-review-best-trade-pnl",style:{color:"var(--color-green)"}},ve(w.pnl,!0,c,u,st(w.pnl,w.rMultiple,w.riskAmount,p)))),de.default.createElement("div",{className:"weekly-review-best-trade-details"},de.default.createElement("div",{className:"weekly-review-best-trade-detail"},de.default.createElement("span",{className:"weekly-review-best-trade-label"},"Date:"),de.default.createElement("span",{className:"weekly-review-best-trade-value"},rt(w.entryTime,f))),de.default.createElement("div",{className:"weekly-review-best-trade-detail"},de.default.createElement("span",{className:"weekly-review-best-trade-label"},"Setup:"),de.default.createElement("span",{className:"weekly-review-best-trade-value"},w.setup&&Array.isArray(w.setup)?w.setup.join(", "):w.setup||"N/A")),w.exitTime&&de.default.createElement("div",{className:"weekly-review-best-trade-detail"},de.default.createElement("span",{className:"weekly-review-best-trade-label"},"Duration:"),de.default.createElement("span",{className:"weekly-review-best-trade-value"},(()=>{let E=sv(w.entryTime,w.exitTime);if(E===null)return"N/A";let N=Math.floor(E/(1e3*60*60)),B=Math.floor(E%(1e3*60*60)/(1e3*60));return`${N}h ${B}m`})())),w.customTags&&w.customTags.length>0&&de.default.createElement("div",{className:"weekly-review-best-trade-detail"},de.default.createElement("span",{className:"weekly-review-best-trade-label"},"Tags:"),de.default.createElement("span",{className:"weekly-review-best-trade-value"},w.customTags.join(", "))),w.mistake&&w.mistake.length>0&&de.default.createElement("div",{className:"weekly-review-best-trade-detail"},de.default.createElement("span",{className:"weekly-review-best-trade-label"},"Mistakes:"),de.default.createElement("span",{className:"weekly-review-best-trade-value"},w.mistake.join(", ")))),de.default.createElement("div",{className:"weekly-review-best-trade-actions"},de.default.createElement("button",{className:"weekly-review-view-button",onClick:async()=>{n&&n(w.path,!0)},disabled:!n},"View Trade Details"))):de.default.createElement(et,{message:"No winning trades this week",subMessage:"Your best trades will appear here once you've logged some profitable trades",iconSize:40})),de.default.createElement("div",{className:"weekly-review-section"},de.default.createElement("h3",{className:"weekly-review-section-title"},"Worst Trade of the Week"),S?de.default.createElement("div",{className:"weekly-review-best-trade worst-trade"},de.default.createElement("div",{className:"weekly-review-best-trade-header"},de.default.createElement("div",{className:"weekly-review-best-trade-title"},S.instrument||"Unknown"," (",S.direction,")"),de.default.createElement("div",{className:"weekly-review-best-trade-pnl",style:{color:"var(--color-red)"}},ve(S.pnl,!0,c,u,st(S.pnl,S.rMultiple,S.riskAmount,p)))),de.default.createElement("div",{className:"weekly-review-best-trade-details"},de.default.createElement("div",{className:"weekly-review-best-trade-detail"},de.default.createElement("span",{className:"weekly-review-best-trade-label"},"Date:"),de.default.createElement("span",{className:"weekly-review-best-trade-value"},rt(S.entryTime,f))),de.default.createElement("div",{className:"weekly-review-best-trade-detail"},de.default.createElement("span",{className:"weekly-review-best-trade-label"},"Setup:"),de.default.createElement("span",{className:"weekly-review-best-trade-value"},S.setup&&Array.isArray(S.setup)?S.setup.join(", "):S.setup||"N/A")),S.exitTime&&de.default.createElement("div",{className:"weekly-review-best-trade-detail"},de.default.createElement("span",{className:"weekly-review-best-trade-label"},"Duration:"),de.default.createElement("span",{className:"weekly-review-best-trade-value"},(()=>{let E=sv(S.entryTime,S.exitTime);if(E===null)return"N/A";let N=Math.floor(E/(1e3*60*60)),B=Math.floor(E%(1e3*60*60)/(1e3*60));return`${N}h ${B}m`})())),S.customTags&&S.customTags.length>0&&de.default.createElement("div",{className:"weekly-review-best-trade-detail"},de.default.createElement("span",{className:"weekly-review-best-trade-label"},"Tags:"),de.default.createElement("span",{className:"weekly-review-best-trade-value"},S.customTags.join(", "))),S.mistake&&S.mistake.length>0&&de.default.createElement("div",{className:"weekly-review-best-trade-detail"},de.default.createElement("span",{className:"weekly-review-best-trade-label"},"Mistakes:"),de.default.createElement("span",{className:"weekly-review-best-trade-value"},S.mistake.join(", ")))),de.default.createElement("div",{className:"weekly-review-best-trade-actions"},de.default.createElement("button",{className:"weekly-review-view-button",onClick:async()=>{n&&n(S.path,!0)},disabled:!n},"View Trade Details"))):de.default.createElement(et,{message:"No losing trades this week",subMessage:"Your least successful trades will appear here to help you learn and improve",iconSize:40})),de.default.createElement("div",{className:"weekly-review-section"},de.default.createElement("h3",{className:"weekly-review-section-title"},"Daily Performance"),k.length>0?de.default.createElement("div",{className:"weekly-review-trades-table"},de.default.createElement("table",null,de.default.createElement("thead",null,de.default.createElement("tr",null,de.default.createElement("th",null,"Date"),de.default.createElement("th",null,"Trades"),de.default.createElement("th",null,"Win%"),de.default.createElement("th",null,"Profit Factor"),de.default.createElement("th",null,"P&L"))),de.default.createElement("tbody",null,k.map((E,N)=>de.default.createElement("tr",{key:`day-${N}`,className:"weekly-review-trade-row",onClick:()=>{n&&E.drcPath&&n(E.drcPath,!0)},style:{cursor:n?"pointer":"default"}},de.default.createElement("td",null,E.date),de.default.createElement("td",null,E.tradeCount),de.default.createElement("td",null,Jn(E.winRate*100)),de.default.createElement("td",null,E.profitFactor===1/0?"\u221E":E.profitFactor.toFixed(2)),de.default.createElement("td",{style:{color:E.pnl>=0?"var(--color-green)":"var(--color-red)"}},ve(E.pnl,!0,c,u,E.pnlR))))))):de.default.createElement(et,{message:"No trades for this week",subMessage:"Your daily trading performance will appear here once you've logged trades",iconSize:42,actionButtonText:n?"Create Trade":void 0,onActionButtonClick:n?()=>{var N;let E=y();(N=E==null?void 0:E.views)!=null&&N.openTradeForm&&E.views.openTradeForm()}:void 0})))}});var nt,Lde,Nde=L(()=>{nt=q(Y());wt();eo();Kv();Lde=({data:e,drcs:t,updateData:r,openNote:n,dateFormat:o="DDMMYY",plugin:a})=>{let i=(0,nt.useMemo)(()=>o||tr(),[o]),[s,l]=(0,nt.useState)(""),c=async(g,v)=>{let h={...e.reviewQuestions||{}};h[g]=v,r({reviewQuestions:h})},d=async()=>{if(!s.trim())return;let g=[...e.nextWeekGoals||[]];g.push(s),r({nextWeekGoals:g}),l("")},u=async g=>{let v=[...e.nextWeekGoals||[]];v.splice(g,1),r({nextWeekGoals:v})},p=async g=>{r({mentalGrade:g})},m=async g=>{r({technicalGrade:g})},f=async()=>{r({reviewed:!0,reviewedAt:new Date().toISOString()})};return nt.default.createElement("div",{className:"weekly-review-review"},nt.default.createElement("div",{className:"weekly-review-section"},nt.default.createElement("h3",{className:"weekly-review-section-title"},"Daily Reviews For This Week"),t.length===0?nt.default.createElement(et,{message:"No daily reviews found for this week",subMessage:"Daily reviews will appear here once you've created them",iconSize:40,actionButtonText:n?"Create Daily Review":void 0,onActionButtonClick:n?()=>{var v,h,y;let g=typeof window!="undefined"?(h=(v=window==null?void 0:window.app)==null?void 0:v.plugins)==null?void 0:h.plugins.journalit:null;(y=g==null?void 0:g.drcService)!=null&&y.createDRCForDate&&g.drcService.createDRCForDate(new Date)}:void 0}):nt.default.createElement("div",{className:"weekly-review-drc-list",style:{width:"100%",boxSizing:"border-box"}},t.map((g,v)=>nt.default.createElement("div",{key:`drc-${v}`,className:"weekly-review-drc-card"},nt.default.createElement("div",{className:"weekly-review-drc-header"},nt.default.createElement("h4",{className:"weekly-review-drc-date"},(Mt(g.data.date)||new Date).toLocaleDateString(void 0,{weekday:"short"})," - ",rt(Mt(g.data.date)||new Date,i)),nt.default.createElement("div",{className:"weekly-review-drc-grades"},nt.default.createElement("span",{className:`weekly-review-drc-grade grade-${(g.data.mentalGrade||"").toString().toLowerCase()}`,"data-grade":g.data.mentalGrade},"Mental: ",g.data.mentalGrade||"N/A"),nt.default.createElement("span",{className:`weekly-review-drc-grade grade-${(g.data.technicalGrade||"").toString().toLowerCase()}`,"data-grade":g.data.technicalGrade},"Technical: ",g.data.technicalGrade||"N/A")),nt.default.createElement("div",{className:"weekly-review-drc-actions"},nt.default.createElement("button",{className:"weekly-review-drc-button",onClick:()=>n&&n(g.file.path,!0),disabled:!n},"View DRC"))),nt.default.createElement("div",{className:"weekly-review-drc-summary"},g.data.reviewQuestions&&Object.entries(g.data.reviewQuestions).slice(0,2).map(([h,y],b)=>nt.default.createElement("div",{key:`drc-review-${v}-${b}`,className:"weekly-review-drc-section"},nt.default.createElement("div",{className:"weekly-review-drc-section-label"},h),nt.default.createElement("div",{className:"weekly-review-drc-section-content"},y||"No answer provided")))))))),nt.default.createElement("div",{className:"weekly-review-section"},nt.default.createElement("h3",{className:"weekly-review-section-title"},"Performance Self-Assessment"),nt.default.createElement("div",{className:"weekly-review-grades"},nt.default.createElement("div",{className:"weekly-review-grade-row"},nt.default.createElement("div",{className:"weekly-review-grade-item"},nt.default.createElement("div",{className:"weekly-review-grade-label"},"Mental Performance"),nt.default.createElement("div",{className:"weekly-review-grade-stars"},[1,2,3,4,5].map(g=>{let v=e.mentalGrade||0,h="weekly-review-star";return v>=g?h+=" full":v>=g-.5&&(h+=" half"),nt.default.createElement("span",{key:`mental-${g}`,className:h,onClick:()=>p(g),onContextMenu:y=>{y.preventDefault(),p(g-.5)}},"\u2605")})),nt.default.createElement("textarea",{className:"weekly-review-textarea",value:e.mentalNotes||"",onChange:g=>r({mentalNotes:g.target.value}),placeholder:"Notes about your mental performance..."})),nt.default.createElement("div",{className:"weekly-review-grade-item"},nt.default.createElement("div",{className:"weekly-review-grade-label"},"Technical Execution"),nt.default.createElement("div",{className:"weekly-review-grade-stars"},[1,2,3,4,5].map(g=>{let v=e.technicalGrade||0,h="weekly-review-star";return v>=g?h+=" full":v>=g-.5&&(h+=" half"),nt.default.createElement("span",{key:`technical-${g}`,className:h,onClick:()=>m(g),onContextMenu:y=>{y.preventDefault(),m(g-.5)}},"\u2605")})),nt.default.createElement("textarea",{className:"weekly-review-textarea",value:e.technicalNotes||"",onChange:g=>r({technicalNotes:g.target.value}),placeholder:"Notes about your technical execution..."}))))),nt.default.createElement("div",{className:"weekly-review-section"},nt.default.createElement("h3",{className:"weekly-review-section-title"},"Weekly Review Questions"),nt.default.createElement("div",{className:"weekly-review-questions"},Object.keys(e.reviewQuestions||{}).length>0?nt.default.createElement("div",{className:"weekly-review-question-list"},Object.entries(e.reviewQuestions||{}).map(([g,v],h)=>nt.default.createElement("div",{key:`question-${h}`,className:"weekly-review-question"},nt.default.createElement("div",{className:"weekly-review-question-header"},nt.default.createElement("h4",{className:"weekly-review-question-text"},g)),nt.default.createElement("textarea",{value:v||"",onChange:y=>c(g,y.target.value),placeholder:"Your answer here...",className:"weekly-review-textarea",rows:4})))):nt.default.createElement(et,{message:"No review questions configured",subMessage:"Add review questions in the Weekly Review settings tab",iconSize:40}),nt.default.createElement("p",{className:"weekly-review-info-text"},"Review questions can be configured in the Weekly Review settings tab."))),nt.default.createElement("div",{className:"weekly-review-section"},nt.default.createElement("h3",{className:"weekly-review-section-title"},"Goals for Next Week"),nt.default.createElement("div",{className:"weekly-review-goals"},e.nextWeekGoals&&e.nextWeekGoals.length>0?nt.default.createElement("div",{className:"weekly-review-goals-list"},e.nextWeekGoals.map((g,v)=>nt.default.createElement("div",{key:`goal-${v}`,className:"weekly-review-goal-item"},nt.default.createElement("div",{className:"weekly-review-goal-text"},g),nt.default.createElement("button",{className:"weekly-review-goal-remove",onClick:()=>u(v)},"Remove")))):nt.default.createElement(et,{message:"No goals set for next week",subMessage:"Define clear goals to focus your trading",iconSize:38,actionButtonText:"Add Your First Goal",onActionButtonClick:()=>{let g=document.querySelector(".weekly-review-input");g instanceof HTMLElement&&g.focus()}}),nt.default.createElement("div",{className:"weekly-review-add-goal"},nt.default.createElement("input",{type:"text",value:s,onChange:g=>l(g.target.value),placeholder:"Add a goal for next week",className:"weekly-review-input"}),nt.default.createElement("button",{className:"weekly-review-add-button",onClick:d,disabled:!s.trim()},"Add Goal")))),nt.default.createElement("div",{className:"weekly-review-section weekly-review-mark-reviewed-section"},nt.default.createElement(Dd,{reviewed:e.reviewed,reviewedAt:e.reviewedAt,onMarkReviewed:f})))}});var Pn,t4,Mde,Fde=L(()=>{Pn=q(Y());n0();ow();Av();o0();hde();Ade();Nde();Ed();kv();Yw();t4=require("obsidian"),Mde=Pn.default.memo(({data:e,trades:t=[],drcs:r=[],filePath:n,openNote:o,plugin:a})=>{let i="WeeklyReview",s=vv(i,"general"),[l,c]=(0,Pn.useState)(e.previousGoals||null),[d,u]=(0,Pn.useState)([]),[p,m]=(0,Pn.useState)([]),f=(0,Pn.useRef)(null),[g,v]=(0,Pn.useState)(n||"unknown"),h=(0,Pn.useRef)(!1),{service:y}=zq(),b=Pn.default.useCallback(z=>{let I=new Set;return z.forEach(A=>{A.account&&(Array.isArray(A.account)?A.account.forEach(j=>I.add(j)):I.add(A.account)),A.accountIds&&(Array.isArray(A.accountIds)?A.accountIds.forEach(j=>I.add(j)):I.add(A.accountIds))}),Array.from(I).sort()},[]);Pn.default.useEffect(()=>{(async()=>{try{let A=b(t);m(A),u(j=>j.filter(E=>A.includes(E)))}catch(I){console.error("Error loading accounts:",I);let A=b(t);m(A),u(j=>j.filter(E=>A.includes(E)))}})()},[t,b]);let x=Pn.default.useMemo(()=>d.length===0?t:t.filter(z=>{let I=A=>A?Array.isArray(A)?A.some(j=>d.includes(j)):typeof A=="string"?d.includes(A):!1:!1;return I(z.account)||I(z.accountIds)}),[t,d]),w=Pn.default.useMemo(()=>{var z;try{let I={...e};if(e.forecast){I.forecast={monthly:{...e.forecast.monthly},weekly:{...e.forecast.weekly},daily:{...e.forecast.daily}},e.forecast.customTimeframes&&(I.forecast.customTimeframes={...e.forecast.customTimeframes});let A=j=>{j&&(j.imagePath&&!j.images?(j.images=[(0,t4.normalizePath)(j.imagePath)],delete j.imagePath):Array.isArray(j.images)?j.images=j.images.map(E=>(0,t4.normalizePath)(E)):j.images||(j.images=[]))};A(I.forecast.monthly),A(I.forecast.weekly),A(I.forecast.daily),(z=I.forecast)!=null&&z.customTimeframes&&Object.keys(I.forecast.customTimeframes).forEach(j=>{A(I.forecast.customTimeframes[j])})}return I}catch(I){return s(I,"Error normalizing data"),e}},[e]),S=Pn.default.useMemo(()=>{try{if(w.date){let z=w.date.split("-").map(A=>parseInt(A,10)),I=new Date(z[0],z[1]-1,z[2]);return I.getFullYear()!==z[0]||I.getMonth()!==z[1]-1||I.getDate()!==z[2]?(console.error(`Invalid date parsed from frontmatter: ${w.date}`),new Date):I}return new Date}catch(z){return s(z,"Error parsing date"),new Date}},[w.date]),k=(0,Pn.useCallback)(z=>{f.current=z;try{if(z&&!n){let I=z.getAttribute("data-displaying-file");if(I){v(I);return}let A=z.parentElement;for(;A;){let j=A.getAttribute("data-displaying-file")||A.getAttribute("data-file-path");if(j){v(j);break}A=A.parentElement}}}catch(I){s(I,"Error finding file path")}},[n]);(0,Pn.useEffect)(()=>{let z=async()=>{var I,A;try{if(y&&w.date){let j=w.date.split("-").map(M=>parseInt(M,10)),E=new Date(j[0],j[1]-1,j[2]);if(E.getFullYear()!==j[0]||E.getMonth()!==j[1]-1||E.getDate()!==j[2]){console.error(`Invalid date parsed from frontmatter when fetching previous goals: ${w.date}`);return}let N=new Date(E);N.setDate(E.getDate()-7);let B=y.getWeeklyReviewPath(N),C=a||((A=(I=window.app)==null?void 0:I.plugins)==null?void 0:A.plugins.journalit),F=C.app.vault.getAbstractFileByPath(B);if(F&&C.app.metadataCache.getFileCache(F)){let _=await y.extractWeeklyReviewData(F);_!=null&&_.nextWeekGoals&&c(_.nextWeekGoals)}}}catch(j){Dl({message:"Error fetching previous week goals",error:j,component:i,operation:"fetchPreviousWeekGoals",severity:"warning"})}};!h.current&&w.date&&!l&&(z(),h.current=!0)},[w.date,y,a,l]),(0,Pn.useEffect)(()=>{if(Pv(),Df(),Sd(),ju(),f.current){f.current.classList.add("weekly-review-mounted"),f.current.setAttribute("data-mounted-at",Date.now().toString());let z=f.current.closest(".journalit-weekly-review-view");z&&z.classList.add("weekly-review-mounted")}},[]);let T=z=>{let I=["January","February","March","April","May","June","July","August","September","October","November","December"],A=parseInt(z.toString())-1;return I[A]||z},P=`${w.week} Review, ${T(w.month)} ${w.year}`,D=[{id:"prepare",label:"Preparation",content:({data:z,updateData:I})=>Pn.default.createElement(gde,{data:z,updateData:I,previousWeekGoals:l})},{id:"overview",label:"Overview",content:({data:z,updateData:I,openNote:A})=>{var j,E;return Pn.default.createElement(Ide,{data:z,trades:x,updateData:I,openNote:A,dateFormat:((E=(j=a==null?void 0:a.settings)==null?void 0:j.trade)==null?void 0:E.dateFormat)||"DDMMYY",plugin:a,selectedAccounts:d,availableAccounts:p,onAccountFilterChange:u})}},{id:"review",label:"Review",content:({data:z,updateData:I,openNote:A})=>{var j,E;return Pn.default.createElement(Lde,{data:z,drcs:r,trades:x,updateData:I,openNote:A,dateFormat:((E=(j=a==null?void 0:a.settings)==null?void 0:j.trade)==null?void 0:E.dateFormat)||"DDMMYY",plugin:a})}}],O={currentDate:S,getAdjacentReview:async z=>{try{if(y)return await y.getAdjacentWeeklyReview(S,z)}catch(I){s(I,"Error getting adjacent weekly review")}return null},getRelatedReviewPaths:{monthly:z=>{var I,A;try{let j=a||((A=(I=window.app)==null?void 0:I.plugins)==null?void 0:A.plugins.journalit);if(j!=null&&j.drcService)return j.drcService.getMonthlyReviewPath(z)}catch(j){s(j,"Error getting monthly review path")}return""},yearly:z=>{try{let I=z.getFullYear();return`!Journalit/${I}/Yearly-${I}.md`}catch(I){s(I,"Error getting yearly review path")}return""}}};return Pn.default.createElement("div",{className:"weekly-review-container",ref:k,"data-file-path":g,style:{margin:0}},Pn.default.createElement(Yv,{data:w,filePath:g,openNote:o,plugin:a,serviceName:"weeklyReviewService",componentName:P,reviewType:w.type,navigationOptions:O,tabConfig:D,updateMethodName:"updateWeeklyReviewFrontmatter",className:{container:"weekly-review-content",header:{container:"weekly-review-header",title:"weekly-review-title",dateContainer:"weekly-review-date-container"},tabContainer:{container:"weekly-review-tabs-container",tabList:"weekly-review-tabs",tab:"weekly-review-tab",activeTab:"active"}}}))})});var Ode,LL,jde=L(()=>{Ode=q(Y());Fde();n0();Nb();LL=class extends rc{constructor(t,r){super(t),this.plugin=r}async renderComponent(t,r,n,o,a){await this.renderWeeklyReview(t,r,r.trades||[],r.drcs||[],n,o,a)}async renderWeeklyReview(t,r,n=[],o=[],a,i,s){try{if(!t||!t.isConnected)return;let l=s?`${a}-${i}-${s}`:`${a}-${i}`,c=this.reactRoots.get(l);if(c&&c.domContainer&&c.domContainer.isConnected&&c.domContainer.querySelector(".weekly-review-container")||t.querySelector(".weekly-review-container"))return;Pv();let u,p=t.closest(".workspace-leaf");p&&p.id&&(u=p.id,t.setAttribute("data-leaf-id",u)),t.setAttribute("data-weekly-protected","true"),t.setAttribute("data-displaying-file",a),t.setAttribute("data-rendered-at",Date.now().toString()),t.setAttribute("data-renderer-id",`${a}-${i}-${Date.now()}`),t.setAttribute("data-debug-version","1.0.0");let m={...r};["plugin","app","_"].forEach(g=>{g in m&&delete m[g]});let f={...m,trades:n,drcs:o};this.createReactRoot(t,l,u,s,f,a)}catch(l){console.error("[WeeklyReview] Error rendering Weekly Review:",l),t.setText("Error rendering Weekly Review: "+(l instanceof Error?l.message:String(l)))}}getComponentClassName(){return"journalit-weekly-review-view"}getWrapperClassName(){return"weekly-review-wrapper"}createReactElement(t,r,n){let o=n||((a,i=!1)=>{this.plugin&&this.plugin.openFile(a,i)});return Ode.default.createElement(Mde,{data:t,trades:t.trades||[],drcs:t.drcs||[],filePath:r,openNote:o,plugin:this.plugin})}unmountWeeklyReview(t,r,n,o){return this.unmountComponent(t,r,n,o)}unmountAllWeeklyReviews(){this.unmountAllComponents()}}});var Kb,NL,zde=L(()=>{Kb=require("obsidian");jde();Bb();HA();mL();NL=class extends nc{constructor(r){super(r.app,r,new LL(r.app,r));this.observerTimeouts=new Map;this.tradeUpdateListener=null;this.plugin=r,this.setupTradeUpdateListener()}isValidComponentType(r){return r&&r.type==="weekly-review"}getComponentClassName(){return"journalit-weekly-review-view"}getWrapperClassName(){return"weekly-review-wrapper"}getComponentTypeIdentifier(){return"weekly-review"}async getAdditionalDataForComponent(r,n){let o=[],a=[];if(this.plugin.weeklyReviewService)try{let i=n.date.split("-").map(l=>parseInt(l,10)),s=new Date(i[0],i[1]-1,i[2]);if((s.getFullYear()!==i[0]||s.getMonth()!==i[1]-1||s.getDate()!==i[2])&&(console.error(`Invalid date parsed from frontmatter: ${n.date}`),s.setTime(new Date().getTime())),this.plugin.tradeService){let c=(await this.plugin.weeklyReviewService.getTradesForWeek(s)).map(async d=>{var u;try{let p=(u=this.app.metadataCache.getFileCache(d))==null?void 0:u.frontmatter;if(!p||p.type!=="trade"&&p.type!=="backtest-trade")return null;let m=p.pnl===void 0||p.pnl===null;return{path:d.path,instrument:p.instrument||"Unknown",direction:p.direction||"Unknown",entryPrice:parseFloat(p.entryPrice)||0,exitPrice:p.exitPrice!==void 0&&p.exitPrice!==null?parseFloat(p.exitPrice):0,positionSize:parseFloat(p.positionSize)||0,pnl:p.pnl!==void 0&&p.pnl!==null?parseFloat(p.pnl):0,entryTime:p.entryTime?new Date(p.entryTime):new Date,exitTime:p.exitTime?new Date(p.exitTime):new Date(p.entryTime),setup:p.setup,mistake:p.mistake,customTags:p.customTags,account:Array.isArray(p.account)?p.account:p.account?[p.account]:[],accountIds:Array.isArray(p.accountIds)?p.accountIds:p.accountIds?[p.accountIds]:[],tradeStatus:p.tradeStatus,useDirectPnLInput:p.useDirectPnLInput,exits:p.exits,entries:p.entries,_originalPnlWasNull:m,...hh(p)}}catch(p){return console.error(`Error processing trade file ${d.path}:`,p),null}});o=(await Promise.all(c)).filter(Boolean)}a=await this.plugin.weeklyReviewService.getDRCsForWeek(s)}catch(i){console.error("[WeeklyReview] Error fetching additional data:",i)}return{trades:o,drcs:a}}setupTradeUpdateListener(){this.tradeUpdateListener=async r=>{let n=r.detail.filePath;try{let o=this.app.workspace.getActiveFile();if(!o)return;let a=this.app.metadataCache.getFileCache(o),i=a==null?void 0:a.frontmatter;i&&this.isValidComponentType(i)&&await this.refreshWeeklyReview(o)}catch(o){console.error("Error refreshing weekly review after trade update:",o)}},document.addEventListener("journalit:trade-data-changed",this.tradeUpdateListener)}async refreshWeeklyReview(r){try{let{forceMetadataCacheRefresh:n}=await Promise.resolve().then(()=>(ls(),nO));await n(this.app,r,200);let o=this.app.metadataCache.getFileCache(r),a=(o==null?void 0:o.frontmatter)||{};if(!this.isValidComponentType(a)){console.warn(`[WeeklyReview] File is not a valid weekly review: ${r.path}`);return}this.cleanupDuplicateComponents(r.path);let i=this.getComponentClassName(),s=document.querySelectorAll(`.${i}[data-file-path="${r.path}"]`);if(s.length===0)return;let l=await this.getAdditionalDataForComponent(r,a);for(let c of Array.from(s)){let d=c,u=d.getAttribute("data-view-id"),p=d.getAttribute("data-markdown-view-id")||d.getAttribute("data-editor-id");u&&(d.querySelectorAll(`.${this.getWrapperClassName()}`).forEach(f=>f.remove()),await new Promise(f=>{setTimeout(()=>{try{this.renderWithDeduplication({file:r,container:d,data:{...a,...l},viewId:u,contextId:p||void 0,componentClassName:this.getComponentClassName(),mountedClassName:"weekly-review-mounted",contentSelector:".weekly-review-container"}),f()}catch(g){console.error("[WeeklyReview] Error during re-render:",g),f()}},50)}))}this.markFileRenderedInMode(r.path,"source"),this.markFileRenderedInMode(r.path,"preview")}catch(n){console.error(`[WeeklyReview] Error refreshing weekly review for ${r.path}:`,n)}}disconnectObserverSafely(r){let n=this.observerTimeouts.get(r);n&&(clearTimeout(n),this.observerTimeouts.delete(r)),r.disconnect();let o=this.activeObservers.indexOf(r);o>-1&&this.activeObservers.splice(o,1)}async handleFileOpen(r,n=!1){if(!r)return;this.cleanupOrphanedComponents(),this.cleanupUnrelatedComponents(r.path);let o=this.app.metadataCache.getFileCache(r),a=o==null?void 0:o.frontmatter;if(!a||!this.isValidComponentType(a))return;if(n){let c=`rendered-weekly-${r.path}-${Date.now()}`;if(window[c]=!1,Date.now()-(window.__obsidianStartTime||0)<5e3){setTimeout(()=>this.tryRenderActiveComponent(r,c),500),setTimeout(()=>{window[c]||this.tryRenderActiveComponent(r,c)},1500),setTimeout(()=>{window[c]||this.tryRenderActiveComponent(r,c),delete window[c]},3e3),setTimeout(()=>{this.renderActiveComponent()},5e3);return}this.tryRenderActiveComponent(r,c),setTimeout(()=>{window[c]||this.tryRenderActiveComponent(r,c),delete window[c]},500)}let i=document.body,s=new MutationObserver(async(c,d)=>{var u;try{let p=document.querySelectorAll(".cm-editor");if(p.length===0)return;if(this.isFileRenderedInMode(r.path,"source")){if(document.querySelectorAll(`.${this.getComponentClassName()}[data-file-path="${r.path}"]`).length>0)return;this.clearFileRenderedStatus(r.path,"source")}for(let f of Array.from(p)){let g=f.querySelector(".metadata-container");if(!g)continue;let v=g.closest(".workspace-leaf-content");if(!v)continue;let h=this.findContainingLeaf(v),y=(u=h==null?void 0:h.view)==null?void 0:u.containerEl,b=g.closest(".workspace-leaf"),w=(b==null?void 0:b.id)||(y==null?void 0:y.id)||null,S=this.getUniqueElementId(f),k=w?`leaf-${w}`:S,T=!0;if(h){let A=h.view,j=null;(A&&"file"in A||A&&"getViewType"in A&&A.getViewType()==="markdown")&&(j=A.file),j&&(T=j.path===r.path)}if(!T)continue;f.querySelectorAll(`.${this.getComponentClassName()}`).forEach(A=>{let j=A.getAttribute("data-file-path");if(j&&j!==r.path){let E=A.getAttribute("data-view-id"),N=A.getAttribute("data-leaf-id");E&&this.renderer.unmountComponent(j,E,N||void 0),A.remove()}});let P=Array.from(f.querySelectorAll(`.${this.getComponentClassName()}[data-file-path="${r.path}"]`));if(P.length>1)for(let A=1;A<P.length;A++){let j=P[A],E=j.getAttribute("data-view-id"),N=j.getAttribute("data-leaf-id");E&&this.renderer.unmountComponent(r.path,E,N||void 0),j.remove()}let D=this.getWrapperClassName();if(f.querySelectorAll(`.${D}`).length>0)continue;let z=Array.from(f.querySelectorAll(`.${this.getComponentClassName()}`)).find(A=>A.getAttribute("data-file-path")===r.path);z||(z=document.createElement("div"),z.className=this.getComponentClassName(),z.setAttribute("data-file-path",r.path),z.setAttribute("data-view-id",k),z.setAttribute("data-editor-id",S),z.setAttribute("data-view-mode","source"),w&&z.setAttribute("data-leaf-id",w),z.setAttribute("data-inserted-at",Date.now().toString()),z.classList.add("journalit-component-container"),g.after(z));let I=await this.getAdditionalDataForComponent(r,a);this.renderer.renderComponent(z,{...a,...I},r.path,k,S),this.markFileRenderedInMode(r.path,"source")}d.disconnect();let m=this.activeObservers.indexOf(d);m>-1&&this.activeObservers.splice(m,1)}catch(p){console.error("[WeeklyReview] Error in MutationObserver:",p)}});this.activeObservers.push(s),s.observe(i,{childList:!0,subtree:!0});let l=setTimeout(()=>{this.disconnectObserverSafely(s)},5e3);this.observerTimeouts.set(s,l)}async handleMarkdownPostProcessor(r,n){var l,c;if(!n.sourcePath)return;let o=this.app.vault.getAbstractFileByPath(n.sourcePath);if(!(o instanceof Kb.TFile))return;let a=this.app.metadataCache.getFileCache(o),i=a==null?void 0:a.frontmatter;if(!i||!this.isValidComponentType(i))return;if(((l=r.parentElement)==null?void 0:l.classList.contains("markdown-preview-view"))&&!n.sourcePath.endsWith("#")&&!r.previousElementSibling){if(this.isFileRenderedInMode(o.path,"preview"))return;let d=r.parentElement;if(!d){console.warn(`[${this.constructor.name}] Cannot find parent markdown view for:`,n.sourcePath);return}let u=d.closest(".workspace-leaf-content");if(!u){console.warn(`[${this.constructor.name}] Cannot find containing leaf for:`,n.sourcePath);return}let p=d.closest(".workspace-leaf"),m=p==null?void 0:p.id,f=this.findContainingLeaf(u),g=(c=f==null?void 0:f.view)==null?void 0:c.containerEl,v=m||(g==null?void 0:g.id)||null,h=this.getUniqueElementId(d),y=v?`leaf-${v}`:h,b=!0;if(f){let P=f.view,D=null;("file"in P||P&&"getViewType"in P&&P.getViewType()==="markdown")&&(D=P.file),D&&(b=D.path===o.path)}if(!b)return;let x=this.getComponentClassName(),w=Array.from(d.querySelectorAll(`.${x}[data-file-path="${o.path}"]`));if(w.length>0){if(w.length>1)for(let P=1;P<w.length;P++){let D=w[P],O=D.getAttribute("data-view-id"),z=D.getAttribute("data-leaf-id");O&&this.renderer.unmountComponent(o.path,O,z||void 0),D.remove()}return}d.querySelectorAll(`.${x}`).forEach(P=>{let D=P.getAttribute("data-file-path");if(D&&D!==o.path){let O=P.getAttribute("data-view-id"),z=P.getAttribute("data-leaf-id");O&&this.renderer.unmountComponent(D,O,z||void 0),P.remove()}});let S=this.getWrapperClassName(),k=Array.from(d.querySelectorAll(`.${S}`));if(k.length>0&&k.some(D=>{var O;return((O=D.closest(`.${x}`))==null?void 0:O.getAttribute("data-file-path"))===o.path}))return;let T=document.createElement("div");T.className=this.getComponentClassName(),T.setAttribute("data-file-path",o.path),T.setAttribute("data-view-id",y),T.setAttribute("data-markdown-view-id",h),T.setAttribute("data-view-mode","preview"),v&&T.setAttribute("data-leaf-id",v),T.setAttribute("data-inserted-at",Date.now().toString()),T.classList.add("journalit-component-container"),d.insertBefore(T,d.firstChild);try{let P=await this.getAdditionalDataForComponent(o,i);await this.renderer.renderComponent(T,{...i,...P},o.path,y,h),this.markFileRenderedInMode(o.path,"preview")}catch(P){console.error(`[${this.constructor.name}] Error rendering component:`,P),T.textContent=`Error rendering ${this.getComponentTypeIdentifier()}: ${P instanceof Error?P.message:String(P)}`}}}registerCurrentLeaves(){this.app.workspace.iterateAllLeaves(r=>{var o;let n=(o=r.view)==null?void 0:o.containerEl;n&&n.id&&this.registeredLeaves.add(n.id),n&&!n.id&&(n.id=`weekly-review-leaf-${Date.now()}-${Math.random().toString(36).slice(2,9)}`,this.registeredLeaves.add(n.id))})}async tryRenderWeeklyInActiveLeaf(r,n){try{let o=[];this.app.workspace.iterateAllLeaves(i=>{let s=null;(i.view&&"file"in i.view||i.view&&"getViewType"in i.view&&i.view.getViewType()==="markdown")&&(s=i.view.file),s&&s.path===r.path&&o.push(i)});let a=!1;for(let i of o){if(!i.view)continue;let s=kS(i.view),l=s?i.view.getMode()==="source":!1,c=l?"source":"preview";if(this.isFileRenderedInMode(r.path,c))return!0;let d=i.view.containerEl,u=`leaf-${d.id||this.generateViewId(d)}`;try{let p=await this.getAdditionalDataForComponent(r,n);if(l){let m=d.querySelector(".metadata-container");if(m){let f=d.querySelectorAll(`.${this.getComponentClassName()}[data-file-path="${r.path}"]`),g=d.querySelectorAll(`.${this.getWrapperClassName()}`);if(f.length===0&&g.length===0){let v=document.createElement("div");v.className=this.getComponentClassName(),v.setAttribute("data-file-path",r.path),v.setAttribute("data-view-id",u),v.setAttribute("data-leaf-id",d.id||""),v.setAttribute("data-view-mode","source"),v.setAttribute("data-inserted-at",Date.now().toString()),v.classList.add("journalit-component-container"),m.after(v),await this.renderer.renderComponent(v,{...n,...p},r.path,u),this.markFileRenderedInMode(r.path,"source"),a=!0}}}else if(s&&i.view instanceof Kb.MarkdownView){let m=i.view;try{typeof m.toggleSourceMode=="function"?(m.toggleSourceMode(),setTimeout(()=>{var f;return(f=m.toggleSourceMode)==null?void 0:f.call(m)},50)):this.app.workspace.trigger("layout-change")}catch(f){console.error("[WeeklyReview] Error refreshing view:",f)}}}catch(p){console.error("[WeeklyReview] Error rendering in active leaf:",p)}}return a}catch(o){return console.error("[WeeklyReview] Error in tryRenderWeeklyInActiveLeaf:",o),!1}}async tryRenderActiveComponent(r,n){try{let o=this.app.metadataCache.getFileCache(r),a=o==null?void 0:o.frontmatter;if(!a||!this.isValidComponentType(a))return;if(this.hasProperlyRenderedComponents(r.path,this.getComponentClassName(),".weekly-review-container","weekly-review-mounted")){window[n]=!0;return}this.cleanupDuplicateComponents(r.path),await this.renderActiveComponent(),window[n]=!0}catch(o){console.error("[WeeklyReview] Error in tryRenderActiveComponent:",o)}}async renderActiveComponent(){await this.renderActiveWeeklyReview()}async renderActiveWeeklyReview(){var g;this.cleanupOrphanedComponents();let r=this.app.workspace.getActiveFile();if(!r)return;let n=this.app.metadataCache.getFileCache(r),o=n==null?void 0:n.frontmatter;if(!o||o.type!=="weekly-review")return;let a=this.getComponentClassName(),i=document.querySelectorAll(`.${a}[data-file-path="${r.path}"]`);if(i.length>0&&Array.from(i).some(h=>h.querySelector(".weekly-review-container"))){if(i.length>1)for(let h=1;h<i.length;h++){let y=i[h],b=y.getAttribute("data-view-id"),x=y.getAttribute("data-leaf-id");b&&this.renderer.unmountComponent(r.path,b,x||void 0),y.remove()}return}this.cleanupUnrelatedComponents(r.path);let s;try{s=this.app.workspace.getActiveViewOfType(Kb.MarkdownView)}catch(v){console.error("[WeeklyReview] Error getting active view:",v);let h=this.app.workspace.activeLeaf;h&&h.view&&"getViewType"in h.view&&h.view.getViewType()==="markdown"&&(s=h.view)}if(!s)return;let l=s.containerEl.closest(".workspace-leaf-content");if(!l)return;let c=this.findContainingLeaf(l),d=(g=c==null?void 0:c.view)==null?void 0:g.containerEl,u=(d==null?void 0:d.id)||null,p=u?`leaf-${u}`:this.generateViewId(l),m=kS(s)?s.getMode()==="source":!1,f=await this.getAdditionalDataForComponent(r,o);if(m){let v=s.containerEl.querySelector(".metadata-container");if(!v)return;let h=Array.from(s.containerEl.querySelectorAll(`.${this.getComponentClassName()}`)).find(b=>b.getAttribute("data-file-path")===r.path);if(h){if(h.querySelector(".weekly-review-container")){this.markFileRenderedInMode(r.path,"source");return}h.remove()}let y=document.createElement("div");y.className=this.getComponentClassName(),y.setAttribute("data-file-path",r.path),y.setAttribute("data-view-id",p),y.setAttribute("data-view-mode","source"),u&&y.setAttribute("data-leaf-id",u),y.classList.add("journalit-component-container"),v.after(y),await this.renderer.renderComponent(y,{...o,...f},r.path,p),this.markFileRenderedInMode(r.path,"source")}else{let v=this.app.workspace.activeLeaf;if(v&&v.view instanceof Kb.MarkdownView){let h=v.view;try{let y=h;typeof y.toggleSourceMode=="function"?(y.toggleSourceMode(),setTimeout(()=>{var b;return(b=y.toggleSourceMode)==null?void 0:b.call(y)},50)):typeof y.updateDisplay=="function"?y.updateDisplay():(this.app.workspace.trigger("layout-change"),window.dispatchEvent(new Event("resize")))}catch(y){console.error("[WeeklyReview] Error refreshing markdown view:",y)}}}}cleanup(){this.tradeUpdateListener&&(document.removeEventListener("journalit:trade-data-changed",this.tradeUpdateListener),this.tradeUpdateListener=null);for(let[r,n]of this.observerTimeouts)clearTimeout(n);this.observerTimeouts.clear(),super.cleanup()}}});var we,r4,qze,_de,Bde=L(()=>{we=q(Y());tg();Ut();wt();om();Zl();eo();f0();ga();rr();pt();r4=Xd(Jd,"pnl"),qze=Xd(lp,"drawdown"),_de=({data:e,trades:t,weeklyPerformance:r,bestWeek:n,worstWeek:o,updateData:a,openNote:i,plugin:s,dateFormat:l="DDMMYY",selectedAccounts:c=[],availableAccounts:d=[],onAccountFilterChange:u})=>{var O,z,I,A,j,E,N,B;let{currency:p}=Ke(),m=xe(),f=(I=(z=(O=m==null?void 0:m.settings)==null?void 0:O.trade)==null?void 0:z.displayRMultiples)!=null?I:!1,g=(j=(A=m==null?void 0:m.settings)==null?void 0:A.trade)==null?void 0:j.defaultRiskAmount,v=(B=(N=(E=m==null?void 0:m.settings)==null?void 0:E.trade)==null?void 0:N.showCopyTradingPnL)!=null?B:!1,h=(0,we.useMemo)(()=>l||tr(),[l]),y=(0,we.useMemo)(()=>t.filter(C=>!Pt({tradeStatus:C.tradeStatus,exitTime:C.exitTime,pnl:C._originalPnlWasNull?null:C.pnl,useDirectPnLInput:C.useDirectPnLInput,exits:C.exits,entries:C.entries})),[t]),b=(0,we.useMemo)(()=>Ov(y,g),[y,g]),x=(0,we.useMemo)(()=>{if(y.length===0)return[];let C=new Map;y.forEach(M=>{let _=Array.isArray(M.setup)?[...M.setup]:M.setup?[M.setup]:[];_.length===0&&_.push("Other"),_.forEach(W=>{if(!W)return;let $=C.get(W)||{pnl:0,rMultiple:0,wins:0,losses:0,tradeCount:0},H=Il(M),R=El(M.pnl,H,v);$.pnl+=R,$.tradeCount++;let V=st(R,M.rMultiple,M.riskAmount,g);V!==void 0&&($.rMultiple+=V),M.pnl>0?$.wins++:M.pnl<0&&$.losses++,C.set(W,$)})});let F=[];return C.forEach((M,_)=>{let W=M.tradeCount>0?M.wins/M.tradeCount*100:0;F.push({name:_,pnl:M.pnl,winRate:W,tradeCount:M.tradeCount,totalRMultiple:M.rMultiple})}),F.sort((M,_)=>_.pnl-M.pnl)},[y,g]),w=(0,we.useMemo)(()=>{let C=y.filter(F=>F.pnl>0);return C.length===0?null:C.reduce((F,M)=>M.pnl>F.pnl?M:F)},[y]),S=(0,we.useMemo)(()=>{let C=y.filter(F=>F.pnl<0);return C.length===0?null:C.reduce((F,M)=>M.pnl<F.pnl?M:F)},[y]),k=(0,we.useMemo)(()=>y.filter(C=>{var F;return((F=C.direction)==null?void 0:F.toLowerCase())==="long"}),[y]),T=(0,we.useMemo)(()=>y.filter(C=>{var F;return((F=C.direction)==null?void 0:F.toLowerCase())==="short"}),[y]),P=(0,we.useMemo)(()=>{let C=new Map;return r.forEach(F=>{let _=y.filter(W=>{let $=new Date(W.entryTime);return $>=F.weekStartDate&&$<=F.weekEndDate}).reduce((W,$)=>{let H=st($.pnl,$.rMultiple,$.riskAmount,g);return H!==void 0?W+H:W},0);C.set(F.weekNumber,_)}),C},[y,r,g]),D=e.date?(Mt(e.date)||new Date).toLocaleDateString("en-US",{month:"long",year:"numeric"}):new Date().toLocaleDateString("en-US",{month:"long",year:"numeric"});return we.default.createElement("div",{className:"monthly-review-overview"},we.default.createElement("div",{className:"drc-section"},we.default.createElement(fm,{accounts:d||[],selectedAccounts:c||[],onChange:u||(()=>{}),useOnlyProvidedAccounts:!0})),we.default.createElement("div",{className:"monthly-review-section"},we.default.createElement("h3",{className:"monthly-review-section-title"},"Monthly Cumulative P&L"),y.length>0?we.default.createElement(r4,{trades:y,height:300,dateFormat:h,plugin:m}):we.default.createElement(et,{message:"No P&L data to display",subMessage:"Your cumulative profit/loss will show here once you've logged closed trades",iconSize:40})),we.default.createElement("div",{className:"monthly-review-section"},we.default.createElement("h3",{className:"monthly-review-section-title"},"Monthly Drawdown"),y.length>0?we.default.createElement(qze,{trades:y,height:250,dateFormat:h,plugin:m}):we.default.createElement(et,{message:"No drawdown data to display",subMessage:"Your drawdown metrics will appear here once you've logged closed trades",iconSize:40})),we.default.createElement("div",{className:"monthly-review-section"},we.default.createElement("h3",{className:"monthly-review-section-title"},"Monthly Performance"),we.default.createElement("div",{className:"monthly-review-metric-cards"},we.default.createElement("div",{className:"monthly-review-metric-card"},we.default.createElement("div",{className:"monthly-review-metric-label"},"Net P&L"),we.default.createElement("div",{className:"monthly-review-metric-value",style:{color:b.netPnL>=0?"var(--color-green)":"var(--color-red)"}},ve(b.netPnL,!0,p,f,b.netPnLR))),we.default.createElement("div",{className:"monthly-review-metric-card"},we.default.createElement("div",{className:"monthly-review-metric-label"},"Win Rate"),we.default.createElement("div",{className:"monthly-review-metric-value"},Jn(b.winRate*100))),we.default.createElement("div",{className:"monthly-review-metric-card"},we.default.createElement("div",{className:"monthly-review-metric-label"},"Profit Factor"),we.default.createElement("div",{className:"monthly-review-metric-value"},b.profitFactor.toFixed(2))),we.default.createElement("div",{className:"monthly-review-metric-card"},we.default.createElement("div",{className:"monthly-review-metric-label"},"Total Trades"),we.default.createElement("div",{className:"monthly-review-metric-value"},b.numTrades)))),x.length>0&&we.default.createElement("div",{className:"monthly-review-section"},we.default.createElement("h3",{className:"monthly-review-section-title"},"Setup Performance"),we.default.createElement(pS,{data:x,height:250,plugin:m})),we.default.createElement("div",{className:"monthly-review-section"},we.default.createElement("h3",{className:"monthly-review-section-title"},"Biggest Winner of ",D),w?we.default.createElement("div",{className:"monthly-review-best-trade best-trade"},we.default.createElement("div",{className:"monthly-review-best-trade-header"},we.default.createElement("div",{className:"monthly-review-best-trade-title"},w.instrument||"Unknown"," (",w.direction,")"),we.default.createElement("div",{className:"monthly-review-best-trade-pnl",style:{color:"var(--color-green)"}},ve(w.pnl,!0,p,f,st(w.pnl,w.rMultiple,w.riskAmount,g)))),we.default.createElement("div",{className:"monthly-review-best-trade-details"},we.default.createElement("div",{className:"monthly-review-best-trade-detail"},we.default.createElement("span",{className:"monthly-review-best-trade-label"},"Date:"),we.default.createElement("span",{className:"monthly-review-best-trade-value"},rt(w.entryTime,h))),we.default.createElement("div",{className:"monthly-review-best-trade-detail"},we.default.createElement("span",{className:"monthly-review-best-trade-label"},"Setup:"),we.default.createElement("span",{className:"monthly-review-best-trade-value"},Array.isArray(w.setup)?w.setup.join(", "):w.setup||"N/A"))),i&&w.path&&we.default.createElement("div",{className:"monthly-review-best-trade-actions"},we.default.createElement("button",{className:"monthly-review-view-button",onClick:()=>i(w.path,!0)},"View Trade Details"))):we.default.createElement(et,{message:"No winning trades this month",subMessage:"Your best trades will appear here",iconSize:40})),we.default.createElement("div",{className:"monthly-review-section"},we.default.createElement("h3",{className:"monthly-review-section-title"},"Biggest Loser of ",D),S?we.default.createElement("div",{className:"monthly-review-best-trade worst-trade"},we.default.createElement("div",{className:"monthly-review-best-trade-header"},we.default.createElement("div",{className:"monthly-review-best-trade-title"},S.instrument||"Unknown"," (",S.direction,")"),we.default.createElement("div",{className:"monthly-review-best-trade-pnl",style:{color:"var(--color-red)"}},ve(S.pnl,!0,p,f,st(S.pnl,S.rMultiple,S.riskAmount,g)))),we.default.createElement("div",{className:"monthly-review-best-trade-details"},we.default.createElement("div",{className:"monthly-review-best-trade-detail"},we.default.createElement("span",{className:"monthly-review-best-trade-label"},"Date:"),we.default.createElement("span",{className:"monthly-review-best-trade-value"},rt(S.entryTime,h))),we.default.createElement("div",{className:"monthly-review-best-trade-detail"},we.default.createElement("span",{className:"monthly-review-best-trade-label"},"Setup:"),we.default.createElement("span",{className:"monthly-review-best-trade-value"},Array.isArray(S.setup)?S.setup.join(", "):S.setup||"N/A"))),i&&S.path&&we.default.createElement("div",{className:"monthly-review-best-trade-actions"},we.default.createElement("button",{className:"monthly-review-view-button",onClick:()=>i(S.path,!0)},"View Trade Details"))):we.default.createElement(et,{message:"No losing trades this month",subMessage:"Your worst trades will appear here",iconSize:40})),we.default.createElement("div",{className:"monthly-review-section"},we.default.createElement("h3",{className:"monthly-review-section-title"},"Weekly Performance Highlights"),we.default.createElement("div",{className:"monthly-review-week-highlights"},n&&we.default.createElement("div",{className:"monthly-review-metric-card highlight-card"},we.default.createElement("div",{className:"monthly-review-metric-label"},"Best Performing Week"),we.default.createElement("div",{className:"monthly-review-metric-value",style:{color:"var(--color-green)"}},"Week ",n.weekNumber),we.default.createElement("div",{className:"monthly-review-metric-detail"},ve(n.pnl,!0,p,f,P.get(n.weekNumber))),i&&n.weeklyReviewPath&&we.default.createElement("button",{className:"monthly-review-link-button",onClick:()=>i(n.weeklyReviewPath,!0)},"View Week")),o&&we.default.createElement("div",{className:"monthly-review-metric-card highlight-card"},we.default.createElement("div",{className:"monthly-review-metric-label"},"Worst Performing Week"),we.default.createElement("div",{className:"monthly-review-metric-value",style:{color:"var(--color-red)"}},"Week ",o.weekNumber),we.default.createElement("div",{className:"monthly-review-metric-detail"},ve(o.pnl,!0,p,f,P.get(o.weekNumber))),i&&o.weeklyReviewPath&&we.default.createElement("button",{className:"monthly-review-link-button",onClick:()=>i(o.weeklyReviewPath,!0)},"View Week")))),we.default.createElement("div",{className:"monthly-review-section"},we.default.createElement("h3",{className:"monthly-review-section-title"},"Long Only Performance"),k.length>0?we.default.createElement(r4,{trades:k,height:250,dateFormat:h,plugin:m}):we.default.createElement(et,{message:"No long trades this month",subMessage:"Your long trade performance will appear here",iconSize:40})),we.default.createElement("div",{className:"monthly-review-section"},we.default.createElement("h3",{className:"monthly-review-section-title"},"Short Only Performance"),T.length>0?we.default.createElement(r4,{trades:T,height:250,dateFormat:h,plugin:m}):we.default.createElement(et,{message:"No short trades this month",subMessage:"Your short trade performance will appear here",iconSize:40})),we.default.createElement("div",{className:"monthly-review-section"},we.default.createElement("h3",{className:"monthly-review-section-title"},"Weekly Breakdown"),r.length>0?we.default.createElement("div",{className:"monthly-review-trades-table"},we.default.createElement("table",null,we.default.createElement("thead",null,we.default.createElement("tr",null,we.default.createElement("th",null,"Week"),we.default.createElement("th",null,"Trades"),we.default.createElement("th",null,"Win%"),we.default.createElement("th",null,"Profit Factor"),we.default.createElement("th",null,"P&L"))),we.default.createElement("tbody",null,r.map((C,F)=>we.default.createElement("tr",{key:`week-${F}`,className:"monthly-review-trade-row",onClick:()=>{i&&C.weeklyReviewPath&&i(C.weeklyReviewPath,!0)},style:{cursor:i&&C.weeklyReviewPath?"pointer":"default"}},we.default.createElement("td",null,"W",C.weekNumber),we.default.createElement("td",null,C.trades),we.default.createElement("td",null,Jn(C.winRate*100)),we.default.createElement("td",null,C.profitFactor===1/0?"\u221E":C.profitFactor.toFixed(2)),we.default.createElement("td",{style:{color:C.pnl>=0?"var(--color-green)":"var(--color-red)"}},ve(C.pnl,!0,p,f,P.get(C.weekNumber)))))))):we.default.createElement(et,{message:"No weekly data available",subMessage:"Your weekly performance breakdown will appear here",iconSize:40})))}});var ao,n4,$de=L(()=>{ao=q(Y()),n4=({title:e,data:t,type:r,openNote:n})=>{let o=l=>l==null?"N/A":l.toFixed(1),a=l=>r==="mental"?l.mentalGradeDistribution:l.technicalGradeDistribution,i=l=>r==="mental"?l.mentalRating:l.technicalRating,s=l=>r==="mental"?l.mentalNotes:l.technicalNotes;return ao.default.createElement("div",{className:"monthly-review-section"},ao.default.createElement("h3",{className:"monthly-review-section-title"},e),t.length>0?ao.default.createElement("div",{className:"monthly-review-trades-table"},ao.default.createElement("table",null,ao.default.createElement("thead",null,ao.default.createElement("tr",null,ao.default.createElement("th",null,"Week"),ao.default.createElement("th",null,"A Games"),ao.default.createElement("th",null,"B Games"),ao.default.createElement("th",null,"C Games"),ao.default.createElement("th",null,"Rating"),ao.default.createElement("th",null,"Notes"))),ao.default.createElement("tbody",null,t.map((l,c)=>{let d=a(l),u=i(l),p=s(l);return ao.default.createElement("tr",{key:`week-${l.weekNumber}`,className:"monthly-review-trade-row",onClick:()=>{n&&l.weeklyReviewPath&&n(l.weeklyReviewPath,!0)},style:{cursor:n&&l.weeklyReviewPath?"pointer":"default"}},ao.default.createElement("td",null,"W",l.weekNumber),ao.default.createElement("td",{className:"grade-count grade-a"},d.A),ao.default.createElement("td",{className:"grade-count grade-b"},d.B),ao.default.createElement("td",{className:"grade-count grade-c"},d.C),ao.default.createElement("td",{className:"rating-cell"},o(u)),ao.default.createElement("td",{className:"notes-cell"},p&&ao.default.createElement("div",{className:"notes-content"},p)))})))):ao.default.createElement("div",{className:"empty-performance-message"},"No performance data available for this month"))}});var hr,Wde,Rde=L(()=>{hr=q(Y());eo();Kv();$de();Wde=({data:e,demonTrackerData:t,weeklyGamePerformance:r,updateData:n,openNote:o,plugin:a})=>{let i=["DEMON","1","2","3","4","5","STOP TRADING"];return hr.default.createElement("div",{className:"monthly-review-review"},hr.default.createElement("div",{className:"monthly-review-section"},hr.default.createElement("h3",{className:"monthly-review-section-title"},"Demon Tracker"),hr.default.createElement("p",{className:"monthly-review-section-description"},"Track your recurring mistakes to identify patterns and improve your trading discipline."),t.length>0?hr.default.createElement("div",{className:"demon-tracker-container"},hr.default.createElement("table",{className:"demon-tracker-table"},hr.default.createElement("thead",null,hr.default.createElement("tr",null,i.map((s,l)=>hr.default.createElement("th",{key:`col-${l}`,className:`demon-tracker-header ${s==="STOP TRADING"?"stop-trading":""}`},s)))),hr.default.createElement("tbody",null,t.map((s,l)=>hr.default.createElement("tr",{key:`demon-${l}`,className:"demon-tracker-row"},hr.default.createElement("td",{className:"demon-name"},s.mistake),[1,2,3,4,5].map(c=>hr.default.createElement("td",{key:`occ-${c}`,className:"demon-occurrence"},s.occurrences>=c?hr.default.createElement("span",{className:"demon-x"},"\u2717"):hr.default.createElement("span",{className:"demon-empty"},"-"))),hr.default.createElement("td",{className:"demon-occurrence stop-trading"},s.occurrences>=6?hr.default.createElement("span",{className:"demon-x stop"},"\u2717"):hr.default.createElement("span",{className:"demon-empty"},"-")))))),hr.default.createElement("div",{className:"demon-tracker-summary"},hr.default.createElement("div",{className:"demon-summary-item"},hr.default.createElement("span",{className:"demon-summary-label"},"Total Unique Mistakes:"),hr.default.createElement("span",{className:"demon-summary-value"},t.length)),hr.default.createElement("div",{className:"demon-summary-item"},hr.default.createElement("span",{className:"demon-summary-label"},"Total Mistake Occurrences:"),hr.default.createElement("span",{className:"demon-summary-value"},t.reduce((s,l)=>s+l.occurrences,0))),t.filter(s=>s.occurrences>=6).length>0&&hr.default.createElement("div",{className:"demon-summary-item warning"},hr.default.createElement("span",{className:"demon-summary-label"},"Critical Mistakes (6+):"),hr.default.createElement("span",{className:"demon-summary-value"},t.filter(s=>s.occurrences>=6).length)))):hr.default.createElement(et,{message:"No mistakes tracked this month",subMessage:"Mistakes logged in your trades will appear here to help identify patterns",iconSize:40})),hr.default.createElement(n4,{title:"Mental Game Performance",data:r,type:"mental",openNote:o}),hr.default.createElement(n4,{title:"Technical Game Performance",data:r,type:"technical",openNote:o}),hr.default.createElement("div",{className:"monthly-review-section monthly-review-mark-reviewed-section"},hr.default.createElement(Dd,{reviewed:e.reviewed,reviewedAt:e.reviewedAt,onMarkReviewed:()=>{n({reviewed:!0,reviewedAt:new Date().toISOString()})}})))}});var La,Ude,Vde=L(()=>{La=q(Y());Bde();Rde();qC();Av();o0();Ed();wt();Ude=La.default.memo(({data:e,filePath:t,trades:r,weeklyPerformance:n,weeklyGamePerformance:o,demonTrackerData:a,bestWeek:i,worstWeek:s,updateData:l,openNote:c,plugin:d,dateFormat:u})=>{let[p,m]=(0,La.useState)(0),[f,g]=(0,La.useState)([]),[v,h]=(0,La.useState)([]),[y,b]=(0,La.useState)(e),x=La.default.useCallback(I=>{let A=new Set;return I.forEach(j=>{j.account&&(Array.isArray(j.account)?j.account.forEach(E=>A.add(E)):A.add(j.account)),j.accountIds&&(Array.isArray(j.accountIds)?j.accountIds.forEach(E=>A.add(E)):A.add(j.accountIds))}),Array.from(A).sort()},[]),w=La.default.useMemo(()=>f.length===0?r:r.filter((A,j)=>{let E=B=>B?Array.isArray(B)?B.some(C=>f.includes(C)):typeof B=="string"?f.includes(B):!1:!1;return E(A.account)||E(A.accountIds)}),[r,f]);(0,La.useEffect)(()=>{(async()=>{try{let j=x(r);h(j),g(E=>E.filter(N=>j.includes(N)))}catch(A){console.error("Error loading accounts:",A);let j=x(r);h(j),g(E=>E.filter(N=>j.includes(N)))}})()},[r,x]),(0,La.useEffect)(()=>{b(e)},[e.date,e.month,e.year]),(0,La.useEffect)(()=>{Dv(),Sd(),ju()},[]),(0,La.useEffect)(()=>{var A;let I=()=>{m(j=>j+1)};return(A=d==null?void 0:d.events)==null||A.on("settings-changed",I),()=>{var j;(j=d==null?void 0:d.events)==null||j.off("settings-changed",I)}},[d]);let S=async I=>{try{b(A=>({...A,...I})),await l(I)}catch(A){console.error("Error updating monthly review data:",A),b(e)}},k=[{id:"overview",label:"Overview",content:({data:I,updateData:A,openNote:j})=>La.default.createElement(_de,{data:I,trades:w,weeklyPerformance:n,bestWeek:i,worstWeek:s,updateData:A,openNote:j,plugin:d,dateFormat:u,selectedAccounts:f,availableAccounts:v,onAccountFilterChange:g})},{id:"review",label:"Review",content:({data:I,updateData:A,openNote:j})=>La.default.createElement(Wde,{data:I,demonTrackerData:a,weeklyGamePerformance:o,updateData:A,openNote:j,plugin:d})}],T=y.date?Mt(y.date)||new Date:new Date,P=T.toLocaleDateString("en-US",{month:"long",year:"numeric"}),D=async I=>{let A=d==null?void 0:d.monthlyReviewService;return A?await A.getAdjacentMonthlyReview(T,I):null},z={currentDate:T,getAdjacentReview:async I=>await D(I),getRelatedReviewPaths:{yearly:I=>""}};return La.default.createElement("div",{className:"monthly-review-container",key:p,style:{margin:0}},La.default.createElement(Yv,{data:y,filePath:t||"",openNote:c,plugin:d,serviceName:"monthlyReviewService",componentName:P,reviewType:y.type,navigationOptions:z,tabConfig:k,updateMethodName:"updateMonthlyReviewFrontmatter",className:{container:"monthly-review-content",header:{container:"monthly-review-header",title:"monthly-review-title",dateContainer:"monthly-review-date-container"},tabContainer:{container:"monthly-review-tabs-container",tabList:"monthly-review-tabs",tab:"monthly-review-tab",activeTab:"active"}}}))})});var Hde,ML,qde=L(()=>{Hde=q(Y());Nb();Vde();ba();ML=class extends rc{constructor(t){super(t.app),this.plugin=t}getComponentClassName(){return"journalit-monthly-review-view"}getWrapperClassName(){return"monthly-review-wrapper"}createReactElement(t,r,n){var m;let{trades:o,weeklyPerformance:a,weeklyGamePerformance:i,demonTrackerData:s,bestWeek:l,worstWeek:c}=t,d={type:t.type||"monthly-review",date:t.date,month:t.month,year:t.year,reviewQuestions:t.reviewQuestions,monthlyGoals:t.monthlyGoals,keyFocusAreas:t.keyFocusAreas,biggestAccomplishment:t.biggestAccomplishment,biggestChallenge:t.biggestChallenge,lessonsLearned:t.lessonsLearned,nextMonthGoals:t.nextMonthGoals,areasOfImprovement:t.areasOfImprovement,reviewed:t.reviewed,reviewedAt:t.reviewedAt},u=((m=this.plugin.settings)==null?void 0:m.dateFormat)||"DDMMYY",p=this.plugin.monthlyReviewService;return Hde.default.createElement(Ude,{data:d,filePath:r,trades:o||[],weeklyPerformance:a||[],weeklyGamePerformance:i||[],demonTrackerData:s||[],bestWeek:l||null,worstWeek:c||null,updateData:async f=>{p&&await p.updateMonthlyReviewFrontmatter(r,f)},openNote:n,plugin:this.plugin,dateFormat:u})}async renderComponent(t,r,n,o,a){if(!t||!t.isConnected)return;let i=a?`${n}-${o}-${a}`:`${n}-${o}`;if(t.getAttribute("data-rendering-in-progress")==="true")return;let s=this.reactRoots.get(i);if(s){if(s.domContainer&&s.domContainer.isConnected)return;this.reactRoots.delete(i)}if(t.querySelector(".monthly-review-container"))return;t.setAttribute("data-rendering-in-progress","true"),t.setAttribute("data-render-id",i),Dv(),t.addClass("journalit-monthly-review-container"),this.createReactRoot(t,i,void 0,a,r,n),t.removeAttribute("data-rendering-in-progress")}}});function Gde(e){if(!("file"in e))return!1;let t=e;return t.file instanceof bh.TFile||t.file===null}var bh,FL,Yde=L(()=>{bh=require("obsidian");Bb();qde();FL=class extends nc{constructor(r){super(r.app,r,new ML(r));this.observerTimeouts=new Map;this.plugin=r}isValidComponentType(r){return(r==null?void 0:r.type)==="monthly-review"}getComponentClassName(){return"journalit-monthly-review-view"}getWrapperClassName(){return"monthly-review-wrapper"}getComponentTypeIdentifier(){return"monthly-review"}async getAdditionalDataForComponent(r,n){if(!this.plugin.monthlyReviewService)return{trades:[],weeklyPerformance:[],weeklyGamePerformance:[],demonTrackerData:[],bestWeek:null,worstWeek:null};try{let o=await this.plugin.monthlyReviewService.getMonthlyDataOptimized(n.year,n.month);return{trades:o.trades,weeklyPerformance:o.weeklyPerformance,weeklyGamePerformance:o.weeklyGamePerformance,demonTrackerData:o.demonTrackerData,bestWeek:o.bestWeek,worstWeek:o.worstWeek}}catch(o){return console.error("[MonthlyReview] Error fetching additional data:",o),{trades:[],weeklyPerformance:[],weeklyGamePerformance:[],demonTrackerData:[],bestWeek:null,worstWeek:null}}}disconnectObserverSafely(r){let n=this.observerTimeouts.get(r);n&&(clearTimeout(n),this.observerTimeouts.delete(r)),r.disconnect();let o=this.activeObservers.indexOf(r);o>-1&&this.activeObservers.splice(o,1)}async handleFileOpen(r,n){if(!r){this.cleanup();return}this.cleanupOrphanedComponents(),this.cleanupUnrelatedComponents(r.path);let o=this.app.metadataCache.getFileCache(r),a=o==null?void 0:o.frontmatter;if(this.isValidComponentType(a)){if(n||document.dispatchEvent(new CustomEvent("journalit:monthly-review-opened",{detail:{file:r.path,frontmatter:a}})),n){let i=`rendered-monthly-${r.path}-${Date.now()}`,s=window;if(s[i]=!1,Date.now()-(s.__obsidianStartTime||0)<5e3){setTimeout(()=>this.tryRenderActiveComponent(r,i),500),setTimeout(()=>{s[i]||this.tryRenderActiveComponent(r,i)},1500),setTimeout(()=>{s[i]||this.tryRenderActiveComponent(r,i),delete s[i]},3e3),setTimeout(()=>{this.renderActiveComponent()},5e3);return}this.tryRenderActiveComponent(r,i),setTimeout(()=>{s[i]||this.tryRenderActiveComponent(r,i),delete s[i]},500)}await this.processMonthlyReviewNote(r,a,n)}}async processMonthlyReviewNote(r,n,o){let a=document.body,i=null,s=new MutationObserver(async(c,d)=>{i&&clearTimeout(i),i=setTimeout(async()=>{var u;try{let p=document.querySelectorAll(".cm-editor");if(p.length===0)return;if(this.isFileRenderedInMode(r.path,"source")){if(document.querySelectorAll(`.${this.getComponentClassName()}[data-file-path="${r.path}"]`).length>0)return;this.clearFileRenderedStatus(r.path,"source")}for(let f of Array.from(p)){let g=f.querySelector(".metadata-container");if(!g)continue;let v=g.closest(".workspace-leaf-content");if(!v)continue;let h=this.findContainingLeaf(v),y=(u=h==null?void 0:h.view)==null?void 0:u.containerEl,b=g.closest(".workspace-leaf"),w=(b==null?void 0:b.id)||(y==null?void 0:y.id)||null,S=this.getUniqueElementId(f),k=w?`leaf-${w}`:S,T=!0;if(h){let A=h.view,j=null;(A&&Gde(A)||A&&"getViewType"in A&&A.getViewType()==="markdown")&&(j=A.file),j&&(T=j.path===r.path)}if(!T)continue;f.querySelectorAll(`.${this.getComponentClassName()}`).forEach(A=>{let j=A.getAttribute("data-file-path");if(j&&j!==r.path){let E=A.getAttribute("data-view-id"),N=A.getAttribute("data-leaf-id");E&&this.renderer.unmountComponent(j,E,N||void 0),A.remove()}});let P=Array.from(f.querySelectorAll(`.${this.getComponentClassName()}[data-file-path="${r.path}"]`));if(P.length>1)for(let A=1;A<P.length;A++){let j=P[A],E=j.getAttribute("data-view-id"),N=j.getAttribute("data-leaf-id");E&&this.renderer.unmountComponent(r.path,E,N||void 0),j.remove()}let D=this.getWrapperClassName();if(f.querySelectorAll(`.${D}`).length>0)continue;let z=Array.from(f.querySelectorAll(`.${this.getComponentClassName()}`)).find(A=>A.getAttribute("data-file-path")===r.path);z||(z=document.createElement("div"),z.className=this.getComponentClassName(),z.classList.add("journalit-component-container"),z.setAttribute("data-file-path",r.path),z.setAttribute("data-view-id",k),z.setAttribute("data-editor-id",S),z.setAttribute("data-view-mode","source"),w&&z.setAttribute("data-leaf-id",w),z.setAttribute("data-inserted-at",Date.now().toString()),g.after(z));let I=await this.getAdditionalDataForComponent(r,n);this.renderer.renderComponent(z,{...n,...I},r.path,k,S),this.markFileRenderedInMode(r.path,"source")}d.disconnect();let m=this.activeObservers.indexOf(d);m>-1&&this.activeObservers.splice(m,1)}catch(p){console.error("[MonthlyReview] Error in MutationObserver:",p)}finally{i=null}},150)});this.activeObservers.push(s),s.observe(a,{childList:!0,subtree:!0});let l=setTimeout(()=>{this.disconnectObserverSafely(s)},5e3);this.observerTimeouts.set(s,l)}async renderActiveComponent(){var g;this.cleanupOrphanedComponents();let r=this.app.workspace.getActiveFile();if(!r)return;let n=this.app.metadataCache.getFileCache(r),o=n==null?void 0:n.frontmatter;if(!o||o.type!=="monthly-review")return;let a=this.getComponentClassName(),i=document.querySelectorAll(`.${a}[data-file-path="${r.path}"]`);if(i.length>0&&Array.from(i).some(h=>h.querySelector(".monthly-review-container")||h.querySelector(".monthly-review")||h.querySelector(".monthly-review-wrapper"))){if(i.length>1)for(let h=1;h<i.length;h++){let y=i[h],b=y.getAttribute("data-view-id"),x=y.getAttribute("data-leaf-id");b&&this.renderer.unmountComponent(r.path,b,x||void 0),y.remove()}return}this.cleanupUnrelatedComponents(r.path);let s=null;try{s=this.app.workspace.getActiveViewOfType(bh.MarkdownView)}catch(v){console.error("[MonthlyReview] Error getting active view:",v);let h=this.app.workspace.activeLeaf;h&&h.view instanceof bh.MarkdownView&&(s=h.view)}if(!s)return;let l=s.containerEl.closest(".workspace-leaf-content");if(!l)return;let c=this.findContainingLeaf(l),d=(g=c==null?void 0:c.view)==null?void 0:g.containerEl,u=(d==null?void 0:d.id)||null,p=u?`leaf-${u}`:this.generateViewId(l),m=s.getMode()==="source",f=await this.getAdditionalDataForComponent(r,o);if(m){let v=s.containerEl.querySelector(".metadata-container");if(!v)return;let h=Array.from(s.containerEl.querySelectorAll(`.${this.getComponentClassName()}`)).find(b=>b.getAttribute("data-file-path")===r.path);if(h){if(h.querySelector(".monthly-review-container")||h.querySelector(".monthly-review")||h.querySelector(".monthly-review-wrapper")){this.markFileRenderedInMode(r.path,"source");return}h.remove()}let y=document.createElement("div");y.className=this.getComponentClassName(),y.classList.add("journalit-component-container"),y.setAttribute("data-file-path",r.path),y.setAttribute("data-view-id",p),y.setAttribute("data-view-mode","source"),u&&y.setAttribute("data-leaf-id",u),v.after(y),await this.renderer.renderComponent(y,{...o,...f},r.path,p),this.markFileRenderedInMode(r.path,"source")}else{let v=this.app.workspace.activeLeaf;if(v&&v.view instanceof bh.MarkdownView){let h=v.view;try{typeof h.toggleSourceMode=="function"?(h.toggleSourceMode(),setTimeout(()=>{var y;return(y=h.toggleSourceMode)==null?void 0:y.call(h)},50)):typeof h.updateDisplay=="function"?h.updateDisplay():(this.app.workspace.trigger("layout-change"),window.dispatchEvent(new Event("resize")))}catch(y){console.error("[MonthlyReview] Error refreshing markdown view:",y)}}}}async tryRenderActiveComponent(r,n){try{let o=window,a=this.app.metadataCache.getFileCache(r),i=a==null?void 0:a.frontmatter;if(!i||!this.isValidComponentType(i))return;let s=this.getComponentClassName(),l=document.querySelectorAll(`.${s}[data-file-path="${r.path}"]`);if(l.length>0&&Array.from(l).some(d=>d.querySelector(".monthly-review-container")||d.querySelector(".monthly-review")||d.querySelector(".monthly-review-wrapper"))){o[n]=!0;return}this.cleanupUnrelatedComponents(r.path),await this.renderActiveComponent(),o[n]=!0}catch(o){console.error("[MonthlyReview] Error in tryRenderActiveComponent:",o)}}cleanup(){for(let[r,n]of this.observerTimeouts)clearTimeout(n);this.observerTimeouts.clear(),super.cleanup()}async handleMarkdownPostProcessor(r,n){var l,c;if(!n.sourcePath)return;let o=this.app.vault.getAbstractFileByPath(n.sourcePath);if(!(o instanceof bh.TFile))return;let a=this.app.metadataCache.getFileCache(o),i=a==null?void 0:a.frontmatter;if(!i||!this.isValidComponentType(i))return;if(((l=r.parentElement)==null?void 0:l.classList.contains("markdown-preview-view"))&&!n.sourcePath.endsWith("#")&&!r.previousElementSibling){if(this.isFileRenderedInMode(o.path,"preview"))return;let d=r.parentElement;if(!d){console.warn(`[${this.constructor.name}] Cannot find parent markdown view for:`,n.sourcePath);return}let u=d.closest(".workspace-leaf-content");if(!u){console.warn(`[${this.constructor.name}] Cannot find containing leaf for:`,n.sourcePath);return}let p=d.closest(".workspace-leaf"),m=p==null?void 0:p.id,f=this.findContainingLeaf(u),g=(c=f==null?void 0:f.view)==null?void 0:c.containerEl,v=m||(g==null?void 0:g.id)||null,h=this.getUniqueElementId(d),y=v?`leaf-${v}`:h,b=!0;if(f){let P=f.view,D=null;(Gde(P)||P&&"getViewType"in P&&P.getViewType()==="markdown")&&(D=P.file),D&&(b=D.path===o.path)}if(!b)return;let x=this.getComponentClassName(),w=Array.from(d.querySelectorAll(`.${x}[data-file-path="${o.path}"]`));if(w.length>0){if(w.length>1)for(let P=1;P<w.length;P++){let D=w[P],O=D.getAttribute("data-view-id"),z=D.getAttribute("data-leaf-id");O&&this.renderer.unmountComponent(o.path,O,z||void 0),D.remove()}return}d.querySelectorAll(`.${x}`).forEach(P=>{let D=P.getAttribute("data-file-path");if(D&&D!==o.path){let O=P.getAttribute("data-view-id"),z=P.getAttribute("data-leaf-id");O&&this.renderer.unmountComponent(D,O,z||void 0),P.remove()}});let S=this.getWrapperClassName(),k=Array.from(d.querySelectorAll(`.${S}`));if(k.length>0&&k.some(D=>{var O;return((O=D.closest(`.${x}`))==null?void 0:O.getAttribute("data-file-path"))===o.path}))return;let T=document.createElement("div");T.className=this.getComponentClassName(),T.classList.add("journalit-component-container"),T.setAttribute("data-file-path",o.path),T.setAttribute("data-view-id",y),T.setAttribute("data-markdown-view-id",h),T.setAttribute("data-view-mode","preview"),v&&T.setAttribute("data-leaf-id",v),T.setAttribute("data-inserted-at",Date.now().toString()),d.insertBefore(T,d.firstChild);try{let P=await this.getAdditionalDataForComponent(o,i);await this.renderer.renderComponent(T,{...i,...P},o.path,y,h),this.markFileRenderedInMode(o.path,"preview")}catch(P){console.error(`[${this.constructor.name}] Error rendering component:`,P),T.textContent=`Error rendering ${this.getComponentTypeIdentifier()}: ${P instanceof Error?P.message:String(P)}`}}}}});var Kde={};Ko(Kde,{ProcessorManager:()=>o4});var o4,Jde=L(()=>{$R();Xce();mde();zde();Yde();FR();o4=class e{constructor(t,r){this._tradeNoteProcessor=null;this._drcNoteProcessor=null;this._weeklyReviewProcessor=null;this._monthlyReviewProcessor=null;this._missedTradeNoteProcessor=null;this.initializedProcessors=new Set;this.registeredLazyHandlers=new Set;this.customProcessors=new Map;this.customRenderers=new Map;this.app=t,this.plugin=r}static getInstance(t,r){return e.instance||(e.instance=new e(t,r)),e.instance}async initializeRequiredProcessors(){let t=this.app.workspace.getActiveFile(),r=!1,n=!1,o=!1,a=!1,i=!1;if(t){let s=this.app.metadataCache.getFileCache(t),l=s==null?void 0:s.frontmatter;l&&(l.type==="trade"?r=!0:l.type==="drc"?n=!0:l.type==="weekly-review"?o=!0:l.type==="monthly-review"?a=!0:(l.type==="missed-trade"||l.isMissedTrade===!0)&&(i=!0))}await this.getTradeNoteProcessor(),n?await this.getDRCNoteProcessor():this.registerLazyDRCProcessor(),o?await this.getWeeklyReviewProcessor():this.registerLazyWeeklyReviewProcessor(),a?await this.getMonthlyReviewProcessor():this.registerLazyMonthlyReviewProcessor(),i?await this.getMissedTradeNoteProcessor():this.registerLazyMissedTradeProcessor()}async getTradeNoteProcessor(){return this._tradeNoteProcessor||(this._tradeNoteProcessor=await Ci(()=>{let t=new jS(this.app,this.plugin);return t.initialize(),t},"TradeNoteProcessor"),this.initializedProcessors.add("tradeNoteProcessor")),this._tradeNoteProcessor}async getDRCNoteProcessor(){return this._drcNoteProcessor||(this._drcNoteProcessor=await Ci(()=>{let t=new AL(this.app,this.plugin);return t.initialize(),t},"DRCNoteProcessor"),this.initializedProcessors.add("drcNoteProcessor")),this._drcNoteProcessor}async getWeeklyReviewProcessor(){return this._weeklyReviewProcessor||(this._weeklyReviewProcessor=await Ci(()=>{let t=new NL(this.plugin);return t.initialize(),t},"WeeklyReviewProcessor"),this.initializedProcessors.add("weeklyReviewProcessor")),this._weeklyReviewProcessor}async getMonthlyReviewProcessor(){return this._monthlyReviewProcessor||(this._monthlyReviewProcessor=await Ci(()=>{let t=new FL(this.plugin);return t.initialize(),t},"MonthlyReviewProcessor"),this.initializedProcessors.add("monthlyReviewProcessor")),this._monthlyReviewProcessor}async getMissedTradeNoteProcessor(){return this._missedTradeNoteProcessor||(this._missedTradeNoteProcessor=await Ci(()=>{let t=new $b(this.app,this.plugin);return t.initialize(),t},"MissedTradeNoteProcessor"),this.initializedProcessors.add("missedTradeNoteProcessor")),this._missedTradeNoteProcessor}registerLazyDRCProcessor(){if(this.registeredLazyHandlers.has("drc"))return;let t=r=>{if(!r)return;let n=this.app.metadataCache.getFileCache(r),o=n==null?void 0:n.frontmatter;o&&o.type==="drc"&&(this.app.workspace.off("file-open",t),this.registeredLazyHandlers.delete("drc"),(async()=>{try{await this.getDRCNoteProcessor()}catch(a){console.error("Failed to initialize DRC processor:",a)}})())};this.plugin.registerEvent(this.app.workspace.on("file-open",t)),this.registeredLazyHandlers.add("drc")}registerLazyWeeklyReviewProcessor(){if(this.registeredLazyHandlers.has("weekly-review"))return;let t=r=>{if(!r)return;let n=this.app.metadataCache.getFileCache(r),o=n==null?void 0:n.frontmatter;o&&o.type==="weekly-review"&&(this.app.workspace.off("file-open",t),this.registeredLazyHandlers.delete("weekly-review"),(async()=>{try{await this.getWeeklyReviewProcessor()}catch(a){console.error("Failed to initialize Weekly Review processor:",a)}})())};this.plugin.registerEvent(this.app.workspace.on("file-open",t)),this.registeredLazyHandlers.add("weekly-review")}registerLazyMonthlyReviewProcessor(){if(this.registeredLazyHandlers.has("monthly-review"))return;let t=r=>{if(!r)return;let n=this.app.metadataCache.getFileCache(r),o=n==null?void 0:n.frontmatter;o&&o.type==="monthly-review"&&(this.app.workspace.off("file-open",t),this.registeredLazyHandlers.delete("monthly-review"),(async()=>{try{await this.getMonthlyReviewProcessor()}catch(a){console.error("Failed to initialize Monthly Review processor:",a)}})())};this.plugin.registerEvent(this.app.workspace.on("file-open",t)),this.registeredLazyHandlers.add("monthly-review")}registerLazyMissedTradeProcessor(){if(this.registeredLazyHandlers.has("missed-trade"))return;let t=r=>{if(!r)return;let n=this.app.metadataCache.getFileCache(r),o=n==null?void 0:n.frontmatter;o&&(o.type==="missed-trade"||o.isMissedTrade===!0)&&(this.app.workspace.off("file-open",t),this.registeredLazyHandlers.delete("missed-trade"),(async()=>{try{await this.getMissedTradeNoteProcessor()}catch(a){console.error("Failed to initialize missed trade processor:",a)}})())};this.plugin.registerEvent(this.app.workspace.on("file-open",t)),this.registeredLazyHandlers.add("missed-trade")}isProcessorInitialized(t){return this.initializedProcessors.has(t)}getAllInitializedProcessors(){return{tradeNoteProcessor:this._tradeNoteProcessor,drcNoteProcessor:this._drcNoteProcessor,weeklyReviewProcessor:this._weeklyReviewProcessor,monthlyReviewProcessor:this._monthlyReviewProcessor,missedTradeNoteProcessor:this._missedTradeNoteProcessor}}cleanupProcessors(){this._tradeNoteProcessor&&(this._tradeNoteProcessor.cleanup(),this._tradeNoteProcessor=null),this._drcNoteProcessor&&(this._drcNoteProcessor.cleanup(),this._drcNoteProcessor=null),this._weeklyReviewProcessor&&(this._weeklyReviewProcessor.cleanup(),this._weeklyReviewProcessor=null),this._monthlyReviewProcessor&&(this._monthlyReviewProcessor.cleanup(),this._monthlyReviewProcessor=null),this._missedTradeNoteProcessor&&(this._missedTradeNoteProcessor.cleanup(),this._missedTradeNoteProcessor=null),this.customProcessors.forEach(t=>{t&&typeof t.cleanup=="function"&&t.cleanup()}),this.customProcessors.clear(),this.customRenderers.forEach(t=>{t&&typeof t.cleanup=="function"&&t.cleanup()}),this.customRenderers.clear(),this.initializedProcessors.clear(),this.registeredLazyHandlers.clear()}registerProcessor(t,r){this.customProcessors.set(t,r),r&&typeof r.initialize=="function"&&r.initialize(),this.initializedProcessors.add(`${t}Processor`)}registerRenderer(t,r){this.customRenderers.set(t,r)}getRenderer(t){return this.customRenderers.has(t)?this.customRenderers.get(t):null}}});var Xde=L(()=>{});function Qde(e){if(e==null)return"null";if(typeof e!="object")return JSON.stringify(e);let t={};return Object.keys(e).sort().forEach(r=>{t[r]=typeof e[r]=="object"&&e[r]!==null?Qde(e[r]):e[r]}),JSON.stringify(t)}function Zde(e,t){var m,f;if(!e||e.length===0)return{totalAccounts:0,totalAUM:0,totalGrowthAmount:0,totalGrowthPercent:0,totalWithdrawals:0,totalTrades:0};let r=((m=t==null?void 0:t.account)==null?void 0:m.excludedAccountTypes)||["archived"],n=((f=t==null?void 0:t.account)==null?void 0:f.includeWithdrawalsFromExcluded)||{archived:!0},o=e.filter(g=>g.accountType&&!r.includes(g.accountType.toLowerCase())),a=[...o,...e.filter(g=>g.accountType&&r.includes(g.accountType.toLowerCase())&&n[g.accountType.toLowerCase()])],i=o.length,s=o.reduce((g,v)=>g+v.currentBalance,0),l=o.reduce((g,v)=>g+v.initialBalance,0),c=s-l,d=l>0?c/l*100:0,u=a.reduce((g,v)=>{let h=v.transactions.filter(y=>y.type==="withdrawal"||y.type==="deposit"&&y.amount<0).reduce((y,b)=>y+Math.abs(b.amount),0);return g+h},0),p=o.reduce((g,v)=>g+v.metrics.totalTrades,0);return{totalAccounts:i,totalAUM:s,totalGrowthAmount:c,totalGrowthPercent:d,totalWithdrawals:u,totalTrades:p}}function eue(e,t){var m;if(!e||e.length===0)return[];let r=e.map(f=>f.id).sort().join(","),n=Qde(t||{}),o=`${r}:${n}`,a=_S.get(o);if(a)return a.data;let i=((m=t==null?void 0:t.account)==null?void 0:m.excludedAccountTypes)||["archived"],s=e.filter(f=>f.accountType&&!i.includes(f.accountType.toLowerCase()));if(s.length===0)return[];let l=new Map,c=new Map;s.forEach(f=>{var b;let g=new Map,v=new Date(f.createdDate).toISOString().split("T")[0];l.has(v)||l.set(v,{depositsForDay:0,withdrawalsForDay:0}),l.get(v).accountCreated=f.id;let h=[...f.transactions].sort((x,w)=>new Date(x.date).getTime()-new Date(w.date).getTime()),y=f.initialBalance;if(h.forEach(x=>{let w=new Date(x.date).toISOString().split("T")[0];y=x.balanceAfter,g.set(w,y),l.has(w)||l.set(w,{depositsForDay:0,withdrawalsForDay:0});let S=l.get(w);x.type==="deposit"&&x.amount>0?S.depositsForDay+=x.amount:(x.type==="withdrawal"||x.type==="deposit"&&x.amount<0)&&(S.withdrawalsForDay+=Math.abs(x.amount))}),((b=f.accountType)==null?void 0:b.toLowerCase())==="archived"&&h.length>0){let x=h[h.length-1],w=new Date(x.date).toISOString().split("T")[0];l.has(w)||l.set(w,{depositsForDay:0,withdrawalsForDay:0}),l.get(w).accountArchived=f.id}c.set(f.id,g)});let d=[...l.keys()].sort(),u=[],p=new Map;if(s.forEach(f=>{p.set(f.id,f.initialBalance)}),d.forEach(f=>{let g=new Date(f),v=l.get(f);s.forEach(y=>{if(new Date(y.createdDate)<=g){let b=c.get(y.id),x=y.initialBalance;for(let[w,S]of b)if(w<=f)x=S;else break;p.set(y.id,x)}});let h=0;for(let[y,b]of p){let x=s.find(w=>w.id===y);new Date(x.createdDate)<=g&&(h+=b)}u.push({date:rt(g,tr()),rawDate:g,balance:h,isDeposit:v.depositsForDay>0,depositAmount:v.depositsForDay>0?v.depositsForDay:void 0,isWithdrawal:v.withdrawalsForDay>0,withdrawalAmount:v.withdrawalsForDay>0?v.withdrawalsForDay:void 0,accountCreated:v.accountCreated,accountArchived:v.accountArchived})}),_S.size>=Gze){let f=_S.keys().next().value;_S.delete(f)}return _S.set(o,{settings:t,data:u}),u}function tue(e){if(!e||e.length===0)return{};let t=e.reduce((n,o)=>{var i;let a=((i=o.accountType)==null?void 0:i.toLowerCase())||"unknown";return n[a]||(n[a]=[]),n[a].push(o),n},{}),r={};return Object.entries(t).forEach(([,n])=>{let o=n[0].accountType;r[o]=n}),r}function OL(e){return e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()).join(" ")}function rue(e){let r=Math.abs(new Date().getTime()-new Date(e).getTime()),n=Math.floor(r/(1e3*60*60*24));if(n<30)return`${n} day${n===1?"":"s"}`;if(n<365){let o=Math.floor(n/30);return`${o} month${o===1?"":"s"}`}else{let o=Math.floor(n/365),a=Math.floor(n%365/30);return a===0?`${o} year${o===1?"":"s"}`:`${o}y ${a}m`}}function nue(e){if(e.drawdownType==="none")return 0;if(e.drawdownType==="manual"&&e.currentDrawdownSnapshot){let n=e.currentDrawdownSnapshot.drawdownLimit;if(n<=0||e.initialBalance<=n)return 0;let o=e.currentBalance-n,a=e.drawdownAmount>0?o/e.drawdownAmount*100:0;return Math.min(100,Math.max(0,a))}if(e.drawdownAmount<=0)return 0;let r=(e.currentBalance-e.maxDrawdownReached)/e.drawdownAmount*100;return Math.min(100,Math.max(0,r))}function oue(e,t="USD"){return!e.monthlyCost||e.monthlyCost<=0?"N/A":`${Vs(e.monthlyCost,t)}/month`}function Yze(e){var s;if(!e.monthlyCost||e.monthlyCost<=0)return 0;let t=new Date(e.createdDate),r;if(((s=e.accountType)==null?void 0:s.toLowerCase())==="archived")if(e.transactions.length>0){let l=[...e.transactions].sort((c,d)=>new Date(c.date).getTime()-new Date(d.date).getTime());r=new Date(l[l.length-1].date)}else r=t;else r=new Date;let n=Math.abs(r.getTime()-t.getTime()),o=Math.floor(n/(1e3*60*60*24)),a=Math.floor(o/30),i=Math.max(1,a);return e.monthlyCost*i}function aue(e,t="USD"){let r=Yze(e);return r<=0?"N/A":Vs(r,t)}function jL(e){if(!e.hasProfitTarget||e.profitTarget<=0)return 0;let t=e.profitTargetType==="percentage"?e.initialBalance*e.profitTarget/100:e.profitTarget,n=e.metrics.totalPnL/t*100;return Math.min(100,Math.max(0,n))}function iue(e){return e.transactions.filter(t=>t.type==="withdrawal"||t.type==="deposit"&&t.amount<0).reduce((t,r)=>t+Math.abs(r.amount),0)}function zL(e){if(e.drawdownType==="none")return 0;if(e.drawdownType==="manual"&&e.currentDrawdownSnapshot){let n=e.currentBalance-e.currentDrawdownSnapshot.drawdownLimit,o=Math.min(e.drawdownAmount,Math.max(0,e.drawdownAmount-n));if(e.drawdownAmount<=0)return 0;let a=o/e.drawdownAmount*100;return Math.min(100,Math.max(0,a))}if(e.drawdownAmount<=0)return 0;let r=(e.initialBalance-e.currentBalance)/e.drawdownAmount*100;return Math.min(100,Math.max(0,r))}function _L(e,t){if(!e||e.length===0)return{aumAmount:0,aumWeightPercent:0,totalWithdrawals:0,accountCount:0,totalTrades:0,totalGrowthAmount:0,totalGrowthPercent:0};let r=e.reduce((d,u)=>d+u.currentBalance,0),n=t>0?r/t*100:0,o=e.reduce((d,u)=>{let p=u.transactions.filter(m=>m.type==="withdrawal"||m.type==="deposit"&&m.amount<0).reduce((m,f)=>m+Math.abs(f.amount),0);return d+p},0),a=e.length,i=e.reduce((d,u)=>d+u.metrics.totalTrades,0),s=e.reduce((d,u)=>d+u.initialBalance,0),l=r-s,c=s>0?l/s*100:0;return{aumAmount:r,aumWeightPercent:n,totalWithdrawals:o,accountCount:a,totalTrades:i,totalGrowthAmount:l,totalGrowthPercent:c}}var _S,Gze,lf=L(()=>{di();Ut();wt();nm();_S=new Map,Gze=10});var xt,Kze,Jze,sue,a4=L(()=>{xt=q(Y());Ut();eo();Gd();rr();Yd();Kze=(e,t)=>{let r=t-e,n;r<=100?n=10:r<=1e3?n=100:r<=1e4?n=1e3:r<=1e5?n=1e4:r<=1e6?n=1e5:n=1e6;let o=Math.floor(e/n)*n,a=[];for(let i=o;i<=t+n;i+=n)a.push(i);if(a.length>10){let i=[],s=Math.ceil(a.length/7);for(let l=0;l<a.length;l+=s)i.push(a[l]);return i[i.length-1]!==a[a.length-1]&&i.push(a[a.length-1]),i}return a},Jze=({active:e,payload:t,currency:r,displayRMultiples:n})=>{if(!e||!t||t.length===0)return null;let o=t[0].payload;return xt.default.createElement("div",{className:"journalit-chart-tooltip",style:{backgroundColor:"var(--background-primary)",borderRadius:"8px",padding:"12px 16px",minWidth:"180px",border:"1px solid var(--background-modifier-border)",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.2)",transform:"translateY(-4px)",position:"relative"}},xt.default.createElement("div",{className:"journalit-chart-tooltip-date",style:{fontSize:"14px",fontWeight:500,color:"var(--text-normal)",marginBottom:"8px",textAlign:"center"}},o.date),xt.default.createElement("div",{className:"journalit-chart-tooltip-value",style:{fontSize:"18px",fontWeight:600,textAlign:"center",color:"var(--text-normal)"}},"AUM: ",ve(o.balance,!0,r,!1,void 0)),(o.isDeposit||o.isWithdrawal||o.accountCreated||o.accountArchived)&&xt.default.createElement("div",{style:{marginTop:"8px",padding:"6px 0",borderTop:"1px solid var(--background-modifier-border)",fontSize:"13px"}},o.isDeposit&&xt.default.createElement("div",{style:{color:"#41B4F7"}},"Deposit: ",ve(o.depositAmount,!0,r,!1,void 0)),o.isWithdrawal&&xt.default.createElement("div",{style:{color:"var(--text-warning, gold)"}},"Withdrawal: ",ve(o.withdrawalAmount,!0,r,!1,void 0)),o.accountCreated&&xt.default.createElement("div",{style:{color:"var(--text-success)"}},"Account Added"),o.accountArchived&&xt.default.createElement("div",{style:{color:"var(--text-error)"}},"Account Archived")))},sue=({data:e,height:t=300,plugin:r})=>{let{currency:n}=Ke(),[o,a]=(0,xt.useState)(!1);if((0,xt.useEffect)(()=>{a(!1)},[e]),!e||e.length===0)return xt.default.createElement("div",{style:{height:`${t}px`,display:"flex",alignItems:"center",justifyContent:"center"}},xt.default.createElement(et,{message:"No account data",subMessage:"Add accounts to view AUM history"}));let i=e.map(d=>d.balance),s=Math.min(...i),l=Math.max(...i),c=l-s;return l=l+c*.05,s=s-c*.1,s=0,xt.default.createElement("div",{className:"aum-chart",style:{padding:"0 10px"}},xt.default.createElement(Ia,{height:t,width:"100%"},xt.default.createElement(dS,{data:e,margin:{top:10,right:10,left:0,bottom:10}},xt.default.createElement("defs",null,xt.default.createElement("linearGradient",{id:"aumGradient",x1:"0",y1:"0",x2:"0",y2:"1"},xt.default.createElement("stop",{offset:"0%",stopColor:"#41B4F7",stopOpacity:.6}),xt.default.createElement("stop",{offset:"100%",stopColor:"#41B4F7",stopOpacity:.1})),xt.default.createElement("filter",{id:"aumShadow",height:"120%"},xt.default.createElement("feDropShadow",{dx:"0",dy:"1",stdDeviation:"2",floodOpacity:"0.1"})),xt.default.createElement("filter",{id:"aumGlow",height:"130%"},xt.default.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"2",result:"blur"}),xt.default.createElement("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7",result:"glow"}),xt.default.createElement("feComposite",{in:"SourceGraphic",in2:"glow",operator:"over"}))),xt.default.createElement($o,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),xt.default.createElement(to,{dataKey:"date",style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:8,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5}}),xt.default.createElement(ro,{tickFormatter:d=>ve(d,!0,n,!1,void 0),style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:[s,l],allowDataOverflow:!1,width:60,tickLine:!1,axisLine:!1,tickMargin:8,ticks:Kze(s,l)}),xt.default.createElement(ia,{content:xt.default.createElement(Jze,{currency:n,displayRMultiples:!1}),cursor:{fill:"var(--interactive-hover)",fillOpacity:.1,strokeOpacity:.3,strokeWidth:1,stroke:"#41B4F7"},wrapperStyle:{zIndex:1e3}}),xt.default.createElement(Tn,{y:0,stroke:"var(--text-normal)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1}),xt.default.createElement(Vc,{type:"monotone",dataKey:"balance",stroke:"none",fill:"url(#aumGradient)",fillOpacity:1,dot:!1,activeDot:!1,filter:"url(#aumShadow)"}),xt.default.createElement(Ql,{type:"monotone",dataKey:"balance",stroke:"#41B4F7",strokeWidth:2.5,onAnimationEnd:()=>a(!0),dot:d=>{let{cx:u,cy:p,payload:m}=d;return m?o?m.accountCreated?xt.default.createElement("g",null,xt.default.createElement("line",{x1:u,y1:p-15,x2:u,y2:p+15,stroke:"var(--text-success)",strokeWidth:"2"}),xt.default.createElement("circle",{cx:u,cy:p,r:"5",fill:"var(--background-primary)",stroke:"var(--text-success)",strokeWidth:"2"})):m.accountArchived?xt.default.createElement("g",null,xt.default.createElement("line",{x1:u,y1:p-15,x2:u,y2:p+15,stroke:"var(--text-error)",strokeWidth:"2"}),xt.default.createElement("circle",{cx:u,cy:p,r:"5",fill:"var(--background-primary)",stroke:"var(--text-error)",strokeWidth:"2"})):m.isDeposit?xt.default.createElement("g",null,xt.default.createElement("line",{x1:u,y1:p-15,x2:u,y2:p+15,stroke:"#41B4F7",strokeWidth:"2"}),xt.default.createElement("circle",{cx:u,cy:p,r:"5",fill:"var(--background-primary)",stroke:"#41B4F7",strokeWidth:"2"})):m.isWithdrawal?xt.default.createElement("g",null,xt.default.createElement("line",{x1:u,y1:p-15,x2:u,y2:p+15,stroke:"var(--text-warning, gold)",strokeWidth:"2"}),xt.default.createElement("circle",{cx:u,cy:p,r:"5",fill:"var(--background-primary)",stroke:"var(--text-warning, gold)",strokeWidth:"2"})):xt.default.createElement("circle",{cx:u,cy:p,r:"3",fill:"var(--text-muted)",stroke:"var(--background-primary)",strokeWidth:"1"}):xt.default.createElement("circle",{cx:0,cy:0,r:0,opacity:0}):xt.default.createElement("circle",{cx:0,cy:0,r:0,opacity:0})},activeDot:{r:7,stroke:"var(--background-primary)",strokeWidth:1,fill:"#41B4F7",filter:"url(#aumGlow)"},name:"AUM Balance"}))))}});var Vo,lue,i4=L(()=>{Vo=q(Y());Ut();rr();pt();lue=({metrics:e})=>{let{currency:t}=Ke(),r=xe(),n=e.totalGrowthAmount>=0?"positive":"negative";return Vo.default.createElement("div",{className:"dashboard-metrics"},Vo.default.createElement("div",{className:"metric-item"},Vo.default.createElement("div",{className:"metric-value"},e.totalAccounts),Vo.default.createElement("div",{className:"metric-label"},"Total Accounts")),Vo.default.createElement("div",{className:"metric-item"},Vo.default.createElement("div",{className:"metric-value"},ve(e.totalAUM,!0,t,!1,void 0)),Vo.default.createElement("div",{className:"metric-label"},"Total AUM")),Vo.default.createElement("div",{className:"metric-item"},Vo.default.createElement("div",{className:`metric-value ${n}`},ve(e.totalGrowthAmount,!0,t,!1,void 0)),Vo.default.createElement("div",{className:"metric-label"},"Total Growth")),Vo.default.createElement("div",{className:"metric-item"},Vo.default.createElement("div",{className:`metric-value ${n}`},Jn(e.totalGrowthPercent)),Vo.default.createElement("div",{className:"metric-label"},"Growth %")),Vo.default.createElement("div",{className:"metric-item"},Vo.default.createElement("div",{className:"metric-value"},ve(e.totalWithdrawals,!0,t,!1,void 0)),Vo.default.createElement("div",{className:"metric-label"},"Total Withdrawals")),Vo.default.createElement("div",{className:"metric-item"},Vo.default.createElement("div",{className:"metric-value"},e.totalTrades),Vo.default.createElement("div",{className:"metric-label"},"Total Trades")))}});var Et,Xze,Qze,BL,$L=L(()=>{Et=q(Y());Ut();lf();di();rr();pt();Xze=({account:e,onClick:t})=>{var i,s;let{currency:r}=Ke(),n=xe(),o=(s=(i=n==null?void 0:n.settings)==null?void 0:i.trade)==null?void 0:s.displayRMultiples,a=(0,Et.useMemo)(()=>{let l=rue(e.createdDate),c=e.currentBalance-e.initialBalance,d=e.initialBalance>0?c/e.initialBalance*100:0,u=c>=0?"positive":"negative",p=jL(e),m=p>=100?"complete":"",f=nue(e),g=zL(e),v="";g>=75?v="critical":g>=50?v="warning":v="safe";let h=iue(e),y=e.drawdownType!=="none"&&(e.drawdownAmount>0||e.drawdownType==="manual"&&e.currentDrawdownSnapshot),b=e.hasProfitTarget&&e.profitTarget>0,x=y?g>=100?"BREACHED":"IN PROGRESS":null,w=b?p>=100?"ACHIEVED":"IN PROGRESS":null;return{accountAge:l,growthAmount:c,growthPercent:d,growthClass:u,profitTargetProgress:p,profitTargetProgressClass:m,drawdownRemaining:f,drawdownUsed:g,drawdownProgressClass:v,totalWithdrawals:h,hasDrawdownSet:y,hasProfitTargetSet:b,drawdownStatus:x,profitTargetStatus:w}},[e.createdDate,e.currentBalance,e.initialBalance,e.profitTarget,e.hasProfitTarget,e.drawdownType,e.drawdownAmount,e.currentDrawdownSnapshot,e.metrics.maxDrawdown,e.transactions]);return Et.default.createElement("div",{className:"account-card",onClick:t},Et.default.createElement("div",{className:"account-card-header"},Et.default.createElement("div",{className:"account-identity"},Et.default.createElement("div",{className:"account-name"},e.name),Et.default.createElement("div",{className:"account-type-badge"},e.accountType)),Et.default.createElement("div",{className:"account-balance"},Et.default.createElement("div",{className:"balance-amount"},ve(e.currentBalance,!0,r,!1,void 0)),Et.default.createElement("div",{className:`balance-growth ${a.growthClass}`},ve(a.growthAmount,!0,r,!1,void 0)," (",Jn(a.growthPercent),")"))),Et.default.createElement("div",{className:"account-card-body"},Et.default.createElement("div",{className:"key-metrics"},Et.default.createElement("div",{className:"metric-item"},Et.default.createElement("div",{className:"metric-value"},e.metrics.totalTrades),Et.default.createElement("div",{className:"metric-label"},"Trades")),Et.default.createElement("div",{className:"metric-item"},Et.default.createElement("div",{className:"metric-value"},ve(a.totalWithdrawals,!0,r,!1,void 0)),Et.default.createElement("div",{className:"metric-label"},"Withdrawals")),Et.default.createElement("div",{className:"metric-item"},Et.default.createElement("div",{className:"metric-value"},a.accountAge),Et.default.createElement("div",{className:"metric-label"},"Age"))),Et.default.createElement("div",{className:"progress-section"},Et.default.createElement("div",{className:`progress-item ${e.hasProfitTarget&&e.profitTarget>0?"":"not-set"}`},Et.default.createElement("div",{className:"progress-header"},Et.default.createElement("div",{className:"progress-label-with-badge"},Et.default.createElement("span",{className:"progress-label"},"Profit Target"),a.profitTargetStatus&&Et.default.createElement("span",{className:`dashboard-status-badge ${a.profitTargetStatus==="ACHIEVED"?"achieved":"in-progress"}`},a.profitTargetStatus)),Et.default.createElement("div",{className:`progress-value ${e.hasProfitTarget&&e.profitTarget>0?"":"not-set"}`},e.hasProfitTarget&&e.profitTarget>0?Jn(a.profitTargetProgress):"Not set")),Et.default.createElement("div",{className:"progress-bar-container"},Et.default.createElement("div",{className:`progress-bar ${e.hasProfitTarget&&e.profitTarget>0&&a.profitTargetProgress>0?`profit-target ${a.profitTargetProgressClass}`:"empty"}`,style:{width:e.hasProfitTarget&&e.profitTarget>0?`${a.profitTargetProgress}%`:"0%"}}))),Et.default.createElement("div",{className:`progress-item ${e.drawdownType!=="none"&&e.drawdownAmount>0?"":"not-set"}`},Et.default.createElement("div",{className:"progress-header"},Et.default.createElement("div",{className:"progress-label-with-badge"},Et.default.createElement("span",{className:"progress-label"},"Drawdown Used"),a.drawdownStatus&&Et.default.createElement("span",{className:`dashboard-status-badge ${a.drawdownStatus==="BREACHED"?"breached":"in-progress"}`},a.drawdownStatus)),Et.default.createElement("div",{className:`progress-value ${e.drawdownType!=="none"&&e.drawdownAmount>0?"":"not-set"}`},e.drawdownType!=="none"&&e.drawdownAmount>0?Jn(a.drawdownUsed):"Not set")),Et.default.createElement("div",{className:"progress-bar-container"},Et.default.createElement("div",{className:`progress-bar ${e.drawdownType!=="none"&&e.drawdownAmount>0&&a.drawdownUsed>0?`drawdown ${a.drawdownProgressClass}`:"empty"}`,style:{width:e.drawdownType!=="none"&&e.drawdownAmount>0?`${a.drawdownUsed}%`:"0%"}})))),Et.default.createElement("div",{className:"account-card-footer"},Et.default.createElement("div",{className:"footer-metric"},Et.default.createElement("span",{className:"footer-label"},"Monthly:"),Et.default.createElement("span",{className:"footer-value"},oue(e,r))),Et.default.createElement("div",{className:"footer-metric"},Et.default.createElement("span",{className:"footer-label"},"Total Costs:"),Et.default.createElement("span",{className:"footer-value"},aue(e,r))))))},Qze=(e,t)=>{var r,n;return e.account.id===t.account.id&&e.account.name===t.account.name&&e.account.accountType===t.account.accountType&&e.account.currentBalance===t.account.currentBalance&&e.account.initialBalance===t.account.initialBalance&&e.account.metrics.totalTrades===t.account.metrics.totalTrades&&e.account.metrics.maxDrawdown===t.account.metrics.maxDrawdown&&e.account.profitTarget===t.account.profitTarget&&e.account.hasProfitTarget===t.account.hasProfitTarget&&e.account.drawdownType===t.account.drawdownType&&e.account.drawdownAmount===t.account.drawdownAmount&&((r=e.account.currentDrawdownSnapshot)==null?void 0:r.drawdownLimit)===((n=t.account.currentDrawdownSnapshot)==null?void 0:n.drawdownLimit)&&e.account.createdDate===t.account.createdDate&&e.account.transactions.length===t.account.transactions.length&&e.account.monthlyCost===t.account.monthlyCost&&e.onClick===t.onClick},BL=Et.default.memo(Xze,Qze)});var Ao,s4,cue=L(()=>{Ao=q(Y());$L();s4=Ao.default.memo(({accounts:e,openAccount:t,itemHeight:r=140,containerHeight:n=600,overscan:o=3,columns:a,minColumnWidth:i=300})=>{let[s,l]=(0,Ao.useState)(0),[c,d]=(0,Ao.useState)(0),u=(0,Ao.useRef)(null),p=(0,Ao.useMemo)(()=>a||(c===0?1:Math.max(1,Math.floor(c/i))),[a,c,i]),m=(0,Ao.useMemo)(()=>{let b=[];for(let x=0;x<e.length;x+=p)b.push(e.slice(x,x+p));return b},[e,p]),f=(0,Ao.useMemo)(()=>{let b=Math.max(0,Math.floor(s/r)-o),x=Math.ceil(n/r),w=Math.min(m.length,b+x+o*2);return{start:b,end:w}},[s,r,n,m.length,o]),g=(0,Ao.useMemo)(()=>m.slice(f.start,f.end),[m,f]),v=(0,Ao.useCallback)(()=>{u.current&&requestAnimationFrame(()=>{u.current&&l(u.current.scrollTop)})},[]),h=m.length*r,y=f.start*r;return(0,Ao.useEffect)(()=>{let b=u.current;if(!b)return;let x=new ResizeObserver(w=>{for(let S of w){let k=S.contentRect.width;d(k),v()}});return x.observe(b),d(b.clientWidth),()=>{x.disconnect()}},[v]),Ao.default.createElement("div",{ref:u,className:"virtualized-account-list",style:{height:n,overflowY:"auto",position:"relative"},onScroll:v},Ao.default.createElement("div",{style:{height:h,position:"relative"}},Ao.default.createElement("div",{style:{transform:`translateY(${y}px)`,position:"absolute",top:0,left:0,right:0}},g.map((b,x)=>Ao.default.createElement("div",{key:f.start+x,className:"account-cards",style:{marginBottom:"15px"}},b.map(w=>Ao.default.createElement(BL,{key:w.id,account:w,onClick:()=>t(w.name,w)})))))))},(e,t)=>e.accounts===t.accounts&&e.openAccount===t.openAccount&&e.itemHeight===t.itemHeight&&e.containerHeight===t.containerHeight&&e.overscan===t.overscan&&e.columns===t.columns&&e.minColumnWidth===t.minColumnWidth);s4.displayName="VirtualizedAccountList"});var yn,Zze,e_e,due,uue=L(()=>{yn=q(Y());Ut();lf();rr();pt();Zze=({type:e,accounts:t,totalAUM:r,isExcludedFromStats:n=!1})=>{let{currency:o}=Ke(),a=xe(),i=(0,yn.useMemo)(()=>_L(t,r),[t,r]),s=i.totalGrowthAmount>=0?"positive":"negative";return yn.default.createElement("div",{className:"account-type-header"},yn.default.createElement("div",{className:"account-type-name"},yn.default.createElement("h3",null,OL(e))),yn.default.createElement("div",{className:"account-type-metrics"},yn.default.createElement("div",{className:"metric-item"},yn.default.createElement("div",{className:`metric-value ${n?"excluded-status":"weight-percent"}`},n?"Excluded":Jn(i.aumWeightPercent)),yn.default.createElement("div",{className:"metric-label"},n?"From Stats":"of Total AUM")),yn.default.createElement("div",{className:"metric-item"},yn.default.createElement("div",{className:"metric-value"},ve(i.aumAmount,!0,o,!1,void 0)),yn.default.createElement("div",{className:"metric-label"},"AUM")),yn.default.createElement("div",{className:"metric-item"},yn.default.createElement("div",{className:"metric-value"},ve(i.totalWithdrawals,!0,o,!1,void 0)),yn.default.createElement("div",{className:"metric-label"},"Withdrawals")),yn.default.createElement("div",{className:"metric-item"},yn.default.createElement("div",{className:"metric-value"},i.accountCount),yn.default.createElement("div",{className:"metric-label"},"Account",i.accountCount!==1?"s":"")),yn.default.createElement("div",{className:"metric-item"},yn.default.createElement("div",{className:"metric-value"},i.totalTrades),yn.default.createElement("div",{className:"metric-label"},"Trade",i.totalTrades!==1?"s":"")),yn.default.createElement("div",{className:"metric-item"},yn.default.createElement("div",{className:`metric-value ${s}`},ve(i.totalGrowthAmount,!0,o,!1,void 0)),yn.default.createElement("div",{className:"metric-label"},"Growth (",Jn(i.totalGrowthPercent),")"))))},e_e=(e,t)=>e.type===t.type&&e.totalAUM===t.totalAUM&&e.isExcludedFromStats===t.isExcludedFromStats&&e.accounts.length===t.accounts.length&&e.accounts.every((r,n)=>{let o=t.accounts[n];return o&&r.id===o.id&&r.currentBalance===o.currentBalance&&r.initialBalance===o.initialBalance&&r.metrics.totalTrades===o.metrics.totalTrades&&r.transactions.length===o.transactions.length}),due=yn.default.memo(Zze,e_e)});var Di,t_e,r_e,n_e,pue,l4=L(()=>{Di=q(Y());$L();cue();lf();uue();eo();Ra();t_e=({type:e,accounts:t,openAccount:r,totalAUM:n=0,excludedTypes:o=[]})=>{let a=(0,Di.useMemo)(()=>[...t].sort((l,c)=>c.currentBalance-l.currentBalance),[t]),i=a.length>50,s=o.includes(e.toLowerCase());return Di.default.createElement("div",{className:"account-section"},Di.default.createElement(due,{type:e,accounts:a,totalAUM:n,isExcludedFromStats:s}),a.length===0?Di.default.createElement("div",{className:"account-section-content"},Di.default.createElement(et,{message:`No ${OL(e)} accounts`,subMessage:"Create an account to see it here",iconSize:40})):i?Di.default.createElement("div",{className:"account-section-content"},Di.default.createElement(s4,{accounts:a,openAccount:r,containerHeight:600,itemHeight:180,minColumnWidth:300})):Di.default.createElement("div",{className:"account-cards"},a.map(l=>Di.default.createElement(BL,{key:l.id,account:l,onClick:()=>r(l.name,l)}))))},r_e=Di.default.memo(t_e),n_e=({accountsByType:e,openAccount:t,plugin:r,refreshTrigger:n,totalAUM:o=0,excludedTypes:a=[]})=>{var l,c,d;let i=r||((d=(c=(l=window.app)==null?void 0:l.plugins)==null?void 0:c.plugins)==null?void 0:d.journalit),s=(0,Di.useMemo)(()=>{var h,y,b,x;let u=Object.keys(e),p=((y=(h=i==null?void 0:i.settings)==null?void 0:h.account)==null?void 0:y.accountTypeOrder)||["funded","evaluation","demo","archived"],m=((x=(b=i==null?void 0:i.optionsService)==null?void 0:b.getOptions)==null?void 0:x.call(b,"account_type"))||[],f=new Set([...u.map(w=>w.toLowerCase()),...p.map(w=>w.toLowerCase()),...m.map(w=>w.toLowerCase())]),g=new Map;u.forEach(w=>g.set(w.toLowerCase(),w)),p.forEach(w=>{if(!g.has(w.toLowerCase())){let S=w.charAt(0).toUpperCase()+w.slice(1).toLowerCase();g.set(w.toLowerCase(),S)}}),m.forEach(w=>{g.has(w.toLowerCase())||g.set(w.toLowerCase(),w)});let v=[];return p.forEach(w=>{let S=g.get(w.toLowerCase());S&&f.has(w.toLowerCase())&&(v.push(S),f.delete(w.toLowerCase()))}),f.forEach(w=>{let S=g.get(w);S&&v.push(S)}),v},[e,i,n]);return Di.default.createElement("div",{className:"account-sections"},s.map(u=>Di.default.createElement(r_e,{key:u,type:u,accounts:e[u]||[],openAccount:t,totalAUM:o,excludedTypes:a})))},pue=Di.default.memo(n_e)});function o_e(e){let t=e%WL.length,r=WL[t];if(e>=WL.length){let n=Math.max(.6,1-Math.floor(e/WL.length)*.2),o=r.replace("#",""),a=parseInt(o.substr(0,2),16),i=parseInt(o.substr(2,2),16),s=parseInt(o.substr(4,2),16);return`rgba(${a}, ${i}, ${s}, ${n})`}return r}function a_e(e){return e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()).join(" ")}function RL(e,t,r,n,o=[]){if(!e||e.length===0||n===0)return[];let a=[];return r.forEach((i,s)=>{let l=t[i]||[];if(l.length===0||o.includes(i.toLowerCase()))return;let d=_L(l,n);d.aumAmount>0&&a.push({type:i,displayName:a_e(i),aumAmount:d.aumAmount,aumWeightPercent:d.aumWeightPercent,color:o_e(s),accounts:l,metrics:d})}),a}function mue(e,t=1){let r=e.filter(m=>m.aumWeightPercent>=t),n=e.filter(m=>m.aumWeightPercent<t);if(n.length===0)return{segments:r};let o=n.reduce((m,f)=>m+f.aumAmount,0),a=n.reduce((m,f)=>m+f.aumWeightPercent,0),i=n.reduce((m,f)=>m+f.metrics.accountCount,0),s=n.reduce((m,f)=>m+f.metrics.totalTrades,0),l=n.reduce((m,f)=>m+f.metrics.totalGrowthAmount,0),c=n.reduce((m,f)=>m+f.metrics.totalWithdrawals,0),d=n.reduce((m,f)=>m+f.aumAmount-f.metrics.totalGrowthAmount,0),u=d>0?l/d*100:0,p={type:"other",displayName:"Other",aumAmount:o,aumWeightPercent:a,color:"#94a3b8",accounts:n.flatMap(m=>m.accounts),metrics:{aumAmount:o,aumWeightPercent:a,accountCount:i,totalTrades:s,totalGrowthAmount:l,totalGrowthPercent:u,totalWithdrawals:c}};return{segments:r,otherSegment:p}}var WL,c4=L(()=>{lf();WL=["#3b82f6","#7c3aed","#06b6d4","#f59e0b","#8b5cf6","#2563eb","#0ea5e9","#d97706","#6366f1","#ec4899"]});var Jc,i_e,d4,ONt,fue=L(()=>{Jc=q(Y());Ut();i_e=({data:e,dotSize:t,showPercentage:r})=>{let n={width:`${t}px`,height:`${t}px`,backgroundColor:e.color,borderRadius:"50%",flexShrink:0,border:"1px solid rgba(0, 0, 0, 0.1)",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.1)"};return Jc.default.createElement("div",{className:"account-weight-legend-item"},Jc.default.createElement("div",{className:"legend-dot",style:n,"aria-hidden":"true"}),Jc.default.createElement("span",{className:"legend-text"},Jc.default.createElement("span",{className:"legend-type-name"},e.displayName),r&&Jc.default.createElement("span",{className:"legend-percentage"},Jn(e.aumWeightPercent))))},d4=({weightData:e,className:t="",dotSize:r=12,showPercentages:n=!0,maxItemsPerRow:o=6})=>{if(!e||e.length===0)return null;let a=e,i={display:"flex",flexWrap:"wrap",gap:"8px 16px",alignItems:"center",justifyContent:"flex-start"};return Jc.default.createElement("div",{className:`account-weight-legend-container ${t}`},Jc.default.createElement("div",{className:"account-weight-legend",style:i,role:"list","aria-label":"Account type distribution legend"},a.map(s=>Jc.default.createElement("div",{key:s.type,role:"listitem","aria-label":`${s.displayName}: ${n?Jn(s.aumWeightPercent):""}`},Jc.default.createElement(i_e,{data:s,dotSize:r,showPercentage:n})))))},ONt=Jc.default.memo(d4)});var nu,s_e,u4,$Nt,gue=L(()=>{nu=q(Y());c4();fue();s_e=({data:e,minimumWidth:t=2})=>{let n={width:`${Math.max(e.aumWeightPercent,t)}%`,backgroundColor:e.color};return nu.default.createElement("div",{className:"account-weight-segment",style:n,role:"progressbar","aria-valuenow":e.aumWeightPercent,"aria-valuemin":0,"aria-valuemax":100,"aria-label":`${e.displayName}: ${e.aumWeightPercent.toFixed(1)}% of total AUM`})},u4=({accounts:e,accountsByType:t,accountTypesToDisplay:r,totalAUM:n,excludedTypes:o=[],className:a="",showLegend:i=!0,minimumSegmentWidth:s=2})=>{let l=(0,nu.useMemo)(()=>RL(e,t,r,n,o),[e,t,r,n,o]),{segments:c}=(0,nu.useMemo)(()=>mue(l,0),[l]);return c.length===0?null:nu.default.createElement("div",{className:`account-weight-bar-container ${a}`},nu.default.createElement("div",{className:"account-weight-bar",role:"progressbar","aria-label":"Account type AUM distribution"},c.map(d=>nu.default.createElement(s_e,{key:d.type,data:d,minimumWidth:s}))),i&&nu.default.createElement(d4,{weightData:l,showPercentages:!0}))},$Nt=nu.default.memo(u4)});var Jb,p4,VNt,hue=L(()=>{Jb=q(Y());gue();c4();p4=({accounts:e,accountsByType:t,accountTypesToDisplay:r,totalAUM:n,excludedTypes:o=[],className:a="",showLegend:i=!0})=>{let s=(0,Jb.useMemo)(()=>RL(e,t,r,n,o),[e,t,r,n,o]);return!s||s.length===0||n===0?null:Jb.default.createElement("div",{className:`account-type-weights ${a}`},Jb.default.createElement(u4,{accounts:e,accountsByType:t,accountTypesToDisplay:r,totalAUM:n,excludedTypes:o,showLegend:i}))},VNt=Jb.default.memo(p4)});function vue(){if(document.head.querySelector("#account-dashboard-skeleton-styles"))return;let e=document.createElement("style");e.id="account-dashboard-skeleton-styles",e.textContent=l_e,document.head.appendChild(e)}function yue(){var e;(e=document.head.querySelector("#account-dashboard-skeleton-styles"))==null||e.remove()}var l_e,bue=L(()=>{l_e=`
.account-dashboard-skeleton {
  width: 100%;
  padding: 1.5rem;
  display: flex;
  flex-direction: column;
  gap: 2rem;
  background: var(--background-primary);
}

.account-dashboard-skeleton-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-bottom: 1rem;
  border-bottom: 1px solid var(--background-modifier-border);
}

.skeleton-header-actions {
  display: flex;
  gap: 0.5rem;
}

.account-dashboard-skeleton-aum,
.account-dashboard-skeleton-weights {
  width: 100%;
}

.account-dashboard-skeleton-metrics {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1rem;
}

.skeleton-metric-card {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  padding: 1rem;
  border-radius: 8px;
  background: var(--background-secondary);
}

.account-dashboard-skeleton-sections {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.skeleton-account-cards {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 1rem;
}

.skeleton-account-card {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
  padding: 1.25rem;
  border-radius: 8px;
  background: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
}

.skeleton-account-card-metrics {
  display: flex;
  gap: 1rem;
  padding-top: 0.5rem;
  border-top: 1px solid var(--background-modifier-border-hover);
}

@media (max-width: 768px) {
  .account-dashboard-skeleton {
    padding: 1rem;
    gap: 1.5rem;
  }

  .account-dashboard-skeleton-metrics {
    grid-template-columns: 1fr;
  }

  .skeleton-account-cards {
    grid-template-columns: 1fr;
  }
}
`});var en,m4,xue=L(()=>{en=q(Y());gg();Q1();PP();bue();Kf();m4=(0,en.memo)(()=>((0,en.useLayoutEffect)(()=>(Ll(),vue(),()=>{yue()}),[]),en.default.createElement("div",{className:"account-dashboard-skeleton"},en.default.createElement("div",{className:"account-dashboard-skeleton-header"},en.default.createElement(Kt,{width:"200px",height:"28px"}),en.default.createElement("div",{className:"skeleton-header-actions"},en.default.createElement(fg,{size:32}),en.default.createElement(fg,{size:32}))),en.default.createElement("div",{className:"account-dashboard-skeleton-aum"},en.default.createElement(Ad,{type:"chart"})),en.default.createElement("div",{className:"account-dashboard-skeleton-metrics"},Array.from({length:4}).map((e,t)=>en.default.createElement("div",{key:t,className:"skeleton-metric-card"},en.default.createElement(Kt,{width:"100px",height:"14px"}),en.default.createElement(Kt,{width:"120px",height:"20px"})))),en.default.createElement("div",{className:"account-dashboard-skeleton-weights"},en.default.createElement(Ad,{type:"chart"})),en.default.createElement("div",{className:"account-dashboard-skeleton-sections"},en.default.createElement(Kt,{width:"120px",height:"18px"}),en.default.createElement("div",{className:"skeleton-account-cards"},Array.from({length:3}).map((e,t)=>en.default.createElement("div",{key:t,className:"skeleton-account-card"},en.default.createElement(Kt,{width:"150px",height:"16px"}),en.default.createElement(Kt,{width:"100px",height:"24px"}),en.default.createElement("div",{className:"skeleton-account-card-metrics"},en.default.createElement(Kt,{width:"60px",height:"12px"}),en.default.createElement(Kt,{width:"60px",height:"12px"})))))))));m4.displayName="AccountDashboardSkeleton"});var wue,xh,UL=L(()=>{wue=q(Y()),xh=({ariaLabel:e,className:t="",children:r,...n})=>{let a=["journalit-icon-button",t].filter(Boolean).join(" ");return wue.default.createElement("button",{className:a,"aria-label":e,type:"button","data-tooltip":e,...n},r)}});var Ar,kue,c_e,Sue,Ds,pp=L(()=>{Ar=q(Y());Ut();kue=(0,Ar.createContext)(null),c_e=5e3,Sue=({app:e,accountPageService:t,accountName:r,plugin:n,children:o})=>{let[a,i]=(0,Ar.useState)(null),[s,l]=(0,Ar.useState)(!1),[c,d]=(0,Ar.useState)(!1),[u,p]=(0,Ar.useState)(null),[m,f]=(0,Ar.useState)(0),[g,v]=(0,Ar.useState)({}),h=(0,Ar.useRef)(!1),y=(0,Ar.useRef)(r),b=(0,Ar.useRef)(r),x=(0,Ar.useRef)(g),w=(0,Ar.useRef)(g);Ar.default.useEffect(()=>{y.current=r,x.current=g},[r,g]);let S=(0,Ar.useCallback)((I,A)=>{var F,M,_,W,$,H,R,V,Z,K,X,G,U,Q,J,ee,te;let j=((M=(F=I.dateRange)==null?void 0:F[0])==null?void 0:M.getTime())!==((W=(_=A.dateRange)==null?void 0:_[0])==null?void 0:W.getTime())||((H=($=I.dateRange)==null?void 0:$[1])==null?void 0:H.getTime())!==((V=(R=A.dateRange)==null?void 0:R[1])==null?void 0:V.getTime()),E=(((Z=I.instruments)==null?void 0:Z.length)||0)!==(((K=A.instruments)==null?void 0:K.length)||0)||((X=I.instruments)==null?void 0:X.some((ue,be)=>{var Le;return ue!==((Le=A.instruments)==null?void 0:Le[be])})),N=(((G=I.setups)==null?void 0:G.length)||0)!==(((U=A.setups)==null?void 0:U.length)||0)||((Q=I.setups)==null?void 0:Q.some((ue,be)=>{var Le;return ue!==((Le=A.setups)==null?void 0:Le[be])})),B=(((J=I.directions)==null?void 0:J.length)||0)!==(((ee=A.directions)==null?void 0:ee.length)||0)||((te=I.directions)==null?void 0:te.some((ue,be)=>{var Le;return ue!==((Le=A.directions)==null?void 0:Le[be])})),C=I.reviewed!==A.reviewed;return j||E||N||B||C},[]),k=(0,Ar.useCallback)((I=c_e)=>Date.now()-m<I,[m]),T=(0,Ar.useCallback)(async(I=!1)=>{if(h.current)return;let A=b.current!==y.current,j=S(w.current,x.current);if(!(!I&&!A&&!j&&k())){b.current=y.current,w.current=x.current,h.current=!0,l(!0),p(null);try{I&&await t.refreshAccountData(y.current);let E=await t.getAccountPageData(y.current);i(E),f(Date.now()),d(!1)}catch(E){console.error("Error fetching account page data:",E),p(E instanceof Error?E:new Error("Failed to fetch account page data"))}finally{l(!1),d(!1),h.current=!1}}},[t,k,S]),P=(0,Ar.useCallback)(I=>{v(I),S(x.current,I)&&d(!0)},[S]),D=(0,Ar.useCallback)(()=>{if(!(a!=null&&a.trades))return[];let I=a.trades;return g.dateRange&&(g.dateRange[0]||g.dateRange[1])&&(I=I.filter(A=>{let j;try{if(A.entryTime instanceof Date)j=A.entryTime;else if(j=new Date(A.entryTime),isNaN(j.getTime()))return!1}catch(E){return console.error("Error parsing trade entry time:",E,A.entryTime),!1}return!(g.dateRange[0]&&j<g.dateRange[0]||g.dateRange[1]&&j>g.dateRange[1])})),g.instruments&&g.instruments.length>0&&(I=I.filter(A=>g.instruments.includes(A.instrument))),g.setups&&g.setups.length>0&&(I=I.filter(A=>A.setup.some(j=>g.setups.includes(j)))),g.directions&&g.directions.length>0&&(I=I.filter(A=>g.directions.includes(A.direction))),g.reviewed!==void 0&&(I=I.filter(A=>A.reviewed===g.reviewed)),I.sort((A,j)=>{let E=A.entryTime instanceof Date?A.entryTime:new Date(A.entryTime);return(j.entryTime instanceof Date?j.entryTime:new Date(j.entryTime)).getTime()-E.getTime()}),I},[a,g]),O=(0,Ar.useCallback)(()=>{var U,Q;if(!a)return null;let I=D();if(I.length===a.trades.length)return a.metrics;if(I.length===0)return{totalTrades:0,winningTrades:0,losingTrades:0,winRate:0,totalPnL:0,avgWin:0,avgLoss:0,avgWinRMultiple:void 0,avgLossRMultiple:void 0,profitFactor:0,totalCommission:0,totalSwap:0,totalFees:0};let A=I.length,j=I.reduce((J,ee)=>J+ee.commission,0),E=I.reduce((J,ee)=>J+ee.swap,0),N=I.reduce((J,ee)=>J+ee.fees,0),B=I.reduce((J,ee)=>{var ue;let te=(ue=ee.pnl)!=null?ue:0;return J+te},0),C=I.filter(J=>{var te;return((te=J.pnl)!=null?te:0)>0}),F=I.filter(J=>{var te;return((te=J.pnl)!=null?te:0)<0}),M=A>0?C.length/A*100:0,_=C.reduce((J,ee)=>{var ue;let te=(ue=ee.pnl)!=null?ue:0;return J+te},0),W=Math.abs(F.reduce((J,ee)=>{var ue;let te=(ue=ee.pnl)!=null?ue:0;return J+te},0)),$=C.length>0?_/C.length:0,H=F.length>0?W/F.length:0,R=(Q=(U=n==null?void 0:n.settings)==null?void 0:U.trade)==null?void 0:Q.defaultRiskAmount,V=C.map(J=>st(J.pnl,J.rMultiple,J.riskAmount,R)).filter(J=>J!==void 0),Z=V.length>0?V.reduce((J,ee)=>J+ee,0)/V.length:void 0,K=F.map(J=>st(J.pnl,J.rMultiple,J.riskAmount,R)).filter(J=>J!==void 0),X=K.length>0?K.reduce((J,ee)=>J+Math.abs(ee),0)/K.length:void 0,G=0;return W>0?G=_/W:_>0?G=999:G=0,{totalTrades:A,winningTrades:C.length,losingTrades:F.length,winRate:M,totalPnL:B,avgWin:$,avgLoss:H,avgWinRMultiple:Z,avgLossRMultiple:X,profitFactor:G,totalCommission:j,totalSwap:E,totalFees:N}},[a,D,n]);Ar.default.useEffect(()=>{let I=async A=>{setTimeout(async()=>{e.workspace.trigger("layout-change"),await new Promise(j=>setTimeout(j,100)),await T(!0)},600)};return document.addEventListener("journalit:trade-data-changed",I),document.addEventListener("journalit:missed-trade-data-changed",I),()=>{document.removeEventListener("journalit:trade-data-changed",I),document.removeEventListener("journalit:missed-trade-data-changed",I)}},[T,e]),Ar.default.useEffect(()=>{let I=b.current!==r,A=S(w.current,g);(I||A)&&d(!0);let j=setTimeout(()=>{T()},100);return()=>clearTimeout(j)},[r,g,T,S]),Ar.default.useEffect(()=>{r&&t&&T()},[r,t,T]);let z=(0,Ar.useMemo)(()=>({accountPageData:a,isLoading:s,isStale:c,error:u,accountName:r,filters:g,refreshData:()=>T(!0),setFilters:P,lastFetchTime:m,isCacheValid:k,getFilteredTrades:D,getMetrics:O}),[a,s,c,u,r,g,T,P,m,k,D,O]);return Ar.default.createElement(kue.Provider,{value:z},o)},Ds=()=>{let e=(0,Ar.useContext)(kue);if(!e)throw new Error("useAccountPageData must be used within an AccountPageDataProvider");return e}});var Tue,Es,f4=L(()=>{Tue=q(Y()),Es=({label:e,className:t="",children:r,...n})=>{let a=["journalit-no-tooltip-button",t].filter(Boolean).join(" ");return Tue.default.createElement("button",{className:a,"data-label":e,"aria-label":e,type:"button",...n},r)}});var cf,d_e,wh,g4=L(()=>{cf=q(Y()),d_e=({checked:e,onChange:t,id:r,ariaLabel:n,disabled:o=!1,label:a,className:i=""})=>{let s=f=>{o||t(f.target.checked)},l=r||`checkbox-${Math.random().toString(36).substring(2,9)}`,c={display:"inline-flex",alignItems:"center",gap:"8px",cursor:o?"not-allowed":"pointer",opacity:o?.6:1,userSelect:"none"},d={position:"absolute",opacity:0,width:0,height:0,margin:0,padding:0},u={display:"inline-flex",alignItems:"center",justifyContent:"center",width:"16px",height:"16px",border:"1px solid var(--background-modifier-border)",borderRadius:"3px",backgroundColor:e?"var(--interactive-accent)":"var(--background-primary)",borderColor:e?"var(--interactive-accent)":"var(--background-modifier-border)",transition:"background-color 0.2s ease, border-color 0.2s ease",cursor:o?"not-allowed":"pointer",flexShrink:0},p={display:"flex",alignItems:"center",gap:"8px",cursor:o?"not-allowed":"pointer",fontSize:"13px",fontWeight:500,color:o?"var(--text-muted)":"var(--text-normal)"},m={color:o?"var(--text-muted)":"var(--text-normal)",fontSize:"13px",fontWeight:500};return cf.default.createElement("div",{style:c,className:`jl-checkbox-wrapper ${i}`},cf.default.createElement("input",{type:"checkbox",id:l,style:d,checked:e,onChange:s,"aria-label":n||a,disabled:o}),cf.default.createElement("label",{htmlFor:l,style:p},cf.default.createElement("div",{className:`jl-checkbox ${e?"jl-checkbox-checked":""}`,style:u},e&&cf.default.createElement("svg",{width:"10",height:"8",viewBox:"0 0 10 8",fill:"none",style:{color:"var(--text-on-accent)",display:"block",pointerEvents:"none"}},cf.default.createElement("path",{d:"M8.5 1L3.5 6L1.5 4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}))),a&&cf.default.createElement("span",{style:m},a)))},wh=d_e});function p_e(){if(document.getElementById("journalit-folder-browser-styles"))return;let e=document.createElement("style");e.id="journalit-folder-browser-styles",e.textContent=u_e,document.head.appendChild(e)}function Cue(){document.getElementById("journalit-folder-browser-styles")||p_e()}var u_e,Pue=L(()=>{u_e=`
/**
 * FolderBrowser component styles
 * Based on ComboBox styling patterns but adapted for folder tree structure
 */

/* Base FolderBrowser container */
.folder-browser-container {
  position: relative;
  width: 100%;
  margin-bottom: 8px;
}

/* Input container */
.folder-browser-container .input-container {
  position: relative;
  width: 100%;
}

/* Add dropdown indicator with CSS pseudo-element */
.folder-browser-container .input-container::after {
  content: "";
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  width: 0;
  height: 0;
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
  border-top: 5px solid var(--text-normal, #333);
  pointer-events: none;
  transition: transform 0.15s ease;
  will-change: transform;
}

/* Rotate caret when dropdown is open */
[data-is-open="true"] .folder-browser-container .input-container::after {
  transform: translateY(-50%) rotate(180deg);
}

/* FolderBrowser input */
.folder-browser-input {
  position: relative;
  z-index: 1;
  width: 100%;
  padding: 8px 12px;
  padding-right: 30px;
  border: 1px solid var(--background-modifier-border, #ddd);
  border-radius: 4px;
  background-color: var(--background-primary, #fff);
  color: var(--text-normal, #333);
  font-size: 14px;
  transition: border-color 0.15s ease;
}

/* Focus state */
.folder-browser-input:focus {
  border-color: var(--interactive-accent, #5183e4);
  box-shadow: 0 0 0 2px rgba(83, 141, 226, 0.3);
  outline: none;
}

/* Dropdown when open */
.folder-browser-dropdown {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  margin-top: -1px;
  z-index: 9999;
  background-color: var(--background-primary, #fff);
  border: 1px solid var(--background-modifier-border, #ddd);
  border-top: none;
  border-radius: 0 0 4px 4px;
  max-height: 200px;
  overflow-y: auto;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
  transition: opacity 0.15s ease, transform 0.15s ease;
  transform-origin: top center;
  will-change: transform, opacity;
  animation: folder-browser-dropdown-open 0.15s ease forwards;
}

@keyframes folder-browser-dropdown-open {
  from {
    opacity: 0;
    transform: translateY(-5px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Folder item in dropdown */
.folder-browser-item {
  padding: 8px 12px;
  cursor: pointer;
  margin: 0;
  background-color: var(--background-primary, #fff);
  color: var(--text-normal, #333);
  font-size: 14px;
  line-height: 1.5;
  border-bottom: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1));
  transition: background-color 0.15s ease;
  display: flex;
  align-items: center;
}

.folder-browser-item.highlighted,
.folder-browser-item:hover {
  background-color: var(--background-secondary, #f5f5f5);
}

/* Folder indentation */
.folder-indent {
  flex-shrink: 0;
}

/* Folder toggle button */
.folder-toggle {
  background: none;
  border: none;
  cursor: pointer;
  padding: 2px;
  margin-right: 4px;
  font-size: 12px;
  color: var(--text-muted, #666);
  transition: color 0.15s ease;
  flex-shrink: 0;
}

.folder-toggle:hover {
  color: var(--text-normal, #333);
}

/* Folder icon */
.folder-icon {
  margin-right: 6px;
  font-size: 14px;
  flex-shrink: 0;
}

/* Folder name */
.folder-name {
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* Error state */
.folder-browser-input.error {
  border-color: var(--text-error, #e53935);
}

/* When dropdown is open, modify input border-radius */
[data-is-open="true"] .folder-browser-input {
  border-bottom-left-radius: 0;
  border-bottom-right-radius: 0;
}
`});var St,BS,Xc,m_e,VL,h4=L(()=>{St=q(Y()),BS=require("obsidian");Pue();Xc={FOLDER_BROWSER_CONTAINER:"folder-browser-container",INPUT_CONTAINER:"input-container",INPUT:"folder-browser-input",DROPDOWN:"folder-browser-dropdown",FOLDER_ITEM:"folder-browser-item",FOLDER_ITEM_HIGHLIGHTED:"highlighted",FOLDER_INDENT:"folder-indent",FOLDER_TOGGLE:"folder-toggle",FOLDER_ICON:"folder-icon",FOLDER_NAME:"folder-name",CLEAR_BUTTON:"folder-browser-clear-button"},m_e=e=>({backgroundColor:e?"var(--background-secondary)":"var(--background-primary)"}),VL=({selectedPath:e="",onChange:t,placeholder:r="Select a folder...",label:n,error:o,helperText:a,required:i=!1,app:s})=>{let l=(0,St.useId)(),c=`folder-browser-${l}`,d=`folder-browser-list-${l}`,u=`helper-${l}`,p=`error-${l}`,[m,f]=(0,St.useState)(e),[g,v]=(0,St.useState)(!1),[h,y]=(0,St.useState)(-1),[b,x]=(0,St.useState)(new Set),w=(0,St.useRef)(null),S=(0,St.useRef)(null),k=(0,St.useRef)(!1),T=(0,St.useCallback)(()=>{let M=[],_=H=>{!H.name.startsWith(".")&&H.name.toLowerCase()!=="!journalit"&&(M.push(H),H.children.forEach(R=>{R instanceof BS.TFolder&&_(R)}))};return s.vault.getRoot().children.forEach(H=>{H instanceof BS.TFolder&&_(H)}),M},[s]),P=(0,St.useCallback)(()=>{let M=T(),_=[],W=(H,R=0)=>{let V=H.path,Z=H.children.some(X=>X instanceof BS.TFolder&&!X.name.startsWith(".")&&X.name.toLowerCase()!=="!journalit"),K=b.has(V);_.push({folder:H,path:V,depth:R,isExpanded:K,hasChildren:Z}),K&&Z&&H.children.filter(X=>X instanceof BS.TFolder&&!X.name.startsWith(".")&&X.name.toLowerCase()!=="!journalit").forEach(X=>{W(X,R+1)})};return M.filter(H=>H.parent===s.vault.getRoot()).sort((H,R)=>H.name.localeCompare(R.name)).forEach(H=>W(H)),_},[T,b,s]),D=(0,St.useMemo)(()=>P(),[P]),O=(0,St.useMemo)(()=>{if(!m.trim())return D;let M=m.toLowerCase();return D.filter(_=>_.path.toLowerCase().includes(M)||_.folder.name.toLowerCase().includes(M))},[D,m]),z=(0,St.useCallback)(M=>{f(M.target.value),v(!0),y(-1)},[]),I=(0,St.useCallback)(M=>{f(M),t(M),v(!1),y(-1)},[t]),A=(0,St.useCallback)((M,_)=>{_.preventDefault(),_.stopPropagation(),x(W=>{let $=new Set(W);return $.has(M)?$.delete(M):$.add(M),$})},[]),j=(0,St.useCallback)(()=>{f(""),t(""),v(!1)},[t]);(0,St.useEffect)(()=>{let M=_=>{var H,R;let W=_.target,$=(H=W==null?void 0:W.closest)==null?void 0:H.call(W,'[data-folder-item="true"]');if($&&((R=w.current)!=null&&R.contains(W))){if(W.closest('[data-folder-toggle="true"]'))return;k.current=!0;let Z=$.getAttribute("data-folder-path");Z&&I(Z),setTimeout(()=>{k.current=!1},50)}};return document.addEventListener("mousedown",M,!0),()=>{document.removeEventListener("mousedown",M,!0)}},[I]),(0,St.useEffect)(()=>{if(!g)return;let M=_=>{var H;let W=_.target;((H=w.current)==null?void 0:H.contains(W))||v(!1)};return document.addEventListener("mousedown",M,!0),()=>{document.removeEventListener("mousedown",M,!0)}},[g]),(0,St.useEffect)(()=>{if(!g)return;let M=_=>{_.key==="Escape"&&v(!1)};return document.addEventListener("keydown",M,!0),()=>{document.removeEventListener("keydown",M,!0)}},[g]);let E=(0,St.useCallback)(M=>{let _=O.length;switch(M.key){case"ArrowDown":M.preventDefault(),v(!0),y(W=>(W+1)%_);break;case"ArrowUp":M.preventDefault(),v(!0),y(W=>(W-1+_)%_);break;case"Enter":if(M.preventDefault(),h>=0&&h<O.length)I(O[h].path);else{let W=m.trim();W!==e&&t(W),v(!1)}break;case"Escape":v(!1);break}},[O,g,h,I,m,e,t]),N=(0,St.useCallback)(()=>{v(!0)},[]),B=(0,St.useCallback)(M=>{var _;k.current||(_=w.current)!=null&&_.contains(M.relatedTarget)||setTimeout(()=>{if(!k.current){v(!1),y(-1);let W=m.trim();W!==e&&t(W)}},100)},[m,e,t]),C=(0,St.useCallback)(M=>{M.preventDefault(),M.stopPropagation(),v(!0),S.current&&S.current.focus()},[]),F=(0,St.useMemo)(()=>O.map((M,_)=>St.default.createElement("li",{key:M.path,role:"option","aria-selected":h===_,className:`${Xc.FOLDER_ITEM} ${h===_?Xc.FOLDER_ITEM_HIGHLIGHTED:""}`,style:m_e(h===_),onMouseEnter:()=>y(_),"data-folder-item":"true","data-folder-path":M.path},St.default.createElement("div",{style:{display:"flex",alignItems:"center"}},St.default.createElement("div",{className:Xc.FOLDER_INDENT,style:{width:`${M.depth*16}px`}}),M.hasChildren&&St.default.createElement("button",{type:"button",className:Xc.FOLDER_TOGGLE,onClick:W=>A(M.path,W),"data-folder-toggle":"true",style:{background:"none",border:"none",cursor:"pointer",padding:"2px",marginRight:"4px",fontSize:"12px",color:"var(--text-muted)"}},M.isExpanded?"\u25BC":"\u25B6"),St.default.createElement("span",{className:Xc.FOLDER_ICON,style:{marginRight:"6px",fontSize:"14px"}},"\u{1F4C1}"),St.default.createElement("span",{className:Xc.FOLDER_NAME},M.folder.name||"Root")))),[O,h,A]);return(0,St.useEffect)(()=>{f(e)},[e]),(0,St.useEffect)(()=>{Cue()},[]),St.default.createElement("div",{ref:w,className:Xc.FOLDER_BROWSER_CONTAINER,style:{position:"relative",width:"100%",marginBottom:"8px"}},n&&St.default.createElement("label",{htmlFor:c,style:{display:"block",marginBottom:"4px"}},n,i&&St.default.createElement("span",{style:{color:"var(--text-error)"}},"*")),St.default.createElement("div",{className:Xc.INPUT_CONTAINER,style:{position:"relative",width:"100%"}},St.default.createElement("input",{ref:S,id:c,type:"text",value:m,onChange:z,onFocus:N,onBlur:B,onClick:C,onKeyDown:E,placeholder:r,"aria-expanded":g,"aria-autocomplete":"list","aria-controls":g?d:void 0,"aria-activedescendant":h>=0?`folder-${h}`:void 0,"aria-invalid":!!o,"aria-describedby":o?p:a?u:void 0,role:"combobox",className:Xc.INPUT,style:{width:"100%",padding:"8px 12px",paddingRight:"30px",border:"1px solid var(--background-modifier-border, #ddd)",borderRadius:"4px",backgroundColor:"var(--background-primary, #fff)",color:"var(--text-normal, #333)",fontSize:"14px"}}),e&&St.default.createElement("button",{type:"button",className:Xc.CLEAR_BUTTON,onClick:j,title:"Clear to use default location",style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"var(--text-muted)",fontSize:"16px"}},"\xD7"),St.default.createElement("div",{style:{position:"absolute",right:e?"32px":"12px",top:"50%",transform:`translateY(-50%) ${g?"rotate(180deg)":""}`,width:"0",height:"0",borderLeft:"5px solid transparent",borderRight:"5px solid transparent",borderTop:"5px solid var(--text-normal, #333)",pointerEvents:"none",transition:"transform 0.15s ease"}}),g&&O.length>0&&St.default.createElement("ul",{id:d,role:"listbox",className:Xc.DROPDOWN,style:{position:"absolute",top:"100%",left:"0",right:"0",marginTop:"-1px",zIndex:9999,backgroundColor:"var(--background-primary, #fff)",border:"1px solid var(--background-modifier-border, #ddd)",borderTop:"none",borderRadius:"0 0 4px 4px",maxHeight:"200px",overflowY:"auto",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.15)",margin:0,padding:0,listStyle:"none"}},F)),o&&St.default.createElement("div",{id:p,role:"alert",style:{color:"var(--text-error)",fontSize:"12px",marginTop:"4px"}},o),!o&&a&&St.default.createElement("div",{id:u,style:{color:"var(--text-muted)",fontSize:"12px",marginTop:"4px"}},a))};VL.displayName="FolderBrowser"});var ou=L(()=>{Nr();UL();f4();sO();g4();h4()});var ut,Xb,Due,v4,Eue=L(()=>{ut=q(Y()),Xb=require("obsidian");Nr();wt();Ut();Pl();Due=function({app:t,snapshots:r,onSave:n}){let[o,a]=(0,ut.useState)(!1),[i,s]=(0,ut.useState)([...r].filter(T=>T&&T.date).sort((T,P)=>{let D=Mt(T.date),O=Mt(P.date);return((O==null?void 0:O.getTime())||0)-((D==null?void 0:D.getTime())||0)})),[l,c]=(0,ut.useState)(null),[d,u]=(0,ut.useState)(""),[p,m]=(0,ut.useState)(""),[f,g]=(0,ut.useState)(""),[v,h]=(0,ut.useState)(""),y=()=>{u(""),m(""),g(""),c(null),h("")},b=T=>{let P=i[T],D=P.date instanceof Date?P.date:new Date(P.date),O=D.getFullYear(),z=String(D.getMonth()+1).padStart(2,"0"),I=String(D.getDate()).padStart(2,"0");u(`${O}-${z}-${I}`),m(P.drawdownLimit.toString()),g(P.note||""),c(T),h("")},x=T=>{let P=i[T],D=P.date instanceof Date?P.date:new Date(P.date),O=tr(),z=rt(D,O);new v4(t,z,P.drawdownLimit,()=>{let I=i.filter((A,j)=>j!==T);s(I),n(I),l===T&&y(),new Xb.Notice("Snapshot deleted")}).open()},w=()=>{if(h(""),!d)return h("Date is required"),!1;let T=d.split("-").map(N=>parseInt(N,10));if(T.length!==3||T.some(N=>isNaN(N)))return h("Please enter a valid date"),!1;let P=new Date(T[0],T[1]-1,T[2]);if(P.getFullYear()!==T[0]||P.getMonth()!==T[1]-1||P.getDate()!==T[2])return h("Please enter a valid date"),!1;let D=new Date;if(D.setHours(23,59,59,999),P>D)return h("Date cannot be in the future"),!1;if(!p||p.trim()==="")return h("Drawdown limit is required"),!1;let O=parseFloat(p);if(isNaN(O)||O<=0)return h("Drawdown limit must be a positive number"),!1;let z=P.getFullYear(),I=String(P.getMonth()+1).padStart(2,"0"),A=String(P.getDate()).padStart(2,"0"),j=`${z}-${I}-${A}`;return i.findIndex((N,B)=>{if(l!==null&&B===l)return!1;let C=N.date instanceof Date?N.date:new Date(N.date),F=C.getFullYear(),M=String(C.getMonth()+1).padStart(2,"0"),_=String(C.getDate()).padStart(2,"0");return`${F}-${M}-${_}`===j})!==-1?(h("A snapshot already exists for this date. Please choose a different date or edit the existing one."),!1):!0},S=()=>{if(!w())return;let T=Mt(d);if(!T){h("Invalid date format");return}T.setHours(0,0,0,0);let P={date:T,drawdownLimit:parseFloat(p),note:f.trim()||void 0},D;l!==null?(D=[...i],D[l]=P,new Xb.Notice("Snapshot updated")):(D=[...i,P],new Xb.Notice("Snapshot added")),D.sort((O,z)=>{let I=Mt(O.date),A=Mt(z.date);return((A==null?void 0:A.getTime())||0)-((I==null?void 0:I.getTime())||0)}),s(D),n(D),y()},k=tr();return ut.default.createElement("div",{className:"manual-drawdown-manager"},i.length>0&&ut.default.createElement("div",{className:"snapshots-list-section"},ut.default.createElement("h3",{className:"section-header"},"Recorded Snapshots"),ut.default.createElement("div",{className:"snapshots-table"},ut.default.createElement("table",null,ut.default.createElement("thead",null,ut.default.createElement("tr",null,ut.default.createElement("th",null,"Date"),ut.default.createElement("th",null,"Drawdown Limit"),ut.default.createElement("th",null,"Note"),ut.default.createElement("th",null,"Actions"))),ut.default.createElement("tbody",null,i.map((T,P)=>{let D=T.date instanceof Date?T.date:new Date(T.date),O=l===P;return ut.default.createElement("tr",{key:P,className:O?"editing":""},ut.default.createElement("td",null,rt(D,k)),ut.default.createElement("td",null,"$",T.drawdownLimit.toLocaleString()),ut.default.createElement("td",{className:"note-cell"},T.note||"\u2014"),ut.default.createElement("td",{className:"actions-cell"},ut.default.createElement(he,{variant:"secondary",size:"small",onClick:()=>b(P),disabled:o},O?"Editing":"Edit"),ut.default.createElement(he,{variant:"danger",size:"small",onClick:()=>x(P),disabled:o},"Delete")))}))))),ut.default.createElement("div",{className:"snapshot-form-section"},ut.default.createElement("h3",{className:"section-header"},l!==null?"Edit Snapshot":"Add New Snapshot"),v&&ut.default.createElement("div",{className:"validation-error",style:{color:"var(--text-error)",backgroundColor:"var(--background-secondary-alt)",padding:"8px",borderRadius:"4px",marginBottom:"1rem",fontSize:"13px",whiteSpace:"normal"}},v),ut.default.createElement("div",{className:"setting-item two-column"},ut.default.createElement("div",{className:"column"},ut.default.createElement("div",{className:"setting-item-info"},ut.default.createElement("div",{className:"setting-item-name"},"Drawdown Date *"),ut.default.createElement("div",{className:"setting-item-description"},"When the broker issued this limit")),ut.default.createElement("div",{className:"setting-item-control"},ut.default.createElement("div",{style:{display:"flex",alignItems:"center",position:"relative"}},ut.default.createElement(ji,{label:"",value:d?new Date(d):void 0,onChange:T=>{if(T instanceof Date){let P=T.getFullYear(),D=String(T.getMonth()+1).padStart(2,"0"),O=String(T.getDate()).padStart(2,"0");u(`${P}-${D}-${O}`)}else u(typeof T=="string"?T.split("T")[0]:"");h("")},includeTime:!1,required:!0,disabled:o,placeholder:k})))),ut.default.createElement("div",{className:"column"},ut.default.createElement("div",{className:"setting-item-info"},ut.default.createElement("div",{className:"setting-item-name"},"Minimum Balance ($) *"),ut.default.createElement("div",{className:"setting-item-description"},"Lowest balance allowed")),ut.default.createElement("div",{className:"setting-item-control"},ut.default.createElement("input",{type:"number",value:p,onChange:T=>{m(T.target.value),h("")},placeholder:"0",min:"0",step:"0.01",disabled:o,style:{width:"100%",padding:"6px 8px",borderRadius:"4px",border:"1px solid var(--background-secondary-alt)",backgroundColor:"var(--background-secondary)",color:"var(--text-normal)"}})))),ut.default.createElement("div",{className:"setting-item"},ut.default.createElement("div",{className:"setting-item-info"},ut.default.createElement("div",{className:"setting-item-name"},"Note (Optional)"),ut.default.createElement("div",{className:"setting-item-description"},"Additional context for this snapshot")),ut.default.createElement("div",{className:"setting-item-control"},ut.default.createElement("input",{type:"text",value:f,onChange:T=>{g(T.target.value)},placeholder:"e.g., End of month statement",disabled:o}))),ut.default.createElement("div",{className:"form-buttons"},ut.default.createElement(he,{variant:"primary",onClick:S,disabled:o},l!==null?"Update Snapshot":"Add Snapshot"),l!==null&&ut.default.createElement(he,{variant:"secondary",onClick:y,disabled:o},"Cancel Edit"))),ut.default.createElement("style",null,`
        .save-accent {
          background-color: var(--interactive-accent) !important;
          color: var(--text-on-accent) !important;
          border-color: var(--interactive-accent) !important;
        }

        .manual-drawdown-manager {
          padding: 1rem 0;
          display: flex;
          flex-direction: column;
          gap: 2rem;
        }

        .section-header {
          margin: 0 0 1rem 0;
          font-size: 1.1em;
          font-weight: 600;
          color: var(--text-normal);
        }

        .snapshots-list-section {
          margin-bottom: 1rem;
        }

        .empty-state {
          padding: 2rem;
          text-align: center;
          background: var(--background-secondary);
          border-radius: 8px;
          border: 1px dashed var(--background-modifier-border);
        }

        .empty-state p {
          margin: 0.5rem 0;
          color: var(--text-muted);
        }

        .empty-state p:first-child {
          font-weight: 500;
          color: var(--text-normal);
        }

        .snapshots-table {
          overflow-x: auto;
          border: 1px solid var(--background-modifier-border);
          border-radius: 8px;
        }

        .snapshots-table table {
          width: 100%;
          border-collapse: collapse;
        }

        .snapshots-table th {
          background: var(--background-secondary);
          padding: 0.75rem;
          text-align: left;
          font-weight: 600;
          color: var(--text-normal);
          border-bottom: 2px solid var(--background-modifier-border);
        }

        .snapshots-table td {
          padding: 0.75rem;
          border-bottom: 1px solid var(--background-modifier-border);
          color: var(--text-normal);
        }

        .snapshots-table tbody tr:last-child td {
          border-bottom: none;
        }

        .snapshots-table tbody tr:hover {
          background: var(--background-secondary-alt);
        }

        .snapshots-table tbody tr.editing {
          background: var(--background-modifier-hover);
          outline: 2px solid var(--interactive-accent);
          outline-offset: -2px;
        }

        .note-cell {
          color: var(--text-muted);
          font-style: italic;
          max-width: 200px;
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
        }

        .actions-cell {
          display: flex;
          gap: 0.5rem;
        }

        .snapshot-form-section {
          background: var(--background-secondary);
          padding: 1.5rem;
          border-radius: 8px;
        }

        .validation-error {
          padding: 0.75rem;
          margin-bottom: 1rem;
          background: var(--background-modifier-error);
          border: 1px solid var(--text-error);
          border-radius: 6px;
          color: var(--text-error);
          font-weight: 500;
        }

        .setting-item {
          margin-bottom: 1.5rem;
          display: flex;
          align-items: center;
          gap: 1rem;
          white-space: normal;
          word-wrap: break-word;
        }

        .setting-item.two-column {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 1rem;
        }

        .setting-item.two-column .column {
          display: flex;
          flex-direction: column;
        }

        .setting-item.two-column .setting-item-info {
          margin-bottom: 0.5rem;
        }

        .setting-item .setting-item-info {
          flex-shrink: 0;
          width: 180px;
          margin-bottom: 0;
          display: flex;
          flex-direction: column;
          gap: 0.25rem;
        }

        .setting-item .setting-item-control {
          flex: 1;
        }

        /* Higher specificity to override global .edit-account-form .setting-item styles */
        .edit-account-form .manual-drawdown-manager .setting-item {
          display: flex !important;
          flex-direction: row !important;
          gap: 1rem !important;
        }

        .edit-account-form .manual-drawdown-manager .setting-item-control {
          flex: 1;
          min-width: 100px;
        }

        .edit-account-form .manual-drawdown-manager .setting-item-info {
          max-width: 180px;
          flex-shrink: 1;
          min-width: 120px;
        }

        .setting-item-name {
          font-weight: 600;
          color: var(--text-normal);
          margin-bottom: 0;
          white-space: nowrap;
        }

        .setting-item-description {
          font-size: 0.9em;
          color: var(--text-muted);
          display: inline;
        }

        .setting-item-control input {
          width: 100%;
          padding: 0.5rem;
          border: 1px solid var(--background-modifier-border);
          border-radius: 4px;
          background: var(--background-primary);
          color: var(--text-normal);
        }

        .setting-item-control input:focus {
          outline: 2px solid var(--interactive-accent);
          outline-offset: -1px;
        }

        .form-buttons {
          display: flex;
          gap: 0.5rem;
          margin-top: 1rem;
        }

      `))},v4=class extends Xb.Modal{constructor(r,n,o,a){super(r);this.snapshotDate=n;this.drawdownLimit=o;this.onConfirm=a}onOpen(){let{contentEl:r}=this;r.createEl("h3",{text:"Delete Snapshot?"});let n=r.createDiv({cls:"delete-confirmation-info"});n.createEl("p",{text:`Delete drawdown snapshot from ${this.snapshotDate}?`}),n.createEl("p",{text:`Drawdown limit: ${ve(this.drawdownLimit)}`,cls:"delete-confirmation-details"}),n.createEl("p",{text:"This action cannot be undone.",cls:"warning"});let o=r.createDiv({cls:"modal-button-container"});o.createEl("button",{type:"button",text:"Delete",cls:"mod-warning"}).addEventListener("click",()=>{this.close(),this.onConfirm()}),o.createEl("button",{type:"button",text:"Cancel"}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:r}=this;r.empty()}}});function S4(e,t,r,n){new y4({app:e,plugin:t,account:r,onClose:()=>{},onSave:n}).open()}var ca,Te,Iue,y4,f_e,b4,x4,w4,k4,T4=L(()=>{ca=require("obsidian"),Te=q(Y()),Iue=q(wn());di();Ra();Nr();ou();wt();rr();Eue();y4=class extends ca.Modal{constructor(r){super(r.app);this.root=null;this.props=r}onOpen(){let{contentEl:r}=this;r.empty(),r.createEl("h2",{text:"Edit Account",cls:"modal-title"}),this.container=r.createDiv({cls:"edit-account-modal-container"}),this.renderComponent()}onClose(){this.root&&(this.root.unmount(),this.root=null),this.props.onClose()}renderComponent(){this.root=(0,Iue.createRoot)(this.container),this.root.render(Te.default.createElement(cs,null,Te.default.createElement(f_e,{...this.props,onModalClose:()=>this.close()})))}},f_e=({app:e,plugin:t,account:r,onSave:n,onModalClose:o})=>{var D;let[a,i]=(0,Te.useState)(!1),[s,l]=(0,Te.useState)([]),[c,d]=(0,Te.useState)(!1),[u,p]=(0,Te.useState)({name:r.name,accountType:r.accountType,initialBalance:r.initialBalance,drawdownType:r.drawdownType,drawdownAmount:r.drawdownAmount,hasProfitTarget:r.hasProfitTarget,profitTarget:r.profitTarget,profitTargetType:r.profitTargetType||"absolute",profitTargetDate:r.profitTargetDate||null,monthlyCost:r.monthlyCost||0,createdDate:r.createdDate}),[m,f]=(0,Te.useState)([]);(0,Te.useEffect)(()=>{let O=()=>{if(t.optionsService){let I=t.optionsService.getOptions("account_type");l(I)}};O();let z=()=>O();return document.addEventListener("journalit-options-changed",z),()=>{document.removeEventListener("journalit-options-changed",z)}},[t.optionsService]),(0,Te.useEffect)(()=>{var O,z;try{let I=(z=(O=t.settings.account)==null?void 0:O.accountMetadata)==null?void 0:z[r.name];if(I!=null&&I.manualDrawdownSnapshots&&Array.isArray(I.manualDrawdownSnapshots)){let A=I.manualDrawdownSnapshots.filter(E=>E!=null).map(E=>{let N=E.date instanceof Date?E.date:Xt(E.date);return!N||isNaN(N.getTime())?(console.warn("EditAccountModal: Skipping snapshot with invalid date:",E),null):{...E,date:N}}).filter(E=>E!==null);f(A);let j=I.manualDrawdownSnapshots.length-A.length;j>0&&console.warn(`EditAccountModal: Filtered out ${j} corrupted snapshot(s)`)}}catch(I){console.error("EditAccountModal: Error loading manual drawdown snapshots:",I),f([])}},[r.name,(D=t.settings.account)==null?void 0:D.accountMetadata]);let g=O=>O.split("_").map(z=>z.charAt(0).toUpperCase()+z.slice(1).toLowerCase()).join(" "),v=async()=>{try{if(i(!0),!u.name){new ca.Notice("Account name is required");return}if(u.initialBalance<=0){new ca.Notice("Initial balance must be greater than 0");return}if(u.drawdownType!=="none"&&u.drawdownAmount<=0){new ca.Notice("Drawdown amount must be greater than 0 when drawdown is enabled");return}let O=r.name!==u.name,z=r.initialBalance!==u.initialBalance;if(O&&z){let I=await w(r.name,u.name);await k(r.initialBalance,u.initialBalance)?await h(I):(p(j=>({...j,initialBalance:r.initialBalance})),await y(I,u.name))}else if(O){let I=await w(r.name,u.name);await h(I)}else if(z)if(await k(r.initialBalance,u.initialBalance))await h(!1);else return;else await h(!1)}catch(O){console.error("Error updating account:",O),new ca.Notice(`Error updating account: ${O.message}`)}finally{i(!1)}},h=async O=>{await y(O,u.name)},y=async(O,z)=>{try{let I=new Date(r.createdDate),A=new Date(u.createdDate);I.setHours(0,0,0,0),A.setHours(0,0,0,0),I.getTime()!==A.getTime()&&(await S(r.name,I,A)||p(N=>({...N,createdDate:r.createdDate}))),await x(O,z)}catch(I){console.error("Error in performUpdate:",I),new ca.Notice(`Error updating account: ${I.message}`)}},b=async O=>{await x(O,u.name)},x=async(O,z)=>{try{let I={name:z,accountType:u.accountType,initialBalance:u.initialBalance,drawdownType:u.drawdownType,drawdownAmount:u.drawdownAmount,hasProfitTarget:u.hasProfitTarget,profitTarget:u.profitTarget,profitTargetType:u.profitTargetType,profitTargetDate:u.profitTargetDate||void 0,monthlyCost:u.monthlyCost,createdDate:u.createdDate};t.accountPageService&&await t.accountPageService.updateAccountMetadata(z,{accountType:I.accountType,initialBalance:I.initialBalance,drawdownType:I.drawdownType,drawdownAmount:I.drawdownAmount,hasProfitTarget:I.hasProfitTarget,profitTarget:I.profitTarget,profitTargetType:I.profitTargetType,profitTargetDate:I.profitTargetDate,monthlyCost:I.monthlyCost,createdDate:I.createdDate,manualDrawdownSnapshots:u.drawdownType==="manual"?m.filter(E=>{let N=E&&E.date instanceof Date&&!isNaN(E.date.getTime());return N||console.warn("EditAccountModal: Filtering out invalid snapshot before save:",E),N}):[]});let A=new Date(r.createdDate).getTime()!==new Date(u.createdDate).getTime(),j=r.initialBalance!==u.initialBalance;(A||j)&&t.accountPageService&&await t.accountPageService.refreshAccountData(z),O&&r.name!==z&&t.optionsService&&await t.optionsService.updateOption("account",r.name,z,!0),n(),O&&r.name!==z?new ca.Notice(`Account "${r.name}" updated to "${z}" and all references updated`):new ca.Notice(`Account "${z}" updated successfully`),document.dispatchEvent(new CustomEvent("journalit:account-updated",{detail:{accountId:r.id,accountName:z}})),t.accountPageService&&(await t.accountPageService.refreshAccountData(z),await t.accountPageService.refreshAllAccountData(),await new Promise(E=>setTimeout(E,50))),o()}catch(I){console.error("Error updating account:",I),new ca.Notice(`Error updating account: ${I.message}`)}},w=(O,z)=>new Promise(I=>{let A=`Do you want to update all existing notes that use account "${O}" to use "${z}" instead?

This will search through all notes and update the account reference wherever it's found.`;new b4(e,A,I).open()}),S=(O,z,I)=>new Promise(A=>{new x4(e,O,z,I,A).open()}),k=(O,z)=>new Promise(I=>{new w4(e,t,O,z,I).open()}),T=O=>new Promise(z=>{new k4(e,O,z).open()}),P=async()=>{try{if(i(!0),!await T(r.name))return;t.accountPageService?(await t.accountPageService.deleteAccount(r.name),new ca.Notice(`Account "${r.name}" has been deleted successfully`),t.viewManager&&(await t.viewManager.closeAccountPageViews(r.name),setTimeout(async()=>{await t.viewManager.navigateToAccountDashboard()},200)),document.dispatchEvent(new CustomEvent("journalit:account-deleted",{detail:{accountId:r.id,accountName:r.name}})),n(),o()):new ca.Notice("AccountPageService not available for account deletion")}catch(O){console.error("Error deleting account:",O),new ca.Notice(`Error deleting account: ${O.message}`)}finally{i(!1)}};return Te.default.createElement("div",{className:"edit-account-form"},Te.default.createElement("style",null,`
        .manage-snapshots-button {
          padding: 8px 16px;
          background-color: var(--interactive-accent);
          color: white;
          border: none;
          border-radius: 4px;
          cursor: pointer;
          white-space: normal;
          word-wrap: break-word;
          width: auto;
          max-width: 100%;
          display: inline-block;
          min-width: 250px !important;
        }

        .modal-save-accent {
          background-color: var(--interactive-accent) !important;
          color: var(--text-on-accent) !important;
          border-color: var(--interactive-accent) !important;
        }

        .delete-account-danger {
          background-color: #dc3545 !important;
          color: white !important;
          border-color: #dc3545 !important;
        }
      `),Te.default.createElement("div",{className:"setting-item two-column"},Te.default.createElement("div",{className:"column"},Te.default.createElement("div",{className:"setting-item-info"},Te.default.createElement("div",{className:"setting-item-name"},"Account Name"),Te.default.createElement("div",{className:"setting-item-description"},"Name for your account")),Te.default.createElement("div",{className:"setting-item-control"},Te.default.createElement("input",{type:"text",value:u.name,onChange:O=>p({...u,name:O.target.value}),placeholder:"My Trading Account",disabled:a}))),Te.default.createElement("div",{className:"column"},Te.default.createElement("div",{className:"setting-item-info"},Te.default.createElement("div",{className:"setting-item-name"},"Account Type"),Te.default.createElement("div",{className:"setting-item-description"},"Type of trading account")),Te.default.createElement("div",{className:"setting-item-control"},Te.default.createElement("select",{value:u.accountType,onChange:O=>p({...u,accountType:O.target.value}),disabled:a},s.length>0?s.map(O=>Te.default.createElement("option",{key:O,value:O},g(O))):Te.default.createElement(Te.default.Fragment,null,Te.default.createElement("option",{value:"demo"},"Demo"),Te.default.createElement("option",{value:"evaluation"},"Evaluation"),Te.default.createElement("option",{value:"funded"},"Funded")))))),Te.default.createElement("div",{className:"setting-item two-column"},Te.default.createElement("div",{className:"column"},Te.default.createElement("div",{className:"setting-item-info"},Te.default.createElement("div",{className:"setting-item-name"},"Initial Balance"),Te.default.createElement("div",{className:"setting-item-description"},"Starting account balance")),Te.default.createElement("div",{className:"setting-item-control"},Te.default.createElement("input",{type:"number",value:u.initialBalance===0?"":u.initialBalance,onChange:O=>p({...u,initialBalance:O.target.value===""?0:parseFloat(O.target.value)||0}),onFocus:O=>{u.initialBalance===0&&(O.target.value="")},min:"0.01",step:"100",placeholder:"10000",disabled:a}))),Te.default.createElement("div",{className:"column"},Te.default.createElement("div",{className:"setting-item-info"},Te.default.createElement("div",{className:"setting-item-name"},"Creation Date"),Te.default.createElement("div",{className:"setting-item-description"},"When account was created")),Te.default.createElement("div",{className:"setting-item-control"},Te.default.createElement("input",{type:"date",value:(()=>{try{return(u.createdDate instanceof Date?u.createdDate:new Date(u.createdDate)).toISOString().split("T")[0]}catch(O){return console.error("Error formatting date for input:",O),new Date().toISOString().split("T")[0]}})(),onChange:O=>{if(!O.target.value)return;let z=new Date(O.target.value);if(z>new Date){new ca.Notice("Creation date cannot be in the future");return}z.setHours(0,0,0,0),p({...u,createdDate:z})},max:new Date().toISOString().split("T")[0],disabled:a})))),Te.default.createElement("div",{className:"setting-item two-column"},Te.default.createElement("div",{className:"column"},Te.default.createElement("div",{className:"setting-item-info"},Te.default.createElement("div",{className:"setting-item-name"},"Drawdown Type"),Te.default.createElement("div",{className:"setting-item-description"},"None | Fixed | EOD Trailing | Manual")),Te.default.createElement("div",{className:"setting-item-control"},Te.default.createElement("select",{value:u.drawdownType,onChange:O=>{let z=O.target.value,I=z!=="none"&&u.drawdownType==="none"?Math.round(r.initialBalance*.1):u.drawdownAmount;p({...u,drawdownType:z,drawdownAmount:z==="none"?0:I})},disabled:a},Te.default.createElement("option",{value:"none"},"None"),Te.default.createElement("option",{value:"fixed"},"Fixed"),Te.default.createElement("option",{value:"eod_trailing"},"EOD Trailing"),Te.default.createElement("option",{value:"manual"},"Manual")))),u.drawdownType!=="none"&&Te.default.createElement("div",{className:"column"},Te.default.createElement("div",{className:"setting-item-info"},Te.default.createElement("div",{className:"setting-item-name"},"Drawdown Amount"),Te.default.createElement("div",{className:"setting-item-description"},"Maximum loss allowed from starting balance")),Te.default.createElement("div",{className:"setting-item-control"},Te.default.createElement("input",{type:"number",value:u.drawdownAmount===0?"":u.drawdownAmount,onChange:O=>p({...u,drawdownAmount:O.target.value===""?0:parseFloat(O.target.value)||0}),onFocus:O=>{u.drawdownAmount===0&&(O.target.value="")},min:"0",step:"100",placeholder:"0",disabled:a})))),u.drawdownType==="manual"&&Te.default.createElement("div",{className:"setting-item",style:{marginTop:"12px",gridColumn:"1 / -1"}},Te.default.createElement("div",{className:"setting-item-info"},Te.default.createElement("div",{className:"setting-item-name"},"Manual Drawdown Snapshots"),Te.default.createElement("div",{className:"setting-item-description"},"Manage historical drawdown limit snapshots from broker statements")),Te.default.createElement("button",{type:"button",onClick:()=>d(!c),className:"manage-snapshots-button"},c?"Hide":"Show"," Snapshot Manager (",m.length," recorded)"),c&&Te.default.createElement(Due,{app:e,snapshots:m,onSave:O=>{f(O)}})),Te.default.createElement("div",{className:"setting-item two-column"},Te.default.createElement("div",{className:"column"},Te.default.createElement(wh,{checked:u.hasProfitTarget,onChange:O=>p({...u,hasProfitTarget:O}),disabled:a,label:"Enable Profit Target"}),Te.default.createElement("div",{className:"setting-item-description"},"Set a profit target for account")),Te.default.createElement("div",{className:"column"},Te.default.createElement("div",{className:"setting-item-info"},Te.default.createElement("div",{className:"setting-item-name"},"Monthly Cost"),Te.default.createElement("div",{className:"setting-item-description"},"Subscription fees, platform costs")),Te.default.createElement("div",{className:"setting-item-control"},Te.default.createElement("input",{type:"number",value:u.monthlyCost===0?"":u.monthlyCost,onChange:O=>p({...u,monthlyCost:O.target.value===""?0:parseFloat(O.target.value)||0}),onFocus:O=>{u.monthlyCost===0&&(O.target.value="")},min:"0",step:"1",placeholder:"0",disabled:a})))),u.hasProfitTarget&&Te.default.createElement(Te.default.Fragment,null,Te.default.createElement("div",{className:"setting-item two-column"},Te.default.createElement("div",{className:"column"},Te.default.createElement("div",{className:"setting-item-info"},Te.default.createElement("div",{className:"setting-item-name"},"Target Type"),Te.default.createElement("div",{className:"setting-item-description"},"Absolute or percentage")),Te.default.createElement("div",{className:"setting-item-control"},Te.default.createElement("select",{value:u.profitTargetType,onChange:O=>p({...u,profitTargetType:O.target.value}),disabled:a},Te.default.createElement("option",{value:"absolute"},"Absolute Amount"),Te.default.createElement("option",{value:"percentage"},"Percentage")))),Te.default.createElement("div",{className:"column"},Te.default.createElement("div",{className:"setting-item-info"},Te.default.createElement("div",{className:"setting-item-name"},"Target ",u.profitTargetType==="percentage"?"(%)":"($)"),Te.default.createElement("div",{className:"setting-item-description"},u.profitTargetType==="percentage"?"Percentage":"Dollar amount")),Te.default.createElement("div",{className:"setting-item-control"},Te.default.createElement("input",{type:"number",value:u.profitTarget===0?"":u.profitTarget,onChange:O=>p({...u,profitTarget:O.target.value===""?0:parseFloat(O.target.value)||0}),onFocus:O=>{u.profitTarget===0&&(O.target.value="")},min:"0",step:u.profitTargetType==="percentage"?"1":"100",placeholder:"0",disabled:a})))),Te.default.createElement("div",{className:"setting-item"},Te.default.createElement("div",{className:"setting-item-info"},Te.default.createElement("div",{className:"setting-item-name"},"Target Date (Optional)"),Te.default.createElement("div",{className:"setting-item-description"},"Date to achieve the profit target")),Te.default.createElement("div",{className:"setting-item-control"},Te.default.createElement("input",{type:"date",value:u.profitTargetDate?(()=>{try{return new Date(u.profitTargetDate).toISOString().split("T")[0]}catch(O){return""}})():"",onChange:O=>p({...u,profitTargetDate:O.target.value?new Date(O.target.value):null}),disabled:a})))),Te.default.createElement("div",{className:"edit-account-buttons"},Te.default.createElement(he,{variant:"secondary",onClick:P,disabled:a,className:"delete-account-button delete-account-danger"},"Delete Account"),Te.default.createElement("div",{className:"button-group-right"},Te.default.createElement(he,{variant:"primary",onClick:v,disabled:a,className:"save-account-button accent-button modal-save-accent"},a?"Saving...":"Save Changes"),Te.default.createElement(he,{variant:"secondary",onClick:o,disabled:a,className:"cancel-button"},"Cancel"))))},b4=class extends ca.Modal{constructor(r,n,o){super(r);this.message=n;this.onConfirm=o}onOpen(){let{contentEl:r}=this;r.createEl("p",{text:this.message});let n=r.createDiv({cls:"modal-button-container"});n.createEl("button",{type:"button",text:"OK (Update Notes)",cls:"mod-cta"}).addEventListener("click",()=>{this.close(),this.onConfirm(!0)}),n.createEl("button",{type:"button",text:"Save Name Only"}).addEventListener("click",()=>{this.close(),this.onConfirm(!1)}),n.createEl("button",{type:"button",text:"Cancel Action"}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:r}=this;r.empty()}},x4=class extends ca.Modal{constructor(r,n,o,a,i){super(r);this.accountName=n;this.oldDate=o;this.newDate=a;this.onConfirm=i}onOpen(){let{contentEl:r}=this;r.createEl("h3",{text:"Change Creation Date"});let n=tr();r.createEl("p",{text:`You are about to change the creation date for account "${this.accountName}" from ${rt(this.oldDate,n)} to ${rt(this.newDate,n)}.`}),r.createEl("p",{text:"This will update the initial deposit transaction date and may affect account age calculations, monthly billing cycles, and other date-based metrics.",cls:"warning"});let o=r.createDiv({cls:"modal-button-container"});o.createEl("button",{type:"button",text:"Update Creation Date",cls:"mod-cta"}).addEventListener("click",()=>{this.close(),this.onConfirm(!0)}),o.createEl("button",{type:"button",text:"Cancel"}).addEventListener("click",()=>{this.close(),this.onConfirm(!1)})}onClose(){let{contentEl:r}=this;r.empty()}},w4=class extends ca.Modal{constructor(r,n,o,a,i){super(r);this.plugin=n;this.oldBalance=o;this.newBalance=a;this.onConfirm=i}onOpen(){let{contentEl:r}=this;r.createEl("h3",{text:"Change Initial Balance"});let n=a=>{var s,l,c;let i=((c=(l=(s=this.plugin)==null?void 0:s.settings)==null?void 0:l.general)==null?void 0:c.currency)||"USD";return new Intl.NumberFormat("en-US",{style:"currency",currency:i,minimumFractionDigits:2}).format(a)};r.createEl("p",{text:`You are about to change the initial balance from ${n(this.oldBalance)} to ${n(this.newBalance)}.`}),r.createEl("p",{text:"This will affect all balance calculations, P&L percentages, drawdown calculations, and transaction history. The current balance will be recalculated based on the new initial balance plus all trade P&L.",cls:"warning"}),r.createEl("p",{text:"This change may significantly impact account metrics and historical data accuracy.",cls:"warning"});let o=r.createDiv({cls:"modal-button-container"});o.createEl("button",{type:"button",text:"Update Initial Balance",cls:"mod-cta"}).addEventListener("click",()=>{this.close(),this.onConfirm(!0)}),o.createEl("button",{type:"button",text:"Cancel"}).addEventListener("click",()=>{this.close(),this.onConfirm(!1)})}onClose(){let{contentEl:r}=this;r.empty()}},k4=class extends ca.Modal{constructor(r,n,o){super(r);this.accountName=n;this.onConfirm=o}onOpen(){let{contentEl:r}=this;r.createEl("h3",{text:"Delete Account",cls:"modal-title-danger"}),r.createEl("p",{text:`Are you sure you want to permanently delete the account "${this.accountName}"?`}),r.createEl("p",{text:"This action will:",cls:"warning"});let n=r.createEl("ul",{cls:"warning-list"});n.createEl("li",{text:"Remove all account metadata and settings"}),n.createEl("li",{text:"Remove account references from all linked trade notes"}),n.createEl("li",{text:"Remove auto-generated account tags from all trades"}),n.createEl("li",{text:"This action cannot be undone"}),r.createEl("p",{text:"\u26A0\uFE0F WARNING: This is a permanent action that cannot be reversed!",cls:"danger-warning"});let o=r.createDiv({cls:"modal-button-container"});o.createEl("button",{type:"button",text:"Cancel",cls:"mod-cta"}).addEventListener("click",()=>{this.close(),this.onConfirm(!1)});let a=o.createEl("button",{type:"button",text:`Delete "${this.accountName}"`,cls:"mod-destructive"});a.classList.add("jl-button-destructive"),a.addEventListener("click",()=>{this.close(),this.onConfirm(!0)})}onClose(){let{contentEl:r}=this;r.empty()}}});function HL(e,t,r,n){new C4({app:e,plugin:t,accountName:r,onClose:()=>{},onSave:n}).open()}var au,Gt,Aue,C4,g_e,P4,D4=L(()=>{au=require("obsidian"),Gt=q(Y()),Aue=q(wn());di();Nr();wt();rr();C4=class extends au.Modal{constructor(t){super(t.app),this.props=t}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h2",{text:"Add Deposit/Withdrawal",cls:"modal-title"}),this.container=t.createDiv({cls:"add-event-modal-container"}),this.renderComponent()}onClose(){this.root&&this.root.unmount(),this.props.onClose()}renderComponent(){this.root=(0,Aue.createRoot)(this.container),this.root.render(Gt.default.createElement(cs,null,Gt.default.createElement(g_e,{...this.props,onModalClose:()=>this.close()})))}},g_e=({plugin:e,accountName:t,onSave:r,onModalClose:n})=>{let[o,a]=(0,Gt.useState)(!1),{currency:i}=Ke(),s=m=>new Intl.NumberFormat("en-US",{style:"currency",currency:i}).format(m),l=()=>new Date().toISOString().split("T")[0],[c,d]=(0,Gt.useState)({type:"deposit",amount:"",date:l(),description:""}),u=async()=>{var m,f;try{if(a(!0),!c.amount||parseFloat(c.amount)<=0){new au.Notice("Amount must be greater than 0");return}if(!c.date){new au.Notice("Date is required");return}let g=parseFloat(c.amount);if(!iv(c.date)){new au.Notice("Invalid date format");return}let v=new Date(c.date),h=new Date;if(h.setHours(23,59,59,999),v>h){new au.Notice("Transaction date cannot be in the future");return}if(!await p(c,g))return;c.type==="deposit"?await((m=e.accountPageService)==null?void 0:m.addManualDeposit(t,g,v,c.description||void 0)):await((f=e.accountPageService)==null?void 0:f.addManualWithdrawal(t,g,v,c.description||void 0));let b=c.type==="deposit"?"Deposit":"Withdrawal";new au.Notice(`${b} of ${s(g)} added successfully`),r(),n()}catch(g){console.error("Error adding transaction:",g),new au.Notice(`Error adding transaction: ${g.message}`)}finally{a(!1)}},p=(m,f)=>new Promise(g=>{new P4(e.app,e,m,f,t,g).open()});return Gt.default.createElement("div",{className:"add-event-form"},Gt.default.createElement("div",{className:"setting-item two-column"},Gt.default.createElement("div",{className:"column"},Gt.default.createElement("div",{className:"setting-item-info"},Gt.default.createElement("div",{className:"setting-item-name"},"Transaction Type"),Gt.default.createElement("div",{className:"setting-item-description"},"Deposit or withdrawal")),Gt.default.createElement("div",{className:"setting-item-control"},Gt.default.createElement("select",{value:c.type,onChange:m=>d({...c,type:m.target.value,description:""}),disabled:o},Gt.default.createElement("option",{value:"deposit"},"Deposit"),Gt.default.createElement("option",{value:"withdrawal"},"Withdrawal")))),Gt.default.createElement("div",{className:"column"},Gt.default.createElement("div",{className:"setting-item-info"},Gt.default.createElement("div",{className:"setting-item-name"},"Amount"),Gt.default.createElement("div",{className:"setting-item-description"},"Amount in ",i)),Gt.default.createElement("div",{className:"setting-item-control"},Gt.default.createElement("input",{type:"number",value:c.amount,onChange:m=>d({...c,amount:m.target.value}),onFocus:m=>{(c.amount==="0"||c.amount==="")&&(m.target.value="")},min:"0.01",step:"0.01",placeholder:"0.00",disabled:o})))),Gt.default.createElement("div",{className:"setting-item two-column"},Gt.default.createElement("div",{className:"column"},Gt.default.createElement("div",{className:"setting-item-info"},Gt.default.createElement("div",{className:"setting-item-name"},"Date"),Gt.default.createElement("div",{className:"setting-item-description"},"Transaction date")),Gt.default.createElement("div",{className:"setting-item-control"},Gt.default.createElement("input",{type:"date",value:c.date,onChange:m=>d({...c,date:m.target.value}),max:l(),disabled:o}))),Gt.default.createElement("div",{className:"column"},Gt.default.createElement("div",{className:"setting-item-info"},Gt.default.createElement("div",{className:"setting-item-name"},"Description (Optional)"),Gt.default.createElement("div",{className:"setting-item-description"},"Additional notes")),Gt.default.createElement("div",{className:"setting-item-control"},Gt.default.createElement("input",{type:"text",value:c.description,onChange:m=>d({...c,description:m.target.value}),placeholder:c.type==="deposit"?"Manual deposit":"Manual withdrawal",disabled:o})))),Gt.default.createElement("div",{className:"add-event-buttons"},Gt.default.createElement("div",{className:"button-group-left"}),Gt.default.createElement("div",{className:"button-group-right"},Gt.default.createElement(he,{variant:"primary",onClick:u,disabled:o,className:"add-event-button accent-button",style:{backgroundColor:"var(--interactive-accent)",color:"var(--text-on-accent)",borderColor:"var(--interactive-accent)"}},o?"Adding...":"Add Transaction"),Gt.default.createElement(he,{variant:"secondary",onClick:n,disabled:o,className:"cancel-button"},"Cancel"))))},P4=class extends au.Modal{constructor(r,n,o,a,i,s){super(r);this.plugin=n;this.eventData=o;this.amount=a;this.accountName=i;this.onConfirm=s}onOpen(){let{contentEl:r}=this;r.createEl("h3",{text:"Confirm Transaction"});let n=s=>{var c,d,u;let l=((u=(d=(c=this.plugin)==null?void 0:c.settings)==null?void 0:d.general)==null?void 0:u.currency)||"USD";return new Intl.NumberFormat("en-US",{style:"currency",currency:l,minimumFractionDigits:2}).format(s)},o=this.eventData.type==="deposit"?"deposit":"withdrawal",a=rt(new Date(this.eventData.date),tr());r.createEl("p",{text:`Add ${o} of ${n(this.amount)} to account "${this.accountName}" on ${a}?`}),this.eventData.description&&r.createEl("p",{text:`Description: ${this.eventData.description}`,cls:"transaction-description"});let i=r.createDiv({cls:"modal-button-container"});i.createEl("button",{text:"Add Transaction",cls:"mod-cta"}).addEventListener("click",()=>{this.close(),this.onConfirm(!0)}),i.createEl("button",{text:"Cancel"}).addEventListener("click",()=>{this.close(),this.onConfirm(!1)})}onClose(){let{contentEl:r}=this;r.empty()}}});var vo,E4,Lue=L(()=>{vo=q(Y());er();pp();pt();Nr();T4();D4();rr();Ut();E4=()=>{var s,l;let{accountPageData:e,refreshData:t}=Ds(),{currency:r}=Ke(),n=xe();if(!e||!n)return null;let{account:o}=e,a=()=>{S4(n.app,n,o,t)},i=()=>{HL(n.app,n,o.name,t)};return vo.default.createElement("div",{className:"account-page-header"},vo.default.createElement("div",{className:"account-header-main"},vo.default.createElement("h2",null,"Account: ",o.name),vo.default.createElement("div",{className:"header-buttons"},vo.default.createElement(he,{onClick:i,variant:"secondary",size:"sm",className:"add-event-btn",title:"Add Deposit/Withdrawal"},vo.default.createElement(kl,{size:16})),vo.default.createElement(he,{onClick:a,variant:"secondary",size:"sm",className:"edit-account-btn",title:"Edit Account"},vo.default.createElement(Fo,{size:16})))),vo.default.createElement("div",{className:"account-info"},vo.default.createElement("div",{className:"account-info-item"},vo.default.createElement("span",{className:"info-label"},"Type:"),vo.default.createElement("span",{className:"info-value"},o.accountType||"N/A")),vo.default.createElement("div",{className:"account-info-item"},vo.default.createElement("span",{className:"info-label"},"Initial Balance:"),vo.default.createElement("span",{className:"info-value"},ha((s=o.initialBalance)!=null?s:0,!1,r))),vo.default.createElement("div",{className:"account-info-item"},vo.default.createElement("span",{className:"info-label"},"Current Balance:"),vo.default.createElement("span",{className:"info-value"},ha((l=o.currentBalance)!=null?l:0,!1,r))),o.accountId&&vo.default.createElement("div",{className:"account-info-item"},vo.default.createElement("span",{className:"info-label"},"Account ID:"),vo.default.createElement("span",{className:"info-value"},o.accountId))))}});var Tr,I4,Nue=L(()=>{Tr=q(Y());pp();rr();Ut();pt();I4=()=>{var u,p;let{getMetrics:e,getFilteredTrades:t}=Ds(),{currency:r}=Ke(),n=xe(),o=e(),a=t(),i=(p=(u=n==null?void 0:n.settings)==null?void 0:u.trade)==null?void 0:p.displayRMultiples;if(!o)return null;let s=m=>`${m.toFixed(1)}%`,l=m=>ha(m,!1,r),c=m=>m.toFixed(2),d=m=>m>0?"positive":m<0?"negative":"neutral";return Tr.default.createElement("div",{className:"account-metrics"},Tr.default.createElement("div",{className:"metrics-grid"},Tr.default.createElement("div",{className:"metric-card"},Tr.default.createElement("span",{className:"metric-label"},"Total Trades"),Tr.default.createElement("span",{className:"metric-value"},o.totalTrades)),Tr.default.createElement("div",{className:"metric-card"},Tr.default.createElement("span",{className:"metric-label"},"Win Rate"),Tr.default.createElement("span",{className:`metric-value ${d(o.winRate-50)}`},s(o.winRate))),Tr.default.createElement("div",{className:"metric-card"},Tr.default.createElement("span",{className:"metric-label"},"Total P&L"),Tr.default.createElement("span",{className:`metric-value ${d(o.totalPnL)}`},l(o.totalPnL))),Tr.default.createElement("div",{className:"metric-card"},Tr.default.createElement("span",{className:"metric-label"},"Profit Factor"),Tr.default.createElement("span",{className:`metric-value ${d(o.profitFactor-1)}`},c(o.profitFactor))),Tr.default.createElement("div",{className:"metric-card"},Tr.default.createElement("span",{className:"metric-label"},"Avg Win"),Tr.default.createElement("span",{className:"metric-value positive"},i&&o.avgWinRMultiple!==void 0?`+${o.avgWinRMultiple.toFixed(1)}R`:l(o.avgWin))),Tr.default.createElement("div",{className:"metric-card"},Tr.default.createElement("span",{className:"metric-label"},"Avg Loss"),Tr.default.createElement("span",{className:"metric-value negative"},i&&o.avgLossRMultiple!==void 0?`-${o.avgLossRMultiple.toFixed(1)}R`:l(Math.abs(o.avgLoss)))),Tr.default.createElement("div",{className:"metric-card"},Tr.default.createElement("span",{className:"metric-label"},"Winning Trades"),Tr.default.createElement("span",{className:"metric-value positive"},o.winningTrades)),Tr.default.createElement("div",{className:"metric-card"},Tr.default.createElement("span",{className:"metric-label"},"Losing Trades"),Tr.default.createElement("span",{className:"metric-value negative"},o.losingTrades)),Tr.default.createElement("div",{className:"metric-card"},Tr.default.createElement("span",{className:"metric-label"},"Total Commission"),Tr.default.createElement("span",{className:"metric-value negative"},l(o.totalCommission))),Tr.default.createElement("div",{className:"metric-card"},Tr.default.createElement("span",{className:"metric-label"},"Total Fees"),Tr.default.createElement("span",{className:"metric-value negative"},l(o.totalFees)))))}});var Ht,h_e,A4,Mue=L(()=>{Ht=q(Y());pp();eo();pt();Ut();wt();rr();h_e=({trade:e})=>{var c,d,u,p,m,f;let{currency:t}=Ke(),r=xe(),n=tr(),o=e.exitTime===null||e.exitTime===void 0,a=(d=(c=r==null?void 0:r.settings)==null?void 0:c.trade)==null?void 0:d.displayRMultiples,i=(p=(u=r==null?void 0:r.settings)==null?void 0:u.trade)==null?void 0:p.defaultRiskAmount,s=async()=>{try{if(!e.path||e.path.trim()===""){console.error("Cannot navigate to trade: No valid file path found",e);return}r&&r.openFile?r.openFile(e.path,!1):r!=null&&r.app?r.app.workspace.openLinkText(e.path,"",!1):console.error("Cannot navigate to trade: Plugin context not available")}catch(g){console.error("Error navigating to trade:",g,{path:e.path,trade:e})}},l=e.path&&e.path.trim()!=="";return Ht.default.createElement("div",{className:`trade-item ${l?"clickable":"no-path"}`,onClick:l?s:void 0,title:l?`Click to open: ${e.path}`:"No file path available - cannot navigate"},Ht.default.createElement("div",{className:"trade-header"},Ht.default.createElement("div",{className:"trade-primary-info"},Ht.default.createElement("span",{className:"trade-instrument"},e.instrument),Ht.default.createElement("span",{className:`trade-direction ${e.assetType==="options"&&e.optionType?e.optionType.toLowerCase():((m=e.direction)!=null?m:"unknown").toLowerCase()}`},e.assetType==="options"&&e.optionType?e.optionType.charAt(0).toUpperCase()+e.optionType.slice(1):(f=e.direction)!=null?f:"Unknown"),!l&&Ht.default.createElement("span",{className:"no-path-indicator",title:"No file path - cannot open"},"\u26A0\uFE0F")),o?Ht.default.createElement("span",{className:"status-open"},"OPEN"):Ht.default.createElement("span",{className:`trade-pnl ${e.pnl>=0?"positive":"negative"}`},ve(e.pnl,!0,t,a,st(e.pnl,e.rMultiple,e.riskAmount,i)))),Ht.default.createElement("div",{className:"trade-details"},Ht.default.createElement("div",{className:"trade-prices"},Ht.default.createElement("span",{className:"trade-price"},"Entry: ",ha(e.entryPrice,!1,t)),!o&&Ht.default.createElement("span",{className:"trade-price"},"Exit: ",ha(e.exitPrice,!1,t)),Ht.default.createElement("span",{className:"trade-size"},"Size: ",e.positionSize)),Ht.default.createElement("div",{className:"trade-dates"},Ht.default.createElement("span",{className:"trade-date"},"Entry: ",rt(e.entryTime,n)),!o&&Ht.default.createElement("span",{className:"trade-date"},"Exit: ",rt(e.exitTime,n))),e.setup.length>0&&Ht.default.createElement("div",{className:"trade-setups"},Ht.default.createElement("span",{className:"setup-label"},"Setups:"),Ht.default.createElement("div",{className:"setup-tags"},e.setup.map((g,v)=>Ht.default.createElement("span",{key:v,className:"setup-tag"},g)))),e.mistake.length>0&&Ht.default.createElement("div",{className:"trade-mistakes"},Ht.default.createElement("span",{className:"mistake-label"},"Mistakes:"),Ht.default.createElement("div",{className:"mistake-tags"},e.mistake.map((g,v)=>Ht.default.createElement("span",{key:v,className:"mistake-tag"},g)))),e.tags.length>0&&Ht.default.createElement("div",{className:"trade-tags"},Ht.default.createElement("span",{className:"tags-label"},"Tags:"),Ht.default.createElement("div",{className:"tag-list"},e.tags.map((g,v)=>Ht.default.createElement("span",{key:v,className:"trade-tag"},g)))),Ht.default.createElement("div",{className:"trade-meta"},Ht.default.createElement("span",{className:`review-status ${e.reviewed?"reviewed":"not-reviewed"}`},e.reviewed?"Reviewed":"Not Reviewed"),(()=>{let g=Math.max(0,Number(e.commission)||0),v=Math.max(0,Number(e.fees)||0),h=Number(e.swap)||0,y=Math.max(0,Number(e.rebate)||0),x=g+v+h-y;return x>0?Ht.default.createElement("span",{className:"trade-costs"},"Net Costs: ",Vs(x,t)):x<0?Ht.default.createElement("span",{className:"trade-credits"},"Net Credit: ",Vs(Math.abs(x),t)):null})())))},A4=()=>{let{getFilteredTrades:e,accountPageData:t}=Ds(),r=xe(),n=e();return Ht.default.createElement("div",{className:"account-trades"},Ht.default.createElement("div",{className:"trades-header-centered"},Ht.default.createElement("span",{className:"trades-header-line"}),Ht.default.createElement("h3",{className:"trades-header-title"},"Linked Trades (",n.length,")"),Ht.default.createElement("span",{className:"trades-header-line"})),n.length===0?Ht.default.createElement(et,{message:"No trades are linked to this account or match the current filters.",subMessage:"Try adjusting your filters or add some trades to this account."}):Ht.default.createElement("div",{className:"trades-list"},n.map((o,a)=>Ht.default.createElement(h_e,{key:`${o.path}-${a}`,trade:o}))))}});var He,v_e,y_e,b_e,Fue,Oue=L(()=>{He=q(Y());Ut();wt();ci();di();eo();Gd();rr();Yd();v_e=(e,t,r)=>{let n=t-e,o;n<=100?o=10:n<=1e3?o=100:n<=1e4?o=1e3:n<=1e5?o=1e4:n<=1e6?o=1e5:o=1e6;let a=Math.floor(e/o)*o,i=[];for(let s=a;s<=t+o;s+=o)i.push(s);if(i.includes(r)||(i.push(r),i.sort((s,l)=>s-l)),i.length>10){let s=[],l=Math.ceil(i.length/7);for(let c=0;c<i.length;c+=l)s.push(i[c]);return s.includes(r)||(s.push(r),s.sort((c,d)=>c-d)),s[s.length-1]!==i[i.length-1]&&s.push(i[i.length-1]),s}return i},y_e=e=>{if(!e)return"-";if(!e.startsWith("Trade P&L:"))return e;let t=/Trade P&L: .+\/([A-Z0-9]+)-(\d{6})-([^.]+)\.md/,r=e.match(t);if(!r||r.length<4)return e;let[,n,o,a]=r;try{let i="20"+o.substring(0,2),s=o.substring(2,4),l=o.substring(4,6),d=new Date(`${i}-${s}-${l}`).toLocaleDateString("en-US",{month:"short",day:"numeric"});return`${n} ${a} (${d})`}catch(i){return`${n} ${a}`}},b_e=He.default.memo(({active:e,payload:t,currency:r,displayRMultiples:n,defaultRiskAmount:o})=>{if(!e||!t||t.length===0)return null;let a=t[0].payload;return He.default.createElement("div",{className:"journalit-chart-tooltip",style:{backgroundColor:"var(--background-primary)",borderRadius:"8px",padding:"12px 16px",minWidth:"180px",border:"1px solid var(--background-modifier-border)",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.2)",transform:"translateY(-4px)",position:"relative"}},He.default.createElement("div",{className:"journalit-chart-tooltip-date",style:{fontSize:"14px",fontWeight:500,color:"var(--text-normal)",marginBottom:"8px",textAlign:"center"}},a.date),He.default.createElement("div",{className:"journalit-chart-tooltip-value",style:{fontSize:"18px",fontWeight:600,textAlign:"center",color:"var(--text-normal)"}},"Balance: ",ve(a.balance,!0,r,void 0,void 0)),a.isConsolidated&&He.default.createElement("div",{style:{marginTop:"8px",padding:"6px 0",borderTop:"1px solid var(--background-modifier-border)",fontSize:"13px"}},a.tradeCount&&a.tradeCount>0&&He.default.createElement("div",{style:{marginBottom:"4px"}},He.default.createElement("span",{style:{fontWeight:500}},"Trades:")," ",a.tradeCount),a.dailyPnL!==void 0&&He.default.createElement("div",{style:{color:a.dailyPnL>=0?"var(--text-success)":"var(--text-error)",fontWeight:500}},"Day P&L: ",ve(a.dailyPnL,!0,r,n,o&&o>0?a.dailyPnL/o:void 0)),a.hasEvents&&a.dayTransactions&&He.default.createElement("div",{style:{marginTop:"4px"}},a.dayTransactions.filter(i=>i.type==="deposit"||i.type==="withdrawal").filter(i=>!(i.type==="deposit"&&i.description==="Initial deposit")).map((i,s)=>{let l=i.type==="deposit"&&i.amount>0,c=i.type==="withdrawal"||i.type==="deposit"&&i.amount<0;return He.default.createElement("div",{key:s,style:{fontSize:"12px",marginBottom:"2px",color:l?"#2563eb":c?"#eab308":"var(--text-normal)"}},l&&`\u2022 Deposit: ${ve(i.amount,!0,r,void 0,void 0)}`,c&&`\u2022 Withdrawal: ${ve(Math.abs(i.amount),!0,r,void 0,void 0)}`,i.description&&i.description!=="Manual deposit"&&i.description!=="Manual withdrawal"&&He.default.createElement("span",{style:{color:"var(--text-muted)",fontStyle:"italic"}}," - "+i.description))}))),a.transaction&&He.default.createElement("div",{style:{marginTop:"8px",padding:"6px 0",borderTop:"1px solid var(--background-modifier-border)",fontSize:"13px"}},a.isDeposit&&He.default.createElement("div",{style:{color:"#41B4F7"}},"Deposit: ",ve(a.transaction.amount,!0,r,void 0,void 0)),a.isWithdrawal&&He.default.createElement("div",{style:{color:"var(--text-warning, gold)"}},"Withdrawal: ",ve(Math.abs(a.transaction.amount),!0,r,void 0,void 0)),a.isTrade&&!a.isConsolidated&&He.default.createElement("div",{style:{color:a.transaction&&a.transaction.amount>=0?"var(--text-success)":"var(--text-error)"}},y_e(a.transaction.description),": ",ve(a.transaction.amount,!0,r,n,o&&o>0?a.transaction.amount/o:void 0)),a.transaction.description&&!a.isTrade&&He.default.createElement("div",{style:{marginTop:"4px",fontSize:"12px",color:"var(--text-muted)",fontStyle:"italic"}},a.transaction.description)),a.drawdownLevel!==void 0&&He.default.createElement("div",{style:{marginTop:"6px",fontSize:"13px",color:"var(--text-error)"}},"Drawdown Level: ",ve(a.drawdownLevel,!0,r,void 0,void 0)))}),Fue=({account:e,height:t=250})=>{var h,y,b,x,w,S;let{currency:r}=Ke(),[n,o]=(0,He.useState)(!1);(0,He.useEffect)(()=>{o(!1)},[e.transactions]);let a=He.default.useMemo(()=>tr(),[]),i=He.default.useMemo(()=>window.journalitPlugin,[]),s=(b=(y=(h=i==null?void 0:i.settings)==null?void 0:h.trade)==null?void 0:y.displayRMultiples)!=null?b:!1,l=(S=(w=(x=i==null?void 0:i.settings)==null?void 0:x.trade)==null?void 0:w.defaultRiskAmount)!=null?S:0,c=He.default.useCallback(k=>`${k.getFullYear()}-${String(k.getMonth()+1).padStart(2,"0")}-${String(k.getDate()).padStart(2,"0")}`,[]),d=He.default.useMemo(()=>{if(!e.transactions||e.transactions.length===0)return[];let k=[...e.transactions].sort((N,B)=>new Date(N.date).getTime()-new Date(B.date).getTime()),T=e.initialBalance-e.drawdownAmount;if(e.drawdownType==="manual"&&e.allDrawdownSnapshots&&e.allDrawdownSnapshots.length>0){let N=e.allDrawdownSnapshots.filter(B=>B&&B.date).filter(B=>{let C=Xt(B.date);return C&&!isNaN(C.getTime())&&C<=e.createdDate}).sort((B,C)=>{let F=Xt(B.date),M=Xt(C.date);return((M==null?void 0:M.getTime())||0)-((F==null?void 0:F.getTime())||0)})[0];N&&(T=N.drawdownLimit)}let P=[],D=k.filter(N=>(N.type==="deposit"||N.type==="withdrawal")&&!(N.type==="deposit"&&N.description==="Initial deposit"));if(e.createdDate){let N=e.createdDate instanceof Date?e.createdDate:new Date(e.createdDate);if(!isNaN(N.getTime())){let B=N.toISOString().split("T")[0];if(!k.some(F=>(F.date instanceof Date?F.date:new Date(F.date)).toISOString().split("T")[0]===B))P.push({date:rt(N,a),rawDate:N,balance:e.initialBalance,...e.drawdownType!=="none"&&{drawdownLevel:T}});else if(k.some(M=>M.type==="deposit"&&M.description==="Initial deposit")){let M=new Date(N);M.setHours(0,0,0,0),P.push({date:rt(M,a),rawDate:M,balance:e.initialBalance,isInitialBalance:!0,...e.drawdownType!=="none"&&{drawdownLevel:T}})}}}let O=new Map,z=e.initialBalance,I=T;return k.filter(N=>N.type!=="cost").forEach(N=>{let B=new Date(N.date),C=lr(B,i),F=c(C);O.has(F)||O.set(F,{dayEnd:C,transactions:[],finalBalance:0,tradeCount:0,dailyPnL:0,hasEvents:!1});let M=O.get(F);M.transactions.push(N),M.finalBalance=N.balanceAfter,N.type==="trade"&&(M.tradeCount++,M.dailyPnL+=N.amount),(N.type==="deposit"||N.type==="withdrawal")&&(M.hasEvents=!0),B>M.dayEnd&&(M.dayEnd=B)}),Array.from(O.keys()).sort().forEach(N=>{let B=O.get(N),C=new Date(B.dayEnd),F=T;if(e.drawdownType==="eod_trailing"){B.finalBalance>z&&(z=B.finalBalance);let W=Math.min(e.initialBalance,Math.max(z-e.drawdownAmount,I));I=W,F=W}else if(e.drawdownType==="manual"&&e.allDrawdownSnapshots&&e.allDrawdownSnapshots.length>0){let W=B.dayEnd,$=e.allDrawdownSnapshots.filter(H=>H&&H.date).filter(H=>{let R=Xt(H.date);return R&&!isNaN(R.getTime())&&R<=W}).sort((H,R)=>{let V=Xt(H.date),Z=Xt(R.date);return((Z==null?void 0:Z.getTime())||0)-((V==null?void 0:V.getTime())||0)})[0];$&&(F=$.drawdownLimit)}let M=B.transactions.some(W=>W.type==="deposit"&&W.amount>0&&W.description!=="Initial deposit"),_=B.transactions.some(W=>W.type==="withdrawal"||W.type==="deposit"&&W.amount<0);P.push({date:rt(C,a),rawDate:C,balance:B.finalBalance,...e.drawdownType!=="none"&&{drawdownLevel:F},isConsolidated:!0,tradeCount:B.tradeCount,dailyPnL:B.dailyPnL,hasEvents:B.hasEvents,isTrade:B.tradeCount>0,dayTransactions:B.transactions,isDeposit:M,isWithdrawal:_})}),P.sort((N,B)=>N.rawDate.getTime()-B.rawDate.getTime())},[e.transactions,e.initialBalance,e.drawdownType,e.drawdownAmount,a,i,c]);if(d.length===0)return He.default.createElement("div",{style:{height:`${t}px`,display:"flex",alignItems:"center",justifyContent:"center"}},He.default.createElement(et,{message:"No trades found",subMessage:"No trading activity available for this account"}));let u=d.map(k=>k.balance),p=Math.min(...u),m=Math.max(...u);if(e.hasProfitTarget&&e.profitTarget>0){let k=e.profitTargetType==="percentage"?e.initialBalance*e.profitTarget/100:e.profitTarget,T=e.initialBalance+k;m=Math.max(m,T)}let f=e.maxDrawdownReached,g=m-Math.min(p,f||p);m=m+g*.05,f!==void 0&&f<p?p=f-g*.15:p=p-g*.1,p>0&&p<m*.05&&(p=0);let v=e.hasProfitTarget&&e.profitTarget>0?e.profitTargetType==="percentage"?e.initialBalance+e.initialBalance*e.profitTarget/100:e.initialBalance+e.profitTarget:void 0;return He.default.createElement(Ia,{height:t,width:"100%",className:"account-balance-chart"},He.default.createElement(dS,{data:d,margin:{top:10,right:15,left:10,bottom:5}},He.default.createElement("defs",null,He.default.createElement("linearGradient",{id:"balanceGradient",x1:"0",y1:"0",x2:"0",y2:"1"},He.default.createElement("stop",{offset:"0%",stopColor:"#41B4F7",stopOpacity:.4}),He.default.createElement("stop",{offset:"100%",stopColor:"#41B4F7",stopOpacity:.05})),He.default.createElement("filter",{id:"balanceShadow",height:"120%"},He.default.createElement("feDropShadow",{dx:"0",dy:"1",stdDeviation:"2",floodOpacity:"0.1"})),He.default.createElement("linearGradient",{id:"drawdownGradient",x1:"0",y1:"0",x2:"0",y2:"1"},He.default.createElement("stop",{offset:"0%",stopColor:"var(--text-error)",stopOpacity:.2}),He.default.createElement("stop",{offset:"100%",stopColor:"var(--text-error)",stopOpacity:.5}))),He.default.createElement($o,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),He.default.createElement(to,{dataKey:"date",style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:4,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5}}),He.default.createElement(ro,{tickFormatter:k=>ve(k,!0,r,void 0,void 0),style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:[p,m],allowDataOverflow:!1,width:60,tickLine:!1,axisLine:!1,tickMargin:5,ticks:v_e(p,m,e.initialBalance)}),He.default.createElement(ia,{content:He.default.createElement(b_e,{currency:r,displayRMultiples:s,defaultRiskAmount:l}),cursor:{fill:"var(--interactive-hover)",fillOpacity:.1,strokeOpacity:.3,strokeWidth:1,stroke:"var(--interactive-accent)"},wrapperStyle:{zIndex:1e3},offset:10}),He.default.createElement(Tn,{y:0,stroke:"var(--text-normal)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1}),He.default.createElement(Tn,{y:e.initialBalance,stroke:"#888888",strokeOpacity:.7,strokeDasharray:"3 3",strokeWidth:1}),v&&He.default.createElement(Tn,{y:v,stroke:"var(--text-success, #00b300)",strokeOpacity:1,strokeDasharray:"5 5",strokeWidth:2,className:"profit-target-line",label:{value:"Profit Target",fill:"var(--text-success, #00b300)",fontSize:12,position:"insideTopRight"}}),He.default.createElement(Vc,{type:"monotone",dataKey:"balance",stroke:"none",fill:"url(#balanceGradient)",fillOpacity:.95,dot:!1,activeDot:!1,filter:"url(#balanceShadow)"}),e.drawdownType!=="none"&&He.default.createElement(Ql,{type:"stepAfter",dataKey:"drawdownLevel",stroke:"var(--text-error)",strokeWidth:2,strokeDasharray:"5 5",dot:!1,activeDot:!1,name:"Drawdown Level"}),e.drawdownType!=="none"&&He.default.createElement(Vc,{type:"monotone",dataKey:"drawdownLevel",stroke:"none",fill:"url(#drawdownGradient)",fillOpacity:1}),He.default.createElement(Ql,{type:"monotone",dataKey:"balance",stroke:"#41B4F7",strokeWidth:3,onAnimationEnd:()=>o(!0),dot:k=>{let{cx:T,cy:P,payload:D}=k;return D?n?D.isDeposit?He.default.createElement("g",null,He.default.createElement("line",{x1:T,y1:P-15,x2:T,y2:P+15,stroke:"#2563eb",strokeWidth:"2"}),He.default.createElement("circle",{cx:T,cy:P,r:"5",fill:"var(--background-primary)",stroke:"#2563eb",strokeWidth:"2"})):D.isWithdrawal?He.default.createElement("g",null,He.default.createElement("line",{x1:T,y1:P-15,x2:T,y2:P+15,stroke:"#eab308",strokeWidth:"2"}),He.default.createElement("circle",{cx:T,cy:P,r:"5",fill:"var(--background-primary)",stroke:"#eab308",strokeWidth:"2"})):D.isTrade?D.isConsolidated?He.default.createElement("circle",{cx:T,cy:P,r:"4",fill:D.dailyPnL!==void 0&&D.dailyPnL>=0?"var(--text-success)":"var(--text-error)",stroke:"var(--background-primary)",strokeWidth:"1"}):He.default.createElement("circle",{cx:T,cy:P,r:"4",fill:D.transaction&&D.transaction.amount>=0?"var(--text-success)":"var(--text-error)",stroke:"var(--background-primary)",strokeWidth:"1"}):He.default.createElement("circle",{cx:T,cy:P,r:"3",fill:"var(--text-muted)",stroke:"var(--background-primary)",strokeWidth:"1"}):He.default.createElement("circle",{cx:0,cy:0,r:0,opacity:0}):He.default.createElement("circle",{cx:0,cy:0,r:0,opacity:0})},activeDot:k=>{let{cx:T,cy:P,payload:D}=k;if(!D)return He.default.createElement("circle",{cx:0,cy:0,r:0,opacity:0});if(D.isDeposit)return He.default.createElement("g",null,He.default.createElement("line",{x1:T,y1:P-18,x2:T,y2:P+18,stroke:"#2563eb",strokeWidth:"3"}),He.default.createElement("circle",{cx:T,cy:P,r:"7",fill:"var(--background-primary)",stroke:"#2563eb",strokeWidth:"2"}));if(D.isWithdrawal)return He.default.createElement("g",null,He.default.createElement("line",{x1:T,y1:P-18,x2:T,y2:P+18,stroke:"#eab308",strokeWidth:"3"}),He.default.createElement("circle",{cx:T,cy:P,r:"7",fill:"var(--background-primary)",stroke:"#eab308",strokeWidth:"2"}));let O="#41B4F7";return D.isTrade&&(D.isConsolidated?O=D.dailyPnL!==void 0&&D.dailyPnL>=0?"var(--text-success)":"var(--text-error)":D.transaction&&(O=D.transaction.amount>=0?"var(--text-success)":"var(--text-error)")),He.default.createElement("circle",{cx:T,cy:P,r:"6",fill:O,stroke:"var(--background-primary)",strokeWidth:"2"})},name:"Balance"})))}});var df,L4,jue=L(()=>{df=q(Y());pp();Oue();pt();L4=()=>{let{accountPageData:e,isLoading:t}=Ds(),r=xe();return t||!e?df.default.createElement("div",{className:"account-balance-section"},df.default.createElement("h3",null,"Account Balance Chart"),df.default.createElement("div",{className:"balance-chart-loading"},df.default.createElement("p",null,"Loading balance chart..."))):df.default.createElement("div",{className:"account-balance-section"},df.default.createElement("div",{className:"balance-chart-container"},df.default.createElement(Fue,{account:e.account,height:400})))}});var Qe,N4,zue=L(()=>{Qe=q(Y());pp();lf();di();Ut();wt();rr();pt();N4=()=>{var m,f,g,v,h;let{accountPageData:e,isLoading:t}=Ds(),{currency:r}=Ke(),n=xe();if(t||!e)return Qe.default.createElement("div",{className:"account-risk-metrics-section"},Qe.default.createElement("div",{className:"risk-metrics-loading"},Qe.default.createElement("p",null,"Loading risk metrics...")));let{account:o}=e,a=(f=(m=n==null?void 0:n.settings)==null?void 0:m.trade)==null?void 0:f.displayRMultiples,i=(h=(v=(g=n==null?void 0:n.settings)==null?void 0:g.trade)==null?void 0:v.defaultRiskAmount)!=null?h:0,s=zL(o),l=jL(o),c=o.drawdownType!=="none"&&(o.drawdownAmount>0||o.drawdownType==="manual"&&o.currentDrawdownSnapshot),d=o.hasProfitTarget&&o.profitTarget>0,u=c?s>=100?"BREACHED":"IN PROGRESS":null,p=d?l>=100?"ACHIEVED":"IN PROGRESS":null;return Qe.default.createElement("div",{className:"account-risk-metrics-section"},Qe.default.createElement("div",{className:"section-header-centered"},Qe.default.createElement("span",{className:"section-header-line"}),Qe.default.createElement("h3",{className:"section-header-title"},"Risk Management"),Qe.default.createElement("span",{className:"section-header-line"})),Qe.default.createElement("div",{className:"risk-metrics-container"},Qe.default.createElement("div",{className:`risk-metric-box ${c?"":"not-set"}`},Qe.default.createElement("div",{className:"risk-metric-header"},Qe.default.createElement("div",{className:"header-left"},Qe.default.createElement("div",{className:"title-with-badge"},Qe.default.createElement("h4",{className:"risk-metric-title"},"Drawdown Used"),u&&Qe.default.createElement("span",{className:`risk-status-badge ${u==="BREACHED"?"breached":"in-progress"}`},u))),Qe.default.createElement("div",{className:`risk-metric-percentage ${c?"":"not-set"}`},c?Jn(s):"Not set")),c&&Qe.default.createElement("div",{className:"horizontal-bar-container"},Qe.default.createElement("div",{className:"horizontal-bar-track"},Qe.default.createElement("div",{className:`horizontal-bar-fill ${s>=75?"critical":s>=50?"warning":"safe"}`,style:{width:`${Math.min(100,s)}%`,transition:"width 0.8s cubic-bezier(0.4, 0, 0.2, 1)"}}))),Qe.default.createElement("div",{className:"risk-metric-details"},c?Qe.default.createElement(Qe.default.Fragment,null,(()=>{let y,b,x;return o.drawdownType==="manual"&&o.currentDrawdownSnapshot?(x=o.drawdownAmount,b=o.currentBalance-o.currentDrawdownSnapshot.drawdownLimit,y=o.drawdownAmount-b):(x=o.drawdownAmount,y=o.initialBalance-o.currentBalance,b=x-y),y=Math.max(0,Math.min(x,y)),b=Math.max(0,Math.min(x,b)),Qe.default.createElement(Qe.default.Fragment,null,Qe.default.createElement("div",{className:"detail-row"},Qe.default.createElement("span",{className:"detail-label"},"Used:"),Qe.default.createElement("span",{className:"detail-value"},ve(y,!0,r,a,i>0?y/i:void 0))),Qe.default.createElement("div",{className:"detail-row"},Qe.default.createElement("span",{className:"detail-label"},"Limit:"),Qe.default.createElement("span",{className:"detail-value"},ve(x,!0,r,a,i>0?x/i:void 0))),Qe.default.createElement("div",{className:"detail-row"},Qe.default.createElement("span",{className:"detail-label"},"Remaining:"),Qe.default.createElement("span",{className:"detail-value"},ve(b,!0,r,a,i>0?b/i:void 0))))})()):Qe.default.createElement("div",{className:"detail-row"},Qe.default.createElement("span",{className:"detail-value no-limit"},"No drawdown limit set")))),Qe.default.createElement("div",{className:`risk-metric-box ${d?"":"not-set"}`},Qe.default.createElement("div",{className:"risk-metric-header"},Qe.default.createElement("div",{className:"header-left"},Qe.default.createElement("div",{className:"title-with-badge"},Qe.default.createElement("h4",{className:"risk-metric-title"},"Profit Target"),p&&Qe.default.createElement("span",{className:`risk-status-badge ${p==="ACHIEVED"?"achieved":"in-progress"}`},p))),Qe.default.createElement("div",{className:`risk-metric-percentage ${d?"":"not-set"}`},d?Jn(l):"Not set")),d&&Qe.default.createElement("div",{className:"horizontal-bar-container"},Qe.default.createElement("div",{className:"horizontal-bar-track"},Qe.default.createElement("div",{className:`horizontal-bar-fill ${l>=100?"complete":"progress"}`,style:{width:`${Math.min(100,l)}%`,transition:"width 0.8s cubic-bezier(0.4, 0, 0.2, 1)"}}))),Qe.default.createElement("div",{className:"risk-metric-details"},d?Qe.default.createElement(Qe.default.Fragment,null,Qe.default.createElement("div",{className:"detail-row"},Qe.default.createElement("span",{className:"detail-label"},"Progress:"),Qe.default.createElement("span",{className:"detail-value"},ve(o.metrics.totalPnL,!0,r,a,i>0?o.metrics.totalPnL/i:void 0))),Qe.default.createElement("div",{className:"detail-row"},Qe.default.createElement("span",{className:"detail-label"},"Target:"),Qe.default.createElement("span",{className:"detail-value"},(()=>{let y=o.profitTargetType==="percentage"?o.initialBalance*o.profitTarget/100:o.profitTarget;return ve(y,!0,r,a,i>0?y/i:void 0)})())),Qe.default.createElement("div",{className:"detail-row"},Qe.default.createElement("span",{className:"detail-label"},"Remaining:"),Qe.default.createElement("span",{className:"detail-value"},(()=>{let b=(o.profitTargetType==="percentage"?o.initialBalance*o.profitTarget/100:o.profitTarget)-o.metrics.totalPnL;return ve(b,!0,r,a,i>0?b/i:void 0)})())),o.profitTargetDate&&Qe.default.createElement("div",{className:"detail-row"},Qe.default.createElement("span",{className:"detail-label"},"Target Date:"),Qe.default.createElement("span",{className:"detail-value"},rt(new Date(o.profitTargetDate))))):Qe.default.createElement("div",{className:"detail-row"},Qe.default.createElement("span",{className:"detail-value no-target"},"No profit target set"))))))}});function F4(e,t,r){new M4({app:e,plugin:t,onClose:()=>{},onSave:r}).open()}var Na,Ne,_ue,M4,x_e,Bue=L(()=>{Na=require("obsidian"),Ne=q(Y()),_ue=q(wn());di();Ra();Nr();ou();ba();wt();M4=class extends Na.Modal{constructor(t){super(t.app),this.props=t}onOpen(){let{contentEl:t}=this;t.empty(),pm(),t.createEl("h2",{text:"Create New Account",cls:"modal-title"}),this.container=t.createDiv({cls:"create-account-modal-container"}),this.renderComponent()}onClose(){this.root&&this.root.unmount(),this.props.onClose()}renderComponent(){this.root=(0,_ue.createRoot)(this.container),this.root.render(Ne.default.createElement(x_e,{...this.props,onModalClose:()=>this.close()}))}},x_e=({app:e,plugin:t,onSave:r,onModalClose:n})=>{let[o,a]=(0,Ne.useState)(!1),[i,s]=(0,Ne.useState)([]),[l,c]=(0,Ne.useState)(null),[d,u]=(0,Ne.useState)({name:"",accountType:"demo",createdDate:Oi(new Date),initialBalance:0,drawdownType:"none",drawdownAmount:0,hasProfitTarget:!1,profitTarget:0,profitTargetType:"absolute",profitTargetDate:null,monthlyCost:0});(0,Ne.useEffect)(()=>{let g=()=>{if(t.optionsService){let h=t.optionsService.getOptions("account_type");s(h)}};g();let v=()=>g();return document.addEventListener("journalit-options-changed",v),()=>{document.removeEventListener("journalit-options-changed",v)}},[t.optionsService]);let p=g=>g.split("_").map(v=>v.charAt(0).toUpperCase()+v.slice(1).toLowerCase()).join(" "),m=async g=>{if(!t.accountPageService)return!1;try{return(await t.accountPageService.getAllEnhancedAccounts()).some(h=>h.name.toLowerCase().trim()===g.toLowerCase().trim())}catch(v){return console.error("Error checking account name uniqueness:",v),!1}},f=async()=>{try{if(a(!0),!d.name||!d.name.trim()){new Na.Notice("Account name is required");return}let g=d.name.trim();if(await m(g)){new Na.Notice(`Account name "${g}" already exists. Please choose a different name.`);return}if(d.initialBalance<0){new Na.Notice("Initial balance cannot be negative");return}if(d.drawdownType!=="none"&&d.drawdownAmount<=0){new Na.Notice("Drawdown amount must be greater than 0 when drawdown is enabled");return}if(d.hasProfitTarget&&d.profitTarget<=0){new Na.Notice("Profit target amount must be greater than 0 when profit target is enabled");return}let h=Mt(d.createdDate);if(!h){new Na.Notice("Invalid creation date");return}let y=new Date;if(y.setHours(0,0,0,0),h>y){new Na.Notice("Creation date cannot be in the future");return}if(d.monthlyCost<0){new Na.Notice("Monthly cost cannot be negative");return}if(!t.accountPageService){new Na.Notice("AccountPageService not available for account creation");return}if(h.setHours(0,0,0,0),d.hasProfitTarget&&l){new Na.Notice("Please fix the profit target date error before creating the account");return}if(d.hasProfitTarget&&d.profitTargetDate&&!iv(d.profitTargetDate)){new Na.Notice("Invalid profit target date");return}await t.accountPageService.updateAccountMetadata(g,{name:g,accountType:d.accountType,createdDate:h,initialBalance:d.initialBalance,drawdownType:d.drawdownType,drawdownAmount:d.drawdownAmount,hasProfitTarget:d.hasProfitTarget,profitTarget:d.profitTarget,profitTargetType:d.profitTargetType,profitTargetDate:d.hasProfitTarget&&d.profitTargetDate||void 0,monthlyCost:d.monthlyCost,lastUpdated:new Date}),new Na.Notice(`Account "${g}" created successfully`),document.dispatchEvent(new CustomEvent("journalit:account-created",{detail:{accountName:g}})),t.accountPageService&&await t.accountPageService.refreshAllAccountData(),r(),n(),t.viewManager&&setTimeout(()=>{t.viewManager.openAccountPageView(g)},150)}catch(g){console.error("Error creating account:",g),new Na.Notice(`Error creating account: ${g.message}`)}finally{a(!1)}};return Ne.default.createElement("div",{className:"create-account-form"},Ne.default.createElement("div",{className:"setting-item two-column"},Ne.default.createElement("div",{className:"column"},Ne.default.createElement("div",{className:"setting-item-info"},Ne.default.createElement("div",{className:"setting-item-name"},"Account Name"),Ne.default.createElement("div",{className:"setting-item-description"},"Name for your new account")),Ne.default.createElement("div",{className:"setting-item-control"},Ne.default.createElement("input",{type:"text",value:d.name,onChange:g=>u({...d,name:g.target.value}),placeholder:"My Trading Account",disabled:o}))),Ne.default.createElement("div",{className:"column"},Ne.default.createElement("div",{className:"setting-item-info"},Ne.default.createElement("div",{className:"setting-item-name"},"Account Type"),Ne.default.createElement("div",{className:"setting-item-description"},"Type of trading account")),Ne.default.createElement("div",{className:"setting-item-control"},Ne.default.createElement("select",{value:d.accountType,onChange:g=>u({...d,accountType:g.target.value}),disabled:o},i.length>0?i.map(g=>Ne.default.createElement("option",{key:g,value:g},p(g))):Ne.default.createElement(Ne.default.Fragment,null,Ne.default.createElement("option",{value:"demo"},"Demo"),Ne.default.createElement("option",{value:"evaluation"},"Evaluation"),Ne.default.createElement("option",{value:"funded"},"Funded")))))),Ne.default.createElement("div",{className:"setting-item two-column"},Ne.default.createElement("div",{className:"column"},Ne.default.createElement("div",{className:"setting-item-info"},Ne.default.createElement("div",{className:"setting-item-name"},"Initial Balance"),Ne.default.createElement("div",{className:"setting-item-description"},"Starting account balance (optional, defaults to 0)")),Ne.default.createElement("div",{className:"setting-item-control"},Ne.default.createElement("input",{type:"number",value:d.initialBalance===0?"":d.initialBalance,onChange:g=>u({...d,initialBalance:g.target.value===""?0:parseFloat(g.target.value)||0}),onFocus:g=>{d.initialBalance===0&&(g.target.value="")},min:"0",step:"100",placeholder:"10000",disabled:o}))),Ne.default.createElement("div",{className:"column"},Ne.default.createElement("div",{className:"setting-item-info"},Ne.default.createElement("div",{className:"setting-item-name"},"Creation Date"),Ne.default.createElement("div",{className:"setting-item-description"},"When account was created")),Ne.default.createElement("div",{className:"setting-item-control"},Ne.default.createElement("input",{type:"date",value:d.createdDate,onChange:g=>{if(!g.target.value)return;let v=Mt(g.target.value);if(!v){new Na.Notice("Invalid creation date");return}let h=new Date;if(h.setHours(0,0,0,0),v>h){new Na.Notice("Creation date cannot be in the future");return}u({...d,createdDate:g.target.value})},max:Oi(new Date),disabled:o})))),Ne.default.createElement("div",{className:"setting-item two-column"},Ne.default.createElement("div",{className:"column"},Ne.default.createElement("div",{className:"setting-item-info"},Ne.default.createElement("div",{className:"setting-item-name"},"Drawdown Type"),Ne.default.createElement("div",{className:"setting-item-description"},"None | Fixed | EOD Trailing | Manual")),Ne.default.createElement("div",{className:"setting-item-control"},Ne.default.createElement("select",{value:d.drawdownType,onChange:g=>{let v=g.target.value;u({...d,drawdownType:v,drawdownAmount:v==="none"?0:d.drawdownAmount})},disabled:o},Ne.default.createElement("option",{value:"none"},"None"),Ne.default.createElement("option",{value:"fixed"},"Fixed"),Ne.default.createElement("option",{value:"eod_trailing"},"EOD Trailing"),Ne.default.createElement("option",{value:"manual"},"Manual")))),d.drawdownType!=="none"&&Ne.default.createElement("div",{className:"column"},Ne.default.createElement("div",{className:"setting-item-info"},Ne.default.createElement("div",{className:"setting-item-name"},"Drawdown Amount"),Ne.default.createElement("div",{className:"setting-item-description"},"Maximum drawdown limit")),Ne.default.createElement("div",{className:"setting-item-control"},Ne.default.createElement("input",{type:"number",value:d.drawdownAmount===0?"":d.drawdownAmount,onChange:g=>u({...d,drawdownAmount:g.target.value===""?0:parseFloat(g.target.value)||0}),onFocus:g=>{d.drawdownAmount===0&&(g.target.value="")},min:"0",step:"100",placeholder:"0",disabled:o})))),Ne.default.createElement("div",{className:"setting-item two-column"},Ne.default.createElement("div",{className:"column"},Ne.default.createElement(wh,{checked:d.hasProfitTarget,onChange:g=>{u({...d,hasProfitTarget:g}),g||c(null)},disabled:o,label:"Enable Profit Target"}),Ne.default.createElement("div",{className:"setting-item-description"},"Set a profit target for account")),Ne.default.createElement("div",{className:"column"},Ne.default.createElement("div",{className:"setting-item-info"},Ne.default.createElement("div",{className:"setting-item-name"},"Monthly Cost"),Ne.default.createElement("div",{className:"setting-item-description"},"Subscription fees, platform costs")),Ne.default.createElement("div",{className:"setting-item-control"},Ne.default.createElement("input",{type:"number",value:d.monthlyCost===0?"":d.monthlyCost,onChange:g=>u({...d,monthlyCost:g.target.value===""?0:parseFloat(g.target.value)||0}),onFocus:g=>{d.monthlyCost===0&&(g.target.value="")},min:"0",step:"1",placeholder:"0",disabled:o})))),d.hasProfitTarget&&Ne.default.createElement(Ne.default.Fragment,null,Ne.default.createElement("div",{className:"setting-item two-column"},Ne.default.createElement("div",{className:"column"},Ne.default.createElement("div",{className:"setting-item-info"},Ne.default.createElement("div",{className:"setting-item-name"},"Target Type"),Ne.default.createElement("div",{className:"setting-item-description"},"Absolute or percentage")),Ne.default.createElement("div",{className:"setting-item-control"},Ne.default.createElement("select",{value:d.profitTargetType,onChange:g=>u({...d,profitTargetType:g.target.value}),disabled:o},Ne.default.createElement("option",{value:"absolute"},"Absolute Amount"),Ne.default.createElement("option",{value:"percentage"},"Percentage")))),Ne.default.createElement("div",{className:"column"},Ne.default.createElement("div",{className:"setting-item-info"},Ne.default.createElement("div",{className:"setting-item-name"},"Target ",d.profitTargetType==="percentage"?"(%)":"($)"),Ne.default.createElement("div",{className:"setting-item-description"},d.profitTargetType==="percentage"?"Percentage":"Dollar amount")),Ne.default.createElement("div",{className:"setting-item-control"},Ne.default.createElement("input",{type:"number",value:d.profitTarget===0?"":d.profitTarget,onChange:g=>u({...d,profitTarget:g.target.value===""?0:parseFloat(g.target.value)||0}),onFocus:g=>{d.profitTarget===0&&(g.target.value="")},min:"0",step:d.profitTargetType==="percentage"?"1":"100",placeholder:"0",disabled:o})))),Ne.default.createElement("div",{className:"setting-item"},Ne.default.createElement("div",{className:"setting-item-info"},Ne.default.createElement("div",{className:"setting-item-name"},"Target Date (Optional)"),Ne.default.createElement("div",{className:"setting-item-description"},"Date to achieve the profit target")),Ne.default.createElement("div",{className:"setting-item-control"},Ne.default.createElement("input",{type:"date",value:d.profitTargetDate?Oi(d.profitTargetDate):"",onChange:g=>{if(!g.target.value){u({...d,profitTargetDate:null}),c(null);return}let v=Mt(g.target.value);v?(u({...d,profitTargetDate:v}),c(null)):(u({...d,profitTargetDate:null}),c("Invalid date format. Please enter a valid date."))},disabled:o}),l&&Ne.default.createElement("div",{className:"error-message-inline"},l)))),Ne.default.createElement("div",{className:"create-account-buttons"},Ne.default.createElement(he,{variant:"primary",onClick:f,disabled:o,className:"create-account-button"},o?"Creating...":"Create Account"),Ne.default.createElement(he,{variant:"secondary",onClick:n,disabled:o,className:"cancel-button"},"Cancel")))}});var O4=L(()=>{Lue();Nue();Mue();jue();zue();T4();Bue()});function Wue(e,t,r){new j4({app:e,plugin:t,onClose:()=>{},onSave:r}).open()}var Ho,le,$ue,j4,w_e,Rue=L(()=>{Ho=require("obsidian"),le=q(Y()),$ue=q(wn());er();Ra();Nr();ba();di();j4=class extends Ho.Modal{constructor(t){super(t.app),this.props=t}onOpen(){let{contentEl:t}=this;t.empty(),pm(),t.createEl("h2",{text:"Account Dashboard Settings",cls:"modal-title"}),this.container=t.createDiv({cls:"account-dashboard-settings-modal-container"}),this.renderComponent()}onClose(){this.root&&this.root.unmount(),this.props.onClose()}renderComponent(){this.root=(0,$ue.createRoot)(this.container),this.root.render(le.default.createElement(w_e,{...this.props,onModalClose:()=>this.close()}))}},w_e=({app:e,plugin:t,onSave:r,onModalClose:n})=>{let[o,a]=(0,le.useState)(!1),[i,s]=(0,le.useState)([]),[l,c]=(0,le.useState)(!1),[d,u]=(0,le.useState)(""),[p,m]=(0,le.useState)(null),[f,g]=(0,le.useState)(!1),[v,h]=(0,le.useState)(""),[y,b]=(0,le.useState)(null),[x,w]=(0,le.useState)(!1),[S,k]=(0,le.useState)(""),[T,P]=(0,le.useState)("reassign"),[D,O]=(0,le.useState)({excludedAccountTypes:[],includeWithdrawalsFromExcluded:{},accountTypeOrder:[]});(0,le.useEffect)(()=>{let X=()=>{var U;if(t.optionsService){let Q=t.optionsService.getOptions("account_type");s(Q)}(U=t.settings)!=null&&U.account&&O({excludedAccountTypes:[...t.settings.account.excludedAccountTypes||[]],includeWithdrawalsFromExcluded:{...t.settings.account.includeWithdrawalsFromExcluded||{}},accountTypeOrder:[...t.settings.account.accountTypeOrder||["funded","evaluation","demo","archived"]]})};X();let G=()=>X();return document.addEventListener("journalit-options-changed",G),()=>{document.removeEventListener("journalit-options-changed",G)}},[t.optionsService,t.settings]);let z=X=>X.split("_").map(G=>G.charAt(0).toUpperCase()+G.slice(1).toLowerCase()).join(" "),I=async()=>{if(!d.trim()){new Ho.Notice("Account type name cannot be empty");return}let X=d.trim().toLowerCase().replace(/\s+/g,"_");if(i.some(U=>U.toLowerCase().replace(/\s+/g,"_")===X)){new Ho.Notice(`Account type "${z(X)}" already exists`);return}if(["demo","evaluation","funded","archived","real"].includes(X)){new Ho.Notice(`"${z(X)}" is a reserved account type name`);return}try{a(!0),await t.optionsService.addOption("account_type",X),s([...i,X]);let U=[...D.accountTypeOrder];U.includes(X)||U.push(X),O({...D,accountTypeOrder:U,includeWithdrawalsFromExcluded:{...D.includeWithdrawalsFromExcluded,[X]:!1}}),u(""),c(!1),R("added",X),new Ho.Notice(`Account type "${z(X)}" added successfully`)}catch(U){console.error("Error adding account type:",U),new Ho.Notice(`Error adding account type: ${U.message}`)}finally{a(!1)}},A=()=>{u(""),c(!1)},j=()=>{c(!0),u("")},E=async X=>{var G;try{let Q=(await((G=t.accountPageService)==null?void 0:G.getAllEnhancedAccounts())||[]).filter(ee=>{var te;return((te=ee.accountType)==null?void 0:te.toLowerCase())===X.toLowerCase()}),J={inExcludedTypes:X?D.excludedAccountTypes.includes(X.toLowerCase()):!1,inDisplayOrder:X?D.accountTypeOrder.includes(X.toLowerCase()):!1,inWithdrawalSettings:X?D.includeWithdrawalsFromExcluded.hasOwnProperty(X.toLowerCase()):!1};return{affectedAccounts:Q.length,accountNames:Q.map(ee=>ee.name||ee.accountName||"Unnamed Account"),settingsImpact:J}}catch(U){return console.error("Error analyzing account type deletion impact:",U),{affectedAccounts:0,accountNames:[],settingsImpact:{inExcludedTypes:!1,inDisplayOrder:!1,inWithdrawalSettings:!1}}}},N=X=>{let G=X.toLowerCase(),U=D.excludedAccountTypes.filter(te=>te.toLowerCase()!==G),Q=D.accountTypeOrder.filter(te=>te.toLowerCase()!==G),J={...D.includeWithdrawalsFromExcluded};delete J[G];let ee={...D,excludedAccountTypes:U,accountTypeOrder:Q,includeWithdrawalsFromExcluded:J};return O(ee),t.settings.account||(t.settings.account={defaultAccountType:"demo",defaultDrawdownType:"none",defaultDrawdownAmount:0,showBalanceInDashboard:!0,excludedAccountTypes:[],includeWithdrawalsFromExcluded:{},accountTypeOrder:[],accountMetadata:{}}),t.settings.account.excludedAccountTypes=U,t.settings.account.accountTypeOrder=Q,t.settings.account.includeWithdrawalsFromExcluded=J,{removedFromExcluded:D.excludedAccountTypes.length!==U.length,removedFromDisplayOrder:D.accountTypeOrder.length!==Q.length,removedFromWithdrawalSettings:Object.keys(D.includeWithdrawalsFromExcluded).length!==Object.keys(J).length}},B=async X=>{try{a(!0);let G=await E(X);h(X),b(G),g(!0)}catch(G){console.error("Error analyzing deletion impact:",G),new Ho.Notice("Error analyzing account type usage")}finally{a(!1)}},C=async()=>{if(v)try{if(a(!0),y&&y.affectedAccounts>0){new Ho.Notice(`Cannot delete "${z(v)}" - it has ${y.affectedAccounts} associated accounts. Migration feature coming soon.`),g(!1);return}if(!await V(async()=>{await t.optionsService.removeOption("account_type",v)},"Account type deletion"))return;let G=N(v);t.settings.account||(t.settings.account={defaultAccountType:"demo",defaultDrawdownType:"none",defaultDrawdownAmount:0,showBalanceInDashboard:!0,excludedAccountTypes:[],includeWithdrawalsFromExcluded:{},accountTypeOrder:[],accountMetadata:{}}),t.settings.account.excludedAccountTypes=D.excludedAccountTypes,t.settings.account.includeWithdrawalsFromExcluded=D.includeWithdrawalsFromExcluded,t.settings.account.accountTypeOrder=D.accountTypeOrder,await t.saveSettings(),s(i.filter(J=>J.toLowerCase()!==v.toLowerCase())),R("deleted",v,{cleanupActions:{removedFromExcluded:G.removedFromExcluded,removedFromDisplayOrder:G.removedFromDisplayOrder,removedFromWithdrawalSettings:G.removedFromWithdrawalSettings}}),g(!1),h(""),b(null);let U=`Account type "${z(v)}" deleted successfully`,Q=[];G.removedFromExcluded&&Q.push("excluded types"),G.removedFromDisplayOrder&&Q.push("display order"),G.removedFromWithdrawalSettings&&Q.push("withdrawal settings"),Q.length>0&&(U+=` (cleaned up: ${Q.join(", ")})`),new Ho.Notice(U),t.accountPageService&&await t.accountPageService.clearCacheWithPrefix("allEnhancedAccounts"),r()}catch(X){console.error("Error deleting account type:",X),new Ho.Notice(`Error deleting account type: ${X.message}`)}finally{a(!1)}},F=()=>{g(!1),h(""),b(null)},M=()=>{let X=i.filter(G=>G.toLowerCase()!==v.toLowerCase());if(X.length===0){new Ho.Notice("Cannot migrate accounts - no other account types available. Create a new account type first.");return}k(X[0]),P("reassign"),g(!1),w(!0)},_=async()=>{if(!(!y||!v))try{if(a(!0),T==="reassign"&&!S){new Ho.Notice("Please select a target account type for reassignment");return}let X=await $(v,T,S);if(!X.success){new Ho.Notice(`Migration failed: ${X.error}`);return}if(!await V(async()=>{await t.optionsService.removeOption("account_type",v)},"Account type deletion"))return;let U=N(v);s(i.filter(J=>J.toLowerCase()!==v.toLowerCase())),R("migrated",v,{migrationOption:T,targetType:S,migratedCount:X.migratedCount,cleanupActions:{removedFromExcluded:U.removedFromExcluded,removedFromDisplayOrder:U.removedFromDisplayOrder,removedFromWithdrawalSettings:U.removedFromWithdrawalSettings}}),w(!1),g(!1),h(""),b(null),k("");let Q=`Account type "${z(v)}" deleted successfully. `;switch(Q+=`${X.migratedCount} accounts `,T){case"reassign":Q+=`reassigned to "${z(S)}"`;break;case"archive":Q+="moved to archived status";break;case"delete":Q+="marked for deletion";break}new Ho.Notice(Q,5e3),await t.saveSettings(),t.accountPageService&&await t.accountPageService.clearCacheWithPrefix("allEnhancedAccounts"),await new Promise(J=>setTimeout(J,100)),r()}catch(X){console.error("Error during migration and deletion:",X),new Ho.Notice(`Error during migration: ${X.message}`)}finally{a(!1)}},W=()=>{w(!1),k(""),P("reassign"),g(!0)},$=async(X,G,U)=>{var Q,J;try{let te=(await((Q=t.accountPageService)==null?void 0:Q.getAllEnhancedAccounts())||[]).filter($e=>{var oe;return((oe=$e.accountType)==null?void 0:oe.toLowerCase())===X.toLowerCase()});if(te.length===0)return{success:!0,migratedCount:0};let ue;switch(G){case"reassign":if(!U)return{success:!1,migratedCount:0,error:"Target type required for reassignment"};ue=U;break;case"archive":ue="archived";break;case"delete":ue="deleted";break;default:return{success:!1,migratedCount:0,error:"Invalid migration option"}}let be=0,Le=(J=t.settings)==null?void 0:J.account;if(Le!=null&&Le.accountMetadata){for(let $e of te){let oe=Object.keys(Le.accountMetadata).find(ge=>{let Se=Le.accountMetadata[ge];return Se.name===$e.name||Se.name===$e.accountName});oe&&(Le.accountMetadata[oe].accountType=ue,Le.accountMetadata[oe].lastUpdated=new Date,be++)}await t.saveSettings()}return{success:!0,migratedCount:be}}catch(ee){return console.error("Error migrating accounts:",ee),{success:!1,migratedCount:0,error:ee.message}}},H=async()=>{try{a(!0),t.settings.account||(t.settings.account={defaultAccountType:"demo",defaultDrawdownType:"none",defaultDrawdownAmount:0,showBalanceInDashboard:!0,excludedAccountTypes:[],includeWithdrawalsFromExcluded:{},accountTypeOrder:[],accountMetadata:{}}),t.settings.account.excludedAccountTypes=D.excludedAccountTypes,t.settings.account.includeWithdrawalsFromExcluded=D.includeWithdrawalsFromExcluded,t.settings.account.accountTypeOrder=D.accountTypeOrder,await t.saveSettings(),new Ho.Notice("Account dashboard settings saved successfully"),r(),n()}catch(X){console.error("Error saving account dashboard settings:",X),new Ho.Notice(`Error saving settings: ${X.message}`)}finally{a(!1)}},R=(X,G,U)=>{try{let Q=new CustomEvent("journalit-options-changed",{detail:{timestamp:Date.now(),optionType:"account_type",action:X,accountType:G,...U}});document.dispatchEvent(Q);let J=new CustomEvent("journalit-account-type-changed",{detail:{timestamp:Date.now(),action:X,accountType:G,...U}});document.dispatchEvent(J)}catch(Q){console.error("Error dispatching account type changed event:",Q)}},V=async(X,G,U=2)=>{let Q=null;for(let J=1;J<=U;J++)try{return await X(),!0}catch(ee){Q=ee,console.warn(`${G} failed (attempt ${J}/${U}):`,ee),J<U&&await new Promise(te=>setTimeout(te,J*1e3))}return new Ho.Notice(`${G} failed after ${U} attempts: ${(Q==null?void 0:Q.message)||"Unknown error"}`),!1};return le.default.createElement("div",{className:"account-dashboard-settings-form"},le.default.createElement(()=>{if(!x||!y||!v)return null;let X=i.filter(G=>G.toLowerCase()!==v.toLowerCase());return le.default.createElement("div",{className:"account-migration-modal-overlay"},le.default.createElement("div",{className:"account-type-delete-modal account-migration-modal"},le.default.createElement("h3",null,"Migrate Accounts Before Deletion"),le.default.createElement("div",{className:"delete-modal-content"},le.default.createElement("div",{className:"migration-warning"},le.default.createElement("p",null,le.default.createElement("strong",null,`You're about to delete "`,z(v),'" which has ',y.affectedAccounts," associated accounts.")),le.default.createElement("p",null,"These accounts must be handled before the account type can be deleted:"),le.default.createElement("ul",{className:"affected-accounts-list"},y.accountNames.slice(0,3).map((G,U)=>le.default.createElement("li",{key:U},G)),y.accountNames.length>3&&le.default.createElement("li",null,"... and ",y.accountNames.length-3," more"))),le.default.createElement("div",{className:"migration-options"},le.default.createElement("h4",null,"Choose how to handle these accounts:"),le.default.createElement("div",{className:"migration-option-group"},le.default.createElement("label",{className:"migration-option"},le.default.createElement("input",{type:"radio",name:"migrationOption",value:"reassign",checked:T==="reassign",onChange:G=>{let U=G.target.value;(U==="reassign"||U==="archive"||U==="delete")&&P(U)}}),le.default.createElement("div",{className:"migration-option-content"},le.default.createElement("span",{className:"migration-option-title"},"Reassign to different type"),le.default.createElement("span",{className:"migration-option-desc"},"Move all accounts to another account type"))),T==="reassign"&&le.default.createElement("div",{className:"target-type-select"},le.default.createElement("label",null,"Target account type:"),le.default.createElement("select",{value:S,onChange:G=>k(G.target.value),disabled:o},X.map(G=>le.default.createElement("option",{key:G,value:G},z(G))))),le.default.createElement("label",{className:"migration-option"},le.default.createElement("input",{type:"radio",name:"migrationOption",value:"archive",checked:T==="archive",onChange:G=>{let U=G.target.value;(U==="reassign"||U==="archive"||U==="delete")&&P(U)}}),le.default.createElement("div",{className:"migration-option-content"},le.default.createElement("span",{className:"migration-option-title"},"Archive accounts"),le.default.createElement("span",{className:"migration-option-desc"},'Move all accounts to "archived" status'))),le.default.createElement("label",{className:"migration-option"},le.default.createElement("input",{type:"radio",name:"migrationOption",value:"delete",checked:T==="delete",onChange:G=>{let U=G.target.value;(U==="reassign"||U==="archive"||U==="delete")&&P(U)}}),le.default.createElement("div",{className:"migration-option-content"},le.default.createElement("span",{className:"migration-option-title"},"Mark for deletion"),le.default.createElement("span",{className:"migration-option-desc"},"Mark all accounts as deleted")))))),le.default.createElement("div",{className:"delete-modal-actions"},le.default.createElement(he,{variant:"secondary",onClick:W,disabled:o},"Cancel"),le.default.createElement(he,{variant:"secondary",onClick:_,disabled:o||T==="reassign"&&!S,className:"delete-confirm-button"},o?"Migrating...":"Migrate & Delete Type"))))},null),le.default.createElement(()=>!f||!y?null:le.default.createElement("div",{className:"account-type-delete-modal-overlay"},le.default.createElement("div",{className:"account-type-delete-modal"},le.default.createElement("h3",null,"Delete Account Type"),le.default.createElement("div",{className:"delete-modal-content"},le.default.createElement("div",{className:"delete-warning"},le.default.createElement("p",null,le.default.createElement("strong",null,'Are you sure you want to delete the account type "',z(v),'"?'))),le.default.createElement("div",{className:"impact-analysis"},le.default.createElement("h4",null,"Impact Analysis:"),y.affectedAccounts>0?le.default.createElement("div",{className:"affected-accounts"},le.default.createElement("div",{className:"impact-item impact-critical"},le.default.createElement("strong",null,"\u26A0\uFE0F ",y.affectedAccounts," account(s) affected:"),le.default.createElement("ul",null,y.accountNames.slice(0,5).map((X,G)=>le.default.createElement("li",{key:G},X)),y.accountNames.length>5&&le.default.createElement("li",null,"... and ",y.accountNames.length-5," more"))),le.default.createElement("div",{className:"migration-notice"},le.default.createElement("strong",null,"Note:")," These accounts will need to be reassigned to a different account type before deletion can proceed. Account migration feature is coming in Phase 4.")):le.default.createElement("div",{className:"no-affected-accounts"},le.default.createElement("div",{className:"impact-item impact-safe"},"\u2705 No accounts are using this account type")),le.default.createElement("div",{className:"settings-cleanup"},le.default.createElement("h5",null,"Settings that will be cleaned up:"),le.default.createElement("ul",null,y.settingsImpact.inExcludedTypes&&le.default.createElement("li",null,"\u2713 Removed from excluded account types"),y.settingsImpact.inDisplayOrder&&le.default.createElement("li",null,"\u2713 Removed from display order"),y.settingsImpact.inWithdrawalSettings&&le.default.createElement("li",null,"\u2713 Removed from withdrawal settings"),!y.settingsImpact.inExcludedTypes&&!y.settingsImpact.inDisplayOrder&&!y.settingsImpact.inWithdrawalSettings&&le.default.createElement("li",null,"No settings cleanup needed"))))),le.default.createElement("div",{className:"delete-modal-actions"},y.affectedAccounts>0?le.default.createElement(le.default.Fragment,null,le.default.createElement(he,{variant:"secondary",onClick:F,disabled:o},"Cancel"),le.default.createElement(he,{variant:"primary",onClick:M,disabled:o},"Setup Migration")):le.default.createElement(le.default.Fragment,null,le.default.createElement(he,{variant:"secondary",onClick:F,disabled:o},"Cancel"),le.default.createElement(he,{variant:"primary",onClick:C,disabled:o,className:"delete-confirm-button"},o?"Deleting...":"Delete Account Type"))))),null),le.default.createElement("div",{className:"setting-item"},le.default.createElement("div",{className:"setting-item-info"},le.default.createElement("div",{className:"setting-item-name"},"Available Account Types"),le.default.createElement("div",{className:"setting-item-description"},"Current account types in your system.")),le.default.createElement("div",{className:"setting-item-control"},le.default.createElement("div",{className:"available-account-types"},i.length>0?le.default.createElement("div",{className:"account-types-container"},i.map((X,G)=>le.default.createElement("div",{key:X,className:"account-type-badge-container",onMouseEnter:()=>m(G),onMouseLeave:()=>m(null)},le.default.createElement("div",{className:"account-type-badge"},z(X),p===G&&le.default.createElement("button",{className:"account-type-delete-btn",onClick:()=>B(X),title:`Delete ${z(X)}`,disabled:o},"\xD7")))),le.default.createElement("div",{className:"add-account-type-section"},l?le.default.createElement("div",{className:"add-account-type-input"},le.default.createElement("input",{type:"text",value:d,onChange:X=>u(X.target.value),placeholder:"Enter account type name...",autoFocus:!0,onKeyPress:X=>{X.key==="Enter"?I():X.key==="Escape"&&A()},disabled:o,className:"account-type-name-input"}),le.default.createElement("div",{className:"add-account-type-buttons"},le.default.createElement("button",{onClick:I,disabled:o||!d.trim(),className:"add-account-type-confirm-btn",title:"Add account type"},"Add"),le.default.createElement("button",{onClick:A,disabled:o,className:"add-account-type-cancel-btn",title:"Cancel"},"Cancel"))):le.default.createElement("button",{onClick:j,disabled:o,className:"add-account-type-btn",title:"Add new account type"},le.default.createElement(kl,{size:16})))):le.default.createElement("div",{className:"no-account-types-container"},le.default.createElement("div",{className:"no-account-types"},"No custom account types defined."),le.default.createElement("button",{onClick:j,disabled:o,className:"add-account-type-btn",title:"Add new account type"},le.default.createElement(kl,{size:16})))))),le.default.createElement("div",{className:"setting-item"},le.default.createElement("div",{className:"setting-item-info"},le.default.createElement("div",{className:"setting-item-name"},"Dashboard Inclusion Settings"),le.default.createElement("div",{className:"setting-item-description"},"Choose which account types to include in dashboard calculations. Also configure whether withdrawals from each account type are included in total withdrawal metrics.")),le.default.createElement("div",{className:"setting-item-control"},le.default.createElement("div",{className:"account-types-settings-table"},i.length>0?le.default.createElement("div",{className:"account-types-list"},i.map(X=>{let G=X.toLowerCase(),U=D.excludedAccountTypes.includes(G),Q=D.includeWithdrawalsFromExcluded[G]||!1;return le.default.createElement("div",{key:X,className:"account-type-setting-row"},le.default.createElement("div",{className:"account-type-name"},z(X)),le.default.createElement("div",{className:"account-type-controls"},le.default.createElement("label",{className:"toggle-label"},le.default.createElement("input",{type:"checkbox",checked:!U,onChange:J=>{let ee=[...D.excludedAccountTypes];if(!J.target.checked)ee.includes(G)||ee.push(G);else{let te=ee.indexOf(G);te!==-1&&ee.splice(te,1)}O({...D,excludedAccountTypes:ee})}}),le.default.createElement("span",null,"Include in Dashboard")),le.default.createElement("label",{className:"toggle-label"},le.default.createElement("input",{type:"checkbox",checked:Q,onChange:J=>{O({...D,includeWithdrawalsFromExcluded:{...D.includeWithdrawalsFromExcluded,[G]:J.target.checked}})}}),le.default.createElement("span",null,"Include Withdrawals"))))})):le.default.createElement("div",{style:{color:"var(--text-muted)"}},"No account types available to configure.")))),le.default.createElement("div",{className:"setting-item"},le.default.createElement("div",{className:"setting-item-info"},le.default.createElement("div",{className:"setting-item-name"},"Display Order"),le.default.createElement("div",{className:"setting-item-description"},"Reorder how account types appear in the dashboard.")),le.default.createElement("div",{className:"setting-item-control"},le.default.createElement("div",{className:"account-type-order-container"},(()=>{let X=D.accountTypeOrder.length>0?D.accountTypeOrder:["funded","evaluation","demo","archived"],G=[...new Set([...i.map(ee=>ee.toLowerCase()),...X.map(ee=>ee.toLowerCase())])],U=new Map;i.forEach(ee=>U.set(ee.toLowerCase(),ee)),X.forEach(ee=>{U.has(ee.toLowerCase())||U.set(ee.toLowerCase(),ee.charAt(0).toUpperCase()+ee.slice(1))});let Q=[];X.forEach(ee=>{if(G.includes(ee.toLowerCase())){let te=U.get(ee.toLowerCase());te&&Q.push(te)}}),G.forEach(ee=>{if(!X.map(te=>te.toLowerCase()).includes(ee)){let te=U.get(ee);te&&Q.push(te)}});let J=(ee,te)=>{let ue=[...Q],be=te==="up"?ee-1:ee+1;be>=0&&be<ue.length&&([ue[ee],ue[be]]=[ue[be],ue[ee]],O({...D,accountTypeOrder:ue.map(Le=>Le.toLowerCase())}))};return le.default.createElement("div",{className:"account-type-order-list"},Q.length>0?le.default.createElement("div",{className:"order-list"},Q.map((ee,te)=>le.default.createElement("div",{key:ee,className:"order-list-item"},le.default.createElement("span",{className:"type-name"},z(ee)),le.default.createElement("div",{className:"order-controls"},le.default.createElement("button",{type:"button",className:"order-button",disabled:te===0,onClick:()=>J(te,"up"),"aria-label":`Move ${ee} up`,title:"Move up"},"\u2191"),le.default.createElement("button",{type:"button",className:"order-button",disabled:te===Q.length-1,onClick:()=>J(te,"down"),"aria-label":`Move ${ee} down`,title:"Move down"},"\u2193"))))):le.default.createElement("div",{style:{color:"var(--text-muted)"}},"No account types available to order."))})()))),le.default.createElement("div",{className:"settings-modal-buttons"},le.default.createElement(he,{variant:"primary",onClick:H,disabled:o,className:"save-settings-button"},o?"Saving...":"Save Settings"),le.default.createElement(he,{variant:"secondary",onClick:n,disabled:o,className:"cancel-button"},"Cancel")))}});var gt,k_e,Uue,Vue=L(()=>{gt=q(Y());er();eo();Ra();a4();i4();l4();hue();xue();Nr();UL();O4();Rue();lf();ba();k_e=({plugin:e})=>{let[t,r]=(0,gt.useState)([]),[n,o]=(0,gt.useState)(!0),[a,i]=(0,gt.useState)(null),[s,l]=(0,gt.useState)(""),[c,d]=(0,gt.useState)(0),[u,p]=(0,gt.useTransition)(),m=(0,gt.useDeferredValue)(s),f=(0,gt.useRef)(0),g=5,v=(0,gt.useRef)(null),h=(0,gt.useCallback)(async()=>{try{if(o(!0),i(null),!e.accountPageService){if(f.current+=1,f.current>g)throw f.current=0,new Error("AccountPageService not initialized after multiple attempts");let A=300*Math.pow(2,f.current-1);console.warn(`AccountPageService not ready, retrying in ${A}ms (attempt ${f.current}/${g})`),v.current=setTimeout(()=>h(),A);return}f.current=0;let I=await e.accountPageService.getAllEnhancedAccounts();r(I)}catch(I){console.error("Error loading accounts:",I),i(`Error loading accounts: ${I instanceof Error?I.message:String(I)}`)}finally{f.current===0&&o(!1)}},[e]),y=(0,gt.useCallback)(async()=>{e.accountPageService&&await e.accountPageService.refreshAllAccountData(),p(()=>{h()})},[h,e.accountPageService]);(0,gt.useEffect)(()=>(XC(),h(),document.addEventListener("journalit:account-created",y),document.addEventListener("journalit:account-updated",y),document.addEventListener("journalit:account-deleted",y),document.addEventListener("journalit:account-transaction-added",y),document.addEventListener("journalit:account-transaction-deleted",y),document.addEventListener("journalit-options-changed",y),document.addEventListener("journalit-account-type-changed",y),document.addEventListener("journalit:trade-data-changed",y),()=>{v.current&&(clearTimeout(v.current),v.current=null),document.removeEventListener("journalit:account-created",y),document.removeEventListener("journalit:account-updated",y),document.removeEventListener("journalit:account-deleted",y),document.removeEventListener("journalit:account-transaction-added",y),document.removeEventListener("journalit:account-transaction-deleted",y),document.removeEventListener("journalit-options-changed",y),document.removeEventListener("journalit-account-type-changed",y),document.removeEventListener("journalit:trade-data-changed",y)}),[h,y]);let b=(0,gt.useMemo)(()=>Zde(t,e.settings),[t,e.settings,c]),x=(0,gt.useMemo)(()=>{var I,A;return((A=(I=e.settings)==null?void 0:I.account)==null?void 0:A.excludedAccountTypes)||["archived"]},[e.settings]),w=(0,gt.useMemo)(()=>t.filter(I=>I.accountType&&!x.includes(I.accountType.toLowerCase())).reduce((I,A)=>I+A.currentBalance,0),[t,x]),S=(0,gt.useMemo)(()=>eue(t,e.settings),[t,e.settings,c]),k=(0,gt.useMemo)(()=>m?t.filter(I=>I.name.toLowerCase().includes(m.toLowerCase())):t,[t,m]),T=(0,gt.useMemo)(()=>tue(k),[k,c]),P=(0,gt.useMemo)(()=>{var C,F,M,_;let I=Object.keys(T),A=((F=(C=e==null?void 0:e.settings)==null?void 0:C.account)==null?void 0:F.accountTypeOrder)||["funded","evaluation","demo","archived"],j=((_=(M=e==null?void 0:e.optionsService)==null?void 0:M.getOptions)==null?void 0:_.call(M,"account_type"))||[],E=new Set([...I.map(W=>W.toLowerCase()),...A.map(W=>W.toLowerCase()),...j.map(W=>W.toLowerCase())]),N=new Map;I.forEach(W=>N.set(W.toLowerCase(),W)),A.forEach(W=>{if(!N.has(W.toLowerCase())){let $=W.charAt(0).toUpperCase()+W.slice(1).toLowerCase();N.set(W.toLowerCase(),$)}}),j.forEach(W=>{N.has(W.toLowerCase())||N.set(W.toLowerCase(),W)});let B=[];return A.forEach(W=>{let $=N.get(W.toLowerCase());$&&E.has(W.toLowerCase())&&(B.push($),E.delete(W.toLowerCase()))}),E.forEach(W=>{let $=N.get(W);$&&B.push($)}),B},[T,e,c]),D=(0,gt.useCallback)(async(I,A)=>{e.viewManager.openAccountPageView(I)},[e.viewManager]),O=(0,gt.useCallback)(async()=>{F4(e.app,e,()=>{h()})},[e,h]),z=(0,gt.useCallback)(async()=>{Wue(e.app,e,()=>{d(I=>I+1),h()})},[e,h]);return n?gt.default.createElement("div",{className:"journalit-account-dashboard"},gt.default.createElement(m4,null)):a?gt.default.createElement("div",{className:"journalit-account-dashboard error"},gt.default.createElement("div",{className:"error-message"},a)):t.length===0?gt.default.createElement("div",{className:"journalit-account-dashboard"},gt.default.createElement("div",{className:"empty-state-with-action"},gt.default.createElement(et,{message:"No Accounts Found",subMessage:"Create an account to start tracking your trading performance"}),gt.default.createElement("div",{className:"empty-state-actions"},gt.default.createElement(he,{variant:"primary",onClick:O,className:"create-account-primary-button"},"Create Your First Account")))):gt.default.createElement("div",{className:"journalit-account-dashboard"},gt.default.createElement("div",{className:"dashboard-content"},gt.default.createElement("div",{className:"dashboard-header"},gt.default.createElement("div",{className:"dashboard-title"},gt.default.createElement("h2",null,"Account Dashboard")),gt.default.createElement("div",{className:"dashboard-actions"},gt.default.createElement(xh,{ariaLabel:"Create new account",onClick:O,className:"create-account-button"},gt.default.createElement(kl,{size:18})),gt.default.createElement(xh,{ariaLabel:"Account dashboard settings",onClick:z,className:"settings-button"},gt.default.createElement(Kp,{size:16})))),gt.default.createElement(sue,{data:S,plugin:e}),gt.default.createElement(lue,{metrics:b}),gt.default.createElement(p4,{accounts:t,accountsByType:T,accountTypesToDisplay:P,totalAUM:w,excludedTypes:x,showLegend:!0}),gt.default.createElement(pue,{accountsByType:T,openAccount:D,plugin:e,refreshTrigger:c,totalAUM:w,excludedTypes:x})))},Uue=gt.default.memo(k_e)});var Hue=L(()=>{Xde();lf();Vue();a4();i4();l4();$L()});var que,z4,Gue,qL,Yue=L(()=>{que=require("obsidian"),z4=q(Y()),Gue=q(wn());Hue();Oo();rr();qL=class extends que.ItemView{constructor(r,n){super(r);this.root=null;this.plugin=n}getViewType(){return"account-dashboard"}getDisplayText(){return"Account Dashboard"}getIcon(){return"users"}async onOpen(){var o;(o=ce.account)!=null&&o.inject&&ce.account.inject();let r=this.containerEl.children[1];r.empty(),r.addClass("journalit-account-dashboard-container");let n=r.createDiv();this.root=(0,Gue.createRoot)(n),this.renderDashboard()}async onClose(){var r;this.root&&(this.root.unmount(),this.root=null),(r=ce.account)!=null&&r.remove&&ce.account.remove()}renderDashboard(){this.root&&this.root.render(z4.createElement(cs,{children:null},z4.createElement(Uue,{plugin:this.plugin})))}}});var kh,Kue=L(()=>{CL();wt();ci();ga();kh=class{constructor(t){this.cache=new Map;this.lastUpdateTime=0;this.updateThreshold=5e3;this.CACHE_VERSION=2;this.forceFreshNextLoad=!1;this.cachedTradingDayCutoffTime=null;this.cachedEnrichedTrades=null;this.tradingDayStringCache=new Map;this.plugin=t,this.tradeService=yh.getInstance(t.app,t).getTradeService(),this.cacheTradingDaySettings(),this.tradeDataChangeHandler=r=>{this.clearCache(),this.forceFreshNextLoad=!0},document.addEventListener("journalit:trade-data-changed",this.tradeDataChangeHandler),document.addEventListener("journalit:missed-trade-data-changed",this.tradeDataChangeHandler),document.addEventListener("journalit:backtest-trade-data-changed",this.tradeDataChangeHandler)}async getTradesWithPaths(t){let r=await this.tradeService.getTradeData({fresh:this.forceFreshNextLoad});this.forceFreshNextLoad=!1;let n=/(!Journalit|journalit)/i,a=r.filter(i=>i.path&&n.test(i.path)).map(i=>({...i,filePath:i.path||i.filePath,isBacktestTrade:i.isBacktestTrade||i.type==="backtest-trade",isMissedTrade:i.isMissedTrade||i.type==="missed-trade"}));if(this.shouldLoadMissedTrades(t)){let i=await this.plugin.serviceManager.getMissedTradeService();if(i)try{let s=new Date("2000-01-01"),l=new Date("2099-12-31"),c=await i.getMissedTrades(s,l);for(let d of c){let u=this.plugin.app.metadataCache.getFileCache(d),p=u==null?void 0:u.frontmatter;p&&p.type==="missed-trade"&&a.push({...p,filePath:d.path,isMissedTrade:!0,path:d.path})}}catch(s){console.error("Error fetching missed trades for trade log:",s)}}return a}async getHierarchicalData(t,r,n,o,a,i,s,l){let c=b=>!b||b.length===0?"ALL":b.join(","),d=`v${this.CACHE_VERSION}-${t}-${r==null?void 0:r.toISOString()}-${n==null?void 0:n.toISOString()}-${c(o)}-${c(a)}-${c(i)}-${c(s)}-${c(l)}`,u=Date.now();if(this.cache.has(d)&&u-this.lastUpdateTime<this.updateThreshold)return this.cache.get(d).children||[];!this.cache.has(d.split("-")[0])&&(this.cachedEnrichedTrades=null);let f=await this.getTradesWithPaths(o);(r||n)&&(f=this.filterTradesByDateRange(f,r,n)),o&&o.length>0&&(f=this.filterTradesByType(f,o)),a&&a.length>0&&(f=this.filterTradesByStatus(f,a)),i&&i.length>0&&(f=this.filterTradesByAccount(f,i)),s&&s.length>0&&(f=this.filterTradesByTicker(f,s)),l&&l.length>0&&(f=this.filterTradesBySetup(f,l));let g=this.preComputeDateComponents(f);this.cachedEnrichedTrades=g;let v;switch(t){case"years":v=await this.buildYearNodesOptimized(g);break;case"quarters":v=await this.buildQuarterNodesOptimized(g);break;case"months":v=await this.buildMonthNodesOptimized(g);break;case"weeks":v=await this.buildWeekNodesOptimized(g);break;case"days":v=await this.buildDayNodesOptimized(g);break;case"trades":v=await this.buildTradeNodesOptimized(g);break;default:v=[]}v.length<50&&this.markBestWorstPerformers(v);let y={type:"root",id:"root",label:"All Trades",metrics:g.length>500?this.calculateMetricsLightweight(g):this.calculateMetrics(g),children:v,expanded:!0,dataLoaded:!0};return this.cache.set(d,y),this.lastUpdateTime=u,v}cacheTradingDaySettings(){var t,r,n;try{this.cachedTradingDayCutoffTime=((n=(r=(t=this.plugin)==null?void 0:t.settings)==null?void 0:r.trade)==null?void 0:n.tradingDayCutoffTime)||null}catch(o){this.cachedTradingDayCutoffTime=null}}async getNodeChildren(t){if(!this.cachedEnrichedTrades||this.cachedEnrichedTrades.length===0){let a=await this.getTradesWithPaths();this.cachedEnrichedTrades=this.preComputeDateComponents(a)}let r=this.cachedEnrichedTrades,n=this.filterTradesByNode(r,t),o=[];switch(t.type){case"year":o=this.buildQuartersForYear(n,parseInt(t.id));break;case"quarter":o=this.buildMonthsForQuarter(n,t.id);break;case"month":o=this.buildWeeksForMonth(n,t.id);break;case"week":o=this.buildDaysForWeek(n,t.id);break;case"day":o=await this.buildTradesForDay(n,t.id);break;default:return[]}return this.markBestWorstPerformers(o),o}async buildFullHierarchy(t){let r=new Map;t.forEach(a=>{let s=new Date(a.entryTime).getFullYear();r.has(s)||r.set(s,[]),r.get(s).push(a)});let n=[],o=Array.from(r.keys()).sort((a,i)=>i-a);for(let a of o){let i=r.get(a),s=this.buildQuartersForYear(i,a);n.push({type:"year",id:a.toString(),label:a.toString(),metrics:this.calculateMetrics(i),children:s,expanded:a===new Date().getFullYear(),dataLoaded:!0})}return this.markBestWorstPerformersRecursive(n),n}async buildYearNodes(t){let r=new Map;t.forEach(a=>{let s=new Date(a.entryTime).getFullYear();r.has(s)||r.set(s,[]),r.get(s).push(a)});let n=[],o=Array.from(r.keys()).sort((a,i)=>i-a);for(let a of o){let i=r.get(a);n.push({type:"year",id:a.toString(),label:a.toString(),metrics:this.calculateMetrics(i),expanded:!1,dataLoaded:!1})}return n}preComputeDateComponents(t){return t.map((n,o)=>{let a=n.entryTime||n["entry-time"]||n.date;if(!a)return null;let i=new Date(a);if(isNaN(i.getTime()))return null;let s=i.getFullYear(),l=i.getMonth(),c=Math.floor(l/3)+1;return{...n,_dateComponents:{date:i,year:s,month:l+1,quarter:c,dayKey:Oi(i),weekNum:this.getISOWeekNumber(i),tradingDayString:this.getTradingDayStringMemoized(i)}}}).filter(n=>n!==null)}getTradingDayStringMemoized(t){let r=t.toISOString();if(!this.tradingDayStringCache.has(r)){let n=this.cachedTradingDayCutoffTime?this.getTradingDayStringWithCachedSettings(t,this.cachedTradingDayCutoffTime):Cc(t,this.plugin);this.tradingDayStringCache.set(r,n)}return this.tradingDayStringCache.get(r)}getTradingDayStringWithCachedSettings(t,r){try{let[n,o]=r.split(":").map(Number),a=n*60+o;if(t.getHours()*60+t.getMinutes()<a){let s=new Date(t);return s.setDate(t.getDate()-1),Oi(s)}return Oi(t)}catch(n){return Oi(t)}}getISOWeekNumber(t){return Qp(t)}calculateMetricsLightweight(t){if(t.length===0)return{totalPnL:0,winRate:0,tradeCount:0};let r=t.filter(s=>this.getTradeStatus(s)==="open"),n=t.filter(s=>this.getTradeStatus(s)!=="open"&&!s.isMissedTrade),o=n.filter(s=>(s.pnl||0)>0).length,a=n.reduce((s,l)=>s+(l.pnl||0),0),i=n.reduce((s,l)=>s+(l.rMultiple||0),0);return{totalPnL:a,winRate:n.length>0?o/n.length*100:0,tradeCount:t.length,openTradeCount:r.length,closedTradeCount:n.length,totalRMultiple:i}}calculateMetrics(t){if(t.length===0)return{totalPnL:0,winRate:0,tradeCount:0};let r=t.filter(u=>this.getTradeStatus(u)==="open"),n=t.filter(u=>this.getTradeStatus(u)!=="open"&&!u.isMissedTrade),o=n.filter(u=>(u.pnl||0)>0).length,a=n.filter(u=>(u.pnl||0)<0).length,i=n.reduce((u,p)=>u+(p.pnl||0),0),s=n.reduce((u,p)=>u+(p.rMultiple||0),0),l=new Map;n.length<100&&n.forEach(u=>{let p=new Date(u.entryTime),m=Oi(p);l.set(m,(l.get(m)||0)+(u.pnl||0))});let c={label:"",pnl:-1/0},d={label:"",pnl:1/0};return l.size>0&&l.forEach((u,p)=>{u>c.pnl&&(c={label:p,pnl:u}),u<d.pnl&&(d={label:p,pnl:u})}),{totalPnL:i,winRate:n.length>0?o/n.length*100:0,tradeCount:t.length,openTradeCount:r.length,closedTradeCount:n.length,totalRMultiple:s,bestPeriod:c.label&&l.size>0?c:void 0,worstPeriod:d.label&&l.size>0?d:void 0}}getTradeStatus(t){return Bw(t,this.plugin.settings.trade)}filterTradesByDateRange(t,r,n){return!r&&!n?t:t.filter(o=>{let a=new Date(o.entryTime);return!(r&&a<r||n&&a>n)})}filterTradesByType(t,r){return!r||r.length===0?t:t.filter(n=>n.isMissedTrade?r.includes("missed"):n.isBacktestTrade?r.includes("backtest"):r.includes("regular"))}filterTradesByStatus(t,r){return!r||r.length===0?t:t.filter(n=>{let o=Bw(n,this.plugin.settings.trade);if(["open","win","loss","breakeven"].includes(o))return r.includes(o);if(o==="missed"||o==="backtest"){let a=cv(n),i=Pt(n);if(i&&r.includes("open")||!i&&a>0&&r.includes("win")||!i&&a<0&&r.includes("loss")||!i&&a===0&&r.includes("breakeven"))return!0}return!1})}filterTradesByAccount(t,r){return!r||r.length===0?t:t.filter(n=>{let o=a=>a?Array.isArray(a)?a.some(i=>r.includes(i)):typeof a=="string"?r.includes(a):!1:!1;return o(n.account)||o(n.accountIds)})}filterTradesByTicker(t,r){return!r||r.length===0?t:t.filter(n=>{var a;let o=((a=n.instrument)==null?void 0:a.toLowerCase())||"";return r.some(i=>o.includes(i.toLowerCase()))})}filterTradesBySetup(t,r){return!r||r.length===0?t:t.filter(n=>r.includes("__NO_SETUP__")&&(!n.setup||n.setup.length===0)?!0:n.setup&&Array.isArray(n.setup)&&n.setup.length>0?n.setup.some(o=>r.some(a=>o.toLowerCase()===a.toLowerCase())):!1)}async getUniqueAccounts(){return await this.tradeService.getUniqueAccounts()}filterTradesByNode(t,r){switch(r.type){case"year":let n=parseInt(r.id);return t.filter(b=>b._dateComponents?b._dateComponents.year===n:new Date(b.entryTime).getFullYear()===n);case"quarter":let[o,a]=r.id.split("-Q"),i=parseInt(a),s=parseInt(o);return t.filter(b=>{if(b._dateComponents)return b._dateComponents.year===s&&b._dateComponents.quarter===i;let x=(i-1)*3,w=x+2,S=new Date(b.entryTime);return S.getFullYear()===s&&S.getMonth()>=x&&S.getMonth()<=w});case"month":let[l,c]=r.id.split("-"),d=parseInt(c),u=parseInt(l);return t.filter(b=>{if(b._dateComponents)return b._dateComponents.year===u&&b._dateComponents.month===d;let x=new Date(b.entryTime);return x.getFullYear()===u&&x.getMonth()===d-1});case"week":let p=r.id.split("-W"),m=p[1],f=parseInt(m),g=p[0],v=parseInt(g.split("-")[0]),h=parseInt(g.split("-")[1]);return t.filter(b=>{if(b._dateComponents)return b._dateComponents.year===v&&b._dateComponents.weekNum===f&&b._dateComponents.month===h;let x=new Date(b.entryTime);return x.getFullYear()===v&&Qp(x)===f&&x.getMonth()+1===h});case"day":return t.filter((b,x)=>{if(b._dateComponents&&b._dateComponents.tradingDayString)return b._dateComponents.tradingDayString===r.id;let w=new Date(b.entryTime);return Cc(w,this.plugin)===r.id});default:return t}}async buildQuarterNodes(t){let r=new Map;t.forEach(a=>{let i=new Date(a.entryTime),s=i.getFullYear(),l=av(i),c=`${s}-Q${l}`;r.has(c)||r.set(c,[]),r.get(c).push(a)});let n=[],o=Array.from(r.keys()).sort((a,i)=>i.localeCompare(a));for(let a of o){let i=r.get(a),[s,l]=a.split("-Q");n.push({type:"quarter",id:a,label:`Q${l} ${s}`,metrics:this.calculateMetrics(i),expanded:!1,dataLoaded:!1})}return n}async buildMonthNodes(t){let r=new Map;t.forEach(i=>{let s=new Date(i.entryTime),l=`${s.getFullYear()}-${(s.getMonth()+1).toString().padStart(2,"0")}`;r.has(l)||r.set(l,[]),r.get(l).push(i)});let n=[],o=Array.from(r.keys()).sort((i,s)=>s.localeCompare(i)),a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];for(let i of o){let s=r.get(i),[l,c]=i.split("-");n.push({type:"month",id:i,label:`${a[parseInt(c)-1]} ${l}`,metrics:this.calculateMetrics(s),expanded:!1,dataLoaded:!1})}return n}async buildWeekNodes(t){let r=new Map;t.forEach(a=>{let i=new Date(a.entryTime),s=Qp(i),l=i.getFullYear(),c=(i.getMonth()+1).toString().padStart(2,"0"),d=`${l}-${c}-W${s.toString().padStart(2,"0")}`;r.has(d)||r.set(d,[]),r.get(d).push(a)});let n=[],o=Array.from(r.keys()).sort((a,i)=>i.localeCompare(a));for(let a of o){let i=r.get(a);n.push({type:"week",id:a,label:a.replace(/^\d{4}-\d{2}-W/,s=>s.substring(0,4)+" Week "),metrics:this.calculateMetrics(i),expanded:!1,dataLoaded:!1})}return n}async buildDayNodes(t){let r=new Map;t.forEach(a=>{let i=new Date(a.entryTime),s=Cc(i,this.plugin);r.has(s)||r.set(s,[]),r.get(s).push(a)});let n=[],o=Array.from(r.keys()).sort((a,i)=>i.localeCompare(a));for(let a of o){let i=r.get(a);n.push({type:"day",id:a,label:new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),metrics:this.calculateMetrics(i),expanded:!1,dataLoaded:!1})}return n}clearCache(){this.cache.clear(),this.tradingDayStringCache.clear(),this.cachedEnrichedTrades=null,this.lastUpdateTime=0,this.cacheTradingDaySettings(),this.tradeService.clearCache()}markBestWorstPerformers(t){if(t.length===0||t[0].type==="trade")return;let r=null,n=null,o=-1/0,a=1/0;if(t.forEach(i=>{let s=i.metrics.totalPnL;s>0&&s>o&&(o=s,r=i),s<0&&s<a&&(a=s,n=i)}),t.length===1){let i=t[0];i.metrics.totalPnL>0?i.performanceIndicator="best":i.metrics.totalPnL<0&&(i.performanceIndicator="worst")}else r!==null&&o>0&&(r.performanceIndicator="best"),n!==null&&a<0&&n!==r&&(n.performanceIndicator="worst")}markBestWorstPerformersRecursive(t){this.markBestWorstPerformers(t),t.forEach(r=>{r.children&&r.children.length>0&&this.markBestWorstPerformersRecursive(r.children)})}markBestWorstTrades(t){var i;if(t.length===0)return;let r=null,n=null,o=-1/0,a=1/0;if(t.forEach(s=>{var c;let l=((c=s.trade)==null?void 0:c.pnl)||0;l>0&&l>o&&(o=l,r=s),l<0&&l<a&&(a=l,n=s)}),t.length===1){let s=t[0],l=((i=s.trade)==null?void 0:i.pnl)||0;l>0?s.trade&&(s.trade.performanceIndicator="best"):l<0&&s.trade&&(s.trade.performanceIndicator="worst")}else r!==null&&o>0&&r.trade&&(r.trade.performanceIndicator="best"),n!==null&&a<0&&n!==r&&n.trade&&(n.trade.performanceIndicator="worst")}async buildTradeNodes(t){let r=[...t].sort((a,i)=>{let s=new Date(a.entryTime);return new Date(i.entryTime).getTime()-s.getTime()});if(r.length<100)return r.map(i=>{let s=new Date(i.entryTime),l=rt(s),c=this.getTradeStatus(i),d=c==="open",u=d?0:i.pnl||0,p=i.instrument||"Unknown",m=`${p} - ${l}${d?" (OPEN)":""}`;return{type:"trade",id:i.filePath||`trade-${p}-${s.getTime()}`,label:m,metrics:{totalPnL:u,winRate:d?0:u>0?100:0,tradeCount:1,status:c},trade:i,expanded:!1,dataLoaded:!0}});let n=[],o=50;for(let a=0;a<r.length;a+=o){let s=r.slice(a,a+o).map(l=>{let c=new Date(l.entryTime),d=rt(c),u=this.getTradeStatus(l),p=u==="open",m=p?0:l.pnl||0,f=l.instrument||"Unknown",g=`${f} - ${d}${p?" (OPEN)":""}`;return{type:"trade",id:l.filePath||`trade-${f}-${c.getTime()}`,label:g,metrics:{totalPnL:m,winRate:p?0:m>0?100:0,tradeCount:1,status:u},trade:l,expanded:!1,dataLoaded:!0}});n.push(...s),a/o%3===0&&a+o<r.length&&await new Promise(l=>setTimeout(l,0))}return n}async buildTradesForDay(t,r){try{return await this.buildTradeNodesOptimized(t)}catch(n){return console.error("Error building trades for day:",n),[]}}buildQuartersForYear(t,r){let n=new Map;t.forEach(a=>{let i=new Date(a.entryTime),s=av(i);n.has(s)||n.set(s,[]),n.get(s).push(a)});let o=[];for(let a=4;a>=1;a--)if(n.has(a)){let i=n.get(a);o.push({type:"quarter",id:`${r}-Q${a}`,label:`Q${a}`,metrics:this.calculateMetrics(i),expanded:!1,dataLoaded:!1})}return o}buildMonthsForQuarter(t,r){let[n,o]=r.split("-Q"),i=(parseInt(o)-1)*3,s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],l=new Map;t.forEach(d=>{let p=new Date(d.entryTime).getMonth();l.has(p)||l.set(p,[]),l.get(p).push(d)});let c=[];for(let d=i+2;d>=i;d--)if(l.has(d)){let u=l.get(d);c.push({type:"month",id:`${n}-${(d+1).toString().padStart(2,"0")}`,label:s[d],metrics:this.calculateMetrics(u),expanded:!1,dataLoaded:!1})}return c}buildWeeksForMonth(t,r){let n=new Map;t.forEach(i=>{let s=new Date(i.entryTime),l=Qp(s);n.has(l)||n.set(l,[]),n.get(l).push(i)});let o=[],a=Array.from(n.keys()).sort((i,s)=>s-i);for(let i of a){let s=n.get(i),[l]=r.split("-");o.push({type:"week",id:`${r}-W${i.toString().padStart(2,"0")}`,label:`Week ${i}`,metrics:this.calculateMetrics(s),expanded:!1,dataLoaded:!1})}return o}buildDaysForWeek(t,r){let n=new Map,o=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];t.forEach(s=>{let l=new Date(s.entryTime),c=Cc(l,this.plugin);n.has(c)||n.set(c,[]),n.get(c).push(s)});let a=[],i=Array.from(n.keys()).sort((s,l)=>l.localeCompare(s));for(let s of i){let l=n.get(s),c=new Date(s),d=o[c.getDay()];a.push({type:"day",id:s,label:`${d} ${c.getDate()}`,metrics:this.calculateMetrics(l),expanded:!1,dataLoaded:!1})}return a}async buildTradeNodesOptimized(t){let r=[...t].sort((o,a)=>a._dateComponents.date.getTime()-o._dateComponents.date.getTime());return r.length>200?await this.buildTradeNodesLightweight(r):r.map((o,a)=>{let i=rt(o._dateComponents.date),s=this.getTradeStatus(o),l=s==="open",c=l?0:o.pnl||0,d=o.instrument||"Unknown",u=`${d} - ${i}${l?" (OPEN)":""}`;return{type:"trade",id:o.filePath||`trade-${d}-${o._dateComponents.date.getTime()}`,label:u,metrics:{totalPnL:c,winRate:l?0:c>0?100:0,tradeCount:1,status:s},trade:o,expanded:!1,dataLoaded:!0}})}async buildTradeNodesLightweight(t){let r=[];for(let o=0;o<t.length;o+=100){let i=t.slice(o,o+100).map(s=>{let l=this.getTradeStatus(s),c=l==="open",d=c?0:s.pnl||0,u=s.instrument||"Unknown",p=`${u} - ${s._dateComponents.dayKey}${c?" (OPEN)":""}`;return{type:"trade",id:s.filePath||`trade-${u}-${s._dateComponents.date.getTime()}`,label:p,metrics:{totalPnL:d,winRate:c?0:d>0?100:0,tradeCount:1,status:l},trade:s,expanded:!1,dataLoaded:!0}});r.push(...i),o%200===0&&o+100<t.length&&await new Promise(s=>setTimeout(s,0))}return r}async buildYearNodesOptimized(t){let r=new Map;t.forEach(a=>{let i=a._dateComponents.year;r.has(i)||r.set(i,[]),r.get(i).push(a)});let n=[],o=Array.from(r.keys()).sort((a,i)=>i-a);for(let a of o){let i=r.get(a);n.push({type:"year",id:a.toString(),label:a.toString(),metrics:i.length>500?this.calculateMetricsLightweight(i):this.calculateMetrics(i),expanded:!1,dataLoaded:!1})}return n}async buildQuarterNodesOptimized(t){let r=new Map;t.forEach(a=>{let i=a._dateComponents.year,s=a._dateComponents.quarter,l=`${i}-Q${s}`;r.has(l)||r.set(l,[]),r.get(l).push(a)});let n=[],o=Array.from(r.keys()).sort((a,i)=>i.localeCompare(a));for(let a of o){let i=r.get(a),[s,l]=a.split("-Q");n.push({type:"quarter",id:a,label:`Q${l} ${s}`,metrics:i.length>500?this.calculateMetricsLightweight(i):this.calculateMetrics(i),expanded:!1,dataLoaded:!1})}return n}async buildMonthNodesOptimized(t){let r=new Map;t.forEach(i=>{let s=`${i._dateComponents.year}-${i._dateComponents.month.toString().padStart(2,"0")}`;r.has(s)||r.set(s,[]),r.get(s).push(i)});let n=[],o=Array.from(r.keys()).sort((i,s)=>s.localeCompare(i)),a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];for(let i of o){let s=r.get(i),[l,c]=i.split("-");n.push({type:"month",id:i,label:`${a[parseInt(c)-1]} ${l}`,metrics:s.length>500?this.calculateMetricsLightweight(s):this.calculateMetrics(s),expanded:!1,dataLoaded:!1})}return n}async buildWeekNodesOptimized(t){let r=new Map;t.forEach(a=>{let i=`${a._dateComponents.year}-${a._dateComponents.month.toString().padStart(2,"0")}-W${a._dateComponents.weekNum.toString().padStart(2,"0")}`;r.has(i)||r.set(i,[]),r.get(i).push(a)});let n=[],o=Array.from(r.keys()).sort((a,i)=>i.localeCompare(a));for(let a of o){let i=r.get(a);n.push({type:"week",id:a,label:a.replace("-W"," Week "),metrics:i.length>500?this.calculateMetricsLightweight(i):this.calculateMetrics(i),expanded:!1,dataLoaded:!1})}return n}async buildDayNodesOptimized(t){let r=new Map;t.forEach((a,i)=>{let s=a._dateComponents.tradingDayString;r.has(s)||r.set(s,[]),r.get(s).push(a)});let n=[],o=Array.from(r.keys()).sort((a,i)=>i.localeCompare(a));for(let a of o){let i=r.get(a);n.push({type:"day",id:a,label:new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),metrics:i.length>500?this.calculateMetricsLightweight(i):this.calculateMetrics(i),expanded:!1,dataLoaded:!1})}return n}shouldLoadMissedTrades(t){return!t||t.length===0?!0:t.includes("missed")}destroy(){this.tradeDataChangeHandler&&(document.removeEventListener("journalit:trade-data-changed",this.tradeDataChangeHandler),document.removeEventListener("journalit:missed-trade-data-changed",this.tradeDataChangeHandler),document.removeEventListener("journalit:backtest-trade-data-changed",this.tradeDataChangeHandler)),this.tradingDayStringCache.clear(),this.cache.clear()}}});var _4=L(()=>{Kue();v0()});function Jue(e,t){return(t.length>0?t:mp.map(n=>n.id)).map(n=>mp.find(o=>o.id===n)).filter(n=>n?Object.keys(e).length===0?n.defaultVisible:e[n.id]!==void 0?e[n.id]:n.defaultVisible:!1)}function Xue(e,t){let r=e.map(n=>n.width===0?"minmax(320px, 2fr)":n.id==="select"?"40px":n.id==="image"?"50px":`minmax(${n.width}px, 1fr)`).join(" ");return t&&t!=="trades"?`20px ${r}`:r}function Que(){return mp.map(e=>e.id)}function Zue(e,t){if(!t)return"ArrowUpDown";switch(e){case"currency":case"number":case"date":return t==="asc"?"ArrowUp01":"ArrowDown10";case"duration":return t==="asc"?"ArrowUpNarrowWide":"ArrowDownWideNarrow";case"text":case"boolean":default:return t==="asc"?"ArrowUpAZ":"ArrowDownZA"}}var mp,B4=L(()=>{mp=[{id:"select",label:"",width:40,sortable:!1,defaultVisible:!1,type:"text"},{id:"image",label:"Image",width:50,sortable:!1,defaultVisible:!0,type:"image"},{id:"account",label:"Account",width:100,sortable:!1,defaultVisible:!0,type:"text"},{id:"ticker",label:"Ticker",width:120,sortable:!1,defaultVisible:!0,type:"text"},{id:"status",label:"Status",width:100,sortable:!1,defaultVisible:!0,type:"text"},{id:"pnl",label:"P&L",width:120,sortable:!0,defaultVisible:!0,type:"currency"},{id:"direction",label:"Direction",width:100,sortable:!1,defaultVisible:!0,type:"text"},{id:"setups",label:"Setups",width:100,sortable:!1,defaultVisible:!0,type:"text"},{id:"mistakes",label:"Mistakes",width:100,sortable:!1,defaultVisible:!0,type:"text"},{id:"tags",label:"Tags",width:100,sortable:!1,defaultVisible:!0,type:"text"},{id:"date",label:"Date",width:100,sortable:!0,defaultVisible:!0,type:"date"},{id:"reviewed",label:"Reviewed",width:100,sortable:!1,defaultVisible:!0,type:"boolean"},{id:"duration",label:"Duration",width:100,sortable:!0,defaultVisible:!1,type:"duration"},{id:"positionSize",label:"Size",width:120,sortable:!0,defaultVisible:!1,type:"number"},{id:"expirationDate",label:"Expiry",width:110,sortable:!0,defaultVisible:!1,type:"date"},{id:"daysToExpiry",label:"DTE",width:80,sortable:!0,defaultVisible:!1,type:"number"},{id:"thesis",label:"Thesis",width:0,sortable:!1,defaultVisible:!1,type:"text"}]});function rpe(e){new $4(e).open()}var Qb,epe,Cr,$4,S_e,tpe,npe=L(()=>{Qb=require("obsidian"),epe=q(wn()),Cr=q(Y());B4();E0();U1();Wv();er();g4();t1();$4=class extends Qb.Modal{constructor(r){super(r.app);this.root=null;this.props=r}onOpen(){let{contentEl:r}=this;r.empty(),r.style.display="flex",r.style.flexDirection="column",r.style.minHeight="400px",r.style.maxHeight="80vh",Lv(),this.container=r.createDiv(),this.renderComponent()}onClose(){this.root&&(this.root.unmount(),this.root=null),e1(),this.props.onClose()}renderComponent(){this.root=(0,epe.createRoot)(this.container),this.root.render(Cr.default.createElement(S_e,{...this.props,onModalClose:()=>this.close()}))}},S_e=({app:e,plugin:t,onSave:r,onModalClose:n})=>{var m,f,g,v;let[o,a]=(0,Cr.useState)(()=>{var w;let h=((w=t.settings)==null?void 0:w.tradeLog)||{columnVisibility:{},columnOrder:Que()},y=h.columnVisibility||{},b=h.columnOrder||[],x=mp.filter(S=>S.id!=="select").map(S=>{var k;return{...S,visible:(k=y[S.id])!=null?k:S.defaultVisible}});if(b.length>0){let S=b.map(T=>x.find(P=>P.id===T)).filter(T=>T!==void 0),k=x.filter(T=>!b.includes(T.id));return[...S,...k]}return x}),[i,s]=(0,Cr.useState)(!1);(0,Cr.useEffect)(()=>{var w;let h=(w=t.settings)==null?void 0:w.tradeLog;if(!h)return;let y=h.columnVisibility||{},b=h.columnOrder||[],x=mp.filter(S=>S.id!=="select").map(S=>{var k;return{...S,visible:(k=y[S.id])!=null?k:S.defaultVisible}});if(b.length>0){let S=b.map(T=>x.find(P=>P.id===T)).filter(T=>T!==void 0),k=x.filter(T=>!b.includes(T.id));a([...S,...k])}else a(x)},[(f=(m=t.settings)==null?void 0:m.tradeLog)==null?void 0:f.columnVisibility,(v=(g=t.settings)==null?void 0:g.tradeLog)==null?void 0:v.columnOrder]);let l=(0,Cr.useCallback)(h=>{let{active:y,over:b}=h;!b||y.id===b.id||a(x=>{let w=x.findIndex(P=>P.id===y.id),S=x.findIndex(P=>P.id===b.id);if(w===-1||S===-1)return x;let k=[...x],[T]=k.splice(w,1);return k.splice(S,0,T),k})},[]),c=(0,Cr.useCallback)((h,y)=>{a(b=>{let x=b.map(S=>S.id===h?{...S,visible:y}:S);return x.filter(S=>S.visible).length===0?(new Qb.Notice("At least one column must remain visible"),b):x})},[]),d=(0,Cr.useCallback)(async()=>{try{s(!0);let h={},y=[];o.forEach(b=>{h[b.id]=b.visible,y.push(b.id)}),t.settings.tradeLog||(t.settings.tradeLog={columnVisibility:{},columnOrder:[],columnWidths:{}}),t.settings.tradeLog.columnVisibility=h,t.settings.tradeLog.columnOrder=y,await t.saveSettings(),new Qb.Notice("TradeLog column settings saved successfully"),r(),n()}catch(h){console.error("Error saving TradeLog settings:",h),new Qb.Notice(`Error saving settings: ${h.message}`)}finally{s(!1)}},[o,t,r,n]),u=(0,Cr.useCallback)(()=>{n()},[n]),p=(0,Cr.useCallback)(()=>{let h=mp.filter(y=>y.id!=="select").map(y=>({...y,visible:y.defaultVisible}));a(h)},[]);return Cr.default.createElement(Cr.default.Fragment,null,Cr.default.createElement("div",{className:"tradelog-settings-modal-container"},Cr.default.createElement("div",{className:"tradelog-settings-modal-content"},Cr.default.createElement("div",{className:"tradelog-settings-section"},Cr.default.createElement("div",{className:"tradelog-settings-section-title"},"Column Visibility and Order"),Cr.default.createElement(Uv,{collisionDetection:Rv,onDragEnd:l},Cr.default.createElement(Vv,{items:o.map(h=>h.id),strategy:GY},o.map(h=>Cr.default.createElement(tpe,{key:h.id,column:h,columns:o,onVisibilityToggle:c}))))))),Cr.default.createElement("div",{className:"tradelog-settings-modal-buttons"},Cr.default.createElement("button",{onClick:p,disabled:i,className:"reset-button"},"Reset to Defaults"),Cr.default.createElement("button",{onClick:u,disabled:i},"Cancel"),Cr.default.createElement("button",{onClick:d,disabled:i,className:"primary"},i?"Saving...":"Save")))},tpe=Cr.default.memo(({column:e,columns:t,onVisibilityToggle:r})=>{let{attributes:n,listeners:o,setNodeRef:a,transform:i,transition:s,isDragging:l}=Hv({id:e.id}),c={transform:Nl.Transform.toString(i),transition:l?s:void 0,opacity:l?.5:1},d=e.visible&&t.filter(u=>u.visible).length===1;return Cr.default.createElement("div",{ref:a,style:c,className:`sortable-column-item ${l?"dragging":""}`,onClick:()=>r(e.id,!e.visible)},Cr.default.createElement("div",{className:"column-drag-handle",...n,...o,onClick:u=>u.stopPropagation()},Cr.default.createElement(Tw,{size:16})),Cr.default.createElement("div",{onClick:u=>u.stopPropagation(),style:{display:"contents"}},Cr.default.createElement(wh,{checked:e.visible,onChange:u=>r(e.id,u),disabled:d,id:`column-visibility-${e.id}`,ariaLabel:`Toggle visibility for ${e.label}`})),Cr.default.createElement("div",{className:"column-label"},e.label))});tpe.displayName="SortableColumnItem"});var Pr,GL,ope=L(()=>{Pr=q(Y());v0();JO();m0();s2();_4();npe();er();GL=(0,Pr.memo)(({app:e,plugin:t,filters:r,onFilterChange:n,onSettingsChange:o,isMultiSelectMode:a,onToggleMultiSelectMode:i})=>{let[s,l]=(0,Pr.useState)([]),c=(0,Pr.useRef)(null);c.current||(c.current=new kh(t));let d=c.current;(0,Pr.useEffect)(()=>((async()=>{if(d){let g=await d.getUniqueAccounts();l(g)}})(),()=>{c.current&&c.current.destroy()}),[d]);let u=()=>{let f=0;return r.tradeTypes&&r.tradeTypes.length>0&&r.tradeTypes.length<3&&f++,r.statuses&&r.statuses.length>0&&r.statuses.length<4&&f++,r.accounts&&r.accounts.length>0&&f++,r.tickers&&r.tickers.length>0&&f++,r.setups&&r.setups.length>0&&f++,f},p=(0,Pr.useCallback)(()=>{h0({app:e,plugin:t,context:"tradelog",currentFilters:{accounts:r.accounts||[],tickers:r.tickers||[],setups:r.setups||[],tradeTypes:r.tradeTypes||[],statuses:r.statuses||[]},onApply:f=>{n({tradeTypes:f.tradeTypes,statuses:f.statuses,accounts:f.accounts,tickers:f.tickers,setups:f.setups})},onClose:()=>{}})},[e,t,r,n]),m=(0,Pr.useCallback)(()=>{rpe({app:e,plugin:t,onSave:()=>{o()},onClose:()=>{}})},[e,t,o]);return Pr.default.createElement("div",{className:"trade-log-header"},Pr.default.createElement("div",{className:"trade-log-controls"},Pr.default.createElement("div",{className:"trade-log-view-selector"},Pr.default.createElement("label",null,"View:"),Pr.default.createElement("select",{value:r.viewLevel,onChange:f=>n({viewLevel:f.target.value}),className:"trade-log-view-dropdown"},Pr.default.createElement("option",{value:"trades"},"Trades"),Pr.default.createElement("option",{value:"years"},"Years"),Pr.default.createElement("option",{value:"quarters"},"Quarters"),Pr.default.createElement("option",{value:"months"},"Months"),Pr.default.createElement("option",{value:"weeks"},"Weeks"),Pr.default.createElement("option",{value:"days"},"Days"))),Pr.default.createElement(p0,{dateRange:r.dateRange,onChange:f=>n({dateRange:f})}),Pr.default.createElement("div",{className:"trade-log-filter-actions"},Pr.default.createElement(Mv,{onClick:p,activeFilterCount:u()}),r.viewLevel==="trades"&&Pr.default.createElement("div",{className:"journalit-filter-button-container"},Pr.default.createElement("button",{className:`journalit-filter-button ${a?"active":""}`,onClick:i,"aria-label":a?"Disable multi-select":"Enable multi-select",title:a?"Disable multi-select":"Enable multi-select"},a?Pr.default.createElement(gd,{size:16}):Pr.default.createElement(Nw,{size:16}))),Pr.default.createElement("div",{className:"journalit-filter-button-container"},Pr.default.createElement("button",{className:"journalit-filter-button",onClick:m,"aria-label":"Column settings",title:"Column settings"},Pr.default.createElement(Lw,{size:16}))))))});GL.displayName="TradeLogHeader"});function YL(){return YL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},YL.apply(null,arguments)}var ape=L(()=>{});function W4(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var ipe=L(()=>{});function KL(e,t){return KL=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},KL(e,t)}var spe=L(()=>{});function lpe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,KL(e,t)}var cpe=L(()=>{spe()});function T_e(e,t){return!!(e===t||dpe(e)&&dpe(t))}function C_e(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!T_e(e[r],t[r]))return!1;return!0}function P_e(e,t){t===void 0&&(t=C_e);var r,n=[],o,a=!1;function i(){for(var s=[],l=0;l<arguments.length;l++)s[l]=arguments[l];return a&&r===this&&t(s,n)||(o=e.apply(this,s),a=!0,r=this,n=s),o}return i}var dpe,JL,upe=L(()=>{dpe=Number.isNaN||function(t){return typeof t=="number"&&t!==t};JL=P_e});var ppe=L(()=>{});function fpe(e){cancelAnimationFrame(e.id)}function E_e(e,t){var r=mpe();function n(){mpe()-r>=t?e.call(null):o.id=requestAnimationFrame(n)}var o={id:requestAnimationFrame(n)};return o}function gpe(e){if(e===void 0&&(e=!1),R4===-1||e){var t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",document.body.appendChild(t),R4=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return R4}function hpe(e){if(e===void 0&&(e=!1),Zb===null||e){var t=document.createElement("div"),r=t.style;r.width="50px",r.height="50px",r.overflow="scroll",r.direction="rtl";var n=document.createElement("div"),o=n.style;return o.width="100px",o.height="100px",t.appendChild(n),document.body.appendChild(t),t.scrollLeft>0?Zb="positive-descending":(t.scrollLeft=1,t.scrollLeft===0?Zb="negative":Zb="positive-ascending"),document.body.removeChild(t),Zb}return Zb}function L_e(e){var t,r=e.getItemOffset,n=e.getEstimatedTotalSize,o=e.getItemSize,a=e.getOffsetForIndexAndAlignment,i=e.getStartIndexForOffset,s=e.getStopIndexForStartIndex,l=e.initInstanceProps,c=e.shouldResetStyleCacheOnItemSizeChange,d=e.validateProps;return t=(function(u){lpe(p,u);function p(f){var g;return g=u.call(this,f)||this,g._instanceProps=l(g.props,W4(g)),g._outerRef=void 0,g._resetIsScrollingTimeoutId=null,g.state={instance:W4(g),isScrolling:!1,scrollDirection:"forward",scrollOffset:typeof g.props.initialScrollOffset=="number"?g.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},g._callOnItemsRendered=void 0,g._callOnItemsRendered=JL(function(v,h,y,b){return g.props.onItemsRendered({overscanStartIndex:v,overscanStopIndex:h,visibleStartIndex:y,visibleStopIndex:b})}),g._callOnScroll=void 0,g._callOnScroll=JL(function(v,h,y){return g.props.onScroll({scrollDirection:v,scrollOffset:h,scrollUpdateWasRequested:y})}),g._getItemStyle=void 0,g._getItemStyle=function(v){var h=g.props,y=h.direction,b=h.itemSize,x=h.layout,w=g._getItemStyleCache(c&&b,c&&x,c&&y),S;if(w.hasOwnProperty(v))S=w[v];else{var k=r(g.props,v,g._instanceProps),T=o(g.props,v,g._instanceProps),P=y==="horizontal"||x==="horizontal",D=y==="rtl",O=P?k:0;w[v]=S={position:"absolute",left:D?void 0:O,right:D?O:void 0,top:P?0:k,height:P?"100%":T,width:P?T:"100%"}}return S},g._getItemStyleCache=void 0,g._getItemStyleCache=JL(function(v,h,y){return{}}),g._onScrollHorizontal=function(v){var h=v.currentTarget,y=h.clientWidth,b=h.scrollLeft,x=h.scrollWidth;g.setState(function(w){if(w.scrollOffset===b)return null;var S=g.props.direction,k=b;if(S==="rtl")switch(hpe()){case"negative":k=-b;break;case"positive-descending":k=x-y-b;break}return k=Math.max(0,Math.min(k,x-y)),{isScrolling:!0,scrollDirection:w.scrollOffset<k?"forward":"backward",scrollOffset:k,scrollUpdateWasRequested:!1}},g._resetIsScrollingDebounced)},g._onScrollVertical=function(v){var h=v.currentTarget,y=h.clientHeight,b=h.scrollHeight,x=h.scrollTop;g.setState(function(w){if(w.scrollOffset===x)return null;var S=Math.max(0,Math.min(x,b-y));return{isScrolling:!0,scrollDirection:w.scrollOffset<S?"forward":"backward",scrollOffset:S,scrollUpdateWasRequested:!1}},g._resetIsScrollingDebounced)},g._outerRefSetter=function(v){var h=g.props.outerRef;g._outerRef=v,typeof h=="function"?h(v):h!=null&&typeof h=="object"&&h.hasOwnProperty("current")&&(h.current=v)},g._resetIsScrollingDebounced=function(){g._resetIsScrollingTimeoutId!==null&&fpe(g._resetIsScrollingTimeoutId),g._resetIsScrollingTimeoutId=E_e(g._resetIsScrolling,I_e)},g._resetIsScrolling=function(){g._resetIsScrollingTimeoutId=null,g.setState({isScrolling:!1},function(){g._getItemStyleCache(-1,null)})},g}p.getDerivedStateFromProps=function(g,v){return N_e(g,v),d(g),null};var m=p.prototype;return m.scrollTo=function(g){g=Math.max(0,g),this.setState(function(v){return v.scrollOffset===g?null:{scrollDirection:v.scrollOffset<g?"forward":"backward",scrollOffset:g,scrollUpdateWasRequested:!0}},this._resetIsScrollingDebounced)},m.scrollToItem=function(g,v){v===void 0&&(v="auto");var h=this.props,y=h.itemCount,b=h.layout,x=this.state.scrollOffset;g=Math.max(0,Math.min(g,y-1));var w=0;if(this._outerRef){var S=this._outerRef;b==="vertical"?w=S.scrollWidth>S.clientWidth?gpe():0:w=S.scrollHeight>S.clientHeight?gpe():0}this.scrollTo(a(this.props,g,v,x,this._instanceProps,w))},m.componentDidMount=function(){var g=this.props,v=g.direction,h=g.initialScrollOffset,y=g.layout;if(typeof h=="number"&&this._outerRef!=null){var b=this._outerRef;v==="horizontal"||y==="horizontal"?b.scrollLeft=h:b.scrollTop=h}this._callPropsCallbacks()},m.componentDidUpdate=function(){var g=this.props,v=g.direction,h=g.layout,y=this.state,b=y.scrollOffset,x=y.scrollUpdateWasRequested;if(x&&this._outerRef!=null){var w=this._outerRef;if(v==="horizontal"||h==="horizontal")if(v==="rtl")switch(hpe()){case"negative":w.scrollLeft=-b;break;case"positive-ascending":w.scrollLeft=b;break;default:var S=w.clientWidth,k=w.scrollWidth;w.scrollLeft=k-S-b;break}else w.scrollLeft=b;else w.scrollTop=b}this._callPropsCallbacks()},m.componentWillUnmount=function(){this._resetIsScrollingTimeoutId!==null&&fpe(this._resetIsScrollingTimeoutId)},m.render=function(){var g=this.props,v=g.children,h=g.className,y=g.direction,b=g.height,x=g.innerRef,w=g.innerElementType,S=g.innerTagName,k=g.itemCount,T=g.itemData,P=g.itemKey,D=P===void 0?A_e:P,O=g.layout,z=g.outerElementType,I=g.outerTagName,A=g.style,j=g.useIsScrolling,E=g.width,N=this.state.isScrolling,B=y==="horizontal"||O==="horizontal",C=B?this._onScrollHorizontal:this._onScrollVertical,F=this._getRangeToRender(),M=F[0],_=F[1],W=[];if(k>0)for(var $=M;$<=_;$++)W.push((0,ex.createElement)(v,{data:T,key:D($,T),index:$,isScrolling:j?N:void 0,style:this._getItemStyle($)}));var H=n(this.props,this._instanceProps);return(0,ex.createElement)(z||I||"div",{className:h,onScroll:C,ref:this._outerRefSetter,style:YL({position:"relative",height:b,width:E,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:y},A)},(0,ex.createElement)(w||S||"div",{children:W,ref:x,style:{height:B?"100%":H,pointerEvents:N?"none":void 0,width:B?H:"100%"}}))},m._callPropsCallbacks=function(){if(typeof this.props.onItemsRendered=="function"){var g=this.props.itemCount;if(g>0){var v=this._getRangeToRender(),h=v[0],y=v[1],b=v[2],x=v[3];this._callOnItemsRendered(h,y,b,x)}}if(typeof this.props.onScroll=="function"){var w=this.state,S=w.scrollDirection,k=w.scrollOffset,T=w.scrollUpdateWasRequested;this._callOnScroll(S,k,T)}},m._getRangeToRender=function(){var g=this.props,v=g.itemCount,h=g.overscanCount,y=this.state,b=y.isScrolling,x=y.scrollDirection,w=y.scrollOffset;if(v===0)return[0,0,0,0];var S=i(this.props,w,this._instanceProps),k=s(this.props,S,w,this._instanceProps),T=!b||x==="backward"?Math.max(1,h):1,P=!b||x==="forward"?Math.max(1,h):1;return[Math.max(0,S-T),Math.max(0,Math.min(v-1,k+P)),S,k]},p})(ex.PureComponent),t.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},t}var ex,D_e,mpe,R4,Zb,I_e,A_e,N_e,vpe,ype=L(()=>{ape();ipe();cpe();upe();ex=q(Y());ppe();D_e=typeof performance=="object"&&typeof performance.now=="function",mpe=D_e?function(){return performance.now()}:function(){return Date.now()};R4=-1;Zb=null;I_e=150,A_e=function(t,r){return t};N_e=function(t,r){var n=t.children,o=t.direction,a=t.height,i=t.layout,s=t.innerTagName,l=t.outerTagName,c=t.width,d=r.instance;if(0)var u},vpe=L_e({getItemOffset:function(t,r){var n=t.itemSize;return r*n},getItemSize:function(t,r){var n=t.itemSize;return n},getEstimatedTotalSize:function(t){var r=t.itemCount,n=t.itemSize;return n*r},getOffsetForIndexAndAlignment:function(t,r,n,o,a,i){var s=t.direction,l=t.height,c=t.itemCount,d=t.itemSize,u=t.layout,p=t.width,m=s==="horizontal"||u==="horizontal",f=m?p:l,g=Math.max(0,c*d-f),v=Math.min(g,r*d),h=Math.max(0,r*d-f+d+i);switch(n==="smart"&&(o>=h-f&&o<=v+f?n="auto":n="center"),n){case"start":return v;case"end":return h;case"center":{var y=Math.round(h+(v-h)/2);return y<Math.ceil(f/2)?0:y>g+Math.floor(f/2)?g:y}case"auto":default:return o>=h&&o<=v?o:o<h?h:v}},getStartIndexForOffset:function(t,r){var n=t.itemCount,o=t.itemSize;return Math.max(0,Math.min(n-1,Math.floor(r/o)))},getStopIndexForStartIndex:function(t,r,n){var o=t.direction,a=t.height,i=t.itemCount,s=t.itemSize,l=t.layout,c=t.width,d=o==="horizontal"||l==="horizontal",u=r*s,p=d?c:a,m=Math.ceil((p+n-u)/s);return Math.max(0,Math.min(i-1,r+m-1))},initInstanceProps:function(t){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(t){var r=t.itemSize}})});var fe,bpe,xpe,wpe,kpe,Spe,U4,V4,Tpe=L(()=>{fe=q(Y());er();e4();Lu();xv();Zw();Ut();wt();C2();ga();rr();pt();om();bpe=(0,fe.memo)(({mistakes:e})=>fe.default.createElement("div",{className:"mistakes-tooltip"},fe.default.createElement("div",{className:"tooltip-title"},"Mistakes:"),e.map((t,r)=>fe.default.createElement("div",{key:r,className:"tooltip-item"},"\u2022 ",t))));bpe.displayName="MistakesTooltipContent";xpe=(0,fe.memo)(({setups:e})=>fe.default.createElement("div",{className:"setups-tooltip"},fe.default.createElement("div",{className:"tooltip-title"},"Setups:"),e.map((t,r)=>fe.default.createElement("div",{key:r,className:"tooltip-item"},"\u2022 ",t))));xpe.displayName="SetupsTooltipContent";wpe=(0,fe.memo)(({tags:e})=>fe.default.createElement("div",{className:"custom-tags-tooltip"},fe.default.createElement("div",{className:"tooltip-title"},"Tags:"),e.map((t,r)=>fe.default.createElement("div",{key:r,className:"tooltip-item"},"\u2022 ",t))));wpe.displayName="CustomTagsTooltipContent";kpe=(0,fe.memo)(({thesis:e})=>fe.default.createElement("div",{className:"thesis-tooltip"},fe.default.createElement("div",{className:"tooltip-title"},"Thesis:"),fe.default.createElement("div",{className:"tooltip-content"},e)));kpe.displayName="ThesisTooltipContent";Spe=(0,fe.memo)(({accounts:e})=>fe.default.createElement("div",{className:"accounts-tooltip"},fe.default.createElement("div",{className:"tooltip-title"},"Accounts:"),e.map((t,r)=>fe.default.createElement("div",{key:r,className:"tooltip-item"},"\u2022 ",t))));Spe.displayName="AccountsTooltipContent";U4=(0,fe.memo)(({trade:e,images:t,status:r,duration:n,onImageClick:o,plugin:a,visibleColumns:i,gridTemplate:s,isSelected:l,onToggleSelection:c,isMultiSelectMode:d})=>{var S,k,T,P,D;let{currency:u}=Ke(),p=(k=(S=a==null?void 0:a.settings)==null?void 0:S.trade)==null?void 0:k.defaultRiskAmount,m=(D=(P=(T=a==null?void 0:a.settings)==null?void 0:T.trade)==null?void 0:P.showCopyTradingPnL)!=null?D:!1,f=(0,fe.useCallback)(O=>{O.stopPropagation();let z=e.filePath||e.path;z&&c&&c(z,O)},[e,c]),g=(0,fe.useMemo)(()=>st(cv(e),e.rMultiple,e.riskAmount,p),[e,p]),v=(0,fe.useMemo)(()=>{let O=cv(e);if(!m)return O;let z=Il(e);return El(O,z,m)},[e,m]),h=(0,fe.useMemo)(()=>e.mistake?Array.isArray(e.mistake)?e.mistake:[e.mistake]:[],[e.mistake]),y=(0,fe.useMemo)(()=>e.setup?Array.isArray(e.setup)?e.setup:[e.setup]:[],[e.setup]),b=(0,fe.useMemo)(()=>!e.tags||!Array.isArray(e.tags)?[]:e.tags.filter(O=>typeof O=="string"&&O.trim()).map(O=>O.trim()),[e.tags]),x=(0,fe.useMemo)(()=>{if(!e.account&&!e.accountIds)return[];let O=e.accountIds||e.account;return Array.isArray(O)?O:[O]},[e.account,e.accountIds]),w=(0,fe.useCallback)(O=>{var z,I;switch(O){case"select":return d?fe.default.createElement("div",{key:"select",className:"trade-select-cell"},fe.default.createElement("input",{type:"checkbox",className:"trade-select-checkbox",checked:l||!1,onChange:f,onClick:E=>E.stopPropagation(),"aria-label":`Select ${e.instrument||"trade"}`})):null;case"image":return fe.default.createElement("div",{key:"image",className:"trade-image-cell"},t.length>0?fe.default.createElement("div",{className:"trade-image-wrapper",onClick:E=>o(E,t[0])},fe.default.createElement("div",{className:"trade-preview-thumbnail"},fe.default.createElement("img",{src:In.resolveMediaPath(t[0]),alt:"Trade",loading:"lazy",decoding:"async"})),t.length>1&&fe.default.createElement("span",{className:"trade-image-count"},"+",t.length-1)):fe.default.createElement(EL,{size:20,className:"trade-no-image-icon"}));case"ticker":return fe.default.createElement("div",{key:"ticker",className:"trade-ticker-cell"},fe.default.createElement("span",{className:"trade-ticker"},e.instrument),e.performanceIndicator==="best"&&fe.default.createElement(dw,{size:14,className:"performance-badge performance-badge--best"}),e.performanceIndicator==="worst"&&fe.default.createElement(lo,{size:14,className:"performance-badge performance-badge--worst"}));case"direction":return fe.default.createElement("div",{key:"direction",className:"trade-direction-cell"},fe.default.createElement("span",{className:`trade-direction trade-direction--${(z=e.direction)==null?void 0:z.toLowerCase()}`},e.direction));case"status":return fe.default.createElement("div",{key:"status",className:"trade-status-cell"},fe.default.createElement("span",{className:`trade-status ${r.className}`},r.label));case"pnl":return fe.default.createElement("div",{key:"pnl",className:"trade-pnl-cell"},fe.default.createElement("span",{className:`trade-pnl ${r.className==="status-open"?"open":v>0?"positive":v<0?"negative":"neutral"}`},r.className==="status-open"?"-":ve(v,!0,u,(I=a==null?void 0:a.settings.trade)==null?void 0:I.displayRMultiples,g)));case"duration":return fe.default.createElement("div",{key:"duration",className:"trade-duration-cell"},fe.default.createElement("span",{className:"trade-duration"},n));case"date":return fe.default.createElement("div",{key:"date",className:"trade-date-cell"},fe.default.createElement("span",{className:"trade-date"},rt(Xt(e.entryTime))));case"account":{if(x.length===0)return fe.default.createElement("div",{key:"account",className:"trade-account-cell"},fe.default.createElement("span",{className:"trade-no-data"},"-"));if(x.length===1){let E=x[0],N=8,B=E.length>N,C=B?E.substring(0,N)+"...":E,F=fe.default.createElement("span",{className:"trade-account-text"},C);return fe.default.createElement("div",{key:"account",className:"trade-account-cell"},B?fe.default.createElement(vm,{content:E,delay:0,preferredPosition:"top"},F):F)}return fe.default.createElement("div",{key:"account",className:"trade-account-cell"},fe.default.createElement(vm,{content:fe.default.createElement(Spe,{accounts:x}),delay:0,preferredPosition:"top"},fe.default.createElement("div",{className:"trade-account-icon-wrapper"},fe.default.createElement(Du,{size:20,className:"trade-account-icon"}),fe.default.createElement("span",{className:"trade-account-count-badge"},x.length))))}case"reviewed":return fe.default.createElement("div",{key:"reviewed",className:"trade-reviewed-cell"},e.reviewed?fe.default.createElement(Qo,{size:16,className:"trade-reviewed-icon trade-reviewed-icon--yes"}):fe.default.createElement(mw,{size:16,className:"trade-reviewed-icon trade-reviewed-icon--no"}));case"positionSize":return fe.default.createElement("div",{key:"positionSize",className:"trade-position-size-cell"},fe.default.createElement("span",{className:"trade-position-size"},e.positionSize?e.positionSize.toLocaleString():"-"));case"expirationDate":return e.assetType!=="options"||!e.expirationDate?fe.default.createElement("div",{key:"expirationDate",className:"trade-expiration-date-cell"},fe.default.createElement("span",{className:"trade-no-data"},"-")):fe.default.createElement("div",{key:"expirationDate",className:"trade-expiration-date-cell"},fe.default.createElement("span",{className:"trade-expiration-date"},rt(Xt(e.expirationDate))));case"daysToExpiry":if(e.assetType!=="options"||!e.expirationDate)return fe.default.createElement("div",{key:"daysToExpiry",className:"trade-dte-cell"},fe.default.createElement("span",{className:"trade-no-data"},"-"));let A=zw(e.expirationDate);if(A===null)return fe.default.createElement("div",{key:"daysToExpiry",className:"trade-dte-cell"},fe.default.createElement("span",{className:"trade-no-data"},"-"));if(A<0)return fe.default.createElement("div",{key:"daysToExpiry",className:"trade-dte-cell"},fe.default.createElement("span",{className:"trade-dte-expired"},"EXPIRED"));let j=A>=7?"green":A>=3?"yellow":"red";return fe.default.createElement("div",{key:"daysToExpiry",className:"trade-dte-cell"},fe.default.createElement("div",{className:`trade-dte-circle trade-dte-circle--${j}`},fe.default.createElement("span",{className:"trade-dte-number"},A)));case"mistakes":return fe.default.createElement("div",{key:"mistakes",className:"trade-mistakes-cell"},h.length>0?fe.default.createElement(vm,{content:fe.default.createElement(bpe,{mistakes:h}),delay:0,preferredPosition:"top"},fe.default.createElement("span",{className:"count-badge count-badge--mistakes"},h.length)):fe.default.createElement("span",{className:"trade-no-data"},"-"));case"setups":return fe.default.createElement("div",{key:"setups",className:"trade-setups-cell"},y.length>0?fe.default.createElement(vm,{content:fe.default.createElement(xpe,{setups:y}),delay:0,preferredPosition:"top"},fe.default.createElement("span",{className:"count-badge count-badge--setups"},y.length)):fe.default.createElement("span",{className:"trade-no-data"},"-"));case"tags":return b.length===0?fe.default.createElement("div",{key:"tags",className:"trade-tags-cell"},fe.default.createElement("span",{className:"trade-no-data"},"-")):fe.default.createElement("div",{key:"tags",className:"trade-tags-cell"},fe.default.createElement(vm,{content:fe.default.createElement(wpe,{tags:b}),delay:0,preferredPosition:"top"},fe.default.createElement("div",{className:"trade-tags-icon-wrapper"},fe.default.createElement(Pu,{size:20,className:"trade-tags-icon"}),fe.default.createElement("span",{className:"trade-tags-count-badge"},b.length))));case"thesis":return fe.default.createElement("div",{key:"thesis",className:"trade-thesis-cell"},e.thesis?fe.default.createElement(vm,{content:fe.default.createElement(kpe,{thesis:e.thesis}),delay:0,preferredPosition:"top"},fe.default.createElement("span",{className:"trade-thesis"},e.thesis.length>40?e.thesis.substring(0,40)+"...":e.thesis)):fe.default.createElement("span",{className:"trade-no-data"},"-"));default:return null}},[e,t,r,v,u,a,g,x,h,y,b,n,o,d,l,f]);return fe.default.createElement(fe.default.Fragment,null,i&&i.length>0?i.map(O=>w(O.id)):fe.default.createElement("span",{className:"trade-no-data"},"No columns configured"))});U4.displayName="TradeDetailsContent";V4=(0,fe.memo)(({trade:e,depth:t,isLastChild:r=!1,onClick:n,viewLevel:o,visibleColumns:a,gridTemplate:i,isSelected:s,onToggleSelection:l,isMultiSelectMode:c})=>{let d=xe(),[u,p]=(0,fe.useState)(!1),[m,f]=(0,fe.useState)(0),g=(0,fe.useMemo)(()=>{switch(Bw(e,d==null?void 0:d.settings.trade)){case"backtest":return{label:"BACKTEST",className:"status-backtest"};case"missed":return{label:"MISSED",className:"status-missed"};case"open":return{label:"OPEN",className:"status-open"};case"win":return{label:"WIN",className:"status-win"};case"loss":return{label:"LOSS",className:"status-loss"};case"breakeven":default:return{label:"BREAKEVEN",className:"status-breakeven"}}},[e.pnl,e.isMissedTrade,e.isBacktestTrade,e.tradeStatus,e.exitTime,e.useDirectPnLInput,e.exits,d==null?void 0:d.settings.trade]),v=(0,fe.useMemo)(()=>{if(!e.entryTime)return"N/A";if(e.tradeStatus==="OPEN"||Pt({tradeStatus:e.tradeStatus,exitTime:e.exitTime,pnl:e.pnl,useDirectPnLInput:e.useDirectPnLInput,exits:e.exits,entries:e.entries})){let O=Wr(e.entryTime);if(!O)return"N/A";let I=new Date().getTime()-O;return JF(I)+" (ongoing)"}let T=Wr(e.entryTime),P=Wr(e.exitTime);if(!T||!P)return"N/A";let D=P-T;return JF(D)},[e.entryTime,e.exitTime,e.tradeStatus,e.pnl,e.useDirectPnLInput,e.exits]),h=(0,fe.useMemo)(()=>{let k=[];try{if(e.images){if(Array.isArray(e.images))k=e.images.map(T=>String(T).trim().replace(/['"`]/g,""));else if(typeof e.images=="string"){let T=JSON.parse(e.images);Array.isArray(T)&&(k=T.map(P=>String(P).trim().replace(/['"`]/g,"")))}}}catch(T){}return k},[e]),y=(0,fe.useCallback)((k,T)=>{k.stopPropagation();let P=h.indexOf(T);f(P>=0?P:0),p(!0)},[h]),b=(0,fe.useCallback)(()=>{p(!1)},[]),x=(0,fe.useCallback)(k=>{k>=0&&k<h.length&&f(k)},[h.length]),w=(0,fe.useCallback)(k=>{k.stopPropagation();let T=e.filePath||e.path;T&&l&&l(T,k)},[e,l]),S=(0,fe.useMemo)(()=>{if(!(h.length<=1))return{images:h,currentIndex:m,onNavigate:x,altPrefix:`${e.instrument} Image`,useResolveMediaPath:!0}},[h,m,x,e.instrument]);return fe.default.createElement(fe.default.Fragment,null,fe.default.createElement("div",{className:`trade-log-node trade-log-node--trade ${r?"is-last-child":""} ${o==="trades"?"trades-view":""}`,onClick:c?w:n},o!=="trades"&&fe.default.createElement("div",{className:"tree-structure",style:{width:`${t*24}px`}},Array.from({length:t}).map((k,T)=>fe.default.createElement("span",{key:T,className:`tree-level ${T===t-1&&r?"last-level":""}`}))),o==="trades"?fe.default.createElement("div",{className:"trade-details-row trades-view-row",style:{gridTemplateColumns:i}},fe.default.createElement(U4,{trade:e,images:h,status:g,duration:v,onImageClick:y,plugin:d,visibleColumns:a,gridTemplate:i,isSelected:s,onToggleSelection:l,isMultiSelectMode:c})):fe.default.createElement("div",{className:"trade-details-row tree-view-row",style:{gridTemplateColumns:i}},fe.default.createElement("div",{className:"tree-indicator-cell"},t>0&&fe.default.createElement("span",{className:"tree-connector tree-connector--trade"}),fe.default.createElement("span",{className:"tree-leaf-node tree-leaf-node--trade"})),fe.default.createElement(U4,{trade:e,images:h,status:g,duration:v,onImageClick:y,plugin:d,visibleColumns:a,gridTemplate:i,isSelected:s,onToggleSelection:l,isMultiSelectMode:c}))),u&&h.length>0&&fe.default.createElement(Nu,{isOpen:u,onClose:b,title:`${e.instrument} - ${rt(Xt(e.entryTime),"DDMMYY"," ")}`,portalId:"trade-log-image-portal"},fe.default.createElement(dm,{imagePath:h[m],alt:`${e.instrument} Image ${m+1}`,useResolveMediaPath:!0,navigationContext:S,onClose:b})))});V4.displayName="TradeDetailsRow"});var fp,H4,Cpe=L(()=>{fp=q(Y());_O();H4=fp.default.memo(({visibleColumns:e,gridTemplate:t,depth:r,isMultiSelectMode:n})=>((0,fp.useLayoutEffect)(()=>(a1(),()=>{i1()}),[]),fp.default.createElement("div",{className:"trade-log-mini-header"},fp.default.createElement("div",{className:"tree-structure",style:{width:`${r*24}px`}}),fp.default.createElement("div",{className:"mini-header-row",style:{gridTemplateColumns:t,marginLeft:`-${r*24}px`,paddingLeft:`${r*24}px`}},fp.default.createElement("div",{className:"tree-indicator-cell-header"}),e.map(o=>fp.default.createElement("div",{key:o.id,className:`mini-header-cell header-${o.id}`},o.label))))));H4.displayName="TradeLogMiniHeader"});function M_e(e){return e>=60?"high":e>=40?"medium":"low"}function F_e(e){let t=e.performanceIndicator==="best"?"Best":"Worst";switch(e.type){case"year":return`${t} performing year`;case"quarter":let r=e.id.split("-")[0];return`${t} performing quarter of ${r}`;case"month":let[n,o]=e.id.split("-"),a=Math.ceil(parseInt(o)/3);return`${t} performing month of Q${a} ${n}`;case"week":let i=e.id.split("-W"),s=i[1],c=i[0].split("-")[0],d=O_e(parseInt(c),parseInt(s)),p=["January","February","March","April","May","June","July","August","September","October","November","December"][d.getMonth()];return`${t} performing week of ${p} ${c}`;case"day":let m=e.id.split("-"),f=new Date(parseInt(m[0]),parseInt(m[1])-1,parseInt(m[2])),g=Qp(f);return`${t} performing day of W${g} ${m[0]}`;default:return`${t} performing period`}}function O_e(e,t){let r=new Date(e,0,4),n=r.getDay(),o=n===0?-6:1-n,a=new Date(r);a.setDate(r.getDate()+o);let i=new Date(a);return i.setDate(a.getDate()+(t-1)*7),i}var Jt,q4,Ppe=L(()=>{Jt=q(Y());Ut();Tpe();Cpe();wt();rr();pt();q4=(0,Jt.memo)(({node:e,depth:t,isExpanded:r,isLastChild:n=!1,onToggleExpand:o,onNodeClick:a,viewLevel:i,visibleColumns:s,gridTemplate:l,selectedTrades:c,onToggleTradeSelection:d,isMultiSelectMode:u})=>{var x,w,S,k,T,P,D;let{currency:p}=Ke(),m=xe(),f=(w=(x=m==null?void 0:m.settings)==null?void 0:x.trade)==null?void 0:w.displayRMultiples,g=(k=(S=m==null?void 0:m.settings)==null?void 0:S.trade)==null?void 0:k.defaultRiskAmount,v=O=>{O.stopPropagation(),o(e)},h=O=>{O.stopPropagation(),a(e)},y=e.children&&e.children.length>0,b=e.type!=="trade"&&(y||!e.dataLoaded);if(e.type==="trade-group-header")return Jt.default.createElement(H4,{visibleColumns:s||[],gridTemplate:l||"",depth:t,isMultiSelectMode:u});if(e.type==="trade"){let O=((P=(T=e.trade)==null?void 0:T.file)==null?void 0:P.path)||((D=e.trade)==null?void 0:D.filePath)||"";return Jt.default.createElement(V4,{trade:e.trade,depth:t,isLastChild:n,onClick:h,viewLevel:i,visibleColumns:s,gridTemplate:l,isSelected:(c==null?void 0:c.has(O))||!1,onToggleSelection:d,isMultiSelectMode:u})}return Jt.default.createElement("div",{className:`trade-log-node trade-log-node--${e.type} ${n?"is-last-child":""}`},Jt.default.createElement("div",{className:"tree-structure",style:{width:`${t*24}px`}},Array.from({length:t}).map((O,z)=>Jt.default.createElement("span",{key:z,className:`tree-level ${z===t-1&&n?"last-level":""}`}))),Jt.default.createElement("div",{className:"node-wrapper"},t>0&&Jt.default.createElement("span",{className:"tree-connector"}),Jt.default.createElement("div",{className:"node-content"},Jt.default.createElement("div",{className:"tree-expand-wrapper"},b?Jt.default.createElement("button",{className:`node-chevron ${r?"expanded":""}`,onClick:v,"aria-label":r?"Collapse":"Expand"},r?Jt.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},Jt.default.createElement("rect",{x:"3.5",y:"3.5",width:"9",height:"9",stroke:"currentColor",strokeWidth:"1.5",rx:"1"}),Jt.default.createElement("path",{d:"M6 8H10",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})):Jt.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},Jt.default.createElement("rect",{x:"3.5",y:"3.5",width:"9",height:"9",stroke:"currentColor",strokeWidth:"1.5",rx:"1"}),Jt.default.createElement("path",{d:"M8 6V10M6 8H10",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}))):Jt.default.createElement("span",{className:"tree-leaf-node"})),Jt.default.createElement("span",{className:"node-label",onClick:h,title:`Navigate to ${e.type} review`},e.label,e.performanceIndicator&&Jt.default.createElement("span",{className:`performance-indicator performance-indicator--${e.performanceIndicator}`,title:F_e(e)},e.performanceIndicator==="best"?Jt.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Jt.default.createElement("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C5.5 4 6 4.5 6 5v4zM18 9h1.5a2.5 2.5 0 0 0 0-5c-1 0-1.5.5-1.5 1v4z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),Jt.default.createElement("path",{d:"M4 22h16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),Jt.default.createElement("path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),Jt.default.createElement("path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),Jt.default.createElement("path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})):Jt.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Jt.default.createElement("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),Jt.default.createElement("line",{x1:"12",y1:"9",x2:"12",y2:"13",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),Jt.default.createElement("line",{x1:"12",y1:"17",x2:"12.01",y2:"17",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})))),Jt.default.createElement("div",{className:"node-metrics"},Jt.default.createElement("div",{className:"metric-column metric-column--count"},Jt.default.createElement("span",{className:"metric metric--count"},e.metrics.tradeCount," ",e.metrics.tradeCount===1?"trade":"trades")),Jt.default.createElement("div",{className:"metric-column metric-column--winrate"},Jt.default.createElement("span",{className:`metric metric--winrate ${M_e(e.metrics.winRate)}`},e.metrics.winRate.toFixed(1),"%")),Jt.default.createElement("div",{className:"metric-column metric-column--pnl"},Jt.default.createElement("span",{className:`metric metric--pnl ${e.metrics.totalPnL>0?"positive":e.metrics.totalPnL<0?"negative":"neutral"}`},ve(e.metrics.totalPnL,!0,p,f,st(e.metrics.totalPnL,e.metrics.totalRMultiple,void 0,g))))))))});q4.displayName="TradeLogNode"});var Qc,tx,XL,j_e,QL,Dpe=L(()=>{Qc=q(Y());Ppe();tx=null,XL=new WeakMap,j_e=()=>(tx||(tx=new IntersectionObserver(e=>{e.forEach(t=>{if(t.isIntersecting){let r=XL.get(t.target);r&&(r(),tx==null||tx.unobserve(t.target),XL.delete(t.target))}})},{rootMargin:"300px 0px",threshold:0})),tx),QL=(0,Qc.memo)(({node:e,depth:t,isExpanded:r,isLastChild:n,onToggleExpand:o,onNodeClick:a,viewLevel:i,visibleColumns:s,gridTemplate:l,selectedTrades:c,onToggleTradeSelection:d,isMultiSelectMode:u})=>{let[p,m]=(0,Qc.useState)(!1),f=(0,Qc.useRef)(null),g=t===0||t===1;if((0,Qc.useEffect)(()=>{if(g){m(!0);return}let v=f.current;if(!v)return;let h=j_e(),y=()=>m(!0);return XL.set(v,y),h.observe(v),()=>{v&&(h.unobserve(v),XL.delete(v))}},[g]),!p){let v=e.type==="trade"?60:48;return Qc.default.createElement("div",{ref:f,className:`trade-log-node-placeholder trade-log-node--${e.type}`,style:{height:`${v}px`,width:"100%",background:"var(--background-primary-alt)",borderBottom:"1px solid var(--background-modifier-border)"}})}return Qc.default.createElement(q4,{node:e,depth:t,isExpanded:r,isLastChild:n,onToggleExpand:o,onNodeClick:a,viewLevel:i,visibleColumns:s,gridTemplate:l,selectedTrades:c,onToggleTradeSelection:d,isMultiSelectMode:u})});QL.displayName="LazyTradeLogNode"});var Vr,G4,Epe=L(()=>{Vr=q(Y());ype();Dpe();G4=(0,Vr.memo)(({nodes:e,expandedNodes:t,onToggleExpand:r,onNodeClick:n,onTreeReady:o,viewLevel:a,visibleColumns:i,gridTemplate:s,selectedTrades:l,onToggleTradeSelection:c,isMultiSelectMode:d,requestedScrollOffset:u,onScrollOffsetChange:p})=>{let m=(0,Vr.useRef)(null),f=(0,Vr.useRef)(null),g=(0,Vr.useRef)(null),v=(0,Vr.useRef)(0),[h,y]=(0,Vr.useState)(600);(0,Vr.useEffect)(()=>{let z=()=>{var j,E;if(m.current){let N=m.current.getBoundingClientRect(),B=((E=(j=document.querySelector(".trade-log-headers"))==null?void 0:j.getBoundingClientRect())==null?void 0:E.height)||60,C=N.height||window.innerHeight-B-100;y(Math.max(300,C))}},I=setTimeout(z,300),A=null;return m.current&&"ResizeObserver"in window&&(A=new ResizeObserver(z),A.observe(m.current)),window.addEventListener("resize",z),()=>{clearTimeout(I),window.removeEventListener("resize",z),A&&A.disconnect()}},[]);let[b,x]=(0,Vr.useState)([]),[w,S]=(0,Vr.useState)(!1);(0,Vr.useEffect)(()=>{if(e.length===0){x([]),S(!1),o==null||o();return}let z=0,I=j=>{let E=j.length;return j.forEach(N=>{N.children&&t.has(N.id)&&(E+=I(N.children))}),E};if(z=I(e),z<200){let j=[],E=(N,B)=>{N.forEach((C,F)=>{let M=F===N.length-1;j.push({node:C,depth:B,isLastChild:M}),t.has(C.id)&&C.children&&C.children.length>0&&(C.children.some(W=>W.type==="trade")&&j.push({node:{type:"trade-group-header",id:`${C.id}-header`,label:"",metrics:{},expanded:!1,dataLoaded:!0},depth:B+1,isLastChild:!1}),E(C.children,B+1))})};E(e,0),x(j),S(!1),o==null||o();return}S(!0),(async()=>{let j=[],E=0,N=async(B,C)=>{for(let F=0;F<B.length;F++){let M=B[F],_=F===B.length-1;j.push({node:M,depth:C,isLastChild:_}),E++,t.has(M.id)&&M.children&&M.children.length>0&&(M.children.some($=>$.type==="trade")&&j.push({node:{type:"trade-group-header",id:`${M.id}-header`,label:"",metrics:{},expanded:!1,dataLoaded:!0},depth:C+1,isLastChild:!1}),await N(M.children,C+1)),E%100===0&&await new Promise(W=>setTimeout(W,0))}};await N(e,0),x(j),S(!1),o==null||o()})()},[e,t]);let k=b.length>50,T=(0,Vr.useCallback)(({scrollOffset:z})=>{v.current=z,p==null||p(z)},[p]),P=(0,Vr.useCallback)(z=>{let I=z.currentTarget;v.current=I.scrollTop,p==null||p(I.scrollTop)},[p]);(0,Vr.useEffect)(()=>{let I=requestAnimationFrame(()=>{let A=(u!=null?u:v.current)||0;if(k)f.current&&typeof f.current.scrollTo=="function"&&f.current.scrollTo(A);else{let j=g.current;j&&(j.scrollTop=A)}});return()=>cancelAnimationFrame(I)},[b,k,u]);let D=(0,Vr.useMemo)(()=>({flattenedNodes:b,expandedNodes:t,onToggleExpand:r,onNodeClick:n,viewLevel:a,visibleColumns:i,gridTemplate:s,selectedTrades:l,onToggleTradeSelection:c,isMultiSelectMode:d}),[b,t,r,n,a,i,s,l,c,d]),O=(0,Vr.useCallback)(({index:z,style:I,data:A})=>{let{flattenedNodes:j,expandedNodes:E,onToggleExpand:N,onNodeClick:B,viewLevel:C,visibleColumns:F,gridTemplate:M,selectedTrades:_,onToggleTradeSelection:W,isMultiSelectMode:$}=A,H=j[z];if(!H)return null;let{node:R,depth:V,isLastChild:Z}=H;return Vr.default.createElement("div",{style:I},Vr.default.createElement(QL,{key:R.id,node:R,depth:V,isExpanded:E.has(R.id),isLastChild:Z,onToggleExpand:N,onNodeClick:B,viewLevel:C,visibleColumns:F,gridTemplate:M,selectedTrades:_,onToggleTradeSelection:W,isMultiSelectMode:$}))},[]);return e.length===0?Vr.default.createElement("div",{className:"trade-log-tree trade-log-tree--empty"},"No trade data available"):w&&b.length===0?Vr.default.createElement("div",{className:"trade-log-tree trade-log-tree--empty"},"Processing trade data..."):Vr.default.createElement("div",{className:"trade-log-tree",ref:m,style:{height:"100%"}},k?Vr.default.createElement(vpe,{ref:f,height:h,itemCount:b.length,itemSize:48,overscanCount:5,width:"100%",initialScrollOffset:(u!=null?u:v.current)||0,onScroll:T,itemData:D},O):Vr.default.createElement("div",{ref:g,"data-testid":"scroll-container",onScroll:P,style:{height:h,overflowY:"auto"}},b.map(({node:z,depth:I,isLastChild:A},j)=>Vr.default.createElement(QL,{key:z.id,node:z,depth:I,isExpanded:t.has(z.id),isLastChild:A,onToggleExpand:r,onNodeClick:n,viewLevel:a,visibleColumns:i,gridTemplate:s,selectedTrades:l,onToggleTradeSelection:c,isMultiSelectMode:d}))))})});function Ipe(){if(document.head.querySelector("#trade-log-skeleton-styles"))return;let e=document.createElement("style");e.id="trade-log-skeleton-styles",e.textContent=z_e,document.head.appendChild(e)}function Ape(){var e;(e=document.head.querySelector("#trade-log-skeleton-styles"))==null||e.remove()}var z_e,Lpe=L(()=>{z_e=`
.trade-log-skeleton {
  width: 100%;
  height: 100%;
  min-height: 400px;
  overflow: hidden;
  background: var(--background-primary);
  display: flex;
  flex-direction: column;
  transition: height 0.2s ease-out;
}

.skeleton-header-row {
  display: grid;
  gap: 8px;
  align-items: center;
  padding: 12px 16px;
  min-height: 48px;
  background: var(--background-secondary);
  border-bottom: 1px solid var(--background-modifier-border);
  font-weight: 500;
  position: sticky;
  top: 0;
  z-index: 5;
}

.skeleton-data-row {
  display: grid;
  gap: 8px;
  align-items: center;
  padding: 8px 16px;
  min-height: 48px;
  border-bottom: 1px solid var(--background-modifier-border-hover);
}

.skeleton-header-cell,
.skeleton-data-cell {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  overflow: hidden;
}

/* Responsive */
@media (max-width: 768px) {
  .skeleton-header-row,
  .skeleton-data-row {
    padding: 8px 12px;
    gap: 6px;
  }
}
`});var Hr,rx,Npe=L(()=>{Hr=q(Y());mg();gg();Q1();Lpe();Kf();rx=(0,Hr.memo)(({visibleColumns:e,gridTemplate:t,containerHeight:r=600})=>{(0,Hr.useLayoutEffect)(()=>(Ll(),Ipe(),()=>{Ape()}),[]);let n=(0,Hr.useMemo)(()=>Math.min(Math.ceil(r/48),20),[r]),o=(0,Hr.useCallback)(a=>{switch(a){case"select":return Hr.default.createElement(fg,{size:16});case"image":return Hr.default.createElement(Bi,{width:40,height:40});case"ticker":return Hr.default.createElement(Kt,{width:"80px"});case"direction":return Hr.default.createElement(Kt,{width:"60px"});case"status":return Hr.default.createElement(Kt,{width:"60px"});case"pnl":return Hr.default.createElement(Kt,{width:"70px"});case"duration":return Hr.default.createElement(Kt,{width:"50px"});case"date":return Hr.default.createElement(Kt,{width:"70px"});case"account":return Hr.default.createElement(Kt,{width:"60px"});case"reviewed":return Hr.default.createElement(fg,{size:16});case"positionSize":return Hr.default.createElement(Kt,{width:"60px"});case"mistakes":return Hr.default.createElement(Kt,{width:"40px"});case"setups":return Hr.default.createElement(Kt,{width:"40px"});case"thesis":return Hr.default.createElement(Kt,{width:"80%"});default:return Hr.default.createElement(Kt,{width:"50px"})}},[]);return Hr.default.createElement("div",{className:"trade-log-skeleton","aria-label":"Loading trade data"},Hr.default.createElement("div",{className:"skeleton-header-row",style:{gridTemplateColumns:t}},e.map(a=>Hr.default.createElement("div",{key:a.id,className:"skeleton-header-cell"},Hr.default.createElement(Kt,{width:a.label?`${a.label.length*7}px`:"60px",height:"14px"})))),Array.from({length:n}).map((a,i)=>Hr.default.createElement("div",{key:i,className:"skeleton-data-row",style:{gridTemplateColumns:t}},e.map(s=>Hr.default.createElement("div",{key:s.id,className:"skeleton-data-cell"},o(s.id))))))});rx.displayName="TradeLogSkeleton"});function __e(e,t){return[...e].sort((r,n)=>{var i,s,l,c;if(r.type!=="trade"||n.type!=="trade")return 0;let o=(s=(i=r.trade)==null?void 0:i.pnl)!=null?s:0,a=(c=(l=n.trade)==null?void 0:l.pnl)!=null?c:0;return t==="asc"?o-a:a-o})}function B_e(e,t){return[...e].sort((r,n)=>{var i,s;if(r.type!=="trade"||n.type!=="trade")return 0;let o=(i=r.trade)!=null&&i.entryTime?new Date(r.trade.entryTime).getTime():0,a=(s=n.trade)!=null&&s.entryTime?new Date(n.trade.entryTime).getTime():0;return t==="asc"?o-a:a-o})}function $_e(e,t){return[...e].sort((r,n)=>{var i,s,l,c;if(r.type!=="trade"||n.type!=="trade")return 0;let o=(s=(i=r.trade)==null?void 0:i.positionSize)!=null?s:0,a=(c=(l=n.trade)==null?void 0:l.positionSize)!=null?c:0;return t==="asc"?o-a:a-o})}function W_e(e,t){return[...e].sort((r,n)=>{if(r.type!=="trade"||n.type!=="trade")return 0;let o=s=>{if(!(s!=null&&s.entryTime)||!(s!=null&&s.exitTime))return 0;let l=new Date(s.entryTime).getTime();return new Date(s.exitTime).getTime()-l},a=o(r.trade),i=o(n.trade);return t==="asc"?a-i:i-a})}function Mpe(e,t){if(!t.column)return e;switch(t.column){case"pnl":return __e(e,t.direction);case"date":return B_e(e,t.direction);case"positionSize":return $_e(e,t.direction);case"duration":return W_e(e,t.direction);case"expirationDate":return[...e].sort((r,n)=>{var c,d;if(r.type!=="trade"||n.type!=="trade")return 0;let o=(c=r.trade)==null?void 0:c.expirationDate,a=(d=n.trade)==null?void 0:d.expirationDate;if(!o&&!a)return 0;if(!o)return 1;if(!a)return-1;let i=new Date(o).getTime(),s=new Date(a).getTime(),l=i-s;return t.direction==="asc"?l:-l});case"daysToExpiry":return[...e].sort((r,n)=>{var c,d;if(r.type!=="trade"||n.type!=="trade")return 0;let o=(c=r.trade)==null?void 0:c.expirationDate,a=(d=n.trade)==null?void 0:d.expirationDate,i=o?zw(o):null,s=a?zw(a):null;if(i===null&&s===null)return 0;if(i===null)return 1;if(s===null)return-1;let l=i-s;return t.direction==="asc"?l:-l});default:return e}}var Fpe=L(()=>{wt()});var Xe,gp,X4,Y4,R_e,K4,U_e,J4,Q4,Ope=L(()=>{Xe=q(Y()),gp=require("obsidian");er();_w();zO();X4=q(wn());Au();Y4=class extends gp.Modal{constructor(t,r,n,o){super(t),this.count=r,this.onConfirm=n,this.onCancel=o}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h2",{text:"Confirm Deletion"}),t.createEl("p",{text:`Are you sure you want to delete ${this.count} selected trade${this.count>1?"s":""}? This action cannot be undone.`});let r=t.createDiv({cls:"modal-button-container"}),n=r.createEl("button",{text:"Cancel"});n.onclick=()=>{this.onCancel(),this.close()};let o=r.createEl("button",{text:"Delete",cls:"mod-warning"});o.onclick=()=>{this.onConfirm(),this.close()}}onClose(){let{contentEl:t}=this;t.empty()}},R_e=({setupOptions:e,onConfirm:t,onClose:r,onSaveOption:n,plugin:o})=>{let[a,i]=(0,Xe.useState)([]),[s,l]=(0,Xe.useState)(!1),[c,d]=(0,Xe.useState)(e);(0,Xe.useEffect)(()=>{let p=()=>{if(o.optionsService){let f=o.optionsService.getOptions("setup");d(f)}};p();let m=()=>p();return document.addEventListener("journalit-options-changed",m),()=>{document.removeEventListener("journalit-options-changed",m)}},[o.optionsService]);let u=async()=>{if(a.length!==0){l(!0);try{await t(a),r()}catch(p){console.error("Error adding setups:",p),l(!1)}}};return Xe.default.createElement("div",{className:"batch-action-modal-content"},Xe.default.createElement("div",{className:"batch-action-modal-body"},Xe.default.createElement(li,{label:"Setups",options:c,value:a,onChange:p=>i(p),allowCreate:!0,isMulti:!0,placeholder:"Select or create setups...",onSaveOption:n,optionType:"setup"})),Xe.default.createElement("div",{className:"batch-action-modal-buttons"},Xe.default.createElement("button",{onClick:r,disabled:s},"Cancel"),Xe.default.createElement("button",{onClick:u,disabled:s||a.length===0,className:"primary"},s?"Adding...":`Add ${a.length>0?`(${a.length})`:""}`)))},K4=class extends gp.Modal{constructor(r,n,o,a,i,s){super(r);this.root=null;this.setupOptions=n,this.onConfirm=o,this.onModalClose=a,this.onSaveOption=i,this.plugin=s}onOpen(){let{contentEl:r}=this;r.empty(),r.style.minHeight="400px",r.style.maxHeight="80vh",r.style.display="flex",r.style.flexDirection="column",r.createEl("h2",{text:"Add Setups to Trades",cls:"journalit-batch-modal-title"}),this.container=r.createDiv({cls:"batch-action-modal-container"}),this.root=(0,X4.createRoot)(this.container),this.root.render(Xe.default.createElement(R_e,{setupOptions:this.setupOptions,onConfirm:this.onConfirm,onClose:()=>this.close(),onSaveOption:this.onSaveOption,plugin:this.plugin}))}onClose(){this.root&&(this.root.unmount(),this.root=null),this.onModalClose()}},U_e=({mistakeOptions:e,onConfirm:t,onClose:r,onSaveOption:n,plugin:o})=>{let[a,i]=(0,Xe.useState)([]),[s,l]=(0,Xe.useState)(!1),[c,d]=(0,Xe.useState)(e);(0,Xe.useEffect)(()=>{let p=()=>{if(o.optionsService){let f=o.optionsService.getOptions("mistake");d(f)}};p();let m=()=>p();return document.addEventListener("journalit-options-changed",m),()=>{document.removeEventListener("journalit-options-changed",m)}},[o.optionsService]);let u=async()=>{if(a.length!==0){l(!0);try{await t(a),r()}catch(p){console.error("Error adding mistakes:",p),l(!1)}}};return Xe.default.createElement("div",{className:"batch-action-modal-content"},Xe.default.createElement("div",{className:"batch-action-modal-body"},Xe.default.createElement(li,{label:"Mistakes",options:c,value:a,onChange:p=>i(p),allowCreate:!0,isMulti:!0,placeholder:"Select or create mistakes...",onSaveOption:n,optionType:"mistake"})),Xe.default.createElement("div",{className:"batch-action-modal-buttons"},Xe.default.createElement("button",{onClick:r,disabled:s},"Cancel"),Xe.default.createElement("button",{onClick:u,disabled:s||a.length===0,className:"primary"},s?"Adding...":`Add ${a.length>0?`(${a.length})`:""}`)))},J4=class extends gp.Modal{constructor(r,n,o,a,i,s){super(r);this.root=null;this.mistakeOptions=n,this.onConfirm=o,this.onModalClose=a,this.onSaveOption=i,this.plugin=s}onOpen(){let{contentEl:r}=this;r.empty(),r.style.minHeight="400px",r.style.maxHeight="80vh",r.style.display="flex",r.style.flexDirection="column",r.createEl("h2",{text:"Add Mistakes to Trades",cls:"journalit-batch-modal-title"}),this.container=r.createDiv({cls:"batch-action-modal-container"}),this.root=(0,X4.createRoot)(this.container),this.root.render(Xe.default.createElement(U_e,{mistakeOptions:this.mistakeOptions,onConfirm:this.onConfirm,onClose:()=>this.close(),onSaveOption:this.onSaveOption,plugin:this.plugin}))}onClose(){this.root&&(this.root.unmount(),this.root=null),this.onModalClose()}},Q4=(0,Xe.memo)(({selectedCount:e,onMarkAsReviewed:t,onAddSetups:r,onAddMistakes:n,onDelete:o,onSelectAll:a,onClearSelection:i,setupOptions:s,mistakeOptions:l,app:c,plugin:d})=>{(0,Xe.useLayoutEffect)(()=>(r1(),()=>{n1()}),[]);let[u,p]=(0,Xe.useState)(!1),[m,f]=(0,Xe.useState)(null),g=(0,Xe.useCallback)(async w=>{try{let S=d==null?void 0:d.optionsService;S&&await S.addOption("setup",w)&&S.notifyOptionsChanged()}catch(S){console.error("Failed to save setup option:",S)}},[d]),v=(0,Xe.useCallback)(async w=>{try{let S=d==null?void 0:d.optionsService;S&&await S.addOption("mistake",w)&&S.notifyOptionsChanged()}catch(S){console.error("Failed to save mistake option:",S)}},[d]),h=(0,Xe.useCallback)(async()=>{try{p(!0),f("reviewed"),await t()}catch(w){console.error("Error marking trades as reviewed:",w),new gp.Notice(`Error marking trades as reviewed: ${w.message}`)}finally{p(!1),f(null)}},[t]),y=(0,Xe.useCallback)(()=>{new K4(c,s,async S=>{try{p(!0),f("setups"),await r(S)}catch(k){console.error("Error adding setups:",k),new gp.Notice(`Error adding setups: ${k.message}`)}finally{p(!1),f(null)}},()=>{},g,d).open()},[c,s,r,g,d]),b=(0,Xe.useCallback)(()=>{new J4(c,l,async S=>{try{p(!0),f("mistakes"),await n(S)}catch(k){console.error("Error adding mistakes:",k),new gp.Notice(`Error adding mistakes: ${k.message}`)}finally{p(!1),f(null)}},()=>{},v,d).open()},[c,l,n,v,d]),x=(0,Xe.useCallback)(()=>{new Y4(c,e,async()=>{try{p(!0),f("delete"),await o()}catch(S){console.error("Error deleting trades:",S),new gp.Notice(`Error deleting trades: ${S.message}`)}finally{p(!1),f(null)}},()=>{}).open()},[c,e,o]);return Xe.default.createElement("div",{className:"batch-action-toolbar"},Xe.default.createElement("div",{className:"batch-action-toolbar-left"},Xe.default.createElement("span",{className:"batch-selection-count"},e===0?"NONE SELECTED":`${e} SELECTED`),Xe.default.createElement("button",{className:"batch-action-select-all-btn",onClick:a,disabled:m!==null,title:"Select all visible trades"},Xe.default.createElement(gd,{size:14}),Xe.default.createElement("span",{className:"select-all-label"},"Select All"))),Xe.default.createElement("div",{className:"batch-action-toolbar-actions"},Xe.default.createElement("button",{className:"batch-action-button",onClick:h,disabled:u||e===0,"aria-label":"Mark as reviewed",title:"Mark selected trades as reviewed"},Xe.default.createElement(Qo,{size:16}),m==="reviewed"?Xe.default.createElement("span",{className:"btn-label"},"Marking..."):Xe.default.createElement("span",{className:"btn-label"},"Mark Reviewed")),Xe.default.createElement("button",{className:"batch-action-button",onClick:y,disabled:u||e===0,"aria-label":"Add setups",title:"Add setups to selected trades"},Xe.default.createElement(Pu,{size:16}),m==="setups"?Xe.default.createElement("span",{className:"btn-label"},"Adding..."):Xe.default.createElement("span",{className:"btn-label"},"Add Setups")),Xe.default.createElement("button",{className:"batch-action-button",onClick:b,disabled:u||e===0,"aria-label":"Add mistakes",title:"Add mistakes to selected trades"},Xe.default.createElement(lo,{size:16}),m==="mistakes"?Xe.default.createElement("span",{className:"btn-label"},"Adding..."):Xe.default.createElement("span",{className:"btn-label"},"Add Mistakes")),Xe.default.createElement("button",{className:"batch-action-button batch-action-delete danger",onClick:x,disabled:u||e===0,"aria-label":"Delete trades",title:"Delete selected trades"},Xe.default.createElement(Mw,{size:16}),m==="delete"?Xe.default.createElement("span",{className:"btn-label"},"Deleting..."):Xe.default.createElement("span",{className:"btn-label"},"Delete")),Xe.default.createElement("button",{className:"batch-action-button batch-action-clear",onClick:i,disabled:u||e===0,"aria-label":"Clear selection",title:"Clear selection"},Xe.default.createElement(Us,{size:16}),Xe.default.createElement("span",{className:"btn-label"},"Clear"))))});Q4.displayName="BatchActionToolbar"});async function jpe(e,t){var l;let r=0,n=0,o=0,a=t.length,i=window.journalitPlugin;(l=i==null?void 0:i.backendIntegrationService)!=null&&l.fileWatcherService&&t.forEach(c=>{i.backendIntegrationService.fileWatcherService.batchModifiedFiles.add(c)});let s=!0;for(let c of t)try{s||await new Promise(f=>setTimeout(f,2)),s=!1;let d=e.vault.getAbstractFileByPath(c);if(!(d instanceof $S.TFile)){console.warn(`File not found or not a TFile: ${c}`),o++;continue}let u=new Date().toISOString(),p=!1,m=!1;await e.fileManager.processFrontMatter(d,f=>{if(f.reviewed===!0){p=!0;return}f.reviewed=!0,f.reviewedAt=u,m=!0}),p?n++:m?r++:o++}catch(d){console.error(`Failed to mark trade as reviewed: ${c}`,d),o++}return await new Promise(c=>setTimeout(c,200)),document.dispatchEvent(new CustomEvent("journalit:trade-data-changed",{detail:{action:"batch-reviewed"}})),setTimeout(()=>{var c;(c=i==null?void 0:i.backendIntegrationService)!=null&&c.fileWatcherService&&t.forEach(d=>{i.backendIntegrationService.fileWatcherService.batchModifiedFiles.delete(d)})},500),{processed:r,skipped:n,errors:o,total:a}}async function zpe(e,t,r,n){var d;let o=0,a=0,i=0,s=t.length,l=[],c=window.journalitPlugin;(d=c==null?void 0:c.backendIntegrationService)!=null&&d.fileWatcherService&&t.forEach(u=>{c.backendIntegrationService.fileWatcherService.batchModifiedFiles.add(u)});for(let u of t)try{let p=e.vault.getAbstractFileByPath(u);if(!(p instanceof $S.TFile)){console.warn(`File not found or not a TFile: ${u}`),i++;continue}let m=!1,f=!1;await e.fileManager.processFrontMatter(p,g=>{let v=Array.isArray(g.setup)?g.setup:[];if(n.every(w=>v.includes(w))){m=!0;return}let y=Array.isArray(g.setupIds)?g.setupIds:[],b=Array.from(new Set([...y,...r])),x=Array.from(new Set([...v,...n]));g.setupIds=b,g.setup=x,f=!0}),m?a++:f?(o++,l.push(p)):i++}catch(p){console.error(`Failed to add setups to trade: ${u}`,p),i++}return await Promise.all(l.map(u=>yr(e,u,120).catch(p=>{}))),document.dispatchEvent(new CustomEvent("journalit:trade-data-changed",{detail:{action:"batch-setups-added",fileCount:l.length,timestamp:Date.now()}})),setTimeout(()=>{var u;(u=c==null?void 0:c.backendIntegrationService)!=null&&u.fileWatcherService&&t.forEach(p=>{c.backendIntegrationService.fileWatcherService.batchModifiedFiles.delete(p)})},500),{processed:o,skipped:a,errors:i,total:s}}async function _pe(e,t,r,n){var d;let o=0,a=0,i=0,s=t.length,l=[],c=window.journalitPlugin;(d=c==null?void 0:c.backendIntegrationService)!=null&&d.fileWatcherService&&t.forEach(u=>{c.backendIntegrationService.fileWatcherService.batchModifiedFiles.add(u)});for(let u of t)try{let p=e.vault.getAbstractFileByPath(u);if(!(p instanceof $S.TFile)){console.warn(`File not found or not a TFile: ${u}`),i++;continue}let m=!1,f=!1;await e.fileManager.processFrontMatter(p,g=>{let v=Array.isArray(g.mistake)?g.mistake:[];if(n.every(w=>v.includes(w))){m=!0;return}let y=Array.isArray(g.mistakeIds)?g.mistakeIds:[],b=Array.from(new Set([...y,...r])),x=Array.from(new Set([...v,...n]));g.mistakeIds=b,g.mistake=x,f=!0}),m?a++:f?(o++,l.push(p)):i++}catch(p){console.error(`Failed to add mistakes to trade: ${u}`,p),i++}return await Promise.all(l.map(u=>yr(e,u,120).catch(p=>{}))),document.dispatchEvent(new CustomEvent("journalit:trade-data-changed",{detail:{action:"batch-mistakes-added",fileCount:l.length,timestamp:Date.now()}})),setTimeout(()=>{var u;(u=c==null?void 0:c.backendIntegrationService)!=null&&u.fileWatcherService&&t.forEach(p=>{c.backendIntegrationService.fileWatcherService.batchModifiedFiles.delete(p)})},500),{processed:o,skipped:a,errors:i,total:s}}async function Bpe(e,t){var i;let r=0,n=0,o=t.length,a=window.journalitPlugin;(i=a==null?void 0:a.backendIntegrationService)!=null&&i.fileWatcherService&&t.forEach(s=>{a.backendIntegrationService.fileWatcherService.batchModifiedFiles.add(s)});for(let s of t)try{let l=e.vault.getAbstractFileByPath(s);if(!(l instanceof $S.TFile)){console.warn(`File not found or not a TFile: ${s}`),n++;continue}await e.vault.delete(l),r++}catch(l){console.error(`Failed to delete trade: ${s}`,l),n++}return await new Promise(s=>setTimeout(s,500)),document.dispatchEvent(new CustomEvent("journalit:trade-data-changed",{detail:{action:"batch-deleted"}})),setTimeout(()=>{var s;(s=a==null?void 0:a.backendIntegrationService)!=null&&s.fileWatcherService&&t.forEach(l=>{a.backendIntegrationService.fileWatcherService.batchModifiedFiles.delete(l)})},500),{processed:r,skipped:0,errors:n,total:o}}var $S,$pe=L(()=>{$S=require("obsidian");ls()});function Wpe(e,t,r){let n=[],o=0;function a(d){var u,p;for(let m of d){if(m.type==="trade"){let f=((u=m.trade)==null?void 0:u.filePath)||((p=m.trade)==null?void 0:p.path);f&&(n.push({id:f,index:o}),o++)}m.children&&m.children.length>0&&a(m.children)}}a(e);let i=n.findIndex(d=>d.id===t),s=n.findIndex(d=>d.id===r);if(i===-1||s===-1)return[];let l=Math.min(i,s),c=Math.max(i,s);return n.slice(l,c+1).map(d=>d.id)}var Rpe=L(()=>{});var Ue,Qa,Upe,V_e,Vpe,Hpe=L(()=>{Ue=q(Y());_4();CL();ope();Epe();Ed();Npe();qf();Td();Qa=require("obsidian");B4();Fpe();er();Ope();$pe();Au();Rpe();Upe=(e,t,r)=>{let n=!1;return e.map(a=>a.id===t?(n=!0,{...a,children:r,dataLoaded:!0}):a.children?{...a,children:Upe(a.children,t,r)}:a)},V_e={ArrowUp01:lw,ArrowDown10:iw,ArrowUpAZ:Hp,ArrowDownZA:Vp,ArrowUpNarrowWide:qp,ArrowDownWideNarrow:Up,ArrowUpDown:cw},Vpe=({plugin:e})=>{let[t,r]=(0,Ue.useState)(!1),[n,o]=(0,Ue.useState)(!1),[a,i]=(0,Ue.useState)(new Set),[s,l]=(0,Ue.useState)([]),[c,d]=(0,Ue.useState)(new Set),[u,p]=(0,Ue.useState)({dateRange:[null,null],viewLevel:"trades",tradeTypes:[],statuses:[],accounts:[],tickers:[],setups:[]}),[m,f]=(0,Ue.useState)(0),[g,v]=(0,Ue.useState)({column:null,direction:"desc"}),[h,y]=(0,Ue.useState)(()=>{let oe=window.innerHeight||600;return Math.max(400,oe-200)}),[b,x]=(0,Ue.useState)(new Set),[w,S]=(0,Ue.useState)(!1),[k,T]=(0,Ue.useState)(0),[P,D]=(0,Ue.useState)(null),O=(0,Ue.useRef)(0),[z,I]=(0,Ue.useState)(null),A=(0,Ue.useRef)(!1),j=(0,Ue.useRef)("trades"),E=(0,Ue.useRef)(!1),N=(0,Ue.useMemo)(()=>{let oe=e.settings.tradeLog||{columnVisibility:{},columnOrder:[],columnWidths:{}},ge=Jue(oe.columnVisibility,oe.columnOrder);if(w){let Se=mp.find(De=>De.id==="select");Se&&(ge=[Se,...ge])}return ge},[e.settings.tradeLog,m,w]),B=(0,Ue.useMemo)(()=>Xue(N,u.viewLevel),[N,u.viewLevel]),C=(0,Ue.useMemo)(()=>u.viewLevel!=="trades"||!g.column?s:Mpe(s,g),[s,g,u.viewLevel]),F=(0,Ue.useMemo)(()=>{if(u.viewLevel!=="trades")return 0;let oe=N.reduce((De,se)=>{let Fe=se.width===0?se.id==="thesis"?320:120:se.width;return De+Fe},0),ge=Math.max(0,N.length-1)*8;return oe+ge+32},[N,u.viewLevel]),M=(0,Ue.useRef)(null);M.current||(M.current=new kh(e));let _=M.current,W=MH(u,150);(0,Ue.useEffect)(()=>{let oe=()=>{T(ge=>ge+1)};return document.addEventListener("journalit-options-changed",oe),()=>{document.removeEventListener("journalit-options-changed",oe)}},[]);let $=(0,Ue.useMemo)(()=>{var oe;try{return((oe=e.optionsService)==null?void 0:oe.getOptions("setup"))||[]}catch(ge){return console.error("Failed to load setup options:",ge),[]}},[e.optionsService,k]),H=(0,Ue.useMemo)(()=>{var oe;try{return((oe=e.optionsService)==null?void 0:oe.getOptions("mistake"))||[]}catch(ge){return console.error("Failed to load mistake options:",ge),[]}},[e.optionsService,k]);(0,Ue.useEffect)(()=>{let oe=()=>{var De,se;let Se=document.querySelector(".journalit-trade-log-view-container");if(Se){let Fe=Se.getBoundingClientRect(),re=((se=(De=document.querySelector(".trade-log-header"))==null?void 0:De.getBoundingClientRect())==null?void 0:se.height)||120,Ee=Fe.height-re;y(Math.max(400,Ee))}},ge=setTimeout(oe,200);return window.addEventListener("resize",oe),()=>{clearTimeout(ge),window.removeEventListener("resize",oe)}},[]);let R=(0,Ue.useCallback)(async()=>{let oe=performance.now();A.current||r(!1),o(!1);try{E.current=!0;let ge=await _.getHierarchicalData(W.viewLevel,W.dateRange[0]||void 0,W.dateRange[1]||void 0,W.tradeTypes,W.statuses,W.accounts,W.tickers,W.setups);l(ge),(!A.current||j.current!==W.viewLevel)&&d(new Set),j.current=W.viewLevel,r(!0),A.current=!0,I(O.current)}catch(ge){console.error("Error loading trade log data:",ge),r(!0),o(!0)}finally{E.current=!1}},[_,W,e]),V=(0,Ue.useCallback)(oe=>{v(ge=>{if(oe==="date")return ge.column===oe?{column:oe,direction:ge.direction==="asc"?"desc":"asc"}:{column:oe,direction:"desc"};let Se=["pnl","positionSize","duration","expirationDate","daysToExpiry"].includes(oe)?"desc":"asc",De=Se==="desc"?"asc":"desc";return ge.column===oe?ge.direction===Se?{column:oe,direction:De}:{column:null,direction:"desc"}:{column:oe,direction:Se}})},[]),Z=(0,Ue.useCallback)((oe,ge)=>{if(ge&&"shiftKey"in ge&&ge.shiftKey&&P&&P!==oe){let De=Wpe(C,P,oe);if(De.length>0){x(se=>{let Fe=new Set(se);return De.forEach(re=>Fe.add(re)),Fe}),D(oe);return}}x(De=>{let se=new Set(De);return se.has(oe)?se.delete(oe):se.add(oe),se}),D(oe)},[P,C]),K=(0,Ue.useCallback)(()=>{let oe=new Set,ge=Se=>{Se.forEach(De=>{var se,Fe,re,Ee;if(De.type==="trade"){let at=((Fe=(se=De.trade)==null?void 0:se.file)==null?void 0:Fe.path)||((re=De.trade)==null?void 0:re.filePath)||((Ee=De.trade)==null?void 0:Ee.path);at&&oe.add(at)}De.children&&ge(De.children)})};ge(C),x(oe)},[C]),X=(0,Ue.useCallback)(()=>{x(new Set)},[]),G=(0,Ue.useCallback)(()=>{S(oe=>!oe),w&&x(new Set)},[w]),U=(0,Ue.useCallback)(async()=>{let oe=Array.from(b),ge=await jpe(e.app,oe);if(ge.errors>0&&ge.processed===0)new Qa.Notice(`Failed to mark trades as reviewed. ${ge.errors} error${ge.errors>1?"s":""} occurred.`);else if(ge.processed===0)new Qa.Notice(`All ${ge.total} selected trade${ge.total>1?"s are":" is"} already reviewed`);else if(ge.skipped===0&&ge.errors===0)new Qa.Notice(`Marked ${ge.processed} trade${ge.processed>1?"s":""} as reviewed`);else{let Se=[`Marked ${ge.processed} trade${ge.processed>1?"s":""} as reviewed`];ge.skipped>0&&Se.push(`${ge.skipped} already reviewed`),ge.errors>0&&Se.push(`${ge.errors} error${ge.errors>1?"s":""}`),new Qa.Notice(Se.join(", "))}x(new Set),ge.processed>0&&S(!1)},[b,e.app]),Q=(0,Ue.useCallback)(async oe=>{let ge=Array.from(b),Se=await zpe(e.app,ge,oe,oe);if(Se.errors>0&&Se.processed===0)new Qa.Notice(`Failed to add setups. ${Se.errors} error${Se.errors>1?"s":""} occurred.`);else if(Se.processed===0)new Qa.Notice(`No trades needed updates - all ${Se.total} already had these setups`);else if(Se.skipped===0&&Se.errors===0)new Qa.Notice(`Added setups to ${Se.processed} trades`);else{let De=[`Added setups to ${Se.processed} trades`];Se.skipped>0&&De.push(`${Se.skipped} already had all setups`),Se.errors>0&&De.push(`${Se.errors} error${Se.errors>1?"s":""}`),new Qa.Notice(De.join(", "))}x(new Set),Se.processed>0&&S(!1)},[b,e.app]),J=(0,Ue.useCallback)(async oe=>{let ge=Array.from(b),Se=await _pe(e.app,ge,oe,oe);if(Se.errors>0&&Se.processed===0)new Qa.Notice(`Failed to add mistakes. ${Se.errors} error${Se.errors>1?"s":""} occurred.`);else if(Se.processed===0)new Qa.Notice(`No trades needed updates - all ${Se.total} already had these mistakes`);else if(Se.skipped===0&&Se.errors===0)new Qa.Notice(`Added mistakes to ${Se.processed} trades`);else{let De=[`Added mistakes to ${Se.processed} trades`];Se.skipped>0&&De.push(`${Se.skipped} already had all mistakes`),Se.errors>0&&De.push(`${Se.errors} error${Se.errors>1?"s":""}`),new Qa.Notice(De.join(", "))}x(new Set),Se.processed>0&&S(!1)},[b,e.app]),ee=(0,Ue.useCallback)(async()=>{let oe=Array.from(b),ge=await Bpe(e.app,oe);ge.errors>0&&ge.processed===0?new Qa.Notice(`Failed to delete trades. ${ge.errors} error${ge.errors>1?"s":""} occurred.`):ge.errors===0?new Qa.Notice(`Deleted ${ge.processed} trade${ge.processed>1?"s":""}`):new Qa.Notice(`Deleted ${ge.processed} trade${ge.processed>1?"s":""} (${ge.errors} error${ge.errors>1?"s":""})`),x(new Set),S(!1)},[b,e.app]);(0,Ue.useEffect)(()=>{R()},[W]),(0,Ue.useEffect)(()=>{let oe={current:null},ge=async Se=>{let De=Se.detail||{},Fe=typeof(De==null?void 0:De.action)=="string"&&De.action.startsWith("batch-")?800:400;oe.current&&window.clearTimeout(oe.current),oe.current=window.setTimeout(async()=>{e.app.workspace.trigger&&e.app.workspace.trigger("layout-change"),await new Promise(re=>setTimeout(re,80)),await R(),oe.current=null},Fe)};return document.addEventListener("journalit:trade-data-changed",ge),document.addEventListener("journalit:missed-trade-data-changed",ge),document.addEventListener("journalit:backtest-trade-data-changed",ge),()=>{document.removeEventListener("journalit:trade-data-changed",ge),document.removeEventListener("journalit:missed-trade-data-changed",ge),document.removeEventListener("journalit:backtest-trade-data-changed",ge),oe.current&&window.clearTimeout(oe.current)}},[R,e.app.workspace]),(0,Ue.useEffect)(()=>()=>{M.current&&M.current.destroy()},[]);let te=(0,Ue.useCallback)(async oe=>{let ge=new Set(c),Se=!c.has(oe.id);if(c.has(oe.id))ge.delete(oe.id),d(ge);else if(!oe.dataLoaded&&oe.type!=="trade"){i(De=>new Set(De).add(oe.id));try{let De=await _.getNodeChildren(oe);l(se=>Upe(se,oe.id,De)),setTimeout(()=>{d(se=>{let Fe=new Set(se);return Fe.add(oe.id),Fe})},0)}catch(De){console.error("Error loading node children:",De)}finally{i(De=>{let se=new Set(De);return se.delete(oe.id),se})}}else ge.add(oe.id),d(ge)},[c,_,e]),ue=(0,Ue.useCallback)(async oe=>{var Se,De,se;let ge=yh.getInstance(e.app,e);switch(oe.type){case"trade":{let Fe;(Se=oe.trade)!=null&&Se.file?Fe=oe.trade.file.path:(De=oe.trade)!=null&&De.filePath?Fe=oe.trade.filePath:oe.id&&oe.id.includes(".md")&&(Fe=oe.id),Fe&&(e.app.vault.getAbstractFileByPath(Fe)?await e.openFile(Fe,!1):(console.warn("Trade file not found:",Fe),new Qa.Notice(`Trade file not found: ${Fe}`)));break}case"day":{let Fe=new Date(oe.id),re=await ge.getDRCService(),Ee=re.getDRCNotePath(Fe);e.app.vault.getAbstractFileByPath(Ee)?await e.openFile(Ee,!1):e.settings.drc.autoCreateDRCOnNavigation&&(await re.createDRC(Fe),await e.openFile(Ee,!1));break}case"week":{let Fe=oe.id.split("-W"),re=Fe[1],at=Fe[0].split("-")[0],$t=parseInt(at),it=parseInt(re),Hn=new Date($t,0,1).getDay(),es=Hn===0?-6:1-Hn,ei=new Date($t,0,1+es),rn=new Date(ei.getTime()+(it-1)*7*24*60*60*1e3),Ai=await ge.getWeeklyReviewService(),Ms=Ai.getWeeklyReviewPath(rn);e.app.vault.getAbstractFileByPath(Ms)?await e.openFile(Ms,!1):e.settings.weekly.autoCreateWeeklyReviewOnNavigation&&(await Ai.createWeeklyReview(rn),await e.openFile(Ms,!1));break}case"month":{let[Fe,re]=oe.id.split("-"),Ee=parseInt(Fe),at=parseInt(re)-1,$t=new Date(Ee,at,1),it=await ge.getMonthlyReviewService(),Jr=it.getMonthlyReviewPath($t);e.app.vault.getAbstractFileByPath(Jr)?await e.openFile(Jr,!1):(se=e.settings.monthly)!=null&&se.autoCreateMonthlyReviewOnNavigation&&await it.createMonthlyReview($t)&&await e.openFile(Jr,!1);break}case"quarter":case"year":console.log(`No review available for ${oe.type}:`,oe.id);break}},[e]),be=(0,Ue.useCallback)(async oe=>{p(ge=>({...ge,...oe}))},[]),Le=(0,Ue.useCallback)(()=>{f(oe=>oe+1)},[]),$e=(0,Ue.useCallback)(()=>{o(!0),I(null)},[]);return t&&s.length===0?Ue.default.createElement("div",{className:"journalit-trade-log"},Ue.default.createElement(GL,{app:e.app,plugin:e,filters:u,onFilterChange:be,onSettingsChange:Le,isMultiSelectMode:w,onToggleMultiSelectMode:G}),Ue.default.createElement(et,{message:"No trades found",subMessage:"Start creating trade notes to see them appear in your trade log.",actionButtonText:"Create Trade",onActionButtonClick:async()=>{new jo({app:e.app,plugin:e}).open()}})):Ue.default.createElement("div",{className:"journalit-trade-log"},Ue.default.createElement(GL,{app:e.app,plugin:e,filters:u,onFilterChange:be,onSettingsChange:Le,isMultiSelectMode:w,onToggleMultiSelectMode:G}),w&&Ue.default.createElement(Q4,{app:e.app,plugin:e,selectedCount:b.size,onMarkAsReviewed:U,onAddSetups:Q,onAddMistakes:J,onDelete:ee,onSelectAll:K,onClearSelection:X,setupOptions:$,mistakeOptions:H}),Ue.default.createElement("div",{className:`trade-log-content ${u.viewLevel==="trades"?"trades-view":""}`},u.viewLevel==="trades"?Ue.default.createElement("div",{className:"trade-log-hscroll",style:{overflowX:"auto",overflowY:"hidden"}},Ue.default.createElement("div",{className:"trade-log-hscroll-inner",style:{minWidth:`${F}px`,width:"100%"}},t&&Ue.default.createElement("div",{className:"trade-log-headers"},Ue.default.createElement("div",{className:"trade-log-header-row",style:{gridTemplateColumns:B}},N.map(oe=>{let ge=g.column===oe.id,Se=oe.sortable,De=Se?Zue(oe.type,ge?g.direction:null):null,se=De?V_e[De]:null;return Ue.default.createElement("div",{key:oe.id,className:`header-cell header-${oe.id} ${Se?"sortable":""} ${ge?"sorted":""}`,onClick:Se?()=>V(oe.id):void 0},Ue.default.createElement("span",null,oe.label),se&&Ue.default.createElement(se,{size:14,className:ge?"sort-indicator":"sort-indicator-unsorted"}))}))),t?Ue.default.createElement("div",{style:{position:"relative",height:"100%"}},!n&&Ue.default.createElement(rx,{visibleColumns:N,gridTemplate:B,containerHeight:h}),Ue.default.createElement("div",{style:{visibility:n?"visible":"hidden",height:"100%"}},Ue.default.createElement(G4,{nodes:C,expandedNodes:c,onToggleExpand:te,onNodeClick:ue,onTreeReady:$e,viewLevel:u.viewLevel,visibleColumns:N,gridTemplate:B,selectedTrades:b,onToggleTradeSelection:Z,isMultiSelectMode:w,requestedScrollOffset:z,onScrollOffsetChange:oe=>{O.current=oe}}))):Ue.default.createElement(rx,{visibleColumns:N,gridTemplate:B,containerHeight:h}))):t?Ue.default.createElement("div",{style:{position:"relative",height:"100%"}},!n&&Ue.default.createElement(rx,{visibleColumns:N,gridTemplate:B,containerHeight:h}),Ue.default.createElement("div",{style:{visibility:n?"visible":"hidden",height:"100%"}},Ue.default.createElement(G4,{nodes:C,expandedNodes:c,onToggleExpand:te,onNodeClick:ue,onTreeReady:$e,viewLevel:u.viewLevel,visibleColumns:N,gridTemplate:B,selectedTrades:b,onToggleTradeSelection:Z,isMultiSelectMode:w,requestedScrollOffset:z,onScrollOffsetChange:oe=>{O.current=oe}}))):Ue.default.createElement(rx,{visibleColumns:N,gridTemplate:B,containerHeight:h})))}});var qpe,iu,ZL,Gpe=L(()=>{qpe=q(Y());Xf();Hpe();ba();iu="journalit-trade-log-view",ZL=class extends us{constructor(t,r){super(t),this.plugin=r}getDisplayText(){return"Trade Log"}getViewType(){return iu}getIcon(){return"folder-tree"}async onOpen(){try{await super.onOpen(),Pc(!0,!0,!0,!0,!0,!0,!0,!0,!0),Cv(!0,!0,!0,!0,!0,!0,!0,!0,!0,!0),this.containerEl&&this.containerEl.classList.add("journalit-trade-log-view-container")}catch(t){console.error("Error in TradeLogView.onOpen:",t)}}async onClose(){try{await super.onClose()}catch(t){console.error("Error in TradeLogView.onClose:",t)}}getRenderFunction(){return()=>qpe.default.createElement(Vpe,{plugin:this.plugin})}}});function Kpe(e,t,r,n,o){new Z4({app:e,plugin:t,accountName:r,transaction:n,onClose:()=>{},onSave:o}).open()}var Zc,bt,Ype,Z4,H_e,Jpe=L(()=>{Zc=require("obsidian"),bt=q(Y()),Ype=q(wn());di();Nr();wt();rr();Z4=class extends Zc.Modal{constructor(t){super(t.app),this.props=t}onOpen(){let{contentEl:t}=this;t.empty();let r=this.props.transaction.type==="deposit"?"Deposit":"Withdrawal";t.createEl("h2",{text:`Edit ${r}`,cls:"modal-title"}),this.container=t.createDiv({cls:"add-event-modal-container"}),this.renderComponent()}onClose(){this.root&&this.root.unmount(),this.props.onClose()}renderComponent(){this.root=(0,Ype.createRoot)(this.container),this.root.render(bt.default.createElement(cs,null,bt.default.createElement(H_e,{...this.props,onModalClose:()=>this.close()})))}},H_e=({plugin:e,accountName:t,transaction:r,onSave:n,onModalClose:o})=>{let[a,i]=(0,bt.useState)(!1),[s,l]=(0,bt.useState)(!1),[c,d]=(0,bt.useState)(!1),{currency:u}=Ke(),p=()=>new Date().toISOString().split("T")[0],[m,f]=(0,bt.useState)({type:r.type,amount:Math.abs(r.amount).toString(),date:new Date(r.date).toISOString().split("T")[0],description:r.description||""}),g=b=>new Intl.NumberFormat("en-US",{style:"currency",currency:u,minimumFractionDigits:2}).format(Math.abs(b)),v=async()=>{var b;try{if(i(!0),!m.amount||parseFloat(m.amount)<=0){new Zc.Notice("Amount must be greater than 0");return}if(!m.date){new Zc.Notice("Date is required");return}let x=parseFloat(m.amount);if(!iv(m.date)){new Zc.Notice("Invalid date format");return}let w=new Date(m.date),S=new Date;if(S.setHours(23,59,59,999),w>S){new Zc.Notice("Transaction date cannot be in the future");return}await((b=e.accountPageService)==null?void 0:b.updateManualTransaction(t,r.id,{amount:x,date:w,description:m.description||void 0}));let k=m.type==="deposit"?"Deposit":"Withdrawal";new Zc.Notice(`${k} updated successfully`),n(),o()}catch(x){console.error("Error updating transaction:",x),new Zc.Notice(`Error updating transaction: ${x.message}`)}finally{i(!1)}},h=async()=>{var b;try{l(!0),await((b=e.accountPageService)==null?void 0:b.deleteManualTransaction(t,r.id));let x=r.type==="deposit"?"Deposit":"Withdrawal";new Zc.Notice(`${x} deleted successfully`),n(),o()}catch(x){console.error("Error deleting transaction:",x),new Zc.Notice(`Error deleting transaction: ${x.message}`)}finally{l(!1)}},y=r.type==="deposit"?"Deposit":"Withdrawal";return c?bt.default.createElement("div",{className:"add-event-form"},bt.default.createElement("div",{className:"setting-item"},bt.default.createElement("div",{className:"setting-item-info"},bt.default.createElement("div",{className:"setting-item-name",style:{color:"var(--text-error)"}},"Delete ",y),bt.default.createElement("div",{className:"setting-item-description"},"Are you sure you want to delete this ",y.toLowerCase()," of ",g(r.amount)," from ",rt(new Date(r.date),tr()),"?"),bt.default.createElement("div",{className:"setting-item-description warning"},"This action cannot be undone."))),bt.default.createElement("div",{className:"add-event-buttons"},bt.default.createElement("div",{className:"button-group-right"},bt.default.createElement(he,{variant:"secondary",onClick:h,disabled:s,className:"delete-transaction-button",style:{backgroundColor:"var(--color-red)",color:"white",borderColor:"var(--color-red)"}},s?"Deleting...":`Delete ${y}`),bt.default.createElement(he,{variant:"secondary",onClick:()=>d(!1),disabled:s,className:"cancel-button"},"Cancel")))):bt.default.createElement("div",{className:"add-event-form"},bt.default.createElement("div",{className:"setting-item two-column"},bt.default.createElement("div",{className:"column"},bt.default.createElement("div",{className:"setting-item-info"},bt.default.createElement("div",{className:"setting-item-name"},"Transaction Type"),bt.default.createElement("div",{className:"setting-item-description"},"Cannot be changed when editing")),bt.default.createElement("div",{className:"setting-item-control"},bt.default.createElement("select",{value:m.type,disabled:!0},bt.default.createElement("option",{value:"deposit"},"Deposit"),bt.default.createElement("option",{value:"withdrawal"},"Withdrawal")))),bt.default.createElement("div",{className:"column"},bt.default.createElement("div",{className:"setting-item-info"},bt.default.createElement("div",{className:"setting-item-name"},"Amount"),bt.default.createElement("div",{className:"setting-item-description"},"Amount in ",u)),bt.default.createElement("div",{className:"setting-item-control"},bt.default.createElement("input",{type:"number",value:m.amount,onChange:b=>f({...m,amount:b.target.value}),onFocus:b=>{(m.amount==="0"||m.amount==="")&&(b.target.value="")},min:"0.01",step:"0.01",placeholder:"0.00",disabled:a})))),bt.default.createElement("div",{className:"setting-item two-column"},bt.default.createElement("div",{className:"column"},bt.default.createElement("div",{className:"setting-item-info"},bt.default.createElement("div",{className:"setting-item-name"},"Date"),bt.default.createElement("div",{className:"setting-item-description"},"Transaction date")),bt.default.createElement("div",{className:"setting-item-control"},bt.default.createElement("input",{type:"date",value:m.date,onChange:b=>f({...m,date:b.target.value}),max:p(),disabled:a}))),bt.default.createElement("div",{className:"column"},bt.default.createElement("div",{className:"setting-item-info"},bt.default.createElement("div",{className:"setting-item-name"},"Description (Optional)"),bt.default.createElement("div",{className:"setting-item-description"},"Additional notes")),bt.default.createElement("div",{className:"setting-item-control"},bt.default.createElement("input",{type:"text",value:m.description,onChange:b=>f({...m,description:b.target.value}),placeholder:m.type==="deposit"?"Manual deposit":"Manual withdrawal",disabled:a})))),bt.default.createElement("div",{className:"add-event-buttons"},bt.default.createElement("div",{className:"button-group-left"},bt.default.createElement(he,{variant:"secondary",onClick:()=>d(!0),disabled:a,className:"delete-transaction-button",style:{backgroundColor:"var(--color-red)",color:"white",borderColor:"var(--color-red)"}},"Delete ",y)),bt.default.createElement("div",{className:"button-group-right"},bt.default.createElement(he,{variant:"primary",onClick:v,disabled:a,className:"add-event-button accent-button",style:{backgroundColor:"var(--interactive-accent)",color:"var(--text-on-accent)",borderColor:"var(--interactive-accent)"}},a?"Saving...":"Save Changes"),bt.default.createElement(he,{variant:"secondary",onClick:o,disabled:a,className:"cancel-button"},"Cancel"))))}});var Rn,q_e,Xpe,Qpe=L(()=>{Rn=q(Y());pp();pt();eo();Nr();di();D4();Jpe();wt();rr();Ut();q_e=({transaction:e,accountName:t,onUpdate:r})=>{let n=xe(),{currency:o}=Ke(),a=tr(),i=p=>ha(Math.abs(p),!1,o),s=p=>ha(p,!1,o),l=async()=>{n&&Kpe(n.app,n,t,e,r)},c=e.type==="deposit",d=c?"Deposit":"Withdrawal",u=c?"deposit":"withdrawal";return Rn.default.createElement("div",{className:`transaction-item ${u} clickable`,onClick:l,title:"Click to edit or delete this transaction"},Rn.default.createElement("div",{className:"transaction-header"},Rn.default.createElement("div",{className:"transaction-primary-info"},Rn.default.createElement("span",{className:`transaction-type ${u}`},d),Rn.default.createElement("span",{className:"transaction-date"},rt(e.date instanceof Date?e.date:new Date(e.date),a))),Rn.default.createElement("span",{className:`transaction-amount ${c?"positive":"negative"}`},c?"+":"-",i(e.amount))),Rn.default.createElement("div",{className:"transaction-details"},e.description&&Rn.default.createElement("div",{className:"transaction-description"},Rn.default.createElement("span",{className:"description-label"},"Description:"),Rn.default.createElement("span",{className:"description-text"},e.description)),Rn.default.createElement("div",{className:"transaction-meta"},Rn.default.createElement("span",{className:"balance-after"},"Balance after: ",s(e.balanceAfter)))))},Xpe=()=>{let{accountPageData:e,refreshData:t}=Ds(),r=xe();if(!e||!r)return null;let{account:n}=e,a=[...(n.transactions||[]).filter(s=>(s.type==="deposit"||s.type==="withdrawal")&&s.description!=="Initial deposit")].filter(s=>s&&s.date).sort((s,l)=>{let c=Xt(s.date),d=Xt(l.date);return((d==null?void 0:d.getTime())||0)-((c==null?void 0:c.getTime())||0)}),i=async()=>{HL(r.app,r,n.name,t)};return Rn.default.createElement("div",{className:"deposits-withdrawals-section"},Rn.default.createElement("div",{className:"section-header-centered"},Rn.default.createElement("span",{className:"section-header-line"}),Rn.default.createElement("h3",{className:"section-header-title"},"Deposits & Withdrawals (",a.length,")"),Rn.default.createElement("span",{className:"section-header-line"})),a.length===0?Rn.default.createElement("div",{className:"empty-transactions"},Rn.default.createElement(et,{message:"No manual deposits or withdrawals recorded.",subMessage:"Click the + button in the header to add your first transaction."}),Rn.default.createElement("div",{className:"empty-state-action"},Rn.default.createElement(he,{onClick:i,variant:"primary",className:"add-first-transaction-btn"},"Add First Transaction"))):Rn.default.createElement("div",{className:"transactions-list"},a.map(s=>Rn.default.createElement(q_e,{key:s.id,transaction:s,accountName:n.name,onUpdate:t}))))}});function Zpe(){if(WS===0){let e=document.createElement("style");e.id="account-page-skeleton-styles",e.textContent=G_e,document.head.appendChild(e)}WS++}function eme(){var e;WS--,WS<=0&&(WS=0,(e=document.head.querySelector("#account-page-skeleton-styles"))==null||e.remove())}var G_e,WS,tme=L(()=>{G_e=`
.account-page-skeleton {
  width: 100%;
  padding: 1.5rem;
  display: flex;
  flex-direction: column;
  gap: 2rem;
  background: var(--background-primary);
}

.account-page-skeleton-header {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  padding-bottom: 1rem;
  border-bottom: 1px solid var(--background-modifier-border);
}

.account-page-skeleton-chart {
  width: 100%;
}

.account-page-skeleton-metrics {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1rem;
}

.skeleton-metric-card {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  padding: 1rem;
  border-radius: 8px;
  background: var(--background-secondary);
}

.account-page-skeleton-risk {
  display: flex;
  flex-direction: column;
  gap: 1rem;
}

.skeleton-risk-visualizations {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1rem;
}

.account-page-skeleton-transactions,
.account-page-skeleton-trades {
  width: 100%;
}

@media (max-width: 768px) {
  .account-page-skeleton {
    padding: 1rem;
    gap: 1.5rem;
  }

  .account-page-skeleton-metrics {
    grid-template-columns: 1fr;
  }

  .skeleton-risk-visualizations {
    grid-template-columns: 1fr;
  }
}
`,WS=0});var Un,e6,rme=L(()=>{Un=q(Y());mg();gg();PP();tme();Kf();e6=(0,Un.memo)(()=>((0,Un.useLayoutEffect)(()=>(Ll(),Zpe(),()=>{eme()}),[]),Un.default.createElement("div",{className:"account-page-skeleton","aria-label":"Loading account page"},Un.default.createElement("div",{className:"account-page-skeleton-header"},Un.default.createElement(Kt,{width:"200px",height:"24px"}),Un.default.createElement(Kt,{width:"120px",height:"16px"})),Un.default.createElement("div",{className:"account-page-skeleton-chart"},Un.default.createElement(Ad,{type:"chart"})),Un.default.createElement("div",{className:"account-page-skeleton-metrics"},Array.from({length:4}).map((e,t)=>Un.default.createElement("div",{key:t,className:"skeleton-metric-card"},Un.default.createElement(Kt,{width:"80px",height:"14px"}),Un.default.createElement(Kt,{width:"100px",height:"20px"})))),Un.default.createElement("div",{className:"account-page-skeleton-risk"},Un.default.createElement(Kt,{width:"150px",height:"18px"}),Un.default.createElement("div",{className:"skeleton-risk-visualizations"},Un.default.createElement(Bi,{width:"100%",height:"120px",borderRadius:"8px"}),Un.default.createElement(Bi,{width:"100%",height:"120px",borderRadius:"8px"}))),Un.default.createElement("div",{className:"account-page-skeleton-transactions"},Un.default.createElement(Ad,{type:"table"})),Un.default.createElement("div",{className:"account-page-skeleton-trades"},Un.default.createElement(Ad,{type:"table"})))));e6.displayName="AccountPageSkeleton"});var dl,nme,ome=L(()=>{dl=q(Y());pp();eo();O4();Qpe();pt();rme();nme=()=>{let{accountPageData:e,isLoading:t,error:r,accountName:n}=Ds(),o=xe();return t&&!e?dl.default.createElement(e6,null):r?dl.default.createElement("div",{className:"account-page-error"},dl.default.createElement("h3",null,"Error Loading Account"),dl.default.createElement("p",null,r.message)):e?dl.default.createElement("div",{className:"account-page-content"},dl.default.createElement(E4,null),dl.default.createElement(L4,null),dl.default.createElement(I4,null),dl.default.createElement(N4,null),dl.default.createElement(Xpe,null),dl.default.createElement(A4,null)):dl.default.createElement(et,{message:`Could not find account data for "${n}"`,subMessage:"Please check if the account exists or try refreshing the page."})}});var Is,ed,nx,Y_e,K_e,ame=L(()=>{Is=q(Y());Xf();ba();pt();kv();pp();ome();ed="journalit-account-page-view",nx=class extends us{constructor(r){super(r);this.accountName=""}getDisplayText(){return this.accountName?`Account: ${this.accountName}`:"Account Page"}getViewType(){return ed}getIcon(){return"user-circle"}async onOpen(){try{await super.onOpen(),pm(),this.containerEl&&(this.containerEl.classList.add("journalit-account-page-view-container"),Object.assign(this.containerEl.style,{padding:"0"}))}catch(r){console.error("Error in AccountPageView.onOpen:",r)}}async onClose(){try{await super.onClose()}catch(r){console.error("Error in AccountPageView.onClose:",r)}}setAccountName(r){this.accountName=r,this.leaf&&(this.leaf.view=this)}getAccountName(){return this.accountName}async setState(r,n){await super.setState(r,n),r!=null&&r.accountName&&this.setAccountName(r.accountName)}getState(){return{...super.getState(),accountName:this.accountName}}getRenderFunction(){return()=>Is.default.createElement(Y_e,{leaf:this.leaf,view:this})}},Y_e=({leaf:e,view:t})=>{let r=xe(),n=t.getAccountName();return r?n?Is.default.createElement("div",{className:"journalit-account-page-view"},Is.default.createElement(K_e,{accountName:n,plugin:r})):Is.default.createElement("div",{className:"journalit-account-page-view"},Is.default.createElement("div",{className:"account-page-error"},Is.default.createElement("h3",null,"No Account Selected"),Is.default.createElement("p",null,"Please navigate to this page from the Account Dashboard."))):Is.default.createElement("div",{className:"journalit-account-page-view"},"Loading...")},K_e=({accountName:e,plugin:t})=>{let{service:r}=_q();return r?Is.default.createElement(Sue,{app:t.app,accountPageService:r,accountName:e,plugin:t},Is.default.createElement("div",{className:"account-page-wrapper"},Is.default.createElement(nme,null))):Is.default.createElement("div",{className:"account-page-loading"},Is.default.createElement("p",null,"Loading account page service..."))}});var Ei,ime,sme,lme=L(()=>{Ei=q(Y()),ime=require("obsidian");vd();sme=({plugin:e,selectedAccountName:t,onAccountSelect:r})=>{let[n,o]=(0,Ei.useState)([]),[a,i]=(0,Ei.useState)(!0);(0,Ei.useEffect)(()=>{s()},[]);let s=async()=>{try{i(!0);let u=(await(await e.serviceManager.getAccountPageService()).getAllEnhancedAccounts()).map(p=>({value:p.accountName||p.name,label:p.accountName||p.name}));o(u),u.length===1&&!t&&r(u[0].value)}catch(c){console.error("Failed to load accounts:",c),new ime.Notice("Failed to load accounts")}finally{i(!1)}},l=c=>{r(c)};return a?Ei.default.createElement("div",{className:"csv-loading"},Ei.default.createElement("div",{className:"csv-spinner"}),Ei.default.createElement("span",null,"Loading accounts...")):n.length===0?Ei.default.createElement("div",{className:"csv-message csv-message--error"},Ei.default.createElement("strong",null,"No accounts found.")," Please create an account before importing trades."):Ei.default.createElement("div",{className:"csv-account-selector"},Ei.default.createElement("label",{htmlFor:"account-select",className:"csv-label"},"Select Account",Ei.default.createElement("span",{className:"csv-required"},"*")),Ei.default.createElement(En,{id:"account-select",value:t||"",onChange:l,options:[{value:"",label:"Choose an account..."},...n],disabled:a}),Ei.default.createElement("div",{className:"csv-helper-text"},"Imported trades will be added to this account"))}});var ac,cme,dme=L(()=>{ac=q(Y());vd();cme=ac.default.memo(({selectedValue:e,onSelect:t,onTemplateLoad:r,localTemplateService:n,refreshTrigger:o})=>{let[a,i]=(0,ac.useState)([]),[s,l]=(0,ac.useState)(!0);(0,ac.useEffect)(()=>{c()},[o]);let c=()=>{try{l(!0);let p=n.getTemplates();i(p)}catch(p){console.error("Failed to load templates:",p)}finally{l(!1)}};return ac.default.createElement("div",{className:"csv-broker-selector"},ac.default.createElement("label",{htmlFor:"broker-select",className:"csv-label"},"Broker / Import Format",ac.default.createElement("span",{className:"csv-required"},"*")),ac.default.createElement(En,{id:"broker-select",value:e||"",onChange:async p=>{if(!p)return;let m=p.startsWith("template-");if(m){let f=p.replace("template-",""),g=a.find(v=>v.id===f);g&&r&&r(g)}t(p,m)},options:(()=>{let p=[{value:"",label:"Select broker or template..."},{value:"IBKR",label:"Interactive Brokers (IBKR)"},{value:"TRADOVATE",label:"Tradovate"},{value:"TRADEZERO",label:"TradeZero"},{value:"TRADINGVIEW",label:"TradingView Paper Trading"}];return a.length>0&&a.forEach(m=>{p.push({value:`template-${m.id}`,label:m.name})}),p.push({value:"MANUAL",label:"+ Create New Format"}),p})(),disabled:s}),ac.default.createElement("div",{className:"csv-helper-text"},s?"Loading templates...":"Choose a supported broker or create a custom format"))})});var As,J_e,X_e,t6,ume=L(()=>{As=q(Y());er();J_e={TRADOVATE:{steps:['Navigate to "Reports" tab on Tradovate website','Click on "Orders" tab (NOT Performance tab)','Click "Download CSV" button'],warning:{emphasis:"Important:",message:"Use Orders tab only. The Performance tab is not compatible."},documentationUrl:"https://journalit.co/docs/broker-guides-tradovate",documentationLabel:"View detailed guide"},IBKR:{description:"One-time Flex Query setup required",steps:["Navigate to Performance & Statements \u2192 Reports \u2192 Flex Queries",'Create new "Trade Confirmation" query (select Orders, deselect Executions)','Set format: CSV, Date "yyyyMMdd", Time "HHmmss"',"Run query and download CSV file"],warning:{emphasis:"Must use Orders",message:"(not Executions) with specific date/time format"},documentationUrl:"https://journalit.co/docs/broker-guides-ibkr",documentationLabel:"View detailed setup guide"},TRADEZERO:{steps:["Export CSV file from TradeZero platform","Verify file is CSV format (NOT XLSX)","Import the file below"],warning:{emphasis:"Only CSV format supported.",message:"Excel (XLSX) files will not work."},documentationUrl:"https://journalit.co/docs/broker-guides-tradezero",documentationLabel:"View export instructions"},TRADINGVIEW:{description:"Paper Trading account only",steps:['Click on the "Paper Trading" broker type in TradingView','Click "Export data..." button','Select "Order History" from the dropdown'],warning:{emphasis:"Must use Order History.",message:"Other export types (such as Positions or Orders) will not work for import."},documentationUrl:"https://journalit.co/docs/broker-guides-tradingview",documentationLabel:"View detailed guide"}},X_e=({brokerType:e})=>{let t=J_e[e];return t?As.default.createElement("div",{className:"broker-guide-content"},t.description&&As.default.createElement("p",{className:"broker-guide-description"},t.description),As.default.createElement("ol",{className:"broker-guide-steps"},t.steps.map((r,n)=>As.default.createElement("li",{key:n},r))),As.default.createElement("div",{className:"broker-guide-warning"},As.default.createElement(Yp,{size:16,className:"broker-guide-warning-icon"}),As.default.createElement("span",null,t.warning.emphasis&&As.default.createElement("strong",null,t.warning.emphasis," "),t.warning.message)),As.default.createElement("a",{href:t.documentationUrl,target:"_blank",rel:"noopener noreferrer",className:"broker-guide-link"},As.default.createElement(Ef,{size:16}),t.documentationLabel,As.default.createElement(gw,{size:12}))):null},t6=(0,As.memo)(X_e);t6.displayName="BrokerGuide"});var td,r6,pme,mme=L(()=>{td=q(Y()),r6=require("obsidian"),pme=td.default.memo(({onFileSelect:e,disabled:t=!1})=>{let[r,n]=(0,td.useState)(!1),o=(0,td.useRef)(null),a=u=>{let p=u.target.files;p&&p[0]&&c(p[0])},i=u=>{if(u.preventDefault(),u.stopPropagation(),n(!1),t)return;let p=u.dataTransfer.files;p&&p[0]&&c(p[0])},s=u=>{u.preventDefault(),u.stopPropagation(),t||n(!0)},l=u=>{u.preventDefault(),u.stopPropagation(),n(!1)},c=u=>{if(!u.name.endsWith(".csv")){new r6.Notice("Please select a CSV file");return}let p=10*1024*1024;if(u.size>p){new r6.Notice("File is too large. Maximum size is 10MB");return}e(u)};return td.default.createElement("div",{className:`csv-upload-area ${r?"dragover":""} ${t?"disabled":""}`,onClick:()=>{!t&&o.current&&o.current.click()},onDrop:i,onDragOver:s,onDragLeave:l},td.default.createElement("input",{ref:o,type:"file",accept:".csv",onChange:a,style:{display:"none"},disabled:t}),td.default.createElement("div",{className:"csv-upload-icon"},"\u{1F4C4}"),td.default.createElement("div",{className:"csv-upload-text"},r?"Drop CSV file here":"Click to upload or drag and drop"),td.default.createElement("div",{className:"csv-upload-hint"},"CSV files only, max 10MB"))})});var Zi,fme,gme=L(()=>{Zi=q(Y()),fme=Zi.default.memo(({data:e,maxRows:t=10})=>{let r=e.rows.slice(0,t),n=e.rows.length>t;return Zi.default.createElement("div",{className:"csv-preview-container"},Zi.default.createElement("div",{className:"csv-preview-header"},"CSV Preview (",e.rowCount," total rows)",n&&` - Showing first ${t}`),Zi.default.createElement("div",{className:"csv-preview-table-wrapper"},Zi.default.createElement("table",{className:"csv-preview-table"},Zi.default.createElement("thead",null,Zi.default.createElement("tr",null,Zi.default.createElement("th",{style:{width:"50px"}},"#"),e.headers.map((o,a)=>Zi.default.createElement("th",{key:a},o||`Column ${a+1}`)))),Zi.default.createElement("tbody",null,r.map((o,a)=>Zi.default.createElement("tr",{key:a},Zi.default.createElement("td",{style:{color:"var(--text-muted)",fontSize:"12px"}},a+1),o.map((i,s)=>Zi.default.createElement("td",{key:s},i))))))),n&&Zi.default.createElement("div",{className:"csv-preview-footer",style:{padding:"12px",textAlign:"center",color:"var(--text-muted)",fontSize:"13px"}},"+ ",e.rowCount-t," more rows"))})});var hme,vme=L(()=>{hme=["symbol","direction","entry_time","exit_time","entry_price","exit_price","quantity","commission","profit_loss","notes","tags","asset_type","strike_price","expiration_date","option_type","contract_size","order_id","account_id","status"]});var ct,yme,bme=L(()=>{ct=q(Y());vd();vme();up();yme=({csvHeaders:e,initialMappings:t={},initialAssetType:r="stock",onMappingsChange:n,onAssetTypeChange:o,sampleRows:a=[]})=>{let[i,s]=(0,ct.useState)(()=>{let k={};return e.forEach(T=>{k[T]=t[T]||""}),k}),[l,c]=(0,ct.useState)(r);(0,ct.useEffect)(()=>{if(!t)return;let k={};e.forEach(T=>{k[T]=t[T]||""}),s(k)},[t,e]);let d=(k,T)=>{s(P=>{let D={...P,[k]:T};return n(D),D})},u=k=>{c(k),o(k)},p=k=>{let T=Object.entries(i).filter(([P,D])=>P!==k&&D!=="").map(([P,D])=>D);return[{value:"",label:"Do not import"},...hme.filter(P=>!T.includes(P)).map(P=>({value:P,label:m(P)}))]},m=k=>({symbol:"Symbol",direction:"Direction (Long/Short)",entry_time:"Entry Time",exit_time:"Exit Time",entry_price:"Entry Price",exit_price:"Exit Price",quantity:"Quantity",commission:"Commission",profit_loss:"Profit/Loss",notes:"Notes",tags:"Tags",asset_type:"Asset Type",strike_price:"Strike Price",expiration_date:"Expiration Date",option_type:"Option Type",contract_size:"Contract Size",order_id:"Order ID",account_id:"Account ID",status:"Status"})[k]||k,f={strike_price:"Required for options trades",expiration_date:"Required for options trades",option_type:"Required for options (call or put)",contract_size:"Multiplier for options (usually 100) or futures",order_id:"Used to aggregate partial fills",asset_type:"stock, options, futures, forex, crypto",status:"Trade status: OPEN or CLOSED"},g=()=>{let k=h(l),P={"Required Fields":["symbol","direction","entry_time","entry_price","quantity"],"Optional Core Fields":["exit_time","commission","profit_loss","status"],Identifiers:["order_id","account_id"],Other:["notes","tags"]};return l==="options"?P["Options Fields"]=["strike_price","expiration_date","option_type","contract_size"]:l==="futures"&&(P["Futures Fields"]=["contract_size","expiration_date"]),P},v=k=>{if(!a||a.length===0)return"";let T=e.indexOf(k);if(T===-1)return"";let P=a[0];if(!P||!P[T])return"";let D=P[T];return D.length>30?D.substring(0,30)+"...":D},h=k=>{let T=["symbol","direction","entry_time","entry_price","quantity"];switch(k){case"options":return T;case"futures":return T;case"forex":return[...T];case"crypto":return[...T];case"stock":default:return T}},y=k=>h(l).includes(k),b=()=>{let k=Object.values(i).filter(D=>D!==""),P=h(l).filter(D=>!k.includes(D));return{valid:P.length===0,missingFields:P}},x=()=>{let k=new Set(Object.values(i).filter(D=>D!=="")),T=g(),P={};return Object.entries(T).forEach(([D,O])=>{P[D]={mapped:O.filter(z=>k.has(z)),unmapped:O.filter(z=>!k.has(z))}}),P},w=b(),S=x();return ct.default.createElement("div",{className:"csv-column-mapper"},ct.default.createElement("div",{className:"csv-mapper-header"},ct.default.createElement("h3",null,"Map CSV Columns to Trade Fields"),ct.default.createElement("p",null,"Match your CSV columns to the trade fields they represent.")),ct.default.createElement("div",{className:"asset-type-selector"},ct.default.createElement("h3",null,"Asset Type ",ct.default.createElement("span",{className:"csv-required"},"*")),ct.default.createElement("p",{className:"csv-helper-text"},"Select the type of instrument in this CSV. This determines required fields and parsing logic."),ct.default.createElement("div",{className:"asset-type-buttons"},ct.default.createElement("button",{className:`asset-type-button ${l==="stock"?"active":""}`,onClick:()=>u("stock")},"Stock"),ct.default.createElement("button",{className:`asset-type-button ${l==="options"?"active":""}`,onClick:()=>u("options")},"Options"),ct.default.createElement("button",{className:`asset-type-button ${l==="futures"?"active":""}`,onClick:()=>u("futures")},"Futures"),ct.default.createElement("button",{className:`asset-type-button ${l==="forex"?"active":""}`,onClick:()=>u("forex")},"Forex"),ct.default.createElement("button",{className:`asset-type-button ${l==="crypto"?"active":""}`,onClick:()=>u("crypto")},"Crypto"))),ct.default.createElement("div",{className:"csv-message--info",style:{marginTop:"12px",padding:"10px"}},ct.default.createElement("strong",null,"Tip: Map Additional Fields"),ct.default.createElement("p",{style:{margin:"6px 0 0 0",fontSize:"0.9em"}},"Mapping optional fields like commission and profit_loss provides more complete trade data and better duplicate detection accuracy.")),!w.valid&&ct.default.createElement("div",{className:"csv-message csv-message--error",style:{marginBottom:"20px"}},ct.default.createElement("strong",null,"Missing required fields for ",l,":")," ",w.missingFields.map(k=>m(k)).join(", ")),ct.default.createElement("div",{className:"csv-mapper-grid-container"},ct.default.createElement("div",{className:"csv-mapper-grid"},e.map((k,T)=>{let P=i[k],D=y(P);return ct.default.createElement("div",{key:T,className:"csv-mapper-row"},ct.default.createElement("div",{className:"csv-mapper-source"},ct.default.createElement("div",{className:"csv-column-header"},ct.default.createElement("div",{className:"csv-column-name"},k),v(k)&&ct.default.createElement("div",{className:"csv-column-sample"},"Example: ",ct.default.createElement("span",{className:"csv-sample-value"},v(k))))),ct.default.createElement("div",{className:"csv-mapper-arrow"},"\u2192"),ct.default.createElement("div",{className:"csv-mapper-target"},ct.default.createElement(En,{value:P,onChange:O=>d(k,O),options:p(k)}),D&&ct.default.createElement("span",{className:"csv-required-badge"},"Required")))}))),ct.default.createElement("div",{className:"csv-mapper-summary",style:{marginTop:"24px",padding:"16px",background:"var(--background-secondary)",borderRadius:"6px"}},ct.default.createElement("strong",null,"Summary:")," ",Object.values(i).filter(k=>k!=="").length," of ",e.length," columns mapped",w.valid&&ct.default.createElement("span",{style:{color:"var(--text-success)",marginLeft:"12px"}},"\u2713 All required fields mapped")),ct.default.createElement("div",{style:{marginTop:"32px"}},ct.default.createElement(fr,{title:"Available Trade Fields",defaultExpanded:!1},ct.default.createElement("div",{className:"csv-mapper-fields-reference"},ct.default.createElement("p",{style:{marginBottom:"16px",color:"var(--text-muted)"}},"Organized by category with descriptions for asset-specific fields"),Object.entries(S).map(([k,{mapped:T,unmapped:P}])=>T.length===0&&P.length===0?null:ct.default.createElement("div",{key:k,className:"csv-field-category",style:{marginBottom:"20px"}},ct.default.createElement("h4",{style:{fontSize:"13px",fontWeight:"600",marginBottom:"8px",color:"var(--text-normal)"}},k),ct.default.createElement("div",{style:{paddingLeft:"12px"}},T.map(D=>ct.default.createElement("div",{key:D,className:"csv-field-item",style:{marginBottom:"6px",color:"var(--text-success)",fontSize:"12px"}},ct.default.createElement("span",{style:{marginRight:"8px"}},"\u2713"),ct.default.createElement("strong",null,m(D)),y(D)&&ct.default.createElement("span",{style:{marginLeft:"8px",padding:"2px 6px",background:"var(--interactive-accent)",color:"white",borderRadius:"3px",fontSize:"10px",fontWeight:"bold"}},"REQUIRED"),f[D]&&ct.default.createElement("span",{style:{marginLeft:"8px",color:"var(--text-muted)",fontStyle:"italic"}},"\u2014 ",f[D]))),P.map(D=>ct.default.createElement("div",{key:D,className:"csv-field-item",style:{marginBottom:"6px",color:"var(--text-muted)",fontSize:"12px"}},ct.default.createElement("span",{style:{marginRight:"8px"}},"\u25CB"),m(D),y(D)&&ct.default.createElement("span",{style:{marginLeft:"8px",padding:"2px 6px",background:"var(--text-error)",color:"white",borderRadius:"3px",fontSize:"10px",fontWeight:"bold"}},"REQUIRED"),f[D]&&ct.default.createElement("span",{style:{marginLeft:"8px",color:"var(--text-muted)",fontStyle:"italic"}},"\u2014 ",f[D]))))))))))}});var eN,xme=L(()=>{eu();eN=class{async getAIMappingSuggestions(t,r){try{let n=tt.buildUrl("/api/v1/csv/ai-analyze"),o=await tt.makeRequest(n,{method:"POST",body:JSON.stringify({headers:t,sample_rows:r})},"ai-analyze-csv");if(!(o!=null&&o.suggested_mappings))return console.log("[AI Mapping] No suggested_mappings in response"),{};let a={};for(let[i,s]of Object.entries(o.suggested_mappings))s&&s.trade_field&&(a[i]=s.trade_field);return console.log("[AI Mapping] Extracted from backend:",a),a}catch(n){throw console.error("AI mapping failed:",n),new Error("AI mapping unavailable")}}}});var da,tN,wme,kme=L(()=>{da=q(Y()),tN=require("obsidian");xme();wme=({csvHeaders:e,sampleRows:t,onMappingsSuggested:r,disabled:n=!1})=>{let[o,a]=(0,da.useState)(!1),[i,s]=(0,da.useState)(""),[l,c]=(0,da.useState)(""),d=new eN;return da.default.createElement("div",{className:"csv-ai-map-section"},da.default.createElement("div",{className:"csv-ai-map-header"},da.default.createElement("h4",null,"Need Help?"),da.default.createElement("p",null,"AI can analyze your CSV and suggest field mappings (optional)")),da.default.createElement("button",{type:"button",className:"csv-button csv-button-secondary csv-ai-button",onClick:async()=>{a(!0),s("Analyzing CSV structure"),c("");let p=setInterval(()=>{c(v=>v==="..."?"":v+".")},500),m=setTimeout(()=>s("Consulting AI for column mappings"),5e3),f=setTimeout(()=>s("Processing AI suggestions"),1e4),g=setTimeout(()=>s("Taking longer than usual, still working"),2e4);try{let v=t.slice(0,5),h=await d.getAIMappingSuggestions(e,v);if(console.log("[AI Mapping] Final extracted mappings:",h,"Count:",Object.keys(h).length),!(Object.keys(h).length>0&&Object.values(h).some(b=>b&&b.trim()!==""))){new tN.Notice("AI could not suggest mappings. Please map manually.");return}r(h),new tN.Notice(`AI suggested mappings for ${Object.keys(h).length} columns`)}catch(v){console.warn("AI mapping failed (backend may be offline):",v),new tN.Notice("AI mapping unavailable. Please map columns manually or use a saved template.")}finally{clearInterval(p),clearTimeout(m),clearTimeout(f),clearTimeout(g),a(!1),s(""),c("")}},disabled:n||o,title:"Uses AI to suggest column mappings. Requires backend connection."},o?da.default.createElement(da.default.Fragment,null,da.default.createElement("div",{className:"csv-spinner-small"}),da.default.createElement("span",null,i,l)):da.default.createElement(da.default.Fragment,null,da.default.createElement("span",null,"\u2728"),da.default.createElement("span",null,"Suggest Mappings with AI"))),da.default.createElement("div",{className:"csv-helper-text"},"AI suggestions should be verified before importing \u2014 always review mappings for accuracy."))}});var Sh,Za,Sme,rN,Q_e,Tme=L(()=>{Sh=require("obsidian"),Za=q(Y()),Sme=q(wn()),rN=class extends Sh.Modal{constructor(r){super(r.app);this.root=null;this.mounted=!0;this.props=r}onOpen(){let{contentEl:r}=this;r.empty(),this.container=r.createDiv({cls:"csv-modal-container"}),this.root=(0,Sme.createRoot)(this.container),this.root.render(Za.default.createElement(Q_e,{...this.props,onClose:()=>this.close(),isMounted:()=>this.mounted}))}onClose(){this.mounted=!1,this.root&&this.root.unmount(),this.props.onCancel()}},Q_e=({columnMappings:e,assetType:t,onSave:r,onClose:n,localTemplateService:o,isMounted:a})=>{let[i,s]=(0,Za.useState)(""),[l,c]=(0,Za.useState)(!1);return Za.default.createElement(Za.default.Fragment,null,Za.default.createElement("h3",null,"Save Import Template"),Za.default.createElement("p",null,"Save these column mappings as a reusable template for future imports."),Za.default.createElement("div",{className:"csv-dialog-body"},Za.default.createElement("div",{className:"csv-dialog-form-container"},Za.default.createElement("label",{htmlFor:"template-name",className:"csv-dialog-label"},"Template Name"),Za.default.createElement("input",{id:"template-name",type:"text",value:i,onChange:u=>s(u.target.value),placeholder:"e.g., My Broker Format",autoFocus:!0,disabled:l,className:"csv-dialog-input"})),Za.default.createElement("div",{className:"csv-dialog-helper-text"},"This template will appear in the broker dropdown for future imports.")),Za.default.createElement("div",{className:"csv-dialog-actions"},Za.default.createElement("button",{type:"button",className:"csv-button csv-button-primary",onClick:async()=>{let u=i.trim();if(!u){new Sh.Notice("Please enter a template name");return}if(o.templateNameExists(u)){new Sh.Notice("Template name already exists");return}c(!0);try{let p=await o.createTemplate({name:u,broker_type:"MANUAL",asset_type:t,column_mappings:e,has_headers:!0});new Sh.Notice(`Template "${u}" saved successfully`),r(p.id,p.name),n()}catch(p){console.error("Failed to save template:",p),new Sh.Notice("Failed to save template: "+(p instanceof Error?p.message:"Unknown error"))}finally{a()&&c(!1)}},disabled:l||!i.trim()},l?"Saving...":"Save Template"),Za.default.createElement("button",{type:"button",className:"csv-button csv-button-secondary",onClick:n,disabled:l},"Cancel")))}});function Z_e(e){let t=new TextEncoder().encode(e),r="";for(let n=0;n<t.length;n++)r+=String.fromCharCode(t[n]);return btoa(r)}function eBe(e){let t=atob(e),r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return new TextDecoder().decode(r)}function nN(e){let t={name:e.name,broker_type:e.broker_type,asset_type:e.asset_type,column_mappings:e.column_mappings,date_format:e.date_format,delimiter:e.delimiter,has_headers:e.has_headers},r=JSON.stringify(t);return`JTT-v1-${Z_e(r)}`}function n6(e){if(!e.startsWith("JTT-"))throw new Error("Invalid template code: Must start with JTT-");if(e.length>tBe)throw new Error("Template code too large (possible corruption)");let t=e.split("-");if(t.length!==3)throw new Error("Invalid template code: Incorrect format");let[r,n,o]=t;if(n!=="v1")throw new Error(`Unsupported template version: ${n}. Please update your plugin.`);let a;try{a=eBe(o)}catch(l){throw new Error("Invalid template code: Base64 decoding failed")}let i;try{i=JSON.parse(a)}catch(l){throw new Error("Invalid template code: JSON parsing failed")}if(!i.name||!i.broker_type||!i.column_mappings)throw new Error("Invalid template code: Missing required fields");if(typeof i.name!="string"||i.name.trim()==="")throw new Error("Invalid template code: Invalid name field");if(typeof i.broker_type!="string")throw new Error("Invalid template code: Invalid broker_type field");let s=["stock","options","futures","forex","crypto"];if((!i.asset_type||!s.includes(i.asset_type))&&(i.asset_type="stock"),typeof i.column_mappings!="object"||Array.isArray(i.column_mappings))throw new Error("Invalid template code: Invalid column_mappings field");if(Object.keys(i.column_mappings).length===0)throw new Error("Invalid template code: column_mappings cannot be empty");if(typeof i.has_headers!="boolean")throw new Error("Invalid template code: Invalid has_headers field");return{id:Vb(),name:i.name,broker_type:i.broker_type,asset_type:i.asset_type,column_mappings:i.column_mappings,date_format:i.date_format,delimiter:i.delimiter,has_headers:i.has_headers,created_at:new Date().toISOString(),last_used:void 0,usage_count:0}}function Cme(e){try{return n6(e),{valid:!0}}catch(t){return{valid:!1,error:t instanceof Error?t.message:"Unknown error"}}}var tBe,oN=L(()=>{bL();tBe=1e4});var Pme,ua,Dme,aN,rBe,Eme=L(()=>{Pme=require("obsidian"),ua=q(Y()),Dme=q(wn());oN();aN=class extends Pme.Modal{constructor(t){super(t.app),this.props=t}onOpen(){let{contentEl:t}=this;t.empty(),this.container=t.createDiv({cls:"csv-modal-container"}),this.root=(0,Dme.createRoot)(this.container),this.root.render(ua.default.createElement(rBe,{...this.props,onClose:()=>this.close()}))}onClose(){this.root&&this.root.unmount(),this.props.onClose()}},rBe=({template:e,onClose:t})=>{let[r,n]=(0,ua.useState)(!1),o=(0,ua.useRef)(null),a=nN(e);(0,ua.useEffect)(()=>()=>{o.current&&clearTimeout(o.current)},[]);let i=async()=>{try{await navigator.clipboard.writeText(a),n(!0),o.current=setTimeout(()=>n(!1),2e3)}catch(s){console.error("Failed to copy share code:",s)}};return ua.default.createElement(ua.default.Fragment,null,ua.default.createElement("h3",null,"Export Template: ",e.name),ua.default.createElement("p",{className:"csv-dialog-description"},"Share this code with others to let them use your template configuration."),ua.default.createElement("div",{className:"csv-export-code-container"},ua.default.createElement("label",{className:"csv-label"},"Share Code"),ua.default.createElement("div",{className:"csv-export-code-preview"},a.substring(0,60),"..."),ua.default.createElement("div",{className:"csv-helper-text"},"Full code copied to clipboard when you click the button below")),ua.default.createElement("div",{className:"csv-dialog-actions"},ua.default.createElement("button",{className:"csv-button csv-button-primary",onClick:i},r?"Copied!":"Copy to Clipboard"),ua.default.createElement("button",{className:"csv-button csv-button-secondary",onClick:t},"Close")))}});var Ime,Ma,Ame,iN,nBe,Lme=L(()=>{Ime=require("obsidian"),Ma=q(Y()),Ame=q(wn());oN();iN=class extends Ime.Modal{constructor(t){super(t.app),this.props=t}onOpen(){let{contentEl:t}=this;t.empty(),this.container=t.createDiv({cls:"csv-modal-container"}),this.root=(0,Ame.createRoot)(this.container),this.root.render(Ma.default.createElement(nBe,{...this.props,onClose:()=>this.close()}))}onClose(){this.root&&this.root.unmount(),this.props.onClose()}},nBe=({localTemplateService:e,onClose:t,onImportSuccess:r})=>{let[n,o]=(0,Ma.useState)(""),[a,i]=(0,Ma.useState)(),[s,l]=(0,Ma.useState)(!1),c=async()=>{i(void 0);let u=Cme(n.trim());if(!u.valid){i(u.error);return}try{l(!0);let p=await e.importTemplate(n.trim());r==null||r(p.name),t()}catch(p){i(p instanceof Error?p.message:"Failed to import template")}finally{l(!1)}};return Ma.default.createElement(Ma.default.Fragment,null,Ma.default.createElement("h3",null,"Import Template"),Ma.default.createElement("p",{className:"csv-dialog-description"},"Paste a template share code (JTT-v1-...) to import it into your vault."),Ma.default.createElement("div",{className:"csv-dialog-form-container"},Ma.default.createElement("label",{htmlFor:"share-code-input",className:"csv-dialog-label"},"Share Code"),Ma.default.createElement("input",{id:"share-code-input",type:"text",value:n,onChange:u=>o(u.target.value),onKeyDown:u=>{u.key==="Enter"&&n.trim()&&c()},placeholder:"JTT-v1-...",autoFocus:!0,disabled:s,className:a?"csv-dialog-input csv-dialog-input-error":"csv-dialog-input"}),a&&Ma.default.createElement("div",{className:"csv-dialog-error-message"},a),Ma.default.createElement("div",{className:"csv-dialog-helper-text"},"Template will be added to your local templates")),Ma.default.createElement("div",{className:"csv-dialog-actions"},Ma.default.createElement("button",{className:"csv-button csv-button-primary",onClick:c,disabled:!n.trim()||s},s?"Importing...":"Import Template"),Ma.default.createElement("button",{className:"csv-button csv-button-secondary",onClick:t,disabled:s},"Cancel")))}});var Nme,rd,Mme,sN,oBe,Fme=L(()=>{Nme=require("obsidian"),rd=q(Y()),Mme=q(wn()),sN=class extends Nme.Modal{constructor(t){super(t.app),this.props=t}onOpen(){let{contentEl:t}=this;t.empty(),this.container=t.createDiv({cls:"csv-modal-container"}),this.root=(0,Mme.createRoot)(this.container),this.root.render(rd.default.createElement(oBe,{...this.props,onClose:()=>this.close()}))}onClose(){this.root&&this.root.unmount(),this.props.onCancel()}},oBe=({template:e,onConfirm:t,onClose:r})=>{let[n,o]=(0,rd.useState)(!1),a=async()=>{o(!0);try{await t(),r()}catch(i){o(!1)}};return rd.default.createElement(rd.default.Fragment,null,rd.default.createElement("h3",null,"Delete Template?"),rd.default.createElement("p",{className:"csv-dialog-description"},'Are you sure you want to delete "',e.name,'"? This action cannot be undone.'),rd.default.createElement("div",{className:"csv-dialog-actions"},rd.default.createElement("button",{className:"csv-button csv-button-primary",onClick:a,disabled:n,style:{backgroundColor:"var(--text-error)"}},n?"Deleting...":"Delete Template"),rd.default.createElement("button",{className:"csv-button csv-button-secondary",onClick:r,disabled:n},"Cancel")))}});var Ome,Vn,jme,lN,aBe,zme=L(()=>{Ome=require("obsidian"),Vn=q(Y()),jme=q(wn()),lN=class extends Ome.Modal{constructor(t){super(t.app),this.props=t}onOpen(){let{contentEl:t}=this;t.empty(),this.container=t.createDiv({cls:"csv-modal-container"}),this.root=(0,jme.createRoot)(this.container),this.root.render(Vn.default.createElement(aBe,{...this.props,onClose:()=>this.close()}))}onClose(){this.root&&this.root.unmount(),this.props.onClose()}},aBe=({onClose:e,onProceed:t,missingFields:r})=>{let{tradesCount:n,missingStrike:o,missingExpiry:a,missingOptionType:i}=r,s=()=>{t(),e()};return Vn.default.createElement(Vn.default.Fragment,null,Vn.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"12px"}},Vn.default.createElement("span",{style:{fontSize:"24px",color:"var(--text-warning)"}},"\u26A0"),Vn.default.createElement("h3",{style:{margin:0}},"Incomplete Options Data Detected")),Vn.default.createElement("p",{style:{marginBottom:"16px"}},n===1?"An options trade is missing required metadata:":`${n} options trades are missing required metadata:`),Vn.default.createElement("ul",{style:{marginBottom:"20px",paddingLeft:"24px",color:"var(--text-normal)",fontSize:"14px",lineHeight:"1.8"}},o>0&&Vn.default.createElement("li",null,Vn.default.createElement("strong",null,o)," ",o===1?"trade":"trades"," missing strike price"),a>0&&Vn.default.createElement("li",null,Vn.default.createElement("strong",null,a)," ",a===1?"trade":"trades"," missing expiration date"),i>0&&Vn.default.createElement("li",null,Vn.default.createElement("strong",null,i)," ",i===1?"trade":"trades"," missing option type (call/put)")),Vn.default.createElement("div",{style:{padding:"12px 16px",background:"rgba(255, 152, 0, 0.1)",border:"1px solid rgba(255, 152, 0, 0.3)",borderRadius:"6px",marginBottom:"20px"}},Vn.default.createElement("p",{style:{margin:0,fontSize:"13px",color:"var(--text-muted)",lineHeight:"1.6"}},"These trades will be imported without complete options data, which may affect:"),Vn.default.createElement("ul",{style:{margin:"8px 0 0 0",paddingLeft:"20px",fontSize:"13px",color:"var(--text-muted)",lineHeight:"1.6"}},Vn.default.createElement("li",null,"Analytics and filtering"),Vn.default.createElement("li",null,"P&L calculations"),Vn.default.createElement("li",null,"Trade journal accuracy"))),Vn.default.createElement("div",{className:"csv-dialog-actions"},Vn.default.createElement("button",{className:"csv-button csv-button-primary",onClick:s,style:{backgroundColor:"var(--text-warning)"}},"Import Anyway"),Vn.default.createElement("button",{className:"csv-button csv-button-secondary",onClick:e},"Cancel Import")))}});var ox,ax,o6=L(()=>{ox={ES:{dollarPerPoint:50,tickSize:.25,tickValue:12.5,name:"E-Mini S&P 500",exchange:"CME"},MES:{dollarPerPoint:5,tickSize:.25,tickValue:1.25,name:"Micro E-Mini S&P 500",exchange:"CME"},NQ:{dollarPerPoint:20,tickSize:.25,tickValue:5,name:"E-Mini NASDAQ-100",exchange:"CME"},MNQ:{dollarPerPoint:2,tickSize:.25,tickValue:.5,name:"Micro E-Mini NASDAQ-100",exchange:"CME"},YM:{dollarPerPoint:5,tickSize:1,tickValue:5,name:"E-Mini Dow",exchange:"CBOT"},MYM:{dollarPerPoint:.5,tickSize:1,tickValue:.5,name:"Micro E-Mini Dow",exchange:"CBOT"},RTY:{dollarPerPoint:50,tickSize:.1,tickValue:5,name:"E-Mini Russell 2000",exchange:"CME"},M2K:{dollarPerPoint:5,tickSize:.1,tickValue:.5,name:"Micro E-Mini Russell 2000",exchange:"CME"},CL:{dollarPerPoint:1e3,tickSize:.01,tickValue:10,name:"Crude Oil",exchange:"NYMEX"},MCL:{dollarPerPoint:100,tickSize:.01,tickValue:1,name:"Micro Crude Oil",exchange:"NYMEX"},NG:{dollarPerPoint:1e4,tickSize:.001,tickValue:10,name:"Natural Gas",exchange:"NYMEX"},RB:{dollarPerPoint:42e3,tickSize:1e-4,tickValue:4.2,name:"RBOB Gasoline",exchange:"NYMEX"},HO:{dollarPerPoint:42e3,tickSize:1e-4,tickValue:4.2,name:"Heating Oil",exchange:"NYMEX"},GC:{dollarPerPoint:100,tickSize:.1,tickValue:10,name:"Gold",exchange:"COMEX"},MGC:{dollarPerPoint:10,tickSize:.1,tickValue:1,name:"Micro Gold",exchange:"COMEX"},SI:{dollarPerPoint:5e3,tickSize:.005,tickValue:25,name:"Silver",exchange:"COMEX"},HG:{dollarPerPoint:25e3,tickSize:5e-4,tickValue:12.5,name:"Copper",exchange:"COMEX"},PL:{dollarPerPoint:50,tickSize:.1,tickValue:5,name:"Platinum",exchange:"NYMEX"},ZC:{dollarPerPoint:50,tickSize:.25,tickValue:12.5,name:"Corn",exchange:"CBOT"},ZS:{dollarPerPoint:50,tickSize:.25,tickValue:12.5,name:"Soybeans",exchange:"CBOT"},ZW:{dollarPerPoint:50,tickSize:.25,tickValue:12.5,name:"Wheat",exchange:"CBOT"},"6E":{dollarPerPoint:12.5,tickSize:5e-5,tickValue:6.25,name:"Euro FX",exchange:"CME"},M6E:{dollarPerPoint:1.25,tickSize:5e-5,tickValue:.625,name:"Micro Euro FX",exchange:"CME"},"6B":{dollarPerPoint:6.25,tickSize:1e-4,tickValue:6.25,name:"British Pound",exchange:"CME"},M6B:{dollarPerPoint:.625,tickSize:1e-4,tickValue:.625,name:"Micro British Pound",exchange:"CME"},"6J":{dollarPerPoint:12.5,tickSize:5e-7,tickValue:6.25,name:"Japanese Yen",exchange:"CME"},M6J:{dollarPerPoint:1.25,tickSize:5e-7,tickValue:.625,name:"Micro Japanese Yen",exchange:"CME"},"6A":{dollarPerPoint:10,tickSize:1e-4,tickValue:10,name:"Australian Dollar",exchange:"CME"},M6A:{dollarPerPoint:1,tickSize:1e-4,tickValue:1,name:"Micro Australian Dollar",exchange:"CME"},"6C":{dollarPerPoint:10,tickSize:5e-5,tickValue:5,name:"Canadian Dollar",exchange:"CME"},M6C:{dollarPerPoint:1,tickSize:5e-5,tickValue:.5,name:"Micro Canadian Dollar",exchange:"CME"},"6S":{dollarPerPoint:12.5,tickSize:1e-4,tickValue:12.5,name:"Swiss Franc",exchange:"CME"},M6S:{dollarPerPoint:1.25,tickSize:1e-4,tickValue:1.25,name:"Micro Swiss Franc",exchange:"CME"},ZN:{dollarPerPoint:1e3,tickSize:.015625,tickValue:15.625,name:"10-Year T-Note",exchange:"CBOT"},ZB:{dollarPerPoint:1e3,tickSize:.03125,tickValue:31.25,name:"30-Year T-Bond",exchange:"CBOT"},ZF:{dollarPerPoint:1e3,tickSize:.0078125,tickValue:7.8125,name:"5-Year T-Note",exchange:"CBOT"}},ax={EURUSD:{lotSize:1e5,pipValue:10,pipSize:1e-4,name:"Euro / US Dollar"},GBPUSD:{lotSize:1e5,pipValue:10,pipSize:1e-4,name:"British Pound / US Dollar"},USDJPY:{lotSize:1e5,pipValue:9.09,pipSize:.01,name:"US Dollar / Japanese Yen"},USDCHF:{lotSize:1e5,pipValue:11,pipSize:1e-4,name:"US Dollar / Swiss Franc"},AUDUSD:{lotSize:1e5,pipValue:10,pipSize:1e-4,name:"Australian Dollar / US Dollar"},USDCAD:{lotSize:1e5,pipValue:7.5,pipSize:1e-4,name:"US Dollar / Canadian Dollar"},NZDUSD:{lotSize:1e5,pipValue:10,pipSize:1e-4,name:"New Zealand Dollar / US Dollar"},EURGBP:{lotSize:1e5,pipValue:13,pipSize:1e-4,name:"Euro / British Pound"},EURJPY:{lotSize:1e5,pipValue:9.09,pipSize:.01,name:"Euro / Japanese Yen"},GBPJPY:{lotSize:1e5,pipValue:9.09,pipSize:.01,name:"British Pound / Japanese Yen"},XAUUSD:{lotSize:100,pipValue:10,pipSize:.01,name:"Gold / US Dollar"}}});var RS,sn,_me,cN,iBe,Bme=L(()=>{RS=require("obsidian"),sn=q(Y()),_me=q(wn());o6();Ra();cN=class extends RS.Modal{constructor(r){super(r.app);this.container=null;this.root=null;this.props=r}onOpen(){let{contentEl:r}=this;r.empty(),this.container=r.createDiv({cls:"csv-modal-container"}),this.root=(0,_me.createRoot)(this.container),this.root.render(sn.default.createElement(iBe,{...this.props,onClose:()=>this.close()}))}onClose(){this.root&&(this.root.unmount(),this.root=null),this.container=null}},iBe=({plugin:e,symbols:t,specService:r,onMappingsCreated:n,onSkip:o,onClose:a})=>{let[i,s]=(0,sn.useState)(t.reduce((h,y)=>({...h,[y.symbol]:""}),{})),[l,c]=(0,sn.useState)({}),[d,u]=(0,sn.useState)(!1),p=()=>{var y;return(((y=e.settings.customOptions)==null?void 0:y.instrument)||[]).map(b=>b.name.toUpperCase())},m=(h,y,b)=>{if(!y.trim())return null;let x=y.trim().toUpperCase();return(b==="futures"?ox:b==="forex"?ax:{})[x]||p().includes(x)?null:`Symbol "${x}" not found in ${b} specs or custom tickers`},f=(h,y,b)=>{s(w=>({...w,[h]:y}));let x=m(h,y,b);c(w=>{if(x)return{...w,[h]:x};{let S={...w};return delete S[h],S}})},g=async()=>{u(!0);try{let h=0,y={};for(let b of t){let x=i[b.symbol];if(x.trim()){let w=m(b.symbol,x,b.assetType);w&&(y[b.symbol]=w)}}if(Object.keys(y).length>0){c(y),new RS.Notice("Please fix validation errors before saving"),u(!1);return}for(let b of t){let x=i[b.symbol];x.trim()&&await r.saveMapping(b.symbol,x.trim(),!1)&&h++}n(h),a()}catch(h){console.error("Failed to save mappings:",h),new RS.Notice("Failed to save mappings")}finally{u(!1)}},v=()=>{o(),a()};return sn.default.createElement(sn.default.Fragment,null,sn.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"12px"}},sn.default.createElement("span",{style:{fontSize:"24px",color:"var(--text-warning)"}},"\u26A0"),sn.default.createElement("h3",{style:{margin:0}},"Unmapped Symbols Detected")),sn.default.createElement("p",{style:{marginBottom:"16px"}},t.length===1?"A symbol without instrument specifications was found in your import:":`${t.length} symbols without instrument specifications were found in your import:`),sn.default.createElement("div",{style:{maxHeight:"300px",overflowY:"auto",marginBottom:"20px",border:"1px solid var(--background-modifier-border)",borderRadius:"6px",padding:"12px"}},t.map(h=>{let y=l[h.symbol];return sn.default.createElement("div",{key:`${h.symbol}-${h.assetType}`,style:{marginBottom:"16px",paddingBottom:"16px",borderBottom:"1px solid var(--background-modifier-border-hover)"}},sn.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"8px"}},sn.default.createElement("div",{style:{flex:"0 0 auto",minWidth:"180px",maxWidth:"180px",overflow:"hidden"}},sn.default.createElement("strong",{style:{display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:h.symbol},h.symbol)),sn.default.createElement("span",{style:{flex:"0 0 auto"}},"\u2192"),sn.default.createElement("div",{style:{flex:"0 0 auto"}},sn.default.createElement("label",{htmlFor:`mapping-input-${h.symbol}`,style:{display:"block",fontSize:"11px",color:"var(--text-muted)",marginBottom:"4px"}},"Map to base symbol/ticker:"),sn.default.createElement("input",{id:`mapping-input-${h.symbol}`,type:"text",value:i[h.symbol]||"",onChange:b=>f(h.symbol,b.target.value,h.assetType),placeholder:"e.g., ES, NQ, GC",style:{width:"140px",padding:"6px 10px",borderRadius:"4px",border:y?"1px solid var(--text-error)":"1px solid var(--background-modifier-border)",background:"var(--background-primary)",color:"var(--text-normal)",fontSize:"13px"},disabled:d}))),y&&sn.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-error)",marginLeft:"152px"}},y))})),sn.default.createElement("div",{style:{padding:"12px 16px",background:"rgba(255, 152, 0, 0.1)",border:"1px solid rgba(255, 152, 0, 0.3)",borderRadius:"6px",marginBottom:"20px"}},sn.default.createElement("p",{style:{margin:0,fontSize:"13px",color:"var(--text-muted)",lineHeight:"1.6"}},"Map these symbols to built-in specs or your custom tickers. Without specifications, trades will not have accurate tick sizes, dollar per point, or P&L calculations.")),sn.default.createElement("div",{className:"csv-dialog-actions"},sn.default.createElement("button",{className:"csv-button csv-button-primary",onClick:g,disabled:d||Object.keys(l).length>0,style:{opacity:d||Object.keys(l).length>0?.5:1,cursor:d||Object.keys(l).length>0?"not-allowed":"pointer"}},d?"Saving...":"Save Mappings"),sn.default.createElement("button",{className:"csv-button csv-button-secondary",onClick:v,disabled:d},"Skip")))}});var $me=Ie((a6,i6)=>{((e,t)=>{typeof define=="function"&&define.amd?define([],t):typeof i6=="object"&&typeof a6!="undefined"?i6.exports=t():e.Papa=t()})(a6,function e(){var t=typeof self!="undefined"?self:typeof window!="undefined"?window:t!==void 0?t:{},r,n=!t.document&&!!t.postMessage,o=t.IS_PAPA_WORKER||!1,a={},i=0,s={};function l(S){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(k){var T=b(k);T.chunkSize=parseInt(T.chunkSize),k.step||k.chunk||(T.chunkSize=null),this._handle=new m(T),(this._handle.streamer=this)._config=T}.call(this,S),this.parseChunk=function(k,T){var P=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<P){let O=this._config.newline;O||(D=this._config.quoteChar||'"',O=this._handle.guessLineEndings(k,D)),k=[...k.split(O).slice(P)].join(O)}this.isFirstChunk&&w(this._config.beforeFirstChunk)&&(D=this._config.beforeFirstChunk(k))!==void 0&&(k=D),this.isFirstChunk=!1,this._halted=!1;var P=this._partialLine+k,D=(this._partialLine="",this._handle.parse(P,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(k=D.meta.cursor,P=(this._finished||(this._partialLine=P.substring(k-this._baseIndex),this._baseIndex=k),D&&D.data&&(this._rowCount+=D.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),o)t.postMessage({results:D,workerId:s.WORKER_ID,finished:P});else if(w(this._config.chunk)&&!T){if(this._config.chunk(D,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=D=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(D.data),this._completeResults.errors=this._completeResults.errors.concat(D.errors),this._completeResults.meta=D.meta),this._completed||!P||!w(this._config.complete)||D&&D.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),P||D&&D.meta.paused||this._nextChunk(),D}this._halted=!0},this._sendError=function(k){w(this._config.error)?this._config.error(k):o&&this._config.error&&t.postMessage({workerId:s.WORKER_ID,error:k,finished:!1})}}function c(S){var k;(S=S||{}).chunkSize||(S.chunkSize=s.RemoteChunkSize),l.call(this,S),this._nextChunk=n?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(T){this._input=T,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(k=new XMLHttpRequest,this._config.withCredentials&&(k.withCredentials=this._config.withCredentials),n||(k.onload=x(this._chunkLoaded,this),k.onerror=x(this._chunkError,this)),k.open(this._config.downloadRequestBody?"POST":"GET",this._input,!n),this._config.downloadRequestHeaders){var T,P=this._config.downloadRequestHeaders;for(T in P)k.setRequestHeader(T,P[T])}var D;this._config.chunkSize&&(D=this._start+this._config.chunkSize-1,k.setRequestHeader("Range","bytes="+this._start+"-"+D));try{k.send(this._config.downloadRequestBody)}catch(O){this._chunkError(O.message)}n&&k.status===0&&this._chunkError()}},this._chunkLoaded=function(){k.readyState===4&&(k.status<200||400<=k.status?this._chunkError():(this._start+=this._config.chunkSize||k.responseText.length,this._finished=!this._config.chunkSize||this._start>=(T=>(T=T.getResponseHeader("Content-Range"))!==null?parseInt(T.substring(T.lastIndexOf("/")+1)):-1)(k),this.parseChunk(k.responseText)))},this._chunkError=function(T){T=k.statusText||T,this._sendError(new Error(T))}}function d(S){(S=S||{}).chunkSize||(S.chunkSize=s.LocalChunkSize),l.call(this,S);var k,T,P=typeof FileReader!="undefined";this.stream=function(D){this._input=D,T=D.slice||D.webkitSlice||D.mozSlice,P?((k=new FileReader).onload=x(this._chunkLoaded,this),k.onerror=x(this._chunkError,this)):k=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var D=this._input,O=(this._config.chunkSize&&(O=Math.min(this._start+this._config.chunkSize,this._input.size),D=T.call(D,this._start,O)),k.readAsText(D,this._config.encoding));P||this._chunkLoaded({target:{result:O}})},this._chunkLoaded=function(D){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(D.target.result)},this._chunkError=function(){this._sendError(k.error)}}function u(S){var k;l.call(this,S=S||{}),this.stream=function(T){return k=T,this._nextChunk()},this._nextChunk=function(){var T,P;if(!this._finished)return T=this._config.chunkSize,k=T?(P=k.substring(0,T),k.substring(T)):(P=k,""),this._finished=!k,this.parseChunk(P)}}function p(S){l.call(this,S=S||{});var k=[],T=!0,P=!1;this.pause=function(){l.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){l.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(D){this._input=D,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){P&&k.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),k.length?this.parseChunk(k.shift()):T=!0},this._streamData=x(function(D){try{k.push(typeof D=="string"?D:D.toString(this._config.encoding)),T&&(T=!1,this._checkIsFinished(),this.parseChunk(k.shift()))}catch(O){this._streamError(O)}},this),this._streamError=x(function(D){this._streamCleanUp(),this._sendError(D)},this),this._streamEnd=x(function(){this._streamCleanUp(),P=!0,this._streamData("")},this),this._streamCleanUp=x(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function m(S){var k,T,P,D,O=Math.pow(2,53),z=-O,I=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,A=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,j=this,E=0,N=0,B=!1,C=!1,F=[],M={data:[],errors:[],meta:{}};function _(R){return S.skipEmptyLines==="greedy"?R.join("").trim()==="":R.length===1&&R[0].length===0}function W(){if(M&&P&&(H("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+s.DefaultDelimiter+"'"),P=!1),S.skipEmptyLines&&(M.data=M.data.filter(function(X){return!_(X)})),$()){let X=function(G,U){w(S.transformHeader)&&(G=S.transformHeader(G,U)),F.push(G)};var K=X;if(M)if(Array.isArray(M.data[0])){for(var R=0;$()&&R<M.data.length;R++)M.data[R].forEach(X);M.data.splice(0,1)}else M.data.forEach(X)}function V(X,G){for(var U=S.header?{}:[],Q=0;Q<X.length;Q++){var J=Q,ee=X[Q],ee=((te,ue)=>(be=>(S.dynamicTypingFunction&&S.dynamicTyping[be]===void 0&&(S.dynamicTyping[be]=S.dynamicTypingFunction(be)),(S.dynamicTyping[be]||S.dynamicTyping)===!0))(te)?ue==="true"||ue==="TRUE"||ue!=="false"&&ue!=="FALSE"&&((be=>{if(I.test(be)&&(be=parseFloat(be),z<be&&be<O))return 1})(ue)?parseFloat(ue):A.test(ue)?new Date(ue):ue===""?null:ue):ue)(J=S.header?Q>=F.length?"__parsed_extra":F[Q]:J,ee=S.transform?S.transform(ee,J):ee);J==="__parsed_extra"?(U[J]=U[J]||[],U[J].push(ee)):U[J]=ee}return S.header&&(Q>F.length?H("FieldMismatch","TooManyFields","Too many fields: expected "+F.length+" fields but parsed "+Q,N+G):Q<F.length&&H("FieldMismatch","TooFewFields","Too few fields: expected "+F.length+" fields but parsed "+Q,N+G)),U}var Z;M&&(S.header||S.dynamicTyping||S.transform)&&(Z=1,!M.data.length||Array.isArray(M.data[0])?(M.data=M.data.map(V),Z=M.data.length):M.data=V(M.data,0),S.header&&M.meta&&(M.meta.fields=F),N+=Z)}function $(){return S.header&&F.length===0}function H(R,V,Z,K){R={type:R,code:V,message:Z},K!==void 0&&(R.row=K),M.errors.push(R)}w(S.step)&&(D=S.step,S.step=function(R){M=R,$()?W():(W(),M.data.length!==0&&(E+=R.data.length,S.preview&&E>S.preview?T.abort():(M.data=M.data[0],D(M,j))))}),this.parse=function(R,V,Z){var K=S.quoteChar||'"',K=(S.newline||(S.newline=this.guessLineEndings(R,K)),P=!1,S.delimiter?w(S.delimiter)&&(S.delimiter=S.delimiter(R),M.meta.delimiter=S.delimiter):((K=((X,G,U,Q,J)=>{var ee,te,ue,be;J=J||[",","	","|",";",s.RECORD_SEP,s.UNIT_SEP];for(var Le=0;Le<J.length;Le++){for(var $e,oe=J[Le],ge=0,Se=0,De=0,se=(ue=void 0,new g({comments:Q,delimiter:oe,newline:G,preview:10}).parse(X)),Fe=0;Fe<se.data.length;Fe++)U&&_(se.data[Fe])?De++:($e=se.data[Fe].length,Se+=$e,ue===void 0?ue=$e:0<$e&&(ge+=Math.abs($e-ue),ue=$e));0<se.data.length&&(Se/=se.data.length-De),(te===void 0||ge<=te)&&(be===void 0||be<Se)&&1.99<Se&&(te=ge,ee=oe,be=Se)}return{successful:!!(S.delimiter=ee),bestDelimiter:ee}})(R,S.newline,S.skipEmptyLines,S.comments,S.delimitersToGuess)).successful?S.delimiter=K.bestDelimiter:(P=!0,S.delimiter=s.DefaultDelimiter),M.meta.delimiter=S.delimiter),b(S));return S.preview&&S.header&&K.preview++,k=R,T=new g(K),M=T.parse(k,V,Z),W(),B?{meta:{paused:!0}}:M||{meta:{paused:!1}}},this.paused=function(){return B},this.pause=function(){B=!0,T.abort(),k=w(S.chunk)?"":k.substring(T.getCharIndex())},this.resume=function(){j.streamer._halted?(B=!1,j.streamer.parseChunk(k,!0)):setTimeout(j.resume,3)},this.aborted=function(){return C},this.abort=function(){C=!0,T.abort(),M.meta.aborted=!0,w(S.complete)&&S.complete(M),k=""},this.guessLineEndings=function(X,K){X=X.substring(0,1048576);var K=new RegExp(f(K)+"([^]*?)"+f(K),"gm"),Z=(X=X.replace(K,"")).split("\r"),K=X.split(`
`),X=1<K.length&&K[0].length<Z[0].length;if(Z.length===1||X)return`
`;for(var G=0,U=0;U<Z.length;U++)Z[U][0]===`
`&&G++;return G>=Z.length/2?`\r
`:"\r"}}function f(S){return S.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function g(S){var k=(S=S||{}).delimiter,T=S.newline,P=S.comments,D=S.step,O=S.preview,z=S.fastMode,I=null,A=!1,j=S.quoteChar==null?'"':S.quoteChar,E=j;if(S.escapeChar!==void 0&&(E=S.escapeChar),(typeof k!="string"||-1<s.BAD_DELIMITERS.indexOf(k))&&(k=","),P===k)throw new Error("Comment character same as delimiter");P===!0?P="#":(typeof P!="string"||-1<s.BAD_DELIMITERS.indexOf(P))&&(P=!1),T!==`
`&&T!=="\r"&&T!==`\r
`&&(T=`
`);var N=0,B=!1;this.parse=function(C,F,M){if(typeof C!="string")throw new Error("Input must be a string");var _=C.length,W=k.length,$=T.length,H=P.length,R=w(D),V=[],Z=[],K=[],X=N=0;if(!C)return ge();if(z||z!==!1&&C.indexOf(j)===-1){for(var G=C.split(T),U=0;U<G.length;U++){if(K=G[U],N+=K.length,U!==G.length-1)N+=T.length;else if(M)return ge();if(!P||K.substring(0,H)!==P){if(R){if(V=[],be(K.split(k)),Se(),B)return ge()}else be(K.split(k));if(O&&O<=U)return V=V.slice(0,O),ge(!0)}}return ge()}for(var Q=C.indexOf(k,N),J=C.indexOf(T,N),ee=new RegExp(f(E)+f(j),"g"),te=C.indexOf(j,N);;)if(C[N]===j)for(te=N,N++;;){if((te=C.indexOf(j,te+1))===-1)return M||Z.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:V.length,index:N}),$e();if(te===_-1)return $e(C.substring(N,te).replace(ee,j));if(j===E&&C[te+1]===E)te++;else if(j===E||te===0||C[te-1]!==E){Q!==-1&&Q<te+1&&(Q=C.indexOf(k,te+1));var ue=Le((J=J!==-1&&J<te+1?C.indexOf(T,te+1):J)===-1?Q:Math.min(Q,J));if(C.substr(te+1+ue,W)===k){K.push(C.substring(N,te).replace(ee,j)),C[N=te+1+ue+W]!==j&&(te=C.indexOf(j,N)),Q=C.indexOf(k,N),J=C.indexOf(T,N);break}if(ue=Le(J),C.substring(te+1+ue,te+1+ue+$)===T){if(K.push(C.substring(N,te).replace(ee,j)),oe(te+1+ue+$),Q=C.indexOf(k,N),te=C.indexOf(j,N),R&&(Se(),B))return ge();if(O&&V.length>=O)return ge(!0);break}Z.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:V.length,index:N}),te++}}else if(P&&K.length===0&&C.substring(N,N+H)===P){if(J===-1)return ge();N=J+$,J=C.indexOf(T,N),Q=C.indexOf(k,N)}else if(Q!==-1&&(Q<J||J===-1))K.push(C.substring(N,Q)),N=Q+W,Q=C.indexOf(k,N);else{if(J===-1)break;if(K.push(C.substring(N,J)),oe(J+$),R&&(Se(),B))return ge();if(O&&V.length>=O)return ge(!0)}return $e();function be(De){V.push(De),X=N}function Le(De){var se=0;return se=De!==-1&&(De=C.substring(te+1,De))&&De.trim()===""?De.length:se}function $e(De){return M||(De===void 0&&(De=C.substring(N)),K.push(De),N=_,be(K),R&&Se()),ge()}function oe(De){N=De,be(K),K=[],J=C.indexOf(T,N)}function ge(De){if(S.header&&!F&&V.length&&!A){var se=V[0],Fe=Object.create(null),re=new Set(se);let Ee=!1;for(let at=0;at<se.length;at++){let $t=se[at];if(Fe[$t=w(S.transformHeader)?S.transformHeader($t,at):$t]){let it,Jr=Fe[$t];for(;it=$t+"_"+Jr,Jr++,re.has(it););re.add(it),se[at]=it,Fe[$t]++,Ee=!0,(I=I===null?{}:I)[it]=$t}else Fe[$t]=1,se[at]=$t;re.add($t)}Ee&&console.warn("Duplicate headers found and renamed."),A=!0}return{data:V,errors:Z,meta:{delimiter:k,linebreak:T,aborted:B,truncated:!!De,cursor:X+(F||0),renamedHeaders:I}}}function Se(){D(ge()),V=[],Z=[]}},this.abort=function(){B=!0},this.getCharIndex=function(){return N}}function v(S){var k=S.data,T=a[k.workerId],P=!1;if(k.error)T.userError(k.error,k.file);else if(k.results&&k.results.data){var D={abort:function(){P=!0,h(k.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:y,resume:y};if(w(T.userStep)){for(var O=0;O<k.results.data.length&&(T.userStep({data:k.results.data[O],errors:k.results.errors,meta:k.results.meta},D),!P);O++);delete k.results}else w(T.userChunk)&&(T.userChunk(k.results,D,k.file),delete k.results)}k.finished&&!P&&h(k.workerId,k.results)}function h(S,k){var T=a[S];w(T.userComplete)&&T.userComplete(k),T.terminate(),delete a[S]}function y(){throw new Error("Not implemented.")}function b(S){if(typeof S!="object"||S===null)return S;var k,T=Array.isArray(S)?[]:{};for(k in S)T[k]=b(S[k]);return T}function x(S,k){return function(){S.apply(k,arguments)}}function w(S){return typeof S=="function"}return s.parse=function(S,k){var T=(k=k||{}).dynamicTyping||!1;if(w(T)&&(k.dynamicTypingFunction=T,T={}),k.dynamicTyping=T,k.transform=!!w(k.transform)&&k.transform,!k.worker||!s.WORKERS_SUPPORTED)return T=null,s.NODE_STREAM_INPUT,typeof S=="string"?(S=(P=>P.charCodeAt(0)!==65279?P:P.slice(1))(S),T=new(k.download?c:u)(k)):S.readable===!0&&w(S.read)&&w(S.on)?T=new p(k):(t.File&&S instanceof File||S instanceof Object)&&(T=new d(k)),T.stream(S);(T=(()=>{var P;return!!s.WORKERS_SUPPORTED&&(P=(()=>{var D=t.URL||t.webkitURL||null,O=e.toString();return s.BLOB_URL||(s.BLOB_URL=D.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",O,")();"],{type:"text/javascript"})))})(),(P=new t.Worker(P)).onmessage=v,P.id=i++,a[P.id]=P)})()).userStep=k.step,T.userChunk=k.chunk,T.userComplete=k.complete,T.userError=k.error,k.step=w(k.step),k.chunk=w(k.chunk),k.complete=w(k.complete),k.error=w(k.error),delete k.worker,T.postMessage({input:S,config:k,workerId:T.id})},s.unparse=function(S,k){var T=!1,P=!0,D=",",O=`\r
`,z='"',I=z+z,A=!1,j=null,E=!1,N=((()=>{if(typeof k=="object"){if(typeof k.delimiter!="string"||s.BAD_DELIMITERS.filter(function(F){return k.delimiter.indexOf(F)!==-1}).length||(D=k.delimiter),typeof k.quotes!="boolean"&&typeof k.quotes!="function"&&!Array.isArray(k.quotes)||(T=k.quotes),typeof k.skipEmptyLines!="boolean"&&typeof k.skipEmptyLines!="string"||(A=k.skipEmptyLines),typeof k.newline=="string"&&(O=k.newline),typeof k.quoteChar=="string"&&(z=k.quoteChar),typeof k.header=="boolean"&&(P=k.header),Array.isArray(k.columns)){if(k.columns.length===0)throw new Error("Option columns is empty");j=k.columns}k.escapeChar!==void 0&&(I=k.escapeChar+z),k.escapeFormulae instanceof RegExp?E=k.escapeFormulae:typeof k.escapeFormulae=="boolean"&&k.escapeFormulae&&(E=/^[=+\-@\t\r].*$/)}})(),new RegExp(f(z),"g"));if(typeof S=="string"&&(S=JSON.parse(S)),Array.isArray(S)){if(!S.length||Array.isArray(S[0]))return B(null,S,A);if(typeof S[0]=="object")return B(j||Object.keys(S[0]),S,A)}else if(typeof S=="object")return typeof S.data=="string"&&(S.data=JSON.parse(S.data)),Array.isArray(S.data)&&(S.fields||(S.fields=S.meta&&S.meta.fields||j),S.fields||(S.fields=Array.isArray(S.data[0])?S.fields:typeof S.data[0]=="object"?Object.keys(S.data[0]):[]),Array.isArray(S.data[0])||typeof S.data[0]=="object"||(S.data=[S.data])),B(S.fields||[],S.data||[],A);throw new Error("Unable to serialize unrecognized input");function B(F,M,_){var W="",$=(typeof F=="string"&&(F=JSON.parse(F)),typeof M=="string"&&(M=JSON.parse(M)),Array.isArray(F)&&0<F.length),H=!Array.isArray(M[0]);if($&&P){for(var R=0;R<F.length;R++)0<R&&(W+=D),W+=C(F[R],R);0<M.length&&(W+=O)}for(var V=0;V<M.length;V++){var Z=($?F:M[V]).length,K=!1,X=$?Object.keys(M[V]).length===0:M[V].length===0;if(_&&!$&&(K=_==="greedy"?M[V].join("").trim()==="":M[V].length===1&&M[V][0].length===0),_==="greedy"&&$){for(var G=[],U=0;U<Z;U++){var Q=H?F[U]:U;G.push(M[V][Q])}K=G.join("").trim()===""}if(!K){for(var J=0;J<Z;J++){0<J&&!X&&(W+=D);var ee=$&&H?F[J]:J;W+=C(M[V][ee],J)}V<M.length-1&&(!_||0<Z&&!X)&&(W+=O)}}return W}function C(F,M){var _,W;return F==null?"":F.constructor===Date?JSON.stringify(F).slice(1,25):(W=!1,E&&typeof F=="string"&&E.test(F)&&(F="'"+F,W=!0),_=F.toString().replace(N,I),(W=W||T===!0||typeof T=="function"&&T(F,M)||Array.isArray(T)&&T[M]||(($,H)=>{for(var R=0;R<H.length;R++)if(-1<$.indexOf(H[R]))return!0;return!1})(_,s.BAD_DELIMITERS)||-1<_.indexOf(D)||_.charAt(0)===" "||_.charAt(_.length-1)===" ")?z+_+z:_)}},s.RECORD_SEP="",s.UNIT_SEP="",s.BYTE_ORDER_MARK="\uFEFF",s.BAD_DELIMITERS=["\r",`
`,'"',s.BYTE_ORDER_MARK],s.WORKERS_SUPPORTED=!n&&!!t.Worker,s.NODE_STREAM_INPUT=1,s.LocalChunkSize=10485760,s.RemoteChunkSize=5242880,s.DefaultDelimiter=",",s.Parser=g,s.ParserHandle=m,s.NetworkStreamer=c,s.FileStreamer=d,s.StringStreamer=u,s.ReadableStreamStreamer=p,t.jQuery&&((r=t.jQuery).fn.parse=function(S){var k=S.config||{},T=[];return this.each(function(O){if(!(r(this).prop("tagName").toUpperCase()==="INPUT"&&r(this).attr("type").toLowerCase()==="file"&&t.FileReader)||!this.files||this.files.length===0)return!0;for(var z=0;z<this.files.length;z++)T.push({file:this.files[z],inputElem:this,instanceConfig:r.extend({},k)})}),P(),this;function P(){if(T.length===0)w(S.complete)&&S.complete();else{var O,z,I,A,j=T[0];if(w(S.before)){var E=S.before(j.file,j.inputElem);if(typeof E=="object"){if(E.action==="abort")return O="AbortError",z=j.file,I=j.inputElem,A=E.reason,void(w(S.error)&&S.error({name:O},z,I,A));if(E.action==="skip")return void D();typeof E.config=="object"&&(j.instanceConfig=r.extend(j.instanceConfig,E.config))}else if(E==="skip")return void D()}var N=j.instanceConfig.complete;j.instanceConfig.complete=function(B){w(N)&&N(B,j.file,j.inputElem),D()},s.parse(j.file,j.instanceConfig)}}function D(){T.splice(0,1),P()}}),o&&(t.onmessage=function(S){S=S.data,s.WORKER_ID===void 0&&S&&(s.WORKER_ID=S.workerId),typeof S.input=="string"?t.postMessage({workerId:s.WORKER_ID,results:s.parse(S.input,S.config),finished:!0}):(t.File&&S.input instanceof File||S.input instanceof Object)&&(S=s.parse(S.input,S.config))&&t.postMessage({workerId:s.WORKER_ID,results:S,finished:!0})}),(c.prototype=Object.create(l.prototype)).constructor=c,(d.prototype=Object.create(l.prototype)).constructor=d,(u.prototype=Object.create(u.prototype)).constructor=u,(p.prototype=Object.create(l.prototype)).constructor=p,s})});var s6,dN,Wme=L(()=>{s6=q($me()),dN=class{async parseFile(t){return new Promise((r,n)=>{s6.parse(t,{complete:o=>{try{let a=this.processResults(o);r(a)}catch(a){n(a)}},error:o=>{n(new Error(`CSV parsing failed: ${o.message}`))},skipEmptyLines:!0,encoding:"UTF-8"})})}parseText(t,r){let n=s6.parse(t,{delimiter:r,skipEmptyLines:!0});return this.processResults(n)}processResults(t){if(!t.data||t.data.length===0)throw new Error("CSV file is empty");let r=t.data,n=t.meta.delimiter||",",o=r[0].map(i=>this.cleanHeader(i)),a=r.slice(1);if(a.length===0)throw new Error("CSV file contains only headers, no data rows");return{headers:o,rows:a,rowCount:a.length,delimiter:n}}cleanHeader(t){let r=t.replace(/^\uFEFF/,"");return r=r.trim(),r}detectDelimiter(t){let r=t.split(`
`)[0],n=[",",";","	","|"],o=0,a=",";for(let i of n){let s=r.split(i).length;s>o&&(o=s,a=i)}return a}validate(t){let r=[];t.headers.length===0&&r.push("No headers found in CSV file"),t.rows.length===0&&r.push("No data rows found in CSV file");let n=t.headers.length,o=t.rows.filter(a=>a.length!==n);return o.length>0&&r.push(`${o.length} rows have inconsistent column counts`),{valid:r.length===0,errors:r}}}});function qo(e){if(!e||e.trim()==="")return null;let t=e.replace(/[,$]/g,""),r=parseFloat(t);return isNaN(r)?null:r}function su(e){let t=e.toUpperCase().trim();return t==="BUY"||t==="B"||t==="LONG"||t==="BOT"||t==="BOUGHT"||t==="COVER"||t==="BUY TO COVER"?"long":t==="SELL"||t==="S"||t==="SHORT"||t==="SLD"||t==="SOLD"||t==="SELL SHORT"?"short":null}function Je(e,...t){let r={};for(let[n,o]of Object.entries(e))r[n.toLowerCase()]=o;for(let n of t){let o=r[n.toLowerCase()];if(o!==void 0)return o}}function sBe(e,t){if(!/^[yMdHms\s\-\/.:\d]+$/.test(t))throw new Error("Invalid date format: contains disallowed characters");let n=["yyyy","MM","M","dd","d","HH","mm","ss","SSS"],o=t;for(let b of n)o=o.replace(new RegExp(b,"g"),"");if(!/^[\s\-\/.:\d]*$/.test(o))throw new Error("Invalid date format: contains unknown tokens");let i=t.replace(/yyyy/g,"___YYYY___").replace(/MM/g,"___MM___").replace(/dd/g,"___DD___").replace(/HH/g,"___HH___").replace(/mm/g,"___mm___").replace(/ss/g,"___SS___").replace(/SSS/g,"___SSS___").replace(/M/g,"___M___").replace(/d/g,"___D___").replace(/___YYYY___/g,"(\\d{4})").replace(/___MM___/g,"(\\d{2})").replace(/___M___/g,"(\\d{1,2})").replace(/___DD___/g,"(\\d{2})").replace(/___D___/g,"(\\d{1,2})").replace(/___HH___/g,"(\\d{2})").replace(/___mm___/g,"(\\d{2})").replace(/___SS___/g,"(\\d{2})").replace(/___SSS___/g,"(\\d{3})");i=i.replace(/[/.:\s\-]/g,"\\$&");let s=new RegExp(`^${i}$`),l=e.match(s);if(!l)return null;let c=t.match(/(yyyy|MM?|dd?|HH|mm|ss|SSS)/g)||[],d={};for(let b=0;b<c.length;b++){let x=c[b],w=parseInt(l[b+1],10);d[x]=w}let u=d.yyyy||0,p=(d.MM||d.M||1)-1,m=d.dd||d.d||1,f=d.HH||0,g=d.mm||0,v=d.ss||0,h=d.SSS||0,y=new Date(u,p,m,f,g,v,h);return isNaN(y.getTime())?null:y}function lu(e,t){if(!e||e.trim()==="")return null;for(let n of t)try{let o=sBe(e.trim(),n);if(o)return o}catch(o){}let r=new Date(e);return isNaN(r.getTime())?null:r}function cu(e,t){return e==="long"&&t==="short"||e==="short"&&t==="long"}function Rme(e){if(typeof e!="string")return;let t=e.toLowerCase().trim();return["call","put"].includes(t)?t:void 0}function Ume(e){if(typeof e!="string")return;let t=e.toUpperCase().trim();return["OPEN","CLOSED"].includes(t)?t:void 0}var ix=L(()=>{});function Vme(e){let t=e.trim(),r=/^([A-Z]{1,6})\s*(\d{6})([CP])(\d{8})$/,n=t.match(r);if(!n)return null;let[o,a,i,s,l]=n,c=2e3+parseInt(i.substring(0,2),10),d=parseInt(i.substring(2,4),10)-1,u=parseInt(i.substring(4,6),10),p=new Date(Date.UTC(c,d,u)),m=s==="C"?"call":"put",f=parseInt(l,10)/1e3;return{underlying:a.trim(),expirationDate:p,optionType:m,strikePrice:f,success:!0,fullSymbol:t}}function Hme(e){let t=e.trim();return lBe.test(t)}var lBe,qme=L(()=>{pg();lBe=/^[A-Z]{1,6}\s*\d{6}[CP]\d{8}$/});var Qme={};Ko(Qme,{IBKRAdapter:()=>pBe,detectIBKR:()=>Gme,parseIBKRRow:()=>Xme});function Gme(e){let t=e.join(" ").toLowerCase(),r=["execution id","conid","listing exchange","t. price","c. price","comm/fee"],n=["symbol","quantity","price","commission","side","execution","proceeds","currency"],o=r.some(i=>t.includes(i)),a=n.filter(i=>t.includes(i)).length;return o||a>=3}function Yme(e){if(!e||e.trim()==="")return null;let t=e.trim();if(/^\d{8};\d{6}$/.test(t)){let[a,i]=t.split(";"),s=parseInt(a.substring(0,4),10),l=parseInt(a.substring(4,6),10)-1,c=parseInt(a.substring(6,8),10),d=parseInt(i.substring(0,2),10),u=parseInt(i.substring(2,4),10),p=parseInt(i.substring(4,6),10),m=String(l+1).padStart(2,"0"),f=String(c).padStart(2,"0"),g=String(d).padStart(2,"0"),v=String(u).padStart(2,"0"),h=String(p).padStart(2,"0"),y=new Date(Date.UTC(s,l,c,d,u,p)),x=new Intl.DateTimeFormat("en-US",{timeZone:"America/New_York",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).formatToParts(y),w=j=>{var E;return parseInt(((E=x.find(N=>N.type===j))==null?void 0:E.value)||"0",10)},S=w("year"),k=w("month")-1,T=w("day"),P=w("hour"),D=w("minute"),O=w("second"),z=y.getTime()-new Date(S,k,T,P,D,O).getTime(),I=Math.round(z/6e4),A=new Date(Date.UTC(s,l,c,d-Math.floor(I/60),u-I%60,p));if(!isNaN(A.getTime()))return A}let n=lu(t,["yyyy-MM-dd, HH:mm:ss","yyyy-MM-dd HH:mm:ss","MM/dd/yyyy, HH:mm:ss","MM/dd/yyyy HH:mm:ss","yyyy-MM-dd","MM/dd/yyyy"]);if(n)return n;let o=t.match(/^(\d{4})-(\d{2})-(\d{2})$/);if(o){let[,a,i,s]=o,l=new Date(Date.UTC(parseInt(a,10),parseInt(i,10)-1,parseInt(s,10)));return isNaN(l.getTime())?null:l}return null}function Kme(e){let t=e.split(/\s+/);return t.length>0&&t[0].trim()?t[0].trim():e.trim()}function cBe(e){let r=e.trim().match(/^([A-Z]+)\s+(\d{6})([CP])(\d{8})$/);if(!r)return null;let[n,o,a,i,s]=r,l=2e3+parseInt(a.substring(0,2),10),c=parseInt(a.substring(2,4),10)-1,d=parseInt(a.substring(4,6),10),u=new Date(Date.UTC(l,c,d)),p=i==="C"?"call":"put",m=parseInt(s,10)/1e3;return{underlying:o,expirationDate:u,optionType:p,strikePrice:m}}function Jme(e){let t=e.toUpperCase().trim();return t==="B"||t==="BUY"||t==="BOT"?"long":t==="S"||t==="SELL"||t==="SLD"?"short":su(e)}function Th(e){if(!e||e.trim()===""||e==="-"||e==="N/A")return null;let t=e.trim();t=t.replace(/[$,]/g,""),t.startsWith("(")&&t.endsWith(")")&&(t="-"+t.substring(1,t.length-1));let r=parseFloat(t);return isNaN(r)?null:r}function Xme(e){try{let t=Je(e,sx.symbol,"Symbol","Underlying");if(!t||t.trim()==="")return null;let r=Kme(t),n=Je(e,sx.direction,"Buy/Sell","Side");if(!n)return null;let o=Jme(n);if(!o)return null;let a=Je(e,"OrderID","Order ID","Execution ID","ExecID"),i=Je(e,sx.dateTime,"Date/Time","DateTime","Time");if(!i)return null;let s=Yme(i);if(!s)return null;let l=Je(e,sx.price,"Price","T. Price"),c=Th(l);if(c===null||c<=0)return null;let d=Je(e,sx.volume,"Quantity","Qty"),u=Th(d);if(u===null||u===0)return null;let p=Math.abs(u),m=Je(e,sx.commission,"Commission","Comm/Fee"),f=Th(m)||0,g="stock";return r.includes("/")||r.length===6?g="forex":(t.includes("C0")||t.includes("P0"))&&(g="options"),{symbol:r,direction:o,entryTime:s,entryPrice:c,quantity:p,commission:f,assetType:g}}catch(t){return console.error("Error parsing IBKR row:",t),null}}function dBe(e){let t=e.reduce((n,o)=>n+o.price*o.quantity,0),r=e.reduce((n,o)=>n+o.quantity,0);return r===0?0:t/r}function uBe(e){let t=[];for(let p of e)try{let m=Je(p,"Symbol","Underlying")||"";if(!m||m.trim()==="")continue;let f=Kme(m),g=Je(p,"Buy/Sell","Side");if(!g)continue;let v=Jme(g);if(!v)continue;let h=Je(p,"OrderID","Order ID","Execution ID","ExecID"),y=Je(p,"Date/Time","DateTime","Time");if(!y)continue;let b=Yme(y);if(!b)continue;let x=Je(p,"Price","T. Price"),w=Th(x);if(w===null||w<=0)continue;let S=Je(p,"Quantity","Qty"),k=Th(S);if(k===null||k===0)continue;let T=Math.abs(k),P=Je(p,"Commission","Comm/Fee"),D=Th(P)||0,O=Je(p,"Code","Codes"),z=Je(p,"Multiplier"),I="stock";f.includes("/")||f.length===6?I="forex":(m.includes("C0")||m.includes("P0"))&&(I="options");let A,j,E,N;if(I==="options"){let C=cBe(m);C&&(A=C.strikePrice,j=C.expirationDate,E=C.optionType,N=Th(z)||100)}let B={fullSymbol:m.trim(),underlyingSymbol:f,direction:v,executionTime:b,price:w,quantity:T,commission:D,assetType:I,orderID:h,code:O,strikePrice:A,expirationDate:j,optionType:E,contractSize:N};t.push(B)}catch(m){console.error("[IBKR] Error parsing row:",m);continue}let r=new Map;for(let p of t){let m=p.orderID?`${p.orderID}-${p.fullSymbol}-${p.direction}`:`${p.fullSymbol}-${p.direction}-${p.executionTime.getTime()}`;r.has(m)||r.set(m,[]),r.get(m).push(p)}let n=[];for(let[p,m]of r)if(m.length===1)n.push(m[0]);else{let f=m[0],g=m.map(h=>h.code).filter(h=>!!h).join(";")||void 0,v={fullSymbol:f.fullSymbol,underlyingSymbol:f.underlyingSymbol,direction:f.direction,executionTime:f.executionTime,price:dBe(m),quantity:m.reduce((h,y)=>h+y.quantity,0),commission:m.reduce((h,y)=>h+y.commission,0),assetType:f.assetType,orderID:f.orderID,code:g,strikePrice:f.strikePrice,expirationDate:f.expirationDate,optionType:f.optionType,contractSize:f.contractSize};n.push(v)}n.sort((p,m)=>p.executionTime.getTime()-m.executionTime.getTime());let o=new Set,a=new Set,i=new Set;for(let p of n)p.direction==="long"?o.add(p.fullSymbol):p.direction==="short"&&(a.add(p.fullSymbol),p.code&&p.code.split(";").map(m=>m.trim()).includes("C")&&i.add(p.fullSymbol));let s=new Map,l=[];for(let p of n){let m=s.get(p.fullSymbol);if(m&&cu(m.direction,p.direction)){let f=Math.min(m.quantity,p.quantity),g=p.commission*(f/p.quantity),h=m.commission*(f/m.quantity)+g,y=m.contractSize||(m.assetType==="options"?100:1),b;m.direction==="long"?b=(p.price-m.entryPrice)*f*y:b=(m.entryPrice-p.price)*f*y,m.exits||(m.exits=[]),m.exits.push({time:p.executionTime,price:p.price,quantity:f,commission:g}),m.originalQuantity||(m.originalQuantity=m.quantity),m.quantity-=f;let x=m.exits.reduce((S,k)=>S+k.quantity,0);if(Math.abs(x-m.originalQuantity)<1e-4||x>=m.originalQuantity){m.quantity=m.originalQuantity,delete m.originalQuantity;let k=m.exits.reduce((z,I)=>z+I.price*I.quantity,0)/x,T=m.exits[m.exits.length-1];m.exitTime=T.time,m.exitPrice=k,m.status="CLOSED";let P=m.exits.reduce((z,I)=>z+I.commission,0),D=m.contractSize||(m.assetType==="options"?100:1),O;m.direction==="long"?O=(k-m.entryPrice)*x*D:O=(m.entryPrice-k)*x*D,O-=m.commission+P,m.profitLoss=O,m.commission=m.commission+P,l.push(m),s.delete(p.fullSymbol)}if(p.quantity>f){let S=p.commission-g,k={symbol:p.underlyingSymbol,direction:p.direction,entryTime:p.executionTime,entryPrice:p.price,quantity:p.quantity-f,commission:S,assetType:p.assetType,status:"OPEN",strikePrice:p.strikePrice,expirationDate:p.expirationDate,optionType:p.optionType,contractSize:p.contractSize};s.set(p.fullSymbol,k)}}else if(m&&m.direction===p.direction){m.entries||(m.entries=[{time:m.entryTime,price:m.entryPrice,quantity:m.quantity,commission:m.commission}]),m.entries.push({time:p.executionTime,price:p.price,quantity:p.quantity,commission:p.commission});let f=m.quantity+p.quantity,g=(m.quantity*m.entryPrice+p.quantity*p.price)/f;m.quantity=f,m.entryPrice=g,m.commission+=p.commission,p.executionTime<m.entryTime&&(m.entryTime=p.executionTime),p.strikePrice&&!m.strikePrice&&(m.strikePrice=p.strikePrice),p.expirationDate&&!m.expirationDate&&(m.expirationDate=p.expirationDate),p.optionType&&!m.optionType&&(m.optionType=p.optionType),p.contractSize&&!m.contractSize&&(m.contractSize=p.contractSize)}else{let f={symbol:p.underlyingSymbol,direction:p.direction,entryTime:p.executionTime,entryPrice:p.price,quantity:p.quantity,commission:p.commission,assetType:p.assetType,status:"OPEN",strikePrice:p.strikePrice,expirationDate:p.expirationDate,optionType:p.optionType,contractSize:p.contractSize};s.set(p.fullSymbol,f)}}let c=new Map;for(let p of e){let m=Je(p,"Symbol","Underlying");if(m&&m.trim()!==""){let f=m.trim();c.set(f,(c.get(f)||0)+1)}}let d=[],u=0;d.push(...l.filter(p=>p.status==="CLOSED"));for(let[p,m]of s){let f=c.get(p)||0,g=o.has(p),v=a.has(p),h=i.has(p);if(!g&&v&&m.direction==="short"&&f>=2&&h){u++;continue}f>=2||f===1&&m.direction==="long"||f===1&&m.direction==="short"&&m.status==="OPEN"?d.push(m):u++}return d}var sx,pBe,Zme=L(()=>{ix();sx={symbol:"Symbol",direction:"Buy/Sell",dateTime:"Date/Time",price:"Price",volume:"Quantity",commission:"Commission"};pBe={name:"Interactive Brokers",detect:Gme,parseRow:Xme,parseBatch:uBe}});var efe={};Ko(efe,{TradeZeroAdapter:()=>vBe,parseTradeZeroRow:()=>l6});function fBe(e,t){if(!e||!t||e.trim()===""||t.trim()==="")return null;try{let n=`${e.trim()} ${t.trim()}`.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})\s+(\d{1,2}):(\d{2}):(\d{2})$/);if(!n)return null;let[,o,a,i,s,l,c]=n,d=parseInt(i,10),u=parseInt(o,10)-1,p=parseInt(a,10),m=parseInt(s,10),f=parseInt(l,10),g=parseInt(c,10),v=new Date(Date.UTC(d,u,p,12,0,0)),h=mBe.format(v),b=12-parseInt(h,10);return new Date(Date.UTC(d,u,p,m+b,f,g))}catch(r){return Ae.error("[TradeZero] Error parsing date/time:",r,{tradeDate:e,execTime:t}),null}}function gBe(e){let t=[Ls.commission,Ls.sec,Ls.taf,Ls.nscc,Ls.nasdaq,Ls.ecnRemove,Ls.ecnAdd],r=0;for(let n of t){let o=Je(e,n),a=qo(o);a!==null&&(r+=a)}return r}function l6(e){try{let t=Je(e,Ls.symbol,"Symbol");if(!t||t.trim()==="")return null;let r=Je(e,Ls.direction,"Side");if(!r)return null;let n=su(r);if(!n)return null;let o=Je(e,Ls.tradeDate,"T/D"),a=Je(e,Ls.execTime,"Exec Time");if(!o||!a)return null;let i=fBe(o,a);if(!i)return null;let s=Je(e,Ls.price,"Price"),l=qo(s);if(l===null||l<=0)return null;let c=Je(e,Ls.volume,"Qty","Quantity"),d=qo(c);if(d===null||d===0)return null;let u=Math.abs(d),p=gBe(e),m=Je(e,Ls.accountId,"Account");return{symbol:t.trim(),direction:n,entryTime:i,entryPrice:l,quantity:u,commission:p,accountId:m==null?void 0:m.trim(),assetType:"stock"}}catch(t){return Ae.error("[TradeZero] Error parsing row:",t,e),null}}function hBe(e){var l,c,d;let t=[];for(let u of e)try{let p=l6(u);if(!p)continue;let m={symbol:p.symbol,direction:p.direction,executionTime:p.entryTime,price:p.entryPrice,quantity:p.quantity,commission:p.commission,accountId:p.accountId};t.push(m)}catch(p){Ae.error("[TradeZero] Error parsing row in batch:",p);continue}t.sort((u,p)=>u.executionTime.getTime()-p.executionTime.getTime());let r=new Set,n=new Set;for(let u of t){let p=`${(l=u.accountId)!=null?l:""}:${u.symbol}`;u.direction==="long"?r.add(p):u.direction==="short"&&n.add(p)}let o=new Map,a=[];for(let u of t){let p=`${(c=u.accountId)!=null?c:""}:${u.symbol}`,m=o.get(p);if(m&&cu(m.direction,u.direction)){let f=Math.min(m.quantity,u.quantity),g=u.commission*(f/u.quantity);m.exits||(m.exits=[]),m.exits.push({time:u.executionTime,price:u.price,quantity:f,commission:g}),m.originalQuantity||(m.originalQuantity=m.quantity),m.quantity-=f;let v=m.exits.reduce((h,y)=>h+y.quantity,0);if(v>=m.originalQuantity){m.quantity=m.originalQuantity,delete m.originalQuantity;let y=m.exits.reduce((S,k)=>S+k.price*k.quantity,0)/v,b=m.exits[m.exits.length-1];m.exitTime=b.time,m.exitPrice=y,m.status="CLOSED";let x=m.exits.reduce((S,k)=>S+k.commission,0),w;m.direction==="long"?w=(y-m.entryPrice)*v:w=(m.entryPrice-y)*v,w-=m.commission+x,m.profitLoss=w,m.commission=m.commission+x,a.push(m),o.delete(p)}if(u.quantity>f){let h=u.commission-g,y={symbol:u.symbol,direction:u.direction,entryTime:u.executionTime,entryPrice:u.price,quantity:u.quantity-f,commission:h,accountId:u.accountId,assetType:"stock",status:"OPEN"};o.set(p,y)}}else if(m&&m.direction===u.direction){m.entries||(m.entries=[{time:m.entryTime,price:m.entryPrice,quantity:m.quantity,commission:m.commission}]),m.entries.push({time:u.executionTime,price:u.price,quantity:u.quantity,commission:u.commission});let f=m.quantity+u.quantity,g=(m.quantity*m.entryPrice+u.quantity*u.price)/f;m.quantity=f,m.entryPrice=g,m.commission+=u.commission,u.executionTime<m.entryTime&&(m.entryTime=u.executionTime)}else{let f={symbol:u.symbol,direction:u.direction,entryTime:u.executionTime,entryPrice:u.price,quantity:u.quantity,commission:u.commission,accountId:u.accountId,assetType:"stock",status:"OPEN"};o.set(p,f)}}let i=new Map;for(let u of t){let p=`${(d=u.accountId)!=null?d:""}:${u.symbol}`;i.set(p,(i.get(p)||0)+1)}let s=[];s.push(...a.filter(u=>u.status==="CLOSED"));for(let[u,p]of o){let m=i.get(u)||0,f=r.has(u),g=n.has(u);!f&&g&&p.direction==="short"&&m>=2||(m>=2||m===1&&p.direction==="long"||m===1&&p.direction==="short"&&p.status==="OPEN")&&s.push(p)}return s}var mBe,Ls,vBe,tfe=L(()=>{ix();pg();mBe=new Intl.DateTimeFormat("en-US",{timeZone:"America/New_York",hour:"2-digit",hour12:!1}),Ls={symbol:"Symbol",direction:"Side",tradeDate:"T/D",execTime:"Exec Time",price:"Price",volume:"Qty",commission:"Comm",sec:"SEC",taf:"TAF",nscc:"NSCC",nasdaq:"Nasdaq",ecnRemove:"ECN Remove",ecnAdd:"ECN Add",accountId:"Account",clearingBroker:"Clr Broker",liquidity:"Liq"};vBe={name:"TradeZero",detect:e=>!1,parseRow:l6,parseBatch:hBe}});var d6={};Ko(d6,{TradingViewAdapter:()=>SBe,detectTradingView:()=>rfe,detectTradingViewStrict:()=>nfe,parseTradingViewBatch:()=>ofe,parseTradingViewRow:()=>c6,setTradingViewAssetType:()=>kBe});function xBe(e){let t=e.split(":"),r=t.length>1?t[1]:e;if(r=r.trim(),r.length>=4){let o=r.substring(0,3);if(US[o])return o}if(r.length>=3){let o=r.substring(0,2);if(US[o])return o}if(/\d{4}$/.test(r))for(let o=0;o<r.length;o++){let a=r[o];if(bBe.includes(a)){let i=r.substring(0,o);if(i.length>0)return i}}return r}function wBe(e){return!e||e.trim()===""?null:lu(e.trim(),yBe)}function rfe(e){let t=e.map(u=>u.toLowerCase().trim()).join(" "),r=["fill price","placing time","closing time","level id","leverage","margin"],n=["limit price","stop price","order id","qty","side"],o=["symbol","type","status","commission"],a=0,i=0,s=0;for(let u of r)t.includes(u)&&a++;for(let u of n)t.includes(u)&&i++;for(let u of o)t.includes(u)&&s++;let d=(a*3+i*2+s*1)/32;return t.includes("fill price")&&t.includes("placing time")&&(d+=.3),t.includes("level id")&&(d+=.1),Math.min(d,1)}function nfe(e){return rfe(e)>=.5}function c6(e){let t=Je(e,hp.status);if(!t||t.toLowerCase().trim()!=="filled")return null;let r=Je(e,hp.symbol);if(!r||r.trim()==="")return null;let n=xBe(r);if(!n||n.trim()==="")return null;let o=Je(e,hp.direction);if(!o)return null;let a=su(o);if(!a)return null;let i=Je(e,hp.fillPrice);if(!i||i.trim()==="")return null;let s=qo(i);if(s===null)return null;let l=Je(e,hp.volume);if(!l)return null;let c=qo(l);if(c===null||c===0)return null;c<0&&(c=-c);let d=Je(e,hp.closingTime),u=Je(e,hp.placingTime),p=d||u;if(!p)return null;let m=wBe(p);if(!m)return null;let f=Je(e,hp.commission),g=f&&qo(f)||0,h=Je(e,hp.orderID)||void 0,y=US[n]||{contractSize:1,tickSize:.01,tickValue:1};return{symbol:n,direction:a,entryTime:m,entryPrice:s,quantity:c,commission:g,orderID:h,assetType:ic,contractSize:ic==="futures"?y.contractSize:ic==="options"?100:1,tickSize:y.tickSize,tickValue:y.tickValue}}function ofe(e){let t=[];for(let c of e){let d=c6(c);d&&t.push({symbol:d.symbol,direction:d.direction,time:d.entryTime,price:d.entryPrice,quantity:d.quantity,commission:d.commission,orderID:d.orderID})}if(t.length===0)return[];let r=new Map;for(let c of t){let d=c.orderID?`${c.orderID}-${c.symbol}-${c.direction}`:`${c.symbol}-${c.direction}-${c.time.getTime()}`;r.has(d)||r.set(d,[]),r.get(d).push(c)}let n=[];for(let[c,d]of r)if(d.length===1)n.push(d[0]);else{let u=d.reduce((v,h)=>v+h.quantity,0),p=d.reduce((v,h)=>v+h.price*h.quantity,0);if(u===0)continue;let m=p/u,f=d.reduce((v,h)=>v+h.commission,0),g={...d[0],price:m,quantity:u,commission:f,time:d[0].time};n.push(g)}n.sort((c,d)=>c.time.getTime()-d.time.getTime());let o=[],a=new Map;for(let c of n){let d=a.get(c.symbol)||[],u=d[0];if(u&&cu(u.direction,c.direction)){let p=Math.min(u.quantity,c.quantity),m=c.commission*(p/c.quantity),f=c.commission-m,v=(u.direction==="long"?c.price-u.entryPrice:u.entryPrice-c.price)*p*u.contractSize-m;if(u.exits.push({time:c.time,price:c.price,quantity:p,commission:m}),u.accumulatedPnL+=v,u.quantity-=p,u.quantity===0){let h=u.exits.reduce((S,k)=>S+k.commission,0),y=u.commission+h,x=u.exits.reduce((S,k)=>S+k.price*k.quantity,0)/u.originalQuantity,w=u.exits[u.exits.length-1];o.push({symbol:u.symbol,direction:u.direction,entryTime:u.entryTime,entryPrice:u.entryPrice,quantity:u.originalQuantity,exitTime:w.time,exitPrice:x,profitLoss:u.accumulatedPnL-u.commission,commission:y,status:"CLOSED",assetType:ic,contractSize:u.contractSize,tickSize:u.tickSize,tickValue:u.tickValue,entries:u.entries,exits:u.exits}),d.shift(),d.length===0?a.delete(c.symbol):a.set(c.symbol,d)}if(c.quantity>p){let h=US[c.symbol]||{contractSize:1,tickSize:.01,tickValue:1},y={symbol:c.symbol,direction:c.direction,entryTime:c.time,entryPrice:c.price,quantity:c.quantity-p,commission:f,assetType:ic,contractSize:ic==="futures"?h.contractSize:ic==="options"?100:1,tickSize:h.tickSize,tickValue:h.tickValue,exits:[],accumulatedPnL:0,originalQuantity:c.quantity-p,orderID:c.orderID},b=a.get(c.symbol)||[];b.push(y),a.set(c.symbol,b)}}else{let p=US[c.symbol]||{contractSize:1,tickSize:.01,tickValue:1};if(d.length>0&&d[0].direction===c.direction){let m=d[0];m.entries||(m.entries=[{time:m.entryTime,price:m.entryPrice,quantity:m.quantity,commission:m.commission}]),m.entries.push({time:c.time,price:c.price,quantity:c.quantity,commission:c.commission});let f=m.quantity+c.quantity,g=(m.quantity*m.entryPrice+c.quantity*c.price)/f;m.quantity=f,m.entryPrice=g,m.originalQuantity=f,m.commission+=c.commission,a.set(c.symbol,d)}else{let m={symbol:c.symbol,direction:c.direction,entryTime:c.time,entryPrice:c.price,quantity:c.quantity,commission:c.commission,assetType:ic,contractSize:ic==="futures"?p.contractSize:ic==="options"?100:1,tickSize:p.tickSize,tickValue:p.tickValue,exits:[],accumulatedPnL:0,originalQuantity:c.quantity,orderID:c.orderID},f=a.get(c.symbol)||[];f.push(m),a.set(c.symbol,f)}}}let i=Array.from(a.values()).flat();for(let c of i)o.push({symbol:c.symbol,direction:c.direction,entryTime:c.entryTime,entryPrice:c.entryPrice,quantity:c.quantity,commission:c.commission,status:"OPEN",assetType:ic,contractSize:c.contractSize,tickSize:c.tickSize,tickValue:c.tickValue});let s=new Map;for(let c of t){let d=c.symbol,u=s.get(d)||{buyCount:0,sellCount:0};c.direction==="long"?u.buyCount++:u.sellCount++,s.set(d,u)}let l=[];for(let c of o){let d=s.get(c.symbol)||{buyCount:0,sellCount:0},u=d.buyCount+d.sellCount;(u>=2||u===1&&c.direction==="long"||u===1&&c.direction==="short"&&c.status==="OPEN")&&l.push(c)}return l}function kBe(e){ic=e}var hp,US,yBe,bBe,ic,SBe,u6=L(()=>{ix();hp={symbol:"Symbol",direction:"Side",orderType:"Type",volume:"Qty",limitPrice:"Limit Price",stopPrice:"Stop Price",fillPrice:"Fill Price",status:"Status",commission:"Commission",placingTime:"Placing Time",closingTime:"Closing Time",orderID:"Order ID",levelID:"Level ID",leverage:"Leverage",margin:"Margin"},US={MNQ:{contractSize:2,tickSize:.25,tickValue:.5},NQ:{contractSize:20,tickSize:.25,tickValue:5},ES:{contractSize:50,tickSize:.25,tickValue:12.5},MES:{contractSize:5,tickSize:.25,tickValue:1.25},YM:{contractSize:5,tickSize:1,tickValue:5},MYM:{contractSize:.5,tickSize:1,tickValue:.5},RTY:{contractSize:50,tickSize:.1,tickValue:5},M2K:{contractSize:5,tickSize:.1,tickValue:.5},GC:{contractSize:100,tickSize:.1,tickValue:10},MGC:{contractSize:10,tickSize:.1,tickValue:1},CL:{contractSize:1e3,tickSize:.01,tickValue:10},MCL:{contractSize:100,tickSize:.01,tickValue:1}},yBe=["yyyy-MM-dd HH:mm:ss","yyyy-MM-dd HH:mm:ss.SSS","yyyy-MM-dd'T'HH:mm:ss","yyyy-MM-dd'T'HH:mm:ss.SSS'Z'"],bBe=["F","G","H","J","K","M","N","Q","U","V","X","Z"],ic="futures";SBe={name:"TradingView Paper Trading",detect:nfe,parseRow:c6,parseBatch:ofe}});var lfe={};Ko(lfe,{TradovateAdapter:()=>EBe,detectTradovate:()=>afe,detectTradovateStrict:()=>ife,parseTradovateBatch:()=>sfe,parseTradovateRow:()=>p6});function PBe(e){e=e.trim().replace(/\//g,"");let t=e.split(/\s+/);if(t.length>0&&(e=t[0]),e.length>=4){let r=e.substring(0,3);if(VS[r])return r}if(e.length>=3){let r=e.substring(0,2);if(VS[r])return r}if(!e.includes("_")&&e.length>=4&&e.length<=8)for(let r=2;r<Math.min(e.length,5);r++){let n=e[r];if(CBe.includes(n)&&e.substring(r+1).match(/^\d{1,2}$/))return e.substring(0,r)}return e}function DBe(e){return!e||e.trim()===""?null:lu(e.trim(),TBe)}function afe(e){let t=e.map(u=>u.toLowerCase().trim()).join(" "),r=["contract","b/s","fill time","avg fill price","filled qty","order id","account"],n=["fill price","qty","avgprice","filledqty","execution time","instrument","timestamp"],o=["symbol","side","time","price","volume","quantity"],a=0,i=0,s=0;for(let u of r)t.includes(u)&&a++;for(let u of n)t.includes(u)&&i++;for(let u of o)t.includes(u)&&s++;let d=(a*3+i*2+s*1)/41;return t.includes("b/s")&&(d+=.2),t.includes("account")&&(d+=.1),Math.min(d,1)}function ife(e){return afe(e)>=.5}function p6(e){let t=Je(e,nd.status);if(t&&t.toLowerCase().trim()!=="filled")return null;let r=Je(e,nd.symbol);if(!r||r.trim()==="")return null;let n=PBe(r),o=Je(e,nd.direction);if(!o)return null;let a=su(o);if(!a)return null;let i=Je(e,nd.dateTime);if(!i)return null;let s=DBe(i);if(!s)return null;let l=Je(e,nd.price,nd.priceAlt);if(!l)return null;let c=qo(l);if(c===null)return null;let d=Je(e,nd.volume,nd.volumeAlt);if(!d)return null;let u=qo(d);if(u===null||u===0)return null;u<0&&(u=-u);let p=Je(e,nd.commission),m=p&&qo(p)||0,f=Je(e,nd.accountId),v=Je(e,...nd.orderID)||void 0,h=VS[n]||{contractSize:1,tickSize:.01,tickValue:1};return{symbol:n,direction:a,entryTime:s,entryPrice:c,quantity:u,commission:m,accountId:f||void 0,orderID:v,assetType:"futures",contractSize:h.contractSize,tickSize:h.tickSize,tickValue:h.tickValue}}function sfe(e){let t=[];for(let d of e){let u=p6(d);u&&t.push({symbol:u.symbol,direction:u.direction,time:u.entryTime,price:u.entryPrice,quantity:u.quantity,commission:u.commission,orderID:u.orderID})}if(t.length===0)return[];let r=new Map;for(let d of t){let u=d.orderID?`${d.orderID}-${d.symbol}-${d.direction}`:`${d.symbol}-${d.direction}-${d.time.getTime()}`;r.has(u)||r.set(u,[]),r.get(u).push(d)}let n=[];for(let[d,u]of r)if(u.length===1)n.push(u[0]);else{let p=u.reduce((h,y)=>h+y.quantity,0),m=u.reduce((h,y)=>h+y.price*y.quantity,0);if(p===0)continue;let f=m/p,g=u.reduce((h,y)=>h+y.commission,0),v={...u[0],price:f,quantity:p,commission:g,time:u[0].time};n.push(v)}n.sort((d,u)=>d.time.getTime()-u.time.getTime());let o=[],a=new Map;for(let d of n){let u=a.get(d.symbol)||[],p=u[0];if(p&&cu(p.direction,d.direction)){let m=Math.min(p.quantity,d.quantity),f=d.commission*(m/d.quantity),g=d.commission-f,h=(p.direction==="long"?d.price-p.entryPrice:p.entryPrice-d.price)*m*p.contractSize-f;if(p.exits.push({time:d.time,price:d.price,quantity:m,commission:f}),p.accumulatedPnL+=h,p.quantity-=m,p.quantity===0){let y=p.exits.reduce((k,T)=>k+T.commission,0),b=p.commission+y,w=p.exits.reduce((k,T)=>k+T.price*T.quantity,0)/p.originalQuantity,S=p.exits[p.exits.length-1];o.push({symbol:p.symbol,direction:p.direction,entryTime:p.entryTime,entryPrice:p.entryPrice,quantity:p.originalQuantity,exitTime:S.time,exitPrice:w,profitLoss:p.accumulatedPnL-p.commission,commission:b,status:"CLOSED",assetType:"futures",contractSize:p.contractSize,tickSize:p.tickSize,tickValue:p.tickValue,entries:p.entries,exits:p.exits}),u.shift(),u.length===0?a.delete(d.symbol):a.set(d.symbol,u)}if(d.quantity>m){let y=VS[d.symbol]||{contractSize:1,tickSize:.01,tickValue:1},b={symbol:d.symbol,direction:d.direction,entryTime:d.time,entryPrice:d.price,quantity:d.quantity-m,commission:g,assetType:"futures",contractSize:y.contractSize,tickSize:y.tickSize,tickValue:y.tickValue,exits:[],accumulatedPnL:0,originalQuantity:d.quantity-m,orderID:d.orderID},x=a.get(d.symbol)||[];x.push(b),a.set(d.symbol,x)}}else{let m=VS[d.symbol]||{contractSize:1,tickSize:.01,tickValue:1};if(u.length>0&&u[0].direction===d.direction){let f=u[0];f.entries||(f.entries=[{time:f.entryTime,price:f.entryPrice,quantity:f.quantity,commission:f.commission}]),f.entries.push({time:d.time,price:d.price,quantity:d.quantity,commission:d.commission});let g=f.quantity+d.quantity,v=(f.quantity*f.entryPrice+d.quantity*d.price)/g;f.quantity=g,f.entryPrice=v,f.originalQuantity=g,f.commission+=d.commission,a.set(d.symbol,u)}else{let f={symbol:d.symbol,direction:d.direction,entryTime:d.time,entryPrice:d.price,quantity:d.quantity,commission:d.commission,assetType:"futures",contractSize:m.contractSize,tickSize:m.tickSize,tickValue:m.tickValue,exits:[],accumulatedPnL:0,originalQuantity:d.quantity,orderID:d.orderID},g=a.get(d.symbol)||[];g.push(f),a.set(d.symbol,g)}}}let i=Array.from(a.values()).flat();for(let d of i)o.push({symbol:d.symbol,direction:d.direction,entryTime:d.entryTime,entryPrice:d.entryPrice,quantity:d.quantity,commission:d.commission,status:"OPEN",assetType:"futures",contractSize:d.contractSize,tickSize:d.tickSize,tickValue:d.tickValue});let s=new Map;for(let d of t){let u=d.symbol,p=s.get(u)||{buyCount:0,sellCount:0};d.direction==="long"?p.buyCount++:p.sellCount++,s.set(u,p)}let l=[],c=0;for(let d of o){let u=s.get(d.symbol)||{buyCount:0,sellCount:0},p=u.buyCount+u.sellCount;p>=2||p===1&&d.direction==="long"||p===1&&d.direction==="short"&&d.status==="OPEN"?l.push(d):c++}return l}var nd,VS,TBe,CBe,EBe,cfe=L(()=>{ix();nd={symbol:"Contract",direction:"B/S",dateTime:"Fill Time",price:"Avg Fill Price",priceAlt:"avgPrice",volume:"Filled Qty",volumeAlt:"filledQty",commission:"Commission",status:"Status",accountId:"Account",orderID:["Order ID","orderId","OrderID","order_id"]},VS={MNQ:{contractSize:2,tickSize:.25,tickValue:.5},NQ:{contractSize:20,tickSize:.25,tickValue:5},ES:{contractSize:50,tickSize:.25,tickValue:12.5},MES:{contractSize:5,tickSize:.25,tickValue:1.25},YM:{contractSize:5,tickSize:1,tickValue:5},MYM:{contractSize:.5,tickSize:1,tickValue:.5},RTY:{contractSize:50,tickSize:.1,tickValue:5},M2K:{contractSize:5,tickSize:.1,tickValue:.5},GC:{contractSize:100,tickSize:.1,tickValue:10},MGC:{contractSize:10,tickSize:.1,tickValue:1},CL:{contractSize:1e3,tickSize:.01,tickValue:10},MCL:{contractSize:100,tickSize:.01,tickValue:1}},TBe=["yyyy-MM-dd HH:mm:ss.SSS","yyyy-MM-dd HH:mm:ss","MM/dd/yyyy HH:mm:ss","M/d/yyyy HH:mm:ss","yyyy-MM-dd'T'HH:mm:ss","yyyy-MM-dd'T'HH:mm:ss.SSS'Z'","MM/dd/yyyy","M/d/yyyy"],CBe=["F","G","H","J","K","M","N","Q","U","V","X","Z"];EBe={name:"Tradovate",detect:ife,parseRow:p6,parseBatch:sfe}});var uN,dfe=L(()=>{ix();VR();HR();wL();qme();uN=class{constructor(t){var o;this.plugin=t;let r=((o=t.serviceManager)==null?void 0:o.getFolderPathService())||new af(t.app,t),n=t.settings.backendIntegration||{syncEnabled:!1,userId:"",showSyncNotifications:!1,showNewTradeNotifications:!1};this.tradeSyncService=new Ub(t,n,r),this.tradeFileGenerator=new Hb(t,n,r),this.specService=t.specService}generateCSVImportId(t,r){let n=Math.floor(new Date(t.entryTime).getTime()/1e3),o=Math.floor(n/60)*60,a=Math.round(parseFloat(String(t.entryPrice))*1e5)/1e5;return`${r}_${t.symbol}_${t.direction}_${o}_${a}_${t.quantity}`}getAdapter(t){if(t==="IBKR"){let{IBKRAdapter:n}=(Zme(),uu(Qme));return n}else if(t==="TRADEZERO"){let{TradeZeroAdapter:n}=(tfe(),uu(efe));return n}else if(t==="TRADINGVIEW"){let{TradingViewAdapter:n}=(u6(),uu(d6));return n}let{TradovateAdapter:r}=(cfe(),uu(lfe));return r}async importWithBrokerAdapter(t,r,n,o){let a={success:!1,imported:0,duplicates:0,errors:[],failedRows:[],unmappedSymbols:[]};try{if(await this.tradeSyncService.buildTradeFileCache(),r==="TRADINGVIEW"&&o){let{setTradingViewAssetType:u}=(u6(),uu(d6));u(o)}let i=this.getAdapter(r),s;if(i.parseBatch)try{s=i.parseBatch(n)}catch(u){let p=u instanceof Error?u.message:String(u);return a.errors.push(`Batch parsing failed: ${p}`),a}else{s=[];for(let u=0;u<n.length;u++){let p=n[u];try{let m=i.parseRow(p);m&&s.push(m)}catch(m){let f=m instanceof Error?m.message:String(m);a.failedRows.push({row:u+1,reason:f})}}}let l=[],c=[];for(let u of s){let p=this.convertToTrade(u,t,a.unmappedSymbols);await this.checkDuplicate(p)?(l.push(u),a.duplicates++):c.push(p)}let d=[];for(let u=0;u<c.length;u++){let p=c[u];try{let m=await this.createTradeFile(p);a.imported++,d.length<5&&d.push({filePath:m,symbol:p.symbol,direction:p.direction==="BUY"?"long":"short",quantity:p.volume,entryPrice:p.entry_price,entryTime:p.entry_time,exitPrice:p.exit_price,profitLoss:p.profit_loss,status:p.status==="OPEN"||p.status==="CLOSED"?p.status:p.exit_price?"CLOSED":"OPEN"})}catch(m){let f=m instanceof Error?m.message:String(m);console.error("[CSV] ERROR processing trade:",p.symbol,"-",f),a.failedRows.push({row:u+1,reason:f})}}a.success=a.imported>0||a.duplicates>0,a.importedTrades=d,a.accountName=t,a.brokerType=r,console.log("[CSV] Import complete:",{imported:a.imported,duplicates:a.duplicates,errors:a.errors.length}),a.imported>0&&setTimeout(()=>{document.dispatchEvent(new CustomEvent("journalit:trade-data-changed",{detail:{action:"csv-import-completed",importedCount:a.imported,timestamp:Date.now()}}))},500)}catch(i){let s=i instanceof Error?i.message:String(i);a.errors.push(s)}return a}async importWithTemplate(t,r,n,o=!1){let a={success:!1,imported:0,duplicates:0,errors:[],failedRows:[],unmappedSymbols:[]};try{await this.tradeSyncService.buildTradeFileCache();let i;try{i=this.parseBatchWithTemplate(n,r)}catch(l){let c=l instanceof Error?l.message:String(l);return a.errors.push(`Batch parsing failed: ${c}`),a}if(r.asset_type==="options"&&!o){let l=this.validateOptionsData(i);if(!l.isValid)return{...a,needsWarning:!0,warningData:l.missingFields}}let s=[];for(let l=0;l<i.length;l++){let c=i[l];try{let d=this.convertToTrade(c,t,a.unmappedSymbols);if(await this.checkDuplicate(d)){a.duplicates++;continue}let u=await this.createTradeFile(d);a.imported++,s.length<5&&s.push({filePath:u,symbol:d.symbol,direction:d.direction==="BUY"?"long":"short",quantity:d.volume,entryPrice:d.entry_price,entryTime:d.entry_time,exitPrice:d.exit_price,profitLoss:d.profit_loss,status:d.status==="OPEN"||d.status==="CLOSED"?d.status:d.exit_price?"CLOSED":"OPEN"})}catch(d){let u=d instanceof Error?d.message:String(d);console.error("[CSV] ERROR creating file for trade:",c.symbol,"-",u),a.failedRows.push({row:l+1,reason:u})}}a.success=a.imported>0||a.duplicates>0,a.importedTrades=s,a.accountName=t,a.brokerType=r.broker_type,console.log("[CSV] Import complete:",{imported:a.imported,duplicates:a.duplicates,errors:a.errors.length}),a.imported>0&&setTimeout(()=>{document.dispatchEvent(new CustomEvent("journalit:trade-data-changed",{detail:{action:"csv-import-completed",importedCount:a.imported,timestamp:Date.now()}}))},500)}catch(i){let s=i instanceof Error?i.message:String(i);a.errors.push(s)}return a}validateOptionsData(t){let r=0,n=0,o=0;for(let s of t)s.strikePrice||r++,s.expirationDate||n++,s.optionType||o++;let a=t.length;return{isValid:!(r>0||n>0||o>0),missingFields:{tradesCount:a,missingStrike:r,missingExpiry:n,missingOptionType:o}}}parseBatchWithTemplate(t,r){let n=r.column_mappings,o=[];for(let c of t){let d=this.parseRowWithTemplate(c,r,r.asset_type);d&&o.push(d)}let a=Object.values(n).includes("order_id"),i=o;a&&(i=this.aggregateByOrderId(o));let s=new Map,l=[];for(let c of i){if(c.exitTime&&c.exitPrice){c.status="CLOSED",l.push(c);continue}let d=`${c.symbol}-${c.assetType||"stock"}`,u=s.get(d);if(u&&cu(u.direction,c.direction)){let p=Math.min(u.quantity,c.quantity);if(p>0&&(u.exits||(u.exits=[]),u.exits.push({time:c.entryTime,price:c.entryPrice,quantity:p,commission:c.commission}),u.originalQuantity||(u.originalQuantity=u.quantity),u.quantity-=p,u.quantity===0)){u.quantity=u.originalQuantity,delete u.originalQuantity;let m=u.exits.reduce((h,y)=>h+y.price*y.quantity,0),f=u.exits.reduce((h,y)=>h+y.quantity,0);if(f===0){console.warn("[CSV] Warning: Trade has exits with zero total quantity, skipping exit price calculation"),s.delete(d);continue}let g=m/f,v=u.exits[u.exits.length-1];if(u.exitTime=v.time,u.exitPrice=g,u.status="CLOSED",!u.profitLoss){let h=u.contractSize||(u.assetType==="options"?100:1),y=u.direction==="long"?g-u.entryPrice:u.entryPrice-g,b=u.exits.reduce((x,w)=>x+w.commission,0);u.profitLoss=y*f*h-u.commission-b}delete u.exits,l.push(u),s.delete(d)}}else if(u&&u.direction===c.direction){u.entries||(u.entries=[{time:u.entryTime,price:u.entryPrice,quantity:u.quantity,commission:u.commission||0}]),u.entries.push({time:c.entryTime,price:c.entryPrice,quantity:c.quantity,commission:c.commission||0});let p=u.quantity+c.quantity,m=u.quantity*u.entryPrice+c.quantity*c.entryPrice;u.entryPrice=m/p,u.quantity=p,u.commission=(u.commission||0)+(c.commission||0),s.set(d,u)}else c.status="OPEN",s.set(d,c)}for(let[c,d]of s)l.push(d);return l}aggregateByOrderId(t){let r=new Map;for(let o of t){let a=o.orderID?`${o.orderID}-${o.symbol}-${o.direction}`:`${o.symbol}-${o.direction}-${o.entryTime.getTime()}`;r.has(a)||r.set(a,[]),r.get(a).push(o)}let n=[];for(let[o,a]of r)if(a.length===1)n.push(a[0]);else{let i=a.reduce((p,m)=>p+m.quantity,0);if(i<=0)continue;let l=a.reduce((p,m)=>p+m.entryPrice*m.quantity,0)/i,c=a.reduce((p,m)=>p+m.commission,0),d=a.reduce((p,m)=>m.entryTime<p?m.entryTime:p,a[0].entryTime),u={...a[0],entryTime:d,entryPrice:l,quantity:i,commission:c};n.push(u)}return n}parseRowWithTemplate(t,r,n="stock"){let o=r.column_mappings,a=(ee,te=[])=>{for(let[ue,be]of Object.entries(o))if(be===ee||te.includes(be))return ue},i=a("symbol",["Symbol","instrument"]),s=a("direction",["Direction","side","Side"]),l=a("entry_time",["dateTime","DateTime","date","time"]),c=a("entry_price",["price","Price","exec_price"]),d=a("quantity",["volume","Volume","qty","Quantity","shares"]),u=a("commission",["Commission","fee","comm"]);if(!i||!s||!l||!c||!d)return null;let p=Je(t,i),m=Je(t,s),f=Je(t,l),g=Je(t,c),v=Je(t,d),h=u?Je(t,u):void 0;if(!p||!m||!f||!g||!v)return null;let y=su(m);if(!y)return null;let b=r.date_format?[r.date_format,"yyyy-MM-dd HH:mm:ss","MM/dd/yyyy HH:mm:ss","yyyy-MM-dd"]:["yyyy-MM-dd HH:mm:ss","MM/dd/yyyy HH:mm:ss","yyyy-MM-dd","MM/dd/yyyy"],x=lu(f,b);if(!x)return null;let w=qo(g),S=qo(v),k=h&&qo(h)||0;if(w===null||S===null)return null;let T=a("exit_time",["exit_date"]),P=a("exit_price"),D=a("profit_loss",["pnl","p_l"]),O,z,I;if(T){let ee=Je(t,T);ee&&(O=lu(ee,b)||void 0)}if(P){let ee=Je(t,P);z=qo(ee)||void 0}if(D){let ee=Je(t,D);I=qo(ee)||void 0}let A=a("asset_type",["instrument_type"]),j=a("strike_price",["strike"]),E=a("expiration_date",["expiry","exp_date"]),N=a("option_type",["call_put"]),B=a("contract_size",["multiplier","contract_mult"]),C=a("order_id",["order_number","order"]),F=a("account_id",["account"]),M=a("status",["trade_status"]),_=A?Je(t,A):void 0,W=j&&qo(Je(t,j))||void 0,$=E&&lu(Je(t,E)||"",b)||void 0,H=N?Rme(Je(t,N)):void 0,R=B&&qo(Je(t,B))||void 0,V=C?Je(t,C):void 0,Z=F?Je(t,F):void 0,K=M?Ume(Je(t,M)):void 0,X=p.trim(),G=W,U=$,Q=H;if(n==="options"&&Hme(p)){let ee=Vme(p);ee&&(X=ee.underlying,G=G||ee.strikePrice,U=U||ee.expirationDate,Q=Q||ee.optionType)}return{symbol:X,direction:y,entryTime:x,entryPrice:w,quantity:S,commission:k,exitTime:O,exitPrice:z,profitLoss:I,status:K,assetType:_||n||"stock",strikePrice:G,expirationDate:U,optionType:Q,contractSize:R,orderID:V,accountId:Z}}convertToTrade(t,r,n){var s,l,c,d,u,p;let o=t.direction==="long"?"BUY":"SELL",a=t.status||(t.exitTime?"CLOSED":"OPEN"),i={id:0,symbol:t.symbol,entry_time:t.entryTime.toISOString(),entry_price:t.entryPrice,volume:t.quantity,direction:o,exit_time:(s=t.exitTime)==null?void 0:s.toISOString(),exit_price:t.exitPrice,profit_loss:t.profitLoss||0,commission:t.commission||0,swap:0,fees:0,account_id:0,mt_account_display_name:r,status:a,csvImportId:this.generateCSVImportId(t,r),entries:(c=(l=t.entries)==null?void 0:l.map(m=>({time:m.time.toISOString(),price:m.price,size:m.quantity})))!=null?c:[{time:t.entryTime.toISOString(),price:t.entryPrice,size:t.quantity}],exits:(u=(d=t.exits)==null?void 0:d.map(m=>({time:m.time.toISOString(),price:m.price,size:m.quantity})))!=null?u:t.exitTime&&t.exitPrice!==void 0?[{time:t.exitTime.toISOString(),price:t.exitPrice,size:t.quantity}]:[],assetType:t.assetType,strikePrice:t.strikePrice,expirationDate:(p=t.expirationDate)==null?void 0:p.toISOString(),optionType:t.optionType,contractSize:t.contractSize};if(i.assetType==="futures"||i.assetType==="forex"){let m=this.specService.getSpecsForSymbol(i.symbol,i.assetType);if(!m&&n&&(n.some(g=>g.symbol===i.symbol&&g.assetType===i.assetType)||n.push({symbol:i.symbol,assetType:i.assetType})),m){if(i.assetType==="futures"&&"dollarPerPoint"in m){if(i.dollarPerPoint=m.dollarPerPoint,i.tickSize=m.tickSize,i.tickValue=m.tickValue,i.profit_loss!==void 0&&i.exit_price!==void 0)if(!Number.isFinite(m.tickSize)||m.tickSize<=0)console.warn(`Invalid tickSize for ${i.symbol}: ${m.tickSize} - skipping P&L recalculation`);else if(!Number.isFinite(m.tickValue)||m.tickValue<=0)console.warn(`Invalid tickValue for ${i.symbol}: ${m.tickValue} - skipping P&L recalculation`);else{let v=(i.direction==="BUY"?i.exit_price-i.entry_price:i.entry_price-i.exit_price)/m.tickSize*m.tickValue*i.volume;i.profit_loss=v-(i.commission||0)}}else if(i.assetType==="forex"&&"lotSize"in m&&(i.lotSize=m.lotSize,i.pipValue=m.pipValue,i.pipSize=m.pipSize,i.profit_loss!==void 0&&i.exit_price!==void 0))if(!Number.isFinite(m.pipSize)||m.pipSize<=0)console.warn(`Invalid pipSize for ${i.symbol}: ${m.pipSize} - skipping P&L recalculation`);else if(!Number.isFinite(m.pipValue)||m.pipValue<=0)console.warn(`Invalid pipValue for ${i.symbol}: ${m.pipValue} - skipping P&L recalculation`);else{let v=(i.direction==="BUY"?i.exit_price-i.entry_price:i.entry_price-i.exit_price)/m.pipSize*m.pipValue*i.volume;i.profit_loss=v-(i.commission||0)}}}return i}async checkDuplicate(t){return await this.tradeSyncService.findExistingTradeFileFromCache(t)!==null}async createTradeFile(t){let r=await this.tradeFileGenerator.generateTradeMarkdown(t,t.mt_account_display_name),n=this.tradeFileGenerator.generateTradeFilePath(t),o=n.substring(0,n.lastIndexOf("/"));return await this.tradeFileGenerator.ensureDirectoryExists(o),await this.plugin.app.vault.create(n,r),n}}});var pN,ufe=L(()=>{bL();oN();pN=class{constructor(t,r){this.plugin=t;this.settingsManager=r}getTemplates(){return this.plugin.settings.csvTemplates||[]}getTemplatesByUsage(){return[...this.getTemplates()].sort((t,r)=>t.last_used&&r.last_used?new Date(r.last_used).getTime()-new Date(t.last_used).getTime():t.last_used?-1:r.last_used?1:r.usage_count-t.usage_count)}getTemplate(t){return this.getTemplates().find(r=>r.id===t)}async createTemplate(t){let r={...t,id:Vb(),created_at:new Date().toISOString(),usage_count:0},n=this.getTemplates();return n.push(r),this.plugin.settings.csvTemplates=n,await this.settingsManager.saveSettings(this.plugin.settings),r}async updateTemplate(t,r){let n=this.getTemplates(),o=n.findIndex(i=>i.id===t);if(o===-1)throw new Error(`Template not found: ${t}`);let a={...n[o],...r,id:n[o].id,created_at:n[o].created_at};return n[o]=a,this.plugin.settings.csvTemplates=n,await this.settingsManager.saveSettings(this.plugin.settings),a}async deleteTemplate(t){let r=this.getTemplates(),n=r.filter(o=>o.id!==t);if(n.length===r.length)throw new Error(`Template not found: ${t}`);this.plugin.settings.csvTemplates=n,await this.settingsManager.saveSettings(this.plugin.settings)}async markTemplateAsUsed(t){let r=this.getTemplate(t);r&&await this.updateTemplate(t,{last_used:new Date().toISOString(),usage_count:r.usage_count+1})}templateNameExists(t,r){let n=t.toLowerCase();return this.getTemplates().some(o=>o.name.toLowerCase()===n&&o.id!==r)}async importTemplate(t){let r=n6(t);this.templateNameExists(r.name)&&(r.name=`${r.name} (Imported)`);let n=this.getTemplates();return n.push(r),this.plugin.settings.csvTemplates=n,await this.settingsManager.saveSettings(this.plugin.settings),r}exportTemplate(t){let r=this.getTemplate(t);if(!r)throw new Error(`Template not found: ${t}`);return nN(r)}}});function HS(e){return e==="IBKR"||e==="TRADOVATE"||e==="TRADEZERO"||e==="TRADINGVIEW"}var pfe=L(()=>{});var me,Go,mfe,ffe=L(()=>{me=q(Y()),Go=require("obsidian");er();Ut();nm();m1();lme();dme();ume();mme();gme();bme();kme();Tme();Eme();Lme();Fme();zme();Bme();g0();Wme();dfe();ufe();pfe();mfe=(0,me.memo)(({plugin:e})=>{(0,me.useEffect)(()=>(p1(),()=>u1()),[]);let[t,r]=(0,me.useState)("select"),[n,o]=(0,me.useState)(null),[a,i]=(0,me.useState)(null),[s,l]=(0,me.useState)(!1),[c,d]=(0,me.useState)(null),[u,p]=(0,me.useState)(null),[m,f]=(0,me.useState)(null),[g,v]=(0,me.useState)({}),[h,y]=(0,me.useState)("stock"),[b,x]=(0,me.useState)(!1),[w,S]=(0,me.useState)(null),[k,T]=(0,me.useState)(null),[P,D]=(0,me.useState)(0),[O,z]=(0,me.useState)(null),[I,A]=(0,me.useState)(null),[j,E]=(0,me.useState)({}),[N,B]=(0,me.useState)(!1),C=(0,me.useMemo)(()=>new dN,[]),F=(0,me.useMemo)(()=>new uN(e),[e]),M=(0,me.useMemo)(()=>new pN(e,e.settingsManager),[e]),_=(0,me.useCallback)(se=>se.rows.map(Fe=>{let re={};return se.headers.forEach((Ee,at)=>{re[Ee]=Fe[at]||""}),re}),[]),W=(0,me.useCallback)(se=>{o(se)},[]),$=(0,me.useCallback)((se,Fe)=>{i(se),l(Fe),Fe||(d(null),E({}),B(!1))},[]),H=(0,me.useCallback)(se=>{d(se),y(se.asset_type||"stock"),E(se.column_mappings),v(se.column_mappings),B(!1)},[]),R=(0,me.useCallback)(async(se,Fe)=>{p(se),x(!0),Fe&&(T(Fe),a||(i(Fe),new Go.Notice(`Auto-detected broker: ${Fe}. You can change this if needed.`)));try{let re=await C.parseFile(se),Ee=C.validate(re);if(!Ee.valid){new Go.Notice(`CSV validation failed: ${Ee.errors.join(", ")}`),x(!1);return}f(re),r("preview"),new Go.Notice(`CSV parsed successfully: ${re.rowCount} rows`)}catch(re){console.error("CSV parsing error:",re),new Go.Notice("Failed to parse CSV file: "+(re instanceof Error?re.message:"Unknown error")),p(null)}finally{x(!1)}},[a,C]),V=(0,me.useCallback)(()=>{c&&(v(c.column_mappings),y(c.asset_type||"stock")),r("mapping")},[c]),Z=(0,me.useCallback)(se=>{v(se)},[]),K=(0,me.useCallback)(se=>{if(v(se),c){let Fe=JSON.stringify(se)!==JSON.stringify(j);B(Fe)}},[c,j]),X=(0,me.useCallback)(se=>{y(se)},[]),G=(0,me.useMemo)(()=>{let se=Object.values(g).filter(re=>re!=="");return["symbol","entry_time","direction","quantity","entry_price"].every(re=>se.includes(re))},[g]),U=(0,me.useCallback)(()=>{z(null),A(null),x(!1),r("mapping")},[]),Q=(0,me.useCallback)(async()=>{if(!a||!m||!u||!n){new Go.Notice("Please complete all required fields");return}x(!0),r("processing");try{let se,Fe=_(m),re=c||{id:"manual-temp",name:"Manual Import",broker_type:"MANUAL",asset_type:h,column_mappings:g,has_headers:!0,created_at:new Date().toISOString(),usage_count:0};if(HS(a))se=await F.importWithBrokerAdapter(n,a,Fe,h);else if(a==="MANUAL"||s){if(!G){new Go.Notice("Please map all required fields before importing"),r("mapping"),x(!1);return}se=await F.importWithTemplate(n,re,Fe)}else throw new Error("Invalid broker/template selection");if(se.needsWarning&&se.warningData){let Ee=se.warningData,at=async()=>{x(!0),r("processing");try{let it=await F.importWithTemplate(n,re,Fe,!0);if(S({success:it.success,importedCount:it.imported,duplicateCount:it.duplicates,errors:[...it.errors.map(Jr=>({row:0,error:Jr})),...it.failedRows.map(({row:Jr,reason:Hn})=>({row:Jr,error:Hn}))],importedTrades:it.importedTrades,accountName:it.accountName,brokerType:it.brokerType}),r("complete"),it.success){let Jr=it.duplicates>0?`Imported ${it.imported} trades, skipped ${it.duplicates} duplicates`:`Successfully imported ${it.imported} trades!`;new Go.Notice(Jr)}}catch(it){S({success:!1,importedCount:0,duplicateCount:0,errors:[{row:0,error:it instanceof Error?it.message:"Unknown error occurred"}]}),r("complete"),new Go.Notice("Import failed: "+(it instanceof Error?it.message:"Unknown error"))}finally{x(!1)}};z(Ee),A(()=>at),new lN({app:e.app,onClose:U,onProceed:async()=>{await at(),z(null),A(null)},missingFields:Ee}).open(),x(!1);return}if(se.unmappedSymbols&&se.unmappedSymbols.length>0&&new cN({app:e.app,plugin:e,symbols:se.unmappedSymbols,specService:e.specService,onMappingsCreated:at=>{new Go.Notice(`Created ${at} symbol mapping${at!==1?"s":""}`)},onSkip:()=>{new Go.Notice("Skipped symbol mapping")}}).open(),S({success:se.success,importedCount:se.imported,duplicateCount:se.duplicates,errors:[...se.errors.map(Ee=>({row:0,error:Ee})),...se.failedRows.map(({row:Ee,reason:at})=>({row:Ee,error:at}))],importedTrades:se.importedTrades,accountName:se.accountName,brokerType:se.brokerType,unmappedSymbols:se.unmappedSymbols}),r("complete"),se.success){let Ee=se.duplicates>0?`Imported ${se.imported} trades, skipped ${se.duplicates} duplicates`:`Successfully imported ${se.imported} trades!`;new Go.Notice(Ee)}else new Go.Notice("Import failed: "+(se.errors.join(", ")||"Unknown error"))}catch(se){console.error("Import error:",se),S({success:!1,importedCount:0,duplicateCount:0,errors:[{row:0,error:se instanceof Error?se.message:"Unknown error occurred"}]}),r("complete"),new Go.Notice("Import failed: "+(se instanceof Error?se.message:"Unknown error"))}finally{x(!1)}},[a,m,u,n,c,g,h,F,_,G,s,e.app,U]),J=(0,me.useCallback)((se,Fe)=>{new Go.Notice(`Template saved. You can now select "${Fe}" for future imports.`),D(re=>re+1)},[]),ee=(0,me.useCallback)(async()=>{if(!(!c||!N))try{await M.updateTemplate(c.id,{column_mappings:g,asset_type:h}),new Go.Notice(`Template "${c.name}" updated successfully`),E(g),B(!1),d({...c,column_mappings:g,asset_type:h})}catch(se){console.error("Failed to update template:",se),new Go.Notice("Failed to update template: "+(se instanceof Error?se.message:"Unknown error"))}},[c,N,g,h,M]),te=(0,me.useCallback)(()=>{new rN({app:e.app,columnMappings:g,assetType:h,onSave:J,onCancel:()=>{},localTemplateService:M}).open()},[e.app,g,h,J,M]),ue=(0,me.useCallback)(se=>{D(Fe=>Fe+1),new Go.Notice(`Template "${se}" imported successfully`)},[]),be=(0,me.useCallback)(()=>{new iN({app:e.app,localTemplateService:M,onClose:()=>{},onImportSuccess:ue}).open()},[e.app,M,ue]),Le=(0,me.useCallback)(async()=>{if(c)try{await M.deleteTemplate(c.id),new Go.Notice(`Template "${c.name}" deleted`),i(null),d(null),D(se=>se+1)}catch(se){throw new Go.Notice("Failed to delete template: "+(se instanceof Error?se.message:"Unknown error")),se}},[c,M]),$e=(0,me.useCallback)(()=>{c&&new aN({app:e.app,template:c,onClose:()=>{}}).open()},[c,e.app]),oe=(0,me.useCallback)(async()=>{if(!c)return;new sN({app:e.app,template:c,onConfirm:Le,onCancel:()=>{}}).open()},[c,e.app,Le]),ge=(0,me.useCallback)(async()=>{I&&await I(),z(null),A(null)},[I]),Se=(0,me.useCallback)(()=>{r("select"),p(null),f(null),i(null),l(!1),d(null),v({}),y("stock"),T(null),S(null),E({}),B(!1)},[]),De=(0,me.useMemo)(()=>n&&a,[n,a]);return me.default.createElement("div",{className:"journalit-csv-import"},me.default.createElement("div",{className:"csv-import-header"},me.default.createElement("h2",null,"Import Trades from CSV"),me.default.createElement("p",null,"Upload your broker's CSV file to import trades into your journal.")),me.default.createElement("div",{className:"csv-import-content"},t!=="complete"&&t!=="mapping"&&me.default.createElement("div",{className:`csv-selection-section ${a&&HS(a)?"csv-selection-section--with-guide":""}`},me.default.createElement("div",{className:"csv-selection-section__left"},me.default.createElement(sme,{plugin:e,selectedAccountName:n,onAccountSelect:W}),n&&me.default.createElement(me.default.Fragment,null,me.default.createElement(cme,{selectedValue:a,onSelect:$,onTemplateLoad:H,localTemplateService:M,refreshTrigger:P}),a&&a.startsWith("template-")&&c&&me.default.createElement("div",{className:"csv-template-actions",style:{marginTop:"12px",display:"flex",gap:"8px"}},me.default.createElement("button",{className:"csv-button csv-button-secondary",onClick:$e},"Export Template"),me.default.createElement("button",{className:"csv-button csv-button-secondary",onClick:oe,style:{color:"var(--text-error)"}},"Delete Template")),me.default.createElement("div",{className:"csv-template-actions",style:{marginTop:"12px"}},me.default.createElement("button",{className:"csv-button csv-button-secondary",onClick:be},"Import Template")))),a&&HS(a)&&me.default.createElement("div",{className:"csv-selection-section__right"},me.default.createElement(Fv,{title:"How to Export from Your Broker",defaultOpen:!0,className:"centered-title broker-guide-prominent"},me.default.createElement(t6,{brokerType:a})))),De&&t==="select"&&me.default.createElement("div",{className:"csv-upload-section"},me.default.createElement(pme,{onFileSelect:R,disabled:b})),b&&t!=="processing"&&me.default.createElement("div",{className:"csv-loading"},me.default.createElement("div",{className:"csv-spinner"}),me.default.createElement("span",null,"Processing CSV file...")),m&&t==="preview"&&me.default.createElement("div",{className:"csv-preview-section"},me.default.createElement(fme,{data:m,maxRows:10}),c&&me.default.createElement("div",{style:{marginTop:"16px",padding:"12px",backgroundColor:"var(--background-secondary)",borderRadius:"4px"}},me.default.createElement("span",{style:{color:"var(--text-muted)",fontSize:"0.9em"}},"Import Format: "),me.default.createElement("strong",null,c.name)),a==="TRADINGVIEW"&&me.default.createElement("div",{className:"asset-type-selector"},me.default.createElement("h3",null,"Asset Type ",me.default.createElement("span",{className:"csv-required"},"*")),me.default.createElement("p",{className:"csv-helper-text"},"Select the type of instrument in this CSV. This determines contract specifications and validation rules."),me.default.createElement("div",{className:"asset-type-buttons"},me.default.createElement("button",{className:`asset-type-button ${h==="stock"?"active":""}`,onClick:()=>X("stock")},"Stock"),me.default.createElement("button",{className:`asset-type-button ${h==="options"?"active":""}`,onClick:()=>X("options")},"Options"),me.default.createElement("button",{className:`asset-type-button ${h==="futures"?"active":""}`,onClick:()=>X("futures")},"Futures"),me.default.createElement("button",{className:`asset-type-button ${h==="forex"?"active":""}`,onClick:()=>X("forex")},"Forex"),me.default.createElement("button",{className:`asset-type-button ${h==="crypto"?"active":""}`,onClick:()=>X("crypto")},"Crypto"))),me.default.createElement("div",{className:"csv-import-actions",style:{display:"flex",gap:"12px",marginTop:"24px"}},HS(a)?me.default.createElement("button",{className:"csv-button csv-button-primary",onClick:Q,disabled:b},b?"Processing...":`Import ${m.rowCount} Rows`):c&&G?me.default.createElement(me.default.Fragment,null,me.default.createElement("button",{className:"csv-button csv-button-secondary",onClick:V},"Edit Format"),me.default.createElement("button",{className:"csv-button csv-button-primary",onClick:Q,disabled:b},b?"Processing...":`Import ${m.rowCount} Rows`)):me.default.createElement("button",{className:"csv-button csv-button-primary",onClick:V},"Continue to Column Mapping"),me.default.createElement("button",{className:"csv-button csv-button-secondary",onClick:Se,disabled:b},"Cancel"))),m&&t==="mapping"&&me.default.createElement("div",{className:"csv-mapping-section"},me.default.createElement(wme,{csvHeaders:m.headers,sampleRows:m.rows,onMappingsSuggested:Z,disabled:b}),me.default.createElement(yme,{csvHeaders:m.headers,initialMappings:g,initialAssetType:h,onMappingsChange:K,onAssetTypeChange:X,sampleRows:m.rows}),me.default.createElement("div",{className:"csv-import-actions",style:{display:"flex",gap:"12px",marginTop:"24px"}},me.default.createElement("button",{className:"csv-button csv-button-primary",onClick:Q,disabled:b||!G},b?"Processing...":`Import ${m.rowCount} Rows`),c&&N&&G?me.default.createElement("button",{className:"csv-button csv-button-secondary",onClick:ee,disabled:b},"Update Template"):!c&&G?me.default.createElement("button",{className:"csv-button csv-button-secondary",onClick:te,disabled:b},"Save as Template"):null,me.default.createElement("button",{className:"csv-button csv-button-secondary",onClick:()=>r("preview"),disabled:b},"Back"))),t==="processing"&&me.default.createElement("div",{className:"csv-loading"},me.default.createElement("div",{className:"csv-spinner"}),me.default.createElement("span",null,"Importing trades to account...")),t==="complete"&&w&&me.default.createElement("div",{className:"csv-import-results"},me.default.createElement("h3",null,w.success?"Import Complete":"Import Failed"),w.importedCount>0&&me.default.createElement("div",{className:"result-item result-success"},me.default.createElement(Gp,{className:"result-icon",size:20}),me.default.createElement("span",{className:"result-text"},"Successfully imported ",w.importedCount," trade",w.importedCount!==1?"s":""," to Account: ",me.default.createElement("strong",null,w.accountName||n))),w.duplicateCount>0&&me.default.createElement("div",{className:"result-item result-warning"},me.default.createElement(lo,{className:"result-icon",size:20}),me.default.createElement("span",{className:"result-text"},"Skipped ",w.duplicateCount," duplicate trade",w.duplicateCount!==1?"s":""," (already in vault)")),w.success&&w.brokerType&&me.default.createElement("div",{className:"result-item result-info"},me.default.createElement("span",{className:"result-text",style:{fontSize:"13px",opacity:.8}},"Broker: ",w.brokerType)),w.importedTrades&&w.importedTrades.length>0&&me.default.createElement("div",{className:"imported-trades-preview"},me.default.createElement("div",{className:"preview-header"},"Recently Imported Trades (showing ",Math.min(5,w.importedTrades.length)," of ",w.importedCount,")"),me.default.createElement("div",{className:"csv-trades-list"},w.importedTrades.map((se,Fe)=>{var it,Jr,Hn,es,ei,rn,Ai,Ms;let re=(Hn=(Jr=(it=e==null?void 0:e.settings)==null?void 0:it.trade)==null?void 0:Jr.displayRMultiples)!=null?Hn:!1,Ee=(ei=(es=e==null?void 0:e.settings)==null?void 0:es.trade)==null?void 0:ei.defaultRiskAmount,at=(Ms=(Ai=(rn=e==null?void 0:e.settings)==null?void 0:rn.general)==null?void 0:Ai.currency)!=null?Ms:"USD";return me.default.createElement("div",{key:Fe,className:"csv-trade-preview-item",onClick:async()=>{try{if(!se.filePath||se.filePath.trim()===""){console.error("Cannot navigate to trade: No valid file path found",se);return}e&&e.openFile?await e.openFile(se.filePath,!1):e!=null&&e.app?await e.app.workspace.openLinkText(se.filePath,"",!1):console.error("Cannot navigate to trade: Plugin context not available")}catch(ul){console.error("Error navigating to trade:",ul,{path:se.filePath,trade:se})}}},me.default.createElement("span",{className:"csv-trade-symbol"},se.symbol),me.default.createElement("span",{className:"csv-trade-date"},new Date(se.entryTime).toLocaleDateString()),me.default.createElement("span",{className:`csv-trade-direction ${se.direction}`},se.direction==="long"?me.default.createElement(xc,{size:14}):me.default.createElement(Fw,{size:14}),se.direction.toUpperCase()),me.default.createElement("span",{className:"csv-trade-quantity"},se.quantity," @ ",ha(se.entryPrice,!1,at)),me.default.createElement("span",{className:`csv-trade-status ${se.status.toLowerCase()}`},se.profitLoss!==void 0&&se.profitLoss!==0?ve(se.profitLoss,!0,at,re,re?se.profitLoss/(Ee||1):void 0):se.status))}),w.importedCount>5&&me.default.createElement("div",{className:"trade-preview-more"},"and ",w.importedCount-5," more trade",w.importedCount-5!==1?"s":"","..."))),w.errors.length>0&&me.default.createElement("div",{className:"import-results-errors"},me.default.createElement("div",{className:"error-header"},"Errors (",w.errors.length,")"),me.default.createElement("div",{className:"error-list"},w.errors.map((se,Fe)=>me.default.createElement("div",{key:Fe,className:"error-item"},se.row>0?`Row ${se.row}: `:"",se.error)))),me.default.createElement("div",{className:"csv-actions"},w.accountName&&me.default.createElement("button",{className:"csv-button csv-button-primary",onClick:async()=>{await e.viewManager.openAccountPageView(w.accountName)}},"View in Account"),me.default.createElement("button",{className:"csv-button csv-button-secondary",onClick:Se},"Import Another File")))))})});var gfe,od,mN,hfe=L(()=>{gfe=q(Y());Xf();ffe();m1();od="journalit-csv-import-view",mN=class extends us{constructor(t,r){super(t,{containerClass:"journalit-csv-import-view-container",rootId:"journalit-csv-import-view"}),this.plugin=r}getViewType(){return od}getDisplayText(){return"CSV Import"}getIcon(){return"import"}async onOpen(){this.containerEl.addClass("react-view-container");try{await super.onOpen(),p1(),this.containerEl.addClass("journalit-csv-import-container")}catch(t){console.error("[CSVImportView] Failed to initialize:",t)}}getRenderFunction(){return()=>gfe.default.createElement(mfe,{plugin:this.plugin})}}});var vfe={};Ko(vfe,{ACCOUNT_DASHBOARD_VIEW_TYPE:()=>vp,ViewManager:()=>m6});var vp,m6,yfe=L(()=>{cR();Yue();Gpe();ame();SS();hfe();Td();vp="account-dashboard",m6=class e{constructor(t){this.registeredViews=new Set;this.plugin=t}static getInstance(t){return e.instance||(e.instance=new e(t)),e.instance}async registerAllViews(){}async registerDashboardView(){if(!this.registeredViews.has(cl))try{let t=this.plugin.app.workspace.getLeavesOfType(cl);t.length>0&&(console.log("[Journalit] Cleaning up existing dashboard view leaves before registration"),t.forEach(r=>r.detach())),this.plugin.registerView(cl,r=>new mS(r)),this.registeredViews.add(cl),console.log("[Journalit] Dashboard view registered successfully")}catch(t){console.error("[Journalit] Failed to register dashboard view:",t)}}async registerAccountDashboardView(){if(!this.registeredViews.has(vp))try{let t=this.plugin.app.workspace.getLeavesOfType(vp);t.length>0&&(console.log("[Journalit] Cleaning up existing account dashboard view leaves before registration"),t.forEach(r=>r.detach())),this.plugin.registerView(vp,r=>new qL(r,this.plugin)),this.registeredViews.add(vp),console.log("[Journalit] Account dashboard view registered successfully")}catch(t){console.error("[Journalit] Failed to register account dashboard view:",t)}}async registerTradeLogView(){if(!this.registeredViews.has(iu))try{let t=this.plugin.app.workspace.getLeavesOfType(iu);t.length>0&&(console.log("[Journalit] Cleaning up existing trade log view leaves before registration"),t.forEach(r=>r.detach())),this.plugin.registerView(iu,r=>new ZL(r,this.plugin)),this.registeredViews.add(iu),console.log("[Journalit] Trade log view registered successfully")}catch(t){console.error("[Journalit] Failed to register trade log view:",t)}}async registerHomeView(){if(!this.registeredViews.has(Ti))try{let t=this.plugin.app.workspace.getLeavesOfType(Ti);t.length>0&&(console.log("[Journalit] Cleaning up existing home view leaves before registration"),t.forEach(r=>r.detach())),this.plugin.registerView(Ti,r=>new JA(r,this.plugin)),this.registeredViews.add(Ti),console.log("[Journalit] Home view registered successfully")}catch(t){console.error("[Journalit] Failed to register home view:",t)}}async registerCSVImportView(){if(!this.registeredViews.has(od))try{this.plugin.app.workspace.getLeavesOfType(od).length===0?(this.plugin.registerView(od,r=>new mN(r,this.plugin)),this.registeredViews.add(od)):this.registeredViews.add(od)}catch(t){console.error("Error registering CSV import view:",t)}}async registerTradeFormView(){}async openDashboardView(){await this.registerDashboardView();let t=this.plugin.app.workspace.getLeavesOfType(cl);if(t.length>0){this.plugin.app.workspace.revealLeaf(t[0]),typeof this.plugin.trackRecentView=="function"&&this.plugin.trackRecentView(cl,"Trading Dashboard","grip");return}let r=this.plugin.app.workspace.getLeaf("tab");r&&(await r.setViewState({type:cl,active:!0}),this.plugin.app.workspace.revealLeaf(r),typeof this.plugin.trackRecentView=="function"&&this.plugin.trackRecentView(cl,"Trading Dashboard","grip"))}async openAccountDashboardView(){await this.registerAccountDashboardView();let t=this.plugin.app.workspace.getLeavesOfType(vp);if(t.length>0){this.plugin.app.workspace.revealLeaf(t[0]),typeof this.plugin.trackRecentView=="function"&&this.plugin.trackRecentView(vp,"Account Dashboard","users");return}let r=this.plugin.app.workspace.getLeaf("tab");r&&(await r.setViewState({type:vp,active:!0}),this.plugin.app.workspace.revealLeaf(r),typeof this.plugin.trackRecentView=="function"&&this.plugin.trackRecentView(vp,"Account Dashboard","users"))}async openTradeLogView(){await this.registerTradeLogView();let t=this.plugin.app.workspace.getLeavesOfType(iu);if(t.length>0){this.plugin.app.workspace.revealLeaf(t[0]),typeof this.plugin.trackRecentView=="function"&&this.plugin.trackRecentView(iu,"Trade Log","folder-tree");return}let r=this.plugin.app.workspace.getLeaf("tab");r&&(await r.setViewState({type:iu,active:!0}),this.plugin.app.workspace.revealLeaf(r),typeof this.plugin.trackRecentView=="function"&&this.plugin.trackRecentView(iu,"Trade Log","folder-tree"))}async openHomeView(){await this.registerHomeView();let t=this.plugin.app.workspace.getLeavesOfType(Ti);if(t.length>0){let n=t[0].view;if(n&&n.getViewType()===Ti){this.plugin.app.workspace.revealLeaf(t[0]);return}else console.log("[Journalit] Detaching broken home view leaf"),t[0].detach()}let r=this.plugin.app.workspace.getLeaf("tab");if(r)try{await r.setViewState({type:Ti,active:!0}),this.plugin.app.workspace.revealLeaf(r)}catch(n){throw console.error("[Journalit] Failed to open home view:",n),n}}async openCSVImportView(){await this.registerCSVImportView();let t=this.plugin.app.workspace.getLeavesOfType(od);if(t.length>0){this.plugin.app.workspace.revealLeaf(t[0]),typeof this.plugin.trackRecentView=="function"&&this.plugin.trackRecentView(od,"CSV Import","import");return}let r=this.plugin.app.workspace.getLeaf("tab");r&&(await r.setViewState({type:od,active:!0}),this.plugin.app.workspace.revealLeaf(r),typeof this.plugin.trackRecentView=="function"&&this.plugin.trackRecentView(od,"CSV Import","import"))}async registerAccountPageView(){if(!this.registeredViews.has(ed))try{let t=this.plugin.app.workspace.getLeavesOfType(ed);t.length>0&&(console.log("[Journalit] Cleaning up existing account page view leaves before registration"),t.forEach(r=>r.detach())),this.plugin.registerView(ed,r=>new nx(r)),this.registeredViews.add(ed),console.log("[Journalit] Account page view registered successfully")}catch(t){console.error("[Journalit] Failed to register account page view:",t)}}async openAccountPageView(t){await this.registerAccountPageView();let r=this.plugin.app.workspace.getLeavesOfType(ed);for(let o of r){let a=o.view;if(a instanceof nx&&typeof a.getAccountName=="function"&&a.getAccountName()===t){this.plugin.app.workspace.revealLeaf(o),typeof this.plugin.trackRecentView=="function"&&this.plugin.trackRecentView(ed,`Account: ${t}`,"user");return}}let n=this.plugin.app.workspace.getLeaf("tab");n&&(await n.setViewState({type:ed,active:!0,state:{accountName:t}}),this.plugin.app.workspace.revealLeaf(n),typeof this.plugin.trackRecentView=="function"&&this.plugin.trackRecentView(ed,`Account: ${t}`,"user"))}async closeAccountPageViews(t){let r=this.plugin.app.workspace.getLeavesOfType(ed);for(let n of r){let o=n.view;o instanceof nx&&typeof o.getAccountName=="function"&&o.getAccountName()===t&&n.detach()}}async navigateToAccountDashboard(){await this.openAccountDashboardView()}async openTradeFormView(t){new jo({app:this.plugin.app,plugin:this.plugin,isEditMode:!1,initialData:t||{},filePath:""}).open()}async openTradeFormInEditMode(t,r){new jo({app:this.plugin.app,plugin:this.plugin,isEditMode:!0,initialData:t||{},filePath:r||""}).open()}isViewRegistered(t){return this.registeredViews.has(t)}cleanupViews(){try{for(let t of this.registeredViews)this.plugin.app.workspace.getLeavesOfType(t).forEach(r=>{r.detach()});this.registeredViews.clear(),e.instance=null}catch(t){console.error("Error cleaning up views:",t)}}}});function FBe(e){if(!e||typeof e!="string")return null;let t=e.trim().toUpperCase();if(t.length===0)return null;for(let o of LBe)if(t.startsWith(o)){let a=t.substring(o.length);if(a.length===0)return{baseSymbol:o,isMicro:!0};let i=IBe.find(s=>a.startsWith(s));if(i){let s=a.substring(1),l=s&&/^\d{1,2}$/.test(s)?s:void 0;return{baseSymbol:o,monthCode:i,year:l,isMicro:!0}}return null}let r=t.match(NBe);if(r){let[,o,a,i]=r;return{baseSymbol:o,monthCode:a,year:i,isMicro:!1}}let n=t.match(MBe);return n?{baseSymbol:n[1],isMicro:!1}:null}function bfe(e){let t=FBe(e);return t?t.baseSymbol:e}var IBe,ABe,LBe,NBe,MBe,xfe=L(()=>{IBe=["F","G","H","J","K","M","N","Q","U","V","X","Z"],ABe=["M2K","MES","MNQ","MYM","MGC","MCL","M6E","M6B","M6J","M6A","M6C","M6S"],LBe=[...ABe].sort((e,t)=>t.length-e.length),NBe=/^(?=.*[A-Z])([A-Z0-9]{1,4})([FGHJKMNQUVXZ])(\d{1,2})$/,MBe=/^(?=.*[A-Z])([A-Z0-9]{1,4})$/});var wfe={};Ko(wfe,{InstrumentSpecService:()=>fN,default:()=>OBe});var fN,OBe,kfe=L(()=>{o6();xfe();fN=class{constructor(t){this.plugin=t,this.customMappings=new Map,this.customInstrumentsCache=new Map,this.boundOptionsChangeHandler=()=>this.refreshCustomInstrumentsCache(),document.addEventListener("journalit-options-changed",this.boundOptionsChangeHandler)}dispose(){document.removeEventListener("journalit-options-changed",this.boundOptionsChangeHandler),this.customMappings.clear(),this.customInstrumentsCache.clear()}loadMappings(){var n;let t=this.plugin,r=((n=t.settings)==null?void 0:n.symbolMappings)||[];this.customMappings.clear();for(let o of r)this.customMappings.set(o.importedSymbol.toUpperCase(),o.baseSymbol.toUpperCase());if(this.customInstrumentsCache.clear(),t.optionsService){let a=t.optionsService.getAllOptions().instrument||[];for(let i of a){let s=`${i.name.toUpperCase()}_${i.assetType}`;this.customInstrumentsCache.set(s,i)}}}refreshCustomInstrumentsCache(){let t=this.plugin;if(this.customInstrumentsCache.clear(),t.optionsService){let n=t.optionsService.getAllOptions().instrument||[];for(let o of n){let a=`${o.name.toUpperCase()}_${o.assetType}`;this.customInstrumentsCache.set(a,o)}}}getSpecsForSymbol(t,r){if(!t||!r)return null;let n=t.toUpperCase(),o=`${n}_${r}`,a=this.customInstrumentsCache.get(o);if(a){if(r==="futures"&&a.futuresData){let s=a.futuresData;if(s.dollarPerPoint&&s.dollarPerPoint>0&&s.tickSize&&s.tickSize>0&&s.tickValue&&s.tickValue>0)return{dollarPerPoint:s.dollarPerPoint,tickSize:s.tickSize,tickValue:s.tickValue,name:a.name,exchange:void 0}}else if(r==="forex"&&a.forexData){let s=a.forexData;if(s.lotSize&&s.lotSize>0&&s.pipValue&&s.pipValue>0&&s.pipSize&&s.pipSize>0)return{lotSize:s.lotSize,pipValue:s.pipValue,pipSize:s.pipSize,name:a.name}}}let i=r==="futures"?ox:r==="forex"?ax:null;if(!i)return null;if(i[n])return i[n];if(this.customMappings.has(n)){let s=this.customMappings.get(n);if(i[s])return i[s];console.warn(`InstrumentSpecService: Custom mapping ${n} \u2192 ${s} points to non-existent symbol. Update mapping in Settings > Custom Options > Symbol Mappings.`)}if(r==="futures"){let s=bfe(n);if(s&&s!==n&&i[s])return i[s]}return null}async saveMapping(t,r,n){if(!(t!=null&&t.trim())||!(r!=null&&r.trim()))return console.warn("InstrumentSpecService: Both importedSymbol and baseSymbol are required"),!1;let o=t.trim().toUpperCase(),a=r.trim().toUpperCase();!ox[a]&&!ax[a]&&console.warn(`InstrumentSpecService: Base symbol "${a}" not found in specs database. Mapping will be saved but lookups will fail. Available futures: ${Object.keys(ox).join(", ")}. Available forex: ${Object.keys(ax).join(", ")}`);let i=this.plugin;i.settings.symbolMappings||(i.settings.symbolMappings=[]);let s=i.settings.symbolMappings.findIndex(u=>u.importedSymbol.toUpperCase()===o),l=s!==-1?i.settings.symbolMappings[s]:void 0,c=this.customMappings.get(o),d={importedSymbol:o,baseSymbol:a,autoDetected:n,dateCreated:new Date().toISOString()};this.customMappings.set(o,a),s!==-1?i.settings.symbolMappings[s]=d:i.settings.symbolMappings.push(d);try{return await i.saveSettings(),!0}catch(u){return console.error(`InstrumentSpecService: Failed to persist symbol mapping "${o}" -> "${a}":`,u),c!==void 0?this.customMappings.set(o,c):this.customMappings.delete(o),l!==void 0?i.settings.symbolMappings[s]=l:i.settings.symbolMappings.pop(),!1}}getAllMappings(){var r;return((r=this.plugin.settings)==null?void 0:r.symbolMappings)||[]}async deleteMapping(t){let r=t==null?void 0:t.trim();if(!r)return;let n=r.toUpperCase(),o=this.plugin;if(!o.settings.symbolMappings){this.customMappings.delete(n);return}let a=this.customMappings.get(n),i=[...o.settings.symbolMappings];this.customMappings.delete(n);let s=o.settings.symbolMappings.filter(l=>l.importedSymbol.toUpperCase()!==n);o.settings.symbolMappings=s;try{await o.saveSettings()}catch(l){throw console.error(`InstrumentSpecService: Failed to persist deletion of mapping "${n}":`,l),a!==void 0&&this.customMappings.set(n,a),o.settings.symbolMappings=i,l}}},OBe=fN});var gN,hN,Sfe=L(()=>{gN=q(Y()),hN=({url:e,label:t,iconRef:r})=>gN.default.createElement("button",{onClick:()=>window.open(e,"_blank"),style:{background:"var(--background-secondary)",color:"var(--text-normal)",border:"1px solid var(--background-modifier-border)",borderRadius:"6px",padding:"6px 12px",fontSize:"12px",fontWeight:"500",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",transition:"all 0.2s ease"},onMouseEnter:n=>{n.currentTarget.style.background="var(--background-modifier-hover)"},onMouseLeave:n=>{n.currentTarget.style.background="var(--background-secondary)"}},gN.default.createElement("span",{ref:r,style:{width:"14px",height:"14px",display:"flex",alignItems:"center",justifyContent:"center"}}),gN.default.createElement("span",null,t))});function Pfe(e,t,r,n,o,a,i){new f6({app:e,plugin:t,oldPath:r,newPath:n,hasExistingTrades:o,onConfirm:a,onCancel:i||(()=>{}),onClose:()=>{}}).open()}var Tfe,Lr,Cfe,f6,jBe,Dfe=L(()=>{Tfe=require("obsidian"),Lr=q(Y()),Cfe=q(wn());er();Nr();f6=class extends Tfe.Modal{constructor(t){super(t.app),this.props=t}onOpen(){let{contentEl:t}=this;t.empty(),this.container=t.createDiv(),this.root=(0,Cfe.createRoot)(this.container),this.root.render(Lr.default.createElement(jBe,{...this.props,onClose:()=>this.close()})),t.addClass("path-change-instruction-modal"),t.classList.add("jl-modal-container")}onClose(){this.root&&this.root.unmount()}},jBe=({app:e,plugin:t,oldPath:r,newPath:n,hasExistingTrades:o,onConfirm:a,onCancel:i,onClose:s})=>Lr.default.createElement("div",{style:{fontFamily:"var(--default-font)",fontSize:"14px",lineHeight:"1.5"}},Lr.default.createElement("div",{style:{display:"flex",alignItems:"center",marginBottom:"20px",paddingBottom:"15px",borderBottom:"1px solid var(--background-modifier-border)"}},Lr.default.createElement(ww,{size:24,style:{marginRight:"10px",color:"var(--text-accent)"}}),Lr.default.createElement("h2",{style:{margin:0,color:"var(--text-normal)"}},"Journal Folder Location Changed")),Lr.default.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:"20px",padding:"15px",backgroundColor:"var(--background-secondary)",borderRadius:"8px"}},Lr.default.createElement("code",{style:{padding:"4px 8px",backgroundColor:"var(--background-primary)",borderRadius:"4px",fontFamily:"var(--font-monospace)"}},r),Lr.default.createElement(sw,{size:16,style:{margin:"0 15px",color:"var(--text-muted)"}}),Lr.default.createElement("code",{style:{padding:"4px 8px",backgroundColor:"var(--background-primary)",borderRadius:"4px",fontFamily:"var(--font-monospace)"}},n)),Lr.default.createElement("div",{style:{marginBottom:"25px"}},Lr.default.createElement("div",{style:{display:"flex",alignItems:"flex-start",marginBottom:"15px",padding:"12px",backgroundColor:"var(--background-secondary)",borderRadius:"6px",border:"1px solid var(--color-accent)"}},Lr.default.createElement(Xp,{size:16,style:{marginRight:"8px",marginTop:"2px",color:"var(--color-accent)",flexShrink:0}}),Lr.default.createElement("div",null,Lr.default.createElement("strong",{style:{color:"var(--text-normal)"}},"New trades will be created in your new folder location"),Lr.default.createElement("div",{style:{color:"var(--text-muted)",marginTop:"4px"}},"All future trading journals will use: ",Lr.default.createElement("code",{style:{fontSize:"12px",backgroundColor:"var(--background-primary)",padding:"2px 4px",borderRadius:"3px"}},n)))),o&&Lr.default.createElement("div",{style:{padding:"12px",backgroundColor:"var(--background-secondary)",borderRadius:"6px",marginBottom:"15px"}},Lr.default.createElement("strong",{style:{color:"var(--text-normal)",display:"block",marginBottom:"8px"}},"Manual Action Required:"),Lr.default.createElement("div",{style:{color:"var(--text-muted)",marginBottom:"8px"}},"You have existing trades in your current folder. To move them:"),Lr.default.createElement("ol",{style:{color:"var(--text-muted)",marginLeft:"16px",paddingLeft:"0"}},Lr.default.createElement("li",{style:{marginBottom:"4px"}},"Open your vault's file explorer"),Lr.default.createElement("li",{style:{marginBottom:"4px"}},"Find your ",Lr.default.createElement("code",{style:{fontSize:"12px",backgroundColor:"var(--background-primary)",padding:"2px 4px",borderRadius:"3px"}},"!Journalit")," folder"),Lr.default.createElement("li",{style:{marginBottom:"4px"}},"Drag and drop it to your new location when convenient")),Lr.default.createElement("div",{style:{color:"var(--text-muted)",fontSize:"13px",fontStyle:"italic",marginTop:"8px"}},"This gives you full control over when and how your files are moved.")),Lr.default.createElement("div",{style:{marginTop:"1em",padding:"0.75em",backgroundColor:"var(--background-secondary)",borderRadius:"4px"}},Lr.default.createElement("strong",null,"Sync Mapping Update:"),Lr.default.createElement("div",{style:{marginTop:"0.5em",fontSize:"0.9em"}},"The plugin will automatically update your trade sync mappings to reflect the new folder path. This ensures your synced trades remain connected to their backend records."))),Lr.default.createElement("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",borderTop:"1px solid var(--background-modifier-border)",paddingTop:"15px"}},Lr.default.createElement(he,{variant:"secondary",onClick:()=>{i(),s()},style:{minWidth:"80px"}},"Cancel"),Lr.default.createElement(he,{variant:"primary",onClick:()=>{a(),s()},style:{minWidth:"120px"}},"I Understand")))});var vN,Efe=L(()=>{vN=class{constructor(t,r){this.app=t;this.tradeService=r}getImageBasePaths(t,r){let n=new Set,o=this.app.metadataCache.getFileCache(t),a=o==null?void 0:o.frontmatter;if(!a)return n;let i=r.replace(/\/$/,"")+"/",s=c=>{if(typeof c!="string")return null;let d=c.match(/^(.+?)\/\d{4}\/(?:\d{2}\/)?(?:W\d+\/)?media\//);return d?d[1]:null},l=c=>{if(c!=null&&c.images&&Array.isArray(c.images)){for(let d of c.images)if(typeof d=="string"){let u=s(d);u&&n.add(u)}}};if(a.images&&Array.isArray(a.images)){for(let c of a.images)if(typeof c=="string"){let d=s(c);d&&n.add(d)}}if(a.type==="drc"){if(a.forecast&&typeof a.forecast=="object")for(let c of Object.keys(a.forecast)){if(c==="bias"||c==="levels"||c==="keyLevels")continue;let d=a.forecast[c];c==="customTimeframes"&&typeof d=="object"?Object.values(d).forEach(l):l(d)}a.endOfDayReview&&l(a.endOfDayReview),a.missedTrades&&Array.isArray(a.missedTrades)&&a.missedTrades.forEach(l)}if(a.type==="weekly-review"&&a.forecast&&typeof a.forecast=="object")for(let c of Object.keys(a.forecast)){let d=a.forecast[c];c==="customTimeframes"&&typeof d=="object"?Object.values(d).forEach(l):l(d)}if(i){let c=new Set;for(let d of n)d!==i.replace(/\/$/,"")&&c.add(d);return c}return n}updateImagesArray(t,r,n){if(!t||!Array.isArray(t))return{updated:[],hasChanges:!1};let o=t.filter(s=>typeof s=="string"),a=!1;return{updated:o.map(s=>s.startsWith(r)?(a=!0,s.replace(r,n)):s),hasChanges:a}}updateForecastSection(t,r,n){if(!t||typeof t!="object")return!1;let o=!1;if(t.images){let a=this.updateImagesArray(t.images,r,n);a.hasChanges&&(t.images=a.updated,o=!0)}return o}async updateImagePathsForAllTrades(t,r,n){let o={success:0,failed:0,updated:0,errors:[]},a=t.replace(/\/$/,"")+"/",i=r.replace(/\/$/,"")+"/",s=this.app.vault.getMarkdownFiles(),l=[];for(let m of s){let f=this.app.metadataCache.getFileCache(m),g=f==null?void 0:f.frontmatter,v=!1;if(g!=null&&g.images&&Array.isArray(g.images)&&(v=g.images.filter(y=>typeof y=="string").some(y=>y.startsWith(a))),!v&&(g==null?void 0:g.type)==="drc"){let h=y=>y!=null&&y.images&&Array.isArray(y.images)?y.images.some(b=>typeof b=="string"&&b.startsWith(a)):!1;if(g.forecast&&typeof g.forecast=="object")for(let y of Object.keys(g.forecast)){if(y==="bias"||y==="levels"||y==="keyLevels")continue;let b=g.forecast[y];if(y==="customTimeframes"&&typeof b=="object"?v=Object.values(b).some(h):v=h(b),v)break}!v&&g.endOfDayReview&&(v=h(g.endOfDayReview)),!v&&g.missedTrades&&Array.isArray(g.missedTrades)&&(v=g.missedTrades.some(y=>h(y)))}if(!v&&(g==null?void 0:g.type)==="weekly-review"){let h=y=>y!=null&&y.images&&Array.isArray(y.images)?y.images.some(b=>typeof b=="string"&&b.startsWith(a)):!1;if(g.forecast&&typeof g.forecast=="object")for(let y of Object.keys(g.forecast)){let b=g.forecast[y];if(y==="customTimeframes"&&typeof b=="object"?v=Object.values(b).some(h):v=h(b),v)break}}v&&l.push(m)}let c=l.length,d=0,u=10,p=5;for(let m=0;m<l.length;m+=u){let f=l.slice(m,m+u);await Promise.all(f.map(async g=>{try{let v=this.app.metadataCache.getFileCache(g),h=v==null?void 0:v.frontmatter,y=!1,b=[];if(h!=null&&h.images&&Array.isArray(h.images)){let k=this.updateImagesArray(h.images,a,i);k.hasChanges&&(y=!0,b=k.updated)}let x=(h==null?void 0:h.type)==="drc",w=(h==null?void 0:h.type)==="weekly-review",S=!1;await this.app.fileManager.processFrontMatter(g,k=>{var T;if(y&&(k.images=b,S=!0),x){let P=!1;if(k.forecast&&typeof k.forecast=="object")for(let D of Object.keys(k.forecast)){if(D==="bias"||D==="levels"||D==="keyLevels")continue;let O=k.forecast[D];if(D==="customTimeframes"&&typeof O=="object")for(let z of Object.keys(O))this.updateForecastSection(O[z],a,i)&&(P=!0);else this.updateForecastSection(O,a,i)&&(P=!0)}if((T=k.endOfDayReview)!=null&&T.images){let D=this.updateImagesArray(k.endOfDayReview.images,a,i);D.hasChanges&&(k.endOfDayReview.images=D.updated,P=!0)}if(k.missedTrades&&Array.isArray(k.missedTrades)){for(let D of k.missedTrades)if(D&&typeof D=="object"&&D.images){let O=this.updateImagesArray(D.images,a,i);O.hasChanges&&(D.images=O.updated,P=!0)}}P&&(S=!0)}if(w){let P=!1;if(k.forecast&&typeof k.forecast=="object")for(let D of Object.keys(k.forecast)){let O=k.forecast[D];if(D==="customTimeframes"&&typeof O=="object")for(let z of Object.keys(O))this.updateForecastSection(O[z],a,i)&&(P=!0);else this.updateForecastSection(O,a,i)&&(P=!0)}P&&(S=!0)}}),S&&o.updated++,o.success++,d++,n&&n(d,c)}catch(v){o.failed++;let h=v instanceof Error?v.message:String(v);o.errors.push(`${g.path}: ${h}`),d++,n&&n(d,c)}})),m+u<l.length&&await new Promise(g=>setTimeout(g,p))}return o}}});var ae,ir,Ife,Afe=L(()=>{ae=q(Y()),ir=require("obsidian");ou();Sfe();vd();up();h4();Dfe();nm();TC();Efe();Ife=({plugin:e})=>{var M,_,W,$,H,R,V,Z,K,X,G,U,Q,J,ee,te,ue,be,Le,$e,oe,ge,Se,De,se,Fe;e.settings.general||(e.settings.general={currency:"USD"});let[t,r]=(0,ae.useState)(0),[n,o]=(0,ae.useState)(((M=e.settings.general)==null?void 0:M.displayName)||""),[a,i]=(0,ae.useState)(!1),[s,l]=(0,ae.useState)(((_=e.settings.general)==null?void 0:_.journalFolderPath)||""),[c,d]=(0,ae.useState)(!1),[u,p]=(0,ae.useState)(!1);(0,ae.useEffect)(()=>{var re;o(((re=e.settings.general)==null?void 0:re.displayName)||""),i(!1)},[(W=e.settings.general)==null?void 0:W.displayName,t]),(0,ae.useEffect)(()=>{var re;l(((re=e.settings.general)==null?void 0:re.journalFolderPath)||"")},[($=e.settings.general)==null?void 0:$.journalFolderPath,t]),(0,ae.useEffect)(()=>{var Ee;let re=!1;e.settings.trade.skipWeekends===void 0&&(e.settings.trade.skipWeekends=!0,re=!0),e.settings.trade.tradingDayCutoffTime===void 0&&(e.settings.trade.tradingDayCutoffTime="00:00",re=!0),e.settings.drc.autoCreateDRCOnNavigation===void 0&&(e.settings.drc.autoCreateDRCOnNavigation=!0,re=!0),e.settings.weekly.autoCreateWeeklyReviewOnNavigation===void 0&&(e.settings.weekly.autoCreateWeeklyReviewOnNavigation=!0,re=!0),((Ee=e.settings.monthly)==null?void 0:Ee.autoCreateMonthlyReviewOnNavigation)===void 0&&(e.settings.monthly?e.settings.monthly.autoCreateMonthlyReviewOnNavigation=!0:e.settings.monthly={reviewQuestions:[],customTimeframes:[],autoCreateOnFirstTrade:!0,autoCreateMonthlyReviewOnNavigation:!0},re=!0),re&&e.saveSettings()},[]);let m=[{value:"DDMMYY",label:"DD/MM/YY (31/12/23)"},{value:"MMDDYY",label:"MM/DD/YY (12/31/23)"},{value:"YYMMDD",label:"YY/MM/DD (23/12/31)"}],f=async re=>{e.settings.trade.autoOpenCreatedTrades=re,await e.saveSettings(),r(Ee=>Ee+1),new ir.Notice(`Auto-open created trades ${re?"enabled":"disabled"}`)},g=async re=>{e.settings.trade.dateFormat=re,await e.saveSettings(),new ir.Notice(`Trade note date format changed to ${re}`)},v=async re=>{e.settings.trade.skipWeekends=re,await e.saveSettings(),r(Ee=>Ee+1),new ir.Notice(`Skip weekends ${re?"enabled":"disabled"}`)},h=async re=>{let Ee=re.target.value;e.settings.trade.tradingDayCutoffTime=Ee,await e.saveSettings(),new ir.Notice(`Trading day cutoff time changed to ${Ee}`)},y=async re=>{e.settings.drc.autoCreateDRCOnNavigation=re,await e.saveSettings(),r(Ee=>Ee+1),new ir.Notice(`Auto-create DRC on navigation ${re?"enabled":"disabled"}`)},b=async re=>{e.settings.weekly.autoCreateWeeklyReviewOnNavigation=re,await e.saveSettings(),r(Ee=>Ee+1),new ir.Notice(`Auto-create Weekly Review on navigation ${re?"enabled":"disabled"}`)},x=async re=>{e.settings.monthly?e.settings.monthly.autoCreateMonthlyReviewOnNavigation=re:e.settings.monthly={reviewQuestions:[],customTimeframes:[],autoCreateOnFirstTrade:!0,autoCreateMonthlyReviewOnNavigation:re},await e.saveSettings(),r(Ee=>Ee+1),new ir.Notice(`Auto-create Monthly Review on navigation ${re?"enabled":"disabled"}`)},w=async re=>{let Ee=re;e.settings.general?e.settings.general.currency=Ee:e.settings.general={currency:Ee};try{await e.saveSettings();let at=new CustomEvent("journalit-currency-changed",{detail:{currency:Ee}});window.dispatchEvent(at),r($t=>$t+1),new ir.Notice(`\u2713 Currency changed to ${Ee}. All components will update immediately!`)}catch(at){console.error("Failed to save currency setting:",at),new ir.Notice("\u274C Failed to save currency setting. Please try again.",5e3),r($t=>$t+1)}},S=re=>{var Ee;o(re),i(re!==(((Ee=e.settings.general)==null?void 0:Ee.displayName)||""))},k=async()=>{try{e.settings.general?e.settings.general.displayName=n:e.settings.general={currency:"USD",displayName:n},await e.saveSettings(),i(!1);let re=new CustomEvent("journalit:display-name-changed",{detail:{displayName:n}});window.dispatchEvent(re),new ir.Notice(`Display name ${n?`saved as "${n}"`:"cleared"}`)}catch(re){console.error("Failed to save display name:",re),new ir.Notice("\u274C Failed to save display name. Please try again.",5e3)}},T=()=>{var re;o(((re=e.settings.general)==null?void 0:re.displayName)||""),i(!1)},P=SC(async re=>{var es,ei;let Ee=await e.serviceManager.getBackendIntegrationService();if(Ee!=null&&Ee.getIsSyncing()){new ir.Notice("Cannot change folder path while sync is in progress. Please wait for sync to complete.",5e3);let rn=await((es=e.serviceManager)==null?void 0:es.getFolderPathService()),Ai=(rn==null?void 0:rn.journalFolderPath)||"!Journalit";l(Ai);return}let at=await((ei=e.serviceManager)==null?void 0:ei.getFolderPathService()),$t=(at==null?void 0:at.journalFolderPath)||"!Journalit";if(re===$t)return;let it=!1;try{let Ai=e.app.vault.getMarkdownFiles(),Ms=$t||"!Journalit";it=Ai.some(ul=>ul.path.startsWith(Ms))}catch(rn){console.warn("Failed to check for existing trades:",rn)}let Jr=$t||"!Journalit",Hn;!re||re.trim()===""?Hn="!Journalit":Hn=`${re.endsWith("/")?re.slice(0,-1):re}/!Journalit`,Pfe(e.app,e,Jr,Hn,it,async()=>{try{e.settings.general?e.settings.general.journalFolderPath=Hn:e.settings.general={currency:"USD",journalFolderPath:Hn},await e.saveSettings(),document.dispatchEvent(new CustomEvent("journalit-settings-updated")),l(Hn),r(rn=>rn+1),new ir.Notice(`\u2705 Journal folder path updated. New trades will be created in: ${Hn}`)}catch(rn){console.error("Failed to update journal folder path:",rn),new ir.Notice(`\u274C Failed to update path: ${rn.message}`),l($t)}},()=>{l($t)})},2e3,{leading:!1,trailing:!0}),D=async re=>{e.settings.general?e.settings.general.homeStartupBehavior=re:e.settings.general={currency:"USD",homeStartupBehavior:re},await e.saveSettings(),r(at=>at+1);let Ee={always:"Always open + focus",ifNone:"Only if no active file",never:"Never (manual only)"};new ir.Notice(`Journalit startup behavior changed to: ${Ee[re]}`)},O=async re=>{var at;e.settings.home?e.settings.home.filterRecentItemsToJournalit=re:e.settings.home={layouts:{},activeLayout:"Default",recentItems:[],filterRecentItemsToJournalit:re},await e.saveSettings();let Ee=new CustomEvent("journalit:recent-items-changed",{detail:{recentItems:((at=e.settings.home)==null?void 0:at.recentItems)||[]}});document.dispatchEvent(Ee),r($t=>$t+1),new ir.Notice(`Filter recent items to Journalit files ${re?"enabled":"disabled"}`)},z=async re=>{var at,$t;if(re&&e.settings.trade.displayRMultiples){new ir.Notice("Cannot enable Copy Trading PnL while R-multiples display is active. Please disable R-multiples first.",5e3);return}let Ee=($t=(at=e.settings.trade)==null?void 0:at.showCopyTradingPnL)!=null?$t:!1;e.settings.trade?e.settings.trade.showCopyTradingPnL=re:e.settings.trade={autoOpenCreatedTrades:!0,dateFormat:"DDMMYY",skipWeekends:!0,showCopyTradingPnL:re};try{await e.saveSettings(),r(it=>it+1),new ir.Notice(`Copy Trading PnL ${re?"enabled":"disabled"}`)}catch(it){console.error("Failed to save Copy Trading PnL setting:",it),new ir.Notice("\u274C Failed to save Copy Trading PnL setting. Please try again.",5e3),e.settings.trade&&(e.settings.trade.showCopyTradingPnL=Ee),r(Jr=>Jr+1)}},I=async re=>{var it;let Ee=Number(re.target.value);e.settings.trade.breakEvenRangeMin=Ee>0?-Ee:Ee;let at=(it=e.settings.trade.breakEvenRangeMax)!=null?it:0;(Ee>0?-Ee:Ee)>at&&new ir.Notice("Warning: Minimum value is greater than maximum value. This will prevent trades from being classified as breakeven.",5e3),await e.saveSettings(),r(Jr=>Jr+1),e.tradeService&&await e.tradeService.clearCache(),e.accountPageService&&await e.accountPageService.refreshAllAccountData()},A=async re=>{var $t;let Ee=Number(re.target.value);e.settings.trade.breakEvenRangeMax=Ee,(($t=e.settings.trade.breakEvenRangeMin)!=null?$t:0)>Ee&&new ir.Notice("Warning: Minimum value is greater than maximum value. This will prevent trades from being classified as breakeven.",5e3),await e.saveSettings(),r(it=>it+1),e.tradeService&&await e.tradeService.clearCache(),e.accountPageService&&await e.accountPageService.refreshAllAccountData()},j=()=>{new ir.Notice("Break even range updated - views will refresh on next load")},E=async re=>{let Ee=re.target.value===""?0:Number(re.target.value);e.settings.trade.defaultRiskAmount=Ee,await e.saveSettings(),r(at=>at+1)},N=async re=>{if(re&&e.settings.trade.showCopyTradingPnL){new ir.Notice("Cannot enable R-multiples while Copy Trading PnL is active. Please disable Copy Trading PnL first.",5e3);return}e.settings.trade.displayRMultiples=re,await e.saveSettings(),r(Ee=>Ee+1),new ir.Notice(`R-multiples display ${re?"enabled":"disabled"}`)},B=(0,ae.useRef)(null),C=(0,ae.useRef)(null),F=(0,ae.useRef)(null);return(0,ae.useEffect)(()=>{B.current&&(0,ir.setIcon)(B.current,"book-open"),C.current&&(0,ir.setIcon)(C.current,"messages-square"),F.current&&(0,ir.setIcon)(F.current,"github")},[]),ae.default.createElement("div",{className:"journalit-settings-tab general-settings"},ae.default.createElement("h3",null,"General Settings"),ae.default.createElement("div",{style:{display:"flex",gap:"8px",marginBottom:"12px",alignItems:"center"}},ae.default.createElement(hN,{url:"https://journalit.co/docs",label:"Docs",iconRef:B}),ae.default.createElement(hN,{url:"https://discord.gg/AkSw3D9h8b",label:"Discord",iconRef:C}),ae.default.createElement(hN,{url:"https://github.com/Cursivez/journalit",label:"GitHub",iconRef:F})),ae.default.createElement("div",{className:"setting-item"},ae.default.createElement("div",{className:"setting-item-info"},ae.default.createElement("div",{className:"setting-item-name"},"Currency"),ae.default.createElement("div",{className:"setting-item-description"},"Choose the currency to display for all monetary values throughout the plugin")),ae.default.createElement("div",{className:"setting-item-control"},ae.default.createElement(En,{value:((H=e.settings.general)==null?void 0:H.currency)||"USD",onChange:w,options:$H(),id:"currency-dropdown","aria-label":"Select currency for displaying monetary values"}))),ae.default.createElement("div",{className:"setting-item"},ae.default.createElement("div",{className:"setting-item-info"},ae.default.createElement("div",{className:"setting-item-name"},"Display Name"),ae.default.createElement("div",{className:"setting-item-description"},'Optional name to display in the Journalit view welcome message (e.g., "Good morning, Alex")')),ae.default.createElement("div",{className:"setting-item-control"},ae.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px"}},ae.default.createElement("input",{type:"text",value:n,onChange:re=>S(re.target.value),onKeyDown:re=>{re.key==="Enter"&&a?(re.preventDefault(),k()):re.key==="Escape"&&(re.preventDefault(),T())},placeholder:"Add new display name...","aria-label":"Display name for welcome message",style:{flex:"1",padding:"8px 12px",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",backgroundColor:"var(--background-primary)",color:"var(--text-normal)",fontSize:"14px"}}),a&&ae.default.createElement(ae.default.Fragment,null,ae.default.createElement("button",{onClick:k,"aria-label":"Confirm display name change",style:{padding:"6px 8px",border:"none",borderRadius:"4px",backgroundColor:"var(--interactive-accent)",color:"var(--text-on-accent)",cursor:"pointer",fontSize:"12px",minWidth:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center"}},"\u2713"),ae.default.createElement("button",{onClick:T,"aria-label":"Cancel display name change",style:{padding:"6px 8px",border:"none",borderRadius:"4px",backgroundColor:"var(--background-modifier-error)",color:"var(--text-normal)",cursor:"pointer",fontSize:"12px",minWidth:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center"}},"\u2715"))))),ae.default.createElement(fr,{title:"Home View Settings",defaultExpanded:!1},ae.default.createElement("div",{className:"setting-item"},ae.default.createElement("div",{className:"setting-item-info"},ae.default.createElement("div",{className:"setting-item-name"},"Journalit Startup Behavior"),ae.default.createElement("div",{className:"setting-item-description"},"Choose when the Journalit view should automatically open when the plugin starts")),ae.default.createElement("div",{className:"setting-item-control"},ae.default.createElement(En,{value:((R=e.settings.general)==null?void 0:R.homeStartupBehavior)||"always",onChange:D,options:[{value:"always",label:"Always open + focus (default)"},{value:"ifNone",label:"Only if no active file"},{value:"never",label:"Never (manual only)"}],id:"home-startup-behavior-dropdown","aria-label":"Select home startup behavior"}))),ae.default.createElement("div",{className:"setting-item"},ae.default.createElement("div",{className:"setting-item-info"},ae.default.createElement("div",{className:"setting-item-name"},"Filter Recent Items to Journalit Files"),ae.default.createElement("div",{className:"setting-item-description"},"Only show Journalit-related files in the Recent Items widget (files within the .journalit folder). Hides all other vault files from the recent items list.")),ae.default.createElement("div",{className:"setting-item-control"},ae.default.createElement(Zo,{checked:(Z=(V=e.settings.home)==null?void 0:V.filterRecentItemsToJournalit)!=null?Z:!1,onChange:O,id:"filter-recent-items-toggle",ariaLabel:"Filter recent items to Journalit files"})))),ae.default.createElement(fr,{title:"Folder Location & Image Paths",defaultExpanded:!1},ae.default.createElement("div",{className:"setting-item"},ae.default.createElement("div",{className:"setting-item-info"},ae.default.createElement("div",{className:"setting-item-name"},"Journal Folder Location"),ae.default.createElement("div",{className:"setting-item-description"},"Choose where your trading journals are stored in your vault.",ae.default.createElement("br",null),"Leave empty to use the default root folder location.")),ae.default.createElement("div",{className:"setting-item-control"},ae.default.createElement(VL,{selectedPath:s,onChange:P,placeholder:s?"Select custom folder...":"Default: Root folder (!Journalit)",app:e.app}))),ae.default.createElement("div",{className:"setting-item",style:{marginTop:"8px",paddingTop:"8px",borderTop:"1px solid var(--background-modifier-border)"}},ae.default.createElement("div",{className:"setting-item-info"},ae.default.createElement("div",{className:"setting-item-name"},"Update Image Paths"),ae.default.createElement("div",{className:"setting-item-description"},"Updates image paths in all trades to match current folder location. Use this after manually moving your !Journalit folder.")),ae.default.createElement("div",{className:"setting-item-control"},ae.default.createElement("button",{onClick:async()=>{var re;p(!0);try{let at=(((re=e.settings.general)==null?void 0:re.journalFolderPath)||"!Journalit").replace(/\/$/,"")+"/",$t=e.app.vault.getMarkdownFiles(),it=new Map,Jr=new vN(e.app,e.tradeService);for(let rn of $t){let Ai=Jr.getImageBasePaths(rn,at);Ai.size>0&&it.set(rn.path,{file:rn,oldPaths:Ai})}if(it.size===0){new ir.Notice("All image paths already match current folder location"),p(!1);return}let Hn=0,es=0,ei=[];for(let[rn,{file:Ai,oldPaths:Ms}]of it)try{for(let ul of Ms){let Ch=await Jr.updateImagePathsForAllTrades(ul,at.replace(/\/$/,""));if(Ch.updated>0){Hn++;break}Ch.failed>0&&(es+=Ch.failed,ei.push(...Ch.errors))}}catch(ul){es++,ei.push(`${rn}: ${ul instanceof Error?ul.message:String(ul)}`)}ei.length>0?(new ir.Notice(`Updated ${Hn} trades with ${es} errors. Check console for details.`,8e3),console.error("Image path update errors:",ei)):Hn>0?new ir.Notice(`Successfully updated image paths in ${Hn} trades`,5e3):new ir.Notice("No image paths needed updating",3e3)}catch(Ee){console.error("Failed to update image paths:",Ee),new ir.Notice("Failed to update image paths. Check console for details.",5e3)}finally{p(!1)}},disabled:u,style:{padding:"8px 16px",border:"none",borderRadius:"4px",backgroundColor:u?"var(--background-modifier-border)":"var(--interactive-accent)",color:"var(--text-on-accent)",cursor:u?"not-allowed":"pointer",fontSize:"14px",fontWeight:"500",opacity:u?.6:1}},u?"Updating...":"Update Image Paths")))),ae.default.createElement(fr,{title:"Trade Settings",defaultExpanded:!0},ae.default.createElement("div",{className:"setting-item"},ae.default.createElement("div",{className:"setting-item-info"},ae.default.createElement("div",{className:"setting-item-name"},"Auto-open Created Trades"),ae.default.createElement("div",{className:"setting-item-description"},"Automatically open trade notes in a new tab after they are created")),ae.default.createElement("div",{className:"setting-item-control"},ae.default.createElement(Zo,{checked:e.settings.trade.autoOpenCreatedTrades||!1,onChange:f,id:"auto-open-trades-toggle",ariaLabel:"Auto-open created trades"}))),ae.default.createElement("div",{className:"setting-item"},ae.default.createElement("div",{className:"setting-item-info"},ae.default.createElement("div",{className:"setting-item-name"},"Date Format"),ae.default.createElement("div",{className:"setting-item-description"},"Format for displaying dates throughout the plugin")),ae.default.createElement("div",{className:"setting-item-control"},ae.default.createElement(En,{value:e.settings.trade.dateFormat,onChange:g,options:m,id:"date-format-dropdown","aria-label":"Select date format for trade notes"}))),ae.default.createElement("div",{className:"setting-item"},ae.default.createElement("div",{className:"setting-item-info"},ae.default.createElement("div",{className:"setting-item-name"},"Skip Weekends in Navigation"),ae.default.createElement("div",{className:"setting-item-description"},"Skip weekends when navigating between trading days (e.g., Friday \u2192 Monday)")),ae.default.createElement("div",{className:"setting-item-control"},ae.default.createElement(Zo,{checked:(K=e.settings.trade.skipWeekends)!=null?K:!0,onChange:v,id:"skip-weekends-toggle",ariaLabel:"Skip weekends when navigating"}))),ae.default.createElement("div",{className:"setting-item"},ae.default.createElement("div",{className:"setting-item-info"},ae.default.createElement("div",{className:"setting-item-name"},"Trading Day Cutoff Time"),ae.default.createElement("div",{className:"setting-item-description"},"Time that defines the end of a trading day. Trades after this time will be grouped with the next day. (24-hour format, e.g., 23:30 for 11:30 PM)")),ae.default.createElement("div",{className:"setting-item-control"},ae.default.createElement("input",{type:"time",value:(X=e.settings.trade.tradingDayCutoffTime)!=null?X:"00:00",onChange:h,id:"trading-day-cutoff-time","aria-label":"Trading day cutoff time",className:"setting-input time-input",style:{padding:"8px",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",backgroundColor:"var(--background-primary)",color:"var(--text-normal)",width:"120px"}}))),ae.default.createElement("div",{className:"setting-item"},ae.default.createElement("div",{className:"setting-item-info"},ae.default.createElement("div",{className:"setting-item-name"},"Break Even Range"),ae.default.createElement("div",{className:"setting-item-description"},"Define a P&L range to consider trades as break even. For example, setting Min: -20 and Max: 20 will treat trades between -$20 and +$20 as break even. Set both to 0 to only consider exact $0.00 as break even. Minimum must be less than or equal to maximum.")),ae.default.createElement("div",{className:"setting-item-control",style:{display:"flex",gap:"8px",alignItems:"center"}},ae.default.createElement("input",{type:"number",value:(G=e.settings.trade.breakEvenRangeMin)!=null?G:0,onChange:I,onBlur:j,onFocus:re=>{(parseFloat(re.target.value)===0||re.target.value==="0"||/^0\.0+$/.test(re.target.value))&&re.target.select()},placeholder:"Min","aria-label":"Break even range minimum",className:"setting-input",style:{padding:"8px",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",backgroundColor:"var(--background-primary)",color:"var(--text-normal)",width:"80px"}}),ae.default.createElement("span",{style:{color:"var(--text-muted)"}},"to"),ae.default.createElement("input",{type:"number",value:(U=e.settings.trade.breakEvenRangeMax)!=null?U:0,onChange:A,onBlur:j,onFocus:re=>{(parseFloat(re.target.value)===0||re.target.value==="0"||/^0\.0+$/.test(re.target.value))&&re.target.select()},placeholder:"Max","aria-label":"Break even range maximum",className:"setting-input",style:{padding:"8px",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",backgroundColor:"var(--background-primary)",color:"var(--text-normal)",width:"80px"}}))),ae.default.createElement("div",{className:"setting-item",style:{marginTop:"16px",paddingTop:"16px",borderTop:"1px solid var(--background-modifier-border)"}},ae.default.createElement("div",{className:"setting-item-info"},ae.default.createElement("div",{className:"setting-item-name"},"Default Risk Amount"),ae.default.createElement("div",{className:"setting-item-description"},"Default risk amount (in account currency) used for R-multiple calculations. Leave empty to require manual entry per trade.")),ae.default.createElement("div",{className:"setting-item-control"},ae.default.createElement("input",{type:"number",value:(Q=e.settings.trade.defaultRiskAmount)!=null?Q:0,onChange:E,onFocus:re=>{(parseFloat(re.target.value)===0||re.target.value==="0"||/^0\.0+$/.test(re.target.value))&&re.target.select()},placeholder:"0.00","aria-label":"Default risk amount",className:"setting-input",style:{padding:"8px",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",backgroundColor:"var(--background-primary)",color:"var(--text-normal)",width:"80px"}}))),ae.default.createElement("div",{className:"setting-item"},ae.default.createElement("div",{className:"setting-item-info"},ae.default.createElement("div",{className:"setting-item-name"},"Display R-Multiples"),ae.default.createElement("div",{className:"setting-item-description"},"Show R-multiple values (risk-to-reward ratios) instead of currency amounts throughout the plugin")),ae.default.createElement("div",{className:"setting-item-control"},ae.default.createElement(Zo,{checked:(J=e.settings.trade.displayRMultiples)!=null?J:!1,onChange:N,id:"display-r-multiples-toggle",ariaLabel:"Display R-multiples in trade views"}))),ae.default.createElement("div",{className:"setting-item"},ae.default.createElement("div",{className:"setting-item-info"},ae.default.createElement("div",{className:"setting-item-name"},"Show Copy Trading PnL"),ae.default.createElement("div",{className:"setting-item-description"},"Multiply displayed PnL by the number of accounts attached to each trade.",ae.default.createElement("br",null),"Useful for copy trading across multiple accounts.")),ae.default.createElement("div",{className:"setting-item-control"},ae.default.createElement(Zo,{checked:(te=(ee=e.settings.trade)==null?void 0:ee.showCopyTradingPnL)!=null?te:!1,onChange:z,id:"copy-trading-pnl-toggle",ariaLabel:"Show Copy Trading PnL"}))),ae.default.createElement("div",{className:"setting-item"},ae.default.createElement("div",{className:"setting-item-info"},ae.default.createElement("div",{className:"setting-item-name"},"Auto-create DRC on Navigation"),ae.default.createElement("div",{className:"setting-item-description"},"Automatically create a new Daily Report Card when navigating to a day that doesn't have one")),ae.default.createElement("div",{className:"setting-item-control"},ae.default.createElement(Zo,{checked:(ue=e.settings.drc.autoCreateDRCOnNavigation)!=null?ue:!0,onChange:y,id:"auto-create-drc-navigation-toggle",ariaLabel:"Auto-create DRC on navigation"}))),ae.default.createElement("div",{className:"setting-item"},ae.default.createElement("div",{className:"setting-item-info"},ae.default.createElement("div",{className:"setting-item-name"},"Auto-create Weekly Review on Navigation"),ae.default.createElement("div",{className:"setting-item-description"},"Automatically create a new Weekly Review when navigating to a week that doesn't have one")),ae.default.createElement("div",{className:"setting-item-control"},ae.default.createElement(Zo,{checked:(be=e.settings.weekly.autoCreateWeeklyReviewOnNavigation)!=null?be:!0,onChange:b,id:"auto-create-weekly-review-navigation-toggle",ariaLabel:"Auto-create Weekly Review on navigation"}))),ae.default.createElement("div",{className:"setting-item"},ae.default.createElement("div",{className:"setting-item-info"},ae.default.createElement("div",{className:"setting-item-name"},"Auto-create Monthly Review on Navigation"),ae.default.createElement("div",{className:"setting-item-description"},"Automatically create a new Monthly Review when navigating to a month that doesn't have one")),ae.default.createElement("div",{className:"setting-item-control"},ae.default.createElement(Zo,{checked:($e=(Le=e.settings.monthly)==null?void 0:Le.autoCreateMonthlyReviewOnNavigation)!=null?$e:!0,onChange:x,id:"auto-create-monthly-review-navigation-toggle",ariaLabel:"Auto-create Monthly Review on navigation"})))),ae.default.createElement(fr,{title:"Notification Settings",defaultExpanded:!1},ae.default.createElement("div",{className:"setting-item"},ae.default.createElement("div",{className:"setting-item-info"},ae.default.createElement("div",{className:"setting-item-name"},"Sync Notifications"),ae.default.createElement("div",{className:"setting-item-description"},"Show notifications when sync operations complete")),ae.default.createElement("div",{className:"setting-item-control"},ae.default.createElement(Zo,{checked:(ge=(oe=e.settings.backendIntegration)==null?void 0:oe.showSyncNotifications)!=null?ge:!0,onChange:async re=>{e.settings.backendIntegration||(e.settings.backendIntegration={serverUrl:"https://api.journalit.co",syncEnabled:!0,userId:"",showSyncNotifications:!0,showNewTradeNotifications:!0,showUpdateNotifications:!0,lastSeenVersion:""}),e.settings.backendIntegration.showSyncNotifications=re,await e.saveSettings(),r(Ee=>Ee+1),new ir.Notice(`Sync notifications ${re?"enabled":"disabled"}`)},id:"sync-notifications-toggle",ariaLabel:"Enable sync notifications"}))),ae.default.createElement("div",{className:"setting-item"},ae.default.createElement("div",{className:"setting-item-info"},ae.default.createElement("div",{className:"setting-item-name"},"New Trade Notifications"),ae.default.createElement("div",{className:"setting-item-description"},"Show notifications when new trade files are detected")),ae.default.createElement("div",{className:"setting-item-control"},ae.default.createElement(Zo,{checked:(De=(Se=e.settings.backendIntegration)==null?void 0:Se.showNewTradeNotifications)!=null?De:!0,onChange:async re=>{e.settings.backendIntegration||(e.settings.backendIntegration={serverUrl:"https://api.journalit.co",syncEnabled:!0,userId:"",showSyncNotifications:!0,showNewTradeNotifications:!0,showUpdateNotifications:!0,lastSeenVersion:""}),e.settings.backendIntegration.showNewTradeNotifications=re,await e.saveSettings(),r(Ee=>Ee+1),new ir.Notice(`New trade notifications ${re?"enabled":"disabled"}`)},id:"new-trade-notifications-toggle",ariaLabel:"Enable new trade notifications"}))),ae.default.createElement("div",{className:"setting-item"},ae.default.createElement("div",{className:"setting-item-info"},ae.default.createElement("div",{className:"setting-item-name"},"Show Update Notifications"),ae.default.createElement("div",{className:"setting-item-description"},"Display a notification when a new plugin update is available")),ae.default.createElement("div",{className:"setting-item-control"},ae.default.createElement(Zo,{checked:(Fe=(se=e.settings.backendIntegration)==null?void 0:se.showUpdateNotifications)!=null?Fe:!0,onChange:async re=>{e.settings.backendIntegration||(e.settings.backendIntegration={serverUrl:"https://api.journalit.co",syncEnabled:!0,userId:"",showSyncNotifications:!0,showNewTradeNotifications:!0,showUpdateNotifications:!0,lastSeenVersion:""}),e.settings.backendIntegration.showUpdateNotifications=re,await e.saveSettings(),r(Ee=>Ee+1),new ir.Notice(`Update notifications ${re?"enabled":"disabled"}`)},id:"show-update-notifications-toggle",ariaLabel:"Show update notifications"})))))}});var sc,Lfe,Nfe,Mfe=L(()=>{sc=q(Y()),Lfe=require("obsidian");ou();Nfe=({plugin:e})=>{let[t,r]=(0,sc.useState)(()=>{var o;return((o=e.settings.reviews)==null?void 0:o.globalAutoCreate)===void 0?(e.settings.reviews?e.settings.reviews&&(e.settings.reviews.globalAutoCreate=!0,e.saveSettings()):(e.settings.reviews={globalAutoCreate:!0},e.saveSettings()),!0):e.settings.reviews.globalAutoCreate});return(0,sc.useEffect)(()=>{e.settings.reviews&&r(e.settings.reviews.globalAutoCreate)},[e.settings]),sc.default.createElement("div",{className:"global-review-settings"},sc.default.createElement("div",{className:"setting-item"},sc.default.createElement("div",{className:"setting-item-info"},sc.default.createElement("div",{className:"setting-item-name"},"Global Auto-Create Reviews"),sc.default.createElement("div",{className:"setting-item-description"},"Automatically create reviews when the first trade of the corresponding period is recorded. This setting applies to daily, weekly, monthly and yearly reviews.")),sc.default.createElement("div",{className:"setting-item-control"},sc.default.createElement(Zo,{checked:t,onChange:async()=>{let o=!t;r(o),e.settings.reviews?e.settings.reviews.globalAutoCreate=o:e.settings.reviews={globalAutoCreate:o},e.settings.drc&&(e.settings.drc.autoCreateOnFirstTrade=o),e.settings.weekly&&(e.settings.weekly.autoCreateOnFirstTrade=o),await e.saveSettings(),document.dispatchEvent(new CustomEvent("journalit-settings-updated",{detail:{component:"reviews",settings:e.settings.reviews}})),new Lfe.Notice(`Auto-create for all reviews ${o?"enabled":"disabled"}`)},id:"global-auto-create-toggle",ariaLabel:"Global auto-create reviews"}))))}});var Fa,Ffe,qS,g6=L(()=>{Fa=q(Y()),Ffe=require("obsidian");hd();ou();qS=({plugin:e,items:t,defaultItems:r,settingsPath:n,placeholder:o,onItemsChange:a,settingsEventComponent:i})=>{let[s,l]=(0,Fa.useState)(""),c=(f,g)=>{let v=f.split("."),h={...e.settings},y=h;for(let b=0;b<v.length-1;b++)y[v[b]]||(y[v[b]]={}),y=y[v[b]];return y[v[v.length-1]]=g,h},d=async f=>{let g=c(n,f);e.settings=g,await e.saveSettings(),i&&document.dispatchEvent(new CustomEvent("journalit-settings-updated",{detail:{component:i,settings:n.split(".")[0]===i?e.settings[i]:e.settings}})),a&&a(f)},u=async()=>{if(!s.trim())return;let f=[...t,s.trim()];await d(f),l("")},p=async f=>{let g=[...t];g.splice(f,1),await d(g)};return Fa.default.createElement("div",{className:"item-manager"},Fa.default.createElement("div",{className:"setting-item"},Fa.default.createElement("div",{className:"setting-item-info"},Fa.default.createElement("div",{className:"setting-item-control"},Fa.default.createElement(he,{onClick:async()=>{await d([...r]),new Ffe.Notice("Reset items to defaults")},variant:"secondary"},"Reset to Defaults")))),t.map((f,g)=>Fa.default.createElement("div",{key:g,className:"setting-item custom-item"},Fa.default.createElement("div",{className:"setting-item-info"},Fa.default.createElement("div",{className:"setting-item-name"},f)),Fa.default.createElement("div",{className:"setting-item-control"},Fa.default.createElement(he,{onClick:()=>p(g)},"Remove")))),Fa.default.createElement("div",{className:"setting-item custom-item-add"},Fa.default.createElement("div",{className:"setting-item-info"},Fa.default.createElement($r,{value:s,onChange:f=>l(f),placeholder:o})),Fa.default.createElement("div",{className:"setting-item-control"},Fa.default.createElement(he,{onClick:u,disabled:!s.trim()},"Add"))))}});var Yo,Ofe,yN,h6=L(()=>{Yo=q(Y()),Ofe=require("obsidian");hd();ou();yN=({plugin:e,timeframes:t,defaultTimeframes:r,settingsPath:n,settingsEventComponent:o,placeholder:a="New timeframe (e.g., 15M, 5M)"})=>{let[i,s]=(0,Yo.useState)(""),l=(m,f)=>{let g=m.split("."),v={...e.settings},h=v;for(let y=0;y<g.length-1;y++)h[g[y]]||(h[g[y]]={}),h=h[g[y]];return h[g[g.length-1]]=f,v},c=async m=>{let f=l(n,m);e.settings=f,await e.saveSettings(),o&&document.dispatchEvent(new CustomEvent("journalit-settings-updated",{detail:{component:o,settings:e.settings[o]}}))},d=async()=>{if(!i.trim())return;let m=[...t,i.trim()];await c(m),s("")},u=async m=>{let f=[...t];f.splice(m,1),await c(f)};return Yo.default.createElement("div",{className:"timeframe-manager"},Yo.default.createElement("div",{className:"setting-item"},Yo.default.createElement("div",{className:"setting-item-info"},Yo.default.createElement("div",{className:"setting-item-name"},"Forecast Timeframes"),Yo.default.createElement("div",{className:"setting-item-description"},"Customize the timeframes that appear in your forecast")),Yo.default.createElement("div",{className:"setting-item-control"},Yo.default.createElement(he,{onClick:async()=>{await c([...r]),new Ofe.Notice("Reset timeframes to defaults")},variant:"secondary"},"Reset to Defaults"))),t.map((m,f)=>Yo.default.createElement("div",{key:f,className:"setting-item custom-item"},Yo.default.createElement("div",{className:"setting-item-info"},Yo.default.createElement("div",{className:"setting-item-name"},m)),Yo.default.createElement("div",{className:"setting-item-control"},Yo.default.createElement(he,{onClick:()=>u(f)},"Remove")))),Yo.default.createElement("div",{className:"setting-item custom-item-add"},Yo.default.createElement("div",{className:"setting-item-info"},Yo.default.createElement($r,{value:i,onChange:m=>s(m),placeholder:a})),Yo.default.createElement("div",{className:"setting-item-control"},Yo.default.createElement(he,{onClick:d,disabled:!i.trim()},"Add"))))}});var pa,jfe,zfe=L(()=>{pa=q(Y());g6();h6();jfe=({plugin:e})=>{var d,u,p;let t=["Review market conditions","Check economic calendar","Set risk limits for the day","Review previous day's trades"],r=["What did I do well today?","What could I improve on?","What will I focus on for the next session?"],n=["Daily","4H","1H","30M"],[o,a]=(0,pa.useState)(((d=e.settings.drc)==null?void 0:d.checklistItems)||[...t]),[i,s]=(0,pa.useState)(((u=e.settings.drc)==null?void 0:u.reviewQuestions)||[...r]),[l,c]=(0,pa.useState)(((p=e.settings.drc)==null?void 0:p.customTimeframes)||[...n]);return(0,pa.useEffect)(()=>{let m=f=>{var g,v,h,y;((g=f.detail)==null?void 0:g.component)==="drc"&&(a(((v=e.settings.drc)==null?void 0:v.checklistItems)||[]),s(((h=e.settings.drc)==null?void 0:h.reviewQuestions)||[]),c(((y=e.settings.drc)==null?void 0:y.customTimeframes)||[]))};return document.addEventListener("journalit-settings-updated",m),()=>{document.removeEventListener("journalit-settings-updated",m)}},[e.settings]),pa.default.createElement("div",{className:"daily-review-section"},pa.default.createElement("h4",null,"Pre-Trade Checklist Items"),pa.default.createElement("p",{className:"setting-item-description"},"Customize the checklist items that appear in your Daily Report Card. These are tasks you should complete before starting your trading session."),pa.default.createElement(qS,{plugin:e,items:o,defaultItems:t,settingsPath:"drc.checklistItems",placeholder:"New checklist item",onItemsChange:a,settingsEventComponent:"drc"}),pa.default.createElement("hr",null),pa.default.createElement("h4",null,"Review Questions"),pa.default.createElement("p",{className:"setting-item-description"},"Customize the reflection questions that appear in the review section. These questions help you reflect on your trading performance."),pa.default.createElement(qS,{plugin:e,items:i,defaultItems:r,settingsPath:"drc.reviewQuestions",placeholder:"New review question",onItemsChange:s,settingsEventComponent:"drc"}),pa.default.createElement("hr",null),pa.default.createElement("h4",null,"Forecast Timeframes"),pa.default.createElement("p",{className:"setting-item-description"},"Customize the timeframes that appear in your Daily Report Card forecasts."),pa.default.createElement(yN,{plugin:e,timeframes:l,defaultTimeframes:n,settingsPath:"drc.customTimeframes",settingsEventComponent:"drc",placeholder:"New timeframe (e.g., 15M, 5M)"}))}});var Ns,_fe,Bfe=L(()=>{Ns=q(Y());g6();h6();_fe=({plugin:e})=>{let t=["What worked well this week?","What didn't work this week?","Which setups were most profitable?","What mistakes cost me the most money?","What could I improve for next week?"],r=["Monthly","Weekly","Daily"],[n,o]=(0,Ns.useState)(()=>(e.settings.weekly||(e.settings.weekly={reviewQuestions:[...t],customTimeframes:[...r],autoCreateOnFirstTrade:!0}),[...e.settings.weekly.reviewQuestions||t])),[a,i]=(0,Ns.useState)(()=>{var s;return((s=e.settings.weekly)==null?void 0:s.customTimeframes)||[...r]});return(0,Ns.useEffect)(()=>{let s=l=>{var c,d,u;((c=l.detail)==null?void 0:c.component)==="weekly"&&(o(((d=e.settings.weekly)==null?void 0:d.reviewQuestions)||[]),i(((u=e.settings.weekly)==null?void 0:u.customTimeframes)||[]))};return document.addEventListener("journalit-settings-updated",s),()=>{document.removeEventListener("journalit-settings-updated",s)}},[e.settings]),Ns.default.createElement("div",{className:"weekly-review-section"},Ns.default.createElement("h4",null,"Review Questions"),Ns.default.createElement("p",{className:"setting-item-description"},"Customize the questions that appear in your weekly review. These questions help you reflect on your trading performance over the week."),Ns.default.createElement(qS,{plugin:e,items:n,defaultItems:t,settingsPath:"weekly.reviewQuestions",placeholder:"New review question",onItemsChange:o,settingsEventComponent:"weekly"}),Ns.default.createElement("hr",null),Ns.default.createElement("h4",null,"Forecast Timeframes"),Ns.default.createElement("p",{className:"setting-item-description"},"Customize the timeframes that appear in your weekly forecast."),Ns.default.createElement(yN,{plugin:e,timeframes:a,defaultTimeframes:r,settingsPath:"weekly.customTimeframes",settingsEventComponent:"weekly",placeholder:"New timeframe (e.g., Weekly, Daily)"}))}});var ln,$fe,Wfe=L(()=>{ln=q(Y());Nr();UL();up();hd();vd();$fe=({section:e,index:t,totalSections:r,onUpdate:n,onRemove:o,onMove:a})=>{let i=p=>{let m={...e,type:p};p==="checkboxList"?(m.items=m.items||[""],m.content=void 0,m.placeholder=void 0):p==="textarea"?(m.placeholder=m.placeholder||"",m.content=void 0,m.items=void 0):(m.content=m.content||"",m.items=void 0,m.placeholder=void 0),n(m)},s=(p,m)=>{let f=[...e.items||[]];f[p]=m,n({...e,items:f})},l=()=>{let p=[...e.items||[],""];n({...e,items:p})},c=p=>{let m=(e.items||[]).filter((f,g)=>g!==p);n({...e,items:m})},d=()=>{switch(e.type){case"header":return ln.default.createElement($r,{label:"Content",multiline:!0,rows:3,value:e.content||"",onChange:p=>n({...e,content:p}),placeholder:"Enter header content (supports markdown)"});case"checkbox":return ln.default.createElement($r,{label:"Checkbox Label",multiline:!0,rows:2,value:e.content||"",onChange:p=>n({...e,content:p}),placeholder:"Enter checkbox label (supports markdown)"});case"textarea":return ln.default.createElement($r,{label:"Placeholder Text",value:e.placeholder||"",onChange:p=>n({...e,placeholder:p}),placeholder:"Enter placeholder text for the textarea"});case"checkboxList":return ln.default.createElement("div",{className:"checkbox-list-section"},ln.default.createElement("label",{className:"checkbox-items-label"},"Checkbox Items"),ln.default.createElement("div",{className:"checkbox-items"},(e.items||[]).map((p,m)=>ln.default.createElement("div",{key:m,className:"checkbox-item"},ln.default.createElement($r,{multiline:!0,rows:2,value:p,onChange:f=>s(m,f),placeholder:"Enter checkbox item (supports markdown)"}),ln.default.createElement(he,{onClick:()=>c(m),disabled:(e.items||[]).length<=1},"Remove"))),ln.default.createElement(he,{onClick:l},"Add Item")));default:return null}},u=`${e.title||"Untitled Section"} (${e.type})`;return ln.default.createElement("div",{className:"loss-review-section-editor"},ln.default.createElement(fr,{title:u,defaultExpanded:!1},ln.default.createElement("div",{className:"section-editor-content"},ln.default.createElement("div",{className:"section-controls-bar"},ln.default.createElement("div",{className:"section-order-controls"},ln.default.createElement(xh,{ariaLabel:"Move up",onClick:()=>a("up"),disabled:t===0,className:"control-button"},ln.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},ln.default.createElement("polyline",{points:"18 15 12 9 6 15"}))),ln.default.createElement(xh,{ariaLabel:"Move down",onClick:()=>a("down"),disabled:t===r-1,className:"control-button"},ln.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},ln.default.createElement("polyline",{points:"6 9 12 15 18 9"})))),ln.default.createElement(he,{onClick:o,variant:"danger"},"Remove Section")),ln.default.createElement("hr",null),ln.default.createElement("div",{className:"section-settings"},ln.default.createElement($r,{label:"Section Title",value:e.title,onChange:p=>n({...e,title:p}),placeholder:"Enter section title"}),ln.default.createElement(En,{label:"Section Type",value:e.type,onChange:p=>i(p),options:[{value:"header",label:"Header"},{value:"checkbox",label:"Single Checkbox"},{value:"textarea",label:"Text Area"},{value:"checkboxList",label:"Checkbox List"}]}),d()))))}});var tn,Rfe,Ufe=L(()=>{tn=q(Y());Zf();Wfe();Nr();Rfe=({plugin:e})=>{var u,p,m,f,g;let[t,r]=(0,tn.useState)((m=(p=(u=e.settings.trade)==null?void 0:u.lossReview)==null?void 0:p.enabled)!=null?m:!0),[n,o]=(0,tn.useState)(((g=(f=e.settings.trade)==null?void 0:f.lossReview)==null?void 0:g.sections)||[]);(0,tn.useEffect)(()=>{let v=h=>{var y,b,x,w,S,k;((y=h.detail)==null?void 0:y.component)==="lossReview"&&(r((w=(x=(b=e.settings.trade)==null?void 0:b.lossReview)==null?void 0:x.enabled)!=null?w:!0),o(((k=(S=e.settings.trade)==null?void 0:S.lossReview)==null?void 0:k.sections)||[]))};return document.addEventListener("journalit-settings-updated",v),()=>{document.removeEventListener("journalit-settings-updated",v)}},[e.settings]);let a=async v=>{var h;r(v),e.settings.trade.lossReview={enabled:v,sections:((h=e.settings.trade.lossReview)==null?void 0:h.sections)||[]},await e.saveSettings(),document.dispatchEvent(new CustomEvent("journalit-settings-updated",{detail:{component:"lossReview"}}))},i=async(v,h)=>{var b,x;let y=[...n];y[v]=h,o(y),e.settings.trade.lossReview={enabled:(x=(b=e.settings.trade.lossReview)==null?void 0:b.enabled)!=null?x:!0,sections:y},await e.saveSettings(),document.dispatchEvent(new CustomEvent("journalit-settings-updated",{detail:{component:"lossReview"}}))},s=async v=>{var y,b;let h=n.filter((x,w)=>w!==v);o(h),e.settings.trade.lossReview={enabled:(b=(y=e.settings.trade.lossReview)==null?void 0:y.enabled)!=null?b:!0,sections:h},await e.saveSettings(),document.dispatchEvent(new CustomEvent("journalit-settings-updated",{detail:{component:"lossReview"}}))},l=async(v,h)=>{var x,w;if(h==="up"&&v===0||h==="down"&&v===n.length-1)return;let y=[...n],b=h==="up"?v-1:v+1;[y[v],y[b]]=[y[b],y[v]],o(y),e.settings.trade.lossReview={enabled:(w=(x=e.settings.trade.lossReview)==null?void 0:x.enabled)!=null?w:!0,sections:y},await e.saveSettings(),document.dispatchEvent(new CustomEvent("journalit-settings-updated",{detail:{component:"lossReview"}}))};return tn.default.createElement("div",{className:"loss-review-section"},tn.default.createElement("h4",null,"Loss Review Settings"),tn.default.createElement("p",{className:"setting-item-description"},"Configure the Loss Review that appears at the bottom of losing trades. This helps you learn from losses and maintain proper trading psychology."),tn.default.createElement("div",{className:"setting-item"},tn.default.createElement("div",{className:"setting-item-info"},tn.default.createElement("div",{className:"setting-item-name"},"Enable Loss Review"),tn.default.createElement("div",{className:"setting-item-description"},"Show Loss Review section for trades with negative P&L")),tn.default.createElement("div",{className:"setting-item-control"},tn.default.createElement("input",{type:"checkbox",checked:t,onChange:v=>a(v.target.checked)}))),t&&tn.default.createElement(tn.default.Fragment,null,tn.default.createElement("hr",null),tn.default.createElement("div",{className:"loss-review-sections"},tn.default.createElement("div",{className:"section-header"},tn.default.createElement("h4",null,"Loss Review Sections"),tn.default.createElement("div",{className:"section-actions"},tn.default.createElement(he,{onClick:async()=>{var y,b;let v={id:`section-${Date.now()}`,title:"New Section",type:"header",content:""},h=[...n,v];o(h),e.settings.trade.lossReview={enabled:(b=(y=e.settings.trade.lossReview)==null?void 0:y.enabled)!=null?b:!0,sections:h},await e.saveSettings(),document.dispatchEvent(new CustomEvent("journalit-settings-updated",{detail:{component:"lossReview"}}))},variant:"primary"},"Add Section"),tn.default.createElement(he,{onClick:async()=>{var y,b,x;let v=((y=wo.trade.lossReview)==null?void 0:y.sections)||[],h=(x=(b=wo.trade.lossReview)==null?void 0:b.enabled)!=null?x:!0;o(v),e.settings.trade.lossReview={enabled:h,sections:v},await e.saveSettings(),document.dispatchEvent(new CustomEvent("journalit-settings-updated",{detail:{component:"lossReview"}}))},variant:"secondary"},"Reset to Defaults"))),tn.default.createElement("div",{className:"sections-list"},n.map((v,h)=>tn.default.createElement($fe,{key:v.id,section:v,index:h,totalSections:n.length,onUpdate:y=>i(h,y),onRemove:()=>s(h),onMove:y=>l(h,y)})),n.length===0&&tn.default.createElement("div",{className:"empty-state"},tn.default.createElement("p",null,'No sections configured. Click "Add Section" to create your first section.'))))))}});var Oa,Vfe,Hfe=L(()=>{Oa=q(Y());up();Mfe();zfe();Bfe();Ufe();Vfe=({plugin:e})=>Oa.default.createElement("div",{className:"journalit-settings-tab reviews-settings"},Oa.default.createElement("h3",null,"Review Settings"),Oa.default.createElement("p",{className:"setting-item-description"},"Configure settings for daily, weekly, monthly, and yearly reviews. These settings control how reviews are created and what information they include."),Oa.default.createElement(Nfe,{plugin:e}),Oa.default.createElement("hr",null),Oa.default.createElement(fr,{title:"Daily Review",defaultExpanded:!0},Oa.default.createElement(jfe,{plugin:e})),Oa.default.createElement(fr,{title:"Weekly Review",defaultExpanded:!1},Oa.default.createElement(_fe,{plugin:e})),Oa.default.createElement(fr,{title:"Trade Loss Review",defaultExpanded:!1},Oa.default.createElement(Rfe,{plugin:e})),Oa.default.createElement(fr,{title:"Monthly Review",defaultExpanded:!1},Oa.default.createElement("div",{className:"coming-soon"},Oa.default.createElement("p",null,"Monthly review settings will be available in a future update."))),Oa.default.createElement(fr,{title:"Yearly Review",defaultExpanded:!1},Oa.default.createElement("div",{className:"coming-soon"},Oa.default.createElement("p",null,"Yearly review settings will be available in a future update."))))});var Qt,qfe,Gfe,Yfe=L(()=>{Qt=q(Y()),qfe=require("obsidian");_R();Nr();up();Sc();Gfe=({plugin:e})=>{var u;let[t,r]=(0,Qt.useState)(e.authManager.getAuthState()),[n,o]=(0,Qt.useState)(e.authManager.getSubscriptionTier()),[a,i]=(0,Qt.useState)(e.authManager.isAuthenticated());(0,Qt.useEffect)(()=>{let p=()=>{r(e.authManager.getAuthState()),o(e.authManager.getSubscriptionTier()),i(e.authManager.isAuthenticated())};return nf.on(of.STATE_CHANGED,p),()=>{nf.off(of.STATE_CHANGED,p)}},[e]);let s=async()=>{if(!a)try{await e.authManager.authenticate()}catch(p){let m={operation:"authenticate user",endpoint:"/api/v1/auth/login",statusCode:Pe.extractStatusCode(p)};Pe.handleError(p,m)}},l=async()=>{try{await e.authManager.logout(),new qfe.Notice("Successfully signed out")}catch(p){let m={operation:"sign out user",endpoint:"/api/v1/auth/logout",statusCode:Pe.extractStatusCode(p)};Pe.handleError(p,m)}},c=p=>{switch(p==null?void 0:p.toLowerCase()){case"free":return"Free plan with basic features.";case"pro":return"Pro plan with advanced analytics and unlimited storage.";case"enterprise":return"Enterprise plan with full feature access and priority support.";default:return"Subscription status unknown."}},d=()=>{var p;if((p=t.cache)!=null&&p.graceEnd){let m=new Date(t.cache.graceEnd),f=new Date,g=m.getTime()-f.getTime(),v=Math.ceil(g/(1e3*60*60*24));return Math.max(0,v)}return 0};return Qt.default.createElement("div",{className:"trading-journal-settings-container"},Qt.default.createElement("h3",null,"Authentication"),Qt.default.createElement("p",{className:"setting-item-description"},"Manage authentication and connection settings."),Qt.default.createElement(fr,{title:"Authentication",defaultExpanded:!0},Qt.default.createElement("div",{className:"setting-item"},Qt.default.createElement("div",{className:"setting-item-info"},Qt.default.createElement("div",{className:"setting-item-name"},"Status"),Qt.default.createElement("div",{className:"setting-item-description"},"Current connection and subscription status")),Qt.default.createElement("div",{className:"setting-item-control"},Qt.default.createElement("input",{type:"text",value:`${t.isOffline?"Offline (Grace Period)":"Online"}${n?` - ${n.charAt(0).toUpperCase()+n.slice(1)} Plan`:""}`,disabled:!0,className:"status-text"}))),Qt.default.createElement("div",{className:"setting-item"},Qt.default.createElement("div",{className:"setting-item-info"},Qt.default.createElement("div",{className:"setting-item-name"},"Authentication"),Qt.default.createElement("div",{className:"setting-item-description"},"Sign in to access your trading journal")),Qt.default.createElement("div",{className:"setting-item-control"},Qt.default.createElement(he,{variant:"primary",onClick:s,className:a?"connected":"login-button"},a?"Signed In":"Sign In / Sign Up"))),a&&Qt.default.createElement("div",{className:"setting-item"},Qt.default.createElement("div",{className:"setting-item-info"},Qt.default.createElement("div",{className:"setting-item-name"},"Sign Out"),Qt.default.createElement("div",{className:"setting-item-description"},"Sign out of your account")),Qt.default.createElement("div",{className:"setting-item-control"},Qt.default.createElement(he,{variant:"danger",onClick:l,className:"signout"},"Sign Out"))),a&&n&&Qt.default.createElement(Qt.default.Fragment,null,Qt.default.createElement("h4",null,"Subscription Features"),Qt.default.createElement("div",{className:"setting-item-description subscription-desc"},c(n))),t.error&&Qt.default.createElement("div",{className:"trading-journal-error"},"Error: ",t.error),t.isOffline&&Qt.default.createElement("div",{className:"trading-journal-warning"},Qt.default.createElement("strong",null,"Offline Mode"),Qt.default.createElement("p",null,"Operating in offline mode. Some features may be limited. Will automatically sync when online."),((u=t.cache)==null?void 0:u.graceEnd)&&Qt.default.createElement("p",null,"Grace period ends in ",d()," days"))))}});var ne,Lo,v6,y6,uf,Kfe=L(()=>{ne=q(Y());er();Lo=require("obsidian");Sc();Ra();tm();Nr();f4();v6=class extends Lo.Modal{constructor(r,n,o){super(r);this.message=n;this.onConfirm=o}onOpen(){let{contentEl:r}=this;r.createEl("p",{text:this.message});let n=r.createDiv({cls:"modal-button-container"});n.createEl("button",{text:"OK (Update Notes)",cls:"mod-cta"}).addEventListener("click",()=>{this.close(),this.onConfirm(!0)}),n.createEl("button",{text:"Save Name Only"}).addEventListener("click",()=>{this.close(),this.onConfirm(!1)}),n.createEl("button",{text:"Cancel Action"}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:r}=this;r.empty()}},y6=class extends Lo.Modal{constructor(r,n,o){super(r);this.message=n;this.onConfirm=o}onOpen(){let{contentEl:r}=this;r.createEl("p",{text:this.message});let n=r.createDiv({cls:"modal-button-container"});n.createEl("button",{text:"Reset",cls:"mod-warning"}).addEventListener("click",()=>{this.close(),this.onConfirm()}),n.createEl("button",{text:"Cancel"}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:r}=this;r.empty()}},uf=({plugin:e,filterType:t,showSymbolMappings:r=!1})=>{let[n,o]=(0,ne.useState)({}),[a,i]=(0,ne.useState)({}),[s,l]=(0,ne.useState)(e.optionsService),[c,d]=(0,ne.useState)({}),[u,p]=(0,ne.useState)("stock"),[m,f]=(0,ne.useState)({dollarPerPoint:"",tickSize:"",tickValue:"",lotSize:"",pipValue:"",pipSize:""}),[g,v]=(0,ne.useState)([]),[h,y]=(0,ne.useState)({importedSymbol:"",baseSymbol:""});(0,ne.useEffect)(()=>{(async()=>{await s.reloadOptions();let F=s.getAllOptions();o(F);let M={};Object.entries(F).forEach(([_,W])=>{M[_]={},_==="instrument"?W.forEach($=>{var R,V,Z,K,X,G;let H={text:$.name,isEditing:!1,editValue:$.name,editAssetType:$.assetType};$.assetType==="futures"&&$.futuresData&&(H.editDollarPerPoint=((R=$.futuresData.dollarPerPoint)==null?void 0:R.toString())||"",H.editTickSize=((V=$.futuresData.tickSize)==null?void 0:V.toString())||"",H.editTickValue=((Z=$.futuresData.tickValue)==null?void 0:Z.toString())||""),$.assetType==="forex"&&$.forexData&&(H.editLotSize=((K=$.forexData.lotSize)==null?void 0:K.toString())||"",H.editPipValue=((X=$.forexData.pipValue)==null?void 0:X.toString())||"",H.editPipSize=((G=$.forexData.pipSize)==null?void 0:G.toString())||""),M[_][$.name]=H}):_==="event"?W.forEach($=>{M[_][$.name]={text:$.name,isEditing:!1,editValue:$.name}}):W.forEach($=>{M[_][$]={text:$,isEditing:!1,editValue:$}})}),i(M)})()},[e,s]),(0,ne.useEffect)(()=>{e.specService.loadMappings(),v(e.specService.getAllMappings())},[e]);let b=C=>{switch(C){case"instrument":return"Tickers";case"account":return"Accounts";case"account_type":return"Account Types";case"setup":return"Setups";case"mistake":return"Mistakes";case"tag":return"Tags";case"event":return"Events";default:return C}},x=C=>{switch(C){case"stock":return"Stock";case"options":return"Options";case"futures":return"Futures";case"forex":return"Forex";case"crypto":return"Crypto";case"cfd":return"CFD";default:return C.charAt(0).toUpperCase()+C.slice(1)}},w=(C,F)=>{i(M=>{var R,V;let _=M[C]||{},W=_[F]||{text:F,isEditing:!1,editValue:F},$,H={...W};if(C==="instrument"){let Z=n.instrument.find(K=>K.name===F);if($=(Z==null?void 0:Z.assetType)||"stock",$==="futures"||$==="forex"){let K=e.specService.getSpecsForSymbol(F,$),X=$==="futures"?(Z==null?void 0:Z.futuresData)&&((R=Z.futuresData.dollarPerPoint)!=null?R:0)>0:(Z==null?void 0:Z.forexData)&&((V=Z.forexData.lotSize)!=null?V:0)>0;K&&!X&&($==="futures"&&"dollarPerPoint"in K?(H.editDollarPerPoint=K.dollarPerPoint.toString(),H.editTickSize=K.tickSize.toString(),H.editTickValue=K.tickValue.toString()):$==="forex"&&"lotSize"in K&&(H.editLotSize=K.lotSize.toString(),H.editPipValue=K.pipValue.toString(),H.editPipSize=K.pipSize.toString()))}}return{...M,[C]:{..._,[F]:{...H,isEditing:!0,editValue:F,editAssetType:$}}}}),setTimeout(()=>{let M=document.querySelector(`.option-edit-input[data-option="${CSS.escape(F)}"]`);M&&(M.focus({preventScroll:!0}),M.select())},50)},S=(C,F)=>{i(M=>{let _=M[C]||{},W=_[F];return W?{...M,[C]:{..._,[F]:{...W,isEditing:!1}}}:M})},k=()=>{try{document.activeElement instanceof HTMLElement&&document.activeElement.blur();let C=document.createElement("input");C.classList.add("jl-focus-reset-input"),document.body.appendChild(C),requestAnimationFrame(()=>{C.focus(),requestAnimationFrame(()=>{C.blur(),document.body.contains(C)&&document.body.removeChild(C)})})}catch(C){console.error("Failed to reset focus state:",C)}},T=async C=>{var M,_,W,$,H,R,V;let F=(M=c[C])==null?void 0:M.trim();if(!F){new Lo.Notice("Option name cannot be empty");return}if(C==="instrument"&&!/^[A-Z0-9.]+$/i.test(F)){new Lo.Notice("Invalid ticker format. Only letters, numbers, and periods are allowed.");return}k();try{let Z=!1;if(C==="event")Z=await s.addOrUpdateEventOption(F,"gray");else if(C==="instrument"){let K;if(u==="futures"){let G=(_=m.dollarPerPoint)!=null&&_.trim()?parseFloat(m.dollarPerPoint):void 0,U=(W=m.tickSize)!=null&&W.trim()?parseFloat(m.tickSize):void 0,Q=($=m.tickValue)!=null&&$.trim()?parseFloat(m.tickValue):void 0;(G!==void 0||U!==void 0||Q!==void 0)&&(K={dollarPerPoint:G!==void 0?G:0,tickSize:U!==void 0?U:0,tickValue:Q!==void 0?Q:0})}let X;if(u==="forex"){let G=(H=m.lotSize)!=null&&H.trim()?parseFloat(m.lotSize):void 0,U=(R=m.pipValue)!=null&&R.trim()?parseFloat(m.pipValue):void 0,Q=(V=m.pipSize)!=null&&V.trim()?parseFloat(m.pipSize):void 0;(G!==void 0||U!==void 0||Q!==void 0)&&(X={lotSize:G!==void 0?G:0,pipValue:U!==void 0?U:0,pipSize:Q!==void 0?Q:0})}Z=await s.addOption(C,F,u,K,X)}else Z=await s.addOption(C,F);if(Z){new Lo.Notice(`Added option "${F}" to ${b(C)}`),d(G=>({...G,[C]:""})),C==="instrument"&&f({dollarPerPoint:"",tickSize:"",tickValue:"",lotSize:"",pipValue:"",pipSize:""}),await s.reloadOptions();let K=s.getAllOptions();o(K);let X={};Object.entries(K).forEach(([G,U])=>{X[G]={},G==="instrument"?U.forEach(Q=>{var ee,te,ue,be,Le,$e;let J={text:Q.name,isEditing:!1,editValue:Q.name,editAssetType:Q.assetType};Q.assetType==="futures"&&Q.futuresData&&(J.editDollarPerPoint=((ee=Q.futuresData.dollarPerPoint)==null?void 0:ee.toString())||"",J.editTickSize=((te=Q.futuresData.tickSize)==null?void 0:te.toString())||"",J.editTickValue=((ue=Q.futuresData.tickValue)==null?void 0:ue.toString())||""),Q.assetType==="forex"&&Q.forexData&&(J.editLotSize=((be=Q.forexData.lotSize)==null?void 0:be.toString())||"",J.editPipValue=((Le=Q.forexData.pipValue)==null?void 0:Le.toString())||"",J.editPipSize=(($e=Q.forexData.pipSize)==null?void 0:$e.toString())||""),X[G][Q.name]=J}):G==="event"?U.forEach(Q=>{X[G][Q.name]={text:Q.name,isEditing:!1,editValue:Q.name}}):U.forEach(Q=>{X[G][Q]={text:Q,isEditing:!1,editValue:Q}})}),i(X)}else Pe.showError(new Error(`Duplicate option: ${F} already exists`),Pe.createContext(`add ${b(C).toLowerCase()} option`))}catch(Z){Pe.handleError(Z,Pe.createContext(`add ${b(C).toLowerCase()} option`))}},P=(C,F,M)=>{i(_=>{let W=_[C]||{},$=W[F];return $?{..._,[C]:{...W,[F]:{...$,editValue:M}}}:(console.warn(`Initializing missing edit state for ${C} - ${F} during updateEditValue`),{..._,[C]:{...W,[F]:{text:F,isEditing:!0,editValue:M}}})})},D=(C,F,M)=>{C==="instrument"&&i(_=>{let W=_[C]||{},$=W[F];return $?{..._,[C]:{...W,[F]:{...$,editAssetType:M}}}:_})},O=(C,F,M,_)=>{C==="instrument"&&i(W=>{let $=W[C]||{},H=$[F];return H?{...W,[C]:{...$,[F]:{...H,[M]:_}}}:W})},z=async(C,F)=>{try{if(!a[C]||!a[C][F]){console.error(`Cannot save option: Edit state not found for type "${C}", key "${F}"`),new Lo.Notice("Error saving option: State not found.");return}let M=a[C][F].editValue;if(!M||M.trim()===""){new Lo.Notice("Option name cannot be empty");return}if(C==="instrument"&&!/^[A-Z0-9.]+$/i.test(M)){new Lo.Notice("Invalid ticker format. Only letters, numbers, and periods are allowed.");return}let _;if(C==="instrument"){if(_=a[C][F].editAssetType,!_){let $=n.instrument.find(H=>H.name===F);_=$==null?void 0:$.assetType}if(!_){new Lo.Notice("Asset type is required for instruments");return}}let W=async $=>{var R,V,Z,K,X,G;k(),i(U=>{let Q={...U[C]||{}},J=Q[F];return J&&(delete Q[F],Q[M]={...J,text:M,isEditing:!1,editValue:M}),{...U,[C]:Q}});let H;if(C==="instrument"){let U=a[C][F],Q;if(_==="futures"){let ee=(R=U.editDollarPerPoint)!=null&&R.trim()?parseFloat(U.editDollarPerPoint):void 0,te=(V=U.editTickSize)!=null&&V.trim()?parseFloat(U.editTickSize):void 0,ue=(Z=U.editTickValue)!=null&&Z.trim()?parseFloat(U.editTickValue):void 0;ee!==void 0||te!==void 0||ue!==void 0?Q={dollarPerPoint:ee!==void 0?ee:0,tickSize:te!==void 0?te:0,tickValue:ue!==void 0?ue:0}:Q=s.getFuturesDataForInstrument(F)}let J;if(_==="forex"){let ee=(K=U.editLotSize)!=null&&K.trim()?parseFloat(U.editLotSize):void 0,te=(X=U.editPipValue)!=null&&X.trim()?parseFloat(U.editPipValue):void 0,ue=(G=U.editPipSize)!=null&&G.trim()?parseFloat(U.editPipSize):void 0;(ee!==void 0||te!==void 0||ue!==void 0)&&(J={lotSize:ee!==void 0?ee:0,pipValue:te!==void 0?te:0,pipSize:ue!==void 0?ue:0})}H=await s.updateInstrument(F,M,_,Q,$,J)}else H=await s.updateOption(C,F,M,$);if(H.success){await s.reloadOptions();let U=s.getAllOptions();o(U);let Q={};Object.entries(U).forEach(([J,ee])=>{Q[J]={},J==="instrument"?ee.forEach(te=>{var Le,$e,oe,ge,Se,De,se,Fe,re;let ue=J===C&&te.name===M?!1:(oe=($e=(Le=a[J])==null?void 0:Le[te.name])==null?void 0:$e.isEditing)!=null?oe:!1,be={text:te.name,isEditing:ue,editValue:te.name,editAssetType:te.assetType};te.assetType==="futures"&&te.futuresData&&(be.editDollarPerPoint=((ge=te.futuresData.dollarPerPoint)==null?void 0:ge.toString())||"",be.editTickSize=((Se=te.futuresData.tickSize)==null?void 0:Se.toString())||"",be.editTickValue=((De=te.futuresData.tickValue)==null?void 0:De.toString())||""),te.assetType==="forex"&&te.forexData&&(be.editLotSize=((se=te.forexData.lotSize)==null?void 0:se.toString())||"",be.editPipValue=((Fe=te.forexData.pipValue)==null?void 0:Fe.toString())||"",be.editPipSize=((re=te.forexData.pipSize)==null?void 0:re.toString())||""),Q[J][te.name]=be}):J==="event"?ee.forEach(te=>{var be,Le,$e;let ue=J===C&&te.name===M?!1:($e=(Le=(be=a[J])==null?void 0:be[te.name])==null?void 0:Le.isEditing)!=null?$e:!1;Q[J][te.name]={text:te.name,isEditing:ue,editValue:te.name}}):ee.forEach(te=>{var be,Le,$e;let ue=J===C&&te===M?!1:($e=(Le=(be=a[J])==null?void 0:be[te])==null?void 0:Le.isEditing)!=null?$e:!1;Q[J][te]={text:te,isEditing:ue,editValue:te}})}),i(Q),$&&H.updatedNotes!==void 0?new Lo.Notice(`Updated option from "${F}" to "${M}" and updated ${H.updatedNotes} notes`):new Lo.Notice(`Updated option from "${F}" to "${M}"`)}else Pe.showError(new Error(`Duplicate option: ${M} already exists`),Pe.createContext(`update ${b(C).toLowerCase()} option`)),i(U=>{var ee,te;let Q={...U[C]||{}};return Q[M]?(delete Q[M],Q[F]={...((ee=a[C])==null?void 0:ee[F])||{text:F,editValue:F},isEditing:!0,editValue:M}):(te=U[C])!=null&&te[F]&&(Q[F]={...U[C][F],isEditing:!0,editValue:M}),{...U,[C]:Q}})};if(F!==M){let $=`Do you want to update all existing notes that use "${F}" to use "${M}" instead?

This will search through all notes and update the option value wherever it's found.`;new v6(e.app,$,H=>{W(H)}).open()}else if(C==="instrument"){let $=n.instrument.find(V=>V.name===F),H=$==null?void 0:$.assetType,R=a[C][F].editAssetType;H!==R?W(!1):i(V=>{var Z;return{...V,[C]:{...V[C]||{},[F]:{...((Z=V[C])==null?void 0:Z[F])||{text:F,editValue:F},isEditing:!1}}}})}else i($=>{var H;return{...$,[C]:{...$[C]||{},[F]:{...((H=$[C])==null?void 0:H[F])||{text:F,editValue:F},isEditing:!1}}}})}catch(M){Pe.handleError(M,Pe.createContext(`update ${b(C).toLowerCase()} option`)),i(_=>{var W;return{..._,[C]:{..._[C]||{},[F]:{...((W=_[C])==null?void 0:W[F])||{text:F,editValue:F},isEditing:!0}}}})}},I=async(C,F)=>{try{let M=`Are you sure you want to remove "${F}"? This cannot be undone.`;class _ extends Lo.Modal{constructor(H,R,V){super(H);this.message=R;this.onConfirm=V}onOpen(){let{contentEl:H}=this;H.createEl("p",{text:this.message});let R=H.createDiv({cls:"modal-button-container"});R.createEl("button",{text:"Delete",cls:"mod-warning"}).addEventListener("click",()=>{this.close(),this.onConfirm()}),R.createEl("button",{text:"Cancel"}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:H}=this;H.empty()}}new _(e.app,M,async()=>{if(k(),await s.removeOption(C,F)){await s.reloadOptions();let $=s.getAllOptions();o($);let H={};Object.entries($).forEach(([R,V])=>{H[R]={},R==="instrument"?V.forEach(Z=>{var X,G,U,Q,J,ee;let K={text:Z.name,isEditing:!1,editValue:Z.name,editAssetType:Z.assetType};Z.assetType==="futures"&&Z.futuresData&&(K.editDollarPerPoint=((X=Z.futuresData.dollarPerPoint)==null?void 0:X.toString())||"",K.editTickSize=((G=Z.futuresData.tickSize)==null?void 0:G.toString())||"",K.editTickValue=((U=Z.futuresData.tickValue)==null?void 0:U.toString())||""),Z.assetType==="forex"&&Z.forexData&&(K.editLotSize=((Q=Z.forexData.lotSize)==null?void 0:Q.toString())||"",K.editPipValue=((J=Z.forexData.pipValue)==null?void 0:J.toString())||"",K.editPipSize=((ee=Z.forexData.pipSize)==null?void 0:ee.toString())||""),H[R][Z.name]=K}):R==="event"?V.forEach(Z=>{H[R][Z.name]={text:Z.name,isEditing:!1,editValue:Z.name}}):V.forEach(Z=>{H[R][Z]={text:Z,isEditing:!1,editValue:Z}})}),i(H),new Lo.Notice(`Removed option "${F}"`)}else Pe.showError(new Error("Option removal failed"),Pe.createContext(`remove ${b(C).toLowerCase()} option`))}).open()}catch(M){Pe.handleError(M,Pe.createContext(`remove ${b(C).toLowerCase()} option`))}},A=async C=>{try{let F=`Are you sure you want to reset all custom ${b(C).toLowerCase()}? This cannot be undone.`;new y6(e.app,F,async()=>{k();let M=await s.clearOptions(C);if(M>0){await s.reloadOptions();let _=s.getAllOptions();o(_),i(W=>({...W,[C]:{}})),new Lo.Notice(`Removed ${M} custom ${b(C).toLowerCase()}`)}else Pe.showError(new Error("No options to reset"),Pe.createContext(`reset ${b(C).toLowerCase()} options`))}).open()}catch(F){Pe.handleError(F,Pe.createContext(`reset ${b(C).toLowerCase()} options`))}},j=async()=>{if(!h.importedSymbol.trim()||!h.baseSymbol.trim()){new Lo.Notice("Both symbols are required");return}try{await e.specService.saveMapping(h.importedSymbol.trim(),h.baseSymbol.trim(),!1),v(e.specService.getAllMappings()),y({importedSymbol:"",baseSymbol:""}),new Lo.Notice(`Mapping added: ${h.importedSymbol} \u2192 ${h.baseSymbol}`)}catch(C){new Lo.Notice("Failed to add mapping"),console.error(C)}},E=async C=>{try{await e.specService.deleteMapping(C),v(e.specService.getAllMappings()),new Lo.Notice(`Mapping deleted: ${C}`)}catch(F){new Lo.Notice("Failed to delete mapping"),console.error(F)}},N=C=>r?!1:t?C===t:C!=="account",B=r||!t;return ne.default.createElement("div",{className:"journalit-settings-tab custom-options-settings",style:{maxHeight:"100%",overflowY:"visible"}},ne.default.createElement("div",{className:"custom-options-container"},Object.entries(n).filter(([C,F])=>N(C)).map(([C,F])=>{var M;return ne.default.createElement("div",{key:C,className:"option-category"},!F||F.length===0?ne.default.createElement("p",{className:"setting-item-description"},"No custom ",b(C).toLowerCase()," have been added yet."):ne.default.createElement("div",{className:"custom-options-container"},C==="instrument"?F.map((_,W)=>{var R;let $=_.name,H=(R=a[C])==null?void 0:R[$];return H?H.isEditing?ne.default.createElement("div",{key:`${C}-${$}-${W}`,className:"setting-item option-item"},ne.default.createElement("div",{className:"setting-item-control",style:{flexDirection:"column",alignItems:"stretch"}},ne.default.createElement("div",{style:{display:"flex",gap:"8px",width:"100%"}},ne.default.createElement("input",{type:"text",value:H.editValue,onChange:V=>P(C,$,V.target.value),onKeyDown:V=>{V.key==="Enter"?(V.preventDefault(),z(C,$)):V.key==="Escape"&&(V.preventDefault(),S(C,$))},className:"option-edit-input","data-option":$,"aria-label":`Edit ${$}`,style:{flex:"1"}}),ne.default.createElement("select",{value:H.editAssetType||_.assetType,onChange:V=>D(C,$,V.target.value),style:{width:"120px"}},Object.values(em).map(V=>ne.default.createElement("option",{key:V,value:V},x(V))))),(H.editAssetType||_.assetType)==="futures"&&ne.default.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px",marginTop:"8px",padding:"8px",backgroundColor:"var(--background-secondary)",borderRadius:"4px"}},ne.default.createElement("div",null,ne.default.createElement("label",{style:{fontSize:"11px",color:"var(--text-muted)",display:"block",marginBottom:"4px"}},"Dollar Per Point"),ne.default.createElement("input",{type:"number",placeholder:"$/point",value:H.editDollarPerPoint||"",onChange:V=>O(C,$,"editDollarPerPoint",V.target.value),style:{width:"100%"},step:"any"})),ne.default.createElement("div",null,ne.default.createElement("label",{style:{fontSize:"11px",color:"var(--text-muted)",display:"block",marginBottom:"4px"}},"Tick Size"),ne.default.createElement("input",{type:"number",placeholder:"Tick size",value:H.editTickSize||"",onChange:V=>O(C,$,"editTickSize",V.target.value),style:{width:"100%"},step:"any"})),ne.default.createElement("div",null,ne.default.createElement("label",{style:{fontSize:"11px",color:"var(--text-muted)",display:"block",marginBottom:"4px"}},"Tick Value"),ne.default.createElement("input",{type:"number",placeholder:"Tick value",value:H.editTickValue||"",onChange:V=>O(C,$,"editTickValue",V.target.value),style:{width:"100%"},step:"any"}))),(H.editAssetType||_.assetType)==="forex"&&ne.default.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px",marginTop:"8px",padding:"8px",backgroundColor:"var(--background-secondary)",borderRadius:"4px"}},ne.default.createElement("div",null,ne.default.createElement("label",{style:{fontSize:"11px",color:"var(--text-muted)",display:"block",marginBottom:"4px"}},"Lot Size"),ne.default.createElement("input",{type:"number",placeholder:"Lot size",value:H.editLotSize||"",onChange:V=>O(C,$,"editLotSize",V.target.value),style:{width:"100%"},step:"any"})),ne.default.createElement("div",null,ne.default.createElement("label",{style:{fontSize:"11px",color:"var(--text-muted)",display:"block",marginBottom:"4px"}},"Pip Value"),ne.default.createElement("input",{type:"number",placeholder:"Pip value",value:H.editPipValue||"",onChange:V=>O(C,$,"editPipValue",V.target.value),style:{width:"100%"},step:"any"})),ne.default.createElement("div",null,ne.default.createElement("label",{style:{fontSize:"11px",color:"var(--text-muted)",display:"block",marginBottom:"4px"}},"Pip Size"),ne.default.createElement("input",{type:"number",placeholder:"Pip size",value:H.editPipSize||"",onChange:V=>O(C,$,"editPipSize",V.target.value),style:{width:"100%"},step:"any"}))),ne.default.createElement("div",{className:"option-actions",style:{marginTop:"8px"}},ne.default.createElement(Es,{label:"Save changes",onClick:()=>z(C,$)},ne.default.createElement(Mo,{size:24})),ne.default.createElement(Es,{label:"Cancel editing",onClick:()=>S(C,$)},ne.default.createElement(Us,{size:24}))))):ne.default.createElement("div",{key:`${C}-${$}-${W}`,className:"setting-item option-item"},ne.default.createElement("div",{className:"setting-item-info"},ne.default.createElement("div",null,ne.default.createElement("div",{style:{display:"flex",alignItems:"center"}},ne.default.createElement("div",{className:"setting-item-name"},$),ne.default.createElement("span",{style:{display:"inline-block",marginLeft:"8px",fontSize:"12px",color:"var(--text-muted)",padding:"2px 6px",borderRadius:"4px",backgroundColor:"var(--background-secondary)"}},x(_.assetType))),(_.assetType==="futures"||_.assetType==="forex")&&(()=>{var X,G,U,Q,J,ee;let V=_.assetType==="futures"&&_.futuresData&&((X=_.futuresData.dollarPerPoint)!=null?X:0)>0&&((G=_.futuresData.tickSize)!=null?G:0)>0&&((U=_.futuresData.tickValue)!=null?U:0)>0,Z=_.assetType==="forex"&&_.forexData&&((Q=_.forexData.lotSize)!=null?Q:0)>0&&((J=_.forexData.pipValue)!=null?J:0)>0&&((ee=_.forexData.pipSize)!=null?ee:0)>0;if(V){let te=_.futuresData;return ne.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-muted)",marginTop:"4px"}},"$",te.dollarPerPoint,"/pt, ",te.tickSize," tick, $",te.tickValue," tick val")}if(Z){let te=_.forexData;return ne.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-muted)",marginTop:"4px"}},te.lotSize," lot, $",te.pipValue," pip val, ",te.pipSize," pip size")}let K=e.specService.getSpecsForSymbol($,_.assetType);if(K){if(_.assetType==="futures"&&"dollarPerPoint"in K)return ne.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-muted)",marginTop:"4px"}},"$",K.dollarPerPoint,"/pt, ",K.tickSize," tick, $",K.tickValue," tick val",ne.default.createElement("span",{style:{marginLeft:"4px",fontStyle:"italic",color:"var(--text-faint)"}},"(built-in)"));if(_.assetType==="forex"&&"lotSize"in K)return ne.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-muted)",marginTop:"4px"}},K.lotSize," lot, $",K.pipValue," pip val, ",K.pipSize," pip size",ne.default.createElement("span",{style:{marginLeft:"4px",fontStyle:"italic",color:"var(--text-faint)"}},"(built-in)"))}return null})(),(()=>{let V=g.find(Z=>Z.importedSymbol.toUpperCase()===$.toUpperCase());return V?ne.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-accent)",marginTop:"4px",fontStyle:"italic"}},"Mapped to ",V.baseSymbol," (uses ",V.baseSymbol,"'s specs)"):null})(),(()=>{var X,G,U,Q;if(g.find(J=>J.importedSymbol.toUpperCase()===$.toUpperCase())||_.assetType!=="futures"&&_.assetType!=="forex")return null;let Z=_.assetType==="futures"?((G=(X=_.futuresData)==null?void 0:X.dollarPerPoint)!=null?G:0)>0:((Q=(U=_.forexData)==null?void 0:U.lotSize)!=null?Q:0)>0,K=e.specService.getSpecsForSymbol($,_.assetType);return!Z&&!K?ne.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-faint)",marginTop:"4px",fontStyle:"italic"}},"(No specs set)"):null})())),ne.default.createElement("div",{className:"setting-item-control"},ne.default.createElement("div",{className:"option-actions"},ne.default.createElement(Es,{label:`Edit ${$}`,onClick:()=>w(C,$)},ne.default.createElement(Fo,{size:24})),ne.default.createElement(Es,{label:`Remove ${$}`,onClick:()=>I(C,$)},ne.default.createElement(jf,{size:24}))))):null}):C==="event"?F.map((_,W)=>{var R;let $=_.name,H=(R=a[C])==null?void 0:R[$];return H?H.isEditing?ne.default.createElement("div",{key:`${C}-${$}-${W}`,className:"setting-item option-item"},ne.default.createElement("div",{className:"setting-item-control"},ne.default.createElement("input",{type:"text",value:H.editValue,onChange:V=>P(C,$,V.target.value),onKeyDown:V=>{V.key==="Enter"?(V.preventDefault(),z(C,$)):V.key==="Escape"&&(V.preventDefault(),S(C,$))},className:"option-edit-input","data-option":$,"aria-label":`Edit ${$}`}),ne.default.createElement("div",{className:"option-actions"},ne.default.createElement(Es,{label:"Save changes",onClick:()=>z(C,$)},ne.default.createElement(Mo,{size:24})),ne.default.createElement(Es,{label:"Cancel editing",onClick:()=>S(C,$)},ne.default.createElement(Us,{size:24}))))):ne.default.createElement("div",{key:`${C}-${$}-${W}`,className:"setting-item option-item"},ne.default.createElement("div",{className:"setting-item-info"},ne.default.createElement("div",{className:"setting-item-name"},$),ne.default.createElement("span",{style:{display:"inline-block",width:"12px",height:"12px",borderRadius:"50%",marginLeft:"8px",backgroundColor:_.color,border:"1px solid var(--background-modifier-border)"},title:`Color: ${_.color}`})),ne.default.createElement("div",{className:"setting-item-control"},ne.default.createElement("div",{className:"option-actions"},ne.default.createElement(Es,{label:`Edit ${$}`,onClick:()=>w(C,$)},ne.default.createElement(Fo,{size:24})),ne.default.createElement(Es,{label:`Remove ${$}`,onClick:()=>I(C,$)},ne.default.createElement(jf,{size:24}))))):null}):F.map((_,W)=>{var H;let $=(H=a[C])==null?void 0:H[_];return $?$.isEditing?ne.default.createElement("div",{key:`${C}-${_}-${W}`,className:"setting-item option-item"},ne.default.createElement("div",{className:"setting-item-control"},ne.default.createElement("input",{type:"text",value:$.editValue,onChange:R=>P(C,_,R.target.value),onKeyDown:R=>{R.key==="Enter"?(R.preventDefault(),z(C,_)):R.key==="Escape"&&(R.preventDefault(),S(C,_))},className:"option-edit-input","data-option":_,"aria-label":`Edit ${_}`}),ne.default.createElement("div",{className:"option-actions"},ne.default.createElement(Es,{label:"Save changes",onClick:()=>z(C,_)},ne.default.createElement(Mo,{size:24})),ne.default.createElement(Es,{label:"Cancel editing",onClick:()=>S(C,_)},ne.default.createElement(Us,{size:24}))))):ne.default.createElement("div",{key:`${C}-${_}-${W}`,className:"setting-item option-item"},ne.default.createElement("div",{className:"setting-item-info"},ne.default.createElement("div",{className:"setting-item-name"},_)),ne.default.createElement("div",{className:"setting-item-control"},ne.default.createElement("div",{className:"option-actions"},ne.default.createElement(Es,{label:`Edit ${_}`,onClick:()=>w(C,_)},ne.default.createElement(Fo,{size:24})),ne.default.createElement(Es,{label:`Remove ${_}`,onClick:()=>I(C,_)},ne.default.createElement(jf,{size:24}))))):null}),ne.default.createElement("div",{className:"custom-options-reset-container"},ne.default.createElement(he,{variant:"danger",size:"small",onClick:()=>A(C),className:"reset-category-button","aria-label":`Remove all custom ${b(C).toLowerCase()}`},"Reset All ",b(C)))),ne.default.createElement("div",{className:"setting-item custom-item-add"},ne.default.createElement("div",{className:"setting-item-info",style:{flexDirection:"column",alignItems:"stretch"}},C==="instrument"?ne.default.createElement(ne.default.Fragment,null,ne.default.createElement("div",{style:{display:"flex",gap:"8px",width:"100%"}},ne.default.createElement("input",{type:"text",value:c[C]||"",onChange:_=>d(W=>({...W,[C]:_.target.value})),placeholder:`New ${b(C).slice(0,-1)} Name`,"aria-label":`Add new ${b(C).toLowerCase()}`,onKeyDown:_=>{var W;_.key==="Enter"&&((W=c[C])!=null&&W.trim())&&(_.preventDefault(),T(C))},style:{flex:"1"}}),ne.default.createElement("select",{value:u,onChange:_=>p(_.target.value),style:{width:"120px"}},Object.values(em).map(_=>ne.default.createElement("option",{key:_,value:_},x(_))))),u==="futures"&&ne.default.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px",marginTop:"8px",padding:"8px",backgroundColor:"var(--background-secondary)",borderRadius:"4px"}},ne.default.createElement("div",null,ne.default.createElement("label",{style:{fontSize:"11px",color:"var(--text-muted)",display:"block",marginBottom:"4px"}},"Dollar Per Point (optional)"),ne.default.createElement("input",{type:"number",placeholder:"$/point",value:m.dollarPerPoint,onChange:_=>f(W=>({...W,dollarPerPoint:_.target.value})),style:{width:"100%"},step:"any"})),ne.default.createElement("div",null,ne.default.createElement("label",{style:{fontSize:"11px",color:"var(--text-muted)",display:"block",marginBottom:"4px"}},"Tick Size (optional)"),ne.default.createElement("input",{type:"number",placeholder:"Tick size",value:m.tickSize,onChange:_=>f(W=>({...W,tickSize:_.target.value})),style:{width:"100%"},step:"any"})),ne.default.createElement("div",null,ne.default.createElement("label",{style:{fontSize:"11px",color:"var(--text-muted)",display:"block",marginBottom:"4px"}},"Tick Value (optional)"),ne.default.createElement("input",{type:"number",placeholder:"Tick value",value:m.tickValue,onChange:_=>f(W=>({...W,tickValue:_.target.value})),style:{width:"100%"},step:"any"}))),u==="forex"&&ne.default.createElement("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"8px",marginTop:"8px",padding:"8px",backgroundColor:"var(--background-secondary)",borderRadius:"4px"}},ne.default.createElement("div",null,ne.default.createElement("label",{style:{fontSize:"11px",color:"var(--text-muted)",display:"block",marginBottom:"4px"}},"Lot Size (optional)"),ne.default.createElement("input",{type:"number",placeholder:"Lot size",value:m.lotSize,onChange:_=>f(W=>({...W,lotSize:_.target.value})),style:{width:"100%"},step:"any"})),ne.default.createElement("div",null,ne.default.createElement("label",{style:{fontSize:"11px",color:"var(--text-muted)",display:"block",marginBottom:"4px"}},"Pip Value (optional)"),ne.default.createElement("input",{type:"number",placeholder:"Pip value",value:m.pipValue,onChange:_=>f(W=>({...W,pipValue:_.target.value})),style:{width:"100%"},step:"any"})),ne.default.createElement("div",null,ne.default.createElement("label",{style:{fontSize:"11px",color:"var(--text-muted)",display:"block",marginBottom:"4px"}},"Pip Size (optional)"),ne.default.createElement("input",{type:"number",placeholder:"Pip size",value:m.pipSize,onChange:_=>f(W=>({...W,pipSize:_.target.value})),style:{width:"100%"},step:"any"})))):ne.default.createElement("input",{type:"text",value:c[C]||"",onChange:_=>d(W=>({...W,[C]:_.target.value})),placeholder:`New ${b(C).slice(0,-1)} Name`,"aria-label":`Add new ${b(C).toLowerCase()}`,onKeyDown:_=>{var W;_.key==="Enter"&&((W=c[C])!=null&&W.trim())&&(_.preventDefault(),T(C))}})),ne.default.createElement("div",{className:"setting-item-control"},ne.default.createElement(he,{onClick:()=>T(C),disabled:!((M=c[C])!=null&&M.trim()),"aria-label":`Confirm add ${b(C).toLowerCase()}`},"Add"))))}),B&&ne.default.createElement(ne.default.Fragment,null,ne.default.createElement("div",{className:"setting-item"},ne.default.createElement("div",{className:"setting-item-info"},ne.default.createElement("div",{className:"setting-item-description"},"Maps contract-specific symbols (e.g., NQZ5) to base symbols (e.g., NQ) for automatic spec lookup"))),g.length>0?ne.default.createElement("div",{className:"custom-options-container"},g.map(C=>ne.default.createElement("div",{key:C.importedSymbol,className:"setting-item option-item"},ne.default.createElement("div",{className:"setting-item-info"},ne.default.createElement("div",{className:"setting-item-name"},C.importedSymbol," \u2192 ",C.baseSymbol),ne.default.createElement("div",{className:"setting-item-description"},C.autoDetected?"Auto-detected":"Manual"," \u2022 Created ",new Date(C.dateCreated).toLocaleDateString())),ne.default.createElement("div",{className:"setting-item-control"},ne.default.createElement(he,{onClick:()=>E(C.importedSymbol),variant:"text"},"Delete"))))):ne.default.createElement("div",{className:"setting-item"},ne.default.createElement("div",{className:"setting-item-description"},"No symbol mappings yet. Mappings are created automatically during CSV imports when contract symbols are detected.")),ne.default.createElement("div",{className:"setting-item custom-item-add"},ne.default.createElement("div",{className:"setting-item-info",style:{display:"flex",gap:"8px",width:"100%"}},ne.default.createElement("input",{type:"text",value:h.importedSymbol,onChange:C=>y(F=>({...F,importedSymbol:C.target.value})),placeholder:"Imported symbol (e.g., NQZ5)",style:{flex:"1"}}),ne.default.createElement("span",null,"\u2192"),ne.default.createElement("input",{type:"text",value:h.baseSymbol,onChange:C=>y(F=>({...F,baseSymbol:C.target.value})),placeholder:"Base symbol (e.g., NQ)",style:{flex:"1"}})),ne.default.createElement("div",{className:"setting-item-control"},ne.default.createElement(he,{onClick:j,disabled:!h.importedSymbol.trim()||!h.baseSymbol.trim()},"Add Mapping"))))))}});var Ce,zBe,b6,Jfe=L(()=>{Ce=q(Y());$f();Nr();vd();DC();hd();zBe=({field:e,onSave:t,onCancel:r,onDelete:n,generateUniqueKey:o})=>{var h,y,b,x,w;let[a,i]=(0,Ce.useState)({...e}),[s,l]=(0,Ce.useState)(""),c=[{value:"text",label:"Text"},{value:"number",label:"Number"},{value:"dropdown",label:"Dropdown"},{value:"multiselect",label:"Multi-select"},{value:"date",label:"Date"},{value:"datetime",label:"Date & Time"},{value:"time",label:"Time"}],d=(S,k)=>{let T={...a,[S]:k};S==="type"&&(["date","datetime","dropdown","multiselect"].includes(k)&&(T.validation={}),k!=="dropdown"&&k!=="multiselect"&&(T.options=[])),S==="label"&&(T.fieldKey=o(k,a.id)),i(T)},u=(S,k)=>{i(T=>({...T,validation:{...T.validation,[S]:k}}))},p=()=>{if(s.trim()){let S=[...a.options||[],{value:s.trim(),label:s.trim()}];i(k=>({...k,options:S})),l("")}},m=S=>{let k=[...a.options||[]];k.splice(S,1),i(T=>({...T,options:k}))},f=()=>{t(a)},g=!0,v=["dropdown","multiselect"].includes(a.type);return Ce.default.createElement("div",{className:"custom-field-editor"},Ce.default.createElement("div",{className:"setting-item"},Ce.default.createElement("div",{className:"setting-item-info"},Ce.default.createElement("div",{className:"setting-item-name"},"Field Configuration"))),Ce.default.createElement("div",{className:"setting-item"},Ce.default.createElement("div",{className:"setting-item-info"},Ce.default.createElement("div",{className:"setting-item-name"},"Field Label"),Ce.default.createElement("div",{className:"setting-item-description"},"Display name for this field")),Ce.default.createElement("div",{className:"setting-item-control"},Ce.default.createElement($r,{type:"text",value:a.label,onChange:S=>d("label",S),placeholder:"Enter field label",size:"md",onKeyDown:S=>{S.key==="Enter"&&S.preventDefault()}}))),Ce.default.createElement("div",{className:"setting-item"},Ce.default.createElement("div",{className:"setting-item-info"},Ce.default.createElement("div",{className:"setting-item-name"},"Frontmatter Key"),Ce.default.createElement("div",{className:"setting-item-description"},"This key will appear in your trade files: ",Ce.default.createElement("code",{style:{backgroundColor:"var(--background-modifier-border)",padding:"2px 4px",borderRadius:"3px",fontSize:"0.9em",color:a.fieldKey&&dv.has(a.fieldKey)?"var(--text-error)":"var(--text-accent)"}},a.fieldKey||"field_name"),a.fieldKey&&dv.has(a.fieldKey)&&Ce.default.createElement("span",{style:{color:"var(--text-error)",marginLeft:"8px"}},"\u26A0\uFE0F Reserved field name")))),Ce.default.createElement("div",{className:"setting-item"},Ce.default.createElement("div",{className:"setting-item-info"},Ce.default.createElement("div",{className:"setting-item-name"},"Field Type"),Ce.default.createElement("div",{className:"setting-item-description"},"Type of input field")),Ce.default.createElement("div",{className:"setting-item-control"},Ce.default.createElement(En,{options:c,value:a.type,onChange:S=>d("type",S)}))),Ce.default.createElement("div",{className:"setting-item"},Ce.default.createElement("div",{className:"setting-item-info"},Ce.default.createElement("div",{className:"setting-item-name"},"Placeholder Text"),Ce.default.createElement("div",{className:"setting-item-description"},"Optional placeholder text shown in empty field")),Ce.default.createElement("div",{className:"setting-item-control"},Ce.default.createElement($r,{type:"text",value:a.placeholder||"",onChange:S=>d("placeholder",S),placeholder:"Enter placeholder text",size:"md",onKeyDown:S=>{S.key==="Enter"&&S.preventDefault()}}))),g&&Ce.default.createElement(Ce.default.Fragment,null,Ce.default.createElement("div",{className:"setting-item"},Ce.default.createElement("div",{className:"setting-item-info"},Ce.default.createElement("div",{className:"setting-item-name"},"Validation"),Ce.default.createElement("div",{className:"setting-item-description"},"Field validation rules"))),Ce.default.createElement("div",{className:"setting-item"},Ce.default.createElement("div",{className:"setting-item-info"},Ce.default.createElement("div",{className:"setting-item-name"},"Required Field"),Ce.default.createElement("div",{className:"setting-item-description"},"Make this field mandatory")),Ce.default.createElement("div",{className:"setting-item-control"},Ce.default.createElement("input",{type:"checkbox",checked:((h=a.validation)==null?void 0:h.required)||!1,onChange:S=>u("required",S.target.checked),style:{transform:"scale(1.2)"}}))),a.type==="text"&&Ce.default.createElement(Ce.default.Fragment,null,Ce.default.createElement("div",{className:"setting-item"},Ce.default.createElement("div",{className:"setting-item-info"},Ce.default.createElement("div",{className:"setting-item-name"},"Minimum Length"),Ce.default.createElement("div",{className:"setting-item-description"},"Minimum number of characters")),Ce.default.createElement("div",{className:"setting-item-control"},Ce.default.createElement(ur,{value:((y=a.validation)==null?void 0:y.minLength)||void 0,onChange:S=>u("minLength",S),min:0,placeholder:"No minimum"}))),Ce.default.createElement("div",{className:"setting-item"},Ce.default.createElement("div",{className:"setting-item-info"},Ce.default.createElement("div",{className:"setting-item-name"},"Maximum Length"),Ce.default.createElement("div",{className:"setting-item-description"},"Maximum number of characters")),Ce.default.createElement("div",{className:"setting-item-control"},Ce.default.createElement(ur,{value:((b=a.validation)==null?void 0:b.maxLength)||void 0,onChange:S=>u("maxLength",S),min:1,placeholder:"No maximum"})))),a.type==="number"&&Ce.default.createElement(Ce.default.Fragment,null,Ce.default.createElement("div",{className:"setting-item"},Ce.default.createElement("div",{className:"setting-item-info"},Ce.default.createElement("div",{className:"setting-item-name"},"Minimum Value"),Ce.default.createElement("div",{className:"setting-item-description"},"Minimum allowed number")),Ce.default.createElement("div",{className:"setting-item-control"},Ce.default.createElement(ur,{value:((x=a.validation)==null?void 0:x.min)||void 0,onChange:S=>u("min",S),allowDecimal:!0,placeholder:"No minimum"}))),Ce.default.createElement("div",{className:"setting-item"},Ce.default.createElement("div",{className:"setting-item-info"},Ce.default.createElement("div",{className:"setting-item-name"},"Maximum Value"),Ce.default.createElement("div",{className:"setting-item-description"},"Maximum allowed number")),Ce.default.createElement("div",{className:"setting-item-control"},Ce.default.createElement(ur,{value:((w=a.validation)==null?void 0:w.max)||void 0,onChange:S=>u("max",S),allowDecimal:!0,placeholder:"No maximum"}))))),v&&Ce.default.createElement(Ce.default.Fragment,null,Ce.default.createElement("div",{className:"setting-item"},Ce.default.createElement("div",{className:"setting-item-info"},Ce.default.createElement("div",{className:"setting-item-name"},"Options"),Ce.default.createElement("div",{className:"setting-item-description"},"Available choices for this field"))),(a.options||[]).map((S,k)=>Ce.default.createElement("div",{key:k,className:"setting-item"},Ce.default.createElement("div",{className:"setting-item-info"},Ce.default.createElement("div",{className:"setting-item-name"},S.label)),Ce.default.createElement("div",{className:"setting-item-control"},Ce.default.createElement(he,{variant:"outline",size:"sm",onClick:()=>m(k)},"Remove")))),Ce.default.createElement("div",{className:"setting-item"},Ce.default.createElement("div",{className:"setting-item-info"},Ce.default.createElement("div",{className:"setting-item-name"},"Add New Option"),Ce.default.createElement("div",{className:"setting-item-description"},"Enter a new choice")),Ce.default.createElement("div",{className:"setting-item-control"},Ce.default.createElement("div",{style:{display:"flex",gap:"8px",alignItems:"center"}},Ce.default.createElement($r,{type:"text",value:s,onChange:S=>l(S),placeholder:"Enter new option",size:"md",style:{flex:1},onKeyDown:S=>{S.key==="Enter"&&(S.preventDefault(),s.trim()&&p())}}),Ce.default.createElement(he,{variant:"primary",size:"md",onClick:p,disabled:!s.trim()},"Add")))),a.type==="multiselect"&&Ce.default.createElement("div",{className:"setting-item"},Ce.default.createElement("div",{className:"setting-item-info"},Ce.default.createElement("div",{className:"setting-item-name"},"Allow Creating New Options"),Ce.default.createElement("div",{className:"setting-item-description"},"Users can create new options when using this field in trade forms")),Ce.default.createElement("div",{className:"setting-item-control"},Ce.default.createElement("input",{type:"checkbox",checked:a.allowCreateOptions||!1,onChange:S=>d("allowCreateOptions",S.target.checked),style:{transform:"scale(1.2)"}})))),Ce.default.createElement("div",{className:"setting-item",style:{justifyContent:"center",borderTop:"1px solid var(--background-modifier-border)",paddingTop:"16px",marginTop:"16px"}},Ce.default.createElement("div",{style:{display:"flex",gap:"8px"}},Ce.default.createElement(he,{variant:"primary",onClick:f},"Save Field"),Ce.default.createElement(he,{variant:"outline",onClick:r},"Cancel"),Ce.default.createElement(he,{variant:"outline",onClick:()=>n(e.id),style:{color:"var(--text-error)"}},"Delete Field"))))},b6=(0,Ce.memo)(zBe,(e,t)=>{if(e.field===t.field)return!0;if(e.field.id!==t.field.id||e.field.label!==t.field.label||e.field.type!==t.field.type||e.field.placeholder!==t.field.placeholder||e.field.fieldKey!==t.field.fieldKey||e.field.allowCreateOptions!==t.field.allowCreateOptions)return!1;let r=e.field.validation,n=t.field.validation;if(r!==n&&(!r||!n||r.required!==n.required||r.minLength!==n.minLength||r.maxLength!==n.maxLength||r.min!==n.min||r.max!==n.max))return!1;let o=e.field.options,a=t.field.options;if(o!==a){if(!o||!a||o.length!==a.length)return!1;if(o.length>0){let i=o.length-1;if(o[0]!==a[0]||o[i]!==a[i])return!1}}return!0});b6.displayName="FieldEditor"});var ze,GS,_Be,Xfe,x6,w6,k6,S6,BBe,Qfe=L(()=>{ze=q(Y()),GS=require("obsidian");$f();Nr();qf();GR();Jfe();_Be=({field:e,savedOptions:t,onDeleteOption:r,onClearAll:n,initialExpanded:o=!1})=>{let{isExpanded:a,toggleExpanded:i,accordionContainerStyle:s,accordionContentStyle:l,contentRef:c,containerRef:d,chevronSvgProps:u}=PL(o,{duration:{open:300,close:250},easing:"ease-in-out",stagger:{opacity:100}},{includeBackground:!1,includeBorder:!1,customPadding:{top:0,bottom:8,left:16,right:0}});return ze.default.createElement("div",{style:{marginLeft:"16px"}},ze.default.createElement("div",{className:"setting-item"},ze.default.createElement("div",{className:"setting-item-info"},ze.default.createElement("div",{className:"setting-item-name",style:{cursor:"pointer",display:"flex",alignItems:"center",gap:"8px"},onClick:i},ze.default.createElement("svg",{...u},ze.default.createElement("path",{d:"M4 2l4 4-4 4",stroke:"currentColor",strokeWidth:"1.5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})),ze.default.createElement("span",null,e.label," (",t.length," option",t.length!==1?"s":"",")")),ze.default.createElement("div",{className:"setting-item-description"},e.type==="dropdown"?"Dropdown":"Multi-select"," field")),ze.default.createElement("div",{className:"setting-item-control"},ze.default.createElement(he,{variant:"outline",size:"sm",onClick:()=>n(e.id,e.label),style:{color:"var(--text-error)"}},"Clear All"))),ze.default.createElement("div",{ref:d,style:s},ze.default.createElement("div",{ref:c,style:l},t.map((p,m)=>ze.default.createElement("div",{key:m,className:"setting-item",style:{minHeight:"auto",padding:"4px 0"}},ze.default.createElement("div",{className:"setting-item-info"},ze.default.createElement("div",{className:"setting-item-name",style:{fontSize:"0.9em"}},"\u2022 ",p)),ze.default.createElement("div",{className:"setting-item-control"},ze.default.createElement(he,{variant:"outline",size:"sm",onClick:()=>r(e.id,p),style:{padding:"2px 8px",fontSize:"0.8em"}},"Delete")))))))},Xfe=({plugin:e,onRequestExpansion:t,remeasureContent:r})=>{let{service:n,status:o}=Tc("customFieldsService"),[a,i]=(0,ze.useState)([]),[s,l]=(0,ze.useState)(null),[c,d]=(0,ze.useState)(!1),[u,p]=(0,ze.useState)(0),m=(0,ze.useRef)(null),f=(0,ze.useCallback)(()=>{r&&(m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{requestAnimationFrame(()=>{r()})},16))},[r]);(0,ze.useEffect)(()=>()=>{m.current&&clearTimeout(m.current)},[]),(0,ze.useEffect)(()=>{g();let k=e.app,T=P=>{i(P.fields||[])};return k.workspace.on("journalit-custom-fields-changed",T),()=>{k.workspace.off("journalit-custom-fields-changed",T)}},[n,o]);let g=()=>{if(n&&o==="ready"){let k=n.getFields();i(k)}},v=()=>{t==null||t();let k=a.map(P=>P.fieldKey||rm(P.label)),T=_H("text",k);l(T),d(!0)},h=k=>{t==null||t(),l({...k}),d(!1)},y=(0,ze.useCallback)((k,T)=>{let P=a.filter(D=>D.id!==T).map(D=>D.fieldKey||rm(D.label));return pv(k,P)},[a]),b=(0,ze.useCallback)(async k=>{if(!n||o!=="ready"){console.error("CustomFieldsService not ready, status:",o);return}let T=EC(k.fieldKey);if(T){alert(`Cannot save field: ${T}`);return}let P=a.filter(D=>D.id!==k.id).map(D=>D.fieldKey||rm(D.label));if(P.includes(k.fieldKey)){alert("Cannot save field: A field with this frontmatter key already exists");return}try{k.fieldKey||(k.fieldKey=pv(k.label,P)),(0,ze.startTransition)(()=>{l(null),d(!1)}),c?await n.addField(k):await n.updateField(k.id,k),g(),f()}catch(D){console.error("Failed to save field:",D),alert("Failed to save field. Please try again.")}},[n,o,a,c,f]),x=(0,ze.useCallback)(()=>{(0,ze.startTransition)(()=>{l(null),d(!1)})},[]),w=(0,ze.useCallback)(async k=>{if(!n||o!=="ready"){console.error("CustomFieldsService not ready, status:",o);return}let T=(s==null?void 0:s.id)===k?s:a.find(D=>D.id===k),P=(T==null?void 0:T.label)||"Unknown Field";new x6(e.app,P,async()=>{try{(0,ze.startTransition)(()=>{l(null),d(!1)}),await n.removeField(k),g(),f()}catch(D){console.error("Failed to delete field:",D)}}).open()},[n,o,s,a,e.app,f]),S=async()=>{if(!n||o!=="ready"){console.error("CustomFieldsService not ready, status:",o);return}new w6(e.app,async()=>{try{(0,ze.startTransition)(()=>{l(null),d(!1)}),await n.resetFields(),g(),f()}catch(k){console.error("Failed to reset fields:",k)}}).open()};return ze.default.createElement("div",{className:"custom-fields-manager"},ze.default.createElement("div",{className:"setting-item"},ze.default.createElement("div",{className:"setting-item-info"},ze.default.createElement("div",{className:"setting-item-description"},"Create custom fields that will appear in the Advanced tab of the trade form. These fields will be saved to your trade's frontmatter."))),a.length>0&&ze.default.createElement(ze.default.Fragment,null,ze.default.createElement("div",{className:"setting-item"},ze.default.createElement("div",{className:"setting-item-info"},ze.default.createElement("div",{className:"setting-item-name"},"Custom Fields (",a.length,")"),ze.default.createElement("div",{className:"setting-item-description"},"Manage your custom trade form fields"))),a.map(k=>{var T,P;return ze.default.createElement("div",{key:k.id,className:"setting-item"},ze.default.createElement("div",{className:"setting-item-info"},ze.default.createElement("div",{className:"setting-item-name"},k.label,((T=k.validation)==null?void 0:T.required)&&ze.default.createElement("span",{style:{color:"var(--text-error)",marginLeft:"4px"}},"*")),ze.default.createElement("div",{className:"setting-item-description"},"Type: ",k.type,((P=k.validation)==null?void 0:P.required)&&" \u2022 Required")),ze.default.createElement("div",{className:"setting-item-control"},ze.default.createElement(he,{variant:"outline",size:"sm",onClick:()=>h(k)},"Edit")))})),a.length===0&&!s&&ze.default.createElement("div",{className:"setting-item"},ze.default.createElement("div",{className:"setting-item-info"},ze.default.createElement("div",{className:"setting-item-name"},"No custom fields defined yet"),ze.default.createElement("div",{className:"setting-item-description"},`Custom fields will appear in the "Advanced" tab of the trade form and be saved to your trade notes' frontmatter.`))),s&&ze.default.createElement(ze.default.Fragment,null,ze.default.createElement("div",{className:"setting-item",style:{borderTop:"2px solid var(--background-modifier-border)",marginTop:"16px",paddingTop:"16px"}},ze.default.createElement("div",{className:"setting-item-info"},ze.default.createElement("div",{className:"setting-item-name"},c?"Add New Field":"Edit Field"),ze.default.createElement("div",{className:"setting-item-description"},"Configure your custom field settings below"))),ze.default.createElement(b6,{field:s,onSave:b,onCancel:x,onDelete:w,generateUniqueKey:y})),!s&&ze.default.createElement(BBe,{customFieldsService:n,fields:a,onOptionsChanged:()=>{p(k=>k+1)},plugin:e}),!s&&ze.default.createElement("div",{className:"setting-item",style:{justifyContent:"space-between"}},ze.default.createElement("div",{className:"setting-item-info"},ze.default.createElement("div",{className:"setting-item-name"},"Actions"),ze.default.createElement("div",{className:"setting-item-description"},"Manage your custom fields")),ze.default.createElement("div",{className:"setting-item-control"},ze.default.createElement("div",{style:{display:"flex",gap:"8px"}},ze.default.createElement(he,{variant:"primary",onClick:v},"Add Custom Field"),a.length>0&&ze.default.createElement(he,{variant:"outline",onClick:S,style:{color:"var(--text-error)"}},"Delete All Fields")))))},x6=class extends GS.Modal{constructor(r,n,o){super(r);this.fieldLabel=n;this.onConfirm=o}onOpen(){let{contentEl:r}=this;r.createEl("p",{text:`Are you sure you want to delete the custom field "${this.fieldLabel}"?`}),r.createEl("p",{text:"This action cannot be undone.",cls:"warning"});let n=r.createDiv({cls:"modal-button-container"});n.createEl("button",{text:"Delete",cls:"mod-warning"}).addEventListener("click",()=>{this.close(),this.onConfirm()}),n.createEl("button",{text:"Cancel"}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:r}=this;r.empty()}},w6=class extends GS.Modal{constructor(r,n){super(r);this.onConfirm=n}onOpen(){let{contentEl:r}=this;r.createEl("p",{text:"Are you sure you want to delete ALL custom fields?"}),r.createEl("p",{text:"This action cannot be undone.",cls:"warning"});let n=r.createDiv({cls:"modal-button-container"});n.createEl("button",{text:"Delete All",cls:"mod-warning"}).addEventListener("click",()=>{this.close(),this.onConfirm()}),n.createEl("button",{text:"Cancel"}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:r}=this;r.empty()}},k6=class extends GS.Modal{constructor(r,n,o){super(r);this.optionName=n;this.onConfirm=o}onOpen(){let{contentEl:r}=this;r.createEl("p",{text:`Are you sure you want to delete the option "${this.optionName}"?`});let n=r.createDiv({cls:"modal-button-container"});n.createEl("button",{text:"Delete",cls:"mod-warning"}).addEventListener("click",()=>{this.close(),this.onConfirm()}),n.createEl("button",{text:"Cancel"}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:r}=this;r.empty()}},S6=class extends GS.Modal{constructor(r,n,o){super(r);this.fieldLabel=n;this.onConfirm=o}onOpen(){let{contentEl:r}=this;r.createEl("p",{text:`Are you sure you want to delete ALL saved options for "${this.fieldLabel}"?`}),r.createEl("p",{text:"This action cannot be undone.",cls:"warning"});let n=r.createDiv({cls:"modal-button-container"});n.createEl("button",{text:"Clear All",cls:"mod-warning"}).addEventListener("click",()=>{this.close(),this.onConfirm()}),n.createEl("button",{text:"Cancel"}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:r}=this;r.empty()}},BBe=({customFieldsService:e,fields:t,onOptionsChanged:r,plugin:n})=>{let o=(0,ze.useMemo)(()=>e?t.filter(s=>(s.type==="dropdown"||s.type==="multiselect")&&s.allowCreateOptions&&e.getFieldOptions(s.id).length>0):[],[t,e]),a=(0,ze.useCallback)(async(s,l)=>{e&&new k6(n.app,l,async()=>{try{await e.removeFieldOption(s,l),r()}catch(c){console.error("Failed to delete option:",c),alert("Failed to delete option. Please try again.")}}).open()},[e,n.app,r]),i=(0,ze.useCallback)(async(s,l)=>{e&&new S6(n.app,l,async()=>{try{await e.removeAllFieldOptions(s),r()}catch(c){console.error("Failed to clear all options:",c),alert("Failed to clear options. Please try again.")}}).open()},[e,n.app,r]);return!e||o.length===0?null:ze.default.createElement("div",{style:{marginTop:"24px",paddingTop:"24px",borderTop:"1px solid var(--background-modifier-border)"}},ze.default.createElement("div",{className:"setting-item"},ze.default.createElement("div",{className:"setting-item-info"},ze.default.createElement("div",{className:"setting-item-name"},"Saved Custom Options"),ze.default.createElement("div",{className:"setting-item-description"},"Manage options that users have created for custom fields"))),o.map(s=>{let l=e.getFieldOptions(s.id);return ze.default.createElement(_Be,{key:s.id,field:s,savedOptions:l,onDeleteOption:a,onClearAll:i,initialExpanded:!1})}))}});var io,Zfe,ege=L(()=>{io=q(Y());Kfe();Qfe();up();Ra();Zfe=({plugin:e})=>{let[t,r]=(0,io.useState)(!1),[n,o]=(0,io.useState)(null);return io.default.createElement("div",{className:"journalit-settings-tab customization-settings"},io.default.createElement("h3",null,"Customisation"),io.default.createElement("p",{className:"setting-item-description"},"Customize options, appearance, and behavior of the Journalit plugin."),io.default.createElement(fr,{title:"Tickers/Symbols",defaultExpanded:!1},io.default.createElement(uf,{plugin:e,filterType:"instrument"})),io.default.createElement(fr,{title:"Symbol Mappings",defaultExpanded:!1},io.default.createElement(uf,{plugin:e,showSymbolMappings:!0})),io.default.createElement(fr,{title:"Account Types",defaultExpanded:!1},io.default.createElement(uf,{plugin:e,filterType:"account_type"})),io.default.createElement(fr,{title:"Setups",defaultExpanded:!1},io.default.createElement(uf,{plugin:e,filterType:"setup"})),io.default.createElement(fr,{title:"Mistakes",defaultExpanded:!1},io.default.createElement(uf,{plugin:e,filterType:"mistake"})),io.default.createElement(fr,{title:"Tags",defaultExpanded:!1},io.default.createElement(uf,{plugin:e,filterType:"tag"})),io.default.createElement(fr,{title:"Events",defaultExpanded:!1},io.default.createElement(uf,{plugin:e,filterType:"event"})),io.default.createElement(fr,{title:"Custom Trade Fields",defaultExpanded:!1,expanded:t,onExpandedChange:r,onRemeasureContentChange:o},io.default.createElement(Xfe,{plugin:e,onRequestExpansion:()=>r(!0),remeasureContent:n||void 0})))}});var _e,tge,rge,nge=L(()=>{_e=q(Y()),tge=require("obsidian");er();qf();Sc();rge=({userId:e})=>{let t=xe(),{service:r}=Tc("backendIntegrationService"),[n,o]=(0,_e.useState)(null),[a,i]=(0,_e.useState)(!1),[s,l]=(0,_e.useState)(!1),[c,d]=(0,_e.useState)(null),[u,p]=(0,_e.useState)(null),[m,f]=(0,_e.useState)(!1),[g,v]=(0,_e.useState)(!1),h=(0,_e.useCallback)(async()=>{var x,w;if(!(!e||!r)){i(!0),d(null);try{let S=await r.getFTPCredentials(e);S?(((x=t==null?void 0:t.settings.backendIntegration)==null?void 0:x.ftpPassword)&&!S.password?(v(!0),S.password=""):v(!1),o(S)):(o(null),v(!1))}catch(S){if(!(S instanceof Error)||!((w=S.message)!=null&&w.includes("404"))){let k={operation:"load FTP credentials",endpoint:`/api/v1/ftp-users/${e}`,statusCode:Pe.extractStatusCode(S)},T=Pe.getErrorMessage(S,k);d(T),Pe.logError(S,k)}o(null)}finally{i(!1)}}},[e,r,t==null?void 0:t.settings.backendIntegration]);_e.default.useEffect(()=>{h()},[e,h]),_e.default.useEffect(()=>{let x=w=>{var S;(S=w.detail)!=null&&S.credentials?(o(w.detail.credentials),v(!1)):h()};return window.addEventListener("ftp-credentials-created",x),()=>{window.removeEventListener("ftp-credentials-created",x)}},[h]);let y=(0,_e.useCallback)(async(x,w)=>{try{await navigator.clipboard.writeText(x),p(w),setTimeout(()=>p(null),2e3)}catch(S){let k={operation:"copy to clipboard",endpoint:void 0};Pe.showError(new Error("Failed to copy to clipboard"),k),Pe.logError(S,k)}},[]),b=(0,_e.useCallback)(async()=>{if(!(!r||!e)){f(!0),d(null);try{let x=await r.resetFTPPassword(e);x?(o(x),v(!1),l(!0),new tge.Notice("FTP password reset successfully! Save the new password."),t!=null&&t.settings.backendIntegration&&(t.settings.backendIntegration.ftpPassword=x.password||"",await t.saveSettings())):d("Failed to reset password")}catch(x){let w={operation:"reset FTP password",endpoint:`/api/v1/ftp-users/${e}/reset-password`,statusCode:Pe.extractStatusCode(x)},S=Pe.getErrorMessage(x,w);d(S),Pe.handleError(x,w)}finally{f(!1)}}},[r,e,t]);return a&&!n?_e.default.createElement("div",{className:"ftp-credentials-section"},_e.default.createElement("h3",null,"FTP Credentials"),_e.default.createElement("div",{className:"loading-container"},"Loading FTP credentials...")):_e.default.createElement("div",{className:"ftp-credentials-section"},_e.default.createElement("h3",null,"FTP Credentials for MetaTrader"),c&&_e.default.createElement("div",{className:"ftp-error-message"},_e.default.createElement(lo,{size:16}),_e.default.createElement("span",null,c)),n?_e.default.createElement(_e.default.Fragment,null,_e.default.createElement("div",{className:"ftp-info-message"},_e.default.createElement("p",null,"Use these credentials to configure MetaTrader's FTP publishing settings:")),_e.default.createElement("div",{className:"ftp-credentials-grid"},_e.default.createElement("div",{className:"ftp-credential-field"},_e.default.createElement("label",null,"FTP Server:"),_e.default.createElement("div",{className:"input-with-action",style:{display:"flex",alignItems:"center",gap:"4px"}},_e.default.createElement("input",{type:"text",value:`${n.server}:${n.port}`,readOnly:!0,className:"ftp-readonly-input"}),_e.default.createElement("button",{className:"clickable-icon",onClick:()=>y(`${n.server}:${n.port}`,"server"),"aria-label":"Copy FTP server"},u==="server"?_e.default.createElement(Mo,{size:16}):_e.default.createElement(wl,{size:16})))),_e.default.createElement("div",{className:"ftp-credential-field"},_e.default.createElement("label",null,"FTP Login:"),_e.default.createElement("div",{className:"input-with-action",style:{display:"flex",alignItems:"center",gap:"4px"}},_e.default.createElement("input",{type:"text",value:n.username,readOnly:!0,className:"ftp-readonly-input"}),_e.default.createElement("button",{className:"clickable-icon",onClick:()=>y(n.username,"username"),"aria-label":"Copy FTP login"},u==="username"?_e.default.createElement(Mo,{size:16}):_e.default.createElement(wl,{size:16})))),(n.password||g)&&_e.default.createElement("div",{className:"ftp-credential-field"},_e.default.createElement("label",null,"FTP Password:"),_e.default.createElement("div",{className:"input-with-action",style:{display:"flex",alignItems:"center",gap:"4px"}},_e.default.createElement("input",{type:s?"text":"password",value:g?"*".repeat(12):n.password,readOnly:!0,className:"ftp-readonly-input"}),_e.default.createElement("button",{className:"clickable-icon",onClick:()=>y(n.password,"password"),disabled:g||!n.password,"aria-label":g?"Password not available for copying":"Copy password",style:{opacity:g?.5:1,cursor:g?"not-allowed":"pointer"}},g?_e.default.createElement(uw,{size:16}):u==="password"?_e.default.createElement(Mo,{size:16}):_e.default.createElement(wl,{size:16})),_e.default.createElement("button",{className:"clickable-icon",onClick:()=>l(!s),disabled:g,"aria-label":g?"Password hidden":s?"Hide password":"Show password",style:{opacity:g?.5:1,cursor:g?"not-allowed":"pointer"}},g?_e.default.createElement(bc,{size:16}):s?_e.default.createElement(hw,{size:16}):_e.default.createElement(vw,{size:16}))),_e.default.createElement("div",{className:"ftp-password-notice"},_e.default.createElement(lo,{size:14}),_e.default.createElement("span",null,g?"Password is stored but not available for viewing/copying. Reset password to get a new one.":"Save this password securely. It cannot be retrieved later.")))),_e.default.createElement("div",{className:"ftp-reset-password",style:{marginTop:"20px",marginBottom:"20px"}},_e.default.createElement("button",{className:"mod-cta",onClick:b,disabled:m,style:{width:"auto"}},m?"Resetting Password...":"Reset FTP Password"),_e.default.createElement("div",{style:{marginTop:"10px",fontSize:"14px",color:"var(--text-muted)"}},"Click this button to generate a new FTP password.")),_e.default.createElement("div",{className:"ftp-setup-instructions"},_e.default.createElement("h4",null,"MetaTrader Setup Instructions:"),_e.default.createElement("ol",null,_e.default.createElement("li",null,"Open MetaTrader\xA05 (MT5)"),_e.default.createElement("li",null,"Click on the ",_e.default.createElement("strong",null,'"Tools"')," menu at the top"),_e.default.createElement("li",null,"Select ",_e.default.createElement("strong",null,'"Options"')),_e.default.createElement("li",null,"Navigate to the ",_e.default.createElement("strong",null,'"FTP"')," tab and enter the FTP ",_e.default.createElement("em",null,"Server"),", ",_e.default.createElement("em",null,"Login"),", and ",_e.default.createElement("em",null,"Password")," shown above"),_e.default.createElement("li",null,"Enable ",_e.default.createElement("strong",null,'"Passive mode"')),_e.default.createElement("li",null,"Enable ",_e.default.createElement("strong",null,"automatic publishing of reports via FTP")," and set the refresh interval to ",_e.default.createElement("strong",null,"60\xA0minutes"))))):_e.default.createElement("div",{className:"ftp-no-credentials"},_e.default.createElement("p",null,'No FTP credentials found. Click "Create FTP Credentials" in the section above to generate them.')))}});var qr,YS,oge,age=L(()=>{qr=q(Y()),YS=require("obsidian");ou();Pl();oge=({plugin:e,accounts:t,onAccountsUpdated:r})=>{let[n,o]=(0,qr.useState)(""),[a,i]=(0,qr.useState)(""),[s,l]=(0,qr.useState)(!1),[c,d]=(0,qr.useState)([]);(0,qr.useEffect)(()=>{u()},[]);let u=async()=>{if(e.accountPageService)try{let f=(await e.accountPageService.getAllEnhancedAccounts()).map(g=>({id:g.id||g.name,name:g.name}));d(f)}catch(m){console.error("Failed to load Obsidian accounts:",m)}},p=async()=>{var m;if(!n||!a){new YS.Notice("Please select both source and target accounts");return}l(!0);try{let f=t.find(w=>w.accountId===n);if(!f)throw new Error("Source account not found");let g=c.find(w=>w.id===a);if(!g)throw new Error("Target account not found");if(((((m=e.settings.backendIntegration)==null?void 0:m.accountMapping)||{})[n]||f.displayName||`Account-${n}`)===g.name){new YS.Notice("This MT account is already linked to the selected Obsidian account"),l(!1);return}let y=e.serviceManager;if(!y)throw new Error("Service manager not available");let b=await y.getBackendIntegrationService();if(!b)throw new Error("Backend service not available");await b.updateAccountMapping(n,g.name);let x=await b.relinkAccountTrades(n,f.displayName||`Account-${n}`,g.name);new YS.Notice(`\u2705 Successfully relinked ${x.updatedCount} trades from ${f.displayName} to ${g.name}`),o(""),i(""),r()}catch(f){console.error("Failed to relink account:",f),new YS.Notice(`\u274C Failed to relink account: ${f.message}`)}finally{l(!1)}};return qr.default.createElement("div",{className:"account-linking-manager"},qr.default.createElement("div",{className:"setting-item"},qr.default.createElement("div",{className:"setting-item-info"},qr.default.createElement("div",{className:"setting-item-name"},"Change Account Linking"),qr.default.createElement("div",{className:"setting-item-description"},"Move all trades from one MT account to a different Obsidian account"))),qr.default.createElement("div",{className:"account-linking-controls"},qr.default.createElement("div",{className:"setting-item"},qr.default.createElement("div",{className:"setting-item-info"},qr.default.createElement("div",{className:"setting-item-name"},"Source MT Account"),qr.default.createElement("div",{className:"setting-item-description"},"Select the MT account whose trades you want to move")),qr.default.createElement("div",{className:"setting-item-control"},qr.default.createElement(En,{value:n,onChange:m=>o(m),options:t.map(m=>{var v;let g=(((v=e.settings.backendIntegration)==null?void 0:v.accountMapping)||{})[m.accountId]||m.displayName||`Account-${m.accountId}`;return{value:m.accountId,label:`${m.displayName||`Account-${m.accountId}`} (${m.accountId}) \u2192 ${g}`}}),placeholder:"Select source account...",style:{width:"350px"}}))),qr.default.createElement("div",{className:"setting-item"},qr.default.createElement("div",{className:"setting-item-info"},qr.default.createElement("div",{className:"setting-item-name"},"Target Obsidian Account"),qr.default.createElement("div",{className:"setting-item-description"},"Select the Obsidian account to link the trades to")),qr.default.createElement("div",{className:"setting-item-control"},qr.default.createElement(En,{value:a,onChange:m=>i(m),options:c.map(m=>({value:m.id,label:m.name})),placeholder:"Select target account...",style:{width:"250px"}}))),qr.default.createElement("div",{className:"setting-item"},qr.default.createElement("div",{className:"setting-item-control"},qr.default.createElement(he,{variant:"primary",onClick:p,disabled:s||!n||!a},s?"Processing...":"Relink Account"))),n&&a&&qr.default.createElement("div",{className:"account-linking-warning"},"\u26A0\uFE0F This will update all synced trades from the source account to be linked to the target account. This operation cannot be undone.")))}});var lc,ige=L(()=>{lc={connectionStatus:{display:"flex",alignItems:"center",gap:"8px"},refreshButton:{marginLeft:"8px",padding:"4px 8px",fontSize:"12px"},buttonContent:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"center"},syncInfoText:{fontSize:"11px",color:"var(--text-muted)",marginTop:"4px"},connectionError:{fontSize:"11px",color:"var(--text-error)",marginTop:"4px"},loadingContainer:{display:"flex",alignItems:"center",gap:"12px"},accountLinkingDivider:{marginTop:"30px",borderTop:"1px solid var(--background-modifier-border)",paddingTop:"20px"},accountRefreshWrapper:{marginTop:"20px"}}});var ye,yp,sge,lge=L(()=>{ye=q(Y());er();yp=require("obsidian");ou();ou();ym();up();eu();Zf();nge();age();Sc();ige();sge=({plugin:e})=>{var O,z;let t=e.settings.backendIntegration||wo.backendIntegration,[r,n]=(0,ye.useState)({status:"unknown",isSyncing:!1,lastSyncResult:null,syncStatus:null}),[o,a]=(0,ye.useState)({accounts:[],isLoading:!1}),i=(0,ye.useRef)(0),s=(0,ye.useRef)(0),[l,c]=(0,ye.useState)({hasCredentials:!1,isCreating:!1}),[d,u]=(0,ye.useState)(0),p=ye.default.useMemo(()=>{try{let I=e.app.vault.getName();if(I&&I!=="Obsidian Vault")return I.toLowerCase().replace(/[^a-z0-9]/g,"");let A=e.app.vault.adapter,j="";return yp.Platform.isDesktopApp&&A instanceof yp.FileSystemAdapter&&(j=A.getBasePath()),j?(j.split(/[/\\]/).pop()||"unknown").toLowerCase().replace(/[^a-z0-9]/g,""):`anon_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}catch(I){return`anon_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}},[e.app.vault]),[m,f]=(0,ye.useState)(null);(0,ye.useEffect)(()=>{let I=!0;return(async()=>{try{let j=await e.serviceManager.getBackendIntegrationService();if(!I)return;f(j),await g(),await Promise.allSettled([v(j),h(j),x(j)])}catch(j){let E=Pe.createContext("initialize backend integration",void 0,Pe.extractStatusCode(j));Pe.logError(j,E)}})(),()=>{I=!1}},[e.serviceManager]);let g=(0,ye.useCallback)(async()=>{try{let A=await tt.checkHealth()?"connected":"disconnected";n(j=>({...j,status:A}))}catch(I){n(A=>({...A,status:"disconnected"}))}},[]),v=(0,ye.useCallback)(async I=>{let A=I||m;if(A)try{let j=await A.getSyncStatus();if(n(E=>({...E,syncStatus:j})),j&&j.last_sync_time&&j.sync_count!==void 0){let E=new Date(j.last_sync_time).getTime(),N=t.lastSyncTime?new Date(t.lastSyncTime).getTime():0;(E>N||j.sync_count>(t.syncCount||0))&&(await y("lastSyncTime",j.last_sync_time),await y("syncCount",j.sync_count))}}catch(j){let E=Pe.createContext("load sync status","/api/v1/sync/status",Pe.extractStatusCode(j));Pe.logError(j,E)}},[m,t.lastSyncTime,t.syncCount]),h=(0,ye.useCallback)(async I=>{let A=I||m;if(!A||r.status==="disconnected"&&!I||o.isLoading)return;let j=Date.now();if(!(j-i.current<5e3)){i.current=j,a(E=>({...E,isLoading:!0}));try{let E=await A.fetchUserAccounts(),N=t.accountMapping||{},B=E.map(F=>({...F,displayName:N[F.accountId]||F.displayName||`Account-${F.accountId}`}));a(F=>({...F,accounts:B,isLoading:!1})),E.some(F=>F.displayName&&!N[F.accountId])&&await A.updateAccountMappings(B)}catch(E){if(Date.now()-s.current>3e4){let N=Pe.createContext("load MT accounts","/api/v1/mt-accounts",Pe.extractStatusCode(E));Pe.handleError(E,N),s.current=Date.now()}a(N=>({...N,isLoading:!1,accounts:[]}))}}},[m,r.status]);(0,ye.useEffect)(()=>{r.status==="connected"&&m&&o.accounts.length===0&&!o.isLoading&&Date.now()-i.current>5e3&&h()},[r.status,m]);let y=(0,ye.useCallback)(async(I,A)=>{I==="serverUrl"&&tt.clearCache(),e.settings.backendIntegration={...e.settings.backendIntegration,[I]:A},await e.saveSettings(),m&&await m.updateSettings({[I]:A})},[e,m]),b=async I=>{await y("syncEnabled",I),u(A=>A+1),new yp.Notice(`Auto-sync ${I?"enabled":"disabled"}`)},x=(0,ye.useCallback)(async I=>{let A=I||m;if(A)try{if(t.ftpUsername){let j=await A.getFTPCredentials(t.ftpUsername);c(E=>({...E,hasCredentials:!!j}))}else c(j=>({...j,hasCredentials:!1}))}catch(j){let E=Pe.createContext("check FTP credentials","/api/v1/ftp-users",Pe.extractStatusCode(j));Pe.logError(j,E),c(N=>({...N,hasCredentials:!1}))}},[m,t.ftpUsername]),w=(0,ye.useCallback)(async()=>{if(m){c(I=>({...I,isCreating:!0}));try{let I=await m.createOrGetFTPUser();if(I){await y("ftpUsername",I.username),await y("ftpPassword",I.password||""),c(j=>({...j,hasCredentials:!0})),new yp.Notice("FTP credentials created successfully");let A=new CustomEvent("ftp-credentials-created",{detail:{credentials:I}});window.dispatchEvent(A),await h()}}catch(I){let A=Pe.createContext("create FTP credentials","/api/v1/ftp-users",Pe.extractStatusCode(I));Pe.handleError(I,A)}finally{c(I=>({...I,isCreating:!1}))}}},[m,y,h]),S=(0,ye.useCallback)(async()=>{if(m){if(!e.authManager||!e.authManager.isAuthenticated()){new yp.Notice("Please sign in to register your vault.");return}n(I=>({...I,isSyncing:!0}));try{await y("userId",p),await m.registerVault()&&(n(A=>({...A,status:"connected"})),await v(),await x())}catch(I){let A=Pe.createContext("vault registration","/api/v1/register-vault",Pe.extractStatusCode(I));Pe.handleError(I,A)}finally{n(I=>({...I,isSyncing:!1}))}}},[m,y,p,v,x,e.authManager]),k=(0,ye.useCallback)(async()=>{if(m){if(!e.authManager||!e.authManager.isAuthenticated()){new yp.Notice("Please sign in to use automated sync.");return}n(I=>({...I,isSyncing:!0}));try{let I=await m.requestForceSync();n(A=>({...A,lastSyncResult:I})),await v()}catch(I){let A=Pe.createContext("force sync","/api/v1/sync/force",Pe.extractStatusCode(I));Pe.handleError(I,A)}finally{n(I=>({...I,isSyncing:!1}))}}},[m,v,e.authManager]),T=(0,ye.useMemo)(()=>{switch(r.status){case"connected":return"\u{1F7E2}";case"disconnected":return"\u{1F534}";default:return"\u{1F7E1}"}},[r.status]),P=(0,ye.useMemo)(()=>{switch(r.status){case"connected":return"Connected";case"disconnected":return"Disconnected";default:return"Checking..."}},[r.status]),D=I=>{if(!I)return"Never";try{let A=new Date(I),j=e.settings.trade.dateFormat||"DDMMYY",E=String(A.getDate()).padStart(2,"0"),N=String(A.getMonth()+1).padStart(2,"0"),B=String(A.getFullYear()).slice(-2),C=String(A.getHours()).padStart(2,"0"),F=String(A.getMinutes()).padStart(2,"0"),M="";switch(j){case"DDMMYY":M=`${E}/${N}/${B}`;break;case"MMDDYY":M=`${N}/${E}/${B}`;break;case"YYMMDD":M=`${B}/${N}/${E}`;break;default:M=`${E}/${N}/${B}`}return`${M} ${C}:${F}`}catch(A){return"Invalid date"}};return ye.default.createElement("div",{className:"journalit-settings-tab backend-integration-settings"},ye.default.createElement("h3",null,"Backend Integration"),ye.default.createElement("p",{className:"setting-item-description"},"Connect to the trading server for automatic trade synchronization."),ye.default.createElement(fr,{title:"Connection Settings",defaultExpanded:!0},ye.default.createElement("div",{className:"setting-item"},ye.default.createElement("div",{className:"setting-item-info"},ye.default.createElement("div",{className:"setting-item-name"},"Connection Status"),ye.default.createElement("div",{className:"setting-item-description"},"Current connection status to the trading server")),ye.default.createElement("div",{className:"setting-item-control"},ye.default.createElement("span",{style:lc.connectionStatus},ye.default.createElement("span",null,T),ye.default.createElement("span",null,P),ye.default.createElement(he,{variant:"secondary",onClick:g,style:lc.refreshButton},ye.default.createElement(Of,{size:16}))))),ye.default.createElement("div",{className:"setting-item"},ye.default.createElement("div",{className:"setting-item-info"},ye.default.createElement("div",{className:"setting-item-name"},"Register Vault"),ye.default.createElement("div",{className:"setting-item-description"},"Register this vault with the backend server for sync")),ye.default.createElement("div",{className:"setting-item-control"},ye.default.createElement(he,{variant:"primary",onClick:S,disabled:r.isSyncing||!m},ye.default.createElement("div",{style:lc.buttonContent},r.isSyncing&&ye.default.createElement(zo,{size:"small",message:""}),r.isSyncing?"Registering...":"Register Vault")))),r.status==="connected"&&!l.hasCredentials&&ye.default.createElement("div",{className:"setting-item"},ye.default.createElement("div",{className:"setting-item-info"},ye.default.createElement("div",{className:"setting-item-name"},"FTP Credentials"),ye.default.createElement("div",{className:"setting-item-description"},"Create FTP credentials to upload MetaTrader reports. A unique username will be generated automatically.")),ye.default.createElement("div",{className:"setting-item-control"},ye.default.createElement(he,{variant:"primary",onClick:w,disabled:l.isCreating||!m},ye.default.createElement("div",{style:lc.buttonContent},l.isCreating&&ye.default.createElement(zo,{size:"small",message:""}),l.isCreating?"Creating...":"Create FTP Credentials"))))),ye.default.createElement(fr,{title:"Sync Settings",defaultExpanded:!0},ye.default.createElement("div",{className:"setting-item"},ye.default.createElement("div",{className:"setting-item-info"},ye.default.createElement("div",{className:"setting-item-name"},"Enable Auto-Sync"),ye.default.createElement("div",{className:"setting-item-description"},"Automatically sync trades from the backend server",ye.default.createElement("div",{style:lc.syncInfoText},ye.default.createElement(Xp,{size:16})," Auto-sync checks for new trades every hour"))),ye.default.createElement("div",{className:"setting-item-control"},ye.default.createElement(Zo,{checked:t.syncEnabled||!1,onChange:b,id:"sync-enabled-toggle",ariaLabel:"Enable auto-sync"}))),ye.default.createElement("div",{className:"setting-item"},ye.default.createElement("div",{className:"setting-item-info"},ye.default.createElement("div",{className:"setting-item-name"},"Manual Sync"),ye.default.createElement("div",{className:"setting-item-description"},"Force immediate synchronization of trades",ye.default.createElement("div",{style:lc.syncInfoText},ye.default.createElement(Xp,{size:16})," Average wait time: 2-3 minutes (maximum: 5 minutes)"))),ye.default.createElement("div",{className:"setting-item-control"},ye.default.createElement(he,{variant:"primary",onClick:k,disabled:r.isSyncing||!m},ye.default.createElement("div",{style:lc.buttonContent},r.isSyncing&&ye.default.createElement(zo,{size:"small",message:""}),r.isSyncing?"Syncing...":"Force Sync Now")))),r.lastSyncResult&&ye.default.createElement("div",{className:"setting-item"},ye.default.createElement("div",{className:"setting-item-info"},ye.default.createElement("div",{className:"setting-item-name"},"Last Sync Result"),ye.default.createElement("div",{className:"setting-item-description"},r.lastSyncResult.synced_trades>0?ye.default.createElement(ye.default.Fragment,null,ye.default.createElement(Qo,{size:16})," Synced ",r.lastSyncResult.synced_trades," trades (",r.lastSyncResult.new_files," new files)"):ye.default.createElement(ye.default.Fragment,null,ye.default.createElement(Qo,{size:16})," No new trades to sync")))),(t.lastSyncTime||r.syncStatus)&&ye.default.createElement("div",{className:"setting-item"},ye.default.createElement("div",{className:"setting-item-info"},ye.default.createElement("div",{className:"setting-item-name"},"Sync Status"),ye.default.createElement("div",{className:"setting-item-description"},"Last sync: ",D(t.lastSyncTime||((O=r.syncStatus)==null?void 0:O.last_sync_time))," | Total syncs: ",t.syncCount||((z=r.syncStatus)==null?void 0:z.sync_count)||0)))),ye.default.createElement(fr,{title:"Trading Accounts",defaultExpanded:!1},ye.default.createElement("div",{className:"setting-item"},ye.default.createElement("div",{className:"setting-item-info"},ye.default.createElement("div",{className:"setting-item-name"},"Linked MT Accounts"),ye.default.createElement("div",{className:"setting-item-description"},"MetaTrader accounts detected from synced reports",r.status==="disconnected"&&ye.default.createElement("div",{style:lc.connectionError},ye.default.createElement(lo,{size:16})," Server is disconnected. Please check connection status.")))),o.isLoading?ye.default.createElement("div",{className:"setting-item"},ye.default.createElement("div",{className:"setting-item-info"},ye.default.createElement("div",{style:lc.loadingContainer},ye.default.createElement(zo,{message:"Loading accounts...",size:"small"})))):o.accounts.length===0?ye.default.createElement("div",{className:"setting-item"},ye.default.createElement("div",{className:"setting-item-info"},ye.default.createElement("div",{className:"setting-item-description"},"No accounts found.",r.status==="connected"?"Sync some trades to detect accounts.":"Connect to the server and sync trades to see accounts."))):ye.default.createElement("div",{className:"mt-accounts-list"},o.accounts.map(I=>ye.default.createElement("div",{key:I.accountId,className:"mt-account-item"},ye.default.createElement("div",{className:"mt-account-info"},ye.default.createElement("div",{className:"mt-account-id"},"Account ID: ",I.accountId),I.brokerName&&ye.default.createElement("div",{className:"mt-account-broker"},"Broker: ",I.brokerName),ye.default.createElement("div",{className:"mt-account-dates"},I.firstSeen&&ye.default.createElement("span",null,"First seen: ",D(I.firstSeen)),I.lastSeen&&ye.default.createElement("span",null," | Last seen: ",D(I.lastSeen)))),ye.default.createElement("div",{className:"mt-account-display"},ye.default.createElement("div",{className:"mt-account-name"},ye.default.createElement("span",null,I.displayName||`Account-${I.accountId}`)))))),ye.default.createElement("div",{className:"setting-item",style:lc.accountRefreshWrapper},ye.default.createElement("div",{className:"setting-item-control"},ye.default.createElement(he,{variant:"secondary",onClick:()=>h(),disabled:o.isLoading||!m},"Refresh Accounts"))),o.accounts.length>0&&ye.default.createElement("div",{style:lc.accountLinkingDivider},ye.default.createElement(oge,{plugin:e,accounts:o.accounts,onAccountsUpdated:h}))),l.hasCredentials&&ye.default.createElement(fr,{title:"MetaTrader FTP Credentials",defaultExpanded:!1},ye.default.createElement(rge,{userId:t.ftpUsername||p})))}});var uge={};Ko(uge,{JournalitSettingsTab:()=>T6});var cge,Ii,dge,T6,$Be,pge=L(()=>{cge=require("obsidian"),Ii=q(Y()),dge=q(wn());Afe();Hfe();Yfe();ege();lge();ba();TO();T6=class extends cge.PluginSettingTab{constructor(r,n){super(r,n);this.root=null;this.initialTab="general";this.plugin=n}setInitialTab(r){this.initialTab=r}display(){ju(),GC();let r=document.head.querySelector("#settings-tab-styles"),{containerEl:n}=this;n.empty(),n.addClass("journalit-settings");let o=n.createDiv({cls:"journalit-settings-wrapper"});this.root||(this.root=(0,dge.createRoot)(o));let a=this.initialTab;this.initialTab="general",this.root.render(Ii.default.createElement(Ii.default.StrictMode,null,Ii.default.createElement($Be,{plugin:this.plugin,initialTab:a})))}hide(){this.root&&(this.root.unmount(),this.root=null),this.containerEl.empty(),this.containerEl.removeClass("journalit-settings")}},$Be=Ii.default.memo(({plugin:e,initialTab:t="general"})=>{let[r,n]=(0,Ii.useState)(t),o=i=>{n(i)};return Ii.default.createElement("div",{className:"settings-tab-container"},Ii.default.createElement("nav",{className:"settings-tab-nav"},[{id:"general",label:"General"},{id:"reviews",label:"Reviews & Analysis"},{id:"accounts",label:"Auth"},{id:"backend",label:"Backend Integration"},{id:"customization",label:"Customisation"}].map(i=>Ii.default.createElement("button",{key:i.id,className:`settings-tab-button ${r===i.id?"settings-tab-button--active":""}`,onClick:()=>o(i.id)},i.label))),Ii.default.createElement("div",{className:"settings-tab-content journalit-tab-content",role:"tabpanel","aria-labelledby":`tab-${r}`},r==="general"&&Ii.default.createElement(Ife,{plugin:e}),r==="reviews"&&Ii.default.createElement(Vfe,{plugin:e}),r==="accounts"&&Ii.default.createElement(Gfe,{plugin:e}),r==="backend"&&Ii.default.createElement(sge,{plugin:e}),r==="customization"&&Ii.default.createElement(Zfe,{plugin:e})))})});var WBe={};Ko(WBe,{default:()=>Qd});module.exports=uu(WBe);var KS=require("obsidian");Td();Oo();Oo();var nxe=`
  /* Fix for duplicate tooltips */
  .journalit-icon-button,
  .journalit-button,
  .drc-note-grade-dropdown select {
    position: relative !important;
  }
  
  /* Hide Obsidian's native tooltips on our buttons */
  .tooltip[style*="visibility: visible"],
  .another-tooltip[style*="visibility: visible"],
  .is-tooltip[style*="visibility: visible"],
  .tooltip,
  .another-tooltip,
  .is-tooltip {
    display: none !important;
    visibility: hidden !important;
    opacity: 0 !important;
    pointer-events: none !important;
  }

  /* Fix for grade display tooltips */
  .drc-note-grade-dropdown::before,
  .drc-note-grade-dropdown::after,
  .drc-note-grade-dropdown select::before,
  .drc-note-grade-dropdown select::after {
    content: none !important;
    display: none !important;
  }

  /* Hide any tooltips that appear within our custom components */
  .drc-container .tooltip,
  .drc-note-grade-dropdown .tooltip,
  .drc-note-grade-value .tooltip {
    display: none !important;
    visibility: hidden !important;
    opacity: 0 !important;
    z-index: -1 !important;
  }

  /* CRITICAL FIX: Ensure our grade elements display properly with accurate vertical centering */
  .drc-note-grade-value,
  select.drc-note-grade-value {
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    text-align: center !important;
    width: 60px !important;
    height: 60px !important;
    border-radius: 50% !important;
    margin: 0 auto !important;
    font-size: 18px !important;
    /* The padding-bottom adjustment is critical for proper vertical centering of text */
    padding: 0 0 4px 0 !important; 
    overflow: visible !important;
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    appearance: none !important;
    line-height: 1 !important; /* Critical for proper vertical centering */
    vertical-align: middle !important;
  }

  /* Ensure text is properly centered in all browsers */
  .drc-note-grade-value,
  .drc-note-grade-dropdown select,
  .drc-note-grade-dropdown option {
    text-align: center !important;
    text-align-last: center !important;
  }

  /* No-tooltip button styles - match IconButton */
  .journalit-no-tooltip-button {
    position: relative;
    background: none;
    border: none;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 6px;
    border-radius: 4px;
    transition: all 0.2s ease;
    color: var(--text-muted);
    width: 30px;
    height: 30px;
    margin: 0 2px;
    box-sizing: content-box;
  }

  /* Style hover state for buttons */
  .journalit-no-tooltip-button:hover {
    background-color: var(--background-modifier-hover);
    color: var(--text-normal);
  }

  /* Style active state for buttons */
  .journalit-no-tooltip-button:active {
    background-color: var(--background-modifier-active);
    transform: translateY(1px);
  }

  /* Custom tooltip implementation */
  .journalit-no-tooltip-button {
    position: relative;
  }

  /* Define tooltip using ::before pseudo-element */
  .journalit-no-tooltip-button::before {
    content: attr(data-label);
    position: absolute;
    bottom: 120%;
    left: 50%;
    transform: translateX(-50%);
    margin-bottom: 0;
    background-color: var(--background-secondary);
    color: var(--text-normal);
    padding: 5px 10px;
    border-radius: 4px;
    font-size: 12px;
    white-space: nowrap;
    opacity: 0;
    visibility: hidden;
    transition: all 0.2s ease;
    z-index: 10000;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    pointer-events: none;
  }

  /* Show tooltip on hover */
  .journalit-no-tooltip-button:hover::before {
    opacity: 1;
    visibility: visible;
    bottom: 100%;
    margin-bottom: 4px;
  }

  /* Fix for SVG within buttons */
  .journalit-no-tooltip-button svg {
    width: 18px;
    height: 18px;
    pointer-events: none;
    fill: none;
  }

  /* Style the debug outline */
  .journalit-no-tooltip-button.debug {
    outline: 1px solid red;
  }

  .journalit-no-tooltip-button:hover.debug {
    outline: 2px solid green;
  }
`;function oxe(){let e=document.createElement("style");e.id="tooltip-fix-styles",e.textContent=nxe,document.head.appendChild(e)}function axe(){let e=document.head.querySelector("#tooltip-fix-styles");e&&e.remove()}ce.tooltip={inject:oxe,remove:axe};Oo();d0();ce.shared={inject:KC,remove:LO};Oo();var ixe=`
/**
 * File: src/styles/interactions.css
 * Purpose: Interactive component hover states and transitions
 * Related files: All components using inline hover styles
 *
 * Obsidian theme-compatible interactive styles
 */

/* Icon button hover states */
.jl-icon-button-hover {
  background: none;
  color: var(--text-muted);
  transition: background 0.2s ease, color 0.2s ease;
  cursor: pointer;
}

.jl-icon-button-hover:hover:not(:disabled) {
  background: var(--background-modifier-hover);
  color: var(--text-normal);
}

/* Restore/action button hover */
.jl-restore-button-hover {
  background-color: var(--background-secondary);
  border-color: var(--background-modifier-border);
  transition: all 0.2s ease;
}

.jl-restore-button-hover:hover:not(:disabled) {
  background-color: var(--background-modifier-hover);
  border-color: var(--text-accent);
}

/* Quick link buttons with lift effect */
.jl-quick-link-hover {
  background-color: var(--background-secondary);
  border-color: var(--background-modifier-border);
  transform: translateY(0);
  box-shadow: none;
  transition: all 0.2s ease;
}

.jl-quick-link-hover:hover:not(:disabled) {
  background-color: var(--background-modifier-hover);
  border-color: var(--link-color, var(--interactive-accent));
  transform: translateY(-1px);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

/* Recent item card hover */
.jl-recent-item-hover {
  background-color: var(--background-secondary);
  border-color: var(--background-modifier-border);
  transition: all 0.2s ease;
}

.jl-recent-item-hover:hover {
  background-color: var(--background-modifier-hover);
  border-color: var(--interactive-accent);
}

/* Checkbox hover states */
/* Unchecked hover state */
.jl-checkbox-wrapper:hover .jl-checkbox:not(.jl-checkbox-checked) {
  background-color: var(--background-modifier-hover);
  border-color: var(--interactive-accent);
}

/* Checked hover state - opacity change for clear feedback */
.jl-checkbox-wrapper:hover .jl-checkbox.jl-checkbox-checked {
  opacity: 0.85 !important;
  box-shadow: 0 0 0 2px var(--background-modifier-border) !important;
}

.jl-checkbox {
  background-color: var(--background-primary);
  border-color: var(--background-modifier-border);
  transition: background-color 0.2s ease, border-color 0.2s ease;
}

.jl-checkbox-checked {
  background-color: var(--interactive-accent);
  border-color: var(--interactive-accent);
}

/* Ensure SVG checkmark doesn't block hover/cursor */
.jl-checkbox svg {
  pointer-events: none !important;
}

/* Ensure the entire wrapper and all children show pointer cursor */
.jl-checkbox-wrapper,
.jl-checkbox-wrapper *:not(svg) {
  cursor: pointer !important;
}

/* Make sure the label covers the full clickable area */
.jl-checkbox-wrapper label {
  display: flex !important;
  align-items: center !important;
  cursor: pointer !important;
}

/* Ensure checkbox div maintains cursor */
.jl-checkbox {
  cursor: pointer !important;
}

/* Destructive actions */
.jl-button-destructive {
  background-color: var(--background-modifier-error);
  color: var(--text-on-accent);
  border-color: var(--background-modifier-error);
}

.jl-button-destructive:hover:not(:disabled) {
  background-color: var(--background-modifier-error-hover);
  opacity: 0.9;
}

/* Utility classes */
.jl-image-hidden {
  display: none;
}

.jl-component-visible {
  display: block !important;
}

.jl-force-redraw {
  opacity: 0.99;
  animation: redraw 0.01s;
}

@keyframes redraw {
  to { opacity: 1; }
}

/* Focus management utility */
.jl-focus-reset-input {
  position: absolute;
  opacity: 0;
  height: 0;
  width: 0;
  pointer-events: none;
}

/* Component container resets */
.jl-component-reset {
  margin: 0;
  padding: 0;
  border: none;
}

.jl-component-container-reset {
  margin: 0;
  padding: 0;
  border: none;
  width: 100%;
  display: block;
  box-sizing: border-box;
}
`;function CG(){if(document.getElementById("journalit-interactions-styles"))return;let e=document.createElement("style");e.id="journalit-interactions-styles",e.textContent=ixe,document.head.appendChild(e)}function PG(){let e=document.getElementById("journalit-interactions-styles");e&&e.remove()}ce.interactions={inject:CG,remove:PG};Oo();MO();ce.combobox={inject:NO,remove:fG};Oo();var sxe=`
/**
 * File: src/styles/processor-components.css
 * Purpose: Utility classes for processor components to replace JavaScript inline styles
 * Related files:
 * - ../components/monthly/MonthlyReviewProcessor.ts
 * - ../components/weekly/WeeklyReviewProcessor.ts
 * - ../components/missedTrade/MissedTradeNoteProcessor.ts
 * - ../components/drc/DRCNoteProcessor.ts
 */

/* Component container resets */
.journalit-component-container {
  margin: 0;
  padding: 0;
  border: none;
  width: 100%;
  display: block;
  box-sizing: border-box;
}

/* Calendar-specific positioning */
.journalit-calendar-cell-relative {
  position: relative;
  display: flex;
  flex-direction: column;
  padding: 4px;
}

.journalit-calendar-day-number {
  position: absolute;
  top: 4px;
  left: 4px;
  text-align: left;
}

.journalit-calendar-pnl-centered {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 100%;
  margin-top: 0;
  text-align: center;
}

.journalit-calendar-trade-count {
  position: absolute;
  top: 65%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 100%;
  text-align: center;
}

/* Grid layout utilities */
.journalit-grid-weekdays-5 {
  display: grid;
  grid-template-columns: repeat(5, 1fr) 1fr;
  gap: 4px;
}

.journalit-grid-weekdays-7 {
  display: grid;
  grid-template-columns: repeat(7, 1fr) 1fr;
  gap: 4px;
}

/* Responsive text sizing with CSS custom properties */
.journalit-calendar-responsive {
  --cell-day-number-size: 12px;
  --cell-pnl-size: 12px;
  --cell-trade-size: 10px;
}

@media (max-width: 600px) {
  .journalit-calendar-responsive {
    --cell-day-number-size: 10px;
    --cell-pnl-size: 10px;
    --cell-trade-size: 8px;
  }
}

/* Container queries for calendar cells (modern browsers) */
.journalit-calendar-day {
  container-type: inline-size;
  container-name: calendar-cell;
}

@container calendar-cell (max-width: 30px) {
  .journalit-calendar-day-number { font-size: 8px; }
  .journalit-calendar-pnl-centered { font-size: 8px; }
  .journalit-calendar-trade-count { font-size: 7px; }
}

@container calendar-cell (min-width: 31px) and (max-width: 50px) {
  .journalit-calendar-day-number { font-size: 10px; }
  .journalit-calendar-pnl-centered { font-size: 10px; }
  .journalit-calendar-trade-count { font-size: 8px; }
}

@container calendar-cell (min-width: 51px) {
  .journalit-calendar-day-number { font-size: 12px; }
  .journalit-calendar-pnl-centered { font-size: 12px; }
  .journalit-calendar-trade-count { font-size: 10px; }
}
`;function DG(){if(document.getElementById("journalit-processor-component-styles"))return;let e=document.createElement("style");e.id="journalit-processor-component-styles",e.textContent=sxe,document.head.appendChild(e)}function EG(){let e=document.getElementById("journalit-processor-component-styles");e&&e.remove()}ce.processorComponent={inject:DG,remove:EG};Oo();c0();ce.chart={inject:YC,remove:EO};Oo();ow();ce.image={inject:Df,remove:oV};Oo();n0();ce.weeklyReview={inject:SO,remove:tG};qC();Oo();UO();ce.tradeForm={inject:c1,remove:d1};Oo();Av();ce.dashboard={inject:Iv,remove:dG};Oo();var lxe=`
/* Account Note Styles */
.journalit-account-note {
  display: flex;
  flex-direction: column;
  width: 100%;
  font-family: var(--font-text);
  color: var(--text-normal);
}

/* Account Balance Chart Styles */
.journalit-account .account-balance-chart-container {
  margin-bottom: 25px;
  border-radius: 8px;
  padding: 12px 16px;
  /* Removed border to make chart feel less cramped */
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.journalit-account .account-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 15px;
  border-bottom: 1px solid var(--background-modifier-border);
}

.journalit-account .account-name {
  font-size: 1.8rem;
  font-weight: 600;
  color: var(--text-normal);
}

.journalit-account .account-type {
  font-size: 1rem;
  color: var(--text-muted);
  background-color: var(--background-secondary);
  padding: 4px 8px;
  border-radius: 4px;
}

.journalit-account .account-summary {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
  margin-bottom: 30px;
}

.journalit-account .account-metric {
  flex: 1;
  min-width: 200px;
  padding: 15px;
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.journalit-account .metric-label {
  font-size: 0.9rem;
  color: var(--text-muted);
  margin-bottom: 5px;
}

.journalit-account .metric-value {
  font-size: 1.3rem;
  font-weight: 600;
  color: var(--text-normal);
}

.journalit-account .account-details,
.journalit-account .account-performance {
  margin-bottom: 30px;
}

.journalit-account h3 {
  font-size: 1.3rem;
  font-weight: 600;
  margin-bottom: 15px;
  padding-bottom: 8px;
  border-bottom: 1px solid var(--background-modifier-border);
}

.journalit-account .details-grid,
.journalit-account .metrics-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 15px;
}

.journalit-account .detail-item,
.journalit-account .metric-item {
  padding: 10px;
  background-color: var(--background-secondary);
  border-radius: 4px;
  width: 100%;
  box-sizing: border-box;
}

.journalit-account .detail-label,
.journalit-account .metric-label {
  font-size: 0.8rem;
  color: var(--text-muted);
  margin-bottom: 5px;
}

.journalit-account .detail-value,
.journalit-account .metric-value {
  font-size: 1.1rem;
  font-weight: 500;
  color: var(--text-normal);
}

/* Cost details styles */
.journalit-account .cost-details {
  margin-top: 5px;
  font-size: 0.85rem;
  color: var(--text-muted);
}

.journalit-account .cost-total {
  font-weight: 500;
}

.journalit-account .cost-months {
  font-style: italic;
  font-size: 0.8rem;
}

/* Profit Target Styles */
.journalit-account .profit-target-item {
  grid-column: 1 / -1; /* Make the profit target item span the full width */
  width: 100%;
  box-sizing: border-box;
  margin: 0;
}

.journalit-account .target-date {
  font-size: 0.9rem;
  color: var(--text-muted);
  font-style: italic;
  margin-left: 5px;
}

.journalit-account .target-progress {
  font-size: 0.9rem;
  color: var(--text-muted);
  margin-left: 5px;
}

.journalit-account .profit-target-progress {
  margin-top: 10px;
}

.journalit-account .progress-container {
  width: 100%;
  height: 10px;
  background-color: var(--background-modifier-border);
  border-radius: 5px;
  overflow: hidden;
}

.journalit-account .progress-bar {
  height: 100%;
  background-color: var(--interactive-accent);
  border-radius: 5px;
  transition: width 0.5s ease;
}

.journalit-account .progress-bar.complete {
  background-color: gold; /* Gold color when target is reached */
}

/* Transaction Table Styles */
.journalit-account .account-transactions {
  margin-top: 20px;
}

.journalit-account .transactions-table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 10px;
  font-size: 0.9rem;
}

.journalit-account .transactions-table thead {
  background-color: var(--background-secondary);
}

.journalit-account .transactions-table th {
  text-align: left;
  padding: 10px;
  font-weight: 600;
  color: var(--text-normal);
  border-bottom: 2px solid var(--background-modifier-border);
}

.journalit-account .transactions-table td {
  padding: 10px;
  border-bottom: 1px solid var(--background-modifier-border);
}

.journalit-account .transactions-table .transaction-row:hover {
  background-color: var(--background-secondary);
}

.journalit-account .transactions-table .positive {
  color: var(--interactive-success);
}

.journalit-account .transactions-table .negative {
  color: var(--text-error);
}

.journalit-account .transactions-table .deposit {
  background-color: rgba(var(--interactive-success-rgb), 0.05);
}

.journalit-account .transactions-table .withdrawal {
  background-color: rgba(var(--text-error-rgb), 0.05);
}

.journalit-account .empty-transactions {
  padding: 20px;
  text-align: center;
  color: var(--text-muted);
  background-color: var(--background-secondary);
  border-radius: 4px;
}

/* Account Dashboard View Styles */
.journalit-account-dashboard-container {
  padding: 20px;
  height: 100%;
  overflow-y: auto;
  background-color: var(--background-primary);
}

.journalit-account-dashboard {
  width: 100%;
  padding: 20px;
}

.journalit-account-dashboard .dashboard-content {
  display: flex;
  flex-direction: column;
  width: 100%;
}

/* AUM Chart Styles */
.journalit-account-dashboard .aum-chart {
  width: 100%;
  margin-bottom: 10px;
}

/* Dashboard Header Styles */
.journalit-account-dashboard .dashboard-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 20px;
  padding: 16px 20px;
  background-color: var(--background-secondary);
  border-radius: 8px;
  border: 1px solid var(--background-modifier-border);
}

.journalit-account-dashboard .dashboard-title h2 {
  margin: 0 0 4px 0;
  font-size: 1.5rem;
  font-weight: 600;
  color: var(--text-normal);
}

.journalit-account-dashboard .dashboard-title p {
  margin: 0;
  font-size: 0.9rem;
  color: var(--text-muted);
}

.journalit-account-dashboard .dashboard-actions {
  display: flex;
  align-items: center;
  gap: 12px;
}

.journalit-account-dashboard .create-account-button {
  flex-shrink: 0;
  background-color: var(--interactive-accent);
  color: white;
  border: 1px solid var(--interactive-accent);
  border-radius: 6px;
  padding: 10px;
  cursor: pointer;
  transition: background-color 0.2s ease, transform 0.1s ease;
}

.journalit-account-dashboard .create-account-button:hover {
  background-color: var(--interactive-accent-hover);
  border-color: var(--interactive-accent-hover);
  transform: translateY(-1px);
}

.journalit-account-dashboard .settings-button {
  flex-shrink: 0;
  background-color: transparent;
  color: var(--text-muted);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  padding: 10px;
  cursor: pointer;
  transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease;
}

.journalit-account-dashboard .settings-button:hover {
  background-color: var(--background-modifier-hover);
  color: var(--text-normal);
  border-color: var(--background-modifier-border-hover);
}

/* Account Dashboard Settings Modal Styles */
.account-dashboard-settings-modal-container {
  max-width: 700px;
  margin: 0 auto;
  padding: 0 12px;
}

/* Folder Migration Modal Styles */
.folder-migration-modal-container {
  max-width: 600px;
  margin: 0 auto;
  padding: 0 12px;
}

.folder-migration-modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  z-index: 9999;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 20px;
}

.folder-migration-modal {
  background: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  padding: 0;
  max-width: 600px;
  width: 100%;
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
}

.migration-warning-header {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 20px 24px;
  background: linear-gradient(135deg, rgba(var(--color-red-rgb), 0.1) 0%, rgba(var(--color-red-rgb), 0.05) 100%);
  border-bottom: 1px solid var(--background-modifier-border);
  border-radius: 8px 8px 0 0;
}

.migration-warning-header .warning-icon {
  color: var(--text-error);
  flex-shrink: 0;
}

.migration-warning-header h3 {
  margin: 0;
  font-size: 1.2rem;
  font-weight: 600;
  color: var(--text-error);
  border: none;
  padding: 0;
}

.migration-content {
  padding: 24px;
}

.migration-warning {
  margin-bottom: 24px;
  padding: 16px;
  background: rgba(var(--color-red-rgb), 0.1);
  border: 1px solid rgba(var(--color-red-rgb), 0.3);
  border-radius: 6px;
}

.migration-warning p {
  margin: 0 0 8px 0;
  color: var(--text-normal);
  line-height: 1.5;
}

.migration-warning p:last-child {
  margin-bottom: 0;
}

.migration-details {
  margin-bottom: 24px;
}

.migration-path-container {
  display: flex;
  flex-direction: column;
  gap: 12px;
  padding: 16px;
  background: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
}

.migration-path {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 0;
}

.migration-path .path-label {
  font-weight: 500;
  color: var(--text-muted);
  min-width: 50px;
}

.migration-path .path-text {
  background: var(--background-modifier-form-field);
  padding: 4px 8px;
  border-radius: 4px;
  font-family: var(--font-monospace);
  font-size: 0.9rem;
  color: var(--text-normal);
  flex: 1;
}

.migration-arrow {
  color: var(--text-muted);
  align-self: center;
  margin: 4px 0;
}

.impact-analysis {
  margin-bottom: 24px;
}

.impact-analysis h4 {
  margin: 0 0 12px 0;
  font-size: 1rem;
  font-weight: 600;
  color: var(--text-normal);
}

.impact-details {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.impact-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  background: var(--background-secondary);
  border-radius: 4px;
  border-left: 3px solid var(--interactive-accent);
}

.impact-item svg {
  color: var(--interactive-accent);
  flex-shrink: 0;
}

.impact-item span {
  color: var(--text-normal);
  line-height: 1.4;
}

.backup-notice {
  margin-bottom: 24px;
  padding: 16px;
  background: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  border-left: 4px solid var(--interactive-accent);
}

.backup-notice-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 8px;
}

.backup-notice-header svg {
  color: var(--interactive-accent);
}

.backup-notice-header h5 {
  margin: 0;
  font-size: 0.95rem;
  font-weight: 600;
  color: var(--text-normal);
}

.backup-notice p {
  margin: 0 0 8px 0;
  color: var(--text-normal);
  line-height: 1.5;
}

.backup-details {
  margin-top: 8px;
  padding-top: 8px;
  border-top: 1px solid var(--background-modifier-border);
}

.backup-details span {
  font-size: 0.9rem;
  color: var(--text-muted);
}

.backup-details code {
  background: var(--background-modifier-form-field);
  padding: 2px 4px;
  border-radius: 3px;
  font-family: var(--font-monospace);
  font-size: 0.85rem;
}

.safety-information {
  margin-bottom: 24px;
}

.safety-information h5 {
  margin: 0 0 8px 0;
  font-size: 0.95rem;
  font-weight: 600;
  color: var(--text-normal);
}

.safety-information ul {
  margin: 0;
  padding-left: 20px;
  list-style: none;
}

.safety-information li {
  margin-bottom: 4px;
  color: var(--text-normal);
  line-height: 1.4;
  position: relative;
  padding-left: 4px;
}

.safety-information li::before {
  content: '\u2713';
  color: var(--text-success);
  font-weight: 600;
  position: absolute;
  left: -16px;
}

.final-warning {
  padding: 16px;
  background: rgba(var(--color-red-rgb), 0.1);
  border: 1px solid rgba(var(--color-red-rgb), 0.2);
  border-radius: 6px;
  margin-bottom: 0;
}

.final-warning p {
  margin: 0;
  color: var(--text-normal);
  line-height: 1.5;
}

/* Migration Modal Progress Bar - unique class names */
.migration-progress-bar {
  width: 100%;
  height: 8px;
  background: var(--background-modifier-border, #e0e0e0);
  border-radius: 4px;
  overflow: hidden;
  margin-bottom: 12px;
}

.migration-progress-fill {
  height: 100%;
  background: var(--interactive-accent, #007acc);
  transition: width 0.3s ease;
  border-radius: 4px;
  /* No default width - controlled by inline styles */
}

/* Migration Progress Section */
.migration-progress-section {
  background: var(--background-primary);
  padding: 20px;
  border-radius: 6px;
  margin-bottom: 16px;
  border: 1px solid var(--background-modifier-border);
}

.migration-progress-section h4 {
  margin: 0 0 16px 0;
  color: var(--text-normal);
  font-weight: 600;
  font-size: 14px;
}

.progress-container {
  margin-bottom: 16px;
}

.progress-bar {
  width: 100%;
  height: 8px;
  background: var(--background-secondary, #f0f0f0);
  border-radius: 4px;
  overflow: hidden;
  margin-bottom: 12px;
}

.progress-fill {
  height: 100%;
  background: var(--interactive-accent, #007acc);
  transition: width 0.3s ease;
  border-radius: 4px;
  /* No default width - allow inline styles to control width */
}

.progress-info {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}

.progress-phase {
  font-weight: 600;
  color: var(--text-normal);
  font-size: 13px;
  text-transform: capitalize;
}

.progress-message {
  color: var(--text-muted);
  font-size: 12px;
  flex: 1;
  text-align: center;
  margin: 0 16px;
}

.progress-percentage {
  font-weight: 600;
  color: var(--text-normal);
  font-size: 13px;
}

.detailed-progress {
  background: var(--background-secondary);
  padding: 8px 12px;
  border-radius: 4px;
  font-size: 11px;
  color: var(--text-muted);
  margin-top: 8px;
}

/* Migration Result Section */
.migration-result-section {
  background: var(--background-primary);
  padding: 20px;
  border-radius: 6px;
  margin-bottom: 16px;
  border: 1px solid var(--background-modifier-border);
}

.migration-result-section.success {
  border-color: var(--text-success);
  background: var(--background-primary);
}

.migration-result-section.error {
  border-color: var(--text-error);
  background: var(--background-primary);
}

.result-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 16px;
  font-weight: 600;
  font-size: 14px;
}

.migration-result-section.success .result-header {
  color: var(--text-success);
}

.migration-result-section.error .result-header {
  color: var(--text-error);
}

.result-details {
  color: var(--text-normal);
}

.result-details p {
  margin: 0 0 12px 0;
  line-height: 1.5;
}

.migration-stats {
  display: flex;
  gap: 24px;
  margin: 12px 0;
  padding: 12px;
  background: var(--background-secondary);
  border-radius: 4px;
  font-size: 13px;
}

.migration-stats span {
  color: var(--text-muted);
}

.backup-info {
  margin-top: 16px;
  padding: 12px;
  background: var(--background-secondary);
  border-radius: 4px;
  border-left: 3px solid var(--interactive-accent);
}

.backup-info p {
  margin: 0 0 8px 0;
  color: var(--text-normal);
  font-size: 13px;
}

.backup-info code {
  background: var(--background-primary);
  padding: 2px 6px;
  border-radius: 3px;
  font-family: var(--font-monospace);
  color: var(--text-accent);
  font-size: 12px;
}

.backup-cleanup-note {
  color: var(--text-muted) !important;
  font-size: 12px !important;
  margin-top: 8px !important;
}

.error-message {
  color: var(--text-error) !important;
  background: var(--background-secondary);
  padding: 8px 12px;
  border-radius: 4px;
  font-family: var(--font-monospace);
  font-size: 12px;
  margin: 8px 0;
}

.rollback-info {
  color: var(--text-accent) !important;
  background: var(--background-secondary);
  padding: 8px 12px;
  border-radius: 4px;
  font-size: 12px;
  margin: 8px 0;
}

.close-migration-button {
  min-width: 80px;
  padding: 8px 16px;
}

.migration-modal-actions {
  display: flex;
  gap: 12px;
  justify-content: flex-end;
  padding: 20px 24px;
  background: var(--background-secondary);
  border-top: 1px solid var(--background-modifier-border);
  border-radius: 0 0 8px 8px;
}

.cancel-migration-button {
  min-width: 100px;
  padding: 8px 16px;
}

.confirm-migration-button {
  min-width: 120px;
  padding: 8px 16px;
}

.migration-danger-button {
  background-color: var(--text-error) !important;
  border-color: var(--text-error) !important;
  color: white !important;
}

.migration-danger-button:hover {
  background-color: var(--background-modifier-error-hover) !important;
  border-color: var(--background-modifier-error-hover) !important;
}

/* Mobile responsiveness for migration modal */
@media (max-width: 600px) {
  .folder-migration-modal {
    margin: 10px;
    max-width: calc(100vw - 20px);
  }

  .migration-content {
    padding: 16px;
  }

  .migration-warning-header {
    padding: 16px;
  }

  .migration-path-container {
    padding: 12px;
  }

  .migration-path .path-text {
    font-size: 0.8rem;
    word-break: break-all;
  }

  .migration-modal-actions {
    flex-direction: column;
    gap: 8px;
    padding: 16px;
  }

  .cancel-migration-button,
  .confirm-migration-button {
    width: 100%;
  }
}

.account-dashboard-settings-form {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.account-dashboard-settings-form .setting-item {
  display: flex;
  flex-direction: column;
  gap: 8px;
  padding: 16px;
  background-color: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
}

.account-dashboard-settings-form .setting-item:last-child {
  border-bottom: 1px solid var(--background-modifier-border);
}

.account-dashboard-settings-form .setting-item-info {
  width: 100%;
}

.account-dashboard-settings-form .setting-item-name {
  font-size: 15px;
  font-weight: 600;
  color: var(--text-normal);
  margin-bottom: 3px;
}

.account-dashboard-settings-form .setting-item-description {
  font-size: 12px;
  color: var(--text-muted);
  line-height: 1.4;
  margin-bottom: 4px;
}

.account-dashboard-settings-form .setting-item-control {
  width: 100%;
}

.account-dashboard-settings-form .available-account-types {
  width: 100%;
}

.account-dashboard-settings-form .available-account-types > div {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  justify-content: flex-start;
  align-items: flex-start;
}

.account-type-badge {
  padding: 6px 12px;
  border-radius: 6px;
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  color: var(--text-normal);
  font-size: 13px;
  font-weight: 500;
}

.no-account-types {
  color: var(--text-muted);
  font-style: italic;
  text-align: left;
}

/* Account Types Settings Table */
.account-types-settings-table {
  width: 100%;
}

.account-types-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.account-type-setting-row {
  display: flex;
  align-items: center;
  padding: 12px;
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
}

.account-type-name {
  font-weight: 500;
  color: var(--text-normal);
  flex: 1;
  margin-right: 16px;
  min-width: 0;
  text-align: left;
}

.account-type-controls {
  display: flex;
  gap: 12px;
  align-items: center;
  flex-shrink: 0;
  margin-left: auto;
}

.toggle-label {
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 12px;
  color: var(--text-normal);
  cursor: pointer;
  white-space: nowrap;
}

.toggle-label input[type="checkbox"] {
  margin: 0;
  cursor: pointer;
  transform: scale(0.9);
}

/* Account Type Order Management */
.account-type-order-container {
  width: 100%;
  max-width: 400px;
  margin: 0 auto;
}

.account-type-order-list {
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  padding: 8px;
}

.order-list {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.order-list-item {
  display: flex;
  align-items: center;
  padding: 8px 10px;
  background-color: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 3px;
  transition: background-color 0.15s ease;
}

.order-list-item:hover {
  background-color: var(--background-modifier-hover);
}

.order-list-item .type-name {
  font-weight: 500;
  color: var(--text-normal);
  flex: 1;
  font-size: 13px;
  text-align: left;
  margin-right: 12px;
}

.order-controls {
  display: flex;
  gap: 2px;
  margin-left: auto;
  flex-shrink: 0;
}

.order-button {
  background-color: transparent;
  border: 1px solid var(--background-modifier-border);
  color: var(--text-muted);
  border-radius: 3px;
  padding: 4px 6px;
  cursor: pointer;
  font-size: 12px;
  font-weight: 600;
  transition: all 0.15s ease;
  min-width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  line-height: 1;
}

.order-button:hover:not(:disabled) {
  background-color: var(--background-modifier-hover);
  color: var(--text-normal);
  border-color: var(--background-modifier-border-hover);
}

.order-button:disabled {
  opacity: 0.3;
  cursor: not-allowed;
}

.settings-modal-buttons {
  display: flex;
  gap: 8px;
  justify-content: flex-end;
  margin-top: 16px;
  padding-top: 16px;
  border-top: 1px solid var(--background-modifier-border);
}

.settings-modal-buttons .save-settings-button {
  min-width: 90px;
  padding: 8px 16px;
}

.settings-modal-buttons .cancel-button {
  min-width: 60px;
  padding: 8px 12px;
}

/* Mobile responsiveness */
@media (max-width: 600px) {
  .account-dashboard-settings-modal-container {
    padding: 0 8px;
  }
  
  .account-dashboard-settings-form .setting-item {
    padding: 12px;
  }
  
  .account-type-setting-row {
    flex-direction: column;
    align-items: stretch;
    gap: 8px;
    padding: 10px;
  }
  
  .account-type-name {
    margin-right: 0;
    margin-bottom: 4px;
  }
  
  .account-type-controls {
    flex-direction: column;
    align-items: stretch;
    gap: 8px;
  }
  
  .toggle-label {
    justify-content: flex-start;
  }
  
  .settings-modal-buttons {
    flex-direction: column;
    gap: 8px;
  }
  
  .settings-modal-buttons .save-settings-button,
  .settings-modal-buttons .cancel-button {
    min-width: auto;
    width: 100%;
  }
}

.journalit-account-dashboard .create-account-primary-button {
  flex-shrink: 0;
  background-color: var(--interactive-accent);
  color: white;
  border: 1px solid var(--interactive-accent);
  border-radius: 6px;
  padding: 12px 24px;
  font-size: 1rem;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.2s ease, transform 0.1s ease;
}

.journalit-account-dashboard .create-account-primary-button:hover {
  background-color: var(--interactive-accent-hover);
  transform: translateY(-1px);
}

.journalit-account-dashboard .empty-state-with-action {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 20px;
  padding: 40px 20px;
}

.journalit-account-dashboard .empty-state-actions {
  display: flex;
  justify-content: center;
}

/* Dashboard placeholder styles */
.journalit-account-dashboard-placeholder {
  text-align: center;
  padding: 40px 20px;
  background-color: var(--background-secondary);
  border-radius: 8px;
  margin-top: 20px;
}

.journalit-account-dashboard-placeholder h2 {
  font-size: 1.8rem;
  margin-bottom: 20px;
  color: var(--text-normal);
}

.journalit-account-dashboard-placeholder p {
  font-size: 1rem;
  color: var(--text-muted);
  margin-bottom: 15px;
}

.journalit-account-dashboard-placeholder ul {
  text-align: left;
  max-width: 400px;
  margin: 20px auto;
}

.journalit-account-dashboard-placeholder li {
  margin-bottom: 8px;
  color: var(--text-normal);
}

/* New Account Dashboard Styles */

/* Dashboard Metrics Styles */
.journalit-account-dashboard .dashboard-metrics {
  display: flex;
  flex-direction: row;
  flex-wrap: nowrap;
  gap: 10px;
  margin-bottom: 30px;
  margin-top: 10px;
  padding: 0 10px;
  overflow-x: auto;
}

.journalit-account-dashboard .metric-item {
  flex: 1;
  min-width: 180px;
  max-width: 300px;
  padding: 15px;
  background-color: var(--background-secondary);
  border-radius: 8px;
  text-align: center;
  transition: transform 0.2s ease;
}

.journalit-account-dashboard .metric-item:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.journalit-account-dashboard .metric-value {
  font-size: 1.5rem;
  font-weight: 600;
  margin-bottom: 5px;
  color: var(--text-normal);
}

.journalit-account-dashboard .metric-value.positive {
  color: var(--text-success);
}

.journalit-account-dashboard .metric-value.negative {
  color: var(--text-error);
}

.journalit-account-dashboard .metric-label {
  font-size: 0.9rem;
  color: var(--text-muted);
}

/* Account Sections Styles */
.journalit-account-dashboard .account-sections {
  display: flex;
  flex-direction: column;
  gap: 15px;
  padding: 0 10px;
}

.journalit-account-dashboard .account-section {
  background-color: var(--background-primary);
  border-radius: 8px;
  padding: 0;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.journalit-account-dashboard .account-section h3 {
  font-size: 1.3rem;
  font-weight: 600;
  margin-bottom: 15px;
  padding-bottom: 10px;
  border-bottom: 1px solid var(--background-modifier-border);
  color: var(--text-normal);
}

/* Account Section Content - for empty state and virtualized list */
.journalit-account-dashboard .account-section-content {
  padding: 0 0 20px 0;
}

.journalit-account-dashboard .account-cards {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
  gap: 20px;
  padding: 0 0 20px 0;
}

/* Modern Account Card Styles */
.journalit-account-dashboard .account-card {
  background: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 12px;
  padding: 0;
  cursor: pointer;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  height: 100%; /* Ensure all cards have consistent height */
}

.journalit-account-dashboard .account-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
  border-color: var(--interactive-accent-hover);
}

/* Header Section */
.journalit-account-dashboard .account-card-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  padding: 20px 20px 16px 20px;
  border-bottom: 1px solid var(--background-modifier-border);
  background: linear-gradient(135deg, var(--background-secondary) 0%, var(--background-primary) 100%);
}

.journalit-account-dashboard .account-identity {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.journalit-account-dashboard .account-name {
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--text-normal);
  line-height: 1.2;
  margin: 0;
}

.journalit-account-dashboard .account-type-badge {
  font-size: 0.75rem;
  font-weight: 500;
  color: var(--text-muted);
  background: var(--background-modifier-form-field);
  padding: 4px 8px;
  border-radius: 6px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  width: fit-content;
}

.journalit-account-dashboard .account-balance {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  gap: 4px;
}

.journalit-account-dashboard .balance-amount {
  font-size: 1.25rem;
  font-weight: 700;
  color: var(--text-normal);
  line-height: 1.2;
}

.journalit-account-dashboard .balance-growth {
  font-size: 0.8rem;
  font-weight: 500;
  line-height: 1.2;
}

.journalit-account-dashboard .balance-growth.positive {
  color: var(--text-success);
}

.journalit-account-dashboard .balance-growth.negative {
  color: var(--text-error);
}

/* Body Section */
.journalit-account-dashboard .account-card-body {
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 20px;
  flex: 1; /* Allow body to grow and push footer to bottom */
}

/* Overall Dashboard Metrics - Original styles restored */
.journalit-account-dashboard .metric-item {
  flex: 1;
  min-width: 180px;
  max-width: 300px;
  padding: 15px;
  background-color: var(--background-secondary);
  border-radius: 8px;
  text-align: center;
  transition: transform 0.2s ease;
}

.journalit-account-dashboard .metric-item:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.journalit-account-dashboard .metric-value {
  font-size: 1.5rem;
  font-weight: 600;
  margin-bottom: 5px;
  color: var(--text-normal);
}

.journalit-account-dashboard .metric-value.positive {
  color: var(--text-success);
}

.journalit-account-dashboard .metric-value.negative {
  color: var(--text-error);
}

.journalit-account-dashboard .metric-label {
  font-size: 0.9rem;
  color: var(--text-muted);
}

/* Account Card Key Metrics - Specific styles */
.journalit-account-dashboard .account-card .key-metrics {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 12px;
}

.journalit-account-dashboard .account-card .key-metrics .metric-item {
  flex: none;
  min-width: 0;
  max-width: none;
  padding: 10px 6px;
  background: var(--background-modifier-form-field);
  transition: none;
  overflow: hidden;
}

.journalit-account-dashboard .account-card .key-metrics .metric-item:hover {
  transform: none;
  box-shadow: none;
  background: var(--background-modifier-form-field);
}

.journalit-account-dashboard .account-card .key-metrics .metric-item .metric-value {
  font-size: 0.9rem;
  font-weight: 600;
  color: var(--text-normal);
  margin-bottom: 4px;
  line-height: 1.2;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 100%;
}

.journalit-account-dashboard .account-card .key-metrics .metric-item .metric-label {
  font-size: 0.7rem;
  font-weight: 500;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  line-height: 1.2;
  white-space: nowrap;
}

/* Progress Section */
.journalit-account-dashboard .progress-section {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.journalit-account-dashboard .progress-item {
  display: flex;
  flex-direction: column;
  gap: 8px;
  min-height: 44px; /* Consistent height for all progress items */
}

.journalit-account-dashboard .progress-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  height: 20px; /* Fixed height for consistent alignment */
}

.journalit-account-dashboard .progress-label {
  font-size: 0.85rem;
  font-weight: 500;
  color: var(--text-muted);
}

/* Progress Label with Badge Container */
.journalit-account-dashboard .progress-label-with-badge {
  display: flex;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
}

/* Dashboard Status Badges (matching AccountPage badges) */
.journalit-account-dashboard .dashboard-status-badge {
  padding: 2px 6px;
  border-radius: 12px;
  font-size: 8px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.3px;
  border: 1px solid;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  white-space: nowrap;
  flex-shrink: 0;
}

.journalit-account-dashboard .dashboard-status-badge.in-progress {
  border-color: var(--color-warning);
  color: var(--color-warning);
  background: rgba(245, 158, 11, 0.1);
}

.journalit-account-dashboard .dashboard-status-badge.achieved {
  border-color: var(--text-success);
  color: var(--text-success);
  background: rgba(var(--color-green-rgb), 0.1);
}

.journalit-account-dashboard .dashboard-status-badge.breached {
  border-color: var(--text-error);
  color: var(--text-error);
  background: rgba(var(--color-red-rgb), 0.1);
}

.journalit-account-dashboard .progress-value {
  font-size: 0.85rem;
  font-weight: 600;
  color: var(--text-normal);
}

.journalit-account-dashboard .progress-value.not-set {
  color: var(--text-muted);
  font-style: italic;
  font-weight: 500;
}

/* Mute appearance for items without targets set */
.journalit-account-dashboard .progress-item.not-set {
  opacity: 0.7;
}

.journalit-account-dashboard .progress-bar-container {
  width: 100%;
  height: 8px;
  background: var(--background-modifier-border);
  border-radius: 4px;
  overflow: hidden;
  position: relative;
  margin-top: 8px; /* Consistent spacing */
}

.journalit-account-dashboard .progress-bar {
  height: 100%;
  border-radius: 4px;
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  position: absolute;
  left: 0;
  top: 0;
  min-width: 0;
}

/* Progress bar colors */
.journalit-account-dashboard .progress-bar.profit-target {
  background: linear-gradient(90deg, #3b82f6 0%, #2563eb 100%);
  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.2);
}

.journalit-account-dashboard .progress-bar.profit-target.complete {
  background: linear-gradient(90deg, #22c55e 0%, #16a34a 100%);
  box-shadow: 0 2px 8px rgba(34, 197, 94, 0.2);
}

.journalit-account-dashboard .progress-bar.drawdown.safe {
  background: linear-gradient(90deg, #22c55e 0%, #16a34a 100%);
  box-shadow: 0 2px 8px rgba(34, 197, 94, 0.2);
}

.journalit-account-dashboard .progress-bar.drawdown.warning {
  background: linear-gradient(90deg, #eab308 0%, #ca8a04 100%);
  box-shadow: 0 2px 8px rgba(234, 179, 8, 0.2);
}

.journalit-account-dashboard .progress-bar.drawdown.critical {
  background: linear-gradient(90deg, #ef4444 0%, #dc2626 100%);
  box-shadow: 0 2px 8px rgba(var(--color-red-rgb), 0.2);
}

/* Empty progress bar styling for consistency */
.journalit-account-dashboard .progress-bar.empty {
  background: transparent !important;
  width: 0% !important;
}

/* Hide progress bars when width is effectively 0 to prevent border-radius artifacts */
.journalit-account-dashboard .progress-bar[style*="width: 0%"] {
  display: none;
}

/* Footer */
.journalit-account-dashboard .account-card-footer {
  padding-top: 16px;
  border-top: 1px solid var(--background-modifier-border);
  display: flex;
  justify-content: space-between;
  align-items: center;
  min-height: 24px; /* Consistent footer height */
  gap: 12px;
}

.journalit-account-dashboard .footer-metric {
  display: flex;
  align-items: center;
  gap: 6px;
  min-width: 0; /* Allow shrinking */
}

.journalit-account-dashboard .footer-metric:first-child {
  flex: 1; /* Monthly cost takes remaining space */
}

.journalit-account-dashboard .footer-metric:last-child {
  flex: 0 0 auto; /* Total costs stays fixed size on the right */
  justify-content: flex-end;
}

.journalit-account-dashboard .footer-label {
  font-size: 0.75rem;
  color: var(--text-muted);
  font-weight: 500;
  white-space: nowrap;
}

.journalit-account-dashboard .footer-value {
  font-size: 0.75rem;
  color: var(--text-normal);
  font-weight: 600;
  white-space: nowrap;
}

/* Loading and Error States */
.journalit-account-dashboard.loading {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  font-size: 1.2rem;
  color: var(--text-muted);
}

.journalit-account-dashboard.error {
  padding: 20px;
  color: var(--text-error);
  background-color: rgba(var(--text-error-rgb), 0.05);
  border-left: 3px solid var(--text-error);
  margin: 20px;
  border-radius: 0 4px 4px 0;
}

.journalit-account-dashboard .loading-spinner {
  padding: 20px;
  text-align: center;
}

.journalit-account-dashboard .error-message {
  padding: 20px;
  font-weight: 500;
}

/* Enhanced Account Type Header Styles - Sleek Horizontal Layout */
.journalit-account-dashboard {
  /* Custom properties for easier overrides */
  --account-type-header-gap: 20px;
  --account-type-metrics-gap: 20px;
  --account-type-metrics-justify: flex-end;
  --account-type-metric-max-width: 120px;
}

.journalit-account-dashboard .account-type-header {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  gap: var(--account-type-header-gap, 20px);
  padding: 12px 10px;
  margin: 20px 0 16px 0;
  background: linear-gradient(135deg, var(--background-secondary) 0%, var(--background-primary) 100%);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
  position: relative;
  overflow: hidden;
}

/* Account Type Name Section - Enhanced Prominence */
.journalit-account-dashboard .account-type-header .account-type-name {
  /* Prevent inheritance from the generic .account-type-name { flex: 1 } rule */
  flex: 0 0 auto;
  margin-right: 0; /* rely on container gap for spacing */
  min-width: auto;
}

.journalit-account-dashboard .account-type-header .account-type-name h3 {
  margin: 0;
  font-size: 1.3rem;
  font-weight: 700;
  color: var(--text-normal);
  border: none;
  padding: 0;
  line-height: 1.2;
  text-transform: uppercase;
  letter-spacing: 0.3px;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

/* Metrics Container - Enhanced Responsiveness */
.journalit-account-dashboard .account-type-header .account-type-metrics {
  display: flex;
  align-items: center;
  gap: var(--account-type-metrics-gap, 20px);
  flex: 1;
  justify-content: var(--account-type-metrics-justify, flex-end);
  flex-wrap: wrap;
  min-width: 0; /* Allow container to shrink */
  margin-left: auto; /* Push metrics block to the right edge */
}

/* Individual Metric Items - Enhanced Flexibility */
.journalit-account-dashboard .account-type-header .metric-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
  min-width: 0;
  flex-shrink: 1;
  flex-basis: auto;
  padding: 0;
  background: none;
  border-radius: 0;
  transition: none;
  text-align: center;
  max-width: var(--account-type-metric-max-width, 120px); /* Prevent items from getting too wide */
}

.journalit-account-dashboard .account-type-header .metric-item:hover {
  transform: none;
  box-shadow: none;
  background: none;
}

/* Metric Values - Flexible Text Wrapping */
.journalit-account-dashboard .account-type-header .metric-item .metric-value {
  font-size: 0.9rem;
  font-weight: 600;
  color: var(--text-normal);
  margin: 0;
  line-height: 1.2;
  white-space: normal; /* Allow wrapping by default for better responsiveness */
  overflow-wrap: break-word; /* fallback */
  overflow-wrap: anywhere;   /* preferred modern behavior */
  word-break: normal;
  text-align: center;
}

/* Weight percent gets special emphasis */
.journalit-account-dashboard .account-type-header .metric-item .metric-value.weight-percent {
  font-size: 1rem;
  font-weight: 700;
  color: var(--color-info);
}

/* Excluded status styling */
.journalit-account-dashboard .account-type-header .metric-item .metric-value.excluded-status {
  font-size: 0.9rem;
  font-weight: 600;
  color: var(--text-muted);
  font-style: italic;
}

/* Growth color coding */
.journalit-account-dashboard .account-type-header .metric-item .metric-value.positive {
  color: var(--text-success);
}

.journalit-account-dashboard .account-type-header .metric-item .metric-value.negative {
  color: var(--text-error);
}

/* Metric Labels - Flexible Text Wrapping */
.journalit-account-dashboard .account-type-header .metric-item .metric-label {
  font-size: 0.7rem;
  font-weight: 500;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.3px;
  margin: 0;
  line-height: 1.2;
  white-space: normal; /* Allow wrapping by default for better responsiveness */
  overflow-wrap: break-word; /* fallback */
  overflow-wrap: anywhere;   /* preferred modern behavior */
  word-break: normal;
  text-align: center;
}

/* Align responsiveness with AccountCard single-column behavior (~370px) */
@media (max-width: 400px) {
  .journalit-account-dashboard .account-type-header {
    flex-direction: column;
    align-items: stretch;
    gap: 12px;
    padding: 16px 10px;
  }
  
  .journalit-account-dashboard .account-type-header .account-type-name {
    margin-right: 0;
    text-align: center;
    padding-bottom: 8px;
    border-bottom: 1px solid var(--background-modifier-border);
  }
  
  .journalit-account-dashboard .account-type-header .account-type-metrics {
    justify-content: center;
    gap: 16px;
  }
}

/* Grid layout for better metric organization */
@media (max-width: 350px) {
  .journalit-account-dashboard .account-type-header .account-type-metrics {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 16px 20px;
    justify-content: center;
  }
  
  .journalit-account-dashboard .account-type-header .metric-item .metric-value {
    font-size: 0.9rem;
    white-space: normal; /* Allow text wrapping */
    word-break: break-word;
  }
  
  .journalit-account-dashboard .account-type-header .metric-item .metric-label {
    font-size: 0.7rem;
    white-space: normal;
    word-break: break-word;
  }
}

/* More compact layout for smaller screens */
@media (max-width: 300px) {
  .journalit-account-dashboard .account-type-header .account-type-metrics {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px 16px;
    text-align: center;
  }
  
  .journalit-account-dashboard .account-type-header .metric-item {
    align-items: center;
    min-width: 0; /* Prevent overflow */
  }
  
  .journalit-account-dashboard .account-type-header .metric-item .metric-value {
    font-size: 0.8rem;
    white-space: normal;
    word-break: break-word;
    overflow-wrap: break-word;
  }
  
  .journalit-account-dashboard .account-type-header .metric-item .metric-label {
    font-size: 0.65rem;
    white-space: normal;
    word-break: break-word;
    overflow-wrap: break-word;
    line-height: 1.1;
  }
}

/* Extra small devices - hide less critical metrics */
@media (max-width: 480px) {
  .journalit-account-dashboard .account-type-header .account-type-metrics {
    gap: 10px 12px;
  }
  
  /* Hide withdrawals and trade count on very small screens to prioritize key metrics */
  .journalit-account-dashboard .account-type-header .metric-item:nth-child(3), /* Withdrawals */
  .journalit-account-dashboard .account-type-header .metric-item:nth-child(5) { /* Total Trades */
    display: none;
  }
  
  .journalit-account-dashboard .account-type-header .metric-item .metric-value {
    font-size: 0.75rem;
  }
  
  .journalit-account-dashboard .account-type-header .metric-item .metric-label {
    font-size: 0.6rem;
  }
}
`;function IG(){let e="journalit-account-styles";if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=lxe,document.head.appendChild(t)}function AG(){let e=document.getElementById("journalit-account-styles");e&&e.remove()}YO();OO();ce.account={inject:IG,remove:AG};ce.accountLinkModal={inject:qO,remove:GO};ce.accountWeightBar={inject:FO,remove:gG};Oo();var cxe=`
/* Trade Log View Container
 * CRITICAL: All flex containers in the hierarchy must have min-height: 0
 * to fix Firefox and other browser flexbox scrolling issues.
 * See: https://stackoverflow.com/questions/36535656/using-flexbox-and-overflow-hidden-scroll-not-working-in-firefox
 */
.journalit-trade-log-view-container {
  height: 100%;
  overflow: hidden !important; /* Override ReactView inline styles */
  display: flex;
  flex-direction: column;
  padding: 0;
  min-height: 0; /* Critical for flexbox scrolling */
}

/* Target the React root element to prevent it from scrolling */
.journalit-trade-log-view-container > div[id^="react-root-"] {
  height: 100%;
  overflow: visible;
  display: flex;
  flex-direction: column;
  min-height: 0; /* Critical for flexbox scrolling */
}

/* Main Container */
.journalit-trade-log {
  display: flex;
  flex-direction: column;
  height: 100%;
  background: var(--background-primary);
  color: var(--text-normal);
  overflow: hidden;
  min-height: 0; /* Critical for flexbox scrolling */
}

/* Header */
.trade-log-header {
  padding: 12px 16px 6px 16px;
  border-bottom: 1px solid var(--background-modifier-border);
  background: var(--background-secondary);
}

.trade-log-controls {
  display: flex;
  gap: 16px;
  align-items: center;
  margin-bottom: 0;
  flex-wrap: wrap;
}

.trade-log-view-selector {
  display: flex;
  align-items: center;
  gap: 8px;
  flex: 0 0 auto;
  min-width: fit-content;
}

.trade-log-view-selector label {
  font-size: 13px;
  font-weight: 500;
  color: var(--text-muted);
  white-space: nowrap;
}

.trade-log-view-selector select {
  width: auto;
  padding: 6px 8px;
  border-radius: 4px;
  border: 1px solid var(--background-modifier-border);
  background: var(--background-primary);
  color: var(--text-normal);
  font-size: 13px;
  cursor: pointer;
}

/* Direct styling for view dropdown with minimal width */
.trade-log-view-dropdown {
  width: auto !important;
  max-width: fit-content !important;
  padding: 6px 8px !important;
  text-align: center !important;
}

.trade-log-view-selector select:hover {
  background: var(--background-modifier-hover);
}

.trade-log-view-selector select option {
  background-color: var(--background-primary) !important;
  color: var(--text-normal) !important;
  padding: 6px 8px !important;
}

.trade-log-view-selector select option:hover,
.trade-log-view-selector select option:focus {
  background-color: var(--background-modifier-hover) !important;
  color: var(--text-normal) !important;
}

.trade-log-filter-actions {
  display: flex;
  align-items: center;
  gap: 8px;
  flex: 0 0 auto;
  min-width: fit-content;
  margin-left: auto;
}

.trade-log-filter-actions > * {
  flex-shrink: 0;
}

/* Filter button base styles */
.journalit-filter-button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 6px;
  background-color: transparent;
  color: var(--text-muted);
  border: 1px solid transparent;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.journalit-filter-button:hover {
  background-color: var(--background-modifier-hover);
  color: var(--text-normal);
}

/* Multi-select button active state */
.journalit-filter-button-container .journalit-filter-button.active,
.journalit-filter-button.active {
  background-color: var(--interactive-accent);
  color: var(--text-on-accent);
}

.journalit-filter-button-container .journalit-filter-button.active:hover,
.journalit-filter-button.active:hover {
  background-color: var(--interactive-accent-hover);
}

.view-level-selector {
  display: flex;
  align-items: center;
  gap: 8px;
}

.view-level-selector label {
  font-weight: 500;
  color: var(--text-muted);
}

.date-range-selector {
  flex: 1;
  display: flex;
  justify-content: flex-end;
}

/* Advanced Filters */
.trade-log-advanced-filters {
  display: flex;
  align-items: center;
  gap: 24px;
  flex-wrap: wrap;
  padding: 12px;
  background: var(--background-primary-alt);
  border-radius: 4px;
  border: 1px solid var(--background-modifier-border);
}

.trade-type-filter-section {
  display: flex;
  align-items: center;
  gap: 12px;
}

.trade-type-filter-section label {
  font-weight: 500;
  color: var(--text-muted);
  white-space: nowrap;
}

.status-filter-section {
  display: flex;
  align-items: center;
  gap: 12px;
}

.status-filter-section label {
  font-weight: 500;
  color: var(--text-muted);
  white-space: nowrap;
}

/* Trade Type Filter Dropdown */
.journalit-tradelog-trade-type-filter {
  position: relative;
  min-width: 100px !important;
  max-width: 120px !important;
  width: 100% !important;
}

.journalit-tradelog-trade-type-dropdown {
  position: relative !important;
  width: 100% !important;
}

.journalit-tradelog-trade-type-summary {
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  padding: 5px 10px !important;
  background-color: var(--background-primary) !important;
  border: 1px solid var(--background-modifier-border) !important;
  border-radius: 4px !important;
  cursor: pointer !important;
  font-size: 0.9em !important;
  transition: all 0.2s ease !important;
  height: 28px !important;
  line-height: 1 !important;
  white-space: nowrap !important;
  gap: 8px !important;
}

.journalit-tradelog-trade-type-summary:hover {
  border-color: var(--interactive-accent) !important;
  background-color: var(--background-modifier-hover) !important;
}

.journalit-tradelog-trade-type-summary:focus-visible {
  outline: 2px solid var(--interactive-accent) !important;
  outline-offset: 2px !important;
}

.journalit-tradelog-trade-type-summary .dropdown-arrow {
  font-size: 10px;
  color: var(--text-muted);
  transition: transform 0.2s ease;
}

.journalit-tradelog-trade-type-options-dropdown {
  position: absolute;
  top: 100%;
  left: 0 !important;
  right: 0 !important;
  max-height: 250px;
  overflow-y: auto;
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  margin-top: 4px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  z-index: 100;
}

.journalit-tradelog-trade-type-option-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  cursor: pointer;
  transition: background-color 0.2s ease;
  font-size: 13px;
  white-space: nowrap;
}

.journalit-tradelog-trade-type-option-item:hover {
  background-color: var(--background-modifier-hover) !important;
}

.journalit-tradelog-trade-type-option-item:focus-visible {
  outline: 2px solid var(--interactive-accent) !important;
  outline-offset: -2px !important;
}

.journalit-tradelog-trade-type-option-item.select-all {
  font-weight: 500;
}

.journalit-tradelog-trade-type-divider {
  height: 1px;
  background-color: var(--background-modifier-border);
  margin: 4px 0;
}

/* Base Checkbox Styles (shared by all tradelog checkboxes) */
.journalit-tradelog-checkbox {
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  width: 14px !important;
  height: 14px !important;
  border: 1px solid var(--background-modifier-border) !important;
  border-radius: 2px !important;
  background-color: var(--background-primary) !important;
  font-size: 10px !important;
  color: var(--text-on-accent) !important;
  flex-shrink: 0 !important;
}

.journalit-tradelog-checkbox.checked {
  background-color: var(--interactive-accent) !important;
  border-color: var(--interactive-accent) !important;
}

.journalit-tradelog-trade-type-checkbox {
  /* Extends .journalit-tradelog-checkbox base class */
  /* Add any trade-type-specific overrides here if needed in future */
}

.journalit-tradelog-trade-type-checkbox.checked {
  /* Extends .journalit-tradelog-checkbox.checked base class */
}

.journalit-trade-log-view-container .journalit-tradelog-trade-type-option-item input[type="checkbox"] {
  margin: 0 !important;
  width: 14px !important;
  height: 14px !important;
  appearance: none !important;
  -webkit-appearance: none !important;
  border: 1px solid var(--background-modifier-border) !important;
  border-radius: 2px !important;
  background: var(--background-primary) !important;
  cursor: pointer !important;
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  position: relative !important;
  padding: 0 !important;
  font-size: 0 !important;
  min-width: 14px !important;
  max-width: 14px !important;
  min-height: 14px !important;
  max-height: 14px !important;
}

.journalit-trade-log-view-container .journalit-tradelog-trade-type-option-item input[type="checkbox"]:checked {
  background: var(--interactive-accent) !important;
  border-color: var(--interactive-accent) !important;
}

.journalit-trade-log-view-container .journalit-tradelog-trade-type-option-item input[type="checkbox"]:checked::after {
  content: '\u2713' !important;
  color: var(--text-on-accent) !important;
  font-size: 11px !important;
  font-weight: 900 !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  position: absolute !important;
  top: 0 !important;
  left: 0 !important;
  width: 100% !important;
  height: 100% !important;
  text-shadow: none !important;
  line-height: 1 !important;
}

.journalit-trade-log-view-container .journalit-tradelog-trade-type-option-item input[type="checkbox"]:checked + span {
  color: var(--interactive-accent);
  font-weight: 600;
}

/* Status Filter Dropdown */
.journalit-tradelog-status-filter {
  position: relative;
  min-width: 120px !important;
  max-width: 150px !important;
  width: 100% !important;
}

.journalit-tradelog-status-dropdown {
  position: relative !important;
  width: 100% !important;
}

.journalit-tradelog-status-summary {
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  padding: 5px 10px !important;
  background-color: var(--background-primary) !important;
  border: 1px solid var(--background-modifier-border) !important;
  border-radius: 4px !important;
  cursor: pointer !important;
  font-size: 0.9em !important;
  transition: all 0.2s ease !important;
  height: 28px !important;
  line-height: 1 !important;
  white-space: nowrap !important;
  gap: 8px !important;
}

.journalit-tradelog-status-summary:hover {
  border-color: var(--interactive-accent) !important;
  background-color: var(--background-modifier-hover) !important;
}

.journalit-tradelog-status-summary:focus-visible {
  outline: 2px solid var(--interactive-accent) !important;
  outline-offset: 2px !important;
}

.journalit-tradelog-status-summary .dropdown-arrow {
  font-size: 10px;
  color: var(--text-muted);
  transition: transform 0.2s ease;
}

.journalit-tradelog-status-options-dropdown {
  position: absolute;
  top: 100%;
  left: 0 !important;
  right: 0 !important;
  max-height: 300px;
  overflow-y: auto;
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  margin-top: 4px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  z-index: 100;
}

.journalit-tradelog-status-option-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  cursor: pointer;
  transition: background-color 0.2s ease;
  font-size: 13px;
  white-space: nowrap;
}

.journalit-tradelog-status-option-item:hover {
  background-color: var(--background-modifier-hover) !important;
}

.journalit-tradelog-status-option-item:focus-visible {
  outline: 2px solid var(--interactive-accent) !important;
  outline-offset: -2px !important;
}

.journalit-tradelog-status-option-item.select-all {
  font-weight: 500;
}

.journalit-tradelog-status-option-item.sub-option {
  padding-left: 24px;
  font-size: 12px;
  color: var(--text-muted);
}

.journalit-tradelog-status-divider {
  height: 1px;
  background-color: var(--background-modifier-border);
  margin: 4px 0;
}

.journalit-tradelog-status-checkbox {
  /* Extends .journalit-tradelog-checkbox base class */
  /* Add any status-specific overrides here if needed in future */
}

.journalit-tradelog-status-checkbox.checked {
  /* Extends .journalit-tradelog-checkbox.checked base class */
}

.journalit-trade-log-view-container .journalit-tradelog-status-option-item input[type="checkbox"] {
  margin: 0 !important;
  width: 14px !important;
  height: 14px !important;
  appearance: none !important;
  -webkit-appearance: none !important;
  border: 1px solid var(--background-modifier-border) !important;
  border-radius: 2px !important;
  background: var(--background-primary) !important;
  cursor: pointer !important;
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  position: relative !important;
  padding: 0 !important;
  font-size: 0 !important;
  min-width: 14px !important;
  max-width: 14px !important;
  min-height: 14px !important;
  max-height: 14px !important;
}

.journalit-trade-log-view-container .journalit-tradelog-status-option-item input[type="checkbox"]:checked {
  background: var(--interactive-accent) !important;
  border-color: var(--interactive-accent) !important;
}

.journalit-trade-log-view-container .journalit-tradelog-status-option-item input[type="checkbox"]:checked::after {
  content: '\u2713' !important;
  color: var(--text-on-accent) !important;
  font-size: 11px !important;
  font-weight: 900 !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  position: absolute !important;
  top: 0 !important;
  left: 0 !important;
  width: 100% !important;
  height: 100% !important;
  text-shadow: none !important;
  line-height: 1 !important;
}

.journalit-trade-log-view-container .journalit-tradelog-status-option-item input[type="checkbox"]:checked + span {
  color: var(--interactive-accent);
  font-weight: 600;
}

/* Content Area */
.trade-log-content {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  padding: 0 0 8px 0;
  position: relative;
  min-height: 0; /* Important for flex children to scroll properly */
  /* Optimize scrolling performance */
  -webkit-overflow-scrolling: touch;
  scroll-behavior: auto; /* Disable smooth scrolling for better performance */
  will-change: scroll-position;
  /* Cross-browser flexbox scrolling fix */
  contain: layout;
}


/* Ensure proper scrolling in trades view */

.trade-log-content.trades-view {

  display: flex;

  flex-direction: column;

  min-height: 0; /* Critical for flexbox scrolling */

  height: 100%; /* Force container to constrain children height */

  max-height: 100%; /* AnuPpuccin theme compatibility */

  overflow: visible; /* Remove outer scroll bar - let inner tree handle scrolling like days view */

}

/* Horizontal scroll wrapper for trades view (header + body share the same scroller) */
.trade-log-hscroll {
  width: 100%;
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  min-height: 0; /* allow child to scroll */
  overflow-x: auto;
  overflow-y: hidden;
  -webkit-overflow-scrolling: touch;
}

/* Inner container expands to actual table width (set via inline min-width) */
.trade-log-hscroll-inner {
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  min-height: 0; /* critical so react-window list can size + scroll */
  min-width: 100%; /* stretch to container width */
  width: max-content; /* allow content to grow wider than container for horizontal scrolling */
}

/* Ensure trades view content doesn\u2019t reserve extra vertical space below the list */
.trade-log-content.trades-view {
  overflow: hidden; /* prevent outer vertical gap, inner list handles scrolling */
}


/* Use native scrollbar for better performance */
.trade-log-content::-webkit-scrollbar {
  width: 8px;
}

.trade-log-content::-webkit-scrollbar-thumb {
  background: var(--background-modifier-border);
  border-radius: 4px;
}

/* Loading State */
.trade-log-loading {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 40px;
  color: var(--text-muted);
}

.spinner {
  display: inline-flex;
  align-items: center;
  gap: 8px;
}

.spinner::before {
  content: '';
  width: 16px;
  height: 16px;
  border: 2px solid var(--text-muted);
  border-top-color: transparent;
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}


/* Tree View */

.trade-log-tree {

  width: 100%;

  padding: 0;

  display: flex;
  flex-direction: column;
  flex: 1 1 auto; /* Allow tree to grow and shrink */
  height: auto;
  contain: layout; /* Improve rendering performance */

  min-height: 0; /* Critical for flexbox scrolling */

  /* Force proper overflow behavior in all browsers */

  overflow: visible;

}


/* Tree container for virtualized list */
.trade-log-tree-container {
  flex: 1;
  overflow: hidden;
  position: relative;
  min-height: 0; /* Critical for flexbox scrolling */
}

/* Empty state for when no data is available */
.trade-log-tree--empty {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 40px;
  color: var(--text-muted);
  font-style: italic;
}

/* Node Styles */
.trade-log-node {
  display: flex;
  align-items: stretch;
  min-height: 48px;
  position: relative;
  /* Fade in animation for lazy-loaded nodes */
  animation: fadeIn 0.2s ease-out;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.trade-log-node:hover {
  background-color: var(--background-modifier-hover);
}

/* Placeholder styles for lazy loading */
.trade-log-node-placeholder {
  display: flex;
  align-items: center;
  position: relative;
  opacity: 0.3;
}

/* Tree Structure Visualization */
.tree-structure {
  position: relative;
}

/* Only apply flex when tree-structure contains children (tree lines) */
.tree-structure:not(:empty) {
  display: flex;
  align-items: stretch;
}

.tree-level {
  width: 24px;
  position: relative;
}

.tree-level::before {
  content: '';
  position: absolute;
  left: 11px;
  top: 0;
  bottom: 0;
  width: 1px;
  background: var(--background-modifier-border);
}

/* Special case for last child - clip the vertical line */
.trade-log-node.is-last-child .tree-level.last-level::before {
  height: 24px;
}

/* Hide expand/collapse lines for leaf nodes */
.trade-log-node--trade .tree-expand-wrapper {
  height: auto;
  width: 12px;
  margin-right: 0;
}

/* Node wrapper */
.node-wrapper {
  flex: 1;
  display: flex;
  align-items: center;
  position: relative;
}

/* Trade node specific wrapper adjustment */
.trade-log-node--trade .node-wrapper {
  padding-left: 0;
}

/* Tree node indicator for trade items */
.tree-node-indicator {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 20px;
  position: relative;
  margin-right: 8px;
}

/* Tree connector line */
.tree-connector {
  position: absolute;
  left: -13px;
  top: 50%;
  width: 12px;
  height: 1px;
  background: var(--background-modifier-border);
}

.tree-connector--trade {
  top: 0;
}

/* Expand/collapse wrapper */
.tree-expand-wrapper {
  width: 20px;
  height: 48px;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  margin-right: 4px;
}

/* Tree leaf node (no children) */
.tree-leaf-node {
  width: 2px;
  height: 2px;
  background: var(--text-muted);
  border-radius: 50%;
  position: relative;
}

.tree-leaf-node::before {
  content: '';
  position: absolute;
  left: -5px;
  top: 50%;
  width: 5px;
  height: 1px;
  background: var(--background-modifier-border);
}

.tree-leaf-node--trade {
  background: var(--text-normal);
  margin-right: 0;
}

/* When in the tree indicator cell, adjust positioning */
.tree-indicator-cell .tree-leaf-node {
  margin-left: 7px;
}

.tree-indicator-cell .tree-connector {
  left: -6px;
  width: 6px;
  transform: translateY(-50%);
}


.node-content {
  display: flex;
  align-items: center;
  width: 100%;
  gap: 8px;
  padding-right: 16px;
}

/* Chevron Button */
.node-chevron {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 48px;
  padding: 0;
  border: none;
  background: transparent !important;
  color: var(--text-muted);
  cursor: pointer;
  position: relative;
}

.node-chevron:hover {
  background: transparent !important;
  color: var(--text-normal);
}

.node-chevron:active {
  background: transparent !important;
  color: var(--text-normal);
}

.node-chevron:focus {
  background: transparent !important;
  outline: none;
}

.node-chevron:focus-visible {
  background: transparent !important;
  outline: 2px solid var(--interactive-accent);
  outline-offset: 2px;
}

.node-chevron svg {
  width: 16px;
  height: 16px;
}

/* Node Label */
.node-label {
  flex: 0 0 auto;
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 0;
  border-radius: 0;
  cursor: pointer;
  font-weight: 700;
  text-transform: uppercase;
  color: var(--text-normal);
  transition: color 0.2s ease;
}

.node-label:hover {
  color: var(--text-accent);
  background-color: transparent;
}

/* Node type-specific styles */
.trade-log-node--year .node-label {
  font-size: 16px;
  font-weight: 600;
}

.trade-log-node--quarter .node-label,
.trade-log-node--month .node-label {
  font-size: 15px;
}

.trade-log-node--week .node-label,
.trade-log-node--day .node-label {
  font-size: 14px;
}

/* Metrics */
.node-metrics {
  display: flex;
  align-items: center;
  gap: 0;
  padding: 6px 12px;
  background: var(--background-modifier-border);
  border-radius: 4px;
  margin-left: auto;
}

.metric-column {
  display: flex;
  align-items: center;
  justify-content: center;
}

.metric-column--count {
  width: 90px;
  text-align: center;
}

.metric-column--winrate {
  width: 70px;
  text-align: center;
}

.metric-column--pnl {
  width: 130px;
  text-align: center;
}

.metric {
  font-size: 13px;
  font-weight: 500;
  white-space: nowrap;
  line-height: 1.4;
  font-family: var(--font-monospace);
}

.metric--count {
  color: var(--text-muted);
}

.metric--winrate {
  font-weight: 500;
}

.metric--winrate.high {
  color: var(--text-success);
}

.metric--winrate.medium {
  color: var(--text-warning);
}

.metric--winrate.low {
  color: var(--text-error);
}

.metric--pnl {
  font-weight: 600;
  font-family: var(--font-monospace);
}

.metric--pnl.positive {
  color: var(--color-green);
}

.metric--pnl.negative {
  color: var(--color-red);
}

.metric--pnl.neutral {
  color: var(--text-muted);
}

/* Performance Indicators */
.performance-indicator {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  margin-left: 8px;
  vertical-align: middle;
}

.performance-indicator svg {
  width: 16px;
  height: 16px;
  vertical-align: text-bottom;
}

.performance-indicator--best {
  color: var(--text-warning); /* Gold color for crown */
}

.performance-indicator--worst {
  color: var(--text-error); /* Red color for alert */
}

/* Make indicators more prominent on hover */
.node-label:hover .performance-indicator--best {
  color: var(--text-warning); /* Orange on hover */
}

.node-label:hover .performance-indicator--worst {
  color: var(--text-error); /* Lighter red on hover */
}

/* Column Headers */
.trade-log-headers {
  position: sticky;
  top: 0;
  background: var(--background-secondary);
  border-bottom: 2px solid var(--background-modifier-border);
  z-index: 10;
  padding: 0;
  flex-shrink: 0; /* Prevent headers from shrinking */
}

/* Max-width container for centering on large screens */
.trade-log-content-wrapper {
  max-width: 1600px;
  margin: 0 auto;
  width: 100%;
}


.trade-log-header-row {

  display: grid;

  /* grid-template-columns set via inline style from React */

  width: 100%;
  gap: 8px;

  align-items: center;

  padding: 12px 16px 12px 16px;

  font-size: 13px;

  font-weight: 600;

  color: var(--text-muted);

  text-transform: uppercase;

}


.header-cell {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  cursor: default;
}

.header-cell.sortable {
  cursor: pointer;
  user-select: none;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 4px;
  transition: color 0.2s ease;
}

.header-cell.sortable:hover {
  color: var(--text-normal);
  background-color: var(--background-modifier-hover);
  border-radius: 4px;
}

.header-cell.sorted {
  color: var(--interactive-accent);
  font-weight: 700;
}

.sort-indicator {
  flex-shrink: 0;
}

.sort-indicator-unsorted {
  flex-shrink: 0;
  color: var(--text-faint);
  opacity: 0.5;
}

.header-image {
  display: flex;
  align-items: center;
  justify-content: center;
}

.header-ticker {
  display: flex;
  align-items: center;
  justify-content: center;
}

.header-direction {
  display: flex;
  align-items: center;
  justify-content: center;
}

.header-duration {
  display: flex;
  align-items: center;
  justify-content: center;
}

.header-status {
  display: flex;
  align-items: center;
  justify-content: center;
}

.header-pnl {
  display: flex;
  align-items: center;
  justify-content: center;
}

.header-date {
  display: flex;
  align-items: center;
  justify-content: center;
}

.header-account {
  display: flex;
  align-items: center;
  justify-content: center;
}

.header-mistakes {
  display: flex;
  align-items: center;
  justify-content: center;
}

.header-setups {
  display: flex;
  align-items: center;
  justify-content: center;
}

.header-tags {
  display: flex;
  align-items: center;
  justify-content: center;
}

.header-reviewed {
  display: flex;
  align-items: center;
  justify-content: center;
}

.header-positionSize {
  display: flex;
  align-items: center;
  justify-content: center;
}

.header-thesis {
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Trade Details Row */
.trade-details-row {
  display: grid;
  /* grid-template-columns set via inline style from React */
  gap: 8px;
  align-items: center;
  flex: 1;
  padding: 0 16px;
}

/* Tree view trade details row */
.trade-details-row.tree-view-row {
  /* grid-template-columns set via inline style from React (includes 20px tree indicator) */
  gap: 6px;
  padding: 0 16px 0 0;
}

/* Tree indicator cell */
.tree-indicator-cell {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  position: relative;
  width: 20px;
}

/* Trades view mode specific styles */
.trade-log-content.trades-view .trade-log-node--trade {
  padding: 0;
}

.trade-log-content.trades-view .trade-details-row.trades-view-row {
  padding: 0 16px;
  width: 100%;
}

/* Make trade rows clickable */
.trade-log-node--trade {
  cursor: pointer;
}

.trade-log-node--trade:hover {
  background-color: var(--background-modifier-hover);
}

/* Trade cells */
.trade-image-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-image-wrapper {
  position: relative;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  /* Remove transition for better scroll performance */
  /* transition: transform 0.15s ease; */
}

.trade-image-wrapper:hover {
  /* Simpler hover effect without transform */
  opacity: 0.8;
}

.trade-preview-thumbnail {
  width: 40px;
  height: 40px;
  border-radius: 4px;
  overflow: hidden;
  border: 1px solid var(--background-modifier-border);
  background: var(--background-secondary);
  /* Prevent layout shift while images load */
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  /* Optimize image rendering */
  image-rendering: -webkit-optimize-contrast;
  backface-visibility: hidden;
  transform: translateZ(0);
}

.trade-image-count {
  position: absolute;
  bottom: -4px;
  right: -4px;
  background: var(--background-primary);
  color: var(--text-muted);
  font-size: 10px;
  padding: 2px 4px;
  border-radius: 3px;
  border: 1px solid var(--background-modifier-border);
  font-weight: 600;
}

.trade-no-image-icon {
  color: var(--text-faint);
}

.trade-ticker-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-ticker {
  font-weight: 600;
  color: var(--text-normal);
  display: inline-flex;
  align-items: center;
  gap: 6px;
}

.trade-direction-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-direction {
  font-size: 13px;
  font-weight: 500;
  text-transform: uppercase;
  color: var(--text-normal);
}

/* Trade Status */
.trade-status {
  display: inline-block;
  padding: 2px 8px;
  border-radius: 3px;
  font-size: 12px;
  font-weight: 600;
  text-transform: uppercase;
}

.status-win {
  background: rgba(76, 175, 80, 0.15);
  color: var(--color-green);
}

.status-loss {
  background: rgba(244, 67, 54, 0.15);
  color: var(--color-red);
}

.status-breakeven {
  background: rgba(128, 128, 128, 0.15);
  color: var(--text-muted);
}

.status-missed {
  background: rgba(255, 149, 0, 0.15);
  color: var(--color-warning);
}

.status-open {
  background: rgba(33, 150, 243, 0.15);
  color: var(--status-open-color);
}

.status-backtest {
  background: rgba(111, 66, 193, 0.15);
  color: var(--text-accent);
}

.trade-pnl-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-pnl {
  font-weight: 600;
  font-family: var(--font-monospace);
  font-size: 15px;
}

.trade-pnl.positive {
  color: var(--color-green);
}

.trade-pnl.negative {
  color: var(--color-red);
}

.trade-pnl.neutral {
  color: var(--text-muted);
}

.trade-pnl.open {
  color: var(--status-open-color);
  font-style: italic;
}

.trade-status-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-duration-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-duration {
  color: var(--text-muted);
  font-size: 13px;
}

.trade-date-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-date {
  color: var(--text-muted);
  font-size: 13px;
  font-family: var(--font-monospace);
}

.trade-mistakes-cell,
.trade-setups-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-account-cell {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 4px 8px;
}

/* Single account pill badge (matching STATUS column style) */
.trade-account-text {
  display: inline-block;
  padding: 2px 8px;
  border-radius: 3px;
  font-size: 12px;
  font-weight: 600;
  text-transform: uppercase;
  white-space: nowrap;
  background: var(--background-modifier-hover);
  color: var(--interactive-accent);
}

.trade-account-text:hover {
  background: var(--background-modifier-border);
}

/* Multiple accounts: icon wrapper with badge */
.trade-account-icon-wrapper {
  position: relative;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: help;
}

.trade-account-icon {
  color: var(--text-accent);
}

.trade-account-icon:hover {
  color: var(--interactive-accent);
}

/* Count badge (top-right corner of icon) */
.trade-account-count-badge {
  position: absolute;
  top: -5px;
  right: -5px;
  display: flex;
  align-items: center;
  justify-content: center;
  min-width: 12px;
  height: 12px;
  padding: 0 3px;
  border-radius: 6px;
  background: var(--interactive-accent);
  color: var(--text-on-accent);
  font-size: 8px;
  font-weight: 600;
  line-height: 12px;
  text-align: center;
}

/* Tags column */
.trade-tags-cell {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 4px 8px;
}

.trade-tags-icon-wrapper {
  position: relative;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: help;
}

.trade-tags-icon {
  color: var(--text-accent);
}

.trade-tags-icon:hover {
  color: var(--interactive-accent);
}

.trade-tags-count-badge {
  position: absolute;
  top: -5px;
  right: -5px;
  display: flex;
  align-items: center;
  justify-content: center;
  min-width: 12px;
  height: 12px;
  padding: 0 3px;
  border-radius: 6px;
  background: var(--interactive-accent);
  color: var(--text-on-accent);
  font-size: 8px;
  font-weight: 600;
  line-height: 12px;
  text-align: center;
}

.custom-tags-tooltip .tooltip-title {
  color: var(--interactive-accent);
}

/* Reviewed column */
.trade-reviewed-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-reviewed-icon {
  flex-shrink: 0;
}

.trade-reviewed-icon--yes {
  color: var(--color-green);
}

.trade-reviewed-icon--no {
  color: var(--text-muted);
}

/* Select checkbox cell */
.trade-select-cell {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
}

.trade-select-checkbox {
  width: 16px;
  height: 16px;
  cursor: pointer;
  accent-color: var(--interactive-accent);
}

.header-select {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
}

.header-select input[type="checkbox"] {
  width: 16px;
  height: 16px;
  cursor: pointer;
  accent-color: var(--interactive-accent);
}

/* Position Size column */
.trade-position-size-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-position-size {
  font-family: var(--font-monospace);
  font-size: 13px;
  color: var(--text-normal);
}

/* Expiration Date column */
.trade-expiration-date-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-expiration-date {
  font-family: var(--font-monospace);
  font-size: 13px;
  color: var(--text-normal);
}

/* Days to Expiry column */
.trade-dte-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-dte-circle {
  display: inline-block;
  padding: 3px 8px;
  border-radius: 4px;
  font-size: 12px;
  font-weight: 600;
  min-width: 28px;
  text-align: center;
}

.trade-dte-circle--green {
  background: rgba(76, 175, 80, 0.15);
  color: var(--color-green);
}

.trade-dte-circle--yellow {
  background: rgba(245, 158, 11, 0.15);
  color: #d97706;
}

.trade-dte-circle--red {
  background: rgba(244, 67, 54, 0.15);
  color: var(--color-red);
}

.trade-dte-number {
  line-height: 1;
}

.trade-dte-expired {
  font-size: 12px;
  color: var(--text-muted);
  font-style: italic;
}

.trade-thesis-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-thesis {
  font-size: 13px;
  color: var(--text-normal);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  cursor: help;
}

.trade-no-data {
  color: var(--text-faint);
  font-size: 13px;
}

/* Count Badges */
.count-badge {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  font-size: 12px;
  font-weight: 600;
  cursor: help;
  /* Remove transition for better performance */
  /* transition: all 0.15s ease; */
}

.count-badge--mistakes {
  background: rgba(244, 67, 54, 0.15);
  color: var(--color-red);
  border: 1px solid rgba(244, 67, 54, 0.3);
}

.count-badge--mistakes:hover {
  background: rgba(244, 67, 54, 0.25);
  /* Remove transform for better performance */
  /* transform: scale(1.1); */
}

.count-badge--setups {
  background: rgba(33, 150, 243, 0.15);
  color: var(--color-info);
  border: 1px solid rgba(33, 150, 243, 0.3);
}

.count-badge--setups:hover {
  background: rgba(33, 150, 243, 0.25);
  /* Remove transform for better performance */
  /* transform: scale(1.1); */
}

/* Tooltip Styles */
.tooltip-trigger {
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  width: 100%;
}

.journalit-tooltip {
  background: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  padding: 8px 12px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  max-width: 250px;
  min-width: 120px;
  font-size: 13px;
  color: var(--text-normal);
  z-index: 9999;
  pointer-events: none;
  position: fixed !important;
}

.tooltip-title {
  font-weight: 600;
  margin-bottom: 4px;
  color: var(--text-normal);
}

.tooltip-item {
  color: var(--text-muted);
  margin: 2px 0;
  line-height: 1.4;
  white-space: nowrap;
}

.mistakes-tooltip .tooltip-title {
  color: var(--color-red);
}

.setups-tooltip .tooltip-title {
  color: var(--interactive-accent);
}

.accounts-tooltip .tooltip-title {
  color: var(--text-accent);
}

.thesis-tooltip .tooltip-content {
  white-space: pre-wrap;
  word-break: break-word;
  line-height: 1.5;
  color: var(--text-normal);
}

/* Responsive Design */
@media (max-width: 1440px) {
  .journalit-dashboard-custom-date-dropdown {
    right: -250px !important;
    width: 300px !important;
  }

  .journalit-dashboard-custom-date-dropdown.position-left {
    left: -250px !important;
    width: 300px !important;
  }
}

@media (max-width: 1200px) {
  /* grid-template-columns handled dynamically by React for responsive column widths */

  .metric--best,
  .metric--worst {
    display: none;
  }

  .trade-pnl {
    font-size: 14px;
  }

  .trade-log-controls {
    gap: 12px;
  }

  .trade-log-view-selector select {
    min-width: 75px;
    font-size: 12px;
  }
}

@media (max-width: 996px) {
  .journalit-dashboard-custom-date-dropdown {
    right: -100px !important;
  }

  .journalit-dashboard-custom-date-dropdown.position-left {
    left: -100px !important;
  }
}

@media (max-width: 900px) {
  /* grid-template-columns handled dynamically by React for responsive column widths */


  /* Removed automatic hiding of account/mistakes/setups columns at small widths to prevent phantom blank space */
  .trade-account-cell,

  .header-account,

  .trade-mistakes-cell,

  .trade-setups-cell,

  .header-mistakes,

  .header-setups {

    /* display: none; */

  }


  .trade-pnl {
    font-size: 13px;
  }

  .trade-log-controls {
    gap: 8px;
  }

  .trade-log-view-selector {
    gap: 6px;
  }

  .trade-log-view-selector label {
    font-size: 12px;
  }

  .trade-log-filter-actions {
    gap: 6px;
  }
}

@media (max-width: 768px) {
  .trade-pnl {
    font-size: 12px;
  }

  .trade-log-controls {
    gap: 6px;
    flex-wrap: wrap;
  }

  .trade-log-view-selector label {
    display: none;
  }

  .trade-log-view-selector select {
    min-width: 68px;
    font-size: 11px;
    padding: 4px 6px;
  }

  .trade-log-filter-actions {
    gap: 4px;
  }

  .journalit-dashboard-custom-date-dropdown {
    position: static !important;
    width: 100% !important;
    margin-top: 8px !important;
    flex-direction: column !important;
    box-shadow: none !important;
    left: auto !important;
    right: auto !important;
  }

  .journalit-dashboard-custom-date-dropdown.position-left,
  .journalit-dashboard-custom-date-dropdown.position-below {
    position: static !important;
    left: auto !important;
    right: auto !important;
  }
}

@media (max-width: 600px) {
  .trade-pnl {
    font-size: 12px;
  }
}

@media (max-width: 480px) {
  .trade-log-controls {
    gap: 4px;
  }

  .trade-log-view-selector select {
    min-width: 65px;
    font-size: 10px;
  }

  .trade-log-filter-actions {
    gap: 2px;
  }

  .journalit-dashboard-custom-date-dropdown.position-below {
    max-width: 100% !important;
  }
}

/* Position below fallback for when horizontal space is insufficient */
.journalit-dashboard-custom-date-dropdown.position-below {
  top: 100% !important;
  left: 0 !important;
  right: auto !important;
  margin-top: 8px !important;
  width: 100% !important;
  max-width: 360px !important;
}

`;function MG(){let e=document.createElement("style");e.id="trade-log-styles",e.textContent=cxe,document.head.appendChild(e)}function FG(){let e=document.head.querySelector("#trade-log-styles");e&&e.remove()}t1();ce.tradeLog={inject:()=>{MG(),Lv()},remove:()=>{FG(),e1()}};Oo();m1();ce.csvImport={inject:KO,remove:u1};cR();$C();ba();x1();h1();m0();g0();var IA=class{constructor(t){this.plugin=t}async cleanup(){if(this.plugin.debouncedSaveRecentItems)try{await this.plugin.debouncedSaveRecentItems.flush()}catch(r){console.error("Error flushing debounced save on unload:",r)}window.__dropdownClickHandlerAdded=!1,window.__isHandlingComboBoxRemove=!1,window.__isInjectingStyles=!1,window.__JOURNALIT_INJECT_DRC_STYLES=void 0,window.__obsidianStartTime=void 0;try{this.plugin.viewManager?this.plugin.viewManager.cleanupViews():this.plugin.app.workspace.getLeavesOfType(cl).forEach(r=>{r.detach()})}catch(r){console.error("Error detaching view leaves:",r)}try{this.plugin.processorManager?this.plugin.processorManager.cleanupProcessors():(this.plugin.tradeNoteProcessor&&this.plugin.tradeNoteProcessor.cleanup(),this.plugin.drcNoteProcessor&&this.plugin.drcNoteProcessor.cleanup(),this.plugin.weeklyReviewProcessor&&this.plugin.weeklyReviewProcessor.cleanup())}catch(r){console.error("Error cleaning up processors:",r)}this.plugin.tradeNoteProcessor=null,this.plugin.drcNoteProcessor=null,this.plugin.weeklyReviewProcessor=null;try{wd.getInstance().cleanup()}catch(r){console.error("Error cleaning up GlobalPasteManager:",r)}try{Pc(!1,!1,!1,!1,!1,!1,!1,!1)}catch(r){console.error("Error during style cleanup:",r)}try{a2()}catch(r){console.error("Error removing filter modal styles:",r)}try{t2()}catch(r){console.error("Error removing filter chip styles:",r)}try{ZO()}catch(r){console.error("Error removing filter button styles:",r)}try{n2()}catch(r){console.error("Error removing collapsible section styles:",r)}if([".journalit-trade-view",".journalit-trade-note-wrapper",".journalit-drc-view",".journalit-drc-note-wrapper",".weekly-review-wrapper",".journalit-weekly-review-view",".weekly-review"].forEach(r=>{try{document.querySelectorAll(r).forEach(o=>{var a;try{r===".weekly-review"&&typeof o.empty=="function"&&((a=o.empty)==null||a.call(o)),o.remove()}catch(i){console.error(`Error removing element ${r}:`,i)}})}catch(n){console.error(`Error processing selector ${r}:`,n)}}),window.journalitPlugin=void 0,window.JournalitPlugin=void 0,Qd.instance=null,this.plugin.serviceManager)this.plugin.serviceManager.cleanupServices();else{let r=this.plugin;r.authManager=null,r.tradeService=null,r.setupService=null,r.drcService=null,r.weeklyReviewService=null,r.monthlyReviewService=null,r.optionsService=null,r.customFieldsService=null,this.plugin.backendIntegrationService=null}this.plugin.backendIntegrationService=null,this.plugin.updateNotificationService&&(this.plugin.updateNotificationService.cleanup(),this.plugin.updateNotificationService=null)}};Zf();gv();var AA=class{constructor(t){this.plugin=t,this.debouncedSave=Gw(()=>this.saveSettingsInternal(),1e3)}async loadSettings(){let t=await this.plugin.loadData(),r=this.deepMergeSettings(wo,t||{});return await this.migrateHttpToHttpsUrls(r),await this.migrateQuickLinks(r),await this.migrateCustomOptionsToNamespaced(r),r}async saveSettings(t){try{t.weekly||(t.weekly=wo.weekly),t.dashboard||(t.dashboard=wo.dashboard),(!t.dashboard.layouts||Object.keys(t.dashboard.layouts).length===0)&&(t.dashboard.layouts=wo.dashboard.layouts),t.dashboard.layouts.Default||(t.dashboard.layouts.Default=wo.dashboard.layouts.Default),(!t.dashboard.activeLayout||!t.dashboard.layouts[t.dashboard.activeLayout])&&(t.dashboard.activeLayout="Default"),t.backendIntegration||(t.backendIntegration=wo.backendIntegration),await this.plugin.saveData(t)}catch(r){throw console.error("SettingsManager: Failed to save settings",r),r}}getDebouncedSave(){return this.debouncedSave}async saveSettingsInternal(){let t=this.plugin.settings;t&&await this.saveSettings(t)}deepMergeSettings(t,r){var o,a,i,s,l,c,d,u,p,m,f,g,v,h,y,b,x,w,S,k,T;let n={...t};if(!r)return n;r.trade&&(n.trade={...t.trade,...r.trade},n.trade.skipWeekends===void 0&&(n.trade.skipWeekends=!0)),r.drc&&(n.drc={...t.drc,...r.drc,checklistItems:r.drc.checklistItems||t.drc.checklistItems,reviewQuestions:r.drc.reviewQuestions||t.drc.reviewQuestions}),r.customOptions&&(n.customOptions={...t.customOptions,...r.customOptions}),r.initializedOptionTypes&&(n.initializedOptionTypes=r.initializedOptionTypes),r.customTradeFields&&(n.customTradeFields={...t.customTradeFields,...r.customTradeFields}),r.customFieldOptions&&(n.customFieldOptions={...t.customFieldOptions,...r.customFieldOptions}),r.weekly&&(n.weekly={...t.weekly,...r.weekly,reviewQuestions:r.weekly.reviewQuestions||t.weekly.reviewQuestions}),r.dashboard&&(n.dashboard={...t.dashboard,layouts:{...((o=t.dashboard)==null?void 0:o.layouts)||{},...r.dashboard.layouts||{}},activeLayout:r.dashboard.activeLayout||((a=t.dashboard)==null?void 0:a.activeLayout)||"Default",defaultFilters:{...((i=t.dashboard)==null?void 0:i.defaultFilters)||{},...r.dashboard.defaultFilters||{}},lastUsedFilters:r.dashboard.lastUsedFilters||((s=t.dashboard)==null?void 0:s.lastUsedFilters)},n.dashboard&&!n.dashboard.layouts.Default&&((c=(l=t.dashboard)==null?void 0:l.layouts)!=null&&c.Default)&&(n.dashboard.layouts.Default=t.dashboard.layouts.Default),n.dashboard&&n.dashboard.activeLayout&&!n.dashboard.layouts[n.dashboard.activeLayout]&&(console.warn("Active layout not found in saved layouts, resetting to Default"),n.dashboard.activeLayout="Default")),r.account&&(n.account={...t.account,...r.account,excludedAccountTypes:r.account.excludedAccountTypes||((d=t.account)==null?void 0:d.excludedAccountTypes),includeWithdrawalsFromExcluded:r.account.includeWithdrawalsFromExcluded||((u=t.account)==null?void 0:u.includeWithdrawalsFromExcluded),accountMetadata:r.account.accountMetadata||((p=t.account)==null?void 0:p.accountMetadata)||{}}),r.backendIntegration&&(n.backendIntegration={...t.backendIntegration,...r.backendIntegration}),r.uiCustomization&&(n.uiCustomization={...t.uiCustomization,...r.uiCustomization}),r.reviews&&(n.reviews={...t.reviews,...r.reviews}),n.general={currency:(f=(m=r.general)==null?void 0:m.currency)!=null?f:t.general.currency,displayName:(v=(g=r.general)==null?void 0:g.displayName)!=null?v:t.general.displayName,homeStartupBehavior:(y=(h=r.general)==null?void 0:h.homeStartupBehavior)!=null?y:t.general.homeStartupBehavior,onboardingCompleted:(x=(b=r.general)==null?void 0:b.onboardingCompleted)!=null?x:t.general.onboardingCompleted,journalFolderPath:(S=(w=r.general)==null?void 0:w.journalFolderPath)!=null?S:t.general.journalFolderPath},r.home&&(n.home={...t.home,...r.home,layouts:{...((k=t.home)==null?void 0:k.layouts)||{},...r.home.layouts||{}},recentItems:r.home.recentItems||((T=t.home)==null?void 0:T.recentItems)||[]}),r.csvTemplates?n.csvTemplates=r.csvTemplates:t.csvTemplates&&(n.csvTemplates=t.csvTemplates),r.tradeLog&&(n.tradeLog={...t.tradeLog,...r.tradeLog}),r.symbolMappings?n.symbolMappings=r.symbolMappings:t.symbolMappings&&(n.symbolMappings=t.symbolMappings);for(let P in r)r.hasOwnProperty(P)&&!(P in n)&&(n[P]=r[P]);return n}async migrateHttpToHttpsUrls(t){var n;let r=!1;if((n=t.backendIntegration)!=null&&n.serverUrl){let o=t.backendIntegration.serverUrl;(o.includes("88.198.181.204")||o.includes(":8180")||o.includes("stg-api")||o==="http://91.99.99.169"||o==="http://api.journalit.co"||o==="http://journalit.co"||o==="https://journalit.co")&&(t.backendIntegration.serverUrl="https://api.journalit.co",r=!0,console.log(`Journalit: Migrated backend URL from ${o} to https://api.journalit.co`))}r&&(await this.saveSettings(t),console.log("Journalit: Backend URL migration completed"))}async migrateQuickLinks(t){let r=!1;if(t.home||(t.home=wo.home,r=!0),!t.home.quickLinks)t.home.quickLinks=wo.home.quickLinks,r=!0;else{let n=new Set(t.home.quickLinks.map(a=>a.id)),o=wo.home.quickLinks;for(let a of o)n.has(a.id)||(t.home.quickLinks.push(a),r=!0,console.log(`Journalit: Added missing quick link: ${a.id}`))}r&&(await this.saveSettings(t),console.log("Journalit: Quick links migration completed"))}async migrateCustomOptionsToNamespaced(t){let r=!1;t.customOptions&&(!t.customOptions_options||Object.keys(t.customOptions_options).length===0)?(t.customOptions_options={...t.customOptions},r=!0,console.log("Journalit: Migrated custom options to namespaced storage")):t.customOptions&&t.customOptions_options&&(delete t.customOptions,r=!0),r&&await this.saveSettings(t)}};pt();Oo();am();kO();function Zse(e=!1){if(!(window.__isInjectingStyles&&!e)){window.__isInjectingStyles=!0;try{Pc(!1,!1,!0,!0,!1,!1,!1,!0),ce.shared&&ce.shared.inject(),ce.interactions&&ce.interactions.inject(),ce.combobox&&ce.combobox.inject(),ce.processorComponent&&ce.processorComponent.inject(),ce.settings&&ce.settings.inject(),ce.tooltip&&ce.tooltip.inject(),hv()}catch(t){console.error("Failed to inject critical styles:",t)}finally{window.__isInjectingStyles=!1}}}function ele(){if(!window.__isInjectingStyles){window.__isInjectingStyles=!0;try{ce.chart&&ce.chart.inject(),ce.dragOverlay&&ce.dragOverlay.inject(),ce.image&&ce.image.inject(),ce.tradeForm&&ce.tradeForm.inject(),ce.weeklyReview&&ce.weeklyReview.inject(),ce.drc&&ce.drc.inject(),ce.drcNote&&ce.drcNote.inject(),ce.tradeNote&&ce.tradeNote.inject(),ce.dashboard&&ce.dashboard.inject(),ce.account&&ce.account.inject(),typeof window!="undefined"&&ce.drc&&(window.__JOURNALIT_INJECT_DRC_STYLES=ce.drc.inject)}catch(e){console.error("Failed to inject non-critical styles:",e)}finally{window.__isInjectingStyles=!1}}}NA();$C();var Ts=require("obsidian");Td();var tle=require("obsidian"),jt=q(Y()),rle=q(wn());er();Nr();var dR=class extends tle.Modal{constructor(r){super(r.app);this.root=null;this.confirmCalled=!1;this.props=r}onOpen(){let{contentEl:r}=this;r.empty();let n=r.createDiv();this.root=(0,rle.createRoot)(n),this.root.render(jt.default.createElement(Sze,{...this.props,onClose:()=>this.close(),markConfirmCalled:()=>{this.confirmCalled=!0}})),r.addClass("legacy-tag-cleanup-modal"),r.classList.add("jl-modal-container")}onClose(){var r,n;this.confirmCalled||this.props.onConfirm(!1),this.root&&(this.root.unmount(),this.root=null),(n=(r=this.props).onClose)==null||n.call(r)}},Sze=({tradeCount:e,onConfirm:t,onClose:r,markConfirmCalled:n})=>{let o=()=>{n==null||n(),t(!0),r()},a=()=>{n==null||n(),t(!1),r()};return jt.default.createElement("div",{style:{fontFamily:"var(--default-font)",fontSize:"14px",lineHeight:"1.5",maxWidth:"600px"}},jt.default.createElement("div",{style:{display:"flex",alignItems:"center",marginBottom:"20px",paddingBottom:"15px",borderBottom:"1px solid var(--background-modifier-border)"}},jt.default.createElement(lo,{size:24,style:{marginRight:"10px",color:"var(--color-yellow)",flexShrink:0}}),jt.default.createElement("h2",{style:{margin:0,color:"var(--text-normal)",fontSize:"18px",fontWeight:600}},"Clean Legacy Auto-Generated Tags")),jt.default.createElement("div",{style:{marginBottom:"20px"}},jt.default.createElement("p",{style:{color:"var(--text-normal)",marginBottom:"12px",lineHeight:"1.6"}},"This operation will clean up legacy auto-generated tags from your trade notes. This plugin no longer auto-generates tags like ",jt.default.createElement("code",null,"asset/"),",",jt.default.createElement("code",null,"direction/"),", ",jt.default.createElement("code",null,"setup/"),", etc.")),jt.default.createElement("div",{style:{padding:"12px 16px",backgroundColor:"var(--background-secondary)",borderRadius:"6px",border:"1px solid var(--color-yellow)",marginBottom:"20px"}},jt.default.createElement("div",{style:{display:"flex",alignItems:"flex-start",gap:"8px"}},jt.default.createElement(lo,{size:16,style:{marginTop:"2px",color:"var(--color-yellow)",flexShrink:0}}),jt.default.createElement("div",null,jt.default.createElement("strong",{style:{color:"var(--text-normal)",display:"block",marginBottom:"4px"}},"Backup Recommended"),jt.default.createElement("div",{style:{color:"var(--text-muted)",fontSize:"13px"}},"This operation will modify your trade note files. We strongly recommend creating a backup of your vault before proceeding.")))),jt.default.createElement("div",{style:{marginBottom:"20px"}},jt.default.createElement("h3",{style:{fontSize:"14px",fontWeight:600,color:"var(--text-normal)",marginBottom:"12px",marginTop:0}},"What will happen:"),jt.default.createElement("ul",{style:{margin:"0 0 12px 0",padding:"0 0 0 20px",color:"var(--text-muted)",lineHeight:"1.8"}},jt.default.createElement("li",null,jt.default.createElement("strong",{style:{color:"var(--text-normal)"}},"Remove")," legacy auto-generated tags like ",jt.default.createElement("code",null,"asset/"),", ",jt.default.createElement("code",null,"direction/"),", ",jt.default.createElement("code",null,"setup/"),",",jt.default.createElement("code",null,"mistake/"),", ",jt.default.createElement("code",null,"account/"),", ",jt.default.createElement("code",null,"periodic/"),", ",jt.default.createElement("code",null,"status/"),", base ",jt.default.createElement("code",null,"trade")," tag, and instrument/exchange names"),jt.default.createElement("li",null,jt.default.createElement("strong",{style:{color:"var(--text-normal)"}},"Preserve")," all user-added custom tags"),jt.default.createElement("li",null,jt.default.createElement("strong",{style:{color:"var(--text-normal)"}},"Update")," approximately"," ",jt.default.createElement("strong",{style:{color:"var(--color-accent)"}},e)," trade note",e!==1?"s":""),jt.default.createElement("li",null,jt.default.createElement("strong",{style:{color:"var(--text-normal)"}},"Modify")," frontmatter in trade note files")),e>100&&jt.default.createElement("div",{style:{padding:"8px 12px",backgroundColor:"var(--background-secondary)",borderRadius:"4px",fontSize:"13px",color:"var(--text-muted)",marginTop:"12px"}},jt.default.createElement("strong",{style:{color:"var(--text-normal)"}},"Note:")," With ",e," trades, this operation may take a few moments to complete.")),jt.default.createElement("div",{style:{padding:"12px 16px",backgroundColor:"var(--background-modifier-error-hover)",borderRadius:"6px",border:"1px solid var(--background-modifier-error)",marginBottom:"20px"}},jt.default.createElement("div",{style:{color:"var(--text-normal)",fontSize:"13px",fontWeight:600,lineHeight:"1.5"}},"\u26A0\uFE0F This action modifies your trade note files and cannot be automatically undone.")),jt.default.createElement("div",{style:{display:"flex",justifyContent:"flex-end",gap:"10px",borderTop:"1px solid var(--background-modifier-border)",paddingTop:"15px"}},jt.default.createElement(he,{variant:"secondary",onClick:a,style:{minWidth:"100px"}},"Cancel"),jt.default.createElement(he,{variant:"primary",onClick:o,style:{minWidth:"180px"}},"Proceed with Cleanup")))};function nle(e,t,r){new dR({app:e,tradeCount:t,onConfirm:r,onClose:()=>{}}).open()}var ole=require("obsidian");ls();function Tze(e,t){if(!e||typeof e!="string")return!1;let r=e.trim(),n=["asset/","direction/","setup/","mistake/","account/","periodic/","status/"];for(let o of n)if(r.startsWith(o))return!0;return!!(r==="trade"||r==="missed-trade"||r==="backtest-trade"||t.instrument&&typeof t.instrument=="string"&&r.toLowerCase()===t.instrument.toLowerCase().trim()||t.exchange&&typeof t.exchange=="string"&&r.toLowerCase()===t.exchange.toLowerCase().trim())}async function ale(e,t){var c;let r=0,n=0,o=0,a=t.length,i=0,s=[],l=typeof window!="undefined"?window.journalitPlugin:void 0;(c=l==null?void 0:l.backendIntegrationService)!=null&&c.fileWatcherService&&t.forEach(d=>{l.backendIntegrationService.fileWatcherService.batchModifiedFiles.add(d)});for(let d of t)try{let u=e.vault.getAbstractFileByPath(d);if(!(u instanceof ole.TFile)){console.warn(`File not found or not a TFile: ${d}`),o++;continue}let p=!1,m=!1,f=0;await e.fileManager.processFrontMatter(u,g=>{let v=Array.isArray(g.tags)?g.tags:[],h=v.filter(y=>{let b=Tze(y,g);return b&&f++,!b});if(h.length===v.length){p=!0;return}g.tags=h,m=!0}),p?n++:m?(r++,i+=f,s.push(u)):o++}catch(u){console.error(`Failed to cleanup legacy tags: ${d}`,u),o++}return await Promise.all(s.map(d=>yr(e,d,120).catch(u=>{}))),document.dispatchEvent(new CustomEvent("journalit:trade-data-changed",{detail:{action:"batch-tags-cleaned",fileCount:s.length,tagsRemoved:i,timestamp:Date.now()}})),setTimeout(()=>{var u;let d=typeof window!="undefined"?window.journalitPlugin:void 0;(u=d==null?void 0:d.backendIntegrationService)!=null&&u.fileWatcherService&&t.forEach(p=>{d.backendIntegrationService.fileWatcherService.batchModifiedFiles.delete(p)})},500),{processed:r,skipped:n,errors:o,total:a,tagsRemoved:i}}function ile(e){return`.journalit/migrations/${e}.json`}async function sle(e,t){if(!t||t.includes("..")||t.includes("/")||t.includes("\\"))return console.warn(`[MigrationTracker] Invalid migrationId: ${t}`),!1;try{let r=ile(t);if(!await e.vault.adapter.exists(r))return!1;let o=await e.vault.adapter.read(r);try{return JSON.parse(o).completed===!0}catch(a){return console.warn(`Migration tracker: Corrupted status file for ${t}:`,a instanceof Error?a.message:"Invalid JSON"),!1}}catch(r){return console.warn(`Migration tracker: Failed to check migration status for ${t}:`,r instanceof Error?r.message:String(r)),!1}}async function lle(e,t,r){try{if(!t||t.includes("..")||t.includes("/")||t.includes("\\"))throw new Error(`Invalid migrationId: ${t}`);await e.vault.adapter.exists(".journalit")||await e.vault.adapter.mkdir(".journalit");let n=".journalit/migrations";await e.vault.adapter.exists(n)||await e.vault.adapter.mkdir(n);let o={...r,completed:!0,completedAt:new Date().toISOString(),version:(r==null?void 0:r.version)||"1.0.0"},a=ile(t);await e.vault.adapter.write(a,JSON.stringify(o,null,2)),console.log(`Migration tracker: Marked ${t} as completed`)}catch(n){throw console.error(`Migration tracker: Failed to mark migration ${t} as completed:`,n instanceof Error?n.message:String(n)),n}}var MA=class{constructor(t){this.plugin=t}registerAllCommands(){this.registerAuthCommands(),this.registerRemainingCommands()}registerAuthCommands(){}registerRemainingCommands(){this.registerTradeCommands(),this.registerReviewCommands(),this.registerViewCommands(),this.registerSyncCommands(),this.registerMaintenanceCommands()}registerTradeCommands(){this.plugin.addCommand({id:"add-trade",name:"Add New Trade",callback:async()=>{new jo({app:this.plugin.app,plugin:this.plugin}).open()}}),this.plugin.addCommand({id:"import-trades-csv",name:"Import Trades from CSV",callback:async()=>{await this.plugin.viewManager.openCSVImportView()}})}registerReviewCommands(){this.plugin.addCommand({id:"create-drc",name:"Create Daily Report Card",callback:async()=>{try{await(await this.plugin.serviceManager.getDRCService()).openDRC(new Date)}catch(t){console.error("Failed to create DRC:",t),new Ts.Notice("Failed to create Daily Report Card: "+(t instanceof Error?t.message:String(t)))}}}),this.plugin.addCommand({id:"create-weekly-review",name:"Create Weekly Review",callback:async()=>{try{await(await this.plugin.serviceManager.getWeeklyReviewService()).openWeeklyReview(new Date)}catch(t){console.error("Failed to create Weekly Review:",t),new Ts.Notice("Failed to create Weekly Review: "+(t instanceof Error?t.message:String(t)))}}}),this.plugin.addCommand({id:"create-monthly-review",name:"Create Monthly Review",callback:async()=>{try{await(await this.plugin.serviceManager.getMonthlyReviewService()).openMonthlyReview(new Date)}catch(t){console.error("Failed to create Monthly Review:",t),new Ts.Notice("Failed to create Monthly Review: "+(t instanceof Error?t.message:String(t)))}}})}registerViewCommands(){this.plugin.addCommand({id:"open-dashboard",name:"Open Trading Dashboard",callback:async()=>{await this.plugin.viewManager.openDashboardView()}}),this.plugin.addCommand({id:"open-account-dashboard",name:"Open Account Dashboard",callback:async()=>{await this.plugin.openAccountDashboard()}}),this.plugin.addCommand({id:"open-trade-log",name:"Open Trade Log",callback:async()=>{await this.plugin.viewManager.openTradeLogView()}}),this.plugin.addCommand({id:"open-home",name:"Open Home View",callback:async()=>{await this.plugin.viewManager.openHomeView()}})}registerSyncCommands(){this.plugin.addCommand({id:"force-sync",name:"Force Sync Trades",callback:async()=>{try{let r=await(await this.plugin.serviceManager.getBackendIntegrationService()).forceSync()}catch(t){console.error("Failed to force sync trades:",t),new Ts.Notice("Failed to sync trades: "+(t instanceof Error?t.message:String(t)))}}}),this.plugin.addCommand({id:"cancel-sync",name:"Cancel Trade Sync",callback:async()=>{try{(await this.plugin.serviceManager.getBackendIntegrationService()).cancelSync()}catch(t){new Ts.Notice("\u274C No sync in progress")}}})}registerMaintenanceCommands(){this.plugin.addCommand({id:"cleanup-legacy-tags",name:"Clean legacy auto-generated tags",callback:async()=>{try{let t="tag-cleanup-v1";if(await sle(this.plugin.app,t)){new Ts.Notice("Legacy tag cleanup has already been completed for this vault.");return}let o=this.plugin.app.vault.getMarkdownFiles().filter(a=>{let i=this.plugin.app.metadataCache.getFileCache(a),s=i==null?void 0:i.frontmatter;return s?s.type==="trade"||s.type==="backtest-trade"||s.isMissedTrade===!0:!1}).map(a=>a.path);if(o.length===0){new Ts.Notice("No trade files found to clean up.");return}nle(this.plugin.app,o.length,async a=>{if(!a)return;let i;try{i=new Ts.Notice(`Cleaning legacy tags from ${o.length} trades...`,0);let s=await ale(this.plugin.app,o);i.hide(),s.errors===0?await lle(this.plugin.app,t,{fileCount:s.processed,tagsRemoved:s.tagsRemoved,errors:0}):console.warn(`Legacy tag cleanup had ${s.errors} errors. Migration not marked as complete to allow retry.`),s.errors>0?new Ts.Notice(`Tag cleanup completed with errors:
Processed: ${s.processed}
Skipped: ${s.skipped}
Errors: ${s.errors}
Tags removed: ${s.tagsRemoved}`,1e4):new Ts.Notice(`Successfully cleaned ${s.tagsRemoved} legacy tags from ${s.processed} trades!
Skipped: ${s.skipped} (no changes needed)`,8e3)}catch(s){i&&i.hide(),console.error("Failed to cleanup legacy tags:",s),new Ts.Notice("Failed to cleanup legacy tags. Check console for details.")}})}catch(t){console.error("Failed to cleanup legacy tags:",t),new Ts.Notice("Failed to cleanup legacy tags. Check console for details.")}}}),this.plugin.addCommand({id:"replay-onboarding",name:"Replay Onboarding Flow",callback:async()=>{await this.plugin.onboardingManager.showOnboardingModal()}}),this.plugin.addCommand({id:"open-release-notes",name:"View release notes",callback:async()=>{var t;try{await((t=this.plugin.updateNotificationService)==null?void 0:t.openReleaseNotes())}catch(r){console.error("Failed to open release notes:",r),new Ts.Notice("Failed to open release notes: "+(r instanceof Error?r.message:String(r)))}}})}};var cle=require("obsidian"),FA=class{constructor(t){this.plugin=t}registerRibbonIcons(){this.registerHomeRibbon()}registerHomeRibbon(){this.plugin.addRibbonIcon("circle-dot-dashed","Open Journalit",async()=>{try{await this.plugin.viewManager.openHomeView()}catch(t){console.error("[Journalit] Failed to open home view from ribbon:",t),new cle.Notice("Failed to open Journalit. Please try reloading Obsidian.")}})}};var OA=require("obsidian");uR();var jA=class{constructor(t){this.plugin=t}initializeDynamicLinkMaintenance(){this.plugin.registerEvent(this.plugin.app.vault.on("create",t=>{t instanceof OA.TFile&&t.extension==="md"&&this.handleFileCreated(t)})),this.plugin.registerEvent(this.plugin.app.vault.on("rename",(t,r)=>{t instanceof OA.TFile&&t.extension==="md"&&this.handleFileRenamed(t,r)})),this.plugin.registerEvent(this.plugin.app.vault.on("delete",t=>{t instanceof OA.TFile&&t.extension==="md"&&this.handleFileDeleted(t)}))}async handleFileCreated(t){try{if(await new Promise(n=>setTimeout(n,100)),!this.plugin.app.vault.getAbstractFileByPath(t.path))return;let r=await Si.detectNoteType(t,this.plugin.app.vault);if(r.type==="trade"&&r.date){let n=await dle(r.date,this.plugin),o=await this.plugin.app.vault.read(t),a=Si.updateLinksSection(o,n);if(a!==o)try{await this.plugin.app.vault.modify(t,a)}catch(i){console.error(`[FileHandler] Failed to modify trade file ${t.basename}:`,i),setTimeout(async()=>{try{let s=await this.plugin.app.vault.read(t),l=Si.updateLinksSection(s,n);l!==s&&await this.plugin.app.vault.modify(t,l)}catch(s){console.error(`[FileHandler] Final retry failed for trade file ${t.basename}:`,s)}},500)}}else if(r.type==="drc"&&r.date){let n=await gS(r.date,this.plugin),o=await this.plugin.app.vault.read(t),a=Si.updateLinksSection(o,n);if(a!==o)try{await this.plugin.app.vault.modify(t,a)}catch(i){console.error(`[FileHandler] Failed to modify DRC file ${t.basename}:`,i)}}else if(r.type==="weekly"&&r.date){let n=await ule(r.date,this.plugin),o=await this.plugin.app.vault.read(t),a=Si.updateLinksSection(o,n);if(a!==o)try{await this.plugin.app.vault.modify(t,a)}catch(i){console.error(`[FileHandler] Failed to modify weekly file ${t.basename}:`,i)}}else if(r.type==="monthly"&&r.date){let n=await this.plugin.app.vault.read(t),o=Si.removeLinksSection(n);if(o!==n)try{await this.plugin.app.vault.modify(t,o)}catch(a){console.error(`[FileHandler] Failed to modify monthly file ${t.basename}:`,a)}}}catch(r){console.error(`[FileHandler] Error handling file creation for ${t.path}:`,r)}}async handleFileRenamed(t,r){}async handleFileDeleted(t){}};var Ale=require("obsidian"),UA=class{constructor(t){this.plugin=t}async showOnboardingModal(){try{let t=await this.plugin.serviceManager.getOnboardingService();await t.startOnboarding();let{OnboardingWizardModalWrapper:r}=await Promise.resolve().then(()=>(ER(),DR));new r(this.plugin.app,this.plugin,async o=>{this.plugin.settings.general&&(this.plugin.settings.general.onboardingCompleted=!0),await this.plugin.saveSettings()},async()=>{await t.skipOnboarding()},void 0,void 0,t).open()}catch(t){console.error("Failed to launch onboarding flow:",t),new Ale.Notice("Failed to open onboarding flow. Check console for details.")}}async checkAndShowOnboarding(){try{let t=`journalit-onboarding-ever-shown-${this.plugin.app.vault.getName()}`;if(localStorage.getItem(t))return;(await this.plugin.serviceManager.getOnboardingService()).shouldShowOnboarding()&&(localStorage.setItem(t,"true"),await this.showOnboardingModal())}catch(t){console.error("Error checking/showing onboarding:",t)}}};FR();NR();var QA=require("obsidian");SS();var XA=class{constructor(t,r,n){this.plugin=t,this.app=t.app,this.viewManager=r,this.debouncedSaveRecentItems=n}async openFile(t,r=!0){try{let n=this.app.vault.getAbstractFileByPath(t);if(n instanceof QA.TFile){let o=null;if(this.app.workspace.iterateAllLeaves(i=>{var s;if(i.view instanceof QA.FileView&&((s=i.view.file)==null?void 0:s.path)===t)return o=i,!0}),o){this.app.workspace.revealLeaf(o);return}await(r?this.app.workspace.getLeaf("tab"):this.app.workspace.getLeaf()).openFile(n)}else console.error(`Could not open file: ${t} - File not found or not a valid file`)}catch(n){console.error(`Error opening file: ${t}`,n)}}trackRecentView(t,r,n){if(t===Ti)return;let o={type:"view",title:r,viewType:t,icon:n,openedAt:new Date().toISOString()};this.addRecentItem(o)}async addRecentItem(t){let r=this.plugin.settings,o=this.plugin.recentItems.filter(i=>t.type==="file"?i.path!==t.path:i.viewType!==t.viewType||i.title!==t.title);o.unshift(t);let a=o.length>20?o.slice(0,20):o;this.plugin.recentItems=a,r.home||(r.home={layouts:{},activeLayout:"Default",recentItems:[]}),r.home.recentItems=[...a];try{await this.debouncedSaveRecentItems()}catch(i){if(i.message==="Debounced function cancelled")return;throw i}document.dispatchEvent(new CustomEvent("journalit:recent-items-changed",{detail:{recentItems:[...a]}}))}async openHomeOnStartup(){var t;try{let n=((t=this.plugin.settings.general)==null?void 0:t.homeStartupBehavior)||"always";if(n==="never")return;let o=this.app.workspace.getLeavesOfType(Ti);if(o.length>0){console.log("[Journalit] Home view already exists from workspace restoration"),n==="always"&&(console.log("[Journalit] Revealing existing home view"),this.app.workspace.revealLeaf(o[0]));return}let a=!1;if(n==="always")a=!0;else if(n==="ifNone"){let i=this.app.workspace.getActiveFile(),s=this.app.workspace.getLeavesOfType("markdown");a=!(i||s.length>0)}a&&(console.log("[Journalit] Opening Journalit view on startup"),await this.viewManager.openHomeView())}catch(r){console.error("Error opening Journalit on startup:",r)}}};var TS=require("obsidian");var OR=require("obsidian"),ZA=class{constructor(){this.containerEl=null;this.dismissed=!1;this.hideTimeoutId=null}createContainer(){this.containerEl=document.body.createDiv(),this.containerEl.addClass("journalit-update-toast"),this.containerEl.style.position="absolute",this.containerEl.style.bottom="24px",this.containerEl.style.left="24px",this.containerEl.style.zIndex="10000",this.containerEl.style.maxWidth="400px",this.containerEl.style.opacity="0",this.containerEl.style.transform="translateX(-100%)",this.containerEl.style.transition="opacity 0.3s ease-out, transform 0.3s ease-out",this.injectStyles()}injectStyles(){let t="journalit-update-toast-styles";if(document.getElementById(t))return;let r=document.createElement("style");r.id=t,r.textContent=`
			.journalit-update-toast {
				background: var(--background-primary);
				border: 1px solid var(--background-modifier-border);
				border-radius: 8px;
				box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
				padding: 0;
				font-family: var(--font-interface);
				position: relative;
				overflow: hidden;
			}

			.journalit-update-toast-title {
				color: var(--text-normal);
				font-size: 18px;
				font-weight: 500;
				margin: 0 0 12px 0;
				padding: 0 20px;
				letter-spacing: -0.02em;
				line-height: 1.3;
			}

			.journalit-update-toast-version {
				color: var(--text-accent);
				font-size: 11px;
				font-weight: 600;
				text-transform: uppercase;
				letter-spacing: 0.08em;
				margin: 0 0 4px 0;
				padding: 0 20px;
				display: block;
				opacity: 0.85;
			}

			.journalit-update-toast-close {
				position: absolute;
				top: 8px;
				right: 8px;
				background: var(--background-primary);
				border: 1px solid var(--background-modifier-border);
				border-radius: 50%;
				color: var(--text-muted);
				cursor: pointer;
				font-size: 18px;
				line-height: 1;
				padding: 0;
				width: 20px;
				height: 20px;
				display: flex;
				align-items: center;
				justify-content: center;
				z-index: 10;
			}

			.journalit-update-toast-close:hover {
				color: var(--text-normal);
				background: var(--background-secondary);
			}

			.journalit-update-toast-image {
				width: 100%;
				height: auto;
				border-radius: 8px 8px 0 0;
				margin-bottom: 12px;
				display: block;
			}

			.journalit-update-toast-description {
				color: var(--text-muted);
				font-size: 13px;
				line-height: 1.6;
				margin: 0 0 16px 0;
				padding: 0 20px;
				opacity: 0.9;
			}

			.journalit-update-toast-separator {
				border-top: 1px solid var(--background-modifier-border);
				margin: 0 0 12px 0;
			}

			.journalit-update-toast-button-container {
				padding: 0 20px 16px 20px;
				display: flex;
				justify-content: space-between;
				align-items: center;
			}

			.journalit-update-toast-button {
				background: var(--interactive-accent);
				color: var(--text-on-accent);
				border: none;
				border-radius: 6px;
				padding: 6px 12px;
				font-size: 12px;
				font-weight: 500;
				cursor: pointer;
				transition: background 0.2s ease;
				letter-spacing: 0.01em;
				display: flex;
				align-items: center;
				gap: 6px;
			}

			.journalit-update-toast-button:hover {
				background: var(--interactive-accent-hover);
			}

			.journalit-update-toast-discord-button {
				background: transparent;
				color: var(--text-muted);
				border: 1px solid var(--background-modifier-border);
				border-radius: 6px;
				padding: 6px 10px;
				font-size: 12px;
				font-weight: 500;
				cursor: pointer;
				transition: all 0.2s ease;
				display: flex;
				align-items: center;
				gap: 6px;
			}

			.journalit-update-toast-discord-button:hover {
				background: var(--background-secondary);
				color: var(--text-normal);
				border-color: var(--background-modifier-border-hover);
			}

			.journalit-update-toast-button-icon {
				width: 14px;
				height: 14px;
				display: flex;
				align-items: center;
				justify-content: center;
			}

			@media (max-width: 768px) {
				.journalit-update-toast {
					bottom: 80px;
					left: 12px;
					right: 12px;
					max-width: calc(100vw - 24px);
				}
			}
		`,document.head.appendChild(r)}async show(t){if(this.dismissed)return;if(this.containerEl||this.createContainer(),this.containerEl.empty(),this.containerEl.createEl("button",{cls:"journalit-update-toast-close",text:"\xD7"}).addEventListener("click",()=>this.hide()),t.imageUrl){let u=await this.loadImage(t.imageUrl);u&&(u.addClass("journalit-update-toast-image"),this.containerEl.appendChild(u))}let n=this.containerEl.createDiv({cls:"journalit-update-toast-version",text:t.version}),o=this.containerEl.createEl("h3",{cls:"journalit-update-toast-title",text:t.title}),a=this.containerEl.createDiv({cls:"journalit-update-toast-description",text:t.description});this.containerEl.createDiv({cls:"journalit-update-toast-separator"});let i=this.containerEl.createDiv({cls:"journalit-update-toast-button-container"}),s=i.createEl("button",{cls:"journalit-update-toast-discord-button"}),l=s.createSpan({cls:"journalit-update-toast-button-icon"});(0,OR.setIcon)(l,"messages-square"),s.appendText("Discord"),s.addEventListener("click",()=>{window.open("https://discord.gg/AkSw3D9h8b","_blank")});let c=i.createEl("button",{cls:"journalit-update-toast-button",text:"Learn more"}),d=c.createSpan({cls:"journalit-update-toast-button-icon"});(0,OR.setIcon)(d,"corner-down-right"),c.addEventListener("click",()=>{t.onViewReleaseNotes(),this.hide()}),this.containerEl.parentElement||(t.parentContainer||document.body).appendChild(this.containerEl),requestAnimationFrame(()=>{this.containerEl.style.opacity="1",this.containerEl.style.transform="translateX(0)"})}hide(){this.dismissed||!this.containerEl||(this.dismissed=!0,this.containerEl.style.opacity="0",this.containerEl.style.transform="translateX(-100%)",this.hideTimeoutId!==null&&clearTimeout(this.hideTimeoutId),this.hideTimeoutId=window.setTimeout(()=>{var t;(t=this.containerEl)==null||t.remove(),this.hideTimeoutId=null},300))}cleanup(){this.hideTimeoutId!==null&&(clearTimeout(this.hideTimeoutId),this.hideTimeoutId=null),this.containerEl&&(this.containerEl.remove(),this.containerEl=null);let t=document.getElementById("journalit-update-toast-styles");t&&t.remove()}async loadImage(t){return new Promise(r=>{let n=new Image,o=setTimeout(()=>{n.src="",r(null)},5e3);n.onload=()=>{clearTimeout(o),r(n)},n.onerror=a=>{console.error("[CustomUpdateToast] Image load error:",a),clearTimeout(o),r(null)},n.src=t})}};var dce=q(Y());Xf();var Lt=q(Y()),tL=require("obsidian");pt();var eL={"1.5.3-beta.1":{title:"New Widgets + Instrument Specs",description:"Instrument specifications, TradingView import, enhanced dashboard metrics, and critical bug fixes.",imageUrl:"https://github.com/user-attachments/assets/c745828e-165f-4b9d-b013-7353700272f4",features:["Add TradingView broker guide support","Add resource links to general settings tab header","Add resource links to release notes view header","Update broker guide links to Journalit documentation","Enhance release workflow with interactive automation"],content:`# **1.5.3-beta.1**
Instrument specifications, TradingView import, enhanced dashboard metrics, and critical bug fixes.

## **Global Instrument Specifications**
![Global Specs](https://github.com/user-attachments/assets/f0f962e4-5e63-482c-9a65-b182a19debfd)
Define instrument parameters once and apply them automatically across all trades
- **Automatic symbol normalization** - Applies to all manual and imported trades
- **Symbol Mappings**
*Access via Settings > Customisation > Tickers/Symbols*

## **TradingView CSV Import**
Native support for TradingView paper trading exports

## **Dashboard Enhancements**
![Dashboard Widgets](https://github.com/user-attachments/assets/c745828e-165f-4b9d-b013-7353700272f4)
New metrics and improved widget controls
- **Avg win/loss hold time metrics**
- **Period selectors**
- **Rolling Win/Loss Ratio chart**

## **Update Notification System**
Stay informed about new releases
- **Release notes view** - Browse changelogs directly in the plugin *(CTRL + P, \`View release notes\`)*
*Can be disabled at the bottom of the general settings tab*

## **TradeLog Tags Column**
![TradeLog Tags](https://github.com/user-attachments/assets/9ad8d467-110c-4148-9f80-f286385d18b2)
Display custom user tags
- **Tags column** - See your trade tags at a glance without opening trade details
- **Legacy tag cleanup** - Removed auto generated tags. Please run **[Ctrl + P, \`search for "Clean"\`]** to remove legacy tags.

## **Fixes**
- Fixed critical P&L bugs: direction comparison, validation guards, error handling
- Fixed IBKR CSV import: SELL-only filtering and chronological sorting
- Fixed timezone bugs causing DRCs to show data from previous day
- Fixed UTC timezone shift in creation date handling
- Fixed account modal crashes from corrupted date data
- Fixed tag normalization and frontmatter serialization issues
- Fixed duplicate tags/mistakes with escaped quotes and tag paths
- Fixed cache not refreshed on options change
- Fixed trade note navigation to use NavigationManager
+ many more under the hood improvements and code quality enhancements

Please make sure to run **[Ctrl + P, \`search for "Clean"\`]** to remove legacy tags.
`},"1.5.2-beta.2":{title:"Quick Hotfix Update",description:"Bug fixes for daily goals, trade status detection, and TradeLog display",features:["Daily goals correctly carry over to next day","Trades with multiple entries but no exits show as OPEN","MISSED and BACKTEST trades display without needing filters","Default custom options can be removed properly","Thesis column alignment fixed in TradeLog"],content:`# **1.5.2-beta.2**
Quick hotfix update

## **Fixes**
- Daily goals now correctly carry over to next day
- Trades with multiple entries but no exits show as OPEN correctly
- MISSED and BACKTEST trades now display in TradeLog without needing filters
- Default custom options can now be removed properly
- Thesis column alignment fixed in TradeLog
`},"1.5.2-beta.1":{title:"Major Trade Log Overhaul",description:"Multi-select, enhanced filtering, and performance improvements",imageUrl:"https://github.com/user-attachments/assets/d8f1750e-8b7b-4db2-a487-8aff564d52e6",features:["Multi-select with batch operations toolbar","Column customization with drag-and-drop reordering","80-99% performance improvement","Advanced unified filter system","TradeZero CSV import support"],content:`# **1.5.2-beta.1**
Major Trade Log overhaul with multi-select, enhanced filtering, and performance improvements.

## **MAJOR Trade Log Enchacements**
![Trade Log](https://github.com/user-attachments/assets/d8f1750e-8b7b-4db2-a487-8aff564d52e6)
Complete rebuild with modern features and dramatic performance gains
![Multi-select](https://github.com/user-attachments/assets/1c2a3e56-375b-4e94-8142-0556543ebfbc)
- **Multi-select** - Shift-click to select multiple trades, batch operations toolbar for bulk actions
- **Batch Operation Toolbar** - Easily mark as reviewed, add setups, add mistakes or delete selected trades
![Column Customisation](https://github.com/user-attachments/assets/fa8b2223-8f14-4572-8cdf-5454ba037f47)
- **Column customization** - Choose which columns to display, reorder and resize to your preference
- **Scroll persistence** - TradeLog remembers your scroll position when navigating away
- **80-99% performance improvement** - Parallel cache refresh for lightning-fast data updates
*Access column settings via TradeLog header controls, multi-select with shift-click*

## **Advanced Filter System**
![Advanced Filters](https://github.com/user-attachments/assets/04da4feb-3c11-4339-95a7-2d90d69725d3)
Unified filtering interface with enhanced controls
*Access via filter button in Dashboard and TradeLog headers*

## **TradeZero CSV Import Support**
Import trades directly from TradeZero broker

## **Trade Form Protection**
![Form Protection](https://github.com/user-attachments/assets/2c3c1347-1272-42ef-93e0-a996977f410c)
Prevent accidental data loss with unsaved changes

## **Fixes**
- Fixed race condition in trade file creation causing data loss
- Fixed performance calendar month labels overlaying sticky header
- Fixed missing Direction field for option trades in frontmatter
- Fixed duplicate images pasting into DRC and Weekly Review
- Fixed trade status detection bugs for trades with multiple entries
- Fixed focus loss in entry/exit rows during editing
- Fixed accountMetadata data loss during settings reconstruction
+ many more under the hood improvements and code quality enhancements
`},"1.5.1-beta.2":{title:"Bug Fixes & Improvements",description:"Minor bug fixes and performance improvements",imageUrl:"https://github.com/user-attachments/assets/47aad6ac-4c8b-4dbe-b3ca-97337705dc48",features:["Fixed version comparison for build timestamps","Improved toast positioning in HomeView","Better error handling"]},"1.5.1-beta.1":{title:"Advanced Filtering System",description:"New filtering options across dashboard and TradeLog for better strategy analysis",imageUrl:"https://github.com/user-attachments/assets/0f58b43e-40d8-4b27-b293-7e3fd13fb2ef",features:["Setup filter for strategy analysis in dashboard","Account filtering in TradeLog","Trade rebates tracking for options trades","Copy trading P&L multiplier setting","Fixed multi-year monthly review backlinks","Fixed R-multiples calculation bugs"],content:`# 1.5.1-beta.1

Stability improvements, new filtering options, and enhanced trade management features.

## Setup Filter

![Dashboard Filter](https://github.com/user-attachments/assets/0f58b43e-40d8-4b27-b293-7e3fd13fb2ef)

Filter trades by specific setups in the trading dashboard

- Strategy analysis - Isolate performance by trade setup/strategy
- Pattern recognition - See which setups perform best
- Access via dashboard filter controls alongside Account and Ticker filters

## Trade Rebates

Support for rebate tracking on options trades

- Rebate field - Track credits received from brokers on options trades
- Net cost calculation - Automatically factors rebates into P&L
- Options-specific - Field restricted to options asset types only
- Add rebates when editing trades to see accurate net P&L

## Account Filtering in TradeLog

![TradeLog Filter](https://github.com/user-attachments/assets/93b8208d-a2a6-4b66-8273-bdc5f470ebbb)

Filter TradeLog view by specific accounts

- Multi-account support - View trades from selected accounts only
- Access via TradeLog header filter controls

## Copy Trading PnL Multiplier

Setting for copy trading account calculations

- Accurate tracking - Properly calculate P&L for copy trading setups
- Configure in Settings under General tab

## Fixes

- Fixed backlinks for multi-year monthly review collisions
- Fixed account-related errors in account page
- Fixed R-multiples calculation bugs in P&L calculations
- Many more under the hood fixes and improvements

Planning on upgrading the trade log with a bunch more features.
`},"1.5.0-beta.1":{title:"CSV Import, R-Multiples & Manual Drawdown",description:"Major update with CSV import system, R-multiple risk tracking, and manual trailing drawdown",imageUrl:"https://github.com/user-attachments/assets/5c272fb2-19c7-4db0-94c0-0fecf67281be",features:["CSV import system with IBKR and Tradovate adapters","Smart duplicate detection and AI-powered mapping","Manual trailing drawdown with snapshot system","R-multiple risk tracking with stop loss fields","Breakeven range configuration","Critical stability fixes for plugin reload and timezone issues"],content:`# 1.5.0-beta.1

Major update: CSV Import, R-Multiple tracking, and critical stability improvements.

## CSV Import System

![CSV Import](https://github.com/user-attachments/assets/5c272fb2-19c7-4db0-94c0-0fecf67281be)

Import trades from any broker directly into your vault

- Built-in broker adapters - IBKR and Tradovate support
- Smart duplicate detection - Prevents re-importing via time/price matching
- AI-powered mapping - Optional OpenAI assistance for custom formats

![CSV Import Manual Mapping](https://github.com/user-attachments/assets/9466227d-f819-44cc-a505-fb04fbc019bb)

- Manual mapping - Map any CSV for unsupported brokers
- Template sharing - JTT codes enable community template distribution
- Access via homepage \`Customize -> restore hidden\` or \`Ctrl+P\` search \`CSV\`

## Manual Trailing Drawdown

![Manual Drawdown Entry](https://github.com/user-attachments/assets/18c45c6e-52a5-438f-9402-632d1187faee)

![Manual Drawdown Settings](https://github.com/user-attachments/assets/893c2b86-61d9-4fa1-abf9-01e9fe4aebb0)

- Snapshot system - Log dated drawdown limits manually
- Stepped chart - Visualize how limits change over time
- Progress tracking - Auto-calculates remaining room and percentage used
- Perfect for prop firms with live equity trailing drawdowns

## R-Multiple Risk Tracking

![R-Multiples & Breakeven Settings](https://github.com/user-attachments/assets/39c9a2cd-21b2-47f0-8432-8b66d353dc34)

Measure trades in risk units instead of currency

- Stop Loss field - Auto-calculates risk from entry-to-stop distance
- Manual override - Set custom risk amounts with preview
- Default risk - Pre-fills from settings
- Display toggle - View ALL metrics in R-multiples instead of currency

## Breakeven Range

- Define a range for breakeven instead of exact zero

## Fixes

- Fixed "plugin gone away" errors on reload
- Fixed date mismatches for UTC-1 to UTC-12 timezones
- Fixed TradeLog creating duplicate trades with random suffixes
- Cross-platform workspace compatibility
- Custom options persistence
- Reviewed trades filtering
- Plus more under the hood improvements
`},"1.5.0":{title:"Major Performance Update",description:"Faster sync and improved UI responsiveness",features:["Trade sync optimization","UI performance improvements","Bug fixes"]},"1.4.2-beta.3":{title:"Hotfix: Folder Migration System",description:"Simplified folder location changes with manual file moving",features:["Removed automatic folder migration when changing Journalit folder location","Replaced with manual move of existing files","New trades automatically created in new folder location"],content:`# 1.4.2-beta.3

## Hotfix: Folder Migration System

- Removed automatic folder migration code when changing Journalit folder location in vault
- Replaced with manual move of existing files
- New trades will automatically be created in new folder location of choice
`},"1.4.2-beta.2":{title:"Account Filtering & Custom Folder Location",description:"Complete account filtering across review components and customisable journal folder location",imageUrl:"https://github.com/user-attachments/assets/2afaafc4-ef96-4ec2-9fd0-81edd5fae72d",features:["Account filtering across DRC, Weekly, and Monthly reviews","Trade status filtering in Trade Log (open/closed/win/loss/breakeven)","Fast date/time input system (e.g., '280925 1104P')","Customisable homepage quick links with drag-and-drop","Custom journal folder location with migration system","Calendar timezone fixes and phantom trade count elimination"],content:`# 1.4.2-beta.2

Working on the CSV importer as one of my main focuses for now but will still be fixing bugs and adding feature requests along the way.

## Review Notes Account Filtering

![Review Notes Account Filter](https://github.com/user-attachments/assets/2afaafc4-ef96-4ec2-9fd0-81edd5fae72d)

- Complete account filtering across all review components (DRC, Weekly Review, Monthly Review)
- Smart cache management to prevent calculation conflicts and improve performance
- Filter your data by specific accounts to get focused insights on individual trading strategies

## Trade Log Updates

![Trade Log Updates](https://github.com/user-attachments/assets/06be594f-30b8-4ebe-85e3-fc05561015b2)

- Added trade status filtering with open/closed/win/loss/breakeven options in Trade Log
- Added "This Quarter" time range filter button

## Better Date/Time Input in Trade Form

- Fast date/time input system with combined format support for quicker trade entry
- Type \`280925 1104P\` to get 28/09/25 1104PM

## Customisable Homepage Experience

- Drag-and-drop customisable quick links for personalised navigation
- Easily remove any of the homepage navigation buttons you don't want

## Custom Journalit Folder Location

- Customisable journal folder location with complete migration system
- Safety enhancements to prevent data loss during folder changes
- Centralised folder path management for better organisation
- Take full control of where your trading journal data is stored within your vault

## Calendar Fixes

- Eliminated phantom trade counts that were inflating statistics
- Resolved timezone date discrepancies between bar charts and calendar

## Other Fixes & Improvements

- Fixed Trade Log scrolling issues for datasets with \u226450 trades
- Improved tick size formatting and reduced unnecessary refreshes
- And more under the hood improvements
`},"1.4.1-beta.1":{title:"Home View & Backtest Trading",description:"Complete drag-and-drop home page with widgets and backtest trade support",imageUrl:"https://github.com/user-attachments/assets/6a770114-42e2-4df6-ad89-71511ff02dbc",features:["Drag-and-drop home page with Recent Items and Trading Heatmap widgets","GitHub-style contributions heatmap for daily P&L performance","Backtest trade system with dedicated 'B' prefix file naming","Percentage-based commission tracking","2-minute trade sync speed","Privacy-first analytics with explicit consent"],content:`# 1.4.1-beta.1

## Home View

![Home Page](https://github.com/user-attachments/assets/6a770114-42e2-4df6-ad89-71511ff02dbc)

- Complete drag-and-drop home page with 2 widgets (Recent Items, Trading Heatmap)
- GitHub-style contributions heatmap showing daily P&L performance with interactive tooltips
- Recent Items widget tracks your last 5 accessed files/views for quick navigation
- Ability to set your username for the greeting used in the homepage in the settings
- Ability to choose whether the home page loads every time you open Obsidian in the settings
- Removed all the other ribbon icons and consolidated them into 1 for less noise
- You can still access all the other pages from the home page, commands (Ctrl+P), or custom hotkeys

## Trade Sync Enhancements

- Trade sync should take MAXIMUM 2 minutes before they reach your trading vault now

## Backtest Trade System

![Backtest Trade Type](https://github.com/user-attachments/assets/bb80dea8-7808-4eec-82ee-e3cfe742b744)

- Backtesting trade management with dedicated 'B' prefix file naming
- Easily select this in our dropdown selector in the trade form

## Enhanced Commission & Cost Tracking

- Percentage-based commission option (0-100%) alongside existing fixed dollar amounts
- Track your costs more accurately whether you pay fixed fees or percentage-based commissions

## Privacy-First Analytics

- Optional telemetry system with explicit user consent (disabled by default)
- Help us improve the plugin while maintaining complete privacy over your trading data

## Other Fixes & Improvements

- Major performance optimizations
- Enhanced error handling system with user-friendly notifications and better debugging
- Added optional exit date/time fields for enhanced DirectPnL mode precision
- Cleaned up frontmatter from not showing other asset type fields
- Fixed options PNL calculations to follow contract pricing
`}};var lce=({leaf:e,view:t})=>{let r=xe(),[n,o]=(0,Lt.useState)([]),[a,i]=(0,Lt.useState)(null),[s,l]=(0,Lt.useState)(!0),c=(0,Lt.useRef)(null),d=(0,Lt.useRef)(null),u=(0,Lt.useRef)(null);if((0,Lt.useEffect)(()=>{r&&p()},[r]),(0,Lt.useEffect)(()=>{c.current&&(0,tL.setIcon)(c.current,"book-open"),d.current&&(0,tL.setIcon)(d.current,"messages-square"),u.current&&(0,tL.setIcon)(u.current,"github")},[]),!r)return Lt.default.createElement("div",{className:"release-notes-view"},Lt.default.createElement("div",{className:"loading"},"Loading plugin..."));let p=()=>{try{l(!0);let h=Object.entries(eL).filter(([,y])=>y.content).map(([y,b])=>({version:y,content:b.content}));h.sort((y,b)=>{let x=k=>{let[T,P]=k.split("-"),[D,O,z]=T.split(".").map(Number),I=null;return P!=null&&P.startsWith("beta.")&&(I=parseInt(P.replace("beta.",""),10)),{major:D,minor:O,patch:z,isBeta:!!P,betaNum:I}},w=x(y.version),S=x(b.version);return S.major!==w.major?S.major-w.major:S.minor!==w.minor?S.minor-w.minor:S.patch!==w.patch?S.patch-w.patch:w.isBeta!==S.isBeta?w.isBeta?1:-1:w.isBeta&&S.isBeta&&w.betaNum!==S.betaNum?(S.betaNum||0)-(w.betaNum||0):0}),o(h),h.length>0&&i(h[0].version)}catch(v){console.error("Failed to load changelogs:",v),o([])}finally{l(!1)}},m=v=>v.replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>").replace(/(?<!\*)\*([^*]+)\*(?!\*)/g,"<em>$1</em>").replace(/`([^`]+)`/g,"<code>$1</code>").replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank">$1</a>'),f=v=>{let h=v.split(`
`),y=[],b=[],x=0,w=()=>{b.length>0&&(y.push(Lt.default.createElement("ul",{key:`list-${x++}`},b.map((S,k)=>Lt.default.createElement("li",{key:k,dangerouslySetInnerHTML:{__html:S}})))),b=[])};for(let S=0;S<h.length;S++){let k=h[S];if(k.trim()===""){w();continue}if(k.startsWith("# ")){w();let P=m(k.slice(2));y.push(Lt.default.createElement("h2",{key:`h2-${x++}`,dangerouslySetInnerHTML:{__html:P}}));continue}if(k.startsWith("## ")){w();let P=m(k.slice(3));y.push(Lt.default.createElement("h3",{key:`h3-${x++}`,dangerouslySetInnerHTML:{__html:P}}));continue}if(k.startsWith("### ")){w();let P=m(k.slice(4));y.push(Lt.default.createElement("h4",{key:`h4-${x++}`,dangerouslySetInnerHTML:{__html:P}}));continue}let T=k.match(/!\[([^\]]*)\]\(([^)]+)\)/);if(T){w();let[,P,D]=T,O=D;(D.startsWith("./")||D.startsWith("../"))&&console.warn("[ReleaseNotes] Relative image paths not supported, use remote URLs:",D),y.push(Lt.default.createElement("div",{key:`img-${x++}`,className:"changelog-image"},Lt.default.createElement("img",{src:O,alt:P})));continue}if(k.match(/^[\s]*[-*]\s+/)){let P=k.replace(/^[\s]*[-*]\s+/,"");b.push(m(P));continue}w(),y.push(Lt.default.createElement("p",{key:`p-${x++}`,dangerouslySetInnerHTML:{__html:m(k)}}))}return w(),Lt.default.createElement(Lt.default.Fragment,null,y)},g=v=>{i(a===v?null:v)};return Lt.default.createElement("div",{className:"release-notes-view"},Lt.default.createElement("div",{className:"release-notes-header"},Lt.default.createElement("h2",null,"Release Notes"),Lt.default.createElement("div",{className:"release-notes-header-actions"},Lt.default.createElement("button",{className:"release-notes-action-button",onClick:()=>window.open("https://journalit.co/docs","_blank")},Lt.default.createElement("span",{ref:c,className:"button-icon"}),Lt.default.createElement("span",null,"Docs")),Lt.default.createElement("button",{className:"release-notes-action-button",onClick:()=>window.open("https://discord.gg/AkSw3D9h8b","_blank")},Lt.default.createElement("span",{ref:d,className:"button-icon"}),Lt.default.createElement("span",null,"Discord")),Lt.default.createElement("button",{className:"release-notes-action-button",onClick:()=>window.open("https://github.com/Cursivez/journalit","_blank")},Lt.default.createElement("span",{ref:u,className:"button-icon"}),Lt.default.createElement("span",null,"GitHub"))),Lt.default.createElement("div",{className:"current-version"},"Current: v",r.manifest.version)),s?Lt.default.createElement("div",{className:"loading"},"Loading release notes..."):n.length===0?Lt.default.createElement("div",{className:"no-content"},"No release notes found"):Lt.default.createElement("div",{className:"changelog-list"},n.map(({version:v,content:h})=>Lt.default.createElement("div",{key:v,className:`changelog-entry ${a===v?"expanded":""}`},Lt.default.createElement("div",{className:"changelog-header",onClick:()=>g(v)},Lt.default.createElement("h3",null,"Version ",v),Lt.default.createElement("span",{className:"expand-icon"},a===v?"\u25BC":"\u25B6")),a===v&&Lt.default.createElement("div",{className:"changelog-content"},f(h))))))};var jze=`
/* Release Notes Container */
.journalit-release-notes-container {
  background: var(--background-primary);
  color: var(--text-normal);
  overflow-y: auto;
  height: 100%;
}

/* Preserve default view header height */
.journalit-release-notes-container .view-header {
  flex-shrink: 0;
}

.release-notes-view {
  max-width: 800px;
  margin: 0 auto;
  padding: 24px;
}

.release-notes-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
  padding-bottom: 16px;
  border-bottom: 2px solid var(--background-modifier-border);
}

.release-notes-header h2 {
  margin: 0;
  font-size: 24px;
  font-weight: 600;
}

.current-version {
  font-size: 14px;
  color: var(--text-muted);
  background: var(--background-secondary);
  padding: 4px 12px;
  border-radius: 12px;
}

.release-notes-header-actions {
  display: flex;
  gap: 8px;
  align-items: center;
}

.release-notes-action-button {
  background: var(--background-secondary);
  color: var(--text-normal);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  padding: 4px 10px;
  font-size: 12px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  gap: 4px;
}

.release-notes-action-button:hover {
  background: var(--background-modifier-hover);
  border-color: var(--background-modifier-border-hover);
}

.release-notes-action-button .button-icon {
  width: 12px;
  height: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.changelog-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.changelog-entry {
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  overflow: hidden;
  background: var(--background-primary-alt);
}

.changelog-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px;
  cursor: pointer;
  background: var(--background-primary-alt);
  transition: background 0.2s;
}

.changelog-header:hover {
  background: var(--background-modifier-hover);
}

.changelog-header h3 {
  margin: 0;
  font-size: 16px;
  font-weight: 600;
}

.expand-icon {
  color: var(--text-muted);
  font-size: 12px;
  transition: transform 0.2s;
}

.changelog-content {
  padding: 0 16px 16px 16px;
  line-height: 1.6;
  animation: expandDown 0.3s ease-out;
}

.changelog-content h3 {
  margin-top: 16px;
  margin-bottom: 8px;
  font-size: 18px;
  font-weight: 600;
}

.changelog-content h4 {
  margin-top: 12px;
  margin-bottom: 6px;
  font-size: 16px;
  font-weight: 600;
}

.changelog-content img {
  max-width: 100%;
  border-radius: 8px;
  margin: 16px 0;
  border: 1px solid var(--background-modifier-border);
}

.changelog-content ul {
  padding-left: 24px;
  margin: 8px 0;
}

.changelog-content li {
  margin: 4px 0;
}

.loading {
  text-align: center;
  padding: 48px;
  color: var(--text-muted);
}

@keyframes expandDown {
  from {
    opacity: 0;
    max-height: 0;
  }
  to {
    opacity: 1;
    max-height: 5000px;
  }
}
`;function zze(){try{let e="release-notes-styles";if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=jze,document.head.appendChild(t)}catch(e){console.error("Failed to inject Release Notes styles:",e)}}function cce(){if(document.getElementById("release-notes-styles")||zze(),!document.getElementById("critical-release-notes-styles")){let e=document.createElement("style");e.id="critical-release-notes-styles",e.textContent=`
      /* Critical core styles for Release Notes */
      .journalit-release-notes-container {
        display: block !important;
        width: 100% !important;
        height: 100% !important;
        overflow: auto !important;
        box-sizing: border-box !important;
      }

      .release-notes-view {
        display: block !important;
        width: 100% !important;
        padding: 24px !important;
        box-sizing: border-box !important;
      }

      .changelog-list {
        display: flex !important;
        flex-direction: column !important;
        gap: 16px !important;
      }

      .changelog-entry {
        display: block !important;
        border: 1px solid var(--background-modifier-border) !important;
        border-radius: 8px !important;
        overflow: hidden !important;
      }

      .changelog-header {
        display: flex !important;
        justify-content: space-between !important;
        align-items: center !important;
        padding: 12px 16px !important;
        cursor: pointer !important;
      }
    `,document.head.appendChild(e)}}var Wb="journalit-release-notes",rL=class extends us{getDisplayText(){return"Release Notes"}getViewType(){return Wb}getIcon(){return"scroll"}async onOpen(){cce(),this.containerEl.classList.add("journalit-release-notes-container"),await super.onOpen()}getRenderFunction(){return()=>dce.default.createElement(lce,{leaf:this.leaf,view:this})}};SS();var nL=class{constructor(t){this.currentToast=null;this.plugin=t}async checkForUpdates(){var n;let t=this.plugin.manifest.version,r=(n=this.plugin.settings.backendIntegration)==null?void 0:n.lastSeenVersion;if(!r){try{await this.updateLastSeenVersion(t)}catch(o){console.error("[UpdateNotification] Failed to save last seen version on first install:",o)}return}if(this.isNewerVersion(t,r)){await this.showUpdateNotification(t);try{await this.updateLastSeenVersion(t)}catch(o){console.error("[UpdateNotification] Failed to save last seen version:",o)}}}async showUpdateNotification(t){var r;if((r=this.plugin.settings.backendIntegration)!=null&&r.showUpdateNotifications)try{let n=this.loadReleaseMetadata(),o=this.normalizeVersionForLookup(t),a=n[o];if(!a){new TS.Notice(`Journalit updated to v${t}!`,8e3);return}let i=this.plugin.app.workspace.getLeavesOfType(Ti);if(i.length===0){new TS.Notice(`Journalit updated to v${t}!`,8e3);return}let l=i[0].view.containerEl;(!l.style.position||l.style.position==="static")&&(l.style.position="relative"),this.currentToast=new ZA,await this.currentToast.show({version:t,title:a.title,description:a.description,imageUrl:a.imageUrl,parentContainer:l,onViewReleaseNotes:()=>this.openReleaseNotes()})}catch(n){console.error("[UpdateNotification] Failed to show update notification:",n),console.error("[UpdateNotification] Error stack:",n instanceof Error?n.stack:"No stack trace"),new TS.Notice(`Journalit updated to v${t}!`,8e3)}}loadReleaseMetadata(){return eL}isNewerVersion(t,r){let n=f=>{let g=f.match(/^(\d+\.\d+\.\d+)/);return g?g[1]:f},o=n(t),a=n(r),i=o.split(".").map(Number),s=a.split(".").map(Number),[l=0,c=0,d=0]=i,[u=0,p=0,m=0]=s;return!Number.isFinite(l)||!Number.isFinite(c)||!Number.isFinite(d)||!Number.isFinite(u)||!Number.isFinite(p)||!Number.isFinite(m)?!1:l>u||l===u&&c>p||l===u&&c===p&&d>m}normalizeVersionForLookup(t){return t.replace(/-\d{13}$/,"")}async updateLastSeenVersion(t){this.plugin.settings.backendIntegration&&(this.plugin.settings.backendIntegration.lastSeenVersion=t,await this.plugin.saveSettings())}async openReleaseNotes(){let{workspace:t}=this.plugin.app,r=t.getLeavesOfType(Wb)[0];try{r||(r=t.getLeaf("tab"),await r.setViewState({type:Wb,active:!0})),t.revealLeaf(r)}catch(n){console.error("[UpdateNotification] Failed to open release notes:",n),new TS.Notice("Failed to open release notes. Please try again.",5e3)}}cleanup(){this.currentToast&&(this.currentToast.cleanup(),this.currentToast=null)}};var bN=class{constructor(t){this.plugin=t}async initialize(){let t=Date.now();window.__obsidianStartTime=t,await this.initializeCriticalPath(),await this.initializeCoreServices(),await this.setupEssentialUI(),await this.registerCoreFunctionality(),this.plugin.app.workspace.onLayoutReady(()=>{this.initializeNonCriticalComponents(),setTimeout(()=>{this.openHomeOnStartup()},100)})}async initializeCriticalPath(){var a;JH(this.plugin),window.journalitPlugin=this.plugin,window.JournalitPlugin=Qd,Qd.instance=this.plugin,this.plugin.settings=await this.plugin.settingsManager.loadSettings(),(a=this.plugin.settings.home)!=null&&a.recentItems&&(this.plugin.recentItems=[...this.plugin.settings.home.recentItems]),this.plugin.debouncedSaveRecentItems=this.plugin.settingsManager.getDebouncedSave(),await this.cleanupOldFiles(),this.plugin.lastFileOpenTime=Date.now();let{removeInjectedStyles:t}=await Promise.resolve().then(()=>(ba(),bG));t(!1,!1,!0,!0),Zse();let{ServiceManager:r}=await Promise.resolve().then(()=>(CL(),Gce)),{ProcessorManager:n}=await Promise.resolve().then(()=>(Jde(),Kde)),{ViewManager:o}=await Promise.resolve().then(()=>(yfe(),vfe));this.plugin.serviceManager=r.getInstance(this.plugin.app,this.plugin),this.plugin.processorManager=n.getInstance(this.plugin.app,this.plugin),this.plugin.viewManager=o.getInstance(this.plugin),this.plugin.navigationManager=new XA(this.plugin,this.plugin.viewManager,this.plugin.debouncedSaveRecentItems)}async initializeCoreServices(){await Promise.resolve(),await this.plugin.serviceManager.initializeCoreServices(),this.plugin.authManager=this.plugin.serviceManager.getAuthManager(),this.plugin.tradeService=this.plugin.serviceManager.getTradeService(),this.plugin.customFieldsService=this.plugin.serviceManager.getCustomFieldsService(),this.plugin.optionsService=this.plugin.serviceManager.getOptionsServiceSync();let{InstrumentSpecService:t}=await Promise.resolve().then(()=>(kfe(),wfe));this.plugin.specService=new t(this.plugin);try{this.plugin.specService.loadMappings(),console.log("[Journalit] InstrumentSpecService initialized")}catch(r){console.error("[Journalit] Failed to load symbol mappings from settings, continuing with empty mappings:",r)}this.plugin.updateNotificationService=new nL(this.plugin),this.plugin.registerView(Wb,r=>new rL(r));try{await this.plugin.viewManager.registerHomeView()}catch(r){console.error("[Journalit] Failed to register home view early:",r)}}async setupEssentialUI(){let{JournalitSettingsTab:t}=await Promise.resolve().then(()=>(pge(),uge));await Promise.resolve();let r=new t(this.plugin.app,this.plugin);this.plugin.settingsTab=r,this.plugin.addSettingTab(r),this.setupEventHandlers()}setupEventHandlers(){this.plugin.registerEvent(this.plugin.app.workspace.on("file-open",t=>{if(this.plugin.lastFileOpenTime=Date.now(),t){let r={type:"file",title:t.basename,path:t.path,icon:"file-text",openedAt:new Date().toISOString()};this.plugin.navigationManager.addRecentItem(r)}})),this.plugin.registerEvent(this.plugin.app.workspace.on("active-leaf-change",t=>{if(t&&t.view){let r=t.view.getViewType(),o=(a=>{switch(a){case"journalit-dashboard-view":return{label:"Trading Dashboard",icon:"grip"};case"account-dashboard":return{label:"Account Dashboard",icon:"users"};case"journalit-trade-log-view":return{label:"Trade Log",icon:"folder-tree"};case"journalit-account-page-view":return{label:t.getDisplayText()||"Account Page",icon:"user"};default:return null}})(r);o&&this.plugin.navigationManager.trackRecentView(r,o.label,o.icon)}}))}async registerCoreFunctionality(){await this.plugin.viewManager.registerDashboardView(),await this.plugin.viewManager.registerAccountDashboardView(),await this.plugin.viewManager.registerTradeLogView(),await this.plugin.viewManager.registerAccountPageView(),await this.plugin.viewManager.registerCSVImportView(),console.log("[Journalit] All views registered successfully")}async initializeNonCriticalComponents(){let t=Date.now();try{ele();try{this.plugin.serviceManager.preInitializeServices(["onboardingService"]),typeof window.requestIdleCallback=="function"&&window.requestIdleCallback(()=>{var r;(r=this.plugin.onboardingManager)==null||r.checkAndShowOnboarding()}),typeof window.requestIdleCallback=="function"&&window.requestIdleCallback(async()=>{try{await Promise.resolve().then(()=>(ER(),DR))}catch(r){}})}catch(r){console.warn("[Journalit] Failed to warm-up onboarding modules:",r)}this.plugin.commandRegistry=new MA(this.plugin),this.plugin.ribbonManager=new FA(this.plugin),this.plugin.backlinkHandler=new jA(this.plugin),this.plugin.onboardingManager=new UA(this.plugin),await fS([()=>{this.plugin.commandRegistry.registerAllCommands(),this.plugin.ribbonManager.registerRibbonIcons()},async()=>{await this.plugin.processorManager.initializeRequiredProcessors(),this.plugin.processorManager.registerProcessor("missed-trade",new $b(this.plugin.app,this.plugin)),this.plugin.processorManager.registerRenderer("missed-trade",new _b(this.plugin.app));let r=this.plugin.processorManager.getAllInitializedProcessors();this.plugin.tradeNoteProcessor=r.tradeNoteProcessor,this.plugin.drcNoteProcessor=r.drcNoteProcessor,this.plugin.weeklyReviewProcessor=r.weeklyReviewProcessor},async()=>{try{this.plugin.setupService=await this.plugin.serviceManager.getSetupService(),this.plugin.drcService=await this.plugin.serviceManager.getDRCService()}catch(r){console.error("Error initializing high-priority services:",r)}},async()=>{try{this.plugin.weeklyReviewService=await this.plugin.serviceManager.getWeeklyReviewService(),this.plugin.monthlyReviewService=await this.plugin.serviceManager.getMonthlyReviewService(),this.plugin.missedTradeService=await this.plugin.serviceManager.getMissedTradeService(),this.plugin.backtestTradeService=await this.plugin.serviceManager.getBacktestTradeService(),wd.getInstance().initialize()}catch(r){console.error("Error initializing secondary services:",r)}},async()=>{try{this.plugin.accountPageService=await this.plugin.serviceManager.getAccountPageService()}catch(r){console.error("Error initializing background services:",r)}},async()=>{await this.plugin.viewManager.registerAllViews()},async()=>{await this.handleInitialFileRendering()},async()=>{var r,n;try{if((r=this.plugin.settings.backendIntegration)!=null&&r.syncEnabled){let o=await this.plugin.serviceManager.getBackendIntegrationService();this.plugin.backendIntegrationService=o,await o.registerVault()}}catch(o){console.error("Error initializing backend integration:",o)}try{await((n=this.plugin.updateNotificationService)==null?void 0:n.checkForUpdates())}catch(o){console.error("Error checking for plugin updates:",o)}}],30)}catch(r){console.error("Error during non-critical initialization:",r)}this.plugin.backlinkHandler.initializeDynamicLinkMaintenance()}async handleInitialFileRendering(){let t=this.plugin.app.workspace.getActiveFile();if(!t)return;let r=this.plugin.app.metadataCache.getFileCache(t),n=r==null?void 0:r.frontmatter;if(n&&(n.type==="drc"&&(this.plugin.drcNoteProcessor||(this.plugin.drcNoteProcessor=await this.plugin.processorManager.getDRCNoteProcessor())),n.type==="trade"&&(this.plugin.tradeNoteProcessor||(this.plugin.tradeNoteProcessor=await this.plugin.processorManager.getTradeNoteProcessor())),n.type==="weekly-review")){let o=document.querySelectorAll(`.journalit-weekly-review-view[data-file-path="${t.path}"]`);if(o.length>0&&Array.from(o).some(i=>i.querySelector(".weekly-review-container")))return;this.plugin.weeklyReviewProcessor||(this.plugin.weeklyReviewProcessor=await this.plugin.processorManager.getWeeklyReviewProcessor()),this.plugin.weeklyReviewProcessor&&(await this.plugin.weeklyReviewProcessor.renderActiveWeeklyReview(),this.plugin.weeklyReviewProcessor.registerCurrentLeaves())}}async openHomeOnStartup(){await this.plugin.navigationManager.openHomeOnStartup()}async cleanupOldFiles(){try{let t=`${this.plugin.app.vault.configDir}/plugins/journalit/main.css`,r=this.plugin.app.vault.adapter;await r.exists(t)&&(await r.remove(t),console.log("[Journalit] Removed deprecated main.css file"))}catch(t){console.error("[Journalit] Error cleaning up old files:",t)}}};window&&(document.querySelectorAll("script").forEach(t=>{let r=t.textContent||"";(r.includes("DROPDOWN_FIX")||r.includes("COMBOBOX")||r.includes("TRADEFORM"))&&t.remove()}),window.__dropdownClickHandlerAdded=!1,window.__isHandlingComboBoxRemove=!1,window.__isInjectingStyles=!1);var Qd=class extends KS.Plugin{constructor(){super(...arguments);this.backendIntegrationService=null;this.tradeNoteProcessor=null;this.drcNoteProcessor=null;this.weeklyReviewProcessor=null;this.recentItems=[];this.updateNotificationService=null;this.settingsTab=null}async onload(){this.settingsManager=new AA(this),this.cleanupManager=new IA(this),this.pluginInitializer=new bN(this),await this.pluginInitializer.initialize()}openSettingsToTab(r){this.settingsTab&&this.settingsTab.setInitialTab(r),this.app.setting.open(),this.app.setting.openTabById(this.manifest.id)}async openAccountDashboard(){try{await this.viewManager.openAccountDashboardView()}catch(r){console.error("Error opening account dashboard:",r),new KS.Notice("Failed to open account dashboard: "+(r instanceof Error?r.message:String(r)))}}async onunload(){try{await this.cleanupManager.cleanup()}catch(r){console.error("Error during plugin cleanup:",r)}}async saveSettings(){await this.settingsManager.saveSettings(this.settings)}async openTradeFormInEditMode(r,n){try{new jo({app:this.app,plugin:this,isEditMode:!0,initialData:r||{},filePath:n||""}).open()}catch(o){console.error("Failed to open trade form in edit mode:",o),new KS.Notice("Failed to open trade form in edit mode: "+(o instanceof Error?o.message:String(o)))}}async openFile(r,n=!0){await this.navigationManager.openFile(r,n)}trackRecentView(r,n,o){this.navigationManager.trackRecentView(r,n,o)}};Qd.instance=null;
/*! Bundled license information:

react/cjs/react.production.min.js:
  (**
   * @license React
   * react.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

scheduler/cjs/scheduler.production.min.js:
  (**
   * @license React
   * scheduler.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

react-dom/cjs/react-dom.production.min.js:
  (**
   * @license React
   * react-dom.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/shared/src/utils.js:
lucide-react/dist/esm/defaultAttributes.js:
lucide-react/dist/esm/Icon.js:
lucide-react/dist/esm/createLucideIcon.js:
lucide-react/dist/esm/icons/arrow-down-1-0.js:
lucide-react/dist/esm/icons/arrow-down-wide-narrow.js:
lucide-react/dist/esm/icons/arrow-down-z-a.js:
lucide-react/dist/esm/icons/arrow-right.js:
lucide-react/dist/esm/icons/arrow-up-0-1.js:
lucide-react/dist/esm/icons/arrow-up-a-z.js:
lucide-react/dist/esm/icons/arrow-up-down.js:
lucide-react/dist/esm/icons/arrow-up-narrow-wide.js:
lucide-react/dist/esm/icons/award.js:
lucide-react/dist/esm/icons/badge-check.js:
lucide-react/dist/esm/icons/ban.js:
lucide-react/dist/esm/icons/book-open.js:
lucide-react/dist/esm/icons/brain.js:
lucide-react/dist/esm/icons/calendar-check.js:
lucide-react/dist/esm/icons/calendar-range.js:
lucide-react/dist/esm/icons/calendar.js:
lucide-react/dist/esm/icons/chart-column.js:
lucide-react/dist/esm/icons/check.js:
lucide-react/dist/esm/icons/chevron-down.js:
lucide-react/dist/esm/icons/circle-alert.js:
lucide-react/dist/esm/icons/circle-check.js:
lucide-react/dist/esm/icons/circle-plus.js:
lucide-react/dist/esm/icons/circle-question-mark.js:
lucide-react/dist/esm/icons/circle.js:
lucide-react/dist/esm/icons/clipboard-paste.js:
lucide-react/dist/esm/icons/clock.js:
lucide-react/dist/esm/icons/copy.js:
lucide-react/dist/esm/icons/ellipsis.js:
lucide-react/dist/esm/icons/external-link.js:
lucide-react/dist/esm/icons/eye-off.js:
lucide-react/dist/esm/icons/eye.js:
lucide-react/dist/esm/icons/file-pen.js:
lucide-react/dist/esm/icons/file-text.js:
lucide-react/dist/esm/icons/file.js:
lucide-react/dist/esm/icons/flask-conical.js:
lucide-react/dist/esm/icons/folder-open.js:
lucide-react/dist/esm/icons/folder-tree.js:
lucide-react/dist/esm/icons/funnel.js:
lucide-react/dist/esm/icons/gem.js:
lucide-react/dist/esm/icons/ghost.js:
lucide-react/dist/esm/icons/grid-2x2-plus.js:
lucide-react/dist/esm/icons/grip-vertical.js:
lucide-react/dist/esm/icons/grip.js:
lucide-react/dist/esm/icons/import.js:
lucide-react/dist/esm/icons/info.js:
lucide-react/dist/esm/icons/key.js:
lucide-react/dist/esm/icons/lock.js:
lucide-react/dist/esm/icons/message-circle.js:
lucide-react/dist/esm/icons/plus.js:
lucide-react/dist/esm/icons/radio.js:
lucide-react/dist/esm/icons/refresh-cw.js:
lucide-react/dist/esm/icons/rocket.js:
lucide-react/dist/esm/icons/rotate-ccw.js:
lucide-react/dist/esm/icons/settings.js:
lucide-react/dist/esm/icons/shield.js:
lucide-react/dist/esm/icons/sliders-horizontal.js:
lucide-react/dist/esm/icons/sparkles.js:
lucide-react/dist/esm/icons/square-check-big.js:
lucide-react/dist/esm/icons/square-pen.js:
lucide-react/dist/esm/icons/square.js:
lucide-react/dist/esm/icons/tag.js:
lucide-react/dist/esm/icons/target.js:
lucide-react/dist/esm/icons/trash-2.js:
lucide-react/dist/esm/icons/trash.js:
lucide-react/dist/esm/icons/trending-down.js:
lucide-react/dist/esm/icons/trending-up.js:
lucide-react/dist/esm/icons/triangle-alert.js:
lucide-react/dist/esm/icons/user.js:
lucide-react/dist/esm/icons/users.js:
lucide-react/dist/esm/icons/x.js:
lucide-react/dist/esm/icons/zap.js:
lucide-react/dist/esm/lucide-react.js:
  (**
   * @license lucide-react v0.544.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

react-is/cjs/react-is.production.min.js:
  (**
   * @license React
   * react-is.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

use-sync-external-store/cjs/use-sync-external-store-shim.production.js:
  (**
   * @license React
   * use-sync-external-store-shim.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.production.js:
  (**
   * @license React
   * use-sync-external-store-shim/with-selector.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

decimal.js-light/decimal.js:
  (*! decimal.js-light v2.5.1 https://github.com/MikeMcl/decimal.js-light/LICENCE *)

use-sync-external-store/cjs/use-sync-external-store-with-selector.production.js:
  (**
   * @license React
   * use-sync-external-store-with-selector.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

papaparse/papaparse.min.js:
  (* @license
  Papa Parse
  v5.5.3
  https://github.com/mholt/PapaParse
  License: MIT
  *)
*/
