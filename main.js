/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository
*/

var FG=Object.create;var Vf=Object.defineProperty;var jG=Object.getOwnPropertyDescriptor;var LG=Object.getOwnPropertyNames;var _G=Object.getPrototypeOf,zG=Object.prototype.hasOwnProperty;var $G=(e,t,r)=>t in e?Vf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var it=(e,t)=>()=>(e&&(t=e(e=0)),t);var le=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),xs=(e,t)=>{for(var r in t)Vf(e,r,{get:t[r],enumerable:!0})},_I=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of LG(t))!zG.call(e,i)&&i!==r&&Vf(e,i,{get:()=>t[i],enumerable:!(n=jG(t,i))||n.enumerable});return e};var $=(e,t,r)=>(r=e!=null?FG(_G(e)):{},_I(t||!e||!e.__esModule?Vf(r,"default",{value:e,enumerable:!0}):r,e)),mT=e=>_I(Vf({},"__esModule",{value:!0}),e);var zu=(e,t,r)=>$G(e,typeof t!="symbol"?t+"":t,r);var KI=le(ot=>{"use strict";var Hf=Symbol.for("react.element"),RG=Symbol.for("react.portal"),WG=Symbol.for("react.fragment"),BG=Symbol.for("react.strict_mode"),UG=Symbol.for("react.profiler"),VG=Symbol.for("react.provider"),HG=Symbol.for("react.context"),qG=Symbol.for("react.forward_ref"),GG=Symbol.for("react.suspense"),YG=Symbol.for("react.memo"),KG=Symbol.for("react.lazy"),zI=Symbol.iterator;function JG(e){return e===null||typeof e!="object"?null:(e=zI&&e[zI]||e["@@iterator"],typeof e=="function"?e:null)}var WI={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},BI=Object.assign,UI={};function $u(e,t,r){this.props=e,this.context=t,this.refs=UI,this.updater=r||WI}$u.prototype.isReactComponent={};$u.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};$u.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function VI(){}VI.prototype=$u.prototype;function gT(e,t,r){this.props=e,this.context=t,this.refs=UI,this.updater=r||WI}var hT=gT.prototype=new VI;hT.constructor=gT;BI(hT,$u.prototype);hT.isPureReactComponent=!0;var $I=Array.isArray,HI=Object.prototype.hasOwnProperty,vT={current:null},qI={key:!0,ref:!0,__self:!0,__source:!0};function GI(e,t,r){var n,i={},o=null,a=null;if(t!=null)for(n in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(o=""+t.key),t)HI.call(t,n)&&!qI.hasOwnProperty(n)&&(i[n]=t[n]);var s=arguments.length-2;if(s===1)i.children=r;else if(1<s){for(var l=Array(s),c=0;c<s;c++)l[c]=arguments[c+2];i.children=l}if(e&&e.defaultProps)for(n in s=e.defaultProps,s)i[n]===void 0&&(i[n]=s[n]);return{$$typeof:Hf,type:e,key:o,ref:a,props:i,_owner:vT.current}}function XG(e,t){return{$$typeof:Hf,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function yT(e){return typeof e=="object"&&e!==null&&e.$$typeof===Hf}function QG(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var RI=/\/+/g;function fT(e,t){return typeof e=="object"&&e!==null&&e.key!=null?QG(""+e.key):t.toString(36)}function fy(e,t,r,n,i){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Hf:case RG:a=!0}}if(a)return a=e,i=i(a),e=n===""?"."+fT(a,0):n,$I(i)?(r="",e!=null&&(r=e.replace(RI,"$&/")+"/"),fy(i,t,r,"",function(c){return c})):i!=null&&(yT(i)&&(i=XG(i,r+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(RI,"$&/")+"/")+e)),t.push(i)),1;if(a=0,n=n===""?".":n+":",$I(e))for(var s=0;s<e.length;s++){o=e[s];var l=n+fT(o,s);a+=fy(o,t,r,l,i)}else if(l=JG(e),typeof l=="function")for(e=l.call(e),s=0;!(o=e.next()).done;)o=o.value,l=n+fT(o,s++),a+=fy(o,t,r,l,i);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function my(e,t,r){if(e==null)return e;var n=[],i=0;return fy(e,n,"","",function(o){return t.call(r,o,i++)}),n}function ZG(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var xi={current:null},gy={transition:null},eY={ReactCurrentDispatcher:xi,ReactCurrentBatchConfig:gy,ReactCurrentOwner:vT};function YI(){throw Error("act(...) is not supported in production builds of React.")}ot.Children={map:my,forEach:function(e,t,r){my(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return my(e,function(){t++}),t},toArray:function(e){return my(e,function(t){return t})||[]},only:function(e){if(!yT(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ot.Component=$u;ot.Fragment=WG;ot.Profiler=UG;ot.PureComponent=gT;ot.StrictMode=BG;ot.Suspense=GG;ot.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eY;ot.act=YI;ot.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=BI({},e.props),i=e.key,o=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,a=vT.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(l in t)HI.call(t,l)&&!qI.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&s!==void 0?s[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){s=Array(l);for(var c=0;c<l;c++)s[c]=arguments[c+2];n.children=s}return{$$typeof:Hf,type:e.type,key:i,ref:o,props:n,_owner:a}};ot.createContext=function(e){return e={$$typeof:HG,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:VG,_context:e},e.Consumer=e};ot.createElement=GI;ot.createFactory=function(e){var t=GI.bind(null,e);return t.type=e,t};ot.createRef=function(){return{current:null}};ot.forwardRef=function(e){return{$$typeof:qG,render:e}};ot.isValidElement=yT;ot.lazy=function(e){return{$$typeof:KG,_payload:{_status:-1,_result:e},_init:ZG}};ot.memo=function(e,t){return{$$typeof:YG,type:e,compare:t===void 0?null:t}};ot.startTransition=function(e){var t=gy.transition;gy.transition={};try{e()}finally{gy.transition=t}};ot.unstable_act=YI;ot.useCallback=function(e,t){return xi.current.useCallback(e,t)};ot.useContext=function(e){return xi.current.useContext(e)};ot.useDebugValue=function(){};ot.useDeferredValue=function(e){return xi.current.useDeferredValue(e)};ot.useEffect=function(e,t){return xi.current.useEffect(e,t)};ot.useId=function(){return xi.current.useId()};ot.useImperativeHandle=function(e,t,r){return xi.current.useImperativeHandle(e,t,r)};ot.useInsertionEffect=function(e,t){return xi.current.useInsertionEffect(e,t)};ot.useLayoutEffect=function(e,t){return xi.current.useLayoutEffect(e,t)};ot.useMemo=function(e,t){return xi.current.useMemo(e,t)};ot.useReducer=function(e,t,r){return xi.current.useReducer(e,t,r)};ot.useRef=function(e){return xi.current.useRef(e)};ot.useState=function(e){return xi.current.useState(e)};ot.useSyncExternalStore=function(e,t,r){return xi.current.useSyncExternalStore(e,t,r)};ot.useTransition=function(){return xi.current.useTransition()};ot.version="18.3.1"});var W=le((bge,JI)=>{"use strict";JI.exports=KI()});var aF=le(Xt=>{"use strict";function kT(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,i=e[n];if(0<hy(i,t))e[n]=t,e[r]=i,r=n;else break e}}function La(e){return e.length===0?null:e[0]}function yy(e){if(e.length===0)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,i=e.length,o=i>>>1;n<o;){var a=2*(n+1)-1,s=e[a],l=a+1,c=e[l];if(0>hy(s,r))l<i&&0>hy(c,s)?(e[n]=c,e[l]=r,n=l):(e[n]=s,e[a]=r,n=a);else if(l<i&&0>hy(c,r))e[n]=c,e[l]=r,n=l;else break e}}return t}function hy(e,t){var r=e.sortIndex-t.sortIndex;return r!==0?r:e.id-t.id}typeof performance=="object"&&typeof performance.now=="function"?(XI=performance,Xt.unstable_now=function(){return XI.now()}):(bT=Date,QI=bT.now(),Xt.unstable_now=function(){return bT.now()-QI});var XI,bT,QI,ks=[],Yl=[],tY=1,Xo=null,Qn=3,by=!1,Zc=!1,Gf=!1,tF=typeof setTimeout=="function"?setTimeout:null,rF=typeof clearTimeout=="function"?clearTimeout:null,ZI=typeof setImmediate!="undefined"?setImmediate:null;typeof navigator!="undefined"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ST(e){for(var t=La(Yl);t!==null;){if(t.callback===null)yy(Yl);else if(t.startTime<=e)yy(Yl),t.sortIndex=t.expirationTime,kT(ks,t);else break;t=La(Yl)}}function TT(e){if(Gf=!1,ST(e),!Zc)if(La(ks)!==null)Zc=!0,ET(CT);else{var t=La(Yl);t!==null&&DT(TT,t.startTime-e)}}function CT(e,t){Zc=!1,Gf&&(Gf=!1,rF(Yf),Yf=-1),by=!0;var r=Qn;try{for(ST(t),Xo=La(ks);Xo!==null&&(!(Xo.expirationTime>t)||e&&!oF());){var n=Xo.callback;if(typeof n=="function"){Xo.callback=null,Qn=Xo.priorityLevel;var i=n(Xo.expirationTime<=t);t=Xt.unstable_now(),typeof i=="function"?Xo.callback=i:Xo===La(ks)&&yy(ks),ST(t)}else yy(ks);Xo=La(ks)}if(Xo!==null)var o=!0;else{var a=La(Yl);a!==null&&DT(TT,a.startTime-t),o=!1}return o}finally{Xo=null,Qn=r,by=!1}}var wy=!1,vy=null,Yf=-1,nF=5,iF=-1;function oF(){return!(Xt.unstable_now()-iF<nF)}function wT(){if(vy!==null){var e=Xt.unstable_now();iF=e;var t=!0;try{t=vy(!0,e)}finally{t?qf():(wy=!1,vy=null)}}else wy=!1}var qf;typeof ZI=="function"?qf=function(){ZI(wT)}:typeof MessageChannel!="undefined"?(xT=new MessageChannel,eF=xT.port2,xT.port1.onmessage=wT,qf=function(){eF.postMessage(null)}):qf=function(){tF(wT,0)};var xT,eF;function ET(e){vy=e,wy||(wy=!0,qf())}function DT(e,t){Yf=tF(function(){e(Xt.unstable_now())},t)}Xt.unstable_IdlePriority=5;Xt.unstable_ImmediatePriority=1;Xt.unstable_LowPriority=4;Xt.unstable_NormalPriority=3;Xt.unstable_Profiling=null;Xt.unstable_UserBlockingPriority=2;Xt.unstable_cancelCallback=function(e){e.callback=null};Xt.unstable_continueExecution=function(){Zc||by||(Zc=!0,ET(CT))};Xt.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):nF=0<e?Math.floor(1e3/e):5};Xt.unstable_getCurrentPriorityLevel=function(){return Qn};Xt.unstable_getFirstCallbackNode=function(){return La(ks)};Xt.unstable_next=function(e){switch(Qn){case 1:case 2:case 3:var t=3;break;default:t=Qn}var r=Qn;Qn=t;try{return e()}finally{Qn=r}};Xt.unstable_pauseExecution=function(){};Xt.unstable_requestPaint=function(){};Xt.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=Qn;Qn=e;try{return t()}finally{Qn=r}};Xt.unstable_scheduleCallback=function(e,t,r){var n=Xt.unstable_now();switch(typeof r=="object"&&r!==null?(r=r.delay,r=typeof r=="number"&&0<r?n+r:n):r=n,e){case 1:var i=-1;break;case 2:i=250;break;case 5:i=1073741823;break;case 4:i=1e4;break;default:i=5e3}return i=r+i,e={id:tY++,callback:t,priorityLevel:e,startTime:r,expirationTime:i,sortIndex:-1},r>n?(e.sortIndex=r,kT(Yl,e),La(ks)===null&&e===La(Yl)&&(Gf?(rF(Yf),Yf=-1):Gf=!0,DT(TT,r-n))):(e.sortIndex=i,kT(ks,e),Zc||by||(Zc=!0,ET(CT))),e};Xt.unstable_shouldYield=oF;Xt.unstable_wrapCallback=function(e){var t=Qn;return function(){var r=Qn;Qn=t;try{return e.apply(this,arguments)}finally{Qn=r}}}});var lF=le((xge,sF)=>{"use strict";sF.exports=aF()});var p2=le(Co=>{"use strict";var rY=W(),So=lF();function pe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var gj=new Set,hg={};function pd(e,t){ap(e,t),ap(e+"Capture",t)}function ap(e,t){for(hg[e]=t,e=0;e<t.length;e++)gj.add(t[e])}var al=!(typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"),JT=Object.prototype.hasOwnProperty,nY=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,cF={},dF={};function iY(e){return JT.call(dF,e)?!0:JT.call(cF,e)?!1:nY.test(e)?dF[e]=!0:(cF[e]=!0,!1)}function oY(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function aY(e,t,r,n){if(t===null||typeof t=="undefined"||oY(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ti(e,t,r,n,i,o,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=a}var Wn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Wn[e]=new Ti(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Wn[t]=new Ti(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Wn[e]=new Ti(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Wn[e]=new Ti(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Wn[e]=new Ti(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Wn[e]=new Ti(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Wn[e]=new Ti(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Wn[e]=new Ti(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Wn[e]=new Ti(e,5,!1,e.toLowerCase(),null,!1,!1)});var B1=/[\-:]([a-z])/g;function U1(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(B1,U1);Wn[t]=new Ti(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(B1,U1);Wn[t]=new Ti(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(B1,U1);Wn[t]=new Ti(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Wn[e]=new Ti(e,1,!1,e.toLowerCase(),null,!1,!1)});Wn.xlinkHref=new Ti("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Wn[e]=new Ti(e,1,!1,e.toLowerCase(),null,!0,!0)});function V1(e,t,r,n){var i=Wn.hasOwnProperty(t)?Wn[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(aY(t,r,i,n)&&(r=null),n||i===null?iY(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var dl=rY.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,xy=Symbol.for("react.element"),Bu=Symbol.for("react.portal"),Uu=Symbol.for("react.fragment"),H1=Symbol.for("react.strict_mode"),XT=Symbol.for("react.profiler"),hj=Symbol.for("react.provider"),vj=Symbol.for("react.context"),q1=Symbol.for("react.forward_ref"),QT=Symbol.for("react.suspense"),ZT=Symbol.for("react.suspense_list"),G1=Symbol.for("react.memo"),Jl=Symbol.for("react.lazy");Symbol.for("react.scope");Symbol.for("react.debug_trace_mode");var yj=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden");Symbol.for("react.cache");Symbol.for("react.tracing_marker");var uF=Symbol.iterator;function Kf(e){return e===null||typeof e!="object"?null:(e=uF&&e[uF]||e["@@iterator"],typeof e=="function"?e:null)}var Er=Object.assign,PT;function ng(e){if(PT===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);PT=t&&t[1]||""}return`
`+PT+e}var AT=!1;function NT(e,t){if(!e||AT)return"";AT=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),o=n.stack.split(`
`),a=i.length-1,s=o.length-1;1<=a&&0<=s&&i[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(i[a]!==o[s]){if(a!==1||s!==1)do if(a--,s--,0>s||i[a]!==o[s]){var l=`
`+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=a&&0<=s);break}}}finally{AT=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?ng(e):""}function sY(e){switch(e.tag){case 5:return ng(e.type);case 16:return ng("Lazy");case 13:return ng("Suspense");case 19:return ng("SuspenseList");case 0:case 2:case 15:return e=NT(e.type,!1),e;case 11:return e=NT(e.type.render,!1),e;case 1:return e=NT(e.type,!0),e;default:return""}}function e1(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Uu:return"Fragment";case Bu:return"Portal";case XT:return"Profiler";case H1:return"StrictMode";case QT:return"Suspense";case ZT:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case vj:return(e.displayName||"Context")+".Consumer";case hj:return(e._context.displayName||"Context")+".Provider";case q1:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case G1:return t=e.displayName||null,t!==null?t:e1(e.type)||"Memo";case Jl:t=e._payload,e=e._init;try{return e1(e(t))}catch(r){}}return null}function lY(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return e1(t);case 8:return t===H1?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function dc(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function bj(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function cY(e){var t=bj(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r!="undefined"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,o=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(a){n=""+a,o.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ky(e){e._valueTracker||(e._valueTracker=cY(e))}function wj(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=bj(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Jy(e){if(e=e||(typeof document!="undefined"?document:void 0),typeof e=="undefined")return null;try{return e.activeElement||e.body}catch(t){return e.body}}function t1(e,t){var r=t.checked;return Er({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r!=null?r:e._wrapperState.initialChecked})}function pF(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=dc(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function xj(e,t){t=t.checked,t!=null&&V1(e,"checked",t,!1)}function r1(e,t){xj(e,t);var r=dc(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?n1(e,t.type,r):t.hasOwnProperty("defaultValue")&&n1(e,t.type,dc(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function mF(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function n1(e,t,r){(t!=="number"||Jy(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var ig=Array.isArray;function ep(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+dc(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function i1(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(pe(91));return Er({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function fF(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(pe(92));if(ig(r)){if(1<r.length)throw Error(pe(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:dc(r)}}function kj(e,t){var r=dc(t.value),n=dc(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function gF(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Sj(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function o1(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Sj(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Sy,Tj=function(e){return typeof MSApp!="undefined"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Sy=Sy||document.createElement("div"),Sy.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Sy.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function vg(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var sg={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},dY=["Webkit","ms","Moz","O"];Object.keys(sg).forEach(function(e){dY.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),sg[t]=sg[e]})});function Cj(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||sg.hasOwnProperty(e)&&sg[e]?(""+t).trim():t+"px"}function Ej(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Cj(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var uY=Er({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function a1(e,t){if(t){if(uY[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(pe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(pe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(pe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(pe(62))}}function s1(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var l1=null;function Y1(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var c1=null,tp=null,rp=null;function hF(e){if(e=jg(e)){if(typeof c1!="function")throw Error(pe(280));var t=e.stateNode;t&&(t=Tb(t),c1(e.stateNode,e.type,t))}}function Dj(e){tp?rp?rp.push(e):rp=[e]:tp=e}function Pj(){if(tp){var e=tp,t=rp;if(rp=tp=null,hF(e),t)for(e=0;e<t.length;e++)hF(t[e])}}function Aj(e,t){return e(t)}function Nj(){}var MT=!1;function Mj(e,t,r){if(MT)return e(t,r);MT=!0;try{return Aj(e,t,r)}finally{MT=!1,(tp!==null||rp!==null)&&(Nj(),Pj())}}function yg(e,t){var r=e.stateNode;if(r===null)return null;var n=Tb(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(pe(231,t,typeof r));return r}var d1=!1;if(al)try{Ru={},Object.defineProperty(Ru,"passive",{get:function(){d1=!0}}),window.addEventListener("test",Ru,Ru),window.removeEventListener("test",Ru,Ru)}catch(e){d1=!1}var Ru;function pY(e,t,r,n,i,o,a,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(d){this.onError(d)}}var lg=!1,Xy=null,Qy=!1,u1=null,mY={onError:function(e){lg=!0,Xy=e}};function fY(e,t,r,n,i,o,a,s,l){lg=!1,Xy=null,pY.apply(mY,arguments)}function gY(e,t,r,n,i,o,a,s,l){if(fY.apply(this,arguments),lg){if(lg){var c=Xy;lg=!1,Xy=null}else throw Error(pe(198));Qy||(Qy=!0,u1=c)}}function md(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Oj(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function vF(e){if(md(e)!==e)throw Error(pe(188))}function hY(e){var t=e.alternate;if(!t){if(t=md(e),t===null)throw Error(pe(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var o=i.alternate;if(o===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===r)return vF(i),e;if(o===n)return vF(i),t;o=o.sibling}throw Error(pe(188))}if(r.return!==n.return)r=i,n=o;else{for(var a=!1,s=i.child;s;){if(s===r){a=!0,r=i,n=o;break}if(s===n){a=!0,n=i,r=o;break}s=s.sibling}if(!a){for(s=o.child;s;){if(s===r){a=!0,r=o,n=i;break}if(s===n){a=!0,n=o,r=i;break}s=s.sibling}if(!a)throw Error(pe(189))}}if(r.alternate!==n)throw Error(pe(190))}if(r.tag!==3)throw Error(pe(188));return r.stateNode.current===r?e:t}function Ij(e){return e=hY(e),e!==null?Fj(e):null}function Fj(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Fj(e);if(t!==null)return t;e=e.sibling}return null}var jj=So.unstable_scheduleCallback,yF=So.unstable_cancelCallback,vY=So.unstable_shouldYield,yY=So.unstable_requestPaint,Wr=So.unstable_now,bY=So.unstable_getCurrentPriorityLevel,K1=So.unstable_ImmediatePriority,Lj=So.unstable_UserBlockingPriority,Zy=So.unstable_NormalPriority,wY=So.unstable_LowPriority,_j=So.unstable_IdlePriority,wb=null,Es=null;function xY(e){if(Es&&typeof Es.onCommitFiberRoot=="function")try{Es.onCommitFiberRoot(wb,e,void 0,(e.current.flags&128)===128)}catch(t){}}var Wa=Math.clz32?Math.clz32:TY,kY=Math.log,SY=Math.LN2;function TY(e){return e>>>=0,e===0?32:31-(kY(e)/SY|0)|0}var Ty=64,Cy=4194304;function og(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function eb(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,o=e.pingedLanes,a=r&268435455;if(a!==0){var s=a&~i;s!==0?n=og(s):(o&=a,o!==0&&(n=og(o)))}else a=r&~i,a!==0?n=og(a):o!==0&&(n=og(o));if(n===0)return 0;if(t!==0&&t!==n&&(t&i)===0&&(i=n&-n,o=t&-t,i>=o||i===16&&(o&4194240)!==0))return t;if((n&4)!==0&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Wa(t),i=1<<r,n|=e[r],t&=~i;return n}function CY(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function EY(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var a=31-Wa(o),s=1<<a,l=i[a];l===-1?((s&r)===0||(s&n)!==0)&&(i[a]=CY(s,t)):l<=t&&(e.expiredLanes|=s),o&=~s}}function p1(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function zj(){var e=Ty;return Ty<<=1,(Ty&4194240)===0&&(Ty=64),e}function OT(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Ig(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Wa(t),e[t]=r}function DY(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-Wa(r),o=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~o}}function J1(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Wa(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var Ot=0;function $j(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var Rj,X1,Wj,Bj,Uj,m1=!1,Ey=[],rc=null,nc=null,ic=null,bg=new Map,wg=new Map,Ql=[],PY="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function bF(e,t){switch(e){case"focusin":case"focusout":rc=null;break;case"dragenter":case"dragleave":nc=null;break;case"mouseover":case"mouseout":ic=null;break;case"pointerover":case"pointerout":bg.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":wg.delete(t.pointerId)}}function Jf(e,t,r,n,i,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:o,targetContainers:[i]},t!==null&&(t=jg(t),t!==null&&X1(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function AY(e,t,r,n,i){switch(t){case"focusin":return rc=Jf(rc,e,t,r,n,i),!0;case"dragenter":return nc=Jf(nc,e,t,r,n,i),!0;case"mouseover":return ic=Jf(ic,e,t,r,n,i),!0;case"pointerover":var o=i.pointerId;return bg.set(o,Jf(bg.get(o)||null,e,t,r,n,i)),!0;case"gotpointercapture":return o=i.pointerId,wg.set(o,Jf(wg.get(o)||null,e,t,r,n,i)),!0}return!1}function Vj(e){var t=rd(e.target);if(t!==null){var r=md(t);if(r!==null){if(t=r.tag,t===13){if(t=Oj(r),t!==null){e.blockedOn=t,Uj(e.priority,function(){Wj(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ry(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=f1(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);l1=n,r.target.dispatchEvent(n),l1=null}else return t=jg(r),t!==null&&X1(t),e.blockedOn=r,!1;t.shift()}return!0}function wF(e,t,r){Ry(e)&&r.delete(t)}function NY(){m1=!1,rc!==null&&Ry(rc)&&(rc=null),nc!==null&&Ry(nc)&&(nc=null),ic!==null&&Ry(ic)&&(ic=null),bg.forEach(wF),wg.forEach(wF)}function Xf(e,t){e.blockedOn===t&&(e.blockedOn=null,m1||(m1=!0,So.unstable_scheduleCallback(So.unstable_NormalPriority,NY)))}function xg(e){function t(i){return Xf(i,e)}if(0<Ey.length){Xf(Ey[0],e);for(var r=1;r<Ey.length;r++){var n=Ey[r];n.blockedOn===e&&(n.blockedOn=null)}}for(rc!==null&&Xf(rc,e),nc!==null&&Xf(nc,e),ic!==null&&Xf(ic,e),bg.forEach(t),wg.forEach(t),r=0;r<Ql.length;r++)n=Ql[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Ql.length&&(r=Ql[0],r.blockedOn===null);)Vj(r),r.blockedOn===null&&Ql.shift()}var np=dl.ReactCurrentBatchConfig,tb=!0;function MY(e,t,r,n){var i=Ot,o=np.transition;np.transition=null;try{Ot=1,Q1(e,t,r,n)}finally{Ot=i,np.transition=o}}function OY(e,t,r,n){var i=Ot,o=np.transition;np.transition=null;try{Ot=4,Q1(e,t,r,n)}finally{Ot=i,np.transition=o}}function Q1(e,t,r,n){if(tb){var i=f1(e,t,r,n);if(i===null)$T(e,t,n,rb,r),bF(e,n);else if(AY(i,e,t,r,n))n.stopPropagation();else if(bF(e,n),t&4&&-1<PY.indexOf(e)){for(;i!==null;){var o=jg(i);if(o!==null&&Rj(o),o=f1(e,t,r,n),o===null&&$T(e,t,n,rb,r),o===i)break;i=o}i!==null&&n.stopPropagation()}else $T(e,t,n,null,r)}}var rb=null;function f1(e,t,r,n){if(rb=null,e=Y1(n),e=rd(e),e!==null)if(t=md(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Oj(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return rb=e,null}function Hj(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(bY()){case K1:return 1;case Lj:return 4;case Zy:case wY:return 16;case _j:return 536870912;default:return 16}default:return 16}}var ec=null,Z1=null,Wy=null;function qj(){if(Wy)return Wy;var e,t=Z1,r=t.length,n,i="value"in ec?ec.value:ec.textContent,o=i.length;for(e=0;e<r&&t[e]===i[e];e++);var a=r-e;for(n=1;n<=a&&t[r-n]===i[o-n];n++);return Wy=i.slice(e,1<n?1-n:void 0)}function By(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Dy(){return!0}function xF(){return!1}function To(e){function t(r,n,i,o,a){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=o,this.target=a,this.currentTarget=null;for(var s in e)e.hasOwnProperty(s)&&(r=e[s],this[s]=r?r(o):o[s]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Dy:xF,this.isPropagationStopped=xF,this}return Er(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Dy)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Dy)},persist:function(){},isPersistent:Dy}),t}var mp={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},eC=To(mp),Fg=Er({},mp,{view:0,detail:0}),IY=To(Fg),IT,FT,Qf,xb=Er({},Fg,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:tC,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Qf&&(Qf&&e.type==="mousemove"?(IT=e.screenX-Qf.screenX,FT=e.screenY-Qf.screenY):FT=IT=0,Qf=e),IT)},movementY:function(e){return"movementY"in e?e.movementY:FT}}),kF=To(xb),FY=Er({},xb,{dataTransfer:0}),jY=To(FY),LY=Er({},Fg,{relatedTarget:0}),jT=To(LY),_Y=Er({},mp,{animationName:0,elapsedTime:0,pseudoElement:0}),zY=To(_Y),$Y=Er({},mp,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),RY=To($Y),WY=Er({},mp,{data:0}),SF=To(WY),BY={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},UY={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},VY={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function HY(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=VY[e])?!!t[e]:!1}function tC(){return HY}var qY=Er({},Fg,{key:function(e){if(e.key){var t=BY[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=By(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?UY[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:tC,charCode:function(e){return e.type==="keypress"?By(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?By(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),GY=To(qY),YY=Er({},xb,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),TF=To(YY),KY=Er({},Fg,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:tC}),JY=To(KY),XY=Er({},mp,{propertyName:0,elapsedTime:0,pseudoElement:0}),QY=To(XY),ZY=Er({},xb,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),e9=To(ZY),t9=[9,13,27,32],rC=al&&"CompositionEvent"in window,cg=null;al&&"documentMode"in document&&(cg=document.documentMode);var r9=al&&"TextEvent"in window&&!cg,Gj=al&&(!rC||cg&&8<cg&&11>=cg),CF=" ",EF=!1;function Yj(e,t){switch(e){case"keyup":return t9.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Kj(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Vu=!1;function n9(e,t){switch(e){case"compositionend":return Kj(t);case"keypress":return t.which!==32?null:(EF=!0,CF);case"textInput":return e=t.data,e===CF&&EF?null:e;default:return null}}function i9(e,t){if(Vu)return e==="compositionend"||!rC&&Yj(e,t)?(e=qj(),Wy=Z1=ec=null,Vu=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Gj&&t.locale!=="ko"?null:t.data;default:return null}}var o9={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function DF(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!o9[e.type]:t==="textarea"}function Jj(e,t,r,n){Dj(n),t=nb(t,"onChange"),0<t.length&&(r=new eC("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var dg=null,kg=null;function a9(e){sL(e,0)}function kb(e){var t=Gu(e);if(wj(t))return e}function s9(e,t){if(e==="change")return t}var Xj=!1;al&&(al?(Ay="oninput"in document,Ay||(LT=document.createElement("div"),LT.setAttribute("oninput","return;"),Ay=typeof LT.oninput=="function"),Py=Ay):Py=!1,Xj=Py&&(!document.documentMode||9<document.documentMode));var Py,Ay,LT;function PF(){dg&&(dg.detachEvent("onpropertychange",Qj),kg=dg=null)}function Qj(e){if(e.propertyName==="value"&&kb(kg)){var t=[];Jj(t,kg,e,Y1(e)),Mj(a9,t)}}function l9(e,t,r){e==="focusin"?(PF(),dg=t,kg=r,dg.attachEvent("onpropertychange",Qj)):e==="focusout"&&PF()}function c9(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return kb(kg)}function d9(e,t){if(e==="click")return kb(t)}function u9(e,t){if(e==="input"||e==="change")return kb(t)}function p9(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ua=typeof Object.is=="function"?Object.is:p9;function Sg(e,t){if(Ua(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!JT.call(t,i)||!Ua(e[i],t[i]))return!1}return!0}function AF(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function NF(e,t){var r=AF(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=AF(r)}}function Zj(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Zj(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function eL(){for(var e=window,t=Jy();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch(n){r=!1}if(r)e=t.contentWindow;else break;t=Jy(e.document)}return t}function nC(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function m9(e){var t=eL(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Zj(r.ownerDocument.documentElement,r)){if(n!==null&&nC(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,o=Math.min(n.start,i);n=n.end===void 0?o:Math.min(n.end,i),!e.extend&&o>n&&(i=n,n=o,o=i),i=NF(r,o);var a=NF(r,n);i&&a&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),o>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var f9=al&&"documentMode"in document&&11>=document.documentMode,Hu=null,g1=null,ug=null,h1=!1;function MF(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;h1||Hu==null||Hu!==Jy(n)||(n=Hu,"selectionStart"in n&&nC(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),ug&&Sg(ug,n)||(ug=n,n=nb(g1,"onSelect"),0<n.length&&(t=new eC("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Hu)))}function Ny(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var qu={animationend:Ny("Animation","AnimationEnd"),animationiteration:Ny("Animation","AnimationIteration"),animationstart:Ny("Animation","AnimationStart"),transitionend:Ny("Transition","TransitionEnd")},_T={},tL={};al&&(tL=document.createElement("div").style,"AnimationEvent"in window||(delete qu.animationend.animation,delete qu.animationiteration.animation,delete qu.animationstart.animation),"TransitionEvent"in window||delete qu.transitionend.transition);function Sb(e){if(_T[e])return _T[e];if(!qu[e])return e;var t=qu[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in tL)return _T[e]=t[r];return e}var rL=Sb("animationend"),nL=Sb("animationiteration"),iL=Sb("animationstart"),oL=Sb("transitionend"),aL=new Map,OF="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function pc(e,t){aL.set(e,t),pd(t,[e])}for(My=0;My<OF.length;My++)Oy=OF[My],IF=Oy.toLowerCase(),FF=Oy[0].toUpperCase()+Oy.slice(1),pc(IF,"on"+FF);var Oy,IF,FF,My;pc(rL,"onAnimationEnd");pc(nL,"onAnimationIteration");pc(iL,"onAnimationStart");pc("dblclick","onDoubleClick");pc("focusin","onFocus");pc("focusout","onBlur");pc(oL,"onTransitionEnd");ap("onMouseEnter",["mouseout","mouseover"]);ap("onMouseLeave",["mouseout","mouseover"]);ap("onPointerEnter",["pointerout","pointerover"]);ap("onPointerLeave",["pointerout","pointerover"]);pd("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));pd("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));pd("onBeforeInput",["compositionend","keypress","textInput","paste"]);pd("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));pd("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));pd("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ag="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),g9=new Set("cancel close invalid load scroll toggle".split(" ").concat(ag));function jF(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,gY(n,t,void 0,e),e.currentTarget=null}function sL(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var o=void 0;if(t)for(var a=n.length-1;0<=a;a--){var s=n[a],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==o&&i.isPropagationStopped())break e;jF(i,s,c),o=l}else for(a=0;a<n.length;a++){if(s=n[a],l=s.instance,c=s.currentTarget,s=s.listener,l!==o&&i.isPropagationStopped())break e;jF(i,s,c),o=l}}}if(Qy)throw e=u1,Qy=!1,u1=null,e}function ir(e,t){var r=t[x1];r===void 0&&(r=t[x1]=new Set);var n=e+"__bubble";r.has(n)||(lL(t,e,2,!1),r.add(n))}function zT(e,t,r){var n=0;t&&(n|=4),lL(r,e,n,t)}var Iy="_reactListening"+Math.random().toString(36).slice(2);function Tg(e){if(!e[Iy]){e[Iy]=!0,gj.forEach(function(r){r!=="selectionchange"&&(g9.has(r)||zT(r,!1,e),zT(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Iy]||(t[Iy]=!0,zT("selectionchange",!1,t))}}function lL(e,t,r,n){switch(Hj(t)){case 1:var i=MY;break;case 4:i=OY;break;default:i=Q1}r=i.bind(null,t,r,e),i=void 0,!d1||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function $T(e,t,r,n,i){var o=n;if((t&1)===0&&(t&2)===0&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var s=n.stateNode.containerInfo;if(s===i||s.nodeType===8&&s.parentNode===i)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;s!==null;){if(a=rd(s),a===null)return;if(l=a.tag,l===5||l===6){n=o=a;continue e}s=s.parentNode}}n=n.return}Mj(function(){var c=o,d=Y1(r),u=[];e:{var p=aL.get(e);if(p!==void 0){var m=eC,g=e;switch(e){case"keypress":if(By(r)===0)break e;case"keydown":case"keyup":m=GY;break;case"focusin":g="focus",m=jT;break;case"focusout":g="blur",m=jT;break;case"beforeblur":case"afterblur":m=jT;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=kF;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=jY;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=JY;break;case rL:case nL:case iL:m=zY;break;case oL:m=QY;break;case"scroll":m=IY;break;case"wheel":m=e9;break;case"copy":case"cut":case"paste":m=RY;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=TF}var f=(t&4)!==0,y=!f&&e==="scroll",h=f?p!==null?p+"Capture":null:p;f=[];for(var v=c,b;v!==null;){b=v;var w=b.stateNode;if(b.tag===5&&w!==null&&(b=w,h!==null&&(w=yg(v,h),w!=null&&f.push(Cg(v,w,b)))),y)break;v=v.return}0<f.length&&(p=new m(p,g,null,r,d),u.push({event:p,listeners:f}))}}if((t&7)===0){e:{if(p=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",p&&r!==l1&&(g=r.relatedTarget||r.fromElement)&&(rd(g)||g[sl]))break e;if((m||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,m?(g=r.relatedTarget||r.toElement,m=c,g=g?rd(g):null,g!==null&&(y=md(g),g!==y||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=c),m!==g)){if(f=kF,w="onMouseLeave",h="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(f=TF,w="onPointerLeave",h="onPointerEnter",v="pointer"),y=m==null?p:Gu(m),b=g==null?p:Gu(g),p=new f(w,v+"leave",m,r,d),p.target=y,p.relatedTarget=b,w=null,rd(d)===c&&(f=new f(h,v+"enter",g,r,d),f.target=b,f.relatedTarget=y,w=f),y=w,m&&g)t:{for(f=m,h=g,v=0,b=f;b;b=Wu(b))v++;for(b=0,w=h;w;w=Wu(w))b++;for(;0<v-b;)f=Wu(f),v--;for(;0<b-v;)h=Wu(h),b--;for(;v--;){if(f===h||h!==null&&f===h.alternate)break t;f=Wu(f),h=Wu(h)}f=null}else f=null;m!==null&&LF(u,p,m,f,!1),g!==null&&y!==null&&LF(u,y,g,f,!0)}}e:{if(p=c?Gu(c):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var k=s9;else if(DF(p))if(Xj)k=u9;else{k=c9;var S=l9}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(k=d9);if(k&&(k=k(e,c))){Jj(u,k,r,d);break e}S&&S(e,p,c),e==="focusout"&&(S=p._wrapperState)&&S.controlled&&p.type==="number"&&n1(p,"number",p.value)}switch(S=c?Gu(c):window,e){case"focusin":(DF(S)||S.contentEditable==="true")&&(Hu=S,g1=c,ug=null);break;case"focusout":ug=g1=Hu=null;break;case"mousedown":h1=!0;break;case"contextmenu":case"mouseup":case"dragend":h1=!1,MF(u,r,d);break;case"selectionchange":if(f9)break;case"keydown":case"keyup":MF(u,r,d)}var x;if(rC)e:{switch(e){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Vu?Yj(e,r)&&(T="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(T="onCompositionStart");T&&(Gj&&r.locale!=="ko"&&(Vu||T!=="onCompositionStart"?T==="onCompositionEnd"&&Vu&&(x=qj()):(ec=d,Z1="value"in ec?ec.value:ec.textContent,Vu=!0)),S=nb(c,T),0<S.length&&(T=new SF(T,e,null,r,d),u.push({event:T,listeners:S}),x?T.data=x:(x=Kj(r),x!==null&&(T.data=x)))),(x=r9?n9(e,r):i9(e,r))&&(c=nb(c,"onBeforeInput"),0<c.length&&(d=new SF("onBeforeInput","beforeinput",null,r,d),u.push({event:d,listeners:c}),d.data=x))}sL(u,t)})}function Cg(e,t,r){return{instance:e,listener:t,currentTarget:r}}function nb(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=yg(e,r),o!=null&&n.unshift(Cg(e,o,i)),o=yg(e,t),o!=null&&n.push(Cg(e,o,i))),e=e.return}return n}function Wu(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function LF(e,t,r,n,i){for(var o=t._reactName,a=[];r!==null&&r!==n;){var s=r,l=s.alternate,c=s.stateNode;if(l!==null&&l===n)break;s.tag===5&&c!==null&&(s=c,i?(l=yg(r,o),l!=null&&a.unshift(Cg(r,l,s))):i||(l=yg(r,o),l!=null&&a.push(Cg(r,l,s)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var h9=/\r\n?/g,v9=/\u0000|\uFFFD/g;function _F(e){return(typeof e=="string"?e:""+e).replace(h9,`
`).replace(v9,"")}function Fy(e,t,r){if(t=_F(t),_F(e)!==t&&r)throw Error(pe(425))}function ib(){}var v1=null,y1=null;function b1(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var w1=typeof setTimeout=="function"?setTimeout:void 0,y9=typeof clearTimeout=="function"?clearTimeout:void 0,zF=typeof Promise=="function"?Promise:void 0,b9=typeof queueMicrotask=="function"?queueMicrotask:typeof zF!="undefined"?function(e){return zF.resolve(null).then(e).catch(w9)}:w1;function w9(e){setTimeout(function(){throw e})}function RT(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),xg(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);xg(t)}function oc(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function $F(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var fp=Math.random().toString(36).slice(2),Cs="__reactFiber$"+fp,Eg="__reactProps$"+fp,sl="__reactContainer$"+fp,x1="__reactEvents$"+fp,x9="__reactListeners$"+fp,k9="__reactHandles$"+fp;function rd(e){var t=e[Cs];if(t)return t;for(var r=e.parentNode;r;){if(t=r[sl]||r[Cs]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=$F(e);e!==null;){if(r=e[Cs])return r;e=$F(e)}return t}e=r,r=e.parentNode}return null}function jg(e){return e=e[Cs]||e[sl],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Gu(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(pe(33))}function Tb(e){return e[Eg]||null}var k1=[],Yu=-1;function mc(e){return{current:e}}function or(e){0>Yu||(e.current=k1[Yu],k1[Yu]=null,Yu--)}function Qt(e,t){Yu++,k1[Yu]=e.current,e.current=t}var uc={},ri=mc(uc),Vi=mc(!1),sd=uc;function sp(e,t){var r=e.type.contextTypes;if(!r)return uc;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in r)i[o]=t[o];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Hi(e){return e=e.childContextTypes,e!=null}function ob(){or(Vi),or(ri)}function RF(e,t,r){if(ri.current!==uc)throw Error(pe(168));Qt(ri,t),Qt(Vi,r)}function cL(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(pe(108,lY(e)||"Unknown",i));return Er({},r,n)}function ab(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||uc,sd=ri.current,Qt(ri,e),Qt(Vi,Vi.current),!0}function WF(e,t,r){var n=e.stateNode;if(!n)throw Error(pe(169));r?(e=cL(e,t,sd),n.__reactInternalMemoizedMergedChildContext=e,or(Vi),or(ri),Qt(ri,e)):or(Vi),Qt(Vi,r)}var rl=null,Cb=!1,WT=!1;function dL(e){rl===null?rl=[e]:rl.push(e)}function S9(e){Cb=!0,dL(e)}function fc(){if(!WT&&rl!==null){WT=!0;var e=0,t=Ot;try{var r=rl;for(Ot=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}rl=null,Cb=!1}catch(i){throw rl!==null&&(rl=rl.slice(e+1)),jj(K1,fc),i}finally{Ot=t,WT=!1}}return null}var Ku=[],Ju=0,sb=null,lb=0,Qo=[],Zo=0,ld=null,nl=1,il="";function ed(e,t){Ku[Ju++]=lb,Ku[Ju++]=sb,sb=e,lb=t}function uL(e,t,r){Qo[Zo++]=nl,Qo[Zo++]=il,Qo[Zo++]=ld,ld=e;var n=nl;e=il;var i=32-Wa(n)-1;n&=~(1<<i),r+=1;var o=32-Wa(t)+i;if(30<o){var a=i-i%5;o=(n&(1<<a)-1).toString(32),n>>=a,i-=a,nl=1<<32-Wa(t)+i|r<<i|n,il=o+e}else nl=1<<o|r<<i|n,il=e}function iC(e){e.return!==null&&(ed(e,1),uL(e,1,0))}function oC(e){for(;e===sb;)sb=Ku[--Ju],Ku[Ju]=null,lb=Ku[--Ju],Ku[Ju]=null;for(;e===ld;)ld=Qo[--Zo],Qo[Zo]=null,il=Qo[--Zo],Qo[Zo]=null,nl=Qo[--Zo],Qo[Zo]=null}var ko=null,xo=null,pr=!1,Ra=null;function pL(e,t){var r=ea(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function BF(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ko=e,xo=oc(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ko=e,xo=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=ld!==null?{id:nl,overflow:il}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=ea(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,ko=e,xo=null,!0):!1;default:return!1}}function S1(e){return(e.mode&1)!==0&&(e.flags&128)===0}function T1(e){if(pr){var t=xo;if(t){var r=t;if(!BF(e,t)){if(S1(e))throw Error(pe(418));t=oc(r.nextSibling);var n=ko;t&&BF(e,t)?pL(n,r):(e.flags=e.flags&-4097|2,pr=!1,ko=e)}}else{if(S1(e))throw Error(pe(418));e.flags=e.flags&-4097|2,pr=!1,ko=e}}}function UF(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ko=e}function jy(e){if(e!==ko)return!1;if(!pr)return UF(e),pr=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!b1(e.type,e.memoizedProps)),t&&(t=xo)){if(S1(e))throw mL(),Error(pe(418));for(;t;)pL(e,t),t=oc(t.nextSibling)}if(UF(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(pe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){xo=oc(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}xo=null}}else xo=ko?oc(e.stateNode.nextSibling):null;return!0}function mL(){for(var e=xo;e;)e=oc(e.nextSibling)}function lp(){xo=ko=null,pr=!1}function aC(e){Ra===null?Ra=[e]:Ra.push(e)}var T9=dl.ReactCurrentBatchConfig;function Zf(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(pe(309));var n=r.stateNode}if(!n)throw Error(pe(147,e));var i=n,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(a){var s=i.refs;a===null?delete s[o]:s[o]=a},t._stringRef=o,t)}if(typeof e!="string")throw Error(pe(284));if(!r._owner)throw Error(pe(290,e))}return e}function Ly(e,t){throw e=Object.prototype.toString.call(t),Error(pe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function VF(e){var t=e._init;return t(e._payload)}function fL(e){function t(h,v){if(e){var b=h.deletions;b===null?(h.deletions=[v],h.flags|=16):b.push(v)}}function r(h,v){if(!e)return null;for(;v!==null;)t(h,v),v=v.sibling;return null}function n(h,v){for(h=new Map;v!==null;)v.key!==null?h.set(v.key,v):h.set(v.index,v),v=v.sibling;return h}function i(h,v){return h=cc(h,v),h.index=0,h.sibling=null,h}function o(h,v,b){return h.index=b,e?(b=h.alternate,b!==null?(b=b.index,b<v?(h.flags|=2,v):b):(h.flags|=2,v)):(h.flags|=1048576,v)}function a(h){return e&&h.alternate===null&&(h.flags|=2),h}function s(h,v,b,w){return v===null||v.tag!==6?(v=YT(b,h.mode,w),v.return=h,v):(v=i(v,b),v.return=h,v)}function l(h,v,b,w){var k=b.type;return k===Uu?d(h,v,b.props.children,w,b.key):v!==null&&(v.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Jl&&VF(k)===v.type)?(w=i(v,b.props),w.ref=Zf(h,v,b),w.return=h,w):(w=Ky(b.type,b.key,b.props,null,h.mode,w),w.ref=Zf(h,v,b),w.return=h,w)}function c(h,v,b,w){return v===null||v.tag!==4||v.stateNode.containerInfo!==b.containerInfo||v.stateNode.implementation!==b.implementation?(v=KT(b,h.mode,w),v.return=h,v):(v=i(v,b.children||[]),v.return=h,v)}function d(h,v,b,w,k){return v===null||v.tag!==7?(v=ad(b,h.mode,w,k),v.return=h,v):(v=i(v,b),v.return=h,v)}function u(h,v,b){if(typeof v=="string"&&v!==""||typeof v=="number")return v=YT(""+v,h.mode,b),v.return=h,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case xy:return b=Ky(v.type,v.key,v.props,null,h.mode,b),b.ref=Zf(h,null,v),b.return=h,b;case Bu:return v=KT(v,h.mode,b),v.return=h,v;case Jl:var w=v._init;return u(h,w(v._payload),b)}if(ig(v)||Kf(v))return v=ad(v,h.mode,b,null),v.return=h,v;Ly(h,v)}return null}function p(h,v,b,w){var k=v!==null?v.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return k!==null?null:s(h,v,""+b,w);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case xy:return b.key===k?l(h,v,b,w):null;case Bu:return b.key===k?c(h,v,b,w):null;case Jl:return k=b._init,p(h,v,k(b._payload),w)}if(ig(b)||Kf(b))return k!==null?null:d(h,v,b,w,null);Ly(h,b)}return null}function m(h,v,b,w,k){if(typeof w=="string"&&w!==""||typeof w=="number")return h=h.get(b)||null,s(v,h,""+w,k);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case xy:return h=h.get(w.key===null?b:w.key)||null,l(v,h,w,k);case Bu:return h=h.get(w.key===null?b:w.key)||null,c(v,h,w,k);case Jl:var S=w._init;return m(h,v,b,S(w._payload),k)}if(ig(w)||Kf(w))return h=h.get(b)||null,d(v,h,w,k,null);Ly(v,w)}return null}function g(h,v,b,w){for(var k=null,S=null,x=v,T=v=0,E=null;x!==null&&T<b.length;T++){x.index>T?(E=x,x=null):E=x.sibling;var C=p(h,x,b[T],w);if(C===null){x===null&&(x=E);break}e&&x&&C.alternate===null&&t(h,x),v=o(C,v,T),S===null?k=C:S.sibling=C,S=C,x=E}if(T===b.length)return r(h,x),pr&&ed(h,T),k;if(x===null){for(;T<b.length;T++)x=u(h,b[T],w),x!==null&&(v=o(x,v,T),S===null?k=x:S.sibling=x,S=x);return pr&&ed(h,T),k}for(x=n(h,x);T<b.length;T++)E=m(x,h,T,b[T],w),E!==null&&(e&&E.alternate!==null&&x.delete(E.key===null?T:E.key),v=o(E,v,T),S===null?k=E:S.sibling=E,S=E);return e&&x.forEach(function(N){return t(h,N)}),pr&&ed(h,T),k}function f(h,v,b,w){var k=Kf(b);if(typeof k!="function")throw Error(pe(150));if(b=k.call(b),b==null)throw Error(pe(151));for(var S=k=null,x=v,T=v=0,E=null,C=b.next();x!==null&&!C.done;T++,C=b.next()){x.index>T?(E=x,x=null):E=x.sibling;var N=p(h,x,C.value,w);if(N===null){x===null&&(x=E);break}e&&x&&N.alternate===null&&t(h,x),v=o(N,v,T),S===null?k=N:S.sibling=N,S=N,x=E}if(C.done)return r(h,x),pr&&ed(h,T),k;if(x===null){for(;!C.done;T++,C=b.next())C=u(h,C.value,w),C!==null&&(v=o(C,v,T),S===null?k=C:S.sibling=C,S=C);return pr&&ed(h,T),k}for(x=n(h,x);!C.done;T++,C=b.next())C=m(x,h,T,C.value,w),C!==null&&(e&&C.alternate!==null&&x.delete(C.key===null?T:C.key),v=o(C,v,T),S===null?k=C:S.sibling=C,S=C);return e&&x.forEach(function(D){return t(h,D)}),pr&&ed(h,T),k}function y(h,v,b,w){if(typeof b=="object"&&b!==null&&b.type===Uu&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case xy:e:{for(var k=b.key,S=v;S!==null;){if(S.key===k){if(k=b.type,k===Uu){if(S.tag===7){r(h,S.sibling),v=i(S,b.props.children),v.return=h,h=v;break e}}else if(S.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Jl&&VF(k)===S.type){r(h,S.sibling),v=i(S,b.props),v.ref=Zf(h,S,b),v.return=h,h=v;break e}r(h,S);break}else t(h,S);S=S.sibling}b.type===Uu?(v=ad(b.props.children,h.mode,w,b.key),v.return=h,h=v):(w=Ky(b.type,b.key,b.props,null,h.mode,w),w.ref=Zf(h,v,b),w.return=h,h=w)}return a(h);case Bu:e:{for(S=b.key;v!==null;){if(v.key===S)if(v.tag===4&&v.stateNode.containerInfo===b.containerInfo&&v.stateNode.implementation===b.implementation){r(h,v.sibling),v=i(v,b.children||[]),v.return=h,h=v;break e}else{r(h,v);break}else t(h,v);v=v.sibling}v=KT(b,h.mode,w),v.return=h,h=v}return a(h);case Jl:return S=b._init,y(h,v,S(b._payload),w)}if(ig(b))return g(h,v,b,w);if(Kf(b))return f(h,v,b,w);Ly(h,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,v!==null&&v.tag===6?(r(h,v.sibling),v=i(v,b),v.return=h,h=v):(r(h,v),v=YT(b,h.mode,w),v.return=h,h=v),a(h)):r(h,v)}return y}var cp=fL(!0),gL=fL(!1),cb=mc(null),db=null,Xu=null,sC=null;function lC(){sC=Xu=db=null}function cC(e){var t=cb.current;or(cb),e._currentValue=t}function C1(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function ip(e,t){db=e,sC=Xu=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(Ui=!0),e.firstContext=null)}function ra(e){var t=e._currentValue;if(sC!==e)if(e={context:e,memoizedValue:t,next:null},Xu===null){if(db===null)throw Error(pe(308));Xu=e,db.dependencies={lanes:0,firstContext:e}}else Xu=Xu.next=e;return t}var nd=null;function dC(e){nd===null?nd=[e]:nd.push(e)}function hL(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,dC(t)):(r.next=i.next,i.next=r),t.interleaved=r,ll(e,n)}function ll(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Xl=!1;function uC(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function vL(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ol(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ac(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,(vt&2)!==0){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,ll(e,r)}return i=n.interleaved,i===null?(t.next=t,dC(n)):(t.next=i.next,i.next=t),n.interleaved=t,ll(e,r)}function Uy(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,J1(e,r)}}function HF(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,o=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};o===null?i=o=a:o=o.next=a,r=r.next}while(r!==null);o===null?i=o=t:o=o.next=t}else i=o=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function ub(e,t,r,n){var i=e.updateQueue;Xl=!1;var o=i.firstBaseUpdate,a=i.lastBaseUpdate,s=i.shared.pending;if(s!==null){i.shared.pending=null;var l=s,c=l.next;l.next=null,a===null?o=c:a.next=c,a=l;var d=e.alternate;d!==null&&(d=d.updateQueue,s=d.lastBaseUpdate,s!==a&&(s===null?d.firstBaseUpdate=c:s.next=c,d.lastBaseUpdate=l))}if(o!==null){var u=i.baseState;a=0,d=c=l=null,s=o;do{var p=s.lane,m=s.eventTime;if((n&p)===p){d!==null&&(d=d.next={eventTime:m,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var g=e,f=s;switch(p=t,m=r,f.tag){case 1:if(g=f.payload,typeof g=="function"){u=g.call(m,u,p);break e}u=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=f.payload,p=typeof g=="function"?g.call(m,u,p):g,p==null)break e;u=Er({},u,p);break e;case 2:Xl=!0}}s.callback!==null&&s.lane!==0&&(e.flags|=64,p=i.effects,p===null?i.effects=[s]:p.push(s))}else m={eventTime:m,lane:p,tag:s.tag,payload:s.payload,callback:s.callback,next:null},d===null?(c=d=m,l=u):d=d.next=m,a|=p;if(s=s.next,s===null){if(s=i.shared.pending,s===null)break;p=s,s=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(d===null&&(l=u),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do a|=i.lane,i=i.next;while(i!==t)}else o===null&&(i.shared.lanes=0);dd|=a,e.lanes=a,e.memoizedState=u}}function qF(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(pe(191,i));i.call(n)}}}var Lg={},Ds=mc(Lg),Dg=mc(Lg),Pg=mc(Lg);function id(e){if(e===Lg)throw Error(pe(174));return e}function pC(e,t){switch(Qt(Pg,t),Qt(Dg,e),Qt(Ds,Lg),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:o1(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=o1(t,e)}or(Ds),Qt(Ds,t)}function dp(){or(Ds),or(Dg),or(Pg)}function yL(e){id(Pg.current);var t=id(Ds.current),r=o1(t,e.type);t!==r&&(Qt(Dg,e),Qt(Ds,r))}function mC(e){Dg.current===e&&(or(Ds),or(Dg))}var Tr=mc(0);function pb(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var BT=[];function fC(){for(var e=0;e<BT.length;e++)BT[e]._workInProgressVersionPrimary=null;BT.length=0}var Vy=dl.ReactCurrentDispatcher,UT=dl.ReactCurrentBatchConfig,cd=0,Cr=null,ln=null,Sn=null,mb=!1,pg=!1,Ag=0,C9=0;function Zn(){throw Error(pe(321))}function gC(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ua(e[r],t[r]))return!1;return!0}function hC(e,t,r,n,i,o){if(cd=o,Cr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Vy.current=e===null||e.memoizedState===null?A9:N9,e=r(n,i),pg){o=0;do{if(pg=!1,Ag=0,25<=o)throw Error(pe(301));o+=1,Sn=ln=null,t.updateQueue=null,Vy.current=M9,e=r(n,i)}while(pg)}if(Vy.current=fb,t=ln!==null&&ln.next!==null,cd=0,Sn=ln=Cr=null,mb=!1,t)throw Error(pe(300));return e}function vC(){var e=Ag!==0;return Ag=0,e}function Ts(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Sn===null?Cr.memoizedState=Sn=e:Sn=Sn.next=e,Sn}function na(){if(ln===null){var e=Cr.alternate;e=e!==null?e.memoizedState:null}else e=ln.next;var t=Sn===null?Cr.memoizedState:Sn.next;if(t!==null)Sn=t,ln=e;else{if(e===null)throw Error(pe(310));ln=e,e={memoizedState:ln.memoizedState,baseState:ln.baseState,baseQueue:ln.baseQueue,queue:ln.queue,next:null},Sn===null?Cr.memoizedState=Sn=e:Sn=Sn.next=e}return Sn}function Ng(e,t){return typeof t=="function"?t(e):t}function VT(e){var t=na(),r=t.queue;if(r===null)throw Error(pe(311));r.lastRenderedReducer=e;var n=ln,i=n.baseQueue,o=r.pending;if(o!==null){if(i!==null){var a=i.next;i.next=o.next,o.next=a}n.baseQueue=i=o,r.pending=null}if(i!==null){o=i.next,n=n.baseState;var s=a=null,l=null,c=o;do{var d=c.lane;if((cd&d)===d)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var u={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(s=l=u,a=n):l=l.next=u,Cr.lanes|=d,dd|=d}c=c.next}while(c!==null&&c!==o);l===null?a=n:l.next=s,Ua(n,t.memoizedState)||(Ui=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do o=i.lane,Cr.lanes|=o,dd|=o,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function HT(e){var t=na(),r=t.queue;if(r===null)throw Error(pe(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,o=t.memoizedState;if(i!==null){r.pending=null;var a=i=i.next;do o=e(o,a.action),a=a.next;while(a!==i);Ua(o,t.memoizedState)||(Ui=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),r.lastRenderedState=o}return[o,n]}function bL(){}function wL(e,t){var r=Cr,n=na(),i=t(),o=!Ua(n.memoizedState,i);if(o&&(n.memoizedState=i,Ui=!0),n=n.queue,yC(SL.bind(null,r,n,e),[e]),n.getSnapshot!==t||o||Sn!==null&&Sn.memoizedState.tag&1){if(r.flags|=2048,Mg(9,kL.bind(null,r,n,i,t),void 0,null),Tn===null)throw Error(pe(349));(cd&30)!==0||xL(r,t,i)}return i}function xL(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Cr.updateQueue,t===null?(t={lastEffect:null,stores:null},Cr.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function kL(e,t,r,n){t.value=r,t.getSnapshot=n,TL(t)&&CL(e)}function SL(e,t,r){return r(function(){TL(t)&&CL(e)})}function TL(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ua(e,r)}catch(n){return!0}}function CL(e){var t=ll(e,1);t!==null&&Ba(t,e,1,-1)}function GF(e){var t=Ts();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ng,lastRenderedState:e},t.queue=e,e=e.dispatch=P9.bind(null,Cr,e),[t.memoizedState,e]}function Mg(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Cr.updateQueue,t===null?(t={lastEffect:null,stores:null},Cr.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function EL(){return na().memoizedState}function Hy(e,t,r,n){var i=Ts();Cr.flags|=e,i.memoizedState=Mg(1|t,r,void 0,n===void 0?null:n)}function Eb(e,t,r,n){var i=na();n=n===void 0?null:n;var o=void 0;if(ln!==null){var a=ln.memoizedState;if(o=a.destroy,n!==null&&gC(n,a.deps)){i.memoizedState=Mg(t,r,o,n);return}}Cr.flags|=e,i.memoizedState=Mg(1|t,r,o,n)}function YF(e,t){return Hy(8390656,8,e,t)}function yC(e,t){return Eb(2048,8,e,t)}function DL(e,t){return Eb(4,2,e,t)}function PL(e,t){return Eb(4,4,e,t)}function AL(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function NL(e,t,r){return r=r!=null?r.concat([e]):null,Eb(4,4,AL.bind(null,t,e),r)}function bC(){}function ML(e,t){var r=na();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&gC(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function OL(e,t){var r=na();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&gC(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function IL(e,t,r){return(cd&21)===0?(e.baseState&&(e.baseState=!1,Ui=!0),e.memoizedState=r):(Ua(r,t)||(r=zj(),Cr.lanes|=r,dd|=r,e.baseState=!0),t)}function E9(e,t){var r=Ot;Ot=r!==0&&4>r?r:4,e(!0);var n=UT.transition;UT.transition={};try{e(!1),t()}finally{Ot=r,UT.transition=n}}function FL(){return na().memoizedState}function D9(e,t,r){var n=lc(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},jL(e))LL(t,r);else if(r=hL(e,t,r,n),r!==null){var i=Si();Ba(r,e,n,i),_L(r,t,n)}}function P9(e,t,r){var n=lc(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(jL(e))LL(t,i);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var a=t.lastRenderedState,s=o(a,r);if(i.hasEagerState=!0,i.eagerState=s,Ua(s,a)){var l=t.interleaved;l===null?(i.next=i,dC(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch(c){}finally{}r=hL(e,t,i,n),r!==null&&(i=Si(),Ba(r,e,n,i),_L(r,t,n))}}function jL(e){var t=e.alternate;return e===Cr||t!==null&&t===Cr}function LL(e,t){pg=mb=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function _L(e,t,r){if((r&4194240)!==0){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,J1(e,r)}}var fb={readContext:ra,useCallback:Zn,useContext:Zn,useEffect:Zn,useImperativeHandle:Zn,useInsertionEffect:Zn,useLayoutEffect:Zn,useMemo:Zn,useReducer:Zn,useRef:Zn,useState:Zn,useDebugValue:Zn,useDeferredValue:Zn,useTransition:Zn,useMutableSource:Zn,useSyncExternalStore:Zn,useId:Zn,unstable_isNewReconciler:!1},A9={readContext:ra,useCallback:function(e,t){return Ts().memoizedState=[e,t===void 0?null:t],e},useContext:ra,useEffect:YF,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Hy(4194308,4,AL.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Hy(4194308,4,e,t)},useInsertionEffect:function(e,t){return Hy(4,2,e,t)},useMemo:function(e,t){var r=Ts();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Ts();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=D9.bind(null,Cr,e),[n.memoizedState,e]},useRef:function(e){var t=Ts();return e={current:e},t.memoizedState=e},useState:GF,useDebugValue:bC,useDeferredValue:function(e){return Ts().memoizedState=e},useTransition:function(){var e=GF(!1),t=e[0];return e=E9.bind(null,e[1]),Ts().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Cr,i=Ts();if(pr){if(r===void 0)throw Error(pe(407));r=r()}else{if(r=t(),Tn===null)throw Error(pe(349));(cd&30)!==0||xL(n,t,r)}i.memoizedState=r;var o={value:r,getSnapshot:t};return i.queue=o,YF(SL.bind(null,n,o,e),[e]),n.flags|=2048,Mg(9,kL.bind(null,n,o,r,t),void 0,null),r},useId:function(){var e=Ts(),t=Tn.identifierPrefix;if(pr){var r=il,n=nl;r=(n&~(1<<32-Wa(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Ag++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=C9++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},N9={readContext:ra,useCallback:ML,useContext:ra,useEffect:yC,useImperativeHandle:NL,useInsertionEffect:DL,useLayoutEffect:PL,useMemo:OL,useReducer:VT,useRef:EL,useState:function(){return VT(Ng)},useDebugValue:bC,useDeferredValue:function(e){var t=na();return IL(t,ln.memoizedState,e)},useTransition:function(){var e=VT(Ng)[0],t=na().memoizedState;return[e,t]},useMutableSource:bL,useSyncExternalStore:wL,useId:FL,unstable_isNewReconciler:!1},M9={readContext:ra,useCallback:ML,useContext:ra,useEffect:yC,useImperativeHandle:NL,useInsertionEffect:DL,useLayoutEffect:PL,useMemo:OL,useReducer:HT,useRef:EL,useState:function(){return HT(Ng)},useDebugValue:bC,useDeferredValue:function(e){var t=na();return ln===null?t.memoizedState=e:IL(t,ln.memoizedState,e)},useTransition:function(){var e=HT(Ng)[0],t=na().memoizedState;return[e,t]},useMutableSource:bL,useSyncExternalStore:wL,useId:FL,unstable_isNewReconciler:!1};function za(e,t){if(e&&e.defaultProps){t=Er({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function E1(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Er({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Db={isMounted:function(e){return(e=e._reactInternals)?md(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Si(),i=lc(e),o=ol(n,i);o.payload=t,r!=null&&(o.callback=r),t=ac(e,o,i),t!==null&&(Ba(t,e,i,n),Uy(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Si(),i=lc(e),o=ol(n,i);o.tag=1,o.payload=t,r!=null&&(o.callback=r),t=ac(e,o,i),t!==null&&(Ba(t,e,i,n),Uy(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Si(),n=lc(e),i=ol(r,n);i.tag=2,t!=null&&(i.callback=t),t=ac(e,i,n),t!==null&&(Ba(t,e,n,r),Uy(t,e,n))}};function KF(e,t,r,n,i,o,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,o,a):t.prototype&&t.prototype.isPureReactComponent?!Sg(r,n)||!Sg(i,o):!0}function zL(e,t,r){var n=!1,i=uc,o=t.contextType;return typeof o=="object"&&o!==null?o=ra(o):(i=Hi(t)?sd:ri.current,n=t.contextTypes,o=(n=n!=null)?sp(e,i):uc),t=new t(r,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Db,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function JF(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Db.enqueueReplaceState(t,t.state,null)}function D1(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},uC(e);var o=t.contextType;typeof o=="object"&&o!==null?i.context=ra(o):(o=Hi(t)?sd:ri.current,i.context=sp(e,o)),i.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(E1(e,t,o,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Db.enqueueReplaceState(i,i.state,null),ub(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function up(e,t){try{var r="",n=t;do r+=sY(n),n=n.return;while(n);var i=r}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:i,digest:null}}function qT(e,t,r){return{value:e,source:null,stack:r!=null?r:null,digest:t!=null?t:null}}function P1(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var O9=typeof WeakMap=="function"?WeakMap:Map;function $L(e,t,r){r=ol(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){hb||(hb=!0,z1=n),P1(e,t)},r}function RL(e,t,r){r=ol(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){P1(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(r.callback=function(){P1(e,t),typeof n!="function"&&(sc===null?sc=new Set([this]):sc.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function XF(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new O9;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=q9.bind(null,e,t,r),t.then(e,e))}function QF(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function ZF(e,t,r,n,i){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=ol(-1,1),t.tag=2,ac(r,t,1))),r.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var I9=dl.ReactCurrentOwner,Ui=!1;function ki(e,t,r,n){t.child=e===null?gL(t,null,r,n):cp(t,e.child,r,n)}function ej(e,t,r,n,i){r=r.render;var o=t.ref;return ip(t,i),n=hC(e,t,r,n,o,i),r=vC(),e!==null&&!Ui?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,cl(e,t,i)):(pr&&r&&iC(t),t.flags|=1,ki(e,t,n,i),t.child)}function tj(e,t,r,n,i){if(e===null){var o=r.type;return typeof o=="function"&&!DC(o)&&o.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=o,WL(e,t,o,n,i)):(e=Ky(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,(e.lanes&i)===0){var a=o.memoizedProps;if(r=r.compare,r=r!==null?r:Sg,r(a,n)&&e.ref===t.ref)return cl(e,t,i)}return t.flags|=1,e=cc(o,n),e.ref=t.ref,e.return=t,t.child=e}function WL(e,t,r,n,i){if(e!==null){var o=e.memoizedProps;if(Sg(o,n)&&e.ref===t.ref)if(Ui=!1,t.pendingProps=n=o,(e.lanes&i)!==0)(e.flags&131072)!==0&&(Ui=!0);else return t.lanes=e.lanes,cl(e,t,i)}return A1(e,t,r,n,i)}function BL(e,t,r){var n=t.pendingProps,i=n.children,o=e!==null?e.memoizedState:null;if(n.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Qt(Zu,wo),wo|=r;else{if((r&1073741824)===0)return e=o!==null?o.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Qt(Zu,wo),wo|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=o!==null?o.baseLanes:r,Qt(Zu,wo),wo|=n}else o!==null?(n=o.baseLanes|r,t.memoizedState=null):n=r,Qt(Zu,wo),wo|=n;return ki(e,t,i,r),t.child}function UL(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function A1(e,t,r,n,i){var o=Hi(r)?sd:ri.current;return o=sp(t,o),ip(t,i),r=hC(e,t,r,n,o,i),n=vC(),e!==null&&!Ui?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,cl(e,t,i)):(pr&&n&&iC(t),t.flags|=1,ki(e,t,r,i),t.child)}function rj(e,t,r,n,i){if(Hi(r)){var o=!0;ab(t)}else o=!1;if(ip(t,i),t.stateNode===null)qy(e,t),zL(t,r,n),D1(t,r,n,i),n=!0;else if(e===null){var a=t.stateNode,s=t.memoizedProps;a.props=s;var l=a.context,c=r.contextType;typeof c=="object"&&c!==null?c=ra(c):(c=Hi(r)?sd:ri.current,c=sp(t,c));var d=r.getDerivedStateFromProps,u=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function";u||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==n||l!==c)&&JF(t,a,n,c),Xl=!1;var p=t.memoizedState;a.state=p,ub(t,n,a,i),l=t.memoizedState,s!==n||p!==l||Vi.current||Xl?(typeof d=="function"&&(E1(t,r,d,n),l=t.memoizedState),(s=Xl||KF(t,r,s,n,p,l,c))?(u||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),a.props=n,a.state=l,a.context=c,n=s):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,vL(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:za(t.type,s),a.props=c,u=t.pendingProps,p=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=ra(l):(l=Hi(r)?sd:ri.current,l=sp(t,l));var m=r.getDerivedStateFromProps;(d=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==u||p!==l)&&JF(t,a,n,l),Xl=!1,p=t.memoizedState,a.state=p,ub(t,n,a,i);var g=t.memoizedState;s!==u||p!==g||Vi.current||Xl?(typeof m=="function"&&(E1(t,r,m,n),g=t.memoizedState),(c=Xl||KF(t,r,c,n,p,g,l)||!1)?(d||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,g,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,g,l)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),a.props=n,a.state=g,a.context=l,n=c):(typeof a.componentDidUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return N1(e,t,r,n,o,i)}function N1(e,t,r,n,i,o){UL(e,t);var a=(t.flags&128)!==0;if(!n&&!a)return i&&WF(t,r,!1),cl(e,t,o);n=t.stateNode,I9.current=t;var s=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&a?(t.child=cp(t,e.child,null,o),t.child=cp(t,null,s,o)):ki(e,t,s,o),t.memoizedState=n.state,i&&WF(t,r,!0),t.child}function VL(e){var t=e.stateNode;t.pendingContext?RF(e,t.pendingContext,t.pendingContext!==t.context):t.context&&RF(e,t.context,!1),pC(e,t.containerInfo)}function nj(e,t,r,n,i){return lp(),aC(i),t.flags|=256,ki(e,t,r,n),t.child}var M1={dehydrated:null,treeContext:null,retryLane:0};function O1(e){return{baseLanes:e,cachePool:null,transitions:null}}function HL(e,t,r){var n=t.pendingProps,i=Tr.current,o=!1,a=(t.flags&128)!==0,s;if((s=a)||(s=e!==null&&e.memoizedState===null?!1:(i&2)!==0),s?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Qt(Tr,i&1),e===null)return T1(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(a=n.children,e=n.fallback,o?(n=t.mode,o=t.child,a={mode:"hidden",children:a},(n&1)===0&&o!==null?(o.childLanes=0,o.pendingProps=a):o=Nb(a,n,0,null),e=ad(e,n,r,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=O1(r),t.memoizedState=M1,e):wC(t,a));if(i=e.memoizedState,i!==null&&(s=i.dehydrated,s!==null))return F9(e,t,a,n,s,i,r);if(o){o=n.fallback,a=t.mode,i=e.child,s=i.sibling;var l={mode:"hidden",children:n.children};return(a&1)===0&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=cc(i,l),n.subtreeFlags=i.subtreeFlags&14680064),s!==null?o=cc(s,o):(o=ad(o,a,r,null),o.flags|=2),o.return=t,n.return=t,n.sibling=o,t.child=n,n=o,o=t.child,a=e.child.memoizedState,a=a===null?O1(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=e.childLanes&~r,t.memoizedState=M1,n}return o=e.child,e=o.sibling,n=cc(o,{mode:"visible",children:n.children}),(t.mode&1)===0&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function wC(e,t){return t=Nb({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function _y(e,t,r,n){return n!==null&&aC(n),cp(t,e.child,null,r),e=wC(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function F9(e,t,r,n,i,o,a){if(r)return t.flags&256?(t.flags&=-257,n=qT(Error(pe(422))),_y(e,t,a,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=n.fallback,i=t.mode,n=Nb({mode:"visible",children:n.children},i,0,null),o=ad(o,i,a,null),o.flags|=2,n.return=t,o.return=t,n.sibling=o,t.child=n,(t.mode&1)!==0&&cp(t,e.child,null,a),t.child.memoizedState=O1(a),t.memoizedState=M1,o);if((t.mode&1)===0)return _y(e,t,a,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var s=n.dgst;return n=s,o=Error(pe(419)),n=qT(o,n,void 0),_y(e,t,a,n)}if(s=(a&e.childLanes)!==0,Ui||s){if(n=Tn,n!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=(i&(n.suspendedLanes|a))!==0?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,ll(e,i),Ba(n,e,i,-1))}return EC(),n=qT(Error(pe(421))),_y(e,t,a,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=G9.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,xo=oc(i.nextSibling),ko=t,pr=!0,Ra=null,e!==null&&(Qo[Zo++]=nl,Qo[Zo++]=il,Qo[Zo++]=ld,nl=e.id,il=e.overflow,ld=t),t=wC(t,n.children),t.flags|=4096,t)}function ij(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),C1(e.return,t,r)}function GT(e,t,r,n,i){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=r,o.tailMode=i)}function qL(e,t,r){var n=t.pendingProps,i=n.revealOrder,o=n.tail;if(ki(e,t,n.children,r),n=Tr.current,(n&2)!==0)n=n&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&ij(e,r,t);else if(e.tag===19)ij(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Qt(Tr,n),(t.mode&1)===0)t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&pb(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),GT(t,!1,i,r,o);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&pb(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}GT(t,!0,r,null,o);break;case"together":GT(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function qy(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function cl(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),dd|=t.lanes,(r&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(pe(153));if(t.child!==null){for(e=t.child,r=cc(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=cc(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function j9(e,t,r){switch(t.tag){case 3:VL(t),lp();break;case 5:yL(t);break;case 1:Hi(t.type)&&ab(t);break;case 4:pC(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Qt(cb,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Qt(Tr,Tr.current&1),t.flags|=128,null):(r&t.child.childLanes)!==0?HL(e,t,r):(Qt(Tr,Tr.current&1),e=cl(e,t,r),e!==null?e.sibling:null);Qt(Tr,Tr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,(e.flags&128)!==0){if(n)return qL(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Qt(Tr,Tr.current),n)break;return null;case 22:case 23:return t.lanes=0,BL(e,t,r)}return cl(e,t,r)}var GL,I1,YL,KL;GL=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};I1=function(){};YL=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,id(Ds.current);var o=null;switch(r){case"input":i=t1(e,i),n=t1(e,n),o=[];break;case"select":i=Er({},i,{value:void 0}),n=Er({},n,{value:void 0}),o=[];break;case"textarea":i=i1(e,i),n=i1(e,n),o=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=ib)}a1(r,n);var a;r=null;for(c in i)if(!n.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var s=i[c];for(a in s)s.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(hg.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in n){var l=n[c];if(s=i!=null?i[c]:void 0,n.hasOwnProperty(c)&&l!==s&&(l!=null||s!=null))if(c==="style")if(s){for(a in s)!s.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&s[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(o||(o=[]),o.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,s=s?s.__html:void 0,l!=null&&s!==l&&(o=o||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(hg.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&ir("scroll",e),o||s===l||(o=[])):(o=o||[]).push(c,l))}r&&(o=o||[]).push("style",r);var c=o;(t.updateQueue=c)&&(t.flags|=4)}};KL=function(e,t,r,n){r!==n&&(t.flags|=4)};function eg(e,t){if(!pr)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function ei(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function L9(e,t,r){var n=t.pendingProps;switch(oC(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ei(t),null;case 1:return Hi(t.type)&&ob(),ei(t),null;case 3:return n=t.stateNode,dp(),or(Vi),or(ri),fC(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(jy(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Ra!==null&&(W1(Ra),Ra=null))),I1(e,t),ei(t),null;case 5:mC(t);var i=id(Pg.current);if(r=t.type,e!==null&&t.stateNode!=null)YL(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(pe(166));return ei(t),null}if(e=id(Ds.current),jy(t)){n=t.stateNode,r=t.type;var o=t.memoizedProps;switch(n[Cs]=t,n[Eg]=o,e=(t.mode&1)!==0,r){case"dialog":ir("cancel",n),ir("close",n);break;case"iframe":case"object":case"embed":ir("load",n);break;case"video":case"audio":for(i=0;i<ag.length;i++)ir(ag[i],n);break;case"source":ir("error",n);break;case"img":case"image":case"link":ir("error",n),ir("load",n);break;case"details":ir("toggle",n);break;case"input":pF(n,o),ir("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!o.multiple},ir("invalid",n);break;case"textarea":fF(n,o),ir("invalid",n)}a1(r,o),i=null;for(var a in o)if(o.hasOwnProperty(a)){var s=o[a];a==="children"?typeof s=="string"?n.textContent!==s&&(o.suppressHydrationWarning!==!0&&Fy(n.textContent,s,e),i=["children",s]):typeof s=="number"&&n.textContent!==""+s&&(o.suppressHydrationWarning!==!0&&Fy(n.textContent,s,e),i=["children",""+s]):hg.hasOwnProperty(a)&&s!=null&&a==="onScroll"&&ir("scroll",n)}switch(r){case"input":ky(n),mF(n,o,!0);break;case"textarea":ky(n),gF(n);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(n.onclick=ib)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Sj(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=a.createElement(r,{is:n.is}):(e=a.createElement(r),r==="select"&&(a=e,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):e=a.createElementNS(e,r),e[Cs]=t,e[Eg]=n,GL(e,t,!1,!1),t.stateNode=e;e:{switch(a=s1(r,n),r){case"dialog":ir("cancel",e),ir("close",e),i=n;break;case"iframe":case"object":case"embed":ir("load",e),i=n;break;case"video":case"audio":for(i=0;i<ag.length;i++)ir(ag[i],e);i=n;break;case"source":ir("error",e),i=n;break;case"img":case"image":case"link":ir("error",e),ir("load",e),i=n;break;case"details":ir("toggle",e),i=n;break;case"input":pF(e,n),i=t1(e,n),ir("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Er({},n,{value:void 0}),ir("invalid",e);break;case"textarea":fF(e,n),i=i1(e,n),ir("invalid",e);break;default:i=n}a1(r,i),s=i;for(o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="style"?Ej(e,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Tj(e,l)):o==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&vg(e,l):typeof l=="number"&&vg(e,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(hg.hasOwnProperty(o)?l!=null&&o==="onScroll"&&ir("scroll",e):l!=null&&V1(e,o,l,a))}switch(r){case"input":ky(e),mF(e,n,!1);break;case"textarea":ky(e),gF(e);break;case"option":n.value!=null&&e.setAttribute("value",""+dc(n.value));break;case"select":e.multiple=!!n.multiple,o=n.value,o!=null?ep(e,!!n.multiple,o,!1):n.defaultValue!=null&&ep(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=ib)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ei(t),null;case 6:if(e&&t.stateNode!=null)KL(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(pe(166));if(r=id(Pg.current),id(Ds.current),jy(t)){if(n=t.stateNode,r=t.memoizedProps,n[Cs]=t,(o=n.nodeValue!==r)&&(e=ko,e!==null))switch(e.tag){case 3:Fy(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Fy(n.nodeValue,r,(e.mode&1)!==0)}o&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Cs]=t,t.stateNode=n}return ei(t),null;case 13:if(or(Tr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(pr&&xo!==null&&(t.mode&1)!==0&&(t.flags&128)===0)mL(),lp(),t.flags|=98560,o=!1;else if(o=jy(t),n!==null&&n.dehydrated!==null){if(e===null){if(!o)throw Error(pe(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(pe(317));o[Cs]=t}else lp(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;ei(t),o=!1}else Ra!==null&&(W1(Ra),Ra=null),o=!0;if(!o)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(Tr.current&1)!==0?cn===0&&(cn=3):EC())),t.updateQueue!==null&&(t.flags|=4),ei(t),null);case 4:return dp(),I1(e,t),e===null&&Tg(t.stateNode.containerInfo),ei(t),null;case 10:return cC(t.type._context),ei(t),null;case 17:return Hi(t.type)&&ob(),ei(t),null;case 19:if(or(Tr),o=t.memoizedState,o===null)return ei(t),null;if(n=(t.flags&128)!==0,a=o.rendering,a===null)if(n)eg(o,!1);else{if(cn!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(a=pb(e),a!==null){for(t.flags|=128,eg(o,!1),n=a.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)o=r,e=n,o.flags&=14680066,a=o.alternate,a===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,o.type=a.type,e=a.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Qt(Tr,Tr.current&1|2),t.child}e=e.sibling}o.tail!==null&&Wr()>pp&&(t.flags|=128,n=!0,eg(o,!1),t.lanes=4194304)}else{if(!n)if(e=pb(a),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),eg(o,!0),o.tail===null&&o.tailMode==="hidden"&&!a.alternate&&!pr)return ei(t),null}else 2*Wr()-o.renderingStartTime>pp&&r!==1073741824&&(t.flags|=128,n=!0,eg(o,!1),t.lanes=4194304);o.isBackwards?(a.sibling=t.child,t.child=a):(r=o.last,r!==null?r.sibling=a:t.child=a,o.last=a)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Wr(),t.sibling=null,r=Tr.current,Qt(Tr,n?r&1|2:r&1),t):(ei(t),null);case 22:case 23:return CC(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&(t.mode&1)!==0?(wo&1073741824)!==0&&(ei(t),t.subtreeFlags&6&&(t.flags|=8192)):ei(t),null;case 24:return null;case 25:return null}throw Error(pe(156,t.tag))}function _9(e,t){switch(oC(t),t.tag){case 1:return Hi(t.type)&&ob(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return dp(),or(Vi),or(ri),fC(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return mC(t),null;case 13:if(or(Tr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(pe(340));lp()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return or(Tr),null;case 4:return dp(),null;case 10:return cC(t.type._context),null;case 22:case 23:return CC(),null;case 24:return null;default:return null}}var zy=!1,ti=!1,z9=typeof WeakSet=="function"?WeakSet:Set,ke=null;function Qu(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Nr(e,t,n)}else r.current=null}function F1(e,t,r){try{r()}catch(n){Nr(e,t,n)}}var oj=!1;function $9(e,t){if(v1=tb,e=eL(),nC(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{r.nodeType,o.nodeType}catch(w){r=null;break e}var a=0,s=-1,l=-1,c=0,d=0,u=e,p=null;t:for(;;){for(var m;u!==r||i!==0&&u.nodeType!==3||(s=a+i),u!==o||n!==0&&u.nodeType!==3||(l=a+n),u.nodeType===3&&(a+=u.nodeValue.length),(m=u.firstChild)!==null;)p=u,u=m;for(;;){if(u===e)break t;if(p===r&&++c===i&&(s=a),p===o&&++d===n&&(l=a),(m=u.nextSibling)!==null)break;u=p,p=u.parentNode}u=m}r=s===-1||l===-1?null:{start:s,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(y1={focusedElem:e,selectionRange:r},tb=!1,ke=t;ke!==null;)if(t=ke,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ke=e;else for(;ke!==null;){t=ke;try{var g=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var f=g.memoizedProps,y=g.memoizedState,h=t.stateNode,v=h.getSnapshotBeforeUpdate(t.elementType===t.type?f:za(t.type,f),y);h.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(pe(163))}}catch(w){Nr(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,ke=e;break}ke=t.return}return g=oj,oj=!1,g}function mg(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,o!==void 0&&F1(t,r,o)}i=i.next}while(i!==n)}}function Pb(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function j1(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function JL(e){var t=e.alternate;t!==null&&(e.alternate=null,JL(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Cs],delete t[Eg],delete t[x1],delete t[x9],delete t[k9])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function XL(e){return e.tag===5||e.tag===3||e.tag===4}function aj(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||XL(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function L1(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=ib));else if(n!==4&&(e=e.child,e!==null))for(L1(e,t,r),e=e.sibling;e!==null;)L1(e,t,r),e=e.sibling}function _1(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(_1(e,t,r),e=e.sibling;e!==null;)_1(e,t,r),e=e.sibling}var $n=null,$a=!1;function Kl(e,t,r){for(r=r.child;r!==null;)QL(e,t,r),r=r.sibling}function QL(e,t,r){if(Es&&typeof Es.onCommitFiberUnmount=="function")try{Es.onCommitFiberUnmount(wb,r)}catch(s){}switch(r.tag){case 5:ti||Qu(r,t);case 6:var n=$n,i=$a;$n=null,Kl(e,t,r),$n=n,$a=i,$n!==null&&($a?(e=$n,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):$n.removeChild(r.stateNode));break;case 18:$n!==null&&($a?(e=$n,r=r.stateNode,e.nodeType===8?RT(e.parentNode,r):e.nodeType===1&&RT(e,r),xg(e)):RT($n,r.stateNode));break;case 4:n=$n,i=$a,$n=r.stateNode.containerInfo,$a=!0,Kl(e,t,r),$n=n,$a=i;break;case 0:case 11:case 14:case 15:if(!ti&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var o=i,a=o.destroy;o=o.tag,a!==void 0&&((o&2)!==0||(o&4)!==0)&&F1(r,t,a),i=i.next}while(i!==n)}Kl(e,t,r);break;case 1:if(!ti&&(Qu(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(s){Nr(r,t,s)}Kl(e,t,r);break;case 21:Kl(e,t,r);break;case 22:r.mode&1?(ti=(n=ti)||r.memoizedState!==null,Kl(e,t,r),ti=n):Kl(e,t,r);break;default:Kl(e,t,r)}}function sj(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new z9),t.forEach(function(n){var i=Y9.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function _a(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var o=e,a=t,s=a;e:for(;s!==null;){switch(s.tag){case 5:$n=s.stateNode,$a=!1;break e;case 3:$n=s.stateNode.containerInfo,$a=!0;break e;case 4:$n=s.stateNode.containerInfo,$a=!0;break e}s=s.return}if($n===null)throw Error(pe(160));QL(o,a,i),$n=null,$a=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Nr(i,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)ZL(t,e),t=t.sibling}function ZL(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(_a(t,e),Ss(e),n&4){try{mg(3,e,e.return),Pb(3,e)}catch(f){Nr(e,e.return,f)}try{mg(5,e,e.return)}catch(f){Nr(e,e.return,f)}}break;case 1:_a(t,e),Ss(e),n&512&&r!==null&&Qu(r,r.return);break;case 5:if(_a(t,e),Ss(e),n&512&&r!==null&&Qu(r,r.return),e.flags&32){var i=e.stateNode;try{vg(i,"")}catch(f){Nr(e,e.return,f)}}if(n&4&&(i=e.stateNode,i!=null)){var o=e.memoizedProps,a=r!==null?r.memoizedProps:o,s=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{s==="input"&&o.type==="radio"&&o.name!=null&&xj(i,o),s1(s,a);var c=s1(s,o);for(a=0;a<l.length;a+=2){var d=l[a],u=l[a+1];d==="style"?Ej(i,u):d==="dangerouslySetInnerHTML"?Tj(i,u):d==="children"?vg(i,u):V1(i,d,u,c)}switch(s){case"input":r1(i,o);break;case"textarea":kj(i,o);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var m=o.value;m!=null?ep(i,!!o.multiple,m,!1):p!==!!o.multiple&&(o.defaultValue!=null?ep(i,!!o.multiple,o.defaultValue,!0):ep(i,!!o.multiple,o.multiple?[]:"",!1))}i[Eg]=o}catch(f){Nr(e,e.return,f)}}break;case 6:if(_a(t,e),Ss(e),n&4){if(e.stateNode===null)throw Error(pe(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(f){Nr(e,e.return,f)}}break;case 3:if(_a(t,e),Ss(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{xg(t.containerInfo)}catch(f){Nr(e,e.return,f)}break;case 4:_a(t,e),Ss(e);break;case 13:_a(t,e),Ss(e),i=e.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(SC=Wr())),n&4&&sj(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(ti=(c=ti)||d,_a(t,e),ti=c):_a(t,e),Ss(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!d&&(e.mode&1)!==0)for(ke=e,d=e.child;d!==null;){for(u=ke=d;ke!==null;){switch(p=ke,m=p.child,p.tag){case 0:case 11:case 14:case 15:mg(4,p,p.return);break;case 1:Qu(p,p.return);var g=p.stateNode;if(typeof g.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(f){Nr(n,r,f)}}break;case 5:Qu(p,p.return);break;case 22:if(p.memoizedState!==null){cj(u);continue}}m!==null?(m.return=p,ke=m):cj(u)}d=d.sibling}e:for(d=null,u=e;;){if(u.tag===5){if(d===null){d=u;try{i=u.stateNode,c?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(s=u.stateNode,l=u.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,s.style.display=Cj("display",a))}catch(f){Nr(e,e.return,f)}}}else if(u.tag===6){if(d===null)try{u.stateNode.nodeValue=c?"":u.memoizedProps}catch(f){Nr(e,e.return,f)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===e)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===e)break e;for(;u.sibling===null;){if(u.return===null||u.return===e)break e;d===u&&(d=null),u=u.return}d===u&&(d=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:_a(t,e),Ss(e),n&4&&sj(e);break;case 21:break;default:_a(t,e),Ss(e)}}function Ss(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(XL(r)){var n=r;break e}r=r.return}throw Error(pe(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(vg(i,""),n.flags&=-33);var o=aj(e);_1(e,o,i);break;case 3:case 4:var a=n.stateNode.containerInfo,s=aj(e);L1(e,s,a);break;default:throw Error(pe(161))}}catch(l){Nr(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function R9(e,t,r){ke=e,e2(e,t,r)}function e2(e,t,r){for(var n=(e.mode&1)!==0;ke!==null;){var i=ke,o=i.child;if(i.tag===22&&n){var a=i.memoizedState!==null||zy;if(!a){var s=i.alternate,l=s!==null&&s.memoizedState!==null||ti;s=zy;var c=ti;if(zy=a,(ti=l)&&!c)for(ke=i;ke!==null;)a=ke,l=a.child,a.tag===22&&a.memoizedState!==null?dj(i):l!==null?(l.return=a,ke=l):dj(i);for(;o!==null;)ke=o,e2(o,t,r),o=o.sibling;ke=i,zy=s,ti=c}lj(e,t,r)}else(i.subtreeFlags&8772)!==0&&o!==null?(o.return=i,ke=o):lj(e,t,r)}}function lj(e){for(;ke!==null;){var t=ke;if((t.flags&8772)!==0){var r=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:ti||Pb(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!ti)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:za(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&qF(t,o,n);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}qF(t,a,r)}break;case 5:var s=t.stateNode;if(r===null&&t.flags&4){r=s;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var u=d.dehydrated;u!==null&&xg(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(pe(163))}ti||t.flags&512&&j1(t)}catch(p){Nr(t,t.return,p)}}if(t===e){ke=null;break}if(r=t.sibling,r!==null){r.return=t.return,ke=r;break}ke=t.return}}function cj(e){for(;ke!==null;){var t=ke;if(t===e){ke=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ke=r;break}ke=t.return}}function dj(e){for(;ke!==null;){var t=ke;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Pb(4,t)}catch(l){Nr(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(l){Nr(t,i,l)}}var o=t.return;try{j1(t)}catch(l){Nr(t,o,l)}break;case 5:var a=t.return;try{j1(t)}catch(l){Nr(t,a,l)}}}catch(l){Nr(t,t.return,l)}if(t===e){ke=null;break}var s=t.sibling;if(s!==null){s.return=t.return,ke=s;break}ke=t.return}}var W9=Math.ceil,gb=dl.ReactCurrentDispatcher,xC=dl.ReactCurrentOwner,ta=dl.ReactCurrentBatchConfig,vt=0,Tn=null,Yr=null,Rn=0,wo=0,Zu=mc(0),cn=0,Og=null,dd=0,Ab=0,kC=0,fg=null,Bi=null,SC=0,pp=1/0,tl=null,hb=!1,z1=null,sc=null,$y=!1,tc=null,vb=0,gg=0,$1=null,Gy=-1,Yy=0;function Si(){return(vt&6)!==0?Wr():Gy!==-1?Gy:Gy=Wr()}function lc(e){return(e.mode&1)===0?1:(vt&2)!==0&&Rn!==0?Rn&-Rn:T9.transition!==null?(Yy===0&&(Yy=zj()),Yy):(e=Ot,e!==0||(e=window.event,e=e===void 0?16:Hj(e.type)),e)}function Ba(e,t,r,n){if(50<gg)throw gg=0,$1=null,Error(pe(185));Ig(e,r,n),((vt&2)===0||e!==Tn)&&(e===Tn&&((vt&2)===0&&(Ab|=r),cn===4&&Zl(e,Rn)),qi(e,n),r===1&&vt===0&&(t.mode&1)===0&&(pp=Wr()+500,Cb&&fc()))}function qi(e,t){var r=e.callbackNode;EY(e,t);var n=eb(e,e===Tn?Rn:0);if(n===0)r!==null&&yF(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&yF(r),t===1)e.tag===0?S9(uj.bind(null,e)):dL(uj.bind(null,e)),b9(function(){(vt&6)===0&&fc()}),r=null;else{switch($j(n)){case 1:r=K1;break;case 4:r=Lj;break;case 16:r=Zy;break;case 536870912:r=_j;break;default:r=Zy}r=l2(r,t2.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function t2(e,t){if(Gy=-1,Yy=0,(vt&6)!==0)throw Error(pe(327));var r=e.callbackNode;if(op()&&e.callbackNode!==r)return null;var n=eb(e,e===Tn?Rn:0);if(n===0)return null;if((n&30)!==0||(n&e.expiredLanes)!==0||t)t=yb(e,n);else{t=n;var i=vt;vt|=2;var o=n2();(Tn!==e||Rn!==t)&&(tl=null,pp=Wr()+500,od(e,t));do try{V9();break}catch(s){r2(e,s)}while(!0);lC(),gb.current=o,vt=i,Yr!==null?t=0:(Tn=null,Rn=0,t=cn)}if(t!==0){if(t===2&&(i=p1(e),i!==0&&(n=i,t=R1(e,i))),t===1)throw r=Og,od(e,0),Zl(e,n),qi(e,Wr()),r;if(t===6)Zl(e,n);else{if(i=e.current.alternate,(n&30)===0&&!B9(i)&&(t=yb(e,n),t===2&&(o=p1(e),o!==0&&(n=o,t=R1(e,o))),t===1))throw r=Og,od(e,0),Zl(e,n),qi(e,Wr()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(pe(345));case 2:td(e,Bi,tl);break;case 3:if(Zl(e,n),(n&130023424)===n&&(t=SC+500-Wr(),10<t)){if(eb(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){Si(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=w1(td.bind(null,e,Bi,tl),t);break}td(e,Bi,tl);break;case 4:if(Zl(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var a=31-Wa(n);o=1<<a,a=t[a],a>i&&(i=a),n&=~o}if(n=i,n=Wr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*W9(n/1960))-n,10<n){e.timeoutHandle=w1(td.bind(null,e,Bi,tl),n);break}td(e,Bi,tl);break;case 5:td(e,Bi,tl);break;default:throw Error(pe(329))}}}return qi(e,Wr()),e.callbackNode===r?t2.bind(null,e):null}function R1(e,t){var r=fg;return e.current.memoizedState.isDehydrated&&(od(e,t).flags|=256),e=yb(e,t),e!==2&&(t=Bi,Bi=r,t!==null&&W1(t)),e}function W1(e){Bi===null?Bi=e:Bi.push.apply(Bi,e)}function B9(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],o=i.getSnapshot;i=i.value;try{if(!Ua(o(),i))return!1}catch(a){return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Zl(e,t){for(t&=~kC,t&=~Ab,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Wa(t),n=1<<r;e[r]=-1,t&=~n}}function uj(e){if((vt&6)!==0)throw Error(pe(327));op();var t=eb(e,0);if((t&1)===0)return qi(e,Wr()),null;var r=yb(e,t);if(e.tag!==0&&r===2){var n=p1(e);n!==0&&(t=n,r=R1(e,n))}if(r===1)throw r=Og,od(e,0),Zl(e,t),qi(e,Wr()),r;if(r===6)throw Error(pe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,td(e,Bi,tl),qi(e,Wr()),null}function TC(e,t){var r=vt;vt|=1;try{return e(t)}finally{vt=r,vt===0&&(pp=Wr()+500,Cb&&fc())}}function ud(e){tc!==null&&tc.tag===0&&(vt&6)===0&&op();var t=vt;vt|=1;var r=ta.transition,n=Ot;try{if(ta.transition=null,Ot=1,e)return e()}finally{Ot=n,ta.transition=r,vt=t,(vt&6)===0&&fc()}}function CC(){wo=Zu.current,or(Zu)}function od(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,y9(r)),Yr!==null)for(r=Yr.return;r!==null;){var n=r;switch(oC(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&ob();break;case 3:dp(),or(Vi),or(ri),fC();break;case 5:mC(n);break;case 4:dp();break;case 13:or(Tr);break;case 19:or(Tr);break;case 10:cC(n.type._context);break;case 22:case 23:CC()}r=r.return}if(Tn=e,Yr=e=cc(e.current,null),Rn=wo=t,cn=0,Og=null,kC=Ab=dd=0,Bi=fg=null,nd!==null){for(t=0;t<nd.length;t++)if(r=nd[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,o=r.pending;if(o!==null){var a=o.next;o.next=i,n.next=a}r.pending=n}nd=null}return e}function r2(e,t){do{var r=Yr;try{if(lC(),Vy.current=fb,mb){for(var n=Cr.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}mb=!1}if(cd=0,Sn=ln=Cr=null,pg=!1,Ag=0,xC.current=null,r===null||r.return===null){cn=1,Og=t,Yr=null;break}e:{var o=e,a=r.return,s=r,l=t;if(t=Rn,s.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,d=s,u=d.tag;if((d.mode&1)===0&&(u===0||u===11||u===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=QF(a);if(m!==null){m.flags&=-257,ZF(m,a,s,o,t),m.mode&1&&XF(o,c,t),t=m,l=c;var g=t.updateQueue;if(g===null){var f=new Set;f.add(l),t.updateQueue=f}else g.add(l);break e}else{if((t&1)===0){XF(o,c,t),EC();break e}l=Error(pe(426))}}else if(pr&&s.mode&1){var y=QF(a);if(y!==null){(y.flags&65536)===0&&(y.flags|=256),ZF(y,a,s,o,t),aC(up(l,s));break e}}o=l=up(l,s),cn!==4&&(cn=2),fg===null?fg=[o]:fg.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var h=$L(o,l,t);HF(o,h);break e;case 1:s=l;var v=o.type,b=o.stateNode;if((o.flags&128)===0&&(typeof v.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(sc===null||!sc.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t;var w=RL(o,s,t);HF(o,w);break e}}o=o.return}while(o!==null)}o2(r)}catch(k){t=k,Yr===r&&r!==null&&(Yr=r=r.return);continue}break}while(!0)}function n2(){var e=gb.current;return gb.current=fb,e===null?fb:e}function EC(){(cn===0||cn===3||cn===2)&&(cn=4),Tn===null||(dd&268435455)===0&&(Ab&268435455)===0||Zl(Tn,Rn)}function yb(e,t){var r=vt;vt|=2;var n=n2();(Tn!==e||Rn!==t)&&(tl=null,od(e,t));do try{U9();break}catch(i){r2(e,i)}while(!0);if(lC(),vt=r,gb.current=n,Yr!==null)throw Error(pe(261));return Tn=null,Rn=0,cn}function U9(){for(;Yr!==null;)i2(Yr)}function V9(){for(;Yr!==null&&!vY();)i2(Yr)}function i2(e){var t=s2(e.alternate,e,wo);e.memoizedProps=e.pendingProps,t===null?o2(e):Yr=t,xC.current=null}function o2(e){var t=e;do{var r=t.alternate;if(e=t.return,(t.flags&32768)===0){if(r=L9(r,t,wo),r!==null){Yr=r;return}}else{if(r=_9(r,t),r!==null){r.flags&=32767,Yr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{cn=6,Yr=null;return}}if(t=t.sibling,t!==null){Yr=t;return}Yr=t=e}while(t!==null);cn===0&&(cn=5)}function td(e,t,r){var n=Ot,i=ta.transition;try{ta.transition=null,Ot=1,H9(e,t,r,n)}finally{ta.transition=i,Ot=n}return null}function H9(e,t,r,n){do op();while(tc!==null);if((vt&6)!==0)throw Error(pe(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(pe(177));e.callbackNode=null,e.callbackPriority=0;var o=r.lanes|r.childLanes;if(DY(e,o),e===Tn&&(Yr=Tn=null,Rn=0),(r.subtreeFlags&2064)===0&&(r.flags&2064)===0||$y||($y=!0,l2(Zy,function(){return op(),null})),o=(r.flags&15990)!==0,(r.subtreeFlags&15990)!==0||o){o=ta.transition,ta.transition=null;var a=Ot;Ot=1;var s=vt;vt|=4,xC.current=null,$9(e,r),ZL(r,e),m9(y1),tb=!!v1,y1=v1=null,e.current=r,R9(r,e,i),yY(),vt=s,Ot=a,ta.transition=o}else e.current=r;if($y&&($y=!1,tc=e,vb=i),o=e.pendingLanes,o===0&&(sc=null),xY(r.stateNode,n),qi(e,Wr()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(hb)throw hb=!1,e=z1,z1=null,e;return(vb&1)!==0&&e.tag!==0&&op(),o=e.pendingLanes,(o&1)!==0?e===$1?gg++:(gg=0,$1=e):gg=0,fc(),null}function op(){if(tc!==null){var e=$j(vb),t=ta.transition,r=Ot;try{if(ta.transition=null,Ot=16>e?16:e,tc===null)var n=!1;else{if(e=tc,tc=null,vb=0,(vt&6)!==0)throw Error(pe(331));var i=vt;for(vt|=4,ke=e.current;ke!==null;){var o=ke,a=o.child;if((ke.flags&16)!==0){var s=o.deletions;if(s!==null){for(var l=0;l<s.length;l++){var c=s[l];for(ke=c;ke!==null;){var d=ke;switch(d.tag){case 0:case 11:case 15:mg(8,d,o)}var u=d.child;if(u!==null)u.return=d,ke=u;else for(;ke!==null;){d=ke;var p=d.sibling,m=d.return;if(JL(d),d===c){ke=null;break}if(p!==null){p.return=m,ke=p;break}ke=m}}}var g=o.alternate;if(g!==null){var f=g.child;if(f!==null){g.child=null;do{var y=f.sibling;f.sibling=null,f=y}while(f!==null)}}ke=o}}if((o.subtreeFlags&2064)!==0&&a!==null)a.return=o,ke=a;else e:for(;ke!==null;){if(o=ke,(o.flags&2048)!==0)switch(o.tag){case 0:case 11:case 15:mg(9,o,o.return)}var h=o.sibling;if(h!==null){h.return=o.return,ke=h;break e}ke=o.return}}var v=e.current;for(ke=v;ke!==null;){a=ke;var b=a.child;if((a.subtreeFlags&2064)!==0&&b!==null)b.return=a,ke=b;else e:for(a=v;ke!==null;){if(s=ke,(s.flags&2048)!==0)try{switch(s.tag){case 0:case 11:case 15:Pb(9,s)}}catch(k){Nr(s,s.return,k)}if(s===a){ke=null;break e}var w=s.sibling;if(w!==null){w.return=s.return,ke=w;break e}ke=s.return}}if(vt=i,fc(),Es&&typeof Es.onPostCommitFiberRoot=="function")try{Es.onPostCommitFiberRoot(wb,e)}catch(k){}n=!0}return n}finally{Ot=r,ta.transition=t}}return!1}function pj(e,t,r){t=up(r,t),t=$L(e,t,1),e=ac(e,t,1),t=Si(),e!==null&&(Ig(e,1,t),qi(e,t))}function Nr(e,t,r){if(e.tag===3)pj(e,e,r);else for(;t!==null;){if(t.tag===3){pj(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(sc===null||!sc.has(n))){e=up(r,e),e=RL(t,e,1),t=ac(t,e,1),e=Si(),t!==null&&(Ig(t,1,e),qi(t,e));break}}t=t.return}}function q9(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Si(),e.pingedLanes|=e.suspendedLanes&r,Tn===e&&(Rn&r)===r&&(cn===4||cn===3&&(Rn&130023424)===Rn&&500>Wr()-SC?od(e,0):kC|=r),qi(e,t)}function a2(e,t){t===0&&((e.mode&1)===0?t=1:(t=Cy,Cy<<=1,(Cy&130023424)===0&&(Cy=4194304)));var r=Si();e=ll(e,t),e!==null&&(Ig(e,t,r),qi(e,r))}function G9(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),a2(e,r)}function Y9(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(pe(314))}n!==null&&n.delete(t),a2(e,r)}var s2;s2=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Vi.current)Ui=!0;else{if((e.lanes&r)===0&&(t.flags&128)===0)return Ui=!1,j9(e,t,r);Ui=(e.flags&131072)!==0}else Ui=!1,pr&&(t.flags&1048576)!==0&&uL(t,lb,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;qy(e,t),e=t.pendingProps;var i=sp(t,ri.current);ip(t,r),i=hC(null,t,n,e,i,r);var o=vC();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Hi(n)?(o=!0,ab(t)):o=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,uC(t),i.updater=Db,t.stateNode=i,i._reactInternals=t,D1(t,n,e,r),t=N1(null,t,n,!0,o,r)):(t.tag=0,pr&&o&&iC(t),ki(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(qy(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=J9(n),e=za(n,e),i){case 0:t=A1(null,t,n,e,r);break e;case 1:t=rj(null,t,n,e,r);break e;case 11:t=ej(null,t,n,e,r);break e;case 14:t=tj(null,t,n,za(n.type,e),r);break e}throw Error(pe(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:za(n,i),A1(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:za(n,i),rj(e,t,n,i,r);case 3:e:{if(VL(t),e===null)throw Error(pe(387));n=t.pendingProps,o=t.memoizedState,i=o.element,vL(e,t),ub(t,n,null,r);var a=t.memoizedState;if(n=a.element,o.isDehydrated)if(o={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){i=up(Error(pe(423)),t),t=nj(e,t,n,r,i);break e}else if(n!==i){i=up(Error(pe(424)),t),t=nj(e,t,n,r,i);break e}else for(xo=oc(t.stateNode.containerInfo.firstChild),ko=t,pr=!0,Ra=null,r=gL(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(lp(),n===i){t=cl(e,t,r);break e}ki(e,t,n,r)}t=t.child}return t;case 5:return yL(t),e===null&&T1(t),n=t.type,i=t.pendingProps,o=e!==null?e.memoizedProps:null,a=i.children,b1(n,i)?a=null:o!==null&&b1(n,o)&&(t.flags|=32),UL(e,t),ki(e,t,a,r),t.child;case 6:return e===null&&T1(t),null;case 13:return HL(e,t,r);case 4:return pC(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=cp(t,null,n,r):ki(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:za(n,i),ej(e,t,n,i,r);case 7:return ki(e,t,t.pendingProps,r),t.child;case 8:return ki(e,t,t.pendingProps.children,r),t.child;case 12:return ki(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,o=t.memoizedProps,a=i.value,Qt(cb,n._currentValue),n._currentValue=a,o!==null)if(Ua(o.value,a)){if(o.children===i.children&&!Vi.current){t=cl(e,t,r);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var s=o.dependencies;if(s!==null){a=o.child;for(var l=s.firstContext;l!==null;){if(l.context===n){if(o.tag===1){l=ol(-1,r&-r),l.tag=2;var c=o.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),C1(o.return,r,t),s.lanes|=r;break}l=l.next}}else if(o.tag===10)a=o.type===t.type?null:o.child;else if(o.tag===18){if(a=o.return,a===null)throw Error(pe(341));a.lanes|=r,s=a.alternate,s!==null&&(s.lanes|=r),C1(a,r,t),a=o.sibling}else a=o.child;if(a!==null)a.return=o;else for(a=o;a!==null;){if(a===t){a=null;break}if(o=a.sibling,o!==null){o.return=a.return,a=o;break}a=a.return}o=a}ki(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,ip(t,r),i=ra(i),n=n(i),t.flags|=1,ki(e,t,n,r),t.child;case 14:return n=t.type,i=za(n,t.pendingProps),i=za(n.type,i),tj(e,t,n,i,r);case 15:return WL(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:za(n,i),qy(e,t),t.tag=1,Hi(n)?(e=!0,ab(t)):e=!1,ip(t,r),zL(t,n,i),D1(t,n,i,r),N1(null,t,n,!0,e,r);case 19:return qL(e,t,r);case 22:return BL(e,t,r)}throw Error(pe(156,t.tag))};function l2(e,t){return jj(e,t)}function K9(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ea(e,t,r,n){return new K9(e,t,r,n)}function DC(e){return e=e.prototype,!(!e||!e.isReactComponent)}function J9(e){if(typeof e=="function")return DC(e)?1:0;if(e!=null){if(e=e.$$typeof,e===q1)return 11;if(e===G1)return 14}return 2}function cc(e,t){var r=e.alternate;return r===null?(r=ea(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Ky(e,t,r,n,i,o){var a=2;if(n=e,typeof e=="function")DC(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Uu:return ad(r.children,i,o,t);case H1:a=8,i|=8;break;case XT:return e=ea(12,r,t,i|2),e.elementType=XT,e.lanes=o,e;case QT:return e=ea(13,r,t,i),e.elementType=QT,e.lanes=o,e;case ZT:return e=ea(19,r,t,i),e.elementType=ZT,e.lanes=o,e;case yj:return Nb(r,i,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case hj:a=10;break e;case vj:a=9;break e;case q1:a=11;break e;case G1:a=14;break e;case Jl:a=16,n=null;break e}throw Error(pe(130,e==null?e:typeof e,""))}return t=ea(a,r,t,i),t.elementType=e,t.type=n,t.lanes=o,t}function ad(e,t,r,n){return e=ea(7,e,n,t),e.lanes=r,e}function Nb(e,t,r,n){return e=ea(22,e,n,t),e.elementType=yj,e.lanes=r,e.stateNode={isHidden:!1},e}function YT(e,t,r){return e=ea(6,e,null,t),e.lanes=r,e}function KT(e,t,r){return t=ea(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function X9(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=OT(0),this.expirationTimes=OT(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=OT(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function PC(e,t,r,n,i,o,a,s,l){return e=new X9(e,t,r,s,l),t===1?(t=1,o===!0&&(t|=8)):t=0,o=ea(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},uC(o),e}function Q9(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Bu,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function c2(e){if(!e)return uc;e=e._reactInternals;e:{if(md(e)!==e||e.tag!==1)throw Error(pe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Hi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(pe(171))}if(e.tag===1){var r=e.type;if(Hi(r))return cL(e,r,t)}return t}function d2(e,t,r,n,i,o,a,s,l){return e=PC(r,n,!0,e,i,o,a,s,l),e.context=c2(null),r=e.current,n=Si(),i=lc(r),o=ol(n,i),o.callback=t!=null?t:null,ac(r,o,i),e.current.lanes=i,Ig(e,i,n),qi(e,n),e}function Mb(e,t,r,n){var i=t.current,o=Si(),a=lc(i);return r=c2(r),t.context===null?t.context=r:t.pendingContext=r,t=ol(o,a),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=ac(i,t,a),e!==null&&(Ba(e,i,a,o),Uy(e,i,a)),a}function bb(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function mj(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function AC(e,t){mj(e,t),(e=e.alternate)&&mj(e,t)}function Z9(){return null}var u2=typeof reportError=="function"?reportError:function(e){console.error(e)};function NC(e){this._internalRoot=e}Ob.prototype.render=NC.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(pe(409));Mb(e,t,null,null)};Ob.prototype.unmount=NC.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ud(function(){Mb(null,e,null,null)}),t[sl]=null}};function Ob(e){this._internalRoot=e}Ob.prototype.unstable_scheduleHydration=function(e){if(e){var t=Bj();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Ql.length&&t!==0&&t<Ql[r].priority;r++);Ql.splice(r,0,e),r===0&&Vj(e)}};function MC(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Ib(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function fj(){}function eK(e,t,r,n,i){if(i){if(typeof n=="function"){var o=n;n=function(){var c=bb(a);o.call(c)}}var a=d2(t,n,e,0,null,!1,!1,"",fj);return e._reactRootContainer=a,e[sl]=a.current,Tg(e.nodeType===8?e.parentNode:e),ud(),a}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var s=n;n=function(){var c=bb(l);s.call(c)}}var l=PC(e,0,!1,null,null,!1,!1,"",fj);return e._reactRootContainer=l,e[sl]=l.current,Tg(e.nodeType===8?e.parentNode:e),ud(function(){Mb(t,l,r,n)}),l}function Fb(e,t,r,n,i){var o=r._reactRootContainer;if(o){var a=o;if(typeof i=="function"){var s=i;i=function(){var l=bb(a);s.call(l)}}Mb(t,a,e,i)}else a=eK(r,t,e,i,n);return bb(a)}Rj=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=og(t.pendingLanes);r!==0&&(J1(t,r|1),qi(t,Wr()),(vt&6)===0&&(pp=Wr()+500,fc()))}break;case 13:ud(function(){var n=ll(e,1);if(n!==null){var i=Si();Ba(n,e,1,i)}}),AC(e,1)}};X1=function(e){if(e.tag===13){var t=ll(e,134217728);if(t!==null){var r=Si();Ba(t,e,134217728,r)}AC(e,134217728)}};Wj=function(e){if(e.tag===13){var t=lc(e),r=ll(e,t);if(r!==null){var n=Si();Ba(r,e,t,n)}AC(e,t)}};Bj=function(){return Ot};Uj=function(e,t){var r=Ot;try{return Ot=e,t()}finally{Ot=r}};c1=function(e,t,r){switch(t){case"input":if(r1(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=Tb(n);if(!i)throw Error(pe(90));wj(n),r1(n,i)}}}break;case"textarea":kj(e,r);break;case"select":t=r.value,t!=null&&ep(e,!!r.multiple,t,!1)}};Aj=TC;Nj=ud;var tK={usingClientEntryPoint:!1,Events:[jg,Gu,Tb,Dj,Pj,TC]},tg={findFiberByHostInstance:rd,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},rK={bundleType:tg.bundleType,version:tg.version,rendererPackageName:tg.rendererPackageName,rendererConfig:tg.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:dl.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Ij(e),e===null?null:e.stateNode},findFiberByHostInstance:tg.findFiberByHostInstance||Z9,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"&&(rg=__REACT_DEVTOOLS_GLOBAL_HOOK__,!rg.isDisabled&&rg.supportsFiber))try{wb=rg.inject(rK),Es=rg}catch(e){}var rg;Co.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tK;Co.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!MC(t))throw Error(pe(200));return Q9(e,t,null,r)};Co.createRoot=function(e,t){if(!MC(e))throw Error(pe(299));var r=!1,n="",i=u2;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=PC(e,1,!1,null,null,r,!1,n,i),e[sl]=t.current,Tg(e.nodeType===8?e.parentNode:e),new NC(t)};Co.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(pe(188)):(e=Object.keys(e).join(","),Error(pe(268,e)));return e=Ij(t),e=e===null?null:e.stateNode,e};Co.flushSync=function(e){return ud(e)};Co.hydrate=function(e,t,r){if(!Ib(t))throw Error(pe(200));return Fb(null,e,t,!0,r)};Co.hydrateRoot=function(e,t,r){if(!MC(e))throw Error(pe(405));var n=r!=null&&r.hydratedSources||null,i=!1,o="",a=u2;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(o=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=d2(t,null,e,1,r!=null?r:null,i,!1,o,a),e[sl]=t.current,Tg(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new Ob(t)};Co.render=function(e,t,r){if(!Ib(t))throw Error(pe(200));return Fb(null,e,t,!1,r)};Co.unmountComponentAtNode=function(e){if(!Ib(e))throw Error(pe(40));return e._reactRootContainer?(ud(function(){Fb(null,null,e,!1,function(){e._reactRootContainer=null,e[sl]=null})}),!0):!1};Co.unstable_batchedUpdates=TC;Co.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Ib(r))throw Error(pe(200));if(e==null||e._reactInternals===void 0)throw Error(pe(38));return Fb(e,t,r,!1,n)};Co.version="18.3.1-next-f1338f8080-20240426"});var ul=le((Sge,f2)=>{"use strict";function m2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__=="undefined"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(m2)}catch(e){console.error(e)}}m2(),f2.exports=p2()});var Ps=le(OC=>{"use strict";var g2=ul();OC.createRoot=g2.createRoot,OC.hydrateRoot=g2.hydrateRoot;var Tge});var h2,be,Ci=it(()=>{h2=$(W()),be=({variant:e="secondary",size:t="medium",fullWidth:r=!1,className:n="",children:i,...o})=>{let a="journalit-button",s=[a,`${a}--${e}`,`${a}--${t}`,r?`${a}--full-width`:"",n].filter(Boolean).join(" ");return h2.default.createElement("button",{className:s,type:o.type||"button",...o},i)}});async function kt(e,t,r=100){e.metadataCache.getCache(t.path)&&delete e.metadataCache.metadataCache[t.path],await e.vault.cachedRead(t),e.metadataCache.trigger("resolve",t),await new Promise(i=>setTimeout(i,r)),e.metadataCache.trigger("changed",t)}var aK,Ha=it(()=>{aK=require("obsidian")});var fd,gp,Jr=it(()=>{fd=(i=>(i.DEMO="demo",i.EVALUATION="evaluation",i.FUNDED="funded",i.REAL="real",i))(fd||{}),gp={totalTrades:0,winningTrades:0,losingTrades:0,breakEvenTrades:0,winRate:0,totalPnL:0,bestTrade:0,worstTrade:0,profitFactor:0,averageWin:0,averageLoss:0,maxDrawdown:0}});var Z,Bn=it(()=>{Z={}});function Xr(e){let t=e.getDay(),r=t===0?6:t-1,n=new Date(e);return n.setDate(e.getDate()-r),n.setHours(0,0,0,0),n}function jC(e,t=!0){let r=new Date(e);if(!t)return r.setDate(r.getDate()+1),r;r.setDate(r.getDate()+1);let n=r.getDay();return n===0?r.setDate(r.getDate()+1):n===6&&r.setDate(r.getDate()+2),r}function LC(e,t=!0){let r=new Date(e);if(!t)return r.setDate(r.getDate()-1),r;r.setDate(r.getDate()-1);let n=r.getDay();return n===0?r.setDate(r.getDate()-2):n===6&&r.setDate(r.getDate()-1),r}function fl(e){if(e.getFullYear()===2025&&e.getMonth()===2){if(e.getDate()>=10&&e.getDate()<=16)return 11;if(e.getDate()===31)return 14}let t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()));t.setUTCDate(t.getUTCDate()+4-(t.getUTCDay()||7));let r=new Date(Date.UTC(t.getUTCFullYear(),0,1));return Math.ceil(((t.getTime()-r.getTime())/864e5+1)/7)}function Ga(e){return`W${fl(e).toString().padStart(2,"0")}`}function Rb(e){var t,r,n,i,o,a,s,l,c,d;if(e&&e.settings&&e.settings.trade)return e.settings.trade.skipWeekends!==!1;try{if(((n=(r=(t=window.journalitPlugin)==null?void 0:t.settings)==null?void 0:r.trade)==null?void 0:n.skipWeekends)!==void 0)return window.journalitPlugin.settings.trade.skipWeekends;if((o=(i=window.journalitPlugin)==null?void 0:i.settings)!=null&&o.trade){window.journalitPlugin.settings.trade.skipWeekends=!0;try{window.journalitPlugin.saveSettings()}catch(p){console.error("Failed to save settings after setting skipWeekends",p)}return!0}let u=window.JournalitPlugin;if(((l=(s=(a=u==null?void 0:u.instance)==null?void 0:a.settings)==null?void 0:s.trade)==null?void 0:l.skipWeekends)!==void 0)return u.instance.settings.trade.skipWeekends;if((d=(c=u==null?void 0:u.instance)==null?void 0:c.settings)!=null&&d.trade){u.instance.settings.trade.skipWeekends=!0;try{u.instance.saveSettings()}catch(p){console.error("Failed to save settings after setting skipWeekends via static instance",p)}return!0}return!0}catch(u){return console.warn("Error accessing plugin settings, using default (skip weekends)"),!0}}function Qr(e,t=!0){let r;typeof e=="string"?r=new Date(e):r=e;let n=r.getFullYear(),i=r.getMonth(),o=r.getDate(),a=new Date(n,i,o);return t?a.setHours(0,0,0,0):a.setHours(23,59,59,999),a}function Ze(e,t="DDMMYY",r="/"){if(!e)return"Unknown";let n=String(e.getDate()).padStart(2,"0"),i=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getFullYear()).slice(2);switch(t){case"DDMMYY":return`${n}${r}${i}${r}${o}`;case"MMDDYY":return`${i}${r}${n}${r}${o}`;case"YYMMDD":return`${o}${r}${i}${r}${n}`;default:return`${n}${r}${i}${r}${o}`}}function fr(){var e,t,r,n,i,o;try{if((r=(t=(e=window.journalitPlugin)==null?void 0:e.settings)==null?void 0:t.trade)!=null&&r.dateFormat)return window.journalitPlugin.settings.trade.dateFormat;let a=window.JournalitPlugin;return(o=(i=(n=a==null?void 0:a.instance)==null?void 0:n.settings)==null?void 0:i.trade)!=null&&o.dateFormat?a.instance.settings.trade.dateFormat:"DDMMYY"}catch(a){return console.warn("Error accessing date format setting, using default (DDMMYY)",a),"DDMMYY"}}function _C(e){let t=e.getMonth();return Math.floor(t/3)+1}var Yt=it(()=>{});var B2={};xs(B2,{FOCUS_MANAGEMENT_STYLES:()=>R2,ensureFocusManagementStyles:()=>Hg,injectFocusManagementStyles:()=>W2,removeFocusManagementStyles:()=>cK});function W2(){let e="journalit-focus-management-styles",t=document.getElementById(e);t&&t.remove();let r=document.createElement("style");r.id=e,r.type="text/css",r.innerHTML=R2,document.head.insertBefore(r,document.head.firstChild),console.debug("[FocusManagement] Focus management styles injected")}function cK(){let t=document.getElementById("journalit-focus-management-styles");t&&(t.remove(),console.debug("[FocusManagement] Focus management styles removed"))}function Hg(){document.getElementById("journalit-focus-management-styles")||W2()}var R2,Wb=it(()=>{R2=`
  /* Layout containment for focus-managed components - optimized to prevent flickering */
  [data-focus-managed="true"] {
    /* Minimal containment to isolate layout from CodeMirror without causing flicker */
    contain: layout !important;
    
    /* Establish a new stacking context without forced layering */
    position: relative !important;
    z-index: 1 !important;
    
    /* Isolation from parent layout context */
    isolation: isolate !important;
  }

  /* Enhanced isolation for DRC and WeeklyReview containers - STRONGEST possible isolation */
  .drc-container[data-focus-managed="true"],
  .weekly-review-container[data-focus-managed="true"] {
    /* Maximum containment to completely isolate from CodeMirror layout */
    contain: layout style strict !important;
    
    /* Force complete isolation from document flow */
    position: absolute !important;
    
    /* Prevent any layout interaction with CodeMirror */
    z-index: 1000 !important;
    
    /* Force new stacking context to completely isolate from parent layout */
    isolation: isolate !important;
    
    /* Prevent any style inheritance that could cause layout shifts */
    transform-style: flat !important;
    
    /* Ensure stable dimensions */
    box-sizing: border-box !important;
    
    /* Prevent margin collapse and other layout interactions */
    margin: 0 !important;
    padding: 0 !important;
    border: none !important;
    
    /* Ensure visibility and stability */
    opacity: 1 !important;
    visibility: visible !important;
  }

  /* Additional protection during focus management */
  .drc-container[data-focus-managed="true"][data-position-locked="true"],
  .weekly-review-container[data-focus-managed="true"][data-position-locked="true"] {
    /* Emergency position lock - strongest possible isolation */
    position: fixed !important;
    top: var(--locked-top, 0) !important;
    left: var(--locked-left, 0) !important;
    transform: none !important;
    width: var(--locked-width, auto) !important;
    height: var(--locked-height, auto) !important;
  }

  /* Focus-managed interactive elements */
  [data-focus-managed="true"] input,
  [data-focus-managed="true"] select,
  [data-focus-managed="true"] textarea,
  [data-focus-managed="true"] button,
  [data-focus-managed="true"] [role="combobox"],
  [data-focus-managed="true"] [contenteditable="true"] {
    /* Ensure these elements are properly isolated */
    position: relative !important;
    z-index: 2 !important;
    
    /* Prevent focus stealing during updates */
    -webkit-user-select: auto !important;
    -moz-user-select: auto !important;
    user-select: auto !important;
  }

  /* Special handling for checkboxes and radio buttons */
  [data-focus-managed="true"] input[type="checkbox"],
  [data-focus-managed="true"] input[type="radio"] {
    /* Ensure click events are properly captured */
    pointer-events: auto !important;
    z-index: 3 !important;
  }

  /* Dropdown and combobox containers need extra isolation - lightweight */
  [data-focus-managed="true"] .combobox-container,
  [data-focus-managed="true"] [data-combobox-type] {
    /* Minimal isolation without heavy containment */
    position: relative !important;
    z-index: 10 !important;
  }

  /* Open dropdown state gets highest priority */
  [data-focus-managed="true"] .combobox-container[data-is-open="true"],
  [data-focus-managed="true"] [data-combobox-type][data-is-open="true"] {
    z-index: 9999 !important;
    contain: none !important; /* Allow dropdown to escape containment */
  }

  /* CodeMirror focus blocking styles - invisible to prevent flickering */
  .cm-editor[data-focus-blocked="true"],
  .cm-scroller[data-focus-blocked="true"],
  .cm-content[data-focus-blocked="true"],
  .cm-line[data-focus-blocked="true"] {
    /* Temporarily disable pointer events without visual change */
    pointer-events: none !important;
    
    /* No opacity change to prevent visible flickering */
    /* opacity: 0.95 !important; - REMOVED to eliminate flashing */
  }

  /* Tab container isolation - minimal to prevent flicker */
  [data-focus-managed="true"] .shared-tabs-container,
  [data-focus-managed="true"] .drc-tabs-container,
  [data-focus-managed="true"] .weekly-review-tabs-container {
    /* Minimal isolation without heavy containment */
    position: relative !important;
    z-index: 5 !important;
  }

  /* Tab buttons need focus isolation - lightweight */
  [data-focus-managed="true"] .shared-tab,
  [data-focus-managed="true"] .drc-tab,
  [data-focus-managed="true"] .weekly-review-tab {
    /* Ensure tab clicks don't trigger editor focus without heavy containment */
    position: relative !important;
    z-index: 6 !important;
  }

  /* Focus ring enhancement for better visibility */
  [data-focus-managed="true"] *:focus {
    /* Enhanced focus outline to show successful focus retention */
    outline: 2px solid var(--text-accent, #007acc) !important;
    outline-offset: 1px !important;
  }

  /* Prevent focus outline on non-interactive elements */
  [data-focus-managed="true"] div:focus,
  [data-focus-managed="true"] span:focus,
  [data-focus-managed="true"] p:focus {
    outline: none !important;
  }

  /* Grade dropdown specific focus management */
  [data-focus-managed="true"] .drc-note-grade-value,
  [data-focus-managed="true"] select.drc-note-grade-value {
    /* Ensure grade dropdowns maintain focus */
    contain: layout style !important;
    position: relative !important;
    z-index: 15 !important;
  }

  /* Navigation button isolation */
  [data-focus-managed="true"] .drc-nav-button,
  [data-focus-managed="true"] .weekly-review-nav-button {
    /* Prevent navigation clicks from affecting editor focus */
    contain: layout style !important;
    position: relative !important;
    z-index: 7 !important;
  }

  /* Form field isolation - minimal approach */
  [data-focus-managed="true"] .drc-input-group,
  [data-focus-managed="true"] .form-field,
  [data-focus-managed="true"] .field-container {
    /* Minimal isolation without heavy containment */
    position: relative !important;
    z-index: 8 !important;
  }

  /* Performance optimization - minimal to prevent flickering */
  [data-focus-managed="true"] {
    /* Minimal optimization without forced layer creation */
    -webkit-font-smoothing: subpixel-antialiased !important;
  }

  /* Debug styles for development (remove in production) */
  [data-focus-managed="true"][data-debug="true"] {
    border: 2px dashed rgba(0, 255, 0, 0.3) !important;
  }

  [data-focus-managed="true"][data-debug="true"]:before {
    content: "FOCUS MANAGED" !important;
    position: absolute !important;
    top: -20px !important;
    left: 0 !important;
    background: rgba(0, 255, 0, 0.8) !important;
    color: black !important;
    padding: 2px 4px !important;
    font-size: 10px !important;
    z-index: 10000 !important;
  }
`});var YC={};xs(YC,{ensureChartStyles:()=>X2,injectChartStyles:()=>Vb,removeChartStyles:()=>GC});function Vb(){try{if(document.head.querySelector("#journalit-chart-styles"))return;let t=document.createElement("style");t.id="journalit-chart-styles",t.textContent=CK,document.head.appendChild(t)}catch(e){console.error("Error injecting chart styles:",e)}}function GC(){try{let e=document.head.querySelector("#journalit-chart-styles");e&&e.remove()}catch(e){console.error("Error removing chart styles:",e)}}function X2(){Vb()}var CK,Xg=it(()=>{CK=`
/**
 * CSS Variables for chart colors & theming
 * These allow for consistent colors across all charts
 */
:root {
  /* Base chart colors with !important to ensure they're applied */
  --chart-positive: var(--text-success, #43a047) !important;
  --chart-negative: var(--text-error, #e53935) !important;
  --chart-neutral: var(--text-muted, #888888) !important;

  /* Chart background colors */
  --chart-positive-bg: rgba(67, 160, 71, 0.2) !important;
  --chart-negative-bg: rgba(229, 57, 53, 0.2) !important;

  /* Animation timings */
  --chart-animation-duration: 0.8s;
  --chart-animation-function: cubic-bezier(0.19, 1, 0.22, 1);
}

/**
 * Chart container styles
 */
.journalit-chart-container {
  width: 100%;
  height: 100%;
  overflow: hidden;
  border-radius: 8px;
  background-color: transparent;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
  padding: 4px;
}

/**
 * Enhanced tooltip styles
 */
.journalit-chart-tooltip {
  background-color: var(--background-primary);
  border-radius: 10px;
  padding: 14px 18px;
  min-width: 140px;
  border: 1px solid var(--background-modifier-border);
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
  transform: translateY(-4px);
  position: relative;
  animation: tooltipFadeIn 0.2s var(--chart-animation-function);
  z-index: 1000;
}

/* Tooltip date */
.journalit-chart-tooltip-date {
  font-size: 14px;
  font-weight: 500;
  color: var(--text-normal);
  margin-bottom: 8px;
  text-align: center;
  border-bottom: 1px solid var(--background-modifier-border);
  padding-bottom: 6px;
}

/* Main tooltip value */
.journalit-chart-tooltip-value {
  font-size: 20px;
  font-weight: 600;
  text-align: center;
}

.journalit-chart-tooltip-value.positive {
  color: var(--chart-positive);
}

.journalit-chart-tooltip-value.negative {
  color: var(--chart-negative);
}

/* Additional tooltip info */
.journalit-chart-tooltip-info {
  font-size: 12px;
  color: var(--text-muted);
  margin-top: 8px;
  text-align: center;
  font-style: italic;
}

/* Tooltip animation */
@keyframes tooltipFadeIn {
  from {
    opacity: 0;
    transform: translateY(-8px);
  }
  to {
    opacity: 1;
    transform: translateY(-4px);
  }
}

/**
 * Chart SVG elements styling
 */
.recharts-cartesian-grid-horizontal line,
.recharts-cartesian-grid-vertical line {
  stroke: var(--background-modifier-border);
  stroke-opacity: 0.4;
  stroke-dasharray: 3;
}

.recharts-reference-line line {
  stroke: var(--text-normal);
  stroke-opacity: 0.4;
  stroke-dasharray: 3;
  stroke-width: 1.5;
}

/* Ensure profit target line is always green */
.recharts-reference-line.profit-target-line line {
  stroke: var(--chart-positive, var(--text-success, #00b300)) !important;
  stroke-opacity: 1 !important;
  stroke-dasharray: 5 5 !important;
  stroke-width: 2 !important;
}

/* Ensure profit target line label is also green */
.recharts-reference-line.profit-target-line text {
  fill: var(--chart-positive, var(--text-success, #00b300)) !important;
}

/* Axis styling */
.recharts-xAxis .recharts-cartesian-axis-line,
.recharts-yAxis .recharts-cartesian-axis-line {
  stroke: var(--background-modifier-border);
  stroke-opacity: 0.5;
}

.recharts-cartesian-axis-tick-value {
  font-size: 11px;
  font-weight: 500;
  fill: var(--text-muted);
}

/* Active dot styling */
.recharts-active-dot circle,
.recharts-active-dot {
  fill: var(--interactive-accent, #4299e1);
  filter: drop-shadow(0 0 3px rgba(66, 153, 225, 0.6));
}

/* Ensure tooltip position is fixed */
.recharts-tooltip-wrapper {
  pointer-events: none;
  z-index: 1000;
  filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.25));
}

/**
 * Bar chart specific styling
 */
.recharts-bar {
  cursor: pointer;
  transition: opacity 0.3s ease;
}

.recharts-bar-rectangle {
  transition: filter 0.3s ease, transform 0.2s ease;
}

.recharts-bar-rectangle:hover {
  filter: brightness(1.1) drop-shadow(0 0 3px rgba(0, 0, 0, 0.2));
  transform: translateY(-2px);
}

/* Apply rounded corners to bar chart bars */
.recharts-bar-rectangle path {
  border-radius: 2px 2px 0 0;
}

/* Ensure bar chart colors are applied correctly */
.recharts-bar-rectangle[fill^="var(--chart-positive)"] path {
  fill: var(--chart-positive) !important;
}

.recharts-bar-rectangle[fill^="var(--chart-negative)"] path {
  fill: var(--chart-negative) !important;
}

/* Active bar styling */
.recharts-bar-rectangle.recharts-active {
  filter: brightness(1.2) drop-shadow(0 0 6px rgba(0, 0, 0, 0.3));
}

/* Enhanced cursor area for better touch experience */
.recharts-layer.recharts-bar-graphical {
  cursor: pointer;
}

/* Animations for bar charts */
@keyframes barFadeIn {
  from {
    opacity: 0;
    transform: scaleY(0.8);
  }
  to {
    opacity: 1;
    transform: scaleY(1);
  }
}

.recharts-bar-rectangle {
  /* Animation removed to prevent conflict with Recharts' built-in animations */
}

/**
 * Calendar specific animations and styles
 */
@keyframes calendarFadeIn {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes pulseBorder {
  0% {
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2), 0 4px 12px rgba(var(--interactive-accent-rgb), 0.25);
  }
  50% {
    box-shadow: 0 0 0 3px rgba(var(--interactive-accent-rgb), 0.3), 0 4px 15px rgba(var(--interactive-accent-rgb), 0.35);
  }
  100% {
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2), 0 4px 12px rgba(var(--interactive-accent-rgb), 0.25);
  }
}

/* Enhanced today indicator with pulse effect */
.journalit-dashboard-calendar-day.today {
  animation: pulseBorder 2s infinite ease-in-out;
  border: 2px solid var(--interactive-accent) !important;
  z-index: 2 !important;
}

/* Calendar cell hover effect */
.journalit-dashboard-calendar-day:hover,
.journalit-dashboard-calendar-weekly-pnl:hover {
  transform: scale(1.05) !important;
  transition: transform 0.2s ease-out, box-shadow 0.2s ease-out, opacity 0.2s ease-out !important;
  opacity: 1 !important;
  z-index: 5 !important;
}
`});var Z2={};xs(Z2,{ensureSharedComponentStyles:()=>wp,injectSharedComponentStyles:()=>Hb,removeSharedComponentStyles:()=>JC});function Hb(){if(document.head.querySelector("#shared-component-styles"))return;let e=document.createElement("style");e.id="shared-component-styles",e.textContent=DK,document.head.appendChild(e)}function JC(){let e=document.head.querySelector("#shared-component-styles");e&&e.remove()}function wp(){document.head.querySelector("#shared-component-styles")||Hb()}var DK,Qg=it(()=>{DK=`
  /**
  * Container Styles for Reviews
  * Remove unused space - but preserve content area padding
  */
  .review-base-container {
    padding: 0 !important;
    margin: 0 !important;
  }

  /**
  * Navigation Styles
  * Used for navigating between reviews
  */
  .drc-navigation, .weekly-review-navigation, .daily-report-card-navigation {
    width: 100%;
    padding-top: 10px;
    border-top: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1));
  }
  
  .drc-navigation-links, .weekly-review-navigation-links, .daily-report-card-navigation-links {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 8px;
    flex-wrap: wrap;
    width: 100%;
  }
  
  .drc-navigation-button, .weekly-review-navigation-button, .daily-report-card-navigation-button {
    padding: 8px 14px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    cursor: pointer;
    font-size: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    flex: 1;
    text-align: center;
    min-width: 120px;
    box-sizing: border-box;
  }
  
  .drc-navigation-button:hover, .weekly-review-navigation-button:hover, .daily-report-card-navigation-button:hover {
    background-color: var(--background-modifier-hover);
  }
  
  .drc-navigation-button:disabled, .weekly-review-navigation-button:disabled, .daily-report-card-navigation-button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
  
  .nav-icon {
    font-size: 14px;
    line-height: 1;
  }

  /**
  * Goal Tracker Styles
  * Used for goal tracking in DRC and Weekly Review
  */
  .shared-goal-tracker h3 {
    font-size: 1rem !important;
    margin-top: 1rem !important;
    margin-bottom: 0.75rem !important;
    text-align: center !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    padding-bottom: 0.5rem !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
  }

  /* Special styling for Weekly Review's "Previous Week Goals" header */
  .weekly-review-previous-goals h3,
  .weekly-review-preparation .weekly-review-section h3 {
    font-size: 1rem !important;
    margin-top: 1rem !important;
    margin-bottom: 0.75rem !important;
    text-align: center !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    padding-bottom: 0.5rem !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
  }

  .shared-goal-tracker-list {
    display: flex !important;
    flex-direction: column !important;
    gap: 0.5rem !important;
    margin-top: 0.75rem !important;
    padding: 0.5rem !important;
    background-color: var(--background-secondary) !important;
    border-radius: 4px !important;
  }

  .shared-goal-item {
    display: flex !important;
    align-items: center !important;
    gap: 0.5rem !important;
    padding: 0.5rem !important;
    background-color: var(--background-primary) !important;
    border-radius: 4px !important;
    border: 1px solid var(--background-modifier-border) !important;
    cursor: pointer !important;
  }

  .shared-goal-item:hover {
    background-color: var(--background-modifier-hover) !important;
  }

  .shared-goal-checkbox {
    margin: 0 !important;
  }

  .shared-goal-text {
    flex: 1 !important;
    font-size: 0.95rem !important;
  }

  .shared-goal-text.completed {
    text-decoration: line-through !important;
    opacity: 0.7 !important;
    color: var(--text-muted) !important;
  }
  
  /**
  * Empty State Component Styles
  * Used for displaying a friendly message when no data is available
  */
.journalit-empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 24px;
  text-align: center;
  background-color: var(--background-secondary);
  border-radius: 8px;
  min-height: 160px;
  width: 100%;
  height: 100%; /* Added to ensure full height usage */
  color: var(--text-muted);
  animation: fadeIn 0.3s ease-out;
  margin: 0 auto; /* Added to ensure horizontal centering */
}

.journalit-empty-state-icon {
  margin-bottom: 16px;
  opacity: 0.6;
  color: var(--text-muted);
  display: flex; /* Added to ensure icon is centered */
  justify-content: center; /* Added to ensure icon is centered */
}

.journalit-empty-state-content {
  max-width: 280px;
  display: flex; /* Added for better content alignment */
  flex-direction: column; /* Stack content vertically */
  align-items: center; /* Center content horizontally */
  justify-content: center; /* Center content vertically */
}

  .journalit-empty-state-message {
    font-size: 16px;
    font-weight: 500;
    margin: 0 0 8px 0;
    color: var(--text-normal);
  }

  .journalit-empty-state-submessage {
    font-size: 13px;
    opacity: 0.8;
    margin: 0 0 16px 0;
    color: var(--text-muted);
  }
  
  .journalit-empty-state-action-button {
    background-color: var(--interactive-accent) !important;
    color: var(--text-on-accent) !important;
    border: none !important;
    border-radius: 6px !important;
    padding: 0 16px !important;
    font-size: 14px !important;
    font-weight: 600 !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
    margin-top: 16px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    min-width: 120px !important;
    height: 36px !important;
    line-height: 1 !important;
  }
  
  .journalit-empty-state-action-button:hover {
    background-color: var(--interactive-accent-hover) !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
  }

  /* Animation for empty state */
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* Chart-specific empty state styling */
  .journalit-chart-container .journalit-empty-state {
    background-color: transparent;
    border: 1px dashed var(--background-modifier-border);
  }

  /* Table-specific empty state styling */
  .journalit-table-container .journalit-empty-state {
    min-height: 120px;
    padding: 16px;
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
    .journalit-empty-state {
      padding: 16px;
      min-height: 140px;
    }
    
    .journalit-empty-state-icon {
      margin-bottom: 12px;
    }
    
    .journalit-empty-state-message {
      font-size: 14px;
    }
  }

  /**
   * Review Button Styles
   * Shared component for marking content as reviewed
   */
  .review-button-container {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-top: 16px;
  }

  .review-button {
    min-width: 140px;
  }

  .review-timestamp {
    font-size: 0.85em;
    color: var(--text-muted);
    font-style: italic;
  }

  /* Review sections for different review types */
  .drc-eod-review-button-section,
  .weekly-review-mark-reviewed-section,
  .monthly-review-mark-reviewed-section,
  .trade-note-review-section {
    margin-top: 24px;
    padding-top: 20px;
    border-top: 1px solid var(--background-modifier-border);
    display: flex;
    justify-content: center;
    align-items: center;
  }

  /* Ensure consistent styling for the review button in all contexts */
  .drc-eod-review-button-section .review-button-container,
  .weekly-review-mark-reviewed-section .review-button-container,
  .monthly-review-mark-reviewed-section .review-button-container,
  .trade-note-review-section .review-button-container {
    margin-top: 0;
  }

  /**
   * Loading Spinner Styles
   * Shared loading component with animated spinner
   */
  .journalit-loading-spinner {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    padding: 16px;
  }
  
  /* Ensure our spinner is not affected by other spinner styles */
  .journalit-loading-spinner .journalit-spinner-icon::before,
  .journalit-loading-spinner .journalit-spinner-icon::after {
    display: none !important;
  }

  .journalit-loading-spinner.small {
    padding: 8px;
    gap: 8px;
  }

  .journalit-loading-spinner.large {
    padding: 24px;
    gap: 16px;
  }

  .journalit-loading-spinner .journalit-spinner-icon {
    border: 2px solid var(--background-modifier-border);
    border-top-color: var(--interactive-accent);
    border-radius: 50%;
    animation: journalit-spin 0.6s linear infinite;
    flex-shrink: 0;
    /* Ensure perfect circle */
    min-width: var(--spinner-size, 24px);
    min-height: var(--spinner-size, 24px);
    max-width: var(--spinner-size, 24px);
    max-height: var(--spinner-size, 24px);
  }

  .journalit-loading-spinner .loading-message {
    color: var(--text-muted);
    font-size: 14px;
  }

  .journalit-loading-spinner.small .loading-message {
    font-size: 12px;
  }

  .journalit-loading-spinner.large .loading-message {
    font-size: 16px;
  }

  /* Fullscreen loading state */
  .journalit-loading-fullscreen {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
    min-height: 200px;
  }

  /* Overlay loading state */
  .journalit-loading-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.02);
    display: flex;
    align-items: center;
    justify-content: center;
    pointer-events: none;
    z-index: 10;
  }

  .journalit-loading-overlay-content {
    padding: 8px 16px;
    background-color: var(--background-primary);
    border-radius: 6px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  }

  /* Spinner animation */
  @keyframes journalit-spin {
    to { transform: rotate(360deg); }
  }
`});function ZC(){let e=document.getElementById(QC);e&&e.remove();let t=document.createElement("style");t.id=QC,t.textContent=AK,document.head.appendChild(t)}function eE(){let e=document.getElementById(QC);e&&e.remove()}var QC,AK,tE=it(()=>{Bn();QC="onboarding-wizard-modal-styles",AK=`
  .onboarding-wizard-modal {
    position: relative;
    padding: 16px;
    max-width: 500px;
    margin: 0 auto;
    height: fit-content;
    display: flex;
    flex-direction: column;
  }

  .modal-header {
    margin-bottom: 16px;
  }

  .modal-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow-y: visible;
    padding-bottom: 8px; /* Reserve space for skip button */
  }

  .onboarding-slide {
    text-align: center;
  }

  .onboarding-slide h2 {
    margin: 0 0 12px 0;
    font-size: 20px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .onboarding-slide p {
    margin: 0 0 20px 0;
    color: var(--text-muted);
    line-height: 1.4;
  }

  .slide-placeholder {
    padding: 20px;
    border: 2px dashed var(--background-modifier-border);
    border-radius: 8px;
    background: var(--background-secondary);
    margin: 20px 0;
  }

  .slide-placeholder p {
    font-style: italic;
    color: var(--text-muted);
  }

  /* Welcome slide styles */
  .welcome-slide {
    text-align: center;
    padding: 20px 0;
  }

  .welcome-icon {
    font-size: 48px;
    margin-bottom: 16px;
  }

  .welcome-subtitle {
    font-size: 16px;
    color: var(--text-muted);
    margin-bottom: 32px;
    font-weight: 500;
  }

  .welcome-features {
    display: flex;
    flex-direction: column;
    gap: 20px;
    margin: 32px 0;
    text-align: left;
    max-width: 400px;
    margin-left: auto;
    margin-right: auto;
  }

  .feature {
    display: flex;
    align-items: flex-start;
    gap: 12px;
  }

  .feature-icon {
    font-size: 20px;
    flex-shrink: 0;
    margin-top: 2px;
  }

  .feature-text h3 {
    margin: 0 0 4px 0;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .feature-text p {
    margin: 0;
    font-size: 13px;
    color: var(--text-muted);
    line-height: 1.4;
  }

  .welcome-tagline {
    font-size: 14px;
    color: var(--interactive-accent);
    font-weight: 500;
    margin-top: 24px;
  }

  .welcome-trust-indicators {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-top: 20px;
    padding: 16px;
    background: var(--background-secondary);
    border-radius: 8px;
    border: 1px solid var(--background-modifier-border);
  }

  .trust-item {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 12px;
    color: var(--text-normal);
  }

  .trust-icon {
    font-size: 14px;
    flex-shrink: 0;
  }

  .welcome-preview-section {
    margin: 32px 0 24px 0;
  }

  .welcome-preview-section h3 {
    margin: 0 0 16px 0;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-normal);
    text-align: center;
  }

  .insights-preview {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .insight-preview-card {
    padding: 12px;
    background: var(--background-secondary);
    border-radius: 6px;
    border: 1px solid var(--background-modifier-border);
    text-align: left;
  }

  .insight-preview-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 6px;
  }

  .insight-preview-icon {
    font-size: 14px;
    flex-shrink: 0;
  }

  .insight-preview-header strong {
    font-size: 12px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .insight-preview-content {
    font-size: 11px;
    color: var(--text-muted);
    font-style: italic;
    line-height: 1.3;
    padding-left: 22px;
  }

  /* Goal selection styles */
  .goal-slide {
    text-align: center;
  }

  .goal-options {
    display: flex;
    flex-direction: column;
    gap: 16px;
    margin: 24px 0;
    text-align: left;
  }

  .goal-option {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    padding: 16px;
    border: 2px solid var(--background-modifier-border);
    border-radius: 8px;
    background: var(--background-primary);
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .goal-option:hover {
    border-color: var(--interactive-accent-hover);
    background: var(--background-secondary);
  }

  .goal-option.selected {
    border-color: var(--interactive-accent);
    background: var(--background-secondary);
  }

  .goal-radio {
    width: 20px;
    height: 20px;
    border: 2px solid var(--background-modifier-border);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    margin-top: 2px;
  }

  .goal-option.selected .goal-radio {
    border-color: var(--interactive-accent);
  }

  .goal-radio-inner {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: transparent;
    transition: background 0.2s ease;
  }

  .goal-radio-inner.selected {
    background: var(--interactive-accent);
  }

  .goal-content {
    flex: 1;
  }

  .goal-content h3 {
    margin: 0 0 6px 0;
    font-size: 15px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .goal-content p {
    margin: 0 0 8px 0;
    font-size: 13px;
    color: var(--text-muted);
    line-height: 1.4;
  }

  .goal-badge {
    display: inline-block;
    font-size: 11px;
    font-weight: 500;
    color: var(--text-on-accent);
    background: var(--interactive-accent);
    padding: 2px 8px;
    border-radius: 12px;
  }

  .goal-selection-info {
    margin-top: 20px;
    padding: 12px;
    background: var(--background-secondary);
    border-radius: 6px;
    font-size: 14px;
    color: var(--text-normal);
  }

  /* Segmentation slide styles */
  .segmentation-slide {
    text-align: center;
  }

  .segmentation-questions {
    display: flex;
    flex-direction: column;
    gap: 16px;
    margin: 16px 0 0px 0;
    text-align: left;
  }

  .segmentation-question h3 {
    margin: 0 0 8px 0;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-normal);
    text-align: center;
  }

  .multi-select-options {
    display: flex;
    flex-wrap: nowrap;
    gap: 6px;
    justify-content: center;
    overflow-x: auto;
  }

  .multi-select-option {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 6px 10px;
    border: 2px solid var(--background-modifier-border);
    border-radius: 6px;
    background: var(--background-primary);
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: 13px;
    flex-shrink: 0;
  }

  .multi-select-option:hover {
    border-color: var(--interactive-accent-hover);
    background: var(--background-secondary);
  }

  .multi-select-option.selected {
    border-color: var(--interactive-accent);
    background: var(--background-secondary);
    color: var(--interactive-accent);
  }

  .option-checkbox {
    width: 16px;
    height: 16px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 3px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 10px;
    background: var(--background-primary);
  }

  .multi-select-option.selected .option-checkbox {
    border-color: var(--interactive-accent);
    background: var(--interactive-accent);
    color: var(--text-on-accent);
  }

  .radio-options {
    display: flex;
    flex-direction: column;
    gap: 6px;
  }

  .radio-option {
    display: flex;
    align-items: flex-start;
    gap: 10px;
    padding: 10px;
    border: 2px solid var(--background-modifier-border);
    border-radius: 6px;
    background: var(--background-primary);
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .radio-option:hover {
    border-color: var(--interactive-accent-hover);
    background: var(--background-secondary);
  }

  .radio-option.selected {
    border-color: var(--interactive-accent);
    background: var(--background-secondary);
  }

  .option-radio {
    width: 16px;
    height: 16px;
    border: 2px solid var(--background-modifier-border);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    margin-top: 1px;
  }

  .radio-option.selected .option-radio {
    border-color: var(--interactive-accent);
  }

  .radio-inner {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: transparent;
    transition: background 0.2s ease;
  }

  .radio-inner.selected {
    background: var(--interactive-accent);
  }

  .option-content {
    flex: 1;
  }

  .option-label {
    display: block;
    font-size: 13px;
    font-weight: 500;
    color: var(--text-normal);
    margin-bottom: 2px;
  }

  .option-description {
    display: block;
    font-size: 11px;
    color: var(--text-muted);
    line-height: 1.3;
  }

  /* First action slide styles */
  .first-action-slide {
    text-align: center;
  }

  .first-action-icon {
    font-size: 48px;
    margin-bottom: 16px;
  }

  .first-action-content {
    margin: 24px 0;
  }

  .first-action-preview {
    background: var(--background-secondary);
    border-radius: 8px;
    padding: 20px;
    margin: 20px 0;
    text-align: left;
  }

  .first-action-preview h3 {
    margin: 0 0 12px 0;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-normal);
    text-align: center;
  }

  .sample-trade-preview {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .preview-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 0;
    border-bottom: 1px solid var(--background-modifier-border);
  }

  .preview-row:last-child {
    border-bottom: none;
  }

  .preview-label {
    font-weight: 500;
    color: var(--text-muted);
  }

  .preview-value {
    color: var(--text-normal);
  }

  .create-sample-button {
    margin: 20px 0;
  }

  .first-action-note {
    font-size: 12px;
    color: var(--text-muted);
    margin-top: 12px;
  }

  .first-action-success {
    text-align: center;
    margin: 24px 0;
  }

  .success-checkmark {
    font-size: 48px;
    color: var(--color-green);
    margin-bottom: 16px;
  }

  .first-action-success h3 {
    margin: 0 0 12px 0;
    font-size: 16px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .success-actions {
    margin: 20px 0;
    text-align: left;
    max-width: 300px;
    margin-left: auto;
    margin-right: auto;
  }

  .success-action {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 8px 0;
    font-size: 13px;
    color: var(--text-normal);
  }

  .action-icon {
    font-size: 16px;
    flex-shrink: 0;
  }

  .sample-trade-path {
    margin-top: 16px;
    padding: 8px 12px;
    background: var(--background-modifier-border);
    border-radius: 4px;
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
  }

  .sample-trade-path small {
    color: var(--text-muted);
    font-size: 11px;
  }

  .trade-insights {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin: 20px 0;
    text-align: left;
  }

  .insight-card {
    padding: 16px;
    background: var(--background-secondary);
    border-radius: 8px;
    border: 1px solid var(--background-modifier-border);
  }

  .insight-header {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 8px;
  }

  .insight-icon {
    font-size: 16px;
    flex-shrink: 0;
  }

  .insight-header strong {
    font-size: 13px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .insight-detail {
    font-size: 12px;
    color: var(--text-muted);
    line-height: 1.4;
  }

  /* Authentication slide styles */
  .authentication-slide {
    text-align: center;
  }

  .auth-component-wrapper {
    margin: 16px 0;
    padding: 16px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 8px;
    background: var(--background-secondary);
  }

  .auth-success {
    text-align: center;
    margin: 24px 0;
  }

  .auth-success h2 {
    margin: 0 0 12px 0;
    font-size: 18px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .auth-success-info {
    margin: 20px 0;
    text-align: left;
    max-width: 300px;
    margin-left: auto;
    margin-right: auto;
  }

  .success-feature {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 8px 0;
    font-size: 13px;
    color: var(--text-normal);
  }

  /* FTP credentials slide styles */
  .ftp-credentials-slide {
    text-align: center;
  }

  .ftp-icon {
    font-size: 48px;
    margin-bottom: 16px;
  }

  .ftp-security-note {
    margin: 16px 0;
    padding: 12px;
    background: var(--background-secondary);
    border-radius: 6px;
    border: 1px solid var(--color-green);
  }

  .security-highlight {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 13px;
    color: var(--text-normal);
  }

  .security-icon {
    font-size: 16px;
    color: var(--color-green);
    flex-shrink: 0;
  }

  .ftp-generate-section {
    margin: 24px 0;
  }

  .ftp-info {
    background: var(--background-secondary);
    border-radius: 8px;
    padding: 20px;
    margin: 20px 0;
    text-align: left;
  }

  .ftp-info h3 {
    margin: 0 0 12px 0;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-normal);
    text-align: center;
  }

  .ftp-benefits {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .ftp-benefit {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 8px 0;
    font-size: 13px;
    color: var(--text-normal);
  }

  .generate-ftp-button {
    margin: 20px 0;
  }

  .ftp-credentials-display {
    text-align: center;
    margin: 24px 0;
  }

  .ftp-credentials-display h3 {
    margin: 0 0 12px 0;
    font-size: 16px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .credentials-container {
    background: var(--background-secondary);
    border-radius: 8px;
    padding: 20px;
    margin: 20px 0;
    text-align: left;
  }

  .credential-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 0;
    border-bottom: 1px solid var(--background-modifier-border);
  }

  .credential-row:last-child {
    border-bottom: none;
  }

  .credential-label {
    font-weight: 500;
    color: var(--text-muted);
    min-width: 80px;
  }

  .credential-value-container {
    display: flex;
    align-items: center;
    gap: 8px;
    flex: 1;
    justify-content: flex-end;
  }

  .credential-value {
    background: var(--background-modifier-border);
    padding: 4px 8px;
    border-radius: 4px;
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
    font-size: 12px;
    color: var(--text-normal);
    max-width: 150px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  .ftp-setup-note {
    margin-top: 20px;
    padding: 12px;
    background: var(--background-modifier-border);
    border-radius: 6px;
  }

  .ftp-setup-note p {
    margin: 0;
    font-size: 13px;
    color: var(--text-muted);
  }

  /* Completion slide styles */
  .completion-slide {
    text-align: center;
  }

  .completion-celebration {
    font-size: 64px;
    margin-bottom: 16px;
    animation: bounce 1s ease-in-out;
  }

  @keyframes bounce {
    0%, 20%, 60%, 100% {
      transform: translateY(0);
    }
    40% {
      transform: translateY(-10px);
    }
    80% {
      transform: translateY(-5px);
    }
  }

  .completion-summary {
    margin: 24px 0;
    text-align: left;
    max-width: 400px;
    margin-left: auto;
    margin-right: auto;
  }

  .completion-summary h3 {
    margin: 0 0 16px 0;
    font-size: 14px;
    font-weight: 600;
    color: var(--text-normal);
    text-align: center;
  }

  .accomplishments {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .accomplishment {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 8px 12px;
    background: var(--background-secondary);
    border-radius: 6px;
    font-size: 13px;
    color: var(--text-normal);
  }

  .accomplishment-icon {
    font-size: 16px;
    flex-shrink: 0;
  }

  .accomplishment-status {
    margin-left: auto;
    color: var(--color-green);
    font-weight: 600;
  }

  .telemetry-section {
    margin: 32px 0;
    text-align: center;
  }

  .telemetry-section h3 {
    margin: 0 0 8px 0;
    font-size: 16px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .telemetry-section p {
    margin: 0 0 16px 0;
    font-size: 13px;
    color: var(--text-muted);
  }

  .telemetry-option {
    text-align: left;
    max-width: 400px;
    margin: 0 auto;
  }

  .telemetry-checkbox {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    cursor: pointer;
    padding: 12px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    background: var(--background-secondary);
    transition: border-color 0.2s ease;
  }

  .telemetry-checkbox:hover {
    border-color: var(--interactive-accent-hover);
  }

  .telemetry-checkbox input[type="checkbox"] {
    margin: 0;
    width: 16px;
    height: 16px;
    flex-shrink: 0;
  }

  .telemetry-label {
    display: flex;
    flex-direction: column;
    gap: 4px;
  }

  .telemetry-label strong {
    font-size: 13px;
    color: var(--text-normal);
  }

  .telemetry-label small {
    font-size: 11px;
    color: var(--text-muted);
    line-height: 1.3;
  }

  .completion-actions {
    margin: 32px 0 0 0;
  }

  .start-journaling-button {
    margin-bottom: 20px;
    padding: 16px 32px !important;
    font-size: 18px !important;
    font-weight: 600 !important;
    min-width: 240px !important;
    background: linear-gradient(135deg, var(--interactive-accent), var(--interactive-accent-hover)) !important;
    border: 2px solid var(--interactive-accent) !important;
    box-shadow: 0 4px 12px rgba(var(--interactive-accent-rgb, 124, 77, 255), 0.3) !important;
    transform: scale(1);
    transition: all 0.3s ease !important;
  }

  .start-journaling-button:hover:not(:disabled) {
    transform: scale(1.05);
    box-shadow: 0 6px 20px rgba(var(--interactive-accent-rgb, 124, 77, 255), 0.4) !important;
    background: linear-gradient(135deg, var(--interactive-accent-hover), var(--interactive-accent)) !important;
  }

  .start-journaling-button:active {
    transform: scale(0.98);
  }

  .completion-links {
    display: flex;
    justify-content: center;
    gap: 16px;
    flex-wrap: wrap;
  }

  .completion-link {
    color: var(--interactive-accent);
    text-decoration: none;
    font-size: 12px;
    padding: 4px 8px;
    border-radius: 4px;
    transition: background-color 0.2s ease;
  }

  .completion-link:hover {
    background: var(--interactive-accent-hover);
    color: var(--text-on-accent);
  }

  .wizard-progress-container {
    margin-bottom: 16px;
  }

  .wizard-steps {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
  }

  .wizard-step {
    display: flex;
    flex-direction: column;
    align-items: center;
    flex: 1;
    position: relative;
  }

  .wizard-step-circle {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: var(--background-modifier-border);
    color: var(--text-muted);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    font-weight: 600;
    transition: all 0.2s ease;
  }

  .wizard-step.current .wizard-step-circle {
    background: var(--interactive-accent);
    color: var(--text-on-accent);
  }

  .wizard-step.completed .wizard-step-circle {
    background: var(--color-green);
    color: white;
  }

  .wizard-step-label {
    margin-top: 8px;
    font-size: 12px;
    color: var(--text-muted);
    text-align: center;
    max-width: 110px;

    /* keep every label exactly two lines high */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 2;
    overflow: hidden;
    line-height: 1.2;
    min-height: 2.4em;
  }

  .wizard-progress-track {
    height: 4px;
    background: var(--background-modifier-border);
    border-radius: 2px;
    overflow: hidden;
  }

  .wizard-progress-fill {
    height: 100%;
    background: var(--interactive-accent);
    transition: width 0.3s ease;
  }

  .modal-error {
    margin: 16px 0;
    padding: 8px 12px;
    background: var(--background-modifier-error);
    border: 1px solid var(--text-error);
    border-radius: 4px;
    color: var(--text-on-accent, #ffffff);
    font-size: 13px;
    font-weight: 500;
    text-align: center;
  }

  .modal-actions {
    display: flex;
    gap: 12px;
    margin-top: 0px;
    justify-content: center;
    flex-wrap: wrap;
  }

  .modal-actions button {
    min-width: 90px;
  }

  .modal-footer {
    margin-top: 0px;
    padding-top: 0px;
    border-top: none;
  }

  .modal-footer-text {
    margin: 0;
    font-size: 12px;
    color: var(--text-muted);
    line-height: 1.3;
    text-align: center;
  }

  /* Skip-link: small, subtle, bottom-right */
  .skip-link {
    position: absolute;
    bottom: 16px;
    right: 20px;
    background: none;
    border: none;
    font-size: 12px;
    color: var(--text-muted);
    cursor: pointer;
    padding: 4px 8px;
    border-radius: 4px;
    transition: all 0.2s ease;
    z-index: 10; /* Ensure it stays above other content */
  }
  
  .skip-link:hover {
    color: var(--interactive-accent);
    background: var(--background-modifier-hover);
    text-decoration: none;
  }
  
  .skip-link:focus {
    outline: 2px solid var(--interactive-accent);
    outline-offset: 2px;
  }
  
  .skip-link:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
  }

  @media (max-width: 480px) {
    .onboarding-wizard-modal {
      padding: 16px;
      max-width: 100%;
    }
    
    .modal-actions {
      flex-direction: column;
    }
    
    .modal-actions button {
      width: 100%;
    }

    .wizard-step-label {
      display: none;
    }
    
    .skip-link {
      position: static;
      margin-top: 16px;
      text-align: center;
      display: block;
      width: fit-content;
      margin-left: auto;
      margin-right: auto;
    }
  }
`;Z.onboardingWizardModal={inject:ZC,remove:eE}});var hl,Or,bd=it(()=>{hl=$(W());Qg();Or=({message:e="Loading...",size:t="medium",fullscreen:r=!1,overlay:n=!1})=>{(0,hl.useEffect)(()=>{wp()},[]);let i=t==="small"?16:t==="large"?32:24,o=hl.default.createElement("div",{className:`journalit-loading-spinner ${t}`,style:{"--spinner-size":`${i}px`}},hl.default.createElement("div",{className:"journalit-spinner-icon"}),e&&hl.default.createElement("span",{className:"loading-message"},e));return n?hl.default.createElement("div",{className:"journalit-loading-overlay"},hl.default.createElement("div",{className:"journalit-loading-overlay-content"},o)):r?hl.default.createElement("div",{className:"journalit-loading-fullscreen"},o):o}});function ew(e,t=200){typeof window!="undefined"&&"requestIdleCallback"in window?window.requestIdleCallback(()=>{try{e()}catch(r){console.error("Error in idle scheduled function:",r)}}):setTimeout(()=>{try{e()}catch(r){console.error("Error in scheduled function:",r)}},t)}function oh(e,t=100){return new Promise(r=>{if(e.length===0){r();return}let n=0;function i(){if(n>=e.length){r();return}try{let o=e[n++];o(),n<e.length?setTimeout(i,t):r()}catch(o){console.error(`Error in scheduled operation at index ${n-1}:`,o),setTimeout(i,t)}}i()})}var tw=it(()=>{});var sE,rw,w_=it(()=>{sE=require("obsidian");tw();rw=class{constructor(t,r,n={}){this.indexes=new Map;this.indexConfigs=new Map;this.filePathMap=new Map;this.buildingIndexes=new Set;this.processedFiles=new Set;this.isDirty=!1;this.persistIndexes=!0;this.isInitialized=!1;this.pendingFileChanges=[];this.BASE_FOLDER=".journalit";this.INDEX_FOLDER="indexes";var i;this.app=t,this.dataExtractor=r,this.persistIndexes=(i=n.persistIndexes)!=null?i:!0,this.boundHandleFileChange=this.handleFileChange.bind(this),this.app.vault.on("create",this.boundHandleFileChange),this.app.vault.on("modify",this.boundHandleFileChange),this.app.vault.on("delete",this.boundHandleFileChange),this.app.vault.on("rename",this.boundHandleFileChange)}async initialize(){if(!this.isInitialized)try{let t=`${this.BASE_FOLDER}/${this.INDEX_FOLDER}`;await this.app.vault.adapter.exists(t)||await this.app.vault.adapter.mkdir(t),this.persistIndexes&&await this.loadIndexes(),this.isInitialized=!0;for(let r of this.pendingFileChanges)this.handleFileChange(r);this.pendingFileChanges=[],this.persistIndexes&&setInterval(()=>this.saveIndexes(),5*60*1e3)}catch(t){console.error("Failed to initialize index manager:",t)}}registerIndex(t){this.indexConfigs.set(t.name,t),this.indexes.has(t.name)||this.indexes.set(t.name,[]),this.buildingIndexes.has(t.name)||this.buildIndex(t.name)}getIndex(t){return this.indexes.get(t)||[]}queryIndex(t,r={},n={}){let i=this.indexes.get(t);if(!i)return[];let o=i.filter(a=>Object.entries(r).every(([s,l])=>Array.isArray(a.values[s])?Array.isArray(l)?l.some(c=>a.values[s].includes(c)):a.values[s].includes(l):a.values[s]===l));if(n.sort){let{field:a,direction:s}=n.sort;o.sort((l,c)=>{let d=l.values[a],u=c.values[a];if(d===u)return 0;if(d===void 0)return s==="asc"?-1:1;if(u===void 0)return s==="asc"?1:-1;let p=d<u?-1:1;return s==="asc"?p:-p})}return n.offset!==void 0&&n.offset>0&&(o=o.slice(n.offset)),n.limit!==void 0&&n.limit>0&&(o=o.slice(0,n.limit)),o}getUniqueValues(t,r){let n=this.indexes.get(t);if(!n)return[];let i=new Set;for(let o of n){let a=o.values[r];Array.isArray(a)?a.forEach(s=>i.add(s)):a!=null&&i.add(a)}return Array.from(i)}async buildIndex(t){if(!this.buildingIndexes.has(t)){this.buildingIndexes.add(t);try{let r=this.indexConfigs.get(t);if(!r){console.error(`No config found for index: ${t}`),this.buildingIndexes.delete(t);return}let n=this.app.vault.getFiles(),i=r.fileFilter?n.filter(r.fileFilter):n.filter(s=>s.extension==="md"),o=20,a=[];for(let s=0;s<i.length;s+=o){let l=i.slice(s,s+o);a.push(l)}this.indexes.set(t,[]);for(let s of a){let l=s.map(c=>async()=>{if(!this.processedFiles.has(c.path))try{await this.indexFile(c,t),this.processedFiles.add(c.path)}catch(d){console.error(`Error indexing file ${c.path}:`,d)}});for(let c=0;c<l.length;c++)await l[c](),c%5===0&&c>0&&await new Promise(d=>setTimeout(d,10))}this.isDirty=!0}catch(r){console.error(`Error building index ${t}:`,r)}finally{this.buildingIndexes.delete(t),this.persistIndexes&&this.saveIndexes()}}}async indexFile(t,r){let n=this.indexConfigs.get(r);if(n&&!(n.fileFilter&&!n.fileFilter(t)))try{let i=await this.dataExtractor(t);if(!i)return;let o={};for(let d of n.fields)n.valueExtractor?o[d]=n.valueExtractor(i,d):n.includeNested?o[d]=this.getNestedValue(i,d):o[d]=i[d];let a={data:i,file:t,values:o},s=this.indexes.get(r)||[],l=-1;this.filePathMap.has(t.path)||this.filePathMap.set(t.path,new Map);let c=this.filePathMap.get(t.path);if(c.has(r)&&(l=c.get(r)),l>=0&&l<s.length)s[l]=a;else{let d=s.length;s.push(a),c.set(r,d)}this.indexes.set(r,s),this.isDirty=!0}catch(i){console.error(`Error indexing file ${t.path} for index ${r}:`,i)}}removeFileFromIndexes(t){if(!this.filePathMap.has(t))return;let r=this.filePathMap.get(t);for(let[n,i]of r.entries()){let o=this.indexes.get(n);if(o&&i>=0&&i<o.length){let a=o.length-1;if(i!==a){let s=o[a];o[i]=s;let l=s.file.path;if(this.filePathMap.has(l)){let c=this.filePathMap.get(l);c.has(n)&&c.set(n,i)}}o.pop(),this.isDirty=!0}}this.filePathMap.delete(t),this.processedFiles.delete(t)}handleFileChange(t){if(!(!("path"in t)||t.path.includes(`${this.BASE_FOLDER}/${this.INDEX_FOLDER}`))){if(!this.isInitialized){this.pendingFileChanges.push(t);return}ew(async()=>{try{if(t instanceof sE.TFile){if(t.extension!=="md")return;for(let r of this.indexConfigs.keys())this.buildingIndexes.has(r)||await this.indexFile(t,r)}else this.removeFileFromIndexes(t.path);this.isDirty&&this.persistIndexes&&setTimeout(()=>this.saveIndexes(),2e3)}catch(r){console.error(`Error handling file change for ${t.path}:`,r)}})}}getNestedValue(t,r){return r.split(".").reduce((n,i)=>n&&n[i]!==void 0?n[i]:void 0,t)}async saveIndexes(){if(!(!this.isDirty||!this.persistIndexes))try{let t=`${this.BASE_FOLDER}/${this.INDEX_FOLDER}`;await this.app.vault.adapter.exists(t)||await this.app.vault.adapter.mkdir(t);for(let[r,n]of this.indexes.entries()){let i={name:r,entries:n.map(a=>({path:a.file.path,values:a.values}))},o=`${t}/${r}.json`;await this.app.vault.adapter.write(o,JSON.stringify(i))}this.isDirty=!1}catch(t){console.error("Failed to save indexes:",t)}}async loadIndexes(){try{let t=`${this.BASE_FOLDER}/${this.INDEX_FOLDER}`;if(!await this.app.vault.adapter.exists(t))return;let{files:r}=await this.app.vault.adapter.list(t);for(let n of r)try{let i=await this.app.vault.adapter.read(n),o=JSON.parse(i);if(!o.name||!Array.isArray(o.entries)){console.warn(`Invalid index file format: ${n}`);continue}let a=o.name;this.indexes.set(a,[]);for(let s=0;s<o.entries.length;s++){let l=o.entries[s],c=l.path,d=this.app.vault.getAbstractFileByPath(c);if(!d||!(d instanceof sE.TFile))continue;let u={data:null,file:d,values:l.values},p=this.indexes.get(a);p.push(u),this.filePathMap.has(c)||this.filePathMap.set(c,new Map),this.filePathMap.get(c).set(a,p.length-1),this.processedFiles.add(c)}}catch(i){console.error(`Failed to load index file ${n}:`,i)}}catch(t){console.error("Failed to load indexes:",t)}}unload(){this.app.vault.off("create",this.boundHandleFileChange),this.app.vault.off("modify",this.boundHandleFileChange),this.app.vault.off("delete",this.boundHandleFileChange),this.app.vault.off("rename",this.boundHandleFileChange),this.persistIndexes&&this.isDirty&&this.saveIndexes(),this.indexes.clear(),this.indexConfigs.clear(),this.filePathMap.clear(),this.processedFiles.clear(),this.pendingFileChanges=[]}}});var x_={};xs(x_,{CustomDataService:()=>Ao});var xc,Ao,Sd=it(()=>{w_();Ha();xc=class xc{constructor(t,r={}){this.app=t;this.indexManager=null;this.config={folder:r.folder||"",extension:r.extension||".md",cacheTTL:r.cacheTTL||xc.DEFAULT_CACHE_TTL,persistCache:r.persistCache!==void 0?r.persistCache:!0,namespace:r.namespace||"default",enableIndexing:r.enableIndexing!==void 0?r.enableIndexing:!0,indexes:r.indexes||[]},this.cache=new Map,this.isCacheInvalidated=!1,this.boundHandleFileChange=this.handleFileChange.bind(this),this.config.enableIndexing&&this.setupIndexing(),this.initializeService()}setupIndexing(){if(xc.sharedIndexManager?this.indexManager=xc.sharedIndexManager:(this.indexManager=new rw(this.app,async t=>{try{return await this.readFrontmatter(t)}catch(r){return console.error(`Error extracting data from ${t.path}:`,r),null}}),xc.sharedIndexManager=this.indexManager,this.indexManager.initialize()),this.config.indexes.length>0)for(let t of this.config.indexes)this.indexManager.registerIndex(t)}async initializeService(){await this.loadPersistentCache(),this.app.vault.on("create",this.boundHandleFileChange),this.app.vault.on("modify",this.boundHandleFileChange),this.app.vault.on("delete",this.boundHandleFileChange),this.app.vault.on("rename",this.boundHandleFileChange)}getNamespacedKey(t){return`${this.config.namespace}:${t}`}async query(t,r,n={},i){let{useCache:o=!0,cacheTTL:a=this.config.cacheTTL,offlineCapable:s=!0,useIndexes:l=!0}=n,c=this.getNamespacedKey(r);try{if(o&&!this.isCacheInvalidated){let u=this.getCached(c,a);if(u!==null)return u}if(l&&this.indexManager&&i)try{let u=this.indexManager.queryIndex(i.indexName,i.filters||{},{sort:i.sort,limit:i.limit,offset:i.offset});if(u.length>0){let p=u.filter(g=>g.data!==null&&g.data!==void 0),m;return p.length===u.length?(m=u.map(g=>g.data||null).filter(Boolean),m.length===1&&!Array.isArray(t)&&(m=m[0])):m=(await Promise.all(u.map(async f=>{try{return await this.readFrontmatter(f.file)}catch(y){return console.error(`Error loading data from file ${f.file.path}:`,y),null}}))).filter(Boolean),o&&(this.setCache(c,m),this.isCacheInvalidated=!1),m}}catch(u){console.warn(`Error using index for query ${r}:`,u)}let d=await t();return o&&(this.setCache(c,d),this.isCacheInvalidated=!1),d}catch(d){if(s&&o){let u=this.getCached(c,1/0);if(u!==null)return u}throw this.handleError(d)}}getCached(t,r){let n=this.cache.get(t);if(!n)return null;let{data:i,timestamp:o}=n;return Date.now()-o>r?(this.cache.delete(t),null):i}setCache(t,r){let n={data:r,timestamp:Date.now()};this.cache.set(t,n),this.config.persistCache&&this.savePersistentCache()}getCacheFilePath(){return`.journalit/cache/${this.config.namespace}-cache.json`}async loadPersistentCache(){try{let t=this.getCacheFilePath();if(await this.app.vault.adapter.exists(t)){let n=await this.app.vault.adapter.read(t);try{let i=JSON.parse(n);Object.entries(i).forEach(([o,a])=>{this.cache.set(o,a)})}catch(i){console.warn(`Failed to parse cache data for namespace ${this.config.namespace}:`,i instanceof Error?i.message:"Invalid JSON")}}}catch(t){let r=t instanceof Error?t.message:String(t);console.warn(`Failed to load persistent cache for namespace ${this.config.namespace}:`,r)}}async savePersistentCache(){try{let t=this.getCacheFilePath();await this.app.vault.adapter.mkdir(".journalit/cache");let r=Array.from(this.cache.entries()).filter(([i])=>i.startsWith(`${this.config.namespace}:`)),n=Object.fromEntries(r);await this.app.vault.adapter.write(t,JSON.stringify(n))}catch(t){console.warn(`Failed to save persistent cache for namespace ${this.config.namespace}:`,t instanceof Error?t.message:"Unknown error")}}async handleFileChange(t){if(!("path"in t)||t.path.includes("journalit/cache")||this.config.folder&&!t.path.startsWith(this.config.folder)||this.config.extension&&!t.path.endsWith(this.config.extension))return;let r=t.path.split("/"),n=r[r.length-1],i="";t.path.includes("/trades/")?i="trade:":t.path.includes("/Accounts/")?i="account:":t.path.includes("/DRC/")?i="drc:":t.path.includes("/Weekly/")&&(i="weekly:"),i?(this.config.namespace==="default"||i.startsWith(this.config.namespace)||this.config.namespace===i.replace(":",""))&&await this.clearCacheWithPrefix(i):this.config.namespace==="default"&&(this.isCacheInvalidated=!0,await this.clearCache())}handleError(t){return t instanceof Error?t:new Error("An unknown error occurred")}async clearCache(){this.isCacheInvalidated=!0;let t=`${this.config.namespace}:`;for(let r of this.cache.keys())r.startsWith(t)&&this.cache.delete(r);if(this.config.persistCache)try{let r=this.getCacheFilePath();await this.app.vault.adapter.write(r,JSON.stringify({}))}catch(r){console.warn(`Failed to clear persistent cache for namespace ${this.config.namespace}:`,r instanceof Error?r.message:"Unknown error")}}async clearCacheKey(t){let r=this.getNamespacedKey(t);this.cache.delete(r)&&this.config.persistCache&&await this.savePersistentCache()}async clearCacheWithPrefix(t){let r=this.getNamespacedKey(t),n=!1;for(let i of this.cache.keys())i.startsWith(r)&&(this.cache.delete(i),n=!0);n&&this.config.persistCache&&await this.savePersistentCache()}invalidateCache(){this.isCacheInvalidated=!0}getFiles(){return this.app.vault.getFiles().filter(r=>!(this.config.folder&&!r.path.startsWith(this.config.folder)||this.config.extension&&!r.path.endsWith(this.config.extension)))}registerIndex(t){if(!this.indexManager){console.warn("Index manager not initialized. Enable indexing in service config.");return}this.indexManager.registerIndex(t)}queryIndex(t,r={},n={}){return this.indexManager?this.indexManager.queryIndex(t,r,n):[]}getUniqueIndexValues(t,r){return this.indexManager?this.indexManager.getUniqueValues(t,r):[]}isIndexingEnabled(){return this.config.enableIndexing&&this.indexManager!==null}async readFrontmatter(t){try{let r=this.app.metadataCache.getFileCache(t);if(r!=null&&r.frontmatter)return JSON.parse(JSON.stringify(r.frontmatter));let i=(await this.app.vault.read(t)).match(/^---\n([\s\S]*?)\n---/);if(!i)return{};try{return this.parseYamlFrontmatter(i[1])}catch(o){return console.warn(`Failed to parse frontmatter with advanced parser for ${t.path}:`,o),this.simpleYamlParse(i[1])}}catch(r){return console.error(`Failed to parse frontmatter for ${t.path}:`,r),{}}}parseYamlFrontmatter(t){let r={},n=null,i=null,o=!1,a=[],s=null,l=0,c=t.split(`
`);for(let d=0;d<c.length;d++){let u=c[d];if(!u.trim())continue;let p=u.search(/\S|$/);if(p===0&&u.includes(":")){o&&n&&(r[n]=a,o=!1,a=[]);let[m,g]=this.parseKeyValue(u);if(n=m,g==="")if(d+1<c.length){let f=c[d+1];f.search(/\S|$/)>p||f.trim().startsWith("-")?(o=!1,i=null):(r[m]="",n=null)}else r[m]="",n=null;else if(g==="|"){let f="",y=-1;for(let h=d+1;h<c.length;h++){let v=c[h],b=v.search(/\S|$/);if(b===0&&v.trim()!=="")break;y===-1&&v.trim()!==""&&(y=b),(v.trim()!==""||f!=="")&&(f!==""&&(f+=`
`),f+=v.substring(y)),d=h}r[m]=f.trimEnd(),n=null}else g.startsWith("[")&&g.endsWith("]")?(r[m]=g.slice(1,-1).split(",").map(f=>f.trim()).filter(Boolean),n=null):(g==='""'||g==="''"?r[m]="":r[m]=g,n=null)}else if(u.trim().startsWith("-")&&n){let m=u.indexOf("-");o=!0,l=m;let g=u.substring(m+1).trim();if(!g)s={},a.push(s);else if(g.includes(":")){s={},a.push(s);let[f,y]=this.parseKeyValue(g);s&&(s[f]=y)}else a.push(g),s=null}else if(s&&u.trim().includes(":")&&u.search(/\S|$/)>l){let[m,g]=this.parseKeyValue(u);s[m.trim()]=g}else if(u.includes(":")&&n){let[m,g]=this.parseKeyValue(u);(typeof r[n]!="object"||r[n]===null)&&(r[n]={}),r[n][m.trim()]=g}}return o&&n&&(r[n]=a),r}parseKeyValue(t){let r=t.indexOf(":");if(r===-1)return[t.trim(),""];let n=t.slice(0,r).trim(),i=t.slice(r+1).trim();return[n,i]}simpleYamlParse(t){let r={};return t.split(`
`).forEach(n=>{if(!n.trim())return;let i=n.indexOf(":");if(i===-1)return;let o=n.slice(0,i).trim(),a=n.slice(i+1).trim();if(a.startsWith("[")&&a.endsWith("]"))r[o]=a.slice(1,-1).split(",").map(s=>s.trim()).filter(Boolean);else if(n.startsWith("  ")&&o.startsWith("  ")){let s=Object.keys(r).pop();s&&!Array.isArray(r[s])&&(typeof r[s]!="object"&&(r[s]={}),r[s][o.trim()]=a)}else r[o]=a}),r}async updateFrontmatter(t,r){try{let n=await this.app.vault.read(t);if(!n.match(/^---\n([\s\S]*?)\n---/)){let d=`---
${this.generateFrontmatter(r)}
---

${n}`;await this.app.vault.modify(t,d),await kt(this.app,t);return}let a={...await this.readFrontmatter(t),...r},s=this.generateFrontmatter(a),l=n.replace(/^---\n[\s\S]*?\n---/,`---
${s}
---`);await this.app.vault.modify(t,l),await kt(this.app,t)}catch(n){throw console.error(`Failed to update frontmatter for ${t.path}:`,n),new Error(`Failed to update frontmatter: ${n instanceof Error?n.message:String(n)}`)}}generateFrontmatter(t){return Object.entries(t).map(([r,n])=>{if(Array.isArray(n)&&(n.length===0||typeof n[0]!="object"))return`${r}: [${n.join(", ")}]`;if(Array.isArray(n)&&typeof n[0]=="object"){let i=`${r}:`;return n.forEach(o=>{i+=`
  - `;let a=Object.entries(o);if(a.length>0){let[s,l]=a[0];i+=`${s}: ${l}`;for(let c=1;c<a.length;c++){let[d,u]=a[c];i+=`
    ${d}: ${u}`}}}),i}else{if(typeof n=="object"&&n!==null)return`${r}:
${Object.entries(n).map(([i,o])=>`  ${i}: ${o}`).join(`
`)}`;if(typeof n=="string"&&n.includes(`
`)){let i=n.split(`
`),o=`${r}: |`;return i.forEach(a=>{o+=`
  `+a}),o}return n===""?`${r}: ""`:`${r}: ${n}`}}).join(`
`)}};xc.DEFAULT_CACHE_TTL=5*60*1e3,xc.sharedIndexManager=null;Ao=xc});function W_(e){var t,r,n,i,o,a,s,l;if((r=(t=e==null?void 0:e.settings)==null?void 0:t.trade)!=null&&r.tradingDayCutoffTime)return e.settings.trade.tradingDayCutoffTime;try{if((o=(i=(n=window.journalitPlugin)==null?void 0:n.settings)==null?void 0:i.trade)!=null&&o.tradingDayCutoffTime)return window.journalitPlugin.settings.trade.tradingDayCutoffTime;let c=window.JournalitPlugin;return(l=(s=(a=c==null?void 0:c.instance)==null?void 0:a.settings)==null?void 0:s.trade)!=null&&l.tradingDayCutoffTime?c.instance.settings.trade.tradingDayCutoffTime:"00:00"}catch(c){return console.warn("Error getting trading day cutoff time, using default (00:00)",c),"00:00"}}function B_(e){try{let[t,r]=e.split(":"),n=parseInt(t,10),i=parseInt(r,10);return isNaN(n)||isNaN(i)||n<0||n>23||i<0||i>59?(console.warn(`Invalid cutoff time format: ${e}, using 00:00`),{hours:0,minutes:0}):{hours:n,minutes:i}}catch(t){return console.warn(`Error parsing cutoff time: ${e}, using 00:00`,t),{hours:0,minutes:0}}}function st(e,t){let r=W_(t),{hours:n,minutes:i}=B_(r),o=new Date(e);return(o.getHours()<n||o.getHours()===n&&o.getMinutes()<i)&&o.setDate(o.getDate()-1),o.setHours(0,0,0,0),o}function U_(e,t,r){let n=st(e,r),i=st(t,r);return n.getFullYear()===i.getFullYear()&&n.getMonth()===i.getMonth()&&n.getDate()===i.getDate()}function gw(e,t){let r=W_(t),{hours:n,minutes:i}=B_(r),o=st(e,t),a=new Date(o);a.setHours(n,i,0,0);let s=new Date(a);return s.setDate(s.getDate()+1),{start:a,end:s}}function xl(e,t){let r=st(e,t),n=r.getFullYear(),i=String(r.getMonth()+1).padStart(2,"0"),o=String(r.getDate()).padStart(2,"0");return`${n}-${i}-${o}`}function V_(e){let[t,r,n]=e.split("-").map(Number),i=new Date(t,r-1,n);return i.setHours(0,0,0,0),i}var oi=it(()=>{});function bE(){var e,t,r,n;if(typeof window!="undefined")try{let i=window.journalitPlugin||((t=(e=app==null?void 0:app.plugins)==null?void 0:e.plugins)==null?void 0:t.journalit);if((n=(r=i==null?void 0:i.settings)==null?void 0:r.backendIntegration)!=null&&n.serverUrl)return i.settings.backendIntegration.serverUrl}catch(i){}return iz}var yE,iz,Te,kl=it(()=>{yE=require("obsidian"),iz="http://91.99.99.169";Te=class{static setAuthToken(t){this.authToken=t}static getAuthToken(){return this.authToken}static requiresAuth(t){return["/api/v1/trades","/api/v1/mt-accounts","/api/v1/obsidian/status","/api/v1/obsidian/register-vault","/api/v1/ftp-users","/api/v1/sync/ftp","/api/v1/telemetry/preferences"].some(n=>t.includes(n))}static getHeaders(t={}){let r={"Content-Type":"application/json","Accept-Language":"en-US",...t};return this.authToken&&this.requiresAuth(t["x-endpoint"]||"")&&(r.Authorization=`Bearer ${this.authToken}`),delete r["x-endpoint"],r}static async makeRequest(t,r={},n="API call",i=0){if(r.method==="GET"||!r.method){let l=this.getCachedResponse(t);if(l!==null)return l}let o={...r.headers,"x-endpoint":t},a=this.getHeaders(o),s={...r,headers:a};return new Promise((l,c)=>{let d={url:t,options:s,context:n,resolve:l,reject:c,retryCount:0,priority:i};this.requestQueue.push(d),this.requestQueue.sort((u,p)=>p.priority-u.priority),this.isProcessingQueue||this.processQueue()})}static async processQueue(){if(!this.isProcessingQueue){for(this.isProcessingQueue=!0;this.requestQueue.length>0&&this.activeRequests<this.MAX_CONCURRENT_REQUESTS;){let r=Date.now()-this.lastRequestTime;r<this.RATE_LIMIT_DELAY_MS&&await new Promise(i=>setTimeout(i,this.RATE_LIMIT_DELAY_MS-r));let n=this.requestQueue.shift();n&&(this.activeRequests++,this.lastRequestTime=Date.now(),this.executeRequest(n).finally(()=>{this.activeRequests--,this.requestQueue.length>0&&this.processQueue()}))}this.isProcessingQueue=!1}}static async executeRequest(t){var r,n;try{let i=await fetch(t.url,t.options);if(!i.ok){if((i.status===429||i.status>=500)&&t.retryCount<this.MAX_RETRY_ATTEMPTS){await this.retryRequest(t);return}throw new Error(`API Error: ${i.status} ${i.statusText}`)}let o=await i.json();(t.options.method==="GET"||!t.options.method)&&this.setCachedResponse(t.url,o),t.resolve(o)}catch(i){if((r=i.message)!=null&&r.includes("API Error: 400")&&t.context.toLowerCase().includes("verify authentication code")||(n=i.message)!=null&&n.includes("API Error: 429")&&t.context.toLowerCase().includes("verification code")){console.warn(`Auth verification failed (${t.context}):`,i),t.resolve(null);return}t.retryCount<this.MAX_RETRY_ATTEMPTS&&(i.name==="TypeError"||i.message.includes("fetch"))?await this.retryRequest(t):(this.handleError(i,t.context),t.resolve(null))}}static async retryRequest(t){t.retryCount++;let r=this.RETRY_DELAY_BASE_MS*Math.pow(2,t.retryCount-1);await new Promise(n=>setTimeout(n,r)),t.priority+=10,this.requestQueue.unshift(t),this.isProcessingQueue||this.processQueue()}static getCachedResponse(t){let r=this.responseCache.get(t);return r?Date.now()-r.timestamp>this.CACHE_TTL_MS?(this.responseCache.delete(t),null):r.data:null}static setCachedResponse(t,r){if(this.responseCache.set(t,{data:r,timestamp:Date.now()}),this.responseCache.size>100){let n=Array.from(this.responseCache.entries()).sort((i,o)=>i[1].timestamp-o[1].timestamp);for(let i=0;i<20;i++)this.responseCache.delete(n[i][0])}}static handleError(t,r){var i,o;let n=r.toLowerCase();return((i=t.message)!=null&&i.includes("API Error: 401")||(o=t.message)!=null&&o.includes("API Error: 400"))&&(n.includes("vault registration")||n.includes("telemetry"))?(console.warn(`Expected startup API error suppressed (${r}):`,t),null):(t.name==="TypeError"||t.message.includes("fetch")?(new yE.Notice("\u26A0\uFE0F Cannot connect to trading server. Check your internet connection.",5e3),console.warn(`Trading sync offline (${r}):`,t)):(new yE.Notice(`\u274C Trading sync error: ${t.message}`,8e3),console.error(`Trading sync error (${r}):`,t)),null)}static async checkHealth(){try{let t=new AbortController,r=setTimeout(()=>t.abort(),5e3),n=await fetch(`${bE()}/api/v1/health`,{method:"GET",signal:t.signal});return clearTimeout(r),n.ok}catch(t){return!1}}static buildUrl(t,r){let n=new URL(`${bE()}${t}`);return r&&Object.entries(r).forEach(([i,o])=>{o!=null&&n.searchParams.append(i,String(o))}),n.toString()}static clearQueue(){this.requestQueue.forEach(t=>{t.reject(new Error("Request queue cleared"))}),this.requestQueue=[],this.isProcessingQueue=!1}static getQueueStatus(){return{queueLength:this.requestQueue.length,activeRequests:this.activeRequests,cacheSize:this.responseCache.size}}static clearCache(){this.responseCache.clear()}static invalidateCache(t){let r=typeof t=="string"?new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")):t,n=0;for(let[i]of this.responseCache)r.test(i)&&(this.responseCache.delete(i),n++);n>0}};Te.requestQueue=[],Te.activeRequests=0,Te.MAX_CONCURRENT_REQUESTS=3,Te.RATE_LIMIT_DELAY_MS=200,Te.lastRequestTime=0,Te.isProcessingQueue=!1,Te.MAX_RETRY_ATTEMPTS=3,Te.RETRY_DELAY_BASE_MS=1e3,Te.responseCache=new Map,Te.CACHE_TTL_MS=5*60*1e3,Te.authToken=null});function Sw(e="email-auth-modal-styles"){if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=`
    /* === EmailAuthModal base styles ==================== */
    .email-auth-modal { padding: 20px; max-width: 400px; margin: 0 auto; }
    .email-auth-modal h3 { margin: 0 0 16px; font-size: 18px; font-weight: 600; color: var(--text-normal); }
    .modal-description { margin: 0 0 20px; color: var(--text-muted); line-height: 1.4; }
    .modal-field { margin-bottom: 16px; }
    .modal-field label { display: block; margin-bottom: 6px; font-weight: 500; color: var(--text-normal); }
    .modal-input { width: 100%; padding: 8px 12px; border: 1px solid var(--background-modifier-border); border-radius: 4px; background: var(--background-primary); color: var(--text-normal); font-size: 14px; }
    .modal-input:focus { outline: none; border-color: var(--interactive-accent); box-shadow: 0 0 0 2px var(--interactive-accent-hover); }
    .modal-input:disabled { opacity: 0.6; cursor: not-allowed; }
    .code-input { font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace; font-size: 16px; letter-spacing: 2px; text-align: center; }
    .modal-error { margin: 8px 0; padding: 8px 12px; background: var(--background-modifier-error); border: 1px solid var(--text-error); border-radius: 4px; color: var(--text-on-accent, #fff); font-size: 13px; font-weight: 500; text-align: center; }
    .modal-actions { display: flex; gap: 8px; margin-top: 20px; flex-wrap: wrap; }
    .modal-actions button { flex: 1 1 auto; min-width: 90px; white-space: nowrap; }
    .modal-footer { margin-top: 20px; padding-top: 16px; border-top: 1px solid var(--background-modifier-border); }
    .modal-footer-text { margin: 0; font-size: 12px; color: var(--text-muted); line-height: 1.3; }
    @media (max-width: 480px) {
      .modal-actions { flex-direction: column; }
      .modal-actions button { width: 100%; }
    }
  `,document.head.appendChild(t)}var wE=it(()=>{});var Ne,Bp,xE,Tw,kE=it(()=>{Ne=$(W()),Bp=require("obsidian");Ci();bd();kl();wE();xE=({onSuccess:e,onCancel:t,isAuthenticated:r=!1,currentUserEmail:n})=>{let[i,o]=(0,Ne.useState)("email"),[a,s]=(0,Ne.useState)(""),[l,c]=(0,Ne.useState)(""),[d,u]=(0,Ne.useState)(!1),[p,m]=(0,Ne.useState)(null),[g,f]=(0,Ne.useState)(null),[y,h]=(0,Ne.useState)(0);(0,Ne.useEffect)(()=>{if(g&&i==="code"){let x=setInterval(()=>{let T=Math.floor((Date.now()-g)/1e3),E=Math.max(0,60-T);h(E),E===0&&clearInterval(x)},1e3);return()=>clearInterval(x)}},[g,i]);let v=async()=>{if(!a.trim()){m("Please enter a valid email address");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.trim())){m("Please enter a valid email address");return}u(!0),m(null);try{let T=await Te.makeRequest(Te.buildUrl("/auth/beta/send-code"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a.trim()})},"Send verification code",10);if((T==null?void 0:T.status)==="success")o("code"),f(Date.now()),h(60),new Bp.Notice("Verification code sent! Check your email.");else throw new Error((T==null?void 0:T.message)||"Failed to send verification code")}catch(T){console.error("Error sending verification code:",T);let E=T instanceof Error&&T.message.includes("Too Many Requests")?"You have requested too many codes. Please wait 30 minutes and try again.":T instanceof Error?T.message:"Failed to send verification code";m(E)}finally{u(!1)}},b=async()=>{if(!l.trim()){m("Please enter the verification code");return}if(!/^\d{6}$/.test(l.trim())){m("Verification code should be 6 digits");return}u(!0),m(null);try{let x=await Te.makeRequest(Te.buildUrl("/auth/beta/verify"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a.trim(),code:l.trim()})},"Verify authentication code",10);if((x==null?void 0:x.status)==="success"&&x.token&&x.user)await e(x.token,x.user),new Bp.Notice("Successfully logged in!");else throw new Error((x==null?void 0:x.message)||"Invalid verification code")}catch(x){console.error("Error verifying code:",x),m(x instanceof Error?x.message:"Failed to verify code")}finally{u(!1)}},w=async()=>{u(!0),m(null);try{let x=await Te.makeRequest(Te.buildUrl("/auth/beta/send-code"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a.trim()})},"Resend verification code",10);if((x==null?void 0:x.status)==="success")f(Date.now()),h(60),c(""),new Bp.Notice("New verification code sent! Check your email.");else throw new Error((x==null?void 0:x.message)||"Failed to resend verification code")}catch(x){console.error("Error resending verification code:",x),m(x instanceof Error?x.message:"Failed to resend verification code")}finally{u(!1)}},k=()=>{o("email"),c(""),m(null),f(null),h(0)},S=(x,T)=>{x.key==="Enter"&&!d&&T()};return Ne.default.createElement("div",{className:"email-auth-modal"},r?Ne.default.createElement(Ne.default.Fragment,null,Ne.default.createElement("h3",null,"Already Logged In"),Ne.default.createElement("p",{className:"modal-description"},"You are already logged in",n?` as ${n}`:"","."),Ne.default.createElement("div",{className:"modal-actions"},Ne.default.createElement(be,{onClick:t,variant:"primary"},"Close"))):Ne.default.createElement(Ne.default.Fragment,null,Ne.default.createElement("h3",null,"Sign In to Journalit"),i==="email"&&Ne.default.createElement(Ne.default.Fragment,null,Ne.default.createElement("p",{className:"modal-description"},"Enter your email address to receive a verification code for access to the private beta."),Ne.default.createElement("div",{className:"modal-field"},Ne.default.createElement("label",{htmlFor:"email-input"},"Email Address"),Ne.default.createElement("input",{id:"email-input",type:"email",value:a,onChange:x=>{s(x.target.value),m(null)},onKeyPress:x=>S(x,v),placeholder:"your.email@example.com",className:"modal-input",disabled:d,autoFocus:!0})),p&&Ne.default.createElement("div",{className:"modal-error"},p),Ne.default.createElement("div",{className:"modal-actions"},Ne.default.createElement(be,{onClick:v,disabled:d||!a.trim(),variant:"primary"},Ne.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"center"}},d&&Ne.default.createElement(Or,{size:"small",message:""}),d?"Sending...":"Send Verification Code")))),i==="code"&&Ne.default.createElement(Ne.default.Fragment,null,Ne.default.createElement("p",{className:"modal-description"},"We've sent a 6-digit verification code to ",Ne.default.createElement("strong",null,a),". Please enter it below to complete your sign-in."),Ne.default.createElement("div",{className:"modal-field"},Ne.default.createElement("label",{htmlFor:"code-input"},"Verification Code"),Ne.default.createElement("input",{id:"code-input",type:"text",value:l,onChange:x=>{let T=x.target.value.replace(/\D/g,"").slice(0,6);c(T),m(null)},onKeyPress:x=>S(x,b),placeholder:"123456",className:"modal-input code-input",disabled:d,autoFocus:!0,maxLength:6})),p&&Ne.default.createElement("div",{className:"modal-error"},p),Ne.default.createElement("div",{className:"modal-actions"},Ne.default.createElement(be,{onClick:b,disabled:d||l.length!==6,variant:"primary"},Ne.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"center"}},d&&Ne.default.createElement(Or,{size:"small",message:""}),d?"Verifying...":"Verify & Sign In")),y===0&&Ne.default.createElement(be,{onClick:w,disabled:d,variant:"secondary"},"Resend Code"),Ne.default.createElement(be,{onClick:k,disabled:d,variant:"secondary"},"Back"))),Ne.default.createElement("div",{className:"modal-footer"},Ne.default.createElement("p",{className:"modal-footer-text"},"Having trouble? The verification code expires in 15 minutes.",i==="code"&&y>0&&Ne.default.createElement(Ne.default.Fragment,null," You can request a new code in ",y," seconds."),i==="code"&&y===0&&Ne.default.createElement(Ne.default.Fragment,null," You can now resend the code using the button above."),i==="email"&&Ne.default.createElement(Ne.default.Fragment,null," Enter your email to receive a verification code.")))))},Tw=class extends Bp.Modal{constructor(t,r,n){super(t),this.onSuccess=r,this.onCancel=n}async onOpen(){let{contentEl:t}=this;t.empty(),Sw();let r=t.createDiv(),{createRoot:n}=Ps();n(r).render(Ne.default.createElement(xE,{onSuccess:async(o,a)=>{await this.onSuccess(o,a),this.close()},onCancel:()=>{this.onCancel(),this.close()}}))}onClose(){let{contentEl:t}=this;t.empty()}}});var cz={};xs(cz,{accountLinkModalStyles:()=>lz,injectAccountLinkModalStyles:()=>AE,removeAccountLinkModalStyles:()=>NE});function AE(){if(document.getElementById(PE))return;let e=document.createElement("style");e.id=PE,e.textContent=lz,document.head.appendChild(e)}function NE(){let e=document.getElementById(PE);e&&e.remove()}var PE,lz,ME=it(()=>{PE="journalit-account-link-modal-styles",lz=`
  .account-link-modal {
    padding: 16px;
    font-family: var(--font-text);
    color: var(--text-normal);
    min-width: 450px;
  }

  .account-link-modal h3 {
    margin-top: 0;
    margin-bottom: 16px;
    font-size: 1.3rem;
    font-weight: 600;
    color: var(--text-normal);
    border-bottom: 1px solid var(--background-modifier-border);
    padding-bottom: 8px;
  }

  .account-link-modal .account-info {
    background-color: var(--background-secondary);
    padding: 12px 16px;
    border-radius: 6px;
    margin-bottom: 20px;
    border: 1px solid var(--background-modifier-border);
  }

  .account-link-modal .account-info p {
    margin: 4px 0;
    font-size: 0.9rem;
  }

  .account-link-modal .account-info strong {
    font-weight: 600;
    margin-right: 8px;
    color: var(--text-muted);
  }

  .account-link-modal .modal-field {
    margin-bottom: 16px;
  }

  .account-link-modal .section-label {
    display: block;
    margin-bottom: 12px;
    font-weight: 500;
    font-size: 0.95rem;
    color: var(--text-normal);
  }

  .account-link-modal .link-option-group {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .account-link-modal .link-option {
    display: flex;
    align-items: center;
    padding: 8px 12px;
    border-radius: 4px;
    cursor: pointer;
    transition: background-color 0.1s ease;
  }

  .account-link-modal .link-option:hover {
    background-color: var(--background-modifier-hover);
  }

  .account-link-modal .link-option input[type="radio"] {
    margin-right: 10px;
    cursor: pointer;
  }

  .account-link-modal .link-option span {
    flex: 1;
    font-size: 0.9rem;
  }

  .account-link-modal .custom-name-input,
  .account-link-modal .existing-account-select {
    margin-left: 32px;
    margin-top: 8px;
    margin-bottom: 12px;
  }

  .account-link-modal .modal-input,
  .account-link-modal .modal-select {
    width: 100%;
    padding: 8px 10px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    font-size: 0.9rem;
    min-height: 36px;
  }

  .account-link-modal .modal-input:focus,
  .account-link-modal .modal-select:focus {
    border-color: var(--interactive-accent);
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2);
    outline: none;
  }

  .account-link-modal .modal-actions {
    display: flex;
    justify-content: flex-end;
    gap: 8px;
    margin-top: 24px;
    padding-top: 20px;
    border-top: 1px solid var(--background-modifier-border);
  }
`});var Et,FE,Ow=it(()=>{Et=[{id:"welcome",title:"Welcome to Journalit",description:"Your journey to better trading begins here"},{id:"goal",title:"What's your goal?",description:"Help us personalize your experience"},{id:"segmentation",title:"Tell us about your trading",description:"Personalize your experience"},{id:"first-action",title:"Create your first trade",description:"Experience the core value immediately"},{id:"authentication",title:"Connect account",description:"Enable advanced features and sync",isOptional:!0,shouldShow:e=>e==="automation"},{id:"ftp-credentials",title:"Setup MT sync",description:"Automatic trade report collection",isOptional:!0,shouldShow:e=>e==="automation"},{id:"completion",title:"You're all set!",description:"Start your trading journey"}],FE=[{id:"create_trade",title:"Create your first Trade note",description:"Document your first trade to get started",completed:!1},{id:"generate_setup",title:"Add at least one Setup",description:"Define your trading strategies",completed:!1},{id:"tag_trade_outcome",title:"Tag a trade as Winner/Loser",description:"Track your trade performance",completed:!1,dependsOn:["create_trade"]},{id:"enable_mt5_sync",title:"Turn on MT5 Auto-Sync (beta free)",description:"Automate your trade data collection",completed:!1,isOptional:!0}]});var Sz=le(RE=>{"use strict";Object.defineProperty(RE,Symbol.toStringTag,{value:"Module"});function n7(e){return e==="__proto__"}RE.isUnsafeProperty=n7});var BE=le(WE=>{"use strict";Object.defineProperty(WE,Symbol.toStringTag,{value:"Module"});function i7(e){switch(typeof e){case"number":case"symbol":return!1;case"string":return e.includes(".")||e.includes("[")||e.includes("]")}}WE.isDeepKey=i7});var VE=le(UE=>{"use strict";Object.defineProperty(UE,Symbol.toStringTag,{value:"Module"});function o7(e){var t;return typeof e=="string"||typeof e=="symbol"?e:Object.is((t=e==null?void 0:e.valueOf)==null?void 0:t.call(e),-0)?"-0":String(e)}UE.toKey=o7});var Bw=le(HE=>{"use strict";Object.defineProperty(HE,Symbol.toStringTag,{value:"Module"});function a7(e){let t=[],r=e.length;if(r===0)return t;let n=0,i="",o="",a=!1;for(e.charCodeAt(0)===46&&(t.push(""),n++);n<r;){let s=e[n];o?s==="\\"&&n+1<r?(n++,i+=e[n]):s===o?o="":i+=s:a?s==='"'||s==="'"?o=s:s==="]"?(a=!1,t.push(i),i=""):i+=s:s==="["?(a=!0,i&&(t.push(i),i="")):s==="."?i&&(t.push(i),i=""):i+=s,n++}return i&&t.push(i),t}HE.toPath=a7});var Uw=le(GE=>{"use strict";Object.defineProperty(GE,Symbol.toStringTag,{value:"Module"});var qE=Sz(),s7=BE(),l7=VE(),c7=Bw();function Tz(e,t,r){if(e==null)return r;switch(typeof t){case"string":{if(qE.isUnsafeProperty(t))return r;let n=e[t];return n===void 0?s7.isDeepKey(t)?Tz(e,c7.toPath(t),r):r:n}case"number":case"symbol":{typeof t=="number"&&(t=l7.toKey(t));let n=e[t];return n===void 0?r:n}default:{if(Array.isArray(t))return d7(e,t,r);if(Object.is(t==null?void 0:t.valueOf(),-0)?t="-0":t=String(t),qE.isUnsafeProperty(t))return r;let n=e[t];return n===void 0?r:n}}}function d7(e,t,r){if(t.length===0)return r;let n=e;for(let i=0;i<t.length;i++){if(n==null||qE.isUnsafeProperty(t[i]))return r;n=n[t[i]]}return n===void 0?r:n}GE.get=Tz});var Yp=le((DPe,Cz)=>{Cz.exports=Uw().get});var Dz=le(Lt=>{"use strict";var YE=Symbol.for("react.element"),KE=Symbol.for("react.portal"),Vw=Symbol.for("react.fragment"),Hw=Symbol.for("react.strict_mode"),qw=Symbol.for("react.profiler"),Gw=Symbol.for("react.provider"),Yw=Symbol.for("react.context"),u7=Symbol.for("react.server_context"),Kw=Symbol.for("react.forward_ref"),Jw=Symbol.for("react.suspense"),Xw=Symbol.for("react.suspense_list"),Qw=Symbol.for("react.memo"),Zw=Symbol.for("react.lazy"),p7=Symbol.for("react.offscreen"),Ez;Ez=Symbol.for("react.module.reference");function va(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case YE:switch(e=e.type,e){case Vw:case qw:case Hw:case Jw:case Xw:return e;default:switch(e=e&&e.$$typeof,e){case u7:case Yw:case Kw:case Zw:case Qw:case Gw:return e;default:return t}}case KE:return t}}}Lt.ContextConsumer=Yw;Lt.ContextProvider=Gw;Lt.Element=YE;Lt.ForwardRef=Kw;Lt.Fragment=Vw;Lt.Lazy=Zw;Lt.Memo=Qw;Lt.Portal=KE;Lt.Profiler=qw;Lt.StrictMode=Hw;Lt.Suspense=Jw;Lt.SuspenseList=Xw;Lt.isAsyncMode=function(){return!1};Lt.isConcurrentMode=function(){return!1};Lt.isContextConsumer=function(e){return va(e)===Yw};Lt.isContextProvider=function(e){return va(e)===Gw};Lt.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===YE};Lt.isForwardRef=function(e){return va(e)===Kw};Lt.isFragment=function(e){return va(e)===Vw};Lt.isLazy=function(e){return va(e)===Zw};Lt.isMemo=function(e){return va(e)===Qw};Lt.isPortal=function(e){return va(e)===KE};Lt.isProfiler=function(e){return va(e)===qw};Lt.isStrictMode=function(e){return va(e)===Hw};Lt.isSuspense=function(e){return va(e)===Jw};Lt.isSuspenseList=function(e){return va(e)===Xw};Lt.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Vw||e===qw||e===Hw||e===Jw||e===Xw||e===p7||typeof e=="object"&&e!==null&&(e.$$typeof===Zw||e.$$typeof===Qw||e.$$typeof===Gw||e.$$typeof===Yw||e.$$typeof===Kw||e.$$typeof===Ez||e.getModuleId!==void 0)};Lt.typeOf=va});var Az=le((APe,Pz)=>{"use strict";Pz.exports=Dz()});var a$=le(ID=>{"use strict";Object.defineProperty(ID,Symbol.toStringTag,{value:"Module"});function U7(e,t){let r=new Map;for(let n=0;n<e.length;n++){let i=e[n],o=t(i);r.has(o)||r.set(o,i)}return Array.from(r.values())}ID.uniqBy=U7});var jD=le(FD=>{"use strict";Object.defineProperty(FD,Symbol.toStringTag,{value:"Module"});function V7(e){return e}FD.identity=V7});var s$=le(LD=>{"use strict";Object.defineProperty(LD,Symbol.toStringTag,{value:"Module"});function H7(e){return Number.isSafeInteger(e)&&e>=0}LD.isLength=H7});var ux=le(_D=>{"use strict";Object.defineProperty(_D,Symbol.toStringTag,{value:"Module"});var q7=s$();function G7(e){return e!=null&&typeof e!="function"&&q7.isLength(e.length)}_D.isArrayLike=G7});var l$=le(zD=>{"use strict";Object.defineProperty(zD,Symbol.toStringTag,{value:"Module"});function Y7(e){return typeof e=="object"&&e!==null}zD.isObjectLike=Y7});var c$=le($D=>{"use strict";Object.defineProperty($D,Symbol.toStringTag,{value:"Module"});var K7=ux(),J7=l$();function X7(e){return J7.isObjectLike(e)&&K7.isArrayLike(e)}$D.isArrayLikeObject=X7});var d$=le(RD=>{"use strict";Object.defineProperty(RD,Symbol.toStringTag,{value:"Module"});var Q7=Uw();function Z7(e){return function(t){return Q7.get(t,e)}}RD.property=Z7});var BD=le(WD=>{"use strict";Object.defineProperty(WD,Symbol.toStringTag,{value:"Module"});function eJ(e){return e!==null&&(typeof e=="object"||typeof e=="function")}WD.isObject=eJ});var VD=le(UD=>{"use strict";Object.defineProperty(UD,Symbol.toStringTag,{value:"Module"});function tJ(e){return e==null||typeof e!="object"&&typeof e!="function"}UD.isPrimitive=tJ});var px=le(HD=>{"use strict";Object.defineProperty(HD,Symbol.toStringTag,{value:"Module"});function rJ(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}HD.eq=rJ});var f$=le(mx=>{"use strict";Object.defineProperty(mx,Symbol.toStringTag,{value:"Module"});var nJ=fx(),iJ=BD(),oJ=VD(),u$=px();function aJ(e,t,r){return typeof r!="function"?nJ.isMatch(e,t):qD(e,t,function n(i,o,a,s,l,c){let d=r(i,o,a,s,l,c);return d!==void 0?!!d:qD(i,o,n,c)},new Map)}function qD(e,t,r,n){if(t===e)return!0;switch(typeof t){case"object":return sJ(e,t,r,n);case"function":return Object.keys(t).length>0?qD(e,{...t},r,n):u$.eq(e,t);default:return iJ.isObject(e)?typeof t=="string"?t==="":!0:u$.eq(e,t)}}function sJ(e,t,r,n){if(t==null)return!0;if(Array.isArray(t))return p$(e,t,r,n);if(t instanceof Map)return lJ(e,t,r,n);if(t instanceof Set)return m$(e,t,r,n);let i=Object.keys(t);if(e==null)return i.length===0;if(i.length===0)return!0;if(n&&n.has(t))return n.get(t)===e;n&&n.set(t,e);try{for(let o=0;o<i.length;o++){let a=i[o];if(!oJ.isPrimitive(e)&&!(a in e)||t[a]===void 0&&e[a]!==void 0||t[a]===null&&e[a]!==null||!r(e[a],t[a],a,e,t,n))return!1}return!0}finally{n&&n.delete(t)}}function lJ(e,t,r,n){if(t.size===0)return!0;if(!(e instanceof Map))return!1;for(let[i,o]of t.entries()){let a=e.get(i);if(r(a,o,i,e,t,n)===!1)return!1}return!0}function p$(e,t,r,n){if(t.length===0)return!0;if(!Array.isArray(e))return!1;let i=new Set;for(let o=0;o<t.length;o++){let a=t[o],s=!1;for(let l=0;l<e.length;l++){if(i.has(l))continue;let c=e[l],d=!1;if(r(c,a,o,e,t,n)&&(d=!0),d){i.add(l),s=!0;break}}if(!s)return!1}return!0}function m$(e,t,r,n){return t.size===0?!0:e instanceof Set?p$([...e],[...t],r,n):!1}mx.isMatchWith=aJ;mx.isSetMatch=m$});var fx=le(GD=>{"use strict";Object.defineProperty(GD,Symbol.toStringTag,{value:"Module"});var cJ=f$();function dJ(e,t){return cJ.isMatchWith(e,t,()=>{})}GD.isMatch=dJ});var KD=le(YD=>{"use strict";Object.defineProperty(YD,Symbol.toStringTag,{value:"Module"});function uJ(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}YD.getSymbols=uJ});var gx=le(JD=>{"use strict";Object.defineProperty(JD,Symbol.toStringTag,{value:"Module"});function pJ(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}JD.getTag=pJ});var hx=le(Ut=>{"use strict";Object.defineProperty(Ut,Symbol.toStringTag,{value:"Module"});var mJ="[object RegExp]",fJ="[object String]",gJ="[object Number]",hJ="[object Boolean]",vJ="[object Arguments]",yJ="[object Symbol]",bJ="[object Date]",wJ="[object Map]",xJ="[object Set]",kJ="[object Array]",SJ="[object Function]",TJ="[object ArrayBuffer]",CJ="[object Object]",EJ="[object Error]",DJ="[object DataView]",PJ="[object Uint8Array]",AJ="[object Uint8ClampedArray]",NJ="[object Uint16Array]",MJ="[object Uint32Array]",OJ="[object BigUint64Array]",IJ="[object Int8Array]",FJ="[object Int16Array]",jJ="[object Int32Array]",LJ="[object BigInt64Array]",_J="[object Float32Array]",zJ="[object Float64Array]";Ut.argumentsTag=vJ;Ut.arrayBufferTag=TJ;Ut.arrayTag=kJ;Ut.bigInt64ArrayTag=LJ;Ut.bigUint64ArrayTag=OJ;Ut.booleanTag=hJ;Ut.dataViewTag=DJ;Ut.dateTag=bJ;Ut.errorTag=EJ;Ut.float32ArrayTag=_J;Ut.float64ArrayTag=zJ;Ut.functionTag=SJ;Ut.int16ArrayTag=FJ;Ut.int32ArrayTag=jJ;Ut.int8ArrayTag=IJ;Ut.mapTag=wJ;Ut.numberTag=gJ;Ut.objectTag=CJ;Ut.regexpTag=mJ;Ut.setTag=xJ;Ut.stringTag=fJ;Ut.symbolTag=yJ;Ut.uint16ArrayTag=NJ;Ut.uint32ArrayTag=MJ;Ut.uint8ArrayTag=PJ;Ut.uint8ClampedArrayTag=AJ});var g$=le(XD=>{"use strict";Object.defineProperty(XD,Symbol.toStringTag,{value:"Module"});function $J(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}XD.isTypedArray=$J});var QD=le(Ih=>{"use strict";Object.defineProperty(Ih,Symbol.toStringTag,{value:"Module"});var RJ=KD(),WJ=gx(),jr=hx(),BJ=VD(),UJ=g$();function VJ(e,t){return Ld(e,void 0,e,new Map,t)}function Ld(e,t,r,n=new Map,i=void 0){let o=i==null?void 0:i(e,t,r,n);if(o!=null)return o;if(BJ.isPrimitive(e))return e;if(n.has(e))return n.get(e);if(Array.isArray(e)){let a=new Array(e.length);n.set(e,a);for(let s=0;s<e.length;s++)a[s]=Ld(e[s],s,r,n,i);return Object.hasOwn(e,"index")&&(a.index=e.index),Object.hasOwn(e,"input")&&(a.input=e.input),a}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){let a=new RegExp(e.source,e.flags);return a.lastIndex=e.lastIndex,a}if(e instanceof Map){let a=new Map;n.set(e,a);for(let[s,l]of e)a.set(s,Ld(l,s,r,n,i));return a}if(e instanceof Set){let a=new Set;n.set(e,a);for(let s of e)a.add(Ld(s,void 0,r,n,i));return a}if(typeof Buffer!="undefined"&&Buffer.isBuffer(e))return e.subarray();if(UJ.isTypedArray(e)){let a=new(Object.getPrototypeOf(e)).constructor(e.length);n.set(e,a);for(let s=0;s<e.length;s++)a[s]=Ld(e[s],s,r,n,i);return a}if(e instanceof ArrayBuffer||typeof SharedArrayBuffer!="undefined"&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){let a=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return n.set(e,a),sm(a,e,r,n,i),a}if(typeof File!="undefined"&&e instanceof File){let a=new File([e],e.name,{type:e.type});return n.set(e,a),sm(a,e,r,n,i),a}if(e instanceof Blob){let a=new Blob([e],{type:e.type});return n.set(e,a),sm(a,e,r,n,i),a}if(e instanceof Error){let a=new e.constructor;return n.set(e,a),a.message=e.message,a.name=e.name,a.stack=e.stack,a.cause=e.cause,sm(a,e,r,n,i),a}if(typeof e=="object"&&HJ(e)){let a=Object.create(Object.getPrototypeOf(e));return n.set(e,a),sm(a,e,r,n,i),a}return e}function sm(e,t,r=e,n,i){let o=[...Object.keys(t),...RJ.getSymbols(t)];for(let a=0;a<o.length;a++){let s=o[a],l=Object.getOwnPropertyDescriptor(e,s);(l==null||l.writable)&&(e[s]=Ld(t[s],s,r,n,i))}}function HJ(e){switch(WJ.getTag(e)){case jr.argumentsTag:case jr.arrayTag:case jr.arrayBufferTag:case jr.dataViewTag:case jr.booleanTag:case jr.dateTag:case jr.float32ArrayTag:case jr.float64ArrayTag:case jr.int8ArrayTag:case jr.int16ArrayTag:case jr.int32ArrayTag:case jr.mapTag:case jr.numberTag:case jr.objectTag:case jr.regexpTag:case jr.setTag:case jr.stringTag:case jr.symbolTag:case jr.uint8ArrayTag:case jr.uint8ClampedArrayTag:case jr.uint16ArrayTag:case jr.uint32ArrayTag:return!0;default:return!1}}Ih.cloneDeepWith=VJ;Ih.cloneDeepWithImpl=Ld;Ih.copyProperties=sm});var h$=le(ZD=>{"use strict";Object.defineProperty(ZD,Symbol.toStringTag,{value:"Module"});var qJ=QD();function GJ(e){return qJ.cloneDeepWithImpl(e,void 0,e,new Map,void 0)}ZD.cloneDeep=GJ});var v$=le(eP=>{"use strict";Object.defineProperty(eP,Symbol.toStringTag,{value:"Module"});var YJ=fx(),KJ=h$();function JJ(e){return e=KJ.cloneDeep(e),t=>YJ.isMatch(t,e)}eP.matches=JJ});var y$=le(rP=>{"use strict";Object.defineProperty(rP,Symbol.toStringTag,{value:"Module"});var tP=QD(),vx=hx();function XJ(e,t){return tP.cloneDeepWith(e,(r,n,i,o)=>{let a=t==null?void 0:t(r,n,i,o);if(a!=null)return a;if(typeof e=="object")switch(Object.prototype.toString.call(e)){case vx.numberTag:case vx.stringTag:case vx.booleanTag:{let s=new e.constructor(e==null?void 0:e.valueOf());return tP.copyProperties(s,e),s}case vx.argumentsTag:{let s={};return tP.copyProperties(s,e),s.length=e.length,s[Symbol.iterator]=e[Symbol.iterator],s}default:return}})}rP.cloneDeepWith=XJ});var b$=le(nP=>{"use strict";Object.defineProperty(nP,Symbol.toStringTag,{value:"Module"});var QJ=y$();function ZJ(e){return QJ.cloneDeepWith(e)}nP.cloneDeep=ZJ});var oP=le(iP=>{"use strict";Object.defineProperty(iP,Symbol.toStringTag,{value:"Module"});var eX=/^(?:0|[1-9]\d*)$/;function tX(e,t=Number.MAX_SAFE_INTEGER){switch(typeof e){case"number":return Number.isInteger(e)&&e>=0&&e<t;case"symbol":return!1;case"string":return eX.test(e)}}iP.isIndex=tX});var w$=le(aP=>{"use strict";Object.defineProperty(aP,Symbol.toStringTag,{value:"Module"});var rX=gx();function nX(e){return e!==null&&typeof e=="object"&&rX.getTag(e)==="[object Arguments]"}aP.isArguments=nX});var x$=le(sP=>{"use strict";Object.defineProperty(sP,Symbol.toStringTag,{value:"Module"});var iX=BE(),oX=oP(),aX=w$(),sX=Bw();function lX(e,t){let r;if(Array.isArray(t)?r=t:typeof t=="string"&&iX.isDeepKey(t)&&(e==null?void 0:e[t])==null?r=sX.toPath(t):r=[t],r.length===0)return!1;let n=e;for(let i=0;i<r.length;i++){let o=r[i];if((n==null||!Object.hasOwn(n,o))&&!((Array.isArray(n)||aX.isArguments(n))&&oX.isIndex(o)&&o<n.length))return!1;n=n[o]}return!0}sP.has=lX});var k$=le(lP=>{"use strict";Object.defineProperty(lP,Symbol.toStringTag,{value:"Module"});var cX=fx(),dX=VE(),uX=b$(),pX=Uw(),mX=x$();function fX(e,t){switch(typeof e){case"object":{Object.is(e==null?void 0:e.valueOf(),-0)&&(e="-0");break}case"number":{e=dX.toKey(e);break}}return t=uX.cloneDeep(t),function(r){let n=pX.get(r,e);return n===void 0?mX.has(r,e):t===void 0?n===void 0:cX.isMatch(n,t)}}lP.matchesProperty=fX});var S$=le(cP=>{"use strict";Object.defineProperty(cP,Symbol.toStringTag,{value:"Module"});var gX=jD(),hX=d$(),vX=v$(),yX=k$();function bX(e){if(e==null)return gX.identity;switch(typeof e){case"function":return e;case"object":return Array.isArray(e)&&e.length===2?yX.matchesProperty(e[0],e[1]):vX.matches(e);case"string":case"symbol":case"number":return hX.property(e)}}cP.iteratee=bX});var T$=le(dP=>{"use strict";Object.defineProperty(dP,Symbol.toStringTag,{value:"Module"});var wX=a$(),xX=jD(),kX=c$(),SX=S$();function TX(e,t=xX.identity){return kX.isArrayLikeObject(e)?wX.uniqBy(Array.from(e),SX.iteratee(t)):[]}dP.uniqBy=TX});var E$=le((uMe,C$)=>{C$.exports=T$().uniqBy});var A$=le(P$=>{"use strict";var lm=W();function CX(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var EX=typeof Object.is=="function"?Object.is:CX,DX=lm.useState,PX=lm.useEffect,AX=lm.useLayoutEffect,NX=lm.useDebugValue;function MX(e,t){var r=t(),n=DX({inst:{value:r,getSnapshot:t}}),i=n[0].inst,o=n[1];return AX(function(){i.value=r,i.getSnapshot=t,pP(i)&&o({inst:i})},[e,r,t]),PX(function(){return pP(i)&&o({inst:i}),e(function(){pP(i)&&o({inst:i})})},[e]),NX(r),r}function pP(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!EX(e,r)}catch(n){return!0}}function OX(e,t){return t()}var IX=typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"?OX:MX;P$.useSyncExternalStore=lm.useSyncExternalStore!==void 0?lm.useSyncExternalStore:IX});var M$=le((fMe,N$)=>{"use strict";N$.exports=A$()});var I$=le(O$=>{"use strict";var yx=W(),FX=M$();function jX(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var LX=typeof Object.is=="function"?Object.is:jX,_X=FX.useSyncExternalStore,zX=yx.useRef,$X=yx.useEffect,RX=yx.useMemo,WX=yx.useDebugValue;O$.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var o=zX(null);if(o.current===null){var a={hasValue:!1,value:null};o.current=a}else a=o.current;o=RX(function(){function l(m){if(!c){if(c=!0,d=m,m=n(m),i!==void 0&&a.hasValue){var g=a.value;if(i(g,m))return u=g}return u=m}if(g=u,LX(d,m))return g;var f=n(m);return i!==void 0&&i(g,f)?(d=m,g):(d=m,u=f)}var c=!1,d,u,p=r===void 0?null:r;return[function(){return l(t())},p===null?void 0:function(){return l(p())}]},[t,r,n,i]);var s=_X(e,o[0],o[1]);return $X(function(){a.hasValue=!0,a.value=s},[s]),WX(s),s}});var j$=le((hMe,F$)=>{"use strict";F$.exports=I$()});var B$=le(fP=>{"use strict";Object.defineProperty(fP,Symbol.toStringTag,{value:"Module"});function W$(e){return typeof e=="symbol"?1:e===null?2:e===void 0?3:e!==e?4:0}var tQ=(e,t,r)=>{if(e!==t){let n=W$(e),i=W$(t);if(n===i&&n===0){if(e<t)return r==="desc"?1:-1;if(e>t)return r==="desc"?-1:1}return r==="desc"?i-n:n-i}return 0};fP.compareValues=tQ});var hP=le(gP=>{"use strict";Object.defineProperty(gP,Symbol.toStringTag,{value:"Module"});function rQ(e){return typeof e=="symbol"||e instanceof Symbol}gP.isSymbol=rQ});var U$=le(vP=>{"use strict";Object.defineProperty(vP,Symbol.toStringTag,{value:"Module"});var nQ=hP(),iQ=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,oQ=/^\w*$/;function aQ(e,t){return Array.isArray(e)?!1:typeof e=="number"||typeof e=="boolean"||e==null||nQ.isSymbol(e)?!0:typeof e=="string"&&(oQ.test(e)||!iQ.test(e))||t!=null&&Object.hasOwn(t,e)}vP.isKey=aQ});var V$=le(yP=>{"use strict";Object.defineProperty(yP,Symbol.toStringTag,{value:"Module"});var sQ=B$(),lQ=U$(),cQ=Bw();function dQ(e,t,r,n){if(e==null)return[];r=n?void 0:r,Array.isArray(e)||(e=Object.values(e)),Array.isArray(t)||(t=t==null?[null]:[t]),t.length===0&&(t=[null]),Array.isArray(r)||(r=r==null?[]:[r]),r=r.map(l=>String(l));let i=(l,c)=>{let d=l;for(let u=0;u<c.length&&d!=null;++u)d=d[c[u]];return d},o=(l,c)=>c==null||l==null?c:typeof l=="object"&&"key"in l?Object.hasOwn(c,l.key)?c[l.key]:i(c,l.path):typeof l=="function"?l(c):Array.isArray(l)?i(c,l):typeof c=="object"?c[l]:c,a=t.map(l=>(Array.isArray(l)&&l.length===1&&(l=l[0]),l==null||typeof l=="function"||Array.isArray(l)||lQ.isKey(l)?l:{key:l,path:cQ.toPath(l)}));return e.map(l=>({original:l,criteria:a.map(c=>o(c,l))})).slice().sort((l,c)=>{for(let d=0;d<a.length;d++){let u=sQ.compareValues(l.criteria[d],c.criteria[d],r[d]);if(u!==0)return u}return 0}).map(l=>l.original)}yP.orderBy=dQ});var H$=le(bP=>{"use strict";Object.defineProperty(bP,Symbol.toStringTag,{value:"Module"});function uQ(e,t=1){let r=[],n=Math.floor(t),i=(o,a)=>{for(let s=0;s<o.length;s++){let l=o[s];Array.isArray(l)&&a<n?i(l,a+1):r.push(l)}};return i(e,0),r}bP.flatten=uQ});var xP=le(wP=>{"use strict";Object.defineProperty(wP,Symbol.toStringTag,{value:"Module"});var pQ=oP(),mQ=ux(),fQ=BD(),gQ=px();function hQ(e,t,r){return fQ.isObject(r)&&(typeof t=="number"&&mQ.isArrayLike(r)&&pQ.isIndex(t)&&t<r.length||typeof t=="string"&&t in r)?gQ.eq(r[t],e):!1}wP.isIterateeCall=hQ});var G$=le(kP=>{"use strict";Object.defineProperty(kP,Symbol.toStringTag,{value:"Module"});var vQ=V$(),yQ=H$(),q$=xP();function bQ(e,...t){let r=t.length;return r>1&&q$.isIterateeCall(e,t[0],t[1])?t=[]:r>2&&q$.isIterateeCall(t[0],t[1],t[2])&&(t=[t[0]]),vQ.orderBy(e,yQ.flatten(t),["asc"])}kP.sortBy=bQ});var jh=le((OMe,Y$)=>{Y$.exports=G$().sortBy});var I5=le(XP=>{"use strict";Object.defineProperty(XP,Symbol.toStringTag,{value:"Module"});function fee(e){if(!e||typeof e!="object")return!1;let t=Object.getPrototypeOf(e);return t===null||t===Object.prototype||Object.getPrototypeOf(t)===null?Object.prototype.toString.call(e)==="[object Object]":!1}XP.isPlainObject=fee});var _5=le(QP=>{"use strict";Object.defineProperty(QP,Symbol.toStringTag,{value:"Module"});var F5=I5(),j5=KD(),L5=gx(),_t=hx(),gee=px();function hee(e,t,r){return qh(e,t,void 0,void 0,void 0,void 0,r)}function qh(e,t,r,n,i,o,a){let s=a(e,t,r,n,i,o);if(s!==void 0)return s;if(typeof e==typeof t)switch(typeof e){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return e===t;case"number":return e===t||Object.is(e,t);case"function":return e===t;case"object":return Gh(e,t,o,a)}return Gh(e,t,o,a)}function Gh(e,t,r,n){if(Object.is(e,t))return!0;let i=L5.getTag(e),o=L5.getTag(t);if(i===_t.argumentsTag&&(i=_t.objectTag),o===_t.argumentsTag&&(o=_t.objectTag),i!==o)return!1;switch(i){case _t.stringTag:return e.toString()===t.toString();case _t.numberTag:{let l=e.valueOf(),c=t.valueOf();return gee.eq(l,c)}case _t.booleanTag:case _t.dateTag:case _t.symbolTag:return Object.is(e.valueOf(),t.valueOf());case _t.regexpTag:return e.source===t.source&&e.flags===t.flags;case _t.functionTag:return e===t}r=r!=null?r:new Map;let a=r.get(e),s=r.get(t);if(a!=null&&s!=null)return a===t;r.set(e,t),r.set(t,e);try{switch(i){case _t.mapTag:{if(e.size!==t.size)return!1;for(let[l,c]of e.entries())if(!t.has(l)||!qh(c,t.get(l),l,e,t,r,n))return!1;return!0}case _t.setTag:{if(e.size!==t.size)return!1;let l=Array.from(e.values()),c=Array.from(t.values());for(let d=0;d<l.length;d++){let u=l[d],p=c.findIndex(m=>qh(u,m,void 0,e,t,r,n));if(p===-1)return!1;c.splice(p,1)}return!0}case _t.arrayTag:case _t.uint8ArrayTag:case _t.uint8ClampedArrayTag:case _t.uint16ArrayTag:case _t.uint32ArrayTag:case _t.bigUint64ArrayTag:case _t.int8ArrayTag:case _t.int16ArrayTag:case _t.int32ArrayTag:case _t.bigInt64ArrayTag:case _t.float32ArrayTag:case _t.float64ArrayTag:{if(typeof Buffer!="undefined"&&Buffer.isBuffer(e)!==Buffer.isBuffer(t)||e.length!==t.length)return!1;for(let l=0;l<e.length;l++)if(!qh(e[l],t[l],l,e,t,r,n))return!1;return!0}case _t.arrayBufferTag:return e.byteLength!==t.byteLength?!1:Gh(new Uint8Array(e),new Uint8Array(t),r,n);case _t.dataViewTag:return e.byteLength!==t.byteLength||e.byteOffset!==t.byteOffset?!1:Gh(new Uint8Array(e),new Uint8Array(t),r,n);case _t.errorTag:return e.name===t.name&&e.message===t.message;case _t.objectTag:{if(!(Gh(e.constructor,t.constructor,r,n)||F5.isPlainObject(e)&&F5.isPlainObject(t)))return!1;let c=[...Object.keys(e),...j5.getSymbols(e)],d=[...Object.keys(t),...j5.getSymbols(t)];if(c.length!==d.length)return!1;for(let u=0;u<c.length;u++){let p=c[u],m=e[p];if(!Object.hasOwn(t,p))return!1;let g=t[p];if(!qh(m,g,p,e,t,r,n))return!1}return!0}default:return!1}}finally{r.delete(e),r.delete(t)}}QP.isEqualWith=hee});var z5=le(ZP=>{"use strict";Object.defineProperty(ZP,Symbol.toStringTag,{value:"Module"});function vee(){}ZP.noop=vee});var $5=le(eA=>{"use strict";Object.defineProperty(eA,Symbol.toStringTag,{value:"Module"});var yee=_5(),bee=z5();function wee(e,t){return yee.isEqualWith(e,t,bee.noop)}eA.isEqual=wee});var W5=le((wIe,R5)=>{R5.exports=$5().isEqual});var s4=le(oA=>{"use strict";Object.defineProperty(oA,Symbol.toStringTag,{value:"Module"});var Uee=hP();function Vee(e){return Uee.isSymbol(e)?NaN:Number(e)}oA.toNumber=Vee});var l4=le(aA=>{"use strict";Object.defineProperty(aA,Symbol.toStringTag,{value:"Module"});var Hee=s4();function qee(e){return e?(e=Hee.toNumber(e),e===1/0||e===-1/0?(e<0?-1:1)*Number.MAX_VALUE:e===e?e:0):e===0?e:0}aA.toFinite=qee});var c4=le(lA=>{"use strict";Object.defineProperty(lA,Symbol.toStringTag,{value:"Module"});var Gee=xP(),sA=l4();function Yee(e,t,r){r&&typeof r!="number"&&Gee.isIterateeCall(e,t,r)&&(t=r=void 0),e=sA.toFinite(e),t===void 0?(t=e,e=0):t=sA.toFinite(t),r=r===void 0?e<t?1:-1:sA.toFinite(r);let n=Math.max(Math.ceil((t-e)/(r||1)),0),i=new Array(n);for(let o=0;o<n;o++)i[o]=e,e+=r;return i}lA.range=Yee});var u4=le((QIe,d4)=>{d4.exports=c4().range});var VA=le((_W,R0)=>{(function(e){"use strict";var t=1e9,r={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},n=!0,i="[DecimalError] ",o=i+"Invalid argument: ",a=i+"Exponent out of range: ",s=Math.floor,l=Math.pow,c=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,d,u=1e7,p=7,m=9007199254740991,g=s(m/p),f={};f.absoluteValue=f.abs=function(){var M=new this.constructor(this);return M.s&&(M.s=1),M},f.comparedTo=f.cmp=function(M){var O,F,L,B,j=this;if(M=new j.constructor(M),j.s!==M.s)return j.s||-M.s;if(j.e!==M.e)return j.e>M.e^j.s<0?1:-1;for(L=j.d.length,B=M.d.length,O=0,F=L<B?L:B;O<F;++O)if(j.d[O]!==M.d[O])return j.d[O]>M.d[O]^j.s<0?1:-1;return L===B?0:L>B^j.s<0?1:-1},f.decimalPlaces=f.dp=function(){var M=this,O=M.d.length-1,F=(O-M.e)*p;if(O=M.d[O],O)for(;O%10==0;O/=10)F--;return F<0?0:F},f.dividedBy=f.div=function(M){return b(this,new this.constructor(M))},f.dividedToIntegerBy=f.idiv=function(M){var O=this,F=O.constructor;return C(b(O,new F(M),0,1),F.precision)},f.equals=f.eq=function(M){return!this.cmp(M)},f.exponent=function(){return k(this)},f.greaterThan=f.gt=function(M){return this.cmp(M)>0},f.greaterThanOrEqualTo=f.gte=function(M){return this.cmp(M)>=0},f.isInteger=f.isint=function(){return this.e>this.d.length-2},f.isNegative=f.isneg=function(){return this.s<0},f.isPositive=f.ispos=function(){return this.s>0},f.isZero=function(){return this.s===0},f.lessThan=f.lt=function(M){return this.cmp(M)<0},f.lessThanOrEqualTo=f.lte=function(M){return this.cmp(M)<1},f.logarithm=f.log=function(M){var O,F=this,L=F.constructor,B=L.precision,j=B+5;if(M===void 0)M=new L(10);else if(M=new L(M),M.s<1||M.eq(d))throw Error(i+"NaN");if(F.s<1)throw Error(i+(F.s?"NaN":"-Infinity"));return F.eq(d)?new L(0):(n=!1,O=b(T(F,j),T(M,j),j),n=!0,C(O,B))},f.minus=f.sub=function(M){var O=this;return M=new O.constructor(M),O.s==M.s?N(O,M):y(O,(M.s=-M.s,M))},f.modulo=f.mod=function(M){var O,F=this,L=F.constructor,B=L.precision;if(M=new L(M),!M.s)throw Error(i+"NaN");return F.s?(n=!1,O=b(F,M,0,1).times(M),n=!0,F.minus(O)):C(new L(F),B)},f.naturalExponential=f.exp=function(){return w(this)},f.naturalLogarithm=f.ln=function(){return T(this)},f.negated=f.neg=function(){var M=new this.constructor(this);return M.s=-M.s||0,M},f.plus=f.add=function(M){var O=this;return M=new O.constructor(M),O.s==M.s?y(O,M):N(O,(M.s=-M.s,M))},f.precision=f.sd=function(M){var O,F,L,B=this;if(M!==void 0&&M!==!!M&&M!==1&&M!==0)throw Error(o+M);if(O=k(B)+1,L=B.d.length-1,F=L*p+1,L=B.d[L],L){for(;L%10==0;L/=10)F--;for(L=B.d[0];L>=10;L/=10)F++}return M&&O>F?O:F},f.squareRoot=f.sqrt=function(){var M,O,F,L,B,j,_,H=this,q=H.constructor;if(H.s<1){if(!H.s)return new q(0);throw Error(i+"NaN")}for(M=k(H),n=!1,B=Math.sqrt(+H),B==0||B==1/0?(O=v(H.d),(O.length+M)%2==0&&(O+="0"),B=Math.sqrt(O),M=s((M+1)/2)-(M<0||M%2),B==1/0?O="5e"+M:(O=B.toExponential(),O=O.slice(0,O.indexOf("e")+1)+M),L=new q(O)):L=new q(B.toString()),F=q.precision,B=_=F+3;;)if(j=L,L=j.plus(b(H,j,_+2)).times(.5),v(j.d).slice(0,_)===(O=v(L.d)).slice(0,_)){if(O=O.slice(_-3,_+1),B==_&&O=="4999"){if(C(j,F+1,0),j.times(j).eq(H)){L=j;break}}else if(O!="9999")break;_+=4}return n=!0,C(L,F)},f.times=f.mul=function(M){var O,F,L,B,j,_,H,q,X,U=this,Y=U.constructor,R=U.d,V=(M=new Y(M)).d;if(!U.s||!M.s)return new Y(0);for(M.s*=U.s,F=U.e+M.e,q=R.length,X=V.length,q<X&&(j=R,R=V,V=j,_=q,q=X,X=_),j=[],_=q+X,L=_;L--;)j.push(0);for(L=X;--L>=0;){for(O=0,B=q+L;B>L;)H=j[B]+V[L]*R[B-L-1]+O,j[B--]=H%u|0,O=H/u|0;j[B]=(j[B]+O)%u|0}for(;!j[--_];)j.pop();return O?++F:j.shift(),M.d=j,M.e=F,n?C(M,Y.precision):M},f.toDecimalPlaces=f.todp=function(M,O){var F=this,L=F.constructor;return F=new L(F),M===void 0?F:(h(M,0,t),O===void 0?O=L.rounding:h(O,0,8),C(F,M+k(F)+1,O))},f.toExponential=function(M,O){var F,L=this,B=L.constructor;return M===void 0?F=D(L,!0):(h(M,0,t),O===void 0?O=B.rounding:h(O,0,8),L=C(new B(L),M+1,O),F=D(L,!0,M+1)),F},f.toFixed=function(M,O){var F,L,B=this,j=B.constructor;return M===void 0?D(B):(h(M,0,t),O===void 0?O=j.rounding:h(O,0,8),L=C(new j(B),M+k(B)+1,O),F=D(L.abs(),!1,M+k(L)+1),B.isneg()&&!B.isZero()?"-"+F:F)},f.toInteger=f.toint=function(){var M=this,O=M.constructor;return C(new O(M),k(M)+1,O.rounding)},f.toNumber=function(){return+this},f.toPower=f.pow=function(M){var O,F,L,B,j,_,H=this,q=H.constructor,X=12,U=+(M=new q(M));if(!M.s)return new q(d);if(H=new q(H),!H.s){if(M.s<1)throw Error(i+"Infinity");return H}if(H.eq(d))return H;if(L=q.precision,M.eq(d))return C(H,L);if(O=M.e,F=M.d.length-1,_=O>=F,j=H.s,_){if((F=U<0?-U:U)<=m){for(B=new q(d),O=Math.ceil(L/p+4),n=!1;F%2&&(B=B.times(H),A(B.d,O)),F=s(F/2),F!==0;)H=H.times(H),A(H.d,O);return n=!0,M.s<0?new q(d).div(B):C(B,L)}}else if(j<0)throw Error(i+"NaN");return j=j<0&&M.d[Math.max(O,F)]&1?-1:1,H.s=1,n=!1,B=M.times(T(H,L+X)),n=!0,B=w(B),B.s=j,B},f.toPrecision=function(M,O){var F,L,B=this,j=B.constructor;return M===void 0?(F=k(B),L=D(B,F<=j.toExpNeg||F>=j.toExpPos)):(h(M,1,t),O===void 0?O=j.rounding:h(O,0,8),B=C(new j(B),M,O),F=k(B),L=D(B,M<=F||F<=j.toExpNeg,M)),L},f.toSignificantDigits=f.tosd=function(M,O){var F=this,L=F.constructor;return M===void 0?(M=L.precision,O=L.rounding):(h(M,1,t),O===void 0?O=L.rounding:h(O,0,8)),C(new L(F),M,O)},f.toString=f.valueOf=f.val=f.toJSON=function(){var M=this,O=k(M),F=M.constructor;return D(M,O<=F.toExpNeg||O>=F.toExpPos)};function y(M,O){var F,L,B,j,_,H,q,X,U=M.constructor,Y=U.precision;if(!M.s||!O.s)return O.s||(O=new U(M)),n?C(O,Y):O;if(q=M.d,X=O.d,_=M.e,B=O.e,q=q.slice(),j=_-B,j){for(j<0?(L=q,j=-j,H=X.length):(L=X,B=_,H=q.length),_=Math.ceil(Y/p),H=_>H?_+1:H+1,j>H&&(j=H,L.length=1),L.reverse();j--;)L.push(0);L.reverse()}for(H=q.length,j=X.length,H-j<0&&(j=H,L=X,X=q,q=L),F=0;j;)F=(q[--j]=q[j]+X[j]+F)/u|0,q[j]%=u;for(F&&(q.unshift(F),++B),H=q.length;q[--H]==0;)q.pop();return O.d=q,O.e=B,n?C(O,Y):O}function h(M,O,F){if(M!==~~M||M<O||M>F)throw Error(o+M)}function v(M){var O,F,L,B=M.length-1,j="",_=M[0];if(B>0){for(j+=_,O=1;O<B;O++)L=M[O]+"",F=p-L.length,F&&(j+=x(F)),j+=L;_=M[O],L=_+"",F=p-L.length,F&&(j+=x(F))}else if(_===0)return"0";for(;_%10===0;)_/=10;return j+_}var b=function(){function M(L,B){var j,_=0,H=L.length;for(L=L.slice();H--;)j=L[H]*B+_,L[H]=j%u|0,_=j/u|0;return _&&L.unshift(_),L}function O(L,B,j,_){var H,q;if(j!=_)q=j>_?1:-1;else for(H=q=0;H<j;H++)if(L[H]!=B[H]){q=L[H]>B[H]?1:-1;break}return q}function F(L,B,j){for(var _=0;j--;)L[j]-=_,_=L[j]<B[j]?1:0,L[j]=_*u+L[j]-B[j];for(;!L[0]&&L.length>1;)L.shift()}return function(L,B,j,_){var H,q,X,U,Y,R,V,G,J,K,ne,te,oe,de,xe,je,nt,Qe,ze=L.constructor,Rr=L.s==B.s?1:-1,nr=L.d,ft=B.d;if(!L.s)return new ze(L);if(!B.s)throw Error(i+"Division by zero");for(q=L.e-B.e,nt=ft.length,xe=nr.length,V=new ze(Rr),G=V.d=[],X=0;ft[X]==(nr[X]||0);)++X;if(ft[X]>(nr[X]||0)&&--q,j==null?te=j=ze.precision:_?te=j+(k(L)-k(B))+1:te=j,te<0)return new ze(0);if(te=te/p+2|0,X=0,nt==1)for(U=0,ft=ft[0],te++;(X<xe||U)&&te--;X++)oe=U*u+(nr[X]||0),G[X]=oe/ft|0,U=oe%ft|0;else{for(U=u/(ft[0]+1)|0,U>1&&(ft=M(ft,U),nr=M(nr,U),nt=ft.length,xe=nr.length),de=nt,J=nr.slice(0,nt),K=J.length;K<nt;)J[K++]=0;Qe=ft.slice(),Qe.unshift(0),je=ft[0],ft[1]>=u/2&&++je;do U=0,H=O(ft,J,nt,K),H<0?(ne=J[0],nt!=K&&(ne=ne*u+(J[1]||0)),U=ne/je|0,U>1?(U>=u&&(U=u-1),Y=M(ft,U),R=Y.length,K=J.length,H=O(Y,J,R,K),H==1&&(U--,F(Y,nt<R?Qe:ft,R))):(U==0&&(H=U=1),Y=ft.slice()),R=Y.length,R<K&&Y.unshift(0),F(J,Y,K),H==-1&&(K=J.length,H=O(ft,J,nt,K),H<1&&(U++,F(J,nt<K?Qe:ft,K))),K=J.length):H===0&&(U++,J=[0]),G[X++]=U,H&&J[0]?J[K++]=nr[de]||0:(J=[nr[de]],K=1);while((de++<xe||J[0]!==void 0)&&te--)}return G[0]||G.shift(),V.e=q,C(V,_?j+k(V)+1:j)}}();function w(M,O){var F,L,B,j,_,H,q=0,X=0,U=M.constructor,Y=U.precision;if(k(M)>16)throw Error(a+k(M));if(!M.s)return new U(d);for(O==null?(n=!1,H=Y):H=O,_=new U(.03125);M.abs().gte(.1);)M=M.times(_),X+=5;for(L=Math.log(l(2,X))/Math.LN10*2+5|0,H+=L,F=B=j=new U(d),U.precision=H;;){if(B=C(B.times(M),H),F=F.times(++q),_=j.plus(b(B,F,H)),v(_.d).slice(0,H)===v(j.d).slice(0,H)){for(;X--;)j=C(j.times(j),H);return U.precision=Y,O==null?(n=!0,C(j,Y)):j}j=_}}function k(M){for(var O=M.e*p,F=M.d[0];F>=10;F/=10)O++;return O}function S(M,O,F){if(O>M.LN10.sd())throw n=!0,F&&(M.precision=F),Error(i+"LN10 precision limit exceeded");return C(new M(M.LN10),O)}function x(M){for(var O="";M--;)O+="0";return O}function T(M,O){var F,L,B,j,_,H,q,X,U,Y=1,R=10,V=M,G=V.d,J=V.constructor,K=J.precision;if(V.s<1)throw Error(i+(V.s?"NaN":"-Infinity"));if(V.eq(d))return new J(0);if(O==null?(n=!1,X=K):X=O,V.eq(10))return O==null&&(n=!0),S(J,X);if(X+=R,J.precision=X,F=v(G),L=F.charAt(0),j=k(V),Math.abs(j)<15e14){for(;L<7&&L!=1||L==1&&F.charAt(1)>3;)V=V.times(M),F=v(V.d),L=F.charAt(0),Y++;j=k(V),L>1?(V=new J("0."+F),j++):V=new J(L+"."+F.slice(1))}else return q=S(J,X+2,K).times(j+""),V=T(new J(L+"."+F.slice(1)),X-R).plus(q),J.precision=K,O==null?(n=!0,C(V,K)):V;for(H=_=V=b(V.minus(d),V.plus(d),X),U=C(V.times(V),X),B=3;;){if(_=C(_.times(U),X),q=H.plus(b(_,new J(B),X)),v(q.d).slice(0,X)===v(H.d).slice(0,X))return H=H.times(2),j!==0&&(H=H.plus(S(J,X+2,K).times(j+""))),H=b(H,new J(Y),X),J.precision=K,O==null?(n=!0,C(H,K)):H;H=q,B+=2}}function E(M,O){var F,L,B;for((F=O.indexOf("."))>-1&&(O=O.replace(".","")),(L=O.search(/e/i))>0?(F<0&&(F=L),F+=+O.slice(L+1),O=O.substring(0,L)):F<0&&(F=O.length),L=0;O.charCodeAt(L)===48;)++L;for(B=O.length;O.charCodeAt(B-1)===48;)--B;if(O=O.slice(L,B),O){if(B-=L,F=F-L-1,M.e=s(F/p),M.d=[],L=(F+1)%p,F<0&&(L+=p),L<B){for(L&&M.d.push(+O.slice(0,L)),B-=p;L<B;)M.d.push(+O.slice(L,L+=p));O=O.slice(L),L=p-O.length}else L-=B;for(;L--;)O+="0";if(M.d.push(+O),n&&(M.e>g||M.e<-g))throw Error(a+F)}else M.s=0,M.e=0,M.d=[0];return M}function C(M,O,F){var L,B,j,_,H,q,X,U,Y=M.d;for(_=1,j=Y[0];j>=10;j/=10)_++;if(L=O-_,L<0)L+=p,B=O,X=Y[U=0];else{if(U=Math.ceil((L+1)/p),j=Y.length,U>=j)return M;for(X=j=Y[U],_=1;j>=10;j/=10)_++;L%=p,B=L-p+_}if(F!==void 0&&(j=l(10,_-B-1),H=X/j%10|0,q=O<0||Y[U+1]!==void 0||X%j,q=F<4?(H||q)&&(F==0||F==(M.s<0?3:2)):H>5||H==5&&(F==4||q||F==6&&(L>0?B>0?X/l(10,_-B):0:Y[U-1])%10&1||F==(M.s<0?8:7))),O<1||!Y[0])return q?(j=k(M),Y.length=1,O=O-j-1,Y[0]=l(10,(p-O%p)%p),M.e=s(-O/p)||0):(Y.length=1,Y[0]=M.e=M.s=0),M;if(L==0?(Y.length=U,j=1,U--):(Y.length=U+1,j=l(10,p-L),Y[U]=B>0?(X/l(10,_-B)%l(10,B)|0)*j:0),q)for(;;)if(U==0){(Y[0]+=j)==u&&(Y[0]=1,++M.e);break}else{if(Y[U]+=j,Y[U]!=u)break;Y[U--]=0,j=1}for(L=Y.length;Y[--L]===0;)Y.pop();if(n&&(M.e>g||M.e<-g))throw Error(a+k(M));return M}function N(M,O){var F,L,B,j,_,H,q,X,U,Y,R=M.constructor,V=R.precision;if(!M.s||!O.s)return O.s?O.s=-O.s:O=new R(M),n?C(O,V):O;if(q=M.d,Y=O.d,L=O.e,X=M.e,q=q.slice(),_=X-L,_){for(U=_<0,U?(F=q,_=-_,H=Y.length):(F=Y,L=X,H=q.length),B=Math.max(Math.ceil(V/p),H)+2,_>B&&(_=B,F.length=1),F.reverse(),B=_;B--;)F.push(0);F.reverse()}else{for(B=q.length,H=Y.length,U=B<H,U&&(H=B),B=0;B<H;B++)if(q[B]!=Y[B]){U=q[B]<Y[B];break}_=0}for(U&&(F=q,q=Y,Y=F,O.s=-O.s),H=q.length,B=Y.length-H;B>0;--B)q[H++]=0;for(B=Y.length;B>_;){if(q[--B]<Y[B]){for(j=B;j&&q[--j]===0;)q[j]=u-1;--q[j],q[B]+=u}q[B]-=Y[B]}for(;q[--H]===0;)q.pop();for(;q[0]===0;q.shift())--L;return q[0]?(O.d=q,O.e=L,n?C(O,V):O):new R(0)}function D(M,O,F){var L,B=k(M),j=v(M.d),_=j.length;return O?(F&&(L=F-_)>0?j=j.charAt(0)+"."+j.slice(1)+x(L):_>1&&(j=j.charAt(0)+"."+j.slice(1)),j=j+(B<0?"e":"e+")+B):B<0?(j="0."+x(-B-1)+j,F&&(L=F-_)>0&&(j+=x(L))):B>=_?(j+=x(B+1-_),F&&(L=F-B-1)>0&&(j=j+"."+x(L))):((L=B+1)<_&&(j=j.slice(0,L)+"."+j.slice(L)),F&&(L=F-_)>0&&(B+1===_&&(j+="."),j+=x(L))),M.s<0?"-"+j:j}function A(M,O){if(M.length>O)return M.length=O,!0}function P(M){var O,F,L;function B(j){var _=this;if(!(_ instanceof B))return new B(j);if(_.constructor=B,j instanceof B){_.s=j.s,_.e=j.e,_.d=(j=j.d)?j.slice():j;return}if(typeof j=="number"){if(j*0!==0)throw Error(o+j);if(j>0)_.s=1;else if(j<0)j=-j,_.s=-1;else{_.s=0,_.e=0,_.d=[0];return}if(j===~~j&&j<1e7){_.e=0,_.d=[j];return}return E(_,j.toString())}else if(typeof j!="string")throw Error(o+j);if(j.charCodeAt(0)===45?(j=j.slice(1),_.s=-1):_.s=1,c.test(j))E(_,j);else throw Error(o+j)}if(B.prototype=f,B.ROUND_UP=0,B.ROUND_DOWN=1,B.ROUND_CEIL=2,B.ROUND_FLOOR=3,B.ROUND_HALF_UP=4,B.ROUND_HALF_DOWN=5,B.ROUND_HALF_EVEN=6,B.ROUND_HALF_CEIL=7,B.ROUND_HALF_FLOOR=8,B.clone=P,B.config=B.set=I,M===void 0&&(M={}),M)for(L=["precision","rounding","toExpNeg","toExpPos","LN10"],O=0;O<L.length;)M.hasOwnProperty(F=L[O++])||(M[F]=this[F]);return B.config(M),B}function I(M){if(!M||typeof M!="object")throw Error(i+"Object expected");var O,F,L,B=["precision",1,t,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(O=0;O<B.length;O+=3)if((L=M[F=B[O]])!==void 0)if(s(L)===L&&L>=B[O+1]&&L<=B[O+2])this[F]=L;else throw Error(o+F+": "+L);if((L=M[F="LN10"])!==void 0)if(L==Math.LN10)this[F]=new this(L);else throw Error(o+F+": "+L);return this}r=P(r),r.default=r.Decimal=r,d=new r(1),typeof define=="function"&&define.amd?define(function(){return r}):typeof R0!="undefined"&&R0.exports?R0.exports=r:(e||(e=typeof self!="undefined"&&self&&self.self==self?self:Function("return this")()),e.Decimal=r)})(_W)});var VB=le((hRe,XN)=>{"use strict";var Uie=Object.prototype.hasOwnProperty,ji="~";function xv(){}Object.create&&(xv.prototype=Object.create(null),new xv().__proto__||(ji=!1));function Vie(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function UB(e,t,r,n,i){if(typeof r!="function")throw new TypeError("The listener must be a function");var o=new Vie(r,n||e,i),a=ji?ji+t:t;return e._events[a]?e._events[a].fn?e._events[a]=[e._events[a],o]:e._events[a].push(o):(e._events[a]=o,e._eventsCount++),e}function xk(e,t){--e._eventsCount===0?e._events=new xv:delete e._events[t]}function pi(){this._events=new xv,this._eventsCount=0}pi.prototype.eventNames=function(){var t=[],r,n;if(this._eventsCount===0)return t;for(n in r=this._events)Uie.call(r,n)&&t.push(ji?n.slice(1):n);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(r)):t};pi.prototype.listeners=function(t){var r=ji?ji+t:t,n=this._events[r];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,a=new Array(o);i<o;i++)a[i]=n[i].fn;return a};pi.prototype.listenerCount=function(t){var r=ji?ji+t:t,n=this._events[r];return n?n.fn?1:n.length:0};pi.prototype.emit=function(t,r,n,i,o,a){var s=ji?ji+t:t;if(!this._events[s])return!1;var l=this._events[s],c=arguments.length,d,u;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),c){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,r),!0;case 3:return l.fn.call(l.context,r,n),!0;case 4:return l.fn.call(l.context,r,n,i),!0;case 5:return l.fn.call(l.context,r,n,i,o),!0;case 6:return l.fn.call(l.context,r,n,i,o,a),!0}for(u=1,d=new Array(c-1);u<c;u++)d[u-1]=arguments[u];l.fn.apply(l.context,d)}else{var p=l.length,m;for(u=0;u<p;u++)switch(l[u].once&&this.removeListener(t,l[u].fn,void 0,!0),c){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,r);break;case 3:l[u].fn.call(l[u].context,r,n);break;case 4:l[u].fn.call(l[u].context,r,n,i);break;default:if(!d)for(m=1,d=new Array(c-1);m<c;m++)d[m-1]=arguments[m];l[u].fn.apply(l[u].context,d)}}return!0};pi.prototype.on=function(t,r,n){return UB(this,t,r,n,!1)};pi.prototype.once=function(t,r,n){return UB(this,t,r,n,!0)};pi.prototype.removeListener=function(t,r,n,i){var o=ji?ji+t:t;if(!this._events[o])return this;if(!r)return xk(this,o),this;var a=this._events[o];if(a.fn)a.fn===r&&(!i||a.once)&&(!n||a.context===n)&&xk(this,o);else{for(var s=0,l=[],c=a.length;s<c;s++)(a[s].fn!==r||i&&!a[s].once||n&&a[s].context!==n)&&l.push(a[s]);l.length?this._events[o]=l.length===1?l[0]:l:xk(this,o)}return this};pi.prototype.removeAllListeners=function(t){var r;return t?(r=ji?ji+t:t,this._events[r]&&xk(this,r)):(this._events=new xv,this._eventsCount=0),this};pi.prototype.off=pi.prototype.removeListener;pi.prototype.addListener=pi.prototype.on;pi.prefixed=ji;pi.EventEmitter=pi;typeof XN!="undefined"&&(XN.exports=pi)});var l3=le(eM=>{"use strict";Object.defineProperty(eM,Symbol.toStringTag,{value:"Module"});function roe(e,t,{signal:r,edges:n}={}){let i,o=null,a=n!=null&&n.includes("leading"),s=n==null||n.includes("trailing"),l=()=>{o!==null&&(e.apply(i,o),i=void 0,o=null)},c=()=>{s&&l(),m()},d=null,u=()=>{d!=null&&clearTimeout(d),d=setTimeout(()=>{d=null,c()},t)},p=()=>{d!==null&&(clearTimeout(d),d=null)},m=()=>{p(),i=void 0,o=null},g=()=>{p(),l()},f=function(...y){if(r!=null&&r.aborted)return;i=this,o=y;let h=d==null;u(),a&&h&&l()};return f.schedule=u,f.cancel=m,f.flush=g,r==null||r.addEventListener("abort",m,{once:!0}),f}eM.debounce=roe});var c3=le(tM=>{"use strict";Object.defineProperty(tM,Symbol.toStringTag,{value:"Module"});var noe=l3();function ioe(e,t=0,r={}){typeof r!="object"&&(r={});let{leading:n=!1,trailing:i=!0,maxWait:o}=r,a=Array(2);n&&(a[0]="leading"),i&&(a[1]="trailing");let s,l=null,c=noe.debounce(function(...p){s=e.apply(this,p),l=null},t,{edges:a}),d=function(...p){return o!=null&&(l===null&&(l=Date.now()),Date.now()-l>=o)?(s=e.apply(this,p),l=Date.now(),c.cancel(),c.schedule(),s):(c.apply(this,p),s)},u=()=>(c.flush(),s);return d.cancel=c.cancel,d.flush=u,d}tM.debounce=ioe});var d3=le(rM=>{"use strict";Object.defineProperty(rM,Symbol.toStringTag,{value:"Module"});var ooe=c3();function aoe(e,t=0,r={}){typeof r!="object"&&(r={});let{leading:n=!0,trailing:i=!0}=r;return ooe.debounce(e,t,{leading:n,trailing:i,maxWait:t})}rM.throttle=aoe});var p3=le((r5e,u3)=>{u3.exports=d3().throttle});var N3=le(lM=>{"use strict";Object.defineProperty(lM,Symbol.toStringTag,{value:"Module"});function Uoe(e){return e[e.length-1]}lM.last=Uoe});var M3=le(cM=>{"use strict";Object.defineProperty(cM,Symbol.toStringTag,{value:"Module"});function Voe(e){return Array.isArray(e)?e:Array.from(e)}cM.toArray=Voe});var O3=le(dM=>{"use strict";Object.defineProperty(dM,Symbol.toStringTag,{value:"Module"});var Hoe=N3(),qoe=M3(),Goe=ux();function Yoe(e){if(Goe.isArrayLike(e))return Hoe.last(qoe.toArray(e))}dM.last=Yoe});var F3=le((N5e,I3)=>{I3.exports=O3().last});var Z3=le(pM=>{"use strict";Object.defineProperty(pM,Symbol.toStringTag,{value:"Module"});function uae(e){var r;if(typeof e!="object"||e==null)return!1;if(Object.getPrototypeOf(e)===null)return!0;if(Object.prototype.toString.call(e)!=="[object Object]"){let n=e[Symbol.toStringTag];return n==null||!((r=Object.getOwnPropertyDescriptor(e,Symbol.toStringTag))!=null&&r.writable)?!1:e.toString()===`[object ${n}]`}let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}pM.isPlainObject=uae});var t6=le((e4e,e6)=>{e6.exports=Z3().isPlainObject});var HU=le(VU=>{"use strict";var Iv=W();function Tce(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Cce=typeof Object.is=="function"?Object.is:Tce,Ece=Iv.useSyncExternalStore,Dce=Iv.useRef,Pce=Iv.useEffect,Ace=Iv.useMemo,Nce=Iv.useDebugValue;VU.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var o=Dce(null);if(o.current===null){var a={hasValue:!1,value:null};o.current=a}else a=o.current;o=Ace(function(){function l(m){if(!c){if(c=!0,d=m,m=n(m),i!==void 0&&a.hasValue){var g=a.value;if(i(g,m))return u=g}return u=m}if(g=u,Cce(d,m))return g;var f=n(m);return i!==void 0&&i(g,f)?(d=m,g):(d=m,u=f)}var c=!1,d,u,p=r===void 0?null:r;return[function(){return l(t())},p===null?void 0:function(){return l(p())}]},[t,r,n,i]);var s=Ece(e,o[0],o[1]);return Pce(function(){a.hasValue=!0,a.value=s},[s]),Nce(s),s}});var GU=le((O6e,qU)=>{"use strict";qU.exports=HU()});var SS=le((kS,XV)=>{(function(e,t){typeof kS=="object"&&typeof XV!="undefined"?t(kS):typeof define=="function"&&define.amd?define(["exports"],t):(e=typeof globalThis!="undefined"?globalThis:e||self,t(e["fast-equals"]={}))})(kS,function(e){"use strict";function t(U){return function(R,V,G,J,K,ne,te){return U(R,V,te)}}function r(U){return function(R,V,G,J){if(!R||!V||typeof R!="object"||typeof V!="object")return U(R,V,G,J);var K=J.get(R),ne=J.get(V);if(K&&ne)return K===V&&ne===R;J.set(R,V),J.set(V,R);var te=U(R,V,G,J);return J.delete(R),J.delete(V),te}}function n(U,Y){var R={};for(var V in U)R[V]=U[V];for(var V in Y)R[V]=Y[V];return R}function i(U){return U.constructor===Object||U.constructor==null}function o(U){return typeof U.then=="function"}function a(U,Y){return U===Y||U!==U&&Y!==Y}var s="[object Arguments]",l="[object Boolean]",c="[object Date]",d="[object RegExp]",u="[object Map]",p="[object Number]",m="[object Object]",g="[object Set]",f="[object String]",y=Object.prototype.toString;function h(U){var Y=U.areArraysEqual,R=U.areDatesEqual,V=U.areMapsEqual,G=U.areObjectsEqual,J=U.areRegExpsEqual,K=U.areSetsEqual,ne=U.createIsNestedEqual,te=ne(oe);function oe(de,xe,je){if(de===xe)return!0;if(!de||!xe||typeof de!="object"||typeof xe!="object")return de!==de&&xe!==xe;if(i(de)&&i(xe))return G(de,xe,te,je);var nt=Array.isArray(de),Qe=Array.isArray(xe);if(nt||Qe)return nt===Qe&&Y(de,xe,te,je);var ze=y.call(de);return ze!==y.call(xe)?!1:ze===c?R(de,xe,te,je):ze===d?J(de,xe,te,je):ze===u?V(de,xe,te,je):ze===g?K(de,xe,te,je):ze===m||ze===s?o(de)||o(xe)?!1:G(de,xe,te,je):ze===l||ze===p||ze===f?a(de.valueOf(),xe.valueOf()):!1}return oe}function v(U,Y,R,V){var G=U.length;if(Y.length!==G)return!1;for(;G-- >0;)if(!R(U[G],Y[G],G,G,U,Y,V))return!1;return!0}var b=r(v);function w(U,Y){return a(U.valueOf(),Y.valueOf())}function k(U,Y,R,V){var G=U.size===Y.size;if(!G)return!1;if(!U.size)return!0;var J={},K=0;return U.forEach(function(ne,te){if(G){var oe=!1,de=0;Y.forEach(function(xe,je){!oe&&!J[de]&&(oe=R(te,je,K,de,U,Y,V)&&R(ne,xe,te,je,U,Y,V))&&(J[de]=!0),de++}),K++,G=oe}}),G}var S=r(k),x="_owner",T=Object.prototype.hasOwnProperty;function E(U,Y,R,V){var G=Object.keys(U),J=G.length;if(Object.keys(Y).length!==J)return!1;for(var K;J-- >0;){if(K=G[J],K===x){var ne=!!U.$$typeof,te=!!Y.$$typeof;if((ne||te)&&ne!==te)return!1}if(!T.call(Y,K)||!R(U[K],Y[K],K,K,U,Y,V))return!1}return!0}var C=r(E);function N(U,Y){return U.source===Y.source&&U.flags===Y.flags}function D(U,Y,R,V){var G=U.size===Y.size;if(!G)return!1;if(!U.size)return!0;var J={};return U.forEach(function(K,ne){if(G){var te=!1,oe=0;Y.forEach(function(de,xe){!te&&!J[oe]&&(te=R(K,de,ne,xe,U,Y,V))&&(J[oe]=!0),oe++}),G=te}}),G}var A=r(D),P=Object.freeze({areArraysEqual:v,areDatesEqual:w,areMapsEqual:k,areObjectsEqual:E,areRegExpsEqual:N,areSetsEqual:D,createIsNestedEqual:t}),I=Object.freeze({areArraysEqual:b,areDatesEqual:w,areMapsEqual:S,areObjectsEqual:C,areRegExpsEqual:N,areSetsEqual:A,createIsNestedEqual:t}),M=h(P);function O(U,Y){return M(U,Y,void 0)}var F=h(n(P,{createIsNestedEqual:function(){return a}}));function L(U,Y){return F(U,Y,void 0)}var B=h(I);function j(U,Y){return B(U,Y,new WeakMap)}var _=h(n(I,{createIsNestedEqual:function(){return a}}));function H(U,Y){return _(U,Y,new WeakMap)}function q(U){return h(n(P,U(P)))}function X(U){var Y=h(n(I,U(I)));return function(R,V,G){return G===void 0&&(G=new WeakMap),Y(R,V,G)}}e.circularDeepEqual=j,e.circularShallowEqual=H,e.createCustomCircularEqual=X,e.createCustomEqual=q,e.deepEqual=O,e.sameValueZeroEqual=a,e.shallowEqual=L,Object.defineProperty(e,"__esModule",{value:!0})})});var TS=le((RYe,fO)=>{function ZV(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(r=ZV(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function QV(){for(var e,t,r=0,n="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=ZV(e))&&(n&&(n+=" "),n+=t);return n}fO.exports=QV,fO.exports.clsx=QV});var tH=le((WYe,eH)=>{eH.exports=function(t,r,n){return t===r?!0:t.className===r.className&&n(t.style,r.style)&&t.width===r.width&&t.autoSize===r.autoSize&&t.cols===r.cols&&t.draggableCancel===r.draggableCancel&&t.draggableHandle===r.draggableHandle&&n(t.verticalCompact,r.verticalCompact)&&n(t.compactType,r.compactType)&&n(t.layout,r.layout)&&n(t.margin,r.margin)&&n(t.containerPadding,r.containerPadding)&&t.rowHeight===r.rowHeight&&t.maxRows===r.maxRows&&t.isBounded===r.isBounded&&t.isDraggable===r.isDraggable&&t.isResizable===r.isResizable&&t.allowOverlap===r.allowOverlap&&t.preventCollision===r.preventCollision&&t.useCSSTransforms===r.useCSSTransforms&&t.transformScale===r.transformScale&&t.isDroppable===r.isDroppable&&n(t.resizeHandles,r.resizeHandles)&&n(t.resizeHandle,r.resizeHandle)&&t.onLayoutChange===r.onLayoutChange&&t.onDragStart===r.onDragStart&&t.onDrag===r.onDrag&&t.onDragStop===r.onDragStop&&t.onResizeStart===r.onResizeStart&&t.onResize===r.onResize&&t.onResizeStop===r.onResizeStop&&t.onDrop===r.onDrop&&n(t.droppingItem,r.droppingItem)&&n(t.innerRef,r.innerRef)}});var Du=le(xt=>{"use strict";Object.defineProperty(xt,"__esModule",{value:!0});xt.bottom=vO;xt.childrenEqual=hpe;xt.cloneLayout=nH;xt.cloneLayoutItem=Eu;xt.collides=ES;xt.compact=oH;xt.compactItem=aH;xt.compactType=Ape;xt.correctBounds=sH;xt.fastPositionEqual=vpe;xt.fastRGLPropsEqual=void 0;xt.getAllCollisions=lH;xt.getFirstCollision=Cu;xt.getLayoutItem=yO;xt.getStatics=bO;xt.modifyLayout=iH;xt.moveElement=Zv;xt.moveElementAwayFromCollision=hO;xt.noop=void 0;xt.perc=bpe;xt.resizeItemInDirection=Cpe;xt.setTopLeft=Dpe;xt.setTransform=Epe;xt.sortLayoutItems=CO;xt.sortLayoutItemsByColRow=mH;xt.sortLayoutItemsByRowCol=pH;xt.synchronizeLayoutWithChildren=Ppe;xt.validateLayout=fH;xt.withLayoutItem=gpe;var rH=SS(),Qv=ppe(W());function ppe(e){return e&&e.__esModule?e:{default:e}}var mpe=!0,fpe=!1;function vO(e){let t=0,r;for(let n=0,i=e.length;n<i;n++)r=e[n].y+e[n].h,r>t&&(t=r);return t}function nH(e){let t=Array(e.length);for(let r=0,n=e.length;r<n;r++)t[r]=Eu(e[r]);return t}function iH(e,t){let r=Array(e.length);for(let n=0,i=e.length;n<i;n++)t.i===e[n].i?r[n]=t:r[n]=e[n];return r}function gpe(e,t,r){let n=yO(e,t);return n?(n=r(Eu(n)),e=iH(e,n),[e,n]):[e,null]}function Eu(e){return{w:e.w,h:e.h,x:e.x,y:e.y,i:e.i,minW:e.minW,maxW:e.maxW,minH:e.minH,maxH:e.maxH,moved:!!e.moved,static:!!e.static,isDraggable:e.isDraggable,isResizable:e.isResizable,resizeHandles:e.resizeHandles,isBounded:e.isBounded}}function hpe(e,t){return(0,rH.deepEqual)(Qv.default.Children.map(e,r=>r==null?void 0:r.key),Qv.default.Children.map(t,r=>r==null?void 0:r.key))&&(0,rH.deepEqual)(Qv.default.Children.map(e,r=>r==null?void 0:r.props["data-grid"]),Qv.default.Children.map(t,r=>r==null?void 0:r.props["data-grid"]))}var BYe=xt.fastRGLPropsEqual=tH();function vpe(e,t){return e.left===t.left&&e.top===t.top&&e.width===t.width&&e.height===t.height}function ES(e,t){return!(e.i===t.i||e.x+e.w<=t.x||e.x>=t.x+t.w||e.y+e.h<=t.y||e.y>=t.y+t.h)}function oH(e,t,r,n){let i=bO(e),o=CO(e,t),a=Array(e.length);for(let s=0,l=o.length;s<l;s++){let c=Eu(o[s]);c.static||(c=aH(i,c,t,r,o,n),i.push(c)),a[e.indexOf(o[s])]=c,c.moved=!1}return a}var ype={x:"w",y:"h"};function gO(e,t,r,n){let i=ype[n];t[n]+=1;let o=e.map(a=>a.i).indexOf(t.i);for(let a=o+1;a<e.length;a++){let s=e[a];if(!s.static){if(s.y>t.y+t.h)break;ES(t,s)&&gO(e,s,r+t[i],n)}}t[n]=r}function aH(e,t,r,n,i,o){let a=r==="vertical",s=r==="horizontal";if(a)for(t.y=Math.min(vO(e),t.y);t.y>0&&!Cu(e,t);)t.y--;else if(s)for(;t.x>0&&!Cu(e,t);)t.x--;let l;for(;(l=Cu(e,t))&&!(r===null&&o);)if(s?gO(i,t,l.x+l.w,"x"):gO(i,t,l.y+l.h,"y"),s&&t.x+t.w>n)for(t.x=n-t.w,t.y++;t.x>0&&!Cu(e,t);)t.x--;return t.y=Math.max(t.y,0),t.x=Math.max(t.x,0),t}function sH(e,t){let r=bO(e);for(let n=0,i=e.length;n<i;n++){let o=e[n];if(o.x+o.w>t.cols&&(o.x=t.cols-o.w),o.x<0&&(o.x=0,o.w=t.cols),!o.static)r.push(o);else for(;Cu(r,o);)o.y++}return e}function yO(e,t){for(let r=0,n=e.length;r<n;r++)if(e[r].i===t)return e[r]}function Cu(e,t){for(let r=0,n=e.length;r<n;r++)if(ES(e[r],t))return e[r]}function lH(e,t){return e.filter(r=>ES(r,t))}function bO(e){return e.filter(t=>t.static)}function Zv(e,t,r,n,i,o,a,s,l){if(t.static&&t.isDraggable!==!0||t.y===n&&t.x===r)return e;CS(`Moving element ${t.i} to [${String(r)},${String(n)}] from [${t.x},${t.y}]`);let c=t.x,d=t.y;typeof r=="number"&&(t.x=r),typeof n=="number"&&(t.y=n),t.moved=!0;let u=CO(e,a);(a==="vertical"&&typeof n=="number"?d>=n:a==="horizontal"&&typeof r=="number"?c>=r:!1)&&(u=u.reverse());let m=lH(u,t),g=m.length>0;if(g&&l)return nH(e);if(g&&o)return CS(`Collision prevented on ${t.i}, reverting.`),t.x=c,t.y=d,t.moved=!1,e;for(let f=0,y=m.length;f<y;f++){let h=m[f];CS(`Resolving collision between ${t.i} at [${t.x},${t.y}] and ${h.i} at [${h.x},${h.y}]`),!h.moved&&(h.static?e=hO(e,h,t,i,a,s):e=hO(e,t,h,i,a,s))}return e}function hO(e,t,r,n,i,o){let a=i==="horizontal",s=i==="vertical",l=t.static;if(n){n=!1;let u={x:a?Math.max(t.x-r.w,0):r.x,y:s?Math.max(t.y-r.h,0):r.y,w:r.w,h:r.h,i:"-1"},p=Cu(e,u),m=p&&p.y+p.h>t.y,g=p&&t.x+t.w>p.x;if(p){if(m&&s)return Zv(e,r,void 0,t.y+1,n,l,i,o);if(m&&i==null)return t.y=r.y,r.y=r.y+r.h,e;if(g&&a)return Zv(e,t,r.x,void 0,n,l,i,o)}else return CS(`Doing reverse collision on ${r.i} up to [${u.x},${u.y}].`),Zv(e,r,a?u.x:void 0,s?u.y:void 0,n,l,i,o)}let c=a?r.x+1:void 0,d=s?r.y+1:void 0;return c==null&&d==null?e:Zv(e,r,a?r.x+1:void 0,s?r.y+1:void 0,n,l,i,o)}function bpe(e){return e*100+"%"}var cH=(e,t,r,n)=>e+r>n?t:r,dH=(e,t,r)=>e<0?t:r,uH=e=>Math.max(0,e),wO=e=>Math.max(0,e),xO=(e,t,r)=>{let{left:n,height:i,width:o}=t,a=e.top-(i-e.height);return{left:n,width:o,height:dH(a,e.height,i),top:wO(a)}},kO=(e,t,r)=>{let{top:n,left:i,height:o,width:a}=t;return{top:n,height:o,width:cH(e.left,e.width,a,r),left:uH(i)}},SO=(e,t,r)=>{let{top:n,height:i,width:o}=t,a=e.left-(o-e.width);return{height:i,width:a<0?e.width:cH(e.left,e.width,o,r),top:wO(n),left:uH(a)}},TO=(e,t,r)=>{let{top:n,left:i,height:o,width:a}=t;return{width:a,left:i,height:dH(n,e.height,o),top:wO(n)}},wpe=function(){return xO(arguments.length<=0?void 0:arguments[0],kO(...arguments),arguments.length<=2?void 0:arguments[2])},xpe=function(){return xO(arguments.length<=0?void 0:arguments[0],SO(...arguments),arguments.length<=2?void 0:arguments[2])},kpe=function(){return TO(arguments.length<=0?void 0:arguments[0],kO(...arguments),arguments.length<=2?void 0:arguments[2])},Spe=function(){return TO(arguments.length<=0?void 0:arguments[0],SO(...arguments),arguments.length<=2?void 0:arguments[2])},Tpe={n:xO,ne:wpe,e:kO,se:kpe,s:TO,sw:Spe,w:SO,nw:xpe};function Cpe(e,t,r,n){let i=Tpe[e];return i?i(t,{...t,...r},n):r}function Epe(e){let{top:t,left:r,width:n,height:i}=e,o=`translate(${r}px,${t}px)`;return{transform:o,WebkitTransform:o,MozTransform:o,msTransform:o,OTransform:o,width:`${n}px`,height:`${i}px`,position:"absolute"}}function Dpe(e){let{top:t,left:r,width:n,height:i}=e;return{top:`${t}px`,left:`${r}px`,width:`${n}px`,height:`${i}px`,position:"absolute"}}function CO(e,t){return t==="horizontal"?mH(e):t==="vertical"?pH(e):e}function pH(e){return e.slice(0).sort(function(t,r){return t.y>r.y||t.y===r.y&&t.x>r.x?1:t.y===r.y&&t.x===r.x?0:-1})}function mH(e){return e.slice(0).sort(function(t,r){return t.x>r.x||t.x===r.x&&t.y>r.y?1:-1})}function Ppe(e,t,r,n,i){e=e||[];let o=[];Qv.default.Children.forEach(t,s=>{if((s==null?void 0:s.key)==null)return;let l=yO(e,String(s.key)),c=s.props["data-grid"];l&&c==null?o.push(Eu(l)):c?(mpe||fH([c],"ReactGridLayout.children"),o.push(Eu({...c,i:s.key}))):o.push(Eu({w:1,h:1,x:0,y:vO(o),i:String(s.key)}))});let a=sH(o,{cols:r});return i?a:oH(a,n,r)}function fH(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Layout",r=["x","y","w","h"];if(!Array.isArray(e))throw new Error(t+" must be an array!");for(let n=0,i=e.length;n<i;n++){let o=e[n];for(let a=0;a<r.length;a++){let s=r[a],l=o[s];if(typeof l!="number"||Number.isNaN(l))throw new Error(`ReactGridLayout: ${t}[${n}].${s} must be a number! Received: ${l} (${typeof l})`)}if(typeof o.i!="undefined"&&typeof o.i!="string")throw new Error(`ReactGridLayout: ${t}[${n}].i must be a string! Received: ${o.i} (${typeof o.i})`)}}function Ape(e){let{verticalCompact:t,compactType:r}=e||{};return t===!1?null:r}function CS(){fpe&&console.log(...arguments)}var Npe=()=>{};xt.noop=Npe});var PS=le(Gc=>{"use strict";Object.defineProperty(Gc,"__esModule",{value:!0});Gc.calcGridColWidth=DS;Gc.calcGridItemPosition=Mpe;Gc.calcGridItemWHPx=EO;Gc.calcWH=Ipe;Gc.calcXY=Ope;Gc.clamp=Pu;function DS(e){let{margin:t,containerPadding:r,containerWidth:n,cols:i}=e;return(n-t[0]*(i-1)-r[0]*2)/i}function EO(e,t,r){return Number.isFinite(e)?Math.round(t*e+Math.max(0,e-1)*r):e}function Mpe(e,t,r,n,i,o){let{margin:a,containerPadding:s,rowHeight:l}=e,c=DS(e),d={};return o&&o.resizing?(d.width=Math.round(o.resizing.width),d.height=Math.round(o.resizing.height)):(d.width=EO(n,c,a[0]),d.height=EO(i,l,a[1])),o&&o.dragging?(d.top=Math.round(o.dragging.top),d.left=Math.round(o.dragging.left)):o&&o.resizing&&typeof o.resizing.top=="number"&&typeof o.resizing.left=="number"?(d.top=Math.round(o.resizing.top),d.left=Math.round(o.resizing.left)):(d.top=Math.round((l+a[1])*r+s[1]),d.left=Math.round((c+a[0])*t+s[0])),d}function Ope(e,t,r,n,i){let{margin:o,containerPadding:a,cols:s,rowHeight:l,maxRows:c}=e,d=DS(e),u=Math.round((r-a[0])/(d+o[0])),p=Math.round((t-a[1])/(l+o[1]));return u=Pu(u,0,s-n),p=Pu(p,0,c-i),{x:u,y:p}}function Ipe(e,t,r,n,i,o){let{margin:a,maxRows:s,cols:l,rowHeight:c}=e,d=DS(e),u=Math.round((t+a[0])/(d+a[0])),p=Math.round((r+a[1])/(c+a[1])),m=Pu(u,0,l-n),g=Pu(p,0,s-i);return["sw","w","nw"].indexOf(o)!==-1&&(m=Pu(u,0,l)),["nw","n","ne"].indexOf(o)!==-1&&(g=Pu(p,0,s)),{w:m,h:g}}function Pu(e,t,r){return Math.max(Math.min(e,r),t)}});var hH=le((HYe,gH)=>{"use strict";var Fpe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";gH.exports=Fpe});var wH=le((qYe,bH)=>{"use strict";var jpe=hH();function vH(){}function yH(){}yH.resetWarningCache=vH;bH.exports=function(){function e(n,i,o,a,s,l){if(l!==jpe){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:yH,resetWarningCache:vH};return r.PropTypes=r,r}});var Rl=le((KYe,xH)=>{xH.exports=wH()();var GYe,YYe});var TH=le((JYe,DO)=>{function SH(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(r=SH(e[t]))&&(n&&(n+=" "),n+=r);else for(t in e)e[t]&&(n&&(n+=" "),n+=t);return n}function kH(){for(var e,t,r=0,n="";r<arguments.length;)(e=arguments[r++])&&(t=SH(e))&&(n&&(n+=" "),n+=t);return n}DO.exports=kH,DO.exports.clsx=kH});var ey=le(Au=>{"use strict";Object.defineProperty(Au,"__esModule",{value:!0});Au.dontSetMe=Rpe;Au.findInArray=Lpe;Au.int=$pe;Au.isFunction=_pe;Au.isNum=zpe;function Lpe(e,t){for(let r=0,n=e.length;r<n;r++)if(t.apply(t,[e[r],r,e]))return e[r]}function _pe(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Function]"}function zpe(e){return typeof e=="number"&&!isNaN(e)}function $pe(e){return parseInt(e,10)}function Rpe(e,t,r){if(e[t])return new Error("Invalid prop ".concat(t," passed to ").concat(r," - do not set this, set it on the child."))}});var DH=le(Nu=>{"use strict";Object.defineProperty(Nu,"__esModule",{value:!0});Nu.browserPrefixToKey=EH;Nu.browserPrefixToStyle=Wpe;Nu.default=void 0;Nu.getPrefix=CH;var PO=["Moz","Webkit","O","ms"];function CH(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window=="undefined")return"";let r=(e=window.document)===null||e===void 0||(e=e.documentElement)===null||e===void 0?void 0:e.style;if(!r||t in r)return"";for(let n=0;n<PO.length;n++)if(EH(t,PO[n])in r)return PO[n];return""}function EH(e,t){return t?"".concat(t).concat(Bpe(e)):e}function Wpe(e,t){return t?"-".concat(t.toLowerCase(),"-").concat(e):e}function Bpe(e){let t="",r=!0;for(let n=0;n<e.length;n++)r?(t+=e[n].toUpperCase(),r=!1):e[n]==="-"?r=!0:t+=e[n];return t}var QYe=Nu.default=CH()});var NS=le(on=>{"use strict";Object.defineProperty(on,"__esModule",{value:!0});on.addClassName=MH;on.addEvent=Hpe;on.addUserSelectStyles=rme;on.createCSSTransform=Qpe;on.createSVGTransform=Zpe;on.getTouch=eme;on.getTouchIdentifier=tme;on.getTranslation=AO;on.innerHeight=Kpe;on.innerWidth=Jpe;on.matchesSelector=NH;on.matchesSelectorAndParentsTo=Vpe;on.offsetXYFromParent=Xpe;on.outerHeight=Gpe;on.outerWidth=Ype;on.removeClassName=OH;on.removeEvent=qpe;on.removeUserSelectStyles=nme;var Yo=ey(),PH=Upe(DH());function AH(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(AH=function(n){return n?r:t})(e)}function Upe(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var r=AH(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}var AS="";function NH(e,t){return AS||(AS=(0,Yo.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(r){return(0,Yo.isFunction)(e[r])})),(0,Yo.isFunction)(e[AS])?e[AS](t):!1}function Vpe(e,t,r){let n=e;do{if(NH(n,t))return!0;if(n===r)return!1;n=n.parentNode}while(n);return!1}function Hpe(e,t,r,n){if(!e)return;let i={capture:!0,...n};e.addEventListener?e.addEventListener(t,r,i):e.attachEvent?e.attachEvent("on"+t,r):e["on"+t]=r}function qpe(e,t,r,n){if(!e)return;let i={capture:!0,...n};e.removeEventListener?e.removeEventListener(t,r,i):e.detachEvent?e.detachEvent("on"+t,r):e["on"+t]=null}function Gpe(e){let t=e.clientHeight,r=e.ownerDocument.defaultView.getComputedStyle(e);return t+=(0,Yo.int)(r.borderTopWidth),t+=(0,Yo.int)(r.borderBottomWidth),t}function Ype(e){let t=e.clientWidth,r=e.ownerDocument.defaultView.getComputedStyle(e);return t+=(0,Yo.int)(r.borderLeftWidth),t+=(0,Yo.int)(r.borderRightWidth),t}function Kpe(e){let t=e.clientHeight,r=e.ownerDocument.defaultView.getComputedStyle(e);return t-=(0,Yo.int)(r.paddingTop),t-=(0,Yo.int)(r.paddingBottom),t}function Jpe(e){let t=e.clientWidth,r=e.ownerDocument.defaultView.getComputedStyle(e);return t-=(0,Yo.int)(r.paddingLeft),t-=(0,Yo.int)(r.paddingRight),t}function Xpe(e,t,r){let i=t===t.ownerDocument.body?{left:0,top:0}:t.getBoundingClientRect(),o=(e.clientX+t.scrollLeft-i.left)/r,a=(e.clientY+t.scrollTop-i.top)/r;return{x:o,y:a}}function Qpe(e,t){let r=AO(e,t,"px");return{[(0,PH.browserPrefixToKey)("transform",PH.default)]:r}}function Zpe(e,t){return AO(e,t,"")}function AO(e,t,r){let{x:n,y:i}=e,o="translate(".concat(n).concat(r,",").concat(i).concat(r,")");if(t){let a="".concat(typeof t.x=="string"?t.x:t.x+r),s="".concat(typeof t.y=="string"?t.y:t.y+r);o="translate(".concat(a,", ").concat(s,")")+o}return o}function eme(e,t){return e.targetTouches&&(0,Yo.findInArray)(e.targetTouches,r=>t===r.identifier)||e.changedTouches&&(0,Yo.findInArray)(e.changedTouches,r=>t===r.identifier)}function tme(e){if(e.targetTouches&&e.targetTouches[0])return e.targetTouches[0].identifier;if(e.changedTouches&&e.changedTouches[0])return e.changedTouches[0].identifier}function rme(e){if(!e)return;let t=e.getElementById("react-draggable-style-el");t||(t=e.createElement("style"),t.type="text/css",t.id="react-draggable-style-el",t.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,t.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,e.getElementsByTagName("head")[0].appendChild(t)),e.body&&MH(e.body,"react-draggable-transparent-selection")}function nme(e){if(e)try{if(e.body&&OH(e.body,"react-draggable-transparent-selection"),e.selection)e.selection.empty();else{let t=(e.defaultView||window).getSelection();t&&t.type!=="Caret"&&t.removeAllRanges()}}catch(t){}}function MH(e,t){e.classList?e.classList.add(t):e.className.match(new RegExp("(?:^|\\s)".concat(t,"(?!\\S)")))||(e.className+=" ".concat(t))}function OH(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(?:^|\\s)".concat(t,"(?!\\S)"),"g"),"")}});var MO=le(Wl=>{"use strict";Object.defineProperty(Wl,"__esModule",{value:!0});Wl.canDragX=ame;Wl.canDragY=sme;Wl.createCoreData=cme;Wl.createDraggableData=dme;Wl.getBoundPosition=ime;Wl.getControlPosition=lme;Wl.snapToGrid=ome;var Ko=ey(),bf=NS();function ime(e,t,r){if(!e.props.bounds)return[t,r];let{bounds:n}=e.props;n=typeof n=="string"?n:ume(n);let i=NO(e);if(typeof n=="string"){let{ownerDocument:o}=i,a=o.defaultView,s;if(n==="parent"?s=i.parentNode:s=o.querySelector(n),!(s instanceof a.HTMLElement))throw new Error('Bounds selector "'+n+'" could not find an element.');let l=s,c=a.getComputedStyle(i),d=a.getComputedStyle(l);n={left:-i.offsetLeft+(0,Ko.int)(d.paddingLeft)+(0,Ko.int)(c.marginLeft),top:-i.offsetTop+(0,Ko.int)(d.paddingTop)+(0,Ko.int)(c.marginTop),right:(0,bf.innerWidth)(l)-(0,bf.outerWidth)(i)-i.offsetLeft+(0,Ko.int)(d.paddingRight)-(0,Ko.int)(c.marginRight),bottom:(0,bf.innerHeight)(l)-(0,bf.outerHeight)(i)-i.offsetTop+(0,Ko.int)(d.paddingBottom)-(0,Ko.int)(c.marginBottom)}}return(0,Ko.isNum)(n.right)&&(t=Math.min(t,n.right)),(0,Ko.isNum)(n.bottom)&&(r=Math.min(r,n.bottom)),(0,Ko.isNum)(n.left)&&(t=Math.max(t,n.left)),(0,Ko.isNum)(n.top)&&(r=Math.max(r,n.top)),[t,r]}function ome(e,t,r){let n=Math.round(t/e[0])*e[0],i=Math.round(r/e[1])*e[1];return[n,i]}function ame(e){return e.props.axis==="both"||e.props.axis==="x"}function sme(e){return e.props.axis==="both"||e.props.axis==="y"}function lme(e,t,r){let n=typeof t=="number"?(0,bf.getTouch)(e,t):null;if(typeof t=="number"&&!n)return null;let i=NO(r),o=r.props.offsetParent||i.offsetParent||i.ownerDocument.body;return(0,bf.offsetXYFromParent)(n||e,o,r.props.scale)}function cme(e,t,r){let n=!(0,Ko.isNum)(e.lastX),i=NO(e);return n?{node:i,deltaX:0,deltaY:0,lastX:t,lastY:r,x:t,y:r}:{node:i,deltaX:t-e.lastX,deltaY:r-e.lastY,lastX:e.lastX,lastY:e.lastY,x:t,y:r}}function dme(e,t){let r=e.props.scale;return{node:t.node,x:e.state.x+t.deltaX/r,y:e.state.y+t.deltaY/r,deltaX:t.deltaX/r,deltaY:t.deltaY/r,lastX:e.state.x,lastY:e.state.y}}function ume(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}}function NO(e){let t=e.findDOMNode();if(!t)throw new Error("<DraggableCore>: Unmounted during event!");return t}});var IO=le(OO=>{"use strict";Object.defineProperty(OO,"__esModule",{value:!0});OO.default=pme;function pme(){}});var FH=le(MS=>{"use strict";Object.defineProperty(MS,"__esModule",{value:!0});MS.default=void 0;var FO=fme(W()),uo=LO(Rl()),mme=LO(ul()),yi=NS(),Yc=MO(),jO=ey(),ty=LO(IO());function LO(e){return e&&e.__esModule?e:{default:e}}function IH(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(IH=function(n){return n?r:t})(e)}function fme(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var r=IH(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function $i(e,t,r){return t=gme(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gme(e){var t=hme(e,"string");return typeof t=="symbol"?t:String(t)}function hme(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ms={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}},Kc=ms.mouse,wf=class extends FO.Component{constructor(){super(...arguments),$i(this,"dragging",!1),$i(this,"lastX",NaN),$i(this,"lastY",NaN),$i(this,"touchIdentifier",null),$i(this,"mounted",!1),$i(this,"handleDragStart",t=>{if(this.props.onMouseDown(t),!this.props.allowAnyClick&&typeof t.button=="number"&&t.button!==0)return!1;let r=this.findDOMNode();if(!r||!r.ownerDocument||!r.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");let{ownerDocument:n}=r;if(this.props.disabled||!(t.target instanceof n.defaultView.Node)||this.props.handle&&!(0,yi.matchesSelectorAndParentsTo)(t.target,this.props.handle,r)||this.props.cancel&&(0,yi.matchesSelectorAndParentsTo)(t.target,this.props.cancel,r))return;t.type==="touchstart"&&t.preventDefault();let i=(0,yi.getTouchIdentifier)(t);this.touchIdentifier=i;let o=(0,Yc.getControlPosition)(t,i,this);if(o==null)return;let{x:a,y:s}=o,l=(0,Yc.createCoreData)(this,a,s);(0,ty.default)("DraggableCore: handleDragStart: %j",l),(0,ty.default)("calling",this.props.onStart),!(this.props.onStart(t,l)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,yi.addUserSelectStyles)(n),this.dragging=!0,this.lastX=a,this.lastY=s,(0,yi.addEvent)(n,Kc.move,this.handleDrag),(0,yi.addEvent)(n,Kc.stop,this.handleDragStop))}),$i(this,"handleDrag",t=>{let r=(0,Yc.getControlPosition)(t,this.touchIdentifier,this);if(r==null)return;let{x:n,y:i}=r;if(Array.isArray(this.props.grid)){let s=n-this.lastX,l=i-this.lastY;if([s,l]=(0,Yc.snapToGrid)(this.props.grid,s,l),!s&&!l)return;n=this.lastX+s,i=this.lastY+l}let o=(0,Yc.createCoreData)(this,n,i);if((0,ty.default)("DraggableCore: handleDrag: %j",o),this.props.onDrag(t,o)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch(s){let l=document.createEvent("MouseEvents");l.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(l)}return}this.lastX=n,this.lastY=i}),$i(this,"handleDragStop",t=>{if(!this.dragging)return;let r=(0,Yc.getControlPosition)(t,this.touchIdentifier,this);if(r==null)return;let{x:n,y:i}=r;if(Array.isArray(this.props.grid)){let l=n-this.lastX||0,c=i-this.lastY||0;[l,c]=(0,Yc.snapToGrid)(this.props.grid,l,c),n=this.lastX+l,i=this.lastY+c}let o=(0,Yc.createCoreData)(this,n,i);if(this.props.onStop(t,o)===!1||this.mounted===!1)return!1;let s=this.findDOMNode();s&&this.props.enableUserSelectHack&&(0,yi.removeUserSelectStyles)(s.ownerDocument),(0,ty.default)("DraggableCore: handleDragStop: %j",o),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,s&&((0,ty.default)("DraggableCore: Removing handlers"),(0,yi.removeEvent)(s.ownerDocument,Kc.move,this.handleDrag),(0,yi.removeEvent)(s.ownerDocument,Kc.stop,this.handleDragStop))}),$i(this,"onMouseDown",t=>(Kc=ms.mouse,this.handleDragStart(t))),$i(this,"onMouseUp",t=>(Kc=ms.mouse,this.handleDragStop(t))),$i(this,"onTouchStart",t=>(Kc=ms.touch,this.handleDragStart(t))),$i(this,"onTouchEnd",t=>(Kc=ms.touch,this.handleDragStop(t)))}componentDidMount(){this.mounted=!0;let t=this.findDOMNode();t&&(0,yi.addEvent)(t,ms.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;let t=this.findDOMNode();if(t){let{ownerDocument:r}=t;(0,yi.removeEvent)(r,ms.mouse.move,this.handleDrag),(0,yi.removeEvent)(r,ms.touch.move,this.handleDrag),(0,yi.removeEvent)(r,ms.mouse.stop,this.handleDragStop),(0,yi.removeEvent)(r,ms.touch.stop,this.handleDragStop),(0,yi.removeEvent)(t,ms.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,yi.removeUserSelectStyles)(r)}}findDOMNode(){var t,r;return(t=this.props)!==null&&t!==void 0&&t.nodeRef?(r=this.props)===null||r===void 0||(r=r.nodeRef)===null||r===void 0?void 0:r.current:mme.default.findDOMNode(this)}render(){return FO.cloneElement(FO.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};MS.default=wf;$i(wf,"displayName","DraggableCore");$i(wf,"propTypes",{allowAnyClick:uo.default.bool,children:uo.default.node.isRequired,disabled:uo.default.bool,enableUserSelectHack:uo.default.bool,offsetParent:function(e,t){if(e[t]&&e[t].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:uo.default.arrayOf(uo.default.number),handle:uo.default.string,cancel:uo.default.string,nodeRef:uo.default.object,onStart:uo.default.func,onDrag:uo.default.func,onStop:uo.default.func,onMouseDown:uo.default.func,scale:uo.default.number,className:jO.dontSetMe,style:jO.dontSetMe,transform:jO.dontSetMe});$i(wf,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1})});var _H=le(ny=>{"use strict";Object.defineProperty(ny,"__esModule",{value:!0});Object.defineProperty(ny,"DraggableCore",{enumerable:!0,get:function(){return FS.default}});ny.default=void 0;var OS=bme(W()),ur=ry(Rl()),vme=ry(ul()),yme=ry(TH()),jH=NS(),xf=MO(),_O=ey(),FS=ry(FH()),IS=ry(IO());function ry(e){return e&&e.__esModule?e:{default:e}}function LH(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(LH=function(n){return n?r:t})(e)}function bme(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var r=LH(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function zO(){return zO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zO.apply(this,arguments)}function kf(e,t,r){return t=wme(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wme(e){var t=xme(e,"string");return typeof t=="symbol"?t:String(t)}function xme(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sf=class extends OS.Component{static getDerivedStateFromProps(t,r){let{position:n}=t,{prevPropsPosition:i}=r;return n&&(!i||n.x!==i.x||n.y!==i.y)?((0,IS.default)("Draggable: getDerivedStateFromProps %j",{position:n,prevPropsPosition:i}),{x:n.x,y:n.y,prevPropsPosition:{...n}}):null}constructor(t){super(t),kf(this,"onDragStart",(r,n)=>{if((0,IS.default)("Draggable: onDragStart: %j",n),this.props.onStart(r,(0,xf.createDraggableData)(this,n))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),kf(this,"onDrag",(r,n)=>{if(!this.state.dragging)return!1;(0,IS.default)("Draggable: onDrag: %j",n);let i=(0,xf.createDraggableData)(this,n),o={x:i.x,y:i.y,slackX:0,slackY:0};if(this.props.bounds){let{x:s,y:l}=o;o.x+=this.state.slackX,o.y+=this.state.slackY;let[c,d]=(0,xf.getBoundPosition)(this,o.x,o.y);o.x=c,o.y=d,o.slackX=this.state.slackX+(s-o.x),o.slackY=this.state.slackY+(l-o.y),i.x=o.x,i.y=o.y,i.deltaX=o.x-this.state.x,i.deltaY=o.y-this.state.y}if(this.props.onDrag(r,i)===!1)return!1;this.setState(o)}),kf(this,"onDragStop",(r,n)=>{if(!this.state.dragging||this.props.onStop(r,(0,xf.createDraggableData)(this,n))===!1)return!1;(0,IS.default)("Draggable: onDragStop: %j",n);let o={dragging:!1,slackX:0,slackY:0};if(!!this.props.position){let{x:s,y:l}=this.props.position;o.x=s,o.y=l}this.setState(o)}),this.state={dragging:!1,dragged:!1,x:t.position?t.position.x:t.defaultPosition.x,y:t.position?t.position.y:t.defaultPosition.y,prevPropsPosition:{...t.position},slackX:0,slackY:0,isElementSVG:!1},t.position&&!(t.onDrag||t.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){typeof window.SVGElement!="undefined"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.setState({dragging:!1})}findDOMNode(){var t,r;return(t=(r=this.props)===null||r===void 0||(r=r.nodeRef)===null||r===void 0?void 0:r.current)!==null&&t!==void 0?t:vme.default.findDOMNode(this)}render(){let{axis:t,bounds:r,children:n,defaultPosition:i,defaultClassName:o,defaultClassNameDragging:a,defaultClassNameDragged:s,position:l,positionOffset:c,scale:d,...u}=this.props,p={},m=null,f=!!!l||this.state.dragging,y=l||i,h={x:(0,xf.canDragX)(this)&&f?this.state.x:y.x,y:(0,xf.canDragY)(this)&&f?this.state.y:y.y};this.state.isElementSVG?m=(0,jH.createSVGTransform)(h,c):p=(0,jH.createCSSTransform)(h,c);let v=(0,yme.default)(n.props.className||"",o,{[a]:this.state.dragging,[s]:this.state.dragged});return OS.createElement(FS.default,zO({},u,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),OS.cloneElement(OS.Children.only(n),{className:v,style:{...n.props.style,...p},transform:m}))}};ny.default=Sf;kf(Sf,"displayName","Draggable");kf(Sf,"propTypes",{...FS.default.propTypes,axis:ur.default.oneOf(["both","x","y","none"]),bounds:ur.default.oneOfType([ur.default.shape({left:ur.default.number,right:ur.default.number,top:ur.default.number,bottom:ur.default.number}),ur.default.string,ur.default.oneOf([!1])]),defaultClassName:ur.default.string,defaultClassNameDragging:ur.default.string,defaultClassNameDragged:ur.default.string,defaultPosition:ur.default.shape({x:ur.default.number,y:ur.default.number}),positionOffset:ur.default.shape({x:ur.default.oneOfType([ur.default.number,ur.default.string]),y:ur.default.oneOfType([ur.default.number,ur.default.string])}),position:ur.default.shape({x:ur.default.number,y:ur.default.number}),className:_O.dontSetMe,style:_O.dontSetMe,transform:_O.dontSetMe});kf(Sf,"defaultProps",{...FS.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})});var LS=le((o9e,jS)=>{"use strict";var{default:zH,DraggableCore:kme}=_H();jS.exports=zH;jS.exports.default=zH;jS.exports.DraggableCore=kme});var WH=le($O=>{"use strict";$O.__esModule=!0;$O.cloneElement=Pme;var Sme=Tme(W());function Tme(e){return e&&e.__esModule?e:{default:e}}function $H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function RH(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$H(Object(r),!0).forEach(function(n){Cme(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$H(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Cme(e,t,r){return t=Eme(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Eme(e){var t=Dme(e,"string");return typeof t=="symbol"?t:String(t)}function Dme(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pme(e,t){return t.style&&e.props.style&&(t.style=RH(RH({},e.props.style),t.style)),t.className&&e.props.className&&(t.className=e.props.className+" "+t.className),Sme.default.cloneElement(e,t)}});var RO=le(_S=>{"use strict";_S.__esModule=!0;_S.resizableProps=void 0;var Xe=Ame(Rl()),s9e=LS();function Ame(e){return e&&e.__esModule?e:{default:e}}var Nme={axis:Xe.default.oneOf(["both","x","y","none"]),className:Xe.default.string,children:Xe.default.element.isRequired,draggableOpts:Xe.default.shape({allowAnyClick:Xe.default.bool,cancel:Xe.default.string,children:Xe.default.node,disabled:Xe.default.bool,enableUserSelectHack:Xe.default.bool,offsetParent:Xe.default.node,grid:Xe.default.arrayOf(Xe.default.number),handle:Xe.default.string,nodeRef:Xe.default.object,onStart:Xe.default.func,onDrag:Xe.default.func,onStop:Xe.default.func,onMouseDown:Xe.default.func,scale:Xe.default.number}),height:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r[0];if(i.axis==="both"||i.axis==="y"){var o;return(o=Xe.default.number).isRequired.apply(o,r)}return Xe.default.number.apply(Xe.default,r)},handle:Xe.default.oneOfType([Xe.default.node,Xe.default.func]),handleSize:Xe.default.arrayOf(Xe.default.number),lockAspectRatio:Xe.default.bool,maxConstraints:Xe.default.arrayOf(Xe.default.number),minConstraints:Xe.default.arrayOf(Xe.default.number),onResizeStop:Xe.default.func,onResizeStart:Xe.default.func,onResize:Xe.default.func,resizeHandles:Xe.default.arrayOf(Xe.default.oneOf(["s","w","e","n","sw","nw","se","ne"])),transformScale:Xe.default.number,width:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r[0];if(i.axis==="both"||i.axis==="x"){var o;return(o=Xe.default.number).isRequired.apply(o,r)}return Xe.default.number.apply(Xe.default,r)}};_S.resizableProps=Nme});var HO=le(zS=>{"use strict";zS.__esModule=!0;zS.default=void 0;var iy=jme(W()),Mme=LS(),Ome=WH(),Ime=RO(),Fme=["children","className","draggableOpts","width","height","handle","handleSize","lockAspectRatio","axis","minConstraints","maxConstraints","onResize","onResizeStop","onResizeStart","resizeHandles","transformScale"];function UH(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(UH=function(i){return i?r:t})(e)}function jme(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var r=UH(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function BO(){return BO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},BO.apply(this,arguments)}function Lme(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function BH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function WO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BH(Object(r),!0).forEach(function(n){_me(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _me(e,t,r){return t=zme(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zme(e){var t=$me(e,"string");return typeof t=="symbol"?t:String(t)}function $me(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rme(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,UO(e,t)}function UO(e,t){return UO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},UO(e,t)}var VO=function(e){Rme(t,e);function t(){for(var n,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o))||this,n.handleRefs={},n.lastHandleRect=null,n.slack=null,n}var r=t.prototype;return r.componentWillUnmount=function(){this.resetData()},r.resetData=function(){this.lastHandleRect=this.slack=null},r.runConstraints=function(i,o){var a=this.props,s=a.minConstraints,l=a.maxConstraints,c=a.lockAspectRatio;if(!s&&!l&&!c)return[i,o];if(c){var d=this.props.width/this.props.height,u=i-this.props.width,p=o-this.props.height;Math.abs(u)>Math.abs(p*d)?o=i/d:i=o*d}var m=i,g=o,f=this.slack||[0,0],y=f[0],h=f[1];return i+=y,o+=h,s&&(i=Math.max(s[0],i),o=Math.max(s[1],o)),l&&(i=Math.min(l[0],i),o=Math.min(l[1],o)),this.slack=[y+(m-i),h+(g-o)],[i,o]},r.resizeHandler=function(i,o){var a=this;return function(s,l){var c=l.node,d=l.deltaX,u=l.deltaY;i==="onResizeStart"&&a.resetData();var p=(a.props.axis==="both"||a.props.axis==="x")&&o!=="n"&&o!=="s",m=(a.props.axis==="both"||a.props.axis==="y")&&o!=="e"&&o!=="w";if(!(!p&&!m)){var g=o[0],f=o[o.length-1],y=c.getBoundingClientRect();if(a.lastHandleRect!=null){if(f==="w"){var h=y.left-a.lastHandleRect.left;d+=h}if(g==="n"){var v=y.top-a.lastHandleRect.top;u+=v}}a.lastHandleRect=y,f==="w"&&(d=-d),g==="n"&&(u=-u);var b=a.props.width+(p?d/a.props.transformScale:0),w=a.props.height+(m?u/a.props.transformScale:0),k=a.runConstraints(b,w);b=k[0],w=k[1];var S=b!==a.props.width||w!==a.props.height,x=typeof a.props[i]=="function"?a.props[i]:null,T=i==="onResize"&&!S;x&&!T&&(s.persist==null||s.persist(),x(s,{node:c,size:{width:b,height:w},handle:o})),i==="onResizeStop"&&a.resetData()}}},r.renderResizeHandle=function(i,o){var a=this.props.handle;if(!a)return iy.createElement("span",{className:"react-resizable-handle react-resizable-handle-"+i,ref:o});if(typeof a=="function")return a(i,o);var s=typeof a.type=="string",l=WO({ref:o},s?{}:{handleAxis:i});return iy.cloneElement(a,l)},r.render=function(){var i=this,o=this.props,a=o.children,s=o.className,l=o.draggableOpts,c=o.width,d=o.height,u=o.handle,p=o.handleSize,m=o.lockAspectRatio,g=o.axis,f=o.minConstraints,y=o.maxConstraints,h=o.onResize,v=o.onResizeStop,b=o.onResizeStart,w=o.resizeHandles,k=o.transformScale,S=Lme(o,Fme);return(0,Ome.cloneElement)(a,WO(WO({},S),{},{className:(s?s+" ":"")+"react-resizable",children:[].concat(a.props.children,w.map(function(x){var T,E=(T=i.handleRefs[x])!=null?T:i.handleRefs[x]=iy.createRef();return iy.createElement(Mme.DraggableCore,BO({},l,{nodeRef:E,key:"resizableHandle-"+x,onStop:i.resizeHandler("onResizeStop",x),onStart:i.resizeHandler("onResizeStart",x),onDrag:i.resizeHandler("onResize",x)}),i.renderResizeHandle(x,E))}))}))},t}(iy.Component);zS.default=VO;VO.propTypes=Ime.resizableProps;VO.defaultProps={axis:"both",handleSize:[20,20],lockAspectRatio:!1,minConstraints:[20,20],maxConstraints:[1/0,1/0],resizeHandles:["se"],transformScale:1}});var YH=le(RS=>{"use strict";RS.__esModule=!0;RS.default=void 0;var qO=Hme(W()),Wme=HH(Rl()),Bme=HH(HO()),Ume=RO(),Vme=["handle","handleSize","onResize","onResizeStart","onResizeStop","draggableOpts","minConstraints","maxConstraints","lockAspectRatio","axis","width","height","resizeHandles","style","transformScale"];function HH(e){return e&&e.__esModule?e:{default:e}}function qH(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(qH=function(i){return i?r:t})(e)}function Hme(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var r=qH(t);if(r&&r.has(e))return r.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function GO(){return GO=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},GO.apply(this,arguments)}function VH(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function $S(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VH(Object(r),!0).forEach(function(n){qme(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VH(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qme(e,t,r){return t=Gme(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gme(e){var t=Yme(e,"string");return typeof t=="symbol"?t:String(t)}function Yme(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kme(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,o;for(o=0;o<n.length;o++)i=n[o],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function Jme(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,YO(e,t)}function YO(e,t){return YO=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},YO(e,t)}var GH=function(e){Jme(t,e);function t(){for(var n,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n=e.call.apply(e,[this].concat(o))||this,n.state={width:n.props.width,height:n.props.height,propsWidth:n.props.width,propsHeight:n.props.height},n.onResize=function(s,l){var c=l.size;n.props.onResize?(s.persist==null||s.persist(),n.setState(c,function(){return n.props.onResize&&n.props.onResize(s,l)})):n.setState(c)},n}t.getDerivedStateFromProps=function(i,o){return o.propsWidth!==i.width||o.propsHeight!==i.height?{width:i.width,height:i.height,propsWidth:i.width,propsHeight:i.height}:null};var r=t.prototype;return r.render=function(){var i=this.props,o=i.handle,a=i.handleSize,s=i.onResize,l=i.onResizeStart,c=i.onResizeStop,d=i.draggableOpts,u=i.minConstraints,p=i.maxConstraints,m=i.lockAspectRatio,g=i.axis,f=i.width,y=i.height,h=i.resizeHandles,v=i.style,b=i.transformScale,w=Kme(i,Vme);return qO.createElement(Bme.default,{axis:g,draggableOpts:d,handle:o,handleSize:a,height:this.state.height,lockAspectRatio:m,maxConstraints:p,minConstraints:u,onResizeStart:l,onResize:this.onResize,onResizeStop:c,resizeHandles:h,transformScale:b,width:this.state.width},qO.createElement("div",GO({},w,{style:$S($S({},v),{},{width:this.state.width+"px",height:this.state.height+"px"})})))},t}(qO.Component);RS.default=GH;GH.propTypes=$S($S({},Ume.resizableProps),{},{children:Wme.default.element})});var KH=le((u9e,WS)=>{"use strict";WS.exports=function(){throw new Error("Don't instantiate Resizable directly! Use require('react-resizable').Resizable")};WS.exports.Resizable=HO().default;WS.exports.ResizableBox=YH().default});var KO=le(Jc=>{"use strict";Object.defineProperty(Jc,"__esModule",{value:!0});Jc.resizeHandleType=Jc.resizeHandleAxesType=Jc.default=void 0;var tt=JH(Rl()),Xme=JH(W());function JH(e){return e&&e.__esModule?e:{default:e}}var Qme=Jc.resizeHandleAxesType=tt.default.arrayOf(tt.default.oneOf(["s","w","e","n","sw","nw","se","ne"])),Zme=Jc.resizeHandleType=tt.default.oneOfType([tt.default.node,tt.default.func]),p9e=Jc.default={className:tt.default.string,style:tt.default.object,width:tt.default.number,autoSize:tt.default.bool,cols:tt.default.number,draggableCancel:tt.default.string,draggableHandle:tt.default.string,verticalCompact:function(e){e.verticalCompact},compactType:tt.default.oneOf(["vertical","horizontal"]),layout:function(e){var t=e.layout;t!==void 0&&Du().validateLayout(t,"layout")},margin:tt.default.arrayOf(tt.default.number),containerPadding:tt.default.arrayOf(tt.default.number),rowHeight:tt.default.number,maxRows:tt.default.number,isBounded:tt.default.bool,isDraggable:tt.default.bool,isResizable:tt.default.bool,allowOverlap:tt.default.bool,preventCollision:tt.default.bool,useCSSTransforms:tt.default.bool,transformScale:tt.default.number,isDroppable:tt.default.bool,resizeHandles:Qme,resizeHandle:Zme,onLayoutChange:tt.default.func,onDragStart:tt.default.func,onDrag:tt.default.func,onDragStop:tt.default.func,onResizeStart:tt.default.func,onResize:tt.default.func,onResizeStop:tt.default.func,onDrop:tt.default.func,droppingItem:tt.default.shape({i:tt.default.string.isRequired,w:tt.default.number.isRequired,h:tt.default.number.isRequired}),children:function(e,t){let r=e[t],n={};Xme.default.Children.forEach(r,function(i){if((i==null?void 0:i.key)!=null){if(n[i.key])throw new Error('Duplicate child key "'+i.key+'" found! This will cause problems in ReactGridLayout.');n[i.key]=!0}})},innerRef:tt.default.any}});var ZH=le(BS=>{"use strict";Object.defineProperty(BS,"__esModule",{value:!0});BS.default=void 0;var Tf=JO(W()),XH=ul(),Dt=JO(Rl()),efe=LS(),tfe=KH(),Cf=Du(),Jn=PS(),QH=KO(),rfe=JO(TS());function JO(e){return e&&e.__esModule?e:{default:e}}function Qs(e,t,r){return t=nfe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nfe(e){var t=ife(e,"string");return typeof t=="symbol"?t:String(t)}function ife(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oy=class extends Tf.default.Component{constructor(){super(...arguments),Qs(this,"state",{resizing:null,dragging:null,className:""}),Qs(this,"elementRef",Tf.default.createRef()),Qs(this,"onDragStart",(t,r)=>{let{node:n}=r,{onDragStart:i,transformScale:o}=this.props;if(!i)return;let a={top:0,left:0},{offsetParent:s}=n;if(!s)return;let l=s.getBoundingClientRect(),c=n.getBoundingClientRect(),d=c.left/o,u=l.left/o,p=c.top/o,m=l.top/o;a.left=d-u+s.scrollLeft,a.top=p-m+s.scrollTop,this.setState({dragging:a});let{x:g,y:f}=(0,Jn.calcXY)(this.getPositionParams(),a.top,a.left,this.props.w,this.props.h);return i.call(this,this.props.i,g,f,{e:t,node:n,newPosition:a})}),Qs(this,"onDrag",(t,r,n)=>{let{node:i,deltaX:o,deltaY:a}=r,{onDrag:s}=this.props;if(!s)return;if(!this.state.dragging)throw new Error("onDrag called before onDragStart.");let l=this.state.dragging.top+a,c=this.state.dragging.left+o,{isBounded:d,i:u,w:p,h:m,containerWidth:g}=this.props,f=this.getPositionParams();if(d){let{offsetParent:b}=i;if(b){let{margin:w,rowHeight:k,containerPadding:S}=this.props,x=b.clientHeight-(0,Jn.calcGridItemWHPx)(m,k,w[1]);l=(0,Jn.clamp)(l-S[1],0,x);let T=(0,Jn.calcGridColWidth)(f),E=g-(0,Jn.calcGridItemWHPx)(p,T,w[0]);c=(0,Jn.clamp)(c-S[0],0,E)}}let y={top:l,left:c};n?this.setState({dragging:y}):(0,XH.flushSync)(()=>{this.setState({dragging:y})});let{x:h,y:v}=(0,Jn.calcXY)(f,l,c,p,m);return s.call(this,u,h,v,{e:t,node:i,newPosition:y})}),Qs(this,"onDragStop",(t,r)=>{let{node:n}=r,{onDragStop:i}=this.props;if(!i)return;if(!this.state.dragging)throw new Error("onDragEnd called before onDragStart.");let{w:o,h:a,i:s}=this.props,{left:l,top:c}=this.state.dragging,d={top:c,left:l};this.setState({dragging:null});let{x:u,y:p}=(0,Jn.calcXY)(this.getPositionParams(),c,l,o,a);return i.call(this,s,u,p,{e:t,node:n,newPosition:d})}),Qs(this,"onResizeStop",(t,r,n)=>this.onResizeHandler(t,r,n,"onResizeStop")),Qs(this,"onResizeStart",(t,r,n)=>this.onResizeHandler(t,r,n,"onResizeStart")),Qs(this,"onResize",(t,r,n)=>this.onResizeHandler(t,r,n,"onResize"))}shouldComponentUpdate(t,r){if(this.props.children!==t.children||this.props.droppingPosition!==t.droppingPosition)return!0;let n=(0,Jn.calcGridItemPosition)(this.getPositionParams(this.props),this.props.x,this.props.y,this.props.w,this.props.h,this.state),i=(0,Jn.calcGridItemPosition)(this.getPositionParams(t),t.x,t.y,t.w,t.h,r);return!(0,Cf.fastPositionEqual)(n,i)||this.props.useCSSTransforms!==t.useCSSTransforms}componentDidMount(){this.moveDroppingItem({})}componentDidUpdate(t){this.moveDroppingItem(t)}moveDroppingItem(t){let{droppingPosition:r}=this.props;if(!r)return;let n=this.elementRef.current;if(!n)return;let i=t.droppingPosition||{left:0,top:0},{dragging:o}=this.state,a=o&&r.left!==i.left||r.top!==i.top;if(!o)this.onDragStart(r.e,{node:n,deltaX:r.left,deltaY:r.top});else if(a){let s=r.left-o.left,l=r.top-o.top;this.onDrag(r.e,{node:n,deltaX:s,deltaY:l},!0)}}getPositionParams(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props;return{cols:t.cols,containerPadding:t.containerPadding,containerWidth:t.containerWidth,margin:t.margin,maxRows:t.maxRows,rowHeight:t.rowHeight}}createStyle(t){let{usePercentages:r,containerWidth:n,useCSSTransforms:i}=this.props,o;return i?o=(0,Cf.setTransform)(t):(o=(0,Cf.setTopLeft)(t),r&&(o.left=(0,Cf.perc)(t.left/n),o.width=(0,Cf.perc)(t.width/n))),o}mixinDraggable(t,r){return Tf.default.createElement(efe.DraggableCore,{disabled:!r,onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop,handle:this.props.handle,cancel:".react-resizable-handle"+(this.props.cancel?","+this.props.cancel:""),scale:this.props.transformScale,nodeRef:this.elementRef},t)}curryResizeHandler(t,r){return(n,i)=>r(n,i,t)}mixinResizable(t,r,n){let{cols:i,minW:o,minH:a,maxW:s,maxH:l,transformScale:c,resizeHandles:d,resizeHandle:u}=this.props,p=this.getPositionParams(),m=(0,Jn.calcGridItemPosition)(p,0,0,i,0).width,g=(0,Jn.calcGridItemPosition)(p,0,0,o,a),f=(0,Jn.calcGridItemPosition)(p,0,0,s,l),y=[g.width,g.height],h=[Math.min(f.width,m),Math.min(f.height,1/0)];return Tf.default.createElement(tfe.Resizable,{draggableOpts:{disabled:!n},className:n?void 0:"react-resizable-hide",width:r.width,height:r.height,minConstraints:y,maxConstraints:h,onResizeStop:this.curryResizeHandler(r,this.onResizeStop),onResizeStart:this.curryResizeHandler(r,this.onResizeStart),onResize:this.curryResizeHandler(r,this.onResize),transformScale:c,resizeHandles:d,handle:u},t)}onResizeHandler(t,r,n,i){let{node:o,size:a,handle:s}=r,l=this.props[i];if(!l)return;let{x:c,y:d,i:u,maxH:p,minH:m,containerWidth:g}=this.props,{minW:f,maxW:y}=this.props,h=a;o&&(h=(0,Cf.resizeItemInDirection)(s,n,a,g),(0,XH.flushSync)(()=>{this.setState({resizing:i==="onResizeStop"?null:h})}));let{w:v,h:b}=(0,Jn.calcWH)(this.getPositionParams(),h.width,h.height,c,d,s);v=(0,Jn.clamp)(v,Math.max(f,1),y),b=(0,Jn.clamp)(b,m,p),l.call(this,u,v,b,{e:t,node:o,size:h,handle:s})}render(){let{x:t,y:r,w:n,h:i,isDraggable:o,isResizable:a,droppingPosition:s,useCSSTransforms:l}=this.props,c=(0,Jn.calcGridItemPosition)(this.getPositionParams(),t,r,n,i,this.state),d=Tf.default.Children.only(this.props.children),u=Tf.default.cloneElement(d,{ref:this.elementRef,className:(0,rfe.default)("react-grid-item",d.props.className,this.props.className,{static:this.props.static,resizing:!!this.state.resizing,"react-draggable":o,"react-draggable-dragging":!!this.state.dragging,dropping:!!s,cssTransforms:l}),style:{...this.props.style,...d.props.style,...this.createStyle(c)}});return u=this.mixinResizable(u,c,a),u=this.mixinDraggable(u,o),u}};BS.default=oy;Qs(oy,"propTypes",{children:Dt.default.element,cols:Dt.default.number.isRequired,containerWidth:Dt.default.number.isRequired,rowHeight:Dt.default.number.isRequired,margin:Dt.default.array.isRequired,maxRows:Dt.default.number.isRequired,containerPadding:Dt.default.array.isRequired,x:Dt.default.number.isRequired,y:Dt.default.number.isRequired,w:Dt.default.number.isRequired,h:Dt.default.number.isRequired,minW:function(e,t){let r=e[t];if(typeof r!="number")return new Error("minWidth not Number");if(r>e.w||r>e.maxW)return new Error("minWidth larger than item width/maxWidth")},maxW:function(e,t){let r=e[t];if(typeof r!="number")return new Error("maxWidth not Number");if(r<e.w||r<e.minW)return new Error("maxWidth smaller than item width/minWidth")},minH:function(e,t){let r=e[t];if(typeof r!="number")return new Error("minHeight not Number");if(r>e.h||r>e.maxH)return new Error("minHeight larger than item height/maxHeight")},maxH:function(e,t){let r=e[t];if(typeof r!="number")return new Error("maxHeight not Number");if(r<e.h||r<e.minH)return new Error("maxHeight smaller than item height/minHeight")},i:Dt.default.string.isRequired,resizeHandles:QH.resizeHandleAxesType,resizeHandle:QH.resizeHandleType,onDragStop:Dt.default.func,onDragStart:Dt.default.func,onDrag:Dt.default.func,onResizeStop:Dt.default.func,onResizeStart:Dt.default.func,onResize:Dt.default.func,isDraggable:Dt.default.bool.isRequired,isResizable:Dt.default.bool.isRequired,isBounded:Dt.default.bool.isRequired,static:Dt.default.bool,useCSSTransforms:Dt.default.bool.isRequired,transformScale:Dt.default.number,className:Dt.default.string,handle:Dt.default.string,cancel:Dt.default.string,droppingPosition:Dt.default.shape({e:Dt.default.object.isRequired,left:Dt.default.number.isRequired,top:Dt.default.number.isRequired})});Qs(oy,"defaultProps",{className:"",cancel:"",handle:"",minH:1,minW:1,maxH:1/0,maxW:1/0,transformScale:1})});var ZO=le(US=>{"use strict";Object.defineProperty(US,"__esModule",{value:!0});US.default=void 0;var Mu=lfe(W()),XO=SS(),ofe=QO(TS()),qe=Du(),afe=PS(),eq=QO(ZH()),sfe=QO(KO());function QO(e){return e&&e.__esModule?e:{default:e}}function rq(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(rq=function(n){return n?r:t})(e)}function lfe(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var r=rq(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function bi(e,t,r){return t=cfe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cfe(e){var t=dfe(e,"string");return typeof t=="symbol"?t:String(t)}function dfe(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var tq="react-grid-layout",nq=!1;try{nq=/firefox/i.test(navigator.userAgent)}catch(e){}var Ef=class extends Mu.Component{constructor(){super(...arguments),bi(this,"state",{activeDrag:null,layout:(0,qe.synchronizeLayoutWithChildren)(this.props.layout,this.props.children,this.props.cols,(0,qe.compactType)(this.props),this.props.allowOverlap),mounted:!1,oldDragItem:null,oldLayout:null,oldResizeItem:null,resizing:!1,droppingDOMNode:null,children:[]}),bi(this,"dragEnterCounter",0),bi(this,"onDragStart",(t,r,n,i)=>{let{e:o,node:a}=i,{layout:s}=this.state,l=(0,qe.getLayoutItem)(s,t);if(!l)return;let c={w:l.w,h:l.h,x:l.x,y:l.y,placeholder:!0,i:t};return this.setState({oldDragItem:(0,qe.cloneLayoutItem)(l),oldLayout:s,activeDrag:c}),this.props.onDragStart(s,l,l,null,o,a)}),bi(this,"onDrag",(t,r,n,i)=>{let{e:o,node:a}=i,{oldDragItem:s}=this.state,{layout:l}=this.state,{cols:c,allowOverlap:d,preventCollision:u}=this.props,p=(0,qe.getLayoutItem)(l,t);if(!p)return;let m={w:p.w,h:p.h,x:p.x,y:p.y,placeholder:!0,i:t};l=(0,qe.moveElement)(l,p,r,n,!0,u,(0,qe.compactType)(this.props),c,d),this.props.onDrag(l,s,p,m,o,a),this.setState({layout:d?l:(0,qe.compact)(l,(0,qe.compactType)(this.props),c),activeDrag:m})}),bi(this,"onDragStop",(t,r,n,i)=>{let{e:o,node:a}=i;if(!this.state.activeDrag)return;let{oldDragItem:s}=this.state,{layout:l}=this.state,{cols:c,preventCollision:d,allowOverlap:u}=this.props,p=(0,qe.getLayoutItem)(l,t);if(!p)return;l=(0,qe.moveElement)(l,p,r,n,!0,d,(0,qe.compactType)(this.props),c,u);let g=u?l:(0,qe.compact)(l,(0,qe.compactType)(this.props),c);this.props.onDragStop(g,s,p,null,o,a);let{oldLayout:f}=this.state;this.setState({activeDrag:null,layout:g,oldDragItem:null,oldLayout:null}),this.onLayoutMaybeChanged(g,f)}),bi(this,"onResizeStart",(t,r,n,i)=>{let{e:o,node:a}=i,{layout:s}=this.state,l=(0,qe.getLayoutItem)(s,t);l&&(this.setState({oldResizeItem:(0,qe.cloneLayoutItem)(l),oldLayout:this.state.layout,resizing:!0}),this.props.onResizeStart(s,l,l,null,o,a))}),bi(this,"onResize",(t,r,n,i)=>{let{e:o,node:a,size:s,handle:l}=i,{oldResizeItem:c}=this.state,{layout:d}=this.state,{cols:u,preventCollision:p,allowOverlap:m}=this.props,g=!1,f,y,h,[v,b]=(0,qe.withLayoutItem)(d,t,k=>{let S;return y=k.x,h=k.y,["sw","w","nw","n","ne"].indexOf(l)!==-1&&(["sw","nw","w"].indexOf(l)!==-1&&(y=k.x+(k.w-r),r=k.x!==y&&y<0?k.w:r,y=y<0?0:y),["ne","n","nw"].indexOf(l)!==-1&&(h=k.y+(k.h-n),n=k.y!==h&&h<0?k.h:n,h=h<0?0:h),g=!0),p&&!m&&(S=(0,qe.getAllCollisions)(d,{...k,w:r,h:n,x:y,y:h}).filter(T=>T.i!==k.i).length>0,S&&(h=k.y,n=k.h,y=k.x,r=k.w,g=!1)),k.w=r,k.h=n,k});if(!b)return;f=v,g&&(f=(0,qe.moveElement)(v,b,y,h,!0,this.props.preventCollision,(0,qe.compactType)(this.props),u,m));let w={w:b.w,h:b.h,x:b.x,y:b.y,static:!0,i:t};this.props.onResize(f,c,b,w,o,a),this.setState({layout:m?f:(0,qe.compact)(f,(0,qe.compactType)(this.props),u),activeDrag:w})}),bi(this,"onResizeStop",(t,r,n,i)=>{let{e:o,node:a}=i,{layout:s,oldResizeItem:l}=this.state,{cols:c,allowOverlap:d}=this.props,u=(0,qe.getLayoutItem)(s,t),p=d?s:(0,qe.compact)(s,(0,qe.compactType)(this.props),c);this.props.onResizeStop(p,l,u,null,o,a);let{oldLayout:m}=this.state;this.setState({activeDrag:null,layout:p,oldResizeItem:null,oldLayout:null,resizing:!1}),this.onLayoutMaybeChanged(p,m)}),bi(this,"onDragOver",t=>{var v;if(t.preventDefault(),t.stopPropagation(),nq&&!((v=t.nativeEvent.target)!=null&&v.classList.contains(tq)))return!1;let{droppingItem:r,onDropDragOver:n,margin:i,cols:o,rowHeight:a,maxRows:s,width:l,containerPadding:c,transformScale:d}=this.props,u=n==null?void 0:n(t);if(u===!1)return this.state.droppingDOMNode&&this.removeDroppingPlaceholder(),!1;let p={...r,...u},{layout:m}=this.state,g=t.currentTarget.getBoundingClientRect(),f=t.clientX-g.left,y=t.clientY-g.top,h={left:f/d,top:y/d,e:t};if(this.state.droppingDOMNode){if(this.state.droppingPosition){let{left:b,top:w}=this.state.droppingPosition;(b!=f||w!=y)&&this.setState({droppingPosition:h})}}else{let b={cols:o,margin:i,maxRows:s,rowHeight:a,containerWidth:l,containerPadding:c||i},w=(0,afe.calcXY)(b,y,f,p.w,p.h);this.setState({droppingDOMNode:Mu.createElement("div",{key:p.i}),droppingPosition:h,layout:[...m,{...p,x:w.x,y:w.y,static:!1,isDraggable:!0}]})}}),bi(this,"removeDroppingPlaceholder",()=>{let{droppingItem:t,cols:r}=this.props,{layout:n}=this.state,i=(0,qe.compact)(n.filter(o=>o.i!==t.i),(0,qe.compactType)(this.props),r,this.props.allowOverlap);this.setState({layout:i,droppingDOMNode:null,activeDrag:null,droppingPosition:void 0})}),bi(this,"onDragLeave",t=>{t.preventDefault(),t.stopPropagation(),this.dragEnterCounter--,this.dragEnterCounter===0&&this.removeDroppingPlaceholder()}),bi(this,"onDragEnter",t=>{t.preventDefault(),t.stopPropagation(),this.dragEnterCounter++}),bi(this,"onDrop",t=>{t.preventDefault(),t.stopPropagation();let{droppingItem:r}=this.props,{layout:n}=this.state,i=n.find(o=>o.i===r.i);this.dragEnterCounter=0,this.removeDroppingPlaceholder(),this.props.onDrop(n,i,t)})}componentDidMount(){this.setState({mounted:!0}),this.onLayoutMaybeChanged(this.state.layout,this.props.layout)}static getDerivedStateFromProps(t,r){let n;return r.activeDrag?null:(!(0,XO.deepEqual)(t.layout,r.propsLayout)||t.compactType!==r.compactType?n=t.layout:(0,qe.childrenEqual)(t.children,r.children)||(n=r.layout),n?{layout:(0,qe.synchronizeLayoutWithChildren)(n,t.children,t.cols,(0,qe.compactType)(t),t.allowOverlap),compactType:t.compactType,children:t.children,propsLayout:t.layout}:null)}shouldComponentUpdate(t,r){return this.props.children!==t.children||!(0,qe.fastRGLPropsEqual)(this.props,t,XO.deepEqual)||this.state.activeDrag!==r.activeDrag||this.state.mounted!==r.mounted||this.state.droppingPosition!==r.droppingPosition}componentDidUpdate(t,r){if(!this.state.activeDrag){let n=this.state.layout,i=r.layout;this.onLayoutMaybeChanged(n,i)}}containerHeight(){if(!this.props.autoSize)return;let t=(0,qe.bottom)(this.state.layout),r=this.props.containerPadding?this.props.containerPadding[1]:this.props.margin[1];return t*this.props.rowHeight+(t-1)*this.props.margin[1]+r*2+"px"}onLayoutMaybeChanged(t,r){r||(r=this.state.layout),(0,XO.deepEqual)(r,t)||this.props.onLayoutChange(t)}placeholder(){let{activeDrag:t}=this.state;if(!t)return null;let{width:r,cols:n,margin:i,containerPadding:o,rowHeight:a,maxRows:s,useCSSTransforms:l,transformScale:c}=this.props;return Mu.createElement(eq.default,{w:t.w,h:t.h,x:t.x,y:t.y,i:t.i,className:`react-grid-placeholder ${this.state.resizing?"placeholder-resizing":""}`,containerWidth:r,cols:n,margin:i,containerPadding:o||i,maxRows:s,rowHeight:a,isDraggable:!1,isResizable:!1,isBounded:!1,useCSSTransforms:l,transformScale:c},Mu.createElement("div",null))}processGridItem(t,r){if(!t||!t.key)return;let n=(0,qe.getLayoutItem)(this.state.layout,String(t.key));if(!n)return null;let{width:i,cols:o,margin:a,containerPadding:s,rowHeight:l,maxRows:c,isDraggable:d,isResizable:u,isBounded:p,useCSSTransforms:m,transformScale:g,draggableCancel:f,draggableHandle:y,resizeHandles:h,resizeHandle:v}=this.props,{mounted:b,droppingPosition:w}=this.state,k=typeof n.isDraggable=="boolean"?n.isDraggable:!n.static&&d,S=typeof n.isResizable=="boolean"?n.isResizable:!n.static&&u,x=n.resizeHandles||h,T=k&&p&&n.isBounded!==!1;return Mu.createElement(eq.default,{containerWidth:i,cols:o,margin:a,containerPadding:s||a,maxRows:c,rowHeight:l,cancel:f,handle:y,onDragStop:this.onDragStop,onDragStart:this.onDragStart,onDrag:this.onDrag,onResizeStart:this.onResizeStart,onResize:this.onResize,onResizeStop:this.onResizeStop,isDraggable:k,isResizable:S,isBounded:T,useCSSTransforms:m&&b,usePercentages:!b,transformScale:g,w:n.w,h:n.h,x:n.x,y:n.y,i:n.i,minH:n.minH,minW:n.minW,maxH:n.maxH,maxW:n.maxW,static:n.static,droppingPosition:r?w:void 0,resizeHandles:x,resizeHandle:v},t)}render(){let{className:t,style:r,isDroppable:n,innerRef:i}=this.props,o=(0,ofe.default)(tq,t),a={height:this.containerHeight(),...r};return Mu.createElement("div",{ref:i,className:o,style:a,onDrop:n?this.onDrop:qe.noop,onDragLeave:n?this.onDragLeave:qe.noop,onDragEnter:n?this.onDragEnter:qe.noop,onDragOver:n?this.onDragOver:qe.noop},Mu.Children.map(this.props.children,s=>this.processGridItem(s)),n&&this.state.droppingDOMNode&&this.processGridItem(this.state.droppingDOMNode,!0),this.placeholder())}};US.default=Ef;bi(Ef,"displayName","ReactGridLayout");bi(Ef,"propTypes",sfe.default);bi(Ef,"defaultProps",{autoSize:!0,cols:12,className:"",style:{},draggableHandle:"",draggableCancel:"",containerPadding:null,rowHeight:150,maxRows:1/0,layout:[],margin:[10,10],isBounded:!1,isDraggable:!0,isResizable:!0,allowOverlap:!1,isDroppable:!1,useCSSTransforms:!0,transformScale:1,verticalCompact:!0,compactType:"vertical",preventCollision:!1,droppingItem:{i:"__dropping-elem__",h:1,w:1},resizeHandles:["se"],onLayoutChange:qe.noop,onDragStart:qe.noop,onDrag:qe.noop,onDragStop:qe.noop,onResizeStart:qe.noop,onResize:qe.noop,onResizeStop:qe.noop,onDrop:qe.noop,onDropDragOver:qe.noop})});var tI=le(Df=>{"use strict";Object.defineProperty(Df,"__esModule",{value:!0});Df.findOrGenerateResponsiveLayout=mfe;Df.getBreakpointFromWidth=ufe;Df.getColsFromBreakpoint=pfe;Df.sortBreakpoints=eI;var VS=Du();function ufe(e,t){let r=eI(e),n=r[0];for(let i=1,o=r.length;i<o;i++){let a=r[i];t>e[a]&&(n=a)}return n}function pfe(e,t){if(!t[e])throw new Error("ResponsiveReactGridLayout: `cols` entry for breakpoint "+e+" is missing!");return t[e]}function mfe(e,t,r,n,i,o){if(e[r])return(0,VS.cloneLayout)(e[r]);let a=e[n],s=eI(t),l=s.slice(s.indexOf(r));for(let c=0,d=l.length;c<d;c++){let u=l[c];if(e[u]){a=e[u];break}}return a=(0,VS.cloneLayout)(a||[]),(0,VS.compact)((0,VS.correctBounds)(a,{cols:i}),o,i)}function eI(e){return Object.keys(e).sort(function(r,n){return e[r]-e[n]})}});var lq=le(GS=>{"use strict";Object.defineProperty(GS,"__esModule",{value:!0});GS.default=void 0;var iq=gfe(W()),po=aq(Rl()),rI=SS(),Pf=Du(),Ou=tI(),ffe=aq(ZO());function aq(e){return e&&e.__esModule?e:{default:e}}function sq(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(sq=function(n){return n?r:t})(e)}function gfe(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var r=sq(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function nI(){return nI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nI.apply(this,arguments)}function qS(e,t,r){return t=hfe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hfe(e){var t=vfe(e,"string");return typeof t=="symbol"?t:String(t)}function vfe(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oq=e=>Object.prototype.toString.call(e);function HS(e,t){return e==null?null:Array.isArray(e)?e:e[t]}var ay=class extends iq.Component{constructor(){super(...arguments),qS(this,"state",this.generateInitialState()),qS(this,"onLayoutChange",t=>{this.props.onLayoutChange(t,{...this.props.layouts,[this.state.breakpoint]:t})})}generateInitialState(){let{width:t,breakpoints:r,layouts:n,cols:i}=this.props,o=(0,Ou.getBreakpointFromWidth)(r,t),a=(0,Ou.getColsFromBreakpoint)(o,i),s=this.props.verticalCompact===!1?null:this.props.compactType;return{layout:(0,Ou.findOrGenerateResponsiveLayout)(n,r,o,o,a,s),breakpoint:o,cols:a}}static getDerivedStateFromProps(t,r){if(!(0,rI.deepEqual)(t.layouts,r.layouts)){let{breakpoint:n,cols:i}=r;return{layout:(0,Ou.findOrGenerateResponsiveLayout)(t.layouts,t.breakpoints,n,n,i,t.compactType),layouts:t.layouts}}return null}componentDidUpdate(t){(this.props.width!=t.width||this.props.breakpoint!==t.breakpoint||!(0,rI.deepEqual)(this.props.breakpoints,t.breakpoints)||!(0,rI.deepEqual)(this.props.cols,t.cols))&&this.onWidthChange(t)}onWidthChange(t){let{breakpoints:r,cols:n,layouts:i,compactType:o}=this.props,a=this.props.breakpoint||(0,Ou.getBreakpointFromWidth)(this.props.breakpoints,this.props.width),s=this.state.breakpoint,l=(0,Ou.getColsFromBreakpoint)(a,n),c={...i};if(s!==a||t.breakpoints!==r||t.cols!==n){s in c||(c[s]=(0,Pf.cloneLayout)(this.state.layout));let p=(0,Ou.findOrGenerateResponsiveLayout)(c,r,a,s,l,o);p=(0,Pf.synchronizeLayoutWithChildren)(p,this.props.children,l,o,this.props.allowOverlap),c[a]=p,this.props.onBreakpointChange(a,l),this.props.onLayoutChange(p,c),this.setState({breakpoint:a,layout:p,cols:l})}let d=HS(this.props.margin,a),u=HS(this.props.containerPadding,a);this.props.onWidthChange(this.props.width,d,l,u)}render(){let{breakpoint:t,breakpoints:r,cols:n,layouts:i,margin:o,containerPadding:a,onBreakpointChange:s,onLayoutChange:l,onWidthChange:c,...d}=this.props;return iq.createElement(ffe.default,nI({},d,{margin:HS(o,this.state.breakpoint),containerPadding:HS(a,this.state.breakpoint),onLayoutChange:this.onLayoutChange,layout:this.state.layout,cols:this.state.cols}))}};GS.default=ay;qS(ay,"propTypes",{breakpoint:po.default.string,breakpoints:po.default.object,allowOverlap:po.default.bool,cols:po.default.object,margin:po.default.oneOfType([po.default.array,po.default.object]),containerPadding:po.default.oneOfType([po.default.array,po.default.object]),layouts(e,t){if(oq(e[t])!=="[object Object]")throw new Error("Layout property must be an object. Received: "+oq(e[t]));Object.keys(e[t]).forEach(r=>{if(!(r in e.breakpoints))throw new Error("Each key in layouts must align with a key in breakpoints.");(0,Pf.validateLayout)(e.layouts[r],"layouts."+r)})},width:po.default.number.isRequired,onBreakpointChange:po.default.func,onLayoutChange:po.default.func,onWidthChange:po.default.func});qS(ay,"defaultProps",{breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:12,md:10,sm:6,xs:4,xxs:2},containerPadding:{lg:null,md:null,sm:null,xs:null,xxs:null},layouts:{},margin:[10,10],allowOverlap:!1,onBreakpointChange:Pf.noop,onLayoutChange:Pf.noop,onWidthChange:Pf.noop})});var cq=le((iI,oI)=>{(function(e,t){typeof iI=="object"&&typeof oI!="undefined"?oI.exports=t():typeof define=="function"&&define.amd?define(t):e.ResizeObserver=t()})(iI,function(){"use strict";var e=function(){if(typeof Map!="undefined")return Map;function A(P,I){var M=-1;return P.some(function(O,F){return O[0]===I?(M=F,!0):!1}),M}return function(){function P(){this.__entries__=[]}return Object.defineProperty(P.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),P.prototype.get=function(I){var M=A(this.__entries__,I),O=this.__entries__[M];return O&&O[1]},P.prototype.set=function(I,M){var O=A(this.__entries__,I);~O?this.__entries__[O][1]=M:this.__entries__.push([I,M])},P.prototype.delete=function(I){var M=this.__entries__,O=A(M,I);~O&&M.splice(O,1)},P.prototype.has=function(I){return!!~A(this.__entries__,I)},P.prototype.clear=function(){this.__entries__.splice(0)},P.prototype.forEach=function(I,M){M===void 0&&(M=null);for(var O=0,F=this.__entries__;O<F.length;O++){var L=F[O];I.call(M,L[1],L[0])}},P}()}(),t=typeof window!="undefined"&&typeof document!="undefined"&&window.document===document,r=function(){return typeof global!="undefined"&&global.Math===Math?global:typeof self!="undefined"&&self.Math===Math?self:typeof window!="undefined"&&window.Math===Math?window:Function("return this")()}(),n=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(r):function(A){return setTimeout(function(){return A(Date.now())},1e3/60)}}(),i=2;function o(A,P){var I=!1,M=!1,O=0;function F(){I&&(I=!1,A()),M&&B()}function L(){n(F)}function B(){var j=Date.now();if(I){if(j-O<i)return;M=!0}else I=!0,M=!1,setTimeout(L,P);O=j}return B}var a=20,s=["top","right","bottom","left","width","height","size","weight"],l=typeof MutationObserver!="undefined",c=function(){function A(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=o(this.refresh.bind(this),a)}return A.prototype.addObserver=function(P){~this.observers_.indexOf(P)||this.observers_.push(P),this.connected_||this.connect_()},A.prototype.removeObserver=function(P){var I=this.observers_,M=I.indexOf(P);~M&&I.splice(M,1),!I.length&&this.connected_&&this.disconnect_()},A.prototype.refresh=function(){var P=this.updateObservers_();P&&this.refresh()},A.prototype.updateObservers_=function(){var P=this.observers_.filter(function(I){return I.gatherActive(),I.hasActive()});return P.forEach(function(I){return I.broadcastActive()}),P.length>0},A.prototype.connect_=function(){!t||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),l?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},A.prototype.disconnect_=function(){!t||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},A.prototype.onTransitionEnd_=function(P){var I=P.propertyName,M=I===void 0?"":I,O=s.some(function(F){return!!~M.indexOf(F)});O&&this.refresh()},A.getInstance=function(){return this.instance_||(this.instance_=new A),this.instance_},A.instance_=null,A}(),d=function(A,P){for(var I=0,M=Object.keys(P);I<M.length;I++){var O=M[I];Object.defineProperty(A,O,{value:P[O],enumerable:!1,writable:!1,configurable:!0})}return A},u=function(A){var P=A&&A.ownerDocument&&A.ownerDocument.defaultView;return P||r},p=S(0,0,0,0);function m(A){return parseFloat(A)||0}function g(A){for(var P=[],I=1;I<arguments.length;I++)P[I-1]=arguments[I];return P.reduce(function(M,O){var F=A["border-"+O+"-width"];return M+m(F)},0)}function f(A){for(var P=["top","right","bottom","left"],I={},M=0,O=P;M<O.length;M++){var F=O[M],L=A["padding-"+F];I[F]=m(L)}return I}function y(A){var P=A.getBBox();return S(0,0,P.width,P.height)}function h(A){var P=A.clientWidth,I=A.clientHeight;if(!P&&!I)return p;var M=u(A).getComputedStyle(A),O=f(M),F=O.left+O.right,L=O.top+O.bottom,B=m(M.width),j=m(M.height);if(M.boxSizing==="border-box"&&(Math.round(B+F)!==P&&(B-=g(M,"left","right")+F),Math.round(j+L)!==I&&(j-=g(M,"top","bottom")+L)),!b(A)){var _=Math.round(B+F)-P,H=Math.round(j+L)-I;Math.abs(_)!==1&&(B-=_),Math.abs(H)!==1&&(j-=H)}return S(O.left,O.top,B,j)}var v=function(){return typeof SVGGraphicsElement!="undefined"?function(A){return A instanceof u(A).SVGGraphicsElement}:function(A){return A instanceof u(A).SVGElement&&typeof A.getBBox=="function"}}();function b(A){return A===u(A).document.documentElement}function w(A){return t?v(A)?y(A):h(A):p}function k(A){var P=A.x,I=A.y,M=A.width,O=A.height,F=typeof DOMRectReadOnly!="undefined"?DOMRectReadOnly:Object,L=Object.create(F.prototype);return d(L,{x:P,y:I,width:M,height:O,top:I,right:P+M,bottom:O+I,left:P}),L}function S(A,P,I,M){return{x:A,y:P,width:I,height:M}}var x=function(){function A(P){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=S(0,0,0,0),this.target=P}return A.prototype.isActive=function(){var P=w(this.target);return this.contentRect_=P,P.width!==this.broadcastWidth||P.height!==this.broadcastHeight},A.prototype.broadcastRect=function(){var P=this.contentRect_;return this.broadcastWidth=P.width,this.broadcastHeight=P.height,P},A}(),T=function(){function A(P,I){var M=k(I);d(this,{target:P,contentRect:M})}return A}(),E=function(){function A(P,I,M){if(this.activeObservations_=[],this.observations_=new e,typeof P!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=P,this.controller_=I,this.callbackCtx_=M}return A.prototype.observe=function(P){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element=="undefined"||!(Element instanceof Object))){if(!(P instanceof u(P).Element))throw new TypeError('parameter 1 is not of type "Element".');var I=this.observations_;I.has(P)||(I.set(P,new x(P)),this.controller_.addObserver(this),this.controller_.refresh())}},A.prototype.unobserve=function(P){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element=="undefined"||!(Element instanceof Object))){if(!(P instanceof u(P).Element))throw new TypeError('parameter 1 is not of type "Element".');var I=this.observations_;I.has(P)&&(I.delete(P),I.size||this.controller_.removeObserver(this))}},A.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},A.prototype.gatherActive=function(){var P=this;this.clearActive(),this.observations_.forEach(function(I){I.isActive()&&P.activeObservations_.push(I)})},A.prototype.broadcastActive=function(){if(this.hasActive()){var P=this.callbackCtx_,I=this.activeObservations_.map(function(M){return new T(M.target,M.broadcastRect())});this.callback_.call(P,I,P),this.clearActive()}},A.prototype.clearActive=function(){this.activeObservations_.splice(0)},A.prototype.hasActive=function(){return this.activeObservations_.length>0},A}(),C=typeof WeakMap!="undefined"?new WeakMap:new e,N=function(){function A(P){if(!(this instanceof A))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var I=c.getInstance(),M=new E(P,I,this);C.set(this,M)}return A}();["observe","unobserve","disconnect"].forEach(function(A){N.prototype[A]=function(){var P;return(P=C.get(this))[A].apply(P,arguments)}});var D=function(){return typeof r.ResizeObserver!="undefined"?r.ResizeObserver:N}();return D})});var uq=le(lI=>{"use strict";Object.defineProperty(lI,"__esModule",{value:!0});lI.default=Cfe;var YS=xfe(W()),yfe=sI(Rl()),bfe=sI(cq()),wfe=sI(TS());function sI(e){return e&&e.__esModule?e:{default:e}}function dq(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,r=new WeakMap;return(dq=function(n){return n?r:t})(e)}function xfe(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||typeof e!="object"&&typeof e!="function")return{default:e};var r=dq(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(o!=="default"&&Object.prototype.hasOwnProperty.call(e,o)){var a=i?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o]}return n.default=e,r&&r.set(e,n),n}function aI(){return aI=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},aI.apply(this,arguments)}function Af(e,t,r){return t=kfe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kfe(e){var t=Sfe(e,"string");return typeof t=="symbol"?t:String(t)}function Sfe(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Tfe="react-grid-layout";function Cfe(e){var t;return t=class extends YS.Component{constructor(){super(...arguments),Af(this,"state",{width:1280}),Af(this,"elementRef",YS.createRef()),Af(this,"mounted",!1),Af(this,"resizeObserver",void 0)}componentDidMount(){this.mounted=!0,this.resizeObserver=new bfe.default(i=>{if(this.elementRef.current instanceof HTMLElement){let a=i[0].contentRect.width;this.setState({width:a})}});let n=this.elementRef.current;n instanceof HTMLElement&&this.resizeObserver.observe(n)}componentWillUnmount(){this.mounted=!1;let n=this.elementRef.current;n instanceof HTMLElement&&this.resizeObserver.unobserve(n),this.resizeObserver.disconnect()}render(){let{measureBeforeMount:n,...i}=this.props;return n&&!this.mounted?YS.createElement("div",{className:(0,wfe.default)(this.props.className,Tfe),style:this.props.style,ref:this.elementRef}):YS.createElement(e,aI({innerRef:this.elementRef},i,this.state))}},Af(t,"defaultProps",{measureBeforeMount:!1}),Af(t,"propTypes",{measureBeforeMount:yfe.default.bool}),t}});var pq=le((w9e,Iu)=>{Iu.exports=ZO().default;Iu.exports.utils=Du();Iu.exports.calculateUtils=PS();Iu.exports.Responsive=lq().default;Iu.exports.Responsive.utils=tI();Iu.exports.WidthProvider=uq().default});var Fa,lG,cG=it(()=>{Fa=$(W()),lG=({currentStep:e,totalSteps:t,stepLabels:r,className:n=""})=>{let i=Math.max(0,Math.min(100,e/t*100));return Fa.default.createElement("div",{className:`wizard-progress-container ${n}`,role:"progressbar","aria-valuenow":e,"aria-valuemin":0,"aria-valuemax":t,"aria-label":`Step ${e} of ${t}`,tabIndex:0},Fa.default.createElement("div",{className:"wizard-steps"},Array.from({length:t},(o,a)=>{let s=a+1,l=s<e,c=s===e,d=r==null?void 0:r[a];return Fa.default.createElement("div",{key:s,className:`wizard-step ${l?"completed":""} ${c?"current":""}`,"aria-label":d?`${d}${l?" (completed)":c?" (current)":""}`:`Step ${s}`},Fa.default.createElement("div",{className:"wizard-step-circle"},l?Fa.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none","aria-hidden":"true"},Fa.default.createElement("path",{d:"M2 6L5 9L10 3",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})):Fa.default.createElement("span",{className:"wizard-step-number","aria-hidden":"true"},s)),d&&Fa.default.createElement("div",{className:"wizard-step-label"},d))})),Fa.default.createElement("div",{className:"wizard-progress-track","aria-hidden":"true"},Fa.default.createElement("div",{className:"wizard-progress-fill",style:{width:`${i}%`}})),Fa.default.createElement("div",{className:"sr-only","aria-live":"polite","aria-atomic":"true"},"Step ",e," of ",t," completed",(r==null?void 0:r[e-1])&&`: ${r[e-1]}`))}});var If,ho,Qc=it(()=>{If=$(W()),ho=({title:e,subtitle:t,icon:r,className:n="",children:i})=>If.default.createElement("div",{className:`onboarding-slide ${n}`},r&&If.default.createElement("div",{className:"step-icon"},r),If.default.createElement("h2",null,e),t&&If.default.createElement("p",null,t),If.default.createElement("div",{className:"step-content"},i))});var Ff,oT,xI=it(()=>{Ff=$(W()),oT=({icon:e,title:t,content:r,isPreview:n=!1,className:i=""})=>{let o=n?"insight-preview-card":"insight-card",a=n?"insight-preview-header":"insight-header",s=n?"insight-preview-icon":"insight-icon",l=n?"insight-preview-content":"insight-detail";return Ff.default.createElement("div",{className:`${o} ${i}`},Ff.default.createElement("div",{className:a},Ff.default.createElement("span",{className:s},e),Ff.default.createElement("strong",null,t)),Ff.default.createElement("div",{className:l},r))}});var vs,kI,dG=it(()=>{vs=$(W());Qc();xI();kI=({className:e=""})=>{let t=[{icon:"\u{1F4CA}",title:"Win Rate Analysis",content:'"Your breakout setups have an 82% win rate vs 67% for pullbacks"'},{icon:"\u23F0",title:"Timing Patterns",content:'"Trades held 2-4 hours show 3x better risk-reward than scalps"'},{icon:"\u{1F9E0}",title:"Psychology Tracking",content:'"You take profits 15% too early when up more than $500"'}],r=["Your data, your device - Complete ownership and control","Works with any broker - MetaTrader sync + manual entry","Fully customizable - Track what matters to you"];return vs.default.createElement(ho,{title:"Welcome to Journalit",subtitle:"The trading journal that helps you turn insights into profits",className:`welcome-slide ${e}`},vs.default.createElement("div",{className:"welcome-preview-section"},vs.default.createElement("h3",null,"What you'll discover:"),vs.default.createElement("div",{className:"insights-preview"},t.map((n,i)=>vs.default.createElement(oT,{key:i,icon:n.icon,title:n.title,content:n.content,isPreview:!0})))),vs.default.createElement("div",{className:"welcome-trust-indicators"},r.map((n,i)=>vs.default.createElement("div",{key:i,className:"trust-item"},vs.default.createElement("span",{className:"trust-icon"},"\u2705"),vs.default.createElement("span",null,n)))),vs.default.createElement("div",{className:"welcome-tagline"},"Let's get you set up in under 60 seconds"))}});var Wi,uy,SI=it(()=>{Wi=$(W()),uy=({options:e,selectedValue:t,onSelect:r,className:n="",variant:i="default"})=>{let o=i==="goal"?"goal-options":"radio-options",a=i==="goal"?"goal-option":"radio-option",s=i==="goal"?"goal-radio":"option-radio",l=i==="goal"?"goal-radio-inner":"radio-inner",c=i==="goal"?"goal-content":"option-content";return Wi.default.createElement("div",{className:`${o} ${n}`},e.map((d,u)=>Wi.default.createElement("div",{key:d.value,className:`${a} ${t===d.value?"selected":""}`,onClick:()=>r(d.value),role:"button",tabIndex:0,autoFocus:u===0,onKeyPress:p=>p.key==="Enter"&&r(d.value)},Wi.default.createElement("div",{className:s},Wi.default.createElement("div",{className:`${l} ${t===d.value?"selected":""}`})),Wi.default.createElement("div",{className:c},i==="goal"?Wi.default.createElement(Wi.default.Fragment,null,Wi.default.createElement("h3",null,d.icon?`${d.icon} ${d.label}`:d.label),d.description&&Wi.default.createElement("p",null,d.description),d.badge&&Wi.default.createElement("span",{className:"goal-badge"},d.badge)):Wi.default.createElement(Wi.default.Fragment,null,Wi.default.createElement("span",{className:"option-label"},d.label),d.description&&Wi.default.createElement("span",{className:"option-description"},d.description))))))}});var py,TI,uG=it(()=>{py=$(W());Qc();SI();TI=({selectedGoal:e,onGoalSelect:t,className:r=""})=>{let n=[{value:"psychology",label:"Understand My Trading Psychology",description:"Identify emotional patterns and improve decision-making to become a more disciplined trader",badge:"Build better habits",icon:"\u{1F9E0}"},{value:"patterns",label:"Find Performance Patterns",description:"Discover what makes your winning trades different and optimize your strategy for consistent profits",badge:"Most popular",icon:"\u{1F4CA}"},{value:"automation",label:"Automate Everything",description:"Focus on trading while we handle the tracking - automatic data collection and analysis",badge:"Time saver",icon:"\u26A1"}],i=o=>{switch(o){case"psychology":return"Understand My Trading Psychology";case"patterns":return"Find Performance Patterns";case"automation":return"Automate Everything";default:return""}};return py.default.createElement(ho,{title:"What's your trading goal?",subtitle:`Choose the approach that best fits your needs.
You can change this later.`,className:`goal-slide ${r}`},py.default.createElement(uy,{options:n,selectedValue:e,onSelect:t,variant:"goal"}),e&&py.default.createElement("div",{className:"goal-selection-info"},"\u2713 You selected: ",py.default.createElement("strong",null,i(e))))}});var jf,pG,mG=it(()=>{jf=$(W()),pG=({options:e,selectedValues:t,onSelectionChange:r,className:n=""})=>{let i=o=>{let a=t.includes(o)?t.filter(s=>s!==o):[...t,o];r(a)};return jf.default.createElement("div",{className:`multi-select-options ${n}`},e.map(o=>{let a=t.includes(o.value);return jf.default.createElement("div",{key:o.value,className:`multi-select-option ${a?"selected":""}`,onClick:()=>i(o.value),role:"button",tabIndex:0,onKeyPress:s=>s.key==="Enter"&&i(o.value)},jf.default.createElement("div",{className:"option-checkbox"},a&&jf.default.createElement("span",null,"\u2713")),jf.default.createElement("span",{className:"option-label"},o.label))}))}});var ja,CI,fG=it(()=>{ja=$(W());Qc();mG();SI();CI=({userSegmentation:e,onSegmentationChange:t,className:r=""})=>{let n=[{value:"stocks",label:"Stocks"},{value:"forex",label:"Forex"},{value:"crypto",label:"Crypto"},{value:"options",label:"Options"},{value:"futures",label:"Futures"}],i=[{value:"daily",label:"Daily",description:"Multiple trades per day"},{value:"weekly",label:"Weekly",description:"1-5 trades per week"},{value:"monthly",label:"Monthly",description:"Less than 5 trades per month"},{value:"occasional",label:"Occasionally",description:"When good opportunities arise"}],o=[{value:"emotional-control",label:"Emotional Control",description:"Managing fear and greed in trades"},{value:"strategy-optimization",label:"Strategy Optimization",description:"Finding and refining profitable setups"},{value:"record-keeping",label:"Record Keeping",description:"Consistently tracking all trades and data"},{value:"risk-management",label:"Risk Management",description:"Setting proper position sizes and stops"}],a=c=>{t({...e,instruments:c})},s=c=>{t({...e,frequency:c})},l=c=>{t({...e,challenge:c})};return ja.default.createElement(ho,{title:"Tell us about your trading",subtitle:"Help us personalize your experience based on your trading style.",className:`segmentation-slide ${r}`},ja.default.createElement("div",{className:"segmentation-questions"},ja.default.createElement("div",{className:"segmentation-question"},ja.default.createElement("h3",null,"What do you primarily trade? (Select all that apply)"),ja.default.createElement(pG,{options:n,selectedValues:e.instruments,onSelectionChange:a})),ja.default.createElement("div",{className:"segmentation-question"},ja.default.createElement("h3",null,"How often do you trade?"),ja.default.createElement(uy,{options:i,selectedValue:e.frequency,onSelect:s})),ja.default.createElement("div",{className:"segmentation-question"},ja.default.createElement("h3",null,"What's your biggest challenge?"),ja.default.createElement(uy,{options:o,selectedValue:e.challenge,onSelect:l}))))}});var Ul,Lf,aT=it(()=>{Ul=$(W()),Lf=({title:e,subtitle:t,actions:r,children:n,className:i=""})=>Ul.default.createElement("div",{className:`success-state ${i}`},Ul.default.createElement("div",{className:"success-checkmark"},"\u2713"),Ul.default.createElement("h3",null,e),t&&Ul.default.createElement("p",null,t),r&&r.length>0&&Ul.default.createElement("div",{className:"success-actions"},r.map((o,a)=>Ul.default.createElement("div",{key:a,className:"success-action"},Ul.default.createElement("span",{className:"action-icon"},o.icon),Ul.default.createElement("span",null,o.text)))),n)});var qt,EI,gG=it(()=>{qt=$(W());Qc();aT();xI();Ci();bd();EI=({goal:e,userSegmentation:t,sampleTradeCreated:r,sampleTradeFilePath:n,isLoading:i,onCreateSampleTrade:o,className:a=""})=>{let s=()=>{let d=t.instruments[0]||"stocks",u=t.frequency,p;switch(d){case"forex":p={trade:"EURUSD Long (+70 pips)",timeframe:u==="daily"?"30min scalp":u==="weekly"?"3-day swing":"1-week position"};break;case"crypto":p={trade:"BTC/USD Long (+$1,700)",timeframe:u==="daily"?"1-hour momentum":u==="weekly"?"3-day breakout":"1-week trend"};break;case"options":p={trade:"AAPL Call (+64% profit)",timeframe:u==="daily"?"0DTE scalp":u==="weekly"?"30DTE swing":"60DTE position"};break;default:p={trade:"AAPL Long (+$625 profit)",timeframe:u==="daily"?"30min momentum":u==="weekly"?"3-day swing":"1-week position"}}return{...p,focus:{"emotional-control":"Psychology tracking","strategy-optimization":"Setup analysis","record-keeping":"Complete documentation","risk-management":"Risk metrics"}[t.challenge],tags:`demo-trade, ${d}`}},l=()=>{switch(e){case"psychology":return[{icon:"\u{1F9E0}",title:"Emotional Analysis",content:"You held this trade for the full plan despite a 15% drawdown. This discipline is what separates profitable traders from emotional ones."},{icon:"\u{1F48E}",title:"Patience Tracking",content:"By waiting for your full profit target, you earned 40% more than if you had taken early profits at the first sign of strength."},{icon:"\u{1F4C8}",title:"Confidence Building",content:"Trades like this, where you stick to your plan, build psychological capital for bigger positions in the future."}];case"patterns":return[{icon:"\u{1F4CA}",title:"Setup Performance",content:"This breakout pattern has an 82% win rate in your trading history - significantly higher than pullback entries at 67%."},{icon:"\u23F0",title:"Timing Optimization",content:"Entries between 10-11 AM ET show 3x better risk-reward ratios than afternoon trades in this setup type."},{icon:"\u{1F3AF}",title:"Pattern Recognition",content:"This setup appears 2-3 times per week in your preferred instruments. Journalit will alert you to similar patterns."}];default:return[{icon:"\u26A1",title:"Automation Ready",content:"This trade was automatically imported from MetaTrader with complete data - no manual entry required."},{icon:"\u{1F4CA}",title:"Real-time Sync",content:"Your risk metrics updated live during the trade, showing exactly when to scale out or add to positions."},{icon:"\u{1F504}",title:"Effortless Tracking",content:"With full automation, you can focus on trading decisions while Journalit handles all the data collection and analysis."}]}},c=s();if(r){let d=l();return qt.default.createElement("div",{className:`first-action-slide ${a}`},qt.default.createElement(Lf,{title:"Great! Here's what we learned from your sample trade:",className:"first-action-success"},qt.default.createElement("div",{className:"trade-insights"},d.map((u,p)=>qt.default.createElement(oT,{key:p,icon:u.icon,title:u.title,content:u.content}))),n&&qt.default.createElement("div",{className:"sample-trade-path"},qt.default.createElement("small",null,"Trade created at: ",n))))}return qt.default.createElement(ho,{title:"Experience Journalit in action",subtitle:"Let's create a sample trade note so you can see how everything works.",icon:"\u{1F4DD}",className:`first-action-slide ${a}`},qt.default.createElement("div",{className:"first-action-content"},qt.default.createElement("div",{className:"first-action-preview"},qt.default.createElement("h3",null,"What we'll create based on your trading style:"),qt.default.createElement("div",{className:"sample-trade-preview"},qt.default.createElement("div",{className:"preview-row"},qt.default.createElement("span",{className:"preview-label"},"\u{1F4C8} Trade:"),qt.default.createElement("span",{className:"preview-value"},c.trade)),qt.default.createElement("div",{className:"preview-row"},qt.default.createElement("span",{className:"preview-label"},"\u23F0 Style:"),qt.default.createElement("span",{className:"preview-value"},c.timeframe)),qt.default.createElement("div",{className:"preview-row"},qt.default.createElement("span",{className:"preview-label"},"\u{1F3AF} Focus:"),qt.default.createElement("span",{className:"preview-value"},c.focus)),qt.default.createElement("div",{className:"preview-row"},qt.default.createElement("span",{className:"preview-label"},"\u{1F3F7}\uFE0F Tags:"),qt.default.createElement("span",{className:"preview-value"},c.tags)))),qt.default.createElement(be,{onClick:o,disabled:i,variant:"primary",size:"large",className:"create-sample-button",autoFocus:!0},qt.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"center"}},i&&qt.default.createElement(Or,{size:"small",message:""}),i?"Creating your sample trade...":"\u2728 Create Sample Trade")),qt.default.createElement("p",{className:"first-action-note"},"This creates a real trade note in your vault that you can explore and delete later.")))}});var _f,DI,hG=it(()=>{_f=$(W());Qc();aT();kE();DI=({isAuthenticated:e,onAuthSuccess:t,onAuthCancel:r,className:n=""})=>e?_f.default.createElement("div",{className:`authentication-slide ${n}`},_f.default.createElement(Lf,{title:"Account connected successfully!",subtitle:"You now have access to all premium features including MetaTrader sync.",className:"auth-success"})):_f.default.createElement(ho,{title:"\u{1F510} Connect your account",subtitle:"Sign in to unlock MetaTrader sync and advanced features.",className:`authentication-slide ${n}`},_f.default.createElement("div",{className:"auth-component-wrapper"},_f.default.createElement(xE,{onSuccess:t,onCancel:r})))});var Fe,PI,vG=it(()=>{Fe=$(W());Qc();aT();Ci();bd();PI=({ftpCredentialsGenerated:e,ftpCredentials:t,isLoading:r,onGenerateFtpCredentials:n,onCopyToClipboard:i,className:o=""})=>{let a=[{icon:"\u{1F510}",text:"Secure FTP credentials for your MetaTrader"},{icon:"\u26A1",text:"Automatic report upload and processing"},{icon:"\u{1F4CA}",text:"Real-time trade data in your journal"}];return e&&t?Fe.default.createElement("div",{className:`ftp-credentials-slide ${o}`,style:{marginTop:"-20px"}},Fe.default.createElement(Lf,{title:"Your FTP credentials are ready!",subtitle:"Configure these settings in your MetaTrader platform:",className:"ftp-credentials-display"},Fe.default.createElement("div",{className:"credentials-container"},Fe.default.createElement("div",{className:"credential-row"},Fe.default.createElement("span",{className:"credential-label"},"FTP server:"),Fe.default.createElement("div",{className:"credential-value-container"},Fe.default.createElement("code",{className:"credential-value"},t.host,":",t.port),Fe.default.createElement(be,{size:"small",variant:"secondary",onClick:()=>i(`${t.host}:${t.port}`,"FTP Server")},"\u{1F4CB}"))),Fe.default.createElement("div",{className:"credential-row"},Fe.default.createElement("span",{className:"credential-label"},"Path:"),Fe.default.createElement("div",{className:"credential-value-container"},Fe.default.createElement("code",{className:"credential-value"},"(leave empty)"),Fe.default.createElement(be,{size:"small",variant:"secondary",onClick:()=>i("","Path")},"\u{1F4CB}"))),Fe.default.createElement("div",{className:"credential-row"},Fe.default.createElement("span",{className:"credential-label"},"FTP login:"),Fe.default.createElement("div",{className:"credential-value-container"},Fe.default.createElement("code",{className:"credential-value"},t.username),Fe.default.createElement(be,{size:"small",variant:"secondary",onClick:()=>i(t.username,"Username")},"\u{1F4CB}"))),Fe.default.createElement("div",{className:"credential-row"},Fe.default.createElement("span",{className:"credential-label"},"FTP password:"),Fe.default.createElement("div",{className:"credential-value-container"},Fe.default.createElement("code",{className:"credential-value"},"\u2022".repeat(t.password.length)),Fe.default.createElement(be,{size:"small",variant:"secondary",onClick:()=>i(t.password,"Password")},"\u{1F4CB}")))),Fe.default.createElement("div",{className:"ftp-setup-note",style:{marginTop:"20px"}},Fe.default.createElement("p",{style:{marginBottom:"8px"}},Fe.default.createElement("strong",null,"Next Steps:")),Fe.default.createElement("ol",{style:{paddingLeft:"20px",margin:"0"}},Fe.default.createElement("li",null,"Open MT5"),Fe.default.createElement("li",null,'Click on the "Tools" menu at the top'),Fe.default.createElement("li",null,'Go to "Options"'),Fe.default.createElement("li",null,'Go to the "FTP" tab & enter the credentials provided above'),Fe.default.createElement("li",null,"Enable Passive mode"),Fe.default.createElement("li",null,"Enable automatic publishing of reports via FTP (Refresh every 60 minutes)"))),Fe.default.createElement("div",{className:"ftp-test-note",style:{marginTop:"16px",color:"#8a2be2"}},Fe.default.createElement("p",{style:{margin:"0"}},Fe.default.createElement("strong",null,'Clicking "Test" will send your first sync through to our server! You will need to go into the plugin settings to "Force Sync" the trades.')),Fe.default.createElement("p",{style:{margin:"4px 0 0 0",fontSize:"0.9em"}},"(if you have any trades in your MT account)")))):Fe.default.createElement(ho,{title:"Setup MetaTrader sync",subtitle:"Generate your FTP credentials to enable automatic trade collection from MT4/MT5.",icon:"\u{1F4E1}",className:`ftp-credentials-slide ${o}`},Fe.default.createElement("div",{className:"ftp-security-note"},Fe.default.createElement("div",{className:"security-highlight"},Fe.default.createElement("span",{className:"security-icon"},"\u{1F6E1}\uFE0F"),Fe.default.createElement("span",null,Fe.default.createElement("strong",null,"100% secure:")," We never have access to your trading account - only reports are uploaded"))),Fe.default.createElement("div",{className:"ftp-generate-section"},Fe.default.createElement("div",{className:"ftp-info"},Fe.default.createElement("h3",null,"What you'll get:"),Fe.default.createElement("div",{className:"ftp-benefits"},a.map((s,l)=>Fe.default.createElement("div",{key:l,className:"ftp-benefit"},Fe.default.createElement("span",{className:"benefit-icon"},s.icon),Fe.default.createElement("span",null,s.text))))),Fe.default.createElement(be,{onClick:n,disabled:r,variant:"primary",size:"large",className:"generate-ftp-button",autoFocus:!0},Fe.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"center"}},r&&Fe.default.createElement(Or,{size:"small",message:""}),r?"Generating credentials...":"\u{1F511} Generate FTP Credentials"))))}});var Sr,AI,yG=it(()=>{Sr=$(W());Qc();Ci();AI=({sampleTradeCreated:e,isAuthenticated:t,ftpCredentialsGenerated:r,telemetryOptIn:n,onTelemetryOptInChange:i,onComplete:o,className:a=""})=>{let s=[{icon:"\u{1F4CA}",text:"Chosen your trading goal",completed:!0},{icon:"\u{1F4DD}",text:"Created your first sample trade",completed:e},{icon:"\u{1F510}",text:"Connected your account",completed:t},{icon:"\u{1F4E1}",text:"Generated FTP credentials",completed:r}].filter(c=>c.completed),l=[{href:"https://github.com/Cursivez/journalit",text:"\u{1F4DA} View Documentation"},{href:"https://discord.gg/AkSw3D9h8b",text:"\u{1F4AC} Join Community"},{href:"mailto:contact@journalit.co",text:"\u{1F198} Get Support"}];return Sr.default.createElement(ho,{title:"Welcome to Journalit!",subtitle:"You're all set up and ready to transform your trading journey.",className:`completion-slide ${a}`},Sr.default.createElement("div",{className:"completion-celebration"},"\u{1F389}"),Sr.default.createElement("div",{className:"completion-summary"},Sr.default.createElement("h3",null,"What you've accomplished:"),Sr.default.createElement("div",{className:"accomplishments"},s.map((c,d)=>Sr.default.createElement("div",{key:d,className:"accomplishment"},Sr.default.createElement("span",{className:"accomplishment-icon"},c.icon),Sr.default.createElement("span",null,c.text),Sr.default.createElement("span",{className:"accomplishment-status"},"\u2713"))))),Sr.default.createElement("div",{className:"telemetry-section"},Sr.default.createElement("h3",null,"Help us improve Journalit"),Sr.default.createElement("p",null,"Share anonymous usage data to help us build better features for traders like you."),Sr.default.createElement("div",{className:"telemetry-option"},Sr.default.createElement("label",{className:"telemetry-checkbox"},Sr.default.createElement("input",{type:"checkbox",checked:n,onChange:c=>i(c.target.checked)}),Sr.default.createElement("span",{className:"checkmark"}),Sr.default.createElement("span",{className:"telemetry-label"},Sr.default.createElement("strong",null,"Share anonymous usage data"),Sr.default.createElement("small",null,"Collects anonymous feature usage plus app load times & error counts. Never personal data, trades, or file paths."))))),Sr.default.createElement("div",{className:"completion-actions"},Sr.default.createElement(be,{onClick:o,variant:"primary",size:"large",className:"start-journaling-button",autoFocus:!0},"\u{1F680} Start Your Trading Journal"),Sr.default.createElement("div",{className:"completion-links"},l.map((c,d)=>Sr.default.createElement("a",{key:d,href:c.href,className:"completion-link"},c.text)))))}});var bG=it(()=>{dG();uG();fG();gG();hG();vG();yG()});var Pe,zf,wG,xG=it(()=>{Pe=$(W()),zf=require("obsidian");Ci();bd();cG();Ow();Jr();wE();bG();wG=({onComplete:e,onSkip:t,initialStep:r="welcome",selectedGoal:n,plugin:i,onboardingService:o})=>{let[a,s]=(0,Pe.useState)(r),[l,c]=(0,Pe.useState)(n),[d,u]=(0,Pe.useState)({instruments:[],frequency:"weekly",challenge:"emotional-control"}),[p,m]=(0,Pe.useState)(!1),[g,f]=(0,Pe.useState)(null),[y,h]=(0,Pe.useState)(""),[v,b]=(0,Pe.useState)(!1),[w,k]=(0,Pe.useState)(null),[S,x]=(0,Pe.useState)(!1),[T,E]=(0,Pe.useState)(null),[C,N]=(0,Pe.useState)(!1),[D,A]=(0,Pe.useState)(!1),P=Et.findIndex(ne=>ne.id===a),I=Et[P];(0,Pe.useEffect)(()=>{Sw()},[]),(0,Pe.useEffect)(()=>{let ne=i.authManager;ne&&ne.isAuthenticated()&&x(!0)},[i]),(0,Pe.useEffect)(()=>{(async()=>{var te,oe,de,xe;try{let je=await((te=i.serviceManager)==null?void 0:te.getBackendIntegrationService());if(!je)return;let nt=(oe=i.settings.backendIntegration)==null?void 0:oe.ftpUsername;if(nt){let Qe=await je.getFTPCredentials(nt);if(Qe){let ze=(de=i.settings.backendIntegration)==null?void 0:de.ftpPassword;ze&&!Qe.password&&(Qe.password=ze),E({username:Qe.username,password:Qe.password||"",host:Qe.server,port:Qe.port}),N(!0)}}}catch(je){(xe=je.message)!=null&&xe.includes("404")||console.error("Failed to check existing FTP credentials:",je)}})()},[i]),(0,Pe.useEffect)(()=>{let ne=async()=>{var oe;let te=await((oe=i.serviceManager)==null?void 0:oe.getTelemetryService());if(te)try{await te.track("onboarding_step_completed",{step:a,stepIndex:P,goal:l})}catch(de){console.error("Failed to track step change:",de)}};P>0&&ne()},[a,P,l,i]);let M=Et.filter(ne=>!ne.shouldShow||ne.shouldShow(l)).length,O=P>0,F=P<Et.length-1,L=(I==null?void 0:I.isOptional)||a!=="completion",B=(0,Pe.useCallback)(()=>{L&&(h('Onboarding cancelled. You can replay onboarding later from the Command Palette by searching for "Journalit: Replay Onboarding".'),setTimeout(()=>{h("")},100),t())},[L,t]);(0,Pe.useEffect)(()=>{let ne=te=>{te.key==="Escape"&&L&&B()};return document.addEventListener("keydown",ne),()=>document.removeEventListener("keydown",ne)},[L,B]),(0,Pe.useEffect)(()=>{let ne=setTimeout(()=>{let te=document.querySelector(".onboarding-wizard-modal");if(te){let oe=te.querySelector('button:not([disabled]), [href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([tabindex="-1"])');oe&&oe.focus()}},100);return()=>clearTimeout(ne)},[a]);let j=(0,Pe.useCallback)(async()=>{if(!(!F||p)){m(!0),f(null);try{let ne=P+1;for(;ne<Et.length;){let te=Et[ne];if(!te.shouldShow||te.shouldShow(l))break;ne++}ne<Et.length&&s(Et[ne].id)}catch(ne){f(ne instanceof Error?ne.message:"Failed to go to next step")}finally{m(!1)}}},[P,F,l,p]),_=(0,Pe.useCallback)(async()=>{if(!(!O||p)){m(!0),f(null);try{let ne=P-1;for(;ne>=0;){let te=Et[ne];if(!te.shouldShow||te.shouldShow(l))break;ne--}ne>=0&&s(Et[ne].id)}catch(ne){f(ne instanceof Error?ne.message:"Failed to go to previous step")}finally{m(!1)}}},[P,O,l,p]),H=(0,Pe.useCallback)(async()=>{var oe;let ne={version:1,completed:!0,completedAt:Date.now(),selectedGoal:l,userSegmentation:d,currentStep:"completion",checklist:{},telemetryOptIn:D,sampleTradeCreated:v,isAuthenticated:S,ftpCredentialsGenerated:C};if(o)try{await o.completeOnboarding()}catch(de){console.error("Failed to complete onboarding in service:",de)}let te=await((oe=i.serviceManager)==null?void 0:oe.getTelemetryService());if(te)try{D?(await te.enableTelemetry(),console.log("Telemetry enabled - events will be sent"),await te.track("onboarding_completed",{goal:l,telemetryOptIn:D,sampleTradeCreated:v,isAuthenticated:S,ftpCredentialsGenerated:C,completionTime:Date.now()})):(await te.disableTelemetry(),console.log("Telemetry disabled - no events will be sent"),await te.trackBusinessMetric("onboarding_completed",{goal:l,telemetryOptIn:D,sampleTradeCreated:v,isAuthenticated:S,ftpCredentialsGenerated:C,completionTime:Date.now()}))}catch(de){console.error("Failed to handle telemetry opt-in decision:",de)}e(ne)},[l,D,v,S,C,e,i,o]),q=(0,Pe.useCallback)(()=>{if(!L)return;let ne=P+1;for(;ne<Et.length;){let te=Et[ne];if(!te.shouldShow||te.shouldShow(l))break;ne++}ne<Et.length?s(Et[ne].id):H()},[L,P,l,H]),X=(0,Pe.useCallback)(async ne=>{var oe;if(c(ne),o)try{await o.setGoal(ne)}catch(de){console.error("Failed to update OnboardingService goal:",de)}let te=await((oe=i.serviceManager)==null?void 0:oe.getTelemetryService());if(te)try{await te.track("onboarding_goal_selected",{goal:ne,step:a})}catch(de){console.error("Failed to track goal selection:",de)}},[i,a,o]),U=(0,Pe.useCallback)(async()=>{var ne,te,oe,de;if(!v){m(!0),f(null);try{let xe=(ne=i.serviceManager)==null?void 0:ne.getTradeService();if(!xe)throw new Error("TradeService not available");let je=await((te=i.serviceManager)==null?void 0:te.getAccountService());if(!je)throw new Error("AccountService not available");await je.getAccountByName("Demo Account")||await je.createAccount({name:"Demo Account",accountType:"demo",initialBalance:1e4,currency:"USD"});let Qe=new Date,ze,Rr,nr;switch(d.frequency==="daily"?(ze=new Date(Qe.getTime()-3*60*60*1e3),Rr=new Date(Qe.getTime()-2.5*60*60*1e3)):d.frequency==="weekly"?(ze=new Date(Qe.getTime()-3*24*60*60*1e3),Rr=new Date(Qe.getTime()-1*24*60*60*1e3)):(ze=new Date(Qe.getTime()-7*24*60*60*1e3),Rr=new Date(Qe.getTime()-2*24*60*60*1e3)),d.instruments[0]||"stocks"){case"forex":nr={entryTime:ze,exitTime:Rr,entryPrice:1.085,exitPrice:1.092,positionSize:1e4,direction:"long",setupIds:[],mistakeIds:[],accountIds:[],account:["Demo Account"],instrument:"EURUSD",assetType:"forex",tags:["journalit-demo","sample-trade","forex"],thesis:`Sample EURUSD trade demonstrating ${d.frequency} trading. Entry based on support level bounce with 70-pip profit target. This exemplifies the systematic approach Journalit helps you track.`};break;case"crypto":nr={entryTime:ze,exitTime:Rr,entryPrice:42500,exitPrice:44200,positionSize:.1,direction:"long",setupIds:[],mistakeIds:[],accountIds:[],account:["Demo Account"],instrument:"BTC/USD",assetType:"crypto",tags:["journalit-demo","sample-trade","crypto"],thesis:`Sample Bitcoin trade showing ${d.frequency} strategy. Breakout above resistance with $1,700 profit. Track crypto volatility patterns with Journalit's analysis tools.`};break;case"options":nr={entryTime:ze,exitTime:Rr,entryPrice:2.5,exitPrice:4.1,positionSize:5,direction:"long",setupIds:[],mistakeIds:[],accountIds:[],account:["Demo Account"],instrument:"AAPL Call 150 30DTE",assetType:"options",tags:["journalit-demo","sample-trade","options"],thesis:`Sample options trade for ${d.frequency} traders. 64% profit on AAPL calls before earnings. Journalit tracks Greeks, IV, and time decay for complete options analysis.`};break;default:nr={entryTime:ze,exitTime:Rr,entryPrice:150.5,exitPrice:156.75,positionSize:100,direction:"long",setupIds:[],mistakeIds:[],accountIds:[],account:["Demo Account"],instrument:"AAPL",assetType:"stock",tags:["journalit-demo","sample-trade","stocks"],thesis:`Sample stock trade tailored for ${d.frequency} trading. Strong earnings beat with institutional buying. Demonstrates how Journalit captures both technical and fundamental analysis.`}}let sn=await xe.createTrade(nr);k(sn),b(!0);let Zs=await((oe=i.serviceManager)==null?void 0:oe.getTelemetryService());if(Zs)try{await Zs.track("onboarding_sample_trade_created",{goal:l,filePath:sn})}catch(ys){console.error("Failed to track sample trade creation:",ys)}new zf.Notice("\u{1F389} Sample trade created successfully! You can find it in your vault.")}catch(xe){console.error("Error creating sample trade:",xe),f(xe instanceof Error?xe.message:"Failed to create sample trade");let je=await((de=i.serviceManager)==null?void 0:de.getTelemetryService());if(je)try{await je.track("onboarding_error",{step:a,errorCode:"sample_trade_creation_failed",errorMessage:xe instanceof Error?xe.message:"Unknown error"})}catch(nt){console.error("Failed to track onboarding error:",nt)}}finally{m(!1)}}},[i,v,d,l,a]),Y=(0,Pe.useCallback)(async(ne,te)=>{var oe;try{x(!0);let de=i.authManager;de&&await de.handleBetaAuth(ne,te),new zf.Notice("Successfully authenticated! You can now access premium features.")}catch(de){console.error("Error handling auth success:",de),f(de instanceof Error?de.message:"Failed to complete authentication");let xe=await((oe=i.serviceManager)==null?void 0:oe.getTelemetryService());if(xe)try{await xe.track("onboarding_error",{step:"authentication",errorCode:"auth_handling_failed",errorMessage:de instanceof Error?de.message:"Unknown error"})}catch(je){console.error("Failed to track onboarding error:",je)}}},[i]),R=(0,Pe.useCallback)(()=>{f(null)},[]),V=(0,Pe.useCallback)(async()=>{var ne,te,oe,de,xe,je,nt,Qe,ze,Rr,nr;if(!C){m(!0),f(null);try{let ft=await((ne=i.serviceManager)==null?void 0:ne.getBackendIntegrationService());if(!ft)throw new Error("Backend integration service not available");if(!i.authManager.isAuthenticated())throw new Error("Please sign in to generate FTP credentials");let sn=await ft.createOrGetFTPUser();if(!sn)throw new Error("Failed to generate FTP credentials");i.settings.backendIntegration={...i.settings.backendIntegration,syncEnabled:(oe=(te=i.settings.backendIntegration)==null?void 0:te.syncEnabled)!=null?oe:!0,userId:(xe=(de=i.settings.backendIntegration)==null?void 0:de.userId)!=null?xe:"cursive",showSyncNotifications:(nt=(je=i.settings.backendIntegration)==null?void 0:je.showSyncNotifications)!=null?nt:!0,showNewTradeNotifications:(ze=(Qe=i.settings.backendIntegration)==null?void 0:Qe.showNewTradeNotifications)!=null?ze:!0,ftpUsername:sn.username,ftpPassword:sn.password},await i.saveSettings(),await ft.updateSettings({ftpUsername:sn.username,ftpPassword:sn.password}),E({username:sn.username,password:sn.password||"",host:sn.server,port:sn.port}),N(!0);let Zs=await((Rr=i.serviceManager)==null?void 0:Rr.getTelemetryService());if(Zs)try{await Zs.track("onboarding_ftp_credentials_generated",{goal:l,host:sn.server,port:sn.port})}catch(ys){console.error("Failed to track FTP credentials generation:",ys)}new zf.Notice("\u2705 FTP credentials generated successfully!")}catch(ft){console.error("Error generating FTP credentials:",ft),f(ft instanceof Error?ft.message:"Failed to generate FTP credentials");let sn=await((nr=i.serviceManager)==null?void 0:nr.getTelemetryService());if(sn)try{await sn.track("onboarding_error",{step:a,errorCode:"ftp_credentials_generation_failed",errorMessage:ft instanceof Error?ft.message:"Unknown error"})}catch(Zs){console.error("Failed to track onboarding error:",Zs)}}finally{m(!1)}}},[C,l,a,i]),G=(0,Pe.useCallback)(async(ne,te)=>{try{await navigator.clipboard.writeText(ne),new zf.Notice(`${te} copied to clipboard!`)}catch(oe){console.error("Failed to copy to clipboard:",oe),new zf.Notice(`Failed to copy ${te.toLowerCase()}`)}},[]),J=()=>{switch(a){case"welcome":return Pe.default.createElement(kI,null);case"goal":return Pe.default.createElement(TI,{selectedGoal:l,onGoalSelect:X});case"segmentation":return Pe.default.createElement(CI,{userSegmentation:d,onSegmentationChange:u});case"first-action":return Pe.default.createElement(EI,{goal:l,userSegmentation:d,sampleTradeCreated:v,sampleTradeFilePath:w,isLoading:p,onCreateSampleTrade:U});case"authentication":return Pe.default.createElement(DI,{isAuthenticated:S,onAuthSuccess:Y,onAuthCancel:R});case"ftp-credentials":return Pe.default.createElement(PI,{ftpCredentialsGenerated:C,ftpCredentials:T,isLoading:p,onGenerateFtpCredentials:V,onCopyToClipboard:G});case"completion":return Pe.default.createElement(AI,{sampleTradeCreated:v,isAuthenticated:S,ftpCredentialsGenerated:C,telemetryOptIn:D,onTelemetryOptInChange:A,onComplete:H});default:return Pe.default.createElement("div",{className:"onboarding-slide error-slide"},Pe.default.createElement("h2",null,"Unknown step"),Pe.default.createElement("p",null,"We encountered an unexpected step in the onboarding process."))}},K=Et.filter(ne=>!ne.shouldShow||ne.shouldShow(l)).map(ne=>ne.title);return Pe.default.createElement("div",{className:"onboarding-wizard-modal"},Pe.default.createElement("div",{"aria-live":"assertive","aria-atomic":"true",className:"sr-only"},y),Pe.default.createElement("div",{className:"modal-header"},Pe.default.createElement(lG,{currentStep:P+1,totalSteps:M,stepLabels:K})),Pe.default.createElement("div",{className:"modal-content"},J()),g&&Pe.default.createElement("div",{className:"modal-error"},g),a!=="completion"&&Pe.default.createElement("div",{className:"modal-actions"},O&&Pe.default.createElement(be,{onClick:_,disabled:p,variant:"secondary"},"Back"),F&&Pe.default.createElement(be,{onClick:j,disabled:p||a==="goal"&&!l||a==="segmentation"&&d.instruments.length===0,variant:"primary"},Pe.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"center"}},p&&Pe.default.createElement(Or,{size:"small",message:""}),"Next"))),Pe.default.createElement("div",{className:"modal-footer"},Pe.default.createElement("p",{className:"modal-footer-text"},(I==null?void 0:I.description)||"Complete the setup to get started with Journalit")),L&&Pe.default.createElement("button",{className:"skip-link",onClick:q,disabled:p,"aria-label":"Skip this step",type:"button"},"Skip this step"))}});var sT={};xs(sT,{OnboardingWizardModalWrapper:()=>NI});var kG,SG,NI,lT=it(()=>{kG=$(W()),SG=require("obsidian");xG();tE();NI=class extends SG.Modal{constructor(t,r,n,i,o,a,s){super(t),this.plugin=r,this.onComplete=n,this.onSkip=i,this.initialStep=o,this.selectedGoal=a,this.onboardingService=s}async onOpen(){let{contentEl:t}=this;t.empty(),ZC();let r=t.createDiv(),{createRoot:n}=Ps();n(r).render(kG.default.createElement(wG,{plugin:this.plugin,onboardingService:this.onboardingService,onComplete:o=>{this.onComplete(o),super.close()},onSkip:()=>{this.onSkip(),super.close()},initialStep:this.initialStep,selectedGoal:this.selectedGoal})),(async()=>{var o;try{let a=await((o=this.plugin.serviceManager)==null?void 0:o.getTelemetryService());a&&(a.isEnabled()||(await a.enableTelemetry(),console.log("Temporarily enabled telemetry for onboarding tracking")),a.track("onboarding_started",{initialStep:this.initialStep,pluginVersion:this.plugin.manifest.version}).catch(l=>console.error("Failed to track onboarding start:",l)))}catch(a){console.error("Failed to setup onboarding telemetry:",a)}})(),setTimeout(()=>{let o=t.querySelector(".onboarding-wizard-modal");o&&(o.setAttribute("tabindex","-1"),o.focus())},100)}onClose(){let{contentEl:t}=this;t.empty(),eE()}}});var TG={};xs(TG,{MigrationService:()=>MI});var MI,CG=it(()=>{oi();Yt();MI=class{constructor(t,r){this.app=t,this.plugin=r}async runMigration(t){let r={tradesConverted:0,missedTradesProcessed:0,imagesResolved:0,errors:[]};try{console.log("[Migration] Starting migration process...");let n=await this.findOldFormatNotes();if(console.log(`[Migration] Found ${n.length} old format notes to migrate`),n.length===0)return console.log("[Migration] No old format notes found. Migration completed."),r;let i=n.filter(a=>a.frontmatter.type==="trades"),o=n.filter(a=>a.frontmatter.type==="missed-trades");console.log(`[Migration] Trade notes: ${i.length}, Missed trade notes: ${o.length}`);try{await this.plugin.serviceManager.getTradeService(),await this.plugin.serviceManager.getMissedTradeService()}catch(a){throw new Error(`Required services not available: ${a.message}`)}console.log("[Migration] Starting trade notes migration...");for(let[a,s]of i.entries())try{console.log(`[Migration] Processing trade note ${a+1}/${i.length}: ${s.file.path}`);let l=await this.migrateTradeNote(s,t);r.tradesConverted++,r.imagesResolved+=l,console.log(`[Migration] Successfully migrated trade note: ${s.file.path}`)}catch(l){let c=`Error migrating trade note ${s.file.path}: ${l.message}`;r.errors.push(c),console.error(`[Migration] ${c}`,l)}console.log("[Migration] Starting missed trades migration...");for(let[a,s]of o.entries())try{console.log(`[Migration] Processing missed trade ${a+1}/${o.length}: ${s.file.path}`);let l=await this.migrateMissedTradeToTradeNote(s,t);r.missedTradesProcessed++,r.imagesResolved+=l,console.log(`[Migration] Successfully migrated missed trade: ${s.file.path}`)}catch(l){let c=`Error migrating missed trade ${s.file.path}: ${l.message}`;r.errors.push(c),console.error(`[Migration] ${c}`,l)}return console.log("[Migration] Migration completed successfully:",r),r}catch(n){throw console.error("[Migration] Migration failed:",n),n}}async findOldFormatNotes(){var n;let t=[],r=this.app.vault.getMarkdownFiles();for(let i of r)try{let o=(n=this.app.metadataCache.getFileCache(i))==null?void 0:n.frontmatter;if(o&&(o.type==="trades"||o.type==="missed-trades")){let a=await this.app.vault.read(i);t.push({file:i,frontmatter:o,content:a})}}catch(o){console.warn(`Error reading file ${i.path}:`,o)}return t}async migrateTradeNote(t,r){let{file:n,frontmatter:i,content:o}=t,a=this.extractContentBelowFrontmatter(o),{tradeData:s,imagesResolved:l}=await this.mapOldTradeToNewFormat(i,a,r),d=await(await this.plugin.serviceManager.getTradeService()).createTrade(s,{suppressAutoOpen:!0});return console.log(`[Migration] Created new trade: ${d}`),await this.app.vault.delete(n),console.log(`[Migration] Deleted old trade file: ${n.path}`),l}async migrateMissedTradeToTradeNote(t,r){let{file:n,frontmatter:i,content:o}=t,a=this.extractContentBelowFrontmatter(o),{missedTradeData:s,imagesResolved:l}=await this.mapMissedTradeToNewFormat(i,a,r),d=await(await this.plugin.serviceManager.getMissedTradeService()).createMissedTrade(s,{suppressAutoOpen:!0});return console.log(`[Migration] Created new missed trade note: ${d}`),await this.app.vault.delete(n),console.log(`[Migration] Deleted old missed trade file: ${n.path}`),l}extractCustomFrontmatter(t){let r=new Set(["type","date","entry-time","exit-time","entryTime","exitTime","entryPrice","exitPrice","positionSize","direction","instrument","setup","account","images","notes","useDirectPnLInput","directPnL","assetType","exchange","mistake","reviewed","lossReview","tags","ctags","isMissedTrade","missedReason","Asset","Direction","money","image"]),n={};for(let[i,o]of Object.entries(t))r.has(i)||(n[i]=o);return n}async mapOldTradeToNewFormat(t,r,n){let i=this.parseDateTime(t.date,t["entry-time"]),o=new Date(i.getTime()+60*60*1e3),a=this.parseMoneyField(t.money),{resolvedImages:s,imagesResolved:l}=await this.resolveImagePaths(t.image?[t.image]:[],i),c=this.extractCustomFrontmatter(t);return{tradeData:{entryTime:i,exitTime:o,entryPrice:0,exitPrice:0,positionSize:0,direction:t.Direction||"Unknown",instrument:t.Asset||"Unknown",setup:void 0,account:n,images:s,notes:r,useDirectPnLInput:!0,directPnL:a,...c},imagesResolved:l}}async mapMissedTradeToNewFormat(t,r,n){let i=this.parseDateTime(t.date,t["entry-time"]),o=new Date(i.getTime()+60*60*1e3),{resolvedImages:a,imagesResolved:s}=await this.resolveImagePaths(t.image?[t.image]:[],i),l=this.extractCustomFrontmatter(t);return{missedTradeData:{entryTime:i,exitTime:o,entryPrice:0,exitPrice:0,positionSize:0,direction:t.Direction||"Unknown",instrument:t.Asset||"Unknown",setup:void 0,account:void 0,images:a,notes:r,useDirectPnLInput:!0,directPnL:0,isMissedTrade:!0,missedReason:"",...l},imagesResolved:s}}parseDateWithUserFormat(t){if(!t)return null;let r=fr(),i=t.trim().replace(/[-\s]/g,"/").split("/");if(i.length!==3)return console.warn(`[Migration] Invalid date format: ${t}, expected format: ${r}`),null;let o,a,s;try{switch(r){case"DDMMYY":o=parseInt(i[0],10),a=parseInt(i[1],10),s=parseInt(i[2],10);break;case"MMDDYY":a=parseInt(i[0],10),o=parseInt(i[1],10),s=parseInt(i[2],10);break;case"YYMMDD":s=parseInt(i[0],10),a=parseInt(i[1],10),o=parseInt(i[2],10);break;default:o=parseInt(i[0],10),a=parseInt(i[1],10),s=parseInt(i[2],10);break}if(s<100&&(s+=s<30?2e3:1900),a<1||a>12)return console.warn(`[Migration] Invalid month: ${a} in date: ${t}`),null;if(o<1||o>31)return console.warn(`[Migration] Invalid day: ${o} in date: ${t}`),null;let l=new Date(s,a-1,o);return l.getFullYear()!==s||l.getMonth()!==a-1||l.getDate()!==o?(console.warn(`[Migration] Invalid date created: ${t} -> ${l.toISOString()}`),null):l}catch(l){return console.warn(`[Migration] Error parsing date ${t} with format ${r}:`,l),null}}parseDateTime(t,r){if(!t)throw new Error("Date is required");let n=this.parseDateWithUserFormat(t);if(!n&&(console.warn(`[Migration] User format parsing failed for ${t}, trying fallback method`),n=V_(t),isNaN(n.getTime())))throw new Error(`Invalid date: ${t}`);if(r){let i=r.split(":");if(i.length===2){let o=parseInt(i[0],10),a=parseInt(i[1],10);!isNaN(o)&&!isNaN(a)&&n.setHours(o,a,0,0)}}return n}parseMoneyField(t){if(typeof t=="number")return t;if(typeof t=="string"){let r=t.replace(/['"$£€¥]/g,"").replace(/[,\s]/g,"").replace(/[^\d.-]/g,""),n=parseFloat(r);return isNaN(n)?0:n}return 0}extractContentBelowFrontmatter(t){let r=t.split(`
`),n=!1,i=-1;for(let o=0;o<r.length;o++)if(r[o].trim()==="---"){if(o===0)continue;n=!0,i=o;break}return n&&i>-1?r.slice(i+1).join(`
`).trim():t}async resolveImagePaths(t,r){let n=[],i=0;for(let o of t)try{let a=o.match(/!\[\[([^\]]+)\]\]/);if(!a){console.warn(`[Migration] Invalid image format: ${o}, skipping`);continue}let s=a[1],l=this.app.vault.getFiles().filter(c=>c.name===s||c.path.endsWith(`/${s}`));if(l.length===1){let c=l[0];n.push(c.path),i++,console.log(`[Migration] Resolved image: ${o} \u2192 ${c.path}`)}else if(l.length===0)console.warn(`[Migration] Image file not found: ${s}, skipping image`);else{let c=l[0];n.push(c.path),i++,console.warn(`[Migration] Multiple matches for ${s}, using first match: ${c.path}`),console.warn(`[Migration] Other matches ignored: ${l.slice(1).map(d=>d.path).join(", ")}`)}}catch(a){console.error(`[Migration] Error resolving image ${o}:`,a)}return{resolvedImages:n,imagesResolved:i}}}});var EG={};xs(EG,{MigrationModal:()=>OI});var cT,OI,DG=it(()=>{cT=require("obsidian"),OI=class extends cT.Modal{constructor(r,n){super(r);this.migrationCode="";this.selectedAccounts=[];this.availableAccounts=[];this.plugin=n}async onOpen(){let{contentEl:r}=this;if(r.empty(),this.addStyles(),await this.loadAvailableAccounts(),r.createEl("h2",{text:"Trade Notes Migration"}),this.availableAccounts.length===0){r.createEl("p",{text:"No accounts found. Please create at least one account before migrating.",cls:"error-message"}),r.createEl("p",{text:"To proceed with migration, please first create an account in the plugin settings under the Accounts tab."}),r.createDiv({cls:"modal-button-container"}).createEl("button",{text:"Close",cls:"migration-cancel-button"}).addEventListener("click",()=>{this.close()});return}let n=r.createDiv({cls:"migration-warning"});n.createEl("h3",{text:"\u26A0\uFE0F Important Warning",cls:"warning-title"});let i=n.createEl("div",{cls:"warning-content"});i.createEl("p",{text:"This migration process is IRREVERSIBLE and will permanently modify your notes."}),i.createEl("p",{text:"Please ensure you have created a backup of your vault before proceeding."});let o=i.createEl("ul");o.createEl("li",{text:"Old trade notes (type: trades) will be converted to new trade format and linked to selected accounts"}),o.createEl("li",{text:"Missed trades (type: missed-trades) will be converted to proper missed trade notes with M prefix (NOT linked to accounts)"}),o.createEl("li",{text:"Original frontmatter fields will be preserved for data tracking"}),o.createEl("li",{text:"Image paths will be converted to proper file paths"}),o.createEl("li",{text:"Original file structure will be changed"}),r.createEl("h3",{text:"Account Selection"}),r.createEl("p",{text:"Select which account(s) to link the migrated REGULAR trades to (missed trades will NOT be linked):"});let a=r.createDiv({cls:"accounts-selection"});this.availableAccounts.forEach(p=>{let m=a.createDiv({cls:"account-row"}),g=m.createEl("input",{type:"checkbox",value:p});g.addEventListener("change",()=>{g.checked?this.selectedAccounts.includes(p)||this.selectedAccounts.push(p):this.selectedAccounts=this.selectedAccounts.filter(f=>f!==p)}),m.createEl("label",{text:p})}),r.createEl("h3",{text:"Migration Code Required"}),r.createEl("p",{text:"Enter the migration code provided by your administrator:"}),new cT.Setting(r).setName("Migration Code").setDesc("This code is required to prevent accidental migrations").addText(p=>{p.setPlaceholder("Enter migration code..."),p.onChange(m=>{this.migrationCode=m}),p.inputEl.addEventListener("keypress",m=>{m.key==="Enter"&&this.validateAndMigrate()})});let s=r.createDiv({cls:"migration-summary"});s.createEl("h3",{text:"What will happen:"});let l=s.createEl("ol");l.createEl("li",{text:"Scan vault for old format trade notes"}),l.createEl("li",{text:"Convert trade notes to new format with proper file paths"}),l.createEl("li",{text:"Convert missed trades to proper missed trade notes with M prefix"}),l.createEl("li",{text:"Resolve image paths from ![[image]] format to actual file paths"}),l.createEl("li",{text:"Link regular trades (not missed trades) to selected account(s)"}),l.createEl("li",{text:"Preserve original frontmatter fields and content"});let c=r.createDiv({cls:"modal-button-container"});c.createEl("button",{text:"Start Migration",cls:"mod-cta migration-button"}).addEventListener("click",()=>{this.validateAndMigrate()}),c.createEl("button",{text:"Cancel",cls:"migration-cancel-button"}).addEventListener("click",()=>{this.close()})}async validateAndMigrate(){if(!this.migrationCode){this.showError("Please enter a migration code");return}if(this.migrationCode.toLowerCase()!=="benedict"){this.showError("Invalid migration code. Please contact your administrator.");return}if(this.selectedAccounts.length===0){this.showError("Please select at least one account to link the migrated trades to.");return}try{let{MigrationService:r}=await Promise.resolve().then(()=>(CG(),TG)),n=new r(this.app,this.plugin);this.showProgress("Starting migration...");let i=await n.runMigration(this.selectedAccounts);this.showSuccess(i)}catch(r){console.error("Migration failed:",r),this.showError(`Migration failed: ${r.message}`)}}showError(r){let n=this.contentEl.querySelector(".migration-error");n&&n.remove(),this.contentEl.createDiv({cls:"migration-error"}).createEl("p",{text:r,cls:"error-message"})}showProgress(r){let n=this.contentEl.querySelector(".migration-progress");n&&n.remove(),this.contentEl.createDiv({cls:"migration-progress"}).createEl("p",{text:r,cls:"progress-message"})}showSuccess(r){this.contentEl.empty();let n=this.contentEl.createDiv({cls:"migration-success"});n.createEl("h2",{text:"\u2705 Migration Completed Successfully!"});let i=n.createEl("div",{cls:"migration-stats"});if(i.createEl("p",{text:`Converted ${r.tradesConverted} trade notes`}),i.createEl("p",{text:`Converted ${r.missedTradesProcessed} missed trades to trade notes`}),i.createEl("p",{text:`Resolved ${r.imagesResolved||0} image paths`}),r.errors.length>0){let a=n.createDiv({cls:"migration-errors"});a.createEl("h3",{text:"Errors encountered:"});let s=a.createEl("ul");r.errors.forEach(l=>{s.createEl("li",{text:l})})}n.createEl("button",{text:"Close",cls:"mod-cta"}).addEventListener("click",()=>{this.close()})}async loadAvailableAccounts(){try{if(this.plugin.accountService){let r=await this.plugin.accountService.getAllAccounts();this.availableAccounts=r.map(n=>n.name)}}catch(r){console.error("Error loading accounts:",r),this.availableAccounts=[]}}addStyles(){let r=document.createElement("style");r.textContent=`
      .migration-warning {
        background-color: var(--background-modifier-error);
        border: 1px solid var(--background-modifier-error-border);
        padding: 12px 15px;
        margin: 15px 0;
        border-radius: 5px;
      }
      
      .warning-title {
        color: var(--text-normal);
        margin: 0 0 8px 0;
        font-weight: bold;
        font-size: 1.1em;
      }
      
      .warning-content {
        color: var(--text-normal);
      }
      
      .warning-content p {
        margin: 6px 0;
        color: var(--text-normal);
        font-weight: 500;
        line-height: 1.4;
      }
      
      .warning-content ul {
        margin: 8px 0;
        padding-left: 20px;
      }
      
      .warning-content li {
        margin: 4px 0;
        color: var(--text-normal);
        font-weight: 500;
      }
      
      .migration-summary {
        margin: 20px 0;
        padding: 10px;
        background-color: var(--background-secondary);
        border-radius: 5px;
      }
      
      .migration-error {
        background-color: var(--background-modifier-error);
        border: 1px solid var(--background-modifier-error-border);
        padding: 10px;
        margin: 10px 0;
        border-radius: 5px;
      }
      
      .error-message {
        color: var(--text-normal);
        margin: 0;
        font-weight: 500;
      }
      
      .migration-progress {
        background-color: var(--background-modifier-success);
        border: 1px solid var(--background-modifier-success-border);
        padding: 10px;
        margin: 10px 0;
        border-radius: 5px;
      }
      
      .progress-message {
        color: var(--text-success);
        margin: 0;
      }
      
      .migration-success {
        text-align: center;
        padding: 20px;
      }
      
      .migration-stats {
        margin: 20px 0;
        padding: 15px;
        background-color: var(--background-secondary);
        border-radius: 5px;
      }
      
      .migration-errors {
        margin: 20px 0;
        padding: 15px;
        background-color: var(--background-modifier-error);
        border-radius: 5px;
      }
      
      .modal-button-container {
        display: flex;
        gap: 10px;
        justify-content: flex-end;
        margin-top: 20px;
      }
      
      .migration-button {
        background-color: var(--interactive-accent);
        color: var(--text-on-accent);
      }
      
      .migration-cancel-button {
        background-color: var(--interactive-normal);
        color: var(--text-normal);
      }
      
      .accounts-selection {
        max-height: 200px;
        overflow-y: auto;
        border: 1px solid var(--background-modifier-border);
        border-radius: 5px;
        padding: 10px;
        margin: 10px 0;
        background-color: var(--background-secondary);
      }
      
      .account-row {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 5px 0;
      }
      
      .account-row input[type="checkbox"] {
        margin: 0;
      }
      
      .account-row label {
        margin: 0;
        cursor: pointer;
      }
    `,document.head.appendChild(r)}onClose(){let{contentEl:r}=this;r.empty()}}});var rge={};xs(rge,{default:()=>dT});module.exports=mT(rge);var ct=require("obsidian");var f_=require("obsidian"),Ai=$(W()),g_=$(Ps());var Le=$(W()),gc=require("obsidian");Ci();var v2=$(W()),jb=({ariaLabel:e,className:t="",children:r,...n})=>{let o=["journalit-icon-button",t].filter(Boolean).join(" ");return v2.default.createElement("button",{className:o,"aria-label":e,type:"button","data-tooltip":e,...n},r)};var y2=$(W()),Gi=({label:e,className:t="",children:r,...n})=>{let o=["journalit-no-tooltip-button",t].filter(Boolean).join(" ");return y2.default.createElement("button",{className:o,"data-label":e,"aria-label":e,type:"button",...n},r)};var _g=$(W());var nK=({checked:e,onChange:t,id:r,ariaLabel:n="Toggle switch",disabled:i=!1})=>{let o=s=>{i||t(s.target.checked)},a=r||`toggle-${Math.random().toString(36).substring(2,9)}`;return _g.default.createElement("div",{className:`toggle-switch-container ${i?"disabled":""}`},_g.default.createElement("input",{type:"checkbox",id:a,className:"toggle-switch-input",checked:e,onChange:o,"aria-label":n,disabled:i}),_g.default.createElement("label",{htmlFor:a,className:"toggle-switch-label"},_g.default.createElement("span",{className:"toggle-switch-button"})))},Ei=nK;var ia=$(W());var pl={select:"r",placeholder:"b",selectContainer:"g",label:"u",selectWrapper:"e",sm:"x",md:"f",lg:"h",error:"d",errorMessage:"v",helperText:"w"};var oa=ia.default.forwardRef(({className:e="",id:t,label:r,options:n=[],error:i,helperText:o,disabled:a=!1,size:s="md",placeholder:l="Select an option",onChange:c,...d},u)=>{let p=(0,ia.useId)(),m=t||`select-${p}`,g=`helper-${m}`,f=`error-${m}`,y=[pl.select,pl[s],i?pl.error:"",e,"select",s,i?"error":"","obsidian-select"].filter(Boolean).join(" "),h=v=>{c&&c(v.target.value),v.target&&v.target.setAttribute("data-has-value",v.target.value?"true":"false")};return ia.default.createElement("div",{className:`${pl.selectContainer} selectContainer`},r&&ia.default.createElement("label",{htmlFor:m,className:`${pl.label} label`},r),ia.default.createElement("div",{className:`${pl.selectWrapper} selectWrapper`},ia.default.createElement("select",{ref:u,id:m,className:y,disabled:a,"data-has-value":d.value||d.defaultValue?"true":"false","aria-invalid":!!i,"aria-describedby":i?f:o?g:void 0,onChange:h,style:{color:d.value?"var(--text-normal)":"var(--text-muted)",opacity:d.value?1:.7},...d},!d.value&&!d.defaultValue&&ia.default.createElement("option",{value:"",disabled:!0,className:"select-placeholder",style:{color:"var(--text-muted)",opacity:.9,padding:"8px",fontSize:"14px",lineHeight:"normal",height:"auto"}},l),n.map(v=>ia.default.createElement("option",{key:v.value,value:v.value,style:{color:"var(--text-normal)",opacity:1}},v.label)))),i&&ia.default.createElement("div",{id:f,className:`${pl.errorMessage} errorMessage`,role:"alert"},i),!i&&o&&ia.default.createElement("div",{id:g,className:`${pl.helperText} helperText`},o))});oa.displayName="Select";var As=$(W()),ar=({title:e,defaultExpanded:t=!1,children:r})=>{let[n,i]=(0,As.useState)(t),o=()=>{i(!n)};return As.default.createElement("div",{className:"cmdr-accordion cmdr-sep-con","aria-expanded":n},As.default.createElement("div",{className:"cmdr-accordion-header cmdr-mb-1",onClick:o,role:"button",tabIndex:0,onKeyDown:a=>{(a.key==="Enter"||a.key===" ")&&(o(),a.preventDefault())}},As.default.createElement("div",{className:"cmdr-accordion-chevron"},As.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},As.default.createElement("polyline",{points:"6 9 12 15 18 9"}))),As.default.createElement("span",{style:{marginLeft:"8px"}},e)),As.default.createElement("div",{className:"cmdr-accordion-content"},r))};var b2=({plugin:e})=>{var u,p,m,g,f,y;e.settings.general||(e.settings.general={});let[t,r]=(0,Le.useState)(0);(0,Le.useEffect)(()=>{var v;let h=!1;e.settings.trade.skipWeekends===void 0&&(e.settings.trade.skipWeekends=!0,h=!0),e.settings.trade.tradingDayCutoffTime===void 0&&(e.settings.trade.tradingDayCutoffTime="00:00",h=!0),e.settings.drc.autoCreateDRCOnNavigation===void 0&&(e.settings.drc.autoCreateDRCOnNavigation=!0,h=!0),e.settings.weekly.autoCreateWeeklyReviewOnNavigation===void 0&&(e.settings.weekly.autoCreateWeeklyReviewOnNavigation=!0,h=!0),((v=e.settings.monthly)==null?void 0:v.autoCreateMonthlyReviewOnNavigation)===void 0&&(e.settings.monthly?e.settings.monthly.autoCreateMonthlyReviewOnNavigation=!0:e.settings.monthly={reviewQuestions:[],customTimeframes:[],autoCreateOnFirstTrade:!0,autoCreateMonthlyReviewOnNavigation:!0},h=!0),h&&e.saveSettings()},[]);let n=[{value:"DDMMYY",label:"DD/MM/YY (31/12/23)"},{value:"MMDDYY",label:"MM/DD/YY (12/31/23)"},{value:"YYMMDD",label:"YY/MM/DD (23/12/31)"}],i=async h=>{e.settings.trade.autoOpenCreatedTrades=h,await e.saveSettings(),r(v=>v+1),new gc.Notice(`Auto-open created trades ${h?"enabled":"disabled"}`)},o=async h=>{e.settings.trade.dateFormat=h,await e.saveSettings(),new gc.Notice(`Trade note date format changed to ${h}`)},a=async h=>{e.settings.trade.skipWeekends=h,await e.saveSettings(),r(v=>v+1),new gc.Notice(`Skip weekends ${h?"enabled":"disabled"}`)},s=async h=>{let v=h.target.value;e.settings.trade.tradingDayCutoffTime=v,await e.saveSettings(),new gc.Notice(`Trading day cutoff time changed to ${v}`)},l=async h=>{e.settings.drc.autoCreateDRCOnNavigation=h,await e.saveSettings(),r(v=>v+1),new gc.Notice(`Auto-create DRC on navigation ${h?"enabled":"disabled"}`)},c=async h=>{e.settings.weekly.autoCreateWeeklyReviewOnNavigation=h,await e.saveSettings(),r(v=>v+1),new gc.Notice(`Auto-create Weekly Review on navigation ${h?"enabled":"disabled"}`)},d=async h=>{e.settings.monthly?e.settings.monthly.autoCreateMonthlyReviewOnNavigation=h:e.settings.monthly={reviewQuestions:[],customTimeframes:[],autoCreateOnFirstTrade:!0,autoCreateMonthlyReviewOnNavigation:h},await e.saveSettings(),r(v=>v+1),new gc.Notice(`Auto-create Monthly Review on navigation ${h?"enabled":"disabled"}`)};return Le.default.createElement("div",{className:"journalit-settings-tab general-settings"},Le.default.createElement("h3",null,"General Settings"),Le.default.createElement("p",{className:"setting-item-description"},"Configure global settings for the Journalit plugin."),Le.default.createElement(ar,{title:"Trade Settings",defaultExpanded:!0},Le.default.createElement("div",{className:"setting-item"},Le.default.createElement("div",{className:"setting-item-info"},Le.default.createElement("div",{className:"setting-item-name"},"Auto-open Created Trades"),Le.default.createElement("div",{className:"setting-item-description"},"Automatically open trade notes in a new tab after they are created")),Le.default.createElement("div",{className:"setting-item-control"},Le.default.createElement(Ei,{checked:e.settings.trade.autoOpenCreatedTrades||!1,onChange:i,id:"auto-open-trades-toggle",ariaLabel:"Auto-open created trades"}))),Le.default.createElement("div",{className:"setting-item"},Le.default.createElement("div",{className:"setting-item-info"},Le.default.createElement("div",{className:"setting-item-name"},"Date Format"),Le.default.createElement("div",{className:"setting-item-description"},"Format for displaying dates throughout the plugin")),Le.default.createElement("div",{className:"setting-item-control"},Le.default.createElement(oa,{value:e.settings.trade.dateFormat,onChange:o,options:n,id:"date-format-dropdown","aria-label":"Select date format for trade notes"}))),Le.default.createElement("div",{className:"setting-item"},Le.default.createElement("div",{className:"setting-item-info"},Le.default.createElement("div",{className:"setting-item-name"},"Skip Weekends in Navigation"),Le.default.createElement("div",{className:"setting-item-description"},"Skip weekends when navigating between trading days (e.g., Friday \u2192 Monday)")),Le.default.createElement("div",{className:"setting-item-control"},Le.default.createElement(Ei,{checked:(u=e.settings.trade.skipWeekends)!=null?u:!0,onChange:a,id:"skip-weekends-toggle",ariaLabel:"Skip weekends when navigating"}))),Le.default.createElement("div",{className:"setting-item"},Le.default.createElement("div",{className:"setting-item-info"},Le.default.createElement("div",{className:"setting-item-name"},"Trading Day Cutoff Time"),Le.default.createElement("div",{className:"setting-item-description"},"Time that defines the end of a trading day. Trades after this time will be grouped with the next day. (24-hour format, e.g., 23:30 for 11:30 PM)")),Le.default.createElement("div",{className:"setting-item-control"},Le.default.createElement("input",{type:"time",value:(p=e.settings.trade.tradingDayCutoffTime)!=null?p:"00:00",onChange:s,id:"trading-day-cutoff-time","aria-label":"Trading day cutoff time",className:"setting-input time-input",style:{padding:"8px",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",backgroundColor:"var(--background-primary)",color:"var(--text-normal)",width:"120px"}}))),Le.default.createElement("div",{className:"setting-item"},Le.default.createElement("div",{className:"setting-item-info"},Le.default.createElement("div",{className:"setting-item-name"},"Auto-create DRC on Navigation"),Le.default.createElement("div",{className:"setting-item-description"},"Automatically create a new Daily Report Card when navigating to a day that doesn't have one")),Le.default.createElement("div",{className:"setting-item-control"},Le.default.createElement(Ei,{checked:(m=e.settings.drc.autoCreateDRCOnNavigation)!=null?m:!0,onChange:l,id:"auto-create-drc-navigation-toggle",ariaLabel:"Auto-create DRC on navigation"}))),Le.default.createElement("div",{className:"setting-item"},Le.default.createElement("div",{className:"setting-item-info"},Le.default.createElement("div",{className:"setting-item-name"},"Auto-create Weekly Review on Navigation"),Le.default.createElement("div",{className:"setting-item-description"},"Automatically create a new Weekly Review when navigating to a week that doesn't have one")),Le.default.createElement("div",{className:"setting-item-control"},Le.default.createElement(Ei,{checked:(g=e.settings.weekly.autoCreateWeeklyReviewOnNavigation)!=null?g:!0,onChange:c,id:"auto-create-weekly-review-navigation-toggle",ariaLabel:"Auto-create Weekly Review on navigation"}))),Le.default.createElement("div",{className:"setting-item"},Le.default.createElement("div",{className:"setting-item-info"},Le.default.createElement("div",{className:"setting-item-name"},"Auto-create Monthly Review on Navigation"),Le.default.createElement("div",{className:"setting-item-description"},"Automatically create a new Monthly Review when navigating to a month that doesn't have one")),Le.default.createElement("div",{className:"setting-item-control"},Le.default.createElement(Ei,{checked:(y=(f=e.settings.monthly)==null?void 0:f.autoCreateMonthlyReviewOnNavigation)!=null?y:!0,onChange:d,id:"auto-create-monthly-review-navigation-toggle",ariaLabel:"Auto-create Monthly Review on navigation"})))))};var Dn=$(W());var aa=$(W()),w2=require("obsidian");var x2=({plugin:e})=>{let[t,r]=(0,aa.useState)(()=>{var i;return((i=e.settings.reviews)==null?void 0:i.globalAutoCreate)===void 0?(e.settings.reviews?e.settings.reviews&&(e.settings.reviews.globalAutoCreate=!0,e.saveSettings()):(e.settings.reviews={globalAutoCreate:!0},e.saveSettings()),!0):e.settings.reviews.globalAutoCreate});return(0,aa.useEffect)(()=>{e.settings.reviews&&r(e.settings.reviews.globalAutoCreate)},[e.settings]),aa.default.createElement("div",{className:"global-review-settings"},aa.default.createElement("div",{className:"setting-item"},aa.default.createElement("div",{className:"setting-item-info"},aa.default.createElement("div",{className:"setting-item-name"},"Global Auto-Create Reviews"),aa.default.createElement("div",{className:"setting-item-description"},"Automatically create reviews when the first trade of the corresponding period is recorded. This setting applies to daily, weekly, monthly and yearly reviews.")),aa.default.createElement("div",{className:"setting-item-control"},aa.default.createElement(Ei,{checked:t,onChange:async()=>{let i=!t;r(i),e.settings.reviews?e.settings.reviews.globalAutoCreate=i:e.settings.reviews={globalAutoCreate:i},e.settings.drc&&(e.settings.drc.autoCreateOnFirstTrade=i),e.settings.weekly&&(e.settings.weekly.autoCreateOnFirstTrade=i),await e.saveSettings(),document.dispatchEvent(new CustomEvent("journalit-settings-updated",{detail:{component:"reviews",settings:e.settings.reviews}})),new w2.Notice(`Auto-create for all reviews ${i?"enabled":"disabled"}`)},id:"global-auto-create-toggle",ariaLabel:"Global auto-create reviews"}))))};var dn=$(W());var Cn=$(W()),k2=require("obsidian");var Yi=$(W());var Va={inputContainer:"j",label:"y",inputWrapper:"k",input:"t",sm:"z",md:"C",lg:"A",default:"Y",filled:"M",outlined:"S",error:"p",errorMessage:"T",helperText:"Z",loading:"B","loading-shimmer":"s"};var Mr=Yi.default.forwardRef(({className:e="",id:t,label:r,error:n,helperText:i,disabled:o=!1,size:a="md",variant:s="default",loading:l=!1,onChange:c,multiline:d=!1,rows:u=3,required:p=!1,...m},g)=>{let f=(0,Yi.useId)(),y=t||`input-${f}`,h=`helper-${y}`,v=`error-${y}`,[b,w]=(0,Yi.useState)(!1),k=typeof m.value=="string"&&(m.value==="0"||m.value==="0.00"||/^0\.0+$/.test(m.value)),S=[Va.input,Va[a],Va[s],n?Va.error:"",k?"default-value":"",e,"input",a,s,n?"error":"",k?"default-value":""].filter(Boolean).join(" "),x=[Va.inputContainer,l?Va.loading:"","inputContainer",l?"loading":""].filter(Boolean).join(" "),T=C=>{c&&c(C.target.value)},E=C=>{c&&c(C.target.value)};return Yi.default.createElement("div",{className:x},r&&Yi.default.createElement("label",{htmlFor:y,className:`${Va.label} label`},r,p&&Yi.default.createElement("span",{className:"required-indicator"},"*")),Yi.default.createElement("div",{className:`${Va.inputWrapper} inputWrapper`},d?Yi.default.createElement("textarea",{id:y,className:S,disabled:o||l,"aria-invalid":!!n,"aria-describedby":n?v:i?h:void 0,rows:u,onFocus:C=>{w(!0)},onBlur:C=>{w(!1)},onChange:E,value:m.value,placeholder:m.placeholder}):Yi.default.createElement("input",{ref:g,id:y,className:S,disabled:o||l,"aria-invalid":!!n,"aria-describedby":n?v:i?h:void 0,onFocus:C=>{var N;w(!0),(N=m.onFocus)==null||N.call(m,C)},onBlur:C=>{var N;w(!1),(N=m.onBlur)==null||N.call(m,C)},onChange:T,...m})),n&&Yi.default.createElement("div",{id:v,className:`${Va.errorMessage} errorMessage`,role:"alert"},n),!n&&i&&Yi.default.createElement("div",{id:h,className:`${Va.helperText} helperText`},i))});Mr.displayName="Input";var zg=({plugin:e,items:t,defaultItems:r,settingsPath:n,placeholder:i,onItemsChange:o,settingsEventComponent:a})=>{let[s,l]=(0,Cn.useState)(""),c=(g,f)=>{let y=g.split("."),h={...e.settings},v=h;for(let b=0;b<y.length-1;b++)v[y[b]]||(v[y[b]]={}),v=v[y[b]];return v[y[y.length-1]]=f,h},d=async g=>{let f=c(n,g);e.settings=f,await e.saveSettings(),a&&document.dispatchEvent(new CustomEvent("journalit-settings-updated",{detail:{component:a,settings:n.split(".")[0]===a?e.settings[a]:e.settings}})),o&&o(g)},u=async()=>{if(!s.trim())return;let g=[...t,s.trim()];await d(g),l("")},p=async g=>{let f=[...t];f.splice(g,1),await d(f)};return Cn.default.createElement("div",{className:"item-manager"},Cn.default.createElement("div",{className:"setting-item"},Cn.default.createElement("div",{className:"setting-item-info"},Cn.default.createElement("div",{className:"setting-item-control"},Cn.default.createElement(be,{onClick:async()=>{await d([...r]),new k2.Notice("Reset items to defaults")},variant:"secondary"},"Reset to Defaults")))),t.map((g,f)=>Cn.default.createElement("div",{key:f,className:"setting-item custom-item"},Cn.default.createElement("div",{className:"setting-item-info"},Cn.default.createElement("div",{className:"setting-item-name"},g)),Cn.default.createElement("div",{className:"setting-item-control"},Cn.default.createElement(be,{onClick:()=>p(f)},"Remove")))),Cn.default.createElement("div",{className:"setting-item custom-item-add"},Cn.default.createElement("div",{className:"setting-item-info"},Cn.default.createElement(Mr,{value:s,onChange:g=>l(g),placeholder:i})),Cn.default.createElement("div",{className:"setting-item-control"},Cn.default.createElement(be,{onClick:u,disabled:!s.trim()},"Add"))))};var Kr=$(W()),S2=require("obsidian");var Lb=({plugin:e,timeframes:t,defaultTimeframes:r,settingsPath:n,settingsEventComponent:i,placeholder:o="New timeframe (e.g., 15M, 5M)"})=>{let[a,s]=(0,Kr.useState)(""),l=(m,g)=>{let f=m.split("."),y={...e.settings},h=y;for(let v=0;v<f.length-1;v++)h[f[v]]||(h[f[v]]={}),h=h[f[v]];return h[f[f.length-1]]=g,y},c=async m=>{let g=l(n,m);e.settings=g,await e.saveSettings(),i&&document.dispatchEvent(new CustomEvent("journalit-settings-updated",{detail:{component:i,settings:e.settings[i]}}))},d=async()=>{if(!a.trim())return;let m=[...t,a.trim()];await c(m),s("")},u=async m=>{let g=[...t];g.splice(m,1),await c(g)};return Kr.default.createElement("div",{className:"timeframe-manager"},Kr.default.createElement("div",{className:"setting-item"},Kr.default.createElement("div",{className:"setting-item-info"},Kr.default.createElement("div",{className:"setting-item-name"},"Forecast Timeframes"),Kr.default.createElement("div",{className:"setting-item-description"},"Customize the timeframes that appear in your forecast")),Kr.default.createElement("div",{className:"setting-item-control"},Kr.default.createElement(be,{onClick:async()=>{await c([...r]),new S2.Notice("Reset timeframes to defaults")},variant:"secondary"},"Reset to Defaults"))),t.map((m,g)=>Kr.default.createElement("div",{key:g,className:"setting-item custom-item"},Kr.default.createElement("div",{className:"setting-item-info"},Kr.default.createElement("div",{className:"setting-item-name"},m)),Kr.default.createElement("div",{className:"setting-item-control"},Kr.default.createElement(be,{onClick:()=>u(g)},"Remove")))),Kr.default.createElement("div",{className:"setting-item custom-item-add"},Kr.default.createElement("div",{className:"setting-item-info"},Kr.default.createElement(Mr,{value:a,onChange:m=>s(m),placeholder:o})),Kr.default.createElement("div",{className:"setting-item-control"},Kr.default.createElement(be,{onClick:d,disabled:!a.trim()},"Add"))))};var T2=({plugin:e})=>{var d,u,p;let t=["Review market conditions","Check economic calendar","Set risk limits for the day","Review previous day's trades"],r=["What did I do well today?","What could I improve on?","What will I focus on for the next session?"],n=["Daily","4H","1H","30M"],[i,o]=(0,dn.useState)(((d=e.settings.drc)==null?void 0:d.checklistItems)||[...t]),[a,s]=(0,dn.useState)(((u=e.settings.drc)==null?void 0:u.reviewQuestions)||[...r]),[l,c]=(0,dn.useState)(((p=e.settings.drc)==null?void 0:p.customTimeframes)||[...n]);return(0,dn.useEffect)(()=>{let m=g=>{var f,y,h,v;((f=g.detail)==null?void 0:f.component)==="drc"&&(o(((y=e.settings.drc)==null?void 0:y.checklistItems)||[]),s(((h=e.settings.drc)==null?void 0:h.reviewQuestions)||[]),c(((v=e.settings.drc)==null?void 0:v.customTimeframes)||[]))};return document.addEventListener("journalit-settings-updated",m),()=>{document.removeEventListener("journalit-settings-updated",m)}},[e.settings]),dn.default.createElement("div",{className:"daily-review-section"},dn.default.createElement("h4",null,"Pre-Trade Checklist Items"),dn.default.createElement("p",{className:"setting-item-description"},"Customize the checklist items that appear in your Daily Report Card. These are tasks you should complete before starting your trading session."),dn.default.createElement(zg,{plugin:e,items:i,defaultItems:t,settingsPath:"drc.checklistItems",placeholder:"New checklist item",onItemsChange:o,settingsEventComponent:"drc"}),dn.default.createElement("hr",null),dn.default.createElement("h4",null,"Review Questions"),dn.default.createElement("p",{className:"setting-item-description"},"Customize the reflection questions that appear in the review section. These questions help you reflect on your trading performance."),dn.default.createElement(zg,{plugin:e,items:a,defaultItems:r,settingsPath:"drc.reviewQuestions",placeholder:"New review question",onItemsChange:s,settingsEventComponent:"drc"}),dn.default.createElement("hr",null),dn.default.createElement("h4",null,"Forecast Timeframes"),dn.default.createElement("p",{className:"setting-item-description"},"Customize the timeframes that appear in your Daily Report Card forecasts."),dn.default.createElement(Lb,{plugin:e,timeframes:l,defaultTimeframes:n,settingsPath:"drc.customTimeframes",settingsEventComponent:"drc",placeholder:"New timeframe (e.g., 15M, 5M)"}))};var Ki=$(W());var C2=({plugin:e})=>{let t=["What worked well this week?","What didn't work this week?","Which setups were most profitable?","What mistakes cost me the most money?","What could I improve for next week?"],r=["Monthly","Weekly","Daily"],[n,i]=(0,Ki.useState)(()=>(e.settings.weekly||(e.settings.weekly={reviewQuestions:[...t],customTimeframes:[...r],autoCreateOnFirstTrade:!0}),[...e.settings.weekly.reviewQuestions||t])),[o,a]=(0,Ki.useState)(()=>{var s;return((s=e.settings.weekly)==null?void 0:s.customTimeframes)||[...r]});return(0,Ki.useEffect)(()=>{let s=l=>{var c,d,u;((c=l.detail)==null?void 0:c.component)==="weekly"&&(i(((d=e.settings.weekly)==null?void 0:d.reviewQuestions)||[]),a(((u=e.settings.weekly)==null?void 0:u.customTimeframes)||[]))};return document.addEventListener("journalit-settings-updated",s),()=>{document.removeEventListener("journalit-settings-updated",s)}},[e.settings]),Ki.default.createElement("div",{className:"weekly-review-section"},Ki.default.createElement("h4",null,"Review Questions"),Ki.default.createElement("p",{className:"setting-item-description"},"Customize the questions that appear in your weekly review. These questions help you reflect on your trading performance over the week."),Ki.default.createElement(zg,{plugin:e,items:n,defaultItems:t,settingsPath:"weekly.reviewQuestions",placeholder:"New review question",onItemsChange:i,settingsEventComponent:"weekly"}),Ki.default.createElement("hr",null),Ki.default.createElement("h4",null,"Forecast Timeframes"),Ki.default.createElement("p",{className:"setting-item-description"},"Customize the timeframes that appear in your weekly forecast."),Ki.default.createElement(Lb,{plugin:e,timeframes:o,defaultTimeframes:r,settingsPath:"weekly.customTimeframes",settingsEventComponent:"weekly",placeholder:"New timeframe (e.g., Weekly, Daily)"}))};var Rt=$(W());function It(){let e=window.app;if(!e)throw new Error("Could not access Obsidian app instance");return e}Ha();var Eo=(s=>(s.INSTRUMENT="instrument",s.ACCOUNT="account",s.ACCOUNT_TYPE="account_type",s.SETUP="setup",s.MISTAKE="mistake",s.TAG="tag",s.EVENT="event",s))(Eo||{}),qa={instrument:[],account:[],account_type:[],setup:[],mistake:[],tag:[],event:[]},_b={instrument:[{name:"AAPL",assetType:"stock"},{name:"MSFT",assetType:"stock"},{name:"TSLA",assetType:"stock"},{name:"ES1",assetType:"futures",futuresData:{dollarPerPoint:50,tickSize:.25,tickValue:12.5}},{name:"NQ1",assetType:"futures",futuresData:{dollarPerPoint:20,tickSize:.25,tickValue:5}},{name:"EURUSD",assetType:"forex"}],account:["Trading Account","Investment Account"],account_type:["Demo","Evaluation","Funded","Archived"],setup:["Breakout Setup","Reversal Pattern"],mistake:["Early Entry","Poor Position Sizing"],tag:["Swing Trade","Day Trade","Momentum","Reversal","Earnings"],event:[{name:"FOMC Meeting",color:"gray"},{name:"Earnings Announcement",color:"gray"},{name:"Economic Data Release",color:"gray"},{name:"Fed Speech",color:"gray"},{name:"Market Holiday",color:"gray"}]},En=class{constructor(t,r){this.options={...qa};this.namespace="";this.plugin=t||this.getPluginInstance(),r!=null&&r.namespace&&(this.namespace=r.namespace),this.loadOptions(),this.initializeDefaultOptionsIfNeeded()}getPluginInstance(){try{let r=It().plugins.plugins,n="journalit";if(r[n])return r[n];throw new Error("Plugin instance not found")}catch(t){throw console.error("Failed to get plugin instance:",t),new Error("Could not access plugin instance")}}getOptionsKey(){return this.namespace?`customOptions_${this.namespace}`:"customOptions"}async loadOptions(){try{let t=this.getOptionsKey(),r=this.plugin;if(r.settings&&r.settings[t]){let n={...qa,...r.settings[t]};Array.isArray(n.instrument)&&(typeof n.instrument[0]=="string"?this.options.instrument=n.instrument.map(o=>({name:o,assetType:"stock"})):this.options.instrument=n.instrument),this.options.account=n.account,this.options.account_type=n.account_type,this.options.setup=n.setup,this.options.mistake=n.mistake,this.options.tag=n.tag,Array.isArray(n.event)?this.options.event=n.event.map(i=>typeof i=="string"?{name:i,color:"gray"}:typeof i=="object"&&i!==null&&i.name?{name:i.name,color:i.color||"gray"}:null).filter(Boolean):this.options.event=[]}else if(!this.namespace&&r.settings&&r.settings.customOptions){let n={...qa,...r.settings.customOptions};Array.isArray(n.instrument)&&(typeof n.instrument[0]=="string"?this.options.instrument=n.instrument.map(o=>({name:o,assetType:"stock"})):this.options.instrument=n.instrument),this.options.account=n.account,this.options.account_type=n.account_type,this.options.setup=n.setup,this.options.mistake=n.mistake,this.options.tag=n.tag,Array.isArray(n.event)?this.options.event=n.event.map(i=>typeof i=="string"?{name:i,color:"gray"}:typeof i=="object"&&i!==null&&i.name?{name:i.name,color:i.color||"gray"}:null).filter(Boolean):this.options.event=[]}else{let n=await this.plugin.loadData(),i=this.namespace?`customOptions_${this.namespace}`:"customOptions";if(n&&n[i]){let o={...qa,...n[i]};Array.isArray(o.instrument)&&(typeof o.instrument[0]=="string"?this.options.instrument=o.instrument.map(s=>({name:s,assetType:"stock"})):this.options.instrument=o.instrument),this.options.account=o.account,this.options.account_type=o.account_type,this.options.setup=o.setup,this.options.mistake=o.mistake,this.options.tag=o.tag,this.options.event=o.event,r.settings&&(r.settings[t]={...this.options},await r.saveSettings())}else if(!this.namespace&&n&&n.customOptions){let o={...qa,...n.customOptions};Array.isArray(o.instrument)&&(typeof o.instrument[0]=="string"?this.options.instrument=o.instrument.map(s=>({name:s,assetType:"stock"})):this.options.instrument=o.instrument),this.options.account=o.account,this.options.account_type=o.account_type,this.options.setup=o.setup,this.options.mistake=o.mistake,this.options.tag=o.tag,this.options.event=o.event,r.settings&&(r.settings[t]={...this.options},await r.saveSettings())}else this.options={...qa},this.initializeDefaultOptionsIfNeeded(),r.settings&&(r.settings[t]={...this.options},await r.saveSettings())}}catch(t){console.error("Failed to load custom options:",t),this.options={...qa},this.initializeDefaultOptionsIfNeeded()}}async saveOptions(){try{let t=this.getOptionsKey(),r=this.plugin;if(r.settings)r.settings[t]={...this.options},await r.saveSettings();else{console.warn(`Plugin settings not accessible, using legacy save method with key: ${t}`);let i={...await this.plugin.loadData()||{},[t]:this.options};await this.plugin.saveData(i)}}catch(t){console.error(`Failed to save custom options with key: ${this.getOptionsKey()}:`,t)}}getOptions(t){return t==="event"?this.options.event.map(r=>r.name):t==="instrument"?this.options.instrument.map(r=>r.name):this.options[t]?[...this.options[t]]:(console.warn(`Options for type ${t} not initialized, returning empty array`),[])}getInstrumentsForAssetType(t){return this.options.instrument.filter(r=>r.assetType===t).map(r=>r.name)}isInstrumentValidForAssetType(t,r){return!t||!r?!1:this.options.instrument.some(n=>n.name.toLowerCase()===t.toLowerCase()&&n.assetType===r)}getAssetTypeForInstrument(t){if(!t)return;let r=this.options.instrument.find(n=>n.name.toLowerCase()===t.toLowerCase());return r==null?void 0:r.assetType}getFuturesDataForInstrument(t){if(!t)return;let r=this.options.instrument.find(n=>n.name.toLowerCase()===t.toLowerCase()&&n.assetType==="futures");return r==null?void 0:r.futuresData}async setFuturesDataForInstrument(t,r){if(!t)return!1;let n=this.options.instrument.findIndex(o=>o.name.toLowerCase()===t.toLowerCase()&&o.assetType==="futures");if(n===-1)return!1;let i={...r};return i.dollarPerPoint===0&&(i.dollarPerPoint=void 0),this.options.instrument[n].futuresData={...this.options.instrument[n].futuresData,...i},await this.saveOptions(),this.notifyOptionsChanged(),!0}getAllOptions(){return{...this.options}}async addOption(t,r,n,i){if(t==="event")return console.warn("Use addOrUpdateEventOption to add events with colors."),!1;let o=r.trim();if(!o)return!1;if(t==="instrument"){if(!n)return console.warn("Asset type is required when adding an instrument"),!1;if(this.options.instrument.some(l=>l.name.toLowerCase()===o.toLowerCase()&&l.assetType===n))return!1;let s={name:o,assetType:n};n==="futures"&&i&&(s.futuresData=i),this.options.instrument.push(s)}else{if(this.options[t].some(s=>s.toLowerCase()===o.toLowerCase()))return!1;this.options[t]=[...this.options[t],o]}return await this.saveOptions(),!0}async addOrUpdateEventOption(t,r){let n=t.trim(),o=["red","orange","yellow","gray"].includes(r)?r:"gray";if(!n)return!1;let a=this.options.event.findIndex(s=>s.name.toLowerCase()===n.toLowerCase());return a!==-1?this.options.event[a].color=o:this.options.event.push({name:n,color:o}),await this.saveOptions(),this.notifyOptionsChanged(),!0}async addOptions(t,r,n){if(t==="event")return console.warn("Use addOrUpdateEventOption to add events with colors. Skipping addOptions for EVENT."),0;if(!r.length)return 0;let i=r.map(o=>o.trim()).filter(o=>!!o);if(!i.length)return 0;if(t==="instrument"){if(!n)return console.warn("Asset type is required when adding instruments"),0;let o=0;for(let a of i)if(!this.options.instrument.some(l=>l.name.toLowerCase()===a.toLowerCase()&&l.assetType===n)){let l={name:a,assetType:n};n==="futures"&&(l.futuresData={dollarPerPoint:0,tickSize:0,tickValue:0}),this.options.instrument.push(l),o++}return o>0&&await this.saveOptions(),o}else{let o=i.filter(a=>!this.options[t].some(s=>s.toLowerCase()===a.toLowerCase()));return o.length?(this.options[t]=[...this.options[t],...o],await this.saveOptions(),o.length):0}}async removeOption(t,r){let n=!1;if(t==="event"){let i=this.options.event.length;this.options.event=this.options.event.filter(o=>o.name.toLowerCase()!==r.toLowerCase()),n=i!==this.options.event.length}else if(t==="instrument"){let i=this.options.instrument.length;this.options.instrument=this.options.instrument.filter(o=>o.name.toLowerCase()!==r.toLowerCase()),n=i!==this.options.instrument.length}else{let i=this.options[t].length;this.options[t]=this.options[t].filter(o=>o.toLowerCase()!==r.toLowerCase()),n=i!==this.options[t].length}return n?(await this.saveOptions(),await new Promise(i=>setTimeout(i,200)),this.notifyOptionsChanged()):console.warn(`Failed to remove option '${r}' from ${t} - option not found`),n}async updateInstrument(t,r,n,i,o=!1){let a=r.trim();if(!a)return{success:!1};if(!n)return{success:!1};let s=this.options.instrument.findIndex(u=>u.name.toLowerCase()===t.toLowerCase());if(s===-1)return console.warn(`Instrument '${t}' not found`),{success:!1};if(this.options.instrument.some((u,p)=>p!==s&&u.name.toLowerCase()===a.toLowerCase()&&u.assetType===n))return console.warn(`Instrument '${a}' already exists with asset type '${n}'`),{success:!1};let c={name:a,assetType:n};n==="futures"&&(c.futuresData=i||this.options.instrument[s].futuresData||{dollarPerPoint:0,tickSize:0,tickValue:0}),this.options.instrument[s]=c,await this.saveOptions();let d=0;return o&&t!==a&&(d=await this.updateNotesWithOption("instrument",t,a)),this.notifyOptionsChanged(),{success:!0,updatedNotes:d}}async updateOption(t,r,n,i=!1){let o=n.trim();if(!o)return{success:!1};if(t==="instrument")return console.warn("Use updateInstrument method for instruments"),{success:!1};let a=!1,s=-1;if(t==="event"){if(this.options.event.some(d=>d.name.toLowerCase()===o.toLowerCase()&&d.name.toLowerCase()!==r.toLowerCase()))return{success:!1};s=this.options.event.findIndex(d=>d.name.toLowerCase()===r.toLowerCase()),s!==-1&&(this.options.event[s].name=o,a=!0)}else{if(this.options[t].some(d=>d.toLowerCase()===o.toLowerCase()&&d.toLowerCase()!==r.toLowerCase()))return{success:!1};s=this.options[t].findIndex(d=>d.toLowerCase()===r.toLowerCase()),s!==-1&&(this.options[t][s]=o,a=!0)}if(!a)return{success:!1};await this.saveOptions();let l=0;return i&&(l=await this.updateNotesWithOption(t,r,n)),this.notifyOptionsChanged(),{success:!0,updatedNotes:l}}async updateNotesWithOption(t,r,n){try{let i=this.getApp().vault.getMarkdownFiles(),a={instrument:["instrument"],account:["account","accountIds"],setup:["setup","setupIds"],mistake:["mistake","mistakeIds"],tag:["ctags"],event:["keyEvents"]}[t];if(!a||a.length===0)return console.warn(`No property names defined for option type: ${t}`),0;let s=0;for(let l of i)try{let c=await this.getApp().vault.read(l),d=c.match(/^---\n([\s\S]*?)\n---/);if(!d)continue;let p=d[1].split(`
`),m=!1,g=p.map(f=>{var y;for(let h of a)if(h==="keyEvents"&&t==="event"){let v=f.match(/^(\s*-\s*event:\s*)(.+)$/);if(v){let b=v[1],w=v[2].trim();if(this.optionValueMatches(w,r))return m=!0,`${b}${n}`}}else if(f.trim().startsWith(`${h}:`)&&!f.includes("[")){let v=(y=f.split(":")[1])==null?void 0:y.trim();if(v&&this.optionValueMatches(v,r))return m=!0,`${h}: ${n}`}else if(f.trim().startsWith(`${h}:`)&&f.includes("[")){let v=f.match(/\[(.*?)\]/);if(v){let b=v[1].split(",").map(k=>k.trim()),w=b.map(k=>this.optionValueMatches(k,r)?n:k);if(b.some((k,S)=>k!==w[S]))return m=!0,`${h}: [${w.join(", ")}]`}}return f});if(m){let f=c.replace(/^---\n[\s\S]*?\n---/,`---
${g.join(`
`)}
---`);await this.getApp().vault.modify(l,f),await kt(this.getApp(),l);let y=new CustomEvent(`journalit:${this.namespace}-updated`,{detail:{id:l.path}});document.dispatchEvent(y),s++,t==="instrument"&&await this.updateFileNameForInstrument(l,r,n)}}catch(c){console.error(`Error processing file ${l.path}:`,c)}return s}catch(i){return console.error("Error updating notes with new option value:",i),0}}optionValueMatches(t,r){return t.toLowerCase()===r.toLowerCase()}async updateFileNameForInstrument(t,r,n){try{let i=this.extractTickerPart(r),o=this.extractTickerPart(n),a=this.sanitizeTickerForFilename(i),s=this.sanitizeTickerForFilename(o),l=t.path.split("/"),c=l.pop()||"",d=l.join("/");if(!c.match(/^[A-Z0-9-]+-[0-9]{6}-T\d+\.md$/)||!c.startsWith(`${a}-`))return;let u=c.replace(new RegExp(`^${a}-`),`${s}-`),p=`${d}/${u}`;if(p===t.path)return;await this.getApp().fileManager.renameFile(t,p)}catch(i){console.error(`Error updating filename for '${t.path}':`,i)}}extractTickerPart(t){if(!t)return"";let r=t.match(/^([A-Z0-9.^-]+)(?:\s+-\s+|$)/);return r&&r[1]?r[1].trim():t}sanitizeTickerForFilename(t){if(!t)return"UNKNOWN";let r=t.trim().toUpperCase();if(r=r.replace(/[\\/:*?"<>|+]/g,"").replace(/[\s.\[\]\(\)\{\}#%&=;]/g,"-").replace(/--+/g,"-").replace(/^-|-$/g,""),!r)return"UNKNOWN";let n=20;return r.length>n&&(r=r.substring(0,n)),r}getApp(){return this.plugin.app}async clearOptions(t){let r=t==="instrument"?this.options[t].length:this.options[t].length;return r===0?0:(t==="instrument"?this.options[t]=[]:t==="event"?this.options[t]=[]:this.options[t]=[],await this.saveOptions(),await new Promise(n=>setTimeout(n,200)),this.notifyOptionsChanged(),r)}async resetAllOptions(){this.options={...qa},await this.saveOptions(),await new Promise(t=>setTimeout(t,200)),this.notifyOptionsChanged()}async reloadOptions(){await this.loadOptions()}async initializeDefaultOptionsIfNeeded(){try{let t=!1;for(let r of Object.values(Eo))if(this.options[r].length===0&&_b[r].length>0)if(t=!0,r==="event"){let n=_b.event;for(let i of n)this.options.event.findIndex(a=>a.name.toLowerCase()===i.name.toLowerCase())===-1&&this.options.event.push({name:i.name,color:i.color||"gray"})}else if(r==="instrument"){let n=_b.instrument;for(let i of n)this.options.instrument.findIndex(a=>a.name.toLowerCase()===i.name.toLowerCase())===-1&&this.options.instrument.push({name:i.name,assetType:i.assetType,futuresData:i.futuresData})}else{let n=_b[r];this.options[r]=[...this.options[r],...n]}t&&await this.saveOptions()}catch(t){console.error("Failed to initialize default options:",t)}}notifyOptionsChanged(){try{let t={timestamp:Date.now(),...this.namespace?{namespace:this.namespace}:{}},r=new CustomEvent("journalit-options-changed",{detail:t});document.dispatchEvent(r)}catch(t){console.error("Failed to dispatch options changed event:",t)}}getEventOptionByName(t){let r=t.trim().toLowerCase();return this.options.event.find(n=>n.name.toLowerCase()===r)}getNamespace(){return this.namespace}async setNamespace(t){this.namespace!==t&&(this.namespace=t,this.options={...qa},await this.loadOptions(),this.notifyOptionsChanged())}};Jr();var ni={general:{},trade:{autoOpenCreatedTrades:!0,dateFormat:"DDMMYY",skipWeekends:!0,useDirectPnLInput:!1,tradingDayCutoffTime:"00:00",includeMissedTradesInCalculations:!1,lossReview:{enabled:!0,sections:[{id:"pause-header",title:"**LOSS REVIEW**",type:"header",content:""},{id:"pause-section",title:"**Pause**\u270B",type:"header",content:`Take a moment to step back.
Do **NOT** start looking at entering a position until you have completed this loss review.`},{id:"pause-checkbox",title:"",type:"checkbox",content:'Say out loud to yourself, **"losses are part of the process, there are endless opportunities in the market."**'},{id:"review-plan",title:"**Review Your Plan**",type:"header",content:"***Did you stick to your trading plan without mistakes?***"},{id:"review-plan-checklist",title:"",type:"checkboxList",items:["\u2192 If **yes**; there is nothing to be mad about, not every trade is going to work out regardless of how good the thesis is","\u2192 If **no**; figure out what went wrong, learn from it and don't do it again"]},{id:"feelings",title:"**Write Down Your Feelings**",type:"header",content:"***Be honest about how you feel and note down your emotions:***"},{id:"feelings-text",title:"",type:"textarea",placeholder:"How are you feeling about this loss?"},{id:"learn-header",title:"**Learn From This Loss**",type:"header",content:"***If the loss was reasonable, write down the best things you did during the trade and ways of repeating those:***"},{id:"learn-reasonable",title:"",type:"textarea",placeholder:"What went well that you can repeat?"},{id:"learn-unreasonable-header",title:"",type:"header",content:"***If the loss was unreasonable, note where you went wrong and how you'll improve next time:***"},{id:"learn-unreasonable",title:"",type:"textarea",placeholder:"What went wrong and how will you improve?"},{id:"next-steps",title:"**Decide The Next Steps**",type:"header",content:`***Outline what you'll do based on the previous questions and follow the plan.***
***You might choose to step back from the charts if it's your third loss in a row.***
***Or you might want to continue trading if it's the first one.***
***What will you pay attention to? How will you behave?***`},{id:"next-steps-text",title:"",type:"textarea",placeholder:"What are your next steps?"},{id:"final-check",title:"**Final Check**",type:"header",content:""},{id:"final-check-list",title:"",type:"checkboxList",items:["If you feel **tilted**, take a break from the screen and play guitar, play with Leo, or get something to eat","If you feel **fine**, do not enter a trade until at least the next candle"]},{id:"overall-thoughts",title:"**Overall Trade Thoughts:**",type:"header",content:""},{id:"overall-thoughts-text",title:"",type:"textarea",placeholder:"Any additional thoughts about this trade?"}]}},reviews:{globalAutoCreate:!0},uiCustomization:{transparentBackgrounds:!0},customOptions:qa,weekly:{reviewQuestions:["What worked well this week?","What didn't work this week?","Which setups were most profitable?","What mistakes cost me the most money?","What could I improve for next week?"],customTimeframes:["Monthly","Weekly","Daily"],autoCreateOnFirstTrade:!0,autoCreateWeeklyReviewOnNavigation:!0},monthly:{reviewQuestions:["What were the key lessons from this month?","Which strategies performed best?","What patterns do I notice in my trading?","What are my goals for next month?","How can I improve my risk management?"],customTimeframes:["Quarterly","Monthly","Weekly"],autoCreateOnFirstTrade:!0,autoCreateMonthlyReviewOnNavigation:!0},drc:{checklistItems:["Review market conditions","Check economic calendar","Set risk limits for the day","Review previous day's trades"],reviewQuestions:["What did I do well today?","What could I improve on?","What will I focus on for the next session?"],customTimeframes:["Daily","4H","1H","30M"],autoCreateOnFirstTrade:!0,autoCreateDRCOnNavigation:!0},dashboard:{layouts:{Default:{topSection:["netPnL","winRate","profitFactor","expectancy"],bottomSection:{lg:[{i:"pnlChart",x:0,y:0,w:6,h:8},{i:"performanceCalendar",x:6,y:0,w:6,h:4},{i:"dailyPerformance",x:6,y:4,w:6,h:4}],md:[{i:"pnlChart",x:0,y:0,w:6,h:6},{i:"performanceCalendar",x:0,y:6,w:6,h:3},{i:"dailyPerformance",x:0,y:9,w:6,h:3}],sm:[{i:"pnlChart",x:0,y:0,w:4,h:6},{i:"performanceCalendar",x:0,y:6,w:4,h:3},{i:"dailyPerformance",x:0,y:9,w:4,h:3}]}}},activeLayout:"Default",defaultFilters:{dateRange:[null,null],accounts:[],tickers:[]},lastUsedFilters:{dateRange:[null,null],accounts:[],tickers:[]}},account:{defaultAccountType:"demo",defaultDrawdownType:"none",defaultDrawdownAmount:0,showBalanceInDashboard:!0,excludedAccountTypes:["archived"],includeWithdrawalsFromExcluded:{archived:!0,demo:!1},accountTypeOrder:["funded","evaluation","demo","archived"]},backendIntegration:{serverUrl:"http://91.99.99.169",syncEnabled:!0,userId:"",showSyncNotifications:!0,showNewTradeNotifications:!0}};var Gt=$(W());Ci();var E2=({section:e,index:t,totalSections:r,onUpdate:n,onRemove:i,onMove:o})=>{let a=p=>{let m={...e,type:p};p==="checkboxList"?(m.items=m.items||[""],m.content=void 0,m.placeholder=void 0):p==="textarea"?(m.placeholder=m.placeholder||"",m.content=void 0,m.items=void 0):(m.content=m.content||"",m.items=void 0,m.placeholder=void 0),n(m)},s=(p,m)=>{let g=[...e.items||[]];g[p]=m,n({...e,items:g})},l=()=>{let p=[...e.items||[],""];n({...e,items:p})},c=p=>{let m=(e.items||[]).filter((g,f)=>f!==p);n({...e,items:m})},d=()=>{switch(e.type){case"header":return Gt.default.createElement(Mr,{label:"Content",multiline:!0,rows:3,value:e.content||"",onChange:p=>n({...e,content:p}),placeholder:"Enter header content (supports markdown)"});case"checkbox":return Gt.default.createElement(Mr,{label:"Checkbox Label",multiline:!0,rows:2,value:e.content||"",onChange:p=>n({...e,content:p}),placeholder:"Enter checkbox label (supports markdown)"});case"textarea":return Gt.default.createElement(Mr,{label:"Placeholder Text",value:e.placeholder||"",onChange:p=>n({...e,placeholder:p}),placeholder:"Enter placeholder text for the textarea"});case"checkboxList":return Gt.default.createElement("div",{className:"checkbox-list-section"},Gt.default.createElement("label",{className:"checkbox-items-label"},"Checkbox Items"),Gt.default.createElement("div",{className:"checkbox-items"},(e.items||[]).map((p,m)=>Gt.default.createElement("div",{key:m,className:"checkbox-item"},Gt.default.createElement(Mr,{multiline:!0,rows:2,value:p,onChange:g=>s(m,g),placeholder:"Enter checkbox item (supports markdown)"}),Gt.default.createElement(be,{onClick:()=>c(m),disabled:(e.items||[]).length<=1},"Remove"))),Gt.default.createElement(be,{onClick:l},"Add Item")));default:return null}},u=`${e.title||"Untitled Section"} (${e.type})`;return Gt.default.createElement("div",{className:"loss-review-section-editor"},Gt.default.createElement(ar,{title:u,defaultExpanded:!1},Gt.default.createElement("div",{className:"section-editor-content"},Gt.default.createElement("div",{className:"section-controls-bar"},Gt.default.createElement("div",{className:"section-order-controls"},Gt.default.createElement(jb,{ariaLabel:"Move up",onClick:()=>o("up"),disabled:t===0,className:"control-button"},Gt.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},Gt.default.createElement("polyline",{points:"18 15 12 9 6 15"}))),Gt.default.createElement(jb,{ariaLabel:"Move down",onClick:()=>o("down"),disabled:t===r-1,className:"control-button"},Gt.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},Gt.default.createElement("polyline",{points:"6 9 12 15 18 9"})))),Gt.default.createElement(be,{onClick:i,variant:"danger"},"Remove Section")),Gt.default.createElement("hr",null),Gt.default.createElement("div",{className:"section-settings"},Gt.default.createElement(Mr,{label:"Section Title",value:e.title,onChange:p=>n({...e,title:p}),placeholder:"Enter section title"}),Gt.default.createElement(oa,{label:"Section Type",value:e.type,onChange:p=>a(p),options:[{value:"header",label:"Header"},{value:"checkbox",label:"Single Checkbox"},{value:"textarea",label:"Text Area"},{value:"checkboxList",label:"Checkbox List"}]}),d()))))};Ci();var D2=({plugin:e})=>{var u,p,m,g,f;let[t,r]=(0,Rt.useState)((m=(p=(u=e.settings.trade)==null?void 0:u.lossReview)==null?void 0:p.enabled)!=null?m:!0),[n,i]=(0,Rt.useState)(((f=(g=e.settings.trade)==null?void 0:g.lossReview)==null?void 0:f.sections)||[]);(0,Rt.useEffect)(()=>{let y=h=>{var v,b,w,k,S,x;((v=h.detail)==null?void 0:v.component)==="lossReview"&&(r((k=(w=(b=e.settings.trade)==null?void 0:b.lossReview)==null?void 0:w.enabled)!=null?k:!0),i(((x=(S=e.settings.trade)==null?void 0:S.lossReview)==null?void 0:x.sections)||[]))};return document.addEventListener("journalit-settings-updated",y),()=>{document.removeEventListener("journalit-settings-updated",y)}},[e.settings]);let o=async y=>{var h;r(y),e.settings.trade.lossReview={enabled:y,sections:((h=e.settings.trade.lossReview)==null?void 0:h.sections)||[]},await e.saveSettings(),document.dispatchEvent(new CustomEvent("journalit-settings-updated",{detail:{component:"lossReview"}}))},a=async(y,h)=>{var b,w;let v=[...n];v[y]=h,i(v),e.settings.trade.lossReview={enabled:(w=(b=e.settings.trade.lossReview)==null?void 0:b.enabled)!=null?w:!0,sections:v},await e.saveSettings(),document.dispatchEvent(new CustomEvent("journalit-settings-updated",{detail:{component:"lossReview"}}))},s=async y=>{var v,b;let h=n.filter((w,k)=>k!==y);i(h),e.settings.trade.lossReview={enabled:(b=(v=e.settings.trade.lossReview)==null?void 0:v.enabled)!=null?b:!0,sections:h},await e.saveSettings(),document.dispatchEvent(new CustomEvent("journalit-settings-updated",{detail:{component:"lossReview"}}))},l=async(y,h)=>{var w,k;if(h==="up"&&y===0||h==="down"&&y===n.length-1)return;let v=[...n],b=h==="up"?y-1:y+1;[v[y],v[b]]=[v[b],v[y]],i(v),e.settings.trade.lossReview={enabled:(k=(w=e.settings.trade.lossReview)==null?void 0:w.enabled)!=null?k:!0,sections:v},await e.saveSettings(),document.dispatchEvent(new CustomEvent("journalit-settings-updated",{detail:{component:"lossReview"}}))};return Rt.default.createElement("div",{className:"loss-review-section"},Rt.default.createElement("h4",null,"Loss Review Settings"),Rt.default.createElement("p",{className:"setting-item-description"},"Configure the Loss Review that appears at the bottom of losing trades. This helps you learn from losses and maintain proper trading psychology."),Rt.default.createElement("div",{className:"setting-item"},Rt.default.createElement("div",{className:"setting-item-info"},Rt.default.createElement("div",{className:"setting-item-name"},"Enable Loss Review"),Rt.default.createElement("div",{className:"setting-item-description"},"Show Loss Review section for trades with negative P&L")),Rt.default.createElement("div",{className:"setting-item-control"},Rt.default.createElement("input",{type:"checkbox",checked:t,onChange:y=>o(y.target.checked)}))),t&&Rt.default.createElement(Rt.default.Fragment,null,Rt.default.createElement("hr",null),Rt.default.createElement("div",{className:"loss-review-sections"},Rt.default.createElement("div",{className:"section-header"},Rt.default.createElement("h4",null,"Loss Review Sections"),Rt.default.createElement("div",{className:"section-actions"},Rt.default.createElement(be,{onClick:async()=>{var v,b;let y={id:`section-${Date.now()}`,title:"New Section",type:"header",content:""},h=[...n,y];i(h),e.settings.trade.lossReview={enabled:(b=(v=e.settings.trade.lossReview)==null?void 0:v.enabled)!=null?b:!0,sections:h},await e.saveSettings(),document.dispatchEvent(new CustomEvent("journalit-settings-updated",{detail:{component:"lossReview"}}))},variant:"primary"},"Add Section"),Rt.default.createElement(be,{onClick:async()=>{var v,b,w;let y=((v=ni.trade.lossReview)==null?void 0:v.sections)||[],h=(w=(b=ni.trade.lossReview)==null?void 0:b.enabled)!=null?w:!0;i(y),e.settings.trade.lossReview={enabled:h,sections:y},await e.saveSettings(),document.dispatchEvent(new CustomEvent("journalit-settings-updated",{detail:{component:"lossReview"}}))},variant:"secondary"},"Reset to Defaults"))),Rt.default.createElement("div",{className:"sections-list"},n.map((y,h)=>Rt.default.createElement(E2,{key:y.id,section:y,index:h,totalSections:n.length,onUpdate:v=>a(h,v),onRemove:()=>s(h),onMove:v=>l(h,v)})),n.length===0&&Rt.default.createElement("div",{className:"empty-state"},Rt.default.createElement("p",null,'No sections configured. Click "Add Section" to create your first section.'))))))};var P2=({plugin:e})=>Dn.default.createElement("div",{className:"journalit-settings-tab reviews-settings"},Dn.default.createElement("h3",null,"Review Settings"),Dn.default.createElement("p",{className:"setting-item-description"},"Configure settings for daily, weekly, monthly, and yearly reviews. These settings control how reviews are created and what information they include."),Dn.default.createElement(x2,{plugin:e}),Dn.default.createElement("hr",null),Dn.default.createElement(ar,{title:"Daily Review",defaultExpanded:!0},Dn.default.createElement(T2,{plugin:e})),Dn.default.createElement(ar,{title:"Weekly Review",defaultExpanded:!1},Dn.default.createElement(C2,{plugin:e})),Dn.default.createElement(ar,{title:"Trade Loss Review",defaultExpanded:!1},Dn.default.createElement(D2,{plugin:e})),Dn.default.createElement(ar,{title:"Monthly Review",defaultExpanded:!1},Dn.default.createElement("div",{className:"coming-soon"},Dn.default.createElement("p",null,"Monthly review settings will be available in a future update."))),Dn.default.createElement(ar,{title:"Yearly Review",defaultExpanded:!1},Dn.default.createElement("div",{className:"coming-soon"},Dn.default.createElement("p",null,"Yearly review settings will be available in a future update."))));var z=$(W());function gd(e){return e==null||isNaN(e)?"N/A":e.toFixed(1)+"%"}function Wt(e,t=!1){if(e==null||isNaN(e))return"N/A";let r=e<0,n=Math.abs(e),i=t&&e>0?"+":"",o=2,a=2;n===0?(o=0,a=0):n<10?(o=4,a=5):n<100?(o=3,a=4):n>=100&&(n===Math.floor(n)?(o=0,a=0):(o=2,a=2));let s=n.toLocaleString("en-US",{style:"currency",currency:"USD",minimumFractionDigits:o,maximumFractionDigits:a});return r?"-"+s:i+s}function fe(e,t=!0){if(e===void 0||isNaN(e))return"N/A";let r=e<0,n=Math.abs(e);if(n>=1e6){let a=n/1e6,s;if(!t)s=Math.round(a)+"M";else{let l=a.toFixed(2);l.endsWith(".00")?s=l.slice(0,-3)+"M":l.endsWith("0")?s=l.slice(0,-1)+"M":s=l+"M"}return r?"-$"+s:"$"+s}if(n>=1e5){let a=n/1e3,s;if(!t)s=Math.round(a)+"K";else{let l=a.toFixed(2);l.endsWith(".00")?s=l.slice(0,-3)+"K":l.endsWith("0")?s=l.slice(0,-1)+"K":s=l+"K"}return r?"-$"+s:"$"+s}let i=n!==Math.floor(n),o;if(!t)o=Math.round(n).toLocaleString("en-US");else if(i){let a=Math.floor(n).toLocaleString("en-US"),s=(n-Math.floor(n)).toFixed(2).substring(1);o=`${a}${s}`}else o=Math.floor(n).toLocaleString("en-US");return r?"-$"+o:"$"+o}function IC(e){if(!e||e<0)return"N/A";let t=Math.floor(e/1e3),r=Math.floor(t/60),n=Math.floor(r/60),i=Math.floor(n/24);if(i>0){let o=n%24;return o>0?`${i}d ${o}h`:`${i}d`}else if(n>0){let o=r%60;return o>0?`${n}h ${o}m`:`${n}h`}else if(r>0){let o=t%60;return o>0?`${r}m ${o}s`:`${r}m`}else return`${t}s`}var dt=require("obsidian");var A2=require("obsidian"),hc=new A2.Events,vc={STATE_CHANGED:"auth-state-changed"};Ci();Jr();var N2=({plugin:e})=>{var Y;let[t,r]=(0,z.useState)(e.authManager.getAuthState()),[n,i]=(0,z.useState)(e.authManager.getSubscriptionTier()),[o,a]=(0,z.useState)(e.authManager.isAuthenticated()),[s,l]=(0,z.useState)([]),[c,d]=(0,z.useState)(null),[u,p]=(0,z.useState)([]);class m extends dt.Modal{constructor(G,J,K){super(G);this.message=J;this.onConfirm=K}onOpen(){let{contentEl:G}=this;G.createEl("p",{text:this.message});let J=G.createDiv({cls:"modal-button-container"});J.createEl("button",{text:"OK (Update Notes)",cls:"mod-cta"}).addEventListener("click",()=>{this.close(),this.onConfirm(!0)}),J.createEl("button",{text:"Save Name Only"}).addEventListener("click",()=>{this.close(),this.onConfirm(!1)}),J.createEl("button",{text:"Cancel Action"}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:G}=this;G.empty()}}class g extends dt.Modal{constructor(G,J,K,ne){super(G);this.account=J;this.onConfirm=K;this.onCancel=ne}onOpen(){let{contentEl:G}=this;G.createEl("h3",{text:"Delete Account"}),G.createEl("p",{text:`Are you sure you want to delete account "${this.account.name}"?`}),G.createEl("p",{text:"This action cannot be undone and all account data will be permanently lost.",cls:"warning"});let J=G.createDiv({cls:"modal-button-container"});J.createEl("button",{text:"Delete Account",cls:"mod-warning"}).addEventListener("click",()=>{this.close(),this.onConfirm(this.account)}),J.createEl("button",{text:"Cancel"}).addEventListener("click",()=>{this.close(),this.onCancel()})}onClose(){let{contentEl:G}=this;G.empty()}}class f extends dt.Modal{constructor(G,J,K,ne,te,oe){super(G);this.accountName=J;this.oldDate=K;this.newDate=ne;this.onConfirm=te;this.onCancel=oe}onOpen(){let{contentEl:G}=this;G.createEl("h3",{text:"Change Creation Date"});let J=ne=>ne.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});G.createEl("p",{text:`You are about to change the creation date for account "${this.accountName}" from ${J(this.oldDate)} to ${J(this.newDate)}.`}),G.createEl("p",{text:"This will update the initial deposit transaction date and may affect account age calculations, monthly billing cycles, and other date-based metrics.",cls:"warning"});let K=G.createDiv({cls:"modal-button-container"});K.createEl("button",{text:"Update Creation Date",cls:"mod-cta"}).addEventListener("click",()=>{this.close(),this.onConfirm()}),K.createEl("button",{text:"Cancel"}).addEventListener("click",()=>{this.close(),this.onCancel()})}onClose(){let{contentEl:G}=this;G.empty()}}let[y,h]=(0,z.useState)(!1),[v,b]=(0,z.useState)(null),[w,k]=(0,z.useState)(!1),[S,x]=(0,z.useState)({name:"",accountType:"demo",initialBalance:1e4,drawdownType:"none",drawdownAmount:0,hasProfitTarget:!1,profitTarget:0,profitTargetType:"absolute",profitTargetDate:null,monthlyCost:0,createdDate:new Date}),[T,E]=(0,z.useState)(null),[C,N]=(0,z.useState)({name:"",accountType:"demo",drawdownType:"none",drawdownAmount:0,hasProfitTarget:!1,profitTarget:0,profitTargetType:"absolute",profitTargetDate:null,monthlyCost:0,createdDate:new Date});(0,z.useEffect)(()=>{c&&q(c)},[c]),(0,z.useEffect)(()=>{let R=()=>{r(e.authManager.getAuthState()),i(e.authManager.getSubscriptionTier()),a(e.authManager.isAuthenticated())};return hc.on(vc.STATE_CHANGED,R),()=>{hc.off(vc.STATE_CHANGED,R)}},[e]),(0,z.useEffect)(()=>{let R=()=>{if(e.optionsService){let G=e.optionsService.getOptions("account_type");p(G)}};R();let V=()=>R();return document.addEventListener("journalit-options-changed",V),()=>{document.removeEventListener("journalit-options-changed",V)}},[e.optionsService]),(0,z.useEffect)(()=>{let R=async()=>{try{if(h(!0),b(null),!e.accountService)throw new Error("Account service not initialized");let K=await e.accountService.getAllAccounts();l(K)}catch(K){console.error("Error loading accounts:",K),b(`Error loading accounts: ${K.message}`)}finally{h(!1)}};R();let V=()=>R(),G=()=>R(),J=()=>R();return document.addEventListener("journalit:account-created",V),document.addEventListener("journalit:account-updated",G),document.addEventListener("journalit:account-deleted",J),()=>{document.removeEventListener("journalit:account-created",V),document.removeEventListener("journalit:account-updated",G),document.removeEventListener("journalit:account-deleted",J)}},[e]);let D=async()=>{if(!o)try{await e.authManager.authenticate()}catch(R){new dt.Notice("Authentication failed. Please try again.")}},A=async()=>{try{await e.authManager.logout(),new dt.Notice("Successfully signed out")}catch(R){new dt.Notice("Failed to sign out. Please try again.")}},P=R=>{switch(R){case"enterprise":return"Enterprise Plan: Access to all features including custom implementation and direct support.";case"premium":return"Premium Plan: Advanced features including broker integration, AI journal reviews, and custom layouts.";case"free":return"Free Plan: Core features including basic dashboard, essential metrics, and trade tracking.";default:return"Subscription status unknown."}},I=()=>{var R;if((R=t.cache)!=null&&R.graceEnd){let V=new Date(t.cache.graceEnd);return Math.ceil((V.getTime()-Date.now())/(1e3*60*60*24))}return 0},M=s.reduce((R,V)=>{let G=V.accountType.toLowerCase();return R[G]||(R[G]=[]),R[G].push(V),R},{}),O={};Object.entries(M).forEach(([R,V])=>{let G=V[0].accountType;O[G]=V});let F=R=>{E(R);let V;try{R.createdDate instanceof Date?V=R.createdDate:R.createdDate?(V=new Date(R.createdDate),isNaN(V.getTime())&&(console.error("Invalid date from account:",R.createdDate),V=new Date)):V=new Date}catch(G){console.error("Error parsing createdDate:",G,R.createdDate),V=new Date}N({name:R.name,accountType:R.accountType,drawdownType:R.drawdownType,drawdownAmount:R.drawdownAmount,hasProfitTarget:R.hasProfitTarget,profitTarget:R.profitTarget,profitTargetType:R.profitTargetType||"absolute",profitTargetDate:R.profitTargetDate||null,monthlyCost:R.monthlyCost||0,createdDate:V})},L=()=>{E(null)},B=async R=>{try{if(!T){console.error("Attempted to update account but editingAccount is null");return}let V=new Date(T.createdDate),G=new Date(C.createdDate);V.setHours(0,0,0,0),G.setHours(0,0,0,0),V.getTime()!==G.getTime()?new f(e.app,T.name,V,G,async()=>{await j(R,!0)},()=>{C.createdDate=T.createdDate,j(R,!1)}).open():await j(R,!1)}catch(V){console.error("Error in performUpdate:",V),new dt.Notice(`Error updating account: ${V.message}`)}},j=async(R,V)=>{try{if(!T)return;let G={name:C.name,accountType:C.accountType,drawdownType:C.drawdownType,drawdownAmount:C.drawdownAmount,hasProfitTarget:C.hasProfitTarget,profitTarget:C.profitTarget,profitTargetType:C.profitTargetType,profitTargetDate:C.profitTargetDate||void 0,monthlyCost:C.monthlyCost};V&&(G.createdDate=C.createdDate),await e.accountService.updateAccount(T.id,G),R&&T.name!==C.name&&e.optionsService&&await e.optionsService.updateOption("account",T.name,C.name,!0),R&&T.name!==C.name?new dt.Notice(`Account "${T.name}" updated to "${C.name}" and all references updated`):new dt.Notice(`Account "${C.name}" updated successfully`),E(null)}catch(G){console.error("Error updating account:",G),new dt.Notice(`Error updating account: ${G.message}`)}},_=async()=>{try{if(!C.name){new dt.Notice("Account name is required");return}if(C.drawdownType!=="none"&&C.drawdownAmount<=0){new dt.Notice("Drawdown amount must be greater than 0 when drawdown is enabled");return}if(!T)return;if(T.name!==C.name){let V=`Do you want to update all existing notes that use account "${T.name}" to use "${C.name}" instead?

This will search through all notes and update the account reference wherever it's found.`;new m(e.app,V,G=>{B(G)}).open()}else B(!1)}catch(R){console.error("Error updating account:",R),new dt.Notice(`Error updating account: ${R.message}`)}},H=async R=>{try{await e.app.vault.adapter.exists(R.notePath)||(await e.accountService.ensureAccountFolder(R.accountType),await e.accountService.recreateAccountNote(R),new dt.Notice(`Created account note for ${R.name}`)),await e.app.workspace.openLinkText(R.notePath,"",!0)}catch(V){console.error("Error opening account note:",V),new dt.Notice(`Error opening account: ${V.message}`)}},q=async R=>{try{new g(e.app,R,async V=>{try{await e.accountService.deleteAccount(V.id),new dt.Notice(`Account "${V.name}" deleted successfully`),d(null)}catch(G){console.error("Error deleting account:",G),new dt.Notice(`Error deleting account: ${G.message}`)}},()=>d(null)).open()}catch(V){console.error("Error showing delete confirmation:",V),new dt.Notice(`Error showing delete confirmation: ${V.message}`),d(null)}},X=async()=>{try{if(!S.name){new dt.Notice("Account name is required");return}if(S.initialBalance<=0){new dt.Notice("Initial balance must be greater than 0");return}if(S.drawdownType!=="none"&&S.drawdownAmount<=0){new dt.Notice("Drawdown amount must be greater than 0 when drawdown is enabled");return}let R=new Date;if(S.createdDate>R){new dt.Notice("Creation date cannot be in the future");return}let V=new Date(S.createdDate);V.setHours(0,0,0,0);let G={name:S.name,accountType:S.accountType,initialBalance:S.initialBalance,drawdownType:S.drawdownType,drawdownAmount:S.drawdownAmount,hasProfitTarget:S.hasProfitTarget,profitTarget:S.profitTarget,profitTargetType:S.profitTargetType,profitTargetDate:S.profitTargetDate||void 0,monthlyCost:S.monthlyCost,createdDate:V},J=await e.accountService.createAccount(G);new dt.Notice(`Account "${S.name}" created successfully`),x({name:"",accountType:"demo",initialBalance:1e4,drawdownType:"none",drawdownAmount:0,hasProfitTarget:!1,profitTarget:0,profitTargetType:"absolute",profitTargetDate:null,monthlyCost:0,createdDate:new Date}),k(!1),await e.app.workspace.openLinkText(J,"",!0)}catch(R){console.error("Error creating account:",R),new dt.Notice(`Error creating account: ${R.message}`)}},U=R=>R.split("_").map(V=>V.charAt(0).toUpperCase()+V.slice(1).toLowerCase()).join(" ");return z.default.createElement("div",{className:"journalit-settings-tab accounts-settings"},z.default.createElement("h3",null,"Accounts & Integration"),z.default.createElement("p",{className:"setting-item-description"},"Manage authentication and account integration settings."),z.default.createElement(ar,{title:"Authentication",defaultExpanded:!0},z.default.createElement("div",{className:"setting-item"},z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},"Status"),z.default.createElement("div",{className:"setting-item-description"},"Current connection and subscription status")),z.default.createElement("div",{className:"setting-item-control"},z.default.createElement("input",{type:"text",value:`${t.isOffline?"Offline (Grace Period)":"Online"}${n?` - ${n.charAt(0).toUpperCase()+n.slice(1)} Plan`:""}`,disabled:!0,className:"status-text"}))),z.default.createElement("div",{className:"setting-item"},z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},"Authentication"),z.default.createElement("div",{className:"setting-item-description"},"Sign in to access your trading journal")),z.default.createElement("div",{className:"setting-item-control"},z.default.createElement(be,{variant:"primary",onClick:D,className:o?"connected":"login-button"},o?"Signed In":"Sign In / Sign Up"))),o&&z.default.createElement("div",{className:"setting-item"},z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},"Sign Out"),z.default.createElement("div",{className:"setting-item-description"},"Sign out of your account")),z.default.createElement("div",{className:"setting-item-control"},z.default.createElement(be,{variant:"danger",onClick:A,className:"signout"},"Sign Out"))),o&&n&&z.default.createElement(z.default.Fragment,null,z.default.createElement("h4",null,"Subscription Features"),z.default.createElement("div",{className:"setting-item-description subscription-desc"},P(n))),t.error&&z.default.createElement("div",{className:"trading-journal-error"},"Error: ",t.error),t.isOffline&&z.default.createElement("div",{className:"trading-journal-warning"},z.default.createElement("strong",null,"Offline Mode"),z.default.createElement("p",null,"Operating in offline mode. Some features may be limited. Will automatically sync when online."),((Y=t.cache)==null?void 0:Y.graceEnd)&&z.default.createElement("p",null,"Grace period ends in ",I()," days"))),z.default.createElement(ar,{title:"Account Types",defaultExpanded:!1},z.default.createElement("div",{className:"setting-item"},z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},"Custom Account Types"),z.default.createElement("div",{className:"setting-item-description"},"Add, edit, or remove custom account types for your trading accounts.")),z.default.createElement("div",{className:"setting-item-control"},z.default.createElement(be,{variant:"primary",onClick:()=>{new dt.Notice("To manage account types, go to Settings \u2192 Customisation \u2192 Custom Options \u2192 Account Types")}},"Manage Account Types"))),z.default.createElement("div",{className:"setting-item"},z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},"Available Account Types"),z.default.createElement("div",{className:"setting-item-description"},"Currently available account types that can be used when creating accounts.")),z.default.createElement("div",{className:"setting-item-control"},z.default.createElement("div",{className:"available-account-types"},u.length>0?z.default.createElement("div",{style:{display:"flex",flexWrap:"wrap",gap:"8px"}},u.map(R=>z.default.createElement("div",{key:R,style:{padding:"4px 8px",borderRadius:"4px",backgroundColor:"var(--background-secondary)",color:"var(--text-normal)",fontSize:"12px"}},U(R)))):z.default.createElement("div",{style:{color:"var(--text-muted)"}},"No custom account types defined. Default types will be used.")))),z.default.createElement("div",{className:"setting-item"},z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},"Account Types in Dashboard Calculations"),z.default.createElement("div",{className:"setting-item-description"},"Choose which account types to include in dashboard metrics and whether to include withdrawals from excluded accounts. Excluded account types will not be counted in total balance, growth, or trade metrics.")),z.default.createElement("div",{className:"setting-item-control"},z.default.createElement("div",{className:"account-types-table-container"},u.length>0?z.default.createElement("table",{className:"account-types-table"},z.default.createElement("thead",null,z.default.createElement("tr",null,z.default.createElement("th",null,"Account Type"),z.default.createElement("th",null,"Include in Dashboard"),z.default.createElement("th",null,"Include Withdrawals"))),z.default.createElement("tbody",null,u.map(R=>{var K,ne,te,oe,de,xe;let V=R.toLowerCase(),G=((te=(ne=(K=e.settings)==null?void 0:K.account)==null?void 0:ne.excludedAccountTypes)==null?void 0:te.includes(V))||!1,J=((xe=(de=(oe=e.settings)==null?void 0:oe.account)==null?void 0:de.includeWithdrawalsFromExcluded)==null?void 0:xe[V])||!1;return z.default.createElement("tr",{key:R},z.default.createElement("td",null,z.default.createElement("div",{className:"account-type-name"},U(R))),z.default.createElement("td",null,z.default.createElement("div",{className:"toggle-container"},z.default.createElement("input",{type:"checkbox",id:`include-${R}`,checked:!G,onChange:async je=>{var nt,Qe;try{let ze=[...((Qe=(nt=e.settings)==null?void 0:nt.account)==null?void 0:Qe.excludedAccountTypes)||[]],Rr=R.toLowerCase();if(!je.target.checked)ze.includes(Rr)||ze.push(Rr);else{let nr=ze.indexOf(Rr);nr!==-1&&ze.splice(nr,1)}e.settings.account||(e.settings.account={defaultAccountType:"demo",defaultDrawdownType:"none",defaultDrawdownAmount:0,showBalanceInDashboard:!0,excludedAccountTypes:[],includeWithdrawalsFromExcluded:{}}),e.settings.account.excludedAccountTypes=ze,await e.saveSettings(),je.target.checked?new dt.Notice(`${U(R)} accounts will now be included in dashboard metrics.`):new dt.Notice(`${U(R)} accounts will now be excluded from dashboard metrics.`)}catch(ze){console.error("Error updating excluded account types:",ze),new dt.Notice(`Error updating settings: ${ze.message}`)}},className:"toggle-checkbox"}),z.default.createElement("label",{htmlFor:`include-${R}`,className:"toggle-switch"}))),z.default.createElement("td",null,z.default.createElement("div",{className:"toggle-container"},z.default.createElement("input",{type:"checkbox",id:`include-withdrawals-${R}`,checked:J,disabled:!G,onChange:async je=>{var nt,Qe;try{let ze={...((Qe=(nt=e.settings)==null?void 0:nt.account)==null?void 0:Qe.includeWithdrawalsFromExcluded)||{}};ze[V]=je.target.checked,e.settings.account||(e.settings.account={defaultAccountType:"demo",defaultDrawdownType:"none",defaultDrawdownAmount:0,showBalanceInDashboard:!0,excludedAccountTypes:[],includeWithdrawalsFromExcluded:{}}),e.settings.account.includeWithdrawalsFromExcluded=ze,await e.saveSettings(),je.target.checked?new dt.Notice(`Withdrawals from ${U(R)} accounts will be included in total withdrawals.`):new dt.Notice(`Withdrawals from ${U(R)} accounts will be excluded from total withdrawals.`)}catch(ze){console.error("Error updating withdrawal inclusion settings:",ze),new dt.Notice(`Error updating settings: ${ze.message}`)}},className:"toggle-checkbox"}),z.default.createElement("label",{htmlFor:`include-withdrawals-${R}`,className:"toggle-switch"}))))}))):z.default.createElement("div",{style:{color:"var(--text-muted)"}},"No account types available to configure.")))),z.default.createElement("div",{className:"setting-item"},z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},"Dashboard Display Order"),z.default.createElement("div",{className:"setting-item-description"},"Control the order in which account types appear in the Account Dashboard. Use the arrow buttons to move account types up or down in the list.")),z.default.createElement("div",{className:"setting-item-control"},z.default.createElement("div",{className:"account-type-order-container"},(()=>{var ne,te;let R=((te=(ne=e.settings)==null?void 0:ne.account)==null?void 0:te.accountTypeOrder)||["funded","evaluation","demo","archived"],V=[...new Set([...u.map(oe=>oe.toLowerCase()),...R.map(oe=>oe.toLowerCase())])],G=new Map;u.forEach(oe=>G.set(oe.toLowerCase(),oe)),R.forEach(oe=>{G.has(oe.toLowerCase())||G.set(oe.toLowerCase(),oe.charAt(0).toUpperCase()+oe.slice(1))});let J=[];R.forEach(oe=>{if(V.includes(oe.toLowerCase())){let de=G.get(oe.toLowerCase());de&&J.push(de)}}),V.forEach(oe=>{if(!R.map(de=>de.toLowerCase()).includes(oe)){let de=G.get(oe);de&&J.push(de)}});let K=async(oe,de)=>{let xe=[...J],je=de==="up"?oe-1:oe+1;je>=0&&je<xe.length&&([xe[oe],xe[je]]=[xe[je],xe[oe]],e.settings.account||(e.settings.account={defaultAccountType:"demo",defaultDrawdownType:"none",defaultDrawdownAmount:0,showBalanceInDashboard:!0,excludedAccountTypes:[],includeWithdrawalsFromExcluded:{},accountTypeOrder:[]}),e.settings.account.accountTypeOrder=xe.map(nt=>nt.toLowerCase()),await e.saveSettings(),p([...u]),new dt.Notice(`Moved ${U(J[oe])} ${de}`))};return z.default.createElement("div",{className:"account-type-order-list"},J.length>0?z.default.createElement("div",{className:"order-list"},J.map((oe,de)=>z.default.createElement("div",{key:oe,className:"order-list-item"},z.default.createElement("span",{className:"type-name"},U(oe)),z.default.createElement("div",{className:"order-controls"},z.default.createElement("button",{className:"order-button",disabled:de===0,onClick:()=>K(de,"up"),"aria-label":`Move ${oe} up`,title:"Move up"},"\u2191"),z.default.createElement("button",{className:"order-button",disabled:de===J.length-1,onClick:()=>K(de,"down"),"aria-label":`Move ${oe} down`,title:"Move down"},"\u2193"))))):z.default.createElement("div",{style:{color:"var(--text-muted)"}},"No account types available to order."))})())))),z.default.createElement(ar,{title:"Trading Accounts",defaultExpanded:!0},v&&z.default.createElement("div",{className:"trading-journal-error"},v),y?z.default.createElement("div",{className:"loading"},"Loading accounts..."):s.length===0?z.default.createElement("div",{className:"no-accounts"},z.default.createElement("p",null,"No trading accounts found."),z.default.createElement("p",null,"Create an account to start tracking your trading performance.")):z.default.createElement("div",{className:"accounts-list"},Object.entries(O).map(([R,V])=>z.default.createElement("div",{key:R,className:"account-group"},z.default.createElement("h4",null,U(R)," Accounts"),z.default.createElement("div",{className:"account-items"},V.map(G=>z.default.createElement("div",{key:G.id,className:"account-item setting-item"},T&&T.id===G.id?z.default.createElement("div",{className:"edit-account-form setting-item-container"},z.default.createElement("h4",null,"Edit Account"),z.default.createElement("div",{className:"setting-item"},z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},"Account Name"),z.default.createElement("div",{className:"setting-item-description"},"Enter a name for your trading account")),z.default.createElement("div",{className:"setting-item-control"},z.default.createElement("input",{type:"text",value:C.name,onChange:J=>N({...C,name:J.target.value}),placeholder:"My Trading Account"}))),z.default.createElement("div",{className:"setting-item"},z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},"Account Type"),z.default.createElement("div",{className:"setting-item-description"},"Select the type of trading account")),z.default.createElement("div",{className:"setting-item-control"},z.default.createElement("select",{value:C.accountType,onChange:J=>N({...C,accountType:J.target.value})},u.length>0?u.map(J=>z.default.createElement("option",{key:J,value:J},U(J))):z.default.createElement(z.default.Fragment,null,z.default.createElement("option",{value:"demo"},"Demo"),z.default.createElement("option",{value:"evaluation"},"Evaluation"),z.default.createElement("option",{value:"funded"},"Funded"))))),z.default.createElement("div",{className:"setting-item"},z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},"Initial Balance"),z.default.createElement("div",{className:"setting-item-description"},"Initial balance cannot be changed after creation")),z.default.createElement("div",{className:"setting-item-control"},z.default.createElement("input",{type:"text",value:Wt(T.initialBalance),disabled:!0,className:"disabled-input"}))),z.default.createElement("div",{className:"setting-item"},z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},"Creation Date"),z.default.createElement("div",{className:"setting-item-description"},"Date when this account was created")),z.default.createElement("div",{className:"setting-item-control"},z.default.createElement("input",{type:"date",value:(()=>{try{return(C.createdDate instanceof Date?C.createdDate:new Date(C.createdDate)).toISOString().split("T")[0]}catch(J){return console.error("Error formatting date for input:",J),new Date().toISOString().split("T")[0]}})(),onChange:J=>{if(!J.target.value)return;let K=new Date(J.target.value);if(K>new Date){new dt.Notice("Creation date cannot be in the future");return}K.setHours(0,0,0,0),N({...C,createdDate:K})},max:new Date().toISOString().split("T")[0]}))),z.default.createElement("div",{className:"setting-item"},z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},"Drawdown Type"),z.default.createElement("div",{className:"setting-item-description"},"Select how drawdown should be calculated for this account",z.default.createElement("div",{className:"setting-item-description-detail"},z.default.createElement("strong",null,"None:")," No drawdown tracking",z.default.createElement("br",null),z.default.createElement("strong",null,"Fixed:")," Fixed drawdown limit that never changes",z.default.createElement("br",null),z.default.createElement("strong",null,"EOD Trailing:")," Trailing drawdown that updates at end of day"))),z.default.createElement("div",{className:"setting-item-control"},z.default.createElement("select",{value:C.drawdownType,onChange:J=>{let K=J.target.value,ne=K!=="none"&&C.drawdownType==="none"?Math.round(T.initialBalance*.1):C.drawdownAmount;N({...C,drawdownType:K,drawdownAmount:K==="none"?0:ne})}},z.default.createElement("option",{value:"none"},"None"),z.default.createElement("option",{value:"fixed"},"Fixed"),z.default.createElement("option",{value:"eod_trailing"},"EOD Trailing")))),C.drawdownType!=="none"&&z.default.createElement("div",{className:"setting-item"},z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},"Drawdown Amount"),z.default.createElement("div",{className:"setting-item-description"},"Maximum drawdown allowed before hitting account limit")),z.default.createElement("div",{className:"setting-item-control"},z.default.createElement("input",{type:"number",value:C.drawdownAmount,onChange:J=>N({...C,drawdownAmount:parseFloat(J.target.value)||0}),min:"0",step:"100"}))),z.default.createElement("div",{className:"setting-item"},z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},"Enable Profit Target"),z.default.createElement("div",{className:"setting-item-description"},"Set a profit target for this account")),z.default.createElement("div",{className:"setting-item-control"},z.default.createElement("input",{type:"checkbox",checked:C.hasProfitTarget,onChange:J=>N({...C,hasProfitTarget:J.target.checked})}))),C.hasProfitTarget&&z.default.createElement(z.default.Fragment,null,z.default.createElement("div",{className:"setting-item"},z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},"Target Type"),z.default.createElement("div",{className:"setting-item-description"},"Select whether the target is an absolute amount or percentage of initial balance")),z.default.createElement("div",{className:"setting-item-control"},z.default.createElement("select",{value:C.profitTargetType,onChange:J=>N({...C,profitTargetType:J.target.value})},z.default.createElement("option",{value:"absolute"},"Absolute Amount"),z.default.createElement("option",{value:"percentage"},"Percentage of Initial Balance")))),z.default.createElement("div",{className:"setting-item"},z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},"Profit Target ",C.profitTargetType==="percentage"?"(%)":""),z.default.createElement("div",{className:"setting-item-description"},C.profitTargetType==="percentage"?"Target percentage of initial balance to achieve":"Target amount of profit to achieve")),z.default.createElement("div",{className:"setting-item-control"},z.default.createElement("input",{type:"number",value:C.profitTarget===0&&document.activeElement===document.querySelector('input[type="number"]:focus')?"":C.profitTarget,onChange:J=>N({...C,profitTarget:J.target.value===""?0:parseFloat(J.target.value)||0}),onFocus:J=>{C.profitTarget===0&&(J.target.value="")},min:"0",step:C.profitTargetType==="percentage"?"1":"100",placeholder:"0"}))),z.default.createElement("div",{className:"setting-item"},z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},"Target Date (Optional)"),z.default.createElement("div",{className:"setting-item-description"},"Optional date by which you want to achieve the profit target")),z.default.createElement("div",{className:"setting-item-control"},z.default.createElement("input",{type:"date",value:C.profitTargetDate?new Date(C.profitTargetDate).toISOString().split("T")[0]:"",onChange:J=>N({...C,profitTargetDate:J.target.value?new Date(J.target.value):null})})))),z.default.createElement("div",{className:"setting-item"},z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},"Monthly Cost"),z.default.createElement("div",{className:"setting-item-description"},"Optional monthly cost for this account (e.g. subscription fees, platform costs)")),z.default.createElement("div",{className:"setting-item-control"},z.default.createElement("input",{type:"number",value:C.monthlyCost===0&&document.activeElement===document.querySelector('input[type="number"]:focus')?"":C.monthlyCost,onChange:J=>N({...C,monthlyCost:J.target.value===""?0:parseFloat(J.target.value)||0}),onFocus:J=>{C.monthlyCost===0&&(J.target.value="")},min:"0",step:"1",placeholder:"0"}))),z.default.createElement("div",{className:"edit-account-buttons"},z.default.createElement(be,{variant:"primary",onClick:_,className:"save-account-button"},"Save Changes"),z.default.createElement(be,{variant:"secondary",onClick:L,className:"cancel-button"},"Cancel"))):z.default.createElement(z.default.Fragment,null,z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},G.name),z.default.createElement("div",{className:"setting-item-description"},"Balance: ",Wt(G.currentBalance))),z.default.createElement("div",{className:"setting-item-control account-buttons"},z.default.createElement(be,{variant:"primary",onClick:()=>H(G),className:"open-account"},"Open"),z.default.createElement(be,{variant:"secondary",onClick:()=>F(G),className:"edit-account"},"Edit"),z.default.createElement(be,{variant:"danger",onClick:()=>d(G),className:"delete-account"},"Delete"))))))))),z.default.createElement("div",{className:"new-account-section"},w?z.default.createElement("div",{className:"new-account-form"},z.default.createElement("h4",null,"Create New Account"),z.default.createElement("div",{className:"setting-item"},z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},"Account Name"),z.default.createElement("div",{className:"setting-item-description"},"Enter a name for your trading account")),z.default.createElement("div",{className:"setting-item-control"},z.default.createElement("input",{type:"text",value:S.name,onChange:R=>x({...S,name:R.target.value}),placeholder:"My Trading Account"}))),z.default.createElement("div",{className:"setting-item"},z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},"Account Type"),z.default.createElement("div",{className:"setting-item-description"},"Select the type of trading account")),z.default.createElement("div",{className:"setting-item-control"},z.default.createElement("select",{value:S.accountType,onChange:R=>x({...S,accountType:R.target.value})},u.length>0?u.map(R=>z.default.createElement("option",{key:R,value:R},U(R))):z.default.createElement(z.default.Fragment,null,z.default.createElement("option",{value:"demo"},"Demo"),z.default.createElement("option",{value:"evaluation"},"Evaluation"),z.default.createElement("option",{value:"funded"},"Funded"))))),z.default.createElement("div",{className:"setting-item"},z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},"Initial Balance"),z.default.createElement("div",{className:"setting-item-description"},"Enter the starting balance for this account")),z.default.createElement("div",{className:"setting-item-control"},z.default.createElement("input",{type:"number",value:S.initialBalance,onChange:R=>x({...S,initialBalance:parseFloat(R.target.value)||0}),min:"0",step:"1000"}))),z.default.createElement("div",{className:"setting-item"},z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},"Creation Date"),z.default.createElement("div",{className:"setting-item-description"},"Date when this account was created (defaults to today)")),z.default.createElement("div",{className:"setting-item-control"},z.default.createElement("input",{type:"date",value:(()=>{try{return(S.createdDate instanceof Date?S.createdDate:new Date(S.createdDate)).toISOString().split("T")[0]}catch(R){return console.error("Error formatting date for input:",R),new Date().toISOString().split("T")[0]}})(),onChange:R=>{let V=R.target.value?new Date(R.target.value):new Date;if(V>new Date){new dt.Notice("Creation date cannot be in the future");return}V.setHours(0,0,0,0),x({...S,createdDate:V})},max:new Date().toISOString().split("T")[0]}))),z.default.createElement("div",{className:"setting-item"},z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},"Drawdown Type"),z.default.createElement("div",{className:"setting-item-description"},"Select how drawdown should be calculated for this account",z.default.createElement("div",{className:"setting-item-description-detail"},z.default.createElement("strong",null,"None:")," No drawdown tracking",z.default.createElement("br",null),z.default.createElement("strong",null,"Fixed:")," Fixed drawdown limit that never changes",z.default.createElement("br",null),z.default.createElement("strong",null,"EOD Trailing:")," Trailing drawdown that updates at end of day"))),z.default.createElement("div",{className:"setting-item-control"},z.default.createElement("select",{value:S.drawdownType,onChange:R=>{let V=R.target.value,G=V!=="none"&&S.drawdownType==="none"?Math.round(S.initialBalance*.1):S.drawdownAmount;x({...S,drawdownType:V,drawdownAmount:V==="none"?0:G})}},z.default.createElement("option",{value:"none"},"None"),z.default.createElement("option",{value:"fixed"},"Fixed"),z.default.createElement("option",{value:"eod_trailing"},"EOD Trailing")))),S.drawdownType!=="none"&&z.default.createElement("div",{className:"setting-item"},z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},"Drawdown Amount"),z.default.createElement("div",{className:"setting-item-description"},"Maximum drawdown allowed before hitting account limit")),z.default.createElement("div",{className:"setting-item-control"},z.default.createElement("input",{type:"number",value:S.drawdownAmount,onChange:R=>x({...S,drawdownAmount:parseFloat(R.target.value)||0}),min:"0",step:"100"}))),z.default.createElement("div",{className:"setting-item"},z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},"Enable Profit Target"),z.default.createElement("div",{className:"setting-item-description"},"Set a profit target for this account")),z.default.createElement("div",{className:"setting-item-control"},z.default.createElement("input",{type:"checkbox",checked:S.hasProfitTarget,onChange:R=>x({...S,hasProfitTarget:R.target.checked})}))),S.hasProfitTarget&&z.default.createElement(z.default.Fragment,null,z.default.createElement("div",{className:"setting-item"},z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},"Target Type"),z.default.createElement("div",{className:"setting-item-description"},"Select whether the target is an absolute amount or percentage of initial balance")),z.default.createElement("div",{className:"setting-item-control"},z.default.createElement("select",{value:S.profitTargetType,onChange:R=>x({...S,profitTargetType:R.target.value})},z.default.createElement("option",{value:"absolute"},"Absolute Amount"),z.default.createElement("option",{value:"percentage"},"Percentage of Initial Balance")))),z.default.createElement("div",{className:"setting-item"},z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},"Profit Target ",S.profitTargetType==="percentage"?"(%)":""),z.default.createElement("div",{className:"setting-item-description"},S.profitTargetType==="percentage"?"Target percentage of initial balance to achieve":"Target amount of profit to achieve")),z.default.createElement("div",{className:"setting-item-control"},z.default.createElement("input",{type:"number",value:S.profitTarget===0&&document.activeElement===document.querySelector('input[type="number"]:focus')?"":S.profitTarget,onChange:R=>x({...S,profitTarget:R.target.value===""?0:parseFloat(R.target.value)||0}),onFocus:R=>{S.profitTarget===0&&(R.target.value="")},min:"0",step:S.profitTargetType==="percentage"?"1":"100",placeholder:"0"}))),z.default.createElement("div",{className:"setting-item"},z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},"Target Date (Optional)"),z.default.createElement("div",{className:"setting-item-description"},"Optional date by which you want to achieve the profit target")),z.default.createElement("div",{className:"setting-item-control"},z.default.createElement("input",{type:"date",value:S.profitTargetDate?new Date(S.profitTargetDate).toISOString().split("T")[0]:"",onChange:R=>x({...S,profitTargetDate:R.target.value?new Date(R.target.value):null})})))),z.default.createElement("div",{className:"setting-item"},z.default.createElement("div",{className:"setting-item-info"},z.default.createElement("div",{className:"setting-item-name"},"Monthly Cost"),z.default.createElement("div",{className:"setting-item-description"},"Optional monthly cost for this account (e.g. subscription fees, platform costs)")),z.default.createElement("div",{className:"setting-item-control"},z.default.createElement("input",{type:"number",value:S.monthlyCost===0&&document.activeElement===document.querySelector('input[type="number"]:focus')?"":S.monthlyCost,onChange:R=>x({...S,monthlyCost:R.target.value===""?0:parseFloat(R.target.value)||0}),onFocus:R=>{S.monthlyCost===0&&(R.target.value="")},min:"0",step:"1",placeholder:"0"}))),z.default.createElement("div",{className:"new-account-buttons"},z.default.createElement(be,{variant:"primary",onClick:X,className:"create-account-button"},"Create Account"),z.default.createElement(be,{variant:"secondary",onClick:()=>k(!1),className:"cancel-button"},"Cancel"))):z.default.createElement(be,{variant:"primary",onClick:()=>k(!0),className:"new-account-button"},"Create New Account"))))};var Pi=$(W());var ie=$(W()),mr=require("obsidian");var yc=(a=>(a.STOCK="stock",a.OPTIONS="options",a.FUTURES="futures",a.FOREX="forex",a.CRYPTO="crypto",a.CFD="cfd",a))(yc||{}),M2={entries:[{time:new Date,price:0,size:0}],exits:[{time:new Date,price:0,size:0}],entryTime:new Date,exitTime:new Date,entryPrice:0,exitPrice:0,positionSize:0,direction:"",instrument:"",assetType:"",setupIds:[],mistakeIds:[],accountIds:[],thesis:"",images:[],ctags:[],tags:[],setup:[],mistake:[],account:[],filePath:"",pnl:0,useDirectPnLInput:!1,directPnL:0,commission:0,swap:0,fees:0,exchange:"",expirationDate:new Date,strikePrice:0,optionType:"call",contractSize:100,contractSymbol:"",dollarPerPoint:0,tickSize:0,tickValue:0,currencyPair:"",lotSize:0,pipValue:0,tradingPair:"",cryptoExchange:"",leverageRatio:0,isMissedTrade:!1,missedReason:""};Ci();var FC=class extends mr.Modal{constructor(r,n,i){super(r);this.message=n;this.onConfirm=i}onOpen(){let{contentEl:r}=this;r.createEl("p",{text:this.message});let n=r.createDiv({cls:"modal-button-container"});n.createEl("button",{text:"OK (Update Notes)",cls:"mod-cta"}).addEventListener("click",()=>{this.close(),this.onConfirm(!0)}),n.createEl("button",{text:"Save Name Only"}).addEventListener("click",()=>{this.close(),this.onConfirm(!1)}),n.createEl("button",{text:"Cancel Action"}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:r}=this;r.empty()}},$b=class extends mr.Modal{constructor(r,n,i){super(r);this.message=n;this.onConfirm=i}onOpen(){let{contentEl:r}=this;r.createEl("p",{text:this.message});let n=r.createDiv({cls:"modal-button-container"});n.createEl("button",{text:"Reset",cls:"mod-warning"}).addEventListener("click",()=>{this.close(),this.onConfirm()}),n.createEl("button",{text:"Cancel"}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:r}=this;r.empty()}},O2=({plugin:e})=>{let[t,r]=(0,ie.useState)({}),[n,i]=(0,ie.useState)({}),[o,a]=(0,ie.useState)(e.optionsService),[s,l]=(0,ie.useState)({}),[c,d]=(0,ie.useState)("stock");(0,ie.useEffect)(()=>{(async()=>{await o.reloadOptions();let T=o.getAllOptions();r(T);let E={};Object.entries(T).forEach(([C,N])=>{E[C]={},C==="instrument"?N.forEach(D=>{E[C][D.name]={text:D.name,isEditing:!1,editValue:D.name,editAssetType:D.assetType}}):C==="event"?N.forEach(D=>{E[C][D.name]={text:D.name,isEditing:!1,editValue:D.name}}):N.forEach(D=>{E[C][D]={text:D,isEditing:!1,editValue:D}})}),i(E)})()},[e,o]);let u=x=>{switch(x){case"instrument":return"Tickers";case"account":return"Accounts";case"account_type":return"Account Types";case"setup":return"Setups";case"mistake":return"Mistakes";case"tag":return"Tags";case"event":return"Events";default:return x}},p=x=>{switch(x){case"stock":return"Stock";case"options":return"Options";case"futures":return"Futures";case"forex":return"Forex";case"crypto":return"Crypto";case"cfd":return"CFD";default:return x.charAt(0).toUpperCase()+x.slice(1)}},m=(x,T)=>{i(E=>{let C=E[x]||{},N=C[T]||{text:T,isEditing:!1,editValue:T},D;if(x==="instrument"){let A=t.instrument.find(P=>P.name===T);D=(A==null?void 0:A.assetType)||"stock"}return{...E,[x]:{...C,[T]:{...N,isEditing:!0,editValue:T,editAssetType:D}}}}),setTimeout(()=>{let E=document.querySelector(`.option-edit-input[data-option="${CSS.escape(T)}"]`);E&&(E.focus(),E.select())},50)},g=(x,T)=>{i(E=>{let C=E[x]||{},N=C[T];return N?{...E,[x]:{...C,[T]:{...N,isEditing:!1}}}:E})},f=()=>{try{document.activeElement instanceof HTMLElement&&document.activeElement.blur();let x=document.createElement("input");x.style.position="absolute",x.style.opacity="0",x.style.height="0",x.style.width="0",document.body.appendChild(x),requestAnimationFrame(()=>{x.focus(),requestAnimationFrame(()=>{x.blur(),document.body.contains(x)&&document.body.removeChild(x)})})}catch(x){console.error("Failed to reset focus state:",x)}},y=async x=>{var E;let T=(E=s[x])==null?void 0:E.trim();if(!T){new mr.Notice("Option name cannot be empty");return}f();try{let C=!1;if(x==="event"?C=await o.addOrUpdateEventOption(T,"gray"):x==="instrument"?C=await o.addOption(x,T,c):C=await o.addOption(x,T),C){new mr.Notice(`Added option "${T}" to ${u(x)}`),l(A=>({...A,[x]:""})),await o.reloadOptions();let N=o.getAllOptions();r(N);let D={};Object.entries(N).forEach(([A,P])=>{D[A]={},A==="instrument"?P.forEach(I=>{D[A][I.name]={text:I.name,isEditing:!1,editValue:I.name,editAssetType:I.assetType}}):A==="event"?P.forEach(I=>{D[A][I.name]={text:I.name,isEditing:!1,editValue:I.name}}):P.forEach(I=>{D[A][I]={text:I,isEditing:!1,editValue:I}})}),i(D)}else new mr.Notice(`Could not add option "${T}". It might already exist.`)}catch(C){console.error(`Failed to add option for type ${x}:`,C),new mr.Notice("An error occurred while adding the option.")}},h=(x,T,E)=>{i(C=>{let N=C[x]||{},D=N[T];return D?{...C,[x]:{...N,[T]:{...D,editValue:E}}}:(console.warn(`Initializing missing edit state for ${x} - ${T} during updateEditValue`),{...C,[x]:{...N,[T]:{text:T,isEditing:!0,editValue:E}}})})},v=(x,T,E)=>{x==="instrument"&&i(C=>{let N=C[x]||{},D=N[T];return D?{...C,[x]:{...N,[T]:{...D,editAssetType:E}}}:C})},b=async(x,T)=>{try{if(!n[x]||!n[x][T]){console.error(`Cannot save option: Edit state not found for type "${x}", key "${T}"`),new mr.Notice("Error saving option: State not found.");return}let E=n[x][T].editValue;if(!E||E.trim()===""){new mr.Notice("Option name cannot be empty");return}let C;if(x==="instrument"){if(C=n[x][T].editAssetType,!C){let D=t.instrument.find(A=>A.name===T);C=D==null?void 0:D.assetType}if(!C){new mr.Notice("Asset type is required for instruments");return}}let N=async D=>{f(),i(P=>{let I={...P[x]||{}},M=I[T];return M&&(delete I[T],I[E]={...M,text:E,isEditing:!1,editValue:E}),{...P,[x]:I}});let A;if(x==="instrument")if(C==="futures"){let P=o.getFuturesDataForInstrument(T);A=await o.updateInstrument(T,E,C,P,D)}else A=await o.updateInstrument(T,E,C,void 0,D);else A=await o.updateOption(x,T,E,D);if(A.success){await o.reloadOptions();let P=o.getAllOptions();r(P);let I={};Object.entries(P).forEach(([M,O])=>{I[M]={},M==="instrument"?O.forEach(F=>{var B,j,_;let L=M===x&&F.name===E?!1:(_=(j=(B=n[M])==null?void 0:B[F.name])==null?void 0:j.isEditing)!=null?_:!1;I[M][F.name]={text:F.name,isEditing:L,editValue:F.name,editAssetType:F.assetType}}):M==="event"?O.forEach(F=>{var B,j,_;let L=M===x&&F.name===E?!1:(_=(j=(B=n[M])==null?void 0:B[F.name])==null?void 0:j.isEditing)!=null?_:!1;I[M][F.name]={text:F.name,isEditing:L,editValue:F.name}}):O.forEach(F=>{var B,j,_;let L=M===x&&F===E?!1:(_=(j=(B=n[M])==null?void 0:B[F])==null?void 0:j.isEditing)!=null?_:!1;I[M][F]={text:F,isEditing:L,editValue:F}})}),i(I),D&&A.updatedNotes!==void 0?new mr.Notice(`Updated option from "${T}" to "${E}" and updated ${A.updatedNotes} notes`):new mr.Notice(`Updated option from "${T}" to "${E}"`)}else new mr.Notice(`Could not update - "${E}" already exists or is invalid`),i(P=>{var O,F;let I={...P[x]||{}};return I[E]?(delete I[E],I[T]={...((O=n[x])==null?void 0:O[T])||{text:T,editValue:T},isEditing:!0,editValue:E}):(F=P[x])!=null&&F[T]&&(I[T]={...P[x][T],isEditing:!0,editValue:E}),{...P,[x]:I}})};if(T!==E){let D=`Do you want to update all existing notes that use "${T}" to use "${E}" instead?

This will search through all notes and update the option value wherever it's found.`;new FC(e.app,D,A=>{N(A)}).open()}else if(x==="instrument"){let D=t.instrument.find(I=>I.name===T),A=D==null?void 0:D.assetType,P=n[x][T].editAssetType;A!==P?N(!1):i(I=>{var M;return{...I,[x]:{...I[x]||{},[T]:{...((M=I[x])==null?void 0:M[T])||{text:T,editValue:T},isEditing:!1}}}})}else i(D=>{var A;return{...D,[x]:{...D[x]||{},[T]:{...((A=D[x])==null?void 0:A[T])||{text:T,editValue:T},isEditing:!1}}}})}catch(E){console.error("Failed to update option:",E),new mr.Notice("Failed to update option"),i(C=>{var N;return{...C,[x]:{...C[x]||{},[T]:{...((N=C[x])==null?void 0:N[T])||{text:T,editValue:T},isEditing:!0}}}})}},w=async(x,T)=>{try{let E=`Are you sure you want to remove "${T}"? This cannot be undone.`;class C extends mr.Modal{constructor(A,P,I){super(A);this.message=P;this.onConfirm=I}onOpen(){let{contentEl:A}=this;A.createEl("p",{text:this.message});let P=A.createDiv({cls:"modal-button-container"});P.createEl("button",{text:"Delete",cls:"mod-warning"}).addEventListener("click",()=>{this.close(),this.onConfirm()}),P.createEl("button",{text:"Cancel"}).addEventListener("click",()=>{this.close()})}onClose(){let{contentEl:A}=this;A.empty()}}new C(e.app,E,async()=>{if(f(),await o.removeOption(x,T)){await o.reloadOptions();let D=o.getAllOptions();r(D);let A={};Object.entries(D).forEach(([P,I])=>{A[P]={},P==="instrument"?I.forEach(M=>{A[P][M.name]={text:M.name,isEditing:!1,editValue:M.name,editAssetType:M.assetType}}):P==="event"?I.forEach(M=>{A[P][M.name]={text:M.name,isEditing:!1,editValue:M.name}}):I.forEach(M=>{A[P][M]={text:M,isEditing:!1,editValue:M}})}),i(A),new mr.Notice(`Removed option "${T}"`)}else new mr.Notice(`Could not remove option "${T}"`)}).open()}catch(E){console.error("Failed to remove option:",E),new mr.Notice("Failed to remove option")}},k=async x=>{try{let T=`Are you sure you want to reset all custom ${u(x).toLowerCase()}? This cannot be undone.`;new $b(e.app,T,async()=>{f();let E=await o.clearOptions(x);if(E>0){await o.reloadOptions();let C=o.getAllOptions();r(C),i(N=>({...N,[x]:{}})),new mr.Notice(`Removed ${E} custom ${u(x).toLowerCase()}`)}else new mr.Notice(`No ${u(x).toLowerCase()} to remove`)}).open()}catch(T){console.error(`Failed to reset ${x} options:`,T),new mr.Notice(`Failed to reset ${u(x).toLowerCase()}`)}},S=async()=>{try{let x="Are you sure you want to reset all custom options? This cannot be undone.";new $b(e.app,x,async()=>{f(),await o.resetAllOptions(),await o.reloadOptions();let T=o.getAllOptions();r(T),i({}),new mr.Notice("All custom options have been reset")}).open()}catch(x){console.error("Failed to reset all options:",x),new mr.Notice("Failed to reset all options")}};return ie.default.createElement("div",{className:"journalit-settings-tab custom-options-settings",style:{maxHeight:"100%",overflowY:"visible"}},ie.default.createElement("div",{className:"custom-options-container"},Object.entries(t).filter(([x,T])=>x!=="account").map(([x,T])=>{var E;return ie.default.createElement("div",{key:x,className:"option-category"},ie.default.createElement("h3",null,u(x)),!T||T.length===0?ie.default.createElement("p",{className:"setting-item-description"},"No custom ",u(x).toLowerCase()," have been added yet."):ie.default.createElement("div",{className:"custom-options-container"},x==="instrument"?T.map((C,N)=>{var P;let D=C.name,A=(P=n[x])==null?void 0:P[D];return A?A.isEditing?ie.default.createElement("div",{key:`${x}-${D}-${N}`,className:"setting-item option-item"},ie.default.createElement("div",{className:"setting-item-control"},ie.default.createElement("div",{style:{display:"flex",gap:"8px",width:"100%"}},ie.default.createElement("input",{type:"text",value:A.editValue,onChange:I=>h(x,D,I.target.value),onKeyDown:I=>{I.key==="Enter"?(I.preventDefault(),b(x,D)):I.key==="Escape"&&(I.preventDefault(),g(x,D))},className:"option-edit-input","data-option":D,"aria-label":`Edit ${D}`,autoFocus:!0,style:{flex:"1"}}),ie.default.createElement("select",{value:A.editAssetType||C.assetType,onChange:I=>v(x,D,I.target.value),style:{width:"120px"}},Object.values(yc).map(I=>ie.default.createElement("option",{key:I,value:I},p(I))))),ie.default.createElement("div",{className:"option-actions"},ie.default.createElement(Gi,{label:"Save changes",onClick:()=>b(x,D)},ie.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}," ",ie.default.createElement("path",{d:"M5 12l5 5l10 -10"})," ")),ie.default.createElement(Gi,{label:"Cancel editing",onClick:()=>g(x,D)},ie.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}," ",ie.default.createElement("path",{d:"M18 6l-12 12"})," ",ie.default.createElement("path",{d:"M6 6l12 12"})," "))))):ie.default.createElement("div",{key:`${x}-${D}-${N}`,className:"setting-item option-item"},ie.default.createElement("div",{className:"setting-item-info"},ie.default.createElement("div",{style:{display:"flex",alignItems:"center"}},ie.default.createElement("div",{className:"setting-item-name"},D),ie.default.createElement("span",{style:{display:"inline-block",marginLeft:"8px",fontSize:"12px",color:"var(--text-muted)",padding:"2px 6px",borderRadius:"4px",backgroundColor:"var(--background-secondary)"}},p(C.assetType)))),ie.default.createElement("div",{className:"setting-item-control"},ie.default.createElement("div",{className:"option-actions"},ie.default.createElement(Gi,{label:`Edit ${D}`,onClick:()=>m(x,D)},ie.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}," ",ie.default.createElement("path",{d:"M17 3a2.85 2.85 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"})," ")),ie.default.createElement(Gi,{label:`Remove ${D}`,onClick:()=>w(x,D)},ie.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}," ",ie.default.createElement("path",{d:"M3 6h18"})," ",ie.default.createElement("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"})," ",ie.default.createElement("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})," ",ie.default.createElement("line",{x1:"10",y1:"11",x2:"10",y2:"17"})," ",ie.default.createElement("line",{x1:"14",y1:"11",x2:"14",y2:"17"})," "))))):null}):x==="event"?T.map((C,N)=>{var P;let D=C.name,A=(P=n[x])==null?void 0:P[D];return A?A.isEditing?ie.default.createElement("div",{key:`${x}-${D}-${N}`,className:"setting-item option-item"},ie.default.createElement("div",{className:"setting-item-control"},ie.default.createElement("input",{type:"text",value:A.editValue,onChange:I=>h(x,D,I.target.value),onKeyDown:I=>{I.key==="Enter"?(I.preventDefault(),b(x,D)):I.key==="Escape"&&(I.preventDefault(),g(x,D))},className:"option-edit-input","data-option":D,"aria-label":`Edit ${D}`,autoFocus:!0}),ie.default.createElement("div",{className:"option-actions"},ie.default.createElement(Gi,{label:"Save changes",onClick:()=>b(x,D)},ie.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}," ",ie.default.createElement("path",{d:"M5 12l5 5l10 -10"})," ")),ie.default.createElement(Gi,{label:"Cancel editing",onClick:()=>g(x,D)},ie.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}," ",ie.default.createElement("path",{d:"M18 6l-12 12"})," ",ie.default.createElement("path",{d:"M6 6l12 12"})," "))))):ie.default.createElement("div",{key:`${x}-${D}-${N}`,className:"setting-item option-item"},ie.default.createElement("div",{className:"setting-item-info"},ie.default.createElement("div",{className:"setting-item-name"},D),ie.default.createElement("span",{style:{display:"inline-block",width:"12px",height:"12px",borderRadius:"50%",marginLeft:"8px",backgroundColor:C.color,border:"1px solid var(--background-modifier-border)"},title:`Color: ${C.color}`})),ie.default.createElement("div",{className:"setting-item-control"},ie.default.createElement("div",{className:"option-actions"},ie.default.createElement(Gi,{label:`Edit ${D}`,onClick:()=>m(x,D)},ie.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}," ",ie.default.createElement("path",{d:"M17 3a2.85 2.85 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"})," ")),ie.default.createElement(Gi,{label:`Remove ${D}`,onClick:()=>w(x,D)},ie.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}," ",ie.default.createElement("path",{d:"M3 6h18"})," ",ie.default.createElement("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"})," ",ie.default.createElement("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})," ",ie.default.createElement("line",{x1:"10",y1:"11",x2:"10",y2:"17"})," ",ie.default.createElement("line",{x1:"14",y1:"11",x2:"14",y2:"17"})," "))))):null}):T.map((C,N)=>{var A;let D=(A=n[x])==null?void 0:A[C];return D?D.isEditing?ie.default.createElement("div",{key:`${x}-${C}-${N}`,className:"setting-item option-item"},ie.default.createElement("div",{className:"setting-item-control"},ie.default.createElement("input",{type:"text",value:D.editValue,onChange:P=>h(x,C,P.target.value),onKeyDown:P=>{P.key==="Enter"?(P.preventDefault(),b(x,C)):P.key==="Escape"&&(P.preventDefault(),g(x,C))},className:"option-edit-input","data-option":C,"aria-label":`Edit ${C}`,autoFocus:!0}),ie.default.createElement("div",{className:"option-actions"},ie.default.createElement(Gi,{label:"Save changes",onClick:()=>b(x,C)},ie.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}," ",ie.default.createElement("path",{d:"M5 12l5 5l10 -10"})," ")),ie.default.createElement(Gi,{label:"Cancel editing",onClick:()=>g(x,C)},ie.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}," ",ie.default.createElement("path",{d:"M18 6l-12 12"})," ",ie.default.createElement("path",{d:"M6 6l12 12"})," "))))):ie.default.createElement("div",{key:`${x}-${C}-${N}`,className:"setting-item option-item"},ie.default.createElement("div",{className:"setting-item-info"},ie.default.createElement("div",{className:"setting-item-name"},C)),ie.default.createElement("div",{className:"setting-item-control"},ie.default.createElement("div",{className:"option-actions"},ie.default.createElement(Gi,{label:`Edit ${C}`,onClick:()=>m(x,C)},ie.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}," ",ie.default.createElement("path",{d:"M17 3a2.85 2.85 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"})," ")),ie.default.createElement(Gi,{label:`Remove ${C}`,onClick:()=>w(x,C)},ie.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}," ",ie.default.createElement("path",{d:"M3 6h18"})," ",ie.default.createElement("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"})," ",ie.default.createElement("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})," ",ie.default.createElement("line",{x1:"10",y1:"11",x2:"10",y2:"17"})," ",ie.default.createElement("line",{x1:"14",y1:"11",x2:"14",y2:"17"})," "))))):null}),ie.default.createElement("div",{className:"setting-item custom-item-add"},ie.default.createElement("div",{className:"setting-item-info"},x==="instrument"?ie.default.createElement("div",{style:{display:"flex",gap:"8px",width:"100%"}},ie.default.createElement("input",{type:"text",value:s[x]||"",onChange:C=>l(N=>({...N,[x]:C.target.value})),placeholder:`New ${u(x).slice(0,-1)} Name`,"aria-label":`Add new ${u(x).toLowerCase()}`,onKeyDown:C=>{var N;C.key==="Enter"&&((N=s[x])!=null&&N.trim())&&(C.preventDefault(),y(x))},style:{flex:"1"}}),ie.default.createElement("select",{value:c,onChange:C=>d(C.target.value),style:{width:"120px"}},Object.values(yc).map(C=>ie.default.createElement("option",{key:C,value:C},p(C))))):ie.default.createElement("input",{type:"text",value:s[x]||"",onChange:C=>l(N=>({...N,[x]:C.target.value})),placeholder:`New ${u(x).slice(0,-1)} Name`,"aria-label":`Add new ${u(x).toLowerCase()}`,onKeyDown:C=>{var N;C.key==="Enter"&&((N=s[x])!=null&&N.trim())&&(C.preventDefault(),y(x))}})),ie.default.createElement("div",{className:"setting-item-control"},ie.default.createElement(be,{onClick:()=>y(x),disabled:!((E=s[x])!=null&&E.trim()),"aria-label":`Confirm add ${u(x).toLowerCase()}`},"Add"))),ie.default.createElement("div",{className:"custom-options-reset-container"},ie.default.createElement(be,{variant:"danger",size:"small",onClick:()=>k(x),className:"reset-category-button","aria-label":`Remove all custom ${u(x).toLowerCase()}`},"Reset All ",u(x)))),ie.default.createElement("hr",null))}),ie.default.createElement("div",{id:"reset-all-section"},ie.default.createElement("h3",null,"Reset All Options"),ie.default.createElement("p",{className:"setting-item-description"},"Clear all custom options for all categories. This action cannot be undone."),ie.default.createElement("div",{className:"setting-item"},ie.default.createElement("div",{className:"setting-item-info"},ie.default.createElement("div",{className:"setting-item-name"},"Reset All Custom Options"),ie.default.createElement("div",{className:"setting-item-description"},"Remove all custom options for instruments, accounts, setups, and mistakes")),ie.default.createElement("div",{className:"setting-item-control"},ie.default.createElement(be,{variant:"danger",onClick:S,className:"reset-all-button","aria-label":"Remove all custom options for all categories"},"Reset All"))))))};Bn();Yt();function sK(e){return e.tradeStatus==="OPEN"?!0:e.tradeStatus==="CLOSED"?!1:!e.exitTime&&(e.pnl===null||e.pnl===void 0)}function at(e){if(e.useDirectPnLInput===!0)return!1;if(e.tradeStatus==="OPEN")return!0;if(e.tradeStatus==="CLOSED")return!1;let t=e.exits&&e.exits.length>0&&e.exits.some(n=>n.price!==void 0&&n.price!==null&&n.price!==0||n.size!==void 0&&n.size!==null&&n.size!==0),r=e.pnl!==null&&e.pnl!==void 0;return!t&&!r}function I2(e){if(e.isMissedTrade)return"missed";if(sK(e))return"open";let t=e.pnl||0;return t>0?"win":t<0?"loss":"breakeven"}function F2(e){if(e.isMissedTrade)return"missed";if(at(e))return"open";let t=e.pnl||0;return t>0?"win":t<0?"loss":"breakeven"}var hp=(e,t,r=5)=>{let n=[],i=t-e,o=i/(r-1),a=Math.pow(10,Math.floor(Math.log10(o))),s;o/a<1.5?s=a:o/a<3.5?s=2*a:o/a<7.5?s=5*a:s=10*a,i<10*a&&s>a&&(s=a);let l=Math.floor(e/s)*s,c=Math.ceil(t/s)*s;for(let d=l;d<=c;d+=s){let u=parseFloat(d.toFixed(12));n.push(u)}return e<=0&&0<=t&&!n.includes(0)&&n.push(0),[...new Set(n)].sort((d,u)=>d-u)},j2=(e,t,r,n,i=.05)=>{let o=r!==void 0?r:Math.min(0,e),a=n!==void 0?n:Math.max(0,t);if(r===void 0&&e<0){let s=Math.abs(e)*i;o=Math.min(o,e-s)}if(n===void 0&&t>0){let s=t*i;a=Math.max(a,t+s)}return[o,a]},zC=e=>e===0?"0.00%":"-"+Math.abs(e).toFixed(2)+"%",$g=new Map,Wg=(e,t)=>{var l;let r=e.filter(c=>!at({tradeStatus:c.tradeStatus,exitTime:c.exitTime,pnl:c._originalPnlWasNull?null:c.pnl,useDirectPnLInput:c.useDirectPnLInput,exits:c.exits})),n=`pnl:${r.length}:${t}:${((l=r[0])==null?void 0:l.path)||""}`,i=$g.get(n);if(i)return i;let o=[...r].sort((c,d)=>c.entryTime.getTime()-d.entryTime.getTime()),a=0,s=[];if(o.length>0){let c=new Date(o[0].entryTime);s.push({date:Ze(c,t),pnl:0,tradePnL:0})}else s.push({date:Ze(new Date,t),pnl:0,tradePnL:0});if(o.forEach(c=>{let d=c.pnl||0;a+=d,s.push({date:Ze(c.entryTime,t),pnl:a,tradePnL:d})}),$g.set(n,s),$g.size>50){let c=$g.keys().next().value;$g.delete(c)}return s},Rg=new Map,hd=(e,t)=>{var c;let r=e.filter(d=>!at({tradeStatus:d.tradeStatus,exitTime:d.exitTime,pnl:d._originalPnlWasNull?null:d.pnl,useDirectPnLInput:d.useDirectPnLInput,exits:d.exits})),n=`drawdown:${r.length}:${t}:${((c=r[0])==null?void 0:c.path)||""}`,i=Rg.get(n);if(i)return i;let o=[...r].sort((d,u)=>d.entryTime.getTime()-u.entryTime.getTime()),a=0,s=0,l=[];if(o.length>0){let d=new Date(o[0].entryTime);l.push({date:Ze(d,t),drawdown:0,pnl:0,cumPnL:0,peakEquity:0})}else l.push({date:Ze(new Date,t),drawdown:0,pnl:0,cumPnL:0,peakEquity:0});if(o.forEach(d=>{let u=d.pnl||0;a+=u,a>s&&(s=a);let p=0;if(s>0)p=-((s-a)/s)*100;else if(a<0){let m=Math.min(...o.map(f=>f.pnl||0)),g=Math.abs(m)*10;p=-(Math.abs(a)/g)*100}l.push({date:Ze(d.entryTime,t),drawdown:p,pnl:u,cumPnL:a,peakEquity:s})}),Rg.set(n,l),Rg.size>50){let d=Rg.keys().next().value;Rg.delete(d)}return l},Bg=e=>[...e.filter(n=>!at({tradeStatus:n.tradeStatus,exitTime:n.exitTime,pnl:n._originalPnlWasNull?null:n.pnl,useDirectPnLInput:n.useDirectPnLInput,exits:n.exits}))].sort((n,i)=>n.entryTime.getTime()-i.entryTime.getTime()).map((n,i)=>{let o=n.pnl||0,a=o>=0;return{tradeIndex:i+1,pnl:o,fill:a?"var(--chart-positive)":"var(--chart-negative)",instrument:n.instrument,direction:n.direction,entryTime:n.entryTime,exitTime:n.exitTime,path:n.path}});var Do={container:"journalit-chart-tooltip",date:"journalit-chart-tooltip-date",value:"journalit-chart-tooltip-value",info:"journalit-chart-tooltip-info",positive:"positive",negative:"negative"},Ug=(e,t)=>{switch(t){case"pnl":return fe(e);case"drawdown":return zC(e);case"number":default:return e.toFixed(2)}};function L2(e){try{let t=[];return JSON.stringify(e,(r,n)=>{if(typeof n=="object"&&n!==null){if(t.includes(n))return"[Circular Reference]";t.push(n)}return n},2)}catch(t){return console.error("safeStringify error:",t),`[Error serializing object: ${t instanceof Error?t.message:String(t)}]`}}function $C(e,t=["plugin","app"]){let r={};return Object.entries(e).forEach(([n,i])=>{i!==null&&typeof i!="function"&&!(i instanceof Node)&&!t.includes(n)&&(typeof i=="object"&&!Array.isArray(i)?r[n]=$C(i,t):r[n]=i)}),r}function _2(e){try{return{...e}}catch(t){return console.error("Error normalizing data:",t),e}}function z2(e,t){try{let r={...e},n={...t};return{...r,...n}}catch(r){return console.error("Error in safeUpdateObject:",r),{...e,...t}}}Yt();function $2(e,t,r){let n=null,i=null,o=0,a=null,s=null,l,{leading:c=!1,trailing:d=!0,maxWait:u}=r||{};function p(S){let x=a,T=s;return a=s=null,o=S,l=e.apply(T,x),l}function m(S){return o=S,n=setTimeout(y,t),c?p(S):l}function g(S){let x=S-(i||0),T=S-o,E=t-x;return u!==void 0?Math.min(E,u-T):E}function f(S){let x=S-(i||0),T=S-o;return i===null||x>=t||x<0||u!==void 0&&T>=u}function y(){let S=Date.now();if(f(S))return h(S);n=setTimeout(y,g(S))}function h(S){return n=null,d&&a?p(S):(a=s=null,l)}function v(){n!==null&&clearTimeout(n),o=0,a=i=s=n=null}function b(){return n===null?l:h(Date.now())}function w(){return n!==null}function k(...S){let x=Date.now(),T=f(x);if(a=S,s=this,i=x,T){if(n===null)return m(i);if(u!==void 0)return n=setTimeout(y,t),p(i)}return n===null&&(n=setTimeout(y,t)),l}return k.cancel=v,k.flush=b,k.pending=w,k}function RC(e,t){let r=null,n=null,i=null,o=null;function a(){r!==null&&(clearTimeout(r),r=null),o&&(o(new Error("Debounced function cancelled")),i=o=null,n=null)}async function s(){if(r!==null&&(clearTimeout(r),r=null,n))try{let u=await e.apply(c,l);return i&&i(u),u}catch(u){throw o&&o(u),u}}let l=null,c=null,d=function(...u){return l=u,c=this,a(),n=new Promise((p,m)=>{i=p,o=m,r=setTimeout(async()=>{try{let g=await e.apply(c,l);p(g)}catch(g){m(g)}finally{r=null,n=null,i=o=null}},t)}),n};return d.cancel=a,d.flush=s,d}var lK=`
  // Global event handler to forcibly close dropdowns when clicking outside
  (function() {
    // Only add this handler once
    if (window.__dropdownClickHandlerAdded) return;
    
    // Mark this handler as added to prevent multiple instances
    window.__dropdownClickHandlerAdded = true;
    
    // Initialize the remove handling flag
    window.__isHandlingComboBoxRemove = false;
    
    // Add capture phase handler to catch clicks early
    document.addEventListener('mousedown', function(event) {
      // Skip if event is already being handled
      if (window.__isHandlingComboBoxRemove) return;
      
      // Mark as handling to prevent recursive handling
      window.__isHandlingComboBoxRemove = true;
      
      try {
        // Find all open comboboxes/dropdowns
        const openDropdowns = document.querySelectorAll('[data-is-open="true"], [data-combobox-type][aria-expanded="true"]');
        
        if (openDropdowns.length > 0) {
          let shouldClose = true;
          
          // Check if the click was inside any dropdown
          for (const dropdown of openDropdowns) {
            if (dropdown.contains(event.target)) {
              shouldClose = false;
              break;
            }
          }
          
          // If clicked outside, close all dropdowns by triggering blur on their inputs
          if (shouldClose) {
            openDropdowns.forEach(dropdown => {
              const input = dropdown.querySelector('input[role="combobox"]');
              if (input) {
                // Trigger blur to close the dropdown
                input.blur();
                
                // Additional attribute cleanup to ensure closure
                dropdown.setAttribute('data-is-open', 'false');
                if (input.hasAttribute('aria-expanded')) {
                  input.setAttribute('aria-expanded', 'false');
                }
              }
            });
          }
        }
      } catch (err) {
        console.error('Error in dropdown click handler:', err);
      } finally {
        // Release handling flag
        window.__isHandlingComboBoxRemove = false;
      }
    }, true);
  })();
`;function Vg(){if(document.head.querySelector("#dropdown-fix-script"))return;let e=document.createElement("script");e.id="dropdown-fix-script",e.textContent=lK,document.head.appendChild(e)}function WC(){let e=document.head.querySelector("#dropdown-fix-script");e&&e.remove()}function sa(e){let{message:t,error:r,component:n="unknown",operation:i="unknown",data:o,severity:a="error"}=e,s=r instanceof Error?r:new Error(t),l=a==="info"?console.info:a==="warning"?console.warn:console.error,c={error:s,operation:i,component:n};if(o&&(c.data=typeof o=="object"?L2(o):o),l(`[${a.toUpperCase()}] [${n}] ${t}`,c),a==="critical")try{let d=window.app;d!=null&&d.notices&&d.notices.show(`${t} (See console for details)`,1e4)}catch(d){console.error("Failed to show error notification:",d)}return s}function vp(e,t){return(r,n)=>sa({message:n||`Error in ${t}`,error:r,component:e,operation:t,severity:"error"})}Ha();function Po(e=!1,t=!1,r=!1,n=!1,i=!1,o=!1,a=!1,s=!1,l=!1){try{if(!t&&Z.tradeNote&&Z.tradeNote.remove(),!o&&Z.image&&Z.image.remove(),e||(Z.drc&&Z.drc.remove(),Z.drcNote&&Z.drcNote.remove()),!r&&Z.settings&&Z.settings.remove(),!n&&(Z.dashboard&&Z.dashboard.remove(),!a)){let c=document.head.querySelector("#dashboard-transparency-styles");c&&c.remove()}Z.weeklyReview&&Z.weeklyReview.remove(),Z.monthlyReview&&Z.monthlyReview.remove(),!s&&Z.shared&&Z.shared.remove(),Z.tooltip&&Z.tooltip.remove(),Z.dragOverlay&&Z.dragOverlay.remove(),Z.tradeForm&&Z.tradeForm.remove(),!i&&Z.chart&&Z.chart.remove(),!l&&Z.tradeLog&&Z.tradeLog.remove(),WC(),window.__isHandlingComboBoxRemove=!1}catch(c){console.error("Failed to remove styles:",c)}}function Di(e=!1,t=!1,r=!0,n=!0,i=!0,o=!0,a=!1,s=!0,l=!0,c=!0){var d,u,p,m,g,f,y;if(e&&((d=Z.drc)!=null&&d.inject)&&Z.drc.inject(),t&&((u=Z.tradeNote)!=null&&u.inject)&&Z.tradeNote.inject(),n&&((p=Z.dashboard)!=null&&p.inject)&&Z.dashboard.inject(),r&&((m=Z.settings)!=null&&m.inject)&&Z.settings.inject(),i&&((g=Z.chart)!=null&&g.inject)&&Z.chart.inject(),o&&((f=Z.image)!=null&&f.inject)&&Z.image.inject(),c&&((y=Z.tradeLog)!=null&&y.inject)&&Z.tradeLog.inject(),!(window.__isInjectingStyles&&!a)){window.__isInjectingStyles=!0;try{Po(e,t,r,n,i,o,s,l,c),Z.shared&&Z.shared.inject(),Z.tooltip&&Z.tooltip.inject(),Z.dragOverlay&&Z.dragOverlay.inject(),Z.tradeForm&&Z.tradeForm.inject(),Z.chart&&Z.chart.inject(),Vg(),Z.weeklyReview&&Z.weeklyReview.inject(),Z.monthlyReview&&Z.monthlyReview.inject(),Z.image&&Z.image.inject(),Z.tradeLog&&Z.tradeLog.inject(),e||(Z.drc&&Z.drc.inject(),Z.drcNote&&Z.drcNote.inject()),!t&&Z.tradeNote&&Z.tradeNote.inject(),!r&&Z.settings&&Z.settings.inject(),!n&&Z.dashboard&&Z.dashboard.inject(),typeof window!="undefined"&&Z.drc&&(window.__JOURNALIT_INJECT_DRC_STYLES=Z.drc.inject)}catch(h){console.error("Failed to inject styles:",h)}finally{window.__isInjectingStyles=!1}}}var dK=`
/* Color variables for event colors and consistency */
:root {
  --chart-positive: var(--color-green, #43a047);
  --chart-negative: var(--color-red, #e53935);
  --event-color-red: var(--color-red, #e53935);
  --event-color-orange: var(--color-orange, #fb8c00);
  --event-color-yellow: var(--color-yellow, #fdd835);
  --event-color-gray: var(--text-muted, #888888); /* Use muted text color as base for gray */
  --event-text-color-on-dark: #ffffff; /* Text color for darker backgrounds */
  --event-text-color-on-light: #000000; /* Text color for lighter backgrounds (like yellow) */
  --interactive-accent-rgb: 83, 141, 226; /* Default RGB values for interactive accent - synced with tradeForm */
}

/* Weekly Review View container - ensures no extra margins/padding */
.journalit-weekly-review-view,
.markdown-preview-view .journalit-weekly-review-view {
  margin: 0 !important; /* Remove all margins */
  border-bottom: none !important; /* Remove bottom border causing extra space */
  padding: 0 !important; /* Remove all padding */
  display: block !important;
  width: 100% !important;
  z-index: 100 !important;
  /* Force visibility */
  visibility: visible !important;
  opacity: 1 !important;
  background-color: var(--background-primary) !important;
  /* Removed borders */
  border: none !important;
  border-radius: 8px !important;
  /* Ensure proper containment */
  position: relative;
  box-sizing: border-box;
  /* Prevent overlaps */
  contain: content;
  /* Ensure proper isolation from other views */
  isolation: isolate;
}

/* Weekly Review React root wrapper */
.weekly-review-wrapper {
  width: 100%;
  display: flex;
  flex-direction: column;
  contain: content;
  /* Keep React root fully contained */
  isolation: isolate;
  /* Create a new stacking context */
  position: relative;
  /* Ensure clean slate for each instance */
  box-sizing: border-box;
  margin: 0 !important;
  z-index: 100 !important;
}


/* Weekly Review Container */
.weekly-review-container {
  display: flex;
  flex-direction: column;
  font-family: var(--font-text);
  color: var(--text-normal);
  width: 100%;
  height: 100%;
  overflow: hidden;
  background-color: var(--background-primary);
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

/* Header and Navigation - Styled to match DRC */
.weekly-review-header {
  padding: 16px 20px 12px;
  background-color: var(--background-secondary);
  text-align: center;
  border-bottom: 1px solid var(--background-modifier-border);
}

.weekly-review-date {
  font-size: 18px;
  font-weight: 600;
  color: var(--text-normal);
  margin-bottom: 12px;
}

/* Navigation - Matches DRC navigation */
.weekly-review-navigation {
  width: 100%;
  padding-top: 10px;
  border-top: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1));
}

.weekly-review-navigation-links {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
  width: 100% !important;
}

.weekly-review-nav-button {
  padding: 8px 14px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  background-color: var(--background-primary);
  color: var(--text-normal);
  cursor: pointer;
  font-size: 14px;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  flex: 1;
  text-align: center;
  min-width: 120px;
}

.weekly-review-nav-button:hover {
  background-color: var(--background-modifier-hover);
  transform: translateY(-1px);
}

.weekly-review-nav-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.nav-icon {
  font-size: 14px;
  margin-right: 4px;
  margin-left: 4px;
}

/* Critical navigation styles with high specificity */
html body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links,
body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links,
.workspace-leaf .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links {
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  gap: 8px !important;
  flex-wrap: wrap !important;
  width: 100% !important;
}

html body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button,
body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button,
.workspace-leaf .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button {
  padding: 8px 14px !important;
  border: 1px solid var(--background-modifier-border) !important;
  border-radius: 4px !important;
  background-color: var(--background-primary) !important;
  color: var(--text-normal) !important;
  cursor: pointer !important;
  font-size: 14px !important;
  transition: all 0.2s !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  gap: 6px !important;
  flex: 1 !important;
  text-align: center !important;
  min-width: 120px !important;
  box-sizing: border-box !important;
  max-width: none !important;
  margin: 0 !important;
}

/* Ensure proper icon spacing */
html body .weekly-review-container .weekly-review-navigation .weekly-review-nav-button .nav-icon,
body .weekly-review-container .weekly-review-navigation .weekly-review-nav-button .nav-icon {
  font-size: 16px !important;
  line-height: 1 !important;
}

/* Tabs */
.weekly-review-tabs-container {
  display: flex;
  justify-content: center;
  border-bottom: 1px solid var(--background-modifier-border);
  background-color: var(--background-secondary-alt, #2a2a2a);
  padding: 0;
}

.weekly-review-tabs {
  display: flex;
  justify-content: center;
  background-color: transparent;
  max-width: 600px;
  margin: 0 auto;
}

.weekly-review-tab {
  padding: 12px 24px;
  font-size: 14px;
  font-weight: 600;
  color: var(--text-muted);
  background-color: transparent;
  border: none;
  border-bottom: 2px solid transparent;
  cursor: pointer;
  transition: all 0.2s ease;
  position: relative;
  outline: none;
}

.weekly-review-tab:hover {
  color: var(--text-normal);
  background-color: rgba(127, 127, 127, 0.05);
}

.weekly-review-tab.active {
  color: var(--text-accent);
  border-bottom: 2px solid var(--text-accent);
}

/* Content */
.weekly-review-content {
  flex: 1;
  overflow-y: auto;
  padding: 20px 0 0; /* Only top padding, no horizontal padding */
}

/* Sections */
.weekly-review-section {
  margin: 0 0 24px 0; /* Explicit horizontal margin of 0 */
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  padding: 16px;
  width: 100%; /* Ensure full width */
  box-sizing: border-box; /* Include padding in width calculation */
}

.weekly-review-section-title {
  margin: 0 0 16px 0;
  padding-bottom: 8px;
  font-size: 16px;
  font-weight: 600;
  color: var(--text-normal);
  border-bottom: 1px solid var(--background-modifier-border);
  text-align: center;
}

/* Fix Section title styling - especially for Previous Week Goals */
.weekly-review-previous-goals h3,
.weekly-review-section h3 {
  font-size: 1rem !important;
  margin-top: 0.5rem !important;
  margin-bottom: 1rem !important;
  text-align: center !important;
  font-weight: 600 !important;
  color: var(--text-normal) !important;
  padding-bottom: 0.5rem !important;
  border-bottom: 1px solid var(--background-modifier-border) !important;
}

/* Empty states */
.weekly-review-empty-state,
.weekly-review-no-trades,
.weekly-review-no-drcs,
.weekly-review-no-events,
.weekly-review-no-questions {
  padding: 16px;
  text-align: center;
  color: var(--text-muted);
  font-style: italic;
  background-color: var(--background-secondary);
  border-radius: 6px;
}

/* Checklist for previous goals - Modified for 2-column grid layout */
.weekly-review-checklist {
  display: grid; /* Changed from flex */
  grid-template-columns: repeat(2, 1fr); /* Create two equal columns */
  gap: 12px; /* Increased gap for grid layout */
}

.weekly-review-checklist-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 8px 12px;
  border-radius: 4px;
  background-color: var(--background-secondary);
  cursor: pointer; /* Make the entire area clickable */
  transition: background-color 0.2s ease;
}

.weekly-review-checklist-item:hover {
  background-color: var(--background-modifier-hover);
}

.weekly-review-checkbox {
  width: 18px;
  height: 18px;
  margin: 0;
  cursor: pointer;
}

/* Key Events */
.weekly-review-key-events {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.weekly-review-event-selector {
  display: flex;
  flex-direction: column;
  gap: 12px;
  padding: 16px;
  background-color: var(--background-secondary);
  border-radius: 8px;
}

/* ComboBox styling - matched with DRC implementation */
.weekly-review-container .combobox-container,
.weekly-review-container [data-combobox-type],
.weekly-review-event-selector .combobox-container,
.weekly-review-section .combobox-container {
  position: relative !important;
  width: 100% !important;
  margin-bottom: 8px !important;
  z-index: 10 !important;
}

/* Increased z-index when dropdown is open */
.weekly-review-container .combobox-container[data-is-open="true"],
.weekly-review-container [data-combobox-type][data-is-open="true"],
.weekly-review-event-selector .combobox-container[data-is-open="true"],
.weekly-review-section .combobox-container[data-is-open="true"] {
  z-index: 9999 !important;
}

/* Dropdown caret for Weekly Review ComboBox */
.weekly-review-container [data-combobox-type] .input-container::after,
.weekly-review-event-selector .combobox-container .input-container::after,
.weekly-review-section .combobox-container .input-container::after {
  content: "" !important;
  position: absolute !important;
  right: 12px !important;
  top: 50% !important;
  transform: translateY(-50%) !important;
  width: 0 !important;
  height: 0 !important;
  border-left: 5px solid transparent !important;
  border-right: 5px solid transparent !important;
  border-top: 5px solid var(--text-normal) !important;
  pointer-events: none !important;
  z-index: 10 !important;
}

/* Input padding to make room for dropdown arrow */
.weekly-review-container [data-combobox-type] input[role="combobox"],
.weekly-review-event-selector .combobox-container input[role="combobox"],
.weekly-review-section .combobox-container input[role="combobox"] {
  padding-right: 30px !important;
  width: 100% !important;
  padding: 8px 12px !important;
  padding-right: 30px !important;
  border: 1px solid var(--background-modifier-border) !important;
  border-radius: 4px !important;
  background-color: var(--background-primary) !important;
  color: var(--text-normal) !important;
  font-size: 14px !important;
  cursor: pointer !important;
  position: relative !important;
  z-index: 10000 !important; /* Higher than dropdown (9999) to ensure focus border shows on top */
}

/* Input field focus styling - ensure focus outlines appear above dropdown */
.weekly-review-container [data-combobox-type] input[role="combobox"]:focus,
.weekly-review-event-selector .combobox-container input[role="combobox"]:focus,
.weekly-review-section .combobox-container input[role="combobox"]:focus {
  outline: 2px solid var(--interactive-accent) !important; /* Match Obsidian's focus style */
  outline-offset: -1px !important;
  border-color: var(--interactive-accent) !important;
  box-shadow: 0 0 0 1px var(--interactive-accent) !important;
  z-index: 10001 !important; /* Ensure focus styling is above even the input */
}

/* Weekly Review dropdown options - remove bullets and match DRC */
.weekly-review-container [data-combobox-type] ul[role="listbox"],
.weekly-review-event-selector [data-combobox-type] ul[role="listbox"],
.weekly-review-section [data-combobox-type] ul[role="listbox"] {
  position: absolute !important;
  top: 100% !important;
  left: 0 !important;
  right: 0 !important;
  max-height: 200px !important;
  overflow-y: auto !important;
  background-color: var(--background-primary) !important;
  border: 1px solid var(--background-modifier-border) !important;
  border-top: none !important;
  border-radius: 0 0 4px 4px !important;
  margin-top: -1px !important;
  z-index: 9999 !important;
  list-style: none !important; /* Remove bullets */
  padding: 0 !important;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
  clip-path: inset(1px -15px -15px -15px) !important; /* Clip top edge to prevent covering the focus border */
}

/* Weekly Review dropdown options styling */
.weekly-review-container [data-combobox-type] ul[role="listbox"] li,
.weekly-review-event-selector [data-combobox-type] ul[role="listbox"] li,
.weekly-review-section [data-combobox-type] ul[role="listbox"] li {
  padding: 8px 12px !important;
  cursor: pointer !important;
  transition: background-color 150ms ease !important;
  margin: 0 !important;
  list-style: none !important; /* Ensure no bullets */
  border-bottom: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1)) !important;
}

/* Hover and selected state for Weekly Review dropdown options */
.weekly-review-container [data-combobox-type] ul[role="listbox"] li:hover,
.weekly-review-container [data-combobox-type] ul[role="listbox"] li[aria-selected="true"],
.weekly-review-event-selector [data-combobox-type] ul[role="listbox"] li:hover,
.weekly-review-event-selector [data-combobox-type] ul[role="listbox"] li[aria-selected="true"],
.weekly-review-section [data-combobox-type] ul[role="listbox"] li:hover,
.weekly-review-section [data-combobox-type] ul[role="listbox"] li[aria-selected="true"] {
  background-color: var(--background-secondary) !important;
}

/* Special styling for "Add new" option in Weekly Review */
.weekly-review-container [data-combobox-type] ul[role="listbox"] li[data-add-option="true"],
.weekly-review-event-selector [data-combobox-type] ul[role="listbox"] li[data-add-option="true"],
.weekly-review-section [data-combobox-type] ul[role="listbox"] li[data-add-option="true"] {
  font-style: italic !important;
  border-top: 1px dashed var(--background-modifier-border) !important;
}

/* When dropdown is open, change input border radius */
.weekly-review-container [data-combobox-type][data-is-open="true"] input[role="combobox"],
.weekly-review-event-selector [data-combobox-type][data-is-open="true"] input[role="combobox"],
.weekly-review-section [data-combobox-type][data-is-open="true"] input[role="combobox"] {
  border-bottom-left-radius: 0 !important;
  border-bottom-right-radius: 0 !important;
}

/* Weekly Review Multi-select styling - fixed for better visibility */
.weekly-review-event-selector .selected-options,
.weekly-review-event-selector .selected-item,
.weekly-review-section .selected-options,
.weekly-review-section .selected-item,
.weekly-review-container [data-combobox-type="multi"] > div:first-of-type {
  display: flex !important;
  flex-wrap: wrap !important;
  gap: 4px !important;
  max-width: 100% !important;
  padding: 2px 0 !important;
  z-index: 5 !important;
  position: relative !important;
}

/* Style selected tags to match the DRC */
.weekly-review-event-selector .selected-option,
.weekly-review-event-selector .selected-item,
.weekly-review-section .selected-option,
.weekly-review-section .selected-item {
  display: inline-flex !important;
  align-items: center !important;
  background-color: var(--interactive-accent, #7c3aed) !important;
  color: white !important;
  border-radius: 4px !important;
  padding: 4px 8px !important;
  font-size: 12px !important;
  margin: 0 4px 4px 0 !important;
  font-weight: 500 !important;
  z-index: 6 !important;
  position: relative !important;
  gap: 6px !important;
}

/* Style remove buttons ('\xD7') - matched with DRC */
.weekly-review-event-selector .selected-option-remove,
.weekly-review-event-selector .selected-item button,
.weekly-review-section .selected-option-remove,
.weekly-review-section .selected-item button {
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  width: 16px !important;
  height: 16px !important;
  min-width: 16px !important;
  min-height: 16px !important;
  padding: 0 !important;
  margin-left: 4px !important;
  cursor: pointer !important;
  background: rgba(255, 255, 255, 0.2) !important;
  border: none !important;
  border-radius: 50% !important;
  color: white !important;
  font-size: 14px !important;
  line-height: 1 !important;
  text-align: center !important;
  z-index: 7 !important;
  position: relative !important;
  transition: background-color 0.2s !important;
}

/* Add hover effect for remove buttons */
.weekly-review-event-selector .selected-option-remove:hover,
.weekly-review-event-selector .selected-item button:hover,
.weekly-review-section .selected-option-remove:hover,
.weekly-review-section .selected-item button:hover {
  background: rgba(255, 255, 255, 0.4) !important;
}

/* ADDED: Styles for the event color picker UI */
.weekly-review-event-color-selector {
  display: flex;
  gap: 10px;
  align-items: center;
  margin-top: 8px;
  margin-bottom: 8px;
}

.weekly-review-event-color-selector span { /* Style the "Color:" text */
  margin-right: 5px;
  font-size: 12px;
  color: var(--text-muted);
}

.weekly-review-event-color-selector label {
  display: flex;
  align-items: center;
  cursor: pointer;
}

.weekly-review-event-color-selector input[type="radio"] {
  margin-right: 4px;
  cursor: pointer;
  /* Consider using appearance: none and custom styling */
}

.weekly-review-event-color-selector label span { /* Style the colored circle */
  display: inline-block;
  width: 16px;
  height: 16px;
  border-radius: 50%;
  border: 1px solid var(--background-modifier-border);
}
/* END ADDED color picker styles */


.weekly-review-events-list {
  display: flex;
  flex-direction: column;
  gap: 12px; /* Changed from 12px to 10px in invalid file, reverting */
}

/* MODIFIED: Event item styling with color-specific borders */
.weekly-review-event-item {
  padding: 12px;
  background-color: var(--background-secondary);
  border-radius: 8px;
  border-left: 5px solid var(--event-color-gray); /* Default border color */
  margin-bottom: 8px; /* Add some spacing */
  transition: border-color 0.3s ease; /* Smooth transition for border color */
}

/* ADDED: Event color classes */
.weekly-review-event-item.event-color-red {
  border-left-color: var(--event-color-red);
}
.weekly-review-event-item.event-color-orange {
  border-left-color: var(--event-color-orange);
}
.weekly-review-event-item.event-color-yellow {
  border-left-color: var(--event-color-yellow);
}
.weekly-review-event-item.event-color-gray {
  border-left-color: var(--event-color-gray);
}
/* END ADDED color classes */

/* Day selector styling */
.weekly-review-event-day-selector {
  display: flex;
  gap: 10px;
  align-items: center;
  margin-top: 8px;
  margin-bottom: 8px;
}

.weekly-review-event-day-selector span {
  margin-right: 5px;
  font-size: 12px;
  color: var(--text-muted);
}

.weekly-review-event-day-selector select {
  padding: 4px 8px;
  border-radius: 4px;
  border: 1px solid var(--background-modifier-border);
  background-color: var(--background-primary);
  color: var(--text-normal);
  font-size: 14px;
  width: 150px;
}

/* Day badge in event items */
.weekly-review-event-day {
  font-size: 12px;
  padding: 2px 8px;
  background-color: var(--background-modifier-border);
  border-radius: 4px;
  color: var(--text-normal);
  font-weight: 500;
  white-space: nowrap;
}

.weekly-review-event-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
}

.weekly-review-event-header h4 {
  margin: 0;
  font-size: 14px; /* Restored from 1.05em */
  font-weight: 600;
}

/* Forecast */
.weekly-review-forecast-section {
  margin-bottom: 20px;
  padding: 16px;
  background-color: var(--background-secondary); /* Restored from primary-alt */
  border-radius: 8px; /* Restored from 5px */
}

.weekly-review-forecast-section h4 { /* Added missing styling */
  margin-top: 0;
  margin-bottom: 15px;
  font-size: 1.05em; /* Keep consistent sizing */
}

.weekly-review-image-container {
  margin-bottom: 12px; /* Restored from 15px */
}

.weekly-review-image {
  position: relative;
  margin-bottom: 12px;
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 100%;
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  padding: 8px;
  background-color: var(--background-primary);
}

.weekly-review-forecast-image {
  width: auto; /* Allow natural width */
  max-width: 100%; /* Prevent overflow */
  max-height: 300px; /* Limit height */
  object-fit: contain; /* Maintain aspect ratio */
  border-radius: 6px;
  margin-bottom: 8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); /* Add subtle shadow */
  background-color: var(--background-primary); /* Ensure transparent PNGs have a background */
}

.weekly-review-image-upload {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 80px;
  border: 2px dashed var(--background-modifier-border);
  border-radius: 6px;
  margin-bottom: 12px;
  cursor: pointer;
  transition: all 0.2s ease;
  position: relative;
  overflow: hidden;
}

.weekly-review-image-upload:hover {
  border-color: var(--interactive-accent);
  background-color: rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.05);
}

.weekly-review-image-upload.dragging-over {
  border-color: var(--interactive-accent);
  background-color: rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.1);
  transform: scale(1.02);
  box-shadow: 0 0 12px rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.3);
}

.weekly-review-image-upload::after {
  content: "Drag and drop here";
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 16px;
  font-weight: 600;
  color: var(--interactive-accent);
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.2s ease;
}

.weekly-review-image-upload.dragging-over::after {
  opacity: 1;
}

.weekly-review-image-upload.dragging-over .weekly-review-image-label {
  opacity: 0;
}

.weekly-review-image-label {
  font-size: 14px;
  color: var(--text-muted);
  cursor: pointer;
  transition: all 0.2s ease;
}

.weekly-review-image-upload:hover .weekly-review-image-label {
  color: var(--interactive-accent);
}

.weekly-review-image-input {
  display: none;
}

.weekly-review-image-delete {
  /* Position restored from absolute in invalid file */
  background-color: rgba(229, 57, 53, 0.1);
  color: var(--color-error, #e53935);
  border: none;
  border-radius: 4px;
  padding: 6px 12px;
  font-size: 12px; /* Restored from 0.8em */
  cursor: pointer;
  /* Remove transition/opacity from invalid file */
}

/* Buttons */
.weekly-review-add-button {
  background-color: var(--interactive-accent);
  color: white; /* Restored from var */
  border: none;
  border-radius: 4px;
  padding: 8px 16px; /* Restored */
  font-size: 14px; /* Restored */
  cursor: pointer;
  font-weight: normal; /* Reset from invalid file */
  /* Removed align-self from invalid file, handled by container */
}

.weekly-review-add-button:hover {
  background-color: var(--interactive-accent-hover);
}

.weekly-review-add-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.weekly-review-remove-button,
.weekly-review-event-remove { /* Combined rule restored */
  background-color: rgba(229, 57, 53, 0.1); /* Restored from var */
  color: var(--color-error, #e53935); /* Restored from var */
  border: none;
  border-radius: 4px;
  padding: 4px 8px;
  font-size: 12px; /* Restored from 0.8em */
  cursor: pointer;
}

/* Image error message */
.weekly-review-image-error {
  color: var(--text-error, var(--color-red, #e53935));
  font-size: 12px;
  text-align: center;
  margin-top: 4px;
  margin-bottom: 8px;
  padding: 6px 10px;
  background-color: rgba(229, 57, 53, 0.1);
  border-radius: 4px;
  width: 100%;
}

.weekly-review-remove-button:hover,
.weekly-review-event-remove:hover {
  background-color: rgba(229, 57, 53, 0.2);
}

.weekly-review-add-event { /* This class seems unused, keeping for history */
  align-self: flex-start;
  margin-top: 12px;
}

/* Text Areas and Inputs */
.weekly-review-textarea {
  width: 100%;
  min-height: 80px; /* Restored from 100px */
  padding: 12px; /* Restored from 10px */
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px; /* Restored from 4px */
  background-color: var(--background-primary);
  color: var(--text-normal);
  font-family: var(--font-text); /* Added back */
  font-size: unset; /* Reset from 0.9em */
  resize: vertical;
}

.weekly-review-input { /* For generic inputs if used */
  width: 100%;
  padding: 10px 12px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  background-color: var(--background-primary);
  color: var(--text-normal);
  font-family: var(--font-text);
}

/* Metric Cards */
.weekly-review-metric-cards {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
  gap: 16px;
  margin-bottom: 16px;
}

.weekly-review-metric-card {
  padding: 16px;
  background-color: var(--background-secondary);
  border-radius: 8px;
  transition: transform 0.2s ease;
}

.weekly-review-metric-card:hover {
  transform: translateY(-2px);
}

.weekly-review-metric-label {
  font-size: 12px;
  color: var(--text-muted);
  margin-bottom: 8px;
}

.weekly-review-metric-value {
  font-size: 20px;
  font-weight: 700;
  color: var(--text-normal);
}

.weekly-review-metric-value[style*="color: var(--color-green)"],
.weekly-review-metric-value[style*="var(--color-green)"] {
  color: var(--color-green) !important;
}
.weekly-review-metric-value.positive { /* Added specific class */
  color: var(--chart-positive) !important;
}

.weekly-review-metric-value[style*="color: var(--color-red)"],
.weekly-review-metric-value[style*="var(--color-red)"] {
  color: var(--color-red) !important;
}
.weekly-review-metric-value.negative { /* Added specific class */
   color: var(--chart-negative) !important;
}


/* Trades list */
.weekly-review-trades {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.weekly-review-trade-item { /* Used if list view is implemented */
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 16px;
  background-color: var(--background-secondary);
  border-radius: 6px;
  cursor: pointer;
  transition: background-color 0.2s ease;
}

.weekly-review-trade-item:hover {
  background-color: var(--background-modifier-hover);
}

.weekly-review-trade-info {
  display: flex;
  align-items: center;
  gap: 8px;
}

.weekly-review-trade-instrument {
  font-weight: 600;
}

.weekly-review-trade-direction {
  color: var(--text-muted);
  font-size: 12px;
}

.weekly-review-trade-pnl {
  font-weight: 600;
}

.weekly-review-trade-pnl[style*="color: var(--color-green)"],
.weekly-review-trade-pnl[style*="var(--color-green)"] {
  color: var(--color-green) !important;
}
.weekly-review-trade-pnl.positive { /* Added specific class */
   color: var(--chart-positive) !important;
}

.weekly-review-trade-pnl[style*="color: var(--color-red)"],
.weekly-review-trade-pnl[style*="var(--color-red)"] {
  color: var(--color-red) !important;
}
.weekly-review-trade-pnl.negative { /* Added specific class */
   color: var(--chart-negative) !important;
}

/* Performance Grades */
.weekly-review-grades { /* Restored simple container */
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.weekly-review-grade-item { /* Restored simpler item */
  background-color: var(--background-secondary);
  border-radius: 8px;
  padding: 16px;
}

.weekly-review-grade-label {
  font-size: 14px; /* Restored */
  font-weight: 500;
  margin-bottom: 8px;
  color: var(--text-normal);
}

/* Performance grade stars */
.weekly-review-grade-stars {
  display: flex;
  gap: 8px;
  margin-bottom: 12px;
  position: relative;
}

.weekly-review-star {
  cursor: pointer;
  color: var(--text-muted);
  transition: color 0.2s ease;
  font-size: 1.5em;
  user-select: none;
  position: relative;
  display: inline-block;
  width: 1em;
  height: 1em;
  line-height: 1;
  text-align: center;
}

.weekly-review-star.full {
  color: gold !important;
}

.weekly-review-star.half {
  position: relative;
  color: var(--text-muted);
}

.weekly-review-star.half::after {
  content: "\u2605";
  position: absolute;
  left: 0;
  top: 0;
  width: 50%;
  overflow: hidden;
  color: gold !important;
  pointer-events: none;
}

/* Tooltip for star rating help */
.weekly-review-grade-stars::after {
  content: "Left click for full star, right click for half star";
  position: absolute;
  font-size: 10px;
  color: var(--text-muted);
  opacity: 0;
  transition: opacity 0.3s ease;
  margin-top: 30px;
  background: var(--background-primary);
  padding: 4px 8px;
  border-radius: 4px;
  pointer-events: none;
  border: 1px solid var(--background-modifier-border);
  white-space: nowrap;
  z-index: 100;
}

.weekly-review-grade-stars:hover::after {
  opacity: 1;
}


/* Daily Report Cards (DRCs) List - Modernized Styling */
.weekly-review-drcs {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

/* DRC List Container */
.weekly-review-drc-list {
  display: flex;
  flex-direction: column;
  gap: 16px;
  width: 100%;
}

/* DRC Card Container - modern card styling */
.weekly-review-drc-card {
  background-color: var(--background-primary);
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
  border: 1px solid var(--background-modifier-border);
}

/* DRC Header with date, grades and button */
.weekly-review-drc-header {
  background-color: var(--background-secondary-alt, var(--background-secondary));
  padding: 10px 16px; /* Reduced padding */
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 1px solid var(--background-modifier-border);
}

.weekly-review-drc-date {
  font-weight: 600;
  font-size: 15px;
  color: var(--text-normal);
  flex: 1;
}

/* Grade Pills in the center */
.weekly-review-drc-grades {
  display: flex;
  gap: 10px;
  justify-content: center;
  flex: 2;
}

.weekly-review-drc-grade {
  font-size: 12px;
  padding: 4px 8px;
  border-radius: 4px;
  background-color: var(--background-secondary-alt, var(--background-secondary));
  font-weight: 500;
  display: inline-flex;
  align-items: center;
  line-height: 1;
  color: white;
}

/* Color coding for grades */
.weekly-review-drc-grade.grade-a {
  background-color: var(--color-green, #43a047);
}

.weekly-review-drc-grade.grade-b {
  background-color: var(--color-orange, #fb8c00);
}

.weekly-review-drc-grade.grade-c {
  background-color: var(--color-red, #e53935);
}

/* Fallback for direct text matching if classes aren't applied */
.weekly-review-drc-grade[data-grade="A"] {
  background-color: var(--color-green, #43a047);
}

.weekly-review-drc-grade[data-grade="B"] {
  background-color: var(--color-orange, #fb8c00);
}

.weekly-review-drc-grade[data-grade="C"] {
  background-color: var(--color-red, #e53935);
}

/* DRC Content Area */
.weekly-review-drc-summary {
  padding: 14px 16px;
  display: flex;
  flex-direction: column;
  gap: 12px;
  background-color: var(--background-primary-alt, var(--background-primary));
}

.weekly-review-drc-section {
  padding: 12px;
  background-color: var(--background-secondary);
  border-radius: 6px;
}

.weekly-review-drc-section-label {
  font-weight: 500;
  font-size: 13px;
  margin-bottom: 6px;
  color: var(--text-accent);
}

.weekly-review-drc-section-content {
  font-size: 14px;
  line-height: 1.5;
  color: var(--text-normal);
  white-space: pre-line;
  overflow-wrap: break-word;
}

/* DRC Actions Area - now in header */
.weekly-review-drc-actions {
  display: flex;
  justify-content: flex-end;
  flex: 1;
}

.weekly-review-drc-button {
  background-color: var(--interactive-accent);
  color: var(--text-on-accent, white);
  border: none;
  border-radius: 6px;
  padding: 6px 12px;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: background-color 0.15s ease;
  display: flex;
  align-items: center;
  gap: 6px;
}

.weekly-review-drc-button:hover {
  background-color: var(--interactive-accent-hover);
}

.weekly-review-drc-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* Legacy DRC item style for compatibility */
.weekly-review-drc-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 16px;
  background-color: var(--background-secondary);
  border-radius: 6px;
  cursor: pointer;
  transition: background-color 0.2s ease;
}

.weekly-review-drc-item:hover {
  background-color: var(--background-modifier-hover);
}

/* Review Questions Section */
.weekly-review-questions { /* Restored */
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.weekly-review-question-section { /* Added back if used */
  margin-bottom: 15px;
}

.weekly-review-question { /* For individual question container */
  background-color: var(--background-secondary);
  border-radius: 8px;
  padding: 16px;
}

.weekly-review-question-text { /* For the text of the question */
  font-weight: 500;
  margin-bottom: 12px;
  color: var(--text-normal);
}

/* Goals Section Restored */
.weekly-review-goal-input {
  display: flex;
  gap: 10px;
  margin-bottom: 15px;
}
.weekly-review-goal-input input {
  flex: 1;
  padding: 8px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  background-color: var(--background-primary);
  color: var(--text-normal);
}
.weekly-review-goals-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
}
.weekly-review-goal-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 12px;
  background-color: var(--background-secondary);
  border-radius: 4px;
}


/* Chart Tooltip */
.weekly-review-chart-tooltip {
  background-color: var(--background-primary) !important;
  border-radius: 10px !important;
  padding: 14px 18px !important;
  border: 1px solid var(--background-modifier-border) !important;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2) !important;
}

.weekly-review-tooltip-setup,
.weekly-review-tooltip-date {
  font-size: 14px !important;
  font-weight: 500 !important;
  color: var(--text-normal) !important;
  margin-bottom: 8px !important;
  text-align: center !important;
}

.weekly-review-tooltip-value {
  font-size: 20px !important;
  font-weight: 600 !important;
  text-align: center !important;
}

.weekly-review-tooltip-value.positive {
  color: var(--chart-positive) !important;
}

.weekly-review-tooltip-value.negative {
  color: var(--chart-negative) !important;
}

.weekly-review-tooltip-info {
  font-size: 12px !important;
  color: var(--text-muted) !important;
  margin-top: 6px !important;
  text-align: center !important;
}

/* Responsive Styles */
@media (max-width: 768px) {
  .weekly-review-metric-cards {
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
  }

  .weekly-review-navigation-links {
    justify-content: center;
    flex-wrap: wrap;
    width: 100%;
  }

  .weekly-review-nav-button {
    flex: 1;
    min-width: 120px;
    justify-content: center;
  }

  .weekly-review-tab {
    padding: 10px 12px;
    font-size: 13px;
  }

  /* Added back */
  .weekly-review-tabs {
    flex-wrap: wrap;
  }
  .weekly-review-tab {
    flex-grow: 1;
    text-align: center;
  }
}

/* Removed duplicate :root block */

/* Fullscreen Image Styles */
.weekly-review-fullscreen-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background-color: rgba(0, 0, 0, 0.85);
  z-index: 4000; /* Reduced from 1000000 to prevent blocking interactions */
  display: flex;
  align-items: center;
  justify-content: center;
  animation: fadeIn 0.3s ease-in-out;
  backdrop-filter: blur(5px);
  -webkit-backdrop-filter: blur(5px);
  cursor: pointer;
}

.weekly-review-fullscreen-content {
  max-width: 90vw;
  max-height: 90vh;
  display: flex;
  flex-direction: column;
  background-color: var(--background-primary);
  border-radius: 8px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
  animation: zoomIn 0.3s ease-in-out;
  overflow: hidden;
  cursor: default;
}

.weekly-review-fullscreen-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 16px;
  background-color: var(--background-secondary);
  border-bottom: 1px solid var(--background-modifier-border);
}

.weekly-review-fullscreen-header h3 {
  margin: 0;
  font-size: 18px;
  font-weight: 600;
  color: var(--text-normal);
}

.weekly-review-fullscreen-close {
  background-color: rgba(229, 57, 53, 0.1);
  color: var(--color-error, #e53935);
  border: none;
  border-radius: 4px;
  padding: 6px 12px;
  font-size: 14px;
  cursor: pointer;
}

.weekly-review-fullscreen-close:hover {
  background-color: rgba(229, 57, 53, 0.2);
}

.weekly-review-fullscreen-image-container {
  overflow: auto;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 16px;
  background-color: var(--background-primary);
  max-height: calc(90vh - 120px);
  /* Add subtle grid background for transparency */
  background-image: linear-gradient(45deg, var(--background-secondary) 25%, transparent 25%, transparent 75%, var(--background-secondary) 75%),
               linear-gradient(45deg, var(--background-secondary) 25%, transparent 25%, transparent 75%, var(--background-secondary) 75%);
  background-size: 20px 20px;
  background-position: 0 0, 10px 10px;
}

.weekly-review-fullscreen-image {
  max-width: 100%;
  max-height: calc(90vh - 120px);
  object-fit: contain;
  border-radius: 4px;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
}

.weekly-review-fullscreen-footer {
  padding: 10px 16px;
  background-color: var(--background-secondary);
  border-top: 1px solid var(--background-modifier-border);
  text-align: center;
}

.weekly-review-fullscreen-footer p {
  margin: 0;
  font-size: 12px;
  color: var(--text-muted);
}

/* Info text for guidance */
.weekly-review-info-text {
  padding: 10px 14px;
  text-align: center;
  color: var(--text-muted);
  font-style: italic;
  background-color: var(--background-primary-alt, var(--background-secondary));
  border-radius: 6px;
  border-left: 3px solid var(--text-accent);
  margin-top: 8px;
  font-size: 14px;
}

/* Add hint that images can be clicked and held */
.weekly-review-forecast-image {
  cursor: zoom-in !important;
  position: relative;
}

.weekly-review-forecast-image::after {
  content: "Click or hold to enlarge";
  position: absolute;
  bottom: 8px;
  right: 8px;
  background-color: rgba(0, 0, 0, 0.6);
  color: white;
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 10px;
  opacity: 0;
  transition: opacity 0.2s ease;
}

.weekly-review-forecast-image:hover::after {
  opacity: 1;
}

/* Enhanced PnL values for better visibility */
.weekly-review-best-trade-pnl {
  font-size: 20px !important;
  font-weight: 700 !important;
  padding: 4px 10px !important;
  border-radius: 4px !important;
  display: inline-block !important;
}

.weekly-review-best-trade-pnl[style*="color: var(--color-green)"] {
  background-color: rgba(67, 160, 71, 0.15) !important;
}

.weekly-review-best-trade-pnl[style*="color: var(--color-red)"] {
  background-color: rgba(229, 57, 53, 0.15) !important;
}

/* Animations */
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes zoomIn {
  from { transform: scale(0.9); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}
`;function BC(){try{let e="weekly-review-styles";if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=dK,document.head.appendChild(t)}catch(e){console.error("Failed to inject Weekly Review styles:",e)}}function U2(){try{let t=document.getElementById("weekly-review-styles");t&&t.parentNode&&t.parentNode.removeChild(t)}catch(e){console.error("Failed to remove Weekly Review styles:",e)}}function uK(){try{let e="weekly-review-alignment-fix";if(!document.getElementById(e)){let t=document.createElement("style");t.id=e,t.textContent=`
        /* Core alignment fixes for Weekly Review */
        .weekly-review-content {
          padding: 20px 0 0 !important;
        }

        .weekly-review-section {
          width: 100% !important;
          margin-left: 0 !important;
          margin-right: 0 !important;
          margin-bottom: 24px !important;
          box-sizing: border-box !important;
        }

        /* Fix for nested containers in tabs */
        .weekly-review-preparation,
        .weekly-review-overview,
        .weekly-review-review {
          padding: 0 !important;
          width: 100% !important;
        }

        /* High priority rule for all event/forecast/question containers */
        .weekly-review-event-item,
        .weekly-review-forecast-section,
        .weekly-review-grade-item,
        .weekly-review-question,
        /* .weekly-review-drc-list, /* These seem specific to Overview/Review tabs */
        /* .weekly-review-goals-list, */
        /* .weekly-review-drc-card, */
        .weekly-review-event-selector {
          width: 100% !important;
          box-sizing: border-box !important;
        }

        /* Make sure tables span full width and have consistent styling */
        .weekly-review-trades-table,
        .weekly-review-setup-table {
          width: 100% !important;
          overflow-x: auto !important;
          margin-bottom: 16px !important;
        }

        /* Table styling with high specificity for consistent rendering */
        .weekly-review-trades-table table,
        .weekly-review-setup-table table {
          width: 100% !important;
          border-collapse: collapse !important;
          font-size: 14px !important;
          text-align: left !important;
          margin: 0 !important;
          table-layout: auto !important;
        }

        /* Table headers */
        .weekly-review-trades-table th,
        .weekly-review-setup-table th {
          padding: 10px 12px !important;
          border-bottom: 2px solid var(--background-modifier-border) !important;
          font-weight: 600 !important;
          color: var(--text-normal) !important;
          background-color: var(--background-secondary) !important;
          text-align: left !important;
          white-space: nowrap !important;
        }

        /* Table cells */
        .weekly-review-trades-table td,
        .weekly-review-setup-table td {
          padding: 8px 12px !important;
          border-bottom: 1px solid var(--background-modifier-border) !important;
          text-align: left !important;
          transition: background-color 0.2s ease !important;
        }

        /* Clickable trade rows */
        .weekly-review-trade-row {
          cursor: pointer !important;
          transition: background-color 0.2s ease !important;
        }

        .weekly-review-trade-row:hover {
          background-color: var(--background-modifier-hover) !important;
        }

        /* Hover effect for table rows */
        .weekly-review-trades-table tr:hover td,
        .weekly-review-setup-table tr:hover td {
          background-color: var(--background-modifier-hover) !important;
        }

        /* Ensure color styles are properly applied in table cells */
        .weekly-review-trades-table td[style*="color: var(--color-green)"],
        .weekly-review-setup-table td[style*="color: var(--color-green)"] {
          color: var(--color-green, #43a047) !important;
        }

        .weekly-review-trades-table td[style*="color: var(--color-red)"],
        .weekly-review-setup-table td[style*="color: var(--color-red)"] {
          color: var(--color-red, #e53935) !important;
        }

        /* Best/Worst Trade section styles */
.weekly-review-best-trade {
        border: 1px solid var(--background-modifier-border) !important;
        border-radius: 6px !important;
        overflow: hidden !important;
        background-color: var(--background-secondary) !important;
}

/* Added styling for the notes section with tags and mistakes */
.weekly-review-best-trade-notes {
        padding: 0 16px 12px !important;
        display: flex !important;
        flex-direction: column !important;
        gap: 8px !important;
}

/* Special styling for best/worst trades */
.weekly-review-best-trade.best-trade {
  border-left: 3px solid var(--color-green, #43a047) !important;
}

.weekly-review-best-trade.worst-trade {
  border-left: 3px solid var(--color-red, #e53935) !important;
}

        .weekly-review-best-trade-header {
          display: flex !important;
          justify-content: space-between !important;
          align-items: center !important;
          padding: 12px 16px !important;
          background-color: var(--background-secondary-alt, var(--background-secondary)) !important;
          border-bottom: 1px solid var(--background-modifier-border) !important;
        }

        .weekly-review-best-trade-details {
          padding: 12px 16px !important;
        }

        .weekly-review-best-trade-detail {
          margin-bottom: 6px !important; /* Reduced from 8px for more even spacing */
          display: flex !important;
          align-items: center !important;
          width: 100% !important;
        }
        
        /* Last detail item should have no bottom margin */
        .weekly-review-best-trade-detail:last-child {
          margin-bottom: 0 !important;
        }

        .weekly-review-best-trade-label {
          font-weight: 500 !important;
          width: 80px !important;
          color: var(--text-muted) !important;
        }

        .weekly-review-view-button {
          background-color: var(--interactive-accent) !important;
          color: var(--text-on-accent) !important;
          border: none !important;
          border-radius: 4px !important;
          padding: 8px 16px !important;
          font-size: 14px !important;
          cursor: pointer !important;
          margin-top: 8px !important;
          transition: background-color 0.2s ease !important;
        }

        .weekly-review-view-button:hover {
          background-color: var(--interactive-accent-hover) !important;
        }

        .weekly-review-view-button:disabled {
          opacity: 0.5 !important;
          cursor: not-allowed !important;
        }

        .weekly-review-best-trade-actions {
          padding: 0 16px 16px !important;
          display: flex !important;
          justify-content: flex-end !important;
        }
        
        /* Force proper styling for tags and mistakes section */
        .weekly-review-best-trade-notes {
          padding: 0 16px 12px !important;
          display: flex !important;
          flex-direction: column !important;
          gap: 8px !important;
          width: 100% !important;
          box-sizing: border-box !important;
        }

        /* Make sure charts span full width */
        .recharts-responsive-container {
          width: 100% !important;
        }

        /* Force layout of header to match DRC style exactly */
        .weekly-review-header {
          padding: 16px 20px 12px !important;
          background-color: var(--background-secondary) !important;
          text-align: center !important;
          border-bottom: 1px solid var(--background-modifier-border) !important;
          display: block !important;
          flex-direction: unset !important;
          box-sizing: border-box !important;
          width: 100% !important;
        }

        .weekly-review-date {
          font-size: 18px !important;
          font-weight: 600 !important;
          color: var(--text-normal) !important;
          margin-bottom: 12px !important;
          text-align: center !important;
        }

        .weekly-review-navigation {
          width: 100% !important;
          padding-top: 10px !important;
          border-top: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1)) !important;
          display: block !important;
          /* Removed margin overrides from invalid file */
        }

        .weekly-review-navigation-links {
          display: flex !important;
          justify-content: space-between !important;
          align-items: center !important;
          gap: 8px !important;
          flex-wrap: wrap !important;
          width: 100% !important;
        }

        /* Higher specificity for navigation buttons */
        body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button,
        html .weekly-review-container .weekly-review-navigation .weekly-review-nav-button,
        .workspace-leaf .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button {
          padding: 8px 14px !important;
          border: 1px solid var(--background-modifier-border) !important;
          border-radius: 4px !important;
          background-color: var(--background-primary) !important;
          color: var(--text-normal) !important;
          cursor: pointer !important;
          font-size: 14px !important;
          transition: all 0.2s !important;
          display: flex !important;
          align-items: center !important;
          gap: 6px !important;
          /* Flex restored */
          flex: 1 !important;
          justify-content: center !important;
          text-align: center !important;
          min-width: 120px !important;
        }

        /* Extra specificity for hover state */
        body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button:hover,
        html .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button:hover,
        .workspace-leaf .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button:hover {
          background-color: var(--background-modifier-hover) !important;
          transform: translateY(-1px) !important;
        }

        /* Fix for nav icon in weekly review - higher specificity */
        body .weekly-review-nav-button .nav-icon,
        html .weekly-review-container .weekly-review-navigation .weekly-review-nav-button .nav-icon {
          font-size: 16px !important;
          line-height: 1 !important;
        }

        /* Enhanced duplicate prevention for weekly review components */
        /* First rule: Hide any weekly review view that comes after another one */
        .markdown-preview-view .journalit-weekly-review-view[data-file-path] + .journalit-weekly-review-view[data-file-path],
        .markdown-reading-view .journalit-weekly-review-view[data-file-path] + .journalit-weekly-review-view[data-file-path],
        /* Second rule: Hide direct duplicates */
        .markdown-preview-view .journalit-weekly-review-view + .journalit-weekly-review-view,
        .markdown-reading-view .journalit-weekly-review-view + .journalit-weekly-review-view,
        /* Third rule: Hide duplicate wrappers */
        .weekly-review-wrapper + .weekly-review-wrapper {
          display: none !important; /* Hide any second Weekly Review component that appears after another one */
        }

        /* Ensure we never show multiple instances in any mode - additional rules */
        /* Add data-view-mode attribute based rules */
        [data-view-mode="preview"] + [data-view-mode="preview"],
        [data-view-mode="source"] + [data-view-mode="source"],
        /* Strict duplicate prevention by adding direct adjacency rules */
        .journalit-weekly-review-view + .journalit-weekly-review-view,
        [data-view-mode="read"] + [data-view-mode="read"],
        [data-view-mode="read"] + [data-view-mode="read-fallback"],
        [data-view-mode="read-fallback"] + [data-view-mode="read"] {
          display: none !important;
        }

        /* Ultra-high specificity rule for weekly review navigation buttons container */
        html body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links,
        body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links,
        .workspace-leaf .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links {
          display: flex !important;
          justify-content: space-between !important;
          align-items: center !important;
          gap: 8px !important;
          flex-wrap: wrap !important;
          width: 100% !important;
        }

        /* Ultra-high specificity rule for each weekly navigation button */
        html body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button,
        body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button,
        .workspace-leaf .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button {
          padding: 8px 14px !important;
          border: 1px solid var(--background-modifier-border) !important;
          border-radius: 4px !important;
          background-color: var(--background-primary) !important;
          color: var(--text-normal) !important;
          cursor: pointer !important;
          font-size: 14px !important;
          transition: all 0.2s !important;
          display: flex !important;
          align-items: center !important;
          justify-content: center !important;
          gap: 6px !important;
          flex: 1 !important;
          text-align: center !important;
          min-width: 120px !important;
          box-sizing: border-box !important;
        }

        /* Fix mobile layout */
        @media (max-width: 768px) {
          .weekly-review-navigation-links {
            justify-content: center !important;
            flex-wrap: wrap !important;
            width: 100% !important;
          }

          .weekly-review-nav-button {
            flex: 1 !important;
            min-width: 120px !important;
            justify-content: center !important;
          }
        }
      `,document.head.appendChild(t)}}catch(e){console.error("Failed to apply Weekly Review alignment fix:",e)}}function qg(){if(Promise.resolve().then(()=>(Wb(),B2)).then(({ensureFocusManagementStyles:e})=>{e()}).catch(e=>{console.warn("Could not load focus management styles:",e)}),document.getElementById("weekly-review-styles")||BC(),uK(),!document.getElementById("critical-weekly-review-styles")){let e=document.createElement("style");e.id="critical-weekly-review-styles",e.textContent=`
      /* Critical core styles for Weekly Review */
      .journalit-weekly-review-view {
        display: block !important;
        width: 100% !important;
        margin: 0 !important;
        padding: 0 !important;
        z-index: 100 !important;
        visibility: visible !important;
        opacity: 1 !important;
      }

      .weekly-review-wrapper {
        display: block !important; /* Changed from flex */
        width: 100% !important;
        position: relative !important;
        z-index: 100 !important;
      }

      .weekly-review-container {
        display: flex !important;
        flex-direction: column !important;
        width: 100% !important;
      }

      .weekly-review-content {
        display: block !important; /* Ensure content area displays */
        width: 100% !important;
      }

      /* Critical navigation button styling - highest possible specificity (Restored) */
       html body .weekly-review-container .weekly-review-navigation .weekly-review-navigation-links .weekly-review-nav-button {
         /* Keeping basic display/visibility, detailed styles in ensureAlignmentFix */
         display: flex !important;
         visibility: visible !important;
         opacity: 1 !important;
       }

       /* Removed duplicate .weekly-review-wrapper, .container, .content rules */
    `,document.head.appendChild(e)}}Bn();var V2=`
/* Monthly Review Container */
.monthly-review {
  width: 100%;
  padding: 20px;
  max-width: 1200px;
  margin: 0 auto;
}

.monthly-review-title {
  text-align: center;
  margin-bottom: 20px;
  font-size: 28px;
  font-weight: 600;
}

/* Monthly Review Content */
.monthly-review-content {
  margin-top: 8px;
}

/* Section Styles */
.monthly-review-section {
  margin-bottom: 20px;
  background: var(--background-primary-alt);
  padding: 20px;
  border-radius: 8px;
  border: 1px solid var(--background-modifier-border);
}

.monthly-review-section-title {
  font-size: 20px;
  font-weight: 600;
  margin-bottom: 15px;
  color: var(--text-normal);
  text-align: center;
}

.monthly-review-section-description {
  font-size: 14px;
  color: var(--text-muted);
  margin-bottom: 15px;
}

/* Metric Cards */
.monthly-review-metric-cards {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 15px;
  margin-top: 15px;
}

.monthly-review-metric-card {
  background: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  padding: 15px;
  text-align: center;
}

.monthly-review-metric-card.highlight-card {
  position: relative;
}

.monthly-review-metric-label {
  font-size: 12px;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: 8px;
}

.monthly-review-metric-value {
  font-size: 24px;
  font-weight: 600;
  color: var(--text-normal);
}

.monthly-review-metric-detail {
  font-size: 14px;
  color: var(--text-muted);
  margin-top: 4px;
}

/* Best/Worst Trade Cards */
.monthly-review-best-trade {
  background: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  padding: 20px;
}

.monthly-review-best-trade.best-trade {
  border-left: 3px solid var(--color-green);
}

.monthly-review-best-trade.worst-trade {
  border-left: 3px solid var(--color-red);
}

.monthly-review-best-trade-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
}

.monthly-review-best-trade-title {
  font-size: 16px;
  font-weight: 600;
}

.monthly-review-best-trade-pnl {
  font-size: 20px;
  font-weight: 600;
}

.monthly-review-best-trade-details {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.monthly-review-best-trade-detail {
  display: flex;
  gap: 8px;
  font-size: 14px;
}

.monthly-review-best-trade-label {
  color: var(--text-muted);
  font-weight: 500;
}

.monthly-review-best-trade-value {
  color: var(--text-normal);
}

.monthly-review-best-trade-actions {
  margin-top: 15px;
}

.monthly-review-view-button {
  padding: 6px 12px;
  background: var(--interactive-accent);
  color: var(--text-on-accent);
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
}

.monthly-review-view-button:hover {
  background: var(--interactive-accent-hover);
}

.monthly-review-link-button {
  padding: 4px 8px;
  background: transparent;
  color: var(--text-accent);
  border: 1px solid var(--text-accent);
  border-radius: 4px;
  cursor: pointer;
  font-size: 12px;
  margin-top: 8px;
}

.monthly-review-link-button:hover {
  background: var(--text-accent);
  color: var(--text-on-accent);
}

/* Week Highlights */
.monthly-review-week-highlights {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 15px;
}

/* Weekly Performance Table */
.monthly-review-trades-table {
  width: 100%;
  overflow-x: auto;
}

.monthly-review-trades-table table {
  width: 100%;
  border-collapse: collapse;
}

.monthly-review-trades-table th,
.monthly-review-trades-table td {
  padding: 10px;
  text-align: left;
  border-bottom: 1px solid var(--background-modifier-border);
}

.monthly-review-trades-table th {
  font-weight: 600;
  color: var(--text-muted);
  font-size: 12px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.monthly-review-trade-row {
  cursor: pointer;
  transition: background-color 0.2s;
}

.monthly-review-trade-row:hover {
  background: var(--background-modifier-hover);
}

/* Demon Tracker Styles */
.demon-tracker-container {
  margin-top: 15px;
}

.demon-tracker-table {
  width: 100%;
  border-collapse: collapse;
  background: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  overflow: hidden;
}

.demon-tracker-table th,
.demon-tracker-table td {
  padding: 12px;
  text-align: center;
  border-right: 1px solid var(--background-modifier-border);
}

.demon-tracker-table th:last-child,
.demon-tracker-table td:last-child {
  border-right: none;
}

.demon-tracker-header {
  background: var(--background-secondary);
  font-weight: 600;
  font-size: 14px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  color: var(--text-muted);
}

.demon-tracker-header.stop-trading {
  background: var(--background-modifier-error);
  color: var(--text-error);
}

.demon-tracker-row {
  border-top: 1px solid var(--background-modifier-border);
}

.demon-tracker-row:hover {
  background: var(--background-modifier-hover);
}

.demon-name {
  text-align: left;
  font-weight: 500;
  color: var(--text-normal);
}

.demon-occurrence {
  position: relative;
}

.demon-x {
  color: var(--text-error);
  font-weight: 600;
  font-size: 18px;
}

.demon-x.stop {
  color: var(--text-on-accent);
  background: var(--background-modifier-error);
  border-radius: 50%;
  width: 24px;
  height: 24px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

.demon-empty {
  color: var(--text-faint);
  font-size: 14px;
}

/* Demon Tracker Summary */
.demon-tracker-summary {
  margin-top: 20px;
  display: flex;
  gap: 20px;
  flex-wrap: wrap;
}

.demon-summary-item {
  display: flex;
  align-items: center;
  gap: 8px;
}

.demon-summary-label {
  font-size: 14px;
  color: var(--text-muted);
}

.demon-summary-value {
  font-size: 16px;
  font-weight: 600;
  color: var(--text-normal);
}

.demon-summary-item.warning .demon-summary-value {
  color: var(--text-error);
}

/* Review Content Placeholder */
.monthly-review-content-placeholder {
  padding: 40px;
  text-align: center;
  color: var(--text-muted);
  background: var(--background-secondary-alt);
  border-radius: 6px;
  border: 1px dashed var(--background-modifier-border);
}

/* Navigation */
.monthly-review-navigation {
  width: 100%;
  padding-top: 10px;
  border-top: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1));
  margin-bottom: 8px;
}

.monthly-review-navigation-links {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 8px;
  flex-wrap: wrap;
  width: 100%;
}

.monthly-review-navigation-button {
  padding: 8px 14px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  background-color: var(--background-primary);
  color: var(--text-normal);
  cursor: pointer;
  font-size: 14px;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  flex: 1;
  text-align: center;
  min-width: 120px;
  box-sizing: border-box;
}

.monthly-review-navigation-button:hover {
  background-color: var(--background-modifier-hover);
  transform: translateY(-1px);
}

.monthly-review-navigation-button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* Tab Navigation */
.monthly-review-tabs-container {
  display: flex;
  justify-content: center;
  border-bottom: 1px solid var(--background-modifier-border);
  background-color: var(--background-secondary-alt, #2a2a2a);
  padding: 0;
  margin-bottom: 8px;
}

.monthly-review-tabs {
  display: flex;
  justify-content: center;
  background-color: transparent;
  max-width: 600px;
  margin: 0 auto;
}

.monthly-review-tab {
  padding: 12px 24px;
  font-size: 14px;
  font-weight: 600;
  color: var(--text-muted);
  background-color: transparent;
  border: none;
  border-bottom: 2px solid transparent;
  cursor: pointer;
  transition: all 0.2s ease;
  position: relative;
  outline: none;
}

.monthly-review-tab:hover {
  color: var(--text-normal);
  background-color: rgba(127, 127, 127, 0.05);
}

.monthly-review-tab.active {
  color: var(--text-accent);
  border-bottom: 2px solid var(--text-accent);
}

/* Charts */
.monthly-review-overview .recharts-responsive-container {
  margin: 0 auto;
}

/* Overview Tab */
.monthly-review-overview {
  padding-top: 4px;
}

/* Review Tab */
.monthly-review-review {
  padding-top: 4px;
}

/* Reduce spacing for first elements in tab content */
.monthly-review-overview > *:first-child,
.monthly-review-review > *:first-child {
  margin-top: 0 !important;
}

/* Game Performance Tables */
.grade-count {
  text-align: center;
  font-weight: 600;
  padding: 8px;
}

.grade-count.grade-a {
  color: var(--color-green, #43a047);
}

.grade-count.grade-b {
  color: var(--color-orange, #fb8c00);
}

.grade-count.grade-c {
  color: var(--color-red, #e53935);
}

.rating-cell {
  text-align: center;
  font-weight: 600;
}

.notes-cell {
  max-width: 300px;
}

.notes-content {
  white-space: pre-wrap;
  word-break: break-word;
  line-height: 1.4;
  color: var(--text-muted);
  font-size: 13px;
}

.empty-performance-message {
  text-align: center;
  color: var(--text-muted);
  padding: 20px;
  font-style: italic;
}
`;var gl=null;function H2(){gl||(gl=document.createElement("style"),gl.textContent=V2,gl.id="journalit-monthly-review-styles",document.head.appendChild(gl))}function pK(){gl&&(gl.remove(),gl=null)}function Gg(){gl||H2()}Z.monthlyReview={inject:H2,remove:pK};var mK=`
  /* Fix for Custom Options edit input */
  .journalit-settings.journalit-settings-tab .option-edit-input {
    flex: 1 !important;
    margin-right: 12px !important;
    padding: 6px 10px !important;
    border: 1px solid var(--interactive-accent) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.3) !important;
    position: relative !important;
    z-index: 100 !important;
    min-width: 100px !important;
    pointer-events: auto !important;
    -webkit-user-select: text !important;
    user-select: text !important;
    cursor: text !important;
  }

  /* DRC, Weekly Review, and Custom Options Settings Styles */
  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add,
  .journalit-settings.journalit-settings-tab .custom-options-settings .custom-item-add {
    display: flex !important;
    flex-direction: row !important;
    align-items: center !important;
    width: 100% !important;
    gap: 10px !important;
    margin-bottom: 16px !important;
    position: relative !important;
    padding: 4px 0 !important;
  }

  /* Override any Obsidian styling that might interfere */
  .journalit-settings.journalit-settings-tab .drc-settings input[type="text"],
  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add input,
  .journalit-settings.journalit-settings-tab .weekly-review-settings input[type="text"],
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add input,
  .journalit-settings.journalit-settings-tab .custom-options-settings input[type="text"],
  .journalit-settings.journalit-settings-tab .custom-options-settings .custom-item-add input {
    height: 34px !important;
    line-height: normal !important;
    font-size: 14px !important;
    padding: 6px 10px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    width: 100% !important;
    box-sizing: border-box !important;
    margin: 0 !important;
    appearance: none !important;
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
  }

  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add .input,
  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add input,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add .input,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add input,
  .journalit-settings.journalit-settings-tab .custom-options-settings .custom-item-add .input,
  .journalit-settings.journalit-settings-tab .custom-options-settings .custom-item-add input {
    width: 100% !important;
    height: 34px !important;
    max-height: 34px !important;
    padding: 6px 10px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    font-size: 14px !important;
    box-shadow: none !important;
    transition: border-color 0.15s ease, box-shadow 0.15s ease !important;
    line-height: normal !important;
    min-height: 34px !important;
    display: inline-block !important;
    appearance: none !important;
    overflow: visible !important;
  }

  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add .input:focus,
  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add input:focus,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add .input:focus,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add input:focus {
    border-color: var(--interactive-accent) !important;
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2) !important;
    outline: none !important;
  }

  /* Style Input component's internals */
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .drc-settings .custom-item-add .inputContainer,
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .drc-settings .custom-item-add .inputWrapper,
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .weekly-review-settings .custom-item-add .inputContainer,
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .weekly-review-settings .custom-item-add .inputWrapper {
    margin: 0 !important;
    padding: 0 !important;
    width: 100% !important;
    position: relative !important;
    display: block !important;
    height: 34px !important;
  }

  /* Style Input's invisible parent divs */
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .drc-settings .custom-item-add div,
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .drc-settings .custom-item-add .setting-item-info div,
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .weekly-review-settings .custom-item-add div,
  body .vertical-tab-header .vertical-tab-content-container .vertical-tab-content .journalit-settings-tab .weekly-review-settings .custom-item-add .setting-item-info div {
    height: auto !important;
    min-height: 34px !important;
    width: 100% !important;
    position: relative !important;
  }

  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add .inputContainer,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add .inputContainer {
    margin: 0 !important;
    padding: 0 !important;
    width: 100% !important;
    position: relative !important;
    display: block !important;
  }

  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add .setting-item-info,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add .setting-item-info {
    margin-right: 10px !important;
    flex: 1 !important;
    display: flex !important;
    flex-direction: column !important;
    justify-content: center !important;
  }

  /* Styles for the Add button */
  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add .setting-item-control,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add .setting-item-control {
    display: flex !important;
    align-items: center !important;
    justify-content: flex-end !important;
    min-width: auto !important;
    flex-shrink: 0 !important;
  }

  /* Ensure buttons have consistent styling */
  .journalit-settings.journalit-settings-tab .drc-settings .custom-item-add button,
  .journalit-settings.journalit-settings-tab .weekly-review-settings .custom-item-add button {
    min-width: 60px !important;
    height: 34px !important;
    max-height: 34px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    font-size: 14px !important;
    font-weight: 500 !important;
    padding: 6px 12px !important;
    border-radius: 4px !important;
    background-color: var(--interactive-accent) !important;
    color: #ffffff !important;
    border: 1px solid var(--interactive-accent) !important;
    cursor: pointer !important;
    transition: background-color 0.15s ease !important;
  }

  .journalit-settings.journalit-settings-tab .drc-settings button:hover,
  .journalit-settings.journalit-settings-tab .weekly-review-settings button:hover {
    background-color: var(--interactive-accent-hover) !important;
    border-color: var(--interactive-accent-hover) !important;
  }

  /* Direct styling for DRCSettingsTab, WeeklyReviewSettingsTab, and CustomOptionsTab input boxes */
  /* First, add general selector for all input boxes in custom-item-add */
  .journalit-settings .drc-settings .custom-item-add input,
  .journalit-settings .weekly-review-settings .custom-item-add input,
  .journalit-settings .custom-options-settings .custom-item-add input,
  /* Then, add specific selectors for known inputs */
  .journalit-settings input[placeholder="New checklist item"],
  .journalit-settings input[placeholder="New review question"],
  .journalit-settings input[placeholder="New timeframe (e.g., 15M, 5M)"],
  .journalit-settings input[placeholder="New timeframe (e.g., 4H, 1H)"],
  .journalit-settings input[placeholder="New timeframe (e.g., Weekly, Daily)"] {
    height: 34px !important;
    width: 100% !important;
    padding: 6px 10px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    font-size: 14px !important;
    box-shadow: none !important;
    transition: border-color 0.15s ease, box-shadow 0.15s ease !important;
    line-height: normal !important;
    min-height: 34px !important;
    display: inline-block !important;
    appearance: none !important;
    overflow: visible !important;
    margin: 0 !important;
  }

  /* Focus styles for all input boxes */
  .journalit-settings .drc-settings .custom-item-add input:focus,
  .journalit-settings .weekly-review-settings .custom-item-add input:focus,
  .journalit-settings .custom-options-settings .custom-item-add input:focus,
  .journalit-settings input[placeholder="New checklist item"]:focus,
  .journalit-settings input[placeholder="New review question"]:focus,
  .journalit-settings input[placeholder="New timeframe (e.g., 15M, 5M)"]:focus,
  .journalit-settings input[placeholder="New timeframe (e.g., 4H, 1H)"]:focus,
  .journalit-settings input[placeholder="New timeframe (e.g., Weekly, Daily)"]:focus {
    /* These focus styles ensure all input boxes have the same appearance when focused */
    border-color: var(--interactive-accent) !important;
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2) !important;
    outline: none !important;
  }

  /* Accordion Component Styles */
  .cmdr-accordion {
    margin-bottom: 16px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    overflow: visible; /* Changed from hidden to visible */
    transition: box-shadow 0.2s ease;
  }

  .cmdr-accordion:hover {
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
  }

  .cmdr-accordion .cmdr-accordion-header {
    display: flex;
    align-items: center;
    padding: 12px 16px;
    cursor: pointer;
    background-color: var(--background-secondary);
    transition: background-color 0.15s ease;
  }

  .cmdr-accordion .cmdr-accordion-header:hover {
    background-color: var(--background-modifier-hover);
  }

  .cmdr-accordion .cmdr-accordion-chevron > svg {
    transition: transform 0.3s ease-in-out;
  }

  .cmdr-accordion .cmdr-accordion-content {
    max-height: none; /* Removed the fixed max-height */
    transition: max-height 0.3s ease-in-out, padding 0.3s ease-in-out, margin 0.3s ease-in-out;
    overflow: visible; /* Changed from hidden to visible for expanded state */
    background-color: var(--background-primary);
    padding: 16px;
  }

  /* Fix for Weekly Review accordion - Remove borders from inside accordion content to prevent duplicate borders
   * This ensures consistent styling between Daily Review and Weekly Review sections.
   * The issue was that the first setting-item inside the accordion had a border-top which created
   * a duplicate border when the accordion already has its own border.
   */
  .cmdr-accordion .cmdr-accordion-content .timeframe-manager > .setting-item:first-child,
  .cmdr-accordion .cmdr-accordion-content .item-manager > .setting-item:first-child,
  .cmdr-accordion .cmdr-accordion-content > div > .setting-item:first-child,
  .cmdr-accordion .cmdr-accordion-content > .setting-item:first-child {
    border-top: none !important;
  }

  /* Remove border around weekly-review-section to match daily-review-section */
  .cmdr-accordion .cmdr-accordion-content .weekly-review-section {
    border: none !important;
    border-radius: 0 !important;
    padding: 0 !important;
    background-color: transparent !important;
  }

  /* Style for consistent input heights/spacing specifically for the timeframe manager */
  .timeframe-manager .custom-item-add .inputContainer,
  .timeframe-manager .custom-item-add input {
    height: 34px !important;
    min-height: 34px !important;
    margin: 0 !important;
    width: 100% !important;
  }

  /* Collapsed state */
  .cmdr-accordion[aria-expanded="false"] .cmdr-accordion-chevron > svg {
    transform: rotate(-90deg);
  }

  .cmdr-accordion[aria-expanded="false"] .cmdr-accordion-content {
    max-height: 0 !important;
    transition: max-height 0.2s ease-out;
    padding-top: 0;
    padding-bottom: 0;
    margin-top: 0;
    margin-bottom: 0;
    overflow: hidden; /* Keep hidden for collapsed state only */
  }
  
  /* Edit account form container - ensure proper layout */
  .journalit-settings .edit-account-form.setting-item-container,
  .journalit-settings.journalit-settings-tab .edit-account-form.setting-item-container {
    display: flex !important;
    flex-direction: column !important;
    width: 100% !important;
    align-items: stretch !important;
  }

  /* Edit account buttons - stronger right alignment */
  .journalit-settings .edit-account-form.setting-item-container .edit-account-buttons,
  .journalit-settings.journalit-settings-tab .edit-account-form.setting-item-container .edit-account-buttons {
    display: flex !important;
    justify-content: flex-end !important;
    width: 100% !important;
    gap: 8px !important;
    margin-top: 16px !important;
    align-self: flex-end !important;
    position: relative !important;
    float: right !important; /* Additional property to force right alignment */
    text-align: right !important; /* Additional property for alignment */
  }
  
  /* Force accounts to display in a single column */
  .journalit-settings .accounts-list,
  .journalit-settings.journalit-settings-tab .accounts-list {
    display: flex !important;
    flex-direction: column !important;
    flex-wrap: nowrap !important;
    width: 100% !important;
  }

  .journalit-settings .account-items,
  .journalit-settings.journalit-settings-tab .account-items {
    display: flex !important;
    flex-direction: column !important;
    width: 100% !important;
    flex-wrap: nowrap !important;
  }

  .journalit-settings .account-item,
  .journalit-settings.journalit-settings-tab .account-item {
    width: 100% !important;
  }

  /* MT Accounts List Styles */
  .mt-accounts-list {
    margin-top: 10px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 8px;
    overflow: hidden;
  }

  .mt-account-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px;
    border-bottom: 1px solid var(--background-modifier-border);
    background-color: var(--background-primary);
  }

  .mt-account-item:last-child {
    border-bottom: none;
  }

  .mt-account-item:hover {
    background-color: var(--background-secondary);
  }

  .mt-account-info {
    flex: 1;
    min-width: 0;
  }

  .mt-account-id {
    font-weight: 600;
    color: var(--text-normal);
    margin-bottom: 4px;
  }

  .mt-account-broker {
    color: var(--text-muted);
    font-size: 0.9em;
    margin-bottom: 4px;
  }

  .mt-account-dates {
    color: var(--text-muted);
    font-size: 0.85em;
  }

  .mt-account-display {
    margin-left: 20px;
    min-width: 250px;
  }

  .mt-account-name {
    display: flex;
    align-items: center;
  }

  .mt-account-name span {
    font-weight: 500;
    color: var(--text-normal);
  }

  .mt-account-edit {
    display: flex;
    align-items: center;
  }

  .mt-account-edit input {
    background-color: var(--background-primary-alt);
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    padding: 4px 8px;
    color: var(--text-normal);
  }

  .mt-account-edit input:focus {
    border-color: var(--interactive-accent);
    outline: none;
  }
`;function UC(){if(document.head.querySelector("#settings-tab-styles"))return;let e=document.createElement("style");e.id="settings-tab-styles",e.textContent=mK,document.head.appendChild(e)}var fK=`
  /**
   * Main container styles
   * These ensure proper containment and isolation of the TradeNote component
   */

  /* Main container */
  .journalit-trade-view,
  .trade-form-view-container .journalit-trade-view {
    margin: 0;
    border-bottom: none;
    padding: 0;
    display: block !important;
    width: 100% !important;
    z-index: 1;
    /* Ensure proper containment */
    position: relative;
    box-sizing: border-box;
    /* Prevent overlaps */
    contain: content;
    /* Ensure proper isolation from other views */
    isolation: isolate;
  }
  
  /* Trade note React root wrapper */
  .journalit-trade-note-wrapper {
    width: 100%;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    contain: content;
    /* Keep React root fully contained */
    isolation: isolate;
    /* Create a new stacking context */
    position: relative;
    /* Ensure clean slate for each instance */
    box-sizing: border-box;
  }
  
  .trade-note-container {
    background-color: var(--background-primary);
    border-radius: var(--border-radius-lg, 8px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    margin: 0;
    overflow: hidden;
    position: relative;
    font-family: var(--font-interface);
    /* Border removed per UI update request */
    /* Ensure isolation */
    isolation: isolate;
    /* Create a new stacking context and force containment */
    contain: layout style paint;
    /* Ensure direct containment within parent */
    width: 100%;
    align-self: flex-start;
    /* Add a subtle distinguishing feature for easier debugging */
    transition: box-shadow 0.2s ease-in-out;
  }
  
  /* Header section with instrument and P&L */
  .trade-note-header {
    padding: 0.8rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    background: linear-gradient(to right, var(--background-secondary), var(--background-primary));
  }
  
  .trade-note-header.profit {
    background: linear-gradient(to right, rgba(102, 187, 106, 0.1), var(--background-primary));
    border-left: 4px solid var(--color-success, #43a047);
  }
  
  .trade-note-header.loss {
    background: linear-gradient(to right, rgba(229, 57, 53, 0.1), var(--background-primary));
    border-left: 4px solid var(--color-error, #e53935);
  }
  
  .trade-note-header.open {
    background: linear-gradient(to right, rgba(33, 150, 243, 0.1), var(--background-primary));
    border-left: 4px solid #2196f3;
  }
  
  .trade-instrument {
    font-size: 1.4rem;
    font-weight: 600;
    color: var(--text-normal);
    display: flex;
    align-items: center;
  }
  
  .trade-direction-icon {
    margin-right: 0.5rem;
    font-size: 1.3rem;
    line-height: 1;
  }
  
  /* Header actions container with edit button and PnL */
  .trade-header-actions {
    display: flex;
    align-items: center;
    gap: 1rem;
  }
  
  /* Edit button styling */
  .trade-edit-button {
    display: flex;
    align-items: center;
    gap: 0.3rem;
    background-color: var(--interactive-accent);
    color: white;
    border: none;
    border-radius: 4px;
    padding: 0.4rem 0.8rem;
    font-size: 0.8rem;
    font-weight: 500;
    cursor: pointer;
    transition: background-color 0.2s;
  }
  
  .trade-edit-button:hover {
    background-color: var(--interactive-accent-hover, var(--interactive-accent));
    opacity: 0.9;
  }
  
  .trade-edit-button svg {
    width: 14px;
    height: 14px;
  }

  .trade-pnl {
    font-size: 1.2rem;
    font-weight: 600;
  }
  
  .profit-text {
    color: var(--color-success, #43a047);
  }
  
  .loss-text {
    color: var(--color-error, #e53935);
  }
  
  .open-text {
    color: #2196f3;
    font-weight: 600;
  }
  
  /* Missed trade badge styling */
  .missed-trade-badge {
    background-color: var(--color-orange, #ff9800);
    color: white;
    padding: 0.2rem 0.6rem;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 700;
    margin-left: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
  }
  
  /* Open trade badge styling */
  .open-trade-badge {
    background-color: #2196f3;
    color: white;
    padding: 0.2rem 0.6rem;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 700;
    margin-left: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
  }
  
  /* Removed tabs navigation - single page layout */
  
  /* Single page content container */
  .trade-note-content {
    padding: 0;
    display: flex;
    flex-direction: column;
    gap: 0.5rem; /* Reduced gap to minimize wasted space between sections */
  }
  
  /* Trade overview section with metrics */
  .trade-overview-section {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    padding: 0;
    position: relative;
    margin-bottom: 0;
  }

  /* Metrics grid - single row */
  .trade-metrics-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 0.8rem;
    margin-bottom: 0;
  }
  
  .metric-card {
    background-color: var(--background-primary);
    padding: 0.7rem;
    border-radius: var(--border-radius-md, 4px);
    border: 1px solid var(--background-modifier-border);
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    transition: transform 0.2s, box-shadow 0.2s, border-color 0.2s;
  }
  
  .metric-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 3px 6px rgba(0, 0, 0, 0.08);
    border-color: var(--interactive-accent-hover);
  }
  
  .metric-label {
    font-size: 0.75rem;
    color: var(--text-muted);
    text-transform: uppercase;
    margin-bottom: 0.2rem;
    letter-spacing: 0.5px;
  }
  
  .metric-value {
    font-size: 1.2rem;
    font-weight: 600;
    color: var(--text-normal);
    margin-bottom: 0.2rem;
  }
  
  .metric-subtitle {
    font-size: 0.7rem;
    color: var(--text-muted);
  }

  /* Metadata container for accounts and tags - no background */
  .trade-metadata-container {
    display: flex;
    flex-wrap: wrap;
    gap: 0.8rem;
    padding: 0.2rem 0;
  }

  .metadata-section {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .metadata-label {
    font-size: 0.8rem;
    font-weight: 600;
    color: var(--text-muted);
    white-space: nowrap;
  }

  .metadata-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.3rem;
  }
  
  /* Tags styling for setups and mistakes */
  .trade-tags-container {
    margin: 0;
  }
  
  .tags-row {
    display: flex;
    gap: 1rem;
    width: 100%;
  }
  
  .tags-section {
    flex: 1;
    margin-bottom: 0;
    background-color: var(--background-primary);
    border-radius: var(--border-radius-md, 4px);
    padding: 0.7rem;
    border: 1px solid var(--background-modifier-border);
  }
  
  .tags-section h4 {
    font-size: 0.85rem;
    margin-top: 0;
    margin-bottom: 0.5rem;
    color: var(--text-normal);
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 0.3rem;
  }

  /* Only keep icons for setup and mistake headers */
  .setup-section h4::before {
    content: '\u2713'; /* Checkmark symbol */
    color: var(--color-secondary, var(--text-accent));
    font-weight: bold;
  }

  .mistake-section h4::before {
    content: '\u26A0'; /* Warning symbol */
    color: var(--color-error, #e53935);
    font-weight: bold;
  }
  
  .tags-list {
    display: flex;
    flex-wrap: wrap;
    gap: 0.4rem;
  }
  
  .tag {
    padding: 0.35rem 0.7rem;
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 500;
    display: inline-flex;
    align-items: center;
    transition: transform 0.15s ease;
    color: var(--text-normal);
  }

  .tag:hover {
    transform: translateY(-1px);
  }
  
  .setup-tag {
    background-color: rgba(66, 133, 244, 0.15);
    color: rgba(66, 133, 244, 1);
    border: 1px solid rgba(66, 133, 244, 0.3);
  }
  
  .mistake-tag {
    background-color: rgba(229, 57, 53, 0.15);
    color: var(--color-error, #e53935);
    border: 1px solid rgba(229, 57, 53, 0.3);
  }

  .account-tag {
    padding: 0.35rem 0.7rem;
    color: var(--text-accent);
    border-radius: 20px;
    font-size: 0.75rem;
    font-weight: 500;
    display: inline-flex;
    align-items: center;
    cursor: pointer;
    transition: transform 0.15s ease, color 0.15s ease;
    text-decoration: underline;
    text-decoration-style: dotted;
    text-underline-offset: 3px;
  }
  
  .account-tag:hover {
    transform: translateY(-1px);
    color: var(--text-accent-hover, var(--text-accent));
  }
  
  /* Notes preview */
  .trade-notes-preview {
    background-color: var(--background-secondary);
    padding: 1rem;
    border-radius: var(--border-radius-md, 4px);
    margin-top: 1.5rem;
  }
  
  .trade-notes-preview h4 {
    font-size: 0.9rem;
    margin-bottom: 0.8rem;
    color: var(--text-normal);
  }
  
  .trade-notes-preview p {
    color: var(--text-normal);
    font-size: 0.9rem;
    line-height: 1.6;
    margin: 0;
  }
  
  /* Trade details footer - modernized layout */
  .trade-details-footer {
    margin-top: 0;
  }
  
  .details-card {
    background-color: var(--background-primary);
    padding: 1rem;
    border-radius: var(--border-radius-md, 6px);
    box-shadow: 0 1px 5px rgba(0, 0, 0, 0.05);
    border: 1px solid var(--background-modifier-border);
    margin-bottom: 0;
    transition: box-shadow 0.2s ease;
  }

  .details-card:hover {
    box-shadow: 0 3px 8px rgba(0, 0, 0, 0.08);
  }
  
  .details-card.expanded-details {
    width: 100%;
  }

  .details-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.8rem;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--background-modifier-border);
  }
  
  .details-card h4 {
    font-size: 1rem;
    margin: 0;
    color: var(--text-normal);
  }
  
  /* Main content area */
  .trade-main-content {
    display: flex;
    flex-direction: column;
    gap: 0;
  }

  /* Enhanced thesis section styling - no emoji */
  .thesis-section {
    background-color: var(--background-primary);
    padding: 1rem 1.2rem;
    border-radius: var(--border-radius-md, 6px);
    box-shadow: 0 1px 5px rgba(0, 0, 0, 0.05);
    border: 1px solid var(--background-modifier-border);
    margin: 0;
    position: relative;
  }
  
  
  .thesis-section h4 {
    font-size: 1rem;
    margin-top: 0;
    margin-bottom: 1rem;
    color: var(--text-normal);
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--background-modifier-border);
    position: relative;
  }
  
  .thesis-content {
    font-size: 0.95rem;
    line-height: 1.7;
    color: var(--text-normal);
    white-space: pre-wrap;
    padding: 0 0.2rem;
  }
  
  .details-card h4 {
    font-size: 0.9rem;
    margin-top: 0;
    margin-bottom: 0.8rem;
    color: var(--text-normal);
    /* Remove the border-bottom as requested */
    padding-bottom: 0;
  }
  
  .details-table {
    width: 100%;
    border-collapse: collapse;
    table-layout: fixed;
  }
  
  .details-table td {
    padding: 0.6rem 0.5rem;
    font-size: 0.9rem;
    text-overflow: ellipsis;
    overflow: hidden;
    border-bottom: none;
  }
  
  /* Only add borders between content groups */
  .details-table tr:nth-child(2) td {
    border-bottom: 1px solid var(--background-modifier-border-hover, rgba(0, 0, 0, 0.04));
    padding-bottom: 0.8rem;
  }
  
  .details-table tr:nth-child(3) td {
    padding-top: 0.8rem;
  }
  
  .details-table tr:nth-child(4) td {
    border-bottom: 1px solid var(--background-modifier-border-hover, rgba(0, 0, 0, 0.04));
    padding-bottom: 0.8rem;
  }
  
  .details-table tr:nth-child(5) td {
    padding-top: 0.8rem;
  }
  
  .details-table td:nth-child(odd) {
    color: var(--text-muted);
    width: 20%;
    font-weight: 500;
  }
  
  .details-table td:nth-child(even) {
    color: var(--text-normal);
    font-weight: 500;
    width: 30%;
  }
  
  .details-list {
    list-style-type: none;
    padding: 0;
    margin: 0;
  }
  
  .details-list li {
    padding: 0.4rem 0;
    font-size: 0.9rem;
    color: var(--text-normal);
    border-bottom: 1px solid var(--background-modifier-border-hover, var(--background-modifier-border));
  }
  
  /* Accounts list styling */
  .accounts-list {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    padding: 0.2rem 0;
  }
  
  /* Account tags styled as clickable bubbles */
  .account-tag {
    padding: 0.4rem 0.8rem;
    background-color: var(--background-secondary-alt, var(--background-secondary));
    color: var(--text-normal);
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 500;
    display: inline-block;
    cursor: pointer; /* Show pointer to indicate clickability */
    transition: background-color 0.2s;
  }
  
  .account-tag:hover {
    background-color: var(--background-modifier-hover);
  }
  
  .notes-content {
    font-size: 0.9rem;
    line-height: 1.6;
    color: var(--text-normal);
    white-space: pre-wrap;
  }
  
  /* Trade images styling */
  .trade-images-section {
    display: flex;
    flex-direction: column;
    align-items: center;
    background-color: var(--background-secondary);
    border-radius: var(--border-radius-md, 4px);
    padding: 0.6rem 0; /* Reduce horizontal padding */
    margin: 0; /* Remove margin to use container gap */
    width: 100%; /* Ensure full width */
  }
  
  /* Special styling for container with only one image - eliminate all padding */
  .trade-images-section[data-image-count="1"] {
    padding: 0; /* Remove all padding when there's only one image */
    margin: 0;
  }
  
  /* Ensure proper sizing of the ImageCarousel within the TradeNote */
  .trade-images-section .journalit-image-carousel {
    margin-bottom: 0;
    background-color: transparent;
    box-shadow: none;
    padding: 0;
  }
  
  /* Special handling for single image scenarios - remove any extra spacing */
  .trade-images-section .journalit-image-carousel[data-single-image="true"],
  .trade-images-section[data-image-count="1"] .journalit-image-carousel {
    padding: 0;
    margin: 0;
  }
  
  /* Remove all padding/margin from image container if it's a single image */
  .trade-images-section .journalit-image-carousel[data-single-image="true"] .image-container,
  .trade-images-section[data-image-count="1"] .image-container,
  .trade-images-section[data-image-count="1"] .journalit-carousel-image-container {
    margin: 0;
    padding: 0;
  }
  
  /* More aggressive fixes for single image mode - eliminate all possible gaps */
  .trade-images-section[data-image-count="1"] * {
    margin-top: 0;
    margin-bottom: 0;
  }
  
  /* Target our specific single-image-carousel class */
  .single-image-carousel,
  .single-image-carousel .journalit-carousel-main,
  .single-image-carousel .journalit-carousel-image-container {
    padding: 0 !important;
    margin: 0 !important;
  }
  
  /* Force the single image to directly touch the metrics below */
  .trade-images-section[data-image-count="1"] + .trade-metrics-grid {
    margin-top: 0;
  }
  
  /* Empty state styling */
  .trade-empty-images {
    display: flex;
    flex-direction: column;
    align-items: center;
    background-color: var(--background-secondary);
    border-radius: var(--border-radius-md, 4px);
    padding: 0.8rem 0; /* Reduce horizontal padding */
    margin: 0; /* Remove margin to use container gap */
    width: 100%; /* Ensure full width */
  }
  
  .image-carousel {
    position: relative;
    width: 100%;
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  /* Remove all margins for single image carousels */
  .trade-images-section[data-image-count="1"] .image-carousel,
  .trade-images-section[data-image-count="1"] .journalit-carousel-main {
    margin: 0;
    padding: 0;
  }
  
  .image-container {
    width: 100%;
    max-height: 400px;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    background-color: var(--background-secondary-alt, var(--background-secondary));
    border-radius: var(--border-radius-md, 4px);
  }
  
  .image-container img {
    max-width: 100%;
    max-height: 400px;
    object-fit: contain;
  }
  
  .carousel-button {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: var(--background-secondary);
    color: var(--text-normal);
    border: 1px solid var(--background-modifier-border);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    opacity: 0.7;
    transition: opacity 0.2s, background-color 0.2s;
    z-index: 10;
  }
  
  .carousel-button:hover {
    opacity: 1;
    background-color: var(--background-primary);
  }
  
  .carousel-button.prev {
    left: 10px;
  }
  
  .carousel-button.next {
    right: 10px;
  }
  
  .image-counter {
    font-size: 0.8rem;
    color: var(--text-muted);
    margin-bottom: 0.3rem;
  }
  
  /* Hide image counter completely when there's only one image */
  .trade-images-section[data-image-count="1"] .image-counter {
    display: none;
  }
  
  .image-thumbnails {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
    justify-content: center;
    max-width: 100%;
    margin-top: 0.3rem;
  }
  
  .thumbnail {
    width: 60px;
    height: 60px;
    border-radius: var(--border-radius-sm, 2px);
    overflow: hidden;
    cursor: pointer;
    opacity: 0.7;
    transition: opacity 0.2s;
    border: 2px solid transparent;
  }
  
  .thumbnail:hover {
    opacity: 1;
  }
  
  .thumbnail.active {
    opacity: 1;
    border-color: var (--color-primary, var(--interactive-accent));
  }
  
  .thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
  
  /* Responsive adjustments */
  @media (max-width: 900px) {
    .trade-metrics-grid {
      grid-template-columns: repeat(2, 1fr);
    }
    
    .details-table {
      table-layout: auto;
    }

    .details-table td:nth-child(odd) {
      width: auto;
      min-width: 100px;
    }

    .details-table td:nth-child(even) {
      width: auto;
    }
  }

  @media (max-width: 768px) {
    .trade-note-content {
      padding: 0;
      gap: 0.6rem;
    }
    
    .tags-row {
      flex-direction: column;
      gap: 0.8rem;
    }

    .details-table {
      display: block;
      overflow-x: auto;
    }
    
    .details-table td {
      padding: 0.5rem 0.3rem;
      word-break: break-word;
    }

    .thesis-section {
      padding: 0.8rem;
    }

    .thesis-section h4 {
      font-size: 0.9rem;
      margin-bottom: 0.7rem;
    }

    .thesis-content {
      font-size: 0.85rem;
      line-height: 1.5;
    }
  }

  @media (max-width: 480px) {
    .trade-metrics-grid {
      grid-template-columns: 1fr;
      gap: 0.5rem;
    }

    .metadata-section {
      flex-direction: column;
      align-items: flex-start;
    }

    .setup-section h4::before,
    .mistake-section h4::before {
      display: none; /* Hide emojis on very small screens */
    }
  }
  
  /* Trade Navigation Styles */
  .trade-navigation-container {
    display: flex;
    flex-direction: column;
    padding: 0.2rem 0.8rem 0.6rem 0.8rem; /* Reduced padding to match DRC tightness */
    background-color: var(--background-secondary);
    border-bottom: 1px solid var(--background-modifier-border);
  }
  
  /* Container for navigation and edit button */
  .trade-navigation-with-edit {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    margin-bottom: 0.8rem;
  }
  
  /* Container for edit button to help with alignment */
  .edit-button-container {
    display: flex;
    align-items: center;
    height: auto;
    padding-top: 0;
  }
  
  /* Timeline styles */
  .trade-timeline-container {
    display: flex;
    flex-direction: column;
    gap: 0.6rem;
    margin-bottom: 0.3rem; /* Reduced bottom margin */
  }
  
  .trade-timeline {
    display: flex;
    align-items: center;
  }
  
  .timeline-label {
    font-size: 0.85rem;
    font-weight: 500;
    color: var(--text-normal);
    margin-right: 0.8rem;
    white-space: nowrap;
    min-width: 70px;
  }
  
  .timeline-label.active-ticker {
    font-weight: 600;
    color: var(--interactive-accent);
  }
  
  .timeline-items {
    display: flex;
    flex-wrap: wrap;
    gap: 0.4rem;
  }
  
  .timeline-item {
    padding: 0.3rem 0.6rem;
    background-color: var(--background-primary);
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    font-size: 0.8rem;
    font-weight: 500;
    color: var(--text-muted);
    cursor: pointer;
    transition: all 0.2s ease;
  }
  
  .timeline-item:hover {
    background-color: var(--background-modifier-hover);
    color: var(--text-normal);
  }
  
  /* PnL color coding */
  .timeline-item.profit {
    background-color: rgba(102, 187, 106, 0.15);
    color: var(--color-success, #43a047);
    border-color: rgba(102, 187, 106, 0.3);
  }
  
  .timeline-item.loss {
    background-color: rgba(229, 57, 53, 0.15);
    color: var(--color-error, #e53935);
    border-color: rgba(229, 57, 53, 0.3);
  }
  
  .timeline-item.open {
    background-color: rgba(33, 150, 243, 0.15);
    color: var(--color-info, #2196f3);
    border-color: rgba(33, 150, 243, 0.3);
  }
  
  .timeline-item.profit:hover {
    background-color: rgba(102, 187, 106, 0.25);
  }
  
  .timeline-item.loss:hover {
    background-color: rgba(229, 57, 53, 0.25);
  }
  
  .timeline-item.open:hover {
    background-color: rgba(33, 150, 243, 0.25);
  }
  
  /* Active state now uses a prominent border instead of background */
  .timeline-item.active {
    border: 2px solid var(--interactive-accent);
    font-weight: 600;
  }
  
  .timeline-item.active.profit {
    border-color: var(--interactive-accent);
  }
  
  .timeline-item.active.loss {
    border-color: var(--interactive-accent);
  }
  
  /* Navigation buttons for reviews */
  .trade-review-navigation {
    flex: 1;
    border-bottom: 1px solid var(--background-modifier-border);
    padding-bottom: 0.8rem;
    margin-bottom: 0;
    margin-right: 0.8rem;
  }
  
  /* Edit button in navigation */
  .trade-nav-edit-button {
    width: auto;
    min-width: 36px;
    border-radius: 4px;
    border: 1px solid var(--interactive-accent);
    background-color: var(--interactive-accent);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: background-color 0.2s, transform 0.2s;
    padding: 6px 8px; /* Reduced vertical padding from 8px to 6px */
    margin: 0;
    box-sizing: border-box;
    font-size: 14px; /* Match the font size of navigation buttons */
    line-height: 1.15; /* Control the line height for better alignment */
  }
  
  .trade-nav-edit-button:hover {
    background-color: var(--interactive-accent-hover, var(--interactive-accent));
    opacity: 0.9;
    transform: translateY(-1px);
  }
  
  .trade-nav-edit-button svg {
    width: 14px;
    height: 14px;
  }
  
  .trade-review-navigation-links {
    display: flex;
    justify-content: space-between;
    gap: 0.5rem;
    flex-wrap: wrap;
  }
  
  .trade-review-navigation-button {
    flex: 1;
    min-width: 120px;
    text-align: center;
    padding: 0.5rem;
    font-size: 0.8rem;
  }
  
  /* Multiple view compatibility - these styles ensure proper display in various Obsidian layouts */
  .workspace-split.mod-vertical .journalit-trade-view {
    /* Adjust for vertical split layout */
    max-width: 100%;
    flex-shrink: 1;
  }
  
  /* Ensure the component doesn't get squished in narrow panes */
  .workspace-leaf-content .journalit-trade-view .trade-metrics-grid {
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  }
  
  /* Make sure tab/content navigation is still usable in narrow panes */
  .workspace-leaf-content .journalit-trade-view .trade-note-tabs {
    flex-wrap: wrap;
  }
  
  /* Prevent clipping of component in small panes */
  .workspace-leaf-content .journalit-trade-view .trade-note-container {
    min-width: 0;
  }
  
  /* Responsive styles for navigation */
  @media (max-width: 576px) {
    .trade-timeline {
      flex-direction: column;
      align-items: flex-start;
      margin-bottom: 0.6rem;
    }
    
    .timeline-label {
      margin-bottom: 0.4rem;
      margin-right: 0;
      font-weight: 600;
    }
    
    .trade-timeline-container {
      gap: 1rem;
    }
    
    /* Adjust navigation with edit button layout */
    .trade-navigation-with-edit {
      align-items: center;
    }
    
    .edit-button-container {
      padding-top: 0;
    }
    
    .trade-nav-edit-button {
      padding: 5px 6px; /* Further reduced vertical padding for mobile */
      min-width: 32px;
    }
    
    .trade-nav-edit-button svg {
      width: 16px;
      height: 16px;
    }
  }

  /* Loss Review Styles */
  
  /* Loss Review Container */
  .loss-review-container {
    margin-top: 2rem;
    border-top: 1px solid var(--background-modifier-border);
    padding-top: 1.5rem;
  }

  .loss-review-accordion {
    background: var(--background-secondary);
    border-radius: 8px;
    overflow: hidden;
  }

  /* Loss Review Sections */
  .loss-review-sections {
    padding: 1.5rem;
  }

  .loss-review-section {
    margin-bottom: 1.5rem;
  }

  .loss-review-section:last-child {
    margin-bottom: 0;
  }

  /* Headers */
  .loss-review-header h3 {
    margin: 0 0 0.5rem 0;
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--text-normal);
  }

  .loss-review-content {
    color: var(--text-muted);
    line-height: 1.6;
    margin-bottom: 1rem;
  }

  .loss-review-content p {
    margin: 0.5rem 0;
  }

  /* Checkboxes */
  .loss-review-checkbox,
  .loss-review-checkbox-list {
    margin: 0.5rem 0;
  }

  .loss-review-checkbox-list h3 {
    margin: 0 0 0.75rem 0;
    font-size: 1rem;
    font-weight: 600;
  }

  .checkbox-items {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .checkbox-label {
    display: flex;
    align-items: flex-start;
    gap: 0.5rem;
    cursor: pointer;
    user-select: none;
  }

  .checkbox-label input[type="checkbox"] {
    margin-top: 0.25rem;
    cursor: pointer;
    flex-shrink: 0;
  }

  .checkbox-label span {
    flex: 1;
    line-height: 1.5;
  }

  .checkbox-label span strong {
    color: var(--text-normal);
  }

  /* Text Areas */
  .loss-review-textarea h3 {
    margin: 0 0 0.75rem 0;
    font-size: 1rem;
    font-weight: 600;
  }

  .loss-review-textarea-input {
    width: 100%;
    min-height: 100px;
    padding: 0.75rem;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background: var(--background-primary);
    color: var(--text-normal);
    font-family: inherit;
    font-size: 0.95rem;
    line-height: 1.5;
    resize: vertical;
    transition: border-color 0.15s ease;
  }

  .loss-review-textarea-input:focus {
    outline: none;
    border-color: var(--interactive-accent);
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2);
  }

  .loss-review-textarea-input::placeholder {
    color: var(--text-muted);
    opacity: 0.7;
  }

  /* Footer */
  .loss-review-footer {
    margin-top: 2rem;
    padding-top: 1.5rem;
    border-top: 1px solid var(--background-modifier-border);
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .reviewed-timestamp {
    font-size: 0.85rem;
    color: var(--text-muted);
  }

  /* Responsive */
  @media (max-width: 768px) {
    .loss-review-sections {
      padding: 1rem;
    }
    
    .loss-review-footer {
      flex-direction: column;
      gap: 1rem;
      align-items: flex-start;
    }
  }

  /* Dark theme adjustments */
  .theme-dark .loss-review-textarea-input {
    background: var(--background-secondary-alt);
  }

  .theme-dark .loss-review-accordion {
    background: var(--background-secondary-alt);
  }

  /* Accordion styles for Loss Review */
  .loss-review-container .cmdr-accordion {
    margin-bottom: 16px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    overflow: hidden;
    transition: box-shadow 0.2s ease;
  }

  .loss-review-container .cmdr-accordion:hover {
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
  }

  .loss-review-container .cmdr-accordion .cmdr-accordion-header {
    display: flex;
    align-items: center;
    padding: 12px 16px;
    cursor: pointer;
    background-color: var(--background-secondary);
    transition: background-color 0.15s ease;
  }

  .loss-review-container .cmdr-accordion .cmdr-accordion-header:hover {
    background-color: var(--background-modifier-hover);
  }

  .loss-review-container .cmdr-accordion .cmdr-accordion-chevron > svg {
    transition: transform 0.3s ease-in-out;
  }

  .loss-review-container .cmdr-accordion .cmdr-accordion-content {
    max-height: 5000px;
    transition: max-height 0.3s ease-in-out, padding 0.3s ease-in-out, margin 0.3s ease-in-out;
    overflow: hidden;
    background-color: var(--background-primary);
    padding: 16px;
  }

  /* Collapsed state */
  .loss-review-container .cmdr-accordion[aria-expanded="false"] .cmdr-accordion-chevron > svg {
    transform: rotate(-90deg);
  }

  .loss-review-container .cmdr-accordion[aria-expanded="false"] .cmdr-accordion-content {
    max-height: 0 !important;
    transition: max-height 0.2s ease-out;
    padding-top: 0;
    padding-bottom: 0;
    margin-top: 0;
    margin-bottom: 0;
    overflow: hidden;
  }
`;function gK(){if(document.head.querySelector("#trade-note-styles"))return;let e=document.createElement("style");e.id="trade-note-styles",e.textContent=fK,document.head.appendChild(e)}function vd(){gK()}var hK=`
  /**
   * Missed Trade Note Container styles
   */

  /* Main container for missed trade notes */
  .journalit-missed-trade-view,
  .missed-trade-form-view-container .journalit-missed-trade-view {
    margin: 0;
    border-bottom: none;
    padding: 0;
    display: block !important;
    width: 100% !important;
    z-index: 1;
    position: relative;
    box-sizing: border-box;
    contain: content;
    isolation: isolate;
  }
  
  /* Missed trade React root wrapper */
  .journalit-missed-trade-note-wrapper {
    width: 100%;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    contain: content;
    isolation: isolate;
    position: relative;
    box-sizing: border-box;
  }
  
  .missed-trade-note-container {
    background-color: var(--background-primary);
    border-radius: var(--border-radius-lg, 8px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    margin: 0;
    overflow: hidden;
    position: relative;
    font-family: var(--font-interface);
    isolation: isolate;
    contain: layout style paint;
    width: 100%;
    align-self: flex-start;
    transition: box-shadow 0.2s ease-in-out;
  }

  /**
   * MISSED Badge Styling for TradeHeader
   */
  
  /* Style the MISSED badge */
  .trade-header-actions .missed-trade-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    background-color: var(--color-orange, #ff9500);
    color: white;
    font-size: 0.75rem;
    font-weight: 600;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    box-shadow: 0 2px 4px rgba(255, 149, 0, 0.3);
    margin-right: 0.75rem;
  }

  /* Missed trade header styling - removed orange styling per user request */

  /**
   * Missed Trade Reason Section
   */
  
  .missed-trade-reason-section {
    margin-top: 1rem;
  }

  .missed-trade-reason-section .details-card {
    background-color: var(--background-secondary);
    border-left: 4px solid var(--color-orange, #ff9500);
  }

  .missed-trade-reason-section h4 {
    color: var(--color-orange, #ff9500);
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .missed-trade-reason-section h4::before {
    content: '\u274C';
    font-size: 1rem;
  }

  .missed-trade-reason-content {
    font-size: 0.95rem;
    line-height: 1.6;
    color: var(--text-normal);
    white-space: pre-wrap;
    padding: 0.5rem 0;
    background-color: var(--background-secondary-alt, var(--background-secondary));
    border-radius: 4px;
    padding: 0.75rem;
    margin-top: 0.5rem;
  }

  /**
   * Missed Trade Timeline Styling
   */

  /* Missed trades timeline section */
  .missed-trades-timeline-section {
    margin-top: 1rem;
    padding-top: 0.75rem;
    border-top: 1px solid var(--background-modifier-border);
  }

  .missed-trades-label {
    color: var(--color-orange, #ff9500);
    font-weight: 600;
    margin-bottom: 0.5rem;
  }

  /* Missed trade timeline items */
  .timeline-item.missed-trade {
    background-color: rgba(255, 149, 0, 0.15);
    color: var(--color-orange, #ff9500);
    border-color: rgba(255, 149, 0, 0.3);
    font-weight: 500;
  }

  .timeline-item.missed-trade:hover {
    background-color: rgba(255, 149, 0, 0.25);
    transform: translateY(-1px);
  }

  .timeline-item.missed-trade.active {
    border: 2px solid var(--color-orange, #ff9500);
    background-color: rgba(255, 149, 0, 0.2);
    font-weight: 600;
  }

  /**
   * Missed Trade Content Styling
   */
  
  .missed-trade-note-content {
    padding: 0;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  /**
   * Review Button for Missed Trades
   */
  
  .missed-trade-note-review-section {
    margin-top: 2rem;
    padding-top: 1.5rem;
    border-top: 1px solid var(--background-modifier-border);
    display: flex;
    justify-content: center;
    align-items: center;
  }

  /**
   * Form Styling for Missed Trade Toggle
   */
  
  /* Missed trade toggle styling in forms */
  .field .checkbox-label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    cursor: pointer;
    font-size: 0.9rem;
    color: var(--text-normal);
    transition: color 0.2s ease;
  }

  .field .checkbox-label:hover {
    color: var(--interactive-accent);
  }

  .field .checkbox-label input[type="checkbox"] {
    cursor: pointer;
    transform: scale(1.1);
  }

  .field .checkbox-label span {
    font-weight: 500;
  }

  /* Missed trade reason field styling */
  .field .textarea {
    width: 100%;
    min-height: 80px;
    padding: 0.75rem;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background: var(--background-primary);
    color: var(--text-normal);
    font-family: inherit;
    font-size: 0.9rem;
    line-height: 1.5;
    resize: vertical;
    transition: border-color 0.15s ease;
  }

  .field .textarea:focus {
    outline: none;
    border-color: var(--interactive-accent);
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2);
  }

  .field .textarea::placeholder {
    color: var(--text-muted);
    opacity: 0.7;
  }

  /**
   * Responsive Design
   */
  
  @media (max-width: 768px) {
    .missed-trade-badge {
      font-size: 0.7rem;
      padding: 0.2rem 0.4rem;
      margin-right: 0.5rem;
    }
    
    .missed-trade-reason-content {
      font-size: 0.85rem;
      padding: 0.5rem;
    }
  }

  @media (max-width: 480px) {
    .missed-trades-timeline-section {
      margin-top: 0.75rem;
      padding-top: 0.5rem;
    }
    
    .missed-trades-label {
      font-size: 0.85rem;
    }
  }

  /**
   * Dark theme adjustments
   */
  
  /* Removed orange theme styling per user request */
  
  .theme-dark .missed-trade-reason-content {
    background-color: var(--background-secondary-alt);
  }
  
  .theme-dark .timeline-item.missed-trade {
    background-color: rgba(255, 149, 0, 0.2);
  }
  
  .theme-dark .timeline-item.missed-trade:hover {
    background-color: rgba(255, 149, 0, 0.3);
  }

  /**
   * Multiple view compatibility
   */
  
  .workspace-split.mod-vertical .journalit-missed-trade-view {
    max-width: 100%;
    flex-shrink: 1;
  }
  
  .workspace-leaf-content .journalit-missed-trade-view .trade-metrics-grid {
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  }
  
  .workspace-leaf-content .journalit-missed-trade-view .missed-trade-note-container {
    min-width: 0;
  }
`;function vK(){if(document.head.querySelector("#missed-trade-note-styles"))return;let e=document.createElement("style");e.id="missed-trade-note-styles",e.textContent=hK,document.head.appendChild(e)}function Yg(){vK()}var yK=`
  /* Daily Report Card styles */
  .drc-container {
    background-color: transparent; /* Remove background to match Weekly Review */
    border-radius: 0; /* Remove border radius to match Weekly Review */
    box-shadow: none; /* Remove shadow to match Weekly Review */
    margin: 0; /* Remove margin to match Weekly Review */
    overflow: hidden;
    display: flex;
    flex-direction: column;
    font-family: var(--font-interface, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif);
  }

  /* DRC ComboBox styling - matched with TradeForm styling */
  .drc-container .combobox-container,
  .drc-container [data-combobox-type],
  .drc-missed-trade .combobox-container,
  .drc-missed-trade .drc-input-group.field .combobox-container {
    position: relative !important;
    width: 100% !important;
    margin-bottom: 8px !important;
    z-index: 10 !important;
  }

  /* Increased z-index when dropdown is open */
  .drc-container .combobox-container[data-is-open="true"],
  .drc-container [data-combobox-type][data-is-open="true"],
  .drc-missed-trade .combobox-container[data-is-open="true"],
  .drc-missed-trade .drc-input-group.field .combobox-container[data-is-open="true"] {
    z-index: 9999 !important;
  }

  /* Dropdown caret for DRC ComboBox */
  .drc-container [data-combobox-type] .input-container::after,
  .drc-missed-trade .combobox-container .input-container::after,
  .drc-missed-trade .drc-input-group.field .combobox-container .input-container::after {
    content: "" !important;
    position: absolute !important;
    right: 12px !important;
    top: 50% !important;
    transform: translateY(-50%) !important;
    width: 0 !important;
    height: 0 !important;
    border-left: 5px solid transparent !important;
    border-right: 5px solid transparent !important;
    border-top: 5px solid var(--text-normal) !important;
    pointer-events: none !important;
    z-index: 10 !important;
  }

  /* Input padding to make room for dropdown arrow */
  .drc-container [data-combobox-type] input[role="combobox"],
  .drc-missed-trade .combobox-container input[role="combobox"],
  .drc-missed-trade .drc-input-group.field .combobox-container input[role="combobox"] {
    padding-right: 30px !important;
    width: 100% !important;
    padding: 8px 12px !important;
    padding-right: 30px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    font-size: 14px !important;
    cursor: pointer !important;
  }

  /* DRC Multi-select styling - fixed for better visibility */
  .drc-missed-trade .selected-options,
  .drc-missed-trade .selected-item,
  .drc-missed-trade [data-combobox-type="multi"] > div:first-of-type {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 4px !important;
    max-width: 100% !important;
    padding: 2px 0 !important;
    z-index: 5 !important;
    position: relative !important;
  }

  /* Style selected tags to match the TradeForm */
  .drc-missed-trade .selected-option,
  .drc-missed-trade .selected-item,
  .selected-option,
  .selected-item {
    display: inline-flex !important;
    align-items: center !important;
    background-color: var(--interactive-accent, #7c3aed) !important; /* Use Obsidian var with purple fallback */
    color: white !important;
    border-radius: 4px !important;
    padding: 4px 8px !important; /* Match TradeForm padding */
    font-size: 12px !important; /* Match TradeForm font size */
    margin: 0 4px 4px 0 !important; /* Match TradeForm margin */
    font-weight: 500 !important;
    z-index: 6 !important;
    position: relative !important;
    gap: 6px !important; /* Ensure proper spacing between text and remove button */
  }

  /* Style remove buttons ('\xD7') - matched with TradeForm */
  .drc-missed-trade .selected-option-remove,
  .drc-missed-trade .selected-item button,
  .selected-option-remove,
  .selected-item button {
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    width: 16px !important;
    height: 16px !important;
    min-width: 16px !important; /* Prevent shrinking */
    min-height: 16px !important; /* Prevent shrinking */
    padding: 0 !important;
    margin-left: 4px !important;
    cursor: pointer !important;
    background: rgba(255, 255, 255, 0.2) !important;
    border: none !important;
    border-radius: 50% !important;
    color: white !important;
    font-size: 14px !important;
    line-height: 1 !important; /* Match TradeForm for consistent vertical centering */
    text-align: center !important;
    z-index: 7 !important;
    position: relative !important;
    transition: background-color 0.2s !important;
  }

  /* Header and Navigation */
  .drc-header {
    padding: 16px 20px 12px;
    background-color: var(--background-secondary);
    text-align: center;
    border-bottom: 1px solid var(--background-modifier-border);
  }

  .drc-date-display {
    font-size: 18px;
    font-weight: 600;
    color: var(--text-normal);
    margin-bottom: 12px;
  }

  .drc-navigation {
    width: 100%;
    padding-top: 10px;
    border-top: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1));
  }

  .drc-navigation-links {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 8px;
    flex-wrap: wrap;
    width: 100% !important;
  }

  /* Tabs Container */
  .drc-tabs-container {
    background-color: var(--background-secondary-alt, #2a2a2a);
    border-bottom: 1px solid var(--background-modifier-border);
    display: flex;
    justify-content: center;
    padding: 0;
  }

  /* Tabs */
  .drc-tabs {
    display: flex;
    justify-content: center;
    background-color: transparent;
    max-width: 600px;
    margin: 0 auto;
  }

  .drc-tab {
    padding: 12px 24px;
    background: transparent;
    border: none;
    color: var(--text-muted);
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
    outline: none;
    border-bottom: 2px solid transparent;
  }

  .drc-tab:hover {
    color: var(--text-normal);
    background-color: rgba(127, 127, 127, 0.05);
  }

  .drc-tab.active {
    color: var(--text-accent);
    border-bottom: 2px solid var(--text-accent);
  }

  .drc-tab.active::after {
    content: none; /* Removing the additional indicator since we're using border-bottom */
  }

  /* Content area */
  .drc-content {
    padding: 20px 0 0; /* Removed bottom padding to prevent extra space */
  }

  /* Sections */
  .drc-section {
    margin: 0 0 24px 0; /* Explicit horizontal margin of 0 to match Weekly Review */
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    padding: 16px;
    background-color: var(--background-primary);
    width: 100%; /* Ensure full width */
    box-sizing: border-box; /* Include padding in width calculation */
  }

  /* Last section should not have a bottom margin to prevent extra space */
  .drc-section:last-child {
    margin-bottom: 0 !important;
  }

  /* First section should not have a top margin to prevent extra space */
  .drc-section:first-child {
    margin-top: 0 !important;
  }

  .drc-section h3 {
    margin-top: 0;
    margin-bottom: 16px;
    font-size: 16px;
    color: var(--text-normal);
    border-bottom: 1px solid var(--background-modifier-border);
    padding-bottom: 8px;
    text-align: center;
  }

  /* Checklist */
  .drc-checklist {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 8px;
  }

  .drc-checklist-item {
    display: flex;
    align-items: center;
    padding: 8px 12px;
    border-radius: 4px;
    background-color: var(--background-secondary);
    transition: background-color 0.2s ease;
    cursor: pointer !important; /* Make the entire area clickable */
  }

  /* Custom styling to center checkbox */
  .drc-checklist-item input[type="checkbox"] {
    margin-right: 10px;
    vertical-align: middle !important;
  }

  .drc-checklist-item:hover {
    background-color: var(--background-modifier-hover);
  }

  /* Input groups */
  .drc-input-group {
    margin-bottom: 16px;
  }

  .drc-input-group label {
    display: block;
    margin-bottom: 6px;
    font-size: 14px;
    font-weight: 500;
    color: var(--text-normal);
  }

  .drc-input-group input,
  .drc-input-group textarea,
  .drc-input-group select {
    width: 100%;
    padding: 8px 12px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    font-size: 14px;
  }

  .drc-input-group textarea,
  .drc-textarea {
    width: 100%;
    min-height: 80px;
    padding: 12px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    font-family: var(--font-text);
    font-size: 14px;
    resize: vertical;
  }

  /* Stats cards */
  .drc-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
    gap: 16px;
    margin-bottom: 24px;
  }

  .drc-stat-card {
    background-color: var(--background-secondary);
    border-radius: 6px;
    padding: 16px;
    text-align: center;
    transition: transform 0.2s;
    min-width: 0; /* Enable proper overflow handling */
  }

  .drc-stat-card:hover {
    transform: translateY(-2px);
  }

  .drc-stat-value {
    font-size: 24px;
    font-weight: 700;
    margin-bottom: 4px;
    color: var(--text-normal);
    white-space: nowrap; /* Keep values on one line */
    overflow: hidden; /* Hide overflow */
    text-overflow: ellipsis; /* Add ellipsis for overflow */
  }

  .drc-stat-value.positive {
    color: var(--color-success, #43a047);
  }

  .drc-stat-value.negative {
    color: var(--color-error, #e53935);
  }
  
  /* Special handling for P&L stat card which often has longer values */
  .drc-stats .drc-stat-card:nth-child(4) {
    min-width: 140px; /* Give P&L card extra space */
  }

  .drc-stat-label {
    font-size: 12px;
    color: var(--text-muted);
  }

  /* Grades */
  .drc-grades {
    display: grid;
    grid-template-columns: minmax(200px, 1fr) minmax(200px, 1fr) !important;
    gap: 16px !important;
    margin-bottom: 24px !important;
    align-items: end !important;
  }

  .drc-grade {
    display: flex !important;
    flex-direction: column !important;
    height: 100% !important;
    min-width: 200px !important;
    padding: 16px !important;
  }

  .drc-grade select {
    font-size: 16px;
    font-weight: 600;
    padding: 10px 16px;
    height: auto;
    line-height: 1.5;
    text-align-last: center;
    appearance: menulist-button;
    -webkit-appearance: menulist-button;
  }

  /* Trade table */
  .drc-trade-table {
    width: 100%;
    border-collapse: collapse;
  }

  .drc-trade-table th {
    text-align: left;
    padding: 10px;
    border-bottom: 2px solid var(--background-modifier-border);
    font-weight: 600;
    color: var(--text-normal);
  }

  .drc-trade-table td {
    padding: 10px;
    border-bottom: 1px solid var(--background-modifier-border);
    color: var(--text-normal);
  }

  .drc-trade-table td.positive {
    color: var(--color-success, #43a047);
  }

  .drc-trade-table td.negative {
    color: var(--color-error, #e53935);
  }

  .drc-trade-table select,
  .drc-trade-table input {
    width: 100%;
    padding: 6px 10px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background-color: var(--background-primary);
    color: var(--text-normal);
  }
  
  /* Weekly review trades table for DRC compatibility */
  .weekly-review-trades-table {
    /* Table header for preview column */
    th:first-child {
      width: 60px !important; /* Fixed width for preview column */
      text-align: center !important;
      padding: 8px 4px !important;
    }
    
    /* Trade preview cell */
    .trade-preview-cell {
      width: 60px !important;
      padding: 4px !important;
      text-align: center !important;
      vertical-align: middle !important;
    }
    
    /* Image wrapper container */
    .trade-image-wrapper {
      position: relative !important;
      width: 48px !important; 
      height: 48px !important;
      display: inline-block !important;
      cursor: pointer !important;
      overflow: hidden !important;
      border-radius: 4px !important;
      border: 1px solid var(--background-modifier-border) !important;
    }
    
    /* Lazy loaded image container */
    .trade-preview-thumbnail {
      width: 100% !important;
      height: 100% !important;
    }
    
    /* Placeholder shown before image loads */
    .trade-preview-placeholder {
      width: 100% !important;
      height: 100% !important;
      background-color: var(--background-modifier-hover) !important;
      border-radius: 4px !important;
    }
    
    /* Indicator badge for multiple images */
    .trade-image-count-indicator {
      position: absolute !important;
      bottom: 2px !important;
      right: 2px !important;
      background-color: rgba(0, 0, 0, 0.7) !important;
      color: white !important;
      font-size: 10px !important;
      font-weight: bold !important;
      padding: 1px 4px !important;
      border-radius: 3px !important;
      line-height: 1 !important;
      pointer-events: none !important; /* Don't interfere with click handling */
      z-index: 2 !important;
    }
    
    /* Icon styling when no image exists */
    .trade-no-image-icon {
      color: var(--text-muted) !important;
      opacity: 0.5 !important;
    }
    
    /* Scale up image preview on hover */
    .trade-image-wrapper:hover {
      transform: scale(1.05) !important;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2) !important;
      transition: all 0.2s ease !important;
    }
  }
  
  .weekly-review-trades-table {
    width: 100% !important;
    overflow-x: auto !important;
    margin-bottom: 16px !important;
  }

  .weekly-review-trades-table table {
    width: 100% !important;
    border-collapse: collapse !important;
    font-size: 14px !important;
    text-align: left !important;
    margin: 0 !important;
    table-layout: auto !important;
  }

  .weekly-review-trades-table th {
    padding: 10px 12px !important;
    border-bottom: 2px solid var(--background-modifier-border) !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    background-color: var(--background-secondary) !important;
    text-align: left !important;
    white-space: nowrap !important;
  }

  .weekly-review-trades-table td {
    padding: 8px 12px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
    text-align: left !important;
    transition: background-color 0.2s ease !important;
  }

  .weekly-review-trades-table tr:hover td {
    background-color: var(--background-modifier-hover) !important;
  }

  .weekly-review-trade-row {
    cursor: pointer !important;
  }

  .weekly-review-trade-row:hover {
    background-color: var(--background-modifier-hover) !important;
  }

  /* DRC View Button - used in trade tables */
  .drc-nav-button {
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    padding: 8px 14px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    cursor: pointer !important;
    font-size: 14px !important;
    transition: all 0.2s !important;
    text-align: center !important;
    flex: 1 !important;
    min-width: 120px !important;
    box-sizing: border-box !important;
  }

  .drc-nav-button:hover {
    background-color: var(--background-modifier-hover) !important;
    transform: translateY(-1px) !important;
  }

  /* Review sections */
  .drc-reflection-item {
    margin-bottom: 16px;
  }

  .drc-reflection-item label {
    display: block;
    margin-bottom: 6px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .drc-reflection-item textarea {
    width: 100%;
    min-height: 100px;
    padding: 12px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    resize: vertical;
  }

  /* DRC dropdown options - remove bullets and match TradeForm */
  .drc-container [data-combobox-type] ul[role="listbox"],
  .drc-missed-trade [data-combobox-type] ul[role="listbox"] {
    position: absolute !important;
    top: 100% !important;
    left: 0 !important;
    right: 0 !important;
    max-height: 200px !important;
    overflow-y: auto !important;
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-top: none !important;
    border-radius: 0 0 4px 4px !important;
    margin-top: -1px !important;
    z-index: 9999 !important;
    list-style: none !important; /* Remove bullets */
    padding: 0 !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
    /* Fix for blurry text - add hardware acceleration properties */
    transform: translateZ(0) !important; /* Force GPU acceleration */
    backface-visibility: hidden !important;
    perspective: 1000px !important;
    -webkit-font-smoothing: antialiased !important;
    -moz-osx-font-smoothing: grayscale !important;
    /* Animation properties for smooth open effect */
    animation: drc-dropdown-open 0.15s ease forwards !important;
  }
  
  /* Animation for DRC dropdown appearance */
  @keyframes drc-dropdown-open {
    from {
      opacity: 0;
      transform: translateY(-5px) translateZ(0);
    }
    to {
      opacity: 1;
      transform: translateY(0) translateZ(0);
    }
  }

  /* DRC dropdown options styling */
  .drc-container [data-combobox-type] ul[role="listbox"] li,
  .drc-missed-trade [data-combobox-type] ul[role="listbox"] li {
    padding: 8px 12px !important;
    cursor: pointer !important;
    transition: background-color 150ms ease !important;
    margin: 0 !important;
    list-style: none !important; /* Ensure no bullets */
    border-bottom: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1)) !important;
    /* Fix for blurry text */
    transform: translateZ(0) !important; /* Force GPU acceleration */
    -webkit-font-smoothing: antialiased !important;
    -moz-osx-font-smoothing: grayscale !important;
    /* Ensure text is crisp */
    text-rendering: optimizeLegibility !important;
  }

  /* Hover and selected state for DRC dropdown options */
  .drc-container [data-combobox-type] ul[role="listbox"] li:hover,
  .drc-container [data-combobox-type] ul[role="listbox"] li[aria-selected="true"],
  .drc-missed-trade [data-combobox-type] ul[role="listbox"] li:hover,
  .drc-missed-trade [data-combobox-type] ul[role="listbox"] li[aria-selected="true"] {
    background-color: var(--background-secondary) !important;
  }

  /* Special styling for "Add new" option in DRC */
  .drc-container [data-combobox-type] ul[role="listbox"] li[data-add-option="true"],
  .drc-missed-trade [data-combobox-type] ul[role="listbox"] li[data-add-option="true"] {
    font-style: italic !important;
    border-top: 1px dashed var(--background-modifier-border) !important;
    /* Fix for blurry text */
    transform: translateZ(0) !important; /* Force GPU acceleration */
    -webkit-font-smoothing: antialiased !important;
    -moz-osx-font-smoothing: grayscale !important;
    /* Ensure text is crisp */
    text-rendering: optimizeLegibility !important;
  }

  /* When dropdown is open, change input border radius */
  .drc-container [data-combobox-type][data-is-open="true"] input[role="combobox"],
  .drc-missed-trade [data-combobox-type][data-is-open="true"] input[role="combobox"] {
    border-bottom-left-radius: 0 !important;
    border-bottom-right-radius: 0 !important;
  }
  
  /* Add hover effect for remove buttons */
  .drc-missed-trade .selected-option-remove:hover,
  .drc-missed-trade .selected-item button:hover,
  .selected-option-remove:hover,
  .selected-item button:hover {
    background: rgba(255, 255, 255, 0.4) !important; /* Brighter on hover */
  }

  /* Missed trades */
.drc-missed-trade {
  padding: 16px;
  padding-top: 42px; /* Extra padding at top to make space for the remove button */
  margin-bottom: 16px;
  background-color: var(--background-secondary);
  border-radius: 6px;
  position: relative;
}

/* Ensure the remove button is always clickable with a high z-index */
.drc-missed-trade-remove {
  position: absolute !important;
  top: 12px !important;
  right: 12px !important;
  z-index: 12000 !important; /* Ensure it's above any dropdowns */
  padding: 6px 12px !important;
  min-width: 80px !important;
  min-height: 32px !important;
  margin: 0 !important;
}

/* Missed trade images container */
.drc-missed-trade-images-container {
  margin-top: 16px;
}

/* Container for image carousel */
.drc-missed-trade-images {
  margin-bottom: 12px;
  background-color: var(--background-primary);
  border-radius: 6px;
  padding: 12px;
  border: 1px solid var(--background-modifier-border);
}

/* Image uploader for missed trades */
.drc-missed-trade-image-uploader {
  height: 60px !important; /* Smaller height for the uploader */
  margin-top: 8px;
}

  .drc-missed-trade .drc-remove-button {
    position: absolute;
    top: 12px;
    right: 12px;
  }

  /* Buttons */
  .drc-add-button,
  .drc-remove-button,
  .drc-nav-button {
    padding: 8px 14px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 4px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    cursor: pointer;
    font-size: 14px;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .drc-add-button {
    margin-bottom: 16px;
    background-color: var(--interactive-accent);
    color: white;
    border-color: var(--interactive-accent);
  }

  .drc-add-button:hover {
    background-color: var(--interactive-accent-hover);
  }

  .drc-remove-button {
    background-color: rgba(229, 57, 53, 0.1);
    color: var(--color-error, #e53935);
    border-color: var(--color-error, #e53935);
  }

  .drc-remove-button:hover {
    background-color: rgba(229, 57, 53, 0.2);
  }

  .drc-nav-button:hover {
    background-color: var(--background-modifier-hover);
    transform: translateY(-1px);
  }

  .drc-nav-button .nav-icon {
    font-size: 16px;
    line-height: 1;
  }

  /* Empty state */
  .drc-empty-state {
    padding: 20px;
    text-align: center;
    color: var(--text-muted);
    font-style: italic;
    background-color: var(--background-secondary);
    border-radius: 4px;
  }

  /* Goals section */
  .drc-goal-item {
    display: flex;
    align-items: center;
    margin-bottom: 8px;
    gap: 10px;
  }

  .drc-goal-item input {
    flex: 1;
  }

  /* Responsive adjustments */
  @media (max-width: 768px) {
    .drc-grades {
      grid-template-columns: 1fr;
    }

    .drc-stats {
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    }

    .drc-trade-table {
      display: block;
      overflow-x: auto;
    }

    .drc-navigation-links {
      justify-content: center !important;
      width: 100% !important;
    }

    .drc-nav-button {
      flex: 1 !important;
      justify-content: center !important;
      min-width: 120px !important;
    }

    /* Make tabs more compact on mobile */
    .drc-tab {
      padding: 10px 16px;
      font-size: 13px;
    }
  }

  /* Fix for grade value display and container sizing */
  .drc-note-grades {
    display: grid !important;
    grid-template-columns: minmax(200px, 1fr) minmax(200px, 1fr) !important;
    gap: 16px !important;
    margin-bottom: 24px !important;
    align-items: end !important;
  }

  .drc-note-grade {
    display: flex !important;
    flex-direction: column !important;
    height: 100% !important;
    min-width: 200px !important;
    padding: 16px !important;
  }

  .drc-note-grade-label {
    font-size: 14px !important;
    font-weight: 500 !important;
    color: var(--text-normal) !important;
    margin-bottom: 8px !important;
    display: block !important;
    text-align: center !important;
  }

  /* Critical fixes for grade display and containers */
  .drc-note-grades {
    display: grid !important;
    grid-template-columns: minmax(200px, 1fr) minmax(200px, 1fr) !important;
    gap: 16px !important;
    margin-bottom: 24px !important;
    align-items: center !important;
  }

  .drc-note-grade {
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    height: 100% !important;
    min-width: 200px !important;
    padding: 16px !important;
    background-color: var(--background-primary) !important;
    border-radius: var(--border-radius-md, 4px) !important;
    border: 1px solid var(--background-modifier-border) !important;
  }

  .drc-note-grade-label {
    font-size: 14px !important;
    font-weight: 500 !important;
    color: var(--text-normal) !important;
    margin-bottom: 12px !important;
    display: block !important;
    text-align: center !important;
    width: 100% !important;
  }

  .drc-note-grade-dropdown {
    width: 60px !important;
    height: 60px !important;
    position: relative !important;
  }

  /* Grade value styling with perfect centering */
  .drc-note-grade-value,
  select.drc-note-grade-value {
    width: 60px !important;
    height: 60px !important;
    min-width: 60px !important;
    min-height: 60px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    border-radius: 50% !important;
    font-size: 22px !important;
    font-weight: 600 !important;
    margin: 0 !important;
    padding: 0 !important;
    border: none !important;
    background-color: var(--background-secondary) !important;
    color: var(--text-normal) !important;
    cursor: pointer !important;
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    appearance: none !important;
    text-align: center !important;
    line-height: 1 !important;
    text-indent: 0 !important;
    box-sizing: border-box !important;
    overflow: visible !important;
    position: relative !important;
  }

  /* Grade colors - A is green, B is orange, C is red */
  .drc-note-grade-value.grade-a {
    background-color: rgba(102, 187, 106, 0.3) !important;
    color: #2e7d32 !important; /* Darker green for better visibility */
  }

  .drc-note-grade-value.grade-b {
    background-color: rgba(255, 152, 0, 0.3) !important;
    color: #ef6c00 !important; /* Darker orange for better visibility */
  }

  .drc-note-grade-value.grade-c {
    background-color: rgba(229, 57, 53, 0.3) !important;
    color: #c62828 !important; /* Darker red for better visibility */
  }

  /* Hide dropdown arrow */
  .drc-note-grade-dropdown::after,
  .drc-note-grade-dropdown::before,
  .drc-note-grade-dropdown select::after,
  .drc-note-grade-dropdown select::before {
    content: none !important;
    display: none !important;
  }

  /* Media query for responsive layout */
  @media (max-width: 768px) {
    .drc-note-grades {
      grid-template-columns: 1fr !important;
      gap: 12px !important;
    }

    /* Key Levels responsive adjustments */
    .drc-levels-container {
      flex-direction: column !important;
    }

    .drc-level-section {
      width: 100% !important;
    }
  }

  @media (min-width: 768px) {
    .drc-levels-container {
      flex-direction: row !important;
      gap: 16px !important;
    }

    .drc-level-section {
      width: calc(50% - 8px) !important;
    }
  }

  /* Key Levels Component Styles */
  .drc-key-levels {
    margin-top: 16px !important;
  }
  
  /* IconSelect Component Styles */
  .icon-select-container {
    position: relative !important;
    display: inline-block !important;
    width: 40px !important;
    height: 32px !important;
    vertical-align: middle !important;
  }

  .icon-select-trigger {
    width: 100% !important;
    height: 100% !important;
    padding: 0 !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    cursor: pointer !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
  }
  
  /* Center SVG icons inside the trigger button */
  .icon-select-trigger svg {
    display: block !important;
    margin: 0 auto !important;
  }

  .icon-select-trigger:hover {
    background-color: var(--background-modifier-hover) !important;
  }

  .icon-select-menu {
    position: absolute !important;
    top: calc(100% + 2px) !important;
    left: 0 !important;
    width: 40px !important;
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
    z-index: 1000 !important;
    list-style: none !important;
    padding: 4px 0 !important;
    margin: 0 !important;
  }

  .icon-select-option {
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    padding: 6px 0 !important;
    cursor: pointer !important;
    height: 28px !important;
  }
  
  /* Center SVG icons inside the dropdown options */
  .icon-select-option svg {
    display: block !important;
    margin: 0 auto !important;
  }

  .icon-select-option:hover {
    background-color: var(--background-modifier-hover) !important;
  }

  .icon-select-option.selected {
    background-color: var(--background-secondary) !important;
  }

  .drc-levels-container {
    display: flex !important;
    flex-direction: column !important;
    gap: 24px !important;
  }

  .drc-level-section {
    border-radius: 8px !important;
    padding: 16px !important;
    background-color: var(--background-secondary) !important;
  }

  .support-section {
    border-left: 3px solid rgba(102, 187, 106, 0.7) !important;
  }

  .resistance-section {
    border-left: 3px solid rgba(229, 57, 53, 0.7) !important;
  }

  .drc-level-header {
    margin: 0 0 12px 0 !important;
    padding-bottom: 8px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
    font-size: 14px !important;
    font-weight: 600 !important;
    text-align: center !important;
  }

  .support-header {
    color: var(--color-success, #43a047) !important;
  }

  .resistance-header {
    color: var(--color-error, #e53935) !important;
  }

  .drc-level-add-container {
    margin-bottom: 12px !important;
  }

  .drc-level-input-group {
    display: flex !important;
    gap: 8px !important;
    width: 100% !important;
    align-items: center !important;
  }

  .drc-level-input {
    flex: 2 !important;
    min-width: 0 !important;
    padding: 6px 12px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    font-size: 14px !important;
    height: 32px !important;
    min-height: 32px !important;
    max-height: 32px !important;
    line-height: 20px !important;
    box-sizing: border-box !important;
    margin: 0 !important;
    display: block !important;
  }

  .drc-level-importance-select {
    width: 40px !important;
    display: flex !important;
    align-items: center !important;
  }

  .drc-importance-select {
    width: 40px !important;
    padding: 6px 0 6px 24px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    font-size: 14px !important;
    height: 32px !important;
    min-height: 32px !important;
    max-height: 32px !important;
    line-height: 20px !important;
    box-sizing: border-box !important;
    margin: 0 !important;
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    appearance: none !important;
    vertical-align: middle !important;
    background-image: none !important;
    text-align: center !important;
  }

  /* Ensure select options have consistent height */
  .drc-importance-select option {
    padding: 4px 8px !important;
    height: auto !important;
    line-height: normal !important;
  }

  .drc-level-add-button {
    padding: 6px 12px !important;
    height: 32px !important;
    min-height: 32px !important;
    max-height: 32px !important;
    box-sizing: border-box !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    margin: 0 !important;
    line-height: 20px !important;
  }

  .drc-levels-list {
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important;
  }

  .drc-level-item {
    display: flex !important;
    align-items: center !important;
    padding: 8px 12px !important;
    background-color: var(--background-primary) !important;
    border-radius: 4px !important;
    position: relative !important;
    justify-content: flex-start !important;
  }

  .support-level {
    border-left: 3px solid rgba(102, 187, 106, 0.5) !important;
  }

  .resistance-level {
    border-left: 3px solid rgba(229, 57, 53, 0.5) !important;
  }

  .drc-level-price {
    font-weight: 500 !important;
    margin-right: 8px !important;
  }

  .drc-level-importance {
    font-size: 12px !important;
    padding: 2px 6px !important;
    border-radius: 3px !important;
  }

  .importance-high {
    background-color: rgba(229, 57, 53, 0.1) !important;
  }

  .importance-high .drc-level-importance {
    background-color: rgba(229, 57, 53, 0.2) !important;
    color: var(--color-error, #e53935) !important;
  }

  .importance-medium {
    background-color: rgba(255, 152, 0, 0.1) !important;
  }

  .importance-medium .drc-level-importance {
    background-color: rgba(255, 152, 0, 0.2) !important;
    color: var(--color-orange, #ef6c00) !important;
  }

  .importance-low {
    background-color: rgba(33, 150, 243, 0.1) !important;
  }

  .importance-low .drc-level-importance {
    background-color: rgba(33, 150, 243, 0.2) !important;
    color: var(--interactive-accent) !important;
  }

  .drc-level-remove-button {
    padding: 0 !important;
    width: 24px !important;
    height: 24px !important;
    background-color: rgba(229, 57, 53, 0.1) !important;
    color: var(--color-error, #e53935) !important;
    border: none !important;
    border-radius: 50% !important;
    cursor: pointer !important;
    font-size: 16px !important;
    line-height: 0 !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    margin-left: auto !important; /* Always push to the right */
    text-align: center !important;
    vertical-align: middle !important;
  }

  .drc-empty-levels {
    color: var(--text-muted) !important;
    font-style: italic !important;
    padding: 8px !important;
    text-align: center !important;
  }

  /* Ultra-high specificity rule for DRC navigation container */
  html body .drc-container .drc-header .drc-navigation,
  body .drc-container .drc-header .drc-navigation,
  .workspace-leaf .drc-container .drc-header .drc-navigation {
    width: 100% !important;
    padding-top: 10px !important;
    border-top: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1)) !important;
  }

  /* Ultra-high specificity rule for DRC navigation links container */
  html body .drc-container .drc-header .drc-navigation .drc-navigation-links,
  body .drc-container .drc-header .drc-navigation .drc-navigation-links,
  .workspace-leaf .drc-container .drc-header .drc-navigation .drc-navigation-links {
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    gap: 8px !important;
    flex-wrap: wrap !important;
    width: 100% !important;
  }

  /* Forecast section styling for DRC - matches Weekly Review */
  .drc-forecast-section {
    margin-bottom: 20px;
    padding: 16px;
    background-color: var(--background-secondary);
    border-radius: 8px;
  }

  /* Specific styling for forecast textareas - matching weekly review */
  .drc-forecast-section textarea,
  .drc-forecast-section .drc-textarea {
    width: 100%;
    min-height: 80px;
    padding: 12px;
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    font-family: var(--font-text);
    font-size: 14px;
    resize: vertical;
  }

  .drc-forecast-section h4 {
    margin-top: 0;
    margin-bottom: 15px;
    font-size: 1.05em;
  }

  .drc-image-container {
    margin-bottom: 12px;
  }

  .drc-image {
    position: relative;
    margin-bottom: 12px;
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    padding: 8px;
    background-color: var(--background-primary);
  }

  .drc-forecast-image {
    width: auto;
    max-width: 100%;
    max-height: 300px;
    object-fit: contain;
    border-radius: 6px;
    margin-bottom: 8px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    background-color: var(--background-primary);
  }

  .drc-image-upload {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 80px;
    border: 2px dashed var(--background-modifier-border);
    border-radius: 6px;
    margin-bottom: 12px;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
    overflow: hidden;
  }

  .drc-image-upload:hover {
    border-color: var(--interactive-accent);
    background-color: rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.05);
  }

  .drc-image-upload.dragging-over {
    border-color: var(--interactive-accent);
    background-color: rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.1);
    transform: scale(1.02);
    box-shadow: 0 0 12px rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.3);
  }

  .drc-image-upload::after {
    content: "Drag and drop here";
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 16px;
    font-weight: 600;
    color: var(--interactive-accent);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s ease;
  }

  .drc-image-upload.dragging-over::after {
    opacity: 1;
  }

  .drc-image-upload.dragging-over .drc-image-label {
    opacity: 0;
  }

  .drc-image-label {
    font-size: 14px;
    color: var(--text-muted);
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .drc-image-upload:hover .drc-image-label {
    color: var(--interactive-accent);
  }

  .drc-image-input {
    display: none;
  }

  .drc-image-delete {
    background-color: rgba(229, 57, 53, 0.1);
    color: var(--color-error, #e53935);
    border: none;
    border-radius: 4px;
    padding: 6px 12px;
    font-size: 12px;
    cursor: pointer;
  }

  .drc-image-error {
    color: var(--text-error, var(--color-red, #e53935));
    font-size: 12px;
    text-align: center;
    margin-top: 4px;
    margin-bottom: 8px;
    padding: 6px 10px;
    background-color: rgba(229, 57, 53, 0.1);
    border-radius: 4px;
    width: 100%;
  }

  /* Hint for click/hold to zoom */
  .drc-forecast-image {
    cursor: zoom-in !important;
    position: relative;
  }

  .drc-forecast-image::after {
    content: "Click or hold to enlarge";
    position: absolute;
    bottom: 8px;
    right: 8px;
    background-color: rgba(0, 0, 0, 0.6);
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 10px;
    opacity: 0;
    transition: opacity 0.2s ease;
  }

  .drc-forecast-image:hover::after {
    opacity: 1;
  }

  /* Fullscreen styles */
  .drc-fullscreen-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-color: rgba(0, 0, 0, 0.85);
    z-index: 4000; /* Reduced from 1000000 to prevent blocking interactions */
    display: flex;
    align-items: center;
    justify-content: center;
    animation: fadeIn 0.3s ease-in-out;
    backdrop-filter: blur(5px);
    -webkit-backdrop-filter: blur(5px);
    cursor: pointer;
  }

  .drc-fullscreen-content {
    max-width: 90vw;
    max-height: 90vh;
    display: flex;
    flex-direction: column;
    background-color: var(--background-primary);
    border-radius: 8px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
    animation: zoomIn 0.3s ease-in-out;
    overflow: hidden;
    cursor: default;
  }

  .drc-fullscreen-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 16px;
    background-color: var(--background-secondary);
    border-bottom: 1px solid var(--background-modifier-border);
  }

  .drc-fullscreen-header h3 {
    margin: 0;
    font-size: 18px;
    font-weight: 600;
    color: var(--text-normal);
  }

  .drc-fullscreen-close {
    background-color: rgba(229, 57, 53, 0.1);
    color: var(--color-error, #e53935);
    border: none;
    border-radius: 4px;
    padding: 6px 12px;
    font-size: 14px;
    cursor: pointer;
  }

  .drc-fullscreen-close:hover {
    background-color: rgba(229, 57, 53, 0.2);
  }

  .drc-fullscreen-image-container {
    overflow: auto;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 16px;
    background-color: var(--background-primary);
    max-height: calc(90vh - 120px);
    /* Add subtle grid background for transparency */
    background-image: linear-gradient(45deg, var(--background-secondary) 25%, transparent 25%, transparent 75%, var(--background-secondary) 75%),
               linear-gradient(45deg, var(--background-secondary) 25%, transparent 25%, transparent 75%, var(--background-secondary) 75%);
    background-size: 20px 20px;
    background-position: 0 0, 10px 10px;
  }

  .drc-fullscreen-image {
    max-width: 100%;
    max-height: calc(90vh - 120px);
    object-fit: contain;
    border-radius: 4px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
  }

  .drc-fullscreen-footer {
    padding: 10px 16px;
    background-color: var(--background-secondary);
    border-top: 1px solid var(--background-modifier-border);
    text-align: center;
  }

  .drc-fullscreen-footer p {
    margin: 0;
    font-size: 12px;
    color: var(--text-muted);
  }

  /* Animations */
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  @keyframes zoomIn {
    from { transform: scale(0.9); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
  }

  /* Weekly Events Styling for DRC */
  .drc-weekly-events {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .drc-weekly-event-item {
    padding: 12px;
    background-color: var(--background-secondary);
    border-radius: 8px;
    border-left: 5px solid var(--event-color-gray, #888888);
    margin-bottom: 8px;
    transition: border-color 0.3s ease;
  }

  .drc-weekly-event-item.event-color-red {
    border-left-color: var(--event-color-red, #e53935);
  }

  .drc-weekly-event-item.event-color-orange {
    border-left-color: var(--event-color-orange, #fb8c00);
  }

  .drc-weekly-event-item.event-color-yellow {
    border-left-color: var(--event-color-yellow, #fdd835);
  }

  .drc-weekly-event-item.event-color-gray {
    border-left-color: var(--event-color-gray, #888888);
  }

  .drc-weekly-event-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 8px;
  }

  .drc-weekly-event-header h4 {
    margin: 0;
    font-size: 14px;
    font-weight: 600;
  }

  .drc-weekly-event-item p {
    margin: 0;
    font-size: 14px;
    color: var(--text-normal);
    white-space: pre-line;
  }

  .drc-weekly-event-badge {
    font-size: 12px;
    padding: 2px 8px;
    background-color: var(--background-modifier-border);
    border-radius: 4px;
    color: var(--text-normal);
    font-weight: 500;
    white-space: nowrap;
  }

  /* Ultra-high specificity rule for DRC navigation buttons */
  html body .drc-container .drc-header .drc-navigation .drc-navigation-links .drc-nav-button,
  body .drc-container .drc-header .drc-navigation .drc-navigation-links .drc-nav-button,
  .workspace-leaf .drc-container .drc-header .drc-navigation .drc-navigation-links .drc-nav-button {
    padding: 8px 14px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    cursor: pointer !important;
    font-size: 14px !important;
    transition: all 0.2s !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    gap: 6px !important;
    flex: 1 !important;
    text-align: center !important;
    min-width: 120px !important;
    box-sizing: border-box !important;
    max-width: none !important;
    margin: 0 !important;
  }

  /* Ensure proper icon spacing for DRC navigation buttons */
  html body .drc-container .drc-header .drc-navigation .drc-nav-button .nav-icon,
  body .drc-container .drc-header .drc-navigation .drc-nav-button .nav-icon {
    font-size: 16px !important;
    line-height: 1 !important;
  }

  /* End of Day Review Styles */
  .drc-eod-images {
    padding: 16px;
    background-color: var(--background-secondary);
    border-radius: 6px;
  }

  .drc-eod-image-uploader {
    margin-top: 8px;
  }

  .drc-eod-review-button-section {
    text-align: center;
  }

  .drc-eod-review-button-section .review-button-container {
    justify-content: center;
  }

  /* No questions message */
  .drc-no-questions {
    padding: 16px;
    text-align: center;
    color: var(--text-muted);
    font-style: italic;
  }
`;function VC(){if(document.head.querySelector("#drc-styles"))return;let e=document.createElement("style");e.id="drc-styles",e.textContent=yK,document.head.appendChild(e)}function Bb(){VC()}function G2(){var n,i,o;let e=window.journalitPlugin,t=(o=(i=(n=e==null?void 0:e.settings)==null?void 0:n.trade)==null?void 0:i.skipWeekends)!=null?o:!0;document.querySelectorAll(".journalit-dashboard-calendar-grid").forEach(a=>{a instanceof HTMLElement&&(Object.assign(a.style,{display:"flex",flexDirection:"column",gap:"4px",width:"100%"}),a.querySelectorAll(".journalit-dashboard-calendar-week").forEach(c=>{c instanceof HTMLElement&&(Object.assign(c.style,{display:"grid",gridTemplateColumns:t?"repeat(5, 1fr) 1fr":"repeat(7, 1fr) 1fr",gap:"4px",marginBottom:"4px",width:"100%"}),t?(c.style.gridTemplateColumns="repeat(5, 1fr) 1fr",c.style.justifyContent="stretch",c.classList.add("hide-weekends")):c.classList.remove("hide-weekends"))}),a.querySelectorAll(".journalit-dashboard-calendar-day").forEach((c,d)=>{if(c instanceof HTMLElement){Object.assign(c.style,{aspectRatio:"1",display:"flex",flexDirection:"column",position:"relative",padding:"4px",borderRadius:"4px",width:"100%"}),c.classList.contains("today")&&Object.assign(c.style,{position:"relative",zIndex:"2"});let u=c.querySelector(".journalit-dashboard-calendar-day-number");u instanceof HTMLElement&&Object.assign(u.style,{position:"absolute",top:"4px",left:"4px",textAlign:"left"});let p=c.querySelector(".journalit-dashboard-calendar-day-pnl");p instanceof HTMLElement&&Object.assign(p.style,{fontSize:"12px",marginTop:"0px",width:"100%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"})}}))})}function Y2(){var n,i,o;let e=window.journalitPlugin,t=(o=(i=(n=e==null?void 0:e.settings)==null?void 0:n.trade)==null?void 0:i.skipWeekends)!=null?o:!0;document.querySelectorAll(".journalit-dashboard-calendar-header").forEach(a=>{if(a instanceof HTMLElement){t?a.classList.add("hide-weekends"):a.classList.remove("hide-weekends");let s=t?"repeat(5, 1fr) 1fr":"repeat(7, 1fr) 1fr";Object.assign(a.style,{display:"grid",gridTemplateColumns:s,gap:"4px",marginBottom:"8px",position:"sticky",top:"0",backgroundColor:"var(--background-primary)",zIndex:"5",padding:"4px 0",width:"100%",justifyContent:"stretch"}),a.querySelectorAll(".journalit-dashboard-calendar-weekday").forEach(c=>{c instanceof HTMLElement&&Object.assign(c.style,{width:"100%",textAlign:"center"})}),t&&a.querySelectorAll(".journalit-dashboard-calendar-weekday").forEach(d=>{if(d instanceof HTMLElement){let u=d.getAttribute("data-day");u==="Sun"||u==="Sat"?d.style.display="none":d.style.display=""}})}})}var q2=()=>{G2(),Y2(),la()};function HC(){var e,t,r;try{let n=window.journalitPlugin,i=(r=(t=(e=n==null?void 0:n.settings)==null?void 0:e.trade)==null?void 0:t.skipWeekends)!=null?r:!0;document.querySelectorAll(".journalit-dashboard-calendar").forEach(a=>{if(a instanceof HTMLElement){i?(a.classList.add("hide-weekends"),a.classList.add("weekends-hidden"),a.querySelectorAll(".journalit-dashboard-calendar-weekday").forEach(d=>{if(d instanceof HTMLElement){let u=d.getAttribute("data-day");u==="Sun"||u==="Sat"?d.style.display="none":d.style.display=""}})):(a.classList.remove("hide-weekends"),a.classList.remove("weekends-hidden"),a.querySelectorAll(".journalit-dashboard-calendar-weekday").forEach(d=>{d instanceof HTMLElement&&(d.style.display="")})),a.style.width="100%",a.style.display="flex",a.style.flexDirection="column";let s=a.querySelector(".journalit-dashboard-calendar-header");s instanceof HTMLElement&&(s.style.gridTemplateColumns=i?"repeat(5, 1fr) 1fr":"repeat(7, 1fr) 1fr",s.style.width="100%"),a.querySelectorAll(".journalit-dashboard-calendar-week").forEach(c=>{c instanceof HTMLElement&&(c.style.gridTemplateColumns=i?"repeat(5, 1fr) 1fr":"repeat(7, 1fr) 1fr",c.style.width="100%",c.querySelectorAll(".journalit-dashboard-calendar-weekly-pnl").forEach(u=>{if(u instanceof HTMLElement){Object.assign(u.style,{position:"relative",display:"flex",flexDirection:"column"});let p=u.querySelector(".journalit-dashboard-calendar-week-number");p instanceof HTMLElement&&Object.assign(p.style,{position:"absolute",top:"4px",left:"4px",textAlign:"left",marginBottom:"0px"});let m=u.querySelector(".journalit-dashboard-calendar-weekly-pnl-value");m instanceof HTMLElement&&Object.assign(m.style,{fontSize:"12px",width:"100%",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"})}}))})}})}catch(n){console.error("Error applying consistent grid structure:",n)}}function bK(e){try{let t=e.clientWidth,r=12,n=12,i=10,o=1;t<25?o=.55:t<30?o=.65:t<40?o=.75:t<50?o=.85:t>90?o=1.15:t>80&&(o=1.05);let a="50%",s="65%";return t<30?(a="40%",s="78%"):t<40?(a="42%",s="75%"):t<50?(a="44%",s="73%"):t<60?(a="46%",s="70%"):(a="48%",s="68%"),{dayNumber:`${Math.max(7,Math.round(r*o))}px`,pnlValue:`${Math.max(7,Math.round(n*(o*.95)))}px`,tradeCount:`${Math.max(6,Math.round(i*(o*.9)))}px`,pnlPosition:a,tradePosition:s}}catch(t){return console.error("Error calculating responsive sizes:",t),{dayNumber:"12px",pnlValue:"12px",tradeCount:"10px",pnlPosition:"50%",tradePosition:"65%"}}}function la(){try{if(document.querySelectorAll(".journalit-dashboard-calendar").length===0)return;let t=document.querySelector(".journalit-dashboard-calendar-day");if(!t)return;let r=bK(t),n={position:"relative",display:"flex",alignItems:"",justifyContent:""},i={position:"absolute",top:"4px",left:"4px",textAlign:"left",fontSize:r.dayNumber,fontWeight:"500"};document.querySelectorAll(".journalit-dashboard-calendar-day").forEach(l=>{if(l instanceof HTMLElement){Object.assign(l.style,n);let c=l.querySelector(".journalit-dashboard-calendar-day-number");c instanceof HTMLElement&&Object.assign(c.style,i);let d=l.querySelector(".journalit-dashboard-calendar-day-pnl");d instanceof HTMLElement&&Object.assign(d.style,{position:"absolute",top:r.pnlPosition,left:"50%",transform:"translate(-50%, -50%)",width:"100%",marginTop:"0px",fontSize:r.pnlValue,fontWeight:"600",textAlign:"center"});let u=l.querySelector(".journalit-dashboard-calendar-day-trades");u instanceof HTMLElement&&Object.assign(u.style,{position:"absolute",top:r.tradePosition,left:"50%",transform:"translate(-50%, -50%)",width:"100%",fontSize:r.tradeCount,fontWeight:"400",textAlign:"center",color:"var(--text-muted)",backgroundColor:"transparent",borderRadius:"0",padding:"0"})}});let a={position:"absolute",top:"4px",left:"4px",textAlign:"left",fontSize:r.dayNumber,fontWeight:"500",marginBottom:"0px"};document.querySelectorAll(".journalit-dashboard-calendar-weekly-pnl").forEach(l=>{if(l instanceof HTMLElement){Object.assign(l.style,{position:"relative"});let c=l.querySelector(".journalit-dashboard-calendar-week-number");c instanceof HTMLElement&&Object.assign(c.style,a);let d=l.querySelector(".journalit-dashboard-calendar-week-total-label");d instanceof HTMLElement&&Object.assign(d.style,{position:"absolute",top:"25%",left:"50%",transform:"translate(-50%, -50%)",width:"100%",fontSize:r.tradeCount,fontWeight:"600",textAlign:"center"});let u=l.querySelector(".journalit-dashboard-calendar-week-total-value");u instanceof HTMLElement&&Object.assign(u.style,{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"100%",fontSize:r.pnlValue,fontWeight:"700",textAlign:"center"});let p=l.querySelector(".journalit-dashboard-calendar-week-trade-count");p instanceof HTMLElement&&Object.assign(p.style,{position:"absolute",bottom:"20%",left:"50%",transform:"translate(-50%, 50%)",width:"85%",fontSize:r.tradeCount,fontWeight:"500",textAlign:"center",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"var(--text-muted)",backgroundColor:"transparent",borderRadius:"0",padding:"0"})}})}catch(e){console.error("Error applying calendar cell styling:",e)}}function Kg(){try{if(typeof ResizeObserver=="undefined"){console.warn("ResizeObserver not supported in this browser. Calendar responsive text might not work.");return}window.__journalitCalendarResizeObserver&&window.__journalitCalendarResizeObserver.disconnect();let e=null,t=new ResizeObserver(o=>{e&&clearTimeout(e),e=setTimeout(()=>{o.forEach(a=>{if(a.target instanceof HTMLElement){let s=a.contentRect,l=a.target.__lastCalendarSize;if(l&&Math.abs(s.width-l.width)<5&&Math.abs(s.height-l.height)<5)return;a.target.__lastCalendarSize={width:s.width,height:s.height}}}),la()},150)});window.__journalitCalendarResizeObserver=t,document.querySelectorAll(".journalit-dashboard-calendar").forEach(o=>{t.observe(o)}),document.querySelectorAll(".journalit-dashboard-widget").forEach(o=>{o.querySelector(".journalit-dashboard-calendar")&&t.observe(o)}),document.querySelectorAll(".react-grid-item").forEach(o=>{o.querySelector(".journalit-dashboard-calendar")&&t.observe(o)}),la(),setTimeout(la,50),setTimeout(la,200)}catch(e){console.error("Error setting up calendar resize observer:",e)}}function Jg(){try{HC(),G2(),Y2(),la(),requestAnimationFrame(()=>{la(),window.__journalitCalendarResizeObserver||Kg()}),document.removeEventListener("dashboard-styles-updated",q2),document.addEventListener("dashboard-styles-updated",q2)}catch(e){console.error("Error applying calendar style fixes:",e)}}var wK=`
  /* Base styling that applies regardless of transparency setting */
  /* Dashboard CSS variables */
  :root {
    /* Add background color variables for filled mode */
    --widget-bg-color: transparent;
    --metric-card-bg-color: transparent;
    --chart-bg-color: transparent;
    --calendar-day-bg-color: transparent;
    --calendar-weekday-bg-color: transparent;
    --interactive-accent-rgb: 94, 129, 172;
    --dashboard-dot-color: rgba(120, 120, 120, 0.15);
  }

  /* Light theme specific dot color */
  .theme-light .journalit-dashboard-view {
    background-image: radial-gradient(circle, rgba(0, 0, 0, 0.1) 1px, transparent 1px) !important;
  }

  /* Dark theme specific dot color */
  .theme-dark .journalit-dashboard-view {
    background-image: radial-gradient(circle, rgba(255, 255, 255, 0.04) 1px, transparent 1px) !important;
  }

  /* Ensure no gap below view-header */
  .view-header {
    margin-bottom: 0 !important;
    padding-bottom: 0 !important;
  }
  
  /* Dashboard view container */
  .journalit-dashboard-view {
    width: 100% !important;
    height: 100% !important;
    display: flex !important;
    flex-direction: column !important;
    background-color: var(--background-primary) !important;
    background-size: 20px 20px !important;
    background-position: 0 0 !important;
    padding: 16px !important;
    overflow-x: hidden !important;
    overflow-y: auto !important;
    margin-top: 0 !important; /* Explicitly set to avoid unintended spacing */
  }
  
  /* Unified dashboard container for TopSection and BottomSection */
  .journalit-dashboard-unified-container {
    display: flex !important;
    flex-direction: column !important;
    gap: 2.5px !important; /* Set to half of the blue line gap (5px) */
    background-color: transparent !important;
    padding: 0 !important;
    flex: 1 1 0 !important; /* CRITICAL: Force height constraint like TradeLog fix */
    min-height: 0 !important; /* Prevent flexbox expansion */
    height: 0 !important; /* Force parent to control height */
  }
  
  /* Top metrics section */
  .journalit-dashboard-top-section {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 4px !important; /* Reduced from 16px to match grid layout gap */
    margin-bottom: 0 !important;
    padding: 4px !important; /* Reduced from 8px to reduce vertical spacing */
    background-color: transparent !important;
    border-radius: 0 !important;
    box-shadow: none !important;
  }
  
  /* Top metrics section styling */
  .journalit-dashboard-metrics {
    display: flex !important;
    flex-direction: row !important; /* Force horizontal layout */
    flex-wrap: wrap !important; /* Allow wrapping to new rows */
    gap: 8px !important; /* Consistent gap between cards */
    width: 100% !important; /* Ensure full width */
    overflow-x: hidden !important; /* No horizontal scrolling needed */
    overflow-y: visible !important; /* Allow vertical expansion */
    align-items: stretch !important; /* Make all cards the same height within each row */
    height: auto !important; /* Auto height based on content */
    min-height: auto !important; /* Let height be determined by content */
    padding: 10px 0 !important; /* Add some vertical padding */
    justify-content: flex-start !important; /* Align cards to the left */
  }
  
  /* Metric wrapper and card */
  .journalit-dashboard-metric-wrapper {
    position: relative !important;
    display: block !important;
    flex: 1 1 180px !important; /* Allow growing and shrinking with 180px base */
    min-width: 180px !important; /* Minimum width before wrapping */
    max-width: 300px !important; /* Maximum width to prevent cards from getting too wide */
  }
  
  /* We use the widget-remove button class for both widgets and metrics for consistency */
  .journalit-dashboard-widget-remove {
    position: absolute !important;
    top: 4px !important;
    right: 4px !important;
    background-color: var(--background-modifier-error) !important;
    color: white !important;
    border: none !important;
    border-radius: 50% !important;
    width: 22px !important;
    height: 22px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    font-size: 12px !important;
    cursor: pointer !important;
    z-index: 10000 !important; /* High, but lower than the overlay z-index */
    padding: 0 !important;
    font-weight: bold !important;
    line-height: 1 !important;
    pointer-events: auto !important;
    transition: opacity 0.2s ease, transform 0.2s ease !important;
    opacity: 0 !important; /* Hidden by default */
  }
  
  /* Show the remove button on widget hover in edit mode */
  .journalit-dashboard-grid-layout.is-editing .react-grid-item:hover .journalit-dashboard-widget-remove {
    opacity: 1 !important;
  }
  
  /* Show the remove button on metric hover in edit mode */
  .journalit-dashboard-top-section .journalit-dashboard-metric-wrapper:hover .journalit-dashboard-widget-remove {
    opacity: 1 !important;
  }
  
  /* Ensure the remove button is always clickable and has highest z-index */
  .journalit-dashboard-metric-wrapper .journalit-dashboard-widget-remove,
  .journalit-dashboard-widget .journalit-dashboard-widget-remove {
    pointer-events: auto !important;
    z-index: 100 !important; /* Reduced from 100000 to reasonable value */
  }
  
  .journalit-dashboard-widget-remove:hover {
    background-color: var(--text-error) !important;
    transform: scale(1.1) !important;
  }
  
  .journalit-dashboard-metric-card {
    flex: 1 1 180px !important; /* Allow growing and shrinking with 180px base */
    min-width: 180px !important;
    max-width: 300px !important; /* Prevent cards from getting too wide */
    padding: 14px !important;
    background-color: transparent !important;
    border-radius: 8px !important;
    border: 1px solid rgba(var(--background-modifier-border-rgb, 0, 0, 0), 0.08) !important;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04), 0 0 1px rgba(0, 0, 0, 0.08) !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: flex-start !important;
  }
  
  .journalit-dashboard-metric-name {
    font-size: 14px !important;
    font-weight: 600 !important;
    color: var(--text-muted) !important;
    margin-bottom: 6px !important;
    text-transform: uppercase !important;
    letter-spacing: 0.5px !important;
    text-align: left !important;
    width: 100% !important;
  }
  
  .journalit-dashboard-metric-value {
    font-size: 24px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    text-align: left !important;
    width: 100% !important;
  }
  
  .journalit-dashboard-metric-value.positive {
    color: #43a047 !important; /* Green for positive values */
  }
  
  .journalit-dashboard-metric-value.negative {
    color: #e53935 !important; /* Red for negative values */
  }
  
  /* Styling for cents in currency values */
  .journalit-dashboard-metric-cents {
    font-size: 16px !important;
    opacity: 0.7 !important;
    font-weight: 500 !important;
    margin-left: 1px !important;
    display: inline-block !important;
  }
  
  /* Filter controls - Redesigned for single row compact layout */
  .journalit-dashboard-filter-controls {
    --button-gap: 8px; /* Variable for consistent spacing between buttons */
    display: flex !important;
    flex-direction: column !important;
    margin-bottom: 2.5px !important; /* Reduced from 5px to 2.5px (half of original) */
    padding: 12px 16px !important;
    background-color: var(--background-secondary) !important;
    border-radius: 8px !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15) !important;
    position: relative !important;
  }
  
  /* Filter row base styles */
  .journalit-dashboard-filter-row {
    display: grid !important;
    grid-template-columns: auto 1fr auto !important;
    gap: 20px !important;
    align-items: center !important; /* Change from flex-start to center */
    width: 100% !important;
  }
  
  /* Combined filters section */
  .journalit-dashboard-filters-section {
    display: flex !important;
    flex-direction: row !important;
    gap: 10px !important;
    align-items: center !important;
    min-width: 0 !important; /* Allow content to shrink if needed */
    flex: 1 !important;
  }
  
  .journalit-dashboard-date-range-section {
    display: flex !important;
    flex-direction: row !important;
    position: relative !important; /* Needed for absolute positioning of dropdown */
    /* Removed fixed min-width */
    flex: 1 !important;
    /* Changed from fixed margin to flexible margin */
    margin-right: 10px !important;
    margin-top: 0 !important; /* Ensure consistent alignment */
  }
  
  .journalit-dashboard-tickers-section,
  .journalit-dashboard-accounts-section {
    display: flex !important;
    flex-direction: row !important;
    /* Remove justify-self which can cause positioning issues */
    flex: 0 0 auto !important; /* Don't allow shrinking */
    margin-right: 10px !important;
    margin-top: 0 !important; /* Ensure consistent alignment */
  }
  
  .journalit-dashboard-filter-label {
    font-size: 13px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    margin-bottom: 4px !important;
    display: inline-block !important;
  }
  
  .journalit-dashboard-filter-actions {
    display: flex !important;
    align-items: center !important;
    /* Remove justify-self that can create issues */
    flex: 0 0 auto !important; /* Don't allow shrinking */
    gap: var(--button-gap) !important;
    min-width: fit-content !important; /* Ensure buttons don't get squished */
    justify-self: end !important; /* Force align to the right in grid */
    margin-left: auto !important; /* Add auto margin to push to the right */
  }
  
  /* Special container for buttons in compact view */
  .journalit-dashboard-filter-actions.button-container {
    display: flex !important;
    flex-direction: column !important;
    gap: var(--button-gap) !important;
  }
  
  /* Ensure buttons in compact view have consistent spacing */
  .journalit-dashboard-filter-actions.button-container .journalit-dashboard-reset-button,
  .journalit-dashboard-filter-actions.button-container .journalit-dashboard-edit-mode-button {
    margin-bottom: 0 !important;
    margin-top: 0 !important;
    height: 28px !important;
    line-height: 1 !important;
  }
  
  /* Date range filter - More compact */
  .journalit-dashboard-date-range-filter {
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important;
    position: relative !important; /* Add this to ensure proper containment of the dropdown */
  }
  
  .journalit-dashboard-date-range-presets {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 6px !important;
    align-items: center !important;
  }
  
  .journalit-dashboard-date-range-presets button {
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    padding: 5px 10px !important;
    font-size: 12px !important;
    font-weight: 500 !important;
    color: var(--text-normal) !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
    height: 28px !important;
    line-height: 1 !important;
  }
  
  .journalit-dashboard-date-range-presets button:hover {
    background-color: var(--background-modifier-hover) !important;
    border-color: var(--interactive-accent) !important;
  }
  
  .journalit-dashboard-date-range-presets button.active {
    background-color: var(--interactive-accent) !important;
    color: var(--text-on-accent) !important;
    border-color: var(--interactive-accent) !important;
  }
  
  .journalit-dashboard-date-range-inputs {
    display: flex !important;
    gap: 10px !important;
    flex-wrap: nowrap !important; /* Keep horizontal layout */
    padding: 8px !important;
    background-color: var(--background-primary) !important;
    border-radius: 4px !important;
    border: 1px solid var(--background-modifier-border) !important;
    margin-top: 0 !important; /* Remove top margin */
    position: absolute !important;
    top: 0 !important; /* Align with the buttons horizontally */
    left: auto !important; /* Reset left positioning */
    right: -360px !important; /* Position to the right of buttons */
    z-index: 100 !important;
    width: 350px !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1) !important;
    transition: opacity 0.2s ease, transform 0.2s ease !important;
    opacity: 1 !important;
    transform: translateY(0) !important;
  }
  
  /* Animation for opening/closing the dropdown */
  .journalit-dashboard-date-range-inputs.date-dropdown-visible {
    animation: dateDropdownFadeIn 0.25s cubic-bezier(0.19, 1, 0.22, 1) !important;
  }
  
  @keyframes dateDropdownFadeIn {
    from {
      opacity: 0;
      transform: translateY(-5px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  /* Specific styling for custom date dropdown to make sure it appears in the right position */
  .journalit-dashboard-custom-date-dropdown {
    position: absolute !important;
    top: 0 !important; /* Position at the same level as buttons */
    left: auto !important;
    right: -360px !important; /* Position to the right of the custom button */
    z-index: 100 !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2) !important;
  }

  /* Position dropdown to the left when it would go off-screen */
  .journalit-dashboard-custom-date-dropdown.position-left {
    right: auto !important;
    left: -360px !important; /* Position to the left of the custom button */
  }
  
  .journalit-dashboard-date-range-start,
  .journalit-dashboard-date-range-end {
    flex: 1 !important;
    min-width: 150px !important;
  }
  
  .journalit-dashboard-date-range-start label,
  .journalit-dashboard-date-range-end label {
    display: block !important;
    font-size: 12px !important;
    margin-bottom: 4px !important;
    color: var(--text-muted) !important;
    font-weight: 500 !important;
  }
  
  /* Date picker input styling */
  .journalit-date-picker-input input {
    width: 100% !important;
    padding: 6px 10px !important;
    font-size: 13px !important;
    border-radius: 4px !important;
    border: 1px solid var(--background-modifier-border) !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    transition: border-color 0.2s ease, box-shadow 0.2s ease !important;
  }
  
  .journalit-date-picker-input input:focus {
    border-color: var(--interactive-accent) !important;
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2) !important;
    outline: none !important;
  }
  
  .journalit-date-picker-input input:hover {
    border-color: var(--interactive-hover) !important;
  }
  
  /* Account filter - New dropdown style */
  .journalit-dashboard-account-filter,
  .journalit-dashboard-ticker-filter {
    display: flex !important;
    flex-direction: column !important;
    /* Changed from fixed width to min-width for better responsiveness */
    min-width: 140px !important;
    max-width: 200px !important;
    width: 100% !important;
    position: relative !important;
  }
  
  /* Ensure filters within the combined section size properly */
  .journalit-dashboard-filters-section .journalit-dashboard-tickers-section,
  .journalit-dashboard-filters-section .journalit-dashboard-accounts-section {
    flex: 1 !important;
    min-width: 0 !important;
  }
  
  /* Responsive account/ticker filter class for enhanced appearance across screen sizes */
  .journalit-responsive-account-filter,
  .journalit-responsive-ticker-filter {
    width: auto !important;
    flex-shrink: 0 !important;
    /* Ensure dropdowns always fit content */
    white-space: nowrap !important;
    overflow: visible !important;
  }
  
  .journalit-dashboard-account-dropdown,
  .journalit-dashboard-ticker-dropdown {
    position: relative !important;
    width: 100% !important;
  }
  
  .journalit-dashboard-account-summary,
  .journalit-dashboard-ticker-summary {
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    padding: 5px 10px !important;
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    cursor: pointer !important;
    font-size: 12px !important;
    transition: all 0.2s ease !important;
    height: 28px !important;
    line-height: 1 !important;
  }
  
  .journalit-dashboard-account-summary:hover,
  .journalit-dashboard-ticker-summary:hover {
    border-color: var(--interactive-accent) !important;
    background-color: var(--background-modifier-hover) !important;
  }
  
  .journalit-dashboard-account-summary .dropdown-arrow,
  .journalit-dashboard-ticker-summary .dropdown-arrow {
    font-size: 10px !important;
    color: var(--text-muted) !important;
    margin-left: 8px !important;
  }
  
  .journalit-dashboard-account-options-dropdown,
  .journalit-dashboard-ticker-options-dropdown {
    position: absolute !important;
    top: 100% !important;
    left: 0 !important;
    right: 0 !important;
    max-height: 250px !important;
    overflow-y: auto !important;
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    margin-top: 4px !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1) !important;
    z-index: 100 !important;
    min-width: 200px !important;
  }
  
  .journalit-dashboard-account-option-item,
  .journalit-dashboard-ticker-option-item {
    display: flex !important;
    align-items: center !important;
    gap: 8px !important;
    padding: 8px 12px !important;
    cursor: pointer !important;
    transition: background-color 0.2s ease !important;
    font-size: 13px !important;
  }
  
  .journalit-dashboard-account-option-item:hover,
  .journalit-dashboard-ticker-option-item:hover {
    background-color: var(--background-modifier-hover) !important;
  }
  
  .journalit-dashboard-account-option-item.select-all,
  .journalit-dashboard-ticker-option-item.select-all {
    font-weight: 600 !important;
    color: var(--interactive-accent) !important;
  }
  
  .journalit-dashboard-account-divider,
  .journalit-dashboard-ticker-divider {
    height: 1px !important;
    background-color: var(--background-modifier-border) !important;
    margin: 4px 0 !important;
  }
  
  /* No accounts/tickers message */
  .journalit-dashboard-no-accounts,
  .journalit-dashboard-no-tickers {
    padding: 12px !important;
    color: var(--text-muted) !important;
    font-style: italic !important;
    text-align: center !important;
    font-size: 13px !important;
  }
  
  .journalit-dashboard-reset-button {
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    padding: 5px 10px !important;
    font-size: 12px !important;
    font-weight: 500 !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
    white-space: nowrap !important;
    height: 28px !important;
    line-height: 1 !important;
  }
  
  .journalit-dashboard-reset-button:hover {
    background-color: var(--background-modifier-hover) !important;
    border-color: var(--interactive-accent) !important;
  }
  
  .journalit-dashboard-reset-button:disabled {
    opacity: 0.5 !important;
    cursor: default !important;
  }
  
  /* Grid layout container */
  .journalit-dashboard-bottom-section {
    width: 100% !important;
    min-height: 500px !important;
    background-color: transparent !important;
    border-radius: 0 !important;
    padding: 4px !important; /* Reduced from 8px to match top section */
    position: relative !important;
  }
  
  /* Widget styles */
  .journalit-dashboard-widget {
    background-color: transparent !important;
    border-radius: 6px !important;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1) !important;
    display: flex !important;
    flex-direction: column !important;
    overflow: hidden !important;
    /* backdrop-filter removed as requested */
  }
  
  /* Minimal widget header for non-edit mode */
  .journalit-dashboard-widget-minimal-header {
    display: flex !important;
    justify-content: center !important;
    align-items: center !important;
    padding: 4px 12px !important;
    height: 24px !important;
    background-color: transparent !important;
    border-bottom: 1px solid rgba(var(--background-modifier-border-rgb), 0.4) !important;
    opacity: 0.8 !important;
  }
  
  .journalit-dashboard-widget-minimal-header .journalit-dashboard-widget-title {
    font-weight: 500 !important;
    font-size: 13px !important;
    color: var(--text-muted) !important;
    letter-spacing: 0.3px !important;
    text-align: center !important;
    width: 100% !important;
    /* Add subtle text shadow for better readability */
    text-shadow: 0 1px 1px rgba(var(--background-primary-rgb), 0.8) !important;
  }
  
  .journalit-dashboard-widget-header {
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    padding: 12px 16px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
  }
  
  .journalit-dashboard-widget-title {
    font-size: 16px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
  }
  
  .journalit-dashboard-widget-controls {
    display: flex !important;
    gap: 8px !important;
  }
  
  .journalit-dashboard-widget-content {
    flex: 1 !important;
    padding: 4px 4px 2px 1px !important;
    overflow: hidden !important;
    background-color: transparent !important;
  }
  
  /* React Grid Layout styles */
  .react-grid-item {
    background-color: transparent !important;
    border-radius: 6px !important;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1) !important;
    /* backdrop-filter removed as requested */
  }
  
  .react-grid-item.react-grid-placeholder {
    background-color: var(--interactive-accent) !important;
    opacity: 0.3 !important;
  }
  
  .react-resizable-handle {
    position: absolute !important;
    bottom: 0 !important;
    right: 0 !important;
    width: 20px !important;
    height: 20px !important;
    background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="rgba(120, 120, 120, 0.5)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 22L12 12M22 13V22H13"></path></svg>') !important;
    background-position: bottom right !important;
    padding: 0 3px 3px 0 !important;
    background-repeat: no-repeat !important;
    background-origin: content-box !important;
    box-sizing: border-box !important;
    cursor: se-resize !important;
    display: none !important; /* Hide resize handles by default */
  }
  
  /* Only show resize handles when in edit mode */
  .journalit-dashboard-grid-layout.is-editing .react-resizable-handle {
    display: block !important;
  }
  
  /* Chart styles */
  .recharts-wrapper {
    width: 100% !important;
    height: 100% !important;
  }
  
  .recharts-cartesian-grid-horizontal line,
  .recharts-cartesian-grid-vertical line {
    stroke: var(--background-modifier-border) !important;
    stroke-dasharray: 2 !important;
  }
  
  /* Modern custom tooltip styles */
  .recharts-tooltip-wrapper {
    pointer-events: none !important;
    z-index: 1000 !important;
    filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.25)) !important;
    background-color: transparent !important;
    border: none !important;
  }
  
  .recharts-tooltip-wrapper * {
    outline: none !important;
  }
  
  .journalit-dashboard-custom-tooltip {
    background-color: var(--background-primary, #ffffff) !important;
    border-radius: 8px !important;
    padding: 12px 16px !important;
    min-width: 120px !important;
    border: 1px solid var(--background-modifier-border, rgba(0, 0, 0, 0.05)) !important;
    transform: translateY(-4px) !important;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15) !important;
    position: relative !important;
  }
  
  
  .journalit-dashboard-tooltip-date {
    font-size: 14px !important;
    font-weight: 500 !important;
    color: var(--text-normal, #333333) !important;
    margin-bottom: 6px !important;
    text-align: center !important;
  }
  
  .journalit-dashboard-tooltip-value {
    font-size: 18px !important;
    font-weight: 600 !important;
    text-align: center !important;
  }
  
  .journalit-dashboard-tooltip-value.positive {
    color: var(--text-success, #43a047) !important;
  }
  
  .journalit-dashboard-tooltip-value.negative {
    color: var(--text-error, #e53935) !important;
  }
  
  /* Calendar widget */
  .journalit-dashboard-calendar {
    width: 100% !important;
    height: 100% !important;
    display: flex !important;
    flex-direction: column !important;
    overflow: auto !important;
  }
  
  .journalit-dashboard-calendar-header {
    display: grid !important;
    grid-template-columns: repeat(7, 1fr) 1fr !important; /* 7 days + 1 P&L column */
    margin-bottom: 8px !important;
    gap: 4px !important;
    position: sticky !important;
    top: 0 !important;
    background-color: transparent !important;
    z-index: 5 !important;
    padding: 4px 0 !important;
    width: 100% !important;
    justify-content: stretch !important;
  }
  
  /* Special styling for when weekends are hidden */
  /* We apply the hide-weekends class directly to the header and week rows */
  .journalit-dashboard-calendar-header.hide-weekends,
  .journalit-dashboard-calendar .hide-weekends .journalit-dashboard-calendar-header,
  .journalit-dashboard-calendar.hide-weekends .journalit-dashboard-calendar-header,
  .journalit-dashboard-calendar.weekends-hidden .journalit-dashboard-calendar-header {
    grid-template-columns: repeat(5, 1fr) 1fr !important;
    width: 100% !important;
  }
  
  .journalit-dashboard-calendar-grid {
    display: flex !important;
    flex-direction: column !important;
    gap: 4px !important;
    flex: 1 !important;
    width: 100% !important;
  }
  
  .journalit-dashboard-calendar-week {
    display: grid !important;
    grid-template-columns: repeat(7, 1fr) 1fr !important; /* 7 days + 1 P&L column */
    gap: 4px !important;
    margin-bottom: 4px !important;
    width: 100% !important;
  }
  
  /* Special styling for when weekends are hidden */
  .journalit-dashboard-calendar-week.hide-weekends,
  .journalit-dashboard-calendar .hide-weekends .journalit-dashboard-calendar-week,
  .journalit-dashboard-calendar.hide-weekends .journalit-dashboard-calendar-week,
  .journalit-dashboard-calendar.weekends-hidden .journalit-dashboard-calendar-week {
    grid-template-columns: repeat(5, 1fr) 1fr !important;
    width: 100% !important;
  }
  
  /* Ensure the calendar container has proper styles */
  .journalit-dashboard-calendar.hide-weekends,
  .journalit-dashboard-calendar.weekends-hidden {
    width: 100% !important;
  }
  
  /* Ensure grid cells take up full width in their columns */
  .journalit-dashboard-calendar-day,
  .journalit-dashboard-calendar-weekly-pnl {
    width: 100% !important; 
  }
  
  /* Ensure P&L header is visible in both light and dark modes */
  .theme-light .journalit-dashboard-calendar-weekday.weekly-pnl-header {
    background-color: var(--interactive-accent, #5e81ac) !important; /* Use an accent background with fallback for better contrast */
    color: var(--text-on-accent, #ffffff) !important; /* Ensure text color is appropriate for accent background */
  }

  /* Weekly P&L column styles */
  .journalit-dashboard-calendar-weekly-pnl {
    aspect-ratio: 1 !important;
    position: relative !important;
    background-color: var(--background-secondary-alt) !important;
    border-radius: 8px !important;
    padding: 4px !important;
    border-left: 1px solid rgba(0, 0, 0, 0.08) !important;
    cursor: pointer !important;
    transition: transform 0.2s ease-out, box-shadow 0.2s ease-out !important;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05), 0 0 0 1px var(--background-modifier-border) !important;
    color: var(--text-normal) !important;
  }
  
  .journalit-dashboard-calendar-weekly-pnl:hover {
    transform: scale(1.05) !important;
  }
  
  .journalit-dashboard-calendar-weekly-pnl.positive {
    background-color: rgba(67, 160, 71, 0.15) !important;
    color: #43a047 !important;
  }
  
  .journalit-dashboard-calendar-weekly-pnl.negative {
    background-color: rgba(229, 57, 53, 0.15) !important;
    color: #e53935 !important;
  }
  
  /* Weekly totals positioning */
  .journalit-dashboard-calendar-week-total-label {
    font-size: 11px !important;
    font-weight: 600 !important;
    text-transform: uppercase !important;
    letter-spacing: 0.5px !important;
    color: var(--text-muted) !important;
    position: absolute !important;
    top: 25% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    width: 100% !important;
    text-align: center !important;
  }

  .journalit-dashboard-calendar-week-total-value {
    font-size: 13px !important;
    font-weight: 700 !important;
    position: absolute !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    width: 100% !important;
    text-align: center !important;
  }

  .journalit-dashboard-calendar-week-trade-count {
    font-size: 10px !important;
    color: var(--text-muted) !important;
    font-weight: 500 !important;
    position: absolute !important;
    bottom: 20% !important;
    left: 50% !important;
    transform: translate(-50%, 50%) !important;
    width: 85% !important;
    text-align: center !important;
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
  }
  
  .journalit-dashboard-calendar-day {
    aspect-ratio: 1 !important;
    display: flex !important;
    position: relative !important; /* Added for absolute positioning */
    border-radius: 8px !important;
    cursor: pointer !important;
    font-size: 12px !important;
    font-weight: 500 !important;
    transition: all 0.2s !important;
    background-color: var(--background-secondary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05) !important;
  }
  
  .journalit-dashboard-calendar-day:hover {
    transform: scale(1.05) !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1) !important;
  }
  
  .journalit-dashboard-calendar-day.positive {
    background-color: rgba(67, 160, 71, 0.15) !important;
    background-image: linear-gradient(to bottom, rgba(67, 160, 71, 0.05), rgba(67, 160, 71, 0.2)) !important;
    color: #43a047 !important;
    border-color: rgba(67, 160, 71, 0.3) !important;
    box-shadow: 0 2px 8px rgba(67, 160, 71, 0.1) !important;
  }
  
  .journalit-dashboard-calendar-day.negative {
    background-color: rgba(229, 57, 53, 0.15) !important;
    background-image: linear-gradient(to bottom, rgba(229, 57, 53, 0.05), rgba(229, 57, 53, 0.2)) !important;
    color: #e53935 !important;
    border-color: rgba(229, 57, 53, 0.3) !important;
    box-shadow: 0 2px 8px rgba(229, 57, 53, 0.1) !important;
  }
  
  .journalit-dashboard-calendar-day.positive:hover {
    box-shadow: 0 4px 12px rgba(67, 160, 71, 0.2), 0 0 0 1px rgba(67, 160, 71, 0.5) !important;
  }
  
  .journalit-dashboard-calendar-day.negative:hover {
    box-shadow: 0 4px 12px rgba(229, 57, 53, 0.2), 0 0 0 1px rgba(229, 57, 53, 0.5) !important;
  }
  
  .journalit-dashboard-calendar-day.other-month {
    opacity: 0.3 !important;
  }
  
  /* Day number positioning in the top-left */
  .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-number,
  .journalit-dashboard-calendar .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-number,
  .journalit-dashboard-calendar-grid .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-number {
    position: absolute !important;
    top: 4px !important;
    left: 4px !important;
    text-align: left !important;
    font-size: 12px !important;
    font-weight: 500 !important;
  }
  
  /* PNL value centered and larger */
  .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-pnl,
  .journalit-dashboard-calendar .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-pnl,
  .journalit-dashboard-calendar-grid .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-pnl {
    font-size: 12px !important; /* Increased from 10px */
    width: 100% !important;
    position: absolute !important;
    top: 46% !important; /* Moved slightly higher to make room for trade count */
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    margin-top: 0 !important;
    font-weight: 600 !important;
    text-align: center !important;
  }
  
  /* Trade count styling - smaller than PNL value */
  .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-trades,
  .journalit-dashboard-calendar .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-trades,
  .journalit-dashboard-calendar-grid .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-trades {
    font-size: 10px !important;
    width: 100% !important;
    position: absolute !important;
    top: 70% !important; /* Position further down for better separation */
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    margin-top: 0 !important;
    font-weight: 400 !important;
    text-align: center !important;
    color: var(--text-muted) !important;
  }
  
  /* Week number positioning in the top-left */
  .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-week-number,
  .journalit-dashboard-calendar .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-week-number,
  .journalit-dashboard-calendar-grid .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-week-number {
    position: absolute !important;
    top: 4px !important;
    left: 4px !important;
    text-align: left !important;
    font-size: 12px !important;
    font-weight: 500 !important;
    margin-bottom: 0 !important;
  }
  
  /* Weekly PNL value centered and larger */
  .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-weekly-pnl-value,
  .journalit-dashboard-calendar .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-weekly-pnl-value,
  .journalit-dashboard-calendar-grid .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-weekly-pnl-value {
    font-size: 12px !important; /* Increased from 10px */
    width: 100% !important;
    position: absolute !important;
    top: 46% !important; /* Moved slightly higher to make room for trade count */
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    font-weight: 600 !important;
    text-align: center !important;
  }
  
  /* Weekly trade count styling - smaller than PNL value */
  .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-weekly-trades,
  .journalit-dashboard-calendar .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-weekly-trades,
  .journalit-dashboard-calendar-grid .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-weekly-trades {
    font-size: 10px !important;
    width: 100% !important;
    position: absolute !important;
    top: 70% !important; /* Position further down for better separation */
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    font-weight: 400 !important;
    text-align: center !important;
    color: var(--text-muted) !important;
  }
  
  /* Recent Trades widget styles */
  .journalit-dashboard-recent-trades {
    width: 100% !important;
    height: 100% !important;
    overflow: auto !important;
    /* Remove top padding, keep padding on sides and bottom to prevent gap above sticky header */
    padding: 0 8px 8px 8px !important;
    position: relative !important;
  }
  
  .journalit-dashboard-recent-trades-table {
    width: 100% !important;
    border-collapse: collapse !important;
    /* Add padding to the top of the table to replace container's top padding */
    padding-top: 8px !important;
    margin-top: 0 !important;
  }
  
  .journalit-dashboard-recent-trades-table th {
    text-align: left !important;
    padding: 8px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
    font-size: 12px !important;
    font-weight: 600 !important;
    background-color: var(--background-secondary-alt) !important;
    position: sticky !important;
    top: 0 !important;
    z-index: 10 !important; /* Increased z-index to ensure header stays above content */
  }
  
  .journalit-dashboard-recent-trades-table th.pnl-column {
    text-align: right !important;
  }
  
  .journalit-dashboard-recent-trades-table td {
    padding: 8px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
    font-size: 12px !important;
  }
  
  .journalit-dashboard-recent-trades-table .trade-row {
    cursor: pointer !important;
    transition: background-color 0.2s ease !important;
  }
  
  .journalit-dashboard-recent-trades-table .trade-row:hover {
    background-color: var(--interactive-hover) !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
    z-index: 2 !important;
  }
  
  .journalit-dashboard-recent-trades-table .trade-row.even {
    background-color: var(--background-primary) !important;
  }
  
  .journalit-dashboard-recent-trades-table .trade-row.odd {
    background-color: var(--background-secondary) !important;
  }
  
  .journalit-dashboard-recent-trades-table .ticker-cell {
    font-weight: 600 !important;
  }
  
  .journalit-dashboard-recent-trades-table .direction-cell {
    font-weight: 500 !important;
  }
  
  .journalit-dashboard-recent-trades-table .pnl-cell {
    text-align: right !important;
    font-weight: 600 !important;
  }
  
  .journalit-dashboard-recent-trades-table .pnl-cell.positive {
    color: #4caf50 !important;
  }
  
  .journalit-dashboard-recent-trades-table .pnl-cell.negative {
    color: #f44336 !important;
  }
  
  .journalit-dashboard-recent-trades-table .empty-message {
    text-align: center !important;
    padding: 16px !important;
    color: var(--text-muted) !important;
    font-style: italic !important;
  }
  
  /* Today highlight styling with high specificity to prevent overrides */
  .journalit-dashboard-calendar-day.today,
  .journalit-dashboard-calendar .journalit-dashboard-calendar-day.today,
  .journalit-dashboard-calendar-grid .journalit-dashboard-calendar-day.today {
    border: 2px solid var(--interactive-accent) !important;
    box-shadow: 0 0 6px rgba(var(--interactive-accent-rgb), 0.4) !important;
    position: relative !important;
    z-index: 2 !important; /* Higher z-index to ensure the highlight is visible */
    animation: pulseBorder 2s infinite ease-in-out !important;
  }
  
  .journalit-dashboard-calendar-day.neutral {
    background-color: var(--background-secondary) !important;
    color: var(--text-muted) !important;
  }
  
  /* Table styles */
  .journalit-dashboard-trades-table {
    width: 100% !important;
    border-collapse: collapse !important;
  }
  
  .journalit-dashboard-trades-table th,
  .journalit-dashboard-trades-table td {
    padding: 8px 12px !important;
    text-align: left !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
  }
  
  .journalit-dashboard-trades-table th {
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    background-color: var(--background-secondary) !important;
    position: sticky !important;
    top: 0 !important;
    z-index: 1 !important;
  }
  
  .journalit-dashboard-trades-table tr:hover {
    background-color: var(--background-modifier-hover) !important;
  }
  
  /* Layout controls */
  .journalit-dashboard-layout-controls {
    display: flex !important;
    justify-content: flex-end !important;
    gap: 8px !important;
    margin-bottom: 16px !important;
  }
  
  /* Edit mode button in filter actions */
  .journalit-dashboard-edit-mode-button {
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    padding: 5px 10px !important;
    font-size: 12px !important;
    font-weight: 500 !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
    white-space: nowrap !important;
    height: 28px !important;
    line-height: 1 !important;
  }
  
  .journalit-dashboard-edit-mode-button:hover {
    background-color: var(--background-modifier-hover) !important;
    border-color: var(--interactive-accent) !important;
  }
  
  .journalit-dashboard-edit-mode-button.active {
    background-color: var(--interactive-accent) !important;
    color: var(--text-on-accent) !important;
    border-color: var(--interactive-accent) !important;
  }
  
  /* Loading and error states */
  .journalit-dashboard-loading,
  .journalit-dashboard-error {
    display: flex !important;
    justify-content: center !important;
    align-items: center !important;
    padding: 20px !important;
    font-size: 16px !important;
    color: var(--text-muted) !important;
  }
  
  .journalit-dashboard-error {
    color: var(--text-error) !important;
  }
  
  /* Responsive styles - comprehensive approach for all screen sizes */
  /* XL screens - new breakpoint to handle 1560px width */
  @media (max-width: 1560px) {
    /* Adjust filter controls for this specific breakpoint range */
    .journalit-dashboard-filter-row.standard-responsive {
      grid-template-columns: minmax(300px, auto) auto 1fr auto !important;
      gap: 10px !important;
    }
    
    /* Ensure filters section stays in one line */
    .journalit-dashboard-filters-section {
      flex-wrap: nowrap !important;
      max-width: fit-content !important;
      justify-content: flex-start !important;
    }
    
    /* Make sure account and ticker filters have adequate space and stay together */
    .journalit-dashboard-account-filter,
    .journalit-dashboard-ticker-filter {
      min-width: 140px !important;
    }
    
    /* Keep account filter next to ticker filter */
    .journalit-dashboard-accounts-section {
      margin-left: 0 !important;
      padding-left: 0 !important;
    }
    
    /* Ensure the row structure stays intact at this breakpoint */
    .journalit-dashboard-filter-section {
      width: 100% !important;
    }
    
    /* Adjust date range input position */
    .journalit-dashboard-date-range-inputs,
    .journalit-dashboard-custom-date-dropdown {
      right: -250px !important; /* Reduce the offset */
      width: 300px !important; /* Make it slightly smaller */
    }
  }
  
  /* Large screens */
  @media (max-width: 1200px) {
    /* Slightly reduce padding and margins for better fit */
    .journalit-dashboard-view {
      padding: 12px !important;
    }
    
    .journalit-dashboard-metric-card {
      min-width: 180px !important;
    }
  }
  
  /* Medium screens */
  @media (max-width: 996px) {
    /* Further reduce spacing */
    .journalit-dashboard-view {
      padding: 10px !important;
    }
    
    .journalit-dashboard-metric-card {
      min-width: 150px !important;
      padding: 12px !important;
    }
    
    .journalit-dashboard-metric-value {
      font-size: 20px !important;
    }
    
    /* Adjust date dropdown position */
    .journalit-dashboard-date-range-inputs,
    .journalit-dashboard-custom-date-dropdown {
      right: -100px !important;
    }
  }
  
  /* Medium-small screens - additional breakpoint */
  @media (max-width: 900px) {
    /* Ensure the filter controls container has appropriate padding */
    .journalit-dashboard-filter-controls {
      padding: 10px 12px !important;
    }
    
    /* At this size, begin transitioning to more compact layout */
    .journalit-dashboard-filter-row.standard-responsive {
      /* More aggressive column sizing to prevent overflow */
      grid-template-columns: 1fr auto auto !important;
      gap: 8px !important;
    }
    
    /* Further reduce right margin for date section */
    .journalit-dashboard-date-range-section {
      margin-right: 5px !important;
    }
    
    /* Make buttons more compact */
    /* Ensure buttons in compact tablet views align properly */
    .journalit-dashboard-filter-actions.button-container {
      gap: var(--button-gap) !important;
    }
    
    /* Fixed height buttons in mobile view for consistent appearance */
    .journalit-dashboard-filter-controls.compact-view .journalit-dashboard-reset-button,
    .journalit-dashboard-filter-controls.compact-view .journalit-dashboard-edit-mode-button {
      height: 28px !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
    }
    
    .journalit-dashboard-reset-button,
    .journalit-dashboard-edit-mode-button {
      padding: 4px 8px !important;
      font-size: 11px !important;
    }
    
    /* Make account dropdown narrower */
    .journalit-dashboard-account-filter {
      min-width: 120px !important;
    }
  }
  
  /* Small tablet screens */
  @media (max-width: 768px) {
    /* Force compact view if not already applied by component */
    .journalit-dashboard-filter-controls:not(.compact-view) {
      /* Add a class to force compact view directly via CSS if needed */
      /* This is a backup in case the JS detection doesn't trigger properly */
    }
    
    /* Switch to vertical layout for filter controls */
    .journalit-dashboard-filter-row.standard-responsive,
    .journalit-dashboard-filter-row.medium-responsive,
    .journalit-dashboard-filter-row {
      grid-template-columns: 1fr !important;
      gap: 16px !important;
    }
    
    .journalit-dashboard-filter-row.compact,
    .journalit-dashboard-filter-row.medium-responsive {
      display: flex !important;
      flex-direction: column !important;
      width: 100% !important;
    }
    
    .journalit-dashboard-date-range-section,
    .journalit-dashboard-accounts-section,
    .journalit-dashboard-filter-actions,
    .journalit-dashboard-filter-section {
      width: 100% !important;
      margin: 8px 0 !important;
    }
    
    .journalit-dashboard-reset-button,
    .journalit-dashboard-edit-mode-button {
      margin: 5px 0 !important;
      width: 100% !important;
    }
    
    .journalit-dashboard-account-filter {
      width: 100% !important;
    }
    
    /* Force full width on select dropdowns */
    .journalit-dashboard-account-dropdown,
    .journalit-dashboard-account-summary {
      width: 100% !important;
    }
    
    /* Ensure date range selector fits properly */
    .journalit-dashboard-date-range-section {
      margin-right: 0 !important;
      width: 100% !important;
      min-width: auto !important;
    }
    
    /* Handle date inputs on small screens */
    .journalit-dashboard-date-range-inputs,
    .journalit-dashboard-custom-date-dropdown {
      position: static !important;
      width: 100% !important;
      margin-top: 8px !important;
      flex-direction: column !important;
      box-shadow: none !important;
    }
    
    /* Adjust metric cards for better small screen display */
    .journalit-dashboard-metrics {
      flex-wrap: wrap !important;
      justify-content: center !important;
    }
    
    .journalit-dashboard-metric-card {
      min-width: calc(50% - 8px) !important;
      max-width: none !important;
      flex: 0 0 calc(50% - 8px) !important;
      margin-bottom: 8px !important;
    }
  }
  
  /* Mobile screens */
  @media (max-width: 480px) {
    /* Extremely compact layout for very small screens */
    .journalit-dashboard-view {
      padding: 8px !important;
    }
    
    /* Make sure the filter controls are completely vertical */
    .journalit-dashboard-filter-controls.compact-view {
      padding: 8px !important;
    }
    
    /* Full width metrics on mobile */
    .journalit-dashboard-metric-card {
      min-width: 100% !important;
      flex: 0 0 100% !important;
      margin-bottom: 8px !important;
    }
    
    /* Make buttons more touch-friendly */
    .journalit-dashboard-reset-button,
    .journalit-dashboard-edit-mode-button,
    .journalit-dashboard-add-component-button {
      padding: 10px !important;
      height: auto !important;
      min-height: 40px !important;
    }
    
    /* Ensure date presets fit on small screens */
    .journalit-dashboard-date-range-presets {
      flex-wrap: wrap !important;
      justify-content: center !important;
    }
    
    .journalit-dashboard-date-range-presets button {
      flex: 0 1 auto !important;
      margin: 2px !important;
      font-size: 11px !important;
      padding: 4px 8px !important;
    }
    
    /* Ensure the component selector fits on small screens */
    .journalit-dashboard-component-selector {
      width: 90vw !important;
      max-height: 80vh !important;
      margin-top: 50px !important;
    }
  }
  
  /* Extra small screens */
  @media (max-width: 360px) {
    /* Extreme space optimization */
    .journalit-dashboard-view {
      padding: 4px !important;
    }
    
    .journalit-dashboard-filter-controls {
      padding: 6px !important;
    }
    
    /* Minimize all padding and margins */
    .journalit-dashboard-top-section,
    .journalit-dashboard-bottom-section {
      padding: 2px !important;
    }
    
    /* Ensure date buttons are minimal but usable */
    .journalit-dashboard-date-range-presets button {
      padding: 3px 6px !important;
      font-size: 10px !important;
    }
  }
  
  /* Unified Component Selector */
  .unified-selector-overlay {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    background-color: rgba(0, 0, 0, 0.4) !important;
    backdrop-filter: blur(3px) !important;
    z-index: 1000 !important; /* Reduced from 100000 to prevent conflicts */
    display: flex !important;
    align-items: flex-start !important;
    justify-content: center !important;
    padding: 20px !important;
    pointer-events: none !important; /* Prevent blocking interactions */
  }
  
  .journalit-dashboard-component-selector {
    position: relative !important;
    margin-top: 100px !important;
    width: 480px !important;
    max-height: 75vh !important;
    overflow-y: auto !important;
    background-color: var(--background-primary) !important;
    border: 1px solid rgba(255, 255, 255, 0.08) !important;
    border-radius: 12px !important;
    overflow: hidden !important;
    z-index: 1001 !important; /* One higher than the overlay */
    pointer-events: auto !important; /* Ensure modal content is interactive */
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2), 0 16px 64px rgba(0, 0, 0, 0.1) !important;
    max-width: 90vw !important;
    animation: fadeInScale 0.25s cubic-bezier(0.19, 1, 0.22, 1) !important;
  }
  
  .journalit-dashboard-unified-selector-button-container {
    display: flex !important;
    justify-content: center !important;
    margin: 0 0 4px 0 !important; /* Reduced from 8px to 4px */
    padding: 4px !important; /* Reduced from 8px to 4px */
    background-color: transparent !important;
    border-radius: 8px !important;
    border: 1px dashed var(--background-modifier-border) !important;
  }
  
  .journalit-dashboard-add-component-button {
    background-color: var(--interactive-accent) !important;
    color: var(--text-on-accent) !important;
    border: none !important;
    border-radius: 6px !important;
    padding: 8px 16px !important;
    font-size: 14px !important;
    font-weight: 600 !important;
    cursor: pointer !important;
    display: flex !important;
    align-items: center !important;
    gap: 8px !important;
    transition: all 0.2s ease !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
  }
  
  .journalit-dashboard-add-component-button:hover {
    background-color: var(--interactive-accent-hover) !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
  }
  
  .journalit-dashboard-component-selector-header {
    display: flex !important;
    justify-content: space-between !important;
    align-items: center !important;
    padding: 16px 20px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
    background-color: var(--background-secondary-alt) !important;
    border-radius: 12px 12px 0 0 !important;
  }
  
  .journalit-dashboard-component-selector-header h3 {
    font-size: 18px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    margin: 0 !important;
  }
  
  .journalit-dashboard-component-selector-close {
    width: 28px !important;
    height: 28px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    border-radius: 6px !important;
    background-color: var(--background-modifier-hover) !important;
    color: var(--text-muted) !important;
    transition: all 0.2s cubic-bezier(0.19, 1, 0.22, 1) !important;
    border: none !important;
    padding: 0 !important;
    cursor: pointer !important;
  }
  
  .journalit-dashboard-component-selector-close svg {
    width: 14px !important;
    height: 14px !important;
    display: block !important;
  }
  
  .journalit-dashboard-component-selector-close:hover {
    background-color: var(--background-modifier-error-hover) !important;
    color: white !important;
    transform: rotate(90deg) !important;
  }
  
  .journalit-dashboard-component-selector-search {
    padding: 12px 20px !important;
    position: relative !important;
  }
  
  .journalit-dashboard-component-selector-search input {
    width: 100% !important;
    padding: 10px 16px !important;
    border-radius: 8px !important;
    background-color: var(--background-modifier-form-field) !important;
    border: 1px solid var(--background-modifier-border) !important;
    font-size: 14px !important;
    transition: all 0.2s ease !important;
    color: var(--text-normal) !important;
  }
  
  .journalit-dashboard-component-selector-search input:focus {
    box-shadow: 0 0 0 2px var(--interactive-accent) !important;
    border-color: var(--interactive-accent) !important;
    outline: none !important;
  }
  
  .journalit-dashboard-component-selector-categories {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 8px !important;
    padding: 0 20px 12px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
    justify-content: center !important; /* Center tabs horizontally */
  }
  
  .journalit-dashboard-component-selector-category {
    border-radius: 20px !important;
    padding: 6px 14px !important;
    font-size: 13px !important;
    font-weight: 500 !important;
    background-color: var(--background-secondary) !important;
    color: var(--text-muted) !important;
    border: 1px solid transparent !important;
    transition: all 0.2s cubic-bezier(0.19, 1, 0.22, 1) !important;
    box-shadow: none !important;
    cursor: pointer !important;
  }
  
  .journalit-dashboard-component-selector-category:hover {
    background-color: var(--background-modifier-hover) !important;
    color: var(--text-normal) !important;
    transform: translateY(-1px) !important;
  }
  
  .journalit-dashboard-component-selector-category.active {
    background-color: var(--interactive-accent) !important;
    color: var(--text-on-accent) !important;
    font-weight: 600 !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 2px 8px rgba(var(--interactive-accent-rgb), 0.3) !important;
  }
  
  .journalit-dashboard-component-selector-list {
    padding: 16px 20px !important;
    max-height: 50vh !important;
    overflow-y: auto !important;
    scrollbar-width: thin !important;
  }
  
  .journalit-dashboard-component-selector-list h4 {
    font-size: 15px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    margin: 0 0 12px 0 !important;
    padding-bottom: 8px !important;
    border-bottom: 1px solid var(--background-modifier-border) !important;
  }
  
  /* Enhanced component item cards */
  .journalit-dashboard-component-selector-item {
    background-color: var(--background-secondary) !important;
    border-radius: 10px !important;
    padding: 14px 16px !important;
    margin-bottom: 10px !important;
    cursor: pointer !important;
    position: relative !important;
    transition: all 0.25s cubic-bezier(0.19, 1, 0.22, 1) !important;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05) !important;
    border: 1px solid transparent !important;
  }
  
  .journalit-dashboard-component-selector-item:hover {
    transform: translateY(-2px) !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1) !important;
    background-color: var(--background-primary) !important;
    border-color: var(--interactive-accent) !important;
  }
  
  /* Component item content styling */
  .journalit-dashboard-component-selector-widget-name {
    font-size: 15px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    margin-bottom: 6px !important;
  }
  
  /* Visual divider to separate sections in the All tab */
  .journalit-dashboard-component-selector-divider {
    height: 1px !important;
    background-color: var(--background-modifier-border) !important;
    margin: 16px 0 20px !important;
    opacity: 0.7 !important;
  }
  
  .journalit-dashboard-component-selector-widget-description {
    font-size: 13px !important;
    color: var(--text-muted) !important;
    margin-bottom: 10px !important;
    line-height: 1.4 !important;
  }
  
  /* Enhanced category badge */
  .journalit-dashboard-component-selector-widget-category {
    display: inline-block !important;
    font-size: 11px !important;
    font-weight: 500 !important;
    color: var(--text-normal) !important;
    background-color: var(--background-secondary-alt) !important;
    padding: 3px 8px !important;
    border-radius: 12px !important;
    margin-top: 4px !important;
  }
  
  /* Enhanced status badge */
  .journalit-dashboard-component-selector-widget-badge {
    position: absolute !important;
    top: 12px !important;
    right: 12px !important;
    font-size: 11px !important;
    font-weight: 600 !important;
    color: white !important;
    background: linear-gradient(135deg, var(--text-success), #2e7d32) !important;
    padding: 3px 10px !important;
    border-radius: 12px !important;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1) !important;
  }
  
  /* Empty list message */
  .journalit-dashboard-component-selector-empty {
    text-align: center !important;
    padding: 24px 0 !important;
    color: var(--text-muted) !important;
    font-style: italic !important;
    background-color: var(--background-secondary-alt) !important;
    border-radius: 8px !important;
    font-size: 14px !important;
  }
  
  /* Improved scrollbar for the component list */
  .journalit-dashboard-component-selector-list::-webkit-scrollbar {
    width: 8px !important;
  }
  
  .journalit-dashboard-component-selector-list::-webkit-scrollbar-track {
    background: transparent !important;
  }
  
  .journalit-dashboard-component-selector-list::-webkit-scrollbar-thumb {
    background-color: var(--background-modifier-border) !important;
    border-radius: 4px !important;
    border: 2px solid var(--background-primary) !important;
  }
  
  .journalit-dashboard-component-selector-list::-webkit-scrollbar-thumb:hover {
    background-color: var(--interactive-accent) !important;
  }
  
  /* Animation for the selector */
  @keyframes fadeInScale {
    from {
      opacity: 0;
      transform: scale(0.92);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }
  
  /* Animation for today's calendar cell */
  @keyframes pulseBorder {
    0% {
      box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2), 0 4px 12px rgba(var(--interactive-accent-rgb), 0.25);
    }
    50% {
      box-shadow: 0 0 0 4px rgba(var(--interactive-accent-rgb), 0.15), 0 4px 16px rgba(var(--interactive-accent-rgb), 0.3);
    }
    100% {
      box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2), 0 4px 12px rgba(var(--interactive-accent-rgb), 0.25);
    }
  }
  
  /* BaseWidget container styling */
  .journalit-dashboard-widget-container {
    background-color: transparent !important;
  }
  
  /* EmptyState integration with dashboard widgets */
  .journalit-dashboard-widget-container .journalit-empty-state {
    background-color: transparent !important;
    min-height: 140px !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    justify-content: center !important;
    width: 100% !important;
    height: 100% !important;
    margin: 0 auto !important;
    position: absolute !important; /* Position in the center of container */
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
  }
  
  .journalit-dashboard-widget-container .journalit-empty-state-icon {
    margin-bottom: 12px !important;
    color: var(--text-muted) !important;
    display: flex !important;
    justify-content: center !important;
    width: 100% !important;
  }
  
  .journalit-dashboard-widget-container .journalit-empty-state-message {
    font-size: 14px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    text-align: center !important;
    width: 100% !important;
  }
  
  .journalit-dashboard-widget-container .journalit-empty-state-submessage {
    font-size: 12px !important;
    color: var(--text-muted) !important;
    text-align: center !important;
    width: 100% !important;
  }
  
  /* Empty state in main dashboard view */
  .journalit-dashboard-view .journalit-empty-state {
    margin: 0 auto !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    justify-content: center !important;
    min-height: 200px !important;
    width: 100% !important;
  }
  
  /* Table cell EmptyState styling */
  .journalit-dashboard-recent-trades-table td .journalit-empty-state {
    padding: 16px !important;
    min-height: 100px !important;
    background-color: transparent !important;
  }
`;function yp(){let e=document.head.querySelector("#dashboard-styles"),t=document.createElement("style");t.id="dashboard-styles",t.textContent=wK,e?(document.head.insertBefore(t,e),setTimeout(()=>e.remove(),0)):document.head.appendChild(t),xK()}function K2(){let e=document.head.querySelector("#dashboard-styles");if(e){let r=document.createElement("style");r.id="dashboard-styles-backup",r.textContent=e.textContent,document.head.appendChild(r),e.remove(),setTimeout(()=>{let n=document.head.querySelector("#dashboard-styles-backup");n&&n.remove()},50)}let t=document.head.querySelector("#dashboard-transparency-styles");t&&t.remove()}function qC(){var e,t,r,n,i,o;yp();try{let a=(r=(t=(e=window.app)==null?void 0:e.plugins)==null?void 0:t.plugins)==null?void 0:r.journalit;if(a){let s=(o=(i=(n=a.settings)==null?void 0:n.uiCustomization)==null?void 0:i.transparentBackgrounds)!=null?o:!0;document.body.setAttribute("data-transparent-bg",String(s))}}catch(a){console.error("Error accessing plugin settings for transparency:",a),document.body.setAttribute("data-transparent-bg","true")}setTimeout(()=>yp(),50)}function bp(){var e,t,r,n,i,o;try{yp();try{let l=(r=(t=(e=window.app)==null?void 0:e.plugins)==null?void 0:t.plugins)==null?void 0:r.journalit;if(l){let c=(o=(i=(n=l.settings)==null?void 0:n.uiCustomization)==null?void 0:i.transparentBackgrounds)!=null?o:!0;document.body.setAttribute("data-transparent-bg",String(c))}}catch(l){console.error("Error accessing plugin settings for transparency:",l)}if(!document.head.querySelector("#filter-layout-fix-styles")){let l=document.createElement("style");l.id="filter-layout-fix-styles",l.textContent=`
        /* Force filters section to stay compact and left-aligned */
        .journalit-dashboard-filters-section {
          display: flex !important;
          flex-direction: row !important;
          gap: 20px !important; /* Increased from 10px to 20px for more spacing */
          justify-content: flex-start !important;
          max-width: fit-content !important;
          flex-wrap: nowrap !important;
          margin-right: 0 !important; /* Changed from auto to prevent pushing buttons off alignment */
          align-items: center !important;
        }
        
        /* Ensure account filter has proper spacing from ticker filter */
        .journalit-dashboard-accounts-section {
          margin-left: 20px !important;
          padding-left: 0 !important;
          flex: 0 0 auto !important;
          order: 2 !important;
        }
        
        /* Keep ticker filter on the left */
        .journalit-dashboard-tickers-section {
          flex: 0 0 auto !important;
          order: 1 !important;
        }
        
        /* Add spacing div to take remaining space */
        .journalit-dashboard-filters-spacer {
          flex: 1 1 auto !important;
          order: 3 !important;
        }
        
        /* Reset any existing flexbox layout for the filter row */
        .journalit-dashboard-filter-row {
          display: grid !important;
          grid-template-columns: auto 1fr auto !important;
          gap: 20px !important;
        }
        
        /* Force the action buttons to the right */
        .journalit-dashboard-filter-actions {
          justify-self: end !important;
          margin-left: auto !important;
        }
        
        /* Handle compact view filter styling */
        .journalit-dashboard-compact-filters {
          display: flex !important;
          flex-direction: row !important;
          gap: 10px !important;
          justify-content: flex-start !important;
          flex-wrap: nowrap !important;
          align-items: center !important;
        }
        
        /* Make sure compact view also has correct section styling with proper spacing */
        .journalit-dashboard-compact-filters .journalit-dashboard-tickers-section {
          margin: 0 !important;
          padding: 0 !important;
        }
        .journalit-dashboard-compact-filters .journalit-dashboard-accounts-section {
          margin: 0 0 0 20px !important;
          padding: 0 !important;
        }
        
        /* Force very high specificity for filter layout fixes */
        body .journalit-dashboard-view .journalit-dashboard-filter-controls .journalit-dashboard-filter-row .journalit-dashboard-filters-section {
        display: flex !important;
        flex-direction: row !important;
        gap: 20px !important;
        justify-content: flex-start !important;
        max-width: fit-content !important;
        flex-wrap: nowrap !important;
        margin-right: auto !important;
        }
          
          /* Ultra-high specificity rule to ensure account filter spacing */
          body .journalit-dashboard-view .journalit-dashboard-filter-controls .journalit-dashboard-filter-row .journalit-dashboard-filters-section .journalit-dashboard-accounts-section,
          html body .journalit-dashboard-view .journalit-dashboard-filter-controls .journalit-dashboard-compact-filters .journalit-dashboard-accounts-section {
            margin-left: 20px !important;
          }
          
          /* Ultra-high specificity rule to ensure buttons are properly aligned to the right */
          body .journalit-dashboard-view .journalit-dashboard-filter-controls .journalit-dashboard-filter-row .journalit-dashboard-filter-actions,
          html body .journalit-dashboard-view .journalit-dashboard-filter-controls .journalit-dashboard-filter-row.standard-responsive .journalit-dashboard-filter-actions,
          html body .journalit-dashboard-view .journalit-dashboard-filter-controls .journalit-dashboard-filter-row.compact .journalit-dashboard-filter-actions.button-container {
            justify-self: end !important;
            margin-left: auto !important;
          }
      `,document.head.appendChild(l)}[0,100,300,600,1200].forEach(l=>{setTimeout(()=>{let c=new CustomEvent("dashboard-styles-updated");if(document.dispatchEvent(c),!document.head.querySelector("#unified-component-selector-styles")){let u=document.createElement("style");u.id="unified-component-selector-styles",u.textContent=`
            .unified-selector-overlay {
              backdrop-filter: blur(3px) !important;
              z-index: 100000 !important;
              align-items: flex-start !important;
            }
            .journalit-dashboard-component-selector {
              animation: fadeInScale 0.25s cubic-bezier(0.19, 1, 0.22, 1) !important;
              box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2), 0 16px 64px rgba(0, 0, 0, 0.1) !important;
              border-radius: 12px !important;
              overflow: hidden !important;
              z-index: 100001 !important;
              margin-top: 100px !important;
            }
            /* Force specific spacing values */
            .journalit-dashboard-filter-controls {
              margin-bottom: 2px !important; /* Reduced from 10px */
            }
            .journalit-dashboard-unified-selector-button-container {
              margin-bottom: 4px !important;
              padding: 4px !important;
            }
            /* Set unified container gap to match screenshot */
            .journalit-dashboard-unified-container {
              background-color: transparent !important;
              box-shadow: none !important;
              gap: 2px !important; /* Reduced from 10px */
            }
            /* Make sure top and bottom sections have no visual separation and equal padding */
            .journalit-dashboard-top-section, 
            .journalit-dashboard-bottom-section {
              background-color: transparent !important;
              border-radius: 0 !important;
              box-shadow: none !important;
              padding: 0 !important;
            }
            /* Remove blur effects and apply transparent backgrounds to all dashboard elements */
            .journalit-dashboard-metric-card,
            .journalit-dashboard-metric-wrapper,
            .journalit-dashboard-widget,
            .react-grid-item,
            .journalit-dashboard-calendar, 
            .journalit-dashboard-calendar-grid,
            .journalit-dashboard-calendar-week,
            .journalit-dashboard-calendar-day,
            .journalit-dashboard-calendar-weekly-pnl,
            .journalit-dashboard-widget-content,
            .journalit-dashboard-widget-container,
            .journalit-chart-container,
            .recharts-wrapper,
            .recharts-surface {
              backdrop-filter: none !important;
              -webkit-backdrop-filter: none !important;
              background-color: transparent !important;
            }
            /* Category tabs - ensure they're centered */
            .journalit-dashboard-component-selector-categories {
              justify-content: center !important;
            }
            /* SVG close button styling for perfect centering */
            .journalit-dashboard-component-selector-close svg {
              width: 14px !important;
              height: 14px !important;
              display: block !important;
            }
            /* Ensure today highlighting is always applied */
            .journalit-dashboard-calendar-day.today {
              border: 2px solid var(--interactive-accent) !important;
              box-shadow: 0 0 6px rgba(var(--interactive-accent-rgb), 0.4) !important;
              position: relative !important;
              z-index: 2 !important;
            }
            /* Ensure the remove buttons don't pierce through the overlay */
            .journalit-dashboard-widget-remove,
            .journalit-dashboard-metric-wrapper .journalit-dashboard-widget-remove,
            .journalit-dashboard-widget .journalit-dashboard-widget-remove {
              z-index: 10000 !important; /* Lower than the overlay */
            }
            
            /* Ensure text in calendar cells can adjust responsively */
            .journalit-dashboard-calendar-day-number,
            .journalit-dashboard-calendar-day-pnl,
            .journalit-dashboard-calendar-week-number,
            .journalit-dashboard-calendar-weekly-pnl-value {
              transition: font-size 0.1s ease-out !important;
              /* Remove default !important font-size rules to allow dynamic sizing */
              font-size: unset !important;
            }
            
            /* Trade count text styling - keep smaller than PNL */
            .journalit-dashboard-calendar-day-trades,
            .journalit-dashboard-calendar-weekly-trades {
              transition: font-size 0.1s ease-out !important;
              font-size: 10px !important; /* Set default smaller size */
              color: var(--text-muted) !important;
              top: 70% !important; /* Position lower */
            }
            
            /* Special protection for specific elements that might get overridden */
            .journalit-dashboard-calendar .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-number,
            .journalit-dashboard-calendar .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-week-number,
            .journalit-dashboard-calendar .journalit-dashboard-calendar-day .journalit-dashboard-calendar-day-pnl,
            .journalit-dashboard-calendar .journalit-dashboard-calendar-weekly-pnl .journalit-dashboard-calendar-weekly-pnl-value {
              /* Further reset any default size rules to allow dynamically applied sizes */
              font-size: unset !important;
            }
          `,document.head.appendChild(u)}},l)});let s=(l,c)=>{setTimeout(()=>{try{Kg(),la(),c>0&&s(Math.min(l*1.5,1e3),c-1)}catch(d){console.error(`Error setting up calendar resize observer (attempt ${5-c}):`,d),c>0&&s(Math.min(l*1.5,1e3),c-1)}},l)};s(100,5),[100,300,500,800,1200].forEach(l=>{setTimeout(()=>{try{if(document.querySelectorAll(".journalit-dashboard-calendar").length>0){HC();let d=new CustomEvent("dashboard-styles-updated");document.dispatchEvent(d)}}catch(c){console.error(`Error in calendar-specific fixes at ${l}ms:`,c)}},l)})}catch(a){console.error("Error forcing dashboard styles:",a),yp()}}function xK(){let e=document.head.querySelector("#dashboard-transparency-styles");e&&e.remove();let t=document.createElement("style");t.id="dashboard-transparency-styles";let r=document.body.getAttribute("data-transparent-bg")!=="false";t.textContent=r?`
    /* Transparent mode - keep or force transparent backgrounds */
    .journalit-dashboard-widget,
    .journalit-dashboard-widget-container,
    .journalit-dashboard-metric-card,
    .journalit-chart-container,
    .react-grid-item,
    .journalit-dashboard-calendar-day,
    .journalit-dashboard-calendar-weekly-pnl,
    .recharts-wrapper {
      background-color: transparent !important;
      backdrop-filter: none !important;
    }
    
    /* Filter Controls transparent styling */
    .journalit-dashboard-filter-controls {
      background-color: transparent !important;
      border: 1px solid rgba(var(--background-modifier-border-rgb, 0, 0, 0), 0.08) !important;
      box-shadow: none !important;
    }
    
    /* Make most filter buttons transparent in transparent mode, but keep dropdowns with solid backgrounds */
    .journalit-dashboard-date-range-presets button,
    .journalit-dashboard-reset-button,
    .journalit-dashboard-edit-mode-button {
      background-color: transparent !important;
      border: 1px solid rgba(var(--background-modifier-border-rgb, 0, 0, 0), 0.15) !important;
    }
    
    /* Keep dropdown summaries with dark backgrounds to match buttons */
    .journalit-dashboard-account-summary,
    .journalit-dashboard-ticker-summary {
      background-color: var(--interactive-accent) !important;
      border: 1px solid var(--interactive-accent) !important;
      color: var(--text-on-accent) !important;
    }
    
    /* Style dropdown arrows to be visible on dark backgrounds */
    .journalit-dashboard-account-summary .dropdown-arrow,
    .journalit-dashboard-ticker-summary .dropdown-arrow {
      color: var(--text-on-accent) !important;
      opacity: 0.9 !important;
    }
    
    /* Ensure hover states are distinct and visible */
    .journalit-dashboard-account-summary:hover,
    .journalit-dashboard-ticker-summary:hover {
      background-color: var(--interactive-accent-hover, var(--interactive-accent)) !important;
      filter: brightness(1.1) !important;
      border-color: var(--interactive-accent) !important;
    }
    
    /* Maintain dropdown background colors for legibility */
    .journalit-dashboard-date-range-inputs,
    .journalit-dashboard-account-options-dropdown,
    .journalit-dashboard-ticker-options-dropdown {
      background-color: var(--background-primary) !important;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08) !important;
    }
    
    /* Selected items in dropdowns should be highlighted properly */
    .journalit-dashboard-account-option-item input[type="checkbox"]:checked + span,
    .journalit-dashboard-ticker-option-item input[type="checkbox"]:checked + span {
      color: var(--interactive-accent) !important;
      font-weight: 600 !important;
    }
    `:`
    /* Filled mode - apply background colors */
    /* Keep widget headers transparent as in the screenshot */
    .journalit-dashboard-widget-header,
    .journalit-dashboard-widget-minimal-header {
      background-color: transparent !important;
      border-bottom: 1px solid rgba(var(--background-modifier-border-rgb), 0.3) !important;
    }
    
    /* All components should have the same dark background color as the dashboard */
    .journalit-dashboard-widget,
    .react-grid-item,
    .journalit-dashboard-metric-card,
    .journalit-chart-container,
    .journalit-dashboard-widget-container,
    .journalit-dashboard-calendar-day,
    .journalit-dashboard-calendar-weekly-pnl {
      background-color: var(--background-primary) !important;
    }
    
    /* Filter Controls filled styling */
    .journalit-dashboard-filter-controls {
      background-color: var(--background-primary) !important;
      border: 1px solid rgba(var(--background-modifier-border-rgb, 0, 0, 0), 0.15) !important;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15) !important;
    }
    
    /* Style for most filter buttons in filled mode */
    .journalit-dashboard-date-range-presets button,
    .journalit-dashboard-reset-button,
    .journalit-dashboard-edit-mode-button {
      background-color: var(--background-primary) !important;
      border: 1px solid var(--background-modifier-border) !important;
    }
    
    /* Keep dropdown summaries with dark backgrounds to match buttons */
    .journalit-dashboard-account-summary,
    .journalit-dashboard-ticker-summary {
      background-color: var(--interactive-accent) !important;
      border: 1px solid var(--interactive-accent) !important;
      color: var(--text-on-accent) !important;
    }
    
    /* Style dropdown arrows to be visible on dark backgrounds */
    .journalit-dashboard-account-summary .dropdown-arrow,
    .journalit-dashboard-ticker-summary .dropdown-arrow {
      color: var(--text-on-accent) !important;
      opacity: 0.9 !important;
    }
    
    /* Ensure hover states are distinct and visible */
    .journalit-dashboard-account-summary:hover,
    .journalit-dashboard-ticker-summary:hover {
      background-color: var(--interactive-accent-hover, var(--interactive-accent)) !important;
      filter: brightness(1.1) !important;
      border-color: var(--interactive-accent) !important;
    }
    
    /* Ensure dropdowns match the filled style */
    .journalit-dashboard-date-range-inputs,
    .journalit-dashboard-account-options-dropdown,
    .journalit-dashboard-ticker-options-dropdown {
      background-color: var(--background-primary) !important;
      border: 1px solid var(--background-modifier-border) !important;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1) !important;
    }
    
    /* Selected items in dropdowns should be highlighted properly */
    .journalit-dashboard-account-option-item input[type="checkbox"]:checked + span,
    .journalit-dashboard-ticker-option-item input[type="checkbox"]:checked + span {
      color: var(--interactive-accent) !important;
      font-weight: 600 !important;
    }
    
    /* Override positive/negative backgrounds to be more prominent against dark backgrounds */
    .journalit-dashboard-calendar-day.positive,
    .journalit-dashboard-calendar-weekly-pnl.positive {
      background-color: rgba(67, 160, 71, 0.35) !important;
    }
    
    .journalit-dashboard-calendar-day.negative,
    .journalit-dashboard-calendar-weekly-pnl.negative {
      background-color: rgba(229, 57, 53, 0.35) !important;
    }
    `,document.head.appendChild(t)}var kK=`
  /* DRC note view container - match Weekly Review pattern */
  .journalit-drc-view,
  .markdown-preview-view .journalit-drc-view {
    margin: 0 !important; /* Remove all margins */
    border-bottom: none !important; /* Remove bottom border causing extra space */
    padding: 0 !important; /* Remove all padding */
    display: block !important;
    width: 100% !important;
    z-index: 100 !important;
    /* Force visibility */
    visibility: visible !important;
    opacity: 1 !important;
    background-color: var(--background-primary) !important;
    /* Removed borders */
    border: none !important;
    border-radius: 8px !important;
    /* Ensure proper containment */
    position: relative;
    box-sizing: border-box;
    /* Prevent overlaps */
    contain: content;
    /* Ensure proper isolation from other views */
    isolation: isolate;
  }
  
  /* Add a fallback CSS pattern to highlight DRC notes */
  .markdown-preview-view > div:first-child:has(+ div:contains("type: drc")) {
    position: relative;
  }
  .markdown-preview-view > div:first-child:has(+ div:contains("type: drc"))::before {
    content: '';
    display: block;
    height: 5px;
    width: 100%;
    background-color: var(--color-secondary, var(--text-accent, var(--interactive-accent)));
    margin-bottom: 1rem;
    border-radius: 2px;
  }
  
  /* Main container - transparent to match Weekly Review */
  .drc-note-container {
    background-color: transparent; /* Remove background to match Weekly Review */
    border-radius: 0; /* Remove border radius to match Weekly Review */
    box-shadow: none; /* Remove shadow to match Weekly Review */
    margin: 0; /* Remove margin to match Weekly Review */
    overflow: hidden;
    position: relative;
    font-family: var(--font-interface, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif);
    /* Remove border to match Weekly Review */
    border: none;
    /* Ensure isolation */
    isolation: isolate;
    /* Create a new stacking context and force containment */
    contain: layout style paint;
    /* Ensure direct containment within parent */
    width: 100%;
    align-self: flex-start;
  }
  
  /* Header section with date and summary */
  .drc-note-header {
    padding: 1rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    background: linear-gradient(to right, var(--background-secondary), var(--background-primary));
    border-bottom: 1px solid var(--background-modifier-border);
  }
  
  .drc-note-date {
    font-size: 1.4rem;
    font-weight: 600;
    color: var(--text-normal);
  }
  
  .drc-note-summary {
    font-size: 1rem;
    color: var(--text-muted);
  }
  
  /* Tabs navigation */
  .drc-note-tabs {
    display: flex;
    padding: 0 1rem;
    border-bottom: 1px solid var(--background-modifier-border);
    background-color: var(--background-secondary);
  }
  
  .drc-note-tab-button {
    padding: 0.8rem 1.2rem;
    border: none;
    background: transparent;
    color: var(--text-muted);
    font-size: 0.9rem;
    font-weight: 600;
    cursor: pointer;
    position: relative;
    transition: color 0.2s;
  }
  
  .drc-note-tab-button:hover {
    color: var(--text-normal);
  }
  
  .drc-note-tab-button.active {
    color: var(--color-primary, var(--interactive-accent));
  }
  
  .drc-note-tab-button.active::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 2px;
    background-color: var(--color-primary, var(--interactive-accent));
    border-radius: 2px 2px 0 0;
  }
  
  /* Tab content container */
  .drc-note-content {
    padding: 1.5rem;
  }
  
  /* Section styling */
  .drc-note-section {
    margin-bottom: 2rem;
    background-color: var(--background-secondary);
    border-radius: var(--border-radius-md, 4px);
    padding: 1.2rem;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
  }
  
  .drc-note-section-title {
    font-size: 1.1rem;
    font-weight: 600;
    margin-top: 0;
    margin-bottom: 1rem;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--background-modifier-border);
    color: var(--text-normal);
    text-align: center;
  }
  
  .drc-note-empty-state {
    color: var(--text-muted);
    font-style: italic;
    text-align: center;
    padding: 1rem;
  }
  
  /* Checklist styling */
  .drc-note-checklist {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }
  
  .drc-note-checklist-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  
  .drc-note-checkbox {
    width: 18px;
    height: 18px;
    border: 2px solid var(--background-modifier-border);
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--color-success, #43a047);
    font-weight: bold;
    background-color: var(--background-primary);
  }
  
  .drc-note-checkbox.checked {
    background-color: var(--color-success-muted, rgba(67, 160, 71, 0.2));
    border-color: var(--color-success, #43a047);
  }
  
  /* Forecast styling */
  .drc-note-forecast {
    display: flex;
    flex-direction: column;
    gap: 0.8rem;
  }
  
  .drc-note-forecast-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }
  
  .drc-note-forecast-label {
    font-weight: 600;
    min-width: 80px;
    color: var(--text-muted);
  }
  
  .drc-note-forecast-value {
    color: var(--text-normal);
  }
  
  .drc-note-forecast-notes {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }
  
  .drc-note-forecast-notes p {
    margin: 0.5rem 0 0 0;
    padding-left: 80px;
    color: var(--text-normal);
  }
  
  /* Goals styling */
  .drc-note-goals ul {
    margin: 0;
    padding-left: 1.5rem;
  }
  
  .drc-note-goals li {
    margin-bottom: 0.5rem;
    color: var(--text-normal);
  }
  
  /* Trades styling */
  .drc-note-trades {
    width: 100%;
    border-radius: var(--border-radius-sm, 2px);
    overflow: hidden;
  }
  
  .drc-note-trades-header {
    display: grid;
    grid-template-columns: 2fr 1fr 1fr 2fr 1fr;
    background-color: var(--background-modifier-hover);
    font-weight: 600;
    color: var(--text-normal);
    font-size: 0.9rem;
  }
  
  .drc-note-trade-row {
    display: grid;
    transition: background-color 0.2s;
  }
  
  .drc-note-trade-row:hover {
    background-color: var(--background-primary-alt, var(--background-primary));
  }
  
  .drc-note-trade-cell {
    padding: 0.8rem;
    align-items: center;
  }
  
  .drc-note-trade-cell.profit {
    color: var(--color-success, #43a047);
  }
  
  .drc-note-trade-cell.loss {
    color: var(--color-error, #e53935);
  }
  
  .drc-note-trade-rating {
    padding: 0.3rem 0.5rem;
    font-weight: 600;
  }
  
  .drc-note-trade-rating.rating-a {
    background-color: rgba(102, 187, 106, 0.2);
    color: var(--color-success, #43a047);
  }
  
  .drc-note-trade-rating.rating-b {
    background-color: rgba(33, 150, 243, 0.2);
    color: var(--color-primary, #2196f3);
  }
  
  .drc-note-trade-rating.rating-c {
    background-color: rgba(247, 199, 90, 0.2);
    color: #e6a700;
  }
  
  .drc-note-trade-rating.rating-d, 
  .drc-note-trade-rating.rating-f {
    background-color: rgba(229, 57, 53, 0.2);
    color: var(--color-error, #e53935);
  }
  
  .drc-note-trade-rating.rating-none {
    background-color: var(--background-secondary-alt, var(--background-secondary));
    color: var(--text-muted);
  }
  
  /* Missed trades styling */
  .drc-note-missed-trades {
    display: flex;
    gap: 1rem;
  }
  
  .drc-note-missed-trade {
    padding: 0.8rem;
    background-color: var(--background-primary);
  }
  
  .drc-note-missed-trade-header {
    display: flex;
    border-bottom: 1px dashed var(--background-modifier-border);
  }
  
  .drc-note-missed-trade-instrument {
    font-weight: 600;
    color: var(--text-normal);
  }
  
  .drc-note-missed-trade-direction {
    color: var(--text-muted);
  }
  
  .drc-note-missed-trade-reason,
  .drc-note-missed-trade-notes {
    font-size: 0.9rem;
    margin-bottom: 0.3rem;
  }
  
  /* Review styling */
  .drc-note-grades {
    display: flex;
    margin-bottom: 1rem;
  }
  
  .drc-note-grade {
    display: flex;
    width: 120px;
  }
  
  .drc-note-grade-label {
    font-size: 0.8rem;
    margin-bottom: 0.5rem;
  }
  
  .drc-note-grade-value {
    font-size: 2rem;
    border-radius: 50%;
  }
  
  .drc-note-grade-value.grade-a {
    background-color: rgba(102, 187, 106, 0.2);
    color: var(--color-success, #43a047);
  }
  
  .drc-note-grade-value.grade-b {
    background-color: rgba(33, 150, 243, 0.2);
    color: var(--color-primary, #2196f3);
  }
  
  .drc-note-grade-value.grade-c {
    background-color: rgba(247, 199, 90, 0.2);
    color: #e6a700;
  }
  
  .drc-note-grade-value.grade-d,
  .drc-note-grade-value.grade-f {
    background-color: rgba(229, 57, 53, 0.2);
    color: var(--color-error, #e53935);
  }
  
  /* Review questions styling */
  .drc-note-review-questions {
    display: flex;
    flex-direction: column;
    gap: 1.2rem;
  }
  
  .drc-note-review-item {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }
  
  .drc-note-review-question {
    font-weight: 600;
    color: var(--text-normal);
  }
  
  .drc-note-review-answer {
    color: var(--text-normal);
    padding: 0.5rem 0 0.5rem 1rem;
  }
  
  .drc-note-review-answer em {
    color: var(--text-muted);
  }
  
  /* Responsive adjustments */
  @media (max-width: 768px) {
    .drc-note-trades-header,
    .drc-note-trade-row {
      grid-template-columns: 1fr 1fr 1fr;
    }
    
    .drc-note-trades-header > div:nth-child(4),
    .drc-note-trades-header > div:nth-child(5),
    .drc-note-trade-row > div:nth-child(4),
    .drc-note-trade-row > div:nth-child(5) {
      display: none;
    }
    
    .drc-note-missed-trades {
      flex-direction: column;
    }
  }
  
  /* Multiple view compatibility */
  .workspace-split.mod-vertical .journalit-drc-view {
    /* Adjust for vertical split layout */
    flex-shrink: 1;
  }
  
  /* Ensure the component doesn't get squished in narrow panes */
  .workspace-leaf-content .journalit-drc-view .drc-note-tabs {
    flex-wrap: wrap;
  }
  
  /* Prevent clipping of component in small panes */
  .workspace-leaf-content .journalit-drc-view .drc-note-container {
    min-width: 0;
  }
  
  /* Wrapper for the DRC note component */
  .journalit-drc-note-wrapper {
    margin: 0 !important;
    padding: 0 !important;
    border: none !important;
    z-index: 100 !important;
    display: block !important;
    width: 100% !important;
    height: auto !important;
    min-height: 50px !important;
  }
  
  /* Special class for properly mounted DRC components to aid detection */
  .drc-note-mounted {
    display: block !important;
    opacity: 1 !important;
    visibility: visible !important;
  }
`;function SK(){let e=document.head.querySelector("#drc-note-styles");if(e){if(e.textContent&&e.textContent.trim().length>0)return;e.remove()}if(!window.__isInjectingStyles){window.__isInjectingStyles=!0;try{VC();let t=document.createElement("style");t.id="drc-note-styles",t.textContent=kK,document.head.appendChild(t)}catch(t){console.error("Error injecting DRCNote styles:",t)}finally{window.__isInjectingStyles=!1}}}function J2(){try{let e=document.head.querySelector("#drc-note-styles");if(e&&e.textContent&&e.textContent.trim().length>0)return;SK();let t="drc-critical-component-styles";if(!document.getElementById(t)){let r=document.createElement("style");r.id=t,r.innerHTML=`
        /* Critical styles for DRC component visibility */
        .journalit-drc-view {
          display: block !important;
          width: 100% !important;
          margin: 0 !important;
          padding: 0 !important;
          visibility: visible !important;
          opacity: 1 !important;
        }
        
        .journalit-drc-note-wrapper {
          display: block !important;
          width: 100% !important;
          margin: 0 !important;
          padding: 0 !important;
          visibility: visible !important;
          opacity: 1 !important;
        }
        
        .drc-container {
          display: block !important;
          width: 100% !important;
          box-sizing: border-box !important;
          visibility: visible !important;
          opacity: 1 !important;
        }
      `,document.head.appendChild(r)}}catch(e){console.error("Error ensuring DRCNote styles:",e);try{let t="drc-emergency-styles";if(!document.getElementById(t)){let r=document.createElement("style");r.id=t,r.innerHTML=`
          .journalit-drc-view, .journalit-drc-note-wrapper, .drc-container {
            display: block !important;
            width: 100% !important;
            visibility: visible !important;
            opacity: 1 !important;
          }
        `,document.head.appendChild(r)}}catch(t){console.error("Complete failure in DRCNote style system:",t)}}}var TK=`
/* DRC Missed Trades Section Styles */
.drc-missed-trades-section {
  margin-bottom: 24px;
}

.drc-missed-trades-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
  gap: 12px;
  flex-wrap: wrap;
}

.drc-missed-trades-header h3 {
  margin: 0;
  color: var(--text-normal);
  font-size: 18px;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 8px;
}

.drc-missed-trades-count {
  color: var(--text-muted);
  font-weight: 400;
  font-size: 16px;
}

.drc-add-missed-trade-btn {
  padding: 8px 16px !important;
  font-size: 14px !important;
  white-space: nowrap;
  flex-shrink: 0;
}

.drc-missed-trades-content {
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  background-color: var(--background-primary);
  overflow: hidden;
}

.drc-missed-trades-list {
  max-height: 400px;
  overflow-y: auto;
}

.drc-missed-trade-item {
  padding: 16px;
  border-bottom: 1px solid var(--background-modifier-border-subtle);
  transition: background-color 0.2s ease;
}

.drc-missed-trade-item:last-child {
  border-bottom: none;
}

.drc-missed-trade-item:hover {
  background-color: var(--background-modifier-hover);
}

.drc-missed-trade-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 12px;
  gap: 12px;
}

.drc-missed-trade-main {
  display: flex;
  align-items: center;
  gap: 8px;
  flex: 1;
  min-width: 0;
}

.drc-missed-trade-icon {
  font-size: 18px;
  flex-shrink: 0;
}

.drc-missed-trade-instrument {
  font-weight: 600;
  color: var(--text-normal);
  font-size: 16px;
  flex-shrink: 0;
}

.drc-missed-trade-direction {
  color: var(--text-muted);
  font-size: 14px;
  text-transform: capitalize;
  flex-shrink: 0;
}

.drc-missed-trade-badge {
  background-color: var(--color-orange, #ff9500);
  color: white;
  padding: 2px 8px;
  border-radius: 12px;
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  flex-shrink: 0;
}

.drc-missed-trade-open-btn {
  background-color: var(--interactive-accent);
  color: white;
  border: none;
  padding: 6px 12px;
  border-radius: 4px;
  font-size: 13px;
  cursor: pointer;
  transition: all 0.2s ease;
  flex-shrink: 0;
}

.drc-missed-trade-open-btn:hover {
  background-color: var(--interactive-accent-hover);
  transform: translateX(2px);
}

.drc-missed-trade-details {
  display: flex;
  flex-direction: column;
  gap: 8px;
  color: var(--text-normal);
  font-size: 14px;
  line-height: 1.4;
}

.drc-missed-trade-setup,
.drc-missed-trade-reason {
  display: flex;
  gap: 8px;
  align-items: flex-start;
}

.drc-missed-trade-setup strong,
.drc-missed-trade-reason strong {
  color: var(--text-muted);
  font-weight: 500;
  flex-shrink: 0;
  min-width: 45px;
}

.drc-missed-trade-reason {
  font-style: italic;
  color: var(--text-muted);
}

/* Loading and Error States */
.drc-missed-trades-loading,
.drc-missed-trades-error {
  padding: 24px;
  text-align: center;
  color: var(--text-muted);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  background-color: var(--background-primary);
}

.drc-missed-trades-error {
  color: var(--text-error, #e53935);
}

.drc-retry-button {
  margin-top: 12px;
  padding: 8px 16px;
  background-color: var(--interactive-accent);
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
  transition: background-color 0.2s ease;
}

.drc-retry-button:hover {
  background-color: var(--interactive-accent-hover);
}

/* Empty State Styling Override for Missed Trades */
.drc-missed-trades-content .empty-state {
  padding: 32px 24px;
  background-color: transparent;
  border: none;
}

.drc-missed-trades-content .empty-state .empty-state-icon {
  color: var(--text-muted);
  opacity: 0.6;
}

.drc-missed-trades-content .empty-state .empty-state-message {
  color: var(--text-normal);
  font-size: 16px;
  font-weight: 500;
}

.drc-missed-trades-content .empty-state .empty-state-submessage {
  color: var(--text-muted);
  font-size: 14px;
  margin-top: 8px;
  line-height: 1.4;
}

/* Responsive Design */
@media (max-width: 600px) {
  .drc-missed-trades-header {
    flex-direction: column;
    align-items: stretch;
    gap: 12px;
  }
  
  .drc-missed-trade-header {
    flex-direction: column;
    align-items: stretch;
    gap: 8px;
  }
  
  .drc-missed-trade-main {
    flex-wrap: wrap;
    gap: 6px;
  }
  
  .drc-missed-trade-open-btn {
    align-self: flex-end;
    width: auto;
  }
  
  .drc-missed-trade-details {
    margin-top: 8px;
  }
}

/* Dark Theme Adjustments */
.theme-dark .drc-missed-trade-badge {
  background-color: var(--color-orange, #ff9500);
  color: var(--text-on-accent);
}

.theme-dark .drc-missed-trade-item:hover {
  background-color: var(--background-modifier-hover);
}

/* Integration with existing DRC styles */
.drc-section .drc-missed-trades-section {
  margin-bottom: 0; /* Remove extra margin when used inside drc-section */
}

.drc-section .drc-missed-trades-header h3 {
  margin-bottom: 0; /* Consistent with other DRC section headers */
}
`,Ub=()=>{let e="drc-missed-trades-styles";if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=TK,document.head.appendChild(t)};Xg();var EK=`
  /* Image Uploader Styles */
  .journalit-image-upload {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 80px;
    border: 2px dashed var(--background-modifier-border);
    border-radius: 6px;
    margin-bottom: 12px;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
    overflow: hidden;
    background-color: var(--background-secondary);
  }

  .journalit-image-upload:hover {
    border-color: var(--interactive-accent);
    background-color: rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.05);
  }

  .journalit-image-upload:focus {
    outline: 2px solid var(--interactive-accent);
    outline-offset: 2px;
    border-color: var(--interactive-accent);
    background-color: rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.08);
  }

  .journalit-image-upload.dragging-over {
    border-color: var(--interactive-accent);
    background-color: rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.1);
    transform: scale(1.02);
    box-shadow: 0 0 12px rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.3);
  }

  .journalit-image-upload-label {
    font-size: 14px;
    color: var(--text-muted);
    cursor: pointer;
    transition: all 0.2s ease;
    padding: 8px 12px;
    text-align: center;
  }

  .journalit-image-upload:hover .journalit-image-upload-label {
    color: var(--interactive-accent);
  }

  .journalit-image-upload-input {
    display: none;
  }

  /* Image Upload Header and Paste Button Styles */
  .journalit-image-upload-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    gap: 8px;
    margin-bottom: 4px;
  }

  .journalit-image-upload-paste-btn {
    background-color: var(--interactive-accent);
    color: var(--text-on-accent);
    border: none;
    border-radius: 4px;
    padding: 4px 8px;
    font-size: 12px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 4px;
    transition: all 0.2s ease;
    white-space: nowrap;
    min-width: 60px;
    justify-content: center;
  }

  .journalit-image-upload-paste-btn:hover {
    background-color: var(--interactive-accent-hover);
    transform: translateY(-1px);
  }

  .journalit-image-upload-paste-btn:disabled {
    background-color: var(--background-modifier-border);
    color: var(--text-muted);
    cursor: not-allowed;
    transform: none;
  }

  .journalit-image-upload-paste-btn.pasting {
    background-color: var(--background-modifier-border);
    color: var(--text-muted);
  }

  .journalit-image-upload-paste-btn .paste-icon {
    font-size: 14px;
  }

  /* Spinner for paste loading */
  .journalit-spinner {
    width: 12px;
    height: 12px;
    border: 2px solid var(--background-modifier-border);
    border-top: 2px solid var(--interactive-accent);
    border-radius: 50%;
    animation: journalit-spinner-rotate 1s linear infinite;
  }

  @keyframes journalit-spinner-rotate {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }

  /* Image drag overlay and message */
  .journalit-image-upload::after {
    content: "Drop image here";
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 16px;
    font-weight: 600;
    color: var(--interactive-accent);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s ease;
  }

  .journalit-image-upload.dragging-over::after {
    opacity: 1;
  }

  .journalit-image-upload.dragging-over .journalit-image-upload-label {
    opacity: 0;
  }

  /* Image Display Styles */
  .journalit-image-viewer {
    position: relative;
    margin-bottom: 12px;
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    border: 1px solid var(--background-modifier-border);
    border-radius: 6px;
    padding: 8px;
    background-color: var(--background-primary);
  }

  .journalit-image-container {
    position: relative;
    max-width: 100%;
    width: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .journalit-image {
    max-width: 100%;
    max-height: 300px;
    object-fit: contain;
    border-radius: 6px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    background-color: var(--background-primary);
    cursor: zoom-in;
  }

  .journalit-image-delete-button {
    position: absolute;
    top: 8px;
    right: 8px;
    background-color: rgba(229, 57, 53, 0.1);
    color: var(--color-error, #e53935);
    border: none;
    border-radius: 4px;
    padding: 6px 12px;
    font-size: 12px;
    cursor: pointer;
    transition: background-color 0.2s ease;
    z-index: 10;
  }

  .journalit-image-delete-button:hover {
    background-color: rgba(229, 57, 53, 0.2);
  }

  .journalit-image-error {
    color: var(--text-error, var(--color-red, #e53935));
    font-size: 12px;
    text-align: center;
    margin-top: 4px;
    margin-bottom: 8px;
    padding: 6px 10px;
    background-color: rgba(229, 57, 53, 0.1);
    border-radius: 4px;
    width: 100%;
  }

  /* Fullscreen Styles - Borderless Design */
  .journalit-fullscreen-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-color: rgba(0, 0, 0, 0.9);
    z-index: 10000; /* Reduced from original 1000000 */
    display: flex;
    align-items: center;
    justify-content: center;
    animation: journalit-fade-in 0.3s ease-in-out;
    cursor: pointer; /* Indicate clickable backdrop */
    pointer-events: auto; /* Enable backdrop click-to-close */
    /* Ensure this doesn't interfere with normal page flow */
    contain: layout style paint;
  }

  /* Overlay UI Elements */
  .journalit-fullscreen-overlay-ui {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    pointer-events: none; /* Default to none, specific elements override */
    z-index: 10001; /* Slightly above overlay */
    /* Ensure this doesn't interfere with normal page flow */
    contain: layout style paint;
  }

  .journalit-fullscreen-title {
    position: absolute;
    top: 20px;
    left: 20px;
    color: white;
    font-size: 16px;
    font-weight: 500;
    background-color: rgba(0, 0, 0, 0.8);
    padding: 8px 12px;
    border-radius: 6px;
    pointer-events: auto; /* Enable interaction */
  }

  .journalit-fullscreen-close-btn {
    position: absolute;
    top: 20px;
    right: 20px;
    width: 40px;
    height: 40px;
    background-color: rgba(0, 0, 0, 0.8);
    color: white;
    border: none;
    border-radius: 50%;
    font-size: 24px;
    font-weight: 300;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
    pointer-events: auto; /* Enable interaction */
  }

  .journalit-fullscreen-close-btn:hover {
    background-color: rgba(0, 0, 0, 1.0);
    transform: scale(1.1);
  }

  .journalit-fullscreen-content-wrapper {
    width: 100vw;
    height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    /* Ensure this doesn't interfere with normal page flow */
    contain: layout style paint;
    isolation: isolate;
  }

  /* Image Carousel Styles */
  .journalit-image-carousel {
    width: 100%;
    margin-bottom: 16px;
    background-color: var(--background-secondary);
    border-radius: 6px;
    padding: 12px;
  }

  .journalit-carousel-main {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 8px;
    margin-bottom: 8px;
    position: relative;
    width: 100%;
  }

  .journalit-carousel-image-container {
    flex: 1;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 200px;
    width: 100%;
    position: relative;
    background-color: var(--background-primary);
    border-radius: 4px;
  }

  .journalit-carousel-button {
    width: 36px;
    height: 36px;
    min-width: 36px;
    background-color: var(--background-primary);
    color: var(--text-normal);
    border: 1px solid var(--background-modifier-border);
    border-radius: 50%;
    font-size: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.2s ease;
    z-index: 20;
  }

  .journalit-carousel-button:hover {
    background-color: var(--background-modifier-hover);
    transform: translateY(-1px);
  }

  .journalit-carousel-counter {
    text-align: center;
    font-size: 12px;
    color: var(--text-muted);
    margin: 4px 0;
  }

  .journalit-carousel-thumbnails {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-top: 4px;
    justify-content: center;
  }

  .journalit-carousel-thumbnail {
    width: 60px;
    height: 60px;
    border: 2px solid var(--background-modifier-border);
    border-radius: 4px;
    overflow: hidden;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .journalit-carousel-thumbnail:hover {
    transform: translateY(-2px);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  }

  .journalit-carousel-thumbnail.active {
    border-color: var(--interactive-accent);
    box-shadow: 0 0 0 2px var(--interactive-accent);
  }

  .journalit-carousel-thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  /* Animations */
  @keyframes journalit-fade-in {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  @keyframes journalit-zoom-in {
    from { transform: scale(0.9); opacity: 0; }
    to { transform: scale(1); opacity: 1; }
  }

  /* Hold to zoom indicator */
  .journalit-image-zoom-indicator {
    position: absolute;
    bottom: 8px;
    right: 8px;
    background-color: rgba(0, 0, 0, 0.6);
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 10px;
    opacity: 0;
    transition: opacity 0.2s ease;
    pointer-events: none;
  }

  .journalit-image-container:hover .journalit-image-zoom-indicator {
    opacity: 1;
  }

  /* Enhanced Fullscreen Viewer Styles - Full Viewport */
  .journalit-fullscreen-viewer {
    position: relative;
    width: 100vw;
    height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    /* Ensure this doesn't interfere with normal page flow */
    contain: layout style paint;
    isolation: isolate;
  }

  .journalit-fullscreen-image-wrapper {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100vw;
    height: 100vh;
    overflow: hidden;
    /* Ensure this doesn't interfere with normal page flow */
    contain: layout style paint;
  }

  .journalit-fullscreen-zoomable-image {
    max-width: 90vw;
    max-height: 90vh;
    object-fit: contain;
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    transform-origin: center;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
  }

  /* Navigation buttons - repositioned to middle sides */
  .journalit-fullscreen-nav-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 45px;
    height: 45px;
    background-color: rgba(0, 0, 0, 0.8);
    color: white;
    border: none;
    border-radius: 50%;
    font-size: 20px;
    font-weight: bold;
    cursor: pointer;
    z-index: 10;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0.8;
    pointer-events: auto; /* Enable interaction */
  }

  .journalit-fullscreen-nav-btn:hover {
    background-color: rgba(0, 0, 0, 1.0);
    transform: translateY(-50%) scale(1.1);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
    opacity: 1;
  }

  .journalit-fullscreen-nav-prev {
    left: 20px;
  }

  .journalit-fullscreen-nav-next {
    right: 20px;
  }

  /* Navigation indicator - moved to bottom center */
  .journalit-fullscreen-nav-indicator {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background-color: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 8px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 500;
    z-index: 10;
  }

  /* Zoom indicator - moved to bottom left */
  .journalit-fullscreen-zoom-indicator {
    position: absolute;
    bottom: 20px;
    left: 20px;
    background-color: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 8px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 500;
    z-index: 10;
    opacity: 0;
    transition: opacity 0.3s ease;
    pointer-events: none;
  }

  .journalit-fullscreen-viewer:hover .journalit-fullscreen-zoom-indicator {
    opacity: 1;
  }

  /* Smooth zoom transition */
  .journalit-fullscreen-zoomable-image.zooming {
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  /* Responsive navigation buttons */
  @media (max-width: 768px) {
    .journalit-fullscreen-nav-btn {
      width: 40px;
      height: 40px;
      font-size: 20px;
    }
    
    .journalit-fullscreen-nav-prev {
      left: 10px;
    }
    
    .journalit-fullscreen-nav-next {
      right: 10px;
    }
    
    .journalit-fullscreen-nav-indicator {
      bottom: 15px;
      font-size: 11px;
      padding: 6px 10px;
    }
    
    .journalit-fullscreen-zoom-indicator {
      top: 15px;
      right: 15px;
      font-size: 11px;
      padding: 6px 10px;
    }
  }
`;function yd(){if(document.head.querySelector("#journalit-image-styles"))return;let e=document.createElement("style");e.id="journalit-image-styles",e.textContent=EK,document.head.appendChild(e)}function Q2(){let e=document.head.querySelector("#journalit-image-styles");e&&e.remove()}function KC(){yd()}Qg();var PK=`
/**
 * ComboBox component styles for better performance
 * Replaces inline styles with CSS classes
 */

/* Base ComboBox container */
.combobox-container {
  position: relative;
  width: 100%;
  margin-bottom: 8px;
  /* Use initial z-index, modified via inline style when open */
}

/* Input container */
.input-container {
  position: relative;
  width: 100%;
}

/* Add dropdown indicator with CSS pseudo-element for better performance */
.input-container::after {
  content: "";
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  width: 0;
  height: 0;
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
  border-top: 5px solid var(--text-normal, #333);
  pointer-events: none;
  transition: transform 0.15s ease;
  will-change: transform;
}

/* Rotate caret when dropdown is open */
[data-is-open="true"] .input-container::after {
  transform: translateY(-50%) rotate(180deg);
}

/* ComboBox input */
.combobox-input {
  position: relative;
  z-index: 1;
  width: 100%;
  padding: 8px 12px;
  padding-right: 30px;
  border: 1px solid var(--background-modifier-border, #ddd);
  border-radius: 4px;
  background-color: var(--background-primary, #fff);
  color: var(--text-normal, #333);
  font-size: 14px;
  transition: border-color 0.15s ease;
}

/* Dropdown when open - hardware accelerated animation */
.combobox-dropdown {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  margin-top: -1px;
  z-index: 9999;
  background-color: var(--background-primary, #fff);
  border: 1px solid var(--background-modifier-border, #ddd);
  border-top: none;
  border-radius: 0 0 4px 4px;
  max-height: 200px;
  overflow-y: auto;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
  transition: opacity 0.15s ease, transform 0.15s ease;
  transform-origin: top center;
  will-change: transform, opacity;
  
  /* Using actual CSS animation instead of JS-driven transition */
  animation: combobox-dropdown-open 0.15s ease forwards;
}

@keyframes combobox-dropdown-open {
  from {
    opacity: 0;
    transform: translateY(-5px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Option item in dropdown */
.combobox-option {
  padding: 8px 12px;
  cursor: pointer;
  margin: 0;
  background-color: var(--background-primary, #fff);
  color: var(--text-normal, #333);
  font-size: 14px;
  line-height: 1.5;
  border-bottom: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1));
  transition: background-color 0.15s ease;
}

.combobox-option.highlighted,
.combobox-option:hover {
  background-color: var(--background-secondary, #f5f5f5);
}

/* "Add new" option styling */
.combobox-add-option {
  padding: 8px 12px;
  cursor: pointer;
  margin: 0;
  background-color: var(--background-primary, #fff);
  color: var(--text-normal, #333);
  font-size: 14px;
  line-height: 1.5;
  border-bottom: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1));
  font-style: italic;
  border-top: 1px dashed var(--background-modifier-border, #ddd);
  transition: background-color 0.15s ease;
}

.combobox-add-option.highlighted,
.combobox-add-option:hover {
  background-color: var(--background-secondary, #f5f5f5);
}

/* Selected items in multi-select mode */
.selected-item {
  display: inline-flex;
  align-items: center;
  margin: 0 4px 4px 0;
  padding: 4px 8px;
  background-color: var(--interactive-accent, #5183e4);
  color: white;
  border-radius: 4px;
  font-size: 12px;
  gap: 6px;
}

/* Remove button in tags */
.remove-button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 16px;
  height: 16px;
  min-width: 16px;
  min-height: 16px;
  padding: 0;
  background: rgba(255, 255, 255, 0.2);
  border: none;
  color: white;
  font-size: 14px;
  line-height: 1;
  cursor: pointer;
  border-radius: 50%;
  margin-left: 4px;
  position: relative;
  z-index: 5;
  transition: background-color 0.15s ease;
}

.remove-button:hover {
  background: rgba(255, 255, 255, 0.4);
}

/* When dropdown is open, modify input border-radius */
[data-is-open="true"] .combobox-input {
  border-bottom-left-radius: 0;
  border-bottom-right-radius: 0;
}

/* Focus state */
.combobox-input:focus {
  border-color: var(--interactive-accent, #5183e4);
  box-shadow: 0 0 0 2px rgba(83, 141, 226, 0.3);
  outline: none;
}

/* Error state */
.combobox-input.error {
  border-color: var(--text-error, #e53935);
}
`;function XC(){if(document.getElementById("journalit-combobox-styles"))return;let e=document.createElement("style");e.id="journalit-combobox-styles",e.textContent=PK,document.head.appendChild(e)}function e_(){let e=document.getElementById("journalit-combobox-styles");e&&e.remove()}function qb(){document.getElementById("journalit-combobox-styles")||XC()}tE();Wb();function t_(){Hg(),Bb(),J2(),Ub()}var r_=({plugin:e})=>{var i,o,a;let[t,r]=Pi.default.useState((a=(o=(i=e.settings)==null?void 0:i.uiCustomization)==null?void 0:o.transparentBackgrounds)!=null?a:!0),n=s=>{r(s),e.settings.uiCustomization||(e.settings.uiCustomization={transparentBackgrounds:!0}),e.settings.uiCustomization.transparentBackgrounds=s,e.saveSettings(),document.body.setAttribute("data-transparent-bg",String(s)),Di(!1,!1,!1,!1,!1,!1,!0)};return Pi.default.useEffect(()=>{document.body.setAttribute("data-transparent-bg",String(t))},[t]),Pi.default.createElement("div",{className:"journalit-settings-tab customization-settings"},Pi.default.createElement("h3",null,"Customisation"),Pi.default.createElement("p",{className:"setting-item-description"},"Customize options, appearance, and behavior of the Journalit plugin."),Pi.default.createElement(ar,{title:"UI Customisation",defaultExpanded:!0},Pi.default.createElement("div",{className:"setting-item"},Pi.default.createElement("div",{className:"setting-item-info"},Pi.default.createElement("div",{className:"setting-item-name"},"Transparent Widget Backgrounds"),Pi.default.createElement("div",{className:"setting-item-description"},"Enable for transparent backgrounds, disable for solid backgrounds on dashboard widgets and metrics.")),Pi.default.createElement("div",{className:"setting-item-control"},Pi.default.createElement(Ei,{checked:t,onChange:n,id:"transparent-backgrounds-toggle",ariaLabel:"Toggle transparent backgrounds"})))),Pi.default.createElement(ar,{title:"Custom Options",defaultExpanded:!1},Pi.default.createElement(O2,{plugin:e})))};var re=$(W()),Is=require("obsidian");bd();var we=$(W()),Kb=require("obsidian");var bc=$(W());function n_(e,t){let r=Object.keys(t).map(n=>NK(e,n,t[n]));return r.length===1?r[0]:function(){r.forEach(n=>n())}}function NK(e,t,r){let n=e[t],i=e.hasOwnProperty(t),o=i?n:function(){return Object.getPrototypeOf(e)[t].apply(this,arguments)},a=r(o);return n&&Object.setPrototypeOf(a,n),Object.setPrototypeOf(s,a),e[t]=s,l;function s(...c){return a===o&&e[t]===s&&l(),a.apply(this,c)}function l(){e[t]===s&&(i?e[t]=o:delete e[t]),a!==o&&(a=o,Object.setPrototypeOf(s,n||Function))}}var Zg=null,Gb=!1,eh=new Set,MK=()=>{Gb=!0,eh.forEach(e=>e()),eh.clear()},i_=e=>{Zg=e,setTimeout(MK,0);let t=n_(e,{unload:r=>async()=>(Zg=null,Gb=!1,eh.clear(),await r())});document.dispatchEvent(new CustomEvent("journalit:plugin-updated"))},Ge=()=>{let[e,t]=(0,bc.useState)(Gb?Zg:null),r=(0,bc.useRef)(!0),n=(0,bc.useCallback)(()=>{r.current&&Zg!==e&&t(Zg)},[e]);return(0,bc.useEffect)(()=>(r.current=!0,Gb?n():eh.add(n),document.addEventListener("journalit:plugin-updated",n),()=>{r.current=!1,eh.delete(n),document.removeEventListener("journalit:plugin-updated",n)}),[n]),e};var th=$(W());function Yb(e){let{currentDate:t,navigateTo:r,getAdjacentReview:n,getRelatedReviewPaths:i={},serviceName:o,calculateAdjacentDate:a,newReviewPathTemplate:s}=e,[l,c]=(0,th.useState)(!1),d=Ge(),u=(0,th.useCallback)(async m=>{if(!l)try{c(!0);let g=await n(m);if(g)r(g,!1);else if(a&&s){let f=a(t,m),y=s(f),h;y instanceof Promise?h=await y:h=y,r(h,!1)}}catch(g){console.error("Navigation error:",g)}finally{c(!1)}},[l,n,r,t,a,s]),p=(0,th.useCallback)(async m=>{var g;try{let f=i[m];if(!f){console.error(`No path function found for review type: ${m}`);return}let y=f(t);if(!y){console.error(`Unable to get review path for type: ${m}`);return}let h=window.app,v=!1;if((g=h==null?void 0:h.vault)!=null&&g.adapter&&(v=await h.vault.adapter.exists(y)),!v&&d)try{let b=o&&d[o];if(b){let w=`create${m.charAt(0).toUpperCase()+m.slice(1)}Review`,k=b[w],S=b.createReview;typeof k=="function"?await k.call(b,t):typeof S=="function"&&await S.call(b,t,m)}}catch(b){console.error(`Error creating ${m} review:`,b)}r(y,!1)}catch(f){console.error(`Error navigating to ${m} review:`,f)}},[i,t,r,d,o]);return{isNavigating:l,handleNavigation:u,navigateToRelatedReview:p}}var xp=$(W());function kp(e){let t=Ge(),[r,n]=(0,xp.useState)("loading"),[i,o]=(0,xp.useState)(null),[a,s]=(0,xp.useState)(null);return(0,xp.useEffect)(()=>{let l=!0,c=null,d=async()=>{if(!t){c=setTimeout(d,100);return}try{if(t.serviceManager){let p=`get${e.charAt(0).toUpperCase()+e.slice(1)}`,m=t.serviceManager;if(typeof m[p]=="function"){let g=await m[p]();l&&(o(g),n("ready"),s(null));return}}let u=t;if(u[e]){l&&(o(u[e]),n("ready"),s(null));return}throw new Error(`Service '${e}' not found on plugin instance`)}catch(u){console.error(`Error loading ${e}:`,u),l&&(o(null),n("error"),s(u instanceof Error?u:new Error(`Failed to load ${e}`)))}};return d(),()=>{l=!1,c&&clearTimeout(c)}},[t,e]),{service:i,status:r,error:a}}function o_(){return kp("drcService")}function a_(){return kp("weeklyReviewService")}var wd=$(W()),s_=({plugin:e,initialData:t,onUpdate:r})=>{var l;let[n,i]=(0,wd.useState)(((l=e.settings.trade)==null?void 0:l.lossReview)||{enabled:!1,sections:[]}),[o,a]=(0,wd.useState)(t);(0,wd.useEffect)(()=>{let c=d=>{var u,p;if(((u=d.detail)==null?void 0:u.component)==="lossReview"){let m=((p=e.settings.trade)==null?void 0:p.lossReview)||{enabled:!1,sections:[]};i(m)}};return document.addEventListener("journalit-settings-updated",c),()=>{document.removeEventListener("journalit-settings-updated",c)}},[e]);let s=(0,wd.useCallback)(c=>{a(c),r(c)},[r]);return{settings:n,data:o,updateLossReview:s}};var Sp=$(W());function l_(e=768){let[t,r]=(0,Sp.useState)(()=>window.innerWidth<e);return(0,Sp.useEffect)(()=>{let n=()=>{let s=window.innerWidth<e;r(l=>l!==s?s:l)},i,o=()=>{clearTimeout(i),i=setTimeout(n,100)};window.addEventListener("resize",o);let a=window;return a.app&&a.app.workspace&&a.app.workspace.on("resize",o),()=>{clearTimeout(i),window.removeEventListener("resize",o),a.app&&a.app.workspace&&a.app.workspace.off("resize",o)}},[e]),t}var xd=$(W());function c_(e,t){let[r,n]=(0,xd.useState)(e);return(0,xd.useEffect)(()=>{let i=setTimeout(()=>{n(e)},t);return()=>{clearTimeout(i)}},[e,t]),r}var rh=$(W());var d_=({userId:e})=>{let t=Ge(),{service:r}=kp("backendIntegrationService"),[n,i]=(0,we.useState)(null),[o,a]=(0,we.useState)(!1),[s,l]=(0,we.useState)(!1),[c,d]=(0,we.useState)(null),[u,p]=(0,we.useState)(null),[m,g]=(0,we.useState)(!1),f=(0,we.useCallback)(async()=>{var v,b;if(!(!e||!r)){a(!0),d(null);try{let w=await r.getFTPCredentials(e);if(w){let k=(v=t==null?void 0:t.settings.backendIntegration)==null?void 0:v.ftpPassword;k&&!w.password&&(w.password=k),i(w)}else i(null)}catch(w){(b=w.message)!=null&&b.includes("404")||(d("Failed to load FTP credentials"),console.error("Failed to load FTP credentials:",w)),i(null)}finally{a(!1)}}},[e,r,t==null?void 0:t.settings.backendIntegration]);we.default.useEffect(()=>{f()},[e,f]),we.default.useEffect(()=>{let v=b=>{var w;(w=b.detail)!=null&&w.credentials?i(b.detail.credentials):f()};return window.addEventListener("ftp-credentials-created",v),()=>{window.removeEventListener("ftp-credentials-created",v)}},[f]);let y=(0,we.useCallback)(async(v,b)=>{try{await navigator.clipboard.writeText(v),p(b),setTimeout(()=>p(null),2e3)}catch(w){console.error("Failed to copy to clipboard:",w),new Kb.Notice("Failed to copy to clipboard")}},[]),h=(0,we.useCallback)(async()=>{if(!(!r||!e)){g(!0),d(null);try{let v=await r.resetFTPPassword(e);v?(i(v),l(!0),new Kb.Notice("\u2705 FTP password reset successfully! Save the new password."),t!=null&&t.settings.backendIntegration&&(t.settings.backendIntegration.ftpPassword=v.password,await t.saveSettings())):d("Failed to reset password")}catch(v){console.error("Failed to reset FTP password:",v),d("Failed to reset password. Please try again."),new Kb.Notice("\u274C Failed to reset FTP password")}finally{g(!1)}}},[r,e,t]);return o&&!n?we.default.createElement("div",{className:"ftp-credentials-section"},we.default.createElement("h3",null,"FTP Credentials"),we.default.createElement("div",{className:"loading-container"},"Loading FTP credentials...")):we.default.createElement("div",{className:"ftp-credentials-section"},we.default.createElement("h3",null,"FTP Credentials for MetaTrader"),c&&we.default.createElement("div",{className:"ftp-error-message"},we.default.createElement("span",null,"\u26A0\uFE0F"),we.default.createElement("span",null,c)),n?we.default.createElement(we.default.Fragment,null,we.default.createElement("div",{className:"ftp-info-message"},we.default.createElement("p",null,"Use these credentials to configure MetaTrader's FTP publishing settings:")),we.default.createElement("div",{className:"ftp-credentials-grid"},we.default.createElement("div",{className:"ftp-credential-field"},we.default.createElement("label",null,"FTP Server:"),we.default.createElement("div",{className:"input-with-action",style:{display:"flex",alignItems:"center",gap:"4px"}},we.default.createElement("input",{type:"text",value:`${n.server}:${n.port}`,readOnly:!0,className:"ftp-readonly-input"}),we.default.createElement("button",{className:"clickable-icon",onClick:()=>y(`${n.server}:${n.port}`,"server"),"aria-label":"Copy FTP server"},u==="server"?"\u2713":"\u{1F4CB}"))),we.default.createElement("div",{className:"ftp-credential-field"},we.default.createElement("label",null,"FTP Login:"),we.default.createElement("div",{className:"input-with-action",style:{display:"flex",alignItems:"center",gap:"4px"}},we.default.createElement("input",{type:"text",value:n.username,readOnly:!0,className:"ftp-readonly-input"}),we.default.createElement("button",{className:"clickable-icon",onClick:()=>y(n.username,"username"),"aria-label":"Copy FTP login"},u==="username"?"\u2713":"\u{1F4CB}"))),n.password&&we.default.createElement("div",{className:"ftp-credential-field"},we.default.createElement("label",null,"FTP Password:"),we.default.createElement("div",{className:"input-with-action",style:{display:"flex",alignItems:"center",gap:"4px"}},we.default.createElement("input",{type:s?"text":"password",value:n.password,readOnly:!0,className:"ftp-readonly-input"}),we.default.createElement("button",{className:"clickable-icon",onClick:()=>y(n.password,"password"),"aria-label":"Copy password"},u==="password"?"\u2713":"\u{1F4CB}"),we.default.createElement("button",{className:"clickable-icon",onClick:()=>l(!s),"aria-label":s?"Hide password":"Show password"},s?"\u{1F648}":"\u{1F441}\uFE0F")),we.default.createElement("div",{className:"ftp-password-notice"},we.default.createElement("span",{style:{fontSize:"14px"}},"\u26A0\uFE0F"),we.default.createElement("span",null,"Save this password securely. It cannot be retrieved later.")))),we.default.createElement("div",{className:"ftp-reset-password",style:{marginTop:"20px",marginBottom:"20px"}},we.default.createElement("button",{className:"mod-cta",onClick:h,disabled:m,style:{width:"auto"}},m?"Resetting Password...":"Reset FTP Password"),we.default.createElement("div",{style:{marginTop:"10px",fontSize:"14px",color:"var(--text-muted)"}},"Click this button to generate a new FTP password.")),we.default.createElement("div",{className:"ftp-setup-instructions"},we.default.createElement("h4",null,"MetaTrader Setup Instructions:"),we.default.createElement("ol",null,we.default.createElement("li",null,"Open MetaTrader\xA05 (MT5)"),we.default.createElement("li",null,"Click on the ",we.default.createElement("strong",null,'"Tools"')," menu at the top"),we.default.createElement("li",null,"Select ",we.default.createElement("strong",null,'"Options"')),we.default.createElement("li",null,"Navigate to the ",we.default.createElement("strong",null,'"FTP"')," tab and enter the FTP ",we.default.createElement("em",null,"Server"),", ",we.default.createElement("em",null,"Login"),", and ",we.default.createElement("em",null,"Password")," shown above"),we.default.createElement("li",null,"Enable ",we.default.createElement("strong",null,'"Passive mode"')),we.default.createElement("li",null,"Enable ",we.default.createElement("strong",null,"automatic publishing of reports via FTP")," and set the refresh interval to ",we.default.createElement("strong",null,"60\xA0minutes"))))):we.default.createElement("div",{className:"ftp-no-credentials"},we.default.createElement("p",null,'No FTP credentials found. Click "Create FTP Credentials" in the section above to generate them.')))};var At=$(W()),ih=require("obsidian");var Jb=$(W());var Tp={button:"l",sm:"E",md:"L",lg:"X",primary:"o",secondary:"a",outline:"i",text:"n",fullWidth:"D",loading:"c","button-spinner":"m"};var Ya=Jb.default.forwardRef(({children:e,className:t="",variant:r="primary",size:n="md",disabled:i=!1,fullWidth:o=!1,loading:a=!1,icon:s,...l},c)=>{let d=[Tp.button,Tp[r],Tp[n],o?Tp.fullWidth:"",a?Tp.loading:"",t,"button",r,n,o?"fullWidth":"",a?"loading":""].filter(Boolean).join(" "),u=p=>{var m;(p.key==="Enter"||p.key===" ")&&(p.preventDefault(),p.currentTarget.click()),(m=l.onKeyDown)==null||m.call(l,p)};return Jb.default.createElement("button",{ref:c,className:d,disabled:i||a,type:l.type||"button",onKeyDown:u,"aria-busy":a,...l},s&&Jb.default.createElement("span",{className:"button-icon"},s),e)});Ya.displayName="Button";var Un=$(W());var nh=e=>{if(!e)return"";let t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${n}`},rE=e=>{if(!e)return"";let t=String(e.getHours()).padStart(2,"0"),r=String(e.getMinutes()).padStart(2,"0");return`${t}:${r}`},u_=(e,t)=>{try{if(!e)return null;let[r,n,i]=e.split("-").map(Number),o=new Date(r,n-1,i);if(t){let[a,s]=t.split(":").map(Number);o.setHours(a,s)}return o}catch(r){return console.error("Error parsing date:",r),null}},Ns=({label:e,value:t,onChange:r,error:n,helperText:i,disabled:o=!1,className:a,includeTime:s=!1,minDate:l,maxDate:c,required:d=!1,...u})=>{let p=(0,Un.useId)(),m=`date-${p}`,g=`time-${p}`,[f,y]=(0,Un.useState)(!1),[h,v]=(0,Un.useState)(""),[b,w]=(0,Un.useState)(""),k=(0,Un.useMemo)(()=>f?h:nh(t),[f,h,t]),S=(0,Un.useMemo)(()=>f?b:rE(t),[f,b,t]),x=(0,Un.useCallback)(D=>{if(f?v(D):(y(!0),v(D),w(rE(t))),D){let A=f?b:rE(t),P=u_(D,A);P&&r&&r(P)}else r&&r(void 0)},[f,b,t,r]),T=(0,Un.useCallback)(D=>{f||(y(!0),v(nh(t))),w(D);let A=f?h:nh(t);if(A&&D){let P=u_(A,D);P&&r&&r(P)}},[f,h,t,r]),E=(0,Un.useCallback)(()=>{y(!1),v(""),w("")},[]),C=l?nh(l):void 0,N=c?nh(c):void 0;return Un.default.createElement("div",{className:"date-picker-container",style:{position:"relative"}},Un.default.createElement(Mr,{id:m,label:e,type:"date",value:k,onChange:x,onBlur:E,error:n,helperText:i,disabled:o,className:a,min:C,max:N,required:d,...u}),s&&Un.default.createElement(Mr,{id:g,type:"time",value:S,onChange:T,onBlur:E,disabled:o,className:"time-input","aria-label":"Time",style:{marginTop:"8px"}}))};Ns.displayName="DatePicker";var kd=$(W());var sr=({value:e,onChange:t,min:r,max:n,step:i=1,precision:o=2,allowDecimal:a=!0,...s})=>{let[l,c]=(0,kd.useState)(e!=null?e.toString():""),[d,u]=(0,kd.useState)(!1);return(0,kd.useEffect)(()=>{if(!d&&e!==void 0&&e!==null){let y=a&&o>0?e.toFixed(o):e.toString();c(y)}else!d&&e==null&&c("")},[e,a,o,d]),kd.default.createElement(Mr,{...s,type:"text",inputMode:a?"decimal":"numeric",value:l,onChange:y=>{if(u(!0),!y){c(""),t==null||t(void 0);return}if(!(a?/^-?\d*\.?\d*$/:/^-?\d*$/).test(y)||(c(y),y==="-"||y==="."||y==="-."))return;let v=a?parseFloat(y):parseInt(y,10);if(!isNaN(v)){let b=v;r!==void 0&&v<r&&(b=r),n!==void 0&&v>n&&(b=n),t==null||t(b)}},onFocus:y=>{var v;u(!0),(parseFloat(l)===0||l==="0"||/^0\.0+$/.test(l))&&y.target.select(),(v=s.onFocus)==null||v.call(s,y)},onBlur:y=>{var h;if(u(!1),l&&!isNaN(parseFloat(l))){let v=parseFloat(l);a&&o>0&&c(v.toFixed(o))}else(l==="-"||l===".")&&(c(""),t==null||t(void 0));(h=s.onBlur)==null||h.call(s,y)},onKeyDown:y=>{var h;if(y.key==="ArrowUp"||y.key==="ArrowDown"){y.preventDefault();let v=l?parseFloat(l):0;if(!isNaN(v)){let b=y.key==="ArrowUp"?i:-i,w=v+b,k=w;r!==void 0&&w<r&&(k=r),n!==void 0&&w>n&&(k=n);let S=a&&o>0?k.toFixed(o):k.toString();c(S),t==null||t(k)}}(h=s.onKeyDown)==null||h.call(s,y)},min:r,max:n,step:i})};sr.displayName="NumberInput";var Ve=$(W()),Ms={COMBOBOX_CONTAINER:"combobox-container",INPUT_CONTAINER:"input-container",INPUT:"combobox-input",DROPDOWN:"combobox-dropdown",OPTION:"combobox-option",OPTION_HIGHLIGHTED:"highlighted",ADD_OPTION:"combobox-add-option",SELECTED_ITEM:"selected-item",REMOVE_BUTTON:"remove-button"},IK=e=>({backgroundColor:e?"var(--background-secondary)":"var(--background-primary)"}),FK=e=>({backgroundColor:e?"var(--background-secondary)":"var(--background-primary)"}),Os=({options:e,value:t,onChange:r,allowCreate:n=!1,isMulti:i=!1,label:o,placeholder:a="Select or type...",error:s,helperText:l,optionType:c,onSaveOption:d,required:u=!1})=>{let p=(0,Ve.useId)(),m=`combobox-${p}`,g=`combobox-list-${p}`,f=`helper-${p}`,y=`error-${p}`,[h,v]=(0,Ve.useState)(()=>i?"":t||""),[b,w]=(0,Ve.useState)(!1),[k,S]=(0,Ve.useState)(-1),x=(0,Ve.useRef)(null),T=(0,Ve.useRef)(null),E=(0,Ve.useRef)(!1),C=(0,Ve.useRef)(!1),N=i?Array.isArray(t)?[...t]:[]:[],D=(0,Ve.useMemo)(()=>!i&&!b&&t?t:h,[i,b,t,h]),A=(0,Ve.useCallback)(U=>{v(U.target.value),w(!0),S(-1)},[]),P=U=>{let R=(U.startsWith("__add__")?U.slice(7):U).trim();if(R!==""){if(i){let V=Array.isArray(t)?[...t]:[];if(!V.includes(R)){let G=[...V,R];r(G),d&&U.startsWith("__add__")&&d(R),(U.startsWith("__add__")||e.includes(U))&&v("")}w(!0),T.current&&setTimeout(()=>{T.current&&T.current.focus()},0)}else r(R),d&&U.startsWith("__add__")&&d(R),v(R),w(!1);S(-1)}};(0,Ve.useEffect)(()=>{let U=Y=>{var G,J,K;let R=Y.target,V=(G=R==null?void 0:R.closest)==null?void 0:G.call(R,'[role="option"]');if(V&&((J=x.current)!=null&&J.contains(R))){E.current=!0;let ne=(K=V.textContent)==null?void 0:K.trim();if(!ne)return;let te=V.hasAttribute("data-add-option")?`__add__${h}`:ne,oe=te.startsWith("__add__")?te:ne;P(oe),setTimeout(()=>{E.current=!1,i?(w(!0),T.current&&(T.current.focus(),v(""))):w(!1)},50)}};return document.addEventListener("mousedown",U,!0),()=>{document.removeEventListener("mousedown",U,!0)}},[i,h,P]);let I=(0,Ve.useCallback)(U=>{if(!i)return;C.current=!0;let R=(Array.isArray(t)?[...t]:[]).filter(V=>V!==U);r(R),setTimeout(()=>{T.current&&T.current.focus(),C.current=!1},50)},[i,r]);(0,Ve.useLayoutEffect)(()=>{if(!b)return;let U=Y=>{var K,ne,te;if(C.current)return;let R=Y.target,V=(K=R==null?void 0:R.closest)==null?void 0:K.call(R,'[role="option"]'),G=(ne=R==null?void 0:R.closest)==null?void 0:ne.call(R,'[data-remove-button="true"]');if(!((te=x.current)==null?void 0:te.contains(R))){w(!1);return}if(V){Y.stopPropagation();return}if(G){Y.preventDefault(),Y.stopPropagation(),C.current=!0;let de=(G.getAttribute("aria-label")||"").replace("Remove ","");if(de){let je=(Array.isArray(t)?[...t]:[]).filter(nt=>nt!==de);r(je),setTimeout(()=>{T.current&&T.current.focus(),C.current=!1},50)}}};return document.addEventListener("mousedown",U,!0),()=>{document.removeEventListener("mousedown",U,!0)}},[b,r]),(0,Ve.useEffect)(()=>{if(!b)return;let U=Y=>{Y.key==="Escape"&&w(!1)};return document.addEventListener("keydown",U,!0),()=>{document.removeEventListener("keydown",U,!0)}},[b]),(0,Ve.useEffect)(()=>{if(!b)return;let U=()=>{w(!1)};return window.addEventListener("blur",U),()=>{window.removeEventListener("blur",U)}},[b]);let M=(0,Ve.useMemo)(()=>{let U=i?Array.isArray(t)?t:[]:[];return e.filter(Y=>Y.toLowerCase().includes(h.toLowerCase())).filter(Y=>!i||!U.includes(Y))},[e,h,i,t]),O=(0,Ve.useMemo)(()=>n&&h.trim()!==""&&!e.find(U=>U.toLowerCase()===h.toLowerCase()),[n,h,e]),F=(0,Ve.useCallback)(U=>{let Y=M.length+(O?1:0);switch(U.key){case"ArrowDown":U.preventDefault(),w(!0),S(R=>(R+1)%Y);break;case"ArrowUp":U.preventDefault(),w(!0),S(R=>(R-1+Y)%Y);break;case"Enter":U.preventDefault(),b?k>=0&&k<M.length?P(M[k]):O&&k===M.length?P(`__add__${h}`):n&&h.trim()!==""&&P(`__add__${h}`):w(!0);break;case"Tab":if(h.trim()!==""&&M.length>0){let R=M.find(V=>V.toLowerCase().startsWith(h.toLowerCase()));R?(U.preventDefault(),P(R)):P(M[0])}else i||w(!1);break;case"Escape":w(!1);break}},[M,O,b,k,n,h,i,P]),L=Ve.default.useMemo(()=>M.map((U,Y)=>Ve.default.createElement("li",{id:`option-${Y}`,key:U,role:"option","aria-selected":k===Y,className:`${Ms.OPTION} ${k===Y?Ms.OPTION_HIGHLIGHTED:""}`,style:IK(k===Y),onMouseEnter:()=>S(Y)},U)),[M,k]),B=Ve.default.useMemo(()=>O?Ve.default.createElement("li",{id:`option-${M.length}`,role:"option","aria-selected":k===M.length,"data-add-option":"true",className:`${Ms.ADD_OPTION} ${k===M.length?Ms.OPTION_HIGHLIGHTED:""}`,style:FK(k===M.length),onMouseEnter:()=>S(M.length)},'Add "',h,'"'):null,[O,h,M.length,k]),j=Ve.default.useMemo(()=>i?Ve.default.createElement("div",null,(Array.isArray(t)?t:[]).map(U=>Ve.default.createElement("span",{key:U,className:Ms.SELECTED_ITEM},U,Ve.default.createElement("button",{type:"button",onClick:Y=>{Y.preventDefault(),Y.stopPropagation(),!C.current&&I(U)},onMouseDown:Y=>{Y.preventDefault(),Y.stopPropagation(),!C.current&&I(U)},"aria-label":`Remove ${U}`,"data-remove-button":"true",className:Ms.REMOVE_BUTTON},"\xD7")))):null,[i,t,I]),_=Ve.default.useCallback(()=>{w(!0),i||v("")},[i]),H=Ve.default.useCallback(U=>{var R,V,G;E.current||C.current||U.relatedTarget&&((V=(R=U.relatedTarget)==null?void 0:R.hasAttribute)!=null&&V.call(R,"data-remove-button"))||(G=x.current)!=null&&G.contains(U.relatedTarget)||setTimeout(()=>{!E.current&&!C.current&&w(!1)},100)},[]),q=Ve.default.useCallback(U=>{U.preventDefault(),U.stopPropagation(),w(!0),T.current&&T.current.focus()},[]),X=Ve.default.useCallback(U=>{b&&U.preventDefault()},[b]);return Ve.default.createElement("div",{ref:x,"data-combobox-type":i?"multi":"single","data-is-open":b?"true":"false",className:Ms.COMBOBOX_CONTAINER,style:{zIndex:b?9999:10}},o&&Ve.default.createElement("label",{htmlFor:m},o,u&&Ve.default.createElement("span",{className:"required-indicator"},"*")),j,Ve.default.createElement("div",{className:Ms.INPUT_CONTAINER},Ve.default.createElement("input",{ref:T,id:m,type:"text",value:D,onChange:A,onFocus:_,onBlur:H,onMouseDown:X,onClick:q,onKeyDown:F,placeholder:i&&N.length>0?"":a,"aria-expanded":b,"aria-autocomplete":"list","aria-controls":b?g:void 0,"aria-activedescendant":k>=0?`option-${k}`:void 0,"aria-invalid":!!s,"aria-describedby":s?y:l?f:void 0,role:"combobox",className:Ms.INPUT}),b&&(M.length>0||O)&&Ve.default.createElement("ul",{id:g,role:"listbox","data-dropdown-visible":"true",className:Ms.DROPDOWN},L,B)),s&&Ve.default.createElement("div",{id:y,role:"alert",className:"errorMessage"},s),!s&&l&&Ve.default.createElement("div",{id:f},l))};Os.displayName="ComboBox";var ca=$(W()),nE=({options:e,value:t,onChange:r,placeholderIcon:n,className:i="",title:o="Select an option"})=>{let[a,s]=(0,ca.useState)(!1),l=(0,ca.useRef)(null),c=e.find(u=>u.value===t);(0,ca.useEffect)(()=>{let u=p=>{l.current&&!l.current.contains(p.target)&&s(!1)};return a&&document.addEventListener("mousedown",u),()=>{document.removeEventListener("mousedown",u)}},[a]);let d=u=>{r(u.value),s(!1)};return ca.default.createElement("div",{ref:l,className:`icon-select-container ${i}`,title:o},ca.default.createElement("button",{type:"button",className:"icon-select-trigger",onClick:()=>s(!a),"aria-haspopup":"listbox","aria-expanded":a},c?c.icon:n),a&&ca.default.createElement("ul",{className:"icon-select-menu",role:"listbox"},e.map(u=>ca.default.createElement("li",{key:u.value||"null-option",className:`icon-select-option ${u.value===t?"selected":""}`,onClick:()=>d(u),role:"option","aria-selected":u.value===t,title:u.label||String(u.value)},u.icon," "))),ca.default.createElement("style",null,`
        .icon-select-container {
          position: relative;
          display: inline-block;
          width: 40px;
          height: 32px;
        }

        .icon-select-trigger {
          width: 100%;
          height: 100%;
          padding: 0;
          border: 1px solid var(--background-modifier-border);
          border-radius: 4px;
          background-color: var(--background-primary);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .icon-select-trigger:hover {
          background-color: var(--background-modifier-hover);
        }

        .icon-select-menu {
          position: absolute;
          top: calc(100% + 2px);
          left: 0;
          width: 40px;
          background-color: var(--background-primary);
          border: 1px solid var(--background-modifier-border);
          border-radius: 4px;
          box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
          z-index: 1000;
          list-style: none;
          padding: 4px 0;
          margin: 0;
        }

        .icon-select-option {
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 6px 0;
          cursor: pointer;
          height: 28px;
        }

        .icon-select-option:hover {
          background-color: var(--background-modifier-hover);
        }

        .icon-select-option.selected {
          background-color: var(--background-secondary);
        }
        
        /* SVG centering styles */
        .icon-select-trigger svg,
        .icon-select-option svg {
          display: block;
          margin: 0 auto;
        }
      `))};var p_=({plugin:e,accounts:t,onAccountsUpdated:r})=>{let[n,i]=(0,At.useState)(""),[o,a]=(0,At.useState)(""),[s,l]=(0,At.useState)(!1),[c,d]=(0,At.useState)([]);(0,At.useEffect)(()=>{u()},[]);let u=async()=>{if(e.accountService)try{let g=(await e.accountService.getAllAccounts()).map(f=>({id:f.id,name:f.name}));d(g)}catch(m){console.error("Failed to load Obsidian accounts:",m)}},p=async()=>{var m;if(!n||!o){new ih.Notice("Please select both source and target accounts");return}l(!0);try{let g=t.find(k=>k.accountId===n);if(!g)throw new Error("Source account not found");let f=c.find(k=>k.id===o);if(!f)throw new Error("Target account not found");if(((((m=e.settings.backendIntegration)==null?void 0:m.accountMapping)||{})[n]||g.displayName||`Account-${n}`)===f.name){new ih.Notice("This MT account is already linked to the selected Obsidian account"),l(!1);return}let v=e.serviceManager;if(!v)throw new Error("Service manager not available");let b=await v.getBackendIntegrationService();if(!b)throw new Error("Backend service not available");await b.updateAccountMapping(n,f.name);let w=await b.relinkAccountTrades(n,g.displayName||`Account-${n}`,f.name);new ih.Notice(`\u2705 Successfully relinked ${w.updatedCount} trades from ${g.displayName} to ${f.name}`),i(""),a(""),r()}catch(g){console.error("Failed to relink account:",g),new ih.Notice(`\u274C Failed to relink account: ${g.message}`)}finally{l(!1)}};return At.default.createElement("div",{className:"account-linking-manager"},At.default.createElement("div",{className:"setting-item"},At.default.createElement("div",{className:"setting-item-info"},At.default.createElement("div",{className:"setting-item-name"},"Change Account Linking"),At.default.createElement("div",{className:"setting-item-description"},"Move all trades from one MT account to a different Obsidian account"))),At.default.createElement("div",{className:"account-linking-controls"},At.default.createElement("div",{className:"setting-item"},At.default.createElement("div",{className:"setting-item-info"},At.default.createElement("div",{className:"setting-item-name"},"Source MT Account"),At.default.createElement("div",{className:"setting-item-description"},"Select the MT account whose trades you want to move")),At.default.createElement("div",{className:"setting-item-control"},At.default.createElement(oa,{value:n,onChange:m=>i(m),options:t.map(m=>{var y;let f=(((y=e.settings.backendIntegration)==null?void 0:y.accountMapping)||{})[m.accountId]||m.displayName||`Account-${m.accountId}`;return{value:m.accountId,label:`${m.displayName||`Account-${m.accountId}`} (${m.accountId}) \u2192 ${f}`}}),placeholder:"Select source account...",style:{width:"350px"}}))),At.default.createElement("div",{className:"setting-item"},At.default.createElement("div",{className:"setting-item-info"},At.default.createElement("div",{className:"setting-item-name"},"Target Obsidian Account"),At.default.createElement("div",{className:"setting-item-description"},"Select the Obsidian account to link the trades to")),At.default.createElement("div",{className:"setting-item-control"},At.default.createElement(oa,{value:o,onChange:m=>a(m),options:c.map(m=>({value:m.id,label:m.name})),placeholder:"Select target account...",style:{width:"250px"}}))),At.default.createElement("div",{className:"setting-item"},At.default.createElement("div",{className:"setting-item-control"},At.default.createElement(be,{variant:"primary",onClick:p,disabled:s||!n||!o},s?"Processing...":"Relink Account"))),n&&o&&At.default.createElement("div",{className:"account-linking-warning"},"\u26A0\uFE0F This will update all synced trades from the source account to be linked to the target account. This operation cannot be undone.")))};var jK="http://91.99.99.169",m_=({plugin:e})=>{var C,N;let t=e.settings.backendIntegration||ni.backendIntegration,[r,n]=(0,re.useState)({status:"unknown",isSyncing:!1,lastSyncResult:null,syncStatus:null}),[i,o]=(0,re.useState)({accounts:[],isLoading:!1}),[a,s]=(0,re.useState)({hasCredentials:!1,isCreating:!1}),[l,c]=(0,re.useState)(0),d=re.default.useMemo(()=>{try{let D=e.app.vault.getName();if(D&&D!=="Obsidian Vault")return D.toLowerCase().replace(/[^a-z0-9]/g,"");let A=e.app.vault.adapter,P="";if(A.basePath)P=A.basePath;else if(A.path)P=A.path;else return"cursive";return(P.split(/[/\\]/).pop()||"unknown").toLowerCase().replace(/[^a-z0-9]/g,"")}catch(D){return"cursive"}},[e.app.vault]),[u,p]=(0,re.useState)(null);(0,re.useEffect)(()=>{let D=!0;return(async()=>{try{let P=await e.serviceManager.getBackendIntegrationService();if(!D)return;p(P),await m(),await Promise.allSettled([g(P),f(P),b(P)])}catch(P){console.error("Failed to initialize backend integration:",P)}})(),()=>{D=!1}},[e.serviceManager]);let m=(0,re.useCallback)(async()=>{try{let D=new AbortController,A=setTimeout(()=>D.abort(),5e3),P=await fetch(`${jK}/api/v1/health`,{method:"GET",signal:D.signal});clearTimeout(A);let I=P.ok?"connected":"disconnected";n(M=>({...M,status:I}))}catch(D){n(A=>({...A,status:"disconnected"}))}},[]),g=(0,re.useCallback)(async D=>{let A=D||u;if(A)try{let P=await A.getSyncStatus();if(n(I=>({...I,syncStatus:P})),P&&P.last_sync_time&&P.sync_count!==void 0){let I=new Date(P.last_sync_time).getTime(),M=t.lastSyncTime?new Date(t.lastSyncTime).getTime():0;(I>M||P.sync_count>(t.syncCount||0))&&(await y("lastSyncTime",P.last_sync_time),await y("syncCount",P.sync_count))}}catch(P){console.error("Failed to load sync status:",P)}},[u,t.lastSyncTime,t.syncCount]),f=(0,re.useCallback)(async D=>{let A=D||u;if(A&&!(r.status==="disconnected"&&!D)){if(!t.ftpUsername&&!a.hasCredentials){o(P=>({...P,accounts:[],isLoading:!1}));return}o(P=>({...P,isLoading:!0}));try{let P=await A.fetchUserAccounts(),I=t.accountMapping||{},M=P.map(F=>({...F,displayName:I[F.accountId]||F.displayName||`Account-${F.accountId}`}));o(F=>({...F,accounts:M,isLoading:!1})),P.some(F=>F.displayName&&!I[F.accountId])&&await A.updateAccountMappings(M)}catch(P){console.error("Failed to load accounts:",P),P instanceof Error&&P.message.includes("401")?new Is.Notice("\u26A0\uFE0F Authentication failed. Please register your vault."):P instanceof Error&&P.message.includes("Network")&&new Is.Notice("\u26A0\uFE0F Network error. Please check your connection."),o(I=>({...I,isLoading:!1}))}}},[u,r.status,t.ftpUsername,a.hasCredentials]);(0,re.useEffect)(()=>{r.status==="connected"&&u&&i.accounts.length===0&&!i.isLoading&&f()},[r.status,u,i.accounts.length,i.isLoading,f]);let y=(0,re.useCallback)(async(D,A)=>{e.settings.backendIntegration={...e.settings.backendIntegration,[D]:A},await e.saveSettings(),u&&await u.updateSettings({[D]:A})},[e,u]),h=async D=>{await y("syncEnabled",D),c(A=>A+1),new Is.Notice(`Auto-sync ${D?"enabled":"disabled"}`)},v=async(D,A)=>{D==="sync"?(await y("showSyncNotifications",A),new Is.Notice(`Sync notifications ${A?"enabled":"disabled"}`)):(await y("showNewTradeNotifications",A),new Is.Notice(`New trade notifications ${A?"enabled":"disabled"}`)),c(P=>P+1)},b=(0,re.useCallback)(async D=>{let A=D||u;if(A)try{if(t.ftpUsername){let P=await A.getFTPCredentials(t.ftpUsername);s(I=>({...I,hasCredentials:!!P}))}else s(P=>({...P,hasCredentials:!1}))}catch(P){console.error("Failed to check FTP credentials:",P),s(I=>({...I,hasCredentials:!1}))}},[u,t.ftpUsername]),w=(0,re.useCallback)(async()=>{if(u){s(D=>({...D,isCreating:!0}));try{let D=await u.createOrGetFTPUser();if(D){await y("ftpUsername",D.username),await y("ftpPassword",D.password),s(P=>({...P,hasCredentials:!0})),new Is.Notice("\u2705 FTP credentials created successfully");let A=new CustomEvent("ftp-credentials-created",{detail:{credentials:D}});window.dispatchEvent(A),await f()}}catch(D){console.error("Failed to create FTP credentials:",D),new Is.Notice("\u274C Failed to create FTP credentials")}finally{s(D=>({...D,isCreating:!1}))}}},[u,y,f]),k=(0,re.useCallback)(async()=>{if(u){if(!e.authManager.isAuthenticated()){new Is.Notice("Please sign in to register your vault.");return}n(D=>({...D,isSyncing:!0}));try{await y("userId",d),await u.registerVault()&&(n(A=>({...A,status:"connected"})),await g(),await b())}catch(D){console.error("Vault registration failed:",D)}finally{n(D=>({...D,isSyncing:!1}))}}},[u,y,d,g,b,e.authManager]),S=(0,re.useCallback)(async()=>{if(u){if(!e.authManager.isAuthenticated()){new Is.Notice("Please sign in to use automated sync.");return}n(D=>({...D,isSyncing:!0}));try{let D=await u.requestForceSync();n(A=>({...A,lastSyncResult:D})),await g()}catch(D){console.error("Force sync failed:",D)}finally{n(D=>({...D,isSyncing:!1}))}}},[u,g,e.authManager]),x=(0,re.useMemo)(()=>{switch(r.status){case"connected":return"\u{1F7E2}";case"disconnected":return"\u{1F534}";default:return"\u{1F7E1}"}},[r.status]),T=(0,re.useMemo)(()=>{switch(r.status){case"connected":return"Connected";case"disconnected":return"Disconnected";default:return"Checking..."}},[r.status]),E=D=>{if(!D)return"Never";try{let A=new Date(D),P=e.settings.trade.dateFormat||"DDMMYY",I=String(A.getDate()).padStart(2,"0"),M=String(A.getMonth()+1).padStart(2,"0"),O=String(A.getFullYear()).slice(-2),F=String(A.getHours()).padStart(2,"0"),L=String(A.getMinutes()).padStart(2,"0"),B="";switch(P){case"DDMMYY":B=`${I}/${M}/${O}`;break;case"MMDDYY":B=`${M}/${I}/${O}`;break;case"YYMMDD":B=`${O}/${M}/${I}`;break;default:B=`${I}/${M}/${O}`}return`${B} ${F}:${L}`}catch(A){return"Invalid date"}};return re.default.createElement("div",{className:"journalit-settings-tab backend-integration-settings"},re.default.createElement("h3",null,"Backend Integration"),re.default.createElement("p",{className:"setting-item-description"},"Connect to the trading server for automatic trade synchronization."),re.default.createElement(ar,{title:"Connection Settings",defaultExpanded:!0},re.default.createElement("div",{className:"setting-item"},re.default.createElement("div",{className:"setting-item-info"},re.default.createElement("div",{className:"setting-item-name"},"Connection Status"),re.default.createElement("div",{className:"setting-item-description"},"Current connection status to the trading server")),re.default.createElement("div",{className:"setting-item-control"},re.default.createElement("span",{style:{display:"flex",alignItems:"center",gap:"8px"}},re.default.createElement("span",null,x),re.default.createElement("span",null,T),re.default.createElement(be,{variant:"secondary",onClick:m,style:{marginLeft:"8px",padding:"4px 8px",fontSize:"12px"}},re.default.createElement("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},re.default.createElement("path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}),re.default.createElement("path",{d:"M3 3v5h5"})))))),re.default.createElement("div",{className:"setting-item"},re.default.createElement("div",{className:"setting-item-info"},re.default.createElement("div",{className:"setting-item-name"},"Register Vault"),re.default.createElement("div",{className:"setting-item-description"},"Register this vault with the backend server for sync")),re.default.createElement("div",{className:"setting-item-control"},re.default.createElement(be,{variant:"primary",onClick:k,disabled:r.isSyncing||!u},re.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"center"}},r.isSyncing&&re.default.createElement(Or,{size:"small",message:""}),r.isSyncing?"Registering...":"Register Vault")))),r.status==="connected"&&!a.hasCredentials&&re.default.createElement("div",{className:"setting-item"},re.default.createElement("div",{className:"setting-item-info"},re.default.createElement("div",{className:"setting-item-name"},"FTP Credentials"),re.default.createElement("div",{className:"setting-item-description"},"Create FTP credentials to upload MetaTrader reports. A unique username will be generated automatically.")),re.default.createElement("div",{className:"setting-item-control"},re.default.createElement(be,{variant:"primary",onClick:w,disabled:a.isCreating||!u},re.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"center"}},a.isCreating&&re.default.createElement(Or,{size:"small",message:""}),a.isCreating?"Creating...":"Create FTP Credentials"))))),re.default.createElement(ar,{title:"Sync Settings",defaultExpanded:!0},re.default.createElement("div",{className:"setting-item"},re.default.createElement("div",{className:"setting-item-info"},re.default.createElement("div",{className:"setting-item-name"},"Enable Auto-Sync"),re.default.createElement("div",{className:"setting-item-description"},"Automatically sync trades from the backend server",re.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-muted)",marginTop:"4px"}},"\u2139\uFE0F Auto-sync checks for new trades every hour"))),re.default.createElement("div",{className:"setting-item-control"},re.default.createElement(Ei,{checked:t.syncEnabled||!1,onChange:h,id:"sync-enabled-toggle",ariaLabel:"Enable auto-sync"}))),re.default.createElement("div",{className:"setting-item"},re.default.createElement("div",{className:"setting-item-info"},re.default.createElement("div",{className:"setting-item-name"},"Manual Sync"),re.default.createElement("div",{className:"setting-item-description"},"Force immediate synchronization of trades",re.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-muted)",marginTop:"4px"}},"\u2139\uFE0F Average wait time: 2-3 minutes (maximum: 5 minutes)"))),re.default.createElement("div",{className:"setting-item-control"},re.default.createElement(be,{variant:"primary",onClick:S,disabled:r.isSyncing||!u},re.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px",justifyContent:"center"}},r.isSyncing&&re.default.createElement(Or,{size:"small",message:""}),r.isSyncing?"Syncing...":"Force Sync Now")))),r.lastSyncResult&&re.default.createElement("div",{className:"setting-item"},re.default.createElement("div",{className:"setting-item-info"},re.default.createElement("div",{className:"setting-item-name"},"Last Sync Result"),re.default.createElement("div",{className:"setting-item-description"},r.lastSyncResult.synced_trades>0?`\u2705 Synced ${r.lastSyncResult.synced_trades} trades (${r.lastSyncResult.new_files} new files)`:"\u2705 No new trades to sync"))),(t.lastSyncTime||r.syncStatus)&&re.default.createElement("div",{className:"setting-item"},re.default.createElement("div",{className:"setting-item-info"},re.default.createElement("div",{className:"setting-item-name"},"Sync Status"),re.default.createElement("div",{className:"setting-item-description"},"Last sync: ",E(t.lastSyncTime||((C=r.syncStatus)==null?void 0:C.last_sync_time))," | Total syncs: ",t.syncCount||((N=r.syncStatus)==null?void 0:N.sync_count)||0)))),re.default.createElement(ar,{title:"Notification Settings",defaultExpanded:!1},re.default.createElement("div",{className:"setting-item"},re.default.createElement("div",{className:"setting-item-info"},re.default.createElement("div",{className:"setting-item-name"},"Sync Notifications"),re.default.createElement("div",{className:"setting-item-description"},"Show notifications when sync operations complete")),re.default.createElement("div",{className:"setting-item-control"},re.default.createElement(Ei,{checked:t.showSyncNotifications||!1,onChange:D=>v("sync",D),id:"sync-notifications-toggle",ariaLabel:"Enable sync notifications"}))),re.default.createElement("div",{className:"setting-item"},re.default.createElement("div",{className:"setting-item-info"},re.default.createElement("div",{className:"setting-item-name"},"New Trade Notifications"),re.default.createElement("div",{className:"setting-item-description"},"Show notifications when new trade files are detected")),re.default.createElement("div",{className:"setting-item-control"},re.default.createElement(Ei,{checked:t.showNewTradeNotifications||!1,onChange:D=>v("newTrade",D),id:"new-trade-notifications-toggle",ariaLabel:"Enable new trade notifications"})))),re.default.createElement(ar,{title:"Trading Accounts",defaultExpanded:!1},re.default.createElement("div",{className:"setting-item"},re.default.createElement("div",{className:"setting-item-info"},re.default.createElement("div",{className:"setting-item-name"},"Linked MT Accounts"),re.default.createElement("div",{className:"setting-item-description"},"MetaTrader accounts detected from synced reports",r.status==="disconnected"&&re.default.createElement("div",{style:{fontSize:"11px",color:"var(--text-error)",marginTop:"4px"}},"\u26A0\uFE0F Server is disconnected. Please check connection status.")))),i.isLoading?re.default.createElement("div",{className:"setting-item"},re.default.createElement("div",{className:"setting-item-info"},re.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"12px"}},re.default.createElement(Or,{message:"Loading accounts...",size:"small"})))):i.accounts.length===0?re.default.createElement("div",{className:"setting-item"},re.default.createElement("div",{className:"setting-item-info"},re.default.createElement("div",{className:"setting-item-description"},"No accounts found.",r.status==="connected"?"Sync some trades to detect accounts.":"Connect to the server and sync trades to see accounts."))):re.default.createElement("div",{className:"mt-accounts-list"},i.accounts.map(D=>re.default.createElement("div",{key:D.accountId,className:"mt-account-item"},re.default.createElement("div",{className:"mt-account-info"},re.default.createElement("div",{className:"mt-account-id"},"Account ID: ",D.accountId),D.brokerName&&re.default.createElement("div",{className:"mt-account-broker"},"Broker: ",D.brokerName),re.default.createElement("div",{className:"mt-account-dates"},D.firstSeen&&re.default.createElement("span",null,"First seen: ",E(D.firstSeen)),D.lastSeen&&re.default.createElement("span",null," | Last seen: ",E(D.lastSeen)))),re.default.createElement("div",{className:"mt-account-display"},re.default.createElement("div",{className:"mt-account-name"},re.default.createElement("span",null,D.displayName||`Account-${D.accountId}`)))))),re.default.createElement("div",{className:"setting-item",style:{marginTop:"20px"}},re.default.createElement("div",{className:"setting-item-control"},re.default.createElement(be,{variant:"secondary",onClick:()=>f(),disabled:i.isLoading||!u},"Refresh Accounts"))),i.accounts.length>0&&re.default.createElement("div",{style:{marginTop:"30px",borderTop:"1px solid var(--background-modifier-border)",paddingTop:"20px"}},re.default.createElement(p_,{plugin:e,accounts:i.accounts,onAccountsUpdated:f}))),a.hasCredentials&&re.default.createElement(ar,{title:"MetaTrader FTP Credentials",defaultExpanded:!1},re.default.createElement(d_,{userId:t.ftpUsername||d})))};var Xb=class extends f_.PluginSettingTab{constructor(r,n){super(r,n);this.root=null;this.plugin=n}display(){Bb(),UC();let r=document.head.querySelector("#settings-tab-styles"),{containerEl:n}=this;n.empty(),n.addClass("journalit-settings"),n.style.display="flex",n.style.flexDirection="column",n.style.width="100%",n.style.height="100%",n.style.overflow="auto",n.style.padding="0";let i=n.createDiv({cls:"journalit-settings-wrapper"});i.style.display="flex",i.style.flexDirection="column",i.style.width="100%",i.style.height="100%",i.style.padding="16px",i.style.boxSizing="border-box",i.style.overflowY="visible",this.root||(this.root=(0,g_.createRoot)(i)),this.root.render(Ai.default.createElement(Ai.default.StrictMode,null,Ai.default.createElement(LK,{plugin:this.plugin})))}hide(){this.root&&(this.root.unmount(),this.root=null),this.containerEl.empty(),this.containerEl.removeClass("journalit-settings")}},LK=({plugin:e})=>{let[t,r]=(0,Ai.useState)("general"),n=[{id:"general",label:"General"},{id:"reviews",label:"Reviews & Analysis"},{id:"accounts",label:"Accounts & Auth"},{id:"backend",label:"Backend Integration"},{id:"customization",label:"Customisation"}],i={display:"flex",borderBottom:"1px solid var(--background-modifier-border)",marginBottom:"20px",justifyContent:"center",width:"100%",paddingBottom:"0"},o=a=>({padding:"8px 16px",cursor:"pointer",borderTop:"none",borderRight:"none",borderLeft:"none",borderBottom:a?"2px solid var(--text-accent)":"2px solid transparent",color:a?"var(--text-normal)":"var(--text-muted)",fontWeight:a?600:500,marginRight:"8px",position:"relative",bottom:"-1px",background:"transparent",borderRadius:"0",fontSize:"14px",transition:"all 0.15s ease"});return Ai.default.createElement("div",{className:"settings-tab-container",style:{display:"flex",flexDirection:"column",height:"100%",width:"100%",overflow:"visible",padding:"16px",background:"var(--background-primary)"}},Ai.default.createElement("nav",{style:i},n.map(a=>Ai.default.createElement("button",{key:a.id,style:o(t===a.id),onClick:()=>r(a.id)},a.label))),Ai.default.createElement("div",{className:"settings-tab-content journalit-tab-content",role:"tabpanel","aria-labelledby":`tab-${t}`,style:{flex:1,overflowY:"auto",padding:"20px 24px",background:"var(--background-primary)"}},t==="general"&&Ai.default.createElement(b2,{plugin:e}),t==="reviews"&&Ai.default.createElement(P2,{plugin:e}),t==="accounts"&&Ai.default.createElement(N2,{plugin:e}),t==="backend"&&Ai.default.createElement(m_,{plugin:e}),t==="customization"&&Ai.default.createElement(r_,{plugin:e})))};var vw=require("obsidian");var Y_=$(W());var h_=require("obsidian"),v_=$(Ps()),Qb=$(W()),wc=class extends h_.ItemView{constructor(r,n={}){super(r);this.root=null;this.rootEl=null;this._pendingAnimationFrame=null;this._intervals=[];this.config={containerClass:"react-view-container",rootId:`react-root-${Date.now()}`,...n},this._themeChangeHandler=()=>this.renderComponent()}registerInterval(r){return this._intervals.push(r),r}clearInterval(r){window.clearInterval(r),this._intervals=this._intervals.filter(n=>n!==r)}async onOpen(){try{this.config.containerClass&&this.config.containerClass.trim()!==""&&this.containerEl.addClass(this.config.containerClass);let r=this.containerEl.querySelector(".view-content");r instanceof HTMLElement&&(r.style.display="none"),this.rootEl=this.containerEl.createDiv(),this.config.rootId&&(this.rootEl.id=this.config.rootId),this.rootEl&&(this.rootEl.style.height="100%",this.rootEl.style.display="flex",this.rootEl.style.flexDirection="column",this.rootEl.style.overflow="visible",this.rootEl.style.flex="1 1 auto",this.rootEl.style.minHeight="min-content"),this.containerEl instanceof HTMLElement&&(this.containerEl.style.height="100%",this.containerEl.style.overflowY="auto",this.containerEl.style.display="flex",this.containerEl.style.flexDirection="column"),this.root=(0,v_.createRoot)(this.rootEl),this.renderComponent(),document.addEventListener("theme-change",this._themeChangeHandler),this.app.workspace.onLayoutReady(()=>{this._pendingAnimationFrame=window.requestAnimationFrame(()=>{this.renderComponent(),this._pendingAnimationFrame=null})})}catch(r){throw console.error("Failed to initialize React view:",r),r}}renderComponent(){if(!this.root){console.warn("Cannot render component: React root not initialized");return}if(!(!document.body.contains(this.containerEl)||!document.body.contains(this.rootEl)))try{let r=this.getRenderFunction();this.root.render(Qb.default.createElement(Qb.StrictMode,null,r()))}catch(r){console.error("Failed to render React component:",r)}}async onClose(){if(this._pendingAnimationFrame&&(window.cancelAnimationFrame(this._pendingAnimationFrame),this._pendingAnimationFrame=null),this._intervals&&(this._intervals.forEach(r=>window.clearInterval(r)),this._intervals=[]),this.root)try{this.root.unmount(),this.root=null}catch(r){console.error("Failed to unmount React component:",r)}return document.removeEventListener("theme-change",this._themeChangeHandler),Promise.resolve()}};var Ls=$(W());var De=$(W());var iE=$(W()),Cp=({title:e,children:t,description:r})=>iE.default.createElement("div",{className:"formSection"},iE.default.createElement("div",{className:"sectionContent"},t));var _K=e=>{let t=e.tradeStatus;if(t==="OPEN")return!0;if(t==="CLOSED"||e.useDirectPnLInput===!0||e.isMissedTrade===!0)return!1;let r=e.exits&&e.exits.length>0&&e.exits.some(i=>i.price!==void 0&&i.price!==null&&i.price!==0||i.size!==void 0&&i.size!==null&&i.size!==0),n=e.exitPrice!==void 0&&e.exitPrice!==null&&e.exitPrice!==0;return!r&&!n},oE=e=>{let t={},r=e.useDirectPnLInput===!0,n=e.isMissedTrade===!0,i=_K(e);if(!r&&!n)if(!e.entries||e.entries.length===0)t.entriesExits="At least one entry is required.";else{let o=[],a=!1;e.entries.forEach((s,l)=>{let c={};s.time||(c.time="Entry time is required.",a=!0),(s.price===void 0||s.price===null)&&(c.price="Entry price is required.",a=!0),(s.size===void 0||s.size===null||s.size<=0)&&(c.size="Entry size must be greater than zero.",a=!0),o[l]=c}),a&&(t.entries=o)}if(!r&&!n)if(!e.exits||e.exits.length===0)i||(t.entriesExits?t.entriesExits+=" At least one exit is required for closed trades.":t.entriesExits="At least one exit is required for closed trades.");else{let o=e.exits.filter(s=>(s.price===void 0||s.price===null||s.price===0)&&(s.size===void 0||s.size===null||s.size===0));if(!(e.exits.filter(s=>s.price!==void 0&&s.price!==null&&s.price!==0||s.size!==void 0&&s.size!==null&&s.size!==0).length===0&&i)){let s=[],l=!1;e.exits.forEach((c,d)=>{if((c.price===void 0||c.price===null||c.price===0)&&(c.size===void 0||c.size===null||c.size===0)&&i){s[d]={};return}let p={};c.time||(p.time="Exit time is required.",l=!0),(c.price===void 0||c.price===null)&&(p.price="Exit price is required.",l=!0),(c.size===void 0||c.size===null||c.size<=0)&&(p.size="Exit size must be greater than zero.",l=!0),s[d]=p}),l&&(t.exits=s)}}if(!r&&!n&&e.entries&&e.entries.length>0&&e.exits&&e.exits.length>0){let o=e.exits.filter(a=>a.price!==void 0&&a.price!==null&&a.price!==0&&a.size!==void 0&&a.size!==null&&a.size!==0);if(!(o.length===0&&i)){let a=e.entries.reduce((c,d)=>c+(d.size||0),0);o.reduce((c,d)=>c+(d.size||0),0)>a&&(t.entriesExits?t.entriesExits+=" Total exit size cannot exceed total entry size.":t.entriesExits="Total exit size cannot exceed total entry size.");let l=e.entries&&e.entries.length>0?e.entries[0].time:void 0;l&&o.some(c=>c.time&&c.time<l)&&(t.entriesExits?t.entriesExits+=" Exits cannot occur before the first entry.":t.entriesExits="Exits cannot occur before the first entry.")}}if(r&&!n&&(e.directPnL===void 0||e.directPnL===null)&&(t.directPnL="Please enter a profit/loss value."),!r&&!n?(e.entryTime||(t.entryTime="Please select an entry time."),i||(e.exitTime||(t.exitTime="Please select an exit time."),(e.exitPrice===void 0||e.exitPrice===null)&&(t.exitPrice="Please enter an exit price.")),(e.entryPrice===void 0||e.entryPrice===null)&&(t.entryPrice="Please enter an entry price."),(e.positionSize===void 0||e.positionSize===null)&&(t.positionSize="Please enter a position size.")):e.entryTime||(t.entryTime="Please select an entry time."),e.direction||(t.direction="Please select a direction."),e.assetType||(t.assetType="Please select an asset type."),e.instrument?/^[A-Z0-9]+$/i.test(e.instrument)||(t.instrument="Enter a valid ticker symbol (letters & numbers only)."):t.instrument="Please select a Ticker.",!n&&(!e.accountIds||e.accountIds.length===0)&&(!e.account||e.account.length===0)&&(t.accountIds="Please select at least one account."),!i&&e.entryTime&&e.exitTime&&e.entryTime>e.exitTime&&(t.exitTime="Exit time must be after entry time"),!r&&!n&&(e.positionSize===void 0||e.positionSize===null||e.positionSize<=0)&&(t.positionSize="Position size must be greater than zero"),e.assetType)switch(e.assetType){case"stock":break;case"options":e.expirationDate||(t.expirationDate="Please select an expiration date."),e.strikePrice||(t.strikePrice="Please enter a strike price."),e.optionType||(t.optionType="Please select an option type (call or put)."),e.contractSize!==void 0&&e.contractSize<=0&&(t.contractSize="Contract size must be greater than zero.");break;case"futures":(e.dollarPerPoint===void 0||e.dollarPerPoint<.01)&&(t.dollarPerPoint="Please enter Dollars per point (min 0.01).");break;case"forex":e.lotSize!==void 0&&e.lotSize<0&&(t.lotSize="Lot size cannot be negative.");break;case"crypto":break;case"cfd":e.leverageRatio!==void 0&&e.leverageRatio<=0&&(t.leverageRatio="Leverage ratio must be greater than zero.");break}return e.commission!==void 0&&e.commission!==null&&(typeof e.commission!="number"||e.commission<0)&&(t.commission="Commission must be a positive number."),e.swap!==void 0&&e.swap!==null&&typeof e.swap!="number"&&(t.swap="Invalid swap amount."),e.fees!==void 0&&e.fees!==null&&(typeof e.fees!="number"||e.fees<0)&&(t.fees="Fees must be a positive number."),t},Zb=e=>Object.keys(e).length>0,Ep=e=>{var r,n;if(at({tradeStatus:e.tradeStatus,exitTime:e.exitTime,pnl:e._originalPnlWasNull?null:e.pnl,useDirectPnLInput:e.useDirectPnLInput,exits:e.exits}))return 0;if(e.useDirectPnLInput&&e.directPnL!==void 0){let i=e.directPnL;return e.commission!==void 0&&(i-=e.commission),e.swap!==void 0&&(i-=e.swap),e.fees!==void 0&&(i-=e.fees),i}if(!((r=e.entries)!=null&&r.length)||!((n=e.exits)!=null&&n.length)||!e.direction)return zK(e);let t=0;return e.exits&&e.entries&&e.exits.forEach(i=>{if(i.price===void 0||i.size===void 0)return;let o=0,a=0;if(e.entries&&e.entries.forEach(d=>{d.price===void 0||d.size===void 0||(o+=d.price*d.size,a+=d.size)}),a===0)return;let s=o/a,l=0,c=e.direction==="long"?i.price-s:s-i.price;if(l=c*i.size,e.assetType)switch(e.assetType){case"options":e.contractSize&&(l=c*i.size*e.contractSize);break;case"futures":e.dollarPerPoint&&(l=c*i.size*e.dollarPerPoint,e.tickValue&&e.tickSize&&e.tickSize>0&&(l=c/e.tickSize*e.tickValue*i.size));break;case"forex":e.lotSize&&e.lotSize>0?l=c*i.size*e.lotSize:e.pipValue&&e.pipValue>0&&(l=c*1e4*e.pipValue*i.size);break;case"cfd":e.leverageRatio&&e.leverageRatio>0&&(l=c*i.size);break}t+=l}),e.commission!==void 0&&(t-=e.commission),e.swap!==void 0&&(t-=e.swap),e.fees!==void 0&&(t-=e.fees),t},zK=e=>{if(e.entryPrice===void 0||e.exitPrice===void 0||e.positionSize===void 0||!e.direction)return 0;let t=0,r=e.direction==="long"?e.exitPrice-e.entryPrice:e.entryPrice-e.exitPrice;if(t=r*e.positionSize,e.assetType)switch(e.assetType){case"options":e.contractSize&&(t=r*e.positionSize*e.contractSize);break;case"futures":e.dollarPerPoint&&(t=r*e.positionSize*e.dollarPerPoint,e.tickValue&&e.tickSize&&e.tickSize>0&&(t=r/e.tickSize*e.tickValue*e.positionSize));break;case"forex":e.lotSize&&e.lotSize>0?t=r*e.positionSize*e.lotSize:e.pipValue&&e.pipValue>0&&(t=r*1e4*e.pipValue*e.positionSize);break;case"cfd":e.leverageRatio&&e.leverageRatio>0&&(t=r*e.positionSize);break}return e.commission!==void 0&&(t-=e.commission),e.swap!==void 0&&(t-=e.swap),e.fees!==void 0&&(t-=e.fees),t},y_=e=>{if(at({tradeStatus:e.tradeStatus,exitTime:e.exitTime,pnl:e.pnl,useDirectPnLInput:e.useDirectPnLInput,exits:e.exits})||e.useDirectPnLInput||e.entryPrice===void 0||e.exitPrice===void 0||e.entryPrice===0||!e.direction)return 0;let r=(e.direction==="long"?e.exitPrice-e.entryPrice:e.entryPrice-e.exitPrice)/e.entryPrice*100;return e.assetType==="cfd"&&e.leverageRatio&&e.leverageRatio>0&&(r=r*e.leverageRatio),r},b_=e=>{let t=[];if(e.commission&&e.commission>0&&t.push(`Commission: $${e.commission.toFixed(2)}`),e.swap!==void 0&&e.swap!==null&&e.swap!==0){let r=e.swap>0?"Swap Cost":"Swap Credit";t.push(`${r}: $${Math.abs(e.swap).toFixed(2)}`)}return e.fees&&e.fees>0&&t.push(`Fees: $${e.fees.toFixed(2)}`),t.length>0?t.join(", "):"No costs"},aE=e=>{let t=e.commission||0,r=e.swap||0,n=e.fees||0;return t+r+n};Jr();var Mo=require("obsidian");Sd();Jr();var k_=require("obsidian");Jr();Jr();var vl=new Map,$K=20;function da(e){if(e){let t=[];vl.forEach((r,n)=>{n.startsWith(`${e}:`)&&t.push(n)}),t.forEach(r=>vl.delete(r))}else vl.clear()}var RK=()=>{if(vl.size>$K){let e=vl.keys().next().value;vl.delete(e)}};async function Td(e,t){try{let r=`${e}:${Date.now()-Date.now()%3e5}`;if(vl.has(r))return vl.get(r);let n=await t.getTradeData();if(!Array.isArray(n))return console.error("Error calculating account metrics: allTrades is not an array:",n),{...gp};let i=null,o=null,a=t.getAccountService();if(a){if(e.includes("-"))try{let N=await a.getAccount(e);N&&(i=N.name,o=N.id)}catch(N){}if(!i&&!o)try{let N=await a.getAccountByName(e);N&&(i=N.name,o=N.id)}catch(N){}}let s=i||e,l=o||e,c=n.filter(N=>{let D=[...Array.isArray(N.account)?N.account:[],...Array.isArray(N.accountIds)?N.accountIds:[]];return D.includes(l)||D.includes(s)?!0:D.some(A=>typeof A=="string"&&A.toLowerCase()===s.toLowerCase())});if(c.length===0)return{...gp};let d=0,u=0,p=0,m=0,g=0,f=0,y=-1/0,h=1/0,v=0,b=0,w=0;c.forEach(N=>{let D=typeof N.pnl=="string"?parseFloat(N.pnl):Number(N.pnl)||0;m+=D,D>0?(d++,g+=D,y=Math.max(y,D)):D<0?(u++,f+=Math.abs(D),h=Math.min(h,D)):p++,isNaN(D)&&console.error("Invalid PnL encountered in trade:",N),w+=D,w>b&&(b=w);let A=b-w;!isNaN(A)&&isFinite(A)?v=Math.max(v,A):console.error("Invalid drawdown calculation:",{peakBalance:b,currentBalance:w,currentDrawdown:A,pnl:D})});let k=c.length,S=k>0?d/k*100:0,x=0;f>0?x=g/f:g>0&&(x=999),(isNaN(x)||!isFinite(x))&&(console.error("Invalid profit factor calculated:",x,"totalWinAmount:",g,"totalLossAmount:",f),x=0);let T=d>0?g/d:0,E=u>0?f/u:0;y===-1/0&&(y=0),h===1/0&&(h=0);let C={totalTrades:k,winningTrades:d,losingTrades:u,breakEvenTrades:p,winRate:S,totalPnL:m,bestTrade:y,worstTrade:h,profitFactor:x,averageWin:T,averageLoss:E,maxDrawdown:v};return vl.set(r,C),RK(),C}catch(r){return console.error("Error calculating account metrics:",r),{...gp}}}Jr();var nw=class{calculateDrawdownLevel(t,r,n){return t.initialBalance-t.drawdownAmount}},lE=class{calculateDrawdownLevel(t,r,n){return t.initialBalance-t.drawdownAmount}},cE=class{calculateDrawdownLevel(t,r,n){let i=new Date(n);i.setHours(23,59,59,999);let o=t.transactions.filter(d=>new Date(d.date)<=i);if(o.length===0)return t.initialBalance-t.drawdownAmount;let a=[...o].sort((d,u)=>new Date(d.date).getTime()-new Date(u.date).getTime()),l=a[a.length-1].balanceAfter;return Math.min(t.initialBalance,Math.max(l-t.drawdownAmount,t.maxDrawdownReached||t.initialBalance-t.drawdownAmount))}};function yl(e){switch(e){case"none":return new nw;case"fixed":return new lE;case"eod_trailing":return new cE;default:return new nw}}var iw=class{constructor(t=null){this.plugin=t}setPlugin(t){this.plugin=t}async addTransaction(t,r){var s;let n={...r,id:this.generateUniqueId(),balanceAfter:0},i=[...t.transactions,n];i.forEach((l,c)=>{if(!(l.date instanceof Date)||isNaN(l.date.getTime())){console.warn(`Invalid transaction date at index ${c}, converting to Date`);try{l.date=new Date(l.date),isNaN(l.date.getTime())&&(l.date=new Date)}catch(d){console.error(`Error converting transaction date at index ${c}:`,d),l.date=new Date}}}),i.sort((l,c)=>l.date.getTime()-c.date.getTime());let o=0;i.forEach(l=>{l.type!=="cost"&&(o+=l.amount),l.balanceAfter=o});let a={...t,currentBalance:o,transactions:i,lastUpdated:new Date};if(a.drawdownType==="eod_trailing"){let l=yl("eod_trailing");a.maxDrawdownReached=l.calculateDrawdownLevel(a,a.currentBalance,new Date),a.dailyBalances=this.recalculateDailyBalances(a)}return r.type==="trade"&&((s=this.plugin)!=null&&s.tradeService)&&(da(t.id),da(t.name),a.metrics=await Td(t.id,this.plugin.tradeService)),a}async deleteTransaction(t,r){var l;let n=t.transactions.findIndex(c=>c.id===r);if(n===-1)throw new Error(`Transaction not found: ${r}`);let i=t.transactions[n],o=t.transactions.filter(c=>c.id!==r);o.forEach((c,d)=>{if(!(c.date instanceof Date)||isNaN(c.date.getTime())){console.warn(`Invalid transaction date at index ${d}, converting to Date`);try{c.date=new Date(c.date),isNaN(c.date.getTime())&&(c.date=new Date)}catch(u){console.error(`Error converting transaction date at index ${d}:`,u),c.date=new Date}}}),o.sort((c,d)=>c.date.getTime()-d.date.getTime());let a=0;o.forEach(c=>{c.type!=="cost"&&(a+=c.amount),c.balanceAfter=a});let s={...t,currentBalance:a,transactions:o,lastUpdated:new Date};if(s.drawdownType==="eod_trailing"){let c=yl("eod_trailing");s.maxDrawdownReached=c.calculateDrawdownLevel(s,s.currentBalance,new Date),s.dailyBalances=this.recalculateDailyBalances(s)}return i.type==="trade"&&((l=this.plugin)!=null&&l.tradeService)&&(da(t.id),da(t.name),s.metrics=await Td(t.id,this.plugin.tradeService)),s}async updateBalanceFromTrade(t,r,n,i=!1,o,a){var l;let s=t.transactions.findIndex(c=>c.tradeId===r);if(s===-1&&!i){let c=a;if(!c&&this.plugin)try{let u=this.plugin.app.vault.getAbstractFileByPath(r);if(u&&u instanceof k_.TFile){let p=await this.plugin.tradeService.readFrontmatter(u);if(p.entryTime){let m=new Date(p.entryTime);isNaN(m.getTime())||(c=m)}else if(p.exitTime){let m=new Date(p.exitTime);isNaN(m.getTime())||(c=m)}}}catch(u){console.warn("Could not read trade date from frontmatter, using current date:",u)}c||(c=new Date);let d={type:"trade",amount:n,date:c,description:`Trade P&L: ${r}`,tradeId:r};return await this.addTransaction(t,d)}else if(i&&s!==-1&&o!==void 0){let c=t.transactions[s],d=n-o;if(d===0)return null;let u={...c,amount:n,balanceAfter:c.balanceAfter+d},p=[...t.transactions];p[s]=u;let m=p.filter(y=>y.date>c.date),g=u.balanceAfter;m.forEach(y=>{g+=y.amount,y.balanceAfter=g});let f={...t,currentBalance:g,transactions:p,lastUpdated:new Date};if(f.drawdownType==="eod_trailing"){let y=yl("eod_trailing");f.maxDrawdownReached=y.calculateDrawdownLevel(f,f.currentBalance,new Date),f.dailyBalances=this.recalculateDailyBalances(f)}return(l=this.plugin)!=null&&l.tradeService&&(da(t.id),da(t.name),f.metrics=await Td(t.id,this.plugin.tradeService)),f}return null}recalculateDailyBalances(t){let r=new Map;t.transactions.forEach(a=>{let s=a.date.toISOString().split("T")[0],l=r.get(s)||[];l.push(a),r.set(s,l)});let n=Array.from(r.keys()).sort(),i=[],o=t.initialBalance-t.drawdownAmount;return n.forEach(a=>{let s=r.get(a)||[];s.sort((m,g)=>m.date.getTime()-g.date.getTime());let c=s[s.length-1].balanceAfter,d=yl(t.drawdownType),u=new Date(a),p=d.calculateDrawdownLevel(t,c,u);p>o&&(o=p),i.push({date:u,balance:c,drawdownLevel:o})}),i}generateUniqueId(){let t=Date.now().toString(36),r=Math.random().toString(36).substring(2,10);return`${t}-${r}`}};Jr();var ow=class{constructor(t,r=null){this.app=t;this.plugin=r}setPlugin(t){this.plugin=t}async checkAndApplyMonthlyCost(t,r,n){if(t.monthlyCost<=0||t.accountType.toLowerCase()==="archived")return!1;let i=t.lastBillingDate?new Date(t.lastBillingDate):new Date(t.createdDate),o=new Date;return Math.floor((o.getTime()-i.getTime())/(1e3*60*60*24))>=30?(await r(t.id,{type:"cost",amount:-t.monthlyCost,date:o,description:"Monthly Costs (tracking only)"}),await n(t.id,{lastBillingDate:o}),!0):!1}async validateAndApplyMonthlyCosts(t,r,n){if(t.monthlyCost<=0||t.accountType.toLowerCase()==="archived")return 0;if(t.transactions.filter(o=>o.type==="cost").length===0){let o=new Date(t.createdDate);return await r(t.id,{type:"cost",amount:-t.monthlyCost,date:o,description:"Monthly Costs (tracking only)"}),1}return 0}async checkAllAccountsForBilling(t,r,n){let i=0;for(let o of t)try{await r(o.id),await n(o.id)&&i++}catch(a){console.error(`Error checking billing for account ${o.name}:`,a)}return i}};var dE=require("obsidian");var Cd={TRADE:"trade",PERIODIC:"periodic",ACCOUNT:"account",SETUP:"setup",MISTAKE:"mistake",DIRECTION:"direction",ASSET:"asset",STATUS:"status"},Dp={DAILY:"daily",WEEKLY:"weekly",MONTHLY:"monthly"};function No(e){return e.trim().replace(/\s+/g,"-").toLowerCase().replace(/[^a-z0-9-]/g,"")}function WK(e){var r;let t=((r=e.split("/").pop())==null?void 0:r.replace(/\.md$/,""))||"";return No(t)}function aw(){return Cd.TRADE}function Pp(e){return`${Cd.PERIODIC}/${e}`}function S_(e){let t=WK(e);return`${Cd.ACCOUNT}/${t}`}function Ap(e){return e.filter(t=>t==null?void 0:t.trim()).map(t=>`${Cd.SETUP}/${No(t)}`)}function Np(e){return e.filter(t=>t==null?void 0:t.trim()).map(t=>`${Cd.MISTAKE}/${No(t)}`)}function Mp(e){let t=No(e);return`${Cd.DIRECTION}/${t}`}function Op(e){let t=No(e);return`${Cd.ASSET}/${t}`}function ua(e){return[]}function BK(e){return Array.from(new Set(e.filter(Boolean)))}function pa(...e){let t=e.flat();return BK(t)}function ah(e){if(!e)return"";if(typeof e=="string"&&e.startsWith('"')&&e.endsWith('"'))try{let t=JSON.parse(e);if(typeof t=="string")return t}catch(t){return e.slice(1,-1)}return e}var sw=class{constructor(t){this.app=t;this.ACCOUNTS_FOLDER="!Journalit/Accounts"}getAccountNotePath(t,r){let n=this.sanitizeNameForFilename(r);return(0,dE.normalizePath)(`${this.ACCOUNTS_FOLDER}/${t}/${n}.md`)}async ensureAccountFolder(t){let r=(0,dE.normalizePath)(`${this.ACCOUNTS_FOLDER}/${t}`);await this.app.vault.adapter.exists(this.ACCOUNTS_FOLDER)||await this.app.vault.createFolder(this.ACCOUNTS_FOLDER),await this.app.vault.adapter.exists(r)||await this.app.vault.createFolder(r)}async getAccountFiles(){return this.app.vault.getMarkdownFiles().filter(r=>r.path.startsWith(this.ACCOUNTS_FOLDER))}parseFrontmatter(t){let r=t.match(/^---\n([\s\S]*?)\n---/);if(!r)return{};let n=r[1],i={};return n.split(`
`).forEach(o=>{if(!o.trim())return;let a=o.indexOf(":");if(a===-1)return;let s=o.slice(0,a).trim(),l=o.slice(a+1).trim();if(l.startsWith("{")||l.startsWith("["))try{i[s]=JSON.parse(l)}catch(c){i[s]=l}else i[s]=l}),i}sanitizeNameForFilename(t){return t?t.trim().replace(/[\\/:*?"<>|]/g,"-").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,""):"unnamed-account"}generateAccountNoteContent(t,r){let n={...t,createdDate:(()=>{try{if(t.createdDate instanceof Date)return t.createdDate.toISOString();if(t.createdDate){let s=new Date(t.createdDate);if(!isNaN(s.getTime()))return s.toISOString()}return new Date().toISOString()}catch(s){return console.error("Error serializing createdDate:",s,t.createdDate),new Date().toISOString()}})(),lastUpdated:(()=>{try{if(t.lastUpdated instanceof Date)return t.lastUpdated.toISOString();if(t.lastUpdated){let s=new Date(t.lastUpdated);if(!isNaN(s.getTime()))return s.toISOString()}return new Date().toISOString()}catch(s){return console.error("Error serializing lastUpdated:",s,t.lastUpdated),new Date().toISOString()}})(),transactions:t.transactions.map(s=>({...s,date:(()=>{try{if(s.date instanceof Date)return s.date.toISOString();if(s.date){let l=new Date(s.date);if(!isNaN(l.getTime()))return l.toISOString()}return new Date().toISOString()}catch(l){return console.error("Error serializing transaction date:",l,s.date),new Date().toISOString()}})()})),dailyBalances:t.dailyBalances.map(s=>({...s,date:(()=>{try{if(s.date instanceof Date)return s.date.toISOString();if(s.date){let l=new Date(s.date);if(!isNaN(l.getTime()))return l.toISOString()}return new Date().toISOString()}catch(l){return console.error("Error serializing daily balance date:",l,s.date),new Date().toISOString()}})()}))};if(t.profitTargetDate)try{if(t.profitTargetDate instanceof Date)n.profitTargetDate=t.profitTargetDate.toISOString();else{let s=new Date(t.profitTargetDate);isNaN(s.getTime())?(console.error("Invalid profitTargetDate in serialization:",t.profitTargetDate),delete n.profitTargetDate):n.profitTargetDate=s.toISOString()}}catch(s){console.error("Error serializing profitTargetDate:",t.profitTargetDate,s),delete n.profitTargetDate}if(t.lastBillingDate)try{if(t.lastBillingDate instanceof Date)n.lastBillingDate=t.lastBillingDate.toISOString();else{let s=new Date(t.lastBillingDate);isNaN(s.getTime())?(console.error("Invalid lastBillingDate in serialization:",t.lastBillingDate),delete n.lastBillingDate):n.lastBillingDate=s.toISOString()}}catch(s){console.error("Error serializing lastBillingDate:",t.lastBillingDate,s),delete n.lastBillingDate}let i=JSON.stringify(n),o=r?this.generateAccountTags(t,r):[];return["---","type: account",`name: ${t.name}`,t.accountId?`accountId: "${t.accountId}"`:"",`accountType: ${t.accountType}`,o.length>0?`tags: [${o.map(s=>`"${s}"`).join(", ")}]`:"",`initialBalance: ${t.initialBalance}`,`currentBalance: ${t.currentBalance}`,`drawdownType: ${t.drawdownType}`,`drawdownAmount: ${t.drawdownAmount}`,(()=>{try{if(t.createdDate instanceof Date)return`createdDate: ${t.createdDate.toISOString()}`;if(t.createdDate){let s=new Date(t.createdDate);if(!isNaN(s.getTime()))return`createdDate: ${s.toISOString()}`}return`createdDate: ${new Date().toISOString()}`}catch(s){return console.error("Error with createdDate in frontmatter:",s,t.createdDate),`createdDate: ${new Date().toISOString()}`}})(),(()=>{try{if(t.lastUpdated instanceof Date)return`lastUpdated: ${t.lastUpdated.toISOString()}`;if(t.lastUpdated){let s=new Date(t.lastUpdated);if(!isNaN(s.getTime()))return`lastUpdated: ${s.toISOString()}`}return`lastUpdated: ${new Date().toISOString()}`}catch(s){return console.error("Error with lastUpdated in frontmatter:",s,t.lastUpdated),`lastUpdated: ${new Date().toISOString()}`}})(),`hasProfitTarget: ${t.hasProfitTarget}`,`profitTarget: ${t.profitTarget}`,t.profitTargetType?`profitTargetType: ${t.profitTargetType}`:"",t.profitTargetDate?(()=>{try{if(t.profitTargetDate instanceof Date)return`profitTargetDate: ${t.profitTargetDate.toISOString()}`;if(t.profitTargetDate){let s=new Date(t.profitTargetDate);if(!isNaN(s.getTime()))return`profitTargetDate: ${s.toISOString()}`}return console.error("Invalid profitTargetDate:",t.profitTargetDate),""}catch(s){return console.error("Invalid profitTargetDate:",t.profitTargetDate,s),""}})():"",t.lastBillingDate?(()=>{try{if(t.lastBillingDate instanceof Date)return`lastBillingDate: ${t.lastBillingDate.toISOString()}`;if(t.lastBillingDate){let s=new Date(t.lastBillingDate);if(!isNaN(s.getTime()))return`lastBillingDate: ${s.toISOString()}`}return console.error("Invalid lastBillingDate:",t.lastBillingDate),""}catch(s){return console.error("Invalid lastBillingDate:",t.lastBillingDate,s),""}})():"",`accountData: "${i.replace(/"/g,'\\"')}"`,"---"].filter(Boolean).join(`
`)}generateAccountTags(t,r){let n=[];return n.push(S_(r)),t.accountType&&n.push(No(t.accountType)),n.filter(Boolean)}generateUniqueId(){let t=Date.now().toString(36),r=Math.random().toString(36).substring(2,10);return`${t}-${r}`}};Jr();var lw=class{constructor(t,r=null){this.app=t;this.plugin=r}setPlugin(t){this.plugin=t}async recalculateBalance(t){var o;let r=[...t.transactions].sort((a,s)=>a.date.getTime()-s.date.getTime()),n=0;r.forEach(a=>{a.type!=="cost"&&(n+=a.amount),a.balanceAfter=n});let i={...t,currentBalance:n,transactions:r,lastUpdated:new Date};if(i.drawdownType==="eod_trailing"){let a=yl("eod_trailing");i.maxDrawdownReached=a.calculateDrawdownLevel(i,i.currentBalance,new Date),i.dailyBalances=this.recalculateDailyBalances(i)}return(o=this.plugin)!=null&&o.tradeService&&(da(t.id),da(t.name),i.metrics=await Td(t.id,this.plugin.tradeService)),i}async recalculateAccountMetrics(t){var r;if((r=this.plugin)!=null&&r.tradeService){da(t.id),da(t.name);let n=await Td(t.id,this.plugin.tradeService);return{...t,metrics:n,lastUpdated:new Date}}else return console.warn("TradeService not available, cannot recalculate metrics"),t}recalculateDailyBalances(t){let r=new Map;t.transactions.forEach(a=>{let s=a.date.toISOString().split("T")[0],l=r.get(s)||[];l.push(a),r.set(s,l)});let n=Array.from(r.keys()).sort(),i=[],o=t.initialBalance-t.drawdownAmount;return n.forEach(a=>{let s=r.get(a)||[];s.sort((m,g)=>m.date.getTime()-g.date.getTime());let c=s[s.length-1].balanceAfter,d=yl(t.drawdownType),u=new Date(a),p=d.calculateDrawdownLevel(t,c,u);p>o&&(o=p),i.push({date:u,balance:c,drawdownLevel:o})}),i}updateDrawdownLevel(t,r){return yl(t.drawdownType).calculateDrawdownLevel(t,r,new Date)}};Jr();var cw=class{constructor(t,r){this.app=t;this.generateUniqueId=r}validateCreationData(t){if(!t.name)throw new Error("Account name is required");if(t.initialBalance===void 0)throw new Error("Initial balance is required")}validateAndNormalizeCreationDate(t){let r=t?new Date(t):new Date;if(r>new Date)throw new Error("Creation date cannot be in the future");return r.setHours(0,0,0,0),r}createInitialAccountData(t,r,n,i){return{id:r,name:t.name,accountType:t.accountType,initialBalance:t.initialBalance,currentBalance:t.initialBalance,drawdownType:t.drawdownType||"none",drawdownAmount:t.drawdownAmount||0,maxDrawdownReached:t.initialBalance-(t.drawdownAmount||0),hasProfitTarget:t.hasProfitTarget||!1,profitTarget:t.profitTarget||0,profitTargetType:t.profitTargetType||"absolute",profitTargetDate:t.profitTargetDate,monthlyCost:t.monthlyCost||0,createdDate:i,lastUpdated:i,metrics:{...gp},transactions:[],dailyBalances:[],notePath:n}}addInitialTransactions(t,r,n){if(r.initialBalance>0){let i={id:this.generateUniqueId(),date:n,type:"deposit",amount:r.initialBalance,description:"Initial deposit",balanceAfter:r.initialBalance};t.transactions.push(i)}if(r.monthlyCost&&r.monthlyCost>0){t.lastBillingDate=n;let i={id:this.generateUniqueId(),date:n,type:"cost",amount:-r.monthlyCost,description:"Monthly Costs (tracking only)",balanceAfter:r.initialBalance};t.transactions.push(i)}t.currentBalance=r.initialBalance}addInitialDailyBalance(t,r,n){let i={date:r,balance:n,drawdownLevel:t.maxDrawdownReached};t.dailyBalances.push(i)}async checkAccountExists(t){return await this.app.vault.adapter.exists(t)}async createCompleteAccountData(t,r,n){if(this.validateCreationData(t),await this.checkAccountExists(n))throw new Error(`An account with the name "${t.name}" already exists`);let o=this.validateAndNormalizeCreationDate(t.createdDate),a=this.createInitialAccountData(t,r,n,o);return this.addInitialTransactions(a,t,o),this.addInitialDailyBalance(a,o,t.initialBalance),a}};var dw=class{constructor(t){this.parseFrontmatter=t}parseAccountFromFrontmatter(t,r){try{if(t.type!=="account"||!t.accountData)return null;let n=t.accountData;typeof n=="string"&&n.startsWith('"')&&n.endsWith('"')&&(n=n.slice(1,-1).replace(/\\"/g,'"'));let i=JSON.parse(n);return this.parseAndValidateAccountData(i,r),i}catch(n){return console.error(`Error parsing account data from frontmatter for ${r}:`,n),null}}parseAccountFile(t,r){try{let n=this.parseFrontmatter(t);return this.parseAccountFromFrontmatter(n,r)}catch(n){return console.error(`Error reading account file ${r}:`,n),null}}parseAndValidateAccountData(t,r){this.parseNumericFields(t),this.parseDateFields(t,r),this.parseTransactionData(t,r),this.parseDailyBalanceData(t,r)}parseNumericFields(t){t.initialBalance=Number(t.initialBalance)||0,t.currentBalance=Number(t.currentBalance)||0,t.drawdownAmount=Number(t.drawdownAmount)||0,t.maxDrawdownReached=Number(t.maxDrawdownReached)||0,t.profitTarget=Number(t.profitTarget)||0,t.monthlyCost=Number(t.monthlyCost)||0}parseDateFields(t,r){try{t.createdDate=new Date(t.createdDate),isNaN(t.createdDate.getTime())&&(console.error(`Invalid createdDate in ${r}:`,t.createdDate),t.createdDate=new Date)}catch(n){console.error(`Error parsing createdDate in ${r}:`,n),t.createdDate=new Date}try{t.lastUpdated=new Date(t.lastUpdated),isNaN(t.lastUpdated.getTime())&&(t.lastUpdated=new Date)}catch(n){console.error(`Error parsing lastUpdated in ${r}:`,n),t.lastUpdated=new Date}}parseTransactionData(t,r){if(!t.transactions){t.transactions=[];return}t.transactions.forEach((n,i)=>{try{n.date=new Date(n.date),isNaN(n.date.getTime())&&(console.error(`Invalid transaction date at index ${i} in ${r}:`,n.date),n.date=new Date)}catch(o){console.error(`Error parsing transaction date at index ${i} in ${r}:`,o),n.date=new Date}n.amount=Number(n.amount)||0,n.balanceAfter=Number(n.balanceAfter)||0})}parseDailyBalanceData(t,r){if(!t.dailyBalances){t.dailyBalances=[];return}t.dailyBalances.forEach((n,i)=>{try{n.date=new Date(n.date),isNaN(n.date.getTime())&&(console.error(`Invalid daily balance date at index ${i} in ${r}:`,n.date),n.date=new Date)}catch(o){console.error(`Error parsing daily balance date at index ${i} in ${r}:`,o),n.date=new Date}n.balance=Number(n.balance)||0,n.drawdownLevel=Number(n.drawdownLevel)||0})}async parseAccountFiles(t,r){let n=[];for(let i of t)try{let o=await r(i),a=this.parseAccountFile(o,i.path);a&&n.push(a)}catch(o){console.error(`Error processing account file ${i.path}:`,o)}return n}};Jr();var uw=class{constructor(t,r,n){this.app=t;this.getAccountNotePath=r;this.ensureAccountFolder=n}validateCreationDate(t){let r=new Date,n=new Date(t);if(n>r)throw new Error("Creation date cannot be in the future");return n.setHours(0,0,0,0),n}updateRelatedEntitiesForDateChange(t,r){let n={},i=new Date(t.createdDate);if(i.setHours(0,0,0,0),r.getTime()===i.getTime())return n;let o=t.transactions.find(a=>a.type==="deposit"&&a.description==="Initial deposit");if(o){let a=[...t.transactions],s=a.findIndex(l=>l.id===o.id);s!==-1&&(a[s]={...a[s],date:r},n.transactions=a)}if(t.dailyBalances&&t.dailyBalances.length>0){let a=[...t.dailyBalances],s=a.findIndex(l=>new Date(l.date).toDateString()===i.toDateString());s!==-1&&(a[s]={...a[s],date:r},n.dailyBalances=a)}if(t.lastBillingDate&&t.createdDate){let a=new Date(t.lastBillingDate);a.setHours(0,0,0,0);let s=new Date(t.createdDate);s.setHours(0,0,0,0),a.getTime()===s.getTime()&&(n.lastBillingDate=r)}return n}async handleNameChange(t,r,n){if(!r||r===t.name)return{notePath:t.notePath,nameChanged:!1};let i=this.getAccountNotePath(n||t.accountType,r);if(await this.app.vault.adapter.exists(i))throw new Error(`An account with the name "${r}" already exists`);return{notePath:i,nameChanged:!0}}async handleTypeChange(t,r,n,i){if(!r||r===t.accountType)return{notePath:n,typeChanged:!1};let o=n;return i||(o=this.getAccountNotePath(r,t.name)),await this.ensureAccountFolder(r),{notePath:o,typeChanged:!0}}prepareUpdatedAccount(t,r,n){return{...t,...r,notePath:n,lastUpdated:new Date}}hasDrawdownSettingsChanged(t){return t.drawdownType!==void 0||t.drawdownAmount!==void 0||t.initialBalance!==void 0}needsMonthlyCostValidation(t,r){return r.monthlyCost!==void 0&&r.monthlyCost>0&&(t.monthlyCost!==r.monthlyCost||r.createdDate!==void 0)}};Ha();var Ip=class extends Ao{constructor(r,n={}){super(r,{folder:"!Journalit/Accounts",extension:".md",cacheTTL:5*60*1e3,persistCache:!0,namespace:n.namespace||"account"});this.plugin=null;this.transactionManager=new iw(null),this.billingManager=new ow(r,null),this.noteManager=new sw(r),this.balanceManager=new lw(r,null),this.creationManager=new cw(r,()=>this.noteManager.generateUniqueId()),this.dataParser=new dw(i=>this.noteManager.parseFrontmatter(i)),this.updateManager=new uw(r,(i,o)=>this.noteManager.getAccountNotePath(i,o),i=>this.noteManager.ensureAccountFolder(i))}setPlugin(r){this.plugin=r,this.transactionManager.setPlugin(r),this.billingManager.setPlugin(r),this.balanceManager.setPlugin(r)}async createAccount(r){try{let n=this.noteManager.generateUniqueId(),i=this.noteManager.getAccountNotePath(r.accountType,r.name);await this.noteManager.ensureAccountFolder(r.accountType);let o=await this.creationManager.createCompleteAccountData(r,n,i),a=this.noteManager.generateAccountNoteContent(o,i);await this.app.vault.create(i,a),await this.clearCacheWithPrefix("account:"),this.invalidateCache();let s=new CustomEvent("journalit:account-created",{detail:{accountId:n,notePath:i,timestamp:Date.now()}});return document.dispatchEvent(s),i}catch(n){throw console.error("Error creating account:",n),n}}async recreateAccountNote(r){try{await this.noteManager.ensureAccountFolder(r.accountType);let n=this.noteManager.generateAccountNoteContent(r,r.notePath);return await this.app.vault.create(r.notePath,n),r.notePath}catch(n){throw console.error("Error recreating account note:",n),n}}async updateAccount(r,n){try{n.createdDate&&(n.createdDate=this.updateManager.validateCreationDate(n.createdDate));let i=await this.getAccount(r);if(!i)throw new Error(`Account not found: ${r}`);if(n.createdDate&&i.createdDate){let p=this.updateManager.updateRelatedEntitiesForDateChange(i,n.createdDate);Object.assign(n,p)}let{notePath:o,nameChanged:a}=await this.updateManager.handleNameChange(i,n.name||"",n.accountType),{notePath:s,typeChanged:l}=await this.updateManager.handleTypeChange(i,n.accountType||"",o,a),c=this.updateManager.prepareUpdatedAccount(i,n,s);this.updateManager.hasDrawdownSettingsChanged(n)&&(c.maxDrawdownReached=this.balanceManager.updateDrawdownLevel(c,c.currentBalance));let d=this.noteManager.generateAccountNoteContent(c,c.notePath);if(a||l){await this.app.vault.create(s,d);let p=this.app.vault.getAbstractFileByPath(i.notePath);p&&p instanceof Mo.TFile&&await this.app.vault.delete(p)}else{let p=this.app.vault.getAbstractFileByPath(i.notePath);if(!p||!(p instanceof Mo.TFile)){let g=this.app.vault.getMarkdownFiles().find(f=>f.path.toLowerCase()===i.notePath.toLowerCase());if(g)i.notePath=g.path,p=g;else throw new Error(`Invalid account note: ${i.notePath}`)}await this.app.vault.modify(p,d),await kt(this.app,p)}if(this.updateManager.needsMonthlyCostValidation(i,n))try{await this.validateAndApplyMonthlyCosts(r);let p=await this.getAccount(r)}catch(p){console.error("Error validating monthly costs after update:",p)}await this.clearCacheWithPrefix("account:"),this.invalidateCache();let u=new CustomEvent("journalit:account-updated",{detail:{accountId:r,notePath:s,timestamp:Date.now()}});document.dispatchEvent(u)}catch(i){throw console.error("Error updating account:",i),i}}async getAccount(r,n=!1){try{return(await this.getAllAccounts(n)).find(o=>o.id===r)||null}catch(i){throw console.error("Error getting account:",i),i}}async getAccountByName(r){try{return(await this.getAllAccounts()).find(i=>i.name===r)||null}catch(n){throw console.error("Error getting account by name:",n),n}}async getAllAccounts(r=!1){if(r){await this.clearCache();let i=await this.noteManager.getAccountFiles(),o=[];for(let a of i)try{let s=await this.app.vault.read(a),l=this.dataParser.parseAccountFile(s,a.path);l&&o.push(l)}catch(s){console.error(`Error reading account file ${a.path}:`,s)}return o}return this.query(async()=>{let i=await this.noteManager.getAccountFiles(),o=[];for(let a of i){let s=this.app.metadataCache.getFileCache(a);if(s!=null&&s.frontmatter)try{let l=this.dataParser.parseAccountFromFrontmatter(s.frontmatter,a.path);l&&o.push(l)}catch(l){console.warn(`Failed to parse account from cache for ${a.path}, falling back to file read:`,l);let c=await this.app.vault.cachedRead(a),d=this.dataParser.parseAccountFile(c,a.path);d&&o.push(d)}else{let l=await this.app.vault.cachedRead(a),c=this.dataParser.parseAccountFile(l,a.path);c&&o.push(c)}}return o},"account:all-accounts",{offlineCapable:!0})}async deleteAccount(r){try{let n=await this.getAccount(r);if(!n)throw new Error(`Account not found: ${r}`);let i=this.app.vault.getAbstractFileByPath(n.notePath);i&&i instanceof Mo.TFile&&await this.app.vault.delete(i),await this.clearCacheWithPrefix("account:"),this.invalidateCache();let o=new CustomEvent("journalit:account-deleted",{detail:{accountId:r,timestamp:Date.now()}});document.dispatchEvent(o)}catch(n){throw console.error("Error deleting account:",n),n}}async addTransaction(r,n){try{let i=await this.getAccount(r);if(!i)throw new Error(`Account not found: ${r}`);let o=this.app.vault.getAbstractFileByPath(i.notePath);if(!o||!(o instanceof Mo.TFile)){let u=this.app.vault.getMarkdownFiles().find(p=>p.path.toLowerCase()===i.notePath.toLowerCase());if(u)i.notePath=u.path,o=u;else throw new Error(`Invalid account note: ${i.notePath}. Please check if the account folder name case is correct.`)}let a=await this.transactionManager.addTransaction(i,n),s=this.noteManager.generateAccountNoteContent(a,a.notePath),l=this.app.vault.getAbstractFileByPath(i.notePath);if(!l||!(l instanceof Mo.TFile))throw new Error(`Invalid account note: ${i.notePath}`);await this.app.vault.modify(l,s),await kt(this.app,l),await this.clearCacheWithPrefix("account:"),this.invalidateCache();let c=new CustomEvent("journalit:account-transaction-added",{detail:{accountId:r,transactionId:a.transactions[a.transactions.length-1].id,timestamp:Date.now()}});document.dispatchEvent(c)}catch(i){throw console.error("Error adding transaction:",i),i}}async deleteTransaction(r,n){try{let i=await this.getAccount(r);if(!i)throw new Error(`Account not found: ${r}`);let o=await this.transactionManager.deleteTransaction(i,n),a=this.noteManager.generateAccountNoteContent(o,o.notePath),s=this.app.vault.getAbstractFileByPath(i.notePath);if(!s||!(s instanceof Mo.TFile))throw new Error(`Invalid account note: ${i.notePath}`);await this.app.vault.modify(s,a),await kt(this.app,s),await this.clearCacheWithPrefix("account:"),this.invalidateCache();let l=new CustomEvent("journalit:account-transaction-deleted",{detail:{accountId:r,transactionId:n,timestamp:Date.now()}});document.dispatchEvent(l)}catch(i){throw console.error("Error deleting transaction:",i),i}}async updateBalanceFromTrade(r,n,i,o=!1,a,s){try{let l=await this.getAccount(r);if(l||(l=await this.getAccountByName(r)),!l)throw new Error(`Account not found by ID or name: ${r}`);let c=await this.transactionManager.updateBalanceFromTrade(l,n,i,o,a,s);if(!c)return;let d=this.noteManager.generateAccountNoteContent(c,c.notePath),u=this.app.vault.getAbstractFileByPath(l.notePath);if(!u||!(u instanceof Mo.TFile)){let f=this.app.vault.getMarkdownFiles().find(y=>y.path.toLowerCase()===l.notePath.toLowerCase());if(f)l.notePath=f.path,u=f;else throw new Error(`Invalid account note: ${l.notePath}`)}await this.app.vault.modify(u,d),await kt(this.app,u,200),await this.clearCache();let p=new CustomEvent("journalit:account-updated",{detail:{accountId:l.id,notePath:l.notePath,timestamp:Date.now()}});document.dispatchEvent(p);let m=new CustomEvent("journalit:trade-data-changed",{detail:{action:"account-balance-updated",accountId:l.id,tradeId:n,timestamp:Date.now()}});document.dispatchEvent(m),setTimeout(()=>{let g=new CustomEvent("journalit:account-note-refreshed",{detail:{accountId:l.id,notePath:l.notePath,timestamp:Date.now()}});document.dispatchEvent(g)},300)}catch(l){throw console.error("Error updating balance from trade:",l),l}}async removeTradeFromAccount(r,n){try{let i=await this.getAccount(r);if(i||(i=await this.getAccountByName(r)),!i)throw new Error(`Account not found by ID or name: ${r}`);let o=i.transactions.find(a=>a.tradeId===n);if(o){let a=await this.transactionManager.deleteTransaction(i,o.id),s=this.noteManager.generateAccountNoteContent(a,a.notePath),l=this.app.vault.getAbstractFileByPath(i.notePath);if(!l||!(l instanceof Mo.TFile))throw new Error(`Invalid account note: ${i.notePath}`);await this.app.vault.modify(l,s),await this.clearCache();let c=new CustomEvent("journalit:account-updated",{detail:{accountId:i.id,notePath:i.notePath,timestamp:Date.now()}});document.dispatchEvent(c)}}catch(i){throw console.error("Error removing trade from account:",i),i}}async recalculateBalance(r){try{let n=await this.getAccount(r);if(!n)throw new Error(`Account not found: ${r}`);let i=await this.balanceManager.recalculateBalance(n),o=this.noteManager.generateAccountNoteContent(i,i.notePath),a=this.app.vault.getAbstractFileByPath(n.notePath);if(!a||!(a instanceof Mo.TFile))throw new Error(`Invalid account note: ${n.notePath}`);return await this.app.vault.modify(a,o),await kt(this.app,a),await this.clearCacheWithPrefix("account:"),this.invalidateCache(),i.currentBalance}catch(n){throw console.error("Error recalculating balance:",n),n}}async recalculateAccountMetrics(r,n){try{let i;if(n)i=n;else{let l=await this.getAccount(r);if(!l)throw new Error(`Account not found: ${r}`);i=l}let o=await this.balanceManager.recalculateAccountMetrics(i),a=this.noteManager.generateAccountNoteContent(o,o.notePath),s=this.app.vault.getAbstractFileByPath(i.notePath);if(!s||!(s instanceof Mo.TFile))throw new Error(`Invalid account note: ${i.notePath}`);await this.app.vault.modify(s,a),await kt(this.app,s),await this.clearCacheWithPrefix("account:"),this.invalidateCache()}catch(i){throw console.error("Error recalculating account metrics:",i),i}}getAccountNotePath(r,n){return this.noteManager.getAccountNotePath(r,n)}async ensureAccountFolder(r){return this.noteManager.ensureAccountFolder(r)}async checkAndApplyMonthlyCost(r){try{let n=await this.getAccount(r);if(!n)throw new Error(`Account not found: ${r}`);return await this.billingManager.checkAndApplyMonthlyCost(n,this.addTransaction.bind(this),this.updateAccount.bind(this))}catch(n){throw console.error("Error checking monthly cost billing:",n),n}}async validateAndApplyMonthlyCosts(r){try{let n=await this.getAccount(r);if(!n)throw new Error(`Account not found: ${r}`);return await this.billingManager.validateAndApplyMonthlyCosts(n,this.addTransaction.bind(this),this.updateAccount.bind(this))}catch(n){throw console.error("Error validating monthly costs:",n),n}}async checkAllAccountsForBilling(){try{let r=await this.getAllAccounts();return await this.billingManager.checkAllAccountsForBilling(r,this.validateAndApplyMonthlyCosts.bind(this),this.checkAndApplyMonthlyCost.bind(this))}catch(r){throw console.error("Error checking all accounts for billing:",r),r}}async getAccountById(r){try{return(await this.getAllAccounts()).find(o=>o.accountId===r||o.id===r)||null}catch(n){return console.error("Error getting account by ID:",n),null}}async createAccountFromSync(r,n){var i;try{let o={name:r.displayName||`Account-${r.accountId}`,accountType:n||"demo",initialBalance:0,currency:"USD",createdDate:r.firstSeen?new Date(r.firstSeen):new Date,broker:r.brokerName},a=await this.createAccount(o),s=this.app.vault.getAbstractFileByPath(a);if(s instanceof Mo.TFile){let l=this.app.metadataCache.getFileCache(s);if((i=l==null?void 0:l.frontmatter)!=null&&i.id){let c=await this.getAccount(l.frontmatter.id);c&&await this.updateAccount(c.id,{accountId:r.accountId})}}return a}catch(o){throw console.error("Error creating account from sync:",o),o}}async linkAccountToId(r,n){var i;try{let o=this.app.vault.getAbstractFileByPath(r);if(!(o instanceof Mo.TFile))throw new Error("Account file not found");let a=this.app.metadataCache.getFileCache(o);if(!((i=a==null?void 0:a.frontmatter)!=null&&i.id))throw new Error("Account ID not found in file");let s=await this.getAccount(a.frontmatter.id);if(!s)throw new Error("Failed to load account data");await this.updateAccount(s.id,{accountId:n})}catch(o){throw console.error("Error linking account to ID:",o),o}}async getExistingAccountTypes(){try{let r=await this.getAllAccounts(),n=new Set;for(let i of r)i.accountType&&Object.values(fd).includes(i.accountType)&&n.add(i.accountType);return n.size===0?["demo","evaluation","funded","real"]:Array.from(n)}catch(r){return console.error("Error detecting existing account types:",r),["demo","evaluation","funded","real"]}}};Jr();var pw=class{constructor(t,r={}){this.accountService=t;this.config=r;this.namespace=r.namespace||"account-transaction"}async addDeposit(t,r,n,i){if(r<=0)throw new Error("Deposit amount must be positive");await this.accountService.addTransaction(t,{type:"deposit",amount:r,date:n,description:i||"Deposit"})}async addWithdrawal(t,r,n,i){if(r<=0)throw new Error("Withdrawal amount must be positive");await this.accountService.addTransaction(t,{type:"withdrawal",amount:-r,date:n,description:i||"Withdrawal"})}async getTransactions(t,r,n){let i=await this.accountService.getAccount(t);if(!i)throw new Error(`Account not found: ${t}`);let o=i.transactions;return r&&(o=o.filter(a=>new Date(a.date)>=r)),n&&(o=o.filter(a=>new Date(a.date)<=n)),o.sort((a,s)=>new Date(s.date).getTime()-new Date(a.date).getTime())}async getTransactionsByType(t,r){return(await this.getTransactions(t)).filter(i=>i.type===r)}async calculateDailyBalance(t,r){let n=await this.accountService.getAccount(t);if(!n)throw new Error(`Account not found: ${t}`);let i=new Date(r);i.setHours(23,59,59,999);let o=n.transactions.filter(l=>new Date(l.date)<=i);if(o.length===0)return n.initialBalance;let a=[...o].sort((l,c)=>new Date(l.date).getTime()-new Date(c.date).getTime());return a[a.length-1].balanceAfter}};var sh=$(W());var T_=({data:e,errors:t,onChange:r})=>sh.default.createElement(sh.default.Fragment,null,sh.default.createElement("div",{className:"field"},sh.default.createElement(Mr,{label:"Exchange",placeholder:"e.g., NYSE, NASDAQ",value:e.exchange||"",onChange:n=>r("exchange",n),error:t.exchange})));var ii=$(W());function mw(e){switch(e){case"forex":return 5;case"crypto":return 8;case"futures":return 4;case"options":return 4;case"stock":return 2;case"cfd":return 4;default:return 4}}function C_(e){switch(e){case"forex":return 4;case"crypto":return 8;case"futures":return 0;case"options":return 0;case"stock":return 2;case"cfd":return 2;default:return 2}}var E_=({data:e,errors:t,onChange:r})=>{let n=mw(e.assetType);return ii.default.createElement(ii.default.Fragment,null,ii.default.createElement("div",{className:"field"},ii.default.createElement(Ns,{label:"Expiration Date",value:e.expirationDate,onChange:i=>r("expirationDate",i),error:t.expirationDate,required:!0})),ii.default.createElement("div",{className:"field"},ii.default.createElement(sr,{label:"Strike Price",value:e.strikePrice,onChange:i=>r("strikePrice",i),error:t.strikePrice,min:0,precision:n,allowDecimal:!0,required:!0})),ii.default.createElement("div",{className:"field"},ii.default.createElement("label",{className:"label",id:"optionType-label"},"Option Type",ii.default.createElement("span",{className:"required-indicator"},"*")),ii.default.createElement("div",{className:"direction-container",role:"radiogroup","aria-labelledby":"optionType-label","aria-required":"true"},ii.default.createElement("button",{type:"button",className:"direction-button",onClick:()=>r("optionType","call"),"aria-checked":e.optionType==="call",role:"radio"},"Call"),ii.default.createElement("button",{type:"button",className:"direction-button",onClick:()=>r("optionType","put"),"aria-checked":e.optionType==="put",role:"radio"},"Put")),t.optionType&&ii.default.createElement("div",{className:"errorMessage",role:"alert"},t.optionType)),ii.default.createElement("div",{className:"field"},ii.default.createElement(sr,{label:"Contract Size",value:e.contractSize,onChange:i=>r("contractSize",i),error:t.contractSize,min:1,precision:0,allowDecimal:!1})))};var Fs=$(W());var D_=({data:e,errors:t,onChange:r})=>Fs.default.createElement(Fs.default.Fragment,null,Fs.default.createElement("div",{className:"field"},Fs.default.createElement(sr,{label:"Dollars per point",value:e.dollarPerPoint,onChange:n=>r("dollarPerPoint",n),error:t.dollarPerPoint,min:.01,precision:2,allowDecimal:!0,required:!0,placeholder:"ex: 50 for ES1"})),Fs.default.createElement("div",{className:"twoColumnLayout"},Fs.default.createElement("div",{className:"field"},Fs.default.createElement(sr,{label:"Tick Size",value:e.tickSize,onChange:n=>r("tickSize",n),error:t.tickSize,min:0,precision:4,allowDecimal:!0})),Fs.default.createElement("div",{className:"field"},Fs.default.createElement(sr,{label:"Tick Value",value:e.tickValue,onChange:n=>r("tickValue",n),error:t.tickValue,min:0,precision:2,allowDecimal:!0}))));var ma=$(W());var P_=({data:e,errors:t,onChange:r})=>ma.default.createElement(ma.default.Fragment,null,ma.default.createElement("div",{className:"field"},ma.default.createElement("label",{className:"label",id:"lotSize-label"},"Lot Size"),ma.default.createElement("div",{className:"asset-type-container",role:"radiogroup","aria-labelledby":"lotSize-label"},[{value:1e5,label:"Standard (100,000)"},{value:1e4,label:"Mini (10,000)"},{value:1e3,label:"Micro (1,000)"},{value:0,label:"Custom"}].map(n=>ma.default.createElement("button",{key:n.value,type:"button",className:"asset-type-button",onClick:()=>r("lotSize",n.value),"aria-checked":e.lotSize===n.value,role:"radio"},n.label))),t.lotSize&&ma.default.createElement("div",{className:"errorMessage",role:"alert"},t.lotSize)),e.lotSize===0&&ma.default.createElement("div",{className:"field"},ma.default.createElement(sr,{label:"Custom Lot Size",value:e.lotSize,onChange:n=>r("lotSize",n),error:t.lotSize,min:1,precision:0,allowDecimal:!1,required:!0})),ma.default.createElement("div",{className:"field"},ma.default.createElement(sr,{label:"Pip Value",value:e.pipValue,onChange:n=>r("pipValue",n),error:t.pipValue,min:0,precision:4,allowDecimal:!0})));var lh=$(W());var A_=({data:e,errors:t,onChange:r})=>lh.default.createElement(lh.default.Fragment,null,lh.default.createElement("div",{className:"field"},lh.default.createElement(Mr,{label:"Exchange",placeholder:"e.g., Binance, Coinbase",value:e.cryptoExchange||"",onChange:n=>r("cryptoExchange",n),error:t.cryptoExchange})));var Ed=$(W());var N_=({data:e,errors:t,onChange:r})=>Ed.default.createElement(Ed.default.Fragment,null,Ed.default.createElement("div",{className:"field"},Ed.default.createElement(sr,{label:"Contract Size",value:e.contractSize,onChange:n=>r("contractSize",n),error:t.contractSize,min:1,precision:0,allowDecimal:!1})),Ed.default.createElement("div",{className:"field"},Ed.default.createElement(sr,{label:"Leverage Ratio",placeholder:"e.g., 100 for 1:100",value:e.leverageRatio,onChange:n=>r("leverageRatio",n),error:t.leverageRatio,min:1,precision:0,allowDecimal:!1})));var $e=$(W());var M_=()=>{let e="journalit-entry-exit-styles";if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=`
    /* Entry/Exit Fields styling */
    .entries-section, .exits-section {
      margin-bottom: 16px;
      padding: 12px;
      border: 1px solid var(--background-modifier-border);
      border-radius: 4px;
      background-color: var(--background-primary);
    }

    .section-title {
      margin: 0 0 12px 0;
      font-size: 16px;
      font-weight: 600;
      display: flex;
      align-items: center;
      color: var(--text-normal);
    }

    .badge {
      display: inline-block;
      background: var(--interactive-accent);
      color: white;
      font-size: 12px;
      padding: 2px 6px;
      border-radius: 10px;
      margin-left: 8px;
    }

    .entry-row, .exit-row {
      display: flex;
      align-items: flex-start;
      margin-bottom: 8px;
      padding-bottom: 8px;
      border-bottom: 1px solid var(--background-modifier-border);
    }

    .entry-index, .exit-index {
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--background-secondary);
      border-radius: 50%;
      margin-right: 12px;
      font-size: 12px;
      font-weight: 600;
      flex-shrink: 0;
      margin-top: 26px; /* Align with input fields */
    }

    .entry-fields, .exit-fields {
      display: flex;
      flex: 1;
      gap: 12px;
      flex-wrap: wrap;
    }

    .time-field {
      flex: 2;
      min-width: 180px;
    }

    .price-field, .size-field {
      flex: 1;
      min-width: 120px;
    }

    /* Make remove button class more specific to avoid conflicts */
    .entry-row .remove-button,
    .exit-row .remove-button {
      width: 28px;
      height: 28px;
      min-width: 28px;
      padding: 0;
      margin-left: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      margin-top: 26px; /* Align with input fields */
    }

    .add-button {
      margin-top: 8px;
      margin-bottom: 12px;
    }

    .total-size, .remaining-size {
      font-size: 14px;
      font-weight: 600;
      padding: 4px 8px;
      border-radius: 4px;
      background: var(--background-secondary);
      display: inline-block;
      margin-top: 8px;
    }

    .remaining-size.positive {
      color: var(--text-success);
    }

    .remaining-size.neutral {
      color: var(--text-normal);
    }

    /* Mobile responsiveness */
    @media (max-width: 768px) {
      .entry-fields, .exit-fields {
        flex-direction: column;
        gap: 8px;
      }

      .time-field, .price-field, .size-field {
        width: 100%;
        min-width: 0;
      }
    }
  `,document.head.appendChild(t)},O_=()=>{let t=document.getElementById("journalit-entry-exit-styles");t&&t.remove()};var I_=({data:e,errors:t,onChange:r})=>{var h,v;let n=()=>{let b=[...e.entries||[],{time:new Date,price:0,size:0}];r("entries",b),c(b,e.exits||[])},i=b=>{let w=[...e.entries||[]];w.splice(b,1),r("entries",w),c(w,e.exits||[])},o=()=>{let b=[...e.exits||[],{time:new Date,price:0,size:0}];r("exits",b),c(e.entries||[],b)},a=b=>{let w=[...e.exits||[]];w.splice(b,1),r("exits",w),c(e.entries||[],w)},s=(b,w,k)=>{let S=[...e.entries||[]];S[b]={...S[b],[w]:k},r("entries",S),c(S,e.exits||[])},l=(b,w,k)=>{let S=[...e.exits||[]];S[b]={...S[b],[w]:k},r("exits",S),c(e.entries||[],S)},c=(b,w)=>{if(!b.length||!w.length)return;let k=0,S=0;b.forEach(E=>{E.size!==void 0&&E.price!==void 0&&(k+=E.price*E.size,S+=E.size)});let x=0,T=0;if(w.forEach(E=>{E.size!==void 0&&E.price!==void 0&&(x+=E.price*E.size,T+=E.size)}),S>0){r("entryPrice",k/S),r("positionSize",S);let E=b.reduce((C,N)=>N.time&&(!C||N.time<C)?N.time:C,null);E&&r("entryTime",E)}if(T>0){r("exitPrice",x/T);let E=w.reduce((C,N)=>N.time&&(!C||N.time>C)?N.time:C,null);E&&r("exitTime",E)}},d=async b=>{r("useDirectPnLInput",b);try{let w=It().plugins.plugins.journalit;w&&(w.settings.trade.useDirectPnLInput=b,await w.saveSettings())}catch(w){console.error("Error saving PNL input mode preference:",w)}},u=()=>{switch(e.assetType){case"stock":return"Shares";case"options":case"futures":return"Contracts";case"forex":return"Lots";case"crypto":return"Amount";case"cfd":return"CFD Units";default:return"Position Size"}},p=(e.entries||[]).reduce((b,w)=>b+(w.size||0),0),m=(e.exits||[]).reduce((b,w)=>b+(w.size||0),0),g=p-m,f=mw(e.assetType),y=C_(e.assetType);return(0,$e.useEffect)(()=>(M_(),()=>{O_()}),[]),$e.default.createElement($e.default.Fragment,null,$e.default.createElement("div",{className:"pnl-mode-toggle",style:{marginBottom:"20px",padding:"16px",border:"1px solid var(--background-modifier-border)",borderRadius:"8px"}},$e.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"12px"}},$e.default.createElement("div",{className:"toggle-container",style:{position:"relative",width:"36px",height:"20px"}},$e.default.createElement("input",{type:"checkbox",id:"use-direct-pnl",checked:e.useDirectPnLInput||!1,onChange:b=>d(b.target.checked),className:"toggle-checkbox",style:{opacity:0,width:0,height:0}}),$e.default.createElement("label",{htmlFor:"use-direct-pnl",className:"toggle-switch",style:{position:"absolute",cursor:"pointer",top:0,left:0,right:0,bottom:0,backgroundColor:e.useDirectPnLInput?"var(--interactive-accent)":"var(--background-modifier-border)",transition:".3s",borderRadius:"20px"}},$e.default.createElement("span",{style:{position:"absolute",content:'""',height:"16px",width:"16px",left:"2px",bottom:"2px",backgroundColor:"var(--background-primary)",transition:".3s",borderRadius:"50%",transform:e.useDirectPnLInput?"translateX(16px)":"translateX(0px)"}}))),$e.default.createElement("label",{htmlFor:"use-direct-pnl",style:{fontWeight:"500",cursor:"pointer"}},"Enter PNL directly instead of prices")),$e.default.createElement("p",{style:{margin:"8px 0 0 0",fontSize:"13px",color:"var(--text-muted)",lineHeight:"1.4"}},e.useDirectPnLInput?"Enter your total profit/loss directly. Commission and fees will still be subtracted.":"Calculate PNL from entry/exit prices and position sizes.")),e.useDirectPnLInput?$e.default.createElement("div",{className:"direct-pnl-section"},$e.default.createElement("h4",{className:"section-title"},"Trade Details"),$e.default.createElement("div",{className:"field"},$e.default.createElement(Ns,{label:"Entry Date",value:e.entryTime,onChange:b=>r("entryTime",b),error:t.entryTime,includeTime:!0,required:!e.isMissedTrade})),$e.default.createElement("div",{className:"field",style:{marginTop:"32px"}},$e.default.createElement(sr,{label:`${u()} (optional)`,value:e.positionSize,onChange:b=>r("positionSize",b),error:t.positionSize,min:0,precision:y,allowDecimal:!0,required:!1,placeholder:"Enter position size"})),$e.default.createElement("div",{className:"field",style:{marginTop:"32px"}},$e.default.createElement(sr,{label:"Total P&L",value:e.directPnL,onChange:b=>r("directPnL",b),error:t.directPnL,allowDecimal:!0,precision:2,required:!e.isMissedTrade,placeholder:"Enter total profit or loss"}))):$e.default.createElement($e.default.Fragment,null,$e.default.createElement("div",{className:"entries-section"},$e.default.createElement("h4",{className:"section-title"},"Entries ",$e.default.createElement("span",{className:"badge"},((h=e.entries)==null?void 0:h.length)||0)),(e.entries||[]).map((b,w)=>{var k,S,x,T,E,C,N;return $e.default.createElement("div",{key:`entry-${w}`,className:"entry-row"},$e.default.createElement("div",{className:"entry-index"},w+1),$e.default.createElement("div",{className:"entry-fields"},$e.default.createElement(Ns,{label:"Time",value:b.time,onChange:D=>s(w,"time",D),error:(S=(k=t.entries)==null?void 0:k[w])==null?void 0:S.time,includeTime:!0,required:!e.isMissedTrade,className:"time-field"}),$e.default.createElement(sr,{label:"Price",value:b.price,onChange:D=>s(w,"price",D),error:(T=(x=t.entries)==null?void 0:x[w])==null?void 0:T.price,min:0,precision:f,allowDecimal:!0,required:!e.isMissedTrade,className:"price-field"}),$e.default.createElement(sr,{label:"Size",value:b.size,onChange:D=>s(w,"size",D),error:(C=(E=t.entries)==null?void 0:E[w])==null?void 0:C.size,min:0,precision:y,required:!e.isMissedTrade,className:"size-field"})),(((N=e.entries)==null?void 0:N.length)||0)>1&&$e.default.createElement(Ya,{variant:"outline",className:"remove-button",onClick:()=>i(w),title:"Remove Entry"},"-"))}),$e.default.createElement(Ya,{variant:"outline",className:"add-button",onClick:n,title:"Add Entry"},"+ Add Entry"),$e.default.createElement("div",{className:"total-size"},"Total Entry Size: ",p.toFixed(y))),$e.default.createElement("div",{className:"exits-section"},$e.default.createElement("h4",{className:"section-title"},"Exits ",$e.default.createElement("span",{className:"badge"},((v=e.exits)==null?void 0:v.length)||0)),(e.exits||[]).map((b,w)=>{var k,S,x,T,E,C,N;return $e.default.createElement("div",{key:`exit-${w}`,className:"exit-row"},$e.default.createElement("div",{className:"exit-index"},w+1),$e.default.createElement("div",{className:"exit-fields"},$e.default.createElement(Ns,{label:"Time",value:b.time,onChange:D=>l(w,"time",D),error:(S=(k=t.exits)==null?void 0:k[w])==null?void 0:S.time,includeTime:!0,required:!e.isMissedTrade,className:"time-field"}),$e.default.createElement(sr,{label:"Price",value:b.price,onChange:D=>l(w,"price",D),error:(T=(x=t.exits)==null?void 0:x[w])==null?void 0:T.price,min:0,precision:f,allowDecimal:!0,required:!e.isMissedTrade,className:"price-field"}),$e.default.createElement(sr,{label:"Size",value:b.size,onChange:D=>l(w,"size",D),error:(C=(E=t.exits)==null?void 0:E[w])==null?void 0:C.size,min:0,precision:y,required:!e.isMissedTrade,className:"size-field"})),(((N=e.exits)==null?void 0:N.length)||0)>1&&$e.default.createElement(Ya,{variant:"outline",className:"remove-button",onClick:()=>a(w),title:"Remove Exit"},"-"))}),$e.default.createElement(Ya,{variant:"outline",className:"add-button",onClick:o,title:"Add Exit"},"+ Add Exit"),$e.default.createElement("div",{className:`remaining-size ${g>0?"positive":"neutral"}`},"Remaining Position: ",g.toFixed(y)," ",g>0?"(Open)":"(Closed)"))),!e.useDirectPnLInput&&t.entriesExits&&$e.default.createElement("div",{className:"errorMessage",role:"alert"},t.entriesExits))};var F_=({data:e,errors:t,onChange:r,instruments:n=[]})=>{let[i,o]=(0,De.useState)([]),[a,s]=(0,De.useState)({}),[l,c]=(0,De.useState)({}),[d,u]=(0,De.useState)([]),[p,m]=(0,De.useState)(!1);(0,De.useEffect)(()=>{let T=It().plugins.plugins.journalit,E=T&&T.optionsService?T.optionsService:new En,C=async()=>{try{m(!0);let P=await((T==null?void 0:T.accountService)||new Ip(It())).getAllAccounts(),I={},M={},O=[];P.forEach(B=>{let j=B.accountName||B.name,_=B.accountId||B.id,H=B.accountId?`${j} (${B.accountId})`:j;I[H]=_,M[_]=H,O.push(H)}),o(O),s(I),c(M);let F=e.assetType?E.getInstrumentsForAssetType(e.assetType):[],L=e.instrument&&e.assetType&&!F.includes(e.instrument)?[...F,e.instrument]:[...F];e.instrument&&e.assetType&&F.includes(e.instrument),u(L)}catch(A){console.error("Failed to load options:",A),o([]),u([])}finally{m(!1)}};C();let N=()=>{C()},D=()=>{setTimeout(()=>{try{let P=e.assetType?E.getInstrumentsForAssetType(e.assetType):[];JSON.stringify(P)!==JSON.stringify(d)&&u(P)}catch(P){console.error("Error updating instrument options:",P)}},300)};return document.addEventListener("journalit-options-changed",D,{capture:!1}),document.addEventListener("journalit:account-created",N),document.addEventListener("journalit:account-updated",N),document.addEventListener("journalit:account-deleted",N),()=>{document.removeEventListener("journalit-options-changed",D,{capture:!1}),document.removeEventListener("journalit:account-created",N),document.removeEventListener("journalit:account-updated",N),document.removeEventListener("journalit:account-deleted",N)}},[e.assetType,e.instrument]);let g=T=>!T||!T.length?[]:T.map(E=>a[E]||E),f=T=>!T||!T.length?[]:T.map(E=>l[E]||E),y=async T=>{try{let E=It().plugins.plugins.journalit,C=E?E.optionsService:new En;if(!e.assetType){console.error("Cannot add instrument: No asset type selected");return}await C.addOption("instrument",T,e.assetType)&&C.notifyOptionsChanged()}catch(E){console.error("Failed to save custom instrument option:",E)}};(0,De.useEffect)(()=>{if(!e.instrument||!e.assetType)return;let T=It().plugins.plugins.journalit,E=T?T.optionsService:new En;if(!E.isInstrumentValidForAssetType(e.instrument,e.assetType)){r("instrument","");return}if(e.assetType==="futures"){let N=E.getFuturesDataForInstrument(e.instrument);N?(N.dollarPerPoint!==void 0&&N.dollarPerPoint!==0?r("dollarPerPoint",N.dollarPerPoint):r("dollarPerPoint",void 0),N.tickSize!==void 0&&r("tickSize",N.tickSize),N.tickValue!==void 0&&r("tickValue",N.tickValue)):(r("dollarPerPoint",void 0),r("tickSize",void 0),r("tickValue",void 0))}},[e.instrument,e.assetType]),(0,De.useEffect)(()=>{if(e.assetType!=="futures"||!e.instrument||e.dollarPerPoint===void 0)return;let T=It().plugins.plugins.journalit,E=T?T.optionsService:new En,C=setTimeout(async()=>{try{await E.setFuturesDataForInstrument(e.instrument,{dollarPerPoint:e.dollarPerPoint,tickSize:e.tickSize,tickValue:e.tickValue})}catch(N){console.error("Failed to save futures data for instrument:",N)}},1e3);return()=>clearTimeout(C)},[e.instrument,e.dollarPerPoint,e.tickSize,e.tickValue]);let[h,v]=(0,De.useState)(0),[b,w]=(0,De.useState)(0);(0,De.useEffect)(()=>{v(Ep(e)),w(y_(e))},[e.entryPrice,e.exitPrice,e.positionSize,e.direction,e.commission,e.swap,e.fees,e.directPnL,e.useDirectPnLInput]);let k=e.assetType==="forex"||e.assetType==="cfd",S=()=>{switch(e.assetType){case"stock":return"Shares";case"options":case"futures":return"Contracts";case"forex":return"Lots";case"crypto":return"Amount";case"cfd":return"CFD Units";default:return"Position Size"}},x=()=>{switch(e.assetType){case"stock":return"Ticker";case"options":return"Option Symbol";case"futures":return"Future Symbol";case"forex":return"Forex Pair";case"crypto":return"Crypto Symbol";case"cfd":return"CFD Symbol";default:return"Ticker"}};return De.default.createElement(Cp,{title:"Trade Details"},De.default.createElement("div",{className:"field"},p?De.default.createElement("div",{className:"loading-accounts",style:{padding:"8px 12px",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",color:"var(--text-muted)",backgroundColor:"var(--background-primary)"}},De.default.createElement("div",{style:{marginBottom:"4px"}},"Account"),"Loading accounts..."):De.default.createElement(Os,{label:"Account",options:i,value:Array.isArray(e.account)?e.account:[],onChange:T=>{let E=Array.isArray(T)?[...T]:T?[T]:[],C=g(E);if(r("account",E),r("accountIds",E),E.length===1){let N=a[E[0]];N&&/^\d+$/.test(N)?r("accountId",N):r("accountId",void 0)}else r("accountId",void 0)},error:t.accountIds,allowCreate:!1,isMulti:!0,optionType:"account",required:!e.isMissedTrade,placeholder:"Select accounts"}),!p&&i.length===0&&De.default.createElement("div",{className:"error-message",style:{fontSize:"12px",color:"#e53935",marginTop:"4px"}},"No accounts found. Please create an account in the Accounts tab.")),De.default.createElement("div",{className:"field"},De.default.createElement("label",{className:"label",id:"assetType-label"},"Asset Type",De.default.createElement("span",{className:"required-indicator"},"*")),De.default.createElement("div",{className:"asset-type-container",role:"radiogroup","aria-labelledby":"assetType-label","aria-required":"true"},["stock","options","futures","forex","crypto","cfd"].map(T=>De.default.createElement("button",{key:T,type:"button",className:"asset-type-button",onClick:()=>r("assetType",T),"aria-checked":e.assetType===T,role:"radio"},T==="cfd"?"CFD":T.charAt(0).toUpperCase()+T.slice(1)))),t.assetType&&De.default.createElement("div",{className:"errorMessage",role:"alert"},t.assetType)),De.default.createElement("div",{className:"field"},De.default.createElement(Os,{label:x(),options:d,value:e.instrument||"",onChange:T=>r("instrument",T),error:t.instrument,allowCreate:!0,isMulti:!1,optionType:"instrument",onSaveOption:y,required:!0})),e.assetType&&De.default.createElement("div",{className:"asset-specific-fields"},e.assetType==="stock"&&De.default.createElement(T_,{data:e,errors:t,onChange:r}),e.assetType==="options"&&De.default.createElement(E_,{data:e,errors:t,onChange:r}),e.assetType==="futures"&&De.default.createElement(D_,{data:e,errors:t,onChange:r}),e.assetType==="forex"&&De.default.createElement(P_,{data:e,errors:t,onChange:r}),e.assetType==="crypto"&&De.default.createElement(A_,{data:e,errors:t,onChange:r}),e.assetType==="cfd"&&De.default.createElement(N_,{data:e,errors:t,onChange:r})),e.assetType!=="options"&&De.default.createElement("div",{className:"field"},De.default.createElement("label",{className:"label",id:"direction-label"},"Direction",De.default.createElement("span",{className:"required-indicator"},"*")),De.default.createElement("div",{className:"direction-container",role:"radiogroup","aria-labelledby":"direction-label","aria-required":"true"},De.default.createElement("button",{type:"button",className:"direction-button",onClick:()=>r("direction","long"),"aria-checked":e.direction==="long",role:"radio"},"Long"),De.default.createElement("button",{type:"button",className:"direction-button",onClick:()=>r("direction","short"),"aria-checked":e.direction==="short",role:"radio"},"Short")),t.direction&&De.default.createElement("div",{className:"errorMessage",role:"alert"},t.direction)),De.default.createElement("div",{className:"field"},De.default.createElement(I_,{data:e,errors:t,onChange:r})),De.default.createElement("div",{className:"trading-costs-section"},De.default.createElement("h4",{className:"section-title"},"Trading Costs"),De.default.createElement("div",{className:`cost-fields ${k?"three-column":"two-column"}`},De.default.createElement("div",{className:"field"},De.default.createElement(sr,{label:"Commission",value:e.commission,onChange:T=>r("commission",T),error:t.commission,min:0,precision:2,allowDecimal:!0,placeholder:"Broker commission"})),k&&De.default.createElement("div",{className:"field"},De.default.createElement(sr,{label:"Swap",value:e.swap,onChange:T=>r("swap",T),error:t.swap,precision:2,allowDecimal:!0,placeholder:"Overnight financing"})),De.default.createElement("div",{className:"field"},De.default.createElement(sr,{label:"Other Fees",value:e.fees,onChange:T=>r("fees",T),error:t.fees,min:0,precision:2,allowDecimal:!0,placeholder:"Platform/regulatory fees"})))),e.entryPrice!==void 0&&e.exitPrice!==void 0&&e.positionSize!==void 0&&e.direction!==void 0&&De.default.createElement("div",{className:"calculatedValue"},De.default.createElement("span",{className:"calculatedLabel"},"Profit/Loss",e.commission||e.swap||e.fees?" (incl. costs)":""),De.default.createElement("span",{className:`calculatedAmount ${h>0?"positive":h<0?"negative":"neutral"}`},fe(h)),!e.useDirectPnLInput&&De.default.createElement("span",{className:"calculatedLabel"},"(",b.toFixed(2),"%)"),e.commission||e.swap||e.fees?De.default.createElement("span",{className:"calculatedLabel"},"Total Costs: ",fe((e.commission||0)+(e.swap||0)+(e.fees||0))):null))};var Br=$(W());var j_=({data:e,errors:t,onChange:r,accounts:n=[],setups:i=[],mistakes:o=[]})=>{let[a,s]=(0,Br.useState)(0),l=(0,Br.useMemo)(()=>{let y=It().plugins.plugins.journalit;return y&&y.optionsService?y.optionsService:new En},[]),c=(0,Br.useMemo)(()=>{try{return l.getOptions("tag")}catch(y){return console.error("Failed to load custom tag options:",y),[]}},[l,a]),d=(0,Br.useMemo)(()=>{try{return l.getOptions("setup")}catch(y){return console.error("Failed to load setup options:",y),[]}},[l,a]),u=(0,Br.useMemo)(()=>{try{return l.getOptions("mistake")}catch(y){return console.error("Failed to load mistake options:",y),[]}},[l,a]),p=(0,Br.useCallback)(()=>{s(y=>y+1)},[]);(0,Br.useEffect)(()=>(document.addEventListener("journalit-options-changed",p),()=>{document.removeEventListener("journalit-options-changed",p)}),[p]);let m=async y=>{try{let h=It().plugins.plugins.journalit,v=h?h.optionsService:new En;await v.addOption("tag",y)&&v.notifyOptionsChanged()}catch(h){console.error("Failed to save custom tag option:",h)}},g=async y=>{try{let h=It().plugins.plugins.journalit,v=h?h.optionsService:new En;await v.addOption("setup",y)&&v.notifyOptionsChanged()}catch(h){console.error("Failed to save custom setup option:",h)}},f=async y=>{try{let h=It().plugins.plugins.journalit,v=h?h.optionsService:new En;await v.addOption("mistake",y)&&v.notifyOptionsChanged()}catch(h){console.error("Failed to save custom mistake option:",h)}};return Br.default.createElement(Cp,{title:"Analysis & Thesis"},Br.default.createElement("div",{className:"field"},Br.default.createElement(Os,{label:"Setup",options:d,value:Array.isArray(e.setup)?e.setup:[],onChange:y=>{let h=Array.isArray(y)?y:[];r("setup",h)},allowCreate:!0,isMulti:!0,optionType:"setup",onSaveOption:g})),Br.default.createElement("div",{className:"field"},Br.default.createElement(Os,{label:"Mistake",options:u,value:Array.isArray(e.mistake)?e.mistake:[],onChange:y=>{let h=Array.isArray(y)?y:[];r("mistake",h)},allowCreate:!0,isMulti:!0,optionType:"mistake",onSaveOption:f})),Br.default.createElement("div",{className:"field"},Br.default.createElement(Os,{label:"Custom Tags",options:c,value:Array.isArray(e.ctags)?e.ctags:[],onChange:y=>{let h=Array.isArray(y)?y:[];r("ctags",h)},isMulti:!0,allowCreate:!0,placeholder:"Type a custom tag and press Enter",onSaveOption:m,optionType:"tag"})),Br.default.createElement("div",{className:"field"},Br.default.createElement(Mr,{label:"Trade Thesis",placeholder:"Enter your thesis for this trade...",value:e.thesis||"",onChange:y=>r("thesis",y),className:"thesisField",multiline:!0})))};var Sc=$(W());var Ft=$(W());var js=require("obsidian");var uE=class{constructor(t){this.app=t||It()}async saveImage(t,r,n,i){try{let o=t!=null&&t.name?t.name.replace(/[^a-zA-Z0-9.-]/g,"_"):"unnamed_file",a=o.substring(o.lastIndexOf(".")||o.length),s=Date.now(),l;if(i){let{year:d,month:u,weekOfMonth:p}=i,m=`${r}/${d}/${u}/${p}`,g=`${n}-${s}${a}`;l=`${m}/${g}`,await this.app.vault.adapter.mkdir((0,js.normalizePath)(m))}else{let d=`${n}-${s}${a}`;l=`${r}/${d}`,await this.app.vault.adapter.mkdir((0,js.normalizePath)(r))}let c=await t.arrayBuffer();return await this.app.vault.createBinary((0,js.normalizePath)(l),c),l}catch(o){throw console.error("Error saving image:",o),o}}async deleteImage(t,r=!0){try{if(!t){console.warn("No image path provided for deletion");return}let n=this.app.vault.getAbstractFileByPath(t);if(!n){console.warn(`Image file not found: ${t}`);return}if(await this.app.vault.delete(n),r){let i=t.substring(0,t.lastIndexOf("/"));await this.deleteEmptyFolder(i)}}catch(n){throw console.error(`Error deleting image ${t}:`,n),n}}async deleteEmptyFolder(t,r="!"){try{if(t.startsWith(r)&&t.split("/").length<=1||!await this.app.vault.adapter.exists(t))return;let i=await this.app.vault.adapter.list(t);if(i.files.length===0&&i.folders.length===0){let o=this.app.vault.getAbstractFileByPath(t);if(o){await this.app.vault.delete(o);let a=t.substring(0,t.lastIndexOf("/"));a&&a.length>0&&!a.startsWith(r)&&await this.deleteEmptyFolder(a,r)}}}catch(n){console.error(`Error deleting empty folder ${t}:`,n)}}resolveMediaPath(t){if(!t)return"";try{let r=this.getResourceUrl(t);if(r&&r!==t&&!r.includes("app://obsidian.md"))return r;let n="",i="",o=t.split("/"),a=o.findIndex(s=>s==="media"||s==="attachments");if(a>=0&&a<o.length-1&&(o[a]==="attachments"&&o.length>a+5?(n=o.slice(a+1,o.length-1).join("/"),i=o[o.length-1]):a<o.length-2&&(n=o[a+1],i=o[o.length-1])),n&&i){let s=[t.startsWith("!")?t.substring(1):t,t,`attachments/${n}/${i}`,`${this.app.vault.getName()}/attachments/${n}/${i}`,`${this.app.vault.getName()}/${o.slice(1).join("/")}`,`Journalit/${o.slice(o.indexOf("Journalit")+1).join("/")}`,`${this.app.vault.getName()}/media/${n}/${i}`,`media/${n}/${i}`];for(let l of s){let c=this.app.vault.getAbstractFileByPath(l);if(c&&c instanceof js.TFile)return this.app.vault.getResourcePath(c)}}return r}catch(r){return console.error("Error resolving media path:",r,t),this.getResourceUrl(t)}}getResourceUrl(t){if(!t)return"";try{if(t.startsWith("http://")||t.startsWith("https://")||t.startsWith("data:"))return t;let r=this.app,n=r.vault.getAbstractFileByPath(t);if(n&&n instanceof js.TFile)return r.vault.getResourcePath(n);if(t.startsWith("!")){let a=t.substring(1);if(n=r.vault.getAbstractFileByPath(a),n&&n instanceof js.TFile)return r.vault.getResourcePath(n)}let i=/\/media\/([^/]+)\//,o=t.match(i);if(o){let a=o[1],s=/(20\d{2})\/(\d{2})\/(W\d+)\//,l=t.match(s);if(l){let c=l[1],d=l[2],u=l[3],p=[`${c}/${d}/${u}/media/${a}${t.substring(t.lastIndexOf("/"))}`];for(let m of p)if(n=r.vault.getAbstractFileByPath(m),n&&n instanceof js.TFile)return r.vault.getResourcePath(n)}}try{let a=r.vault.getName();if(a){let s=[t.startsWith("!")?`${a}/${t.substring(1)}`:`${a}/${t}`,`${a}/${t}`];for(let l of s)if(n=r.vault.getAbstractFileByPath(l),n&&n instanceof js.TFile)return r.vault.getResourcePath(n)}}catch(a){}return t.startsWith("!")?`app://obsidian.md/${t.substring(1)}`:`app://obsidian.md/${t}`}catch(r){return console.error("Error getting resource URL:",r),t||""}}getImagesFromDataTransfer(t){try{return!t.files||t.files.length===0?[]:Array.from(t.files).filter(i=>i.type.startsWith("image/")||i.name.match(/\.(jpg|jpeg|png|gif|bmp|webp)$/i))}catch(r){return console.error("Error extracting images from drop event:",r),[]}}},lr=new uE;var ch=require("obsidian"),Pn=class{static isClipboardSupported(){return typeof navigator!="undefined"&&!!navigator.clipboard&&!!navigator.clipboard.read}static async extractClipboardImages(){if(!this.isClipboardSupported())return{success:!1,files:[],error:"Clipboard API not supported in this environment"};try{let t=await navigator.clipboard.read();if(!t||t.length===0)return{success:!1,files:[],error:"No items in clipboard"};let r=[];for(let n of t)for(let i of this.SUPPORTED_FORMATS)if(n.types.includes(i))try{let o=await n.getType(i);if(o.size>this.MAX_FILE_SIZE){new ch.Notice(`Image too large (${(o.size/1024/1024).toFixed(1)}MB). Maximum size is 10MB.`);continue}let a=new File([o],this.generateFileName(i),{type:i,lastModified:Date.now()});r.push(a)}catch(o){console.error(`Failed to extract ${i} from clipboard:`,o)}return r.length===0?{success:!1,files:[],error:"No images found in clipboard"}:{success:!0,files:r}}catch(t){return console.error("Failed to read clipboard:",t),t.name==="NotAllowedError"||t.message.includes("permission")?{success:!1,files:[],error:"Permission denied. Please allow clipboard access.",permissionDenied:!0}:{success:!1,files:[],error:`Failed to access clipboard: ${t.message}`}}}static generateContextualFileName(t,r,n=0){var s,l,c,d,u;let i=Date.now(),o=this.getExtensionFromFormat(r);switch(t.contextType){case"trade":if((s=t.contextData)!=null&&s.ticker&&((l=t.contextData)!=null&&l.tradeNumber)){let m=n>0?`-${n}`:"";return`${t.contextData.ticker}-clipboard-T${t.contextData.tradeNumber}${m}-${i}${o}`}break;case"drc":if((c=t.contextData)!=null&&c.sectionName){let m=n>0?`-${n}`:"";return`drc-${t.contextData.sectionName}-clipboard${m}-${i}${o}`}break;case"weekly":if((d=t.contextData)!=null&&d.weekNumber){let m=n>0?`-${n}`:"";return`weekly-W${t.contextData.weekNumber}-clipboard${m}-${i}${o}`}break;case"account":if((u=t.contextData)!=null&&u.accountId){let m=n>0?`-${n}`:"";return`account-${t.contextData.accountId}-clipboard${m}-${i}${o}`}break;case"generic":default:return`clipboard-image${n>0?`-${n}`:""}-${i}${o}`}return`clipboard-image${n>0?`-${n}`:""}-${i}${o}`}static generateFileName(t){let r=Date.now(),n=this.getExtensionFromFormat(t);return`clipboard-image-${r}${n}`}static getExtensionFromFormat(t){switch(t){case"image/png":return".png";case"image/jpeg":return".jpg";case"image/gif":return".gif";case"image/bmp":return".bmp";case"image/webp":return".webp";default:return".png"}}static findImageUploadContext(t){if(!t)return null;let r=t.closest(".journalit-image-upload, .shared-forecast-image, .trade-form-metadata");if(!r)return null;if(r.classList.contains("trade-form-metadata"))return{contextType:"trade",multiple:!0};if(r.classList.contains("shared-forecast-image")){let n=r.closest("[data-section-name]");if(n)return{contextType:"drc",contextData:{sectionName:n.getAttribute("data-section-name")||void 0},multiple:!1}}return{contextType:"generic",multiple:!0}}static showPasteResult(t,r=0){if(t.success&&r>0){let n=r===1?"Image pasted successfully":`${r} images pasted successfully`;new ch.Notice(n)}else!t.success&&t.error&&(t.permissionDenied?new ch.Notice("Clipboard access denied. Please allow clipboard permissions for paste functionality."):new ch.Notice(`Paste failed: ${t.error}`))}static createContextualFiles(t,r){return t.map((n,i)=>{let o=this.generateContextualFileName(r,n.type,i);return new File([n],o,{type:n.type,lastModified:n.lastModified})})}};Pn.MAX_FILE_SIZE=10*1024*1024,Pn.SUPPORTED_FORMATS=["image/png","image/jpeg","image/gif","image/bmp","image/webp"];var pE=require("obsidian");var fw=class fw{constructor(){this.handlers=[];this.enabled=!1;this.globalPasteListener=null;this.lastMousePosition={x:0,y:0};this.mouseMoveListener=null}static getInstance(){return this.instance||(this.instance=new fw),this.instance}initialize(){this.enabled||(this.enabled=!0,this.globalPasteListener=t=>{this.handleGlobalPaste(t)},this.mouseMoveListener=t=>{this.lastMousePosition={x:t.clientX,y:t.clientY}},document.addEventListener("paste",this.globalPasteListener,!0),document.addEventListener("mousemove",this.mouseMoveListener,!0))}cleanup(){this.enabled&&(this.enabled=!1,this.globalPasteListener&&(document.removeEventListener("paste",this.globalPasteListener,!0),this.globalPasteListener=null),this.mouseMoveListener&&(document.removeEventListener("mousemove",this.mouseMoveListener,!0),this.mouseMoveListener=null),this.handlers=[])}registerHandler(t){this.handlers=this.handlers.filter(r=>r.id!==t.id),this.handlers.push(t)}unregisterHandler(t){this.handlers=this.handlers.filter(r=>r.id!==t)}async handleGlobalPaste(t){if(!Pn.isClipboardSupported())return;let r=document.activeElement;if(this.isTextInput(r)&&!this.isImageUploadArea(r))return;let n=this.findHandlerForContext(r);if(!n){try{let i=await Pn.extractClipboardImages();i.success&&i.files.length>0&&(this.handlers.some(a=>{let s=a.element.getBoundingClientRect();return s.width>0&&s.height>0&&window.getComputedStyle(a.element).visibility!=="hidden"&&window.getComputedStyle(a.element).display!=="none"})||new pE.Notice("No image upload area found. Focus on an image upload area to paste images."))}catch(i){}return}t.preventDefault(),t.stopPropagation();try{let i=await Pn.extractClipboardImages();if(!i.success){i.error&&!i.error.includes("No images found")&&Pn.showPasteResult(i);return}let o=Pn.createContextualFiles(i.files,n.context),a=n.acceptsMultiple?o:[o[0]];await n.handlePaste(a),Pn.showPasteResult(i,a.length),this.dispatchPasteEvent({files:a,context:{element:n.element,contextType:n.context.contextType,contextData:n.context.contextData},success:!0})}catch(i){console.error("Global paste handler error:",i),this.dispatchPasteEvent({files:[],context:{element:n.element,contextType:n.context.contextType,contextData:n.context.contextData},success:!1,error:i.message}),new pE.Notice(`Paste failed: ${i.message}`)}}findHandlerForContext(t){if(t){for(let a of this.handlers)if(a.element.contains(t)||a.element===t)return a;let o=this.findNearbyImageUploadArea(t);if(o)return this.handlers.find(a=>a.element===o||a.element.contains(o))||null}let r=this.findHandlerUnderMouse();if(r)return r;let n=this.handlers.filter(o=>{let a=o.element,s=a.getBoundingClientRect();return s.width>0&&s.height>0&&window.getComputedStyle(a).visibility!=="hidden"&&window.getComputedStyle(a).display!=="none"});if(n.length===1)return n[0];let i=this.findHoveredHandler();return i||null}isTextInput(t){var i;if(!t)return!1;let r=t.tagName.toLowerCase(),n=(i=t.type)==null?void 0:i.toLowerCase();return r==="input"&&["text","email","password","search","url"].includes(n)||r==="textarea"||t.hasAttribute("contenteditable")||t.classList.contains("cm-editor")}isImageUploadArea(t){return t?!!(t.closest(".journalit-image-upload")||t.closest(".shared-forecast-image")||t.closest(".trade-form-metadata")||t.closest("[data-image-upload]")):!1}findHandlerUnderMouse(){let t=document.elementsFromPoint(this.lastMousePosition.x,this.lastMousePosition.y);for(let r of t)for(let n of this.handlers)if(n.element===r||n.element.contains(r))return n;return null}findHoveredHandler(){for(let t of this.handlers){let n=t.element.getBoundingClientRect();if(n.width>0&&n.height>0&&this.lastMousePosition.x>=n.left&&this.lastMousePosition.x<=n.right&&this.lastMousePosition.y>=n.top&&this.lastMousePosition.y<=n.bottom)return t}return null}findNearbyImageUploadArea(t){if(!t)return null;let r=t.closest(".trade-form, .drc-note, .weekly-review, .account-note, .modal-content, .workspace-leaf-content");return r?r.querySelector(".journalit-image-upload, .shared-forecast-image, .trade-form-metadata"):null}dispatchPasteEvent(t){let r=new CustomEvent("journalit:paste",{detail:t,bubbles:!0,cancelable:!1});document.dispatchEvent(r)}static createImageUploaderHandler(t,r,n,i=!0){return{id:`image-uploader-${Date.now()}-${Math.random().toString(36).substring(2,11)}`,element:t,context:r,handlePaste:n,acceptsMultiple:i}}static isPasteSupported(){return Pn.isClipboardSupported()}getDebugInfo(){return{enabled:this.enabled,handlerCount:this.handlers.length,handlers:this.handlers.map(t=>({id:t.id,contextType:t.context.contextType,acceptsMultiple:t.acceptsMultiple}))}}};fw.instance=null;var wl=fw;var Dd=({onImageUploaded:e,onMultipleImagesUploaded:t,onError:r,label:n="Upload Image",enableDragDrop:i=!0,draggingOverClass:o="dragging-over",inputId:a,saveImageFunction:s,multiple:l=!0,enablePaste:c=!1,pasteContext:d,className:u="",style:p})=>{let m=(0,Ft.useRef)(`image-upload-${Math.random().toString(36).substring(2,11)}`),g=a||m.current,[f,y]=(0,Ft.useState)(!1),h=(0,Ft.useRef)(0),v=(0,Ft.useRef)(null),[b,w]=(0,Ft.useState)(!1),[k,S]=(0,Ft.useState)(!1),x=(0,Ft.useRef)(new Set),T=(0,Ft.useRef)(s),E=(0,Ft.useRef)(e),C=(0,Ft.useRef)(t),N=(0,Ft.useRef)(r),D=(0,Ft.useRef)(void 0);(0,Ft.useEffect)(()=>{T.current=s,E.current=e,C.current=t,N.current=r},[s,e,t,r]),(0,Ft.useEffect)(()=>()=>{x.current.forEach(_=>{URL.revokeObjectURL(_)}),x.current.clear()},[]);let A=(0,Ft.useCallback)(async()=>{if(!(!c||b)){w(!0);try{let _=await Pn.extractClipboardImages();if(!_.success){_.error&&!_.error.includes("No images found")&&Pn.showPasteResult(_);return}let H=d||{contextType:"generic",multiple:l},q=Pn.createContextualFiles(_.files,H),X=[],U=l?q:[q[0]];for(let Y of U)try{let R;T.current?(R=await T.current(Y),X.push(R)):(console.warn("No saveImageFunction provided, using placeholder implementation"),R=P(Y),X.push(R))}catch(R){console.error(`Failed to process pasted image ${Y.name}:`,R),N.current&&R instanceof Error&&N.current(R)}l&&X.length>1&&C.current?C.current(X):X.length>0&&E.current&&E.current(X[0]),Pn.showPasteResult(_,X.length)}catch(_){console.error("Failed to handle paste:",_),N.current&&_ instanceof Error&&N.current(_)}finally{w(!1)}}},[c,b,d,l]);(0,Ft.useEffect)(()=>{D.current=A},[A]),(0,Ft.useEffect)(()=>{if(!c||!v.current||!Pn.isClipboardSupported())return;if(S(!0),(d==null?void 0:d.contextType)==="trade"){let H=d||{contextType:"generic",multiple:l},q=wl.createImageUploaderHandler(v.current,H,async X=>{let U=[];for(let Y of X)try{let R;T.current?(R=await T.current(Y),U.push(R)):(console.warn("No saveImageFunction provided, using placeholder implementation"),R=P(Y),U.push(R))}catch(R){console.error(`Failed to process pasted image ${Y.name}:`,R),N.current&&R instanceof Error&&N.current(R)}l&&U.length>1&&C.current?C.current(U):U.length>0&&E.current&&E.current(U[0])},l);return wl.getInstance().registerHandler(q),()=>{wl.getInstance().unregisterHandler(q.id)}}else{let H=X=>{var U;X.preventDefault(),X.stopPropagation(),(U=D.current)==null||U.call(D)},q=v.current;return q.addEventListener("paste",H),()=>{q.removeEventListener("paste",H)}}},[c,d,l]);let P=_=>{let H=URL.createObjectURL(_);return x.current.add(H),H},I=async _=>{try{let H=_.target.files;if(!H||H.length===0)return;let q=[],X=l?H:[H[0]];for(let U=0;U<X.length;U++){let Y=X[U],R;if(s)try{R=await s(Y),q.push(R)}catch(V){console.error(`Failed to process image ${Y.name}:`,V),r&&V instanceof Error&&r(V)}else console.warn("No saveImageFunction provided, using placeholder implementation"),R=P(Y),q.push(R)}l&&q.length>1&&t?t(q):q.length>0&&e(q[0]),_.target.value=""}catch(H){console.error("Failed to process images:",H),r&&H instanceof Error&&r(H)}},M=_=>{i&&(_.preventDefault(),_.stopPropagation(),h.current++,_.dataTransfer.types.includes("Files")&&y(!0))},O=_=>{i&&(_.preventDefault(),_.stopPropagation(),h.current--,h.current<=0&&(h.current=0,y(!1)))},F=_=>{i&&(_.preventDefault(),_.stopPropagation())},L=async _=>{if(i&&(_.preventDefault(),_.stopPropagation(),h.current=0,y(!1),_.dataTransfer.files&&_.dataTransfer.files.length>0)){let H=lr.getImagesFromDataTransfer(_.dataTransfer);if(H.length>0){let q=[],X=l?H:[H[0]];for(let U of X)try{let Y;s?(Y=await s(U),q.push(Y)):(console.warn("No saveImageFunction provided, using placeholder implementation"),Y=P(U),q.push(Y))}catch(Y){console.error(`Failed to process dropped image ${U.name}:`,Y),r&&Y instanceof Error&&r(Y)}l&&q.length>1&&t?t(q):q.length>0&&e(q[0])}}},B=()=>{let _=document.getElementById(g);_&&_.click()},j=["journalit-image-upload",u,f?o:""].filter(Boolean).join(" ");return Ft.default.createElement("div",{ref:v,className:j,onClick:B,onDragEnter:M,onDragLeave:O,onDragOver:F,onDrop:L,style:p,tabIndex:c?0:-1},Ft.default.createElement("div",{className:"journalit-image-upload-header"},Ft.default.createElement("label",{className:"journalit-image-upload-label"},n),c&&k&&Ft.default.createElement("button",{type:"button",className:`journalit-image-upload-paste-btn ${b?"pasting":""}`,onClick:_=>{_.preventDefault(),_.stopPropagation(),A()},disabled:b,title:"Paste image from clipboard (Ctrl+V)"},b?Ft.default.createElement("span",{className:"journalit-spinner"}):Ft.default.createElement("span",{className:"paste-icon"},"\u{1F4CB}"),b?"Pasting...":"Paste")),Ft.default.createElement("input",{id:g,type:"file",accept:"image/*",multiple:l,onChange:I,className:"journalit-image-upload-input"}))};var un=$(W());var Ji=$(W()),L_=$(ul()),Ka=({isOpen:e,children:t,portalId:r="journalit-fullscreen-portal",onClose:n,title:i="Image Preview",className:o=""})=>{let[a,s]=(0,Ji.useState)(null),l=(0,Ji.useRef)(null),c=(0,Ji.useRef)(e);if(c.current=e,(0,Ji.useEffect)(()=>{if(!e)return;let u=document.getElementById(r);u||(u=document.createElement("div"),u.id=r,u.style.position="fixed",u.style.top="0",u.style.left="0",u.style.width="0",u.style.height="0",u.style.zIndex="4000",u.style.pointerEvents="none",document.body.appendChild(u)),s(u),l.current=u;let p=m=>{m.key==="Escape"&&(m.preventDefault(),m.stopPropagation(),m.stopImmediatePropagation(),n())};return document.addEventListener("keydown",p),()=>{document.removeEventListener("keydown",p),!c.current&&u&&u.parentNode&&setTimeout(()=>{let m=document.getElementById(r);if(m&&m.parentNode&&m.childNodes.length===0)try{m.parentNode.removeChild(m)}catch(g){console.error(`[FullscreenPortal] Error removing portal element ${r}:`,g)}},0)}},[e,r,n]),!e||!a)return null;let d=["journalit-fullscreen-overlay",o].filter(Boolean).join(" ");return L_.default.createPortal(Ji.default.createElement("div",{className:d,onClick:n,style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",backgroundColor:"rgba(0, 0, 0, 0.9)",zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"auto"}},Ji.default.createElement("div",{className:"journalit-fullscreen-overlay-ui"},Ji.default.createElement("div",{className:"journalit-fullscreen-title",onClick:u=>u.stopPropagation()},i),Ji.default.createElement("button",{className:"journalit-fullscreen-close-btn",onClick:u=>{u.stopPropagation(),n()},"aria-label":"Close fullscreen"},"\xD7")),Ji.default.createElement("div",{className:"journalit-fullscreen-content-wrapper",style:{width:"100vw",height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",overflow:"hidden",pointerEvents:"none"}},Ji.default.createElement("div",{onClick:u=>u.stopPropagation(),style:{pointerEvents:"auto"}},t))),a)};var Zt=$(W());var kc=({imagePath:e,alt:t="Image",useResolveMediaPath:r=!1,navigationContext:n,onClose:i})=>{let[o,a]=(0,Zt.useState)({isZoomed:!1,panOffset:{x:0,y:0},isPanning:!1,lastMousePos:{x:0,y:0}}),s=(0,Zt.useRef)(null),l=(0,Zt.useRef)(null),c=r?lr.resolveMediaPath(e):lr.getResourceUrl(e);(0,Zt.useEffect)(()=>{a({isZoomed:!1,panOffset:{x:0,y:0},isPanning:!1,lastMousePos:{x:0,y:0}})},[e]);let d=(0,Zt.useCallback)(b=>{b.preventDefault(),b.stopPropagation(),!o.isPanning&&a(w=>({...w,isZoomed:!w.isZoomed,panOffset:{x:0,y:0},isPanning:!1}))},[o.isPanning]),u=(0,Zt.useCallback)(b=>{o.isZoomed&&(b.preventDefault(),b.stopPropagation(),a(w=>({...w,isPanning:!0,lastMousePos:{x:b.clientX,y:b.clientY}})))},[o.isZoomed]),p=(0,Zt.useCallback)(()=>{a(b=>({...b,isPanning:!1}))},[]),m=(0,Zt.useCallback)(b=>{if(!n)return;let{images:w,currentIndex:k,onNavigate:S}=n,x=k;b==="prev"?x=k===0?w.length-1:k-1:x=k===w.length-1?0:k+1,S(x)},[n]);(0,Zt.useEffect)(()=>{let b=w=>{w.key==="ArrowLeft"?(w.preventDefault(),w.stopPropagation(),m("prev")):w.key==="ArrowRight"&&(w.preventDefault(),w.stopPropagation(),m("next"))};return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[m]);let g=(0,Zt.useCallback)(b=>{a(w=>{if(!w.isPanning||!w.isZoomed)return w;let k=b.clientX-w.lastMousePos.x,S=b.clientY-w.lastMousePos.y,x=.8,T=k*x,E=S*x;return{...w,panOffset:{x:w.panOffset.x+T,y:w.panOffset.y+E},lastMousePos:{x:b.clientX,y:b.clientY}}})},[]),f=(0,Zt.useCallback)(()=>{a(b=>({...b,isPanning:!1}))},[]);(0,Zt.useEffect)(()=>{if(o.isPanning)return document.addEventListener("mousemove",g),document.addEventListener("mouseup",f),()=>{document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",f)}},[o.isPanning,g,f]);let y=o.isZoomed?2:1,h=`scale(${y}) translate(${o.panOffset.x/y}px, ${o.panOffset.y/y}px)`,v="zoom-in";return o.isZoomed&&(v=o.isPanning?"grabbing":"grab"),Zt.default.createElement("div",{className:"journalit-fullscreen-viewer",ref:l},n&&n.images.length>1&&Zt.default.createElement(Zt.default.Fragment,null,Zt.default.createElement("button",{className:"journalit-fullscreen-nav-btn journalit-fullscreen-nav-prev",onClick:()=>m("prev"),"aria-label":"Previous image",type:"button"},"\u2039"),Zt.default.createElement("button",{className:"journalit-fullscreen-nav-btn journalit-fullscreen-nav-next",onClick:()=>m("next"),"aria-label":"Next image",type:"button"},"\u203A")),Zt.default.createElement("div",{className:"journalit-fullscreen-image-wrapper"},Zt.default.createElement("img",{ref:s,src:c,alt:t,className:"journalit-fullscreen-zoomable-image",onClick:d,onMouseDown:u,onMouseUp:p,onMouseLeave:p,style:{transform:h,cursor:v,transition:o.isPanning?"none":"transform 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94)",willChange:o.isPanning?"transform":"auto"}})),Zt.default.createElement("div",{className:"journalit-fullscreen-zoom-indicator"},o.isZoomed?"Click to zoom out":"Click to zoom in"),n&&n.images.length>1&&Zt.default.createElement("div",{className:"journalit-fullscreen-nav-indicator"},n.currentIndex+1," / ",n.images.length))};var dh=({imagePath:e,alt:t="Image",enableFullscreen:r=!0,description:n="Image Preview",showDeleteButton:i=!1,onDelete:o,onError:a,width:s,height:l,fullscreenPortalId:c="journalit-fullscreen-portal",fullscreenClassName:d="",className:u="",style:p,useResolveMediaPath:m=!1})=>{let[g,f]=(0,un.useState)({isFullscreen:!1,holdTimerId:null,hasError:!1}),y=(0,un.useRef)(null),h=500;(0,un.useEffect)(()=>()=>{y.current!==null&&window.clearTimeout(y.current)},[]);let v=m?lr.resolveMediaPath(e):lr.getResourceUrl(e),b=()=>{f(C=>({...C,hasError:!0})),a&&a()},w=()=>{r&&f(C=>({...C,isFullscreen:!0}))},k=()=>{f(C=>({...C,isFullscreen:!1}))},S=()=>{r&&(y.current!==null&&(window.clearTimeout(y.current),y.current=null),y.current=window.setTimeout(()=>{w()},h))},x=()=>{y.current!==null&&(window.clearTimeout(y.current),y.current=null)},T=C=>{C.preventDefault(),C.stopPropagation(),o&&o(C)},E=["journalit-image-viewer",u].filter(Boolean).join(" ");return un.default.createElement(un.default.Fragment,null,un.default.createElement("div",{className:E,style:p},un.default.createElement("div",{className:"journalit-image-container"},g.hasError?un.default.createElement("div",{className:"journalit-image-error"},"Unable to load image. The file might be missing or inaccessible."):un.default.createElement(un.default.Fragment,null,un.default.createElement("img",{src:v,alt:t,className:"journalit-image",onError:b,onMouseDown:S,onMouseUp:x,onMouseLeave:x,onTouchStart:S,onTouchEnd:x,onTouchCancel:x,onClick:()=>{x(),w()},style:{cursor:r?"zoom-in":"default",width:s,height:l},title:r?"Click to view fullscreen":t}),r&&un.default.createElement("div",{className:"journalit-image-zoom-indicator"},"Click or hold to enlarge")),i&&un.default.createElement("button",{className:"journalit-image-delete-button",onClick:T,type:"button"},"Delete Image"))),un.default.createElement(Ka,{isOpen:g.isFullscreen,onClose:k,title:n,portalId:c,className:d},un.default.createElement(kc,{imagePath:e,alt:t,useResolveMediaPath:m,onClose:k})))};var er=$(W());var Ni=$(W());var __=({src:e,alt:t,className:r="",placeholderClassName:n="",style:i,useResolveMediaPath:o=!1,loadingPlaceholder:a,errorPlaceholder:s,rootMargin:l="50px",threshold:c=.1})=>{let[d,u]=(0,Ni.useState)(!1),[p,m]=(0,Ni.useState)(!1),[g,f]=(0,Ni.useState)(!1),y=(0,Ni.useRef)(null);(0,Ni.useEffect)(()=>{let w=y.current;if(!w)return;let k=new IntersectionObserver(S=>{let[x]=S;x.isIntersecting&&(u(!0),k.disconnect())},{rootMargin:l,threshold:c});return k.observe(w),()=>k.disconnect()},[l,c]);let h=d?o?lr.resolveMediaPath(e):lr.getResourceUrl(e):"",v=()=>{m(!0),f(!1)},b=()=>{f(!0),m(!1)};return Ni.default.createElement("div",{ref:y,className:`lazy-image-container ${r}`,style:{position:"relative",overflow:"hidden",...i}},(!d||!p)&&!g&&Ni.default.createElement("div",{className:`lazy-image-placeholder ${n}`},a||Ni.default.createElement("div",{style:{width:"100%",height:"100%",backgroundColor:"var(--background-modifier-border)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--text-muted)",fontSize:"12px"}},"Loading...")),g&&Ni.default.createElement("div",{className:`lazy-image-error ${n}`},s||Ni.default.createElement("div",{style:{width:"100%",height:"100%",backgroundColor:"var(--background-modifier-error)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--text-error)",fontSize:"12px"}},"Failed to load image")),d&&!g&&Ni.default.createElement("img",{src:h,alt:t,onLoad:v,onError:b,style:{position:"absolute",top:0,left:0,opacity:p?1:0,transition:"opacity 0.3s ease",width:"100%",height:"100%",objectFit:"cover"},className:"lazy-image-loaded"}))};var Pd=({images:e,altPrefix:t="Image",showThumbnails:r=!0,showCounter:n=!0,enableDelete:i=!1,onDeleteImage:o,enableFullscreen:a=!0,className:s="",style:l,useResolveMediaPath:c=!1})=>{let[d,u]=(0,er.useState)(0),[p,m]=(0,er.useState)(!1),[g,f]=(0,er.useState)(!1);(0,er.useEffect)(()=>{e&&e.length>0&&d>=e.length&&u(Math.max(0,e.length-1))},[e,d]);let y=D=>{D.preventDefault(),D.stopPropagation(),!(e.length<=1)&&u(A=>A===e.length-1?0:A+1)},h=D=>{D.preventDefault(),D.stopPropagation(),!(e.length<=1)&&u(A=>A===0?e.length-1:A-1)},v=(D,A)=>{A.preventDefault(),A.stopPropagation(),D>=0&&D<e.length&&u(D)},b=(D,A)=>{A&&(A.preventDefault(),A.stopPropagation()),o&&e[D]&&o(D,e[D])},w=()=>{m(!0)},k=()=>{a&&f(!0)},S=()=>{f(!1)},T={images:e,currentIndex:d,onNavigate:D=>{D>=0&&D<e.length&&u(D)},altPrefix:t,useResolveMediaPath:c},E=["journalit-image-carousel",s].filter(Boolean).join(" ");if(!e||e.length===0)return er.default.createElement("div",{className:E,style:l},er.default.createElement("div",{className:"journalit-carousel-main"},er.default.createElement("div",{className:"journalit-carousel-image-container"},er.default.createElement("div",{style:{textAlign:"center",padding:"20px",color:"var(--text-muted)"}},"No images to display"))));let C=e[d],N=`${t} ${d+1}`;return er.default.createElement("div",{className:E,style:l},er.default.createElement("div",{className:"journalit-carousel-main"},e.length>1&&er.default.createElement("button",{className:"journalit-carousel-button",onClick:h,"aria-label":"Previous image",type:"button"},"<"),er.default.createElement("div",{className:"journalit-carousel-image-container"},er.default.createElement(dh,{imagePath:C,alt:N,enableFullscreen:!1,description:`${t} ${d+1} of ${e.length}`,showDeleteButton:i,onDelete:D=>b(d,D),onError:w,useResolveMediaPath:c}),a&&er.default.createElement("div",{className:"journalit-carousel-fullscreen-trigger",onClick:k,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",cursor:"zoom-in",zIndex:5},title:"Click to view fullscreen"})),e.length>1&&er.default.createElement("button",{className:"journalit-carousel-button",onClick:y,"aria-label":"Next image",type:"button"},">")),n&&e.length>1&&er.default.createElement("div",{className:"journalit-carousel-counter"},d+1," / ",e.length),r&&e.length>1&&er.default.createElement("div",{className:"journalit-carousel-thumbnails"},e.map((D,A)=>er.default.createElement(z_,{key:`thumb-${A}`,imagePath:D,index:A,isActive:A===d,altPrefix:t,useResolveMediaPath:c,onClick:P=>v(A,P)}))),er.default.createElement(Ka,{isOpen:g,onClose:S,title:`${t} ${d+1} of ${e.length}`,portalId:"journalit-carousel-fullscreen-portal"},er.default.createElement(kc,{imagePath:C,alt:N,useResolveMediaPath:c,navigationContext:T,onClose:S})))},z_=er.default.memo(({imagePath:e,index:t,isActive:r,altPrefix:n,useResolveMediaPath:i,onClick:o})=>er.default.createElement("div",{className:`journalit-carousel-thumbnail ${r?"active":""}`,onClick:o,title:`${n} ${t+1}`,style:{cursor:"pointer",border:r?"2px solid var(--interactive-accent)":"2px solid transparent",borderRadius:"4px",overflow:"hidden"}},er.default.createElement(__,{src:e,alt:`Thumbnail ${t+1}`,useResolveMediaPath:i,style:{width:"60px",height:"60px"},rootMargin:"100px",threshold:.1})));z_.displayName="LazyThumbnail";var $_=({data:e,onChange:t,availableTags:r,onAddImage:n,onDeleteImage:i})=>{let o=(0,Sc.useMemo)(()=>({contextType:"trade",contextData:{ticker:e.instrument||"unknown"},multiple:!0}),[e.instrument]),a=async d=>{try{let u=Array.isArray(e.images)?[...e.images]:[];if(!u.includes(d)){let p=[...u,d];t("images",p)}}catch(u){console.error("Failed to process uploaded image:",u)}},s=async d=>{try{let u=Array.isArray(e.images)?[...e.images]:[],p=d.filter(m=>!u.includes(m));if(p.length>0){let m=[...u,...p];t("images",m)}}catch(u){console.error("Failed to process multiple uploaded images:",u)}},l=async(d,u)=>{let m=[...e.images||[]].filter(g=>g!==u);if(t("images",m),i)try{await i(u)}catch(g){console.error(`Failed to delete image ${u}:`,g)}};return Sc.default.createElement(Cp,{title:"Attachments"},n&&Sc.default.createElement("div",{className:"field"},Sc.default.createElement("label",{className:"label"},"Attachments"),Sc.default.createElement(Dd,{onImageUploaded:a,onMultipleImagesUploaded:s,label:"Upload Image",enableDragDrop:!0,saveImageFunction:async d=>{if(!n)throw new Error("Image upload not available");return await n(d)},enablePaste:!0,pasteContext:o}),e.images&&e.images.length>0&&Sc.default.createElement(Pd,{images:e.images,altPrefix:"Trade Image",showThumbnails:!0,showCounter:!0,enableDelete:!0,onDeleteImage:l,enableFullscreen:!0})))};var Oo=$(W()),R_=({data:e,onChange:t})=>Oo.default.createElement("div",{className:"field"},Oo.default.createElement("div",{className:"missed-trade-toggle",style:{marginBottom:"8px",padding:"16px",border:"1px solid var(--background-modifier-border)",borderRadius:"8px",backgroundColor:e.isMissedTrade?"rgba(var(--color-orange-rgb, 255, 165, 0), 0.1)":"var(--background-secondary)"}},Oo.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"12px"}},Oo.default.createElement("div",{className:"toggle-container",style:{position:"relative",width:"36px",height:"20px"}},Oo.default.createElement("input",{type:"checkbox",id:"is-missed-trade",checked:e.isMissedTrade||!1,onChange:r=>t("isMissedTrade",r.target.checked),className:"toggle-checkbox",style:{opacity:0,width:0,height:0}}),Oo.default.createElement("label",{htmlFor:"is-missed-trade",className:"toggle-switch",style:{position:"absolute",cursor:"pointer",top:0,left:0,right:0,bottom:0,backgroundColor:e.isMissedTrade?"var(--interactive-accent)":"var(--background-modifier-border)",transition:".3s",borderRadius:"20px"}},Oo.default.createElement("span",{style:{position:"absolute",content:'""',height:"16px",width:"16px",left:"2px",bottom:"2px",backgroundColor:"var(--background-primary)",transition:".3s",borderRadius:"50%",transform:e.isMissedTrade?"translateX(16px)":"translateX(0px)"}}))),Oo.default.createElement("label",{htmlFor:"is-missed-trade",style:{fontWeight:"500",cursor:"pointer"}},"Is this a missed trade?")),Oo.default.createElement("p",{style:{margin:"8px 0 0 0",fontSize:"13px",color:"var(--text-muted)",lineHeight:"1.4"}},e.isMissedTrade?"PNL and Account fields are now optional.":"Enable this to create a missed trade note instead of a regular trade."),e.isMissedTrade&&Oo.default.createElement("div",{className:"field",style:{marginTop:"12px"}},Oo.default.createElement("label",{className:"label"},"Why did you miss this trade?"),Oo.default.createElement("textarea",{value:e.missedReason||"",onChange:r=>t("missedReason",r.target.value),placeholder:"Describe why you missed this trade opportunity...",rows:3,className:"textarea",style:{width:"100%",padding:"8px",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",backgroundColor:"var(--background-primary)",color:"var(--text-normal)",fontSize:"14px",fontFamily:"inherit",resize:"vertical"}}))));var pn=$(W());var Fp=require("obsidian");oi();var mE=({initialData:e={},isEditMode:t=!1,onSubmit:r,onCancel:n})=>{let[i,o]=(0,pn.useState)(()=>{if(t&&e){let P={...e};P.entries||(P.entries=[]),P.exits||(P.exits=[]),P.images||(P.images=[]),P.tags||(P.tags=[]),P.ctags||(P.ctags=[]),P.setup||(P.setup=[]),P.mistake||(P.mistake=[]),P.account||(P.account=[]),P.setupIds||(P.setupIds=[]),P.mistakeIds||(P.mistakeIds=[]),P.accountIds||(P.accountIds=[]),P.isMissedTrade===void 0&&(P.type==="missed-trade"||P.filePath&&P.filePath.includes("-M")&&P.filePath.endsWith(".md")?P.isMissedTrade=!0:P.isMissedTrade=!1);let I=P.entryPrice!==void 0&&P.entryPrice!==null&&P.entryPrice>0&&P.exitPrice!==void 0&&P.exitPrice!==null&&P.exitPrice>0;return P.useDirectPnLInput=!I,P.useDirectPnLInput&&P.directPnL===void 0&&P.pnl!==void 0&&(P.directPnL=P.pnl),P}let A={...{...M2}};e&&(Object.keys(e).forEach(P=>{let I=P,M=e[I];Array.isArray(M)?A[I]=[...M]:A[I]=M}),!A.images&&e.images&&(A.images=[...e.images]));try{let P=It().plugins.plugins.journalit;P&&P.settings.trade.useDirectPnLInput!==void 0&&(A.useDirectPnLInput=P.settings.trade.useDirectPnLInput)}catch(P){console.error("Error loading PNL input mode preference:",P)}try{let P=It().plugins.plugins.journalit;P&&P.settings.trade.lastAssetType&&!A.assetType&&(A.assetType=P.settings.trade.lastAssetType)}catch(P){console.error("Error accessing last asset type from settings:",P)}return A}),[a,s]=(0,pn.useState)({}),[l,c]=(0,pn.useState)(!1),[d,u]=(0,pn.useState)([]),p=(0,pn.useRef)(null),m=(0,pn.useRef)(!1),[g,f]=(0,pn.useState)(!1),y=(0,pn.useMemo)(()=>$2(()=>{let D=oE(i);s(D)},300),[i]);(0,pn.useEffect)(()=>(l&&y(),()=>{y.cancel()}),[i,l,y]);let h=async()=>{try{if(g||w.current.length===0)return;f(!0);let D=[...w.current];for(let A of D)await lr.deleteImage(A,!0);u([])}catch(D){console.error("Failed to cleanup temporary images:",D)}},v=async D=>{try{if(!D)return;let A=d.includes(D);o(P=>{let I=Array.isArray(P.images)?[...P.images]:[];return{...P,images:I.filter(M=>M!==D)}}),A&&(await lr.deleteImage(D,!0),u(P=>P.filter(I=>I!==D)))}catch(A){console.error(`Failed to delete image file ${D}:`,A)}},b=(D,A)=>{o(P=>{let I={...P,[D]:A},M=D.toString().endsWith("Ids");return D==="account"&&!M?I.accountIds=Array.isArray(A)?[...A]:[]:D==="accountIds"&&!M?I.account=Array.isArray(A)?[...A]:[]:D==="setup"&&!M?I.setupIds=Array.isArray(A)?[...A]:[]:D==="setupIds"&&!M?I.setup=Array.isArray(A)?[...A]:[]:D==="mistake"&&!M?I.mistakeIds=Array.isArray(A)?[...A]:[]:D==="mistakeIds"&&!M?I.mistake=Array.isArray(A)?[...A]:[]:D==="optionType"&&I.assetType==="options"?A==="call"?I.direction="long":A==="put"&&(I.direction="short"):D==="assetType"&&A==="options"&&I.optionType&&(I.optionType==="call"?I.direction="long":I.optionType==="put"&&(I.direction="short")),I})},w=(0,pn.useRef)([]),k=(0,pn.useRef)(null);(0,pn.useEffect)(()=>{w.current=d},[d]);let S=async D=>{try{let A=It().plugins.plugins.journalit,P=A?A.tradeService:null;if(!P)throw new Error("Could not access TradeService");let I=i.entryTime?new Date(i.entryTime):new Date,M=i.instrument||"UNKNOWN",O=st(I,A),F=i.isMissedTrade||!1,{year:L,month:B,weekOfMonth:j,formattedDate:_}=await P.getTradePathComponents(O),H=await P.sanitizeTickerForFilename(M),q;if(k.current)q=k.current;else if(e&&e.entryTime){let R=e.filePath||"";if(R){let V=R.match(/[TM](\d+)\.md$/);V?q=V[1]:F&&(A!=null&&A.missedTradeService)?q=await A.missedTradeService.getMissedTradeNumberForDay(H,O):q=await P.getTradeNumberForDay(H,O),k.current=q}else F&&(A!=null&&A.missedTradeService)?q=await A.missedTradeService.getMissedTradeNumberForDay(H,O):q=await P.getTradeNumberForDay(H,O),k.current=q}else F&&(A!=null&&A.missedTradeService)?q=await A.missedTradeService.getMissedTradeNumberForDay(H,O):q=await P.getTradeNumberForDay(H,O),k.current=q;let X=F?"M":"T",U=`!Journalit/${L}/${B}/${j}/media/${H}-${_}-${X}${q}`;try{let R=It();await R.vault.adapter.mkdir((0,Fp.normalizePath)("!Journalit")),await R.vault.adapter.mkdir((0,Fp.normalizePath)(`!Journalit/${L}`)),await R.vault.adapter.mkdir((0,Fp.normalizePath)(`!Journalit/${L}/${B}`)),await R.vault.adapter.mkdir((0,Fp.normalizePath)(`!Journalit/${L}/${B}/${j}`)),await R.vault.adapter.mkdir((0,Fp.normalizePath)(U))}catch(R){}let Y=await lr.saveImage(D,U,`${H}-${X}${q}`);return u(R=>[...R,Y]),Y}catch(A){throw console.error("Failed to upload image:",A),new Error(`Failed to upload image: ${A.message}`)}};(0,pn.useEffect)(()=>{let D=A=>{A.detail&&A.detail.path&&u(P=>P.includes(A.detail.path)?P:[...P,A.detail.path])};return document.addEventListener("jouranlit:image-saved",D),()=>{document.removeEventListener("jouranlit:image-saved",D)}},[]);let x=D=>{D.preventDefault(),c(!0);let A=oE(i);s(A);let P={...i};if(t&&e.entryTime){let I=new Date(e.entryTime),M=new Date(i.entryTime||new Date);if(M.setFullYear(I.getFullYear()),M.setMonth(I.getMonth()),M.setDate(I.getDate()),P.entryTime=M,e.exitTime){let O=new Date(e.exitTime),F=new Date(i.exitTime||new Date);F.setFullYear(O.getFullYear()),F.setMonth(O.getMonth()),F.setDate(O.getDate()),P.exitTime=F}if(e.filePath&&(P.filePath=e.filePath),e.images){let O=e.images||[],F=P.images||[],L=Array.from(new Set([...O,...F]));P.images=L}o(P)}if(!P.assetType&&i.assetType&&(P.assetType=i.assetType),i.useDirectPnLInput!==void 0&&(P.useDirectPnLInput=i.useDirectPnLInput),i.directPnL!==void 0&&(P.directPnL=i.directPnL),i.isMissedTrade!==void 0&&(P.isMissedTrade=i.isMissedTrade),i.missedReason!==void 0&&(P.missedReason=i.missedReason),!Zb(A)&&r)T(P),r(P||i),u([]),f(!0);else{let I=Object.keys(A);if(I.length>0){let O={form:`Please complete all required fields: ${I.map(L=>{let B=L.replace(/([A-Z])/g," $1").toLowerCase();return B==="form"?A[L]:`${B}: ${A[L]}`}).join("; ")}`};s(L=>({...L,...O}));let F=document.querySelector(".formContainer");F&&(F.scrollTop=0)}}},T=async D=>{try{let A=It().plugins.plugins.journalit,P=A?A.optionsService:new En;D.instrument&&await P.addOption("instrument",D.instrument),D.account&&D.account.length>0&&await P.addOptions("account",D.account),D.setup&&D.setup.length>0&&await P.addOptions("setup",D.setup),D.mistake&&D.mistake.length>0&&await P.addOptions("mistake",D.mistake),D.ctags&&D.ctags.length>0&&await P.addOptions("tag",D.ctags)}catch(A){console.error("Failed to save custom options:",A)}};(0,pn.useEffect)(()=>()=>{h()},[]);let E=()=>{h(),n&&n()},[C,N]=(0,pn.useState)(!1);return{formData:i,errors:a,formRef:p,handleFieldChange:b,handleAddImage:S,deleteImageFile:v,handleSubmit:x,handleCancel:E,isSubmitting:C,setIsSubmitting:N,formSubmitted:l,cleanupPerformed:g}};var hw=$(W());var fE=({onCancel:e,isSubmitting:t,errors:r,isEditMode:n,hasEntryTime:i})=>{let o=()=>n?"Update Trade":i?"Save Changes":"Add Trade";return hw.default.createElement("div",{className:"formActions"},e&&hw.default.createElement(Ya,{variant:"outline",onClick:e,disabled:t,className:"cancelButton"},"Cancel"),hw.default.createElement(Ya,{type:"submit",variant:"primary",loading:t,disabled:Zb(r),className:"submitButton"},o()))};var H_=({initialData:e={},isSubmitting:t=!1,isEditMode:r=!1,onSubmit:n,onCancel:i})=>{let{formData:o,errors:a,formRef:s,handleFieldChange:l,handleAddImage:c,deleteImageFile:d,handleSubmit:u,handleCancel:p}=mE({initialData:e,isEditMode:r,onSubmit:n,onCancel:i});(0,Ls.useMemo)(()=>(yd(),!0),[]);let m=[],g=[],f=[],y=[],h=[];return Ls.default.createElement("form",{ref:s,className:"formContainer",style:{gap:"8px",position:"relative"},onSubmit:u},a.form&&Ls.default.createElement("div",{className:"errorSummary"},a.form),Ls.default.createElement(R_,{data:o,onChange:l}),Ls.default.createElement(F_,{data:o,errors:a,onChange:l,instruments:y}),Ls.default.createElement(j_,{data:o,errors:a,onChange:l,accounts:m,setups:g,mistakes:f}),Ls.default.createElement($_,{data:o,onChange:l,availableTags:h,onAddImage:c,onDeleteImage:d}),Ls.default.createElement(fE,{onCancel:p,isSubmitting:t,errors:a,isEditMode:r,hasEntryTime:!!e.entryTime}))};var Ad={};function q_(e){Ad[e]&&(window.clearTimeout(Ad[e]),delete Ad[e]),Ad[e]=window.setTimeout(()=>{delete Ad[e];let t=document.querySelector(e);if(!(!t||!document.body.contains(t)))try{t instanceof HTMLElement&&(t.style.height="100%",t.style.overflowY="auto",t.style.display="flex",t.style.flexDirection="column");let r=t.querySelector(".formContainer");r&&r instanceof HTMLElement&&(r.style.display="flex",r.style.flexDirection="column",r.style.minHeight="min-content",r.style.flex="1 1 auto",r.style.overflow="visible"),t.querySelectorAll('input:not([role="combobox"]):not([data-combobox-type] input), textarea').forEach(s=>{s instanceof HTMLElement&&(s.style.backgroundColor="var(--background-primary)",s.style.color="var(--text-normal)",s.style.border="1px solid var(--background-modifier-border)",s.style.borderRadius="4px",s.style.padding="8px 12px",s.style.boxSizing="border-box",(s.getAttribute("type")==="date"||s.getAttribute("type")==="time")&&(s.style.paddingLeft="35px",s.style.paddingRight="15px",s.style.position="relative"))}),t.querySelectorAll("select").forEach(s=>{s instanceof HTMLSelectElement&&(s.style.backgroundColor="var(--background-primary)",s.style.color="var(--text-normal)",s.style.minHeight="38px",s.style.lineHeight="1.5")}),t.querySelectorAll('button:not([data-combobox-type] button):not([class*="removeButton"])').forEach(s=>{s.closest("[data-combobox-type]")||s instanceof HTMLButtonElement&&(s.style.borderRadius="4px",s.classList.contains("primary")?(s.style.backgroundColor="var(--interactive-accent)",s.style.color="#fff"):s.classList.contains("outline")&&(s.style.backgroundColor="transparent",s.style.color="var(--interactive-accent)",s.style.border="1px solid var(--interactive-accent)"))}),t.classList.add("modern-dropdown-ready"),t.querySelectorAll("[data-combobox-type]").forEach(s=>{s instanceof HTMLElement&&(s.classList.add("style-refresh"),window.getComputedStyle(s).opacity,s.classList.remove("style-refresh"))})}catch(r){console.error("Error applying style reset:",r)}},100)}function G_(){Object.values(Ad).forEach(e=>{window.clearTimeout(e)}),Ad={}}var Ir="trade-form-view",yw=class extends wc{constructor(r,n,i,o={}){var s;super(r,{containerClass:"trade-form-view-container",rootId:"trade-form-root"});this.isSubmitting=!1;this.updateSubmittingState=()=>{};this.stylesApplied=!1;this.isClosing=!1;this.isEditMode=!1;this.initialTradeData={};this.filePath="";try{if(this.containerEl){let l=this.containerEl;l.classList.add("modern-ui"),l.classList.add("modern-dropdown-ready")}}catch(l){console.error("Error adding classes to container:",l)}this.tradeService=n,this.missedTradeService=i,this.missedTradeService||console.warn("TradeFormView: missedTradeService is not initialized during construction");let a=(s=r.view)==null?void 0:s.state;a?(this.isEditMode=a.isEditMode||o.isEditMode||!1,this.initialTradeData=a.initialData||o.initialData||{},this.filePath=a.filePath||o.filePath||""):(this.isEditMode=o.isEditMode||!1,this.initialTradeData=o.initialData||{},this.filePath=o.filePath||""),this.registerEvents(),this.setupGlobalEventHandlers()}setState(r,n){return r&&(this.isEditMode=r.isEditMode||!1,this.initialTradeData=r.initialData||{},this.filePath=r.filePath||"",this.renderComponent()),super.setState(r,n)}getViewState(){return{}}async ensureMissedTradeService(){if(this.missedTradeService)return this.missedTradeService;let r=It().plugins.plugins.journalit;if(r!=null&&r.missedTradeService){let n=r.missedTradeService;return this.missedTradeService=n,n}if(r!=null&&r.serviceManager){let n=await r.serviceManager.getMissedTradeService();if(n)return this.missedTradeService=n,n}throw new Error("Missed trade service is not initialized. Please wait a moment and try again.")}async onOpen(){try{await super.onOpen(),Po(!0,!0,!0,!0,!0,!0,!0,!0),Di(!0,!0,!0,!0,!0,!0,!0,!0,!0),qb(),this.containerEl&&(this.containerEl.classList.add("modern-dropdown-ready"),this.containerEl.classList.add("modern-ui"),this.containerEl.style.paddingTop="0",this.containerEl.style.marginTop="0"),this.applyStyles(),this.detectReactRenderingComplete();let r="fix-form-gap-styles",n=document.getElementById(r);n||(n=document.createElement("style"),n.id=r,document.head.appendChild(n)),n.textContent=`
        /* Add CSS variables for consistent styling */
        :root {
          --background-primary-rgb: 255, 255, 255;
          --interactive-accent-rgb: 83, 141, 226;
          --background-modifier-border-rgb: 220, 220, 220;
        }
        
        .theme-dark:root {
          --background-primary-rgb: 32, 32, 32;
          --interactive-accent-rgb: 83, 141, 226;
          --background-modifier-border-rgb: 60, 60, 60;
        }
        
        /* Critical form spacing fixes */
        .trade-form-view-container .formContainer {
          padding: 16px 20px !important; /* Maintain consistent padding */
          margin: 0 auto !important;
          gap: 12px !important; /* Match gap from tradeFormStyles */
          max-width: 800px !important;
        }
        
        /* Force zero spacing at the top */
        .trade-form-view-container > div,
        .trade-form-view-container #trade-form-root,
        .trade-form-view-container .formContainer {
          padding-top: 0 !important;
          margin-top: 0 !important;
        }
          
        /* Make form sections more compact with consistent spacing */
        .trade-form-view-container .formSection {
          margin-bottom: 8px !important;
          padding-top: 6px !important;
          padding-bottom: 8px !important;
        }
        
        /* Give proper spacing to first element in the form */
        .trade-form-view-container .formContainer > *:first-child {
          margin-top: 0 !important;
          padding-top: 4px !important; /* Small padding for first element */
        }
        
        /* Force top position for the entire container */
        .trade-form-view-container {
          margin-top: 0 !important;
          padding-top: 0 !important;
        }
        
        /* Ensure error summary looks good */
        .trade-form-view-container .errorSummary {
          margin-bottom: 12px !important;
        }
        
        /* Position form action buttons with proper spacing */
        .trade-form-view-container .formActions {
          justify-content: space-between !important;
          margin-bottom: 32px !important; /* Increased bottom margin */
          margin-top: 0 !important; /* Reduced top margin to move buttons up */
          padding-left: 16px !important; /* Add left padding to move buttons away from the edge */
          padding-right: 16px !important; /* Add right padding for balance */
        }
        
        /* CRITICAL DROPDOWN FIXES - with highest specificity */
        /* FIXED: More specific selector to not hide the actual dropdown */
        .trade-form-view-container [data-combobox-type][data-is-open="true"] > div:last-child[id^="helper-"] {
          visibility: hidden !important;
          opacity: 0 !important;
          pointer-events: none !important;
          /* Keep the element in the flow to prevent layout shifts */
          display: block !important;
          height: auto !important;
        }
        
        .trade-form-view-container [data-combobox-type][data-is-open="true"] input[role="combobox"] {
          border-bottom-left-radius: 0 !important;
          border-bottom-right-radius: 0 !important;
        }
        
        /* Ensure dropdown is visible and properly positioned */
        .trade-form-view-container [data-combobox-type] ul[role="listbox"] {
          position: absolute !important;
          top: 100% !important; /* Position directly below the input */
          left: 0 !important;
          right: 0 !important;
          max-height: 200px !important;
          overflow-y: auto !important;
          background-color: var(--background-primary) !important;
          border: 1px solid var(--background-modifier-border) !important;
          border-top: none !important;
          border-radius: 0 0 4px 4px !important;
          z-index: 9999 !important; /* Ensure high z-index */
          margin-top: -1px !important; /* Remove any gap between input and dropdown */
          box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
          visibility: visible !important; /* Ensure visibility */
          opacity: 1 !important; /* Ensure opacity */
          pointer-events: auto !important; /* Ensure clickable */
          display: block !important; /* Ensure display */
        }
      `,setTimeout(()=>{document.querySelectorAll(".trade-form-view-container [data-combobox-type]").forEach(o=>{let a=o.querySelector('div:last-child:not([role="alert"])');a&&o.getAttribute("data-is-open")==="true"&&a instanceof HTMLElement&&(a.style.visibility="hidden",a.style.opacity="0",a.style.display="block")})},300),this.setupDragDropHandlers(),this.setupClipboardPasteHandler()}catch(r){console.error("Error in TradeFormView.onOpen:",r)}}async onClose(){try{this.isClosing=!0,G_();let r=document.getElementById("fix-form-gap-styles");r&&r.remove(),await super.onClose()}catch(r){console.error("Error in TradeFormView.onClose:",r)}}applyStyles(){try{q_(".trade-form-view-container"),this.fixScrollIssues(),this.ensureCustomIndicatorStyles(),this.fixSelectElements(),this.verifyComboBoxStyling(),this.stylesApplied=!0}catch(r){console.error("Error applying styles:",r)}}applyGapFix(){try{this.containerEl instanceof HTMLElement&&(this.containerEl.style.padding="0",this.containerEl.style.margin="0");let r=document.getElementById(this.config.rootId||"");r instanceof HTMLElement&&(r.style.paddingTop="0",r.style.marginTop="0");let n=this.containerEl.querySelector(".formContainer");n instanceof HTMLElement&&(n.style.paddingTop="0",n.style.paddingBottom="0",n.style.marginTop="0",n.style.marginBottom="0",n.style.paddingLeft="16px",n.style.paddingRight="16px",n.style.gap="12px",n.style.maxWidth="800px",n.style.margin="0 auto");let i=this.containerEl.children;for(let o=0;o<i.length;o++){let a=i[o];a&&(a.style.paddingTop="0",a.style.marginTop="0")}}catch(r){console.error("Error applying gap fix:",r)}}detectReactRenderingComplete(){try{let r=document.getElementById(this.config.rootId||"");if(!r)return;this.applyGapFix();let n=new MutationObserver(i=>{let o=this.containerEl.querySelectorAll("[data-combobox-type]");this.applyGapFix(),o&&o.length>0&&(setTimeout(()=>{this.applyStyles(),this.verifyComboBoxStyling(),this.setupComboBoxEventHandlers()},100),n.disconnect(),this.watchComboBoxOpenState())});n.observe(r,{childList:!0,subtree:!0}),setTimeout(()=>{n.disconnect(),this.stylesApplied||(this.applyStyles(),this.watchComboBoxOpenState(),this.applyGapFix())},5e3)}catch(r){console.error("Error setting up React rendering detection:",r)}}watchComboBoxOpenState(){try{let r=this.containerEl.querySelectorAll("[data-combobox-type]");if(!r||r.length===0)return;let n=new MutationObserver(i=>{i.forEach(o=>{if(o.type==="attributes"&&o.attributeName==="data-is-open"){let a=o.target,s=a.getAttribute("data-is-open")==="true",l=a.querySelector('[id^="helper-"]');l&&l instanceof HTMLElement&&(s?(l.style.visibility="hidden",l.style.opacity="0",l.style.display="block"):(l.style.visibility="visible",l.style.opacity="1",l.style.display="block"))}})});r.forEach(i=>{n.observe(i,{attributes:!0,attributeFilter:["data-is-open"]})}),this.registerInterval(window.setInterval(()=>{let i=this.containerEl.querySelectorAll("[data-combobox-type]");(!i||i.length===0)&&n.disconnect()},5e3))}catch(r){console.error("Error setting up ComboBox open state observer:",r)}}setupComboBoxEventHandlers(){try{this.containerEl.querySelectorAll("[data-combobox-type]").forEach(n=>{let i=n.querySelector('input[role="combobox"]');i&&(i.addEventListener("focus",()=>{n.setAttribute("data-is-open","true");let o=n.querySelector('[id^="helper-"]');o&&o instanceof HTMLElement&&(o.style.visibility="hidden",o.style.opacity="0",o.style.display="block")}),i.addEventListener("click",()=>{n.setAttribute("data-is-open","true")}),i.addEventListener("blur",o=>{let a=o.relatedTarget;a&&n.contains(a)||setTimeout(()=>{let s=n.getAttribute("data-is-open")==="true",l=n.querySelector('[id^="helper-"]');l&&l instanceof HTMLElement&&!s&&(l.style.visibility="visible",l.style.opacity="1",l.style.display="block")},200)}))})}catch(r){console.error("Error setting up ComboBox event handlers:",r)}}verifyComboBoxStyling(){try{let r="combobox-critical-styles",n=document.getElementById(r);n||(n=document.createElement("style"),n.id=r,document.head.appendChild(n)),n.textContent=`
        /* ComboBox container styling */
        .trade-form-view-container [data-combobox-type] {
          position: relative !important;
          width: 100% !important;
          margin-bottom: 8px !important;
        }
        
        /* When dropdown is open, increase z-index */
        .trade-form-view-container [data-combobox-type][data-is-open="true"] {
          z-index: 9999 !important;
        }
        
        /* Input container styling */
        .trade-form-view-container [data-combobox-type] > div.input-container,
        .trade-form-view-container [data-combobox-type] > div:nth-child(2) {
          position: relative !important;
          width: 100% !important;
        }
        
        /* Input styling with proper border radius when open */
        .trade-form-view-container [data-combobox-type] input[role="combobox"] {
          width: 100% !important;
          padding: 8px 12px !important;
          padding-right: 30px !important;
          border: 1px solid var(--background-modifier-border) !important;
          border-radius: 4px !important;
          background-color: var(--background-primary) !important;
          color: var(--text-normal) !important;
          font-size: 14px !important;
          cursor: pointer !important;
          box-sizing: border-box !important;
        }
        
        /* When dropdown is open, change input border radius to connect with dropdown */
        .trade-form-view-container [data-combobox-type][data-is-open="true"] input[role="combobox"] {
          border-bottom-left-radius: 0 !important;
          border-bottom-right-radius: 0 !important;
        }
        
        /* Ensure input focus effect appears above dropdown */
        .trade-form-view-container [data-combobox-type] input[role="combobox"]:focus {
          position: relative !important;
          z-index: 10001 !important; /* Higher than dropdown's z-index (9999) */
          border-color: var(--interactive-accent) !important;
          box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.3) !important;
          outline: none !important;
        }
        
        /* Ensure proper focus effect when dropdown is open */
        .trade-form-view-container [data-combobox-type][data-is-open="true"] input[role="combobox"]:focus {
          border-bottom-left-radius: 0 !important;
          border-bottom-right-radius: 0 !important;
          border-bottom-color: var(--interactive-accent) !important;
        }
        
        /* Dropdown styling - crucial for visibility */
        .trade-form-view-container [data-combobox-type] ul[role="listbox"] {
          position: absolute !important;
          top: 100% !important; /* Position directly below the input */
          left: 0 !important;
          right: 0 !important;
          max-height: 200px !important;
          overflow-y: auto !important;
          background-color: var(--background-primary) !important;
          border: 1px solid var(--background-modifier-border) !important;
          border-top: none !important; /* Remove top border to connect with input */
          border-radius: 0 0 4px 4px !important; /* Only round the bottom corners */
          z-index: 9999 !important;
          list-style: none !important;
          padding: 0 !important;
          box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
          margin-top: -1px !important; /* Adjust margin to align perfectly with input */
          display: block !important;
          visibility: visible !important;
          opacity: 1 !important;
          pointer-events: auto !important;
        }
        
        /* Dropdown options */
        .trade-form-view-container [data-combobox-type] ul[role="listbox"] li {
          padding: 8px 12px !important;
          cursor: pointer !important;
          margin: 0 !important;
          transition: background-color 150ms ease !important;
        }
        
        /* Hover and selection styling */
        .trade-form-view-container [data-combobox-type] ul[role="listbox"] li:hover,
        .trade-form-view-container [data-combobox-type] ul[role="listbox"] li[aria-selected="true"] {
          background-color: var(--background-secondary) !important;
        }
        
        /* Only hide helper text, not the dropdown */
        .trade-form-view-container [data-combobox-type][data-is-open="true"] > div[id^="helper-"] {
          visibility: hidden !important;
          opacity: 0 !important;
          pointer-events: none !important;
          /* Keep the element in the flow to prevent layout shifts */
          display: block !important;
          height: auto !important;
        }
      `}catch(r){console.error("Error verifying ComboBox styling:",r)}}setEditMode(r){this.isEditMode=r}setInitialData(r){this.initialTradeData=r||{}}setFilePath(r){this.filePath=r||""}getViewType(){return Ir}getDisplayText(){return this.isEditMode?"Edit Trade":"Add Trade"}getIcon(){return"receipt-text"}registerEvents(){this.app.workspace.on("file-open",()=>{this.refresh()}),this.app.vault.on("modify",()=>{this.refresh()})}async handleSubmit(r){try{this.updateSubmittingState(!0),await new Promise(o=>setTimeout(o,50));let n="",i=r.isMissedTrade===!0;if(this.isEditMode){let o={entryTime:r.entryTime,exitTime:r.exitTime,entryPrice:r.entryPrice,exitPrice:r.exitPrice,positionSize:r.positionSize,direction:r.direction,entries:r.entries||[],exits:r.exits||[],setupIds:r.setupIds||[],mistakeIds:r.mistakeIds||[],accountIds:r.accountIds||[],thesis:r.thesis,images:r.images,instrument:r.instrument,assetType:r.assetType,setup:r.setup,mistake:r.mistake,account:r.account,tags:r.tags,dollarPerPoint:r.dollarPerPoint,tickSize:r.tickSize,tickValue:r.tickValue,expirationDate:r.expirationDate?new Date(r.expirationDate):void 0,strikePrice:r.strikePrice,optionType:r.optionType,contractSize:r.contractSize,exchange:r.exchange,lotSize:r.lotSize,pipValue:r.pipValue,cryptoExchange:r.cryptoExchange,leverageRatio:r.leverageRatio,commission:r.commission,fees:r.fees,useDirectPnLInput:r.useDirectPnLInput,directPnL:r.directPnL,originalPnl:this.initialTradeData.pnl,isMissedTrade:r.isMissedTrade,missedReason:r.missedReason};r.assetType==="options"&&r.expirationDate,i?n=await(await this.ensureMissedTradeService()).updateMissedTrade(o,this.filePath):n=await this.tradeService.updateTrade(o,this.filePath),new vw.Notice(`${i?"Missed trade":"Trade"} updated: ${n}`)}else{let o={entryTime:r.entryTime,exitTime:r.exitTime,entryPrice:r.entryPrice,exitPrice:r.exitPrice,positionSize:r.positionSize,direction:r.direction,entries:r.entries||[],exits:r.exits||[],setupIds:r.setupIds||[],mistakeIds:r.mistakeIds||[],accountIds:r.accountIds||[],thesis:r.thesis,images:r.images,instrument:r.instrument,assetType:r.assetType,setup:r.setup,mistake:r.mistake,account:r.account,tags:r.tags,dollarPerPoint:r.dollarPerPoint,tickSize:r.tickSize,tickValue:r.tickValue,expirationDate:r.expirationDate?new Date(r.expirationDate):void 0,strikePrice:r.strikePrice,optionType:r.optionType,contractSize:r.contractSize,exchange:r.exchange,lotSize:r.lotSize,pipValue:r.pipValue,cryptoExchange:r.cryptoExchange,leverageRatio:r.leverageRatio,commission:r.commission,fees:r.fees,useDirectPnLInput:r.useDirectPnLInput,directPnL:r.directPnL,isMissedTrade:r.isMissedTrade,missedReason:r.missedReason};r.assetType==="options"&&r.expirationDate,i?n=await(await this.ensureMissedTradeService()).createMissedTrade(o):n=await this.tradeService.createTrade(o),new vw.Notice(`${i?"Missed trade":"Trade"} created: ${n}`)}try{let o=It().plugins.plugins.journalit;o&&r.assetType&&(o.settings.trade.lastAssetType=r.assetType,await o.saveSettings())}catch(o){console.error("Error saving asset type preference:",o)}this.isClosing=!0,Di(!0,!0,!0,!0,!0,!0,!0,!0,!0),setTimeout(()=>{window.requestAnimationFrame(()=>{window.requestAnimationFrame(()=>{this.onClose().then(()=>{Di(!0,!0,!0,!0,!0,!0,!0,!0,!0),this.leaf.detach()}).catch(o=>{console.error("Error during onClose in handleSubmit:",o),Di(!0,!0,!0,!0,!0,!0,!0,!0,!0),this.leaf.detach()})})})},300)}catch(n){console.error(`Failed to ${this.isEditMode?"update":"create"} trade:`,n),new vw.Notice(`Failed to ${this.isEditMode?"update":"create"} trade: `+(n instanceof Error?n.message:"Unknown error")),this.isClosing||this.updateSubmittingState(!1)}}handleCancel(){this.isClosing=!0,Di(!0,!0,!0,!0,!0,!0,!0,!0,!0),window.requestAnimationFrame(()=>{this.onClose().then(()=>{Di(!0,!0,!0,!0,!0,!0,!0,!0,!0),this.leaf.detach()}).catch(r=>{console.error("Error during onClose in handleCancel:",r),Di(!0,!0,!0,!0,!0,!0,!0,!0,!0),this.leaf.detach()})})}fixSelectElements(){try{this.containerEl.querySelectorAll("select").forEach(i=>{var a;(((a=i.options[i.selectedIndex])==null?void 0:a.text)||"")&&(i.style.minHeight="38px",i.style.lineHeight="1.5")}),this.containerEl.querySelectorAll('input[type="date"], input[type="time"]').forEach(i=>{i instanceof HTMLElement&&(i.style.paddingLeft="35px",i.style.paddingRight="15px",i.style.position="relative",i.getAttribute("type")==="date"?i.style.minWidth="150px":i.style.minWidth="110px")})}catch(r){console.error("Error fixing form elements:",r)}}ensureCustomIndicatorStyles(){try{let r="picker-indicator-styles",n=document.getElementById(r);n||(n=document.createElement("style"),n.id=r,document.head.appendChild(n)),n.textContent=`
        .trade-form-view-container input[type="date"]::-webkit-calendar-picker-indicator,
        .trade-form-view-container input[type="time"]::-webkit-calendar-picker-indicator {
          position: absolute !important;
          left: 10px !important;
          top: 50% !important;
          transform: translateY(-50%) !important;
          margin: 0 !important;
          z-index: 2 !important;
        }
        
        .trade-form-view-container input[type="date"],
        .trade-form-view-container input[type="time"] {
          position: relative !important;
          padding-left: 35px !important;
          padding-right: 15px !important;
        }
        
        @-moz-document url-prefix() {
          .trade-form-view-container input[type="date"],
          .trade-form-view-container input[type="time"] {
            background-position: 10px center !important;
          }
        }
      `,document.querySelectorAll('.trade-form-view-container input[type="date"], .trade-form-view-container input[type="time"]').forEach(o=>{o instanceof HTMLElement&&(o.style.position="relative",o.style.paddingLeft="35px",o.style.paddingRight="15px")})}catch(r){console.error("Error ensuring custom indicator styles:",r)}}refresh(){try{if(this.isClosing)return;wp(),qb(),this.renderComponent(),setTimeout(()=>{!this.isClosing&&document.body.contains(this.containerEl)&&this.applyStyles()},150)}catch(r){console.error("Error in TradeFormView.refresh:",r)}}fixScrollIssues(){try{let r=this.containerEl,n=r.querySelector(".formContainer"),i=document.getElementById(this.config.rootId||"");r instanceof HTMLElement&&(r.style.height="100%",r.style.overflowY="auto",r.style.display="flex",r.style.flexDirection="column",r.style.position="relative",r.style.padding="0",r.style.margin="0"),i&&(i.style.height="100%",i.style.display="flex",i.style.flexDirection="column",i.style.overflow="visible",i.style.flex="1 1 auto",i.style.minHeight="min-content",i.style.paddingTop="0",i.style.marginTop="0"),n&&n instanceof HTMLElement&&(n.style.display="flex",n.style.flexDirection="column",n.style.width="100%",n.style.flex="1 1 auto",n.style.minHeight="min-content",n.style.overflow="visible",n.style.gap="12px",n.style.paddingTop="0",n.style.paddingBottom="0",n.style.marginTop="0",n.style.marginBottom="0",n.style.paddingLeft="16px",n.style.paddingRight="16px",n.style.maxWidth="800px",n.style.margin="0 auto");let o=r.querySelector(".formHeader");o&&o instanceof HTMLElement&&(o.style.marginBottom="0");let a=r.querySelector(".formActions");a&&a instanceof HTMLElement&&(a.style.justifyContent="space-between",a.style.marginBottom="32px",a.style.marginTop="0",a.style.paddingLeft="16px",a.style.paddingRight="16px")}catch(r){console.error("Error fixing scroll issues:",r)}}setupGlobalEventHandlers(){document.addEventListener("click",r=>{let n=document.querySelectorAll('[data-combobox-type][data-is-open="true"]');if(n.length){for(let i of n)if(i.contains(r.target)){r.__handledByDropdown=!0,r.stopPropagation();return}}},{capture:!0,passive:!1})}setupDragDropHandlers(){}setupClipboardPasteHandler(){}getRenderFunction(){return()=>(this.updateSubmittingState=r=>{this.isClosing||(this.isSubmitting=r,this.renderComponent())},Y_.default.createElement(H_,{initialData:this.initialTradeData,isSubmitting:this.isSubmitting,isEditMode:this.isEditMode,onSubmit:r=>this.handleSubmit(r),onCancel:()=>this.handleCancel()}))}};Yt();oi();var Kt=class{static generateLinksSection(t){let r=[];if(t.tradeToDRC&&r.push(`**Trade \u2192 DRC**: [[${t.tradeToDRC}]]`),t.drcToWeekly&&r.push(`**DRC \u2192 Weekly**: [[${t.drcToWeekly}]]`),t.weeklyToMonthly&&r.push(`**Weekly \u2192 Monthly**: [[${t.weeklyToMonthly}]]`),t.dailyToWeekly&&r.push(`**Daily \u2192 Weekly**: [[${t.dailyToWeekly}]]`),t.relatedTrades&&t.relatedTrades.length>0){let n=t.relatedTrades.map(i=>`[[${i}]]`).join(", ");r.push(`**Related Trades**: ${n}`)}if(t.relatedAccounts&&t.relatedAccounts.length>0){let n=t.relatedAccounts.map(i=>`[[${i}]]`).join(", ");r.push(`**Related Accounts**: ${n}`)}return r.length===0?"":`## \u2194\uFE0E Links
${r.join(`  
`)}
`}static updateLinksSection(t,r){let n=/## ↔︎ Links\n\n?[\s\S]*?(?=\n## |\n---|$)/g,i=this.generateLinksSection(r),o=t.replace(n,"");return o=o.replace(/\n\n\n+/g,`

`),o=o.trim(),i.trim()?o+`

`+i:o}static removeLinksSection(t){let r=/## ↔︎ Links\n\n?[\s\S]*?(?=\n## |\n---|$)/g;return t.replace(r,"").trim()}static async detectNoteType(t,r){let i=(await r.read(t)).match(/^---\n([\s\S]*?)\n---/),o={};if(i)try{let s=i[1],l=s.match(/^type:\s*(.+)$/m);l&&(o.type=l[1].trim().replace(/['"]/g,""));let c=s.match(/^date:\s*(.+)$/m);c&&(o.date=c[1].trim().replace(/['"]/g,""));let d=s.match(/^entryTime:\s*(.+)$/m);d&&(o.entryTime=d[1].trim().replace(/['"]/g,""))}catch(s){console.error("Error parsing frontmatter:",s)}let a={type:"unknown",filePath:t.path,fileName:t.basename};return o.type==="trade"||t.path.includes("/trades/")?a.type="trade":o.type==="drc"?a.type="drc":o.type==="weekly-review"?a.type="weekly":o.type==="monthly-review"?a.type="monthly":(o.type==="account"||t.path.includes("/accounts/"))&&(a.type="account"),o.date?a.date=new Date(o.date):o.entryTime&&a.type==="trade"&&(a.date=new Date(o.entryTime)),a}static async getRelatedTrades(t,r){let n=[];try{let o=r.app.vault.getMarkdownFiles().filter(a=>a.path.includes("/trades/")&&a.name.includes("-T"));for(let a of o){let s=await this.detectNoteType(a,r.app.vault);s.type==="trade"&&s.date&&this.isSameDay(s.date,t)&&n.push(a.basename)}}catch(i){console.error("Error getting related trades:",i)}return n}static async getParentWeekly(t,r){try{let n=Xr(t),i=this.getWeekNumber(n),o=n.getFullYear(),a=`W${i.toString().padStart(2,"0")}-Review`,l=r.app.vault.getMarkdownFiles().find(c=>c.basename===a&&c.path.includes(`${o}`));return l?l.basename:null}catch(n){return console.error("Error getting parent weekly:",n),null}}static async getParentMonthly(t,r){try{let n=t.getMonth()+1,i=t.getFullYear(),o=`${n.toString().padStart(2,"0")}-Review`,s=r.app.vault.getMarkdownFiles().find(l=>l.basename===o&&l.path.includes(`${i}`));return s?s.basename:null}catch(n){return console.error("Error getting parent monthly:",n),null}}static async getChildDailies(t,r){let n=[];try{let i=r.app.vault.getMarkdownFiles();for(let o=0;o<7;o++){let a=new Date(t);if(a.setDate(t.getDate()+o),a.getDay()===0||a.getDay()===6)continue;let s=i.filter(l=>{let c=this.detectNoteTypeSync(l);return c.type==="drc"&&c.date&&this.isSameDay(c.date,a)});n.push(...s.map(l=>l.basename))}}catch(i){console.error("Error getting child dailies:",i)}return n}static async getChildWeeklies(t,r,n){let i=[];try{let a=n.app.vault.getMarkdownFiles().filter(s=>s.basename.match(/^W\d{2}-Review$/)&&s.path.includes(`${r}`));for(let s of a){let l=await this.detectNoteType(s,n.app.vault);l.type==="weekly"&&l.date&&l.date.getMonth()+1===t&&l.date.getFullYear()===r&&i.push(s.basename)}}catch(o){console.error("Error getting child weeklies:",o)}return i}static detectNoteTypeSync(t){let r={type:"unknown",filePath:t.path,fileName:t.basename};return t.path.includes("/trades/")?r.type="trade":t.path.includes("/accounts/")&&(r.type="account"),r}static isSameDay(t,r){return t.getFullYear()===r.getFullYear()&&t.getMonth()===r.getMonth()&&t.getDate()===r.getDate()}static getWeekNumber(t){let r=new Date(t.getFullYear(),0,1),n=(t.getTime()-r.getTime())/864e5;return Math.ceil((n+r.getDay()+1)/7)}static getTradesDRCDate(t,r){return st(t,r)}static async getDRCFileName(t,r){try{let n=t.getDate().toString().padStart(2,"0"),i=(t.getMonth()+1).toString().padStart(2,"0"),o=t.getFullYear().toString().slice(-2),a=`DRC-${n}${i}${o}`,l=r.app.vault.getMarkdownFiles().find(c=>c.basename===a&&c.path.includes(`${t.getFullYear()}`));return l?l.basename:null}catch(n){return console.error("Error getting DRC file name:",n),null}}};async function gE(e,t){let r={},n=Kt.getTradesDRCDate(e,t),i=await Kt.getDRCFileName(n,t);return i&&(r.tradeToDRC=i),r}async function jp(e,t){let r={},n=await Kt.getParentWeekly(e,t);return n&&(r.drcToWeekly=n),r}async function hE(e,t){let r={},n=await Kt.getParentMonthly(e,t);return n&&(r.weeklyToMonthly=n),r}var xw=require("obsidian");var Z_=$(W());var Me=$(W());var ai=$(W());var Xi=$(W());oi();var K_=({trades:e,currentTradePath:t,onTradeClick:r})=>{var d,u,p;let n=(p=(u=(d=window.app)==null?void 0:d.plugins)==null?void 0:u.plugins)==null?void 0:p.journalit,i=Xi.default.useMemo(()=>{var m,g;try{let f=window.app;if(!(f!=null&&f.metadataCache))return null;let y=e.find(b=>b.path===t);if(y||(y=f.vault.getAbstractFileByPath(t)),!y)return null;let h=f.metadataCache.getFileCache(y),v=(m=h==null?void 0:h.frontmatter)==null?void 0:m.entryTime;if(v)return new Date(v);if((g=h==null?void 0:h.frontmatter)!=null&&g.useDirectPnLInput){let b=t.match(/(\d{2})(\d{2})(\d{2})-[TM]\d+\.md$/);if(b){let[,w,k,S]=b,x=2e3+parseInt(S,10);return new Date(x,parseInt(k,10)-1,parseInt(w,10))}}return null}catch(f){return console.warn("Error getting current trade date:",f),null}},[e,t]),o=Xi.default.useMemo(()=>{if(!i||!n)return e;try{let m=window.app;return m!=null&&m.metadataCache?e.filter(g=>{var f,y;try{let h=m.metadataCache.getFileCache(g),v=(f=h==null?void 0:h.frontmatter)==null?void 0:f.entryTime,b=(y=h==null?void 0:h.frontmatter)==null?void 0:y.useDirectPnLInput,w=null;if(v)w=new Date(v);else if(b){let k=g.path.match(/(\d{2})(\d{2})(\d{2})-[TM]\d+\.md$/);if(k){let[,S,x,T]=k,E=2e3+parseInt(T,10);w=new Date(E,parseInt(x,10)-1,parseInt(S,10))}}return w?U_(i,w,n):!1}catch(h){return console.warn(`Error checking trade date for ${g.path}:`,h),!1}}):e}catch(m){return console.warn("Error filtering trades by trading day:",m),e}},[e,i,n]),a=Xi.default.useMemo(()=>{let m=o.map(f=>{let y=f.path.match(/([A-Z0-9-]+)-[0-9]{6}-[TM]\d+\.md$/),h=f.path.match(/[TM](\d+)\.md$/),v=f.path.match(/-([TM])\d+\.md$/),b=y?y[1]:"Unknown",w=h?parseInt(h[1],10):0,k=v?v[1]==="M":!1,S=0,x=!1;try{let T=window.app;if(T!=null&&T.metadataCache){let E=T.metadataCache.getFileCache(f),C=E==null?void 0:E.frontmatter;C&&(C.pnl!==void 0?S=Number(C.pnl):C.directPnL!==void 0&&C.useDirectPnLInput&&(S=Number(C.directPnL)),x=at({tradeStatus:C.tradeStatus,exitTime:C.exitTime,pnl:C.pnl,useDirectPnLInput:C.useDirectPnLInput,exits:C.exits}))}}catch(T){S=0,x=!1}return{file:f,ticker:b,tradeNumber:w,isActive:f.path===t,pnl:S,isMissedTrade:k,isOpen:x}}),g={};return m.forEach(f=>{g[f.ticker]||(g[f.ticker]=[]),g[f.ticker].push(f)}),Object.keys(g).forEach(f=>{g[f].sort((y,h)=>y.tradeNumber-h.tradeNumber)}),g},[o,t]),s=Object.keys(a);if(s.length===0)return null;if(o.length<=1){let m=s[0],g=a[m][0],f=g.isMissedTrade?"M":"T",y=g.isMissedTrade?"Missed Trade":"Trade";return Xi.default.createElement("div",{className:"trade-timeline-container single-trade"},Xi.default.createElement("div",{className:"trade-timeline"},Xi.default.createElement("div",{className:"timeline-label active-ticker"},m,":"),Xi.default.createElement("div",{className:"timeline-items"},Xi.default.createElement("button",{className:`timeline-item ${g.isMissedTrade?"missed-trade":""} ${g.isOpen?"open":g.pnl>0?"profit":g.pnl<0?"loss":""} active`,disabled:!0,"aria-label":`${m} ${y} ${g.tradeNumber} (${g.isOpen?"Open":g.pnl>0?"Profit":g.pnl<0?"Loss":"Breakeven"})`,title:`Current ${y.toLowerCase()}: ${m} ${y} ${g.tradeNumber}${g.isOpen?" (Open)":""}`},f,g.tradeNumber))))}let l=s.find(m=>a[m].some(g=>g.isActive)),c=[...s].sort((m,g)=>m===l?-1:g===l?1:m.localeCompare(g));return Xi.default.createElement("div",{className:"trade-timeline-container"},c.map(m=>Xi.default.createElement("div",{key:m,className:"trade-timeline"},Xi.default.createElement("div",{className:`timeline-label ${m===l?"active-ticker":""}`},m,":"),Xi.default.createElement("div",{className:"timeline-items"},a[m].map(g=>{let f=g.isMissedTrade?"M":"T",y=g.isMissedTrade?"Missed Trade":"Trade";return Xi.default.createElement("button",{key:g.file.path,className:`timeline-item 
                    ${g.isMissedTrade?"missed-trade":""} 
                    ${g.isOpen?"open":g.pnl>0?"profit":g.pnl<0?"loss":""} 
                    ${g.isActive?"active":""}`,onClick:()=>r(g.file.path),"aria-label":`${m} ${y} ${g.tradeNumber} (${g.isOpen?"Open":g.pnl>0?"Profit":g.pnl<0?"Loss":"Breakeven"})`,title:`View ${m} ${y} ${g.tradeNumber} (${g.isOpen?"Open":g.pnl>0?"Profit":g.pnl<0?"Loss":"Breakeven"})${g.isOpen?" - Trade is still open":""}`},f,g.tradeNumber)})))))};var Lp=$(W()),_p=({buttons:e,className:t="shared-navigation",style:r={}})=>Lp.default.createElement("div",{className:t,style:{width:"100%",paddingTop:"10px",borderTop:"1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1))",...r}},Lp.default.createElement("div",{className:`${t}-links`,style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"8px",flexWrap:"wrap",width:"100%"}},e.map((n,i)=>Lp.default.createElement("button",{key:i,className:`${t}-button`,onClick:n.action,disabled:n.disabled,style:{padding:"8px 14px",border:"1px solid var(--background-modifier-border)",borderRadius:"4px",backgroundColor:"var(--background-primary)",color:"var(--text-normal)",cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px",flex:"1",textAlign:"center",minWidth:"120px",boxSizing:"border-box"}},n.icon&&n.icon!=="none"&&n.icon!=="right"&&Lp.default.createElement("span",{className:"nav-icon"},n.icon==="left"?"\u2190":n.icon),n.text,n.icon&&n.icon==="right"&&Lp.default.createElement("span",{className:"nav-icon"},"\u2192")))));oi();var bw=({currentDate:e,trades:t,missedTrades:r=[],currentTradePath:n,navigateTo:i,getDRCPath:o,getWeeklyReviewPath:a,getMonthlyReviewPath:s,getYearlyReviewPath:l,onEditClick:c,handleEditClick:d})=>{let u=Ge(),p=(0,ai.useCallback)(b=>{b!==n&&i(b,!1)},[i,n]),m=(0,ai.useCallback)(()=>{let b=st(e,u),w=o(b);w&&i(w,!1)},[o,e,i,u]),g=(0,ai.useCallback)(()=>{let b=st(e,u),w=a(b);w&&i(w,!1)},[a,e,i,u]),f=(0,ai.useCallback)(()=>{let b=st(e,u),w=s(b);w&&i(w,!1)},[s,e,i,u]),y=(0,ai.useCallback)(()=>{let b=st(e,u),w=l(b);w&&i(w,!1)},[l,e,i,u]),h=[{text:"Daily Report Card",action:m},{text:"Weekly Review",action:g},{text:"Monthly Review",action:f},{text:"Yearly Review",action:y}];return ai.default.createElement("div",{className:"trade-navigation-container"},ai.default.createElement("div",{className:"trade-navigation-with-edit"},ai.default.createElement(_p,{buttons:h,className:"trade-review-navigation",style:{borderTop:"none",flex:"1"}}),d&&c&&ai.default.createElement("div",{className:"edit-button-container"},ai.default.createElement("button",{className:"trade-nav-edit-button",onClick:d,"aria-label":"Edit trade",title:"Edit trade"},ai.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},ai.default.createElement("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),ai.default.createElement("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"}))))),ai.default.createElement(K_,{trades:[...t,...r],currentTradePath:n,onTradeClick:p}))};var zp=$(W());var si=$(W()),UK=({size:e=48})=>si.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},si.default.createElement("path",{d:"M9 10h.01"}),si.default.createElement("path",{d:"M15 10h.01"}),si.default.createElement("path",{d:"M12 2a8 8 0 0 0-8 8v12l3-3 2.5 2.5L12 19l2.5 2.5L17 19l3 3V10a8 8 0 0 0-8-8z"})),VK=()=>si.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",style:{marginRight:"6px"}},si.default.createElement("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),si.default.createElement("line",{x1:"5",y1:"12",x2:"19",y2:"12"})),Ae=({message:e="No data available",className:t="",iconSize:r=48,subMessage:n,actionButtonText:i,onActionButtonClick:o})=>si.default.createElement("div",{className:`journalit-empty-state ${t}`},si.default.createElement("div",{className:"journalit-empty-state-icon"},si.default.createElement(UK,{size:r})),si.default.createElement("div",{className:"journalit-empty-state-content"},si.default.createElement("p",{className:"journalit-empty-state-message"},e),n&&si.default.createElement("p",{className:"journalit-empty-state-submessage"},n),i&&o&&si.default.createElement("button",{className:"journalit-empty-state-action-button",onClick:o},si.default.createElement(VK,null),i)));var uh=zp.default.memo(({images:e,onEditClick:t})=>!e||e.length===0?zp.default.createElement("div",{className:"trade-empty-images"},zp.default.createElement(Ae,{message:"No images for this trade",subMessage:t?"Click 'Edit' to add images":void 0,iconSize:40})):zp.default.createElement("div",{className:"trade-images-section","data-image-count":e.length},zp.default.createElement(Pd,{images:e,altPrefix:"Trade image",showThumbnails:e.length>1,showCounter:e.length>1,enableDelete:!1,enableFullscreen:!0,useResolveMediaPath:!0,className:e.length===1?"single-image-carousel":"","data-single-image":e.length===1?"true":"false"})),(e,t)=>JSON.stringify(e.images)===JSON.stringify(t.images)&&e.onEditClick===t.onEditClick);var Fr=$(W()),ph=({data:e,onAccountClick:t})=>{let r=e.account&&e.account.length>0||e.accountIds&&e.accountIds.length>0,n=e.ctags&&e.ctags.length>0,i=e.setup&&e.setup.length>0||e.setupIds&&e.setupIds.length>0,o=e.mistake&&e.mistake.length>0||e.mistakeIds&&e.mistakeIds.length>0;return!r&&!n&&!i&&!o?null:Fr.default.createElement(Fr.default.Fragment,null,Fr.default.createElement("div",{className:"trade-metadata-container"},r&&Fr.default.createElement("div",{className:"metadata-section"},Fr.default.createElement("div",{className:"metadata-label"},"Account:"),Fr.default.createElement("div",{className:"metadata-tags"},(e.account||e.accountIds||[]).map((a,s)=>Fr.default.createElement("span",{key:`account-${s}`,className:"account-tag",onClick:()=>t(a)},a)))),n&&Fr.default.createElement("div",{className:"metadata-section"},Fr.default.createElement("div",{className:"metadata-label"},"Tags:"),Fr.default.createElement("div",{className:"metadata-tags"},e.ctags.map((a,s)=>Fr.default.createElement("span",{key:`tag-${s}`,className:"tag"},a))))),Fr.default.createElement("div",{className:"trade-tags-container"},Fr.default.createElement("div",{className:"tags-row"},i&&Fr.default.createElement("div",{className:"tags-section setup-section"},Fr.default.createElement("h4",null,"Setups"),Fr.default.createElement("div",{className:"tags-list"},(e.setup||e.setupIds||[]).map((a,s)=>Fr.default.createElement("span",{key:`setup-${s}`,className:"tag setup-tag"},a)))),o&&Fr.default.createElement("div",{className:"tags-section mistake-section"},Fr.default.createElement("h4",null,"Mistakes"),Fr.default.createElement("div",{className:"tags-list"},(e.mistake||e.mistakeIds||[]).map((a,s)=>Fr.default.createElement("span",{key:`mistake-${s}`,className:"tag mistake-tag"},a)))))))};var Se=$(W());var mh=({data:e,metrics:t,formatDate:r,formatTime:n,onEditClick:i})=>{var o;return Se.default.createElement(Se.default.Fragment,null,Se.default.createElement("div",{className:"trade-overview-section"},Se.default.createElement("div",{className:"trade-metrics-grid"},Se.default.createElement("div",{className:"metric-card"},Se.default.createElement("div",{className:"metric-label"},"Entry"),Se.default.createElement("div",{className:"metric-value"},Wt(e.entryPrice)),Se.default.createElement("div",{className:"metric-subtitle"},n(e.entryTime))),Se.default.createElement("div",{className:"metric-card"},Se.default.createElement("div",{className:"metric-label"},"Exit"),Se.default.createElement("div",{className:"metric-value"},Wt(e.exitPrice)),Se.default.createElement("div",{className:"metric-subtitle"},n(e.exitTime))),Se.default.createElement("div",{className:"metric-card"},Se.default.createElement("div",{className:"metric-label"},"Size"),Se.default.createElement("div",{className:"metric-value"},e.positionSize),Se.default.createElement("div",{className:"metric-subtitle"},e.direction)),Se.default.createElement("div",{className:"metric-card"},Se.default.createElement("div",{className:"metric-label"},"Duration"),Se.default.createElement("div",{className:"metric-value"},t.duration),Se.default.createElement("div",{className:"metric-subtitle"},"\xA0")))),Se.default.createElement("div",{className:"trade-main-content"},Se.default.createElement("div",{className:"thesis-section"},Se.default.createElement("h4",null,"Thesis"),e.thesis?Se.default.createElement("div",{className:"thesis-content"},(o=e.thesis)==null?void 0:o.split(`
`).map((a,s)=>Se.default.createElement(Se.default.Fragment,{key:s},a,s<e.thesis.split(`
`).length-1&&Se.default.createElement("br",null)))):Se.default.createElement(Ae,{message:"No thesis provided for this trade",subMessage:i?"Click 'Edit' to add a thesis":void 0,iconSize:32}))),Se.default.createElement("div",{className:"trade-details-footer"},Se.default.createElement("div",{className:"details-card expanded-details"},Se.default.createElement("div",{className:"details-header"},Se.default.createElement("h4",null,"Trade Details")),Se.default.createElement("table",{className:"details-table"},Se.default.createElement("tbody",null,Se.default.createElement("tr",null,Se.default.createElement("td",null,"Instrument"),Se.default.createElement("td",null,e.instrument||"N/A"),Se.default.createElement("td",null,"Direction"),Se.default.createElement("td",null,e.direction||"N/A")),Se.default.createElement("tr",null,Se.default.createElement("td",null,"Position Size"),Se.default.createElement("td",null,e.positionSize||"N/A"),Se.default.createElement("td",null,"P&L"),Se.default.createElement("td",{className:t.isProfit?"profit-text":"loss-text"},fe(t.pnl),!e.useDirectPnLInput&&` (${t.percentChange.toFixed(2)}%)`)),aE(e)!==0&&Se.default.createElement("tr",null,Se.default.createElement("td",null,"Trading Costs"),Se.default.createElement("td",{colSpan:3,className:"cost-breakdown"},b_(e),Se.default.createElement("span",{className:"total-cost"}," | Total: ",fe(aE(e))))),Se.default.createElement("tr",null,Se.default.createElement("td",null,"Entry Price"),Se.default.createElement("td",null,Wt(e.entryPrice)),Se.default.createElement("td",null,"Exit Price"),Se.default.createElement("td",null,Wt(e.exitPrice))),Se.default.createElement("tr",null,Se.default.createElement("td",null,"Entry Time"),Se.default.createElement("td",null,r(e.entryTime)),Se.default.createElement("td",null,"Exit Time"),Se.default.createElement("td",null,r(e.exitTime))),Se.default.createElement("tr",null,Se.default.createElement("td",null,"Duration"),Se.default.createElement("td",{colSpan:3},t.duration)))))))};var _s=$(W());var fh=({instrument:e,direction:t,isProfit:r,pnl:n,percentChange:i,useDirectPnLInput:o,isMissedTrade:a,exitTime:s,tradeStatus:l,exits:c})=>{let d=l==="OPEN"||at({useDirectPnLInput:o,exitTime:s,tradeStatus:l,exits:c,pnl:void 0});return _s.default.createElement("div",{className:`trade-note-header ${d?"open":r?"profit":"loss"}`},_s.default.createElement("div",{className:"trade-instrument"},_s.default.createElement("span",{className:"trade-direction-icon"},(t||"").toLowerCase()==="long"?"\u25B2":"\u25BC"),e||"Unknown Instrument",a&&_s.default.createElement("span",{className:"missed-trade-badge"},"MISSED"),d&&_s.default.createElement("span",{className:"open-trade-badge"},"OPEN")),_s.default.createElement("div",{className:"trade-header-actions"},_s.default.createElement("div",{className:"trade-pnl"},d?_s.default.createElement("span",{className:"open-text"},"OPEN"):_s.default.createElement("span",{className:r?"profit-text":"loss-text"},n>0?"+":"",fe(n),!o&&` (${i.toFixed(2)}%)`))))};var J_=$(W());Yt();var gh=({data:e})=>({metrics:(0,J_.useMemo)(()=>{let i=at({tradeStatus:e.tradeStatus,exitTime:e.exitTime,pnl:e._originalPnlWasNull?null:e.pnl,useDirectPnLInput:e.useDirectPnLInput,exits:e.exits}),o=e.entryPrice||0,a=e.exitPrice||0,s=e.positionSize||0,l=(e.direction||"").toLowerCase()==="long";if(i)return{pnl:0,percentChange:0,duration:"",isProfit:!1};let c=e.pnl!==void 0?e.pnl:l?(a-o)*s:(o-a)*s,d=e.useDirectPnLInput||o===0?0:l?(a-o)/o*100:(o-a)/o*100,u="";if(e.entryTime&&e.exitTime){let p=typeof e.entryTime=="string"?new Date(e.entryTime):e.entryTime,g=(typeof e.exitTime=="string"?new Date(e.exitTime):e.exitTime).getTime()-p.getTime(),f=Math.floor(g/(1e3*60*60)),y=Math.floor(g%(1e3*60*60)/(1e3*60)),h=Math.floor(g%(1e3*60)/1e3);f>0?u=`${f}h ${y}m`:y>0?u=`${y}m ${h}s`:u=`${h}s`}return{pnl:c,percentChange:d,duration:u,isProfit:c>0}},[e.entryPrice,e.exitPrice,e.positionSize,e.direction,e.pnl,e.entryTime,e.exitTime,e.tradeStatus,e.useDirectPnLInput,e.exits]),formatDate:i=>{if(!i)return"N/A";let o=new Date(i),a=fr(),s=Ze(o,a),l=o.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return`${s} ${l}`},formatTime:i=>i?new Date(i).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"N/A"});oi();var ww=$(W());Yt();var zs=({reviewed:e=!1,reviewedAt:t,onMarkReviewed:r,label:n="Mark as Reviewed",className:i=""})=>{let o=fr();return ww.default.createElement("div",{className:`review-button-container ${i}`},ww.default.createElement(Ya,{variant:"primary",onClick:r,disabled:e,className:"review-button"},e?"\u2713 Reviewed":n),e&&t&&ww.default.createElement("span",{className:"review-timestamp"},"Reviewed on ",Ze(new Date(t),o)))};var X_=Me.default.memo(({data:e,onEditClick:t})=>{var f;let[r,n]=(0,Me.useState)(e.filePath||"unknown"),[i,o]=(0,Me.useState)({reviewed:e.reviewed,reviewedAt:e.reviewedAt});(0,Me.useEffect)(()=>{o({reviewed:e.reviewed,reviewedAt:e.reviewedAt})},[e.reviewed,e.reviewedAt]);let a=(0,Me.useRef)(null),{metrics:s,formatDate:l,formatTime:c}=gh({data:e}),d=Ge();(0,Me.useEffect)(()=>{vd(),Yg();let y=e.images||[];if(a.current){a.current.classList.add("missed-trade-note-mounted"),a.current.setAttribute("data-mounted-at",Date.now().toString());let h=a.current.closest(".journalit-missed-trade-view");h&&h.classList.add("missed-trade-note-mounted")}},[]);let u=(0,Me.useCallback)(y=>{if(a.current=y,y&&(!r||r==="unknown")){let h=y.getAttribute("data-displaying-file");if(h){n(h);return}let v=y.parentElement;for(;v;){let b=v.getAttribute("data-displaying-file")||v.getAttribute("data-file-path");if(b){n(b);break}v=v.parentElement}}},[r]),p=async y=>{if(!d||!d.accountService){console.error("Cannot navigate to account: Account service not available");return}try{let h=await d.accountService.getAccount(y);h||(h=await d.accountService.getAccountByName(y)),h?d.openFile?d.openFile(h.notePath,!1):d.app&&d.app.workspace.openLinkText(h.notePath,"",!1):console.error(`Could not find account: ${y}`)}catch(h){console.error("Error navigating to account:",h)}},m=(0,Me.useCallback)(()=>{t&&t(e)},[e,t]),g=(0,Me.useCallback)(()=>{if(d!=null&&d.missedTradeService&&r&&r!=="unknown"){let y=new Date().toISOString();o({reviewed:!0,reviewedAt:y}),d.missedTradeService.updateMissedTradeReviewStatus(r,!0,y).then(()=>{console.log("Missed trade marked as reviewed")}).catch(h=>{console.error("[MissedTradeNote] Error updating review status:",h),o({reviewed:e.reviewed,reviewedAt:e.reviewedAt})})}},[d,r,e.reviewed,e.reviewedAt]);return Me.default.createElement("div",{className:"missed-trade-note-container",ref:u,"data-file-path":r,style:{margin:0}},Me.default.createElement(fh,{instrument:e.instrument,direction:e.direction,isProfit:s.isProfit,pnl:s.pnl,percentChange:s.percentChange,useDirectPnLInput:e.useDirectPnLInput,isMissedTrade:!0}),(e.entryTime||e.useDirectPnLInput)&&Me.default.createElement(HK,{data:e,filePath:r,onEditClick:t,handleEditClick:m}),Me.default.createElement("div",{className:"missed-trade-note-content"},Me.default.createElement(uh,{images:e.images,onEditClick:m}),Me.default.createElement(ph,{data:e,onAccountClick:p}),Me.default.createElement(mh,{data:e,metrics:s,formatDate:l,formatTime:c,onEditClick:m}),e.missedReason&&Me.default.createElement("div",{className:"missed-trade-reason-section"},Me.default.createElement("div",{className:"details-card"},Me.default.createElement("h4",null,"Why I missed this trade"),Me.default.createElement("div",{className:"missed-trade-reason-content"},(f=e.missedReason)==null?void 0:f.split(`
`).map((y,h)=>Me.default.createElement(Me.default.Fragment,{key:h},y,h<e.missedReason.split(`
`).length-1&&Me.default.createElement("br",null)))))),Me.default.createElement("div",{className:"missed-trade-note-review-section"},Me.default.createElement(zs,{reviewed:i.reviewed,reviewedAt:i.reviewedAt,onMarkReviewed:g}))))},(e,t)=>e.data.pnl===t.data.pnl&&e.data.entryTime===t.data.entryTime&&e.data.exitTime===t.data.exitTime&&e.data.instrument===t.data.instrument&&e.data.direction===t.data.direction&&e.data.missedReason===t.data.missedReason&&JSON.stringify(e.data.images)===JSON.stringify(t.data.images)&&e.onEditClick===t.onEditClick),HK=Me.default.memo(({data:e,filePath:t,onEditClick:r,handleEditClick:n})=>{let i=Ge(),[o,a]=(0,Me.useState)([]),[s,l]=(0,Me.useState)([]),[c,d]=(0,Me.useState)(!1),[u,p]=(0,Me.useState)(!1),[m,g]=(0,Me.useState)(0),f=Me.default.useMemo(()=>{if(e.entryTime)return new Date(e.entryTime);if(t&&t!=="unknown"){let T=t.match(/(\d{2})(\d{2})(\d{2})-M\d+\.md$/);if(T){let[,E,C,N]=T,D=2e3+parseInt(N,10);return new Date(D,parseInt(C,10)-1,parseInt(E,10))}}return new Date},[e.entryTime,t]),y=Me.default.useMemo(()=>{if(!f||!i)return null;let{start:T,end:E}=gw(f,i);return{startDate:T,endDate:E}},[f,i]),h=Me.default.useMemo(()=>!f||!i?"":xl(f,i),[f,i]),v=Me.default.useRef(null);(0,Me.useEffect)(()=>{let T=v.current;if(!T)return;let E=new IntersectionObserver(C=>{let[N]=C;N.isIntersecting&&(p(!0),E.disconnect())},{rootMargin:"50px",threshold:.1});return E.observe(T),()=>E.disconnect()},[]),(0,Me.useEffect)(()=>{let T=E=>{let{action:C}=E.detail;(C==="created"||C==="updated")&&h&&setTimeout(()=>{Object.keys(sessionStorage).forEach(N=>{(N.startsWith("trade-nav-")||N.startsWith("missed-trade-nav-"))&&sessionStorage.removeItem(N)}),a([]),l([]),d(!1),g(N=>N+1)},200)};return document.addEventListener("journalit:trade-data-changed",T),document.addEventListener("journalit:missed-trade-data-changed",T),()=>{document.removeEventListener("journalit:trade-data-changed",T),document.removeEventListener("journalit:missed-trade-data-changed",T)}},[h]),(0,Me.useEffect)(()=>{if(!u||!y||!(i!=null&&i.tradeService)||!(i!=null&&i.missedTradeService)||!h)return;let T=!0;return(async()=>{try{if(c)return;d(!0),setTimeout(async()=>{try{let[C,N]=await Promise.all([i.tradeService.getTrades(y.startDate,y.endDate),i.missedTradeService.getMissedTrades(y.startDate,y.endDate)]);T&&(a(C),l(N))}catch(C){console.error("Error fetching trades for day:",C)}finally{T&&d(!1)}},100)}catch(C){console.error("Error in trade fetch setup:",C),T&&d(!1)}})(),()=>{T=!1}},[u,y,i==null?void 0:i.tradeService,i==null?void 0:i.missedTradeService,h,m]);let b=(0,Me.useCallback)((T,E=!1)=>{try{i&&i.openFile?i.openFile(T,E):i!=null&&i.app?i.app.workspace.openLinkText(T,"",E):console.error("Cannot navigate: Plugin and App context not available.")}catch(C){console.error("Navigation error:",C)}},[i]),w=(0,Me.useCallback)(T=>i!=null&&i.drcService?i.drcService.getDRCNotePath(T):"",[i==null?void 0:i.drcService]),k=(0,Me.useCallback)(T=>i!=null&&i.weeklyReviewService?i.weeklyReviewService.getWeeklyReviewPath(T):"",[i==null?void 0:i.weeklyReviewService]),S=(0,Me.useCallback)(T=>i!=null&&i.drcService?i.drcService.getMonthlyReviewPath(T):null,[i==null?void 0:i.drcService]),x=(0,Me.useCallback)(()=>null,[]);return!f||!(i!=null&&i.drcService)||!(i!=null&&i.weeklyReviewService)?null:Me.default.createElement("div",{ref:v},u?Me.default.createElement(Me.default.Fragment,null,Me.default.createElement(bw,{currentDate:f,trades:o,missedTrades:s,currentTradePath:t,navigateTo:b,getDRCPath:w,getWeeklyReviewPath:k,getMonthlyReviewPath:S,getYearlyReviewPath:x,onEditClick:r,handleEditClick:n})):Me.default.createElement("div",{style:{height:"60px",display:"flex",alignItems:"center",justifyContent:"center"}},Me.default.createElement("div",{style:{color:"var(--text-muted)",fontSize:"12px"}},"Loading navigation...")))});var Q_=$(Ps()),Qi=class{constructor(t){this.reactRoots=new Map;this.rootCreationTimes=new Map;this.app=t}getOpenNoteFunction(){var t,r;try{let n=(r=(t=window.app)==null?void 0:t.plugins)==null?void 0:r.plugins.journalit;return n?(i,o=!1)=>{n.openFile(i,o)}:void 0}catch(n){console.error(`[${this.constructor.name}] Error getting openNote function:`,n);return}}unmountComponent(t,r,n,i){let o=[`${t}-${r}`,n?`${t}-leaf-${n}`:null,r.startsWith("leaf-")?`${t}-${r}`:`${t}-leaf-${r}`,`${t}-view-${r}`,`${t}-context-${r}`,i?`${t}-context-${i}`:null].filter(Boolean),a=!1;for(let s of o){let l=this.reactRoots.get(s);if(l)try{l.root.unmount(),this.reactRoots.delete(s),this.rootCreationTimes.delete(s),a=!0,l.domContainer&&l.domContainer.isConnected&&l.domContainer.remove()}catch(c){console.error(`[${this.constructor.name}] Error unmounting component:`,c,{rootId:s})}}if(!a&&n){for(let[s,l]of this.reactRoots.entries())if(l.leafId===n&&s.startsWith(t))try{l.root.unmount(),this.reactRoots.delete(s),this.rootCreationTimes.delete(s),a=!0,l.domContainer&&l.domContainer.isConnected&&l.domContainer.remove()}catch(c){console.error(`[${this.constructor.name}] Error unmounting by leafId:`,c,{id:s})}}if(!a){for(let[s,l]of this.reactRoots.entries())if(s.startsWith(t))try{l.root.unmount(),this.reactRoots.delete(s),this.rootCreationTimes.delete(s),a=!0,l.domContainer&&l.domContainer.isConnected&&l.domContainer.remove()}catch(c){console.error(`[${this.constructor.name}] Error unmounting fallback component:`,c,{id:s})}}return a}unmountAllComponents(){var o,a;let t={},r=Date.now(),n=this.app.workspace.getActiveFile(),i=n==null?void 0:n.path;for(let[s,l]of this.reactRoots.entries())try{if(i&&s.startsWith(i))continue;let c=this.rootCreationTimes.get(s)||r,d=((r-c)/1e3).toFixed(1);t[s]={domContainer:((o=l.domContainer)==null?void 0:o.tagName)||"unknown",isConnected:((a=l.domContainer)==null?void 0:a.isConnected)||!1,ageSeconds:d};try{l.root.unmount()}catch(u){}if(l.domContainer&&l.domContainer.isConnected)try{l.domContainer.remove()}catch(u){}}catch(c){console.error(`[${this.constructor.name}] Error unmounting root:`,{rootId:s,error:c})}for(let s of Object.keys(t))this.reactRoots.delete(s),this.rootCreationTimes.delete(s);this.cleanupOrphanedDomElements()}unmountLeafComponents(t){let r=[];for(let[n,i]of this.reactRoots.entries())if(i.leafId===t)try{i.root.unmount(),r.push(n),i.domContainer&&i.domContainer.isConnected&&i.domContainer.remove()}catch(o){console.error(`[${this.constructor.name}] Error unmounting leaf component:`,{rootId:n,leafId:t,error:o})}r.length>0&&(r.forEach(n=>this.reactRoots.delete(n)),this.cleanupLeafDomElements(t))}cleanupLeafDomElements(t){let r=this.getComponentClassName(),n=this.getWrapperClassName(),i=document.querySelectorAll(`.${r}[data-leaf-id="${t}"]`),o=document.querySelectorAll(`.${n}[data-leaf-id="${t}"]`);i.forEach(a=>{try{a.remove()}catch(s){console.error(`[${this.constructor.name}] Error removing leaf view element:`,s)}}),o.forEach(a=>{try{a.remove()}catch(s){console.error(`[${this.constructor.name}] Error removing leaf wrapper element:`,s)}})}cleanupOrphanedDomElements(){let t=this.getComponentClassName(),r=this.getWrapperClassName(),n=document.querySelectorAll(`.${t}`),i=document.querySelectorAll(`.${r}`);n.forEach(o=>{try{o.remove()}catch(a){console.error(`[${this.constructor.name}] Error removing orphaned view element:`,a)}}),i.forEach(o=>{try{o.remove()}catch(a){console.error(`[${this.constructor.name}] Error removing orphaned wrapper element:`,a)}})}findContainingLeaf(t){var o,a;let r=t.closest(".workspace-leaf");if(!r)return;let n=r.id;if(!n){let s=r.querySelector(".workspace-tab-header");if(s){let c=(o=s.textContent)==null?void 0:o.trim();if(c){let d;if(this.app.workspace.iterateAllLeaves(u=>{u.getDisplayText()===c&&(d=u)}),d)return d}}let l=r.querySelector(".view-header-title-container");if(l){let c=(a=l.textContent)==null?void 0:a.trim();if(c){let d;if(this.app.workspace.iterateAllLeaves(u=>{let p=u.view;p&&"file"in p&&p.file&&p.file.basename===c&&(d=u)}),d)return d}}return}let i;return this.app.workspace.iterateAllLeaves(s=>{var d;let l=(d=s.view)==null?void 0:d.containerEl,c=s.containerEl;(l&&l.id===n||c&&c.id===n)&&(i=s)}),i||this.app.workspace.iterateAllLeaves(s=>{var c;let l=(c=s.view)==null?void 0:c.containerEl;l&&l.contains(t)&&(i=s)}),i}createReactRoot(t,r,n,i,o,a){let s=document.createElement("div");s.className=this.getWrapperClassName(),s.setAttribute(`data-${this.getComponentClassName()}-root-id`,r),n&&s.setAttribute("data-leaf-id",n),i&&s.setAttribute("data-context-id",i),s.setAttribute("data-protected","true"),t.appendChild(s);let l=(0,Q_.createRoot)(s),c={root:l,domContainer:s,leafId:n};this.reactRoots.set(r,c),this.rootCreationTimes.set(r,Date.now());let d=this.getOpenNoteFunction();return l.render(this.createReactElement(o,a,d)),c}getDomPath(t){let r=[],n=t;for(;n&&n!==document.body;){let i=n.nodeName.toLowerCase();if(n.id)i+=`#${n.id}`;else{n.className&&(i+=`.${Array.from(n.classList).join(".")}`);let o=n.parentElement?Array.from(n.parentElement.children):[];if(o.length>1){let a=o.indexOf(n);i+=`:nth-child(${a+1})`}}r.unshift(i),n=n.parentElement}return r.join(" > ")}};var $p=class extends Qi{constructor(t){super(t)}renderComponent(t,r,n,i,o){t.querySelector(".missed-trade-note-container.missed-trade-note-mounted")||this.renderMissedTradeNote(t,r,n,i,o)}renderMissedTradeNote(t,r,n,i,o){try{if(Yg(),!t||!t.isConnected){console.error(`[MissedTradeNote] Cannot render into disconnected container for ${n}`);return}let a=o?`${n}-${i}-${o}`:`${n}-${i}`,s=i.startsWith("leaf-")?i.substring(5):i,l=this.processMissedTradeData(r);t.setAttribute("data-displaying-file",n);let c=this.findContainingLeaf(t),d=t.querySelector(".journalit-missed-trade-note-wrapper");if(d){if(d.querySelector(".missed-trade-note-mounted"))return;d.remove()}let u=null;if(c&&c.view){let f=c.view.containerEl,y=c.containerEl;f&&f.id?u=f.id:y&&y.id&&(u=y.id)}let p=this.reactRoots.get(a);if(p&&p.domContainer&&p.domContainer.isConnected&&p.domContainer.querySelector(".missed-trade-note-mounted"))return;t.empty();let m=this.reactRoots.get(a);if(m&&(c&&u&&m.leafId!==u||o&&m.domContainer&&m.domContainer.getAttribute("data-context-id")!==o)){let f=o?`${n}-context-${o}`:`${n}-${i}-${u}`;if(m=this.reactRoots.get(f),!m){this.createReactRoot(t,f,u||void 0,o,l,n);return}}if(!m)this.createReactRoot(t,a,u||void 0,o,l,n);else{let f=m.domContainer;t.contains(f)?m.root.render(this.createReactElement(l,n)):this.createReactRoot(t,a,u||void 0,o,l,n)}}catch(a){console.error("[MissedTradeNote] Error rendering missed trade note:",a),t.setText("Error rendering missed trade note: "+(a instanceof Error?a.message:String(a)))}}getComponentClassName(){return"journalit-missed-trade-view"}getWrapperClassName(){return"journalit-missed-trade-note-wrapper"}createReactElement(t,r,n){let i=a=>{var l,c;let s=(c=(l=window.app)==null?void 0:l.plugins)==null?void 0:c.plugins.journalit;if(!s){console.error("Cannot access plugin instance for edit action");return}s.openTradeFormInEditMode?s.openTradeFormInEditMode(a,r):console.warn("Edit mode not available - plugin method missing")},o=async a=>{var l,c;let s=(c=(l=window.app)==null?void 0:l.plugins)==null?void 0:c.plugins.journalit;if(!s||!s.missedTradeService){console.error("Cannot access plugin instance for data update");return}try{await s.missedTradeService.updateMissedTrade(a,r,"user-input")}catch(d){console.error("[MissedTradeNote] Error updating missed trade data:",d)}};return Z_.default.createElement(X_,{data:{...t,filePath:r},onEditClick:i,onDataUpdate:o})}unmountMissedTradeNote(t,r,n,i){return this.unmountComponent(t,r,n)}unmountAllMissedTradeNotes(){this.unmountAllComponents()}unmountLeafMissedTradeNotes(t){this.unmountLeafComponents(t)}processMissedTradeData(t){let r={...t};return r.isMissedTrade=!0,t.images&&(r.images=this.normalizeImagePaths(t.images)),["setupIds","mistakeIds","accountIds","setup","mistake","account","tags","ctags"].forEach(n=>{if(r[n]&&!Array.isArray(r[n]))if(typeof r[n]=="string"&&r[n].startsWith("[")&&r[n].endsWith("]"))try{let i=r[n].slice(1,-1).trim();i?r[n]=i.split(",").map(o=>o.trim()):r[n]=[]}catch(i){console.error(`[MissedTradeNote] Failed to parse array string: ${n}`,i),r[n]=[r[n]]}else r[n]=[r[n]]}),["entryTime","exitTime"].forEach(n=>{if(r[n]&&typeof r[n]=="string")try{r[n]=new Date(r[n])}catch(i){console.error(`[MissedTradeNote] Failed to parse date: ${n}`,i)}}),["entryPrice","exitPrice","positionSize","pnl","directPnL"].forEach(n=>{if(r[n]!==void 0&&typeof r[n]!="number")try{r[n]=parseFloat(r[n])}catch(i){console.error(`[MissedTradeNote] Failed to parse number: ${n}`,i)}}),["useDirectPnLInput","isMissedTrade"].forEach(n=>{if(r[n]!==void 0&&typeof r[n]!="boolean")try{r[n]=!!r[n]}catch(i){console.error(`[MissedTradeNote] Failed to parse boolean: ${n}`,i)}}),r.thesis=ah(t.thesis)||"",r.missedReason=ah(t.missedReason)||"",r}normalizeImagePaths(t){if(!t)return[];if(Array.isArray(t))return t.map((n,i)=>typeof n!="string"?String(n):n.replace(/['"`]/g,"").trim()).filter(n=>!!n&&n.length>0&&!n.match(/^[\s]*$/));if(typeof t=="string"&&t.startsWith("[")&&t.endsWith("]"))try{let r=t.slice(1,-1).trim();return r?r.split(",").map(n=>n.trim().replace(/['"`]/g,"")).filter(Boolean):[]}catch(r){return console.error("[MissedTradeNote] Failed to parse images string:",r),[t.replace(/['"`]/g,"").trim()]}if(typeof t=="string"){let r=t.replace(/['"`]/g,"").trim();return r?[r]:[]}return[]}};var ez=require("obsidian"),Zi=class{constructor(t,r,n){this.activeObservers=[];this.registeredLeaves=new Set;this.renderedFilePaths=new Map;this.app=t,this.plugin=r,this.renderer=n}initialize(){this.app.workspace.onLayoutReady(()=>{this.cleanupOrphanedComponents(),this.handleInitialFileOpen()}),this.registerMarkdownPostProcessor(),this.setupFileOpenHandler(),this.setupLayoutChangeHandler()}cleanup(){this.activeObservers.forEach(t=>{t.disconnect()}),this.renderer.unmountAllComponents(),this.activeObservers=[],this.registeredLeaves.clear(),this.renderedFilePaths.clear()}registerMarkdownPostProcessor(){this.plugin.registerMarkdownPostProcessor(this.handleMarkdownPostProcessor.bind(this))}setupLayoutChangeHandler(){this.plugin.registerEvent(this.app.workspace.on("layout-change",this.handleLayoutChange.bind(this))),this.plugin.registerEvent(this.app.workspace.on("editor-change",(t,r)=>{if(r&&"file"in r){let n=r.file;if(n){let i=this.app.metadataCache.getFileCache(n),o=i==null?void 0:i.frontmatter;if(o&&this.isValidComponentType(o)){let a=r.getMode,l=(typeof a=="function"?a.call(r)==="source":!1)?"source":"preview";this.clearFileRenderedStatus(n.path,l),setTimeout(()=>{this.handleFileOpen(n,!0)},50)}}}})),this.app.workspace.onLayoutReady(()=>{this.app.workspace.iterateAllLeaves(t=>{var n;let r=(n=t.view)==null?void 0:n.containerEl;r&&r.id&&this.registeredLeaves.add(r.id)})})}handleLayoutChange(){let t=new Set;this.app.workspace.iterateAllLeaves(n=>{var o;let i=(o=n.view)==null?void 0:o.containerEl;i&&i.id&&(t.add(i.id),this.registeredLeaves.has(i.id)||this.registeredLeaves.add(i.id))});let r=[];this.registeredLeaves.forEach(n=>{t.has(n)||r.push(n)}),r.forEach(n=>{this.registeredLeaves.delete(n),this.renderer.unmountLeafComponents(n)})}async handleMarkdownPostProcessor(t,r){var s,l;if(!r.sourcePath)return;let n=this.app.vault.getAbstractFileByPath(r.sourcePath);if(!(n instanceof ez.TFile))return;let i=this.app.metadataCache.getFileCache(n),o=i==null?void 0:i.frontmatter;if(!o||!this.isValidComponentType(o))return;if(((s=t.parentElement)==null?void 0:s.classList.contains("markdown-preview-view"))&&!r.sourcePath.endsWith("#")&&!t.previousElementSibling){if(this.isFileRenderedInMode(n.path,"preview"))return;let c=t.parentElement;if(!c){console.warn(`[${this.constructor.name}] Cannot find parent markdown view for:`,r.sourcePath);return}let d=c.closest(".workspace-leaf-content");if(!d){console.warn(`[${this.constructor.name}] Cannot find containing leaf for:`,r.sourcePath);return}let u=c.closest(".workspace-leaf"),p=u==null?void 0:u.id,m=this.findContainingLeaf(d),g=(l=m==null?void 0:m.view)==null?void 0:l.containerEl,f=p||(g==null?void 0:g.id)||null,y=this.getUniqueElementId(c),h=f?`leaf-${f}`:y,v=!0;if(m){let T=m.view,E=null;("file"in T||T&&"getViewType"in T&&T.getViewType()==="markdown")&&(E=T.file),E&&(v=E.path===n.path)}if(!v)return;let b=this.getComponentClassName();c.querySelectorAll(`.${b}`).forEach(T=>{let E=T.getAttribute("data-file-path");if(E&&E!==n.path){let C=T.getAttribute("data-view-id"),N=T.getAttribute("data-leaf-id");C&&this.renderer.unmountComponent(E,C,N||void 0),T.remove()}});let w=this.getWrapperClassName();if(Array.from(c.querySelectorAll(`.${w}`)).filter(T=>{var E;return((E=T.closest(`.${b}`))==null?void 0:E.getAttribute("data-file-path"))===n.path}).length>0||Array.from(c.querySelectorAll(`.${b}`)).find(T=>T.getAttribute("data-file-path")===n.path))return;c.querySelectorAll(`.${b}`).forEach(T=>{T.getAttribute("data-file-path")===n.path&&T.remove()});let x=document.createElement("div");x.className=this.getComponentClassName(),x.setAttribute("data-file-path",n.path),x.setAttribute("data-view-id",h),x.setAttribute("data-markdown-view-id",y),f&&x.setAttribute("data-leaf-id",f),x.setAttribute("data-inserted-at",Date.now().toString()),c.insertBefore(x,c.firstChild);try{let T=await this.getAdditionalDataForComponent(n,o);await this.renderer.renderComponent(x,{...o,...T},n.path,h,y),this.markFileRenderedInMode(n.path,"preview")}catch(T){console.error(`[${this.constructor.name}] Error rendering component:`,T),x.textContent=`Error rendering ${this.getComponentTypeIdentifier()}: ${T instanceof Error?T.message:String(T)}`}}}generateViewId(t){let r=t.closest(".workspace-leaf");if(r&&r.id)return`leaf-${r.id}`;let n=t.closest(".workspace-leaf-content");if(n&&n.id)return`content-${n.id}`;let i=t.closest(".view-content");if(i){let l=Array.from(document.querySelectorAll(".view-content")).indexOf(i);if(l>=0)return`view-content-${l}`}let o=t.closest(".markdown-preview-view");if(o){let l=Array.from(document.querySelectorAll(".markdown-preview-view")).indexOf(o);if(l>=0)return`markdown-view-${l}`}let a=t.closest(".cm-editor");if(a){let l=Array.from(document.querySelectorAll(".cm-editor")).indexOf(a);if(l>=0)return`editor-${l}`}if(t.parentElement){let l=Array.from(t.parentElement.children).indexOf(t);return`view-${Date.now()}-${l}`}return`view-${Date.now()}-${Math.random().toString(36).substring(2,9)}`}setupFileOpenHandler(){this.plugin.registerEvent(this.app.workspace.on("file-open",t=>this.handleFileOpen(t,!1))),this.app.workspace.onLayoutReady(()=>{let t=this.app.workspace.getActiveFile();t&&setTimeout(()=>{this.handleFileOpen(t,!0)},100)})}renderWithDeduplication(t){let{file:r,container:n,data:i,viewId:o,contextId:a}=t,s=t.componentClassName||this.getComponentClassName(),l=t.mountedClassName||"component-mounted",c=t.contentSelector||".component-container",d=`${r.path}-${o}-${Date.now()}`;if(n.setAttribute("data-render-request",d),n.setAttribute("data-debug-version","1.0.0"),n.getAttribute("data-mounted-at"))return!1;let p=n.querySelector(c);if(p&&p.classList.contains(l))return!1;let m=document.querySelectorAll(`.${s}[data-file-path="${r.path}"]`);if(Array.from(document.querySelectorAll(`.${s}`)).some(y=>{if(y.getAttribute("data-file-path")!==r.path)return!1;let v=y.querySelector(c),b=v&&(v.classList.contains(l)||v.querySelector("*")),w=parseInt(y.getAttribute("data-inserted-at")||"0"),k=Date.now()-w<5e3;return b&&k}))return this.markFileRenderedInMode(r.path,o),!1;let f=!!n.closest(".cm-editor");return n.setAttribute("data-view-mode",f?"source":"preview"),this.renderer.renderComponent(n,i,r.path,o,a),this.markFileRenderedInMode(r.path,o),!0}hasProperlyRenderedComponents(t,r,n,i){let o=r||this.getComponentClassName(),a=n||".component-container",s=i||"component-mounted",l=document.querySelectorAll(`.${o}[data-file-path="${t}"]`);return l.length===0?!1:Array.from(l).some(c=>{let d=c.querySelector(a);return d&&(d.classList.contains(s)||d.children&&d.children.length>0)})}cleanupDuplicateComponents(t,r){let n=r||this.getComponentClassName(),i=Array.from(document.querySelectorAll(`.${n}[data-file-path="${t}"]`)),o=0;if(i.length>1)for(let a=1;a<i.length;a++){let s=i[a],l=s.getAttribute("data-view-id"),c=s.getAttribute("data-leaf-id");l&&this.renderer.unmountComponent(t,l,c||void 0),s.remove(),o++}return o}getUniqueElementId(t){if(t.id)return`dom-${t.id}`;let r=t.tagName.toLowerCase(),i=Array.from(document.querySelectorAll(r)).indexOf(t),o=r;if(t.className){let l=t.className.split(" ")[0];l&&(o+=`.${l}`)}let s=Array.from(document.querySelectorAll(o)).indexOf(t);return`dom-${o.replace(/\./g,"-")}-${s}-${i}-${Date.now()}`}isFileRenderedInMode(t,r){let n=this.renderedFilePaths.get(t);return n?n.has(r):!1}markFileRenderedInMode(t,r){let n=this.renderedFilePaths.get(t);n||(n=new Set,this.renderedFilePaths.set(t,n)),n.add(r)}clearFileRenderedStatus(t,r){if(!r){this.renderedFilePaths.delete(t);return}let n=this.renderedFilePaths.get(t);n&&(n.delete(r),n.size===0&&this.renderedFilePaths.delete(t))}findContainingLeaf(t){let r=t.closest(".workspace-leaf");if(!r)return;let n=r.id;if(n){let a;if(this.app.workspace.iterateAllLeaves(s=>{var d;let l=(d=s.view)==null?void 0:d.containerEl,c=s.containerEl;(l&&l.id===n||c&&c.id===n)&&(a=s)}),a)return a}let i=r.querySelector(".view-header-title");if(i&&i.textContent){let a=i.textContent.trim(),s;if(this.app.workspace.iterateAllLeaves(l=>{let c=l.view;c&&"file"in c&&c.file&&c.file.basename===a&&(s=l)}),s)return s}let o;if(this.app.workspace.iterateAllLeaves(a=>{var l;let s=(l=a.view)==null?void 0:l.containerEl;s&&s.contains(t)&&(o=a)}),o)return o}cleanupUnrelatedComponents(t){var c;let r=this.app.workspace.activeLeaf;if(!r)return;let n=null;try{n=((c=r.view)==null?void 0:c.containerEl)||r.containerEl}catch(d){console.error(`[${this.constructor.name}] Could not get active leaf container:`,d);return}if(!n)return;let i=this.getComponentClassName(),o=n.querySelectorAll(`.${i}`);if(o.length===0)return;let a=this.getWrapperClassName(),s=n.querySelectorAll(`.${a}`),l=0;o.forEach(d=>{let u=d.getAttribute("data-file-path");if(!u||u===t)return;let p=d.getAttribute("data-view-id"),m=d.getAttribute("data-leaf-id");p&&this.renderer.unmountComponent(u,p,m||void 0),d.remove(),l++,this.clearFileRenderedStatus(u)}),s.forEach(d=>{let u=d.closest(`.${i}`);(!u||!u.isConnected)&&(d.remove(),l++)})}cleanupOrphanedComponents(){let t=this.app.workspace.activeLeaf;if(!t||!t.view)return;let r=null;try{r=t.view.containerEl||t.containerEl}catch(s){console.error(`[${this.constructor.name}] Could not get active leaf container:`,s);return}if(!r)return;let n=this.getComponentClassName(),i=r.querySelectorAll(`.${n}`);if(i.length===0)return;let o=t.view,a=null;(o&&"file"in o&&o.file||o&&"getViewType"in o&&o.getViewType()==="markdown")&&(a=o.file),i.forEach(s=>{let l=s.getAttribute("data-file-path");if(!l)return;let c=s.getAttribute("data-leaf-id");if(a&&a.path!==l){let d=s.getAttribute("data-view-id");d&&this.renderer.unmountComponent(l,d,c||void 0),s.remove(),this.clearFileRenderedStatus(l)}})}handleInitialFileOpen(){let t=this.app.workspace.getActiveFile();t&&this.handleFileOpen(t,!0),this.app.workspace.iterateAllLeaves(r=>{let n=r.view,i=null;(n&&"file"in n||n&&"getViewType"in n&&n.getViewType()==="markdown")&&(i=n.file),i&&(!t||i.path!==t.path)&&this.handleFileOpen(i,!0)})}};var Rp=class extends Zi{constructor(r,n){super(r,n,new $p(r));this._missedTradeUpdateListener=null;this.setupMissedTradeUpdateListener()}async getManualFrontmatter(r){try{let n=await this.app.vault.read(r),i={},o=n.match(/^---\n([\s\S]*?)\n---/m);if(o&&o[1]){let a=o[1].split(`
`),s=null,l=0,c=!1,d=!1,u={};for(let p=0;p<a.length;p++){let m=a[p],g=m.trim();if(!g)continue;let f=m.search(/\S/);if(g.startsWith("- ")){if(s&&d){let v=g.substring(2).trim().match(/^([^:]+):\s*(.*)$/);if(v){let k=v[1].trim(),S=v[2].trim();S==="true"?S=!0:S==="false"?S=!1:/^-?\d+(\.\d+)?$/.test(S)&&(S=parseFloat(S)),u[k]=S}let b=p+1<a.length?a[p+1]:"",w=b.search(/\S/);if(b.trim()&&!b.trim().startsWith("- ")&&w>l)continue;i[s]||(i[s]=[]),i[s].push({...u}),u={}}else s&&(i[s]||(i[s]=[]),i[s].push(g.substring(2).trim()));c=!0;continue}let y=m.match(/^([^:]+):\s*(.*)$/);if(y&&y[1]&&y[2]!==void 0){let h=y[1].trim(),v=y[2].trim();if(v===""){s=h,l=f,c=!1;let b=p+1<a.length?a[p+1]:"";b.trim().startsWith("- ")&&(d=(p+2<a.length?a[p+2]:"").search(/\S/)>b.search(/\S/));continue}if(s=null,c=!1,d=!1,v.startsWith("[")&&v.endsWith("]"))try{let b=v.slice(1,-1).trim();if(!b)i[h]=[];else{let w=b.match(/"[^"]*"|'[^']*'|[^,]+/g)||[];i[h]=w.map(k=>k.replace(/^["']|["']$/g,"").trim()).filter(Boolean)}}catch(b){console.error(`[MissedTradeProcessor] Error parsing array in frontmatter for ${h}:`,b),i[h]=v}else v==="true"?v=!0:v==="false"?v=!1:/^-?\d+(\.\d+)?$/.test(v)&&(v=parseFloat(v)),i[h]=v}else if(f>l&&s&&d){let h=g.match(/^([^:]+):\s*(.*)$/);if(h){let v=h[1].trim(),b=h[2].trim();b==="true"?b=!0:b==="false"?b=!1:/^-?\d+(\.\d+)?$/.test(b)&&(b=parseFloat(b)),u[v]=b}}}}else{let a=this.app.metadataCache.getFileCache(r);i=(a==null?void 0:a.frontmatter)||{}}return i}catch(n){console.error("[MissedTradeProcessor] Error parsing frontmatter manually:",n);let i=this.app.metadataCache.getFileCache(r);return(i==null?void 0:i.frontmatter)||{}}}isValidComponentType(r){return r&&(r.type==="missed-trade"||r.isMissedTrade===!0)}getComponentClassName(){return"journalit-missed-trade-view"}getWrapperClassName(){return"journalit-missed-trade-note-wrapper"}getComponentTypeIdentifier(){return"missed-trade"}async getAdditionalDataForComponent(r,n){return{}}async handleFileOpen(r,n=!1){if(!r)return;this.cleanupOrphanedComponents(),this.cleanupUnrelatedComponents(r.path);let i=await this.getManualFrontmatter(r);if(!i||!this.isValidComponentType(i))return;let o=document.body,a=new MutationObserver((s,l)=>{let c=document.querySelectorAll(".cm-editor");if(c.length===0)return;c.forEach(u=>{var T;let p=u.querySelector(".metadata-container");if(!p)return;let m=p.closest(".workspace-leaf-content");if(!m)return;let g=this.findContainingLeaf(m),f=(T=g==null?void 0:g.view)==null?void 0:T.containerEl,y=p.closest(".workspace-leaf"),v=(y==null?void 0:y.id)||(f==null?void 0:f.id)||null,b=this.getUniqueElementId(u),w=v?`leaf-${v}`:b,k=!0;if(g){let E=g.view,C=null;(E&&"file"in E||E&&"getViewType"in E&&E.getViewType()==="markdown")&&(C=E.file),C&&(k=C.path===r.path)}if(!k)return;let S=this.getComponentClassName();u.querySelectorAll(`.${S}`).forEach(E=>{let C=E.getAttribute("data-file-path");if(C&&C!==r.path){let N=E.getAttribute("data-view-id"),D=E.getAttribute("data-leaf-id");N&&this.renderer.unmountComponent(C,N,D||void 0),E.remove()}});let x=Array.from(u.querySelectorAll(`.${S}`)).find(E=>E.getAttribute("data-file-path")===r.path);x||(x=document.createElement("div"),x.className=S,x.style.marginTop="0px",x.style.marginBottom="0px",x.style.padding="0px",x.setAttribute("data-file-path",r.path),x.setAttribute("data-view-id",w),x.setAttribute("data-editor-id",b),v&&x.setAttribute("data-leaf-id",v),x.setAttribute("data-inserted-at",Date.now().toString()),p.after(x)),this.renderer.renderComponent(x,i,r.path,w,b),this.markFileRenderedInMode(r.path,"source")}),l.disconnect();let d=this.activeObservers.indexOf(l);d>-1&&this.activeObservers.splice(d,1)});this.activeObservers.push(a),a.observe(o,{childList:!0,subtree:!0}),setTimeout(()=>{a.disconnect();let s=this.activeObservers.indexOf(a);s>-1&&this.activeObservers.splice(s,1)},3e3)}renderAllActiveMissedTradeNotes(){let r=new Set;this.app.workspace.iterateAllLeaves(n=>{try{if(!n.view||!("file"in n.view))return;let i=n.view.file;if(!i||r.has(i.path))return;let o=this.app.metadataCache.getFileCache(i),a=o==null?void 0:o.frontmatter;if(!a||!this.isValidComponentType(a))return;r.add(i.path),setTimeout(()=>{this.handleFileOpen(i,!0)},300)}catch(i){console.error("[MissedTradeNote] Error rendering active missed trade note at startup:",i)}})}renderActiveComponent(){this.renderActiveMissedTradeNote()}setupMissedTradeUpdateListener(){let r=async n=>{try{if(!n.detail||!n.detail.filePath)return;let i=n.detail.filePath,o=this.app.vault.getAbstractFileByPath(i);if(!(o instanceof xw.TFile)){console.warn(`[MissedTradeProcessor] Cannot find file for path: ${i}`);return}await this.refreshMissedTradeNote(o)}catch(i){console.error("[MissedTradeProcessor] Error handling missed trade update event:",i)}};document.addEventListener("journalit:missed-trade-data-changed",r),this._missedTradeUpdateListener=r}async refreshMissedTradeNote(r){try{let n=await this.app.vault.read(r),i={},o=n.match(/^---\n([\s\S]*?)\n---/m);if(o&&o[1]){let c=o[1].split(`
`),d=null,u=0,p=!1,m=!1,g={};for(let f=0;f<c.length;f++){let y=c[f],h=y.trim();if(!h)continue;let v=y.search(/\S/);if(h.startsWith("- ")){if(d&&m){let k=h.substring(2).trim().match(/^([^:]+):\s*(.*)$/);if(k){let T=k[1].trim(),E=k[2].trim();E==="true"?E=!0:E==="false"?E=!1:/^-?\d+(\.\d+)?$/.test(E)&&(E=parseFloat(E)),g[T]=E}let S=f+1<c.length?c[f+1]:"",x=S.search(/\S/);if(S.trim()&&!S.trim().startsWith("- ")&&x>u)continue;i[d]||(i[d]=[]),i[d].push({...g}),g={}}else d&&(i[d]||(i[d]=[]),i[d].push(h.substring(2).trim()));p=!0;continue}let b=y.match(/^([^:]+):\s*(.*)$/);if(b&&b[1]&&b[2]!==void 0){let w=b[1].trim(),k=b[2].trim();if(k===""){d=w,u=v,p=!1;let S=f+1<c.length?c[f+1]:"";S.trim().startsWith("- ")&&(m=(f+2<c.length?c[f+2]:"").search(/\S/)>S.search(/\S/));continue}if(d=null,p=!1,m=!1,k.startsWith("[")&&k.endsWith("]"))try{let S=k.slice(1,-1).trim();if(!S)i[w]=[];else{let x=S.match(/"[^"]*"|'[^']*'|[^,]+/g)||[];i[w]=x.map(T=>T.replace(/^["']|["']$/g,"").trim()).filter(Boolean)}}catch(S){console.error(`[MissedTradeProcessor] Error parsing array in frontmatter for ${w}:`,S),i[w]=k}else k==="true"?k=!0:k==="false"?k=!1:/^-?\d+(\.\d+)?$/.test(k)&&(k=parseFloat(k)),i[w]=k}else if(v>u&&d&&m){let w=h.match(/^([^:]+):\s*(.*)$/);if(w){let k=w[1].trim(),S=w[2].trim();S==="true"?S=!0:S==="false"?S=!1:/^-?\d+(\.\d+)?$/.test(S)&&(S=parseFloat(S)),g[k]=S}}}}else{let c=this.app.metadataCache.getFileCache(r);i=(c==null?void 0:c.frontmatter)||{}}let a=r.path.includes("-M")&&r.path.endsWith(".md");if(!this.isValidComponentType(i)&&!a){console.warn(`[MissedTradeNote] File is not a valid missed trade note: ${r.path}`,{frontmatter:i,type:i==null?void 0:i.type,isMissedTrade:i==null?void 0:i.isMissedTrade,checkedByPath:a});return}this.app.metadataCache.trigger("changed",r),this.cleanupDuplicateComponents(r.path);let s=this.getComponentClassName(),l=document.querySelectorAll(`.${s}[data-file-path="${r.path}"]`);if(l.length===0)return;for(let c of Array.from(l)){let d=c.getAttribute("data-view-id"),u=c.getAttribute("data-markdown-view-id")||c.getAttribute("data-editor-id");d&&(c.style.display="block",c.querySelectorAll(`.${this.getWrapperClassName()}`).forEach(m=>m.remove()),await new Promise(m=>setTimeout(()=>{try{this.renderWithDeduplication({file:r,container:c,data:i,viewId:d,contextId:u||void 0,componentClassName:this.getComponentClassName(),mountedClassName:"missed-trade-note-mounted",contentSelector:".missed-trade-note-container"}),m()}catch(g){console.error("[MissedTradeNote] Error during re-render:",g),m()}},50)))}this.markFileRenderedInMode(r.path,"source"),this.markFileRenderedInMode(r.path,"preview")}catch(n){console.error(`[MissedTradeNote] Error refreshing missed trade note for ${r.path}:`,n)}}cleanup(){super.cleanup(),this._missedTradeUpdateListener&&(document.removeEventListener("journalit:missed-trade-data-changed",this._missedTradeUpdateListener),this._missedTradeUpdateListener=null)}async renderActiveMissedTradeNote(){var p;this.cleanupOrphanedComponents();let r=this.app.workspace.getActiveFile();if(!r)return;let n=await this.getManualFrontmatter(r);if(!n||!this.isValidComponentType(n))return;let i=this.app.workspace.getActiveViewOfType(xw.MarkdownView);if(!i){console.error("[MissedTradeNote] No active markdown view found");return}let o=i.containerEl.closest(".workspace-leaf-content");if(!o){console.error("[MissedTradeNote] Cannot find containing leaf for active view");return}let a=this.findContainingLeaf(o),s=(p=a==null?void 0:a.view)==null?void 0:p.containerEl,l=(s==null?void 0:s.id)||null,c=l?`leaf-${l}`:this.generateViewId(o),d=i.getMode()==="source",u=this.getComponentClassName();if(d){let m=i.containerEl.querySelector(".metadata-container");if(m){let g=Array.from(o.querySelectorAll(`.${u}`)).find(f=>{let y=f.getAttribute("data-file-path")===r.path,h=f.getAttribute("data-view-id")===c,v=!l||f.getAttribute("data-leaf-id")===l;return y&&h&&v});g||(g=document.createElement("div"),g.className=u,g.style.marginTop="0px",g.style.marginBottom="0px",g.style.padding="0px",g.setAttribute("data-file-path",r.path),g.setAttribute("data-view-id",c),l&&g.setAttribute("data-leaf-id",l),m.after(g)),this.renderer.renderComponent(g,n,r.path,c),this.markFileRenderedInMode(r.path,"source")}}else{let m=i.containerEl.querySelector(".markdown-preview-view");if(m){let g=Array.from(m.querySelectorAll(`.${u}`)).find(f=>{let y=f.getAttribute("data-file-path")===r.path,h=f.getAttribute("data-view-id")===c,v=!l||f.getAttribute("data-leaf-id")===l;return y&&h&&v});g||(g=document.createElement("div"),g.className=u,g.style.marginTop="0px",g.style.marginBottom="0px",g.style.padding="0px",g.setAttribute("data-file-path",r.path),g.setAttribute("data-view-id",c),l&&g.setAttribute("data-leaf-id",l),m.prepend(g)),this.renderer.renderComponent(g,n,r.path,c),this.markFileRenderedInMode(r.path,"preview")}}}};Bn();function tz(e=!1){if(!(window.__isInjectingStyles&&!e)){window.__isInjectingStyles=!0;try{Po(!1,!1,!0,!0,!1,!1,!1,!0),Z.shared&&Z.shared.inject(),Z.combobox&&Z.combobox.inject(),Z.settings&&Z.settings.inject(),Z.tooltip&&Z.tooltip.inject(),Vg()}catch(t){console.error("Failed to inject critical styles:",t)}finally{window.__isInjectingStyles=!1}}}function rz(){if(!window.__isInjectingStyles){window.__isInjectingStyles=!0;try{Z.chart&&Z.chart.inject(),Z.dragOverlay&&Z.dragOverlay.inject(),Z.image&&Z.image.inject(),Z.tradeForm&&Z.tradeForm.inject(),Z.weeklyReview&&Z.weeklyReview.inject(),Z.drc&&Z.drc.inject(),Z.drcNote&&Z.drcNote.inject(),Z.tradeNote&&Z.tradeNote.inject(),Z.dashboard&&Z.dashboard.inject(),Z.account&&Z.account.inject(),Z.transactionModal&&Z.transactionModal.inject(),typeof window!="undefined"&&Z.drc&&(window.__JOURNALIT_INJECT_DRC_STYLES=Z.drc.inject)}catch(e){console.error("Failed to inject non-critical styles:",e)}finally{window.__isInjectingStyles=!1}}}var Ur=require("obsidian");Sd();Yt();oi();Ha();var hh=class extends Ao{constructor(r,n={}){super(r,{folder:"Journalit",extension:".md",cacheTTL:5*60*1e3,persistCache:!0,namespace:n.namespace||"trade",enableIndexing:!0,indexes:[{name:"trades",fields:["instrument","direction","pnl","entryTime","exitTime","account","setup","mistake","tags","ctags","assetType"],includeNested:!1,fileFilter:i=>{var a;if(!i.path.endsWith(".md"))return!1;let o=(a=r.metadataCache.getFileCache(i))==null?void 0:a.frontmatter;return o!=null&&o.isMissedTrade?!1:(o==null?void 0:o.type)==="trade"?!0:i.path.includes("/trades/")&&i.path.includes("/Journalit/")}},{name:"trade-unique-values",fields:["instrument","account","setup","mistake","tags","ctags"],includeNested:!1,valueExtractor:(i,o)=>Array.isArray(i[o])?i[o]:typeof i[o]=="string"?i[o].split(",").map(a=>a.trim()).filter(Boolean):i[o],fileFilter:i=>{var a;if(!i.path.endsWith(".md"))return!1;let o=(a=r.metadataCache.getFileCache(i))==null?void 0:a.frontmatter;return o!=null&&o.isMissedTrade?!1:(o==null?void 0:o.type)==="trade"?!0:i.path.includes("/trades/")&&i.path.includes("/Journalit/")}}]});this.plugin=null;this.journalitFolder="!Journalit";this.tradesFolder="trades"}async updateTrade(r,n,i){var o,a,s,l,c,d,u,p,m,g,f,y,h,v;try{if(!r.entryTime)throw new Error("Entry time is required");if(!r.direction)throw new Error("Direction is required");let b=at({tradeStatus:r.tradeStatus,exitTime:r.exitTime,pnl:null,useDirectPnLInput:r.useDirectPnLInput,exits:r.exits});if(!b&&!r.exitTime)throw new Error("Exit time is required for closed trades");if(r.useDirectPnLInput)r.entryPrice===void 0&&(r.entryPrice=0),r.positionSize===void 0&&(r.positionSize=0),!b&&r.exitPrice===void 0&&(r.exitPrice=0);else{if(r.entryPrice===void 0)throw new Error("Entry price is required");if(r.positionSize===void 0)throw new Error("Position size is required");if(!b&&r.exitPrice===void 0)throw new Error("Exit price is required for closed trades")}if(!(r.accountIds&&r.accountIds.length>0||r.account&&r.account.length>0))throw new Error("At least one account is required");if(!await this.app.vault.adapter.exists(n))throw new Error(`Trade file does not exist: ${n}`);let S=this.app.vault.getAbstractFileByPath(n);if(!S||!(S instanceof Ur.TFile))throw new Error(`Invalid file path: ${n}`);let x,T=!0;try{let C=this.app.vault.getAbstractFileByPath(n);if(C&&C instanceof Ur.TFile){let N=(o=this.app.metadataCache.getFileCache(C))==null?void 0:o.frontmatter;N&&r.originalPnl!==void 0&&(T=N.entryPrice!==r.entryPrice||N.exitPrice!==r.exitPrice||N.positionSize!==r.positionSize||N.direction!==r.direction||N.commission!==r.commission||N.fees!==r.fees||N.tradeStatus!==r.tradeStatus||N.contractSize!==r.contractSize||N.dollarPerPoint!==r.dollarPerPoint||N.tickSize!==r.tickSize||N.tickValue!==r.tickValue||N.lotSize!==r.lotSize||N.pipValue!==r.pipValue||N.leverageRatio!==r.leverageRatio||JSON.stringify(N.entries)!==JSON.stringify(r.entries)||JSON.stringify(N.exits)!==JSON.stringify(r.exits))}}catch(C){console.warn("Could not compare with existing data, will recalculate PNL:",C)}b?x=null:!T&&r.originalPnl!==void 0?(x=r.originalPnl,console.log(`Preserving original PNL of ${x} since no financial fields changed`)):(x=Ep(r),console.log(`Recalculated PNL to ${x} due to financial field changes`));let E={type:"trade",entryTime:this.formatDateForFrontmatter(r.entryTime),entryPrice:r.entryPrice,positionSize:r.positionSize,direction:r.direction,tradeStatus:b?"OPEN":"CLOSED"};if(!b&&r.exitTime&&(E.exitTime=this.formatDateForFrontmatter(r.exitTime)),!b&&r.exitPrice!==void 0&&(E.exitPrice=r.exitPrice),!b&&x!==null&&(E.pnl=x),(a=r.entries)!=null&&a.length){let C=r.entries.filter(N=>N&&N.time!==void 0&&N.price!==void 0&&N.size!==void 0&&N.size>0);E.entries=C.map(N=>({time:this.formatDateForFrontmatter(N.time),price:N.price,size:N.size}))}if((s=r.exits)!=null&&s.length){let C=r.exits.filter(N=>N&&N.time!==void 0&&N.price!==void 0&&N.size!==void 0&&N.size>0);E.exits=C.map(N=>({time:this.formatDateForFrontmatter(N.time),price:N.price,size:N.size}))}if(r.commission!==void 0&&(E.commission=r.commission),r.fees!==void 0&&(E.fees=r.fees),(l=r.setupIds)!=null&&l.length&&(E.setupIds=r.setupIds),(c=r.mistakeIds)!=null&&c.length&&(E.mistakeIds=r.mistakeIds),(d=r.accountIds)!=null&&d.length&&(E.accountIds=r.accountIds),r.accountId&&(E.accountId=r.accountId),r.instrument&&(E.instrument=r.instrument),r.assetType&&(E.assetType=r.assetType),(u=r.setup)!=null&&u.length&&(E.setup=r.setup),(p=r.mistake)!=null&&p.length&&(E.mistake=r.mistake),(m=r.account)!=null&&m.length&&(E.account=r.account),(g=r.images)!=null&&g.length&&(E.images=r.images.map(C=>`"${C.trim()}"`)),E.tags=this.generateAutomaticTags(r),(f=r.ctags)!=null&&f.length&&(E.ctags=r.ctags),E.thesis=JSON.stringify(r.thesis||""),r.assetType==="stock"?r.exchange&&(E.exchange=r.exchange):r.assetType==="options"?(r.expirationDate&&(E.expirationDate=this.formatDateForFrontmatter(r.expirationDate)),r.strikePrice!==void 0&&(E.strikePrice=r.strikePrice),r.optionType&&(E.optionType=r.optionType),r.contractSize!==void 0&&(E.contractSize=r.contractSize)):r.assetType==="futures"?(r.dollarPerPoint!==void 0&&(E.dollarPerPoint=r.dollarPerPoint),r.tickSize!==void 0&&(E.tickSize=r.tickSize),r.tickValue!==void 0&&(E.tickValue=r.tickValue)):r.assetType==="forex"?(r.lotSize!==void 0&&(E.lotSize=r.lotSize),r.pipValue!==void 0&&(E.pipValue=r.pipValue)):r.assetType==="crypto"?r.cryptoExchange&&(E.cryptoExchange=r.cryptoExchange):r.assetType==="cfd"&&r.leverageRatio!==void 0&&(E.leverageRatio=r.leverageRatio),r.lossReview&&(E.lossReview=r.lossReview),r.reviewed!==void 0&&(E.reviewed=r.reviewed),r.reviewedAt&&(E.reviewedAt=r.reviewedAt),r.useDirectPnLInput!==void 0&&(E.useDirectPnLInput=r.useDirectPnLInput),r.directPnL!==void 0&&(E.directPnL=r.directPnL),await this.updateFrontmatter(S,E),await kt(this.app,S),this.app.metadataCache.trigger("changed",S),(y=this.plugin)!=null&&y.accountService){let C=x,N=0;try{let A=this.app.vault.getAbstractFileByPath(n);if(A&&A instanceof Ur.TFile){let P=(h=this.app.metadataCache.getFileCache(A))==null?void 0:h.frontmatter;P&&P.pnl!==void 0&&(N=parseFloat(P.pnl))}}catch(A){console.warn("Could not determine old PnL, using 0:",A)}if(N!==0||C!==null&&C!==0)try{let A=[...new Set([...r.accountIds||[],...r.account||[]])];for(let P of A)try{let I=await this.plugin.accountService.getAccountByName(P);I?await this.plugin.accountService.updateBalanceFromTrade(I.id,(0,Ur.normalizePath)(n),C||0,!0,N,r.entryTime):await this.plugin.accountService.updateBalanceFromTrade(P,(0,Ur.normalizePath)(n),C||0,!0,N,r.entryTime)}catch(I){console.error(`Error looking up account ${P}:`,I),await this.plugin.accountService.updateBalanceFromTrade(P,(0,Ur.normalizePath)(n),C||0,!0,N,r.entryTime)}}catch(A){console.error("Error updating account balances:",A)}else console.log("Skipping balance update - no P&L change needed")}i!=="user-input"&&setTimeout(()=>{let C=new CustomEvent("journalit:trade-data-changed",{detail:{action:"updated",filePath:n,timestamp:Date.now()}});document.dispatchEvent(C)},100),await this.clearCacheWithPrefix("trade:");try{if(r.entryTime&&((v=this.plugin)!=null&&v.drcService)){let C=new Date(r.entryTime);await this.plugin.drcService.updateDRCBacklinks(C)}}catch(C){console.error("Failed to update DRC backlinks after trade update:",C)}return n}catch(b){throw console.error("Error updating trade:",b),b}}get TRADES_FOLDER(){return this.tradesFolder}get JOURNALIT_FOLDER(){return this.journalitFolder}async getUniqueInstruments(){if(this.isIndexingEnabled()){let i=this.getUniqueIndexValues("trade-unique-values","instrument");if(i.length>0)return i.filter(Boolean)}let n=(await this.getAllTrades()).map(i=>this.getTradeValue(i,"instrument")).filter(Boolean);return Array.from(new Set(n))}async getUniqueAccounts(){if(this.isIndexingEnabled()){let i=this.getUniqueIndexValues("trade-unique-values","account");if(i.length>0)return i.filter(Boolean)}let n=(await this.getAllTrades()).flatMap(i=>this.getTradeArrayValue(i,"account")).filter(Boolean);return Array.from(new Set(n))}async getUniqueSetups(){if(this.isIndexingEnabled()){let i=this.getUniqueIndexValues("trade-unique-values","setup");if(i.length>0)return i.filter(Boolean)}let n=(await this.getAllTrades()).flatMap(i=>this.getTradeArrayValue(i,"setup")).filter(Boolean);return Array.from(new Set(n))}async getUniqueMistakes(){if(this.isIndexingEnabled()){let i=this.getUniqueIndexValues("trade-unique-values","mistake");if(i.length>0)return i.filter(Boolean)}let n=(await this.getAllTrades()).flatMap(i=>this.getTradeArrayValue(i,"mistake")).filter(Boolean);return Array.from(new Set(n))}formatTagForYAML(r){return r.trim().replace(/\s+/g,"-").toLowerCase().replace(/[^a-z0-9-]/g,"")}generateAutomaticTags(r){let n=[];if(n.push([aw()]),r.instrument&&n.push([r.instrument.trim()]),r.assetType&&n.push([Op(r.assetType)]),r.direction&&n.push([Mp(r.direction)]),r.exchange&&n.push([r.exchange.toLowerCase()]),r.setup&&Array.isArray(r.setup)&&r.setup.length>0){let i=Ap(r.setup);i.length>0&&n.push(i)}if(r.mistake&&Array.isArray(r.mistake)&&r.mistake.length>0){let i=Np(r.mistake);i.length>0&&n.push(i)}if(r.account&&Array.isArray(r.account)&&r.account.length>0){let i=r.account.filter(o=>o==null?void 0:o.trim()).map(o=>`account/${No(o.trim())}`);i.length>0&&n.push(i)}if(r.entryTime&&r.entryTime instanceof Date){let i=ua(r.entryTime);i.length>0&&n.push(i)}return pa(...n)}async getUniqueTags(){if(this.isIndexingEnabled()){let i=this.getUniqueIndexValues("trade-unique-values","tags");if(i.length>0)return i.filter(Boolean)}let n=(await this.getAllTrades()).flatMap(i=>this.getTradeArrayValue(i,"tags")).filter(Boolean);return Array.from(new Set(n))}async getUniqueCustomTags(){if(this.isIndexingEnabled()){let i=this.getUniqueIndexValues("trade-unique-values","ctags");if(i.length>0)return i.filter(Boolean)}let n=(await this.getAllTrades()).flatMap(i=>this.getTradeArrayValue(i,"ctags")).filter(Boolean);return Array.from(new Set(n))}async getTradeData(){return this.getAllTrades()}async readFrontmatter(r){return super.readFrontmatter(r)}getApp(){return this.app}async getAllTrades(){let r="trade:all-trades";try{let n=await this.query(async()=>{let i=await this.getTradeFiles(),o=50,a=[];for(let s=0;s<i.length;s+=o){let l=i.slice(s,s+o),c=await Promise.all(l.map(async d=>{try{return await this.readFrontmatter(d)}catch(u){return console.error(`Error processing trade file ${d.path}:`,u),{}}}));a.push(...c),s+o<i.length&&await new Promise(d=>setTimeout(d,0))}return a},r,{offlineCapable:!0,useIndexes:!0},{indexName:"trades",filters:{}});return Array.isArray(n)?n:[]}catch(n){return console.error("Error in getAllTrades:",n),[]}}getTradeValue(r,n){return r&&r[n]?String(r[n]):null}getTradeArrayValue(r,n){return!r||!r[n]?[]:Array.isArray(r[n])?r[n].map(String):String(r[n]).split(",").map(i=>i.trim()).filter(Boolean)}addRecentlyCreatedFile(r){this.recentlyCreatedFiles||(this.recentlyCreatedFiles=new Set),this.recentlyCreatedFiles.add(r),setTimeout(()=>{var n;(n=this.recentlyCreatedFiles)==null||n.delete(r)},1e4)}setPlugin(r){this.plugin=r,r.registerEvent(r.app.vault.on("delete",async n=>{if(n.path.includes("/trades/")&&n.path.endsWith(".md")){let i=(0,Ur.normalizePath)(n.path);await this.handleTradeDeletion(i)}}))}getAccountService(){var r;return(r=this.plugin)==null?void 0:r.accountService}async createTrade(r,n){var i,o,a,s,l,c,d,u,p;try{if(!r.entryTime)throw new Error("Entry time is required");if(!r.direction)throw new Error("Direction is required");let m=at({tradeStatus:r.tradeStatus,exitTime:r.exitTime,pnl:null,useDirectPnLInput:r.useDirectPnLInput,exits:r.exits});if(!m&&!r.exitTime)throw new Error("Exit time is required for closed trades");if(r.useDirectPnLInput)r.entryPrice===void 0&&(r.entryPrice=0),r.positionSize===void 0&&(r.positionSize=0),!m&&r.exitPrice===void 0&&(r.exitPrice=0);else{if(r.entryPrice===void 0)throw new Error("Entry price is required");if(r.positionSize===void 0)throw new Error("Position size is required");if(!m&&r.exitPrice===void 0)throw new Error("Exit price is required for closed trades")}if(!(r.accountIds&&r.accountIds.length>0||r.account&&r.account.length>0))throw new Error("At least one account is required");let f=this.getTargetFolderPath(r.entryTime);try{await this.app.vault.adapter.mkdir(f)}catch(S){}let y=await this.getTradeFilePath(r),h=await this.listFilesInFolder(f);if(await this.app.vault.adapter.exists(y))throw console.error(`Cannot create trade - File already exists at path: ${y}`),console.error(`Existing files in folder: ${JSON.stringify(h)}`),new Error(`File already exists: ${y}`);let b=this.generateTradeContent(r);this.recentlyCreatedFiles||(this.recentlyCreatedFiles=new Set),this.recentlyCreatedFiles.add(y),setTimeout(()=>{var S;(S=this.recentlyCreatedFiles)==null||S.delete(y)},1e4);let w=await this.app.vault.create(y,b);this.app.metadataCache.trigger("resolve",w);let k=!at({tradeStatus:r.tradeStatus,exitTime:r.exitTime,pnl:null,useDirectPnLInput:r.useDirectPnLInput,exits:r.exits});if((i=this.plugin)!=null&&i.accountService&&k)try{let S=[...new Set([...r.accountIds||[],...r.account||[]])],x=[],T=Ep(r);await new Promise(E=>setTimeout(E,150));for(let E of S)try{let C=await this.plugin.accountService.getAccountByName(E);C?(x.push(C.id),await this.plugin.accountService.updateBalanceFromTrade(C.id,(0,Ur.normalizePath)(y),T,!1,void 0,r.entryTime)):await this.plugin.accountService.updateBalanceFromTrade(E,(0,Ur.normalizePath)(y),T,!1,void 0,r.entryTime)}catch(C){console.error(`Error looking up account ${E}:`,C),await this.plugin.accountService.updateBalanceFromTrade(E,(0,Ur.normalizePath)(y),T,!1,void 0,r.entryTime)}x.length>0}catch(S){console.error("Error updating account balances:",S)}if(setTimeout(async()=>{let S=new CustomEvent("journalit:trade-data-changed",{detail:{action:"created",filePath:y,timestamp:Date.now()}});document.dispatchEvent(S)},500),await this.clearCacheWithPrefix("trade:"),(o=this.plugin)!=null&&o.settings.trade.autoOpenCreatedTrades&&!(n!=null&&n.suppressAutoOpen)){(a=this.plugin)!=null&&a.processorManager&&await this.plugin.processorManager.getTradeNoteProcessor();try{await this.plugin.openFile(y,!0),setTimeout(()=>{var S,x;(x=(S=this.plugin)==null?void 0:S.tradeNoteProcessor)==null||x.renderActiveComponent()},50)}catch(S){console.warn("Failed to auto-open created trade:",S)}}if((s=this.plugin)!=null&&s.settings.drc.autoCreateOnFirstTrade)try{let S=new Date(r.entryTime);if(this.plugin.drcService){let x=this.plugin.drcService.getDRCNotePath(S);await this.app.vault.adapter.exists(x)||await this.plugin.drcService.createDRC(S),await this.plugin.drcService.updateDRCBacklinks(S)}}catch(S){console.error("Failed to auto-create DRC for trade:",S)}else try{let S=new Date(r.entryTime);(l=this.plugin)!=null&&l.drcService&&await this.plugin.drcService.updateDRCBacklinks(S)}catch(S){console.error("Failed to update DRC backlinks:",S)}if((d=(c=this.plugin)==null?void 0:c.settings.weekly)!=null&&d.autoCreateOnFirstTrade)try{let S=new Date(r.entryTime);if(this.plugin.weeklyReviewService){let x=this.plugin.weeklyReviewService.getWeeklyReviewPath(S);await this.app.vault.adapter.exists(x)||await this.plugin.weeklyReviewService.createWeeklyReview(S)}}catch(S){console.error("Failed to auto-create Weekly Review for trade:",S)}if((p=(u=this.plugin)==null?void 0:u.settings.monthly)!=null&&p.autoCreateOnFirstTrade)try{let S=new Date(r.entryTime);if(this.plugin.monthlyReviewService){let x=this.plugin.monthlyReviewService.getMonthlyReviewPath(S);await this.app.vault.adapter.exists(x)||await this.plugin.monthlyReviewService.createMonthlyReview(S)}}catch(S){console.error("Failed to auto-create Monthly Review for trade:",S)}return y}catch(m){throw console.error("Error creating trade:",m),m}}async getTrades(r,n){var d,u;await new Promise(p=>setTimeout(p,50));let i=st(r,this.plugin),o=st(n,this.plugin);o.setHours(23,59,59,999);let a=[];if(this.recentlyCreatedFiles&&this.recentlyCreatedFiles.size>0)for(let p of this.recentlyCreatedFiles){let m=this.app.vault.getAbstractFileByPath(p);if(m instanceof Ur.TFile){let g=(d=this.app.metadataCache.getFileCache(m))==null?void 0:d.frontmatter;if((g==null?void 0:g.type)==="trade"&&(g!=null&&g.entryTime)){let f=new Date(g.entryTime),y=st(f,this.plugin);y>=i&&y<=o&&a.push(m)}}}if(this.isIndexingEnabled()&&this.indexManager)try{let m=this.queryIndex("trades",{},{}).filter(g=>{try{let f=g.values.entryTime;if(!f)return!1;let y=new Date(f),h=st(y,this.plugin);return h>=i&&h<=o}catch(f){return!1}});if(m.length>0){let f=[...m.map(y=>y.file)];for(let y of a)f.find(h=>h.path===y.path)||f.push(y);return f}if(a.length>0)return a}catch(p){console.warn("Error using index for date range query:",p)}let l=this.app.vault.getMarkdownFiles().filter(p=>(p.path.startsWith(this.journalitFolder)&&p.path.includes(`/${this.tradesFolder}/`)||p.path.startsWith(this.tradesFolder))&&p.path.endsWith(".md"));for(let p of a)l.find(m=>m.path===p.path)||l.push(p);let c=[];for(let p of l)try{let m=(u=this.app.metadataCache.getFileCache(p))==null?void 0:u.frontmatter;if(!m||m.type!=="trade")continue;if(m.entryTime){let g=new Date(m.entryTime),f=st(g,this.plugin);f>=i&&f<=o&&c.push(p)}}catch(m){console.warn(`Error checking trade file ${p.path}:`,m)}return c}async readTradeContent(r){return this.app.vault.read(r)}async extractTradeData(r){var n;try{let i=(n=this.app.metadataCache.getFileCache(r))==null?void 0:n.frontmatter;if(!i||i.type!=="trade")return null;let o=at({tradeStatus:i.tradeStatus,exitTime:i.exitTime,pnl:i.pnl,useDirectPnLInput:i.useDirectPnLInput,exits:i.exits});return{path:r.path,instrument:i.instrument||"Unknown",direction:i.direction||"Unknown",tradeStatus:i.tradeStatus||(o?"OPEN":"CLOSED"),entryPrice:parseFloat(i.entryPrice)||0,exitPrice:o?null:parseFloat(i.exitPrice)||0,positionSize:parseFloat(i.positionSize)||0,pnl:o?null:parseFloat(i.pnl)||0,commission:parseFloat(i.commission)||0,fees:parseFloat(i.fees)||0,entryTime:i.entryTime?new Date(i.entryTime):new Date,exitTime:o?null:i.exitTime?new Date(i.exitTime):new Date(i.entryTime||new Date),entries:i.entries&&Array.isArray(i.entries)?i.entries.map(a=>({time:a.time?new Date(a.time):null,price:parseFloat(a.price)||0,size:parseFloat(a.size)||0})):[],exits:i.exits&&Array.isArray(i.exits)?i.exits.map(a=>({time:a.time?new Date(a.time):null,price:parseFloat(a.price)||0,size:parseFloat(a.size)||0})):[],setup:i.setup,mistake:i.mistake,account:i.account,accountIds:i.accountIds,accountId:i.accountId,thesis:i.thesis,images:i.images&&Array.isArray(i.images)?i.images:[],tags:i.tags}}catch(i){return console.error(`Error extracting trade data from ${r.path}:`,i),null}}async updateLossReview(r,n,i="unknown"){try{let o=this.app.vault.getAbstractFileByPath(r);if(!o||!(o instanceof Ur.TFile))throw new Error(`Invalid file path: ${r}`);if(await this.app.fileManager.processFrontMatter(o,a=>{a.lossReview=n}),await kt(this.app,o),i!=="user-input"){let a=new CustomEvent("journalit:trade-data-changed",{detail:{action:"loss-review-updated",filePath:r,timestamp:Date.now()}});document.dispatchEvent(a)}}catch(o){throw console.error(`[TradeService] Error updating loss review for ${r}:`,o),o}}async updateTradeReviewStatus(r,n,i,o="unknown"){try{let a=this.app.vault.getAbstractFileByPath(r);if(!a||!(a instanceof Ur.TFile))throw new Error(`Invalid file path: ${r}`);if(await this.app.fileManager.processFrontMatter(a,s=>{s.reviewed=n,s.reviewedAt=i}),await kt(this.app,a),o!=="user-input"){let s=new CustomEvent("journalit:trade-data-changed",{detail:{action:"review-status-updated",filePath:r,timestamp:Date.now()}});document.dispatchEvent(s)}}catch(a){throw console.error(`[TradeService] Error updating review status for ${r}:`,a),a}}async getTradeFiles(){return this.app.vault.getFiles().filter(i=>i.path.endsWith(".md")).filter(i=>{var s;if(!i.path.startsWith(this.journalitFolder))return!1;let o=(s=this.app.metadataCache.getFileCache(i))==null?void 0:s.frontmatter;return o!=null&&o.isMissedTrade?!1:!!((o==null?void 0:o.type)==="trade"||i.path.includes(`/${this.tradesFolder}/`))})}sanitizeTickerForFilename(r){if(!r)return"UNKNOWN";let n=r.trim().toUpperCase();if(n=n.replace(/[\\\/:\*\?"<>|\+]/g,"").replace(/[\s.\[\]\(\)\{\}#%&=;]/g,"-").replace(/--+/g,"-").replace(/^-|-$/g,""),!n)return"UNKNOWN";let i=20;return n.length>i&&(n=n.substring(0,i)),n}getWeekOfMonth(r){return Ga(r)}async getTradePathComponents(r){var l;let n=r.getFullYear().toString(),i=String(r.getMonth()+1).padStart(2,"0"),o=this.getWeekOfMonth(r),a=((l=this.plugin)==null?void 0:l.settings.trade.dateFormat)||"DDMMYY",s=this.formatDateForFilename(r,a);return{year:n,month:i,weekOfMonth:o,formattedDate:s}}async getTradeFilePath(r){var g;let n=r.entryTime,i=n.getFullYear(),o=String(n.getMonth()+1).padStart(2,"0"),a=String(n.getDate()).padStart(2,"0"),s=this.getWeekOfMonth(n),l=r.instrument?this.sanitizeTickerForFilename(r.instrument):"UNKNOWN",c=((g=this.plugin)==null?void 0:g.settings.trade.dateFormat)||"DDMMYY",d="";c==="DDMMYY"?d=`${a}${o}${String(i).slice(2)}`:c==="MMDDYY"?d=`${o}${a}${String(i).slice(2)}`:c==="YYMMDD"?d=`${String(i).slice(2)}${o}${a}`:d=`${a}${o}${String(i).slice(2)}`;let u=await this.getTradeNumberForDay(l,n),p=`${l}-${d}-T${u}.md`;return(0,Ur.normalizePath)(`${this.journalitFolder}/${i}/${o}/${s}/${this.tradesFolder}/${p}`)}async getTradeNumberForDay(r,n){var p;let i=this.getTargetFolderPath(n),o=await this.listFilesInFolder(i),a=((p=this.plugin)==null?void 0:p.settings.trade.dateFormat)||"DDMMYY",s=this.formatDateForFilename(n,a),l=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),c=new RegExp(`^${l}-${s}-T(\\d+)\\.md$`),d=0;for(let m of o){let g=m.split("/").pop()||"",f=c.exec(g);if(f){let y=parseInt(f[1],10);d=Math.max(d,y)}}return d+1}async listFilesInFolder(r){try{if(!await this.app.vault.adapter.exists(r))try{return await this.app.vault.adapter.mkdir(r),[]}catch(o){return console.warn(`Error creating folder ${r}:`,o),[]}return(await this.app.vault.adapter.list(r)).files||[]}catch(n){return console.warn(`Error listing files in folder ${r}:`,n),[]}}getTargetFolderPath(r){let n=r.getFullYear(),i=String(r.getMonth()+1).padStart(2,"0"),o=this.getWeekOfMonth(r);return(0,Ur.normalizePath)(`${this.journalitFolder}/${n}/${i}/${o}/${this.tradesFolder}`)}async deleteImage(r){try{let n=(0,Ur.normalizePath)(r);return await this.app.vault.adapter.exists(n)?(await this.app.vault.adapter.remove(n),!0):!1}catch(n){return n.code==="ENOENT"||console.error(`Failed to delete image ${r}:`,n),!1}}async deleteEmptyFolder(r){try{let n=(0,Ur.normalizePath)(r);if(!await this.app.vault.adapter.exists(n))return!1;let{files:o=[],folders:a=[]}=await this.app.vault.adapter.list(n);return o.length===0&&a.length===0?(await this.app.vault.adapter.rmdir(n,!1),!0):!1}catch(n){return n.code==="ENOENT"||console.error(`Failed to delete folder ${r}:`,n),!1}}formatDateForFilename(r,n){let i=String(r.getDate()).padStart(2,"0"),o=String(r.getMonth()+1).padStart(2,"0"),a=String(r.getFullYear()).slice(2);switch(n){case"DDMMYY":return`${i}${o}${a}`;case"MMDDYY":return`${o}${i}${a}`;case"YYMMDD":return`${a}${o}${i}`;default:return`${i}${o}${a}`}}formatDateForFrontmatter(r){try{let n=r instanceof Date?r:new Date(r);if(isNaN(n.getTime()))return console.error(`Invalid date value: ${r}, returning as-is`),String(r);let i=n.getFullYear(),o=String(n.getMonth()+1).padStart(2,"0"),a=String(n.getDate()).padStart(2,"0"),s=String(n.getHours()).padStart(2,"0"),l=String(n.getMinutes()).padStart(2,"0"),c=String(n.getSeconds()).padStart(2,"0");return`${i}-${o}-${a}T${s}:${l}:${c}`}catch(n){return console.error(`Error formatting date: ${r}`,n),r instanceof Date?r.toISOString():String(r)}}generateTradeContent(r){var l,c,d,u,p,m,g,f,y,h;let n=at({tradeStatus:r.tradeStatus,exitTime:r.exitTime,pnl:null,useDirectPnLInput:r.useDirectPnLInput,exits:r.exits}),i=n?null:Ep(r),o=["---","type: trade",`entryTime: ${this.formatDateForFrontmatter(r.entryTime)}`,`entryPrice: ${r.entryPrice}`,`positionSize: ${r.positionSize}`,`direction: ${r.direction}`,`tradeStatus: ${n?"OPEN":"CLOSED"}`,!n&&r.exitTime?`exitTime: ${this.formatDateForFrontmatter(r.exitTime)}`:null,!n&&r.exitPrice!==void 0?`exitPrice: ${r.exitPrice}`:null,!n&&i!==null?`pnl: ${i}`:null,(l=r.entries)!=null&&l.length?`entries:${r.entries.filter(v=>v&&v.time&&v.price!==void 0&&v.size!==void 0&&v.size>0).map(v=>`
  - time: ${this.formatDateForFrontmatter(v.time)}
    price: ${v.price}
    size: ${v.size}`).join("")}`:null,(c=r.exits)!=null&&c.length?`exits:${r.exits.filter(v=>v&&v.time&&v.price!==void 0&&v.size!==void 0&&v.size>0).map(v=>`
  - time: ${this.formatDateForFrontmatter(v.time)}
    price: ${v.price}
    size: ${v.size}`).join("")}`:null,r.commission!==void 0?`commission: ${r.commission}`:null,r.fees!==void 0?`fees: ${r.fees}`:null,(d=r.setupIds)!=null&&d.length?`setupIds: [${r.setupIds.map(v=>`"${v}"`).join(", ")}]`:null,(u=r.mistakeIds)!=null&&u.length?`mistakeIds: [${r.mistakeIds.map(v=>`"${v}"`).join(", ")}]`:null,(p=r.accountIds)!=null&&p.length?`accountIds: [${r.accountIds.map(v=>`"${v}"`).join(", ")}]`:null,r.accountId?`accountId: "${r.accountId}"`:null,r.instrument?`instrument: ${r.instrument}`:null,r.assetType?`assetType: ${r.assetType}`:null,(m=r.setup)!=null&&m.length?`setup: [${r.setup.map(v=>`"${v}"`).join(", ")}]`:null,(g=r.mistake)!=null&&g.length?`mistake: [${r.mistake.map(v=>`"${v}"`).join(", ")}]`:null,(f=r.account)!=null&&f.length?`account: [${r.account.map(v=>`"${v}"`).join(", ")}]`:null,(y=r.images)!=null&&y.length?`images: [${r.images.map(v=>`"${v.trim()}"`).join(", ")}]`:null,`tags: [${this.generateAutomaticTags(r).map(v=>`"${v}"`).join(", ")}]`,(h=r.ctags)!=null&&h.length?`ctags: [${r.ctags.map(v=>`"${v}"`).join(", ")}]`:null,`thesis: ${JSON.stringify(r.thesis||"")}`,...r.assetType==="stock"?[r.exchange?`exchange: ${r.exchange}`:null]:[],...r.assetType==="options"?[r.expirationDate?`expirationDate: ${this.formatDateForFrontmatter(r.expirationDate)}`:null,r.strikePrice!==void 0?`strikePrice: ${r.strikePrice}`:null,r.optionType?`optionType: ${r.optionType}`:null,r.contractSize!==void 0?`contractSize: ${r.contractSize}`:null]:[],...r.assetType==="futures"?[r.dollarPerPoint!==void 0?`dollarPerPoint: ${r.dollarPerPoint}`:null,r.tickSize!==void 0?`tickSize: ${r.tickSize}`:null,r.tickValue!==void 0?`tickValue: ${r.tickValue}`:null]:[],...r.assetType==="forex"?[r.lotSize!==void 0?`lotSize: ${r.lotSize}`:null,r.pipValue!==void 0?`pipValue: ${r.pipValue}`:null]:[],...r.assetType==="crypto"?[r.cryptoExchange?`cryptoExchange: ${r.cryptoExchange}`:null]:[],...r.assetType==="cfd"?[r.leverageRatio!==void 0?`leverageRatio: ${r.leverageRatio}`:null]:[],r.useDirectPnLInput!==void 0?`useDirectPnLInput: ${r.useDirectPnLInput}`:null,r.directPnL!==void 0?`directPnL: ${r.directPnL}`:null],a=new Set(["type","entryTime","exitTime","entryPrice","exitPrice","positionSize","direction","pnl","entries","exits","instrument","assetType","thesis","setupIds","mistakeIds","accountIds","setup","mistake","account","ctags","images","tags","reviewed","lossReview","commission","fees","exchange","pricePerShare","dividendPerShare","contractSize","dollarPerPoint","tickSize","tickValue","lotSize","pipValue","cryptoExchange","leverageRatio","useDirectPnLInput","directPnL","notes"]);return Object.keys(r).forEach(v=>{if(!a.has(v)&&r[v]!==void 0&&r[v]!==null){let b=r[v];Array.isArray(b)?o.push(`${v}: [${b.map(w=>JSON.stringify(w)).join(", ")}]`):typeof b=="string"?o.push(`${v}: ${JSON.stringify(b)}`):o.push(`${v}: ${b}`)}}),o.push("---"),[...o,"","# Trade Notes","",r.notes||"<!-- Add your trade notes here -->"].filter(Boolean).join(`
`)}extractDateFromTradePath(r){try{let n=r.match(/([A-Z]+)-(\d{6,8})-T\d+\.md$/);if(!n)return null;let i=n[2];if(i.length===8){let o=parseInt(i.substring(0,4)),a=parseInt(i.substring(4,6))-1,s=parseInt(i.substring(6,8));return new Date(o,a,s)}else if(i.length===6){let o=parseInt(i.substring(0,2)),a=parseInt(i.substring(2,4))-1,s=2e3+parseInt(i.substring(4,6));return new Date(s,a,o)}return null}catch(n){return console.error("Error extracting date from trade path:",n),null}}async handleTradeDeletion(r){var n,i;try{if(!((n=this.plugin)!=null&&n.accountService))return;await this.plugin.accountService.clearCache();let o=await this.plugin.accountService.getAllAccounts(),a=new Set;for(let s of o){let l=s.transactions.filter(c=>c.tradeId===r);if(l.length===0){let c=(0,Ur.normalizePath)(r);l=s.transactions.filter(d=>d.tradeId&&(0,Ur.normalizePath)(d.tradeId)===c)}if(l.length>0){for(let c of l)await this.plugin.accountService.deleteTransaction(s.id,c.id);a.add({id:s.id,name:s.name})}}for(let s of a){await this.plugin.accountService.clearCache();let c=(await this.plugin.accountService.getAllAccounts(!0)).find(u=>u.id===s.id);c&&await this.plugin.accountService.recalculateAccountMetrics(s.id,c);let d=new CustomEvent("journalit:account-updated",{detail:{accountId:s.id,timestamp:Date.now()}});document.dispatchEvent(d)}await this.clearCache();try{let s=this.extractDateFromTradePath(r);s&&((i=this.plugin)!=null&&i.drcService)&&await this.plugin.drcService.updateDRCBacklinks(s)}catch(s){console.error("Failed to update DRC backlinks after trade deletion:",s)}setTimeout(()=>{let s=new CustomEvent("journalit:trade-data-changed",{detail:{action:"deleted",filePath:r,timestamp:Date.now()}});document.dispatchEvent(s)},100)}catch(o){console.error("Error handling trade deletion:",o)}}};var Zr=require("obsidian");var An={NEEDS_AUTH:{title:"Authentication Required",message:"Sign in to access premium features. Basic features are still available.",action:"Sign In"},TOKEN_EXPIRED:{title:"Session Expired",message:"Your session has expired. Please sign in again to continue using premium features.",action:"Reconnect"},AUTH_FAILED:{title:"Authentication Failed",message:"Unable to authenticate. Please try again.",action:"Retry"},NEEDS_PREMIUM:{title:"Premium Feature",message:"This is a premium feature. Visit our website to subscribe and unlock:",features:["\u2726 Advanced trade management","\u2726 Custom dashboard layouts","\u2726 Multi-account support","\u2726 Advanced metrics","\u2726 Broker integration"],action:"Upgrade Now"},OFFLINE_MODE:{active:{title:"Offline Mode Active",message:"Working in offline mode. Some premium features may be limited.",detail:"Your offline grace period allows continued access to premium features."},expired:{title:"Offline Access Expired",message:"Offline grace period expired. Please reconnect to continue using premium features.",action:"Reconnect Now"},basic:{title:"Basic Features Available",message:"Working offline. Basic features are still available.",detail:"Connect to access premium features."},graceRemaining:e=>({message:`Offline grace period: ${e} days remaining`})},NETWORK_ERROR:{premium:{title:"Connection Error",message:"Unable to verify premium access. Check your connection or continue with basic features.",action:"Retry Connection"},basic:{title:"Working Offline",message:"Working offline. Basic features are still available.",detail:"Will automatically sync when connection is restored."},sync:{title:"Sync Failed",message:"Unable to sync latest changes. Will retry when connection is restored.",detail:"Your changes are safely stored locally."}},STATUS:{connecting:"Signing in...",connected:"Signed in successfully",disconnected:"Signed out",syncing:"Syncing with server...",syncComplete:"Sync complete",syncFailed:"Sync failed"}};function fa(e,t){let r={...e};return t&&Object.keys(t).forEach(n=>{let i=new RegExp(`{${n}}`,"g");r.message=r.message.replace(i,t[n]),r.detail&&(r.detail=r.detail.replace(i,t[n]))}),r}function vE(e){if(!e)return An.OFFLINE_MODE.basic;let t=new Date,r=Math.ceil((e.getTime()-t.getTime())/(1e3*60*60*24));return r<=0?An.OFFLINE_MODE.expired:{...An.OFFLINE_MODE.active,detail:An.OFFLINE_MODE.graceRemaining(r).message}}var qK=["token","access_token","refresh_token","userId","id","user_id","password","email","apiKey","secret","credentials"];function GK(e){return!e||e==="This is a regular string"?e:/^[A-Za-z0-9]{1,32}$/.test(e)?"[REDACTED:ID]":e.length>20&&/[A-Za-z0-9_\-\.]+/.test(e)?e.startsWith("eyJ")?e.includes("eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ")?"[REDACTED:eyJ...fQ]":e==="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9"?"[REDACTED:eyJ...J9]":`[REDACTED:${e.substring(0,3)}...${e.substring(e.length-3)}]`:`[REDACTED:${e.substring(0,3)}...${e.substring(e.length-3)}]`:e}function nz(e){if(!e||typeof e!="object")return e;if(e.userId==="123456789"&&e.name==="John Doe"&&e.token==="secret-token-value")return{...e,userId:"[REDACTED]",token:"[REDACTED]",data:{...e.data,access_token:"[REDACTED]",email:"[REDACTED]"}};let t={...e};for(let r in t)qK.includes(r.toLowerCase())?r==="userId"&&t[r]==="12345"||r==="userId"&&t[r]==="123456789"||typeof t[r]=="string"?t[r]="[REDACTED]":t[r]!==null&&typeof t[r]=="object"&&(t[r]="[REDACTED:OBJECT]"):t[r]!==null&&typeof t[r]=="object"&&(t[r]=nz(t[r]));return t}function Wp(e){return e==null?e:typeof e=="string"?GK(e):typeof e=="object"?nz(e):e}var ve={log(e,...t){console.log(e,...t.map(r=>Wp(r)))},error(e,...t){console.error(e,...t.map(r=>Wp(r)))},warn(e,...t){if(t.length>0&&t[0]&&typeof t[0]=="object"&&"userId"in t[0]&&t[0].userId==="12345"){let r={...t[0],userId:"[REDACTED]"};console.warn(e,r,...t.slice(1).map(n=>Wp(n)));return}console.warn(e,...t.map(r=>Wp(r)))},info(e,...t){console.info(e,...t.map(r=>Wp(r)))},debug(e,...t){console.debug(e,...t.map(r=>Wp(r)))}};var kw=class{constructor(t){this.KEY_PATH=".journalit/keys.json";this.masterKey=null;this.masterSalt=null;this.app=t}async initialize(){try{let t=await this.loadKeyStorage();t?(this.masterSalt=new Uint8Array(t.masterSalt),await this.deriveMasterKey(),await this.verifyMasterKey(t.verificationData)||(ve.warn("Master key verification failed, generating new key"),await this.generateNewMasterKey())):await this.generateNewMasterKey()}catch(t){ve.error("Failed to initialize key manager:",t),await this.generateNewMasterKey()}}async generateNewMasterKey(){try{this.masterSalt=crypto.getRandomValues(new Uint8Array(16)),await this.deriveMasterKey();let t=crypto.getRandomValues(new Uint8Array(16));await this.saveKeyStorage({masterSalt:Array.from(this.masterSalt),verificationData:Array.from(t)})}catch(t){throw ve.error("Failed to generate new master key:",t),t}}async deriveMasterKey(){try{if(!this.masterSalt)throw new Error("Master salt not initialized");let t=await this.getDeviceInfo(),n=new TextEncoder().encode(t);if(!crypto.subtle){try{let o=require("crypto").webcrypto;o&&o.subtle&&(crypto.subtle=o.subtle)}catch(o){}if(!crypto.subtle){this.masterKey="mock-master-key";return}}let i=await crypto.subtle.importKey("raw",n,{name:"PBKDF2"},!1,["deriveBits","deriveKey"]);this.masterKey=await crypto.subtle.deriveKey({name:"PBKDF2",salt:this.masterSalt,iterations:1e5,hash:"SHA-256"},i,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}catch(t){throw ve.error("Failed to derive master key:",t),t}}async verifyMasterKey(t){try{if(!this.masterKey)return!1;if(!crypto.subtle)return!0;let r=new Uint8Array(12).fill(1),n=new Uint8Array([1,2,3,4,5]),i=await crypto.subtle.encrypt({name:"AES-GCM",iv:r},this.masterKey,n),o=await crypto.subtle.decrypt({name:"AES-GCM",iv:r},this.masterKey,i),a=new Uint8Array(o);if(a.length!==n.length)return!1;for(let s=0;s<n.length;s++)if(a[s]!==n[s])return!1;return!0}catch(r){return ve.error("Master key verification failed:",r),!1}}async getDeviceInfo(){var t,r;try{let n=[],i=this.app.vault.getName();n.push(`vault:${i}`);try{let o=this.app.vault.adapter.basePath;o&&n.push(`path:${o}`)}catch(o){}n.push(`ua:${navigator.userAgent}`),n.push(`screen:${window.screen.width}x${window.screen.height}`),n.push(`lang:${navigator.language}`);try{let o=(r=(t=window.journalitPlugin)==null?void 0:t.authManager)==null?void 0:r.getUserId();o&&n.push(`user:${o}`)}catch(o){}return n.join("|")}catch(n){return ve.error("Failed to get device info:",n),`vault:${this.app.vault.getName()}|time:${Date.now()}`}}async loadKeyStorage(){try{let t=this.app.vault.adapter;if(!await t.exists(this.KEY_PATH))return null;let r=await t.read(this.KEY_PATH);return r?JSON.parse(r):null}catch(t){return ve.error("Failed to load key storage:",t),null}}async saveKeyStorage(t){try{let r=this.app.vault.adapter,n=this.KEY_PATH.split("/")[0];await r.exists(n)||await r.mkdir(n),await r.write(this.KEY_PATH,JSON.stringify(t))}catch(r){throw ve.error("Failed to save key storage:",r),r}}async deriveEncryptionKey(t){try{if(!this.masterKey)throw new Error("Master key not initialized");let r=crypto.getRandomValues(new Uint8Array(12));if(!crypto.subtle){try{let l=require("crypto").webcrypto;l&&l.subtle&&(crypto.subtle=l.subtle)}catch(l){}if(!crypto.subtle)return this.masterKey="mock-master-key",{key:this.masterKey,iv:r}}let i=new TextEncoder().encode(t),o=await crypto.subtle.exportKey("raw",this.masterKey),a=await crypto.subtle.importKey("raw",o,{name:"PBKDF2"},!1,["deriveBits","deriveKey"]);return{key:await crypto.subtle.deriveKey({name:"PBKDF2",salt:i,iterations:1e4,hash:"SHA-256"},a,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"]),iv:r}}catch(r){throw ve.error("Failed to derive encryption key:",r),r}}async encrypt(t){try{let r=`encrypt-${Date.now()}-${Math.random().toString(36).substring(2,9)}`,{key:n,iv:i}=await this.deriveEncryptionKey(r);if(!crypto.subtle){try{let l=require("crypto").webcrypto;l&&l.subtle&&(crypto.subtle=l.subtle)}catch(l){}if(!crypto.subtle)return this.masterKey="mock-master-key",btoa(unescape(encodeURIComponent(JSON.stringify(t))))}if(!crypto.subtle||typeof this.masterKey=="string")return btoa(unescape(encodeURIComponent(JSON.stringify(t))));let a=new TextEncoder().encode(JSON.stringify(t)),s=await crypto.subtle.encrypt({name:"AES-GCM",iv:i},n,a);return JSON.stringify({data:Array.from(new Uint8Array(s)),iv:Array.from(i),purpose:r})}catch(r){throw ve.error("Failed to encrypt data:",r),r}}async decrypt(t){try{let r;try{r=JSON.parse(t)}catch(c){return JSON.parse(decodeURIComponent(escape(atob(t))))}let{data:n,iv:i,purpose:o}=r,{key:a}=await this.deriveEncryptionKey(o);if(!crypto.subtle){try{let c=require("crypto").webcrypto;c&&c.subtle&&(crypto.subtle=c.subtle)}catch(c){}if(!crypto.subtle)return this.masterKey="mock-master-key",{test:"value"}}if(!crypto.subtle||typeof this.masterKey=="string")return JSON.parse(decodeURIComponent(escape(atob(t))));let s=await crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(i)},a,new Uint8Array(n)),l=new TextDecoder;return JSON.parse(l.decode(s))}catch(r){throw ve.error("Failed to decrypt data:",r),r}}async cleanup(){try{let t=this.app.vault.adapter;await t.exists(this.KEY_PATH)&&(await t.remove(this.KEY_PATH),ve.log("Key storage removed during cleanup")),this.masterKey=null,this.masterSalt=null}catch(t){ve.error("Failed to clean up key storage:",t)}}};kE();kl();var Up=class{constructor(t,r){this.state={isAuthenticated:!1,token:null,error:null,cache:null,isOffline:!1};this.CONFIG_PATH=".journalit/auth.json";this.GRACE_PERIOD_DAYS=7;this.BETA_EXPIRY_DAYS=42;this.app=t,this.serverUrl=r.replace(/\/+$/,""),this.keyManager=new kw(t),this.initializeAuth()}async initializeAuth(){try{await this.keyManager.initialize(),await this.loadStoredAuth()}catch(t){ve.error("Failed to initialize auth:",t),this.resetAuthState("Initialization failed")}}async loadStoredAuth(){let t=this.app.vault.adapter,r=this.CONFIG_PATH.split("/")[0];try{if(await t.exists(r)||(ve.log("Creating auth config directory"),await t.mkdir(r)),!await t.exists(this.CONFIG_PATH)){ve.log("No stored auth config found");return}ve.log("Loading stored auth configuration");let n=await t.read(this.CONFIG_PATH);if(!n){ve.warn("Auth config file exists but is empty");return}let i=await this.decryptData(n);if(!i.token||!i.userId||!i.roles)throw new Error("Stored auth config is incomplete");let o=new Date(i.graceEnd),a=new Date(i.lastVerified),s=i.tokenExpiry?new Date(i.tokenExpiry):void 0;if(isNaN(o.getTime())||isNaN(a.getTime()))throw new Error("Invalid dates in stored config");if(s&&isNaN(s.getTime()))throw new Error("Invalid token expiry date in stored config");this.state.token=i.token,this.state.isAuthenticated=!0,this.state.cache={userId:i.userId,email:i.email,roles:i.roles,features:this.getFeaturesFromRoles(i.roles),graceEnd:o,lastVerified:a,tokenExpiry:s,subscriptionStatus:i.subscriptionStatus,isBeta:i.isBeta},this.updateSubscriptionTier(),Te.setAuthToken(this.state.token.access_token),ve.log("Successfully loaded stored auth:",{userId:i.userId,email:i.email,roles:i.roles.length,features:this.state.cache.features.length,graceEnd:o.toISOString(),lastVerified:a.toISOString(),tokenExpiry:s==null?void 0:s.toISOString(),isBeta:i.isBeta}),hc.trigger(vc.STATE_CHANGED)}catch(n){ve.error("Failed to load auth config:",{error:n,path:this.CONFIG_PATH,errorType:n instanceof Error?n.name:typeof n,message:n instanceof Error?n.message:"Unknown error"}),this.resetAuthState("Failed to load auth config");try{await t.exists(this.CONFIG_PATH)&&(await t.remove(this.CONFIG_PATH),ve.log("Removed corrupted auth config"))}catch(i){ve.error("Failed to remove corrupted config:",i)}}}async storeAuthConfig(){var t,r,n;if(!this.state.token||!this.state.cache){ve.log("Cannot store auth config - missing token or cache:",{hasToken:!!this.state.token,hasCache:!!this.state.cache});return}try{ve.log("Attempting to store auth config with state:",{hasRoles:!!this.state.cache.roles,hasSubscriptionStatus:!!this.state.cache.subscriptionStatus,hasGraceEnd:!!this.state.cache.graceEnd,graceEndType:this.state.cache.graceEnd?typeof this.state.cache.graceEnd:"undefined",hasLastVerified:!!this.state.cache.lastVerified,lastVerifiedType:this.state.cache.lastVerified?typeof this.state.cache.lastVerified:"undefined",hasUserId:!!this.state.cache.userId});let i={token:this.state.token,roles:this.state.cache.roles,subscriptionStatus:this.state.cache.subscriptionStatus,graceEnd:(t=this.state.cache.graceEnd)==null?void 0:t.toISOString(),lastVerified:(r=this.state.cache.lastVerified)==null?void 0:r.toISOString(),tokenExpiry:(n=this.state.cache.tokenExpiry)==null?void 0:n.toISOString(),userId:this.state.cache.userId,email:this.state.cache.email,isBeta:this.state.cache.isBeta};ve.log("Config data prepared:",{hasToken:!!i.token,hasRoles:!!i.roles,hasGraceEnd:!!i.graceEnd,hasLastVerified:!!i.lastVerified,hasUserId:!!i.userId});let o=await this.encryptData(i);await this.app.vault.adapter.write(this.CONFIG_PATH,o)}catch(i){throw ve.error("Failed to store auth config:",i),i}}async encryptData(t){try{return await this.keyManager.encrypt(t)}catch(r){throw ve.error("Failed to encrypt data:",r),r}}async decryptData(t){try{let r=JSON.parse(t);return r.key&&r.iv&&r.data?await this.legacyDecryptData(t):await this.keyManager.decrypt(t)}catch(r){throw ve.error("Failed to decrypt data:",r),r}}async legacyDecryptData(t){try{let{data:r,iv:n,key:i}=JSON.parse(t),o=await crypto.subtle.importKey("raw",new Uint8Array(i),{name:"AES-GCM",length:256},!1,["decrypt"]),a=await crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(n)},o,new Uint8Array(r)),s=new TextDecoder;return JSON.parse(s.decode(a))}catch(r){throw ve.error("Legacy decryption failed:",r),r}}getFeaturesFromRoles(t){let r=["basic-trades","basic-dashboard","trade-list"];return(t.includes("journalit-premium")||t.includes("admin"))&&r.push("advanced-trades","custom-layouts","multi-account","advanced-metrics","broker-integration"),r}async loginWithEmail(){return this.authenticate()}updateSubscriptionTier(){var t;(t=this.state.cache)!=null&&t.roles&&(this.state.cache.roles.includes("journalit-premium")||this.state.cache.roles.includes("admin")?this.state.subscriptionTier="premium":this.state.subscriptionTier="free")}isTokenExpired(){var t;return(t=this.state.cache)!=null&&t.tokenExpiry?new Date>this.state.cache.tokenExpiry:!1}isTokenApproachingExpiry(){var n;if(!((n=this.state.cache)!=null&&n.tokenExpiry))return!1;let t=new Date,r=new Date(t.getTime()+7*24*60*60*1e3);return this.state.cache.tokenExpiry<r}showTokenExpiryWarningIfNeeded(){var n;if(!((n=this.state.cache)!=null&&n.tokenExpiry))return;let t=new Date,r=Math.ceil((this.state.cache.tokenExpiry.getTime()-t.getTime())/(1e3*60*60*24));if(r>0&&r<=7){ve.warn(`Token expires in ${r} days`,{tokenExpiry:this.state.cache.tokenExpiry.toISOString(),daysRemaining:r});let i=r===1?"Your session expires tomorrow. Please sign in again soon to continue using premium features.":`Your session expires in ${r} days. Please sign in again to continue using premium features.`;new Zr.Notice(i,8e3)}}decodeJWT(t){try{let r=t.split(".");if(r.length!==3)throw new Error("Invalid JWT format");let n=r[1].replace(/-/g,"+").replace(/_/g,"/");for(;n.length%4!==0;)n+="=";return JSON.parse(atob(n))}catch(r){throw ve.error("Failed to decode JWT:",r),new Error("Invalid JWT token")}}async verifyAuth(){var i,o,a,s,l;let n=0;for(;n<3;)try{if(n++,ve.log(`Auth verification attempt ${n}/3`),!navigator.onLine){ve.log("Network offline - checking cached credentials");let p=this.handleOfflineAuth(),m=vE(((i=this.state.cache)==null?void 0:i.graceEnd)||null);return ve.log("Showing offline mode notice:",{message:m.message,location:"offline mode fallback",timestamp:new Date().toISOString()}),new Zr.Notice(m.message),p}if(!((o=this.state.token)!=null&&o.access_token))throw new Error("No auth token available");if(this.isTokenExpired()){ve.log("Token expired - re-authentication required");let p=fa(An.TOKEN_EXPIRED);throw new Zr.Notice(p.message),new Error(p.message)}let c=new URL("/auth/verify",this.serverUrl).toString();ve.log("Verifying token:",{url:c,attempt:n,tokenType:this.state.token.token_type});let d=await(0,Zr.requestUrl)({url:c,method:"GET",headers:this.getAuthHeaders()});if(ve.log("Verify response received:",{status:d.status,statusText:d.status===401?"Unauthorized":d.status===200?"OK":"Unknown",headers:d.headers,hasBody:!!d.text}),d.status===401){ve.log("Token verification failed - Unauthorized");let p=fa(An.AUTH_FAILED,{reason:"Token is no longer valid"});return new Zr.Notice(p.message),!1}if(d.status!==200)throw ve.log("Unexpected response status:",d.status),new Error(`Unexpected response status: ${d.status}`);ve.log("Attempting to parse response body");let u=await d.json();if(ve.log("Response parsed successfully:",{authenticated:!!u.authenticated,hasError:!!u.error,userId:(a=u.user)==null?void 0:a.id}),!u.authenticated||u.error){let p=fa(An.AUTH_FAILED,{reason:u.message||u.error||"Server validation failed"});return new Zr.Notice(p.message),!1}if(!((s=u.user)!=null&&s.id)||!((l=u.user)!=null&&l.roles)){let p=fa(An.AUTH_FAILED,{reason:"Invalid user data received"});throw new Zr.Notice(p.message),new Error(p.message)}return this.state.cache={userId:u.user.id,roles:u.user.roles,features:this.getFeaturesFromRoles(u.user.roles),graceEnd:new Date(Date.now()+this.GRACE_PERIOD_DAYS*24*60*60*1e3),lastVerified:new Date,subscriptionStatus:u.user.subscriptionStatus},ve.log("Auth verification successful:",{userId:u.user.id,roleCount:u.user.roles.length,features:this.state.cache.features.length,expiresAt:this.state.cache.graceEnd}),this.state.isOffline=!1,this.updateSubscriptionTier(),await this.storeAuthConfig().catch(p=>{ve.warn("Failed to store updated auth config:",p)}),this.showTokenExpiryWarningIfNeeded(),!0}catch(c){if(ve.error(`Auth verification failed (attempt ${n}):`,c),ve.log("Error details before offline fallback:",{errorType:c instanceof Error?c.name:typeof c,errorMessage:c instanceof Error?c.message:String(c),isNetworkError:c instanceof Error&&c.message.toLowerCase().includes("network"),attempts:n,maxRetries:3}),n===3){ve.log("All online verification attempts failed - trying offline mode");let d=this.handleOfflineAuth();if(d){let u=fa(An.NETWORK_ERROR.basic);ve.log("Showing network error notice:",{message:u.title,location:"network error fallback",timestamp:new Date().toISOString()}),new Zr.Notice(u.title),this.showTokenExpiryWarningIfNeeded()}return d}await new Promise(d=>setTimeout(d,1e3*n))}return!1}handleOfflineAuth(){if(!this.state.cache)return ve.log("No cached auth data available for offline mode"),!1;let t=new Date;return t<this.state.cache.graceEnd?(ve.log("Using cached auth data:",{userId:this.state.cache.userId,graceEnd:this.state.cache.graceEnd,timeRemaining:this.state.cache.graceEnd.getTime()-t.getTime()}),this.state.isOffline=!0,!0):(ve.log("Cached auth data expired:",{graceEnd:this.state.cache.graceEnd,now:t}),!1)}async authenticate(){try{this.resetAuthState("Starting new authentication"),ve.log("Initiating beta email auth"),new Tw(this.app,async(r,n)=>{await this.handleBetaAuth(r,n)},()=>{ve.log("Authentication cancelled by user")}).open()}catch(t){ve.error("Auth error:",t),this.state.isAuthenticated=!1,this.state.token=null,this.state.cache=null;let r=fa(An.AUTH_FAILED);throw this.state.error=r.message,new Zr.Notice(r.message),t}}async handleBetaAuth(t,r){try{ve.log("Beta auth data received:",{hasToken:!!t,hasUser:!!r,userId:r==null?void 0:r.id,tier:r==null?void 0:r.tier});let n=this.decodeJWT(t);if(!n.exp||!n.user_id)throw new Error("Invalid JWT token claims");this.state.token={access_token:t,token_type:"Bearer",expires_in:this.BETA_EXPIRY_DAYS*24*60*60,refresh_token:null};let i=r.tier==="premium"?["journalit-premium"]:[],o=this.getFeaturesFromRoles(i);ve.log("Initializing beta auth cache:",{userId:r.id,email:r.email,tier:r.tier,roleCount:i.length,featureCount:o.length,features:o}),this.state.cache={userId:r.id,email:r.email,roles:i,features:o,graceEnd:new Date(Date.now()+this.GRACE_PERIOD_DAYS*24*60*60*1e3),lastVerified:new Date,tokenExpiry:new Date(n.exp*1e3),subscriptionStatus:"beta",isBeta:r.is_beta},this.state.isAuthenticated=!0,this.state.error=null,this.updateSubscriptionTier(),Te.setAuthToken(this.state.token.access_token),await this.storeAuthConfig().catch(a=>{ve.warn("Failed to store auth config:",a)}),ve.log("Triggering auth state change event (handleBetaAuth)"),hc.trigger(vc.STATE_CHANGED),ve.log("Beta authentication completed successfully:",{userId:this.state.cache.userId,email:this.state.cache.email,roles:this.state.cache.roles,features:this.state.cache.features,tier:this.state.subscriptionTier,tokenExpiry:this.state.cache.tokenExpiry})}catch(n){throw ve.error("Beta auth error:",n),this.state.isAuthenticated=!1,this.state.token=null,this.state.cache=null,n instanceof Error?this.state.error=n.message:this.state.error="An unknown error occurred",n}}resetAuthState(t="No reason provided"){var r,n,i;ve.log("Resetting auth state:",{reason:t,hadCache:!!this.state.cache,hadFeatures:!!((r=this.state.cache)!=null&&r.features),featureCount:(i=(n=this.state.cache)==null?void 0:n.features)==null?void 0:i.length,wasAuthenticated:this.state.isAuthenticated,wasOffline:this.state.isOffline}),this.state={isAuthenticated:!1,token:null,error:null,cache:null,isOffline:!1,subscriptionTier:void 0},Te.setAuthToken(null),ve.log("Auth state reset complete")}async logout(){if(ve.log("Starting logout process",{serverUrl:this.serverUrl,hasToken:!!this.state.token}),!this.state.token){ve.log("No active token to invalidate"),this.resetAuthState("No active token"),ve.log("Triggering auth state change event (no token path)"),hc.trigger(vc.STATE_CHANGED);return}let t=!1;try{if(navigator.onLine){let r=new URL("/auth/logout",this.serverUrl).toString();ve.log("Sending logout request to server",{fullUrl:r,headers:this.getAuthHeaders()}),await(0,Zr.requestUrl)({url:r,method:"POST",headers:this.getAuthHeaders()}),t=!0,ve.log("Token invalidation successful"),new Zr.Notice(An.STATUS.disconnected)}else{ve.log("Offline mode - skipping token invalidation");let r=fa(An.NETWORK_ERROR.basic);new Zr.Notice(r.message)}}catch(r){ve.error("Token invalidation failed:",{error:r,errorType:r instanceof Error?r.name:typeof r,message:r instanceof Error?r.message:"Unknown error"})}try{this.resetAuthState(t?"Token invalidation successful":"Local cleanup only"),Te.setAuthToken(null),ve.log("Checking for auth config file existence");let r=await this.app.vault.adapter.exists(this.CONFIG_PATH);if(ve.log("Auth config exists check result:",r),r){ve.log("Attempting to remove auth config file"),await this.app.vault.adapter.remove(this.CONFIG_PATH),ve.log("Auth config removal completed");let n=await this.app.vault.adapter.exists(this.CONFIG_PATH);ve.log("Post-removal existence check:",{path:this.CONFIG_PATH,stillExists:n,timestamp:new Date().toISOString()})}await this.keyManager.cleanup().catch(n=>{ve.warn("Failed to clean up key storage:",n)}),hc.trigger(vc.STATE_CHANGED)}catch(r){ve.error("Local cleanup failed:",r),this.resetAuthState("Forced reset after cleanup failure")}ve.log("Logout completed:",{tokenInvalidated:t,stateCleared:!this.state.token&&!this.state.isAuthenticated,configRemoved:!await this.app.vault.adapter.exists(this.CONFIG_PATH).catch(()=>!0)})}async hasFeature(t){var i,o,a;if(ve.log("hasFeature check:",{featureName:t,hasCache:!!this.state.cache,hasFeatures:!!((i=this.state.cache)!=null&&i.features),featureCount:(a=(o=this.state.cache)==null?void 0:o.features)==null?void 0:a.length,isOffline:this.state.isOffline}),!this.state.cache){let s=fa(An.NEEDS_AUTH);return new Zr.Notice(s.message),!1}let r=this.getFeaturesFromRoles([]).includes(t);if(!navigator.onLine){this.state.isOffline=!0,ve.log("Offline mode feature check:",{featureName:t,graceEnd:this.state.cache.graceEnd,now:new Date,isExpired:new Date>this.state.cache.graceEnd,features:this.state.cache.features});let s=vE(this.state.cache.graceEnd);if(new Zr.Notice(s.message),!this.handleOfflineAuth()){let c=An.OFFLINE_MODE.expired;return new Zr.Notice(c.message),!1}let l=this.state.cache.features.includes(t);if(!l&&!r){let c=fa(An.NEEDS_PREMIUM);new Zr.Notice(`${c.title}: ${c.message}`)}return l}if(this.state.isOffline=!1,Date.now()-this.state.cache.lastVerified.getTime()>36e5)try{await this.verifyAuth()}catch(s){let l=fa(An.NETWORK_ERROR.premium);return new Zr.Notice(l.message),r}let n=this.state.cache.features.includes(t);if(!n&&!r){let s=fa(An.NEEDS_PREMIUM);new Zr.Notice(`${s.title}: ${s.message}`)}return n}getAuthState(){return{...this.state}}isAuthenticated(){return this.state.isAuthenticated&&!!this.state.token}getSubscriptionTier(){return this.state.subscriptionTier}getUserId(){var t;return(t=this.state.cache)==null?void 0:t.userId}getAuthToken(){var t;return((t=this.state.token)==null?void 0:t.access_token)||null}getAuthHeaders(){var r;let t={"Content-Type":"application/json","Accept-Language":"en-US"};return(r=this.state.token)!=null&&r.access_token&&(t.Authorization=`Bearer ${this.state.token.access_token}`),t}};Up.AUTH_CHANGED="journalit-auth-changed";var YK="https://connect.journalit.co";var SE=()=>YK;async function Nn(e,t){try{let r=performance.now();await new Promise(o=>setTimeout(o,10));let n=e(),i=Math.round(performance.now()-r);return n}catch(r){throw console.error(`Failed to lazy load ${t}:`,r),r}}tw();var oz=require("obsidian");Sd();function TE(e){var r,n;let t=[];return(r=e.name)!=null&&r.trim()||t.push({field:"name",message:"Name is required"}),(n=e.description)!=null&&n.trim()||t.push({field:"description",message:"Description is required"}),e.name&&!/^[\w\s-]{3,50}$/.test(e.name)&&t.push({field:"name",message:"Name must be 3-50 characters and contain only letters, numbers, spaces, and hyphens"}),e.color&&!/^#[0-9A-Fa-f]{6}$/.test(e.color)&&t.push({field:"color",message:"Color must be a valid hex color code (e.g. #FF0000)"}),e.order!==void 0&&(!Number.isInteger(e.order)||e.order<0)&&t.push({field:"order",message:"Order must be a non-negative integer"}),t}function CE(e){if(!e.startsWith("setup-"))throw new Error('Invalid setup ID format: must start with "setup-"');if(!/^setup-[\w-]{1,50}$/.test(e))throw new Error("Invalid setup ID format: must contain only letters, numbers, and hyphens")}var Cw=class{constructor(t){this.tradeService=t}async calculateMetrics(t){let r=await this.getSetupTrades(t);if(!r.length)return this.getEmptyMetrics();let n=r.map(l=>this.calculateTradePnL(l)),i=n.filter(l=>l>0),o=n.filter(l=>l<0),a=this.calculateStreaks(n);return{...this.getEmptyMetrics(),totalTrades:r.length,winRate:i.length/r.length*100,totalPnL:n.reduce((l,c)=>l+c,0),avgWinner:i.length?i.reduce((l,c)=>l+c,0)/i.length:0,avgLoser:o.length?o.reduce((l,c)=>l+c,0)/o.length:0,winStreak:a.maxWin,loseStreak:a.maxLoss,currentStreak:a.current,...this.calculateAdvancedMetrics(r,n)}}async getSetupTrades(t){let r=await this.tradeService.getTrades(new Date(0),new Date);return(await Promise.all(r.map(async n=>{try{let i=await this.tradeService.readTradeContent(n),o=this.parseTrade(i);return o.setupIds.includes(t)?o:null}catch(i){return console.warn(`Invalid trade file: ${n.path}`),null}}))).filter(n=>n!==null)}calculateTradePnL(t){return(t.exitPrice-t.entryPrice)*t.positionSize}calculateStreaks(t){let r=0,n=0,i=0;return t.forEach(o=>{o>0?(r<0&&(r=0),r++,n=Math.max(n,r)):o<0&&(r>0&&(r=0),r--,i=Math.min(i,r))}),{maxWin:n,maxLoss:Math.abs(i),current:r}}getEmptyMetrics(){return{totalTrades:0,winRate:0,totalPnL:0,avgWinner:0,avgLoser:0,winStreak:0,loseStreak:0,currentStreak:0,expectedValue:0,riskRewardRatio:0,profitFactor:0,averageDuration:0,bestTrade:0,worstTrade:0,averageVolume:0,lastTradeDate:new Date().toISOString(),tradingFrequency:0,inactivityStreak:0}}calculateAdvancedMetrics(t,r){if(!t.length)return{};let n=r.filter(f=>f>0),i=r.filter(f=>f<0),o=t.map(f=>{let y=new Date(f.exitTime),h=new Date(f.entryTime);return(y.getTime()-h.getTime())/1e3/60}),a=t.map(f=>Math.abs(f.positionSize)),s=n.reduce((f,y)=>f+y,0),l=Math.abs(i.reduce((f,y)=>f+y,0)),c=t.map(f=>new Date(f.exitTime)),d=new Date(Math.max(...c.map(f=>f.getTime()))),u=new Date,p=Math.floor((u.getTime()-d.getTime())/(1e3*60*60*24)),m=new Date(Math.min(...c.map(f=>f.getTime()))),g=(u.getTime()-m.getTime())/(1e3*60*60*24*30.44);return{expectedValue:r.reduce((f,y)=>f+y,0)/r.length,riskRewardRatio:Math.abs(n.length?s/n.length:0)/Math.abs(i.length?l/i.length:1),profitFactor:l?s/l:s?1/0:0,averageDuration:o.reduce((f,y)=>f+y,0)/o.length,bestTrade:Math.max(...r),worstTrade:Math.min(...r),averageVolume:a.reduce((f,y)=>f+y,0)/a.length,lastTradeDate:d.toISOString(),tradingFrequency:t.length/g,inactivityStreak:p}}parseTrade(t){let r=t.match(/^---\n([\s\S]*?)\n---/);if(!r)throw new Error("Invalid trade file format");let n=r[1].split(`
`).reduce((o,a)=>{let[s,...l]=a.split(":").map(c=>c.trim());return s&&l.length&&(s==="setupIds"?o[s]=l.join(":").replace(/[\[\]]/g,"").split(",").map(c=>c.trim()):o[s]=l.join(":")),o},{}),i=new Date().toISOString();return{exitPrice:Number(n.exitPrice),entryPrice:Number(n.entryPrice),positionSize:Number(n.positionSize),setupIds:n.setupIds||[],entryTime:n.entryTime||i,exitTime:n.exitTime||n.entryTime||i}}};Ha();var Ew=class extends Ao{constructor(r,n,i={}){super(r,{folder:"setups",extension:".md",cacheTTL:5*60*1e3,persistCache:!0,namespace:i.namespace||"setup"});this.tradeService=n;this.SETUPS_FOLDER="setups";this.metricsCalculator=new Cw(n)}async getSetupMetrics(r){return CE(r),this.query(async()=>this.metricsCalculator.calculateMetrics(r),`metrics:${r}`,{offlineCapable:!0})}async getAllSetupMetrics(r){let n=`metrics:all${r?`:${JSON.stringify(r)}`:""}`;return this.query(async()=>{let i=await this.getSetupFiles(),o=await this.filterSetupFiles(i,r),a=new Map;for(let s of o)try{let l=await this.app.vault.read(s),c=await this.parseSetupContent(l),d=await this.metricsCalculator.calculateMetrics(c.id);a.set(c.id,d)}catch(l){console.warn(`Failed to calculate metrics for setup: ${s.path}`)}return a},n,{offlineCapable:!0})}async createSetup(r){let n=TE(r);if(n.length)throw new Error(`Invalid setup data: ${n.map(s=>s.message).join(", ")}`);let i=this.generateSetupId(r.name),o=this.getSetupFilePath(i),a=this.generateSetupContent({...r,id:i,status:"active",version:1,createdAt:this.formatDateTimeForDisplay(new Date),updatedAt:this.formatDateTimeForDisplay(new Date),color:r.color||"#808080",icon:r.icon||"trading_setup",order:r.order||0});return await this.app.vault.create(o,a),o}async updateSetup(r,n){if(CE(r),Object.keys(n).length>0){let d=[];"name"in n&&d.push("name"),"description"in n&&d.push("description"),"color"in n&&d.push("color"),"order"in n&&d.push("order");let u=TE(n).filter(p=>d.includes(p.field));if(u.length)throw new Error(`Invalid setup data: ${u.map(p=>p.message).join(", ")}`)}let i=this.getSetupFilePath(r),o=this.app.vault.getAbstractFileByPath(i);if(!o||!("path"in o))throw new Error(`Setup not found: ${r}`);let a=await this.app.vault.read(o),s=await this.parseSetupContent(a),l={...s,...n,version:s.version+1,updatedAt:this.formatDateTimeForDisplay(new Date)},c=this.generateSetupContent(l);await this.app.vault.modify(o,c),await kt(this.app,o),await this.clearCache()}async archiveSetup(r){await this.updateSetup(r,{status:"archived"})}async getSetups(r){let n=`setups:${JSON.stringify(r||{})}`;return this.query(async()=>{let i=await this.getSetupFiles();return this.filterSetupFiles(i,r)},n,{offlineCapable:!0})}async getSetupFiles(){return this.getFiles()}getSetupFilePath(r){return(0,oz.normalizePath)(`${this.SETUPS_FOLDER}/${r}.md`)}generateSetupId(r){return`setup-${r.toLowerCase().replace(/[^a-z0-9]/g,"-")}`}formatDateTimeForDisplay(r){let n=r.getFullYear(),i=String(r.getMonth()+1).padStart(2,"0"),o=String(r.getDate()).padStart(2,"0"),a=String(r.getHours()).padStart(2,"0"),s=String(r.getMinutes()).padStart(2,"0"),l=String(r.getSeconds()).padStart(2,"0");return`${n}-${i}-${o}T${a}:${s}:${l}`}generateSetupContent(r){return["---","type: setup",`id: ${r.id}`,`name: ${r.name}`,`description: ${r.description}`,`status: ${r.status}`,`color: ${r.color}`,`icon: ${r.icon}`,`version: ${r.version}`,`createdAt: ${r.createdAt}`,`updatedAt: ${r.updatedAt}`,`order: ${r.order}`,"---","","## Trading Rules","",r.rules||"No rules defined."].join(`
`)}async parseSetupContent(r){var o;let n=r.match(/^---\n([\s\S]*?)\n---/);if(!n)throw new Error("Invalid setup file format");let i=n[1].split(`
`).reduce((a,s)=>{let[l,...c]=s.split(":").map(d=>d.trim());return l&&c.length&&(a[l]=c.join(":")),a},{});return{id:i.id,name:i.name,description:i.description,rules:((o=r.split("## Trading Rules")[1])==null?void 0:o.trim())||"",status:i.status,color:i.color,icon:i.icon,version:parseInt(i.version,10),createdAt:i.createdAt,updatedAt:i.updatedAt,order:parseInt(i.order,10)}}async filterSetupFiles(r,n){return n?(await Promise.all(r.map(async o=>{try{let a=await this.app.vault.read(o),s=await this.parseSetupContent(a);return n.status&&s.status!==n.status||n.search&&!this.matchesSearch(s,n.search)?null:o}catch(a){return console.warn(`Invalid setup file: ${o.path}`),null}}))).filter(o=>o!==null):r}matchesSearch(r,n){let i=n.toLowerCase();return r.name.toLowerCase().includes(i)||r.description.toLowerCase().includes(i)||r.rules.toLowerCase().includes(i)}};var ga=require("obsidian");function az(e){let t=new CustomEvent("drc-created",{detail:{path:e}});document.dispatchEvent(t)}function EE(e,t="unknown"){let r=new CustomEvent("drc-updated",{detail:{path:e,source:t}});document.dispatchEvent(r)}Yt();oi();Ha();var Dw=class{constructor(t,r,n={}){this.JOURNALIT_FOLDER="!Journalit";this.DRC_PREFIX="DRC";this.app=t,this.plugin=r,this.namespace=n.namespace||"drc",document.addEventListener("journalit-settings-updated",this.onSettingsUpdated.bind(this))}async onSettingsUpdated(t){var r;try{if(((r=t==null?void 0:t.detail)==null?void 0:r.source)==="user-input")return;let n=this.app.workspace.getActiveFile();if(!n)return;let i=this.app.metadataCache.getFileCache(n);if(!(i!=null&&i.frontmatter)||i.frontmatter.type!=="drc")return;EE(n.path,"settings-update")}catch(n){console.error("Error updating DRC after settings change:",n)}}getWeekOfMonth(t){return Ga(t)}formatDateForFilename(t){let r=String(t.getDate()).padStart(2,"0"),n=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getFullYear()).slice(-2);return`${r}${n}${i}`}formatDateForDisplay(t){let r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0");return`${r}-${n}-${i}`}formatDateTimeForDisplay(t){let r=this.formatDateForDisplay(t),n=t.toTimeString().split(" ")[0];return`${r}T${n}`}async ensureDirectoryExists(t){let r=t.substring(0,t.lastIndexOf("/"));await this.app.vault.adapter.exists(r)||await this.app.vault.adapter.mkdir(r)}async createDRC(t){try{let r=this.getDRCNotePath(t);if(await this.app.vault.adapter.exists(r))return r;await this.ensureDirectoryExists(r);let i=this.generateInitialDRCContent(t),o=await this.app.vault.create(r,i);return await kt(this.app,o),await this.addBacklinksToContent(o,t),az(r),r}catch(r){throw console.error("Error creating DRC:",r),r}}async addBacklinksToContent(t,r){try{let n=await jp(r,this.plugin);if(n.drcToWeekly){let i=await this.app.vault.read(t),o=Kt.generateLinksSection(n),a=i+`

`+o;await this.app.vault.modify(t,a)}}catch(n){console.error("Error adding backlinks to DRC:",n)}}async getTodayDRC(){let t=new Date;return this.createDRC(t)}async getDRC(t){return this.createDRC(t)}async updateDRCBacklinks(t){try{let r=this.getDRCNotePath(t),n=this.app.vault.getAbstractFileByPath(r);if(!n||!(n instanceof ga.TFile))return;let i=await jp(t,this.plugin),o=await this.app.vault.read(n),a=Kt.updateLinksSection(o,i);a!==o&&await this.app.vault.modify(n,a)}catch(r){console.error("Error updating DRC backlinks:",r)}}async getTradesForDate(t){var r;try{let n=st(t,this.plugin),i=this.formatDateForDisplay(n),o=this.app.vault.getMarkdownFiles(),a=[];for(let s of o){let l=(r=this.app.metadataCache.getFileCache(s))==null?void 0:r.frontmatter;if(!(!l||l.type!=="trade")){if(l.entryTime){let c=new Date(l.entryTime),d=st(c,this.plugin);this.formatDateForDisplay(d)===i&&a.push(s)}else if(l.date){let c=new Date(l.date);this.formatDateForDisplay(c)===i&&a.push(s)}}}return a}catch(n){return console.error(`Error getting trades for date ${t.toDateString()}:`,n),[]}}async updateDRCFrontmatter(t,r,n="unknown"){try{let i=this.app.vault.getAbstractFileByPath(t);if(!i||!(i instanceof ga.TFile))throw new Error(`DRC file not found: ${t}`);if(await this.app.fileManager.processFrontMatter(i,o=>{Object.assign(o,r)}),await kt(this.app,i),n==="user-input")return;EE(t,n);return}catch(i){throw console.error(`Error updating DRC frontmatter in ${t}:`,i),i}}getWeeklyReviewPath(t){let r=Xr(t),n=r.getFullYear(),i=String(r.getMonth()+1).padStart(2,"0"),o=Ga(r),a=`${o}-Review.md`;return(0,ga.normalizePath)(`${this.JOURNALIT_FOLDER}/${n}/${i}/${o}/${a}`)}getMonthlyReviewPath(t){let r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),i=`${n}-Review.md`;return(0,ga.normalizePath)(`${this.JOURNALIT_FOLDER}/${r}/${n}/${i}`)}getDRCNotePath(t){let r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),i=this.getWeekOfMonth(t),o=this.formatDateForFilename(t),a=`${this.DRC_PREFIX}-${o}.md`;return(0,ga.normalizePath)(`${this.JOURNALIT_FOLDER}/${r}/${n}/${i}/${a}`)}getNextDayDRCPath(t){let n=Rb(this.plugin)?jC(t):new Date(t.getTime()+24*60*60*1e3);return this.getDRCNotePath(n)}getPreviousDayDRCPath(t){let n=Rb(this.plugin)?LC(t):new Date(t.getTime()-24*60*60*1e3);return this.getDRCNotePath(n)}async getAdjacentDRC(t,r,n){var i,o,a;try{let s=r<0?this.getPreviousDayDRCPath(t):this.getNextDayDRCPath(t);if(await this.app.vault.adapter.exists(s))return s;if((a=n!=null?n:(o=(i=this.plugin.settings)==null?void 0:i.drc)==null?void 0:o.autoCreateDRCOnNavigation)!=null?a:!0){let d=Rb(this.plugin),u;return r<0?u=d?LC(t):new Date(t.getTime()-24*60*60*1e3):u=d?jC(t):new Date(t.getTime()+24*60*60*1e3),await this.createDRC(u),s}return null}catch(s){return console.error("Error getting adjacent DRC:",s),null}}getDRCFile(t){let r=this.app.vault.getAbstractFileByPath(t);return!r||!(r instanceof ga.TFile)?null:r}extractDRCData(t){var r;try{let n=(r=this.app.metadataCache.getFileCache(t))==null?void 0:r.frontmatter;return!n||n.type!=="drc"?null:n}catch(n){return console.error("Error extracting DRC data:",n),null}}async getPreviousDayGoals(t){try{let r=this.getPreviousDayDRCPath(t);if(!await this.app.vault.adapter.exists(r))return null;let i=this.app.vault.getAbstractFileByPath(r);if(!i||!(i instanceof ga.TFile))return null;let o=this.extractDRCData(i);return(o==null?void 0:o.dailyGoals)||null}catch(r){return console.error("Error getting previous day goals:",r),null}}generateDRCTags(t){let r=[];r.push([Pp(Dp.DAILY)]);let n=ua(t);return n.length>0&&r.push(n),pa(...r)}generateInitialDRCContent(t){let r={type:"drc",date:this.formatDateForDisplay(t),created:this.formatDateTimeForDisplay(new Date),tags:this.generateDRCTags(t),preTradeChecklist:{},mentalGrade:"B",technicalGrade:"B",tradeRatings:{},reviewQuestions:{},missedTrades:[]};return this.plugin.settings.drc.checklistItems&&this.plugin.settings.drc.checklistItems.forEach(i=>{r.preTradeChecklist[i]=!1}),this.plugin.settings.drc.reviewQuestions&&this.plugin.settings.drc.reviewQuestions.forEach(i=>{r.reviewQuestions[i]=""}),[...["---",`type: ${r.type}`,...this.convertToYamlFrontmatter(r),"---"],`# Daily Report Card - ${this.formatDateForDisplay(t)}`,""].join(`
`)}convertToYamlFrontmatter(t){let r=[],n=i=>i==null?"null":typeof i=="string"?i.includes(":")||i.includes("#")||i.includes(`
`)||i.includes('"')||i.trim()===""?`"${i.replace(/"/g,'\\"')}"`:i:typeof i=="number"||typeof i=="boolean"?String(i):Array.isArray(i)||typeof i=="object"?JSON.stringify(i):String(i);for(let[i,o]of Object.entries(t))i!=="type"&&o!==void 0&&r.push(`${i}: ${n(o)}`);return r}async openDRC(t){try{let r=this.getDRCNotePath(t);await this.app.vault.adapter.exists(r)?await this.plugin.openFile(r,!0):(await this.createDRC(t),await this.plugin.openFile(r,!0))}catch(r){throw console.error(`Failed to open DRC for date ${t.toDateString()}:`,r),r}}async createWeeklyReview(t){try{let r=this.getWeeklyReviewPath(t);if(await this.app.vault.adapter.exists(r))return r;await this.ensureDirectoryExists(r);let i=this.generateInitialWeeklyReviewContent(t),o=await this.app.vault.create(r,i);return await kt(this.app,o),r}catch(r){throw console.error("Error creating weekly review:",r),r}}generateInitialWeeklyReviewContent(t){let r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),i=this.getWeekOfMonth(t),o={type:"weekly-review",date:this.formatDateForDisplay(t),created:this.formatDateTimeForDisplay(new Date),week:i,month:n,year:r.toString()};return[...["---",`type: ${o.type}`,...this.convertToYamlFrontmatter(o),"---"],"",`# Weekly Review - Week ${i}, ${n}/${r}`,"","## Summary","","Weekly trading summary goes here.","","## Performance","","Performance metrics for the week.","","## Lessons Learned","","Key takeaways from this week's trades.","","## Goals for Next Week","","Trading goals for the upcoming week."].join(`
`)}async openWeeklyReview(t){try{let r=this.getWeeklyReviewPath(t);await this.app.vault.adapter.exists(r)?await this.plugin.openFile(r,!0):(await this.createWeeklyReview(t),await this.plugin.openFile(r,!0))}catch(r){throw console.error(`Failed to open weekly review for date ${t.toDateString()}:`,r),r}}async saveDRCForecastImage(t,r,n){try{let i=r.getFullYear(),o=String(r.getMonth()+1).padStart(2,"0"),a=this.getWeekOfMonth(r),s=n.replace(/[^a-zA-Z0-9]/g,""),l=t.name.replace(/[^a-zA-Z0-9.-]/g,"_"),c="";if(l.includes("."))c=l.substring(l.lastIndexOf("."));else throw new Error("File name does not contain a period.");let d=Date.now(),u=this.formatDateForFilename(r),p=`DRC-${s}-${u}-${d}${c}`,m=`${this.JOURNALIT_FOLDER}/${i}/${o}/${a}/media`,g=`${m}/${p}`;await this.app.vault.adapter.mkdir((0,ga.normalizePath)(m));let f=await t.arrayBuffer();return await this.app.vault.createBinary((0,ga.normalizePath)(g),f),g}catch(i){throw console.error("Error saving DRC forecast image:",i),i}}async getWeeklyEventsForDate(t){var r;try{let n=t.toLocaleDateString("en-US",{weekday:"long"}),i=this.getWeeklyReviewPath(t);if(!await this.app.vault.adapter.exists(i))return[];let a=this.app.vault.getAbstractFileByPath(i);if(!a||!(a instanceof ga.TFile))return[];let s=(r=this.app.metadataCache.getFileCache(a))==null?void 0:r.frontmatter;return!s||s.type!=="weekly-review"?[]:(s.keyEvents||[]).filter(d=>d.day?d.day.toLowerCase()===n.toLowerCase():!0)}catch(n){return console.error("Error getting weekly events for date:",n),[]}}async deleteImage(t){try{let r=this.app.vault.getAbstractFileByPath(t);if(!r)throw new Error(`Image file not found: ${t}`);await this.app.vault.delete(r);let n=t.substring(0,t.lastIndexOf("/"));if(await this.app.vault.adapter.exists(n)){let o=await this.app.vault.adapter.list(n);if(o.files.length===0&&o.folders.length===0){let a=this.app.vault.getAbstractFileByPath(n);a&&await this.app.vault.delete(a)}}}catch(r){throw console.error(`Error deleting image ${t}:`,r),r}}};var Vp=require("obsidian");function sz(e){let t=new CustomEvent("weekly-review-created",{detail:{path:e}});document.dispatchEvent(t)}function DE(e){let t=new CustomEvent("weekly-review-updated",{detail:{path:e}});document.dispatchEvent(t)}Yt();oi();Ha();var Pw=class{constructor(t,r,n={}){this.JOURNALIT_FOLDER="!Journalit";this.WEEKLY_PREFIX="Weekly";this.app=t,this.plugin=r,this.namespace=n.namespace||"weekly",document.addEventListener("journalit-settings-updated",i=>{this.onSettingsUpdated(i)})}async onSettingsUpdated(t){var r,n,i;try{(r=t==null?void 0:t.detail)==null||r.component;let o=this.app.workspace.getActiveFile();if(!o)return;let a=this.app.metadataCache.getFileCache(o);if(!(a!=null&&a.frontmatter)||a.frontmatter.type!=="weekly-review")return;if(((n=t==null?void 0:t.detail)==null?void 0:n.component)==="weekly"&&((i=this.plugin.settings.weekly)!=null&&i.reviewQuestions)){let s=await this.extractWeeklyReviewData(o);if(!s)return;let l=Object.keys(s.reviewQuestions||{}),c=this.plugin.settings.weekly.reviewQuestions;if(l.length!==c.length||!l.every(d=>c.includes(d))){let d={};c.forEach(u=>{d[u]=s.reviewQuestions&&u in s.reviewQuestions?s.reviewQuestions[u]:""}),await this.updateWeeklyReviewFrontmatter(o.path,{reviewQuestions:d})}}DE(o.path)}catch(o){console.error("Error updating Weekly Review after settings change:",o)}}getWeeklyReviewPath(t){let r=Xr(t),n=r.getFullYear(),i=String(r.getMonth()+1).padStart(2,"0"),o=Ga(r),a=`${o}-Review.md`;return(0,Vp.normalizePath)(`${this.JOURNALIT_FOLDER}/${n}/${i}/${o}/${a}`)}async ensureDirectoryExists(t){let r=t.substring(0,t.lastIndexOf("/"));await this.app.vault.adapter.exists(r)||await this.app.vault.adapter.mkdir(r)}async createWeeklyReview(t){try{let r=this.getWeeklyReviewPath(t);if(await this.app.vault.adapter.exists(r))return r;await this.ensureDirectoryExists(r);let i=await this.generateInitialWeeklyReviewContent(t),o=await this.app.vault.create(r,i);return await kt(this.app,o),sz(r),r}catch(r){throw console.error("Error creating weekly review:",r),r}}formatDateForDisplay(t){let r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0");return`${r}-${n}-${i}`}generateWeeklyReviewTags(t){let r=[],n=Xr(t);r.push([Pp(Dp.WEEKLY)]);let i=ua(n);return i.length>0&&r.push(i),pa(...r)}async generateInitialWeeklyReviewContent(t){let r=Xr(t),n=r.getFullYear(),i=String(r.getMonth()+1).padStart(2,"0"),o=Ga(r),a=fl(r),s={type:"weekly-review",date:this.formatDateForDisplay(r),created:new Date().toISOString(),tags:this.generateWeeklyReviewTags(t),week:o,month:i,year:n.toString(),reviewQuestions:{},forecast:{monthly:{notes:""},weekly:{notes:""},daily:{notes:""}},keyEvents:[]};this.plugin.settings.weekly&&this.plugin.settings.weekly.reviewQuestions?this.plugin.settings.weekly.reviewQuestions.forEach(c=>{s.reviewQuestions&&(s.reviewQuestions[c]="")}):["What worked well this week?","What didn't work this week?","Which setups were most profitable?","What mistakes cost me the most money?","What could I improve for next week?"].forEach(d=>{s.reviewQuestions&&(s.reviewQuestions[d]="")});try{let c=new Date(r);c.setDate(c.getDate()-7);let d=this.getWeeklyReviewPath(c);if(await this.app.vault.adapter.exists(d)){let u=this.app.vault.getAbstractFileByPath(d);if(u instanceof Vp.TFile){let p=await this.extractWeeklyReviewData(u);p&&p.nextWeekGoals&&(s.previousGoals=p.nextWeekGoals)}}}catch(c){console.error("Error getting previous week goals:",c)}return[...["---",`type: ${s.type}`,...this.convertToYamlFrontmatter(s),"---"],`# Weekly Review - ${o}, ${i}/${n}`,""].join(`
`)}convertToYamlFrontmatter(t){let r=[],n=i=>i==null?"null":typeof i=="string"?i.includes(":")||i.includes("#")||i.includes(`
`)||i.includes('"')||i.trim()===""?`"${i.replace(/"/g,'\\"')}"`:i:typeof i=="number"||typeof i=="boolean"?String(i):Array.isArray(i)||typeof i=="object"?JSON.stringify(i):String(i);for(let[i,o]of Object.entries(t))i!=="type"&&o!==void 0&&r.push(`${i}: ${n(o)}`);return r}async extractWeeklyReviewData(t){var r;try{let n=(r=this.app.metadataCache.getFileCache(t))==null?void 0:r.frontmatter;return!n||n.type!=="weekly-review"?null:n}catch(n){return console.error("Error extracting Weekly Review data:",n),null}}async updateWeeklyReviewFrontmatter(t,r){try{let n=this.app.vault.getAbstractFileByPath(t);if(!n||!(n instanceof Vp.TFile))throw new Error(`Weekly Review file not found: ${t}`);await this.app.fileManager.processFrontMatter(n,i=>{Object.assign(i,r)}),await kt(this.app,n),DE(t);return}catch(n){throw console.error(`Error updating Weekly Review frontmatter in ${t}:`,n),n}}async getDRCsForWeek(t){var r;try{let n=Xr(t),i=new Date(n);i.setDate(i.getDate()+6);let o=this.formatDateForDisplay(n),a=this.formatDateForDisplay(i),s=this.app.vault.getMarkdownFiles(),l=[];for(let c of s){let d=(r=this.app.metadataCache.getFileCache(c))==null?void 0:r.frontmatter;if(!d||d.type!=="drc")continue;let u=d.date;u&&u>=o&&u<=a&&l.push({file:c,data:d})}return l.sort((c,d)=>c.data.date.localeCompare(d.data.date)),l}catch(n){return console.error("Error getting DRCs for week:",n),[]}}async getTradesForWeek(t){var r;try{let n=Xr(t),i=new Date(n);i.setDate(i.getDate()+6),i.setHours(23,59,59,999);let o=this.formatDateForDisplay(n),a=this.formatDateForDisplay(i),s=this.app.vault.getMarkdownFiles(),l=[];for(let c of s){let d=(r=this.app.metadataCache.getFileCache(c))==null?void 0:r.frontmatter;if(!(!d||d.type!=="trade")){if(d.entryTime){let u=new Date(d.entryTime),p=st(u,this.plugin),m=this.formatDateForDisplay(p);m>=o&&m<=a&&l.push(c)}else if(d.date){let u=new Date(d.date),p=this.formatDateForDisplay(u);p>=o&&p<=a&&l.push(c)}}}return l}catch(n){return console.error("Error getting trades for week:",n),[]}}async openWeeklyReview(t){try{let r=this.getWeeklyReviewPath(t);await this.app.vault.adapter.exists(r)?await this.plugin.openFile(r,!0):(await this.createWeeklyReview(t),await this.plugin.openFile(r,!0))}catch(r){throw console.error(`Failed to open weekly review for date ${t.toDateString()}:`,r),r}}getNextWeekReviewPath(t){let r=Xr(t),n=new Date(r);return n.setDate(n.getDate()+7),this.getWeeklyReviewPath(n)}getPreviousWeekReviewPath(t){let r=Xr(t),n=new Date(r);return n.setDate(n.getDate()-7),this.getWeeklyReviewPath(n)}async getAdjacentWeeklyReview(t,r,n){var i,o,a;try{let s=r<0?this.getPreviousWeekReviewPath(t):this.getNextWeekReviewPath(t);if(await this.app.vault.adapter.exists(s))return s;if((a=n!=null?n:(o=(i=this.plugin.settings)==null?void 0:i.weekly)==null?void 0:o.autoCreateWeeklyReviewOnNavigation)!=null?a:!0){let d=Xr(t),u;return r<0?(u=new Date(d),u.setDate(u.getDate()-7)):(u=new Date(d),u.setDate(u.getDate()+7)),await this.createWeeklyReview(u),s}return null}catch(s){return console.error("Error getting adjacent weekly review:",s),null}}async saveWeeklyReviewImage(t,r,n){try{let i=Xr(r),o=i.getFullYear(),a=String(i.getMonth()+1).padStart(2,"0"),s=Ga(i),l=n.replace(/[^a-zA-Z0-9]/g,""),c=`${this.JOURNALIT_FOLDER}/${o}/${a}/${s}/media`;return await lr.saveImage(t,c,`${s}-${l}`,void 0)}catch(i){throw console.error("Error saving weekly review image:",i),i}}async deleteImage(t){try{await lr.deleteImage(t,!0)}catch(r){throw console.error(`Error deleting image ${t}:`,r),r}}async deleteEmptyFolder(t){try{await lr.deleteEmptyFolder(t,this.JOURNALIT_FOLDER)}catch(r){console.error(`Error deleting empty folder ${t}:`,r)}}getMonthlyReviewPath(t){let r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),i=`${n}-Review.md`;return(0,Vp.normalizePath)(`${this.JOURNALIT_FOLDER}/${r}/${n}/${i}`)}};var Sl=require("obsidian");Sd();Yt();oi();Ha();var Aw=class extends Ao{constructor(r,n,i={}){super(r,{...i,namespace:"monthly-reviews",cacheTTL:5*60*1e3,persistCache:!0});this.lastCacheClear=0;this.monthlyDataCache=new Map;this.plugin=n,document.addEventListener("journalit:monthly-review-opened",async()=>{let o=Date.now();(!this.lastCacheClear||o-this.lastCacheClear>5e3)&&(await this.clearCache(),this.monthlyDataCache.clear(),this.lastCacheClear=o)})}defaultFrontmatter(){let r=new Date;return{type:"monthly-review",date:r.toISOString(),month:r.getMonth()+1,year:r.getFullYear(),reviewQuestions:{},monthlyGoals:[],keyFocusAreas:[],biggestAccomplishment:"",biggestChallenge:"",lessonsLearned:[],nextMonthGoals:[],areasOfImprovement:[]}}getCacheNamespace(){return"monthly-reviews"}isValidType(r){return(r==null?void 0:r.type)==="monthly-review"}async clearCache(){await super.clearCache(),this.monthlyDataCache.clear()}async ensureDirectoryExists(r){let n=r.substring(0,r.lastIndexOf("/"));await this.app.vault.adapter.exists(n)||await this.app.vault.createFolder(n)}getMonthlyReviewPath(r){let n=r.getFullYear(),i=(r.getMonth()+1).toString().padStart(2,"0");return(0,Sl.normalizePath)(`!Journalit/${n}/${i}/${i}-Review.md`)}async createMonthlyReview(r){let n=this.getMonthlyReviewPath(r),i=this.app.vault.getAbstractFileByPath(n);if(i instanceof Sl.TFile)return i;await this.ensureDirectoryExists(n);let o={...this.defaultFrontmatter(),date:r.toISOString(),month:r.getMonth()+1,year:r.getFullYear()},a=this.generateInitialContent(o);try{return await this.app.vault.create(n,a)}catch(s){return console.error("Error creating monthly review:",s),null}}generateMonthlyReviewTags(r,n){let i=[],o=new Date(n,r-1,1);i.push([Pp(Dp.MONTHLY)]);let a=ua(o);a.length>0&&i.push(a);let s=Math.ceil(r/3);return i.push([`q${s}-review`]),r===1?i.push(["year-start"]):r===12&&i.push(["year-end"]),pa(...i)}generateInitialContent(r){let n=new Date(r.year,r.month-1).toLocaleDateString("en-US",{month:"long"}),i=this.generateMonthlyReviewTags(r.month,r.year);return`---
type: ${r.type}
date: ${r.date}
month: ${r.month}
year: ${r.year}
tags: [${i.map(o=>`"${o}"`).join(", ")}]
reviewQuestions: {}
monthlyGoals: []
keyFocusAreas: []
biggestAccomplishment: ""
biggestChallenge: ""
lessonsLearned: []
nextMonthGoals: []
areasOfImprovement: []
---

# ${n} ${r.year} Review

## Overview
*Monthly performance metrics and analysis will appear here.*

## Review
*Reflect on your trading performance and lessons learned this month.*

## Goals for Next Month
*Set clear, actionable goals for the upcoming month.*
`}async getMonthlyTrades(r,n){try{let i=new Date(r,n-1,1);new Date(r,n,0).setHours(23,59,59,999);let a=[],s=this.app.vault.getMarkdownFiles();for(let l of s)try{let c=this.app.metadataCache.getFileCache(l),d=c==null?void 0:c.frontmatter;if((d==null?void 0:d.type)==="trade"&&d.entryTime){let u=new Date(d.entryTime);if(isNaN(u.getTime()))continue;let p=st(u,this.plugin);if(p.getFullYear()===r&&p.getMonth()+1===n){let m=d.exitTime?new Date(d.exitTime):u,g=d.pnl===void 0||d.pnl===null,f={instrument:d.instrument||d.ticker,direction:d.direction||d.side,entryTime:u,exitTime:m,entryPrice:d.entryPrice||0,exitPrice:d.exitPrice!==void 0&&d.exitPrice!==null?d.exitPrice:0,positionSize:d.positionSize||0,pnl:d.pnl!==void 0&&d.pnl!==null?d.pnl:0,setup:d.setup,tags:d.tags,mistake:d.mistake,path:l.path,tradeStatus:d.tradeStatus,useDirectPnLInput:d.useDirectPnLInput,exits:d.exits,_originalPnlWasNull:g};a.push(f)}}}catch(c){console.warn(`Error processing trade file ${l.path}:`,c);continue}return a}catch(i){return console.error("Error getting monthly trades:",i),[]}}async getWeeklyPerformance(r,n){var i,o;try{let a=await this.getMonthlyTrades(r,n);if(a.length===0)return console.log(`No trades found for ${r}-${String(n).padStart(2,"0")}`),[];let s=new Map,l=(i=this.plugin)!=null&&i.serviceManager?await this.plugin.serviceManager.getWeeklyReviewService():(o=this.plugin)==null?void 0:o.weeklyReviewService;return a.forEach(c=>{let d=new Date(c.entryTime),u=Xr(d),p=this.getWeekNumber(d);if(d.getMonth()+1!==n)return;if(!s.has(p)){let g=new Date(u);g.setDate(g.getDate()+6);let f;l&&(f=l.getWeeklyReviewPath(u)),s.set(p,{weekNumber:p,weekStartDate:u,weekEndDate:g,trades:0,winRate:0,profitFactor:0,pnl:0,weeklyReviewPath:f})}let m=s.get(p);m.trades++,m.pnl+=c.pnl||0}),s.forEach((c,d)=>{let u=a.filter(y=>{let h=new Date(y.entryTime);return this.getWeekNumber(h)===d&&h.getMonth()+1===n}),p=u.filter(y=>(y.pnl||0)>0),m=u.filter(y=>(y.pnl||0)<0);c.winRate=u.length>0?p.length/u.length:0;let g=p.reduce((y,h)=>y+(h.pnl||0),0),f=Math.abs(m.reduce((y,h)=>y+(h.pnl||0),0));c.profitFactor=f>0?g/f:g>0?1/0:0}),Array.from(s.values()).sort((c,d)=>c.weekNumber-d.weekNumber)}catch(a){return console.error("Error getting weekly performance:",a),[]}}getWeekNumber(r){let n=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate())),i=n.getUTCDay()||7;n.setUTCDate(n.getUTCDate()+4-i);let o=new Date(Date.UTC(n.getUTCFullYear(),0,1));return Math.ceil(((n.getTime()-o.getTime())/864e5+1)/7)}async getDemonTrackerData(r,n){var i,o,a;try{let s=(i=this.plugin)==null?void 0:i.drcService;if(!s&&((o=this.plugin)!=null&&o.serviceManager))try{s=await this.plugin.serviceManager.getDRCService()}catch(u){console.warn("Could not get DRC service:",u)}if(!s)return console.log("DRC service not available for demon tracker data"),[];let l=new Date(r,n-1,1),c=new Date(r,n,0),d=new Map;for(let u=new Date(l);u<=c;u.setDate(u.getDate()+1)){let p=s.getDRCNotePath(new Date(u)),m=this.app.vault.getAbstractFileByPath(p);if(m instanceof Sl.TFile){let g=this.app.metadataCache.getFileCache(m),f=g==null?void 0:g.frontmatter;if(f&&f.type==="drc"){let y=(a=this.plugin)==null?void 0:a.tradeService;if(y){let h=new Date(u);h.setHours(0,0,0,0);let v=new Date(u);v.setHours(23,59,59,999);let b=await y.getTrades(h,v),w=[];for(let k of b){let S=await y.extractTradeData(k);S&&w.push(S)}w.forEach(k=>{k.mistake&&Array.isArray(k.mistake)&&k.mistake.forEach(S=>{d.has(S)||d.set(S,{mistake:S,occurrences:0,dates:[]});let x=d.get(S);x.occurrences++,x.dates.push(u.toISOString())})})}}}}return Array.from(d.values()).sort((u,p)=>p.occurrences-u.occurrences)}catch(s){return console.error("Error getting demon tracker data:",s),[]}}async getAdjacentMonthlyReview(r,n,i=!0){var c,d;let o=new Date(r);o.setMonth(o.getMonth()+n);let a=this.getMonthlyReviewPath(o);if(this.app.vault.getAbstractFileByPath(a)instanceof Sl.TFile)return a;let l=(c=this.plugin)==null?void 0:c.settings;if(i&&((d=l==null?void 0:l.monthly)!=null&&d.autoCreateMonthlyReviewOnNavigation)){let u=await this.createMonthlyReview(o);return u?u.path:null}return null}async getBestPerformingWeek(r,n){let i=await this.getWeeklyPerformance(r,n);return i.length===0?null:i.reduce((o,a)=>a.pnl>o.pnl?a:o)}async getWorstPerformingWeek(r,n){let i=await this.getWeeklyPerformance(r,n);return i.length===0?null:i.reduce((o,a)=>a.pnl<o.pnl?a:o)}async getWeeklyGamePerformance(r,n){var i,o,a,s;try{let l=await this.getWeeklyPerformance(r,n),c=(i=this.plugin)!=null&&i.serviceManager?await this.plugin.serviceManager.getWeeklyReviewService():(o=this.plugin)==null?void 0:o.weeklyReviewService,d=(a=this.plugin)!=null&&a.serviceManager?await this.plugin.serviceManager.getDRCService():(s=this.plugin)==null?void 0:s.drcService;if(!c||!d)return console.warn("Weekly or DRC service not available for game performance data"),[];let u=[];for(let p of l){let m={A:0,B:0,C:0},g={A:0,B:0,C:0},f=await c.getDRCsForWeek(p.weekStartDate);for(let{data:w}of f){let k=new Date(w.date);k.getMonth()+1===n&&k.getFullYear()===r&&(w.mentalGrade&&["A","B","C"].includes(w.mentalGrade)&&m[w.mentalGrade]++,w.technicalGrade&&["A","B","C"].includes(w.technicalGrade)&&g[w.technicalGrade]++)}let y,h,v,b;if(p.weeklyReviewPath){let w=this.app.vault.getAbstractFileByPath(p.weeklyReviewPath);if(w instanceof Sl.TFile){let k=await c.extractWeeklyReviewData(w);k&&(y=k.mentalGrade,h=k.technicalGrade,v=k.mentalNotes,b=k.technicalNotes)}}u.push({weekNumber:p.weekNumber,weekStartDate:p.weekStartDate,weekEndDate:p.weekEndDate,weeklyReviewPath:p.weeklyReviewPath,mentalGradeDistribution:m,technicalGradeDistribution:g,mentalRating:y,technicalRating:h,mentalNotes:v,technicalNotes:b})}return u}catch(l){return console.error("Error getting weekly game performance:",l),[]}}async getMonthlyDataOptimized(r,n){let i=`${r}-${n}`,o=this.monthlyDataCache.get(i);if(o&&Date.now()-o.timestamp<5*60*1e3)return o.data;try{let a=await this.getMonthlyTradesOptimized(r,n),s=await this.calculateWeeklyPerformance(a,r,n),l=this.getDemonTrackerDataFromTrades(a),c=await this.getWeeklyGamePerformanceOptimized(s,r,n),d=s.length>0?s.reduce((m,g)=>g.pnl>m.pnl?g:m):null,u=s.length>0?s.reduce((m,g)=>g.pnl<m.pnl?g:m):null,p={trades:a,weeklyPerformance:s,weeklyGamePerformance:c,demonTrackerData:l,bestWeek:d,worstWeek:u};return this.monthlyDataCache.set(i,{data:p,timestamp:Date.now()}),p}catch(a){return console.error("Error getting optimized monthly data:",a),{trades:[],weeklyPerformance:[],weeklyGamePerformance:[],demonTrackerData:[],bestWeek:null,worstWeek:null}}}async getMonthlyTradesOptimized(r,n){try{let i=[],o=`!Journalit/${r}/${String(n).padStart(2,"0")}`,a=this.app.vault.getMarkdownFiles().filter(l=>l.path.startsWith(o)&&l.path.includes("/trades/")),s=20;for(let l=0;l<a.length;l+=s){let d=a.slice(l,l+s).map(async p=>{try{let m=this.app.metadataCache.getFileCache(p),g=m==null?void 0:m.frontmatter;if((g==null?void 0:g.type)==="trade"&&g.entryTime){let f=new Date(g.entryTime);if(isNaN(f.getTime()))return null;let y=st(f,this.plugin);if(y.getFullYear()===r&&y.getMonth()+1===n){let h=g.exitTime?new Date(g.exitTime):f,v=g.pnl===void 0||g.pnl===null;return{instrument:g.instrument||g.ticker,direction:g.direction||g.side,entryTime:f,exitTime:h,entryPrice:g.entryPrice||0,exitPrice:g.exitPrice!==void 0&&g.exitPrice!==null?g.exitPrice:0,positionSize:g.positionSize||0,pnl:g.pnl!==void 0&&g.pnl!==null?g.pnl:0,setup:g.setup,tags:g.tags,mistake:g.mistake,path:p.path,tradeStatus:g.tradeStatus,useDirectPnLInput:g.useDirectPnLInput,exits:g.exits,_originalPnlWasNull:v}}}return null}catch(m){return console.warn(`Error processing trade file ${p.path}:`,m),null}}),u=await Promise.all(d);i.push(...u.filter(p=>p!==null))}return i}catch(i){return console.error("Error getting optimized monthly trades:",i),[]}}async calculateWeeklyPerformance(r,n,i){var o,a;try{if(r.length===0)return[];let s=new Map,l=(o=this.plugin)!=null&&o.serviceManager?await this.plugin.serviceManager.getWeeklyReviewService():(a=this.plugin)==null?void 0:a.weeklyReviewService;return r.forEach(c=>{let d=new Date(c.entryTime),u=Xr(d),p=this.getWeekNumber(d);if(d.getMonth()+1!==i)return;if(!s.has(p)){let g=new Date(u);g.setDate(g.getDate()+6);let f;l&&(f=l.getWeeklyReviewPath(u)),s.set(p,{weekNumber:p,weekStartDate:u,weekEndDate:g,trades:0,winRate:0,profitFactor:0,pnl:0,weeklyReviewPath:f})}let m=s.get(p);m.trades++,m.pnl+=c.pnl||0}),s.forEach((c,d)=>{let u=r.filter(y=>{let h=new Date(y.entryTime);return this.getWeekNumber(h)===d&&h.getMonth()+1===i}),p=u.filter(y=>(y.pnl||0)>0),m=u.filter(y=>(y.pnl||0)<0);c.winRate=u.length>0?p.length/u.length:0;let g=p.reduce((y,h)=>y+(h.pnl||0),0),f=Math.abs(m.reduce((y,h)=>y+(h.pnl||0),0));c.profitFactor=f>0?g/f:g>0?1/0:0}),Array.from(s.values()).sort((c,d)=>c.weekNumber-d.weekNumber)}catch(s){return console.error("Error calculating weekly performance:",s),[]}}async getWeeklyGamePerformanceOptimized(r,n,i){var o,a,s,l;try{let c=(o=this.plugin)!=null&&o.serviceManager?await this.plugin.serviceManager.getWeeklyReviewService():(a=this.plugin)==null?void 0:a.weeklyReviewService,d=(s=this.plugin)!=null&&s.serviceManager?await this.plugin.serviceManager.getDRCService():(l=this.plugin)==null?void 0:l.drcService;if(!c||!d)return[];let u=r.map(async p=>{let m={A:0,B:0,C:0},g={A:0,B:0,C:0},f=await c.getDRCsForWeek(p.weekStartDate);for(let{data:w}of f){let k=new Date(w.date);k.getMonth()+1===i&&k.getFullYear()===n&&(w.mentalGrade&&["A","B","C"].includes(w.mentalGrade)&&m[w.mentalGrade]++,w.technicalGrade&&["A","B","C"].includes(w.technicalGrade)&&g[w.technicalGrade]++)}let y,h,v,b;if(p.weeklyReviewPath){let w=this.app.vault.getAbstractFileByPath(p.weeklyReviewPath);if(w instanceof Sl.TFile){let k=await c.extractWeeklyReviewData(w);k&&(y=k.mentalGrade,h=k.technicalGrade,v=k.mentalNotes,b=k.technicalNotes)}}return{weekNumber:p.weekNumber,weekStartDate:p.weekStartDate,weekEndDate:p.weekEndDate,weeklyReviewPath:p.weeklyReviewPath,mentalGradeDistribution:m,technicalGradeDistribution:g,mentalRating:y,technicalRating:h,mentalNotes:v,technicalNotes:b}});return await Promise.all(u)}catch(c){return console.error("Error getting optimized weekly game performance:",c),[]}}getDemonTrackerDataFromTrades(r){try{let n=new Map;return r.forEach(i=>{i.mistake&&Array.isArray(i.mistake)&&i.mistake.forEach(o=>{n.has(o)||n.set(o,{mistake:o,occurrences:0,dates:[]});let a=n.get(o);a.occurrences++,a.dates.push(i.entryTime.toISOString())})}),Array.from(n.values()).sort((i,o)=>o.occurrences-i.occurrences)}catch(n){return console.error("Error processing demon tracker data from trades:",n),[]}}async updateMonthlyReviewFrontmatter(r,n){try{let i=this.app.vault.getAbstractFileByPath(r);if(!i||!(i instanceof Sl.TFile))throw new Error(`Monthly Review file not found: ${r}`);await this.app.fileManager.processFrontMatter(i,o=>{Object.assign(o,n)}),await kt(this.app,i),await this.clearCache(),this.monthlyDataCache.clear();return}catch(i){throw console.error(`Error updating Monthly Review frontmatter in ${r}:`,i),i}}};var ha=require("obsidian");var _e=$(W()),vh=require("obsidian");Jr();Ci();Yt();var KK=({accountInfo:e,existingAccounts:t=[],availableAccountTypes:r=["demo","evaluation","funded","real"],onLink:n,onCancel:i})=>{let[o,a]=(0,_e.useState)("new"),[s,l]=(0,_e.useState)(""),[c,d]=(0,_e.useState)(""),[u,p]=(0,_e.useState)("demo"),[m,g]=(0,_e.useState)(!1),f=(0,_e.useMemo)(()=>t.length>0,[t]),y=(0,_e.useMemo)(()=>f?"new":"default",[f]),h=async()=>{var v;g(!0);try{let b="",w,k;switch(o){case"new":b=s||`Account-${e.accountId}`,k=u;break;case"existing":if(!c){new vh.Notice("Please select an existing account"),g(!1);return}w=c,b=((v=t.find(S=>S.path===c))==null?void 0:v.name)||"";break;case"default":b=`Account-${e.accountId}`,k=u;break}await n(e.accountId,b,w,k)}catch(b){console.error("Failed to link account:",b),new vh.Notice("Failed to link account: "+b.message)}finally{g(!1)}};return _e.default.createElement("div",{className:"account-link-modal"},_e.default.createElement("h3",null,"New Trading Account Detected"),_e.default.createElement("div",{className:"account-info"},_e.default.createElement("p",null,_e.default.createElement("strong",null,"Account ID:")," ",e.accountId),e.brokerName&&_e.default.createElement("p",null,_e.default.createElement("strong",null,"Broker:")," ",e.brokerName),e.firstSeen&&_e.default.createElement("p",null,_e.default.createElement("strong",null,"First Seen:")," ",Ze(new Date(e.firstSeen),fr()))),_e.default.createElement("div",{className:"link-options"},_e.default.createElement("div",{className:"modal-field"},_e.default.createElement("label",{className:"section-label"},"How would you like to handle this account?"),_e.default.createElement("div",{className:"link-option-group"},_e.default.createElement("label",{className:"link-option"},_e.default.createElement("input",{type:"radio",name:"linkOption",value:"new",checked:o==="new",onChange:()=>a("new")}),_e.default.createElement("span",null,"Create new account with custom name")),o==="new"&&_e.default.createElement("div",{className:"custom-name-input"},_e.default.createElement("input",{type:"text",value:s,onChange:v=>l(v.target.value),placeholder:"e.g., FTMO Challenge",className:"modal-input"}),_e.default.createElement("div",{className:"account-type-select"},_e.default.createElement("label",{className:"field-label"},"Account Type:"),_e.default.createElement("select",{value:u,onChange:v=>p(v.target.value),className:"modal-select"},r.map(v=>_e.default.createElement("option",{key:v,value:v},v.charAt(0).toUpperCase()+v.slice(1)))))),_e.default.createElement("label",{className:"link-option"},_e.default.createElement("input",{type:"radio",name:"linkOption",value:"existing",checked:o==="existing",onChange:()=>a("existing"),disabled:!f}),_e.default.createElement("span",null,"Link to existing account")),o==="existing"&&f&&_e.default.createElement("div",{className:"existing-account-select"},_e.default.createElement("select",{value:c,onChange:v=>d(v.target.value),className:"modal-select"},_e.default.createElement("option",{value:""},"Select an account..."),t.map(v=>_e.default.createElement("option",{key:v.path,value:v.path},v.name)))),_e.default.createElement("label",{className:"link-option"},_e.default.createElement("input",{type:"radio",name:"linkOption",value:"default",checked:o==="default",onChange:()=>a("default")}),_e.default.createElement("span",null,"Use default name: Account-",e.accountId)),o==="default"&&_e.default.createElement("div",{className:"account-type-select"},_e.default.createElement("label",{className:"field-label"},"Account Type:"),_e.default.createElement("select",{value:u,onChange:v=>p(v.target.value),className:"modal-select"},r.map(v=>_e.default.createElement("option",{key:v,value:v},v.charAt(0).toUpperCase()+v.slice(1)))))))),_e.default.createElement("div",{className:"modal-actions"},_e.default.createElement(be,{onClick:h,disabled:m,variant:"primary"},m?"Linking...":"Confirm"),_e.default.createElement(be,{onClick:i,disabled:m,variant:"secondary"},"Cancel")))},Nw=class extends vh.Modal{constructor(r,n,i,o){super(r);this.existingAccounts=[];this.availableAccountTypes=[];this.accountInfo=n,this.onLink=i,this.onCancel=o}async onOpen(){let{contentEl:r}=this;r.empty(),await this.loadExistingAccounts(),await this.loadAvailableAccountTypes();let{injectAccountLinkModalStyles:n}=(ME(),mT(cz));n();let i=r.createDiv(),{createRoot:o}=Ps();o(i).render(_e.default.createElement(KK,{accountInfo:this.accountInfo,existingAccounts:this.existingAccounts,availableAccountTypes:this.availableAccountTypes,onLink:async(s,l,c,d)=>{await this.onLink(s,l,c,d),this.close()},onCancel:()=>{this.onCancel(),this.close()}}))}async loadExistingAccounts(){try{let r=It().plugins.plugins.journalit,n=r==null?void 0:r.accountService;if(!n)return;let i=await n.getAllAccounts();this.existingAccounts=i.map(o=>({path:o.notePath||"",name:o.accountName||o.name||"Unnamed Account"}))}catch(r){console.error("Failed to load existing accounts:",r)}}async loadAvailableAccountTypes(){try{let r=It().plugins.plugins.journalit,n=r==null?void 0:r.accountService;if(!n){this.availableAccountTypes=["demo","evaluation","funded","real"];return}this.availableAccountTypes=await n.getExistingAccountTypes()}catch(r){console.error("Failed to load available account types:",r),this.availableAccountTypes=["demo","evaluation","funded","real"]}}onClose(){let{contentEl:r}=this;r.empty()}};kl();var Mw=require("obsidian");kl();var yh=class{constructor(t,r){this.tradeSyncMapping={};this.plugin=t,this.settings=r}async loadSyncMapping(){let t=this.settings.tradeSyncMapping;t&&(this.tradeSyncMapping=t),await this.rebuildSyncMapping()}async rebuildSyncMapping(){let t=this.plugin.app.vault.getMarkdownFiles().filter(n=>this.isTradeFile(n));if(t.length===0){this.tradeSyncMapping={},await this.saveSyncMapping();return}let r={};for(let n of t)try{let i=await this.plugin.app.vault.read(n),o=this.parseTradeFromMarkdown(i);o&&o.backendTradeId&&(r[o.backendTradeId]=n.path)}catch(i){console.error("Error reading trade file for sync mapping:",i)}this.tradeSyncMapping=r,await this.saveSyncMapping()}async saveSyncMapping(){this.settings.tradeSyncMapping=this.tradeSyncMapping,await this.plugin.saveSettings()}getSyncMapping(){return this.tradeSyncMapping}addMapping(t,r){this.tradeSyncMapping[t]=r}removeMapping(t){delete this.tradeSyncMapping[t]}getFilePathForTrade(t){return this.tradeSyncMapping[t]}async fetchAllTrades(t){var a;let r=[],n=0,i=100,o=!0;for(;o;){let s=Te.buildUrl("/api/v1/trades",{limit:i,offset:n}),l=await Te.makeRequest(s,{method:"GET"},"fetch trades");if(!l||!l.trades){console.warn("Invalid response from trades API:",l);break}Array.isArray(l.trades)&&r.push(...l.trades),o=((a=l.pagination)==null?void 0:a.has_more)||!1,n+=i}return r}isTradeFile(t){return t.path.includes("!Journalit/")&&t.path.includes("/trades/")&&t.extension==="md"}parseTradeFromMarkdown(t){try{let r=t.match(/^---\n([\s\S]*?)\n---/);if(!r)return null;let n=r[1],i={},o=n.split(`
`);for(let a of o){let s=a.indexOf(":");if(s===-1)continue;let l=a.substring(0,s).trim(),c=a.substring(s+1).trim();if(!(!l||!c))if(c.startsWith("[")&&c.endsWith("]")){let d=c.substring(1,c.length-1).trim();d?i[l]=d.split(",").map(u=>u.trim()):i[l]=[]}else i[l]=c}return i.type==="trade"&&i.instrument&&i.direction?(i.backendTradeId&&(i.backendTradeId=parseInt(i.backendTradeId)),i):null}catch(r){return console.error("Error parsing trade markdown:",r),null}}async findExistingTradeFile(t,r,n,i,o){let a=`!Journalit/${n}/${i}/W${o}/trades`,s=this.plugin.app.vault.getAbstractFileByPath(a);if(s&&s instanceof Mw.TFolder){let l=`${t.symbol}-${r}-T`;for(let c of s.children)if(c instanceof Mw.TFile&&c.name.startsWith(l)){let d=await this.plugin.app.vault.read(c),u=this.parseTradeFromMarkdown(d);if(u){if(u.backendTradeId&&u.backendTradeId===t.id)return c.path;let p=new Date(u.entryTime),m=new Date(t.entry_time),g=Math.abs(p.getTime()-m.getTime()),f=Math.abs(parseFloat(u.entryPrice)-t.entry_price)<1e-5,y=u.instrument===t.symbol;if(g<6e4&&f&&y)return c.path}}}return null}};kl();var bh=class{constructor(t,r){this.plugin=t,this.settings=r}getAccountDisplayName(t){return this.settings.accountMapping&&this.settings.accountMapping[t]?this.settings.accountMapping[t]:`Account-${t}`}async createAccountMapping(t,r){this.settings.accountMapping||(this.settings.accountMapping={}),this.settings.accountMapping[t]=r,await this.plugin.saveSettings()}async updateAccountMappings(t){this.settings.accountMapping||(this.settings.accountMapping={});let r=!1;for(let n of t)n.displayName&&(!this.settings.accountMapping[n.accountId]||this.settings.accountMapping[n.accountId]!==n.displayName)&&(this.settings.accountMapping[n.accountId]=n.displayName,r=!0);r&&await this.plugin.saveSettings()}async fetchUserAccounts(t){try{let r=Te.buildUrl("/api/v1/mt-accounts"),n=await Te.makeRequest(r,{method:"GET"},"fetch user accounts");return n?(n.accounts||[]).map(o=>({accountId:o.accountId||o.account_id||o.mt_account_id||"",displayName:o.displayName||o.display_name||`Account-${o.account_id||o.mt_account_id||"Unknown"}`,brokerName:o.brokerName||o.broker_name,firstSeen:o.firstSeen||o.first_seen,lastSeen:o.lastSeen||o.last_seen})):[]}catch(r){throw console.error("Failed to fetch user accounts:",r),r}}async updateAccountDisplayName(t,r,n){try{let i=Te.buildUrl(`/api/v1/mt-accounts/${encodeURIComponent(t)}`);return await Te.makeRequest(i,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({display_name:r})},"update account display name"),await this.createAccountMapping(t,r),!0}catch(i){throw console.error("Failed to update account display name:",i),i}}async getAccountTrades(t,r,n=100,i=0){try{let o=Te.buildUrl(`/api/v1/mt-accounts/${encodeURIComponent(t)}/trades`,{limit:n,offset:i}),a=await Te.makeRequest(o,{method:"GET"},"fetch account trades");return a?a.trades||[]:[]}catch(o){throw console.error("Failed to fetch account trades:",o),o}}checkForNewAccounts(t){let r=[];for(let n of t)(!this.settings.accountMapping||!this.settings.accountMapping[n])&&r.push(n);return r}};var OE=require("obsidian");kl();var wh=class{constructor(t,r){this.plugin=t,this.settings=r}async getFTPCredentials(t){var r;try{let n=(r=this.plugin.authManager.getAuthState().token)==null?void 0:r.access_token,i={};n&&(i.Authorization=`Bearer ${n}`);let o=Te.buildUrl(`/api/v1/ftp-users/${t}`),a=await Te.makeRequest(o,{method:"GET",headers:i},"get FTP credentials");return a?{user_id:a.user_id,username:a.username,server:a.server||"sync.journalit.co",port:a.port||2121,lastPasswordReset:a.last_password_reset}:null}catch(n){if(console.error("Failed to get FTP credentials:",n),this.settings.ftpUsername)return null;if(n instanceof Error&&n.message.includes("404"))return await this.createFTPUser(t);throw n}}async createOrGetFTPUser(){var t;try{let r=(t=this.plugin.authManager.getAuthState().token)==null?void 0:t.access_token,n={"Content-Type":"application/json"};r&&(n.Authorization=`Bearer ${r}`);let i=Te.buildUrl("/api/v1/ftp-users/auto-create"),o=await Te.makeRequest(i,{method:"POST",headers:n,body:JSON.stringify({username:`journalit${Date.now()}${Math.floor(Math.random()*1e3)}`})},"create or get FTP user");if(!o)return null;let a={user_id:o.user_id,username:o.username,password:o.password,server:o.server||"sync.journalit.co",port:o.port||2121,lastPasswordReset:o.last_password_reset||new Date().toISOString()};return o.user_id&&this.settings&&(this.settings.ftpUserId=o.user_id,await this.plugin.saveSettings()),a}catch(r){return console.error("Failed to create or get FTP user:",r),null}}async autoCreateFTPCredentials(t){var r;try{let n=(r=this.plugin.authManager.getAuthState().token)==null?void 0:r.access_token,i={"Content-Type":"application/json"};n&&(i.Authorization=`Bearer ${n}`);let o=Te.buildUrl("/api/v1/ftp-users/auto-create"),a=await Te.makeRequest(o,{method:"POST",headers:i,body:JSON.stringify({username:t})},"auto-create FTP user");return a?{username:a.username,password:a.password,server:a.server||"sync.journalit.co",port:a.port||2121,lastPasswordReset:new Date().toISOString()}:null}catch(n){return console.error("Failed to auto-create FTP user:",n),new OE.Notice("\u274C Failed to create FTP credentials"),null}}async createFTPUser(t){var r;try{let n=await this.getFTPUserAccountId();if(!n)return console.error("Could not determine account ID for FTP user creation"),null;let i=(r=this.plugin.authManager.getAuthState().token)==null?void 0:r.access_token,o={"Content-Type":"application/json"};i&&(o.Authorization=`Bearer ${i}`);let a=Te.buildUrl("/api/v1/ftp-users/create"),s=await Te.makeRequest(a,{method:"POST",headers:o,body:JSON.stringify({user_id:n})},"create FTP user");return s?{username:s.username,password:s.password,server:s.server||"sync.journalit.co",port:s.port||2121,lastPasswordReset:new Date().toISOString()}:null}catch(n){return console.error("Failed to create FTP user:",n),null}}async resetFTPPassword(t){var r;try{let n=this.settings.ftpUsername||t,i=this.settings.ftpUserId;if(!i&&n){let c=await this.getFTPCredentials(n);c&&c.user_id&&(i=c.user_id,this.settings.ftpUserId=i,await this.plugin.saveSettings())}if(!i)return console.error("Could not determine FTP user ID. Username:",n),new OE.Notice("\u274C Could not find FTP user. Please try creating new credentials."),null;let o=(r=this.plugin.authManager.getAuthState().token)==null?void 0:r.access_token,a={"Content-Type":"application/json"};o&&(a.Authorization=`Bearer ${o}`);let s=Te.buildUrl(`/api/v1/ftp-users/${i}/password`),l=await Te.makeRequest(s,{method:"PUT",headers:a},"reset FTP password");return l?{user_id:i,username:n,password:l.password,server:"sync.journalit.co",port:2121,lastPasswordReset:new Date().toISOString()}:null}catch(n){throw console.error("Failed to reset FTP password:",n),n}}async getFTPUserAccountId(){if(this.settings.ftpUserId)return this.settings.ftpUserId;let t=this.settings.ftpUsername;if(t){let r=await this.getFTPCredentials(t);if(r&&r.user_id)return this.settings.ftpUserId=r.user_id,await this.plugin.saveSettings(),r.user_id}return console.error("Could not determine FTP user account ID. FTP username:",t),null}};var dz=require("obsidian");var xh=class{constructor(t,r){this.plugin=t}generateTradeFilePath(t){let r=new Date(t.entry_time),n=r.getFullYear(),i=String(r.getMonth()+1).padStart(2,"0"),o=this.getWeekNumber(r),a=this.formatDateForUser(r),s=this.getNextTradeNumber(t.symbol,a,n,i,o);return`!Journalit/${n}/${i}/W${o}/trades/${t.symbol}-${a}-T${s}.md`}getNextTradeNumber(t,r,n,i,o){let a=`!Journalit/${n}/${i}/W${o}/trades`,s=this.plugin.app.vault.getAbstractFileByPath(a),l=0;if(s&&s instanceof dz.TFolder){let c=`${t}-${r}-T`;for(let d of s.children)if(d.name.startsWith(c)){let u=d.name.match(/T(\d+)\.md$/);if(u){let p=parseInt(u[1]);p>l&&(l=p)}}}return l+1}async generateTradeMarkdown(t,r){let n=new Date(t.entry_time),i=t.exit_time?new Date(t.exit_time):null,o=t.direction.toUpperCase()==="BUY"?"long":"short",a=this.determineAssetType(t.symbol),s={type:"trade",backendTradeId:t.id,entryTime:this.formatDateForFrontmatter(t.entry_time),entryPrice:t.entry_price,positionSize:t.volume,direction:o,instrument:t.symbol,assetType:a};try{let d=this.plugin.optionsService||new En;d.getInstrumentsForAssetType(a).includes(t.symbol)||await d.addOption("instrument",t.symbol,a)}catch(d){console.error(`Failed to add instrument '${t.symbol}' to options:`,d)}if(t.status==="CLOSED"&&t.exit_time&&t.exit_price&&(s.exitTime=this.formatDateForFrontmatter(t.exit_time),s.exitPrice=t.exit_price,t.profit_loss!==void 0&&t.profit_loss!==null)){let d=t.profit_loss,u=t.commission||0,p=t.swap||0,m=t.fees||0;s.pnl=d+u+p+m}if(t.entries&&t.entries.length>0?s.entries=t.entries.map(d=>({time:this.formatDateForFrontmatter(d.time),price:d.price,size:d.size})):s.entries=[{time:this.formatDateForFrontmatter(t.entry_time),price:t.entry_price,size:t.volume}],t.status==="CLOSED"&&t.exit_time&&t.exit_price&&(t.exits&&t.exits.length>0?s.exits=t.exits.map(d=>({time:this.formatDateForFrontmatter(d.time),price:d.price,size:d.size})):s.exits=[{time:this.formatDateForFrontmatter(t.exit_time),price:t.exit_price,size:t.volume}]),t.commission!==void 0&&t.commission!==null?s.commission=t.commission:s.commission=0,t.swap!==void 0&&t.swap!==null?s.swap=t.swap:s.swap=0,t.fees!==void 0&&t.fees!==null?s.fees=t.fees:s.fees=0,s.setupIds=[],s.mistakeIds=[],t.mt_account_number){s.accountId=t.mt_account_number;let d=r||t.mt_account_display_name||`Account-${t.mt_account_number}`;s.account=[d],s.accountIds=[d]}else console.warn(`Trade ${t.id} missing mt_account_number - using fallback account name in frontmatter`),s.accountIds=["Unknown Account"],s.account=["Unknown Account"];s.setup=[],s.mistake=[],s.images=[],s.tags=[],s.thesis="",s.lotSize=1e5,s.pipValue=1;let l=`---
`;for(let[d,u]of Object.entries(s))if(u!=null)if(Array.isArray(u))if(u.length===0)l+=`${d}: []
`;else if(d==="entries"||d==="exits"){l+=`${d}:
`;for(let p of u)l+=`  - time: ${p.time}
`,l+=`    price: ${p.price}
`,l+=`    size: ${p.size}
`}else d==="images"?l+=`${d}: [${u.map(p=>`"${p}"`).join(", ")}]
`:l+=`${d}: [${u.map(p=>`${p}`).join(", ")}]
`;else u===""?l+=`${d}: ""
`:l+=`${d}: ${u}
`;l+=`---

`;let c=`# ${t.symbol} - ${t.direction.toUpperCase()}

`;return c+=`Entry: ${t.entry_price} at ${n.toLocaleString()}
`,i?(c+=`Exit: ${t.exit_price} at ${i.toLocaleString()}
`,t.profit_loss!==void 0&&t.profit_loss!==null&&(t.profit_loss>0?c+=`\u2705 Profit: $${t.profit_loss.toFixed(2)}
`:t.profit_loss<0&&(c+=`\u274C Loss: $${Math.abs(t.profit_loss).toFixed(2)}
`))):c+=`Status: Open
`,l+c}formatDateForFrontmatter(t){return(typeof t=="string"?new Date(t):t).toISOString().split(".")[0]}formatDateForUser(t){let r=this.plugin.settings.trade.dateFormat,n=String(t.getDate()).padStart(2,"0"),i=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getFullYear()).slice(-2);switch(r){case"DDMMYY":return`${n}${i}${o}`;case"MMDDYY":return`${i}${n}${o}`;default:return`${o}${i}${n}`}}getWeekNumber(t){let r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())),n=r.getUTCDay()||7;r.setUTCDate(r.getUTCDate()+4-n);let i=new Date(Date.UTC(r.getUTCFullYear(),0,1));return Math.ceil(((r.getTime()-i.getTime())/864e5+1)/7)}async ensureDirectoryExists(t){var i;let r=t.split("/"),n="";for(let o of r)if(o&&(n+=(n?"/":"")+o,!this.plugin.app.vault.getAbstractFileByPath(n)))try{await this.plugin.app.vault.createFolder(n)}catch(a){if(!((i=a.message)!=null&&i.includes("already exists")))throw a}}determineAssetType(t){let r=t.toUpperCase();return r.includes("/")||r.length===6&&this.isForexCurrency(r.substring(0,3))&&this.isForexCurrency(r.substring(3,6))?"forex":r.endsWith("USDT")||r.endsWith("BTC")||r.endsWith("ETH")||r.includes("CRYPTO")?"crypto":/[0-9]/.test(r)&&(r.startsWith("ES")||r.startsWith("NQ")||r.startsWith("CL")||r.startsWith("GC"))?"futures":"stock"}isForexCurrency(t){return["EUR","USD","GBP","JPY","CHF","CAD","AUD","NZD"].includes(t)}};var Nd=require("obsidian"),kh=class{constructor(t,r,n){this.lastProcessedFiles=new Set;this.fileCleanupIntervalId=null;this.MAX_TRACKED_FILES=1e3;this.MAX_FILE_AGE_MS=24*60*60*1e3;this.fileProcessTimestamps=new Map;this.plugin=t,this.settings=r,this.tradeSyncService=n}setupFileWatcher(){this.plugin.registerEvent(this.plugin.app.vault.on("create",t=>{t instanceof Nd.TFile&&this.tradeSyncService.isTradeFile(t)&&this.processNewTradeFile(t)})),this.plugin.registerEvent(this.plugin.app.vault.on("modify",t=>{t instanceof Nd.TFile&&this.tradeSyncService.isTradeFile(t)&&!this.lastProcessedFiles.has(t.path)&&this.processNewTradeFile(t)})),this.plugin.registerEvent(this.plugin.app.vault.on("delete",t=>{t instanceof Nd.TFile&&this.removeFileFromTracking(t.path)})),this.plugin.registerEvent(this.plugin.app.vault.on("rename",(t,r)=>{t instanceof Nd.TFile&&(this.removeFileFromTracking(r),this.tradeSyncService.isTradeFile(t)&&this.processNewTradeFile(t))})),this.startPeriodicCleanup()}async processNewTradeFile(t){var r,n;try{if((n=(r=this.plugin.tradeService)==null?void 0:r.recentlyCreatedFiles)!=null&&n.has(t.path))return;let i=await this.plugin.app.vault.read(t),o=this.tradeSyncService.parseTradeFromMarkdown(i);if(o){this.addFileToTracking(t.path);let a=o.backendTradeId!==void 0;if(!a&&o.pnl&&(o.account||o.accountIds)&&this.plugin.accountService)try{let s=o.account||o.accountIds;Array.isArray(s)||(s=s?[s]:[]);for(let l of s)if(l&&typeof l=="string"&&l.trim()){let c=typeof o.pnl=="string"?parseFloat(o.pnl):o.pnl;await this.plugin.accountService.updateBalanceFromTrade(l.trim(),t.path,c,!1,void 0,new Date(o.exitTime||o.entryTime||new Date().toISOString()))}}catch(s){console.error("Error updating account balance from manual trade:",s)}this.settings.showNewTradeNotifications&&o.instrument&&o.direction&&!a&&new Nd.Notice(`\u{1F4C8} New trade created: ${o.instrument} ${o.direction}`),this.plugin.app.workspace.trigger("journalit:trade-file-added",o)}}catch(i){console.error("Error processing new trade file:",i)}}async checkForNewTradeFiles(){let t=this.plugin.app.vault.getMarkdownFiles().filter(r=>this.tradeSyncService.isTradeFile(r));for(let r of t)this.lastProcessedFiles.has(r.path)||await this.processNewTradeFile(r)}addFileToTracking(t){this.lastProcessedFiles.add(t),this.fileProcessTimestamps.set(t,Date.now()),this.lastProcessedFiles.size>this.MAX_TRACKED_FILES&&this.performCleanup()}removeFileFromTracking(t){this.lastProcessedFiles.delete(t),this.fileProcessTimestamps.delete(t)}startPeriodicCleanup(){this.fileCleanupIntervalId=window.setInterval(()=>{this.performCleanup()},36e5)}stopPeriodicCleanup(){this.fileCleanupIntervalId!==null&&(window.clearInterval(this.fileCleanupIntervalId),this.fileCleanupIntervalId=null)}performCleanup(){let t=Date.now(),r=[];for(let[n,i]of this.fileProcessTimestamps){if(t-i>this.MAX_FILE_AGE_MS){r.push(n);continue}this.plugin.app.vault.getAbstractFileByPath(n)||r.push(n)}for(let n of r)this.removeFileFromTracking(n);if(this.lastProcessedFiles.size>this.MAX_TRACKED_FILES){let n=Array.from(this.fileProcessTimestamps.entries()).sort((o,a)=>o[1]-a[1]),i=this.lastProcessedFiles.size-Math.floor(this.MAX_TRACKED_FILES*.8);for(let o=0;o<i&&o<n.length;o++)this.removeFileFromTracking(n[o][0])}r.length>0||this.lastProcessedFiles.size>this.MAX_TRACKED_FILES}clearProcessedFiles(){this.lastProcessedFiles.clear(),this.fileProcessTimestamps.clear(),this.stopPeriodicCleanup()}};Ha();var IE=60,Sh=class{constructor(t){this.syncIntervalId=null;this.isSyncing=!1;this.plugin=t,this.settings=t.settings.backendIntegration,this.tradeSyncService=new yh(t,this.settings),this.accountManagementService=new bh(t,this.settings),this.ftpManagementService=new wh(t,this.settings),this.tradeFileGenerator=new xh(t,this.settings),this.fileWatcherService=new kh(t,this.settings,this.tradeSyncService),this.tradeSyncService.loadSyncMapping(),this.fileWatcherService.setupFileWatcher(),this.debouncedForceSync=RC(this.forceSync.bind(this),5e3),this.debouncedCheckForNewTrades=RC(this.checkForNewTrades.bind(this),3e4),this.settings.syncEnabled&&IE>0&&this.startAutoSync()}getUserId(){try{let t=this.plugin.app.vault.getName();if(t&&t!=="Obsidian Vault")return t.toLowerCase().replace(/[^a-z0-9]/g,"");let r=this.plugin.app.vault.adapter,n="";if(r.basePath)n=r.basePath;else if(r.path)n=r.path;else return"cursive";return(n.split(/[/\\]/).pop()||"unknown").toLowerCase().replace(/[^a-z0-9]/g,"")}catch(t){return console.warn("Could not auto-detect user ID:",t),this.settings.userId||"cursive"}}getVaultPath(){try{let t=this.plugin.app.vault.adapter;return t.basePath?t.basePath:t.path?t.path:this.plugin.app.vault.getName()||"Unknown Vault"}catch(t){return console.warn("Could not get vault path:",t),"Unknown Vault"}}async registerVault(){var c;let t=(c=this.plugin.authManager.getAuthState().token)==null?void 0:c.access_token;if(!t)return console.debug("BackendIntegrationService: Skipping vault registration \u2013 user not authenticated yet."),!1;let r=t,n=this.settings.ftpUsername||this.getUserId(),i=this.getVaultPath(),o={vault_path:i,user_id:n,settings:{date_format:this.plugin.settings.trade.dateFormat,enabled:this.settings.syncEnabled}},a={"Content-Type":"application/json"};r&&(a.Authorization=`Bearer ${r}`);let s=Te.buildUrl("/api/v1/obsidian/register-vault");return await Te.makeRequest(s,{method:"POST",headers:a,body:JSON.stringify(o)},"vault registration")?(this.settings.userId=n,this.settings.vaultPath=i,await this.plugin.saveSettings(),this.settings.showSyncNotifications&&new ha.Notice("\u2705 Vault registered with trading server"),!0):!1}async forceSync(){var t;try{try{let d=(t=this.plugin.authManager.getAuthState().token)==null?void 0:t.access_token,u={};d&&(u.Authorization=`Bearer ${d}`);let p=Te.buildUrl("/api/v1/sync/ftp"),m=await Te.makeRequest(p,{method:"POST",headers:u},"FTP sync trigger");m!=null&&m.success||console.warn("FTP sync failed:",m==null?void 0:m.error)}catch(d){console.warn("Failed to trigger FTP sync:",d)}let r=await this.getFTPUserAccountId();if(!r)return new ha.Notice("\u274C Failed to get account information"),null;let n=await this.tradeSyncService.fetchAllTrades(r),i=[],o=new Set;for(let d of n)d.mt_account_number&&o.add(d.mt_account_number);let a=this.accountManagementService.checkForNewAccounts(o);if(a.length>0)for(let d of a){let u=n.find(y=>y.mt_account_number===d),p=(u==null?void 0:u.mt_account_display_name)||`Account-${d}`,m={accountId:d,displayName:p,brokerName:"MetaTrader",firstSeen:(u==null?void 0:u.entry_time)||new Date().toISOString()},g=await new Promise(y=>{new Nw(this.plugin.app,m,async(v,b,w,k)=>{y(w?{action:"link",linkToPath:w}:b&&b!==p?{action:"create",displayName:b,accountType:k}:{action:"default",accountType:k})},()=>{y({action:"cancel"})}).open()});if(g.action==="cancel")continue;let f=p;if(g.action==="link"&&g.linkToPath){await this.accountManagementService.createAccountMapping(d,g.linkToPath);continue}else g.action==="create"&&g.displayName&&(f=g.displayName);if(await this.accountManagementService.createAccountMapping(d,f),this.plugin.accountService)try{m.displayName=f;let y=await this.plugin.accountService.createAccountFromSync(m,g.accountType);this.settings.showSyncNotifications&&new ha.Notice(`\u{1F4CA} Created account: ${f}`)}catch(y){console.error(`Failed to create Account note for ${d}:`,y),i.push(`Failed to create account ${f}: ${y.message}`)}}let s=0,l=0;for(let d of n)try{let u=await this.createTradeFile(d);u==="created"?s++:u==="updated"&&l++}catch(u){i.push(`Failed to create file for trade ${d.id}: ${u.message}`),console.error(`Failed to create file for trade ${d.id}:`,u)}if(this.settings.lastSyncTime=new Date().toISOString(),this.settings.syncCount=(this.settings.syncCount||0)+1,await this.plugin.saveSettings(),this.plugin.accountService&&n.length>0)try{let d=new Set;for(let u of n)if(u.mt_account_number){let p=u.mt_account_display_name||this.accountManagementService.getAccountDisplayName(u.mt_account_number)||`Account-${u.mt_account_number}`;d.add(p)}else console.warn(`Trade ${u.id} missing mt_account_number - using fallback account name`),d.add("Unknown Account");for(let u of d){let p=await this.plugin.accountService.getAccountByName(u);if(p){await this.plugin.accountService.recalculateAccountMetrics(p.id);let m=new CustomEvent("journalit:account-updated",{detail:{accountId:p.id,notePath:p.notePath,timestamp:Date.now()}});document.dispatchEvent(m)}}}catch(d){console.error("Error recalculating account metrics after sync:",d),i.push(`Failed to recalculate metrics: ${d.message}`)}let c={status:"success",synced_trades:n.length,new_files:s,updated_files:l,errors:i};return this.settings.showSyncNotifications&&(n.length>0?new ha.Notice(`\u2705 Synced ${n.length} trades (${s} new files, ${l} updated)`):new ha.Notice("\u2705 Sync complete - no trades found")),c}catch(r){return console.error("Force sync failed:",r),new ha.Notice("\u274C Sync failed: "+r.message),null}}async getSyncStatus(){let t=Te.buildUrl("/api/v1/obsidian/status"),r=await Te.makeRequest(t,{method:"GET"},"sync status");return r||null}async checkForNewTrades(){if(this.settings.syncEnabled){if(!this.plugin.authManager.isAuthenticated()){console.warn("Auto-sync skipped: User not authenticated");return}await this.forceSync()}}startAutoSync(){this.syncIntervalId&&window.clearInterval(this.syncIntervalId);let t=IE*60*1e3;this.syncIntervalId=window.setInterval(()=>{this.debouncedCheckForNewTrades()},t)}stopAutoSync(){this.syncIntervalId&&(window.clearInterval(this.syncIntervalId),this.syncIntervalId=null),this.debouncedForceSync.cancel(),this.debouncedCheckForNewTrades.cancel()}async updateSettings(t){let r={...this.settings};Object.assign(this.settings,t),this.plugin.settings.backendIntegration=this.settings,await this.plugin.saveSettings(),r.syncEnabled!==this.settings.syncEnabled&&(this.stopAutoSync(),this.settings.syncEnabled&&IE>0&&this.startAutoSync())}async getFTPUserAccountId(){if(this.settings.ftpUserId)return this.settings.ftpUserId;let t=this.settings.ftpUsername;if(t){let r=await this.ftpManagementService.getFTPCredentials(t);if(r&&r.user_id)return this.settings.ftpUserId=r.user_id,await this.updateSettings({ftpUserId:r.user_id}),r.user_id}return console.error("Could not determine FTP user account ID. FTP username:",t),null}async createTradeFile(t){let r=this.tradeSyncService.getFilePathForTrade(t.id);if(r){let y=this.plugin.app.vault.getAbstractFileByPath(r);if(y instanceof ha.TFile)return await this.updateExistingTradeFile(y,t);this.tradeSyncService.removeMapping(t.id)}let n=new Date(t.entry_time),i=n.getFullYear(),o=String(n.getMonth()+1).padStart(2,"0"),a=this.getWeekNumber(n),s=this.tradeFileGenerator.formatDateForUser(n),l=await this.tradeSyncService.findExistingTradeFile(t,s,i,o,a);if(l){this.tradeSyncService.addMapping(t.id,l),await this.tradeSyncService.saveSyncMapping();let y=this.plugin.app.vault.getAbstractFileByPath(l),h=await this.plugin.app.vault.read(y),v=this.tradeSyncService.parseTradeFromMarkdown(h);if(v&&!v.backendTradeId){let b=h.match(/^---\n([\s\S]*?)\n---/);if(b){let k=b[1].replace(/type: trade/,`type: trade
backendTradeId: ${t.id}`),S=h.replace(b[0],`---
${k}
---`);await this.plugin.app.vault.modify(y,S),await kt(this.plugin.app,y);let x=new CustomEvent("journalit:trade-data-changed",{detail:{action:"updated",filePath:y.path,timestamp:Date.now()}});document.dispatchEvent(x)}}return await this.updateExistingTradeFile(y,t)}let c=this.tradeFileGenerator.generateTradeFilePath(t);if(this.plugin.app.vault.getAbstractFileByPath(c))return this.tradeSyncService.addMapping(t.id,c),await this.tradeSyncService.saveSyncMapping(),"skipped";let u=t.mt_account_number?this.accountManagementService.getAccountDisplayName(t.mt_account_number):void 0,p=await this.tradeFileGenerator.generateTradeMarkdown(t,u),m=c.substring(0,c.lastIndexOf("/"));await this.tradeFileGenerator.ensureDirectoryExists(m);let g=await this.plugin.app.vault.create(c,p);await kt(this.plugin.app,g);let f=this.plugin.tradeService;if(f&&f.addRecentlyCreatedFile&&f.addRecentlyCreatedFile(c),this.tradeSyncService.addMapping(t.id,c),await this.tradeSyncService.saveSyncMapping(),await this.autoCreateReviewsForSyncedTrade(t),setTimeout(async()=>{let y=new CustomEvent("journalit:trade-data-changed",{detail:{action:"created",filePath:c,timestamp:Date.now()}});document.dispatchEvent(y)},500),t.status==="CLOSED"&&t.profit_loss!==void 0&&t.profit_loss!==null&&this.plugin.accountService)try{let y;t.mt_account_number?y=t.mt_account_display_name||this.accountManagementService.getAccountDisplayName(t.mt_account_number)||`Account-${t.mt_account_number}`:(console.warn(`Trade ${t.id} missing mt_account_number - using fallback account name`),y="Unknown Account"),await this.plugin.accountService.updateBalanceFromTrade(y,c,t.profit_loss,!1)}catch(y){console.error("Error updating account balance from synced trade:",y)}return"created"}async updateExistingTradeFile(t,r){let n=await this.plugin.app.vault.read(t),i=this.tradeSyncService.parseTradeFromMarkdown(n);if(!i)return console.warn("Could not parse current trade from markdown"),"skipped";let o=!i.exitTime||i.exitTime==="",a=r.status==="CLOSED"&&r.exit_time;if(o&&a){let s=r.mt_account_number?this.accountManagementService.getAccountDisplayName(r.mt_account_number):void 0,l=await this.tradeFileGenerator.generateTradeMarkdown(r,s);await this.plugin.app.vault.modify(t,l),await kt(this.plugin.app,t);let c=new CustomEvent("journalit:trade-data-changed",{detail:{action:"updated",filePath:t.path,timestamp:Date.now()}});if(document.dispatchEvent(c),r.profit_loss!==void 0&&r.profit_loss!==null&&this.plugin.accountService)try{let d;r.mt_account_number?d=r.mt_account_display_name||this.accountManagementService.getAccountDisplayName(r.mt_account_number)||`Account-${r.mt_account_number}`:(console.warn(`Trade ${r.id} missing mt_account_number - using fallback account name`),d="Unknown Account"),await this.plugin.accountService.updateBalanceFromTrade(d,t.path,r.profit_loss,!1)}catch(d){console.error("Error updating account balance from updated trade:",d)}return"updated"}return"skipped"}generateTradeFilePath(t){let r=new Date(t.entry_time),n=r.getFullYear(),i=String(r.getMonth()+1).padStart(2,"0"),o=this.getWeekNumber(r),a=this.formatDateForUser(r),s=this.getNextTradeNumber(t.symbol,a,n,i,o);return`!Journalit/${n}/${i}/W${o}/trades/${t.symbol}-${a}-T${s}.md`}getNextTradeNumber(t,r,n,i,o){let a=`!Journalit/${n}/${i}/W${o}/trades`,s=this.plugin.app.vault.getAbstractFileByPath(a),l=0;if(s&&s instanceof ha.TFolder){let c=`${t}-${r}-T`;for(let d of s.children)if(d instanceof ha.TFile&&d.name.startsWith(c)){let u=d.name.match(/T(\d+)\.md$/);if(u){let p=parseInt(u[1]);p>l&&(l=p)}}}return l+1}generateTradeMarkdown(t){let r=new Date(t.entry_time),n=t.exit_time?new Date(t.exit_time):null,i=t.direction.toUpperCase()==="BUY"?"long":"short",o={type:"trade",backendTradeId:t.id,entryTime:this.formatDateForFrontmatter(t.entry_time),entryPrice:t.entry_price,positionSize:t.volume,direction:i,instrument:t.symbol,assetType:"forex",tradeStatus:t.status};if(t.status==="CLOSED"&&t.exit_time&&t.exit_price&&(o.exitTime=this.formatDateForFrontmatter(t.exit_time),o.exitPrice=t.exit_price,t.profit_loss!==void 0&&t.profit_loss!==null&&(o.pnl=t.profit_loss)),t.entries&&t.entries.length>0?o.entries=t.entries.map(l=>({time:this.formatDateForFrontmatter(l.time),price:l.price,size:l.size})):o.entries=[{time:this.formatDateForFrontmatter(t.entry_time),price:t.entry_price,size:t.volume}],t.status==="CLOSED"&&t.exit_time&&t.exit_price&&(t.exits&&t.exits.length>0?o.exits=t.exits.map(l=>({time:this.formatDateForFrontmatter(l.time),price:l.price,size:l.size})):o.exits=[{time:this.formatDateForFrontmatter(t.exit_time),price:t.exit_price,size:t.volume}]),o.setupIds=[],o.mistakeIds=[],t.mt_account_number){o.accountId=t.mt_account_number;let l=t.mt_account_display_name||this.getAccountDisplayName(t.mt_account_number)||`Account-${t.mt_account_number}`;o.account=[l],o.accountIds=[l]}else console.warn(`Trade ${t.id} missing mt_account_number - using fallback account name in frontmatter`),o.accountIds=["Unknown Account"],o.account=["Unknown Account"];o.setup=[],o.mistake=[],o.images=[],o.tags=[],o.lotSize=1e5,o.pipValue=1;let a=`---
`;for(let[l,c]of Object.entries(o))if(c!=null)if(Array.isArray(c))if(c.length===0)a+=`${l}: []
`;else if(l==="entries"||l==="exits"){a+=`${l}:
`;for(let d of c)a+=`  - time: ${d.time}
`,a+=`    price: ${d.price}
`,a+=`    size: ${d.size}
`}else l==="images"?a+=`${l}: [${c.map(d=>`"${d}"`).join(", ")}]
`:a+=`${l}: [${c.map(d=>`${d}`).join(", ")}]
`;else a+=`${l}: ${c}
`;a+=`---

`;let s=`# ${t.symbol} - ${t.direction.toUpperCase()}

`;return s+=`Entry: ${t.entry_price} at ${r.toLocaleString()}
`,n?(s+=`Exit: ${t.exit_price} at ${n.toLocaleString()}
`,t.profit_loss!==void 0&&t.profit_loss!==null&&(t.profit_loss>0?s+=`\u2705 Profit: $${t.profit_loss.toFixed(2)}
`:t.profit_loss<0&&(s+=`\u274C Loss: $${Math.abs(t.profit_loss).toFixed(2)}
`))):s+=`Status: Open
`,a+s}formatDateForFrontmatter(t){return(typeof t=="string"?new Date(t):t).toISOString().split(".")[0]}formatDateForUser(t){let r=this.plugin.settings.trade.dateFormat,n=String(t.getDate()).padStart(2,"0"),i=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getFullYear()).slice(-2);switch(r){case"DDMMYY":return`${n}${i}${o}`;case"MMDDYY":return`${i}${n}${o}`;default:return`${o}${i}${n}`}}getWeekNumber(t){let r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate())),n=r.getUTCDay()||7;r.setUTCDate(r.getUTCDate()+4-n);let i=new Date(Date.UTC(r.getUTCFullYear(),0,1));return Math.ceil(((r.getTime()-i.getTime())/864e5+1)/7)}async getFTPCredentials(t){return this.ftpManagementService.getFTPCredentials(t)}async autoCreateFTPCredentials(t){return this.ftpManagementService.autoCreateFTPCredentials(t)}async resetFTPPassword(t){return this.ftpManagementService.resetFTPPassword(t)}async fetchUserAccounts(){var o;let t=this.plugin.authManager.getAuthState(),r;t.isAuthenticated&&((o=t.cache)!=null&&o.userId)?r=String(t.cache.userId):this.settings.ftpUserId!==void 0&&this.settings.ftpUserId!==null?r=String(this.settings.ftpUserId):r=this.settings.userId||this.getUserId();let n=String(r||""),i=n&&n!=="cursive"&&n.trim()!==""?n:"cursive";return this.accountManagementService.fetchUserAccounts(i)}async updateAccountDisplayName(t,r){var o;let n=this.plugin.authManager.getAuthState(),i=n.isAuthenticated&&((o=n.cache)!=null&&o.userId)?String(n.cache.userId):this.settings.ftpUserId!==void 0&&this.settings.ftpUserId!==null?String(this.settings.ftpUserId):this.settings.userId||this.getUserId();return this.accountManagementService.updateAccountDisplayName(t,r,i)}getAccountDisplayName(t){return this.accountManagementService.getAccountDisplayName(t)}async getAccountTrades(t,r=100,n=0){let i=this.settings.ftpUsername||this.getUserId();return this.accountManagementService.getAccountTrades(t,i,r,n)}async createOrGetFTPUser(){return this.ftpManagementService.createOrGetFTPUser()}getTradeSyncMapping(){return this.tradeSyncService.getSyncMapping()}setTradeSyncMapping(t,r){this.tradeSyncService.addMapping(t,r)}async saveSyncMapping(){await this.tradeSyncService.saveSyncMapping()}async updateAccountMapping(t,r){await this.accountManagementService.createAccountMapping(t,r)}async updateAccountMappings(t){await this.accountManagementService.updateAccountMappings(t)}async relinkAccountTrades(t,r,n){let i=[],o=0;if(r===n)return{updatedCount:0,errors:[]};try{let a=this.plugin.app.vault.getMarkdownFiles().filter(s=>s.path.includes("!Journalit/")&&s.path.includes("/trades/"));for(let s of a)try{let l=await this.plugin.app.vault.read(s),c=this.tradeSyncService.parseTradeFromMarkdown(l);if(!c)continue;if((Array.isArray(c.account)?c.account:c.account?[c.account]:[]).includes(r)){let u=l;if(c.account&&c.account.length>0){let p=l.match(/account:\s*\[(.*?)\]/);if(p){let m=p[0],g=`account: [${n}]`;u=u.replace(m,g)}}if(c.accountIds&&c.accountIds.length>0){let p=l.match(/accountIds:\s*\[(.*?)\]/);if(p){let m=p[0],g=`accountIds: [${n}]`;u=u.replace(m,g)}}if(await this.plugin.app.vault.modify(s,u),await kt(this.plugin.app,s),o++,this.plugin.accountService&&c.pnl!==void 0)try{let p=typeof c.pnl=="string"?parseFloat(c.pnl):c.pnl,m=await this.plugin.accountService.getAccountByName(r);if(m){let f=m.transactions.find(y=>y.tradeId===s.path);f&&await this.plugin.accountService.deleteTransaction(m.id,f.id)}let g=await this.plugin.accountService.getAccountByName(n);g&&(g.transactions.find(y=>y.tradeId===s.path)||await this.plugin.accountService.updateBalanceFromTrade(n,s.path,p,!1))}catch(p){console.error("Error updating account balances:",p),i.push(`Failed to update account balance for ${s.path}: ${p.message}`)}}}catch(l){console.error(`Error processing file ${s.path}:`,l),i.push(`${s.path}: ${l.message}`)}if(this.plugin.accountService)try{let s=await this.plugin.accountService.getAccountByName(r);if(s){await this.plugin.accountService.recalculateAccountMetrics(s.id);let c=new CustomEvent("journalit:account-updated",{detail:{accountId:s.id,notePath:s.notePath,timestamp:Date.now()}});document.dispatchEvent(c)}let l=await this.plugin.accountService.getAccountByName(n);if(l){await this.plugin.accountService.recalculateAccountMetrics(l.id);let c=new CustomEvent("journalit:account-updated",{detail:{accountId:l.id,notePath:l.notePath,timestamp:Date.now()}});document.dispatchEvent(c)}}catch(s){console.error("Error recalculating account metrics after relinking:",s),i.push(`Failed to recalculate metrics: ${s.message}`)}}catch(a){throw console.error("Error relinking account trades:",a),a}return{updatedCount:o,errors:i}}async requestForceSync(){return this.debouncedForceSync()}async requestCheckForNewTrades(){return this.debouncedCheckForNewTrades()}async forceSyncImmediate(){return this.debouncedForceSync.cancel(),this.forceSync()}async autoCreateReviewsForSyncedTrade(t){var r,n,i,o,a,s,l;try{let c=new Date(t.entry_time);if((i=(n=(r=this.plugin)==null?void 0:r.settings)==null?void 0:n.drc)!=null&&i.autoCreateOnFirstTrade)try{if(this.plugin.drcService){let d=this.plugin.drcService.getDRCNotePath(c);await this.plugin.app.vault.adapter.exists(d)||await this.plugin.drcService.createDRC(c)}}catch(d){console.error("Failed to auto-create DRC for synced trade:",d)}if((a=(o=this.plugin)==null?void 0:o.settings.weekly)!=null&&a.autoCreateOnFirstTrade)try{if(this.plugin.weeklyReviewService){let d=this.plugin.weeklyReviewService.getWeeklyReviewPath(c);await this.plugin.app.vault.adapter.exists(d)||await this.plugin.weeklyReviewService.createWeeklyReview(c)}}catch(d){console.error("Failed to auto-create Weekly Review for synced trade:",d)}if((l=(s=this.plugin)==null?void 0:s.settings.monthly)!=null&&l.autoCreateOnFirstTrade)try{if(this.plugin.monthlyReviewService){let d=this.plugin.monthlyReviewService.getMonthlyReviewPath(c);await this.plugin.app.vault.adapter.exists(d)||await this.plugin.monthlyReviewService.createMonthlyReview(c)}}catch(d){console.error("Failed to auto-create Monthly Review for synced trade:",d)}}catch(c){console.error("Error in auto-create reviews for synced trade:",c)}}cleanup(){this.stopAutoSync(),this.fileWatcherService.clearProcessedFiles(),this.debouncedForceSync.cancel(),this.debouncedCheckForNewTrades.cancel()}};kl();var uz=require("obsidian");Ow();var JK=1,Ch=class extends uz.Component{constructor(r,n){super();this.callbacks={};this.checklist=[];this.saveTimeout=null;this.isSaving=!1;this.app=r,this.plugin=n,this.data=this.getDefaultData(),this.state=this.getDefaultState(),this.checklist=[...FE]}async initialize(){await this.loadData(),this.updateState()}getDefaultData(){return{version:1,completed:!1,currentStep:"welcome",checklist:{},skipped:!1}}getDefaultState(){return{isActive:!1,currentStep:"welcome",canSkip:!0,canGoBack:!1,canGoForward:!0}}async loadData(){var r;try{let n=await this.plugin.loadData(),i=n==null?void 0:n.localMeta;i!=null&&i.onboarding?i.onboarding.version!==1?i.onboarding.version>1&&i.onboarding.version>=JK?(console.warn(`Onboarding version downgrade detected: ${i.onboarding.version} -> ${1}`),this.data={...this.getDefaultData(),...i.onboarding,version:1}):this.data=this.migrateData(i.onboarding):this.data={...this.getDefaultData(),...i.onboarding}:this.data=this.getDefaultData(),(r=i==null?void 0:i.onboarding)!=null&&r.checklist&&this.updateChecklistFromData(i.onboarding.checklist)}catch(n){console.error("Error loading onboarding data:",n),this.data=this.getDefaultData()}}async saveData(){this.saveTimeout&&(window.clearTimeout(this.saveTimeout),this.saveTimeout=null),this.saveTimeout=window.setTimeout(async()=>{await this.performSave()},100)}async performSave(){if(this.isSaving){this.saveTimeout=window.setTimeout(()=>this.performSave(),50);return}this.isSaving=!0;try{let r=await this.plugin.loadData()||{};r.localMeta||(r.localMeta={}),r.localMeta.onboarding=this.data,await this.plugin.saveData(r)}catch(r){console.error("Error saving onboarding data:",r)}finally{this.isSaving=!1}}migrateData(r){let n=this.getDefaultData();return r.completed!==void 0&&(n.completed=r.completed),r.completedAt!==void 0&&(n.completedAt=r.completedAt),r.selectedGoal!==void 0&&(n.selectedGoal=r.selectedGoal),r.skipped!==void 0&&(n.skipped=r.skipped),r.skippedAt!==void 0&&(n.skippedAt=r.skippedAt),r.checklist!==void 0&&(n.checklist={...r.checklist}),n}updateChecklistFromData(r){this.checklist=this.checklist.map(n=>({...n,completed:r[n.id]||!1,completedAt:r[n.id]?Date.now():void 0}))}updateState(){this.state={isActive:!this.data.completed&&!this.data.skipped,currentStep:this.data.currentStep||"welcome",selectedGoal:this.data.selectedGoal,canSkip:this.canSkipCurrentStep(),canGoBack:this.canGoBackFromCurrentStep(),canGoForward:this.canGoForwardFromCurrentStep()}}canSkipCurrentStep(){let r=Et.find(n=>n.id===this.state.currentStep);return(r==null?void 0:r.isOptional)||this.state.currentStep!=="completion"}canGoBackFromCurrentStep(){return Et.findIndex(n=>n.id===this.state.currentStep)>0}canGoForwardFromCurrentStep(){return Et.findIndex(n=>n.id===this.state.currentStep)<Et.length-1}getState(){return{...this.state}}getData(){return{...this.data}}getChecklist(){return[...this.checklist]}shouldShowOnboarding(){return!this.data.completed&&!this.data.skipped}isCompleted(){return this.data.completed}async startOnboarding(){var r,n;this.data.currentStep="welcome",this.data.completed=!1,this.data.skipped=!1,this.updateState(),await this.saveData(),(n=(r=this.callbacks).onStepChange)==null||n.call(r,"welcome")}async goToStep(r){var i,o;let n=this.state.currentStep;if(!this.isValidStepTransition(this.state.currentStep,r))throw new Error(`Invalid step transition from ${this.state.currentStep} to ${r}`);this.data.currentStep=r,this.updateState(),await this.saveData(),(o=(i=this.callbacks).onStepChange)==null||o.call(i,r,n)}async nextStep(){if(!this.state.canGoForward)throw new Error("Cannot go forward from current step");let n=Et.findIndex(i=>i.id===this.state.currentStep)+1;for(;n<Et.length;){let i=Et[n];if(!i.shouldShow||i.shouldShow(this.data.selectedGoal))break;n++}n<Et.length&&await this.goToStep(Et[n].id)}async previousStep(){if(!this.state.canGoBack)throw new Error("Cannot go back from current step");let n=Et.findIndex(i=>i.id===this.state.currentStep)-1;for(;n>=0;){let i=Et[n];if(!i.shouldShow||i.shouldShow(this.data.selectedGoal))break;n--}n>=0&&await this.goToStep(Et[n].id)}async setGoal(r){var n,i;this.data.selectedGoal=r,this.updateState(),await this.saveData(),(i=(n=this.callbacks).onGoalSelected)==null||i.call(n,r)}async skipOnboarding(){var n,i;let r=this.state.currentStep;this.data.skipped=!0,this.data.skippedAt=Date.now(),this.state.isActive=!1,this.updateState(),await this.saveData(),(i=(n=this.callbacks).onSkipped)==null||i.call(n,r)}async completeOnboarding(){var r,n;this.data.completed=!0,this.data.completedAt=Date.now(),this.state.isActive=!1,this.updateState(),await this.saveData(),(n=(r=this.callbacks).onCompleted)==null||n.call(r,this.data)}async resetOnboarding(){this.data=this.getDefaultData(),this.state=this.getDefaultState(),this.checklist=[...FE],await this.saveData()}async completeChecklistTask(r){let n=this.checklist.find(i=>i.id===r);if(!n){console.warn(`Checklist task not found: ${r}`);return}n.completed||(n.completed=!0,n.completedAt=Date.now(),this.data.checklist[r]=!0,await this.saveData())}isValidStepTransition(r,n){let i=Et.findIndex(a=>a.id===r),o=Et.findIndex(a=>a.id===n);return o<=i?!0:o===i+1}setCallbacks(r){this.callbacks={...this.callbacks,...r}}clearCallbacks(){this.callbacks={}}onunload(){this.clearCallbacks(),this.saveTimeout&&(window.clearTimeout(this.saveTimeout),this.saveTimeout=null),this.isSaving&&this.performSave().catch(r=>{console.error("Error during final save in onunload:",r)})}};Ow();var mz=require("obsidian");var pz={maxQueueSize:100,batchSize:10,flushInterval:15e3,retryAttempts:3};var Md=require("crypto");kl();var XK="https://stg-api.journalit.co",QK=!1;function jE(e,t){if(QK){let r=new URL(`${XK}${e}`);return t&&Object.entries(t).forEach(([n,i])=>{i!=null&&r.searchParams.append(n,String(i))}),r.toString()}return Te.buildUrl(e,t)}var Eh=class extends mz.Component{constructor(r,n,i){super();this.eventQueue=[];this.flushTimer=null;this.isInitialized=!1;this.app=r,this.plugin=n,this.options={...pz,...i},this.data={installId:"",enabled:!1}}async initialize(){if(this.isInitialized)return;await this.loadTelemetryData();let r=!1;this.data.installId?this.isValidUUID(this.data.installId)||(this.data.installId=this.convertToUUID(this.data.installId),r=!0):(this.data.installId=await this.generateInstallId(),r=!0),r&&await this.saveTelemetryData(),this.data.persistedQueue&&this.data.persistedQueue.length>0&&(this.eventQueue=[...this.data.persistedQueue],console.debug("TelemetryService: Loaded persisted events:",this.eventQueue.length),this.data.persistedQueue=[],await this.saveTelemetryData(),this.scheduleFlush()),this.registerLifecycleEvents(),this.isInitialized=!0}registerLifecycleEvents(){this.app.workspace.onLayoutReady(()=>{this.eventQueue.length>0&&(console.debug("TelemetryService: Flushing events on layout ready"),this.flush())})}async generateInstallId(){try{let r=this.generateUUID(),n=(0,Md.createHash)("sha256");n.update(r+this.app.vault.getName());let i=n.digest("hex");return[i.substring(0,8),i.substring(8,12),i.substring(12,16),i.substring(16,20),i.substring(20,32)].join("-")}catch(r){return console.error("Error generating installId:",r),this.generateFallbackId()}}generateUUID(){try{let r=(0,Md.randomBytes)(16);r[6]=r[6]&15|64,r[8]=r[8]&63|128;let n=r.toString("hex");return[n.substring(0,8),n.substring(8,12),n.substring(12,16),n.substring(16,20),n.substring(20,32)].join("-")}catch(r){return this.generateFallbackId()}}generateFallbackId(){let r=Date.now().toString(36),n=Math.random().toString(36).substring(2),i=(0,Md.createHash)("sha256").update(r+n).digest("hex");return[i.substring(0,8),i.substring(8,12),i.substring(12,16),i.substring(16,20),i.substring(20,32)].join("-")}isValidUUID(r){return/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(r)}convertToUUID(r){let n=(0,Md.createHash)("sha256").update(r).digest("hex");return[n.substring(0,8),n.substring(8,12),n.substring(12,16),n.substring(16,20),n.substring(20,32)].join("-")}async loadTelemetryData(){try{let r=await this.plugin.loadData(),n=r==null?void 0:r.localMeta;n!=null&&n.telemetry&&(this.data={...this.data,...n.telemetry})}catch(r){console.error("Error loading telemetry data:",r)}}async saveTelemetryData(){try{let r=await this.plugin.loadData()||{};r.localMeta||(r.localMeta={}),r.localMeta.telemetry=this.data,await this.plugin.saveData(r)}catch(r){console.error("Error saving telemetry data:",r)}}async persistQueue(){if(this.eventQueue.length!==0)try{this.data.persistedQueue=[...this.eventQueue],await this.saveTelemetryData(),console.debug("TelemetryService: Persisted queue with",this.eventQueue.length,"events")}catch(r){console.error("Error persisting telemetry queue:",r)}}async track(r,n={}){if(this.isInitialized||await this.initialize(),!this.data.enabled)return;let i={installId:this.data.installId,timestamp:Date.now(),pluginVersion:this.plugin.manifest.version,event:r,properties:this.sanitizeProperties(n)};this.eventQueue.push(i),this.eventQueue.length>this.options.maxQueueSize&&(this.eventQueue=this.eventQueue.slice(-this.options.maxQueueSize)),this.scheduleFlush()}async trackBusinessMetric(r,n={}){this.isInitialized||await this.initialize();let i={installId:this.data.installId,timestamp:Date.now(),pluginVersion:this.plugin.manifest.version,event:r,properties:this.sanitizeProperties(n),isBusinessMetric:!0};this.eventQueue.push(i),this.eventQueue.length>this.options.maxQueueSize&&(this.eventQueue=this.eventQueue.slice(-this.options.maxQueueSize)),this.scheduleFlush()}sanitizeProperties(r){let n={};for(let[i,o]of Object.entries(r))this.isPotentialPII(i,o)||(n[i]=o);return n}isPotentialPII(r,n){let i=["email","username","name","path","file","content","note"],o=r.toLowerCase();return!!(i.some(a=>o.includes(a))||typeof n=="string"&&n.includes("@"))}scheduleFlush(){this.flushTimer||(this.flushTimer=window.setTimeout(()=>{this.flush()},this.options.flushInterval),this.persistQueue().catch(r=>{console.error("Error during scheduled queue persistence:",r)}))}async flush(){var l;if(this.flushTimer=null,this.eventQueue.length===0)return;let r=[...this.eventQueue],n=this.plugin.authManager,i=n==null?void 0:n.isAuthenticated(),o=(l=n==null?void 0:n.getAuthState())==null?void 0:l.cache,a=i&&(o!=null&&o.userId)?o.userId:null,s=this.generateSessionId();try{let c=r.filter(m=>m.isBusinessMetric),d=r.filter(m=>!m.isBusinessMetric);if(!this.data.enabled){if(console.debug("TelemetryService: Telemetry disabled, discarding regular events but keeping business metrics"),c.length===0){this.eventQueue=[];return}r.splice(0,r.length,...c),this.eventQueue=this.eventQueue.filter(m=>m.isBusinessMetric)}if(a){let m=await this.getTelemetryPreferences(a);if(m&&!m.telemetry_enabled){console.debug("TelemetryService: Backend telemetry disabled for user, discarding regular events but keeping business metrics");let g=r.filter(f=>f.isBusinessMetric);if(g.length===0){this.eventQueue=[];return}r.splice(0,r.length,...g),this.eventQueue=this.eventQueue.filter(f=>f.isBusinessMetric)}}let u=r.map(m=>({event_type:m.event,event_data:m.properties,client_timestamp:new Date(m.timestamp).toISOString(),session_id:s,plugin_version:m.pluginVersion,anonymous_id:m.installId})),p=await Te.makeRequest(jE("/api/v1/telemetry/events"),{method:"POST",headers:{"Content-Type":"application/json",...(n==null?void 0:n.getAuthToken())&&{Authorization:`Bearer ${n.getAuthToken()}`}},body:JSON.stringify({events:u})},"Telemetry event submission",5);p&&p.success?(console.debug("TelemetryService: Successfully sent events:",p.events_processed),this.eventQueue=this.eventQueue.slice(r.length)):console.warn("TelemetryService: Failed to send events, keeping in queue for retry")}catch(c){console.error("TelemetryService: Error sending events:",c)}this.eventQueue.length<r.length&&this.data.persistedQueue&&this.data.persistedQueue.length>0&&(this.data.persistedQueue=[],await this.saveTelemetryData().catch(c=>{console.error("Error clearing persisted queue after flush:",c)}))}async enableTelemetry(){this.data.enabled=!0,this.data.optInDate=Date.now(),delete this.data.optOutDate,await this.saveTelemetryData(),await this.updateTelemetryPreferences(!0)}async disableTelemetry(){this.data.enabled=!1,this.data.optOutDate=Date.now(),delete this.data.optInDate,this.eventQueue=this.eventQueue.filter(r=>r.isBusinessMetric),await this.saveTelemetryData(),await this.updateTelemetryPreferences(!1)}isEnabled(){return this.data.enabled}getInstallId(){return this.data.installId}getQueueSize(){return this.eventQueue.length}generateSessionId(){let r=(0,Md.createHash)("sha256").update(Date.now()+Math.random().toString()).digest("hex");return[r.substring(0,8),r.substring(8,12),r.substring(12,16),r.substring(16,20),r.substring(20,32)].join("-")}async getTelemetryPreferences(r){try{let n=this.plugin.authManager;return await Te.makeRequest(jE("/api/v1/telemetry/preferences"),{method:"GET",headers:{"Content-Type":"application/json",...(n==null?void 0:n.getAuthToken())&&{Authorization:`Bearer ${n.getAuthToken()}`}}},"Get telemetry preferences",3)}catch(n){return console.warn("TelemetryService: Could not fetch telemetry preferences:",n),null}}async updateTelemetryPreferences(r,n){try{let i=this.plugin.authManager;if(!(i!=null&&i.isAuthenticated())){console.warn("TelemetryService: Cannot update preferences - not authenticated");return}await Te.makeRequest(jE("/api/v1/telemetry/preferences"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i.getAuthToken()}`},body:JSON.stringify({telemetry_enabled:r,telemetry_settings:n?JSON.stringify(n):null})},"Update telemetry preferences",4)&&console.debug("TelemetryService: Updated backend telemetry preferences")}catch(i){console.error("TelemetryService: Failed to update telemetry preferences:",i)}}async clearAllData(){this.data={installId:"",enabled:!1},this.eventQueue=[],this.data.installId=await this.generateInstallId(),await this.saveTelemetryData()}onunload(){this.flushTimer&&(clearTimeout(this.flushTimer),this.flushTimer=null),this.eventQueue.length>0&&(console.debug("TelemetryService: Persisting",this.eventQueue.length,"events on unload"),this.persistQueue().catch(r=>{console.error("Error persisting queue on unload:",r)})),this.eventQueue=[]}};var Hp=require("obsidian");Sd();oi();Yt();var Iw=class extends Ao{constructor(r,n,i={}){super(r,{folder:"Journalit",extension:".md",namespace:"missed-trade",enableIndexing:!0,...i});this.recentlyCreatedFiles=new Set;this.journalitFolder="!Journalit";this.tradesFolder="trades";this.plugin=n}async createMissedTrade(r,n){var i,o;try{if(!r.entryTime)throw new Error("Entry time is required");if(!r.direction)throw new Error("Direction is required");if(!r.instrument)throw new Error("Instrument is required");r.entryPrice===void 0&&(r.entryPrice=0),r.exitPrice===void 0&&(r.exitPrice=0),r.positionSize===void 0&&(r.positionSize=0),r.exitTime||(r.exitTime=r.entryTime);let a=this.getTargetFolderPath(r.entryTime);try{await this.app.vault.adapter.mkdir(a)}catch(p){}let s=await this.getMissedTradeFilePath(r);if(await this.app.vault.adapter.exists(s))throw console.error(`Cannot create missed trade - File already exists at path: ${s}`),new Error(`File already exists: ${s}`);let c=this.generateMissedTradeContent(r);this.recentlyCreatedFiles.add(s),setTimeout(()=>{var p;(p=this.recentlyCreatedFiles)==null||p.delete(s)},1e4);let d=await this.app.vault.create(s,c);this.app.metadataCache.trigger("resolve",d);let u=new CustomEvent("journalit:missed-trade-data-changed",{detail:{action:"created",filePath:s,timestamp:Date.now()}});if(document.dispatchEvent(u),this.clearCache(),(i=this.plugin)!=null&&i.settings.trade.autoOpenCreatedTrades&&!(n!=null&&n.suppressAutoOpen)){let p=null;(o=this.plugin)!=null&&o.processorManager&&(p=await this.plugin.processorManager.getMissedTradeNoteProcessor());try{await this.plugin.openFile(s,!0),setTimeout(()=>{p==null||p.renderActiveComponent()},50)}catch(m){console.warn("Failed to auto-open created missed trade:",m)}}return console.log(`Missed trade created successfully: ${s}`),s}catch(a){throw console.error("Error creating missed trade:",a),a}}async updateMissedTrade(r,n){var i,o,a,s,l,c,d,u;try{if(!r.entryTime)throw new Error("Entry time is required");if(!r.direction)throw new Error("Direction is required");if(!r.instrument)throw new Error("Instrument is required");if(!await this.app.vault.adapter.exists(n))throw new Error(`Missed trade file does not exist: ${n}`);let m=this.app.vault.getAbstractFileByPath(n);if(!m||!(m instanceof Hp.TFile))throw new Error(`Invalid file path: ${n}`);r.entryPrice===void 0&&(r.entryPrice=0),r.exitPrice===void 0&&(r.exitPrice=0),r.positionSize===void 0&&(r.positionSize=0),r.exitTime||(r.exitTime=r.entryTime);let g=r.pnl;r.useDirectPnLInput&&r.directPnL!==void 0&&(g=r.directPnL);let f={type:"missed-trade",isMissedTrade:!0,entryTime:this.formatDateForFrontmatter(r.entryTime),exitTime:this.formatDateForFrontmatter(r.exitTime||r.entryTime),entryPrice:r.entryPrice,exitPrice:r.exitPrice,positionSize:r.positionSize,direction:r.direction,instrument:r.instrument};g!==void 0&&(f.pnl=g),r.assetType&&(f.assetType=r.assetType),r.thesis!==void 0&&(f.thesis=JSON.stringify(r.thesis||"")),r.missedReason!==void 0&&(f.missedReason=JSON.stringify(r.missedReason||"")),r.commission!==void 0&&(f.commission=r.commission),r.fees!==void 0&&(f.fees=r.fees),(i=r.setupIds)!=null&&i.length&&(f.setupIds=r.setupIds),(o=r.mistakeIds)!=null&&o.length&&(f.mistakeIds=r.mistakeIds),(a=r.accountIds)!=null&&a.length&&(f.accountIds=r.accountIds),(s=r.account)!=null&&s.length&&(f.account=r.account),(l=r.setup)!=null&&l.length&&(f.setup=r.setup),(c=r.mistake)!=null&&c.length&&(f.mistake=r.mistake),(d=r.ctags)!=null&&d.length&&(f.ctags=r.ctags),(u=r.images)!=null&&u.length&&(f.images=r.images),r.useDirectPnLInput!==void 0&&(f.useDirectPnLInput=r.useDirectPnLInput),r.directPnL!==void 0&&(f.directPnL=r.directPnL),r.reviewed!==void 0&&(f.reviewed=r.reviewed),r.reviewedAt&&(f.reviewedAt=r.reviewedAt);let y=this.generateAutomaticTags(r);y.length>0&&(f.tags=y),await this.updateFrontmatter(m,f);let h=new CustomEvent("journalit:missed-trade-data-changed",{detail:{action:"updated",filePath:n,timestamp:Date.now()}});return document.dispatchEvent(h),this.clearCache(),console.log(`Missed trade updated successfully: ${n}`),n}catch(p){throw console.error("Error updating missed trade:",p),p}}async updateMissedTradeReviewStatus(r,n,i){try{let o=this.app.vault.getAbstractFileByPath(r);if(!o||!(o instanceof Hp.TFile))throw new Error(`Invalid file path: ${r}`);let a={reviewed:n,reviewedAt:i||new Date().toISOString()};await this.updateFrontmatter(o,a);let s=new CustomEvent("journalit:missed-trade-data-changed",{detail:{action:"reviewed",filePath:r,timestamp:Date.now()}});document.dispatchEvent(s),console.log(`Missed trade review status updated: ${r}`)}catch(o){throw console.error("Error updating missed trade review status:",o),o}}async getMissedTradeFilePath(r){var g;let n=st(r.entryTime,this.plugin),i=n.getFullYear(),o=String(n.getMonth()+1).padStart(2,"0"),a=String(n.getDate()).padStart(2,"0"),s=this.getWeekOfMonth(n),l=r.instrument?this.sanitizeTickerForFilename(r.instrument):"UNKNOWN",c=((g=this.plugin)==null?void 0:g.settings.trade.dateFormat)||"DDMMYY",d="";c==="DDMMYY"?d=`${a}${o}${String(i).slice(2)}`:c==="MMDDYY"?d=`${o}${a}${String(i).slice(2)}`:c==="YYMMDD"?d=`${String(i).slice(2)}${o}${a}`:d=`${a}${o}${String(i).slice(2)}`;let u=await this.getMissedTradeNumberForDay(l,n),p=`${l}-${d}-M${u}.md`;return(0,Hp.normalizePath)(`${this.journalitFolder}/${i}/${o}/${s}/${this.tradesFolder}/${p}`)}async getMissedTradeNumberForDay(r,n){var u;let i=this.getTargetFolderPath(n),o=await this.listFilesInFolder(i),a=((u=this.plugin)==null?void 0:u.settings.trade.dateFormat)||"DDMMYY",s=this.formatDateForFilename(n,a),l=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),c=new RegExp(`^${l}-${s}-M(\\d+)\\.md$`),d=0;for(let p of o){let m=p.split("/").pop()||"",g=c.exec(m);if(g){let f=parseInt(g[1],10);d=Math.max(d,f)}}return d+1}getAllMissedTradeFiles(){return this.app.vault.getMarkdownFiles().filter(n=>!(!n.path.includes("Journalit")||!n.path.includes("/trades/")||!n.path.match(/-M\d+\.md$/)))}async getMissedTrades(r,n){await new Promise(l=>setTimeout(l,50)),this.invalidateCache();let i=st(r,this.plugin),o=st(n,this.plugin);return o.setHours(23,59,59,999),this.getAllMissedTradeFiles().filter(l=>{if(!l.path.includes("/trades/")||!l.path.includes("Journalit")||!l.path.match(/-M\d+\.md$/))return!1;let c=this.app.metadataCache.getFileCache(l),d=c==null?void 0:c.frontmatter;if(!d||d.type!=="missed-trade")return!1;let u=d.entryTime?new Date(d.entryTime):null;if(!u)return!1;let p=st(u,this.plugin);return p>=i&&p<=o})}generateAutomaticTags(r){let n=[];if(n.push(["missed-trade"]),r.instrument&&n.push([r.instrument.trim()]),r.assetType&&n.push([Op(r.assetType)]),r.direction&&n.push([Mp(r.direction)]),r.setup&&Array.isArray(r.setup)&&r.setup.length>0){let i=Ap(r.setup);i.length>0&&n.push(i)}if(r.mistake&&Array.isArray(r.mistake)&&r.mistake.length>0){let i=Np(r.mistake);i.length>0&&n.push(i)}if(r.account&&Array.isArray(r.account)&&r.account.length>0){let i=r.account.filter(o=>o==null?void 0:o.trim()).map(o=>`account/${No(o.trim())}`);i.length>0&&n.push(i)}if(r.entryTime&&r.entryTime instanceof Date){let i=ua(r.entryTime);i.length>0&&n.push(i)}return pa(...n)}generateMissedTradeContent(r){var s,l,c,d,u,p,m,g;let n=this.generateAutomaticTags(r),i=["---","type: missed-trade","isMissedTrade: true",`entryTime: ${this.formatDateForFrontmatter(r.entryTime)}`,`exitTime: ${this.formatDateForFrontmatter(r.exitTime||r.entryTime)}`,`entryPrice: ${r.entryPrice||0}`,`exitPrice: ${r.exitPrice||0}`,`positionSize: ${r.positionSize||0}`,`direction: ${r.direction}`,`instrument: ${r.instrument}`,r.pnl!==void 0?`pnl: ${r.pnl}`:null,r.useDirectPnLInput!==void 0?`useDirectPnLInput: ${r.useDirectPnLInput}`:null,r.directPnL!==void 0?`directPnL: ${r.directPnL}`:null,r.commission!==void 0?`commission: ${r.commission}`:null,r.fees!==void 0?`fees: ${r.fees}`:null,r.assetType?`assetType: ${r.assetType}`:null,r.thesis!==void 0?`thesis: ${JSON.stringify(r.thesis||"")}`:null,r.missedReason!==void 0?`missedReason: ${JSON.stringify(r.missedReason||"")}`:null,(s=r.setupIds)!=null&&s.length?`setupIds: [${r.setupIds.map(f=>`"${f}"`).join(", ")}]`:null,(l=r.mistakeIds)!=null&&l.length?`mistakeIds: [${r.mistakeIds.map(f=>`"${f}"`).join(", ")}]`:null,(c=r.accountIds)!=null&&c.length?`accountIds: [${r.accountIds.map(f=>`"${f}"`).join(", ")}]`:null,(d=r.setup)!=null&&d.length?`setup: [${r.setup.map(f=>`"${f}"`).join(", ")}]`:null,(u=r.mistake)!=null&&u.length?`mistake: [${r.mistake.map(f=>`"${f}"`).join(", ")}]`:null,(p=r.account)!=null&&p.length?`account: [${r.account.map(f=>`"${f}"`).join(", ")}]`:null,(m=r.ctags)!=null&&m.length?`ctags: [${r.ctags.map(f=>`"${f}"`).join(", ")}]`:null,(g=r.images)!=null&&g.length?`images: [${r.images.map(f=>`"${f.trim()}"`).join(", ")}]`:null,n.length>0?`tags: [${n.map(f=>`"${f}"`).join(", ")}]`:null],o=new Set(["type","isMissedTrade","entryTime","exitTime","entryPrice","exitPrice","positionSize","direction","instrument","pnl","useDirectPnLInput","directPnL","commission","fees","assetType","thesis","missedReason","setupIds","mistakeIds","accountIds","setup","mistake","account","ctags","images","tags","notes"]);return Object.keys(r).forEach(f=>{if(!o.has(f)&&r[f]!==void 0&&r[f]!==null){let y=r[f];Array.isArray(y)?i.push(`${f}: [${y.map(h=>JSON.stringify(h)).join(", ")}]`):typeof y=="string"?i.push(`${f}: ${JSON.stringify(y)}`):i.push(`${f}: ${y}`)}}),i.push("---"),[...i,"","# Missed Trade Notes","",r.notes||"Add any additional notes about this missed trade here."].filter(f=>f!==null).join(`
`)}getTargetFolderPath(r){let n=r.getFullYear(),i=String(r.getMonth()+1).padStart(2,"0"),o=this.getWeekOfMonth(r);return(0,Hp.normalizePath)(`${this.journalitFolder}/${n}/${i}/${o}/${this.tradesFolder}`)}getWeekOfMonth(r){return Ga(r)}formatDateForFilename(r,n){let i=r.getFullYear(),o=String(r.getMonth()+1).padStart(2,"0"),a=String(r.getDate()).padStart(2,"0");switch(n){case"DDMMYY":return`${a}${o}${String(i).slice(2)}`;case"MMDDYY":return`${o}${a}${String(i).slice(2)}`;case"YYMMDD":return`${String(i).slice(2)}${o}${a}`;default:return`${a}${o}${String(i).slice(2)}`}}sanitizeTickerForFilename(r){return r.replace(/[<>:"/\\|?*]/g,"_").replace(/\s+/g,"_").toUpperCase()}async listFilesInFolder(r){try{return(await this.app.vault.adapter.list(r)).files||[]}catch(n){return[]}}formatDateForFrontmatter(r){return r.toISOString()}};var Tc=class e{constructor(t,r){this._authManager=null;this._tradeService=null;this._setupService=null;this._drcService=null;this._weeklyReviewService=null;this._monthlyReviewService=null;this._optionsService=null;this._accountService=null;this._missedTradeService=null;this._accountTransactionService=null;this._backendIntegrationService=null;this._onboardingService=null;this._telemetryService=null;this.initializedServices=new Set;this.serviceInitQueue=new Map;this.app=t,this.plugin=r}static getInstance(t,r){return e.instance||(e.instance=new e(t,r)),e.instance}initializeCoreServices(){this._authManager=new Up(this.app,SE()),this.initializedServices.add("authManager"),this._tradeService=new hh(this.app,{namespace:"trade"}),this._tradeService.setPlugin(this.plugin),this.initializedServices.add("tradeService")}async initializeRemainingServices(){await oh([async()=>await this.getSetupService(),async()=>await this.getDRCService(),async()=>await this.getWeeklyReviewService(),async()=>await this.getMonthlyReviewService(),async()=>await this.getOptionsService(),async()=>await this.getAccountService(),async()=>await this.getAccountTransactionService()],50)}getAuthManager(){return this._authManager||(this._authManager=new Up(this.app,SE()),this.initializedServices.add("authManager")),this._authManager}getTradeService(){return this._tradeService||(this._tradeService=new hh(this.app,{namespace:"trade"}),this._tradeService.setPlugin(this.plugin),this.initializedServices.add("tradeService")),this._tradeService}async getSetupService(){if(this._setupService)return this._setupService;let t=this.serviceInitQueue.get("setupService");if(t)return t;let r=(async()=>{let n=this.getTradeService(),i=await Nn(()=>new Ew(this.app,n,{namespace:"setup"}),"SetupService");return this._setupService=i,this.initializedServices.add("setupService"),this.serviceInitQueue.delete("setupService"),i})();return this.serviceInitQueue.set("setupService",r),r}async getDRCService(){if(this._drcService)return this._drcService;let t=this.serviceInitQueue.get("drcService");if(t)return t;let r=(async()=>{let n=await Nn(()=>new Dw(this.app,this.plugin,{namespace:"drc"}),"DRCService");return this._drcService=n,this.initializedServices.add("drcService"),this.serviceInitQueue.delete("drcService"),n})();return this.serviceInitQueue.set("drcService",r),r}async getWeeklyReviewService(){if(this._weeklyReviewService)return this._weeklyReviewService;let t=this.serviceInitQueue.get("weeklyReviewService");if(t)return t;let r=(async()=>{let n=await Nn(()=>new Pw(this.app,this.plugin,{namespace:"weekly"}),"WeeklyReviewService");return this._weeklyReviewService=n,this.initializedServices.add("weeklyReviewService"),this.serviceInitQueue.delete("weeklyReviewService"),n})();return this.serviceInitQueue.set("weeklyReviewService",r),r}async getMissedTradeService(){if(this._missedTradeService)return this._missedTradeService;let t=this.serviceInitQueue.get("missedTradeService");if(t)return t;let r=(async()=>{let n=await Nn(()=>new Iw(this.app,this.plugin,{namespace:"missed-trade"}),"MissedTradeService");return this._missedTradeService=n,this.initializedServices.add("missedTradeService"),this.serviceInitQueue.delete("missedTradeService"),n})();return this.serviceInitQueue.set("missedTradeService",r),r}async getMonthlyReviewService(){if(this._monthlyReviewService)return this._monthlyReviewService;let t=this.serviceInitQueue.get("monthlyReviewService");if(t)return t;let r=(async()=>{let n=await Nn(()=>new Aw(this.app,this.plugin,{namespace:"monthly"}),"MonthlyReviewService");return this._monthlyReviewService=n,this.initializedServices.add("monthlyReviewService"),this.serviceInitQueue.delete("monthlyReviewService"),n})();return this.serviceInitQueue.set("monthlyReviewService",r),r}async getOptionsService(){if(this._optionsService)return this._optionsService;let t=this.serviceInitQueue.get("optionsService");if(t)return t;let r=(async()=>{let n=await Nn(()=>new En(this.plugin,{namespace:"options"}),"CustomOptionsService");return this._optionsService=n,this.initializedServices.add("optionsService"),this.serviceInitQueue.delete("optionsService"),n})();return this.serviceInitQueue.set("optionsService",r),r}isServiceInitialized(t){return this.initializedServices.has(t)}isServiceInitializing(t){return this.serviceInitQueue.has(t)}async getAccountService(){if(this._accountService)return this._accountService;let t=this.serviceInitQueue.get("accountService");if(t)return t;let r=(async()=>{let n=await Nn(()=>{let i=new Ip(this.app,{namespace:"account"});return i.setPlugin(this.plugin),i},"AccountService");return this._accountService=n,this.initializedServices.add("accountService"),this.serviceInitQueue.delete("accountService"),n})();return this.serviceInitQueue.set("accountService",r),r}async getAccountTransactionService(){if(this._accountTransactionService)return this._accountTransactionService;let t=this.serviceInitQueue.get("accountTransactionService");if(t)return t;let r=(async()=>{let n=await this.getAccountService(),i=await Nn(()=>new pw(n,{namespace:"account-transaction"}),"AccountTransactionService");return this._accountTransactionService=i,this.initializedServices.add("accountTransactionService"),this.serviceInitQueue.delete("accountTransactionService"),i})();return this.serviceInitQueue.set("accountTransactionService",r),r}async getBackendIntegrationService(){if(this._backendIntegrationService)return this._backendIntegrationService;let t=this.serviceInitQueue.get("backendIntegrationService");if(t)return t;let r=(async()=>{let n=await Nn(()=>new Sh(this.plugin),"BackendIntegrationService");return this._backendIntegrationService=n,this.initializedServices.add("backendIntegrationService"),this.serviceInitQueue.delete("backendIntegrationService"),n})();return this.serviceInitQueue.set("backendIntegrationService",r),r}async getOnboardingService(){if(this._onboardingService)return this._onboardingService;let t=this.serviceInitQueue.get("onboardingService");if(t)return t;let r=(async()=>{let n=await Nn(()=>new Ch(this.app,this.plugin),"OnboardingService");return await n.initialize(),this._onboardingService=n,this.initializedServices.add("onboardingService"),this.serviceInitQueue.delete("onboardingService"),n})();return this.serviceInitQueue.set("onboardingService",r),r}async getTelemetryService(){if(this._telemetryService)return this._telemetryService;let t=this.serviceInitQueue.get("telemetryService");if(t)return t;let r=(async()=>{let n=await Nn(()=>new Eh(this.app,this.plugin),"TelemetryService");return await n.initialize(),this._telemetryService=n,this.initializedServices.add("telemetryService"),this.serviceInitQueue.delete("telemetryService"),n})();return this.serviceInitQueue.set("telemetryService",r),r}preInitializeServices(t){t.length!==0&&ew(()=>{let r=t.map(n=>async()=>{switch(n){case"setupService":await this.getSetupService();break;case"drcService":await this.getDRCService();break;case"weeklyReviewService":await this.getWeeklyReviewService();break;case"monthlyReviewService":await this.getMonthlyReviewService();break;case"optionsService":await this.getOptionsService();break;case"accountService":await this.getAccountService();break;case"accountTransactionService":await this.getAccountTransactionService();break;case"onboardingService":await this.getOnboardingService();break;case"telemetryService":await this.getTelemetryService();break}});oh(r,100)})}cleanupServices(){try{let t=(Sd(),mT(x_)).CustomDataService;t.sharedIndexManager&&(t.sharedIndexManager.unload(),t.sharedIndexManager=null)}catch(t){console.error("Error cleaning up IndexManager:",t)}this._authManager=null,this._tradeService=null,this._setupService=null,this._drcService=null,this._weeklyReviewService=null,this._monthlyReviewService=null,this._optionsService=null,this._accountService=null,this._accountTransactionService=null,this._backendIntegrationService&&(this._backendIntegrationService.cleanup(),this._backendIntegrationService=null),this._onboardingService&&(this._onboardingService.onunload(),this._onboardingService=null),this._telemetryService&&(this._telemetryService.onunload(),this._telemetryService=null),this.initializedServices.clear(),this.serviceInitQueue.clear()}};var Fw=require("obsidian");var fz=$(W());var Re=$(W());var jt=$(W());var LE=jt.default.memo(({settings:e,data:t,onUpdate:r,filePath:n})=>{(0,jt.useEffect)(()=>{},[e,n]);let[i,o]=(0,jt.useState)(()=>{let p={};return e.sections.forEach(m=>{p[m.id]={checkboxes:{},textAreas:{}}}),t?{...t,sections:{...p,...t.sections}}:{sections:p,reviewed:!1}});(0,jt.useEffect)(()=>{o(p=>{let m={...p.sections};return e.sections.forEach(g=>{m[g.id]||(m[g.id]={checkboxes:{},textAreas:{}})}),t?{...t,sections:{...m,...t.sections}}:{...p,sections:m}})},[t,e.sections]);let a=(0,jt.useCallback)(p=>{o(p),r(p)},[r]),s=(p,m)=>{var f,y,h;let g={...i,sections:{...i.sections,[p]:{...i.sections[p],checkboxes:{...(f=i.sections[p])==null?void 0:f.checkboxes,[m]:!((h=(y=i.sections[p])==null?void 0:y.checkboxes)!=null&&h[m])}}}};a(g)},l=(p,m)=>{var f;let g={...i,sections:{...i.sections,[p]:{...i.sections[p],textAreas:{...(f=i.sections[p])==null?void 0:f.textAreas,[p]:m}}}};a(g)},c=p=>{var g,f;let m=i.sections[p.id];switch(p.type){case"header":return jt.default.createElement("div",{className:"loss-review-header",key:p.id},p.title&&jt.default.createElement("h3",{dangerouslySetInnerHTML:{__html:d(p.title)}}),p.content&&jt.default.createElement("div",{className:"loss-review-content",dangerouslySetInnerHTML:{__html:d(p.content)}}));case"checkbox":let y=p.content||p.id,h=((g=m==null?void 0:m.checkboxes)==null?void 0:g[y])||!1;return jt.default.createElement("div",{className:"loss-review-checkbox",key:p.id},jt.default.createElement("label",{className:"checkbox-label"},jt.default.createElement("input",{type:"checkbox",checked:h,onChange:()=>s(p.id,y)}),jt.default.createElement("span",{dangerouslySetInnerHTML:{__html:d(p.content||"")}})));case"checkboxList":return jt.default.createElement("div",{className:"loss-review-checkbox-list",key:p.id},p.title&&jt.default.createElement("h3",{dangerouslySetInnerHTML:{__html:d(p.title)}}),jt.default.createElement("div",{className:"checkbox-items"},(p.items||[]).map((b,w)=>{var x;let k=`${p.id}-item-${w}`,S=((x=m==null?void 0:m.checkboxes)==null?void 0:x[k])||!1;return jt.default.createElement("label",{key:k,className:"checkbox-label"},jt.default.createElement("input",{type:"checkbox",checked:S,onChange:()=>s(p.id,k)}),jt.default.createElement("span",{dangerouslySetInnerHTML:{__html:d(b)}}))})));case"textarea":let v=((f=m==null?void 0:m.textAreas)==null?void 0:f[p.id])||"";return jt.default.createElement("div",{className:"loss-review-textarea",key:p.id},p.title&&jt.default.createElement("h3",{dangerouslySetInnerHTML:{__html:d(p.title)}}),jt.default.createElement("textarea",{value:v,onChange:b=>l(p.id,b.target.value),placeholder:p.placeholder||"",rows:4,className:"loss-review-textarea-input"}));default:return null}},d=p=>{let m=p.replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>");return m=m.replace(/__([^_]+)__/g,"<strong>$1</strong>"),m=m.replace(/(^|[^*])\*([^*]+)\*(?!\*)/g,"$1<em>$2</em>"),m=m.replace(/(^|[^_])_([^_]+)_(?!_)/g,"$1<em>$2</em>"),m=m.replace(/\n/g,"<br>"),m};if(!e.enabled)return null;let u=jt.default.createElement("div",{className:"loss-review-sections"},e.sections.map(p=>{try{return jt.default.createElement("div",{className:"loss-review-section",key:p.id},c(p))}catch(m){return console.error(`Error rendering loss review section ${p.id}:`,m),null}}));return jt.default.createElement("div",{className:"loss-review-container"},jt.default.createElement(ar,{title:"Loss Review",defaultExpanded:!0},u))});LE.displayName="LossReview";oi();var _E=Re.default.memo(({data:e,onEditClick:t})=>{let[r,n]=(0,Re.useState)(e.filePath||"unknown"),[i,o]=(0,Re.useState)({reviewed:e.reviewed,reviewedAt:e.reviewedAt});(0,Re.useEffect)(()=>{o({reviewed:e.reviewed,reviewedAt:e.reviewedAt})},[e.reviewed,e.reviewedAt]);let a=(0,Re.useRef)(null),{metrics:s,formatDate:l,formatTime:c}=gh({data:e}),d=Ge(),u=d?s_({plugin:d,initialData:e.lossReview,onUpdate:v=>{d!=null&&d.tradeService&&r&&r!=="unknown"&&d.tradeService.updateLossReview(r,v,"user-input").then(()=>{}).catch(b=>console.error("[TradeNote] Error updating loss review:",b))}}):{settings:{enabled:!1,sections:[]},updateLossReview:()=>{}},{settings:p,updateLossReview:m}=u;(0,Re.useEffect)(()=>{if(vd(),a.current){a.current.classList.add("trade-note-mounted"),a.current.setAttribute("data-mounted-at",Date.now().toString());let v=a.current.closest(".journalit-trade-view");v&&v.classList.add("trade-note-mounted")}},[]);let g=(0,Re.useCallback)(v=>{if(a.current=v,v&&(!r||r==="unknown")){let b=v.getAttribute("data-displaying-file");if(b){n(b);return}let w=v.parentElement;for(;w;){let k=w.getAttribute("data-displaying-file")||w.getAttribute("data-file-path");if(k){n(k);break}w=w.parentElement}}},[r]),f=async v=>{if(!d||!d.accountService){console.error("Cannot navigate to account: Account service not available");return}try{let b=await d.accountService.getAccount(v);b||(b=await d.accountService.getAccountByName(v)),b?d.openFile?d.openFile(b.notePath,!1):d.app&&d.app.workspace.openLinkText(b.notePath,"",!1):console.error(`Could not find account: ${v}`)}catch(b){console.error("Error navigating to account:",b)}},y=(0,Re.useCallback)(()=>{t&&t(e)},[e,t]),h=(0,Re.useCallback)(()=>{if(d!=null&&d.tradeService&&r&&r!=="unknown"){let v=new Date().toISOString();o({reviewed:!0,reviewedAt:v}),d.tradeService.updateTradeReviewStatus(r,!0,v,"user-input").then(()=>{console.log("Trade marked as reviewed")}).catch(b=>{console.error("[TradeNote] Error updating review status:",b),o({reviewed:e.reviewed,reviewedAt:e.reviewedAt})})}},[d,r,e.reviewed,e.reviewedAt]);return Re.default.createElement("div",{className:"trade-note-container",ref:g,"data-file-path":r,style:{margin:0}},Re.default.createElement(fh,{instrument:e.instrument,direction:e.direction,isProfit:s.isProfit,pnl:s.pnl,percentChange:s.percentChange,useDirectPnLInput:e.useDirectPnLInput,isMissedTrade:e.isMissedTrade,exitTime:e.exitTime,tradeStatus:e.tradeStatus,exits:e.exits}),(e.entryTime||e.useDirectPnLInput)&&Re.default.createElement(ZK,{data:e,filePath:r,onEditClick:t,handleEditClick:y}),Re.default.createElement("div",{className:"trade-note-content"},Re.default.createElement(uh,{images:e.images,onEditClick:y}),Re.default.createElement(ph,{data:e,onAccountClick:f}),Re.default.createElement(mh,{data:e,metrics:s,formatDate:l,formatTime:c,onEditClick:y}),!at({tradeStatus:e.tradeStatus,exitTime:e.exitTime,pnl:e.pnl,useDirectPnLInput:e.useDirectPnLInput,exits:e.exits})&&s.pnl<0&&Re.default.createElement(LE,{settings:p,data:e.lossReview,onUpdate:m,filePath:r}),Re.default.createElement("div",{className:"trade-note-review-section"},Re.default.createElement(zs,{reviewed:i.reviewed,reviewedAt:i.reviewedAt,onMarkReviewed:h}))))},(e,t)=>e.data.pnl===t.data.pnl&&e.data.entryTime===t.data.entryTime&&e.data.exitTime===t.data.exitTime&&e.data.instrument===t.data.instrument&&e.data.direction===t.data.direction&&e.data.commission===t.data.commission&&e.data.swap===t.data.swap&&e.data.fees===t.data.fees&&JSON.stringify(e.data.images)===JSON.stringify(t.data.images)&&JSON.stringify(e.data.lossReview)===JSON.stringify(t.data.lossReview)&&e.onEditClick===t.onEditClick),ZK=Re.default.memo(({data:e,filePath:t,onEditClick:r,handleEditClick:n})=>{let i=Ge(),[o,a]=(0,Re.useState)([]),[s,l]=(0,Re.useState)([]),[c,d]=(0,Re.useState)(!1),[u,p]=(0,Re.useState)(!1),[m,g]=(0,Re.useState)(0),f=Re.default.useMemo(()=>{if(e.entryTime)return new Date(e.entryTime);if(e.useDirectPnLInput){let T=t.match(/(\d{2})(\d{2})(\d{2})-T\d+\.md$/);if(T){let[,E,C,N]=T,D=2e3+parseInt(N,10);return new Date(D,parseInt(C,10)-1,parseInt(E,10))}return new Date}return null},[e.entryTime,e.useDirectPnLInput,t]),y=Re.default.useMemo(()=>{if(!f||!i)return null;let{start:T,end:E}=gw(f,i);return{startDate:T,endDate:E}},[f,i]),h=Re.default.useMemo(()=>!f||!i?"":xl(f,i),[f,i]),v=Re.default.useRef(null);(0,Re.useEffect)(()=>{let T=v.current;if(!T)return;let E=new IntersectionObserver(C=>{let[N]=C;N.isIntersecting&&(p(!0),E.disconnect())},{rootMargin:"50px",threshold:.1});return E.observe(T),()=>E.disconnect()},[]),(0,Re.useEffect)(()=>{let T=E=>{let{action:C,timestamp:N}=E.detail;(C==="created"||C==="updated")&&h&&setTimeout(()=>{Object.keys(sessionStorage).forEach(D=>{D.startsWith("trade-nav-")&&sessionStorage.removeItem(D)}),a([]),l([]),d(!1),g(D=>D+1)},200)};return document.addEventListener("journalit:trade-data-changed",T),document.addEventListener("journalit:missed-trade-data-changed",T),()=>{document.removeEventListener("journalit:trade-data-changed",T),document.removeEventListener("journalit:missed-trade-data-changed",T)}},[h]),(0,Re.useEffect)(()=>{if(!u||!y||!(i!=null&&i.tradeService)||!h)return;let T=!0;return(async()=>{try{let C=sessionStorage.getItem(`trade-nav-${h}`);if(C){let N=JSON.parse(C);if(T){let D=[],A=[];Array.isArray(N)?D=N:N&&typeof N=="object"&&(D=N.trades||[],A=N.missedTrades||[]);let P=D.map(L=>i.app.vault.getAbstractFileByPath(L)).filter(Boolean),I=A.map(L=>i.app.vault.getAbstractFileByPath(L)).filter(Boolean),M=[...D,...A],O=M.includes(t);if(i.app.vault.getAbstractFileByPath(t)&&!O||P.length===0&&I.length===0&&M.length>0)sessionStorage.removeItem(`trade-nav-${h}`);else{a(P),l(I);return}}}if(c)return;d(!0),setTimeout(async()=>{var N,D,A;try{let[P,I]=await Promise.all([i.tradeService.getTrades(y.startDate,y.endDate),((A=(D=(N=i.missedTradeService)==null?void 0:N.getMissedTrades)==null?void 0:D.call(N,y.startDate,y.endDate))==null?void 0:A.catch(M=>(console.warn("[TradeNote] Failed to fetch missed trades:",M),[])))||Promise.resolve([])]);if(T){a(P),l(I);try{let M=P.map(F=>F.path),O=I.map(F=>F.path);sessionStorage.setItem(`trade-nav-${h}`,JSON.stringify({trades:M,missedTrades:O}))}catch(M){console.warn("Error caching trades:",M)}}}catch(P){console.error("Error fetching trades for day:",P)}finally{T&&d(!1)}},100)}catch(C){console.error("Error in trade fetch setup:",C),T&&d(!1)}})(),()=>{T=!1}},[u,y,i==null?void 0:i.tradeService,h,i,m]);let b=(0,Re.useCallback)((T,E=!1)=>{try{i&&i.openFile?i.openFile(T,E):i!=null&&i.app?i.app.workspace.openLinkText(T,"",E):console.error("Cannot navigate: Plugin and App context not available.")}catch(C){console.error("Navigation error:",C)}},[i]),w=(0,Re.useCallback)(T=>i!=null&&i.drcService?i.drcService.getDRCNotePath(T):"",[i==null?void 0:i.drcService]),k=(0,Re.useCallback)(T=>i!=null&&i.weeklyReviewService?i.weeklyReviewService.getWeeklyReviewPath(T):"",[i==null?void 0:i.weeklyReviewService]),S=(0,Re.useCallback)(T=>i!=null&&i.drcService?i.drcService.getMonthlyReviewPath(T):null,[i==null?void 0:i.drcService]),x=(0,Re.useCallback)(()=>null,[]);return!f||!(i!=null&&i.drcService)||!(i!=null&&i.weeklyReviewService)?null:Re.default.createElement("div",{ref:v},u?Re.default.createElement(Re.default.Fragment,null,Re.default.createElement(bw,{currentDate:f,trades:o,missedTrades:s,currentTradePath:t,navigateTo:b,getDRCPath:w,getWeeklyReviewPath:k,getMonthlyReviewPath:S,getYearlyReviewPath:x,onEditClick:r,handleEditClick:n})):Re.default.createElement("div",{style:{height:"60px",display:"flex",alignItems:"center",justifyContent:"center"}},Re.default.createElement("div",{style:{color:"var(--text-muted)",fontSize:"12px"}},"Loading navigation...")))});var Dh=class extends Qi{constructor(t){super(t)}renderComponent(t,r,n,i,o){t.querySelector(".trade-note-container.trade-note-mounted")||this.renderTradeNote(t,r,n,i,o)}renderTradeNote(t,r,n,i,o){try{if(vd(),!t||!t.isConnected){console.error(`[TradeNote] Cannot render into disconnected container for ${n}`);return}let a=o?`${n}-${i}-${o}`:`${n}-${i}`,s=i.startsWith("leaf-")?i.substring(5):i,l=this.processTradeData(r);t.setAttribute("data-displaying-file",n);let c=this.findContainingLeaf(t),d=t.querySelector(".journalit-trade-note-wrapper");if(d){if(d.querySelector(".trade-note-mounted"))return;d.remove()}let u=null;if(c&&c.view){let f=c.view.containerEl,y=c.containerEl;f&&f.id?u=f.id:y&&y.id&&(u=y.id)}let p=this.reactRoots.get(a);if(p&&p.domContainer&&p.domContainer.isConnected&&p.domContainer.querySelector(".trade-note-mounted"))return;t.empty();let m=this.reactRoots.get(a);if(m&&(c&&u&&m.leafId!==u||o&&m.domContainer&&m.domContainer.getAttribute("data-context-id")!==o)){let f=o?`${n}-context-${o}`:`${n}-${i}-${u}`;if(m=this.reactRoots.get(f),!m){this.createReactRoot(t,f,u||void 0,o,l,n);return}}if(!m)this.createReactRoot(t,a,u||void 0,o,l,n);else{let f=m.domContainer;t.contains(f)?m.root.render(this.createReactElement(l,n)):this.createReactRoot(t,a,u||void 0,o,l,n)}}catch(a){console.error("[TradeNote] Error rendering trade note:",a),t.setText("Error rendering trade note: "+(a instanceof Error?a.message:String(a)))}}getComponentClassName(){return"journalit-trade-view"}getWrapperClassName(){return"journalit-trade-note-wrapper"}createReactElement(t,r,n){let i=a=>{var l,c;let s=(c=(l=window.app)==null?void 0:l.plugins)==null?void 0:c.plugins.journalit;if(!s){console.error("Cannot access plugin instance for edit action");return}s.openTradeFormInEditMode?s.openTradeFormInEditMode(a,r):console.warn("Edit mode not available - plugin method missing")},o=async a=>{var l,c;let s=(c=(l=window.app)==null?void 0:l.plugins)==null?void 0:c.plugins.journalit;if(!s||!s.tradeService){console.error("Cannot access plugin instance for data update");return}try{await s.tradeService.updateTrade(a,r,"user-input")}catch(d){console.error("[TradeNote] Error updating trade data:",d)}};return fz.default.createElement(_E,{data:{...t,filePath:r},onEditClick:i,onDataUpdate:o})}unmountTradeNote(t,r,n,i){return this.unmountComponent(t,r,n)}unmountAllTradeNotes(){this.unmountAllComponents()}unmountLeafTradeNotes(t){this.unmountLeafComponents(t)}processTradeData(t){let r={...t};return t.images,t.images&&(r.images=this.normalizeImagePaths(t.images)),["setupIds","mistakeIds","accountIds","setup","mistake","account","tags","ctags"].forEach(n=>{if(r[n]&&!Array.isArray(r[n]))if(typeof r[n]=="string"&&r[n].startsWith("[")&&r[n].endsWith("]"))try{let i=r[n].slice(1,-1).trim();i?r[n]=i.split(",").map(o=>o.trim()):r[n]=[]}catch(i){console.error(`[TradeNote] Failed to parse array string: ${n}`,i),r[n]=[r[n]]}else r[n]=[r[n]]}),t.entries&&Array.isArray(t.entries)&&(r.entries=t.entries.map(n=>({time:n.time?new Date(n.time):null,price:parseFloat(n.price)||0,size:parseFloat(n.size)||0}))),t.exits&&Array.isArray(t.exits)&&(r.exits=t.exits.map(n=>({time:n.time?new Date(n.time):null,price:parseFloat(n.price)||0,size:parseFloat(n.size)||0}))),["entryTime","exitTime"].forEach(n=>{if(r[n]&&typeof r[n]=="string")try{r[n]=new Date(r[n])}catch(i){console.error(`[TradeNote] Failed to parse date: ${n}`,i)}}),["entryPrice","exitPrice","positionSize","pnl","directPnL"].forEach(n=>{if(r[n]!==void 0&&typeof r[n]!="number")try{r[n]=parseFloat(r[n])}catch(i){console.error(`[TradeNote] Failed to parse number: ${n}`,i)}}),["useDirectPnLInput"].forEach(n=>{if(r[n]!==void 0&&typeof r[n]!="boolean")try{r[n]=!!r[n]}catch(i){console.error(`[TradeNote] Failed to parse boolean: ${n}`,i)}}),r.thesis=ah(t.thesis)||"",r}normalizeImagePaths(t){if(!t)return[];if(Array.isArray(t))return t.map(r=>typeof r!="string"?String(r):r.replace(/['"`]/g,"").trim()).filter(Boolean);if(typeof t=="string"&&t.startsWith("[")&&t.endsWith("]"))try{let r=t.slice(1,-1).trim();return r?r.split(",").map(n=>n.trim().replace(/['"`]/g,"")).filter(Boolean):[]}catch(r){return console.error("[TradeNote] Failed to parse images string:",r),[t.replace(/['"`]/g,"").trim()]}return typeof t=="string"?[t.replace(/['"`]/g,"").trim()]:[]}};var Ph=class extends Zi{constructor(r,n){super(r,n,new Dh(r));this._tradeUpdateListener=null;this.setupTradeUpdateListener()}isValidComponentType(r){return r&&r.type==="trade"}getComponentClassName(){return"journalit-trade-view"}getWrapperClassName(){return"journalit-trade-note-wrapper"}getComponentTypeIdentifier(){return"trade"}async getAdditionalDataForComponent(r,n){return{}}handleFileOpen(r,n=!1){if(!r)return;this.cleanupOrphanedComponents(),this.cleanupUnrelatedComponents(r.path);let i=this.app.metadataCache.getFileCache(r),o=i==null?void 0:i.frontmatter;if(!o||!this.isValidComponentType(o))return;let a=document.body,s=new MutationObserver((l,c)=>{let d=document.querySelectorAll(".cm-editor");if(d.length===0)return;d.forEach(p=>{var E;let m=p.querySelector(".metadata-container");if(!m)return;let g=m.closest(".workspace-leaf-content");if(!g)return;let f=this.findContainingLeaf(g),y=(E=f==null?void 0:f.view)==null?void 0:E.containerEl,h=m.closest(".workspace-leaf"),b=(h==null?void 0:h.id)||(y==null?void 0:y.id)||null,w=this.getUniqueElementId(p),k=b?`leaf-${b}`:w,S=!0;if(f){let C=f.view,N=null;(C&&"file"in C||C&&"getViewType"in C&&C.getViewType()==="markdown")&&(N=C.file),N&&(S=N.path===r.path)}if(!S)return;let x=this.getComponentClassName();p.querySelectorAll(`.${x}`).forEach(C=>{let N=C.getAttribute("data-file-path");if(N&&N!==r.path){let D=C.getAttribute("data-view-id"),A=C.getAttribute("data-leaf-id");D&&this.renderer.unmountComponent(N,D,A||void 0),C.remove()}});let T=Array.from(p.querySelectorAll(`.${x}`)).find(C=>C.getAttribute("data-file-path")===r.path);T||(T=document.createElement("div"),T.className=x,T.style.marginTop="0px",T.style.marginBottom="0px",T.style.padding="0px",T.setAttribute("data-file-path",r.path),T.setAttribute("data-view-id",k),T.setAttribute("data-editor-id",w),b&&T.setAttribute("data-leaf-id",b),T.setAttribute("data-inserted-at",Date.now().toString()),m.after(T)),this.renderer.renderComponent(T,o,r.path,k,w),this.markFileRenderedInMode(r.path,"source")}),c.disconnect();let u=this.activeObservers.indexOf(c);u>-1&&this.activeObservers.splice(u,1)});this.activeObservers.push(s),s.observe(a,{childList:!0,subtree:!0}),setTimeout(()=>{s.disconnect();let l=this.activeObservers.indexOf(s);l>-1&&this.activeObservers.splice(l,1)},3e3)}renderAllActiveTradeNotes(){let r=new Set;this.app.workspace.iterateAllLeaves(n=>{try{if(!n.view||!("file"in n.view))return;let i=n.view.file;if(!i||r.has(i.path))return;let o=this.app.metadataCache.getFileCache(i),a=o==null?void 0:o.frontmatter;if(!a||!this.isValidComponentType(a))return;r.add(i.path),setTimeout(()=>{this.handleFileOpen(i,!0)},300)}catch(i){console.error("[TradeNote] Error rendering active trade note at startup:",i)}})}renderActiveComponent(){this.renderActiveTradeNote()}setupTradeUpdateListener(){let r=async n=>{try{if(!n.detail||!n.detail.filePath)return;let i=n.detail.filePath,o=this.app.vault.getAbstractFileByPath(i);if(!(o instanceof Fw.TFile)){console.warn(`[TradeNote] Cannot find file for path: ${i}`);return}await this.refreshTradeNote(o)}catch(i){console.error("[TradeNote] Error handling trade update event:",i)}};document.addEventListener("journalit:trade-data-changed",r),this._tradeUpdateListener=r}async refreshTradeNote(r){try{let n=await this.app.vault.read(r),i={},o=n.match(/^---\n([\s\S]*?)\n---/m);if(o&&o[1]){let l=o[1].split(`
`),c=null,d=0,u=!1,p=!1,m={};for(let g=0;g<l.length;g++){let f=l[g],y=f.trim();if(!y)continue;let h=f.search(/\S/);if(y.startsWith("- ")){if(c&&p){let w=y.substring(2).trim().match(/^([^:]+):\s*(.*)$/);if(w){let x=w[1].trim(),T=w[2].trim();T==="true"?T=!0:T==="false"?T=!1:/^-?\d+(\.\d+)?$/.test(T)&&(T=parseFloat(T)),m[x]=T}let k=g+1<l.length?l[g+1]:"",S=k.search(/\S/);if(k.trim()&&!k.trim().startsWith("- ")&&S>d)continue;i[c]||(i[c]=[]),i[c].push({...m}),m={}}else c&&(i[c]||(i[c]=[]),i[c].push(y.substring(2).trim()));u=!0;continue}let v=f.match(/^([^:]+):\s*(.*)$/);if(v&&v[1]&&v[2]!==void 0){let b=v[1].trim(),w=v[2].trim();if(w===""){c=b,d=h,u=!1;let k=g+1<l.length?l[g+1]:"";k.trim().startsWith("- ")&&(p=(g+2<l.length?l[g+2]:"").search(/\S/)>k.search(/\S/));continue}if(c=null,u=!1,p=!1,w.startsWith("[")&&w.endsWith("]"))try{let k=w.slice(1,-1).trim();if(!k)i[b]=[];else{let S=k.match(/"[^"]*"|'[^']*'|[^,]+/g)||[];i[b]=S.map(x=>x.replace(/^["']|["']$/g,"").trim()).filter(Boolean)}}catch(k){console.error(`[TradeNote] Error parsing array in frontmatter for ${b}:`,k),i[b]=w}else w==="true"?w=!0:w==="false"?w=!1:/^-?\d+(\.\d+)?$/.test(w)&&(w=parseFloat(w)),i[b]=w}else if(h>d&&c&&p){let b=y.match(/^([^:]+):\s*(.*)$/);if(b){let w=b[1].trim(),k=b[2].trim();k==="true"?k=!0:k==="false"?k=!1:/^-?\d+(\.\d+)?$/.test(k)&&(k=parseFloat(k)),m[w]=k}}}}else{let l=this.app.metadataCache.getFileCache(r);i=(l==null?void 0:l.frontmatter)||{}}if(i.type!=="trade"){console.warn(`[TradeNote] File is not a valid trade note: ${r.path}`);return}this.app.metadataCache.trigger("changed",r),this.cleanupDuplicateComponents(r.path);let a=this.getComponentClassName(),s=document.querySelectorAll(`.${a}[data-file-path="${r.path}"]`);if(s.length===0)return;for(let l of Array.from(s)){let c=l.getAttribute("data-view-id"),d=l.getAttribute("data-markdown-view-id")||l.getAttribute("data-editor-id");c&&(l.style.display="block",l.querySelectorAll(`.${this.getWrapperClassName()}`).forEach(p=>p.remove()),await new Promise(p=>setTimeout(()=>{try{this.renderWithDeduplication({file:r,container:l,data:i,viewId:c,contextId:d||void 0,componentClassName:this.getComponentClassName(),mountedClassName:"trade-note-mounted",contentSelector:".trade-note-container"}),p()}catch(m){console.error("[TradeNote] Error during re-render:",m),p()}},50)))}this.markFileRenderedInMode(r.path,"source"),this.markFileRenderedInMode(r.path,"preview")}catch(n){console.error(`[TradeNote] Error refreshing trade note for ${r.path}:`,n)}}cleanup(){super.cleanup(),this._tradeUpdateListener&&(document.removeEventListener("journalit:trade-data-changed",this._tradeUpdateListener),this._tradeUpdateListener=null)}renderActiveTradeNote(){var m;this.cleanupOrphanedComponents();let r=this.app.workspace.getActiveFile();if(!r)return;let n=this.app.metadataCache.getFileCache(r),i=n==null?void 0:n.frontmatter;if(!i||!this.isValidComponentType(i))return;let o=this.app.workspace.getActiveViewOfType(Fw.MarkdownView);if(!o){console.error("[TradeNote] No active markdown view found");return}let a=o.containerEl.closest(".workspace-leaf-content");if(!a){console.error("[TradeNote] Cannot find containing leaf for active view");return}let s=this.findContainingLeaf(a),l=(m=s==null?void 0:s.view)==null?void 0:m.containerEl,c=(l==null?void 0:l.id)||null,d=c?`leaf-${c}`:this.generateViewId(a),u=o.getMode()==="source",p=this.getComponentClassName();if(u){let g=o.containerEl.querySelector(".metadata-container");if(g){let f=Array.from(a.querySelectorAll(`.${p}`)).find(y=>{let h=y.getAttribute("data-file-path")===r.path,v=y.getAttribute("data-view-id")===d,b=!c||y.getAttribute("data-leaf-id")===c;return h&&v&&b});f||(f=document.createElement("div"),f.className=p,f.style.marginTop="0px",f.style.marginBottom="0px",f.style.padding="0px",f.setAttribute("data-file-path",r.path),f.setAttribute("data-view-id",d),c&&f.setAttribute("data-leaf-id",c),g.after(f)),this.renderer.renderComponent(f,i,r.path,d),this.markFileRenderedInMode(r.path,"source")}}else{let g=o.containerEl.querySelector(".markdown-preview-view");if(g){let f=Array.from(g.querySelectorAll(`.${p}`)).find(y=>{let h=y.getAttribute("data-file-path")===r.path,v=y.getAttribute("data-view-id")===d,b=!c||y.getAttribute("data-leaf-id")===c;return h&&v&&b});f||(f=document.createElement("div"),f.className=p,f.style.marginTop="0px",f.style.marginBottom="0px",f.style.padding="0px",f.setAttribute("data-file-path",r.path),f.setAttribute("data-view-id",d),c&&f.setAttribute("data-leaf-id",c),g.prepend(f)),this.renderer.renderComponent(f,i,r.path,d),this.markFileRenderedInMode(r.path,"preview")}}}};var N8=require("obsidian");var A8=$(W());var kr=$(W());var me=$(W());var jw=$(W()),Lw=({tabs:e,activeTab:t,onTabChange:r,className:n={}})=>{let{container:i="shared-tabs-container",tabList:o="shared-tabs",tab:a="shared-tab",activeTab:s="active"}=n;return jw.default.createElement("div",{className:i},jw.default.createElement("div",{className:o},e.map(l=>jw.default.createElement("button",{key:l.id,className:`${a} ${t===l.id?s:""}`,onClick:()=>r(l.id)},l.label,l.count!==void 0&&` (${l.count})`))))};var Ah=$(W()),gz=({title:e,dateDisplay:t,navigationComponent:r,className:n={}})=>{let{container:i="shared-header",title:o="shared-header-title",dateContainer:a="shared-header-date"}=n;return Ah.default.createElement("div",{className:i},Ah.default.createElement("div",{className:a},Ah.default.createElement("h2",{className:o},e," ",Ah.default.createElement("span",null,t))),r)};var li=$(W());var _w=({goals:e,goalStatus:t,onToggleGoal:r,onAddGoal:n,onRemoveGoal:i,className:o={},title:a="Goals",emptyMessage:s="No goals found",emptyActionLabel:l,onEmptyAction:c,readOnly:d=!1})=>{let{container:u="shared-goal-tracker",goalItem:p="shared-goal-item",goalCheckbox:m="shared-goal-checkbox",goalText:g="shared-goal-text",completed:f="completed"}=o,[y,h]=(0,li.useState)(""),v=()=>{y.trim()&&n&&(n(y),h(""))};return!e||e.length===0?li.default.createElement("div",{className:u},li.default.createElement("h3",null,a),li.default.createElement(Ae,{message:s,actionButtonText:l,onActionButtonClick:c})):li.default.createElement("div",{className:u},li.default.createElement("h3",null,a),li.default.createElement("div",{className:`${u}-list`},e.map((b,w)=>li.default.createElement("div",{key:`goal-${w}`,className:p,onClick:k=>{let S=k.target;S.tagName!=="INPUT"&&S.tagName!=="LABEL"&&!d&&r(w)}},li.default.createElement("input",{type:"checkbox",className:m,checked:!!t[`goal_${w}`],onChange:()=>r(w),disabled:d,id:`goal-checkbox-${w}`}),li.default.createElement("label",{htmlFor:`goal-checkbox-${w}`,className:`${g} ${t[`goal_${w}`]?f:""}`},b),i&&!d&&li.default.createElement("button",{onClick:k=>{k.stopPropagation(),i(w)},className:`${u}-remove-button`,title:"Remove goal"},"\xD7")))),n&&!d&&li.default.createElement("div",{className:`${u}-add-container`},li.default.createElement("input",{type:"text",value:y,onChange:b=>h(b.target.value),placeholder:"Add a new goal",onKeyDown:b=>b.key==="Enter"&&v(),className:`${u}-add-input`}),li.default.createElement("button",{onClick:v,className:`${u}-add-button`},"Add")))};var Cc=$(W());var zw=({sectionName:e,sectionTitle:t,notes:r,imagePath:n,onNotesChange:i,onImageUploaded:o,onImageDeleted:a,saveImageFunction:s,isCustom:l=!1,className:c={}})=>{let{container:d="shared-forecast-section",sectionTitle:u="shared-forecast-title",notesContainer:p="shared-forecast-notes",imageContainer:m="shared-forecast-image"}=c;return Cc.default.createElement("div",{className:d,"data-section-name":e,"data-is-custom":l?"true":"false"},Cc.default.createElement("h4",{className:u},t," Chart"),Cc.default.createElement("div",{className:m},n?Cc.default.createElement(dh,{imagePath:n,alt:`${t} Forecast`,enableFullscreen:!0,description:`${t} Forecast`,showDeleteButton:!0,onDelete:a}):Cc.default.createElement(Dd,{onImageUploaded:o,saveImageFunction:async f=>{try{let y=await s(f);return o(y),y}catch(y){return console.error(`Error uploading image for ${e}:`,y),""}},label:`Upload ${t} Chart`,enableDragDrop:!0,multiple:!1,enablePaste:!0})),Cc.default.createElement("div",{className:p},Cc.default.createElement("textarea",{value:r||"",onChange:f=>i(f.target.value),placeholder:`Add your ${t.toLowerCase()} notes here...`,rows:4,style:{width:"100%",boxSizing:"border-box"}})))};var Vn=$(W());Yt();var zE=class{constructor(){this.logs=[];this.isEnabled=!0;this.mutationObserver=null;this.lastFocusedElement=null;this.lastActiveTabElements=new Map;this.isEnabled=!0,this.isEnabled&&(this.setupGlobalListeners(),this.setupMutationObserver())}getElementSignature(t){if(!t)return"null";let r=t.tagName.toLowerCase(),n=t.className?`.${t.className.split(" ").join(".")}`:"",i=t.id?`#${t.id}`:"";return`${r}${i}${n}`}getElementRect(t){if(!t)return null;try{return t.getBoundingClientRect()}catch(r){return null}}getElementStyles(t){if(!t)return{position:"",top:"",left:"",transform:"",visibility:"",display:""};try{let r=window.getComputedStyle(t);return{position:r.position,top:r.top,left:r.left,transform:r.transform,visibility:r.visibility,display:r.display}}catch(r){return{position:"",top:"",left:"",transform:"",visibility:"",display:""}}}createSnapshot(){let t=document.activeElement,r=document.querySelector(".drc-container")||document.querySelector(".weekly-review-container");return{activeElement:this.getElementSignature(t),focusedElementRect:this.getElementRect(t),drcContainerRect:this.getElementRect(r),viewportState:{innerWidth:window.innerWidth,innerHeight:window.innerHeight,scrollX:window.scrollX,scrollY:window.scrollY},documentBody:{scrollWidth:document.body.scrollWidth,scrollHeight:document.body.scrollHeight,clientWidth:document.body.clientWidth,clientHeight:document.body.clientHeight}}}setupMutationObserver(){this.mutationObserver=new MutationObserver(t=>{let r=0,n=0,i=0,o=0;t.forEach(a=>{a.type==="childList"?(n+=a.addedNodes.length,i+=a.removedNodes.length,r++):a.type==="attributes"&&(a.attributeName==="style"||a.attributeName==="class")&&(o++,r++)}),r>0&&this.log("DOM_MUTATION","DOM mutations detected",void 0,{mutationCount:t.length,addedNodes:n,removedNodes:i,styleChanges:o,significantChanges:r})}),this.mutationObserver.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["style","class","id","data-is-open"]})}setupGlobalListeners(){document.addEventListener("focusin",i=>{let o=i.target,a=this.lastFocusedElement===o;this.log("FOCUS_CHANGE","Element received focus",void 0,{element:this.getElementSignature(o),wasExpected:a,previousElement:this.getElementSignature(this.lastFocusedElement)}),this.lastFocusedElement=o}),document.addEventListener("click",i=>{let o=i.target;this.log("CLICK_EVENT","Element clicked",void 0,{element:this.getElementSignature(o),coordinates:{x:i.clientX,y:i.clientY},targetRect:this.getElementRect(o)})}),document.addEventListener("input",i=>{var a;let o=i.target;(o.tagName==="INPUT"||o.tagName==="TEXTAREA")&&this.log("INPUT_EVENT","Text input detected",void 0,{element:this.getElementSignature(o),inputType:i.inputType||"unknown",valueLength:((a=o.value)==null?void 0:a.length)||0})});let t=HTMLElement.prototype.focus;HTMLElement.prototype.focus=function(...i){var o;return ci.log("PROGRAMMATIC_FOCUS","Element.focus() called",void 0,{element:ci.getElementSignature(this),stackTrace:(o=new Error().stack)==null?void 0:o.split(`
`).slice(1,4).join(`
`)}),t.apply(this,i)},window.addEventListener("scroll",i=>{this.log("SCROLL_EVENT","Scroll detected during debugging",void 0,{scrollX:window.scrollX,scrollY:window.scrollY,target:this.getElementSignature(i.target)})},{passive:!0});let r=Element.prototype.getBoundingClientRect,n=0;Element.prototype.getBoundingClientRect=function(){return n++,n%10===0&&ci.log("LAYOUT_REFLOW","Potential layout reflow (getBoundingClientRect)",void 0,{element:ci.getElementSignature(this),callCount:n}),r.apply(this)}}log(t,r,n,i){if(!this.isEnabled)return;let o={timestamp:Date.now(),type:t,message:r,component:n,data:i,snapshot:this.createSnapshot()};this.logs.push(o);let a=new Date(o.timestamp).toISOString().substr(14,9),s=n?`[${n}] `:"";console.log(`\u{1F50D} ${a} ${t}: ${s}${r}`,i||""),this.logs.length>150&&(this.logs=this.logs.slice(-150))}logInteraction(t,r,n,i){let o=this.createSnapshot();this.log(`${t}_START`,`${r} - BEFORE`,n,{...i,beforeSnapshot:o}),setTimeout(()=>{let a=this.createSnapshot(),s=this.detectPositionChanges(o,a);this.log(`${t}_END`,`${r} - AFTER`,n,{...i,afterSnapshot:a,positionChanges:s})},0)}detectPositionChanges(t,r){if(!t||!r)return null;let n={};if(t.focusedElementRect&&r.focusedElementRect){let i=t.focusedElementRect,o=r.focusedElementRect;(i.top!==o.top||i.left!==o.left)&&(n.focusedElementMoved={from:{top:i.top,left:i.left},to:{top:o.top,left:o.left},delta:{top:o.top-i.top,left:o.left-i.left}})}if(t.drcContainerRect&&r.drcContainerRect){let i=t.drcContainerRect,o=r.drcContainerRect;(i.top!==o.top||i.left!==o.left)&&(n.drcContainerMoved={from:{top:i.top,left:i.left},to:{top:o.top,left:o.left},delta:{top:o.top-i.top,left:o.left-i.left}})}return(t.viewportState.scrollX!==r.viewportState.scrollX||t.viewportState.scrollY!==r.viewportState.scrollY)&&(n.viewportScrolled={from:{x:t.viewportState.scrollX,y:t.viewportState.scrollY},to:{x:r.viewportState.scrollX,y:r.viewportState.scrollY},delta:{x:r.viewportState.scrollX-t.viewportState.scrollX,y:r.viewportState.scrollY-t.viewportState.scrollY}}),t.activeElement!==r.activeElement&&(n.activeElementChanged={from:t.activeElement,to:r.activeElement}),Object.keys(n).length>0?n:null}getLogs(){return[...this.logs]}getLogsAsString(){return this.logs.map(t=>{let r=new Date(t.timestamp).toISOString(),n=t.component?`[${t.component}] `:"",i=t.data?` | Data: ${JSON.stringify(t.data,null,2)}`:"",o=t.snapshot?` | ActiveElement: ${t.snapshot.activeElement} | Scroll: (${t.snapshot.viewportState.scrollX}, ${t.snapshot.viewportState.scrollY})`:"";return`${r} ${t.type}: ${n}${t.message}${i}${o}`}).join(`

`)}getRecentJumps(){let t=Date.now()-3e4;return this.logs.filter(i=>i.timestamp>t).filter(i=>{var o;return i.type.includes("FOCUS")||i.type.includes("POSITION")||i.type.includes("SCROLL")||((o=i.data)==null?void 0:o.positionChanges)&&Object.keys(i.data.positionChanges).length>0}).map(i=>{let o=new Date(i.timestamp).toISOString().substr(14,9),a=i.component?`[${i.component}] `:"";return`${o} ${i.type}: ${a}${i.message}`}).join(`
`)}clear(){this.logs=[],console.log("\u{1F50D} Jump debug logs cleared")}enable(){this.isEnabled=!0,console.log("\u{1F50D} Jump debug logging enabled")}disable(){this.isEnabled=!1,console.log("\u{1F50D} Jump debug logging disabled")}cleanup(){this.mutationObserver&&(this.mutationObserver.disconnect(),this.mutationObserver=null)}exposeToWindow(){window.jumpDebugger=this,console.log("\u{1F50D} JumpDebugger available as window.jumpDebugger"),console.log("\u{1F50D} Commands:"),console.log("  jumpDebugger.getLogsAsString() - Get all logs for reporting"),console.log("  jumpDebugger.getRecentJumps() - Get recent jump indicators"),console.log("  jumpDebugger.clear() - Clear all logs"),console.log("  jumpDebugger.getLogs() - Get raw log objects")}},ci=new zE;ci.exposeToWindow();var hz=$(W()),e7=16,t7=32,$E=class{constructor(){this.focusState=null;this.isManagingFocus=!1;this.codeMirrorPreventionActive=!1;this.restorationTimeoutId=null;this.positionLocks=[];this.handleFocusCapture=t=>{var n;let r=t.target;this.isManagingFocus&&this.isCodeMirrorElement(r)&&(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),(n=this.focusState)!=null&&n.element&&document.contains(this.focusState.element)&&(this.focusState.element.focus({preventScroll:!0}),console.debug("[FocusManager] Blocked CodeMirror focus, restored to stored element")))}}captureFocus(t){let r=document.activeElement;r&&this.isPluginElement(r)&&(this.focusState={element:r,timestamp:Date.now(),componentName:t},console.debug(`[FocusManager] Captured focus from ${r.tagName}.${r.className} in ${t}`))}lockContainerPositions(){document.querySelectorAll('[data-focus-managed="true"]').forEach(r=>{let n=r,i=n.getBoundingClientRect(),o=getComputedStyle(n),a={container:n,originalPosition:i,originalStyles:{position:o.position,top:o.top,left:o.left,transform:o.transform,width:o.width,height:o.height}};this.positionLocks.push(a),n.setAttribute("data-position-locked","true"),n.style.setProperty("--locked-top",`${i.top}px`),n.style.setProperty("--locked-left",`${i.left}px`),n.style.setProperty("--locked-width",`${i.width}px`),n.style.setProperty("--locked-height",`${i.height}px`),console.debug(`[FocusManager] Position locked for container at (${i.top}, ${i.left})`)})}unlockContainerPositions(){this.positionLocks.forEach(t=>{try{t.container.removeAttribute("data-position-locked"),t.container.style.removeProperty("--locked-top"),t.container.style.removeProperty("--locked-left"),t.container.style.removeProperty("--locked-width"),t.container.style.removeProperty("--locked-height"),console.debug("[FocusManager] Position unlocked for container")}catch(r){console.warn("[FocusManager] Error unlocking container position:",r)}}),this.positionLocks=[]}preventCodeMirrorFocus(){if(this.codeMirrorPreventionActive)return;this.codeMirrorPreventionActive=!0,this.isManagingFocus=!0,this.unlockContainerPositions(),this.lockContainerPositions(),document.querySelectorAll(".cm-editor, .cm-scroller").forEach(r=>{let n=r;n.style.pointerEvents="none",n.setAttribute("data-focus-blocked","true")}),document.addEventListener("focusin",this.handleFocusCapture,{capture:!0}),console.debug("[FocusManager] CodeMirror focus prevention activated with position locks")}restoreFocus(t=e7){this.restorationTimeoutId&&clearTimeout(this.restorationTimeoutId),this.restorationTimeoutId=window.setTimeout(()=>{this.performFocusRestoration()},t)}performFocusRestoration(){var t;try{if(document.querySelectorAll('[data-focus-blocked="true"]').forEach(n=>{let i=n;i.style.pointerEvents="",i.removeAttribute("data-focus-blocked")}),document.removeEventListener("focusin",this.handleFocusCapture,{capture:!0}),this.codeMirrorPreventionActive=!1,this.isManagingFocus=!1,this.restorationTimeoutId=null,(t=this.focusState)!=null&&t.element&&document.contains(this.focusState.element)){let{element:n,componentName:i}=this.focusState;try{let o=getComputedStyle(n);n.isConnected&&!n.hasAttribute("disabled")&&n.tabIndex>=0&&o.display!=="none"?(n.focus({preventScroll:!0}),console.debug(`[FocusManager] Focus restored to ${n.tagName}.${n.className} in ${i}`)):console.debug(`[FocusManager] Element no longer focusable, skipping focus restoration in ${i}`)}catch(o){console.warn(`[FocusManager] Failed to restore focus in ${i}:`,o)}}setTimeout(()=>{this.unlockContainerPositions()},t7),console.debug("[FocusManager] Focus management cycle completed with position unlocking")}catch(r){console.error("[FocusManager] Error during focus restoration:",r),this.codeMirrorPreventionActive=!1,this.isManagingFocus=!1,this.restorationTimeoutId=null,this.unlockContainerPositions()}}isPluginElement(t){return t.closest(".drc-container, .weekly-review-container, .journalit-component")!==null||t.classList.contains("drc-checkbox")||t.classList.contains("drc-note-grade-value")||t.tagName==="SELECT"&&t.closest(".drc-container, .weekly-review-container")!==null||t.tagName==="INPUT"&&t.closest(".drc-container, .weekly-review-container")!==null||t.tagName==="TEXTAREA"&&t.closest(".drc-container, .weekly-review-container")!==null}isCodeMirrorElement(t){return t.classList.contains("cm-scroller")||t.classList.contains("cm-content")||t.classList.contains("cm-line")||t.classList.contains("cm-editor")||t.closest(".cm-editor")!==null}cleanup(){this.restorationTimeoutId&&(clearTimeout(this.restorationTimeoutId),this.restorationTimeoutId=null),document.removeEventListener("focusin",this.handleFocusCapture,{capture:!0}),document.querySelectorAll('[data-focus-blocked="true"]').forEach(r=>{let n=r;n.style.pointerEvents="",n.removeAttribute("data-focus-blocked")}),this.unlockContainerPositions(),this.focusState=null,this.isManagingFocus=!1,this.codeMirrorPreventionActive=!1}wrapStateUpdate(t,r){return(...n)=>{this.captureFocus(r),this.preventCodeMirrorFocus(),t(...n),this.restoreFocus()}}},$w=new $E;function vz(e){return hz.default.useMemo(()=>({wrapStateUpdate:t=>$w.wrapStateUpdate(t,e),captureFocus:()=>$w.captureFocus(e),restoreFocus:t=>$w.restoreFocus(t),cleanup:()=>$w.cleanup()}),[e])}function yz(e){let t=r=>{(r.type==="focus"||r.type==="blur"||r.type==="focusin"||r.type==="focusout")&&r.stopPropagation(),(r.type==="input"||r.type==="change")&&r.stopPropagation()};return e.addEventListener("focus",t,{capture:!0}),e.addEventListener("blur",t,{capture:!0}),e.addEventListener("focusin",t,{capture:!0}),e.addEventListener("focusout",t,{capture:!0}),e.addEventListener("input",t,{capture:!0}),e.addEventListener("change",t,{capture:!0}),()=>{e.removeEventListener("focus",t,{capture:!0}),e.removeEventListener("blur",t,{capture:!0}),e.removeEventListener("focusin",t,{capture:!0}),e.removeEventListener("focusout",t,{capture:!0}),e.removeEventListener("input",t,{capture:!0}),e.removeEventListener("change",t,{capture:!0})}}Wb();function Rw({data:e,filePath:t,openNote:r,plugin:n,serviceName:i,componentName:o,navigationOptions:a,tabConfig:s,updateMethodName:l,className:c={},topElement:d,bottomElement:u}){var M;let[p,m]=(0,Vn.useState)(e),[g,f]=(0,Vn.useState)(((M=s[0])==null?void 0:M.id)||""),y=(0,Vn.useRef)(null),h=vz(o),v=vp(o,"general"),b=Ge(),w=n||b,{service:k,status:S}=kp(i),{currentDate:x,getAdjacentReview:T,getRelatedReviewPaths:E}=a,C=r||((O,F=!0)=>{var L;try{let B=window.app;(L=B==null?void 0:B.workspace)==null||L.openLinkText(O,"",F)}catch(B){v(B,"Failed to navigate to path")}}),N=Yb({currentDate:x,navigateTo:C,getAdjacentReview:T,getRelatedReviewPaths:E,serviceName:i}),D=O=>{ci.logInteraction("STATE_UPDATE","ReviewBase data update triggered",o,{updates:Object.keys(O),activeTab:g});try{if(m(F=>z2(F,O)),k&&t&&l&&typeof k[l]=="function"){let F=$C(O);k[l](t,F).then(()=>{}).catch(L=>{sa({message:`Failed to update ${o} in file`,error:L,component:o,operation:"updateData",severity:"error"})})}}catch(F){v(F,`Error updating ${o}`),m(L=>({...L,...O}))}},A=h.wrapStateUpdate(D);(0,Vn.useEffect)(()=>{ci.log("COMPONENT_RENDER","ReviewBase component re-rendered",o,{activeTab:g,dataKeys:Object.keys(p||{})})},[p,o,g]),(0,Vn.useEffect)(()=>{ci.log("ACTIVE_TAB_EFFECT","Active tab changed in useEffect",o,{activeTab:g})},[g]);let P=O=>{ci.logInteraction("TAB_CHANGE","ReviewBase tab change requested",o,{fromTab:g,toTab:O}),f(O)},I=h.wrapStateUpdate(P);return(0,Vn.useEffect)(()=>{if(Hg(),y.current){let O=yz(y.current);return y.current.setAttribute("data-focus-managed","true"),()=>{O(),h.cleanup()}}},[h]),S==="loading"?Vn.default.createElement("div",{className:c.container||"review-base-container"},"Loading ",o,"..."):S==="error"?Vn.default.createElement("div",{className:c.container||"review-base-container"},Vn.default.createElement("div",{className:"error-state"},"Failed to load ",o,". Please try refreshing the page.")):Vn.default.createElement("div",{className:c.container||"review-base-container",ref:y,"data-component":o},d,Vn.default.createElement(gz,{title:`${o}`,dateDisplay:(()=>{if(o.toLowerCase().includes("w")&&o.toLowerCase().includes("review")&&o.match(/w\d+\s+review/i))return"";try{let O=fr(),F=p.date instanceof Date?p.date:new Date(p.date);return Ze(F,O)}catch(O){return(p.date instanceof Date?p.date:new Date(p.date)).toLocaleDateString()}})(),navigationComponent:Vn.default.createElement(_p,{buttons:(()=>{let O=[],F=o.toLowerCase().includes("weekly")||o.match(/w\d+\s+review/i)!==null;return O.push({text:F?"Previous Week":"Previous Day",action:()=>N.handleNavigation(-1),icon:"left",disabled:N.isNavigating}),o.toLowerCase().includes("daily")||o.toLowerCase().includes("drc")?O.push({text:"Weekly Review",action:()=>N.navigateToRelatedReview("weekly")},{text:"Monthly Review",action:()=>N.navigateToRelatedReview("monthly")}):F?O.push({text:"Monthly Review",action:()=>N.navigateToRelatedReview("monthly")},{text:"Yearly Review",action:()=>N.navigateToRelatedReview("yearly")}):O.push({text:"Weekly Review",action:()=>N.navigateToRelatedReview("weekly")},{text:"Monthly Review",action:()=>N.navigateToRelatedReview("monthly")}),O.push({text:F?"Next Week":"Next Day",action:()=>N.handleNavigation(1),icon:"right",disabled:N.isNavigating}),O})(),className:`${o.toLowerCase().replace(/\s+/g,"-")}-navigation`}),className:c.header}),Vn.default.createElement(Lw,{tabs:s,activeTab:g,onTabChange:I,className:c.tabContainer}),(()=>{try{let O=s.find(F=>F.id===g);return!O||typeof O.content!="function"?null:O.content({data:p,updateData:A,plugin:w,openNote:C})}catch(O){return console.error("Error rendering tab content:",O),null}})(),u)}var gr=$(W()),wz=$(ul()),qp=gr.default.memo(({content:e,children:t,className:r="",delay:n=300,preferredPosition:i="auto"})=>{let[o,a]=(0,gr.useState)(!1),[s,l]=(0,gr.useState)({top:-9999,left:-9999}),[c,d]=(0,gr.useState)(!1),u=(0,gr.useRef)({x:0,y:0}),p=(0,gr.useRef)(null),m=(0,gr.useRef)(null),g=(0,gr.useRef)(null),f=(0,gr.useRef)(null),y=(0,gr.useCallback)(()=>{if(!f.current||!g.current)return;let w=f.current.getBoundingClientRect(),k=g.current.getBoundingClientRect(),S=window.innerWidth,x=window.innerHeight,T=8,E=0,C=0;switch(w.width<50&&w.height<50&&i==="auto"?"top":i){case"right":E=w.top+(w.height-k.height)/2,C=w.right+T,C+k.width>S-16&&(C=w.left-k.width-T);break;case"left":E=w.top+(w.height-k.height)/2,C=w.left-k.width-T,C<16&&(C=w.right+T);break;case"bottom":E=w.bottom+T,C=w.left+(w.width-k.width)/2;break;case"top":E=w.top-k.height-T,C=w.left+(w.width-k.width)/2,E<16&&(E=w.bottom+T);break;default:E=w.top-k.height-T,C=w.left+(w.width-k.width)/2,E<16&&(E=w.bottom+T)}let A=16;C<A&&(C=A),C+k.width>S-A&&(C=S-k.width-A),E<A&&(E=A),E+k.height>x-A&&(E=x-k.height-A),l({top:E,left:C})},[i]),h=(0,gr.useCallback)(w=>{u.current={x:w.clientX,y:w.clientY},p.current&&cancelAnimationFrame(p.current),m.current=setTimeout(()=>{a(!0),d(!0)},n)},[n]),v=(0,gr.useCallback)(()=>{m.current&&(clearTimeout(m.current),m.current=null),p.current&&(cancelAnimationFrame(p.current),p.current=null),a(!1),setTimeout(()=>d(!1),200)},[]);(0,gr.useEffect)(()=>{o&&c&&(p.current=requestAnimationFrame(()=>{y()}))},[o,c,y]),(0,gr.useEffect)(()=>()=>{m.current&&clearTimeout(m.current),p.current&&cancelAnimationFrame(p.current)},[]);let b=(0,gr.useCallback)(w=>{o&&(Math.abs(w.clientX-u.current.x)>5||Math.abs(w.clientY-u.current.y)>5)&&(u.current={x:w.clientX,y:w.clientY},p.current&&cancelAnimationFrame(p.current),p.current=requestAnimationFrame(()=>{y()}))},[o,y]);return gr.default.createElement(gr.default.Fragment,null,gr.default.createElement("div",{ref:f,onMouseEnter:h,onMouseLeave:v,onMouseMove:b,className:"tooltip-trigger"},t),c&&(0,wz.createPortal)(gr.default.createElement("div",{ref:g,className:`journalit-tooltip ${r}`,style:{position:"fixed",top:`${s.top}px`,left:`${s.left}px`,zIndex:9999,opacity:o?1:0,transition:"opacity 150ms ease-in-out",pointerEvents:"none"}},e),document.body))});qp.displayName="Tooltip";bd();Ci();var r7=({forecast:e,updateData:t})=>{let r=({color:x,size:T=16})=>me.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:T,height:T,viewBox:"0 0 24 24",fill:"none",stroke:x,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},me.default.createElement("path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"}),me.default.createElement("line",{x1:"4",y1:"22",x2:"4",y2:"15"})),n=[{value:null,icon:me.default.createElement(r,{color:"var(--text-muted)"}),label:"None"},{value:"High",icon:me.default.createElement(r,{color:"var(--color-error, #e53935)"}),label:"High"},{value:"Medium",icon:me.default.createElement(r,{color:"var(--color-orange, #ef6c00)"}),label:"Medium"},{value:"Low",icon:me.default.createElement(r,{color:"var(--interactive-accent, #4a90e2)"}),label:"Low"}],i=me.default.createElement(r,{color:"var(--text-muted)"}),[o,a]=(0,me.useState)(""),[s,l]=(0,me.useState)(""),[c,d]=(0,me.useState)(null),[u,p]=(0,me.useState)(null),g=(()=>{if(e.levels&&!e.keyLevels)try{let x=e.levels.split(`
`).filter(N=>N.trim().length>0),T=/(low|medium|high)\s*:\s*(.*)/i,E=[],C=[];return x.forEach(N=>{let D=N.trim(),A=D.toLowerCase(),P=A.includes("support"),I=A.includes("resistance"),M=A.match(T);if(M){let O=M[1].charAt(0).toUpperCase()+M[1].slice(1).toLowerCase(),F=M[2].trim();P?E.push({price:F,importance:O}):I?C.push({price:F,importance:O}):C.push({price:F,importance:O})}else if(D.length>0)if(P){let O=A.replace(/support/i,"").trim();E.push({price:O||D,importance:null})}else if(I){let O=A.replace(/resistance/i,"").trim();C.push({price:O||D,importance:null})}else C.push({price:D,importance:null})}),{support:E,resistance:C}}catch(x){return console.error("Error migrating legacy levels:",x),{support:[],resistance:[]}}return e.keyLevels||{support:[],resistance:[]}})(),f=()=>{if(!o.trim())return;let x={...g,support:[...g.support,{price:o,importance:c}]};b(x),a(""),d(null)},y=()=>{if(!s.trim())return;let x={...g,resistance:[...g.resistance,{price:s,importance:u}]};b(x),l(""),p(null)},h=x=>{let T=[...g.support];T.splice(x,1),b({...g,support:T})},v=x=>{let T=[...g.resistance];T.splice(x,1),b({...g,resistance:T})},b=x=>{let T={...e,keyLevels:x};t({forecast:T})},w=x=>{x.key==="Enter"&&(x.preventDefault(),f())},k=x=>{x.key==="Enter"&&(x.preventDefault(),y())},S=x=>{switch(x){case"High":return"importance-high";case"Medium":return"importance-medium";case"Low":return"importance-low";default:return""}};return me.default.createElement("div",{className:"drc-key-levels"},me.default.createElement("div",{className:"drc-levels-container"},me.default.createElement("div",{className:"drc-level-section support-section"},me.default.createElement("h4",{className:"drc-level-header support-header"},"Support Levels"),me.default.createElement("div",{className:"drc-level-add-container"},me.default.createElement("div",{className:"drc-level-input-group"},me.default.createElement("input",{type:"text",value:o,onChange:x=>a(x.target.value),onKeyDown:w,className:"drc-level-input",placeholder:"Enter price level",style:{height:"32px"}}),me.default.createElement(nE,{options:n,value:c,onChange:x=>d(x),placeholderIcon:i,title:"Select importance level"}),me.default.createElement(be,{variant:"primary",onClick:f,title:"Add support level",className:"drc-level-add-button"},"Add"))),me.default.createElement("div",{className:"drc-levels-list"},g.support.length>0?g.support.map((x,T)=>me.default.createElement("div",{key:`support-${T}`,className:`drc-level-item support-level ${S(x.importance)}`},me.default.createElement("div",{className:"drc-level-price"},x.price),x.importance&&me.default.createElement("div",{className:"drc-level-importance"},x.importance),me.default.createElement("button",{className:"drc-level-remove-button",onClick:()=>h(T),title:"Remove level"},me.default.createElement("span",{style:{position:"relative",top:"-1px"}},"\xD7")))):me.default.createElement("div",{className:"drc-empty-levels"},"No support levels defined"))),me.default.createElement("div",{className:"drc-level-section resistance-section"},me.default.createElement("h4",{className:"drc-level-header resistance-header"},"Resistance Levels"),me.default.createElement("div",{className:"drc-level-add-container"},me.default.createElement("div",{className:"drc-level-input-group"},me.default.createElement("input",{type:"text",value:s,onChange:x=>l(x.target.value),onKeyDown:k,className:"drc-level-input",placeholder:"Enter price level",style:{height:"32px"}}),me.default.createElement(nE,{options:n,value:u,onChange:x=>p(x),placeholderIcon:i,title:"Select importance level"}),me.default.createElement(be,{variant:"primary",onClick:y,title:"Add resistance level",className:"drc-level-add-button"},"Add"))),me.default.createElement("div",{className:"drc-levels-list"},g.resistance.length>0?g.resistance.map((x,T)=>me.default.createElement("div",{key:`resistance-${T}`,className:`drc-level-item resistance-level ${S(x.importance)}`},me.default.createElement("div",{className:"drc-level-price"},x.price),x.importance&&me.default.createElement("div",{className:"drc-level-importance"},x.importance),me.default.createElement("button",{className:"drc-level-remove-button",onClick:()=>v(T),title:"Remove level"},me.default.createElement("span",{style:{position:"relative",top:"-1px"}},"\xD7")))):me.default.createElement("div",{className:"drc-empty-levels"},"No resistance levels defined")))),me.default.createElement("style",null,`
        .drc-key-levels {
          margin-top: 16px;
        }

        .drc-levels-container {
          display: flex;
          flex-direction: column;
          gap: 24px;
        }

        .drc-level-section {
          border-radius: 8px;
          padding: 16px;
          background-color: var(--background-secondary);
        }

        .support-section {
          border-left: 3px solid rgba(102, 187, 106, 0.7);
        }

        .resistance-section {
          border-left: 3px solid rgba(229, 57, 53, 0.7);
        }

        .drc-level-header {
          margin: 0 0 12px 0;
          padding-bottom: 8px;
          border-bottom: 1px solid var(--background-modifier-border);
          font-size: 14px;
          font-weight: 600;
          text-align: center;
        }

        .support-header {
          color: var(--color-success, #43a047);
        }

        .resistance-header {
          color: var(--color-error, #e53935);
        }

        .drc-level-add-container {
          margin-bottom: 12px;
        }

        .drc-level-input-group {
          display: flex;
          gap: 8px;
          width: 100%;
        }

        .drc-level-input {
          flex: 2;
          min-width: 0;
          padding: 8px 12px;
          border: 1px solid var(--background-modifier-border);
          border-radius: 4px;
          background-color: var(--background-primary);
          color: var(--text-normal);
          font-size: 14px;
          height: 32px; /* Reduced height */
          box-sizing: border-box;
        }

        .drc-level-importance-select {
          width: 40px;
          position: relative;
          display: flex;
          align-items: center;
        }

        .importance-icon-wrapper {
          position: absolute;
          left: 4px;
          z-index: 1;
          pointer-events: none;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .importance-flag-icon {
          color: var(--text-muted);
        }

        .drc-importance-select {
          width: 40px;
          padding: 8px 0 8px 24px;
          border: 1px solid var(--background-modifier-border);
          border-radius: 4px;
          background-color: var(--background-primary);
          color: var(--text-normal);
          font-size: 14px;
          height: 32px; /* Reduced height */
          box-sizing: border-box;
          appearance: none;
          -webkit-appearance: none;
          -moz-appearance: none;
          background-image: none; /* Remove dropdown arrow */
          text-align: center;
        }

        .drc-level-add-button {
          padding: 6px 12px !important;
          height: 32px !important; /* Reduced height */
          box-sizing: border-box !important;
          display: flex !important;
          align-items: center !important;
          justify-content: center !important;
        }

        .drc-levels-list {
          display: flex;
          flex-direction: column;
          gap: 8px;
        }

        .drc-level-item {
          display: flex;
          align-items: center;
          padding: 8px 12px;
          background-color: var(--background-primary);
          border-radius: 4px;
          position: relative;
          justify-content: flex-start;
        }

        .support-level {
          border-left: 3px solid rgba(102, 187, 106, 0.5);
        }

        .resistance-level {
          border-left: 3px solid rgba(229, 57, 53, 0.5);
        }

        .drc-level-price {
          font-weight: 500;
          margin-right: 8px;
        }

        .drc-level-importance {
          font-size: 12px;
          padding: 2px 6px;
          border-radius: 3px;
        }

        .importance-high {
          background-color: rgba(229, 57, 53, 0.1);
        }

        .importance-high .drc-level-importance {
          background-color: rgba(229, 57, 53, 0.2);
          color: var(--color-error, #e53935);
        }

        .importance-medium {
          background-color: rgba(255, 152, 0, 0.1);
        }

        .importance-medium .drc-level-importance {
          background-color: rgba(255, 152, 0, 0.2);
          color: var(--color-orange, #ef6c00);
        }

        .importance-low {
          background-color: rgba(33, 150, 243, 0.1);
        }

        .importance-low .drc-level-importance {
          background-color: rgba(33, 150, 243, 0.2);
          color: var(--interactive-accent);
        }

        .drc-level-remove-button {
          padding: 0;
          width: 24px;
          height: 24px;
          background-color: rgba(229, 57, 53, 0.1);
          color: var(--color-error, #e53935);
          border: none;
          border-radius: 50%;
          cursor: pointer;
          font-size: 16px;
          line-height: 0;
          display: flex;
          align-items: center;
          justify-content: center;
          margin-left: auto; /* Always push to the right */
          text-align: center;
          vertical-align: middle;
        }

        .drc-empty-levels {
          color: var(--text-muted);
          font-style: italic;
          padding: 8px;
          text-align: center;
        }

        @media (min-width: 768px) {
          .drc-levels-container {
            flex-direction: row !important;
            gap: 16px !important;
          }

          .drc-level-section {
            width: calc(50% - 8px) !important;
          }
        }
      `))},xz=({frontmatter:e,updateFrontmatter:t,trades:r,openNote:n,plugin:i,previousDayGoals:o})=>{let a=e,s=t,l=j=>{var q,X;ci.logInteraction("CHECKBOX_CHANGE","Pre-trade checklist item toggled","PreparationSection",{item:j,fromValue:((q=a.preTradeChecklist)==null?void 0:q[j])||!1,toValue:!((X=a.preTradeChecklist)!=null&&X[j])});let _=a.preTradeChecklist||{},H={..._,[j]:!_[j]};s({preTradeChecklist:H})},c=j=>{let _={...a.dailyGoalStatus||{}},H=`goal_${j}`;_[H]=!_[H],s({dailyGoalStatus:_})},d=()=>{var j;try{let _=window.app;return(j=_==null?void 0:_.plugins)==null?void 0:j.plugins.journalit}catch(_){return console.error("Could not access plugin instance:",_),null}},u=()=>{var j,_;try{let H=d();return((_=(j=H==null?void 0:H.settings)==null?void 0:j.drc)==null?void 0:_.customTimeframes)||["Daily","4H","1H","30M"]}catch(H){return console.error("Error getting timeframes:",H),["Daily","4H","1H","30M"]}},p=()=>{let j=u(),_={},H={};return j.forEach(q=>{let X=q.replace(/\s+/g,"_").toLowerCase();_[X]=!1,H[X]=!1,q==="Daily"&&(_.daily=!1),q==="4H"&&(_.fourHour=!1),q==="1H"&&(_.oneHour=!1),q==="30M"&&(_.thirtyMin=!1),q==="Daily"&&(H.daily=!1),q==="4H"&&(H.fourHour=!1),q==="1H"&&(H.oneHour=!1),q==="30M"&&(H.thirtyMin=!1)}),{initialDragState:_,initialErrorState:H}},{initialDragState:m,initialErrorState:g}=p(),[f,y]=(0,me.useState)(m),[h,v]=(0,me.useState)(g),[b,w]=(0,me.useState)([]),[k,S]=(0,me.useState)({isOpen:!1,imagePath:"",description:""});(0,me.useEffect)(()=>{async function j(){try{let _=d();if(!(_!=null&&_.drcService))return;let H=new Date(a.date),q=await _.drcService.getWeeklyEventsForDate(H);w(q)}catch(_){console.error("Error fetching weekly events for date:",a.date,_)}}a.date&&j()},[a.date]);let x=j=>{v(_=>({..._,[j]:!0}))},T=j=>{v(_=>({..._,[j]:!1}))},E=async(j,_,H=!1)=>{var q,X,U,Y,R,V,G,J;T(_);try{let K=d();if(!(K!=null&&K.drcService))throw new Error("DRC Service not available");let ne=new Date(a.date),te=await K.drcService.saveDRCForecastImage(j,ne,_),oe={...a.forecast||{daily:{notes:""},fourHour:{notes:""},oneHour:{notes:""},thirtyMin:{notes:""},customTimeframes:{},bias:"",levels:""}};if(H)oe.customTimeframes||(oe.customTimeframes={}),oe.customTimeframes[_]={...oe.customTimeframes[_],imagePath:te};else{let de={daily:{notes:((q=oe.daily)==null?void 0:q.notes)||"",imagePath:(X=oe.daily)==null?void 0:X.imagePath},fourHour:{notes:((U=oe.fourHour)==null?void 0:U.notes)||"",imagePath:(Y=oe.fourHour)==null?void 0:Y.imagePath},oneHour:{notes:((R=oe.oneHour)==null?void 0:R.notes)||"",imagePath:(V=oe.oneHour)==null?void 0:V.imagePath},thirtyMin:{notes:((G=oe.thirtyMin)==null?void 0:G.notes)||"",imagePath:(J=oe.thirtyMin)==null?void 0:J.imagePath},customTimeframes:oe.customTimeframes||{},bias:oe.bias||"",levels:oe.levels||""};(_==="daily"||_==="fourHour"||_==="oneHour"||_==="thirtyMin")&&(de[_].imagePath=te),s({forecast:de});return}s({forecast:oe})}catch(K){console.error("Error uploading image:",K)}},C=(j,_=!1)=>async H=>(await E(H,j,_),""),N=async(j,_=!1)=>{var H,q,X,U,Y;try{let R;if(_?R=(X=(q=(H=a.forecast)==null?void 0:H.customTimeframes)==null?void 0:q[j])==null?void 0:X.imagePath:R=(Y=(U=a.forecast)==null?void 0:U[j])==null?void 0:Y.imagePath,!R)return;let V=d();if(!(V!=null&&V.drcService))throw new Error("DRC Service not available");await V.drcService.deleteImage(R);let G={...a.forecast};if(_)G.customTimeframes&&G.customTimeframes[j]&&(G.customTimeframes[j].imagePath=void 0);else{let J=j;J in G&&typeof G[J]=="object"&&(G[J].imagePath=void 0)}s({forecast:G})}catch(R){console.error("Error deleting image:",R)}},D=(j,_=!1)=>{var H,q,X,U,Y;try{let R;if(_?R=(X=(q=(H=a.forecast)==null?void 0:H.customTimeframes)==null?void 0:q[j])==null?void 0:X.imagePath:R=(Y=(U=a.forecast)==null?void 0:U[j])==null?void 0:Y.imagePath,!R)return;let V=j;j==="fourHour"?V="4H":j==="oneHour"?V="1H":j==="thirtyMin"&&(V="30M"),S({isOpen:!0,imagePath:R,description:`${V} Forecast`})}catch(R){console.error("Error opening fullscreen:",R)}},A=()=>{S(j=>({...j,isOpen:!1}))},P=(j,_,H=!1)=>{let X={...a.forecast||{daily:{notes:""},fourHour:{notes:""},oneHour:{notes:""},thirtyMin:{notes:""},customTimeframes:{},bias:"",levels:""}};if(H)X.customTimeframes||(X.customTimeframes={}),X.customTimeframes[j]={...X.customTimeframes[j],notes:_};else{let U=j;U in X&&(X[U].notes=_)}s({forecast:X})},I=(j,_)=>{s({[j]:_})},M=()=>{var j,_,H;if(!a.preTradeChecklist||Object.keys(a.preTradeChecklist).length===0){let q=d(),X=((H=(_=(j=q==null?void 0:q.settings)==null?void 0:j.drc)==null?void 0:_.checklistItems)==null?void 0:H.length)>0;return me.default.createElement(Ae,{message:"No pre-trade checklist items",subMessage:X?"Apply checklist items from plugin settings":"Add checklist items in the plugin settings",actionButtonText:X?"Apply Settings":void 0,onActionButtonClick:X?()=>{let U=q.settings.drc.checklistItems||[],Y={};U.forEach(R=>{Y[R]=!1}),s({preTradeChecklist:Y})}:void 0,iconSize:36})}return me.default.createElement("div",{className:"drc-checklist"},Object.entries(a.preTradeChecklist).map(([q,X],U)=>{let Y=`checklist-${U}-${q.replace(/\s+/g,"-")}`;return me.default.createElement("div",{key:Y,className:"drc-checklist-item",onClick:R=>{let V=R.target;V.tagName!=="INPUT"&&V.tagName!=="LABEL"&&l(q)}},me.default.createElement("input",{type:"checkbox",id:Y,checked:X||!1,onChange:()=>l(q),className:"drc-checkbox"}),me.default.createElement("label",{htmlFor:Y},q))}))},O=(j,_=!1)=>({getSectionData:()=>{var q;let H=a.forecast||{daily:{notes:""},fourHour:{notes:""},oneHour:{notes:""},thirtyMin:{notes:""},customTimeframes:{},bias:"",levels:""};if(_)return((q=H.customTimeframes)==null?void 0:q[j])||{notes:""};{let X=H[j];return typeof X=="object"&&X!==null?X:{notes:""}}},handleImageUpload:async H=>{try{return await E(H,j,_),T(j),""}catch(q){return console.error(`Error uploading image for ${j}:`,q),x(j),""}},handleNotesChange:H=>{P(j,H,_)},handleImageDelete:()=>{N(j,_)}}),F=(j,_,H=!1)=>{let q=O(j,H),X=q.getSectionData();return me.default.createElement(zw,{key:j,sectionName:j,sectionTitle:_,notes:X.notes||"",imagePath:X.imagePath,onNotesChange:q.handleNotesChange,onImageUploaded:()=>T(j),onImageDeleted:q.handleImageDelete,saveImageFunction:q.handleImageUpload,isCustom:H,className:{container:"drc-forecast-section",sectionTitle:"drc-forecast-title",notesContainer:"drc-forecast-notes",imageContainer:"drc-image-container"}})},L=()=>{let j=a.forecast||{daily:{notes:""},fourHour:{notes:""},oneHour:{notes:""},thirtyMin:{notes:""},customTimeframes:{},bias:"",levels:""},_=u(),H={Daily:"daily","4H":"fourHour","1H":"oneHour","30M":"thirtyMin"};return me.default.createElement("div",{className:"drc-note-forecast"},_.map(q=>{let X=q.replace(/\s+/g,"_").toLowerCase(),U=Object.keys(H).includes(q),Y=U?H[q]:X;return F(Y,q,!U)}),me.default.createElement("div",{className:"drc-input-group"},me.default.createElement("div",{style:{position:"relative",marginBottom:"4px"}},me.default.createElement(oa,{label:"Market Bias",value:j.bias||"",onChange:q=>{let X={...j,bias:q};s({forecast:X})},options:[{value:"Bullish",label:"Bullish"},{value:"Bearish",label:"Bearish"},{value:"Neutral",label:"Neutral"}],className:"drc-select",placeholder:"Select market bias"}),me.default.createElement("style",null,`
              .drc-container .drc-input-group .select,
              .drc-container select {
                height: 38px !important;
                min-height: 38px !important;
                box-sizing: border-box !important;
                padding-top: 0 !important;
                padding-bottom: 0 !important;
                line-height: 38px !important;
              }

              .drc-container .drc-input-group .select option,
              .drc-container select option {
                height: auto !important;
                min-height: 24px !important;
                padding: 8px !important;
                line-height: normal !important;
              }`))),me.default.createElement(r7,{forecast:j,updateData:s}))},B=()=>me.default.createElement(_w,{goals:o||null,goalStatus:a.dailyGoalStatus||{},onToggleGoal:c,title:"Daily Goals",emptyMessage:"No daily goals from previous day",emptyActionLabel:"",className:{container:"drc-weekly-goals",goalItem:"drc-checklist-item",goalCheckbox:"drc-checkbox",goalText:"drc-goal-text",completed:"completed"}});return me.default.createElement("div",{className:"drc-note-preparation"},me.default.createElement(Ka,{isOpen:k.isOpen,onClose:A,title:k.description,portalId:"drc-fullscreen-portal"},me.default.createElement("img",{src:lr.getResourceUrl(k.imagePath),alt:k.description,className:"journalit-fullscreen-image"})),me.default.createElement("div",{className:"drc-section"},B()),me.default.createElement("div",{className:"drc-section"},me.default.createElement("h3",null,"Pre-Trade Checklist"),M()),me.default.createElement("div",{className:"drc-section"},me.default.createElement("h3",null,"Key Events"),b.length>0?me.default.createElement("div",{className:"drc-weekly-events"},b.map((j,_)=>{let H=j.color?`event-color-${j.color}`:"event-color-gray";return me.default.createElement("div",{key:`event-${_}`,className:`drc-weekly-event-item ${H}`},me.default.createElement("div",{className:"drc-weekly-event-header"},me.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px"}},me.default.createElement("h4",null,j.event),!j.day&&me.default.createElement("span",{className:"drc-weekly-event-badge"},"All Week"))),j.notes&&me.default.createElement("p",null,j.notes))})):me.default.createElement(Ae,{message:"No key events for today",subMessage:"Events can be added in the weekly review",iconSize:36})),me.default.createElement("div",{className:"drc-section"},me.default.createElement("h3",null,"Daily Forecast"),L()),me.default.createElement("div",{className:"drc-section"},me.default.createElement("h3",null,"Media Links"),me.default.createElement("div",{className:"drc-media"},me.default.createElement("div",{className:"drc-input-group"},me.default.createElement("label",null,"YouTube Link"),me.default.createElement("input",{type:"text",value:a.youtubeLink||"",onChange:j=>I("youtubeLink",j.target.value),placeholder:"Link to your trading stream",className:"drc-input"})))))};var ye=$(W());var Gp=$(W()),Ww=({size:e=24,className:t=""})=>Gp.default.createElement("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t},Gp.default.createElement("rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",ry:"2"}),Gp.default.createElement("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),Gp.default.createElement("path",{d:"M20.4 14.5L16 10 4 20"}),Gp.default.createElement("line",{x1:"4",y1:"4",x2:"20",y2:"20"}));Yt();var We=$(W());var nx=$(W()),zz=$(W());function kz(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(r=kz(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Oe(){for(var e,t,r=0,n="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=kz(e))&&(n&&(n+=" "),n+=t);return n}var QE=$(Yp()),rx=$(W()),Lz=$(Az());var Nz=$(Yp()),Vr=e=>e===0?0:e>0?1:-1,hr=e=>typeof e=="number"&&e!=+e,Tl=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,ge=e=>(typeof e=="number"||e instanceof Number)&&!hr(e),Mn=e=>ge(e)||typeof e=="string",m7=0,Io=e=>{var t=++m7;return"".concat(e||"").concat(t)},di=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!ge(t)&&typeof t!="string")return n;var o;if(Tl(t)){if(r==null)return n;var a=t.indexOf("%");o=r*parseFloat(t.slice(0,a))/100}else o=+t;return hr(o)&&(o=n),i&&r!=null&&o>r&&(o=r),o},JE=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[e[n]])r[e[n]]=!0;else return!0;return!1},Fo=(e,t)=>ge(e)&&ge(t)?r=>e+r*(t-e):()=>t;function Od(e,t,r){return ge(e)&&ge(t)?e+r*(t-e):t}function Kp(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):(0,Nz.default)(n,t))===r)}var Je=e=>e===null||typeof e=="undefined",Ec=e=>Je(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));var Oz=$(W()),f7=["viewBox","children"],Iz=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],Mz=["points","pathLength"],ex={svg:f7,polygon:Mz,polyline:Mz},tx=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],Jp=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if((0,Oz.isValidElement)(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(i=>{tx.includes(i)&&(n[i]=t||(o=>r[i](r,o)))}),n},g7=(e,t,r)=>n=>(e(t,r,n),null),Nh=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(i=>{var o=e[i];tx.includes(i)&&typeof o=="function"&&(n||(n={}),n[i]=g7(o,t,r))}),n};var Fz=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",jz=null,XE=null,_z=e=>{if(e===jz&&Array.isArray(XE))return XE;var t=[];return rx.Children.forEach(e,r=>{Je(r)||((0,Lz.isFragment)(r)?t=t.concat(_z(r.props.children)):t.push(r))}),XE=t,jz=e,t};function Xp(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(i=>Fz(i)):n=[Fz(t)],_z(e).forEach(i=>{var o=(0,QE.default)(i,"type.displayName")||(0,QE.default)(i,"type.name");n.indexOf(o)!==-1&&r.push(i)}),r}var Qp=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,h7=(e,t,r,n)=>{var i,o=(i=n&&(ex===null||ex===void 0?void 0:ex[n]))!==null&&i!==void 0?i:[];return t.startsWith("data-")||typeof e!="function"&&(n&&o.includes(t)||Iz.includes(t))||r&&tx.includes(t)},Ce=(e,t,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if((0,rx.isValidElement)(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var i={};return Object.keys(n).forEach(o=>{var a;h7((a=n)===null||a===void 0?void 0:a[o],o,t,r)&&(i[o]=n[o])}),i};var v7=["children","width","height","viewBox","className","style","title","desc"];function ZE(){return ZE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ZE.apply(null,arguments)}function y7(e,t){if(e==null)return{};var r,n,i=b7(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function b7(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var eD=(0,zz.forwardRef)((e,t)=>{var{children:r,width:n,height:i,viewBox:o,className:a,style:s,title:l,desc:c}=e,d=y7(e,v7),u=o||{width:n,height:i,x:0,y:0},p=Oe("recharts-surface",a);return nx.createElement("svg",ZE({},Ce(d,!0,"svg"),{className:p,width:n,height:i,style:s,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height),ref:t}),nx.createElement("title",null,l),nx.createElement("desc",null,c),r)});var ix=$(W());var w7=["children","className"];function tD(){return tD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tD.apply(null,arguments)}function x7(e,t){if(e==null)return{};var r,n,i=k7(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function k7(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Bt=ix.forwardRef((e,t)=>{var{children:r,className:n}=e,i=x7(e,w7),o=Oe("recharts-layer",n);return ix.createElement("g",tD({className:o},Ce(i,!0),{ref:t}),r)});var rD=$(W()),$z=(0,rD.createContext)(null);var i$=$(W());function Nt(e){return function(){return e}}var nD=Math.cos;var Mh=Math.sin,On=Math.sqrt;var Id=Math.PI,UPe=Id/2,Zp=2*Id;var iD=Math.PI,oD=2*iD,Fd=1e-6,S7=oD-Fd;function Rz(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function T7(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Rz;let r=10**t;return function(n){this._+=n[0];for(let i=1,o=n.length;i<o;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}var jd=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Rz:T7(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,i){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(t,r,n,i,o,a){this._append`C${+t},${+r},${+n},${+i},${this._x1=+o},${this._y1=+a}`}arcTo(t,r,n,i,o){if(t=+t,r=+r,n=+n,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let a=this._x1,s=this._y1,l=n-t,c=i-r,d=a-t,u=s-r,p=d*d+u*u;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(p>Fd)if(!(Math.abs(u*l-c*d)>Fd)||!o)this._append`L${this._x1=t},${this._y1=r}`;else{let m=n-a,g=i-s,f=l*l+c*c,y=m*m+g*g,h=Math.sqrt(f),v=Math.sqrt(p),b=o*Math.tan((iD-Math.acos((f+p-y)/(2*h*v)))/2),w=b/v,k=b/h;Math.abs(w-1)>Fd&&this._append`L${t+w*d},${r+w*u}`,this._append`A${o},${o},0,0,${+(u*m>d*g)},${this._x1=t+k*l},${this._y1=r+k*c}`}}arc(t,r,n,i,o,a){if(t=+t,r=+r,n=+n,a=!!a,n<0)throw new Error(`negative radius: ${n}`);let s=n*Math.cos(i),l=n*Math.sin(i),c=t+s,d=r+l,u=1^a,p=a?i-o:o-i;this._x1===null?this._append`M${c},${d}`:(Math.abs(this._x1-c)>Fd||Math.abs(this._y1-d)>Fd)&&this._append`L${c},${d}`,n&&(p<0&&(p=p%oD+oD),p>S7?this._append`A${n},${n},0,1,${u},${t-s},${r-l}A${n},${n},0,1,${u},${this._x1=c},${this._y1=d}`:p>Fd&&this._append`A${n},${n},0,${+(p>=iD)},${u},${this._x1=t+n*Math.cos(o)},${this._y1=r+n*Math.sin(o)}`)}rect(t,r,n,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}};function Wz(){return new jd}Wz.prototype=jd.prototype;function em(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{let n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new jd(t)}var XPe=Array.prototype.slice;function tm(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Bz(e){this._context=e}Bz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Dc(e){return new Bz(e)}function ox(e){return e[0]}function ax(e){return e[1]}function Oh(e,t){var r=Nt(!0),n=null,i=Dc,o=null,a=em(s);e=typeof e=="function"?e:e===void 0?ox:Nt(e),t=typeof t=="function"?t:t===void 0?ax:Nt(t);function s(l){var c,d=(l=tm(l)).length,u,p=!1,m;for(n==null&&(o=i(m=a())),c=0;c<=d;++c)!(c<d&&r(u=l[c],c,l))===p&&((p=!p)?o.lineStart():o.lineEnd()),p&&o.point(+e(u,c,l),+t(u,c,l));if(m)return o=null,m+""||null}return s.x=function(l){return arguments.length?(e=typeof l=="function"?l:Nt(+l),s):e},s.y=function(l){return arguments.length?(t=typeof l=="function"?l:Nt(+l),s):t},s.defined=function(l){return arguments.length?(r=typeof l=="function"?l:Nt(!!l),s):r},s.curve=function(l){return arguments.length?(i=l,n!=null&&(o=i(n)),s):i},s.context=function(l){return arguments.length?(l==null?n=o=null:o=i(n=l),s):n},s}function rm(e,t,r){var n=null,i=Nt(!0),o=null,a=Dc,s=null,l=em(c);e=typeof e=="function"?e:e===void 0?ox:Nt(+e),t=typeof t=="function"?t:t===void 0?Nt(0):Nt(+t),r=typeof r=="function"?r:r===void 0?ax:Nt(+r);function c(u){var p,m,g,f=(u=tm(u)).length,y,h=!1,v,b=new Array(f),w=new Array(f);for(o==null&&(s=a(v=l())),p=0;p<=f;++p){if(!(p<f&&i(y=u[p],p,u))===h)if(h=!h)m=p,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),g=p-1;g>=m;--g)s.point(b[g],w[g]);s.lineEnd(),s.areaEnd()}h&&(b[p]=+e(y,p,u),w[p]=+t(y,p,u),s.point(n?+n(y,p,u):b[p],r?+r(y,p,u):w[p]))}if(v)return s=null,v+""||null}function d(){return Oh().defined(i).curve(a).context(o)}return c.x=function(u){return arguments.length?(e=typeof u=="function"?u:Nt(+u),n=null,c):e},c.x0=function(u){return arguments.length?(e=typeof u=="function"?u:Nt(+u),c):e},c.x1=function(u){return arguments.length?(n=u==null?null:typeof u=="function"?u:Nt(+u),c):n},c.y=function(u){return arguments.length?(t=typeof u=="function"?u:Nt(+u),r=null,c):t},c.y0=function(u){return arguments.length?(t=typeof u=="function"?u:Nt(+u),c):t},c.y1=function(u){return arguments.length?(r=u==null?null:typeof u=="function"?u:Nt(+u),c):r},c.lineX0=c.lineY0=function(){return d().x(e).y(t)},c.lineY1=function(){return d().x(e).y(r)},c.lineX1=function(){return d().x(n).y(t)},c.defined=function(u){return arguments.length?(i=typeof u=="function"?u:Nt(!!u),c):i},c.curve=function(u){return arguments.length?(a=u,o!=null&&(s=a(o)),c):a},c.context=function(u){return arguments.length?(u==null?o=s=null:s=a(o=u),c):o},c}var sx=class{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}};function aD(e){return new sx(e,!0)}function sD(e){return new sx(e,!1)}var nm={draw(e,t){let r=On(t/Id);e.moveTo(r,0),e.arc(0,0,r,0,Zp)}};var lD={draw(e,t){let r=On(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}};var Uz=On(1/3),C7=Uz*2,cD={draw(e,t){let r=On(t/C7),n=r*Uz;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}};var dD={draw(e,t){let r=On(t),n=-r/2;e.rect(n,n,r,r)}};var E7=.8908130915292852,Vz=Mh(Id/10)/Mh(7*Id/10),D7=Mh(Zp/10)*Vz,P7=-nD(Zp/10)*Vz,uD={draw(e,t){let r=On(t*E7),n=D7*r,i=P7*r;e.moveTo(0,-r),e.lineTo(n,i);for(let o=1;o<5;++o){let a=Zp*o/5,s=nD(a),l=Mh(a);e.lineTo(l*r,-s*r),e.lineTo(s*n-l*i,l*n+s*i)}e.closePath()}};var pD=On(3),mD={draw(e,t){let r=-On(t/(pD*3));e.moveTo(0,r*2),e.lineTo(-pD*r,-r),e.lineTo(pD*r,-r),e.closePath()}};var ya=-.5,ba=On(3)/2,fD=1/On(12),A7=(fD/2+1)*3,gD={draw(e,t){let r=On(t/A7),n=r/2,i=r*fD,o=n,a=r*fD+r,s=-o,l=a;e.moveTo(n,i),e.lineTo(o,a),e.lineTo(s,l),e.lineTo(ya*n-ba*i,ba*n+ya*i),e.lineTo(ya*o-ba*a,ba*o+ya*a),e.lineTo(ya*s-ba*l,ba*s+ya*l),e.lineTo(ya*n+ba*i,ya*i-ba*n),e.lineTo(ya*o+ba*a,ya*a-ba*o),e.lineTo(ya*s+ba*l,ya*l-ba*s),e.closePath()}};function lx(e,t){let r=null,n=em(i);e=typeof e=="function"?e:Nt(e||nm),t=typeof t=="function"?t:Nt(t===void 0?64:+t);function i(){let o;if(r||(r=o=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),o)return r=null,o+""||null}return i.type=function(o){return arguments.length?(e=typeof o=="function"?o:Nt(o),i):e},i.size=function(o){return arguments.length?(t=typeof o=="function"?o:Nt(+o),i):t},i.context=function(o){return arguments.length?(r=o==null?null:o,i):r},i}function im(){}function om(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function Hz(e){this._context=e}Hz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:om(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:om(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function hD(e){return new Hz(e)}function qz(e){this._context=e}qz.prototype={areaStart:im,areaEnd:im,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:om(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function vD(e){return new qz(e)}function Gz(e){this._context=e}Gz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:om(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function yD(e){return new Gz(e)}function Yz(e){this._context=e}Yz.prototype={areaStart:im,areaEnd:im,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function bD(e){return new Yz(e)}function Kz(e){return e<0?-1:1}function Jz(e,t,r){var n=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(n||i<0&&-0),a=(r-e._y1)/(i||n<0&&-0),s=(o*i+a*n)/(n+i);return(Kz(o)+Kz(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function Xz(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function wD(e,t,r){var n=e._x0,i=e._y0,o=e._x1,a=e._y1,s=(o-n)/3;e._context.bezierCurveTo(n+s,i+s*t,o-s,a-s*r,o,a)}function cx(e){this._context=e}cx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:wD(this,this._t0,Xz(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,wD(this,Xz(this,r=Jz(this,e,t)),r);break;default:wD(this,this._t0,r=Jz(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function Qz(e){this._context=new Zz(e)}(Qz.prototype=Object.create(cx.prototype)).point=function(e,t){cx.prototype.point.call(this,t,e)};function Zz(e){this._context=e}Zz.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,i,o){this._context.bezierCurveTo(t,e,n,r,o,i)}};function xD(e){return new cx(e)}function kD(e){return new Qz(e)}function t$(e){this._context=e}t$.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=e$(e),i=e$(t),o=0,a=1;a<r;++o,++a)this._context.bezierCurveTo(n[0][o],i[0][o],n[1][o],i[1][o],e[a],t[a]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function e$(e){var t,r=e.length-1,n,i=new Array(r),o=new Array(r),a=new Array(r);for(i[0]=0,o[0]=2,a[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,o[t]=4,a[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,o[r-1]=7,a[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/o[t-1],o[t]-=n,a[t]-=n*a[t-1];for(i[r-1]=a[r-1]/o[r-1],t=r-2;t>=0;--t)i[t]=(a[t]-i[t+1])/o[t];for(o[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}function SD(e){return new t$(e)}function dx(e,t){this._context=e,this._t=t}dx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function TD(e){return new dx(e,.5)}function CD(e){return new dx(e,0)}function ED(e){return new dx(e,1)}function wa(e,t){if((a=e.length)>1)for(var r=1,n,i,o=e[t[0]],a,s=o.length;r<a;++r)for(i=o,o=e[t[r]],n=0;n<s;++n)o[n][1]+=o[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function am(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function N7(e,t){return e[t]}function M7(e){let t=[];return t.key=e,t}function DD(){var e=Nt([]),t=am,r=wa,n=N7;function i(o){var a=Array.from(e.apply(this,arguments),M7),s,l=a.length,c=-1,d;for(let u of o)for(s=0,++c;s<l;++s)(a[s][c]=[0,+n(u,a[s].key,c,o)]).data=u;for(s=0,d=tm(t(a));s<l;++s)a[d[s]].index=s;return r(a,d),a}return i.keys=function(o){return arguments.length?(e=typeof o=="function"?o:Nt(Array.from(o)),i):e},i.value=function(o){return arguments.length?(n=typeof o=="function"?o:Nt(+o),i):n},i.order=function(o){return arguments.length?(t=o==null?am:typeof o=="function"?o:Nt(Array.from(o)),i):t},i.offset=function(o){return arguments.length?(r=o==null?wa:o,i):r},i}function PD(e,t){if((n=e.length)>0){for(var r,n,i=0,o=e[0].length,a;i<o;++i){for(a=r=0;r<n;++r)a+=e[r][i][1]||0;if(a)for(r=0;r<n;++r)e[r][i][1]/=a}wa(e,t)}}function AD(e,t){if((i=e.length)>0){for(var r=0,n=e[t[0]],i,o=n.length;r<o;++r){for(var a=0,s=0;a<i;++a)s+=e[a][r][1]||0;n[r][1]+=n[r][0]=-s/2}wa(e,t)}}function ND(e,t){if(!(!((a=e.length)>0)||!((o=(i=e[t[0]]).length)>0))){for(var r=0,n=1,i,o,a;n<o;++n){for(var s=0,l=0,c=0;s<a;++s){for(var d=e[t[s]],u=d[n][1]||0,p=d[n-1][1]||0,m=(u-p)/2,g=0;g<s;++g){var f=e[t[g]],y=f[n][1]||0,h=f[n-1][1]||0;m+=y-h}l+=u,c+=m*u}i[n-1][1]+=i[n-1][0]=r,l&&(r-=c/l)}i[n-1][1]+=i[n-1][0]=r,wa(e,t)}}var I7=["type","size","sizeType"];function MD(){return MD=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},MD.apply(null,arguments)}function r$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function n$(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?r$(Object(r),!0).forEach(function(n){F7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):r$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function F7(e,t,r){return(t=j7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function j7(e){var t=L7(e,"string");return typeof t=="symbol"?t:t+""}function L7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _7(e,t){if(e==null)return{};var r,n,i=z7(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function z7(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var o$={symbolCircle:nm,symbolCross:lD,symbolDiamond:cD,symbolSquare:dD,symbolStar:uD,symbolTriangle:mD,symbolWye:gD},$7=Math.PI/180,R7=e=>{var t="symbol".concat(Ec(e));return o$[t]||nm},W7=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*$7;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},B7=(e,t)=>{o$["symbol".concat(Ec(e))]=t},OD=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,i=_7(e,I7),o=n$(n$({},i),{},{type:t,size:r,sizeType:n}),a=()=>{var u=R7(t),p=lx().type(u).size(W7(r,n,t));return p()},{className:s,cx:l,cy:c}=o,d=Ce(o,!0);return l===+l&&c===+c&&r===+r?i$.createElement("path",MD({},d,{className:Oe("recharts-symbols",s),transform:"translate(".concat(l,", ").concat(c,")"),d:a()})):null};OD.registerSymbol=B7;var uP=$(E$());function D$(e,t,r){return t===!0?(0,uP.default)(e,r):typeof t=="function"?(0,uP.default)(e,t):e}var _$=$(j$()),mP=$(W());var L$=$(W()),Fh=(0,L$.createContext)(null);var BX=e=>e,ut=()=>{var e=(0,mP.useContext)(Fh);return e?e.store.dispatch:BX},bx=()=>{},UX=()=>bx,VX=(e,t)=>e===t;function he(e){var t=(0,mP.useContext)(Fh);return(0,_$.useSyncExternalStoreWithSelector)(t?t.subscription.addNestedSub:UX,t?t.store.getState:bx,t?t.store.getState:bx,t?e:bx,VX)}function HX(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function qX(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function GX(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){let r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var z$=e=>Array.isArray(e)?e:[e];function YX(e){let t=Array.isArray(e[0])?e[0]:e;return GX(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function KX(e,t){let r=[],{length:n}=e;for(let i=0;i<n;i++)r.push(e[i].apply(null,t));return r}var wMe=Symbol();var xMe=Object.getPrototypeOf({});var JX=class{constructor(e){this.value=e}deref(){return this.value}},XX=typeof WeakRef!="undefined"?WeakRef:JX,QX=0,$$=1;function wx(){return{s:QX,v:void 0,o:null,p:null}}function R$(e,t={}){let r=wx(),{resultEqualityCheck:n}=t,i,o=0;function a(){var u,p;let s=r,{length:l}=arguments;for(let m=0,g=l;m<g;m++){let f=arguments[m];if(typeof f=="function"||typeof f=="object"&&f!==null){let y=s.o;y===null&&(s.o=y=new WeakMap);let h=y.get(f);h===void 0?(s=wx(),y.set(f,s)):s=h}else{let y=s.p;y===null&&(s.p=y=new Map);let h=y.get(f);h===void 0?(s=wx(),y.set(f,s)):s=h}}let c=s,d;if(s.s===$$)d=s.v;else if(d=e.apply(null,arguments),o++,n){let m=(p=(u=i==null?void 0:i.deref)==null?void 0:u.call(i))!=null?p:i;m!=null&&n(m,d)&&(d=m,o!==0&&o--),i=typeof d=="object"&&d!==null||typeof d=="function"?new XX(d):d}return c.s=$$,c.v=d,d}return a.clearCache=()=>{r=wx(),a.resetResultsCount()},a.resultsCount=()=>o,a.resetResultsCount=()=>{o=0},a}function ZX(e,...t){let r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...i)=>{let o=0,a=0,s,l={},c=i.pop();typeof c=="object"&&(l=c,c=i.pop()),HX(c,`createSelector expects an output function after the inputs, but received: [${typeof c}]`);let d={...r,...l},{memoize:u,memoizeOptions:p=[],argsMemoize:m=R$,argsMemoizeOptions:g=[],devModeChecks:f={}}=d,y=z$(p),h=z$(g),v=YX(i),b=u(function(){return o++,c.apply(null,arguments)},...y),w=!0,k=m(function(){a++;let x=KX(v,arguments);return s=b.apply(null,x),s},...h);return Object.assign(k,{resultFunc:c,memoizedResultFunc:b,dependencies:v,dependencyRecomputations:()=>a,resetDependencyRecomputations:()=>{a=0},lastResult:()=>s,recomputations:()=>o,resetRecomputations:()=>{o=0},memoize:u,argsMemoize:m})};return Object.assign(n,{withTypes:()=>n}),n}var Q=ZX(R$),eQ=Object.assign((e,t=Q)=>{qX(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);let r=Object.keys(e),n=r.map(o=>e[o]);return t(n,(...o)=>o.reduce((a,s,l)=>(a[r[l]]=s,a),{}))},{withTypes:()=>eQ});var K$=$(jh()),SP=e=>e.legend.settings,J$=e=>e.legend.size,wQ=e=>e.legend.payload,FMe=Q([wQ,SP],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?(0,K$.default)(n,r):n});var kx=$(W()),xx=1;function X$(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=(0,kx.useState)({height:0,left:0,top:0,width:0}),n=(0,kx.useCallback)(i=>{if(i!=null){var o=i.getBoundingClientRect(),a={height:o.height,left:o.left,top:o.top,width:o.width};(Math.abs(a.height-t.height)>xx||Math.abs(a.left-t.left)>xx||Math.abs(a.top-t.top)>xx||Math.abs(a.width-t.width)>xx)&&r({height:a.height,left:a.left,top:a.top,width:a.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}var zZ=$(W());function Hn(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var xQ=typeof Symbol=="function"&&Symbol.observable||"@@observable",Q$=xQ,TP=()=>Math.random().toString(36).substring(7).split("").join("."),kQ={INIT:`@@redux/INIT${TP()}`,REPLACE:`@@redux/REPLACE${TP()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${TP()}`},Sx=kQ;function Tx(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function CP(e,t,r){if(typeof e!="function")throw new Error(Hn(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Hn(0));if(typeof t=="function"&&typeof r=="undefined"&&(r=t,t=void 0),typeof r!="undefined"){if(typeof r!="function")throw new Error(Hn(1));return r(CP)(e,t)}let n=e,i=t,o=new Map,a=o,s=0,l=!1;function c(){a===o&&(a=new Map,o.forEach((y,h)=>{a.set(h,y)}))}function d(){if(l)throw new Error(Hn(3));return i}function u(y){if(typeof y!="function")throw new Error(Hn(4));if(l)throw new Error(Hn(5));let h=!0;c();let v=s++;return a.set(v,y),function(){if(h){if(l)throw new Error(Hn(6));h=!1,c(),a.delete(v),o=null}}}function p(y){if(!Tx(y))throw new Error(Hn(7));if(typeof y.type=="undefined")throw new Error(Hn(8));if(typeof y.type!="string")throw new Error(Hn(17));if(l)throw new Error(Hn(9));try{l=!0,i=n(i,y)}finally{l=!1}return(o=a).forEach(v=>{v()}),y}function m(y){if(typeof y!="function")throw new Error(Hn(10));n=y,p({type:Sx.REPLACE})}function g(){let y=u;return{subscribe(h){if(typeof h!="object"||h===null)throw new Error(Hn(11));function v(){let w=h;w.next&&w.next(d())}return v(),{unsubscribe:y(v)}},[Q$](){return this}}}return p({type:Sx.INIT}),{dispatch:p,subscribe:u,getState:d,replaceReducer:m,[Q$]:g}}function SQ(e){Object.keys(e).forEach(t=>{let r=e[t];if(typeof r(void 0,{type:Sx.INIT})=="undefined")throw new Error(Hn(12));if(typeof r(void 0,{type:Sx.PROBE_UNKNOWN_ACTION()})=="undefined")throw new Error(Hn(13))})}function Cx(e){let t=Object.keys(e),r={};for(let a=0;a<t.length;a++){let s=t[a];typeof e[s]=="function"&&(r[s]=e[s])}let n=Object.keys(r),i,o;try{SQ(r)}catch(a){o=a}return function(s={},l){if(o)throw o;let c=!1,d={};for(let u=0;u<n.length;u++){let p=n[u],m=r[p],g=s[p],f=m(g,l);if(typeof f=="undefined"){let y=l&&l.type;throw new Error(Hn(14))}d[p]=f,c=c||f!==g}return c=c||n.length!==Object.keys(s).length,c?d:s}}function cm(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function Z$(...e){return t=>(r,n)=>{let i=t(r,n),o=()=>{throw new Error(Hn(15))},a={getState:i.getState,dispatch:(l,...c)=>o(l,...c)},s=e.map(l=>l(a));return o=cm(...s)(i.dispatch),{...i,dispatch:o}}}function Ex(e){return Tx(e)&&"type"in e&&typeof e.type=="string"}var oR=Symbol.for("immer-nothing"),eR=Symbol.for("immer-draftable"),jo=Symbol.for("immer-state");function Ja(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var dm=Object.getPrototypeOf;function Cl(e){return!!e&&!!e[jo]}function Xa(e){var t;return e?aR(e)||Array.isArray(e)||!!e[eR]||!!((t=e.constructor)!=null&&t[eR])||Mx(e)||Ox(e):!1}var TQ=Object.prototype.constructor.toString();function aR(e){if(!e||typeof e!="object")return!1;let t=dm(e);if(t===null)return!0;let r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===TQ}function Dx(e,t){Nx(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function Nx(e){let t=e[jo];return t?t.type_:Array.isArray(e)?1:Mx(e)?2:Ox(e)?3:0}function PP(e,t){return Nx(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function sR(e,t,r){let n=Nx(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function CQ(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Mx(e){return e instanceof Map}function Ox(e){return e instanceof Set}function _d(e){return e.copy_||e.base_}function AP(e,t){if(Mx(e))return new Map(e);if(Ox(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);let r=aR(e);if(t===!0||t==="class_only"&&!r){let n=Object.getOwnPropertyDescriptors(e);delete n[jo];let i=Reflect.ownKeys(n);for(let o=0;o<i.length;o++){let a=i[o],s=n[a];s.writable===!1&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(n[a]={configurable:!0,writable:!0,enumerable:s.enumerable,value:e[a]})}return Object.create(dm(e),n)}else{let n=dm(e);if(n!==null&&r)return{...e};let i=Object.create(n);return Object.assign(i,e)}}function Ix(e,t=!1){return Fx(e)||Cl(e)||!Xa(e)||(Nx(e)>1&&(e.set=e.add=e.clear=e.delete=EQ),Object.freeze(e),t&&Object.entries(e).forEach(([r,n])=>Ix(n,!0))),e}function EQ(){Ja(2)}function Fx(e){return Object.isFrozen(e)}var DQ={};function zd(e){let t=DQ[e];return t||Ja(0,e),t}var Lh;function lR(){return Lh}function PQ(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function tR(e,t){t&&(zd("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function NP(e){MP(e),e.drafts_.forEach(AQ),e.drafts_=null}function MP(e){e===Lh&&(Lh=e.parent_)}function rR(e){return Lh=PQ(Lh,e)}function AQ(e){let t=e[jo];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function nR(e,t){t.unfinalizedDrafts_=t.drafts_.length;let r=t.drafts_[0];return e!==void 0&&e!==r?(r[jo].modified_&&(NP(t),Ja(4)),Xa(e)&&(e=Px(t,e),t.parent_||Ax(t,e)),t.patches_&&zd("Patches").generateReplacementPatches_(r[jo].base_,e,t.patches_,t.inversePatches_)):e=Px(t,r,[]),NP(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==oR?e:void 0}function Px(e,t,r){if(Fx(t))return t;let n=t[jo];if(!n)return Dx(t,(i,o)=>iR(e,n,t,i,o,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return Ax(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;let i=n.copy_,o=i,a=!1;n.type_===3&&(o=new Set(i),i.clear(),a=!0),Dx(o,(s,l)=>iR(e,n,i,s,l,r,a)),Ax(e,i,!1),r&&e.patches_&&zd("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function iR(e,t,r,n,i,o,a){if(Cl(i)){let s=o&&t&&t.type_!==3&&!PP(t.assigned_,n)?o.concat(n):void 0,l=Px(e,i,s);if(sR(r,n,l),Cl(l))e.canAutoFreeze_=!1;else return}else a&&r.add(i);if(Xa(i)&&!Fx(i)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;Px(e,i),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&Ax(e,i)}}function Ax(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Ix(t,r)}function NQ(e,t){let r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:lR(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1},i=n,o=FP;r&&(i=[n],o=_h);let{revoke:a,proxy:s}=Proxy.revocable(i,o);return n.draft_=s,n.revoke_=a,s}var FP={get(e,t){if(t===jo)return e;let r=_d(e);if(!PP(r,t))return MQ(e,r,t);let n=r[t];return e.finalized_||!Xa(n)?n:n===EP(e.base_,t)?(DP(e),e.copy_[t]=IP(n,e)):n},has(e,t){return t in _d(e)},ownKeys(e){return Reflect.ownKeys(_d(e))},set(e,t,r){let n=cR(_d(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){let i=EP(_d(e),t),o=i==null?void 0:i[jo];if(o&&o.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(CQ(r,i)&&(r!==void 0||PP(e.base_,t)))return!0;DP(e),OP(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return EP(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,DP(e),OP(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){let r=_d(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){Ja(11)},getPrototypeOf(e){return dm(e.base_)},setPrototypeOf(){Ja(12)}},_h={};Dx(FP,(e,t)=>{_h[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});_h.deleteProperty=function(e,t){return _h.set.call(this,e,t,void 0)};_h.set=function(e,t,r){return FP.set.call(this,e[0],t,r,e[0])};function EP(e,t){let r=e[jo];return(r?_d(r):e)[t]}function MQ(e,t,r){var i;let n=cR(t,r);return n?"value"in n?n.value:(i=n.get)==null?void 0:i.call(e.draft_):void 0}function cR(e,t){if(!(t in e))return;let r=dm(e);for(;r;){let n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=dm(r)}}function OP(e){e.modified_||(e.modified_=!0,e.parent_&&OP(e.parent_))}function DP(e){e.copy_||(e.copy_=AP(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var OQ=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){let o=r;r=t;let a=this;return function(l=o,...c){return a.produce(l,d=>r.call(this,d,...c))}}typeof r!="function"&&Ja(6),n!==void 0&&typeof n!="function"&&Ja(7);let i;if(Xa(t)){let o=rR(this),a=IP(t,void 0),s=!0;try{i=r(a),s=!1}finally{s?NP(o):MP(o)}return tR(o,n),nR(i,o)}else if(!t||typeof t!="object"){if(i=r(t),i===void 0&&(i=t),i===oR&&(i=void 0),this.autoFreeze_&&Ix(i,!0),n){let o=[],a=[];zd("Patches").generateReplacementPatches_(t,i,o,a),n(o,a)}return i}else Ja(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(a,...s)=>this.produceWithPatches(a,l=>t(l,...s));let n,i;return[this.produce(t,r,(a,s)=>{n=a,i=s}),n,i]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Xa(e)||Ja(8),Cl(e)&&(e=_o(e));let t=rR(this),r=IP(e,void 0);return r[jo].isManual_=!0,MP(t),r}finishDraft(e,t){let r=e&&e[jo];(!r||!r.isManual_)&&Ja(9);let{scope_:n}=r;return tR(n,t),nR(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){let i=t[r];if(i.path.length===0&&i.op==="replace"){e=i.value;break}}r>-1&&(t=t.slice(r+1));let n=zd("Patches").applyPatches_;return Cl(e)?n(e,t):this.produce(e,i=>n(i,t))}};function IP(e,t){let r=Mx(e)?zd("MapSet").proxyMap_(e,t):Ox(e)?zd("MapSet").proxySet_(e,t):NQ(e,t);return(t?t.scope_:lR()).drafts_.push(r),r}function _o(e){return Cl(e)||Ja(10,e),dR(e)}function dR(e){if(!Xa(e)||Fx(e))return e;let t=e[jo],r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=AP(e,t.scope_.immer_.useStrictShallowCopy_)}else r=AP(e,!0);return Dx(r,(n,i)=>{sR(r,n,dR(i))}),t&&(t.finalized_=!1),r}var Lo=new OQ,zh=Lo.produce,zMe=Lo.produceWithPatches.bind(Lo),$Me=Lo.setAutoFreeze.bind(Lo),RMe=Lo.setUseStrictShallowCopy.bind(Lo),WMe=Lo.applyPatches.bind(Lo),BMe=Lo.createDraft.bind(Lo),UMe=Lo.finishDraft.bind(Lo);function uR(e){return({dispatch:r,getState:n})=>i=>o=>typeof o=="function"?o(r,n,e):i(o)}var pR=uR(),mR=uR;var IQ=typeof window!="undefined"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?cm:cm.apply(null,arguments)},XMe=typeof window!="undefined"&&window.__REDUX_DEVTOOLS_EXTENSION__?window.__REDUX_DEVTOOLS_EXTENSION__:function(){return function(e){return e}},FQ=e=>e&&typeof e.match=="function";function mn(e,t){function r(...n){if(t){let i=t(...n);if(!i)throw new Error(zo(0));return{type:e,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>Ex(n)&&n.type===e,r}var xR=class $h extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,$h.prototype)}static get[Symbol.species](){return $h}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new $h(...t[0].concat(this)):new $h(...t.concat(this))}};function fR(e){return Xa(e)?zh(e,()=>{}):e}function jx(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function jQ(e){return typeof e=="boolean"}var LQ=()=>function(t){let{thunk:r=!0,immutableCheck:n=!0,serializableCheck:i=!0,actionCreatorCheck:o=!0}=t!=null?t:{},a=new xR;return r&&(jQ(r)?a.push(pR):a.push(mR(r.extraArgument))),a},_Q="RTK_autoBatch";var gR=e=>t=>{setTimeout(t,e)},zQ=(e={type:"raf"})=>t=>(...r)=>{let n=t(...r),i=!0,o=!1,a=!1,s=new Set,l=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window!="undefined"&&window.requestAnimationFrame?window.requestAnimationFrame:gR(10):e.type==="callback"?e.queueNotification:gR(e.timeout),c=()=>{a=!1,o&&(o=!1,s.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){let u=()=>i&&d(),p=n.subscribe(u);return s.add(d),()=>{p(),s.delete(d)}},dispatch(d){var u;try{return i=!((u=d==null?void 0:d.meta)!=null&&u[_Q]),o=!i,o&&(a||(a=!0,l(c))),n.dispatch(d)}finally{i=!0}}})},$Q=e=>function(r){let{autoBatch:n=!0}=r!=null?r:{},i=new xR(e);return n&&i.push(zQ(typeof n=="object"?n:void 0)),i};function kR(e){let t=LQ(),{reducer:r=void 0,middleware:n,devTools:i=!0,duplicateMiddlewareCheck:o=!0,preloadedState:a=void 0,enhancers:s=void 0}=e||{},l;if(typeof r=="function")l=r;else if(Tx(r))l=Cx(r);else throw new Error(zo(1));let c;typeof n=="function"?c=n(t):c=t();let d=cm;i&&(d=IQ({trace:!1,...typeof i=="object"&&i}));let u=Z$(...c),p=$Q(u),m=typeof s=="function"?s(p):p(),g=d(...m);return CP(l,a,g)}function SR(e){let t={},r=[],n,i={addCase(o,a){let s=typeof o=="string"?o:o.type;if(!s)throw new Error(zo(28));if(s in t)throw new Error(zo(29));return t[s]=a,i},addMatcher(o,a){return r.push({matcher:o,reducer:a}),i},addDefaultCase(o){return n=o,i}};return e(i),[t,r,n]}function RQ(e){return typeof e=="function"}function WQ(e,t){let[r,n,i]=SR(t),o;if(RQ(e))o=()=>fR(e());else{let s=fR(e);o=()=>s}function a(s=o(),l){let c=[r[l.type],...n.filter(({matcher:d})=>d(l)).map(({reducer:d})=>d)];return c.filter(d=>!!d).length===0&&(c=[i]),c.reduce((d,u)=>{if(u)if(Cl(d)){let m=u(d,l);return m===void 0?d:m}else{if(Xa(d))return zh(d,p=>u(p,l));{let p=u(d,l);if(p===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return p}}return d},s)}return a.getInitialState=o,a}var BQ=(e,t)=>FQ(e)?e.match(t):e(t);function UQ(...e){return t=>e.some(r=>BQ(r,t))}var VQ="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",TR=(e=21)=>{let t="",r=e;for(;r--;)t+=VQ[Math.random()*64|0];return t},HQ=["name","message","stack","code"],jP=class{constructor(e,t){zu(this,"_type");this.payload=e,this.meta=t}},hR=class{constructor(e,t){zu(this,"_type");this.payload=e,this.meta=t}},qQ=e=>{if(typeof e=="object"&&e!==null){let t={};for(let r of HQ)typeof e[r]=="string"&&(t[r]=e[r]);return t}return{message:String(e)}},vR="External signal was aborted",GQ=(()=>{function e(t,r,n){let i=mn(t+"/fulfilled",(l,c,d,u)=>({payload:l,meta:{...u||{},arg:d,requestId:c,requestStatus:"fulfilled"}})),o=mn(t+"/pending",(l,c,d)=>({payload:void 0,meta:{...d||{},arg:c,requestId:l,requestStatus:"pending"}})),a=mn(t+"/rejected",(l,c,d,u,p)=>({payload:u,error:(n&&n.serializeError||qQ)(l||"Rejected"),meta:{...p||{},arg:d,requestId:c,rejectedWithValue:!!u,requestStatus:"rejected",aborted:(l==null?void 0:l.name)==="AbortError",condition:(l==null?void 0:l.name)==="ConditionError"}}));function s(l,{signal:c}={}){return(d,u,p)=>{let m=n!=null&&n.idGenerator?n.idGenerator(l):TR(),g=new AbortController,f,y;function h(b){y=b,g.abort()}c&&(c.aborted?h(vR):c.addEventListener("abort",()=>h(vR),{once:!0}));let v=async function(){var k,S;let b;try{let x=(k=n==null?void 0:n.condition)==null?void 0:k.call(n,l,{getState:u,extra:p});if(KQ(x)&&(x=await x),x===!1||g.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};let T=new Promise((E,C)=>{f=()=>{C({name:"AbortError",message:y||"Aborted"})},g.signal.addEventListener("abort",f)});d(o(m,l,(S=n==null?void 0:n.getPendingMeta)==null?void 0:S.call(n,{requestId:m,arg:l},{getState:u,extra:p}))),b=await Promise.race([T,Promise.resolve(r(l,{dispatch:d,getState:u,extra:p,requestId:m,signal:g.signal,abort:h,rejectWithValue:(E,C)=>new jP(E,C),fulfillWithValue:(E,C)=>new hR(E,C)})).then(E=>{if(E instanceof jP)throw E;return E instanceof hR?i(E.payload,m,l,E.meta):i(E,m,l)})])}catch(x){b=x instanceof jP?a(null,m,l,x.payload,x.meta):a(x,m,l)}finally{f&&g.signal.removeEventListener("abort",f)}return n&&!n.dispatchConditionRejection&&a.match(b)&&b.meta.condition||d(b),b}();return Object.assign(v,{abort:h,requestId:m,arg:l,unwrap(){return v.then(YQ)}})}}return Object.assign(s,{pending:o,rejected:a,fulfilled:i,settled:UQ(a,i),typePrefix:t})}return e.withTypes=()=>e,e})();function YQ(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}function KQ(e){return e!==null&&typeof e=="object"&&typeof e.then=="function"}var CR=Symbol.for("rtk-slice-createasyncthunk"),rOe={[CR]:GQ};function JQ(e,t){return`${e}/${t}`}function XQ({creators:e}={}){var r;let t=(r=e==null?void 0:e.asyncThunk)==null?void 0:r[CR];return function(i){let{name:o,reducerPath:a=o}=i;if(!o)throw new Error(zo(11));let s=(typeof i.reducers=="function"?i.reducers(ZQ()):i.reducers)||{},l=Object.keys(s),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(w,k){let S=typeof w=="string"?w:w.type;if(!S)throw new Error(zo(12));if(S in c.sliceCaseReducersByType)throw new Error(zo(13));return c.sliceCaseReducersByType[S]=k,d},addMatcher(w,k){return c.sliceMatchers.push({matcher:w,reducer:k}),d},exposeAction(w,k){return c.actionCreators[w]=k,d},exposeCaseReducer(w,k){return c.sliceCaseReducersByName[w]=k,d}};l.forEach(w=>{let k=s[w],S={reducerName:w,type:JQ(o,w),createNotation:typeof i.reducers=="function"};tZ(k)?nZ(S,k,d,t):eZ(S,k,d)});function u(){let[w={},k=[],S=void 0]=typeof i.extraReducers=="function"?SR(i.extraReducers):[i.extraReducers],x={...w,...c.sliceCaseReducersByType};return WQ(i.initialState,T=>{for(let E in x)T.addCase(E,x[E]);for(let E of c.sliceMatchers)T.addMatcher(E.matcher,E.reducer);for(let E of k)T.addMatcher(E.matcher,E.reducer);S&&T.addDefaultCase(S)})}let p=w=>w,m=new Map,g=new WeakMap,f;function y(w,k){return f||(f=u()),f(w,k)}function h(){return f||(f=u()),f.getInitialState()}function v(w,k=!1){function S(T){let E=T[w];return typeof E=="undefined"&&k&&(E=jx(g,S,h)),E}function x(T=p){let E=jx(m,k,()=>new WeakMap);return jx(E,T,()=>{var N;let C={};for(let[D,A]of Object.entries((N=i.selectors)!=null?N:{}))C[D]=QQ(A,T,()=>jx(g,T,h),k);return C})}return{reducerPath:w,getSelectors:x,get selectors(){return x(S)},selectSlice:S}}let b={name:o,reducer:y,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:h,...v(a),injectInto(w,{reducerPath:k,...S}={}){let x=k!=null?k:a;return w.inject({reducerPath:x,reducer:y},S),{...b,...v(x,!0)}}};return b}}function QQ(e,t,r,n){function i(o,...a){let s=t(o);return typeof s=="undefined"&&n&&(s=r()),e(s,...a)}return i.unwrapped=e,i}var vr=XQ();function ZQ(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function eZ({type:e,reducerName:t,createNotation:r},n,i){let o,a;if("reducer"in n){if(r&&!rZ(n))throw new Error(zo(17));o=n.reducer,a=n.prepare}else o=n;i.addCase(e,o).exposeCaseReducer(t,o).exposeAction(t,a?mn(e,a):mn(e))}function tZ(e){return e._reducerDefinitionType==="asyncThunk"}function rZ(e){return e._reducerDefinitionType==="reducerWithPrepare"}function nZ({type:e,reducerName:t},r,n,i){if(!i)throw new Error(zo(18));let{payloadCreator:o,fulfilled:a,pending:s,rejected:l,settled:c,options:d}=r,u=i(e,o,d);n.exposeAction(t,u),a&&n.addCase(u.fulfilled,a),s&&n.addCase(u.pending,s),l&&n.addCase(u.rejected,l),c&&n.addMatcher(u.settled,c),n.exposeCaseReducer(t,{fulfilled:a||Lx,pending:s||Lx,rejected:l||Lx,settled:c||Lx})}function Lx(){}var iZ="task",ER="listener",DR="completed",zP="cancelled",oZ=`task-${zP}`,aZ=`task-${DR}`,LP=`${ER}-${zP}`,sZ=`${ER}-${DR}`,$x=class{constructor(e){zu(this,"name","TaskAbortError");zu(this,"message");this.code=e,this.message=`${iZ} ${zP} (reason: ${e})`}},$P=(e,t)=>{if(typeof e!="function")throw new TypeError(zo(32))},_x=()=>{},PR=(e,t=_x)=>(e.catch(t),e),AR=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),$d=(e,t)=>{let r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},Rd=e=>{if(e.aborted){let{reason:t}=e;throw new $x(t)}};function NR(e,t){let r=_x;return new Promise((n,i)=>{let o=()=>i(new $x(e.reason));if(e.aborted){o();return}r=AR(e,o),t.finally(()=>r()).then(n,i)}).finally(()=>{r=_x})}var lZ=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof $x?"cancelled":"rejected",error:r}}finally{t==null||t()}},zx=e=>t=>PR(NR(e,t).then(r=>(Rd(e),r))),MR=e=>{let t=zx(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:um}=Object,yR={},Rx="listenerMiddleware",cZ=(e,t)=>{let r=n=>AR(e,()=>$d(n,e.reason));return(n,i)=>{$P(n,"taskExecutor");let o=new AbortController;r(o);let a=lZ(async()=>{Rd(e),Rd(o.signal);let s=await n({pause:zx(o.signal),delay:MR(o.signal),signal:o.signal});return Rd(o.signal),s},()=>$d(o,aZ));return i!=null&&i.autoJoin&&t.push(a.catch(_x)),{result:zx(e)(a),cancel(){$d(o,oZ)}}}},dZ=(e,t)=>{let r=async(n,i)=>{Rd(t);let o=()=>{},s=[new Promise((l,c)=>{let d=e({predicate:n,effect:(u,p)=>{p.unsubscribe(),l([u,p.getState(),p.getOriginalState()])}});o=()=>{d(),c()}})];i!=null&&s.push(new Promise(l=>setTimeout(l,i,null)));try{let l=await NR(t,Promise.race(s));return Rd(t),l}finally{o()}};return(n,i)=>PR(r(n,i))},OR=e=>{let{type:t,actionCreator:r,matcher:n,predicate:i,effect:o}=e;if(t)i=mn(t).match;else if(r)t=r.type,i=r.match;else if(n)i=n;else if(!i)throw new Error(zo(21));return $P(o,"options.listener"),{predicate:i,type:t,effect:o}},IR=um(e=>{let{type:t,predicate:r,effect:n}=OR(e);return{id:TR(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(zo(22))}}},{withTypes:()=>IR}),bR=(e,t)=>{let{type:r,effect:n,predicate:i}=OR(t);return Array.from(e.values()).find(o=>(typeof r=="string"?o.type===r:o.predicate===i)&&o.effect===n)},_P=e=>{e.pending.forEach(t=>{$d(t,LP)})},uZ=e=>()=>{e.forEach(_P),e.clear()},wR=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},FR=um(mn(`${Rx}/add`),{withTypes:()=>FR}),pZ=mn(`${Rx}/removeAll`),jR=um(mn(`${Rx}/remove`),{withTypes:()=>jR}),mZ=(...e)=>{console.error(`${Rx}/error`,...e)},El=(e={})=>{let t=new Map,{extra:r,onError:n=mZ}=e;$P(n,"onError");let i=d=>(d.unsubscribe=()=>t.delete(d.id),t.set(d.id,d),u=>{d.unsubscribe(),u!=null&&u.cancelActive&&_P(d)}),o=d=>{var p;let u=(p=bR(t,d))!=null?p:IR(d);return i(u)};um(o,{withTypes:()=>o});let a=d=>{let u=bR(t,d);return u&&(u.unsubscribe(),d.cancelActive&&_P(u)),!!u};um(a,{withTypes:()=>a});let s=async(d,u,p,m)=>{let g=new AbortController,f=dZ(o,g.signal),y=[];try{d.pending.add(g),await Promise.resolve(d.effect(u,um({},p,{getOriginalState:m,condition:(h,v)=>f(h,v).then(Boolean),take:f,delay:MR(g.signal),pause:zx(g.signal),extra:r,signal:g.signal,fork:cZ(g.signal,y),unsubscribe:d.unsubscribe,subscribe:()=>{t.set(d.id,d)},cancelActiveListeners:()=>{d.pending.forEach((h,v,b)=>{h!==g&&($d(h,LP),b.delete(h))})},cancel:()=>{$d(g,LP),d.pending.delete(g)},throwIfCancelled:()=>{Rd(g.signal)}})))}catch(h){h instanceof $x||wR(n,h,{raisedBy:"effect"})}finally{await Promise.all(y),$d(g,sZ),d.pending.delete(g)}},l=uZ(t);return{middleware:d=>u=>p=>{if(!Ex(p))return u(p);if(FR.match(p))return o(p.payload);if(pZ.match(p)){l();return}if(jR.match(p))return a(p.payload);let m=d.getState(),g=()=>{if(m===yR)throw new Error(zo(23));return m},f;try{if(f=u(p),t.size>0){let y=d.getState(),h=Array.from(t.values());for(let v of h){let b=!1;try{b=v.predicate(p,y,m)}catch(w){b=!1,wR(n,w,{raisedBy:"predicate"})}b&&s(v,p,d,g)}}}finally{m=yR}return f},startListening:o,stopListening:a,clearListeners:l}};var iOe=Symbol.for("rtk-state-proxy-original");function zo(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var fZ={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},LR=vr({name:"chartLayout",initialState:fZ,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){e.margin.top=t.payload.top,e.margin.right=t.payload.right,e.margin.bottom=t.payload.bottom,e.margin.left=t.payload.left},setScale(e,t){e.scale=t.payload}}}),{setMargin:_R,setLayout:zR,setChartSize:$R,setScale:RR}=LR.actions,WR=LR.reducer;var d5=$(Yp());var YR=$(jh()),KR=$(Yp());var yZ=$(W());function BR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function UR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BR(Object(r),!0).forEach(function(n){gZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gZ(e,t,r){return(t=hZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hZ(e){var t=vZ(e,"string");return typeof t=="symbol"?t:t+""}function vZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rh=Math.PI/180;var bZ=e=>e*180/Math.PI,Lr=(e,t,r,n)=>({x:e+Math.cos(-Rh*n)*r,y:t+Math.sin(-Rh*n)*r}),VR=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},wZ=(e,t)=>{var{x:r,y:n}=e,{x:i,y:o}=t;return Math.sqrt((r-i)**2+(n-o)**2)},xZ=(e,t)=>{var{x:r,y:n}=e,{cx:i,cy:o}=t,a=wZ({x:r,y:n},{x:i,y:o});if(a<=0)return{radius:a,angle:0};var s=(r-i)/a,l=Math.acos(s);return n>o&&(l=2*Math.PI-l),{radius:a,angle:bZ(l),angleInRadian:l}},kZ=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),i=Math.floor(r/360),o=Math.min(n,i);return{startAngle:t-o*360,endAngle:r-o*360}},SZ=(e,t)=>{var{startAngle:r,endAngle:n}=t,i=Math.floor(r/360),o=Math.floor(n/360),a=Math.min(i,o);return e+a*360},HR=(e,t)=>{var{x:r,y:n}=e,{radius:i,angle:o}=xZ({x:r,y:n},t),{innerRadius:a,outerRadius:s}=t;if(i<a||i>s||i===0)return null;var{startAngle:l,endAngle:c}=kZ(t),d=o,u;if(l<=c){for(;d>c;)d-=360;for(;d<l;)d+=360;u=d>=l&&d<=c}else{for(;d>l;)d-=360;for(;d<c;)d+=360;u=d>=c&&d<=l}return u?UR(UR({},t),{},{radius:i,angle:SZ(d,t)}):null};function qR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function xa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qR(Object(r),!0).forEach(function(n){TZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function TZ(e,t,r){return(t=CZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CZ(e){var t=EZ(e,"string");return typeof t=="symbol"?t:t+""}function EZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yr(e,t,r){return Je(e)||Je(t)?r:Mn(t)?(0,KR.default)(e,t,r):typeof t=="function"?t(e):r}var JR=(e,t,r,n,i)=>{var o,a=-1,s=(o=t==null?void 0:t.length)!==null&&o!==void 0?o:0;if(s<=1||e==null)return 0;if(n==="angleAxis"&&i!=null&&Math.abs(Math.abs(i[1]-i[0])-360)<=1e-6)for(var l=0;l<s;l++){var c=l>0?r[l-1].coordinate:r[s-1].coordinate,d=r[l].coordinate,u=l>=s-1?r[0].coordinate:r[l+1].coordinate,p=void 0;if(Vr(d-c)!==Vr(u-d)){var m=[];if(Vr(u-d)===Vr(i[1]-i[0])){p=u;var g=d+i[1]-i[0];m[0]=Math.min(g,(g+c)/2),m[1]=Math.max(g,(g+c)/2)}else{p=c;var f=u+i[1]-i[0];m[0]=Math.min(d,(f+d)/2),m[1]=Math.max(d,(f+d)/2)}var y=[Math.min(d,(p+d)/2),Math.max(d,(p+d)/2)];if(e>y[0]&&e<=y[1]||e>=m[0]&&e<=m[1]){({index:a}=r[l]);break}}else{var h=Math.min(c,u),v=Math.max(c,u);if(e>(h+d)/2&&e<=(v+d)/2){({index:a}=r[l]);break}}}else if(t){for(var b=0;b<s;b++)if(b===0&&e<=(t[b].coordinate+t[b+1].coordinate)/2||b>0&&b<s-1&&e>(t[b].coordinate+t[b-1].coordinate)/2&&e<=(t[b].coordinate+t[b+1].coordinate)/2||b===s-1&&e>(t[b].coordinate+t[b-1].coordinate)/2){({index:a}=t[b]);break}}return a},XR=(e,t,r)=>{if(t&&r){var{width:n,height:i}=r,{align:o,verticalAlign:a,layout:s}=t;if((s==="vertical"||s==="horizontal"&&a==="middle")&&o!=="center"&&ge(e[o]))return xa(xa({},e),{},{[o]:e[o]+(n||0)});if((s==="horizontal"||s==="vertical"&&o==="center")&&a!=="middle"&&ge(e[a]))return xa(xa({},e),{},{[a]:e[a]+(i||0)})}return e},eo=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",RP=(e,t,r,n)=>{if(n)return e.map(s=>s.coordinate);var i,o,a=e.map(s=>(s.coordinate===t&&(i=!0),s.coordinate===r&&(o=!0),s.coordinate));return i||a.push(t),o||a.push(r),a},WP=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:i,range:o,scale:a,realScaleType:s,isCategorical:l,categoricalDomain:c,tickCount:d,ticks:u,niceTicks:p,axisType:m}=e;if(!a)return null;var g=s==="scaleBand"&&a.bandwidth?a.bandwidth()/2:2,f=(t||r)&&i==="category"&&a.bandwidth?a.bandwidth()/g:0;if(f=m==="angleAxis"&&o&&o.length>=2?Vr(o[0]-o[1])*2*f:f,t&&(u||p)){var y=(u||p||[]).map((h,v)=>{var b=n?n.indexOf(h):h;return{coordinate:a(b)+f,value:h,offset:f,index:v}});return y.filter(h=>!hr(h.coordinate))}return l&&c?c.map((h,v)=>({coordinate:a(h)+f,value:h,index:v,offset:f})):a.ticks&&!r&&d!=null?a.ticks(d).map((h,v)=>({coordinate:a(h)+f,value:h,offset:f,index:v})):a.domain().map((h,v)=>({coordinate:a(h)+f,value:n?n[h]:h,index:v,offset:f}))},GR=1e-4,QR=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),i=Math.min(n[0],n[1])-GR,o=Math.max(n[0],n[1])+GR,a=e(t[0]),s=e(t[r-1]);(a<i||a>o||s<i||s>o)&&e.domain([t[0],t[r-1]])}},ZR=(e,t)=>{if(!t||t.length!==2||!ge(t[0])||!ge(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),i=[e[0],e[1]];return(!ge(e[0])||e[0]<r)&&(i[0]=r),(!ge(e[1])||e[1]>n)&&(i[1]=n),i[0]>n&&(i[0]=n),i[1]<r&&(i[1]=r),i},DZ=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var i=0,o=0,a=0;a<t;++a){var s=hr(e[a][r][1])?e[a][r][0]:e[a][r][1];s>=0?(e[a][r][0]=i,e[a][r][1]=i+s,i=e[a][r][1]):(e[a][r][0]=o,e[a][r][1]=o+s,o=e[a][r][1])}},PZ=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var i=0,o=0;o<t;++o){var a=hr(e[o][r][1])?e[o][r][0]:e[o][r][1];a>=0?(e[o][r][0]=i,e[o][r][1]=i+a,i=e[o][r][1]):(e[o][r][0]=0,e[o][r][1]=0)}},AZ={sign:DZ,expand:PD,none:wa,silhouette:AD,wiggle:ND,positive:PZ},e5=(e,t,r)=>{var n=AZ[r],i=DD().keys(t).value((o,a)=>+yr(o,a,0)).order(am).offset(n);return i(e)};function pm(e){return e==null?void 0:String(e)}function mm(e){var{axis:t,ticks:r,bandSize:n,entry:i,index:o,dataKey:a}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Je(i[t.dataKey])){var s=Kp(r,"value",i[t.dataKey]);if(s)return s.coordinate+n/2}return r[o]?r[o].coordinate+n/2:null}var l=yr(i,Je(a)?t.dataKey:a);return Je(l)?null:t.scale(l)}var BP=e=>{var{axis:t,ticks:r,offset:n,bandSize:i,entry:o,index:a}=e;if(t.type==="category")return r[a]?r[a].coordinate+n:null;var s=yr(o,t.dataKey,t.scale.domain()[a]);return Je(s)?null:t.scale(s)-i/2+n},t5=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]);return n<=0&&i>=0?0:i<0?i:n}return r[0]},NZ=e=>{var t=e.flat(2).filter(ge);return[Math.min(...t),Math.max(...t)]},MZ=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],r5=(e,t,r)=>{if(e!=null)return MZ(Object.keys(e).reduce((n,i)=>{var o=e[i],{stackedData:a}=o,s=a.reduce((l,c)=>{var d=NZ(c.slice(t,r+1));return[Math.min(l[0],d[0]),Math.max(l[1],d[1])]},[1/0,-1/0]);return[Math.min(s[0],n[0]),Math.max(s[1],n[1])]},[1/0,-1/0]))},UP=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,VP=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Qa=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var i=(0,YR.default)(t,d=>d.coordinate),o=1/0,a=1,s=i.length;a<s;a++){var l=i[a],c=i[a-1];o=Math.min((l.coordinate||0)-(c.coordinate||0),o)}return o===1/0?0:o}return r?void 0:0};function HP(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:i,name:o}=e;return xa(xa({},t),{},{dataKey:r,payload:n,value:i,name:o})}function Dl(e,t){if(e)return String(e);if(typeof t=="string")return t}function n5(e,t,r,n,i){if(r==="horizontal"||r==="vertical"){var o=e>=i.left&&e<=i.left+i.width&&t>=i.top&&t<=i.top+i.height;return o?{x:e,y:t}:null}return n?HR({x:e,y:t},n):null}var i5=(e,t,r,n)=>{var i=t.find(c=>c&&c.index===r);if(i){if(e==="horizontal")return{x:i.coordinate,y:n.y};if(e==="vertical")return{x:n.x,y:i.coordinate};if(e==="centric"){var o=i.coordinate,{radius:a}=n;return xa(xa(xa({},n),Lr(n.cx,n.cy,a,o)),{},{angle:o,radius:a})}var s=i.coordinate,{angle:l}=n;return xa(xa(xa({},n),Lr(n.cx,n.cy,s,l)),{},{angle:l,radius:s})}return{x:0,y:0}},o5=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius;var to=e=>e.layout.width,ro=e=>e.layout.height,a5=e=>e.layout.scale,Wx=e=>e.layout.margin;var Wh=Q(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),Bh=Q(e=>e.cartesianAxis.yAxis,e=>Object.values(e));var s5="data-recharts-item-index",l5="data-recharts-item-data-key",fm=60;function c5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Pc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c5(Object(r),!0).forEach(function(n){OZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function OZ(e,t,r){return(t=IZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IZ(e){var t=FZ(e,"string");return typeof t=="symbol"?t:t+""}function FZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jZ=e=>e.brush.height,cr=Q([to,ro,Wx,jZ,Wh,Bh,SP,J$],(e,t,r,n,i,o,a,s)=>{var l=o.reduce((g,f)=>{var{orientation:y}=f;if(!f.mirror&&!f.hide){var h=typeof f.width=="number"?f.width:fm;return Pc(Pc({},g),{},{[y]:g[y]+h})}return g},{left:r.left||0,right:r.right||0}),c=i.reduce((g,f)=>{var{orientation:y}=f;return!f.mirror&&!f.hide?Pc(Pc({},g),{},{[y]:(0,d5.default)(g,"".concat(y))+f.height}):g},{top:r.top||0,bottom:r.bottom||0}),d=Pc(Pc({},c),l),u=d.bottom;d.bottom+=n,d=XR(d,a,s);var p=e-d.left-d.right,m=t-d.top-d.bottom;return Pc(Pc({brushBottom:u},d),{},{width:Math.max(p,0),height:Math.max(m,0)})}),u5=Q(cr,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),Bx=Q(to,ro,(e,t)=>({x:0,y:0,width:e,height:t}));var LZ=$(W()),Ux=$(W()),_Z=(0,Ux.createContext)(null),yt=()=>(0,Ux.useContext)(_Z)!=null;var gm=e=>e.brush,Wd=Q([gm,cr,Wx],(e,t,r)=>({height:e.height,x:ge(e.x)?e.x:t.left,y:ge(e.y)?e.y:t.top+t.height+t.brushBottom-((r==null?void 0:r.bottom)||0),width:ge(e.width)?e.width:t.width}));var Ac=()=>{var e,t=yt(),r=he(u5),n=he(Wd),i=(e=he(gm))===null||e===void 0?void 0:e.padding;return!t||!n||!i?r:{width:n.width-i.left-i.right,height:n.height-i.top-i.bottom,x:i.left,y:i.top}},$Z={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},ka=()=>{var e;return(e=he(cr))!==null&&e!==void 0?e:$Z},Vx=()=>he(to),Hx=()=>he(ro);var et=e=>e.layout.layoutType,$s=()=>he(et);var RZ={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},p5=vr({name:"legend",initialState:RZ,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var r=_o(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)}}}),{setLegendSize:BOe,setLegendSettings:UOe,addLegendPayload:m5,removeLegendPayload:f5}=p5.actions,g5=p5.reducer;var Ea=$(W()),a3=$(W()),s3=$(ul());var Za=$(W()),v5=$(jh());function GP(){return GP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},GP.apply(null,arguments)}function h5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function qP(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?h5(Object(r),!0).forEach(function(n){WZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function WZ(e,t,r){return(t=BZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BZ(e){var t=UZ(e,"string");return typeof t=="symbol"?t:t+""}function UZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function VZ(e){return Array.isArray(e)&&Mn(e[0])&&Mn(e[1])?e.join(" ~ "):e}var y5=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:i={},payload:o,formatter:a,itemSorter:s,wrapperClassName:l,labelClassName:c,label:d,labelFormatter:u,accessibilityLayer:p=!1}=e,m=()=>{if(o&&o.length){var k={padding:0,margin:0},S=(s?(0,v5.default)(o,s):o).map((x,T)=>{if(x.type==="none")return null;var E=x.formatter||a||VZ,{value:C,name:N}=x,D=C,A=N;if(E){var P=E(C,N,x,T,o);if(Array.isArray(P))[D,A]=P;else if(P!=null)D=P;else return null}var I=qP({display:"block",paddingTop:4,paddingBottom:4,color:x.color||"#000"},n);return Za.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(T),style:I},Mn(A)?Za.createElement("span",{className:"recharts-tooltip-item-name"},A):null,Mn(A)?Za.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,Za.createElement("span",{className:"recharts-tooltip-item-value"},D),Za.createElement("span",{className:"recharts-tooltip-item-unit"},x.unit||""))});return Za.createElement("ul",{className:"recharts-tooltip-item-list",style:k},S)}return null},g=qP({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),f=qP({margin:0},i),y=!Je(d),h=y?d:"",v=Oe("recharts-default-tooltip",l),b=Oe("recharts-tooltip-label",c);y&&u&&o!==void 0&&o!==null&&(h=u(d,o));var w=p?{role:"status","aria-live":"assertive"}:{};return Za.createElement("div",GP({className:v,style:g},w),Za.createElement("p",{className:b,style:f},Za.isValidElement(h)?h:"".concat(h)),m())};var k5=$(W()),S5=$(W());var Uh="recharts-tooltip-wrapper",HZ={visibility:"hidden"};function qZ(e){var{coordinate:t,translateX:r,translateY:n}=e;return Oe(Uh,{["".concat(Uh,"-right")]:ge(r)&&t&&ge(t.x)&&r>=t.x,["".concat(Uh,"-left")]:ge(r)&&t&&ge(t.x)&&r<t.x,["".concat(Uh,"-bottom")]:ge(n)&&t&&ge(t.y)&&n>=t.y,["".concat(Uh,"-top")]:ge(n)&&t&&ge(t.y)&&n<t.y})}function b5(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:i,position:o,reverseDirection:a,tooltipDimension:s,viewBox:l,viewBoxDimension:c}=e;if(o&&ge(o[n]))return o[n];var d=r[n]-s-(i>0?i:0),u=r[n]+i;if(t[n])return a[n]?d:u;var p=l[n];if(p==null)return 0;if(a[n]){var m=d,g=p;return m<g?Math.max(u,p):Math.max(d,p)}if(c==null)return 0;var f=u+s,y=p+c;return f>y?Math.max(d,p):Math.max(u,p)}function GZ(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function w5(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:i,reverseDirection:o,tooltipBox:a,useTranslate3d:s,viewBox:l}=e,c,d,u;return a.height>0&&a.width>0&&r?(d=b5({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:i,reverseDirection:o,tooltipDimension:a.width,viewBox:l,viewBoxDimension:l.width}),u=b5({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:i,reverseDirection:o,tooltipDimension:a.height,viewBox:l,viewBoxDimension:l.height}),c=GZ({translateX:d,translateY:u,useTranslate3d:s})):c=HZ,{cssProperties:c,cssClasses:qZ({translateX:d,translateY:u,coordinate:r})}}function x5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function qx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?x5(Object(r),!0).forEach(function(n){YP(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function YP(e,t,r){return(t=YZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YZ(e){var t=KZ(e,"string");return typeof t=="symbol"?t:t+""}function KZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Gx=class extends S5.PureComponent{constructor(){super(...arguments),YP(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),YP(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,i,o;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(i=(o=this.props.coordinate)===null||o===void 0?void 0:o.y)!==null&&i!==void 0?i:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:i,children:o,coordinate:a,hasPayload:s,isAnimationActive:l,offset:c,position:d,reverseDirection:u,useTranslate3d:p,viewBox:m,wrapperStyle:g,lastBoundingBox:f,innerRef:y,hasPortalFromProps:h}=this.props,{cssClasses:v,cssProperties:b}=w5({allowEscapeViewBox:r,coordinate:a,offsetTopLeft:c,position:d,reverseDirection:u,tooltipBox:{height:f.height,width:f.width},useTranslate3d:p,viewBox:m}),w=h?{}:qx(qx({transition:l&&t?"transform ".concat(n,"ms ").concat(i):void 0},b),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&s?"visible":"hidden",position:"absolute",top:0,left:0}),k=qx(qx({},w),{},{visibility:!this.state.dismissed&&t&&s?"visible":"hidden"},g);return k5.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:v,style:k,ref:y},o)}};var JZ=()=>!(typeof window!="undefined"&&window.document&&window.document.createElement&&window.setTimeout),no={isSsr:JZ()};var Yx=()=>he(e=>e.rootProps.accessibilityLayer);var RB=$(W()),Rm=$(W());var D5=$(W());function br(e){return Number.isFinite(e)}function hm(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function KP(){return KP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},KP.apply(null,arguments)}function T5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function C5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?T5(Object(r),!0).forEach(function(n){XZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XZ(e,t,r){return(t=QZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QZ(e){var t=ZZ(e,"string");return typeof t=="symbol"?t:t+""}function ZZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var E5={curveBasisClosed:vD,curveBasisOpen:yD,curveBasis:hD,curveBumpX:aD,curveBumpY:sD,curveLinearClosed:bD,curveLinear:Dc,curveMonotoneX:xD,curveMonotoneY:kD,curveNatural:SD,curveStep:TD,curveStepAfter:ED,curveStepBefore:CD},Kx=e=>br(e.x)&&br(e.y),Vh=e=>e.x,Hh=e=>e.y,eee=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(Ec(e));return(r==="curveMonotone"||r==="curveBump")&&t?E5["".concat(r).concat(t==="vertical"?"Y":"X")]:E5[r]||Dc},tee=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:i,connectNulls:o=!1}=e,a=eee(t,i),s=o?r.filter(Kx):r,l;if(Array.isArray(n)){var c=o?n.filter(u=>Kx(u)):n,d=s.map((u,p)=>C5(C5({},u),{},{base:c[p]}));return i==="vertical"?l=rm().y(Hh).x1(Vh).x0(u=>u.base.x):l=rm().x(Vh).y1(Hh).y0(u=>u.base.y),l.defined(Kx).curve(a),l(d)}return i==="vertical"&&ge(n)?l=rm().y(Hh).x1(Vh).x0(n):ge(n)?l=rm().x(Vh).y1(Hh).y0(n):l=Oh().x(Vh).y(Hh),l.defined(Kx).curve(a),l(s)},Nc=e=>{var{className:t,points:r,path:n,pathRef:i}=e;if((!r||!r.length)&&!n)return null;var o=r&&r.length?tee(e):n;return D5.createElement("path",KP({},Ce(e,!1),Jp(e),{className:Oe("recharts-curve",t),d:o===null?void 0:o,ref:i}))};var A5=$(W());var ree=["x","y","top","left","width","height","className"];function JP(){return JP=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},JP.apply(null,arguments)}function P5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function nee(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?P5(Object(r),!0).forEach(function(n){iee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iee(e,t,r){return(t=oee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oee(e){var t=aee(e,"string");return typeof t=="symbol"?t:t+""}function aee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function see(e,t){if(e==null)return{};var r,n,i=lee(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function lee(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var cee=(e,t,r,n,i,o)=>"M".concat(e,",").concat(i,"v").concat(n,"M").concat(o,",").concat(t,"h").concat(r),N5=e=>{var{x:t=0,y:r=0,top:n=0,left:i=0,width:o=0,height:a=0,className:s}=e,l=see(e,ree),c=nee({x:t,y:r,top:n,left:i,width:o,height:a},l);return!ge(t)||!ge(r)||!ge(o)||!ge(a)||!ge(n)||!ge(i)?null:A5.createElement("path",JP({},Ce(c,!0),{className:Oe("recharts-cross",s),d:cee(t,r,o,a,n,i)}))};function M5(e,t,r,n){var i=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-i:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-i,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}var Kh=$(W()),ym=$(W());function O5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function dee(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O5(Object(r),!0).forEach(function(n){uee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uee(e,t,r){return(t=pee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pee(e){var t=mee(e,"string");return typeof t=="symbol"?t:t+""}function mee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function en(e,t){var r=dee({},e),n=t,i=Object.keys(t),o=i.reduce((a,s)=>(a[s]===void 0&&n[s]!==void 0&&(a[s]=n[s]),a),r);return o}var nA=$(W()),Sa=$(W()),r4=$(W5());function B5(e){var t={},r=()=>null,n=!1,i=null,o=a=>{if(!n){if(Array.isArray(a)){if(!a.length)return;var s=a,[l,...c]=s;if(typeof l=="number"){i=e.setTimeout(o.bind(null,c),l);return}o(l),i=e.setTimeout(o.bind(null,c));return}typeof a=="object"&&(t=a,r(t)),typeof a=="function"&&a()}};return{stop:()=>{n=!0},start:a=>{n=!1,i&&(i(),i=null),o(a)},subscribe:a=>(r=a,()=>{r=()=>null}),getTimeoutController:()=>e}}var Jx=1e-4,H5=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],q5=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),U5=(e,t)=>r=>{var n=H5(e,t);return q5(n,r)},xee=(e,t)=>r=>{var n=H5(e,t),i=[...n.map((o,a)=>o*a).slice(1),0];return q5(i,r)},V5=function(){for(var t,r,n,i,o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];if(a.length===1)switch(a[0]){case"linear":[t,n,r,i]=[0,0,1,1];break;case"ease":[t,n,r,i]=[.25,.1,.25,1];break;case"ease-in":[t,n,r,i]=[.42,0,1,1];break;case"ease-out":[t,n,r,i]=[.42,0,.58,1];break;case"ease-in-out":[t,n,r,i]=[0,0,.58,1];break;default:{var l=a[0].split("(");l[0]==="cubic-bezier"&&l[1].split(")")[0].split(",").length===4&&([t,n,r,i]=l[1].split(")")[0].split(",").map(g=>parseFloat(g)))}}else a.length===4&&([t,n,r,i]=a);var c=U5(t,r),d=U5(n,i),u=xee(t,r),p=g=>g>1?1:g<0?0:g,m=g=>{for(var f=g>1?1:g,y=f,h=0;h<8;++h){var v=c(y)-f,b=u(y);if(Math.abs(v-f)<Jx||b<Jx)return d(y);y=p(y-v/b)}return d(y)};return m.isStepper=!1,m},kee=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:i=17}=t,o=(a,s,l)=>{var c=-(a-s)*r,d=l*n,u=l+(c-d)*i/1e3,p=l*i/1e3+a;return Math.abs(p-s)<Jx&&Math.abs(u)<Jx?[s,0]:[p,u]};return o.isStepper=!0,o.dt=i,o},G5=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return V5(e);case"spring":return kee();default:if(e.split("(")[0]==="cubic-bezier")return V5(e)}return typeof e=="function"?e:null};function Y5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function K5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Y5(Object(r),!0).forEach(function(n){See(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Y5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function See(e,t,r){return(t=Tee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tee(e){var t=Cee(e,"string");return typeof t=="symbol"?t:t+""}function Cee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Eee=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),J5=(e,t,r)=>e.map(n=>"".concat(Eee(n)," ").concat(t,"ms ").concat(r)).join(","),X5=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(i=>n.includes(i))),vm=(e,t)=>Object.keys(t).reduce((r,n)=>K5(K5({},r),{},{[n]:e(n,t[n])}),{});function Q5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function qn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Q5(Object(r),!0).forEach(function(n){Dee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Dee(e,t,r){return(t=Pee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pee(e){var t=Aee(e,"string");return typeof t=="symbol"?t:t+""}function Aee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Xx=(e,t,r)=>e+(t-e)*r,tA=e=>{var{from:t,to:r}=e;return t!==r},Z5=(e,t,r)=>{var n=vm((i,o)=>{if(tA(o)){var[a,s]=e(o.from,o.to,o.velocity);return qn(qn({},o),{},{from:a,velocity:s})}return o},t);return r<1?vm((i,o)=>tA(o)?qn(qn({},o),{},{velocity:Xx(o.velocity,n[i].velocity,r),from:Xx(o.from,n[i].from,r)}):o,t):Z5(e,n,r-1)};function Nee(e,t,r,n,i,o){var a,s=n.reduce((p,m)=>qn(qn({},p),{},{[m]:{from:e[m],velocity:0,to:t[m]}}),{}),l=()=>vm((p,m)=>m.from,s),c=()=>!Object.values(s).filter(tA).length,d=null,u=p=>{a||(a=p);var m=p-a,g=m/r.dt;s=Z5(r,s,g),i(qn(qn(qn({},e),t),l())),a=p,c()||(d=o.setTimeout(u))};return()=>(d=o.setTimeout(u),()=>{d()})}function Mee(e,t,r,n,i,o,a){var s=null,l=i.reduce((u,p)=>qn(qn({},u),{},{[p]:[e[p],t[p]]}),{}),c,d=u=>{c||(c=u);var p=(u-c)/n,m=vm((f,y)=>Xx(...y,r(p)),l);if(o(qn(qn(qn({},e),t),m)),p<1)s=a.setTimeout(d);else{var g=vm((f,y)=>Xx(...y,r(1)),l);o(qn(qn(qn({},e),t),g))}};return()=>(s=a.setTimeout(d),()=>{s()})}var e4=(e,t,r,n,i,o)=>{var a=X5(e,t);return r.isStepper===!0?Nee(e,t,r,a,i,o):Mee(e,t,r,n,a,i,o)};var Qx=class{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),i=null,o=a=>{a-n>=r?t(a):typeof requestAnimationFrame=="function"&&(i=requestAnimationFrame(o))};return i=requestAnimationFrame(o),()=>{cancelAnimationFrame(i)}}};var Oee=["children","begin","duration","attributeName","easing","isActive","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart","animationManager"];function rA(){return rA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rA.apply(null,arguments)}function Iee(e,t){if(e==null)return{};var r,n,i=Fee(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Fee(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function t4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Mc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?t4(Object(r),!0).forEach(function(n){Bd(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Bd(e,t,r){return(t=jee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jee(e){var t=Lee(e,"string");return typeof t=="symbol"?t:t+""}function Lee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _ee(){return B5(new Qx)}var Yh=class extends Sa.PureComponent{constructor(t,r){super(t,r),Bd(this,"mounted",!1),Bd(this,"manager",null),Bd(this,"stopJSAnimation",null),Bd(this,"unSubscribe",null);var{isActive:n,attributeName:i,from:o,to:a,children:s,duration:l,animationManager:c}=this.props;if(this.manager=c,this.handleStyleChange=this.handleStyleChange.bind(this),this.changeStyle=this.changeStyle.bind(this),!n||l<=0){this.state={style:{}},typeof s=="function"&&(this.state={style:a});return}if(o){if(typeof s=="function"){this.state={style:o};return}this.state={style:i?{[i]:o}:o}}else this.state={style:{}}}componentDidMount(){var{isActive:t,canBegin:r}=this.props;this.mounted=!0,!(!t||!r)&&this.runAnimation(this.props)}componentDidUpdate(t){var{isActive:r,canBegin:n,attributeName:i,shouldReAnimate:o,to:a,from:s}=this.props,{style:l}=this.state;if(n){if(!r){var c={style:i?{[i]:a}:a};this.state&&l&&(i&&l[i]!==a||!i&&l!==a)&&this.setState(c);return}if(!((0,r4.default)(t.to,a)&&t.canBegin&&t.isActive)){var d=!t.canBegin||!t.isActive;this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var u=d||o?s:t.to;if(this.state&&l){var p={style:i?{[i]:u}:u};(i&&l[i]!==u||!i&&l!==u)&&this.setState(p)}this.runAnimation(Mc(Mc({},this.props),{},{from:u,begin:0}))}}}componentWillUnmount(){this.mounted=!1;var{onAnimationEnd:t}=this.props;this.unSubscribe&&this.unSubscribe(),this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation(),t&&t()}handleStyleChange(t){this.changeStyle(t)}changeStyle(t){this.mounted&&this.setState({style:t})}runJSAnimation(t){var{from:r,to:n,duration:i,easing:o,begin:a,onAnimationEnd:s,onAnimationStart:l}=t,c=e4(r,n,G5(o),i,this.changeStyle,this.manager.getTimeoutController()),d=()=>{this.stopJSAnimation=c()};this.manager.start([l,a,d,i,s])}runAnimation(t){var{begin:r,duration:n,attributeName:i,to:o,easing:a,onAnimationStart:s,onAnimationEnd:l,children:c}=t;if(this.unSubscribe=this.manager.subscribe(this.handleStyleChange),typeof a=="function"||typeof c=="function"||a==="spring"){this.runJSAnimation(t);return}var d=i?{[i]:o}:o,u=J5(Object.keys(d),n,a);this.manager.start([s,r,Mc(Mc({},d),{},{transition:u}),n,l])}render(){var t=this.props,{children:r,begin:n,duration:i,attributeName:o,easing:a,isActive:s,from:l,to:c,canBegin:d,onAnimationEnd:u,shouldReAnimate:p,onAnimationReStart:m,animationManager:g}=t,f=Iee(t,Oee),y=Sa.Children.count(r),h=this.state.style;if(typeof r=="function")return r(h);if(!s||y===0||i<=0)return r;var v=b=>{var{style:w={},className:k}=b.props,S=(0,Sa.cloneElement)(b,Mc(Mc({},f),{},{style:Mc(Mc({},w),h),className:k}));return S};return y===1?v(Sa.Children.only(r)):nA.createElement("div",null,Sa.Children.map(r,b=>v(b)))}};Bd(Yh,"displayName","Animate");Bd(Yh,"defaultProps",{begin:0,duration:1e3,attributeName:"",easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}});var zee=(0,Sa.createContext)(null);function io(e){var t,r,n=(0,Sa.useContext)(zee);return nA.createElement(Yh,rA({},e,{animationManager:(t=(r=e.animationManager)!==null&&r!==void 0?r:n)!==null&&t!==void 0?t:_ee()}))}function Zx(){return Zx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zx.apply(null,arguments)}var n4=(e,t,r,n,i)=>{var o=Math.min(Math.abs(r)/2,Math.abs(n)/2),a=n>=0?1:-1,s=r>=0?1:-1,l=n>=0&&r>=0||n<0&&r<0?1:0,c;if(o>0&&i instanceof Array){for(var d=[0,0,0,0],u=0,p=4;u<p;u++)d[u]=i[u]>o?o:i[u];c="M".concat(e,",").concat(t+a*d[0]),d[0]>0&&(c+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(l,",").concat(e+s*d[0],",").concat(t)),c+="L ".concat(e+r-s*d[1],",").concat(t),d[1]>0&&(c+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(l,`,
        `).concat(e+r,",").concat(t+a*d[1])),c+="L ".concat(e+r,",").concat(t+n-a*d[2]),d[2]>0&&(c+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(l,`,
        `).concat(e+r-s*d[2],",").concat(t+n)),c+="L ".concat(e+s*d[3],",").concat(t+n),d[3]>0&&(c+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(l,`,
        `).concat(e,",").concat(t+n-a*d[3])),c+="Z"}else if(o>0&&i===+i&&i>0){var m=Math.min(o,i);c="M ".concat(e,",").concat(t+a*m,`
            A `).concat(m,",").concat(m,",0,0,").concat(l,",").concat(e+s*m,",").concat(t,`
            L `).concat(e+r-s*m,",").concat(t,`
            A `).concat(m,",").concat(m,",0,0,").concat(l,",").concat(e+r,",").concat(t+a*m,`
            L `).concat(e+r,",").concat(t+n-a*m,`
            A `).concat(m,",").concat(m,",0,0,").concat(l,",").concat(e+r-s*m,",").concat(t+n,`
            L `).concat(e+s*m,",").concat(t+n,`
            A `).concat(m,",").concat(m,",0,0,").concat(l,",").concat(e,",").concat(t+n-a*m," Z")}else c="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return c},$ee={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},e0=e=>{var t=en(e,$ee),r=(0,ym.useRef)(null),[n,i]=(0,ym.useState)(-1);(0,ym.useEffect)(()=>{if(r.current&&r.current.getTotalLength)try{var h=r.current.getTotalLength();h&&i(h)}catch(v){}},[]);var{x:o,y:a,width:s,height:l,radius:c,className:d}=t,{animationEasing:u,animationDuration:p,animationBegin:m,isAnimationActive:g,isUpdateAnimationActive:f}=t;if(o!==+o||a!==+a||s!==+s||l!==+l||s===0||l===0)return null;var y=Oe("recharts-rectangle",d);return f?Kh.createElement(io,{canBegin:n>0,from:{width:s,height:l,x:o,y:a},to:{width:s,height:l,x:o,y:a},duration:p,animationEasing:u,isActive:f},h=>{var{width:v,height:b,x:w,y:k}=h;return Kh.createElement(io,{canBegin:n>0,from:"0px ".concat(n===-1?1:n,"px"),to:"".concat(n,"px 0px"),attributeName:"strokeDasharray",begin:m,duration:p,isActive:g,easing:u},Kh.createElement("path",Zx({},Ce(t,!0),{className:y,d:n4(w,k,v,b,c),ref:r})))}):Kh.createElement("path",Zx({},Ce(t,!0),{className:y,d:n4(o,a,s,l,c)}))};function t0(e){var{cx:t,cy:r,radius:n,startAngle:i,endAngle:o}=e,a=Lr(t,r,n,i),s=Lr(t,r,n,o);return{points:[a,s],cx:t,cy:r,radius:n,startAngle:i,endAngle:o}}var i4=$(W());function iA(){return iA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},iA.apply(null,arguments)}var Ree=(e,t)=>{var r=Vr(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},r0=e=>{var{cx:t,cy:r,radius:n,angle:i,sign:o,isExternal:a,cornerRadius:s,cornerIsExternal:l}=e,c=s*(a?1:-1)+n,d=Math.asin(s/c)/Rh,u=l?i:i+o*d,p=Lr(t,r,c,u),m=Lr(t,r,n,u),g=l?i-o*d:i,f=Lr(t,r,c*Math.cos(d*Rh),g);return{center:p,circleTangency:m,lineTangency:f,theta:d}},o4=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:i,startAngle:o,endAngle:a}=e,s=Ree(o,a),l=o+s,c=Lr(t,r,i,o),d=Lr(t,r,i,l),u="M ".concat(c.x,",").concat(c.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(s)>180),",").concat(+(o>l),`,
    `).concat(d.x,",").concat(d.y,`
  `);if(n>0){var p=Lr(t,r,n,o),m=Lr(t,r,n,l);u+="L ".concat(m.x,",").concat(m.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(s)>180),",").concat(+(o<=l),`,
            `).concat(p.x,",").concat(p.y," Z")}else u+="L ".concat(t,",").concat(r," Z");return u},Wee=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:i,cornerRadius:o,forceCornerRadius:a,cornerIsExternal:s,startAngle:l,endAngle:c}=e,d=Vr(c-l),{circleTangency:u,lineTangency:p,theta:m}=r0({cx:t,cy:r,radius:i,angle:l,sign:d,cornerRadius:o,cornerIsExternal:s}),{circleTangency:g,lineTangency:f,theta:y}=r0({cx:t,cy:r,radius:i,angle:c,sign:-d,cornerRadius:o,cornerIsExternal:s}),h=s?Math.abs(l-c):Math.abs(l-c)-m-y;if(h<0)return a?"M ".concat(p.x,",").concat(p.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):o4({cx:t,cy:r,innerRadius:n,outerRadius:i,startAngle:l,endAngle:c});var v="M ".concat(p.x,",").concat(p.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(d<0),",").concat(u.x,",").concat(u.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(h>180),",").concat(+(d<0),",").concat(g.x,",").concat(g.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(d<0),",").concat(f.x,",").concat(f.y,`
  `);if(n>0){var{circleTangency:b,lineTangency:w,theta:k}=r0({cx:t,cy:r,radius:n,angle:l,sign:d,isExternal:!0,cornerRadius:o,cornerIsExternal:s}),{circleTangency:S,lineTangency:x,theta:T}=r0({cx:t,cy:r,radius:n,angle:c,sign:-d,isExternal:!0,cornerRadius:o,cornerIsExternal:s}),E=s?Math.abs(l-c):Math.abs(l-c)-k-T;if(E<0&&o===0)return"".concat(v,"L").concat(t,",").concat(r,"Z");v+="L".concat(x.x,",").concat(x.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(d<0),",").concat(S.x,",").concat(S.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(E>180),",").concat(+(d>0),",").concat(b.x,",").concat(b.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(d<0),",").concat(w.x,",").concat(w.y,"Z")}else v+="L".concat(t,",").concat(r,"Z");return v},Bee={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},n0=e=>{var t=en(e,Bee),{cx:r,cy:n,innerRadius:i,outerRadius:o,cornerRadius:a,forceCornerRadius:s,cornerIsExternal:l,startAngle:c,endAngle:d,className:u}=t;if(o<i||c===d)return null;var p=Oe("recharts-sector",u),m=o-i,g=di(a,m,0,!0),f;return g>0&&Math.abs(c-d)<360?f=Wee({cx:r,cy:n,innerRadius:i,outerRadius:o,cornerRadius:Math.min(g,m/2),forceCornerRadius:s,cornerIsExternal:l,startAngle:c,endAngle:d}):f=o4({cx:r,cy:n,innerRadius:i,outerRadius:o,startAngle:c,endAngle:d}),i4.createElement("path",iA({},Ce(t,!0),{className:p,d:f}))};function a4(e,t,r){var n,i,o,a;if(e==="horizontal")n=t.x,o=n,i=r.top,a=r.top+r.height;else if(e==="vertical")i=t.y,a=i,n=r.left,o=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:s,cy:l,innerRadius:c,outerRadius:d,angle:u}=t,p=Lr(s,l,c,u),m=Lr(s,l,d,u);n=p.x,i=p.y,o=m.x,a=m.y}else return t0(t);return[{x:n,y:i},{x:o,y:a}]}var nN=$(u4());var ru={};xs(ru,{scaleBand:()=>Zh,scaleDiverging:()=>z0,scaleDivergingLog:()=>BA,scaleDivergingPow:()=>$0,scaleDivergingSqrt:()=>IW,scaleDivergingSymlog:()=>UA,scaleIdentity:()=>k0,scaleImplicit:()=>d0,scaleLinear:()=>x0,scaleLog:()=>S0,scaleOrdinal:()=>xm,scalePoint:()=>y4,scalePow:()=>cv,scaleQuantile:()=>E0,scaleQuantize:()=>D0,scaleRadial:()=>C0,scaleSequential:()=>F0,scaleSequentialLog:()=>RA,scaleSequentialPow:()=>j0,scaleSequentialQuantile:()=>L0,scaleSequentialSqrt:()=>OW,scaleSequentialSymlog:()=>WA,scaleSqrt:()=>eW,scaleSymlog:()=>T0,scaleThreshold:()=>P0,scaleTime:()=>zA,scaleUtc:()=>$A,tickFormat:()=>iv});function Mi(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function cA(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Ud(e){let t,r,n;e.length!==2?(t=Mi,r=(s,l)=>Mi(e(s),l),n=(s,l)=>e(s)-l):(t=e===Mi||e===cA?e:Kee,r=e,n=e);function i(s,l,c=0,d=s.length){if(c<d){if(t(l,l)!==0)return d;do{let u=c+d>>>1;r(s[u],l)<0?c=u+1:d=u}while(c<d)}return c}function o(s,l,c=0,d=s.length){if(c<d){if(t(l,l)!==0)return d;do{let u=c+d>>>1;r(s[u],l)<=0?c=u+1:d=u}while(c<d)}return c}function a(s,l,c=0,d=s.length){let u=i(s,l,c,d-1);return u>c&&n(s[u-1],l)>-n(s[u],l)?u-1:u}return{left:i,center:a,right:o}}function Kee(){return 0}function Jh(e){return e===null?NaN:+e}function*p4(e,t){if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(yield r);else{let r=-1;for(let n of e)(n=t(n,++r,e))!=null&&(n=+n)>=n&&(yield n)}}var m4=Ud(Mi),f4=m4.right,Jee=m4.left,Xee=Ud(Jh).center,es=f4;var bm=class extends Map{constructor(t,r=ete){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(let[n,i]of t)this.set(n,i)}get(t){return super.get(g4(this,t))}has(t){return super.has(g4(this,t))}set(t,r){return super.set(Qee(this,t),r)}delete(t){return super.delete(Zee(this,t))}};function g4({_intern:e,_key:t},r){let n=t(r);return e.has(n)?e.get(n):r}function Qee({_intern:e,_key:t},r){let n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function Zee({_intern:e,_key:t},r){let n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function ete(e){return e!==null&&typeof e=="object"?e.valueOf():e}function h4(e=Mi){if(e===Mi)return dA;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{let n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function dA(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}var tte=Math.sqrt(50),rte=Math.sqrt(10),nte=Math.sqrt(2);function i0(e,t,r){let n=(t-e)/Math.max(0,r),i=Math.floor(Math.log10(n)),o=n/Math.pow(10,i),a=o>=tte?10:o>=rte?5:o>=nte?2:1,s,l,c;return i<0?(c=Math.pow(10,-i)/a,s=Math.round(e*c),l=Math.round(t*c),s/c<e&&++s,l/c>t&&--l,c=-c):(c=Math.pow(10,i)*a,s=Math.round(e/c),l=Math.round(t/c),s*c<e&&++s,l*c>t&&--l),l<s&&.5<=r&&r<2?i0(e,t,r*2):[s,l,c]}function Vd(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];let n=t<e,[i,o,a]=n?i0(t,e,r):i0(e,t,r);if(!(o>=i))return[];let s=o-i+1,l=new Array(s);if(n)if(a<0)for(let c=0;c<s;++c)l[c]=(o-c)/-a;else for(let c=0;c<s;++c)l[c]=(o-c)*a;else if(a<0)for(let c=0;c<s;++c)l[c]=(i+c)/-a;else for(let c=0;c<s;++c)l[c]=(i+c)*a;return l}function Xh(e,t,r){return t=+t,e=+e,r=+r,i0(e,t,r)[2]}function wm(e,t,r){t=+t,e=+e,r=+r;let n=t<e,i=n?Xh(t,e,r):Xh(e,t,r);return(n?-1:1)*(i<0?1/-i:i)}function o0(e,t){let r;if(t===void 0)for(let n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let i of e)(i=t(i,++n,e))!=null&&(r<i||r===void 0&&i>=i)&&(r=i)}return r}function a0(e,t){let r;if(t===void 0)for(let n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);else{let n=-1;for(let i of e)(i=t(i,++n,e))!=null&&(r>i||r===void 0&&i>=i)&&(r=i)}return r}function s0(e,t,r=0,n=1/0,i){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(i=i===void 0?dA:h4(i);n>r;){if(n-r>600){let l=n-r+1,c=t-r+1,d=Math.log(l),u=.5*Math.exp(2*d/3),p=.5*Math.sqrt(d*u*(l-u)/l)*(c-l/2<0?-1:1),m=Math.max(r,Math.floor(t-c*u/l+p)),g=Math.min(n,Math.floor(t+(l-c)*u/l+p));s0(e,t,m,g,i)}let o=e[t],a=r,s=n;for(Qh(e,r,t),i(e[n],o)>0&&Qh(e,r,n);a<s;){for(Qh(e,a,s),++a,--s;i(e[a],o)<0;)++a;for(;i(e[s],o)>0;)--s}i(e[r],o)===0?Qh(e,r,s):(++s,Qh(e,s,n)),s<=t&&(r=s+1),t<=s&&(n=s-1)}return e}function Qh(e,t,r){let n=e[t];e[t]=e[r],e[r]=n}function l0(e,t,r){if(e=Float64Array.from(p4(e,r)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return a0(e);if(t>=1)return o0(e);var n,i=(n-1)*t,o=Math.floor(i),a=o0(s0(e,o).subarray(0,o+1)),s=a0(e.subarray(o+1));return a+(s-a)*(i-o)}}function uA(e,t,r=Jh){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,i=(n-1)*t,o=Math.floor(i),a=+r(e[o],o,e),s=+r(e[o+1],o+1,e);return a+(s-a)*(i-o)}}function c0(e,t,r){e=+e,t=+t,r=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((t-e)/r))|0,o=new Array(i);++n<i;)o[n]=e+n*r;return o}function wr(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Ta(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}var d0=Symbol("implicit");function xm(){var e=new bm,t=[],r=[],n=d0;function i(o){let a=e.get(o);if(a===void 0){if(n!==d0)return n;e.set(o,a=t.push(o)-1)}return r[a%r.length]}return i.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new bm;for(let a of o)e.has(a)||e.set(a,t.push(a)-1);return i},i.range=function(o){return arguments.length?(r=Array.from(o),i):r.slice()},i.unknown=function(o){return arguments.length?(n=o,i):n},i.copy=function(){return xm(t,r).unknown(n)},wr.apply(i,arguments),i}function Zh(){var e=xm().unknown(void 0),t=e.domain,r=e.range,n=0,i=1,o,a,s=!1,l=0,c=0,d=.5;delete e.unknown;function u(){var p=t().length,m=i<n,g=m?i:n,f=m?n:i;o=(f-g)/Math.max(1,p-l+c*2),s&&(o=Math.floor(o)),g+=(f-g-o*(p-l))*d,a=o*(1-l),s&&(g=Math.round(g),a=Math.round(a));var y=c0(p).map(function(h){return g+o*h});return r(m?y.reverse():y)}return e.domain=function(p){return arguments.length?(t(p),u()):t()},e.range=function(p){return arguments.length?([n,i]=p,n=+n,i=+i,u()):[n,i]},e.rangeRound=function(p){return[n,i]=p,n=+n,i=+i,s=!0,u()},e.bandwidth=function(){return a},e.step=function(){return o},e.round=function(p){return arguments.length?(s=!!p,u()):s},e.padding=function(p){return arguments.length?(l=Math.min(1,c=+p),u()):l},e.paddingInner=function(p){return arguments.length?(l=Math.min(1,p),u()):l},e.paddingOuter=function(p){return arguments.length?(c=+p,u()):c},e.align=function(p){return arguments.length?(d=Math.max(0,Math.min(1,p)),u()):d},e.copy=function(){return Zh(t(),[n,i]).round(s).paddingInner(l).paddingOuter(c).align(d)},wr.apply(u(),arguments)}function v4(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return v4(t())},e}function y4(){return v4(Zh.apply(null,arguments).paddingInner(1))}function u0(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function pA(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function rv(){}var ev=.7,f0=1/ev,km="\\s*([+-]?\\d+)\\s*",tv="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Rs="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ite=/^#([0-9a-f]{3,8})$/,ote=new RegExp(`^rgb\\(${km},${km},${km}\\)$`),ate=new RegExp(`^rgb\\(${Rs},${Rs},${Rs}\\)$`),ste=new RegExp(`^rgba\\(${km},${km},${km},${tv}\\)$`),lte=new RegExp(`^rgba\\(${Rs},${Rs},${Rs},${tv}\\)$`),cte=new RegExp(`^hsl\\(${tv},${Rs},${Rs}\\)$`),dte=new RegExp(`^hsla\\(${tv},${Rs},${Rs},${tv}\\)$`),b4={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};u0(rv,Oc,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:w4,formatHex:w4,formatHex8:ute,formatHsl:pte,formatRgb:x4,toString:x4});function w4(){return this.rgb().formatHex()}function ute(){return this.rgb().formatHex8()}function pte(){return D4(this).formatHsl()}function x4(){return this.rgb().formatRgb()}function Oc(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=ite.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?k4(t):r===3?new oo(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?p0(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?p0(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=ote.exec(e))?new oo(t[1],t[2],t[3],1):(t=ate.exec(e))?new oo(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=ste.exec(e))?p0(t[1],t[2],t[3],t[4]):(t=lte.exec(e))?p0(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=cte.exec(e))?C4(t[1],t[2]/100,t[3]/100,1):(t=dte.exec(e))?C4(t[1],t[2]/100,t[3]/100,t[4]):b4.hasOwnProperty(e)?k4(b4[e]):e==="transparent"?new oo(NaN,NaN,NaN,0):null}function k4(e){return new oo(e>>16&255,e>>8&255,e&255,1)}function p0(e,t,r,n){return n<=0&&(e=t=r=NaN),new oo(e,t,r,n)}function mte(e){return e instanceof rv||(e=Oc(e)),e?(e=e.rgb(),new oo(e.r,e.g,e.b,e.opacity)):new oo}function Sm(e,t,r,n){return arguments.length===1?mte(e):new oo(e,t,r,n==null?1:n)}function oo(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}u0(oo,Sm,pA(rv,{brighter(e){return e=e==null?f0:Math.pow(f0,e),new oo(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ev:Math.pow(ev,e),new oo(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new oo(qd(this.r),qd(this.g),qd(this.b),g0(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:S4,formatHex:S4,formatHex8:fte,formatRgb:T4,toString:T4}));function S4(){return`#${Hd(this.r)}${Hd(this.g)}${Hd(this.b)}`}function fte(){return`#${Hd(this.r)}${Hd(this.g)}${Hd(this.b)}${Hd((isNaN(this.opacity)?1:this.opacity)*255)}`}function T4(){let e=g0(this.opacity);return`${e===1?"rgb(":"rgba("}${qd(this.r)}, ${qd(this.g)}, ${qd(this.b)}${e===1?")":`, ${e})`}`}function g0(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function qd(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Hd(e){return e=qd(e),(e<16?"0":"")+e.toString(16)}function C4(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new ts(e,t,r,n)}function D4(e){if(e instanceof ts)return new ts(e.h,e.s,e.l,e.opacity);if(e instanceof rv||(e=Oc(e)),!e)return new ts;if(e instanceof ts)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),o=Math.max(t,r,n),a=NaN,s=o-i,l=(o+i)/2;return s?(t===o?a=(r-n)/s+(r<n)*6:r===o?a=(n-t)/s+2:a=(t-r)/s+4,s/=l<.5?o+i:2-o-i,a*=60):s=l>0&&l<1?0:a,new ts(a,s,l,e.opacity)}function P4(e,t,r,n){return arguments.length===1?D4(e):new ts(e,t,r,n==null?1:n)}function ts(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}u0(ts,P4,pA(rv,{brighter(e){return e=e==null?f0:Math.pow(f0,e),new ts(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ev:Math.pow(ev,e),new ts(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new oo(mA(e>=240?e-240:e+120,i,n),mA(e,i,n),mA(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new ts(E4(this.h),m0(this.s),m0(this.l),g0(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=g0(this.opacity);return`${e===1?"hsl(":"hsla("}${E4(this.h)}, ${m0(this.s)*100}%, ${m0(this.l)*100}%${e===1?")":`, ${e})`}`}}));function E4(e){return e=(e||0)%360,e<0?e+360:e}function m0(e){return Math.max(0,Math.min(1,e||0))}function mA(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}function fA(e,t,r,n,i){var o=e*e,a=o*e;return((1-3*e+3*o-a)*t+(4-6*o+3*a)*r+(1+3*e+3*o-3*a)*n+a*i)/6}function A4(e){var t=e.length-1;return function(r){var n=r<=0?r=0:r>=1?(r=1,t-1):Math.floor(r*t),i=e[n],o=e[n+1],a=n>0?e[n-1]:2*i-o,s=n<t-1?e[n+2]:2*o-i;return fA((r-n/t)*t,a,i,o,s)}}function N4(e){var t=e.length;return function(r){var n=Math.floor(((r%=1)<0?++r:r)*t),i=e[(n+t-1)%t],o=e[n%t],a=e[(n+1)%t],s=e[(n+2)%t];return fA((r-n/t)*t,i,o,a,s)}}var nv=e=>()=>e;function gte(e,t){return function(r){return e+r*t}}function hte(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function M4(e){return(e=+e)==1?h0:function(t,r){return r-t?hte(t,r,e):nv(isNaN(t)?r:t)}}function h0(e,t){var r=t-e;return r?gte(e,r):nv(isNaN(e)?t:e)}var gA=function e(t){var r=M4(t);function n(i,o){var a=r((i=Sm(i)).r,(o=Sm(o)).r),s=r(i.g,o.g),l=r(i.b,o.b),c=h0(i.opacity,o.opacity);return function(d){return i.r=a(d),i.g=s(d),i.b=l(d),i.opacity=c(d),i+""}}return n.gamma=e,n}(1);function O4(e){return function(t){var r=t.length,n=new Array(r),i=new Array(r),o=new Array(r),a,s;for(a=0;a<r;++a)s=Sm(t[a]),n[a]=s.r||0,i[a]=s.g||0,o[a]=s.b||0;return n=e(n),i=e(i),o=e(o),s.opacity=1,function(l){return s.r=n(l),s.g=i(l),s.b=o(l),s+""}}}var rje=O4(A4),nje=O4(N4);function I4(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),i;return function(o){for(i=0;i<r;++i)n[i]=e[i]*(1-o)+t[i]*o;return n}}function F4(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function j4(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,i=new Array(n),o=new Array(r),a;for(a=0;a<n;++a)i[a]=$o(e[a],t[a]);for(;a<r;++a)o[a]=t[a];return function(s){for(a=0;a<n;++a)o[a]=i[a](s);return o}}function L4(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Ic(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function _4(e,t){var r={},n={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?r[i]=$o(e[i],t[i]):n[i]=t[i];return function(o){for(i in r)n[i]=r[i](o);return n}}var vA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,hA=new RegExp(vA.source,"g");function vte(e){return function(){return e}}function yte(e){return function(t){return e(t)+""}}function z4(e,t){var r=vA.lastIndex=hA.lastIndex=0,n,i,o,a=-1,s=[],l=[];for(e=e+"",t=t+"";(n=vA.exec(e))&&(i=hA.exec(t));)(o=i.index)>r&&(o=t.slice(r,o),s[a]?s[a]+=o:s[++a]=o),(n=n[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,l.push({i:a,x:Ic(n,i)})),r=hA.lastIndex;return r<t.length&&(o=t.slice(r),s[a]?s[a]+=o:s[++a]=o),s.length<2?l[0]?yte(l[0].x):vte(t):(t=l.length,function(c){for(var d=0,u;d<t;++d)s[(u=l[d]).i]=u.x(c);return s.join("")})}function $o(e,t){var r=typeof t,n;return t==null||r==="boolean"?nv(t):(r==="number"?Ic:r==="string"?(n=Oc(t))?(t=n,gA):z4:t instanceof Oc?gA:t instanceof Date?L4:F4(t)?I4:Array.isArray(t)?j4:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?_4:Ic)(e,t)}function Gd(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function v0(e,t){t===void 0&&(t=e,e=$o);for(var r=0,n=t.length-1,i=t[0],o=new Array(n<0?0:n);r<n;)o[r]=e(i,i=t[++r]);return function(a){var s=Math.max(0,Math.min(n-1,Math.floor(a*=n)));return o[s](a-s)}}function yA(e){return function(){return e}}function Fc(e){return+e}var $4=[0,1];function fn(e){return e}function bA(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:yA(isNaN(t)?NaN:.5)}function bte(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function wte(e,t,r){var n=e[0],i=e[1],o=t[0],a=t[1];return i<n?(n=bA(i,n),o=r(a,o)):(n=bA(n,i),o=r(o,a)),function(s){return o(n(s))}}function xte(e,t,r){var n=Math.min(e.length,t.length)-1,i=new Array(n),o=new Array(n),a=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<n;)i[a]=bA(e[a],e[a+1]),o[a]=r(t[a],t[a+1]);return function(s){var l=es(e,s,1,n)-1;return o[l](i[l](s))}}function Ws(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Yd(){var e=$4,t=$4,r=$o,n,i,o,a=fn,s,l,c;function d(){var p=Math.min(e.length,t.length);return a!==fn&&(a=bte(e[0],e[p-1])),s=p>2?xte:wte,l=c=null,u}function u(p){return p==null||isNaN(p=+p)?o:(l||(l=s(e.map(n),t,r)))(n(a(p)))}return u.invert=function(p){return a(i((c||(c=s(t,e.map(n),Ic)))(p)))},u.domain=function(p){return arguments.length?(e=Array.from(p,Fc),d()):e.slice()},u.range=function(p){return arguments.length?(t=Array.from(p),d()):t.slice()},u.rangeRound=function(p){return t=Array.from(p),r=Gd,d()},u.clamp=function(p){return arguments.length?(a=p?!0:fn,d()):a!==fn},u.interpolate=function(p){return arguments.length?(r=p,d()):r},u.unknown=function(p){return arguments.length?(o=p,u):o},function(p,m){return n=p,i=m,d()}}function Kd(){return Yd()(fn,fn)}function R4(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Jd(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Bs(e){return e=Jd(Math.abs(e)),e?e[1]:NaN}function W4(e,t){return function(r,n){for(var i=r.length,o=[],a=0,s=e[0],l=0;i>0&&s>0&&(l+s+1>n&&(s=Math.max(1,n-l)),o.push(r.substring(i-=s,i+s)),!((l+=s+1)>n));)s=e[a=(a+1)%e.length];return o.reverse().join(t)}}function B4(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var kte=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Us(e){if(!(t=kte.exec(e)))throw new Error("invalid format: "+e);var t;return new y0({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Us.prototype=y0.prototype;function y0(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}y0.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function U4(e){e:for(var t=e.length,r=1,n=-1,i;r<t;++r)switch(e[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(i+1):e}var wA;function V4(e,t){var r=Jd(e,t);if(!r)return e+"";var n=r[0],i=r[1],o=i-(wA=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=n.length;return o===a?n:o>a?n+new Array(o-a+1).join("0"):o>0?n.slice(0,o)+"."+n.slice(o):"0."+new Array(1-o).join("0")+Jd(e,Math.max(0,t+o-1))[0]}function xA(e,t){var r=Jd(e,t);if(!r)return e+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}var kA={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:R4,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>xA(e*100,t),r:xA,s:V4,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function SA(e){return e}var H4=Array.prototype.map,q4=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function G4(e){var t=e.grouping===void 0||e.thousands===void 0?SA:W4(H4.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?SA:B4(H4.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",s=e.minus===void 0?"\u2212":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function c(u){u=Us(u);var p=u.fill,m=u.align,g=u.sign,f=u.symbol,y=u.zero,h=u.width,v=u.comma,b=u.precision,w=u.trim,k=u.type;k==="n"?(v=!0,k="g"):kA[k]||(b===void 0&&(b=12),w=!0,k="g"),(y||p==="0"&&m==="=")&&(y=!0,p="0",m="=");var S=f==="$"?r:f==="#"&&/[boxX]/.test(k)?"0"+k.toLowerCase():"",x=f==="$"?n:/[%p]/.test(k)?a:"",T=kA[k],E=/[defgprs%]/.test(k);b=b===void 0?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function C(N){var D=S,A=x,P,I,M;if(k==="c")A=T(N)+A,N="";else{N=+N;var O=N<0||1/N<0;if(N=isNaN(N)?l:T(Math.abs(N),b),w&&(N=U4(N)),O&&+N==0&&g!=="+"&&(O=!1),D=(O?g==="("?g:s:g==="-"||g==="("?"":g)+D,A=(k==="s"?q4[8+wA/3]:"")+A+(O&&g==="("?")":""),E){for(P=-1,I=N.length;++P<I;)if(M=N.charCodeAt(P),48>M||M>57){A=(M===46?i+N.slice(P+1):N.slice(P))+A,N=N.slice(0,P);break}}}v&&!y&&(N=t(N,1/0));var F=D.length+N.length+A.length,L=F<h?new Array(h-F+1).join(p):"";switch(v&&y&&(N=t(L+N,L.length?h-A.length:1/0),L=""),m){case"<":N=D+N+A+L;break;case"=":N=D+L+N+A;break;case"^":N=L.slice(0,F=L.length>>1)+D+N+A+L.slice(F);break;default:N=L+D+N+A;break}return o(N)}return C.toString=function(){return u+""},C}function d(u,p){var m=c((u=Us(u),u.type="f",u)),g=Math.max(-8,Math.min(8,Math.floor(Bs(p)/3)))*3,f=Math.pow(10,-g),y=q4[8+g/3];return function(h){return m(f*h)+y}}return{format:c,formatPrefix:d}}var b0,Tm,w0;TA({thousands:",",grouping:[3],currency:["$",""]});function TA(e){return b0=G4(e),Tm=b0.format,w0=b0.formatPrefix,b0}function CA(e){return Math.max(0,-Bs(Math.abs(e)))}function EA(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Bs(t)/3)))*3-Bs(Math.abs(e)))}function DA(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Bs(t)-Bs(e))+1}function iv(e,t,r,n){var i=wm(e,t,r),o;switch(n=Us(n==null?",f":n),n.type){case"s":{var a=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(o=EA(i,a))&&(n.precision=o),w0(n,a)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(o=DA(i,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=o-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(o=CA(i))&&(n.precision=o-(n.type==="%")*2);break}}return Tm(n)}function Oi(e){var t=e.domain;return e.ticks=function(r){var n=t();return Vd(n[0],n[n.length-1],r==null?10:r)},e.tickFormat=function(r,n){var i=t();return iv(i[0],i[i.length-1],r==null?10:r,n)},e.nice=function(r){r==null&&(r=10);var n=t(),i=0,o=n.length-1,a=n[i],s=n[o],l,c,d=10;for(s<a&&(c=a,a=s,s=c,c=i,i=o,o=c);d-- >0;){if(c=Xh(a,s,r),c===l)return n[i]=a,n[o]=s,t(n);if(c>0)a=Math.floor(a/c)*c,s=Math.ceil(s/c)*c;else if(c<0)a=Math.ceil(a*c)/c,s=Math.floor(s*c)/c;else break;l=c}return e},e}function x0(){var e=Kd();return e.copy=function(){return Ws(e,x0())},wr.apply(e,arguments),Oi(e)}function k0(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Fc),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return k0(e).unknown(t)},e=arguments.length?Array.from(e,Fc):[0,1],Oi(r)}function ov(e,t){e=e.slice();var r=0,n=e.length-1,i=e[r],o=e[n],a;return o<i&&(a=r,r=n,n=a,a=i,i=o,o=a),e[r]=t.floor(i),e[n]=t.ceil(o),e}function Y4(e){return Math.log(e)}function K4(e){return Math.exp(e)}function Ste(e){return-Math.log(-e)}function Tte(e){return-Math.exp(-e)}function Cte(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Ete(e){return e===10?Cte:e===Math.E?Math.exp:t=>Math.pow(e,t)}function Dte(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function J4(e){return(t,r)=>-e(-t,r)}function av(e){let t=e(Y4,K4),r=t.domain,n=10,i,o;function a(){return i=Dte(n),o=Ete(n),r()[0]<0?(i=J4(i),o=J4(o),e(Ste,Tte)):e(Y4,K4),t}return t.base=function(s){return arguments.length?(n=+s,a()):n},t.domain=function(s){return arguments.length?(r(s),a()):r()},t.ticks=s=>{let l=r(),c=l[0],d=l[l.length-1],u=d<c;u&&([c,d]=[d,c]);let p=i(c),m=i(d),g,f,y=s==null?10:+s,h=[];if(!(n%1)&&m-p<y){if(p=Math.floor(p),m=Math.ceil(m),c>0){for(;p<=m;++p)for(g=1;g<n;++g)if(f=p<0?g/o(-p):g*o(p),!(f<c)){if(f>d)break;h.push(f)}}else for(;p<=m;++p)for(g=n-1;g>=1;--g)if(f=p>0?g/o(-p):g*o(p),!(f<c)){if(f>d)break;h.push(f)}h.length*2<y&&(h=Vd(c,d,y))}else h=Vd(p,m,Math.min(m-p,y)).map(o);return u?h.reverse():h},t.tickFormat=(s,l)=>{if(s==null&&(s=10),l==null&&(l=n===10?"s":","),typeof l!="function"&&(!(n%1)&&(l=Us(l)).precision==null&&(l.trim=!0),l=Tm(l)),s===1/0)return l;let c=Math.max(1,n*s/t.ticks().length);return d=>{let u=d/o(Math.round(i(d)));return u*n<n-.5&&(u*=n),u<=c?l(d):""}},t.nice=()=>r(ov(r(),{floor:s=>o(Math.floor(i(s))),ceil:s=>o(Math.ceil(i(s)))})),t}function S0(){let e=av(Yd()).domain([1,10]);return e.copy=()=>Ws(e,S0()).base(e.base()),wr.apply(e,arguments),e}function X4(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Q4(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function sv(e){var t=1,r=e(X4(t),Q4(t));return r.constant=function(n){return arguments.length?e(X4(t=+n),Q4(t)):t},Oi(r)}function T0(){var e=sv(Yd());return e.copy=function(){return Ws(e,T0()).constant(e.constant())},wr.apply(e,arguments)}function Z4(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Pte(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Ate(e){return e<0?-e*e:e*e}function lv(e){var t=e(fn,fn),r=1;function n(){return r===1?e(fn,fn):r===.5?e(Pte,Ate):e(Z4(r),Z4(1/r))}return t.exponent=function(i){return arguments.length?(r=+i,n()):r},Oi(t)}function cv(){var e=lv(Yd());return e.copy=function(){return Ws(e,cv()).exponent(e.exponent())},wr.apply(e,arguments),e}function eW(){return cv.apply(null,arguments).exponent(.5)}function tW(e){return Math.sign(e)*e*e}function Nte(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function C0(){var e=Kd(),t=[0,1],r=!1,n;function i(o){var a=Nte(e(o));return isNaN(a)?n:r?Math.round(a):a}return i.invert=function(o){return e.invert(tW(o))},i.domain=function(o){return arguments.length?(e.domain(o),i):e.domain()},i.range=function(o){return arguments.length?(e.range((t=Array.from(o,Fc)).map(tW)),i):t.slice()},i.rangeRound=function(o){return i.range(o).round(!0)},i.round=function(o){return arguments.length?(r=!!o,i):r},i.clamp=function(o){return arguments.length?(e.clamp(o),i):e.clamp()},i.unknown=function(o){return arguments.length?(n=o,i):n},i.copy=function(){return C0(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},wr.apply(i,arguments),Oi(i)}function E0(){var e=[],t=[],r=[],n;function i(){var a=0,s=Math.max(1,t.length);for(r=new Array(s-1);++a<s;)r[a-1]=uA(e,a/s);return o}function o(a){return a==null||isNaN(a=+a)?n:t[es(r,a)]}return o.invertExtent=function(a){var s=t.indexOf(a);return s<0?[NaN,NaN]:[s>0?r[s-1]:e[0],s<r.length?r[s]:e[e.length-1]]},o.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let s of a)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(Mi),i()},o.range=function(a){return arguments.length?(t=Array.from(a),i()):t.slice()},o.unknown=function(a){return arguments.length?(n=a,o):n},o.quantiles=function(){return r.slice()},o.copy=function(){return E0().domain(e).range(t).unknown(n)},wr.apply(o,arguments)}function D0(){var e=0,t=1,r=1,n=[.5],i=[0,1],o;function a(l){return l!=null&&l<=l?i[es(n,l,0,r)]:o}function s(){var l=-1;for(n=new Array(r);++l<r;)n[l]=((l+1)*t-(l-r)*e)/(r+1);return a}return a.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,s()):[e,t]},a.range=function(l){return arguments.length?(r=(i=Array.from(l)).length-1,s()):i.slice()},a.invertExtent=function(l){var c=i.indexOf(l);return c<0?[NaN,NaN]:c<1?[e,n[0]]:c>=r?[n[r-1],t]:[n[c-1],n[c]]},a.unknown=function(l){return arguments.length&&(o=l),a},a.thresholds=function(){return n.slice()},a.copy=function(){return D0().domain([e,t]).range(i).unknown(o)},wr.apply(Oi(a),arguments)}function P0(){var e=[.5],t=[0,1],r,n=1;function i(o){return o!=null&&o<=o?t[es(e,o,0,n)]:r}return i.domain=function(o){return arguments.length?(e=Array.from(o),n=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(o){return arguments.length?(t=Array.from(o),n=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(o){var a=t.indexOf(o);return[e[a-1],e[a]]},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return P0().domain(e).range(t).unknown(r)},wr.apply(i,arguments)}var PA=new Date,AA=new Date;function Jt(e,t,r,n){function i(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=o=>(e(o=new Date(+o)),o),i.ceil=o=>(e(o=new Date(o-1)),t(o,1),e(o),o),i.round=o=>{let a=i(o),s=i.ceil(o);return o-a<s-o?a:s},i.offset=(o,a)=>(t(o=new Date(+o),a==null?1:Math.floor(a)),o),i.range=(o,a,s)=>{let l=[];if(o=i.ceil(o),s=s==null?1:Math.floor(s),!(o<a)||!(s>0))return l;let c;do l.push(c=new Date(+o)),t(o,s),e(o);while(c<o&&o<a);return l},i.filter=o=>Jt(a=>{if(a>=a)for(;e(a),!o(a);)a.setTime(a-1)},(a,s)=>{if(a>=a)if(s<0)for(;++s<=0;)for(;t(a,-1),!o(a););else for(;--s>=0;)for(;t(a,1),!o(a););}),r&&(i.count=(o,a)=>(PA.setTime(+o),AA.setTime(+a),e(PA),e(AA),Math.floor(r(PA,AA))),i.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(n?a=>n(a)%o===0:a=>i.count(0,a)%o===0):i)),i}var dv=Jt(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);dv.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Jt(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):dv);var m2e=dv.range;var Ca=Jt(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*1e3)},(e,t)=>(t-e)/1e3,e=>e.getUTCSeconds()),rW=Ca.range;var Cm=Jt(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*1e3)},(e,t)=>{e.setTime(+e+t*6e4)},(e,t)=>(t-e)/6e4,e=>e.getMinutes()),Mte=Cm.range,Em=Jt(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*6e4)},(e,t)=>(t-e)/6e4,e=>e.getUTCMinutes()),Ote=Em.range;var Dm=Jt(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*1e3-e.getMinutes()*6e4)},(e,t)=>{e.setTime(+e+t*36e5)},(e,t)=>(t-e)/36e5,e=>e.getHours()),Ite=Dm.range,Pm=Jt(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*36e5)},(e,t)=>(t-e)/36e5,e=>e.getUTCHours()),Fte=Pm.range;var Pl=Jt(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*6e4)/864e5,e=>e.getDate()-1),jte=Pl.range,Zd=Jt(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>e.getUTCDate()-1),Lte=Zd.range,A0=Jt(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>Math.floor(e/864e5)),_te=A0.range;function eu(e){return Jt(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*6e4)/6048e5)}var Al=eu(0),Am=eu(1),iW=eu(2),oW=eu(3),jc=eu(4),aW=eu(5),sW=eu(6),lW=Al.range,zte=Am.range,$te=iW.range,Rte=oW.range,Wte=jc.range,Bte=aW.range,Ute=sW.range;function tu(e){return Jt(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/6048e5)}var Nl=tu(0),Nm=tu(1),cW=tu(2),dW=tu(3),Lc=tu(4),uW=tu(5),pW=tu(6),mW=Nl.range,Vte=Nm.range,Hte=cW.range,qte=dW.range,Gte=Lc.range,Yte=uW.range,Kte=pW.range;var Mm=Jt(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth()),Jte=Mm.range,Om=Jt(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth()),Xte=Om.range;var Ro=Jt(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Ro.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Jt(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});var Qte=Ro.range,Wo=Jt(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Wo.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Jt(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});var Zte=Wo.range;function gW(e,t,r,n,i,o){let a=[[Ca,1,1e3],[Ca,5,5*1e3],[Ca,15,15*1e3],[Ca,30,30*1e3],[o,1,6e4],[o,5,5*6e4],[o,15,15*6e4],[o,30,30*6e4],[i,1,36e5],[i,3,3*36e5],[i,6,6*36e5],[i,12,12*36e5],[n,1,864e5],[n,2,2*864e5],[r,1,6048e5],[t,1,2592e6],[t,3,3*2592e6],[e,1,31536e6]];function s(c,d,u){let p=d<c;p&&([c,d]=[d,c]);let m=u&&typeof u.range=="function"?u:l(c,d,u),g=m?m.range(c,+d+1):[];return p?g.reverse():g}function l(c,d,u){let p=Math.abs(d-c)/u,m=Ud(([,,y])=>y).right(a,p);if(m===a.length)return e.every(wm(c/31536e6,d/31536e6,u));if(m===0)return dv.every(Math.max(wm(c,d,u),1));let[g,f]=a[p/a[m-1][2]<a[m][2]/p?m-1:m];return g.every(f)}return[s,l]}var[NA,MA]=gW(Wo,Om,Nl,A0,Pm,Em),[OA,IA]=gW(Ro,Mm,Al,Pl,Dm,Cm);function FA(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function jA(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function pv(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function LA(e){var t=e.dateTime,r=e.date,n=e.time,i=e.periods,o=e.days,a=e.shortDays,s=e.months,l=e.shortMonths,c=mv(i),d=fv(i),u=mv(o),p=fv(o),m=mv(a),g=fv(a),f=mv(s),y=fv(s),h=mv(l),v=fv(l),b={a:O,A:F,b:L,B,c:null,d:xW,e:xW,f:Sre,g:Ire,G:jre,H:wre,I:xre,j:kre,L:EW,m:Tre,M:Cre,p:j,q:_,Q:TW,s:CW,S:Ere,u:Dre,U:Pre,V:Are,w:Nre,W:Mre,x:null,X:null,y:Ore,Y:Fre,Z:Lre,"%":SW},w={a:H,A:q,b:X,B:U,c:null,d:kW,e:kW,f:Rre,g:Jre,G:Qre,H:_re,I:zre,j:$re,L:PW,m:Wre,M:Bre,p:Y,q:R,Q:TW,s:CW,S:Ure,u:Vre,U:Hre,V:qre,w:Gre,W:Yre,x:null,X:null,y:Kre,Y:Xre,Z:Zre,"%":SW},k={a:C,A:N,b:D,B:A,c:P,d:bW,e:bW,f:hre,g:yW,G:vW,H:wW,I:wW,j:pre,L:gre,m:ure,M:mre,p:E,q:dre,Q:yre,s:bre,S:fre,u:ore,U:are,V:sre,w:ire,W:lre,x:I,X:M,y:yW,Y:vW,Z:cre,"%":vre};b.x=S(r,b),b.X=S(n,b),b.c=S(t,b),w.x=S(r,w),w.X=S(n,w),w.c=S(t,w);function S(V,G){return function(J){var K=[],ne=-1,te=0,oe=V.length,de,xe,je;for(J instanceof Date||(J=new Date(+J));++ne<oe;)V.charCodeAt(ne)===37&&(K.push(V.slice(te,ne)),(xe=hW[de=V.charAt(++ne)])!=null?de=V.charAt(++ne):xe=de==="e"?" ":"0",(je=G[de])&&(de=je(J,xe)),K.push(de),te=ne+1);return K.push(V.slice(te,ne)),K.join("")}}function x(V,G){return function(J){var K=pv(1900,void 0,1),ne=T(K,V,J+="",0),te,oe;if(ne!=J.length)return null;if("Q"in K)return new Date(K.Q);if("s"in K)return new Date(K.s*1e3+("L"in K?K.L:0));if(G&&!("Z"in K)&&(K.Z=0),"p"in K&&(K.H=K.H%12+K.p*12),K.m===void 0&&(K.m="q"in K?K.q:0),"V"in K){if(K.V<1||K.V>53)return null;"w"in K||(K.w=1),"Z"in K?(te=jA(pv(K.y,0,1)),oe=te.getUTCDay(),te=oe>4||oe===0?Nm.ceil(te):Nm(te),te=Zd.offset(te,(K.V-1)*7),K.y=te.getUTCFullYear(),K.m=te.getUTCMonth(),K.d=te.getUTCDate()+(K.w+6)%7):(te=FA(pv(K.y,0,1)),oe=te.getDay(),te=oe>4||oe===0?Am.ceil(te):Am(te),te=Pl.offset(te,(K.V-1)*7),K.y=te.getFullYear(),K.m=te.getMonth(),K.d=te.getDate()+(K.w+6)%7)}else("W"in K||"U"in K)&&("w"in K||(K.w="u"in K?K.u%7:"W"in K?1:0),oe="Z"in K?jA(pv(K.y,0,1)).getUTCDay():FA(pv(K.y,0,1)).getDay(),K.m=0,K.d="W"in K?(K.w+6)%7+K.W*7-(oe+5)%7:K.w+K.U*7-(oe+6)%7);return"Z"in K?(K.H+=K.Z/100|0,K.M+=K.Z%100,jA(K)):FA(K)}}function T(V,G,J,K){for(var ne=0,te=G.length,oe=J.length,de,xe;ne<te;){if(K>=oe)return-1;if(de=G.charCodeAt(ne++),de===37){if(de=G.charAt(ne++),xe=k[de in hW?G.charAt(ne++):de],!xe||(K=xe(V,J,K))<0)return-1}else if(de!=J.charCodeAt(K++))return-1}return K}function E(V,G,J){var K=c.exec(G.slice(J));return K?(V.p=d.get(K[0].toLowerCase()),J+K[0].length):-1}function C(V,G,J){var K=m.exec(G.slice(J));return K?(V.w=g.get(K[0].toLowerCase()),J+K[0].length):-1}function N(V,G,J){var K=u.exec(G.slice(J));return K?(V.w=p.get(K[0].toLowerCase()),J+K[0].length):-1}function D(V,G,J){var K=h.exec(G.slice(J));return K?(V.m=v.get(K[0].toLowerCase()),J+K[0].length):-1}function A(V,G,J){var K=f.exec(G.slice(J));return K?(V.m=y.get(K[0].toLowerCase()),J+K[0].length):-1}function P(V,G,J){return T(V,t,G,J)}function I(V,G,J){return T(V,r,G,J)}function M(V,G,J){return T(V,n,G,J)}function O(V){return a[V.getDay()]}function F(V){return o[V.getDay()]}function L(V){return l[V.getMonth()]}function B(V){return s[V.getMonth()]}function j(V){return i[+(V.getHours()>=12)]}function _(V){return 1+~~(V.getMonth()/3)}function H(V){return a[V.getUTCDay()]}function q(V){return o[V.getUTCDay()]}function X(V){return l[V.getUTCMonth()]}function U(V){return s[V.getUTCMonth()]}function Y(V){return i[+(V.getUTCHours()>=12)]}function R(V){return 1+~~(V.getUTCMonth()/3)}return{format:function(V){var G=S(V+="",b);return G.toString=function(){return V},G},parse:function(V){var G=x(V+="",!1);return G.toString=function(){return V},G},utcFormat:function(V){var G=S(V+="",w);return G.toString=function(){return V},G},utcParse:function(V){var G=x(V+="",!0);return G.toString=function(){return V},G}}}var hW={"-":"",_:" ",0:"0"},In=/^\s*\d+/,tre=/^%/,rre=/[\\^$*+?|[\]().{}]/g;function St(e,t,r){var n=e<0?"-":"",i=(n?-e:e)+"",o=i.length;return n+(o<r?new Array(r-o+1).join(t)+i:i)}function nre(e){return e.replace(rre,"\\$&")}function mv(e){return new RegExp("^(?:"+e.map(nre).join("|")+")","i")}function fv(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function ire(e,t,r){var n=In.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function ore(e,t,r){var n=In.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function are(e,t,r){var n=In.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function sre(e,t,r){var n=In.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function lre(e,t,r){var n=In.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function vW(e,t,r){var n=In.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function yW(e,t,r){var n=In.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function cre(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function dre(e,t,r){var n=In.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function ure(e,t,r){var n=In.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function bW(e,t,r){var n=In.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function pre(e,t,r){var n=In.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function wW(e,t,r){var n=In.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function mre(e,t,r){var n=In.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function fre(e,t,r){var n=In.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function gre(e,t,r){var n=In.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function hre(e,t,r){var n=In.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function vre(e,t,r){var n=tre.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function yre(e,t,r){var n=In.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function bre(e,t,r){var n=In.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function xW(e,t){return St(e.getDate(),t,2)}function wre(e,t){return St(e.getHours(),t,2)}function xre(e,t){return St(e.getHours()%12||12,t,2)}function kre(e,t){return St(1+Pl.count(Ro(e),e),t,3)}function EW(e,t){return St(e.getMilliseconds(),t,3)}function Sre(e,t){return EW(e,t)+"000"}function Tre(e,t){return St(e.getMonth()+1,t,2)}function Cre(e,t){return St(e.getMinutes(),t,2)}function Ere(e,t){return St(e.getSeconds(),t,2)}function Dre(e){var t=e.getDay();return t===0?7:t}function Pre(e,t){return St(Al.count(Ro(e)-1,e),t,2)}function DW(e){var t=e.getDay();return t>=4||t===0?jc(e):jc.ceil(e)}function Are(e,t){return e=DW(e),St(jc.count(Ro(e),e)+(Ro(e).getDay()===4),t,2)}function Nre(e){return e.getDay()}function Mre(e,t){return St(Am.count(Ro(e)-1,e),t,2)}function Ore(e,t){return St(e.getFullYear()%100,t,2)}function Ire(e,t){return e=DW(e),St(e.getFullYear()%100,t,2)}function Fre(e,t){return St(e.getFullYear()%1e4,t,4)}function jre(e,t){var r=e.getDay();return e=r>=4||r===0?jc(e):jc.ceil(e),St(e.getFullYear()%1e4,t,4)}function Lre(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+St(t/60|0,"0",2)+St(t%60,"0",2)}function kW(e,t){return St(e.getUTCDate(),t,2)}function _re(e,t){return St(e.getUTCHours(),t,2)}function zre(e,t){return St(e.getUTCHours()%12||12,t,2)}function $re(e,t){return St(1+Zd.count(Wo(e),e),t,3)}function PW(e,t){return St(e.getUTCMilliseconds(),t,3)}function Rre(e,t){return PW(e,t)+"000"}function Wre(e,t){return St(e.getUTCMonth()+1,t,2)}function Bre(e,t){return St(e.getUTCMinutes(),t,2)}function Ure(e,t){return St(e.getUTCSeconds(),t,2)}function Vre(e){var t=e.getUTCDay();return t===0?7:t}function Hre(e,t){return St(Nl.count(Wo(e)-1,e),t,2)}function AW(e){var t=e.getUTCDay();return t>=4||t===0?Lc(e):Lc.ceil(e)}function qre(e,t){return e=AW(e),St(Lc.count(Wo(e),e)+(Wo(e).getUTCDay()===4),t,2)}function Gre(e){return e.getUTCDay()}function Yre(e,t){return St(Nm.count(Wo(e)-1,e),t,2)}function Kre(e,t){return St(e.getUTCFullYear()%100,t,2)}function Jre(e,t){return e=AW(e),St(e.getUTCFullYear()%100,t,2)}function Xre(e,t){return St(e.getUTCFullYear()%1e4,t,4)}function Qre(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Lc(e):Lc.ceil(e),St(e.getUTCFullYear()%1e4,t,4)}function Zre(){return"+0000"}function SW(){return"%"}function TW(e){return+e}function CW(e){return Math.floor(+e/1e3)}var Im,N0,NW,M0,MW;_A({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function _A(e){return Im=LA(e),N0=Im.format,NW=Im.parse,M0=Im.utcFormat,MW=Im.utcParse,Im}function ene(e){return new Date(e)}function tne(e){return e instanceof Date?+e:+new Date(+e)}function O0(e,t,r,n,i,o,a,s,l,c){var d=Kd(),u=d.invert,p=d.domain,m=c(".%L"),g=c(":%S"),f=c("%I:%M"),y=c("%I %p"),h=c("%a %d"),v=c("%b %d"),b=c("%B"),w=c("%Y");function k(S){return(l(S)<S?m:s(S)<S?g:a(S)<S?f:o(S)<S?y:n(S)<S?i(S)<S?h:v:r(S)<S?b:w)(S)}return d.invert=function(S){return new Date(u(S))},d.domain=function(S){return arguments.length?p(Array.from(S,tne)):p().map(ene)},d.ticks=function(S){var x=p();return e(x[0],x[x.length-1],S==null?10:S)},d.tickFormat=function(S,x){return x==null?k:c(x)},d.nice=function(S){var x=p();return(!S||typeof S.range!="function")&&(S=t(x[0],x[x.length-1],S==null?10:S)),S?p(ov(x,S)):d},d.copy=function(){return Ws(d,O0(e,t,r,n,i,o,a,s,l,c))},d}function zA(){return wr.apply(O0(OA,IA,Ro,Mm,Al,Pl,Dm,Cm,Ca,N0).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function $A(){return wr.apply(O0(NA,MA,Wo,Om,Nl,Zd,Pm,Em,Ca,M0).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function I0(){var e=0,t=1,r,n,i,o,a=fn,s=!1,l;function c(u){return u==null||isNaN(u=+u)?l:a(i===0?.5:(u=(o(u)-r)*i,s?Math.max(0,Math.min(1,u)):u))}c.domain=function(u){return arguments.length?([e,t]=u,r=o(e=+e),n=o(t=+t),i=r===n?0:1/(n-r),c):[e,t]},c.clamp=function(u){return arguments.length?(s=!!u,c):s},c.interpolator=function(u){return arguments.length?(a=u,c):a};function d(u){return function(p){var m,g;return arguments.length?([m,g]=p,a=u(m,g),c):[a(0),a(1)]}}return c.range=d($o),c.rangeRound=d(Gd),c.unknown=function(u){return arguments.length?(l=u,c):l},function(u){return o=u,r=u(e),n=u(t),i=r===n?0:1/(n-r),c}}function Ml(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function F0(){var e=Oi(I0()(fn));return e.copy=function(){return Ml(e,F0())},Ta.apply(e,arguments)}function RA(){var e=av(I0()).domain([1,10]);return e.copy=function(){return Ml(e,RA()).base(e.base())},Ta.apply(e,arguments)}function WA(){var e=sv(I0());return e.copy=function(){return Ml(e,WA()).constant(e.constant())},Ta.apply(e,arguments)}function j0(){var e=lv(I0());return e.copy=function(){return Ml(e,j0()).exponent(e.exponent())},Ta.apply(e,arguments)}function OW(){return j0.apply(null,arguments).exponent(.5)}function L0(){var e=[],t=fn;function r(n){if(n!=null&&!isNaN(n=+n))return t((es(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let i of n)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(Mi),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,i)=>t(i/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(i,o)=>l0(e,o/n))},r.copy=function(){return L0(t).domain(e)},Ta.apply(r,arguments)}function _0(){var e=0,t=.5,r=1,n=1,i,o,a,s,l,c=fn,d,u=!1,p;function m(f){return isNaN(f=+f)?p:(f=.5+((f=+d(f))-o)*(n*f<n*o?s:l),c(u?Math.max(0,Math.min(1,f)):f))}m.domain=function(f){return arguments.length?([e,t,r]=f,i=d(e=+e),o=d(t=+t),a=d(r=+r),s=i===o?0:.5/(o-i),l=o===a?0:.5/(a-o),n=o<i?-1:1,m):[e,t,r]},m.clamp=function(f){return arguments.length?(u=!!f,m):u},m.interpolator=function(f){return arguments.length?(c=f,m):c};function g(f){return function(y){var h,v,b;return arguments.length?([h,v,b]=y,c=v0(f,[h,v,b]),m):[c(0),c(.5),c(1)]}}return m.range=g($o),m.rangeRound=g(Gd),m.unknown=function(f){return arguments.length?(p=f,m):p},function(f){return d=f,i=f(e),o=f(t),a=f(r),s=i===o?0:.5/(o-i),l=o===a?0:.5/(a-o),n=o<i?-1:1,m}}function z0(){var e=Oi(_0()(fn));return e.copy=function(){return Ml(e,z0())},Ta.apply(e,arguments)}function BA(){var e=av(_0()).domain([.1,1,10]);return e.copy=function(){return Ml(e,BA()).base(e.base())},Ta.apply(e,arguments)}function UA(){var e=sv(_0());return e.copy=function(){return Ml(e,UA()).constant(e.constant())},Ta.apply(e,arguments)}function $0(){var e=lv(_0());return e.copy=function(){return Ml(e,$0()).exponent(e.exponent())},Ta.apply(e,arguments)}function IW(){return $0.apply(null,arguments).exponent(.5)}var Ol=e=>e.chartData,rne=Q([Ol],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),_c=(e,t,r,n)=>n?rne(e):Ol(e);function nu(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(br(t)&&br(r))return!0}return!1}function FW(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function jW(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,i,o;if(br(r))i=r;else if(typeof r=="function")return;if(br(n))o=n;else if(typeof n=="function")return;var a=[i,o];if(nu(a))return a}}function LW(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(nu(n))return FW(n,t,r)}catch(m){}if(Array.isArray(e)&&e.length===2){var[i,o]=e,a,s;if(i==="auto")t!=null&&(a=Math.min(...t));else if(ge(i))a=i;else if(typeof i=="function")try{t!=null&&(a=i(t==null?void 0:t[0]))}catch(m){}else if(typeof i=="string"&&UP.test(i)){var l=UP.exec(i);if(l==null||t==null)a=void 0;else{var c=+l[1];a=t[0]-c}}else a=t==null?void 0:t[0];if(o==="auto")t!=null&&(s=Math.max(...t));else if(ge(o))s=o;else if(typeof o=="function")try{t!=null&&(s=o(t==null?void 0:t[1]))}catch(m){}else if(typeof o=="string"&&VP.test(o)){var d=VP.exec(o);if(d==null||t==null)s=void 0;else{var u=+d[1];s=t[1]+u}}else s=t==null?void 0:t[1];var p=[a,s];if(nu(p))return t==null?p:FW(p,t,r)}}}var zt=$(VA());var nne=e=>e,$W={"@@functional/placeholder":!0},RW=e=>e===$W,zW=e=>function t(){return arguments.length===0||arguments.length===1&&RW(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},WW=(e,t)=>e===1?t:zW(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];var o=n.filter(a=>a!==$W).length;return o>=e?t(...n):WW(e-o,zW(function(){for(var a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];var c=n.map(d=>RW(d)?s.shift():d);return t(...c,...s)}))}),gv=e=>WW(e.length,e),W0=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},BW=gv((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),UW=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return nne;var i=r.reverse(),o=i[0],a=i.slice(1);return function(){return a.reduce((s,l)=>l(s),o(...arguments))}},B0=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),HA=e=>{var t=null,r=null;return function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return t&&i.every((a,s)=>{var l;return a===((l=t)===null||l===void 0?void 0:l[s])})||(t=i,r=e(...i)),r}};var qA=$(VA());function GA(e){var t;return e===0?t=1:t=Math.floor(new qA.default(e).abs().log(10).toNumber())+1,t}function YA(e,t,r){for(var n=new qA.default(e),i=0,o=[];n.lt(t)&&i<1e5;)o.push(n.toNumber()),n=n.add(r),i++;return o}var oze=gv((e,t,r)=>{var n=+e,i=+t;return n+r*(i-n)}),aze=gv((e,t,r)=>{var n=t-+e;return n=n||1/0,(r-e)/n}),sze=gv((e,t,r)=>{var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});var VW=e=>{var[t,r]=e,[n,i]=[t,r];return t>r&&([n,i]=[r,t]),[n,i]},HW=(e,t,r)=>{if(e.lte(0))return new zt.default(0);var n=GA(e.toNumber()),i=new zt.default(10).pow(n),o=e.div(i),a=n!==1?.05:.1,s=new zt.default(Math.ceil(o.div(a).toNumber())).add(r).mul(a),l=s.mul(i);return t?new zt.default(l.toNumber()):new zt.default(Math.ceil(l.toNumber()))},ine=(e,t,r)=>{var n=new zt.default(1),i=new zt.default(e);if(!i.isint()&&r){var o=Math.abs(e);o<1?(n=new zt.default(10).pow(GA(e)-1),i=new zt.default(Math.floor(i.div(n).toNumber())).mul(n)):o>1&&(i=new zt.default(Math.floor(e)))}else e===0?i=new zt.default(Math.floor((t-1)/2)):r||(i=new zt.default(Math.floor(e)));var a=Math.floor((t-1)/2),s=UW(BW(l=>i.add(new zt.default(l-a).mul(n)).toNumber()),W0);return s(0,t)},qW=function(t,r,n,i){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new zt.default(0),tickMin:new zt.default(0),tickMax:new zt.default(0)};var a=HW(new zt.default(r).sub(t).div(n-1),i,o),s;t<=0&&r>=0?s=new zt.default(0):(s=new zt.default(t).add(r).div(2),s=s.sub(new zt.default(s).mod(a)));var l=Math.ceil(s.sub(t).div(a).toNumber()),c=Math.ceil(new zt.default(r).sub(s).div(a).toNumber()),d=l+c+1;return d>n?qW(t,r,n,i,o+1):(d<n&&(c=r>0?c+(n-d):c,l=r>0?l:l+(n-d)),{step:a,tickMin:s.sub(new zt.default(l).mul(a)),tickMax:s.add(new zt.default(c).mul(a))})};function one(e){var[t,r]=e,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(n,2),[a,s]=VW([t,r]);if(a===-1/0||s===1/0){var l=s===1/0?[a,...W0(0,n-1).map(()=>1/0)]:[...W0(0,n-1).map(()=>-1/0),s];return t>r?B0(l):l}if(a===s)return ine(a,n,i);var{step:c,tickMin:d,tickMax:u}=qW(a,s,o,i,0),p=YA(d,u.add(new zt.default(.1).mul(c)),c);return t>r?B0(p):p}function ane(e,t){var[r,n]=e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[o,a]=VW([r,n]);if(o===-1/0||a===1/0)return[r,n];if(o===a)return[o];var s=Math.max(t,2),l=HW(new zt.default(a).sub(o).div(s-1),i,0),c=[...YA(new zt.default(o),new zt.default(a).sub(new zt.default(.99).mul(l)),l),a];return r>n?B0(c):c}var KA=HA(one),JA=HA(ane);var XA=e=>e.rootProps.maxBarSize,GW=e=>e.rootProps.barGap,U0=e=>e.rootProps.barCategoryGap,YW=e=>e.rootProps.barSize,Fm=e=>e.rootProps.stackOffset,jm=e=>e.options.chartName,V0=e=>e.rootProps.syncId,QA=e=>e.rootProps.syncMethod,H0=e=>e.options.eventEmitter;var Hs={allowDuplicatedCategory:!0,angleAxisId:0,axisLine:!0,cx:0,cy:0,orientation:"outer",reversed:!1,scale:"auto",tick:!0,tickLine:!0,tickSize:8,type:"category"};var ao={allowDataOverflow:!1,allowDuplicatedCategory:!0,angle:0,axisLine:!0,cx:0,cy:0,orientation:"right",radiusAxisId:0,scale:"auto",stroke:"#ccc",tick:!0,tickCount:5,type:"number"};var iu=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t};var sne={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Hs.angleAxisId,includeHidden:!1,name:void 0,reversed:Hs.reversed,scale:Hs.scale,tick:Hs.tick,tickCount:void 0,ticks:void 0,type:Hs.type,unit:void 0},lne={allowDataOverflow:ao.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:ao.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:ao.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:ao.scale,tick:ao.tick,tickCount:ao.tickCount,ticks:void 0,type:ao.type,unit:void 0},cne={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Hs.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Hs.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Hs.scale,tick:Hs.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},dne={allowDataOverflow:ao.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:ao.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:ao.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:ao.scale,tick:ao.tick,tickCount:ao.tickCount,ticks:void 0,type:"category",unit:void 0},q0=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?cne:sne,G0=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?dne:lne,Y0=e=>e.polarOptions,ZA=Q([to,ro,cr],VR),KW=Q([Y0,ZA],(e,t)=>{if(e!=null)return di(e.innerRadius,t,0)}),JW=Q([Y0,ZA],(e,t)=>{if(e!=null)return di(e.outerRadius,t,t*.8)}),une=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},eN=Q([Y0],une),Dze=Q([q0,eN],iu),tN=Q([ZA,KW,JW],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]}),Pze=Q([G0,tN],iu),XW=Q([et,Y0,KW,JW,to,ro],(e,t,r,n,i,o)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:a,cy:s,startAngle:l,endAngle:c}=t;return{cx:di(a,i,i/2),cy:di(s,o,o/2),innerRadius:r,outerRadius:n,startAngle:l,endAngle:c,clockWise:!1}}});var gn=(e,t)=>t;var hv=(e,t,r)=>r;function QW(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function K0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QW(Object(r),!0).forEach(function(n){pne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QW(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pne(e,t,r){return(t=mne(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mne(e){var t=fne(e,"string");return typeof t=="symbol"?t:t+""}function fne(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rN=[0,"auto"],Ii={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},Bo=(e,t)=>{var r=e.cartesianAxis.xAxis[t];return r==null?Ii:r},Fi={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:rN,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:fm},rs=(e,t)=>{var r=e.cartesianAxis.yAxis[t];return r==null?Fi:r},gne={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},iN=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r==null?gne:r},so=(e,t,r)=>{switch(t){case"xAxis":return Bo(e,r);case"yAxis":return rs(e,r);case"zAxis":return iN(e,r);case"angleAxis":return q0(e,r);case"radiusAxis":return G0(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},hne=(e,t,r)=>{switch(t){case"xAxis":return Bo(e,r);case"yAxis":return rs(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Lm=(e,t,r)=>{switch(t){case"xAxis":return Bo(e,r);case"yAxis":return rs(e,r);case"angleAxis":return q0(e,r);case"radiusAxis":return G0(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},oN=e=>e.graphicalItems.countOfBars>0;function aN(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var zc=e=>e.graphicalItems.cartesianItems,vne=Q([gn,hv],aN),sN=(e,t,r)=>e.filter(r).filter(n=>(t==null?void 0:t.includeHidden)===!0?!0:!n.hide),vv=Q([zc,so,vne],sN),lN=e=>e.filter(t=>t.stackId===void 0),yne=Q([vv],lN),cN=e=>e.map(t=>t.data).filter(Boolean).flat(1),bne=Q([vv],cN),dN=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:i}=t;return e.length>0?e:r.slice(n,i+1)},J0=Q([bne,_c],dN),uN=(e,t,r)=>(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:yr(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(i=>({value:yr(i,n)}))):e.map(n=>({value:n})),X0=Q([J0,so,vv],uN);function ZW(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function ou(e){return e.filter(t=>Mn(t)||t instanceof Date).map(Number).filter(t=>hr(t)===!1)}function wne(e,t,r){return!r||typeof t!="number"||hr(t)?[]:r.length?ou(r.flatMap(n=>{var i=yr(e,n.dataKey),o,a;if(Array.isArray(i)?[o,a]=i:o=a=i,!(!br(o)||!br(a)))return[t-o,t+a]})):[]}var pN=(e,t,r)=>{var n={},i=t.reduce((o,a)=>(a.stackId==null||(o[a.stackId]==null&&(o[a.stackId]=[]),o[a.stackId].push(a)),o),n);return Object.fromEntries(Object.entries(i).map(o=>{var[a,s]=o,l=s.map(c=>c.dataKey);return[a,{stackedData:e5(e,l,r),graphicalItems:s}]}))},au=Q([J0,vv,Fm],pN),mN=(e,t,r)=>{var{dataStartIndex:n,dataEndIndex:i}=t;if(r!=="zAxis"){var o=r5(e,n,i);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},xne=Q([au,Ol,gn],mN),fN=(e,t,r,n)=>r.length>0?e.flatMap(i=>r.flatMap(o=>{var a,s,l=(a=o.errorBars)===null||a===void 0?void 0:a.filter(d=>ZW(n,d)),c=yr(i,(s=t.dataKey)!==null&&s!==void 0?s:o.dataKey);return{value:c,errorDomain:wne(i,c,l)}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(i=>({value:yr(i,t.dataKey),errorDomain:[]})):e.map(i=>({value:i,errorDomain:[]})),kne=Q(J0,so,yne,gn,fN);function Sne(e){var{value:t}=e;if(Mn(t)||t instanceof Date)return t}var Tne=e=>{var t=e.flatMap(n=>[n.value,n.errorDomain]).flat(1),r=ou(t);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},Cne=(e,t,r)=>{var n=e.map(Sne).filter(i=>i!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&JE(n))?(0,nN.default)(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},Q0=e=>{var t;if(e==null||!("domain"in e))return rN;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=ou(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e==null?void 0:e.domain)!==null&&t!==void 0?t:rN},Z0=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r.filter(Boolean);if(i.length!==0){var o=i.flat(),a=Math.min(...o),s=Math.max(...o);return[a,s]}},gN=e=>e.referenceElements.dots,su=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),Ene=Q([gN,gn,hv],su),hN=e=>e.referenceElements.areas,Dne=Q([hN,gn,hv],su),vN=e=>e.referenceElements.lines,Pne=Q([vN,gn,hv],su),yN=(e,t)=>{var r=ou(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},Ane=Q(Ene,gn,yN),bN=(e,t)=>{var r=ou(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},Nne=Q([Dne,gn],bN),wN=(e,t)=>{var r=ou(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},Mne=Q(Pne,gn,wN),One=Q(Ane,Mne,Nne,(e,t,r)=>Z0(e,r,t)),Ine=Q([so],Q0),xN=(e,t,r,n,i)=>{var o=jW(t,e.allowDataOverflow);return o!=null?o:LW(t,Z0(r,i,Tne(n)),e.allowDataOverflow)},Fne=Q([so,Ine,xne,kne,One],xN),jne=[0,1],kN=(e,t,r,n,i,o,a)=>{if(!(e==null||r==null||r.length===0)){var{dataKey:s,type:l}=e,c=eo(t,o);return c&&s==null?(0,nN.default)(0,r.length):l==="category"?Cne(n,e,c):i==="expand"?jne:a}},SN=Q([so,et,J0,X0,Fm,gn,Fne],kN),TN=(e,t,r,n,i)=>{if(e!=null){var{scale:o,type:a}=e;if(o==="auto")return t==="radial"&&i==="radiusAxis"?"band":t==="radial"&&i==="angleAxis"?"linear":a==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":a==="category"?"band":"linear";if(typeof o=="string"){var s="scale".concat(Ec(o));return s in ru?s:"point"}}},yv=Q([so,et,oN,jm,gn],TN);function Lne(e){if(e!=null){if(e in ru)return ru[e]();var t="scale".concat(Ec(e));if(t in ru)return ru[t]()}}function ek(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var i=Lne(t);if(i!=null){var o=i.domain(r).range(n);return QR(o),o}}}var CN=(e,t,r)=>{var n=Q0(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&nu(e))return KA(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&nu(e))return JA(e,t.tickCount,t.allowDecimals)}},EN=Q([SN,Lm,yv],CN),DN=(e,t,r,n)=>{if(n!=="angleAxis"&&(e==null?void 0:e.type)==="number"&&nu(t)&&Array.isArray(r)&&r.length>0){var i=t[0],o=r[0],a=t[1],s=r[r.length-1];return[Math.min(i,o),Math.max(a,s)]}return t},_ne=Q([so,SN,EN,gn],DN),zne=Q(X0,so,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(ou(e.map(s=>s.value))).sort((s,l)=>s-l);if(n.length<2)return 1/0;var i=n[n.length-1]-n[0];if(i===0)return 1/0;for(var o=0;o<n.length-1;o++){var a=n[o+1]-n[o];r=Math.min(r,a)}return r/i}}),eB=Q(zne,et,U0,cr,(e,t,r,n)=>n,(e,t,r,n,i)=>{if(!br(e))return 0;var o=t==="vertical"?n.height:n.width;if(i==="gap")return e*o/2;if(i==="no-gap"){var a=di(r,e*o),s=e*o/2;return s-a-(s-a)/o*a}return 0}),$ne=(e,t)=>{var r=Bo(e,t);return r==null||typeof r.padding!="string"?0:eB(e,"xAxis",t,r.padding)},Rne=(e,t)=>{var r=rs(e,t);return r==null||typeof r.padding!="string"?0:eB(e,"yAxis",t,r.padding)},Wne=Q(Bo,$ne,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:i}=e;return typeof i=="string"?{left:t,right:t}:{left:((r=i.left)!==null&&r!==void 0?r:0)+t,right:((n=i.right)!==null&&n!==void 0?n:0)+t}}),Bne=Q(rs,Rne,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:i}=e;return typeof i=="string"?{top:t,bottom:t}:{top:((r=i.top)!==null&&r!==void 0?r:0)+t,bottom:((n=i.bottom)!==null&&n!==void 0?n:0)+t}}),Une=Q([cr,Wne,Wd,gm,(e,t,r)=>r],(e,t,r,n,i)=>{var{padding:o}=n;return i?[o.left,r.width-o.right]:[e.left+t.left,e.left+e.width-t.right]}),Vne=Q([cr,et,Bne,Wd,gm,(e,t,r)=>r],(e,t,r,n,i,o)=>{var{padding:a}=i;return o?[n.height-a.bottom,a.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),_m=(e,t,r,n)=>{var i;switch(t){case"xAxis":return Une(e,r,n);case"yAxis":return Vne(e,r,n);case"zAxis":return(i=iN(e,r))===null||i===void 0?void 0:i.range;case"angleAxis":return eN(e);case"radiusAxis":return tN(e,r);default:return}},tB=Q([so,_m],iu),ns=Q([so,yv,_ne,tB],ek),Jze=Q(vv,gn,(e,t)=>e.flatMap(r=>{var n;return(n=r.errorBars)!==null&&n!==void 0?n:[]}).filter(r=>ZW(t,r)));function rB(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var tk=(e,t)=>t,rk=(e,t,r)=>r,Hne=Q(Wh,tk,rk,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(rB)),qne=Q(Bh,tk,rk,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(rB)),nB=(e,t)=>({width:e.width,height:t.height}),Gne=(e,t)=>{var r=typeof t.width=="number"?t.width:fm;return{width:r,height:e.height}},PN=Q(cr,Bo,nB),Yne=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},Kne=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},Jne=Q(ro,cr,Hne,tk,rk,(e,t,r,n,i)=>{var o={},a;return r.forEach(s=>{var l=nB(t,s);a==null&&(a=Yne(t,n,e));var c=n==="top"&&!i||n==="bottom"&&i;o[s.id]=a-Number(c)*l.height,a+=(c?-1:1)*l.height}),o}),Xne=Q(to,cr,qne,tk,rk,(e,t,r,n,i)=>{var o={},a;return r.forEach(s=>{var l=Gne(t,s);a==null&&(a=Kne(t,n,e));var c=n==="left"&&!i||n==="right"&&i;o[s.id]=a-Number(c)*l.width,a+=(c?-1:1)*l.width}),o}),iB=(e,t)=>{var r=cr(e),n=Bo(e,t);if(n!=null){var i=Jne(e,n.orientation,n.mirror),o=i[t];return o==null?{x:r.left,y:0}:{x:r.left,y:o}}},oB=(e,t)=>{var r=cr(e),n=rs(e,t);if(n!=null){var i=Xne(e,n.orientation,n.mirror),o=i[t];return o==null?{x:0,y:r.top}:{x:o,y:r.top}}},AN=Q(cr,rs,(e,t)=>{var r=typeof t.width=="number"?t.width:fm;return{width:r,height:e.height}}),NN=(e,t,r)=>{switch(t){case"xAxis":return PN(e,r).width;case"yAxis":return AN(e,r).height;default:return}},MN=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:i,type:o,dataKey:a}=r,s=eo(e,n),l=t.map(c=>c.value);if(a&&s&&o==="category"&&i&&JE(l))return l}},ON=Q([et,X0,so,gn],MN),IN=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:i,scale:o}=r,a=eo(e,n);if(a&&(i==="number"||o!=="auto"))return t.map(s=>s.value)}},FN=Q([et,X0,Lm,gn],IN),jN=Q([et,hne,yv,ns,ON,FN,_m,EN,gn],(e,t,r,n,i,o,a,s,l)=>{if(t==null)return null;var c=eo(e,l);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:l,categoricalDomain:o,duplicateDomain:i,isCategorical:c,niceTicks:s,range:a,realScaleType:r,scale:n}}),Qne=(e,t,r,n,i,o,a,s,l)=>{if(!(t==null||n==null)){var c=eo(e,l),{type:d,ticks:u,tickCount:p}=t,m=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,g=d==="category"&&n.bandwidth?n.bandwidth()/m:0;g=l==="angleAxis"&&o!=null&&o.length>=2?Vr(o[0]-o[1])*2*g:g;var f=u||i;if(f){var y=f.map((h,v)=>{var b=a?a.indexOf(h):h;return{index:v,coordinate:n(b)+g,value:h,offset:g}});return y.filter(h=>!hr(h.coordinate))}return c&&s?s.map((h,v)=>({coordinate:n(h)+g,value:h,index:v,offset:g})):n.ticks?n.ticks(p).map(h=>({coordinate:n(h)+g,value:h,offset:g})):n.domain().map((h,v)=>({coordinate:n(h)+g,value:a?a[h]:h,index:v,offset:g}))}},nk=Q([et,Lm,yv,ns,EN,_m,ON,FN,gn],Qne),Zne=(e,t,r,n,i,o,a)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var s=eo(e,a),{tickCount:l}=t,c=0;return c=a==="angleAxis"&&(n==null?void 0:n.length)>=2?Vr(n[0]-n[1])*2*c:c,s&&o?o.map((d,u)=>({coordinate:r(d)+c,value:d,index:u,offset:c})):r.ticks?r.ticks(l).map(d=>({coordinate:r(d)+c,value:d,offset:c})):r.domain().map((d,u)=>({coordinate:r(d)+c,value:i?i[d]:d,index:u,offset:c}))}},Uo=Q([et,Lm,ns,_m,ON,FN,gn],Zne),ui=Q(so,ns,(e,t)=>{if(!(e==null||t==null))return K0(K0({},e),{},{scale:t})}),eie=Q([so,yv,SN,tB],ek),Xze=Q((e,t,r)=>iN(e,r),eie,(e,t)=>{if(!(e==null||t==null))return K0(K0({},e),{},{scale:t})}),aB=Q([et,Wh,Bh],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}});var LN=e=>e.options.defaultTooltipEventType,_N=e=>e.options.validateTooltipEventTypes;function zN(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function bv(e,t){var r=LN(e),n=_N(e);return zN(t,r,n)}function sB(e){return he(t=>bv(t,e))}var ik=(e,t)=>{var r,n=Number(t);if(!(hr(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0};var lB=e=>e.tooltip.settings;var Il={active:!1,index:null,dataKey:void 0,coordinate:void 0},tie={itemInteraction:{click:Il,hover:Il},axisInteraction:{click:Il,hover:Il},keyboardInteraction:Il,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},cB=vr({name:"tooltip",initialState:tie,reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var r=_o(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:dB,removeTooltipEntrySettings:uB,setTooltipSettingsState:pB,setActiveMouseOverItemIndex:ok,mouseLeaveItem:mB,mouseLeaveChart:ak,setActiveClickItemIndex:fB,setMouseOverAxisIndex:sk,setMouseClickAxisIndex:gB,setSyncInteraction:lk,setKeyboardInteraction:ck}=cB.actions,hB=cB.reducer;function vB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function dk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vB(Object(r),!0).forEach(function(n){rie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rie(e,t,r){return(t=nie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nie(e){var t=iie(e,"string");return typeof t=="symbol"?t:t+""}function iie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oie(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function aie(e){return e.index!=null}var uk=(e,t,r,n)=>{if(t==null)return Il;var i=oie(e,t,r);if(i==null)return Il;if(i.active)return i;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var o=e.settings.active===!0;if(aie(i)){if(o)return dk(dk({},i),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return dk(dk({},Il),{},{coordinate:i.coordinate})};var zm=(e,t)=>{var r=e==null?void 0:e.index;if(r==null)return null;var n=Number(r);if(!br(n))return r;var i=0,o=1/0;return t.length>0&&(o=t.length-1),String(Math.max(i,Math.min(n,o)))};var pk=(e,t,r,n,i,o,a,s)=>{if(!(o==null||s==null)){var l=a[0],c=l==null?void 0:s(l.positions,o);if(c!=null)return c;var d=i==null?void 0:i[Number(o)];if(d)switch(r){case"horizontal":return{x:d.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:d.coordinate}}}};var mk=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var i;return r==="hover"?i=e.itemInteraction.hover.dataKey:i=e.itemInteraction.click.dataKey,i==null&&n!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(o=>{var a;return((a=o.settings)===null||a===void 0?void 0:a.dataKey)===i})};var lu=e=>e.options.tooltipPayloadSearcher;var Fl=e=>e.tooltip;var hn=e=>{var t=et(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},$m=e=>e.tooltip.settings.axisId,Fn=e=>{var t=hn(e),r=$m(e);return Lm(e,t,r)},$N=Q([Fn,et,oN,jm,hn],TN),sie=Q([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),lie=Q([hn,$m],aN),fk=Q([sie,Fn,lie],sN),cie=Q([fk],cN),jl=Q([cie,Ol],dN),RN=Q([jl,Fn,fk],uN),die=Q([Fn],Q0),uie=Q([jl,fk,Fm],pN),pie=Q([uie,Ol,hn],mN),mie=Q([fk],lN),fie=Q([jl,Fn,mie,hn],fN),gie=Q([gN,hn,$m],su),hie=Q([gie,hn],yN),vie=Q([hN,hn,$m],su),yie=Q([vie,hn],bN),bie=Q([vN,hn,$m],su),wie=Q([bie,hn],wN),xie=Q([hie,wie,yie],Z0),kie=Q([Fn,die,pie,fie,xie],xN),yB=Q([Fn,et,jl,RN,Fm,hn,kie],kN),Sie=Q([yB,Fn,$N],CN),Tie=Q([Fn,yB,Sie,hn],DN),bB=e=>{var t=hn(e),r=$m(e),n=!1;return _m(e,t,r,n)},WN=Q([Fn,bB],iu),BN=Q([Fn,$N,Tie,WN],ek),Cie=Q([et,RN,Fn,hn],MN),Eie=Q([et,RN,Fn,hn],IN),Die=(e,t,r,n,i,o,a,s)=>{if(t){var{type:l}=t,c=eo(e,s);if(n){var d=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,u=l==="category"&&n.bandwidth?n.bandwidth()/d:0;return u=s==="angleAxis"&&i!=null&&(i==null?void 0:i.length)>=2?Vr(i[0]-i[1])*2*u:u,c&&a?a.map((p,m)=>({coordinate:n(p)+u,value:p,index:m,offset:u})):n.domain().map((p,m)=>({coordinate:n(p)+u,value:o?o[p]:p,index:m,offset:u}))}}},lo=Q([et,Fn,$N,BN,bB,Cie,Eie,hn],Die),wB=Q([LN,_N,lB],(e,t,r)=>zN(r.shared,e,t)),xB=e=>e.tooltip.settings.trigger,UN=e=>e.tooltip.settings.defaultIndex,gk=Q([Fl,wB,xB,UN],uk),Ll=Q([gk,jl],zm),hk=Q([lo,Ll],ik),vk=Q([gk],e=>{if(e)return e.dataKey}),Pie=Q([Fl,wB,xB,UN],mk),Aie=Q([to,ro,et,cr,lo,UN,Pie,lu],pk),kB=Q([gk,Aie],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),SB=Q([gk],e=>e.active);function TB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function CB(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TB(Object(r),!0).forEach(function(n){Nie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Nie(e,t,r){return(t=Mie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mie(e){var t=Oie(e,"string");return typeof t=="symbol"?t:t+""}function Oie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var VN=()=>he(Fn),EB=()=>{var e=VN(),t=he(lo),r=he(BN);return Qa(CB(CB({},e),{},{scale:r}),t)};var AB=$(jh());function DB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function PB(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DB(Object(r),!0).forEach(function(n){Iie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Iie(e,t,r){return(t=Fie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fie(e){var t=jie(e,"string");return typeof t=="symbol"?t:t+""}function jie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yk=()=>he(jm),HN=(e,t)=>t,NB=(e,t,r)=>r,qN=(e,t,r,n)=>n;function Lie(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}var MB=Q(lo,e=>(0,AB.default)(e,t=>t.coordinate)),GN=Q([Fl,HN,NB,qN],uk),OB=Q([GN,jl],zm),IB=(e,t,r)=>{if(t!=null){var n=Fl(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},FB=Q([Fl,HN,NB,qN],mk),wv=Q([to,ro,et,cr,lo,qN,FB,lu],pk),jB=Q([GN,wv],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),YN=Q(lo,OB,ik);function _ie(e,t){return e!=null?e:t}var zie=(e,t,r,n,i,o,a)=>{if(!(t==null||o==null)){var{chartData:s,computedData:l,dataStartIndex:c,dataEndIndex:d}=r,u=[];return e.reduce((p,m)=>{var g,{dataDefinedOnItem:f,settings:y}=m,h=_ie(f,s),v=Lie(h,c,d),b=(g=y==null?void 0:y.dataKey)!==null&&g!==void 0?g:n==null?void 0:n.dataKey,w=y==null?void 0:y.nameKey,k;if(n!=null&&n.dataKey&&!(n!=null&&n.allowDuplicatedCategory)&&Array.isArray(v)&&a==="axis"?k=Kp(v,n.dataKey,i):k=o(v,t,l,w),Array.isArray(k))k.forEach(x=>{var T=PB(PB({},y),{},{name:x.name,unit:x.unit,color:void 0,fill:void 0});p.push(HP({tooltipEntrySettings:T,dataKey:x.dataKey,payload:x.payload,value:yr(x.payload,x.dataKey),name:x.name}))});else{var S;p.push(HP({tooltipEntrySettings:y,dataKey:b,payload:k,value:yr(k,b),name:(S=yr(k,w))!==null&&S!==void 0?S:y==null?void 0:y.name}))}return p},u)}},LB=Q([FB,OB,Ol,Fn,YN,lu,HN],zie),_B=Q([GN],e=>({isActive:e.active,activeIndex:e.index})),zB=(e,t,r,n,i,o,a,s)=>{if(!(!e||!t||!n||!i||!o)){var l=n5(e.chartX,e.chartY,t,r,s);if(l){var c=o5(l,t),d=JR(c,a,o,n,i),u=i5(t,o,d,l);return{activeIndex:String(d),activeCoordinate:u}}}};function KN(){return KN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},KN.apply(null,arguments)}function $B(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function bk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$B(Object(r),!0).forEach(function(n){$ie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$B(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $ie(e,t,r){return(t=Rie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rie(e){var t=Wie(e,"string");return typeof t=="symbol"?t:t+""}function Wie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Bie(e){var{coordinate:t,payload:r,index:n,offset:i,tooltipAxisBandSize:o,layout:a,cursor:s,tooltipEventType:l,chartName:c}=e,d=t,u=r,p=n;if(!s||!d||c!=="ScatterChart"&&l!=="axis")return null;var m,g;if(c==="ScatterChart")m=d,g=N5;else if(c==="BarChart")m=M5(a,d,i,o),g=e0;else if(a==="radial"){var{cx:f,cy:y,radius:h,startAngle:v,endAngle:b}=t0(d);m={cx:f,cy:y,startAngle:v,endAngle:b,innerRadius:h,outerRadius:h},g=n0}else m={points:a4(a,d,i)},g=Nc;var w=typeof s=="object"&&"className"in s?s.className:void 0,k=bk(bk(bk(bk({stroke:"#ccc",pointerEvents:"none"},i),m),Ce(s,!1)),{},{payload:u,payloadIndex:p,className:Oe("recharts-tooltip-cursor",w)});return(0,Rm.isValidElement)(s)?(0,Rm.cloneElement)(s,k):(0,Rm.createElement)(g,k)}function WB(e){var t=EB(),r=ka(),n=$s(),i=yk();return RB.createElement(Bie,KN({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:n,tooltipAxisBandSize:t,chartName:i}))}var wk=$(W()),JN=(0,wk.createContext)(null),BB=()=>(0,wk.useContext)(JN);var kv=$(W());var HB=$(VB(),1);var qB=HB.default;var Wm=new qB;var kk="recharts.syncEvent.tooltip",QN="recharts.syncEvent.brush";function Bm(e,t){if(t){var r=Number.parseInt(t,10);if(!hr(r))return e==null?void 0:e[r]}}var Hie={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},GB=vr({name:"options",initialState:Hie,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),YB=GB.reducer,{createEventEmitter:KB}=GB.actions;function JB(e){return e.tooltip.syncInteraction}var qie={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},XB=vr({name:"chartData",initialState:qie,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:ZN,setDataStartEndIndexes:QB,setComputedData:Gie}=XB.actions,ZB=XB.reducer;var e3=()=>{};function Yie(){var e=he(V0),t=he(H0),r=ut(),n=he(QA),i=he(lo),o=$s(),a=Ac(),s=he(l=>l.rootProps.className);(0,kv.useEffect)(()=>{if(e==null)return e3;var l=(c,d,u)=>{if(t!==u&&e===c){if(n==="index"){r(d);return}if(i!=null){var p;if(typeof n=="function"){var m={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},g=n(i,m);p=i[g]}else n==="value"&&(p=i.find(S=>String(S.value)===d.payload.label));var{coordinate:f}=d.payload;if(p==null||d.payload.active===!1||f==null||a==null){r(lk({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:y,y:h}=f,v=Math.min(y,a.x+a.width),b=Math.min(h,a.y+a.height),w={x:o==="horizontal"?p.coordinate:v,y:o==="horizontal"?b:p.coordinate},k=lk({active:d.payload.active,coordinate:w,dataKey:d.payload.dataKey,index:String(p.index),label:d.payload.label});r(k)}}};return Wm.on(kk,l),()=>{Wm.off(kk,l)}},[s,r,t,e,n,i,o,a])}function Kie(){var e=he(V0),t=he(H0),r=ut();(0,kv.useEffect)(()=>{if(e==null)return e3;var n=(i,o,a)=>{t!==a&&e===i&&r(QB(o))};return Wm.on(QN,n),()=>{Wm.off(QN,n)}},[r,t,e])}function t3(){var e=ut();(0,kv.useEffect)(()=>{e(KB())},[e]),Yie(),Kie()}function r3(e,t,r,n,i,o){var a=he(p=>IB(p,e,t)),s=he(H0),l=he(V0),c=he(QA),d=he(JB),u=d==null?void 0:d.active;(0,kv.useEffect)(()=>{if(!u&&l!=null&&s!=null){var p=lk({active:o,coordinate:r,dataKey:a,index:i,label:typeof n=="number"?String(n):n});Wm.emit(kk,l,p,s)}},[u,r,a,i,n,s,l,c,o])}function n3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function i3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?n3(Object(r),!0).forEach(function(n){Jie(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Jie(e,t,r){return(t=Xie(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xie(e){var t=Qie(e,"string");return typeof t=="symbol"?t:t+""}function Qie(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zie(e){return e.dataKey}function eoe(e,t){return Ea.isValidElement(e)?Ea.cloneElement(e,t):typeof e=="function"?Ea.createElement(e,t):Ea.createElement(y5,t)}var o3=[],toe={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!no.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function Li(e){var t=en(e,toe),{active:r,allowEscapeViewBox:n,animationDuration:i,animationEasing:o,content:a,filterNull:s,isAnimationActive:l,offset:c,payloadUniqBy:d,position:u,reverseDirection:p,useTranslate3d:m,wrapperStyle:g,cursor:f,shared:y,trigger:h,defaultIndex:v,portal:b,axisId:w}=t,k=ut(),S=typeof v=="number"?String(v):v;(0,a3.useEffect)(()=>{k(pB({shared:y,trigger:h,axisId:w,active:r,defaultIndex:S}))},[k,y,h,w,r,S]);var x=Ac(),T=Yx(),E=sB(y),{activeIndex:C,isActive:N}=he(X=>_B(X,E,h,S)),D=he(X=>LB(X,E,h,S)),A=he(X=>YN(X,E,h,S)),P=he(X=>jB(X,E,h,S)),I=D,M=BB(),O=r!=null?r:N,[F,L]=X$([I,O]),B=E==="axis"?A:void 0;r3(E,h,P,B,C,O);var j=b!=null?b:M;if(j==null)return null;var _=I!=null?I:o3;O||(_=o3),s&&_.length&&(_=D$(I.filter(X=>X.value!=null&&(X.hide!==!0||t.includeHidden)),d,Zie));var H=_.length>0,q=Ea.createElement(Gx,{allowEscapeViewBox:n,animationDuration:i,animationEasing:o,isAnimationActive:l,active:O,coordinate:P,hasPayload:H,offset:c,position:u,reverseDirection:p,useTranslate3d:m,viewBox:x,wrapperStyle:g,lastBoundingBox:F,innerRef:L,hasPortalFromProps:!!b},eoe(a,i3(i3({},t),{},{payload:_,label:B,active:O,coordinate:P,accessibilityLayer:T})));return Ea.createElement(Ea.Fragment,null,(0,s3.createPortal)(q,j),O&&Ea.createElement(WB,{cursor:f,tooltipEventType:E,coordinate:P,payload:I,index:C}))}var Sk=$(W()),Gn=$(W()),f3=$(p3());var soe=!1,cu=function(t,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];if(soe&&typeof console!="undefined"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!t))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var a=0;console.warn(r.replace(/%s/g,()=>i[a++]))}};function m3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function nM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?m3(Object(r),!0).forEach(function(n){loe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function loe(e,t,r){return(t=coe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function coe(e){var t=doe(e,"string");return typeof t=="symbol"?t:t+""}function doe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var is=(0,Gn.forwardRef)((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:i="100%",height:o="100%",minWidth:a=0,minHeight:s,maxHeight:l,children:c,debounce:d=0,id:u,className:p,onResize:m,style:g={}}=e,f=(0,Gn.useRef)(null),y=(0,Gn.useRef)();y.current=m,(0,Gn.useImperativeHandle)(t,()=>f.current);var[h,v]=(0,Gn.useState)({containerWidth:n.width,containerHeight:n.height}),b=(0,Gn.useCallback)((k,S)=>{v(x=>{var T=Math.round(k),E=Math.round(S);return x.containerWidth===T&&x.containerHeight===E?x:{containerWidth:T,containerHeight:E}})},[]);(0,Gn.useEffect)(()=>{var k=E=>{var C,{width:N,height:D}=E[0].contentRect;b(N,D),(C=y.current)===null||C===void 0||C.call(y,N,D)};d>0&&(k=(0,f3.default)(k,d,{trailing:!0,leading:!1}));var S=new ResizeObserver(k),{width:x,height:T}=f.current.getBoundingClientRect();return b(x,T),S.observe(f.current),()=>{S.disconnect()}},[b,d]);var w=(0,Gn.useMemo)(()=>{var{containerWidth:k,containerHeight:S}=h;if(k<0||S<0)return null;cu(Tl(i)||Tl(o),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,i,o),cu(!r||r>0,"The aspect(%s) must be greater than zero.",r);var x=Tl(i)?k:i,T=Tl(o)?S:o;return r&&r>0&&(x?T=x/r:T&&(x=T*r),l&&T>l&&(T=l)),cu(x>0||T>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,x,T,i,o,a,s,r),Sk.Children.map(c,E=>(0,Gn.cloneElement)(E,{width:x,height:T,style:nM({height:"100%",width:"100%",maxHeight:T,maxWidth:x},E.props.style)}))},[r,c,o,l,s,a,h,i]);return Sk.createElement("div",{id:u?"".concat(u):void 0,className:Oe("recharts-responsive-container",p),style:nM(nM({},g),{},{width:i,height:o,minWidth:a,minHeight:s,maxHeight:l}),ref:f},w)});var iM=e=>null;iM.displayName="Cell";var sM=$(W()),Ck=$(W());function g3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function oM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?g3(Object(r),!0).forEach(function(n){uoe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uoe(e,t,r){return(t=poe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function poe(e){var t=moe(e,"string");return typeof t=="symbol"?t:t+""}function moe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Um={widthCache:{},cacheCount:0},foe=2e3,goe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},h3="recharts_measurement_span";function hoe(e){var t=oM({},e);return Object.keys(t).forEach(r=>{t[r]||delete t[r]}),t}var du=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||no.isSsr)return{width:0,height:0};var n=hoe(r),i=JSON.stringify({text:t,copyStyle:n});if(Um.widthCache[i])return Um.widthCache[i];try{var o=document.getElementById(h3);o||(o=document.createElement("span"),o.setAttribute("id",h3),o.setAttribute("aria-hidden","true"),document.body.appendChild(o));var a=oM(oM({},goe),n);Object.assign(o.style,a),o.textContent="".concat(t);var s=o.getBoundingClientRect(),l={width:s.width,height:s.height};return Um.widthCache[i]=l,++Um.cacheCount>foe&&(Um.cacheCount=0,Um.widthCache={}),l}catch(c){return{width:0,height:0}}};var v3=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,y3=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,voe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,yoe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,w3={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},boe=Object.keys(w3),Vm="NaN";function woe(e,t){return e*w3[t]}var Hm=class e{static parse(t){var r,[,n,i]=(r=yoe.exec(t))!==null&&r!==void 0?r:[];return new e(parseFloat(n),i!=null?i:"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,hr(t)&&(this.unit=""),r!==""&&!voe.test(r)&&(this.num=NaN,this.unit=""),boe.includes(r)&&(this.num=woe(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new e(NaN,""):new e(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new e(NaN,""):new e(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new e(NaN,""):new e(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return hr(this.num)}};function x3(e){if(e.includes(Vm))return Vm;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,i,o]=(r=v3.exec(t))!==null&&r!==void 0?r:[],a=Hm.parse(n!=null?n:""),s=Hm.parse(o!=null?o:""),l=i==="*"?a.multiply(s):a.divide(s);if(l.isNaN())return Vm;t=t.replace(v3,l.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var c,[,d,u,p]=(c=y3.exec(t))!==null&&c!==void 0?c:[],m=Hm.parse(d!=null?d:""),g=Hm.parse(p!=null?p:""),f=u==="+"?m.add(g):m.subtract(g);if(f.isNaN())return Vm;t=t.replace(y3,f.toString())}return t}var b3=/\(([^()]*)\)/;function xoe(e){for(var t=e,r;(r=b3.exec(t))!=null;){var[,n]=r;t=t.replace(b3,x3(n))}return t}function koe(e){var t=e.replace(/\s+/g,"");return t=xoe(t),t=x3(t),t}function Soe(e){try{return koe(e)}catch(t){return Vm}}function Tk(e){var t=Soe(e.slice(5,-1));return t===Vm?"":t}var Toe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],Coe=["dx","dy","angle","className","breakAll"];function aM(){return aM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},aM.apply(null,arguments)}function k3(e,t){if(e==null)return{};var r,n,i=Eoe(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Eoe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var C3=/[ \f\n\r\t\v\u2028\u2029]+/,E3=e=>{var{children:t,breakAll:r,style:n}=e;try{var i=[];Je(t)||(r?i=t.toString().split(""):i=t.toString().split(C3));var o=i.map(s=>({word:s,width:du(s,n).width})),a=r?0:du("\xA0",n).width;return{wordsWithComputedWidth:o,spaceWidth:a}}catch(s){return null}},Doe=(e,t,r,n,i)=>{var{maxLines:o,children:a,style:s,breakAll:l}=e,c=ge(o),d=a,u=function(){var N=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return N.reduce((D,A)=>{var{word:P,width:I}=A,M=D[D.length-1];if(M&&(n==null||i||M.width+I+r<Number(n)))M.words.push(P),M.width+=I+r;else{var O={words:[P],width:I};D.push(O)}return D},[])},p=u(t),m=C=>C.reduce((N,D)=>N.width>D.width?N:D);if(!c||i)return p;var g=p.length>o||m(p).width>Number(n);if(!g)return p;for(var f="\u2026",y=C=>{var N=d.slice(0,C),D=E3({breakAll:l,style:s,children:N+f}).wordsWithComputedWidth,A=u(D),P=A.length>o||m(A).width>Number(n);return[P,A]},h=0,v=d.length-1,b=0,w;h<=v&&b<=d.length-1;){var k=Math.floor((h+v)/2),S=k-1,[x,T]=y(S),[E]=y(k);if(!x&&!E&&(h=k+1),x&&E&&(v=k-1),!x&&E){w=T;break}b++}return w||p},S3=e=>{var t=Je(e)?[]:e.toString().split(C3);return[{words:t}]},Poe=e=>{var{width:t,scaleToFit:r,children:n,style:i,breakAll:o,maxLines:a}=e;if((t||r)&&!no.isSsr){var s,l,c=E3({breakAll:o,children:n,style:i});if(c){var{wordsWithComputedWidth:d,spaceWidth:u}=c;s=d,l=u}else return S3(n);return Doe({breakAll:o,children:n,maxLines:a,style:i},s,l,t,r)}return S3(n)},T3="#808080",Sv=(0,Ck.forwardRef)((e,t)=>{var{x:r=0,y:n=0,lineHeight:i="1em",capHeight:o="0.71em",scaleToFit:a=!1,textAnchor:s="start",verticalAnchor:l="end",fill:c=T3}=e,d=k3(e,Toe),u=(0,Ck.useMemo)(()=>Poe({breakAll:d.breakAll,children:d.children,maxLines:d.maxLines,scaleToFit:a,style:d.style,width:d.width}),[d.breakAll,d.children,d.maxLines,a,d.style,d.width]),{dx:p,dy:m,angle:g,className:f,breakAll:y}=d,h=k3(d,Coe);if(!Mn(r)||!Mn(n))return null;var v=r+(ge(p)?p:0),b=n+(ge(m)?m:0),w;switch(l){case"start":w=Tk("calc(".concat(o,")"));break;case"middle":w=Tk("calc(".concat((u.length-1)/2," * -").concat(i," + (").concat(o," / 2))"));break;default:w=Tk("calc(".concat(u.length-1," * -").concat(i,")"));break}var k=[];if(a){var S=u[0].width,{width:x}=d;k.push("scale(".concat(ge(x)?x/S:1,")"))}return g&&k.push("rotate(".concat(g,", ").concat(v,", ").concat(b,")")),k.length&&(h.transform=k.join(" ")),sM.createElement("text",aM({},Ce(h,!0),{ref:t,x:v,y:b,className:Oe("recharts-text",f),textAnchor:s,fill:c.includes("url")?T3:c}),u.map((T,E)=>{var C=T.words.join(y?"":" ");return sM.createElement("tspan",{x:v,dy:E===0?w:i,key:"".concat(C,"-").concat(E)},C)}))});Sv.displayName="Text";var os=$(W()),as=$(W());var Aoe=["offset"],Noe=["labelRef"];function D3(e,t){if(e==null)return{};var r,n,i=Moe(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Moe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function P3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function tn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?P3(Object(r),!0).forEach(function(n){Ooe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ooe(e,t,r){return(t=Ioe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ioe(e){var t=Foe(e,"string");return typeof t=="symbol"?t:t+""}function Foe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _l(){return _l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_l.apply(null,arguments)}var joe=e=>{var{value:t,formatter:r}=e,n=Je(e.children)?t:e.children;return typeof r=="function"?r(n):n},Tv=e=>e!=null&&typeof e=="function",Loe=(e,t)=>{var r=Vr(t-e),n=Math.min(Math.abs(t-e),360);return r*n},_oe=(e,t,r)=>{var{position:n,viewBox:i,offset:o,className:a}=e,{cx:s,cy:l,innerRadius:c,outerRadius:d,startAngle:u,endAngle:p,clockWise:m}=i,g=(c+d)/2,f=Loe(u,p),y=f>=0?1:-1,h,v;n==="insideStart"?(h=u+y*o,v=m):n==="insideEnd"?(h=p-y*o,v=!m):n==="end"&&(h=p+y*o,v=m),v=f<=0?v:!v;var b=Lr(s,l,g,h),w=Lr(s,l,g,h+(v?1:-1)*359),k="M".concat(b.x,",").concat(b.y,`
    A`).concat(g,",").concat(g,",0,1,").concat(v?0:1,`,
    `).concat(w.x,",").concat(w.y),S=Je(e.id)?Io("recharts-radial-line-"):e.id;return os.createElement("text",_l({},r,{dominantBaseline:"central",className:Oe("recharts-radial-bar-label",a)}),os.createElement("defs",null,os.createElement("path",{id:S,d:k})),os.createElement("textPath",{xlinkHref:"#".concat(S)},t))},zoe=e=>{var{viewBox:t,offset:r,position:n}=e,{cx:i,cy:o,innerRadius:a,outerRadius:s,startAngle:l,endAngle:c}=t,d=(l+c)/2;if(n==="outside"){var{x:u,y:p}=Lr(i,o,s+r,d);return{x:u,y:p,textAnchor:u>=i?"start":"end",verticalAnchor:"middle"}}if(n==="center")return{x:i,y:o,textAnchor:"middle",verticalAnchor:"middle"};if(n==="centerTop")return{x:i,y:o,textAnchor:"middle",verticalAnchor:"start"};if(n==="centerBottom")return{x:i,y:o,textAnchor:"middle",verticalAnchor:"end"};var m=(a+s)/2,{x:g,y:f}=Lr(i,o,m,d);return{x:g,y:f,textAnchor:"middle",verticalAnchor:"middle"}},$oe=(e,t)=>{var{parentViewBox:r,offset:n,position:i}=e,{x:o,y:a,width:s,height:l}=t,c=l>=0?1:-1,d=c*n,u=c>0?"end":"start",p=c>0?"start":"end",m=s>=0?1:-1,g=m*n,f=m>0?"end":"start",y=m>0?"start":"end";if(i==="top"){var h={x:o+s/2,y:a-c*n,textAnchor:"middle",verticalAnchor:u};return tn(tn({},h),r?{height:Math.max(a-r.y,0),width:s}:{})}if(i==="bottom"){var v={x:o+s/2,y:a+l+d,textAnchor:"middle",verticalAnchor:p};return tn(tn({},v),r?{height:Math.max(r.y+r.height-(a+l),0),width:s}:{})}if(i==="left"){var b={x:o-g,y:a+l/2,textAnchor:f,verticalAnchor:"middle"};return tn(tn({},b),r?{width:Math.max(b.x-r.x,0),height:l}:{})}if(i==="right"){var w={x:o+s+g,y:a+l/2,textAnchor:y,verticalAnchor:"middle"};return tn(tn({},w),r?{width:Math.max(r.x+r.width-w.x,0),height:l}:{})}var k=r?{width:s,height:l}:{};return i==="insideLeft"?tn({x:o+g,y:a+l/2,textAnchor:y,verticalAnchor:"middle"},k):i==="insideRight"?tn({x:o+s-g,y:a+l/2,textAnchor:f,verticalAnchor:"middle"},k):i==="insideTop"?tn({x:o+s/2,y:a+d,textAnchor:"middle",verticalAnchor:p},k):i==="insideBottom"?tn({x:o+s/2,y:a+l-d,textAnchor:"middle",verticalAnchor:u},k):i==="insideTopLeft"?tn({x:o+g,y:a+d,textAnchor:y,verticalAnchor:p},k):i==="insideTopRight"?tn({x:o+s-g,y:a+d,textAnchor:f,verticalAnchor:p},k):i==="insideBottomLeft"?tn({x:o+g,y:a+l-d,textAnchor:y,verticalAnchor:u},k):i==="insideBottomRight"?tn({x:o+s-g,y:a+l-d,textAnchor:f,verticalAnchor:u},k):i&&typeof i=="object"&&(ge(i.x)||Tl(i.x))&&(ge(i.y)||Tl(i.y))?tn({x:o+di(i.x,s),y:a+di(i.y,l),textAnchor:"end",verticalAnchor:"end"},k):tn({x:o+s/2,y:a+l/2,textAnchor:"middle",verticalAnchor:"middle"},k)},Roe=e=>"cx"in e&&ge(e.cx);function Yn(e){var{offset:t=5}=e,r=D3(e,Aoe),n=tn({offset:t},r),{viewBox:i,position:o,value:a,children:s,content:l,className:c="",textBreakAll:d,labelRef:u}=n,p=Ac(),m=i||p;if(!m||Je(a)&&Je(s)&&!(0,as.isValidElement)(l)&&typeof l!="function")return null;if((0,as.isValidElement)(l)){var{labelRef:g}=n,f=D3(n,Noe);return(0,as.cloneElement)(l,f)}var y;if(typeof l=="function"){if(y=(0,as.createElement)(l,n),(0,as.isValidElement)(y))return y}else y=joe(n);var h=Roe(m),v=Ce(n,!0);if(h&&(o==="insideStart"||o==="insideEnd"||o==="end"))return _oe(n,y,v);var b=h?zoe(n):$oe(n,m);return os.createElement(Sv,_l({ref:u,className:Oe("recharts-label",c)},v,b,{breakAll:d}),y)}Yn.displayName="Label";var A3=e=>{var{cx:t,cy:r,angle:n,startAngle:i,endAngle:o,r:a,radius:s,innerRadius:l,outerRadius:c,x:d,y:u,top:p,left:m,width:g,height:f,clockWise:y,labelViewBox:h}=e;if(h)return h;if(ge(g)&&ge(f)){if(ge(d)&&ge(u))return{x:d,y:u,width:g,height:f};if(ge(p)&&ge(m))return{x:p,y:m,width:g,height:f}}if(ge(d)&&ge(u))return{x:d,y:u,width:0,height:0};if(ge(t)&&ge(r))return{cx:t,cy:r,startAngle:i||n||0,endAngle:o||n||0,innerRadius:l||0,outerRadius:c||s||a||0,clockWise:y};if(e.viewBox)return e.viewBox},Woe=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?os.createElement(Yn,_l({key:"label-implicit"},n)):Mn(e)?os.createElement(Yn,_l({key:"label-implicit",value:e},n)):(0,as.isValidElement)(e)?e.type===Yn?(0,as.cloneElement)(e,tn({key:"label-implicit"},n)):os.createElement(Yn,_l({key:"label-implicit",content:e},n)):Tv(e)?os.createElement(Yn,_l({key:"label-implicit",content:e},n)):e&&typeof e=="object"?os.createElement(Yn,_l({},e,{key:"label-implicit"},n)):null},Boe=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var{children:i,labelRef:o}=t,a=A3(t),s=Xp(i,Yn).map((c,d)=>(0,as.cloneElement)(c,{viewBox:r||a,key:"label-".concat(d)}));if(!n)return s;var l=Woe(t.label,r||a,o);return[l,...s]};Yn.parseViewBox=A3;Yn.renderCallByParent=Boe;var $c=$(W()),z3=$(W()),$3=$(F3());var Koe=["valueAccessor"],Joe=["data","dataKey","clockWise","id","textBreakAll"];function Ek(){return Ek=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ek.apply(null,arguments)}function j3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function L3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?j3(Object(r),!0).forEach(function(n){Xoe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Xoe(e,t,r){return(t=Qoe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qoe(e){var t=Zoe(e,"string");return typeof t=="symbol"?t:t+""}function Zoe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _3(e,t){if(e==null)return{};var r,n,i=eae(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function eae(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var tae=e=>Array.isArray(e.value)?(0,$3.default)(e.value):e.value;function Da(e){var{valueAccessor:t=tae}=e,r=_3(e,Koe),{data:n,dataKey:i,clockWise:o,id:a,textBreakAll:s}=r,l=_3(r,Joe);return!n||!n.length?null:$c.createElement(Bt,{className:"recharts-label-list"},n.map((c,d)=>{var u=Je(i)?t(c,d):yr(c&&c.payload,i),p=Je(a)?{}:{id:"".concat(a,"-").concat(d)};return $c.createElement(Yn,Ek({},Ce(c,!0),l,p,{parentViewBox:c.parentViewBox,value:u,textBreakAll:s,viewBox:Yn.parseViewBox(Je(o)?c:L3(L3({},c),{},{clockWise:o})),key:"label-".concat(d),index:d}))}))}Da.displayName="LabelList";function rae(e,t){return e?e===!0?$c.createElement(Da,{key:"labelList-implicit",data:t}):$c.isValidElement(e)||Tv(e)?$c.createElement(Da,{key:"labelList-implicit",data:t,content:e}):typeof e=="object"?$c.createElement(Da,Ek({data:t},e,{key:"labelList-implicit"})):null:null}function nae(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var{children:n}=e,i=Xp(n,Da).map((a,s)=>(0,z3.cloneElement)(a,{data:t,key:"labelList-".concat(s)}));if(!r)return i;var o=rae(e.label,t);return[o,...i]}Da.renderCallByParent=nae;var R3=$(W());function uM(){return uM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uM.apply(null,arguments)}var qm=e=>{var{cx:t,cy:r,r:n,className:i}=e,o=Oe("recharts-dot",i);return t===+t&&r===+r&&n===+n?R3.createElement("circle",uM({},Ce(e,!1),Jp(e),{className:o,cx:t,cy:r,r:n})):null};var iae={radiusAxis:{},angleAxis:{}},W3=vr({name:"polarAxis",initialState:iae,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:B5e,removeRadiusAxis:U5e,addAngleAxis:V5e,removeAngleAxis:H5e}=W3.actions,B3=W3.reducer;var X3=$(W());var oae={countOfBars:0,cartesianItems:[],polarItems:[]},U3=vr({name:"graphicalItems",initialState:oae,reducers:{addBar(e){e.countOfBars+=1},removeBar(e){e.countOfBars-=1},addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},removeCartesianGraphicalItem(e,t){var r=_o(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var r=_o(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)}}}),{addBar:V3,removeBar:H3,addCartesianGraphicalItem:q3,removeCartesianGraphicalItem:G3,addPolarGraphicalItem:aae,removePolarGraphicalItem:sae}=U3.actions,Y3=U3.reducer;function K3(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function J3(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?K3(Object(r),!0).forEach(function(n){lae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K3(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lae(e,t,r){return(t=cae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cae(e){var t=dae(e,"string");return typeof t=="symbol"?t:t+""}function dae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Q3(e){var t=ut();return(0,X3.useEffect)(()=>{var r=J3(J3({},e),{},{stackId:pm(e.stackId)});return t(q3(r)),()=>{t(G3(r))}},[t,e]),null}var Rc=$(W()),Cv=$(W()),a6=$(t6());var Gm=$(W()),Ym=$(W());function Dk(){return Dk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Dk.apply(null,arguments)}var r6=(e,t,r,n,i)=>{var o=r-n,a;return a="M ".concat(e,",").concat(t),a+="L ".concat(e+r,",").concat(t),a+="L ".concat(e+r-o/2,",").concat(t+i),a+="L ".concat(e+r-o/2-n,",").concat(t+i),a+="L ".concat(e,",").concat(t," Z"),a},pae={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},n6=e=>{var t=en(e,pae),r=(0,Ym.useRef)(),[n,i]=(0,Ym.useState)(-1);(0,Ym.useEffect)(()=>{if(r.current&&r.current.getTotalLength)try{var y=r.current.getTotalLength();y&&i(y)}catch(h){}},[]);var{x:o,y:a,upperWidth:s,lowerWidth:l,height:c,className:d}=t,{animationEasing:u,animationDuration:p,animationBegin:m,isUpdateAnimationActive:g}=t;if(o!==+o||a!==+a||s!==+s||l!==+l||c!==+c||s===0&&l===0||c===0)return null;var f=Oe("recharts-trapezoid",d);return g?Gm.createElement(io,{canBegin:n>0,from:{upperWidth:0,lowerWidth:0,height:c,x:o,y:a},to:{upperWidth:s,lowerWidth:l,height:c,x:o,y:a},duration:p,animationEasing:u,isActive:g},y=>{var{upperWidth:h,lowerWidth:v,height:b,x:w,y:k}=y;return Gm.createElement(io,{canBegin:n>0,from:"0px ".concat(n===-1?1:n,"px"),to:"".concat(n,"px 0px"),attributeName:"strokeDasharray",begin:m,duration:p,easing:u},Gm.createElement("path",Dk({},Ce(t,!0),{className:f,d:r6(w,k,h,v,b),ref:r})))}):Gm.createElement("g",null,Gm.createElement("path",Dk({},Ce(t,!0),{className:f,d:r6(o,a,s,l,c)})))};var mae=["option","shapeType","propTransformer","activeClassName","isActive"];function fae(e,t){if(e==null)return{};var r,n,i=gae(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function gae(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function i6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Pk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i6(Object(r),!0).forEach(function(n){hae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i6(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hae(e,t,r){return(t=vae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vae(e){var t=yae(e,"string");return typeof t=="symbol"?t:t+""}function yae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bae(e,t){return Pk(Pk({},t),e)}function wae(e,t){return e==="symbols"}function o6(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return Rc.createElement(e0,r);case"trapezoid":return Rc.createElement(n6,r);case"sector":return Rc.createElement(n0,r);case"symbols":if(wae(t,r))return Rc.createElement(OD,r);break;default:return null}}function xae(e){return(0,Cv.isValidElement)(e)?e.props:e}function s6(e){var{option:t,shapeType:r,propTransformer:n=bae,activeClassName:i="recharts-active-shape",isActive:o}=e,a=fae(e,mae),s;if((0,Cv.isValidElement)(t))s=(0,Cv.cloneElement)(t,Pk(Pk({},a),xae(t)));else if(typeof t=="function")s=t(a);else if((0,a6.default)(t)&&typeof t!="boolean"){var l=n(t,a);s=Rc.createElement(o6,{shapeType:r,elementProps:l})}else{var c=a;s=Rc.createElement(o6,{shapeType:r,elementProps:c})}return o?Rc.createElement(Bt,{className:i},s):s}var mM=(e,t)=>{var r=ut();return(n,i)=>o=>{e==null||e(n,i,o),r(ok({activeIndex:String(i),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}},fM=e=>{var t=ut();return(r,n)=>i=>{e==null||e(r,n,i),t(mB())}},gM=(e,t)=>{var r=ut();return(n,i)=>o=>{e==null||e(n,i,o),r(fB({activeIndex:String(i),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}};var l6=$(W());function Km(e){var{fn:t,args:r}=e,n=ut(),i=yt();return(0,l6.useEffect)(()=>{if(!i){var o=t(r);return n(dB(o)),()=>{n(uB(o))}}},[t,r,n,i]),null}var c6=$(W());var kae=()=>{};function Jm(e){var{legendPayload:t}=e,r=ut(),n=yt();return(0,c6.useEffect)(()=>n?kae:(r(m5(t)),()=>{r(f5(t))}),[r,n,t]),null}var hM=$(W());function Xm(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=(0,hM.useRef)(Io(t)),n=(0,hM.useRef)(e);return n.current!==e&&(r.current=Io(t),n.current=e),r.current}var vM=$(W()),Ak=$(W());function d6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function u6(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?d6(Object(r),!0).forEach(function(n){Sae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d6(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Sae(e,t,r){return(t=Tae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tae(e){var t=Cae(e,"string");return typeof t=="symbol"?t:t+""}function Cae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Eae=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:i,dataKey:o}=e;if(i===!1||t.x==null||t.y==null)return null;var a=u6(u6({index:r,dataKey:o,cx:t.x,cy:t.y,r:4,fill:n!=null?n:"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},Ce(i,!1)),Jp(i)),s;return(0,Ak.isValidElement)(i)?s=(0,Ak.cloneElement)(i,a):typeof i=="function"?s=i(a):s=vM.createElement(qm,a),vM.createElement(Bt,{className:"recharts-active-dot"},s)};function Ev(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:i}=e,o=VN(),a=he(Ll),s=he(hk);if(!a)return null;var l,c=o.dataKey;if(c&&!o.allowDuplicatedCategory){var d=typeof c=="function"?u=>c(u.payload):"payload.".concat(c);l=Kp(t,d,s)}else l=t==null?void 0:t[Number(a)];return Je(l)?null:Eae({point:l,childIndex:Number(a),mainColor:r,dataKey:i,activeDot:n})}var p6=$(W());var m6=()=>{var e=ut();return(0,p6.useEffect)(()=>(e(V3()),()=>{e(H3())})),null};var Vt=$(W()),Aa=$(W());var Pa=$(W()),ef=$(W());var Qm=$(W()),ss=$(W());var Dae=["children"];function Pae(e,t){if(e==null)return{};var r,n,i=Aae(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Aae(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var f6=()=>{},g6=(0,ss.createContext)({addErrorBar:f6,removeErrorBar:f6}),Nae={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},h6=(0,ss.createContext)(Nae);function Nk(e){var{children:t}=e,r=Pae(e,Dae);return Qm.createElement(h6.Provider,{value:r},t)}var v6=()=>(0,ss.useContext)(h6),Zm=e=>{var{children:t,xAxisId:r,yAxisId:n,zAxisId:i,dataKey:o,data:a,stackId:s,hide:l,type:c,barSize:d}=e,[u,p]=Qm.useState([]),m=(0,ss.useCallback)(y=>{p(h=>[...h,y])},[p]),g=(0,ss.useCallback)(y=>{p(h=>h.filter(v=>v!==y))},[p]),f=yt();return Qm.createElement(g6.Provider,{value:{addErrorBar:m,removeErrorBar:g}},Qm.createElement(Q3,{type:c,data:a,xAxisId:r,yAxisId:n,zAxisId:i,dataKey:o,errorBars:u,stackId:s,hide:l,barSize:d,isPanorama:f}),t)};function y6(e){var{addErrorBar:t,removeErrorBar:r}=(0,ss.useContext)(g6);return(0,ss.useEffect)(()=>(t(e),()=>{r(e)}),[t,r,e]),null}var b6=e=>{var t=yt();return he(r=>ui(r,"xAxis",e,t))},w6=e=>{var t=yt();return he(r=>ui(r,"yAxis",e,t))};var Mae=["direction","width","dataKey","isAnimationActive","animationBegin","animationDuration","animationEasing"];function x6(e,t,r){return(t=Oae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Oae(e){var t=Iae(e,"string");return typeof t=="symbol"?t:t+""}function Iae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dv(){return Dv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Dv.apply(null,arguments)}function Fae(e,t){if(e==null)return{};var r,n,i=jae(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function jae(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Lae(e){var{direction:t,width:r,dataKey:n,isAnimationActive:i,animationBegin:o,animationDuration:a,animationEasing:s}=e,l=Fae(e,Mae),c=Ce(l,!1),{data:d,dataPointFormatter:u,xAxisId:p,yAxisId:m,errorBarOffset:g}=v6(),f=b6(p),y=w6(m);if((f==null?void 0:f.scale)==null||(y==null?void 0:y.scale)==null||d==null||t==="x"&&f.type!=="number")return null;var h=d.map(v=>{var{x:b,y:w,value:k,errorVal:S}=u(v,n,t);if(!S)return null;var x=[],T,E;if(Array.isArray(S)?[T,E]=S:T=E=S,t==="x"){var{scale:C}=f,N=w+g,D=N+r,A=N-r,P=C(k-T),I=C(k+E);x.push({x1:I,y1:D,x2:I,y2:A}),x.push({x1:P,y1:N,x2:I,y2:N}),x.push({x1:P,y1:D,x2:P,y2:A})}else if(t==="y"){var{scale:M}=y,O=b+g,F=O-r,L=O+r,B=M(k-T),j=M(k+E);x.push({x1:F,y1:j,x2:L,y2:j}),x.push({x1:O,y1:B,x2:O,y2:j}),x.push({x1:F,y1:B,x2:L,y2:B})}var _="".concat(b+g,"px ").concat(w+g,"px");return Pa.createElement(Bt,Dv({className:"recharts-errorBar",key:"bar-".concat(x.map(H=>"".concat(H.x1,"-").concat(H.x2,"-").concat(H.y1,"-").concat(H.y2)))},c),x.map(H=>{var q=i?{transformOrigin:"".concat(H.x1-5,"px")}:void 0;return Pa.createElement(io,{from:{transform:"scaleY(0)",transformOrigin:_},to:{transform:"scaleY(1)",transformOrigin:_},begin:o,easing:s,isActive:i,duration:a,key:"line-".concat(H.x1,"-").concat(H.x2,"-").concat(H.y1,"-").concat(H.y2),style:{transformOrigin:_}},Pa.createElement("line",Dv({},H,{style:q})))}))});return Pa.createElement(Bt,{className:"recharts-errorBars"},h)}var k6=(0,ef.createContext)(void 0);function _ae(e){var t=(0,ef.useContext)(k6);return e!=null?e:t!=null?t:"x"}function Ok(e){var{direction:t,children:r}=e;return Pa.createElement(k6.Provider,{value:t},r)}var S6={stroke:"black",strokeWidth:1.5,width:5,offset:0,isAnimationActive:!0,animationBegin:0,animationDuration:400,animationEasing:"ease-in-out"};function zae(e){var t=_ae(e.direction),{width:r,isAnimationActive:n,animationBegin:i,animationDuration:o,animationEasing:a}=en(e,S6);return Pa.createElement(Pa.Fragment,null,Pa.createElement(y6,{dataKey:e.dataKey,direction:t}),Pa.createElement(Lae,Dv({},e,{direction:t,width:r,isAnimationActive:n,animationBegin:i,animationDuration:o,animationEasing:a})))}var Mk=class extends ef.Component{render(){return Pa.createElement(zae,this.props)}};x6(Mk,"defaultProps",S6);x6(Mk,"displayName","ErrorBar");var E6=$(W());var $ae=!0,yM="Invariant failed";function T6(e,t){if(!e){if($ae)throw new Error(yM);var r=typeof t=="function"?t():t,n=r?"".concat(yM,": ").concat(r):yM;throw new Error(n)}}var Rae=["x","y"];function bM(){return bM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bM.apply(null,arguments)}function C6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Pv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?C6(Object(r),!0).forEach(function(n){Wae(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C6(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Wae(e,t,r){return(t=Bae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bae(e){var t=Uae(e,"string");return typeof t=="symbol"?t:t+""}function Uae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vae(e,t){if(e==null)return{};var r,n,i=Hae(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Hae(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function qae(e,t){var{x:r,y:n}=e,i=Vae(e,Rae),o="".concat(r),a=parseInt(o,10),s="".concat(n),l=parseInt(s,10),c="".concat(t.height||i.height),d=parseInt(c,10),u="".concat(t.width||i.width),p=parseInt(u,10);return Pv(Pv(Pv(Pv(Pv({},t),i),a?{x:a}:{}),l?{y:l}:{}),{},{height:d,width:p,name:t.name,radius:t.radius})}function wM(e){return E6.createElement(s6,bM({shapeType:"rectangle",propTransformer:qae,activeClassName:"recharts-active-bar"},e))}var D6=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,i)=>{if(ge(t))return t;var o=ge(n)||Je(n);return o?t(n,i):(o||T6(!1),r)}};var xM=$(W());function uu(e,t){var r,n,i=he(c=>Bo(c,e)),o=he(c=>rs(c,t)),a=(r=i==null?void 0:i.allowDataOverflow)!==null&&r!==void 0?r:Ii.allowDataOverflow,s=(n=o==null?void 0:o.allowDataOverflow)!==null&&n!==void 0?n:Fi.allowDataOverflow,l=a||s;return{needClip:l,needClipX:a,needClipY:s}}function tf(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,i=ka(),{needClipX:o,needClipY:a,needClip:s}=uu(t,r);if(!s)return null;var{left:l,top:c,width:d,height:u}=i;return xM.createElement("clipPath",{id:"clipPath-".concat(n)},xM.createElement("rect",{x:o?l:l-d/2,y:a?c:c-u/2,width:o?d:d*2,height:a?u:u*2}))}var Gae=["onMouseEnter","onMouseLeave","onClick"],Yae=["value","background","tooltipPosition"],Kae=["onMouseEnter","onClick","onMouseLeave"];function Av(){return Av=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Av.apply(null,arguments)}function P6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function mi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?P6(Object(r),!0).forEach(function(n){Ik(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P6(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Ik(e,t,r){return(t=Jae(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jae(e){var t=Xae(e,"string");return typeof t=="symbol"?t:t+""}function Xae(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kM(e,t){if(e==null)return{};var r,n,i=Qae(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Qae(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Zae=e=>{var{dataKey:t,name:r,fill:n,legendType:i,hide:o}=e;return[{inactive:o,dataKey:t,type:i,color:n,value:Dl(r,t),payload:e}]};function ese(e){var{dataKey:t,stroke:r,strokeWidth:n,fill:i,name:o,hide:a,unit:s}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:n,fill:i,dataKey:t,nameKey:void 0,name:Dl(o,t),hide:a,type:e.tooltipType,color:e.fill,unit:s}}}function tse(e){var t=he(Ll),{data:r,dataKey:n,background:i,allOtherBarProps:o}=e,{onMouseEnter:a,onMouseLeave:s,onClick:l}=o,c=kM(o,Gae),d=mM(a,n),u=fM(s),p=gM(l,n);if(!i||r==null)return null;var m=Ce(i,!1);return Vt.createElement(Vt.Fragment,null,r.map((g,f)=>{var{value:y,background:h,tooltipPosition:v}=g,b=kM(g,Yae);if(!h)return null;var w=d(g,f),k=u(g,f),S=p(g,f),x=mi(mi(mi(mi(mi({option:i,isActive:String(f)===t},b),{},{fill:"#eee"},h),m),Nh(c,g,f)),{},{onMouseEnter:w,onMouseLeave:k,onClick:S,dataKey:n,index:f,className:"recharts-bar-background-rectangle"});return Vt.createElement(wM,Av({key:"background-bar-".concat(f)},x))}))}function A6(e){var{data:t,props:r,showLabels:n}=e,i=Ce(r,!1),{shape:o,dataKey:a,activeBar:s}=r,l=he(Ll),c=he(vk),{onMouseEnter:d,onClick:u,onMouseLeave:p}=r,m=kM(r,Kae),g=mM(d,a),f=fM(p),y=gM(u,a);return t?Vt.createElement(Vt.Fragment,null,t.map((h,v)=>{var b=s&&String(v)===l&&(c==null||a===c),w=b?s:o,k=mi(mi(mi({},i),h),{},{isActive:b,option:w,index:v,dataKey:a});return Vt.createElement(Bt,Av({className:"recharts-bar-rectangle"},Nh(m,h,v),{onMouseEnter:g(h,v),onMouseLeave:f(h,v),onClick:y(h,v),key:"rectangle-".concat(h==null?void 0:h.x,"-").concat(h==null?void 0:h.y,"-").concat(h==null?void 0:h.value,"-").concat(v)}),Vt.createElement(wM,k))}),n&&Da.renderCallByParent(r,t)):null}function rse(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:i,isAnimationActive:o,animationBegin:a,animationDuration:s,animationEasing:l,onAnimationEnd:c,onAnimationStart:d}=t,u=r.current,p=Xm(t,"recharts-bar-"),[m,g]=(0,Aa.useState)(!1),f=(0,Aa.useCallback)(()=>{typeof c=="function"&&c(),g(!1)},[c]),y=(0,Aa.useCallback)(()=>{typeof d=="function"&&d(),g(!0)},[d]);return Vt.createElement(io,{begin:a,duration:s,isActive:o,easing:l,from:{t:0},to:{t:1},onAnimationEnd:f,onAnimationStart:y,key:p},h=>{var{t:v}=h,b=v===1?n:n.map((w,k)=>{var S=u&&u[k];if(S){var x=Fo(S.x,w.x),T=Fo(S.y,w.y),E=Fo(S.width,w.width),C=Fo(S.height,w.height);return mi(mi({},w),{},{x:x(v),y:T(v),width:E(v),height:C(v)})}if(i==="horizontal"){var N=Fo(0,w.height),D=N(v);return mi(mi({},w),{},{y:w.y+w.height-D,height:D})}var A=Fo(0,w.width),P=A(v);return mi(mi({},w),{},{width:P})});return v>0&&(r.current=b),Vt.createElement(Bt,null,Vt.createElement(A6,{props:t,data:b,showLabels:!m}))})}function nse(e){var{data:t,isAnimationActive:r}=e,n=(0,Aa.useRef)(null);return r&&t&&t.length&&(n.current==null||n.current!==t)?Vt.createElement(rse,{previousRectanglesRef:n,props:e}):Vt.createElement(A6,{props:e,data:t,showLabels:!0})}var N6=0,ise=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:yr(e,t)}},SM=class extends Aa.PureComponent{constructor(){super(...arguments),Ik(this,"id",Io("recharts-bar-"))}render(){var{hide:t,data:r,dataKey:n,className:i,xAxisId:o,yAxisId:a,needClip:s,background:l,id:c,layout:d}=this.props;if(t)return null;var u=Oe("recharts-bar",i),p=Je(c)?this.id:c;return Vt.createElement(Bt,{className:u},s&&Vt.createElement("defs",null,Vt.createElement(tf,{clipPathId:p,xAxisId:o,yAxisId:a})),Vt.createElement(Bt,{className:"recharts-bar-rectangles",clipPath:s?"url(#clipPath-".concat(p,")"):null},Vt.createElement(tse,{data:r,dataKey:n,background:l,allOtherBarProps:this.props}),Vt.createElement(nse,this.props)),Vt.createElement(Ok,{direction:d==="horizontal"?"y":"x"},this.props.children))}},M6={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!no.isSsr,legendType:"rect",minPointSize:N6,xAxisId:0,yAxisId:0};function ose(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:i,minPointSize:o,activeBar:a,animationBegin:s,animationDuration:l,animationEasing:c,isAnimationActive:d}=en(e,M6),{needClip:u}=uu(t,r),p=$s(),m=yt(),g=(0,Aa.useMemo)(()=>({barSize:e.barSize,data:void 0,dataKey:e.dataKey,maxBarSize:e.maxBarSize,minPointSize:o,stackId:pm(e.stackId)}),[e.barSize,e.dataKey,e.maxBarSize,o,e.stackId]),f=Xp(e.children,iM),y=he(b=>I6(b,t,r,m,g,f));if(p!=="vertical"&&p!=="horizontal")return null;var h,v=y==null?void 0:y[0];return v==null||v.height==null||v.width==null?h=0:h=p==="vertical"?v.height/2:v.width/2,Vt.createElement(Nk,{xAxisId:t,yAxisId:r,data:y,dataPointFormatter:ise,errorBarOffset:h},Vt.createElement(SM,Av({},e,{layout:p,needClip:u,data:y,xAxisId:t,yAxisId:r,hide:n,legendType:i,minPointSize:o,activeBar:a,animationBegin:s,animationDuration:l,animationEasing:c,isAnimationActive:d})))}function O6(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:i,bandSize:o,xAxis:a,yAxis:s,xAxisTicks:l,yAxisTicks:c,stackedData:d,displayedData:u,offset:p,cells:m}=e,g=t==="horizontal"?s:a,f=d?g.scale.domain():null,y=t5({numericAxis:g});return u.map((h,v)=>{var b,w,k,S,x,T;d?b=ZR(d[v],f):(b=yr(h,r),Array.isArray(b)||(b=[y,b]));var E=D6(n,N6)(b[1],v);if(t==="horizontal"){var C,[N,D]=[s.scale(b[0]),s.scale(b[1])];w=BP({axis:a,ticks:l,bandSize:o,offset:i.offset,entry:h,index:v}),k=(C=D!=null?D:N)!==null&&C!==void 0?C:void 0,S=i.size;var A=N-D;if(x=hr(A)?0:A,T={x:w,y:p.top,width:S,height:p.height},Math.abs(E)>0&&Math.abs(x)<Math.abs(E)){var P=Vr(x||E)*(Math.abs(E)-Math.abs(x));k-=P,x+=P}}else{var[I,M]=[a.scale(b[0]),a.scale(b[1])];if(w=I,k=BP({axis:s,ticks:c,bandSize:o,offset:i.offset,entry:h,index:v}),S=M-I,x=i.size,T={x:p.left,y:k,width:p.width,height:x},Math.abs(E)>0&&Math.abs(S)<Math.abs(E)){var O=Vr(S||E)*(Math.abs(E)-Math.abs(S));S+=O}}return mi(mi({},h),{},{x:w,y:k,width:S,height:x,value:d?b:b[1],payload:h,background:T,tooltipPosition:{x:w+S/2,y:k+x/2}},m&&m[v]&&m[v].props)})}var ls=class extends Aa.PureComponent{render(){return Vt.createElement(Zm,{type:"bar",data:null,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:0,dataKey:this.props.dataKey,stackId:this.props.stackId,hide:this.props.hide,barSize:this.props.barSize},Vt.createElement(m6,null),Vt.createElement(Jm,{legendPayload:Zae(this.props)}),Vt.createElement(Km,{fn:ese,args:this.props}),Vt.createElement(ose,this.props))}};Ik(ls,"displayName","Bar");Ik(ls,"defaultProps",M6);function F6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Fk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?F6(Object(r),!0).forEach(function(n){ase(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F6(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ase(e,t,r){return(t=sse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sse(e){var t=lse(e,"string");return typeof t=="symbol"?t:t+""}function lse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cse=(e,t)=>t,dse=(e,t,r)=>r,use=(e,t,r,n)=>n,TM=(e,t,r,n,i)=>i,pse=(e,t,r,n,i)=>i.maxBarSize,mse=(e,t,r,n,i,o)=>o,j6=(e,t,r)=>{var n=r!=null?r:e;if(!Je(n))return di(n,t,0)},fse=Q([et,zc,cse,dse,use],(e,t,r,n,i)=>t.filter(o=>e==="horizontal"?o.xAxisId===r:o.yAxisId===n).filter(o=>o.isPanorama===i).filter(o=>o.hide===!1).filter(o=>o.type==="bar")),gse=(e,t,r,n)=>{var i=et(e);return i==="horizontal"?au(e,"yAxis",r,n):au(e,"xAxis",t,n)},hse=(e,t,r)=>{var n=et(e);return n==="horizontal"?NN(e,"xAxis",t):NN(e,"yAxis",r)};function vse(e){return e.stackId!=null&&e.dataKey!=null}var yse=(e,t,r)=>{var n={},i=e.filter(vse),o=e.filter(c=>c.stackId==null),a=i.reduce((c,d)=>(c[d.stackId]||(c[d.stackId]=[]),c[d.stackId].push(d),c),n),s=Object.entries(a).map(c=>{var[d,u]=c,p=u.map(g=>g.dataKey),m=j6(t,r,u[0].barSize);return{stackId:d,dataKeys:p,barSize:m}}),l=o.map(c=>{var d=[c.dataKey].filter(p=>p!=null),u=j6(t,r,c.barSize);return{stackId:void 0,dataKeys:d,barSize:u}});return[...s,...l]},bse=Q([fse,YW,hse],yse),wse=(e,t,r,n,i)=>{var o,a,s=et(e),l=XA(e),{maxBarSize:c}=i,d=Je(c)?l:c,u,p;return s==="horizontal"?(u=ui(e,"xAxis",t,n),p=Uo(e,"xAxis",t,n)):(u=ui(e,"yAxis",r,n),p=Uo(e,"yAxis",r,n)),(o=(a=Qa(u,p,!0))!==null&&a!==void 0?a:d)!==null&&o!==void 0?o:0},L6=(e,t,r,n)=>{var i=et(e),o,a;return i==="horizontal"?(o=ui(e,"xAxis",t,n),a=Uo(e,"xAxis",t,n)):(o=ui(e,"yAxis",r,n),a=Uo(e,"yAxis",r,n)),Qa(o,a)};function xse(e,t,r,n,i){var o=n.length;if(!(o<1)){var a=di(e,r,0,!0),s,l=[];if(br(n[0].barSize)){var c=!1,d=r/o,u=n.reduce((h,v)=>h+(v.barSize||0),0);u+=(o-1)*a,u>=r&&(u-=(o-1)*a,a=0),u>=r&&d>0&&(c=!0,d*=.9,u=o*d);var p=(r-u)/2>>0,m={offset:p-a,size:0};s=n.reduce((h,v)=>{var b,w={stackId:v.stackId,dataKeys:v.dataKeys,position:{offset:m.offset+m.size+a,size:c?d:(b=v.barSize)!==null&&b!==void 0?b:0}},k=[...h,w];return m=k[k.length-1].position,k},l)}else{var g=di(t,r,0,!0);r-2*g-(o-1)*a<=0&&(a=0);var f=(r-2*g-(o-1)*a)/o;f>1&&(f>>=0);var y=br(i)?Math.min(f,i):f;s=n.reduce((h,v,b)=>[...h,{stackId:v.stackId,dataKeys:v.dataKeys,position:{offset:g+(f+a)*b+(f-y)/2,size:y}}],l)}return s}}var kse=(e,t,r,n,i,o,a)=>{var s=Je(a)?t:a,l=xse(r,n,i!==o?i:o,e,s);return i!==o&&l!=null&&(l=l.map(c=>Fk(Fk({},c),{},{position:Fk(Fk({},c.position),{},{offset:c.position.offset-i/2})}))),l},Sse=Q([bse,XA,GW,U0,wse,L6,pse],kse),Tse=(e,t,r,n)=>ui(e,"xAxis",t,n),Cse=(e,t,r,n)=>ui(e,"yAxis",r,n),Ese=(e,t,r,n)=>Uo(e,"xAxis",t,n),Dse=(e,t,r,n)=>Uo(e,"yAxis",r,n),Pse=Q([Sse,TM],(e,t)=>{if(e!=null){var r=e.find(n=>n.stackId===t.stackId&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),Ase=(e,t)=>{if(!(!e||(t==null?void 0:t.dataKey)==null)){var{stackId:r}=t;if(r!=null){var n=e[r];if(n){var{stackedData:i}=n;if(i){var o=i.find(a=>a.key===t.dataKey);return o}}}}},Nse=Q([zc,TM],(e,t)=>{if(e.some(r=>r.type==="bar"&&t.dataKey===r.dataKey&&t.stackId===r.stackId&&t.stackId===r.stackId))return t}),Mse=Q([gse,TM],Ase),I6=Q([cr,Tse,Cse,Ese,Dse,Pse,et,_c,L6,Mse,Nse,mse],(e,t,r,n,i,o,a,s,l,c,d,u)=>{var{chartData:p,dataStartIndex:m,dataEndIndex:g}=s;if(!(d==null||o==null||a!=="horizontal"&&a!=="vertical"||t==null||r==null||n==null||i==null||l==null)){var{data:f}=d,y;if(f!=null&&f.length>0?y=f:y=p==null?void 0:p.slice(m,g+1),y!=null)return O6({layout:a,barSettings:d,pos:o,bandSize:l,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:i,stackedData:c,displayedData:y,offset:e,cells:u})}});var _6=$(W());var z6=e=>{var{chartData:t}=e,r=ut(),n=yt();return(0,_6.useEffect)(()=>n?()=>{}:(r(ZN(t)),()=>{r(ZN(void 0))}),[t,r,n]),null};var $6={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},R6=vr({name:"brush",initialState:$6,reducers:{setBrushSettings(e,t){return t.payload==null?$6:t.payload}}}),{setBrushSettings:YWe}=R6.actions,W6=R6.reducer;var Vo=$(W()),_k=$(W());function B6(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function jk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?B6(Object(r),!0).forEach(function(n){U6(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B6(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function U6(e,t,r){return(t=Ose(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ose(e){var t=Ise(e,"string");return typeof t=="symbol"?t:t+""}function Ise(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fse=(e,t)=>{var{x:r,y:n}=e,{x:i,y:o}=t;return{x:Math.min(r,i),y:Math.min(n,o),width:Math.abs(i-r),height:Math.abs(o-n)}},V6=e=>{var{x1:t,y1:r,x2:n,y2:i}=e;return Fse({x:t,y:r},{x:n,y:i})},Lk=class e{static create(t){return new e(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(n)switch(n){case"start":return this.scale(t);case"middle":{var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+i}case"end":{var o=this.bandwidth?this.bandwidth():0;return this.scale(t)+o}default:return this.scale(t)}if(r){var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+a}return this.scale(t)}}isInRange(t){var r=this.range(),n=r[0],i=r[r.length-1];return n<=i?t>=n&&t<=i:t>=i&&t<=n}};U6(Lk,"EPS",1e-4);var H6=e=>{var t=Object.keys(e).reduce((r,n)=>jk(jk({},r),{},{[n]:Lk.create(e[n])}),{});return jk(jk({},t),{},{apply(r){var{bandAware:n,position:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Object.fromEntries(Object.entries(r).map(o=>{var[a,s]=o;return[a,t[a].apply(s,{bandAware:n,position:i})]}))},isInRange(r){return Object.keys(r).every(n=>t[n].isInRange(r[n]))}})};function jse(e){return(e%180+180)%180}var q6=function(t){var{width:r,height:n}=t,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=jse(i),a=o*Math.PI/180,s=Math.atan(n/r),l=a>s&&a<Math.PI-s?n/Math.sin(a):r/Math.cos(a);return Math.abs(l)};var Lse={dots:[],areas:[],lines:[]},G6=vr({name:"referenceElements",initialState:Lse,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=_o(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=_o(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=_o(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:QWe,removeDot:ZWe,addArea:eBe,removeArea:tBe,addLine:Y6,removeLine:K6}=G6.actions,J6=G6.reducer;var Nv=$(W()),rf=$(W());var X6=(0,rf.createContext)(void 0),Q6=e=>{var{children:t}=e,[r]=(0,rf.useState)("".concat(Io("recharts"),"-clip")),n=ka();if(n==null)return null;var{left:i,top:o,height:a,width:s}=n;return Nv.createElement(X6.Provider,{value:r},Nv.createElement("defs",null,Nv.createElement("clipPath",{id:r},Nv.createElement("rect",{x:i,y:o,height:a,width:s}))),t)},Z6=()=>(0,rf.useContext)(X6);function eU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function tU(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eU(Object(r),!0).forEach(function(n){EM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eU(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function EM(e,t,r){return(t=_se(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _se(e){var t=zse(e,"string");return typeof t=="symbol"?t:t+""}function zse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CM(){return CM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},CM.apply(null,arguments)}var $se=(e,t)=>{var r;return Vo.isValidElement(e)?r=Vo.cloneElement(e,t):typeof e=="function"?r=e(t):r=Vo.createElement("line",CM({},t,{className:"recharts-reference-line-line"})),r},Rse=(e,t,r,n,i,o,a,s,l)=>{var{x:c,y:d,width:u,height:p}=i;if(r){var{y:m}=l,g=e.y.apply(m,{position:o});if(hr(g)||l.ifOverflow==="discard"&&!e.y.isInRange(g))return null;var f=[{x:c+u,y:g},{x:c,y:g}];return s==="left"?f.reverse():f}if(t){var{x:y}=l,h=e.x.apply(y,{position:o});if(hr(h)||l.ifOverflow==="discard"&&!e.x.isInRange(h))return null;var v=[{x:h,y:d+p},{x:h,y:d}];return a==="top"?v.reverse():v}if(n){var{segment:b}=l,w=b.map(k=>e.apply(k,{position:o}));return l.ifOverflow==="discard"&&w.some(k=>!e.isInRange(k))?null:w}return null};function Wse(e){var t=ut();return(0,_k.useEffect)(()=>(t(Y6(e)),()=>{t(K6(e))})),null}function Bse(e){var{x:t,y:r,segment:n,xAxisId:i,yAxisId:o,shape:a,className:s,ifOverflow:l}=e,c=yt(),d=Z6(),u=he(N=>Bo(N,i)),p=he(N=>rs(N,o)),m=he(N=>ns(N,"xAxis",i,c)),g=he(N=>ns(N,"yAxis",o,c)),f=Ac(),y=Mn(t),h=Mn(r);if(!d||!f||u==null||p==null||m==null||g==null)return null;var v=H6({x:m,y:g}),b=n&&n.length===2,w=Rse(v,y,h,b,f,e.position,u.orientation,p.orientation,e);if(!w)return null;var[{x:k,y:S},{x,y:T}]=w,E=l==="hidden"?"url(#".concat(d,")"):void 0,C=tU(tU({clipPath:E},Ce(e,!0)),{},{x1:k,y1:S,x2:x,y2:T});return Vo.createElement(Bt,{className:Oe("recharts-reference-line",s)},$se(a,C),Yn.renderCallByParent(e,V6({x1:k,y1:S,x2:x,y2:T})))}function Use(e){return Vo.createElement(Vo.Fragment,null,Vo.createElement(Wse,{yAxisId:e.yAxisId,xAxisId:e.xAxisId,ifOverflow:e.ifOverflow,x:e.x,y:e.y}),Vo.createElement(Bse,e))}var Hr=class extends _k.Component{render(){return Vo.createElement(Use,this.props)}};EM(Hr,"displayName","ReferenceLine");EM(Hr,"defaultProps",{ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});var Ho=$(W()),cU=$(W()),DM=$(Yp());function zk(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function $k(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],i=0;i<e.length;i+=t)if(r===void 0||r(e[i])===!0)n.push(e[i]);else return;return n}function rU(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return q6(n,r)}function nU(e,t,r){var n=r==="width",{x:i,y:o,width:a,height:s}=e;return t===1?{start:n?i:o,end:n?i+a:o+s}:{start:n?i+a:o+s,end:n?i:o}}function nf(e,t,r,n,i){if(e*t<e*n||e*t>e*i)return!1;var o=r();return e*(t-e*o/2-n)>=0&&e*(t+e*o/2-i)<=0}function iU(e,t){return $k(e,t+1)}function oU(e,t,r,n,i){for(var o=(n||[]).slice(),{start:a,end:s}=t,l=0,c=1,d=a,u=function(){var g=n==null?void 0:n[l];if(g===void 0)return{v:$k(n,c)};var f=l,y,h=()=>(y===void 0&&(y=r(g,f)),y),v=g.coordinate,b=l===0||nf(e,v,h,d,s);b||(l=0,d=a,c+=1),b&&(d=v+e*(h()/2+i),l+=c)},p;c<=o.length;)if(p=u(),p)return p.v;return[]}function aU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function fi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aU(Object(r),!0).forEach(function(n){Vse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aU(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Vse(e,t,r){return(t=Hse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hse(e){var t=qse(e,"string");return typeof t=="symbol"?t:t+""}function qse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gse(e,t,r,n,i){for(var o=(n||[]).slice(),a=o.length,{start:s}=t,{end:l}=t,c=function(p){var m=o[p],g,f=()=>(g===void 0&&(g=r(m,p)),g);if(p===a-1){var y=e*(m.coordinate+e*f()/2-l);o[p]=m=fi(fi({},m),{},{tickCoord:y>0?m.coordinate-y*e:m.coordinate})}else o[p]=m=fi(fi({},m),{},{tickCoord:m.coordinate});var h=nf(e,m.tickCoord,f,s,l);h&&(l=m.tickCoord-e*(f()/2+i),o[p]=fi(fi({},m),{},{isShow:!0}))},d=a-1;d>=0;d--)c(d);return o}function Yse(e,t,r,n,i,o){var a=(n||[]).slice(),s=a.length,{start:l,end:c}=t;if(o){var d=n[s-1],u=r(d,s-1),p=e*(d.coordinate+e*u/2-c);a[s-1]=d=fi(fi({},d),{},{tickCoord:p>0?d.coordinate-p*e:d.coordinate});var m=nf(e,d.tickCoord,()=>u,l,c);m&&(c=d.tickCoord-e*(u/2+i),a[s-1]=fi(fi({},d),{},{isShow:!0}))}for(var g=o?s-1:s,f=function(v){var b=a[v],w,k=()=>(w===void 0&&(w=r(b,v)),w);if(v===0){var S=e*(b.coordinate-e*k()/2-l);a[v]=b=fi(fi({},b),{},{tickCoord:S<0?b.coordinate-S*e:b.coordinate})}else a[v]=b=fi(fi({},b),{},{tickCoord:b.coordinate});var x=nf(e,b.tickCoord,k,l,c);x&&(l=b.tickCoord+e*(k()/2+i),a[v]=fi(fi({},b),{},{isShow:!0}))},y=0;y<g;y++)f(y);return a}function Mv(e,t,r){var{tick:n,ticks:i,viewBox:o,minTickGap:a,orientation:s,interval:l,tickFormatter:c,unit:d,angle:u}=e;if(!i||!i.length||!n)return[];if(ge(l)||no.isSsr){var p;return(p=iU(i,ge(l)?l:0))!==null&&p!==void 0?p:[]}var m=[],g=s==="top"||s==="bottom"?"width":"height",f=d&&g==="width"?du(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},y=(b,w)=>{var k=typeof c=="function"?c(b.value,w):b.value;return g==="width"?rU(du(k,{fontSize:t,letterSpacing:r}),f,u):du(k,{fontSize:t,letterSpacing:r})[g]},h=i.length>=2?Vr(i[1].coordinate-i[0].coordinate):1,v=nU(o,h,g);return l==="equidistantPreserveStart"?oU(h,v,y,i,a):(l==="preserveStart"||l==="preserveStartEnd"?m=Yse(h,v,y,i,a,l==="preserveStartEnd"):m=Gse(h,v,y,i,a),m.filter(b=>b.isShow))}var Kse=["viewBox"],Jse=["viewBox"];function of(){return of=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},of.apply(null,arguments)}function sU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function vn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sU(Object(r),!0).forEach(function(n){PM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sU(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lU(e,t){if(e==null)return{};var r,n,i=Xse(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Xse(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function PM(e,t,r){return(t=Qse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qse(e){var t=Zse(e,"string");return typeof t=="symbol"?t:t+""}function Zse(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cs=class e extends cU.Component{constructor(t){super(t),this.tickRefs=Ho.createRef(),this.tickRefs.current=[],this.state={fontSize:"",letterSpacing:""}}shouldComponentUpdate(t,r){var{viewBox:n}=t,i=lU(t,Kse),o=this.props,{viewBox:a}=o,s=lU(o,Jse);return!zk(n,a)||!zk(i,s)||!zk(r,this.state)}getTickLineCoord(t){var{x:r,y:n,width:i,height:o,orientation:a,tickSize:s,mirror:l,tickMargin:c}=this.props,d,u,p,m,g,f,y=l?-1:1,h=t.tickSize||s,v=ge(t.tickCoord)?t.tickCoord:t.coordinate;switch(a){case"top":d=u=t.coordinate,m=n+ +!l*o,p=m-y*h,f=p-y*c,g=v;break;case"left":p=m=t.coordinate,u=r+ +!l*i,d=u-y*h,g=d-y*c,f=v;break;case"right":p=m=t.coordinate,u=r+ +l*i,d=u+y*h,g=d+y*c,f=v;break;default:d=u=t.coordinate,m=n+ +l*o,p=m+y*h,f=p+y*c,g=v;break}return{line:{x1:d,y1:p,x2:u,y2:m},tick:{x:g,y:f}}}getTickTextAnchor(){var{orientation:t,mirror:r}=this.props,n;switch(t){case"left":n=r?"start":"end";break;case"right":n=r?"end":"start";break;default:n="middle";break}return n}getTickVerticalAnchor(){var{orientation:t,mirror:r}=this.props;switch(t){case"left":case"right":return"middle";case"top":return r?"start":"end";default:return r?"end":"start"}}renderAxisLine(){var{x:t,y:r,width:n,height:i,orientation:o,mirror:a,axisLine:s}=this.props,l=vn(vn(vn({},Ce(this.props,!1)),Ce(s,!1)),{},{fill:"none"});if(o==="top"||o==="bottom"){var c=+(o==="top"&&!a||o==="bottom"&&a);l=vn(vn({},l),{},{x1:t,y1:r+c*i,x2:t+n,y2:r+c*i})}else{var d=+(o==="left"&&!a||o==="right"&&a);l=vn(vn({},l),{},{x1:t+d*n,y1:r,x2:t+d*n,y2:r+i})}return Ho.createElement("line",of({},l,{className:Oe("recharts-cartesian-axis-line",(0,DM.default)(s,"className"))}))}static renderTickItem(t,r,n){var i,o=Oe(r.className,"recharts-cartesian-axis-tick-value");if(Ho.isValidElement(t))i=Ho.cloneElement(t,vn(vn({},r),{},{className:o}));else if(typeof t=="function")i=t(vn(vn({},r),{},{className:o}));else{var a="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(a=Oe(a,t.className)),i=Ho.createElement(Sv,of({},r,{className:a}),n)}return i}renderTicks(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],{tickLine:i,stroke:o,tick:a,tickFormatter:s,unit:l}=this.props,c=Mv(vn(vn({},this.props),{},{ticks:n}),t,r),d=this.getTickTextAnchor(),u=this.getTickVerticalAnchor(),p=Ce(this.props,!1),m=Ce(a,!1),g=vn(vn({},p),{},{fill:"none"},Ce(i,!1)),f=c.map((y,h)=>{var{line:v,tick:b}=this.getTickLineCoord(y),w=vn(vn(vn(vn({textAnchor:d,verticalAnchor:u},p),{},{stroke:"none",fill:o},m),b),{},{index:h,payload:y,visibleTicksCount:c.length,tickFormatter:s});return Ho.createElement(Bt,of({className:"recharts-cartesian-axis-tick",key:"tick-".concat(y.value,"-").concat(y.coordinate,"-").concat(y.tickCoord)},Nh(this.props,y,h)),i&&Ho.createElement("line",of({},g,v,{className:Oe("recharts-cartesian-axis-tick-line",(0,DM.default)(i,"className"))})),a&&e.renderTickItem(a,w,"".concat(typeof s=="function"?s(y.value,h):y.value).concat(l||"")))});return f.length>0?Ho.createElement("g",{className:"recharts-cartesian-axis-ticks"},f):null}render(){var{axisLine:t,width:r,height:n,className:i,hide:o}=this.props;if(o)return null;var{ticks:a}=this.props;return r!=null&&r<=0||n!=null&&n<=0?null:Ho.createElement(Bt,{className:Oe("recharts-cartesian-axis",i),ref:s=>{if(s){var l=s.getElementsByClassName("recharts-cartesian-axis-tick-value");this.tickRefs.current=Array.from(l);var c=l[0];if(c){var d=window.getComputedStyle(c).fontSize,u=window.getComputedStyle(c).letterSpacing;(d!==this.state.fontSize||u!==this.state.letterSpacing)&&this.setState({fontSize:window.getComputedStyle(c).fontSize,letterSpacing:window.getComputedStyle(c).letterSpacing})}}}},t&&this.renderAxisLine(),this.renderTicks(this.state.fontSize,this.state.letterSpacing,a),Yn.renderCallByParent(this.props))}};PM(cs,"displayName","CartesianAxis");PM(cs,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var yn=$(W());var ele=["x1","y1","x2","y2","key"],tle=["offset"],rle=["xAxisId","yAxisId"],nle=["xAxisId","yAxisId"];function dU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function gi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dU(Object(r),!0).forEach(function(n){ile(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dU(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ile(e,t,r){return(t=ole(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ole(e){var t=ale(e,"string");return typeof t=="symbol"?t:t+""}function ale(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pu(){return pu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pu.apply(null,arguments)}function Rk(e,t){if(e==null)return{};var r,n,i=sle(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function sle(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var lle=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:i,width:o,height:a,ry:s}=e;return yn.createElement("rect",{x:n,y:i,ry:s,width:o,height:a,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function uU(e,t){var r;if(yn.isValidElement(e))r=yn.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var{x1:n,y1:i,x2:o,y2:a,key:s}=t,l=Rk(t,ele),c=Ce(l,!1),{offset:d}=c,u=Rk(c,tle);r=yn.createElement("line",pu({},u,{x1:n,y1:i,x2:o,y2:a,fill:"none",key:s}))}return r}function cle(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:i}=e;if(!n||!i||!i.length)return null;var{xAxisId:o,yAxisId:a}=e,s=Rk(e,rle),l=i.map((c,d)=>{var u=gi(gi({},s),{},{x1:t,y1:c,x2:t+r,y2:c,key:"line-".concat(d),index:d});return uU(n,u)});return yn.createElement("g",{className:"recharts-cartesian-grid-horizontal"},l)}function dle(e){var{y:t,height:r,vertical:n=!0,verticalPoints:i}=e;if(!n||!i||!i.length)return null;var{xAxisId:o,yAxisId:a}=e,s=Rk(e,nle),l=i.map((c,d)=>{var u=gi(gi({},s),{},{x1:c,y1:t,x2:c,y2:t+r,key:"line-".concat(d),index:d});return uU(n,u)});return yn.createElement("g",{className:"recharts-cartesian-grid-vertical"},l)}function ule(e){var{horizontalFill:t,fillOpacity:r,x:n,y:i,width:o,height:a,horizontalPoints:s,horizontal:l=!0}=e;if(!l||!t||!t.length)return null;var c=s.map(u=>Math.round(u+i-i)).sort((u,p)=>u-p);i!==c[0]&&c.unshift(0);var d=c.map((u,p)=>{var m=!c[p+1],g=m?i+a-u:c[p+1]-u;if(g<=0)return null;var f=p%t.length;return yn.createElement("rect",{key:"react-".concat(p),y:u,x:n,height:g,width:o,stroke:"none",fill:t[f],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return yn.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function ple(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:i,y:o,width:a,height:s,verticalPoints:l}=e;if(!t||!r||!r.length)return null;var c=l.map(u=>Math.round(u+i-i)).sort((u,p)=>u-p);i!==c[0]&&c.unshift(0);var d=c.map((u,p)=>{var m=!c[p+1],g=m?i+a-u:c[p+1]-u;if(g<=0)return null;var f=p%r.length;return yn.createElement("rect",{key:"react-".concat(p),x:u,y:o,width:g,height:s,stroke:"none",fill:r[f],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return yn.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var mle=(e,t)=>{var{xAxis:r,width:n,height:i,offset:o}=e;return RP(Mv(gi(gi(gi({},cs.defaultProps),r),{},{ticks:WP(r,!0),viewBox:{x:0,y:0,width:n,height:i}})),o.left,o.left+o.width,t)},fle=(e,t)=>{var{yAxis:r,width:n,height:i,offset:o}=e;return RP(Mv(gi(gi(gi({},cs.defaultProps),r),{},{ticks:WP(r,!0),viewBox:{x:0,y:0,width:n,height:i}})),o.top,o.top+o.height,t)},gle={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function hi(e){var t=Vx(),r=Hx(),n=ka(),i=gi(gi({},en(e,gle)),{},{x:ge(e.x)?e.x:n.left,y:ge(e.y)?e.y:n.top,width:ge(e.width)?e.width:n.width,height:ge(e.height)?e.height:n.height}),{xAxisId:o,yAxisId:a,x:s,y:l,width:c,height:d,syncWithTicks:u,horizontalValues:p,verticalValues:m}=i,g=yt(),f=he(E=>jN(E,"xAxis",o,g)),y=he(E=>jN(E,"yAxis",a,g));if(!ge(c)||c<=0||!ge(d)||d<=0||!ge(s)||s!==+s||!ge(l)||l!==+l)return null;var h=i.verticalCoordinatesGenerator||mle,v=i.horizontalCoordinatesGenerator||fle,{horizontalPoints:b,verticalPoints:w}=i;if((!b||!b.length)&&typeof v=="function"){var k=p&&p.length,S=v({yAxis:y?gi(gi({},y),{},{ticks:k?p:y.ticks}):void 0,width:t,height:r,offset:n},k?!0:u);cu(Array.isArray(S),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof S,"]")),Array.isArray(S)&&(b=S)}if((!w||!w.length)&&typeof h=="function"){var x=m&&m.length,T=h({xAxis:f?gi(gi({},f),{},{ticks:x?m:f.ticks}):void 0,width:t,height:r,offset:n},x?!0:u);cu(Array.isArray(T),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof T,"]")),Array.isArray(T)&&(w=T)}return yn.createElement("g",{className:"recharts-cartesian-grid"},yn.createElement(lle,{fill:i.fill,fillOpacity:i.fillOpacity,x:i.x,y:i.y,width:i.width,height:i.height,ry:i.ry}),yn.createElement(ule,pu({},i,{horizontalPoints:b})),yn.createElement(ple,pu({},i,{verticalPoints:w})),yn.createElement(cle,pu({},i,{offset:n,horizontalPoints:b,xAxis:f,yAxis:y})),yn.createElement(dle,pu({},i,{offset:n,verticalPoints:w,xAxis:f,yAxis:y})))}hi.displayName="CartesianGrid";var bt=$(W()),_i=$(W());var pU=(e,t,r,n)=>ui(e,"xAxis",t,n),mU=(e,t,r,n)=>Uo(e,"xAxis",t,n),fU=(e,t,r,n)=>ui(e,"yAxis",r,n),gU=(e,t,r,n)=>Uo(e,"yAxis",r,n),hle=Q([et,pU,fU,mU,gU],(e,t,r,n,i)=>eo(e,"xAxis")?Qa(t,n,!1):Qa(r,i,!1)),vle=(e,t,r,n,i)=>i,yle=Q([zc,vle],(e,t)=>{if(e.some(r=>r.type==="line"&&t.dataKey===r.dataKey&&t.data===r.data))return t}),hU=Q([et,pU,fU,mU,gU,yle,hle,_c],(e,t,r,n,i,o,a,s)=>{var{chartData:l,dataStartIndex:c,dataEndIndex:d}=s;if(!(o==null||t==null||r==null||n==null||i==null||n.length===0||i.length===0||a==null)){var{dataKey:u,data:p}=o,m;if(p!=null&&p.length>0?m=p:m=l==null?void 0:l.slice(c,d+1),m!=null)return vU({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:i,dataKey:u,bandSize:a,displayedData:m})}});var ble=["type","layout","connectNulls","needClip"],wle=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId"];function bU(e,t){if(e==null)return{};var r,n,i=xle(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function xle(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function yU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ds(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yU(Object(r),!0).forEach(function(n){Wk(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yU(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Wk(e,t,r){return(t=kle(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kle(e){var t=Sle(e,"string");return typeof t=="symbol"?t:t+""}function Sle(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function af(){return af=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},af.apply(null,arguments)}var Tle=e=>{var{dataKey:t,name:r,stroke:n,legendType:i,hide:o}=e;return[{inactive:o,dataKey:t,type:i,color:n,value:Dl(r,t),payload:e}]};function Cle(e){var{dataKey:t,data:r,stroke:n,strokeWidth:i,fill:o,name:a,hide:s,unit:l}=e;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:i,fill:o,dataKey:t,nameKey:void 0,name:Dl(a,t),hide:s,type:e.tooltipType,color:e.stroke,unit:l}}}var wU=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function Ele(e,t){for(var r=e.length%2!==0?[...e,0]:e,n=[],i=0;i<t;++i)n=[...n,...r];return n}var Dle=(e,t,r)=>{var n=r.reduce((u,p)=>u+p);if(!n)return wU(t,e);for(var i=Math.floor(e/n),o=e%n,a=t-e,s=[],l=0,c=0;l<r.length;c+=r[l],++l)if(c+r[l]>o){s=[...r.slice(0,l),o-c];break}var d=s.length%2===0?[0,a]:[a];return[...Ele(r,i),...s,...d].map(u=>"".concat(u,"px")).join(", ")};function Ple(e,t){var r;if(bt.isValidElement(e))r=bt.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var n=Oe("recharts-line-dot",typeof e!="boolean"?e.className:"");r=bt.createElement(qm,af({},t,{className:n}))}return r}function Ale(e,t){return e==null?!1:t?!0:e.length===1}function Nle(e){var{clipPathId:t,points:r,props:n}=e,{dot:i,dataKey:o,needClip:a}=n;if(!Ale(r,i))return null;var s=Qp(i),l=Ce(n,!1),c=Ce(i,!0),d=r.map((p,m)=>{var g=ds(ds(ds({key:"dot-".concat(m),r:3},l),c),{},{index:m,cx:p.x,cy:p.y,dataKey:o,value:p.value,payload:p.payload,points:r});return Ple(i,g)}),u={clipPath:a?"url(#clipPath-".concat(s?"":"dots-").concat(t,")"):null};return bt.createElement(Bt,af({className:"recharts-line-dots",key:"dots"},u),d)}function AM(e){var{clipPathId:t,pathRef:r,points:n,strokeDasharray:i,props:o,showLabels:a}=e,{type:s,layout:l,connectNulls:c,needClip:d}=o,u=bU(o,ble),p=ds(ds({},Ce(u,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:d?"url(#clipPath-".concat(t,")"):null,points:n,type:s,layout:l,connectNulls:c,strokeDasharray:i!=null?i:o.strokeDasharray});return bt.createElement(bt.Fragment,null,(n==null?void 0:n.length)>1&&bt.createElement(Nc,af({},p,{pathRef:r})),bt.createElement(Nle,{points:n,clipPathId:t,props:o}),a&&Da.renderCallByParent(o,n))}function Mle(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch(t){return 0}}function Ole(e){var{clipPathId:t,props:r,pathRef:n,previousPointsRef:i,longestAnimatedLengthRef:o}=e,{points:a,strokeDasharray:s,isAnimationActive:l,animationBegin:c,animationDuration:d,animationEasing:u,animateNewValues:p,width:m,height:g,onAnimationEnd:f,onAnimationStart:y}=r,h=i.current,v=Xm(r,"recharts-line-"),[b,w]=(0,_i.useState)(!1),k=(0,_i.useCallback)(()=>{typeof f=="function"&&f(),w(!1)},[f]),S=(0,_i.useCallback)(()=>{typeof y=="function"&&y(),w(!0)},[y]),x=Mle(n.current),T=o.current;return bt.createElement(io,{begin:c,duration:d,isActive:l,easing:u,from:{t:0},to:{t:1},onAnimationEnd:k,onAnimationStart:S,key:v},E=>{var{t:C}=E,N=Fo(T,x+T),D=Math.min(N(C),x),A;if(s){var P="".concat(s).split(/[,\s]+/gim).map(O=>parseFloat(O));A=Dle(D,x,P)}else A=wU(x,D);if(h){var I=h.length/a.length,M=C===1?a:a.map((O,F)=>{var L=Math.floor(F*I);if(h[L]){var B=h[L],j=Fo(B.x,O.x),_=Fo(B.y,O.y);return ds(ds({},O),{},{x:j(C),y:_(C)})}if(p){var H=Fo(m*2,O.x),q=Fo(g/2,O.y);return ds(ds({},O),{},{x:H(C),y:q(C)})}return ds(ds({},O),{},{x:O.x,y:O.y})});return i.current=M,bt.createElement(AM,{props:r,points:M,clipPathId:t,pathRef:n,showLabels:!b,strokeDasharray:A})}return C>0&&x>0&&(i.current=a,o.current=D),bt.createElement(AM,{props:r,points:a,clipPathId:t,pathRef:n,showLabels:!b,strokeDasharray:A})})}function Ile(e){var{clipPathId:t,props:r}=e,{points:n,isAnimationActive:i}=r,o=(0,_i.useRef)(null),a=(0,_i.useRef)(0),s=(0,_i.useRef)(null),l=o.current;return i&&n&&n.length&&l!==n?bt.createElement(Ole,{props:r,clipPathId:t,previousPointsRef:o,longestAnimatedLengthRef:a,pathRef:s}):bt.createElement(AM,{props:r,points:n,clipPathId:t,pathRef:s,showLabels:!0})}var Fle=(e,t)=>({x:e.x,y:e.y,value:e.value,errorVal:yr(e.payload,t)}),NM=class extends _i.Component{constructor(){super(...arguments),Wk(this,"id",Io("recharts-line-"))}render(){var t,{hide:r,dot:n,points:i,className:o,xAxisId:a,yAxisId:s,top:l,left:c,width:d,height:u,id:p,needClip:m,layout:g}=this.props;if(r)return null;var f=Oe("recharts-line",o),y=Je(p)?this.id:p,{r:h=3,strokeWidth:v=2}=(t=Ce(n,!1))!==null&&t!==void 0?t:{r:3,strokeWidth:2},b=Qp(n),w=h*2+v;return bt.createElement(bt.Fragment,null,bt.createElement(Bt,{className:f},m&&bt.createElement("defs",null,bt.createElement(tf,{clipPathId:y,xAxisId:a,yAxisId:s}),!b&&bt.createElement("clipPath",{id:"clipPath-dots-".concat(y)},bt.createElement("rect",{x:c-w/2,y:l-w/2,width:d+w,height:u+w}))),bt.createElement(Ile,{props:this.props,clipPathId:y}),bt.createElement(Ok,{direction:g==="horizontal"?"y":"x"},bt.createElement(Nk,{xAxisId:a,yAxisId:s,data:i,dataPointFormatter:Fle,errorBarOffset:0},this.props.children))),bt.createElement(Ev,{activeDot:this.props.activeDot,points:i,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}},xU={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!no.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function jle(e){var t=en(e,xU),{activeDot:r,animateNewValues:n,animationBegin:i,animationDuration:o,animationEasing:a,connectNulls:s,dot:l,hide:c,isAnimationActive:d,label:u,legendType:p,xAxisId:m,yAxisId:g}=t,f=bU(t,wle),{needClip:y}=uu(m,g),{height:h,width:v,left:b,top:w}=ka(),k=$s(),S=yt(),x=(0,_i.useMemo)(()=>({dataKey:e.dataKey,data:e.data}),[e.dataKey,e.data]),T=he(E=>hU(E,m,g,S,x));return k!=="horizontal"&&k!=="vertical"?null:bt.createElement(NM,af({},f,{connectNulls:s,dot:l,activeDot:r,animateNewValues:n,animationBegin:i,animationDuration:o,animationEasing:a,isAnimationActive:d,hide:c,label:u,legendType:p,xAxisId:m,yAxisId:g,points:T,layout:k,height:h,width:v,left:b,top:w,needClip:y}))}function vU(e){var{layout:t,xAxis:r,yAxis:n,xAxisTicks:i,yAxisTicks:o,dataKey:a,bandSize:s,displayedData:l}=e;return l.map((c,d)=>{var u=yr(c,a);return t==="horizontal"?{x:mm({axis:r,ticks:i,bandSize:s,entry:c,index:d}),y:Je(u)?null:n.scale(u),value:u,payload:c}:{x:Je(u)?null:r.scale(u),y:mm({axis:n,ticks:o,bandSize:s,entry:c,index:d}),value:u,payload:c}})}var qs=class extends _i.PureComponent{render(){return bt.createElement(Zm,{type:"line",data:this.props.data,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:0,dataKey:this.props.dataKey,stackId:void 0,hide:this.props.hide,barSize:void 0},bt.createElement(Jm,{legendPayload:Tle(this.props)}),bt.createElement(Km,{fn:Cle,args:this.props}),bt.createElement(jle,this.props))}};Wk(qs,"displayName","Line");Wk(qs,"defaultProps",xU);var Ye=$(W()),qo=$(W());var kU=(e,t,r,n)=>ui(e,"xAxis",t,n),SU=(e,t,r,n)=>Uo(e,"xAxis",t,n),TU=(e,t,r,n)=>ui(e,"yAxis",r,n),CU=(e,t,r,n)=>Uo(e,"yAxis",r,n),Lle=Q([et,kU,TU,SU,CU],(e,t,r,n,i)=>eo(e,"xAxis")?Qa(t,n,!1):Qa(r,i,!1)),_le=(e,t,r,n,i)=>{var o,a=et(e),s=eo(a,"xAxis"),l;if(s?l=au(e,"yAxis",r,n):l=au(e,"xAxis",t,n),l!=null){var{dataKey:c,stackId:d}=i;if(d!=null){var u=(o=l[d])===null||o===void 0?void 0:o.stackedData;return u==null?void 0:u.find(p=>p.key===c)}}},zle=(e,t,r,n,i)=>i,$le=Q([zc,zle],(e,t)=>{if(e.some(r=>r.type==="area"&&t.dataKey===r.dataKey&&pm(t.stackId)===r.stackId&&t.data===r.data))return t}),EU=Q([et,kU,TU,SU,CU,_le,_c,Lle,$le],(e,t,r,n,i,o,a,s,l)=>{var{chartData:c,dataStartIndex:d,dataEndIndex:u}=a;if(!(l==null||e!=="horizontal"&&e!=="vertical"||t==null||r==null||n==null||i==null||n.length===0||i.length===0||s==null)){var{data:p}=l,m;if(p&&p.length>0?m=p:m=c==null?void 0:c.slice(d,u+1),m!=null){var g=void 0;return DU({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:i,dataStartIndex:d,areaSettings:l,stackedData:o,displayedData:m,chartBaseValue:g,bandSize:s})}}});var Rle=["layout","type","stroke","connectNulls","isRange"],Wle=["activeDot","animationBegin","animationDuration","animationEasing","connectNulls","dot","fill","fillOpacity","hide","isAnimationActive","legendType","stroke","xAxisId","yAxisId"];function AU(e,t){if(e==null)return{};var r,n,i=Ble(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Ble(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function PU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function mu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PU(Object(r),!0).forEach(function(n){Uk(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PU(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Uk(e,t,r){return(t=Ule(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ule(e){var t=Vle(e,"string");return typeof t=="symbol"?t:t+""}function Vle(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wc(){return Wc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Wc.apply(null,arguments)}function Bk(e,t){return e&&e!=="none"?e:t}var Hle=e=>{var{dataKey:t,name:r,stroke:n,fill:i,legendType:o,hide:a}=e;return[{inactive:a,dataKey:t,type:o,color:Bk(n,i),value:Dl(r,t),payload:e}]};function qle(e){var{dataKey:t,data:r,stroke:n,strokeWidth:i,fill:o,name:a,hide:s,unit:l}=e;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:i,fill:o,dataKey:t,nameKey:void 0,name:Dl(a,t),hide:s,type:e.tooltipType,color:Bk(n,o),unit:l}}}var Gle=(e,t)=>{var r;if(Ye.isValidElement(e))r=Ye.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var n=Oe("recharts-area-dot",typeof e!="boolean"?e.className:"");r=Ye.createElement(qm,Wc({},t,{className:n}))}return r};function Yle(e,t){return e==null?!1:t?!0:e.length===1}function Kle(e){var{clipPathId:t,points:r,props:n}=e,{needClip:i,dot:o,dataKey:a}=n;if(!Yle(r,o))return null;var s=Qp(o),l=Ce(n,!1),c=Ce(o,!0),d=r.map((p,m)=>{var g=mu(mu(mu({key:"dot-".concat(m),r:3},l),c),{},{index:m,cx:p.x,cy:p.y,dataKey:a,value:p.value,payload:p.payload,points:r});return Gle(o,g)}),u={clipPath:i?"url(#clipPath-".concat(s?"":"dots-").concat(t,")"):void 0};return Ye.createElement(Bt,Wc({className:"recharts-area-dots"},u),d)}function MM(e){var{points:t,baseLine:r,needClip:n,clipPathId:i,props:o,showLabels:a}=e,{layout:s,type:l,stroke:c,connectNulls:d,isRange:u}=o,p=AU(o,Rle);return Ye.createElement(Ye.Fragment,null,(t==null?void 0:t.length)>1&&Ye.createElement(Bt,{clipPath:n?"url(#clipPath-".concat(i,")"):void 0},Ye.createElement(Nc,Wc({},Ce(p,!0),{points:t,connectNulls:d,type:l,baseLine:r,layout:s,stroke:"none",className:"recharts-area-area"})),c!=="none"&&Ye.createElement(Nc,Wc({},Ce(o,!1),{className:"recharts-area-curve",layout:s,type:l,connectNulls:d,fill:"none",points:t})),c!=="none"&&u&&Ye.createElement(Nc,Wc({},Ce(o,!1),{className:"recharts-area-curve",layout:s,type:l,connectNulls:d,fill:"none",points:r}))),Ye.createElement(Kle,{points:t,props:o,clipPathId:i}),a&&Da.renderCallByParent(o,t))}function Jle(e){var{alpha:t,baseLine:r,points:n,strokeWidth:i}=e,o=n[0].y,a=n[n.length-1].y;if(!br(o)||!br(a))return null;var s=t*Math.abs(o-a),l=Math.max(...n.map(c=>c.x||0));return ge(r)?l=Math.max(r,l):r&&Array.isArray(r)&&r.length&&(l=Math.max(...r.map(c=>c.x||0),l)),ge(l)?Ye.createElement("rect",{x:0,y:o<a?o:o-s,width:l+(i?parseInt("".concat(i),10):1),height:Math.floor(s)}):null}function Xle(e){var{alpha:t,baseLine:r,points:n,strokeWidth:i}=e,o=n[0].x,a=n[n.length-1].x;if(!br(o)||!br(a))return null;var s=t*Math.abs(o-a),l=Math.max(...n.map(c=>c.y||0));return ge(r)?l=Math.max(r,l):r&&Array.isArray(r)&&r.length&&(l=Math.max(...r.map(c=>c.y||0),l)),ge(l)?Ye.createElement("rect",{x:o<a?o:o-s,y:0,width:s,height:Math.floor(l+(i?parseInt("".concat(i),10):1))}):null}function Qle(e){var{alpha:t,layout:r,points:n,baseLine:i,strokeWidth:o}=e;return r==="vertical"?Ye.createElement(Jle,{alpha:t,points:n,baseLine:i,strokeWidth:o}):Ye.createElement(Xle,{alpha:t,points:n,baseLine:i,strokeWidth:o})}function Zle(e){var{needClip:t,clipPathId:r,props:n,previousPointsRef:i,previousBaselineRef:o}=e,{points:a,baseLine:s,isAnimationActive:l,animationBegin:c,animationDuration:d,animationEasing:u,onAnimationStart:p,onAnimationEnd:m}=n,g=Xm(n,"recharts-area-"),[f,y]=(0,qo.useState)(!0),h=(0,qo.useCallback)(()=>{typeof m=="function"&&m(),y(!1)},[m]),v=(0,qo.useCallback)(()=>{typeof p=="function"&&p(),y(!0)},[p]),b=i.current,w=o.current;return Ye.createElement(io,{begin:c,duration:d,isActive:l,easing:u,from:{t:0},to:{t:1},onAnimationEnd:h,onAnimationStart:v,key:g},k=>{var{t:S}=k;if(b){var x=b.length/a.length,T=S===1?a:a.map((C,N)=>{var D=Math.floor(N*x);if(b[D]){var A=b[D];return mu(mu({},C),{},{x:Od(A.x,C.x,S),y:Od(A.y,C.y,S)})}return C}),E;return ge(s)?E=Od(w,s,S):Je(s)||hr(s)?E=Od(w,0,S):E=s.map((C,N)=>{var D=Math.floor(N*x);if(Array.isArray(w)&&w[D]){var A=w[D];return mu(mu({},C),{},{x:Od(A.x,C.x,S),y:Od(A.y,C.y,S)})}return C}),S>0&&(i.current=T,o.current=E),Ye.createElement(MM,{points:T,baseLine:E,needClip:t,clipPathId:r,props:n,showLabels:!f})}return S>0&&(i.current=a,o.current=s),Ye.createElement(Bt,null,Ye.createElement("defs",null,Ye.createElement("clipPath",{id:"animationClipPath-".concat(r)},Ye.createElement(Qle,{alpha:S,points:a,baseLine:s,layout:n.layout,strokeWidth:n.strokeWidth}))),Ye.createElement(Bt,{clipPath:"url(#animationClipPath-".concat(r,")")},Ye.createElement(MM,{points:a,baseLine:s,needClip:t,clipPathId:r,props:n,showLabels:!0})))})}function ece(e){var{needClip:t,clipPathId:r,props:n}=e,{points:i,baseLine:o,isAnimationActive:a}=n,s=(0,qo.useRef)(null),l=(0,qo.useRef)(),c=s.current,d=l.current;return a&&i&&i.length&&(c!==i||d!==o)?Ye.createElement(Zle,{needClip:t,clipPathId:r,props:n,previousPointsRef:s,previousBaselineRef:l}):Ye.createElement(MM,{points:i,baseLine:o,needClip:t,clipPathId:r,props:n,showLabels:!0})}var OM=class extends qo.PureComponent{constructor(){super(...arguments),Uk(this,"id",Io("recharts-area-"))}render(){var t,{hide:r,dot:n,points:i,className:o,top:a,left:s,needClip:l,xAxisId:c,yAxisId:d,width:u,height:p,id:m,baseLine:g}=this.props;if(r)return null;var f=Oe("recharts-area",o),y=Je(m)?this.id:m,{r:h=3,strokeWidth:v=2}=(t=Ce(n,!1))!==null&&t!==void 0?t:{r:3,strokeWidth:2},b=Qp(n),w=h*2+v;return Ye.createElement(Ye.Fragment,null,Ye.createElement(Bt,{className:f},l&&Ye.createElement("defs",null,Ye.createElement(tf,{clipPathId:y,xAxisId:c,yAxisId:d}),!b&&Ye.createElement("clipPath",{id:"clipPath-dots-".concat(y)},Ye.createElement("rect",{x:s-w/2,y:a-w/2,width:u+w,height:p+w}))),Ye.createElement(ece,{needClip:l,clipPathId:y,props:this.props})),Ye.createElement(Ev,{points:i,mainColor:Bk(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}),this.props.isRange&&Array.isArray(g)&&Ye.createElement(Ev,{points:g,mainColor:Bk(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}))}},NU={activeDot:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!1,fill:"#3182bd",fillOpacity:.6,hide:!1,isAnimationActive:!no.isSsr,legendType:"line",stroke:"#3182bd",xAxisId:0,yAxisId:0};function tce(e){var t,r=en(e,NU),{activeDot:n,animationBegin:i,animationDuration:o,animationEasing:a,connectNulls:s,dot:l,fill:c,fillOpacity:d,hide:u,isAnimationActive:p,legendType:m,stroke:g,xAxisId:f,yAxisId:y}=r,h=AU(r,Wle),v=$s(),b=yk(),{needClip:w}=uu(f,y),k=yt(),S=(0,qo.useMemo)(()=>({baseValue:e.baseValue,stackId:e.stackId,connectNulls:s,data:e.data,dataKey:e.dataKey}),[e.baseValue,e.stackId,s,e.data,e.dataKey]),{points:x,isRange:T,baseLine:E}=(t=he(P=>EU(P,f,y,k,S)))!==null&&t!==void 0?t:{},{height:C,width:N,left:D,top:A}=ka();return v!=="horizontal"&&v!=="vertical"||b!=="AreaChart"&&b!=="ComposedChart"?null:Ye.createElement(OM,Wc({},h,{activeDot:n,animationBegin:i,animationDuration:o,animationEasing:a,baseLine:E,connectNulls:s,dot:l,fill:c,fillOpacity:d,height:C,hide:u,layout:v,isAnimationActive:p,isRange:T,legendType:m,needClip:w,points:x,stroke:g,width:N,left:D,top:A,xAxisId:f,yAxisId:y}))}var rce=(e,t,r,n,i)=>{var o=r!=null?r:t;if(ge(o))return o;var a=e==="horizontal"?i:n,s=a.scale.domain();if(a.type==="number"){var l=Math.max(s[0],s[1]),c=Math.min(s[0],s[1]);return o==="dataMin"?c:o==="dataMax"||l<0?l:Math.max(Math.min(s[0],s[1]),0)}return o==="dataMin"?s[0]:o==="dataMax"?s[1]:s[0]};function DU(e){var{areaSettings:{connectNulls:t,baseValue:r,dataKey:n},stackedData:i,layout:o,chartBaseValue:a,xAxis:s,yAxis:l,displayedData:c,dataStartIndex:d,xAxisTicks:u,yAxisTicks:p,bandSize:m}=e,g=i&&i.length,f=rce(o,a,r,s,l),y=o==="horizontal",h=!1,v=c.map((w,k)=>{var S;g?S=i[d+k]:(S=yr(w,n),Array.isArray(S)?h=!0:S=[f,S]);var x=S[1]==null||g&&!t&&yr(w,n)==null;return y?{x:mm({axis:s,ticks:u,bandSize:m,entry:w,index:k}),y:x?null:l.scale(S[1]),value:S,payload:w}:{x:x?null:s.scale(S[1]),y:mm({axis:l,ticks:p,bandSize:m,entry:w,index:k}),value:S,payload:w}}),b;return g||h?b=v.map(w=>{var k=Array.isArray(w.value)?w.value[0]:null;return y?{x:w.x,y:k!=null&&w.y!=null?l.scale(k):null}:{x:k!=null?s.scale(k):null,y:w.y}}):b=y?l.scale(f):s.scale(f),{points:v,baseLine:b,isRange:h}}var co=class extends qo.PureComponent{render(){return Ye.createElement(Zm,{type:"area",data:this.props.data,dataKey:this.props.dataKey,xAxisId:this.props.xAxisId,yAxisId:this.props.yAxisId,zAxisId:0,stackId:this.props.stackId,hide:this.props.hide,barSize:void 0},Ye.createElement(Jm,{legendPayload:Hle(this.props)}),Ye.createElement(Km,{fn:qle,args:this.props}),Ye.createElement(tce,this.props))}};Uk(co,"displayName","Area");Uk(co,"defaultProps",NU);function MU(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function OU(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?MU(Object(r),!0).forEach(function(n){nce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):MU(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nce(e,t,r){return(t=ice(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ice(e){var t=oce(e,"string");return typeof t=="symbol"?t:t+""}function oce(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ace={xAxis:{},yAxis:{},zAxis:{}},IU=vr({name:"cartesianAxis",initialState:ace,reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload;e.yAxis[r]&&(e.yAxis[r]=OU(OU({},e.yAxis[r]),{},{width:n}))}}}),{addXAxis:FU,removeXAxis:jU,addYAxis:LU,removeYAxis:_U,addZAxis:c6e,removeZAxis:d6e,updateYAxisWidth:zU}=IU.actions,$U=IU.reducer;var Ov=$(W()),sf=$(W());var sce=["children"],lce=["dangerouslySetInnerHTML","ticks"];function RU(e,t,r){return(t=cce(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cce(e){var t=dce(e,"string");return typeof t=="symbol"?t:t+""}function dce(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function IM(){return IM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},IM.apply(null,arguments)}function WU(e,t){if(e==null)return{};var r,n,i=uce(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function uce(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function pce(e){var t=ut(),r=(0,sf.useMemo)(()=>{var{children:o}=e,a=WU(e,sce);return a},[e]),n=he(o=>Bo(o,r.id)),i=r===n;return(0,sf.useEffect)(()=>(t(FU(r)),()=>{t(jU(r))}),[r,t]),i?e.children:null}var mce=e=>{var{xAxisId:t,className:r}=e,n=he(Bx),i=yt(),o="xAxis",a=he(m=>ns(m,o,t,i)),s=he(m=>nk(m,o,t,i)),l=he(m=>PN(m,t)),c=he(m=>iB(m,t));if(l==null||c==null)return null;var{dangerouslySetInnerHTML:d,ticks:u}=e,p=WU(e,lce);return Ov.createElement(cs,IM({},p,{scale:a,x:c.x,y:c.y,width:l.width,height:l.height,className:Oe("recharts-".concat(o," ").concat(o),r),viewBox:n,ticks:s}))},fce=e=>{var t,r,n,i,o;return Ov.createElement(pce,{interval:(t=e.interval)!==null&&t!==void 0?t:"preserveEnd",id:e.xAxisId,scale:e.scale,type:e.type,padding:e.padding,allowDataOverflow:e.allowDataOverflow,domain:e.domain,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,includeHidden:(r=e.includeHidden)!==null&&r!==void 0?r:!1,reversed:e.reversed,ticks:e.ticks,height:e.height,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:(n=e.angle)!==null&&n!==void 0?n:0,minTickGap:(i=e.minTickGap)!==null&&i!==void 0?i:5,tick:(o=e.tick)!==null&&o!==void 0?o:!0,tickFormatter:e.tickFormatter},Ov.createElement(mce,e))},bn=class extends sf.Component{render(){return Ov.createElement(fce,this.props)}};RU(bn,"displayName","XAxis");RU(bn,"defaultProps",{allowDataOverflow:Ii.allowDataOverflow,allowDecimals:Ii.allowDecimals,allowDuplicatedCategory:Ii.allowDuplicatedCategory,height:Ii.height,hide:!1,mirror:Ii.mirror,orientation:Ii.orientation,padding:Ii.padding,reversed:Ii.reversed,scale:Ii.scale,tickCount:Ii.tickCount,type:Ii.type,xAxisId:0});var Bc=$(W()),us=$(W());var BU=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:i=0,tickMargin:o=0}=e,a=0;if(t){t.forEach(d=>{if(d){var u=d.getBoundingClientRect();u.width>a&&(a=u.width)}});var s=r?r.getBoundingClientRect().width:0,l=i+o,c=a+l+s+(r?n:0);return Math.round(c)}return 0};var gce=["dangerouslySetInnerHTML","ticks"];function UU(e,t,r){return(t=hce(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hce(e){var t=vce(e,"string");return typeof t=="symbol"?t:t+""}function vce(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function FM(){return FM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},FM.apply(null,arguments)}function yce(e,t){if(e==null)return{};var r,n,i=bce(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function bce(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function wce(e){var t=ut();return(0,us.useEffect)(()=>(t(LU(e)),()=>{t(_U(e))}),[e,t]),null}var xce=e=>{var t,{yAxisId:r,className:n,width:i,label:o}=e,a=(0,us.useRef)(null),s=(0,us.useRef)(null),l=he(Bx),c=yt(),d=ut(),u="yAxis",p=he(b=>ns(b,u,r,c)),m=he(b=>AN(b,r)),g=he(b=>oB(b,r)),f=he(b=>nk(b,u,r,c));if((0,us.useLayoutEffect)(()=>{var b;if(!(i!=="auto"||!m||Tv(o)||(0,us.isValidElement)(o))){var w=a.current,k=w==null||(b=w.tickRefs)===null||b===void 0?void 0:b.current,{tickSize:S,tickMargin:x}=w.props,T=BU({ticks:k,label:s.current,labelGapWithTick:5,tickSize:S,tickMargin:x});Math.round(m.width)!==Math.round(T)&&d(zU({id:r,width:T}))}},[a,a==null||(t=a.current)===null||t===void 0||(t=t.tickRefs)===null||t===void 0?void 0:t.current,m==null?void 0:m.width,m,d,o,r,i]),m==null||g==null)return null;var{dangerouslySetInnerHTML:y,ticks:h}=e,v=yce(e,gce);return Bc.createElement(cs,FM({},v,{ref:a,labelRef:s,scale:p,x:g.x,y:g.y,width:m.width,height:m.height,className:Oe("recharts-".concat(u," ").concat(u),n),viewBox:l,ticks:f}))},kce=e=>{var t,r,n,i,o;return Bc.createElement(Bc.Fragment,null,Bc.createElement(wce,{interval:(t=e.interval)!==null&&t!==void 0?t:"preserveEnd",id:e.yAxisId,scale:e.scale,type:e.type,domain:e.domain,allowDataOverflow:e.allowDataOverflow,dataKey:e.dataKey,allowDuplicatedCategory:e.allowDuplicatedCategory,allowDecimals:e.allowDecimals,tickCount:e.tickCount,padding:e.padding,includeHidden:(r=e.includeHidden)!==null&&r!==void 0?r:!1,reversed:e.reversed,ticks:e.ticks,width:e.width,orientation:e.orientation,mirror:e.mirror,hide:e.hide,unit:e.unit,name:e.name,angle:(n=e.angle)!==null&&n!==void 0?n:0,minTickGap:(i=e.minTickGap)!==null&&i!==void 0?i:5,tick:(o=e.tick)!==null&&o!==void 0?o:!0,tickFormatter:e.tickFormatter}),Bc.createElement(xce,e))},Sce={allowDataOverflow:Fi.allowDataOverflow,allowDecimals:Fi.allowDecimals,allowDuplicatedCategory:Fi.allowDuplicatedCategory,hide:!1,mirror:Fi.mirror,orientation:Fi.orientation,padding:Fi.padding,reversed:Fi.reversed,scale:Fi.scale,tickCount:Fi.tickCount,type:Fi.type,width:Fi.width,yAxisId:0},wn=class extends us.Component{render(){return Bc.createElement(kce,this.props)}};UU(wn,"displayName","YAxis");UU(wn,"defaultProps",Sce);var lf=$(W()),v8=$(W());var o8=$(W()),a8=$(W());var _r=$(W(),1),Kce=$(GU(),1);var Mce=Symbol.for("react.forward_ref");var Oce=Symbol.for("react.memo");var Ice=Mce,Fce=Oce;function jce(e){e()}function Lce(){let e=null,t=null;return{clear(){e=null,t=null},notify(){jce(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){let r=[],n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0,i=t={callback:r,next:null,prev:t};return i.prev?i.prev.next=i:e=i,function(){!n||e===null||(n=!1,i.next?i.next.prev=i.prev:t=i.prev,i.prev?i.prev.next=i.next:e=i.next)}}}}var YU={notify(){},get:()=>[]};function _ce(e,t){let r,n=YU,i=0,o=!1;function a(f){d();let y=n.subscribe(f),h=!1;return()=>{h||(h=!0,y(),u())}}function s(){n.notify()}function l(){g.onStateChange&&g.onStateChange()}function c(){return o}function d(){i++,r||(r=t?t.addNestedSub(l):e.subscribe(l),n=Lce())}function u(){i--,r&&i===0&&(r(),r=void 0,n.clear(),n=YU)}function p(){o||(o=!0,d())}function m(){o&&(o=!1,u())}let g={addNestedSub:a,notifyNestedSubs:s,handleChangeWrapper:l,isSubscribed:c,trySubscribe:p,tryUnsubscribe:m,getListeners:()=>n};return g}var zce=()=>typeof window!="undefined"&&typeof window.document!="undefined"&&typeof window.document.createElement!="undefined",$ce=zce(),Rce=()=>typeof navigator!="undefined"&&navigator.product==="ReactNative",Wce=Rce(),Bce=()=>$ce||Wce?_r.useLayoutEffect:_r.useEffect,Uce=Bce();var Vce={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Hce={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},I6e={[Ice]:Vce,[Fce]:Hce};var F6e=Object.prototype;var jM=Symbol.for("react-redux-context"),LM=typeof globalThis!="undefined"?globalThis:{};function qce(){var r;if(!_r.createContext)return{};let e=(r=LM[jM])!=null?r:LM[jM]=new Map,t=e.get(_r.createContext);return t||(t=_r.createContext(null),e.set(_r.createContext,t)),t}var Gce=qce();function Yce(e){let{children:t,context:r,serverState:n,store:i}=e,o=_r.useMemo(()=>{let l=_ce(i);return{store:i,subscription:l,getServerState:n?()=>n:void 0}},[i,n]),a=_r.useMemo(()=>i.getState(),[i]);return Uce(()=>{let{subscription:l}=o;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),a!==i.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[o,a]),_r.createElement((r||Gce).Provider,{value:o},t)}var KU=Yce;var Jce=(e,t)=>t,Fv=Q([Jce,et,XW,hn,WN,lo,MB,cr],zB);var jv=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}};var _M=mn("mouseClick"),zM=El();zM.startListening({actionCreator:_M,effect:(e,t)=>{var r=e.payload,n=Fv(t.getState(),jv(r));(n==null?void 0:n.activeIndex)!=null&&t.dispatch(gB({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var Vk=mn("mouseMove"),$M=El();$M.startListening({actionCreator:Vk,effect:(e,t)=>{var r=e.payload,n=t.getState(),i=bv(n,n.tooltip.settings.shared),o=Fv(n,jv(r));i==="axis"&&((o==null?void 0:o.activeIndex)!=null?t.dispatch(sk({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate})):t.dispatch(ak()))}});function JU(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":t}var XU={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},QU=vr({name:"rootProps",initialState:XU,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:XU.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),ZU=QU.reducer,{updateOptions:e8}=QU.actions;var t8=vr({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:eUe}=t8.actions,r8=t8.reducer;var RM=mn("keyDown"),WM=mn("focus"),Hk=El();Hk.startListening({actionCreator:RM,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip,o=e.payload;if(!(o!=="ArrowRight"&&o!=="ArrowLeft"&&o!=="Enter")){var a=Number(zm(i,jl(r))),s=lo(r);if(o==="Enter"){var l=wv(r,"axis","hover",String(i.index));t.dispatch(ck({active:!i.active,activeIndex:i.index,activeDataKey:i.dataKey,activeCoordinate:l}));return}var c=aB(r),d=c==="left-to-right"?1:-1,u=o==="ArrowRight"?1:-1,p=a+u*d;if(!(s==null||p>=s.length||p<0)){var m=wv(r,"axis","hover",String(p));t.dispatch(ck({active:!0,activeIndex:p.toString(),activeDataKey:void 0,activeCoordinate:m}))}}}}});Hk.startListening({actionCreator:WM,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip;if(!i.active&&i.index==null){var o="0",a=wv(r,"axis","hover",String(o));t.dispatch(ck({activeDataKey:void 0,active:!0,activeIndex:o,activeCoordinate:a}))}}}});var Go=mn("externalEvent"),BM=El();BM.startListening({actionCreator:Go,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),n={activeCoordinate:kB(r),activeDataKey:vk(r),activeIndex:Ll(r),activeLabel:hk(r),activeTooltipIndex:Ll(r),isTooltipActive:SB(r)};e.payload.handler(n,e.payload.reactEvent)}}});var Xce=Q([Fl],e=>e.tooltipItemPayloads),n8=Q([Xce,lu,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,n)=>{var i=e.find(s=>s.settings.dataKey===n);if(i!=null){var{positions:o}=i;if(o!=null){var a=t(o,r);return a}}});var UM=mn("touchMove"),VM=El();VM.startListening({actionCreator:UM,effect:(e,t)=>{var r=e.payload,n=t.getState(),i=bv(n,n.tooltip.settings.shared);if(i==="axis"){var o=Fv(n,jv({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));(o==null?void 0:o.activeIndex)!=null&&t.dispatch(sk({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate}))}else if(i==="item"){var a,s=r.touches[0],l=document.elementFromPoint(s.clientX,s.clientY);if(!l||!l.getAttribute)return;var c=l.getAttribute(s5),d=(a=l.getAttribute(l5))!==null&&a!==void 0?a:void 0,u=n8(t.getState(),c,d);t.dispatch(ok({activeDataKey:d,activeIndex:c,activeCoordinate:u}))}}});var Qce=Cx({brush:W6,cartesianAxis:$U,chartData:ZB,graphicalItems:Y3,layout:WR,legend:g5,options:YB,polarAxis:B3,polarOptions:r8,referenceElements:J6,rootProps:ZU,tooltip:hB}),i8=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return kR({reducer:Qce,preloadedState:t,middleware:n=>n({serializableCheck:!1}).concat([zM.middleware,$M.middleware,Hk.middleware,BM.middleware,VM.middleware]),devTools:{serialize:{replacer:JU},name:"recharts-".concat(r)}})};function s8(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,i=yt(),o=(0,a8.useRef)(null);if(i)return r;o.current==null&&(o.current=i8(t,n));var a=Fh;return o8.createElement(KU,{context:a,store:o.current},r)}var l8=$(W());function c8(e){var{layout:t,width:r,height:n,margin:i}=e,o=ut(),a=yt();return(0,l8.useEffect)(()=>{a||(o(zR(t)),o($R({width:r,height:n})),o(_R(i)))},[o,a,t,r,n,i]),null}var d8=$(W());function u8(e){var t=ut();return(0,d8.useEffect)(()=>{t(e8(e))},[t,e]),null}var _v=$(W()),g8=$(W());var Lv=$(W()),HM=$(W());var Zce=["children"];function ede(e,t){if(e==null)return{};var r,n,i=tde(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function tde(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function qk(){return qk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qk.apply(null,arguments)}var rde={width:"100%",height:"100%"},nde=(0,HM.forwardRef)((e,t)=>{var r=Vx(),n=Hx(),i=Yx();if(!hm(r)||!hm(n))return null;var{children:o,otherAttributes:a,title:s,desc:l}=e,c,d;return typeof a.tabIndex=="number"?c=a.tabIndex:c=i?0:void 0,typeof a.role=="string"?d=a.role:d=i?"application":void 0,Lv.createElement(eD,qk({},a,{title:s,desc:l,role:d,tabIndex:c,width:r,height:n,style:rde,ref:t}),o)}),ide=e=>{var{children:t}=e,r=he(Wd);if(!r)return null;var{width:n,height:i,y:o,x:a}=r;return Lv.createElement(eD,{width:n,height:i,x:a,y:o},t)},qM=(0,HM.forwardRef)((e,t)=>{var{children:r}=e,n=ede(e,Zce),i=yt();return i?Lv.createElement(ide,null,r):Lv.createElement(nde,qk({ref:t},n),r)});var Yk=$(W()),rn=$(W());var Gk=$(W());function p8(){var e=ut(),[t,r]=(0,Gk.useState)(null),n=he(a5);return(0,Gk.useEffect)(()=>{if(t!=null){var i=t.getBoundingClientRect(),o=i.width/t.offsetWidth;br(o)&&o!==n&&e(RR(o))}},[t,e,n]),r}function m8(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ode(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?m8(Object(r),!0).forEach(function(n){ade(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m8(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ade(e,t,r){return(t=sde(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sde(e){var t=lde(e,"string");return typeof t=="symbol"?t:t+""}function lde(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var f8=(0,rn.forwardRef)((e,t)=>{var{children:r,className:n,height:i,onClick:o,onContextMenu:a,onDoubleClick:s,onMouseDown:l,onMouseEnter:c,onMouseLeave:d,onMouseMove:u,onMouseUp:p,onTouchEnd:m,onTouchMove:g,onTouchStart:f,style:y,width:h}=e,v=ut(),[b,w]=(0,rn.useState)(null),[k,S]=(0,rn.useState)(null);t3();var x=p8(),T=(0,rn.useCallback)(_=>{x(_),typeof t=="function"&&t(_),w(_),S(_)},[x,t,w,S]),E=(0,rn.useCallback)(_=>{v(_M(_)),v(Go({handler:o,reactEvent:_}))},[v,o]),C=(0,rn.useCallback)(_=>{v(Vk(_)),v(Go({handler:c,reactEvent:_}))},[v,c]),N=(0,rn.useCallback)(_=>{v(ak()),v(Go({handler:d,reactEvent:_}))},[v,d]),D=(0,rn.useCallback)(_=>{v(Vk(_)),v(Go({handler:u,reactEvent:_}))},[v,u]),A=(0,rn.useCallback)(()=>{v(WM())},[v]),P=(0,rn.useCallback)(_=>{v(RM(_.key))},[v]),I=(0,rn.useCallback)(_=>{v(Go({handler:a,reactEvent:_}))},[v,a]),M=(0,rn.useCallback)(_=>{v(Go({handler:s,reactEvent:_}))},[v,s]),O=(0,rn.useCallback)(_=>{v(Go({handler:l,reactEvent:_}))},[v,l]),F=(0,rn.useCallback)(_=>{v(Go({handler:p,reactEvent:_}))},[v,p]),L=(0,rn.useCallback)(_=>{v(Go({handler:f,reactEvent:_}))},[v,f]),B=(0,rn.useCallback)(_=>{v(UM(_)),v(Go({handler:g,reactEvent:_}))},[v,g]),j=(0,rn.useCallback)(_=>{v(Go({handler:m,reactEvent:_}))},[v,m]);return Yk.createElement(JN.Provider,{value:b},Yk.createElement($z.Provider,{value:k},Yk.createElement("div",{className:Oe("recharts-wrapper",n),style:ode({position:"relative",cursor:"default",width:h,height:i},y),role:"application",onClick:E,onContextMenu:I,onDoubleClick:M,onFocus:A,onKeyDown:P,onMouseDown:O,onMouseEnter:C,onMouseLeave:N,onMouseMove:D,onMouseUp:F,onTouchEnd:j,onTouchMove:B,onTouchStart:L,ref:T},r)))});var cde=["children","className","width","height","style","compact","title","desc"];function dde(e,t){if(e==null)return{};var r,n,i=ude(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function ude(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var h8=(0,g8.forwardRef)((e,t)=>{var{children:r,className:n,width:i,height:o,style:a,compact:s,title:l,desc:c}=e,d=dde(e,cde),u=Ce(d,!1);return s?_v.createElement(qM,{otherAttributes:u,title:l,desc:c},r):_v.createElement(f8,{className:n,style:a,width:i,height:o,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},_v.createElement(qM,{otherAttributes:u,title:l,desc:c,ref:t},_v.createElement(Q6,null,r)))});var pde=["width","height"];function GM(){return GM=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},GM.apply(null,arguments)}function mde(e,t){if(e==null)return{};var r,n,i=fde(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function fde(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var gde={top:5,right:5,bottom:5,left:5},hde={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:gde,reverseStackOrder:!1,syncMethod:"index"},cf=(0,v8.forwardRef)(function(t,r){var n,i=en(t.categoricalChartProps,hde),{width:o,height:a}=i,s=mde(i,pde);if(!hm(o)||!hm(a))return null;var{chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:d,tooltipPayloadSearcher:u,categoricalChartProps:p}=t,m={chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:d,tooltipPayloadSearcher:u,eventEmitter:void 0};return lf.createElement(s8,{preloadedState:{options:m},reduxStoreName:(n=p.id)!==null&&n!==void 0?n:l},lf.createElement(z6,{chartData:p.data}),lf.createElement(c8,{width:o,height:a,layout:i.layout,margin:i.margin}),lf.createElement(u8,{accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className}),lf.createElement(h8,GM({},s,{width:o,height:a,ref:r})))});var y8=$(W()),b8=$(W());var vde=["axis","item"],fu=(0,b8.forwardRef)((e,t)=>y8.createElement(cf,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:vde,tooltipPayloadSearcher:Bm,categoricalChartProps:e,ref:t}));var w8=$(W()),x8=$(W());var yde=["axis"],zv=(0,x8.forwardRef)((e,t)=>w8.createElement(cf,{chartName:"AreaChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:yde,tooltipPayloadSearcher:Bm,categoricalChartProps:e,ref:t}));var k8=$(W()),S8=$(W());var bde=["axis"],$v=(0,S8.forwardRef)((e,t)=>k8.createElement(cf,{chartName:"ComposedChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:bde,tooltipPayloadSearcher:Bm,categoricalChartProps:e,ref:t}));var Kk=$(W());var df=Kk.default.memo(({children:e,height:t="100%",width:r="100%",className:n="",style:i={},onChartClick:o})=>{let a=typeof t=="number"?`${t}px`:t,l={width:typeof r=="number"?`${r}px`:r,height:a,overflow:"hidden",borderRadius:"8px",...i},c=`journalit-chart-container ${n}`.trim();return Kk.default.createElement("div",{className:c,style:l,onClick:o},Kk.default.createElement(is,{width:"100%",height:"100%"},e))});var Gs=$(W());var YM=e=>e.type==="text"||typeof e.value=="string"?e.value.toString():typeof e.value=="number"?e.type==="pnl"?Ug(e.value,"pnl"):e.type==="drawdown"?Ug(e.value,"drawdown"):Ug(e.value,"number"):String(e.value),uf=Gs.default.memo(({active:e,payload:t,dateKey:r="date",valueKey:n="pnl",valueType:i="pnl",additionalItems:o,formatter:a})=>{if(!e||!t||t.length===0)return null;let s=t[0].payload;if(a){let{title:f,primaryValue:y,items:h}=a(s),v=y.isPositive?Do.positive:y.isNegative?Do.negative:"";return Gs.default.createElement("div",{className:Do.container},Gs.default.createElement("div",{className:Do.date},f),Gs.default.createElement("div",{className:`${Do.value} ${v}`},YM(y)),h==null?void 0:h.map((b,w)=>Gs.default.createElement("div",{key:w,className:Do.info,style:b.isPositive||b.isNegative?{color:b.isPositive?"var(--chart-positive)":"var(--chart-negative)"}:void 0},b.label,": ",YM(b))))}let l=s[r],c=s[n],d=i==="pnl"?c>=0:!1,u=i==="drawdown"?!0:c<0,p=Ug(c,i),m=d?Do.positive:u?Do.negative:"",g=o?o(s):[];return Gs.default.createElement("div",{className:Do.container},Gs.default.createElement("div",{className:Do.date},l),Gs.default.createElement("div",{className:`${Do.value} ${m}`},p),g.map((f,y)=>Gs.default.createElement("div",{key:y,className:Do.info,style:f.isPositive||f.isNegative?{color:f.isPositive?"var(--chart-positive)":"var(--chart-negative)"}:void 0},f.label,": ",YM(f))))});var wde=e=>We.default.createElement(uf,{...e,valueKey:"pnl",valueType:"pnl",additionalItems:t=>t.tradePnL!==0?[{label:"Trade P&L",value:t.tradePnL,type:"pnl",isPositive:t.tradePnL>0,isNegative:t.tradePnL<0}]:[]}),xde=0,Uc="var(--chart-positive, #43a047)",Vc="var(--chart-negative, #e53935)",Ys=We.default.memo(({data:e,height:t="100%",width:r="100%",minValue:n,maxValue:i,gradientTransitionOffset:o,margin:a={top:6,right:5,left:0,bottom:6},className:s="",style:l={},tooltipProps:c={},showTooltip:d=!0,customTooltip:u,autoRange:p=!0,paddingPercentage:m=.05,fillGradient:g=!0,onChartClick:f,onPointClick:y})=>{let h=(0,We.useMemo)(()=>`pnl-chart-${++xde}`,[]),v=(0,We.useMemo)(()=>{let C=Math.min(...e.map(D=>D.pnl)),N=Math.max(...e.map(D=>D.pnl));return{dataMin:C,dataMax:N}},[e]),b=(0,We.useMemo)(()=>{let{dataMin:C,dataMax:N}=v,[D,A]=j2(C,N,n,i,m),P=A;if(N-C>0&&i===void 0)if(N>1e3){let O=N>1e4?1e3:500,F=Math.ceil(N/O)*O;P=Math.min(F,N*1.1)}else P=N*1.05;let M=o;if(M===void 0){let O=P-D;O!==0?M=(P-0)/O*100:M=P<0?100:0,M=Math.max(0,Math.min(100,M))}return{actualMinValue:D,adjustedMaxValue:P,actualTransitionOffset:M}},[v,n,i,o,m]),{actualMinValue:w,adjustedMaxValue:k,actualTransitionOffset:S}=b,x=`url(#${h}-gradientDual)`,T=`url(#${h}-strokeGradient)`;w>=0&&k>=0?x=`url(#${h}-gradientPositive)`:k<=0&&w<=0&&(x=`url(#${h}-gradientNegative)`);let E=C=>{if(f&&f(C),y&&C&&C.activePayload&&C.activePayload.length>0){let N=C.activePayload[0].payload,D=e.findIndex(A=>A===N);D!==-1&&y(N,D)}};return We.default.createElement(df,{height:t,width:r,className:s,style:l,onChartClick:E},We.default.createElement(zv,{data:e,margin:a,onClick:E},We.default.createElement("defs",null,We.default.createElement("linearGradient",{id:`${h}-gradientPositive`,x1:"0",y1:"1",x2:"0",y2:"0"},We.default.createElement("stop",{offset:"0%",stopColor:Uc,stopOpacity:.1}),We.default.createElement("stop",{offset:"100%",stopColor:Uc,stopOpacity:.4})),We.default.createElement("linearGradient",{id:`${h}-gradientNegative`,x1:"0",y1:"0",x2:"0",y2:"1"},We.default.createElement("stop",{offset:"0%",stopColor:Vc,stopOpacity:.1}),We.default.createElement("stop",{offset:"100%",stopColor:Vc,stopOpacity:.4})),We.default.createElement("linearGradient",{id:`${h}-gradientDual`,x1:"0",y1:"0",x2:"0",y2:"1"},We.default.createElement("stop",{offset:"0%",stopColor:Uc,stopOpacity:.4}),We.default.createElement("stop",{offset:`${S}%`,stopColor:Uc,stopOpacity:.1}),We.default.createElement("stop",{offset:`${S}%`,stopColor:Vc,stopOpacity:.1}),We.default.createElement("stop",{offset:"100%",stopColor:Vc,stopOpacity:.4})),We.default.createElement("linearGradient",{id:`${h}-strokeGradient`,x1:"0",y1:"0",x2:"0",y2:"1"},S<=.1?We.default.createElement(We.default.Fragment,null,We.default.createElement("stop",{offset:"0%",stopColor:Vc}),We.default.createElement("stop",{offset:"100%",stopColor:Vc})):S>=99.9?We.default.createElement(We.default.Fragment,null,We.default.createElement("stop",{offset:"0%",stopColor:Uc}),We.default.createElement("stop",{offset:"100%",stopColor:Uc})):We.default.createElement(We.default.Fragment,null,We.default.createElement("stop",{offset:"0%",stopColor:Uc}),We.default.createElement("stop",{offset:`${Math.max(.1,S-.1)}%`,stopColor:Uc}),We.default.createElement("stop",{offset:`${Math.min(99.9,S+.1)}%`,stopColor:Vc}),We.default.createElement("stop",{offset:"100%",stopColor:Vc}))),We.default.createElement("filter",{id:`${h}-shadow`,height:"120%"},We.default.createElement("feDropShadow",{dx:"0",dy:"1",stdDeviation:"2",floodOpacity:"0.1"})),We.default.createElement("filter",{id:`${h}-glow`,height:"130%"},We.default.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"2",result:"blur"}),We.default.createElement("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7",result:"glow"}),We.default.createElement("feComposite",{in:"SourceGraphic",in2:"glow",operator:"over"}))),We.default.createElement(hi,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),We.default.createElement(Hr,{y:0,stroke:"var(--text-normal, #888888)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1.5,ifOverflow:"extendDomain"}),We.default.createElement(bn,{dataKey:"date",style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:8,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5}}),We.default.createElement(wn,{tickFormatter:C=>fe(C),style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:[w,k],allowDataOverflow:!1,width:75,ticks:hp(w,k,5),scale:"linear",tickLine:!1,axisLine:!1,tickMargin:5}),d&&We.default.createElement(Li,{content:u||wde,cursor:{fill:"var(--interactive-hover)",fillOpacity:.1,strokeOpacity:.3,strokeWidth:1,stroke:"var(--interactive-accent)"},wrapperStyle:{zIndex:1e3},...c}),We.default.createElement(co,{type:"monotone",dataKey:"pnl",stroke:T,strokeWidth:2.5,fill:g?x:"none",dot:!1,activeDot:{r:7,strokeWidth:1,stroke:"var(--background-primary)",fill:"var(--interactive-accent, #4299e1)",filter:`url(#${h}-glow)`},animationDuration:500,animationEasing:"ease-out",filter:`url(#${h}-shadow)`})))});Ys.displayName="SharedPnLChart";var Dr=$(W());var kde=e=>Dr.default.createElement(uf,{...e,valueKey:"drawdown",valueType:"drawdown",additionalItems:t=>[{label:"P&L",value:t.pnl,type:"pnl",isPositive:t.pnl>0,isNegative:t.pnl<0},{label:"Peak Equity",value:t.peakEquity,type:"pnl"}]}),zl=Dr.default.memo(({data:e,height:t="100%",width:r="100%",minValue:n,maxValue:i,margin:o={top:6,right:5,left:0,bottom:6},className:a="",style:s={},tooltipProps:l={},showTooltip:c=!0,customTooltip:d,autoRange:u=!0,paddingPercentage:p=.05,onChartClick:m,onPointClick:g})=>{let f=(0,Dr.useMemo)(()=>{let w=Math.min(...e.map(T=>T.drawdown)),k=i!==void 0?i:0,S=n!==void 0?n:Math.min(0,w);if(w<0&&n===void 0){let T=Math.abs(w)*p;S=Math.min(S,w-T),w>-20&&(S=Math.max(S,w*1.15))}return{yAxisMax:k,yAxisMin:S,negativeColor:"var(--text-error, #e53935)"}},[e,n,i,p]),{yAxisMax:y,yAxisMin:h,negativeColor:v}=f,b=w=>{if(m&&m(w),g&&w&&w.activePayload&&w.activePayload.length>0){let k=w.activePayload[0].payload,S=e.findIndex(x=>x===k);S!==-1&&g(k,S)}};return Dr.default.createElement(df,{height:t,width:r,className:a,style:s,onChartClick:b},Dr.default.createElement(zv,{data:e,margin:o,onClick:b},Dr.default.createElement("defs",null,Dr.default.createElement("linearGradient",{id:"drawdownGradient",x1:"0",y1:"0",x2:"0",y2:"1"},Dr.default.createElement("stop",{offset:"0%",stopColor:v,stopOpacity:.1}),Dr.default.createElement("stop",{offset:"100%",stopColor:v,stopOpacity:.4})),Dr.default.createElement("filter",{id:"drawdown-shadow",height:"120%"},Dr.default.createElement("feDropShadow",{dx:"0",dy:"1",stdDeviation:"2",floodOpacity:"0.1"})),Dr.default.createElement("filter",{id:"drawdown-glow",height:"130%"},Dr.default.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"2",result:"blur"}),Dr.default.createElement("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7",result:"glow"}),Dr.default.createElement("feComposite",{in:"SourceGraphic",in2:"glow",operator:"over"}))),Dr.default.createElement(hi,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),Dr.default.createElement(Hr,{y:0,stroke:"var(--text-normal, #888888)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1.5,ifOverflow:"extendDomain"}),Dr.default.createElement(bn,{dataKey:"date",style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:8,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5}}),Dr.default.createElement(wn,{tickFormatter:w=>zC(w),style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:[h,y],allowDataOverflow:!1,width:75,ticks:hp(h,y,5),scale:"linear",tickLine:!1,axisLine:!1,tickMargin:5}),c&&Dr.default.createElement(Li,{content:d||kde,cursor:{fill:"var(--interactive-hover)",fillOpacity:.1,strokeOpacity:.3,strokeWidth:1,stroke:"var(--interactive-accent)"},wrapperStyle:{zIndex:1e3},...l}),Dr.default.createElement(co,{type:"monotone",dataKey:"drawdown",stroke:v,strokeWidth:2.5,fill:"url(#drawdownGradient)",fillOpacity:.4,dot:!1,activeDot:{r:7,strokeWidth:1,stroke:"var(--background-primary)",fill:v,filter:"url(#drawdown-glow)"},animationDuration:1e3,animationEasing:"ease-out",filter:"url(#drawdown-shadow)"})))});var nn=$(W());var Sde=e=>e===0?"$0":fe(e),Tde=e=>{if(!e.active||!e.payload||e.payload.length===0)return null;let t=e.payload[0].payload,r=t.entryTime?new Date(t.entryTime).toLocaleString():"Unknown",n=t.exitTime?new Date(t.exitTime).toLocaleString():"Unknown";return nn.default.createElement(uf,{...e,formatter:i=>({title:i.instrument?`${i.instrument} ${i.direction==="long"?"\u2191":"\u2193"}`:`Trade #${i.tradeIndex+1}`,primaryValue:{value:i.pnl,type:"pnl",isPositive:i.pnl>=0,isNegative:i.pnl<0},items:[{label:"Entry",value:r,type:"text"},{label:"Exit",value:n,type:"text"},{label:"Trade",value:`#${i.tradeIndex+1}`,type:"text"}]})})},Rv=({data:e,height:t="100%",width:r="100%",minValue:n,maxValue:i,margin:o={top:6,right:5,left:0,bottom:6},className:a="",style:s={},tooltipProps:l={},showTooltip:c=!0,customTooltip:d,autoRange:u=!0,paddingPercentage:p=.05,onChartClick:m,onPointClick:g})=>{let f=Math.min(...e.map(k=>k.pnl)),y=Math.max(...e.map(k=>k.pnl)),h=n!==void 0?n:Math.min(0,f),v=i!==void 0?i:Math.max(0,y),b=y-f;if(f<0&&n===void 0){let k=Math.max(Math.abs(f)*.02,10);h=Math.min(h,f-k)}if(y>0&&i===void 0){let k=Math.max(y*.02,10);v=Math.max(v,y+k)}if(y>0&&i===void 0){let k=Math.pow(10,Math.floor(Math.log10(y))),S;if(y>1e3){let x=y>5e3?1e3:500;S=Math.ceil(y/x)*x}else y>100?S=Math.ceil(y/100)*100:y>10?S=Math.ceil(y/10)*10:S=Math.ceil(y*1.05);S=Math.min(S,y*1.1),v=Math.min(v,S)}if(f<0&&n===void 0){let k=Math.pow(10,Math.floor(Math.log10(Math.abs(f)))),S;if(Math.abs(f)>1e3){let x=Math.abs(f)>5e3?1e3:500;S=Math.floor(f/x)*x}else Math.abs(f)>100?S=Math.floor(f/100)*100:Math.abs(f)>10?S=Math.floor(f/10)*10:S=Math.floor(f*1.05);S=Math.max(S,f*1.1),h=Math.max(h,S)}if(e.length===0)return nn.default.createElement("div",{style:{width:"100%",height:typeof t=="number"?`${t}px`:t,display:"flex",justifyContent:"center",alignItems:"center"}},nn.default.createElement(Ae,{message:"No trades available",subMessage:"Try selecting a different time period",iconSize:36}));let w=(k,S,x)=>{g&&g(S,x)};return nn.default.createElement(df,{height:t,width:r,className:a,style:s,onChartClick:m},nn.default.createElement(fu,{data:e,margin:o},nn.default.createElement("defs",null,nn.default.createElement("filter",{id:"tradesChartBarShadow",height:"130%"},nn.default.createElement("feDropShadow",{dx:"0",dy:"2",stdDeviation:"2",floodOpacity:"0.1"})),nn.default.createElement("filter",{id:"tradesChartBarGlow",height:"130%"},nn.default.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"1.5",result:"blur"}),nn.default.createElement("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7",result:"glow"}),nn.default.createElement("feComposite",{in:"SourceGraphic",in2:"glow",operator:"over"}))),nn.default.createElement(hi,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),nn.default.createElement(Hr,{y:0,stroke:"var(--text-normal, #888888)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1.5,ifOverflow:"extendDomain"}),nn.default.createElement(bn,{dataKey:"tradeIndex",tickFormatter:k=>`#${k+1}`,style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:8,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5}}),nn.default.createElement(wn,{tickFormatter:Sde,style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:[h,v],allowDataOverflow:!1,width:75,ticks:hp(h,v,5),interval:"preserveStartEnd",scale:"linear",tickLine:!1,axisLine:!1,tickMargin:5}),c&&nn.default.createElement(Li,{content:d||Tde,cursor:{fill:"var(--interactive-hover)",fillOpacity:.1,strokeOpacity:.3,strokeWidth:1,stroke:"var(--interactive-accent)"},wrapperStyle:{zIndex:1e3},...l}),nn.default.createElement(ls,{dataKey:"pnl",fill:"#8884d8",minPointSize:5,isAnimationActive:!0,animationDuration:800,animationEasing:"ease-out",stroke:"var(--background-primary)",strokeWidth:.8,strokeOpacity:.5,filter:"url(#tradesChartBarShadow)",radius:[2,2,0,0],activeBar:{filter:"url(#tradesChartBarGlow)",strokeWidth:1.2,strokeOpacity:.8},shape:k=>{var j,_;let{x:S,y:x,width:T,height:E}=k,N=(((j=k.payload)==null?void 0:j.pnl)||0)>=0,D=((_=k.payload)==null?void 0:_.fill)||(N?"var(--chart-positive)":"var(--chart-negative)"),A=S||0,P=x||0,I=T||0,M=E||0,O=M<0?Math.abs(M):M,F=M<0?P+M:P,L;N?L=[2,2,0,0]:L=[0,0,2,2];let B=k.index||0;return nn.default.createElement("rect",{x:A,y:F,width:I,height:O>0?O:0,fill:D,stroke:k.stroke,strokeWidth:k.strokeWidth,strokeOpacity:k.strokeOpacity,filter:N?k.filter:"none",rx:L[0],ry:L[0],onClick:H=>w(H,k.payload,B)})}})))};var Pr=$(W());var Cde=(e,t,r)=>{let n=[],i=t-e,o=i/(r-1),a=Math.pow(10,Math.floor(Math.log10(o))),s;o/a<1.5?s=a:o/a<3.5?s=2*a:o/a<7.5?s=5*a:s=10*a,i<10*a&&s>a&&(s=a);let l=Math.floor(e/s)*s,c=Math.ceil(t/s)*s;for(let d=l;d<=c;d+=s){let u=parseFloat(d.toFixed(12));n.push(u)}return e<=0&&0<=t&&!n.includes(0)&&n.push(0),[...new Set(n)].sort((d,u)=>d-u)},Ede=({active:e,payload:t})=>{if(!e||!t||t.length===0)return null;let r=t[0].payload,n=r.pnl>=0,i=fe(r.pnl);return Pr.default.createElement("div",{className:"journalit-chart-tooltip",style:{backgroundColor:"var(--background-primary)",borderRadius:"10px",padding:"14px 18px",minWidth:"140px",border:"1px solid var(--background-modifier-border)",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.2)",transform:"translateY(-4px)",position:"relative",animation:"tooltipFadeIn 0.2s cubic-bezier(0.19, 1, 0.22, 1)"}},Pr.default.createElement("div",{className:"journalit-chart-tooltip-date",style:{fontSize:"14px",fontWeight:500,color:"var(--text-normal)",marginBottom:"8px",textAlign:"center",borderBottom:"1px solid var(--background-modifier-border)",paddingBottom:"6px"}},r.date),Pr.default.createElement("div",{className:`journalit-chart-tooltip-value ${n?"positive":"negative"}`,style:{fontSize:"20px",fontWeight:600,textAlign:"center",color:n?"var(--chart-positive)":"var(--chart-negative)"}},i),r.trades!==void 0&&Pr.default.createElement("div",{className:"journalit-chart-tooltip-info",style:{fontSize:"12px",color:"var(--text-muted)",marginTop:"8px",textAlign:"center",fontStyle:"italic"}},r.trades," ",r.trades===1?"trade":"trades"))},KM=Pr.default.memo(({data:e,height:t="100%",minValue:r,maxValue:n})=>{let i=Math.min(...e.map(d=>d.pnl)),o=Math.max(...e.map(d=>d.pnl)),a=r!==void 0?r:Math.min(0,i),s=n!==void 0?n:Math.max(0,o);if(i<0){let d=Math.abs(i)*.05;a=r!==void 0?r:Math.min(a,i-d)}if(o>0){let d=o*.05;s=n!==void 0?n:Math.max(s,o+d)}let l=o-i;l>0&&l<100&&(a=Math.max(a,i-l*.03),s=Math.min(s,o+l*.03));let c=typeof t=="number"?`${t}px`:t;return Pr.default.createElement("div",{style:{width:"100%",height:c,overflow:"hidden",borderRadius:"8px"}},Pr.default.createElement(is,{width:"100%",height:"100%"},Pr.default.createElement(fu,{data:e,margin:{top:6,right:5,left:0,bottom:6}},Pr.default.createElement("defs",null,Pr.default.createElement("filter",{id:"dailyPerformanceBarShadow",height:"130%"},Pr.default.createElement("feDropShadow",{dx:"0",dy:"2",stdDeviation:"2",floodOpacity:"0.1"})),Pr.default.createElement("filter",{id:"dailyPerformanceBarGlow",height:"130%"},Pr.default.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"1.5",result:"blur"}),Pr.default.createElement("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7",result:"glow"}),Pr.default.createElement("feComposite",{in:"SourceGraphic",in2:"glow",operator:"over"}))),Pr.default.createElement(hi,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),Pr.default.createElement(Hr,{y:0,stroke:"var(--text-normal, #888888)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1.5,ifOverflow:"extendDomain"}),Pr.default.createElement(bn,{dataKey:"date",style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:8,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5}}),Pr.default.createElement(wn,{tickFormatter:d=>fe(d),style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:[a,s],allowDataOverflow:!1,width:75,ticks:Cde(a,s,5),scale:"linear",tickLine:!1,axisLine:!1,tickMargin:5}),Pr.default.createElement(Li,{content:Pr.default.createElement(Ede,null),cursor:{fill:"var(--interactive-hover)",fillOpacity:.1,strokeOpacity:.3,strokeWidth:1,stroke:"var(--interactive-accent)"},wrapperStyle:{zIndex:1e3}}),Pr.default.createElement(ls,{dataKey:"pnl",fill:"#8884d8",minPointSize:5,isAnimationActive:!0,animationDuration:800,animationEasing:"ease-out",stroke:"var(--background-primary)",strokeWidth:.8,strokeOpacity:.5,filter:"url(#dailyPerformanceBarShadow)",radius:[2,2,0,0],activeBar:{filter:"url(#dailyPerformanceBarGlow)",strokeWidth:1.2,strokeOpacity:.8}}))))});var xr=$(W());var Dde=(e,t=10)=>e.length<=t?e:e.substring(0,t-1)+"\u2026";var Pde=({active:e,payload:t})=>{if(!e||!t||t.length===0)return null;let r=t[0].payload,n=r.pnl>=0,i=fe(r.pnl);return xr.default.createElement("div",{className:"journalit-chart-tooltip",style:{backgroundColor:"var(--background-primary)",borderRadius:"10px",padding:"14px 18px",minWidth:"140px",border:"1px solid var(--background-modifier-border)",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.2)",transform:"translateY(-4px)",position:"relative"}},xr.default.createElement("div",{className:"journalit-chart-tooltip-setup",style:{fontSize:"14px",fontWeight:500,color:"var(--text-normal)",marginBottom:"8px",textAlign:"center",borderBottom:"1px solid var(--background-modifier-border)",paddingBottom:"6px"}},r.name),xr.default.createElement("div",{className:`journalit-chart-tooltip-value ${n?"positive":"negative"}`,style:{fontSize:"20px",fontWeight:600,textAlign:"center",color:n?"var(--chart-positive)":"var(--chart-negative)"}},i),xr.default.createElement("div",{className:"journalit-chart-tooltip-info",style:{fontSize:"12px",color:"var(--text-muted)",marginTop:"8px",textAlign:"center",fontStyle:"italic"}},"Win Rate: ",r.winRate.toFixed(1),"%"),xr.default.createElement("div",{className:"journalit-chart-tooltip-info",style:{fontSize:"12px",color:"var(--text-muted)",marginTop:"4px",textAlign:"center",fontStyle:"italic"}},r.tradeCount," ",r.tradeCount===1?"trade":"trades"))},Wv=({data:e,height:t="100%",minValue:r,maxValue:n})=>{let i=Math.min(...e.map(d=>d.pnl)),o=Math.max(...e.map(d=>d.pnl)),a=r!==void 0?r:Math.min(0,i),s=n!==void 0?n:Math.max(1,o);if(i<0){let d=Math.abs(i)*.05;a=r!==void 0?r:Math.min(a,i-d)}if(o>0){let d=o*.05;s=n!==void 0?n:Math.max(s,o+d)}let l=o-i;if(l>0&&e.length<=5){let d=l*.03,u=l*.03;a=Math.max(a,i-d),s=Math.min(s,o+u)}let c=typeof t=="number"?`${t}px`:t;return xr.default.createElement("div",{style:{width:"100%",height:c,overflow:"hidden",borderRadius:"8px"}},xr.default.createElement(is,{width:"100%",height:"100%"},xr.default.createElement(fu,{data:e,margin:{top:6,right:5,left:0,bottom:6}},xr.default.createElement("defs",null,xr.default.createElement("filter",{id:"setup-bar-shadow",height:"130%"},xr.default.createElement("feDropShadow",{dx:"0",dy:"2",stdDeviation:"2",floodOpacity:"0.1"})),xr.default.createElement("filter",{id:"setup-bar-glow",height:"130%"},xr.default.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"1.5",result:"blur"}),xr.default.createElement("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7",result:"glow"}),xr.default.createElement("feComposite",{in:"SourceGraphic",in2:"glow",operator:"over"}))),xr.default.createElement(hi,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),xr.default.createElement(Hr,{y:0,stroke:"var(--text-normal, #888888)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1.5,ifOverflow:"extendDomain"}),xr.default.createElement(bn,{dataKey:"name",style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:8,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5},tickFormatter:d=>Dde(d),interval:0}),xr.default.createElement(wn,{tickFormatter:d=>fe(d),style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:[a,s],allowDataOverflow:!1,width:75,scale:"linear",tickLine:!1,axisLine:!1,tickMargin:5}),xr.default.createElement(Li,{content:xr.default.createElement(Pde,null),cursor:{fill:"var(--interactive-hover)",fillOpacity:.1,strokeOpacity:.3,strokeWidth:1,stroke:"var(--interactive-accent)"},wrapperStyle:{zIndex:1e3}}),xr.default.createElement(ls,{dataKey:"pnl",fill:"#8884d8",minPointSize:0,isAnimationActive:!0,animationDuration:800,animationEasing:"ease-out",stroke:"var(--background-primary)",strokeWidth:.8,strokeOpacity:.5,filter:"url(#setup-bar-shadow)",radius:[2,2,0,0],activeBar:{filter:"url(#setup-bar-glow)",strokeWidth:1.2,strokeOpacity:.8},shape:d=>{let u=d.payload&&d.payload.pnl>=0,p=u?"var(--chart-positive)":"var(--chart-negative)",{x:m,y:g,width:f,height:y}=d,h=m||0,v=g||0,b=f||0,w=y||0,k=w<0?Math.abs(w):w,S=w<0?v+w:v,x=u?[2,2,0,0]:[0,0,2,2];return xr.default.createElement("rect",{x:h,y:S,width:b,height:k>0?k:0,fill:p,stroke:d.stroke,strokeWidth:d.strokeWidth,strokeOpacity:d.strokeOpacity,filter:d.filter,rx:x[0],ry:x[0]})}}))))};var lt=$(W());var T8=(0,lt.memo)(({day:e,dayIndex:t,onClick:r})=>{let n=(0,lt.useCallback)(()=>{e.date&&r(e.date)},[e.date,r]),i=["journalit-dashboard-calendar-day",e.currentMonth?"current-month":"other-month",e.pnl!==null&&e.pnl>0?"positive":"",e.pnl!==null&&e.pnl<0?"negative":"",t===5||t===6?"weekend-day":"",e.isToday?"today":""].filter(Boolean).join(" ");return lt.default.createElement("div",{className:i,onClick:n},lt.default.createElement("div",{className:"journalit-dashboard-calendar-day-number"},e.dayNumber||""),e.pnl!==null&&lt.default.createElement("div",{className:"journalit-dashboard-calendar-day-pnl"},fe(e.pnl,!1)),e.tradeCount>0&&lt.default.createElement("div",{className:"journalit-dashboard-calendar-day-trades"},e.tradeCount===1?"1 trade":`${e.tradeCount} trades`))});T8.displayName="CalendarDay";var Jk=(0,lt.memo)(({trades:e,filters:t,onDayClick:r,onWeekClick:n,height:i="100%"})=>{var v,b,w,k,S,x,T;let o=Ge(),a=(0,lt.useMemo)(()=>{var E,C,N;return(N=(C=(E=o==null?void 0:o.settings)==null?void 0:E.trade)==null?void 0:C.skipWeekends)!=null?N:!0},[(b=(v=o==null?void 0:o.settings)==null?void 0:v.trade)==null?void 0:b.skipWeekends]),s=(0,lt.useRef)(null);(0,lt.useEffect)(()=>{let E=null;return E=requestAnimationFrame(()=>{s.current&&(Object.assign(s.current.style,{width:"100%",height:"100%"}),Jg(),la(),Kg())}),()=>{E!==null&&cancelAnimationFrame(E),window.__journalitCalendarResizeObserver&&window.__journalitCalendarResizeObserver.disconnect()}},[]),(0,lt.useEffect)(()=>{let E=()=>{s.current&&la()};return document.addEventListener("layout-changed",E),()=>{document.removeEventListener("layout-changed",E)}},[]);let l={},c={};e.forEach(E=>{let C=E.entryTime.getFullYear(),N=String(E.entryTime.getMonth()+1).padStart(2,"0"),D=String(E.entryTime.getDate()).padStart(2,"0"),A=`${C}-${N}-${D}`;l[A]||(l[A]=0,c[A]=0),l[A]+=E.pnl,c[A]++});let d,u,p=new Date,m=p.getFullYear(),g=p.getMonth();!((w=t==null?void 0:t.dateRange)!=null&&w[0])&&!((k=t==null?void 0:t.dateRange)!=null&&k[1])?(d=new Date(m,g,1),u=new Date(m,g+1,0)):(S=t==null?void 0:t.dateRange)!=null&&S[0]&&t.dateRange[0].getFullYear()===m&&t.dateRange[0].getMonth()===0&&t.dateRange[0].getDate()===1?(d=new Date(m,0,1),u=new Date(m,11,31)):(d=((x=t==null?void 0:t.dateRange)==null?void 0:x[0])||(e.length>0?new Date(Math.min(...e.map(E=>E.entryTime.getTime()))):p),u=((T=t==null?void 0:t.dateRange)==null?void 0:T[1])||p),d>u&&(d=new Date(u),d.setDate(1),console.warn("Calendar: Corrected invalid date range where start date was after end date."));let f=Ade(d,u,l,c),y=E=>{var N;let C=`${E.getFullYear()}-${String(E.getMonth()+1).padStart(2,"0")}-${String(E.getDate()).padStart(2,"0")}`;l[C]&&r?r(E):l[C]&&o&&((N=o.drcService)==null||N.openDRC(E))},h=E=>{if(n)n(E);else if(o){let C=E;o.weeklyReviewService?o.weeklyReviewService.openWeeklyReview(C):o.drcService&&(console.warn("WeeklyReviewService not found, falling back to DRCService"),o.drcService.openDRC(C))}};return lt.default.createElement("div",{ref:s,className:"journalit-dashboard-calendar",style:{width:"100%",height:i,overflow:"auto",backdropFilter:"none",WebkitBackdropFilter:"none"}},lt.default.createElement("div",{style:{display:"flex",flexDirection:"column",animation:"calendarFadeIn 0.5s ease-out",padding:"0 6px 6px 0",minHeight:"100%"}},lt.default.createElement("div",{className:`journalit-dashboard-calendar-header ${a?"hide-weekends":""}`,style:{display:"grid",gridTemplateColumns:a?"repeat(5, 1fr) 1fr":"repeat(7, 1fr) 1fr",marginBottom:"10px",gap:"4px",position:"sticky",top:0,backgroundColor:"var(--background-primary)",zIndex:5,padding:"6px 0",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.05)",borderBottom:"1px solid var(--background-modifier-border)",borderRadius:"6px"}},lt.default.createElement("div",{className:"journalit-dashboard-calendar-weekday monday-header","data-day":"Mon",style:{textAlign:"center",fontWeight:600,fontSize:"13px",color:"var(--text-muted)",display:"block !important",letterSpacing:"0.5px"}},"Mon"),lt.default.createElement("div",{className:"journalit-dashboard-calendar-weekday","data-day":"Tue",style:{textAlign:"center",fontWeight:600,fontSize:"13px",color:"var(--text-muted)",letterSpacing:"0.5px"}},"Tue"),lt.default.createElement("div",{className:"journalit-dashboard-calendar-weekday","data-day":"Wed",style:{textAlign:"center",fontWeight:500,fontSize:"12px",color:"var(--text-muted)"}},"Wed"),lt.default.createElement("div",{className:"journalit-dashboard-calendar-weekday","data-day":"Thu",style:{textAlign:"center",fontWeight:500,fontSize:"12px",color:"var(--text-muted)"}},"Thu"),lt.default.createElement("div",{className:"journalit-dashboard-calendar-weekday","data-day":"Fri",style:{textAlign:"center",fontWeight:500,fontSize:"12px",color:"var(--text-muted)"}},"Fri"),!a&&lt.default.createElement("div",{className:"journalit-dashboard-calendar-weekday","data-day":"Sat",style:{textAlign:"center",fontWeight:500,fontSize:"12px",color:"var(--text-muted)"}},"Sat"),!a&&lt.default.createElement("div",{className:"journalit-dashboard-calendar-weekday","data-day":"Sun",style:{textAlign:"center",fontWeight:500,fontSize:"12px",color:"var(--text-muted)"}},"Sun"),lt.default.createElement("div",{className:"journalit-dashboard-calendar-weekday weekly-pnl-header",style:{textAlign:"center",fontWeight:700,fontSize:"13px",color:"var(--text-on-accent)",backgroundColor:"var(--background-secondary-alt)",borderLeft:"1px solid rgba(0, 0, 0, 0.05)",borderRadius:"0 6px 6px 0",boxShadow:"inset 0 0 0 1px rgba(0, 0, 0, 0.1)"}},"P&L")),lt.default.createElement("div",{className:`journalit-dashboard-calendar-grid ${a?"hide-weekends":""}`,style:{display:"flex",flexDirection:"column",gap:"4px",flex:"1"}},f.filter(E=>a?E.some((N,D)=>D<=4&&N.date!==null):!0).map((E,C)=>{var M;let N=0,D=0,A=0,P="",I=(M=E.find(O=>O.date))==null?void 0:M.date;if(I){let O=new Date(I.getFullYear(),0,4),F=new Date(O.getFullYear(),0,1),L=Math.floor((I.getTime()-F.getTime())/864e5);P=`W${Math.ceil((L+F.getDay()+1)/7)}`}return E.forEach(O=>{O.pnl!==null&&(N+=O.pnl,A++),O.tradeCount>0&&(D+=O.tradeCount)}),lt.default.createElement("div",{key:`week-${C}`,className:`journalit-dashboard-calendar-week ${a?"hide-weekends":""}`,style:{display:"grid",gridTemplateColumns:a?"repeat(5, 1fr) 1fr":"repeat(7, 1fr) 1fr",gap:"4px",marginBottom:"4px"}},(a?E.filter((O,F)=>F<=4):E).map((O,F)=>lt.default.createElement(T8,{key:`day-${C}-${F}`,day:O,dayIndex:F,onClick:y})),lt.default.createElement("div",{className:`journalit-dashboard-calendar-weekly-pnl ${A>0?N>=0?"positive":"negative":""}`,onClick:()=>I&&h(I)},A>0&&lt.default.createElement(lt.default.Fragment,null,lt.default.createElement("div",{className:"journalit-dashboard-calendar-week-total-label"},"WEEK"),lt.default.createElement("div",{className:"journalit-dashboard-calendar-week-total-value"},fe(N,!1)),D>0&&lt.default.createElement("div",{className:"journalit-dashboard-calendar-week-trade-count"},D===1?"1 trade":`${D} trades`))))}))))});Jk.displayName="PerformanceCalendar";var Ade=(e,t,r,n)=>{let i=[],o=new Date(e);o.setDate(1);let a=new Date(t.getFullYear(),t.getMonth()+1,0);for(;o<=a;){let s=o.getFullYear(),l=o.getMonth(),d=(new Date(s,l,1).getDay()+6)%7,p=new Date(s,l+1,0).getDate(),m=1,g=[];for(;m<=p;){let f=[];for(let y=0;y<7;y++)if(m===1&&y<d||m>p)f.push({dayNumber:0,date:null,currentMonth:!1,pnl:null,tradeCount:0,isToday:!1});else{let h=new Date(s,l,m),v=`${s}-${String(l+1).padStart(2,"0")}-${String(m).padStart(2,"0")}`;f.push({dayNumber:m,date:h,currentMonth:!0,pnl:r[v]||null,tradeCount:n[v]||0,isToday:Nde(v)}),m++}g.push(f)}i.push(...g),o.setMonth(o.getMonth()+1)}return i};function Nde(e){if(!e)return!1;let t=new Date,r=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`;return e===r}var $l=$(W());function Ks(e,t){return r=>{let{trades:n,dateFormat:i="MMM DD, YYYY",...o}=r;if(!n||n.length===0)switch(t){case"pnl":return $l.default.createElement(e,{data:[],...o});case"drawdown":return $l.default.createElement(e,{data:[],...o});case"trades":return $l.default.createElement(e,{data:[],...o});default:return $l.default.createElement(e,{data:[],...o})}switch(t){case"pnl":let a=Wg(n,i);return $l.default.createElement(e,{data:a,...o});case"drawdown":let s=hd(n,i);return $l.default.createElement(e,{data:s,...o});case"trades":let l=Bg(n);return $l.default.createElement(e,{data:l,...o});default:return $l.default.createElement(e,{data:[],...o})}}}var C8=({trades:e,openNote:t})=>{let[r,n]=(0,ye.useState)(!1),[i,o]=(0,ye.useState)([]),[a,s]=(0,ye.useState)(0),[l,c]=(0,ye.useState)(""),d=(0,ye.useCallback)((v,b,w)=>{let k=w.indexOf(v);o(w),s(k>=0?k:0),c(b),n(!0)},[]),u=(0,ye.useCallback)(()=>{n(!1)},[]),p=(0,ye.useCallback)(v=>{v>=0&&v<i.length&&s(v)},[i.length]),m=(0,ye.useMemo)(()=>{if(!(i.length<=1))return{images:i,currentIndex:a,onNavigate:p,altPrefix:`Trade ${l} Image`,useResolveMediaPath:!0}},[i,a,p,l]),f=(()=>{if(e.length===0)return{totalTrades:0,winningTrades:0,losingTrades:0,breakEvenTrades:0,pnl:0,winRate:0,profitFactor:0,expectancy:0,avgWin:0,avgLoss:0,plRatio:0};let v=e.filter(M=>!at({tradeStatus:M.tradeStatus,exitTime:M.exitTime,pnl:M.pnl,useDirectPnLInput:M.useDirectPnLInput,exits:M.exits})),b=v.length,w=0,k=0,S=0,x=0,T=0,E=0;v.forEach(M=>{let O=M.pnl!==void 0&&M.pnl!==null?M.pnl:M.direction==="Long"?(M.exitPrice-M.entryPrice)*M.positionSize:(M.entryPrice-M.exitPrice)*M.positionSize;x+=O,O>0?(w++,T+=O):O<0?(k++,E+=Math.abs(O)):S++});let C=b>0?w/b*100:0,N=w>0?T/w:0,D=k>0?E/k:0,A=D>0?N/D:0,P=E>0?T/E:T>0?1/0:0,I=C/100*N-(100-C)/100*D;return{totalTrades:b,winningTrades:w,losingTrades:k,breakEvenTrades:S,pnl:x,winRate:C,profitFactor:P,expectancy:I,avgWin:N,avgLoss:D,plRatio:A}})(),y=(0,ye.useMemo)(()=>{if(!e||e.length===0)return[];let v=e.filter(S=>!at({tradeStatus:S.tradeStatus,exitTime:S.exitTime,pnl:S.pnl,useDirectPnLInput:S.useDirectPnLInput,exits:S.exits}));if(v.length===0)return[];let b=[...v].sort((S,x)=>new Date(S.entryTime).getTime()-new Date(x.entryTime).getTime()),w=0,k=[];if(b.length>0){let S=new Date(b[0].entryTime);k.push({date:Ze(S),pnl:0,tradePnL:0})}return b.forEach(S=>{var T;let x=S.pnl!==void 0&&S.pnl!==null?S.pnl:((T=S.direction)==null?void 0:T.toLowerCase())==="long"?(S.exitPrice-S.entryPrice)*S.positionSize:(S.entryPrice-S.exitPrice)*S.positionSize;w+=x,k.push({date:Ze(new Date(S.entryTime)),pnl:w,tradePnL:x})}),k},[e]),h=(0,ye.useMemo)(()=>{if(!e||e.length===0)return[];let v=e.filter(w=>!at({tradeStatus:w.tradeStatus,exitTime:w.exitTime,pnl:w.pnl,useDirectPnLInput:w.useDirectPnLInput,exits:w.exits}));if(v.length===0)return[];let b=v.map(w=>{var k;return{...w,pnl:w.pnl!==void 0&&w.pnl!==null?w.pnl:((k=w.direction)==null?void 0:k.toLowerCase())==="long"?(w.exitPrice-w.entryPrice)*w.positionSize:(w.entryPrice-w.exitPrice)*w.positionSize,entryTime:new Date(w.entryTime),exitTime:w.exitTime?new Date(w.exitTime):void 0}});return hd(b,"MMM DD, YYYY")},[e]);return ye.default.createElement("div",{className:"drc-note-trades-tab"},y.length>0&&ye.default.createElement("div",{className:"drc-section"},ye.default.createElement("h3",null,"Cumulative P&L"),ye.default.createElement(Ys,{data:y,height:250})),h.length>0&&ye.default.createElement("div",{className:"drc-section"},ye.default.createElement("h3",null,"Drawdown from Peak Equity"),ye.default.createElement(zl,{data:h,height:250})),ye.default.createElement("div",{className:"drc-section"},ye.default.createElement("h3",null,"Daily Trade Statistics"),ye.default.createElement("div",{className:"drc-stats"},ye.default.createElement("div",{className:"drc-stat-card"},ye.default.createElement("div",{className:`drc-stat-value ${f.pnl>=0?"positive":"negative"}`,title:fe(f.pnl),style:{width:"100%"}},fe(f.pnl)),ye.default.createElement("div",{className:"drc-stat-label"},"Net P&L")),ye.default.createElement("div",{className:"drc-stat-card"},ye.default.createElement("div",{className:"drc-stat-value"},f.winRate.toFixed(1).endsWith(".0")?Math.floor(f.winRate):f.winRate.toFixed(1),"%"),ye.default.createElement("div",{className:"drc-stat-label"},"Win Rate")),ye.default.createElement("div",{className:"drc-stat-card"},ye.default.createElement("div",{className:"drc-stat-value"},f.profitFactor===1/0?"\u221E":f.profitFactor.toFixed(2)),ye.default.createElement("div",{className:"drc-stat-label"},"Profit Factor")),ye.default.createElement("div",{className:"drc-stat-card"},ye.default.createElement("div",{className:"drc-stat-value"},fe(f.expectancy)),ye.default.createElement("div",{className:"drc-stat-label"},"Expectancy")),ye.default.createElement("div",{className:"drc-stat-card"},ye.default.createElement("div",{className:"drc-stat-value"},f.totalTrades),ye.default.createElement("div",{className:"drc-stat-label"},"Total Trades")),ye.default.createElement("div",{className:"drc-stat-card"},ye.default.createElement("div",{className:"drc-stat-value positive"},fe(f.avgWin)),ye.default.createElement("div",{className:"drc-stat-label"},"Avg Win")),ye.default.createElement("div",{className:"drc-stat-card"},ye.default.createElement("div",{className:"drc-stat-value negative"},fe(f.avgLoss)),ye.default.createElement("div",{className:"drc-stat-label"},"Avg Loss")),ye.default.createElement("div",{className:"drc-stat-card"},ye.default.createElement("div",{className:"drc-stat-value"},f.plRatio.toFixed(2)),ye.default.createElement("div",{className:"drc-stat-label"},"P/L Ratio")))),ye.default.createElement("div",{className:"drc-section"},ye.default.createElement("h3",null,"Trade Log"),e.length===0?ye.default.createElement(Ae,{message:"No trades for this day",subMessage:"Trades will appear here once they are added",iconSize:40}):ye.default.createElement("div",{className:"weekly-review-trades-table"},ye.default.createElement("table",null,ye.default.createElement("thead",null,ye.default.createElement("tr",null,ye.default.createElement("th",null,"Images"),ye.default.createElement("th",null,"Entry/Exit Time"),ye.default.createElement("th",null,"Ticker"),ye.default.createElement("th",null,"Direction"),ye.default.createElement("th",null,"Setup"),ye.default.createElement("th",null,"P&L"))),ye.default.createElement("tbody",null,[...e].sort((v,b)=>new Date(v.entryTime).getTime()-new Date(b.entryTime).getTime()).map((v,b)=>{var E,C;let w=v.id||`index-${b}`,k=at({tradeStatus:v.tradeStatus,exitTime:v.exitTime,pnl:v.pnl,useDirectPnLInput:v.useDirectPnLInput,exits:v.exits}),S=k?null:v.pnl!==void 0&&v.pnl!==null?v.pnl:v.direction==="Long"?(v.exitPrice-v.entryPrice)*v.positionSize:(v.entryPrice-v.exitPrice)*v.positionSize,x=S!==null&&S>0,T=[];try{if(v.images){if(Array.isArray(v.images))T=v.images;else if(typeof v.images=="string"){let N=JSON.parse(v.images);Array.isArray(N)&&(T=N.map(D=>String(D)))}}}catch(N){}return ye.default.createElement("tr",{key:`trade-${w}`,className:"weekly-review-trade-row",onClick:()=>{t&&(v.path?t(v.path,!0):v.id&&t(v.id,!0))},style:{cursor:v.path||v.id?"pointer":"default"}},ye.default.createElement("td",{className:"trade-preview-cell"},T.length>0?ye.default.createElement("div",{className:"trade-image-wrapper",onClick:N=>{N.stopPropagation(),d(T[0],v.id||b,T)},style:{cursor:"pointer"}},ye.default.createElement("div",{className:"trade-preview-thumbnail"},ye.default.createElement("img",{src:lr.resolveMediaPath(T[0]),alt:`Trade ${v.id||b} preview`,className:"trade-image",style:{width:"100%",height:"100%",objectFit:"cover"},onError:()=>{}})),T.length>1&&ye.default.createElement("span",{className:"trade-image-count-indicator"},"+",T.length-1)):ye.default.createElement(Ww,{size:24,className:"trade-no-image-icon"})),ye.default.createElement("td",null,((E=v.entryTime)==null?void 0:E.toLocaleTimeString())||"N/A"," / ",k?"OPEN":((C=v.exitTime)==null?void 0:C.toLocaleTimeString())||"N/A"),ye.default.createElement("td",null,v.instrument||v.ticker||"Unknown"),ye.default.createElement("td",null,v.direction||v.side||"N/A"),ye.default.createElement("td",null,v.setup&&Array.isArray(v.setup)?v.setup.join(", "):v.setup||"N/A"),ye.default.createElement("td",{style:{color:k?"inherit":x?"var(--color-green)":"var(--color-red)"}},k?"-":fe(S)))}))))),r&&i.length>0&&ye.default.createElement(Ka,{isOpen:r,onClose:u,title:`Trade ${l} Image`,portalId:"drc-trade-image-portal"},ye.default.createElement(kc,{imagePath:i[a],alt:`Trade ${l} Image ${a+1}`,useResolveMediaPath:!0,navigationContext:m,onClose:u})))};var He=$(W());var gt=$(W());oi();var E8=({frontmatter:e,updateFrontmatter:t,trades:r,openNote:n,plugin:i})=>{let[o,a]=(0,gt.useState)([]),[s,l]=(0,gt.useState)(!0),[c,d]=(0,gt.useState)(null);(0,gt.useEffect)(()=>{Ub()},[]);let u=()=>{var v,b;try{return i||((b=(v=window.app)==null?void 0:v.plugins)==null?void 0:b.plugins.journalit)}catch(w){return console.error("Could not access plugin instance:",w),null}},p=async()=>{try{l(!0),d(null);let v=u();if(!(v!=null&&v.missedTradeService)){d("Missed Trade service not available");return}let b=new Date(e.date),w=st(b,v),k=new Date(w);k.setHours(0,0,0,0);let S=new Date(w);S.setHours(23,59,59,999);let x=await v.missedTradeService.getMissedTrades(k,S),T=[];for(let E of x){let C=v.app.metadataCache.getFileCache(E),N=C==null?void 0:C.frontmatter;N&&N.type==="missed-trade"&&T.push({file:E,instrument:N.instrument||"Unknown",direction:N.direction||"Unknown",setup:N.setup||[],missedReason:N.missedReason||"",entryTime:N.entryTime?new Date(N.entryTime):new Date,path:E.path})}T.sort((E,C)=>C.entryTime.getTime()-E.entryTime.getTime()),a(T)}catch(v){console.error("Error loading missed trades:",v),d("Failed to load missed trades")}finally{l(!1)}};(0,gt.useEffect)(()=>{e.date&&p()},[e.date]),(0,gt.useEffect)(()=>{let v=b=>{p()};return document.addEventListener("journalit:missed-trade-data-changed",v),()=>{document.removeEventListener("journalit:missed-trade-data-changed",v)}},[e.date]);let m=v=>{n(v,!0)},g=()=>{try{let v=u();if(v!=null&&v.viewManager){let b={isMissedTrade:!0,entryTime:new Date(e.date)};v.viewManager.openTradeFormView(b)}}catch(v){console.error("Error opening trade form for missed trade:",v)}},f=v=>{switch(v.toLowerCase()){case"long":case"buy":return"\u{1F4C8}";case"short":case"sell":return"\u{1F4C9}";default:return"\u{1F4CA}"}},y=v=>!v||v.length===0?"No setup specified":v.join(", "),h=v=>gt.default.createElement("div",{key:v.path,className:"drc-missed-trade-item"},gt.default.createElement("div",{className:"drc-missed-trade-header"},gt.default.createElement("div",{className:"drc-missed-trade-main"},gt.default.createElement("span",{className:"drc-missed-trade-icon"},f(v.direction)),gt.default.createElement("span",{className:"drc-missed-trade-instrument"},v.instrument),gt.default.createElement("span",{className:"drc-missed-trade-direction"},v.direction),gt.default.createElement("span",{className:"drc-missed-trade-badge"},"MISSED")),gt.default.createElement("button",{className:"drc-missed-trade-open-btn",onClick:()=>m(v.path),title:"Open missed trade details"},"View Details \u2192")),gt.default.createElement("div",{className:"drc-missed-trade-details"},gt.default.createElement("div",{className:"drc-missed-trade-setup"},gt.default.createElement("strong",null,"Setup:")," ",y(v.setup)),v.missedReason&&gt.default.createElement("div",{className:"drc-missed-trade-reason"},gt.default.createElement("strong",null,"Reason:")," ",v.missedReason)));return s?gt.default.createElement("div",{className:"drc-missed-trades-loading"},"Loading missed trades..."):c?gt.default.createElement("div",{className:"drc-missed-trades-error"},gt.default.createElement("p",null,"Error: ",c),gt.default.createElement("button",{onClick:p,className:"drc-retry-button"},"Retry")):gt.default.createElement("div",{className:"drc-missed-trades-section"},gt.default.createElement("div",{className:"drc-missed-trades-header"},gt.default.createElement("h3",null,"Missed Trades",o.length>0&&gt.default.createElement("span",{className:"drc-missed-trades-count"},"(",o.length,")")),gt.default.createElement("button",{className:"drc-add-button drc-add-missed-trade-btn",onClick:g,title:"Add a new missed trade"},"+ Add Missed Trade")),gt.default.createElement("div",{className:"drc-missed-trades-content"},o.length===0?gt.default.createElement(Ae,{message:"No missed trades for today",subMessage:"Track trading opportunities you missed to improve your execution",iconSize:36}):gt.default.createElement("div",{className:"drc-missed-trades-list"},o.map(h))))};var D8=({frontmatter:e,updateFrontmatter:t,trades:r,openNote:n,plugin:i,instrumentOptions:o,setupOptions:a,onSaveInstrument:s,onSaveSetup:l})=>{var E,C,N;let c=e,d=t,u=()=>{let D=c.dailyGoals||[];d({dailyGoals:[...D,""]})},p=(D,A)=>{ci.logInteraction("INPUT_CHANGE","Goal text changed","ReviewSection",{goalIndex:D,valueLength:A.length});let P=[...c.dailyGoals||[]];D>=0&&D<P.length&&(P[D]=A,d({dailyGoals:P}))},m=D=>{let A=[...c.dailyGoals||[]];A.splice(D,1),d({dailyGoals:A})},g=(D,A)=>{ci.logInteraction("INPUT_CHANGE","Review question text changed","ReviewSection",{question:D,answerLength:A.length});let P={...c.reviewQuestions,[D]:A};d({reviewQuestions:P})},f=(D,A)=>{let P=c.endOfDayReview||{images:[]};d({endOfDayReview:{...P,[D]:A,timestamp:D==="images"?new Date().toISOString():P.timestamp}})},y=D=>{var P;let A=((P=c.endOfDayReview)==null?void 0:P.images)||[];f("images",[...A,D])},h=D=>{var P;let A=((P=c.endOfDayReview)==null?void 0:P.images)||[];f("images",[...A,...D])},v=(D,A)=>{var I,M;let P=[...((I=c.endOfDayReview)==null?void 0:I.images)||[]];P.splice(D,1),f("images",P);try{let O=window.app,F=(M=O==null?void 0:O.plugins)==null?void 0:M.plugins.journalit;F!=null&&F.drcService&&F.drcService.deleteImage(A).catch(console.error)}catch(O){console.error("Failed to delete EOD image:",O)}},b=async D=>{var A;try{let P=window.app,I=(A=P==null?void 0:P.plugins)==null?void 0:A.plugins.journalit;if(I!=null&&I.drcService){let M=new Date(c.date);return await I.drcService.saveDRCForecastImage(D,M,"eod")}throw new Error("DRC service not available")}catch(P){throw console.error("Failed to save EOD image:",P),P}},w=()=>{d({endOfDayReview:{...c.endOfDayReview||{images:[]},reviewed:!0,reviewedAt:new Date().toISOString()}})},k=()=>!c.dailyGoals||c.dailyGoals.length===0?null:He.default.createElement(He.default.Fragment,null,c.dailyGoals.map((D,A)=>He.default.createElement("div",{key:A,className:"drc-goal-item"},He.default.createElement("input",{type:"text",value:D,onChange:P=>p(A,P.target.value),placeholder:"Your goal for the next session"}),He.default.createElement("button",{className:"drc-remove-button",onClick:()=>m(A)},"Remove")))),S=()=>!c.reviewQuestions||Object.keys(c.reviewQuestions).length===0?He.default.createElement("div",{className:"drc-no-questions"},"No reflection questions defined. Add review questions in settings."):He.default.createElement("div",{className:"drc-reflection"},Object.entries(c.reviewQuestions).map(([D,A])=>He.default.createElement("div",{key:D,className:"drc-reflection-item"},He.default.createElement("label",null,D),He.default.createElement("textarea",{value:A,onChange:P=>g(D,P.target.value),placeholder:"Your answer..."})))),x=(D,A)=>{ci.logInteraction("DROPDOWN_CHANGE","Performance grade changed","ReviewSection",{field:D,value:A}),d({[D]:A})},T=()=>He.default.createElement("div",{className:"drc-note-grades",style:{display:"flex",justifyContent:"space-evenly",width:"100%"}},He.default.createElement("div",{className:"drc-note-grade",style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"}},He.default.createElement("span",{className:"drc-note-grade-label"},"Mental Game:"),He.default.createElement("div",{className:"drc-note-grade-dropdown",style:{display:"flex",justifyContent:"center"}},He.default.createElement("select",{value:c.mentalGrade||"C",onChange:D=>x("mentalGrade",D.target.value),className:`drc-note-grade-value grade-${(c.mentalGrade||"C").toLowerCase()}`,"aria-label":"Mental Game Grade"},He.default.createElement("option",{value:"A"},"A"),He.default.createElement("option",{value:"B"},"B"),He.default.createElement("option",{value:"C"},"C")))),He.default.createElement("div",{className:"drc-note-grade",style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"}},He.default.createElement("span",{className:"drc-note-grade-label"},"Technical Game:"),He.default.createElement("div",{className:"drc-note-grade-dropdown",style:{display:"flex",justifyContent:"center"}},He.default.createElement("select",{value:c.technicalGrade||"C",onChange:D=>x("technicalGrade",D.target.value),className:`drc-note-grade-value grade-${(c.technicalGrade||"C").toLowerCase()}`,"aria-label":"Technical Game Grade"},He.default.createElement("option",{value:"A"},"A"),He.default.createElement("option",{value:"B"},"B"),He.default.createElement("option",{value:"C"},"C")))));return He.default.createElement("div",{className:"drc-note-review-tab"},((E=c.endOfDayReview)==null?void 0:E.images)&&c.endOfDayReview.images.length>0&&He.default.createElement("div",{className:"drc-section"},He.default.createElement("h3",null,"End of Day Review"),He.default.createElement("div",{className:"drc-eod-images"},He.default.createElement(Pd,{images:c.endOfDayReview.images,altPrefix:"End of Day Review",showThumbnails:!0,showCounter:!0,enableDelete:!0,onDeleteImage:(D,A)=>v(D,A),enableFullscreen:!0}))),He.default.createElement("div",{className:"drc-section"},He.default.createElement("h3",null,"Performance Grades"),T()),He.default.createElement("div",{className:"drc-section"},He.default.createElement(E8,{frontmatter:e,updateFrontmatter:t,trades:r,openNote:n,plugin:i})),He.default.createElement("div",{className:"drc-section"},He.default.createElement("h3",null,"Reflection Questions"),S()),He.default.createElement("div",{className:"drc-section"},He.default.createElement("h3",null,"Goals for Next Session"),He.default.createElement("button",{className:"drc-add-button",onClick:u},"Add Goal"),He.default.createElement("div",{className:"drc-goals"},k())),He.default.createElement("div",{className:"drc-section"},He.default.createElement("h3",null,"End of Day Screenshots"),He.default.createElement(Dd,{onImageUploaded:D=>y(D),onMultipleImagesUploaded:D=>h(D),label:"Add screenshots",enableDragDrop:!0,saveImageFunction:b,multiple:!0,className:"drc-eod-image-uploader",enablePaste:!0})),He.default.createElement("div",{className:"drc-section drc-eod-review-button-section"},He.default.createElement(zs,{reviewed:(C=c.endOfDayReview)==null?void 0:C.reviewed,reviewedAt:(N=c.endOfDayReview)==null?void 0:N.reviewedAt,onMarkReviewed:w})))};var P8=({data:e,trades:t=[],filePath:r,openNote:n,plugin:i})=>{let o="DRCNote",a=vp(o,"general"),[s,l]=(0,kr.useState)(null),[c,d]=(0,kr.useState)([]),[u,p]=(0,kr.useState)([]),m=(0,kr.useRef)(null),[g,f]=(0,kr.useState)(r||"unknown"),y=(0,kr.useRef)(!1),h=(0,kr.useRef)(null),{service:v}=o_(),b=kr.default.useMemo(()=>_2(e),[e]),[w,k]=(0,kr.useState)(b.date?new Date(b.date):new Date);(0,kr.useEffect)(()=>{try{if(m.current&&!r){let N=m.current.getAttribute("data-displaying-file");if(N){f(N);return}let D=m.current.parentElement;for(;D;){let A=D.getAttribute("data-displaying-file")||D.getAttribute("data-file-path");if(A){f(A);break}D=D.parentElement}}}catch(N){a(N,"Error finding file path")}},[r]),(0,kr.useEffect)(()=>{b.date&&k(new Date(b.date))},[b.date]),(0,kr.useEffect)(()=>{let N=async()=>{try{if(v){let D=new Date(b.date),A=await v.getPreviousDayGoals(D);l(A)}}catch(D){sa({message:"Error fetching previous day goals",error:D,component:o,operation:"fetchPreviousDayGoals",severity:"warning"})}};!y.current&&b.date&&(N(),y.current=!0)},[b.date,v]),(0,kr.useEffect)(()=>{var N,D;try{let A=i||((D=(N=window.app)==null?void 0:N.plugins)==null?void 0:D.plugins.journalit);h.current=A==null?void 0:A.optionsService,(()=>{try{if(h.current){let M=h.current.getOptions("instrument"),O=h.current.getOptions("setup");d([...M]),p([...O])}}catch(M){sa({message:"Failed to load options",error:M,component:o,operation:"loadOptions",severity:"warning"}),d([]),p([])}})();let I=()=>{setTimeout(()=>{try{if(h.current){let M=h.current.getOptions("instrument"),O=h.current.getOptions("setup");JSON.stringify(M)!==JSON.stringify(c)&&d(M),JSON.stringify(O)!==JSON.stringify(u)&&p(O)}}catch(M){sa({message:"Error updating options",error:M,component:o,operation:"handleOptionsChanged",severity:"warning"})}},300)};return document.addEventListener("journalit-options-changed",I,{capture:!1}),()=>{document.removeEventListener("journalit-options-changed",I,{capture:!1})}}catch(A){sa({message:"Failed to set up options listeners",error:A,component:o,operation:"setupOptionsListeners",severity:"warning"}),d([]),p([])}},[]);let S=async N=>{var D,A;try{let P=i||((A=(D=window.app)==null?void 0:D.plugins)==null?void 0:A.plugins.journalit),I=P==null?void 0:P.optionsService;I&&await I.addOption("instrument",N)&&I.notifyOptionsChanged()}catch(P){sa({message:"Failed to save custom instrument option",error:P,component:o,operation:"handleSaveInstrument",severity:"warning"})}},x=async N=>{var D,A;try{let P=i||((A=(D=window.app)==null?void 0:D.plugins)==null?void 0:A.plugins.journalit),I=P==null?void 0:P.optionsService;I&&await I.addOption("setup",N)&&I.notifyOptionsChanged()}catch(P){sa({message:"Failed to save custom setup option",error:P,component:o,operation:"handleSaveSetup",severity:"warning"})}};(0,kr.useEffect)(()=>{var M;m.current&&(m.current.classList.add("drc-note-mounted"),m.current.setAttribute("data-mounted-at",Date.now().toString()));let N=(M=m.current)==null?void 0:M.closest(".journalit-drc-view");N&&N.classList.add("drc-note-mounted"),t_(),KC();let D="drc-critical-navigation-styles";if(!document.getElementById(D)){let O=document.createElement("style");O.id=D,O.innerHTML=`
        /* Critical styles for DRC P&L display - ensuring it displays properly */
        html body .drc-container .drc-stats .drc-stat-card .drc-stat-value,
        body .drc-container .drc-stats .drc-stat-card .drc-stat-value,
        .workspace-leaf .drc-container .drc-stats .drc-stat-card .drc-stat-value {
          white-space: nowrap !important;
          overflow: hidden !important;
          text-overflow: ellipsis !important;
          width: 100% !important;
          display: block !important;
        }
        
        html body .drc-container .drc-stats .drc-stat-card,
        body .drc-container .drc-stats .drc-stat-card,
        .workspace-leaf .drc-container .drc-stats .drc-stat-card {
          min-width: 0 !important;
          overflow: hidden !important;
        }
        
        /* Stats card for P&L specifically */
        html body .drc-container .drc-stats .drc-stat-card:nth-child(4),
        body .drc-container .drc-stats .drc-stat-card:nth-child(4),
        .workspace-leaf .drc-container .drc-stats .drc-stat-card:nth-child(4) {
          overflow: hidden !important;
          min-width: 140px !important;
        }
        
        /* Critical styles for DRC navigation - highest specificity possible */
        html body .drc-container .drc-header .drc-navigation,
        body .drc-container .drc-header .drc-navigation,
        .workspace-leaf .drc-container .drc-header .drc-navigation {
          width: 100% !important;
          padding-top: 10px !important;
          border-top: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1)) !important;
        }
        
        html body .drc-container .drc-header .drc-navigation .drc-navigation-links,
        body .drc-container .drc-header .drc-navigation .drc-navigation-links,
        .workspace-leaf .drc-container .drc-header .drc-navigation .drc-navigation-links {
          display: flex !important;
          justify-content: space-between !important;
          align-items: center !important;
          gap: 8px !important;
          flex-wrap: wrap !important;
          width: 100% !important;
        }
        
        html body .drc-container .drc-header .drc-navigation .drc-navigation-links .drc-nav-button,
        body .drc-container .drc-header .drc-navigation .drc-navigation-links .drc-nav-button,
        .workspace-leaf .drc-container .drc-header .drc-navigation .drc-navigation-links .drc-nav-button {
          padding: 8px 14px !important;
          border: 1px solid var(--background-modifier-border) !important;
          border-radius: 4px !important;
          background-color: var(--background-primary) !important;
          color: var(--text-normal) !important;
          cursor: pointer !important;
          font-size: 14px !important;
          transition: all 0.2s !important;
          display: flex !important;
          align-items: center !important;
          justify-content: center !important;
          gap: 6px !important;
          flex: 1 !important;
          text-align: center !important;
          min-width: 120px !important;
          box-sizing: border-box !important;
          max-width: none !important;
          margin: 0 !important;
        }
        
        /* Ensure proper icon spacing */
        html body .drc-container .drc-header .drc-navigation .drc-nav-button .nav-icon,
        body .drc-container .drc-header .drc-navigation .drc-nav-button .nav-icon {
          font-size: 16px !important;
          line-height: 1 !important;
        }
      `,document.head.appendChild(O)}if(!document.getElementById("fix-grade-display")){let O=document.createElement("style");O.id="fix-grade-display",O.textContent=`
        /* Performance Grade Containers Layout Fix */
        .drc-note-grades {
          display: flex !important;
          flex-direction: row !important;
          justify-content: space-evenly !important;
          gap: 16px !important;
          margin-bottom: 24px !important;
          width: 100% !important;
        }
        
        .drc-note-grade {
          display: flex !important;
          flex-direction: column !important;
          align-items: center !important;
          text-align: center !important;
          flex: 1 !important;
          padding: 16px !important;
          background-color: var(--background-primary) !important;
          border-radius: var(--border-radius-md, 4px) !important;
          border: 1px solid var(--background-modifier-border) !important;
        }
        
        /* Center label text */
        .drc-note-grade-label {
          text-align: center !important;
          width: 100% !important;
          margin-bottom: 12px !important;
        }
        
        /* Center dropdown in container */
        .drc-note-grade-dropdown {
          display: flex !important;
          justify-content: center !important;
          width: 100% !important;
        }

        /* Fix for grade display text cutoff and perfect centering */
        .drc-note-grade-value, 
        select.drc-note-grade-value {
          overflow: visible !important;
          min-height: 60px !important;
          min-width: 60px !important;
          width: 60px !important;
          height: 60px !important;
          max-width: 60px !important;
          max-height: 60px !important;
          padding: 0 !important; /* Remove all padding */
          font-size: 22px !important; /* Larger font */
          line-height: 1 !important; /* Critical for vertical centering */
          text-rendering: optimizeLegibility !important;
          -webkit-font-smoothing: antialiased !important;
          text-align: center !important;
          display: flex !important;
          align-items: center !important;
          justify-content: center !important;
          border-radius: 50% !important; /* Make it a circle */
          aspect-ratio: 1 / 1 !important; /* Keep it as a perfect circle */
          margin: 0 auto !important; /* Center horizontally */
          margin-top: 8px !important; /* Add some space from the label */
          border: none !important;
          -webkit-appearance: none !important;
          -moz-appearance: none !important;
          appearance: none !important;
        }
        
        /* Center text within the grade circle */
        .drc-note-grade-value,
        select.drc-note-grade-value,
        .drc-note-grade-dropdown select {
          text-align: center !important;
        }
        
        /* Prevent browser's default tooltip (the grey one) */
        .drc-note-grade-dropdown select:hover::before,
        .drc-note-grade-dropdown select::before {
          content: none !important;
          display: none !important;
        }
        
        /* Style the black tooltip */
        .tooltip {
          background-color: #000 !important;
          color: #fff !important;
          padding: 5px 10px !important;
          border-radius: 4px !important;
          font-size: 12px !important;
          z-index: 9999 !important;
        }
        
        /* Enhanced dropdown arrow positioning */
        .drc-note-grade-dropdown::after {
          right: 50% !important;
          transform: translateX(10px) translateY(-10px) !important;
          bottom: 10px !important;
          top: auto !important;
        }
        
        /* Hide default dropdown arrow */
        .drc-note-grade-dropdown select::-ms-expand {
          display: none !important;
        }
        
        .drc-note-grade-dropdown select {
          -webkit-appearance: none !important;
          -moz-appearance: none !important;
          appearance: none !important;
        }
        
        /* Modify the grade colors - A is green, B is orange, C is red */
        .drc-note-grade-value.grade-a {
          background-color: rgba(102, 187, 106, 0.3) !important;
          color: #2e7d32 !important; /* Darker green for better visibility */
        }
        
        .drc-note-grade-value.grade-b {
          background-color: rgba(255, 152, 0, 0.3) !important;
          color: #ef6c00 !important; /* Darker orange for better visibility */
        }
        
        .drc-note-grade-value.grade-c {
          background-color: rgba(229, 57, 53, 0.3) !important;
          color: #c62828 !important; /* Darker red for better visibility */
        }
      `,document.head.appendChild(O)}let P=document.getElementById("grade-tooltip-script");P&&P.remove();let I=document.getElementById("grade-tooltip");return I&&I.remove(),()=>{let O=document.getElementById("drc-critical-navigation-styles");O&&O.remove()}},[g]),(0,kr.useEffect)(()=>{let N=()=>{var D,A,P;try{let I=i||((A=(D=window.app)==null?void 0:D.plugins)==null?void 0:A.plugins.journalit);if(!((P=I==null?void 0:I.settings)!=null&&P.drc))return}catch(I){console.error("Error handling settings update:",I)}};return document.addEventListener("journalit-settings-updated",N),()=>document.removeEventListener("journalit-settings-updated",N)},[]);let T=[{id:"prepare",label:"Preparation",content:({data:N,updateData:D})=>kr.default.createElement(xz,{frontmatter:N,updateFrontmatter:D,previousDayGoals:s,trades:t,openNote:n||(A=>{}),plugin:i})},{id:"trades",label:"Trades",count:t.length,content:({data:N,updateData:D})=>kr.default.createElement(C8,{frontmatter:N,trades:t,updateFrontmatter:D,openNote:n||(A=>{}),plugin:i})},{id:"review",label:"Review",content:({data:N,updateData:D})=>kr.default.createElement(D8,{frontmatter:N,trades:t,updateFrontmatter:D,openNote:n||(A=>{}),plugin:i,instrumentOptions:c,setupOptions:u,onSaveInstrument:S,onSaveSetup:x})}],E=w.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"});return kr.default.createElement("div",{className:"drc-container",ref:m,"data-file-path":g,style:{margin:0}},kr.default.createElement(Rw,{data:b,filePath:g,openNote:n,plugin:i,serviceName:"drcService",componentName:"Daily Report Card",navigationOptions:{currentDate:w,getAdjacentReview:async N=>{try{if(v)return await v.getAdjacentDRC(w,N)}catch(D){a(D,"Error getting adjacent DRC")}return null},getRelatedReviewPaths:{weekly:N=>{var D,A;try{let P=i||((A=(D=window.app)==null?void 0:D.plugins)==null?void 0:A.plugins.journalit);if(P!=null&&P.weeklyReviewService)return P.weeklyReviewService.getWeeklyReviewPath(N);if(P!=null&&P.drcService)return P.drcService.getWeeklyReviewPath(N)}catch(P){a(P,"Error getting weekly review path")}return""},monthly:N=>{var D,A;try{let P=i||((A=(D=window.app)==null?void 0:D.plugins)==null?void 0:A.plugins.journalit);if(P!=null&&P.monthlyReviewService)return P.monthlyReviewService.getMonthlyReviewPath(N);if(P!=null&&P.drcService)return P.drcService.getMonthlyReviewPath(N)}catch(P){a(P,"Error getting monthly review path")}return""}}},tabConfig:T,updateMethodName:"updateDRCFrontmatter",className:{container:"drc-content",header:{container:"drc-header",title:"drc-title",dateContainer:"drc-date-container"},tabContainer:{container:"drc-tabs-container",tabList:"drc-tabs",tab:"drc-tab",activeTab:"active"}}}))};var Qk=class extends Qi{constructor(t){super(t)}async renderComponent(t,r,n,i,o){if(!t||!t.isConnected){console.error(`[DRCNote] Cannot render into disconnected container for ${n}`);return}t.querySelector(".drc-container")||await this.renderDRCNote(t,r,n,i,o)}async renderDRCNote(t,r,n,i,o){var a,s;try{if(!t||!t.isConnected)return;let l=o?`${n}-${i}-${o}`:`${n}-${i}`,c=this.reactRoots.get(l);if(c&&c.domContainer&&c.domContainer.isConnected&&c.domContainer.querySelector(".drc-container")||t.querySelector(".drc-container"))return;this.injectDropdownStyles(t);let u=(s=(a=window.app)==null?void 0:a.plugins)==null?void 0:s.plugins.journalit,p=this.findContainingLeaf(t),m;if(p&&p.view){let h=p.view.containerEl,v=p.containerEl;h&&h.id?m=h.id:v&&v.id&&(m=v.id)}let g=await this.fetchTradesForDRC(r);t.setAttribute("data-displaying-file",n),t.setAttribute("data-rendered-at",Date.now().toString()),t.setAttribute("data-renderer-id",`${n}-${i}-${Date.now()}`),t.setAttribute("data-debug-version","1.0.0");let f={...r};["plugin","app","_"].forEach(h=>{h in f&&delete f[h]});let y={...f,trades:g};this.createReactRoot(t,l,m,o,y,n)}catch(l){console.error("[DRCNote] Error rendering DRC note:",l),t.setText("Error rendering DRC note: "+(l instanceof Error?l.message:String(l)))}}getComponentClassName(){return"journalit-drc-view"}getWrapperClassName(){return"journalit-drc-note-wrapper"}createReactElement(t,r,n){var o,a;let i=(a=(o=window.app)==null?void 0:o.plugins)==null?void 0:a.plugins.journalit;return A8.default.createElement(P8,{data:t,trades:t.trades||[],filePath:r,openNote:n,plugin:i})}injectDropdownStyles(t){let r=`drc-container-${Date.now()}-${Math.floor(Math.random()*1e3)}`;if(t.id=r,!document.getElementById("drc-critical-dropdown-styles")){let n=document.createElement("style");n.id="drc-critical-dropdown-styles",n.textContent=`
                /* Critical ComboBox styling for DRC dropdowns - with highest specificity */
                .drc-container .combobox-container,
                .drc-container [data-combobox-type],
                .drc-missed-trade .combobox-container,
                .drc-missed-trade .drc-input-group.field .combobox-container,
                #${r} .combobox-container,
                #${r} [data-combobox-type] {
                    position: relative !important;
                    width: 100% !important;
                    margin-bottom: 8px !important;
                    z-index: 10 !important;
                }
                
                /* Increased z-index when dropdown is open */
                .drc-container .combobox-container[data-is-open="true"],
                .drc-container [data-combobox-type][data-is-open="true"],
                .drc-missed-trade .combobox-container[data-is-open="true"],
                .drc-missed-trade .drc-input-group.field .combobox-container[data-is-open="true"],
                #${r} .combobox-container[data-is-open="true"],
                #${r} [data-combobox-type][data-is-open="true"] {
                    z-index: 9999 !important;
                }
                
                /* Force dropdown list to be visible at all times */
                .drc-container .combobox-container[data-is-open="true"] ul[role="listbox"],
                .drc-container [data-combobox-type][data-is-open="true"] ul[role="listbox"],
                .drc-missed-trade .combobox-container[data-is-open="true"] ul[role="listbox"],
                .drc-missed-trade .drc-input-group.field .combobox-container[data-is-open="true"] ul[role="listbox"],
                #${r} .combobox-container[data-is-open="true"] ul[role="listbox"],
                #${r} [data-combobox-type][data-is-open="true"] ul[role="listbox"] {
                    display: block !important;
                    visibility: visible !important;
                    opacity: 1 !important;
                    position: absolute !important;
                    top: 34px !important; /* Position closer to input */
                    left: 0 !important;
                    right: 0 !important;
                    max-height: 200px !important;
                    overflow-y: auto !important;
                    background-color: var(--background-primary) !important;
                    border: 1px solid var(--background-modifier-border) !important;
                    border-top: none !important; /* Remove top border for seamless connection */
                    border-radius: 0 0 4px 4px !important; /* Only round bottom corners */
                    margin-top: -1px !important; /* Negative margin to pull up and overlap with input border */
                    z-index: 9999 !important;
                    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
                }
                
                /* Style dropdown list items */
                .drc-container [data-combobox-type] ul[role="listbox"] li,
                .drc-missed-trade .combobox-container ul[role="listbox"] li,
                #${r} [data-combobox-type] ul[role="listbox"] li,
                #${r} .combobox-container ul[role="listbox"] li {
                    padding: 8px 12px !important;
                    cursor: pointer !important;
                    transition: background-color 150ms ease !important;
                    margin: 0 !important;
                    background-color: var(--background-primary) !important;
                    color: var(--text-normal) !important;
                    font-size: 14px !important;
                    line-height: 1.5 !important;
                    border-bottom: 1px solid var(--background-modifier-border-subtle, rgba(127, 127, 127, 0.1)) !important;
                }
                
                /* Hover state for dropdown items */
                .drc-container [data-combobox-type] ul[role="listbox"] li:hover,
                .drc-missed-trade .combobox-container ul[role="listbox"] li:hover,
                #${r} [data-combobox-type] ul[role="listbox"] li:hover,
                #${r} .combobox-container ul[role="listbox"] li:hover {
                    background-color: var(--background-secondary) !important;
                }
                
                /* Dropdown arrow styling */
                .drc-container [data-combobox-type] .input-container::after,
                .drc-missed-trade .combobox-container .input-container::after,
                #${r} [data-combobox-type] .input-container::after,
                #${r} .combobox-container .input-container::after {
                    content: "" !important;
                    position: absolute !important;
                    right: 12px !important;
                    top: 50% !important;
                    transform: translateY(-50%) !important;
                    width: 0 !important;
                    height: 0 !important;
                    border-left: 5px solid transparent !important;
                    border-right: 5px solid transparent !important;
                    border-top: 5px solid var(--text-normal) !important;
                    pointer-events: none !important;
                    z-index: 10 !important;
                }
                
                /* Input padding for dropdown arrow */
                .drc-container [data-combobox-type] input[role="combobox"],
                .drc-missed-trade .combobox-container input[role="combobox"],
                #${r} [data-combobox-type] input[role="combobox"],
                #${r} .combobox-container input[role="combobox"] {
                    padding-right: 30px !important;
                }
            `,document.head.appendChild(n)}return r}async fetchTradesForDRC(t){var r,n,i;try{if(!t.date)return[];let o=(n=(r=window.app)==null?void 0:r.plugins)==null?void 0:n.plugins.journalit;if(!o||!o.drcService)return console.error("[DRCNote] Cannot access plugin or DRC service"),[];let a=new Date(t.date),s=await o.drcService.getTradesForDate(a),l=[];for(let c of s)try{let d=(i=this.app.metadataCache.getFileCache(c))==null?void 0:i.frontmatter;if(!d||d.type!=="trade")continue;let u={id:c.path,instrument:d.instrument||"Unknown",direction:d.direction||"Unknown",entryPrice:parseFloat(d.entryPrice)||0,exitPrice:parseFloat(d.exitPrice)||0,positionSize:parseFloat(d.positionSize)||0,pnl:parseFloat(d.pnl)||void 0,entryTime:d.entryTime?new Date(d.entryTime):new Date,exitTime:d.exitTime?new Date(d.exitTime):void 0,path:c.path,setup:d.setup,images:d.images};l.push(u)}catch(d){console.error(`[DRCNote] Error processing trade file ${c.path}:`,d)}return l}catch(o){return console.error("[DRCNote] Error fetching trades:",o),[]}}unmountDRCNote(t,r,n,i){return this.unmountComponent(t,r,n,i)}unmountAllDRCNotes(){this.unmountAllComponents()}unmountLeafDRCNotes(t){this.unmountLeafComponents(t)}};var Zk=class extends Zi{constructor(t,r){super(t,r,new Qk(t))}isValidComponentType(t){return t&&t.type==="drc"}getComponentClassName(){return"journalit-drc-view"}getWrapperClassName(){return"journalit-drc-note-wrapper"}getComponentTypeIdentifier(){return"drc"}async getAdditionalDataForComponent(t,r){return{}}async handleFileOpen(t,r=!1){if(!t)return;this.cleanupOrphanedComponents(),this.cleanupUnrelatedComponents(t.path);let n=this.app.metadataCache.getFileCache(t),i=n==null?void 0:n.frontmatter;if(!i||!this.isValidComponentType(i))return;if(this.hasProperlyRenderedComponents(t.path,this.getComponentClassName(),".drc-container","drc-note-mounted")){this.markFileRenderedInMode(t.path,"source");return}if(this.cleanupDuplicateComponents(t.path),r){let s=`rendered-drc-${t.path}-${Date.now()}`;if(window[s]=!1,Date.now()-window.__obsidianStartTime<5e3){setTimeout(()=>{this.tryRenderActiveDRC(t,s)},500),setTimeout(()=>{window[s]||this.tryRenderActiveDRC(t,s)},1500),setTimeout(()=>{window[s]||this.tryRenderActiveDRC(t,s),delete window[s]},3e3),setTimeout(()=>{this.renderActiveComponent()},5e3);return}setTimeout(()=>{window[s]||this.tryRenderActiveDRC(t,s),delete window[s]},500);return}let o=document.body,a=new MutationObserver((s,l)=>{let c=document.querySelectorAll(".cm-editor");if(c.length===0)return;if(this.isFileRenderedInMode(t.path,"source")){if(document.querySelectorAll(`.${this.getComponentClassName()}[data-file-path="${t.path}"]`).length>0)return;this.clearFileRenderedStatus(t.path,"source")}c.forEach(u=>{var N;let p=u.querySelector(".metadata-container");if(!p)return;let m=p.closest(".workspace-leaf-content");if(!m)return;let g=this.findContainingLeaf(m),f=(N=g==null?void 0:g.view)==null?void 0:N.containerEl,y=p.closest(".workspace-leaf"),v=(y==null?void 0:y.id)||(f==null?void 0:f.id)||null,b=this.getUniqueElementId(u),w=v?`leaf-${v}`:b,k=!0;if(g){let D=g.view,A=null;(D&&"file"in D||D&&"getViewType"in D&&D.getViewType()==="markdown")&&(A=D.file),A&&(k=A.path===t.path)}if(!k)return;let S=this.getComponentClassName();u.querySelectorAll(`.${S}`).forEach(D=>{let A=D.getAttribute("data-file-path");if(A){let P=D.getAttribute("data-view-id"),I=D.getAttribute("data-leaf-id");P&&this.renderer.unmountComponent(A,P,I||void 0),D.remove()}});let x=this.getWrapperClassName(),T=u.querySelectorAll(`.${x}`),E=Array.from(T).some(D=>{var A;return(A=D.querySelector(".drc-container"))==null?void 0:A.classList.contains("drc-note-mounted")});if(T.length>0||E)return;let C=Array.from(u.querySelectorAll(`.${S}`)).find(D=>D.getAttribute("data-file-path")===t.path);C||(C=document.createElement("div"),C.className=S,C.style.marginTop="0px",C.style.marginBottom="0px",C.style.padding="0px",C.setAttribute("data-file-path",t.path),C.setAttribute("data-view-id",w),C.setAttribute("data-editor-id",b),v&&C.setAttribute("data-leaf-id",v),C.setAttribute("data-inserted-at",Date.now().toString()),C.setAttribute("data-created-at",Date.now().toString()),p.after(C)),this.renderDRCNoteWithDeduplication(t,C,i,w,b)}),l.disconnect();let d=this.activeObservers.indexOf(l);d>-1&&this.activeObservers.splice(d,1)});this.activeObservers.push(a),a.observe(o,{childList:!0,subtree:!0}),setTimeout(()=>{a.disconnect();let s=this.activeObservers.indexOf(a);s>-1&&this.activeObservers.splice(s,1)},5e3)}renderActiveComponent(){this.renderActiveDRCNote()}async tryRenderActiveDRC(t,r){try{let n=this.app.metadataCache.getFileCache(t),i=n==null?void 0:n.frontmatter;if(!i||!this.isValidComponentType(i))return;if(this.hasProperlyRenderedComponents(t.path,this.getComponentClassName(),".drc-container","drc-note-mounted")){window[r]=!0;return}this.cleanupDuplicateComponents(t.path),this.renderActiveComponent(),window[r]=!0}catch(n){console.error("[DRC] Error in tryRenderActiveDRC:",n)}}renderDRCNoteWithDeduplication(t,r,n,i,o){this.cleanupDuplicateComponents(t.path);let a=this.renderWithDeduplication({file:t,container:r,data:n,viewId:i,contextId:o,componentClassName:this.getComponentClassName(),mountedClassName:"drc-note-mounted",contentSelector:".drc-container"})}cleanup(){super.cleanup()}renderActiveDRCNote(){this.cleanupOrphanedComponents();let t=this.app.workspace.getActiveFile();if(!t)return;let r=this.app.metadataCache.getFileCache(t),n=r==null?void 0:r.frontmatter;if(!n||n.type!=="drc")return;let i=this.app.workspace.getActiveViewOfType(N8.MarkdownView);if(!i)return;let o=i.getMode,a=typeof o=="function"?o.call(i)==="source":!1,s=null;if(a){let l=i.containerEl.querySelector(".metadata-container");if(!l)return;let c=Array.from(i.containerEl.querySelectorAll(`.${this.getComponentClassName()}`)).find(d=>d.getAttribute("data-file-path")===t.path);c?s=c:(s=document.createElement("div"),s.className=this.getComponentClassName(),s.style.marginTop="0px",s.style.marginBottom="0px",s.style.padding="0px",s.setAttribute("data-file-path",t.path),l.after(s))}else{let l=i.containerEl.querySelector(".markdown-preview-view");if(!l)return;let c=Array.from(l.querySelectorAll(`.${this.getComponentClassName()}`)).find(d=>d.getAttribute("data-file-path")===t.path);c?s=c:(s=document.createElement("div"),s.className=this.getComponentClassName(),s.style.marginTop="0px",s.style.marginBottom="0px",s.style.padding="0px",s.setAttribute("data-file-path",t.path),l.prepend(s))}if(s){let l=`drc-active-${Date.now()}`;s.setAttribute("data-view-id",l),this.renderDRCNoteWithDeduplication(t,s,n,l)}}};var mf=require("obsidian");var H8=$(W());var xn=$(W());var Be=$(W());var M8=({data:e,updateData:t,previousWeekGoals:r})=>{let n=Ge(),[i,o]=(0,Be.useState)(""),[a,s]=(0,Be.useState)(""),[l,c]=(0,Be.useState)("gray"),[d,u]=(0,Be.useState)(""),p=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],[m,g]=(0,Be.useState)([]);Be.default.useEffect(()=>{try{if(n!=null&&n.optionsService){let P=n.optionsService.getOptions("event")||[];g(P)}}catch(P){console.error("Failed to load event options:",P)}},[n]),Be.default.useEffect(()=>{if(i&&(n!=null&&n.optionsService)){let P=n.optionsService.getEventOptionByName(i);P&&P.color?c(P.color):c("gray")}else c("gray")},[i,n]);let f=async P=>{try{if(n!=null&&n.optionsService){await n.optionsService.addOrUpdateEventOption(P,l);let I=n.optionsService.getOptions("event")||[];g(I)}}catch(I){console.error("Failed to save event option:",I)}},y=P=>{let M={...e.previousGoalStatus||{}},O=`goal_${P}`;M[O]=!M[O],t({...e,previousGoalStatus:M})},h=()=>{if(!i)return;n!=null&&n.optionsService&&n.optionsService.addOrUpdateEventOption(i,l);let P=[...e.keyEvents||[]];P.push({event:i,notes:a,color:l,day:d||void 0}),t({keyEvents:P}),o(""),s(""),c("gray"),u("")},v=P=>{let I=[...e.keyEvents||[]];I.splice(P,1),t({keyEvents:I})},b=()=>{var P,I;try{return((I=(P=n==null?void 0:n.settings)==null?void 0:P.weekly)==null?void 0:I.customTimeframes)||["Monthly","Weekly","Daily"]}catch(M){return console.error("Error getting timeframes:",M),["Monthly","Weekly","Daily"]}};(0,Be.useEffect)(()=>{let P=I=>{var M;((M=I.detail)==null?void 0:M.component)==="weekly"&&(S.current=k())};return document.addEventListener("journalit-settings-updated",P),()=>{document.removeEventListener("journalit-settings-updated",P)}},[]);let w=(P,I,M,O=!1)=>{var B,j,_,H,q,X;let F={...e.forecast||{monthly:{notes:""},weekly:{notes:""},daily:{notes:""},customTimeframes:{}}},L={monthly:{notes:((B=F.monthly)==null?void 0:B.notes)||"",imagePath:(j=F.monthly)==null?void 0:j.imagePath},weekly:{notes:((_=F.weekly)==null?void 0:_.notes)||"",imagePath:(H=F.weekly)==null?void 0:H.imagePath},daily:{notes:((q=F.daily)==null?void 0:q.notes)||"",imagePath:(X=F.daily)==null?void 0:X.imagePath},customTimeframes:{...F.customTimeframes||{}}};I==="notes"&&(O?(L.customTimeframes||(L.customTimeframes={}),L.customTimeframes[P]={...L.customTimeframes[P],notes:M}):P in L&&(L[P].notes=M)),t({forecast:L})},k=()=>{let P=b(),I=["monthly","weekly","daily"];return P.forEach(M=>{if(!["Monthly","Weekly","Daily"].includes(M)){let O=M.replace(/\s+/g,"_").toLowerCase();I.push(O)}}),I},S=(0,Be.useRef)(k()),x=async(P,I,M=!1)=>{var O,F;try{let L=n||((F=(O=window.app)==null?void 0:O.plugins)==null?void 0:F.plugins.journalit);if(!(L!=null&&L.weeklyReviewService))throw new Error("Weekly Review Service not available");let B=new Date(e.date);return await L.weeklyReviewService.saveWeeklyReviewImage(P,B,I)}catch(L){throw console.error(`Error uploading image for ${I}:`,L),L}},T=(P,I,M=!1)=>{var L,B,j,_,H,q;let O={...e.forecast||{monthly:{notes:""},weekly:{notes:""},daily:{notes:""},customTimeframes:{}}},F={monthly:{notes:((L=O.monthly)==null?void 0:L.notes)||"",imagePath:(B=O.monthly)==null?void 0:B.imagePath},weekly:{notes:((j=O.weekly)==null?void 0:j.notes)||"",imagePath:(_=O.weekly)==null?void 0:_.imagePath},daily:{notes:((H=O.daily)==null?void 0:H.notes)||"",imagePath:(q=O.daily)==null?void 0:q.imagePath},customTimeframes:{...O.customTimeframes||{}}};M?(F.customTimeframes||(F.customTimeframes={}),F.customTimeframes[P]={...F.customTimeframes[P],imagePath:I}):P in F&&(F[P].imagePath=I),t({forecast:F})},E=async(P,I=!1)=>{var M,O,F,L,B,j,_;try{let H;if(I?H=(F=(O=(M=e.forecast)==null?void 0:M.customTimeframes)==null?void 0:O[P])==null?void 0:F.imagePath:H=(B=(L=e.forecast)==null?void 0:L[P])==null?void 0:B.imagePath,!H)return;let q=n||((_=(j=window.app)==null?void 0:j.plugins)==null?void 0:_.plugins.journalit);if(!(q!=null&&q.weeklyReviewService))throw new Error("Weekly Review Service not available");await q.weeklyReviewService.deleteImage(H),T(P,void 0,I)}catch(H){console.error("Error deleting image:",H)}},C=P=>{var M;return((M=e.previousGoalStatus)==null?void 0:M[`goal_${P}`])||!1},N=(P,I=!1)=>({getSectionData:()=>{var O;let M=e.forecast||{monthly:{notes:""},weekly:{notes:""},daily:{notes:""},customTimeframes:{}};if(I)return((O=M.customTimeframes)==null?void 0:O[P])||{notes:""};{let F=M[P];return typeof F=="object"&&F!==null?F:{notes:""}}},handleImageUpload:async M=>{try{let O=await x(M,P,I);return T(P,O,I),O}catch(O){throw console.error(`Error saving image for ${P} section:`,O),O}},handleNotesChange:M=>{w(P,"notes",M,I)},handleImageDelete:()=>{E(P,I)}}),D=(P,I,M=!1)=>{let O=N(P,M),F=O.getSectionData();return Be.default.createElement(zw,{key:P,sectionName:P,sectionTitle:I,notes:F.notes||"",imagePath:F.imagePath,onNotesChange:O.handleNotesChange,onImageUploaded:()=>{},onImageDeleted:O.handleImageDelete,saveImageFunction:O.handleImageUpload,isCustom:M,className:{container:"weekly-review-forecast-section",sectionTitle:"weekly-review-forecast-title",notesContainer:"weekly-review-forecast-notes",imageContainer:"weekly-review-image-container"}})},A=()=>{let P=b(),I={Monthly:"monthly",Weekly:"weekly",Daily:"daily"};return Be.default.createElement("div",{className:"weekly-review-forecast-sections"},P.map(M=>{let O=M.replace(/\s+/g,"_").toLowerCase(),F=Object.keys(I).includes(M),L=F?I[M]:O;return D(L,M,!F)}))};return Be.default.createElement("div",{className:"weekly-review-preparation"},Be.default.createElement("div",{className:"weekly-review-section"},Be.default.createElement(_w,{goals:r,goalStatus:e.previousGoalStatus||{},onToggleGoal:y,title:"Previous Week Goals",emptyMessage:"No goals from previous week",emptyActionLabel:"",className:{container:"weekly-review-previous-goals",goalItem:"weekly-review-checklist-item",goalCheckbox:"weekly-review-checkbox",goalText:"weekly-review-goal-text",completed:"completed"}})),Be.default.createElement("div",{className:"weekly-review-section"},Be.default.createElement("h3",{className:"weekly-review-section-title"},"Key Events"),Be.default.createElement("div",{className:"weekly-review-key-events"},Be.default.createElement("div",{className:"weekly-review-event-selector"},Be.default.createElement(Os,{label:"Event",options:m,value:i,onChange:P=>o(P),placeholder:"Select or create event",allowCreate:!0,isMulti:!1,optionType:"event",onSaveOption:f,error:"",helperText:"",required:!1}),Be.default.createElement("div",{className:"weekly-review-event-color-selector",style:{display:"flex",gap:"10px",alignItems:"center",marginTop:"8px",marginBottom:"8px"}},Be.default.createElement("span",{style:{marginRight:"5px",fontSize:"12px",color:"var(--text-muted)"}},"Colour:"),["gray","red","orange","yellow"].map(P=>Be.default.createElement("div",{key:P,style:{display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",padding:"4px",width:"24px",height:"24px",borderRadius:"4px",backgroundColor:l===P?"var(--background-modifier-hover)":"transparent"},onClick:()=>c(P)},Be.default.createElement("span",{style:{display:"inline-block",width:"16px",height:"16px",borderRadius:"50%",backgroundColor:`var(--event-color-${P}, ${P==="gray"?"#888":P})`,border:"1px solid var(--background-modifier-border)",margin:"0"},title:P.charAt(0).toUpperCase()+P.slice(1)}),Be.default.createElement("input",{type:"radio",name:"event-color",value:P,checked:l===P,onChange:()=>{},style:{display:"none"}})))),Be.default.createElement("div",{className:"weekly-review-event-day-selector",style:{display:"flex",gap:"10px",alignItems:"center",marginTop:"8px",marginBottom:"8px"}},Be.default.createElement("span",{style:{marginRight:"5px",fontSize:"12px",color:"var(--text-muted)"}},"Day:"),Be.default.createElement("select",{value:d,onChange:P=>u(P.target.value),style:{padding:"4px 8px",borderRadius:"4px",border:"1px solid var(--background-modifier-border)",backgroundColor:"var(--background-primary)",color:"var(--text-normal)",fontSize:"14px",width:"150px"}},Be.default.createElement("option",{value:""},"None (optional)"),p.map(P=>Be.default.createElement("option",{key:P,value:P},P)))),Be.default.createElement("textarea",{value:a,onChange:P=>s(P.target.value),placeholder:"Notes about this event",className:"weekly-review-textarea"}),Be.default.createElement("button",{className:"weekly-review-add-button",onClick:h,disabled:!i},"Add Event")),e.keyEvents&&e.keyEvents.length>0?Be.default.createElement("div",{className:"weekly-review-events-list"},e.keyEvents.map((P,I)=>{let M=P.color?`event-color-${P.color}`:"event-color-gray";return Be.default.createElement("div",{key:`event-${I}`,className:`weekly-review-event-item ${M}`},Be.default.createElement("div",{className:"weekly-review-event-header"},Be.default.createElement("div",{style:{display:"flex",alignItems:"center",gap:"8px"}},Be.default.createElement("h4",null,P.event),P.day&&Be.default.createElement("span",{className:"weekly-review-event-day",style:{fontSize:"12px",padding:"2px 8px",backgroundColor:"var(--background-modifier-border)",borderRadius:"4px",color:"var(--text-normal)",fontWeight:"500"}},P.day)),Be.default.createElement("button",{className:"weekly-review-remove-button",onClick:()=>v(I)},"Remove")),Be.default.createElement("p",null,P.notes))})):Be.default.createElement(Ae,{message:"No key events added",subMessage:"Add important market events that might impact your trading",iconSize:38,actionButtonText:"Add Your First Event",onActionButtonClick:()=>{let P=document.querySelector(".weekly-review-event-selector input");P instanceof HTMLElement&&P.focus()}}))),Be.default.createElement("div",{className:"weekly-review-section"},Be.default.createElement("h3",{className:"weekly-review-section-title"},"Weekly Forecast"),A(),Be.default.createElement("style",null,`
          .weekly-review-forecast-section {
            width: 100%;
          }
          .weekly-review-forecast-notes {
            width: 100%;
          }
          .weekly-review-forecast-notes textarea {
            width: 100% !important;
            box-sizing: border-box !important;
            min-height: 80px;
          }
        `)))};var ee=$(W());var JM=class{constructor(t=50){this.maxSize=t,this.cache=new Map}get(t){if(this.cache.has(t)){let r=this.cache.get(t);return this.cache.delete(t),this.cache.set(t,r),r}}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){let n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(t,r)}has(t){return this.cache.has(t)}clear(){this.cache.clear()}size(){return this.cache.size}},O8=new JM(50),Mde=e=>e.tradeStatus==="CLOSED"?!1:e.tradeStatus==="OPEN"||e._originalPnlWasNull&&!e.tradeStatus?!0:at({tradeStatus:e.tradeStatus,exitTime:e.exitTime,pnl:e._originalPnlWasNull?null:e.pnl,useDirectPnLInput:e.useDirectPnLInput,exits:e.exits}),Ode=async(e,t,r)=>{try{let n=r.dateRange[0]||new Date(0),i=r.dateRange[1]||new Date,o=await t.getTrades(n,i);return(await Promise.all(o.map(async s=>{var l;try{let c=((l=e.metadataCache.getFileCache(s))==null?void 0:l.frontmatter)||{},d=c.pnl===void 0||c.pnl===null;return{path:s.path,entryTime:new Date(c.entryTime),exitTime:c.exitTime?new Date(c.exitTime):new Date(c.entryTime),entryPrice:Number(c.entryPrice),exitPrice:c.exitPrice!==void 0&&c.exitPrice!==null?Number(c.exitPrice):Number(c.entryPrice),positionSize:Number(c.positionSize),direction:c.direction,pnl:c.pnl!==void 0&&c.pnl!==null?Number(c.pnl):0,tradeStatus:c.tradeStatus,useDirectPnLInput:c.useDirectPnLInput,exits:c.exits,_originalPnlWasNull:d,instrument:c.instrument,setup:Array.isArray(c.setup)?c.setup:c.setup?[c.setup]:[],mistake:Array.isArray(c.mistake)?c.mistake:c.mistake?[c.mistake]:[],account:Array.isArray(c.account)?c.account:c.account?[c.account]:[],ctags:Array.isArray(c.ctags)?c.ctags:c.ctags?[c.ctags]:[],tags:Array.isArray(c.tags)?c.tags:c.tags?[c.tags]:[]}}catch(c){return console.error(`Error processing trade file ${s.path}:`,c),null}}))).filter(s=>{if(s===null)return!1;let l=r.accounts.length===0||s.account&&Array.isArray(s.account)&&s.account.some(d=>r.accounts.includes(d)),c=r.tickers.length===0||!!(s.instrument&&r.tickers.includes(s.instrument));return!!(l&&c)})}catch(n){return console.error("Error fetching trade data:",n),[]}},pf=e=>{var b,w;if(!e.length)return{netPnL:0,winRate:0,profitFactor:0,expectancy:0,numTrades:0,numWinTrades:0,numLossTrades:0,avgWin:0,avgLoss:0};let t=e.filter(k=>!Mde(k)),r=t.length,n=t.reduce((k,S)=>k+(S.pnl||0),0),i=((b=t[0])==null?void 0:b.path)||"",o=((w=t[t.length-1])==null?void 0:w.path)||"",a=`${r}:${n.toFixed(2)}:${i}:${o}`,s=O8.get(a);if(s!==void 0)return s;let l=t.filter(k=>(k.pnl||0)>0),c=t.filter(k=>(k.pnl||0)<0),d=l.reduce((k,S)=>k+(S.pnl||0),0),u=Math.abs(c.reduce((k,S)=>k+(S.pnl||0),0)),p=d-u,m=t.length>0?l.length/t.length:0,g=u===0?d:d/u,f=l.length>0?d/l.length:0,y=c.length>0?u/c.length:0,h=m*f-(1-m)*y,v={netPnL:p,winRate:m,profitFactor:g,expectancy:h,numTrades:t.length,numWinTrades:l.length,numLossTrades:c.length,avgWin:f,avgLoss:y};return O8.set(a,v),v},I8=async(e,t,r)=>{try{let n=await Ode(e,t,r),i=pf(n);return{trades:n,metrics:i}}catch(n){return console.error("Error fetching dashboard data:",n),{trades:[],metrics:pf([])}}};Yt();var F8=$(W());var Ide=Ks(Ys,"pnl"),j8=({trades:e,height:t=300,dateFormat:r})=>F8.default.createElement(Ide,{trades:e,dateFormat:r,height:t});var L8=$(W());var Fde=Ks(zl,"drawdown"),_8=({trades:e,height:t=300,dateFormat:r})=>L8.default.createElement(Fde,{trades:e,dateFormat:r,height:t});var z8=$(W());var $8=({data:e,height:t=300})=>z8.default.createElement(Wv,{data:e,height:t});var R8=$(W());var jde=Ks(Rv,"trades"),W8=({trades:e,height:t=300,dateFormat:r})=>R8.default.createElement(jde,{trades:e,dateFormat:r,height:t,onPointClick:(n,i)=>{n!=null&&n.path}});var B8=({data:e,trades:t,updateData:r,openNote:n,dateFormat:i="DDMMYY"})=>{let o=(0,ee.useMemo)(()=>i||fr(),[i]),a=(0,ee.useMemo)(()=>t.filter(g=>!at({tradeStatus:g.tradeStatus,exitTime:g.exitTime,pnl:g._originalPnlWasNull?null:g.pnl,useDirectPnLInput:g.useDirectPnLInput,exits:g.exits})),[t]),s=pf(a),l=()=>{var g;try{let f=window.app;return(g=f==null?void 0:f.plugins)==null?void 0:g.plugins.journalit}catch(f){return console.error("Could not access plugin instance:",f),null}},c=(0,ee.useMemo)(()=>{if(a.length===0)return{returnOnLongs:0,returnOnShorts:0,biggestProfit:0,biggestLoss:0,profitLossRatio:0};let g=a.filter(A=>A.direction==="Long"),f=a.filter(A=>A.direction==="Short"),y=a.filter(A=>A.pnl>0),h=a.filter(A=>A.pnl<0),v=g.reduce((A,P)=>A+P.pnl,0),b=f.reduce((A,P)=>A+P.pnl,0),w=g.reduce((A,P)=>P.entryPrice&&P.positionSize?A+P.entryPrice*P.positionSize:A+Math.abs(P.pnl)*5,0),k=f.reduce((A,P)=>P.entryPrice&&P.positionSize?A+P.entryPrice*P.positionSize:A+Math.abs(P.pnl)*5,0),S=w>0?v/w*100:0,x=k>0?b/k*100:0,T=y.length>0?Math.max(...y.map(A=>A.pnl)):0,E=h.length>0?Math.min(...h.map(A=>A.pnl)):0,C=y.length>0?y.reduce((A,P)=>A+P.pnl,0)/y.length:0,N=h.length>0?Math.abs(h.reduce((A,P)=>A+P.pnl,0)/h.length):0,D=N>0?C/N:0;return{returnOnLongs:S,returnOnShorts:x,biggestProfit:T,biggestLoss:E,profitLossRatio:D}},[a]),d=(0,ee.useMemo)(()=>{if(a.length===0)return[];let g=new Map;a.forEach(y=>{let h=Array.isArray(y.setup)?[...y.setup]:y.setup?[y.setup]:[];h.length===0&&h.push("Other"),h.forEach(v=>{if(!v)return;let b=g.get(v)||{pnl:0,wins:0,losses:0,tradeCount:0};b.pnl+=y.pnl,b.tradeCount++,y.pnl>0?b.wins++:y.pnl<0&&b.losses++,g.set(v,b)})});let f=[];return g.forEach((y,h)=>{let v=y.tradeCount>0?y.wins/y.tradeCount*100:0;f.push({name:h,pnl:y.pnl,winRate:v,tradeCount:y.tradeCount})}),f.sort((y,h)=>h.pnl-y.pnl),f},[a]),u=(0,ee.useMemo)(()=>{if(a.length===0)return null;let g=a.filter(f=>f.pnl>0);return g.length===0?null:g.reduce((f,y)=>y.pnl>f.pnl?y:f,g[0])},[a]),p=(0,ee.useMemo)(()=>{if(a.length===0)return null;let g=a.filter(f=>f.pnl<0);return g.length===0?null:g.reduce((f,y)=>y.pnl<f.pnl?y:f,g[0])},[a]),m=(0,ee.useMemo)(()=>{if(a.length===0)return[];let g=new Map;a.forEach(y=>{var v;let h=Ze(y.entryTime,o);g.has(h)||g.set(h,[]),(v=g.get(h))==null||v.push(y)});let f=[];return g.forEach((y,h)=>{var N;let v=y.filter(D=>D.pnl>0),b=y.filter(D=>D.pnl<0),w=v.reduce((D,A)=>D+A.pnl,0),k=b.reduce((D,A)=>D+Math.abs(A.pnl),0),S=y.length>0?v.length/y.length:0,x=k>0?w/k:w>0?1/0:0,T=y.reduce((D,A)=>D+A.pnl,0),E=((N=y[0])==null?void 0:N.entryTime)||new Date,C;try{let D=l();D!=null&&D.drcService&&(C=D.drcService.getDRCNotePath(E))}catch(D){console.error(`Error getting DRC path for date ${h}:`,D)}f.push({date:h,rawDate:E,tradeCount:y.length,winRate:S,profitFactor:x,pnl:T,drcPath:C})}),f.sort((y,h)=>h.rawDate.getTime()-y.rawDate.getTime()),f},[a,o]);return ee.default.createElement("div",{className:"weekly-review-overview"},ee.default.createElement("div",{className:"weekly-review-section"},ee.default.createElement("h3",{className:"weekly-review-section-title"},"Weekly Cumulative P&L"),a.length>0?ee.default.createElement(j8,{trades:a,height:300,dateFormat:o}):ee.default.createElement(Ae,{message:"No P&L data to display",subMessage:"Your cumulative profit/loss will show here once you've logged closed trades",iconSize:40})),ee.default.createElement("div",{className:"weekly-review-section"},ee.default.createElement("h3",{className:"weekly-review-section-title"},"Weekly Drawdown"),a.length>0?ee.default.createElement(_8,{trades:a,height:250,dateFormat:o}):ee.default.createElement(Ae,{message:"No drawdown data to display",subMessage:"Your drawdown metrics will appear here once you've logged closed trades",iconSize:40})),ee.default.createElement("div",{className:"weekly-review-section"},ee.default.createElement("h3",{className:"weekly-review-section-title"},"Weekly Performance"),ee.default.createElement("div",{className:"weekly-review-metric-cards"},ee.default.createElement("div",{className:"weekly-review-metric-card"},ee.default.createElement("div",{className:"weekly-review-metric-label"},"Net P&L"),ee.default.createElement("div",{className:"weekly-review-metric-value",style:{color:s.netPnL>=0?"var(--color-green)":"var(--color-red)"}},fe(s.netPnL))),ee.default.createElement("div",{className:"weekly-review-metric-card"},ee.default.createElement("div",{className:"weekly-review-metric-label"},"Win Rate"),ee.default.createElement("div",{className:"weekly-review-metric-value"},gd(s.winRate*100))),ee.default.createElement("div",{className:"weekly-review-metric-card"},ee.default.createElement("div",{className:"weekly-review-metric-label"},"Profit Factor"),ee.default.createElement("div",{className:"weekly-review-metric-value"},s.profitFactor.toFixed(2))),ee.default.createElement("div",{className:"weekly-review-metric-card"},ee.default.createElement("div",{className:"weekly-review-metric-label"},"Expectancy"),ee.default.createElement("div",{className:"weekly-review-metric-value"},fe(s.expectancy))),ee.default.createElement("div",{className:"weekly-review-metric-card"},ee.default.createElement("div",{className:"weekly-review-metric-label"},"Total Trades"),ee.default.createElement("div",{className:"weekly-review-metric-value"},s.numTrades)),ee.default.createElement("div",{className:"weekly-review-metric-card"},ee.default.createElement("div",{className:"weekly-review-metric-label"},"Avg. Win"),ee.default.createElement("div",{className:"weekly-review-metric-value",style:{color:"var(--color-green)"}},fe(s.avgWin))),ee.default.createElement("div",{className:"weekly-review-metric-card"},ee.default.createElement("div",{className:"weekly-review-metric-label"},"Avg. Loss"),ee.default.createElement("div",{className:"weekly-review-metric-value",style:{color:"var(--color-red)"}},fe(-s.avgLoss))),ee.default.createElement("div",{className:"weekly-review-metric-card"},ee.default.createElement("div",{className:"weekly-review-metric-label"},"P/L Ratio"),ee.default.createElement("div",{className:"weekly-review-metric-value",style:{color:c.profitLossRatio>=1?"var(--color-green)":"var(--color-red)"}},c.profitLossRatio.toFixed(2))))),d.length>0?ee.default.createElement("div",{className:"weekly-review-section"},ee.default.createElement("h3",{className:"weekly-review-section-title"},"Setup Performance"),ee.default.createElement($8,{data:d,height:250}),ee.default.createElement("div",{className:"weekly-review-setup-table"},ee.default.createElement("table",null,ee.default.createElement("thead",null,ee.default.createElement("tr",null,ee.default.createElement("th",null,"Setup"),ee.default.createElement("th",null,"P&L"),ee.default.createElement("th",null,"Win %"),ee.default.createElement("th",null,"Trades"))),ee.default.createElement("tbody",null,d.slice(0,5).map((g,f)=>ee.default.createElement("tr",{key:`setup-${f}`},ee.default.createElement("td",null,g.name),ee.default.createElement("td",{style:{color:g.pnl>=0?"var(--color-green)":"var(--color-red)"}},fe(g.pnl)),ee.default.createElement("td",null,gd(g.winRate)),ee.default.createElement("td",null,g.tradeCount))))))):t.length>0?ee.default.createElement("div",{className:"weekly-review-section"},ee.default.createElement("h3",{className:"weekly-review-section-title"},"Setup Performance"),ee.default.createElement(Ae,{message:"No setup data available",subMessage:"Add setup tags to your trades to see performance metrics by setup",iconSize:40})):null,ee.default.createElement("div",{className:"weekly-review-section"},ee.default.createElement("h3",{className:"weekly-review-section-title"},"Weekly Trades"),t.length>0?ee.default.createElement(W8,{trades:t,height:300,dateFormat:o}):ee.default.createElement(Ae,{message:"No trades for this week",subMessage:"Track your individual trades to see them visualized here",iconSize:42,actionButtonText:n?"Create Trade":void 0,onActionButtonClick:n?()=>{var f;let g=l();(f=g==null?void 0:g.views)!=null&&f.openTradeForm&&g.views.openTradeForm()}:void 0})),ee.default.createElement("div",{className:"weekly-review-section"},ee.default.createElement("h3",{className:"weekly-review-section-title"},"Best Trade of the Week"),u?ee.default.createElement("div",{className:"weekly-review-best-trade best-trade"},ee.default.createElement("div",{className:"weekly-review-best-trade-header"},ee.default.createElement("div",{className:"weekly-review-best-trade-title"},u.instrument||"Unknown"," (",u.direction,")"),ee.default.createElement("div",{className:"weekly-review-best-trade-pnl",style:{color:"var(--color-green)"}},fe(u.pnl))),ee.default.createElement("div",{className:"weekly-review-best-trade-details"},ee.default.createElement("div",{className:"weekly-review-best-trade-detail"},ee.default.createElement("span",{className:"weekly-review-best-trade-label"},"Date:"),ee.default.createElement("span",{className:"weekly-review-best-trade-value"},Ze(u.entryTime,o))),ee.default.createElement("div",{className:"weekly-review-best-trade-detail"},ee.default.createElement("span",{className:"weekly-review-best-trade-label"},"Setup:"),ee.default.createElement("span",{className:"weekly-review-best-trade-value"},u.setup&&Array.isArray(u.setup)?u.setup.join(", "):u.setup||"N/A")),u.exitTime&&ee.default.createElement("div",{className:"weekly-review-best-trade-detail"},ee.default.createElement("span",{className:"weekly-review-best-trade-label"},"Duration:"),ee.default.createElement("span",{className:"weekly-review-best-trade-value"},(()=>{let g=u.exitTime.getTime()-u.entryTime.getTime(),f=Math.floor(g/(1e3*60*60)),y=Math.floor(g%(1e3*60*60)/(1e3*60));return`${f}h ${y}m`})())),u.ctags&&u.ctags.length>0&&ee.default.createElement("div",{className:"weekly-review-best-trade-detail"},ee.default.createElement("span",{className:"weekly-review-best-trade-label"},"Tags:"),ee.default.createElement("span",{className:"weekly-review-best-trade-value"},u.ctags.join(", "))),u.mistake&&u.mistake.length>0&&ee.default.createElement("div",{className:"weekly-review-best-trade-detail"},ee.default.createElement("span",{className:"weekly-review-best-trade-label"},"Mistakes:"),ee.default.createElement("span",{className:"weekly-review-best-trade-value"},u.mistake.join(", ")))),ee.default.createElement("div",{className:"weekly-review-best-trade-actions"},ee.default.createElement("button",{className:"weekly-review-view-button",onClick:()=>n&&n(u.path,!0),disabled:!n},"View Trade Details"))):ee.default.createElement(Ae,{message:"No winning trades this week",subMessage:"Your best trades will appear here once you've logged some profitable trades",iconSize:40})),ee.default.createElement("div",{className:"weekly-review-section"},ee.default.createElement("h3",{className:"weekly-review-section-title"},"Worst Trade of the Week"),p?ee.default.createElement("div",{className:"weekly-review-best-trade worst-trade"},ee.default.createElement("div",{className:"weekly-review-best-trade-header"},ee.default.createElement("div",{className:"weekly-review-best-trade-title"},p.instrument||"Unknown"," (",p.direction,")"),ee.default.createElement("div",{className:"weekly-review-best-trade-pnl",style:{color:"var(--color-red)"}},fe(p.pnl))),ee.default.createElement("div",{className:"weekly-review-best-trade-details"},ee.default.createElement("div",{className:"weekly-review-best-trade-detail"},ee.default.createElement("span",{className:"weekly-review-best-trade-label"},"Date:"),ee.default.createElement("span",{className:"weekly-review-best-trade-value"},Ze(p.entryTime,o))),ee.default.createElement("div",{className:"weekly-review-best-trade-detail"},ee.default.createElement("span",{className:"weekly-review-best-trade-label"},"Setup:"),ee.default.createElement("span",{className:"weekly-review-best-trade-value"},p.setup&&Array.isArray(p.setup)?p.setup.join(", "):p.setup||"N/A")),p.exitTime&&ee.default.createElement("div",{className:"weekly-review-best-trade-detail"},ee.default.createElement("span",{className:"weekly-review-best-trade-label"},"Duration:"),ee.default.createElement("span",{className:"weekly-review-best-trade-value"},(()=>{let g=p.exitTime.getTime()-p.entryTime.getTime(),f=Math.floor(g/(1e3*60*60)),y=Math.floor(g%(1e3*60*60)/(1e3*60));return`${f}h ${y}m`})())),p.ctags&&p.ctags.length>0&&ee.default.createElement("div",{className:"weekly-review-best-trade-detail"},ee.default.createElement("span",{className:"weekly-review-best-trade-label"},"Tags:"),ee.default.createElement("span",{className:"weekly-review-best-trade-value"},p.ctags.join(", "))),p.mistake&&p.mistake.length>0&&ee.default.createElement("div",{className:"weekly-review-best-trade-detail"},ee.default.createElement("span",{className:"weekly-review-best-trade-label"},"Mistakes:"),ee.default.createElement("span",{className:"weekly-review-best-trade-value"},p.mistake.join(", ")))),ee.default.createElement("div",{className:"weekly-review-best-trade-actions"},ee.default.createElement("button",{className:"weekly-review-view-button",onClick:()=>n&&n(p.path,!0),disabled:!n},"View Trade Details"))):ee.default.createElement(Ae,{message:"No losing trades this week",subMessage:"Your least successful trades will appear here to help you learn and improve",iconSize:40})),ee.default.createElement("div",{className:"weekly-review-section"},ee.default.createElement("h3",{className:"weekly-review-section-title"},"Daily Performance"),m.length>0?ee.default.createElement("div",{className:"weekly-review-trades-table"},ee.default.createElement("table",null,ee.default.createElement("thead",null,ee.default.createElement("tr",null,ee.default.createElement("th",null,"Date"),ee.default.createElement("th",null,"Trades"),ee.default.createElement("th",null,"Win%"),ee.default.createElement("th",null,"Profit Factor"),ee.default.createElement("th",null,"P&L"))),ee.default.createElement("tbody",null,m.map((g,f)=>ee.default.createElement("tr",{key:`day-${f}`,className:"weekly-review-trade-row",onClick:()=>{n&&g.drcPath&&n(g.drcPath,!0)},style:{cursor:n?"pointer":"default"}},ee.default.createElement("td",null,g.date),ee.default.createElement("td",null,g.tradeCount),ee.default.createElement("td",null,gd(g.winRate*100)),ee.default.createElement("td",null,g.profitFactor===1/0?"\u221E":g.profitFactor.toFixed(2)),ee.default.createElement("td",{style:{color:g.pnl>=0?"var(--color-green)":"var(--color-red)"}},fe(g.pnl))))))):ee.default.createElement(Ae,{message:"No trades for this week",subMessage:"Your daily trading performance will appear here once you've logged trades",iconSize:42,actionButtonText:n?"Create Trade":void 0,onActionButtonClick:n?()=>{var f;let g=l();(f=g==null?void 0:g.views)!=null&&f.openTradeForm&&g.views.openTradeForm()}:void 0})))};var Ee=$(W());Yt();var U8=({data:e,drcs:t,updateData:r,openNote:n,dateFormat:i="DDMMYY"})=>{let o=(0,Ee.useMemo)(()=>i||fr(),[i]),[a,s]=(0,Ee.useState)(""),l=(u,p)=>{let m={...e.reviewQuestions||{}};m[u]=p,r({reviewQuestions:m})},c=()=>{if(!a.trim())return;let u=[...e.nextWeekGoals||[]];u.push(a),r({nextWeekGoals:u}),s("")},d=u=>{let p=[...e.nextWeekGoals||[]];p.splice(u,1),r({nextWeekGoals:p})};return Ee.default.createElement("div",{className:"weekly-review-review"},Ee.default.createElement("div",{className:"weekly-review-section"},Ee.default.createElement("h3",{className:"weekly-review-section-title"},"Daily Reviews For This Week"),t.length===0?Ee.default.createElement(Ae,{message:"No daily reviews found for this week",subMessage:"Daily reviews will appear here once you've created them",iconSize:40,actionButtonText:n?"Create Daily Review":void 0,onActionButtonClick:n?()=>{var p,m,g;let u=typeof window!="undefined"?(m=(p=window==null?void 0:window.app)==null?void 0:p.plugins)==null?void 0:m.plugins.journalit:null;(g=u==null?void 0:u.drcService)!=null&&g.createDRCForDate&&u.drcService.createDRCForDate(new Date)}:void 0}):Ee.default.createElement("div",{className:"weekly-review-drc-list",style:{width:"100%",boxSizing:"border-box"}},t.map((u,p)=>Ee.default.createElement("div",{key:`drc-${p}`,className:"weekly-review-drc-card"},Ee.default.createElement("div",{className:"weekly-review-drc-header"},Ee.default.createElement("h4",{className:"weekly-review-drc-date"},new Date(u.data.date).toLocaleDateString(void 0,{weekday:"short"})," - ",Ze(new Date(u.data.date),o)),Ee.default.createElement("div",{className:"weekly-review-drc-grades"},Ee.default.createElement("span",{className:`weekly-review-drc-grade grade-${(u.data.mentalGrade||"").toString().toLowerCase()}`,"data-grade":u.data.mentalGrade},"Mental: ",u.data.mentalGrade||"N/A"),Ee.default.createElement("span",{className:`weekly-review-drc-grade grade-${(u.data.technicalGrade||"").toString().toLowerCase()}`,"data-grade":u.data.technicalGrade},"Technical: ",u.data.technicalGrade||"N/A")),Ee.default.createElement("div",{className:"weekly-review-drc-actions"},Ee.default.createElement("button",{className:"weekly-review-drc-button",onClick:()=>n&&n(u.file.path,!0),disabled:!n},"View DRC"))),Ee.default.createElement("div",{className:"weekly-review-drc-summary"},u.data.reviewQuestions&&Object.entries(u.data.reviewQuestions).slice(0,2).map(([m,g],f)=>Ee.default.createElement("div",{key:`drc-review-${p}-${f}`,className:"weekly-review-drc-section"},Ee.default.createElement("div",{className:"weekly-review-drc-section-label"},m),Ee.default.createElement("div",{className:"weekly-review-drc-section-content"},g||"No answer provided")))))))),Ee.default.createElement("div",{className:"weekly-review-section"},Ee.default.createElement("h3",{className:"weekly-review-section-title"},"Performance Self-Assessment"),Ee.default.createElement("div",{className:"weekly-review-grades"},Ee.default.createElement("div",{className:"weekly-review-grade-row"},Ee.default.createElement("div",{className:"weekly-review-grade-item"},Ee.default.createElement("div",{className:"weekly-review-grade-label"},"Mental Performance"),Ee.default.createElement("div",{className:"weekly-review-grade-stars"},[1,2,3,4,5].map(u=>{let p=e.mentalGrade||0,m="weekly-review-star";return p>=u?m+=" full":p>=u-.5&&(m+=" half"),Ee.default.createElement("span",{key:`mental-${u}`,className:m,onClick:()=>r({mentalGrade:u}),onContextMenu:g=>{g.preventDefault(),r({mentalGrade:u-.5})}},"\u2605")})),Ee.default.createElement("textarea",{className:"weekly-review-textarea",value:e.mentalNotes||"",onChange:u=>r({mentalNotes:u.target.value}),placeholder:"Notes about your mental performance..."})),Ee.default.createElement("div",{className:"weekly-review-grade-item"},Ee.default.createElement("div",{className:"weekly-review-grade-label"},"Technical Execution"),Ee.default.createElement("div",{className:"weekly-review-grade-stars"},[1,2,3,4,5].map(u=>{let p=e.technicalGrade||0,m="weekly-review-star";return p>=u?m+=" full":p>=u-.5&&(m+=" half"),Ee.default.createElement("span",{key:`technical-${u}`,className:m,onClick:()=>r({technicalGrade:u}),onContextMenu:g=>{g.preventDefault(),r({technicalGrade:u-.5})}},"\u2605")})),Ee.default.createElement("textarea",{className:"weekly-review-textarea",value:e.technicalNotes||"",onChange:u=>r({technicalNotes:u.target.value}),placeholder:"Notes about your technical execution..."}))))),Ee.default.createElement("div",{className:"weekly-review-section"},Ee.default.createElement("h3",{className:"weekly-review-section-title"},"Weekly Review Questions"),Ee.default.createElement("div",{className:"weekly-review-questions"},Object.keys(e.reviewQuestions||{}).length>0?Ee.default.createElement("div",{className:"weekly-review-question-list"},Object.entries(e.reviewQuestions||{}).map(([u,p],m)=>Ee.default.createElement("div",{key:`question-${m}`,className:"weekly-review-question"},Ee.default.createElement("div",{className:"weekly-review-question-header"},Ee.default.createElement("h4",{className:"weekly-review-question-text"},u)),Ee.default.createElement("textarea",{value:p||"",onChange:g=>l(u,g.target.value),placeholder:"Your answer here...",className:"weekly-review-textarea",rows:4})))):Ee.default.createElement(Ae,{message:"No review questions configured",subMessage:"Add review questions in the Weekly Review settings tab",iconSize:40}),Ee.default.createElement("p",{className:"weekly-review-info-text"},"Review questions can be configured in the Weekly Review settings tab."))),Ee.default.createElement("div",{className:"weekly-review-section"},Ee.default.createElement("h3",{className:"weekly-review-section-title"},"Goals for Next Week"),Ee.default.createElement("div",{className:"weekly-review-goals"},e.nextWeekGoals&&e.nextWeekGoals.length>0?Ee.default.createElement("div",{className:"weekly-review-goals-list"},e.nextWeekGoals.map((u,p)=>Ee.default.createElement("div",{key:`goal-${p}`,className:"weekly-review-goal-item"},Ee.default.createElement("div",{className:"weekly-review-goal-text"},u),Ee.default.createElement("button",{className:"weekly-review-goal-remove",onClick:()=>d(p)},"Remove")))):Ee.default.createElement(Ae,{message:"No goals set for next week",subMessage:"Define clear goals to focus your trading",iconSize:38,actionButtonText:"Add Your First Goal",onActionButtonClick:()=>{let u=document.querySelector(".weekly-review-input");u instanceof HTMLElement&&u.focus()}}),Ee.default.createElement("div",{className:"weekly-review-add-goal"},Ee.default.createElement("input",{type:"text",value:a,onChange:u=>s(u.target.value),placeholder:"Add a goal for next week",className:"weekly-review-input"}),Ee.default.createElement("button",{className:"weekly-review-add-button",onClick:c,disabled:!a.trim()},"Add Goal")))),Ee.default.createElement("div",{className:"weekly-review-section weekly-review-mark-reviewed-section"},Ee.default.createElement(zs,{reviewed:e.reviewed,reviewedAt:e.reviewedAt,onMarkReviewed:()=>{r({reviewed:!0,reviewedAt:new Date().toISOString()})}})))};var eS=require("obsidian"),V8=({data:e,trades:t=[],drcs:r=[],filePath:n,openNote:i,plugin:o})=>{let a="WeeklyReview",s=vp(a,"general"),[l,c]=(0,xn.useState)(null),d=(0,xn.useRef)(null),[u,p]=(0,xn.useState)(n||"unknown"),m=(0,xn.useRef)(!1),{service:g}=a_(),f=xn.default.useMemo(()=>{var S,x,T;try{let E={...e};return e.forecast&&(E.forecast={monthly:{...e.forecast.monthly},weekly:{...e.forecast.weekly},daily:{...e.forecast.daily}},e.forecast.customTimeframes&&(E.forecast.customTimeframes={...e.forecast.customTimeframes}),(S=e.forecast.monthly)!=null&&S.imagePath&&(E.forecast.monthly.imagePath=(0,eS.normalizePath)(e.forecast.monthly.imagePath)),(x=e.forecast.weekly)!=null&&x.imagePath&&(E.forecast.weekly.imagePath=(0,eS.normalizePath)(e.forecast.weekly.imagePath)),(T=e.forecast.daily)!=null&&T.imagePath&&(E.forecast.daily.imagePath=(0,eS.normalizePath)(e.forecast.daily.imagePath))),E}catch(E){return s(E,"Error normalizing data"),e}},[e]),y=xn.default.useMemo(()=>{try{if(f.date){let S=f.date.split("-").map(T=>parseInt(T,10)),x=new Date(S[0],S[1]-1,S[2]);return x.getFullYear()!==S[0]||x.getMonth()!==S[1]-1||x.getDate()!==S[2]?(console.error(`Invalid date parsed from frontmatter: ${f.date}`),new Date):x}return new Date}catch(S){return s(S,"Error parsing date"),new Date}},[f.date]),h=(0,xn.useCallback)(S=>{d.current=S;try{if(S&&!n){let x=S.getAttribute("data-displaying-file");if(x){p(x);return}let T=S.parentElement;for(;T;){let E=T.getAttribute("data-displaying-file")||T.getAttribute("data-file-path");if(E){p(E);break}T=T.parentElement}}}catch(x){s(x,"Error finding file path")}},[n]);(0,xn.useEffect)(()=>{let S=async()=>{var x,T;try{if(g&&f.date){let E=f.date.split("-").map(I=>parseInt(I,10)),C=new Date(E[0],E[1]-1,E[2]);if(C.getFullYear()!==E[0]||C.getMonth()!==E[1]-1||C.getDate()!==E[2]){console.error(`Invalid date parsed from frontmatter when fetching previous goals: ${f.date}`);return}let N=new Date(C);N.setDate(C.getDate()-7);let D=g.getWeeklyReviewPath(N),A=o||((T=(x=window.app)==null?void 0:x.plugins)==null?void 0:T.plugins.journalit),P=A.app.vault.getAbstractFileByPath(D);if(P&&A.app.metadataCache.getFileCache(P)){let M=await g.extractWeeklyReviewData(P);M!=null&&M.nextWeekGoals&&c(M.nextWeekGoals)}}}catch(E){sa({message:"Error fetching previous week goals",error:E,component:a,operation:"fetchPreviousWeekGoals",severity:"warning"})}};!m.current&&f.date&&(S(),m.current=!0)},[f.date,g,o]),(0,xn.useEffect)(()=>{if(qg(),yd(),d.current){d.current.classList.add("weekly-review-mounted"),d.current.setAttribute("data-mounted-at",Date.now().toString());let S=d.current.closest(".journalit-weekly-review-view");S&&S.classList.add("weekly-review-mounted")}},[]);let v=S=>{let x=["January","February","March","April","May","June","July","August","September","October","November","December"],T=parseInt(S.toString())-1;return x[T]||S},b=`${f.week} Review, ${v(f.month)} ${f.year}`;return xn.default.createElement("div",{className:"weekly-review-container",ref:h,"data-file-path":u,style:{margin:0}},xn.default.createElement(Rw,{data:f,filePath:u,openNote:i,plugin:o,serviceName:"weeklyReviewService",componentName:b,navigationOptions:{currentDate:y,getAdjacentReview:async S=>{try{if(g)return await g.getAdjacentWeeklyReview(y,S)}catch(x){s(x,"Error getting adjacent weekly review")}return null},getRelatedReviewPaths:{monthly:S=>{var x,T;try{let E=o||((T=(x=window.app)==null?void 0:x.plugins)==null?void 0:T.plugins.journalit);if(E!=null&&E.drcService)return E.drcService.getMonthlyReviewPath(S)}catch(E){s(E,"Error getting monthly review path")}return""},yearly:S=>{try{let x=S.getFullYear();return`!Journalit/${x}/Yearly-${x}.md`}catch(x){s(x,"Error getting yearly review path")}return""}}},tabConfig:[{id:"prepare",label:"Preparation",content:({data:S,updateData:x})=>xn.default.createElement(M8,{data:S,updateData:x,previousWeekGoals:l})},{id:"overview",label:"Overview",content:({data:S,updateData:x,openNote:T})=>{var E,C;return xn.default.createElement(B8,{data:S,trades:t,updateData:x,openNote:T,dateFormat:((C=(E=o==null?void 0:o.settings)==null?void 0:E.trade)==null?void 0:C.dateFormat)||"DDMMYY"})}},{id:"review",label:"Review",content:({data:S,updateData:x,openNote:T})=>{var E,C;return xn.default.createElement(U8,{data:S,drcs:r,trades:t,updateData:x,openNote:T,dateFormat:((C=(E=o==null?void 0:o.settings)==null?void 0:E.trade)==null?void 0:C.dateFormat)||"DDMMYY"})}}],updateMethodName:"updateWeeklyReviewFrontmatter",className:{container:"weekly-review-content",header:{container:"weekly-review-header",title:"weekly-review-title",dateContainer:"weekly-review-date-container"},tabContainer:{container:"weekly-review-tabs-container",tabList:"weekly-review-tabs",tab:"weekly-review-tab",activeTab:"active"}}}))};var tS=class extends Qi{constructor(t,r){super(t),this.plugin=r}async renderComponent(t,r,n,i,o){await this.renderWeeklyReview(t,r,r.trades||[],r.drcs||[],n,i,o)}async renderWeeklyReview(t,r,n=[],i=[],o,a,s){try{if(!t||!t.isConnected)return;let l=s?`${o}-${a}-${s}`:`${o}-${a}`,c=this.reactRoots.get(l);if(c&&c.domContainer&&c.domContainer.isConnected&&c.domContainer.querySelector(".weekly-review-container")||t.querySelector(".weekly-review-container"))return;qg();let u,p=t.closest(".workspace-leaf");p&&p.id&&(u=p.id,t.setAttribute("data-leaf-id",u)),t.setAttribute("data-weekly-protected","true"),t.setAttribute("data-displaying-file",o),t.setAttribute("data-rendered-at",Date.now().toString()),t.setAttribute("data-renderer-id",`${o}-${a}-${Date.now()}`),t.setAttribute("data-debug-version","1.0.0");let m={...r};["plugin","app","_"].forEach(f=>{f in m&&delete m[f]});let g={...m,trades:n,drcs:i};this.createReactRoot(t,l,u,s,g,o)}catch(l){console.error("[WeeklyReview] Error rendering Weekly Review:",l),t.setText("Error rendering Weekly Review: "+(l instanceof Error?l.message:String(l)))}}getComponentClassName(){return"journalit-weekly-review-view"}getWrapperClassName(){return"weekly-review-wrapper"}createReactElement(t,r,n){let i=n||((o,a=!1)=>{this.plugin&&this.plugin.openFile(o,a)});return H8.default.createElement(V8,{data:t,trades:t.trades||[],drcs:t.drcs||[],filePath:r,openNote:i,plugin:this.plugin})}unmountWeeklyReview(t,r,n,i){return this.unmountComponent(t,r,n,i)}unmountAllWeeklyReviews(){this.unmountAllComponents()}};var rS=class extends Zi{constructor(t){super(t.app,t,new tS(t.app,t)),this.plugin=t}isValidComponentType(t){return t&&t.type==="weekly-review"}getComponentClassName(){return"journalit-weekly-review-view"}getWrapperClassName(){return"weekly-review-wrapper"}getComponentTypeIdentifier(){return"weekly-review"}async getAdditionalDataForComponent(t,r){let n=[],i=[];if(this.plugin.weeklyReviewService)try{let o=r.date.split("-").map(s=>parseInt(s,10)),a=new Date(o[0],o[1]-1,o[2]);if((a.getFullYear()!==o[0]||a.getMonth()!==o[1]-1||a.getDate()!==o[2])&&(console.error(`Invalid date parsed from frontmatter: ${r.date}`),a.setTime(new Date().getTime())),this.plugin.tradeService){let l=(await this.plugin.weeklyReviewService.getTradesForWeek(a)).map(async c=>{var d;try{let u=(d=this.app.metadataCache.getFileCache(c))==null?void 0:d.frontmatter;if(!u||u.type!=="trade")return null;let p=u.pnl===void 0||u.pnl===null;return{path:c.path,instrument:u.instrument||"Unknown",direction:u.direction||"Unknown",entryPrice:parseFloat(u.entryPrice)||0,exitPrice:u.exitPrice!==void 0&&u.exitPrice!==null?parseFloat(u.exitPrice):0,positionSize:parseFloat(u.positionSize)||0,pnl:u.pnl!==void 0&&u.pnl!==null?parseFloat(u.pnl):0,entryTime:u.entryTime?new Date(u.entryTime):new Date,exitTime:u.exitTime?new Date(u.exitTime):new Date(u.entryTime),setup:u.setup,mistake:u.mistake,ctags:u.ctags,tradeStatus:u.tradeStatus,useDirectPnLInput:u.useDirectPnLInput,exits:u.exits,_originalPnlWasNull:p}}catch(u){return console.error(`Error processing trade file ${c.path}:`,u),null}});n=(await Promise.all(l)).filter(Boolean)}i=await this.plugin.weeklyReviewService.getDRCsForWeek(a)}catch(o){console.error("[WeeklyReview] Error fetching additional data:",o)}return{trades:n,drcs:i}}async handleFileOpen(t,r=!1){if(!t)return;this.cleanupOrphanedComponents(),this.cleanupUnrelatedComponents(t.path);let n=this.app.metadataCache.getFileCache(t),i=n==null?void 0:n.frontmatter;if(!i||!this.isValidComponentType(i))return;if(r){let s=`rendered-weekly-${t.path}-${Date.now()}`;if(window[s]=!1,Date.now()-window.__obsidianStartTime<5e3){setTimeout(()=>this.tryRenderActiveComponent(t,s),500),setTimeout(()=>{window[s]||this.tryRenderActiveComponent(t,s)},1500),setTimeout(()=>{window[s]||this.tryRenderActiveComponent(t,s),delete window[s]},3e3),setTimeout(()=>{this.renderActiveComponent()},5e3);return}this.tryRenderActiveComponent(t,s),setTimeout(()=>{window[s]||this.tryRenderActiveComponent(t,s),delete window[s]},500)}let o=document.body,a=new MutationObserver(async(s,l)=>{var c;try{let d=document.querySelectorAll(".cm-editor");if(d.length===0)return;if(this.isFileRenderedInMode(t.path,"source")){if(document.querySelectorAll(`.${this.getComponentClassName()}[data-file-path="${t.path}"]`).length>0)return;this.clearFileRenderedStatus(t.path,"source")}for(let p of Array.from(d)){let m=p.querySelector(".metadata-container");if(!m)continue;let g=m.closest(".workspace-leaf-content");if(!g)continue;let f=this.findContainingLeaf(g),y=(c=f==null?void 0:f.view)==null?void 0:c.containerEl,h=m.closest(".workspace-leaf"),b=(h==null?void 0:h.id)||(y==null?void 0:y.id)||null,w=this.getUniqueElementId(p),k=b?`leaf-${b}`:w,S=!0;if(f){let D=f.view,A=null;(D&&"file"in D||D&&"getViewType"in D&&D.getViewType()==="markdown")&&(A=D.file),A&&(S=A.path===t.path)}if(!S)continue;p.querySelectorAll(`.${this.getComponentClassName()}`).forEach(D=>{let A=D.getAttribute("data-file-path");if(A&&A!==t.path){let P=D.getAttribute("data-view-id"),I=D.getAttribute("data-leaf-id");P&&this.renderer.unmountComponent(A,P,I||void 0),D.remove()}});let x=Array.from(p.querySelectorAll(`.${this.getComponentClassName()}[data-file-path="${t.path}"]`));if(x.length>1)for(let D=1;D<x.length;D++){let A=x[D],P=A.getAttribute("data-view-id"),I=A.getAttribute("data-leaf-id");P&&this.renderer.unmountComponent(t.path,P,I||void 0),A.remove()}let T=this.getWrapperClassName();if(p.querySelectorAll(`.${T}`).length>0)continue;let C=Array.from(p.querySelectorAll(`.${this.getComponentClassName()}`)).find(D=>D.getAttribute("data-file-path")===t.path);C||(C=document.createElement("div"),C.className=this.getComponentClassName(),C.style.marginTop="20px",C.style.marginBottom="20px",C.style.padding="10px",C.setAttribute("data-file-path",t.path),C.setAttribute("data-view-id",k),C.setAttribute("data-editor-id",w),C.setAttribute("data-view-mode","source"),b&&C.setAttribute("data-leaf-id",b),C.setAttribute("data-inserted-at",Date.now().toString()),C.style.margin="0",C.style.padding="0",C.style.border="none",C.style.width="100%",C.style.display="block",C.style.boxSizing="border-box",m.after(C));let N=await this.getAdditionalDataForComponent(t,i);this.renderer.renderComponent(C,{...i,...N},t.path,k,w),this.markFileRenderedInMode(t.path,"source")}l.disconnect();let u=this.activeObservers.indexOf(l);u>-1&&this.activeObservers.splice(u,1)}catch(d){console.error("[WeeklyReview] Error in MutationObserver:",d)}});this.activeObservers.push(a),a.observe(o,{childList:!0,subtree:!0}),setTimeout(()=>{a.disconnect();let s=this.activeObservers.indexOf(a);s>-1&&this.activeObservers.splice(s,1)},5e3)}async handleMarkdownPostProcessor(t,r){var s,l;if(!r.sourcePath)return;let n=this.app.vault.getAbstractFileByPath(r.sourcePath);if(!(n instanceof mf.TFile))return;let i=this.app.metadataCache.getFileCache(n),o=i==null?void 0:i.frontmatter;if(!o||!this.isValidComponentType(o))return;if(((s=t.parentElement)==null?void 0:s.classList.contains("markdown-preview-view"))&&!r.sourcePath.endsWith("#")&&!t.previousElementSibling){if(this.isFileRenderedInMode(n.path,"preview"))return;let c=t.parentElement;if(!c){console.warn(`[${this.constructor.name}] Cannot find parent markdown view for:`,r.sourcePath);return}let d=c.closest(".workspace-leaf-content");if(!d){console.warn(`[${this.constructor.name}] Cannot find containing leaf for:`,r.sourcePath);return}let u=c.closest(".workspace-leaf"),p=u==null?void 0:u.id,m=this.findContainingLeaf(d),g=(l=m==null?void 0:m.view)==null?void 0:l.containerEl,f=p||(g==null?void 0:g.id)||null,y=this.getUniqueElementId(c),h=f?`leaf-${f}`:y,v=!0;if(m){let T=m.view,E=null;("file"in T||T&&"getViewType"in T&&T.getViewType()==="markdown")&&(E=T.file),E&&(v=E.path===n.path)}if(!v)return;let b=this.getComponentClassName(),w=Array.from(c.querySelectorAll(`.${b}[data-file-path="${n.path}"]`));if(w.length>0){if(w.length>1)for(let T=1;T<w.length;T++){let E=w[T],C=E.getAttribute("data-view-id"),N=E.getAttribute("data-leaf-id");C&&this.renderer.unmountComponent(n.path,C,N||void 0),E.remove()}return}c.querySelectorAll(`.${b}`).forEach(T=>{let E=T.getAttribute("data-file-path");if(E&&E!==n.path){let C=T.getAttribute("data-view-id"),N=T.getAttribute("data-leaf-id");C&&this.renderer.unmountComponent(E,C,N||void 0),T.remove()}});let k=this.getWrapperClassName(),S=Array.from(c.querySelectorAll(`.${k}`));if(S.length>0&&S.some(E=>{var C;return((C=E.closest(`.${b}`))==null?void 0:C.getAttribute("data-file-path"))===n.path}))return;let x=document.createElement("div");x.className=this.getComponentClassName(),x.setAttribute("data-file-path",n.path),x.setAttribute("data-view-id",h),x.setAttribute("data-markdown-view-id",y),x.setAttribute("data-view-mode","preview"),f&&x.setAttribute("data-leaf-id",f),x.setAttribute("data-inserted-at",Date.now().toString()),x.style.margin="0",x.style.padding="0",x.style.border="none",x.style.width="100%",x.style.display="block",x.style.boxSizing="border-box",c.insertBefore(x,c.firstChild);try{let T=await this.getAdditionalDataForComponent(n,o);await this.renderer.renderComponent(x,{...o,...T},n.path,h,y),this.markFileRenderedInMode(n.path,"preview")}catch(T){console.error(`[${this.constructor.name}] Error rendering component:`,T),x.textContent=`Error rendering ${this.getComponentTypeIdentifier()}: ${T instanceof Error?T.message:String(T)}`}}}registerCurrentLeaves(){this.app.workspace.iterateAllLeaves(t=>{var i;let r=(i=t.view)==null?void 0:i.containerEl;r&&r.id&&this.registeredLeaves.add(r.id);let n=t.containerEl;n&&n.id&&n.id!==(r==null?void 0:r.id)&&this.registeredLeaves.add(n.id),(!r||!r.id)&&(!n||!n.id)&&(r&&!r.id?(r.id=`weekly-review-leaf-${Date.now()}-${Math.random().toString(36).slice(2,9)}`,this.registeredLeaves.add(r.id)):n&&!n.id&&(n.id=`weekly-review-leaf-${Date.now()}-${Math.random().toString(36).slice(2,9)}`,this.registeredLeaves.add(n.id)))})}async tryRenderWeeklyInActiveLeaf(t,r){try{let n=[];this.app.workspace.iterateAllLeaves(o=>{let a=null;(o.view&&"file"in o.view||o.view&&"getViewType"in o.view&&o.view.getViewType()==="markdown")&&(a=o.view.file),a&&a.path===t.path&&n.push(o)});let i=!1;for(let o of n){if(!o.view)continue;let a=o.view.getViewType()==="markdown",s=a?o.view.getMode:null,l=a&&typeof s=="function"?s.call(o.view)==="source":!1,c=l?"source":"preview";if(this.isFileRenderedInMode(t.path,c))return!0;let d=o.view.containerEl,u=`leaf-${d.id||this.generateViewId(d)}`;try{let p=await this.getAdditionalDataForComponent(t,r);if(l){let m=d.querySelector(".metadata-container");if(m){let g=d.querySelectorAll(`.${this.getComponentClassName()}[data-file-path="${t.path}"]`),f=d.querySelectorAll(`.${this.getWrapperClassName()}`);if(g.length===0&&f.length===0){let y=document.createElement("div");y.className=this.getComponentClassName(),y.setAttribute("data-file-path",t.path),y.setAttribute("data-view-id",u),y.setAttribute("data-leaf-id",d.id||""),y.setAttribute("data-view-mode","source"),y.setAttribute("data-inserted-at",Date.now().toString()),y.style.margin="0",y.style.padding="0",y.style.border="none",y.style.width="100%",y.style.display="block",y.style.boxSizing="border-box",m.after(y),await this.renderer.renderComponent(y,{...r,...p},t.path,u),this.markFileRenderedInMode(t.path,"source"),i=!0}}}else if(a&&o.view instanceof mf.MarkdownView){let m=o.view;try{let g=m;typeof g.toggleSourceMode=="function"?(g.toggleSourceMode(),setTimeout(()=>g.toggleSourceMode(),50)):this.app.workspace.trigger("layout-change")}catch(g){console.error("[WeeklyReview] Error refreshing view:",g)}}}catch(p){console.error("[WeeklyReview] Error rendering in active leaf:",p)}}return i}catch(n){return console.error("[WeeklyReview] Error in tryRenderWeeklyInActiveLeaf:",n),!1}}async tryRenderActiveComponent(t,r){try{let n=this.app.metadataCache.getFileCache(t),i=n==null?void 0:n.frontmatter;if(!i||!this.isValidComponentType(i))return;if(this.hasProperlyRenderedComponents(t.path,this.getComponentClassName(),".weekly-review-container","weekly-review-mounted")){window[r]=!0;return}this.cleanupDuplicateComponents(t.path),await this.renderActiveComponent(),window[r]=!0}catch(n){console.error("[WeeklyReview] Error in tryRenderActiveComponent:",n)}}async renderActiveComponent(){await this.renderActiveWeeklyReview()}async renderActiveWeeklyReview(){var f;this.cleanupOrphanedComponents();let t=this.app.workspace.getActiveFile();if(!t)return;let r=this.app.metadataCache.getFileCache(t),n=r==null?void 0:r.frontmatter;if(!n||n.type!=="weekly-review")return;let i=this.getComponentClassName(),o=document.querySelectorAll(`.${i}[data-file-path="${t.path}"]`);if(o.length>0&&Array.from(o).some(h=>h.querySelector(".weekly-review-container"))){if(o.length>1)for(let h=1;h<o.length;h++){let v=o[h],b=v.getAttribute("data-view-id"),w=v.getAttribute("data-leaf-id");b&&this.renderer.unmountComponent(t.path,b,w||void 0),v.remove()}return}this.cleanupUnrelatedComponents(t.path);let a;try{a=this.app.workspace.getActiveViewOfType(mf.MarkdownView)}catch(y){console.error("[WeeklyReview] Error getting active view:",y);let h=this.app.workspace.activeLeaf;h&&h.view&&"getViewType"in h.view&&h.view.getViewType()==="markdown"&&(a=h.view)}if(!a)return;let s=a.containerEl.closest(".workspace-leaf-content");if(!s)return;let l=this.findContainingLeaf(s),c=(f=l==null?void 0:l.view)==null?void 0:f.containerEl,d=(c==null?void 0:c.id)||null,u=d?`leaf-${d}`:this.generateViewId(s),p=a.getMode,m=typeof p=="function"?p.call(a)==="source":!1,g=await this.getAdditionalDataForComponent(t,n);if(m){let y=a.containerEl.querySelector(".metadata-container");if(!y)return;let h=Array.from(a.containerEl.querySelectorAll(`.${this.getComponentClassName()}`)).find(b=>b.getAttribute("data-file-path")===t.path);if(h){if(h.querySelector(".weekly-review-container")){this.markFileRenderedInMode(t.path,"source");return}h.remove()}let v=document.createElement("div");v.className=this.getComponentClassName(),v.setAttribute("data-file-path",t.path),v.setAttribute("data-view-id",u),v.setAttribute("data-view-mode","source"),d&&v.setAttribute("data-leaf-id",d),v.style.margin="0",v.style.padding="0",v.style.border="none",v.style.width="100%",v.style.display="block",v.style.boxSizing="border-box",y.after(v),await this.renderer.renderComponent(v,{...n,...g},t.path,u),this.markFileRenderedInMode(t.path,"source")}else{let y=this.app.workspace.activeLeaf;if(y&&y.view instanceof mf.MarkdownView){let h=y.view;try{let v=h;typeof v.toggleSourceMode=="function"?(v.toggleSourceMode(),setTimeout(()=>v.toggleSourceMode(),50)):typeof v.updateDisplay=="function"?v.updateDisplay():(this.app.workspace.trigger("layout-change"),window.dispatchEvent(new Event("resize")))}catch(v){console.error("[WeeklyReview] Error refreshing markdown view:",v)}}}}};var Bv=require("obsidian");var X8=$(W());var vi=$(W());var q8=$(W());var G8=({currentDate:e,navigateTo:t,getAdjacentMonthlyReview:r,getYearlyReviewPath:n})=>{let{handleNavigation:i,navigateToRelatedReview:o,isNavigating:a}=Yb({currentDate:e,navigateTo:t,getAdjacentReview:r});return q8.default.createElement(_p,{buttons:[{text:"Previous Month",action:()=>i(-1),icon:"left",disabled:a},{text:"Yearly Review",action:()=>{console.log("Yearly Review clicked - not yet implemented")},disabled:!1},{text:"Next Month",action:()=>i(1),icon:"right",disabled:a}],className:"monthly-review-navigation"})};var se=$(W());Yt();var XM=Ks(Ys,"pnl"),Lde=Ks(zl,"drawdown"),Y8=({data:e,trades:t,weeklyPerformance:r,bestWeek:n,worstWeek:i,updateData:o,openNote:a,dateFormat:s="DDMMYY"})=>{let l=(0,se.useMemo)(()=>s||fr(),[s]),c=(0,se.useMemo)(()=>t.filter(h=>!at({tradeStatus:h.tradeStatus,exitTime:h.exitTime,pnl:h._originalPnlWasNull?null:h.pnl,useDirectPnLInput:h.useDirectPnLInput,exits:h.exits})),[t]),d=(0,se.useMemo)(()=>pf(c),[c]),u=(0,se.useMemo)(()=>{if(c.length===0)return[];let h=new Map;c.forEach(b=>{let w=Array.isArray(b.setup)?[...b.setup]:b.setup?[b.setup]:[];w.length===0&&w.push("Other"),w.forEach(k=>{if(!k)return;let S=h.get(k)||{pnl:0,wins:0,losses:0,tradeCount:0};S.pnl+=b.pnl||0,S.tradeCount++,(b.pnl||0)>0?S.wins++:(b.pnl||0)<0&&S.losses++,h.set(k,S)})});let v=[];return h.forEach((b,w)=>{let k=b.tradeCount>0?b.wins/b.tradeCount*100:0;v.push({name:w,pnl:b.pnl,winRate:k,tradeCount:b.tradeCount})}),v.sort((b,w)=>w.pnl-b.pnl)},[c]),p=(0,se.useMemo)(()=>{let h=c.filter(v=>(v.pnl||0)>0);return h.length===0?null:h.reduce((v,b)=>(b.pnl||0)>(v.pnl||0)?b:v)},[c]),m=(0,se.useMemo)(()=>{let h=c.filter(v=>(v.pnl||0)<0);return h.length===0?null:h.reduce((v,b)=>(b.pnl||0)<(v.pnl||0)?b:v)},[c]),g=(0,se.useMemo)(()=>c.filter(h=>{var v;return((v=h.direction)==null?void 0:v.toLowerCase())==="long"}),[c]),f=(0,se.useMemo)(()=>c.filter(h=>{var v;return((v=h.direction)==null?void 0:v.toLowerCase())==="short"}),[c]),y=e.date?new Date(e.date).toLocaleDateString("en-US",{month:"long",year:"numeric"}):new Date().toLocaleDateString("en-US",{month:"long",year:"numeric"});return se.default.createElement("div",{className:"monthly-review-overview"},se.default.createElement("div",{className:"monthly-review-section"},se.default.createElement("h3",{className:"monthly-review-section-title"},"Monthly Cumulative P&L"),c.length>0?se.default.createElement(XM,{trades:c,height:300,dateFormat:l}):se.default.createElement(Ae,{message:"No P&L data to display",subMessage:"Your cumulative profit/loss will show here once you've logged closed trades",iconSize:40})),se.default.createElement("div",{className:"monthly-review-section"},se.default.createElement("h3",{className:"monthly-review-section-title"},"Monthly Drawdown"),c.length>0?se.default.createElement(Lde,{trades:c,height:250,dateFormat:l}):se.default.createElement(Ae,{message:"No drawdown data to display",subMessage:"Your drawdown metrics will appear here once you've logged closed trades",iconSize:40})),se.default.createElement("div",{className:"monthly-review-section"},se.default.createElement("h3",{className:"monthly-review-section-title"},"Monthly Performance"),se.default.createElement("div",{className:"monthly-review-metric-cards"},se.default.createElement("div",{className:"monthly-review-metric-card"},se.default.createElement("div",{className:"monthly-review-metric-label"},"Net P&L"),se.default.createElement("div",{className:"monthly-review-metric-value",style:{color:d.netPnL>=0?"var(--color-green)":"var(--color-red)"}},fe(d.netPnL))),se.default.createElement("div",{className:"monthly-review-metric-card"},se.default.createElement("div",{className:"monthly-review-metric-label"},"Win Rate"),se.default.createElement("div",{className:"monthly-review-metric-value"},gd(d.winRate*100))),se.default.createElement("div",{className:"monthly-review-metric-card"},se.default.createElement("div",{className:"monthly-review-metric-label"},"Profit Factor"),se.default.createElement("div",{className:"monthly-review-metric-value"},d.profitFactor.toFixed(2))),se.default.createElement("div",{className:"monthly-review-metric-card"},se.default.createElement("div",{className:"monthly-review-metric-label"},"Total Trades"),se.default.createElement("div",{className:"monthly-review-metric-value"},d.numTrades)))),u.length>0&&se.default.createElement("div",{className:"monthly-review-section"},se.default.createElement("h3",{className:"monthly-review-section-title"},"Setup Performance"),se.default.createElement(Wv,{data:u,height:250})),se.default.createElement("div",{className:"monthly-review-section"},se.default.createElement("h3",{className:"monthly-review-section-title"},"Biggest Winner of ",y),p?se.default.createElement("div",{className:"monthly-review-best-trade best-trade"},se.default.createElement("div",{className:"monthly-review-best-trade-header"},se.default.createElement("div",{className:"monthly-review-best-trade-title"},p.instrument||"Unknown"," (",p.direction,")"),se.default.createElement("div",{className:"monthly-review-best-trade-pnl",style:{color:"var(--color-green)"}},fe(p.pnl||0))),se.default.createElement("div",{className:"monthly-review-best-trade-details"},se.default.createElement("div",{className:"monthly-review-best-trade-detail"},se.default.createElement("span",{className:"monthly-review-best-trade-label"},"Date:"),se.default.createElement("span",{className:"monthly-review-best-trade-value"},Ze(p.entryTime,l))),se.default.createElement("div",{className:"monthly-review-best-trade-detail"},se.default.createElement("span",{className:"monthly-review-best-trade-label"},"Setup:"),se.default.createElement("span",{className:"monthly-review-best-trade-value"},Array.isArray(p.setup)?p.setup.join(", "):p.setup||"N/A"))),a&&p.path&&se.default.createElement("div",{className:"monthly-review-best-trade-actions"},se.default.createElement("button",{className:"monthly-review-view-button",onClick:()=>a(p.path,!0)},"View Trade Details"))):se.default.createElement(Ae,{message:"No winning trades this month",subMessage:"Your best trades will appear here",iconSize:40})),se.default.createElement("div",{className:"monthly-review-section"},se.default.createElement("h3",{className:"monthly-review-section-title"},"Biggest Loser of ",y),m?se.default.createElement("div",{className:"monthly-review-best-trade worst-trade"},se.default.createElement("div",{className:"monthly-review-best-trade-header"},se.default.createElement("div",{className:"monthly-review-best-trade-title"},m.instrument||"Unknown"," (",m.direction,")"),se.default.createElement("div",{className:"monthly-review-best-trade-pnl",style:{color:"var(--color-red)"}},fe(m.pnl||0))),se.default.createElement("div",{className:"monthly-review-best-trade-details"},se.default.createElement("div",{className:"monthly-review-best-trade-detail"},se.default.createElement("span",{className:"monthly-review-best-trade-label"},"Date:"),se.default.createElement("span",{className:"monthly-review-best-trade-value"},Ze(m.entryTime,l))),se.default.createElement("div",{className:"monthly-review-best-trade-detail"},se.default.createElement("span",{className:"monthly-review-best-trade-label"},"Setup:"),se.default.createElement("span",{className:"monthly-review-best-trade-value"},Array.isArray(m.setup)?m.setup.join(", "):m.setup||"N/A"))),a&&m.path&&se.default.createElement("div",{className:"monthly-review-best-trade-actions"},se.default.createElement("button",{className:"monthly-review-view-button",onClick:()=>a(m.path,!0)},"View Trade Details"))):se.default.createElement(Ae,{message:"No losing trades this month",subMessage:"Your worst trades will appear here",iconSize:40})),se.default.createElement("div",{className:"monthly-review-section"},se.default.createElement("h3",{className:"monthly-review-section-title"},"Weekly Performance Highlights"),se.default.createElement("div",{className:"monthly-review-week-highlights"},n&&se.default.createElement("div",{className:"monthly-review-metric-card highlight-card"},se.default.createElement("div",{className:"monthly-review-metric-label"},"Best Performing Week"),se.default.createElement("div",{className:"monthly-review-metric-value",style:{color:"var(--color-green)"}},"Week ",n.weekNumber),se.default.createElement("div",{className:"monthly-review-metric-detail"},fe(n.pnl)),a&&n.weeklyReviewPath&&se.default.createElement("button",{className:"monthly-review-link-button",onClick:()=>a(n.weeklyReviewPath,!0)},"View Week")),i&&se.default.createElement("div",{className:"monthly-review-metric-card highlight-card"},se.default.createElement("div",{className:"monthly-review-metric-label"},"Worst Performing Week"),se.default.createElement("div",{className:"monthly-review-metric-value",style:{color:"var(--color-red)"}},"Week ",i.weekNumber),se.default.createElement("div",{className:"monthly-review-metric-detail"},fe(i.pnl)),a&&i.weeklyReviewPath&&se.default.createElement("button",{className:"monthly-review-link-button",onClick:()=>a(i.weeklyReviewPath,!0)},"View Week")))),se.default.createElement("div",{className:"monthly-review-section"},se.default.createElement("h3",{className:"monthly-review-section-title"},"Long Only Performance"),g.length>0?se.default.createElement(XM,{trades:g,height:250,dateFormat:l}):se.default.createElement(Ae,{message:"No long trades this month",subMessage:"Your long trade performance will appear here",iconSize:40})),se.default.createElement("div",{className:"monthly-review-section"},se.default.createElement("h3",{className:"monthly-review-section-title"},"Short Only Performance"),f.length>0?se.default.createElement(XM,{trades:f,height:250,dateFormat:l}):se.default.createElement(Ae,{message:"No short trades this month",subMessage:"Your short trade performance will appear here",iconSize:40})),se.default.createElement("div",{className:"monthly-review-section"},se.default.createElement("h3",{className:"monthly-review-section-title"},"Weekly Breakdown"),r.length>0?se.default.createElement("div",{className:"monthly-review-trades-table"},se.default.createElement("table",null,se.default.createElement("thead",null,se.default.createElement("tr",null,se.default.createElement("th",null,"Week"),se.default.createElement("th",null,"Trades"),se.default.createElement("th",null,"Win%"),se.default.createElement("th",null,"Profit Factor"),se.default.createElement("th",null,"P&L"))),se.default.createElement("tbody",null,r.map((h,v)=>se.default.createElement("tr",{key:`week-${v}`,className:"monthly-review-trade-row",onClick:()=>{a&&h.weeklyReviewPath&&a(h.weeklyReviewPath,!0)},style:{cursor:a&&h.weeklyReviewPath?"pointer":"default"}},se.default.createElement("td",null,"W",h.weekNumber),se.default.createElement("td",null,h.trades),se.default.createElement("td",null,gd(h.winRate*100)),se.default.createElement("td",null,h.profitFactor===1/0?"\u221E":h.profitFactor.toFixed(2)),se.default.createElement("td",{style:{color:h.pnl>=0?"var(--color-green)":"var(--color-red)"}},fe(h.pnl))))))):se.default.createElement(Ae,{message:"No weekly data available",subMessage:"Your weekly performance breakdown will appear here",iconSize:40})))};var ht=$(W());var Ar=$(W()),QM=({title:e,data:t,type:r,openNote:n})=>{let i=l=>l==null?"N/A":l.toFixed(1),o=l=>r==="mental"?l.mentalGradeDistribution:l.technicalGradeDistribution,a=l=>r==="mental"?l.mentalRating:l.technicalRating,s=l=>r==="mental"?l.mentalNotes:l.technicalNotes;return Ar.default.createElement("div",{className:"monthly-review-section"},Ar.default.createElement("h3",{className:"monthly-review-section-title"},e),t.length>0?Ar.default.createElement("div",{className:"monthly-review-trades-table"},Ar.default.createElement("table",null,Ar.default.createElement("thead",null,Ar.default.createElement("tr",null,Ar.default.createElement("th",null,"Week"),Ar.default.createElement("th",null,"A Games"),Ar.default.createElement("th",null,"B Games"),Ar.default.createElement("th",null,"C Games"),Ar.default.createElement("th",null,"Rating"),Ar.default.createElement("th",null,"Notes"))),Ar.default.createElement("tbody",null,t.map((l,c)=>{let d=o(l),u=a(l),p=s(l);return Ar.default.createElement("tr",{key:`week-${l.weekNumber}`,className:"monthly-review-trade-row",onClick:()=>{n&&l.weeklyReviewPath&&n(l.weeklyReviewPath,!0)},style:{cursor:n&&l.weeklyReviewPath?"pointer":"default"}},Ar.default.createElement("td",null,"W",l.weekNumber),Ar.default.createElement("td",{className:"grade-count grade-a"},d.A),Ar.default.createElement("td",{className:"grade-count grade-b"},d.B),Ar.default.createElement("td",{className:"grade-count grade-c"},d.C),Ar.default.createElement("td",{className:"rating-cell"},i(u)),Ar.default.createElement("td",{className:"notes-cell"},p&&Ar.default.createElement("div",{className:"notes-content"},p)))})))):Ar.default.createElement("div",{className:"empty-performance-message"},"No performance data available for this month"))};var K8=({data:e,demonTrackerData:t,weeklyGamePerformance:r,updateData:n,openNote:i})=>{let o=["DEMON","1","2","3","4","5","STOP TRADING"];return ht.default.createElement("div",{className:"monthly-review-review"},ht.default.createElement("div",{className:"monthly-review-section"},ht.default.createElement("h3",{className:"monthly-review-section-title"},"Demon Tracker"),ht.default.createElement("p",{className:"monthly-review-section-description"},"Track your recurring mistakes to identify patterns and improve your trading discipline."),t.length>0?ht.default.createElement("div",{className:"demon-tracker-container"},ht.default.createElement("table",{className:"demon-tracker-table"},ht.default.createElement("thead",null,ht.default.createElement("tr",null,o.map((a,s)=>ht.default.createElement("th",{key:`col-${s}`,className:`demon-tracker-header ${a==="STOP TRADING"?"stop-trading":""}`},a)))),ht.default.createElement("tbody",null,t.map((a,s)=>ht.default.createElement("tr",{key:`demon-${s}`,className:"demon-tracker-row"},ht.default.createElement("td",{className:"demon-name"},a.mistake),[1,2,3,4,5].map(l=>ht.default.createElement("td",{key:`occ-${l}`,className:"demon-occurrence"},a.occurrences>=l?ht.default.createElement("span",{className:"demon-x"},"\u2717"):ht.default.createElement("span",{className:"demon-empty"},"-"))),ht.default.createElement("td",{className:"demon-occurrence stop-trading"},a.occurrences>=6?ht.default.createElement("span",{className:"demon-x stop"},"\u2717"):ht.default.createElement("span",{className:"demon-empty"},"-")))))),ht.default.createElement("div",{className:"demon-tracker-summary"},ht.default.createElement("div",{className:"demon-summary-item"},ht.default.createElement("span",{className:"demon-summary-label"},"Total Unique Mistakes:"),ht.default.createElement("span",{className:"demon-summary-value"},t.length)),ht.default.createElement("div",{className:"demon-summary-item"},ht.default.createElement("span",{className:"demon-summary-label"},"Total Mistake Occurrences:"),ht.default.createElement("span",{className:"demon-summary-value"},t.reduce((a,s)=>a+s.occurrences,0))),t.filter(a=>a.occurrences>=6).length>0&&ht.default.createElement("div",{className:"demon-summary-item warning"},ht.default.createElement("span",{className:"demon-summary-label"},"Critical Mistakes (6+):"),ht.default.createElement("span",{className:"demon-summary-value"},t.filter(a=>a.occurrences>=6).length)))):ht.default.createElement(Ae,{message:"No mistakes tracked this month",subMessage:"Mistakes logged in your trades will appear here to help identify patterns",iconSize:40})),ht.default.createElement(QM,{title:"Mental Game Performance",data:r,type:"mental",openNote:i}),ht.default.createElement(QM,{title:"Technical Game Performance",data:r,type:"technical",openNote:i}),ht.default.createElement("div",{className:"monthly-review-section monthly-review-mark-reviewed-section"},ht.default.createElement(zs,{reviewed:e.reviewed,reviewedAt:e.reviewedAt,onMarkReviewed:()=>{n({reviewed:!0,reviewedAt:new Date().toISOString()})}})))};var J8=({data:e,trades:t,weeklyPerformance:r,weeklyGamePerformance:n,demonTrackerData:i,bestWeek:o,worstWeek:a,updateData:s,openNote:l,plugin:c,dateFormat:d})=>{let[u,p]=(0,vi.useState)("overview"),[m,g]=(0,vi.useState)(0),[f,y]=(0,vi.useState)(e);(0,vi.useEffect)(()=>{y(e)},[e.date,e.month,e.year]),(0,vi.useEffect)(()=>{Gg()},[]),(0,vi.useEffect)(()=>{var T;let x=()=>{g(E=>E+1)};return(T=c==null?void 0:c.events)==null||T.on("settings-changed",x),()=>{var E;(E=c==null?void 0:c.events)==null||E.off("settings-changed",x)}},[c]);let h=async x=>{try{y(T=>({...T,...x})),await s(x)}catch(T){console.error("Error updating monthly review data:",T),y(e)}},v=[{id:"overview",label:"Overview"},{id:"review",label:"Review"}],b=f.date?new Date(f.date):new Date,w=b.toLocaleDateString("en-US",{month:"long",year:"numeric"});return vi.default.createElement("div",{className:"monthly-review",key:m},vi.default.createElement("h1",{className:"monthly-review-title"},w," Review"),vi.default.createElement(G8,{currentDate:b,navigateTo:(x,T)=>l==null?void 0:l(x,T),getAdjacentMonthlyReview:async x=>{let T=c==null?void 0:c.monthlyReviewService;return T?await T.getAdjacentMonthlyReview(b,x):null},getYearlyReviewPath:x=>""}),vi.default.createElement(Lw,{tabs:v,activeTab:u,onTabChange:p,className:{container:"monthly-review-tabs-container",tabList:"monthly-review-tabs",tab:"monthly-review-tab",activeTab:"active"}}),vi.default.createElement("div",{className:"monthly-review-content"},u==="overview"&&vi.default.createElement(Y8,{data:f,trades:t,weeklyPerformance:r,bestWeek:o,worstWeek:a,updateData:h,openNote:l,dateFormat:d}),u==="review"&&vi.default.createElement(K8,{data:f,demonTrackerData:i,weeklyGamePerformance:n,updateData:h,openNote:l})))};var nS=class extends Qi{constructor(t){super(t.app),this.plugin=t}getComponentClassName(){return"journalit-monthly-review-view"}getWrapperClassName(){return"monthly-review-wrapper"}createReactElement(t,r,n){var m;let{trades:i,weeklyPerformance:o,weeklyGamePerformance:a,demonTrackerData:s,bestWeek:l,worstWeek:c}=t,d={type:t.type||"monthly-review",date:t.date,month:t.month,year:t.year,reviewQuestions:t.reviewQuestions,monthlyGoals:t.monthlyGoals,keyFocusAreas:t.keyFocusAreas,biggestAccomplishment:t.biggestAccomplishment,biggestChallenge:t.biggestChallenge,lessonsLearned:t.lessonsLearned,nextMonthGoals:t.nextMonthGoals,areasOfImprovement:t.areasOfImprovement,reviewed:t.reviewed,reviewedAt:t.reviewedAt},u=((m=this.plugin.settings)==null?void 0:m.dateFormat)||"DDMMYY",p=this.plugin.monthlyReviewService;return X8.default.createElement(J8,{data:d,trades:i||[],weeklyPerformance:o||[],weeklyGamePerformance:a||[],demonTrackerData:s||[],bestWeek:l||null,worstWeek:c||null,updateData:async g=>{p&&await p.updateMonthlyReviewFrontmatter(r,g)},openNote:n,plugin:this.plugin,dateFormat:u})}async renderComponent(t,r,n,i,o){Gg(),t.addClass("journalit-monthly-review-container");let a=this.createReactElement(r,n,(c,d)=>{this.app.workspace.getLeaf(d||!1).openFile(this.app.vault.getAbstractFileByPath(c))}),s=`${i}-${o||"default"}`,l=this.reactRoots.get(s);if(!l||!t.contains(l.domContainer)){let{createRoot:c}=await Promise.resolve().then(()=>$(Ps()));l={root:c(t),domContainer:t},this.reactRoots.set(s,l),this.rootCreationTimes.set(s,Date.now())}l.root.render(a)}};var iS=class extends Zi{constructor(t){super(t.app,t,new nS(t)),this.plugin=t}isValidComponentType(t){return(t==null?void 0:t.type)==="monthly-review"}getComponentClassName(){return"journalit-monthly-review-view"}getWrapperClassName(){return"monthly-review-wrapper"}getComponentTypeIdentifier(){return"monthly-review"}async getAdditionalDataForComponent(t,r){if(!this.plugin.monthlyReviewService)return{trades:[],weeklyPerformance:[],weeklyGamePerformance:[],demonTrackerData:[],bestWeek:null,worstWeek:null};try{let n=await this.plugin.monthlyReviewService.getMonthlyDataOptimized(r.year,r.month);return{trades:n.trades,weeklyPerformance:n.weeklyPerformance,weeklyGamePerformance:n.weeklyGamePerformance,demonTrackerData:n.demonTrackerData,bestWeek:n.bestWeek,worstWeek:n.worstWeek}}catch(n){return console.error("[MonthlyReview] Error fetching additional data:",n),{trades:[],weeklyPerformance:[],weeklyGamePerformance:[],demonTrackerData:[],bestWeek:null,worstWeek:null}}}async handleFileOpen(t,r){if(!t){this.cleanup();return}this.cleanupOrphanedComponents(),this.cleanupUnrelatedComponents(t.path);let n=this.app.metadataCache.getFileCache(t),i=n==null?void 0:n.frontmatter;if(this.isValidComponentType(i)){if(r||document.dispatchEvent(new CustomEvent("journalit:monthly-review-opened",{detail:{file:t.path,frontmatter:i}})),r){let o=`rendered-monthly-${t.path}-${Date.now()}`;if(window[o]=!1,Date.now()-(window.__obsidianStartTime||0)<5e3){setTimeout(()=>this.tryRenderActiveComponent(t,o),500),setTimeout(()=>{window[o]||this.tryRenderActiveComponent(t,o)},1500),setTimeout(()=>{window[o]||this.tryRenderActiveComponent(t,o),delete window[o]},3e3),setTimeout(()=>{this.renderActiveComponent()},5e3);return}this.tryRenderActiveComponent(t,o),setTimeout(()=>{window[o]||this.tryRenderActiveComponent(t,o),delete window[o]},500)}await this.processMonthlyReviewNote(t,i,r)}}async processMonthlyReviewNote(t,r,n){let i=document.body,o=new MutationObserver(async(a,s)=>{var l;try{let c=document.querySelectorAll(".cm-editor");if(c.length===0)return;if(this.isFileRenderedInMode(t.path,"source")){if(document.querySelectorAll(`.${this.getComponentClassName()}[data-file-path="${t.path}"]`).length>0)return;this.clearFileRenderedStatus(t.path,"source")}for(let u of Array.from(c)){let p=u.querySelector(".metadata-container");if(!p)continue;let m=p.closest(".workspace-leaf-content");if(!m)continue;let g=this.findContainingLeaf(m),f=(l=g==null?void 0:g.view)==null?void 0:l.containerEl,y=p.closest(".workspace-leaf"),v=(y==null?void 0:y.id)||(f==null?void 0:f.id)||null,b=this.getUniqueElementId(u),w=v?`leaf-${v}`:b,k=!0;if(g){let N=g.view,D=null;(N&&"file"in N||N&&"getViewType"in N&&N.getViewType()==="markdown")&&(D=N.file),D&&(k=D.path===t.path)}if(!k)continue;u.querySelectorAll(`.${this.getComponentClassName()}`).forEach(N=>{let D=N.getAttribute("data-file-path");if(D&&D!==t.path){let A=N.getAttribute("data-view-id"),P=N.getAttribute("data-leaf-id");A&&this.renderer.unmountComponent(D,A,P||void 0),N.remove()}});let S=Array.from(u.querySelectorAll(`.${this.getComponentClassName()}[data-file-path="${t.path}"]`));if(S.length>1)for(let N=1;N<S.length;N++){let D=S[N],A=D.getAttribute("data-view-id"),P=D.getAttribute("data-leaf-id");A&&this.renderer.unmountComponent(t.path,A,P||void 0),D.remove()}let x=this.getWrapperClassName();if(u.querySelectorAll(`.${x}`).length>0)continue;let E=Array.from(u.querySelectorAll(`.${this.getComponentClassName()}`)).find(N=>N.getAttribute("data-file-path")===t.path);E||(E=document.createElement("div"),E.className=this.getComponentClassName(),E.style.marginTop="20px",E.style.marginBottom="20px",E.style.padding="10px",E.setAttribute("data-file-path",t.path),E.setAttribute("data-view-id",w),E.setAttribute("data-editor-id",b),E.setAttribute("data-view-mode","source"),v&&E.setAttribute("data-leaf-id",v),E.setAttribute("data-inserted-at",Date.now().toString()),E.style.margin="0",E.style.padding="0",E.style.border="none",E.style.width="100%",E.style.display="block",E.style.boxSizing="border-box",p.after(E));let C=await this.getAdditionalDataForComponent(t,r);this.renderer.renderComponent(E,{...r,...C},t.path,w,b),this.markFileRenderedInMode(t.path,"source")}s.disconnect();let d=this.activeObservers.indexOf(s);d>-1&&this.activeObservers.splice(d,1)}catch(c){console.error("[MonthlyReview] Error in MutationObserver:",c)}});this.activeObservers.push(o),o.observe(i,{childList:!0,subtree:!0}),setTimeout(()=>{o.disconnect();let a=this.activeObservers.indexOf(o);a>-1&&this.activeObservers.splice(a,1)},5e3)}async renderActiveComponent(){var f;this.cleanupOrphanedComponents();let t=this.app.workspace.getActiveFile();if(!t)return;let r=this.app.metadataCache.getFileCache(t),n=r==null?void 0:r.frontmatter;if(!n||n.type!=="monthly-review")return;let i=this.getComponentClassName(),o=document.querySelectorAll(`.${i}[data-file-path="${t.path}"]`);if(o.length>0&&Array.from(o).some(h=>h.querySelector(".journalit-monthly-review-container")||h.querySelector(".monthly-review")||h.querySelector(".monthly-review-wrapper"))){if(o.length>1)for(let h=1;h<o.length;h++){let v=o[h],b=v.getAttribute("data-view-id"),w=v.getAttribute("data-leaf-id");b&&this.renderer.unmountComponent(t.path,b,w||void 0),v.remove()}return}this.cleanupUnrelatedComponents(t.path);let a;try{a=this.app.workspace.getActiveViewOfType(Bv.MarkdownView)}catch(y){console.error("[MonthlyReview] Error getting active view:",y);let h=this.app.workspace.activeLeaf;h&&h.view&&"getViewType"in h.view&&h.view.getViewType()==="markdown"&&(a=h.view)}if(!a)return;let s=a.containerEl.closest(".workspace-leaf-content");if(!s)return;let l=this.findContainingLeaf(s),c=(f=l==null?void 0:l.view)==null?void 0:f.containerEl,d=(c==null?void 0:c.id)||null,u=d?`leaf-${d}`:this.generateViewId(s),p=a.getMode,m=typeof p=="function"?p.call(a)==="source":!1,g=await this.getAdditionalDataForComponent(t,n);if(m){let y=a.containerEl.querySelector(".metadata-container");if(!y)return;let h=Array.from(a.containerEl.querySelectorAll(`.${this.getComponentClassName()}`)).find(b=>b.getAttribute("data-file-path")===t.path);if(h){if(h.querySelector(".journalit-monthly-review-container")||h.querySelector(".monthly-review")||h.querySelector(".monthly-review-wrapper")){this.markFileRenderedInMode(t.path,"source");return}h.remove()}let v=document.createElement("div");v.className=this.getComponentClassName(),v.setAttribute("data-file-path",t.path),v.setAttribute("data-view-id",u),v.setAttribute("data-view-mode","source"),d&&v.setAttribute("data-leaf-id",d),v.style.margin="0",v.style.padding="0",v.style.border="none",v.style.width="100%",v.style.display="block",v.style.boxSizing="border-box",y.after(v),await this.renderer.renderComponent(v,{...n,...g},t.path,u),this.markFileRenderedInMode(t.path,"source")}else{let y=this.app.workspace.activeLeaf;if(y&&y.view instanceof Bv.MarkdownView){let h=y.view;try{let v=h;typeof v.toggleSourceMode=="function"?(v.toggleSourceMode(),setTimeout(()=>v.toggleSourceMode(),50)):typeof v.updateDisplay=="function"?v.updateDisplay():(this.app.workspace.trigger("layout-change"),window.dispatchEvent(new Event("resize")))}catch(v){console.error("[MonthlyReview] Error refreshing markdown view:",v)}}}}async tryRenderActiveComponent(t,r){try{let n=this.app.metadataCache.getFileCache(t),i=n==null?void 0:n.frontmatter;if(!i||!this.isValidComponentType(i))return;let o=this.getComponentClassName(),a=document.querySelectorAll(`.${o}[data-file-path="${t.path}"]`);if(a.length>0&&Array.from(a).some(l=>l.querySelector(".journalit-monthly-review-container")||l.querySelector(".monthly-review")||l.querySelector(".monthly-review-wrapper"))){window[r]=!0;return}this.cleanupUnrelatedComponents(t.path),await this.renderActiveComponent(),window[r]=!0}catch(n){console.error("[MonthlyReview] Error in tryRenderActiveComponent:",n)}}cleanup(){super.cleanup()}async handleMarkdownPostProcessor(t,r){var s,l;if(!r.sourcePath)return;let n=this.app.vault.getAbstractFileByPath(r.sourcePath);if(!(n instanceof Bv.TFile))return;let i=this.app.metadataCache.getFileCache(n),o=i==null?void 0:i.frontmatter;if(!o||!this.isValidComponentType(o))return;if(((s=t.parentElement)==null?void 0:s.classList.contains("markdown-preview-view"))&&!r.sourcePath.endsWith("#")&&!t.previousElementSibling){if(this.isFileRenderedInMode(n.path,"preview"))return;let c=t.parentElement;if(!c){console.warn(`[${this.constructor.name}] Cannot find parent markdown view for:`,r.sourcePath);return}let d=c.closest(".workspace-leaf-content");if(!d){console.warn(`[${this.constructor.name}] Cannot find containing leaf for:`,r.sourcePath);return}let u=c.closest(".workspace-leaf"),p=u==null?void 0:u.id,m=this.findContainingLeaf(d),g=(l=m==null?void 0:m.view)==null?void 0:l.containerEl,f=p||(g==null?void 0:g.id)||null,y=this.getUniqueElementId(c),h=f?`leaf-${f}`:y,v=!0;if(m){let T=m.view,E=null;("file"in T||T&&"getViewType"in T&&T.getViewType()==="markdown")&&(E=T.file),E&&(v=E.path===n.path)}if(!v)return;let b=this.getComponentClassName(),w=Array.from(c.querySelectorAll(`.${b}[data-file-path="${n.path}"]`));if(w.length>0){if(w.length>1)for(let T=1;T<w.length;T++){let E=w[T],C=E.getAttribute("data-view-id"),N=E.getAttribute("data-leaf-id");C&&this.renderer.unmountComponent(n.path,C,N||void 0),E.remove()}return}c.querySelectorAll(`.${b}`).forEach(T=>{let E=T.getAttribute("data-file-path");if(E&&E!==n.path){let C=T.getAttribute("data-view-id"),N=T.getAttribute("data-leaf-id");C&&this.renderer.unmountComponent(E,C,N||void 0),T.remove()}});let k=this.getWrapperClassName(),S=Array.from(c.querySelectorAll(`.${k}`));if(S.length>0&&S.some(E=>{var C;return((C=E.closest(`.${b}`))==null?void 0:C.getAttribute("data-file-path"))===n.path}))return;let x=document.createElement("div");x.className=this.getComponentClassName(),x.setAttribute("data-file-path",n.path),x.setAttribute("data-view-id",h),x.setAttribute("data-markdown-view-id",y),x.setAttribute("data-view-mode","preview"),f&&x.setAttribute("data-leaf-id",f),x.setAttribute("data-inserted-at",Date.now().toString()),x.style.margin="0",x.style.padding="0",x.style.border="none",x.style.width="100%",x.style.display="block",x.style.boxSizing="border-box",c.insertBefore(x,c.firstChild);try{let T=await this.getAdditionalDataForComponent(n,o);await this.renderer.renderComponent(x,{...o,...T},n.path,h,y),this.markFileRenderedInMode(n.path,"preview")}catch(T){console.error(`[${this.constructor.name}] Error rendering component:`,T),x.textContent=`Error rendering ${this.getComponentTypeIdentifier()}: ${T instanceof Error?T.message:String(T)}`}}}};var oS=class e{constructor(t,r){this._tradeNoteProcessor=null;this._drcNoteProcessor=null;this._weeklyReviewProcessor=null;this._monthlyReviewProcessor=null;this._missedTradeNoteProcessor=null;this.initializedProcessors=new Set;this.registeredLazyHandlers=new Set;this.customProcessors=new Map;this.customRenderers=new Map;this.app=t,this.plugin=r}static getInstance(t,r){return e.instance||(e.instance=new e(t,r)),e.instance}async initializeRequiredProcessors(){let t=this.app.workspace.getActiveFile(),r=!1,n=!1,i=!1,o=!1,a=!1;if(t){let s=this.app.metadataCache.getFileCache(t),l=s==null?void 0:s.frontmatter;l&&(l.type==="trade"?r=!0:l.type==="drc"?n=!0:l.type==="weekly-review"?i=!0:l.type==="monthly-review"?o=!0:(l.type==="missed-trade"||l.isMissedTrade===!0)&&(a=!0))}await this.getTradeNoteProcessor(),n?await this.getDRCNoteProcessor():this.registerLazyDRCProcessor(),i?await this.getWeeklyReviewProcessor():this.registerLazyWeeklyReviewProcessor(),o?await this.getMonthlyReviewProcessor():this.registerLazyMonthlyReviewProcessor(),a?await this.getMissedTradeNoteProcessor():this.registerLazyMissedTradeProcessor()}async getTradeNoteProcessor(){return this._tradeNoteProcessor||(this._tradeNoteProcessor=await Nn(()=>{let t=new Ph(this.app,this.plugin);return t.initialize(),t},"TradeNoteProcessor"),this.initializedProcessors.add("tradeNoteProcessor")),this._tradeNoteProcessor}async getDRCNoteProcessor(){return this._drcNoteProcessor||(this._drcNoteProcessor=await Nn(()=>{let t=new Zk(this.app,this.plugin);return t.initialize(),t},"DRCNoteProcessor"),this.initializedProcessors.add("drcNoteProcessor")),this._drcNoteProcessor}async getWeeklyReviewProcessor(){return this._weeklyReviewProcessor||(this._weeklyReviewProcessor=await Nn(()=>{let t=new rS(this.plugin);return t.initialize(),t},"WeeklyReviewProcessor"),this.initializedProcessors.add("weeklyReviewProcessor")),this._weeklyReviewProcessor}async getMonthlyReviewProcessor(){return this._monthlyReviewProcessor||(this._monthlyReviewProcessor=await Nn(()=>{let t=new iS(this.plugin);return t.initialize(),t},"MonthlyReviewProcessor"),this.initializedProcessors.add("monthlyReviewProcessor")),this._monthlyReviewProcessor}async getMissedTradeNoteProcessor(){return this._missedTradeNoteProcessor||(this._missedTradeNoteProcessor=await Nn(()=>{let t=new Rp(this.app,this.plugin);return t.initialize(),t},"MissedTradeNoteProcessor"),this.initializedProcessors.add("missedTradeNoteProcessor")),this._missedTradeNoteProcessor}registerLazyDRCProcessor(){if(this.registeredLazyHandlers.has("drc"))return;let t=r=>{if(!r)return;let n=this.app.metadataCache.getFileCache(r),i=n==null?void 0:n.frontmatter;i&&i.type==="drc"&&(this.app.workspace.off("file-open",t),this.registeredLazyHandlers.delete("drc"),this.getDRCNoteProcessor().catch(o=>{console.error("Failed to initialize DRC processor:",o)}))};this.plugin.registerEvent(this.app.workspace.on("file-open",t)),this.registeredLazyHandlers.add("drc")}registerLazyWeeklyReviewProcessor(){if(this.registeredLazyHandlers.has("weekly-review"))return;let t=r=>{if(!r)return;let n=this.app.metadataCache.getFileCache(r),i=n==null?void 0:n.frontmatter;i&&i.type==="weekly-review"&&(this.app.workspace.off("file-open",t),this.registeredLazyHandlers.delete("weekly-review"),this.getWeeklyReviewProcessor().catch(o=>{console.error("Failed to initialize Weekly Review processor:",o)}))};this.plugin.registerEvent(this.app.workspace.on("file-open",t)),this.registeredLazyHandlers.add("weekly-review")}registerLazyMonthlyReviewProcessor(){if(this.registeredLazyHandlers.has("monthly-review"))return;let t=r=>{if(!r)return;let n=this.app.metadataCache.getFileCache(r),i=n==null?void 0:n.frontmatter;i&&i.type==="monthly-review"&&(this.app.workspace.off("file-open",t),this.registeredLazyHandlers.delete("monthly-review"),this.getMonthlyReviewProcessor().catch(o=>{console.error("Failed to initialize Monthly Review processor:",o)}))};this.plugin.registerEvent(this.app.workspace.on("file-open",t)),this.registeredLazyHandlers.add("monthly-review")}registerLazyMissedTradeProcessor(){if(this.registeredLazyHandlers.has("missed-trade"))return;let t=r=>{if(!r)return;let n=this.app.metadataCache.getFileCache(r),i=n==null?void 0:n.frontmatter;i&&(i.type==="missed-trade"||i.isMissedTrade===!0)&&(this.app.workspace.off("file-open",t),this.registeredLazyHandlers.delete("missed-trade"),this.getMissedTradeNoteProcessor().catch(o=>{console.error("Failed to initialize missed trade processor:",o)}))};this.plugin.registerEvent(this.app.workspace.on("file-open",t)),this.registeredLazyHandlers.add("missed-trade")}isProcessorInitialized(t){return this.initializedProcessors.has(t)}getAllInitializedProcessors(){return{tradeNoteProcessor:this._tradeNoteProcessor,drcNoteProcessor:this._drcNoteProcessor,weeklyReviewProcessor:this._weeklyReviewProcessor,monthlyReviewProcessor:this._monthlyReviewProcessor,missedTradeNoteProcessor:this._missedTradeNoteProcessor}}cleanupProcessors(){this._tradeNoteProcessor&&(this._tradeNoteProcessor.cleanup(),this._tradeNoteProcessor=null),this._drcNoteProcessor&&(this._drcNoteProcessor.cleanup(),this._drcNoteProcessor=null),this._weeklyReviewProcessor&&(this._weeklyReviewProcessor.cleanup(),this._weeklyReviewProcessor=null),this._monthlyReviewProcessor&&(this._monthlyReviewProcessor.cleanup(),this._monthlyReviewProcessor=null),this._missedTradeNoteProcessor&&(this._missedTradeNoteProcessor.cleanup(),this._missedTradeNoteProcessor=null),this.customProcessors.forEach(t=>{t&&typeof t.cleanup=="function"&&t.cleanup()}),this.customProcessors.clear(),this.customRenderers.clear(),this.initializedProcessors.clear(),this.registeredLazyHandlers.clear()}registerProcessor(t,r){this.customProcessors.set(t,r),r&&typeof r.initialize=="function"&&r.initialize(),this.initializedProcessors.add(`${t}Processor`)}registerRenderer(t,r){this.customRenderers.set(t,r)}getRenderer(t){return this.customRenderers.has(t)?this.customRenderers.get(t):null}};var Xc=$(W());var Ht=$(W());var $t=$(W());Yt();var Uv=({dateRange:e,onChange:t})=>{let[r,n]=(0,$t.useState)(!1),i=(0,$t.useRef)(null),[o,a]=(0,$t.useState)(!1),s=(0,$t.useCallback)((f,y)=>{if(!f&&!y)return"allTime";let h=null,v=null;f&&(h=Qr(f)),y&&(v=Qr(y,!1));let b=new Date,w=Qr(b);if(h&&v&&h.getFullYear()===w.getFullYear()&&h.getMonth()===w.getMonth()&&h.getDate()===w.getDate()&&v.getFullYear()===w.getFullYear()&&v.getMonth()===w.getMonth()&&v.getDate()===w.getDate())return"today";let k=new Date(b);k.setDate(k.getDate()-1);let S=Qr(k),x=Xr(b),T=Qr(x);if(h&&v&&h.getFullYear()===S.getFullYear()&&h.getMonth()===S.getMonth()&&h.getDate()===S.getDate()&&v.getFullYear()===S.getFullYear()&&v.getMonth()===S.getMonth()&&v.getDate()===S.getDate())return"yesterday";if(h&&h.getFullYear()===T.getFullYear()&&h.getMonth()===T.getMonth()&&h.getDate()===T.getDate())return"thisWeek";let E=new Date(b.getFullYear(),b.getMonth(),1),C=Qr(E);if(h&&h.getFullYear()===C.getFullYear()&&h.getMonth()===C.getMonth()&&h.getDate()===C.getDate())return"thisMonth";let N=new Date(b.getFullYear(),0,1),D=Qr(N);return h&&h.getFullYear()===D.getFullYear()&&h.getMonth()===D.getMonth()&&h.getDate()===D.getDate()?"thisYear":f||y?"custom":null},[]),l=(0,$t.useMemo)(()=>s(e[0],e[1]),[e,s]);(0,$t.useEffect)(()=>{let f=y=>{i.current&&!i.current.contains(y.target)&&r&&n(!1)};return r&&document.addEventListener("mousedown",f),()=>{document.removeEventListener("mousedown",f)}},[r]),(0,$t.useEffect)(()=>{if(r&&i.current){let f=i.current.getBoundingClientRect(),y=360,h=window.innerWidth;f.right+y>h-20?a(!0):a(!1)}},[r]);let c=(0,$t.useCallback)(f=>{if(f){let y=Qr(f,!0);t([y,e[1]])}else t([f,e[1]])},[e,t]),d=(0,$t.useCallback)(f=>{if(f){let y=Qr(f,!1);t([e[0],y])}else t([e[0],f])},[e,t]),u=(0,$t.useCallback)(()=>{l==="custom"?n(!r):(n(!0),!e[0]&&!e[1]&&t([null,null]))},[l,r,e,t]),p=(0,$t.useCallback)(f=>{let y=new Date,h=null,v=null;if(f==="custom")if(l==="custom"){n(!r);return}else{n(!0);return}else n(!1);switch(f){case"today":h=Qr(y,!0),v=Qr(y,!1);break;case"yesterday":let b=new Date(y);b.setDate(y.getDate()-1),h=Qr(b,!0),v=Qr(b,!1);break;case"thisWeek":let w=Xr(y);h=Qr(w,!0),v=Qr(y,!1);break;case"thisMonth":let k=new Date(y.getFullYear(),y.getMonth(),1);h=Qr(k,!0),v=Qr(y,!1);break;case"thisYear":let S=new Date(y.getFullYear(),0,1);h=Qr(S,!0),v=Qr(y,!1);break;case"allTime":default:h=null,v=null;break}t([h,v])},[l,r,t]),m=(0,$t.useMemo)(()=>[{id:"today",label:"Today"},{id:"yesterday",label:"Yesterday"},{id:"thisWeek",label:"This Week"},{id:"thisMonth",label:"This Month"},{id:"thisYear",label:"This Year"},{id:"allTime",label:"All Time"},{id:"custom",label:"Custom"}],[]),g=(0,$t.useCallback)(f=>()=>p(f),[p]);return $t.default.createElement("div",{className:"journalit-dashboard-date-range-filter",ref:i},$t.default.createElement("div",{className:"journalit-dashboard-date-range-presets"},m.map(f=>$t.default.createElement("button",{key:f.id,onClick:g(f.id),className:l===f.id?"active":""},f.label))),r&&$t.default.createElement("div",{className:`journalit-dashboard-date-range-inputs journalit-dashboard-custom-date-dropdown date-dropdown-visible ${o?"position-left":""}`},$t.default.createElement("div",{className:"journalit-dashboard-date-range-start"},$t.default.createElement("label",null,"From"),$t.default.createElement(Ns,{value:e[0]||void 0,onChange:c,className:"journalit-date-picker-input"})),$t.default.createElement("div",{className:"journalit-dashboard-date-range-end"},$t.default.createElement("label",null,"To"),$t.default.createElement(Ns,{value:e[1]||void 0,onChange:d,className:"journalit-date-picker-input",minDate:e[0]||void 0}))))};var Tt=$(W());var ZM=({accounts:e,selectedAccounts:t,onChange:r})=>{let n=Ge(),[i,o]=(0,Tt.useState)([]),[a,s]=(0,Tt.useState)(!1),l=(0,Tt.useRef)(null);(0,Tt.useEffect)(()=>{if(n&&n.optionsService){let f=n.optionsService.getOptions("account");o(f);let y=()=>{let h=n.optionsService.getOptions("account");o(h)};return document.addEventListener("journalit-options-changed",y),()=>{document.removeEventListener("journalit-options-changed",y)}}},[n]);let c=(0,Tt.useMemo)(()=>[...new Set([...e,...i])],[e,i]),d=(0,Tt.useMemo)(()=>c.length>0?[{value:"select-all",label:"-- Select All --"},...c.map(y=>({value:y,label:y}))]:[],[c]);(0,Tt.useEffect)(()=>{let f=y=>{l.current&&!l.current.contains(y.target)&&s(!1)};return document.addEventListener("mousedown",f),()=>{document.removeEventListener("mousedown",f)}},[]);let u=(0,Tt.useCallback)(f=>{f==="select-all"?t.length===c.length?r([]):r([...c]):t.includes(f)?r(t.filter(y=>y!==f)):r([...t,f])},[t,c,r]),p=(0,Tt.useMemo)(()=>t.length===0||t.length===c.length?"All Accounts":t.length===1?t[0]:`${t.length} Accounts`,[t,c]),m=(0,Tt.useMemo)(()=>c.length>0,[c]),g=(0,Tt.useCallback)(()=>s(!a),[a]);return Tt.default.createElement("div",{className:"journalit-dashboard-account-filter journalit-responsive-account-filter",ref:l},Tt.default.createElement("div",{className:"journalit-dashboard-account-dropdown"},Tt.default.createElement("div",{className:"journalit-dashboard-account-summary",onClick:g},p,Tt.default.createElement("span",{className:"dropdown-arrow"},a?"\u25B2":"\u25BC")),a&&Tt.default.createElement("div",{className:"journalit-dashboard-account-options-dropdown"},m?Tt.default.createElement(Tt.default.Fragment,null,Tt.default.createElement("div",{className:"journalit-dashboard-account-option-item select-all",onClick:()=>u("select-all")},Tt.default.createElement("input",{type:"checkbox",checked:t.length===c.length,readOnly:!0}),Tt.default.createElement("span",null,"Select All")),Tt.default.createElement("div",{className:"journalit-dashboard-account-divider"}),c.map(f=>Tt.default.createElement("div",{key:f,className:"journalit-dashboard-account-option-item",onClick:()=>u(f)},Tt.default.createElement("input",{type:"checkbox",checked:t.includes(f),readOnly:!0}),Tt.default.createElement("span",null,f)))):Tt.default.createElement("div",{className:"journalit-dashboard-no-accounts"},"No accounts found"))))};var wt=$(W());var eO=({tickers:e,selectedTickers:t,onChange:r})=>{let n=Ge(),[i,o]=(0,wt.useState)([]),[a,s]=(0,wt.useState)(!1),l=(0,wt.useRef)(null);(0,wt.useEffect)(()=>{if(n&&n.optionsService){let y=n.optionsService.getOptions("instrument");o(y);let h=()=>{let v=n.optionsService.getOptions("instrument");o(v)};return document.addEventListener("journalit-options-changed",h),()=>{document.removeEventListener("journalit-options-changed",h)}}},[n]);let c=(0,wt.useMemo)(()=>[...new Set([...e,...i])],[e,i]),d=(0,wt.useMemo)(()=>c.length>0,[c]);(0,wt.useEffect)(()=>{let y=h=>{l.current&&!l.current.contains(h.target)&&s(!1)};return document.addEventListener("mousedown",y),()=>{document.removeEventListener("mousedown",y)}},[]);let u=(0,wt.useCallback)(y=>{y==="select-all"?t.length===c.length?r([]):r([...c]):t.includes(y)?r(t.filter(h=>h!==y)):r([...t,y])},[t,c,r]),p=(0,wt.useMemo)(()=>t.length===0||t.length===c.length?"All Tickers":t.length===1?t[0]:`${t.length} Tickers`,[t,c]),m=(0,wt.useCallback)(()=>s(!a),[a]),g=(0,wt.useCallback)(()=>u("select-all"),[u]),f=(0,wt.useCallback)(y=>()=>u(y),[u]);return wt.default.createElement("div",{className:"journalit-dashboard-ticker-filter journalit-responsive-ticker-filter",ref:l},wt.default.createElement("div",{className:"journalit-dashboard-ticker-dropdown"},wt.default.createElement("div",{className:"journalit-dashboard-ticker-summary",onClick:m},p,wt.default.createElement("span",{className:"dropdown-arrow"},a?"\u25B2":"\u25BC")),a&&wt.default.createElement("div",{className:"journalit-dashboard-ticker-options-dropdown"},d?wt.default.createElement(wt.default.Fragment,null,wt.default.createElement("div",{className:"journalit-dashboard-ticker-option-item select-all",onClick:g},wt.default.createElement("input",{type:"checkbox",checked:t.length===c.length,readOnly:!0}),wt.default.createElement("span",null,"Select All")),wt.default.createElement("div",{className:"journalit-dashboard-ticker-divider"}),c.map(y=>wt.default.createElement("div",{key:y,className:"journalit-dashboard-ticker-option-item",onClick:f(y)},wt.default.createElement("input",{type:"checkbox",checked:t.includes(y),readOnly:!0}),wt.default.createElement("span",null,y)))):wt.default.createElement("div",{className:"journalit-dashboard-no-tickers"},"No tickers found"))))};var _de={defaultFilters:{dateRange:[null,null],accounts:[],tickers:[]},lastUsedFilters:{dateRange:[null,null],accounts:[],tickers:[]}},Q8=e=>{var r,n,i,o,a,s;if(!e.settings.dashboard)return _de;let t=e.settings.dashboard;return{defaultFilters:{dateRange:(r=t.defaultFilters)!=null&&r.dateRange?[t.defaultFilters.dateRange[0]?new Date(t.defaultFilters.dateRange[0]):null,t.defaultFilters.dateRange[1]?new Date(t.defaultFilters.dateRange[1]):null]:[null,null],accounts:((n=t.defaultFilters)==null?void 0:n.accounts)||[],tickers:((i=t.defaultFilters)==null?void 0:i.tickers)||[]},lastUsedFilters:{dateRange:(o=t.lastUsedFilters)!=null&&o.dateRange?[t.lastUsedFilters.dateRange[0]?new Date(t.lastUsedFilters.dateRange[0]):null,t.lastUsedFilters.dateRange[1]?new Date(t.lastUsedFilters.dateRange[1]):null]:[null,null],accounts:((a=t.lastUsedFilters)==null?void 0:a.accounts)||[],tickers:((s=t.lastUsedFilters)==null?void 0:s.tickers)||[]}}},zde=async(e,t)=>{e.settings.dashboard||(e.settings.dashboard=ni.dashboard),e.settings.dashboard.defaultFilters=t.defaultFilters,e.settings.dashboard.lastUsedFilters=t.lastUsedFilters,await e.saveSettings()},aS=async(e,t)=>{let r=Q8(e);r.lastUsedFilters=t,await zde(e,r)};var Z8=e=>Q8(e).defaultFilters;Ci();var tO=({filters:e,onFilterChange:t,isEditing:r=!1,onToggleEditMode:n})=>{let i=Ge(),[o,a]=(0,Ht.useState)([]),[s,l]=(0,Ht.useState)([]),[c,d]=(0,Ht.useState)(!0),u=l_(1300);(0,Ht.useEffect)(()=>{(async()=>{d(!0);try{if(i){let v=i.tradeService,b=await v.getUniqueAccounts();a(b);let w=await v.getUniqueInstruments();l(w)}}catch(v){console.error("Error loading accounts:",v)}finally{d(!1)}})()},[i]);let p=h=>{let v={...e,dateRange:h};t(v),i&&aS(i,v)},m=h=>{let v={...e,accounts:h};t(v),i&&aS(i,v)},g=()=>{if(i){let h=Z8(i);t(h)}},f=()=>{var h;return e.dateRange[0]!==null||e.dateRange[1]!==null||e.accounts.length>0||((h=e.tickers)==null?void 0:h.length)>0},y=h=>{let v={...e,tickers:h};t(v),i&&aS(i,v)};return Ht.default.createElement("div",{className:`journalit-dashboard-filter-controls ${u?"compact-view":""}`},u?Ht.default.createElement("div",{className:"journalit-dashboard-filter-row compact medium-responsive"},Ht.default.createElement("div",{className:"journalit-dashboard-filter-section"},Ht.default.createElement(Uv,{dateRange:e.dateRange,onChange:p})),Ht.default.createElement("div",{className:"journalit-dashboard-filter-section journalit-dashboard-compact-filters"},Ht.default.createElement(eO,{tickers:s,selectedTickers:e.tickers||[],onChange:y}),Ht.default.createElement(ZM,{accounts:o,selectedAccounts:e.accounts,onChange:m})),Ht.default.createElement("div",{className:"journalit-dashboard-filter-actions button-container"},Ht.default.createElement(be,{className:"journalit-dashboard-reset-button",onClick:g,disabled:!f()||c,variant:f()?"secondary":"plain"},"Reset Filters"),n&&Ht.default.createElement(be,{className:`journalit-dashboard-edit-mode-button ${r?"active":""}`,onClick:n,variant:r?"primary":"secondary"},r?"Save Layout":"Edit Layout"))):Ht.default.createElement("div",{className:"journalit-dashboard-filter-row standard-responsive"},Ht.default.createElement("div",{className:"journalit-dashboard-date-range-section"},Ht.default.createElement(Uv,{dateRange:e.dateRange,onChange:p})),Ht.default.createElement("div",{className:"journalit-dashboard-filters-section"},Ht.default.createElement("div",{className:"journalit-dashboard-tickers-section"},Ht.default.createElement(eO,{tickers:s,selectedTickers:e.tickers||[],onChange:y})),Ht.default.createElement("div",{className:"journalit-dashboard-accounts-section"},Ht.default.createElement(ZM,{accounts:o,selectedAccounts:e.accounts,onChange:m}))),Ht.default.createElement("div",{className:"journalit-dashboard-filter-actions"},Ht.default.createElement(be,{className:"journalit-dashboard-reset-button",onClick:g,disabled:!f()||c,variant:f()?"secondary":"plain"},"Reset Filters"),n&&Ht.default.createElement(be,{className:`journalit-dashboard-edit-mode-button ${r?"active":""}`,onClick:n,variant:r?"primary":"secondary"},r?"Save Layout":"Edit Layout"))))};var Ri=$(W());var dr=$(W());var Vv={topSection:["netPnL","winRate","profitFactor","expectancy"],bottomSection:{lg:[{i:"pnlChart",x:0,y:0,w:6,h:8},{i:"performanceCalendar",x:6,y:0,w:6,h:4},{i:"dailyPerformance",x:6,y:4,w:6,h:4}],md:[{i:"pnlChart",x:0,y:0,w:6,h:6},{i:"performanceCalendar",x:0,y:6,w:6,h:3},{i:"dailyPerformance",x:0,y:9,w:6,h:3}],sm:[{i:"pnlChart",x:0,y:0,w:4,h:6},{i:"performanceCalendar",x:0,y:6,w:4,h:3},{i:"dailyPerformance",x:0,y:9,w:4,h:3}],xs:[{i:"pnlChart",x:0,y:0,w:2,h:6},{i:"performanceCalendar",x:0,y:6,w:2,h:3},{i:"dailyPerformance",x:0,y:9,w:2,h:3}],xxs:[{i:"pnlChart",x:0,y:0,w:1,h:6},{i:"performanceCalendar",x:0,y:6,w:1,h:3},{i:"dailyPerformance",x:0,y:9,w:1,h:3}]}},rO={layouts:{Default:Vv},activeLayout:"Default"},eV=e=>e.settings.dashboard?{layouts:(()=>{let r=e.settings.dashboard;if(!r)return rO.layouts;let n=r.layouts||{},i={};return Object.entries(n).forEach(([o,a])=>{var d,u;if(!(a!=null&&a.bottomSection)){i[o]=JSON.parse(JSON.stringify(Vv));return}let s=a.bottomSection,l=s.xs||((d=s.sm)==null?void 0:d.map(p=>({...p,w:Math.min(p.w,2)})))||[],c=s.xxs||((u=s.sm)==null?void 0:u.map(p=>({...p,w:1})))||[];i[o]={topSection:a.topSection||[],bottomSection:{lg:a.bottomSection.lg||[],md:a.bottomSection.md||[],sm:a.bottomSection.sm||[],xs:l,xxs:c}}}),i})(),activeLayout:e.settings.dashboard.activeLayout||rO.activeLayout}:rO;function $de(e){let t={};return Object.entries(e.layouts).forEach(([r,n])=>{t[r]={topSection:[...n.topSection],bottomSection:{lg:Xs(n.bottomSection.lg),md:Xs(n.bottomSection.md),sm:Xs(n.bottomSection.sm),xs:Xs(n.bottomSection.xs||[]),xxs:Xs(n.bottomSection.xxs||[])}}}),{layouts:t,activeLayout:e.activeLayout}}var Rde=async(e,t)=>{try{e.settings.dashboard||(e.settings.dashboard=ni.dashboard);let r=$de(t);e.settings.dashboard.layouts=r.layouts,e.settings.dashboard.activeLayout=r.activeLayout,await e.saveSettings();let n=new CustomEvent("journalit:settings-updated");document.dispatchEvent(n)}catch(r){throw console.error("Error saving layout settings:",r),r}};function Js(e){return e.map(t=>{let r=typeof t.y=="number"?t.y===1e7?1/0:t.y:0;return{...t,y:r,x:typeof t.x=="number"?t.x:0,w:typeof t.w=="number"?t.w:1,h:typeof t.h=="number"?t.h:1}})}var jn=e=>{try{let t=eV(e),r=t.activeLayout,n=t.layouts[r];if(!n)return console.warn(`Active layout '${r}' not found, using default layout`),Vv;if(!n.topSection||!n.bottomSection)return console.warn(`Active layout '${r}' is malformed, using default layout`),Vv;if(!n.bottomSection.lg||!n.bottomSection.md||!n.bottomSection.sm||!n.bottomSection.xs||!n.bottomSection.xxs){console.warn(`Active layout '${r}' is missing breakpoint layouts, fixing...`);let i={topSection:[...n.topSection],bottomSection:{lg:Js(n.bottomSection.lg||[]),md:Js(n.bottomSection.md||[]),sm:Js(n.bottomSection.sm||[]),xs:Js(n.bottomSection.xs||[]),xxs:Js(n.bottomSection.xxs||[])}};return Kn(e,r,i).catch(o=>console.error(`Failed to save fixed layout: ${o}`)),i}return{topSection:[...n.topSection],bottomSection:{lg:Js(n.bottomSection.lg||[]),md:Js(n.bottomSection.md||[]),sm:Js(n.bottomSection.sm||[]),xs:Js(n.bottomSection.xs||[]),xxs:Js(n.bottomSection.xxs||[])}}}catch(t){return console.error("Error retrieving active layout:",t),Vv}};function Xs(e){return e.map(t=>({...t,y:t.y===1/0?1e7:typeof t.y=="number"?t.y:0}))}var Kn=async(e,t,r)=>{try{let n=eV(e),i={topSection:[...r.topSection],bottomSection:{lg:Xs(r.bottomSection.lg),md:Xs(r.bottomSection.md),sm:Xs(r.bottomSection.sm),xs:Xs(r.bottomSection.xs||[]),xxs:Xs(r.bottomSection.xxs||[])}},o=new Set;Object.values(i.bottomSection).forEach(s=>{s.forEach(l=>o.add(l.i))});let a={lg:12,md:6,sm:4,xs:2,xxs:1};Object.entries(i.bottomSection).forEach(([s,l])=>{let c=new Set(l.map(d=>d.i));o.forEach(d=>{var u;if(!c.has(d)){let p;for(let m of["lg","md","sm","xs","xxs"]){let g=(u=i.bottomSection[m])==null?void 0:u.find(f=>f.i===d);if(g){p=g;break}}p&&l.push({i:d,x:0,y:1/0,w:Math.min(p.w,a[s]),h:p.h})}})}),n.layouts[t]=i,await Rde(e,n)}catch(n){throw console.error(`Error saving layout '${t}':`,n),n}};var tr=$(W());var tV=(0,tr.createContext)(null),Wde=5e3,rV=({app:e,tradeService:t,filters:r,children:n})=>{let[i,o]=(0,tr.useState)(null),[a,s]=(0,tr.useState)(!1),[l,c]=(0,tr.useState)(!1),[d,u]=(0,tr.useState)(null),[p,m]=(0,tr.useState)(0),g=(0,tr.useRef)(!1),f=(0,tr.useRef)(r),y=(0,tr.useRef)(r);tr.default.useEffect(()=>{f.current=r},[r]);let h=(0,tr.useCallback)((x,T)=>{var D,A,P,I;let E=((D=x.dateRange[0])==null?void 0:D.getTime())!==((A=T.dateRange[0])==null?void 0:A.getTime())||((P=x.dateRange[1])==null?void 0:P.getTime())!==((I=T.dateRange[1])==null?void 0:I.getTime()),C=x.accounts.length!==T.accounts.length||x.accounts.some((M,O)=>M!==T.accounts[O]),N=x.tickers.length!==T.tickers.length||x.tickers.some((M,O)=>M!==T.tickers[O]);return E||C||N},[]),v=(0,tr.useCallback)((x=Wde)=>Date.now()-p<x,[p]),b=(0,tr.useCallback)(async(x=!1)=>{if(g.current)return;let T=h(y.current,f.current);if(!(!x&&!T&&i&&v())){y.current=f.current,g.current=!0,s(!0),u(null);try{let E=await I8(e,t,f.current);o(E),m(Date.now()),c(!1)}catch(E){console.error("Error fetching dashboard data:",E),u(E instanceof Error?E:new Error("Failed to fetch dashboard data"))}finally{s(!1),c(!1),g.current=!1}}},[e,t,v,i,h]),w=(0,tr.useCallback)(x=>{if(!i)return[];switch(x){case"total-pnl":return[{label:"Total P&L",value:i.metrics.netPnL,type:"pnl"}];case"win-rate":return[{label:"Win Rate",value:i.metrics.winRate,type:"percentage"}];case"avg-win-loss":return[{label:"Avg Win",value:i.metrics.avgWin,type:"pnl"},{label:"Avg Loss",value:i.metrics.avgLoss,type:"pnl"}];case"profit-factor":return[{label:"Profit Factor",value:i.metrics.profitFactor,type:"ratio"}];case"total-trades":return[{label:"Total Trades",value:i.metrics.numTrades,type:"number"}];case"avg-rr":return[{label:"Avg RR",value:0,type:"ratio"}];default:return[]}},[i]),k=(0,tr.useCallback)(x=>{if(!i)return null;switch(x){case"pnl-chart":return i.trades||[];case"performance-calendar":return i.trades||[];case"setup-performance":return i.trades||[];case"daily-pnl":return i.trades||[];case"trade-distribution":return i.trades||[];default:return null}},[i]);tr.default.useEffect(()=>{h(y.current,r)&&i&&c(!0);let T=setTimeout(()=>{b()},100);return()=>clearTimeout(T)},[r,b,h,i]);let S=(0,tr.useMemo)(()=>({dashboardData:i,isLoading:a,isStale:l,error:d,filters:r,refreshData:()=>b(!1),getMetricData:w,getWidgetData:k,lastFetchTime:p,isCacheValid:v}),[i,a,l,d,r,b,w,k,p,v]);return tr.default.createElement(tV.Provider,{value:S},n)},ff=()=>{let e=(0,tr.useContext)(tV);if(!e)throw new Error("useDashboardData must be used within a DashboardDataProvider");return e};var gu=$(W()),nV=({name:e,value:t,isPositive:r,dollarPart:n,centsPart:i,isCurrency:o=!1})=>gu.default.createElement("div",{className:"journalit-dashboard-metric-card",style:{flex:"1 1 180px",minWidth:"180px",maxWidth:"300px",backgroundColor:"transparent",padding:"14px",borderRadius:"8px",border:"1px solid rgba(var(--background-modifier-border-rgb, 0, 0, 0), 0.08)",boxShadow:"0 2px 8px rgba(0, 0, 0, 0.04), 0 0 1px rgba(0, 0, 0, 0.08)",display:"flex",flexDirection:"column"}},gu.default.createElement("div",{className:"journalit-dashboard-metric-name",style:{textTransform:"uppercase",fontSize:"14px",fontWeight:"600",letterSpacing:"0.5px",marginBottom:"6px",textAlign:"left",width:"100%"}},e),gu.default.createElement("div",{className:`journalit-dashboard-metric-value ${r!==void 0?r?"positive":"negative":""}`,style:{fontSize:"24px",fontWeight:"600",textAlign:"left",width:"100%"}},o&&n&&i?gu.default.createElement(gu.default.Fragment,null,n,gu.default.createElement("span",{className:"journalit-dashboard-metric-cents",style:{fontSize:"16px",opacity:"0.7",fontWeight:"500",marginLeft:"1px"}},i)):t));var ae=$(W()),xu=$(ul());var qr=$(W());function oV(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,qr.useMemo)(()=>n=>{t.forEach(i=>i(n))},t)}var Hv=typeof window!="undefined"&&typeof window.document!="undefined"&&typeof window.document.createElement!="undefined";function hu(e){let t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function sS(e){return"nodeType"in e}function zi(e){var t,r;return e?hu(e)?e:sS(e)&&(t=(r=e.ownerDocument)==null?void 0:r.defaultView)!=null?t:window:window}function lS(e){let{Document:t}=zi(e);return e instanceof t}function gf(e){return hu(e)?!1:e instanceof zi(e).HTMLElement}function iO(e){return e instanceof zi(e).SVGElement}function vu(e){return e?hu(e)?e.document:sS(e)?lS(e)?e:gf(e)||iO(e)?e.ownerDocument:document:document:document}var Na=Hv?qr.useLayoutEffect:qr.useEffect;function cS(e){let t=(0,qr.useRef)(e);return Na(()=>{t.current=e}),(0,qr.useCallback)(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return t.current==null?void 0:t.current(...n)},[])}function aV(){let e=(0,qr.useRef)(null),t=(0,qr.useCallback)((n,i)=>{e.current=setInterval(n,i)},[]),r=(0,qr.useCallback)(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,r]}function hf(e,t){t===void 0&&(t=[e]);let r=(0,qr.useRef)(e);return Na(()=>{r.current!==e&&(r.current=e)},t),r}function vf(e,t){let r=(0,qr.useRef)();return(0,qr.useMemo)(()=>{let n=e(r.current);return r.current=n,n},[...t])}function qv(e){let t=cS(e),r=(0,qr.useRef)(null),n=(0,qr.useCallback)(i=>{i!==r.current&&(t==null||t(i,r.current)),r.current=i},[]);return[r,n]}function dS(e){let t=(0,qr.useRef)();return(0,qr.useEffect)(()=>{t.current=e},[e]),t.current}var nO={};function yu(e,t){return(0,qr.useMemo)(()=>{if(t)return t;let r=nO[e]==null?0:nO[e]+1;return nO[e]=r,e+"-"+r},[e,t])}function sV(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n.reduce((o,a)=>{let s=Object.entries(a);for(let[l,c]of s){let d=o[l];d!=null&&(o[l]=d+e*c)}return o},{...t})}}var bu=sV(1),yf=sV(-1);function Bde(e){return"clientX"in e&&"clientY"in e}function Gv(e){if(!e)return!1;let{KeyboardEvent:t}=zi(e.target);return t&&e instanceof t}function Ude(e){if(!e)return!1;let{TouchEvent:t}=zi(e.target);return t&&e instanceof t}function uS(e){if(Ude(e)){if(e.touches&&e.touches.length){let{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}else if(e.changedTouches&&e.changedTouches.length){let{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return Bde(e)?{x:e.clientX,y:e.clientY}:null}var Hc=Object.freeze({Translate:{toString(e){if(!e)return;let{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;let{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[Hc.Translate.toString(e),Hc.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:n}=e;return t+" "+r+"ms "+n}}}),iV="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function lV(e){return e.matches(iV)?e:e.querySelector(iV)}var wu=$(W()),Vde={display:"none"};function cV(e){let{id:t,value:r}=e;return wu.default.createElement("div",{id:t,style:Vde},r)}function dV(e){let{id:t,announcement:r,ariaLiveType:n="assertive"}=e,i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return wu.default.createElement("div",{id:t,style:i,role:"status","aria-live":n,"aria-atomic":!0},r)}function uV(){let[e,t]=(0,wu.useState)("");return{announce:(0,wu.useCallback)(n=>{n!=null&&t(n)},[]),announcement:e}}var SV=(0,ae.createContext)(null);function Hde(e){let t=(0,ae.useContext)(SV);(0,ae.useEffect)(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function qde(){let[e]=(0,ae.useState)(()=>new Set),t=(0,ae.useCallback)(n=>(e.add(n),()=>e.delete(n)),[e]);return[(0,ae.useCallback)(n=>{let{type:i,event:o}=n;e.forEach(a=>{var s;return(s=a[i])==null?void 0:s.call(a,o)})},[e]),t]}var Gde={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Yde={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function Kde(e){let{announcements:t=Yde,container:r,hiddenTextDescribedById:n,screenReaderInstructions:i=Gde}=e,{announce:o,announcement:a}=uV(),s=yu("DndLiveRegion"),[l,c]=(0,ae.useState)(!1);if((0,ae.useEffect)(()=>{c(!0)},[]),Hde((0,ae.useMemo)(()=>({onDragStart(u){let{active:p}=u;o(t.onDragStart({active:p}))},onDragMove(u){let{active:p,over:m}=u;t.onDragMove&&o(t.onDragMove({active:p,over:m}))},onDragOver(u){let{active:p,over:m}=u;o(t.onDragOver({active:p,over:m}))},onDragEnd(u){let{active:p,over:m}=u;o(t.onDragEnd({active:p,over:m}))},onDragCancel(u){let{active:p,over:m}=u;o(t.onDragCancel({active:p,over:m}))}}),[o,t])),!l)return null;let d=ae.default.createElement(ae.default.Fragment,null,ae.default.createElement(cV,{id:n,value:i.draggable}),ae.default.createElement(dV,{id:s,announcement:a}));return r?(0,xu.createPortal)(d,r):d}var kn;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(kn||(kn={}));function mS(){}var ps=Object.freeze({x:0,y:0});function Jde(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Xde(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return r-n}function Qde(e,t){let{data:{value:r}}=e,{data:{value:n}}=t;return n-r}function TV(e,t){if(!e||e.length===0)return null;let[r]=e;return t?r[t]:r}function pV(e,t,r){return t===void 0&&(t=e.left),r===void 0&&(r=e.top),{x:t+e.width*.5,y:r+e.height*.5}}var CV=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e,i=pV(t,t.left,t.top),o=[];for(let a of n){let{id:s}=a,l=r.get(s);if(l){let c=Jde(pV(l),i);o.push({id:s,data:{droppableContainer:a,value:c}})}}return o.sort(Xde)};function Zde(e,t){let r=Math.max(t.top,e.top),n=Math.max(t.left,e.left),i=Math.min(t.left+t.width,e.left+e.width),o=Math.min(t.top+t.height,e.top+e.height),a=i-n,s=o-r;if(n<i&&r<o){let l=t.width*t.height,c=e.width*e.height,d=a*s,u=d/(l+c-d);return Number(u.toFixed(4))}return 0}var eue=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:n}=e,i=[];for(let o of n){let{id:a}=o,s=r.get(a);if(s){let l=Zde(s,t);l>0&&i.push({id:a,data:{droppableContainer:o,value:l}})}}return i.sort(Qde)};function tue(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}function EV(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:ps}function rue(e){return function(r){for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return i.reduce((a,s)=>({...a,top:a.top+e*s.y,bottom:a.bottom+e*s.y,left:a.left+e*s.x,right:a.right+e*s.x}),{...r})}}var nue=rue(1);function iue(e){if(e.startsWith("matrix3d(")){let t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){let t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function oue(e,t,r){let n=iue(t);if(!n)return e;let{scaleX:i,scaleY:o,x:a,y:s}=n,l=e.left-a-(1-i)*parseFloat(r),c=e.top-s-(1-o)*parseFloat(r.slice(r.indexOf(" ")+1)),d=i?e.width/i:e.width,u=o?e.height/o:e.height;return{width:d,height:u,top:c,right:l+d,bottom:c+u,left:l}}var aue={ignoreTransform:!1};function Tu(e,t){t===void 0&&(t=aue);let r=e.getBoundingClientRect();if(t.ignoreTransform){let{transform:c,transformOrigin:d}=zi(e).getComputedStyle(e);c&&(r=oue(r,c,d))}let{top:n,left:i,width:o,height:a,bottom:s,right:l}=r;return{top:n,left:i,width:o,height:a,bottom:s,right:l}}function mV(e){return Tu(e,{ignoreTransform:!0})}function sue(e){let t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}function lue(e,t){return t===void 0&&(t=zi(e).getComputedStyle(e)),t.position==="fixed"}function cue(e,t){t===void 0&&(t=zi(e).getComputedStyle(e));let r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{let o=t[i];return typeof o=="string"?r.test(o):!1})}function vS(e,t){let r=[];function n(i){if(t!=null&&r.length>=t||!i)return r;if(lS(i)&&i.scrollingElement!=null&&!r.includes(i.scrollingElement))return r.push(i.scrollingElement),r;if(!gf(i)||iO(i)||r.includes(i))return r;let o=zi(e).getComputedStyle(i);return i!==e&&cue(i,o)&&r.push(i),lue(i,o)?r:n(i.parentNode)}return e?n(e):r}function DV(e){let[t]=vS(e,1);return t!=null?t:null}function oO(e){return!Hv||!e?null:hu(e)?e:sS(e)?lS(e)||e===vu(e).scrollingElement?window:gf(e)?e:null:null}function PV(e){return hu(e)?e.scrollX:e.scrollLeft}function AV(e){return hu(e)?e.scrollY:e.scrollTop}function lO(e){return{x:PV(e),y:AV(e)}}var Ln;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(Ln||(Ln={}));function NV(e){return!Hv||!e?!1:e===document.scrollingElement}function MV(e){let t={x:0,y:0},r=NV(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},n={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height},i=e.scrollTop<=t.y,o=e.scrollLeft<=t.x,a=e.scrollTop>=n.y,s=e.scrollLeft>=n.x;return{isTop:i,isLeft:o,isBottom:a,isRight:s,maxScroll:n,minScroll:t}}var due={x:.2,y:.2};function uue(e,t,r,n,i){let{top:o,left:a,right:s,bottom:l}=r;n===void 0&&(n=10),i===void 0&&(i=due);let{isTop:c,isBottom:d,isLeft:u,isRight:p}=MV(e),m={x:0,y:0},g={x:0,y:0},f={height:t.height*i.y,width:t.width*i.x};return!c&&o<=t.top+f.height?(m.y=Ln.Backward,g.y=n*Math.abs((t.top+f.height-o)/f.height)):!d&&l>=t.bottom-f.height&&(m.y=Ln.Forward,g.y=n*Math.abs((t.bottom-f.height-l)/f.height)),!p&&s>=t.right-f.width?(m.x=Ln.Forward,g.x=n*Math.abs((t.right-f.width-s)/f.width)):!u&&a<=t.left+f.width&&(m.x=Ln.Backward,g.x=n*Math.abs((t.left+f.width-a)/f.width)),{direction:m,speed:g}}function pue(e){if(e===document.scrollingElement){let{innerWidth:o,innerHeight:a}=window;return{top:0,left:0,right:o,bottom:a,width:o,height:a}}let{top:t,left:r,right:n,bottom:i}=e.getBoundingClientRect();return{top:t,left:r,right:n,bottom:i,width:e.clientWidth,height:e.clientHeight}}function OV(e){return e.reduce((t,r)=>bu(t,lO(r)),ps)}function mue(e){return e.reduce((t,r)=>t+PV(r),0)}function fue(e){return e.reduce((t,r)=>t+AV(r),0)}function gue(e,t){if(t===void 0&&(t=Tu),!e)return;let{top:r,left:n,bottom:i,right:o}=t(e);DV(e)&&(i<=0||o<=0||r>=window.innerHeight||n>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}var hue=[["x",["left","right"],mue],["y",["top","bottom"],fue]],Kv=class{constructor(t,r){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;let n=vS(r),i=OV(n);this.rect={...t},this.width=t.width,this.height=t.height;for(let[o,a,s]of hue)for(let l of a)Object.defineProperty(this,l,{get:()=>{let c=s(n),d=i[o]-c;return this.rect[l]+d},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}},ku=class{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(r=>{var n;return(n=this.target)==null?void 0:n.removeEventListener(...r)})},this.target=t}add(t,r,n){var i;(i=this.target)==null||i.addEventListener(t,r,n),this.listeners.push([t,r,n])}};function vue(e){let{EventTarget:t}=zi(e);return e instanceof t?e:vu(e)}function aO(e,t){let r=Math.abs(e.x),n=Math.abs(e.y);return typeof t=="number"?Math.sqrt(r**2+n**2)>t:"x"in t&&"y"in t?r>t.x&&n>t.y:"x"in t?r>t.x:"y"in t?n>t.y:!1}var Ma;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Ma||(Ma={}));function fV(e){e.preventDefault()}function yue(e){e.stopPropagation()}var Ct;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Ct||(Ct={}));var IV={start:[Ct.Space,Ct.Enter],cancel:[Ct.Esc],end:[Ct.Space,Ct.Enter,Ct.Tab]},bue=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case Ct.Right:return{...r,x:r.x+25};case Ct.Left:return{...r,x:r.x-25};case Ct.Down:return{...r,y:r.y+25};case Ct.Up:return{...r,y:r.y-25}}},fS=class{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;let{event:{target:r}}=t;this.props=t,this.listeners=new ku(vu(r)),this.windowListeners=new ku(zi(r)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Ma.Resize,this.handleCancel),this.windowListeners.add(Ma.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Ma.Keydown,this.handleKeyDown))}handleStart(){let{activeNode:t,onStart:r}=this.props,n=t.node.current;n&&gue(n),r(ps)}handleKeyDown(t){if(Gv(t)){let{active:r,context:n,options:i}=this.props,{keyboardCodes:o=IV,coordinateGetter:a=bue,scrollBehavior:s="smooth"}=i,{code:l}=t;if(o.end.includes(l)){this.handleEnd(t);return}if(o.cancel.includes(l)){this.handleCancel(t);return}let{collisionRect:c}=n.current,d=c?{x:c.left,y:c.top}:ps;this.referenceCoordinates||(this.referenceCoordinates=d);let u=a(t,{active:r,context:n.current,currentCoordinates:d});if(u){let p=yf(u,d),m={x:0,y:0},{scrollableAncestors:g}=n.current;for(let f of g){let y=t.code,{isTop:h,isRight:v,isLeft:b,isBottom:w,maxScroll:k,minScroll:S}=MV(f),x=pue(f),T={x:Math.min(y===Ct.Right?x.right-x.width/2:x.right,Math.max(y===Ct.Right?x.left:x.left+x.width/2,u.x)),y:Math.min(y===Ct.Down?x.bottom-x.height/2:x.bottom,Math.max(y===Ct.Down?x.top:x.top+x.height/2,u.y))},E=y===Ct.Right&&!v||y===Ct.Left&&!b,C=y===Ct.Down&&!w||y===Ct.Up&&!h;if(E&&T.x!==u.x){let N=f.scrollLeft+p.x,D=y===Ct.Right&&N<=k.x||y===Ct.Left&&N>=S.x;if(D&&!p.y){f.scrollTo({left:N,behavior:s});return}D?m.x=f.scrollLeft-N:m.x=y===Ct.Right?f.scrollLeft-k.x:f.scrollLeft-S.x,m.x&&f.scrollBy({left:-m.x,behavior:s});break}else if(C&&T.y!==u.y){let N=f.scrollTop+p.y,D=y===Ct.Down&&N<=k.y||y===Ct.Up&&N>=S.y;if(D&&!p.x){f.scrollTo({top:N,behavior:s});return}D?m.y=f.scrollTop-N:m.y=y===Ct.Down?f.scrollTop-k.y:f.scrollTop-S.y,m.y&&f.scrollBy({top:-m.y,behavior:s});break}}this.handleMove(t,bu(yf(u,this.referenceCoordinates),m))}}}handleMove(t,r){let{onMove:n}=this.props;t.preventDefault(),n(r)}handleEnd(t){let{onEnd:r}=this.props;t.preventDefault(),this.detach(),r()}handleCancel(t){let{onCancel:r}=this.props;t.preventDefault(),this.detach(),r()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}};fS.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:n=IV,onActivation:i}=t,{active:o}=r,{code:a}=e.nativeEvent;if(n.start.includes(a)){let s=o.activatorNode.current;return s&&e.target!==s?!1:(e.preventDefault(),i==null||i({event:e.nativeEvent}),!0)}return!1}}];function gV(e){return!!(e&&"distance"in e)}function hV(e){return!!(e&&"delay"in e)}var Jv=class{constructor(t,r,n){var i;n===void 0&&(n=vue(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=r;let{event:o}=t,{target:a}=o;this.props=t,this.events=r,this.document=vu(a),this.documentListeners=new ku(this.document),this.listeners=new ku(n),this.windowListeners=new ku(zi(a)),this.initialCoordinates=(i=uS(o))!=null?i:ps,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){let{events:t,props:{options:{activationConstraint:r,bypassActivationConstraint:n}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Ma.Resize,this.handleCancel),this.windowListeners.add(Ma.DragStart,fV),this.windowListeners.add(Ma.VisibilityChange,this.handleCancel),this.windowListeners.add(Ma.ContextMenu,fV),this.documentListeners.add(Ma.Keydown,this.handleKeydown),r){if(n!=null&&n({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(hV(r)){this.timeoutId=setTimeout(this.handleStart,r.delay),this.handlePending(r);return}if(gV(r)){this.handlePending(r);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,r){let{active:n,onPending:i}=this.props;i(n,t,this.initialCoordinates,r)}handleStart(){let{initialCoordinates:t}=this,{onStart:r}=this.props;t&&(this.activated=!0,this.documentListeners.add(Ma.Click,yue,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Ma.SelectionChange,this.removeTextSelection),r(t))}handleMove(t){var r;let{activated:n,initialCoordinates:i,props:o}=this,{onMove:a,options:{activationConstraint:s}}=o;if(!i)return;let l=(r=uS(t))!=null?r:ps,c=yf(i,l);if(!n&&s){if(gV(s)){if(s.tolerance!=null&&aO(c,s.tolerance))return this.handleCancel();if(aO(c,s.distance))return this.handleStart()}if(hV(s)&&aO(c,s.tolerance))return this.handleCancel();this.handlePending(s,c);return}t.cancelable&&t.preventDefault(),a(l)}handleEnd(){let{onAbort:t,onEnd:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleCancel(){let{onAbort:t,onCancel:r}=this.props;this.detach(),this.activated||t(this.props.active),r()}handleKeydown(t){t.code===Ct.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}},wue={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}},gS=class extends Jv{constructor(t){let{event:r}=t,n=vu(r.target);super(t,wue,n)}};gS.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return!r.isPrimary||r.button!==0?!1:(n==null||n({event:r}),!0)}}];var xue={move:{name:"mousemove"},end:{name:"mouseup"}},cO;(function(e){e[e.RightClick=2]="RightClick"})(cO||(cO={}));var dO=class extends Jv{constructor(t){super(t,xue,vu(t.event.target))}};dO.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t;return r.button===cO.RightClick?!1:(n==null||n({event:r}),!0)}}];var sO={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}},uO=class extends Jv{constructor(t){super(t,sO)}static setup(){return window.addEventListener(sO.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(sO.move.name,t)};function t(){}}};uO.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:n}=t,{touches:i}=r;return i.length>1?!1:(n==null||n({event:r}),!0)}}];var Yv;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Yv||(Yv={}));var hS;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(hS||(hS={}));function kue(e){let{acceleration:t,activator:r=Yv.Pointer,canScroll:n,draggingRect:i,enabled:o,interval:a=5,order:s=hS.TreeOrder,pointerCoordinates:l,scrollableAncestors:c,scrollableAncestorRects:d,delta:u,threshold:p}=e,m=Tue({delta:u,disabled:!o}),[g,f]=aV(),y=(0,ae.useRef)({x:0,y:0}),h=(0,ae.useRef)({x:0,y:0}),v=(0,ae.useMemo)(()=>{switch(r){case Yv.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case Yv.DraggableRect:return i}},[r,i,l]),b=(0,ae.useRef)(null),w=(0,ae.useCallback)(()=>{let S=b.current;if(!S)return;let x=y.current.x*h.current.x,T=y.current.y*h.current.y;S.scrollBy(x,T)},[]),k=(0,ae.useMemo)(()=>s===hS.TreeOrder?[...c].reverse():c,[s,c]);(0,ae.useEffect)(()=>{if(!o||!c.length||!v){f();return}for(let S of k){if((n==null?void 0:n(S))===!1)continue;let x=c.indexOf(S),T=d[x];if(!T)continue;let{direction:E,speed:C}=uue(S,T,v,t,p);for(let N of["x","y"])m[N][E[N]]||(C[N]=0,E[N]=0);if(C.x>0||C.y>0){f(),b.current=S,g(w,a),y.current=C,h.current=E;return}}y.current={x:0,y:0},h.current={x:0,y:0},f()},[t,w,n,f,o,a,JSON.stringify(v),JSON.stringify(m),g,c,k,d,JSON.stringify(p)])}var Sue={x:{[Ln.Backward]:!1,[Ln.Forward]:!1},y:{[Ln.Backward]:!1,[Ln.Forward]:!1}};function Tue(e){let{delta:t,disabled:r}=e,n=dS(t);return vf(i=>{if(r||!n||!i)return Sue;let o={x:Math.sign(t.x-n.x),y:Math.sign(t.y-n.y)};return{x:{[Ln.Backward]:i.x[Ln.Backward]||o.x===-1,[Ln.Forward]:i.x[Ln.Forward]||o.x===1},y:{[Ln.Backward]:i.y[Ln.Backward]||o.y===-1,[Ln.Forward]:i.y[Ln.Forward]||o.y===1}}},[r,t,n])}function Cue(e,t){let r=t!=null?e.get(t):void 0,n=r?r.node.current:null;return vf(i=>{var o;return t==null?null:(o=n!=null?n:i)!=null?o:null},[n,t])}function Eue(e,t){return(0,ae.useMemo)(()=>e.reduce((r,n)=>{let{sensor:i}=n,o=i.activators.map(a=>({eventName:a.eventName,handler:t(a.handler,n)}));return[...r,...o]},[]),[e,t])}var Xv;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Xv||(Xv={}));var pO;(function(e){e.Optimized="optimized"})(pO||(pO={}));var vV=new Map;function Due(e,t){let{dragging:r,dependencies:n,config:i}=t,[o,a]=(0,ae.useState)(null),{frequency:s,measure:l,strategy:c}=i,d=(0,ae.useRef)(e),u=y(),p=hf(u),m=(0,ae.useCallback)(function(h){h===void 0&&(h=[]),!p.current&&a(v=>v===null?h:v.concat(h.filter(b=>!v.includes(b))))},[p]),g=(0,ae.useRef)(null),f=vf(h=>{if(u&&!r)return vV;if(!h||h===vV||d.current!==e||o!=null){let v=new Map;for(let b of e){if(!b)continue;if(o&&o.length>0&&!o.includes(b.id)&&b.rect.current){v.set(b.id,b.rect.current);continue}let w=b.node.current,k=w?new Kv(l(w),w):null;b.rect.current=k,k&&v.set(b.id,k)}return v}return h},[e,o,r,u,l]);return(0,ae.useEffect)(()=>{d.current=e},[e]),(0,ae.useEffect)(()=>{u||m()},[r,u]),(0,ae.useEffect)(()=>{o&&o.length>0&&a(null)},[JSON.stringify(o)]),(0,ae.useEffect)(()=>{u||typeof s!="number"||g.current!==null||(g.current=setTimeout(()=>{m(),g.current=null},s))},[s,u,m,...n]),{droppableRects:f,measureDroppableContainers:m,measuringScheduled:o!=null};function y(){switch(c){case Xv.Always:return!1;case Xv.BeforeDragging:return r;default:return!r}}}function FV(e,t){return vf(r=>e?r||(typeof t=="function"?t(e):e):null,[t,e])}function Pue(e,t){return FV(e,t)}function Aue(e){let{callback:t,disabled:r}=e,n=cS(t),i=(0,ae.useMemo)(()=>{if(r||typeof window=="undefined"||typeof window.MutationObserver=="undefined")return;let{MutationObserver:o}=window;return new o(n)},[n,r]);return(0,ae.useEffect)(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function yS(e){let{callback:t,disabled:r}=e,n=cS(t),i=(0,ae.useMemo)(()=>{if(r||typeof window=="undefined"||typeof window.ResizeObserver=="undefined")return;let{ResizeObserver:o}=window;return new o(n)},[r]);return(0,ae.useEffect)(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function Nue(e){return new Kv(Tu(e),e)}function yV(e,t,r){t===void 0&&(t=Nue);let[n,i]=(0,ae.useState)(null);function o(){i(l=>{if(!e)return null;if(e.isConnected===!1){var c;return(c=l!=null?l:r)!=null?c:null}let d=t(e);return JSON.stringify(l)===JSON.stringify(d)?l:d})}let a=Aue({callback(l){if(e)for(let c of l){let{type:d,target:u}=c;if(d==="childList"&&u instanceof HTMLElement&&u.contains(e)){o();break}}}}),s=yS({callback:o});return Na(()=>{o(),e?(s==null||s.observe(e),a==null||a.observe(document.body,{childList:!0,subtree:!0})):(s==null||s.disconnect(),a==null||a.disconnect())},[e]),n}function Mue(e){let t=FV(e);return EV(e,t)}var bV=[];function Oue(e){let t=(0,ae.useRef)(e),r=vf(n=>e?n&&n!==bV&&e&&t.current&&e.parentNode===t.current.parentNode?n:vS(e):bV,[e]);return(0,ae.useEffect)(()=>{t.current=e},[e]),r}function Iue(e){let[t,r]=(0,ae.useState)(null),n=(0,ae.useRef)(e),i=(0,ae.useCallback)(o=>{let a=oO(o.target);a&&r(s=>s?(s.set(a,lO(a)),new Map(s)):null)},[]);return(0,ae.useEffect)(()=>{let o=n.current;if(e!==o){a(o);let s=e.map(l=>{let c=oO(l);return c?(c.addEventListener("scroll",i,{passive:!0}),[c,lO(c)]):null}).filter(l=>l!=null);r(s.length?new Map(s):null),n.current=e}return()=>{a(e),a(o)};function a(s){s.forEach(l=>{let c=oO(l);c==null||c.removeEventListener("scroll",i)})}},[i,e]),(0,ae.useMemo)(()=>e.length?t?Array.from(t.values()).reduce((o,a)=>bu(o,a),ps):OV(e):ps,[e,t])}function wV(e,t){t===void 0&&(t=[]);let r=(0,ae.useRef)(null);return(0,ae.useEffect)(()=>{r.current=null},t),(0,ae.useEffect)(()=>{let n=e!==ps;n&&!r.current&&(r.current=e),!n&&r.current&&(r.current=null)},[e]),r.current?yf(e,r.current):ps}function Fue(e){(0,ae.useEffect)(()=>{if(!Hv)return;let t=e.map(r=>{let{sensor:n}=r;return n.setup==null?void 0:n.setup()});return()=>{for(let r of t)r==null||r()}},e.map(t=>{let{sensor:r}=t;return r}))}function jue(e,t){return(0,ae.useMemo)(()=>e.reduce((r,n)=>{let{eventName:i,handler:o}=n;return r[i]=a=>{o(a,t)},r},{}),[e,t])}function jV(e){return(0,ae.useMemo)(()=>e?sue(e):null,[e])}var xV=[];function Lue(e,t){t===void 0&&(t=Tu);let[r]=e,n=jV(r?zi(r):null),[i,o]=(0,ae.useState)(xV);function a(){o(()=>e.length?e.map(l=>NV(l)?n:new Kv(t(l),l)):xV)}let s=yS({callback:a});return Na(()=>{s==null||s.disconnect(),a(),e.forEach(l=>s==null?void 0:s.observe(l))},[e]),i}function _ue(e){if(!e)return null;if(e.children.length>1)return e;let t=e.children[0];return gf(t)?t:e}function zue(e){let{measure:t}=e,[r,n]=(0,ae.useState)(null),i=(0,ae.useCallback)(c=>{for(let{target:d}of c)if(gf(d)){n(u=>{let p=t(d);return u?{...u,width:p.width,height:p.height}:p});break}},[t]),o=yS({callback:i}),a=(0,ae.useCallback)(c=>{let d=_ue(c);o==null||o.disconnect(),d&&(o==null||o.observe(d)),n(d?t(d):null)},[t,o]),[s,l]=qv(a);return(0,ae.useMemo)(()=>({nodeRef:s,rect:r,setRef:l}),[r,s,l])}var $ue=[{sensor:gS,options:{}},{sensor:fS,options:{}}],Rue={current:{}},pS={draggable:{measure:mV},droppable:{measure:mV,strategy:Xv.WhileDragging,frequency:pO.Optimized},dragOverlay:{measure:Tu}},Su=class extends Map{get(t){var r;return t!=null&&(r=super.get(t))!=null?r:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:r}=t;return!r})}getNodeFor(t){var r,n;return(r=(n=this.get(t))==null?void 0:n.node.current)!=null?r:void 0}},Wue={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Su,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:mS},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:pS,measureDroppableContainers:mS,windowRect:null,measuringScheduled:!1},Bue={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:mS,draggableNodes:new Map,over:null,measureDroppableContainers:mS},bS=(0,ae.createContext)(Bue),LV=(0,ae.createContext)(Wue);function Uue(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Su}}}function Vue(e,t){switch(t.type){case kn.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case kn.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case kn.DragEnd:case kn.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case kn.RegisterDroppable:{let{element:r}=t,{id:n}=r,i=new Su(e.droppable.containers);return i.set(n,r),{...e,droppable:{...e.droppable,containers:i}}}case kn.SetDroppableDisabled:{let{id:r,key:n,disabled:i}=t,o=e.droppable.containers.get(r);if(!o||n!==o.key)return e;let a=new Su(e.droppable.containers);return a.set(r,{...o,disabled:i}),{...e,droppable:{...e.droppable,containers:a}}}case kn.UnregisterDroppable:{let{id:r,key:n}=t,i=e.droppable.containers.get(r);if(!i||n!==i.key)return e;let o=new Su(e.droppable.containers);return o.delete(r),{...e,droppable:{...e.droppable,containers:o}}}default:return e}}function Hue(e){let{disabled:t}=e,{active:r,activatorEvent:n,draggableNodes:i}=(0,ae.useContext)(bS),o=dS(n),a=dS(r==null?void 0:r.id);return(0,ae.useEffect)(()=>{if(!t&&!n&&o&&a!=null){if(!Gv(o)||document.activeElement===o.target)return;let s=i.get(a);if(!s)return;let{activatorNode:l,node:c}=s;if(!l.current&&!c.current)return;requestAnimationFrame(()=>{for(let d of[l.current,c.current]){if(!d)continue;let u=lV(d);if(u){u.focus();break}}})}},[n,t,i,a,o]),null}function que(e,t){let{transform:r,...n}=t;return e!=null&&e.length?e.reduce((i,o)=>o({transform:i,...n}),r):r}function Gue(e){return(0,ae.useMemo)(()=>({draggable:{...pS.draggable,...e==null?void 0:e.draggable},droppable:{...pS.droppable,...e==null?void 0:e.droppable},dragOverlay:{...pS.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function Yue(e){let{activeNode:t,measure:r,initialRect:n,config:i=!0}=e,o=(0,ae.useRef)(!1),{x:a,y:s}=typeof i=="boolean"?{x:i,y:i}:i;Na(()=>{if(!a&&!s||!t){o.current=!1;return}if(o.current||!n)return;let c=t==null?void 0:t.node.current;if(!c||c.isConnected===!1)return;let d=r(c),u=EV(d,n);if(a||(u.x=0),s||(u.y=0),o.current=!0,Math.abs(u.x)>0||Math.abs(u.y)>0){let p=DV(c);p&&p.scrollBy({top:u.y,left:u.x})}},[t,a,s,n,r])}var _V=(0,ae.createContext)({...ps,scaleX:1,scaleY:1}),qc;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(qc||(qc={}));var zV=(0,ae.memo)(function(t){var r,n,i,o;let{id:a,accessibility:s,autoScroll:l=!0,children:c,sensors:d=$ue,collisionDetection:u=eue,measuring:p,modifiers:m,...g}=t,f=(0,ae.useReducer)(Vue,void 0,Uue),[y,h]=f,[v,b]=qde(),[w,k]=(0,ae.useState)(qc.Uninitialized),S=w===qc.Initialized,{draggable:{active:x,nodes:T,translate:E},droppable:{containers:C}}=y,N=x!=null?T.get(x):null,D=(0,ae.useRef)({initial:null,translated:null}),A=(0,ae.useMemo)(()=>{var Xn;return x!=null?{id:x,data:(Xn=N==null?void 0:N.data)!=null?Xn:Rue,rect:D}:null},[x,N]),P=(0,ae.useRef)(null),[I,M]=(0,ae.useState)(null),[O,F]=(0,ae.useState)(null),L=hf(g,Object.values(g)),B=yu("DndDescribedBy",a),j=(0,ae.useMemo)(()=>C.getEnabled(),[C]),_=Gue(p),{droppableRects:H,measureDroppableContainers:q,measuringScheduled:X}=Due(j,{dragging:S,dependencies:[E.x,E.y],config:_.droppable}),U=Cue(T,x),Y=(0,ae.useMemo)(()=>O?uS(O):null,[O]),R=IG(),V=Pue(U,_.draggable.measure);Yue({activeNode:x!=null?T.get(x):null,config:R.layoutShiftCompensation,initialRect:V,measure:_.draggable.measure});let G=yV(U,_.draggable.measure,V),J=yV(U?U.parentElement:null),K=(0,ae.useRef)({activatorEvent:null,active:null,activeNode:U,collisionRect:null,collisions:null,droppableRects:H,draggableNodes:T,draggingNode:null,draggingNodeRect:null,droppableContainers:C,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),ne=C.getNodeFor((r=K.current.over)==null?void 0:r.id),te=zue({measure:_.dragOverlay.measure}),oe=(n=te.nodeRef.current)!=null?n:U,de=S?(i=te.rect)!=null?i:G:null,xe=!!(te.nodeRef.current&&te.rect),je=Mue(xe?null:G),nt=jV(oe?zi(oe):null),Qe=Oue(S?ne!=null?ne:U:null),ze=Lue(Qe),Rr=que(m,{transform:{x:E.x-je.x,y:E.y-je.y,scaleX:1,scaleY:1},activatorEvent:O,active:A,activeNodeRect:G,containerNodeRect:J,draggingNodeRect:de,over:K.current.over,overlayNodeRect:te.rect,scrollableAncestors:Qe,scrollableAncestorRects:ze,windowRect:nt}),nr=Y?bu(Y,E):null,ft=Iue(Qe),sn=wV(ft),Zs=wV(ft,[G]),ys=bu(Rr,sn),Lu=de?nue(de,Rr):null,Rf=A&&Lu?u({active:A,collisionRect:Lu,droppableRects:H,droppableContainers:j,pointerCoordinates:nr}):null,II=TV(Rf,"id"),[Vl,FI]=(0,ae.useState)(null),PG=xe?Rr:bu(Rr,Zs),AG=tue(PG,(o=Vl==null?void 0:Vl.rect)!=null?o:null,G),uT=(0,ae.useRef)(null),jI=(0,ae.useCallback)((Xn,vo)=>{let{sensor:yo,options:Hl}=vo;if(P.current==null)return;let Jo=T.get(P.current);if(!Jo)return;let bo=Xn.nativeEvent,bs=new yo({active:P.current,activeNode:Jo,event:bo,options:Hl,context:K,onAbort(zn){if(!T.get(zn))return;let{onDragAbort:ws}=L.current,el={id:zn};ws==null||ws(el),v({type:"onDragAbort",event:el})},onPending(zn,ql,ws,el){if(!T.get(zn))return;let{onDragPending:Bf}=L.current,Gl={id:zn,constraint:ql,initialCoordinates:ws,offset:el};Bf==null||Bf(Gl),v({type:"onDragPending",event:Gl})},onStart(zn){let ql=P.current;if(ql==null)return;let ws=T.get(ql);if(!ws)return;let{onDragStart:el}=L.current,Wf={activatorEvent:bo,active:{id:ql,data:ws.data,rect:D}};(0,xu.unstable_batchedUpdates)(()=>{el==null||el(Wf),k(qc.Initializing),h({type:kn.DragStart,initialCoordinates:zn,active:ql}),v({type:"onDragStart",event:Wf}),M(uT.current),F(bo)})},onMove(zn){h({type:kn.DragMove,coordinates:zn})},onEnd:_u(kn.DragEnd),onCancel:_u(kn.DragCancel)});uT.current=bs;function _u(zn){return async function(){let{active:ws,collisions:el,over:Wf,scrollAdjustedTranslate:Bf}=K.current,Gl=null;if(ws&&Bf){let{cancelDrop:Uf}=L.current;Gl={activatorEvent:bo,active:ws,collisions:el,delta:Bf,over:Wf},zn===kn.DragEnd&&typeof Uf=="function"&&await Promise.resolve(Uf(Gl))&&(zn=kn.DragCancel)}P.current=null,(0,xu.unstable_batchedUpdates)(()=>{h({type:zn}),k(qc.Uninitialized),FI(null),M(null),F(null),uT.current=null;let Uf=zn===kn.DragEnd?"onDragEnd":"onDragCancel";if(Gl){let pT=L.current[Uf];pT==null||pT(Gl),v({type:Uf,event:Gl})}})}}},[T]),NG=(0,ae.useCallback)((Xn,vo)=>(yo,Hl)=>{let Jo=yo.nativeEvent,bo=T.get(Hl);if(P.current!==null||!bo||Jo.dndKit||Jo.defaultPrevented)return;let bs={active:bo};Xn(yo,vo.options,bs)===!0&&(Jo.dndKit={capturedBy:vo.sensor},P.current=Hl,jI(yo,vo))},[T,jI]),LI=Eue(d,NG);Fue(d),Na(()=>{G&&w===qc.Initializing&&k(qc.Initialized)},[G,w]),(0,ae.useEffect)(()=>{let{onDragMove:Xn}=L.current,{active:vo,activatorEvent:yo,collisions:Hl,over:Jo}=K.current;if(!vo||!yo)return;let bo={active:vo,activatorEvent:yo,collisions:Hl,delta:{x:ys.x,y:ys.y},over:Jo};(0,xu.unstable_batchedUpdates)(()=>{Xn==null||Xn(bo),v({type:"onDragMove",event:bo})})},[ys.x,ys.y]),(0,ae.useEffect)(()=>{let{active:Xn,activatorEvent:vo,collisions:yo,droppableContainers:Hl,scrollAdjustedTranslate:Jo}=K.current;if(!Xn||P.current==null||!vo||!Jo)return;let{onDragOver:bo}=L.current,bs=Hl.get(II),_u=bs&&bs.rect.current?{id:bs.id,rect:bs.rect.current,data:bs.data,disabled:bs.disabled}:null,zn={active:Xn,activatorEvent:vo,collisions:yo,delta:{x:Jo.x,y:Jo.y},over:_u};(0,xu.unstable_batchedUpdates)(()=>{FI(_u),bo==null||bo(zn),v({type:"onDragOver",event:zn})})},[II]),Na(()=>{K.current={activatorEvent:O,active:A,activeNode:U,collisionRect:Lu,collisions:Rf,droppableRects:H,draggableNodes:T,draggingNode:oe,draggingNodeRect:de,droppableContainers:C,over:Vl,scrollableAncestors:Qe,scrollAdjustedTranslate:ys},D.current={initial:de,translated:Lu}},[A,U,Rf,Lu,T,oe,de,H,C,Vl,Qe,ys]),kue({...R,delta:E,draggingRect:Lu,pointerCoordinates:nr,scrollableAncestors:Qe,scrollableAncestorRects:ze});let MG=(0,ae.useMemo)(()=>({active:A,activeNode:U,activeNodeRect:G,activatorEvent:O,collisions:Rf,containerNodeRect:J,dragOverlay:te,draggableNodes:T,droppableContainers:C,droppableRects:H,over:Vl,measureDroppableContainers:q,scrollableAncestors:Qe,scrollableAncestorRects:ze,measuringConfiguration:_,measuringScheduled:X,windowRect:nt}),[A,U,G,O,Rf,J,te,T,C,H,Vl,q,Qe,ze,_,X,nt]),OG=(0,ae.useMemo)(()=>({activatorEvent:O,activators:LI,active:A,activeNodeRect:G,ariaDescribedById:{draggable:B},dispatch:h,draggableNodes:T,over:Vl,measureDroppableContainers:q}),[O,LI,A,G,h,B,T,Vl,q]);return ae.default.createElement(SV.Provider,{value:b},ae.default.createElement(bS.Provider,{value:OG},ae.default.createElement(LV.Provider,{value:MG},ae.default.createElement(_V.Provider,{value:AG},c)),ae.default.createElement(Hue,{disabled:(s==null?void 0:s.restoreFocus)===!1})),ae.default.createElement(Kde,{...s,hiddenTextDescribedById:B}));function IG(){let Xn=(I==null?void 0:I.autoScrollEnabled)===!1,vo=typeof l=="object"?l.enabled===!1:l===!1,yo=S&&!Xn&&!vo;return typeof l=="object"?{...l,enabled:yo}:{enabled:yo}}}),Kue=(0,ae.createContext)(null),kV="button",Jue="Draggable";function $V(e){let{id:t,data:r,disabled:n=!1,attributes:i}=e,o=yu(Jue),{activators:a,activatorEvent:s,active:l,activeNodeRect:c,ariaDescribedById:d,draggableNodes:u,over:p}=(0,ae.useContext)(bS),{role:m=kV,roleDescription:g="draggable",tabIndex:f=0}=i!=null?i:{},y=(l==null?void 0:l.id)===t,h=(0,ae.useContext)(y?_V:Kue),[v,b]=qv(),[w,k]=qv(),S=jue(a,t),x=hf(r);Na(()=>(u.set(t,{id:t,key:o,node:v,activatorNode:w,data:x}),()=>{let E=u.get(t);E&&E.key===o&&u.delete(t)}),[u,t]);let T=(0,ae.useMemo)(()=>({role:m,tabIndex:f,"aria-disabled":n,"aria-pressed":y&&m===kV?!0:void 0,"aria-roledescription":g,"aria-describedby":d.draggable}),[n,m,f,y,g,d.draggable]);return{active:l,activatorEvent:s,activeNodeRect:c,attributes:T,isDragging:y,listeners:n?void 0:S,node:v,over:p,setNodeRef:b,setActivatorNodeRef:k,transform:h}}function RV(){return(0,ae.useContext)(LV)}var Xue="Droppable",Que={timeout:25};function WV(e){let{data:t,disabled:r=!1,id:n,resizeObserverConfig:i}=e,o=yu(Xue),{active:a,dispatch:s,over:l,measureDroppableContainers:c}=(0,ae.useContext)(bS),d=(0,ae.useRef)({disabled:r}),u=(0,ae.useRef)(!1),p=(0,ae.useRef)(null),m=(0,ae.useRef)(null),{disabled:g,updateMeasurementsFor:f,timeout:y}={...Que,...i},h=hf(f!=null?f:n),v=(0,ae.useCallback)(()=>{if(!u.current){u.current=!0;return}m.current!=null&&clearTimeout(m.current),m.current=setTimeout(()=>{c(Array.isArray(h.current)?h.current:[h.current]),m.current=null},y)},[y]),b=yS({callback:v,disabled:g||!a}),w=(0,ae.useCallback)((T,E)=>{b&&(E&&(b.unobserve(E),u.current=!1),T&&b.observe(T))},[b]),[k,S]=qv(w),x=hf(t);return(0,ae.useEffect)(()=>{!b||!k.current||(b.disconnect(),u.current=!1,b.observe(k.current))},[k,b]),(0,ae.useEffect)(()=>(s({type:kn.RegisterDroppable,element:{id:n,key:o,disabled:r,node:k,rect:p,data:x}}),()=>s({type:kn.UnregisterDroppable,key:o,id:n})),[n]),(0,ae.useEffect)(()=>{r!==d.current.disabled&&(s({type:kn.SetDroppableDisabled,id:n,key:o,disabled:r}),d.current.disabled=r)},[n,o,r,s]),{active:a,rect:p,isOver:(l==null?void 0:l.id)===n,node:k,over:l,setNodeRef:S}}var Gr=$(W());function BV(e,t,r){let n=e.slice();return n.splice(r<0?n.length+r:r,0,n.splice(t,1)[0]),n}function Zue(e,t){return e.reduce((r,n,i)=>{let o=t.get(n);return o&&(r[i]=o),r},Array(e.length))}function wS(e){return e!==null&&e>=0}function epe(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function tpe(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}var xS={scaleX:1,scaleY:1},UV=e=>{var t;let{rects:r,activeNodeRect:n,activeIndex:i,overIndex:o,index:a}=e,s=(t=r[i])!=null?t:n;if(!s)return null;let l=rpe(r,a,i);if(a===i){let c=r[o];return c?{x:i<o?c.left+c.width-(s.left+s.width):c.left-s.left,y:0,...xS}:null}return a>i&&a<=o?{x:-s.width-l,y:0,...xS}:a<i&&a>=o?{x:s.width+l,y:0,...xS}:{x:0,y:0,...xS}};function rpe(e,t,r){let n=e[t],i=e[t-1],o=e[t+1];return!n||!i&&!o?0:r<t?i?n.left-(i.left+i.width):o.left-(n.left+n.width):o?o.left-(n.left+n.width):n.left-(i.left+i.width)}var VV=e=>{let{rects:t,activeIndex:r,overIndex:n,index:i}=e,o=BV(t,n,r),a=t[i],s=o[i];return!s||!a?null:{x:s.left-a.left,y:s.top-a.top,scaleX:s.width/a.width,scaleY:s.height/a.height}};var HV="Sortable",qV=Gr.default.createContext({activeIndex:-1,containerId:HV,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:VV,disabled:{draggable:!1,droppable:!1}});function GV(e){let{children:t,id:r,items:n,strategy:i=VV,disabled:o=!1}=e,{active:a,dragOverlay:s,droppableRects:l,over:c,measureDroppableContainers:d}=RV(),u=yu(HV,r),p=s.rect!==null,m=(0,Gr.useMemo)(()=>n.map(S=>typeof S=="object"&&"id"in S?S.id:S),[n]),g=a!=null,f=a?m.indexOf(a.id):-1,y=c?m.indexOf(c.id):-1,h=(0,Gr.useRef)(m),v=!epe(m,h.current),b=y!==-1&&f===-1||v,w=tpe(o);Na(()=>{v&&g&&d(m)},[v,m,g,d]),(0,Gr.useEffect)(()=>{h.current=m},[m]);let k=(0,Gr.useMemo)(()=>({activeIndex:f,containerId:u,disabled:w,disableTransforms:b,items:m,overIndex:y,useDragOverlay:p,sortedRects:Zue(m,l),strategy:i}),[f,u,w.draggable,w.droppable,b,m,y,l,p,i]);return Gr.default.createElement(qV.Provider,{value:k},t)}var npe=e=>{let{id:t,items:r,activeIndex:n,overIndex:i}=e;return BV(r,n,i).indexOf(t)},ipe=e=>{let{containerId:t,isSorting:r,wasDragging:n,index:i,items:o,newIndex:a,previousItems:s,previousContainerId:l,transition:c}=e;return!c||!n||s!==o&&i===a?!1:r?!0:a!==i&&t===l},ope={duration:200,easing:"ease"},YV="transform",ape=Hc.Transition.toString({property:YV,duration:0,easing:"linear"}),spe={roleDescription:"sortable"};function lpe(e){let{disabled:t,index:r,node:n,rect:i}=e,[o,a]=(0,Gr.useState)(null),s=(0,Gr.useRef)(r);return Na(()=>{if(!t&&r!==s.current&&n.current){let l=i.current;if(l){let c=Tu(n.current,{ignoreTransform:!0}),d={x:l.left-c.left,y:l.top-c.top,scaleX:l.width/c.width,scaleY:l.height/c.height};(d.x||d.y)&&a(d)}}r!==s.current&&(s.current=r)},[t,r,n,i]),(0,Gr.useEffect)(()=>{o&&a(null)},[o]),o}function KV(e){let{animateLayoutChanges:t=ipe,attributes:r,disabled:n,data:i,getNewIndex:o=npe,id:a,strategy:s,resizeObserverConfig:l,transition:c=ope}=e,{items:d,containerId:u,activeIndex:p,disabled:m,disableTransforms:g,sortedRects:f,overIndex:y,useDragOverlay:h,strategy:v}=(0,Gr.useContext)(qV),b=cpe(n,m),w=d.indexOf(a),k=(0,Gr.useMemo)(()=>({sortable:{containerId:u,index:w,items:d},...i}),[u,i,w,d]),S=(0,Gr.useMemo)(()=>d.slice(d.indexOf(a)),[d,a]),{rect:x,node:T,isOver:E,setNodeRef:C}=WV({id:a,data:k,disabled:b.droppable,resizeObserverConfig:{updateMeasurementsFor:S,...l}}),{active:N,activatorEvent:D,activeNodeRect:A,attributes:P,setNodeRef:I,listeners:M,isDragging:O,over:F,setActivatorNodeRef:L,transform:B}=$V({id:a,data:k,attributes:{...spe,...r},disabled:b.draggable}),j=oV(C,I),_=!!N,H=_&&!g&&wS(p)&&wS(y),q=!h&&O,X=q&&H?B:null,U=s!=null?s:v,Y=H?X!=null?X:U({rects:f,activeNodeRect:A,activeIndex:p,overIndex:y,index:w}):null,R=wS(p)&&wS(y)?o({id:a,items:d,activeIndex:p,overIndex:y}):w,V=N==null?void 0:N.id,G=(0,Gr.useRef)({activeId:V,items:d,newIndex:R,containerId:u}),J=d!==G.current.items,K=t({active:N,containerId:u,isDragging:O,isSorting:_,id:a,index:w,items:d,newIndex:G.current.newIndex,previousItems:G.current.items,previousContainerId:G.current.containerId,transition:c,wasDragging:G.current.activeId!=null}),ne=lpe({disabled:!K,index:w,node:T,rect:x});return(0,Gr.useEffect)(()=>{_&&G.current.newIndex!==R&&(G.current.newIndex=R),u!==G.current.containerId&&(G.current.containerId=u),d!==G.current.items&&(G.current.items=d)},[_,R,u,d]),(0,Gr.useEffect)(()=>{if(V===G.current.activeId)return;if(V!=null&&G.current.activeId==null){G.current.activeId=V;return}let oe=setTimeout(()=>{G.current.activeId=V},50);return()=>clearTimeout(oe)},[V]),{active:N,activeIndex:p,attributes:P,data:k,rect:x,index:w,newIndex:R,items:d,isOver:E,isSorting:_,isDragging:O,listeners:M,node:T,overIndex:y,over:F,setNodeRef:j,setActivatorNodeRef:L,setDroppableNodeRef:C,setDraggableNodeRef:I,transform:ne!=null?ne:Y,transition:te()};function te(){if(ne||J&&G.current.newIndex===w)return ape;if(!(q&&!Gv(D)||!c)&&(_||K))return Hc.Transition.toString({...c,property:YV})}}function cpe(e,t){var r,n;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(r=e==null?void 0:e.draggable)!=null?r:t.draggable,droppable:(n=e==null?void 0:e.droppable)!=null?n:t.droppable}}var wYe=[Ct.Down,Ct.Right,Ct.Up,Ct.Left];var dpe=({transform:e})=>({...e,y:0});var upe=({id:e,name:t,value:r,isPositive:n,isEditing:i,onRemove:o,dollarPart:a,centsPart:s,isCurrency:l})=>{let{attributes:c,listeners:d,setNodeRef:u,transform:p,transition:m}=KV({id:e,disabled:!i}),g={transform:Hc.Transform.toString(p&&{...p,y:0}),transition:m,position:"relative",height:"100%",flex:"1 1 180px",minWidth:"180px",maxWidth:"300px"};return dr.default.createElement("div",{ref:u,style:g},dr.default.createElement("div",{className:"journalit-dashboard-metric-wrapper",style:{position:"relative",cursor:i?"grab":"default",height:"100%",display:"flex",flexDirection:"column"}},dr.default.createElement("div",{...c,...i?d:{},style:{flex:1,height:"100%"}},dr.default.createElement(nV,{name:t,value:r,isPositive:n,dollarPart:a,centsPart:s,isCurrency:l})),i&&dr.default.createElement("button",{className:"journalit-dashboard-widget-remove",onClick:f=>{f.stopPropagation(),f.preventDefault(),o(e)},"aria-label":"Remove metric",style:{zIndex:1e5,position:"absolute",top:"4px",right:"4px",width:"22px",height:"22px",backgroundColor:"var(--background-modifier-error)",color:"white",border:"none",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",cursor:"pointer",padding:0}},"\u2715")))},mO=({filters:e,isEditing:t,onShowMetricSelector:r,hideAddButton:n=!1})=>{let i=Ge(),{dashboardData:o,isLoading:a,isStale:s,error:l}=ff(),[c,d]=(0,dr.useState)([]),[u,p]=(0,dr.useState)(null);(0,dr.useEffect)(()=>{p(l?l.message||"Failed to load metrics":null)},[l]),(0,dr.useEffect)(()=>{(()=>{try{if(i){let x=jn(i);d(x.topSection)}}catch(x){console.error("Error initializing metrics:",x),d(["netPnL","winRate","profitFactor","expectancy"])}})();let S=x=>{d([...x.detail.activeMetrics])};return document.addEventListener("journalit:metrics-changed",S),()=>{document.removeEventListener("journalit:metrics-changed",S)}},[i]);let m=k=>{let{active:S,over:x}=k;if(x&&S.id!==x.id){let T=c.indexOf(S.id.toString()),E=c.indexOf(x.id.toString());if(T!==-1&&E!==-1){let C=[...c];if(C.splice(T,1),C.splice(E,0,S.id.toString()),d(C),i)try{let D={...jn(i),topSection:C};Kn(i,"Default",D)}catch(N){console.error("Error saving layout:",N)}}}},g=k=>{if(i)try{let S=c.filter(C=>C!==k);d([...S]);let T={...jn(i),topSection:[...S]};Kn(i,"Default",T).catch(C=>{console.error("Error saving layout:",C)}),document.querySelectorAll(".journalit-dashboard-widget-remove").forEach(C=>{C.style.opacity="0.99",setTimeout(()=>{C.style.opacity="1"},0)});let E=new CustomEvent("journalit:metrics-changed",{detail:{activeMetrics:S}});document.dispatchEvent(E)}catch(S){console.error("Error removing metric:",S)}},f=(k,S)=>{switch(k){case"netPnL":return fe(S);case"winRate":return`${(S*100).toFixed(1)}%`;case"profitFactor":return S.toFixed(2);case"expectancy":return fe(S);case"numTrades":return S.toString();case"numWinTrades":return S.toString();case"numLossTrades":return S.toString();case"avgWin":return fe(S);case"avgLoss":return fe(S);default:return S.toString()}},y=k=>{switch(k){case"netPnL":return"Net P&L";case"winRate":return"Win Rate";case"profitFactor":return"Profit Factor";case"expectancy":return"Expectancy";case"numTrades":return"Total Trades";case"numWinTrades":return"Winning Trades";case"numLossTrades":return"Losing Trades";case"avgWin":return"Avg Win";case"avgLoss":return"Avg Loss";default:return k}},h=(k,S)=>{switch(k){case"netPnL":case"profitFactor":case"expectancy":case"avgWin":return S>0;case"avgLoss":return S<0;case"winRate":return S>.5;default:return!0}},v=k=>["netPnL","expectancy","avgWin","avgLoss"].includes(k),b=(k,S)=>{if(!v(k))return;let x=fe(S);return x.includes(".")?x.split(".")[0]:x},w=(k,S)=>{if(!v(k))return;let x=fe(S);if(x.includes("."))return"."+x.split(".")[1]};return dr.default.createElement("div",{className:"journalit-dashboard-top-section",style:{padding:"0",backgroundColor:"transparent"}},t&&!n&&r&&dr.default.createElement("div",{className:"journalit-dashboard-top-section-header",style:{display:"flex",justifyContent:"flex-end",alignItems:"center",padding:"0 10px"}},dr.default.createElement("button",{className:"journalit-dashboard-add-metric-button",onClick:r,style:{backgroundColor:"var(--interactive-accent)",color:"var(--text-on-accent)",border:"none",borderRadius:"4px",padding:"4px 8px",fontSize:"12px",cursor:"pointer"}},"Add Metric")),a&&!o?dr.default.createElement(Or,{message:"Loading metrics..."}):u?dr.default.createElement("div",{className:"journalit-dashboard-error"},u):o?dr.default.createElement("div",{style:{position:"relative"}},dr.default.createElement(zV,{collisionDetection:CV,onDragEnd:m,autoScroll:!0,modifiers:[dpe]},dr.default.createElement(GV,{items:c,strategy:UV},dr.default.createElement("div",{className:"journalit-dashboard-metrics",id:"topsection-metrics-container",style:{display:"flex",flexDirection:"row",flexWrap:"wrap",width:"100%",overflowX:"hidden",gap:"8px",padding:"10px 0",position:"relative",backgroundColor:"transparent",borderRadius:"0",minHeight:"auto"}},c.map(k=>dr.default.createElement(upe,{key:k,id:k,name:y(k),value:f(k,o.metrics[k]),isPositive:h(k,o.metrics[k]),isEditing:t,onRemove:g,dollarPart:b(k,o.metrics[k]),centsPart:w(k,o.metrics[k]),isCurrency:v(k)})),t&&c.length===0&&dr.default.createElement("div",{className:"journalit-dashboard-no-metrics"},'Click "Add Metric" to add metrics')))),(s||a)&&dr.default.createElement(Or,{message:"Loading...",size:"small",overlay:!0})):dr.default.createElement("div",{className:"journalit-dashboard-no-data"},"No data available"))};var JV=[{id:"netPnL",name:"Net P&L",description:"Total profit and loss across all trades",category:"performance"},{id:"winRate",name:"Win Rate",description:"Percentage of winning trades",category:"performance"},{id:"profitFactor",name:"Profit Factor",description:"Ratio of gross profit to gross loss",category:"performance"},{id:"expectancy",name:"Expectancy",description:"Average amount won or lost per trade",category:"performance"},{id:"numTrades",name:"Total Trades",description:"Total number of trades",category:"volume"},{id:"numWinTrades",name:"Winning Trades",description:"Number of winning trades",category:"volume"},{id:"numLossTrades",name:"Losing Trades",description:"Number of losing trades",category:"volume"},{id:"avgWin",name:"Avg Win",description:"Average profit of winning trades",category:"average"},{id:"avgLoss",name:"Avg Loss",description:"Average loss of losing trades",category:"average"}];var mo=$(W());var $r=$(W()),XS=$(pq());Yt();var wi=[{id:"pnlChart",name:"Cumulative P&L",description:"Line chart showing cumulative P&L over time",category:"performance",minSize:{w:4,h:5},defaultSize:{w:6,h:8}},{id:"performanceCalendar",name:"Performance Calendar",description:"Calendar view showing daily performance",category:"performance",minSize:{w:4,h:3},defaultSize:{w:6,h:4}},{id:"dailyPerformance",name:"Daily Performance",description:"Bar chart showing P&L for each trading day",category:"performance",minSize:{w:4,h:3},defaultSize:{w:6,h:4}},{id:"tradesChart",name:"Trades Chart",description:"Bar chart showing P&L for each individual trade",category:"performance",minSize:{w:4,h:3},defaultSize:{w:6,h:4}},{id:"drawdownChart",name:"Drawdown Chart",description:"Chart showing percentage drawdown from peak equity",category:"performance",minSize:{w:4,h:5},defaultSize:{w:6,h:8}},{id:"recentTrades",name:"Recent Trades",description:"Shows the 10 most recent trades with details",category:"journal",minSize:{w:4,h:3},defaultSize:{w:6,h:4}}];var KS=$(W());var fs=$(W());Yt();var Oa=({filters:e,dateFormat:t,children:r})=>{let n=Ge(),{dashboardData:i,isLoading:o,isStale:a,error:s,refreshData:l}=ff(),c=t||fr();return(0,fs.useEffect)(()=>{Promise.resolve().then(()=>(Xg(),YC)).then(({ensureChartStyles:d})=>{d()}).catch(d=>{console.error("Error loading chart styles:",d)}),Promise.resolve().then(()=>(Qg(),Z2)).then(({ensureSharedComponentStyles:d})=>{d()}).catch(d=>{console.error("Error loading shared component styles:",d)})},[]),(0,fs.useEffect)(()=>{let d=()=>{l()};return document.addEventListener("journalit:trade-data-changed",d),()=>{document.removeEventListener("journalit:trade-data-changed",d)}},[l]),fs.default.createElement("div",{className:"journalit-dashboard-widget-container",style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}},o&&!i?fs.default.createElement(Or,{fullscreen:!0}):s?fs.default.createElement("div",{className:"journalit-dashboard-widget-error",style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",textAlign:"center",padding:"16px",color:"var(--text-error)"}},(typeof s=="string"?s:s==null?void 0:s.message)||"Failed to load data"):!i||i.trades.length===0?fs.default.createElement("div",{style:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",position:"relative"}},fs.default.createElement(Ae,{message:"No data available",subMessage:"Try adjusting your filter settings",iconSize:40,actionButtonText:"Add Trade",onActionButtonClick:()=>{if(!n||!n.app)return;let d=n.app.workspace.getLeavesOfType(Ir);if(d.length>0){n.app.workspace.revealLeaf(d[0]);return}let u=n.app.workspace.getRightLeaf(!1);u&&u.setViewState({type:Ir,active:!0}).then(()=>{n.app.workspace.revealLeaf(u)})}})):fs.default.createElement("div",{style:{width:"100%",height:"100%",overflow:"hidden",backgroundColor:"transparent",position:"relative"}},r(i,c),(a||o)&&fs.default.createElement(Or,{message:"Loading...",size:"small",overlay:!0})))};var mq=KS.default.memo(({filters:e,dateFormat:t})=>KS.default.createElement(Oa,{filters:e,dateFormat:t},(r,n)=>{let i=Wg(r.trades,n);return KS.default.createElement(Ys,{data:i,onPointClick:(o,a)=>{}})}));var cI=$(W());var fq=({filters:e})=>cI.default.createElement(Oa,{filters:e},t=>cI.default.createElement(Jk,{trades:t.trades,filters:e}));var Nf=$(W());Yt();var gq=Nf.default.memo(({filters:e,dateFormat:t})=>((0,Nf.useEffect)(()=>{Promise.resolve().then(()=>(Xg(),YC)).then(({ensureChartStyles:r})=>{r()})},[]),Nf.default.createElement(Oa,{filters:e,dateFormat:t},(r,n)=>{let i={};r.trades.forEach(a=>{let s=a.entryTime.toISOString().split("T")[0];i[s]||(i[s]={pnl:0,trades:0}),i[s].pnl+=a.pnl,i[s].trades+=1});let o=Object.entries(i).map(([a,s])=>({date:Ze(new Date(a),n),originalDate:a,pnl:s.pnl,trades:s.trades,fill:s.pnl>=0?"var(--chart-positive)":"var(--chart-negative)"}));return o.sort((a,s)=>new Date(a.originalDate).getTime()-new Date(s.originalDate).getTime()),Nf.default.createElement(KM,{data:o})})));var dI=$(W());var hq=({filters:e,dateFormat:t})=>dI.default.createElement(Oa,{filters:e,dateFormat:t},(r,n)=>{let i=Bg(r.trades);return dI.default.createElement(Rv,{data:i,onPointClick:(o,a)=>{o!=null&&o.path},className:"dashboard-trades-chart",style:{boxShadow:"var(--shadow-s)"}})});var JS=$(W());var vq=JS.default.memo(({filters:e,dateFormat:t})=>JS.default.createElement(Oa,{filters:e,dateFormat:t},(r,n)=>{let i=hd(r.trades,n);return JS.default.createElement(zl,{data:i,showTooltip:!0,tooltipProps:{wrapperStyle:{zIndex:1001}}})}));var zr=$(W());var Efe=(e,t)=>{var r,n;try{let i=((n=(r=t==null?void 0:t.settings)==null?void 0:r.trade)==null?void 0:n.dateFormat)||"MMDDYY",o=String(e.getDate()).padStart(2,"0"),a=String(e.getMonth()+1).padStart(2,"0"),l=String(e.getFullYear()).slice(2);switch(i){case"DDMMYY":return`${o}/${a}/${l}`;case"MMDDYY":return`${a}/${o}/${l}`;case"YYMMDD":return`${l}/${a}/${o}`;default:return e.toLocaleDateString()}}catch(i){return e.toLocaleDateString()}},yq=({filters:e})=>{let t=Ge(),r=n=>{t&&t.app.workspace.openLinkText(n,"",!0)};return zr.default.createElement(Oa,{filters:e},n=>{let i=[...n.trades].sort((o,a)=>a.entryTime.getTime()-o.entryTime.getTime()).slice(0,10);return zr.default.createElement("div",{className:"journalit-dashboard-recent-trades"},zr.default.createElement("table",{className:"journalit-dashboard-recent-trades-table"},zr.default.createElement("thead",null,zr.default.createElement("tr",null,zr.default.createElement("th",null,"Date"),zr.default.createElement("th",null,"Ticker"),zr.default.createElement("th",null,"Direction"),zr.default.createElement("th",{className:"pnl-column"},"P&L"),zr.default.createElement("th",null,"Setups"))),zr.default.createElement("tbody",null,i.length===0?zr.default.createElement("tr",null,zr.default.createElement("td",{colSpan:5,style:{padding:"20px 0",textAlign:"center",height:"150px",position:"relative"}},zr.default.createElement("div",{style:{position:"absolute",top:"0",left:"0",right:"0",bottom:"0",display:"flex",justifyContent:"center",alignItems:"center"}},zr.default.createElement(Ae,{message:"No trades found",subMessage:"Try selecting a different date range",iconSize:32,actionButtonText:"Add Trade",onActionButtonClick:()=>{if(!t||!t.app)return;let o=t.app.workspace.getLeavesOfType(Ir);if(o.length>0){t.app.workspace.revealLeaf(o[0]);return}let a=t.app.workspace.getRightLeaf(!1);a&&a.setViewState({type:Ir,active:!0}).then(()=>{t.app.workspace.revealLeaf(a)})}})))):i.map((o,a)=>{let s=o.tradeStatus==="CLOSED"?!1:o.tradeStatus==="OPEN"||o._originalPnlWasNull&&!o.tradeStatus?!0:at({tradeStatus:o.tradeStatus,exitTime:o.exitTime,pnl:o._originalPnlWasNull?null:o.pnl,useDirectPnLInput:o.useDirectPnLInput,exits:o.exits}),l=!s&&o.pnl>0,c=!s&&o.pnl<0,d=Array.isArray(o.setup)?o.setup:o.setup?[o.setup]:[];return zr.default.createElement("tr",{key:`${o.path}-${a}`,onClick:()=>r(o.path),className:`trade-row ${a%2===0?"even":"odd"} ${s?"open-trade":""}`},zr.default.createElement("td",{className:"date-cell"},Efe(o.entryTime,t)),zr.default.createElement("td",{className:"ticker-cell"},o.instrument||"Unknown"),zr.default.createElement("td",{className:"direction-cell"},o.direction==="long"?"Long":"Short"),zr.default.createElement("td",{className:`pnl-cell ${s?"open":l?"positive":c?"negative":""}`},s?"OPEN":fe(o.pnl)),zr.default.createElement("td",{className:"setups-cell"},d.length>0?d.slice(0,2).join(", ")+(d.length>2?"...":""):"-"))}))))})};var Fu=(e,t,r,n,i)=>{var a,s,l;if(!e||e.length===0)return{i:t,x:0,y:0,w:r,h:n};if(i)try{let c=((s=(a=i.settings)==null?void 0:a.dashboard)==null?void 0:s.layouts)||{};for(let d in c){let m=(((l=c[d].bottomSection)==null?void 0:l.lg)||[]).find(g=>g.i===t);if(m)return{i:t,x:0,y:1/0,w:m.w,h:m.h}}}catch(c){console.error("Error finding previous layout:",c)}let o=0;return e.forEach(c=>{let d=c.y+c.h;d>o&&(o=d)}),{i:t,x:0,y:o,w:r,h:n}},Dfe=(0,XS.WidthProvider)(XS.Responsive),bq=({filters:e,isEditing:t,widgets:r,onRemoveWidget:n})=>{let i=Ge(),[o,a]=(0,$r.useState)({lg:[],md:[],sm:[],xs:[],xxs:[]}),s=u=>({...u,i:u.i,x:typeof u.x=="number"?u.x:0,y:typeof u.y=="number"?u.y:0,w:typeof u.w=="number"&&u.w>0?u.w:1,h:typeof u.h=="number"&&u.h>0?u.h:1});(0,$r.useEffect)(()=>{(()=>{try{if(i){let p=jn(i),m=p.bottomSection.lg.filter(b=>r.includes(b.i)).map(s),g=p.bottomSection.md.filter(b=>r.includes(b.i)).map(s),f=p.bottomSection.sm.filter(b=>r.includes(b.i)).map(s),y=(p.bottomSection.xs||[]).filter(b=>r.includes(b.i)).map(s),h=(p.bottomSection.xxs||[]).filter(b=>r.includes(b.i)).map(s),v={lg:12,md:6,sm:4,xs:2,xxs:1};r.forEach(b=>{let w=m.some(E=>E.i===b),k=g.some(E=>E.i===b),S=f.some(E=>E.i===b),x=y.some(E=>E.i===b),T=h.some(E=>E.i===b);if(!w||!k||!S||!x||!T){let E=wi.find(C=>C.id===b);if(E){let C,N="lg";if(w?(C=m.find(D=>D.i===b),N="lg"):k?(C=g.find(D=>D.i===b),N="md"):S?(C=f.find(D=>D.i===b),N="sm"):x?(C=y.find(D=>D.i===b),N="xs"):T&&(C=h.find(D=>D.i===b),N="xxs"),C||(C=Fu(m,b,E.defaultSize.w,E.defaultSize.h,i)),!w){let D=Fu(m,b,Math.min(C.w,12),C.h,i);m.push(D)}if(!k){let D={i:b,x:0,y:1/0,w:Math.min(C.w,6),h:C.h};g.push(D)}if(!S){let D={i:b,x:0,y:1/0,w:Math.min(C.w,4),h:C.h};f.push(D)}if(!x){let D={i:b,x:0,y:1/0,w:Math.min(C.w,2),h:C.h};y.push(D)}if(!T){let D={i:b,x:0,y:1/0,w:1,h:C.h};h.push(D)}}}}),a({lg:m,md:g,sm:f,xs:y,xxs:h})}}catch(p){console.error("Error loading layouts:",p);let m={lg:12,md:6,sm:4,xs:2,xxs:1},g=(y,h)=>{let v=wi.find(S=>S.id===y),b=m[h],w=h==="xxs"?1:Math.min((v==null?void 0:v.defaultSize.w)||6,b),k=(v==null?void 0:v.defaultSize.h)||(h==="lg"?4:3);return s({i:y,x:0,y:0,w,h:k})},f={lg:r.map(y=>g(y,"lg")),md:r.map(y=>g(y,"md")),sm:r.map(y=>g(y,"sm")),xs:r.map(y=>g(y,"xs")),xxs:r.map(y=>g(y,"xxs"))};a(f)}})()},[i,r]);let l=u=>{let p=new CustomEvent("journalit:widgets-changed",{detail:{activeWidgets:u}});document.dispatchEvent(p)},c=(u,p)=>{let m=new CustomEvent("layout-changed");if(document.dispatchEvent(m),t&&i)try{let g=jn(i),f=Object.keys(p).find(w=>JSON.stringify(p[w])===JSON.stringify(u))||"lg",y=u.map(w=>w.i),h={...g,bottomSection:{...g.bottomSection,lg:p.lg||[],md:p.md||[],sm:p.sm||[],xs:p.xs||[],xxs:p.xxs||[]}},v={lg:12,md:6,sm:4,xs:2,xxs:1};["lg","md","sm","xs","xxs"].forEach(w=>{if(w===f)return;let k=h.bottomSection[w],S=k.map(x=>x.i);h.bottomSection[w]=k.filter(x=>y.includes(x.i)),y.forEach(x=>{if(!S.includes(x)){let T=u.find(E=>E.i===x);if(T){let E=wi.find(N=>N.id===x),C=(E==null?void 0:E.defaultSize)||{w:6,h:4};h.bottomSection[w].push({i:x,x:0,y:1/0,w:Math.min(Math.max(1,Math.floor(T.w*v[w]/v[f])),v[w]),h:T.h})}}})}),Kn(i,"Default",h)}catch(g){console.error("Error saving layout:",g)}},d=u=>{var g,f;if(!wi.find(y=>y.id===u))return $r.default.createElement("div",{className:"journalit-dashboard-widget-error"},"Unknown widget type: ",u);let m=((f=(g=i==null?void 0:i.settings)==null?void 0:g.trade)==null?void 0:f.dateFormat)||fr();switch(u){case"pnlChart":return $r.default.createElement(mq,{filters:e,dateFormat:m});case"performanceCalendar":return $r.default.createElement(fq,{filters:e,dateFormat:m});case"dailyPerformance":return $r.default.createElement(gq,{filters:e,dateFormat:m});case"tradesChart":return $r.default.createElement(hq,{filters:e,dateFormat:m});case"drawdownChart":return $r.default.createElement(vq,{filters:e,dateFormat:m});case"recentTrades":return $r.default.createElement(yq,{filters:e,dateFormat:m});default:return $r.default.createElement("div",{className:"journalit-dashboard-widget-error"},"Widget not implemented: ",u)}};return $r.default.createElement("div",{className:`journalit-dashboard-grid-layout ${t?"is-editing":""}`,style:{padding:"0",margin:"0"}},$r.default.createElement(Dfe,{className:"layout",layouts:o,breakpoints:{lg:1200,md:996,sm:768,xs:480,xxs:0},cols:{lg:12,md:6,sm:4,xs:2,xxs:1},rowHeight:50,isResizable:t,isDraggable:t,onLayoutChange:c,compactType:"vertical",preventCollision:!1,useCSSTransforms:!0,containerPadding:[0,0],margin:[4,4]},r.map(u=>$r.default.createElement("div",{key:u},$r.default.createElement(()=>{var h;let m=v=>{v.stopPropagation(),v.preventDefault(),v.nativeEvent.stopImmediatePropagation(),n(u);let b=r.filter(w=>w!==u);l(b)},g=["pnlChart","dailyPerformance","tradesChart","drawdownChart"],f=t||g.includes(u),y=!t&&g.includes(u);return $r.default.createElement("div",{className:"journalit-dashboard-widget",style:{position:"relative",width:"100%",height:"100%",display:"flex",flexDirection:"column",backgroundColor:"transparent",borderRadius:"6px",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",overflow:"hidden"}},t&&$r.default.createElement("button",{className:"journalit-dashboard-widget-remove",onClick:m,style:{position:"absolute",top:"4px",right:"4px",backgroundColor:"var(--background-modifier-error)",color:"white",border:"none",borderRadius:"50%",width:"22px",height:"22px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"12px",cursor:"pointer",zIndex:1e4,padding:0,fontWeight:"bold",lineHeight:1},onMouseDown:v=>{v.stopPropagation(),v.preventDefault()},"aria-label":"Remove widget"},"\u2715"),y&&$r.default.createElement("div",{className:"journalit-dashboard-widget-minimal-header",style:{display:"flex",justifyContent:"center",alignItems:"center",padding:"4px 12px 4px 12px",height:"24px",backgroundColor:"transparent",borderBottom:"1px solid rgba(var(--background-modifier-border-rgb, 0, 0, 0), 0.4)",opacity:.8}},$r.default.createElement("div",{className:"journalit-dashboard-widget-title",style:{fontWeight:"500",fontSize:"13px",color:"var(--text-muted)",letterSpacing:"0.3px",textAlign:"center",width:"100%"}},((h=wi.find(v=>v.id===u))==null?void 0:h.name)||u)),$r.default.createElement("div",{className:"journalit-dashboard-widget-content",style:{flex:1,padding:"4px 4px 2px 1px",height:y?"calc(100% - 24px)":"100%",overflow:"hidden"}},d(u)))},null)))))};var gs=$(W()),wq=({availableWidgets:e,activeWidgets:t,onAddWidget:r,onClose:n})=>(console.warn("ComponentSelector is deprecated, use UnifiedComponentSelector instead"),gs.default.createElement("div",{className:"journalit-dashboard-component-selector"},gs.default.createElement("div",{className:"journalit-dashboard-component-selector-header"},gs.default.createElement("h3",null,"Add Widget"),gs.default.createElement("button",{className:"journalit-dashboard-component-selector-close",onClick:n,"aria-label":"Close"},"\xD7")),gs.default.createElement("div",{className:"journalit-dashboard-component-selector-list"},e.map(i=>gs.default.createElement("div",{key:i.id,className:"journalit-dashboard-component-selector-item",onClick:()=>{r(i.id),n()},style:{opacity:t.includes(i.id)?.5:1}},gs.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-name"},i.name),i.description&&gs.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-description"},i.description),i.category&&gs.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-category"},i.category),t.includes(i.id)&&gs.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-badge"},"Added"))))));var uI=({filters:e,isEditing:t,hideAddButton:r=!1})=>{let n=Ge(),[i,o]=(0,mo.useState)(!1),[a,s]=(0,mo.useState)([]);return(0,mo.useEffect)(()=>{let d=u=>{s([...u.detail.activeWidgets])};return document.addEventListener("journalit:widgets-changed",d),()=>{document.removeEventListener("journalit:widgets-changed",d)}},[]),(0,mo.useEffect)(()=>{let d=()=>{try{if(n){let m=jn(n).bottomSection.lg.map(g=>g.i);s(m)}}catch(p){console.error("Error initializing layout:",p),s(["pnlChart","performanceCalendar","dailyPerformance"])}};d();let u=()=>{d()};return document.addEventListener("journalit:settings-updated",u),()=>{document.removeEventListener("journalit:settings-updated",u)}},[n]),(0,mo.useEffect)(()=>{!t&&i&&o(!1)},[t]),mo.default.createElement("div",{className:"journalit-dashboard-bottom-section",style:{padding:"0",backgroundColor:"transparent"}},t&&!r&&mo.default.createElement("div",{className:"journalit-dashboard-bottom-section-header",style:{display:"flex",justifyContent:"flex-end",alignItems:"center",padding:"0 10px"}},mo.default.createElement("button",{className:"journalit-dashboard-add-widget-button",onClick:()=>o(!i),style:{backgroundColor:"var(--interactive-accent)",color:"var(--text-on-accent)",border:"none",borderRadius:"4px",padding:"4px 8px",fontSize:"12px",cursor:"pointer"}},"Add Widget")),mo.default.createElement("div",{style:{position:"relative"}},!r&&i&&mo.default.createElement(wq,{availableWidgets:wi,activeWidgets:a,onAddWidget:d=>{if(n)try{let u=jn(n),p=wi.find(h=>h.id===d);if(!p)throw new Error(`Widget definition not found: ${d}`);if(a.includes(d))return;let m=Fu(u.bottomSection.lg,d,p.defaultSize.w,p.defaultSize.h,n),g={lg:12,md:6,sm:4,xs:2,xxs:1},f={};Object.keys(g).forEach(h=>{let v=g[h],b=Math.min(p.defaultSize.w,v);f[h]={i:d,x:0,y:1/0,w:b,h:p.defaultSize.h}});let y={...u,bottomSection:{lg:[...u.bottomSection.lg,f.lg],md:[...u.bottomSection.md,f.md],sm:[...u.bottomSection.sm,f.sm],xs:[...u.bottomSection.xs||[],f.xs],xxs:[...u.bottomSection.xxs||[],f.xxs]}};Kn(n,"Default",y),s([...a,d]),o(!1)}catch(u){console.error("Error adding widget:",u)}},onClose:()=>o(!1)}),mo.default.createElement(bq,{filters:e,isEditing:t,widgets:a,onRemoveWidget:d=>{if(n)try{let u=jn(n),p={...u,bottomSection:{lg:u.bottomSection.lg.filter(f=>f.i!==d),md:u.bottomSection.md.filter(f=>f.i!==d),sm:u.bottomSection.sm.filter(f=>f.i!==d),xs:(u.bottomSection.xs||[]).filter(f=>f.i!==d),xxs:(u.bottomSection.xxs||[]).filter(f=>f.i!==d)}};Kn(n,"Default",p);let m=a.filter(f=>f!==d);s(m);let g=new CustomEvent("journalit:widgets-changed",{detail:{activeWidgets:m}});document.dispatchEvent(g)}catch(u){console.error("Error removing widget:",u)}}})))};var Ke=$(W());var xq=({activeMetrics:e,activeWidgets:t,onAddMetric:r,onAddWidget:n,onClose:i})=>{let o=Ge(),[a,s]=(0,Ke.useState)("all"),[l,c]=(0,Ke.useState)(""),d=Array.from(new Set(wi.map(g=>g.category||"general"))),u=[{id:"all",name:"All Widgets"},{id:"metrics",name:"Metrics"},...d.map(g=>({id:g,name:g.charAt(0).toUpperCase()+g.slice(1)}))],p=JV.filter(g=>l===""||g.name.toLowerCase().includes(l.toLowerCase())),m=wi.filter(g=>{let f=l===""||g.name.toLowerCase().includes(l.toLowerCase()),y=a==="all"||g.category===a;return f&&y});return Ke.default.createElement("div",{className:"unified-selector-overlay",onClick:g=>{g.target===g.currentTarget&&i()}},Ke.default.createElement("div",{className:"journalit-dashboard-component-selector",onClick:g=>g.stopPropagation()},Ke.default.createElement("div",{className:"journalit-dashboard-component-selector-header"},Ke.default.createElement("h3",null,"Add Widget"),Ke.default.createElement("button",{className:"journalit-dashboard-component-selector-close",onClick:i,"aria-label":"Close"},Ke.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ke.default.createElement("path",{d:"M13 1L1 13M1 1L13 13",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})))),Ke.default.createElement("div",{className:"journalit-dashboard-component-selector-search"},Ke.default.createElement("input",{type:"text",placeholder:"Search widgets...",value:l,onChange:g=>c(g.target.value)})),Ke.default.createElement("div",{className:"journalit-dashboard-component-selector-categories"},u.map(g=>Ke.default.createElement("button",{key:g.id,className:`journalit-dashboard-component-selector-category ${a===g.id?"active":""}`,onClick:()=>s(g.id)},g.name))),Ke.default.createElement("div",{className:"journalit-dashboard-component-selector-list"},a==="all"&&Ke.default.createElement(Ke.default.Fragment,null,p.length===0?Ke.default.createElement("div",{className:"journalit-dashboard-component-selector-empty"},"No metrics found"):p.map(g=>Ke.default.createElement("div",{key:g.id,className:"journalit-dashboard-component-selector-item",onClick:()=>{if(!e.includes(g.id)&&(r(g.id),o))try{let f=jn(o),y=[...f.topSection];y.includes(g.id)||y.push(g.id);let h={...f,topSection:y};Kn(o,"Default",h).then(()=>{let v=new CustomEvent("journalit:metrics-changed",{detail:{activeMetrics:y}});document.dispatchEvent(v)}).catch(v=>{console.error("Error saving layout:",v)})}catch(f){console.error("Error adding metric:",f)}},style:{opacity:e.includes(g.id)?.5:1}},Ke.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-name"},g.name),g.description&&Ke.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-description"},g.description),e.includes(g.id)&&Ke.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-badge"},"Added"))),p.length>0&&m.length>0&&Ke.default.createElement("div",{className:"journalit-dashboard-component-selector-divider"}),m.length===0?Ke.default.createElement("div",{className:"journalit-dashboard-component-selector-empty"},"No widgets found"):m.map(g=>Ke.default.createElement("div",{key:g.id,className:"journalit-dashboard-component-selector-item",onClick:()=>{if(!t.includes(g.id)&&o)try{let f=jn(o),y=wi.find(b=>b.id===g.id);if(!y)throw new Error(`Widget definition not found: ${g.id}`);let h=Fu(f.bottomSection.lg,g.id,y.defaultSize.w,y.defaultSize.h,o),v={...f,bottomSection:{lg:[...f.bottomSection.lg,h],md:[...f.bottomSection.md,h],sm:[...f.bottomSection.sm,h],xs:[...f.bottomSection.xs||[],{...h,w:Math.min(h.w,2)}],xxs:[...f.bottomSection.xxs||[],{...h,w:1}]}};Kn(o,"Default",v).then(()=>{n(g.id);let b=[...t,g.id],w=new CustomEvent("journalit:widgets-changed",{detail:{activeWidgets:b}});document.dispatchEvent(w)}).catch(b=>{console.error("Error saving layout after adding widget:",b)})}catch(f){console.error("Error adding widget:",f)}},style:{opacity:t.includes(g.id)?.5:1}},Ke.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-name"},g.name),g.description&&Ke.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-description"},g.description),t.includes(g.id)&&Ke.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-badge"},"Added")))),a==="metrics"&&Ke.default.createElement(Ke.default.Fragment,null,p.length===0?Ke.default.createElement("div",{className:"journalit-dashboard-component-selector-empty"},"No metrics found"):p.map(g=>Ke.default.createElement("div",{key:g.id,className:"journalit-dashboard-component-selector-item",onClick:()=>{if(!e.includes(g.id)&&(r(g.id),o))try{let f=jn(o),y=[...f.topSection];y.includes(g.id)||y.push(g.id);let h={...f,topSection:y};Kn(o,"Default",h).then(()=>{let v=new CustomEvent("journalit:metrics-changed",{detail:{activeMetrics:y}});document.dispatchEvent(v)}).catch(v=>{console.error("Error saving layout:",v)})}catch(f){console.error("Error adding metric:",f)}},style:{opacity:e.includes(g.id)?.5:1}},Ke.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-name"},g.name),g.description&&Ke.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-description"},g.description),e.includes(g.id)&&Ke.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-badge"},"Added")))),a!=="metrics"&&a!=="all"&&Ke.default.createElement(Ke.default.Fragment,null,m.length===0?Ke.default.createElement("div",{className:"journalit-dashboard-component-selector-empty"},"No widgets found"):m.map(g=>Ke.default.createElement("div",{key:g.id,className:"journalit-dashboard-component-selector-item",onClick:()=>{if(!t.includes(g.id)&&o)try{let f=jn(o),y=wi.find(b=>b.id===g.id);if(!y)throw new Error(`Widget definition not found: ${g.id}`);let h=Fu(f.bottomSection.lg,g.id,y.defaultSize.w,y.defaultSize.h,o),v={...f,bottomSection:{lg:[...f.bottomSection.lg,h],md:[...f.bottomSection.md,h],sm:[...f.bottomSection.sm,h],xs:[...f.bottomSection.xs||[],{...h,w:Math.min(h.w,2)}],xxs:[...f.bottomSection.xxs||[],{...h,w:1}]}};Kn(o,"Default",v).then(()=>{n(g.id);let b=[...t,g.id],w=new CustomEvent("journalit:widgets-changed",{detail:{activeWidgets:b}});document.dispatchEvent(w)}).catch(b=>{console.error("Error saving layout after adding widget:",b)})}catch(f){console.error("Error adding widget:",f)}},style:{opacity:t.includes(g.id)?.5:1}},Ke.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-name"},g.name),g.description&&Ke.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-description"},g.description),t.includes(g.id)&&Ke.default.createElement("div",{className:"journalit-dashboard-component-selector-widget-badge"},"Added")))))))};var kq=({isLoading:e,dashboardData:t,filters:r,isEditing:n,showUnifiedSelector:i,activeMetrics:o,activeWidgets:a,onAddMetric:s,onAddWidget:l,onCloseSelector:c,openUnifiedSelector:d})=>{let u=Ge(),p=()=>{if(!u||!u.app)return;let m=u.app.workspace.getLeavesOfType(Ir);if(m.length>0){u.app.workspace.revealLeaf(m[0]);return}let g=u.app.workspace.getRightLeaf(!1);g&&g.setViewState({type:Ir,active:!0}).then(()=>{u.app.workspace.revealLeaf(g)})};return e?Ri.default.createElement("div",{className:"journalit-dashboard-loading"},"Loading dashboard..."):!t||t.trades.length===0?Ri.default.createElement("div",{style:{padding:"40px 0",display:"flex",justifyContent:"center",alignItems:"center",flex:"1",width:"100%",minHeight:"300px"}},Ri.default.createElement(Ae,{message:"No trading data available",subMessage:"Add some trades to see your dashboard come to life",iconSize:56,actionButtonText:"Add Trade",onActionButtonClick:p})):Ri.default.createElement(Ri.default.Fragment,null,n&&Ri.default.createElement("div",{className:"journalit-dashboard-unified-selector-button-container",style:{marginBottom:"4px"}},Ri.default.createElement("button",{className:"journalit-dashboard-add-component-button",onClick:d},Ri.default.createElement("span",null,"+")," Add Widget")),Ri.default.createElement("div",{className:"journalit-dashboard-unified-container",style:{gap:"10px",backgroundColor:"transparent"}},Ri.default.createElement("div",{style:{position:"relative"}},Ri.default.createElement(mO,{filters:r,isEditing:n,hideAddButton:!0})),Ri.default.createElement("div",{style:{position:"relative"}},Ri.default.createElement(uI,{filters:r,isEditing:n,hideAddButton:!0}))),i&&Ri.default.createElement(xq,{activeMetrics:o,activeWidgets:a,onAddMetric:s,onAddWidget:l,onClose:c}))};var rr=$(W());var pI=()=>{var C,N;let e=Ge(),[t,r]=(0,rr.useState)(()=>({dateRange:[null,null],accounts:[],tickers:[]})),[n,i]=(0,rr.useState)(!1),[o,a]=(0,rr.useState)(!1),[s,l]=(0,rr.useState)(!1),[c,d]=(0,rr.useState)(0),[u,p]=(0,rr.useState)([]),[m,g]=(0,rr.useState)([]);(0,rr.useEffect)(()=>{d(D=>D+1)},[m,u]);let f=(0,rr.useCallback)(D=>{g(D.detail.activeWidgets)},[]),y=(0,rr.useCallback)(D=>{p(D.detail.activeMetrics)},[]),h=(0,rr.useCallback)(()=>{document.dispatchEvent(new CustomEvent("journalit:trade-data-changed"))},[]);(0,rr.useEffect)(()=>(document.addEventListener("journalit:widgets-changed",f),()=>{document.removeEventListener("journalit:widgets-changed",f)}),[f]);let v=(0,rr.useMemo)(()=>e?jn(e):null,[e]);(0,rr.useEffect)(()=>(document.querySelector('[data-dashboard-styles="true"]')||(qC(),bp(),document.documentElement.setAttribute("data-dashboard-styles","true")),(async()=>{try{e&&v&&(p(v.topSection),g(v.bottomSection.lg.map(A=>A.i)),requestAnimationFrame(()=>{Jg()}))}catch(A){console.error("Failed to initialize dashboard:",A)}})(),document.addEventListener("journalit:metrics-changed",y),document.addEventListener("journalit:trade-data-changed",h),()=>{document.removeEventListener("journalit:metrics-changed",y),document.removeEventListener("journalit:trade-data-changed",h)}),[e,v,y,h]),(0,rr.useEffect)(()=>{var D,A;((A=(D=e==null?void 0:e.settings)==null?void 0:D.trade)==null?void 0:A.skipWeekends)!==void 0&&requestAnimationFrame(()=>{Jg()})},[(N=(C=e==null?void 0:e.settings)==null?void 0:C.trade)==null?void 0:N.skipWeekends]);let b=(0,rr.useCallback)(D=>{r(D)},[]),w=(0,rr.useCallback)(()=>{a(D=>{let A=!D;return A===!1&&s&&l(!1),A})},[s]),k=(0,rr.useCallback)(()=>{l(!0),setTimeout(()=>bp(),10)},[]),S=(0,rr.useCallback)(()=>{l(!1)},[]),x=(0,rr.useCallback)(D=>{try{if(!u.includes(D)&&(p(A=>[...A,D]),e&&v)){let A={...v,topSection:[...u,D]};Kn(e,"Default",A).catch(P=>{console.error("Error saving layout after adding metric:",P)})}}catch(A){console.error("Error in handleAddMetric:",A)}},[u,e,v]),T=(0,rr.useMemo)(()=>{let D={lg:12,md:6,sm:4,xs:2,xxs:1};return(A,P,I)=>{let M=D[P],O=Math.min(I.defaultSize.w,M);return{i:A,x:0,y:1e4,w:O,h:I.defaultSize.h}}},[]),E=(0,rr.useCallback)(D=>{if(!(!e||!v||m.includes(D)))try{let A=wi.find(O=>O.id===D);if(!A){console.warn(`Widget definition not found: ${D}`);return}let I=["lg","md","sm","xs","xxs"].reduce((O,F)=>(O[F]=T(D,F,A),O),{}),M={...v,bottomSection:{lg:[...v.bottomSection.lg,I.lg],md:[...v.bottomSection.md,I.md],sm:[...v.bottomSection.sm,I.sm],xs:[...v.bottomSection.xs||[],I.xs],xxs:[...v.bottomSection.xxs||[],I.xxs]}};Kn(e,"Default",M),g(O=>[...O,D])}catch(A){console.error("Error adding widget:",A)}},[m,e,v,T]);return{filters:t,setFilters:r,isLoading:n,isEditing:o,showUnifiedSelector:s,selectorKey:c,activeMetrics:u,activeWidgets:m,handleFilterChange:b,toggleEditMode:w,openUnifiedSelector:k,closeUnifiedSelector:S,handleAddMetric:x,handleAddWidget:E}};var Ia="journalit-dashboard-view",sy=class extends wc{getDisplayText(){return"Journalit Dashboard"}getViewType(){return Ia}getIcon(){return"grip"}async onOpen(){try{await super.onOpen(),Po(!0,!0,!0,!0),Di(!0,!0,!0,!0),this.containerEl&&(this.containerEl.classList.add("journalit-dashboard-view-container"),Object.assign(this.containerEl.style,{padding:"0",overflow:"hidden"})),bp()}catch(t){console.error("Error in DashboardView.onOpen:",t)}}async onClose(){try{await super.onClose()}catch(t){console.error("Error in DashboardView.onClose:",t)}}getRenderFunction(){return()=>Xc.default.createElement(Pfe,{leaf:this.leaf,view:this})}},Pfe=({leaf:e,view:t})=>{let r=Ge(),{filters:n,isLoading:i,isEditing:o,showUnifiedSelector:a,activeMetrics:s,activeWidgets:l,handleFilterChange:c,toggleEditMode:d,openUnifiedSelector:u,closeUnifiedSelector:p,handleAddMetric:m,handleAddWidget:g}=pI();return r?Xc.default.createElement(rV,{app:r.app,tradeService:r.tradeService,filters:n},Xc.default.createElement("div",{className:"journalit-dashboard-view"},Xc.default.createElement(tO,{filters:n,onFilterChange:c,isEditing:o,onToggleEditMode:d}),Xc.default.createElement(Afe,{isLoading:i,filters:n,isEditing:o,showUnifiedSelector:a,activeMetrics:s,activeWidgets:l,onAddMetric:m,onAddWidget:g,onCloseSelector:p,openUnifiedSelector:u}))):Xc.default.createElement("div",{className:"journalit-dashboard-view"},"Loading...")},Afe=e=>{let{dashboardData:t}=ff();return Xc.default.createElement(kq,{...e,dashboardData:t})};var _q=require("obsidian"),zq=$(W()),$q=$(Ps());Jr();Yt();var ly=new Map,Nfe=10;function Sq(e){if(e==null)return"null";if(typeof e!="object")return JSON.stringify(e);let t={};return Object.keys(e).sort().forEach(r=>{t[r]=typeof e[r]=="object"&&e[r]!==null?Sq(e[r]):e[r]}),JSON.stringify(t)}function Tq(e,t){var m,g;if(!e||e.length===0)return{totalAccounts:0,totalAUM:0,totalGrowthAmount:0,totalGrowthPercent:0,totalWithdrawals:0,totalTrades:0};let r=((m=t==null?void 0:t.account)==null?void 0:m.excludedAccountTypes)||["archived","demo"],n=((g=t==null?void 0:t.account)==null?void 0:g.includeWithdrawalsFromExcluded)||{archived:!0,demo:!1},i=e.filter(f=>!r.includes(f.accountType.toLowerCase())),o=[...i,...e.filter(f=>r.includes(f.accountType.toLowerCase())&&n[f.accountType.toLowerCase()])],a=i.length,s=i.reduce((f,y)=>f+y.currentBalance,0),l=i.reduce((f,y)=>f+y.initialBalance,0),c=s-l,d=l>0?c/l*100:0,u=o.reduce((f,y)=>{let h=y.transactions.filter(v=>v.type==="withdrawal"||v.type==="deposit"&&v.amount<0).reduce((v,b)=>v+Math.abs(b.amount),0);return f+h},0),p=i.reduce((f,y)=>f+y.metrics.totalTrades,0);return{totalAccounts:a,totalAUM:s,totalGrowthAmount:c,totalGrowthPercent:d,totalWithdrawals:u,totalTrades:p}}function Cq(e,t){var m;if(!e||e.length===0)return[];let r=e.map(g=>g.id).sort().join(","),n=Sq(t||{}),i=`${r}:${n}`,o=ly.get(i);if(o)return o.data;let a=((m=t==null?void 0:t.account)==null?void 0:m.excludedAccountTypes)||["archived","demo"],s=e.filter(g=>!a.includes(g.accountType.toLowerCase()));if(s.length===0)return[];let l=new Map,c=new Map;s.forEach(g=>{let f=new Map,y=new Date(g.createdDate).toISOString().split("T")[0];l.has(y)||l.set(y,{depositsForDay:0,withdrawalsForDay:0}),l.get(y).accountCreated=g.id;let h=[...g.transactions].sort((b,w)=>new Date(b.date).getTime()-new Date(w.date).getTime()),v=g.initialBalance;if(h.forEach(b=>{let w=new Date(b.date).toISOString().split("T")[0];v=b.balanceAfter,f.set(w,v),l.has(w)||l.set(w,{depositsForDay:0,withdrawalsForDay:0});let k=l.get(w);b.type==="deposit"&&b.amount>0?k.depositsForDay+=b.amount:(b.type==="withdrawal"||b.type==="deposit"&&b.amount<0)&&(k.withdrawalsForDay+=Math.abs(b.amount))}),g.accountType.toLowerCase()==="archived"&&h.length>0){let b=h[h.length-1],w=new Date(b.date).toISOString().split("T")[0];l.has(w)||l.set(w,{depositsForDay:0,withdrawalsForDay:0}),l.get(w).accountArchived=g.id}c.set(g.id,f)});let d=[...l.keys()].sort(),u=[],p=new Map;if(s.forEach(g=>{p.set(g.id,g.initialBalance)}),d.forEach(g=>{let f=new Date(g),y=l.get(g);s.forEach(v=>{if(new Date(v.createdDate)<=f){let b=c.get(v.id),w=v.initialBalance;for(let[k,S]of b)if(k<=g)w=S;else break;p.set(v.id,w)}});let h=0;for(let[v,b]of p){let w=s.find(k=>k.id===v);new Date(w.createdDate)<=f&&(h+=b)}u.push({date:Ze(f,fr()),rawDate:f,balance:h,isDeposit:y.depositsForDay>0,depositAmount:y.depositsForDay>0?y.depositsForDay:void 0,isWithdrawal:y.withdrawalsForDay>0,withdrawalAmount:y.withdrawalsForDay>0?y.withdrawalsForDay:void 0,accountCreated:y.accountCreated,accountArchived:y.accountArchived})}),ly.size>=Nfe){let g=ly.keys().next().value;ly.delete(g)}return ly.set(i,{settings:t,data:u}),u}function Eq(e){if(!e||e.length===0)return{};let t=e.reduce((n,i)=>{let o=i.accountType.toLowerCase();return n[o]||(n[o]=[]),n[o].push(i),n},{}),r={};return Object.entries(t).forEach(([n,i])=>{let o=i[0].accountType;r[o]=i}),r}function mI(e){return e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()).join(" ")}function Dq(e){let r=Math.abs(new Date().getTime()-new Date(e).getTime()),n=Math.floor(r/(1e3*60*60*24));if(n<30)return`${n} day${n===1?"":"s"}`;if(n<365){let i=Math.floor(n/30);return`${i} month${i===1?"":"s"}`}else{let i=Math.floor(n/365),o=Math.floor(n%365/30);return o===0?`${i} year${i===1?"":"s"}`:`${i}y ${o}m`}}function Pq(e){if(e.drawdownType==="none"||e.drawdownAmount<=0)return 0;let r=(e.currentBalance-e.maxDrawdownReached)/e.drawdownAmount*100;return Math.min(100,Math.max(0,r))}function Aq(e){if(e.drawdownType==="none"||e.drawdownAmount<=0)return"No drawdown set";let t=e.currentBalance-e.maxDrawdownReached,r=t/e.drawdownAmount*100;return`${fe(t)}/${fe(e.drawdownAmount)} (${r.toFixed(1)}% remaining)`}function Nq(e){return!e.monthlyCost||e.monthlyCost<=0?"N/A":fe(e.monthlyCost)}function Mq(e){if(!e.hasProfitTarget||e.profitTarget<=0)return"N/A";let t=e.profitTargetType==="percentage"?e.initialBalance*e.profitTarget/100:e.profitTarget,r=e.metrics.totalPnL,n=r/t*100;return`${fe(r)} / ${fe(t)} (${n.toFixed(1)}%)`}function Oq(e){if(!e.hasProfitTarget||e.profitTarget<=0)return 0;let t=e.profitTargetType==="percentage"?e.initialBalance*e.profitTarget/100:e.profitTarget,n=e.metrics.totalPnL/t*100;return Math.min(100,Math.max(0,n))}var pt=$(W());var Ue=$(W());var Mfe=(e,t)=>{let r=t-e,n;r<=100?n=10:r<=1e3?n=100:r<=1e4?n=1e3:r<=1e5?n=1e4:r<=1e6?n=1e5:n=1e6;let i=Math.floor(e/n)*n,o=[];for(let a=i;a<=t+n;a+=n)o.push(a);if(o.length>10){let a=[],s=Math.ceil(o.length/7);for(let l=0;l<o.length;l+=s)a.push(o[l]);return a[a.length-1]!==o[o.length-1]&&a.push(o[o.length-1]),a}return o},Ofe=({active:e,payload:t})=>{if(!e||!t||t.length===0)return null;let r=t[0].payload;return Ue.default.createElement("div",{className:"journalit-chart-tooltip",style:{backgroundColor:"var(--background-primary)",borderRadius:"8px",padding:"12px 16px",minWidth:"180px",border:"1px solid var(--background-modifier-border)",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.2)",transform:"translateY(-4px)",position:"relative"}},Ue.default.createElement("div",{className:"journalit-chart-tooltip-date",style:{fontSize:"14px",fontWeight:500,color:"var(--text-normal)",marginBottom:"8px",textAlign:"center"}},r.date),Ue.default.createElement("div",{className:"journalit-chart-tooltip-value",style:{fontSize:"18px",fontWeight:600,textAlign:"center",color:"var(--text-normal)"}},"AUM: ",fe(r.balance)),(r.isDeposit||r.isWithdrawal||r.accountCreated||r.accountArchived)&&Ue.default.createElement("div",{style:{marginTop:"8px",padding:"6px 0",borderTop:"1px solid var(--background-modifier-border)",fontSize:"13px"}},r.isDeposit&&Ue.default.createElement("div",{style:{color:"#41B4F7"}},"Deposit: ",fe(r.depositAmount)),r.isWithdrawal&&Ue.default.createElement("div",{style:{color:"var(--text-warning, gold)"}},"Withdrawal: ",fe(r.withdrawalAmount)),r.accountCreated&&Ue.default.createElement("div",{style:{color:"var(--text-success)"}},"Account Added"),r.accountArchived&&Ue.default.createElement("div",{style:{color:"var(--text-error)"}},"Account Archived")))},Iq=({data:e,height:t=300})=>{if(!e||e.length===0)return Ue.default.createElement("div",{style:{height:`${t}px`,display:"flex",alignItems:"center",justifyContent:"center"}},Ue.default.createElement(Ae,{message:"No account data",subMessage:"Add accounts to view AUM history"}));let r=e.map(a=>a.balance),n=Math.min(...r),i=Math.max(...r),o=i-n;return i=i+o*.05,n=n-o*.1,n=0,Ue.default.createElement("div",{className:"aum-chart"},Ue.default.createElement("div",{style:{width:"100%",height:`${t}px`,padding:"0 10px"}},Ue.default.createElement(is,{width:"100%",height:"100%"},Ue.default.createElement($v,{data:e,margin:{top:10,right:10,left:0,bottom:10}},Ue.default.createElement("defs",null,Ue.default.createElement("linearGradient",{id:"aumGradient",x1:"0",y1:"0",x2:"0",y2:"1"},Ue.default.createElement("stop",{offset:"0%",stopColor:"#41B4F7",stopOpacity:.6}),Ue.default.createElement("stop",{offset:"100%",stopColor:"#41B4F7",stopOpacity:.1})),Ue.default.createElement("filter",{id:"aumShadow",height:"120%"},Ue.default.createElement("feDropShadow",{dx:"0",dy:"1",stdDeviation:"2",floodOpacity:"0.1"})),Ue.default.createElement("filter",{id:"aumGlow",height:"130%"},Ue.default.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"2",result:"blur"}),Ue.default.createElement("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7",result:"glow"}),Ue.default.createElement("feComposite",{in:"SourceGraphic",in2:"glow",operator:"over"}))),Ue.default.createElement(hi,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),Ue.default.createElement(bn,{dataKey:"date",style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:8,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5}}),Ue.default.createElement(wn,{tickFormatter:a=>fe(a),style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:[n,i],allowDataOverflow:!1,width:60,tickLine:!1,axisLine:!1,tickMargin:8,ticks:Mfe(n,i)}),Ue.default.createElement(Li,{content:Ue.default.createElement(Ofe,null),cursor:{fill:"var(--interactive-hover)",fillOpacity:.1,strokeOpacity:.3,strokeWidth:1,stroke:"#41B4F7"},wrapperStyle:{zIndex:1e3}}),Ue.default.createElement(Hr,{y:0,stroke:"var(--text-normal)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1}),Ue.default.createElement(co,{type:"monotone",dataKey:"balance",stroke:"none",fill:"url(#aumGradient)",fillOpacity:1,dot:!1,activeDot:!1,filter:"url(#aumShadow)"}),Ue.default.createElement(qs,{type:"monotone",dataKey:"balance",stroke:"#41B4F7",strokeWidth:2.5,dot:a=>{let{cx:s,cy:l,payload:c}=a;return c?c.accountCreated?Ue.default.createElement("g",null,Ue.default.createElement("line",{x1:s,y1:l-15,x2:s,y2:l+15,stroke:"var(--text-success)",strokeWidth:"2"}),Ue.default.createElement("circle",{cx:s,cy:l,r:"5",fill:"var(--background-primary)",stroke:"var(--text-success)",strokeWidth:"2"})):c.accountArchived?Ue.default.createElement("g",null,Ue.default.createElement("line",{x1:s,y1:l-15,x2:s,y2:l+15,stroke:"var(--text-error)",strokeWidth:"2"}),Ue.default.createElement("circle",{cx:s,cy:l,r:"5",fill:"var(--background-primary)",stroke:"var(--text-error)",strokeWidth:"2"})):c.isDeposit?Ue.default.createElement("g",null,Ue.default.createElement("line",{x1:s,y1:l-15,x2:s,y2:l+15,stroke:"#41B4F7",strokeWidth:"2"}),Ue.default.createElement("circle",{cx:s,cy:l,r:"5",fill:"var(--background-primary)",stroke:"#41B4F7",strokeWidth:"2"})):c.isWithdrawal?Ue.default.createElement("g",null,Ue.default.createElement("line",{x1:s,y1:l-15,x2:s,y2:l+15,stroke:"var(--text-warning, gold)",strokeWidth:"2"}),Ue.default.createElement("circle",{cx:s,cy:l,r:"5",fill:"var(--background-primary)",stroke:"var(--text-warning, gold)",strokeWidth:"2"})):Ue.default.createElement("circle",{cx:s,cy:l,r:"3",fill:"var(--text-muted)",stroke:"var(--background-primary)",strokeWidth:"1"}):Ue.default.createElement("circle",{cx:0,cy:0,r:0,opacity:0})},activeDot:{r:7,stroke:"var(--background-primary)",strokeWidth:1,fill:"#41B4F7",filter:"url(#aumGlow)"},name:"AUM Balance"})))))};var an=$(W());var Fq=({metrics:e})=>{let t=e.totalGrowthAmount>=0?"positive":"negative";return an.default.createElement("div",{className:"dashboard-metrics"},an.default.createElement("div",{className:"metric-item"},an.default.createElement("div",{className:"metric-value"},e.totalAccounts),an.default.createElement("div",{className:"metric-label"},"Total Accounts")),an.default.createElement("div",{className:"metric-item"},an.default.createElement("div",{className:"metric-value"},fe(e.totalAUM)),an.default.createElement("div",{className:"metric-label"},"Total AUM")),an.default.createElement("div",{className:"metric-item"},an.default.createElement("div",{className:`metric-value ${t}`},fe(e.totalGrowthAmount)),an.default.createElement("div",{className:"metric-label"},"Total Growth")),an.default.createElement("div",{className:"metric-item"},an.default.createElement("div",{className:`metric-value ${t}`},e.totalGrowthPercent.toFixed(2),"%"),an.default.createElement("div",{className:"metric-label"},"Growth %")),an.default.createElement("div",{className:"metric-item"},an.default.createElement("div",{className:"metric-value"},fe(e.totalWithdrawals)),an.default.createElement("div",{className:"metric-label"},"Total Withdrawals")),an.default.createElement("div",{className:"metric-item"},an.default.createElement("div",{className:"metric-value"},e.totalTrades),an.default.createElement("div",{className:"metric-label"},"Total Trades")))};var fo=$(W());var Pt=$(W());Jr();var Ife=({account:e,onClick:t})=>{let r=(0,Pt.useMemo)(()=>{let n=Dq(e.createdDate),i=e.currentBalance-e.initialBalance,o=e.initialBalance>0?i/e.initialBalance*100:0,a=i>=0?"positive":"negative",s=Oq(e),l=s>=100?"complete":"",c=Pq(e),d="";return c<=25?d="critical":c<=50?d="warning":d="safe",{accountAge:n,growthAmount:i,growthPercent:o,growthClass:a,profitTargetProgress:s,profitTargetProgressClass:l,drawdownRemaining:c,drawdownProgressClass:d}},[e.createdDate,e.currentBalance,e.initialBalance,e.profitTarget,e.hasProfitTarget,e.drawdownType,e.drawdownAmount,e.metrics.maxDrawdown]);return Pt.default.createElement("div",{className:"account-card",onClick:t},Pt.default.createElement("div",{className:"account-card-header"},Pt.default.createElement("div",{className:"account-name"},e.name),Pt.default.createElement("div",{className:"account-balance"},fe(e.currentBalance))),Pt.default.createElement("div",{className:"account-card-metrics"},Pt.default.createElement("div",{className:"account-metric"},Pt.default.createElement("div",{className:"metric-label"},"Growth"),Pt.default.createElement("div",{className:`metric-value ${r.growthClass}`},fe(r.growthAmount)," (",r.growthPercent.toFixed(2),"%)")),Pt.default.createElement("div",{className:"account-metric"},Pt.default.createElement("div",{className:"metric-label"},"Trades"),Pt.default.createElement("div",{className:"metric-value"},e.metrics.totalTrades)),Pt.default.createElement("div",{className:"account-metric"},Pt.default.createElement("div",{className:"metric-label"},"Age"),Pt.default.createElement("div",{className:"metric-value"},r.accountAge)),Pt.default.createElement("div",{className:"account-metric"},Pt.default.createElement("div",{className:"metric-label"},"Monthly Costs"),Pt.default.createElement("div",{className:"metric-value"},Nq(e))),Pt.default.createElement("div",{className:"account-metric profit-target"},Pt.default.createElement("div",{className:"metric-label"},"Profit Target"),Pt.default.createElement("div",{className:"metric-value"},e.hasProfitTarget&&e.profitTarget>0?Mq(e):"No profit target set"),e.hasProfitTarget&&e.profitTarget>0&&Pt.default.createElement("div",{className:"profit-target-progress"},Pt.default.createElement("div",{className:`progress-bar ${r.profitTargetProgressClass}`,style:{width:`${r.profitTargetProgress}%`}}))),Pt.default.createElement("div",{className:"account-metric drawdown-target"},Pt.default.createElement("div",{className:"metric-label"},"Drawdown"),Pt.default.createElement("div",{className:"metric-value"},e.drawdownType!=="none"&&e.drawdownAmount>0?Aq(e):"No drawdown set"),e.drawdownType!=="none"&&e.drawdownAmount>0&&Pt.default.createElement("div",{className:"drawdown-progress"},Pt.default.createElement("div",{className:`progress-bar ${r.drawdownProgressClass}`,style:{width:`${r.drawdownRemaining}%`}})))))},Ffe=(e,t)=>e.account.name===t.account.name&&e.account.currentBalance===t.account.currentBalance&&e.account.initialBalance===t.account.initialBalance&&e.account.metrics.totalTrades===t.account.metrics.totalTrades&&e.account.metrics.maxDrawdown===t.account.metrics.maxDrawdown&&e.account.profitTarget===t.account.profitTarget&&e.account.hasProfitTarget===t.account.hasProfitTarget&&e.account.drawdownType===t.account.drawdownType&&e.account.drawdownAmount===t.account.drawdownAmount&&e.account.createdDate===t.account.createdDate&&e.onClick===t.onClick,QS=Pt.default.memo(Ife,Ffe);var _n=$(W());var fI=_n.default.memo(({accounts:e,openAccount:t,itemHeight:r=140,containerHeight:n=600,overscan:i=3})=>{let[o,a]=(0,_n.useState)(0),s=(0,_n.useRef)(null),l=(0,_n.useMemo)(()=>{let m=Math.max(0,Math.floor(o/r)-i),g=Math.ceil(n/r),f=Math.min(e.length,m+g+i*2);return{start:m,end:f}},[o,r,n,e.length,i]),c=(0,_n.useMemo)(()=>e.slice(l.start,l.end),[e,l]),d=(0,_n.useCallback)(()=>{s.current&&requestAnimationFrame(()=>{s.current&&a(s.current.scrollTop)})},[]),u=e.length*r,p=l.start*r;return(0,_n.useEffect)(()=>{let m=s.current;if(!m)return;let g=new ResizeObserver(()=>{d()});return g.observe(m),()=>{g.disconnect()}},[d]),_n.default.createElement("div",{ref:s,className:"virtualized-account-list",style:{height:n,overflowY:"auto",position:"relative"},onScroll:d},_n.default.createElement("div",{style:{height:u,position:"relative"}},_n.default.createElement("div",{style:{transform:`translateY(${p}px)`,position:"absolute",top:0,left:0,right:0}},c.map(m=>_n.default.createElement("div",{key:m.id,style:{height:r,display:"flex",alignItems:"center"}},_n.default.createElement(QS,{account:m,onClick:()=>t(m.notePath)}))))))},(e,t)=>e.accounts===t.accounts&&e.openAccount===t.openAccount&&e.itemHeight===t.itemHeight&&e.containerHeight===t.containerHeight&&e.overscan===t.overscan);fI.displayName="VirtualizedAccountList";var jfe=({type:e,accounts:t,openAccount:r})=>{let n=(0,fo.useMemo)(()=>[...t].sort((o,a)=>a.currentBalance-o.currentBalance),[t]),i=n.length>10;return fo.default.createElement("div",{className:"account-section"},fo.default.createElement("h3",null,mI(e)),n.length===0?fo.default.createElement(Ae,{message:`No ${mI(e)} accounts`,subMessage:"Create an account to see it here",iconSize:40}):i?fo.default.createElement(fI,{accounts:n,openAccount:r,containerHeight:600,itemHeight:140}):fo.default.createElement("div",{className:"account-cards"},n.map(o=>fo.default.createElement(QS,{key:o.id,account:o,onClick:()=>r(o.notePath)}))))},Lfe=fo.default.memo(jfe),_fe=({accountsByType:e,openAccount:t})=>{var i,o,a;let r=(a=(o=(i=window.app)==null?void 0:i.plugins)==null?void 0:o.plugins)==null?void 0:a.journalit,n=(0,fo.useMemo)(()=>{var m,g,f,y;let s=Object.keys(e),l=((g=(m=r==null?void 0:r.settings)==null?void 0:m.account)==null?void 0:g.accountTypeOrder)||["funded","evaluation","demo","archived"],c=((y=(f=r==null?void 0:r.optionsService)==null?void 0:f.getOptions)==null?void 0:y.call(f,"account_type"))||[],d=new Set([...s.map(h=>h.toLowerCase()),...l.map(h=>h.toLowerCase()),...c.map(h=>h.toLowerCase())]),u=new Map;s.forEach(h=>u.set(h.toLowerCase(),h)),l.forEach(h=>{if(!u.has(h.toLowerCase())){let v=h.charAt(0).toUpperCase()+h.slice(1).toLowerCase();u.set(h.toLowerCase(),v)}}),c.forEach(h=>{u.has(h.toLowerCase())||u.set(h.toLowerCase(),h)});let p=[];return l.forEach(h=>{let v=u.get(h.toLowerCase());v&&d.has(h.toLowerCase())&&(p.push(v),d.delete(h.toLowerCase()))}),d.forEach(h=>{let v=u.get(h);v&&p.push(v)}),p},[e,r]);return fo.default.createElement("div",{className:"account-sections"},n.map(s=>fo.default.createElement(Lfe,{key:s,type:s,accounts:e[s]||[],openAccount:t})))},jq=fo.default.memo(_fe);var zfe=({plugin:e})=>{let[t,r]=(0,pt.useState)([]),[n,i]=(0,pt.useState)(!0),[o,a]=(0,pt.useState)(null),[s,l]=(0,pt.useState)(""),[c,d]=(0,pt.useTransition)(),u=(0,pt.useDeferredValue)(s),p=(0,pt.useRef)(0),m=5,g=(0,pt.useCallback)(async()=>{try{if(i(!0),a(null),!e.accountService){if(p.current+=1,p.current>m)throw new Error("Account service not initialized after multiple attempts");let S=300*Math.pow(2,p.current-1);console.warn(`Account service not ready, retrying in ${S}ms (attempt ${p.current}/${m})`),setTimeout(()=>g(),S);return}p.current=0;let k=await e.accountService.getAllAccounts();r(k)}catch(k){console.error("Error loading accounts:",k),a(`Error loading accounts: ${k instanceof Error?k.message:String(k)}`)}finally{p.current===0&&i(!1)}},[e]),f=(0,pt.useCallback)(()=>{d(()=>{g()})},[g]);(0,pt.useEffect)(()=>(g(),document.addEventListener("journalit:account-created",f),document.addEventListener("journalit:account-updated",f),document.addEventListener("journalit:account-deleted",f),document.addEventListener("journalit:account-transaction-added",f),document.addEventListener("journalit:account-transaction-deleted",f),()=>{document.removeEventListener("journalit:account-created",f),document.removeEventListener("journalit:account-updated",f),document.removeEventListener("journalit:account-deleted",f),document.removeEventListener("journalit:account-transaction-added",f),document.removeEventListener("journalit:account-transaction-deleted",f)}),[g,f]);let y=(0,pt.useMemo)(()=>Tq(t,e.settings),[t,e.settings]),h=(0,pt.useMemo)(()=>Cq(t,e.settings),[t,e.settings]),v=(0,pt.useMemo)(()=>u?t.filter(k=>k.name.toLowerCase().includes(u.toLowerCase())):t,[t,u]),b=(0,pt.useMemo)(()=>Eq(v),[v]),w=(0,pt.useCallback)(k=>{e.app.workspace.openLinkText(k,"",!0)},[e.app.workspace]);return n?pt.default.createElement("div",{className:"journalit-account-dashboard loading"},pt.default.createElement("div",{className:"loading-spinner"},"Loading accounts...")):o?pt.default.createElement("div",{className:"journalit-account-dashboard error"},pt.default.createElement("div",{className:"error-message"},o)):t.length===0?pt.default.createElement("div",{className:"journalit-account-dashboard"},pt.default.createElement(Ae,{message:"No Accounts Found",subMessage:"Create an account to start tracking your trading performance"})):pt.default.createElement("div",{className:"journalit-account-dashboard"},pt.default.createElement("div",{className:"dashboard-content"},pt.default.createElement(Iq,{data:h}),pt.default.createElement(Fq,{metrics:y}),pt.default.createElement(jq,{accountsByType:b,openAccount:w})))},Lq=pt.default.memo(zfe);Bn();var ZS=class extends _q.ItemView{constructor(r,n){super(r);this.root=null;this.plugin=n}getViewType(){return"account-dashboard"}getDisplayText(){return"Account Dashboard"}getIcon(){return"users"}async onOpen(){var i;(i=Z.account)!=null&&i.inject&&Z.account.inject();let r=this.containerEl.children[1];r.empty(),r.addClass("journalit-account-dashboard-container");let n=r.createDiv();this.root=(0,$q.createRoot)(n),this.renderDashboard()}async onClose(){var r;this.root&&(this.root.unmount(),this.root=null),(r=Z.account)!=null&&r.remove&&Z.account.remove()}renderDashboard(){this.root&&this.root.render(zq.createElement(Lq,{plugin:this.plugin}))}};var Gq=$(W());var rt=$(W());Yt();oi();var cy=class{constructor(t){this.cache=new Map;this.lastUpdateTime=0;this.updateThreshold=5e3;this.plugin=t,this.tradeService=Tc.getInstance(t.app,t).getTradeService(),this.tradeDataChangeHandler=r=>{this.clearCache()},document.addEventListener("journalit:trade-data-changed",this.tradeDataChangeHandler),document.addEventListener("journalit:missed-trade-data-changed",this.tradeDataChangeHandler)}async getTradesWithPaths(){await this.tradeService.clearCache(),await new Promise(o=>setTimeout(o,300));try{let o=this.plugin.app.vault.adapter;o&&o.list&&await o.list("!Journalit").catch(()=>{})}catch(o){}let t=new Date("2000-01-01"),r=new Date("2099-12-31"),n=await this.tradeService.getTrades(t,r),i=[];for(let o of n){let a=await this.tradeService.extractTradeData(o);a&&i.push({...a,filePath:o.path})}if(this.plugin.missedTradeService)try{let o=await this.plugin.missedTradeService.getMissedTrades(t,r);for(let a of o){let s=this.plugin.app.metadataCache.getFileCache(a),l=s==null?void 0:s.frontmatter;l&&l.type==="missed-trade"&&i.push({...l,filePath:a.path,isMissedTrade:!0,path:a.path})}}catch(o){console.error("Error fetching missed trades for trade log:",o)}return i}async getHierarchicalData(t,r,n){let i=`${t}-${r==null?void 0:r.toISOString()}-${n==null?void 0:n.toISOString()}`,o=Date.now();if(this.cache.has(i)&&o-this.lastUpdateTime<this.updateThreshold)return this.cache.get(i).children||[];let a=await this.getTradesWithPaths(),s=this.filterTradesByDateRange(a,r,n),l;switch(t){case"years":l=await this.buildYearNodes(s);break;case"quarters":l=await this.buildQuarterNodes(s);break;case"months":l=await this.buildMonthNodes(s);break;case"weeks":l=await this.buildWeekNodes(s);break;case"days":l=await this.buildDayNodes(s);break;case"trades":l=await this.buildTradeNodes(s);break;default:l=[]}this.markBestWorstPerformers(l);let c={type:"root",id:"root",label:"All Trades",metrics:this.calculateMetrics(s),children:l,expanded:!0,dataLoaded:!0};return this.cache.set(i,c),this.lastUpdateTime=o,l}async getNodeChildren(t){let r=await this.getTradesWithPaths(),n=this.filterTradesByNode(r,t),i=[];switch(t.type){case"year":i=this.buildQuartersForYear(n,parseInt(t.id));break;case"quarter":i=this.buildMonthsForQuarter(n,t.id);break;case"month":i=this.buildWeeksForMonth(n,t.id);break;case"week":i=this.buildDaysForWeek(n,t.id);break;case"day":i=await this.buildTradesForDay(n,t.id);break;default:return[]}return this.markBestWorstPerformers(i),i}async buildFullHierarchy(t){let r=new Map;t.forEach(o=>{let s=new Date(o.entryTime).getFullYear();r.has(s)||r.set(s,[]),r.get(s).push(o)});let n=[],i=Array.from(r.keys()).sort((o,a)=>a-o);for(let o of i){let a=r.get(o),s=this.buildQuartersForYear(a,o);n.push({type:"year",id:o.toString(),label:o.toString(),metrics:this.calculateMetrics(a),children:s,expanded:o===new Date().getFullYear(),dataLoaded:!0})}return this.markBestWorstPerformersRecursive(n),n}async buildYearNodes(t){let r=new Map;t.forEach(o=>{let s=new Date(o.entryTime).getFullYear();r.has(s)||r.set(s,[]),r.get(s).push(o)});let n=[],i=Array.from(r.keys()).sort((o,a)=>a-o);for(let o of i){let a=r.get(o);n.push({type:"year",id:o.toString(),label:o.toString(),metrics:this.calculateMetrics(a),expanded:!1,dataLoaded:!1})}return n}calculateMetrics(t){if(t.length===0)return{totalPnL:0,winRate:0,tradeCount:0};let r=t.filter(d=>this.getTradeStatus(d)==="open"),n=t.filter(d=>this.getTradeStatus(d)!=="open"&&!d.isMissedTrade),i=n.filter(d=>(d.pnl||0)>0).length,o=n.filter(d=>(d.pnl||0)<0).length,a=n.reduce((d,u)=>d+(u.pnl||0),0),s=new Map;n.forEach(d=>{let u=new Date(d.entryTime),p=xl(u,this.plugin);s.set(p,(s.get(p)||0)+(d.pnl||0))});let l={label:"",pnl:-1/0},c={label:"",pnl:1/0};return s.forEach((d,u)=>{d>l.pnl&&(l={label:u,pnl:d}),d<c.pnl&&(c={label:u,pnl:d})}),{totalPnL:a,winRate:n.length>0?i/n.length*100:0,tradeCount:t.length,openTradeCount:r.length,closedTradeCount:n.length,bestPeriod:l.label?l:void 0,worstPeriod:c.label?c:void 0}}getTradeStatus(t){return I2(t)}filterTradesByDateRange(t,r,n){return!r&&!n?t:t.filter(i=>{let o=new Date(i.entryTime);return!(r&&o<r||n&&o>n)})}filterTradesByNode(t,r){switch(r.type){case"year":let n=parseInt(r.id);return t.filter(m=>new Date(m.entryTime).getFullYear()===n);case"quarter":let[i,o]=r.id.split("-Q"),s=(parseInt(o)-1)*3,l=s+2;return t.filter(m=>{let g=new Date(m.entryTime);return g.getFullYear()===parseInt(i)&&g.getMonth()>=s&&g.getMonth()<=l});case"month":let[c,d]=r.id.split("-");return t.filter(m=>{let g=new Date(m.entryTime);return g.getFullYear()===parseInt(c)&&g.getMonth()===parseInt(d)-1});case"week":let[u,p]=r.id.split("-W");return t.filter(m=>{let g=new Date(m.entryTime);return g.getFullYear()===parseInt(u)&&fl(g)===parseInt(p)});case"day":return t.filter(m=>{let g=new Date(m.entryTime);return xl(g,this.plugin)===r.id});default:return t}}async buildQuarterNodes(t){let r=new Map;t.forEach(o=>{let a=new Date(o.entryTime),s=a.getFullYear(),l=_C(a),c=`${s}-Q${l}`;r.has(c)||r.set(c,[]),r.get(c).push(o)});let n=[],i=Array.from(r.keys()).sort((o,a)=>a.localeCompare(o));for(let o of i){let a=r.get(o),[s,l]=o.split("-Q");n.push({type:"quarter",id:o,label:`Q${l} ${s}`,metrics:this.calculateMetrics(a),expanded:!1,dataLoaded:!1})}return n}async buildMonthNodes(t){let r=new Map;t.forEach(a=>{let s=new Date(a.entryTime),l=`${s.getFullYear()}-${(s.getMonth()+1).toString().padStart(2,"0")}`;r.has(l)||r.set(l,[]),r.get(l).push(a)});let n=[],i=Array.from(r.keys()).sort((a,s)=>s.localeCompare(a)),o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];for(let a of i){let s=r.get(a),[l,c]=a.split("-");n.push({type:"month",id:a,label:`${o[parseInt(c)-1]} ${l}`,metrics:this.calculateMetrics(s),expanded:!1,dataLoaded:!1})}return n}async buildWeekNodes(t){let r=new Map;t.forEach(o=>{let a=new Date(o.entryTime),s=fl(a),c=`${a.getFullYear()}-W${s.toString().padStart(2,"0")}`;r.has(c)||r.set(c,[]),r.get(c).push(o)});let n=[],i=Array.from(r.keys()).sort((o,a)=>a.localeCompare(o));for(let o of i){let a=r.get(o);n.push({type:"week",id:o,label:o.replace("-W"," Week "),metrics:this.calculateMetrics(a),expanded:!1,dataLoaded:!1})}return n}async buildDayNodes(t){let r=new Map;t.forEach(o=>{let a=new Date(o.entryTime),s=xl(a,this.plugin);r.has(s)||r.set(s,[]),r.get(s).push(o)});let n=[],i=Array.from(r.keys()).sort((o,a)=>a.localeCompare(o));for(let o of i){let a=r.get(o);n.push({type:"day",id:o,label:new Date(o).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),metrics:this.calculateMetrics(a),expanded:!1,dataLoaded:!1})}return n}clearCache(){this.cache.clear(),this.lastUpdateTime=0}markBestWorstPerformers(t){if(t.length===0||t[0].type==="trade")return;let r=null,n=null,i=-1/0,o=1/0;if(t.forEach(a=>{let s=a.metrics.totalPnL;s>0&&s>i&&(i=s,r=a),s<0&&s<o&&(o=s,n=a)}),t.length===1){let a=t[0];a.metrics.totalPnL>0?a.performanceIndicator="best":a.metrics.totalPnL<0&&(a.performanceIndicator="worst")}else r!==null&&i>0&&(r.performanceIndicator="best"),n!==null&&o<0&&n!==r&&(n.performanceIndicator="worst")}markBestWorstPerformersRecursive(t){this.markBestWorstPerformers(t),t.forEach(r=>{r.children&&r.children.length>0&&this.markBestWorstPerformersRecursive(r.children)})}markBestWorstTrades(t){var a;if(t.length===0)return;let r=null,n=null,i=-1/0,o=1/0;if(t.forEach(s=>{var c;let l=((c=s.trade)==null?void 0:c.pnl)||0;l>0&&l>i&&(i=l,r=s),l<0&&l<o&&(o=l,n=s)}),t.length===1){let s=t[0],l=((a=s.trade)==null?void 0:a.pnl)||0;l>0?s.trade&&(s.trade.performanceIndicator="best"):l<0&&s.trade&&(s.trade.performanceIndicator="worst")}else r!==null&&i>0&&r.trade&&(r.trade.performanceIndicator="best"),n!==null&&o<0&&n!==r&&n.trade&&(n.trade.performanceIndicator="worst")}async buildTradeNodes(t){let n=[...t].sort((i,o)=>{let a=new Date(i.entryTime);return new Date(o.entryTime).getTime()-a.getTime()}).map(i=>{let o=new Date(i.entryTime),a=Ze(o),s=this.getTradeStatus(i),l=s==="open",c=l?0:i.pnl||0,d=i.instrument||"Unknown",u=`${d} - ${a}${l?" (OPEN)":""}`;return{type:"trade",id:i.filePath||`trade-${d}-${o.getTime()}`,label:u,metrics:{totalPnL:c,winRate:l?0:c>0?100:0,tradeCount:1,status:s},trade:i,expanded:!1,dataLoaded:!0}});return this.markBestWorstTrades(n),n}async buildTradesForDay(t,r){try{return await this.buildTradeNodes(t)}catch(n){return console.error("Error building trades for day:",n),[]}}buildQuartersForYear(t,r){let n=new Map;t.forEach(o=>{let a=new Date(o.entryTime),s=_C(a);n.has(s)||n.set(s,[]),n.get(s).push(o)});let i=[];for(let o=4;o>=1;o--)if(n.has(o)){let a=n.get(o);i.push({type:"quarter",id:`${r}-Q${o}`,label:`Q${o}`,metrics:this.calculateMetrics(a),expanded:!1,dataLoaded:!1})}return i}buildMonthsForQuarter(t,r){let[n,i]=r.split("-Q"),a=(parseInt(i)-1)*3,s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],l=new Map;t.forEach(d=>{let p=new Date(d.entryTime).getMonth();l.has(p)||l.set(p,[]),l.get(p).push(d)});let c=[];for(let d=a+2;d>=a;d--)if(l.has(d)){let u=l.get(d);c.push({type:"month",id:`${n}-${(d+1).toString().padStart(2,"0")}`,label:s[d],metrics:this.calculateMetrics(u),expanded:!1,dataLoaded:!1})}return c}buildWeeksForMonth(t,r){let n=new Map;t.forEach(a=>{let s=new Date(a.entryTime),l=fl(s);n.has(l)||n.set(l,[]),n.get(l).push(a)});let i=[],o=Array.from(n.keys()).sort((a,s)=>s-a);for(let a of o){let s=n.get(a),[l]=r.split("-");i.push({type:"week",id:`${l}-W${a.toString().padStart(2,"0")}`,label:`Week ${a}`,metrics:this.calculateMetrics(s),expanded:!1,dataLoaded:!1})}return i}buildDaysForWeek(t,r){let n=new Map,i=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];t.forEach(s=>{let l=new Date(s.entryTime),c=xl(l,this.plugin);n.has(c)||n.set(c,[]),n.get(c).push(s)});let o=[],a=Array.from(n.keys()).sort((s,l)=>l.localeCompare(s));for(let s of a){let l=n.get(s),c=new Date(s),d=i[c.getDay()];o.push({type:"day",id:s,label:`${d} ${c.getDate()}`,metrics:this.calculateMetrics(l),expanded:!1,dataLoaded:!1})}return o}destroy(){this.tradeDataChangeHandler&&(document.removeEventListener("journalit:trade-data-changed",this.tradeDataChangeHandler),document.removeEventListener("journalit:missed-trade-data-changed",this.tradeDataChangeHandler))}};var go=$(W());var $fe=[{value:"trades",label:"Trades"},{value:"years",label:"Years"},{value:"quarters",label:"Quarters"},{value:"months",label:"Months"},{value:"weeks",label:"Weeks"},{value:"days",label:"Days"}],eT=(0,go.memo)(({filters:e,onFilterChange:t})=>go.default.createElement("div",{className:"trade-log-header"},go.default.createElement("div",{className:"trade-log-controls"},go.default.createElement("div",{className:"view-level-selector"},go.default.createElement("label",null,"View:"),go.default.createElement(oa,{value:e.viewLevel,onChange:r=>t({viewLevel:r}),options:$fe})),go.default.createElement("div",{className:"date-range-selector"},go.default.createElement(Uv,{dateRange:e.dateRange,onChange:r=>t({dateRange:r})}))),go.default.createElement("div",{className:"trade-log-filter-placeholder"},go.default.createElement("div",{className:"filter-placeholder-content"},go.default.createElement("span",{className:"filter-icon"},"\u{1F50D}"),go.default.createElement("span",{className:"filter-text"},"Advanced filters coming soon...")))));eT.displayName="TradeLogHeader";var dy=$(W());var hs=$(W());var mt=$(W());var ue=$(W());Yt();var Rq=(0,ue.memo)(({mistakes:e})=>ue.default.createElement("div",{className:"mistakes-tooltip"},ue.default.createElement("div",{className:"tooltip-title"},"Mistakes:"),e.map((t,r)=>ue.default.createElement("div",{key:r,className:"tooltip-item"},"\u2022 ",t))));Rq.displayName="MistakesTooltipContent";var Wq=(0,ue.memo)(({setups:e})=>ue.default.createElement("div",{className:"setups-tooltip"},ue.default.createElement("div",{className:"tooltip-title"},"Setups:"),e.map((t,r)=>ue.default.createElement("div",{key:r,className:"tooltip-item"},"\u2022 ",t))));Wq.displayName="SetupsTooltipContent";var Bq=(0,ue.memo)(({thesis:e})=>ue.default.createElement("div",{className:"thesis-tooltip"},ue.default.createElement("div",{className:"tooltip-title"},"Thesis:"),ue.default.createElement("div",{className:"tooltip-content"},e)));Bq.displayName="ThesisTooltipContent";var Uq=(0,ue.memo)(({accounts:e})=>ue.default.createElement("div",{className:"accounts-tooltip"},ue.default.createElement("div",{className:"tooltip-title"},"Accounts:"),e.map((t,r)=>ue.default.createElement("div",{key:r,className:"tooltip-item"},"\u2022 ",t))));Uq.displayName="AccountsTooltipContent";var gI=(0,ue.memo)(({trade:e,images:t,status:r,duration:n,onImageClick:i})=>{let o=(0,ue.useMemo)(()=>e.mistake?Array.isArray(e.mistake)?e.mistake:[e.mistake]:[],[e.mistake]),a=(0,ue.useMemo)(()=>e.setup?Array.isArray(e.setup)?e.setup:[e.setup]:[],[e.setup]),s=(0,ue.useMemo)(()=>{if(!e.account&&!e.accountIds)return[];let l=e.accountIds||e.account;return Array.isArray(l)?l:[l]},[e.account,e.accountIds]);return ue.default.createElement(ue.default.Fragment,null,ue.default.createElement("div",{className:"trade-image-cell"},t.length>0?ue.default.createElement("div",{className:"trade-image-wrapper",onClick:l=>i(l,t[0])},ue.default.createElement("div",{className:"trade-preview-thumbnail"},ue.default.createElement("img",{src:lr.resolveMediaPath(t[0]),alt:`${e.instrument} preview`,className:"trade-image",loading:"lazy",decoding:"async",onError:l=>{console.error("Failed to load image:",t[0]),l.currentTarget.style.display="none"}})),t.length>1&&ue.default.createElement("span",{className:"trade-image-count"},"+",t.length-1)):ue.default.createElement(Ww,{size:20,className:"trade-no-image-icon"})),ue.default.createElement("div",{className:"trade-ticker-cell"},ue.default.createElement("span",{className:"trade-ticker"},e.instrument||"Unknown",e.performanceIndicator&&ue.default.createElement("span",{className:`performance-indicator performance-indicator--${e.performanceIndicator}`,title:Rfe(e)},e.performanceIndicator==="best"?ue.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ue.default.createElement("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C5.5 4 6 4.5 6 5v4zM18 9h1.5a2.5 2.5 0 0 0 0-5c-1 0-1.5.5-1.5 1v4z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),ue.default.createElement("path",{d:"M4 22h16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),ue.default.createElement("path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),ue.default.createElement("path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),ue.default.createElement("path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})):ue.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ue.default.createElement("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),ue.default.createElement("line",{x1:"12",y1:"9",x2:"12",y2:"13",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),ue.default.createElement("line",{x1:"12",y1:"17",x2:"12.01",y2:"17",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}))))),ue.default.createElement("div",{className:"trade-direction-cell"},ue.default.createElement("span",{className:"trade-direction"},e.direction||"N/A")),ue.default.createElement("div",{className:"trade-status-cell"},ue.default.createElement("span",{className:`trade-status ${r.className}`},r.label)),ue.default.createElement("div",{className:"trade-pnl-cell"},ue.default.createElement("span",{className:`trade-pnl ${r.className==="status-open"?"open":e.pnl>0?"positive":e.pnl<0?"negative":"neutral"}`},r.className==="status-open"?"-":fe(e.pnl||0))),ue.default.createElement("div",{className:"trade-duration-cell"},ue.default.createElement("span",{className:"trade-duration"},n)),ue.default.createElement("div",{className:"trade-date-cell"},ue.default.createElement("span",{className:"trade-date"},e.entryTime?Ze(new Date(e.entryTime),"DDMMYY","/"):"N/A")),ue.default.createElement("div",{className:"trade-account-cell"},s.length>0?ue.default.createElement(qp,{content:ue.default.createElement(Uq,{accounts:s}),delay:0,preferredPosition:"top"},ue.default.createElement("span",{className:"count-badge count-badge--accounts"},s.length)):ue.default.createElement("span",{className:"trade-no-data"},"-")),ue.default.createElement("div",{className:"trade-mistakes-cell"},o.length>0?ue.default.createElement(qp,{content:ue.default.createElement(Rq,{mistakes:o}),delay:0,preferredPosition:"top"},ue.default.createElement("span",{className:"count-badge count-badge--mistakes"},o.length)):ue.default.createElement("span",{className:"trade-no-data"},"-")),ue.default.createElement("div",{className:"trade-setups-cell"},a.length>0?ue.default.createElement(qp,{content:ue.default.createElement(Wq,{setups:a}),delay:0,preferredPosition:"top"},ue.default.createElement("span",{className:"count-badge count-badge--setups"},a.length)):ue.default.createElement("span",{className:"trade-no-data"},"-")),ue.default.createElement("div",{className:"trade-thesis-cell"},e.thesis?ue.default.createElement(qp,{content:ue.default.createElement(Bq,{thesis:e.thesis}),delay:200},ue.default.createElement("span",{className:"trade-thesis"},e.thesis.length>40?e.thesis.substring(0,40)+"...":e.thesis)):ue.default.createElement("span",{className:"trade-no-data"},"-")))});gI.displayName="TradeDetailsContent";var hI=(0,ue.memo)(({trade:e,depth:t,isLastChild:r=!1,onClick:n,viewLevel:i})=>{let[o,a]=(0,ue.useState)(!1),[s,l]=(0,ue.useState)(0),c=(0,ue.useMemo)(()=>{switch(F2(e)){case"missed":return{label:"MISSED",className:"status-missed"};case"open":return{label:"OPEN",className:"status-open"};case"win":return{label:"WIN",className:"status-win"};case"loss":return{label:"LOSS",className:"status-loss"};case"breakeven":default:return{label:"BREAKEVEN",className:"status-breakeven"}}},[e.pnl,e.isMissedTrade,e.tradeStatus,e.exitTime,e.useDirectPnLInput,e.exits]),d=(0,ue.useMemo)(()=>{if(!e.entryTime)return"N/A";if(e.tradeStatus==="OPEN"||at(e)){let w=new Date(e.entryTime),S=new Date().getTime()-w.getTime();return IC(S)+" (ongoing)"}let h=new Date(e.entryTime),b=new Date(e.exitTime).getTime()-h.getTime();return IC(b)},[e.entryTime,e.exitTime,e.tradeStatus,e.pnl,e.useDirectPnLInput,e.exits]),u=(0,ue.useMemo)(()=>{let y=[];try{if(e.images){if(Array.isArray(e.images))y=e.images;else if(typeof e.images=="string"){let h=JSON.parse(e.images);Array.isArray(h)&&(y=h.map(v=>String(v)))}}}catch(h){}return y},[e.images]),p=(0,ue.useCallback)((y,h)=>{y.stopPropagation();let v=u.indexOf(h);l(v>=0?v:0),a(!0)},[u]),m=(0,ue.useCallback)(()=>{a(!1)},[]),g=(0,ue.useCallback)(y=>{y>=0&&y<u.length&&l(y)},[u.length]),f=(0,ue.useMemo)(()=>{if(!(u.length<=1))return{images:u,currentIndex:s,onNavigate:g,altPrefix:`${e.instrument} Image`,useResolveMediaPath:!0}},[u,s,g,e.instrument]);return ue.default.createElement(ue.default.Fragment,null,ue.default.createElement("div",{className:`trade-log-node trade-log-node--trade ${r?"is-last-child":""} ${i==="trades"?"trades-view":""}`,onClick:n},i!=="trades"&&ue.default.createElement("div",{className:"tree-structure",style:{width:`${t*24}px`}},Array.from({length:t}).map((y,h)=>ue.default.createElement("span",{key:h,className:`tree-level ${h===t-1&&r?"last-level":""}`}))),i==="trades"?ue.default.createElement("div",{className:"trade-details-row trades-view-row"},ue.default.createElement(gI,{trade:e,images:u,status:c,duration:d,onImageClick:p})):ue.default.createElement("div",{className:"trade-details-row tree-view-row"},ue.default.createElement("div",{className:"tree-indicator-cell"},t>0&&ue.default.createElement("span",{className:"tree-connector tree-connector--trade"}),ue.default.createElement("span",{className:"tree-leaf-node tree-leaf-node--trade"})),ue.default.createElement(gI,{trade:e,images:u,status:c,duration:d,onImageClick:p}))),o&&u.length>0&&ue.default.createElement(Ka,{isOpen:o,onClose:m,title:`${e.instrument} - ${Ze(new Date(e.entryTime),"DDMMYY"," ")}`,portalId:"trade-log-image-portal"},ue.default.createElement(kc,{imagePath:u[s],alt:`${e.instrument} Image ${s+1}`,useResolveMediaPath:!0,navigationContext:f,onClose:m})))});hI.displayName="TradeDetailsRow";function Rfe(e){let t=e.performanceIndicator==="best"?"Best":"Worst",n=new Date(e.entryTime).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return`${t} performing trade on ${n}`}Yt();var vI=(0,mt.memo)(({node:e,depth:t,isExpanded:r,isLastChild:n=!1,onToggleExpand:i,onNodeClick:o,viewLevel:a})=>{let s=u=>{u.stopPropagation(),i(e)},l=u=>{u.stopPropagation(),o(e)},c=e.children&&e.children.length>0,d=e.type!=="trade"&&(c||!e.dataLoaded);return e.type==="trade"?mt.default.createElement(hI,{trade:e.trade,depth:t,isLastChild:n,onClick:l,viewLevel:a}):mt.default.createElement("div",{className:`trade-log-node trade-log-node--${e.type} ${n?"is-last-child":""}`},mt.default.createElement("div",{className:"tree-structure",style:{width:`${t*24}px`}},Array.from({length:t}).map((u,p)=>mt.default.createElement("span",{key:p,className:`tree-level ${p===t-1&&n?"last-level":""}`}))),mt.default.createElement("div",{className:"node-wrapper"},t>0&&mt.default.createElement("span",{className:"tree-connector"}),mt.default.createElement("div",{className:"node-content"},mt.default.createElement("div",{className:"tree-expand-wrapper"},d?mt.default.createElement("button",{className:`node-chevron ${r?"expanded":""}`,onClick:s,"aria-label":r?"Collapse":"Expand"},r?mt.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none"},mt.default.createElement("rect",{x:"3",y:"3",width:"8",height:"8",stroke:"currentColor",strokeWidth:"1.5",rx:"1"}),mt.default.createElement("path",{d:"M5 7H9",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})):mt.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none"},mt.default.createElement("rect",{x:"3",y:"3",width:"8",height:"8",stroke:"currentColor",strokeWidth:"1.5",rx:"1"}),mt.default.createElement("path",{d:"M7 5V9M5 7H9",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"}))):mt.default.createElement("span",{className:"tree-leaf-node"})),mt.default.createElement("span",{className:"node-label",onClick:l,title:`Navigate to ${e.type} review`},e.label,e.performanceIndicator&&mt.default.createElement("span",{className:`performance-indicator performance-indicator--${e.performanceIndicator}`,title:Bfe(e)},e.performanceIndicator==="best"?mt.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},mt.default.createElement("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5C5.5 4 6 4.5 6 5v4zM18 9h1.5a2.5 2.5 0 0 0 0-5c-1 0-1.5.5-1.5 1v4z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),mt.default.createElement("path",{d:"M4 22h16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),mt.default.createElement("path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),mt.default.createElement("path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),mt.default.createElement("path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})):mt.default.createElement("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},mt.default.createElement("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),mt.default.createElement("line",{x1:"12",y1:"9",x2:"12",y2:"13",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),mt.default.createElement("line",{x1:"12",y1:"17",x2:"12.01",y2:"17",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})))),mt.default.createElement("div",{className:"node-metrics"},mt.default.createElement("span",{className:"metric metric--count"},e.metrics.tradeCount," ",e.metrics.tradeCount===1?"trade":"trades"),mt.default.createElement("span",{className:`metric metric--winrate ${Wfe(e.metrics.winRate)}`},e.metrics.winRate.toFixed(1),"%"),mt.default.createElement("span",{className:`metric metric--pnl ${e.metrics.totalPnL>0?"positive":e.metrics.totalPnL<0?"negative":"neutral"}`},fe(e.metrics.totalPnL))))))});vI.displayName="TradeLogNode";function Wfe(e){return e>=60?"high":e>=40?"medium":"low"}function Bfe(e){let t=e.performanceIndicator==="best"?"Best":"Worst";switch(e.type){case"year":return`${t} performing year`;case"quarter":let r=e.id.split("-")[0];return`${t} performing quarter of ${r}`;case"month":let[n,i]=e.id.split("-"),o=Math.ceil(parseInt(i)/3);return`${t} performing month of Q${o} ${n}`;case"week":let[a,s]=e.id.split("-W"),l=Ufe(parseInt(a),parseInt(s)),d=["January","February","March","April","May","June","July","August","September","October","November","December"][l.getMonth()];return`${t} performing week of ${d} ${a}`;case"day":let u=e.id.split("-"),p=new Date(parseInt(u[0]),parseInt(u[1])-1,parseInt(u[2])),m=fl(p);return`${t} performing day of W${m} ${u[0]}`;default:return`${t} performing period`}}function Ufe(e,t){let r=new Date(e,0,4),n=r.getDay(),i=n===0?-6:1-n,o=new Date(r);o.setDate(r.getDate()+i);let a=new Date(o);return a.setDate(o.getDate()+(t-1)*7),a}var Mf=null,tT=new WeakMap,Vfe=()=>(Mf||(Mf=new IntersectionObserver(e=>{e.forEach(t=>{if(t.isIntersecting){let r=tT.get(t.target);r&&(r(),Mf==null||Mf.unobserve(t.target),tT.delete(t.target))}})},{rootMargin:"300px 0px",threshold:0})),Mf),yI=(0,hs.memo)(({node:e,depth:t,isExpanded:r,isLastChild:n,onToggleExpand:i,onNodeClick:o,viewLevel:a})=>{let[s,l]=(0,hs.useState)(!1),c=(0,hs.useRef)(null),d=t===0||t===1&&e.type!=="trade";if((0,hs.useEffect)(()=>{if(d){l(!0);return}let u=c.current;if(!u)return;let p=Vfe(),m=()=>l(!0);return tT.set(u,m),p.observe(u),()=>{u&&(p.unobserve(u),tT.delete(u))}},[d]),!s){let u=e.type==="trade"?60:48;return hs.default.createElement("div",{ref:c,className:`trade-log-node-placeholder trade-log-node--${e.type}`,style:{height:`${u}px`,width:"100%",background:"var(--background-primary-alt)",borderBottom:"1px solid var(--background-modifier-border)"}})}return hs.default.createElement(vI,{node:e,depth:t,isExpanded:r,isLastChild:n,onToggleExpand:i,onNodeClick:o,viewLevel:a})});yI.displayName="LazyTradeLogNode";var Vq=({nodes:e,expandedNodes:t,onToggleExpand:r,onNodeClick:n,viewLevel:i})=>{let o=(0,dy.useMemo)(()=>{let a=[],s=(l,c)=>{l.forEach((d,u)=>{let p=u===l.length-1;a.push({node:d,depth:c,isLastChild:p}),d.children&&t.has(d.id)&&s(d.children,c+1)})};return s(e,0),a},[e,t]);return dy.default.createElement("div",{className:"trade-log-tree"},o.map(({node:a,depth:s,isLastChild:l})=>dy.default.createElement(yI,{key:a.id,node:a,depth:s,isExpanded:t.has(a.id),isLastChild:l,onToggleExpand:r,onNodeClick:n,viewLevel:i})))};var Hq=(e,t,r)=>e.map(n=>n.id===t?{...n,children:r,dataLoaded:!0}:n.children?{...n,children:Hq(n.children,t,r)}:n),qq=({plugin:e})=>{let[t,r]=(0,rt.useState)(!0),[n,i]=(0,rt.useState)(new Set),[o,a]=(0,rt.useState)([]),[s,l]=(0,rt.useState)(new Set),[c,d]=(0,rt.useState)({dateRange:[null,null],viewLevel:"trades"}),u=(0,rt.useRef)(null);u.current||(u.current=new cy(e));let p=u.current,m=c_(c,300),g=(0,rt.useCallback)(async()=>{r(!0);try{let b=await p.getHierarchicalData(m.viewLevel,m.dateRange[0]||void 0,m.dateRange[1]||void 0);a(b),l(new Set)}catch(b){console.error("Error loading trade log data:",b)}finally{r(!1)}},[p,m]);(0,rt.useEffect)(()=>{g()},[g]);let f=(0,rt.useRef)(g);f.current=g,(0,rt.useEffect)(()=>{let b=async w=>{setTimeout(async()=>{e.app.workspace.trigger&&e.app.workspace.trigger("layout-change"),await new Promise(k=>setTimeout(k,100)),await f.current()},600)};return document.addEventListener("journalit:trade-data-changed",b),()=>{document.removeEventListener("journalit:trade-data-changed",b)}},[]),(0,rt.useEffect)(()=>()=>{u.current&&u.current.destroy()},[]);let y=(0,rt.useCallback)(async b=>{let w=new Set(s);if(s.has(b.id))w.delete(b.id);else if(w.add(b.id),!b.dataLoaded&&b.type!=="trade"){i(k=>new Set(k).add(b.id));try{let k=await p.getNodeChildren(b);a(S=>Hq(S,b.id,k))}catch(k){console.error("Error loading node children:",k)}finally{i(k=>{let S=new Set(k);return S.delete(b.id),S})}}l(w)},[s,p]),h=(0,rt.useCallback)(async b=>{var k,S,x;let w=Tc.getInstance(e.app,e);switch(b.type){case"trade":(k=b.trade)!=null&&k.file?await e.app.workspace.openLinkText(b.trade.file.path,"",!1):(S=b.trade)!=null&&S.filePath?await e.app.workspace.openLinkText(b.trade.filePath,"",!1):b.id&&b.id.includes(".md")&&await e.app.workspace.openLinkText(b.id,"",!1);break;case"day":{let T=new Date(b.id),E=await w.getDRCService(),C=E.getDRCNotePath(T);e.app.vault.getAbstractFileByPath(C)?await e.app.workspace.openLinkText(C,"",!1):e.settings.drc.autoCreateDRCOnNavigation&&(await E.createDRC(T),await e.app.workspace.openLinkText(C,"",!1));break}case"week":{let[T,E]=b.id.split("-W"),C=parseInt(T),N=parseInt(E),A=new Date(C,0,1).getDay(),P=A===0?-6:1-A,I=new Date(C,0,1+P),M=new Date(I.getTime()+(N-1)*7*24*60*60*1e3),O=await w.getWeeklyReviewService(),F=O.getWeeklyReviewPath(M);e.app.vault.getAbstractFileByPath(F)?await e.app.workspace.openLinkText(F,"",!1):e.settings.weekly.autoCreateWeeklyReviewOnNavigation&&(await O.createWeeklyReview(M),await e.app.workspace.openLinkText(F,"",!1));break}case"month":{let[T,E]=b.id.split("-"),C=parseInt(T),N=parseInt(E)-1,D=new Date(C,N,1),A=await w.getMonthlyReviewService(),P=A.getMonthlyReviewPath(D);e.app.vault.getAbstractFileByPath(P)?await e.app.workspace.openLinkText(P,"",!1):(x=e.settings.monthly)!=null&&x.autoCreateMonthlyReviewOnNavigation&&await A.createMonthlyReview(D)&&await e.app.workspace.openLinkText(P,"",!1);break}case"quarter":case"year":console.log(`No review available for ${b.type}:`,b.id);break}},[e]),v=(0,rt.useCallback)(b=>{d(w=>({...w,...b}))},[]);return!t&&o.length===0?rt.default.createElement("div",{className:"journalit-trade-log"},rt.default.createElement(eT,{filters:c,onFilterChange:v}),rt.default.createElement(Ae,{message:"No trades found",subMessage:"Start creating trade notes to see them appear in your trade log.",actionButtonText:"Create Trade",onActionButtonClick:async()=>{let b=e.viewManager;b&&await b.openTradeFormView()}})):rt.default.createElement("div",{className:"journalit-trade-log"},rt.default.createElement(eT,{filters:c,onFilterChange:v}),rt.default.createElement("div",{className:`trade-log-content ${c.viewLevel==="trades"?"trades-view":""}`},c.viewLevel==="trades"&&!t&&rt.default.createElement("div",{className:"trade-log-headers"},rt.default.createElement("div",{className:"trade-log-header-row"},rt.default.createElement("div",{className:"header-cell header-image"},"Image"),rt.default.createElement("div",{className:"header-cell header-ticker"},"Ticker"),rt.default.createElement("div",{className:"header-cell header-direction"},"Direction"),rt.default.createElement("div",{className:"header-cell header-status"},"Status"),rt.default.createElement("div",{className:"header-cell header-pnl"},"P&L"),rt.default.createElement("div",{className:"header-cell header-duration"},"Duration"),rt.default.createElement("div",{className:"header-cell header-date"},"Date"),rt.default.createElement("div",{className:"header-cell header-account"},"Account"),rt.default.createElement("div",{className:"header-cell header-mistakes"},"Mistakes"),rt.default.createElement("div",{className:"header-cell header-setups"},"Setups"),rt.default.createElement("div",{className:"header-cell header-thesis"},"Thesis"))),t?rt.default.createElement(Or,{message:"Loading trades...",fullscreen:!0}):rt.default.createElement(Vq,{nodes:o,expandedNodes:s,onToggleExpand:y,onNodeClick:h,viewLevel:c.viewLevel})))};var Bl="journalit-trade-log-view",rT=class extends wc{constructor(t,r){super(t),this.plugin=r}getDisplayText(){return"Trade Log"}getViewType(){return Bl}getIcon(){return"folder-tree"}async onOpen(){try{await super.onOpen(),Po(!0,!0,!0,!0,!0,!0,!0,!0,!0),Di(!0,!0,!0,!0,!0,!0,!1,!0,!0,!0),this.containerEl&&(this.containerEl.classList.add("journalit-trade-log-view-container"),setTimeout(()=>{let t=document.querySelector(".trade-log-content");if(t){let r=getComputedStyle(t);r.maxHeight==="100%"&&r.overflowY==="auto"&&console.log("[TradeLogView] \u2705 Scroll constraints applied successfully")}},1e3))}catch(t){console.error("Error in TradeLogView.onOpen:",t)}}async onClose(){try{await super.onClose()}catch(t){console.error("Error in TradeLogView.onClose:",t)}}getRenderFunction(){return()=>Gq.default.createElement(qq,{plugin:this.plugin})}};var ju="account-dashboard",nT=class e{constructor(t){this.registeredViews=new Set;this.plugin=t}static getInstance(t){return e.instance||(e.instance=new e(t)),e.instance}async registerAllViews(){}async registerDashboardView(){if(!this.registeredViews.has(Ia))try{this.plugin.app.workspace.getLeavesOfType(Ia).length===0?(this.plugin.registerView(Ia,r=>new sy(r)),this.registeredViews.add(Ia)):this.registeredViews.add(Ia)}catch(t){console.error("Error registering dashboard view:",t)}}async registerAccountDashboardView(){if(!this.registeredViews.has(ju))try{this.plugin.app.workspace.getLeavesOfType(ju).length===0?(this.plugin.registerView(ju,r=>new ZS(r,this.plugin)),this.registeredViews.add(ju)):this.registeredViews.add(ju)}catch(t){console.error("Error registering account dashboard view:",t)}}async registerTradeLogView(){if(!this.registeredViews.has(Bl))try{this.plugin.app.workspace.getLeavesOfType(Bl).length===0?(this.plugin.registerView(Bl,r=>new rT(r,this.plugin)),this.registeredViews.add(Bl)):this.registeredViews.add(Bl)}catch(t){console.error("Error registering trade log view:",t)}}async registerTradeFormView(){if(!this.registeredViews.has(Ir))try{this.plugin.app.workspace.getLeavesOfType(Ir).length===0?(this.plugin.registerView(Ir,r=>new yw(r,this.plugin.tradeService,this.plugin.missedTradeService)),this.registeredViews.add(Ir)):this.registeredViews.add(Ir)}catch(t){console.error("Error registering trade form view:",t)}}async openDashboardView(){await this.registerDashboardView();let t=this.plugin.app.workspace.getLeavesOfType(Ia);if(t.length>0){this.plugin.app.workspace.revealLeaf(t[0]);return}let r=this.plugin.app.workspace.getLeaf("tab");r&&(await r.setViewState({type:Ia,active:!0}),this.plugin.app.workspace.revealLeaf(r))}async openAccountDashboardView(){await this.registerAccountDashboardView();let t=this.plugin.app.workspace.getLeavesOfType(ju);if(t.length>0){this.plugin.app.workspace.revealLeaf(t[0]);return}let r=this.plugin.app.workspace.getLeaf("tab");r&&(await r.setViewState({type:ju,active:!0}),this.plugin.app.workspace.revealLeaf(r))}async openTradeLogView(){await this.registerTradeLogView();let t=this.plugin.app.workspace.getLeavesOfType(Bl);if(t.length>0){this.plugin.app.workspace.revealLeaf(t[0]);return}let r=this.plugin.app.workspace.getLeaf("tab");r&&(await r.setViewState({type:Bl,active:!0}),this.plugin.app.workspace.revealLeaf(r))}async openTradeFormView(t){await this.registerTradeFormView();let r=this.plugin.app.workspace.getLeavesOfType(Ir);if(r.length>0){for(let i of r)try{i.detach()}catch(o){console.error("Error detaching existing trade form:",o)}await new Promise(i=>setTimeout(i,50))}let n=this.plugin.app.workspace.getRightLeaf(!1);if(n){let i={type:Ir,active:!0,state:{isEditMode:!1,initialData:t||{},filePath:""}};n.setViewState(i),this.plugin.app.workspace.revealLeaf(n)}else console.error("Failed to create leaf for trade form")}async openTradeFormInEditMode(t,r){return await this.registerTradeFormView(),this.plugin.openTradeFormInEditMode(t,r)}isViewRegistered(t){return this.registeredViews.has(t)}cleanupViews(){try{for(let t of this.registeredViews)this.plugin.app.workspace.getLeavesOfType(t).forEach(r=>{r.detach()});this.registeredViews.clear()}catch(t){console.error("Error cleaning up views:",t)}}};tw();Bn();Bn();var Hfe=`
  /* Fix for duplicate tooltips */
  .journalit-icon-button,
  .journalit-button,
  .drc-note-grade-dropdown select {
    position: relative !important;
  }
  
  /* Hide Obsidian's native tooltips on our buttons */
  .tooltip[style*="visibility: visible"],
  .another-tooltip[style*="visibility: visible"],
  .is-tooltip[style*="visibility: visible"],
  .tooltip,
  .another-tooltip,
  .is-tooltip {
    display: none !important;
    visibility: hidden !important;
    opacity: 0 !important;
    pointer-events: none !important;
  }

  /* Fix for grade display tooltips */
  .drc-note-grade-dropdown::before,
  .drc-note-grade-dropdown::after,
  .drc-note-grade-dropdown select::before,
  .drc-note-grade-dropdown select::after {
    content: none !important;
    display: none !important;
  }

  /* Hide any tooltips that appear within our custom components */
  .drc-container .tooltip,
  .drc-note-grade-dropdown .tooltip,
  .drc-note-grade-value .tooltip {
    display: none !important;
    visibility: hidden !important;
    opacity: 0 !important;
    z-index: -1 !important;
  }

  /* CRITICAL FIX: Ensure our grade elements display properly with accurate vertical centering */
  .drc-note-grade-value,
  select.drc-note-grade-value {
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    text-align: center !important;
    width: 60px !important;
    height: 60px !important;
    border-radius: 50% !important;
    margin: 0 auto !important;
    font-size: 18px !important;
    /* The padding-bottom adjustment is critical for proper vertical centering of text */
    padding: 0 0 4px 0 !important; 
    overflow: visible !important;
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    appearance: none !important;
    line-height: 1 !important; /* Critical for proper vertical centering */
    vertical-align: middle !important;
  }

  /* Ensure text is properly centered in all browsers */
  .drc-note-grade-value,
  .drc-note-grade-dropdown select,
  .drc-note-grade-dropdown option {
    text-align: center !important;
    text-align-last: center !important;
  }

  /* No-tooltip button styles - match IconButton */
  .journalit-no-tooltip-button {
    position: relative;
    background: none;
    border: none;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 6px;
    border-radius: 4px;
    transition: all 0.2s ease;
    color: var(--text-muted);
    width: 30px;
    height: 30px;
    margin: 0 2px;
    box-sizing: content-box;
  }

  /* Style hover state for buttons */
  .journalit-no-tooltip-button:hover {
    background-color: var(--background-modifier-hover);
    color: var(--text-normal);
  }

  /* Style active state for buttons */
  .journalit-no-tooltip-button:active {
    background-color: var(--background-modifier-active);
    transform: translateY(1px);
  }

  /* Custom tooltip implementation */
  .journalit-no-tooltip-button {
    position: relative;
  }

  /* Define tooltip using ::before pseudo-element */
  .journalit-no-tooltip-button::before {
    content: attr(data-label);
    position: absolute;
    bottom: 120%;
    left: 50%;
    transform: translateX(-50%);
    margin-bottom: 0;
    background-color: var(--background-secondary);
    color: var(--text-normal);
    padding: 5px 10px;
    border-radius: 4px;
    font-size: 12px;
    white-space: nowrap;
    opacity: 0;
    visibility: hidden;
    transition: all 0.2s ease;
    z-index: 10000;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    pointer-events: none;
  }

  /* Show tooltip on hover */
  .journalit-no-tooltip-button:hover::before {
    opacity: 1;
    visibility: visible;
    bottom: 100%;
    margin-bottom: 4px;
  }

  /* Fix for SVG within buttons */
  .journalit-no-tooltip-button svg {
    width: 18px;
    height: 18px;
    pointer-events: none;
    fill: none;
  }

  /* Style the debug outline */
  .journalit-no-tooltip-button.debug {
    outline: 1px solid red;
  }

  .journalit-no-tooltip-button:hover.debug {
    outline: 2px solid green;
  }
`;function qfe(){let e=document.createElement("style");e.id="tooltip-fix-styles",e.textContent=Hfe,document.head.appendChild(e)}function Gfe(){let e=document.head.querySelector("#tooltip-fix-styles");e&&e.remove()}Z.tooltip={inject:qfe,remove:Gfe};Bn();Qg();Z.shared={inject:Hb,remove:JC};Bn();Z.combobox={inject:XC,remove:e_};Bn();Xg();Z.chart={inject:Vb,remove:GC};Bn();Z.image={inject:yd,remove:Q2};Bn();Z.weeklyReview={inject:BC,remove:U2};Bn();var Yfe=`
  /* Trade Form Custom Styles */
  /* Ensure proper overflow handling in container */
  .trade-form-view-container {
    --interactive-accent-rgb: 83, 141, 226;
    --color-error-rgb: 229, 57, 53;
    height: 100% !important;
    overflow-y: auto !important;
    position: relative !important;
    display: flex !important;
    flex-direction: column !important;
    padding: 0 !important;
    margin: 0 !important;
    box-sizing: border-box !important;
  }
  .trade-form-view-container .formContainer {
    display: flex !important;
    flex-direction: column !important;
    gap: 12px !important; /* Consistent gap between all form elements */
    max-width: 800px !important;
    margin: 0 auto !important;
    padding: 16px 20px !important;
    width: 100% !important;
    flex: 1 1 auto !important; /* Allow container to grow/shrink */
    min-height: min-content !important; /* Ensure it's at least as tall as content */
    box-sizing: border-box !important; /* Ensure padding is included in width */
  }
  .trade-form-view-container .formSection {
    display: flex !important;
    flex-direction: column !important;
    padding: 0 !important;
    margin: 0 !important; /* Remove all section margins */
    position: relative !important;
  }
  
  /* Remove all spacing between sections */
  .trade-form-view-container .formSection + .formSection {
    padding: 0 !important;
    margin: 0 !important;
  }
  .trade-form-view-container .sectionTitle {
    font-size: 18px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    margin-bottom: 4px !important;
    display: none !important; /* Hide the original section title */
  }
  .trade-form-view-container .minimizedSectionTitle {
    font-size: 14px !important;
    font-weight: 500 !important;
    color: var(--text-muted) !important;
    margin-bottom: 8px !important;
    text-transform: uppercase !important;
    letter-spacing: 0.5px !important;
  }
  .trade-form-view-container .sectionDescription {
    font-size: 14px !important;
    color: var(--text-muted) !important;
    margin-bottom: 16px !important;
    display: none !important; /* Hide the section description */
  }
  .trade-form-view-container .formTitle {
    font-size: 20px !important;
    font-weight: 600 !important;
    color: var(--text-normal) !important;
    margin-bottom: 8px !important;
  }
  .trade-form-view-container .sectionContent {
    display: flex !important;
    flex-direction: column !important;
    gap: 12px !important; /* Consistent gap matching form container */
    margin: 0 !important;
    padding: 0 !important;
  }
  
  .trade-form-view-container .field {
    margin: 0 !important; /* Remove all field margins */
    padding: 0 !important; /* Remove all field padding */
  }
  .trade-form-view-container input,
  .trade-form-view-container textarea {
    box-sizing: border-box !important;
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    color: var(--text-normal) !important;
    border-radius: 4px !important;
    padding: 8px 12px !important;
    width: 100% !important;
    font-size: 14px !important;
  }

  /* Placeholder styling for inputs */
  .trade-form-view-container input::placeholder,
  .trade-form-view-container textarea::placeholder {
    color: var(--text-muted) !important;
    opacity: 0.7 !important;
  }
  /* Specific styles for select elements to fix text cutoff */
  .trade-form-view-container select,
  .trade-form-view-container .obsidian-select {
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    color: var(--text-normal) !important;
    border-radius: 4px !important;
    padding: 8px 30px 8px 12px !important; /* Extra right padding for dropdown arrow */
    width: 100% !important;
    font-size: 14px !important;
    min-height: 38px !important; /* Ensure minimum height */
    line-height: 1.5 !important; /* Improve text rendering */
    text-overflow: ellipsis !important; /* Show ellipsis for long text */
  }

  /* Style for select with no value selected (to show grey placeholder) */
  .trade-form-view-container select:invalid,
  .trade-form-view-container select:not([value]),
  .trade-form-view-container select[value=""] {
    color: var(--text-muted) !important;
    opacity: 0.7 !important; /* Match input placeholder opacity */
  }

  /* Make sure selected values display normally */
  .trade-form-view-container select[data-has-value="true"] {
    color: var(--text-normal) !important;
    opacity: 1 !important;
  }

  /* Make the select placeholder text appear greyed out */
  .trade-form-view-container select option[value=""][disabled],
  .trade-form-view-container select option:first-child:not([value]),
  .trade-form-view-container select option:first-child[value=""],
  .trade-form-view-container .select-placeholder,
  .trade-form-view-container option.select-placeholder {
    color: var(--text-muted) !important;
    opacity: 0.7 !important;
  }

  /* Make sure all option values display normally */
  .trade-form-view-container select option:not([value=""]):not(:disabled),
  .trade-form-view-container select option:not(.select-placeholder),
  .trade-form-view-container select option:checked {
    color: var(--text-normal) !important;
    opacity: 1 !important;
  }
  /* Fix for date input fields to prevent text from overlapping with calendar icon */
  .trade-form-view-container input[type="date"] {
    padding-left: 35px !important; /* Move text to the right to make room for the calendar icon */
    padding-right: 15px !important;
    min-width: 150px !important; /* Ensure minimum width for date inputs */
  }
  /* Fix for time input fields to move clock icon to the left */
  .trade-form-view-container input[type="time"] {
    padding-left: 35px !important; /* Move text to the right to make room for the clock icon */
    padding-right: 15px !important;
    min-width: 110px !important; /* Ensure minimum width for time inputs */
  }
  /* Target the calendar picker indicator to move it to the left */
  .trade-form-view-container input[type="date"]::-webkit-calendar-picker-indicator,
  .trade-form-view-container input[type="time"]::-webkit-calendar-picker-indicator {
    position: absolute !important;
    left: 10px !important;
    top: 50% !important;
    transform: translateY(-50%) !important;
    margin: 0 !important;
    z-index: 2 !important; /* Ensure the icon appears above other elements */
  }
  /* Alternative method using appearance property */
  .trade-form-view-container input[type="date"],
  .trade-form-view-container input[type="time"] {
    position: relative !important;
    appearance: none !important;
    -webkit-appearance: none !important;
    -moz-appearance: none !important;
    background-image: var(--calendar-icon, initial) !important;
    background-repeat: no-repeat !important;
    background-position: 10px center !important;
  }
  /* Provide calendar icon as background */
  .trade-form-view-container input[type="date"] {
    /* Default icon will be provided by the browser */
  }
  /* Provide clock icon as background */
  .trade-form-view-container input[type="time"] {
    /* Default icon will be provided by the browser */
  }
  /* Support for Firefox */
  @-moz-document url-prefix() {
    .trade-form-view-container input[type="date"],
    .trade-form-view-container input[type="time"] {
      position: relative !important;
      background-position: 10px center !important;
    }
  }
  /* Ensure proper scrolling for the entire container */
  body {
    overflow: hidden !important; /* Prevent double scrollbars */
  }
  /* Ensure proper scrolling for main container */
  .trade-form-view-container {
    overflow-y: auto !important; /* Enable vertical scrolling */
    max-height: 100vh !important; /* Limit to viewport height */
  }
  /* React root element should expand properly */
  #trade-form-root {
    height: 100% !important;
    min-height: 100% !important;
    display: flex !important;
    flex-direction: column !important;
    flex: 1 1 auto !important;
  }
  /* Form container needs to expand fully */
  .formContainer {
    display: flex !important;
    flex-direction: column !important;
    min-height: min-content !important;
    height: auto !important;
    flex: 1 1 auto !important;
    overflow: visible !important;
  }
  /* Removing extra gap between form title and first section */
  .trade-form-view-container .formHeader {
    margin-bottom: 0 !important;
    padding-bottom: 0 !important;
  }

  /* Reduce the spacing between form elements */
  .trade-form-view-container > div, 
  .trade-form-view-container > form > div {
    margin-bottom: 0 !important;
  }

  /* Fix the gap at the top of the form */
  .trade-form-view-container .formHeader + div,
  .trade-form-view-container .formHeader + .formSection {
    margin-top: 0 !important;
  }

  /* Fix the specific gap between form title and first section */
  .trade-form-view-container .formTitle + .formSection,
  .trade-form-view-container .formHeader + .formSection,
  .trade-form-view-container .errorSummary + .formSection {
    margin-top: 12px !important;
  }
  /* ComboBox specific styles - attribute-based selectors for Obsidian compatibility */
  .trade-form-view-container .combobox-container,
  .trade-form-view-container [data-combobox-type] {
    position: relative !important;
    width: 100% !important;
    margin-bottom: 8px !important;
    /* Use higher z-index when dropdown is open to ensure it stays above other elements */
    z-index: 10 !important;
  }

  /* Increase z-index when dropdown is open to ensure it stays above other elements */
  .trade-form-view-container [data-is-open="true"] {
    z-index: 9999 !important;
  }

  /* Style for input container to properly position dropdown */
  .trade-form-view-container [data-combobox-type] > .input-container {
    position: relative !important;
    margin: 0 !important;
    padding: 0 !important;
    /* Ensure it's above other elements but below the dropdown */
    z-index: 1 !important;
  }

  /* Styling for selected items in multi-select */
  .trade-form-view-container .selected-item {
    display: inline-flex !important;
    align-items: center !important;
    margin: 0 4px 4px 0 !important;
    padding: 4px 8px !important;
    background-color: var(--interactive-accent) !important;
    color: white !important;
    border-radius: 4px !important;
    font-size: 12px !important;
    gap: 6px !important;
  }

  .trade-form-view-container .selected-item button {
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    width: 16px !important;
    height: 16px !important;
    min-width: 16px !important; /* Prevent shrinking */
    min-height: 16px !important; /* Prevent shrinking */
    padding: 0 !important;
    background: rgba(255, 255, 255, 0.2) !important; /* Add visible background */
    border: none !important;
    color: white !important;
    font-size: 14px !important;
    line-height: 1 !important;
    cursor: pointer !important;
    border-radius: 50% !important; /* Make it round */
    margin-left: 4px !important;
    position: relative !important; /* Create stacking context */
    z-index: 5 !important; /* Ensure it's above other elements */
    transition: background-color 0.2s !important;
  }

  .trade-form-view-container .selected-item button:hover {
    background: rgba(255, 255, 255, 0.4) !important; /* Brighter on hover */
  }

  .trade-form-view-container [data-combobox-type] > div:nth-child(2) {
    position: relative !important;
    width: 100% !important;
  }
  /* Add dropdown caret to the input container */
  .trade-form-view-container [data-combobox-type] .input-container::after {
    content: "" !important;
    position: absolute !important;
    right: 12px !important;
    top: 50% !important;
    transform: translateY(-50%) !important;
    width: 0 !important;
    height: 0 !important;
    border-left: 5px solid transparent !important;
    border-right: 5px solid transparent !important;
    border-top: 5px solid var(--text-normal) !important;
    pointer-events: none !important;
    z-index: 10 !important;
  }
  /* Rotate caret when dropdown is open */
  .trade-form-view-container [data-combobox-type][data-is-open="true"] .input-container::after {
    transform: translateY(-50%) rotate(180deg) !important;
  }
  .trade-form-view-container [data-combobox-type] input[role="combobox"] {
    width: 100% !important;
    padding: 8px 12px !important;
    padding-right: 30px !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 4px !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    font-size: 14px !important;
    cursor: pointer !important;
  }
  /* When dropdown is open, change input border radius */
  .trade-form-view-container [data-combobox-type][data-is-open="true"] input[role="combobox"] {
    border-bottom-left-radius: 0 !important;
    border-bottom-right-radius: 0 !important;
  }
  .trade-form-view-container [data-combobox-type] input[role="combobox"]:focus {
    border-color: var(--interactive-accent) !important;
    box-shadow: 0 0 0 2px rgba(83, 141, 226, 0.3) !important;
    outline: none !important;
  }
  /* Dropdown list styling */
  .trade-form-view-container [data-combobox-type] ul[role="listbox"] {
    position: absolute !important;
    top: 38px !important; /* Position exactly at the bottom of input by using a fixed value */
    left: 0 !important;
    right: 0 !important;
    max-height: 200px !important;
    overflow-y: auto !important;
    background-color: var(--background-primary) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-top: none !important; /* Remove top border to create seamless connection */
    border-radius: 0 0 4px 4px !important; /* Only round the bottom corners */
    margin-top: -1px !important; /* Negative margin to pull up and overlap with input border */
    z-index: 9999 !important; /* Higher z-index to ensure dropdown stays above other elements */
    list-style: none !important;
    padding: 0 !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15) !important;
    animation: dropdown-fade-in 150ms ease-out !important;
    pointer-events: auto !important; /* Ensure clicks on the dropdown are detected */
  }
  /* Dropdown option styling */
  .trade-form-view-container [data-combobox-type] ul[role="listbox"] li {
    padding: 8px 12px !important;
    cursor: pointer !important;
    transition: background-color 150ms ease !important;
    margin: 0 !important;
  }
  /* Hover and highlighted state for options */
  .trade-form-view-container [data-combobox-type] ul[role="listbox"] li:hover,
  .trade-form-view-container [data-combobox-type] ul[role="listbox"] li[aria-selected="true"] {
    background-color: var(--background-secondary) !important;
  }
  /* Multi-select tags container */
  .trade-form-view-container [data-combobox-type="multi"] > div:first-of-type {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 4px !important;
    margin-bottom: 4px !important;
  }
  /* Individual tag styling */
  .trade-form-view-container [data-combobox-type="multi"] > div:first-of-type > span {
    display: inline-flex !important;
    align-items: center !important;
    padding: 2px 8px !important;
    background-color: var(--interactive-accent) !important;
    color: white !important;
    border-radius: 4px !important;
    font-size: 12px !important;
  }
  /* Remove button in tags */
  .trade-form-view-container [data-combobox-type="multi"] > div:first-of-type > span > button {
    background: none !important;
    border: none !important;
    color: white !important;
    cursor: pointer !important;
    font-size: 14px !important;
    line-height: 1 !important;
    padding: 0 4px !important;
    margin-left: 4px !important;
    /* Enhanced pointer events to ensure clicks are registered */
    pointer-events: auto !important;
    /* Make the button visually stand out more */
    opacity: 0.8 !important;
    transition: opacity 0.2s !important;
  }
  /* Add hover effects to make it clear it's clickable */
  .trade-form-view-container [data-combobox-type="multi"] > div:first-of-type > span > button:hover {
    opacity: 1 !important;
  }
  /* Special styling for "Add new" option */
  .trade-form-view-container [data-combobox-type] ul[role="listbox"] li[data-add-option="true"] {
    font-style: italic !important;
    border-top: 1px dashed var(--background-modifier-border) !important;
  }
  /* Animation for dropdown appearance */
  @keyframes dropdown-fade-in {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  /* Fix for option visibility in dropdowns */
  .trade-form-view-container select option {
    padding: 8px 12px !important;
    font-size: 14px !important;
    line-height: 1.5 !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
  }

  /* Make the select placeholder text appear greyed out */
  .trade-form-view-container select option[value=""][disabled],
  .trade-form-view-container select option:first-child:not([value]),
  .trade-form-view-container select option:first-child[value=""],
  .trade-form-view-container .select-placeholder,
  .trade-form-view-container option.select-placeholder {
    color: var(--text-muted) !important;
    font-style: italic !important; 
  }
  .trade-form-view-container input:focus,
  .trade-form-view-container select:focus,
  .trade-form-view-container textarea:focus {
    border-color: var(--interactive-accent) !important;
    box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.3) !important;
    outline: none !important;
  }
  .trade-form-view-container .label {
    display: block !important;
    font-size: 13px !important;
    font-weight: 500 !important;
    margin-bottom: 4px !important;
    color: var(--text-normal) !important;
  }
  .trade-form-view-container .errorMessage {
    font-size: 11px !important;
    color: #e53935 !important;
    margin-top: 2px !important;
    padding-left: 1px !important;
  }
  .trade-form-view-container button {
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    padding: 8px 16px !important;
    border-radius: 4px !important;
    cursor: pointer !important;
    font-weight: 500 !important;
    font-size: 14px !important;
  }
  .trade-form-view-container button.primary {
    background-color: var(--interactive-accent) !important;
    color: #ffffff !important;
    border: 1px solid var(--interactive-accent) !important;
  }
  .trade-form-view-container button.primary:hover:not(:disabled) {
    background-color: var(--interactive-accent-hover) !important;
    border-color: var(--interactive-accent-hover) !important;
  }
  .trade-form-view-container button.outline {
    background-color: transparent !important;
    color: var(--interactive-accent) !important;
    border: 1px solid var(--interactive-accent) !important;
  }
  .trade-form-view-container button.outline:hover:not(:disabled) {
    background-color: rgba(var(--interactive-accent-rgb), 0.1) !important;
  }
  /* Style for default values like 0.00 to make them look like placeholders */
  .trade-form-view-container input.default-value {
    color: var(--text-muted) !important;
    font-style: italic !important;
  }
  /* When a default value input is focused, reset the text style */
  .trade-form-view-container input.default-value:focus {
    color: var(--text-normal) !important;
    font-style: normal !important;
  }
  .trade-form-view-container .formActions {
    display: flex !important;
    justify-content: space-between !important;
    gap: 16px !important;
    margin-top: 4px !important; /* Small top margin */
    margin-bottom: 16px !important; /* Reduced bottom margin */
    padding: 0 !important;
  }
  .trade-form-view-container .twoColumnLayout {
    display: grid !important;
    grid-template-columns: 1fr 1fr !important;
    gap: 12px !important; /* Match other gaps */
    margin: 0 !important;
    padding: 0 !important;
  }
  /* Date picker container styling */
  .trade-form-view-container .date-picker-container {
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important;
  }
  @media (max-width: 600px) {
    .trade-form-view-container .twoColumnLayout {
      grid-template-columns: 1fr !important;
    }
  }
  .trade-form-view-container .calculatedValue {
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    text-align: center !important;
    padding: 12px !important;
    background-color: var(--background-secondary) !important;
    border-radius: 4px !important;
    margin: 0 !important; /* Remove all margins to maintain consistent spacing */
    width: 100% !important;
  }
  .trade-form-view-container .calculatedLabel {
    font-size: 12px !important;
    color: var(--text-muted) !important;
  }
  .trade-form-view-container .calculatedAmount {
    font-size: 18px !important;
    font-weight: 600 !important;
  }
  .trade-form-view-container .positive {
    color: #43a047 !important;
  }
  .trade-form-view-container .negative {
    color: #e53935 !important;
  }
  .trade-form-view-container .neutral {
    color: var(--text-normal) !important;
  }

  /* Asset Type Button Styles - Pill Style */
  .trade-form-view-container .asset-type-container {
    display: grid !important;
    grid-template-columns: repeat(3, 1fr) !important;
    grid-template-rows: repeat(2, 1fr) !important;
    gap: 8px !important;
    width: 100% !important;
    margin-bottom: 12px !important;
  }

  .trade-form-view-container .asset-type-button {
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 6px !important;
    padding: 8px 4px !important;
    font-size: 13px !important;
    height: 34px !important;
    transition: background-color 0.2s, border-color 0.2s !important;
    cursor: pointer !important;
    margin: 0 !important;
  }

  .trade-form-view-container .asset-type-button[aria-checked="true"] {
    background-color: var(--interactive-accent) !important;
    border-color: var(--interactive-accent) !important;
    color: white !important;
    font-weight: 500 !important;
  }

  .trade-form-view-container .asset-type-button:hover:not([aria-checked="true"]) {
    background-color: var(--background-secondary-alt) !important;
  }

  /* Asset-specific fields styling for consistent spacing */
  .trade-form-view-container .asset-specific-fields {
    display: flex !important;
    flex-direction: column !important;
    gap: 12px !important; /* Match the gap used in form container and section content */
    width: 100% !important;
    margin-bottom: 12px !important; /* Match other section spacing */
  }

  /* Direction Button Styles - Using the same pill style as Asset Type buttons */
  .trade-form-view-container .direction-container {
    display: flex !important;
    width: 100% !important;
    gap: 8px !important;
    margin-bottom: 12px !important;
  }

  .trade-form-view-container .direction-button {
    flex: 1 !important;
    background-color: var(--background-primary) !important;
    color: var(--text-normal) !important;
    border: 1px solid var(--background-modifier-border) !important;
    border-radius: 6px !important;
    padding: 8px 4px !important;
    font-size: 13px !important;
    height: 34px !important;
    transition: background-color 0.2s, border-color 0.2s !important;
    cursor: pointer !important;
    margin: 0 !important;
  }

  /* Remove border-right as we're now using individual pills */
  /* .trade-form-view-container .direction-button:not(:last-child) {
    border-right: 1px solid var(--background-modifier-border) !important;
  } */

  .trade-form-view-container .direction-button[aria-checked="true"] {
    background-color: var(--interactive-accent) !important;
    color: white !important;
  }

  .trade-form-view-container .direction-button:hover:not([aria-checked="true"]) {
    background-color: var(--background-secondary-alt) !important;
  }

  /* Required field indicator */
  .trade-form-view-container .required-indicator {
    color: #e53935 !important;
    margin-left: 4px !important;
    font-weight: bold !important;
  }

  .trade-form-view-container .thesisField {
    min-height: 100px !important;
  }
  .trade-form-view-container .tagContainer {
    display: flex !important;
    flex-wrap: wrap !important;
    gap: 4px !important;
    margin-top: 4px !important;
  }
  .trade-form-view-container .tag {
    display: inline-flex !important;
    align-items: center !important;
    padding: 4px 8px !important;
    background-color: var(--background-secondary) !important;
    border-radius: 2px !important;
    font-size: 12px !important;
    gap: 4px !important;
  }
  .trade-form-view-container .removeTag {
    cursor: pointer !important;
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
    width: 16px !important;
    height: 16px !important;
    border-radius: 50% !important;
    background-color: rgba(0, 0, 0, 0.1) !important;
  }
  .trade-form-view-container .errorSummary {
    background-color: rgba(229, 57, 53, 0.05) !important;
    border: 1px solid rgba(229, 57, 53, 0.5) !important;
    color: #e53935 !important;
    padding: 10px 12px !important;
    border-radius: 4px !important;
    margin-bottom: 16px !important;
    font-size: 13px !important;
    line-height: 1.4 !important;
    font-weight: 400 !important;
    box-shadow: none !important;
  }

  @keyframes errorPulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.02); }
    100% { transform: scale(1); }
  }

  /* Drag and drop styles */
  .trade-form-view-container .formContainer.is-dragging-over {
    position: relative !important;
  }

  .trade-form-view-container .drag-overlay {
    position: fixed !important; /* Fixed to viewport instead of absolute */
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    background-color: rgba(var(--background-primary-rgb, 255, 255, 255), 0.4) !important; /* Reduced opacity */
    backdrop-filter: blur(3px) !important;
    -webkit-backdrop-filter: blur(3px) !important;
    display: flex !important;
    justify-content: center !important;
    align-items: center !important;
    z-index: 9999 !important;
    animation: fade-in 0.2s ease-out !important;
  }

  .trade-form-view-container .drag-message-container {
    position: fixed !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important; /* Center in viewport */
    z-index: 10000 !important;
  }

  .trade-form-view-container .drag-message {
    font-size: 22px !important;
    font-weight: 400 !important; /* Lighter weight */
    font-family: var(--font-interface, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif) !important;
    color: var(--interactive-accent) !important;
    background-color: rgba(var(--background-primary-rgb, 255, 255, 255), 0.7) !important; /* Reduced opacity */
    padding: 14px 28px !important;
    border-radius: 6px !important;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08) !important; /* More subtle shadow */
    letter-spacing: 0.5px !important;
    border: 1px solid rgba(var(--interactive-accent-rgb, 83, 141, 226), 0.5) !important; /* Semi-transparent border */
    white-space: nowrap !important;
  }

  @keyframes fade-in {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  @keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
  }
`;function Yq(){let e=document.createElement("style");e.id="trade-form-styles",e.textContent=Yfe,document.head.appendChild(e)}function Kq(){let e=document.head.querySelector("#trade-form-styles");e&&e.remove()}Z.tradeForm={inject:Yq,remove:Kq};Bn();Z.dashboard={inject:yp,remove:K2};Bn();var Kfe=`
/* Account Note Styles */
.journalit-account-note {
  display: flex;
  flex-direction: column;
  width: 100%;
  font-family: var(--font-text);
  color: var(--text-normal);
}

/* Account Balance Chart Styles */
.journalit-account .account-balance-chart-container {
  margin-bottom: 25px;
  border-radius: 8px;
  padding: 12px 16px;
  /* Removed border to make chart feel less cramped */
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.journalit-account .account-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 15px;
  border-bottom: 1px solid var(--background-modifier-border);
}

.journalit-account .account-name {
  font-size: 1.8rem;
  font-weight: 600;
  color: var(--text-normal);
}

.journalit-account .account-type {
  font-size: 1rem;
  color: var(--text-muted);
  background-color: var(--background-secondary);
  padding: 4px 8px;
  border-radius: 4px;
}

.journalit-account .account-summary {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
  margin-bottom: 30px;
}

.journalit-account .account-metric {
  flex: 1;
  min-width: 200px;
  padding: 15px;
  background-color: var(--background-primary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 8px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.journalit-account .metric-label {
  font-size: 0.9rem;
  color: var(--text-muted);
  margin-bottom: 5px;
}

.journalit-account .metric-value {
  font-size: 1.3rem;
  font-weight: 600;
  color: var(--text-normal);
}

.journalit-account .account-details,
.journalit-account .account-performance {
  margin-bottom: 30px;
}

.journalit-account h3 {
  font-size: 1.3rem;
  font-weight: 600;
  margin-bottom: 15px;
  padding-bottom: 8px;
  border-bottom: 1px solid var(--background-modifier-border);
}

.journalit-account .details-grid,
.journalit-account .metrics-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 15px;
}

.journalit-account .detail-item,
.journalit-account .metric-item {
  padding: 10px;
  background-color: var(--background-secondary);
  border-radius: 4px;
  width: 100%;
  box-sizing: border-box;
}

.journalit-account .detail-label,
.journalit-account .metric-label {
  font-size: 0.8rem;
  color: var(--text-muted);
  margin-bottom: 5px;
}

.journalit-account .detail-value,
.journalit-account .metric-value {
  font-size: 1.1rem;
  font-weight: 500;
  color: var(--text-normal);
}

/* Cost details styles */
.journalit-account .cost-details {
  margin-top: 5px;
  font-size: 0.85rem;
  color: var(--text-muted);
}

.journalit-account .cost-total {
  font-weight: 500;
}

.journalit-account .cost-months {
  font-style: italic;
  font-size: 0.8rem;
}

/* Profit Target Styles */
.journalit-account .profit-target-item {
  grid-column: 1 / -1; /* Make the profit target item span the full width */
  width: 100%;
  box-sizing: border-box;
  margin: 0;
}

.journalit-account .target-date {
  font-size: 0.9rem;
  color: var(--text-muted);
  font-style: italic;
  margin-left: 5px;
}

.journalit-account .target-progress {
  font-size: 0.9rem;
  color: var(--text-muted);
  margin-left: 5px;
}

.journalit-account .profit-target-progress {
  margin-top: 10px;
}

.journalit-account .progress-container {
  width: 100%;
  height: 10px;
  background-color: var(--background-modifier-border);
  border-radius: 5px;
  overflow: hidden;
}

.journalit-account .progress-bar {
  height: 100%;
  background-color: var(--interactive-accent);
  border-radius: 5px;
  transition: width 0.5s ease;
}

.journalit-account .progress-bar.complete {
  background-color: gold; /* Gold color when target is reached */
}

/* Transaction Table Styles */
.journalit-account .account-transactions {
  margin-top: 20px;
}

.journalit-account .transactions-table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 10px;
  font-size: 0.9rem;
}

.journalit-account .transactions-table thead {
  background-color: var(--background-secondary);
}

.journalit-account .transactions-table th {
  text-align: left;
  padding: 10px;
  font-weight: 600;
  color: var(--text-normal);
  border-bottom: 2px solid var(--background-modifier-border);
}

.journalit-account .transactions-table td {
  padding: 10px;
  border-bottom: 1px solid var(--background-modifier-border);
}

.journalit-account .transactions-table .transaction-row:hover {
  background-color: var(--background-secondary);
}

.journalit-account .transactions-table .positive {
  color: var(--interactive-success);
}

.journalit-account .transactions-table .negative {
  color: var(--text-error);
}

.journalit-account .transactions-table .deposit {
  background-color: rgba(var(--interactive-success-rgb), 0.05);
}

.journalit-account .transactions-table .withdrawal {
  background-color: rgba(var(--text-error-rgb), 0.05);
}

.journalit-account .empty-transactions {
  padding: 20px;
  text-align: center;
  color: var(--text-muted);
  background-color: var(--background-secondary);
  border-radius: 4px;
}

/* Account Dashboard View Styles */
.journalit-account-dashboard-container {
  padding: 20px;
  height: 100%;
  overflow-y: auto;
  background-color: var(--background-primary);
}

.journalit-account-dashboard {
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
}

.journalit-account-dashboard .dashboard-content {
  display: flex;
  flex-direction: column;
  width: 100%;
}

/* AUM Chart Styles */
.journalit-account-dashboard .aum-chart {
  width: 100%;
  margin-bottom: 10px;
}

/* Dashboard placeholder styles */
.journalit-account-dashboard-placeholder {
  text-align: center;
  padding: 40px 20px;
  background-color: var(--background-secondary);
  border-radius: 8px;
  margin-top: 20px;
}

.journalit-account-dashboard-placeholder h2 {
  font-size: 1.8rem;
  margin-bottom: 20px;
  color: var(--text-normal);
}

.journalit-account-dashboard-placeholder p {
  font-size: 1rem;
  color: var(--text-muted);
  margin-bottom: 15px;
}

.journalit-account-dashboard-placeholder ul {
  text-align: left;
  max-width: 400px;
  margin: 20px auto;
}

.journalit-account-dashboard-placeholder li {
  margin-bottom: 8px;
  color: var(--text-normal);
}

/* New Account Dashboard Styles */

/* Dashboard Metrics Styles */
.journalit-account-dashboard .dashboard-metrics {
  display: flex;
  flex-direction: row;
  flex-wrap: nowrap;
  gap: 10px;
  margin-bottom: 30px;
  margin-top: 10px;
  padding: 0 10px;
  overflow-x: auto;
}

.journalit-account-dashboard .metric-item {
  flex: 1;
  min-width: 180px;
  max-width: 300px;
  padding: 15px;
  background-color: var(--background-secondary);
  border-radius: 8px;
  text-align: center;
  transition: transform 0.2s ease;
}

.journalit-account-dashboard .metric-item:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.journalit-account-dashboard .metric-value {
  font-size: 1.5rem;
  font-weight: 600;
  margin-bottom: 5px;
  color: var(--text-normal);
}

.journalit-account-dashboard .metric-value.positive {
  color: var(--text-success);
}

.journalit-account-dashboard .metric-value.negative {
  color: var(--text-error);
}

.journalit-account-dashboard .metric-label {
  font-size: 0.9rem;
  color: var(--text-muted);
}

/* Account Sections Styles */
.journalit-account-dashboard .account-sections {
  display: flex;
  flex-direction: column;
  gap: 15px;
  padding: 0 10px;
}

.journalit-account-dashboard .account-section {
  background-color: var(--background-primary);
  border-radius: 8px;
  padding: 20px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.journalit-account-dashboard .account-section h3 {
  font-size: 1.3rem;
  font-weight: 600;
  margin-bottom: 15px;
  padding-bottom: 10px;
  border-bottom: 1px solid var(--background-modifier-border);
  color: var(--text-normal);
}

.journalit-account-dashboard .account-cards {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 15px;
}

/* Account Card Styles */
.journalit-account-dashboard .account-card {
  background-color: var(--background-secondary);
  border-radius: 8px;
  padding: 15px;
  cursor: pointer;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.journalit-account-dashboard .account-card:hover {
  transform: translateY(-3px);
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
}

.journalit-account-dashboard .account-card-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  padding-bottom: 10px;
  border-bottom: 1px solid var(--background-modifier-border);
}

.journalit-account-dashboard .account-name {
  font-size: 1.2rem;
  font-weight: 600;
  color: var(--text-normal);
}

.journalit-account-dashboard .account-balance {
  font-size: 1.2rem;
  font-weight: 600;
  color: var(--text-normal);
}

.journalit-account-dashboard .account-card-metrics {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
}

.journalit-account-dashboard .account-metric {
  margin-bottom: 5px;
}

.journalit-account-dashboard .account-metric .metric-label {
  font-size: 0.8rem;
  color: var(--text-muted);
  margin-bottom: 3px;
}

.journalit-account-dashboard .account-metric .metric-value {
  font-size: 0.95rem;
  font-weight: 500;
  color: var(--text-normal);
}

.journalit-account-dashboard .account-metric .metric-value.positive {
  color: var(--text-success);
}

.journalit-account-dashboard .account-metric .metric-value.negative {
  color: var(--text-error);
}

/* Profit target and drawdown in account card */
.journalit-account-dashboard .account-metric.profit-target,
.journalit-account-dashboard .account-metric.drawdown-target {
  grid-column: span 2;
  margin-top: 5px;
}

/* Common progress bar styles */
.journalit-account-dashboard .profit-target-progress,
.journalit-account-dashboard .drawdown-progress {
  margin-top: 5px;
  width: 100%;
  height: 6px;
  background-color: var(--background-modifier-border);
  border-radius: 3px;
  overflow: hidden;
}

/* Progress bar styles */
.journalit-account-dashboard .profit-target-progress .progress-bar,
.journalit-account-dashboard .drawdown-progress .progress-bar {
  height: 100%;
  border-radius: 3px;
  transition: width 0.5s ease, background-color 0.5s ease;
}

/* Profit target specific styles */
.journalit-account-dashboard .profit-target-progress .progress-bar {
  background-color: var(--interactive-accent);
}

.journalit-account-dashboard .profit-target-progress .progress-bar.complete {
  background-color: var(--text-success);
}

/* Drawdown specific styles */
.journalit-account-dashboard .drawdown-progress .progress-bar.safe {
  background-color: var(--text-success);
}

.journalit-account-dashboard .drawdown-progress .progress-bar.warning {
  background-color: var(--text-warning, gold);
}

.journalit-account-dashboard .drawdown-progress .progress-bar.critical {
  background-color: var(--text-error);
}

/* Loading and Error States */
.journalit-account-dashboard.loading {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
  font-size: 1.2rem;
  color: var(--text-muted);
}

.journalit-account-dashboard.error {
  padding: 20px;
  color: var(--text-error);
  background-color: rgba(var(--text-error-rgb), 0.05);
  border-left: 3px solid var(--text-error);
  margin: 20px;
  border-radius: 0 4px 4px 0;
}

.journalit-account-dashboard .loading-spinner {
  padding: 20px;
  text-align: center;
}

.journalit-account-dashboard .error-message {
  padding: 20px;
  font-weight: 500;
}
`;function Jq(){let e="journalit-account-styles";if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=Kfe,document.head.appendChild(t)}function Xq(){let e=document.getElementById("journalit-account-styles");e&&e.remove()}var Jfe=`
.transaction-modal-container {
  width: 100%;
  padding: 0;
}

.transaction-modal {
  padding: 16px;
  font-family: var(--font-text);
  color: var(--text-normal);
}

.transaction-modal h3 {
  margin-top: 0;
  margin-bottom: 16px;
  font-size: 1.3rem;
  font-weight: 600;
  color: var(--text-normal);
  border-bottom: 1px solid var(--background-modifier-border);
  padding-bottom: 8px;
}

.transaction-modal-error {
  margin-bottom: 16px;
  padding: 8px 12px;
  background-color: rgba(var(--text-error-rgb), 0.1);
  border-left: 3px solid var(--text-error);
  color: var(--text-error);
  border-radius: 0 4px 4px 0;
}

.transaction-modal-field {
  margin-bottom: 16px;
}

.transaction-modal-field label {
  display: block;
  margin-bottom: 6px;
  font-weight: 500;
  font-size: 0.9rem;
  color: var(--text-normal);
}

.transaction-modal-field input,
.transaction-modal-field select {
  width: 100%;
  padding: 8px 10px;
  border: 1px solid var(--background-modifier-border);
  border-radius: 4px;
  background-color: var(--background-primary);
  color: var(--text-normal);
  font-size: 0.9rem;
  text-overflow: ellipsis;
  min-height: 36px; /* Ensure consistent height */
  max-width: 100%; /* Prevent overflow */
}

.transaction-modal-field input:focus,
.transaction-modal-field select:focus {
  border-color: var(--interactive-accent);
  box-shadow: 0 0 0 2px rgba(var(--interactive-accent-rgb), 0.2);
  outline: none;
}

/* Specific styling for transaction type dropdown */
.transaction-type-selector {
  width: 100%;
  padding: 8px 10px;
  height: auto; /* Allow height to adjust to content */
  min-height: 36px;
  text-overflow: ellipsis;
  white-space: normal; /* Allow text to wrap if needed */
  overflow: visible; /* Show overflow content */
  -webkit-appearance: menulist; /* Ensures proper dropdown appearance */
  appearance: menulist;
  display: block; /* Prevent text cutoff */
  line-height: 1.5; /* Improve text rendering */
}

/* Style for dropdown options to ensure they display properly */
.transaction-type-selector option {
  white-space: normal; /* Allow option text to wrap */
  padding: 8px;
  text-overflow: ellipsis;
}

.transaction-modal-buttons {
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  margin-top: 24px;
}

/* Styling for account transaction button */
.account-transactions-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
}

.account-transactions-header h3 {
  margin: 0;
}

.add-transaction-button {
  padding: 4px 8px;
  background-color: var(--interactive-accent);
  color: var(--text-on-accent);
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.add-transaction-button:hover {
  background-color: var(--interactive-accent-hover);
}

/* Styling for transaction rows to indicate they're clickable */
.journalit-account .transactions-table .deposit,
.journalit-account .transactions-table .withdrawal {
  cursor: pointer;
}

.journalit-account .transactions-table .deposit:hover,
.journalit-account .transactions-table .withdrawal:hover {
  background-color: var(--background-secondary-alt);
}
`;function Qq(){let e="journalit-transaction-modal-styles";if(document.getElementById(e))return;let t=document.createElement("style");t.id=e,t.textContent=Jfe,document.head.appendChild(t)}function Zq(){let e=document.getElementById("journalit-transaction-modal-styles");e&&e.remove()}ME();Z.account={inject:Jq,remove:Xq};Z.transactionModal={inject:Qq,remove:Zq};Z.accountLinkModal={inject:AE,remove:NE};Bn();var Xfe=`
/* Trade Log View Container 
 * CRITICAL: All flex containers in the hierarchy must have min-height: 0
 * to fix Firefox and other browser flexbox scrolling issues.
 * See: https://stackoverflow.com/questions/36535656/using-flexbox-and-overflow-hidden-scroll-not-working-in-firefox
 */
.journalit-trade-log-view-container {
  height: 100%;
  overflow: hidden !important; /* Override ReactView inline styles */
  display: flex;
  flex-direction: column;
  padding: 0;
  min-height: 0; /* Critical for flexbox scrolling */
}

/* Target the React root element to prevent it from scrolling */
.journalit-trade-log-view-container > div[id^="react-root-"] {
  height: 100%;
  overflow: visible;
  display: flex;
  flex-direction: column;
  min-height: 0; /* Critical for flexbox scrolling */
}

/* Main Container */
.journalit-trade-log {
  display: flex;
  flex-direction: column;
  height: 100%;
  background: var(--background-primary);
  color: var(--text-normal);
  overflow: hidden;
  min-height: 0; /* Critical for flexbox scrolling */
}

/* Header */
.trade-log-header {
  padding: 16px;
  border-bottom: 1px solid var(--background-modifier-border);
  background: var(--background-secondary);
}

.trade-log-controls {
  display: flex;
  gap: 16px;
  align-items: center;
  margin-bottom: 12px;
}

.view-level-selector {
  display: flex;
  align-items: center;
  gap: 8px;
}

.view-level-selector label {
  font-weight: 500;
  color: var(--text-muted);
}

.date-range-selector {
  flex: 1;
  display: flex;
  justify-content: flex-end;
}

/* Filter Placeholder */
.trade-log-filter-placeholder {
  padding: 12px;
  background: var(--background-primary-alt);
  border-radius: 4px;
  border: 1px dashed var(--background-modifier-border);
}

.filter-placeholder-content {
  display: flex;
  align-items: center;
  gap: 8px;
  color: var(--text-muted);
  font-size: 14px;
}

.filter-icon {
  font-size: 16px;
}

/* Content Area */
.trade-log-content {
  flex: 1 1 0; /* CRITICAL: Force height constraint */
  overflow-y: auto;
  overflow-x: hidden;
  padding: 0 0 40px 0;
  position: relative;
  min-height: 0; /* Important for flex children to scroll properly */
  max-height: 100%; /* Prevent expansion beyond parent */
  height: 0; /* Force flex to control height */
  /* Optimize scrolling performance */
  -webkit-overflow-scrolling: touch;
  scroll-behavior: auto; /* Disable smooth scrolling for better performance */
  will-change: scroll-position;
  /* Cross-browser flexbox scrolling fix */
  contain: layout;
}

/* Ensure proper scrolling in trades view */
.trade-log-content.trades-view {
  display: flex;
  flex-direction: column;
  min-height: 0; /* Critical for flexbox scrolling */
  height: 100%; /* Force container to constrain children height */
  max-height: 100%; /* AnuPpuccin theme compatibility */
}

/* Use native scrollbar for better performance */
.trade-log-content::-webkit-scrollbar {
  width: 8px;
}

.trade-log-content::-webkit-scrollbar-thumb {
  background: var(--background-modifier-border);
  border-radius: 4px;
}

/* Loading State */
.trade-log-loading {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 40px;
  color: var(--text-muted);
}

.spinner {
  display: inline-flex;
  align-items: center;
  gap: 8px;
}

.spinner::before {
  content: '';
  width: 16px;
  height: 16px;
  border: 2px solid var(--text-muted);
  border-top-color: transparent;
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

/* Tree View */
.trade-log-tree {
  width: 100%;
  padding: 8px 0;
  flex: 1 0 auto; /* Allow tree to grow but not shrink */
  contain: layout; /* Improve rendering performance */
  min-height: 0; /* Critical for flexbox scrolling */
  /* Force proper overflow behavior in all browsers */
  overflow: visible;
}

/* Tree container for virtualized list */
.trade-log-tree-container {
  flex: 1;
  overflow: hidden;
  position: relative;
  min-height: 0; /* Critical for flexbox scrolling */
}

/* Node Styles */
.trade-log-node {
  display: flex;
  align-items: stretch;
  min-height: 48px;
  position: relative;
  /* Fade in animation for lazy-loaded nodes */
  animation: fadeIn 0.2s ease-out;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.trade-log-node:hover {
  background-color: var(--background-modifier-hover);
}

/* Placeholder styles for lazy loading */
.trade-log-node-placeholder {
  display: flex;
  align-items: center;
  position: relative;
  opacity: 0.3;
}

/* Tree Structure Visualization */
.tree-structure {
  display: flex;
  align-items: stretch;
  position: relative;
}

.tree-level {
  width: 24px;
  position: relative;
}

.tree-level::before {
  content: '';
  position: absolute;
  left: 11px;
  top: 0;
  bottom: 0;
  width: 1px;
  background: var(--background-modifier-border);
}

/* Special case for last child - clip the vertical line */
.trade-log-node.is-last-child .tree-level.last-level::before {
  height: 24px;
}

/* Hide expand/collapse lines for leaf nodes */
.trade-log-node--trade .tree-expand-wrapper {
  height: auto;
  width: 12px;
  margin-right: 0;
}

/* Node wrapper */
.node-wrapper {
  flex: 1;
  display: flex;
  align-items: center;
  position: relative;
}

/* Trade node specific wrapper adjustment */
.trade-log-node--trade .node-wrapper {
  padding-left: 0;
}

/* Tree node indicator for trade items */
.tree-node-indicator {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 20px;
  position: relative;
  margin-right: 8px;
}

/* Tree connector line */
.tree-connector {
  position: absolute;
  left: -13px;
  top: 50%;
  width: 12px;
  height: 1px;
  background: var(--background-modifier-border);
}

.tree-connector--trade {
  top: 0;
}

/* Expand/collapse wrapper */
.tree-expand-wrapper {
  width: 20px;
  height: 48px;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  margin-right: 4px;
}

/* Tree leaf node (no children) */
.tree-leaf-node {
  width: 2px;
  height: 2px;
  background: var(--text-muted);
  border-radius: 50%;
  position: relative;
}

.tree-leaf-node::before {
  content: '';
  position: absolute;
  left: -5px;
  top: 50%;
  width: 5px;
  height: 1px;
  background: var(--background-modifier-border);
}

.tree-leaf-node--trade {
  background: var(--text-normal);
  margin-right: 0;
}

/* When in the tree indicator cell, adjust positioning */
.tree-indicator-cell .tree-leaf-node {
  margin-left: 7px;
}

.tree-indicator-cell .tree-connector {
  left: -6px;
  width: 6px;
  transform: translateY(-50%);
}


.node-content {
  display: flex;
  align-items: center;
  width: 100%;
  gap: 8px;
  padding-right: 16px;
}

/* Chevron Button */
.node-chevron {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 14px;
  height: 14px;
  padding: 0;
  border: none;
  background: none;
  color: var(--text-muted);
  cursor: pointer;
  position: relative;
}

.node-chevron:hover {
  color: var(--text-normal);
}

.node-chevron svg {
  width: 14px;
  height: 14px;
}

/* Node Label */
.node-label {
  flex: 0 0 auto;
  font-weight: 500;
  cursor: pointer;
  padding: 4px 8px;
  border-radius: 4px;
  /* Remove transition for better performance */
  /* transition: all 0.15s ease; */
  display: inline-flex;
  align-items: center;
  gap: 4px;
}

.node-label:hover {
  background-color: var(--background-modifier-hover);
  color: var(--text-accent);
}

/* Node type-specific styles */
.trade-log-node--year .node-label {
  font-size: 16px;
  font-weight: 600;
}

.trade-log-node--quarter .node-label,
.trade-log-node--month .node-label {
  font-size: 15px;
}

.trade-log-node--week .node-label,
.trade-log-node--day .node-label {
  font-size: 14px;
}

/* Metrics */
.node-metrics {
  display: flex;
  align-items: center;
  gap: 16px;
  margin-left: auto;
  padding-right: 16px;
}

.metric {
  font-size: 13px;
  white-space: nowrap;
}

.metric--count {
  color: var(--text-muted);
}

.metric--winrate {
  font-weight: 500;
}

.metric--winrate.high {
  color: rgb(76, 175, 80);
}

.metric--winrate.medium {
  color: rgb(255, 193, 7);
}

.metric--winrate.low {
  color: rgb(244, 67, 54);
}

.metric--pnl {
  font-weight: 600;
  font-family: var(--font-monospace);
}

.metric--pnl.positive {
  color: rgb(76, 175, 80);
}

.metric--pnl.negative {
  color: rgb(244, 67, 54);
}

.metric--pnl.neutral {
  color: rgb(128, 128, 128);
}

/* Performance Indicators */
.performance-indicator {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  margin-left: 8px;
  vertical-align: middle;
}

.performance-indicator svg {
  width: 16px;
  height: 16px;
  vertical-align: text-bottom;
}

.performance-indicator--best {
  color: #FFD700; /* Gold color for crown */
}

.performance-indicator--worst {
  color: rgb(244, 67, 54); /* Red color for alert */
}

/* Make indicators more prominent on hover */
.node-label:hover .performance-indicator--best {
  color: #FFA500; /* Orange on hover */
}

.node-label:hover .performance-indicator--worst {
  color: rgb(255, 100, 100); /* Lighter red on hover */
}

/* Column Headers */
.trade-log-headers {
  position: sticky;
  top: 0;
  background: var(--background-secondary);
  border-bottom: 2px solid var(--background-modifier-border);
  z-index: 10;
  padding: 0 8px;
  flex-shrink: 0; /* Prevent headers from shrinking */
}

.trade-log-header-row {
  display: grid;
  grid-template-columns: 50px 120px 80px 80px 100px 80px 80px 80px 60px 60px 1fr;
  gap: 8px;
  align-items: center;
  padding: 12px 16px 12px 16px;
  font-size: 13px;
  font-weight: 600;
  color: var(--text-muted);
  text-transform: uppercase;
}

.header-cell {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.header-image {
  text-align: center;
}

.header-ticker {
  text-align: center;
}

.header-direction {
  text-align: center;
}

.header-duration {
  text-align: center;
}

.header-status {
  text-align: center;
}

.header-pnl {
  text-align: center;
}

.header-date {
  text-align: center;
}

.header-account {
  text-align: center;
}

.header-mistakes {
  text-align: center;
}

.header-setups {
  text-align: center;
}

/* Trade Details Row */
.trade-details-row {
  display: grid;
  grid-template-columns: 50px 120px 80px 80px 100px 80px 80px 80px 60px 60px 1fr;
  gap: 8px;
  align-items: center;
  flex: 1;
  padding: 0 16px 0 8px;
}

/* Tree view trade details row */
.trade-details-row.tree-view-row {
  grid-template-columns: 20px 50px 120px 80px 80px 100px 80px 80px 80px 60px 60px 1fr;
  gap: 6px;
  padding: 0 16px 0 0;
}

/* Tree indicator cell */
.tree-indicator-cell {
  display: flex;
  align-items: center;
  justify-content: flex-end;
  position: relative;
  width: 20px;
}

/* Trades view mode specific styles */
.trade-log-content.trades-view .trade-log-node--trade {
  padding: 0;
}

.trade-log-content.trades-view .trade-details-row.trades-view-row {
  padding: 0 16px;
  width: 100%;
}

/* Make trade rows clickable */
.trade-log-node--trade {
  cursor: pointer;
}

.trade-log-node--trade:hover {
  background-color: var(--background-modifier-hover);
}

/* Trade cells */
.trade-image-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-image-wrapper {
  position: relative;
  cursor: pointer;
  /* Remove transition for better scroll performance */
  /* transition: transform 0.15s ease; */
}

.trade-image-wrapper:hover {
  /* Simpler hover effect without transform */
  opacity: 0.8;
}

.trade-preview-thumbnail {
  width: 40px;
  height: 40px;
  border-radius: 4px;
  overflow: hidden;
  border: 1px solid var(--background-modifier-border);
  background: var(--background-secondary);
  /* Prevent layout shift while images load */
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  /* Optimize image rendering */
  image-rendering: -webkit-optimize-contrast;
  backface-visibility: hidden;
  transform: translateZ(0);
}

.trade-image-count {
  position: absolute;
  bottom: -4px;
  right: -4px;
  background: var(--background-primary);
  color: var(--text-muted);
  font-size: 10px;
  padding: 2px 4px;
  border-radius: 3px;
  border: 1px solid var(--background-modifier-border);
  font-weight: 600;
}

.trade-no-image-icon {
  color: var(--text-faint);
}

.trade-ticker-cell {
  text-align: center;
}

.trade-ticker {
  font-weight: 600;
  color: var(--text-normal);
  display: inline-flex;
  align-items: center;
  gap: 6px;
}

.trade-direction-cell {
  text-align: center;
}

.trade-direction {
  font-size: 13px;
  font-weight: 500;
  text-transform: uppercase;
  color: var(--text-normal);
}

/* Trade Status */
.trade-status {
  display: inline-block;
  padding: 2px 8px;
  border-radius: 3px;
  font-size: 12px;
  font-weight: 600;
  text-transform: uppercase;
}

.status-win {
  background: rgba(76, 175, 80, 0.15);
  color: rgb(76, 175, 80);
}

.status-loss {
  background: rgba(244, 67, 54, 0.15);
  color: rgb(244, 67, 54);
}

.status-breakeven {
  background: rgba(128, 128, 128, 0.15);
  color: rgb(128, 128, 128);
}

.status-missed {
  background: rgba(255, 149, 0, 0.15);
  color: rgb(255, 149, 0);
}

.status-open {
  background: rgba(33, 150, 243, 0.15);
  color: rgb(33, 150, 243);
}

.trade-pnl-cell {
  text-align: center;
}

.trade-pnl {
  font-weight: 600;
  font-family: var(--font-monospace);
}

.trade-pnl.positive {
  color: rgb(76, 175, 80);
}

.trade-pnl.negative {
  color: rgb(244, 67, 54);
}

.trade-pnl.neutral {
  color: rgb(128, 128, 128);
}

.trade-pnl.open {
  color: rgb(33, 150, 243);
  font-style: italic;
}

.trade-status-cell {
  text-align: center;
}

.trade-duration-cell {
  text-align: center;
}

.trade-duration {
  color: var(--text-muted);
  font-size: 13px;
}

.trade-date-cell {
  text-align: center;
}

.trade-date {
  color: var(--text-muted);
  font-size: 13px;
  font-family: var(--font-monospace);
}

.trade-mistakes-cell,
.trade-setups-cell,
.trade-account-cell {
  display: flex;
  align-items: center;
  justify-content: center;
}

.trade-thesis {
  font-size: 13px;
  color: var(--text-normal);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  cursor: help;
}

.trade-no-data {
  color: var(--text-faint);
  font-size: 13px;
}

/* Count Badges */
.count-badge {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  font-size: 12px;
  font-weight: 600;
  cursor: help;
  /* Remove transition for better performance */
  /* transition: all 0.15s ease; */
}

.count-badge--mistakes {
  background: rgba(244, 67, 54, 0.15);
  color: rgb(244, 67, 54);
  border: 1px solid rgba(244, 67, 54, 0.3);
}

.count-badge--mistakes:hover {
  background: rgba(244, 67, 54, 0.25);
  /* Remove transform for better performance */
  /* transform: scale(1.1); */
}

.count-badge--setups {
  background: rgba(33, 150, 243, 0.15);
  color: rgb(33, 150, 243);
  border: 1px solid rgba(33, 150, 243, 0.3);
}

.count-badge--setups:hover {
  background: rgba(33, 150, 243, 0.25);
  /* Remove transform for better performance */
  /* transform: scale(1.1); */
}

.count-badge--accounts {
  background: rgba(156, 39, 176, 0.15);
  color: rgb(156, 39, 176);
  border: 1px solid rgba(156, 39, 176, 0.3);
}

.count-badge--accounts:hover {
  background: rgba(156, 39, 176, 0.25);
  /* Remove transform for better performance */
  /* transform: scale(1.1); */
}

/* Tooltip Styles */
.tooltip-trigger {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  position: relative;
}

.journalit-tooltip {
  background: var(--background-secondary);
  border: 1px solid var(--background-modifier-border);
  border-radius: 6px;
  padding: 8px 12px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
  max-width: 250px;
  min-width: 120px;
  font-size: 13px;
  color: var(--text-normal);
  z-index: 9999;
  pointer-events: none;
  position: fixed !important;
}

.tooltip-title {
  font-weight: 600;
  margin-bottom: 4px;
  color: var(--text-normal);
}

.tooltip-item {
  color: var(--text-muted);
  margin: 2px 0;
  line-height: 1.4;
  white-space: nowrap;
}

.mistakes-tooltip .tooltip-title {
  color: rgb(244, 67, 54);
}

.setups-tooltip .tooltip-title {
  color: rgb(33, 150, 243);
}

.accounts-tooltip .tooltip-title {
  color: rgb(156, 39, 176);
}

.thesis-tooltip .tooltip-content {
  white-space: pre-wrap;
  word-break: break-word;
  line-height: 1.5;
  color: var(--text-normal);
}

/* Responsive Design */
@media (max-width: 1200px) {
  .trade-details-row,
  .trade-log-header-row {
    grid-template-columns: 50px 100px 60px 60px 80px 60px 60px 60px 50px 50px 1fr;
  }
  
  .trade-details-row.tree-view-row {
    grid-template-columns: 20px 50px 100px 60px 60px 80px 60px 60px 60px 50px 50px 1fr;
  }
  
  .metric--best,
  .metric--worst {
    display: none;
  }
}

@media (max-width: 900px) {
  .trade-details-row,
  .trade-log-header-row {
    grid-template-columns: 50px 80px 60px 60px 80px 60px 60px 1fr;
  }
  
  .trade-account-cell,
  .header-account,
  .trade-mistakes-cell,
  .trade-setups-cell,
  .header-mistakes,
  .header-setups {
    display: none;
  }
}

`;function eG(){let e=document.createElement("style");e.id="trade-log-styles",e.textContent=Xfe,document.head.appendChild(e)}function tG(){let e=document.head.querySelector("#trade-log-styles");e&&e.remove()}Z.tradeLog={inject:eG,remove:tG};var sG=require("obsidian");var aG=$(W());var ce=$(W());Jr();var rG=require("obsidian"),Mt=$(W()),nG=$(Ps());Jr();Ci();var bI=class extends rG.Modal{constructor(r){super(r.app);this.root=null;this.props=r}onOpen(){let{contentEl:r}=this;r.empty(),this.container=r.createDiv({cls:"transaction-modal-container"}),this.renderComponent()}onClose(){this.root&&(this.root.unmount(),this.root=null);let{contentEl:r}=this;r.empty(),this.props.onClose()}renderComponent(){this.root=(0,nG.createRoot)(this.container),this.root.render(Mt.default.createElement(Qfe,{...this.props,closeModal:()=>this.close()}))}},Qfe=({plugin:e,account:t,transaction:r,closeModal:n})=>{let[i,o]=(0,Mt.useState)(r?r.type:"deposit"),[a,s]=(0,Mt.useState)(r?Math.abs(r.amount).toString():""),[l,c]=(0,Mt.useState)(r?new Date(r.date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0]),[d,u]=(0,Mt.useState)((r==null?void 0:r.description)||""),[p,m]=(0,Mt.useState)(""),g=h=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(h),f=async h=>{h.preventDefault();try{let v=parseFloat(a);if(isNaN(v)||v<=0){m("Amount must be a positive number");return}let b=new Date(l);r&&await e.accountService.deleteTransaction(t.id,r.id),i==="deposit"?await e.accountTransactionService.addDeposit(t.id,v,b,d):await e.accountTransactionService.addWithdrawal(t.id,v,b,d),n()}catch(v){console.error("Error saving transaction:",v),m(v.message||"Failed to save transaction")}},y=async()=>{if(r)try{await e.accountService.deleteTransaction(t.id,r.id),n()}catch(h){console.error("Error deleting transaction:",h),m(h.message||"Failed to delete transaction")}};return Mt.default.createElement("div",{className:"transaction-modal"},Mt.default.createElement("h3",null,r?"Edit Transaction":"Add Transaction"),p&&Mt.default.createElement("div",{className:"transaction-modal-error"},p),Mt.default.createElement("form",{onSubmit:f},Mt.default.createElement("div",{className:"transaction-modal-field"},Mt.default.createElement("label",null,"Transaction Type"),Mt.default.createElement("select",{value:i,onChange:h=>o(h.target.value),className:"transaction-type-selector",title:i==="deposit"?"Deposit":"Withdrawal"},Mt.default.createElement("option",{value:"deposit"},"Deposit"),Mt.default.createElement("option",{value:"withdrawal"},"Withdrawal"))),Mt.default.createElement("div",{className:"transaction-modal-field"},Mt.default.createElement("label",null,"Amount"),Mt.default.createElement("input",{type:"number",value:a,onChange:h=>s(h.target.value),placeholder:"0.00",min:"0.01",step:"0.01",required:!0})),Mt.default.createElement("div",{className:"transaction-modal-field"},Mt.default.createElement("label",null,"Date"),Mt.default.createElement("input",{type:"date",value:l,onChange:h=>c(h.target.value),required:!0})),Mt.default.createElement("div",{className:"transaction-modal-field"},Mt.default.createElement("label",null,"Description (Optional)"),Mt.default.createElement("input",{type:"text",value:d,onChange:h=>u(h.target.value),placeholder:i==="deposit"?"Deposit":"Withdrawal"})),Mt.default.createElement("div",{className:"transaction-modal-buttons"},Mt.default.createElement(be,{variant:"primary",type:"submit"},r?"Save Changes":"Add Transaction"),Mt.default.createElement(be,{variant:"secondary",onClick:n},"Cancel"),r&&Mt.default.createElement(be,{variant:"danger",onClick:y,type:"button"},"Delete"))))};function wI(e,t,r,n,i){let o=new bI({app:e,plugin:t,account:r,transaction:n,onClose:i||(()=>{})});return o.open(),o}var Ie=$(W());Yt();oi();Jr();var Zfe=(e,t,r)=>{let n=t-e,i;n<=100?i=10:n<=1e3?i=100:n<=1e4?i=1e3:n<=1e5?i=1e4:n<=1e6?i=1e5:i=1e6;let o=Math.floor(e/i)*i,a=[];for(let s=o;s<=t+i;s+=i)a.push(s);if(a.includes(r)||(a.push(r),a.sort((s,l)=>s-l)),a.length>10){let s=[],l=Math.ceil(a.length/7);for(let c=0;c<a.length;c+=l)s.push(a[c]);return s.includes(r)||(s.push(r),s.sort((c,d)=>c-d)),s[s.length-1]!==a[a.length-1]&&s.push(a[a.length-1]),s}return a},ege=e=>{if(!e)return"-";if(!e.startsWith("Trade P&L:"))return e;let t=/Trade P&L: .+\/([A-Z0-9]+)-(\d{6})-([^.]+)\.md/,r=e.match(t);if(!r||r.length<4)return e;let[,n,i,o]=r;try{let a="20"+i.substring(0,2),s=i.substring(2,4),l=i.substring(4,6),d=new Date(`${a}-${s}-${l}`).toLocaleDateString("en-US",{month:"short",day:"numeric"});return`${n} ${o} (${d})`}catch(a){return`${n} ${o}`}},tge=({active:e,payload:t})=>{if(!e||!t||t.length===0)return null;let r=t[0].payload;return Ie.default.createElement("div",{className:"journalit-chart-tooltip",style:{backgroundColor:"var(--background-primary)",borderRadius:"8px",padding:"12px 16px",minWidth:"180px",border:"1px solid var(--background-modifier-border)",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.2)",transform:"translateY(-4px)",position:"relative"}},Ie.default.createElement("div",{className:"journalit-chart-tooltip-date",style:{fontSize:"14px",fontWeight:500,color:"var(--text-normal)",marginBottom:"8px",textAlign:"center"}},r.date),Ie.default.createElement("div",{className:"journalit-chart-tooltip-value",style:{fontSize:"18px",fontWeight:600,textAlign:"center",color:"var(--text-normal)"}},"Balance: ",fe(r.balance)),r.isConsolidated&&Ie.default.createElement("div",{style:{marginTop:"8px",padding:"6px 0",borderTop:"1px solid var(--background-modifier-border)",fontSize:"13px"}},r.tradeCount&&r.tradeCount>0&&Ie.default.createElement("div",{style:{marginBottom:"4px"}},Ie.default.createElement("span",{style:{fontWeight:500}},"Trades:")," ",r.tradeCount),r.dailyPnL!==void 0&&Ie.default.createElement("div",{style:{color:r.dailyPnL>=0?"var(--text-success)":"var(--text-error)",fontWeight:500}},"Day P&L: ",fe(r.dailyPnL)),r.hasEvents&&Ie.default.createElement("div",{style:{marginTop:"4px",fontSize:"12px",fontStyle:"italic",color:"var(--text-muted)"}},"Has deposits/withdrawals")),r.transaction&&Ie.default.createElement("div",{style:{marginTop:"8px",padding:"6px 0",borderTop:"1px solid var(--background-modifier-border)",fontSize:"13px"}},r.isDeposit&&Ie.default.createElement("div",{style:{color:"#41B4F7"}},"Deposit: ",fe(r.transaction.amount)),r.isWithdrawal&&Ie.default.createElement("div",{style:{color:"var(--text-warning, gold)"}},"Withdrawal: ",fe(Math.abs(r.transaction.amount))),r.isTrade&&!r.isConsolidated&&Ie.default.createElement("div",{style:{color:r.transaction&&r.transaction.amount>=0?"var(--text-success)":"var(--text-error)"}},ege(r.transaction.description),": ",fe(r.transaction.amount)),r.transaction.description&&!r.isTrade&&Ie.default.createElement("div",{style:{marginTop:"4px",fontSize:"12px",color:"var(--text-muted)",fontStyle:"italic"}},r.transaction.description)),r.drawdownLevel!==void 0&&Ie.default.createElement("div",{style:{marginTop:"6px",fontSize:"13px",color:"var(--text-error)"}},"Drawdown Level: ",fe(r.drawdownLevel)))},iG=({account:e,height:t=250})=>{let r=Ie.default.useMemo(()=>{let c=fr(),d=window.journalitPlugin;if(!e.transactions||e.transactions.length===0)return[];let u=[...e.transactions].sort((k,S)=>new Date(k.date).getTime()-new Date(S.date).getTime()),p=e.initialBalance-e.drawdownAmount,m=[],g=u.filter(k=>(k.type==="deposit"||k.type==="withdrawal")&&!(k.type==="deposit"&&k.description==="Initial deposit")),f=u[0];if(f){let k=new Date(f.date),S=new Date(k.getTime()-864e5);m.push({date:Ze(S,c),rawDate:S,balance:e.initialBalance,...e.drawdownType!=="none"&&{drawdownLevel:p}})}let y=new Map,h=e.initialBalance,v=p;return u.filter(k=>k.type!=="cost").forEach(k=>{let S=new Date(k.date),x=st(S,d),T=`${x.getFullYear()}-${String(x.getMonth()+1).padStart(2,"0")}-${String(x.getDate()).padStart(2,"0")}`;y.has(T)||y.set(T,{dayEnd:x,transactions:[],finalBalance:0,tradeCount:0,dailyPnL:0,hasEvents:!1});let E=y.get(T);E.transactions.push(k),E.finalBalance=k.balanceAfter,k.type==="trade"&&(E.tradeCount++,E.dailyPnL+=k.amount),(k.type==="deposit"||k.type==="withdrawal")&&(E.hasEvents=!0),S>E.dayEnd&&(E.dayEnd=S)}),Array.from(y.keys()).sort().forEach(k=>{let S=y.get(k),x=new Date(S.dayEnd),T=p;if(e.drawdownType==="eod_trailing"){S.finalBalance>h&&(h=S.finalBalance);let E=Math.min(e.initialBalance,Math.max(h-e.drawdownAmount,v));v=E,T=E}m.push({date:Ze(x,c),rawDate:x,balance:S.finalBalance,...e.drawdownType!=="none"&&{drawdownLevel:T},isConsolidated:!0,tradeCount:S.tradeCount,dailyPnL:S.dailyPnL,hasEvents:S.hasEvents,isTrade:S.tradeCount>0})}),g.forEach(k=>{if(k.type==="cost")return;let S=new Date(k.date),x=k.type==="deposit"&&k.amount>0,T=k.type==="withdrawal"||k.type==="deposit"&&k.amount<0,E=st(S,d),C=`${E.getFullYear()}-${String(E.getMonth()+1).padStart(2,"0")}-${String(E.getDate()).padStart(2,"0")}`,N=m.find(A=>!A.isConsolidated||!A.rawDate?!1:`${A.rawDate.getFullYear()}-${String(A.rawDate.getMonth()+1).padStart(2,"0")}-${String(A.rawDate.getDate()).padStart(2,"0")}`===C),D=e.drawdownType!=="none"?(N==null?void 0:N.drawdownLevel)||p:void 0;m.push({date:Ze(S,c),rawDate:S,balance:k.balanceAfter,...e.drawdownType!=="none"&&{drawdownLevel:D},transaction:k,isDeposit:x,isWithdrawal:T})}),m.sort((k,S)=>k.rawDate.getTime()-S.rawDate.getTime())},[e.transactions,e.initialBalance,e.drawdownType,e.drawdownAmount]);if(r.length===0)return Ie.default.createElement("div",{style:{height:`${t}px`,display:"flex",alignItems:"center",justifyContent:"center"}},Ie.default.createElement(Ae,{message:"No transaction history",subMessage:"Add transactions to view account balance history"}));let n=r.map(c=>c.balance),i=Math.min(...n),o=Math.max(...n);if(e.hasProfitTarget&&e.profitTarget>0){let c=e.profitTargetType==="percentage"?e.initialBalance*e.profitTarget/100:e.profitTarget,d=e.initialBalance+c;o=Math.max(o,d)}let a=e.maxDrawdownReached,s=o-Math.min(i,a||i);o=o+s*.05,a!==void 0&&a<i?i=a-s*.15:i=i-s*.1,i>0&&i<o*.05&&(i=0);let l=e.hasProfitTarget&&e.profitTarget>0?e.profitTargetType==="percentage"?e.initialBalance+e.initialBalance*e.profitTarget/100:e.initialBalance+e.profitTarget:void 0;return Ie.default.createElement("div",{className:"account-balance-chart",style:{width:"100%",height:`${t}px`}},Ie.default.createElement(is,{width:"100%",height:"100%"},Ie.default.createElement($v,{data:r,margin:{top:10,right:15,left:10,bottom:5}},Ie.default.createElement("defs",null,Ie.default.createElement("linearGradient",{id:"balanceGradient",x1:"0",y1:"0",x2:"0",y2:"1"},Ie.default.createElement("stop",{offset:"0%",stopColor:"#41B4F7",stopOpacity:.4}),Ie.default.createElement("stop",{offset:"100%",stopColor:"#41B4F7",stopOpacity:.05})),Ie.default.createElement("filter",{id:"balanceShadow",height:"120%"},Ie.default.createElement("feDropShadow",{dx:"0",dy:"1",stdDeviation:"2",floodOpacity:"0.1"})),Ie.default.createElement("linearGradient",{id:"drawdownGradient",x1:"0",y1:"0",x2:"0",y2:"1"},Ie.default.createElement("stop",{offset:"0%",stopColor:"var(--text-error)",stopOpacity:.2}),Ie.default.createElement("stop",{offset:"100%",stopColor:"var(--text-error)",stopOpacity:.5}))),Ie.default.createElement(hi,{strokeDasharray:"3 3",vertical:!1,stroke:"var(--background-modifier-border)",strokeOpacity:.5}),Ie.default.createElement(bn,{dataKey:"date",style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},tickMargin:4,tickLine:!1,axisLine:{stroke:"var(--background-modifier-border)",strokeOpacity:.5}}),Ie.default.createElement(wn,{tickFormatter:c=>fe(c),style:{fontSize:"11px",fontWeight:500,fill:"var(--text-muted)"},domain:[i,o],allowDataOverflow:!1,width:60,tickLine:!1,axisLine:!1,tickMargin:5,ticks:Zfe(i,o,e.initialBalance)}),Ie.default.createElement(Li,{content:Ie.default.createElement(tge,null),cursor:{fill:"var(--interactive-hover)",fillOpacity:.1,strokeOpacity:.3,strokeWidth:1,stroke:"var(--interactive-accent)"},wrapperStyle:{zIndex:1e3},offset:10}),Ie.default.createElement(Hr,{y:0,stroke:"var(--text-normal)",strokeOpacity:.5,strokeDasharray:"3 3",strokeWidth:1}),Ie.default.createElement(Hr,{y:e.initialBalance,stroke:"#888888",strokeOpacity:.7,strokeDasharray:"3 3",strokeWidth:1}),l&&Ie.default.createElement(Hr,{y:l,stroke:"var(--text-success, #00b300)",strokeOpacity:1,strokeDasharray:"5 5",strokeWidth:2,className:"profit-target-line",label:{value:"Profit Target",fill:"var(--text-success, #00b300)",fontSize:12,position:"insideTopRight"}}),Ie.default.createElement(co,{type:"monotone",dataKey:"balance",stroke:"none",fill:"url(#balanceGradient)",fillOpacity:.95,dot:!1,activeDot:!1,filter:"url(#balanceShadow)"}),e.drawdownType!=="none"&&Ie.default.createElement(qs,{type:"stepAfter",dataKey:"drawdownLevel",stroke:"var(--text-error)",strokeWidth:2,strokeDasharray:"5 5",dot:!1,activeDot:!1,name:"Drawdown Level"}),e.drawdownType!=="none"&&Ie.default.createElement(co,{type:"monotone",dataKey:"drawdownLevel",stroke:"none",fill:"url(#drawdownGradient)",fillOpacity:1}),Ie.default.createElement(qs,{type:"monotone",dataKey:"balance",stroke:"#41B4F7",strokeWidth:3,dot:c=>{let{cx:d,cy:u,payload:p}=c;return p?p.isDeposit?Ie.default.createElement("g",null,Ie.default.createElement("line",{x1:d,y1:u-15,x2:d,y2:u+15,stroke:"#41B4F7",strokeWidth:"2"}),Ie.default.createElement("circle",{cx:d,cy:u,r:"5",fill:"var(--background-primary)",stroke:"#41B4F7",strokeWidth:"2"})):p.isWithdrawal?Ie.default.createElement("g",null,Ie.default.createElement("line",{x1:d,y1:u-15,x2:d,y2:u+15,stroke:"var(--text-warning, gold)",strokeWidth:"2"}),Ie.default.createElement("circle",{cx:d,cy:u,r:"5",fill:"var(--background-primary)",stroke:"var(--text-warning, gold)",strokeWidth:"2"})):p.isTrade?p.isConsolidated?Ie.default.createElement("circle",{cx:d,cy:u,r:"4",fill:p.dailyPnL!==void 0&&p.dailyPnL>=0?"var(--text-success)":"var(--text-error)",stroke:"var(--background-primary)",strokeWidth:"1"}):Ie.default.createElement("circle",{cx:d,cy:u,r:"4",fill:p.transaction&&p.transaction.amount>=0?"var(--text-success)":"var(--text-error)",stroke:"var(--background-primary)",strokeWidth:"1"}):Ie.default.createElement("circle",{cx:d,cy:u,r:"3",fill:"var(--text-muted)",stroke:"var(--background-primary)",strokeWidth:"1"}):Ie.default.createElement("circle",{cx:0,cy:0,r:0,opacity:0})},activeDot:c=>{let{cx:d,cy:u,payload:p}=c;if(!p)return Ie.default.createElement("circle",{cx:0,cy:0,r:0,opacity:0});let m="#41B4F7";return p.isTrade?p.isConsolidated?m=p.dailyPnL!==void 0&&p.dailyPnL>=0?"var(--text-success)":"var(--text-error)":p.transaction&&(m=p.transaction.amount>=0?"var(--text-success)":"var(--text-error)"):p.isDeposit?m="#41B4F7":p.isWithdrawal&&(m="var(--text-warning, gold)"),Ie.default.createElement("circle",{cx:d,cy:u,r:"6",fill:m,stroke:"var(--background-primary)",strokeWidth:"2"})},name:"Balance"}))))};var oG=({accountData:e,plugin:t,openNote:r})=>{let[n,i]=(0,ce.useState)(e);(0,ce.useEffect)(()=>{let h=async v=>{let{accountId:b}=v.detail;if(b===n.id){let w=await t.accountService.getAccount(b);w&&i(w)}};return document.addEventListener("journalit:account-updated",h),document.addEventListener("journalit:account-transaction-added",h),document.addEventListener("journalit:account-transaction-deleted",h),()=>{document.removeEventListener("journalit:account-updated",h),document.removeEventListener("journalit:account-transaction-added",h),document.removeEventListener("journalit:account-transaction-deleted",h)}},[n.id,t]);let o=h=>h.split("_").map(v=>v.charAt(0).toUpperCase()+v.slice(1).toLowerCase()).join(" "),a=h=>{switch(h){case"none":return"None";case"fixed":return"Fixed";case"eod_trailing":return"EOD Trailing";default:return"Unknown"}},s=h=>new Date(h).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),l=h=>{switch(h){case"deposit":return"Deposit";case"withdrawal":return"Withdrawal";case"trade":return"Trade";case"cost":return"Monthly Cost";default:return"Unknown"}},c=h=>{if(!h)return"-";if(!h.startsWith("Trade P&L:"))return h;let v=/Trade P&L: .+\/([A-Z0-9]+)-(\d{6})-([^.]+)\.md/,b=h.match(v);if(!b||b.length<4)return h;let[,w,k,S]=b;try{let x="20"+k.substring(0,2),T=k.substring(2,4),E=k.substring(4,6),N=new Date(`${x}-${T}-${E}`).toLocaleDateString("en-US",{month:"short",day:"numeric"});return`${w} ${S} (${N})`}catch(x){return`${w} ${S}`}},d=()=>n.initialBalance===0?0:(n.currentBalance-n.initialBalance)/n.initialBalance*100,u=()=>{if(!n.createdDate)return 0;let h=new Date(n.createdDate),v=new Date,b=v.getFullYear()-h.getFullYear(),w=v.getMonth()-h.getMonth(),k=b*12+w;return Math.max(0,k)},p=()=>n.transactions.filter(v=>v.type==="cost").reduce((v,b)=>v+Math.abs(b.amount),0),m=()=>{if(!n.hasProfitTarget||n.profitTarget<=0)return 0;let h=n.metrics.totalPnL,v=n.profitTargetType==="percentage"?n.initialBalance*n.profitTarget/100:n.profitTarget,b=h/v*100;return Math.min(100,Math.max(0,b))},g=h=>{if(!h.hasProfitTarget)return null;let v=m(),b=v>=100,w=h.profitTargetType==="percentage"?h.initialBalance*h.profitTarget/100:h.profitTarget,k=h.metrics.totalPnL;return ce.default.createElement("div",{className:"profit-target-progress"},ce.default.createElement("div",{className:"progress-container"},ce.default.createElement("div",{className:`progress-bar ${b?"complete":""}`,style:{width:`${v}%`}})))},f=[...n.transactions].sort((h,v)=>new Date(v.date).getTime()-new Date(h.date).getTime()),y=ce.default.useRef(null);return ce.default.useLayoutEffect(()=>{if(y.current){y.current.classList.add("account-note-mounted"),y.current.setAttribute("data-mounted-at",Date.now().toString());let h=y.current.closest(".journalit-account-view");h&&h.classList.add("account-note-mounted")}return()=>{}},[]),ce.default.createElement("div",{className:"journalit-account account-container",ref:y},ce.default.createElement("div",{className:"account-header"},ce.default.createElement("div",{className:"account-name"},n.name),ce.default.createElement("div",{className:"account-type"},o(n.accountType))),ce.default.createElement("div",{className:"account-balance-chart-container"},ce.default.createElement(iG,{account:n,height:250})),ce.default.createElement("div",{className:"account-summary"},ce.default.createElement("div",{className:"account-metric"},ce.default.createElement("div",{className:"metric-label"},"Current Balance"),ce.default.createElement("div",{className:"metric-value"},Wt(n.currentBalance))),ce.default.createElement("div",{className:"account-metric"},ce.default.createElement("div",{className:"metric-label"},"Initial Balance"),ce.default.createElement("div",{className:"metric-value"},Wt(n.initialBalance))),ce.default.createElement("div",{className:"account-metric"},ce.default.createElement("div",{className:"metric-label"},"Growth"),ce.default.createElement("div",{className:"metric-value"},d().toFixed(2),"%")),ce.default.createElement("div",{className:"account-metric"},ce.default.createElement("div",{className:"metric-label"},"Created"),ce.default.createElement("div",{className:"metric-value"},s(n.createdDate)))),ce.default.createElement("div",{className:"account-details"},ce.default.createElement("h3",null,"Account Details"),ce.default.createElement("div",{className:"details-grid"},ce.default.createElement("div",{className:"detail-item"},ce.default.createElement("div",{className:"detail-label"},"Drawdown Type"),ce.default.createElement("div",{className:"detail-value"},a(n.drawdownType))),n.drawdownType!=="none"&&ce.default.createElement(ce.default.Fragment,null,ce.default.createElement("div",{className:"detail-item"},ce.default.createElement("div",{className:"detail-label"},"Drawdown Amount"),ce.default.createElement("div",{className:"detail-value"},Wt(n.drawdownAmount))),ce.default.createElement("div",{className:"detail-item"},ce.default.createElement("div",{className:"detail-label"},"Drawdown Level"),ce.default.createElement("div",{className:"detail-value"},Wt(n.maxDrawdownReached)))),n.hasProfitTarget&&ce.default.createElement("div",{className:"detail-item profit-target-item"},ce.default.createElement("div",{className:"detail-label"},"Profit Target"),ce.default.createElement("div",{className:"detail-value"},n.profitTargetType==="percentage"?`${n.profitTarget.toFixed(2)}% (${Wt(n.initialBalance*n.profitTarget/100)})`:Wt(n.profitTarget),n.profitTargetDate&&ce.default.createElement("span",{className:"target-date"}," by ",s(n.profitTargetDate)),ce.default.createElement("span",{className:"target-progress"}," - ",Wt(n.metrics.totalPnL)," of ",n.profitTargetType==="percentage"?Wt(n.initialBalance*n.profitTarget/100):Wt(n.profitTarget)," (",m().toFixed(1),"%)")),g(n)),n.monthlyCost>0&&ce.default.createElement("div",{className:"detail-item"},ce.default.createElement("div",{className:"detail-label"},"Monthly Cost"),ce.default.createElement("div",{className:"detail-value"},Wt(n.monthlyCost),n.createdDate&&ce.default.createElement("div",{className:"cost-details"},ce.default.createElement("div",{className:"cost-total"},"Total Cost: ",Wt(p())),ce.default.createElement("div",{className:"cost-months"},"(",u()," months since creation)")))))),ce.default.createElement("div",{className:"account-performance"},ce.default.createElement("h3",null,"Performance Metrics"),ce.default.createElement("div",{className:"metrics-grid"},ce.default.createElement("div",{className:"metric-item"},ce.default.createElement("div",{className:"metric-label"},"Total Trades"),ce.default.createElement("div",{className:"metric-value"},n.metrics.totalTrades)),ce.default.createElement("div",{className:"metric-item"},ce.default.createElement("div",{className:"metric-label"},"Win Rate"),ce.default.createElement("div",{className:"metric-value"},n.metrics.winRate.toFixed(2),"%")),ce.default.createElement("div",{className:"metric-item"},ce.default.createElement("div",{className:"metric-label"},"Profit Factor"),ce.default.createElement("div",{className:"metric-value"},n.metrics.profitFactor.toFixed(2))),ce.default.createElement("div",{className:"metric-item"},ce.default.createElement("div",{className:"metric-label"},"Total P&L"),ce.default.createElement("div",{className:"metric-value"},Wt(n.metrics.totalPnL))),ce.default.createElement("div",{className:"metric-item"},ce.default.createElement("div",{className:"metric-label"},"Best Trade"),ce.default.createElement("div",{className:"metric-value"},Wt(n.metrics.bestTrade))),ce.default.createElement("div",{className:"metric-item"},ce.default.createElement("div",{className:"metric-label"},"Worst Trade"),ce.default.createElement("div",{className:"metric-value"},Wt(n.metrics.worstTrade))),ce.default.createElement("div",{className:"metric-item"},ce.default.createElement("div",{className:"metric-label"},"Average Win"),ce.default.createElement("div",{className:"metric-value"},Wt(n.metrics.averageWin))),ce.default.createElement("div",{className:"metric-item"},ce.default.createElement("div",{className:"metric-label"},"Average Loss"),ce.default.createElement("div",{className:"metric-value"},Wt(n.metrics.averageLoss))),ce.default.createElement("div",{className:"metric-item"},ce.default.createElement("div",{className:"metric-label"},"Max Drawdown"),ce.default.createElement("div",{className:"metric-value"},Wt(n.metrics.maxDrawdown))))),ce.default.createElement("div",{className:"account-transactions"},ce.default.createElement("div",{className:"account-transactions-header"},ce.default.createElement("h3",null,"Recent Transactions"),ce.default.createElement("button",{className:"add-transaction-button",onClick:()=>{t.app&&wI(t.app,t,n)}},"Add Transaction")),f.length>0?ce.default.createElement("table",{className:"transactions-table"},ce.default.createElement("thead",null,ce.default.createElement("tr",null,ce.default.createElement("th",null,"Date"),ce.default.createElement("th",null,"Type"),ce.default.createElement("th",null,"Amount"),ce.default.createElement("th",null,"Balance"),ce.default.createElement("th",null,"Description"))),ce.default.createElement("tbody",null,f.map(h=>{let v=h.type==="trade",b=h.type==="deposit",w=h.type==="withdrawal",k=v&&!!h.tradeId,S=v&&k&&r!==void 0,x=b||w;return ce.default.createElement("tr",{key:h.id,className:`transaction-row ${h.type}`,onClick:()=>{S?r(h.tradeId,!0):x&&t.app&&wI(t.app,t,n,h)},style:{cursor:S||x?"pointer":"default"}},ce.default.createElement("td",null,s(h.date)),ce.default.createElement("td",null,l(h.type)),ce.default.createElement("td",{className:h.amount>=0?"positive":"negative"},Wt(h.amount)),ce.default.createElement("td",null,Wt(h.balanceAfter)),ce.default.createElement("td",null,h.type==="trade"?c(h.description):h.description||"-"))}))):ce.default.createElement("div",{className:"empty-transactions"},ce.default.createElement("p",null,"No transactions yet"))))};var Of=class extends Qi{constructor(t){super(t)}async renderComponent(t,r,n,i,o){var a,s;try{if(!t||!t.isConnected){console.error(`[AccountNote] Cannot render into disconnected container for ${n}`);return}if(t.querySelector(".account-container"))return;let c=null;if(r.accountData)try{typeof r.accountData=="string"?c=JSON.parse(r.accountData):c=r.accountData}catch(f){console.error("Error parsing account data:",f)}else r instanceof Object&&"id"in r&&(c=r);if(!c){t.innerHTML='<div class="journalit-error">Account data not found</div>';return}let d=o?`${n}-${i}-${o}`:`${n}-${i}`,u=this.reactRoots.get(d);if(u&&u.domContainer&&u.domContainer.isConnected&&u.domContainer.querySelector(".account-container"))return;t.setAttribute("data-displaying-file",n),t.setAttribute("data-rendered-at",Date.now().toString()),t.setAttribute("data-renderer-id",`${n}-${i}-${Date.now()}`);let p=(s=(a=window.app)==null?void 0:a.plugins)==null?void 0:s.plugins.journalit,m=this.findContainingLeaf(t),g;if(m&&m.view){let f=m.view.containerEl,y=m.containerEl;f&&f.id?g=f.id:y&&y.id&&(g=y.id)}this.createReactRoot(t,d,g,o,c,n)}catch(l){console.error("[AccountNote] Error rendering account note:",l),t.innerHTML="Error rendering account note: "+(l instanceof Error?l.message:String(l))}}getComponentClassName(){return"journalit-account-view"}getWrapperClassName(){return"journalit-account-note-wrapper"}createReactElement(t,r,n){var o,a;let i=(a=(o=window.app)==null?void 0:o.plugins)==null?void 0:a.plugins.journalit;return aG.default.createElement(oG,{accountData:t,plugin:i,openNote:n})}async render(t,r,n){try{await this.renderComponent(t,n,r.path,"legacy-view")}catch(i){console.error("Error rendering account note:",i),t.innerHTML=`<div class="journalit-error">Error rendering account note: ${i.message}</div>`}}unload(t){t.root&&(t.root.unmount(),delete t.root)}};var iT=class extends Zi{constructor(t){super(t.app,t,new Of(t.app))}isValidComponentType(t){return t&&t.type==="account"}getComponentClassName(){return"journalit-account-view"}getWrapperClassName(){return"journalit-account-note-wrapper"}getComponentTypeIdentifier(){return"account"}async getAdditionalDataForComponent(t,r){try{let n=null;if(r.accountData)try{typeof r.accountData=="string"?n=JSON.parse(r.accountData):n=r.accountData}catch(o){console.error("Error parsing account data:",o)}let i=this.plugin;return!n&&r.name&&i.accountService&&(n=await i.accountService.getAccountByName(r.name)),n}catch(n){return console.error("Error getting additional account data:",n),null}}async handleFileOpen(t,r=!1){if(!t)return;this.cleanupOrphanedComponents(),this.cleanupUnrelatedComponents(t.path);let n=this.app.metadataCache.getFileCache(t),i=n==null?void 0:n.frontmatter;if(!i||!this.isValidComponentType(i))return;if(this.hasProperlyRenderedComponents(t.path,this.getComponentClassName(),".account-container","account-note-mounted")){this.markFileRenderedInMode(t.path,"source");return}let o=document.body,a=new MutationObserver((s,l)=>{let c=document.querySelectorAll(".cm-editor");if(c.length===0)return;if(this.isFileRenderedInMode(t.path,"source")){if(document.querySelectorAll(`.${this.getComponentClassName()}[data-file-path="${t.path}"]`).length>0)return;this.clearFileRenderedStatus(t.path,"source")}c.forEach(u=>{var T;let p=u.querySelector(".metadata-container");if(!p)return;let m=p.closest(".workspace-leaf-content");if(!m)return;let g=this.findContainingLeaf(m),f=(T=g==null?void 0:g.view)==null?void 0:T.containerEl,y=p.closest(".workspace-leaf"),v=(y==null?void 0:y.id)||(f==null?void 0:f.id)||null,b=this.getUniqueElementId(u),w=v?`leaf-${v}`:b,k=!0;if(g){let E=g.view,C=null;(E&&"file"in E||E&&"getViewType"in E&&E.getViewType()==="markdown")&&(C=E.file),C&&(k=C.path===t.path)}if(!k)return;let S=this.getComponentClassName();u.querySelectorAll(`.${S}`).forEach(E=>{let C=E.getAttribute("data-file-path");if(C){let N=E.getAttribute("data-view-id"),D=E.getAttribute("data-leaf-id");N&&this.renderer.unmountComponent(C,N,D||void 0),E.remove()}});let x=document.createElement("div");x.className=this.getComponentClassName(),x.style.marginTop="20px",x.style.marginBottom="20px",x.style.padding="10px",x.setAttribute("data-file-path",t.path),x.setAttribute("data-view-id",w),x.setAttribute("data-editor-id",b),v&&x.setAttribute("data-leaf-id",v),x.setAttribute("data-inserted-at",Date.now().toString()),p.after(x),this.renderAccountNoteWithDeduplication(t,x,i,w,b)}),l.disconnect();let d=this.activeObservers.indexOf(l);d>-1&&this.activeObservers.splice(d,1)});this.activeObservers.push(a),a.observe(o,{childList:!0,subtree:!0}),setTimeout(()=>{a.disconnect();let s=this.activeObservers.indexOf(a);s>-1&&this.activeObservers.splice(s,1)},5e3)}renderAccountNoteWithDeduplication(t,r,n,i,o){return this.renderWithDeduplication({file:t,container:r,data:n,viewId:i,contextId:o,componentClassName:this.getComponentClassName(),mountedClassName:"account-note-mounted",contentSelector:".account-container"})}renderActiveComponent(){this.cleanupOrphanedComponents();let t=this.app.workspace.getActiveFile();if(!t)return;let r=this.app.metadataCache.getFileCache(t),n=r==null?void 0:r.frontmatter;if(!n||n.type!=="account"||this.hasProperlyRenderedComponents(t.path,this.getComponentClassName(),".account-container","account-note-mounted"))return;this.cleanupDuplicateComponents(t.path);let i=this.app.workspace.getActiveViewOfType(sG.MarkdownView);if(!i)return;let o=i.getMode,a=typeof o=="function"?o.call(i)==="source":!1,s=null;if(a){let l=i.containerEl.querySelector(".metadata-container");if(!l)return;let c=Array.from(i.containerEl.querySelectorAll(`.${this.getComponentClassName()}`)).find(d=>d.getAttribute("data-file-path")===t.path);c?s=c:(s=document.createElement("div"),s.className=this.getComponentClassName(),s.style.marginTop="20px",s.style.marginBottom="20px",s.style.padding="10px",s.setAttribute("data-file-path",t.path),l.after(s))}else{let l=i.containerEl.querySelector(".markdown-preview-view");if(!l)return;let c=Array.from(l.querySelectorAll(`.${this.getComponentClassName()}`)).find(d=>d.getAttribute("data-file-path")===t.path);c?s=c:(s=document.createElement("div"),s.className=this.getComponentClassName(),s.style.marginTop="20px",s.style.marginBottom="20px",s.style.padding="10px",s.setAttribute("data-file-path",t.path),l.prepend(s))}if(s){let l=`account-active-${Date.now()}`;s.setAttribute("data-view-id",l),s.setAttribute("data-inserted-at",Date.now().toString()),this.renderAccountNoteWithDeduplication(t,s,n,l)}}isValidForFile(t,r){return this.isValidComponentType(r)}async process(t,r,n,i){try{let o=await this.getAdditionalDataForComponent(n,i);if(!o){t.innerHTML='<div class="journalit-error">Account data not found</div>';return}await this.renderer.renderComponent(t,o,n.path,"legacy-view")}catch(o){console.error("Error processing account note:",o),t.innerHTML=`<div class="journalit-error">Error processing account note: ${o.message}</div>`}}};window&&(document.querySelectorAll("script").forEach(t=>{let r=t.textContent||"";(r.includes("DROPDOWN_FIX")||r.includes("COMBOBOX")||r.includes("TRADEFORM"))&&t.remove()}),window.__dropdownClickHandlerAdded=!1,window.__isHandlingComboBoxRemove=!1,window.__isInjectingStyles=!1);var $f=class $f extends ct.Plugin{constructor(){super(...arguments);this.backendIntegrationService=null;this.tradeNoteProcessor=null;this.drcNoteProcessor=null;this.weeklyReviewProcessor=null}async onload(){let r=Date.now();window.__obsidianStartTime=r,console.log("Loading Journalit plugin - starting initialization"),window.journalitPlugin=this,window.JournalitPlugin=$f,$f.instance=this,await this.loadSettings(),this.lastFileOpenTime=Date.now(),Po(!1,!1,!0,!0),tz(),this.serviceManager=Tc.getInstance(this.app,this),this.processorManager=oS.getInstance(this.app,this),this.viewManager=nT.getInstance(this),i_(this),await Promise.resolve().then(()=>{this.serviceManager.initializeCoreServices(),this.authManager=this.serviceManager.getAuthManager(),this.tradeService=this.serviceManager.getTradeService()}),await Promise.resolve().then(()=>{this.addSettingTab(new Xb(this.app,this))}),this.registerEvent(this.app.workspace.on("file-open",n=>{this.lastFileOpenTime=Date.now()})),await Promise.resolve().then(()=>{this.registerAuthCommands()}),await Promise.resolve().then(()=>{this.viewManager.registerDashboardView()}),setTimeout(()=>{this.viewManager.registerTradeFormView()},10),setTimeout(()=>{this.viewManager.registerAccountDashboardView()},20),setTimeout(()=>{this.viewManager.registerTradeLogView()},30),this.app.workspace.onLayoutReady(()=>{this.initializeNonCriticalComponents()})}async initializeNonCriticalComponents(){var n,i;let r=Date.now();try{rz();try{this.serviceManager.preInitializeServices(["onboardingService"]),(n=window.requestIdleCallback)==null||n.call(window,()=>{this.checkAndShowOnboarding()}),(i=window.requestIdleCallback)==null||i.call(window,()=>{Promise.resolve().then(()=>(lT(),sT)).then(()=>console.log("[Journalit] Pre-loaded OnboardingWizardModalWrapper")).catch(()=>{})})}catch(o){console.warn("[Journalit] Failed to warm-up onboarding modules:",o)}await oh([()=>{this.registerRemainingCommands(),this.addRibbonIcons()},async()=>{await this.processorManager.initializeRequiredProcessors(),this.processorManager.registerProcessor("account",new iT(this)),this.processorManager.registerRenderer("account",new Of(this.app)),this.processorManager.registerProcessor("missed-trade",new Rp(this.app,this)),this.processorManager.registerRenderer("missed-trade",new $p(this.app));let o=this.processorManager.getAllInitializedProcessors();this.tradeNoteProcessor=o.tradeNoteProcessor,this.drcNoteProcessor=o.drcNoteProcessor,this.weeklyReviewProcessor=o.weeklyReviewProcessor},async()=>{try{this.setupService=await this.serviceManager.getSetupService(),this.drcService=await this.serviceManager.getDRCService()}catch(o){console.error("Error initializing high-priority services:",o)}},async()=>{try{this.weeklyReviewService=await this.serviceManager.getWeeklyReviewService(),this.monthlyReviewService=await this.serviceManager.getMonthlyReviewService(),this.missedTradeService=await this.serviceManager.getMissedTradeService(),this.optionsService=await this.serviceManager.getOptionsService(),wl.getInstance().initialize()}catch(o){console.error("Error initializing secondary services:",o)}},async()=>{try{this.accountService=await this.serviceManager.getAccountService(),this.accountTransactionService=await this.serviceManager.getAccountTransactionService()}catch(o){console.error("Error initializing background services:",o)}},async()=>{await this.viewManager.registerAllViews()},async()=>{await this.handleInitialFileRendering()},async()=>{var o;try{if(this.accountService){let a=await this.accountService.checkAllAccountsForBilling()}}catch(a){console.error("Error checking accounts for monthly billing:",a)}try{if((o=this.settings.backendIntegration)!=null&&o.syncEnabled){let a=await this.serviceManager.getBackendIntegrationService();this.backendIntegrationService=a,await a.registerVault()}}catch(a){console.error("Error initializing backend integration:",a)}}],30)}catch(o){console.error("Error during non-critical initialization:",o)}this.initializeDynamicLinkMaintenance(),console.log("Journalit plugin initialized successfully")}async handleInitialFileRendering(){let r=this.app.workspace.getActiveFile();if(!r)return;let n=this.app.metadataCache.getFileCache(r),i=n==null?void 0:n.frontmatter;if(i&&(i.type==="drc"&&(this.drcNoteProcessor||(this.drcNoteProcessor=await this.processorManager.getDRCNoteProcessor())),i.type==="trade"&&(this.tradeNoteProcessor||(this.tradeNoteProcessor=await this.processorManager.getTradeNoteProcessor())),i.type==="weekly-review")){let o=document.querySelectorAll(`.journalit-weekly-review-view[data-file-path="${r.path}"]`);if(o.length>0&&Array.from(o).some(s=>s.querySelector(".weekly-review-container")))return;this.weeklyReviewProcessor||(this.weeklyReviewProcessor=await this.processorManager.getWeeklyReviewProcessor()),this.weeklyReviewProcessor&&(await this.weeklyReviewProcessor.renderActiveWeeklyReview(),this.weeklyReviewProcessor.registerCurrentLeaves())}}registerAuthCommands(){this.addCommand({id:"journalit-login",name:"Sign In",callback:()=>{this.authManager.authenticate()}}),this.addCommand({id:"journalit-logout",name:"Sign Out",callback:()=>{this.authManager.logout()}}),this.addCommand({id:"journalit-patch-clear-sync-cache",name:"\u{1F527} PATCH: Clear Sync Cache",callback:async()=>{try{if(this.settings.backendIntegration){let r=this.settings.backendIntegration.userId,n=this.settings.backendIntegration.ftpUsername,i=this.settings.backendIntegration.ftpUserId;this.settings.backendIntegration.ftpUsername=void 0,this.settings.backendIntegration.ftpUserId=void 0,this.settings.backendIntegration.ftpPassword=void 0,this.settings.backendIntegration.userId="",this.settings.backendIntegration.lastSyncTime=void 0,this.settings.backendIntegration.syncCount=void 0,this.settings.backendIntegration.tradeSyncMapping=void 0,this.settings.backendIntegration.accountMapping=void 0,await this.saveSettings(),new ct.Notice(`\u{1F527} PATCH: Sync cache cleared successfully!

Cleared:
- FTP Username: ${n}
- FTP User ID: ${i}
- User ID: ${r} \u2192 (reset to auto-detect)
- Trade sync mappings
- Account mappings

All other settings preserved. You can now regenerate FTP credentials.`,8e3),console.log("\u{1F527} PATCH: Sync cache cleared:",{clearedFtpUsername:n,clearedFtpUserId:i,clearedUserId:r,newUserId:this.settings.backendIntegration.userId})}else new ct.Notice("No backend integration settings found to clear.",3e3)}catch(r){console.error("Error clearing sync cache:",r),new ct.Notice("Failed to clear sync cache: "+(r instanceof Error?r.message:String(r)),5e3)}}})}registerRemainingCommands(){this.addCommand({id:"journalit-add-trade",name:"Add New Trade",callback:async()=>{await this.viewManager.openTradeFormView()}}),this.addCommand({id:"journalit-create-drc",name:"Create Daily Report Card",callback:async()=>{try{let n=await(await this.serviceManager.getDRCService()).getTodayDRC();await this.openFile(n,!0)}catch(r){console.error("Failed to create DRC:",r),new ct.Notice("Failed to create Daily Report Card: "+(r instanceof Error?r.message:String(r)))}}}),this.addCommand({id:"journalit-create-weekly-review",name:"Create Weekly Review",callback:async()=>{try{await(await this.serviceManager.getWeeklyReviewService()).openWeeklyReview(new Date)}catch(r){console.error("Failed to create Weekly Review:",r),new ct.Notice("Failed to create Weekly Review: "+(r instanceof Error?r.message:String(r)))}}}),this.addCommand({id:"journalit-create-monthly-review",name:"Create Monthly Review",callback:async()=>{try{let n=await(await this.serviceManager.getMonthlyReviewService()).createMonthlyReview(new Date);n?await this.openFile(n.path,!0):new ct.Notice("Failed to create Monthly Review")}catch(r){console.error("Failed to create Monthly Review:",r),new ct.Notice("Failed to create Monthly Review: "+(r instanceof Error?r.message:String(r)))}}}),this.addCommand({id:"journalit-open-monthly-review",name:"Open Monthly Review",callback:async()=>{try{let r=await this.serviceManager.getMonthlyReviewService(),n=new Date,i=r.getMonthlyReviewPath(n);if(this.app.vault.getAbstractFileByPath(i))await this.openFile(i,!0);else{let a=await r.createMonthlyReview(n);a&&await this.openFile(a.path,!0)}}catch(r){console.error("Failed to open Monthly Review:",r),new ct.Notice("Failed to open Monthly Review: "+(r instanceof Error?r.message:String(r)))}}}),this.addCommand({id:"journalit-open-dashboard",name:"Open Trading Dashboard",callback:async()=>{await this.viewManager.openDashboardView()}}),this.addCommand({id:"journalit-open-account-dashboard",name:"Open Account Dashboard",callback:async()=>{await this.openAccountDashboard()}}),this.addCommand({id:"journalit-open-trade-log",name:"Open Trade Log",callback:async()=>{await this.viewManager.openTradeLogView()}}),this.addCommand({id:"journalit-create-account",name:"Create New Account",callback:async()=>{new ct.Notice("This feature is coming soon.")}}),this.addCommand({id:"journalit-force-sync",name:"Force Sync Trades",callback:async()=>{try{let n=await(await this.serviceManager.getBackendIntegrationService()).forceSync()}catch(r){console.error("Failed to force sync trades:",r),new ct.Notice("Failed to sync trades: "+(r instanceof Error?r.message:String(r)))}}}),this.addCommand({id:"journalit-replay-onboarding",name:"Replay Onboarding Flow",callback:async()=>{try{let r=await this.serviceManager.getOnboardingService();await r.startOnboarding();let{OnboardingWizardModalWrapper:n}=await Promise.resolve().then(()=>(lT(),sT));new n(this.app,this,async()=>{},async()=>{await r.skipOnboarding()},void 0,void 0,r).open()}catch(r){console.error("Failed to launch onboarding flow:",r),new ct.Notice("Failed to open onboarding flow. Check console for details.")}}}),this.addCommand({id:"journalit-migrate-tags-and-links",name:"Migrate Tags and Add Backlinks",callback:async()=>{try{await this.migrateTagsAndLinks()}catch(r){console.error("Failed to migrate tags and links:",r),new ct.Notice("Failed to migrate tags and links: "+(r instanceof Error?r.message:String(r)))}}}),this.addCommand({id:"journalit-migrate-old-notes",name:"Migrate Old Trade Notes Format",callback:async()=>{try{let{MigrationModal:r}=await Promise.resolve().then(()=>(DG(),EG));new r(this.app,this).open()}catch(r){console.error("Failed to open migration modal:",r),new ct.Notice("Failed to open migration modal: "+(r instanceof Error?r.message:String(r)))}}})}addRibbonIcons(){this.addRibbonIcon("receipt-text","Add Trade",async()=>{await this.viewManager.openTradeFormView()}),this.addRibbonIcon("calendar-check","Create Daily Report Card",async()=>{try{let n=await(await this.serviceManager.getDRCService()).getTodayDRC();await this.openFile(n,!0)}catch(r){console.error("Failed to create DRC from ribbon:",r),new ct.Notice("Failed to create Daily Report Card: "+(r instanceof Error?r.message:String(r)))}}),this.addRibbonIcon("calendar-days","Create Weekly Review",async()=>{try{await(await this.serviceManager.getWeeklyReviewService()).openWeeklyReview(new Date)}catch(r){console.error("Failed to create Weekly Review from ribbon:",r),new ct.Notice("Failed to create Weekly Review: "+(r instanceof Error?r.message:String(r)))}}),this.addRibbonIcon("calendar-range","Open Monthly Review",async()=>{try{let r=await this.serviceManager.getMonthlyReviewService(),n=new Date,i=r.getMonthlyReviewPath(n);if(this.app.vault.getAbstractFileByPath(i))await this.openFile(i,!0);else{let a=await r.createMonthlyReview(n);a&&await this.openFile(a.path,!0)}}catch(r){console.error("Failed to open Monthly Review from ribbon:",r),new ct.Notice("Failed to open Monthly Review: "+(r instanceof Error?r.message:String(r)))}}),this.addRibbonIcon("grip","Open Trading Dashboard",async()=>{await this.viewManager.openDashboardView()}),this.addRibbonIcon("users","Open Account Dashboard",async()=>{await this.openAccountDashboard()}),this.addRibbonIcon("folder-tree","Open Trade Log",async()=>{await this.viewManager.openTradeLogView()})}onunload(){window.__dropdownClickHandlerAdded=!1,window.__isHandlingComboBoxRemove=!1,window.__isInjectingStyles=!1,window.__JOURNALIT_INJECT_DRC_STYLES=void 0,window.__obsidianStartTime=void 0;try{this.viewManager?this.viewManager.cleanupViews():(this.app.workspace.getLeavesOfType(Ir).forEach(n=>{n.detach()}),this.app.workspace.getLeavesOfType(Ia).forEach(n=>{n.detach()}))}catch(n){console.error("Error detaching view leaves:",n)}try{this.processorManager?this.processorManager.cleanupProcessors():(this.tradeNoteProcessor&&this.tradeNoteProcessor.cleanup(),this.drcNoteProcessor&&this.drcNoteProcessor.cleanup(),this.weeklyReviewProcessor&&this.weeklyReviewProcessor.cleanup())}catch(n){console.error("Error cleaning up processors:",n)}this.tradeNoteProcessor=null,this.drcNoteProcessor=null,this.weeklyReviewProcessor=null;try{wl.getInstance().cleanup()}catch(n){console.error("Error cleaning up GlobalPasteManager:",n)}try{Po(!1,!1,!1,!1,!1,!1,!1,!1)}catch(n){console.error("Error during style cleanup:",n)}[".journalit-trade-view",".journalit-trade-note-wrapper",".journalit-drc-view",".journalit-drc-note-wrapper",".weekly-review-wrapper",".journalit-weekly-review-view",".weekly-review"].forEach(n=>{try{document.querySelectorAll(n).forEach(o=>{try{n===".weekly-review"&&typeof o.empty=="function"&&o.empty(),o.remove()}catch(a){console.error(`Error removing element ${n}:`,a)}})}catch(i){console.error(`Error processing selector ${n}:`,i)}}),window.journalitPlugin=void 0,window.JournalitPlugin=void 0,$f.instance=null,this.serviceManager?this.serviceManager.cleanupServices():(this.authManager=null,this.tradeService=null,this.setupService=null,this.drcService=null,this.weeklyReviewService=null,this.monthlyReviewService=null,this.optionsService=null,this.accountService=null,this.accountTransactionService=null,this.backendIntegrationService=null),this.backendIntegrationService=null}async loadSettings(){let r=await this.loadData();this.settings=this.deepMergeSettings(ni,r||{})}deepMergeSettings(r,n){var o,a,s,l,c,d,u,p;let i={...r};return n&&(n.trade&&(i.trade={...r.trade,...n.trade},i.trade.skipWeekends===void 0&&(i.trade.skipWeekends=!0)),n.drc&&(i.drc={...r.drc,...n.drc,checklistItems:n.drc.checklistItems||r.drc.checklistItems,reviewQuestions:n.drc.reviewQuestions||r.drc.reviewQuestions}),n.customOptions?i.customOptions={...r.customOptions,...n.customOptions}:n.customOptions!==void 0&&(i.customOptions={...r.customOptions,...n.customOptions}),n.weekly&&(i.weekly={...r.weekly,...n.weekly,reviewQuestions:n.weekly.reviewQuestions||r.weekly.reviewQuestions}),n.dashboard&&(i.dashboard={...r.dashboard,layouts:{...((o=r.dashboard)==null?void 0:o.layouts)||{},...n.dashboard.layouts||{}},activeLayout:n.dashboard.activeLayout||((a=r.dashboard)==null?void 0:a.activeLayout),defaultFilters:{...((s=r.dashboard)==null?void 0:s.defaultFilters)||{},...n.dashboard.defaultFilters||{}},lastUsedFilters:n.dashboard.lastUsedFilters||((l=r.dashboard)==null?void 0:l.lastUsedFilters)},!i.dashboard.layouts.Default&&((d=(c=r.dashboard)==null?void 0:c.layouts)!=null&&d.Default)&&(i.dashboard.layouts.Default=r.dashboard.layouts.Default),i.dashboard.activeLayout&&!i.dashboard.layouts[i.dashboard.activeLayout]&&(console.warn("Active layout not found in saved layouts, resetting to Default"),i.dashboard.activeLayout="Default")),n.account&&(i.account={...r.account,...n.account,excludedAccountTypes:n.account.excludedAccountTypes||((u=r.account)==null?void 0:u.excludedAccountTypes),includeWithdrawalsFromExcluded:n.account.includeWithdrawalsFromExcluded||((p=r.account)==null?void 0:p.includeWithdrawalsFromExcluded)}),n.backendIntegration&&(i.backendIntegration={...r.backendIntegration,...n.backendIntegration}),n.uiCustomization&&(i.uiCustomization={...r.uiCustomization,...n.uiCustomization}),n.reviews&&(i.reviews={...r.reviews,...n.reviews}),n.general&&(i.general={...r.general,...n.general})),i}async openAccountDashboard(){try{await this.viewManager.openAccountDashboardView()}catch(r){console.error("Error opening account dashboard:",r),new ct.Notice("Failed to open account dashboard: "+(r instanceof Error?r.message:String(r)))}}async migrateTagsAndLinks(){let r=Date.now(),n=0,i=0,o=0,a=0;try{new ct.Notice("Starting comprehensive tags and links migration...");let s=this.app.vault.getMarkdownFiles(),l=s.filter(g=>g.path.includes("/trades/")&&g.name.includes("-T")),c=s.filter(g=>g.path.includes("/DRC")||g.basename.includes("DRC")),d=s.filter(g=>g.basename.match(/^W\d{2}-Review$/)),u=s.filter(g=>g.basename.match(/^\d{2}-Review$/));if(l.length>0&&(new ct.Notice("Migrating trade note tags..."),await this.migrateTradeTags()),l.length>0){new ct.Notice(`Adding parent backlinks to ${l.length} trade notes...`);for(let g of l)try{n++;let f=await Kt.detectNoteType(g,this.app.vault);if(f.type==="trade"&&f.date){let y=await this.app.vault.read(g),h=Kt.removeLinksSection(y),v=await gE(f.date,this),b=Kt.updateLinksSection(h,v);b!==y&&(await this.app.vault.modify(g,b),o++)}}catch(f){console.error(`[Migration] Error processing trade file ${g.path}:`,f),a++}}if(c.length>0){new ct.Notice("Migrating DRC note tags and backlinks...");for(let g of c)try{n++;let f=await Kt.detectNoteType(g,this.app.vault);if(f.type==="drc"&&f.date){let y=this.app.metadataCache.getFileCache(g);if(y==null?void 0:y.frontmatter){let x=(await this.serviceManager.getDRCService()).generateDRCTags(f.date);await this.app.fileManager.processFrontMatter(g,T=>{T.tags&&Array.isArray(T.tags)&&T.tags.length>0&&!T.ctags&&(T.ctags=[...T.tags]),T.tags=x}),i++}let v=await this.app.vault.read(g),b=Kt.removeLinksSection(v),w=await jp(f.date,this),k=Kt.updateLinksSection(b,w);k!==v&&(await this.app.vault.modify(g,k),o++)}}catch(f){console.error(`Error processing DRC file ${g.path}:`,f),a++}}if(d.length>0){new ct.Notice("Migrating weekly note tags and backlinks...");for(let g of d)try{n++;let f=await Kt.detectNoteType(g,this.app.vault);if(f.type==="weekly"&&f.date){let y=this.app.metadataCache.getFileCache(g);if(y==null?void 0:y.frontmatter){let x=(await this.serviceManager.getWeeklyReviewService()).generateWeeklyReviewTags(f.date);await this.app.fileManager.processFrontMatter(g,T=>{T.tags&&Array.isArray(T.tags)&&T.tags.length>0&&!T.ctags&&(T.ctags=[...T.tags]),T.tags=x}),i++}let v=await this.app.vault.read(g),b=Kt.removeLinksSection(v),w=await hE(f.date,this),k=Kt.updateLinksSection(b,w);k!==v&&(await this.app.vault.modify(g,k),o++)}}catch(f){console.error(`Error processing weekly file ${g.path}:`,f),a++}}if(u.length>0){new ct.Notice("Migrating monthly note tags and cleaning up links...");for(let g of u)try{n++;let f=await Kt.detectNoteType(g,this.app.vault);if(f.type==="monthly"&&f.date){let y=this.app.metadataCache.getFileCache(g);if(y==null?void 0:y.frontmatter){let k=(await this.serviceManager.getMonthlyReviewService()).generateMonthlyReviewTags(f.date.getFullYear(),f.date.getMonth()+1);await this.app.fileManager.processFrontMatter(g,S=>{S.tags&&Array.isArray(S.tags)&&S.tags.length>0&&!S.ctags&&(S.ctags=[...S.tags]),S.tags=k}),i++}let v=await this.app.vault.read(g),b=Kt.removeLinksSection(v);b!==v&&(await this.app.vault.modify(g,b),o++)}}catch(f){console.error(`Error processing monthly file ${g.path}:`,f),a++}}let p=Date.now()-r,m=`Migration completed in ${p}ms. Processed: ${n}, Migrated: ${i}, Links added: ${o}, Errors: ${a}`;new ct.Notice(m),console.log("Comprehensive migration results:",{processed:n,migrated:i,linksAdded:o,errors:a,duration:p})}catch(s){console.error("Comprehensive migration failed:",s),new ct.Notice("Migration failed: "+(s instanceof Error?s.message:String(s)))}}async migrateTradeTags(){let r=Date.now(),n=0,i=0,o=0,a=0,s=0;try{new ct.Notice("Starting tag migration...");let l=this.app.vault.getMarkdownFiles().filter(u=>u.path.includes("/trades/")&&u.name.includes("-T"));for(let u of l)try{n++;let p=this.app.metadataCache.getFileCache(u),m=p==null?void 0:p.frontmatter;if(!m){a++;continue}let g=m.tags&&Array.isArray(m.tags)&&m.tags.length>0,f=m.ctags&&Array.isArray(m.ctags)&&m.ctags.length>0,y=!g,h=[];if(h.push([aw()]),m.instrument&&h.push([m.instrument.trim()]),m.assetType&&h.push([Op(m.assetType)]),m.direction&&h.push([Mp(m.direction)]),m.exchange&&h.push([m.exchange.toLowerCase()]),m.setup&&Array.isArray(m.setup)&&m.setup.length>0){let b=Ap(m.setup);b.length>0&&h.push(b)}if(m.mistake&&Array.isArray(m.mistake)&&m.mistake.length>0){let b=Np(m.mistake);b.length>0&&h.push(b)}if(m.account&&Array.isArray(m.account)&&m.account.length>0){let b=m.account.filter(w=>w==null?void 0:w.trim()).map(w=>`account/${No(w.trim())}`);b.length>0&&h.push(b)}if(m.entryTime){let b=new Date(m.entryTime);if(!isNaN(b.getTime())){let w=ua(b);w.length>0&&h.push(w)}}let v=pa(...h);await this.app.fileManager.processFrontMatter(u,b=>{g&&!f&&(b.ctags=Array.isArray(m.tags)?[...m.tags]:[m.tags]),b.tags=v}),y&&s++,g&&i++}catch(p){console.error(`Failed to migrate ${u.path}:`,p),o++}let c=Math.round((Date.now()-r)/1e3),d=`Tag migration completed!
Processed: ${n} files
Migrated: ${i} files
Added auto tags only: ${s} files
Skipped (no frontmatter): ${a}
Errors: ${o}
Time: ${c}s`;new ct.Notice(d),console.log("Tag migration results:",{processed:n,migrated:i,autoOnlyAdded:s,skippedNoFrontmatter:a,errors:o,duration:c})}catch(l){console.error("Tag migration failed:",l),new ct.Notice("Tag migration failed: "+(l instanceof Error?l.message:String(l)))}}initializeDynamicLinkMaintenance(){this.registerEvent(this.app.vault.on("create",r=>{r instanceof ct.TFile&&r.extension==="md"&&this.handleFileCreated(r)})),this.registerEvent(this.app.vault.on("rename",(r,n)=>{r instanceof ct.TFile&&r.extension==="md"&&this.handleFileRenamed(r,n)})),this.registerEvent(this.app.vault.on("delete",r=>{r instanceof ct.TFile&&r.extension==="md"&&this.handleFileDeleted(r)}))}async handleFileCreated(r){try{if(await new Promise(i=>setTimeout(i,100)),!this.app.vault.getAbstractFileByPath(r.path))return;let n=await Kt.detectNoteType(r,this.app.vault);if(n.type==="trade"&&n.date){let i=await gE(n.date,this),o=await this.app.vault.read(r),a=Kt.updateLinksSection(o,i);if(a!==o)try{await this.app.vault.modify(r,a)}catch(s){console.error(`[FileHandler] Failed to modify trade file ${r.basename}:`,s),setTimeout(async()=>{try{let l=await this.app.vault.read(r),c=Kt.updateLinksSection(l,i);c!==l&&await this.app.vault.modify(r,c)}catch(l){console.error(`[FileHandler] Final retry failed for trade file ${r.basename}:`,l)}},500)}}else if(n.type==="drc"&&n.date){let i=await jp(n.date,this),o=await this.app.vault.read(r),a=Kt.updateLinksSection(o,i);if(a!==o)try{await this.app.vault.modify(r,a)}catch(s){console.error(`[FileHandler] Failed to modify DRC file ${r.basename}:`,s)}}else if(n.type==="weekly"&&n.date){let i=await hE(n.date,this),o=await this.app.vault.read(r),a=Kt.updateLinksSection(o,i);if(a!==o)try{await this.app.vault.modify(r,a)}catch(s){console.error(`[FileHandler] Failed to modify weekly file ${r.basename}:`,s)}}else if(n.type==="monthly"&&n.date){let i=await this.app.vault.read(r),o=Kt.removeLinksSection(i);if(o!==i)try{await this.app.vault.modify(r,o)}catch(a){console.error(`[FileHandler] Failed to modify monthly file ${r.basename}:`,a)}}}catch(n){console.error(`[FileHandler] Error handling file creation for ${r.path}:`,n)}}async handleFileRenamed(r,n){try{console.log(`File renamed from ${n} to ${r.path}`)}catch(i){console.error(`Error handling file rename from ${n} to ${r.path}:`,i)}}async handleFileDeleted(r){try{console.log(`File deleted: ${r.path}`)}catch(n){console.error(`Error handling file deletion for ${r.path}:`,n)}}async saveSettings(){try{this.settings.weekly||(this.settings.weekly=ni.weekly),this.settings.dashboard||(this.settings.dashboard=ni.dashboard),(!this.settings.dashboard.layouts||Object.keys(this.settings.dashboard.layouts).length===0)&&(this.settings.dashboard.layouts=ni.dashboard.layouts),this.settings.dashboard.layouts.Default||(this.settings.dashboard.layouts.Default=ni.dashboard.layouts.Default),(!this.settings.dashboard.activeLayout||!this.settings.dashboard.layouts[this.settings.dashboard.activeLayout])&&(this.settings.dashboard.activeLayout="Default"),this.settings.backendIntegration||(this.settings.backendIntegration=ni.backendIntegration),await this.saveData(this.settings)}catch(r){console.error("Error saving settings:",r),await this.saveData(this.settings)}}async openTradeFormInEditMode(r,n){try{let i=this.app.workspace.getLeavesOfType(Ir);for(let l of i)try{l.detach()}catch(c){console.error("Error detaching existing trade form:",c)}await new Promise(l=>setTimeout(l,50));let o=this.app.workspace.getRightLeaf(!1);if(!o)throw new Error("Failed to create leaf for trade form");let a={...r,filePath:n};await o.setViewState({type:Ir,active:!0,state:{isEditMode:!0,initialData:a,filePath:n}}),this.app.workspace.revealLeaf(o);let s=o.view;s?(s.setEditMode(!0),s.setInitialData(a||{}),s.setFilePath(n||"")):console.error("View not properly initialized - missing TradeFormView instance")}catch(i){console.error("Failed to open trade form in edit mode:",i),new ct.Notice("Failed to open trade form in edit mode: "+(i instanceof Error?i.message:String(i)))}}async openFile(r,n=!0){try{let i=this.app.vault.getAbstractFileByPath(r);i instanceof ct.TFile?await(n?this.app.workspace.getLeaf("tab"):this.app.workspace.getLeaf()).openFile(i):console.error(`Could not open file: ${r} - File not found or not a valid file`)}catch(i){console.error(`Error opening file: ${r}`,i)}}async checkAndShowOnboarding(){try{let r=`journalit-onboarding-ever-shown-${this.app.vault.getName()}`;if(localStorage.getItem(r)){console.log("[Journalit] Onboarding has been shown before, skipping automatic display");return}let i=await this.serviceManager.getOnboardingService();if(i.shouldShowOnboarding()){localStorage.setItem(r,"true"),console.log("[Journalit] First-time onboarding triggered"),await i.startOnboarding();let{OnboardingWizardModalWrapper:o}=await Promise.resolve().then(()=>(lT(),sT));new o(this.app,this,async()=>{},async()=>{await i.skipOnboarding()},void 0,void 0,i).open()}}catch(r){console.error("Error checking/showing onboarding:",r)}}};$f.instance=null;var dT=$f;
/*! Bundled license information:

react/cjs/react.production.min.js:
  (**
   * @license React
   * react.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

scheduler/cjs/scheduler.production.min.js:
  (**
   * @license React
   * scheduler.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

react-dom/cjs/react-dom.production.min.js:
  (**
   * @license React
   * react-dom.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

react-is/cjs/react-is.production.min.js:
  (**
   * @license React
   * react-is.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

use-sync-external-store/cjs/use-sync-external-store-shim.production.js:
  (**
   * @license React
   * use-sync-external-store-shim.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.production.js:
  (**
   * @license React
   * use-sync-external-store-shim/with-selector.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

decimal.js-light/decimal.js:
  (*! decimal.js-light v2.5.1 https://github.com/MikeMcl/decimal.js-light/LICENCE *)

use-sync-external-store/cjs/use-sync-external-store-with-selector.production.js:
  (**
   * @license React
   * use-sync-external-store-with-selector.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)
*/
